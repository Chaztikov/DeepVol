WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-18 14:47:02.274544: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-18 14:47:02.302420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:04:00.0
2019-12-18 14:47:02.302972: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 14:47:02.305022: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 14:47:02.306987: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 14:47:02.307685: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 14:47:02.309971: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 14:47:02.311862: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 14:47:02.316679: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 14:47:02.318767: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 14:47:02.319197: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-18 14:47:02.325883: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399855000 Hz
2019-12-18 14:47:02.326059: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560bf61b82a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-18 14:47:02.326077: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-18 14:47:02.327210: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:04:00.0
2019-12-18 14:47:02.327233: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 14:47:02.327246: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 14:47:02.327256: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 14:47:02.327267: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 14:47:02.327277: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 14:47:02.327287: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 14:47:02.327298: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 14:47:02.329364: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 14:47:02.329395: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 14:47:02.424515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-18 14:47:02.424549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-18 14:47:02.424560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-18 14:47:02.427760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:04:00.0, compute capability: 6.0)
2019-12-18 14:47:02.429923: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560bf67f15b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-18 14:47:02.429940: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-18 14:48:12.039778: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 1.4907e+02,   Y0: 2.1373e+00,  elapsed time  69
INFO   step:     1,    loss: 9.0860e+00,   Y0: 2.1323e+00,  elapsed time 107
INFO   step:     2,    loss: 9.0695e+00,   Y0: 2.1273e+00,  elapsed time 107
INFO   step:     3,    loss: 9.0872e+00,   Y0: 2.1269e+00,  elapsed time 108
INFO   step:     4,    loss: 9.0561e+00,   Y0: 2.1260e+00,  elapsed time 108
INFO   step:     5,    loss: 9.0413e+00,   Y0: 2.1242e+00,  elapsed time 108
INFO   step:     6,    loss: 9.0381e+00,   Y0: 2.1229e+00,  elapsed time 108
INFO   step:     7,    loss: 9.0351e+00,   Y0: 2.1216e+00,  elapsed time 109
INFO   step:     8,    loss: 9.0381e+00,   Y0: 2.1206e+00,  elapsed time 109
INFO   step:     9,    loss: 9.0376e+00,   Y0: 2.1208e+00,  elapsed time 109
INFO   step:    10,    loss: 9.0365e+00,   Y0: 2.1214e+00,  elapsed time 109
INFO   step:    11,    loss: 9.0353e+00,   Y0: 2.1229e+00,  elapsed time 110
INFO   step:    12,    loss: 9.0411e+00,   Y0: 2.1245e+00,  elapsed time 110
INFO   step:    13,    loss: 9.0575e+00,   Y0: 2.1262e+00,  elapsed time 110
INFO   step:    14,    loss: 9.0812e+00,   Y0: 2.1280e+00,  elapsed time 110
INFO   step:    15,    loss: 9.0867e+00,   Y0: 2.1288e+00,  elapsed time 111
INFO   step:    16,    loss: 9.0946e+00,   Y0: 2.1292e+00,  elapsed time 111
INFO   step:    17,    loss: 9.1151e+00,   Y0: 2.1311e+00,  elapsed time 111
INFO   step:    18,    loss: 9.1320e+00,   Y0: 2.1330e+00,  elapsed time 112
INFO   step:    19,    loss: 9.1717e+00,   Y0: 2.1356e+00,  elapsed time 112
INFO   step:    20,    loss: 9.2290e+00,   Y0: 2.1368e+00,  elapsed time 112
INFO   step:    21,    loss: 9.2815e+00,   Y0: 2.1378e+00,  elapsed time 112
INFO   step:    22,    loss: 9.2880e+00,   Y0: 2.1400e+00,  elapsed time 113
INFO   step:    23,    loss: 9.2859e+00,   Y0: 2.1415e+00,  elapsed time 113
INFO   step:    24,    loss: 9.2798e+00,   Y0: 2.1426e+00,  elapsed time 113
INFO   step:    25,    loss: 9.2688e+00,   Y0: 2.1434e+00,  elapsed time 113
INFO   step:    26,    loss: 9.2552e+00,   Y0: 2.1443e+00,  elapsed time 114
INFO   step:    27,    loss: 9.2392e+00,   Y0: 2.1458e+00,  elapsed time 114
INFO   step:    28,    loss: 9.2213e+00,   Y0: 2.1475e+00,  elapsed time 114
INFO   step:    29,    loss: 9.2018e+00,   Y0: 2.1494e+00,  elapsed time 114
INFO   step:    30,    loss: 9.1802e+00,   Y0: 2.1504e+00,  elapsed time 115
INFO   step:    31,    loss: 9.1605e+00,   Y0: 2.1510e+00,  elapsed time 115
INFO   step:    32,    loss: 9.1412e+00,   Y0: 2.1516e+00,  elapsed time 115
INFO   step:    33,    loss: 9.1229e+00,   Y0: 2.1509e+00,  elapsed time 116
INFO   step:    34,    loss: 9.1047e+00,   Y0: 2.1490e+00,  elapsed time 116
INFO   step:    35,    loss: 9.0884e+00,   Y0: 2.1467e+00,  elapsed time 116
INFO   step:    36,    loss: 9.0741e+00,   Y0: 2.1444e+00,  elapsed time 116
INFO   step:    37,    loss: 9.0614e+00,   Y0: 2.1427e+00,  elapsed time 117
INFO   step:    38,    loss: 9.0504e+00,   Y0: 2.1409e+00,  elapsed time 117
INFO   step:    39,    loss: 9.0407e+00,   Y0: 2.1394e+00,  elapsed time 117
INFO   step:    40,    loss: 9.0322e+00,   Y0: 2.1382e+00,  elapsed time 117
INFO   step:    41,    loss: 9.0249e+00,   Y0: 2.1375e+00,  elapsed time 118
INFO   step:    42,    loss: 9.0187e+00,   Y0: 2.1376e+00,  elapsed time 118
INFO   step:    43,    loss: 9.0133e+00,   Y0: 2.1383e+00,  elapsed time 118
INFO   step:    44,    loss: 9.0086e+00,   Y0: 2.1390e+00,  elapsed time 118
INFO   step:    45,    loss: 9.0044e+00,   Y0: 2.1390e+00,  elapsed time 119
INFO   step:    46,    loss: 9.0004e+00,   Y0: 2.1391e+00,  elapsed time 119
INFO   step:    47,    loss: 8.9968e+00,   Y0: 2.1393e+00,  elapsed time 119
INFO   step:    48,    loss: 8.9936e+00,   Y0: 2.1384e+00,  elapsed time 120
INFO   step:    49,    loss: 8.9907e+00,   Y0: 2.1384e+00,  elapsed time 120
INFO   step:    50,    loss: 8.9881e+00,   Y0: 2.1384e+00,  elapsed time 120
INFO   step:    51,    loss: 8.9858e+00,   Y0: 2.1392e+00,  elapsed time 120
INFO   step:    52,    loss: 8.9838e+00,   Y0: 2.1398e+00,  elapsed time 121
INFO   step:    53,    loss: 8.9820e+00,   Y0: 2.1398e+00,  elapsed time 121
INFO   step:    54,    loss: 8.9804e+00,   Y0: 2.1397e+00,  elapsed time 121
INFO   step:    55,    loss: 8.9789e+00,   Y0: 2.1395e+00,  elapsed time 121
INFO   step:    56,    loss: 8.9776e+00,   Y0: 2.1395e+00,  elapsed time 122
INFO   step:    57,    loss: 8.9764e+00,   Y0: 2.1404e+00,  elapsed time 122
INFO   step:    58,    loss: 8.9753e+00,   Y0: 2.1412e+00,  elapsed time 122
INFO   step:    59,    loss: 8.9743e+00,   Y0: 2.1419e+00,  elapsed time 122
INFO   step:    60,    loss: 8.9734e+00,   Y0: 2.1431e+00,  elapsed time 123
INFO   step:    61,    loss: 8.9727e+00,   Y0: 2.1440e+00,  elapsed time 123
INFO   step:    62,    loss: 8.9720e+00,   Y0: 2.1450e+00,  elapsed time 123
INFO   step:    63,    loss: 8.9714e+00,   Y0: 2.1464e+00,  elapsed time 124
INFO   step:    64,    loss: 8.9708e+00,   Y0: 2.1471e+00,  elapsed time 124
INFO   step:    65,    loss: 8.9703e+00,   Y0: 2.1481e+00,  elapsed time 124
INFO   step:    66,    loss: 8.9700e+00,   Y0: 2.1499e+00,  elapsed time 124
INFO   step:    67,    loss: 8.9696e+00,   Y0: 2.1510e+00,  elapsed time 125
INFO   step:    68,    loss: 8.9692e+00,   Y0: 2.1515e+00,  elapsed time 125
INFO   step:    69,    loss: 8.9689e+00,   Y0: 2.1518e+00,  elapsed time 125
INFO   step:    70,    loss: 8.9685e+00,   Y0: 2.1515e+00,  elapsed time 125
INFO   step:    71,    loss: 8.9682e+00,   Y0: 2.1514e+00,  elapsed time 126
INFO   step:    72,    loss: 8.9679e+00,   Y0: 2.1509e+00,  elapsed time 126
INFO   step:    73,    loss: 8.9676e+00,   Y0: 2.1497e+00,  elapsed time 126
INFO   step:    74,    loss: 8.9673e+00,   Y0: 2.1487e+00,  elapsed time 126
INFO   step:    75,    loss: 8.9671e+00,   Y0: 2.1479e+00,  elapsed time 127
INFO   step:    76,    loss: 8.9668e+00,   Y0: 2.1467e+00,  elapsed time 127
INFO   step:    77,    loss: 8.9665e+00,   Y0: 2.1454e+00,  elapsed time 127
INFO   step:    78,    loss: 8.9663e+00,   Y0: 2.1445e+00,  elapsed time 127
INFO   step:    79,    loss: 8.9661e+00,   Y0: 2.1440e+00,  elapsed time 128
INFO   step:    80,    loss: 8.9659e+00,   Y0: 2.1426e+00,  elapsed time 128
INFO   step:    81,    loss: 8.9656e+00,   Y0: 2.1408e+00,  elapsed time 128
INFO   step:    82,    loss: 8.9654e+00,   Y0: 2.1389e+00,  elapsed time 129
INFO   step:    83,    loss: 8.9652e+00,   Y0: 2.1377e+00,  elapsed time 129
INFO   step:    84,    loss: 8.9649e+00,   Y0: 2.1363e+00,  elapsed time 129
INFO   step:    85,    loss: 8.9648e+00,   Y0: 2.1356e+00,  elapsed time 129
INFO   step:    86,    loss: 8.9646e+00,   Y0: 2.1347e+00,  elapsed time 130
INFO   step:    87,    loss: 8.9645e+00,   Y0: 2.1342e+00,  elapsed time 130
INFO   step:    88,    loss: 8.9643e+00,   Y0: 2.1335e+00,  elapsed time 130
INFO   step:    89,    loss: 8.9642e+00,   Y0: 2.1321e+00,  elapsed time 130
INFO   step:    90,    loss: 8.9640e+00,   Y0: 2.1306e+00,  elapsed time 131
INFO   step:    91,    loss: 8.9639e+00,   Y0: 2.1292e+00,  elapsed time 131
INFO   step:    92,    loss: 8.9637e+00,   Y0: 2.1278e+00,  elapsed time 131
INFO   step:    93,    loss: 8.9636e+00,   Y0: 2.1277e+00,  elapsed time 131
INFO   step:    94,    loss: 8.9635e+00,   Y0: 2.1272e+00,  elapsed time 132
INFO   step:    95,    loss: 8.9635e+00,   Y0: 2.1272e+00,  elapsed time 132
INFO   step:    96,    loss: 8.9634e+00,   Y0: 2.1278e+00,  elapsed time 132
INFO   step:    97,    loss: 8.9634e+00,   Y0: 2.1284e+00,  elapsed time 132
INFO   step:    98,    loss: 8.9634e+00,   Y0: 2.1296e+00,  elapsed time 133
INFO   step:    99,    loss: 8.9633e+00,   Y0: 2.1306e+00,  elapsed time 133
INFO   step:   100,    loss: 8.9633e+00,   Y0: 2.1320e+00,  elapsed time 133
INFO   step:   101,    loss: 8.9634e+00,   Y0: 2.1335e+00,  elapsed time 133
INFO   step:   102,    loss: 8.9634e+00,   Y0: 2.1352e+00,  elapsed time 134
INFO   step:   103,    loss: 8.9634e+00,   Y0: 2.1371e+00,  elapsed time 134
INFO   step:   104,    loss: 8.9635e+00,   Y0: 2.1386e+00,  elapsed time 134
INFO   step:   105,    loss: 8.9636e+00,   Y0: 2.1408e+00,  elapsed time 135
INFO   step:   106,    loss: 8.9637e+00,   Y0: 2.1428e+00,  elapsed time 135
INFO   step:   107,    loss: 8.9638e+00,   Y0: 2.1450e+00,  elapsed time 135
INFO   step:   108,    loss: 8.9638e+00,   Y0: 2.1462e+00,  elapsed time 135
INFO   step:   109,    loss: 8.9639e+00,   Y0: 2.1473e+00,  elapsed time 136
INFO   step:   110,    loss: 8.9639e+00,   Y0: 2.1481e+00,  elapsed time 136
INFO   step:   111,    loss: 8.9639e+00,   Y0: 2.1490e+00,  elapsed time 136
INFO   step:   112,    loss: 8.9638e+00,   Y0: 2.1485e+00,  elapsed time 136
INFO   step:   113,    loss: 8.9637e+00,   Y0: 2.1475e+00,  elapsed time 137
INFO   step:   114,    loss: 8.9636e+00,   Y0: 2.1471e+00,  elapsed time 137
INFO   step:   115,    loss: 8.9636e+00,   Y0: 2.1465e+00,  elapsed time 137
INFO   step:   116,    loss: 8.9635e+00,   Y0: 2.1454e+00,  elapsed time 137
INFO   step:   117,    loss: 8.9634e+00,   Y0: 2.1449e+00,  elapsed time 138
INFO   step:   118,    loss: 8.9633e+00,   Y0: 2.1445e+00,  elapsed time 138
INFO   step:   119,    loss: 8.9633e+00,   Y0: 2.1442e+00,  elapsed time 138
INFO   step:   120,    loss: 8.9633e+00,   Y0: 2.1447e+00,  elapsed time 138
INFO   step:   121,    loss: 8.9633e+00,   Y0: 2.1454e+00,  elapsed time 139
INFO   step:   122,    loss: 8.9633e+00,   Y0: 2.1457e+00,  elapsed time 139
INFO   step:   123,    loss: 8.9633e+00,   Y0: 2.1459e+00,  elapsed time 139
INFO   step:   124,    loss: 8.9632e+00,   Y0: 2.1460e+00,  elapsed time 139
INFO   step:   125,    loss: 8.9633e+00,   Y0: 2.1472e+00,  elapsed time 140
INFO   step:   126,    loss: 8.9633e+00,   Y0: 2.1475e+00,  elapsed time 140
INFO   step:   127,    loss: 8.9633e+00,   Y0: 2.1479e+00,  elapsed time 140
INFO   step:   128,    loss: 8.9633e+00,   Y0: 2.1485e+00,  elapsed time 141
INFO   step:   129,    loss: 8.9633e+00,   Y0: 2.1495e+00,  elapsed time 141
INFO   step:   130,    loss: 8.9634e+00,   Y0: 2.1501e+00,  elapsed time 141
INFO   step:   131,    loss: 8.9634e+00,   Y0: 2.1509e+00,  elapsed time 141
INFO   step:   132,    loss: 8.9634e+00,   Y0: 2.1520e+00,  elapsed time 142
INFO   step:   133,    loss: 8.9635e+00,   Y0: 2.1534e+00,  elapsed time 142
INFO   step:   134,    loss: 8.9636e+00,   Y0: 2.1543e+00,  elapsed time 142
INFO   step:   135,    loss: 8.9636e+00,   Y0: 2.1551e+00,  elapsed time 142
INFO   step:   136,    loss: 8.9636e+00,   Y0: 2.1548e+00,  elapsed time 143
INFO   step:   137,    loss: 8.9635e+00,   Y0: 2.1547e+00,  elapsed time 143
INFO   step:   138,    loss: 8.9636e+00,   Y0: 2.1553e+00,  elapsed time 143
INFO   step:   139,    loss: 8.9636e+00,   Y0: 2.1557e+00,  elapsed time 143
INFO   step:   140,    loss: 8.9636e+00,   Y0: 2.1565e+00,  elapsed time 144
INFO   step:   141,    loss: 8.9637e+00,   Y0: 2.1573e+00,  elapsed time 144
INFO   step:   142,    loss: 8.9637e+00,   Y0: 2.1583e+00,  elapsed time 144
INFO   step:   143,    loss: 8.9638e+00,   Y0: 2.1595e+00,  elapsed time 145
INFO   step:   144,    loss: 8.9639e+00,   Y0: 2.1607e+00,  elapsed time 145
INFO   step:   145,    loss: 8.9640e+00,   Y0: 2.1618e+00,  elapsed time 145
INFO   step:   146,    loss: 8.9641e+00,   Y0: 2.1628e+00,  elapsed time 145
INFO   step:   147,    loss: 8.9641e+00,   Y0: 2.1635e+00,  elapsed time 146
INFO   step:   148,    loss: 8.9641e+00,   Y0: 2.1636e+00,  elapsed time 146
INFO   step:   149,    loss: 8.9641e+00,   Y0: 2.1638e+00,  elapsed time 146
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_10:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_11:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_12:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_13:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_14:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_15:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_16:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_17:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_18:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_19:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_20:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_21:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_22:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_23:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_24:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_25:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_26:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_27:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_28:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_29:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_30:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_31:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_32:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_33:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_34:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_35:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_36:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_37:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_38:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_39:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_40:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_41:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_42:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_43:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_44:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_45:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_46:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_47:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_48:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_49:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_50:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_51:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_52:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_53:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_54:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_55:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_56:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_57:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_58:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_59:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_60:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_61:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_62:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_63:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_64:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_65:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_66:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_67:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_68:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_69:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_70:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_71:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_72:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_73:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_74:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_75:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_76:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_77:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_78:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_79:0' shape=(?, 1) dtype=float64>]
num_iterations:  150
total time intervals:  80
# of dimensions:  1
Loss out:  8.991193345751933
Output_Z_Vals:  [[[ 2.33387989e+00]
  [ 2.33387989e+00]
  [ 2.33387989e+00]
  ...
  [ 2.33387989e+00]
  [ 2.33387989e+00]
  [ 2.33387989e+00]]

 [[-3.69874295e-02]
  [-4.69051666e-02]
  [-6.60194006e-02]
  ...
  [-3.65132353e-02]
  [-3.44627721e-02]
  [-4.06528347e-02]]

 [[ 6.21960619e-03]
  [-7.80688571e-04]
  [ 5.45823498e-04]
  ...
  [-1.29014898e-03]
  [ 7.30211942e-04]
  [-2.09699250e-03]]

 ...

 [[ 6.96406694e-03]
  [ 8.25790620e-03]
  [-1.32025568e-03]
  ...
  [ 7.91494494e-03]
  [ 7.35049153e-03]
  [ 8.33966847e-03]]

 [[-5.35624396e-03]
  [-1.09382213e-02]
  [-7.94367047e-03]
  ...
  [-1.24702746e-02]
  [-3.15778035e-03]
  [-3.72015146e-03]]

 [[ 1.59812361e-02]
  [-2.58330578e-02]
  [ 1.11623979e-02]
  ...
  [-4.77438197e-02]
  [ 2.19199322e-02]
  [ 2.46685422e-02]]]
Z_Vals dimensionality:  (80, 200, 1)
X_test:  [[[100.         100.0883965   98.98553439 ... 101.9503299  102.05839748
   101.90257695]]

 [[100.         100.3161343  100.6381276  ...  97.08333788  97.14232232
    97.28708454]]

 [[100.         100.63127993 100.91348617 ... 100.97209538 101.13618132
   100.55310668]]

 ...

 [[100.          99.62906922  99.86747419 ...  95.68483372  95.11368981
    95.38655421]]

 [[100.          99.79901538 100.95176169 ... 105.86898072 106.0001093
   106.12998054]]

 [[100.         100.18373455 100.36488805 ... 104.77392063 104.19071682
   104.67102142]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.69874295e-02]
 [ 6.21960619e-03]
 [ 1.40611663e-03]
 [-2.32145354e-03]
 [-1.86562673e-02]
 [ 6.88883993e-03]
 [ 2.33152309e-03]
 [-1.67752398e-02]
 [-6.21967597e-03]
 [ 3.81264779e-02]
 [ 1.05139553e-02]
 [-1.59292524e-02]
 [ 1.70613481e-02]
 [ 1.05974090e-02]
 [-4.45401587e-02]
 [ 2.16486053e-02]
 [-4.99892878e-03]
 [-7.65925511e-03]
 [-1.95978188e-02]
 [ 1.46104020e-02]
 [-3.72395843e-02]
 [-2.79777651e-02]
 [ 1.03293938e-03]
 [-3.41402918e-04]
 [-5.81383767e-03]
 [ 1.69692486e-02]
 [ 1.63472120e-02]
 [ 1.50340068e-02]
 [ 7.37580553e-04]
 [-2.56398206e-03]
 [-3.59191094e-03]
 [-1.55513235e-02]
 [ 1.31686624e-02]
 [ 1.08843283e-02]
 [ 3.54894599e-03]
 [ 1.95430148e-03]
 [-2.19201807e-03]
 [ 1.22958211e-02]
 [-1.85185319e-03]
 [-1.24785915e-02]
 [-1.02066586e-03]
 [-2.89225075e-03]
 [ 5.18685177e-03]
 [-1.19110436e-02]
 [ 2.41660017e-03]
 [-9.71489994e-04]
 [-1.37077151e-02]
 [-5.11393972e-03]
 [-4.62578583e-03]
 [ 6.10140800e-03]
 [-3.19894322e-03]
 [ 3.68346462e-03]
 [ 8.41127816e-04]
 [ 2.75415689e-03]
 [ 1.35851332e-03]
 [ 8.55548756e-03]
 [-7.73285300e-03]
 [-1.29924152e-02]
 [ 1.54482685e-02]
 [-2.82640875e-03]
 [ 1.30318467e-02]
 [-1.41457632e-02]
 [-1.27450913e-02]
 [-3.23767159e-03]
 [ 2.04101093e-02]
 [-1.71613053e-02]
 [ 1.94203201e-02]
 [ 3.71751766e-03]
 [ 1.06888377e-02]
 [-2.10444116e-02]
 [-7.77190195e-03]
 [-7.23172940e-03]
 [ 5.45107181e-03]
 [ 6.89532606e-03]
 [-6.21460224e-04]
 [-6.97695328e-03]
 [ 6.96406694e-03]
 [-5.35624396e-03]
 [ 1.59812361e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.44182617]
curr_Stock_Price:  100.08839649857859
curr_Factors:  [100.0883965]
mat_Sqrt:  [[0.15]]
grads:  [-0.24658286]
Stock Position:  -0.24658286341791386
Bond Position:  [28.12190957]


portfolio before change:  [3.71553074]
curr_Stock_Price:  98.98553438931769
curr_Factors:  [98.98553439]
mat_Sqrt:  [[0.15]]
grads:  [0.04146404]
Stock Position:  0.04146404127271546
Bond Position:  [-0.38880954]


portfolio before change:  [3.68863102]
curr_Stock_Price:  98.33737241200082
curr_Factors:  [98.33737241]
mat_Sqrt:  [[0.15]]
grads:  [0.00937411]
Stock Position:  0.009374110858551797
Bond Position:  [2.76680559]


portfolio before change:  [3.6875508]
curr_Stock_Price:  98.20368957180642
curr_Factors:  [98.20368957]
mat_Sqrt:  [[0.15]]
grads:  [-0.01547636]
Stock Position:  -0.015476356962422855
Bond Position:  [5.20738615]


portfolio before change:  [3.68393566]
curr_Stock_Price:  98.45831074752633
curr_Factors:  [98.45831075]
mat_Sqrt:  [[0.15]]
grads:  [-0.12437512]
Stock Position:  -0.124375115526459
Bond Position:  [15.92969943]


portfolio before change:  [3.64534045]
curr_Stock_Price:  98.77662880395019
curr_Factors:  [98.7766288]
mat_Sqrt:  [[0.15]]
grads:  [0.0459256]
Stock Position:  0.04592559952525882
Bond Position:  [-0.89103544]


portfolio before change:  [3.5854456]
curr_Stock_Price:  97.47366997470883
curr_Factors:  [97.47366997]
mat_Sqrt:  [[0.15]]
grads:  [0.01554349]
Stock Position:  0.01554348727293612
Bond Position:  [2.07036485]


portfolio before change:  [3.57918235]
curr_Stock_Price:  97.06239494745793
curr_Factors:  [97.06239495]
mat_Sqrt:  [[0.15]]
grads:  [-0.11183493]
Stock Position:  -0.11183493178819721
Bond Position:  [14.43414867]


portfolio before change:  [3.62501441]
curr_Stock_Price:  96.66064307656718
curr_Factors:  [96.66064308]
mat_Sqrt:  [[0.15]]
grads:  [-0.04146451]
Stock Position:  -0.041464506456083294
Bond Position:  [7.63300026]


portfolio before change:  [3.60157405]
curr_Stock_Price:  97.23746018244016
curr_Factors:  [97.23746018]
mat_Sqrt:  [[0.15]]
grads:  [0.25417652]
Stock Position:  0.2541765194804211
Bond Position:  [-21.11390515]


portfolio before change:  [3.38638834]
curr_Stock_Price:  96.3960526292935
curr_Factors:  [96.39605263]
mat_Sqrt:  [[0.15]]
grads:  [0.07009304]
Stock Position:  0.07009303536193574
Bond Position:  [-3.37030358]


portfolio before change:  [3.34581395]
curr_Stock_Price:  95.8201930568411
curr_Factors:  [95.82019306]
mat_Sqrt:  [[0.15]]
grads:  [-0.10619502]
Stock Position:  -0.10619501604814739
Bond Position:  [13.52144089]


portfolio before change:  [3.33602159]
curr_Stock_Price:  95.92036231306322
curr_Factors:  [95.92036231]
mat_Sqrt:  [[0.15]]
grads:  [0.11374232]
Stock Position:  0.1137423206261667
Bond Position:  [-7.57418302]


portfolio before change:  [3.36468905]
curr_Stock_Price:  96.17656299734482
curr_Factors:  [96.176563]
mat_Sqrt:  [[0.15]]
grads:  [0.07064939]
Stock Position:  0.07064939323085917
Bond Position:  [-3.43012677]


portfolio before change:  [3.34244249]
curr_Stock_Price:  95.86471079401333
curr_Factors:  [95.86471079]
mat_Sqrt:  [[0.15]]
grads:  [-0.29693439]
Stock Position:  -0.2969343913687039
Bond Position:  [31.80797204]


portfolio before change:  [3.25342057]
curr_Stock_Price:  96.17120940978893
curr_Factors:  [96.17120941]
mat_Sqrt:  [[0.15]]
grads:  [0.14432404]
Stock Position:  0.14432403547085318
Bond Position:  [-10.62639647]


portfolio before change:  [3.31709422]
curr_Stock_Price:  96.6169967151452
curr_Factors:  [96.61699672]
mat_Sqrt:  [[0.15]]
grads:  [-0.03332619]
Stock Position:  -0.033326191889665686
Bond Position:  [6.53697079]


portfolio before change:  [3.30653517]
curr_Stock_Price:  96.94609586981245
curr_Factors:  [96.94609587]
mat_Sqrt:  [[0.15]]
grads:  [-0.0510617]
Stock Position:  -0.05106170075697108
Bond Position:  [8.25676771]


portfolio before change:  [3.30828836]
curr_Stock_Price:  96.92186785335375
curr_Factors:  [96.92186785]
mat_Sqrt:  [[0.15]]
grads:  [-0.13065213]
Stock Position:  -0.1306521253193878
Bond Position:  [15.97133639]


portfolio before change:  [3.32141662]
curr_Stock_Price:  96.82902577499284
curr_Factors:  [96.82902577]
mat_Sqrt:  [[0.15]]
grads:  [0.09740268]
Stock Position:  0.09740267975848446
Bond Position:  [-6.10998997]


portfolio before change:  [3.34039861]
curr_Stock_Price:  97.02782811103073
curr_Factors:  [97.02782811]
mat_Sqrt:  [[0.15]]
grads:  [-0.2482639]
Stock Position:  -0.24826389556005618
Bond Position:  [27.42890519]


portfolio before change:  [3.39762646]
curr_Stock_Price:  96.80422131554695
curr_Factors:  [96.80422132]
mat_Sqrt:  [[0.15]]
grads:  [-0.18651843]
Stock Position:  -0.18651843411916783
Bond Position:  [21.45339824]


portfolio before change:  [3.41631422]
curr_Stock_Price:  96.7112177517442
curr_Factors:  [96.71121775]
mat_Sqrt:  [[0.15]]
grads:  [0.00688626]
Stock Position:  0.006886262544058426
Bond Position:  [2.75033539]


portfolio before change:  [3.41416369]
curr_Stock_Price:  96.37396153711494
curr_Factors:  [96.37396154]
mat_Sqrt:  [[0.15]]
grads:  [-0.00227602]
Stock Position:  -0.002276019453015805
Bond Position:  [3.6335127]


portfolio before change:  [3.4143451]
curr_Stock_Price:  96.39403700128265
curr_Factors:  [96.394037]
mat_Sqrt:  [[0.15]]
grads:  [-0.03875892]
Stock Position:  -0.03875891780330011
Bond Position:  [7.15047365]


portfolio before change:  [3.42139008]
curr_Stock_Price:  96.22380348473372
curr_Factors:  [96.22380348]
mat_Sqrt:  [[0.15]]
grads:  [0.11312832]
Stock Position:  0.11312832391966857
Bond Position:  [-7.46424753]


portfolio before change:  [3.50765348]
curr_Stock_Price:  96.99045437018871
curr_Factors:  [96.99045437]
mat_Sqrt:  [[0.15]]
grads:  [0.10898141]
Stock Position:  0.10898141352958529
Bond Position:  [-7.06250333]


portfolio before change:  [3.47402386]
curr_Stock_Price:  96.68592348677355
curr_Factors:  [96.68592349]
mat_Sqrt:  [[0.15]]
grads:  [0.10022671]
Stock Position:  0.10022671199797738
Bond Position:  [-6.21648835]


portfolio before change:  [3.50805378]
curr_Stock_Price:  97.02932964680608
curr_Factors:  [97.02932965]
mat_Sqrt:  [[0.15]]
grads:  [0.0049172]
Stock Position:  0.004917203687338426
Bond Position:  [3.03094081]


portfolio before change:  [3.51059755]
curr_Stock_Price:  97.50812246463043
curr_Factors:  [97.50812246]
mat_Sqrt:  [[0.15]]
grads:  [-0.01709321]
Stock Position:  -0.017093213711676623
Bond Position:  [5.17732472]


portfolio before change:  [3.50272461]
curr_Stock_Price:  97.98764187836704
curr_Factors:  [97.98764188]
mat_Sqrt:  [[0.15]]
grads:  [-0.02394607]
Stock Position:  -0.023946072961234462
Bond Position:  [5.84914383]


portfolio before change:  [3.47226425]
curr_Stock_Price:  99.27494868161205
curr_Factors:  [99.27494868]
mat_Sqrt:  [[0.15]]
grads:  [-0.10367549]
Stock Position:  -0.10367549028218154
Bond Position:  [13.76464323]


portfolio before change:  [3.36342923]
curr_Stock_Price:  100.33301302141287
curr_Factors:  [100.33301302]
mat_Sqrt:  [[0.15]]
grads:  [0.08779108]
Stock Position:  0.08779108271698359
Bond Position:  [-5.44491462]


portfolio before change:  [3.42271916]
curr_Stock_Price:  101.01224203085438
curr_Factors:  [101.01224203]
mat_Sqrt:  [[0.15]]
grads:  [0.07256219]
Stock Position:  0.07256218836632486
Bond Position:  [-3.90695017]


portfolio before change:  [3.37789052]
curr_Stock_Price:  100.39781121181153
curr_Factors:  [100.39781121]
mat_Sqrt:  [[0.15]]
grads:  [0.02365964]
Stock Position:  0.023659639907623334
Bond Position:  [1.00251446]


portfolio before change:  [3.36344276]
curr_Stock_Price:  99.7845127799593
curr_Factors:  [99.78451278]
mat_Sqrt:  [[0.15]]
grads:  [0.01302868]
Stock Position:  0.013028676540792474
Bond Position:  [2.06338262]


portfolio before change:  [3.35782247]
curr_Stock_Price:  99.34323553022207
curr_Factors:  [99.34323553]
mat_Sqrt:  [[0.15]]
grads:  [-0.01461345]
Stock Position:  -0.014613453783662213
Bond Position:  [4.80957025]


portfolio before change:  [3.34748942]
curr_Stock_Price:  100.07089770944069
curr_Factors:  [100.07089771]
mat_Sqrt:  [[0.15]]
grads:  [0.08197214]
Stock Position:  0.08197214099034045
Bond Position:  [-4.85553632]


portfolio before change:  [3.34737846]
curr_Stock_Price:  100.07324634584758
curr_Factors:  [100.07324635]
mat_Sqrt:  [[0.15]]
grads:  [-0.01234569]
Stock Position:  -0.012345687924629128
Bond Position:  [4.58285153]


portfolio before change:  [3.34071799]
curr_Stock_Price:  100.6359457749895
curr_Factors:  [100.63594577]
mat_Sqrt:  [[0.15]]
grads:  [-0.08319061]
Stock Position:  -0.0831906097422678
Bond Position:  [11.71268368]


portfolio before change:  [3.37440289]
curr_Stock_Price:  100.23983336800099
curr_Factors:  [100.23983337]
mat_Sqrt:  [[0.15]]
grads:  [-0.00680444]
Stock Position:  -0.006804439049917579
Bond Position:  [4.05647872]


portfolio before change:  [3.37750937]
curr_Stock_Price:  99.82055647611197
curr_Factors:  [99.82055648]
mat_Sqrt:  [[0.15]]
grads:  [-0.01928167]
Stock Position:  -0.019281671695847952
Bond Position:  [5.30221657]


portfolio before change:  [3.37807487]
curr_Stock_Price:  99.80841518629887
curr_Factors:  [99.80841519]
mat_Sqrt:  [[0.15]]
grads:  [0.03457901]
Stock Position:  0.0345790117765623
Bond Position:  [-0.07320149]


portfolio before change:  [3.39215163]
curr_Stock_Price:  100.21563709995962
curr_Factors:  [100.2156371]
mat_Sqrt:  [[0.15]]
grads:  [-0.07940696]
Stock Position:  -0.07940695743652017
Bond Position:  [11.34997046]


portfolio before change:  [3.38375106]
curr_Stock_Price:  100.33036204186676
curr_Factors:  [100.33036204]
mat_Sqrt:  [[0.15]]
grads:  [0.01611067]
Stock Position:  0.016110667775274874
Bond Position:  [1.76736193]


portfolio before change:  [3.37947807]
curr_Stock_Price:  100.05827800489888
curr_Factors:  [100.058278]
mat_Sqrt:  [[0.15]]
grads:  [-0.0064766]
Stock Position:  -0.006476599958065899
Bond Position:  [4.02751551]


portfolio before change:  [3.37842301]
curr_Stock_Price:  100.26004967978037
curr_Factors:  [100.26004968]
mat_Sqrt:  [[0.15]]
grads:  [-0.09138477]
Stock Position:  -0.0913847670910215
Bond Position:  [12.54066429]


portfolio before change:  [3.37828829]
curr_Stock_Price:  100.27010098234916
curr_Factors:  [100.27010098]
mat_Sqrt:  [[0.15]]
grads:  [-0.03409293]
Stock Position:  -0.034092931476057825
Bond Position:  [6.79678997]


portfolio before change:  [3.38467118]
curr_Stock_Price:  100.09534096979527
curr_Factors:  [100.09534097]
mat_Sqrt:  [[0.15]]
grads:  [-0.03083857]
Stock Position:  -0.03083857217717918
Bond Position:  [6.47146858]


portfolio before change:  [3.37271902]
curr_Stock_Price:  100.49602865291256
curr_Factors:  [100.49602865]
mat_Sqrt:  [[0.15]]
grads:  [0.04067605]
Stock Position:  0.04067605333562431
Bond Position:  [-0.7150628]


portfolio before change:  [3.43964397]
curr_Stock_Price:  102.14244304178209
curr_Factors:  [102.14244304]
mat_Sqrt:  [[0.15]]
grads:  [-0.02132629]
Stock Position:  -0.02132628811638568
Bond Position:  [5.61796314]


portfolio before change:  [3.44107955]
curr_Stock_Price:  102.09159285344978
curr_Factors:  [102.09159285]
mat_Sqrt:  [[0.15]]
grads:  [0.02455643]
Stock Position:  0.02455643081000976
Bond Position:  [0.93407441]


portfolio before change:  [3.44670456]
curr_Stock_Price:  102.31828028679662
curr_Factors:  [102.31828029]
mat_Sqrt:  [[0.15]]
grads:  [0.00560752]
Stock Position:  0.0056075187717763405
Bond Position:  [2.87295289]


portfolio before change:  [3.44575231]
curr_Stock_Price:  102.1164404707142
curr_Factors:  [102.11644047]
mat_Sqrt:  [[0.15]]
grads:  [0.01836105]
Stock Position:  0.018361045907080084
Bond Position:  [1.57078766]


portfolio before change:  [3.43446988]
curr_Stock_Price:  101.4966172603882
curr_Factors:  [101.49661726]
mat_Sqrt:  [[0.15]]
grads:  [0.00905676]
Stock Position:  0.009056755436234638
Bond Position:  [2.51523984]


portfolio before change:  [3.43986495]
curr_Stock_Price:  102.07495440454232
curr_Factors:  [102.0749544]
mat_Sqrt:  [[0.15]]
grads:  [0.05703658]
Stock Position:  0.05703658375839469
Bond Position:  [-2.38214174]


portfolio before change:  [3.40917374]
curr_Stock_Price:  101.53946795371913
curr_Factors:  [101.53946795]
mat_Sqrt:  [[0.15]]
grads:  [-0.05155235]
Stock Position:  -0.05155235333436604
Bond Position:  [8.64377227]


portfolio before change:  [3.36222076]
curr_Stock_Price:  102.46073011575912
curr_Factors:  [102.46073012]
mat_Sqrt:  [[0.15]]
grads:  [-0.0866161]
Stock Position:  -0.08661610147851934
Bond Position:  [12.23696976]


portfolio before change:  [3.28083572]
curr_Stock_Price:  103.40916666556676
curr_Factors:  [103.40916667]
mat_Sqrt:  [[0.15]]
grads:  [0.10298846]
Stock Position:  0.10298845661367362
Bond Position:  [-7.36911475]


portfolio before change:  [3.41110674]
curr_Stock_Price:  104.67854774243129
curr_Factors:  [104.67854774]
mat_Sqrt:  [[0.15]]
grads:  [-0.01884273]
Stock Position:  -0.018842725020502618
Bond Position:  [5.38353583]


portfolio before change:  [3.40812103]
curr_Stock_Price:  104.85485922252786
curr_Factors:  [104.85485922]
mat_Sqrt:  [[0.15]]
grads:  [0.08687898]
Stock Position:  0.08687897818432169
Bond Position:  [-5.701562]


portfolio before change:  [3.48328626]
curr_Stock_Price:  105.7241326929489
curr_Factors:  [105.72413269]
mat_Sqrt:  [[0.15]]
grads:  [-0.09430509]
Stock Position:  -0.09430508794409272
Bond Position:  [13.45360989]


portfolio before change:  [3.57477227]
curr_Stock_Price:  104.76294242973236
curr_Factors:  [104.76294243]
mat_Sqrt:  [[0.15]]
grads:  [-0.08496728]
Stock Position:  -0.08496727543304637
Bond Position:  [12.47619405]


portfolio before change:  [3.58114958]
curr_Stock_Price:  104.69706388822685
curr_Factors:  [104.69706389]
mat_Sqrt:  [[0.15]]
grads:  [-0.02158448]
Stock Position:  -0.02158447726096326
Bond Position:  [5.84098097]


portfolio before change:  [3.59598168]
curr_Stock_Price:  104.02681205500332
curr_Factors:  [104.02681206]
mat_Sqrt:  [[0.15]]
grads:  [0.1360674]
Stock Position:  0.13606739513646784
Bond Position:  [-10.55867566]


portfolio before change:  [3.66531893]
curr_Stock_Price:  104.54124230456648
curr_Factors:  [104.5412423]
mat_Sqrt:  [[0.15]]
grads:  [-0.1144087]
Stock Position:  -0.11440870226102254
Bond Position:  [15.6257468]


portfolio before change:  [3.7080988]
curr_Stock_Price:  104.17585728272103
curr_Factors:  [104.17585728]
mat_Sqrt:  [[0.15]]
grads:  [0.1294688]
Stock Position:  0.1294688007117551
Bond Position:  [-9.77942451]


portfolio before change:  [3.66088114]
curr_Stock_Price:  103.81587536045863
curr_Factors:  [103.81587536]
mat_Sqrt:  [[0.15]]
grads:  [0.02478345]
Stock Position:  0.024783451051753093
Bond Position:  [1.08796547]


portfolio before change:  [3.67066693]
curr_Stock_Price:  104.20798341071088
curr_Factors:  [104.20798341]
mat_Sqrt:  [[0.15]]
grads:  [0.07125892]
Stock Position:  0.07125891785771012
Bond Position:  [-3.7550812]


portfolio before change:  [3.65311185]
curr_Stock_Price:  103.96492076581787
curr_Factors:  [103.96492077]
mat_Sqrt:  [[0.15]]
grads:  [-0.14029608]
Stock Position:  -0.14029607725505736
Bond Position:  [18.2389824]


portfolio before change:  [3.699825]
curr_Stock_Price:  103.64008501429083
curr_Factors:  [103.64008501]
mat_Sqrt:  [[0.15]]
grads:  [-0.05181268]
Stock Position:  -0.05181267965381008
Bond Position:  [9.06969552]


portfolio before change:  [3.69218534]
curr_Stock_Price:  103.7984735900923
curr_Factors:  [103.79847359]
mat_Sqrt:  [[0.15]]
grads:  [-0.04821153]
Stock Position:  -0.048211529320857864
Bond Position:  [8.69646849]


portfolio before change:  [3.69128214]
curr_Stock_Price:  103.82848176765143
curr_Factors:  [103.82848177]
mat_Sqrt:  [[0.15]]
grads:  [0.03634048]
Stock Position:  0.03634047871507147
Bond Position:  [-0.08189459]


portfolio before change:  [3.70239472]
curr_Stock_Price:  104.13441316727574
curr_Factors:  [104.13441317]
mat_Sqrt:  [[0.15]]
grads:  [0.04596884]
Stock Position:  0.045968840375873
Bond Position:  [-1.0845435]


portfolio before change:  [3.70769366]
curr_Stock_Price:  104.25116024078258
curr_Factors:  [104.25116024]
mat_Sqrt:  [[0.15]]
grads:  [-0.00414307]
Stock Position:  -0.004143068160601781
Bond Position:  [4.13961332]


portfolio before change:  [3.71042305]
curr_Stock_Price:  103.65482395817877
curr_Factors:  [103.65482396]
mat_Sqrt:  [[0.15]]
grads:  [-0.04651302]
Stock Position:  -0.046513021857953654
Bond Position:  [8.53172215]


portfolio before change:  [3.72704691]
curr_Stock_Price:  103.30888634960708
curr_Factors:  [103.30888635]
mat_Sqrt:  [[0.15]]
grads:  [0.04642711]
Stock Position:  0.046427112946478465
Bond Position:  [-1.06928643]


portfolio before change:  [3.66390622]
curr_Stock_Price:  101.95032989781365
curr_Factors:  [101.9503299]
mat_Sqrt:  [[0.15]]
grads:  [-0.03570829]
Stock Position:  -0.03570829304915807
Bond Position:  [7.30437848]


portfolio before change:  [3.66050385]
curr_Stock_Price:  102.0583974766856
curr_Factors:  [102.05839748]
mat_Sqrt:  [[0.15]]
grads:  [0.10654157]
Stock Position:  0.10654157430992249
Bond Position:  [-7.21295849]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.66050385]
Stock Price:  101.90257694928792
PL:  [1.7579269]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.69051666e-02]
 [-7.80688571e-04]
 [ 3.20644505e-03]
 [ 2.13428486e-03]
 [ 1.45120377e-02]
 [ 9.42567055e-03]
 [ 4.70286824e-04]
 [ 1.30115542e-02]
 [ 1.55111078e-02]
 [-2.04013939e-02]
 [ 1.02058870e-02]
 [-5.17844033e-03]
 [-8.59841528e-03]
 [ 4.26481885e-03]
 [ 4.41988798e-03]
 [-3.41467539e-03]
 [ 1.15136297e-02]
 [ 1.01761138e-02]
 [ 2.29683394e-02]
 [ 3.39963311e-03]
 [ 7.62182923e-02]
 [-1.59695519e-02]
 [-2.25683859e-03]
 [ 1.36790545e-02]
 [ 1.11890265e-02]
 [-5.84861392e-03]
 [ 1.30420970e-02]
 [-1.56227255e-04]
 [ 3.44526422e-03]
 [-2.25812734e-02]
 [-4.25357713e-03]
 [ 8.20168979e-03]
 [ 1.57966928e-02]
 [ 1.96182676e-02]
 [-4.02981212e-03]
 [ 1.66230684e-03]
 [-4.35073782e-03]
 [ 1.15815544e-02]
 [-1.98392669e-03]
 [-1.39096675e-02]
 [-1.02333588e-03]
 [-2.87765572e-03]
 [ 4.21752919e-03]
 [-7.80354443e-03]
 [ 2.04394347e-03]
 [-4.77146334e-03]
 [-1.36189542e-02]
 [-6.33750209e-04]
 [-2.66650431e-03]
 [ 3.07658051e-04]
 [-3.84177964e-03]
 [ 2.91529186e-03]
 [ 3.57303647e-03]
 [ 3.27629244e-04]
 [ 8.51410073e-03]
 [ 8.86473188e-03]
 [ 8.51643867e-03]
 [ 6.44801868e-03]
 [ 1.32884645e-02]
 [-3.98346846e-03]
 [-4.21969857e-03]
 [-2.62191766e-02]
 [-1.29604545e-02]
 [-3.13004747e-03]
 [-6.01567781e-03]
 [ 2.79388911e-02]
 [ 8.32689731e-03]
 [ 1.72276589e-03]
 [ 1.56543639e-02]
 [-1.96123833e-02]
 [ 1.95825531e-02]
 [-1.25110616e-02]
 [-3.90793016e-03]
 [ 7.72131043e-03]
 [-2.32658920e-03]
 [ 2.77074203e-03]
 [ 8.25790620e-03]
 [-1.09382213e-02]
 [-2.58330578e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.98524406]
curr_Stock_Price:  100.31613430352017
curr_Factors:  [100.3161343]
mat_Sqrt:  [[0.15]]
grads:  [-0.31270111]
Stock Position:  -0.31270111050028093
Bond Position:  [38.35421066]


portfolio before change:  [6.88695361]
curr_Stock_Price:  100.63812760206038
curr_Factors:  [100.6381276]
mat_Sqrt:  [[0.15]]
grads:  [-0.00520459]
Stock Position:  -0.005204590475185887
Bond Position:  [7.41073385]


portfolio before change:  [6.88543956]
curr_Stock_Price:  101.01802893929147
curr_Factors:  [101.01802894]
mat_Sqrt:  [[0.15]]
grads:  [0.0213763]
Stock Position:  0.02137630033664171
Bond Position:  [4.72604784]


portfolio before change:  [6.86889856]
curr_Stock_Price:  100.23040948347537
curr_Factors:  [100.23040948]
mat_Sqrt:  [[0.15]]
grads:  [0.01422857]
Stock Position:  0.014228565748846811
Bond Position:  [5.44276359]


portfolio before change:  [6.86896238]
curr_Stock_Price:  100.21098609895289
curr_Factors:  [100.2109861]
mat_Sqrt:  [[0.15]]
grads:  [0.09674692]
Stock Position:  0.0967469181128917
Bond Position:  [-2.82614169]


portfolio before change:  [6.77330182]
curr_Stock_Price:  99.22404081703205
curr_Factors:  [99.22404082]
mat_Sqrt:  [[0.15]]
grads:  [0.0628378]
Stock Position:  0.06283780364170585
Bond Position:  [0.53828103]


portfolio before change:  [6.76486185]
curr_Stock_Price:  99.08919179624247
curr_Factors:  [99.0891918]
mat_Sqrt:  [[0.15]]
grads:  [0.00313525]
Stock Position:  0.0031352454936407
Bond Position:  [6.45419291]


portfolio before change:  [6.76709783]
curr_Stock_Price:  99.67370130560903
curr_Factors:  [99.67370131]
mat_Sqrt:  [[0.15]]
grads:  [0.08674369]
Stock Position:  0.08674369450533977
Bond Position:  [-1.87896727]


portfolio before change:  [6.77792523]
curr_Stock_Price:  99.79987578374812
curr_Factors:  [99.79987578]
mat_Sqrt:  [[0.15]]
grads:  [0.10340739]
Stock Position:  0.10340738549944764
Bond Position:  [-3.542119]


portfolio before change:  [6.88344913]
curr_Stock_Price:  100.82248442986746
curr_Factors:  [100.82248443]
mat_Sqrt:  [[0.15]]
grads:  [-0.13600929]
Stock Position:  -0.13600929241452936
Bond Position:  [20.5962439]


portfolio before change:  [6.9386787]
curr_Stock_Price:  100.42587723582025
curr_Factors:  [100.42587724]
mat_Sqrt:  [[0.15]]
grads:  [0.06803925]
Stock Position:  0.06803924699914683
Bond Position:  [0.10577763]


portfolio before change:  [6.92619278]
curr_Stock_Price:  100.24226952407858
curr_Factors:  [100.24226952]
mat_Sqrt:  [[0.15]]
grads:  [-0.03452294]
Stock Position:  -0.03452293555094179
Bond Position:  [10.38685019]


portfolio before change:  [6.93150821]
curr_Stock_Price:  100.10710618615663
curr_Factors:  [100.10710619]
mat_Sqrt:  [[0.15]]
grads:  [-0.05732277]
Stock Position:  -0.05732276853419709
Bond Position:  [12.66992469]


portfolio before change:  [6.91291264]
curr_Stock_Price:  100.445322080287
curr_Factors:  [100.44532208]
mat_Sqrt:  [[0.15]]
grads:  [0.02843213]
Stock Position:  0.028432125663700205
Bond Position:  [4.05703862]


portfolio before change:  [6.89533676]
curr_Stock_Price:  99.81823397572818
curr_Factors:  [99.81823398]
mat_Sqrt:  [[0.15]]
grads:  [0.02946592]
Stock Position:  0.02946591985630793
Bond Position:  [3.95410068]


portfolio before change:  [6.90884833]
curr_Stock_Price:  100.2683955459175
curr_Factors:  [100.26839555]
mat_Sqrt:  [[0.15]]
grads:  [-0.0227645]
Stock Position:  -0.02276450261541583
Bond Position:  [9.19140848]


portfolio before change:  [6.91037624]
curr_Stock_Price:  100.22651328250656
curr_Factors:  [100.22651328]
mat_Sqrt:  [[0.15]]
grads:  [0.07675753]
Stock Position:  0.07675753127548729
Bond Position:  [-0.78276349]


portfolio before change:  [6.89355523]
curr_Stock_Price:  100.00800599118509
curr_Factors:  [100.00800599]
mat_Sqrt:  [[0.15]]
grads:  [0.06784076]
Stock Position:  0.06784075851109628
Bond Position:  [0.10893625]


portfolio before change:  [6.92722942]
curr_Stock_Price:  100.50427667652686
curr_Factors:  [100.50427668]
mat_Sqrt:  [[0.15]]
grads:  [0.15312226]
Stock Position:  0.15312226261276607
Bond Position:  [-8.46221283]


portfolio before change:  [6.89779029]
curr_Stock_Price:  100.3154718139683
curr_Factors:  [100.31547181]
mat_Sqrt:  [[0.15]]
grads:  [0.02266422]
Stock Position:  0.02266422073209548
Bond Position:  [4.62421829]


portfolio before change:  [6.89461844]
curr_Stock_Price:  100.16276977460824
curr_Factors:  [100.16276977]
mat_Sqrt:  [[0.15]]
grads:  [0.50812195]
Stock Position:  0.50812194874091
Bond Position:  [-44.00028333]


portfolio before change:  [6.53820153]
curr_Stock_Price:  99.46674235898699
curr_Factors:  [99.46674236]
mat_Sqrt:  [[0.15]]
grads:  [-0.10646368]
Stock Position:  -0.10646367916193068
Bond Position:  [17.12779687]


portfolio before change:  [6.51854304]
curr_Stock_Price:  99.66144736342397
curr_Factors:  [99.66144736]
mat_Sqrt:  [[0.15]]
grads:  [-0.01504559]
Stock Position:  -0.0150455906099388
Bond Position:  [8.01800837]


portfolio before change:  [6.52220798]
curr_Stock_Price:  99.45116652501272
curr_Factors:  [99.45116653]
mat_Sqrt:  [[0.15]]
grads:  [0.0911937]
Stock Position:  0.09119369696834331
Bond Position:  [-2.54711157]


portfolio before change:  [6.54057523]
curr_Stock_Price:  99.65432154164156
curr_Factors:  [99.65432154]
mat_Sqrt:  [[0.15]]
grads:  [0.07459351]
Stock Position:  0.07459351014379416
Bond Position:  [-0.89299041]


portfolio before change:  [6.55659829]
curr_Stock_Price:  99.86987469606609
curr_Factors:  [99.8698747]
mat_Sqrt:  [[0.15]]
grads:  [-0.03899076]
Stock Position:  -0.03899075946528763
Bond Position:  [10.45060055]


portfolio before change:  [6.56455132]
curr_Stock_Price:  99.68265458395211
curr_Factors:  [99.68265458]
mat_Sqrt:  [[0.15]]
grads:  [0.08694731]
Stock Position:  0.08694731331172098
Bond Position:  [-2.10258768]


portfolio before change:  [6.5963273]
curr_Stock_Price:  100.04962841582787
curr_Factors:  [100.04962842]
mat_Sqrt:  [[0.15]]
grads:  [-0.00104152]
Stock Position:  -0.0010415150313908272
Bond Position:  [6.70053049]


portfolio before change:  [6.59615248]
curr_Stock_Price:  100.61957876038532
curr_Factors:  [100.61957876]
mat_Sqrt:  [[0.15]]
grads:  [0.02296843]
Stock Position:  0.022968428130737926
Bond Position:  [4.28507892]


portfolio before change:  [6.58134407]
curr_Stock_Price:  99.96318914052601
curr_Factors:  [99.96318914]
mat_Sqrt:  [[0.15]]
grads:  [-0.15054182]
Stock Position:  -0.15054182261415094
Bond Position:  [21.62998476]


portfolio before change:  [6.62480234]
curr_Stock_Price:  99.68349043245135
curr_Factors:  [99.68349043]
mat_Sqrt:  [[0.15]]
grads:  [-0.02835718]
Stock Position:  -0.02835718084815925
Bond Position:  [9.45154511]


portfolio before change:  [6.60568986]
curr_Stock_Price:  100.37831335601035
curr_Factors:  [100.37831336]
mat_Sqrt:  [[0.15]]
grads:  [0.05467793]
Stock Position:  0.05467793195331502
Bond Position:  [1.11721127]


portfolio before change:  [6.55737282]
curr_Stock_Price:  99.49337014475951
curr_Factors:  [99.49337014]
mat_Sqrt:  [[0.15]]
grads:  [0.10531129]
Stock Position:  0.105311285378345
Bond Position:  [-3.92040187]


portfolio before change:  [6.53469217]
curr_Stock_Price:  99.28032918286395
curr_Factors:  [99.28032918]
mat_Sqrt:  [[0.15]]
grads:  [0.13078845]
Stock Position:  0.13078845062972702
Bond Position:  [-6.45002826]


portfolio before change:  [6.57838461]
curr_Stock_Price:  99.61748111139033
curr_Factors:  [99.61748111]
mat_Sqrt:  [[0.15]]
grads:  [-0.02686541]
Stock Position:  -0.026865414163305245
Bond Position:  [9.2546495]


portfolio before change:  [6.57281594]
curr_Stock_Price:  99.84629228553062
curr_Factors:  [99.84629229]
mat_Sqrt:  [[0.15]]
grads:  [0.01108205]
Stock Position:  0.011082045576089595
Bond Position:  [5.46631478]


portfolio before change:  [6.57698516]
curr_Stock_Price:  100.19167658683524
curr_Factors:  [100.19167659]
mat_Sqrt:  [[0.15]]
grads:  [-0.02900492]
Stock Position:  -0.02900491878988536
Bond Position:  [9.4830366]


portfolio before change:  [6.59235808]
curr_Stock_Price:  99.68210047052926
curr_Factors:  [99.68210047]
mat_Sqrt:  [[0.15]]
grads:  [0.07721036]
Stock Position:  0.07721036258539218
Bond Position:  [-1.10413304]


portfolio before change:  [6.62875573]
curr_Stock_Price:  100.15440319591745
curr_Factors:  [100.1544032]
mat_Sqrt:  [[0.15]]
grads:  [-0.01322618]
Stock Position:  -0.013226177916393867
Bond Position:  [7.95341569]


portfolio before change:  [6.63127645]
curr_Stock_Price:  100.0014028713615
curr_Factors:  [100.00140287]
mat_Sqrt:  [[0.15]]
grads:  [-0.09273112]
Stock Position:  -0.09273111665939583
Bond Position:  [15.9045182]


portfolio before change:  [6.61036684]
curr_Stock_Price:  100.23760918537076
curr_Factors:  [100.23760919]
mat_Sqrt:  [[0.15]]
grads:  [-0.00682224]
Stock Position:  -0.006822239196346188
Bond Position:  [7.29421178]


portfolio before change:  [6.61425961]
curr_Stock_Price:  99.73383509439083
curr_Factors:  [99.73383509]
mat_Sqrt:  [[0.15]]
grads:  [-0.01918437]
Stock Position:  -0.019184371479567558
Bond Position:  [8.52759055]


portfolio before change:  [6.62516404]
curr_Stock_Price:  99.19321556067398
curr_Factors:  [99.19321556]
mat_Sqrt:  [[0.15]]
grads:  [0.02811686]
Stock Position:  0.028116861277428004
Bond Position:  [3.83616216]


portfolio before change:  [6.60974455]
curr_Stock_Price:  98.63628076453743
curr_Factors:  [98.63628076]
mat_Sqrt:  [[0.15]]
grads:  [-0.05202363]
Stock Position:  -0.05202362954812779
Bond Position:  [11.74116188]


portfolio before change:  [6.61126082]
curr_Stock_Price:  98.6212409887638
curr_Factors:  [98.62124099]
mat_Sqrt:  [[0.15]]
grads:  [0.01362629]
Stock Position:  0.013626289794659685
Bond Position:  [5.26741921]


portfolio before change:  [6.60111185]
curr_Stock_Price:  97.85227158044528
curr_Factors:  [97.85227158]
mat_Sqrt:  [[0.15]]
grads:  [-0.03180976]
Stock Position:  -0.031809755602122645
Bond Position:  [9.71376869]


portfolio before change:  [6.6020596]
curr_Stock_Price:  97.84156341693009
curr_Factors:  [97.84156342]
mat_Sqrt:  [[0.15]]
grads:  [-0.09079303]
Stock Position:  -0.09079302775970229
Bond Position:  [15.48539138]


portfolio before change:  [6.64729395]
curr_Stock_Price:  97.35400968822069
curr_Factors:  [97.35400969]
mat_Sqrt:  [[0.15]]
grads:  [-0.004225]
Stock Position:  -0.004225001393489084
Bond Position:  [7.05861477]


portfolio before change:  [6.6531612]
curr_Stock_Price:  96.0697326923075
curr_Factors:  [96.06973269]
mat_Sqrt:  [[0.15]]
grads:  [-0.0177767]
Stock Position:  -0.01777669543171199
Bond Position:  [8.36096357]


portfolio before change:  [6.63936995]
curr_Stock_Price:  96.87493409670515
curr_Factors:  [96.8749341]
mat_Sqrt:  [[0.15]]
grads:  [0.00205105]
Stock Position:  0.0020510536751341206
Bond Position:  [6.44067426]


portfolio before change:  [6.63889988]
curr_Stock_Price:  96.44948053401933
curr_Factors:  [96.44948053]
mat_Sqrt:  [[0.15]]
grads:  [-0.02561186]
Stock Position:  -0.0256118642454489
Bond Position:  [9.10915088]


portfolio before change:  [6.640449]
curr_Stock_Price:  96.41122540113186
curr_Factors:  [96.4112254]
mat_Sqrt:  [[0.15]]
grads:  [0.01943528]
Stock Position:  0.019435279063143594
Bond Position:  [4.76666993]


portfolio before change:  [6.63800947]
curr_Stock_Price:  96.270375257142
curr_Factors:  [96.27037526]
mat_Sqrt:  [[0.15]]
grads:  [0.02382024]
Stock Position:  0.023820243153732903
Bond Position:  [4.34482572]


portfolio before change:  [6.64329488]
curr_Stock_Price:  96.48086217219746
curr_Factors:  [96.48086217]
mat_Sqrt:  [[0.15]]
grads:  [0.00218419]
Stock Position:  0.002184194963127968
Bond Position:  [6.43256186]


portfolio before change:  [6.64265632]
curr_Stock_Price:  96.00443576465784
curr_Factors:  [96.00443576]
mat_Sqrt:  [[0.15]]
grads:  [0.05676067]
Stock Position:  0.05676067150839486
Bond Position:  [1.19338008]


portfolio before change:  [6.63693549]
curr_Stock_Price:  95.90233319300937
curr_Factors:  [95.90233319]
mat_Sqrt:  [[0.15]]
grads:  [0.05909821]
Stock Position:  0.05909821252705121
Bond Position:  [0.96927903]


portfolio before change:  [6.64177362]
curr_Stock_Price:  95.98317392053251
curr_Factors:  [95.98317392]
mat_Sqrt:  [[0.15]]
grads:  [0.05677626]
Stock Position:  0.056776257826469695
Bond Position:  [1.19220819]


portfolio before change:  [6.6647988]
curr_Stock_Price:  96.38740393758513
curr_Factors:  [96.38740394]
mat_Sqrt:  [[0.15]]
grads:  [0.04298679]
Stock Position:  0.04298679118037298
Bond Position:  [2.5214136]


portfolio before change:  [6.6348004]
curr_Stock_Price:  95.68588621927869
curr_Factors:  [95.68588622]
mat_Sqrt:  [[0.15]]
grads:  [0.08858976]
Stock Position:  0.08858976342055087
Bond Position:  [-1.84198962]


portfolio before change:  [6.62672512]
curr_Stock_Price:  95.59603219130808
curr_Factors:  [95.59603219]
mat_Sqrt:  [[0.15]]
grads:  [-0.02655646]
Stock Position:  -0.026556456385711757
Bond Position:  [9.16541698]


portfolio before change:  [6.6325398]
curr_Stock_Price:  95.39864804999142
curr_Factors:  [95.39864805]
mat_Sqrt:  [[0.15]]
grads:  [-0.02813132]
Stock Position:  -0.02813132381994723
Bond Position:  [9.31623006]


portfolio before change:  [6.6378882]
curr_Stock_Price:  95.22922432993042
curr_Factors:  [95.22922433]
mat_Sqrt:  [[0.15]]
grads:  [-0.17479451]
Stock Position:  -0.1747945104555605
Bond Position:  [23.28343385]


portfolio before change:  [6.86946975]
curr_Stock_Price:  93.91267105588143
curr_Factors:  [93.91267106]
mat_Sqrt:  [[0.15]]
grads:  [-0.08640303]
Stock Position:  -0.086403030036896
Bond Position:  [14.98380908]


portfolio before change:  [6.79302999]
curr_Stock_Price:  94.80819833224228
curr_Factors:  [94.80819833]
mat_Sqrt:  [[0.15]]
grads:  [-0.02086698]
Stock Position:  -0.020866983150749693
Bond Position:  [8.77139107]


portfolio before change:  [6.80150774]
curr_Stock_Price:  94.4281952603822
curr_Factors:  [94.42819526]
mat_Sqrt:  [[0.15]]
grads:  [-0.04010452]
Stock Position:  -0.04010451870365634
Bond Position:  [10.58850506]


portfolio before change:  [6.78961617]
curr_Stock_Price:  94.74121173220786
curr_Factors:  [94.74121173]
mat_Sqrt:  [[0.15]]
grads:  [0.18625927]
Stock Position:  0.18625927374531953
Bond Position:  [-10.85681312]


portfolio before change:  [6.741641]
curr_Stock_Price:  94.48728295135055
curr_Factors:  [94.48728295]
mat_Sqrt:  [[0.15]]
grads:  [0.05551265]
Stock Position:  0.05551264873174635
Bond Position:  [1.49640166]


portfolio before change:  [6.73921193]
curr_Stock_Price:  94.44184099951318
curr_Factors:  [94.441841]
mat_Sqrt:  [[0.15]]
grads:  [0.01148511]
Stock Position:  0.01148510596308882
Bond Position:  [5.65453738]


portfolio before change:  [6.73140346]
curr_Stock_Price:  93.73119085983038
curr_Factors:  [93.73119086]
mat_Sqrt:  [[0.15]]
grads:  [0.10436243]
Stock Position:  0.10436242632276219
Bond Position:  [-3.05061104]


portfolio before change:  [6.81691614]
curr_Stock_Price:  94.55239975563813
curr_Factors:  [94.55239976]
mat_Sqrt:  [[0.15]]
grads:  [-0.13074922]
Stock Position:  -0.13074922191307511
Bond Position:  [19.17956884]


portfolio before change:  [6.79909245]
curr_Stock_Price:  94.69788783762272
curr_Factors:  [94.69788784]
mat_Sqrt:  [[0.15]]
grads:  [0.13055035]
Stock Position:  0.13055035405141105
Bond Position:  [-5.56375034]


portfolio before change:  [6.82202061]
curr_Stock_Price:  94.87617852101151
curr_Factors:  [94.87617852]
mat_Sqrt:  [[0.15]]
grads:  [-0.08340708]
Stock Position:  -0.0834070774289298
Bond Position:  [14.73536538]


portfolio before change:  [6.80033586]
curr_Stock_Price:  95.14720757124971
curr_Factors:  [95.14720757]
mat_Sqrt:  [[0.15]]
grads:  [-0.02605287]
Stock Position:  -0.026052867722422737
Bond Position:  [9.27919348]


portfolio before change:  [6.7948538]
curr_Stock_Price:  95.37988941375484
curr_Factors:  [95.37988941]
mat_Sqrt:  [[0.15]]
grads:  [0.0514754]
Stock Position:  0.051475402872029126
Bond Position:  [1.88513557]


portfolio before change:  [6.8490141]
curr_Stock_Price:  96.42975921779261
curr_Factors:  [96.42975922]
mat_Sqrt:  [[0.15]]
grads:  [-0.01551059]
Stock Position:  -0.01551059467416252
Bond Position:  [8.34469701]


portfolio before change:  [6.84699317]
curr_Stock_Price:  96.59367869377536
curr_Factors:  [96.59367869]
mat_Sqrt:  [[0.15]]
grads:  [0.01847161]
Stock Position:  0.018471613545096036
Bond Position:  [5.06275206]


portfolio before change:  [6.83723863]
curr_Stock_Price:  96.0484651330196
curr_Factors:  [96.04846513]
mat_Sqrt:  [[0.15]]
grads:  [0.05505271]
Stock Position:  0.0550527080128199
Bond Position:  [1.54951052]


portfolio before change:  [6.89430802]
curr_Stock_Price:  97.08333787577038
curr_Factors:  [97.08333788]
mat_Sqrt:  [[0.15]]
grads:  [-0.07292148]
Stock Position:  -0.07292147549546539
Bond Position:  [13.97376826]


portfolio before change:  [6.89088018]
curr_Stock_Price:  97.14232232232006
curr_Factors:  [97.14232232]
mat_Sqrt:  [[0.15]]
grads:  [-0.17222039]
Stock Position:  -0.17222038519828264
Bond Position:  [23.62076834]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.89088018]
Stock Price:  97.28708453633573
PL:  [6.89088018]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-6.60194006e-02]
 [ 5.45823498e-04]
 [ 8.13759412e-03]
 [ 3.21050420e-03]
 [ 6.28266233e-03]
 [ 1.21488717e-02]
 [-1.13558524e-04]
 [ 1.09498349e-02]
 [-1.36856698e-02]
 [ 1.95708729e-02]
 [ 9.71900820e-03]
 [-1.04270214e-02]
 [ 2.55711843e-02]
 [ 1.10835008e-02]
 [ 1.43645014e-03]
 [-1.01368420e-02]
 [ 1.47282447e-02]
 [ 2.01750838e-02]
 [ 2.18841507e-02]
 [ 2.70052831e-03]
 [ 5.32054513e-02]
 [-1.69589955e-02]
 [-1.38138768e-03]
 [ 1.07200477e-02]
 [ 1.34364799e-02]
 [-3.89178146e-03]
 [ 1.18400950e-02]
 [-5.55518675e-04]
 [ 4.55910853e-03]
 [-1.92294013e-02]
 [-5.69593635e-03]
 [ 3.92876857e-02]
 [ 4.26591938e-03]
 [-9.15454126e-03]
 [-4.85865255e-03]
 [-5.70633710e-03]
 [-1.91774718e-03]
 [-4.62790746e-03]
 [ 6.82775960e-03]
 [-6.01838888e-03]
 [-6.37652405e-02]
 [-4.80186416e-03]
 [ 1.93012257e-02]
 [-1.59234320e-02]
 [-7.28030860e-03]
 [ 3.23096044e-03]
 [-1.35177230e-02]
 [ 2.30054942e-02]
 [ 3.55434826e-02]
 [-1.33513286e-02]
 [-4.41063166e-03]
 [ 3.60756579e-03]
 [ 3.39282082e-03]
 [-5.73032440e-03]
 [-1.24606908e-02]
 [ 1.36088527e-02]
 [-3.45824539e-02]
 [-1.06529056e-02]
 [ 2.02184473e-02]
 [-6.32585132e-03]
 [ 1.31035481e-02]
 [-1.43923436e-02]
 [-1.27402826e-02]
 [-3.23179873e-03]
 [ 4.90111701e-02]
 [-1.80653241e-02]
 [ 2.53708116e-02]
 [ 3.10081850e-03]
 [ 9.10584370e-03]
 [-1.80994023e-02]
 [-7.73827795e-03]
 [-7.96127904e-03]
 [ 1.64428456e-03]
 [ 8.54538277e-03]
 [ 9.10112837e-03]
 [-8.93103968e-03]
 [-1.32025568e-03]
 [-7.94367047e-03]
 [ 1.11623979e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.88865763]
curr_Stock_Price:  100.63127992780193
curr_Factors:  [100.63127993]
mat_Sqrt:  [[0.15]]
grads:  [-0.44012934]
Stock Position:  -0.440129337244977
Bond Position:  [56.17943617]


portfolio before change:  [11.7679617]
curr_Stock_Price:  100.91348617140397
curr_Factors:  [100.91348617]
mat_Sqrt:  [[0.15]]
grads:  [0.00363882]
Stock Position:  0.0036388233172818165
Bond Position:  [11.40075536]


portfolio before change:  [11.77064298]
curr_Stock_Price:  101.45451478876844
curr_Factors:  [101.45451479]
mat_Sqrt:  [[0.15]]
grads:  [0.05425063]
Stock Position:  0.0542506274947392
Bond Position:  [6.26667189]


portfolio before change:  [11.78319969]
curr_Stock_Price:  101.67875243075815
curr_Factors:  [101.67875243]
mat_Sqrt:  [[0.15]]
grads:  [0.02140336]
Stock Position:  0.02140336133090141
Bond Position:  [9.60693261]


portfolio before change:  [11.7757455]
curr_Stock_Price:  101.3024261828997
curr_Factors:  [101.30242618]
mat_Sqrt:  [[0.15]]
grads:  [0.04188442]
Stock Position:  0.041884415544417165
Bond Position:  [7.53275258]


portfolio before change:  [11.79118365]
curr_Stock_Price:  101.65977480040416
curr_Factors:  [101.6597748]
mat_Sqrt:  [[0.15]]
grads:  [0.08099248]
Stock Position:  0.08099247773449057
Bond Position:  [3.5575066]


portfolio before change:  [11.78651623]
curr_Stock_Price:  101.59940173122196
curr_Factors:  [101.59940173]
mat_Sqrt:  [[0.15]]
grads:  [-0.00075706]
Stock Position:  -0.0007570568282572192
Bond Position:  [11.86343275]


portfolio before change:  [11.78682032]
curr_Stock_Price:  102.17717188922559
curr_Factors:  [102.17717189]
mat_Sqrt:  [[0.15]]
grads:  [0.0729989]
Stock Position:  0.0729988996391133
Bond Position:  [4.3279992]


portfolio before change:  [11.80775307]
curr_Stock_Price:  102.46022060365375
curr_Factors:  [102.4602206]
mat_Sqrt:  [[0.15]]
grads:  [-0.0912378]
Stock Position:  -0.09123779897095062
Bond Position:  [21.15599808]


portfolio before change:  [11.7925613]
curr_Stock_Price:  102.641220782845
curr_Factors:  [102.64122078]
mat_Sqrt:  [[0.15]]
grads:  [0.13047249]
Stock Position:  0.13047248576866086
Bond Position:  [-1.59929391]


portfolio before change:  [11.86518563]
curr_Stock_Price:  103.19861250671826
curr_Factors:  [103.19861251]
mat_Sqrt:  [[0.15]]
grads:  [0.06479339]
Stock Position:  0.06479338803202553
Bond Position:  [5.17859788]


portfolio before change:  [11.80003277]
curr_Stock_Price:  102.18806911552194
curr_Factors:  [102.18806912]
mat_Sqrt:  [[0.15]]
grads:  [-0.06951348]
Stock Position:  -0.06951347627906557
Bond Position:  [18.90348069]


portfolio before change:  [11.78235321]
curr_Stock_Price:  102.45939871004919
curr_Factors:  [102.45939871]
mat_Sqrt:  [[0.15]]
grads:  [0.17047456]
Stock Position:  0.17047456184667623
Bond Position:  [-5.68436789]


portfolio before change:  [11.76071358]
curr_Stock_Price:  102.33454522259638
curr_Factors:  [102.33454522]
mat_Sqrt:  [[0.15]]
grads:  [0.07389001]
Stock Position:  0.07389000536008618
Bond Position:  [4.19921349]


portfolio before change:  [11.69745304]
curr_Stock_Price:  101.47484844784123
curr_Factors:  [101.47484845]
mat_Sqrt:  [[0.15]]
grads:  [0.00957633]
Stock Position:  0.009576334256534483
Bond Position:  [10.72569598]


portfolio before change:  [11.69741711]
curr_Stock_Price:  101.40109227671506
curr_Factors:  [101.40109228]
mat_Sqrt:  [[0.15]]
grads:  [-0.06757895]
Stock Position:  -0.06757894646896673
Bond Position:  [18.54999609]


portfolio before change:  [11.72665638]
curr_Stock_Price:  100.98558027733854
curr_Factors:  [100.98558028]
mat_Sqrt:  [[0.15]]
grads:  [0.0981883]
Stock Position:  0.09818829801450281
Bond Position:  [1.81105413]


portfolio before change:  [11.7424951]
curr_Stock_Price:  101.14573705900006
curr_Factors:  [101.14573706]
mat_Sqrt:  [[0.15]]
grads:  [0.13450056]
Stock Position:  0.1345005589421317
Bond Position:  [-1.86166307]


portfolio before change:  [11.67592506]
curr_Stock_Price:  100.65165967438554
curr_Factors:  [100.65165967]
mat_Sqrt:  [[0.15]]
grads:  [0.14589434]
Stock Position:  0.14589433804621466
Bond Position:  [-3.00858221]


portfolio before change:  [11.65821693]
curr_Stock_Price:  100.5315721928515
curr_Factors:  [100.53157219]
mat_Sqrt:  [[0.15]]
grads:  [0.01800352]
Stock Position:  0.01800352207239926
Bond Position:  [9.84829455]


portfolio before change:  [11.63399578]
curr_Stock_Price:  99.15202601229825
curr_Factors:  [99.15202601]
mat_Sqrt:  [[0.15]]
grads:  [0.35470301]
Stock Position:  0.35470300849806674
Bond Position:  [-23.53552615]


portfolio before change:  [11.63951794]
curr_Stock_Price:  99.17174160763898
curr_Factors:  [99.17174161]
mat_Sqrt:  [[0.15]]
grads:  [-0.11305997]
Stock Position:  -0.11305996997566382
Bond Position:  [22.85187207]


portfolio before change:  [11.63940028]
curr_Stock_Price:  99.1854152969964
curr_Factors:  [99.1854153]
mat_Sqrt:  [[0.15]]
grads:  [-0.00920925]
Stock Position:  -0.009209251211311966
Bond Position:  [12.55282369]


portfolio before change:  [11.63140072]
curr_Stock_Price:  100.13925414848046
curr_Factors:  [100.13925415]
mat_Sqrt:  [[0.15]]
grads:  [0.07146698]
Stock Position:  0.0714669848602934
Bond Position:  [4.47475016]


portfolio before change:  [11.6326236]
curr_Stock_Price:  100.15245184216927
curr_Factors:  [100.15245184]
mat_Sqrt:  [[0.15]]
grads:  [0.08957653]
Stock Position:  0.08957653283051703
Bond Position:  [2.66131421]


portfolio before change:  [11.6786623]
curr_Stock_Price:  100.66455436013764
curr_Factors:  [100.66455436]
mat_Sqrt:  [[0.15]]
grads:  [-0.02594521]
Stock Position:  -0.02594520970931653
Bond Position:  [14.29042527]


portfolio before change:  [11.65932789]
curr_Stock_Price:  101.44418139818863
curr_Factors:  [101.4441814]
mat_Sqrt:  [[0.15]]
grads:  [0.07893397]
Stock Position:  0.07893396675593335
Bond Position:  [3.65193625]


portfolio before change:  [11.6375249]
curr_Stock_Price:  101.16507151546186
curr_Factors:  [101.16507152]
mat_Sqrt:  [[0.15]]
grads:  [-0.00370346]
Stock Position:  -0.003703457834262648
Bond Position:  [12.01218547]


portfolio before change:  [11.63726008]
curr_Stock_Price:  101.43930226209233
curr_Factors:  [101.43930226]
mat_Sqrt:  [[0.15]]
grads:  [0.03039406]
Stock Position:  0.030394056892567557
Bond Position:  [8.55410816]


portfolio before change:  [11.65634679]
curr_Stock_Price:  102.04968690658593
curr_Factors:  [102.04968691]
mat_Sqrt:  [[0.15]]
grads:  [-0.12819601]
Stock Position:  -0.12819600895162966
Bond Position:  [24.73870937]


portfolio before change:  [11.58309311]
curr_Stock_Price:  102.63316763361307
curr_Factors:  [102.63316763]
mat_Sqrt:  [[0.15]]
grads:  [-0.03797291]
Stock Position:  -0.037972909027259714
Bond Position:  [15.48037305]


portfolio before change:  [11.56306569]
curr_Stock_Price:  103.18606101500944
curr_Factors:  [103.18606102]
mat_Sqrt:  [[0.15]]
grads:  [0.2619179]
Stock Position:  0.26191790472422144
Bond Position:  [-15.4632112]


portfolio before change:  [11.83381979]
curr_Stock_Price:  104.22348752213212
curr_Factors:  [104.22348752]
mat_Sqrt:  [[0.15]]
grads:  [0.02843946]
Stock Position:  0.028439462526399523
Bond Position:  [8.86975982]


portfolio before change:  [11.86159003]
curr_Stock_Price:  105.18046279001894
curr_Factors:  [105.18046279]
mat_Sqrt:  [[0.15]]
grads:  [-0.06103028]
Stock Position:  -0.061030275077331886
Bond Position:  [18.28078261]


portfolio before change:  [11.9058426]
curr_Stock_Price:  104.47409230924724
curr_Factors:  [104.47409231]
mat_Sqrt:  [[0.15]]
grads:  [-0.03239102]
Stock Position:  -0.032391017011646
Bond Position:  [15.2898647]


portfolio before change:  [11.88934531]
curr_Stock_Price:  105.01291251702362
curr_Factors:  [105.01291252]
mat_Sqrt:  [[0.15]]
grads:  [-0.03804225]
Stock Position:  -0.03804224731825542
Bond Position:  [15.8842725]


portfolio before change:  [11.88360779]
curr_Stock_Price:  105.18982939843156
curr_Factors:  [105.1898294]
mat_Sqrt:  [[0.15]]
grads:  [-0.01278498]
Stock Position:  -0.012784981227282484
Bond Position:  [13.22845779]


portfolio before change:  [11.87669566]
curr_Stock_Price:  105.79514454444133
curr_Factors:  [105.79514454]
mat_Sqrt:  [[0.15]]
grads:  [-0.03085272]
Stock Position:  -0.030852716419916805
Bond Position:  [15.14076325]


portfolio before change:  [11.8833315]
curr_Stock_Price:  105.6107354945379
curr_Factors:  [105.61073549]
mat_Sqrt:  [[0.15]]
grads:  [0.0455184]
Stock Position:  0.045518397338115905
Bond Position:  [7.07610008]


portfolio before change:  [11.90033396]
curr_Stock_Price:  105.974548611555
curr_Factors:  [105.97454861]
mat_Sqrt:  [[0.15]]
grads:  [-0.04012259]
Stock Position:  -0.04012259255704212
Bond Position:  [16.1523076]


portfolio before change:  [11.87850241]
curr_Stock_Price:  106.54383142963026
curr_Factors:  [106.54383143]
mat_Sqrt:  [[0.15]]
grads:  [-0.4251016]
Stock Position:  -0.42510160359125954
Bond Position:  [57.170456]


portfolio before change:  [12.19698519]
curr_Stock_Price:  105.80304495561515
curr_Factors:  [105.80304496]
mat_Sqrt:  [[0.15]]
grads:  [-0.03201243]
Stock Position:  -0.032012427754383344
Bond Position:  [15.58399753]


portfolio before change:  [12.18936781]
curr_Stock_Price:  106.07142230446212
curr_Factors:  [106.0714223]
mat_Sqrt:  [[0.15]]
grads:  [0.12867484]
Stock Position:  0.12867483814693342
Bond Position:  [-1.45935528]


portfolio before change:  [12.10786791]
curr_Stock_Price:  105.4387524589738
curr_Factors:  [105.43875246]
mat_Sqrt:  [[0.15]]
grads:  [-0.10615621]
Stock Position:  -0.10615621351625612
Bond Position:  [23.30084663]


portfolio before change:  [12.05807487]
curr_Stock_Price:  105.92152581161321
curr_Factors:  [105.92152581]
mat_Sqrt:  [[0.15]]
grads:  [-0.04853539]
Stock Position:  -0.04853539069543154
Bond Position:  [17.19901751]


portfolio before change:  [12.03494609]
curr_Stock_Price:  106.42020822425943
curr_Factors:  [106.42020822]
mat_Sqrt:  [[0.15]]
grads:  [0.02153974]
Stock Position:  0.02153973624558089
Bond Position:  [9.74268288]


portfolio before change:  [12.0415194]
curr_Stock_Price:  106.69710911665642
curr_Factors:  [106.69710912]
mat_Sqrt:  [[0.15]]
grads:  [-0.09011815]
Stock Position:  -0.09011815354168276
Bond Position:  [21.65686587]


portfolio before change:  [12.06857114]
curr_Stock_Price:  106.41194858244067
curr_Factors:  [106.41194858]
mat_Sqrt:  [[0.15]]
grads:  [0.15336996]
Stock Position:  0.15336996154741236
Bond Position:  [-4.25182532]


portfolio before change:  [12.06226062]
curr_Stock_Price:  106.37253556624249
curr_Factors:  [106.37253557]
mat_Sqrt:  [[0.15]]
grads:  [0.23695655]
Stock Position:  0.2369565505721634
Bond Position:  [-13.14340848]


portfolio before change:  [11.97661189]
curr_Stock_Price:  106.01454910356152
curr_Factors:  [106.0145491]
mat_Sqrt:  [[0.15]]
grads:  [-0.08900886]
Stock Position:  -0.08900885749260762
Bond Position:  [21.41284579]


portfolio before change:  [12.03414183]
curr_Stock_Price:  105.38324572763379
curr_Factors:  [105.38324573]
mat_Sqrt:  [[0.15]]
grads:  [-0.02940421]
Stock Position:  -0.029404211050574787
Bond Position:  [15.13285303]


portfolio before change:  [12.02972074]
curr_Stock_Price:  105.56576816945933
curr_Factors:  [105.56576817]
mat_Sqrt:  [[0.15]]
grads:  [0.02405044]
Stock Position:  0.02405043858787609
Bond Position:  [9.49081771]


portfolio before change:  [12.03721825]
curr_Stock_Price:  105.85284478176246
curr_Factors:  [105.85284478]
mat_Sqrt:  [[0.15]]
grads:  [0.02261881]
Stock Position:  0.022618805438855985
Bond Position:  [9.64295335]


portfolio before change:  [12.04714291]
curr_Stock_Price:  106.26497781585122
curr_Factors:  [106.26497782]
mat_Sqrt:  [[0.15]]
grads:  [-0.03820216]
Stock Position:  -0.0382021626577487
Bond Position:  [16.10669488]


portfolio before change:  [12.027077]
curr_Stock_Price:  106.81658559901844
curr_Factors:  [106.8165856]
mat_Sqrt:  [[0.15]]
grads:  [-0.08307127]
Stock Position:  -0.08307127203741488
Bond Position:  [20.90046664]


portfolio before change:  [11.94467669]
curr_Stock_Price:  107.8242338830407
curr_Factors:  [107.82423388]
mat_Sqrt:  [[0.15]]
grads:  [0.09072568]
Stock Position:  0.09072568434917423
Bond Position:  [2.16224929]


portfolio before change:  [11.85651898]
curr_Stock_Price:  106.85104903611465
curr_Factors:  [106.85104904]
mat_Sqrt:  [[0.15]]
grads:  [-0.23054969]
Stock Position:  -0.23054969266604203
Bond Position:  [36.49099549]


portfolio before change:  [11.86443984]
curr_Stock_Price:  106.82658529681692
curr_Factors:  [106.8265853]
mat_Sqrt:  [[0.15]]
grads:  [-0.07101937]
Stock Position:  -0.07101937071892038
Bond Position:  [19.45119671]


portfolio before change:  [11.89615039]
curr_Stock_Price:  106.39719811014297
curr_Factors:  [106.39719811]
mat_Sqrt:  [[0.15]]
grads:  [0.13478965]
Stock Position:  0.13478964874338398
Bond Position:  [-2.44509057]


portfolio before change:  [11.82307553]
curr_Stock_Price:  105.85619186964605
curr_Factors:  [105.85619187]
mat_Sqrt:  [[0.15]]
grads:  [-0.04217234]
Stock Position:  -0.04217234211520407
Bond Position:  [16.28727906]


portfolio before change:  [11.83262412]
curr_Stock_Price:  105.6539122711525
curr_Factors:  [105.65391227]
mat_Sqrt:  [[0.15]]
grads:  [0.08735699]
Stock Position:  0.08735698703423983
Bond Position:  [2.60301667]


portfolio before change:  [11.7906709]
curr_Stock_Price:  105.17179957541013
curr_Factors:  [105.17179958]
mat_Sqrt:  [[0.15]]
grads:  [-0.09594896]
Stock Position:  -0.09594895732877494
Bond Position:  [21.88179541]


portfolio before change:  [11.81496794]
curr_Stock_Price:  104.93282475235526
curr_Factors:  [104.93282475]
mat_Sqrt:  [[0.15]]
grads:  [-0.08493522]
Stock Position:  -0.0849352173118055
Bond Position:  [20.72746021]


portfolio before change:  [11.8343198]
curr_Stock_Price:  104.72023501173386
curr_Factors:  [104.72023501]
mat_Sqrt:  [[0.15]]
grads:  [-0.02154532]
Stock Position:  -0.02154532484399341
Bond Position:  [14.09055128]


portfolio before change:  [11.82928365]
curr_Stock_Price:  104.99485778138033
curr_Factors:  [104.99485778]
mat_Sqrt:  [[0.15]]
grads:  [0.32674113]
Stock Position:  0.32674113393452114
Bond Position:  [-22.47685524]


portfolio before change:  [11.44463211]
curr_Stock_Price:  103.82192099589716
curr_Factors:  [103.821921]
mat_Sqrt:  [[0.15]]
grads:  [-0.12043549]
Stock Position:  -0.12043549416716019
Bond Position:  [23.94847647]


portfolio before change:  [11.51620069]
curr_Stock_Price:  103.2401011716521
curr_Factors:  [103.24010117]
mat_Sqrt:  [[0.15]]
grads:  [0.16913874]
Stock Position:  0.16913874376350818
Bond Position:  [-5.94570033]


portfolio before change:  [11.50877037]
curr_Stock_Price:  103.19836796636413
curr_Factors:  [103.19836797]
mat_Sqrt:  [[0.15]]
grads:  [0.02067212]
Stock Position:  0.02067212334633769
Bond Position:  [9.37544098]


portfolio before change:  [11.51662182]
curr_Stock_Price:  103.54982973993415
curr_Factors:  [103.54982974]
mat_Sqrt:  [[0.15]]
grads:  [0.06070562]
Stock Position:  0.06070562469766113
Bond Position:  [5.23056472]


portfolio before change:  [11.49043038]
curr_Stock_Price:  103.11299449292945
curr_Factors:  [103.11299449]
mat_Sqrt:  [[0.15]]
grads:  [-0.12066268]
Stock Position:  -0.12066268209065506
Bond Position:  [23.93232086]


portfolio before change:  [11.48762838]
curr_Stock_Price:  103.1486129541877
curr_Factors:  [103.14861295]
mat_Sqrt:  [[0.15]]
grads:  [-0.05158852]
Stock Position:  -0.051588519688300145
Bond Position:  [16.80891263]


portfolio before change:  [11.52318863]
curr_Stock_Price:  102.47967218763732
curr_Factors:  [102.47967219]
mat_Sqrt:  [[0.15]]
grads:  [-0.05307519]
Stock Position:  -0.053075193630112046
Bond Position:  [16.96231708]


portfolio before change:  [11.54209954]
curr_Stock_Price:  102.14334308196956
curr_Factors:  [102.14334308]
mat_Sqrt:  [[0.15]]
grads:  [0.0109619]
Stock Position:  0.010961897057961936
Bond Position:  [10.42241473]


portfolio before change:  [11.53027281]
curr_Stock_Price:  101.00502235455713
curr_Factors:  [101.00502235]
mat_Sqrt:  [[0.15]]
grads:  [0.05696922]
Stock Position:  0.056969218478622234
Bond Position:  [5.77609562]


portfolio before change:  [11.51218339]
curr_Stock_Price:  100.6811555158707
curr_Factors:  [100.68115552]
mat_Sqrt:  [[0.15]]
grads:  [0.06067419]
Stock Position:  0.060674189114772646
Bond Position:  [5.40343592]


portfolio before change:  [11.50082181]
curr_Stock_Price:  100.48833377856987
curr_Factors:  [100.48833378]
mat_Sqrt:  [[0.15]]
grads:  [-0.05954026]
Stock Position:  -0.0595402645457882
Bond Position:  [17.48392379]


portfolio before change:  [11.51531388]
curr_Stock_Price:  100.26328781399252
curr_Factors:  [100.26328781]
mat_Sqrt:  [[0.15]]
grads:  [-0.0088017]
Stock Position:  -0.008801704528458056
Bond Position:  [12.39780172]


portfolio before change:  [11.50985006]
curr_Stock_Price:  100.97209538218905
curr_Factors:  [100.97209538]
mat_Sqrt:  [[0.15]]
grads:  [-0.0529578]
Stock Position:  -0.052957803104142775
Bond Position:  [16.8571104]


portfolio before change:  [11.50221403]
curr_Stock_Price:  101.13618132270422
curr_Factors:  [101.13618132]
mat_Sqrt:  [[0.15]]
grads:  [0.07441599]
Stock Position:  0.07441598610865573
Bond Position:  [3.97606536]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.50221403]
Stock Price:  100.55310667728148
PL:  [10.94910735]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.36655046e-02]
 [ 3.01384676e-03]
 [ 1.55793753e-04]
 [ 2.47672238e-03]
 [ 9.86929754e-03]
 [ 1.17820819e-02]
 [ 1.11412836e-03]
 [ 9.08109321e-03]
 [-2.47779121e-03]
 [-2.02786507e-02]
 [ 1.02532828e-02]
 [-8.12027736e-03]
 [-4.32139926e-04]
 [ 4.34713290e-03]
 [ 5.01583554e-03]
 [ 3.21591758e-04]
 [ 8.43474923e-03]
 [ 9.59320357e-03]
 [ 2.22279969e-02]
 [ 2.03184144e-03]
 [ 8.03001278e-02]
 [-1.31617758e-02]
 [-1.58461942e-03]
 [ 1.01911758e-02]
 [ 1.55263927e-02]
 [-6.71513584e-03]
 [ 1.28723350e-02]
 [-3.57797937e-04]
 [ 2.95326619e-03]
 [-2.40892105e-02]
 [-4.03326181e-03]
 [ 7.73862617e-03]
 [ 1.34371833e-02]
 [ 1.11747676e-02]
 [ 4.69064514e-04]
 [-4.43187935e-03]
 [-6.93705178e-03]
 [ 7.14770208e-03]
 [ 1.40375182e-03]
 [-8.70252684e-03]
 [-2.19805629e-02]
 [-2.71497434e-03]
 [ 8.80744411e-03]
 [-1.37101455e-02]
 [ 1.53203461e-03]
 [ 1.30784202e-03]
 [-1.37075282e-02]
 [-4.79882359e-03]
 [-5.68845197e-04]
 [-2.36425414e-04]
 [-3.04556934e-03]
 [ 3.71486713e-03]
 [ 3.23667407e-05]
 [ 3.13542577e-03]
 [ 8.42445958e-04]
 [ 8.59005802e-03]
 [-4.17196582e-03]
 [-1.68349362e-02]
 [ 1.33918005e-02]
 [ 7.07195210e-03]
 [ 9.72669574e-03]
 [-1.32730360e-02]
 [-1.25545396e-02]
 [-2.20701866e-03]
 [-1.71121199e-02]
 [ 2.72414787e-02]
 [ 1.26167289e-02]
 [ 2.00081187e-03]
 [ 8.17121224e-03]
 [-1.71849271e-02]
 [ 5.56463624e-03]
 [ 1.54963228e-03]
 [-6.94569576e-04]
 [ 7.71919263e-03]
 [-2.30922379e-03]
 [ 2.68005486e-03]
 [ 3.75963804e-03]
 [-1.16399039e-02]
 [-2.20163468e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.78416344]
curr_Stock_Price:  99.98185742160763
curr_Factors:  [99.98185742]
mat_Sqrt:  [[0.15]]
grads:  [-0.2244367]
Stock Position:  -0.2244366972441411
Bond Position:  [24.2237613]


portfolio before change:  [1.92602116]
curr_Stock_Price:  99.35654217839878
curr_Factors:  [99.35654218]
mat_Sqrt:  [[0.15]]
grads:  [0.02009231]
Stock Position:  0.020092311761344114
Bond Position:  [-0.07028146]


portfolio before change:  [1.9328341]
curr_Stock_Price:  99.69584270786912
curr_Factors:  [99.69584271]
mat_Sqrt:  [[0.15]]
grads:  [0.00103863]
Stock Position:  0.0010386250199692724
Bond Position:  [1.8292875]


portfolio before change:  [1.93420675]
curr_Stock_Price:  100.90736695456904
curr_Factors:  [100.90736695]
mat_Sqrt:  [[0.15]]
grads:  [0.01651148]
Stock Position:  0.016511482510315884
Bond Position:  [0.26807653]


portfolio before change:  [1.92658471]
curr_Stock_Price:  100.4447313000695
curr_Factors:  [100.4447313]
mat_Sqrt:  [[0.15]]
grads:  [0.06579532]
Stock Position:  0.06579531695968124
Bond Position:  [-4.68220822]


portfolio before change:  [1.91910147]
curr_Stock_Price:  100.33544404794588
curr_Factors:  [100.33544405]
mat_Sqrt:  [[0.15]]
grads:  [0.07854721]
Stock Position:  0.07854721299543972
Bond Position:  [-5.96196802]


portfolio before change:  [1.92864676]
curr_Stock_Price:  100.46171100630436
curr_Factors:  [100.46171101]
mat_Sqrt:  [[0.15]]
grads:  [0.00742752]
Stock Position:  0.007427522384966367
Bond Position:  [1.18246515]


portfolio before change:  [1.93114032]
curr_Stock_Price:  100.78748074582322
curr_Factors:  [100.78748075]
mat_Sqrt:  [[0.15]]
grads:  [0.06054062]
Stock Position:  0.060540621428564784
Bond Position:  [-4.17059639]


portfolio before change:  [1.9379796]
curr_Stock_Price:  100.90475652882414
curr_Factors:  [100.90475653]
mat_Sqrt:  [[0.15]]
grads:  [-0.01651861]
Stock Position:  -0.016518608041711187
Bond Position:  [3.60478572]


portfolio before change:  [1.94446688]
curr_Stock_Price:  100.52567070087285
curr_Factors:  [100.5256707]
mat_Sqrt:  [[0.15]]
grads:  [-0.135191]
Stock Position:  -0.13519100480215815
Bond Position:  [15.53463331]


portfolio before change:  [1.93066879]
curr_Stock_Price:  100.63491637672328
curr_Factors:  [100.63491638]
mat_Sqrt:  [[0.15]]
grads:  [0.06835522]
Stock Position:  0.06835521874352148
Bond Position:  [-4.94825293]


portfolio before change:  [1.9813266]
curr_Stock_Price:  101.38053741710166
curr_Factors:  [101.38053742]
mat_Sqrt:  [[0.15]]
grads:  [-0.05413518]
Stock Position:  -0.054135182415145845
Bond Position:  [7.46958049]


portfolio before change:  [2.02172564]
curr_Stock_Price:  100.64289924674418
curr_Factors:  [100.64289925]
mat_Sqrt:  [[0.15]]
grads:  [-0.00288093]
Stock Position:  -0.0028809328403251655
Bond Position:  [2.31167108]


portfolio before change:  [2.02360943]
curr_Stock_Price:  100.03917184553238
curr_Factors:  [100.03917185]
mat_Sqrt:  [[0.15]]
grads:  [0.02898089]
Stock Position:  0.028980886023902797
Bond Position:  [-0.87561441]


portfolio before change:  [2.02049982]
curr_Stock_Price:  99.93376180452387
curr_Factors:  [99.9337618]
mat_Sqrt:  [[0.15]]
grads:  [0.0334389]
Stock Position:  0.03343890361172543
Bond Position:  [-1.32117561]


portfolio before change:  [2.02309875]
curr_Stock_Price:  100.01395287167803
curr_Factors:  [100.01395287]
mat_Sqrt:  [[0.15]]
grads:  [0.00214395]
Stock Position:  0.0021439450519485093
Bond Position:  [1.80867433]


portfolio before change:  [2.02318216]
curr_Stock_Price:  100.00013150060356
curr_Factors:  [100.0001315]
mat_Sqrt:  [[0.15]]
grads:  [0.05623166]
Stock Position:  0.05623166155252375
Bond Position:  [-3.59999139]


portfolio before change:  [2.0174712]
curr_Stock_Price:  99.90257157798925
curr_Factors:  [99.90257158]
mat_Sqrt:  [[0.15]]
grads:  [0.06395469]
Stock Position:  0.06395469045469541
Bond Position:  [-4.37176684]


portfolio before change:  [2.02215995]
curr_Stock_Price:  99.9801577635244
curr_Factors:  [99.98015776]
mat_Sqrt:  [[0.15]]
grads:  [0.14818665]
Stock Position:  0.14818664623586789
Bond Position:  [-12.79356431]


portfolio before change:  [2.13370245]
curr_Stock_Price:  100.73827008260051
curr_Factors:  [100.73827008]
mat_Sqrt:  [[0.15]]
grads:  [0.01354561]
Stock Position:  0.013545609584259023
Bond Position:  [0.76914118]


portfolio before change:  [2.13033682]
curr_Stock_Price:  100.48625449888523
curr_Factors:  [100.4862545]
mat_Sqrt:  [[0.15]]
grads:  [0.53533419]
Stock Position:  0.5353341854702441
Bond Position:  [-51.66339038]


portfolio before change:  [2.25768273]
curr_Stock_Price:  100.73016750691627
curr_Factors:  [100.73016751]
mat_Sqrt:  [[0.15]]
grads:  [-0.08774517]
Stock Position:  -0.08774517231163131
Bond Position:  [11.09626864]


portfolio before change:  [2.38422423]
curr_Stock_Price:  99.29592386245906
curr_Factors:  [99.29592386]
mat_Sqrt:  [[0.15]]
grads:  [-0.01056413]
Stock Position:  -0.010564129464232323
Bond Position:  [3.43319922]


portfolio before change:  [2.37480577]
curr_Stock_Price:  100.2077867478953
curr_Factors:  [100.20778675]
mat_Sqrt:  [[0.15]]
grads:  [0.06794117]
Stock Position:  0.06794117171636085
Bond Position:  [-4.43342868]


portfolio before change:  [2.447497]
curr_Stock_Price:  101.28177959283234
curr_Factors:  [101.28177959]
mat_Sqrt:  [[0.15]]
grads:  [0.10350928]
Stock Position:  0.1035092847721666
Bond Position:  [-8.03610756]


portfolio before change:  [2.36627348]
curr_Stock_Price:  100.50193405460818
curr_Factors:  [100.50193405]
mat_Sqrt:  [[0.15]]
grads:  [-0.04476757]
Stock Position:  -0.04476757224717525
Bond Position:  [6.86550107]


portfolio before change:  [2.35668859]
curr_Stock_Price:  100.72562257460339
curr_Factors:  [100.72562257]
mat_Sqrt:  [[0.15]]
grads:  [0.08581557]
Stock Position:  0.08581556696890853
Bond Position:  [-6.28713782]


portfolio before change:  [2.38743999]
curr_Stock_Price:  101.08854457657687
curr_Factors:  [101.08854458]
mat_Sqrt:  [[0.15]]
grads:  [-0.00238532]
Stock Position:  -0.002385319579308552
Bond Position:  [2.62856848]


portfolio before change:  [2.3902472]
curr_Stock_Price:  99.98055141265026
curr_Factors:  [99.98055141]
mat_Sqrt:  [[0.15]]
grads:  [0.01968844]
Stock Position:  0.01968844126539755
Bond Position:  [0.42178599]


portfolio before change:  [2.39298258]
curr_Stock_Price:  100.11814576088358
curr_Factors:  [100.11814576]
mat_Sqrt:  [[0.15]]
grads:  [-0.16059474]
Stock Position:  -0.16059473643991692
Bond Position:  [18.47142981]


portfolio before change:  [2.51297146]
curr_Stock_Price:  99.37818139360623
curr_Factors:  [99.37818139]
mat_Sqrt:  [[0.15]]
grads:  [-0.02688841]
Stock Position:  -0.02688841205260918
Bond Position:  [5.18509295]


portfolio before change:  [2.48742353]
curr_Stock_Price:  100.34038064136377
curr_Factors:  [100.34038064]
mat_Sqrt:  [[0.15]]
grads:  [0.05159084]
Stock Position:  0.05159084110520559
Bond Position:  [-2.6892211]


portfolio before change:  [2.47974872]
curr_Stock_Price:  100.19487552650524
curr_Factors:  [100.19487553]
mat_Sqrt:  [[0.15]]
grads:  [0.08958122]
Stock Position:  0.08958122216290372
Bond Position:  [-6.49583068]


portfolio before change:  [2.54960584]
curr_Stock_Price:  100.97922655805577
curr_Factors:  [100.97922656]
mat_Sqrt:  [[0.15]]
grads:  [0.07449845]
Stock Position:  0.07449845034915147
Bond Position:  [-4.97319005]


portfolio before change:  [2.57793775]
curr_Stock_Price:  101.36370093691032
curr_Factors:  [101.36370094]
mat_Sqrt:  [[0.15]]
grads:  [0.0031271]
Stock Position:  0.0031270967593854254
Bond Position:  [2.26096365]


portfolio before change:  [2.58006474]
curr_Stock_Price:  101.99868956650673
curr_Factors:  [101.99868957]
mat_Sqrt:  [[0.15]]
grads:  [-0.02954586]
Stock Position:  -0.029545862324197703
Bond Position:  [5.59370398]


portfolio before change:  [2.57786401]
curr_Stock_Price:  102.08500791183955
curr_Factors:  [102.08500791]
mat_Sqrt:  [[0.15]]
grads:  [-0.04624701]
Stock Position:  -0.04624701187720307
Bond Position:  [7.29899058]


portfolio before change:  [2.59356848]
curr_Stock_Price:  101.75529417577101
curr_Factors:  [101.75529418]
mat_Sqrt:  [[0.15]]
grads:  [0.04765135]
Stock Position:  0.04765134721945833
Bond Position:  [-2.25520837]


portfolio before change:  [2.61383978]
curr_Stock_Price:  102.18366102856844
curr_Factors:  [102.18366103]
mat_Sqrt:  [[0.15]]
grads:  [0.00935835]
Stock Position:  0.009358345499069862
Bond Position:  [1.65756978]


portfolio before change:  [2.61420773]
curr_Stock_Price:  102.2119079736261
curr_Factors:  [102.21190797]
mat_Sqrt:  [[0.15]]
grads:  [-0.05801685]
Stock Position:  -0.058016845632842505
Bond Position:  [8.54422022]


portfolio before change:  [2.63945738]
curr_Stock_Price:  101.7859003726392
curr_Factors:  [101.78590037]
mat_Sqrt:  [[0.15]]
grads:  [-0.14653709]
Stock Position:  -0.14653708578855934
Bond Position:  [17.55486659]


portfolio before change:  [2.7363222]
curr_Stock_Price:  101.13236199546445
curr_Factors:  [101.132362]
mat_Sqrt:  [[0.15]]
grads:  [-0.01809983]
Stock Position:  -0.018099828915288028
Bond Position:  [4.56680065]


portfolio before change:  [2.73875155]
curr_Stock_Price:  101.01391272750485
curr_Factors:  [101.01391273]
mat_Sqrt:  [[0.15]]
grads:  [0.05871629]
Stock Position:  0.05871629406625711
Bond Position:  [-3.19241106]


portfolio before change:  [2.71083352]
curr_Stock_Price:  100.54183780923519
curr_Factors:  [100.54183781]
mat_Sqrt:  [[0.15]]
grads:  [-0.09140097]
Stock Position:  -0.09140096976523344
Bond Position:  [11.900455]


portfolio before change:  [2.66160868]
curr_Stock_Price:  101.08853491677196
curr_Factors:  [101.08853492]
mat_Sqrt:  [[0.15]]
grads:  [0.01021356]
Stock Position:  0.010213564056092486
Bond Position:  [1.62913445]


portfolio before change:  [2.66124889]
curr_Stock_Price:  101.04333902567868
curr_Factors:  [101.04333903]
mat_Sqrt:  [[0.15]]
grads:  [0.00871895]
Stock Position:  0.008718946817141993
Bond Position:  [1.78025739]


portfolio before change:  [2.65773647]
curr_Stock_Price:  100.62772760538138
curr_Factors:  [100.62772761]
mat_Sqrt:  [[0.15]]
grads:  [-0.09138352]
Stock Position:  -0.09138352112887435
Bond Position:  [11.85345254]


portfolio before change:  [2.60532664]
curr_Stock_Price:  101.20934994647845
curr_Factors:  [101.20934995]
mat_Sqrt:  [[0.15]]
grads:  [-0.03199216]
Stock Position:  -0.03199215728328092
Bond Position:  [5.84323208]


portfolio before change:  [2.58786751]
curr_Stock_Price:  101.76649694313531
curr_Factors:  [101.76649694]
mat_Sqrt:  [[0.15]]
grads:  [-0.0037923]
Stock Position:  -0.003792301311205436
Bond Position:  [2.97379673]


portfolio before change:  [2.5887047]
curr_Stock_Price:  101.59475093385451
curr_Factors:  [101.59475093]
mat_Sqrt:  [[0.15]]
grads:  [-0.00157617]
Stock Position:  -0.0015761694247856672
Bond Position:  [2.74883524]


portfolio before change:  [2.58904607]
curr_Stock_Price:  101.48717017122058
curr_Factors:  [101.48717017]
mat_Sqrt:  [[0.15]]
grads:  [-0.0203038]
Stock Position:  -0.020303795583597337
Bond Position:  [4.64962083]


portfolio before change:  [2.58353647]
curr_Stock_Price:  101.7728414235414
curr_Factors:  [101.77284142]
mat_Sqrt:  [[0.15]]
grads:  [0.02476578]
Stock Position:  0.02476578085609069
Bond Position:  [0.06305258]


portfolio before change:  [2.57312469]
curr_Stock_Price:  101.35227232127917
curr_Factors:  [101.35227232]
mat_Sqrt:  [[0.15]]
grads:  [0.00021578]
Stock Position:  0.00021577827127892274
Bond Position:  [2.55125507]


portfolio before change:  [2.57349961]
curr_Stock_Price:  102.35082409324282
curr_Factors:  [102.35082409]
mat_Sqrt:  [[0.15]]
grads:  [0.02090284]
Stock Position:  0.020902838433956048
Bond Position:  [0.43407687]


portfolio before change:  [2.56317061]
curr_Stock_Price:  101.85538282665745
curr_Factors:  [101.85538283]
mat_Sqrt:  [[0.15]]
grads:  [0.00561631]
Stock Position:  0.005616306388154935
Bond Position:  [1.99111958]


portfolio before change:  [2.56504028]
curr_Stock_Price:  102.1661236393129
curr_Factors:  [102.16612364]
mat_Sqrt:  [[0.15]]
grads:  [0.05726705]
Stock Position:  0.05726705346315519
Bond Position:  [-3.28571259]


portfolio before change:  [2.50492146]
curr_Stock_Price:  101.11991202109375
curr_Factors:  [101.11991202]
mat_Sqrt:  [[0.15]]
grads:  [-0.02781311]
Stock Position:  -0.027813105492266486
Bond Position:  [5.31738024]


portfolio before change:  [2.49398283]
curr_Stock_Price:  101.52515171445309
curr_Factors:  [101.52515171]
mat_Sqrt:  [[0.15]]
grads:  [-0.11223291]
Stock Position:  -0.11223290808236924
Bond Position:  [13.88844585]


portfolio before change:  [2.48304475]
curr_Stock_Price:  101.63034488977151
curr_Factors:  [101.63034489]
mat_Sqrt:  [[0.15]]
grads:  [0.08927867]
Stock Position:  0.08927866995914686
Bond Position:  [-6.59037727]


portfolio before change:  [2.42329405]
curr_Stock_Price:  100.96569801468274
curr_Factors:  [100.96569801]
mat_Sqrt:  [[0.15]]
grads:  [0.04714635]
Stock Position:  0.04714634731147289
Bond Position:  [-2.33686982]


portfolio before change:  [2.43007833]
curr_Stock_Price:  101.11269441696668
curr_Factors:  [101.11269442]
mat_Sqrt:  [[0.15]]
grads:  [0.06484464]
Stock Position:  0.06484463827406693
Bond Position:  [-4.12653776]


portfolio before change:  [2.44028987]
curr_Stock_Price:  101.27414890489267
curr_Factors:  [101.2741489]
mat_Sqrt:  [[0.15]]
grads:  [-0.08848691]
Stock Position:  -0.08848690667108002
Bond Position:  [11.40172604]


portfolio before change:  [2.47019104]
curr_Stock_Price:  100.94428612043058
curr_Factors:  [100.94428612]
mat_Sqrt:  [[0.15]]
grads:  [-0.08369693]
Stock Position:  -0.0836969308467608
Bond Position:  [10.91891798]


portfolio before change:  [2.54077782]
curr_Stock_Price:  100.10907837854839
curr_Factors:  [100.10907838]
mat_Sqrt:  [[0.15]]
grads:  [-0.01471346]
Stock Position:  -0.014713457727449078
Bond Position:  [4.01372851]


portfolio before change:  [2.54033687]
curr_Stock_Price:  100.1560975796295
curr_Factors:  [100.15609758]
mat_Sqrt:  [[0.15]]
grads:  [-0.1140808]
Stock Position:  -0.11408079923784431
Bond Position:  [13.96622453]


portfolio before change:  [2.6136326]
curr_Stock_Price:  99.52125970427484
curr_Factors:  [99.5212597]
mat_Sqrt:  [[0.15]]
grads:  [0.18160986]
Stock Position:  0.18160985809412394
Bond Position:  [-15.46040925]


portfolio before change:  [2.5139142]
curr_Stock_Price:  98.97750017816213
curr_Factors:  [98.97750018]
mat_Sqrt:  [[0.15]]
grads:  [0.08411153]
Stock Position:  0.08411152630465804
Bond Position:  [-5.81123441]


portfolio before change:  [2.53583832]
curr_Stock_Price:  99.24247372867315
curr_Factors:  [99.24247373]
mat_Sqrt:  [[0.15]]
grads:  [0.01333875]
Stock Position:  0.013338745794114612
Bond Position:  [1.21206819]


portfolio before change:  [2.52924842]
curr_Stock_Price:  98.74275209653733
curr_Factors:  [98.7427521]
mat_Sqrt:  [[0.15]]
grads:  [0.05447475]
Stock Position:  0.05447474826862615
Bond Position:  [-2.84973815]


portfolio before change:  [2.49240751]
curr_Stock_Price:  98.06972841844512
curr_Factors:  [98.06972842]
mat_Sqrt:  [[0.15]]
grads:  [-0.11456618]
Stock Position:  -0.1145661804844844
Bond Position:  [13.72788171]


portfolio before change:  [2.589165]
curr_Stock_Price:  97.23266223593771
curr_Factors:  [97.23266224]
mat_Sqrt:  [[0.15]]
grads:  [0.03709757]
Stock Position:  0.03709757490658117
Bond Position:  [-1.01793097]


portfolio before change:  [2.5778841]
curr_Stock_Price:  96.93028990681164
curr_Factors:  [96.93028991]
mat_Sqrt:  [[0.15]]
grads:  [0.01033088]
Stock Position:  0.010330881865952796
Bond Position:  [1.57650872]


portfolio before change:  [2.58078658]
curr_Stock_Price:  97.20170437983975
curr_Factors:  [97.20170438]
mat_Sqrt:  [[0.15]]
grads:  [-0.00463046]
Stock Position:  -0.004630463838997092
Bond Position:  [3.03087556]


portfolio before change:  [2.58463086]
curr_Stock_Price:  96.41240186864492
curr_Factors:  [96.41240187]
mat_Sqrt:  [[0.15]]
grads:  [0.05146128]
Stock Position:  0.05146128418452014
Bond Position:  [-2.37687515]


portfolio before change:  [2.58571377]
curr_Stock_Price:  96.4363318684855
curr_Factors:  [96.43633187]
mat_Sqrt:  [[0.15]]
grads:  [-0.01539483]
Stock Position:  -0.015394825274601388
Bond Position:  [4.07033424]


portfolio before change:  [2.57950756]
curr_Stock_Price:  96.85599302613282
curr_Factors:  [96.85599303]
mat_Sqrt:  [[0.15]]
grads:  [0.01786703]
Stock Position:  0.017867032430504488
Bond Position:  [0.84897839]


portfolio before change:  [2.58248452]
curr_Stock_Price:  97.01964086060914
curr_Factors:  [97.01964086]
mat_Sqrt:  [[0.15]]
grads:  [0.02506425]
Stock Position:  0.025064253628339028
Bond Position:  [0.15075964]


portfolio before change:  [2.56803639]
curr_Stock_Price:  96.44282101115382
curr_Factors:  [96.44282101]
mat_Sqrt:  [[0.15]]
grads:  [-0.07759936]
Stock Position:  -0.07759935929591955
Bond Position:  [10.05193751]


portfolio before change:  [2.49220744]
curr_Stock_Price:  97.42810247464506
curr_Factors:  [97.42810247]
mat_Sqrt:  [[0.15]]
grads:  [-0.14677565]
Stock Position:  -0.14677564548033067
Bond Position:  [16.79228007]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.49220744]
Stock Price:  96.40104345681519
PL:  [2.49220744]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-2.94810272e-02]
 [ 1.99965084e-03]
 [-7.76714467e-04]
 [-1.43555415e-03]
 [-1.73656401e-02]
 [ 6.53628505e-03]
 [ 4.40796188e-04]
 [ 1.48937242e-02]
 [ 1.46243214e-02]
 [-1.79580699e-02]
 [ 5.74157514e-03]
 [-6.38562965e-03]
 [-8.72028399e-03]
 [ 4.27566552e-03]
 [-9.63506940e-04]
 [ 1.11541999e-02]
 [-2.08839453e-03]
 [ 3.65950853e-03]
 [ 1.78546928e-02]
 [ 1.19614321e-02]
 [ 4.05038234e-02]
 [-1.60273572e-02]
 [-1.75482394e-03]
 [ 1.39065170e-02]
 [ 9.70374460e-03]
 [ 4.83402654e-03]
 [ 1.22400149e-02]
 [-1.49749111e-02]
 [ 1.74778429e-03]
 [-3.98567603e-03]
 [-3.41691648e-03]
 [-2.45269199e-02]
 [ 2.06502659e-02]
 [ 1.05121101e-02]
 [-2.60773976e-02]
 [ 7.97117778e-03]
 [-2.43843690e-03]
 [-5.52110534e-03]
 [ 7.33636955e-03]
 [-1.99172115e-02]
 [ 5.56085481e-02]
 [ 2.13844346e-03]
 [ 8.73645746e-03]
 [-9.35628269e-03]
 [-1.42177913e-03]
 [-1.49734583e-02]
 [-1.30741449e-02]
 [ 1.12533962e-03]
 [-2.66230200e-03]
 [-1.49864417e-03]
 [-3.86308727e-03]
 [ 2.92415340e-03]
 [ 3.63298787e-03]
 [-1.11011558e-03]
 [ 1.19783744e-02]
 [ 8.92728164e-03]
 [ 4.46260671e-03]
 [ 1.03617364e-02]
 [ 1.32046344e-02]
 [-3.34853346e-03]
 [-3.42688982e-03]
 [-2.30312244e-02]
 [-1.28026740e-02]
 [-1.67327884e-03]
 [-7.94022897e-03]
 [ 1.05507693e-02]
 [ 8.90674922e-03]
 [ 1.76997089e-03]
 [ 1.33350679e-02]
 [-1.86121477e-02]
 [ 1.61805202e-02]
 [-8.31599258e-03]
 [-2.62655855e-03]
 [ 7.68836528e-03]
 [-4.49509541e-03]
 [ 3.38842134e-03]
 [ 1.39047373e-02]
 [-1.44101635e-02]
 [-5.41089457e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.80741566]
curr_Stock_Price:  99.10831766792239
curr_Factors:  [99.10831767]
mat_Sqrt:  [[0.15]]
grads:  [-0.19654018]
Stock Position:  -0.19654018157168293
Bond Position:  [7.67135109]


portfolio before change:  [-11.87879109]
curr_Stock_Price:  99.4739167341787
curr_Factors:  [99.47391673]
mat_Sqrt:  [[0.15]]
grads:  [0.01333101]
Stock Position:  0.013331005579986777
Bond Position:  [-13.20487843]


portfolio before change:  [-11.88468304]
curr_Stock_Price:  99.09385396510979
curr_Factors:  [99.09385397]
mat_Sqrt:  [[0.15]]
grads:  [-0.0051781]
Stock Position:  -0.005178096447669261
Bond Position:  [-11.37156551]


portfolio before change:  [-11.88264817]
curr_Stock_Price:  98.56361692200713
curr_Factors:  [98.56361692]
mat_Sqrt:  [[0.15]]
grads:  [-0.00957036]
Stock Position:  -0.009570361013687011
Bond Position:  [-10.93935877]


portfolio before change:  [-11.88321897]
curr_Stock_Price:  98.55181688753581
curr_Factors:  [98.55181689]
mat_Sqrt:  [[0.15]]
grads:  [-0.11577093]
Stock Position:  -0.11577093419207383
Bond Position:  [-0.47378306]


portfolio before change:  [-11.90207676]
curr_Stock_Price:  98.7144499236491
curr_Factors:  [98.71444992]
mat_Sqrt:  [[0.15]]
grads:  [0.04357523]
Stock Position:  0.04357523367759011
Bond Position:  [-16.20358198]


portfolio before change:  [-11.89530048]
curr_Stock_Price:  98.89319908103894
curr_Factors:  [98.89319908]
mat_Sqrt:  [[0.15]]
grads:  [0.00293864]
Stock Position:  0.0029386412525228183
Bond Position:  [-12.18591211]


portfolio before change:  [-11.89598194]
curr_Stock_Price:  98.92048452814527
curr_Factors:  [98.92048453]
mat_Sqrt:  [[0.15]]
grads:  [0.09929149]
Stock Position:  0.09929149455645804
Bond Position:  [-21.71794469]


portfolio before change:  [-11.91117548]
curr_Stock_Price:  98.78113591448822
curr_Factors:  [98.78113591]
mat_Sqrt:  [[0.15]]
grads:  [0.09749548]
Stock Position:  0.09749547624795536
Bond Position:  [-21.54188937]


portfolio before change:  [-11.88983235]
curr_Stock_Price:  99.01386002028242
curr_Factors:  [99.01386002]
mat_Sqrt:  [[0.15]]
grads:  [-0.11972047]
Stock Position:  -0.11972046587148814
Bond Position:  [-0.0358469]


portfolio before change:  [-11.89094097]
curr_Stock_Price:  99.02310138513026
curr_Factors:  [99.02310139]
mat_Sqrt:  [[0.15]]
grads:  [0.03827717]
Stock Position:  0.03827716757186218
Bond Position:  [-15.68126481]


portfolio before change:  [-11.89593816]
curr_Stock_Price:  98.9181542693415
curr_Factors:  [98.91815427]
mat_Sqrt:  [[0.15]]
grads:  [-0.04257086]
Stock Position:  -0.0425708643507352
Bond Position:  [-7.68490683]


portfolio before change:  [-11.92333227]
curr_Stock_Price:  99.55036578599884
curr_Factors:  [99.55036579]
mat_Sqrt:  [[0.15]]
grads:  [-0.05813523]
Stock Position:  -0.05813522657008983
Bond Position:  [-6.1359492]


portfolio before change:  [-11.92580374]
curr_Stock_Price:  99.58628133368941
curr_Factors:  [99.58628133]
mat_Sqrt:  [[0.15]]
grads:  [0.02850444]
Stock Position:  0.02850443683290278
Bond Position:  [-14.7644546]


portfolio before change:  [-11.94329706]
curr_Stock_Price:  99.00495015124325
curr_Factors:  [99.00495015]
mat_Sqrt:  [[0.15]]
grads:  [-0.00642338]
Stock Position:  -0.00642337959926616
Bond Position:  [-11.30735068]


portfolio before change:  [-11.94555105]
curr_Stock_Price:  99.24582964134476
curr_Factors:  [99.24582964]
mat_Sqrt:  [[0.15]]
grads:  [0.07436133]
Stock Position:  0.07436133252157597
Bond Position:  [-19.32560319]


portfolio before change:  [-11.99490085]
curr_Stock_Price:  98.59842445472358
curr_Factors:  [98.59842445]
mat_Sqrt:  [[0.15]]
grads:  [-0.01392263]
Stock Position:  -0.013922630200817182
Bond Position:  [-10.62215145]


portfolio before change:  [-11.99250078]
curr_Stock_Price:  98.37835278229466
curr_Factors:  [98.37835278]
mat_Sqrt:  [[0.15]]
grads:  [0.02439672]
Stock Position:  0.024396723562979113
Bond Position:  [-14.39261026]


portfolio before change:  [-11.9819861]
curr_Stock_Price:  98.84621285907045
curr_Factors:  [98.84621286]
mat_Sqrt:  [[0.15]]
grads:  [0.11903129]
Stock Position:  0.11903128504082774
Bond Position:  [-23.74777783]


portfolio before change:  [-11.97590326]
curr_Stock_Price:  98.90978537475799
curr_Factors:  [98.90978537]
mat_Sqrt:  [[0.15]]
grads:  [0.07974288]
Stock Position:  0.07974288070373331
Bond Position:  [-19.86325447]


portfolio before change:  [-11.9876744]
curr_Stock_Price:  98.77774041677215
curr_Factors:  [98.77774042]
mat_Sqrt:  [[0.15]]
grads:  [0.27002549]
Stock Position:  0.2700254894587709
Bond Position:  [-38.6601821]


portfolio before change:  [-11.80869642]
curr_Stock_Price:  99.44950780498654
curr_Factors:  [99.4495078]
mat_Sqrt:  [[0.15]]
grads:  [-0.10684905]
Stock Position:  -0.10684904811340805
Bond Position:  [-1.18261117]


portfolio before change:  [-11.80224889]
curr_Stock_Price:  99.38847366585141
curr_Factors:  [99.38847367]
mat_Sqrt:  [[0.15]]
grads:  [-0.01169883]
Stock Position:  -0.011698826267175541
Bond Position:  [-10.63952041]


portfolio before change:  [-11.80236631]
curr_Stock_Price:  99.34166807721499
curr_Factors:  [99.34166808]
mat_Sqrt:  [[0.15]]
grads:  [0.09271011]
Stock Position:  0.0927101134655528
Bond Position:  [-21.01234363]


portfolio before change:  [-11.7957288]
curr_Stock_Price:  99.4274281045966
curr_Factors:  [99.4274281]
mat_Sqrt:  [[0.15]]
grads:  [0.06469163]
Stock Position:  0.0646916306834264
Bond Position:  [-18.22785126]


portfolio before change:  [-11.83737519]
curr_Stock_Price:  98.80127114921656
curr_Factors:  [98.80127115]
mat_Sqrt:  [[0.15]]
grads:  [0.03222684]
Stock Position:  0.03222684357463999
Bond Position:  [-15.0214283]


portfolio before change:  [-11.8267586]
curr_Stock_Price:  99.15983737153078
curr_Factors:  [99.15983737]
mat_Sqrt:  [[0.15]]
grads:  [0.0816001]
Stock Position:  0.08160009922527586
Bond Position:  [-19.91821117]


portfolio before change:  [-11.88110811]
curr_Stock_Price:  98.50904675791269
curr_Factors:  [98.50904676]
mat_Sqrt:  [[0.15]]
grads:  [-0.09983274]
Stock Position:  -0.09983274052041541
Bond Position:  [-2.04668001]


portfolio before change:  [-11.8637122]
curr_Stock_Price:  98.33351486098769
curr_Factors:  [98.33351486]
mat_Sqrt:  [[0.15]]
grads:  [0.0116519]
Stock Position:  0.011651895237716812
Bond Position:  [-13.00948402]


portfolio before change:  [-11.87177831]
curr_Stock_Price:  97.71104153448981
curr_Factors:  [97.71104153]
mat_Sqrt:  [[0.15]]
grads:  [-0.02657117]
Stock Position:  -0.02657117355740033
Bond Position:  [-9.27548127]


portfolio before change:  [-11.85436958]
curr_Stock_Price:  97.03404950610985
curr_Factors:  [97.03404951]
mat_Sqrt:  [[0.15]]
grads:  [-0.02277944]
Stock Position:  -0.02277944317690099
Bond Position:  [-9.64398796]


portfolio before change:  [-11.85026035]
curr_Stock_Price:  96.82719655275733
curr_Factors:  [96.82719655]
mat_Sqrt:  [[0.15]]
grads:  [-0.1635128]
Stock Position:  -0.1635127993826481
Bond Position:  [3.98222562]


portfolio before change:  [-11.83324707]
curr_Stock_Price:  96.72467014048311
curr_Factors:  [96.72467014]
mat_Sqrt:  [[0.15]]
grads:  [0.13766844]
Stock Position:  0.13766843947264584
Bond Position:  [-25.14918147]


portfolio before change:  [-11.83927321]
curr_Stock_Price:  96.69231514399942
curr_Factors:  [96.69231514]
mat_Sqrt:  [[0.15]]
grads:  [0.07008073]
Stock Position:  0.0700807338253766
Bond Position:  [-18.61554161]


portfolio before change:  [-11.8293703]
curr_Stock_Price:  96.85022464178711
curr_Factors:  [96.85022464]
mat_Sqrt:  [[0.15]]
grads:  [-0.17384932]
Stock Position:  -0.17384931709476267
Bond Position:  [5.00797511]


portfolio before change:  [-11.84536475]
curr_Stock_Price:  96.94402687929271
curr_Factors:  [96.94402688]
mat_Sqrt:  [[0.15]]
grads:  [0.05314119]
Stock Position:  0.053141185193249
Bond Position:  [-16.99708523]


portfolio before change:  [-11.85045212]
curr_Stock_Price:  96.86828483684019
curr_Factors:  [96.86828484]
mat_Sqrt:  [[0.15]]
grads:  [-0.01625625]
Stock Position:  -0.016256245979770153
Bond Position:  [-10.27573745]


portfolio before change:  [-11.83931457]
curr_Stock_Price:  96.14365223204616
curr_Factors:  [96.14365223]
mat_Sqrt:  [[0.15]]
grads:  [-0.03680737]
Stock Position:  -0.036807368955438596
Bond Position:  [-8.30051969]


portfolio before change:  [-11.83059637]
curr_Stock_Price:  95.89269724694658
curr_Factors:  [95.89269725]
mat_Sqrt:  [[0.15]]
grads:  [0.04890913]
Stock Position:  0.048909130328974426
Bond Position:  [-16.5206248]


portfolio before change:  [-11.86735737]
curr_Stock_Price:  95.1621910382724
curr_Factors:  [95.16219104]
mat_Sqrt:  [[0.15]]
grads:  [-0.13278141]
Stock Position:  -0.1327814096945131
Bond Position:  [0.76841251]


portfolio before change:  [-11.80288701]
curr_Stock_Price:  94.67701518832578
curr_Factors:  [94.67701519]
mat_Sqrt:  [[0.15]]
grads:  [0.37072365]
Stock Position:  0.37072365389599443
Bond Position:  [-46.90189602]


portfolio before change:  [-11.47065375]
curr_Stock_Price:  95.58109755193527
curr_Factors:  [95.58109755]
mat_Sqrt:  [[0.15]]
grads:  [0.01425629]
Stock Position:  0.014256289706718595
Bond Position:  [-12.83328557]


portfolio before change:  [-11.47058427]
curr_Stock_Price:  95.64223451657662
curr_Factors:  [95.64223452]
mat_Sqrt:  [[0.15]]
grads:  [0.05824305]
Stock Position:  0.058243049734558176
Bond Position:  [-17.04107969]


portfolio before change:  [-11.47383038]
curr_Stock_Price:  95.60478783935721
curr_Factors:  [95.60478784]
mat_Sqrt:  [[0.15]]
grads:  [-0.06237522]
Stock Position:  -0.06237521791511356
Bond Position:  [-5.5104609]


portfolio before change:  [-11.5056018]
curr_Stock_Price:  96.10862585429857
curr_Factors:  [96.10862585]
mat_Sqrt:  [[0.15]]
grads:  [-0.00947853]
Stock Position:  -0.009478527512157522
Bond Position:  [-10.59463355]


portfolio before change:  [-11.49823301]
curr_Stock_Price:  95.26134528126698
curr_Factors:  [95.26134528]
mat_Sqrt:  [[0.15]]
grads:  [-0.09982306]
Stock Position:  -0.09982305535284593
Bond Position:  [-1.98895447]


portfolio before change:  [-11.43162909]
curr_Stock_Price:  94.59288008781787
curr_Factors:  [94.59288009]
mat_Sqrt:  [[0.15]]
grads:  [-0.08716097]
Stock Position:  -0.08716096569928049
Bond Position:  [-3.18682231]


portfolio before change:  [-11.50076663]
curr_Stock_Price:  95.38381166540192
curr_Factors:  [95.38381167]
mat_Sqrt:  [[0.15]]
grads:  [0.00750226]
Stock Position:  0.0075022641175353025
Bond Position:  [-12.21636118]


portfolio before change:  [-11.49970421]
curr_Stock_Price:  95.62720007615758
curr_Factors:  [95.62720008]
mat_Sqrt:  [[0.15]]
grads:  [-0.01774868]
Stock Position:  -0.017748680020551848
Bond Position:  [-9.80244764]


portfolio before change:  [-11.51786949]
curr_Stock_Price:  96.61615265311211
curr_Factors:  [96.61615265]
mat_Sqrt:  [[0.15]]
grads:  [-0.00999096]
Stock Position:  -0.00999096112420369
Bond Position:  [-10.55258126]


portfolio before change:  [-11.51628512]
curr_Stock_Price:  96.39155705477224
curr_Factors:  [96.39155705]
mat_Sqrt:  [[0.15]]
grads:  [-0.02575392]
Stock Position:  -0.025753915159237924
Bond Position:  [-9.03382514]


portfolio before change:  [-11.51983242]
curr_Stock_Price:  96.50737138278635
curr_Factors:  [96.50737138]
mat_Sqrt:  [[0.15]]
grads:  [0.01949436]
Stock Position:  0.019494356018527302
Bond Position:  [-13.40118148]


portfolio before change:  [-11.53045161]
curr_Stock_Price:  96.00560648541929
curr_Factors:  [96.00560649]
mat_Sqrt:  [[0.15]]
grads:  [0.02421992]
Stock Position:  0.024219919102067607
Bond Position:  [-13.85569963]


portfolio before change:  [-11.54408454]
curr_Stock_Price:  95.4784813276781
curr_Factors:  [95.47848133]
mat_Sqrt:  [[0.15]]
grads:  [-0.00740077]
Stock Position:  -0.007400770558125553
Bond Position:  [-10.83747021]


portfolio before change:  [-11.54386186]
curr_Stock_Price:  95.35686596764697
curr_Factors:  [95.35686597]
mat_Sqrt:  [[0.15]]
grads:  [0.07985583]
Stock Position:  0.07985582946026047
Bond Position:  [-19.15866349]


portfolio before change:  [-11.5744359]
curr_Stock_Price:  94.98899565275806
curr_Factors:  [94.98899565]
mat_Sqrt:  [[0.15]]
grads:  [0.05951521]
Stock Position:  0.05951521095309667
Bond Position:  [-17.22772602]


portfolio before change:  [-11.55008301]
curr_Stock_Price:  95.41627561884098
curr_Factors:  [95.41627562]
mat_Sqrt:  [[0.15]]
grads:  [0.02975071]
Stock Position:  0.029750711431310892
Bond Position:  [-14.38878509]


portfolio before change:  [-11.55164529]
curr_Stock_Price:  95.39399203821247
curr_Factors:  [95.39399204]
mat_Sqrt:  [[0.15]]
grads:  [0.06907824]
Stock Position:  0.06907824276181201
Bond Position:  [-18.14129463]


portfolio before change:  [-11.56188505]
curr_Stock_Price:  95.2621720319987
curr_Factors:  [95.26217203]
mat_Sqrt:  [[0.15]]
grads:  [0.0880309]
Stock Position:  0.08803089585811551
Bond Position:  [-19.9478994]


portfolio before change:  [-11.50521973]
curr_Stock_Price:  95.92003316871212
curr_Factors:  [95.92003317]
mat_Sqrt:  [[0.15]]
grads:  [-0.02232356]
Stock Position:  -0.022323556413635835
Bond Position:  [-9.36394346]


portfolio before change:  [-11.50014716]
curr_Stock_Price:  95.66658647052026
curr_Factors:  [95.66658647]
mat_Sqrt:  [[0.15]]
grads:  [-0.02284593]
Stock Position:  -0.022845932121375746
Bond Position:  [-9.31455482]


portfolio before change:  [-11.50529625]
curr_Stock_Price:  95.86648676055219
curr_Factors:  [95.86648676]
mat_Sqrt:  [[0.15]]
grads:  [-0.1535415]
Stock Position:  -0.15354149615641666
Bond Position:  [3.21418756]


portfolio before change:  [-11.55119361]
curr_Stock_Price:  96.16671995966689
curr_Factors:  [96.16671996]
mat_Sqrt:  [[0.15]]
grads:  [-0.08535116]
Stock Position:  -0.08535116007652895
Bond Position:  [-3.3432525]


portfolio before change:  [-11.59541229]
curr_Stock_Price:  96.68235109105945
curr_Factors:  [96.68235109]
mat_Sqrt:  [[0.15]]
grads:  [-0.01115519]
Stock Position:  -0.01115519229409372
Bond Position:  [-10.51690207]


portfolio before change:  [-11.58691616]
curr_Stock_Price:  95.86179604743027
curr_Factors:  [95.86179605]
mat_Sqrt:  [[0.15]]
grads:  [-0.05293486]
Stock Position:  -0.052934859816611744
Bond Position:  [-6.51248543]


portfolio before change:  [-11.5775001]
curr_Stock_Price:  95.67622626473187
curr_Factors:  [95.67622626]
mat_Sqrt:  [[0.15]]
grads:  [0.07033846]
Stock Position:  0.07033846229974657
Bond Position:  [-18.30721873]


portfolio before change:  [-11.5507829]
curr_Stock_Price:  96.07233149574773
curr_Factors:  [96.0723315]
mat_Sqrt:  [[0.15]]
grads:  [0.05937833]
Stock Position:  0.05937832813524711
Bond Position:  [-17.25539733]


portfolio before change:  [-11.56288094]
curr_Stock_Price:  95.88674957531049
curr_Factors:  [95.88674958]
mat_Sqrt:  [[0.15]]
grads:  [0.01179981]
Stock Position:  0.011799805947749663
Bond Position:  [-12.69432598]


portfolio before change:  [-11.55908853]
curr_Stock_Price:  96.27538563625355
curr_Factors:  [96.27538564]
mat_Sqrt:  [[0.15]]
grads:  [0.08890045]
Stock Position:  0.08890045299316567
Bond Position:  [-20.11801393]


portfolio before change:  [-11.56683119]
curr_Stock_Price:  96.20243612008893
curr_Factors:  [96.20243612]
mat_Sqrt:  [[0.15]]
grads:  [-0.12408098]
Stock Position:  -0.12408098493550893
Bond Position:  [0.37006184]


portfolio before change:  [-11.46124124]
curr_Stock_Price:  95.35164646743748
curr_Factors:  [95.35164647]
mat_Sqrt:  [[0.15]]
grads:  [0.10787013]
Stock Position:  0.10787013463417315
Bond Position:  [-21.74683619]


portfolio before change:  [-11.45746614]
curr_Stock_Price:  95.39924375748379
curr_Factors:  [95.39924376]
mat_Sqrt:  [[0.15]]
grads:  [-0.05543995]
Stock Position:  -0.05543995051549701
Bond Position:  [-6.16853678]


portfolio before change:  [-11.48875569]
curr_Stock_Price:  95.95667581971216
curr_Factors:  [95.95667582]
mat_Sqrt:  [[0.15]]
grads:  [-0.01751039]
Stock Position:  -0.01751039034804544
Bond Position:  [-9.80851684]


portfolio before change:  [-11.48398686]
curr_Stock_Price:  95.64932214520339
curr_Factors:  [95.64932215]
mat_Sqrt:  [[0.15]]
grads:  [0.05125577]
Stock Position:  0.051255768511092516
Bond Position:  [-16.38656637]


portfolio before change:  [-11.48638621]
curr_Stock_Price:  95.62249274269791
curr_Factors:  [95.62249274]
mat_Sqrt:  [[0.15]]
grads:  [-0.0299673]
Stock Position:  -0.029967302728422397
Bond Position:  [-8.62083802]


portfolio before change:  [-11.4624878]
curr_Stock_Price:  94.80702971705266
curr_Factors:  [94.80702972]
mat_Sqrt:  [[0.15]]
grads:  [0.02258948]
Stock Position:  0.022589475577351272
Bond Position:  [-13.60412889]


portfolio before change:  [-11.46283468]
curr_Stock_Price:  94.82931476414497
curr_Factors:  [94.82931476]
mat_Sqrt:  [[0.15]]
grads:  [0.09269825]
Stock Position:  0.09269824855321479
Bond Position:  [-20.25334607]


portfolio before change:  [-11.49720907]
curr_Stock_Price:  94.47215032673739
curr_Factors:  [94.47215033]
mat_Sqrt:  [[0.15]]
grads:  [-0.09606776]
Stock Position:  -0.09606775649451824
Bond Position:  [-2.42148154]


portfolio before change:  [-11.40480547]
curr_Stock_Price:  93.50871628499249
curr_Factors:  [93.50871628]
mat_Sqrt:  [[0.15]]
grads:  [-0.3607263]
Stock Position:  -0.3607263048567438
Bond Position:  [22.32624822]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.40480547]
Stock Price:  94.12835954250558
PL:  [-11.40480547]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.65204334e-02]
 [ 2.81119349e-04]
 [ 2.75977215e-04]
 [ 5.54923577e-04]
 [-3.84830265e-04]
 [ 6.01383080e-03]
 [ 4.72697333e-04]
 [ 3.69670820e-03]
 [ 9.78060972e-03]
 [-1.41329193e-02]
 [ 8.02513783e-03]
 [-9.03667922e-03]
 [ 8.74356907e-03]
 [ 7.06418591e-03]
 [-2.15523652e-02]
 [ 1.78766833e-02]
 [-4.18684733e-03]
 [-1.08776039e-03]
 [ 1.15403030e-02]
 [ 1.35941080e-02]
 [ 9.76407188e-03]
 [-2.39442535e-02]
 [ 2.30742305e-05]
 [ 5.75525128e-03]
 [ 3.47140587e-04]
 [ 1.60419956e-02]
 [ 1.64342676e-02]
 [-6.46427764e-03]
 [ 1.08950712e-03]
 [-2.51053688e-03]
 [-3.66205203e-03]
 [-1.62090337e-02]
 [ 1.72196536e-02]
 [ 1.70675903e-02]
 [-1.93866889e-02]
 [ 7.32714463e-03]
 [-2.76745861e-03]
 [ 1.83348989e-03]
 [ 5.80317433e-03]
 [-1.65183479e-02]
 [ 2.96348144e-02]
 [-9.82947157e-04]
 [ 3.68422679e-03]
 [-7.91372869e-03]
 [ 1.81381862e-03]
 [-4.37445755e-03]
 [-1.36542589e-02]
 [-8.73536062e-04]
 [-5.05437007e-03]
 [ 4.71334480e-03]
 [-3.35916764e-03]
 [ 3.01852781e-03]
 [ 3.29185147e-03]
 [ 2.51192336e-03]
 [ 3.66826244e-03]
 [ 8.97236612e-03]
 [ 1.34877362e-02]
 [-7.62115002e-03]
 [ 1.36809743e-02]
 [ 8.01162046e-04]
 [ 2.03137784e-03]
 [-1.61307837e-02]
 [-1.27142836e-02]
 [-1.33148425e-03]
 [-9.72864257e-03]
 [ 6.16554111e-03]
 [ 8.66204518e-03]
 [ 1.73661526e-03]
 [ 1.42712055e-02]
 [-1.95218782e-02]
 [ 1.92921083e-02]
 [-4.80775445e-03]
 [-3.39857298e-03]
 [ 7.68618818e-03]
 [-3.30612988e-03]
 [ 3.05979222e-03]
 [ 8.17881048e-03]
 [-1.18669579e-02]
 [-3.59722480e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.30684852]
curr_Stock_Price:  99.26903076723167
curr_Factors:  [99.26903077]
mat_Sqrt:  [[0.15]]
grads:  [-0.24346956]
Stock Position:  -0.2434695558498685
Bond Position:  [14.86213831]


portfolio before change:  [-9.40461532]
curr_Stock_Price:  99.67440264374612
curr_Factors:  [99.67440264]
mat_Sqrt:  [[0.15]]
grads:  [0.00187413]
Stock Position:  0.001874128994925562
Bond Position:  [-9.59141801]


portfolio before change:  [-9.40510217]
curr_Stock_Price:  99.7345026510139
curr_Factors:  [99.73450265]
mat_Sqrt:  [[0.15]]
grads:  [0.00183985]
Stock Position:  0.00183984810153413
Bond Position:  [-9.5885985]


portfolio before change:  [-9.40651158]
curr_Stock_Price:  99.29419030011543
curr_Factors:  [99.2941903]
mat_Sqrt:  [[0.15]]
grads:  [0.00369949]
Stock Position:  0.003699490515073611
Bond Position:  [-9.77384949]


portfolio before change:  [-9.406703]
curr_Stock_Price:  99.40757361898044
curr_Factors:  [99.40757362]
mat_Sqrt:  [[0.15]]
grads:  [-0.00256554]
Stock Position:  -0.0025655351020635714
Bond Position:  [-9.15166938]


portfolio before change:  [-9.40526037]
curr_Stock_Price:  98.62230647958347
curr_Factors:  [98.62230648]
mat_Sqrt:  [[0.15]]
grads:  [0.04009221]
Stock Position:  0.04009220530895897
Bond Position:  [-13.35924613]


portfolio before change:  [-9.38671386]
curr_Stock_Price:  99.10572933105432
curr_Factors:  [99.10572933]
mat_Sqrt:  [[0.15]]
grads:  [0.00315132]
Stock Position:  0.00315131555651485
Bond Position:  [-9.69902729]


portfolio before change:  [-9.39011676]
curr_Stock_Price:  98.21826160984781
curr_Factors:  [98.21826161]
mat_Sqrt:  [[0.15]]
grads:  [0.02464472]
Stock Position:  0.024644721339296592
Bond Position:  [-11.81067845]


portfolio before change:  [-9.38912697]
curr_Stock_Price:  98.28837745690106
curr_Factors:  [98.28837746]
mat_Sqrt:  [[0.15]]
grads:  [0.06520406]
Stock Position:  0.06520406478027374
Bond Position:  [-15.7979287]


portfolio before change:  [-9.35432719]
curr_Stock_Price:  98.83722635465388
curr_Factors:  [98.83722635]
mat_Sqrt:  [[0.15]]
grads:  [-0.09421946]
Stock Position:  -0.09421946203428615
Bond Position:  [-0.04193689]


portfolio before change:  [-9.27827449]
curr_Stock_Price:  98.03001186703807
curr_Factors:  [98.03001187]
mat_Sqrt:  [[0.15]]
grads:  [0.05350092]
Stock Position:  0.053500918854401454
Bond Position:  [-14.5229702]


portfolio before change:  [-9.28142767]
curr_Stock_Price:  97.98804127786609
curr_Factors:  [97.98804128]
mat_Sqrt:  [[0.15]]
grads:  [-0.06024453]
Stock Position:  -0.06024452815868313
Bond Position:  [-3.37818436]


portfolio before change:  [-9.24624048]
curr_Stock_Price:  97.4004636514671
curr_Factors:  [97.40046365]
mat_Sqrt:  [[0.15]]
grads:  [0.05829046]
Stock Position:  0.058290460472696884
Bond Position:  [-14.92375836]


portfolio before change:  [-9.26011249]
curr_Stock_Price:  97.17848481973974
curr_Factors:  [97.17848482]
mat_Sqrt:  [[0.15]]
grads:  [0.04709457]
Stock Position:  0.047094572711231956
Bond Position:  [-13.83669171]


portfolio before change:  [-9.23736348]
curr_Stock_Price:  97.67989784359904
curr_Factors:  [97.67989784]
mat_Sqrt:  [[0.15]]
grads:  [-0.14368243]
Stock Position:  -0.1436824347674617
Bond Position:  [4.79752207]


portfolio before change:  [-9.17170608]
curr_Stock_Price:  97.22502289220884
curr_Factors:  [97.22502289]
mat_Sqrt:  [[0.15]]
grads:  [0.11917789]
Stock Position:  0.11917788887722137
Bond Position:  [-20.75877906]


portfolio before change:  [-9.18760746]
curr_Stock_Price:  97.10248416868443
curr_Factors:  [97.10248417]
mat_Sqrt:  [[0.15]]
grads:  [-0.02791232]
Stock Position:  -0.0279123155117996
Bond Position:  [-6.47725228]


portfolio before change:  [-9.20683875]
curr_Stock_Price:  97.77696963769617
curr_Factors:  [97.77696964]
mat_Sqrt:  [[0.15]]
grads:  [-0.00725174]
Stock Position:  -0.007251735933358865
Bond Position:  [-8.49778598]


portfolio before change:  [-9.21202313]
curr_Stock_Price:  98.41864376289001
curr_Factors:  [98.41864376]
mat_Sqrt:  [[0.15]]
grads:  [0.07693535]
Stock Position:  0.07693535346244532
Bond Position:  [-16.78389627]


portfolio before change:  [-9.20306777]
curr_Stock_Price:  98.54867996122086
curr_Factors:  [98.54867996]
mat_Sqrt:  [[0.15]]
grads:  [0.09062739]
Stock Position:  0.09062738657236546
Bond Position:  [-18.13427709]


portfolio before change:  [-9.24216306]
curr_Stock_Price:  98.129801461643
curr_Factors:  [98.12980146]
mat_Sqrt:  [[0.15]]
grads:  [0.06509381]
Stock Position:  0.06509381256380731
Bond Position:  [-15.62980597]


portfolio before change:  [-9.27788102]
curr_Stock_Price:  97.59609388904957
curr_Factors:  [97.59609389]
mat_Sqrt:  [[0.15]]
grads:  [-0.15962836]
Stock Position:  -0.1596283569739029
Bond Position:  [6.3012231]


portfolio before change:  [-9.25922264]
curr_Stock_Price:  97.481674777952
curr_Factors:  [97.48167478]
mat_Sqrt:  [[0.15]]
grads:  [0.00015383]
Stock Position:  0.00015382820306889672
Bond Position:  [-9.27421808]


portfolio before change:  [-9.25980625]
curr_Stock_Price:  97.45597212445966
curr_Factors:  [97.45597212]
mat_Sqrt:  [[0.15]]
grads:  [0.03836834]
Stock Position:  0.03836834188337217
Bond Position:  [-12.99903031]


portfolio before change:  [-9.24723068]
curr_Stock_Price:  97.80490657705349
curr_Factors:  [97.80490658]
mat_Sqrt:  [[0.15]]
grads:  [0.00231427]
Stock Position:  0.002314270582952395
Bond Position:  [-9.4735777]


portfolio before change:  [-9.24890577]
curr_Stock_Price:  97.33695443272188
curr_Factors:  [97.33695443]
mat_Sqrt:  [[0.15]]
grads:  [0.10694664]
Stock Position:  0.10694663721346148
Bond Position:  [-19.65876572]


portfolio before change:  [-9.2912619]
curr_Stock_Price:  96.9523942320282
curr_Factors:  [96.95239423]
mat_Sqrt:  [[0.15]]
grads:  [0.10956178]
Stock Position:  0.10956178380725516
Bond Position:  [-19.91353916]


portfolio before change:  [-9.24923701]
curr_Stock_Price:  97.3473268542804
curr_Factors:  [97.34732685]
mat_Sqrt:  [[0.15]]
grads:  [-0.04309518]
Stock Position:  -0.04309518424711498
Bond Position:  [-5.05403603]


portfolio before change:  [-9.25989515]
curr_Stock_Price:  97.5873130325952
curr_Factors:  [97.58731303]
mat_Sqrt:  [[0.15]]
grads:  [0.00726338]
Stock Position:  0.007263380778839804
Bond Position:  [-9.96870896]


portfolio before change:  [-9.26114881]
curr_Stock_Price:  97.50049420898766
curr_Factors:  [97.50049421]
mat_Sqrt:  [[0.15]]
grads:  [-0.01673691]
Stock Position:  -0.01673691254823641
Bond Position:  [-7.62929156]


portfolio before change:  [-9.27560014]
curr_Stock_Price:  98.33544443397174
curr_Factors:  [98.33544443]
mat_Sqrt:  [[0.15]]
grads:  [-0.02441368]
Stock Position:  -0.024413680186221712
Bond Position:  [-6.87487005]


portfolio before change:  [-9.2735823]
curr_Stock_Price:  98.23519166308704
curr_Factors:  [98.23519166]
mat_Sqrt:  [[0.15]]
grads:  [-0.10806022]
Stock Position:  -0.10806022493403988
Bond Position:  [1.34173461]


portfolio before change:  [-9.26147122]
curr_Stock_Price:  98.12389060373084
curr_Factors:  [98.1238906]
mat_Sqrt:  [[0.15]]
grads:  [0.11479769]
Stock Position:  0.11479769076867324
Bond Position:  [-20.52586727]


portfolio before change:  [-9.23104749]
curr_Stock_Price:  98.40008640713972
curr_Factors:  [98.40008641]
mat_Sqrt:  [[0.15]]
grads:  [0.11378394]
Stock Position:  0.1137839355006864
Bond Position:  [-20.42739657]


portfolio before change:  [-9.29402059]
curr_Stock_Price:  97.85786266204799
curr_Factors:  [97.85786266]
mat_Sqrt:  [[0.15]]
grads:  [-0.12924459]
Stock Position:  -0.12924459283317094
Bond Position:  [3.35357903]


portfolio before change:  [-9.30063226]
curr_Stock_Price:  97.91064070822735
curr_Factors:  [97.91064071]
mat_Sqrt:  [[0.15]]
grads:  [0.04884763]
Stock Position:  0.04884763084368109
Bond Position:  [-14.08333509]


portfolio before change:  [-9.32221883]
curr_Stock_Price:  97.48674439245107
curr_Factors:  [97.48674439]
mat_Sqrt:  [[0.15]]
grads:  [-0.01844972]
Stock Position:  -0.018449724062374082
Bond Position:  [-7.52361529]


portfolio before change:  [-9.3196094]
curr_Stock_Price:  97.31982234146287
curr_Factors:  [97.31982234]
mat_Sqrt:  [[0.15]]
grads:  [0.01222327]
Stock Position:  0.012223265966522767
Bond Position:  [-10.50917548]


portfolio before change:  [-9.32690131]
curr_Stock_Price:  96.77699976916688
curr_Factors:  [96.77699977]
mat_Sqrt:  [[0.15]]
grads:  [0.03868783]
Stock Position:  0.0386878288481301
Bond Position:  [-13.07099332]


portfolio before change:  [-9.3221161]
curr_Stock_Price:  96.92180445095273
curr_Factors:  [96.92180445]
mat_Sqrt:  [[0.15]]
grads:  [-0.11012232]
Stock Position:  -0.11012231953106906
Bond Position:  [1.35113782]


portfolio before change:  [-9.43279578]
curr_Stock_Price:  97.9276326341805
curr_Factors:  [97.92763263]
mat_Sqrt:  [[0.15]]
grads:  [0.19756543]
Stock Position:  0.1975654291242835
Bond Position:  [-28.77991054]


portfolio before change:  [-9.43520546]
curr_Stock_Price:  97.9245405840797
curr_Factors:  [97.92454058]
mat_Sqrt:  [[0.15]]
grads:  [-0.00655298]
Stock Position:  -0.00655298104628511
Bond Position:  [-8.7935078]


portfolio before change:  [-9.43854383]
curr_Stock_Price:  98.35011069975977
curr_Factors:  [98.3501107]
mat_Sqrt:  [[0.15]]
grads:  [0.02456151]
Stock Position:  0.02456151190375257
Bond Position:  [-11.85417124]


portfolio before change:  [-9.43694279]
curr_Stock_Price:  98.4454607411788
curr_Factors:  [98.44546074]
mat_Sqrt:  [[0.15]]
grads:  [-0.05275819]
Stock Position:  -0.0527581912553505
Bond Position:  [-4.24313835]


portfolio before change:  [-9.42371309]
curr_Stock_Price:  98.18967289746536
curr_Factors:  [98.1896729]
mat_Sqrt:  [[0.15]]
grads:  [0.01209212]
Stock Position:  0.01209212410940644
Bond Position:  [-10.61103481]


portfolio before change:  [-9.42593552]
curr_Stock_Price:  98.06072804437976
curr_Factors:  [98.06072804]
mat_Sqrt:  [[0.15]]
grads:  [-0.02916305]
Stock Position:  -0.029163050301087273
Bond Position:  [-6.56618558]


portfolio before change:  [-9.42673251]
curr_Stock_Price:  98.07398426456146
curr_Factors:  [98.07398426]
mat_Sqrt:  [[0.15]]
grads:  [-0.09102839]
Stock Position:  -0.09102839296789104
Bond Position:  [-0.49921533]


portfolio before change:  [-9.40011955]
curr_Stock_Price:  97.78128252213946
curr_Factors:  [97.78128252]
mat_Sqrt:  [[0.15]]
grads:  [-0.00582357]
Stock Position:  -0.005823573746125503
Bond Position:  [-8.83068304]


portfolio before change:  [-9.40027151]
curr_Stock_Price:  97.71260155375772
curr_Factors:  [97.71260155]
mat_Sqrt:  [[0.15]]
grads:  [-0.0336958]
Stock Position:  -0.033695800475234294
Bond Position:  [-6.10776719]


portfolio before change:  [-9.39917899]
curr_Stock_Price:  97.66884927095911
curr_Factors:  [97.66884927]
mat_Sqrt:  [[0.15]]
grads:  [0.0314223]
Stock Position:  0.0314222986858759
Bond Position:  [-12.46815875]


portfolio before change:  [-9.3972566]
curr_Stock_Price:  97.75482875208685
curr_Factors:  [97.75482875]
mat_Sqrt:  [[0.15]]
grads:  [-0.02239445]
Stock Position:  -0.022394450959504545
Bond Position:  [-7.20809088]


portfolio before change:  [-9.39270165]
curr_Stock_Price:  97.53131492403718
curr_Factors:  [97.53131492]
mat_Sqrt:  [[0.15]]
grads:  [0.02012352]
Stock Position:  0.020123518734024765
Bond Position:  [-11.3553749]


portfolio before change:  [-9.39379608]
curr_Stock_Price:  97.51219809111386
curr_Factors:  [97.51219809]
mat_Sqrt:  [[0.15]]
grads:  [0.02194568]
Stock Position:  0.021945676468235732
Bond Position:  [-11.53376724]


portfolio before change:  [-9.3860278]
curr_Stock_Price:  97.89902473429343
curr_Factors:  [97.89902473]
mat_Sqrt:  [[0.15]]
grads:  [0.01674616]
Stock Position:  0.01674615571747105
Bond Position:  [-11.02546011]


portfolio before change:  [-9.39274143]
curr_Stock_Price:  97.53926895900175
curr_Factors:  [97.53926896]
mat_Sqrt:  [[0.15]]
grads:  [0.02445508]
Stock Position:  0.02445508291613955
Bond Position:  [-11.77807234]


portfolio before change:  [-9.38192736]
curr_Stock_Price:  98.01157286130272
curr_Factors:  [98.01157286]
mat_Sqrt:  [[0.15]]
grads:  [0.05981577]
Stock Position:  0.059815774109965074
Bond Position:  [-15.24456546]


portfolio before change:  [-9.38891917]
curr_Stock_Price:  97.91061292183848
curr_Factors:  [97.91061292]
mat_Sqrt:  [[0.15]]
grads:  [0.08991824]
Stock Position:  0.0899182415021861
Bond Position:  [-18.19286931]


portfolio before change:  [-9.38587764]
curr_Stock_Price:  97.95708426498605
curr_Factors:  [97.95708426]
mat_Sqrt:  [[0.15]]
grads:  [-0.05080767]
Stock Position:  -0.050807666824753545
Bond Position:  [-4.40890674]


portfolio before change:  [-9.37155708]
curr_Stock_Price:  97.66980239427507
curr_Factors:  [97.66980239]
mat_Sqrt:  [[0.15]]
grads:  [0.0912065]
Stock Position:  0.09120649524138945
Bond Position:  [-18.27967745]


portfolio before change:  [-9.36083852]
curr_Stock_Price:  97.79984876874592
curr_Factors:  [97.79984877]
mat_Sqrt:  [[0.15]]
grads:  [0.00534108]
Stock Position:  0.005341080305666012
Bond Position:  [-9.88319537]


portfolio before change:  [-9.36401649]
curr_Stock_Price:  97.32049825364408
curr_Factors:  [97.32049825]
mat_Sqrt:  [[0.15]]
grads:  [0.01354252]
Stock Position:  0.013542518936860612
Bond Position:  [-10.68198118]


portfolio before change:  [-9.36070298]
curr_Stock_Price:  97.61447259428725
curr_Factors:  [97.61447259]
mat_Sqrt:  [[0.15]]
grads:  [-0.10753856]
Stock Position:  -0.1075385576704299
Bond Position:  [1.13661661]


portfolio before change:  [-9.3256967]
curr_Stock_Price:  97.28961008897295
curr_Factors:  [97.28961009]
mat_Sqrt:  [[0.15]]
grads:  [-0.08476189]
Stock Position:  -0.08476189067393439
Bond Position:  [-1.0792454]


portfolio before change:  [-9.31156352]
curr_Stock_Price:  97.12207450639274
curr_Factors:  [97.12207451]
mat_Sqrt:  [[0.15]]
grads:  [-0.00887656]
Stock Position:  -0.008876561683861682
Bond Position:  [-8.44945343]


portfolio before change:  [-9.31272997]
curr_Stock_Price:  97.19398777221487
curr_Factors:  [97.19398777]
mat_Sqrt:  [[0.15]]
grads:  [-0.06485762]
Stock Position:  -0.06485761712203875
Bond Position:  [-3.00895952]


portfolio before change:  [-9.22977356]
curr_Stock_Price:  95.91203391544853
curr_Factors:  [95.91203392]
mat_Sqrt:  [[0.15]]
grads:  [0.04110361]
Stock Position:  0.04110360736935153
Bond Position:  [-13.17210415]


portfolio before change:  [-9.23316367]
curr_Stock_Price:  95.8495861369352
curr_Factors:  [95.84958614]
mat_Sqrt:  [[0.15]]
grads:  [0.05774697]
Stock Position:  0.05774696787992696
Bond Position:  [-14.76818664]


portfolio before change:  [-9.29079398]
curr_Stock_Price:  94.86759056220443
curr_Factors:  [94.86759056]
mat_Sqrt:  [[0.15]]
grads:  [0.01157744]
Stock Position:  0.01157743508818889
Bond Position:  [-10.38911735]


portfolio before change:  [-9.28703369]
curr_Stock_Price:  95.24847220907225
curr_Factors:  [95.24847221]
mat_Sqrt:  [[0.15]]
grads:  [0.09514137]
Stock Position:  0.09514136983256125
Bond Position:  [-18.34910381]


portfolio before change:  [-9.31377582]
curr_Stock_Price:  94.97944854286429
curr_Factors:  [94.97944854]
mat_Sqrt:  [[0.15]]
grads:  [-0.13014585]
Stock Position:  -0.1301458547562311
Bond Position:  [3.04740569]


portfolio before change:  [-9.28455972]
curr_Stock_Price:  94.75642466273814
curr_Factors:  [94.75642466]
mat_Sqrt:  [[0.15]]
grads:  [0.12861406]
Stock Position:  0.12861405512131455
Bond Position:  [-21.47156774]


portfolio before change:  [-9.13882188]
curr_Stock_Price:  95.89999996636688
curr_Factors:  [95.89999997]
mat_Sqrt:  [[0.15]]
grads:  [-0.0320517]
Stock Position:  -0.0320516963130149
Bond Position:  [-6.0650642]


portfolio before change:  [-9.125386]
curr_Stock_Price:  95.46897875736016
curr_Factors:  [95.46897876]
mat_Sqrt:  [[0.15]]
grads:  [-0.02265715]
Stock Position:  -0.022657153211944794
Bond Position:  [-6.96233072]


portfolio before change:  [-9.13031063]
curr_Stock_Price:  95.66712688623113
curr_Factors:  [95.66712689]
mat_Sqrt:  [[0.15]]
grads:  [0.05124125]
Stock Position:  0.05124125456211445
Bond Position:  [-14.03241423]


portfolio before change:  [-9.111107]
curr_Stock_Price:  96.05901192519511
curr_Factors:  [96.05901193]
mat_Sqrt:  [[0.15]]
grads:  [-0.02204087]
Stock Position:  -0.02204086586282834
Bond Position:  [-6.9938832]


portfolio before change:  [-9.10490065]
curr_Stock_Price:  95.75759560152933
curr_Factors:  [95.7575956]
mat_Sqrt:  [[0.15]]
grads:  [0.02039861]
Stock Position:  0.02039861480064526
Bond Position:  [-11.05822296]


portfolio before change:  [-9.09931014]
curr_Stock_Price:  96.06554189242279
curr_Factors:  [96.06554189]
mat_Sqrt:  [[0.15]]
grads:  [0.0545254]
Stock Position:  0.054525403215295476
Bond Position:  [-14.33732254]


portfolio before change:  [-9.09093598]
curr_Stock_Price:  96.23555928630371
curr_Factors:  [96.23555929]
mat_Sqrt:  [[0.15]]
grads:  [-0.07911305]
Stock Position:  -0.07911305287479356
Bond Position:  [-1.47744709]


portfolio before change:  [-9.10334632]
curr_Stock_Price:  96.39126042156427
curr_Factors:  [96.39126042]
mat_Sqrt:  [[0.15]]
grads:  [-0.23981499]
Stock Position:  -0.23981498658746941
Bond Position:  [14.01272251]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.10334632]
Stock Price:  96.3244583239516
PL:  [-9.10334632]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.61052616e-02]
 [-1.69630536e-03]
 [-4.27813014e-04]
 [-8.03221066e-04]
 [-1.18194778e-02]
 [ 9.72591841e-03]
 [ 8.59093655e-04]
 [ 1.50449991e-02]
 [ 1.50494497e-02]
 [-9.26664939e-03]
 [ 7.01207490e-03]
 [-7.87592204e-03]
 [ 5.51242040e-03]
 [ 5.31763196e-03]
 [-1.34300002e-02]
 [ 1.48363834e-02]
 [-3.71699415e-03]
 [-3.12331653e-03]
 [-7.72704035e-03]
 [ 1.44297749e-02]
 [-5.09934291e-02]
 [-2.87882394e-02]
 [ 1.41289585e-03]
 [-8.38787247e-04]
 [-6.42061770e-03]
 [ 1.70166590e-02]
 [ 1.79628360e-02]
 [ 5.48150076e-02]
 [-3.70125417e-04]
 [ 1.17161695e-02]
 [-3.45511542e-03]
 [-5.04649206e-02]
 [ 2.45553490e-02]
 [ 1.11873211e-02]
 [-4.26183215e-02]
 [ 8.99226803e-03]
 [ 2.86120479e-03]
 [-1.94491251e-02]
 [ 1.29875732e-02]
 [-2.43420509e-02]
 [ 6.56475618e-02]
 [ 5.21056127e-03]
 [ 1.45022409e-02]
 [-1.09926664e-02]
 [-5.35606181e-03]
 [-1.84854114e-02]
 [-1.30360580e-02]
 [ 2.42638216e-03]
 [-3.01999469e-03]
 [-1.87881287e-02]
 [-4.59328433e-03]
 [ 2.80488976e-03]
 [ 4.07611272e-03]
 [-1.67974145e-03]
 [ 1.83798113e-02]
 [ 8.92194517e-03]
 [ 2.54226557e-03]
 [ 1.35533617e-02]
 [ 1.30442850e-02]
 [-7.88464799e-03]
 [-9.45115344e-03]
 [-3.08649828e-02]
 [-1.29343010e-02]
 [-3.85891470e-03]
 [-5.77914749e-03]
 [ 2.18473650e-02]
 [ 8.34782805e-03]
 [ 1.73198492e-03]
 [ 1.48808972e-02]
 [-1.96207208e-02]
 [ 2.00343079e-02]
 [-6.77512492e-03]
 [-3.32160293e-03]
 [ 7.80035195e-03]
 [-9.51952160e-03]
 [ 3.63270242e-03]
 [ 1.94304841e-02]
 [-1.58363486e-02]
 [-5.60116203e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.45432758]
curr_Stock_Price:  99.2595521905504
curr_Factors:  [99.25955219]
mat_Sqrt:  [[0.15]]
grads:  [-0.24070174]
Stock Position:  -0.24070174367642408
Bond Position:  [14.43761971]


portfolio before change:  [-9.61091981]
curr_Stock_Price:  99.91386655805313
curr_Factors:  [99.91386656]
mat_Sqrt:  [[0.15]]
grads:  [-0.0113087]
Stock Position:  -0.011308702376768199
Bond Position:  [-8.48102363]


portfolio before change:  [-9.60502845]
curr_Stock_Price:  99.34603473682365
curr_Factors:  [99.34603474]
mat_Sqrt:  [[0.15]]
grads:  [-0.00285209]
Stock Position:  -0.0028520867605309292
Bond Position:  [-9.32168494]


portfolio before change:  [-9.60409143]
curr_Stock_Price:  98.81321440296186
curr_Factors:  [98.8132144]
mat_Sqrt:  [[0.15]]
grads:  [-0.00535481]
Stock Position:  -0.005354807108708546
Bond Position:  [-9.07496572]


portfolio before change:  [-9.60541057]
curr_Stock_Price:  98.95363720303337
curr_Factors:  [98.9536372]
mat_Sqrt:  [[0.15]]
grads:  [-0.07879652]
Stock Position:  -0.07879651884320124
Bond Position:  [-1.80820843]


portfolio before change:  [-9.63100301]
curr_Stock_Price:  99.2769944909126
curr_Factors:  [99.27699449]
mat_Sqrt:  [[0.15]]
grads:  [0.06483946]
Stock Position:  0.06483945606765382
Bond Position:  [-16.06806933]


portfolio before change:  [-9.61155179]
curr_Stock_Price:  99.5924737518241
curr_Factors:  [99.59247375]
mat_Sqrt:  [[0.15]]
grads:  [0.00572729]
Stock Position:  0.005727291036201008
Bond Position:  [-10.18194688]


portfolio before change:  [-9.61387034]
curr_Stock_Price:  99.29876480099027
curr_Factors:  [99.2987648]
mat_Sqrt:  [[0.15]]
grads:  [0.10029999]
Stock Position:  0.1002999941157842
Bond Position:  [-19.57353587]


portfolio before change:  [-9.66267403]
curr_Stock_Price:  98.82438488877854
curr_Factors:  [98.82438489]
mat_Sqrt:  [[0.15]]
grads:  [0.10032966]
Stock Position:  0.10032966489121539
Bond Position:  [-19.57769145]


portfolio before change:  [-9.68228845]
curr_Stock_Price:  98.6410814355473
curr_Factors:  [98.64108144]
mat_Sqrt:  [[0.15]]
grads:  [-0.06177766]
Stock Position:  -0.06177766261254642
Bond Position:  [-3.588473]


portfolio before change:  [-9.66793167]
curr_Stock_Price:  98.40505658311557
curr_Factors:  [98.40505658]
mat_Sqrt:  [[0.15]]
grads:  [0.04674717]
Stock Position:  0.04674716601871298
Bond Position:  [-14.26808919]


portfolio before change:  [-9.67210337]
curr_Stock_Price:  98.33489366536706
curr_Factors:  [98.33489367]
mat_Sqrt:  [[0.15]]
grads:  [-0.05250615]
Stock Position:  -0.05250614696072499
Bond Position:  [-4.50891699]


portfolio before change:  [-9.64005391]
curr_Stock_Price:  97.71913183884784
curr_Factors:  [97.71913184]
mat_Sqrt:  [[0.15]]
grads:  [0.03674947]
Stock Position:  0.03674946930041708
Bond Position:  [-13.23118014]


portfolio before change:  [-9.63699352]
curr_Stock_Price:  97.82491183064084
curr_Factors:  [97.82491183]
mat_Sqrt:  [[0.15]]
grads:  [0.03545088]
Stock Position:  0.03545087972349553
Bond Position:  [-13.1049727]


portfolio before change:  [-9.6235957]
curr_Stock_Price:  98.22594297492269
curr_Factors:  [98.22594297]
mat_Sqrt:  [[0.15]]
grads:  [-0.08953333]
Stock Position:  -0.08953333434827852
Bond Position:  [-0.82909951]


portfolio before change:  [-9.6270453]
curr_Stock_Price:  98.26389286020805
curr_Factors:  [98.26389286]
mat_Sqrt:  [[0.15]]
grads:  [0.09890922]
Stock Position:  0.09890922243484811
Bond Position:  [-19.34625054]


portfolio before change:  [-9.71534562]
curr_Stock_Price:  97.38337695345572
curr_Factors:  [97.38337695]
mat_Sqrt:  [[0.15]]
grads:  [-0.02477996]
Stock Position:  -0.024779961006857386
Bond Position:  [-7.30218934]


portfolio before change:  [-9.71917768]
curr_Stock_Price:  97.51960198095448
curr_Factors:  [97.51960198]
mat_Sqrt:  [[0.15]]
grads:  [-0.02082211]
Stock Position:  -0.020822110188051652
Bond Position:  [-7.68861378]


portfolio before change:  [-9.71634351]
curr_Stock_Price:  97.36040988390477
curr_Factors:  [97.36040988]
mat_Sqrt:  [[0.15]]
grads:  [-0.0515136]
Stock Position:  -0.05151360232136297
Bond Position:  [-4.70095808]


portfolio before change:  [-9.72008144]
curr_Stock_Price:  97.42726817781487
curr_Factors:  [97.42726818]
mat_Sqrt:  [[0.15]]
grads:  [0.0961985]
Stock Position:  0.096198499126904
Bond Position:  [-19.09243842]


portfolio before change:  [-9.79071958]
curr_Stock_Price:  96.70537722997909
curr_Factors:  [96.70537723]
mat_Sqrt:  [[0.15]]
grads:  [-0.33995619]
Stock Position:  -0.3399561937564901
Bond Position:  [23.08487237]


portfolio before change:  [-9.76854146]
curr_Stock_Price:  96.64438328003924
curr_Factors:  [96.64438328]
mat_Sqrt:  [[0.15]]
grads:  [-0.1919216]
Stock Position:  -0.1919215961363413
Bond Position:  [8.77960283]


portfolio before change:  [-9.68383866]
curr_Stock_Price:  96.20590179757681
curr_Factors:  [96.2059018]
mat_Sqrt:  [[0.15]]
grads:  [0.00941931]
Stock Position:  0.009419305696273228
Bond Position:  [-10.59003145]


portfolio before change:  [-9.6837653]
curr_Stock_Price:  96.28395998716822
curr_Factors:  [96.28395999]
mat_Sqrt:  [[0.15]]
grads:  [-0.00559191]
Stock Position:  -0.005591914979431789
Bond Position:  [-9.14535358]


portfolio before change:  [-9.68404025]
curr_Stock_Price:  96.23090937178156
curr_Factors:  [96.23090937]
mat_Sqrt:  [[0.15]]
grads:  [-0.04280412]
Stock Position:  -0.04280411797894691
Bond Position:  [-5.56496105]


portfolio before change:  [-9.68644629]
curr_Stock_Price:  96.27899407164826
curr_Factors:  [96.27899407]
mat_Sqrt:  [[0.15]]
grads:  [0.11344439]
Stock Position:  0.11344439314336661
Bond Position:  [-20.60875835]


portfolio before change:  [-9.68715359]
curr_Stock_Price:  96.28411367438976
curr_Factors:  [96.28411367]
mat_Sqrt:  [[0.15]]
grads:  [0.11975224]
Stock Position:  0.1197522400573708
Bond Position:  [-21.21739188]


portfolio before change:  [-9.76457582]
curr_Stock_Price:  95.64866747711268
curr_Factors:  [95.64866748]
mat_Sqrt:  [[0.15]]
grads:  [0.36543338]
Stock Position:  0.36543338368738937
Bond Position:  [-44.71779202]


portfolio before change:  [-9.8602473]
curr_Stock_Price:  95.39451300740042
curr_Factors:  [95.39451301]
mat_Sqrt:  [[0.15]]
grads:  [-0.0024675]
Stock Position:  -0.002467502782296562
Bond Position:  [-9.62486107]


portfolio before change:  [-9.86093425]
curr_Stock_Price:  95.42911506028564
curr_Factors:  [95.42911506]
mat_Sqrt:  [[0.15]]
grads:  [0.0781078]
Stock Position:  0.07810779681687834
Bond Position:  [-17.31469218]


portfolio before change:  [-9.86937533]
curr_Stock_Price:  95.33490075114301
curr_Factors:  [95.33490075]
mat_Sqrt:  [[0.15]]
grads:  [-0.0230341]
Stock Position:  -0.023034102768460806
Bond Position:  [-7.67342143]


portfolio before change:  [-9.8661431]
curr_Stock_Price:  95.1737555722692
curr_Factors:  [95.17375557]
mat_Sqrt:  [[0.15]]
grads:  [-0.3364328]
Stock Position:  -0.33643280430667916
Bond Position:  [22.15343039]


portfolio before change:  [-9.75295851]
curr_Stock_Price:  94.84144566052329
curr_Factors:  [94.84144566]
mat_Sqrt:  [[0.15]]
grads:  [0.16370233]
Stock Position:  0.16370232667484813
Bond Position:  [-25.27872383]


portfolio before change:  [-9.75677901]
curr_Stock_Price:  94.82775903046155
curr_Factors:  [94.82775903]
mat_Sqrt:  [[0.15]]
grads:  [0.07458214]
Stock Position:  0.07458214090492063
Bond Position:  [-16.8292363]


portfolio before change:  [-9.81242227]
curr_Stock_Price:  94.09579566428523
curr_Factors:  [94.09579566]
mat_Sqrt:  [[0.15]]
grads:  [-0.28412214]
Stock Position:  -0.2841221434530969
Bond Position:  [16.92227689]


portfolio before change:  [-9.7054035]
curr_Stock_Price:  93.72285361969793
curr_Factors:  [93.72285362]
mat_Sqrt:  [[0.15]]
grads:  [0.05994845]
Stock Position:  0.059948453507014665
Bond Position:  [-15.32394363]


portfolio before change:  [-9.70860919]
curr_Stock_Price:  93.68535610946145
curr_Factors:  [93.68535611]
mat_Sqrt:  [[0.15]]
grads:  [0.0190747]
Stock Position:  0.019074698580539586
Bond Position:  [-11.49562912]


portfolio before change:  [-9.7043363]
curr_Stock_Price:  93.94703234877103
curr_Factors:  [93.94703235]
mat_Sqrt:  [[0.15]]
grads:  [-0.12966083]
Stock Position:  -0.12966083407969853
Bond Position:  [2.47691428]


portfolio before change:  [-9.58134614]
curr_Stock_Price:  92.99967343011174
curr_Factors:  [92.99967343]
mat_Sqrt:  [[0.15]]
grads:  [0.08658382]
Stock Position:  0.08658382163923152
Bond Position:  [-17.63361327]


portfolio before change:  [-9.58438095]
curr_Stock_Price:  92.97735198741772
curr_Factors:  [92.97735199]
mat_Sqrt:  [[0.15]]
grads:  [-0.16228034]
Stock Position:  -0.16228033914869402
Bond Position:  [5.50401527]


portfolio before change:  [-9.61309158]
curr_Stock_Price:  93.15639180903253
curr_Factors:  [93.15639181]
mat_Sqrt:  [[0.15]]
grads:  [0.43765041]
Stock Position:  0.4376504119468829
Bond Position:  [-50.38302483]


portfolio before change:  [-9.60432912]
curr_Stock_Price:  93.18360873126093
curr_Factors:  [93.18360873]
mat_Sqrt:  [[0.15]]
grads:  [0.03473708]
Stock Position:  0.03473707511658142
Bond Position:  [-12.84125513]


portfolio before change:  [-9.61919959]
curr_Stock_Price:  92.77862737780491
curr_Factors:  [92.77862738]
mat_Sqrt:  [[0.15]]
grads:  [0.09668161]
Stock Position:  0.09668160607604255
Bond Position:  [-18.58918629]


portfolio before change:  [-9.61503655]
curr_Stock_Price:  92.83370408072628
curr_Factors:  [92.83370408]
mat_Sqrt:  [[0.15]]
grads:  [-0.07328444]
Stock Position:  -0.0732844427670832
Bond Position:  [-2.81177027]


portfolio before change:  [-9.68318881]
curr_Stock_Price:  93.76127499851431
curr_Factors:  [93.761275]
mat_Sqrt:  [[0.15]]
grads:  [-0.03570708]
Stock Position:  -0.03570707876067424
Bond Position:  [-6.33524757]


portfolio before change:  [-9.70708225]
curr_Stock_Price:  94.41933722022894
curr_Factors:  [94.41933722]
mat_Sqrt:  [[0.15]]
grads:  [-0.12323608]
Stock Position:  -0.12323607616220311
Bond Position:  [1.92878638]


portfolio before change:  [-9.69601909]
curr_Stock_Price:  94.3305433439183
curr_Factors:  [94.33054334]
mat_Sqrt:  [[0.15]]
grads:  [-0.08690705]
Stock Position:  -0.08690705358762466
Bond Position:  [-1.4980295]


portfolio before change:  [-9.65526708]
curr_Stock_Price:  93.86055109351916
curr_Factors:  [93.86055109]
mat_Sqrt:  [[0.15]]
grads:  [0.01617588]
Stock Position:  0.01617588109526004
Bond Position:  [-11.17354419]


portfolio before change:  [-9.65568336]
curr_Stock_Price:  93.87798958149772
curr_Factors:  [93.87798958]
mat_Sqrt:  [[0.15]]
grads:  [-0.0201333]
Stock Position:  -0.020133297964954562
Bond Position:  [-7.76560983]


portfolio before change:  [-9.64286871]
curr_Stock_Price:  93.21739137946828
curr_Factors:  [93.21739138]
mat_Sqrt:  [[0.15]]
grads:  [-0.12525419]
Stock Position:  -0.12525419165376753
Bond Position:  [2.0330003]


portfolio before change:  [-9.67939333]
curr_Stock_Price:  93.51000984490908
curr_Factors:  [93.51000984]
mat_Sqrt:  [[0.15]]
grads:  [-0.0306219]
Stock Position:  -0.030621895530668464
Bond Position:  [-6.81593958]


portfolio before change:  [-9.68145252]
curr_Stock_Price:  93.56334343754217
curr_Factors:  [93.56334344]
mat_Sqrt:  [[0.15]]
grads:  [0.01869927]
Stock Position:  0.018699265049272457
Bond Position:  [-11.43101827]


portfolio before change:  [-9.67309315]
curr_Stock_Price:  94.04859400117446
curr_Factors:  [94.048594]
mat_Sqrt:  [[0.15]]
grads:  [0.02717408]
Stock Position:  0.02717408478956254
Bond Position:  [-12.22877762]


portfolio before change:  [-9.65446362]
curr_Stock_Price:  94.76228322560529
curr_Factors:  [94.76228323]
mat_Sqrt:  [[0.15]]
grads:  [-0.01119828]
Stock Position:  -0.011198276300304174
Bond Position:  [-8.59328939]


portfolio before change:  [-9.64825907]
curr_Stock_Price:  94.16025809390882
curr_Factors:  [94.16025809]
mat_Sqrt:  [[0.15]]
grads:  [0.12253208]
Stock Position:  0.12253207529197443
Bond Position:  [-21.18591091]


portfolio before change:  [-9.53848836]
curr_Stock_Price:  95.06691765001428
curr_Factors:  [95.06691765]
mat_Sqrt:  [[0.15]]
grads:  [0.05947963]
Stock Position:  0.05947963445615211
Bond Position:  [-15.19303387]


portfolio before change:  [-9.56020955]
curr_Stock_Price:  94.71769551832965
curr_Factors:  [94.71769552]
mat_Sqrt:  [[0.15]]
grads:  [0.01694844]
Stock Position:  0.01694843715691589
Bond Position:  [-11.16552646]


portfolio before change:  [-9.56645012]
curr_Stock_Price:  94.39066226614008
curr_Factors:  [94.39066227]
mat_Sqrt:  [[0.15]]
grads:  [0.09035574]
Stock Position:  0.09035574446910333
Bond Position:  [-18.09518868]


portfolio before change:  [-9.56206633]
curr_Stock_Price:  94.45169630997127
curr_Factors:  [94.45169631]
mat_Sqrt:  [[0.15]]
grads:  [0.0869619]
Stock Position:  0.086961900283315
Bond Position:  [-17.77576533]


portfolio before change:  [-9.60095514]
curr_Stock_Price:  94.0172786590953
curr_Factors:  [94.01727866]
mat_Sqrt:  [[0.15]]
grads:  [-0.05256432]
Stock Position:  -0.05256431990089157
Bond Position:  [-4.65900083]


portfolio before change:  [-9.58092191]
curr_Stock_Price:  93.63062045620772
curr_Factors:  [93.63062046]
mat_Sqrt:  [[0.15]]
grads:  [-0.06300769]
Stock Position:  -0.06300768962290329
Bond Position:  [-3.68147284]


portfolio before change:  [-9.62336216]
curr_Stock_Price:  94.30054107275477
curr_Factors:  [94.30054107]
mat_Sqrt:  [[0.15]]
grads:  [-0.20576655]
Stock Position:  -0.2057665521070228
Bond Position:  [9.78053504]


portfolio before change:  [-9.62029581]
curr_Stock_Price:  94.28860987073558
curr_Factors:  [94.28860987]
mat_Sqrt:  [[0.15]]
grads:  [-0.08622867]
Stock Position:  -0.08622867301101274
Bond Position:  [-1.4899141]


portfolio before change:  [-9.58433593]
curr_Stock_Price:  93.87050068083818
curr_Factors:  [93.87050068]
mat_Sqrt:  [[0.15]]
grads:  [-0.0257261]
Stock Position:  -0.025726097987771725
Bond Position:  [-7.16941424]


portfolio before change:  [-9.57992906]
curr_Stock_Price:  93.68178261495503
curr_Factors:  [93.68178261]
mat_Sqrt:  [[0.15]]
grads:  [-0.03852765]
Stock Position:  -0.03852764994084185
Bond Position:  [-5.97059013]


portfolio before change:  [-9.63373969]
curr_Stock_Price:  95.06877243677415
curr_Factors:  [95.06877244]
mat_Sqrt:  [[0.15]]
grads:  [0.1456491]
Stock Position:  0.1456490999456575
Bond Position:  [-23.48042083]


portfolio before change:  [-9.73996387]
curr_Stock_Price:  94.34953278097039
curr_Factors:  [94.34953278]
mat_Sqrt:  [[0.15]]
grads:  [0.05565219]
Stock Position:  0.055652186998735205
Bond Position:  [-14.99072171]


portfolio before change:  [-9.71999149]
curr_Stock_Price:  94.72524717965226
curr_Factors:  [94.72524718]
mat_Sqrt:  [[0.15]]
grads:  [0.01154657]
Stock Position:  0.011546566142859274
Bond Position:  [-10.81374282]


portfolio before change:  [-9.72234841]
curr_Stock_Price:  94.57965959247753
curr_Factors:  [94.57965959]
mat_Sqrt:  [[0.15]]
grads:  [0.09920598]
Stock Position:  0.0992059811335968
Bond Position:  [-19.10521633]


portfolio before change:  [-9.7362848]
curr_Stock_Price:  94.45121696871458
curr_Factors:  [94.45121697]
mat_Sqrt:  [[0.15]]
grads:  [-0.13080481]
Stock Position:  -0.13080480533236738
Bond Position:  [2.61838825]


portfolio before change:  [-9.75570843]
curr_Stock_Price:  94.6009613413109
curr_Factors:  [94.60096134]
mat_Sqrt:  [[0.15]]
grads:  [0.13356205]
Stock Position:  0.13356205234328355
Bond Position:  [-22.39080698]


portfolio before change:  [-9.62274971]
curr_Stock_Price:  95.60692213544269
curr_Factors:  [95.60692214]
mat_Sqrt:  [[0.15]]
grads:  [-0.0451675]
Stock Position:  -0.04516749949306198
Bond Position:  [-5.3044241]


portfolio before change:  [-9.61904689]
curr_Stock_Price:  95.51760228917762
curr_Factors:  [95.51760229]
mat_Sqrt:  [[0.15]]
grads:  [-0.02214402]
Stock Position:  -0.022144019532888363
Bond Position:  [-7.50390324]


portfolio before change:  [-9.60215207]
curr_Stock_Price:  94.73347045866296
curr_Factors:  [94.73347046]
mat_Sqrt:  [[0.15]]
grads:  [0.05200235]
Stock Position:  0.052002346325913155
Bond Position:  [-14.52851481]


portfolio before change:  [-9.65203104]
curr_Stock_Price:  93.79176473306353
curr_Factors:  [93.79176473]
mat_Sqrt:  [[0.15]]
grads:  [-0.06346348]
Stock Position:  -0.06346347730020577
Bond Position:  [-3.69967951]


portfolio before change:  [-9.67185201]
curr_Stock_Price:  94.10044209314468
curr_Factors:  [94.10044209]
mat_Sqrt:  [[0.15]]
grads:  [0.02421802]
Stock Position:  0.0242180161507151
Bond Position:  [-11.95077804]


portfolio before change:  [-9.68920477]
curr_Stock_Price:  93.41476198220015
curr_Factors:  [93.41476198]
mat_Sqrt:  [[0.15]]
grads:  [0.12953656]
Stock Position:  0.12953656051897505
Bond Position:  [-21.78983174]


portfolio before change:  [-9.66439979]
curr_Stock_Price:  93.61676584857678
curr_Factors:  [93.61676585]
mat_Sqrt:  [[0.15]]
grads:  [-0.10557566]
Stock Position:  -0.10557565747656941
Bond Position:  [0.21925181]


portfolio before change:  [-9.60232755]
curr_Stock_Price:  93.02895479923673
curr_Factors:  [93.0289548]
mat_Sqrt:  [[0.15]]
grads:  [-0.3734108]
Stock Position:  -0.3734108021058425
Bond Position:  [25.13568908]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.60232755]
Stock Price:  92.93116033177745
PL:  [-9.60232755]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.80194620e-02]
 [ 1.70204702e-03]
 [ 4.63785424e-03]
 [ 2.29943748e-03]
 [ 1.09002287e-02]
 [ 1.18234427e-02]
 [ 1.21898322e-03]
 [ 1.17251284e-02]
 [ 1.49397832e-02]
 [-1.88500624e-02]
 [ 1.01824765e-02]
 [-7.01587196e-03]
 [ 1.20447543e-03]
 [ 4.15109465e-03]
 [ 5.01433079e-03]
 [-9.46026426e-03]
 [ 8.46626620e-03]
 [ 2.64063631e-02]
 [ 6.81572463e-03]
 [-1.36826237e-03]
 [ 4.32662465e-02]
 [-1.19117713e-02]
 [ 8.61511585e-03]
 [-2.28528293e-03]
 [ 1.71619722e-02]
 [ 1.83746389e-02]
 [ 9.77497170e-03]
 [-1.80261417e-03]
 [ 7.40601084e-03]
 [-9.87633814e-03]
 [-5.72318980e-03]
 [ 3.35182021e-02]
 [ 6.77681074e-03]
 [-1.43008657e-03]
 [-3.65412347e-03]
 [-4.46004056e-03]
 [-6.66867109e-03]
 [ 8.61812919e-03]
 [ 7.13608544e-04]
 [-8.71311271e-03]
 [-1.83686586e-02]
 [-2.92528177e-03]
 [ 8.11124362e-03]
 [-1.26732988e-02]
 [ 1.81456205e-03]
 [ 8.05701185e-04]
 [-1.37011257e-02]
 [-4.87694273e-03]
 [-9.89570660e-04]
 [ 1.12185063e-04]
 [-2.98237641e-03]
 [ 3.66690427e-03]
 [ 9.06998471e-04]
 [ 3.28897214e-03]
 [-2.29899283e-03]
 [ 8.71454972e-03]
 [-6.05381747e-03]
 [-1.43501877e-02]
 [ 1.37239137e-02]
 [ 4.60497811e-03]
 [ 1.03104782e-02]
 [-1.31597193e-02]
 [-1.26713873e-02]
 [-3.17708250e-03]
 [ 1.41105507e-02]
 [-1.25650530e-02]
 [ 2.69609267e-02]
 [ 3.14830671e-03]
 [ 7.81450732e-03]
 [-1.86410599e-02]
 [-7.71297075e-03]
 [-7.52888945e-03]
 [ 2.83678885e-03]
 [ 7.67280138e-03]
 [ 2.90254012e-03]
 [-1.28187237e-02]
 [ 6.01589018e-03]
 [-4.19158403e-03]
 [ 2.07750660e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.36601791]
curr_Stock_Price:  100.34060689034072
curr_Factors:  [100.34060689]
mat_Sqrt:  [[0.15]]
grads:  [-0.32012975]
Stock Position:  -0.3201297467364738
Bond Position:  [39.48803098]


portfolio before change:  [7.10793397]
curr_Stock_Price:  101.15450195794834
curr_Factors:  [101.15450196]
mat_Sqrt:  [[0.15]]
grads:  [0.01134698]
Stock Position:  0.01134698012026567
Bond Position:  [5.96013585]


portfolio before change:  [7.10819563]
curr_Stock_Price:  101.14473163000754
curr_Factors:  [101.14473163]
mat_Sqrt:  [[0.15]]
grads:  [0.03091903]
Stock Position:  0.030919028265628975
Bond Position:  [3.98089881]


portfolio before change:  [7.0900373]
curr_Stock_Price:  100.54939803821621
curr_Factors:  [100.54939804]
mat_Sqrt:  [[0.15]]
grads:  [0.01532958]
Stock Position:  0.015329583221026502
Bond Position:  [5.54865694]


portfolio before change:  [7.08771269]
curr_Stock_Price:  100.37513285424785
curr_Factors:  [100.37513285]
mat_Sqrt:  [[0.15]]
grads:  [0.07266819]
Stock Position:  0.07266819131746889
Bond Position:  [-0.20636666]


portfolio before change:  [7.10309884]
curr_Stock_Price:  100.58704190314256
curr_Factors:  [100.5870419]
mat_Sqrt:  [[0.15]]
grads:  [0.07882295]
Stock Position:  0.07882295114252662
Bond Position:  [-0.82546865]


portfolio before change:  [7.07163827]
curr_Stock_Price:  100.18856681120425
curr_Factors:  [100.18856681]
mat_Sqrt:  [[0.15]]
grads:  [0.00812655]
Stock Position:  0.008126554779548599
Bond Position:  [6.25745039]


portfolio before change:  [7.06904326]
curr_Stock_Price:  99.8211155261386
curr_Factors:  [99.82111553]
mat_Sqrt:  [[0.15]]
grads:  [0.07816752]
Stock Position:  0.07816752261716849
Bond Position:  [-0.73372605]


portfolio before change:  [7.07209216]
curr_Stock_Price:  99.86070694402243
curr_Factors:  [99.86070694]
mat_Sqrt:  [[0.15]]
grads:  [0.09959855]
Stock Position:  0.09959855497691493
Bond Position:  [-2.87388995]


portfolio before change:  [7.10197153]
curr_Stock_Price:  100.16250848535351
curr_Factors:  [100.16250849]
mat_Sqrt:  [[0.15]]
grads:  [-0.12566708]
Stock Position:  -0.1256670828286971
Bond Position:  [19.68910178]


portfolio before change:  [7.00118114]
curr_Stock_Price:  100.97434403263365
curr_Factors:  [100.97434403]
mat_Sqrt:  [[0.15]]
grads:  [0.06788318]
Stock Position:  0.06788317671361185
Bond Position:  [0.1467219]


portfolio before change:  [6.99772818]
curr_Stock_Price:  100.92334281279665
curr_Factors:  [100.92334281]
mat_Sqrt:  [[0.15]]
grads:  [-0.04677248]
Stock Position:  -0.046772479737978254
Bond Position:  [11.71816319]


portfolio before change:  [7.00826758]
curr_Stock_Price:  100.7136684932428
curr_Factors:  [100.71366849]
mat_Sqrt:  [[0.15]]
grads:  [0.00802984]
Stock Position:  0.008029836227139153
Bond Position:  [6.19955331]


portfolio before change:  [7.01101421]
curr_Stock_Price:  101.00746620583969
curr_Factors:  [101.00746621]
mat_Sqrt:  [[0.15]]
grads:  [0.02767396]
Stock Position:  0.027673964315559324
Bond Position:  [4.21573719]


portfolio before change:  [7.00800807]
curr_Stock_Price:  100.88931808396386
curr_Factors:  [100.88931808]
mat_Sqrt:  [[0.15]]
grads:  [0.03342887]
Stock Position:  0.03342887196178727
Bond Position:  [3.63539198]


portfolio before change:  [7.06250186]
curr_Stock_Price:  102.5126622961053
curr_Factors:  [102.5126623]
mat_Sqrt:  [[0.15]]
grads:  [-0.06306843]
Stock Position:  -0.0630684284080863
Bond Position:  [13.52781436]


portfolio before change:  [7.07934725]
curr_Stock_Price:  102.2589716150448
curr_Factors:  [102.25897162]
mat_Sqrt:  [[0.15]]
grads:  [0.05644177]
Stock Position:  0.05644177468413489
Bond Position:  [1.30766941]


portfolio before change:  [7.08678363]
curr_Stock_Price:  102.38927676285485
curr_Factors:  [102.38927676]
mat_Sqrt:  [[0.15]]
grads:  [0.17604242]
Stock Position:  0.176042420852216
Bond Position:  [-10.93807252]


portfolio before change:  [7.17331862]
curr_Stock_Price:  102.88471780388176
curr_Factors:  [102.8847178]
mat_Sqrt:  [[0.15]]
grads:  [0.04543816]
Stock Position:  0.04543816421828359
Bond Position:  [2.49842592]


portfolio before change:  [7.14749933]
curr_Stock_Price:  102.31305202818616
curr_Factors:  [102.31305203]
mat_Sqrt:  [[0.15]]
grads:  [-0.00912175]
Stock Position:  -0.00912174914013273
Bond Position:  [8.08077333]


portfolio before change:  [7.14580873]
curr_Stock_Price:  102.55375872187967
curr_Factors:  [102.55375872]
mat_Sqrt:  [[0.15]]
grads:  [0.28844164]
Stock Position:  0.28844164303549896
Bond Position:  [-22.43496593]


portfolio before change:  [7.1536584]
curr_Stock_Price:  102.58583416907334
curr_Factors:  [102.58583417]
mat_Sqrt:  [[0.15]]
grads:  [-0.07941181]
Stock Position:  -0.07941180878663492
Bond Position:  [15.30018505]


portfolio before change:  [7.2025452]
curr_Stock_Price:  101.98226515580171
curr_Factors:  [101.98226516]
mat_Sqrt:  [[0.15]]
grads:  [0.05743411]
Stock Position:  0.05743410567486611
Bond Position:  [1.345285]


portfolio before change:  [7.25037021]
curr_Stock_Price:  102.81349473718913
curr_Factors:  [102.81349474]
mat_Sqrt:  [[0.15]]
grads:  [-0.01523522]
Stock Position:  -0.01523521955255869
Bond Position:  [8.81675637]


portfolio before change:  [7.26071191]
curr_Stock_Price:  102.17086311610645
curr_Factors:  [102.17086312]
mat_Sqrt:  [[0.15]]
grads:  [0.11441315]
Stock Position:  0.11441314795304759
Bond Position:  [-4.42897817]


portfolio before change:  [7.29095144]
curr_Stock_Price:  102.43758379666414
curr_Factors:  [102.4375838]
mat_Sqrt:  [[0.15]]
grads:  [0.12249759]
Stock Position:  0.12249759240917313
Bond Position:  [-5.25740595]


portfolio before change:  [7.33170338]
curr_Stock_Price:  102.77294175897403
curr_Factors:  [102.77294176]
mat_Sqrt:  [[0.15]]
grads:  [0.06516648]
Stock Position:  0.06516647797418466
Bond Position:  [0.63435274]


portfolio before change:  [7.39061372]
curr_Stock_Price:  103.67633091725861
curr_Factors:  [103.67633092]
mat_Sqrt:  [[0.15]]
grads:  [-0.01201743]
Stock Position:  -0.012017427812282544
Bond Position:  [8.63653654]


portfolio before change:  [7.39361478]
curr_Stock_Price:  103.47152361557028
curr_Factors:  [103.47152362]
mat_Sqrt:  [[0.15]]
grads:  [0.04937341]
Stock Position:  0.049373405575241114
Bond Position:  [2.28487328]


portfolio before change:  [7.39534329]
curr_Stock_Price:  103.50364009614695
curr_Factors:  [103.5036401]
mat_Sqrt:  [[0.15]]
grads:  [-0.06584225]
Stock Position:  -0.06584225427077202
Bond Position:  [14.21025628]


portfolio before change:  [7.41574151]
curr_Stock_Price:  103.20732494094557
curr_Factors:  [103.20732494]
mat_Sqrt:  [[0.15]]
grads:  [-0.0381546]
Stock Position:  -0.03815459869119688
Bond Position:  [11.35357558]


portfolio before change:  [7.448825]
curr_Stock_Price:  102.35883301011661
curr_Factors:  [102.35883301]
mat_Sqrt:  [[0.15]]
grads:  [0.22345468]
Stock Position:  0.22345468076951436
Bond Position:  [-15.42373535]


portfolio before change:  [7.48519796]
curr_Stock_Price:  102.52592268314524
curr_Factors:  [102.52592268]
mat_Sqrt:  [[0.15]]
grads:  [0.04517874]
Stock Position:  0.04517873823911255
Bond Position:  [2.85320614]


portfolio before change:  [7.48121309]
curr_Stock_Price:  102.43377308095096
curr_Factors:  [102.43377308]
mat_Sqrt:  [[0.15]]
grads:  [-0.00953391]
Stock Position:  -0.009533910445184245
Bond Position:  [8.45780751]


portfolio before change:  [7.48539495]
curr_Stock_Price:  102.0505904647674
curr_Factors:  [102.05059046]
mat_Sqrt:  [[0.15]]
grads:  [-0.02436082]
Stock Position:  -0.02436082315357579
Bond Position:  [9.97143133]


portfolio before change:  [7.48929425]
curr_Stock_Price:  101.91610950018315
curr_Factors:  [101.9161095]
mat_Sqrt:  [[0.15]]
grads:  [-0.0297336]
Stock Position:  -0.029733603731476096
Bond Position:  [10.51962746]


portfolio before change:  [7.47344589]
curr_Stock_Price:  102.47123412975724
curr_Factors:  [102.47123413]
mat_Sqrt:  [[0.15]]
grads:  [-0.04445781]
Stock Position:  -0.044457807264797713
Bond Position:  [12.02909227]


portfolio before change:  [7.51455942]
curr_Stock_Price:  101.56336901345112
curr_Factors:  [101.56336901]
mat_Sqrt:  [[0.15]]
grads:  [0.05745419]
Stock Position:  0.057454194593395534
Bond Position:  [1.67931786]


portfolio before change:  [7.52254311]
curr_Stock_Price:  101.70049959205451
curr_Factors:  [101.70049959]
mat_Sqrt:  [[0.15]]
grads:  [0.00475739]
Stock Position:  0.004757390293644061
Bond Position:  [7.03871414]


portfolio before change:  [7.5228943]
curr_Stock_Price:  101.68184531798286
curr_Factors:  [101.68184532]
mat_Sqrt:  [[0.15]]
grads:  [-0.05808742]
Stock Position:  -0.058087418048496334
Bond Position:  [13.42933016]


portfolio before change:  [7.52932285]
curr_Stock_Price:  101.58562498765068
curr_Factors:  [101.58562499]
mat_Sqrt:  [[0.15]]
grads:  [-0.12245772]
Stock Position:  -0.12245772413938635
Bond Position:  [19.96926729]


portfolio before change:  [7.66419871]
curr_Stock_Price:  100.49440970175569
curr_Factors:  [100.4944097]
mat_Sqrt:  [[0.15]]
grads:  [-0.01950188]
Stock Position:  -0.019501878489509968
Bond Position:  [9.62402847]


portfolio before change:  [7.65997103]
curr_Stock_Price:  100.74203690673141
curr_Factors:  [100.74203691]
mat_Sqrt:  [[0.15]]
grads:  [0.05407496]
Stock Position:  0.054074957455316416
Bond Position:  [2.21234967]


portfolio before change:  [7.63967331]
curr_Stock_Price:  100.36411702150248
curr_Factors:  [100.36411702]
mat_Sqrt:  [[0.15]]
grads:  [-0.08448866]
Stock Position:  -0.08448865883198055
Bond Position:  [16.11930295]


portfolio before change:  [7.59967951]
curr_Stock_Price:  100.849404426945
curr_Factors:  [100.84940443]
mat_Sqrt:  [[0.15]]
grads:  [0.01209708]
Stock Position:  0.012097080359039782
Bond Position:  [6.37969616]


portfolio before change:  [7.59895892]
curr_Stock_Price:  100.75687519650225
curr_Factors:  [100.7568752]
mat_Sqrt:  [[0.15]]
grads:  [0.00537134]
Stock Position:  0.0053713412346165735
Bond Position:  [7.05775936]


portfolio before change:  [7.60192789]
curr_Stock_Price:  101.22749205714463
curr_Factors:  [101.22749206]
mat_Sqrt:  [[0.15]]
grads:  [-0.09134084]
Stock Position:  -0.09134083778214494
Bond Position:  [16.84813182]


portfolio before change:  [7.61673855]
curr_Stock_Price:  101.07687355440234
curr_Factors:  [101.07687355]
mat_Sqrt:  [[0.15]]
grads:  [-0.03251295]
Stock Position:  -0.032512951511315086
Bond Position:  [10.90304604]


portfolio before change:  [7.59911389]
curr_Stock_Price:  101.63991461698096
curr_Factors:  [101.63991462]
mat_Sqrt:  [[0.15]]
grads:  [-0.00659714]
Stock Position:  -0.006597137730530445
Bond Position:  [8.2696464]


portfolio before change:  [7.60035855]
curr_Stock_Price:  101.52959433363631
curr_Factors:  [101.52959433]
mat_Sqrt:  [[0.15]]
grads:  [0.0007479]
Stock Position:  0.0007479004184690434
Bond Position:  [7.52442453]


portfolio before change:  [7.60046187]
curr_Stock_Price:  101.03892121043626
curr_Factors:  [101.03892121]
mat_Sqrt:  [[0.15]]
grads:  [-0.01988251]
Stock Position:  -0.01988250937612989
Bond Position:  [9.60936917]


portfolio before change:  [7.57868692]
curr_Stock_Price:  102.16430985767941
curr_Factors:  [102.16430986]
mat_Sqrt:  [[0.15]]
grads:  [0.02444603]
Stock Position:  0.024446028472613065
Bond Position:  [5.0811753]


portfolio before change:  [7.58421473]
curr_Stock_Price:  102.3774415667994
curr_Factors:  [102.37744157]
mat_Sqrt:  [[0.15]]
grads:  [0.00604666]
Stock Position:  0.006046656472545961
Bond Position:  [6.96517351]


portfolio before change:  [7.58532363]
curr_Stock_Price:  102.48883508144357
curr_Factors:  [102.48883508]
mat_Sqrt:  [[0.15]]
grads:  [0.02192648]
Stock Position:  0.021926480947980234
Bond Position:  [5.33810414]


portfolio before change:  [7.58564805]
curr_Stock_Price:  102.48841466965784
curr_Factors:  [102.48841467]
mat_Sqrt:  [[0.15]]
grads:  [-0.01532662]
Stock Position:  -0.015326618862427685
Bond Position:  [9.15644892]


portfolio before change:  [7.58675836]
curr_Stock_Price:  102.45331122459751
curr_Factors:  [102.45331122]
mat_Sqrt:  [[0.15]]
grads:  [0.058097]
Stock Position:  0.05809699814416293
Bond Position:  [1.63452853]


portfolio before change:  [7.60224194]
curr_Stock_Price:  102.71806524518702
curr_Factors:  [102.71806525]
mat_Sqrt:  [[0.15]]
grads:  [-0.04035878]
Stock Position:  -0.04035878312546484
Bond Position:  [11.74781806]


portfolio before change:  [7.63091421]
curr_Stock_Price:  102.02582410203551
curr_Factors:  [102.0258241]
mat_Sqrt:  [[0.15]]
grads:  [-0.09566792]
Stock Position:  -0.09566791829040604
Bond Position:  [17.39151241]


portfolio before change:  [7.61617263]
curr_Stock_Price:  102.191277481253
curr_Factors:  [102.19127748]
mat_Sqrt:  [[0.15]]
grads:  [0.09149276]
Stock Position:  0.0914927578854491
Bond Position:  [-1.73358918]


portfolio before change:  [7.58295359]
curr_Stock_Price:  101.82938336176599
curr_Factors:  [101.82938336]
mat_Sqrt:  [[0.15]]
grads:  [0.03069985]
Stock Position:  0.030699854046783045
Bond Position:  [4.45680638]


portfolio before change:  [7.58397444]
curr_Stock_Price:  101.85356245492775
curr_Factors:  [101.85356245]
mat_Sqrt:  [[0.15]]
grads:  [0.06873652]
Stock Position:  0.06873652138396912
Bond Position:  [0.58291487]


portfolio before change:  [7.53549227]
curr_Stock_Price:  101.14769889517831
curr_Factors:  [101.1476989]
mat_Sqrt:  [[0.15]]
grads:  [-0.08773146]
Stock Position:  -0.08773146187720347
Bond Position:  [16.40932776]


portfolio before change:  [7.45770605]
curr_Stock_Price:  102.04602924898713
curr_Factors:  [102.04602925]
mat_Sqrt:  [[0.15]]
grads:  [-0.08447592]
Stock Position:  -0.08447591525315735
Bond Position:  [16.07813777]


portfolio before change:  [7.37715729]
curr_Stock_Price:  103.01143669497023
curr_Factors:  [103.01143669]
mat_Sqrt:  [[0.15]]
grads:  [-0.02118055]
Stock Position:  -0.021180550010426215
Bond Position:  [9.55899617]


portfolio before change:  [7.36035074]
curr_Stock_Price:  103.83313412098359
curr_Factors:  [103.83313412]
mat_Sqrt:  [[0.15]]
grads:  [0.09407034]
Stock Position:  0.094070337950733
Bond Position:  [-2.40726728]


portfolio before change:  [7.26361037]
curr_Stock_Price:  102.80635021526484
curr_Factors:  [102.80635022]
mat_Sqrt:  [[0.15]]
grads:  [-0.08376702]
Stock Position:  -0.08376702027735972
Bond Position:  [15.875392]


portfolio before change:  [7.24779815]
curr_Stock_Price:  103.00695977563174
curr_Factors:  [103.00695978]
mat_Sqrt:  [[0.15]]
grads:  [0.17973951]
Stock Position:  0.17973951137142746
Bond Position:  [-11.26662247]


portfolio before change:  [7.28886135]
curr_Stock_Price:  103.23933711401742
curr_Factors:  [103.23933711]
mat_Sqrt:  [[0.15]]
grads:  [0.02098871]
Stock Position:  0.020988711432149573
Bond Position:  [5.1220007]


portfolio before change:  [7.28144523]
curr_Stock_Price:  102.87074572294979
curr_Factors:  [102.87074572]
mat_Sqrt:  [[0.15]]
grads:  [0.05209672]
Stock Position:  0.05209671545230411
Bond Position:  [1.92221726]


portfolio before change:  [7.30003397]
curr_Stock_Price:  103.22525176672163
curr_Factors:  [103.22525177]
mat_Sqrt:  [[0.15]]
grads:  [-0.12427373]
Stock Position:  -0.12427373286365229
Bond Position:  [20.12822134]


portfolio before change:  [7.28646677]
curr_Stock_Price:  103.34454692215755
curr_Factors:  [103.34454692]
mat_Sqrt:  [[0.15]]
grads:  [-0.0514198]
Stock Position:  -0.05141980497743755
Bond Position:  [12.60042322]


portfolio before change:  [7.28899727]
curr_Stock_Price:  103.31065051802476
curr_Factors:  [103.31065052]
mat_Sqrt:  [[0.15]]
grads:  [-0.0501926]
Stock Position:  -0.05019259634673998
Bond Position:  [12.47442705]


portfolio before change:  [7.31501357]
curr_Stock_Price:  102.8078548059753
curr_Factors:  [102.80785481]
mat_Sqrt:  [[0.15]]
grads:  [0.01891193]
Stock Position:  0.01891192569704487
Bond Position:  [5.37071906]


portfolio before change:  [7.31358539]
curr_Stock_Price:  102.71458796470883
curr_Factors:  [102.71458796]
mat_Sqrt:  [[0.15]]
grads:  [0.05115201]
Stock Position:  0.051152009220100304
Bond Position:  [2.05952784]


portfolio before change:  [7.27343988]
curr_Stock_Price:  101.92724374164145
curr_Factors:  [101.92724374]
mat_Sqrt:  [[0.15]]
grads:  [0.01935027]
Stock Position:  0.019350267488706094
Bond Position:  [5.30112045]


portfolio before change:  [7.28209062]
curr_Stock_Price:  102.35718154960443
curr_Factors:  [102.35718155]
mat_Sqrt:  [[0.15]]
grads:  [-0.08545816]
Stock Position:  -0.0854581577066131
Bond Position:  [16.02934678]


portfolio before change:  [7.24462647]
curr_Stock_Price:  102.80729669907286
curr_Factors:  [102.8072967]
mat_Sqrt:  [[0.15]]
grads:  [0.04010593]
Stock Position:  0.04010593454788393
Bond Position:  [3.12144376]


portfolio before change:  [7.24135728]
curr_Stock_Price:  102.72091829296238
curr_Factors:  [102.72091829]
mat_Sqrt:  [[0.15]]
grads:  [-0.02794389]
Stock Position:  -0.02794389350774702
Bond Position:  [10.11177969]


portfolio before change:  [7.24007159]
curr_Stock_Price:  102.78954521226557
curr_Factors:  [102.78954521]
mat_Sqrt:  [[0.15]]
grads:  [0.13850044]
Stock Position:  0.13850044003122866
Bond Position:  [-6.99632566]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.24007159]
Stock Price:  102.54569852383776
PL:  [4.69437306]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-7.18466982e-02]
 [ 3.15243212e-03]
 [ 1.18368599e-02]
 [ 3.00524168e-03]
 [ 3.16729452e-03]
 [ 1.22891119e-02]
 [ 1.44370337e-04]
 [ 9.24320891e-03]
 [-5.29173066e-03]
 [-2.04153090e-02]
 [ 1.01344425e-02]
 [-6.60622020e-03]
 [-5.08671535e-03]
 [ 4.25945267e-03]
 [ 4.82812631e-03]
 [ 2.25411797e-03]
 [-1.47802183e-03]
 [ 1.60548887e-03]
 [-1.17038028e-02]
 [ 1.44091414e-02]
 [-3.02401523e-02]
 [-2.53089028e-02]
 [-5.85292886e-04]
 [ 1.31728106e-02]
 [-8.56133709e-04]
 [ 1.68774485e-02]
 [ 1.59554996e-02]
 [ 3.71402994e-03]
 [ 9.38650086e-04]
 [-2.94289677e-03]
 [-3.54726788e-03]
 [-2.11045603e-02]
 [ 2.06107138e-02]
 [ 1.02628093e-02]
 [-1.98834676e-02]
 [ 7.78903434e-03]
 [-2.77728210e-03]
 [-1.30427995e-04]
 [ 5.37441190e-03]
 [-1.54358647e-02]
 [ 4.29744784e-02]
 [ 9.79946570e-04]
 [ 8.87970290e-03]
 [-9.42994857e-03]
 [-2.75950158e-03]
 [-1.61636200e-02]
 [-1.30889156e-02]
 [ 1.54741388e-03]
 [-2.89653516e-03]
 [-1.06921091e-02]
 [-4.29300678e-03]
 [ 2.75542166e-03]
 [ 3.83104905e-03]
 [-8.82679307e-04]
 [ 5.78488067e-03]
 [ 8.85358493e-03]
 [ 1.12648015e-02]
 [ 9.42440161e-03]
 [ 1.30601148e-02]
 [-5.85380914e-03]
 [-7.49204350e-03]
 [-3.09092416e-02]
 [-1.29216745e-02]
 [-3.56664405e-03]
 [-6.23740017e-03]
 [ 2.50896872e-02]
 [ 8.29486066e-03]
 [ 1.75540115e-03]
 [ 1.37718387e-02]
 [-1.91662965e-02]
 [ 1.76940572e-02]
 [-1.51567206e-02]
 [-4.09517688e-03]
 [ 7.76828342e-03]
 [-5.49738670e-03]
 [ 3.27293381e-03]
 [ 1.41433370e-02]
 [-1.30968806e-02]
 [-4.85016365e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.27745651]
curr_Stock_Price:  100.72053894784503
curr_Factors:  [100.72053895]
mat_Sqrt:  [[0.15]]
grads:  [-0.47897799]
Stock Position:  -0.4789779882777954
Bond Position:  [61.52037763]


portfolio before change:  [12.92850455]
curr_Stock_Price:  101.45710118136672
curr_Factors:  [101.45710118]
mat_Sqrt:  [[0.15]]
grads:  [0.02101621]
Stock Position:  0.021016214145779612
Bond Position:  [10.79626039]


portfolio before change:  [12.93600662]
curr_Stock_Price:  101.78195919202504
curr_Factors:  [101.78195919]
mat_Sqrt:  [[0.15]]
grads:  [0.0789124]
Stock Position:  0.07891239935204919
Bond Position:  [4.90414801]


portfolio before change:  [12.91114102]
curr_Stock_Price:  101.4629709521246
curr_Factors:  [101.46297095]
mat_Sqrt:  [[0.15]]
grads:  [0.02003494]
Stock Position:  0.020034944530501003
Bond Position:  [10.87833602]


portfolio before change:  [12.91994095]
curr_Stock_Price:  101.8682637371163
curr_Factors:  [101.86826374]
mat_Sqrt:  [[0.15]]
grads:  [0.0211153]
Stock Position:  0.021115296772386043
Bond Position:  [10.76896233]


portfolio before change:  [12.93038662]
curr_Stock_Price:  102.33108399478049
curr_Factors:  [102.33108399]
mat_Sqrt:  [[0.15]]
grads:  [0.08192741]
Stock Position:  0.08192741237937574
Bond Position:  [4.5466657]


portfolio before change:  [12.84903109]
curr_Stock_Price:  101.33459573043753
curr_Factors:  [101.33459573]
mat_Sqrt:  [[0.15]]
grads:  [0.00096247]
Stock Position:  0.0009624689133581118
Bond Position:  [12.75149969]


portfolio before change:  [12.849269]
curr_Stock_Price:  100.7537051010087
curr_Factors:  [100.7537051]
mat_Sqrt:  [[0.15]]
grads:  [0.06162139]
Stock Position:  0.06162139276159521
Bond Position:  [6.64068536]


portfolio before change:  [12.88204975]
curr_Stock_Price:  101.27893987274851
curr_Factors:  [101.27893987]
mat_Sqrt:  [[0.15]]
grads:  [-0.0352782]
Stock Position:  -0.0352782044219304
Bond Position:  [16.45498889]


portfolio before change:  [12.89949797]
curr_Stock_Price:  100.8135038363607
curr_Factors:  [100.81350384]
mat_Sqrt:  [[0.15]]
grads:  [-0.13610206]
Stock Position:  -0.1361020600525601
Bond Position:  [26.62042352]


portfolio before change:  [12.97564694]
curr_Stock_Price:  100.26622962986082
curr_Factors:  [100.26622963]
mat_Sqrt:  [[0.15]]
grads:  [0.06756295]
Stock Position:  0.06756294979990175
Bond Position:  [6.2013647]


portfolio before change:  [13.00790297]
curr_Stock_Price:  100.73791471140109
curr_Factors:  [100.73791471]
mat_Sqrt:  [[0.15]]
grads:  [-0.04404147]
Stock Position:  -0.044041467987359806
Bond Position:  [17.44454862]


portfolio before change:  [13.02702237]
curr_Stock_Price:  100.32854885080621
curr_Factors:  [100.32854885]
mat_Sqrt:  [[0.15]]
grads:  [-0.03391144]
Stock Position:  -0.03391143569180945
Bond Position:  [16.4293075]


portfolio before change:  [13.02970004]
curr_Stock_Price:  100.27986869765704
curr_Factors:  [100.2798687]
mat_Sqrt:  [[0.15]]
grads:  [0.02839635]
Stock Position:  0.028396351106368053
Bond Position:  [10.18211768]


portfolio before change:  [13.01947497]
curr_Stock_Price:  99.89737330038008
curr_Factors:  [99.8973733]
mat_Sqrt:  [[0.15]]
grads:  [0.03218751]
Stock Position:  0.03218750871099671
Bond Position:  [9.8040274]


portfolio before change:  [13.01589337]
curr_Stock_Price:  99.76706266237251
curr_Factors:  [99.76706266]
mat_Sqrt:  [[0.15]]
grads:  [0.01502745]
Stock Position:  0.015027453137704216
Bond Position:  [11.51664851]


portfolio before change:  [13.00195126]
curr_Stock_Price:  98.79138679033184
curr_Factors:  [98.79138679]
mat_Sqrt:  [[0.15]]
grads:  [-0.00985348]
Stock Position:  -0.00985347885317428
Bond Position:  [13.9753901]


portfolio before change:  [13.00946494]
curr_Stock_Price:  98.11749340863611
curr_Factors:  [98.11749341]
mat_Sqrt:  [[0.15]]
grads:  [0.01070326]
Stock Position:  0.010703259161118871
Bond Position:  [11.95928798]


portfolio before change:  [13.00053671]
curr_Stock_Price:  97.21349639448933
curr_Factors:  [97.21349639]
mat_Sqrt:  [[0.15]]
grads:  [-0.07802535]
Stock Position:  -0.07802535205311738
Bond Position:  [20.58565399]


portfolio before change:  [12.97981157]
curr_Stock_Price:  97.49560696616945
curr_Factors:  [97.49560697]
mat_Sqrt:  [[0.15]]
grads:  [0.09606094]
Stock Position:  0.09606094243594772
Bond Position:  [3.61429168]


portfolio before change:  [12.95086557]
curr_Stock_Price:  97.1919257199991
curr_Factors:  [97.19192572]
mat_Sqrt:  [[0.15]]
grads:  [-0.20160102]
Stock Position:  -0.201601015167924
Bond Position:  [32.54485646]


portfolio before change:  [12.92499019]
curr_Stock_Price:  97.33036498554529
curr_Factors:  [97.33036499]
mat_Sqrt:  [[0.15]]
grads:  [-0.16872602]
Stock Position:  -0.16872601894703962
Bond Position:  [29.34715519]


portfolio before change:  [12.82021554]
curr_Stock_Price:  97.96221121739195
curr_Factors:  [97.96221122]
mat_Sqrt:  [[0.15]]
grads:  [-0.00390195]
Stock Position:  -0.003901952573163442
Bond Position:  [13.20245944]


portfolio before change:  [12.81804685]
curr_Stock_Price:  98.72948731103129
curr_Factors:  [98.72948731]
mat_Sqrt:  [[0.15]]
grads:  [0.08781874]
Stock Position:  0.08781873710075194
Bond Position:  [4.14774796]


portfolio before change:  [12.71497442]
curr_Stock_Price:  97.55284009897721
curr_Factors:  [97.5528401]
mat_Sqrt:  [[0.15]]
grads:  [-0.00570756]
Stock Position:  -0.005707558057642097
Bond Position:  [13.27176292]


portfolio before change:  [12.71875525]
curr_Stock_Price:  97.03575033298924
curr_Factors:  [97.03575033]
mat_Sqrt:  [[0.15]]
grads:  [0.11251632]
Stock Position:  0.11251632303263116
Bond Position:  [1.80064942]


portfolio before change:  [12.73304015]
curr_Stock_Price:  97.16170861127621
curr_Factors:  [97.16170861]
mat_Sqrt:  [[0.15]]
grads:  [0.10637]
Stock Position:  0.10636999706459652
Bond Position:  [2.39794949]


portfolio before change:  [12.71727986]
curr_Stock_Price:  97.01213471006255
curr_Factors:  [97.01213471]
mat_Sqrt:  [[0.15]]
grads:  [0.0247602]
Stock Position:  0.024760199595339923
Bond Position:  [10.31524004]


portfolio before change:  [12.72569792]
curr_Stock_Price:  97.3260797117181
curr_Factors:  [97.32607971]
mat_Sqrt:  [[0.15]]
grads:  [0.00625767]
Stock Position:  0.006257667242332005
Bond Position:  [12.1166637]


portfolio before change:  [12.72793283]
curr_Stock_Price:  97.56220514472528
curr_Factors:  [97.56220514]
mat_Sqrt:  [[0.15]]
grads:  [-0.01961931]
Stock Position:  -0.019619311779459532
Bond Position:  [14.64203615]


portfolio before change:  [12.72421464]
curr_Stock_Price:  97.79836741400935
curr_Factors:  [97.79836741]
mat_Sqrt:  [[0.15]]
grads:  [-0.02364845]
Stock Position:  -0.02364845254628051
Bond Position:  [15.03699469]


portfolio before change:  [12.73240839]
curr_Stock_Price:  97.49162834764655
curr_Factors:  [97.49162835]
mat_Sqrt:  [[0.15]]
grads:  [-0.14069707]
Stock Position:  -0.14069706847966823
Bond Position:  [26.4491947]


portfolio before change:  [12.83928663]
curr_Stock_Price:  96.74374411149438
curr_Factors:  [96.74374411]
mat_Sqrt:  [[0.15]]
grads:  [0.13740476]
Stock Position:  0.13740475895283008
Bond Position:  [-0.4537642]


portfolio before change:  [12.96559364]
curr_Stock_Price:  97.66318364684768
curr_Factors:  [97.66318365]
mat_Sqrt:  [[0.15]]
grads:  [0.06841873]
Stock Position:  0.06841872864048801
Bond Position:  [6.28360278]


portfolio before change:  [12.97418724]
curr_Stock_Price:  97.78304651200631
curr_Factors:  [97.78304651]
mat_Sqrt:  [[0.15]]
grads:  [-0.13255645]
Stock Position:  -0.1325564505398295
Bond Position:  [25.93596081]


portfolio before change:  [13.01932763]
curr_Stock_Price:  97.45473856880966
curr_Factors:  [97.45473857]
mat_Sqrt:  [[0.15]]
grads:  [0.0519269]
Stock Position:  0.05192689560168624
Bond Position:  [7.95880559]


portfolio before change:  [12.99955798]
curr_Stock_Price:  97.06443814915899
curr_Factors:  [97.06443815]
mat_Sqrt:  [[0.15]]
grads:  [-0.01851521]
Stock Position:  -0.018515214028021382
Bond Position:  [14.79672683]


portfolio before change:  [13.00156949]
curr_Stock_Price:  97.00574638695096
curr_Factors:  [97.00574639]
mat_Sqrt:  [[0.15]]
grads:  [-0.00086952]
Stock Position:  -0.000869519966523076
Bond Position:  [13.08591793]


portfolio before change:  [13.00237126]
curr_Stock_Price:  97.02429749797346
curr_Factors:  [97.0242975]
mat_Sqrt:  [[0.15]]
grads:  [0.03582941]
Stock Position:  0.03582941266345885
Bond Position:  [9.52604767]


portfolio before change:  [13.0240597]
curr_Stock_Price:  97.61300492453721
curr_Factors:  [97.61300492]
mat_Sqrt:  [[0.15]]
grads:  [-0.10290576]
Stock Position:  -0.10290576476304157
Bond Position:  [23.06900062]


portfolio before change:  [13.13807551]
curr_Stock_Price:  96.51905302037268
curr_Factors:  [96.51905302]
mat_Sqrt:  [[0.15]]
grads:  [0.28649652]
Stock Position:  0.286496522962647
Bond Position:  [-14.51429758]


portfolio before change:  [13.12600779]
curr_Stock_Price:  96.48009775127342
curr_Factors:  [96.48009775]
mat_Sqrt:  [[0.15]]
grads:  [0.00653298]
Stock Position:  0.00653297713236251
Bond Position:  [12.49570552]


portfolio before change:  [13.12089571]
curr_Stock_Price:  95.57804556034935
curr_Factors:  [95.57804556]
mat_Sqrt:  [[0.15]]
grads:  [0.05919802]
Stock Position:  0.05919801935449834
Bond Position:  [7.46286472]


portfolio before change:  [13.11556046]
curr_Stock_Price:  95.48004061355898
curr_Factors:  [95.48004061]
mat_Sqrt:  [[0.15]]
grads:  [-0.06286632]
Stock Position:  -0.06286632379802083
Bond Position:  [19.1180396]


portfolio before change:  [13.12741458]
curr_Stock_Price:  95.31048698383191
curr_Factors:  [95.31048698]
mat_Sqrt:  [[0.15]]
grads:  [-0.01839668]
Stock Position:  -0.018396677185387286
Bond Position:  [14.88081084]


portfolio before change:  [13.13449815]
curr_Stock_Price:  94.97599816133305
curr_Factors:  [94.97599816]
mat_Sqrt:  [[0.15]]
grads:  [-0.10775747]
Stock Position:  -0.10775746639478646
Bond Position:  [23.36887108]


portfolio before change:  [13.16706572]
curr_Stock_Price:  94.6873223233807
curr_Factors:  [94.68732232]
mat_Sqrt:  [[0.15]]
grads:  [-0.08725944]
Stock Position:  -0.0872594372855294
Bond Position:  [21.42942819]


portfolio before change:  [13.15075036]
curr_Stock_Price:  94.88964713074589
curr_Factors:  [94.88964713]
mat_Sqrt:  [[0.15]]
grads:  [0.01031609]
Stock Position:  0.01031609254367535
Bond Position:  [12.17185997]


portfolio before change:  [13.14694463]
curr_Stock_Price:  94.44698968192847
curr_Factors:  [94.44698968]
mat_Sqrt:  [[0.15]]
grads:  [-0.01931023]
Stock Position:  -0.019310234373510378
Bond Position:  [14.97073813]


portfolio before change:  [13.1426249]
curr_Stock_Price:  94.71914743239353
curr_Factors:  [94.71914743]
mat_Sqrt:  [[0.15]]
grads:  [-0.07128073]
Stock Position:  -0.07128072759837277
Bond Position:  [19.89427464]


portfolio before change:  [13.14448883]
curr_Stock_Price:  94.7104423727346
curr_Factors:  [94.71044237]
mat_Sqrt:  [[0.15]]
grads:  [-0.02862005]
Stock Position:  -0.028620045190748414
Bond Position:  [15.85510597]


portfolio before change:  [13.15188412]
curr_Stock_Price:  94.48667227712545
curr_Factors:  [94.48667228]
mat_Sqrt:  [[0.15]]
grads:  [0.01836948]
Stock Position:  0.018369477742788926
Bond Position:  [11.41621329]


portfolio before change:  [13.16443161]
curr_Stock_Price:  95.1308909024232
curr_Factors:  [95.1308909]
mat_Sqrt:  [[0.15]]
grads:  [0.02554033]
Stock Position:  0.025540327010758753
Bond Position:  [10.73475755]


portfolio before change:  [13.17959372]
curr_Stock_Price:  95.69827458363636
curr_Factors:  [95.69827458]
mat_Sqrt:  [[0.15]]
grads:  [-0.00588453]
Stock Position:  -0.005884528714028498
Bond Position:  [13.74273296]


portfolio before change:  [13.17474609]
curr_Stock_Price:  96.66803404841208
curr_Factors:  [96.66803405]
mat_Sqrt:  [[0.15]]
grads:  [0.03856587]
Stock Position:  0.03856587116233615
Bond Position:  [9.44665914]


portfolio before change:  [13.17323922]
curr_Stock_Price:  96.61365169576305
curr_Factors:  [96.6136517]
mat_Sqrt:  [[0.15]]
grads:  [0.0590239]
Stock Position:  0.05902389951248396
Bond Position:  [7.47072475]


portfolio before change:  [13.18110983]
curr_Stock_Price:  96.73908695665712
curr_Factors:  [96.73908696]
mat_Sqrt:  [[0.15]]
grads:  [0.07509868]
Stock Position:  0.07509867688744959
Bond Position:  [5.9161324]


portfolio before change:  [13.10191948]
curr_Stock_Price:  95.67967912759677
curr_Factors:  [95.67967913]
mat_Sqrt:  [[0.15]]
grads:  [0.06282934]
Stock Position:  0.0628293440743669
Bond Position:  [7.090428]


portfolio before change:  [13.03023628]
curr_Stock_Price:  94.53170658482478
curr_Factors:  [94.53170658]
mat_Sqrt:  [[0.15]]
grads:  [0.08706743]
Stock Position:  0.08706743167362366
Bond Position:  [4.79960338]


portfolio before change:  [13.05612717]
curr_Stock_Price:  94.82562705240893
curr_Factors:  [94.82562705]
mat_Sqrt:  [[0.15]]
grads:  [-0.03902539]
Stock Position:  -0.039025394265349685
Bond Position:  [16.75673465]


portfolio before change:  [13.07797128]
curr_Stock_Price:  94.29272316492127
curr_Factors:  [94.29272316]
mat_Sqrt:  [[0.15]]
grads:  [-0.04994696]
Stock Position:  -0.04994695666295886
Bond Position:  [17.78760584]


portfolio before change:  [13.07913445]
curr_Stock_Price:  94.29169386096778
curr_Factors:  [94.29169386]
mat_Sqrt:  [[0.15]]
grads:  [-0.20606161]
Stock Position:  -0.2060616109549655
Bond Position:  [32.50903279]


portfolio before change:  [13.04440235]
curr_Stock_Price:  94.47010639388483
curr_Factors:  [94.47010639]
mat_Sqrt:  [[0.15]]
grads:  [-0.0861445]
Stock Position:  -0.08614449656331942
Bond Position:  [21.18248211]


portfolio before change:  [13.06498782]
curr_Stock_Price:  94.24651086921621
curr_Factors:  [94.24651087]
mat_Sqrt:  [[0.15]]
grads:  [-0.02377763]
Stock Position:  -0.02377762698277011
Bond Position:  [15.3059462]


portfolio before change:  [13.05769731]
curr_Stock_Price:  94.59335655258211
curr_Factors:  [94.59335655]
mat_Sqrt:  [[0.15]]
grads:  [-0.04158267]
Stock Position:  -0.04158266780675795
Bond Position:  [16.99114143]


portfolio before change:  [13.04624016]
curr_Stock_Price:  94.89442247174361
curr_Factors:  [94.89442247]
mat_Sqrt:  [[0.15]]
grads:  [0.16726458]
Stock Position:  0.16726458154388688
Bond Position:  [-2.8262357]


portfolio before change:  [13.0132297]
curr_Stock_Price:  94.69812375903838
curr_Factors:  [94.69812376]
mat_Sqrt:  [[0.15]]
grads:  [0.05529907]
Stock Position:  0.05529907105823715
Bond Position:  [7.77651142]


portfolio before change:  [13.05502261]
curr_Stock_Price:  95.44509584558163
curr_Factors:  [95.44509585]
mat_Sqrt:  [[0.15]]
grads:  [0.01170267]
Stock Position:  0.011702674342030601
Bond Position:  [11.93805973]


portfolio before change:  [13.05987834]
curr_Stock_Price:  95.79626188850347
curr_Factors:  [95.79626189]
mat_Sqrt:  [[0.15]]
grads:  [0.09181226]
Stock Position:  0.09181225781170357
Bond Position:  [4.26460725]


portfolio before change:  [13.02903977]
curr_Stock_Price:  95.45747148604062
curr_Factors:  [95.45747149]
mat_Sqrt:  [[0.15]]
grads:  [-0.12777531]
Stock Position:  -0.12777530989079414
Bond Position:  [25.22614777]


portfolio before change:  [13.08113274]
curr_Stock_Price:  95.062119003665
curr_Factors:  [95.062119]
mat_Sqrt:  [[0.15]]
grads:  [0.11796038]
Stock Position:  0.11796038105982862
Bond Position:  [1.86756896]


portfolio before change:  [13.02040357]
curr_Stock_Price:  94.54630260806873
curr_Factors:  [94.54630261]
mat_Sqrt:  [[0.15]]
grads:  [-0.1010448]
Stock Position:  -0.10104480381498443
Bond Position:  [22.57381617]


portfolio before change:  [12.97304849]
curr_Stock_Price:  95.0289200481542
curr_Factors:  [95.02892005]
mat_Sqrt:  [[0.15]]
grads:  [-0.02730118]
Stock Position:  -0.027301179180758226
Bond Position:  [15.56745007]


portfolio before change:  [12.97492751]
curr_Stock_Price:  94.99573394076297
curr_Factors:  [94.99573394]
mat_Sqrt:  [[0.15]]
grads:  [0.05178856]
Stock Position:  0.0517885561454167
Bond Position:  [8.05523561]


portfolio before change:  [12.98897671]
curr_Stock_Price:  95.25729228675048
curr_Factors:  [95.25729229]
mat_Sqrt:  [[0.15]]
grads:  [-0.03664924]
Stock Position:  -0.036649244645372135
Bond Position:  [16.48008452]


portfolio before change:  [12.99426585]
curr_Stock_Price:  95.14107955028834
curr_Factors:  [95.14107955]
mat_Sqrt:  [[0.15]]
grads:  [0.02181956]
Stock Position:  0.021819558742492303
Bond Position:  [10.91832948]


portfolio before change:  [12.9870217]
curr_Stock_Price:  94.77780110733296
curr_Factors:  [94.77780111]
mat_Sqrt:  [[0.15]]
grads:  [0.09428891]
Stock Position:  0.09428891325332926
Bond Position:  [4.05052583]


portfolio before change:  [13.03272383]
curr_Stock_Price:  95.25981928394951
curr_Factors:  [95.25981928]
mat_Sqrt:  [[0.15]]
grads:  [-0.08731254]
Stock Position:  -0.08731253747544922
Bond Position:  [21.35010037]


portfolio before change:  [13.06350125]
curr_Stock_Price:  94.9226054657496
curr_Factors:  [94.92260547]
mat_Sqrt:  [[0.15]]
grads:  [-0.32334424]
Stock Position:  -0.3233442432358684
Bond Position:  [43.75617928]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.06350125]
Stock Price:  95.65772122787614
PL:  [13.06350125]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.39022261e-02]
 [-2.36545729e-03]
 [ 1.42452887e-04]
 [ 1.63295143e-03]
 [-2.36693134e-02]
 [ 2.57807780e-04]
 [ 2.18067506e-03]
 [-1.30009735e-02]
 [ 2.91904835e-03]
 [ 3.21082766e-02]
 [ 9.47479068e-03]
 [-1.09427898e-02]
 [ 1.00813732e-02]
 [ 5.17966107e-03]
 [-1.30987114e-02]
 [ 1.55402851e-02]
 [ 2.93571456e-04]
 [ 1.53996153e-02]
 [ 1.81935634e-02]
 [-4.10091360e-04]
 [ 4.37335565e-02]
 [-1.17656402e-02]
 [ 6.58557127e-03]
 [-3.89436609e-03]
 [ 1.73179976e-02]
 [ 1.82697632e-02]
 [ 9.63304171e-03]
 [ 4.55432050e-03]
 [ 4.72797993e-03]
 [-2.74748182e-02]
 [-5.02227228e-03]
 [ 2.31754153e-02]
 [ 7.66210045e-03]
 [-1.37188237e-03]
 [-2.84308112e-03]
 [-3.89466805e-03]
 [-6.25748616e-03]
 [ 3.65944756e-03]
 [ 1.57957239e-03]
 [-8.29283552e-03]
 [-3.30768151e-02]
 [-2.55094611e-03]
 [ 1.10169197e-02]
 [-1.18015934e-02]
 [ 1.10469237e-03]
 [ 2.24108412e-03]
 [-1.36684518e-02]
 [-1.10643481e-03]
 [-1.65189088e-04]
 [-4.21041243e-04]
 [-3.11855990e-03]
 [ 3.76609896e-03]
 [ 4.69963262e-04]
 [-1.98496456e-03]
 [ 2.16108781e-03]
 [ 8.62293976e-03]
 [ 3.80850656e-03]
 [-2.10038631e-02]
 [ 1.34154403e-02]
 [ 7.81632967e-03]
 [ 7.70265006e-03]
 [-1.23607609e-02]
 [-1.25385831e-02]
 [-2.21054389e-03]
 [-1.99682298e-02]
 [ 3.97422571e-02]
 [ 2.11230327e-02]
 [ 2.08291580e-03]
 [ 6.38023361e-03]
 [-1.45354156e-02]
 [-7.82187309e-03]
 [-7.95888713e-03]
 [ 2.94466329e-03]
 [ 7.65351565e-03]
 [ 2.47283413e-04]
 [-1.30130374e-02]
 [ 7.01912508e-03]
 [-3.92652144e-03]
 [ 2.29220255e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.34172951]
curr_Stock_Price:  99.95342190127575
curr_Factors:  [99.9534219]
mat_Sqrt:  [[0.15]]
grads:  [-0.22601484]
Stock Position:  -0.22601484089273827
Bond Position:  [23.93268626]


portfolio before change:  [1.31598887]
curr_Stock_Price:  100.07392939005346
curr_Factors:  [100.07392939]
mat_Sqrt:  [[0.15]]
grads:  [-0.01576972]
Stock Position:  -0.01576971524006528
Bond Position:  [2.89412624]


portfolio before change:  [1.31186473]
curr_Stock_Price:  100.346922886594
curr_Factors:  [100.34692289]
mat_Sqrt:  [[0.15]]
grads:  [0.00094969]
Stock Position:  0.0009496859159073556
Bond Position:  [1.21656667]


portfolio before change:  [1.31128423]
curr_Stock_Price:  99.65560249571826
curr_Factors:  [99.6556025]
mat_Sqrt:  [[0.15]]
grads:  [0.01088634]
Stock Position:  0.010886342834125064
Bond Position:  [0.22639918]


portfolio before change:  [1.29431038]
curr_Stock_Price:  98.09511478448421
curr_Factors:  [98.09511478]
mat_Sqrt:  [[0.15]]
grads:  [-0.15779542]
Stock Position:  -0.15779542274493427
Bond Position:  [16.77327048]


portfolio before change:  [1.37240796]
curr_Stock_Price:  97.60682924204816
curr_Factors:  [97.60682924]
mat_Sqrt:  [[0.15]]
grads:  [0.00171872]
Stock Position:  0.0017187185306217492
Bond Position:  [1.2046493]


portfolio before change:  [1.37239337]
curr_Stock_Price:  97.5545313684281
curr_Factors:  [97.55453137]
mat_Sqrt:  [[0.15]]
grads:  [0.01453783]
Stock Position:  0.014537833724802786
Bond Position:  [-0.04583818]


portfolio before change:  [1.3683339]
curr_Stock_Price:  97.27549379608864
curr_Factors:  [97.2754938]
mat_Sqrt:  [[0.15]]
grads:  [-0.08667316]
Stock Position:  -0.0866731567415364
Bond Position:  [9.79950803]


portfolio before change:  [1.34165768]
curr_Stock_Price:  97.5903399622243
curr_Factors:  [97.59033996]
mat_Sqrt:  [[0.15]]
grads:  [0.01946032]
Stock Position:  0.01946032235756836
Bond Position:  [-0.55748179]


portfolio before change:  [1.33821608]
curr_Stock_Price:  97.41527806245504
curr_Factors:  [97.41527806]
mat_Sqrt:  [[0.15]]
grads:  [0.21405518]
Stock Position:  0.21405517740526137
Bond Position:  [-19.51402855]


portfolio before change:  [1.32523476]
curr_Stock_Price:  97.3603312360983
curr_Factors:  [97.36033124]
mat_Sqrt:  [[0.15]]
grads:  [0.06316527]
Stock Position:  0.06316527116998989
Bond Position:  [-4.82455696]


portfolio before change:  [1.32461203]
curr_Stock_Price:  97.3552463958843
curr_Factors:  [97.3552464]
mat_Sqrt:  [[0.15]]
grads:  [-0.07295193]
Stock Position:  -0.07295193232558585
Bond Position:  [8.42686538]


portfolio before change:  [1.33146527]
curr_Stock_Price:  97.26852431274263
curr_Factors:  [97.26852431]
mat_Sqrt:  [[0.15]]
grads:  [0.06720915]
Stock Position:  0.06720915472360525
Bond Position:  [-5.20587003]


portfolio before change:  [1.37196627]
curr_Stock_Price:  97.8759770195574
curr_Factors:  [97.87597702]
mat_Sqrt:  [[0.15]]
grads:  [0.03453107]
Stock Position:  0.034531073817990365
Bond Position:  [-2.00779631]


portfolio before change:  [1.38469507]
curr_Stock_Price:  98.24822982425292
curr_Factors:  [98.24822982]
mat_Sqrt:  [[0.15]]
grads:  [-0.08732474]
Stock Position:  -0.0873247425493147
Bond Position:  [9.96419645]


portfolio before change:  [1.41292636]
curr_Stock_Price:  97.9320707546669
curr_Factors:  [97.93207075]
mat_Sqrt:  [[0.15]]
grads:  [0.1036019]
Stock Position:  0.1036019009988897
Bond Position:  [-8.73302234]


portfolio before change:  [1.5515471]
curr_Stock_Price:  99.27535269246135
curr_Factors:  [99.27535269]
mat_Sqrt:  [[0.15]]
grads:  [0.00195714]
Stock Position:  0.0019571430394075603
Bond Position:  [1.35725103]


portfolio before change:  [1.55450548]
curr_Stock_Price:  100.74358935714784
curr_Factors:  [100.74358936]
mat_Sqrt:  [[0.15]]
grads:  [0.1026641]
Stock Position:  0.10266410198211012
Bond Position:  [-8.78824466]


portfolio before change:  [1.63528098]
curr_Stock_Price:  101.53573373188975
curr_Factors:  [101.53573373]
mat_Sqrt:  [[0.15]]
grads:  [0.12129042]
Stock Position:  0.12129042263524806
Bond Position:  [-10.68003107]


portfolio before change:  [1.6548658]
curr_Stock_Price:  101.70270769632826
curr_Factors:  [101.7027077]
mat_Sqrt:  [[0.15]]
grads:  [-0.00273394]
Stock Position:  -0.0027339424002084146
Bond Position:  [1.93291515]


portfolio before change:  [1.65272367]
curr_Stock_Price:  102.5304306898683
curr_Factors:  [102.53043069]
mat_Sqrt:  [[0.15]]
grads:  [0.29155704]
Stock Position:  0.29155704355683526
Bond Position:  [-28.24074558]


portfolio before change:  [1.69058379]
curr_Stock_Price:  102.66633966921036
curr_Factors:  [102.66633967]
mat_Sqrt:  [[0.15]]
grads:  [-0.0784376]
Stock Position:  -0.07843760117348515
Bond Position:  [9.74348519]


portfolio before change:  [1.69522405]
curr_Stock_Price:  102.61494492506958
curr_Factors:  [102.61494493]
mat_Sqrt:  [[0.15]]
grads:  [0.04390381]
Stock Position:  0.04390380849418277
Bond Position:  [-2.80996284]


portfolio before change:  [1.68224797]
curr_Stock_Price:  102.32338804460501
curr_Factors:  [102.32338804]
mat_Sqrt:  [[0.15]]
grads:  [-0.02596244]
Stock Position:  -0.025962440578027858
Bond Position:  [4.33881285]


portfolio before change:  [1.68170348]
curr_Stock_Price:  102.35480532990815
curr_Factors:  [102.35480533]
mat_Sqrt:  [[0.15]]
grads:  [0.11545332]
Stock Position:  0.11545331735081571
Bond Position:  [-10.13549834]


portfolio before change:  [1.70867933]
curr_Stock_Price:  102.59394381766697
curr_Factors:  [102.59394382]
mat_Sqrt:  [[0.15]]
grads:  [0.12179842]
Stock Position:  0.12179842164791836
Bond Position:  [-10.7871011]


portfolio before change:  [1.74092964]
curr_Stock_Price:  102.86426363874763
curr_Factors:  [102.86426364]
mat_Sqrt:  [[0.15]]
grads:  [0.06422028]
Stock Position:  0.0642202780479855
Bond Position:  [-4.86504197]


portfolio before change:  [1.71411625]
curr_Stock_Price:  102.45147636628731
curr_Factors:  [102.45147637]
mat_Sqrt:  [[0.15]]
grads:  [0.03036214]
Stock Position:  0.03036213666140484
Bond Position:  [-1.39652948]


portfolio before change:  [1.687314]
curr_Stock_Price:  101.57159888180394
curr_Factors:  [101.57159888]
mat_Sqrt:  [[0.15]]
grads:  [0.03151987]
Stock Position:  0.031519866199116967
Bond Position:  [-1.5142092]


portfolio before change:  [1.65777202]
curr_Stock_Price:  100.63735178117783
curr_Factors:  [100.63735178]
mat_Sqrt:  [[0.15]]
grads:  [-0.18316545]
Stock Position:  -0.18316545493207656
Bond Position:  [20.09105834]


portfolio before change:  [1.62458076]
curr_Stock_Price:  100.82541665081246
curr_Factors:  [100.82541665]
mat_Sqrt:  [[0.15]]
grads:  [-0.03348182]
Stock Position:  -0.03348181516856913
Bond Position:  [5.00039873]


portfolio before change:  [1.59790493]
curr_Stock_Price:  101.63147715941635
curr_Factors:  [101.63147716]
mat_Sqrt:  [[0.15]]
grads:  [0.15450277]
Stock Position:  0.15450276874329358
Bond Position:  [-14.10443968]


portfolio before change:  [1.59570076]
curr_Stock_Price:  101.62291672056949
curr_Factors:  [101.62291672]
mat_Sqrt:  [[0.15]]
grads:  [0.05108067]
Stock Position:  0.051080669634256955
Bond Position:  [-3.59526587]


portfolio before change:  [1.63637976]
curr_Stock_Price:  102.4236835757212
curr_Factors:  [102.42368358]
mat_Sqrt:  [[0.15]]
grads:  [-0.00914588]
Stock Position:  -0.009145882466693445
Bond Position:  [2.57313473]


portfolio before change:  [1.6416599]
curr_Stock_Price:  101.86394309114061
curr_Factors:  [101.86394309]
mat_Sqrt:  [[0.15]]
grads:  [-0.01895387]
Stock Position:  -0.018953874160492677
Bond Position:  [3.57237626]


portfolio before change:  [1.62539691]
curr_Stock_Price:  102.73375334222958
curr_Factors:  [102.73375334]
mat_Sqrt:  [[0.15]]
grads:  [-0.02596445]
Stock Position:  -0.025964453697219104
Bond Position:  [4.29282269]


portfolio before change:  [1.62657902]
curr_Stock_Price:  102.69855898870047
curr_Factors:  [102.69855899]
mat_Sqrt:  [[0.15]]
grads:  [-0.04171657]
Stock Position:  -0.04171657438992118
Bond Position:  [5.9108111]


portfolio before change:  [1.62812335]
curr_Stock_Price:  102.67039545087745
curr_Factors:  [102.67039545]
mat_Sqrt:  [[0.15]]
grads:  [0.02439632]
Stock Position:  0.024396317040872077
Bond Position:  [-0.87665617]


portfolio before change:  [1.61886784]
curr_Stock_Price:  102.29326015582674
curr_Factors:  [102.29326016]
mat_Sqrt:  [[0.15]]
grads:  [0.01053048]
Stock Position:  0.010530482580206273
Bond Position:  [0.54167045]


portfolio before change:  [1.62353069]
curr_Stock_Price:  102.73284069045698
curr_Factors:  [102.73284069]
mat_Sqrt:  [[0.15]]
grads:  [-0.05528557]
Stock Position:  -0.05528557016170658
Bond Position:  [7.30317436]


portfolio before change:  [1.62331156]
curr_Stock_Price:  102.74506074296316
curr_Factors:  [102.74506074]
mat_Sqrt:  [[0.15]]
grads:  [-0.2205121]
Stock Position:  -0.22051210054622433
Bond Position:  [24.27984073]


portfolio before change:  [1.60277316]
curr_Stock_Price:  102.84508221199138
curr_Factors:  [102.84508221]
mat_Sqrt:  [[0.15]]
grads:  [-0.01700631]
Stock Position:  -0.01700630742092826
Bond Position:  [3.35178824]


portfolio before change:  [1.61649747]
curr_Stock_Price:  102.05038740458818
curr_Factors:  [102.0503874]
mat_Sqrt:  [[0.15]]
grads:  [0.07344613]
Stock Position:  0.07344613107811228
Bond Position:  [-5.87870866]


portfolio before change:  [1.62092331]
curr_Stock_Price:  102.11564983046205
curr_Factors:  [102.11564983]
mat_Sqrt:  [[0.15]]
grads:  [-0.07867729]
Stock Position:  -0.0786772892830253
Bond Position:  [9.65510584]


portfolio before change:  [1.67640361]
curr_Stock_Price:  101.4181572012026
curr_Factors:  [101.4181572]
mat_Sqrt:  [[0.15]]
grads:  [0.00736462]
Stock Position:  0.007364615771520417
Bond Position:  [0.92949785]


portfolio before change:  [1.68157269]
curr_Stock_Price:  102.11214996744853
curr_Factors:  [102.11214997]
mat_Sqrt:  [[0.15]]
grads:  [0.01494056]
Stock Position:  0.014940560807245394
Bond Position:  [0.15595991]


portfolio before change:  [1.67931892]
curr_Stock_Price:  101.96064857031433
curr_Factors:  [101.96064857]
mat_Sqrt:  [[0.15]]
grads:  [-0.09112301]
Stock Position:  -0.09112301197185714
Bond Position:  [10.97028033]


portfolio before change:  [1.65826756]
curr_Stock_Price:  102.1991945932225
curr_Factors:  [102.19919459]
mat_Sqrt:  [[0.15]]
grads:  [-0.00737623]
Stock Position:  -0.007376232083160737
Bond Position:  [2.41211253]


portfolio before change:  [1.66071418]
curr_Stock_Price:  101.88794366711596
curr_Factors:  [101.88794367]
mat_Sqrt:  [[0.15]]
grads:  [-0.00110126]
Stock Position:  -0.0011012605887169055
Bond Position:  [1.77291935]


portfolio before change:  [1.66110586]
curr_Stock_Price:  101.63289414309472
curr_Factors:  [101.63289414]
mat_Sqrt:  [[0.15]]
grads:  [-0.00280694]
Stock Position:  -0.002806941618015135
Bond Position:  [1.94638346]


portfolio before change:  [1.66073523]
curr_Stock_Price:  101.80827563709919
curr_Factors:  [101.80827564]
mat_Sqrt:  [[0.15]]
grads:  [-0.0207904]
Stock Position:  -0.020790399366361775
Bond Position:  [3.77736994]


portfolio before change:  [1.67174991]
curr_Stock_Price:  101.28983528982899
curr_Factors:  [101.28983529]
mat_Sqrt:  [[0.15]]
grads:  [0.02510733]
Stock Position:  0.0251073264134553
Bond Position:  [-0.87136705]


portfolio before change:  [1.65623195]
curr_Stock_Price:  100.67393944150052
curr_Factors:  [100.67393944]
mat_Sqrt:  [[0.15]]
grads:  [0.00313309]
Stock Position:  0.0031330884143055196
Bond Position:  [1.34081159]


portfolio before change:  [1.65520773]
curr_Stock_Price:  100.32028881848879
curr_Factors:  [100.32028882]
mat_Sqrt:  [[0.15]]
grads:  [-0.0132331]
Stock Position:  -0.013233097064062142
Bond Position:  [2.98275585]


portfolio before change:  [1.66392185]
curr_Stock_Price:  99.6758673009816
curr_Factors:  [99.6758673]
mat_Sqrt:  [[0.15]]
grads:  [0.01440725]
Stock Position:  0.014407252056692752
Bond Position:  [0.22786651]


portfolio before change:  [1.67512495]
curr_Stock_Price:  100.45248010533476
curr_Factors:  [100.45248011]
mat_Sqrt:  [[0.15]]
grads:  [0.05748627]
Stock Position:  0.05748626505167764
Bond Position:  [-4.09951295]


portfolio before change:  [1.67190597]
curr_Stock_Price:  100.40094170638393
curr_Factors:  [100.40094171]
mat_Sqrt:  [[0.15]]
grads:  [0.02539004]
Stock Position:  0.02539004370822128
Bond Position:  [-0.87727833]


portfolio before change:  [1.67392802]
curr_Stock_Price:  100.48274077361282
curr_Factors:  [100.48274077]
mat_Sqrt:  [[0.15]]
grads:  [-0.14002575]
Stock Position:  -0.14002575425971794
Bond Position:  [15.74409959]


portfolio before change:  [1.57073449]
curr_Stock_Price:  101.22672942909941
curr_Factors:  [101.22672943]
mat_Sqrt:  [[0.15]]
grads:  [0.08943627]
Stock Position:  0.08943626870556627
Bond Position:  [-7.48260649]


portfolio before change:  [1.52647674]
curr_Stock_Price:  100.73710627718972
curr_Factors:  [100.73710628]
mat_Sqrt:  [[0.15]]
grads:  [0.05210886]
Stock Position:  0.05210886443388331
Bond Position:  [-3.72281947]


portfolio before change:  [1.50635878]
curr_Stock_Price:  100.35549594343698
curr_Factors:  [100.35549594]
mat_Sqrt:  [[0.15]]
grads:  [0.051351]
Stock Position:  0.051351000410890295
Bond Position:  [-3.64699634]


portfolio before change:  [1.48845704]
curr_Stock_Price:  100.01131973424278
curr_Factors:  [100.01131973]
mat_Sqrt:  [[0.15]]
grads:  [-0.08240507]
Stock Position:  -0.08240507257946365
Bond Position:  [9.7298971]


portfolio before change:  [1.51161469]
curr_Stock_Price:  99.73767744987896
curr_Factors:  [99.73767745]
mat_Sqrt:  [[0.15]]
grads:  [-0.08359055]
Stock Position:  -0.08359055430956017
Bond Position:  [9.84874243]


portfolio before change:  [1.45872327]
curr_Stock_Price:  100.37778552214539
curr_Factors:  [100.37778552]
mat_Sqrt:  [[0.15]]
grads:  [-0.01473696]
Stock Position:  -0.014736959240050279
Bond Position:  [2.9379866]


portfolio before change:  [1.45589348]
curr_Stock_Price:  100.58226575712787
curr_Factors:  [100.58226576]
mat_Sqrt:  [[0.15]]
grads:  [-0.13312153]
Stock Position:  -0.1331215321845299
Bond Position:  [14.84555881]


portfolio before change:  [1.47551737]
curr_Stock_Price:  100.44182256267422
curr_Factors:  [100.44182256]
mat_Sqrt:  [[0.15]]
grads:  [0.26494838]
Stock Position:  0.26494838091854095
Bond Position:  [-25.1363809]


portfolio before change:  [1.59104266]
curr_Stock_Price:  100.8837817073666
curr_Factors:  [100.88378171]
mat_Sqrt:  [[0.15]]
grads:  [0.14082022]
Stock Position:  0.1408202179185769
Bond Position:  [-12.61543347]


portfolio before change:  [1.58928637]
curr_Stock_Price:  100.87690914344321
curr_Factors:  [100.87690914]
mat_Sqrt:  [[0.15]]
grads:  [0.01388611]
Stock Position:  0.013886105329857212
Bond Position:  [0.18849899]


portfolio before change:  [1.60149983]
curr_Stock_Price:  101.75560599296611
curr_Factors:  [101.75560599]
mat_Sqrt:  [[0.15]]
grads:  [0.04253489]
Stock Position:  0.04253489076003223
Bond Position:  [-2.72666376]


portfolio before change:  [1.6258578]
curr_Stock_Price:  102.33227116849989
curr_Factors:  [102.33227117]
mat_Sqrt:  [[0.15]]
grads:  [-0.09690277]
Stock Position:  -0.09690277087337575
Bond Position:  [11.54213842]


portfolio before change:  [1.61019006]
curr_Stock_Price:  102.50140098196327
curr_Factors:  [102.50140098]
mat_Sqrt:  [[0.15]]
grads:  [-0.05214582]
Stock Position:  -0.05214582060907522
Bond Position:  [6.95520972]


portfolio before change:  [1.61151057]
curr_Stock_Price:  102.48441407514746
curr_Factors:  [102.48441408]
mat_Sqrt:  [[0.15]]
grads:  [-0.05305925]
Stock Position:  -0.053059247508563355
Bond Position:  [7.04925646]


portfolio before change:  [1.59255932]
curr_Stock_Price:  102.84988921690301
curr_Factors:  [102.84988922]
mat_Sqrt:  [[0.15]]
grads:  [0.01963109]
Stock Position:  0.01963108859209341
Bond Position:  [-0.42649596]


portfolio before change:  [1.59042057]
curr_Stock_Price:  102.7423000342122
curr_Factors:  [102.74230003]
mat_Sqrt:  [[0.15]]
grads:  [0.05102344]
Stock Position:  0.05102343767823496
Bond Position:  [-3.65184477]


portfolio before change:  [1.57884076]
curr_Stock_Price:  102.51982259044573
curr_Factors:  [102.51982259]
mat_Sqrt:  [[0.15]]
grads:  [0.00164856]
Stock Position:  0.001648556085739088
Bond Position:  [1.40983108]


portfolio before change:  [1.57918667]
curr_Stock_Price:  102.67619632283264
curr_Factors:  [102.67619632]
mat_Sqrt:  [[0.15]]
grads:  [-0.08675358]
Stock Position:  -0.08675358248122599
Bond Position:  [10.48671454]


portfolio before change:  [1.5224272]
curr_Stock_Price:  103.33801234583768
curr_Factors:  [103.33801235]
mat_Sqrt:  [[0.15]]
grads:  [0.04679417]
Stock Position:  0.04679416720689694
Bond Position:  [-3.31318903]


portfolio before change:  [1.53953042]
curr_Stock_Price:  103.70793666653385
curr_Factors:  [103.70793667]
mat_Sqrt:  [[0.15]]
grads:  [-0.02617681]
Stock Position:  -0.02617680957847884
Bond Position:  [4.25427333]


portfolio before change:  [1.49709911]
curr_Stock_Price:  105.33904503811867
curr_Factors:  [105.33904504]
mat_Sqrt:  [[0.15]]
grads:  [0.1528135]
Stock Position:  0.15281350351304243
Bond Position:  [-14.60012942]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.49709911]
Stock Price:  104.83542882274614
PL:  [-3.33832972]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.46140764e-02]
 [ 5.19404922e-04]
 [-7.11009290e-04]
 [ 2.15520100e-03]
 [ 1.76682755e-02]
 [ 8.87146474e-03]
 [ 5.00554255e-04]
 [ 1.02635879e-02]
 [ 1.73843492e-02]
 [-1.95086329e-02]
 [ 9.05672893e-03]
 [-5.03509707e-03]
 [-5.26598840e-04]
 [ 4.26465390e-03]
 [ 5.12670158e-03]
 [ 1.95038357e-05]
 [ 1.44740760e-02]
 [ 1.64399055e-02]
 [ 1.78336681e-02]
 [ 1.90597154e-04]
 [ 6.93816489e-02]
 [-1.31274838e-02]
 [ 2.33337219e-03]
 [ 7.30910860e-03]
 [ 1.36051541e-02]
 [ 1.19308766e-04]
 [ 1.28164216e-02]
 [ 1.49187097e-03]
 [ 4.15776863e-03]
 [-2.79782055e-02]
 [-4.72830836e-03]
 [-5.44941238e-03]
 [ 1.16975529e-02]
 [ 1.97807662e-02]
 [ 2.74584120e-04]
 [ 2.49553490e-03]
 [-4.36235159e-03]
 [ 1.42159657e-02]
 [ 7.08984555e-04]
 [-9.04710133e-03]
 [-3.08408655e-02]
 [-2.56342979e-03]
 [ 6.32587959e-03]
 [-1.06299904e-02]
 [ 2.14707193e-03]
 [-3.34508137e-03]
 [-1.37118119e-02]
 [-4.09712298e-03]
 [-9.68197630e-03]
 [ 9.08567871e-03]
 [-2.98845330e-03]
 [ 3.71877367e-03]
 [ 8.22860453e-04]
 [ 2.03112051e-03]
 [ 1.50277335e-03]
 [ 8.53345420e-03]
 [-9.52342003e-03]
 [-1.37185748e-02]
 [ 1.39072130e-02]
 [ 3.13380491e-03]
 [ 1.04972626e-02]
 [-1.40895538e-02]
 [-1.26182464e-02]
 [-2.66166841e-03]
 [-1.67710577e-02]
 [ 8.86194557e-04]
 [ 2.79701218e-02]
 [ 1.98362309e-03]
 [ 7.06396886e-03]
 [-1.51916967e-02]
 [-7.73885759e-03]
 [-7.97298883e-03]
 [ 2.76488543e-03]
 [ 7.94552287e-03]
 [ 4.25135117e-03]
 [-1.24161685e-02]
 [ 5.38403546e-03]
 [-4.00063773e-03]
 [ 2.07385487e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.43190465]
curr_Stock_Price:  100.02348817620839
curr_Factors:  [100.02348818]
mat_Sqrt:  [[0.15]]
grads:  [-0.23076051]
Stock Position:  -0.2307605096653658
Bond Position:  [25.51337576]


portfolio before change:  [2.52078679]
curr_Stock_Price:  99.64522801839534
curr_Factors:  [99.64522802]
mat_Sqrt:  [[0.15]]
grads:  [0.0034627]
Stock Position:  0.0034626994789429292
Bond Position:  [2.17574531]


portfolio before change:  [2.51917798]
curr_Stock_Price:  99.14134468848893
curr_Factors:  [99.14134469]
mat_Sqrt:  [[0.15]]
grads:  [-0.00474006]
Stock Position:  -0.004740061930293792
Bond Position:  [2.9891141]


portfolio before change:  [2.51562788]
curr_Stock_Price:  99.9297158202576
curr_Factors:  [99.92971582]
mat_Sqrt:  [[0.15]]
grads:  [0.01436801]
Stock Position:  0.014368006663506957
Bond Position:  [1.07983706]


portfolio before change:  [2.51381854]
curr_Stock_Price:  99.79909025389078
curr_Factors:  [99.79909025]
mat_Sqrt:  [[0.15]]
grads:  [0.1177885]
Stock Position:  0.11778850316936029
Bond Position:  [-9.24136692]


portfolio before change:  [2.43399368]
curr_Stock_Price:  99.12629746187524
curr_Factors:  [99.12629746]
mat_Sqrt:  [[0.15]]
grads:  [0.0591431]
Stock Position:  0.05914309825806676
Bond Position:  [-3.42864267]


portfolio before change:  [2.44386606]
curr_Stock_Price:  99.29684445673035
curr_Factors:  [99.29684446]
mat_Sqrt:  [[0.15]]
grads:  [0.00333703]
Stock Position:  0.0033370283680529836
Bond Position:  [2.11250968]


portfolio before change:  [2.44688058]
curr_Stock_Price:  100.1606316698756
curr_Factors:  [100.16063167]
mat_Sqrt:  [[0.15]]
grads:  [0.06842392]
Stock Position:  0.06842391910224936
Bond Position:  [-4.40650238]


portfolio before change:  [2.4030811]
curr_Stock_Price:  99.52453737901459
curr_Factors:  [99.52453738]
mat_Sqrt:  [[0.15]]
grads:  [0.11589566]
Stock Position:  0.11589566125821035
Bond Position:  [-9.13138097]


portfolio before change:  [2.37987477]
curr_Stock_Price:  99.32922716063652
curr_Factors:  [99.32922716]
mat_Sqrt:  [[0.15]]
grads:  [-0.13005755]
Stock Position:  -0.13005755249038434
Bond Position:  [15.29839094]


portfolio before change:  [2.29441537]
curr_Stock_Price:  99.99366823047245
curr_Factors:  [99.99366823]
mat_Sqrt:  [[0.15]]
grads:  [0.06037819]
Stock Position:  0.06037819285501884
Bond Position:  [-3.74302162]


portfolio before change:  [2.30302284]
curr_Stock_Price:  100.14010214699891
curr_Factors:  [100.14010215]
mat_Sqrt:  [[0.15]]
grads:  [-0.03356731]
Stock Position:  -0.03356731378536369
Bond Position:  [5.66445707]


portfolio before change:  [2.28663643]
curr_Stock_Price:  100.63881472796024
curr_Factors:  [100.63881473]
mat_Sqrt:  [[0.15]]
grads:  [-0.00351066]
Stock Position:  -0.0035106589347540587
Bond Position:  [2.63994499]


portfolio before change:  [2.28749858]
curr_Stock_Price:  100.44023635294056
curr_Factors:  [100.44023635]
mat_Sqrt:  [[0.15]]
grads:  [0.02843103]
Stock Position:  0.02843102602075765
Bond Position:  [-0.5681204]


portfolio before change:  [2.29687017]
curr_Stock_Price:  100.77111084122998
curr_Factors:  [100.77111084]
mat_Sqrt:  [[0.15]]
grads:  [0.03417801]
Stock Position:  0.034178010516703675
Bond Position:  [-1.14728592]


portfolio before change:  [2.27216951]
curr_Stock_Price:  100.05050269108209
curr_Factors:  [100.05050269]
mat_Sqrt:  [[0.15]]
grads:  [0.00013003]
Stock Position:  0.00013002557145633253
Bond Position:  [2.25916038]


portfolio before change:  [2.27239105]
curr_Stock_Price:  100.66838856241898
curr_Factors:  [100.66838856]
mat_Sqrt:  [[0.15]]
grads:  [0.09649384]
Stock Position:  0.09649383989346175
Bond Position:  [-7.44148832]


portfolio before change:  [2.28709128]
curr_Stock_Price:  100.82555229140033
curr_Factors:  [100.82555229]
mat_Sqrt:  [[0.15]]
grads:  [0.10959937]
Stock Position:  0.10959936974259059
Bond Position:  [-8.76332571]


portfolio before change:  [2.43868345]
curr_Stock_Price:  102.21369804097611
curr_Factors:  [102.21369804]
mat_Sqrt:  [[0.15]]
grads:  [0.11889112]
Stock Position:  0.11889112055132203
Bond Position:  [-9.71361765]


portfolio before change:  [2.33183258]
curr_Stock_Price:  101.3200757591966
curr_Factors:  [101.32007576]
mat_Sqrt:  [[0.15]]
grads:  [0.00127065]
Stock Position:  0.001270647696466736
Bond Position:  [2.20309045]


portfolio before change:  [2.33183308]
curr_Stock_Price:  101.21210410247689
curr_Factors:  [101.2121041]
mat_Sqrt:  [[0.15]]
grads:  [0.46254433]
Stock Position:  0.4625443262717564
Bond Position:  [-44.48325142]


portfolio before change:  [2.27746877]
curr_Stock_Price:  101.10058178684727
curr_Factors:  [101.10058179]
mat_Sqrt:  [[0.15]]
grads:  [-0.08751656]
Stock Position:  -0.08751655864936643
Bond Position:  [11.12544377]


portfolio before change:  [2.30485709]
curr_Stock_Price:  100.79557715537834
curr_Factors:  [100.79557716]
mat_Sqrt:  [[0.15]]
grads:  [0.01555581]
Stock Position:  0.015555814629364638
Bond Position:  [0.73689978]


portfolio before change:  [2.30068088]
curr_Stock_Price:  100.52415026255385
curr_Factors:  [100.52415026]
mat_Sqrt:  [[0.15]]
grads:  [0.04872739]
Stock Position:  0.04872739069300907
Bond Position:  [-2.59759866]


portfolio before change:  [2.28585215]
curr_Stock_Price:  100.22316187905206
curr_Factors:  [100.22316188]
mat_Sqrt:  [[0.15]]
grads:  [0.09070103]
Stock Position:  0.0907010271309403
Bond Position:  [-6.80449158]


portfolio before change:  [2.34466649]
curr_Stock_Price:  100.87629269995328
curr_Factors:  [100.8762927]
mat_Sqrt:  [[0.15]]
grads:  [0.00079539]
Stock Position:  0.0007953917740808013
Bond Position:  [2.26443032]


portfolio before change:  [2.34472308]
curr_Stock_Price:  100.76949461566257
curr_Factors:  [100.76949462]
mat_Sqrt:  [[0.15]]
grads:  [0.08544281]
Stock Position:  0.08544281071655842
Bond Position:  [-6.26530578]


portfolio before change:  [2.32282331]
curr_Stock_Price:  100.51776870570733
curr_Factors:  [100.51776871]
mat_Sqrt:  [[0.15]]
grads:  [0.00994581]
Stock Position:  0.009945806442782553
Bond Position:  [1.32309304]


portfolio before change:  [2.32905672]
curr_Stock_Price:  101.13619130498914
curr_Factors:  [101.1361913]
mat_Sqrt:  [[0.15]]
grads:  [0.02771846]
Stock Position:  0.027718457545733065
Bond Position:  [-0.4742825]


portfolio before change:  [2.32312436]
curr_Stock_Price:  100.92323884437981
curr_Factors:  [100.92323884]
mat_Sqrt:  [[0.15]]
grads:  [-0.18652137]
Stock Position:  -0.18652136974032518
Bond Position:  [21.14746511]


portfolio before change:  [2.43815534]
curr_Stock_Price:  100.31360776893769
curr_Factors:  [100.31360777]
mat_Sqrt:  [[0.15]]
grads:  [-0.03152206]
Stock Position:  -0.031522055707945085
Bond Position:  [5.60024648]


portfolio before change:  [2.46104156]
curr_Stock_Price:  99.59867377249641
curr_Factors:  [99.59867377]
mat_Sqrt:  [[0.15]]
grads:  [-0.03632942]
Stock Position:  -0.03632941585151979
Bond Position:  [6.0794032]


portfolio before change:  [2.42435835]
curr_Stock_Price:  100.61887134999614
curr_Factors:  [100.61887135]
mat_Sqrt:  [[0.15]]
grads:  [0.07798369]
Stock Position:  0.07798368595991596
Bond Position:  [-5.42227211]


portfolio before change:  [2.3026843]
curr_Stock_Price:  99.06296702870104
curr_Factors:  [99.06296703]
mat_Sqrt:  [[0.15]]
grads:  [0.13187177]
Stock Position:  0.1318717749906757
Bond Position:  [-10.760925]


portfolio before change:  [2.42909883]
curr_Stock_Price:  100.02668437566255
curr_Factors:  [100.02668438]
mat_Sqrt:  [[0.15]]
grads:  [0.00183056]
Stock Position:  0.0018305607992996516
Bond Position:  [2.24599391]


portfolio before change:  [2.42858628]
curr_Stock_Price:  99.66999995116761
curr_Factors:  [99.66999995]
mat_Sqrt:  [[0.15]]
grads:  [0.0166369]
Stock Position:  0.016636899305285873
Bond Position:  [0.77038653]


portfolio before change:  [2.4373521]
curr_Stock_Price:  100.19399606097052
curr_Factors:  [100.19399606]
mat_Sqrt:  [[0.15]]
grads:  [-0.02908234]
Stock Position:  -0.02908234391563007
Bond Position:  [5.35122835]


portfolio before change:  [2.42538817]
curr_Stock_Price:  100.61687783316658
curr_Factors:  [100.61687783]
mat_Sqrt:  [[0.15]]
grads:  [0.0947731]
Stock Position:  0.09477310471435167
Bond Position:  [-7.11038573]


portfolio before change:  [2.52715704]
curr_Stock_Price:  101.69538303019341
curr_Factors:  [101.69538303]
mat_Sqrt:  [[0.15]]
grads:  [0.00472656]
Stock Position:  0.004726563697838432
Bond Position:  [2.04648734]


portfolio before change:  [2.52666776]
curr_Stock_Price:  101.5648032143356
curr_Factors:  [101.56480321]
mat_Sqrt:  [[0.15]]
grads:  [-0.06031401]
Stock Position:  -0.06031400883580593
Bond Position:  [8.6524482]


portfolio before change:  [2.46807046]
curr_Stock_Price:  102.54530664204479
curr_Factors:  [102.54530664]
mat_Sqrt:  [[0.15]]
grads:  [-0.20560577]
Stock Position:  -0.2056057701969825
Bond Position:  [23.55197721]


portfolio before change:  [2.66776182]
curr_Stock_Price:  101.58123200379467
curr_Factors:  [101.581232]
mat_Sqrt:  [[0.15]]
grads:  [-0.01708953]
Stock Position:  -0.017089531964254546
Bond Position:  [4.40373753]


portfolio before change:  [2.690833]
curr_Stock_Price:  100.24731952990243
curr_Factors:  [100.24731953]
mat_Sqrt:  [[0.15]]
grads:  [0.04217253]
Stock Position:  0.04217253060906949
Bond Position:  [-1.53685015]


portfolio before change:  [2.66858653]
curr_Stock_Price:  99.7220863390497
curr_Factors:  [99.72208634]
mat_Sqrt:  [[0.15]]
grads:  [-0.0708666]
Stock Position:  -0.07086660284426208
Bond Position:  [9.73555202]


portfolio before change:  [2.73373647]
curr_Stock_Price:  98.81134065461782
curr_Factors:  [98.81134065]
mat_Sqrt:  [[0.15]]
grads:  [0.01431381]
Stock Position:  0.014313812856175919
Bond Position:  [1.31936943]


portfolio before change:  [2.7339526]
curr_Stock_Price:  98.82067895451642
curr_Factors:  [98.82067895]
mat_Sqrt:  [[0.15]]
grads:  [-0.02230054]
Stock Position:  -0.022300542474244615
Bond Position:  [4.93770735]


portfolio before change:  [2.73722769]
curr_Stock_Price:  98.68765674995979
curr_Factors:  [98.68765675]
mat_Sqrt:  [[0.15]]
grads:  [-0.09141208]
Stock Position:  -0.09141207915944898
Bond Position:  [11.75847158]


portfolio before change:  [2.65511102]
curr_Stock_Price:  99.5940096000809
curr_Factors:  [99.5940096]
mat_Sqrt:  [[0.15]]
grads:  [-0.02731415]
Stock Position:  -0.02731415323005682
Bond Position:  [5.37543705]


portfolio before change:  [2.66454946]
curr_Stock_Price:  99.26075841734627
curr_Factors:  [99.26075842]
mat_Sqrt:  [[0.15]]
grads:  [-0.06454651]
Stock Position:  -0.06454650869723083
Bond Position:  [9.07148487]


portfolio before change:  [2.60944199]
curr_Stock_Price:  100.12330645494744
curr_Factors:  [100.12330645]
mat_Sqrt:  [[0.15]]
grads:  [0.06057119]
Stock Position:  0.06057119138845414
Bond Position:  [-3.45514597]


portfolio before change:  [2.675676]
curr_Stock_Price:  101.22036207065949
curr_Factors:  [101.22036207]
mat_Sqrt:  [[0.15]]
grads:  [-0.01992302]
Stock Position:  -0.01992302201150995
Bond Position:  [4.6922915]


portfolio before change:  [2.66575223]
curr_Stock_Price:  101.73318807457807
curr_Factors:  [101.73318807]
mat_Sqrt:  [[0.15]]
grads:  [0.02479182]
Stock Position:  0.024791824442577843
Bond Position:  [0.14360089]


portfolio before change:  [2.67985996]
curr_Stock_Price:  102.30187357953042
curr_Factors:  [102.30187358]
mat_Sqrt:  [[0.15]]
grads:  [0.00548574]
Stock Position:  0.005485736354192665
Bond Position:  [2.11865885]


portfolio before change:  [2.67736251]
curr_Stock_Price:  101.8224720704587
curr_Factors:  [101.82247207]
mat_Sqrt:  [[0.15]]
grads:  [0.0135408]
Stock Position:  0.013540803423079624
Bond Position:  [1.29860443]


portfolio before change:  [2.67182604]
curr_Stock_Price:  101.40760520830119
curr_Factors:  [101.40760521]
mat_Sqrt:  [[0.15]]
grads:  [0.01001849]
Stock Position:  0.01001848901954773
Bond Position:  [1.65587506]


portfolio before change:  [2.66936476]
curr_Stock_Price:  101.15160035395039
curr_Factors:  [101.15160035]
mat_Sqrt:  [[0.15]]
grads:  [0.05688969]
Stock Position:  0.05688969466083521
Bond Position:  [-3.0851189]


portfolio before change:  [2.71036375]
curr_Stock_Price:  101.87566498687796
curr_Factors:  [101.87566499]
mat_Sqrt:  [[0.15]]
grads:  [-0.06348947]
Stock Position:  -0.0634894668581334
Bond Position:  [9.1783954]


portfolio before change:  [2.69088874]
curr_Stock_Price:  102.19144452582432
curr_Factors:  [102.19144453]
mat_Sqrt:  [[0.15]]
grads:  [-0.09145717]
Stock Position:  -0.09145716531221719
Bond Position:  [12.03702857]


portfolio before change:  [2.67269538]
curr_Stock_Price:  102.3985983089712
curr_Factors:  [102.39859831]
mat_Sqrt:  [[0.15]]
grads:  [0.09271475]
Stock Position:  0.09271475317503028
Bond Position:  [-6.82116539]


portfolio before change:  [2.68078085]
curr_Stock_Price:  102.49040467967876
curr_Factors:  [102.49040468]
mat_Sqrt:  [[0.15]]
grads:  [0.02089203]
Stock Position:  0.020892032752888843
Bond Position:  [0.53954796]


portfolio before change:  [2.67049219]
curr_Stock_Price:  101.9963225227138
curr_Factors:  [101.99632252]
mat_Sqrt:  [[0.15]]
grads:  [0.06998175]
Stock Position:  0.06998175093822728
Bond Position:  [-4.46738905]


portfolio before change:  [2.67911648]
curr_Stock_Price:  102.12354867395553
curr_Factors:  [102.12354867]
mat_Sqrt:  [[0.15]]
grads:  [-0.09393036]
Stock Position:  -0.09393035891590613
Bond Position:  [12.27161806]


portfolio before change:  [2.73568507]
curr_Stock_Price:  101.52947458409342
curr_Factors:  [101.52947458]
mat_Sqrt:  [[0.15]]
grads:  [-0.08412164]
Stock Position:  -0.08412164250794517
Bond Position:  [11.27651124]


portfolio before change:  [2.73397276]
curr_Stock_Price:  101.55820818026771
curr_Factors:  [101.55820818]
mat_Sqrt:  [[0.15]]
grads:  [-0.01774446]
Stock Position:  -0.01774445605139764
Bond Position:  [4.53606792]


portfolio before change:  [2.72580469]
curr_Stock_Price:  102.03450255668459
curr_Factors:  [102.03450256]
mat_Sqrt:  [[0.15]]
grads:  [-0.11180705]
Stock Position:  -0.11180705124345094
Bond Position:  [14.13398154]


portfolio before change:  [2.72735211]
curr_Stock_Price:  102.02856356495917
curr_Factors:  [102.02856356]
mat_Sqrt:  [[0.15]]
grads:  [0.00590796]
Stock Position:  0.005907963712687622
Bond Position:  [2.12457106]


portfolio before change:  [2.72711501]
curr_Stock_Price:  101.96595515409986
curr_Factors:  [101.96595515]
mat_Sqrt:  [[0.15]]
grads:  [0.18646748]
Stock Position:  0.18646747874388384
Bond Position:  [-16.28621956]


portfolio before change:  [2.73822315]
curr_Stock_Price:  102.03098560687033
curr_Factors:  [102.03098561]
mat_Sqrt:  [[0.15]]
grads:  [0.01322415]
Stock Position:  0.013224153954984243
Bond Position:  [1.38894969]


portfolio before change:  [2.7423292]
curr_Stock_Price:  102.33491691515336
curr_Factors:  [102.33491692]
mat_Sqrt:  [[0.15]]
grads:  [0.04709313]
Stock Position:  0.047093125723952176
Bond Position:  [-2.07694191]


portfolio before change:  [2.75046246]
curr_Stock_Price:  102.5103793029036
curr_Factors:  [102.5103793]
mat_Sqrt:  [[0.15]]
grads:  [-0.10127798]
Stock Position:  -0.10127797788172074
Bond Position:  [13.13250639]


portfolio before change:  [2.68709876]
curr_Stock_Price:  103.1441252444509
curr_Factors:  [103.14412524]
mat_Sqrt:  [[0.15]]
grads:  [-0.05159238]
Stock Position:  -0.05159238396287457
Bond Position:  [8.00855007]


portfolio before change:  [2.7230777]
curr_Stock_Price:  102.45645798839571
curr_Factors:  [102.45645799]
mat_Sqrt:  [[0.15]]
grads:  [-0.05315326]
Stock Position:  -0.05315325883979309
Bond Position:  [8.16897233]


portfolio before change:  [2.70639964]
curr_Stock_Price:  102.77983687795802
curr_Factors:  [102.77983688]
mat_Sqrt:  [[0.15]]
grads:  [0.01843257]
Stock Position:  0.018432569527148113
Bond Position:  [0.81190315]


portfolio before change:  [2.69802434]
curr_Stock_Price:  102.32270877302935
curr_Factors:  [102.32270877]
mat_Sqrt:  [[0.15]]
grads:  [0.05297015]
Stock Position:  0.052970152462452895
Bond Position:  [-2.72202515]


portfolio before change:  [2.66254359]
curr_Stock_Price:  101.65609529728503
curr_Factors:  [101.6560953]
mat_Sqrt:  [[0.15]]
grads:  [0.02834234]
Stock Position:  0.02834234110908212
Bond Position:  [-0.21862814]


portfolio before change:  [2.676546]
curr_Stock_Price:  102.15062302448673
curr_Factors:  [102.15062302]
mat_Sqrt:  [[0.15]]
grads:  [-0.08277446]
Stock Position:  -0.08277445696926132
Bond Position:  [11.13200835]


portfolio before change:  [2.65496526]
curr_Stock_Price:  102.41974600373555
curr_Factors:  [102.419746]
mat_Sqrt:  [[0.15]]
grads:  [0.03589357]
Stock Position:  0.035893569752240416
Bond Position:  [-1.02124504]


portfolio before change:  [2.67070564]
curr_Stock_Price:  102.86005341440358
curr_Factors:  [102.86005341]
mat_Sqrt:  [[0.15]]
grads:  [-0.02667092]
Stock Position:  -0.026670918184228867
Bond Position:  [5.41407771]


portfolio before change:  [2.67305521]
curr_Stock_Price:  102.7846459639046
curr_Factors:  [102.78464596]
mat_Sqrt:  [[0.15]]
grads:  [0.13825699]
Stock Position:  0.13825699163859045
Bond Position:  [-11.53764072]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.67305521]
Stock Price:  102.74908949218567
PL:  [-0.07603428]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.96873180e-02]
 [ 4.23331295e-03]
 [-1.07526498e-03]
 [-1.52319578e-03]
 [-1.87011207e-02]
 [ 2.50625036e-03]
 [ 1.22784199e-03]
 [-4.02386421e-03]
 [ 7.46799998e-03]
 [-1.83280764e-02]
 [ 6.90409011e-03]
 [-4.98791778e-03]
 [-7.16060367e-03]
 [ 4.26667876e-03]
 [ 6.31764695e-03]
 [-1.01685926e-02]
 [ 1.40660792e-02]
 [ 2.06406052e-02]
 [ 1.81714039e-02]
 [-1.04333858e-03]
 [ 4.45990232e-02]
 [-1.13316980e-02]
 [ 8.34308289e-04]
 [-9.04737765e-04]
 [ 1.75480477e-02]
 [ 1.75458794e-02]
 [ 1.01622987e-02]
 [ 5.53641716e-03]
 [ 5.85683243e-03]
 [-1.35672218e-02]
 [-5.69616298e-03]
 [ 3.79168093e-02]
 [ 5.97382955e-03]
 [-3.97828041e-03]
 [-6.88693349e-03]
 [-4.89516433e-03]
 [-3.14846995e-03]
 [ 2.02692142e-03]
 [ 4.35032780e-03]
 [-7.41036654e-03]
 [-5.52653621e-02]
 [-4.47613250e-03]
 [ 1.84114677e-02]
 [-1.71335507e-02]
 [-6.32882210e-03]
 [ 3.28108647e-03]
 [-1.35567131e-02]
 [ 2.21048728e-02]
 [ 4.18177223e-02]
 [-1.46954178e-02]
 [-5.03838593e-03]
 [ 3.80185518e-03]
 [ 3.53713767e-03]
 [-8.42534213e-03]
 [-1.37845367e-02]
 [ 1.39996135e-02]
 [-4.39084055e-02]
 [-1.44646522e-02]
 [ 2.48237429e-02]
 [-1.84254018e-02]
 [ 1.34078449e-02]
 [-1.26937159e-02]
 [-1.26380084e-02]
 [-2.30072232e-03]
 [ 1.43129684e-01]
 [-1.27146026e-02]
 [-1.04397848e-03]
 [ 7.08646551e-03]
 [ 1.47742807e-02]
 [-2.97921562e-02]
 [-7.88433525e-03]
 [-4.51856310e-03]
 [ 1.71772757e-02]
 [ 4.50105375e-03]
 [-2.25109236e-03]
 [ 6.12435683e-03]
 [ 3.36358190e-03]
 [-1.85210439e-03]
 [ 2.72875551e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.27009287]
curr_Stock_Price:  99.39993439610173
curr_Factors:  [99.3999344]
mat_Sqrt:  [[0.15]]
grads:  [-0.26458212]
Stock Position:  -0.26458212011405324
Bond Position:  [19.02935251]


portfolio before change:  [-7.22008201]
curr_Stock_Price:  99.21541135905557
curr_Factors:  [99.21541136]
mat_Sqrt:  [[0.15]]
grads:  [0.02822209]
Stock Position:  0.028222086352308735
Bond Position:  [-10.02014791]


portfolio before change:  [-7.23065387]
curr_Stock_Price:  98.8630070532473
curr_Factors:  [98.86300705]
mat_Sqrt:  [[0.15]]
grads:  [-0.00716843]
Stock Position:  -0.007168433179512698
Bond Position:  [-6.52196101]


portfolio before change:  [-7.22866736]
curr_Stock_Price:  98.52902260814241
curr_Factors:  [98.52902261]
mat_Sqrt:  [[0.15]]
grads:  [-0.01015464]
Stock Position:  -0.010154638524600251
Bond Position:  [-6.22814075]


portfolio before change:  [-7.22830558]
curr_Stock_Price:  98.45506111273073
curr_Factors:  [98.45506111]
mat_Sqrt:  [[0.15]]
grads:  [-0.12467414]
Stock Position:  -0.12467413810453706
Bond Position:  [5.04649431]


portfolio before change:  [-7.17171544]
curr_Stock_Price:  98.00368668915387
curr_Factors:  [98.00368669]
mat_Sqrt:  [[0.15]]
grads:  [0.01670834]
Stock Position:  0.01670833572049269
Bond Position:  [-8.80919394]


portfolio before change:  [-7.16991514]
curr_Stock_Price:  98.14438844864313
curr_Factors:  [98.14438845]
mat_Sqrt:  [[0.15]]
grads:  [0.00818561]
Stock Position:  0.008185613273952787
Bond Position:  [-7.97328715]


portfolio before change:  [-7.17337699]
curr_Stock_Price:  97.78235036778305
curr_Factors:  [97.78235037]
mat_Sqrt:  [[0.15]]
grads:  [-0.02682576]
Stock Position:  -0.026825761413761876
Bond Position:  [-4.55029099]


portfolio before change:  [-7.18092478]
curr_Stock_Price:  98.05311200924866
curr_Factors:  [98.05311201]
mat_Sqrt:  [[0.15]]
grads:  [0.04978667]
Stock Position:  0.049786666545301984
Bond Position:  [-12.06266237]


portfolio before change:  [-7.13298976]
curr_Stock_Price:  99.03106387250986
curr_Factors:  [99.03106387]
mat_Sqrt:  [[0.15]]
grads:  [-0.12218718]
Stock Position:  -0.12218717618722254
Bond Position:  [4.96733629]


portfolio before change:  [-7.19203646]
curr_Stock_Price:  99.51685271484662
curr_Factors:  [99.51685271]
mat_Sqrt:  [[0.15]]
grads:  [0.04602727]
Stock Position:  0.04602726739581538
Bond Position:  [-11.77252525]


portfolio before change:  [-7.17814442]
curr_Stock_Price:  99.83466093948003
curr_Factors:  [99.83466094]
mat_Sqrt:  [[0.15]]
grads:  [-0.03325279]
Stock Position:  -0.033252785215191066
Bond Position:  [-3.85836388]


portfolio before change:  [-7.16040711]
curr_Stock_Price:  99.29400047369752
curr_Factors:  [99.29400047]
mat_Sqrt:  [[0.15]]
grads:  [-0.04773736]
Stock Position:  -0.047737357832293124
Bond Position:  [-2.42037388]


portfolio before change:  [-7.21825698]
curr_Stock_Price:  100.50266792551841
curr_Factors:  [100.50266793]
mat_Sqrt:  [[0.15]]
grads:  [0.02844453]
Stock Position:  0.028444525061013106
Bond Position:  [-10.07700763]


portfolio before change:  [-7.22090387]
curr_Stock_Price:  100.43175589667099
curr_Factors:  [100.4317559]
mat_Sqrt:  [[0.15]]
grads:  [0.04211765]
Stock Position:  0.04211764635495871
Bond Position:  [-11.45085305]


portfolio before change:  [-7.19335721]
curr_Stock_Price:  101.10278954675762
curr_Factors:  [101.10278955]
mat_Sqrt:  [[0.15]]
grads:  [-0.06779062]
Stock Position:  -0.0677906173560474
Bond Position:  [-0.33953669]


portfolio before change:  [-7.15891578]
curr_Stock_Price:  100.59442043979061
curr_Factors:  [100.59442044]
mat_Sqrt:  [[0.15]]
grads:  [0.09377386]
Stock Position:  0.09377386104097392
Bond Position:  [-16.59204298]


portfolio before change:  [-7.10351158]
curr_Stock_Price:  101.1963070453072
curr_Factors:  [101.19630705]
mat_Sqrt:  [[0.15]]
grads:  [0.13760403]
Stock Position:  0.1376040346550449
Bond Position:  [-21.02853172]


portfolio before change:  [-7.06955658]
curr_Stock_Price:  101.45261729458332
curr_Factors:  [101.45261729]
mat_Sqrt:  [[0.15]]
grads:  [0.12114269]
Stock Position:  0.1211426927412936
Bond Position:  [-19.35979983]


portfolio before change:  [-6.99160448]
curr_Stock_Price:  102.10607916690775
curr_Factors:  [102.10607917]
mat_Sqrt:  [[0.15]]
grads:  [-0.00695559]
Stock Position:  -0.006955590515817789
Bond Position:  [-6.2813964]


portfolio before change:  [-6.99464818]
curr_Stock_Price:  102.48722675541713
curr_Factors:  [102.48722676]
mat_Sqrt:  [[0.15]]
grads:  [0.29732682]
Stock Position:  0.2973268213009332
Bond Position:  [-37.46684954]


portfolio before change:  [-6.8507727]
curr_Stock_Price:  102.97899952612909
curr_Factors:  [102.97899953]
mat_Sqrt:  [[0.15]]
grads:  [-0.07554465]
Stock Position:  -0.07554465339026359
Bond Position:  [0.92874013]


portfolio before change:  [-6.886298]
curr_Stock_Price:  103.45002354165591
curr_Factors:  [103.45002354]
mat_Sqrt:  [[0.15]]
grads:  [0.00556206]
Stock Position:  0.005562055259420943
Bond Position:  [-7.46169274]


portfolio before change:  [-6.88866809]
curr_Stock_Price:  103.1077537132345
curr_Factors:  [103.10775371]
mat_Sqrt:  [[0.15]]
grads:  [-0.00603159]
Stock Position:  -0.006031585103252476
Bond Position:  [-6.2667649]


portfolio before change:  [-6.88615414]
curr_Stock_Price:  102.6260171230135
curr_Factors:  [102.62601712]
mat_Sqrt:  [[0.15]]
grads:  [0.11698698]
Stock Position:  0.11698698491777303
Bond Position:  [-18.89206246]


portfolio before change:  [-6.83762052]
curr_Stock_Price:  103.05097386090905
curr_Factors:  [103.05097386]
mat_Sqrt:  [[0.15]]
grads:  [0.11697253]
Stock Position:  0.11697252913967773
Bond Position:  [-18.89175357]


portfolio before change:  [-6.90047501]
curr_Stock_Price:  102.52372430062525
curr_Factors:  [102.5237243]
mat_Sqrt:  [[0.15]]
grads:  [0.06774866]
Stock Position:  0.06774865807474438
Bond Position:  [-13.84631975]


portfolio before change:  [-6.95544759]
curr_Stock_Price:  101.72507888754727
curr_Factors:  [101.72507889]
mat_Sqrt:  [[0.15]]
grads:  [0.03690945]
Stock Position:  0.03690944776345335
Bond Position:  [-10.71006407]


portfolio before change:  [-6.93057771]
curr_Stock_Price:  102.41702306241432
curr_Factors:  [102.41702306]
mat_Sqrt:  [[0.15]]
grads:  [0.03904555]
Stock Position:  0.03904554955404339
Bond Position:  [-10.92950666]


portfolio before change:  [-6.91695872]
curr_Stock_Price:  102.78331593176054
curr_Factors:  [102.78331593]
mat_Sqrt:  [[0.15]]
grads:  [-0.09044815]
Stock Position:  -0.09044814566516575
Bond Position:  [2.37960161]


portfolio before change:  [-6.9036612]
curr_Stock_Price:  102.63794212588866
curr_Factors:  [102.63794213]
mat_Sqrt:  [[0.15]]
grads:  [-0.03797442]
Stock Position:  -0.037974419895249995
Bond Position:  [-3.00604489]


portfolio before change:  [-6.91719947]
curr_Stock_Price:  102.98950488551142
curr_Factors:  [102.98950489]
mat_Sqrt:  [[0.15]]
grads:  [0.25277873]
Stock Position:  0.2527787286036876
Bond Position:  [-32.95075558]


portfolio before change:  [-6.89921417]
curr_Stock_Price:  103.06880265737259
curr_Factors:  [103.06880266]
mat_Sqrt:  [[0.15]]
grads:  [0.03982553]
Stock Position:  0.03982553030336989
Bond Position:  [-11.00398389]


portfolio before change:  [-6.90760056]
curr_Stock_Price:  102.87549406593764
curr_Factors:  [102.87549407]
mat_Sqrt:  [[0.15]]
grads:  [-0.02652187]
Stock Position:  -0.026521869414253187
Bond Position:  [-4.17915014]


portfolio before change:  [-6.92581013]
curr_Stock_Price:  103.5522323339343
curr_Factors:  [103.55223233]
mat_Sqrt:  [[0.15]]
grads:  [-0.04591289]
Stock Position:  -0.04591288990873458
Bond Position:  [-2.17142788]


portfolio before change:  [-6.95629689]
curr_Stock_Price:  104.21328939047507
curr_Factors:  [104.21328939]
mat_Sqrt:  [[0.15]]
grads:  [-0.03263443]
Stock Position:  -0.03263442884634153
Bond Position:  [-3.55535571]


portfolio before change:  [-6.96510542]
curr_Stock_Price:  104.47639552819884
curr_Factors:  [104.47639553]
mat_Sqrt:  [[0.15]]
grads:  [-0.0209898]
Stock Position:  -0.020989799688632675
Bond Position:  [-4.77216681]


portfolio before change:  [-6.95120002]
curr_Stock_Price:  103.79970160348014
curr_Factors:  [103.7997016]
mat_Sqrt:  [[0.15]]
grads:  [0.01351281]
Stock Position:  0.013512809478002768
Bond Position:  [-8.35382561]


portfolio before change:  [-6.94845062]
curr_Stock_Price:  104.04180786536183
curr_Factors:  [104.04180787]
mat_Sqrt:  [[0.15]]
grads:  [0.02900219]
Stock Position:  0.029002185302407273
Bond Position:  [-9.96589041]


portfolio before change:  [-6.95352496]
curr_Stock_Price:  103.8883208935845
curr_Factors:  [103.88832089]
mat_Sqrt:  [[0.15]]
grads:  [-0.04940244]
Stock Position:  -0.04940244361414467
Bond Position:  [-1.82118805]


portfolio before change:  [-7.01297805]
curr_Stock_Price:  105.08946103357948
curr_Factors:  [105.08946103]
mat_Sqrt:  [[0.15]]
grads:  [-0.36843575]
Stock Position:  -0.3684357474705939
Bond Position:  [31.70573608]


portfolio before change:  [-7.06036367]
curr_Stock_Price:  105.22345263903031
curr_Factors:  [105.22345264]
mat_Sqrt:  [[0.15]]
grads:  [-0.02984088]
Stock Position:  -0.029840883333533096
Bond Position:  [-3.9204029]


portfolio before change:  [-7.07305283]
curr_Stock_Price:  105.6404686538017
curr_Factors:  [105.64046865]
mat_Sqrt:  [[0.15]]
grads:  [0.12274312]
Stock Position:  0.12274311784505679
Bond Position:  [-20.03969333]


portfolio before change:  [-7.00629265]
curr_Stock_Price:  106.19457465999952
curr_Factors:  [106.19457466]
mat_Sqrt:  [[0.15]]
grads:  [-0.11422367]
Stock Position:  -0.11422367150056359
Bond Position:  [5.12364156]


portfolio before change:  [-6.93145391]
curr_Stock_Price:  105.5421836066562
curr_Factors:  [105.54218361]
mat_Sqrt:  [[0.15]]
grads:  [-0.04219215]
Stock Position:  -0.0421921473142932
Bond Position:  [-2.47840256]


portfolio before change:  [-6.97620056]
curr_Stock_Price:  106.59905653034241
curr_Factors:  [106.59905653]
mat_Sqrt:  [[0.15]]
grads:  [0.02187391]
Stock Position:  0.021873909778686064
Bond Position:  [-9.3079387]


portfolio before change:  [-6.99524837]
curr_Stock_Price:  105.7548521336446
curr_Factors:  [105.75485213]
mat_Sqrt:  [[0.15]]
grads:  [-0.09037809]
Stock Position:  -0.09037808712611242
Bond Position:  [2.56267287]


portfolio before change:  [-7.04068429]
curr_Stock_Price:  106.25935598738198
curr_Factors:  [106.25935599]
mat_Sqrt:  [[0.15]]
grads:  [0.14736582]
Stock Position:  0.14736581898231388
Bond Position:  [-22.69968131]


portfolio before change:  [-6.92901184]
curr_Stock_Price:  107.02677431343261
curr_Factors:  [107.02677431]
mat_Sqrt:  [[0.15]]
grads:  [0.27878482]
Stock Position:  0.27878481548728595
Bond Position:  [-36.76645137]


portfolio before change:  [-6.91930599]
curr_Stock_Price:  107.06983198387022
curr_Factors:  [107.06983198]
mat_Sqrt:  [[0.15]]
grads:  [-0.09796945]
Stock Position:  -0.0979694520488354
Bond Position:  [3.57026678]


portfolio before change:  [-6.92173595]
curr_Stock_Price:  107.0969129478162
curr_Factors:  [107.09691295]
mat_Sqrt:  [[0.15]]
grads:  [-0.03358924]
Stock Position:  -0.03358923950282585
Bond Position:  [-3.32443209]


portfolio before change:  [-6.91858401]
curr_Stock_Price:  106.99688936887777
curr_Factors:  [106.99688937]
mat_Sqrt:  [[0.15]]
grads:  [0.0253457]
Stock Position:  0.02534570120794275
Bond Position:  [-9.6304952]


portfolio before change:  [-6.90503869]
curr_Stock_Price:  107.55506106931249
curr_Factors:  [107.55506107]
mat_Sqrt:  [[0.15]]
grads:  [0.02358092]
Stock Position:  0.023580917813264008
Bond Position:  [-9.44128574]


portfolio before change:  [-6.9061261]
curr_Stock_Price:  107.53397120981064
curr_Factors:  [107.53397121]
mat_Sqrt:  [[0.15]]
grads:  [-0.05616895]
Stock Position:  -0.05616894754488482
Bond Position:  [-0.86605612]


portfolio before change:  [-6.90593713]
curr_Stock_Price:  107.52964310133422
curr_Factors:  [107.5296431]
mat_Sqrt:  [[0.15]]
grads:  [-0.09189691]
Stock Position:  -0.0918969112041394
Bond Position:  [2.97570494]


portfolio before change:  [-6.98292127]
curr_Stock_Price:  108.36938984733209
curr_Factors:  [108.36938985]
mat_Sqrt:  [[0.15]]
grads:  [0.09333076]
Stock Position:  0.09333075644093988
Bond Position:  [-17.0971184]


portfolio before change:  [-6.98200225]
curr_Stock_Price:  108.39068646654412
curr_Factors:  [108.39068647]
mat_Sqrt:  [[0.15]]
grads:  [-0.2927227]
Stock Position:  -0.2927227030953552
Bond Position:  [24.74641249]


portfolio before change:  [-7.08679027]
curr_Stock_Price:  108.75394739804035
curr_Factors:  [108.7539474]
mat_Sqrt:  [[0.15]]
grads:  [-0.09643101]
Stock Position:  -0.09643101453213716
Bond Position:  [3.40046321]


portfolio before change:  [-7.13749327]
curr_Stock_Price:  109.28194699839186
curr_Factors:  [109.281947]
mat_Sqrt:  [[0.15]]
grads:  [0.16549162]
Stock Position:  0.16549161936946027
Bond Position:  [-25.22273965]


portfolio before change:  [-6.98235823]
curr_Stock_Price:  110.22889230350256
curr_Factors:  [110.2288923]
mat_Sqrt:  [[0.15]]
grads:  [-0.12283601]
Stock Position:  -0.12283601198710022
Bond Position:  [6.55771931]


portfolio before change:  [-6.83653033]
curr_Stock_Price:  109.04505354814326
curr_Factors:  [109.04505355]
mat_Sqrt:  [[0.15]]
grads:  [0.08938563]
Stock Position:  0.0893856327474556
Bond Position:  [-16.58359144]


portfolio before change:  [-6.84367868]
curr_Stock_Price:  108.9766773712131
curr_Factors:  [108.97667737]
mat_Sqrt:  [[0.15]]
grads:  [-0.08462477]
Stock Position:  -0.08462477284233805
Bond Position:  [2.37844789]


portfolio before change:  [-6.80708109]
curr_Stock_Price:  108.54596505858777
curr_Factors:  [108.54596506]
mat_Sqrt:  [[0.15]]
grads:  [-0.08425339]
Stock Position:  -0.08425338951354443
Bond Position:  [2.33828438]


portfolio before change:  [-6.79411085]
curr_Stock_Price:  108.3937564326013
curr_Factors:  [108.39375643]
mat_Sqrt:  [[0.15]]
grads:  [-0.01533815]
Stock Position:  -0.015338148814140381
Bond Position:  [-5.13155129]


portfolio before change:  [-6.79122237]
curr_Stock_Price:  108.1845252077751
curr_Factors:  [108.18452521]
mat_Sqrt:  [[0.15]]
grads:  [0.95419789]
Stock Position:  0.9541978911549797
Bond Position:  [-110.02066817]


portfolio before change:  [-7.27729823]
curr_Stock_Price:  107.68232397110168
curr_Factors:  [107.68232397]
mat_Sqrt:  [[0.15]]
grads:  [-0.08476402]
Stock Position:  -0.0847640173532401
Bond Position:  [1.85028814]


portfolio before change:  [-7.37404292]
curr_Stock_Price:  108.82502972189792
curr_Factors:  [108.82502972]
mat_Sqrt:  [[0.15]]
grads:  [-0.00695986]
Stock Position:  -0.006959856542770813
Bond Position:  [-6.61663632]


portfolio before change:  [-7.3711729]
curr_Stock_Price:  108.3532434042969
curr_Factors:  [108.3532434]
mat_Sqrt:  [[0.15]]
grads:  [0.0472431]
Stock Position:  0.04724310342628466
Bond Position:  [-12.49011639]


portfolio before change:  [-7.43227029]
curr_Stock_Price:  107.07651246860658
curr_Factors:  [107.07651247]
mat_Sqrt:  [[0.15]]
grads:  [0.0984952]
Stock Position:  0.09849520445906598
Bond Position:  [-17.97879328]


portfolio before change:  [-7.39635525]
curr_Stock_Price:  107.4525586732481
curr_Factors:  [107.45255867]
mat_Sqrt:  [[0.15]]
grads:  [-0.19861437]
Stock Position:  -0.1986143748633239
Bond Position:  [13.94526751]


portfolio before change:  [-7.49508102]
curr_Stock_Price:  107.95401972972653
curr_Factors:  [107.95401973]
mat_Sqrt:  [[0.15]]
grads:  [-0.05256224]
Stock Position:  -0.05256223503157502
Bond Position:  [-1.82077646]


portfolio before change:  [-7.51088121]
curr_Stock_Price:  108.25245419578206
curr_Factors:  [108.2524542]
mat_Sqrt:  [[0.15]]
grads:  [-0.03012375]
Stock Position:  -0.030123754024677086
Bond Position:  [-4.2499109]


portfolio before change:  [-7.5107531]
curr_Stock_Price:  108.23938360562632
curr_Factors:  [108.23938361]
mat_Sqrt:  [[0.15]]
grads:  [0.11451517]
Stock Position:  0.11451517122196517
Bond Position:  [-19.90580465]


portfolio before change:  [-7.61200999]
curr_Stock_Price:  107.3660256229779
curr_Factors:  [107.36602562]
mat_Sqrt:  [[0.15]]
grads:  [0.03000703]
Stock Position:  0.03000702500382852
Bond Position:  [-10.83374501]


portfolio before change:  [-7.60198252]
curr_Stock_Price:  107.72276209042457
curr_Factors:  [107.72276209]
mat_Sqrt:  [[0.15]]
grads:  [-0.01500728]
Stock Position:  -0.015007282380130854
Bond Position:  [-5.98535661]


portfolio before change:  [-7.61070913]
curr_Stock_Price:  108.2793258940554
curr_Factors:  [108.27932589]
mat_Sqrt:  [[0.15]]
grads:  [0.04082905]
Stock Position:  0.04082904554676906
Bond Position:  [-12.03165066]


portfolio before change:  [-7.63527377]
curr_Stock_Price:  107.69609797003417
curr_Factors:  [107.69609797]
mat_Sqrt:  [[0.15]]
grads:  [0.02242388]
Stock Position:  0.022423879301416406
Bond Position:  [-10.05023807]


portfolio before change:  [-7.61700408]
curr_Stock_Price:  108.5388534723023
curr_Factors:  [108.53885347]
mat_Sqrt:  [[0.15]]
grads:  [-0.01234736]
Stock Position:  -0.01234736261272472
Bond Position:  [-6.2768355]


portfolio before change:  [-7.62988791]
curr_Stock_Price:  109.55052806133517
curr_Factors:  [109.55052806]
mat_Sqrt:  [[0.15]]
grads:  [0.18191703]
Stock Position:  0.1819170337492641
Bond Position:  [-27.55899502]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.62988791]
Stock Price:  110.17451801323583
PL:  [-17.80440592]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.55160842e-02]
 [ 3.71635353e-03]
 [-3.75815450e-04]
 [ 1.07402605e-03]
 [-1.45907741e-02]
 [ 7.97416219e-03]
 [ 4.37491909e-04]
 [ 7.35880181e-03]
 [ 1.77200562e-02]
 [-1.97936898e-02]
 [ 6.05411262e-03]
 [-6.14620092e-03]
 [-2.09291926e-03]
 [ 3.77328579e-03]
 [-1.51688672e-03]
 [ 1.33388608e-02]
 [ 6.29333865e-04]
 [ 7.43288681e-03]
 [ 2.37098123e-02]
 [ 1.15912241e-02]
 [ 4.69667869e-02]
 [-1.72149909e-02]
 [-2.66552766e-03]
 [ 1.39395633e-02]
 [ 7.18068843e-03]
 [ 9.16606956e-03]
 [ 1.40586324e-02]
 [-1.34995683e-02]
 [ 1.84052168e-03]
 [-9.64230398e-03]
 [-3.78743731e-03]
 [-1.81821048e-02]
 [ 1.68927052e-02]
 [ 1.40583585e-02]
 [-2.07217146e-02]
 [ 7.77066049e-03]
 [-2.70275144e-03]
 [ 4.46675246e-03]
 [ 5.05786052e-03]
 [-1.77724053e-02]
 [ 4.35650017e-02]
 [ 1.05000445e-03]
 [ 7.27751026e-03]
 [-9.24932394e-03]
 [-2.27415860e-03]
 [-1.21855534e-02]
 [-1.33068286e-02]
 [ 1.12443623e-04]
 [-3.32549963e-03]
 [ 1.59087724e-03]
 [-3.48136554e-03]
 [ 3.23064801e-03]
 [ 2.28070957e-03]
 [-5.47954150e-04]
 [ 1.48764909e-03]
 [ 8.99418166e-03]
 [ 1.37355380e-02]
 [-2.07542531e-02]
 [ 1.38539587e-02]
 [ 3.49638537e-03]
 [ 5.14245188e-03]
 [-1.33237880e-02]
 [-1.26177728e-02]
 [-1.67602995e-03]
 [-1.23956587e-02]
 [ 3.68428084e-02]
 [ 1.76275278e-02]
 [ 2.01236070e-03]
 [ 6.11757819e-03]
 [-1.49296538e-02]
 [-2.56997831e-03]
 [ 2.05533177e-03]
 [-6.42650349e-04]
 [ 8.27825980e-03]
 [ 2.91499889e-03]
 [-1.97335805e-03]
 [-3.06162076e-03]
 [-9.84194008e-03]
 [-7.05762047e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.81573166]
curr_Stock_Price:  100.0481569917514
curr_Factors:  [100.04815699]
mat_Sqrt:  [[0.15]]
grads:  [-0.23677389]
Stock Position:  -0.2367738945738752
Bond Position:  [26.50452344]


portfolio before change:  [3.00039483]
curr_Stock_Price:  99.27523992018543
curr_Factors:  [99.27523992]
mat_Sqrt:  [[0.15]]
grads:  [0.02477569]
Stock Position:  0.024775690176398628
Bond Position:  [0.54078225]


portfolio before change:  [3.00311377]
curr_Stock_Price:  99.38361780158506
curr_Factors:  [99.3836178]
mat_Sqrt:  [[0.15]]
grads:  [-0.00250544]
Stock Position:  -0.0025054363315026636
Bond Position:  [3.2521131]


portfolio before change:  [3.00310326]
curr_Stock_Price:  99.46894152128309
curr_Factors:  [99.46894152]
mat_Sqrt:  [[0.15]]
grads:  [0.00716017]
Stock Position:  0.007160173650277412
Bond Position:  [2.29088837]


portfolio before change:  [2.99811915]
curr_Stock_Price:  98.75285635863472
curr_Factors:  [98.75285636]
mat_Sqrt:  [[0.15]]
grads:  [-0.09727183]
Stock Position:  -0.097271827453968
Bond Position:  [12.60398996]


portfolio before change:  [2.9779753]
curr_Stock_Price:  98.96804332499444
curr_Factors:  [98.96804332]
mat_Sqrt:  [[0.15]]
grads:  [0.05316108]
Stock Position:  0.05316108126490508
Bond Position:  [-2.2832729]


portfolio before change:  [2.97290375]
curr_Stock_Price:  98.87532810506382
curr_Factors:  [98.87532811]
mat_Sqrt:  [[0.15]]
grads:  [0.00291661]
Stock Position:  0.002916612727161315
Bond Position:  [2.68452271]


portfolio before change:  [2.97175818]
curr_Stock_Price:  98.42502707831878
curr_Factors:  [98.42502708]
mat_Sqrt:  [[0.15]]
grads:  [0.04905868]
Stock Position:  0.04905867870468606
Bond Position:  [-1.8568436]


portfolio before change:  [3.01179967]
curr_Stock_Price:  99.24358860118225
curr_Factors:  [99.2435886]
mat_Sqrt:  [[0.15]]
grads:  [0.11813371]
Stock Position:  0.11813370815206874
Bond Position:  [-8.71221346]


portfolio before change:  [2.99796628]
curr_Stock_Price:  99.13109862268466
curr_Factors:  [99.13109862]
mat_Sqrt:  [[0.15]]
grads:  [-0.13195793]
Stock Position:  -0.13195793177336118
Bond Position:  [16.07910103]


portfolio before change:  [3.03401695]
curr_Stock_Price:  98.86551633994495
curr_Factors:  [98.86551634]
mat_Sqrt:  [[0.15]]
grads:  [0.04036075]
Stock Position:  0.04036075080294308
Bond Position:  [-0.95626952]


portfolio before change:  [3.04135025]
curr_Stock_Price:  99.0486910445891
curr_Factors:  [99.04869104]
mat_Sqrt:  [[0.15]]
grads:  [-0.04097467]
Stock Position:  -0.0409746728191966
Bond Position:  [7.09983795]


portfolio before change:  [3.06076331]
curr_Stock_Price:  98.58573897556184
curr_Factors:  [98.58573898]
mat_Sqrt:  [[0.15]]
grads:  [-0.0139528]
Stock Position:  -0.013952795062789174
Bond Position:  [4.43630992]


portfolio before change:  [3.05431717]
curr_Stock_Price:  99.06760750106565
curr_Factors:  [99.0676075]
mat_Sqrt:  [[0.15]]
grads:  [0.02515524]
Stock Position:  0.025155238572504644
Bond Position:  [0.56224787]


portfolio before change:  [3.05821943]
curr_Stock_Price:  99.22133729905792
curr_Factors:  [99.2213373]
mat_Sqrt:  [[0.15]]
grads:  [-0.01011258]
Stock Position:  -0.010112578140330682
Bond Position:  [4.06160295]


portfolio before change:  [3.06097703]
curr_Stock_Price:  98.97375036302832
curr_Factors:  [98.97375036]
mat_Sqrt:  [[0.15]]
grads:  [0.08892574]
Stock Position:  0.08892573885226566
Bond Position:  [-5.74033685]


portfolio before change:  [3.09387174]
curr_Stock_Price:  99.34769712152237
curr_Factors:  [99.34769712]
mat_Sqrt:  [[0.15]]
grads:  [0.00419556]
Stock Position:  0.004195559100138882
Bond Position:  [2.6770526]


portfolio before change:  [3.09456216]
curr_Stock_Price:  99.47237731568832
curr_Factors:  [99.47237732]
mat_Sqrt:  [[0.15]]
grads:  [0.04955258]
Stock Position:  0.0495525787093609
Bond Position:  [-1.83455065]


portfolio before change:  [3.09799487]
curr_Stock_Price:  99.5439654484555
curr_Factors:  [99.54396545]
mat_Sqrt:  [[0.15]]
grads:  [0.15806542]
Stock Position:  0.15806541564396642
Bond Position:  [-12.6364634]


portfolio before change:  [3.01115453]
curr_Stock_Price:  98.99956716736676
curr_Factors:  [98.99956717]
mat_Sqrt:  [[0.15]]
grads:  [0.07727483]
Stock Position:  0.07727482741914346
Bond Position:  [-4.63901994]


portfolio before change:  [3.00249151]
curr_Stock_Price:  98.89121266040371
curr_Factors:  [98.89121266]
mat_Sqrt:  [[0.15]]
grads:  [0.31311191]
Stock Position:  0.31311191242240993
Bond Position:  [-27.96152521]


portfolio before change:  [3.06468268]
curr_Stock_Price:  99.09541704569381
curr_Factors:  [99.09541705]
mat_Sqrt:  [[0.15]]
grads:  [-0.11476661]
Stock Position:  -0.1147666063300479
Bond Position:  [14.4375274]


portfolio before change:  [2.9751194]
curr_Stock_Price:  99.88367467698724
curr_Factors:  [99.88367468]
mat_Sqrt:  [[0.15]]
grads:  [-0.01777018]
Stock Position:  -0.017770184428447213
Bond Position:  [4.75007072]


portfolio before change:  [2.98574229]
curr_Stock_Price:  99.30258890466736
curr_Factors:  [99.3025889]
mat_Sqrt:  [[0.15]]
grads:  [0.09293042]
Stock Position:  0.09293042178582049
Bond Position:  [-6.24248918]


portfolio before change:  [2.95098879]
curr_Stock_Price:  98.93281404408434
curr_Factors:  [98.93281404]
mat_Sqrt:  [[0.15]]
grads:  [0.04787126]
Stock Position:  0.047871256168243684
Bond Position:  [-1.78504929]


portfolio before change:  [2.92358842]
curr_Stock_Price:  98.36276836435583
curr_Factors:  [98.36276836]
mat_Sqrt:  [[0.15]]
grads:  [0.06110713]
Stock Position:  0.06110713040065392
Bond Position:  [-3.08707809]


portfolio before change:  [2.90187753]
curr_Stock_Price:  98.01063374334385
curr_Factors:  [98.01063374]
mat_Sqrt:  [[0.15]]
grads:  [0.09372422]
Stock Position:  0.09372421611613942
Bond Position:  [-6.28409229]


portfolio before change:  [2.95771569]
curr_Stock_Price:  98.61059525349178
curr_Factors:  [98.61059525]
mat_Sqrt:  [[0.15]]
grads:  [-0.08999712]
Stock Position:  -0.08999712200154625
Bond Position:  [11.83238546]


portfolio before change:  [2.9735141]
curr_Stock_Price:  98.44326917164138
curr_Factors:  [98.44326917]
mat_Sqrt:  [[0.15]]
grads:  [0.01227014]
Stock Position:  0.012270144513818781
Bond Position:  [1.76560096]


portfolio before change:  [2.9745465]
curr_Stock_Price:  98.51841478032617
curr_Factors:  [98.51841478]
mat_Sqrt:  [[0.15]]
grads:  [-0.06428203]
Stock Position:  -0.064282026509034
Bond Position:  [9.30750985]


portfolio before change:  [2.94791462]
curr_Stock_Price:  98.94176196387905
curr_Factors:  [98.94176196]
mat_Sqrt:  [[0.15]]
grads:  [-0.02524958]
Stock Position:  -0.02524958208214932
Bond Position:  [5.44615276]


portfolio before change:  [2.95662819]
curr_Stock_Price:  98.61014575459458
curr_Factors:  [98.61014575]
mat_Sqrt:  [[0.15]]
grads:  [-0.12121403]
Stock Position:  -0.12121403190713315
Bond Position:  [14.90956154]


portfolio before change:  [3.00393201]
curr_Stock_Price:  98.22758328033423
curr_Factors:  [98.22758328]
mat_Sqrt:  [[0.15]]
grads:  [0.11261803]
Stock Position:  0.11261803487526655
Bond Position:  [-8.05826539]


portfolio before change:  [2.98885332]
curr_Stock_Price:  98.098163237894
curr_Factors:  [98.09816324]
mat_Sqrt:  [[0.15]]
grads:  [0.09372239]
Stock Position:  0.09372238986641326
Bond Position:  [-6.20514098]


portfolio before change:  [2.94710028]
curr_Stock_Price:  97.6568043432565
curr_Factors:  [97.65680434]
mat_Sqrt:  [[0.15]]
grads:  [-0.13814476]
Stock Position:  -0.13814476401554826
Bond Position:  [16.43787647]


portfolio before change:  [2.96892501]
curr_Stock_Price:  97.50625697108893
curr_Factors:  [97.50625697]
mat_Sqrt:  [[0.15]]
grads:  [0.0518044]
Stock Position:  0.0518044032817614
Bond Position:  [-2.08232845]


portfolio before change:  [2.97731004]
curr_Stock_Price:  97.67062878871963
curr_Factors:  [97.67062879]
mat_Sqrt:  [[0.15]]
grads:  [-0.01801834]
Stock Position:  -0.018018342959050953
Bond Position:  [4.73717293]


portfolio before change:  [2.97633919]
curr_Stock_Price:  97.74094201200964
curr_Factors:  [97.74094201]
mat_Sqrt:  [[0.15]]
grads:  [0.02977835]
Stock Position:  0.02977834975901549
Bond Position:  [0.06577524]


portfolio before change:  [2.96044118]
curr_Stock_Price:  97.20692571627714
curr_Factors:  [97.20692572]
mat_Sqrt:  [[0.15]]
grads:  [0.03371907]
Stock Position:  0.03371907010895333
Bond Position:  [-0.31728596]


portfolio before change:  [2.92871013]
curr_Stock_Price:  96.26647217721312
curr_Factors:  [96.26647218]
mat_Sqrt:  [[0.15]]
grads:  [-0.1184827]
Stock Position:  -0.11848270187572604
Bond Position:  [14.33462186]


portfolio before change:  [2.92048505]
curr_Stock_Price:  96.34345408071837
curr_Factors:  [96.34345408]
mat_Sqrt:  [[0.15]]
grads:  [0.29043334]
Stock Position:  0.290433344406657
Bond Position:  [-25.06086653]


portfolio before change:  [2.94281508]
curr_Stock_Price:  96.42573243786119
curr_Factors:  [96.42573244]
mat_Sqrt:  [[0.15]]
grads:  [0.00700003]
Stock Position:  0.007000029652478342
Bond Position:  [2.26783209]


portfolio before change:  [2.94204866]
curr_Stock_Price:  96.29599561463185
curr_Factors:  [96.29599561]
mat_Sqrt:  [[0.15]]
grads:  [0.04851674]
Stock Position:  0.04851673505308805
Bond Position:  [-1.72991865]


portfolio before change:  [2.95614038]
curr_Stock_Price:  96.58867490349297
curr_Factors:  [96.5886749]
mat_Sqrt:  [[0.15]]
grads:  [-0.06166216]
Stock Position:  -0.06166215961327117
Bond Position:  [8.91200667]


portfolio before change:  [3.0176574]
curr_Stock_Price:  95.60006207008256
curr_Factors:  [95.60006207]
mat_Sqrt:  [[0.15]]
grads:  [-0.01516106]
Stock Position:  -0.01516105734981685
Bond Position:  [4.46705542]


portfolio before change:  [3.01293804]
curr_Stock_Price:  95.92975921232308
curr_Factors:  [95.92975921]
mat_Sqrt:  [[0.15]]
grads:  [-0.08123702]
Stock Position:  -0.08123702274671223
Bond Position:  [10.80598607]


portfolio before change:  [3.00820068]
curr_Stock_Price:  95.9963883892626
curr_Factors:  [95.99638839]
mat_Sqrt:  [[0.15]]
grads:  [-0.08871219]
Stock Position:  -0.0887121907689389
Bond Position:  [11.5242506]


portfolio before change:  [2.95806033]
curr_Stock_Price:  96.56971026338259
curr_Factors:  [96.56971026]
mat_Sqrt:  [[0.15]]
grads:  [0.00074962]
Stock Position:  0.0007496241535194688
Bond Position:  [2.88566934]


portfolio before change:  [2.95864639]
curr_Stock_Price:  97.11091458433933
curr_Factors:  [97.11091458]
mat_Sqrt:  [[0.15]]
grads:  [-0.02217]
Stock Position:  -0.022169997544395786
Bond Position:  [5.11159513]


portfolio before change:  [2.9594985]
curr_Stock_Price:  97.08688997696464
curr_Factors:  [97.08688998]
mat_Sqrt:  [[0.15]]
grads:  [0.01060585]
Stock Position:  0.010605848253487638
Bond Position:  [1.92980968]


portfolio before change:  [2.96325007]
curr_Stock_Price:  97.42924371263875
curr_Factors:  [97.42924371]
mat_Sqrt:  [[0.15]]
grads:  [-0.0232091]
Stock Position:  -0.023209103626978325
Bond Position:  [5.22449548]


portfolio before change:  [2.93881267]
curr_Stock_Price:  98.49623627030178
curr_Factors:  [98.49623627]
mat_Sqrt:  [[0.15]]
grads:  [0.02153765]
Stock Position:  0.02153765338592728
Bond Position:  [0.81743487]


portfolio before change:  [2.95303397]
curr_Stock_Price:  99.15416361811978
curr_Factors:  [99.15416362]
mat_Sqrt:  [[0.15]]
grads:  [0.01520473]
Stock Position:  0.015204730472280261
Bond Position:  [1.44542164]


portfolio before change:  [2.95379949]
curr_Stock_Price:  99.19856943757368
curr_Factors:  [99.19856944]
mat_Sqrt:  [[0.15]]
grads:  [-0.00365303]
Stock Position:  -0.0036530276668357044
Bond Position:  [3.31617461]


portfolio before change:  [2.95561099]
curr_Stock_Price:  98.75941707239991
curr_Factors:  [98.75941707]
mat_Sqrt:  [[0.15]]
grads:  [0.00991766]
Stock Position:  0.009917660612057
Bond Position:  [1.97614861]


portfolio before change:  [2.9508117]
curr_Stock_Price:  98.26304931480556
curr_Factors:  [98.26304931]
mat_Sqrt:  [[0.15]]
grads:  [0.05996121]
Stock Position:  0.059961211091550615
Bond Position:  [-2.94115974]


portfolio before change:  [2.93505578]
curr_Stock_Price:  98.00334653479507
curr_Factors:  [98.00334653]
mat_Sqrt:  [[0.15]]
grads:  [0.09157025]
Stock Position:  0.09157025304224789
Bond Position:  [-6.03913546]


portfolio before change:  [3.00661739]
curr_Stock_Price:  98.78896266501707
curr_Factors:  [98.78896267]
mat_Sqrt:  [[0.15]]
grads:  [-0.13836169]
Stock Position:  -0.1383616874638263
Bond Position:  [16.67522496]


portfolio before change:  [3.03641889]
curr_Stock_Price:  98.58110692498542
curr_Factors:  [98.58110692]
mat_Sqrt:  [[0.15]]
grads:  [0.09235972]
Stock Position:  0.09235972486253904
Bond Position:  [-6.06850502]


portfolio before change:  [3.04431877]
curr_Stock_Price:  98.67074736180952
curr_Factors:  [98.67074736]
mat_Sqrt:  [[0.15]]
grads:  [0.02330924]
Stock Position:  0.02330923582030821
Bond Position:  [0.74437905]


portfolio before change:  [3.04933864]
curr_Stock_Price:  98.88411104577072
curr_Factors:  [98.88411105]
mat_Sqrt:  [[0.15]]
grads:  [0.03428301]
Stock Position:  0.034283012539811794
Bond Position:  [-0.34070658]


portfolio before change:  [3.05568462]
curr_Stock_Price:  99.06983812657751
curr_Factors:  [99.06983813]
mat_Sqrt:  [[0.15]]
grads:  [-0.08882525]
Stock Position:  -0.08882525328744774
Bond Position:  [11.85558809]


portfolio before change:  [3.10565061]
curr_Stock_Price:  98.51566022742816
curr_Factors:  [98.51566023]
mat_Sqrt:  [[0.15]]
grads:  [-0.08411849]
Stock Position:  -0.08411848504253483
Bond Position:  [11.39263871]


portfolio before change:  [3.05769633]
curr_Stock_Price:  99.09420539460751
curr_Factors:  [99.09420539]
mat_Sqrt:  [[0.15]]
grads:  [-0.01117353]
Stock Position:  -0.011173532980369775
Bond Position:  [4.16492871]


portfolio before change:  [3.05312097]
curr_Stock_Price:  99.52698478654048
curr_Factors:  [99.52698479]
mat_Sqrt:  [[0.15]]
grads:  [-0.08263772]
Stock Position:  -0.08263772435183009
Bond Position:  [11.27780451]


portfolio before change:  [3.0272072]
curr_Stock_Price:  99.84909751306454
curr_Factors:  [99.84909751]
mat_Sqrt:  [[0.15]]
grads:  [0.24561872]
Stock Position:  0.2456187227277566
Bond Position:  [-21.4976006]


portfolio before change:  [3.05917755]
curr_Stock_Price:  99.98473046092805
curr_Factors:  [99.98473046]
mat_Sqrt:  [[0.15]]
grads:  [0.11751685]
Stock Position:  0.11751685206203344
Bond Position:  [-8.69071323]


portfolio before change:  [2.98408112]
curr_Stock_Price:  99.35032575787599
curr_Factors:  [99.35032576]
mat_Sqrt:  [[0.15]]
grads:  [0.01341574]
Stock Position:  0.013415738018546517
Bond Position:  [1.65122317]


portfolio before change:  [2.99393321]
curr_Stock_Price:  100.07700171132699
curr_Factors:  [100.07700171]
mat_Sqrt:  [[0.15]]
grads:  [0.04078385]
Stock Position:  0.04078385460316066
Bond Position:  [-1.08759267]


portfolio before change:  [2.96120289]
curr_Stock_Price:  99.27613698918206
curr_Factors:  [99.27613699]
mat_Sqrt:  [[0.15]]
grads:  [-0.09953103]
Stock Position:  -0.09953102521232794
Bond Position:  [12.84225858]


portfolio before change:  [3.03992759]
curr_Stock_Price:  98.49324504715479
curr_Factors:  [98.49324505]
mat_Sqrt:  [[0.15]]
grads:  [-0.01713319]
Stock Position:  -0.01713318871679734
Bond Position:  [4.72743095]


portfolio before change:  [3.04956282]
curr_Stock_Price:  97.94811847912919
curr_Factors:  [97.94811848]
mat_Sqrt:  [[0.15]]
grads:  [0.01370221]
Stock Position:  0.013702211798622445
Bond Position:  [1.70745696]


portfolio before change:  [3.04004786]
curr_Stock_Price:  97.24591905796233
curr_Factors:  [97.24591906]
mat_Sqrt:  [[0.15]]
grads:  [-0.00428434]
Stock Position:  -0.004284335658247344
Bond Position:  [3.45668201]


portfolio before change:  [3.03864325]
curr_Stock_Price:  97.62419385093135
curr_Factors:  [97.62419385]
mat_Sqrt:  [[0.15]]
grads:  [0.0551884]
Stock Position:  0.05518839864417304
Bond Position:  [-2.34907968]


portfolio before change:  [3.05668707]
curr_Stock_Price:  97.95380377462257
curr_Factors:  [97.95380377]
mat_Sqrt:  [[0.15]]
grads:  [0.01943333]
Stock Position:  0.019433325922508432
Bond Position:  [1.15311888]


portfolio before change:  [3.06526113]
curr_Stock_Price:  98.39129879163126
curr_Factors:  [98.39129879]
mat_Sqrt:  [[0.15]]
grads:  [-0.01315572]
Stock Position:  -0.013155720327975923
Bond Position:  [4.35966954]


portfolio before change:  [3.07016313]
curr_Stock_Price:  98.03939765476989
curr_Factors:  [98.03939765]
mat_Sqrt:  [[0.15]]
grads:  [-0.02041081]
Stock Position:  -0.02041080508133129
Bond Position:  [5.07122616]


portfolio before change:  [3.05997798]
curr_Stock_Price:  98.55393426113417
curr_Factors:  [98.55393426]
mat_Sqrt:  [[0.15]]
grads:  [-0.06561293]
Stock Position:  -0.06561293386860217
Bond Position:  [9.52639075]


portfolio before change:  [3.04753701]
curr_Stock_Price:  98.75262047036607
curr_Factors:  [98.75262047]
mat_Sqrt:  [[0.15]]
grads:  [-0.0470508]
Stock Position:  -0.04705080311252765
Bond Position:  [7.69392712]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.04753701]
Stock Price:  98.81997716889121
PL:  [3.04753701]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-5.65698461e-02]
 [ 1.34974763e-03]
 [-7.03307227e-04]
 [-2.20629163e-05]
 [-1.57498569e-02]
 [ 2.10746506e-03]
 [ 1.06136411e-03]
 [ 1.29850140e-02]
 [ 1.77098800e-02]
 [-1.62027805e-02]
 [ 1.01887028e-02]
 [-4.97564653e-03]
 [-9.66249596e-03]
 [ 4.26125666e-03]
 [ 6.69379986e-03]
 [ 3.88855843e-03]
 [ 3.89255953e-04]
 [ 1.01562748e-02]
 [ 2.30474335e-02]
 [ 1.74848443e-03]
 [ 6.75982030e-02]
 [-1.29790527e-02]
 [ 5.94182973e-03]
 [ 3.92569718e-04]
 [ 1.53358678e-02]
 [ 1.60194180e-02]
 [ 1.12169464e-02]
 [ 6.84058666e-03]
 [ 6.21654276e-03]
 [-1.99774463e-02]
 [-5.22377876e-03]
 [ 1.86305773e-02]
 [ 7.60787814e-03]
 [ 6.98807180e-04]
 [-5.34105638e-03]
 [-4.35408526e-03]
 [-6.94823320e-03]
 [ 3.34846950e-03]
 [ 1.37195270e-03]
 [-8.71256950e-03]
 [-1.75485198e-02]
 [-2.41480007e-03]
 [ 1.38180063e-02]
 [-1.28749987e-02]
 [-1.71951902e-03]
 [ 2.44919689e-03]
 [-1.36452754e-02]
 [-2.47088621e-03]
 [ 3.96717968e-03]
 [-3.57420340e-03]
 [-3.14309624e-03]
 [ 3.73164196e-03]
 [-2.58354056e-05]
 [-9.92494885e-04]
 [ 2.22236425e-03]
 [ 8.62863938e-03]
 [ 6.25938830e-03]
 [-2.51943174e-02]
 [ 1.38817834e-02]
 [-4.36296294e-05]
 [ 1.66036803e-03]
 [-1.73549613e-02]
 [-1.27332603e-02]
 [-1.27061140e-03]
 [-9.60279735e-03]
 [-1.53983513e-02]
 [ 9.55322476e-03]
 [ 2.23244806e-03]
 [ 1.01390130e-02]
 [-1.71620266e-02]
 [-2.08126860e-03]
 [-1.05556207e-03]
 [ 1.98726666e-03]
 [ 8.82310191e-03]
 [ 1.14415909e-02]
 [-8.35232646e-03]
 [-4.75765984e-03]
 [-8.90135045e-03]
 [-2.56055521e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.63657932]
curr_Stock_Price:  100.48653736930994
curr_Factors:  [100.48653737]
mat_Sqrt:  [[0.15]]
grads:  [-0.37713231]
Stock Position:  -0.37713230745754484
Bond Position:  [47.53329902]


portfolio before change:  [9.99307643]
curr_Stock_Price:  99.54913109684443
curr_Factors:  [99.5491311]
mat_Sqrt:  [[0.15]]
grads:  [0.00899832]
Stock Position:  0.008998317529842065
Bond Position:  [9.09730174]


portfolio before change:  [9.99002573]
curr_Stock_Price:  99.14691162431903
curr_Factors:  [99.14691162]
mat_Sqrt:  [[0.15]]
grads:  [-0.00468871]
Stock Position:  -0.004688714848672405
Bond Position:  [10.45489733]


portfolio before change:  [9.99089933]
curr_Stock_Price:  99.09995929572487
curr_Factors:  [99.0999593]
mat_Sqrt:  [[0.15]]
grads:  [-0.00014709]
Stock Position:  -0.00014708610865465124
Bond Position:  [10.00547556]


portfolio before change:  [9.9915881]
curr_Stock_Price:  98.6688806340227
curr_Factors:  [98.66888063]
mat_Sqrt:  [[0.15]]
grads:  [-0.10499905]
Stock Position:  -0.10499904581818298
Bond Position:  [20.35172641]


portfolio before change:  [10.07008968]
curr_Stock_Price:  97.93335430931045
curr_Factors:  [97.93335431]
mat_Sqrt:  [[0.15]]
grads:  [0.01404977]
Stock Position:  0.014049767043013469
Bond Position:  [8.69414887]


portfolio before change:  [10.07543471]
curr_Stock_Price:  98.27511293104766
curr_Factors:  [98.27511293]
mat_Sqrt:  [[0.15]]
grads:  [0.00707576]
Stock Position:  0.007075760752422819
Bond Position:  [9.38006352]


portfolio before change:  [10.0850453]
curr_Stock_Price:  99.55049830269945
curr_Factors:  [99.5504983]
mat_Sqrt:  [[0.15]]
grads:  [0.08656676]
Stock Position:  0.0865667601890066
Bond Position:  [1.46728119]


portfolio before change:  [10.05927432]
curr_Stock_Price:  99.25173823540251
curr_Factors:  [99.25173824]
mat_Sqrt:  [[0.15]]
grads:  [0.11806587]
Stock Position:  0.11806586660359923
Bond Position:  [-1.65896817]


portfolio before change:  [10.0214495]
curr_Stock_Price:  98.9322459534484
curr_Factors:  [98.93224595]
mat_Sqrt:  [[0.15]]
grads:  [-0.10801854]
Stock Position:  -0.10801853668103072
Bond Position:  [20.70796594]


portfolio before change:  [9.86959077]
curr_Stock_Price:  100.35008612950438
curr_Factors:  [100.35008613]
mat_Sqrt:  [[0.15]]
grads:  [0.06792469]
Stock Position:  0.06792468544877288
Bond Position:  [3.05334273]


portfolio before change:  [9.85243089]
curr_Stock_Price:  100.09464554279836
curr_Factors:  [100.09464554]
mat_Sqrt:  [[0.15]]
grads:  [-0.03317098]
Stock Position:  -0.03317097685581171
Bond Position:  [13.17266806]


portfolio before change:  [9.85644746]
curr_Stock_Price:  99.99837885179195
curr_Factors:  [99.99837885]
mat_Sqrt:  [[0.15]]
grads:  [-0.06441664]
Stock Position:  -0.06441663974009083
Bond Position:  [16.29800701]


portfolio before change:  [9.83575052]
curr_Stock_Price:  100.33549043463327
curr_Factors:  [100.33549043]
mat_Sqrt:  [[0.15]]
grads:  [0.02840838]
Stock Position:  0.02840837771462919
Bond Position:  [6.98538201]


portfolio before change:  [9.83587697]
curr_Stock_Price:  100.32457268550917
curr_Factors:  [100.32457269]
mat_Sqrt:  [[0.15]]
grads:  [0.04462533]
Stock Position:  0.044625332417131014
Bond Position:  [5.35885956]


portfolio before change:  [9.80708747]
curr_Stock_Price:  99.67192907633755
curr_Factors:  [99.67192908]
mat_Sqrt:  [[0.15]]
grads:  [0.02592372]
Stock Position:  0.025923722899324327
Bond Position:  [7.22322]


portfolio before change:  [9.79793095]
curr_Stock_Price:  99.30130387683118
curr_Factors:  [99.30130388]
mat_Sqrt:  [[0.15]]
grads:  [0.00259504]
Stock Position:  0.0025950396850441195
Bond Position:  [9.54024013]


portfolio before change:  [9.80035184]
curr_Stock_Price:  100.0044175916225
curr_Factors:  [100.00441759]
mat_Sqrt:  [[0.15]]
grads:  [0.0677085]
Stock Position:  0.06770849842170869
Bond Position:  [3.02920289]


portfolio before change:  [9.83365788]
curr_Stock_Price:  100.49352473967306
curr_Factors:  [100.49352474]
mat_Sqrt:  [[0.15]]
grads:  [0.15364956]
Stock Position:  0.15364955673524028
Bond Position:  [-5.60712765]


portfolio before change:  [9.88437038]
curr_Stock_Price:  100.82585860538575
curr_Factors:  [100.82585861]
mat_Sqrt:  [[0.15]]
grads:  [0.01165656]
Stock Position:  0.011656562869673292
Bond Position:  [8.70908742]


portfolio before change:  [9.89056828]
curr_Stock_Price:  101.3108696866768
curr_Factors:  [101.31086969]
mat_Sqrt:  [[0.15]]
grads:  [0.45065469]
Stock Position:  0.45065468693337823
Bond Position:  [-35.76564999]


portfolio before change:  [10.03586229]
curr_Stock_Price:  101.63823661112374
curr_Factors:  [101.63823661]
mat_Sqrt:  [[0.15]]
grads:  [-0.08652702]
Stock Position:  -0.08652701778850604
Bond Position:  [18.8303158]


portfolio before change:  [10.07350745]
curr_Stock_Price:  101.21677025465551
curr_Factors:  [101.21677025]
mat_Sqrt:  [[0.15]]
grads:  [0.0396122]
Stock Position:  0.03961219817135856
Bond Position:  [6.06408869]


portfolio before change:  [10.0760661]
curr_Stock_Price:  101.2717944539201
curr_Factors:  [101.27179445]
mat_Sqrt:  [[0.15]]
grads:  [0.00261713]
Stock Position:  0.0026171314508856612
Bond Position:  [9.8110245]


portfolio before change:  [10.07638843]
curr_Stock_Price:  101.16065215296173
curr_Factors:  [101.16065215]
mat_Sqrt:  [[0.15]]
grads:  [0.10223912]
Stock Position:  0.10223911896731763
Bond Position:  [-0.26618752]


portfolio before change:  [10.13675641]
curr_Stock_Price:  101.75127362587918
curr_Factors:  [101.75127363]
mat_Sqrt:  [[0.15]]
grads:  [0.10679612]
Stock Position:  0.1067961200579168
Bond Position:  [-0.72988482]


portfolio before change:  [10.14673464]
curr_Stock_Price:  101.84513330530022
curr_Factors:  [101.84513331]
mat_Sqrt:  [[0.15]]
grads:  [0.07477964]
Stock Position:  0.0747796428867918
Bond Position:  [2.53079195]


portfolio before change:  [10.15961336]
curr_Stock_Price:  102.01524023187311
curr_Factors:  [102.01524023]
mat_Sqrt:  [[0.15]]
grads:  [0.04560391]
Stock Position:  0.04560391105663926
Bond Position:  [5.50731942]


portfolio before change:  [10.18930938]
curr_Stock_Price:  102.65886497700207
curr_Factors:  [102.65886498]
mat_Sqrt:  [[0.15]]
grads:  [0.04144362]
Stock Position:  0.041443618432463115
Bond Position:  [5.93475455]


portfolio before change:  [10.16113924]
curr_Stock_Price:  101.97019250735592
curr_Factors:  [101.97019251]
mat_Sqrt:  [[0.15]]
grads:  [-0.13318298]
Stock Position:  -0.13318297523160422
Bond Position:  [23.74183286]


portfolio before change:  [10.26335805]
curr_Stock_Price:  101.21382780069705
curr_Factors:  [101.2138278]
mat_Sqrt:  [[0.15]]
grads:  [-0.03482519]
Stock Position:  -0.034825191741163566
Bond Position:  [13.78814901]


portfolio before change:  [10.25911617]
curr_Stock_Price:  101.36037884600361
curr_Factors:  [101.36037885]
mat_Sqrt:  [[0.15]]
grads:  [0.12420385]
Stock Position:  0.12420384835746655
Bond Position:  [-2.33023296]


portfolio before change:  [10.31021944]
curr_Stock_Price:  101.77299824198748
curr_Factors:  [101.77299824]
mat_Sqrt:  [[0.15]]
grads:  [0.05071919]
Stock Position:  0.05071918762832446
Bond Position:  [5.14837565]


portfolio before change:  [10.32902351]
curr_Stock_Price:  102.13740249349837
curr_Factors:  [102.13740249]
mat_Sqrt:  [[0.15]]
grads:  [0.00465871]
Stock Position:  0.004658714535119077
Bond Position:  [9.85319451]


portfolio before change:  [10.3328854]
curr_Stock_Price:  102.83417164212156
curr_Factors:  [102.83417164]
mat_Sqrt:  [[0.15]]
grads:  [-0.03560704]
Stock Position:  -0.035607042501330184
Bond Position:  [13.99450612]


portfolio before change:  [10.35538632]
curr_Stock_Price:  102.22681330038057
curr_Factors:  [102.2268133]
mat_Sqrt:  [[0.15]]
grads:  [-0.02902724]
Stock Position:  -0.02902723509685647
Bond Position:  [13.32274806]


portfolio before change:  [10.36078792]
curr_Stock_Price:  102.0694128861047
curr_Factors:  [102.06941289]
mat_Sqrt:  [[0.15]]
grads:  [-0.04632155]
Stock Position:  -0.04632155467139857
Bond Position:  [15.08880181]


portfolio before change:  [10.31951312]
curr_Stock_Price:  102.98082172763266
curr_Factors:  [102.98082173]
mat_Sqrt:  [[0.15]]
grads:  [0.02232313]
Stock Position:  0.022323130000971882
Bond Position:  [8.02065885]


portfolio before change:  [10.30177681]
curr_Stock_Price:  102.16383879413777
curr_Factors:  [102.16383879]
mat_Sqrt:  [[0.15]]
grads:  [0.00914635]
Stock Position:  0.009146351329148743
Bond Position:  [9.36735045]


portfolio before change:  [10.29980504]
curr_Stock_Price:  101.8842456914807
curr_Factors:  [101.88424569]
mat_Sqrt:  [[0.15]]
grads:  [-0.0580838]
Stock Position:  -0.058083796661150454
Bond Position:  [16.21762885]


portfolio before change:  [10.32080509]
curr_Stock_Price:  101.54014935837496
curr_Factors:  [101.54014936]
mat_Sqrt:  [[0.15]]
grads:  [-0.11699013]
Stock Position:  -0.11699013198563055
Bond Position:  [22.20000057]


portfolio before change:  [10.23953055]
curr_Stock_Price:  102.24672246897987
curr_Factors:  [102.24672247]
mat_Sqrt:  [[0.15]]
grads:  [-0.01609867]
Stock Position:  -0.01609866712178354
Bond Position:  [11.8855665]


portfolio before change:  [10.22173907]
curr_Stock_Price:  103.39801986843027
curr_Factors:  [103.39801987]
mat_Sqrt:  [[0.15]]
grads:  [0.09212004]
Stock Position:  0.09212004230371748
Bond Position:  [0.69670911]


portfolio before change:  [10.23437785]
curr_Stock_Price:  103.53474620920665
curr_Factors:  [103.53474621]
mat_Sqrt:  [[0.15]]
grads:  [-0.08583332]
Stock Position:  -0.08583332487788366
Bond Position:  [19.12110936]


portfolio before change:  [10.2282217]
curr_Stock_Price:  103.62039195482302
curr_Factors:  [103.62039195]
mat_Sqrt:  [[0.15]]
grads:  [-0.01146346]
Stock Position:  -0.011463460103850793
Bond Position:  [11.41606993]


portfolio before change:  [10.23301149]
curr_Stock_Price:  103.26480456915412
curr_Factors:  [103.26480457]
mat_Sqrt:  [[0.15]]
grads:  [0.01632798]
Stock Position:  0.016327979291618628
Bond Position:  [8.5469059]


portfolio before change:  [10.22014536]
curr_Stock_Price:  102.44410737901642
curr_Factors:  [102.44410738]
mat_Sqrt:  [[0.15]]
grads:  [-0.0909685]
Stock Position:  -0.09096850290488322
Bond Position:  [19.53933244]


portfolio before change:  [10.2679739]
curr_Stock_Price:  101.93176200173299
curr_Factors:  [101.931762]
mat_Sqrt:  [[0.15]]
grads:  [-0.01647257]
Stock Position:  -0.016472574720490026
Bond Position:  [11.94705246]


portfolio before change:  [10.25894054]
curr_Stock_Price:  102.52548031920604
curr_Factors:  [102.52548032]
mat_Sqrt:  [[0.15]]
grads:  [0.02644786]
Stock Position:  0.026447864524830438
Bond Position:  [7.54736053]


portfolio before change:  [10.25303527]
curr_Stock_Price:  102.28436441335484
curr_Factors:  [102.28436441]
mat_Sqrt:  [[0.15]]
grads:  [-0.02382802]
Stock Position:  -0.023828022678658554
Bond Position:  [12.69026942]


portfolio before change:  [10.26274219]
curr_Stock_Price:  101.91027742795741
curr_Factors:  [101.91027743]
mat_Sqrt:  [[0.15]]
grads:  [-0.02095397]
Stock Position:  -0.020953974901968198
Bond Position:  [12.39816758]


portfolio before change:  [10.26996482]
curr_Stock_Price:  101.60256836111292
curr_Factors:  [101.60256836]
mat_Sqrt:  [[0.15]]
grads:  [0.02487761]
Stock Position:  0.024877613055481862
Bond Position:  [7.74233544]


portfolio before change:  [10.2576271]
curr_Stock_Price:  101.08717970344756
curr_Factors:  [101.0871797]
mat_Sqrt:  [[0.15]]
grads:  [-0.00017224]
Stock Position:  -0.00017223603737725272
Bond Position:  [10.27503795]


portfolio before change:  [10.25834793]
curr_Stock_Price:  100.63068929652258
curr_Factors:  [100.6306893]
mat_Sqrt:  [[0.15]]
grads:  [-0.00661663]
Stock Position:  -0.006616632563339256
Bond Position:  [10.92418423]


portfolio before change:  [10.2625892]
curr_Stock_Price:  100.09287910791721
curr_Factors:  [100.09287911]
mat_Sqrt:  [[0.15]]
grads:  [0.01481576]
Stock Position:  0.014815761690275948
Bond Position:  [8.77963696]


portfolio before change:  [10.26806216]
curr_Stock_Price:  100.42524238409104
curr_Factors:  [100.42524238]
mat_Sqrt:  [[0.15]]
grads:  [0.05752426]
Stock Position:  0.057524262557983596
Bond Position:  [4.49117415]


portfolio before change:  [10.25812317]
curr_Stock_Price:  100.24758349295205
curr_Factors:  [100.24758349]
mat_Sqrt:  [[0.15]]
grads:  [0.04172926]
Stock Position:  0.041729255353791836
Bond Position:  [6.07486616]


portfolio before change:  [10.20977464]
curr_Stock_Price:  99.07986009221743
curr_Factors:  [99.07986009]
mat_Sqrt:  [[0.15]]
grads:  [-0.16796212]
Stock Position:  -0.16796211611807393
Bond Position:  [26.8514376]


portfolio before change:  [10.26763517]
curr_Stock_Price:  98.74536641165045
curr_Factors:  [98.74536641]
mat_Sqrt:  [[0.15]]
grads:  [0.09254522]
Stock Position:  0.09254522293465621
Bond Position:  [1.12922322]


portfolio before change:  [10.1606403]
curr_Stock_Price:  97.58846764697329
curr_Factors:  [97.58846765]
mat_Sqrt:  [[0.15]]
grads:  [-0.00029086]
Stock Position:  -0.00029086419627596775
Bond Position:  [10.18902529]


portfolio before change:  [10.16138593]
curr_Stock_Price:  97.21439799077997
curr_Factors:  [97.21439799]
mat_Sqrt:  [[0.15]]
grads:  [0.01106912]
Stock Position:  0.011069120181915738
Bond Position:  [9.08530808]


portfolio before change:  [10.15972031]
curr_Stock_Price:  97.01262292469539
curr_Factors:  [97.01262292]
mat_Sqrt:  [[0.15]]
grads:  [-0.11569974]
Stock Position:  -0.11569974228887184
Bond Position:  [21.38405578]


portfolio before change:  [10.15690184]
curr_Stock_Price:  97.04853498775712
curr_Factors:  [97.04853499]
mat_Sqrt:  [[0.15]]
grads:  [-0.0848884]
Stock Position:  -0.08488840187673713
Bond Position:  [18.39519688]


portfolio before change:  [10.14516099]
curr_Stock_Price:  97.20038826424141
curr_Factors:  [97.20038826]
mat_Sqrt:  [[0.15]]
grads:  [-0.00847074]
Stock Position:  -0.008470742663055168
Bond Position:  [10.96852047]


portfolio before change:  [10.14669483]
curr_Stock_Price:  97.10024550012828
curr_Factors:  [97.1002455]
mat_Sqrt:  [[0.15]]
grads:  [-0.06401865]
Stock Position:  -0.06401864902266265
Bond Position:  [16.36292137]


portfolio before change:  [10.14955185]
curr_Stock_Price:  97.07159289847533
curr_Factors:  [97.0715929]
mat_Sqrt:  [[0.15]]
grads:  [-0.10265568]
Stock Position:  -0.10265567503304865
Bond Position:  [20.11450174]


portfolio before change:  [10.16441269]
curr_Stock_Price:  96.9390756503702
curr_Factors:  [96.93907565]
mat_Sqrt:  [[0.15]]
grads:  [0.06368817]
Stock Position:  0.063688165092813
Bond Position:  [3.99054084]


portfolio before change:  [10.19921938]
curr_Stock_Price:  97.48167677076427
curr_Factors:  [97.48167677]
mat_Sqrt:  [[0.15]]
grads:  [0.01488299]
Stock Position:  0.014882987097816594
Bond Position:  [8.74840084]


portfolio before change:  [10.20375037]
curr_Stock_Price:  97.74937874077442
curr_Factors:  [97.74937874]
mat_Sqrt:  [[0.15]]
grads:  [0.06759342]
Stock Position:  0.06759342010946127
Bond Position:  [3.59653555]


portfolio before change:  [10.22859032]
curr_Stock_Price:  98.1135436841294
curr_Factors:  [98.11354368]
mat_Sqrt:  [[0.15]]
grads:  [-0.11441351]
Stock Position:  -0.11441351038017337
Bond Position:  [21.45410527]


portfolio before change:  [10.19716868]
curr_Stock_Price:  98.39989589557288
curr_Factors:  [98.3998959]
mat_Sqrt:  [[0.15]]
grads:  [-0.01387512]
Stock Position:  -0.013875123974588137
Bond Position:  [11.56247943]


portfolio before change:  [10.18735396]
curr_Stock_Price:  99.159340922556
curr_Factors:  [99.15934092]
mat_Sqrt:  [[0.15]]
grads:  [-0.00703708]
Stock Position:  -0.007037080450644547
Bond Position:  [10.88514622]


portfolio before change:  [10.18362048]
curr_Stock_Price:  99.7865645328904
curr_Factors:  [99.78656453]
mat_Sqrt:  [[0.15]]
grads:  [0.01324844]
Stock Position:  0.013248444430429255
Bond Position:  [8.86160373]


portfolio before change:  [10.18744346]
curr_Stock_Price:  100.03331884402431
curr_Factors:  [100.03331884]
mat_Sqrt:  [[0.15]]
grads:  [0.05882068]
Stock Position:  0.05882067937857454
Bond Position:  [4.30341569]


portfolio before change:  [10.19458288]
curr_Stock_Price:  100.15012215252375
curr_Factors:  [100.15012215]
mat_Sqrt:  [[0.15]]
grads:  [0.07627727]
Stock Position:  0.0762772724559027
Bond Position:  [2.55540473]


portfolio before change:  [10.18258822]
curr_Stock_Price:  99.99077737852893
curr_Factors:  [99.99077738]
mat_Sqrt:  [[0.15]]
grads:  [-0.05568218]
Stock Position:  -0.05568217638783515
Bond Position:  [15.75029232]


portfolio before change:  [10.22817967]
curr_Stock_Price:  99.1896767574898
curr_Factors:  [99.18967676]
mat_Sqrt:  [[0.15]]
grads:  [-0.03171773]
Stock Position:  -0.03171773224098695
Bond Position:  [13.37425127]


portfolio before change:  [10.23176697]
curr_Stock_Price:  99.10293067348138
curr_Factors:  [99.10293067]
mat_Sqrt:  [[0.15]]
grads:  [-0.05934234]
Stock Position:  -0.05934233631563101
Bond Position:  [16.11276641]


portfolio before change:  [10.20721171]
curr_Stock_Price:  99.53369133974755
curr_Factors:  [99.53369134]
mat_Sqrt:  [[0.15]]
grads:  [-0.01707037]
Stock Position:  -0.017070368079843922
Bond Position:  [11.90628845]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.20721171]
Stock Price:  99.15734743020275
PL:  [10.20721171]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-2.89507287e-02]
 [-2.37162258e-03]
 [-1.46382837e-04]
 [ 8.35934564e-04]
 [ 1.25027125e-02]
 [ 1.04248275e-02]
 [ 7.17122924e-04]
 [ 9.44358144e-03]
 [ 4.25906892e-03]
 [ 5.62399216e-02]
 [ 1.05131676e-02]
 [-1.24332509e-02]
 [ 1.12592661e-02]
 [ 7.26128602e-03]
 [-3.13626493e-02]
 [ 1.72120954e-02]
 [-3.01108784e-03]
 [ 1.61517017e-03]
 [ 1.59291362e-02]
 [ 1.18674779e-02]
 [ 1.02046348e-02]
 [-2.56192181e-02]
 [-1.05225643e-03]
 [ 1.40960725e-02]
 [ 3.85921215e-03]
 [ 5.42424718e-03]
 [ 1.22740240e-02]
 [-8.93658225e-03]
 [ 1.60873849e-03]
 [-9.61757618e-03]
 [-3.72801284e-03]
 [-2.04644131e-02]
 [ 1.54609056e-02]
 [ 1.61709213e-02]
 [-3.58932326e-03]
 [ 1.01448267e-05]
 [-5.35443027e-03]
 [ 1.42050010e-02]
 [-1.78450039e-03]
 [-1.38834107e-02]
 [-2.00857811e-03]
 [-2.83486865e-03]
 [ 8.49645955e-03]
 [-1.42820311e-02]
 [ 6.33636540e-04]
 [ 2.31087600e-03]
 [-1.36400526e-02]
 [ 6.17532302e-03]
 [ 1.10880426e-02]
 [-1.01928976e-02]
 [-4.08680978e-03]
 [ 3.52991718e-03]
 [ 2.87323850e-03]
 [ 1.63400367e-03]
 [-6.80695074e-03]
 [ 1.05857319e-02]
 [-1.38822177e-02]
 [-7.87786142e-03]
 [ 1.83502297e-02]
 [-5.60420907e-03]
 [ 1.30742613e-02]
 [-1.39396331e-02]
 [-1.27000220e-02]
 [-2.90361869e-03]
 [ 5.55460741e-02]
 [-1.53590782e-02]
 [ 8.53245662e-03]
 [ 5.26625493e-03]
 [ 1.37745041e-02]
 [-2.34299239e-02]
 [-8.00252659e-03]
 [-7.12216854e-03]
 [ 4.73834988e-03]
 [ 7.15281858e-03]
 [-8.65474538e-04]
 [-6.27587972e-03]
 [ 6.14045999e-03]
 [-4.95337462e-03]
 [ 2.11392232e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.99579052]
curr_Stock_Price:  99.09621069122424
curr_Factors:  [99.09621069]
mat_Sqrt:  [[0.15]]
grads:  [-0.19300486]
Stock Position:  -0.19300485779728496
Bond Position:  [7.13025953]


portfolio before change:  [-12.17883054]
curr_Stock_Price:  100.04688974164654
curr_Factors:  [100.04688974]
mat_Sqrt:  [[0.15]]
grads:  [-0.01581082]
Stock Position:  -0.01581081722262431
Bond Position:  [-10.59700745]


portfolio before change:  [-12.17162792]
curr_Stock_Price:  99.54944827522387
curr_Factors:  [99.54944828]
mat_Sqrt:  [[0.15]]
grads:  [-0.00097589]
Stock Position:  -0.0009758855831040805
Bond Position:  [-12.07447905]


portfolio before change:  [-12.17222581]
curr_Stock_Price:  99.38878704871837
curr_Factors:  [99.38878705]
mat_Sqrt:  [[0.15]]
grads:  [0.0055729]
Stock Position:  0.0055728970960595954
Bond Position:  [-12.72610929]


portfolio before change:  [-12.17135878]
curr_Stock_Price:  99.68709373248596
curr_Factors:  [99.68709373]
mat_Sqrt:  [[0.15]]
grads:  [0.08335142]
Stock Position:  0.083351416994577
Bond Position:  [-20.4804193]


portfolio before change:  [-12.19406142]
curr_Stock_Price:  99.43007869924111
curr_Factors:  [99.4300787]
mat_Sqrt:  [[0.15]]
grads:  [0.06949885]
Stock Position:  0.06949884982433388
Bond Position:  [-19.10433752]


portfolio before change:  [-12.25673799]
curr_Stock_Price:  98.54542362792803
curr_Factors:  [98.54542363]
mat_Sqrt:  [[0.15]]
grads:  [0.00478082]
Stock Position:  0.004780819491146234
Bond Position:  [-12.72786587]


portfolio before change:  [-12.25754635]
curr_Stock_Price:  98.5427358221864
curr_Factors:  [98.54273582]
mat_Sqrt:  [[0.15]]
grads:  [0.06295721]
Stock Position:  0.06295720961300824
Bond Position:  [-18.46152203]


portfolio before change:  [-12.31007794]
curr_Stock_Price:  97.72666237473474
curr_Factors:  [97.72666237]
mat_Sqrt:  [[0.15]]
grads:  [0.02839379]
Stock Position:  0.028393792797013602
Bond Position:  [-15.08490854]


portfolio before change:  [-12.33987867]
curr_Stock_Price:  96.71031728273987
curr_Factors:  [96.71031728]
mat_Sqrt:  [[0.15]]
grads:  [0.37493281]
Stock Position:  0.3749328107296416
Bond Position:  [-48.59974975]


portfolio before change:  [-12.47426695]
curr_Stock_Price:  96.35998596597823
curr_Factors:  [96.35998597]
mat_Sqrt:  [[0.15]]
grads:  [0.07008778]
Stock Position:  0.0700877842640736
Bond Position:  [-19.22792486]


portfolio before change:  [-12.43920003]
curr_Stock_Price:  96.87746133744817
curr_Factors:  [96.87746134]
mat_Sqrt:  [[0.15]]
grads:  [-0.08288834]
Stock Position:  -0.082888339618019
Bond Position:  [-4.40918812]


portfolio before change:  [-12.45983686]
curr_Stock_Price:  97.12310797775251
curr_Factors:  [97.12310798]
mat_Sqrt:  [[0.15]]
grads:  [0.07506177]
Stock Position:  0.07506177376253405
Bond Position:  [-19.75006962]


portfolio before change:  [-12.46239034]
curr_Stock_Price:  97.1055349760698
curr_Factors:  [97.10553498]
mat_Sqrt:  [[0.15]]
grads:  [0.04840857]
Stock Position:  0.04840857347059388
Bond Position:  [-17.16313076]


portfolio before change:  [-12.4686066]
curr_Stock_Price:  96.99928246670835
curr_Factors:  [96.99928247]
mat_Sqrt:  [[0.15]]
grads:  [-0.20908433]
Stock Position:  -0.20908432840225796
Bond Position:  [7.81242323]


portfolio before change:  [-12.55413883]
curr_Stock_Price:  97.41069791881566
curr_Factors:  [97.41069792]
mat_Sqrt:  [[0.15]]
grads:  [0.1147473]
Stock Position:  0.11474730271020006
Bond Position:  [-23.73175367]


portfolio before change:  [-12.49681819]
curr_Stock_Price:  97.92316240300148
curr_Factors:  [97.9231624]
mat_Sqrt:  [[0.15]]
grads:  [-0.02007392]
Stock Position:  -0.02007391890304161
Bond Position:  [-10.53111657]


portfolio before change:  [-12.50140197]
curr_Stock_Price:  98.11871747332397
curr_Factors:  [98.11871747]
mat_Sqrt:  [[0.15]]
grads:  [0.0107678]
Stock Position:  0.010767801132462406
Bond Position:  [-13.5579248]


portfolio before change:  [-12.49587748]
curr_Stock_Price:  98.71047063063386
curr_Factors:  [98.71047063]
mat_Sqrt:  [[0.15]]
grads:  [0.10619424]
Stock Position:  0.1061942416130664
Bond Position:  [-22.97836105]


portfolio before change:  [-12.47372791]
curr_Stock_Price:  98.93257089363586
curr_Factors:  [98.93257089]
mat_Sqrt:  [[0.15]]
grads:  [0.07911652]
Stock Position:  0.07911651902088447
Bond Position:  [-20.30092853]


portfolio before change:  [-12.5376919]
curr_Stock_Price:  98.14013020347521
curr_Factors:  [98.1401302]
mat_Sqrt:  [[0.15]]
grads:  [0.0680309]
Stock Position:  0.06803089889765335
Bond Position:  [-19.21425318]


portfolio before change:  [-12.59813189]
curr_Stock_Price:  97.26936317416877
curr_Factors:  [97.26936317]
mat_Sqrt:  [[0.15]]
grads:  [-0.17079479]
Stock Position:  -0.17079478727178488
Bond Position:  [4.0149683]


portfolio before change:  [-12.80917318]
curr_Stock_Price:  98.50647488223878
curr_Factors:  [98.50647488]
mat_Sqrt:  [[0.15]]
grads:  [-0.00701504]
Stock Position:  -0.007015042890037935
Bond Position:  [-12.11814604]


portfolio before change:  [-12.8127039]
curr_Stock_Price:  98.901811974682
curr_Factors:  [98.90181197]
mat_Sqrt:  [[0.15]]
grads:  [0.09397382]
Stock Position:  0.0939738169555582
Bond Position:  [-22.10688467]


portfolio before change:  [-12.86277849]
curr_Stock_Price:  98.38365839585664
curr_Factors:  [98.3836584]
mat_Sqrt:  [[0.15]]
grads:  [0.02572808]
Stock Position:  0.02572808099168704
Bond Position:  [-15.39400122]


portfolio before change:  [-12.85453337]
curr_Stock_Price:  98.741527191147
curr_Factors:  [98.74152719]
mat_Sqrt:  [[0.15]]
grads:  [0.03616165]
Stock Position:  0.03616164787860389
Bond Position:  [-16.42518971]


portfolio before change:  [-12.83833237]
curr_Stock_Price:  99.21793261244062
curr_Factors:  [99.21793261]
mat_Sqrt:  [[0.15]]
grads:  [0.08182683]
Stock Position:  0.08182682692539453
Bond Position:  [-20.95702097]


portfolio before change:  [-12.84369357]
curr_Stock_Price:  99.16842138963096
curr_Factors:  [99.16842139]
mat_Sqrt:  [[0.15]]
grads:  [-0.05957721]
Stock Position:  -0.059577214994471286
Bond Position:  [-6.93551521]


portfolio before change:  [-12.78625103]
curr_Stock_Price:  98.196975740196
curr_Factors:  [98.19697574]
mat_Sqrt:  [[0.15]]
grads:  [0.01072492]
Stock Position:  0.01072492323630164
Bond Position:  [-13.83940605]


portfolio before change:  [-12.78370646]
curr_Stock_Price:  98.51488536988465
curr_Factors:  [98.51488537]
mat_Sqrt:  [[0.15]]
grads:  [-0.06411717]
Stock Position:  -0.06411717452904579
Bond Position:  [-6.46721036]


portfolio before change:  [-12.79403268]
curr_Stock_Price:  98.66963342673023
curr_Factors:  [98.66963343]
mat_Sqrt:  [[0.15]]
grads:  [-0.02485342]
Stock Position:  -0.0248534189074164
Bond Position:  [-10.34175495]


portfolio before change:  [-12.80152236]
curr_Stock_Price:  98.94497983481969
curr_Factors:  [98.94497983]
mat_Sqrt:  [[0.15]]
grads:  [-0.13642942]
Stock Position:  -0.13642942068057384
Bond Position:  [0.69748392]


portfolio before change:  [-12.80473466]
curr_Stock_Price:  98.96884483991582
curr_Factors:  [98.96884484]
mat_Sqrt:  [[0.15]]
grads:  [0.1030727]
Stock Position:  0.10307270368065881
Bond Position:  [-23.00572107]


portfolio before change:  [-12.69530812]
curr_Stock_Price:  100.04443943170368
curr_Factors:  [100.04443943]
mat_Sqrt:  [[0.15]]
grads:  [0.10780614]
Stock Position:  0.1078061418312346
Bond Position:  [-23.48071314]


portfolio before change:  [-12.73833402]
curr_Stock_Price:  99.65894824433855
curr_Factors:  [99.65894824]
mat_Sqrt:  [[0.15]]
grads:  [-0.02392882]
Stock Position:  -0.023928821719062753
Bond Position:  [-10.35361282]


portfolio before change:  [-12.75041342]
curr_Stock_Price:  100.13671000270834
curr_Factors:  [100.13671]
mat_Sqrt:  [[0.15]]
grads:  [6.76321779e-05]
Stock Position:  6.76321778841626e-05
Bond Position:  [-12.75718589]


portfolio before change:  [-12.75118044]
curr_Stock_Price:  100.58523809382194
curr_Factors:  [100.58523809]
mat_Sqrt:  [[0.15]]
grads:  [-0.0356962]
Stock Position:  -0.035696201830304156
Bond Position:  [-9.16066948]


portfolio before change:  [-12.75278402]
curr_Stock_Price:  100.61412130299739
curr_Factors:  [100.6141213]
mat_Sqrt:  [[0.15]]
grads:  [0.09470001]
Stock Position:  0.0947000063965132
Bond Position:  [-22.28094195]


portfolio before change:  [-12.80895073]
curr_Stock_Price:  100.03572527740468
curr_Factors:  [100.03572528]
mat_Sqrt:  [[0.15]]
grads:  [-0.01189667]
Stock Position:  -0.011896669291739041
Bond Position:  [-11.61885878]


portfolio before change:  [-12.80859084]
curr_Stock_Price:  99.94443215355366
curr_Factors:  [99.94443215]
mat_Sqrt:  [[0.15]]
grads:  [-0.09255607]
Stock Position:  -0.09255607144818874
Bond Position:  [-3.55812684]


portfolio before change:  [-12.80548472]
curr_Stock_Price:  99.90846999658288
curr_Factors:  [99.90847]
mat_Sqrt:  [[0.15]]
grads:  [-0.01339052]
Stock Position:  -0.013390520752261242
Bond Position:  [-11.46765828]


portfolio before change:  [-12.8031361]
curr_Stock_Price:  99.6795489979926
curr_Factors:  [99.679549]
mat_Sqrt:  [[0.15]]
grads:  [-0.01889912]
Stock Position:  -0.018899124358782774
Bond Position:  [-10.9192799]


portfolio before change:  [-12.82670146]
curr_Stock_Price:  100.89033962158325
curr_Factors:  [100.89033962]
mat_Sqrt:  [[0.15]]
grads:  [0.05664306]
Stock Position:  0.056643063645416235
Bond Position:  [-18.54143938]


portfolio before change:  [-12.81396905]
curr_Stock_Price:  101.1355820014167
curr_Factors:  [101.135582]
mat_Sqrt:  [[0.15]]
grads:  [-0.09521354]
Stock Position:  -0.09521354076267206
Bond Position:  [-3.18449219]


portfolio before change:  [-12.87929184]
curr_Stock_Price:  101.81955770262344
curr_Factors:  [101.8195577]
mat_Sqrt:  [[0.15]]
grads:  [0.00422424]
Stock Position:  0.004224243597935741
Bond Position:  [-13.30940245]


portfolio before change:  [-12.87725484]
curr_Stock_Price:  102.49869969187867
curr_Factors:  [102.49869969]
mat_Sqrt:  [[0.15]]
grads:  [0.01540584]
Stock Position:  0.015405840026198037
Bond Position:  [-14.45633341]


portfolio before change:  [-12.87510246]
curr_Stock_Price:  102.69706131856265
curr_Factors:  [102.69706132]
mat_Sqrt:  [[0.15]]
grads:  [-0.09093368]
Stock Position:  -0.09093368399589878
Bond Position:  [-3.53648034]


portfolio before change:  [-12.95383068]
curr_Stock_Price:  103.56040680942715
curr_Factors:  [103.56040681]
mat_Sqrt:  [[0.15]]
grads:  [0.04116882]
Stock Position:  0.04116882014260457
Bond Position:  [-17.21729045]


portfolio before change:  [-12.94418542]
curr_Stock_Price:  103.82083142175425
curr_Factors:  [103.82083142]
mat_Sqrt:  [[0.15]]
grads:  [0.07392028]
Stock Position:  0.07392028375120116
Bond Position:  [-20.61865074]


portfolio before change:  [-12.95398491]
curr_Stock_Price:  103.7056968446603
curr_Factors:  [103.70569684]
mat_Sqrt:  [[0.15]]
grads:  [-0.06795265]
Stock Position:  -0.0679526509154711
Bond Position:  [-5.9069079]


portfolio before change:  [-13.0089597]
curr_Stock_Price:  104.50927984568385
curr_Factors:  [104.50927985]
mat_Sqrt:  [[0.15]]
grads:  [-0.0272454]
Stock Position:  -0.027245398543805033
Bond Position:  [-10.16156272]


portfolio before change:  [-13.02191022]
curr_Stock_Price:  104.96129747497537
curr_Factors:  [104.96129747]
mat_Sqrt:  [[0.15]]
grads:  [0.02353278]
Stock Position:  0.023532781223389115
Bond Position:  [-15.49194147]


portfolio before change:  [-13.03394241]
curr_Stock_Price:  104.49114843651809
curr_Factors:  [104.49114844]
mat_Sqrt:  [[0.15]]
grads:  [0.01915492]
Stock Position:  0.019154923359079038
Bond Position:  [-15.03546235]


portfolio before change:  [-13.05121037]
curr_Stock_Price:  103.63871918932095
curr_Factors:  [103.63871919]
mat_Sqrt:  [[0.15]]
grads:  [0.01089336]
Stock Position:  0.010893357769260936
Bond Position:  [-14.18018402]


portfolio before change:  [-13.04984797]
curr_Stock_Price:  103.8451467257949
curr_Factors:  [103.84514673]
mat_Sqrt:  [[0.15]]
grads:  [-0.04537967]
Stock Position:  -0.04537967161556534
Bond Position:  [-8.33738931]


portfolio before change:  [-13.06421042]
curr_Stock_Price:  104.15015882065832
curr_Factors:  [104.15015882]
mat_Sqrt:  [[0.15]]
grads:  [0.07057155]
Stock Position:  0.07057154576220674
Bond Position:  [-20.41424812]


portfolio before change:  [-13.0644686]
curr_Stock_Price:  104.16458033732155
curr_Factors:  [104.16458034]
mat_Sqrt:  [[0.15]]
grads:  [-0.09254812]
Stock Position:  -0.09254811823671871
Bond Position:  [-3.42423271]


portfolio before change:  [-13.10238279]
curr_Stock_Price:  104.57193778757423
curr_Factors:  [104.57193779]
mat_Sqrt:  [[0.15]]
grads:  [-0.05251908]
Stock Position:  -0.05251907613585116
Bond Position:  [-7.61036123]


portfolio before change:  [-13.13725909]
curr_Stock_Price:  105.22694994772408
curr_Factors:  [105.22694995]
mat_Sqrt:  [[0.15]]
grads:  [0.12233486]
Stock Position:  0.12233486460111002
Bond Position:  [-26.01018376]


portfolio before change:  [-13.09121662]
curr_Stock_Price:  105.61660304347667
curr_Factors:  [105.61660304]
mat_Sqrt:  [[0.15]]
grads:  [-0.03736139]
Stock Position:  -0.03736139382925926
Bond Position:  [-9.14523311]


portfolio before change:  [-13.08098822]
curr_Stock_Price:  105.32753489271857
curr_Factors:  [105.32753489]
mat_Sqrt:  [[0.15]]
grads:  [0.08716174]
Stock Position:  0.08716174183046646
Bond Position:  [-22.26151963]


portfolio before change:  [-13.00756666]
curr_Stock_Price:  106.18585816060575
curr_Factors:  [106.18585816]
mat_Sqrt:  [[0.15]]
grads:  [-0.09293089]
Stock Position:  -0.09293088759957709
Bond Position:  [-3.13962061]


portfolio before change:  [-13.02349554]
curr_Stock_Price:  106.35515220964163
curr_Factors:  [106.35515221]
mat_Sqrt:  [[0.15]]
grads:  [-0.08466681]
Stock Position:  -0.08466681301072286
Bond Position:  [-4.01874375]


portfolio before change:  [-12.99495177]
curr_Stock_Price:  106.01505505344971
curr_Factors:  [106.01505505]
mat_Sqrt:  [[0.15]]
grads:  [-0.01935746]
Stock Position:  -0.01935745794324342
Bond Position:  [-10.94276981]


portfolio before change:  [-12.9800699]
curr_Stock_Price:  105.21093004044586
curr_Factors:  [105.21093004]
mat_Sqrt:  [[0.15]]
grads:  [0.37030716]
Stock Position:  0.37030716099348665
Bond Position:  [-51.94043071]


portfolio before change:  [-12.75988128]
curr_Stock_Price:  105.81430750972102
curr_Factors:  [105.81430751]
mat_Sqrt:  [[0.15]]
grads:  [-0.10239385]
Stock Position:  -0.102393854867546
Bond Position:  [-1.92514644]


portfolio before change:  [-12.80675125]
curr_Stock_Price:  106.27087433873406
curr_Factors:  [106.27087434]
mat_Sqrt:  [[0.15]]
grads:  [0.05688304]
Stock Position:  0.056883044113647634
Bond Position:  [-18.85176208]


portfolio before change:  [-12.83119993]
curr_Stock_Price:  105.8617821693309
curr_Factors:  [105.86178217]
mat_Sqrt:  [[0.15]]
grads:  [0.03510837]
Stock Position:  0.035108366172946354
Bond Position:  [-16.54783414]


portfolio before change:  [-12.81423228]
curr_Stock_Price:  106.37453521435752
curr_Factors:  [106.37453521]
mat_Sqrt:  [[0.15]]
grads:  [0.09183003]
Stock Position:  0.09183002753442085
Bond Position:  [-22.58260877]


portfolio before change:  [-12.95127468]
curr_Stock_Price:  104.89755699649086
curr_Factors:  [104.897557]
mat_Sqrt:  [[0.15]]
grads:  [-0.15619949]
Stock Position:  -0.15619949275621045
Bond Position:  [3.43367051]


portfolio before change:  [-12.9283384]
curr_Stock_Price:  104.7520912828059
curr_Factors:  [104.75209128]
mat_Sqrt:  [[0.15]]
grads:  [-0.05335018]
Stock Position:  -0.05335017729871015
Bond Position:  [-7.33979576]


portfolio before change:  [-12.88751688]
curr_Stock_Price:  103.9783305780985
curr_Factors:  [103.97833058]
mat_Sqrt:  [[0.15]]
grads:  [-0.04748112]
Stock Position:  -0.047481123629295525
Bond Position:  [-7.95050891]


portfolio before change:  [-12.86762007]
curr_Stock_Price:  103.54881811203045
curr_Factors:  [103.54881811]
mat_Sqrt:  [[0.15]]
grads:  [0.031589]
Stock Position:  0.03158899918390446
Bond Position:  [-16.1386236]


portfolio before change:  [-12.87047534]
curr_Stock_Price:  103.49036200504486
curr_Factors:  [103.49036201]
mat_Sqrt:  [[0.15]]
grads:  [0.04768546]
Stock Position:  0.04768545721275276
Bond Position:  [-17.80546057]


portfolio before change:  [-12.86202599]
curr_Stock_Price:  103.69088909776622
curr_Factors:  [103.6908891]
mat_Sqrt:  [[0.15]]
grads:  [-0.00576983]
Stock Position:  -0.0057698302541527085
Bond Position:  [-12.26374716]


portfolio before change:  [-12.86315824]
curr_Stock_Price:  103.754279035668
curr_Factors:  [103.75427904]
mat_Sqrt:  [[0.15]]
grads:  [-0.0418392]
Stock Position:  -0.04183919810601819
Bond Position:  [-8.52216241]


portfolio before change:  [-12.82682703]
curr_Stock_Price:  102.87319467245631
curr_Factors:  [102.87319467]
mat_Sqrt:  [[0.15]]
grads:  [0.0409364]
Stock Position:  0.040936399940100475
Bond Position:  [-17.03808527]


portfolio before change:  [-12.85550749]
curr_Stock_Price:  102.19859829015125
curr_Factors:  [102.19859829]
mat_Sqrt:  [[0.15]]
grads:  [-0.0330225]
Stock Position:  -0.033022497486360686
Bond Position:  [-9.48065454]


portfolio before change:  [-12.87722795]
curr_Stock_Price:  102.83840147164068
curr_Factors:  [102.83840147]
mat_Sqrt:  [[0.15]]
grads:  [0.14092815]
Stock Position:  0.14092815484354876
Bond Position:  [-27.37005412]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.87722795]
Stock Price:  102.2212800975599
PL:  [-15.09850805]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.43007854e-02]
 [-1.98924672e-03]
 [-4.15876907e-04]
 [ 2.02724670e-03]
 [ 1.71131844e-02]
 [ 1.14037975e-02]
 [ 1.24404716e-03]
 [ 9.46086206e-03]
 [ 6.80002059e-03]
 [-1.95637479e-02]
 [ 1.02415550e-02]
 [-5.38510386e-03]
 [-8.74791103e-03]
 [ 3.84996258e-03]
 [-1.37182824e-02]
 [ 1.33443459e-02]
 [-4.04950469e-04]
 [ 4.48397437e-03]
 [ 1.23555285e-02]
 [ 1.36386518e-02]
 [ 5.42475435e-02]
 [-1.60204170e-02]
 [-2.85200106e-03]
 [ 1.07141469e-02]
 [ 1.43797594e-02]
 [-7.05723695e-03]
 [ 1.27413280e-02]
 [ 1.65436660e-03]
 [ 3.37446568e-03]
 [-2.83087144e-02]
 [-5.02050993e-03]
 [ 1.68609649e-02]
 [ 9.41391429e-03]
 [-6.86804874e-04]
 [-2.58227682e-03]
 [-4.47149431e-03]
 [-6.83105149e-03]
 [ 3.98212577e-03]
 [ 1.83939776e-03]
 [-7.94354822e-03]
 [-3.87416791e-02]
 [-2.40833828e-03]
 [ 1.25406015e-02]
 [-1.25918585e-02]
 [-1.13925628e-03]
 [ 2.50030398e-03]
 [-1.36325538e-02]
 [ 4.07567423e-03]
 [ 1.36245452e-02]
 [-1.16738999e-02]
 [-3.70686373e-03]
 [ 3.46030579e-03]
 [ 1.74807055e-03]
 [ 2.15836568e-03]
 [-4.08364530e-03]
 [ 9.11378385e-03]
 [-6.85619840e-03]
 [-1.07036198e-02]
 [ 1.48003165e-02]
 [ 2.41040344e-03]
 [ 1.23716000e-02]
 [-1.50122891e-02]
 [-1.27570630e-02]
 [-3.33576444e-03]
 [ 4.68575130e-02]
 [-1.66883264e-02]
 [ 1.62747429e-02]
 [ 4.17477147e-03]
 [ 7.81727129e-03]
 [-1.75244081e-02]
 [-7.73984344e-03]
 [-7.55231015e-03]
 [ 3.19882127e-03]
 [ 7.25395757e-03]
 [-7.75305972e-04]
 [-1.11026486e-02]
 [ 6.67848345e-03]
 [-3.84920936e-03]
 [ 2.36640020e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.09528237]
curr_Stock_Price:  100.25893587895848
curr_Factors:  [100.25893588]
mat_Sqrt:  [[0.15]]
grads:  [-0.29533857]
Stock Position:  -0.2953385696104385
Bond Position:  [35.70561309]


portfolio before change:  [6.18260017]
curr_Stock_Price:  99.97083896469734
curr_Factors:  [99.97083896]
mat_Sqrt:  [[0.15]]
grads:  [-0.01326164]
Stock Position:  -0.013261644824407295
Bond Position:  [7.50837793]


portfolio before change:  [6.19124098]
curr_Stock_Price:  99.35466197698638
curr_Factors:  [99.35466198]
mat_Sqrt:  [[0.15]]
grads:  [-0.00277251]
Stock Position:  -0.0027725127150739592
Bond Position:  [6.46670305]


portfolio before change:  [6.19042418]
curr_Stock_Price:  99.79505126936803
curr_Factors:  [99.79505127]
mat_Sqrt:  [[0.15]]
grads:  [0.01351498]
Stock Position:  0.013514978008289016
Bond Position:  [4.84169626]


portfolio before change:  [6.19480881]
curr_Stock_Price:  100.09708795148417
curr_Factors:  [100.09708795]
mat_Sqrt:  [[0.15]]
grads:  [0.1140879]
Stock Position:  0.11408789571951175
Bond Position:  [-5.22505732]


portfolio before change:  [6.14305821]
curr_Stock_Price:  99.64634753971431
curr_Factors:  [99.64634754]
mat_Sqrt:  [[0.15]]
grads:  [0.07602532]
Stock Position:  0.07602531663917035
Bond Position:  [-1.43258691]


portfolio before change:  [6.1512808]
curr_Stock_Price:  99.75568116474766
curr_Factors:  [99.75568116]
mat_Sqrt:  [[0.15]]
grads:  [0.00829365]
Stock Position:  0.00829364774504447
Bond Position:  [5.32394232]


portfolio before change:  [6.15947094]
curr_Stock_Price:  100.70307978473849
curr_Factors:  [100.70307978]
mat_Sqrt:  [[0.15]]
grads:  [0.06307241]
Stock Position:  0.06307241375427503
Bond Position:  [-0.19211537]


portfolio before change:  [6.1379698]
curr_Stock_Price:  100.3623740063136
curr_Factors:  [100.36237401]
mat_Sqrt:  [[0.15]]
grads:  [0.04533347]
Stock Position:  0.04533347061263957
Bond Position:  [1.58819507]


portfolio before change:  [6.13329231]
curr_Stock_Price:  100.25700477524215
curr_Factors:  [100.25700478]
mat_Sqrt:  [[0.15]]
grads:  [-0.13042499]
Stock Position:  -0.1304249862980235
Bond Position:  [19.20931079]


portfolio before change:  [6.0919501]
curr_Stock_Price:  100.58319101429896
curr_Factors:  [100.58319101]
mat_Sqrt:  [[0.15]]
grads:  [0.06827703]
Stock Position:  0.06827703361071323
Bond Position:  [-0.77557182]


portfolio before change:  [6.07372754]
curr_Stock_Price:  100.31700947969938
curr_Factors:  [100.31700948]
mat_Sqrt:  [[0.15]]
grads:  [-0.03590069]
Stock Position:  -0.03590069241373799
Bond Position:  [9.67517764]


portfolio before change:  [6.10147608]
curr_Stock_Price:  99.56092873770673
curr_Factors:  [99.56092874]
mat_Sqrt:  [[0.15]]
grads:  [-0.05831941]
Stock Position:  -0.05831940684664123
Bond Position:  [11.90781038]


portfolio before change:  [6.12648558]
curr_Stock_Price:  99.14485380603865
curr_Factors:  [99.14485381]
mat_Sqrt:  [[0.15]]
grads:  [0.02566642]
Stock Position:  0.025666417228213688
Bond Position:  [3.5817924]


portfolio before change:  [6.10262653]
curr_Stock_Price:  98.20654930963842
curr_Factors:  [98.20654931]
mat_Sqrt:  [[0.15]]
grads:  [-0.09145522]
Stock Position:  -0.09145521614790131
Bond Position:  [15.08412773]


portfolio before change:  [6.03365782]
curr_Stock_Price:  98.97098352742945
curr_Factors:  [98.97098353]
mat_Sqrt:  [[0.15]]
grads:  [0.08896231]
Stock Position:  0.08896230618790663
Bond Position:  [-2.77102912]


portfolio before change:  [6.04370806]
curr_Stock_Price:  99.08590223953732
curr_Factors:  [99.08590224]
mat_Sqrt:  [[0.15]]
grads:  [-0.00269967]
Stock Position:  -0.0026996697947315657
Bond Position:  [6.31120728]


portfolio before change:  [6.04534684]
curr_Stock_Price:  98.6249898576615
curr_Factors:  [98.62498986]
mat_Sqrt:  [[0.15]]
grads:  [0.02989316]
Stock Position:  0.02989316249895931
Bond Position:  [3.09713399]


portfolio before change:  [6.04095347]
curr_Stock_Price:  98.47154519684108
curr_Factors:  [98.4715452]
mat_Sqrt:  [[0.15]]
grads:  [0.08237019]
Stock Position:  0.08237019000137591
Bond Position:  [-2.07016642]


portfolio before change:  [6.04262563]
curr_Stock_Price:  98.49341653464225
curr_Factors:  [98.49341653]
mat_Sqrt:  [[0.15]]
grads:  [0.09092435]
Stock Position:  0.09092434564543152
Bond Position:  [-2.91282382]


portfolio before change:  [6.10953768]
curr_Stock_Price:  99.23132794360765
curr_Factors:  [99.23132794]
mat_Sqrt:  [[0.15]]
grads:  [0.36165029]
Stock Position:  0.361650290236976
Bond Position:  [-29.77750087]


portfolio before change:  [6.18732967]
curr_Stock_Price:  99.45157702465093
curr_Factors:  [99.45157702]
mat_Sqrt:  [[0.15]]
grads:  [-0.10680278]
Stock Position:  -0.10680277984255973
Bond Position:  [16.80903456]


portfolio before change:  [6.12712798]
curr_Stock_Price:  100.02508537254295
curr_Factors:  [100.02508537]
mat_Sqrt:  [[0.15]]
grads:  [-0.01901334]
Stock Position:  -0.01901334036778397
Bond Position:  [8.02893898]


portfolio before change:  [6.12544454]
curr_Stock_Price:  100.1400187949294
curr_Factors:  [100.14001879]
mat_Sqrt:  [[0.15]]
grads:  [0.07142765]
Stock Position:  0.07142764591031715
Bond Position:  [-1.02732126]


portfolio before change:  [6.15489207]
curr_Stock_Price:  100.55318855947404
curr_Factors:  [100.55318856]
mat_Sqrt:  [[0.15]]
grads:  [0.09586506]
Stock Position:  0.09586506280455487
Bond Position:  [-3.48464566]


portfolio before change:  [6.14672086]
curr_Stock_Price:  100.47022385068792
curr_Factors:  [100.47022385]
mat_Sqrt:  [[0.15]]
grads:  [-0.04704825]
Stock Position:  -0.047048246365764684
Bond Position:  [10.8736687]


portfolio before change:  [6.13054816]
curr_Stock_Price:  100.82841620323035
curr_Factors:  [100.8284162]
mat_Sqrt:  [[0.15]]
grads:  [0.08494219]
Stock Position:  0.0849421868651478
Bond Position:  [-2.43403801]


portfolio before change:  [6.10024625]
curr_Stock_Price:  100.47347149086916
curr_Factors:  [100.47347149]
mat_Sqrt:  [[0.15]]
grads:  [0.01102911]
Stock Position:  0.011029110696945399
Bond Position:  [4.99211321]


portfolio before change:  [6.10127656]
curr_Stock_Price:  100.53859804094382
curr_Factors:  [100.53859804]
mat_Sqrt:  [[0.15]]
grads:  [0.02249644]
Stock Position:  0.022496437869120423
Bond Position:  [3.83951623]


portfolio before change:  [6.10711527]
curr_Stock_Price:  100.78747002804607
curr_Factors:  [100.78747003]
mat_Sqrt:  [[0.15]]
grads:  [-0.18872476]
Stock Position:  -0.1887247629479125
Bond Position:  [25.12820666]


portfolio before change:  [6.10206258]
curr_Stock_Price:  100.82256477962805
curr_Factors:  [100.82256478]
mat_Sqrt:  [[0.15]]
grads:  [-0.03347007]
Stock Position:  -0.03347006621427655
Bond Position:  [9.4766005]


portfolio before change:  [6.08818721]
curr_Stock_Price:  101.2548219647091
curr_Factors:  [101.25482196]
mat_Sqrt:  [[0.15]]
grads:  [0.11240643]
Stock Position:  0.1124064324965689
Bond Position:  [-5.2935061]


portfolio before change:  [6.07118548]
curr_Stock_Price:  101.1065130268416
curr_Factors:  [101.10651303]
mat_Sqrt:  [[0.15]]
grads:  [0.06275943]
Stock Position:  0.06275942858178013
Bond Position:  [-0.27420151]


portfolio before change:  [6.14763514]
curr_Stock_Price:  102.32492435792592
curr_Factors:  [102.32492436]
mat_Sqrt:  [[0.15]]
grads:  [-0.0045787]
Stock Position:  -0.004578699161315673
Bond Position:  [6.61615018]


portfolio before change:  [6.15033971]
curr_Stock_Price:  101.82455312496226
curr_Factors:  [101.82455312]
mat_Sqrt:  [[0.15]]
grads:  [-0.01721518]
Stock Position:  -0.01721517882991323
Bond Position:  [7.9032676]


portfolio before change:  [6.14983573]
curr_Stock_Price:  101.88252248426525
curr_Factors:  [101.88252248]
mat_Sqrt:  [[0.15]]
grads:  [-0.02980996]
Stock Position:  -0.029809962033369414
Bond Position:  [9.18694985]


portfolio before change:  [6.13754155]
curr_Stock_Price:  102.3142028282346
curr_Factors:  [102.31420283]
mat_Sqrt:  [[0.15]]
grads:  [-0.04554034]
Stock Position:  -0.04554034325125532
Bond Position:  [10.79696547]


portfolio before change:  [6.13666405]
curr_Stock_Price:  102.34828977791221
curr_Factors:  [102.34828978]
mat_Sqrt:  [[0.15]]
grads:  [0.02654751]
Stock Position:  0.026547505122145057
Bond Position:  [3.41957231]


portfolio before change:  [6.13971663]
curr_Stock_Price:  102.45522433945149
curr_Factors:  [102.45522434]
mat_Sqrt:  [[0.15]]
grads:  [0.01226265]
Stock Position:  0.012262651715048891
Bond Position:  [4.8833439]


portfolio before change:  [6.14903445]
curr_Stock_Price:  103.19018772228958
curr_Factors:  [103.19018772]
mat_Sqrt:  [[0.15]]
grads:  [-0.05295699]
Stock Position:  -0.05295698810799411
Bond Position:  [11.61367599]


portfolio before change:  [6.14653219]
curr_Stock_Price:  103.2511454215852
curr_Factors:  [103.25114542]
mat_Sqrt:  [[0.15]]
grads:  [-0.25827786]
Stock Position:  -0.258277860395694
Bond Position:  [32.81401711]


portfolio before change:  [6.33701067]
curr_Stock_Price:  102.52159184143582
curr_Factors:  [102.52159184]
mat_Sqrt:  [[0.15]]
grads:  [-0.01605559]
Stock Position:  -0.016055588503247342
Bond Position:  [7.98305516]


portfolio before change:  [6.33309742]
curr_Stock_Price:  102.7963998715588
curr_Factors:  [102.79639987]
mat_Sqrt:  [[0.15]]
grads:  [0.08360401]
Stock Position:  0.08360401017075593
Bond Position:  [-2.26109384]


portfolio before change:  [6.37989984]
curr_Stock_Price:  103.35790102721732
curr_Factors:  [103.35790103]
mat_Sqrt:  [[0.15]]
grads:  [-0.08394572]
Stock Position:  -0.08394572343737303
Bond Position:  [15.05635362]


portfolio before change:  [6.38966881]
curr_Stock_Price:  103.25273890195388
curr_Factors:  [103.2527389]
mat_Sqrt:  [[0.15]]
grads:  [-0.00759504]
Stock Position:  -0.007595041894888627
Bond Position:  [7.17387768]


portfolio before change:  [6.38787568]
curr_Stock_Price:  103.54786659738225
curr_Factors:  [103.5478666]
mat_Sqrt:  [[0.15]]
grads:  [0.01666869]
Stock Position:  0.016668693231082176
Bond Position:  [4.66186806]


portfolio before change:  [6.38016276]
curr_Stock_Price:  103.06766694167449
curr_Factors:  [103.06766694]
mat_Sqrt:  [[0.15]]
grads:  [-0.09088369]
Stock Position:  -0.09088369192193192
Bond Position:  [15.74733284]


portfolio before change:  [6.3698684]
curr_Stock_Price:  103.19176617416335
curr_Factors:  [103.19176617]
mat_Sqrt:  [[0.15]]
grads:  [0.02717116]
Stock Position:  0.027171161539652763
Bond Position:  [3.56602825]


portfolio before change:  [6.39441487]
curr_Stock_Price:  104.08696492217517
curr_Factors:  [104.08696492]
mat_Sqrt:  [[0.15]]
grads:  [0.0908303]
Stock Position:  0.0908303011060905
Bond Position:  [-3.05983549]


portfolio before change:  [6.43615667]
curr_Stock_Price:  104.54862849693876
curr_Factors:  [104.5486285]
mat_Sqrt:  [[0.15]]
grads:  [-0.077826]
Stock Position:  -0.0778259993601172
Bond Position:  [14.57275816]


portfolio before change:  [6.51795972]
curr_Stock_Price:  103.50922999230326
curr_Factors:  [103.50922999]
mat_Sqrt:  [[0.15]]
grads:  [-0.02471242]
Stock Position:  -0.02471242488231292
Bond Position:  [9.07592379]


portfolio before change:  [6.53313026]
curr_Stock_Price:  102.91830161550375
curr_Factors:  [102.91830162]
mat_Sqrt:  [[0.15]]
grads:  [0.02306871]
Stock Position:  0.023068705299672844
Bond Position:  [4.15893829]


portfolio before change:  [6.53833943]
curr_Stock_Price:  103.13284472572337
curr_Factors:  [103.13284473]
mat_Sqrt:  [[0.15]]
grads:  [0.0116538]
Stock Position:  0.011653803686879427
Bond Position:  [5.3364495]


portfolio before change:  [6.5428192]
curr_Stock_Price:  103.488628339843
curr_Factors:  [103.48862834]
mat_Sqrt:  [[0.15]]
grads:  [0.0143891]
Stock Position:  0.014389104508493017
Bond Position:  [5.05371051]


portfolio before change:  [6.53641941]
curr_Stock_Price:  103.0219100242923
curr_Factors:  [103.02191002]
mat_Sqrt:  [[0.15]]
grads:  [-0.0272243]
Stock Position:  -0.027224301975625732
Bond Position:  [9.341119]


portfolio before change:  [6.54050125]
curr_Stock_Price:  102.89342182617104
curr_Factors:  [102.89342183]
mat_Sqrt:  [[0.15]]
grads:  [0.06075856]
Stock Position:  0.06075855899230684
Bond Position:  [0.28884521]


portfolio before change:  [6.52046838]
curr_Stock_Price:  102.56341201835386
curr_Factors:  [102.56341202]
mat_Sqrt:  [[0.15]]
grads:  [-0.04570799]
Stock Position:  -0.0457079893054928
Bond Position:  [11.20843572]


portfolio before change:  [6.47675852]
curr_Stock_Price:  103.53502347791712
curr_Factors:  [103.53502348]
mat_Sqrt:  [[0.15]]
grads:  [-0.07135747]
Stock Position:  -0.07135746521151216
Bond Position:  [13.86475536]


portfolio before change:  [6.5155682]
curr_Stock_Price:  103.00329069710425
curr_Factors:  [103.0032907]
mat_Sqrt:  [[0.15]]
grads:  [0.09866878]
Stock Position:  0.09866877661922863
Bond Position:  [-3.64764048]


portfolio before change:  [6.50343202]
curr_Stock_Price:  102.8826021286163
curr_Factors:  [102.88260213]
mat_Sqrt:  [[0.15]]
grads:  [0.01606936]
Stock Position:  0.016069356248490676
Bond Position:  [4.85017484]


portfolio before change:  [6.51324496]
curr_Stock_Price:  103.47439889630597
curr_Factors:  [103.4743989]
mat_Sqrt:  [[0.15]]
grads:  [0.08247733]
Stock Position:  0.08247733324349288
Bond Position:  [-2.02104752]


portfolio before change:  [6.53927675]
curr_Stock_Price:  103.79155393647349
curr_Factors:  [103.79155394]
mat_Sqrt:  [[0.15]]
grads:  [-0.10008193]
Stock Position:  -0.10008192739076976
Bond Position:  [16.92693551]


portfolio before change:  [6.53477125]
curr_Stock_Price:  103.84714305963057
curr_Factors:  [103.84714306]
mat_Sqrt:  [[0.15]]
grads:  [-0.08504709]
Stock Position:  -0.08504708676037699
Bond Position:  [15.36666823]


portfolio before change:  [6.50533955]
curr_Stock_Price:  104.20449971550144
curr_Factors:  [104.20449972]
mat_Sqrt:  [[0.15]]
grads:  [-0.02223843]
Stock Position:  -0.022238429585870585
Bond Position:  [8.82268398]


portfolio before change:  [6.48989824]
curr_Stock_Price:  104.92364853994837
curr_Factors:  [104.92364854]
mat_Sqrt:  [[0.15]]
grads:  [0.31238342]
Stock Position:  0.3123834197490467
Bond Position:  [-26.2865099]


portfolio before change:  [6.47316678]
curr_Stock_Price:  104.87534729482744
curr_Factors:  [104.87534729]
mat_Sqrt:  [[0.15]]
grads:  [-0.11125551]
Stock Position:  -0.11125550912124384
Bond Position:  [18.14112694]


portfolio before change:  [6.49027815]
curr_Stock_Price:  104.73173631008804
curr_Factors:  [104.73173631]
mat_Sqrt:  [[0.15]]
grads:  [0.10849829]
Stock Position:  0.10849828592113471
Bond Position:  [-4.87293572]


portfolio before change:  [6.45453984]
curr_Stock_Price:  104.40515292154026
curr_Factors:  [104.40515292]
mat_Sqrt:  [[0.15]]
grads:  [0.02783181]
Stock Position:  0.027831809814766833
Bond Position:  [3.54875548]


portfolio before change:  [6.41211124]
curr_Stock_Price:  102.87271899522806
curr_Factors:  [102.872719]
mat_Sqrt:  [[0.15]]
grads:  [0.05211514]
Stock Position:  0.05211514194367434
Bond Position:  [1.05088488]


portfolio before change:  [6.41848855]
curr_Stock_Price:  102.99382828954855
curr_Factors:  [102.99382829]
mat_Sqrt:  [[0.15]]
grads:  [-0.11682939]
Stock Position:  -0.11682938740695932
Bond Position:  [18.45119441]


portfolio before change:  [6.35732569]
curr_Stock_Price:  103.52722223523308
curr_Factors:  [103.52722224]
mat_Sqrt:  [[0.15]]
grads:  [-0.05159896]
Stock Position:  -0.05159895628332743
Bond Position:  [11.69922231]


portfolio before change:  [6.37121566]
curr_Stock_Price:  103.27220269423647
curr_Factors:  [103.27220269]
mat_Sqrt:  [[0.15]]
grads:  [-0.05034873]
Stock Position:  -0.050348734340789854
Bond Position:  [11.57084036]


portfolio before change:  [6.38821551]
curr_Stock_Price:  102.94892455388555
curr_Factors:  [102.94892455]
mat_Sqrt:  [[0.15]]
grads:  [0.02132548]
Stock Position:  0.021325475121714742
Bond Position:  [4.19278078]


portfolio before change:  [6.39631486]
curr_Stock_Price:  103.31643338059601
curr_Factors:  [103.31643338]
mat_Sqrt:  [[0.15]]
grads:  [0.04835972]
Stock Position:  0.04835971710796608
Bond Position:  [1.39996137]


portfolio before change:  [6.38459507]
curr_Stock_Price:  103.0722778773408
curr_Factors:  [103.07227788]
mat_Sqrt:  [[0.15]]
grads:  [-0.00516871]
Stock Position:  -0.00516870647781636
Bond Position:  [6.91734542]


portfolio before change:  [6.38504153]
curr_Stock_Price:  103.06954821182254
curr_Factors:  [103.06954821]
mat_Sqrt:  [[0.15]]
grads:  [-0.07401766]
Stock Position:  -0.07401765765744624
Bond Position:  [14.01400806]


portfolio before change:  [6.37938439]
curr_Stock_Price:  103.15781143541729
curr_Factors:  [103.15781144]
mat_Sqrt:  [[0.15]]
grads:  [0.04452322]
Stock Position:  0.04452322301747176
Bond Position:  [1.78646615]


portfolio before change:  [6.374288]
curr_Stock_Price:  103.04083753348853
curr_Factors:  [103.04083753]
mat_Sqrt:  [[0.15]]
grads:  [-0.0256614]
Stock Position:  -0.025661395711968682
Bond Position:  [9.0184597]


portfolio before change:  [6.37135416]
curr_Stock_Price:  103.17713221757035
curr_Factors:  [103.17713222]
mat_Sqrt:  [[0.15]]
grads:  [0.15776001]
Stock Position:  0.15776001343853435
Bond Position:  [-9.90587161]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.37135416]
Stock Price:  102.97033450162586
PL:  [3.40101965]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.64741666e-02]
 [-1.99082561e-03]
 [ 2.63412723e-03]
 [ 2.70770853e-03]
 [ 4.69054901e-03]
 [ 1.22688036e-02]
 [-7.35202601e-04]
 [ 8.67200626e-03]
 [-1.04694583e-02]
 [ 1.49733406e-02]
 [ 9.95661820e-03]
 [-7.88741413e-03]
 [ 1.29747385e-02]
 [ 4.09951461e-03]
 [ 5.49410179e-04]
 [-1.01317343e-02]
 [ 1.47684866e-02]
 [ 1.55598588e-02]
 [ 2.20389125e-02]
 [ 4.48597035e-03]
 [ 6.73519895e-02]
 [-1.31035069e-02]
 [ 5.56968262e-04]
 [ 9.64637907e-03]
 [ 1.23915521e-02]
 [-3.92113718e-03]
 [ 1.24544672e-02]
 [ 1.18503994e-03]
 [ 3.10747895e-03]
 [-2.46774429e-02]
 [-4.85183694e-03]
 [ 6.21787897e-03]
 [ 1.19108754e-02]
 [ 5.72375958e-03]
 [-2.38089441e-03]
 [-4.34625746e-03]
 [-6.71059530e-03]
 [ 1.09484412e-02]
 [ 1.37700405e-03]
 [-8.71179550e-03]
 [-2.37124987e-02]
 [-2.64908455e-03]
 [ 1.30037129e-02]
 [-1.15842520e-02]
 [-5.26642769e-04]
 [ 2.54018238e-03]
 [-1.35924680e-02]
 [ 7.72143855e-03]
 [ 1.11433087e-02]
 [-1.23170516e-02]
 [-4.51657246e-03]
 [ 3.72211993e-03]
 [ 3.47709098e-03]
 [-6.64060392e-03]
 [-1.09312849e-02]
 [ 1.19020194e-02]
 [-2.72554161e-02]
 [-9.02905258e-03]
 [ 1.84283914e-02]
 [-5.03368009e-03]
 [ 1.30782172e-02]
 [-1.43586224e-02]
 [-1.27537749e-02]
 [-3.18868338e-03]
 [-1.60899685e-02]
 [-1.47002971e-02]
 [ 2.89035600e-02]
 [ 2.68596962e-03]
 [ 7.65407741e-03]
 [-2.10523894e-02]
 [-7.76872368e-03]
 [-7.10432099e-03]
 [ 7.72073936e-03]
 [ 6.41712502e-03]
 [-8.96441114e-04]
 [ 5.78647416e-04]
 [ 5.87533424e-03]
 [-2.63051736e-03]
 [ 1.98308694e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.65455639]
curr_Stock_Price:  99.63230731050064
curr_Factors:  [99.63230731]
mat_Sqrt:  [[0.15]]
grads:  [-0.24316111]
Stock Position:  -0.2431611107169765
Bond Position:  [20.57214612]


portfolio before change:  [-3.83676458]
curr_Stock_Price:  100.38692626567367
curr_Factors:  [100.38692627]
mat_Sqrt:  [[0.15]]
grads:  [-0.01327217]
Stock Position:  -0.01327217075127584
Bond Position:  [-2.50441215]


portfolio before change:  [-3.84462485]
curr_Stock_Price:  100.96736962521479
curr_Factors:  [100.96736963]
mat_Sqrt:  [[0.15]]
grads:  [0.01756085]
Stock Position:  0.017560848205589008
Bond Position:  [-5.6176975]


portfolio before change:  [-3.84176548]
curr_Stock_Price:  101.15019030482894
curr_Factors:  [101.1501903]
mat_Sqrt:  [[0.15]]
grads:  [0.01805139]
Stock Position:  0.018051390171202136
Bond Position:  [-5.66766703]


portfolio before change:  [-3.84662208]
curr_Stock_Price:  100.90077164944577
curr_Factors:  [100.90077165]
mat_Sqrt:  [[0.15]]
grads:  [0.03127033]
Stock Position:  0.03127032670783121
Bond Position:  [-7.00182217]


portfolio before change:  [-3.79824447]
curr_Stock_Price:  102.46184368331146
curr_Factors:  [102.46184368]
mat_Sqrt:  [[0.15]]
grads:  [0.08179202]
Stock Position:  0.08179202381631732
Bond Position:  [-12.17880603]


portfolio before change:  [-3.81734532]
curr_Stock_Price:  102.23762066179259
curr_Factors:  [102.23762066]
mat_Sqrt:  [[0.15]]
grads:  [-0.00490135]
Stock Position:  -0.004901350676022936
Bond Position:  [-3.31624289]


portfolio before change:  [-3.81644197]
curr_Stock_Price:  102.01102372092853
curr_Factors:  [102.01102372]
mat_Sqrt:  [[0.15]]
grads:  [0.05781338]
Stock Position:  0.05781337509828987
Bond Position:  [-9.71404354]


portfolio before change:  [-3.8172469]
curr_Stock_Price:  102.0076025100124
curr_Factors:  [102.00760251]
mat_Sqrt:  [[0.15]]
grads:  [-0.06979639]
Stock Position:  -0.06979638852289345
Bond Position:  [3.30251535]


portfolio before change:  [-3.85175791]
curr_Stock_Price:  102.50501242488966
curr_Factors:  [102.50501242]
mat_Sqrt:  [[0.15]]
grads:  [0.09982227]
Stock Position:  0.09982227047201175
Bond Position:  [-14.08404098]


portfolio before change:  [-3.8972489]
curr_Stock_Price:  102.05811097380233
curr_Factors:  [102.05811097]
mat_Sqrt:  [[0.15]]
grads:  [0.06637745]
Stock Position:  0.06637745465669788
Bond Position:  [-10.67160654]


portfolio before change:  [-3.94860808]
curr_Stock_Price:  101.29441523437718
curr_Factors:  [101.29441523]
mat_Sqrt:  [[0.15]]
grads:  [-0.05258276]
Stock Position:  -0.05258276089598378
Bond Position:  [1.37773194]


portfolio before change:  [-3.95692213]
curr_Stock_Price:  101.45416655560865
curr_Factors:  [101.45416656]
mat_Sqrt:  [[0.15]]
grads:  [0.08649826]
Stock Position:  0.08649825671890815
Bond Position:  [-12.73253068]


portfolio before change:  [-3.98030282]
curr_Stock_Price:  101.19306446852269
curr_Factors:  [101.19306447]
mat_Sqrt:  [[0.15]]
grads:  [0.0273301]
Stock Position:  0.027330097372235008
Bond Position:  [-6.74591912]


portfolio before change:  [-3.96905585]
curr_Stock_Price:  101.62001506470091
curr_Factors:  [101.62001506]
mat_Sqrt:  [[0.15]]
grads:  [0.00366273]
Stock Position:  0.003662734525752924
Bond Position:  [-4.34126299]


portfolio before change:  [-3.96995328]
curr_Stock_Price:  101.44907941363063
curr_Factors:  [101.44907941]
mat_Sqrt:  [[0.15]]
grads:  [-0.0675449]
Stock Position:  -0.06754489555752909
Bond Position:  [2.8824142]


portfolio before change:  [-3.92688169]
curr_Stock_Price:  100.81407312106361
curr_Factors:  [100.81407312]
mat_Sqrt:  [[0.15]]
grads:  [0.09845658]
Stock Position:  0.09845657759965994
Bond Position:  [-13.8526903]


portfolio before change:  [-3.93344405]
curr_Stock_Price:  100.75621470689869
curr_Factors:  [100.75621471]
mat_Sqrt:  [[0.15]]
grads:  [0.10373239]
Stock Position:  0.10373239195843237
Bond Position:  [-14.38512721]


portfolio before change:  [-3.94737122]
curr_Stock_Price:  100.63062158631399
curr_Factors:  [100.63062159]
mat_Sqrt:  [[0.15]]
grads:  [0.14692608]
Stock Position:  0.14692608333444238
Bond Position:  [-18.73263432]


portfolio before change:  [-4.01452743]
curr_Stock_Price:  100.18151558329222
curr_Factors:  [100.18151558]
mat_Sqrt:  [[0.15]]
grads:  [0.02990647]
Stock Position:  0.029906469012653744
Bond Position:  [-7.01060283]


portfolio before change:  [-3.98078284]
curr_Stock_Price:  101.32450476442999
curr_Factors:  [101.32450476]
mat_Sqrt:  [[0.15]]
grads:  [0.44901326]
Stock Position:  0.44901326337324604
Bond Position:  [-49.47682938]


portfolio before change:  [-4.02778862]
curr_Stock_Price:  101.22670501322575
curr_Factors:  [101.22670501]
mat_Sqrt:  [[0.15]]
grads:  [-0.08735671]
Stock Position:  -0.08735671273647054
Bond Position:  [4.81504357]


portfolio before change:  [-3.96968935]
curr_Stock_Price:  100.56506923331847
curr_Factors:  [100.56506923]
mat_Sqrt:  [[0.15]]
grads:  [0.00371312]
Stock Position:  0.003713121745574771
Bond Position:  [-4.34309969]


portfolio before change:  [-3.97102648]
curr_Stock_Price:  100.27806661094004
curr_Factors:  [100.27806661]
mat_Sqrt:  [[0.15]]
grads:  [0.06430919]
Stock Position:  0.06430919381166562
Bond Position:  [-10.4198281]


portfolio before change:  [-3.99710683]
curr_Stock_Price:  99.88264728449485
curr_Factors:  [99.88264728]
mat_Sqrt:  [[0.15]]
grads:  [0.08261035]
Stock Position:  0.08261034754937618
Bond Position:  [-12.24844704]


portfolio before change:  [-3.93340692]
curr_Stock_Price:  100.66300306556394
curr_Factors:  [100.66300307]
mat_Sqrt:  [[0.15]]
grads:  [-0.02614091]
Stock Position:  -0.026140914537866346
Bond Position:  [-1.30198396]


portfolio before change:  [-3.94357538]
curr_Stock_Price:  101.04887648493222
curr_Factors:  [101.04887648]
mat_Sqrt:  [[0.15]]
grads:  [0.08302978]
Stock Position:  0.08302978126037211
Bond Position:  [-12.3336415]


portfolio before change:  [-3.98500624]
curr_Stock_Price:  100.55917294244185
curr_Factors:  [100.55917294]
mat_Sqrt:  [[0.15]]
grads:  [0.00790027]
Stock Position:  0.007900266252509083
Bond Position:  [-4.77945048]


portfolio before change:  [-3.9878798]
curr_Stock_Price:  100.23325500202225
curr_Factors:  [100.233255]
mat_Sqrt:  [[0.15]]
grads:  [0.02071653]
Stock Position:  0.02071652630005163
Bond Position:  [-6.06436467]


portfolio before change:  [-3.98875845]
curr_Stock_Price:  100.20913820386309
curr_Factors:  [100.2091382]
mat_Sqrt:  [[0.15]]
grads:  [-0.16451629]
Stock Position:  -0.1645162857552747
Bond Position:  [12.49727676]


portfolio before change:  [-4.0439911]
curr_Stock_Price:  100.54961359532483
curr_Factors:  [100.5496136]
mat_Sqrt:  [[0.15]]
grads:  [-0.03234558]
Stock Position:  -0.03234557959439422
Bond Position:  [-0.79165557]


portfolio before change:  [-4.03324337]
curr_Stock_Price:  100.21580581824517
curr_Factors:  [100.21580582]
mat_Sqrt:  [[0.15]]
grads:  [0.04145253]
Stock Position:  0.04145252646210557
Bond Position:  [-8.18744171]


portfolio before change:  [-4.0187334]
curr_Stock_Price:  100.57818909647389
curr_Factors:  [100.5781891]
mat_Sqrt:  [[0.15]]
grads:  [0.07940584]
Stock Position:  0.07940583618478353
Bond Position:  [-12.00522861]


portfolio before change:  [-3.93949513]
curr_Stock_Price:  101.58552835326755
curr_Factors:  [101.58552835]
mat_Sqrt:  [[0.15]]
grads:  [0.0381584]
Stock Position:  0.03815839718603479
Bond Position:  [-7.81583607]


portfolio before change:  [-3.93202344]
curr_Stock_Price:  101.79413780373606
curr_Factors:  [101.7941378]
mat_Sqrt:  [[0.15]]
grads:  [-0.01587263]
Stock Position:  -0.015872629390936498
Bond Position:  [-2.31628281]


portfolio before change:  [-3.93940025]
curr_Stock_Price:  102.24976757647252
curr_Factors:  [102.24976758]
mat_Sqrt:  [[0.15]]
grads:  [-0.02897505]
Stock Position:  -0.028975049765839044
Bond Position:  [-0.97670815]


portfolio before change:  [-3.91177638]
curr_Stock_Price:  101.2942932665453
curr_Factors:  [101.29429327]
mat_Sqrt:  [[0.15]]
grads:  [-0.0447373]
Stock Position:  -0.04473730202577701
Bond Position:  [0.61985701]


portfolio before change:  [-3.91016805]
curr_Stock_Price:  101.25920873690244
curr_Factors:  [101.25920874]
mat_Sqrt:  [[0.15]]
grads:  [0.07298961]
Stock Position:  0.07298960814824701
Bond Position:  [-11.30103802]


portfolio before change:  [-3.84461596]
curr_Stock_Price:  102.16698759533631
curr_Factors:  [102.1669876]
mat_Sqrt:  [[0.15]]
grads:  [0.00918003]
Stock Position:  0.009180027022908707
Bond Position:  [-4.78251167]


portfolio before change:  [-3.84486301]
curr_Stock_Price:  102.17263818371303
curr_Factors:  [102.17263818]
mat_Sqrt:  [[0.15]]
grads:  [-0.05807864]
Stock Position:  -0.05807863668588098
Bond Position:  [2.08918452]


portfolio before change:  [-3.82784873]
curr_Stock_Price:  101.8819339567157
curr_Factors:  [101.88193396]
mat_Sqrt:  [[0.15]]
grads:  [-0.15808332]
Stock Position:  -0.15808332449171703
Bond Position:  [12.2779861]


portfolio before change:  [-3.99284598]
curr_Stock_Price:  102.9305243126751
curr_Factors:  [102.93052431]
mat_Sqrt:  [[0.15]]
grads:  [-0.01766056]
Stock Position:  -0.017660563658445302
Bond Position:  [-2.1750349]


portfolio before change:  [-3.99461765]
curr_Stock_Price:  103.0231445975314
curr_Factors:  [103.0231446]
mat_Sqrt:  [[0.15]]
grads:  [0.08669142]
Stock Position:  0.08669141904567272
Bond Position:  [-12.92584025]


portfolio before change:  [-4.0408675]
curr_Stock_Price:  102.4989639795559
curr_Factors:  [102.49896398]
mat_Sqrt:  [[0.15]]
grads:  [-0.07722835]
Stock Position:  -0.0772283469997376
Bond Position:  [3.87495806]


portfolio before change:  [-4.05880659]
curr_Stock_Price:  102.73438642368706
curr_Factors:  [102.73438642]
mat_Sqrt:  [[0.15]]
grads:  [-0.00351095]
Stock Position:  -0.003510951796421548
Bond Position:  [-3.69811111]


portfolio before change:  [-4.06266929]
curr_Stock_Price:  103.76873728826331
curr_Factors:  [103.76873729]
mat_Sqrt:  [[0.15]]
grads:  [0.01693455]
Stock Position:  0.016934549176767205
Bond Position:  [-5.81994607]


portfolio before change:  [-4.05278188]
curr_Stock_Price:  104.37407775906529
curr_Factors:  [104.37407776]
mat_Sqrt:  [[0.15]]
grads:  [-0.09061645]
Stock Position:  -0.09061645340914985
Bond Position:  [5.40522688]


portfolio before change:  [-4.00244985]
curr_Stock_Price:  103.82236570215515
curr_Factors:  [103.8223657]
mat_Sqrt:  [[0.15]]
grads:  [0.05147626]
Stock Position:  0.05147625699777654
Bond Position:  [-9.34683663]


portfolio before change:  [-4.00280852]
curr_Stock_Price:  103.8267467796173
curr_Factors:  [103.82674678]
mat_Sqrt:  [[0.15]]
grads:  [0.07428872]
Stock Position:  0.07428872463032628
Bond Position:  [-11.71596513]


portfolio before change:  [-3.90178771]
curr_Stock_Price:  105.1964444170445
curr_Factors:  [105.19644442]
mat_Sqrt:  [[0.15]]
grads:  [-0.08211368]
Stock Position:  -0.08211367737285048
Bond Position:  [4.73627919]


portfolio before change:  [-3.94057799]
curr_Stock_Price:  105.67244692752723
curr_Factors:  [105.67244693]
mat_Sqrt:  [[0.15]]
grads:  [-0.03011048]
Stock Position:  -0.030110483094367736
Bond Position:  [-0.75872957]


portfolio before change:  [-3.96398163]
curr_Stock_Price:  106.44813055577757
curr_Factors:  [106.44813056]
mat_Sqrt:  [[0.15]]
grads:  [0.02481413]
Stock Position:  0.02481413287288182
Bond Position:  [-6.60539968]


portfolio before change:  [-3.95450157]
curr_Stock_Price:  106.8468107315379
curr_Factors:  [106.84681073]
mat_Sqrt:  [[0.15]]
grads:  [0.02318061]
Stock Position:  0.02318060651373323
Bond Position:  [-6.43127545]


portfolio before change:  [-3.95986883]
curr_Stock_Price:  106.632610462808
curr_Factors:  [106.63261046]
mat_Sqrt:  [[0.15]]
grads:  [-0.04427069]
Stock Position:  -0.04427069278181789
Bond Position:  [0.76083071]


portfolio before change:  [-3.93149679]
curr_Stock_Price:  105.99280817116968
curr_Factors:  [105.99280817]
mat_Sqrt:  [[0.15]]
grads:  [-0.07287523]
Stock Position:  -0.0728752327162188
Bond Position:  [3.79275377]


portfolio before change:  [-3.88940414]
curr_Stock_Price:  105.4184622250561
curr_Factors:  [105.41846223]
mat_Sqrt:  [[0.15]]
grads:  [0.0793468]
Stock Position:  0.07934679629672708
Bond Position:  [-12.25402139]


portfolio before change:  [-3.87247939]
curr_Stock_Price:  105.64141573325075
curr_Factors:  [105.64141573]
mat_Sqrt:  [[0.15]]
grads:  [-0.18170277]
Stock Position:  -0.18170277424991663
Bond Position:  [15.32285892]


portfolio before change:  [-3.84379182]
curr_Stock_Price:  105.48880460655019
curr_Factors:  [105.48880461]
mat_Sqrt:  [[0.15]]
grads:  [-0.06019368]
Stock Position:  -0.06019368389643529
Bond Position:  [2.50596794]


portfolio before change:  [-3.8308203]
curr_Stock_Price:  105.27591030320905
curr_Factors:  [105.2759103]
mat_Sqrt:  [[0.15]]
grads:  [0.12285594]
Stock Position:  0.12285594267555362
Bond Position:  [-16.7645915]


portfolio before change:  [-3.81328318]
curr_Stock_Price:  105.42718457220604
curr_Factors:  [105.42718457]
mat_Sqrt:  [[0.15]]
grads:  [-0.03355787]
Stock Position:  -0.03355786724475343
Bond Position:  [-0.27537171]


portfolio before change:  [-3.81143577]
curr_Stock_Price:  105.37162033418402
curr_Factors:  [105.37162033]
mat_Sqrt:  [[0.15]]
grads:  [0.08718811]
Stock Position:  0.0871881145865798
Bond Position:  [-12.99858868]


portfolio before change:  [-3.82308449]
curr_Stock_Price:  105.24733407079216
curr_Factors:  [105.24733407]
mat_Sqrt:  [[0.15]]
grads:  [-0.09572415]
Stock Position:  -0.09572414943567017
Bond Position:  [6.25162704]


portfolio before change:  [-3.7469602]
curr_Stock_Price:  104.45616950155204
curr_Factors:  [104.4561695]
mat_Sqrt:  [[0.15]]
grads:  [-0.08502517]
Stock Position:  -0.08502516588081736
Bond Position:  [5.13444294]


portfolio before change:  [-3.62819306]
curr_Stock_Price:  103.06309692943135
curr_Factors:  [103.06309693]
mat_Sqrt:  [[0.15]]
grads:  [-0.02125789]
Stock Position:  -0.021257889210627753
Bond Position:  [-1.43728916]


portfolio before change:  [-3.6162352]
curr_Stock_Price:  102.49635717616886
curr_Factors:  [102.49635718]
mat_Sqrt:  [[0.15]]
grads:  [-0.10726646]
Stock Position:  -0.1072664564257207
Bond Position:  [7.37818583]


portfolio before change:  [-3.66226961]
curr_Stock_Price:  102.9298156655957
curr_Factors:  [102.92981567]
mat_Sqrt:  [[0.15]]
grads:  [-0.09800198]
Stock Position:  -0.09800198082520946
Bond Position:  [6.42505622]


portfolio before change:  [-3.58249625]
curr_Stock_Price:  102.11991596951098
curr_Factors:  [102.11991597]
mat_Sqrt:  [[0.15]]
grads:  [0.1926904]
Stock Position:  0.19269040015807118
Bond Position:  [-23.26002373]


portfolio before change:  [-3.4471944]
curr_Stock_Price:  102.82963294066967
curr_Factors:  [102.82963294]
mat_Sqrt:  [[0.15]]
grads:  [0.01790646]
Stock Position:  0.017906464106992582
Bond Position:  [-5.28850953]


portfolio before change:  [-3.44883968]
curr_Stock_Price:  102.75621066129416
curr_Factors:  [102.75621066]
mat_Sqrt:  [[0.15]]
grads:  [0.05102718]
Stock Position:  0.05102718270285555
Bond Position:  [-8.69219961]


portfolio before change:  [-3.38756398]
curr_Stock_Price:  103.9677016693687
curr_Factors:  [103.96770167]
mat_Sqrt:  [[0.15]]
grads:  [-0.14034926]
Stock Position:  -0.14034926236097978
Bond Position:  [11.20422625]


portfolio before change:  [-3.33931255]
curr_Stock_Price:  103.62889585676288
curr_Factors:  [103.62889586]
mat_Sqrt:  [[0.15]]
grads:  [-0.05179149]
Stock Position:  -0.05179149122942697
Bond Position:  [2.0277825]


portfolio before change:  [-3.35880099]
curr_Stock_Price:  104.00762942978842
curr_Factors:  [104.00762943]
mat_Sqrt:  [[0.15]]
grads:  [-0.04736214]
Stock Position:  -0.047362139939710834
Bond Position:  [1.56722291]


portfolio before change:  [-3.39961526]
curr_Stock_Price:  104.87144655966073
curr_Factors:  [104.87144656]
mat_Sqrt:  [[0.15]]
grads:  [0.0514716]
Stock Position:  0.05147159570248945
Bond Position:  [-8.79751596]


portfolio before change:  [-3.39330603]
curr_Stock_Price:  105.00470640502715
curr_Factors:  [105.00470641]
mat_Sqrt:  [[0.15]]
grads:  [0.04278083]
Stock Position:  0.04278083344094171
Bond Position:  [-7.88549488]


portfolio before change:  [-3.36485434]
curr_Stock_Price:  105.68128394367974
curr_Factors:  [105.68128394]
mat_Sqrt:  [[0.15]]
grads:  [-0.00597627]
Stock Position:  -0.0059762740965060325
Bond Position:  [-2.73327402]


portfolio before change:  [-3.36661037]
curr_Stock_Price:  105.94653230969313
curr_Factors:  [105.94653231]
mat_Sqrt:  [[0.15]]
grads:  [0.00385765]
Stock Position:  0.0038576494433090578
Bond Position:  [-3.77531495]


portfolio before change:  [-3.36426904]
curr_Stock_Price:  106.61463031658299
curr_Factors:  [106.61463032]
mat_Sqrt:  [[0.15]]
grads:  [0.03916889]
Stock Position:  0.03916889496463933
Bond Position:  [-7.5402463]


portfolio before change:  [-3.33695764]
curr_Stock_Price:  107.32393513304679
curr_Factors:  [107.32393513]
mat_Sqrt:  [[0.15]]
grads:  [-0.01753678]
Stock Position:  -0.017536782367276335
Bond Position:  [-1.45484114]


portfolio before change:  [-3.33800071]
curr_Stock_Price:  107.37822928906225
curr_Factors:  [107.37822929]
mat_Sqrt:  [[0.15]]
grads:  [0.1322058]
Stock Position:  0.13220579596922163
Bond Position:  [-17.53402499]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.33800071]
Stock Price:  107.95592571212092
PL:  [-11.29392643]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.89076929e-02]
 [ 1.13388895e-03]
 [-3.47481096e-04]
 [ 1.05464910e-03]
 [-8.58881340e-03]
 [ 1.03336005e-02]
 [ 1.01349912e-03]
 [ 1.27830479e-02]
 [ 7.49591956e-03]
 [-1.87865884e-02]
 [ 7.78423004e-03]
 [-5.87245917e-03]
 [-7.59996113e-03]
 [ 4.06024096e-03]
 [-1.17338256e-03]
 [ 8.08936843e-04]
 [ 5.70523456e-03]
 [ 7.96575540e-03]
 [ 2.12809467e-02]
 [ 3.27274621e-03]
 [ 7.80962362e-02]
 [-1.31537281e-02]
 [-2.86326757e-03]
 [ 1.10381402e-02]
 [ 1.37979589e-02]
 [ 1.32249816e-02]
 [ 1.13056029e-02]
 [ 6.23054160e-03]
 [ 5.97302506e-03]
 [-1.36814089e-02]
 [-5.72777115e-03]
 [ 4.08946479e-02]
 [ 3.98641354e-03]
 [-9.00946090e-03]
 [-1.48421563e-03]
 [-6.95174404e-03]
 [-1.68062845e-03]
 [-9.21390318e-04]
 [ 6.06914075e-03]
 [-7.15339060e-03]
 [-4.81144296e-02]
 [-4.13111720e-03]
 [ 1.67817587e-02]
 [-1.56390836e-02]
 [-5.86845249e-03]
 [ 2.86573554e-03]
 [-1.35579498e-02]
 [ 1.73631429e-02]
 [ 2.20639563e-02]
 [-1.31863430e-02]
 [-4.93018824e-03]
 [ 3.68037497e-03]
 [ 3.45885182e-03]
 [-4.58495778e-03]
 [-1.13116763e-02]
 [ 1.26273737e-02]
 [-3.30519857e-02]
 [-1.03626907e-02]
 [ 2.15450905e-02]
 [-1.24655687e-02]
 [ 1.33639332e-02]
 [-1.28213009e-02]
 [-1.26567825e-02]
 [-2.73331169e-03]
 [ 8.96691947e-02]
 [-1.47003522e-02]
 [ 4.91995937e-03]
 [ 5.53196660e-03]
 [ 1.30860046e-02]
 [-2.77494065e-02]
 [-7.87931229e-03]
 [-5.63509725e-03]
 [ 1.11239847e-02]
 [ 5.73157811e-03]
 [-9.99079921e-04]
 [ 2.10470110e-04]
 [ 7.12037193e-03]
 [-2.83598073e-03]
 [ 2.10103289e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.41926717]
curr_Stock_Price:  99.4546175255356
curr_Factors:  [99.45461753]
mat_Sqrt:  [[0.15]]
grads:  [-0.25938462]
Stock Position:  -0.2593846194564755
Bond Position:  [19.37773095]


portfolio before change:  [-6.44905125]
curr_Stock_Price:  99.57411277546319
curr_Factors:  [99.57411278]
mat_Sqrt:  [[0.15]]
grads:  [0.00755926]
Stock Position:  0.007559259661266757
Bond Position:  [-7.20175782]


portfolio before change:  [-6.45078656]
curr_Stock_Price:  99.40409745034482
curr_Factors:  [99.40409745]
mat_Sqrt:  [[0.15]]
grads:  [-0.00231654]
Stock Position:  -0.0023165406394134195
Bond Position:  [-6.22051293]


portfolio before change:  [-6.45131046]
curr_Stock_Price:  99.46241725332423
curr_Factors:  [99.46241725]
mat_Sqrt:  [[0.15]]
grads:  [0.00703099]
Stock Position:  0.007030994024586456
Bond Position:  [-7.15063012]


portfolio before change:  [-6.45393465]
curr_Stock_Price:  99.15275136101025
curr_Factors:  [99.15275136]
mat_Sqrt:  [[0.15]]
grads:  [-0.05725876]
Stock Position:  -0.05725875597310777
Bond Position:  [-0.77657145]


portfolio before change:  [-6.46870864]
curr_Stock_Price:  99.40992533280034
curr_Factors:  [99.40992533]
mat_Sqrt:  [[0.15]]
grads:  [0.06889067]
Stock Position:  0.06889067031500126
Bond Position:  [-13.31712504]


portfolio before change:  [-6.4529223]
curr_Stock_Price:  99.65115817885187
curr_Factors:  [99.65115818]
mat_Sqrt:  [[0.15]]
grads:  [0.00675666]
Stock Position:  0.006756660793560283
Bond Position:  [-7.12623137]


portfolio before change:  [-6.45294412]
curr_Stock_Price:  99.7138488267381
curr_Factors:  [99.71384883]
mat_Sqrt:  [[0.15]]
grads:  [0.08522032]
Stock Position:  0.08522031941030335
Bond Position:  [-14.95059017]


portfolio before change:  [-6.401689]
curr_Stock_Price:  100.32625633749464
curr_Factors:  [100.32625634]
mat_Sqrt:  [[0.15]]
grads:  [0.0499728]
Stock Position:  0.04997279708007319
Bond Position:  [-11.41527265]


portfolio before change:  [-6.43069004]
curr_Stock_Price:  99.76019718164692
curr_Factors:  [99.76019718]
mat_Sqrt:  [[0.15]]
grads:  [-0.12524392]
Stock Position:  -0.12524392241608182
Bond Position:  [6.06366836]


portfolio before change:  [-6.42816399]
curr_Stock_Price:  99.74305417988444
curr_Factors:  [99.74305418]
mat_Sqrt:  [[0.15]]
grads:  [0.05189487]
Stock Position:  0.051894866957298905
Bond Position:  [-11.60431651]


portfolio before change:  [-6.45447349]
curr_Stock_Price:  99.25005340122568
curr_Factors:  [99.2500534]
mat_Sqrt:  [[0.15]]
grads:  [-0.03914973]
Stock Position:  -0.039149727803273714
Bond Position:  [-2.56886091]


portfolio before change:  [-6.4587757]
curr_Stock_Price:  99.35584352986787
curr_Factors:  [99.35584353]
mat_Sqrt:  [[0.15]]
grads:  [-0.05066641]
Stock Position:  -0.05066640756620418
Bond Position:  [-1.42477204]


portfolio before change:  [-6.45890784]
curr_Stock_Price:  99.3566939994425
curr_Factors:  [99.356694]
mat_Sqrt:  [[0.15]]
grads:  [0.02706827]
Stock Position:  0.027068273088208923
Bond Position:  [-9.14832197]


portfolio before change:  [-6.46530016]
curr_Stock_Price:  99.14166251903937
curr_Factors:  [99.14166252]
mat_Sqrt:  [[0.15]]
grads:  [-0.00782255]
Stock Position:  -0.007822550422692868
Bond Position:  [-5.68975951]


portfolio before change:  [-6.47201807]
curr_Stock_Price:  99.95498866436016
curr_Factors:  [99.95498866]
mat_Sqrt:  [[0.15]]
grads:  [0.00539291]
Stock Position:  0.005392912289146115
Bond Position:  [-7.01106656]


portfolio before change:  [-6.47320255]
curr_Stock_Price:  99.81660875484764
curr_Factors:  [99.81660875]
mat_Sqrt:  [[0.15]]
grads:  [0.0380349]
Stock Position:  0.03803489704304785
Bond Position:  [-10.26971698]


portfolio before change:  [-6.48322286]
curr_Stock_Price:  99.57003433806096
curr_Factors:  [99.57003434]
mat_Sqrt:  [[0.15]]
grads:  [0.05310504]
Stock Position:  0.05310503601484639
Bond Position:  [-11.77089311]


portfolio before change:  [-6.45225813]
curr_Stock_Price:  100.16697265779793
curr_Factors:  [100.16697266]
mat_Sqrt:  [[0.15]]
grads:  [0.14187298]
Stock Position:  0.14187297795855744
Bond Position:  [-20.66324483]


portfolio before change:  [-6.42691706]
curr_Stock_Price:  100.35469384014037
curr_Factors:  [100.35469384]
mat_Sqrt:  [[0.15]]
grads:  [0.02181831]
Stock Position:  0.021818308079117017
Bond Position:  [-8.61648669]


portfolio before change:  [-6.41947307]
curr_Stock_Price:  100.72055801365681
curr_Factors:  [100.72055801]
mat_Sqrt:  [[0.15]]
grads:  [0.52064157]
Stock Position:  0.5206415748566848
Bond Position:  [-58.85878301]


portfolio before change:  [-6.31866343]
curr_Stock_Price:  100.9212496750653
curr_Factors:  [100.92124968]
mat_Sqrt:  [[0.15]]
grads:  [-0.08769152]
Stock Position:  -0.0876915207389905
Bond Position:  [2.53127442]


portfolio before change:  [-6.24359617]
curr_Stock_Price:  100.06701596847128
curr_Factors:  [100.06701597]
mat_Sqrt:  [[0.15]]
grads:  [-0.01908845]
Stock Position:  -0.019088450478377216
Bond Position:  [-4.33347189]


portfolio before change:  [-6.24445913]
curr_Stock_Price:  100.09803490434021
curr_Factors:  [100.0980349]
mat_Sqrt:  [[0.15]]
grads:  [0.0735876]
Stock Position:  0.07358760123868241
Bond Position:  [-13.6104334]


portfolio before change:  [-6.23015423]
curr_Stock_Price:  100.30398774206486
curr_Factors:  [100.30398774]
mat_Sqrt:  [[0.15]]
grads:  [0.09198639]
Stock Position:  0.09198639235335354
Bond Position:  [-15.4567562]


portfolio before change:  [-6.11762214]
curr_Stock_Price:  101.53784599237561
curr_Factors:  [101.53784599]
mat_Sqrt:  [[0.15]]
grads:  [0.08816654]
Stock Position:  0.08816654399926481
Bond Position:  [-15.0698631]


portfolio before change:  [-6.09650096]
curr_Stock_Price:  101.78808915741841
curr_Factors:  [101.78808916]
mat_Sqrt:  [[0.15]]
grads:  [0.07537069]
Stock Position:  0.07537068600427567
Bond Position:  [-13.76833907]


portfolio before change:  [-6.09713876]
curr_Stock_Price:  101.79104450218188
curr_Factors:  [101.7910445]
mat_Sqrt:  [[0.15]]
grads:  [0.04153694]
Stock Position:  0.04153694401016708
Bond Position:  [-10.32522768]


portfolio before change:  [-6.06853804]
curr_Stock_Price:  102.49514215988091
curr_Factors:  [102.49514216]
mat_Sqrt:  [[0.15]]
grads:  [0.03982017]
Stock Position:  0.03982016704234848
Bond Position:  [-10.14991172]


portfolio before change:  [-6.05829667]
curr_Stock_Price:  102.76826410166733
curr_Factors:  [102.7682641]
mat_Sqrt:  [[0.15]]
grads:  [-0.09120939]
Stock Position:  -0.09120939235960043
Bond Position:  [3.31513425]


portfolio before change:  [-6.10693917]
curr_Stock_Price:  103.30384159482374
curr_Factors:  [103.30384159]
mat_Sqrt:  [[0.15]]
grads:  [-0.03818514]
Stock Position:  -0.03818514098018899
Bond Position:  [-2.16226741]


portfolio before change:  [-6.11973118]
curr_Stock_Price:  103.63530213350356
curr_Factors:  [103.63530213]
mat_Sqrt:  [[0.15]]
grads:  [0.27263099]
Stock Position:  0.2726309860399879
Bond Position:  [-34.37392579]


portfolio before change:  [-5.91000339]
curr_Stock_Price:  104.41245598957047
curr_Factors:  [104.41245599]
mat_Sqrt:  [[0.15]]
grads:  [0.02657609]
Stock Position:  0.02657609023874812
Bond Position:  [-8.68487825]


portfolio before change:  [-5.89197365]
curr_Stock_Price:  105.11130100964745
curr_Factors:  [105.11130101]
mat_Sqrt:  [[0.15]]
grads:  [-0.06006307]
Stock Position:  -0.060063072694306635
Bond Position:  [0.42133407]


portfolio before change:  [-5.93506133]
curr_Stock_Price:  105.8291132996415
curr_Factors:  [105.8291133]
mat_Sqrt:  [[0.15]]
grads:  [-0.00989477]
Stock Position:  -0.009894770897818471
Bond Position:  [-4.88790649]


portfolio before change:  [-5.93943827]
curr_Stock_Price:  106.24058709600266
curr_Factors:  [106.2405871]
mat_Sqrt:  [[0.15]]
grads:  [-0.04634496]
Stock Position:  -0.04634496024047813
Bond Position:  [-1.01572248]


portfolio before change:  [-5.89717476]
curr_Stock_Price:  105.3272840253444
curr_Factors:  [105.32728403]
mat_Sqrt:  [[0.15]]
grads:  [-0.01120419]
Stock Position:  -0.01120418963951485
Bond Position:  [-4.71706789]


portfolio before change:  [-5.89136696]
curr_Stock_Price:  104.78261094623873
curr_Factors:  [104.78261095]
mat_Sqrt:  [[0.15]]
grads:  [-0.0061426]
Stock Position:  -0.006142602120307849
Bond Position:  [-5.24772908]


portfolio before change:  [-5.89383074]
curr_Stock_Price:  105.13031134536321
curr_Factors:  [105.13031135]
mat_Sqrt:  [[0.15]]
grads:  [0.04046094]
Stock Position:  0.04046093836595706
Bond Position:  [-10.14750179]


portfolio before change:  [-5.93059487]
curr_Stock_Price:  104.23735403153138
curr_Factors:  [104.23735403]
mat_Sqrt:  [[0.15]]
grads:  [-0.04768927]
Stock Position:  -0.047689270662711544
Bond Position:  [-0.95959148]


portfolio before change:  [-5.92355531]
curr_Stock_Price:  104.08848334735839
curr_Factors:  [104.08848335]
mat_Sqrt:  [[0.15]]
grads:  [-0.32076286]
Stock Position:  -0.32076286409844224
Bond Position:  [27.46416472]


portfolio before change:  [-6.0889769]
curr_Stock_Price:  104.60954788228142
curr_Factors:  [104.60954788]
mat_Sqrt:  [[0.15]]
grads:  [-0.02754078]
Stock Position:  -0.027540781328546732
Bond Position:  [-3.20794822]


portfolio before change:  [-6.0958305]
curr_Stock_Price:  104.85112030708929
curr_Factors:  [104.85112031]
mat_Sqrt:  [[0.15]]
grads:  [0.11187839]
Stock Position:  0.11187839119458849
Bond Position:  [-17.82640515]


portfolio before change:  [-6.05107093]
curr_Stock_Price:  105.2611526292881
curr_Factors:  [105.26115263]
mat_Sqrt:  [[0.15]]
grads:  [-0.10426056]
Stock Position:  -0.10426055715413152
Bond Position:  [4.92351549]


portfolio before change:  [-6.06092747]
curr_Stock_Price:  105.35864172665319
curr_Factors:  [105.35864173]
mat_Sqrt:  [[0.15]]
grads:  [-0.03912302]
Stock Position:  -0.03912301659201381
Bond Position:  [-1.93897958]


portfolio before change:  [-6.05159865]
curr_Stock_Price:  105.11709577074039
curr_Factors:  [105.11709577]
mat_Sqrt:  [[0.15]]
grads:  [0.0191049]
Stock Position:  0.01910490360912422
Bond Position:  [-8.05985063]


portfolio before change:  [-6.04048914]
curr_Stock_Price:  105.7249643081971
curr_Factors:  [105.72496431]
mat_Sqrt:  [[0.15]]
grads:  [-0.09038633]
Stock Position:  -0.09038633206325743
Bond Position:  [3.5156026]


portfolio before change:  [-6.01595536]
curr_Stock_Price:  105.45596302205027
curr_Factors:  [105.45596302]
mat_Sqrt:  [[0.15]]
grads:  [0.11575429]
Stock Position:  0.1157542856848205
Bond Position:  [-18.22293503]


portfolio before change:  [-6.07369687]
curr_Stock_Price:  104.9669742967657
curr_Factors:  [104.9669743]
mat_Sqrt:  [[0.15]]
grads:  [0.14709304]
Stock Position:  0.14709304220214323
Bond Position:  [-21.51360845]


portfolio before change:  [-5.94000423]
curr_Stock_Price:  105.88501419924062
curr_Factors:  [105.8850142]
mat_Sqrt:  [[0.15]]
grads:  [-0.08790895]
Stock Position:  -0.08790895358991203
Bond Position:  [3.36823656]


portfolio before change:  [-6.02036549]
curr_Stock_Price:  106.80155083303458
curr_Factors:  [106.80155083]
mat_Sqrt:  [[0.15]]
grads:  [-0.03286792]
Stock Position:  -0.032867921594937906
Bond Position:  [-2.51002049]


portfolio before change:  [-5.99853421]
curr_Stock_Price:  106.1325654714723
curr_Factors:  [106.13256547]
mat_Sqrt:  [[0.15]]
grads:  [0.02453583]
Stock Position:  0.024535833165703916
Bond Position:  [-8.60258513]


portfolio before change:  [-5.9868257]
curr_Stock_Price:  106.63168005944037
curr_Factors:  [106.63168006]
mat_Sqrt:  [[0.15]]
grads:  [0.02305901]
Stock Position:  0.023059012164499487
Bond Position:  [-8.44564691]


portfolio before change:  [-6.00522803]
curr_Stock_Price:  105.85651842287565
curr_Factors:  [105.85651842]
mat_Sqrt:  [[0.15]]
grads:  [-0.03056639]
Stock Position:  -0.030566385179911552
Bond Position:  [-2.76957691]


portfolio before change:  [-6.01582972]
curr_Stock_Price:  106.19769677057737
curr_Factors:  [106.19769677]
mat_Sqrt:  [[0.15]]
grads:  [-0.07541118]
Stock Position:  -0.07541117524802748
Bond Position:  [1.9926634]


portfolio before change:  [-6.03510559]
curr_Stock_Price:  106.45495861712865
curr_Factors:  [106.45495862]
mat_Sqrt:  [[0.15]]
grads:  [0.08418249]
Stock Position:  0.08418249118094209
Bond Position:  [-14.99674921]


portfolio before change:  [-6.02396923]
curr_Stock_Price:  106.59838140743575
curr_Factors:  [106.59838141]
mat_Sqrt:  [[0.15]]
grads:  [-0.22034657]
Stock Position:  -0.22034657159186766
Bond Position:  [17.46461865]


portfolio before change:  [-6.01243323]
curr_Stock_Price:  106.55098141694418
curr_Factors:  [106.55098142]
mat_Sqrt:  [[0.15]]
grads:  [-0.0690846]
Stock Position:  -0.06908460482785973
Bond Position:  [1.34859921]


portfolio before change:  [-6.05913467]
curr_Stock_Price:  107.22820502081761
curr_Factors:  [107.22820502]
mat_Sqrt:  [[0.15]]
grads:  [0.14363394]
Stock Position:  0.14363393666928623
Bond Position:  [-21.46074388]


portfolio before change:  [-5.96475783]
curr_Stock_Price:  107.89460867492384
curr_Factors:  [107.89460867]
mat_Sqrt:  [[0.15]]
grads:  [-0.08310379]
Stock Position:  -0.0831037911822822
Bond Position:  [3.0016932]


portfolio before change:  [-6.01950882]
curr_Stock_Price:  108.55569292046572
curr_Factors:  [108.55569292]
mat_Sqrt:  [[0.15]]
grads:  [0.08909289]
Stock Position:  0.08909288783992535
Bond Position:  [-15.691049]


portfolio before change:  [-6.00844439]
curr_Stock_Price:  108.69089068446895
curr_Factors:  [108.69089068]
mat_Sqrt:  [[0.15]]
grads:  [-0.08547534]
Stock Position:  -0.08547533923057478
Bond Position:  [3.28194637]


portfolio before change:  [-5.93916008]
curr_Stock_Price:  107.8827140293267
curr_Factors:  [107.88271403]
mat_Sqrt:  [[0.15]]
grads:  [-0.08437855]
Stock Position:  -0.08437855016346313
Bond Position:  [3.16382691]


portfolio before change:  [-5.83806921]
curr_Stock_Price:  106.68699391739469
curr_Factors:  [106.68699392]
mat_Sqrt:  [[0.15]]
grads:  [-0.01822208]
Stock Position:  -0.01822207792718755
Bond Position:  [-3.89401049]


portfolio before change:  [-5.83217656]
curr_Stock_Price:  106.3502579456516
curr_Factors:  [106.35025795]
mat_Sqrt:  [[0.15]]
grads:  [0.59779463]
Stock Position:  0.5977946313377213
Bond Position:  [-69.4077898]


portfolio before change:  [-5.87874085]
curr_Stock_Price:  106.27962136875051
curr_Factors:  [106.27962137]
mat_Sqrt:  [[0.15]]
grads:  [-0.09800235]
Stock Position:  -0.09800234767398447
Bond Position:  [4.53691155]


portfolio before change:  [-5.94798056]
curr_Stock_Price:  106.98902550148847
curr_Factors:  [106.9890255]
mat_Sqrt:  [[0.15]]
grads:  [0.03279973]
Stock Position:  0.03279972914773399
Bond Position:  [-9.45719161]


portfolio before change:  [-5.97391404]
curr_Stock_Price:  106.21638525360775
curr_Factors:  [106.21638525]
mat_Sqrt:  [[0.15]]
grads:  [0.03687978]
Stock Position:  0.0368797773480539
Bond Position:  [-9.89115068]


portfolio before change:  [-5.98652811]
curr_Stock_Price:  105.89111619505077
curr_Factors:  [105.8911162]
mat_Sqrt:  [[0.15]]
grads:  [0.08724003]
Stock Position:  0.0872400308174123
Bond Position:  [-15.22447235]


portfolio before change:  [-5.92282635]
curr_Stock_Price:  106.63221313467227
curr_Factors:  [106.63221313]
mat_Sqrt:  [[0.15]]
grads:  [-0.18499604]
Stock Position:  -0.18499604356345878
Bond Position:  [13.8037112]


portfolio before change:  [-5.79870224]
curr_Stock_Price:  105.96592135439727
curr_Factors:  [105.96592135]
mat_Sqrt:  [[0.15]]
grads:  [-0.05252875]
Stock Position:  -0.05252874862093904
Bond Position:  [-0.232445]


portfolio before change:  [-5.8225444]
curr_Stock_Price:  106.41953247035582
curr_Factors:  [106.41953247]
mat_Sqrt:  [[0.15]]
grads:  [-0.03756732]
Stock Position:  -0.03756731501877884
Bond Position:  [-1.8246483]


portfolio before change:  [-5.81327868]
curr_Stock_Price:  106.16985381084602
curr_Factors:  [106.16985381]
mat_Sqrt:  [[0.15]]
grads:  [0.0741599]
Stock Position:  0.07415989777537188
Bond Position:  [-13.68682419]


portfolio before change:  [-5.83788727]
curr_Stock_Price:  105.84955758944137
curr_Factors:  [105.84955759]
mat_Sqrt:  [[0.15]]
grads:  [0.03821052]
Stock Position:  0.03821052075067312
Bond Position:  [-9.88245399]


portfolio before change:  [-5.83902444]
curr_Stock_Price:  105.83596204423019
curr_Factors:  [105.83596204]
mat_Sqrt:  [[0.15]]
grads:  [-0.00666053]
Stock Position:  -0.006660532808554625
Bond Position:  [-5.13410054]


portfolio before change:  [-5.83927589]
curr_Stock_Price:  105.82553675550939
curr_Factors:  [105.82553676]
mat_Sqrt:  [[0.15]]
grads:  [0.00140313]
Stock Position:  0.0014031340689668128
Bond Position:  [-5.98776331]


portfolio before change:  [-5.83953926]
curr_Stock_Price:  105.9045615128303
curr_Factors:  [105.90456151]
mat_Sqrt:  [[0.15]]
grads:  [0.04746915]
Stock Position:  0.0474691461786437
Bond Position:  [-10.86673837]


portfolio before change:  [-5.81700507]
curr_Stock_Price:  106.39358176546331
curr_Factors:  [106.39358177]
mat_Sqrt:  [[0.15]]
grads:  [-0.01890654]
Stock Position:  -0.018906538214305373
Bond Position:  [-3.80547075]


portfolio before change:  [-5.82114859]
curr_Stock_Price:  106.60015948953169
curr_Factors:  [106.60015949]
mat_Sqrt:  [[0.15]]
grads:  [0.14006886]
Stock Position:  0.14006885928485158
Bond Position:  [-20.75251133]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.82114859]
Stock Price:  106.72469893681343
PL:  [-12.54584753]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.47338892e-02]
 [-1.32531891e-03]
 [ 1.14508457e-03]
 [ 3.17382598e-03]
 [-1.74769778e-03]
 [ 1.22033978e-02]
 [-9.64260827e-04]
 [ 1.49345055e-02]
 [-7.47684106e-03]
 [-1.56016552e-02]
 [ 1.01172646e-02]
 [-6.98610321e-03]
 [ 2.29652685e-03]
 [ 4.14859422e-03]
 [ 3.88581220e-03]
 [ 1.30252416e-02]
 [-1.00529825e-03]
 [ 3.73049020e-03]
 [ 1.59893233e-02]
 [ 1.18766018e-02]
 [ 4.74968626e-02]
 [-1.64499848e-02]
 [-1.31541822e-03]
 [ 1.39481355e-02]
 [ 8.15645472e-03]
 [ 8.23983417e-03]
 [ 1.44217149e-02]
 [-1.53189145e-02]
 [ 1.82480338e-03]
 [-5.58803425e-03]
 [-3.52368556e-03]
 [-1.67148988e-02]
 [ 1.87080320e-02]
 [ 1.07316422e-02]
 [-2.29842411e-02]
 [ 7.95525599e-03]
 [-2.74884184e-03]
 [ 4.99291174e-03]
 [ 4.83855053e-03]
 [-1.55778642e-02]
 [ 3.44275322e-02]
 [-1.05311693e-03]
 [ 4.32481659e-03]
 [-8.23979994e-03]
 [ 1.90177324e-03]
 [-4.44152937e-03]
 [-1.36377403e-02]
 [-9.24563873e-04]
 [-5.11393455e-03]
 [ 5.72658123e-03]
 [-3.38116035e-03]
 [ 3.02021855e-03]
 [ 3.30689716e-03]
 [ 1.47232216e-03]
 [ 1.63336786e-03]
 [ 8.83443527e-03]
 [ 5.73199400e-04]
 [-1.98858222e-02]
 [ 1.34537965e-02]
 [ 8.30709396e-03]
 [ 6.90560071e-03]
 [-1.23806196e-02]
 [-1.25406072e-02]
 [-2.15179749e-03]
 [-1.49335206e-02]
 [ 4.21547334e-02]
 [ 1.77572549e-02]
 [ 2.19408786e-03]
 [ 6.35983532e-03]
 [-1.44821321e-02]
 [-5.59789233e-03]
 [-4.53085747e-04]
 [ 2.16179578e-03]
 [ 8.61851036e-03]
 [ 9.68327704e-03]
 [-9.42937177e-03]
 [ 1.71037972e-03]
 [-6.81272481e-03]
 [ 1.52965809e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.4103382]
curr_Stock_Price:  99.77654469401767
curr_Factors:  [99.77654469]
mat_Sqrt:  [[0.15]]
grads:  [-0.23155926]
Stock Position:  -0.2315592614568948
Bond Position:  [21.6938448]


portfolio before change:  [-1.5823109]
curr_Stock_Price:  100.52507274584207
curr_Factors:  [100.52507275]
mat_Sqrt:  [[0.15]]
grads:  [-0.00883546]
Stock Position:  -0.008835459407901125
Bond Position:  [-0.6941257]


portfolio before change:  [-1.58474225]
curr_Stock_Price:  100.79534403971019
curr_Factors:  [100.79534404]
mat_Sqrt:  [[0.15]]
grads:  [0.0076339]
Stock Position:  0.0076338971583448
Bond Position:  [-2.35420354]


portfolio before change:  [-1.57843989]
curr_Stock_Price:  101.64019459056725
curr_Factors:  [101.64019459]
mat_Sqrt:  [[0.15]]
grads:  [0.02115884]
Stock Position:  0.02115883989820697
Bond Position:  [-3.7290285]


portfolio before change:  [-1.56787457]
curr_Stock_Price:  102.15054348018691
curr_Factors:  [102.15054348]
mat_Sqrt:  [[0.15]]
grads:  [-0.01165132]
Stock Position:  -0.01165131853573205
Bond Position:  [-0.37768605]


portfolio before change:  [-1.57643196]
curr_Stock_Price:  102.8829739517249
curr_Factors:  [102.88297395]
mat_Sqrt:  [[0.15]]
grads:  [0.08135599]
Stock Position:  0.08135598559581214
Bond Position:  [-9.94657771]


portfolio before change:  [-1.58714819]
curr_Stock_Price:  102.75889523744726
curr_Factors:  [102.75889524]
mat_Sqrt:  [[0.15]]
grads:  [-0.00642841]
Stock Position:  -0.006428405513927622
Bond Position:  [-0.92657234]


portfolio before change:  [-1.5851465]
curr_Stock_Price:  102.4385042627578
curr_Factors:  [102.43850426]
mat_Sqrt:  [[0.15]]
grads:  [0.09956337]
Stock Position:  0.0995633702342514
Bond Position:  [-11.78426922]


portfolio before change:  [-1.67071634]
curr_Stock_Price:  101.58645089342498
curr_Factors:  [101.58645089]
mat_Sqrt:  [[0.15]]
grads:  [-0.04984561]
Stock Position:  -0.04984560706061033
Bond Position:  [3.39292197]


portfolio before change:  [-1.66476092]
curr_Stock_Price:  101.47122792619436
curr_Factors:  [101.47122793]
mat_Sqrt:  [[0.15]]
grads:  [-0.10401103]
Stock Position:  -0.10401103467193425
Bond Position:  [8.88936649]


portfolio before change:  [-1.64507057]
curr_Stock_Price:  101.28725947759354
curr_Factors:  [101.28725948]
mat_Sqrt:  [[0.15]]
grads:  [0.06744843]
Stock Position:  0.06744843039544395
Bond Position:  [-8.47673724]


portfolio before change:  [-1.67116927]
curr_Stock_Price:  100.90817140005457
curr_Factors:  [100.9081714]
mat_Sqrt:  [[0.15]]
grads:  [-0.04657402]
Stock Position:  -0.04657402141212997
Bond Position:  [3.02853006]


portfolio before change:  [-1.6641205]
curr_Stock_Price:  100.76089012966469
curr_Factors:  [100.76089013]
mat_Sqrt:  [[0.15]]
grads:  [0.01531018]
Stock Position:  0.015310178967495999
Bond Position:  [-3.20678776]


portfolio before change:  [-1.66040326]
curr_Stock_Price:  101.01677684563663
curr_Factors:  [101.01677685]
mat_Sqrt:  [[0.15]]
grads:  [0.02765729]
Stock Position:  0.027657294789864333
Bond Position:  [-4.45425404]


portfolio before change:  [-1.69631839]
curr_Stock_Price:  99.72826581275582
curr_Factors:  [99.72826581]
mat_Sqrt:  [[0.15]]
grads:  [0.02590541]
Stock Position:  0.025905414666261957
Bond Position:  [-4.27982047]


portfolio before change:  [-1.71327083]
curr_Stock_Price:  99.08419437944376
curr_Factors:  [99.08419438]
mat_Sqrt:  [[0.15]]
grads:  [0.08683494]
Stock Position:  0.08683494386647804
Bond Position:  [-10.31724128]


portfolio before change:  [-1.72790619]
curr_Stock_Price:  98.92307820351711
curr_Factors:  [98.9230782]
mat_Sqrt:  [[0.15]]
grads:  [-0.00670199]
Stock Position:  -0.006701988337348167
Bond Position:  [-1.06492487]


portfolio before change:  [-1.72439032]
curr_Stock_Price:  98.38854663841768
curr_Factors:  [98.38854664]
mat_Sqrt:  [[0.15]]
grads:  [0.02486993]
Stock Position:  0.02486993463397354
Bond Position:  [-4.17130705]


portfolio before change:  [-1.71653929]
curr_Stock_Price:  98.71471352185037
curr_Factors:  [98.71471352]
mat_Sqrt:  [[0.15]]
grads:  [0.10659549]
Stock Position:  0.10659548873736108
Bond Position:  [-12.23908242]


portfolio before change:  [-1.69431751]
curr_Stock_Price:  98.93035818226306
curr_Factors:  [98.93035818]
mat_Sqrt:  [[0.15]]
grads:  [0.07917735]
Stock Position:  0.0791773452687549
Bond Position:  [-9.52736064]


portfolio before change:  [-1.6966145]
curr_Stock_Price:  98.9088683201229
curr_Factors:  [98.90886832]
mat_Sqrt:  [[0.15]]
grads:  [0.31664575]
Stock Position:  0.31664575048347987
Bond Position:  [-33.01568734]


portfolio before change:  [-1.56738599]
curr_Stock_Price:  99.32350217888684
curr_Factors:  [99.32350218]
mat_Sqrt:  [[0.15]]
grads:  [-0.10966657]
Stock Position:  -0.109666565526913
Bond Position:  [9.32508137]


portfolio before change:  [-1.54471345]
curr_Stock_Price:  99.12207612305241
curr_Factors:  [99.12207612]
mat_Sqrt:  [[0.15]]
grads:  [-0.00876945]
Stock Position:  -0.008769454815777325
Bond Position:  [-0.67546689]


portfolio before change:  [-1.54624977]
curr_Stock_Price:  99.29245175436067
curr_Factors:  [99.29245175]
mat_Sqrt:  [[0.15]]
grads:  [0.09298757]
Stock Position:  0.09298756983709125
Bond Position:  [-10.77921356]


portfolio before change:  [-1.56430976]
curr_Stock_Price:  99.10547762706247
curr_Factors:  [99.10547763]
mat_Sqrt:  [[0.15]]
grads:  [0.05437636]
Stock Position:  0.05437636483009975
Bond Position:  [-6.95330537]


portfolio before change:  [-1.60003206]
curr_Stock_Price:  98.45652477370692
curr_Factors:  [98.45652477]
mat_Sqrt:  [[0.15]]
grads:  [0.05493223]
Stock Position:  0.05493222778356663
Bond Position:  [-7.0084683]


portfolio before change:  [-1.63433115]
curr_Stock_Price:  97.84010966626595
curr_Factors:  [97.84010967]
mat_Sqrt:  [[0.15]]
grads:  [0.09614477]
Stock Position:  0.09614476619814122
Bond Position:  [-11.04114562]


portfolio before change:  [-1.57231755]
curr_Stock_Price:  98.49228974487121
curr_Factors:  [98.49228974]
mat_Sqrt:  [[0.15]]
grads:  [-0.1021261]
Stock Position:  -0.10212609649511448
Bond Position:  [8.48631554]


portfolio before change:  [-1.56468268]
curr_Stock_Price:  98.42272418467446
curr_Factors:  [98.42272418]
mat_Sqrt:  [[0.15]]
grads:  [0.01216536]
Stock Position:  0.01216535586308588
Bond Position:  [-2.76203014]


portfolio before change:  [-1.5707309]
curr_Stock_Price:  97.93974689917468
curr_Factors:  [97.9397469]
mat_Sqrt:  [[0.15]]
grads:  [-0.03725356]
Stock Position:  -0.0372535616862603
Bond Position:  [2.0778735]


portfolio before change:  [-1.56160943]
curr_Stock_Price:  97.69838478005529
curr_Factors:  [97.69838478]
mat_Sqrt:  [[0.15]]
grads:  [-0.02349124]
Stock Position:  -0.023491237080863266
Bond Position:  [0.73344649]


portfolio before change:  [-1.57245132]
curr_Stock_Price:  98.16186556650716
curr_Factors:  [98.16186557]
mat_Sqrt:  [[0.15]]
grads:  [-0.11143266]
Stock Position:  -0.11143265860332485
Bond Position:  [9.36598633]


portfolio before change:  [-1.51477949]
curr_Stock_Price:  97.6495701146268
curr_Factors:  [97.64957011]
mat_Sqrt:  [[0.15]]
grads:  [0.12472021]
Stock Position:  0.12472021338878916
Bond Position:  [-13.69365471]


portfolio before change:  [-1.49775083]
curr_Stock_Price:  97.79296741839292
curr_Factors:  [97.79296742]
mat_Sqrt:  [[0.15]]
grads:  [0.07154428]
Stock Position:  0.07154428161687536
Bond Position:  [-8.49427843]


portfolio before change:  [-1.53240159]
curr_Stock_Price:  97.3160620073469
curr_Factors:  [97.31606201]
mat_Sqrt:  [[0.15]]
grads:  [-0.15322827]
Stock Position:  -0.15322827379970969
Bond Position:  [13.3791706]


portfolio before change:  [-1.48139965]
curr_Stock_Price:  96.98866995198055
curr_Factors:  [96.98866995]
mat_Sqrt:  [[0.15]]
grads:  [0.05303504]
Stock Position:  0.05303503994611057
Bond Position:  [-6.62519763]


portfolio before change:  [-1.45259252]
curr_Stock_Price:  97.53964940545629
curr_Factors:  [97.53964941]
mat_Sqrt:  [[0.15]]
grads:  [-0.01832561]
Stock Position:  -0.018325612265263323
Bond Position:  [0.33488128]


portfolio before change:  [-1.45780241]
curr_Stock_Price:  97.82508706659168
curr_Factors:  [97.82508707]
mat_Sqrt:  [[0.15]]
grads:  [0.03328608]
Stock Position:  0.033286078291367455
Bond Position:  [-4.71401591]


portfolio before change:  [-1.47441236]
curr_Stock_Price:  97.3349327152419
curr_Factors:  [97.33493272]
mat_Sqrt:  [[0.15]]
grads:  [0.032257]
Stock Position:  0.032257003527952355
Bond Position:  [-4.61414563]


portfolio before change:  [-1.46946914]
curr_Stock_Price:  97.49711811928259
curr_Factors:  [97.49711812]
mat_Sqrt:  [[0.15]]
grads:  [-0.10385243]
Stock Position:  -0.10385242790849318
Bond Position:  [8.6558433]


portfolio before change:  [-1.48560339]
curr_Stock_Price:  97.65768505674885
curr_Factors:  [97.65768506]
mat_Sqrt:  [[0.15]]
grads:  [0.22951688]
Stock Position:  0.22951688115092495
Bond Position:  [-23.89969069]


portfolio before change:  [-1.41213093]
curr_Stock_Price:  97.98431133007742
curr_Factors:  [97.98431133]
mat_Sqrt:  [[0.15]]
grads:  [-0.00702078]
Stock Position:  -0.007020779530816899
Bond Position:  [-0.72420468]


portfolio before change:  [-1.41249036]
curr_Stock_Price:  98.02906028300619
curr_Factors:  [98.02906028]
mat_Sqrt:  [[0.15]]
grads:  [0.02883211]
Stock Position:  0.028832110619658013
Bond Position:  [-4.23887507]


portfolio before change:  [-1.41442212]
curr_Stock_Price:  97.97124903149563
curr_Factors:  [97.97124903]
mat_Sqrt:  [[0.15]]
grads:  [-0.054932]
Stock Position:  -0.0549319996308479
Bond Position:  [3.96733449]


portfolio before change:  [-1.43523349]
curr_Stock_Price:  98.3546199242556
curr_Factors:  [98.35461992]
mat_Sqrt:  [[0.15]]
grads:  [0.01267849]
Stock Position:  0.012678488285740162
Bond Position:  [-2.68222138]


portfolio before change:  [-1.4395974]
curr_Stock_Price:  98.02364431964521
curr_Factors:  [98.02364432]
mat_Sqrt:  [[0.15]]
grads:  [-0.0296102]
Stock Position:  -0.029610195791341158
Bond Position:  [1.4629019]


portfolio before change:  [-1.43777653]
curr_Stock_Price:  97.96523751673335
curr_Factors:  [97.96523752]
mat_Sqrt:  [[0.15]]
grads:  [-0.09091827]
Stock Position:  -0.09091826859134197
Bond Position:  [7.46905325]


portfolio before change:  [-1.43257551]
curr_Stock_Price:  97.91316672792351
curr_Factors:  [97.91316673]
mat_Sqrt:  [[0.15]]
grads:  [-0.00616376]
Stock Position:  -0.006163759151194814
Bond Position:  [-0.82906234]


portfolio before change:  [-1.43151887]
curr_Stock_Price:  97.7333313727426
curr_Factors:  [97.73333137]
mat_Sqrt:  [[0.15]]
grads:  [-0.0340929]
Stock Position:  -0.03409289700641342
Bond Position:  [1.90049353]


portfolio before change:  [-1.43563998]
curr_Stock_Price:  97.85769426029319
curr_Factors:  [97.85769426]
mat_Sqrt:  [[0.15]]
grads:  [0.03817721]
Stock Position:  0.03817720817945139
Bond Position:  [-5.17157354]


portfolio before change:  [-1.44209207]
curr_Stock_Price:  97.69715703886848
curr_Factors:  [97.69715704]
mat_Sqrt:  [[0.15]]
grads:  [-0.02254107]
Stock Position:  -0.022541068997714204
Bond Position:  [0.76010628]


portfolio before change:  [-1.4387198]
curr_Stock_Price:  97.5496591382728
curr_Factors:  [97.54965914]
mat_Sqrt:  [[0.15]]
grads:  [0.02013479]
Stock Position:  0.02013479034732881
Bond Position:  [-3.40286174]


portfolio before change:  [-1.44102467]
curr_Stock_Price:  97.44575043039931
curr_Factors:  [97.44575043]
mat_Sqrt:  [[0.15]]
grads:  [0.02204598]
Stock Position:  0.02204598109116356
Bond Position:  [-3.58931184]


portfolio before change:  [-1.42026843]
curr_Stock_Price:  98.39742414082852
curr_Factors:  [98.39742414]
mat_Sqrt:  [[0.15]]
grads:  [0.00981548]
Stock Position:  0.00981548104358235
Bond Position:  [-2.38608648]


portfolio before change:  [-1.41035911]
curr_Stock_Price:  99.42217767663465
curr_Factors:  [99.42217768]
mat_Sqrt:  [[0.15]]
grads:  [0.01088912]
Stock Position:  0.010889119080760212
Bond Position:  [-2.49297905]


portfolio before change:  [-1.40411266]
curr_Stock_Price:  100.01012850392218
curr_Factors:  [100.0101285]
mat_Sqrt:  [[0.15]]
grads:  [0.05889624]
Stock Position:  0.05889623515400542
Bond Position:  [-7.29433271]


portfolio before change:  [-1.37021642]
curr_Stock_Price:  100.59339418516934
curr_Factors:  [100.59339419]
mat_Sqrt:  [[0.15]]
grads:  [0.00382133]
Stock Position:  0.0038213293365547615
Bond Position:  [-1.75461691]


portfolio before change:  [-1.36917542]
curr_Stock_Price:  100.89451164627509
curr_Factors:  [100.89451165]
mat_Sqrt:  [[0.15]]
grads:  [-0.13257215]
Stock Position:  -0.13257214813278514
Bond Position:  [12.00662672]


portfolio before change:  [-1.39297637]
curr_Stock_Price:  101.07970427827752
curr_Factors:  [101.07970428]
mat_Sqrt:  [[0.15]]
grads:  [0.08969198]
Stock Position:  0.08969197696155111
Bond Position:  [-10.45901487]


portfolio before change:  [-1.44881849]
curr_Stock_Price:  100.4643937550488
curr_Factors:  [100.46439376]
mat_Sqrt:  [[0.15]]
grads:  [0.05538063]
Stock Position:  0.05538062642861888
Bond Position:  [-7.01259955]


portfolio before change:  [-1.47119231]
curr_Stock_Price:  100.06830737537801
curr_Factors:  [100.06830738]
mat_Sqrt:  [[0.15]]
grads:  [0.04603734]
Stock Position:  0.04603733805253926
Bond Position:  [-6.0780708]


portfolio before change:  [-1.46676958]
curr_Stock_Price:  100.17262741540335
curr_Factors:  [100.17262742]
mat_Sqrt:  [[0.15]]
grads:  [-0.08253746]
Stock Position:  -0.08253746398422615
Bond Position:  [6.80122505]


portfolio before change:  [-1.44508937]
curr_Stock_Price:  99.91510654717574
curr_Factors:  [99.91510655]
mat_Sqrt:  [[0.15]]
grads:  [-0.08360405]
Stock Position:  -0.08360404775593154
Bond Position:  [6.90821797]


portfolio before change:  [-1.43203308]
curr_Stock_Price:  99.76410298144556
curr_Factors:  [99.76410298]
mat_Sqrt:  [[0.15]]
grads:  [-0.01434532]
Stock Position:  -0.014345316627531043
Bond Position:  [-0.00088544]


portfolio before change:  [-1.43453268]
curr_Stock_Price:  99.93834391056852
curr_Factors:  [99.93834391]
mat_Sqrt:  [[0.15]]
grads:  [-0.0995568]
Stock Position:  -0.09955680381098078
Bond Position:  [8.51500942]


portfolio before change:  [-1.4480778]
curr_Stock_Price:  100.07974380514428
curr_Factors:  [100.07974381]
mat_Sqrt:  [[0.15]]
grads:  [0.28103156]
Stock Position:  0.2810315556910175
Bond Position:  [-29.57364389]


portfolio before change:  [-1.46816662]
curr_Stock_Price:  100.01483858313654
curr_Factors:  [100.01483858]
mat_Sqrt:  [[0.15]]
grads:  [0.1183817]
Stock Position:  0.11838169925347485
Bond Position:  [-13.30809317]


portfolio before change:  [-1.51328089]
curr_Stock_Price:  99.6407732984172
curr_Factors:  [99.6407733]
mat_Sqrt:  [[0.15]]
grads:  [0.01462725]
Stock Position:  0.014627252406793568
Bond Position:  [-2.97075163]


portfolio before change:  [-1.50964614]
curr_Stock_Price:  99.90195865363576
curr_Factors:  [99.90195865]
mat_Sqrt:  [[0.15]]
grads:  [0.0423989]
Stock Position:  0.04239890211912661
Bond Position:  [-5.74537951]


portfolio before change:  [-1.51228933]
curr_Stock_Price:  99.84808734475635
curr_Factors:  [99.84808734]
mat_Sqrt:  [[0.15]]
grads:  [-0.09654755]
Stock Position:  -0.0965475474700972
Bond Position:  [8.12779863]


portfolio before change:  [-1.47879074]
curr_Stock_Price:  99.5063844379398
curr_Factors:  [99.50638444]
mat_Sqrt:  [[0.15]]
grads:  [-0.03731928]
Stock Position:  -0.03731928217124471
Bond Position:  [2.23471609]


portfolio before change:  [-1.48446688]
curr_Stock_Price:  99.66222379267752
curr_Factors:  [99.66222379]
mat_Sqrt:  [[0.15]]
grads:  [-0.00302057]
Stock Position:  -0.0030205716486438805
Bond Position:  [-1.18343]


portfolio before change:  [-1.48683522]
curr_Stock_Price:  100.42180620756386
curr_Factors:  [100.42180621]
mat_Sqrt:  [[0.15]]
grads:  [0.01441197]
Stock Position:  0.014411971859766212
Bond Position:  [-2.93411147]


portfolio before change:  [-1.4832986]
curr_Stock_Price:  100.67992601227292
curr_Factors:  [100.67992601]
mat_Sqrt:  [[0.15]]
grads:  [0.05745674]
Stock Position:  0.05745673572325874
Bond Position:  [-7.2680385]


portfolio before change:  [-1.4909115]
curr_Stock_Price:  100.55533419703598
curr_Factors:  [100.5553342]
mat_Sqrt:  [[0.15]]
grads:  [0.06455518]
Stock Position:  0.0645551802625395
Bond Position:  [-7.98227923]


portfolio before change:  [-1.47116007]
curr_Stock_Price:  100.86902449989581
curr_Factors:  [100.8690245]
mat_Sqrt:  [[0.15]]
grads:  [-0.06286248]
Stock Position:  -0.06286247843919096
Bond Position:  [4.8697168]


portfolio before change:  [-1.49031432]
curr_Stock_Price:  101.17856711659573
curr_Factors:  [101.17856712]
mat_Sqrt:  [[0.15]]
grads:  [0.01140253]
Stock Position:  0.011402531490399027
Bond Position:  [-2.64400612]


portfolio before change:  [-1.48909827]
curr_Stock_Price:  101.29970804500088
curr_Factors:  [101.29970805]
mat_Sqrt:  [[0.15]]
grads:  [-0.04541817]
Stock Position:  -0.045418165406106645
Bond Position:  [3.11174863]


portfolio before change:  [-1.51839254]
curr_Stock_Price:  101.94898055566215
curr_Factors:  [101.94898056]
mat_Sqrt:  [[0.15]]
grads:  [0.10197721]
Stock Position:  0.10197720606104839
Bond Position:  [-11.91486474]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.51839254]
Stock Price:  103.03240503296789
PL:  [-4.55079758]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-6.21457469e-02]
 [ 7.70364304e-04]
 [ 8.62266731e-03]
 [ 3.51023847e-03]
 [ 2.40659763e-03]
 [ 1.22408367e-02]
 [-9.98044918e-04]
 [ 1.28271710e-02]
 [-7.90203079e-03]
 [ 9.38906288e-03]
 [ 1.00015160e-02]
 [-1.12188673e-02]
 [ 1.87440035e-02]
 [ 4.22211652e-03]
 [ 3.86380481e-03]
 [-5.55360843e-03]
 [ 3.63201897e-03]
 [ 7.99808777e-03]
 [ 2.06002333e-02]
 [ 1.21232345e-02]
 [ 5.50204276e-02]
 [-1.53748203e-02]
 [-1.77962917e-03]
 [ 1.32841934e-02]
 [ 6.16812279e-04]
 [ 1.35737099e-02]
 [ 1.36900817e-02]
 [-2.06712053e-02]
 [ 1.26850694e-03]
 [-1.26736369e-02]
 [-3.73048349e-03]
 [-2.00417209e-02]
 [ 1.59376557e-02]
 [ 1.01664574e-02]
 [-1.89164005e-02]
 [ 7.59679341e-03]
 [-2.62946416e-03]
 [ 6.58077328e-03]
 [ 3.58237004e-03]
 [-1.49006051e-02]
 [ 1.55754742e-02]
 [-1.85790682e-03]
 [ 4.36014668e-03]
 [-8.66198492e-03]
 [ 2.08675284e-03]
 [-4.61441924e-03]
 [-1.37117285e-02]
 [-1.24054663e-03]
 [-8.15033522e-03]
 [ 1.03941773e-02]
 [-3.09204866e-03]
 [ 3.11896188e-03]
 [ 3.32027276e-03]
 [ 1.40319093e-03]
 [ 3.08869502e-03]
 [ 8.94482215e-03]
 [ 1.51448819e-02]
 [-2.61497882e-02]
 [ 1.38001622e-02]
 [ 3.52781552e-03]
 [ 5.17965485e-03]
 [-1.37011487e-02]
 [-1.25802025e-02]
 [-1.59967983e-03]
 [-1.12196588e-02]
 [-1.24617800e-02]
 [ 1.42863307e-02]
 [ 2.07268997e-03]
 [ 6.79003422e-03]
 [-1.51223057e-02]
 [-2.56267174e-03]
 [ 2.07189190e-03]
 [ 1.53357745e-04]
 [ 8.24551655e-03]
 [-4.97127792e-04]
 [-6.42903210e-04]
 [-4.09963225e-03]
 [-8.83841389e-03]
 [-1.39002126e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.96546369]
curr_Stock_Price:  100.57194564455479
curr_Factors:  [100.57194564]
mat_Sqrt:  [[0.15]]
grads:  [-0.41430498]
Stock Position:  -0.41430497951578044
Bond Position:  [52.63292157]


portfolio before change:  [10.80793014]
curr_Stock_Price:  100.96012153795097
curr_Factors:  [100.96012154]
mat_Sqrt:  [[0.15]]
grads:  [0.00513576]
Stock Position:  0.005135762028890221
Bond Position:  [10.28942299]


portfolio before change:  [10.81133285]
curr_Stock_Price:  101.49745155269608
curr_Factors:  [101.49745155]
mat_Sqrt:  [[0.15]]
grads:  [0.05748445]
Stock Position:  0.05748444876559771
Bond Position:  [4.9768078]


portfolio before change:  [10.84017893]
curr_Stock_Price:  101.99384699003525
curr_Factors:  [101.99384699]
mat_Sqrt:  [[0.15]]
grads:  [0.02340159]
Stock Position:  0.02340158977645683
Bond Position:  [8.45336076]


portfolio before change:  [10.83879082]
curr_Stock_Price:  101.91195237535877
curr_Factors:  [101.91195238]
mat_Sqrt:  [[0.15]]
grads:  [0.01604398]
Stock Position:  0.01604398422599214
Bond Position:  [9.20371706]


portfolio before change:  [10.84018387]
curr_Stock_Price:  101.96292509479836
curr_Factors:  [101.96292509]
mat_Sqrt:  [[0.15]]
grads:  [0.08160558]
Stock Position:  0.08160557781441607
Bond Position:  [2.51944046]


portfolio before change:  [10.91524576]
curr_Stock_Price:  102.88080866708586
curr_Factors:  [102.88080867]
mat_Sqrt:  [[0.15]]
grads:  [-0.00665363]
Stock Position:  -0.006653632787425312
Bond Position:  [11.59977688]


portfolio before change:  [10.91983329]
curr_Stock_Price:  102.30029591503353
curr_Factors:  [102.30029592]
mat_Sqrt:  [[0.15]]
grads:  [0.08551447]
Stock Position:  0.08551447327020399
Bond Position:  [2.17167737]


portfolio before change:  [10.86404188]
curr_Stock_Price:  101.64628792894315
curr_Factors:  [101.64628793]
mat_Sqrt:  [[0.15]]
grads:  [-0.05268021]
Stock Position:  -0.052680205271694175
Bond Position:  [16.21878919]


portfolio before change:  [10.82853332]
curr_Stock_Price:  102.33957034717453
curr_Factors:  [102.33957035]
mat_Sqrt:  [[0.15]]
grads:  [0.06259375]
Stock Position:  0.06259375250723588
Bond Position:  [4.42271558]


portfolio before change:  [10.79770701]
curr_Stock_Price:  101.84267181088228
curr_Factors:  [101.84267181]
mat_Sqrt:  [[0.15]]
grads:  [0.06667677]
Stock Position:  0.06667677316071317
Bond Position:  [4.00716628]


portfolio before change:  [10.83947824]
curr_Stock_Price:  102.4653891578063
curr_Factors:  [102.46538916]
mat_Sqrt:  [[0.15]]
grads:  [-0.07479245]
Stock Position:  -0.07479244849967794
Bond Position:  [18.50311559]


portfolio before change:  [10.88183182]
curr_Stock_Price:  101.9145702871059
curr_Factors:  [101.91457029]
mat_Sqrt:  [[0.15]]
grads:  [0.12496002]
Stock Position:  0.12496002305555638
Bond Position:  [-1.85341524]


portfolio before change:  [10.73531752]
curr_Stock_Price:  100.74300795659721
curr_Factors:  [100.74300796]
mat_Sqrt:  [[0.15]]
grads:  [0.02814744]
Stock Position:  0.02814744344021087
Bond Position:  [7.8996594]


portfolio before change:  [10.74522931]
curr_Stock_Price:  101.07760493909666
curr_Factors:  [101.07760494]
mat_Sqrt:  [[0.15]]
grads:  [0.0257587]
Stock Position:  0.02575869875041268
Bond Position:  [8.14160174]


portfolio before change:  [10.72881578]
curr_Stock_Price:  100.4206463606958
curr_Factors:  [100.42064636]
mat_Sqrt:  [[0.15]]
grads:  [-0.03702406]
Stock Position:  -0.037024056221593195
Bond Position:  [14.44679544]


portfolio before change:  [10.75801689]
curr_Stock_Price:  99.65632833003075
curr_Factors:  [99.65632833]
mat_Sqrt:  [[0.15]]
grads:  [0.02421346]
Stock Position:  0.02421345977135814
Bond Position:  [8.34499239]


portfolio before change:  [10.75660164]
curr_Stock_Price:  99.57633869018338
curr_Factors:  [99.57633869]
mat_Sqrt:  [[0.15]]
grads:  [0.05332059]
Stock Position:  0.05332058515769389
Bond Position:  [5.44713299]


portfolio before change:  [10.73789301]
curr_Stock_Price:  99.21908289944501
curr_Factors:  [99.2190829]
mat_Sqrt:  [[0.15]]
grads:  [0.13733489]
Stock Position:  0.1373348888270335
Bond Position:  [-2.88834871]


portfolio before change:  [10.68984614]
curr_Stock_Price:  98.8705455202779
curr_Factors:  [98.87054552]
mat_Sqrt:  [[0.15]]
grads:  [0.08082156]
Stock Position:  0.08082156323971731
Bond Position:  [2.69897409]


portfolio before change:  [10.72392739]
curr_Stock_Price:  99.29014346404085
curr_Factors:  [99.29014346]
mat_Sqrt:  [[0.15]]
grads:  [0.36680285]
Stock Position:  0.36680285063901635
Bond Position:  [-25.69598027]


portfolio before change:  [10.8541676]
curr_Stock_Price:  99.64959067445864
curr_Factors:  [99.64959067]
mat_Sqrt:  [[0.15]]
grads:  [-0.1024988]
Stock Position:  -0.10249880219911511
Bond Position:  [21.06813129]


portfolio before change:  [10.88086608]
curr_Stock_Price:  99.40196166803959
curr_Factors:  [99.40196167]
mat_Sqrt:  [[0.15]]
grads:  [-0.01186419]
Stock Position:  -0.011864194451656129
Bond Position:  [12.06019028]


portfolio before change:  [10.88937164]
curr_Stock_Price:  98.74858634565234
curr_Factors:  [98.74858635]
mat_Sqrt:  [[0.15]]
grads:  [0.08856129]
Stock Position:  0.08856128901607231
Bond Position:  [2.14406954]


portfolio before change:  [10.80971108]
curr_Stock_Price:  97.84757683027875
curr_Factors:  [97.84757683]
mat_Sqrt:  [[0.15]]
grads:  [0.00411208]
Stock Position:  0.004112081859521134
Bond Position:  [10.40735384]


portfolio before change:  [10.81064545]
curr_Stock_Price:  97.91661338264142
curr_Factors:  [97.91661338]
mat_Sqrt:  [[0.15]]
grads:  [0.0904914]
Stock Position:  0.09049139952190961
Bond Position:  [1.95003407]


portfolio before change:  [10.83838721]
curr_Stock_Price:  98.22183442204414
curr_Factors:  [98.22183442]
mat_Sqrt:  [[0.15]]
grads:  [0.09126721]
Stock Position:  0.09126721142399954
Bond Position:  [1.87395428]


portfolio before change:  [10.82014041]
curr_Stock_Price:  98.02062391587016
curr_Factors:  [98.02062392]
mat_Sqrt:  [[0.15]]
grads:  [-0.13780804]
Stock Position:  -0.13780803562267438
Bond Position:  [24.32817004]


portfolio before change:  [10.85219621]
curr_Stock_Price:  97.79904582531304
curr_Factors:  [97.79904583]
mat_Sqrt:  [[0.15]]
grads:  [0.00845671]
Stock Position:  0.008456712907074745
Bond Position:  [10.02513776]


portfolio before change:  [10.86295065]
curr_Stock_Price:  98.99665681644922
curr_Factors:  [98.99665682]
mat_Sqrt:  [[0.15]]
grads:  [-0.08449091]
Stock Position:  -0.08449091259211386
Bond Position:  [19.22726853]


portfolio before change:  [10.89072528]
curr_Stock_Price:  98.68215096060804
curr_Factors:  [98.68215096]
mat_Sqrt:  [[0.15]]
grads:  [-0.02486989]
Stock Position:  -0.024869889959603094
Bond Position:  [13.34493952]


portfolio before change:  [10.88375059]
curr_Stock_Price:  98.99613631978522
curr_Factors:  [98.99613632]
mat_Sqrt:  [[0.15]]
grads:  [-0.13361147]
Stock Position:  -0.13361147295822912
Bond Position:  [24.11077018]


portfolio before change:  [10.94285384]
curr_Stock_Price:  98.56506340094583
curr_Factors:  [98.5650634]
mat_Sqrt:  [[0.15]]
grads:  [0.10625104]
Stock Position:  0.10625103797859761
Bond Position:  [0.47021355]


portfolio before change:  [10.83733434]
curr_Stock_Price:  97.57167176090218
curr_Factors:  [97.57167176]
mat_Sqrt:  [[0.15]]
grads:  [0.06777638]
Stock Position:  0.06777638241506422
Bond Position:  [4.2242794]


portfolio before change:  [10.86179572]
curr_Stock_Price:  97.92868931609854
curr_Factors:  [97.92868932]
mat_Sqrt:  [[0.15]]
grads:  [-0.12610934]
Stock Position:  -0.1261093366094347
Bond Position:  [23.21151777]


portfolio before change:  [10.88416381]
curr_Stock_Price:  97.76282278021075
curr_Factors:  [97.76282278]
mat_Sqrt:  [[0.15]]
grads:  [0.05064529]
Stock Position:  0.05064528940567508
Bond Position:  [5.93293735]


portfolio before change:  [10.89041319]
curr_Stock_Price:  97.8788961034995
curr_Factors:  [97.8788961]
mat_Sqrt:  [[0.15]]
grads:  [-0.01752976]
Stock Position:  -0.017529761079027307
Bond Position:  [12.60620686]


portfolio before change:  [10.88769293]
curr_Stock_Price:  98.07902290099267
curr_Factors:  [98.0790229]
mat_Sqrt:  [[0.15]]
grads:  [0.04387182]
Stock Position:  0.04387182187593565
Bond Position:  [6.58478751]


portfolio before change:  [10.88762708]
curr_Stock_Price:  98.06814097511224
curr_Factors:  [98.06814098]
mat_Sqrt:  [[0.15]]
grads:  [0.02388247]
Stock Position:  0.023882466960891097
Bond Position:  [8.54551795]


portfolio before change:  [10.88772398]
curr_Stock_Price:  98.0498341958636
curr_Factors:  [98.0498342]
mat_Sqrt:  [[0.15]]
grads:  [-0.09933737]
Stock Position:  -0.0993373673850095
Bond Position:  [20.62773639]


portfolio before change:  [10.82978734]
curr_Stock_Price:  98.64604410726447
curr_Factors:  [98.64604411]
mat_Sqrt:  [[0.15]]
grads:  [0.10383649]
Stock Position:  0.1038364947495049
Bond Position:  [0.58672789]


portfolio before change:  [10.84167767]
curr_Stock_Price:  98.76020114993528
curr_Factors:  [98.76020115]
mat_Sqrt:  [[0.15]]
grads:  [-0.01238605]
Stock Position:  -0.012386045438635026
Bond Position:  [12.06492601]


portfolio before change:  [10.85170702]
curr_Stock_Price:  98.01135357306511
curr_Factors:  [98.01135357]
mat_Sqrt:  [[0.15]]
grads:  [0.02906764]
Stock Position:  0.029067644507144916
Bond Position:  [8.00274783]


portfolio before change:  [10.88134295]
curr_Stock_Price:  99.01369652592126
curr_Factors:  [99.01369653]
mat_Sqrt:  [[0.15]]
grads:  [-0.05774657]
Stock Position:  -0.05774656616232847
Bond Position:  [16.59904393]


portfolio before change:  [10.90040731]
curr_Stock_Price:  98.70152417998251
curr_Factors:  [98.70152418]
mat_Sqrt:  [[0.15]]
grads:  [0.01391169]
Stock Position:  0.013911685586317458
Bond Position:  [9.52730273]


portfolio before change:  [10.89024933]
curr_Stock_Price:  97.9285441500766
curr_Factors:  [97.92854415]
mat_Sqrt:  [[0.15]]
grads:  [-0.03076279]
Stock Position:  -0.03076279495165493
Bond Position:  [13.90280505]


portfolio before change:  [10.87182295]
curr_Stock_Price:  98.5557734839084
curr_Factors:  [98.55577348]
mat_Sqrt:  [[0.15]]
grads:  [-0.09141152]
Stock Position:  -0.09141152341669836
Bond Position:  [19.88095635]


portfolio before change:  [10.87811686]
curr_Stock_Price:  98.50051444606768
curr_Factors:  [98.50051445]
mat_Sqrt:  [[0.15]]
grads:  [-0.00827031]
Stock Position:  -0.008270310873737556
Bond Position:  [11.69274674]


portfolio before change:  [10.87645297]
curr_Stock_Price:  98.79006915678465
curr_Factors:  [98.79006916]
mat_Sqrt:  [[0.15]]
grads:  [-0.05433557]
Stock Position:  -0.054335568141893255
Bond Position:  [16.24426751]


portfolio before change:  [10.86103937]
curr_Stock_Price:  99.09242908591754
curr_Factors:  [99.09242909]
mat_Sqrt:  [[0.15]]
grads:  [0.06929452]
Stock Position:  0.0692945156481289
Bond Position:  [3.9944775]


portfolio before change:  [10.86645711]
curr_Stock_Price:  99.1670103507453
curr_Factors:  [99.16701035]
mat_Sqrt:  [[0.15]]
grads:  [-0.02061366]
Stock Position:  -0.020613657709368044
Bond Position:  [12.91065192]


portfolio before change:  [10.89100084]
curr_Stock_Price:  98.01550243298921
curr_Factors:  [98.01550243]
mat_Sqrt:  [[0.15]]
grads:  [0.02079308]
Stock Position:  0.020793079184908532
Bond Position:  [8.85295674]


portfolio before change:  [10.87847898]
curr_Stock_Price:  97.38667859164417
curr_Factors:  [97.38667859]
mat_Sqrt:  [[0.15]]
grads:  [0.02213515]
Stock Position:  0.022135151702262153
Bond Position:  [8.72281008]


portfolio before change:  [10.87436791]
curr_Stock_Price:  97.17632220477897
curr_Factors:  [97.1763222]
mat_Sqrt:  [[0.15]]
grads:  [0.00935461]
Stock Position:  0.009354606190481816
Bond Position:  [9.96532168]


portfolio before change:  [10.88061761]
curr_Stock_Price:  97.77782844973673
curr_Factors:  [97.77782845]
mat_Sqrt:  [[0.15]]
grads:  [0.0205913]
Stock Position:  0.0205913001212061
Bond Position:  [8.867245]


portfolio before change:  [10.87944698]
curr_Stock_Price:  97.69406260594445
curr_Factors:  [97.69406261]
mat_Sqrt:  [[0.15]]
grads:  [0.05963215]
Stock Position:  0.059632147641090795
Bond Position:  [5.05374022]


portfolio before change:  [10.92965682]
curr_Stock_Price:  98.53075833018951
curr_Factors:  [98.53075833]
mat_Sqrt:  [[0.15]]
grads:  [0.10096588]
Stock Position:  0.10096587933758341
Bond Position:  [0.98141216]


portfolio before change:  [10.993611]
curr_Stock_Price:  99.16357451071156
curr_Factors:  [99.16357451]
mat_Sqrt:  [[0.15]]
grads:  [-0.17433192]
Stock Position:  -0.17433192159943028
Bond Position:  [28.2809875]


portfolio before change:  [11.15202932]
curr_Stock_Price:  98.2649972019542
curr_Factors:  [98.2649972]
mat_Sqrt:  [[0.15]]
grads:  [0.09200108]
Stock Position:  0.09200108108867186
Bond Position:  [2.11154335]


portfolio before change:  [11.19041383]
curr_Stock_Price:  98.68078070788548
curr_Factors:  [98.68078071]
mat_Sqrt:  [[0.15]]
grads:  [0.02351877]
Stock Position:  0.023518770112257628
Bond Position:  [8.86956324]


portfolio before change:  [11.19749982]
curr_Stock_Price:  98.95850029555304
curr_Factors:  [98.9585003]
mat_Sqrt:  [[0.15]]
grads:  [0.03453103]
Stock Position:  0.034531032315773376
Bond Position:  [7.78036065]


portfolio before change:  [11.19578662]
curr_Stock_Price:  98.89480441401504
curr_Factors:  [98.89480441]
mat_Sqrt:  [[0.15]]
grads:  [-0.09134099]
Stock Position:  -0.09134099139581311
Bond Position:  [20.2289361]


portfolio before change:  [11.18964562]
curr_Stock_Price:  98.97587814910699
curr_Factors:  [98.97587815]
mat_Sqrt:  [[0.15]]
grads:  [-0.08386802]
Stock Position:  -0.08386801666476876
Bond Position:  [19.49055621]


portfolio before change:  [11.18749919]
curr_Stock_Price:  99.01599617973126
curr_Factors:  [99.01599618]
mat_Sqrt:  [[0.15]]
grads:  [-0.01066453]
Stock Position:  -0.010664532180027853
Bond Position:  [12.24345847]


portfolio before change:  [11.19585063]
curr_Stock_Price:  98.30464778630298
curr_Factors:  [98.30464779]
mat_Sqrt:  [[0.15]]
grads:  [-0.07479773]
Stock Position:  -0.07479772525396364
Bond Position:  [18.54881467]


portfolio before change:  [11.21706996]
curr_Stock_Price:  98.03645799523103
curr_Factors:  [98.036458]
mat_Sqrt:  [[0.15]]
grads:  [-0.08307853]
Stock Position:  -0.08307853327027775
Bond Position:  [19.36179509]


portfolio before change:  [11.098337]
curr_Stock_Price:  99.48018957438606
curr_Factors:  [99.48018957]
mat_Sqrt:  [[0.15]]
grads:  [0.0952422]
Stock Position:  0.09524220496869537
Bond Position:  [1.6236244]


portfolio before change:  [11.02245229]
curr_Stock_Price:  98.68236901684374
curr_Factors:  [98.68236902]
mat_Sqrt:  [[0.15]]
grads:  [0.01381793]
Stock Position:  0.013817933134995514
Bond Position:  [9.65886592]


portfolio before change:  [11.03561303]
curr_Stock_Price:  99.59111813637047
curr_Factors:  [99.59111814]
mat_Sqrt:  [[0.15]]
grads:  [0.04526689]
Stock Position:  0.045266894782717164
Bond Position:  [6.52743236]


portfolio before change:  [11.0182519]
curr_Stock_Price:  99.19857724003832
curr_Factors:  [99.19857724]
mat_Sqrt:  [[0.15]]
grads:  [-0.10081537]
Stock Position:  -0.10081537137639467
Bond Position:  [21.0189933]


portfolio before change:  [11.09083589]
curr_Stock_Price:  98.49163873597007
curr_Factors:  [98.49163874]
mat_Sqrt:  [[0.15]]
grads:  [-0.01708448]
Stock Position:  -0.017084478257319635
Bond Position:  [12.77351415]


portfolio before change:  [11.09828428]
curr_Stock_Price:  98.10239554428789
curr_Factors:  [98.10239554]
mat_Sqrt:  [[0.15]]
grads:  [0.01381261]
Stock Position:  0.013812612654936664
Bond Position:  [9.74323389]


portfolio before change:  [11.09453728]
curr_Stock_Price:  97.78703390753081
curr_Factors:  [97.78703391]
mat_Sqrt:  [[0.15]]
grads:  [0.00102238]
Stock Position:  0.0010223849655784188
Bond Position:  [10.99456129]


portfolio before change:  [11.09496711]
curr_Stock_Price:  97.5353150164289
curr_Factors:  [97.53531502]
mat_Sqrt:  [[0.15]]
grads:  [0.05497011]
Stock Position:  0.05497011030959182
Bond Position:  [5.73344008]


portfolio before change:  [11.07497289]
curr_Stock_Price:  97.16506708459896
curr_Factors:  [97.16506708]
mat_Sqrt:  [[0.15]]
grads:  [-0.00331419]
Stock Position:  -0.0033141852828844336
Bond Position:  [11.39699593]


portfolio before change:  [11.07246669]
curr_Stock_Price:  98.13620727510734
curr_Factors:  [98.13620728]
mat_Sqrt:  [[0.15]]
grads:  [-0.00428602]
Stock Position:  -0.004286021397998932
Bond Position:  [11.49308057]


portfolio before change:  [11.07305494]
curr_Stock_Price:  98.16655765193742
curr_Factors:  [98.16655765]
mat_Sqrt:  [[0.15]]
grads:  [-0.02733088]
Stock Position:  -0.027330881668059862
Bond Position:  [13.75603352]


portfolio before change:  [11.04283621]
curr_Stock_Price:  99.30367858425763
curr_Factors:  [99.30367858]
mat_Sqrt:  [[0.15]]
grads:  [-0.05892276]
Stock Position:  -0.0589227592641869
Bond Position:  [16.89408295]


portfolio before change:  [11.02246909]
curr_Stock_Price:  99.66725680023885
curr_Factors:  [99.6672568]
mat_Sqrt:  [[0.15]]
grads:  [-0.00926681]
Stock Position:  -0.009266808426285657
Bond Position:  [11.94606646]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.02246909]
Stock Price:  99.89228804057491
PL:  [11.02246909]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-2.71102418e-02]
 [ 1.06254979e-02]
 [ 3.08940007e-03]
 [-5.08206952e-03]
 [-4.07908400e-02]
 [-3.79226957e-03]
 [ 5.72386665e-03]
 [-3.98217162e-02]
 [-2.07864384e-02]
 [ 1.13652652e-01]
 [ 1.04856961e-02]
 [-1.71330468e-02]
 [ 2.18553337e-02]
 [ 1.64681634e-02]
 [-6.35619186e-02]
 [ 2.80966634e-02]
 [-9.61994290e-03]
 [-3.10704219e-02]
 [-1.15130248e-01]
 [ 2.87355527e-02]
 [-1.01815346e-01]
 [-4.18011211e-02]
 [ 2.06326555e-03]
 [-3.50964799e-03]
 [-1.02072808e-02]
 [ 1.68566588e-02]
 [ 1.79969673e-02]
 [ 4.65481127e-02]
 [-8.58135169e-04]
 [ 1.34362181e-02]
 [-3.46637585e-03]
 [-4.49341047e-02]
 [ 2.46893318e-02]
 [ 1.10504238e-02]
 [-4.08690866e-02]
 [ 8.87540950e-03]
 [ 1.18143282e-03]
 [-1.74091208e-02]
 [ 1.00842054e-02]
 [-1.99712094e-02]
 [ 5.33974825e-02]
 [ 1.69610546e-03]
 [ 7.59833375e-03]
 [-9.24666550e-03]
 [-2.10441508e-03]
 [-1.48834127e-02]
 [-1.33489358e-02]
 [ 5.27256407e-04]
 [-2.69309591e-03]
 [-2.81189742e-03]
 [-3.55290467e-03]
 [ 3.01894288e-03]
 [ 3.25895462e-03]
 [ 1.34594132e-03]
 [ 3.12177133e-03]
 [ 8.92131529e-03]
 [ 1.25548748e-02]
 [ 2.48989049e-03]
 [ 1.37031891e-02]
 [-8.55165769e-05]
 [ 3.70713021e-03]
 [-1.41026922e-02]
 [-1.26214580e-02]
 [-1.11394178e-03]
 [-1.09112921e-02]
 [-1.66378463e-02]
 [ 9.43939432e-03]
 [ 1.97438933e-03]
 [ 1.22739395e-02]
 [-1.75704999e-02]
 [ 1.50170806e-03]
 [ 1.77169585e-03]
 [-6.57233232e-04]
 [ 8.23824160e-03]
 [-9.02506981e-04]
 [ 2.66647635e-03]
 [ 1.06740890e-03]
 [-1.02356497e-02]
 [-2.59439562e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.64957594]
curr_Stock_Price:  99.05419147138534
curr_Factors:  [99.05419147]
mat_Sqrt:  [[0.15]]
grads:  [-0.18073495]
Stock Position:  -0.18073494511951838
Bond Position:  [5.25297792]


portfolio before change:  [-12.54772049]
curr_Stock_Price:  98.49244552719736
curr_Factors:  [98.49244553]
mat_Sqrt:  [[0.15]]
grads:  [0.07083665]
Stock Position:  0.07083665261883995
Bond Position:  [-19.52459564]


portfolio before change:  [-12.5819375]
curr_Stock_Price:  98.02663188568648
curr_Factors:  [98.02663189]
mat_Sqrt:  [[0.15]]
grads:  [0.020596]
Stock Position:  0.020596000493116984
Bond Position:  [-14.60089405]


portfolio before change:  [-12.60258804]
curr_Stock_Price:  97.06829249814962
curr_Factors:  [97.0682925]
mat_Sqrt:  [[0.15]]
grads:  [-0.03388046]
Stock Position:  -0.03388046344361736
Bond Position:  [-9.3138693]


portfolio before change:  [-12.58533753]
curr_Stock_Price:  96.54195240118308
curr_Factors:  [96.5419524]
mat_Sqrt:  [[0.15]]
grads:  [-0.27193893]
Stock Position:  -0.2719389330307537
Bond Position:  [13.668178]


portfolio before change:  [-12.56716882]
curr_Stock_Price:  96.47828214772328
curr_Factors:  [96.47828215]
mat_Sqrt:  [[0.15]]
grads:  [-0.0252818]
Stock Position:  -0.025281797131909735
Bond Position:  [-10.12802446]


portfolio before change:  [-12.55107481]
curr_Stock_Price:  95.81665855988557
curr_Factors:  [95.81665856]
mat_Sqrt:  [[0.15]]
grads:  [0.03815911]
Stock Position:  0.03815911097879831
Bond Position:  [-16.20735331]


portfolio before change:  [-12.55420528]
curr_Stock_Price:  95.76116783182701
curr_Factors:  [95.76116783]
mat_Sqrt:  [[0.15]]
grads:  [-0.26547811]
Stock Position:  -0.2654781080817408
Bond Position:  [12.86828839]


portfolio before change:  [-12.3692883]
curr_Stock_Price:  95.0676542336105
curr_Factors:  [95.06765423]
mat_Sqrt:  [[0.15]]
grads:  [-0.13857626]
Stock Position:  -0.13857625599437798
Bond Position:  [0.80483129]


portfolio before change:  [-12.36647448]
curr_Stock_Price:  95.04771197081577
curr_Factors:  [95.04771197]
mat_Sqrt:  [[0.15]]
grads:  [0.75768435]
Stock Position:  0.7576843458930154
Bond Position:  [-84.38263795]


portfolio before change:  [-12.33055206]
curr_Stock_Price:  95.10208354575195
curr_Factors:  [95.10208355]
mat_Sqrt:  [[0.15]]
grads:  [0.06990464]
Stock Position:  0.06990464093717712
Bond Position:  [-18.97862907]


portfolio before change:  [-12.30698815]
curr_Stock_Price:  95.45613896422145
curr_Factors:  [95.45613896]
mat_Sqrt:  [[0.15]]
grads:  [-0.11422031]
Stock Position:  -0.11422031208263989
Bond Position:  [-1.40395817]


portfolio before change:  [-12.22700988]
curr_Stock_Price:  94.75516014696912
curr_Factors:  [94.75516015]
mat_Sqrt:  [[0.15]]
grads:  [0.14570222]
Stock Position:  0.14570222456980259
Bond Position:  [-26.0330475]


portfolio before change:  [-12.23390016]
curr_Stock_Price:  94.71903740688938
curr_Factors:  [94.71903741]
mat_Sqrt:  [[0.15]]
grads:  [0.10978776]
Stock Position:  0.10978775607843305
Bond Position:  [-22.63289073]


portfolio before change:  [-12.32638667]
curr_Stock_Price:  93.88951040029313
curr_Factors:  [93.8895104]
mat_Sqrt:  [[0.15]]
grads:  [-0.42374612]
Stock Position:  -0.42374612384153726
Bond Position:  [27.45892943]


portfolio before change:  [-12.52816042]
curr_Stock_Price:  94.36972715028678
curr_Factors:  [94.36972715]
mat_Sqrt:  [[0.15]]
grads:  [0.18731109]
Stock Position:  0.18731108938407723
Bond Position:  [-30.20465682]


portfolio before change:  [-12.59517579]
curr_Stock_Price:  94.02203005447066
curr_Factors:  [94.02203005]
mat_Sqrt:  [[0.15]]
grads:  [-0.06413295]
Stock Position:  -0.06413295269644272
Bond Position:  [-6.56526538]


portfolio before change:  [-12.59328059]
curr_Stock_Price:  93.9860806621082
curr_Factors:  [93.98608066]
mat_Sqrt:  [[0.15]]
grads:  [-0.20713615]
Stock Position:  -0.20713614568399968
Bond Position:  [6.87463391]


portfolio before change:  [-12.46992261]
curr_Stock_Price:  93.39261444102807
curr_Factors:  [93.39261444]
mat_Sqrt:  [[0.15]]
grads:  [-0.76753498]
Stock Position:  -0.767534984611689
Bond Position:  [59.21217628]


portfolio before change:  [-12.11179601]
curr_Stock_Price:  92.93084302591147
curr_Factors:  [92.93084303]
mat_Sqrt:  [[0.15]]
grads:  [0.19157035]
Stock Position:  0.19157035148130103
Bond Position:  [-29.91459028]


portfolio before change:  [-11.98465506]
curr_Stock_Price:  93.60428060993411
curr_Factors:  [93.60428061]
mat_Sqrt:  [[0.15]]
grads:  [-0.67876897]
Stock Position:  -0.6787689706173382
Bond Position:  [51.55102613]


portfolio before change:  [-12.30300774]
curr_Stock_Price:  94.07804227524696
curr_Factors:  [94.07804228]
mat_Sqrt:  [[0.15]]
grads:  [-0.27867414]
Stock Position:  -0.27867414033623894
Bond Position:  [13.91410982]


portfolio before change:  [-12.42607276]
curr_Stock_Price:  94.52277202513551
curr_Factors:  [94.52277203]
mat_Sqrt:  [[0.15]]
grads:  [0.0137551]
Stock Position:  0.013755103669193346
Bond Position:  [-13.72624329]


portfolio before change:  [-12.42174288]
curr_Stock_Price:  94.89992661929897
curr_Factors:  [94.89992662]
mat_Sqrt:  [[0.15]]
grads:  [-0.02339765]
Stock Position:  -0.023397653237543788
Bond Position:  [-10.2013073]


portfolio before change:  [-12.42970326]
curr_Stock_Price:  95.21289732972375
curr_Factors:  [95.21289733]
mat_Sqrt:  [[0.15]]
grads:  [-0.06804854]
Stock Position:  -0.06804853858345997
Bond Position:  [-5.95060474]


portfolio before change:  [-12.48939712]
curr_Stock_Price:  96.08465647494413
curr_Factors:  [96.08465647]
mat_Sqrt:  [[0.15]]
grads:  [0.11237773]
Stock Position:  0.11237772548328596
Bond Position:  [-23.28717227]


portfolio before change:  [-12.47011497]
curr_Stock_Price:  96.26919167732102
curr_Factors:  [96.26919168]
mat_Sqrt:  [[0.15]]
grads:  [0.11997978]
Stock Position:  0.11997978215261128
Bond Position:  [-24.02047161]


portfolio before change:  [-12.52020473]
curr_Stock_Price:  95.86421978122551
curr_Factors:  [95.86421978]
mat_Sqrt:  [[0.15]]
grads:  [0.31032075]
Stock Position:  0.31032075130318343
Bond Position:  [-42.26886144]


portfolio before change:  [-12.89210964]
curr_Stock_Price:  94.6742799465124
curr_Factors:  [94.67427995]
mat_Sqrt:  [[0.15]]
grads:  [-0.0057209]
Stock Position:  -0.00572090112446077
Bond Position:  [-12.35048745]


portfolio before change:  [-12.89575735]
curr_Stock_Price:  95.17695918617426
curr_Factors:  [95.17695919]
mat_Sqrt:  [[0.15]]
grads:  [0.08957479]
Stock Position:  0.08957478730850149
Bond Position:  [-21.42121323]


portfolio before change:  [-12.89782322]
curr_Stock_Price:  95.16884303856351
curr_Factors:  [95.16884304]
mat_Sqrt:  [[0.15]]
grads:  [-0.02310917]
Stock Position:  -0.02310917230402454
Bond Position:  [-10.69855003]


portfolio before change:  [-12.90648479]
curr_Stock_Price:  95.5147181837065
curr_Factors:  [95.51471818]
mat_Sqrt:  [[0.15]]
grads:  [-0.2995607]
Stock Position:  -0.29956069791553486
Bond Position:  [15.70597085]


portfolio before change:  [-12.68446159]
curr_Stock_Price:  94.77683250805003
curr_Factors:  [94.77683251]
mat_Sqrt:  [[0.15]]
grads:  [0.16459555]
Stock Position:  0.1645955454818295
Bond Position:  [-28.28430603]


portfolio before change:  [-12.71536983]
curr_Stock_Price:  94.59978992633866
curr_Factors:  [94.59978993]
mat_Sqrt:  [[0.15]]
grads:  [0.07366949]
Stock Position:  0.0736694917541811
Bond Position:  [-19.68448828]


portfolio before change:  [-12.73047936]
curr_Stock_Price:  94.41139164568668
curr_Factors:  [94.41139165]
mat_Sqrt:  [[0.15]]
grads:  [-0.27246058]
Stock Position:  -0.2724605772590544
Bond Position:  [12.99290291]


portfolio before change:  [-12.66038462]
curr_Stock_Price:  94.15710657666497
curr_Factors:  [94.15710658]
mat_Sqrt:  [[0.15]]
grads:  [0.0591694]
Stock Position:  0.05916939667633382
Bond Position:  [-18.23160381]


portfolio before change:  [-12.62969431]
curr_Stock_Price:  94.69505051435165
curr_Factors:  [94.69505051]
mat_Sqrt:  [[0.15]]
grads:  [0.00787622]
Stock Position:  0.007876218825023224
Bond Position:  [-13.37553325]


portfolio before change:  [-12.63395239]
curr_Stock_Price:  94.26056730989195
curr_Factors:  [94.26056731]
mat_Sqrt:  [[0.15]]
grads:  [-0.11606081]
Stock Position:  -0.11606080511508836
Bond Position:  [-1.69399506]


portfolio before change:  [-12.65581712]
curr_Stock_Price:  94.44804531716954
curr_Factors:  [94.44804532]
mat_Sqrt:  [[0.15]]
grads:  [0.06722804]
Stock Position:  0.06722803580860699
Bond Position:  [-19.00537369]


portfolio before change:  [-12.61078684]
curr_Stock_Price:  95.13552864198789
curr_Factors:  [95.13552864]
mat_Sqrt:  [[0.15]]
grads:  [-0.1331414]
Stock Position:  -0.13314139600415392
Bond Position:  [0.05569026]


portfolio before change:  [-12.59432705]
curr_Stock_Price:  95.01192837545408
curr_Factors:  [95.01192838]
mat_Sqrt:  [[0.15]]
grads:  [0.35598322]
Stock Position:  0.3559832164226428
Bond Position:  [-46.41697891]


portfolio before change:  [-12.27241986]
curr_Stock_Price:  95.924354365733
curr_Factors:  [95.92435437]
mat_Sqrt:  [[0.15]]
grads:  [0.01130737]
Stock Position:  0.011307369708492688
Bond Position:  [-13.357072]


portfolio before change:  [-12.27067799]
curr_Stock_Price:  96.15223310121017
curr_Factors:  [96.1522331]
mat_Sqrt:  [[0.15]]
grads:  [0.05065556]
Stock Position:  0.05065555831604728
Bond Position:  [-17.14132304]


portfolio before change:  [-12.27465142]
curr_Stock_Price:  96.09494307829118
curr_Factors:  [96.09494308]
mat_Sqrt:  [[0.15]]
grads:  [-0.06164444]
Stock Position:  -0.06164443666822814
Bond Position:  [-6.35093278]


portfolio before change:  [-12.25078479]
curr_Stock_Price:  95.7013378657755
curr_Factors:  [95.70133787]
mat_Sqrt:  [[0.15]]
grads:  [-0.01402943]
Stock Position:  -0.014029433847083422
Bond Position:  [-10.9081492]


portfolio before change:  [-12.2455966]
curr_Stock_Price:  95.28293415121759
curr_Factors:  [95.28293415]
mat_Sqrt:  [[0.15]]
grads:  [-0.09922275]
Stock Position:  -0.09922275152584834
Bond Position:  [-2.7913617]


portfolio before change:  [-12.34166033]
curr_Stock_Price:  96.24933815987892
curr_Factors:  [96.24933816]
mat_Sqrt:  [[0.15]]
grads:  [-0.08899291]
Stock Position:  -0.08899290514231384
Bond Position:  [-3.77615211]


portfolio before change:  [-12.32718665]
curr_Stock_Price:  96.08404746968343
curr_Factors:  [96.08404747]
mat_Sqrt:  [[0.15]]
grads:  [0.00351504]
Stock Position:  0.0035150427106817733
Bond Position:  [-12.66492618]


portfolio before change:  [-12.32697361]
curr_Stock_Price:  96.36985442102537
curr_Factors:  [96.36985442]
mat_Sqrt:  [[0.15]]
grads:  [-0.01795397]
Stock Position:  -0.017953972711243205
Bond Position:  [-10.59675187]


portfolio before change:  [-12.32829856]
curr_Stock_Price:  96.40676144315208
curr_Factors:  [96.40676144]
mat_Sqrt:  [[0.15]]
grads:  [-0.01874598]
Stock Position:  -0.018745982785898434
Bond Position:  [-10.52105907]


portfolio before change:  [-12.34447796]
curr_Stock_Price:  97.23476908326518
curr_Factors:  [97.23476908]
mat_Sqrt:  [[0.15]]
grads:  [-0.02368603]
Stock Position:  -0.023686031103890573
Bond Position:  [-10.0413722]


portfolio before change:  [-12.35223623]
curr_Stock_Price:  97.53581839467395
curr_Factors:  [97.53581839]
mat_Sqrt:  [[0.15]]
grads:  [0.02012629]
Stock Position:  0.020126285894225354
Bond Position:  [-14.31527]


portfolio before change:  [-12.3506823]
curr_Stock_Price:  97.65748343554796
curr_Factors:  [97.65748344]
mat_Sqrt:  [[0.15]]
grads:  [0.02172636]
Stock Position:  0.021726364132275487
Bond Position:  [-14.47242434]


portfolio before change:  [-12.33442178]
curr_Stock_Price:  98.44754075648716
curr_Factors:  [98.44754076]
mat_Sqrt:  [[0.15]]
grads:  [0.00897294]
Stock Position:  0.008972942146733746
Bond Position:  [-13.21778587]


portfolio before change:  [-12.34137937]
curr_Stock_Price:  97.76421369388748
curr_Factors:  [97.76421369]
mat_Sqrt:  [[0.15]]
grads:  [0.02081181]
Stock Position:  0.02081180888925163
Bond Position:  [-14.3760295]


portfolio before change:  [-12.3494206]
curr_Stock_Price:  97.42100966126708
curr_Factors:  [97.42100966]
mat_Sqrt:  [[0.15]]
grads:  [0.05947544]
Stock Position:  0.059475435259685475
Bond Position:  [-18.14357755]


portfolio before change:  [-12.34219812]
curr_Stock_Price:  97.56151281489912
curr_Factors:  [97.56151281]
mat_Sqrt:  [[0.15]]
grads:  [0.08369917]
Stock Position:  0.08369916530194486
Bond Position:  [-20.50801531]


portfolio before change:  [-12.37575515]
curr_Stock_Price:  97.17590280177183
curr_Factors:  [97.1759028]
mat_Sqrt:  [[0.15]]
grads:  [0.01659927]
Stock Position:  0.01659926992680329
Bond Position:  [-13.98880419]


portfolio before change:  [-12.36656728]
curr_Stock_Price:  97.78208595791374
curr_Factors:  [97.78208596]
mat_Sqrt:  [[0.15]]
grads:  [0.09135459]
Stock Position:  0.0913545942274421
Bond Position:  [-21.29941006]


portfolio before change:  [-12.38641962]
curr_Stock_Price:  97.57934745761602
curr_Factors:  [97.57934746]
mat_Sqrt:  [[0.15]]
grads:  [-0.00057011]
Stock Position:  -0.0005701105126918165
Bond Position:  [-12.33078861]


portfolio before change:  [-12.38741897]
curr_Stock_Price:  97.98040133084677
curr_Factors:  [97.98040133]
mat_Sqrt:  [[0.15]]
grads:  [0.0247142]
Stock Position:  0.024714201383998498
Bond Position:  [-14.80892634]


portfolio before change:  [-12.3712282]
curr_Stock_Price:  98.67297312845395
curr_Factors:  [98.67297313]
mat_Sqrt:  [[0.15]]
grads:  [-0.09401795]
Stock Position:  -0.0940179479271243
Bond Position:  [-3.09419775]


portfolio before change:  [-12.35222982]
curr_Stock_Price:  98.46884440049956
curr_Factors:  [98.4688444]
mat_Sqrt:  [[0.15]]
grads:  [-0.08414305]
Stock Position:  -0.08414305301552362
Bond Position:  [-4.06676063]


portfolio before change:  [-12.33725665]
curr_Stock_Price:  98.28787458963446
curr_Factors:  [98.28787459]
mat_Sqrt:  [[0.15]]
grads:  [-0.00742628]
Stock Position:  -0.007426278548323738
Bond Position:  [-11.60734352]


portfolio before change:  [-12.33640086]
curr_Stock_Price:  98.07494502415844
curr_Factors:  [98.07494502]
mat_Sqrt:  [[0.15]]
grads:  [-0.07274195]
Stock Position:  -0.07274194736968116
Bond Position:  [-5.20223837]


portfolio before change:  [-12.31428562]
curr_Stock_Price:  97.76645187453573
curr_Factors:  [97.76645187]
mat_Sqrt:  [[0.15]]
grads:  [-0.11091898]
Stock Position:  -0.11091897547908648
Bond Position:  [-1.47013094]


portfolio before change:  [-12.20434907]
curr_Stock_Price:  96.7744806583739
curr_Factors:  [96.77448066]
mat_Sqrt:  [[0.15]]
grads:  [0.0629293]
Stock Position:  0.06292929546370041
Bond Position:  [-18.29429896]


portfolio before change:  [-12.21057572]
curr_Stock_Price:  96.69370401768889
curr_Factors:  [96.69370402]
mat_Sqrt:  [[0.15]]
grads:  [0.0131626]
Stock Position:  0.013162595557209021
Bond Position:  [-13.48331584]


portfolio before change:  [-12.20887278]
curr_Stock_Price:  96.88710643234039
curr_Factors:  [96.88710643]
mat_Sqrt:  [[0.15]]
grads:  [0.08182626]
Stock Position:  0.08182626328279417
Bond Position:  [-20.13678265]


portfolio before change:  [-12.17228088]
curr_Stock_Price:  97.34967774811483
curr_Factors:  [97.34967775]
mat_Sqrt:  [[0.15]]
grads:  [-0.11713667]
Stock Position:  -0.11713666583811028
Bond Position:  [-0.76906421]


portfolio before change:  [-12.22331821]
curr_Stock_Price:  97.78497497486269
curr_Factors:  [97.78497497]
mat_Sqrt:  [[0.15]]
grads:  [0.01001139]
Stock Position:  0.010011387079180646
Bond Position:  [-13.20228145]


portfolio before change:  [-12.22847628]
curr_Stock_Price:  97.35217782778582
curr_Factors:  [97.35217783]
mat_Sqrt:  [[0.15]]
grads:  [0.01181131]
Stock Position:  0.011811305685742925
Bond Position:  [-13.37833261]


portfolio before change:  [-12.23071419]
curr_Stock_Price:  97.23350020072563
curr_Factors:  [97.2335002]
mat_Sqrt:  [[0.15]]
grads:  [-0.00438155]
Stock Position:  -0.004381554876951386
Bond Position:  [-11.80468028]


portfolio before change:  [-12.2326879]
curr_Stock_Price:  97.51556779156857
curr_Factors:  [97.51556779]
mat_Sqrt:  [[0.15]]
grads:  [0.05492161]
Stock Position:  0.054921610699403475
Bond Position:  [-17.58839995]


portfolio before change:  [-12.26223039]
curr_Stock_Price:  96.99768092465652
curr_Factors:  [96.99768092]
mat_Sqrt:  [[0.15]]
grads:  [-0.00601671]
Stock Position:  -0.006016713208487629
Bond Position:  [-11.67862317]


portfolio before change:  [-12.26234415]
curr_Stock_Price:  96.89526912356234
curr_Factors:  [96.89526912]
mat_Sqrt:  [[0.15]]
grads:  [0.01777651]
Stock Position:  0.01777650902468305
Bond Position:  [-13.98480377]


portfolio before change:  [-12.25285662]
curr_Stock_Price:  97.47815083881319
curr_Factors:  [97.47815084]
mat_Sqrt:  [[0.15]]
grads:  [0.00711606]
Stock Position:  0.007116059352675191
Bond Position:  [-12.94651693]


portfolio before change:  [-12.24823749]
curr_Stock_Price:  98.24097678211365
curr_Factors:  [98.24097678]
mat_Sqrt:  [[0.15]]
grads:  [-0.06823766]
Stock Position:  -0.06823766497113636
Bond Position:  [-5.54450263]


portfolio before change:  [-12.17305386]
curr_Stock_Price:  97.13410750356599
curr_Factors:  [97.1341075]
mat_Sqrt:  [[0.15]]
grads:  [-0.17295971]
Stock Position:  -0.1729597082801843
Bond Position:  [4.62723304]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.17305386]
Stock Price:  96.78571041609163
PL:  [-12.17305386]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.85542062e-02]
 [ 4.89649195e-03]
 [ 9.08557700e-05]
 [-4.85336722e-04]
 [-1.21218242e-02]
 [ 1.07429046e-02]
 [ 5.00528964e-04]
 [ 1.53257066e-02]
 [ 1.59451555e-02]
 [-1.83893955e-02]
 [ 6.25319059e-03]
 [-5.60866100e-03]
 [-6.89617396e-03]
 [ 3.81727153e-03]
 [ 2.59479677e-03]
 [ 7.94551937e-04]
 [ 8.19708089e-03]
 [ 1.23779538e-02]
 [ 2.41054807e-02]
 [ 1.02385973e-02]
 [ 4.91651853e-02]
 [-1.71546037e-02]
 [-1.84226180e-03]
 [ 1.39351476e-02]
 [ 3.82184601e-03]
 [ 1.26952489e-02]
 [ 1.39711355e-02]
 [-1.91970975e-02]
 [ 1.64837436e-03]
 [-9.60007177e-03]
 [-3.74778451e-03]
 [-1.98867310e-02]
 [ 1.54939731e-02]
 [ 1.96909286e-02]
 [-6.68471427e-03]
 [ 4.72080347e-03]
 [-3.91218353e-03]
 [ 1.13810128e-02]
 [-1.31370635e-04]
 [-1.27286424e-02]
 [-8.85379339e-04]
 [-2.89587736e-03]
 [ 4.20921403e-03]
 [-8.24071957e-03]
 [ 2.14943055e-03]
 [-3.32019264e-03]
 [-1.37069218e-02]
 [-2.13777900e-03]
 [-8.69363301e-03]
 [ 1.01326175e-02]
 [-3.04425981e-03]
 [ 3.35456632e-03]
 [ 2.77433756e-03]
 [ 2.50684640e-03]
 [ 2.81443810e-03]
 [ 8.99241164e-03]
 [ 1.42351505e-02]
 [-1.01426176e-02]
 [ 1.37764645e-02]
 [ 2.73211731e-03]
 [ 3.72711902e-03]
 [-1.43015302e-02]
 [-1.25998748e-02]
 [-1.48197302e-03]
 [-1.14885953e-02]
 [-4.90142462e-03]
 [ 1.01869677e-02]
 [ 2.28557283e-03]
 [ 1.05239931e-02]
 [-1.74345123e-02]
 [-3.28445695e-03]
 [ 1.52496575e-03]
 [ 7.32422335e-04]
 [ 8.48397660e-03]
 [-7.94504116e-04]
 [ 2.89314124e-03]
 [ 9.36818294e-03]
 [-1.27621463e-02]
 [-4.70853727e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.35738064]
curr_Stock_Price:  99.33005369420702
curr_Factors:  [99.33005369]
mat_Sqrt:  [[0.15]]
grads:  [-0.25702804]
Stock Position:  -0.25702804157235676
Bond Position:  [17.17322853]


portfolio before change:  [-8.30711388]
curr_Stock_Price:  99.13866056794653
curr_Factors:  [99.13866057]
mat_Sqrt:  [[0.15]]
grads:  [0.03264328]
Stock Position:  0.03264327964161635
Bond Position:  [-11.5433249]


portfolio before change:  [-8.32745882]
curr_Stock_Price:  98.53751194363646
curr_Factors:  [98.53751194]
mat_Sqrt:  [[0.15]]
grads:  [0.00060571]
Stock Position:  0.0006057051330389038
Bond Position:  [-8.3871435]


portfolio before change:  [-8.32774004]
curr_Stock_Price:  98.93869120201643
curr_Factors:  [98.9386912]
mat_Sqrt:  [[0.15]]
grads:  [-0.00323558]
Stock Position:  -0.0032355781476813093
Bond Position:  [-8.00761617]


portfolio before change:  [-8.32821801]
curr_Stock_Price:  98.93173216313242
curr_Factors:  [98.93173216]
mat_Sqrt:  [[0.15]]
grads:  [-0.08081216]
Stock Position:  -0.08081216118952629
Bond Position:  [-0.33333093]


portfolio before change:  [-8.37418981]
curr_Stock_Price:  99.50034660384442
curr_Factors:  [99.5003466]
mat_Sqrt:  [[0.15]]
grads:  [0.07161936]
Stock Position:  0.0716193640257242
Bond Position:  [-15.50034135]


portfolio before change:  [-8.38974573]
curr_Stock_Price:  99.29667094567262
curr_Factors:  [99.29667095]
mat_Sqrt:  [[0.15]]
grads:  [0.00333686]
Stock Position:  0.0033368597616893463
Bond Position:  [-8.7210848]


portfolio before change:  [-8.39121249]
curr_Stock_Price:  99.02046086634031
curr_Factors:  [99.02046087]
mat_Sqrt:  [[0.15]]
grads:  [0.10217138]
Stock Position:  0.10217137753726079
Bond Position:  [-18.50826938]


portfolio before change:  [-8.31762317]
curr_Stock_Price:  99.75203682300472
curr_Factors:  [99.75203682]
mat_Sqrt:  [[0.15]]
grads:  [0.10630104]
Stock Position:  0.10630103648088837
Bond Position:  [-18.92136808]


portfolio before change:  [-8.28172191]
curr_Stock_Price:  100.10089398526075
curr_Factors:  [100.10089399]
mat_Sqrt:  [[0.15]]
grads:  [-0.12259597]
Stock Position:  -0.1225959698950459
Bond Position:  [3.99024427]


portfolio before change:  [-8.18250539]
curr_Stock_Price:  99.2936314674093
curr_Factors:  [99.29363147]
mat_Sqrt:  [[0.15]]
grads:  [0.04168794]
Stock Position:  0.04168793725206339
Bond Position:  [-12.32185206]


portfolio before change:  [-8.17826959]
curr_Stock_Price:  99.41371265166897
curr_Factors:  [99.41371265]
mat_Sqrt:  [[0.15]]
grads:  [-0.03739107]
Stock Position:  -0.03739107335906377
Bond Position:  [-4.46108417]


portfolio before change:  [-8.17268053]
curr_Stock_Price:  99.25677988842043
curr_Factors:  [99.25677989]
mat_Sqrt:  [[0.15]]
grads:  [-0.04597449]
Stock Position:  -0.04597449305566164
Bond Position:  [-3.60940039]


portfolio before change:  [-8.16624626]
curr_Stock_Price:  99.11191994235702
curr_Factors:  [99.11191994]
mat_Sqrt:  [[0.15]]
grads:  [0.02544848]
Stock Position:  0.0254484768598044
Bond Position:  [-10.68849366]


portfolio before change:  [-8.1541745]
curr_Stock_Price:  99.61253201852759
curr_Factors:  [99.61253202]
mat_Sqrt:  [[0.15]]
grads:  [0.01729865]
Stock Position:  0.017298645122801732
Bond Position:  [-9.87733634]


portfolio before change:  [-8.14883771]
curr_Stock_Price:  99.95672910376794
curr_Factors:  [99.9567291]
mat_Sqrt:  [[0.15]]
grads:  [0.00529701]
Stock Position:  0.00529701291439919
Bond Position:  [-8.67830979]


portfolio before change:  [-8.14923486]
curr_Stock_Price:  99.98415153609659
curr_Factors:  [99.98415154]
mat_Sqrt:  [[0.15]]
grads:  [0.05464721]
Stock Position:  0.054647205904776903
Bond Position:  [-13.61308938]


portfolio before change:  [-8.12701834]
curr_Stock_Price:  100.4062658070688
curr_Factors:  [100.40626581]
mat_Sqrt:  [[0.15]]
grads:  [0.08251969]
Stock Position:  0.0825196920939955
Bond Position:  [-16.41251248]


portfolio before change:  [-8.17642344]
curr_Stock_Price:  99.81999013136809
curr_Factors:  [99.81999013]
mat_Sqrt:  [[0.15]]
grads:  [0.1607032]
Stock Position:  0.1607032048196077
Bond Position:  [-24.21781576]


portfolio before change:  [-8.22392047]
curr_Stock_Price:  99.53385167234237
curr_Factors:  [99.53385167]
mat_Sqrt:  [[0.15]]
grads:  [0.06825732]
Stock Position:  0.06825731526796999
Bond Position:  [-15.01783397]


portfolio before change:  [-8.26372587]
curr_Stock_Price:  98.96443649413705
curr_Factors:  [98.96443649]
mat_Sqrt:  [[0.15]]
grads:  [0.3277679]
Stock Position:  0.3277679023281863
Bond Position:  [-40.70109162]


portfolio before change:  [-8.2174373]
curr_Stock_Price:  99.1134213870728
curr_Factors:  [99.11342139]
mat_Sqrt:  [[0.15]]
grads:  [-0.11436402]
Stock Position:  -0.1143640247396524
Bond Position:  [3.11757248]


portfolio before change:  [-8.25413596]
curr_Stock_Price:  99.43601856432379
curr_Factors:  [99.43601856]
mat_Sqrt:  [[0.15]]
grads:  [-0.01228175]
Stock Position:  -0.012281745326054607
Bond Position:  [-7.0328881]


portfolio before change:  [-8.25300091]
curr_Stock_Price:  99.30781067662957
curr_Factors:  [99.30781068]
mat_Sqrt:  [[0.15]]
grads:  [0.09290098]
Stock Position:  0.09290098411519436
Bond Position:  [-17.47879425]


portfolio before change:  [-8.34052196]
curr_Stock_Price:  98.37748047197584
curr_Factors:  [98.37748047]
mat_Sqrt:  [[0.15]]
grads:  [0.02547897]
Stock Position:  0.02547897338228461
Bond Position:  [-10.84707917]


portfolio before change:  [-8.35067674]
curr_Stock_Price:  98.00553391895124
curr_Factors:  [98.00553392]
mat_Sqrt:  [[0.15]]
grads:  [0.08463499]
Stock Position:  0.08463499294477395
Bond Position:  [-16.64537441]


portfolio before change:  [-8.34775714]
curr_Stock_Price:  98.05232269107972
curr_Factors:  [98.05232269]
mat_Sqrt:  [[0.15]]
grads:  [0.0931409]
Stock Position:  0.09314090328192047
Bond Position:  [-17.48043905]


portfolio before change:  [-8.36533211]
curr_Stock_Price:  97.8753605936407
curr_Factors:  [97.87536059]
mat_Sqrt:  [[0.15]]
grads:  [-0.12798065]
Stock Position:  -0.12798064994851072
Bond Position:  [4.16082015]


portfolio before change:  [-8.41116103]
curr_Stock_Price:  98.23548519323428
curr_Factors:  [98.23548519]
mat_Sqrt:  [[0.15]]
grads:  [0.01098916]
Stock Position:  0.010989162374118353
Bond Position:  [-9.49068673]


portfolio before change:  [-8.4087113]
curr_Stock_Price:  98.51238695752538
curr_Factors:  [98.51238696]
mat_Sqrt:  [[0.15]]
grads:  [-0.06400048]
Stock Position:  -0.06400047848842391
Bond Position:  [-2.1038714]


portfolio before change:  [-8.42531775]
curr_Stock_Price:  98.76980616276622
curr_Factors:  [98.76980616]
mat_Sqrt:  [[0.15]]
grads:  [-0.02498523]
Stock Position:  -0.024985230043622412
Bond Position:  [-5.95753142]


portfolio before change:  [-8.43190173]
curr_Stock_Price:  99.01841815525015
curr_Factors:  [99.01841816]
mat_Sqrt:  [[0.15]]
grads:  [-0.13257821]
Stock Position:  -0.13257820658156821
Bond Position:  [4.69578256]


portfolio before change:  [-8.40506079]
curr_Stock_Price:  98.81817826946254
curr_Factors:  [98.81817827]
mat_Sqrt:  [[0.15]]
grads:  [0.10329315]
Stock Position:  0.10329315393604219
Bond Position:  [-18.61230209]


portfolio before change:  [-8.39748791]
curr_Stock_Price:  98.902754938833
curr_Factors:  [98.90275494]
mat_Sqrt:  [[0.15]]
grads:  [0.13127286]
Stock Position:  0.13127285700294844
Bond Position:  [-21.38073511]


portfolio before change:  [-8.3326446]
curr_Stock_Price:  99.40689303996768
curr_Factors:  [99.40689304]
mat_Sqrt:  [[0.15]]
grads:  [-0.04456476]
Stock Position:  -0.04456476179812437
Bond Position:  [-3.90260009]


portfolio before change:  [-8.32116993]
curr_Stock_Price:  99.14393678478027
curr_Factors:  [99.14393678]
mat_Sqrt:  [[0.15]]
grads:  [0.03147202]
Stock Position:  0.03147202313088669
Bond Position:  [-11.44143021]


portfolio before change:  [-8.29166757]
curr_Stock_Price:  100.10407453653958
curr_Factors:  [100.10407454]
mat_Sqrt:  [[0.15]]
grads:  [-0.02608122]
Stock Position:  -0.026081223546524836
Bond Position:  [-5.68083082]


portfolio before change:  [-8.26469403]
curr_Stock_Price:  99.05624797156662
curr_Factors:  [99.05624797]
mat_Sqrt:  [[0.15]]
grads:  [0.07587342]
Stock Position:  0.07587341849425495
Bond Position:  [-15.78043019]


portfolio before change:  [-8.22394581]
curr_Stock_Price:  99.6063026406381
curr_Factors:  [99.60630264]
mat_Sqrt:  [[0.15]]
grads:  [-0.0008758]
Stock Position:  -0.0008758042357149907
Bond Position:  [-8.13671019]


portfolio before change:  [-8.22526551]
curr_Stock_Price:  100.53246079609238
curr_Factors:  [100.5324608]
mat_Sqrt:  [[0.15]]
grads:  [-0.08485762]
Stock Position:  -0.08485761622246876
Bond Position:  [0.30567947]


portfolio before change:  [-8.20997788]
curr_Stock_Price:  100.35252979125448
curr_Factors:  [100.35252979]
mat_Sqrt:  [[0.15]]
grads:  [-0.00590253]
Stock Position:  -0.005902528924069279
Bond Position:  [-7.61764417]


portfolio before change:  [-8.20751254]
curr_Stock_Price:  99.85419119596646
curr_Factors:  [99.8541912]
mat_Sqrt:  [[0.15]]
grads:  [-0.01930585]
Stock Position:  -0.019305849063334175
Bond Position:  [-6.2797426]


portfolio before change:  [-8.19506355]
curr_Stock_Price:  99.18903032785225
curr_Factors:  [99.18903033]
mat_Sqrt:  [[0.15]]
grads:  [0.02806143]
Stock Position:  0.028061426880057548
Bond Position:  [-10.97844927]


portfolio before change:  [-8.20559317]
curr_Stock_Price:  98.83824813627298
curr_Factors:  [98.83824814]
mat_Sqrt:  [[0.15]]
grads:  [-0.05493813]
Stock Position:  -0.05493813044246311
Bond Position:  [-2.7756046]


portfolio before change:  [-8.20452109]
curr_Stock_Price:  98.81557612616534
curr_Factors:  [98.81557613]
mat_Sqrt:  [[0.15]]
grads:  [0.01432954]
Stock Position:  0.014329536972162858
Bond Position:  [-9.62050254]


portfolio before change:  [-8.2046585]
curr_Stock_Price:  98.84794892338029
curr_Factors:  [98.84794892]
mat_Sqrt:  [[0.15]]
grads:  [-0.02213462]
Stock Position:  -0.022134617624713093
Bond Position:  [-6.01669695]


portfolio before change:  [-8.20830758]
curr_Stock_Price:  98.99581756007854
curr_Factors:  [98.99581756]
mat_Sqrt:  [[0.15]]
grads:  [-0.09137948]
Stock Position:  -0.09137947899579694
Bond Position:  [0.83787866]


portfolio before change:  [-8.21132258]
curr_Stock_Price:  99.02938503466628
curr_Factors:  [99.02938503]
mat_Sqrt:  [[0.15]]
grads:  [-0.01425186]
Stock Position:  -0.014251860025271523
Bond Position:  [-6.79996965]


portfolio before change:  [-8.21124085]
curr_Stock_Price:  98.99382831739904
curr_Factors:  [98.99382832]
mat_Sqrt:  [[0.15]]
grads:  [-0.05795755]
Stock Position:  -0.057957553398652426
Bond Position:  [-2.47380076]


portfolio before change:  [-8.21137856]
curr_Stock_Price:  98.99353660511777
curr_Factors:  [98.99353661]
mat_Sqrt:  [[0.15]]
grads:  [0.06755078]
Stock Position:  0.06755078331208315
Bond Position:  [-14.8984695]


portfolio before change:  [-8.18211882]
curr_Stock_Price:  99.44047320963588
curr_Factors:  [99.44047321]
mat_Sqrt:  [[0.15]]
grads:  [-0.02029507]
Stock Position:  -0.020295065406716703
Bond Position:  [-6.16396791]


portfolio before change:  [-8.17303776]
curr_Stock_Price:  98.97403836045663
curr_Factors:  [98.97403836]
mat_Sqrt:  [[0.15]]
grads:  [0.02236378]
Stock Position:  0.022363775436608013
Bond Position:  [-10.38647093]


portfolio before change:  [-8.17913957]
curr_Stock_Price:  98.73022274901055
curr_Factors:  [98.73022275]
mat_Sqrt:  [[0.15]]
grads:  [0.01849558]
Stock Position:  0.018495583752571317
Bond Position:  [-10.00521267]


portfolio before change:  [-8.195748]
curr_Stock_Price:  97.86606564539271
curr_Factors:  [97.86606565]
mat_Sqrt:  [[0.15]]
grads:  [0.01671231]
Stock Position:  0.016712309353439463
Bond Position:  [-9.83131597]


portfolio before change:  [-8.19593983]
curr_Stock_Price:  97.89135574645108
curr_Factors:  [97.89135575]
mat_Sqrt:  [[0.15]]
grads:  [0.01876292]
Stock Position:  0.018762920678268083
Bond Position:  [-10.03266757]


portfolio before change:  [-8.18997566]
curr_Stock_Price:  98.24264555104322
curr_Factors:  [98.24264555]
mat_Sqrt:  [[0.15]]
grads:  [0.05994941]
Stock Position:  0.059949410933829154
Bond Position:  [-14.07956439]


portfolio before change:  [-8.19399291]
curr_Stock_Price:  98.19031407111554
curr_Factors:  [98.19031407]
mat_Sqrt:  [[0.15]]
grads:  [0.094901]
Stock Position:  0.09490100354113037
Bond Position:  [-17.51235225]


portfolio before change:  [-8.20206408]
curr_Stock_Price:  98.1167993322751
curr_Factors:  [98.11679933]
mat_Sqrt:  [[0.15]]
grads:  [-0.06761745]
Stock Position:  -0.06761745091973007
Bond Position:  [-1.56765622]


portfolio before change:  [-8.20435681]
curr_Stock_Price:  98.14925760414663
curr_Factors:  [98.1492576]
mat_Sqrt:  [[0.15]]
grads:  [0.0918431]
Stock Position:  0.0918430964785998
Bond Position:  [-17.21868855]


portfolio before change:  [-8.17994519]
curr_Stock_Price:  98.42677246859623
curr_Factors:  [98.42677247]
mat_Sqrt:  [[0.15]]
grads:  [0.01821412]
Stock Position:  0.01821411539728489
Bond Position:  [-9.97270178]


portfolio before change:  [-8.18853721]
curr_Stock_Price:  97.98927088737842
curr_Factors:  [97.98927089]
mat_Sqrt:  [[0.15]]
grads:  [0.02484746]
Stock Position:  0.024847460147346467
Bond Position:  [-10.62332171]


portfolio before change:  [-8.17448835]
curr_Stock_Price:  98.58139702724759
curr_Factors:  [98.58139703]
mat_Sqrt:  [[0.15]]
grads:  [-0.09534353]
Stock Position:  -0.0953435344993132
Bond Position:  [1.22461047]


portfolio before change:  [-8.18982258]
curr_Stock_Price:  98.743031175018
curr_Factors:  [98.74303118]
mat_Sqrt:  [[0.15]]
grads:  [-0.08399917]
Stock Position:  -0.08399916549473861
Bond Position:  [0.10450963]


portfolio before change:  [-8.20256187]
curr_Stock_Price:  98.8947685928733
curr_Factors:  [98.89476859]
mat_Sqrt:  [[0.15]]
grads:  [-0.00987982]
Stock Position:  -0.009879820159344256
Bond Position:  [-7.22549934]


portfolio before change:  [-8.19916242]
curr_Stock_Price:  98.50497893566175
curr_Factors:  [98.50497894]
mat_Sqrt:  [[0.15]]
grads:  [-0.07659064]
Stock Position:  -0.07659063511076937
Bond Position:  [-0.65460353]


portfolio before change:  [-8.19647709]
curr_Stock_Price:  98.46938381395947
curr_Factors:  [98.46938381]
mat_Sqrt:  [[0.15]]
grads:  [-0.03267616]
Stock Position:  -0.03267616414579754
Bond Position:  [-4.97887534]


portfolio before change:  [-8.16904454]
curr_Stock_Price:  97.62033260209445
curr_Factors:  [97.6203326]
mat_Sqrt:  [[0.15]]
grads:  [0.06791312]
Stock Position:  0.0679131177297963
Bond Position:  [-14.79874568]


portfolio before change:  [-8.12532184]
curr_Stock_Price:  98.27775566985255
curr_Factors:  [98.27775567]
mat_Sqrt:  [[0.15]]
grads:  [0.01523715]
Stock Position:  0.015237152195276223
Bond Position:  [-9.62279496]


portfolio before change:  [-8.13748992]
curr_Stock_Price:  97.51864785011733
curr_Factors:  [97.51864785]
mat_Sqrt:  [[0.15]]
grads:  [0.07015995]
Stock Position:  0.07015995381396008
Bond Position:  [-14.97939375]


portfolio before change:  [-8.13326574]
curr_Stock_Price:  97.59220019919097
curr_Factors:  [97.5922002]
mat_Sqrt:  [[0.15]]
grads:  [-0.11623008]
Stock Position:  -0.11623008191030948
Bond Position:  [3.20988369]


portfolio before change:  [-8.2560504]
curr_Stock_Price:  98.65031946123781
curr_Factors:  [98.65031946]
mat_Sqrt:  [[0.15]]
grads:  [-0.02189638]
Stock Position:  -0.021896379656979402
Bond Position:  [-6.09596555]


portfolio before change:  [-8.24814927]
curr_Stock_Price:  98.27207684207549
curr_Factors:  [98.27207684]
mat_Sqrt:  [[0.15]]
grads:  [0.01016644]
Stock Position:  0.010166438348706276
Bond Position:  [-9.24722628]


portfolio before change:  [-8.25009613]
curr_Stock_Price:  98.13742804569813
curr_Factors:  [98.13742805]
mat_Sqrt:  [[0.15]]
grads:  [0.00488282]
Stock Position:  0.004882815569377317
Bond Position:  [-8.7292831]


portfolio before change:  [-8.25042119]
curr_Stock_Price:  98.18259502485053
curr_Factors:  [98.18259502]
mat_Sqrt:  [[0.15]]
grads:  [0.05655984]
Stock Position:  0.056559843971571655
Bond Position:  [-13.80361344]


portfolio before change:  [-8.31578017]
curr_Stock_Price:  97.04227666441284
curr_Factors:  [97.04227666]
mat_Sqrt:  [[0.15]]
grads:  [-0.00529669]
Stock Position:  -0.005296694109562048
Bond Position:  [-7.80177692]


portfolio before change:  [-8.31201646]
curr_Stock_Price:  96.23963669748926
curr_Factors:  [96.2396367]
mat_Sqrt:  [[0.15]]
grads:  [0.01928761]
Stock Position:  0.01928760824429245
Bond Position:  [-10.16824887]


portfolio before change:  [-8.32096264]
curr_Stock_Price:  95.80875647652933
curr_Factors:  [95.80875648]
mat_Sqrt:  [[0.15]]
grads:  [0.06245455]
Stock Position:  0.062454552917413864
Bond Position:  [-14.30465569]


portfolio before change:  [-8.34360172]
curr_Stock_Price:  95.46058324058613
curr_Factors:  [95.46058324]
mat_Sqrt:  [[0.15]]
grads:  [-0.08508098]
Stock Position:  -0.08508097509712495
Bond Position:  [-0.22172221]


portfolio before change:  [-8.32822738]
curr_Stock_Price:  95.27971792330406
curr_Factors:  [95.27971792]
mat_Sqrt:  [[0.15]]
grads:  [-0.31390248]
Stock Position:  -0.31390248494563694
Bond Position:  [21.58031284]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.32822738]
Stock Price:  95.15888935108971
PL:  [-8.32822738]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.57213527e-02]
 [ 1.03056088e-03]
 [ 5.01138416e-04]
 [ 2.52536020e-03]
 [ 6.15507870e-03]
 [ 1.20148346e-02]
 [-2.44457181e-04]
 [ 7.09774471e-03]
 [-1.74169740e-03]
 [-1.82666857e-02]
 [ 7.49874181e-03]
 [-4.88475872e-03]
 [-9.72316674e-03]
 [ 4.32454664e-03]
 [ 5.72634541e-03]
 [ 4.81728645e-04]
 [ 2.73290511e-03]
 [ 7.02442867e-03]
 [ 1.98940222e-02]
 [ 1.26087422e-02]
 [ 7.78599996e-02]
 [-1.39755496e-02]
 [ 3.03262119e-03]
 [ 3.23875241e-03]
 [ 1.67638555e-02]
 [ 1.80350861e-02]
 [ 1.10717407e-02]
 [ 6.96051021e-03]
 [ 5.26039838e-03]
 [-1.30353562e-02]
 [-5.69114603e-03]
 [ 3.02559876e-02]
 [ 6.65598129e-03]
 [-3.85206477e-03]
 [-6.04496000e-03]
 [-3.88974840e-03]
 [-4.85149021e-03]
 [ 1.20805390e-03]
 [ 2.54245279e-03]
 [-7.80206592e-03]
 [-4.03236483e-02]
 [-3.68993022e-03]
 [ 1.45302727e-02]
 [-1.37447163e-02]
 [-1.90698700e-03]
 [ 2.57292424e-03]
 [-1.36043766e-02]
 [ 6.42897746e-03]
 [ 7.99989705e-03]
 [-9.14365724e-03]
 [-3.27149293e-03]
 [ 3.63606995e-03]
 [ 9.92106863e-04]
 [ 3.29613121e-03]
 [ 5.04893212e-04]
 [ 8.50966282e-03]
 [-9.46485414e-03]
 [-1.52833867e-02]
 [ 1.33956957e-02]
 [ 2.87863775e-03]
 [ 1.21141219e-02]
 [-1.53248441e-02]
 [-1.27549514e-02]
 [-3.23488070e-03]
 [-1.59362601e-02]
 [ 2.89421991e-03]
 [ 2.51440502e-02]
 [ 1.95132171e-03]
 [ 6.16217379e-03]
 [-1.43853705e-02]
 [-6.39973575e-03]
 [-4.38329221e-04]
 [ 2.16586100e-03]
 [ 8.59584491e-03]
 [ 1.11282624e-02]
 [-6.61140151e-03]
 [-3.21690347e-03]
 [-8.89646359e-03]
 [-4.02112962e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.68374635]
curr_Stock_Price:  99.6947019122425
curr_Factors:  [99.69470191]
mat_Sqrt:  [[0.15]]
grads:  [-0.23814235]
Stock Position:  -0.23814235104177406
Bond Position:  [21.05778435]


portfolio before change:  [-2.6565606]
curr_Stock_Price:  99.586071101706
curr_Factors:  [99.5860711]
mat_Sqrt:  [[0.15]]
grads:  [0.00687041]
Stock Position:  0.0068704058921771095
Bond Position:  [-3.34075733]


portfolio before change:  [-2.65377827]
curr_Stock_Price:  100.02143559042219
curr_Factors:  [100.02143559]
mat_Sqrt:  [[0.15]]
grads:  [0.00334092]
Stock Position:  0.003340922774883306
Bond Position:  [-2.98794217]


portfolio before change:  [-2.65083438]
curr_Stock_Price:  100.9584972883366
curr_Factors:  [100.95849729]
mat_Sqrt:  [[0.15]]
grads:  [0.01683573]
Stock Position:  0.01683573465735226
Bond Position:  [-4.35054485]


portfolio before change:  [-2.64726153]
curr_Stock_Price:  101.1868662759994
curr_Factors:  [101.18686628]
mat_Sqrt:  [[0.15]]
grads:  [0.04103386]
Stock Position:  0.041033857969627045
Bond Position:  [-6.79934903]


portfolio before change:  [-2.64641145]
curr_Stock_Price:  101.21793962298995
curr_Factors:  [101.21793962]
mat_Sqrt:  [[0.15]]
grads:  [0.0800989]
Stock Position:  0.08009889726435471
Bond Position:  [-10.75385679]


portfolio before change:  [-2.6057645]
curr_Stock_Price:  101.73379052966814
curr_Factors:  [101.73379053]
mat_Sqrt:  [[0.15]]
grads:  [-0.00162971]
Stock Position:  -0.0016297145385372697
Bond Position:  [-2.43996746]


portfolio before change:  [-2.60504821]
curr_Stock_Price:  101.20069719993211
curr_Factors:  [101.2006972]
mat_Sqrt:  [[0.15]]
grads:  [0.0473183]
Stock Position:  0.047318298053544594
Bond Position:  [-7.39369296]


portfolio before change:  [-2.62274541]
curr_Stock_Price:  100.83646004603776
curr_Factors:  [100.83646005]
mat_Sqrt:  [[0.15]]
grads:  [-0.01161132]
Stock Position:  -0.01161131599932659
Bond Position:  [-1.45190141]


portfolio before change:  [-2.6141047]
curr_Stock_Price:  100.08448147445425
curr_Factors:  [100.08448147]
mat_Sqrt:  [[0.15]]
grads:  [-0.1217779]
Stock Position:  -0.12177790476207057
Bond Position:  [9.57397376]


portfolio before change:  [-2.56486341]
curr_Stock_Price:  99.6850420717297
curr_Factors:  [99.68504207]
mat_Sqrt:  [[0.15]]
grads:  [0.04999161]
Stock Position:  0.04999161208908538
Bond Position:  [-7.54827937]


portfolio before change:  [-2.55331472]
curr_Stock_Price:  99.9254918620868
curr_Factors:  [99.92549186]
mat_Sqrt:  [[0.15]]
grads:  [-0.03256506]
Stock Position:  -0.03256505814863127
Bond Position:  [0.70076473]


portfolio before change:  [-2.55539027]
curr_Stock_Price:  99.9905722250608
curr_Factors:  [99.99057223]
mat_Sqrt:  [[0.15]]
grads:  [-0.06482111]
Stock Position:  -0.06482111159517147
Bond Position:  [3.92610977]


portfolio before change:  [-2.5617723]
curr_Stock_Price:  100.09281392370494
curr_Factors:  [100.09281392]
mat_Sqrt:  [[0.15]]
grads:  [0.02883031]
Stock Position:  0.028830310907488485
Bond Position:  [-5.44747924]


portfolio before change:  [-2.54748339]
curr_Stock_Price:  100.60024481828627
curr_Factors:  [100.60024482]
mat_Sqrt:  [[0.15]]
grads:  [0.03817564]
Stock Position:  0.03817563607382317
Bond Position:  [-6.38796172]


portfolio before change:  [-2.57100437]
curr_Stock_Price:  99.99457780281313
curr_Factors:  [99.9945778]
mat_Sqrt:  [[0.15]]
grads:  [0.00321152]
Stock Position:  0.003211524297459465
Bond Position:  [-2.89213939]


portfolio before change:  [-2.5725036]
curr_Stock_Price:  99.58403718494804
curr_Factors:  [99.58403718]
mat_Sqrt:  [[0.15]]
grads:  [0.01821937]
Stock Position:  0.018219367408088685
Bond Position:  [-4.38686176]


portfolio before change:  [-2.5760072]
curr_Stock_Price:  99.40678515800452
curr_Factors:  [99.40678516]
mat_Sqrt:  [[0.15]]
grads:  [0.04682952]
Stock Position:  0.0468295244839585
Bond Position:  [-7.23117968]


portfolio before change:  [-2.59115882]
curr_Stock_Price:  99.09288789726405
curr_Factors:  [99.0928879]
mat_Sqrt:  [[0.15]]
grads:  [0.13262681]
Stock Position:  0.13262681470984752
Bond Position:  [-15.73353291]


portfolio before change:  [-2.63556665]
curr_Stock_Price:  98.76546956502072
curr_Factors:  [98.76546957]
mat_Sqrt:  [[0.15]]
grads:  [0.08405828]
Stock Position:  0.0840582814270498
Bond Position:  [-10.93762229]


portfolio before change:  [-2.51024484]
curr_Stock_Price:  100.26449414656811
curr_Factors:  [100.26449415]
mat_Sqrt:  [[0.15]]
grads:  [0.51906666]
Stock Position:  0.519066663818291
Bond Position:  [-54.55420132]


portfolio before change:  [-2.60671441]
curr_Stock_Price:  100.08521115882589
curr_Factors:  [100.08521116]
mat_Sqrt:  [[0.15]]
grads:  [-0.09317033]
Stock Position:  -0.09317033093384675
Bond Position:  [6.71825783]


portfolio before change:  [-2.68043181]
curr_Stock_Price:  100.8809290759659
curr_Factors:  [100.88092908]
mat_Sqrt:  [[0.15]]
grads:  [0.02021747]
Stock Position:  0.020217474589565212
Bond Position:  [-4.71998943]


portfolio before change:  [-2.67910762]
curr_Stock_Price:  100.96101810021747
curr_Factors:  [100.9610181]
mat_Sqrt:  [[0.15]]
grads:  [0.02159168]
Stock Position:  0.021591682710688474
Bond Position:  [-4.85902589]


portfolio before change:  [-2.66317669]
curr_Stock_Price:  101.71291098464036
curr_Factors:  [101.71291098]
mat_Sqrt:  [[0.15]]
grads:  [0.11175904]
Stock Position:  0.11175903667429486
Bond Position:  [-14.03051363]


portfolio before change:  [-2.63214029]
curr_Stock_Price:  101.99846580081868
curr_Factors:  [101.9984658]
mat_Sqrt:  [[0.15]]
grads:  [0.12023391]
Stock Position:  0.1202339075744501
Bond Position:  [-14.8958144]


portfolio before change:  [-2.64027366]
curr_Stock_Price:  101.93856291231079
curr_Factors:  [101.93856291]
mat_Sqrt:  [[0.15]]
grads:  [0.0738116]
Stock Position:  0.0738116044771867
Bond Position:  [-10.16452255]


portfolio before change:  [-2.63693827]
curr_Stock_Price:  101.99235795077524
curr_Factors:  [101.99235795]
mat_Sqrt:  [[0.15]]
grads:  [0.0464034]
Stock Position:  0.04640340137536353
Bond Position:  [-7.36973059]


portfolio before change:  [-2.63755344]
curr_Stock_Price:  101.98902744127912
curr_Factors:  [101.98902744]
mat_Sqrt:  [[0.15]]
grads:  [0.03506932]
Stock Position:  0.03506932251727151
Bond Position:  [-6.21423953]


portfolio before change:  [-2.607628]
curr_Stock_Price:  102.8534250581901
curr_Factors:  [102.85342506]
mat_Sqrt:  [[0.15]]
grads:  [-0.08690237]
Stock Position:  -0.08690237479121252
Bond Position:  [6.33057889]


portfolio before change:  [-2.57932131]
curr_Stock_Price:  102.53224838976031
curr_Factors:  [102.53224839]
mat_Sqrt:  [[0.15]]
grads:  [-0.03794097]
Stock Position:  -0.03794097355719564
Bond Position:  [1.31085201]


portfolio before change:  [-2.56108777]
curr_Stock_Price:  102.05383130710474
curr_Factors:  [102.05383131]
mat_Sqrt:  [[0.15]]
grads:  [0.20170658]
Stock Position:  0.2017065839730533
Bond Position:  [-23.14601747]


portfolio before change:  [-2.45083301]
curr_Stock_Price:  102.60761311972807
curr_Factors:  [102.60761312]
mat_Sqrt:  [[0.15]]
grads:  [0.04437321]
Stock Position:  0.04437320863008277
Bond Position:  [-7.00386203]


portfolio before change:  [-2.44035487]
curr_Stock_Price:  102.85361500160705
curr_Factors:  [102.853615]
mat_Sqrt:  [[0.15]]
grads:  [-0.02568043]
Stock Position:  -0.02568043181051131
Bond Position:  [0.20097038]


portfolio before change:  [-2.44823956]
curr_Stock_Price:  103.16113522797464
curr_Factors:  [103.16113523]
mat_Sqrt:  [[0.15]]
grads:  [-0.04029973]
Stock Position:  -0.040299733330949335
Bond Position:  [1.70912668]


portfolio before change:  [-2.45141709]
curr_Stock_Price:  103.24263338112624
curr_Factors:  [103.24263338]
mat_Sqrt:  [[0.15]]
grads:  [-0.02593166]
Stock Position:  -0.025931656011135153
Bond Position:  [0.22583537]


portfolio before change:  [-2.45779626]
curr_Stock_Price:  103.48917699035226
curr_Factors:  [103.48917699]
mat_Sqrt:  [[0.15]]
grads:  [-0.03234327]
Stock Position:  -0.03234326806555224
Bond Position:  [0.88938194]


portfolio before change:  [-2.47961315]
curr_Stock_Price:  104.16543756415616
curr_Factors:  [104.16543756]
mat_Sqrt:  [[0.15]]
grads:  [0.00805369]
Stock Position:  0.008053692665504406
Bond Position:  [-3.31852957]


portfolio before change:  [-2.49003695]
curr_Stock_Price:  102.89690247060484
curr_Factors:  [102.89690247]
mat_Sqrt:  [[0.15]]
grads:  [0.01694969]
Stock Position:  0.01694968529604013
Bond Position:  [-4.23410707]


portfolio before change:  [-2.48219052]
curr_Stock_Price:  103.37544067819141
curr_Factors:  [103.37544068]
mat_Sqrt:  [[0.15]]
grads:  [-0.05201377]
Stock Position:  -0.0520137728283808
Bond Position:  [2.89475617]


portfolio before change:  [-2.48289559]
curr_Stock_Price:  103.39247457318899
curr_Factors:  [103.39247457]
mat_Sqrt:  [[0.15]]
grads:  [-0.26882432]
Stock Position:  -0.26882432233113535
Bond Position:  [25.31151632]


portfolio before change:  [-2.62158069]
curr_Stock_Price:  103.91425442779861
curr_Factors:  [103.91425443]
mat_Sqrt:  [[0.15]]
grads:  [-0.02459953]
Stock Position:  -0.02459953476784626
Bond Position:  [-0.06533837]


portfolio before change:  [-2.61730101]
curr_Stock_Price:  103.74011460616653
curr_Factors:  [103.74011461]
mat_Sqrt:  [[0.15]]
grads:  [0.09686848]
Stock Position:  0.09686848471430527
Bond Position:  [-12.66644872]


portfolio before change:  [-2.58536622]
curr_Stock_Price:  104.07795894080387
curr_Factors:  [104.07795894]
mat_Sqrt:  [[0.15]]
grads:  [-0.09163144]
Stock Position:  -0.09163144232237547
Bond Position:  [6.95144727]


portfolio before change:  [-2.55351908]
curr_Stock_Price:  103.7351435937194
curr_Factors:  [103.73514359]
mat_Sqrt:  [[0.15]]
grads:  [-0.01271325]
Stock Position:  -0.012713246651035069
Bond Position:  [-1.23470861]


portfolio before change:  [-2.55632881]
curr_Stock_Price:  103.9500815591975
curr_Factors:  [103.95008156]
mat_Sqrt:  [[0.15]]
grads:  [0.01715283]
Stock Position:  0.01715282826328367
Bond Position:  [-4.33936671]


portfolio before change:  [-2.55619167]
curr_Stock_Price:  103.97388872763807
curr_Factors:  [103.97388873]
mat_Sqrt:  [[0.15]]
grads:  [-0.09069584]
Stock Position:  -0.09069584387012414
Bond Position:  [6.87380791]


portfolio before change:  [-2.52215876]
curr_Stock_Price:  103.60338356885515
curr_Factors:  [103.60338357]
mat_Sqrt:  [[0.15]]
grads:  [0.04285985]
Stock Position:  0.04285984971381288
Bond Position:  [-6.96258421]


portfolio before change:  [-2.52744091]
curr_Stock_Price:  103.4902947033201
curr_Factors:  [103.4902947]
mat_Sqrt:  [[0.15]]
grads:  [0.05333265]
Stock Position:  0.05333264696868367
Bond Position:  [-8.04685226]


portfolio before change:  [-2.53155244]
curr_Stock_Price:  103.422632771302
curr_Factors:  [103.42263277]
mat_Sqrt:  [[0.15]]
grads:  [-0.06095771]
Stock Position:  -0.0609577149207839
Bond Position:  [3.77285492]


portfolio before change:  [-2.46674198]
curr_Stock_Price:  102.36329755229787
curr_Factors:  [102.36329755]
mat_Sqrt:  [[0.15]]
grads:  [-0.02180995]
Stock Position:  -0.021809952891970658
Bond Position:  [-0.23420328]


portfolio before change:  [-2.46463352]
curr_Stock_Price:  102.2659520147776
curr_Factors:  [102.26595201]
mat_Sqrt:  [[0.15]]
grads:  [0.02424047]
Stock Position:  0.024240466302477903
Bond Position:  [-4.94360788]


portfolio before change:  [-2.46038701]
curr_Stock_Price:  102.45388108893273
curr_Factors:  [102.45388109]
mat_Sqrt:  [[0.15]]
grads:  [0.00661405]
Stock Position:  0.006614045751411841
Bond Position:  [-3.13802167]


portfolio before change:  [-2.4603094]
curr_Stock_Price:  102.49526981323348
curr_Factors:  [102.49526981]
mat_Sqrt:  [[0.15]]
grads:  [0.02197421]
Stock Position:  0.0219742080537153
Bond Position:  [-4.71256178]


portfolio before change:  [-2.47326671]
curr_Stock_Price:  101.91901408341656
curr_Factors:  [101.91901408]
mat_Sqrt:  [[0.15]]
grads:  [0.00336595]
Stock Position:  0.003365954748072939
Bond Position:  [-2.81632149]


portfolio before change:  [-2.47348265]
curr_Stock_Price:  101.90715307917998
curr_Factors:  [101.90715308]
mat_Sqrt:  [[0.15]]
grads:  [0.05673109]
Stock Position:  0.05673108544253679
Bond Position:  [-8.25478606]


portfolio before change:  [-2.45884398]
curr_Stock_Price:  102.17428377666494
curr_Factors:  [102.17428378]
mat_Sqrt:  [[0.15]]
grads:  [-0.06309903]
Stock Position:  -0.06309902759341691
Bond Position:  [3.98825397]


portfolio before change:  [-2.43736204]
curr_Stock_Price:  101.83778618015432
curr_Factors:  [101.83778618]
mat_Sqrt:  [[0.15]]
grads:  [-0.10188924]
Stock Position:  -0.10188924451833047
Bond Position:  [7.93881306]


portfolio before change:  [-2.40937575]
curr_Stock_Price:  101.56798251115423
curr_Factors:  [101.56798251]
mat_Sqrt:  [[0.15]]
grads:  [0.08930464]
Stock Position:  0.08930463831524536
Bond Position:  [-11.47986769]


portfolio before change:  [-2.31391307]
curr_Stock_Price:  102.644972418332
curr_Factors:  [102.64497242]
mat_Sqrt:  [[0.15]]
grads:  [0.01919092]
Stock Position:  0.01919091833360215
Bond Position:  [-4.28376436]


portfolio before change:  [-2.30243006]
curr_Stock_Price:  103.2572806735454
curr_Factors:  [103.25728067]
mat_Sqrt:  [[0.15]]
grads:  [0.08076081]
Stock Position:  0.08076081264234257
Bond Position:  [-10.64157196]


portfolio before change:  [-2.29864543]
curr_Stock_Price:  103.31237855721737
curr_Factors:  [103.31237856]
mat_Sqrt:  [[0.15]]
grads:  [-0.10216563]
Stock Position:  -0.10216562745869079
Bond Position:  [8.25632855]


portfolio before change:  [-2.34223638]
curr_Stock_Price:  103.74409902408243
curr_Factors:  [103.74409902]
mat_Sqrt:  [[0.15]]
grads:  [-0.08503301]
Stock Position:  -0.08503300906088307
Bond Position:  [6.47943653]


portfolio before change:  [-2.30141697]
curr_Stock_Price:  103.268819622146
curr_Factors:  [103.26881962]
mat_Sqrt:  [[0.15]]
grads:  [-0.02156587]
Stock Position:  -0.021565871330411428
Bond Position:  [-0.07433489]


portfolio before change:  [-2.28701063]
curr_Stock_Price:  102.60058861788897
curr_Factors:  [102.60058862]
mat_Sqrt:  [[0.15]]
grads:  [-0.10624173]
Stock Position:  -0.10624173409069876
Bond Position:  [8.61345382]


portfolio before change:  [-2.21344501]
curr_Stock_Price:  101.91321972323699
curr_Factors:  [101.91321972]
mat_Sqrt:  [[0.15]]
grads:  [0.0192948]
Stock Position:  0.019294799378611355
Bond Position:  [-4.17984014]


portfolio before change:  [-2.22168264]
curr_Stock_Price:  101.49982436389784
curr_Factors:  [101.49982436]
mat_Sqrt:  [[0.15]]
grads:  [0.167627]
Stock Position:  0.16762700125996036
Bond Position:  [-19.23579382]


portfolio before change:  [-2.28420267]
curr_Stock_Price:  101.13402556298625
curr_Factors:  [101.13402556]
mat_Sqrt:  [[0.15]]
grads:  [0.01300881]
Stock Position:  0.013008811402550072
Bond Position:  [-3.59983613]


portfolio before change:  [-2.28732497]
curr_Stock_Price:  100.91130683245147
curr_Factors:  [100.91130683]
mat_Sqrt:  [[0.15]]
grads:  [0.04108116]
Stock Position:  0.04108115859731726
Bond Position:  [-6.43287837]


portfolio before change:  [-2.31894292]
curr_Stock_Price:  100.15144792361394
curr_Factors:  [100.15144792]
mat_Sqrt:  [[0.15]]
grads:  [-0.09590247]
Stock Position:  -0.0959024697049518
Bond Position:  [7.28582828]


portfolio before change:  [-2.32419268]
curr_Stock_Price:  100.21093683207116
curr_Factors:  [100.21093683]
mat_Sqrt:  [[0.15]]
grads:  [-0.0426649]
Stock Position:  -0.04266490498512101
Bond Position:  [1.95129742]


portfolio before change:  [-2.31319379]
curr_Stock_Price:  99.95599821535136
curr_Factors:  [99.95599822]
mat_Sqrt:  [[0.15]]
grads:  [-0.00292219]
Stock Position:  -0.002922194803944856
Bond Position:  [-2.02110289]


portfolio before change:  [-2.31750671]
curr_Stock_Price:  101.38868756334848
curr_Factors:  [101.38868756]
mat_Sqrt:  [[0.15]]
grads:  [0.01443907]
Stock Position:  0.014439073314858265
Bond Position:  [-3.7814654]


portfolio before change:  [-2.32652201]
curr_Stock_Price:  100.78068761564724
curr_Factors:  [100.78068762]
mat_Sqrt:  [[0.15]]
grads:  [0.05730563]
Stock Position:  0.05730563276437256
Bond Position:  [-8.10182309]


portfolio before change:  [-2.35887595]
curr_Stock_Price:  100.22493846068203
curr_Factors:  [100.22493846]
mat_Sqrt:  [[0.15]]
grads:  [0.07418842]
Stock Position:  0.07418841615862444
Bond Position:  [-9.79440539]


portfolio before change:  [-2.40951698]
curr_Stock_Price:  99.55058971187233
curr_Factors:  [99.55058971]
mat_Sqrt:  [[0.15]]
grads:  [-0.04407601]
Stock Position:  -0.044076010077798856
Bond Position:  [1.97827581]


portfolio before change:  [-2.41405147]
curr_Stock_Price:  99.65627382168465
curr_Factors:  [99.65627382]
mat_Sqrt:  [[0.15]]
grads:  [-0.02144602]
Stock Position:  -0.021446023105275193
Bond Position:  [-0.27682072]


portfolio before change:  [-2.40256799]
curr_Stock_Price:  99.12000742414043
curr_Factors:  [99.12000742]
mat_Sqrt:  [[0.15]]
grads:  [-0.05930976]
Stock Position:  -0.05930975725380259
Bond Position:  [3.47621559]


portfolio before change:  [-2.41486158]
curr_Stock_Price:  99.33094835905851
curr_Factors:  [99.33094836]
mat_Sqrt:  [[0.15]]
grads:  [-0.02680753]
Stock Position:  -0.026807530772750325
Bond Position:  [0.24795588]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.41486158]
Stock Price:  98.96993834201307
PL:  [-2.41486158]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.41861540e-02]
 [-1.23051370e-03]
 [ 6.04757132e-04]
 [-6.45770612e-05]
 [-4.43019169e-03]
 [ 1.06648815e-02]
 [ 6.29392443e-04]
 [ 1.56902892e-02]
 [ 1.63421568e-02]
 [ 4.71184643e-03]
 [ 7.67892409e-03]
 [-6.08706398e-03]
 [-2.61201722e-03]
 [ 4.26832027e-03]
 [-7.85876507e-04]
 [ 1.45669234e-02]
 [-3.03753634e-03]
 [ 4.19230293e-03]
 [ 1.29114218e-03]
 [ 1.44477741e-02]
 [-2.73067004e-02]
 [-2.45058962e-02]
 [ 2.52149635e-04]
 [ 2.66576876e-03]
 [-2.66578490e-03]
 [ 1.49739192e-02]
 [ 1.60918585e-02]
 [-2.13815917e-02]
 [ 1.00210357e-03]
 [-8.91645172e-03]
 [-3.45652658e-03]
 [-2.35174722e-02]
 [ 2.04176123e-02]
 [ 1.01284329e-02]
 [-3.00672114e-02]
 [ 8.07230940e-03]
 [-1.78126733e-03]
 [-2.70929928e-03]
 [ 7.06059868e-03]
 [-1.87927291e-02]
 [ 4.28795022e-02]
 [ 1.82203560e-03]
 [ 9.05128982e-03]
 [-9.23043984e-03]
 [-1.18285977e-03]
 [-9.78272226e-03]
 [-1.35050803e-02]
 [-6.59931931e-04]
 [-2.70790819e-03]
 [ 4.27297496e-03]
 [-3.54833306e-03]
 [ 2.95722489e-03]
 [ 3.31725096e-03]
 [ 1.50607518e-03]
 [ 2.96687438e-03]
 [ 8.96326055e-03]
 [ 1.30652674e-02]
 [ 2.35855371e-03]
 [ 1.35052767e-02]
 [ 1.51770891e-03]
 [ 4.84361944e-03]
 [-1.44599335e-02]
 [-1.25944574e-02]
 [-2.04507807e-03]
 [-1.43464114e-02]
 [ 7.12499002e-03]
 [ 1.04069681e-02]
 [ 2.29670482e-03]
 [ 9.74452256e-03]
 [-1.70368171e-02]
 [-1.56535171e-03]
 [ 5.71273996e-04]
 [ 7.43817256e-04]
 [ 8.17670123e-03]
 [ 4.16847898e-03]
 [-1.77086336e-03]
 [-6.13383814e-03]
 [-1.04572229e-02]
 [-2.15695396e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.60433985]
curr_Stock_Price:  99.90602938143967
curr_Factors:  [99.90602938]
mat_Sqrt:  [[0.15]]
grads:  [-0.22790769]
Stock Position:  -0.22790769364218566
Bond Position:  [23.37369259]


portfolio before change:  [0.6158798]
curr_Stock_Price:  99.86180511899069
curr_Factors:  [99.86180512]
mat_Sqrt:  [[0.15]]
grads:  [-0.00820342]
Stock Position:  -0.008203424683725407
Bond Position:  [1.4350886]


portfolio before change:  [0.61503874]
curr_Stock_Price:  99.97526508789359
curr_Factors:  [99.97526509]
mat_Sqrt:  [[0.15]]
grads:  [0.00403171]
Stock Position:  0.004031714214360541
Bond Position:  [0.21196704]


portfolio before change:  [0.61146531]
curr_Stock_Price:  99.08564775608893
curr_Factors:  [99.08564776]
mat_Sqrt:  [[0.15]]
grads:  [-0.00043051]
Stock Position:  -0.00043051374156989505
Bond Position:  [0.65412304]


portfolio before change:  [0.61142622]
curr_Stock_Price:  99.2713952745131
curr_Factors:  [99.27139527]
mat_Sqrt:  [[0.15]]
grads:  [-0.02953461]
Stock Position:  -0.029534611290053654
Bond Position:  [3.54336829]


portfolio before change:  [0.60539477]
curr_Stock_Price:  99.48311016587438
curr_Factors:  [99.48311017]
mat_Sqrt:  [[0.15]]
grads:  [0.07109921]
Stock Position:  0.07109921031254265
Bond Position:  [-6.4677758]


portfolio before change:  [0.6009001]
curr_Stock_Price:  99.42557897467529
curr_Factors:  [99.42557897]
mat_Sqrt:  [[0.15]]
grads:  [0.00419595]
Stock Position:  0.004195949622155524
Bond Position:  [0.18371538]


portfolio before change:  [0.59956577]
curr_Stock_Price:  99.10483844675115
curr_Factors:  [99.10483845]
mat_Sqrt:  [[0.15]]
grads:  [0.10460193]
Stock Position:  0.10460192822728884
Bond Position:  [-9.76699142]


portfolio before change:  [0.58337544]
curr_Stock_Price:  98.9558940247511
curr_Factors:  [98.95589402]
mat_Sqrt:  [[0.15]]
grads:  [0.10894771]
Stock Position:  0.10894771204203123
Bond Position:  [-10.1976428]


portfolio before change:  [0.50583534]
curr_Stock_Price:  98.2500257582967
curr_Factors:  [98.25002576]
mat_Sqrt:  [[0.15]]
grads:  [0.03141231]
Stock Position:  0.03141230951869661
Bond Position:  [-2.58042488]


portfolio before change:  [0.50278907]
curr_Stock_Price:  98.15818320686182
curr_Factors:  [98.15818321]
mat_Sqrt:  [[0.15]]
grads:  [0.05119283]
Stock Position:  0.05119282727843684
Bond Position:  [-4.52220585]


portfolio before change:  [0.55158654]
curr_Stock_Price:  99.11691349896243
curr_Factors:  [99.1169135]
mat_Sqrt:  [[0.15]]
grads:  [-0.04058043]
Stock Position:  -0.04058042652749975
Bond Position:  [4.57379316]


portfolio before change:  [0.57066775]
curr_Stock_Price:  98.65375076068182
curr_Factors:  [98.65375076]
mat_Sqrt:  [[0.15]]
grads:  [-0.01741345]
Stock Position:  -0.01741344812155495
Bond Position:  [2.28856972]


portfolio before change:  [0.55472511]
curr_Stock_Price:  99.57750137983028
curr_Factors:  [99.57750138]
mat_Sqrt:  [[0.15]]
grads:  [0.02845547]
Stock Position:  0.028455468470552227
Bond Position:  [-2.27879934]


portfolio before change:  [0.54702122]
curr_Stock_Price:  99.31177175613854
curr_Factors:  [99.31177176]
mat_Sqrt:  [[0.15]]
grads:  [-0.00523918]
Stock Position:  -0.005239176714840327
Bond Position:  [1.06733314]


portfolio before change:  [0.55191245]
curr_Stock_Price:  98.39091738395723
curr_Factors:  [98.39091738]
mat_Sqrt:  [[0.15]]
grads:  [0.09711282]
Stock Position:  0.09711282234651347
Bond Position:  [-9.00310723]


portfolio before change:  [0.50393625]
curr_Stock_Price:  97.90268642338377
curr_Factors:  [97.90268642]
mat_Sqrt:  [[0.15]]
grads:  [-0.02025024]
Stock Position:  -0.02025024228382761
Bond Position:  [2.48648937]


portfolio before change:  [0.49231378]
curr_Stock_Price:  98.48430322719251
curr_Factors:  [98.48430323]
mat_Sqrt:  [[0.15]]
grads:  [0.02794869]
Stock Position:  0.027948686206775358
Bond Position:  [-2.26019311]


portfolio before change:  [0.47174913]
curr_Stock_Price:  97.75355745521621
curr_Factors:  [97.75355746]
mat_Sqrt:  [[0.15]]
grads:  [0.00860761]
Stock Position:  0.008607614561595561
Bond Position:  [-0.36967582]


portfolio before change:  [0.46840431]
curr_Stock_Price:  97.36765414637529
curr_Factors:  [97.36765415]
mat_Sqrt:  [[0.15]]
grads:  [0.09631849]
Stock Position:  0.09631849406823716
Bond Position:  [-8.9099015]


portfolio before change:  [0.45754565]
curr_Stock_Price:  97.26069878999051
curr_Factors:  [97.26069879]
mat_Sqrt:  [[0.15]]
grads:  [-0.18204467]
Stock Position:  -0.18204466965269533
Bond Position:  [18.16333743]


portfolio before change:  [0.41753329]
curr_Stock_Price:  97.48672903299394
curr_Factors:  [97.48672903]
mat_Sqrt:  [[0.15]]
grads:  [-0.16337264]
Stock Position:  -0.16337264101306412
Bond Position:  [16.34419768]


portfolio before change:  [0.44862116]
curr_Stock_Price:  97.30269381734308
curr_Factors:  [97.30269382]
mat_Sqrt:  [[0.15]]
grads:  [0.001681]
Stock Position:  0.001680997564360067
Bond Position:  [0.28505556]


portfolio before change:  [0.44799248]
curr_Stock_Price:  96.91810838022504
curr_Factors:  [96.91810838]
mat_Sqrt:  [[0.15]]
grads:  [0.01777179]
Stock Position:  0.017771791766346662
Bond Position:  [-1.27441596]


portfolio before change:  [0.452456]
curr_Stock_Price:  97.17374748093214
curr_Factors:  [97.17374748]
mat_Sqrt:  [[0.15]]
grads:  [-0.0177719]
Stock Position:  -0.01777189935395523
Bond Position:  [2.17941806]


portfolio before change:  [0.44314215]
curr_Stock_Price:  97.70548962447467
curr_Factors:  [97.70548962]
mat_Sqrt:  [[0.15]]
grads:  [0.09982613]
Stock Position:  0.09982612775990848
Bond Position:  [-9.31041854]


portfolio before change:  [0.38232551]
curr_Stock_Price:  97.10209333157486
curr_Factors:  [97.10209333]
mat_Sqrt:  [[0.15]]
grads:  [0.10727906]
Stock Position:  0.10727905672927043
Bond Position:  [-10.03469547]


portfolio before change:  [0.48774735]
curr_Stock_Price:  98.09062766979616
curr_Factors:  [98.09062767]
mat_Sqrt:  [[0.15]]
grads:  [-0.14254394]
Stock Position:  -0.14254394471460283
Bond Position:  [14.46997236]


portfolio before change:  [0.58428444]
curr_Stock_Price:  97.41972803953637
curr_Factors:  [97.41972804]
mat_Sqrt:  [[0.15]]
grads:  [0.00668069]
Stock Position:  0.006680690470528129
Bond Position:  [-0.06654661]


portfolio before change:  [0.59092813]
curr_Stock_Price:  98.4148135361903
curr_Factors:  [98.41481354]
mat_Sqrt:  [[0.15]]
grads:  [-0.05944301]
Stock Position:  -0.059443011464428736
Bond Position:  [6.44100102]


portfolio before change:  [0.65084295]
curr_Stock_Price:  97.41364892378004
curr_Factors:  [97.41364892]
mat_Sqrt:  [[0.15]]
grads:  [-0.02304351]
Stock Position:  -0.02304351052681126
Bond Position:  [2.89559539]


portfolio before change:  [0.66002182]
curr_Stock_Price:  97.02317512874214
curr_Factors:  [97.02317513]
mat_Sqrt:  [[0.15]]
grads:  [-0.15678315]
Stock Position:  -0.15678314784156835
Bond Position:  [15.87162063]


portfolio before change:  [0.69022376]
curr_Stock_Price:  96.83686724931539
curr_Factors:  [96.83686725]
mat_Sqrt:  [[0.15]]
grads:  [0.13611742]
Stock Position:  0.1361174152018616
Bond Position:  [-12.49096031]


portfolio before change:  [0.69513891]
curr_Stock_Price:  96.87871244726595
curr_Factors:  [96.87871245]
mat_Sqrt:  [[0.15]]
grads:  [0.06752289]
Stock Position:  0.06752288594506216
Bond Position:  [-5.84639134]


portfolio before change:  [0.65227702]
curr_Stock_Price:  96.24934835590992
curr_Factors:  [96.24934836]
mat_Sqrt:  [[0.15]]
grads:  [-0.20044808]
Stock Position:  -0.20044807628007288
Bond Position:  [19.94527374]


portfolio before change:  [0.57111628]
curr_Stock_Price:  96.66046409832428
curr_Factors:  [96.6604641]
mat_Sqrt:  [[0.15]]
grads:  [0.0538154]
Stock Position:  0.053815395986838224
Bond Position:  [-4.63070487]


portfolio before change:  [0.56089448]
curr_Stock_Price:  96.47590043376152
curr_Factors:  [96.47590043]
mat_Sqrt:  [[0.15]]
grads:  [-0.01187512]
Stock Position:  -0.011875115512907838
Bond Position:  [1.70655695]


portfolio before change:  [0.55960672]
curr_Stock_Price:  96.59332514201785
curr_Factors:  [96.59332514]
mat_Sqrt:  [[0.15]]
grads:  [-0.018062]
Stock Position:  -0.01806199521519653
Bond Position:  [2.30427489]


portfolio before change:  [0.56953259]
curr_Stock_Price:  96.05175388107568
curr_Factors:  [96.05175388]
mat_Sqrt:  [[0.15]]
grads:  [0.04707066]
Stock Position:  0.04707065789549098
Bond Position:  [-3.95168665]


portfolio before change:  [0.55429492]
curr_Stock_Price:  95.73328196505476
curr_Factors:  [95.73328197]
mat_Sqrt:  [[0.15]]
grads:  [-0.12528486]
Stock Position:  -0.12528486043665713
Bond Position:  [12.54822579]


portfolio before change:  [0.45226777]
curr_Stock_Price:  96.55390339800208
curr_Factors:  [96.5539034]
mat_Sqrt:  [[0.15]]
grads:  [0.28586335]
Stock Position:  0.2858633479777964
Bond Position:  [-27.14895431]


portfolio before change:  [0.24267063]
curr_Stock_Price:  95.82663185462542
curr_Factors:  [95.82663185]
mat_Sqrt:  [[0.15]]
grads:  [0.0121469]
Stock Position:  0.012146904003802524
Bond Position:  [-0.92132627]


portfolio before change:  [0.23865953]
curr_Stock_Price:  95.50115665628788
curr_Factors:  [95.50115666]
mat_Sqrt:  [[0.15]]
grads:  [0.06034193]
Stock Position:  0.06034193213646099
Bond Position:  [-5.52406478]


portfolio before change:  [0.26874718]
curr_Stock_Price:  96.00549767902325
curr_Factors:  [96.00549768]
mat_Sqrt:  [[0.15]]
grads:  [-0.06153627]
Stock Position:  -0.06153626560506879
Bond Position:  [6.17656698]


portfolio before change:  [0.25401518]
curr_Stock_Price:  96.25117472824223
curr_Factors:  [96.25117473]
mat_Sqrt:  [[0.15]]
grads:  [-0.00788573]
Stock Position:  -0.007885731771189947
Bond Position:  [1.01302612]


portfolio before change:  [0.25207019]
curr_Stock_Price:  96.50584981719629
curr_Factors:  [96.50584982]
mat_Sqrt:  [[0.15]]
grads:  [-0.06521815]
Stock Position:  -0.06521814841035078
Bond Position:  [6.54600303]


portfolio before change:  [0.20898458]
curr_Stock_Price:  97.1727615530849
curr_Factors:  [97.17276155]
mat_Sqrt:  [[0.15]]
grads:  [-0.09003387]
Stock Position:  -0.09003386874806425
Bond Position:  [8.95782424]


portfolio before change:  [0.19085898]
curr_Stock_Price:  97.38029995446887
curr_Factors:  [97.38029995]
mat_Sqrt:  [[0.15]]
grads:  [-0.00439955]
Stock Position:  -0.004399546203693837
Bond Position:  [0.61928811]


portfolio before change:  [0.19460769]
curr_Stock_Price:  96.5370309015177
curr_Factors:  [96.5370309]
mat_Sqrt:  [[0.15]]
grads:  [-0.01805272]
Stock Position:  -0.018052721281664526
Bond Position:  [1.9373638]


portfolio before change:  [0.17577805]
curr_Stock_Price:  97.58677401609891
curr_Factors:  [97.58677402]
mat_Sqrt:  [[0.15]]
grads:  [0.0284865]
Stock Position:  0.028486499752593496
Bond Position:  [-2.60412756]


portfolio before change:  [0.16594192]
curr_Stock_Price:  97.2471967086364
curr_Factors:  [97.24719671]
mat_Sqrt:  [[0.15]]
grads:  [-0.02365555]
Stock Position:  -0.02365555372989377
Bond Position:  [2.46637821]


portfolio before change:  [0.17510899]
curr_Stock_Price:  96.86619044231671
curr_Factors:  [96.86619044]
mat_Sqrt:  [[0.15]]
grads:  [0.01971483]
Stock Position:  0.019714832602217246
Bond Position:  [-1.73459174]


portfolio before change:  [0.18552501]
curr_Stock_Price:  97.40002403076764
curr_Factors:  [97.40002403]
mat_Sqrt:  [[0.15]]
grads:  [0.02211501]
Stock Position:  0.02211500638450843
Bond Position:  [-1.96847714]


portfolio before change:  [0.18192602]
curr_Stock_Price:  97.24284733633336
curr_Factors:  [97.24284734]
mat_Sqrt:  [[0.15]]
grads:  [0.0100405]
Stock Position:  0.010040501177758183
Bond Position:  [-0.79444091]


portfolio before change:  [0.18775131]
curr_Stock_Price:  97.82797182991118
curr_Factors:  [97.82797183]
mat_Sqrt:  [[0.15]]
grads:  [0.01977916]
Stock Position:  0.019779162532376843
Bond Position:  [-1.74720405]


portfolio before change:  [0.18919749]
curr_Stock_Price:  97.90660937038274
curr_Factors:  [97.90660937]
mat_Sqrt:  [[0.15]]
grads:  [0.05975507]
Stock Position:  0.05975507032206187
Bond Position:  [-5.66121884]


portfolio before change:  [0.1796357]
curr_Stock_Price:  97.75251451815834
curr_Factors:  [97.75251452]
mat_Sqrt:  [[0.15]]
grads:  [0.08710178]
Stock Position:  0.08710178284153557
Bond Position:  [-8.33478259]


portfolio before change:  [0.13249787]
curr_Stock_Price:  97.2173143028683
curr_Factors:  [97.2173143]
mat_Sqrt:  [[0.15]]
grads:  [0.01572369]
Stock Position:  0.015723691370129723
Bond Position:  [-1.39611718]


portfolio before change:  [0.12556193]
curr_Stock_Price:  96.78174986581685
curr_Factors:  [96.78174987]
mat_Sqrt:  [[0.15]]
grads:  [0.09003518]
Stock Position:  0.090035177955367
Bond Position:  [-8.58820014]


portfolio before change:  [0.23764912]
curr_Stock_Price:  98.0326384122279
curr_Factors:  [98.03263841]
mat_Sqrt:  [[0.15]]
grads:  [0.01011806]
Stock Position:  0.010118059409178632
Bond Position:  [-0.75425094]


portfolio before change:  [0.24217588]
curr_Stock_Price:  98.48469114084223
curr_Factors:  [98.48469114]
mat_Sqrt:  [[0.15]]
grads:  [0.0322908]
Stock Position:  0.032290796246332125
Bond Position:  [-2.93797322]


portfolio before change:  [0.24241124]
curr_Stock_Price:  98.49766665396702
curr_Factors:  [98.49766665]
mat_Sqrt:  [[0.15]]
grads:  [-0.09639956]
Stock Position:  -0.09639955688066622
Bond Position:  [9.73754266]


portfolio before change:  [0.2129797]
curr_Stock_Price:  98.80928790245095
curr_Factors:  [98.8092879]
mat_Sqrt:  [[0.15]]
grads:  [-0.08396305]
Stock Position:  -0.08396304901757923
Bond Position:  [8.50930878]


portfolio before change:  [0.14993349]
curr_Stock_Price:  99.56650267663207
curr_Factors:  [99.56650268]
mat_Sqrt:  [[0.15]]
grads:  [-0.01363385]
Stock Position:  -0.013633853798963884
Bond Position:  [1.50740863]


portfolio before change:  [0.14585167]
curr_Stock_Price:  99.8728018671103
curr_Factors:  [99.87280187]
mat_Sqrt:  [[0.15]]
grads:  [-0.09564274]
Stock Position:  -0.09564274283229866
Bond Position:  [9.69796037]


portfolio before change:  [0.22521373]
curr_Stock_Price:  99.04936334728075
curr_Factors:  [99.04936335]
mat_Sqrt:  [[0.15]]
grads:  [0.04749993]
Stock Position:  0.04749993344480059
Bond Position:  [-4.47962444]


portfolio before change:  [0.17977671]
curr_Stock_Price:  98.09868771698733
curr_Factors:  [98.09868772]
mat_Sqrt:  [[0.15]]
grads:  [0.06937979]
Stock Position:  0.06937978765068062
Bond Position:  [-6.62628941]


portfolio before change:  [0.19030046]
curr_Stock_Price:  98.25634037159047
curr_Factors:  [98.25634037]
mat_Sqrt:  [[0.15]]
grads:  [0.01531137]
Stock Position:  0.015311365450512954
Bond Position:  [-1.31413827]


portfolio before change:  [0.18665135]
curr_Stock_Price:  98.02337773802503
curr_Factors:  [98.02337774]
mat_Sqrt:  [[0.15]]
grads:  [0.06496348]
Stock Position:  0.06496348375332772
Bond Position:  [-6.18128876]


portfolio before change:  [0.20768526]
curr_Stock_Price:  98.35310525795568
curr_Factors:  [98.35310526]
mat_Sqrt:  [[0.15]]
grads:  [-0.11357878]
Stock Position:  -0.11357878097950037
Bond Position:  [11.37851106]


portfolio before change:  [0.21322439]
curr_Stock_Price:  98.31059774307495
curr_Factors:  [98.31059774]
mat_Sqrt:  [[0.15]]
grads:  [-0.01043568]
Stock Position:  -0.01043567808929824
Bond Position:  [1.23916214]


portfolio before change:  [0.21072419]
curr_Stock_Price:  98.55760117835516
curr_Factors:  [98.55760118]
mat_Sqrt:  [[0.15]]
grads:  [0.00380849]
Stock Position:  0.0038084933041857153
Bond Position:  [-0.16463177]


portfolio before change:  [0.20913993]
curr_Stock_Price:  98.14432315472867
curr_Factors:  [98.14432315]
mat_Sqrt:  [[0.15]]
grads:  [0.00495878]
Stock Position:  0.004958781708700424
Bond Position:  [-0.27753634]


portfolio before change:  [0.20517638]
curr_Stock_Price:  97.34852155057413
curr_Factors:  [97.34852155]
mat_Sqrt:  [[0.15]]
grads:  [0.05451134]
Stock Position:  0.054511341528471376
Bond Position:  [-5.10142213]


portfolio before change:  [0.24853306]
curr_Stock_Price:  98.14974074305913
curr_Factors:  [98.14974074]
mat_Sqrt:  [[0.15]]
grads:  [0.02778986]
Stock Position:  0.02778985987379285
Bond Position:  [-2.47903448]


portfolio before change:  [0.25401205]
curr_Stock_Price:  98.35247396573506
curr_Factors:  [98.35247397]
mat_Sqrt:  [[0.15]]
grads:  [-0.01180576]
Stock Position:  -0.011805755729385659
Bond Position:  [1.41513733]


portfolio before change:  [0.25067486]
curr_Stock_Price:  98.6426407141605
curr_Factors:  [98.64264071]
mat_Sqrt:  [[0.15]]
grads:  [-0.04089225]
Stock Position:  -0.04089225427142542
Bond Position:  [4.2843948]


portfolio before change:  [0.27422994]
curr_Stock_Price:  98.073161360329
curr_Factors:  [98.07316136]
mat_Sqrt:  [[0.15]]
grads:  [-0.06971482]
Stock Position:  -0.0697148194115951
Bond Position:  [7.11138267]


portfolio before change:  [0.31752628]
curr_Stock_Price:  97.45848767217976
curr_Factors:  [97.45848767]
mat_Sqrt:  [[0.15]]
grads:  [-0.14379693]
Stock Position:  -0.14379693052891926
Bond Position:  [14.33175766]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.31752628]
Stock Price:  97.271442495962
PL:  [0.31752628]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.47082568e-02]
 [ 4.89631241e-03]
 [-4.99053117e-04]
 [ 1.59698490e-03]
 [-5.91996880e-03]
 [ 6.41712567e-03]
 [ 4.72209256e-04]
 [ 1.27999357e-02]
 [ 1.78311416e-02]
 [-1.97949708e-02]
 [ 6.03081964e-03]
 [-5.96118764e-03]
 [-9.32472074e-03]
 [ 4.33590539e-03]
 [ 4.98066340e-03]
 [-1.67655746e-04]
 [ 1.32736458e-02]
 [ 1.43602850e-02]
 [ 2.00978810e-02]
 [ 6.10090600e-04]
 [ 5.81912053e-02]
 [-1.29177465e-02]
 [ 7.39837186e-03]
 [ 7.67696604e-04]
 [ 1.55455361e-02]
 [ 3.40473393e-03]
 [ 1.25228938e-02]
 [ 1.23667850e-03]
 [ 5.40581840e-03]
 [-1.81548042e-02]
 [-5.68317163e-03]
 [ 2.15133138e-02]
 [ 7.13831190e-03]
 [ 1.47157416e-03]
 [-4.50352162e-03]
 [-4.36186962e-03]
 [-6.64856356e-03]
 [ 4.66728605e-03]
 [ 1.54819674e-03]
 [-8.71295492e-03]
 [-1.79400427e-02]
 [-2.57515110e-03]
 [ 8.98991370e-03]
 [-1.34045286e-02]
 [ 1.70106990e-03]
 [ 1.30339632e-03]
 [-1.37076204e-02]
 [-5.04464879e-03]
 [-7.07298327e-03]
 [ 8.65037980e-03]
 [-2.97844623e-03]
 [ 3.77681870e-03]
 [ 4.17606592e-04]
 [-1.15330605e-03]
 [ 2.35492953e-03]
 [ 8.53299958e-03]
 [-7.91992819e-03]
 [-1.45260543e-02]
 [ 1.34946603e-02]
 [ 8.62973266e-03]
 [ 8.82705813e-03]
 [-1.27156441e-02]
 [-1.25445485e-02]
 [-2.20231561e-03]
 [-1.75296768e-02]
 [ 4.22390351e-02]
 [ 1.51559589e-02]
 [ 2.00102363e-03]
 [ 8.70308017e-03]
 [-1.71803731e-02]
 [-1.47766773e-04]
 [ 1.39615999e-03]
 [ 1.37672743e-03]
 [ 8.72715087e-03]
 [ 4.03402024e-03]
 [ 1.26660215e-03]
 [-5.73911490e-04]
 [-1.04364004e-02]
 [-1.95815743e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.95057741]
curr_Stock_Price:  99.22765788679237
curr_Factors:  [99.22765789]
mat_Sqrt:  [[0.15]]
grads:  [-0.23138838]
Stock Position:  -0.23138837889884292
Bond Position:  [13.00954949]


portfolio before change:  [-9.92917615]
curr_Stock_Price:  99.13868134547533
curr_Factors:  [99.13868135]
mat_Sqrt:  [[0.15]]
grads:  [0.03264208]
Stock Position:  0.03264208276182423
Bond Position:  [-13.16526919]


portfolio before change:  [-9.92491134]
curr_Stock_Price:  99.29454345181158
curr_Factors:  [99.29454345]
mat_Sqrt:  [[0.15]]
grads:  [-0.00332702]
Stock Position:  -0.003327020780786941
Bond Position:  [-9.59455633]


portfolio before change:  [-9.92667267]
curr_Stock_Price:  99.6437006611783
curr_Factors:  [99.64370066]
mat_Sqrt:  [[0.15]]
grads:  [0.01064657]
Stock Position:  0.010646565992116382
Bond Position:  [-10.98753591]


portfolio before change:  [-9.93179417]
curr_Stock_Price:  99.22715738392193
curr_Factors:  [99.22715738]
mat_Sqrt:  [[0.15]]
grads:  [-0.03946646]
Stock Position:  -0.0394664586862176
Bond Position:  [-6.01564966]


portfolio before change:  [-9.911106]
curr_Stock_Price:  98.69343419626385
curr_Factors:  [98.6934342]
mat_Sqrt:  [[0.15]]
grads:  [0.04278084]
Stock Position:  0.04278083777224434
Bond Position:  [-14.1332938]


portfolio before change:  [-9.89449428]
curr_Stock_Price:  99.10238082615027
curr_Factors:  [99.10238083]
mat_Sqrt:  [[0.15]]
grads:  [0.00314806]
Stock Position:  0.003148061704900667
Bond Position:  [-10.20647469]


portfolio before change:  [-9.89321247]
curr_Stock_Price:  99.71219359540787
curr_Factors:  [99.7121936]
mat_Sqrt:  [[0.15]]
grads:  [0.0853329]
Stock Position:  0.0853329043736902
Bond Position:  [-18.40194355]


portfolio before change:  [-9.9419415]
curr_Stock_Price:  99.15462590009952
curr_Factors:  [99.1546259]
mat_Sqrt:  [[0.15]]
grads:  [0.11887428]
Stock Position:  0.1188742772665069
Bond Position:  [-21.72887599]


portfolio before change:  [-9.94684403]
curr_Stock_Price:  99.124809235301
curr_Factors:  [99.12480924]
mat_Sqrt:  [[0.15]]
grads:  [-0.13196647]
Stock Position:  -0.1319664717172071
Bond Position:  [3.1343073]


portfolio before change:  [-9.95886318]
curr_Stock_Price:  99.21737097283436
curr_Factors:  [99.21737097]
mat_Sqrt:  [[0.15]]
grads:  [0.04020546]
Stock Position:  0.04020546429446818
Bond Position:  [-13.94794365]


portfolio before change:  [-9.96063412]
curr_Stock_Price:  99.19500664170808
curr_Factors:  [99.19500664]
mat_Sqrt:  [[0.15]]
grads:  [-0.03974125]
Stock Position:  -0.03974125090998955
Bond Position:  [-6.01850047]


portfolio before change:  [-9.98395031]
curr_Stock_Price:  99.77224101945536
curr_Factors:  [99.77224102]
mat_Sqrt:  [[0.15]]
grads:  [-0.0621648]
Stock Position:  -0.06216480496521487
Bond Position:  [-3.7816284]


portfolio before change:  [-10.002438]
curr_Stock_Price:  100.06583704041569
curr_Factors:  [100.06583704]
mat_Sqrt:  [[0.15]]
grads:  [0.02890604]
Stock Position:  0.028906035925611532
Bond Position:  [-12.89494468]


portfolio before change:  [-9.97928112]
curr_Stock_Price:  100.89482784851587
curr_Factors:  [100.89482785]
mat_Sqrt:  [[0.15]]
grads:  [0.03320442]
Stock Position:  0.033204422684975296
Bond Position:  [-13.32943564]


portfolio before change:  [-10.00739767]
curr_Stock_Price:  100.07314725381644
curr_Factors:  [100.07314725]
mat_Sqrt:  [[0.15]]
grads:  [-0.0011177]
Stock Position:  -0.0011177049717185409
Bond Position:  [-9.89554542]


portfolio before change:  [-10.00846883]
curr_Stock_Price:  100.47814970140854
curr_Factors:  [100.4781497]
mat_Sqrt:  [[0.15]]
grads:  [0.08849097]
Stock Position:  0.08849097216094863
Bond Position:  [-18.89987798]


portfolio before change:  [-9.99340739]
curr_Stock_Price:  100.66170205075916
curr_Factors:  [100.66170205]
mat_Sqrt:  [[0.15]]
grads:  [0.09573523]
Stock Position:  0.09573523344940746
Bond Position:  [-19.63027893]


portfolio before change:  [-9.97051034]
curr_Stock_Price:  100.9136885221742
curr_Factors:  [100.91368852]
mat_Sqrt:  [[0.15]]
grads:  [0.13398587]
Stock Position:  0.13398587360915507
Bond Position:  [-23.49151905]


portfolio before change:  [-9.93721215]
curr_Stock_Price:  101.17316703065997
curr_Factors:  [101.17316703]
mat_Sqrt:  [[0.15]]
grads:  [0.00406727]
Stock Position:  0.00406727066675985
Bond Position:  [-10.3487108]


portfolio before change:  [-9.93527405]
curr_Stock_Price:  101.8087075567313
curr_Factors:  [101.80870756]
mat_Sqrt:  [[0.15]]
grads:  [0.38794137]
Stock Position:  0.3879413688242886
Bond Position:  [-49.43108341]


portfolio before change:  [-9.93526306]
curr_Stock_Price:  101.81669981137405
curr_Factors:  [101.81669981]
mat_Sqrt:  [[0.15]]
grads:  [-0.08611831]
Stock Position:  -0.08611830977109532
Bond Position:  [-1.16698096]


portfolio before change:  [-9.91381979]
curr_Stock_Price:  101.56685501092005
curr_Factors:  [101.56685501]
mat_Sqrt:  [[0.15]]
grads:  [0.04932248]
Stock Position:  0.049322479069081625
Bond Position:  [-14.92334887]


portfolio before change:  [-9.93132591]
curr_Stock_Price:  101.23083412964617
curr_Factors:  [101.23083413]
mat_Sqrt:  [[0.15]]
grads:  [0.00511798]
Stock Position:  0.005117977359185838
Bond Position:  [-10.44942302]


portfolio before change:  [-9.93167351]
curr_Stock_Price:  101.29052641081951
curr_Factors:  [101.29052641]
mat_Sqrt:  [[0.15]]
grads:  [0.10363691]
Stock Position:  0.10363690733626206
Bond Position:  [-20.42911041]


portfolio before change:  [-9.95501143]
curr_Stock_Price:  101.07765764711337
curr_Factors:  [101.07765765]
mat_Sqrt:  [[0.15]]
grads:  [0.02269823]
Stock Position:  0.022698226216562728
Bond Position:  [-12.24929497]


portfolio before change:  [-9.95754423]
curr_Stock_Price:  100.99980152804036
curr_Factors:  [100.99980153]
mat_Sqrt:  [[0.15]]
grads:  [0.08348596]
Stock Position:  0.08348595851395349
Bond Position:  [-18.38960947]


portfolio before change:  [-9.9263878]
curr_Stock_Price:  101.38676259861593
curr_Factors:  [101.3867626]
mat_Sqrt:  [[0.15]]
grads:  [0.00824452]
Stock Position:  0.008244523354863458
Bond Position:  [-10.76227334]


portfolio before change:  [-9.9211551]
curr_Stock_Price:  102.1030401500029
curr_Factors:  [102.10304015]
mat_Sqrt:  [[0.15]]
grads:  [0.03603879]
Stock Position:  0.036038789316185135
Bond Position:  [-13.60082505]


portfolio before change:  [-9.91912469]
curr_Stock_Price:  102.1829674852923
curr_Factors:  [102.18296749]
mat_Sqrt:  [[0.15]]
grads:  [-0.12103203]
Stock Position:  -0.12103202775759002
Bond Position:  [2.44828706]


portfolio before change:  [-9.94091255]
curr_Stock_Price:  102.36424908384159
curr_Factors:  [102.36424908]
mat_Sqrt:  [[0.15]]
grads:  [-0.03788781]
Stock Position:  -0.037887810883753634
Bond Position:  [-6.06255524]


portfolio before change:  [-9.909772]
curr_Stock_Price:  101.53233327413454
curr_Factors:  [101.53233327]
mat_Sqrt:  [[0.15]]
grads:  [0.14342209]
Stock Position:  0.14342209233081685
Bond Position:  [-24.47175168]


portfolio before change:  [-9.81887654]
curr_Stock_Price:  102.17675978642615
curr_Factors:  [102.17675979]
mat_Sqrt:  [[0.15]]
grads:  [0.04758875]
Stock Position:  0.04758874602935721
Bond Position:  [-14.68134041]


portfolio before change:  [-9.82663136]
curr_Stock_Price:  102.03308699042702
curr_Factors:  [102.03308699]
mat_Sqrt:  [[0.15]]
grads:  [0.00981049]
Stock Position:  0.009810494424406733
Bond Position:  [-10.82762639]


portfolio before change:  [-9.8232657]
curr_Stock_Price:  102.44513633102956
curr_Factors:  [102.44513633]
mat_Sqrt:  [[0.15]]
grads:  [-0.03002348]
Stock Position:  -0.030023477493635882
Bond Position:  [-6.74750645]


portfolio before change:  [-9.81644727]
curr_Stock_Price:  102.20398642803873
curr_Factors:  [102.20398643]
mat_Sqrt:  [[0.15]]
grads:  [-0.02907913]
Stock Position:  -0.029079130782196032
Bond Position:  [-6.84444418]


portfolio before change:  [-9.82496965]
curr_Stock_Price:  102.48235063937895
curr_Factors:  [102.48235064]
mat_Sqrt:  [[0.15]]
grads:  [-0.04432376]
Stock Position:  -0.04432375706997705
Bond Position:  [-5.28256684]


portfolio before change:  [-9.80896489]
curr_Stock_Price:  102.11381397923222
curr_Factors:  [102.11381398]
mat_Sqrt:  [[0.15]]
grads:  [0.03111524]
Stock Position:  0.03111524036091259
Bond Position:  [-12.98626076]


portfolio before change:  [-9.80480161]
curr_Stock_Price:  102.27370189955981
curr_Factors:  [102.2737019]
mat_Sqrt:  [[0.15]]
grads:  [0.01032131]
Stock Position:  0.010321311595123133
Bond Position:  [-10.86040035]


portfolio before change:  [-9.81098234]
curr_Stock_Price:  101.74063606749299
curr_Factors:  [101.74063607]
mat_Sqrt:  [[0.15]]
grads:  [-0.05808637]
Stock Position:  -0.05808636615282766
Bond Position:  [-3.9012385]


portfolio before change:  [-9.80084166]
curr_Stock_Price:  101.56185879444969
curr_Factors:  [101.56185879]
mat_Sqrt:  [[0.15]]
grads:  [-0.11960028]
Stock Position:  -0.11960028481331364
Bond Position:  [2.34598558]


portfolio before change:  [-9.79885977]
curr_Stock_Price:  101.54651387873304
curr_Factors:  [101.54651388]
mat_Sqrt:  [[0.15]]
grads:  [-0.01716767]
Stock Position:  -0.017167673999241132
Bond Position:  [-8.05554232]


portfolio before change:  [-9.79149991]
curr_Stock_Price:  101.08848143667164
curr_Factors:  [101.08848144]
mat_Sqrt:  [[0.15]]
grads:  [0.05993276]
Stock Position:  0.05993275802600601
Bond Position:  [-15.8500114]


portfolio before change:  [-9.77240018]
curr_Stock_Price:  101.42369685808345
curr_Factors:  [101.42369686]
mat_Sqrt:  [[0.15]]
grads:  [-0.08936352]
Stock Position:  -0.08936352398965278
Bond Position:  [-0.70882121]


portfolio before change:  [-9.7297079]
curr_Stock_Price:  100.94546389057504
curr_Factors:  [100.94546389]
mat_Sqrt:  [[0.15]]
grads:  [0.01134047]
Stock Position:  0.011340465985312357
Bond Position:  [-10.8744765]


portfolio before change:  [-9.7293088]
curr_Stock_Price:  101.04059020006656
curr_Factors:  [101.0405902]
mat_Sqrt:  [[0.15]]
grads:  [0.00868931]
Stock Position:  0.00868930879200456
Bond Position:  [-10.60728169]


portfolio before change:  [-9.73513572]
curr_Stock_Price:  100.4463028500907
curr_Factors:  [100.44630285]
mat_Sqrt:  [[0.15]]
grads:  [-0.09138414]
Stock Position:  -0.0913841359288444
Bond Position:  [-0.55593713]


portfolio before change:  [-9.77603899]
curr_Stock_Price:  100.89351965659576
curr_Factors:  [100.89351966]
mat_Sqrt:  [[0.15]]
grads:  [-0.03363099]
Stock Position:  -0.03363099194711679
Bond Position:  [-6.38288984]


portfolio before change:  [-9.74240286]
curr_Stock_Price:  99.88150465515524
curr_Factors:  [99.88150466]
mat_Sqrt:  [[0.15]]
grads:  [-0.04715322]
Stock Position:  -0.04715322177533733
Bond Position:  [-5.03266812]


portfolio before change:  [-9.75668272]
curr_Stock_Price:  100.17767336170449
curr_Factors:  [100.17767336]
mat_Sqrt:  [[0.15]]
grads:  [0.0576692]
Stock Position:  0.0576691986406596
Bond Position:  [-15.53384887]


portfolio before change:  [-9.72869096]
curr_Stock_Price:  100.67989401342956
curr_Factors:  [100.67989401]
mat_Sqrt:  [[0.15]]
grads:  [-0.01985631]
Stock Position:  -0.01985630817290412
Bond Position:  [-7.72955995]


portfolio before change:  [-9.73957523]
curr_Stock_Price:  101.20371536444455
curr_Factors:  [101.20371536]
mat_Sqrt:  [[0.15]]
grads:  [0.02517879]
Stock Position:  0.025178791306570168
Bond Position:  [-12.28776246]


portfolio before change:  [-9.75265727]
curr_Stock_Price:  100.71465142712039
curr_Factors:  [100.71465143]
mat_Sqrt:  [[0.15]]
grads:  [0.00278404]
Stock Position:  0.0027840439484054947
Bond Position:  [-10.03305129]


portfolio before change:  [-9.75363333]
curr_Stock_Price:  100.58930437449449
curr_Factors:  [100.58930437]
mat_Sqrt:  [[0.15]]
grads:  [-0.00768871]
Stock Position:  -0.007688706972127927
Bond Position:  [-8.98023165]


portfolio before change:  [-9.75394499]
curr_Stock_Price:  100.55683826554659
curr_Factors:  [100.55683827]
mat_Sqrt:  [[0.15]]
grads:  [0.01569953]
Stock Position:  0.015699530231690642
Bond Position:  [-11.33264011]


portfolio before change:  [-9.74688958]
curr_Stock_Price:  101.05135746514028
curr_Factors:  [101.05135747]
mat_Sqrt:  [[0.15]]
grads:  [0.05688666]
Stock Position:  0.0568866638525502
Bond Position:  [-15.49536419]


portfolio before change:  [-9.71883721]
curr_Stock_Price:  101.56150979411021
curr_Factors:  [101.56150979]
mat_Sqrt:  [[0.15]]
grads:  [-0.05279952]
Stock Position:  -0.052799521283261486
Bond Position:  [-4.35643811]


portfolio before change:  [-9.74175402]
curr_Stock_Price:  101.99038730201384
curr_Factors:  [101.9903873]
mat_Sqrt:  [[0.15]]
grads:  [-0.09684036]
Stock Position:  -0.09684036207835653
Bond Position:  [0.13503201]


portfolio before change:  [-9.63646905]
curr_Stock_Price:  100.90327304490779
curr_Factors:  [100.90327304]
mat_Sqrt:  [[0.15]]
grads:  [0.0899644]
Stock Position:  0.08996440221759013
Bond Position:  [-18.71417169]


portfolio before change:  [-9.6934137]
curr_Stock_Price:  100.2833058607516
curr_Factors:  [100.28330586]
mat_Sqrt:  [[0.15]]
grads:  [0.05753155]
Stock Position:  0.05753155104419587
Bond Position:  [-15.46286783]


portfolio before change:  [-9.67144077]
curr_Stock_Price:  100.68203289137091
curr_Factors:  [100.68203289]
mat_Sqrt:  [[0.15]]
grads:  [0.05884705]
Stock Position:  0.05884705422081656
Bond Position:  [-15.59628182]


portfolio before change:  [-9.67498778]
curr_Stock_Price:  100.63832284738146
curr_Factors:  [100.63832285]
mat_Sqrt:  [[0.15]]
grads:  [-0.08477096]
Stock Position:  -0.08477096057430264
Bond Position:  [-1.14378048]


portfolio before change:  [-9.64304001]
curr_Stock_Price:  100.26060792469221
curr_Factors:  [100.26060792]
mat_Sqrt:  [[0.15]]
grads:  [-0.08363032]
Stock Position:  -0.08363032306465927
Bond Position:  [-1.25821298]


portfolio before change:  [-9.64892995]
curr_Stock_Price:  100.33009588083031
curr_Factors:  [100.33009588]
mat_Sqrt:  [[0.15]]
grads:  [-0.0146821]
Stock Position:  -0.014682104085973226
Bond Position:  [-8.17587304]


portfolio before change:  [-9.64757071]
curr_Stock_Price:  100.20271321935923
curr_Factors:  [100.20271322]
mat_Sqrt:  [[0.15]]
grads:  [-0.11686451]
Stock Position:  -0.11686451189412408
Bond Position:  [2.06257046]


portfolio before change:  [-9.66048347]
curr_Stock_Price:  100.31430972452948
curr_Factors:  [100.31430972]
mat_Sqrt:  [[0.15]]
grads:  [0.28159357]
Stock Position:  0.2815935676180366
Bond Position:  [-37.90834783]


portfolio before change:  [-9.85951295]
curr_Stock_Price:  99.61592680601764
curr_Factors:  [99.61592681]
mat_Sqrt:  [[0.15]]
grads:  [0.10103973]
Stock Position:  0.10103972619231312
Bond Position:  [-19.92467892]


portfolio before change:  [-9.90475485]
curr_Stock_Price:  99.18048851137036
curr_Factors:  [99.18048851]
mat_Sqrt:  [[0.15]]
grads:  [0.01334016]
Stock Position:  0.013340157508020936
Bond Position:  [-11.22783819]


portfolio before change:  [-9.91453875]
curr_Stock_Price:  98.49967618650221
curr_Factors:  [98.49967619]
mat_Sqrt:  [[0.15]]
grads:  [0.05802053]
Stock Position:  0.058020534478232015
Bond Position:  [-15.62954261]


portfolio before change:  [-9.93995589]
curr_Stock_Price:  98.0784415650422
curr_Factors:  [98.07844157]
mat_Sqrt:  [[0.15]]
grads:  [-0.11453582]
Stock Position:  -0.11453582035818866
Bond Position:  [1.29353888]


portfolio before change:  [-9.93836221]
curr_Stock_Price:  98.06523318847341
curr_Factors:  [98.06523319]
mat_Sqrt:  [[0.15]]
grads:  [-0.00098511]
Stock Position:  -0.0009851118220982411
Bond Position:  [-9.84175699]


portfolio before change:  [-9.93921909]
curr_Stock_Price:  98.31063980535764
curr_Factors:  [98.31063981]
mat_Sqrt:  [[0.15]]
grads:  [0.00930773]
Stock Position:  0.00930773325723724
Bond Position:  [-10.8542683]


portfolio before change:  [-9.93786117]
curr_Stock_Price:  98.52941864325035
curr_Factors:  [98.52941864]
mat_Sqrt:  [[0.15]]
grads:  [0.00917818]
Stock Position:  0.009178182839214925
Bond Position:  [-10.84218219]


portfolio before change:  [-9.93615522]
curr_Stock_Price:  98.78912143502306
curr_Factors:  [98.78912144]
mat_Sqrt:  [[0.15]]
grads:  [0.05818101]
Stock Position:  0.05818100582573059
Bond Position:  [-15.68380567]


portfolio before change:  [-9.97555814]
curr_Stock_Price:  98.1287229073332
curr_Factors:  [98.12872291]
mat_Sqrt:  [[0.15]]
grads:  [0.02689347]
Stock Position:  0.026893468247303667
Bond Position:  [-12.61457984]


portfolio before change:  [-9.98926251]
curr_Stock_Price:  97.64846033454512
curr_Factors:  [97.64846033]
mat_Sqrt:  [[0.15]]
grads:  [0.00844401]
Stock Position:  0.008444014329585645
Bond Position:  [-10.8138075]


portfolio before change:  [-9.98924602]
curr_Stock_Price:  97.73045603324441
curr_Factors:  [97.73045603]
mat_Sqrt:  [[0.15]]
grads:  [-0.00382608]
Stock Position:  -0.0038260766013398693
Bond Position:  [-9.61532181]


portfolio before change:  [-9.99121855]
curr_Stock_Price:  98.0889319317112
curr_Factors:  [98.08893193]
mat_Sqrt:  [[0.15]]
grads:  [-0.069576]
Stock Position:  -0.06957600279213282
Bond Position:  [-3.16658275]


portfolio before change:  [-9.95605759]
curr_Stock_Price:  97.58072688654204
curr_Factors:  [97.58072689]
mat_Sqrt:  [[0.15]]
grads:  [-0.13054383]
Stock Position:  -0.13054382843531193
Bond Position:  [2.78250408]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.95605759]
Stock Price:  97.39454293053967
PL:  [-9.95605759]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.60366449e-02]
 [ 1.74446550e-03]
 [ 8.04749289e-04]
 [ 2.15271767e-03]
 [ 2.14045629e-02]
 [ 1.11900488e-02]
 [ 6.71188387e-04]
 [ 1.00208111e-02]
 [ 1.54907301e-02]
 [-1.85107731e-02]
 [ 1.02022528e-02]
 [-4.91623125e-03]
 [-9.61803541e-03]
 [ 4.33007827e-03]
 [ 6.59877703e-03]
 [-1.01318063e-02]
 [ 1.34221606e-02]
 [ 1.56670744e-02]
 [ 2.19707223e-02]
 [ 1.82439758e-03]
 [ 7.12635475e-02]
 [-1.30150208e-02]
 [ 8.55777232e-03]
 [-2.78672560e-03]
 [ 1.63952256e-02]
 [ 4.85875964e-03]
 [ 1.23939560e-02]
 [-4.30375972e-04]
 [ 5.55315984e-03]
 [-2.03104532e-02]
 [-5.49120739e-03]
 [ 1.36683614e-02]
 [ 1.47853967e-02]
 [ 1.93385161e-02]
 [-7.89501297e-03]
 [ 3.91307677e-03]
 [-2.36741105e-03]
 [ 1.13209280e-02]
 [ 1.18939963e-03]
 [-1.37192345e-02]
 [ 6.59663935e-03]
 [-1.93568869e-03]
 [ 4.09778806e-03]
 [-8.10269423e-03]
 [ 2.04291686e-03]
 [-3.05232377e-03]
 [-1.37035869e-02]
 [-1.35525212e-03]
 [-1.01649698e-02]
 [ 1.01336233e-02]
 [-3.12531828e-03]
 [ 3.28116295e-03]
 [ 2.85155463e-03]
 [ 6.23190921e-04]
 [ 1.41930393e-03]
 [ 9.05280369e-03]
 [ 1.44316135e-02]
 [-1.46800852e-02]
 [ 1.38703039e-02]
 [ 3.66478142e-03]
 [ 5.32058386e-03]
 [-1.24219732e-02]
 [-1.25406512e-02]
 [-1.54923737e-03]
 [-1.34772357e-02]
 [ 2.19924282e-02]
 [ 1.24613215e-02]
 [ 2.00219602e-03]
 [ 8.17630469e-03]
 [-1.71680399e-02]
 [-3.84650604e-03]
 [ 5.47698087e-04]
 [ 1.14599719e-04]
 [ 8.04044399e-03]
 [-1.71218086e-03]
 [ 2.88497162e-03]
 [ 1.14052888e-02]
 [-1.42775492e-02]
 [-4.87389737e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.03724338]
curr_Stock_Price:  100.06239369591027
curr_Factors:  [100.0623937]
mat_Sqrt:  [[0.15]]
grads:  [-0.2402443]
Stock Position:  -0.24024429961974228
Bond Position:  [27.07666307]


portfolio before change:  [3.17321882]
curr_Stock_Price:  99.50344975122678
curr_Factors:  [99.50344975]
mat_Sqrt:  [[0.15]]
grads:  [0.01162977]
Stock Position:  0.01162976999792656
Bond Position:  [2.01601659]


portfolio before change:  [3.17761001]
curr_Stock_Price:  99.8701963501637
curr_Factors:  [99.87019635]
mat_Sqrt:  [[0.15]]
grads:  [0.005365]
Stock Position:  0.005364995262878188
Bond Position:  [2.64180688]


portfolio before change:  [3.17804188]
curr_Stock_Price:  99.9199188123465
curr_Factors:  [99.91991881]
mat_Sqrt:  [[0.15]]
grads:  [0.01435145]
Stock Position:  0.014351451126865325
Bond Position:  [1.74404605]


portfolio before change:  [3.17791631]
curr_Stock_Price:  99.9035733129843
curr_Factors:  [99.90357331]
mat_Sqrt:  [[0.15]]
grads:  [0.14269709]
Stock Position:  0.14269708572145184
Bond Position:  [-11.07803246]


portfolio before change:  [3.13378035]
curr_Stock_Price:  99.59912731203069
curr_Factors:  [99.59912731]
mat_Sqrt:  [[0.15]]
grads:  [0.07460033]
Stock Position:  0.0746003251873649
Bond Position:  [-4.29634693]


portfolio before change:  [3.12319008]
curr_Stock_Price:  99.46076679142104
curr_Factors:  [99.46076679]
mat_Sqrt:  [[0.15]]
grads:  [0.00447459]
Stock Position:  0.004474589245845279
Bond Position:  [2.67814401]


portfolio before change:  [3.12554138]
curr_Stock_Price:  99.94883521422322
curr_Factors:  [99.94883521]
mat_Sqrt:  [[0.15]]
grads:  [0.06680541]
Stock Position:  0.06680540745427432
Bond Position:  [-3.55158128]


portfolio before change:  [3.11551332]
curr_Stock_Price:  99.80204948299382
curr_Factors:  [99.80204948]
mat_Sqrt:  [[0.15]]
grads:  [0.10327153]
Stock Position:  0.10327153429964733
Bond Position:  [-7.19119746]


portfolio before change:  [3.12948266]
curr_Stock_Price:  99.94166982765302
curr_Factors:  [99.94166983]
mat_Sqrt:  [[0.15]]
grads:  [-0.12340515]
Stock Position:  -0.12340515395938541
Bond Position:  [15.46279981]


portfolio before change:  [3.07267349]
curr_Stock_Price:  100.40984823826855
curr_Factors:  [100.40984824]
mat_Sqrt:  [[0.15]]
grads:  [0.06801502]
Stock Position:  0.06801501847287617
Bond Position:  [-3.7567042]


portfolio before change:  [3.04791027]
curr_Stock_Price:  100.04921590033037
curr_Factors:  [100.0492159]
mat_Sqrt:  [[0.15]]
grads:  [-0.03277488]
Stock Position:  -0.0327748750060789
Bond Position:  [6.32701082]


portfolio before change:  [3.05404028]
curr_Stock_Price:  99.87424789398771
curr_Factors:  [99.87424789]
mat_Sqrt:  [[0.15]]
grads:  [-0.06412024]
Stock Position:  -0.0641202360599437
Bond Position:  [9.45800063]


portfolio before change:  [3.0414593]
curr_Stock_Price:  100.07967637723269
curr_Factors:  [100.07967638]
mat_Sqrt:  [[0.15]]
grads:  [0.02886719]
Stock Position:  0.028867188442007075
Bond Position:  [0.15244042]


portfolio before change:  [3.04931991]
curr_Stock_Price:  100.3516490485556
curr_Factors:  [100.35164905]
mat_Sqrt:  [[0.15]]
grads:  [0.04399185]
Stock Position:  0.043991846841452784
Bond Position:  [-1.36533447]


portfolio before change:  [3.09748282]
curr_Stock_Price:  101.44840333007994
curr_Factors:  [101.44840333]
mat_Sqrt:  [[0.15]]
grads:  [-0.06754538]
Stock Position:  -0.06754537529569621
Bond Position:  [9.9498533]


portfolio before change:  [3.16216897]
curr_Stock_Price:  100.4999407056081
curr_Factors:  [100.49994071]
mat_Sqrt:  [[0.15]]
grads:  [0.08948107]
Stock Position:  0.0894810704038277
Bond Position:  [-5.8306733]


portfolio before change:  [3.18549209]
curr_Stock_Price:  100.76466206907237
curr_Factors:  [100.76466207]
mat_Sqrt:  [[0.15]]
grads:  [0.10444716]
Stock Position:  0.10444716283722733
Bond Position:  [-7.33909098]


portfolio before change:  [3.17200143]
curr_Stock_Price:  100.63989126326184
curr_Factors:  [100.63989126]
mat_Sqrt:  [[0.15]]
grads:  [0.14647148]
Stock Position:  0.1464714818762774
Bond Position:  [-11.56887258]


portfolio before change:  [3.19508023]
curr_Stock_Price:  100.80239308115931
curr_Factors:  [100.80239308]
mat_Sqrt:  [[0.15]]
grads:  [0.01216265]
Stock Position:  0.012162650540025981
Bond Position:  [1.96905595]


portfolio before change:  [3.19909521]
curr_Stock_Price:  101.1223815385201
curr_Factors:  [101.12238154]
mat_Sqrt:  [[0.15]]
grads:  [0.47509032]
Stock Position:  0.47509031682371444
Bond Position:  [-44.84316907]


portfolio before change:  [3.39162647]
curr_Stock_Price:  101.53353293034955
curr_Factors:  [101.53353293]
mat_Sqrt:  [[0.15]]
grads:  [-0.08676681]
Stock Position:  -0.08676680522773617
Bond Position:  [12.20136675]


portfolio before change:  [3.35919893]
curr_Stock_Price:  101.916054196471
curr_Factors:  [101.9160542]
mat_Sqrt:  [[0.15]]
grads:  [0.05705182]
Stock Position:  0.057051815440367616
Bond Position:  [-2.45529698]


portfolio before change:  [3.34276131]
curr_Stock_Price:  101.63062667307304
curr_Factors:  [101.63062667]
mat_Sqrt:  [[0.15]]
grads:  [-0.01857817]
Stock Position:  -0.01857817064078886
Bond Position:  [5.23087244]


portfolio before change:  [3.34405638]
curr_Stock_Price:  101.57851536667526
curr_Factors:  [101.57851537]
mat_Sqrt:  [[0.15]]
grads:  [0.1093015]
Stock Position:  0.10930150430299836
Bond Position:  [-7.75862815]


portfolio before change:  [3.2985998]
curr_Stock_Price:  101.16706943912912
curr_Factors:  [101.16706944]
mat_Sqrt:  [[0.15]]
grads:  [0.03239173]
Stock Position:  0.032391730929308624
Bond Position:  [0.0216233]


portfolio before change:  [3.29603383]
curr_Stock_Price:  101.08781114303412
curr_Factors:  [101.08781114]
mat_Sqrt:  [[0.15]]
grads:  [0.08262637]
Stock Position:  0.08262637332884515
Bond Position:  [-5.05648539]


portfolio before change:  [3.30958106]
curr_Stock_Price:  101.25559376997943
curr_Factors:  [101.25559377]
mat_Sqrt:  [[0.15]]
grads:  [-0.00286917]
Stock Position:  -0.002869173149389753
Bond Position:  [3.60010089]


portfolio before change:  [3.30705952]
curr_Stock_Price:  102.21285667157572
curr_Factors:  [102.21285667]
mat_Sqrt:  [[0.15]]
grads:  [0.03702107]
Stock Position:  0.03702106563146161
Bond Position:  [-0.47696935]


portfolio before change:  [3.29673591]
curr_Stock_Price:  101.9348040108785
curr_Factors:  [101.93480401]
mat_Sqrt:  [[0.15]]
grads:  [-0.13540302]
Stock Position:  -0.1354030214278304
Bond Position:  [17.09901636]


portfolio before change:  [3.32591983]
curr_Stock_Price:  101.72716315773667
curr_Factors:  [101.72716316]
mat_Sqrt:  [[0.15]]
grads:  [-0.03660805]
Stock Position:  -0.036608049244631236
Bond Position:  [7.04995283]


portfolio before change:  [3.35735911]
curr_Stock_Price:  100.88039186415118
curr_Factors:  [100.88039186]
mat_Sqrt:  [[0.15]]
grads:  [0.09112241]
Stock Position:  0.09112240920445885
Bond Position:  [-5.83510524]


portfolio before change:  [3.26508762]
curr_Stock_Price:  99.87178393716029
curr_Factors:  [99.87178394]
mat_Sqrt:  [[0.15]]
grads:  [0.09856931]
Stock Position:  0.09856931102206394
Bond Position:  [-6.57920531]


portfolio before change:  [3.22682538]
curr_Stock_Price:  99.48777980353857
curr_Factors:  [99.4877798]
mat_Sqrt:  [[0.15]]
grads:  [0.12892344]
Stock Position:  0.12892344049614235
Bond Position:  [-9.59948148]


portfolio before change:  [3.20488804]
curr_Stock_Price:  99.32227572911056
curr_Factors:  [99.32227573]
mat_Sqrt:  [[0.15]]
grads:  [-0.05263342]
Stock Position:  -0.05263341980433286
Bond Position:  [8.43255908]


portfolio before change:  [3.20334506]
curr_Stock_Price:  99.3616050346006
curr_Factors:  [99.36160503]
mat_Sqrt:  [[0.15]]
grads:  [0.02608718]
Stock Position:  0.026087178470884514
Bond Position:  [0.61128113]


portfolio before change:  [3.18413071]
curr_Stock_Price:  98.62359689742475
curr_Factors:  [98.6235969]
mat_Sqrt:  [[0.15]]
grads:  [-0.01578274]
Stock Position:  -0.015782740360314712
Bond Position:  [4.74068134]


portfolio before change:  [3.17631252]
curr_Stock_Price:  99.13773403466831
curr_Factors:  [99.13773403]
mat_Sqrt:  [[0.15]]
grads:  [0.07547285]
Stock Position:  0.07547285347571854
Bond Position:  [-4.30589515]


portfolio before change:  [3.1789283]
curr_Stock_Price:  99.17595848985235
curr_Factors:  [99.17595849]
mat_Sqrt:  [[0.15]]
grads:  [0.00792933]
Stock Position:  0.007929330837165328
Bond Position:  [2.39252932]


portfolio before change:  [3.17847072]
curr_Stock_Price:  99.09939243932327
curr_Factors:  [99.09939244]
mat_Sqrt:  [[0.15]]
grads:  [-0.09146156]
Stock Position:  -0.09146156315279033
Bond Position:  [12.24225606]


portfolio before change:  [3.18867362]
curr_Stock_Price:  98.99620449934835
curr_Factors:  [98.9962045]
mat_Sqrt:  [[0.15]]
grads:  [0.0439776]
Stock Position:  0.04397759565803341
Bond Position:  [-1.16494143]


portfolio before change:  [3.18204797]
curr_Stock_Price:  98.84720037313103
curr_Factors:  [98.84720037]
mat_Sqrt:  [[0.15]]
grads:  [-0.01290459]
Stock Position:  -0.012904591279493014
Bond Position:  [4.45763069]


portfolio before change:  [3.17868013]
curr_Stock_Price:  99.12977014000889
curr_Factors:  [99.12977014]
mat_Sqrt:  [[0.15]]
grads:  [0.02731859]
Stock Position:  0.02731858709736066
Bond Position:  [0.47059487]


portfolio before change:  [3.15250758]
curr_Stock_Price:  98.17064450710872
curr_Factors:  [98.17064451]
mat_Sqrt:  [[0.15]]
grads:  [-0.05401796]
Stock Position:  -0.05401796156288524
Bond Position:  [8.45548569]


portfolio before change:  [3.12879976]
curr_Stock_Price:  98.61931572480239
curr_Factors:  [98.61931572]
mat_Sqrt:  [[0.15]]
grads:  [0.01361945]
Stock Position:  0.013619445743942776
Bond Position:  [1.78565934]


portfolio before change:  [3.13529714]
curr_Stock_Price:  99.08818687974669
curr_Factors:  [99.08818688]
mat_Sqrt:  [[0.15]]
grads:  [-0.02034883]
Stock Position:  -0.02034882514725516
Bond Position:  [5.15162533]


portfolio before change:  [3.13645519]
curr_Stock_Price:  99.04710001712432
curr_Factors:  [99.04710002]
mat_Sqrt:  [[0.15]]
grads:  [-0.09135725]
Stock Position:  -0.09135724582024712
Bond Position:  [12.18512546]


portfolio before change:  [3.17952555]
curr_Stock_Price:  98.5839866252516
curr_Factors:  [98.58398663]
mat_Sqrt:  [[0.15]]
grads:  [-0.00903501]
Stock Position:  -0.009035014130763349
Bond Position:  [4.07023326]


portfolio before change:  [3.17167522]
curr_Stock_Price:  99.48102223241786
curr_Factors:  [99.48102223]
mat_Sqrt:  [[0.15]]
grads:  [-0.06776647]
Stock Position:  -0.06776646551226823
Bond Position:  [9.91315248]


portfolio before change:  [3.20530422]
curr_Stock_Price:  98.99391687870136
curr_Factors:  [98.99391688]
mat_Sqrt:  [[0.15]]
grads:  [0.06755749]
Stock Position:  0.06755748852706847
Bond Position:  [-3.48247618]


portfolio before change:  [3.20067444]
curr_Stock_Price:  98.92860776143927
curr_Factors:  [98.92860776]
mat_Sqrt:  [[0.15]]
grads:  [-0.02083546]
Stock Position:  -0.02083545519847473
Bond Position:  [5.26189701]


portfolio before change:  [3.20523583]
curr_Stock_Price:  98.7254677393344
curr_Factors:  [98.72546774]
mat_Sqrt:  [[0.15]]
grads:  [0.02187442]
Stock Position:  0.02187441964873444
Bond Position:  [1.04567352]


portfolio before change:  [3.20181654]
curr_Stock_Price:  98.56616523602142
curr_Factors:  [98.56616524]
mat_Sqrt:  [[0.15]]
grads:  [0.01901036]
Stock Position:  0.01901036417207246
Bond Position:  [1.32803784]


portfolio before change:  [3.20509298]
curr_Stock_Price:  98.73414911904602
curr_Factors:  [98.73414912]
mat_Sqrt:  [[0.15]]
grads:  [0.00415461]
Stock Position:  0.0041546061429079
Bond Position:  [2.79489148]


portfolio before change:  [3.20650876]
curr_Stock_Price:  99.0328779183146
curr_Factors:  [99.03287792]
mat_Sqrt:  [[0.15]]
grads:  [0.00946203]
Stock Position:  0.009462026175130363
Bond Position:  [2.26945708]


portfolio before change:  [3.20753035]
curr_Stock_Price:  99.12585369551188
curr_Factors:  [99.1258537]
mat_Sqrt:  [[0.15]]
grads:  [0.06035202]
Stock Position:  0.060352024632822195
Bond Position:  [-2.77491562]


portfolio before change:  [3.15533236]
curr_Stock_Price:  98.26383542582961
curr_Factors:  [98.26383543]
mat_Sqrt:  [[0.15]]
grads:  [0.09621076]
Stock Position:  0.09621075652665802
Bond Position:  [-6.29870558]


portfolio before change:  [3.16844443]
curr_Stock_Price:  98.4042120796776
curr_Factors:  [98.40421208]
mat_Sqrt:  [[0.15]]
grads:  [-0.09786723]
Stock Position:  -0.09786723456247708
Bond Position:  [12.79899253]


portfolio before change:  [3.14248882]
curr_Stock_Price:  98.67759844501711
curr_Factors:  [98.67759845]
mat_Sqrt:  [[0.15]]
grads:  [0.09246869]
Stock Position:  0.09246869263849487
Bond Position:  [-5.9820997]


portfolio before change:  [3.14645221]
curr_Stock_Price:  98.72450390363242
curr_Factors:  [98.7245039]
mat_Sqrt:  [[0.15]]
grads:  [0.02443188]
Stock Position:  0.024431876148194406
Bond Position:  [0.73442736]


portfolio before change:  [3.15940325]
curr_Stock_Price:  99.25271269016795
curr_Factors:  [99.25271269]
mat_Sqrt:  [[0.15]]
grads:  [0.03547056]
Stock Position:  0.03547055905180972
Bond Position:  [-0.36114596]


portfolio before change:  [3.178819]
curr_Stock_Price:  99.80072566415106
curr_Factors:  [99.80072566]
mat_Sqrt:  [[0.15]]
grads:  [-0.08281315]
Stock Position:  -0.08281315465684976
Bond Position:  [11.44363193]


portfolio before change:  [3.16974201]
curr_Stock_Price:  99.91897067591697
curr_Factors:  [99.91897068]
mat_Sqrt:  [[0.15]]
grads:  [-0.08360434]
Stock Position:  -0.08360434162212788
Bond Position:  [11.52340177]


portfolio before change:  [3.25029818]
curr_Stock_Price:  98.96404491900755
curr_Factors:  [98.96404492]
mat_Sqrt:  [[0.15]]
grads:  [-0.01032825]
Stock Position:  -0.010328249161977481
Bond Position:  [4.2724235]


portfolio before change:  [3.24219815]
curr_Stock_Price:  99.77415956547564
curr_Factors:  [99.77415957]
mat_Sqrt:  [[0.15]]
grads:  [-0.08984824]
Stock Position:  -0.08984823778966484
Bond Position:  [12.20673057]


portfolio before change:  [3.2779167]
curr_Stock_Price:  99.38510790609105
curr_Factors:  [99.38510791]
mat_Sqrt:  [[0.15]]
grads:  [0.14661619]
Stock Position:  0.1466161880028377
Bond Position:  [-11.29354896]


portfolio before change:  [3.20664551]
curr_Stock_Price:  98.90381502246164
curr_Factors:  [98.90381502]
mat_Sqrt:  [[0.15]]
grads:  [0.08307548]
Stock Position:  0.08307547670813073
Bond Position:  [-5.00983607]


portfolio before change:  [3.20080719]
curr_Stock_Price:  98.83730690481356
curr_Factors:  [98.8373069]
mat_Sqrt:  [[0.15]]
grads:  [0.01334797]
Stock Position:  0.01334797347233334
Bond Position:  [1.88152944]


portfolio before change:  [3.19963161]
curr_Stock_Price:  98.74042473063872
curr_Factors:  [98.74042473]
mat_Sqrt:  [[0.15]]
grads:  [0.0545087]
Stock Position:  0.0545086979179633
Bond Position:  [-2.18258038]


portfolio before change:  [3.16469759]
curr_Stock_Price:  98.10203847923049
curr_Factors:  [98.10203848]
mat_Sqrt:  [[0.15]]
grads:  [-0.1144536]
Stock Position:  -0.11445359916668656
Bond Position:  [14.39282898]


portfolio before change:  [3.08870214]
curr_Stock_Price:  98.77388303231065
curr_Factors:  [98.77388303]
mat_Sqrt:  [[0.15]]
grads:  [-0.02564337]
Stock Position:  -0.02564337362608947
Bond Position:  [5.62159773]


portfolio before change:  [3.0944187]
curr_Stock_Price:  98.56465953400942
curr_Factors:  [98.56465953]
mat_Sqrt:  [[0.15]]
grads:  [0.00365132]
Stock Position:  0.003651320581400854
Bond Position:  [2.73452753]


portfolio before change:  [3.09166462]
curr_Stock_Price:  97.76358128210853
curr_Factors:  [97.76358128]
mat_Sqrt:  [[0.15]]
grads:  [0.000764]
Stock Position:  0.0007639981289916031
Bond Position:  [3.01697343]


portfolio before change:  [3.09131146]
curr_Stock_Price:  97.05451622129098
curr_Factors:  [97.05451622]
mat_Sqrt:  [[0.15]]
grads:  [0.05360296]
Stock Position:  0.05360295990340258
Bond Position:  [-2.11109788]


portfolio before change:  [3.07021219]
curr_Stock_Price:  96.66335640905034
curr_Factors:  [96.66335641]
mat_Sqrt:  [[0.15]]
grads:  [-0.01141454]
Stock Position:  -0.01141453904994395
Bond Position:  [4.17357985]


portfolio before change:  [3.07503988]
curr_Stock_Price:  96.26326745721452
curr_Factors:  [96.26326746]
mat_Sqrt:  [[0.15]]
grads:  [0.01923314]
Stock Position:  0.019233144155636258
Bond Position:  [1.22359458]


portfolio before change:  [3.05791573]
curr_Stock_Price:  95.36894549149144
curr_Factors:  [95.36894549]
mat_Sqrt:  [[0.15]]
grads:  [0.07603526]
Stock Position:  0.07603525853835977
Bond Position:  [-4.1934867]


portfolio before change:  [2.99551329]
curr_Stock_Price:  94.55168852868185
curr_Factors:  [94.55168853]
mat_Sqrt:  [[0.15]]
grads:  [-0.09518366]
Stock Position:  -0.09518366125116712
Bond Position:  [11.99528918]


portfolio before change:  [2.96665403]
curr_Stock_Price:  94.86276062372482
curr_Factors:  [94.86276062]
mat_Sqrt:  [[0.15]]
grads:  [-0.32492649]
Stock Position:  -0.3249264914082921
Bond Position:  [33.79007801]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.96665403]
Stock Price:  94.64402377040949
PL:  [2.96665403]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-6.55076695e-03]
 [ 5.58095777e-03]
 [ 1.72887283e-03]
 [-3.16680380e-03]
 [-1.09351588e-02]
 [ 4.46908782e-03]
 [ 1.37881558e-03]
 [ 8.97758529e-03]
 [ 1.51999336e-02]
 [-1.97223951e-02]
 [ 7.20364412e-03]
 [-5.62495118e-03]
 [-6.32667393e-03]
 [ 4.21677644e-03]
 [ 1.11903108e-03]
 [ 1.31986176e-02]
 [ 8.60659814e-04]
 [ 1.16152108e-02]
 [ 2.05261274e-02]
 [ 7.94385274e-04]
 [ 6.67133628e-02]
 [-1.29438382e-02]
 [ 7.04956738e-03]
 [-4.28075618e-03]
 [ 1.73402536e-02]
 [ 1.82891130e-02]
 [ 1.12303779e-02]
 [ 6.58948535e-03]
 [ 5.29260668e-03]
 [-2.79295314e-02]
 [-5.22792297e-03]
 [ 9.29584369e-03]
 [ 9.56181787e-03]
 [ 7.01726077e-03]
 [-2.46444238e-03]
 [-4.52626571e-03]
 [-7.07947424e-03]
 [ 1.26128481e-02]
 [ 6.18983726e-04]
 [-8.71282477e-03]
 [-2.99951953e-02]
 [-2.46453399e-03]
 [ 1.21642970e-02]
 [-1.17912707e-02]
 [-7.44665130e-04]
 [ 2.47106602e-03]
 [-1.35937954e-02]
 [ 1.21731619e-02]
 [ 1.73943315e-02]
 [-1.06532299e-02]
 [-3.61193999e-03]
 [ 3.45902699e-03]
 [ 2.18269456e-03]
 [ 3.91956737e-05]
 [-8.43891725e-03]
 [ 1.20061431e-02]
 [-3.21670604e-02]
 [-1.01162868e-02]
 [ 2.12241795e-02]
 [-8.31037667e-03]
 [ 1.31585631e-02]
 [-1.38992294e-02]
 [-1.27120904e-02]
 [-2.99466927e-03]
 [ 7.46725703e-02]
 [-1.55750741e-02]
 [ 1.51830991e-02]
 [ 5.12902322e-03]
 [ 1.30569031e-02]
 [-2.70126056e-02]
 [-7.79936462e-03]
 [-5.42059356e-03]
 [ 1.39978983e-02]
 [ 4.96685962e-03]
 [-1.62572061e-03]
 [ 3.33624997e-03]
 [ 6.61032381e-03]
 [-2.87743421e-03]
 [ 2.24719376e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.26309492]
curr_Stock_Price:  98.82194822261228
curr_Factors:  [98.82194822]
mat_Sqrt:  [[0.15]]
grads:  [-0.04367178]
Stock Position:  -0.04367177968345627
Bond Position:  [-11.94736457]


portfolio before change:  [-16.27421362]
curr_Stock_Price:  99.05944621753581
curr_Factors:  [99.05944622]
mat_Sqrt:  [[0.15]]
grads:  [0.03720639]
Stock Position:  0.037206385107919376
Bond Position:  [-19.95985752]


portfolio before change:  [-16.30456334]
curr_Stock_Price:  98.2772633052911
curr_Factors:  [98.27726331]
mat_Sqrt:  [[0.15]]
grads:  [0.01152582]
Stock Position:  0.011525818894214408
Bond Position:  [-17.43728928]


portfolio before change:  [-16.31050849]
curr_Stock_Price:  97.85601057021279
curr_Factors:  [97.85601057]
mat_Sqrt:  [[0.15]]
grads:  [-0.02111203]
Stock Position:  -0.021112025324678006
Bond Position:  [-14.24456992]


portfolio before change:  [-16.33592455]
curr_Stock_Price:  99.0177062533794
curr_Factors:  [99.01770625]
mat_Sqrt:  [[0.15]]
grads:  [-0.07290106]
Stock Position:  -0.0729010586408744
Bond Position:  [-9.11742894]


portfolio before change:  [-16.28780811]
curr_Stock_Price:  98.34986552146384
curr_Factors:  [98.34986552]
mat_Sqrt:  [[0.15]]
grads:  [0.02979392]
Stock Position:  0.029793918810878974
Bond Position:  [-19.21803602]


portfolio before change:  [-16.29866331]
curr_Stock_Price:  98.02583849513339
curr_Factors:  [98.0258385]
mat_Sqrt:  [[0.15]]
grads:  [0.0091921]
Stock Position:  0.009192103890017256
Bond Position:  [-17.19972701]


portfolio before change:  [-16.29522881]
curr_Stock_Price:  98.51642521327591
curr_Factors:  [98.51642521]
mat_Sqrt:  [[0.15]]
grads:  [0.05985057]
Stock Position:  0.05985056860110081
Bond Position:  [-22.19149287]


portfolio before change:  [-16.27726801]
curr_Stock_Price:  98.83969384607555
curr_Factors:  [98.83969385]
mat_Sqrt:  [[0.15]]
grads:  [0.10133289]
Stock Position:  0.10133289036935277
Bond Position:  [-26.29297987]


portfolio before change:  [-16.23969188]
curr_Stock_Price:  99.22672997283549
curr_Factors:  [99.22672997]
mat_Sqrt:  [[0.15]]
grads:  [-0.13148263]
Stock Position:  -0.13148263432157878
Bond Position:  [-3.19310003]


portfolio before change:  [-16.29154475]
curr_Stock_Price:  99.61958258028979
curr_Factors:  [99.61958258]
mat_Sqrt:  [[0.15]]
grads:  [0.04802429]
Stock Position:  0.048024294143487446
Bond Position:  [-21.07570489]


portfolio before change:  [-16.30323413]
curr_Stock_Price:  99.40360629339428
curr_Factors:  [99.40360629]
mat_Sqrt:  [[0.15]]
grads:  [-0.03749967]
Stock Position:  -0.03749967456459579
Bond Position:  [-12.57563125]


portfolio before change:  [-16.29550816]
curr_Stock_Price:  99.17661823118563
curr_Factors:  [99.17661823]
mat_Sqrt:  [[0.15]]
grads:  [-0.04217783]
Stock Position:  -0.04217782621328048
Bond Position:  [-12.11245399]


portfolio before change:  [-16.31035436]
curr_Stock_Price:  99.51065999589318
curr_Factors:  [99.51066]
mat_Sqrt:  [[0.15]]
grads:  [0.02811184]
Stock Position:  0.028111842917332576
Bond Position:  [-19.10778241]


portfolio before change:  [-16.31240391]
curr_Stock_Price:  99.4802361848431
curr_Factors:  [99.48023618]
mat_Sqrt:  [[0.15]]
grads:  [0.00746021]
Stock Position:  0.007460207182736339
Bond Position:  [-17.05454708]


portfolio before change:  [-16.31675072]
curr_Stock_Price:  99.04045339478823
curr_Factors:  [99.04045339]
mat_Sqrt:  [[0.15]]
grads:  [0.08799078]
Stock Position:  0.08799078432884039
Bond Position:  [-25.03139789]


portfolio before change:  [-16.28820495]
curr_Stock_Price:  99.38265156705177
curr_Factors:  [99.38265157]
mat_Sqrt:  [[0.15]]
grads:  [0.00573773]
Stock Position:  0.005737732092478389
Bond Position:  [-16.85843597]


portfolio before change:  [-16.28417699]
curr_Stock_Price:  100.26830396846907
curr_Factors:  [100.26830397]
mat_Sqrt:  [[0.15]]
grads:  [0.07743474]
Stock Position:  0.0774347385410328
Bond Position:  [-24.0484269]


portfolio before change:  [-16.24169997]
curr_Stock_Price:  100.8362673395402
curr_Factors:  [100.83626734]
mat_Sqrt:  [[0.15]]
grads:  [0.13684085]
Stock Position:  0.1368408495330787
Bond Position:  [-30.04022046]


portfolio before change:  [-16.20453772]
curr_Stock_Price:  101.1215609790695
curr_Factors:  [101.12156098]
mat_Sqrt:  [[0.15]]
grads:  [0.0052959]
Stock Position:  0.00529590182920397
Bond Position:  [-16.74006758]


portfolio before change:  [-16.20432194]
curr_Stock_Price:  101.35987132236963
curr_Factors:  [101.35987132]
mat_Sqrt:  [[0.15]]
grads:  [0.44475575]
Stock Position:  0.4447557517921749
Bond Position:  [-61.28470771]


portfolio before change:  [-16.03875602]
curr_Stock_Price:  101.74074628693465
curr_Factors:  [101.74074629]
mat_Sqrt:  [[0.15]]
grads:  [-0.08629225]
Stock Position:  -0.08629225495612755
Bond Position:  [-7.2593176]


portfolio before change:  [-16.01502137]
curr_Stock_Price:  101.46043865382768
curr_Factors:  [101.46043865]
mat_Sqrt:  [[0.15]]
grads:  [0.04699712]
Stock Position:  0.04699711585955508
Bond Position:  [-20.78336936]


portfolio before change:  [-15.98562567]
curr_Stock_Price:  102.11355739825252
curr_Factors:  [102.1135574]
mat_Sqrt:  [[0.15]]
grads:  [-0.02853837]
Stock Position:  -0.02853837456514946
Bond Position:  [-13.07147072]


portfolio before change:  [-15.99407628]
curr_Stock_Price:  102.38104341973771
curr_Factors:  [102.38104342]
mat_Sqrt:  [[0.15]]
grads:  [0.11560169]
Stock Position:  0.11560169035086036
Bond Position:  [-27.82949796]


portfolio before change:  [-16.00044615]
curr_Stock_Price:  102.34098801904692
curr_Factors:  [102.34098802]
mat_Sqrt:  [[0.15]]
grads:  [0.12192742]
Stock Position:  0.12192742030029623
Bond Position:  [-28.47861881]


portfolio before change:  [-16.06373813]
curr_Stock_Price:  101.83649108408537
curr_Factors:  [101.83649108]
mat_Sqrt:  [[0.15]]
grads:  [0.07486919]
Stock Position:  0.074869186259048
Bond Position:  [-23.68815335]


portfolio before change:  [-16.06595866]
curr_Stock_Price:  101.82660754743874
curr_Factors:  [101.82660755]
mat_Sqrt:  [[0.15]]
grads:  [0.0439299]
Stock Position:  0.043929902335417666
Bond Position:  [-20.53919158]


portfolio before change:  [-16.05899799]
curr_Stock_Price:  102.01427950884774
curr_Factors:  [102.01427951]
mat_Sqrt:  [[0.15]]
grads:  [0.03528404]
Stock Position:  0.03528404455471568
Bond Position:  [-19.65847437]


portfolio before change:  [-16.09801276]
curr_Stock_Price:  100.9433682951283
curr_Factors:  [100.9433683]
mat_Sqrt:  [[0.15]]
grads:  [-0.18619688]
Stock Position:  -0.1861968758598432
Bond Position:  [2.69732706]


portfolio before change:  [-16.14984891]
curr_Stock_Price:  101.22266802549262
curr_Factors:  [101.22266803]
mat_Sqrt:  [[0.15]]
grads:  [-0.03485282]
Stock Position:  -0.0348528197911175
Bond Position:  [-12.6219535]


portfolio before change:  [-16.12433351]
curr_Stock_Price:  100.46794299863684
curr_Factors:  [100.467943]
mat_Sqrt:  [[0.15]]
grads:  [0.06197229]
Stock Position:  0.061972291243160726
Bond Position:  [-22.35056213]


portfolio before change:  [-16.0885472]
curr_Stock_Price:  101.06794114527662
curr_Factors:  [101.06794115]
mat_Sqrt:  [[0.15]]
grads:  [0.06374545]
Stock Position:  0.0637454524960606
Bond Position:  [-22.53116884]


portfolio before change:  [-16.0661215]
curr_Stock_Price:  101.44183361921642
curr_Factors:  [101.44183362]
mat_Sqrt:  [[0.15]]
grads:  [0.04678174]
Stock Position:  0.04678173849163691
Bond Position:  [-20.81174683]


portfolio before change:  [-16.05035056]
curr_Stock_Price:  101.8067562755569
curr_Factors:  [101.80675628]
mat_Sqrt:  [[0.15]]
grads:  [-0.01642962]
Stock Position:  -0.016429615856337107
Bond Position:  [-14.37770466]


portfolio before change:  [-16.04985521]
curr_Stock_Price:  101.72191054977584
curr_Factors:  [101.72191055]
mat_Sqrt:  [[0.15]]
grads:  [-0.0301751]
Stock Position:  -0.030175104760291057
Bond Position:  [-12.9803859]


portfolio before change:  [-16.05478601]
curr_Stock_Price:  101.8584305315655
curr_Factors:  [101.85843053]
mat_Sqrt:  [[0.15]]
grads:  [-0.04719649]
Stock Position:  -0.04719649493019855
Bond Position:  [-11.24742511]


portfolio before change:  [-16.01695467]
curr_Stock_Price:  101.04196466978395
curr_Factors:  [101.04196467]
mat_Sqrt:  [[0.15]]
grads:  [0.08408565]
Stock Position:  0.08408565416490452
Bond Position:  [-24.51313437]


portfolio before change:  [-15.97191762]
curr_Stock_Price:  101.59579482419792
curr_Factors:  [101.59579482]
mat_Sqrt:  [[0.15]]
grads:  [0.00412656]
Stock Position:  0.004126558175267236
Bond Position:  [-16.39115858]


portfolio before change:  [-15.97214428]
curr_Stock_Price:  101.78913165297088
curr_Factors:  [101.78913165]
mat_Sqrt:  [[0.15]]
grads:  [-0.0580855]
Stock Position:  -0.0580854984602611
Bond Position:  [-10.05967183]


portfolio before change:  [-16.01230747]
curr_Stock_Price:  102.4697565979089
curr_Factors:  [102.4697566]
mat_Sqrt:  [[0.15]]
grads:  [-0.19996797]
Stock Position:  -0.19996796896731173
Bond Position:  [4.47836164]


portfolio before change:  [-15.89292696]
curr_Stock_Price:  101.87415816930955
curr_Factors:  [101.87415817]
mat_Sqrt:  [[0.15]]
grads:  [-0.01643023]
Stock Position:  -0.016430226583174376
Bond Position:  [-14.21911146]


portfolio before change:  [-15.90594116]
curr_Stock_Price:  102.61215675676375
curr_Factors:  [102.61215676]
mat_Sqrt:  [[0.15]]
grads:  [0.08109531]
Stock Position:  0.0810953131092442
Bond Position:  [-24.22730615]


portfolio before change:  [-15.88752957]
curr_Stock_Price:  102.85786574887032
curr_Factors:  [102.85786575]
mat_Sqrt:  [[0.15]]
grads:  [-0.07860847]
Stock Position:  -0.07860847137827576
Bond Position:  [-7.80202997]


portfolio before change:  [-15.89281206]
curr_Stock_Price:  102.91886232607827
curr_Factors:  [102.91886233]
mat_Sqrt:  [[0.15]]
grads:  [-0.00496443]
Stock Position:  -0.004964434200674563
Bond Position:  [-15.38187814]


portfolio before change:  [-15.89609218]
curr_Stock_Price:  103.38592905407577
curr_Factors:  [103.38592905]
mat_Sqrt:  [[0.15]]
grads:  [0.01647377]
Stock Position:  0.016473773486203748
Bond Position:  [-17.59924856]


portfolio before change:  [-15.88177484]
curr_Stock_Price:  104.32179985978041
curr_Factors:  [104.32179986]
mat_Sqrt:  [[0.15]]
grads:  [-0.0906253]
Stock Position:  -0.09062530234201528
Bond Position:  [-6.42758019]


portfolio before change:  [-15.90526998]
curr_Stock_Price:  104.5766227343288
curr_Factors:  [104.57662273]
mat_Sqrt:  [[0.15]]
grads:  [0.08115441]
Stock Position:  0.08115441241650277
Bond Position:  [-24.39212435]


portfolio before change:  [-15.91463145]
curr_Stock_Price:  104.48005482265421
curr_Factors:  [104.48005482]
mat_Sqrt:  [[0.15]]
grads:  [0.11596221]
Stock Position:  0.11596220985242152
Bond Position:  [-28.03036949]


portfolio before change:  [-15.97579709]
curr_Stock_Price:  103.96770094994416
curr_Factors:  [103.96770095]
mat_Sqrt:  [[0.15]]
grads:  [-0.07102153]
Stock Position:  -0.07102153297536642
Bond Position:  [-8.59185159]


portfolio before change:  [-15.92602825]
curr_Stock_Price:  103.25938275205475
curr_Factors:  [103.25938275]
mat_Sqrt:  [[0.15]]
grads:  [-0.0240796]
Stock Position:  -0.02407959995182908
Bond Position:  [-13.43958362]


portfolio before change:  [-15.94582917]
curr_Stock_Price:  104.04680949412476
curr_Factors:  [104.04680949]
mat_Sqrt:  [[0.15]]
grads:  [0.02306018]
Stock Position:  0.023060179965974877
Bond Position:  [-18.34516732]


portfolio before change:  [-15.95880741]
curr_Stock_Price:  103.53373314160856
curr_Factors:  [103.53373314]
mat_Sqrt:  [[0.15]]
grads:  [0.0145513]
Stock Position:  0.014551297065115114
Bond Position:  [-17.46535752]


portfolio before change:  [-15.95009546]
curr_Stock_Price:  104.20745787251886
curr_Factors:  [104.20745787]
mat_Sqrt:  [[0.15]]
grads:  [0.0002613]
Stock Position:  0.0002613044914526446
Bond Position:  [-15.97732534]


portfolio before change:  [-15.95097024]
curr_Stock_Price:  104.68139145378494
curr_Factors:  [104.68139145]
mat_Sqrt:  [[0.15]]
grads:  [-0.05625945]
Stock Position:  -0.056259448302244434
Bond Position:  [-10.06165291]


portfolio before change:  [-16.00166533]
curr_Stock_Price:  105.57130816606535
curr_Factors:  [105.57130817]
mat_Sqrt:  [[0.15]]
grads:  [0.08004095]
Stock Position:  0.08004095400455095
Bond Position:  [-24.45169355]


portfolio before change:  [-15.93267918]
curr_Stock_Price:  106.45228756196784
curr_Factors:  [106.45228756]
mat_Sqrt:  [[0.15]]
grads:  [-0.21444707]
Stock Position:  -0.21444706954130857
Bond Position:  [6.89570193]


portfolio before change:  [-15.91132788]
curr_Stock_Price:  106.35473290268452
curr_Factors:  [106.3547329]
mat_Sqrt:  [[0.15]]
grads:  [-0.06744191]
Stock Position:  -0.06744191219315165
Bond Position:  [-8.73856132]


portfolio before change:  [-15.95722564]
curr_Stock_Price:  107.02718692847176
curr_Factors:  [107.02718693]
mat_Sqrt:  [[0.15]]
grads:  [0.14149453]
Stock Position:  0.14149452980733965
Bond Position:  [-31.10098713]


portfolio before change:  [-16.03163208]
curr_Stock_Price:  106.51506419127746
curr_Factors:  [106.51506419]
mat_Sqrt:  [[0.15]]
grads:  [-0.05540251]
Stock Position:  -0.05540251113889827
Bond Position:  [-10.13043005]


portfolio before change:  [-16.01852244]
curr_Stock_Price:  106.2670102696944
curr_Factors:  [106.26701027]
mat_Sqrt:  [[0.15]]
grads:  [0.08772375]
Stock Position:  0.08772375400881628
Bond Position:  [-25.34066351]


portfolio before change:  [-16.01928596]
curr_Stock_Price:  106.27636147429946
curr_Factors:  [106.27636147]
mat_Sqrt:  [[0.15]]
grads:  [-0.09266153]
Stock Position:  -0.09266152908771307
Bond Position:  [-6.1715558]


portfolio before change:  [-15.98746591]
curr_Stock_Price:  105.92879786128091
curr_Factors:  [105.92879786]
mat_Sqrt:  [[0.15]]
grads:  [-0.08474727]
Stock Position:  -0.0847472694065402
Bond Position:  [-7.01028954]


portfolio before change:  [-15.96476985]
curr_Stock_Price:  105.65581894963672
curr_Factors:  [105.65581895]
mat_Sqrt:  [[0.15]]
grads:  [-0.01996446]
Stock Position:  -0.019964461816959572
Bond Position:  [-13.85540829]


portfolio before change:  [-15.9693795]
curr_Stock_Price:  105.84333492171724
curr_Factors:  [105.84333492]
mat_Sqrt:  [[0.15]]
grads:  [0.49781714]
Stock Position:  0.4978171351514132
Bond Position:  [-68.66000526]


portfolio before change:  [-16.06407622]
curr_Stock_Price:  105.66173142022953
curr_Factors:  [105.66173142]
mat_Sqrt:  [[0.15]]
grads:  [-0.10383383]
Stock Position:  -0.10383382701014411
Bond Position:  [-5.09281428]


portfolio before change:  [-15.99036305]
curr_Stock_Price:  104.94875107101049
curr_Factors:  [104.94875107]
mat_Sqrt:  [[0.15]]
grads:  [0.10122066]
Stock Position:  0.10122066094382175
Bond Position:  [-26.613345]


portfolio before change:  [-15.91814651]
curr_Stock_Price:  105.67864085866066
curr_Factors:  [105.67864086]
mat_Sqrt:  [[0.15]]
grads:  [0.03419349]
Stock Position:  0.034193488162207374
Bond Position:  [-19.53166787]


portfolio before change:  [-15.91280069]
curr_Stock_Price:  105.870683033876
curr_Factors:  [105.87068303]
mat_Sqrt:  [[0.15]]
grads:  [0.08704602]
Stock Position:  0.0870460207785753
Bond Position:  [-25.12842236]


portfolio before change:  [-15.87383924]
curr_Stock_Price:  106.33632208126483
curr_Factors:  [106.33632208]
mat_Sqrt:  [[0.15]]
grads:  [-0.18008404]
Stock Position:  -0.18008403733622455
Bond Position:  [3.27563496]


portfolio before change:  [-15.94876442]
curr_Stock_Price:  106.75351573578975
curr_Factors:  [106.75351574]
mat_Sqrt:  [[0.15]]
grads:  [-0.05199576]
Stock Position:  -0.05199576412296966
Bond Position:  [-10.3980338]


portfolio before change:  [-15.95035802]
curr_Stock_Price:  106.77166542718777
curr_Factors:  [106.77166543]
mat_Sqrt:  [[0.15]]
grads:  [-0.03613729]
Stock Position:  -0.03613729042697433
Bond Position:  [-12.09191934]


portfolio before change:  [-15.96487258]
curr_Stock_Price:  107.15240195386913
curr_Factors:  [107.15240195]
mat_Sqrt:  [[0.15]]
grads:  [0.09331932]
Stock Position:  0.09331932185621712
Bond Position:  [-25.96426206]


portfolio before change:  [-16.00012992]
curr_Stock_Price:  106.79197789937291
curr_Factors:  [106.7919779]
mat_Sqrt:  [[0.15]]
grads:  [0.0331124]
Stock Position:  0.033112397458068196
Bond Position:  [-19.53626834]


portfolio before change:  [-16.00173706]
curr_Stock_Price:  106.78031822936738
curr_Factors:  [106.78031823]
mat_Sqrt:  [[0.15]]
grads:  [-0.01083814]
Stock Position:  -0.010838137425221226
Bond Position:  [-14.8444373]


portfolio before change:  [-16.00430493]
curr_Stock_Price:  106.93164200895882
curr_Factors:  [106.93164201]
mat_Sqrt:  [[0.15]]
grads:  [0.02224167]
Stock Position:  0.022241666434332164
Bond Position:  [-18.38264285]


portfolio before change:  [-16.01954333]
curr_Stock_Price:  106.29817099605683
curr_Factors:  [106.298171]
mat_Sqrt:  [[0.15]]
grads:  [0.04406883]
Stock Position:  0.0440688254083034
Bond Position:  [-20.70397887]


portfolio before change:  [-16.01961081]
curr_Stock_Price:  106.3260038844174
curr_Factors:  [106.32600388]
mat_Sqrt:  [[0.15]]
grads:  [-0.01918289]
Stock Position:  -0.01918289471173549
Bond Position:  [-13.97997027]


portfolio before change:  [-16.00724756]
curr_Stock_Price:  105.63596054255957
curr_Factors:  [105.63596054]
mat_Sqrt:  [[0.15]]
grads:  [0.14981292]
Stock Position:  0.14981291743166572
Bond Position:  [-31.83287899]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.00724756]
Stock Price:  106.25273547028945
PL:  [-22.25998303]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-8.03225604e-02]
 [-1.77674244e-03]
 [-8.07181931e-04]
 [-1.74687427e-03]
 [-3.04577888e-02]
 [ 3.63203532e-04]
 [ 3.78192949e-03]
 [-4.55452734e-02]
 [-1.47474354e-02]
 [ 5.49122912e-02]
 [ 1.05056469e-02]
 [-1.79527214e-02]
 [ 2.15934583e-02]
 [ 1.73606182e-02]
 [-4.77935128e-02]
 [ 2.71312003e-02]
 [-8.79893547e-03]
 [-3.17991815e-02]
 [-9.37021722e-02]
 [ 2.66022969e-02]
 [-1.02006949e-01]
 [-4.20439807e-02]
 [ 2.09881334e-03]
 [-4.14775757e-03]
 [-1.89730017e-02]
 [ 1.43741120e-02]
 [ 2.57812990e-02]
 [ 1.86696235e-01]
 [-2.97790628e-03]
 [ 3.46827961e-02]
 [-3.62278583e-03]
 [-1.05487675e-01]
 [ 3.05757307e-02]
 [ 9.04879336e-03]
 [-5.36863021e-02]
 [ 9.34717793e-03]
 [ 4.45689169e-03]
 [-2.67797841e-02]
 [ 1.30017642e-02]
 [-2.34460203e-02]
 [ 6.94194731e-02]
 [ 5.82713509e-03]
 [ 1.49815687e-02]
 [-1.14306884e-02]
 [-7.33930729e-03]
 [-2.69598928e-02]
 [-1.26796417e-02]
 [ 3.72980933e-03]
 [-3.34442456e-03]
 [-2.20170770e-02]
 [-5.06069505e-03]
 [ 2.97752960e-03]
 [ 4.71787822e-03]
 [-4.18795643e-03]
 [ 2.96682282e-02]
 [ 9.07954474e-03]
 [-4.13160690e-03]
 [ 1.49591316e-02]
 [ 1.29130518e-02]
 [-8.46417132e-03]
 [-1.18472459e-02]
 [-3.86913568e-02]
 [-1.30182921e-02]
 [-5.09255798e-03]
 [-1.40908036e-03]
 [ 7.52819834e-02]
 [ 8.63027126e-03]
 [ 1.68900480e-03]
 [ 1.57727858e-02]
 [-1.96835751e-02]
 [ 2.45877078e-02]
 [-2.43493260e-02]
 [-5.96012909e-03]
 [ 7.97679865e-03]
 [-1.29134938e-02]
 [ 3.92471207e-03]
 [ 2.23101978e-02]
 [-1.70793312e-02]
 [-5.56632777e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.44754928]
curr_Stock_Price:  100.86001224196627
curr_Factors:  [100.86001224]
mat_Sqrt:  [[0.15]]
grads:  [-0.53548374]
Stock Position:  -0.5354837362465711
Bond Position:  [69.45644547]


portfolio before change:  [15.95015911]
curr_Stock_Price:  99.92951028393857
curr_Factors:  [99.92951028]
mat_Sqrt:  [[0.15]]
grads:  [-0.01184495]
Stock Position:  -0.011844949625575682
Bond Position:  [17.13381913]


portfolio before change:  [15.96589929]
curr_Stock_Price:  98.6910679503058
curr_Factors:  [98.69106795]
mat_Sqrt:  [[0.15]]
grads:  [-0.00538121]
Stock Position:  -0.005381212871525774
Bond Position:  [16.49697694]


portfolio before change:  [15.96828141]
curr_Stock_Price:  98.44000481014932
curr_Factors:  [98.44000481]
mat_Sqrt:  [[0.15]]
grads:  [-0.01164583]
Stock Position:  -0.01164582849753606
Bond Position:  [17.11469682]


portfolio before change:  [15.9803707]
curr_Stock_Price:  97.49377900557971
curr_Factors:  [97.49377901]
mat_Sqrt:  [[0.15]]
grads:  [-0.20305193]
Stock Position:  -0.20305192555980886
Bond Position:  [35.77667025]


portfolio before change:  [15.95581493]
curr_Stock_Price:  97.62572495689221
curr_Factors:  [97.62572496]
mat_Sqrt:  [[0.15]]
grads:  [0.00242136]
Stock Position:  0.002421356879257635
Bond Position:  [15.71942821]


portfolio before change:  [15.95454668]
curr_Stock_Price:  96.69618629490753
curr_Factors:  [96.69618629]
mat_Sqrt:  [[0.15]]
grads:  [0.02521286]
Stock Position:  0.025212863290895306
Bond Position:  [13.51655895]


portfolio before change:  [15.92366927]
curr_Stock_Price:  95.43801006565637
curr_Factors:  [95.43801007]
mat_Sqrt:  [[0.15]]
grads:  [-0.30363516]
Stock Position:  -0.30363515618038056
Bond Position:  [44.90200436]


portfolio before change:  [15.82360188]
curr_Stock_Price:  95.77681750485652
curr_Factors:  [95.7768175]
mat_Sqrt:  [[0.15]]
grads:  [-0.09831624]
Stock Position:  -0.09831623585055152
Bond Position:  [25.24001806]


portfolio before change:  [15.72962132]
curr_Stock_Price:  96.74876390141308
curr_Factors:  [96.7487639]
mat_Sqrt:  [[0.15]]
grads:  [0.36608194]
Stock Position:  0.366081941426217
Bond Position:  [-19.688354]


portfolio before change:  [15.45999802]
curr_Stock_Price:  96.01561454667174
curr_Factors:  [96.01561455]
mat_Sqrt:  [[0.15]]
grads:  [0.07003765]
Stock Position:  0.07003764577446925
Bond Position:  [8.73529042]


portfolio before change:  [15.40399816]
curr_Stock_Price:  95.20825120254365
curr_Factors:  [95.2082512]
mat_Sqrt:  [[0.15]]
grads:  [-0.11968481]
Stock Position:  -0.11968480956013514
Bond Position:  [26.79897958]


portfolio before change:  [15.45228332]
curr_Stock_Price:  94.81881026022829
curr_Factors:  [94.81881026]
mat_Sqrt:  [[0.15]]
grads:  [0.14395639]
Stock Position:  0.14395638889857018
Bond Position:  [1.80250979]


portfolio before change:  [15.4061368]
curr_Stock_Price:  94.49746865461093
curr_Factors:  [94.49746865]
mat_Sqrt:  [[0.15]]
grads:  [0.11573745]
Stock Position:  0.1157374548550072
Bond Position:  [4.46924029]


portfolio before change:  [15.52739545]
curr_Stock_Price:  95.54275963847549
curr_Factors:  [95.54275964]
mat_Sqrt:  [[0.15]]
grads:  [-0.31862342]
Stock Position:  -0.31862341850448794
Bond Position:  [45.96955614]


portfolio before change:  [15.81808049]
curr_Stock_Price:  94.63946179571637
curr_Factors:  [94.6394618]
mat_Sqrt:  [[0.15]]
grads:  [0.18087467]
Stock Position:  0.18087466866209406
Bond Position:  [-1.29980081]


portfolio before change:  [15.78152056]
curr_Stock_Price:  94.43778242674773
curr_Factors:  [94.43778243]
mat_Sqrt:  [[0.15]]
grads:  [-0.05865957]
Stock Position:  -0.058659569794836594
Bond Position:  [21.32120025]


portfolio before change:  [15.81475479]
curr_Stock_Price:  93.89393918104398
curr_Factors:  [93.89393918]
mat_Sqrt:  [[0.15]]
grads:  [-0.21199454]
Stock Position:  -0.21199454319304684
Bond Position:  [35.71975753]


portfolio before change:  [15.75544693]
curr_Stock_Price:  94.18423158614625
curr_Factors:  [94.18423159]
mat_Sqrt:  [[0.15]]
grads:  [-0.62468115]
Stock Position:  -0.624681147852078
Bond Position:  [74.59056083]


portfolio before change:  [16.20369398]
curr_Stock_Price:  93.47413334450026
curr_Factors:  [93.47413334]
mat_Sqrt:  [[0.15]]
grads:  [0.17734865]
Stock Position:  0.17734864579869528
Bond Position:  [-0.37381699]


portfolio before change:  [16.22406962]
curr_Stock_Price:  93.58915540363995
curr_Factors:  [93.5891554]
mat_Sqrt:  [[0.15]]
grads:  [-0.68004633]
Stock Position:  -0.6800463289775278
Bond Position:  [79.86903118]


portfolio before change:  [15.92916713]
curr_Stock_Price:  94.03014661555007
curr_Factors:  [94.03014662]
mat_Sqrt:  [[0.15]]
grads:  [-0.2802932]
Stock Position:  -0.28029320433711785
Bond Position:  [42.28517823]


portfolio before change:  [15.82320191]
curr_Stock_Price:  94.41762702668426
curr_Factors:  [94.41762703]
mat_Sqrt:  [[0.15]]
grads:  [0.01399209]
Stock Position:  0.013992088908225201
Bond Position:  [14.50210208]


portfolio before change:  [15.80416458]
curr_Stock_Price:  92.99226835319048
curr_Factors:  [92.99226835]
mat_Sqrt:  [[0.15]]
grads:  [-0.02765172]
Stock Position:  -0.027651717146735408
Bond Position:  [18.37556048]


portfolio before change:  [15.80907262]
curr_Stock_Price:  92.85630811182155
curr_Factors:  [92.85630811]
mat_Sqrt:  [[0.15]]
grads:  [-0.12648668]
Stock Position:  -0.1264866777714088
Bond Position:  [27.55415854]


portfolio before change:  [15.81632839]
curr_Stock_Price:  92.81255981970558
curr_Factors:  [92.81255982]
mat_Sqrt:  [[0.15]]
grads:  [0.09582741]
Stock Position:  0.09582741354276719
Bond Position:  [6.92234083]


portfolio before change:  [15.82187542]
curr_Stock_Price:  92.86593054785813
curr_Factors:  [92.86593055]
mat_Sqrt:  [[0.15]]
grads:  [0.17187533]
Stock Position:  0.1718753269969285
Bond Position:  [-0.13948676]


portfolio before change:  [15.70912427]
curr_Stock_Price:  92.20997581273657
curr_Factors:  [92.20997581]
mat_Sqrt:  [[0.15]]
grads:  [1.24464157]
Stock Position:  1.244641566413152
Bond Position:  [-99.05924446]


portfolio before change:  [14.87627073]
curr_Stock_Price:  91.54579894219101
curr_Factors:  [91.54579894]
mat_Sqrt:  [[0.15]]
grads:  [-0.01985271]
Stock Position:  -0.019852708543023224
Bond Position:  [16.6937028]


portfolio before change:  [14.86706115]
curr_Stock_Price:  92.06225095346959
curr_Factors:  [92.06225095]
mat_Sqrt:  [[0.15]]
grads:  [0.23121864]
Stock Position:  0.2312186407958448
Bond Position:  [-6.41944738]


portfolio before change:  [15.05163761]
curr_Stock_Price:  92.8622629332474
curr_Factors:  [92.86226293]
mat_Sqrt:  [[0.15]]
grads:  [-0.02415191]
Stock Position:  -0.0241519055475269
Bond Position:  [17.29443821]


portfolio before change:  [15.07881562]
curr_Stock_Price:  91.7817240783504
curr_Factors:  [91.78172408]
mat_Sqrt:  [[0.15]]
grads:  [-0.70325116]
Stock Position:  -0.7032511648261933
Bond Position:  [79.62441998]


portfolio before change:  [14.9738071]
curr_Stock_Price:  91.93811941145697
curr_Factors:  [91.93811941]
mat_Sqrt:  [[0.15]]
grads:  [0.2038382]
Stock Position:  0.20383820473066033
Bond Position:  [-3.76669411]


portfolio before change:  [14.94403525]
curr_Stock_Price:  91.79321812104705
curr_Factors:  [91.79321812]
mat_Sqrt:  [[0.15]]
grads:  [0.06032529]
Stock Position:  0.06032528905139636
Bond Position:  [9.40658284]


portfolio before change:  [14.94679989]
curr_Stock_Price:  91.82930104441577
curr_Factors:  [91.82930104]
mat_Sqrt:  [[0.15]]
grads:  [-0.35790868]
Stock Position:  -0.35790868055359604
Bond Position:  [47.81330387]


portfolio before change:  [14.74410282]
curr_Stock_Price:  92.40398814266153
curr_Factors:  [92.40398814]
mat_Sqrt:  [[0.15]]
grads:  [0.06231452]
Stock Position:  0.062314519511056356
Bond Position:  [8.9859927]


portfolio before change:  [14.76474321]
curr_Stock_Price:  92.72620440606829
curr_Factors:  [92.72620441]
mat_Sqrt:  [[0.15]]
grads:  [0.02971261]
Stock Position:  0.029712611280556384
Bond Position:  [12.00960555]


portfolio before change:  [14.76829142]
curr_Stock_Price:  92.82035930988033
curr_Factors:  [92.82035931]
mat_Sqrt:  [[0.15]]
grads:  [-0.17853189]
Stock Position:  -0.17853189428867217
Bond Position:  [31.339686]


portfolio before change:  [14.73950081]
curr_Stock_Price:  92.99259412914526
curr_Factors:  [92.99259413]
mat_Sqrt:  [[0.15]]
grads:  [0.08667843]
Stock Position:  0.08667842816574733
Bond Position:  [6.67904892]


portfolio before change:  [14.77694625]
curr_Stock_Price:  93.41978220388143
curr_Factors:  [93.4197822]
mat_Sqrt:  [[0.15]]
grads:  [-0.1563068]
Stock Position:  -0.15630680176672737
Bond Position:  [29.37909363]


portfolio before change:  [14.90925602]
curr_Stock_Price:  92.58505515732845
curr_Factors:  [92.58505516]
mat_Sqrt:  [[0.15]]
grads:  [0.46279649]
Stock Position:  0.4627964871518925
Bond Position:  [-27.93878227]


portfolio before change:  [14.91576007]
curr_Stock_Price:  92.60288217985774
curr_Factors:  [92.60288218]
mat_Sqrt:  [[0.15]]
grads:  [0.03884757]
Stock Position:  0.03884756729286457
Bond Position:  [11.31836338]


portfolio before change:  [14.91387572]
curr_Stock_Price:  92.53616577160734
curr_Factors:  [92.53616577]
mat_Sqrt:  [[0.15]]
grads:  [0.09987712]
Stock Position:  0.09987712494561625
Bond Position:  [5.67162953]


portfolio before change:  [14.86986314]
curr_Stock_Price:  92.09194927371982
curr_Factors:  [92.09194927]
mat_Sqrt:  [[0.15]]
grads:  [-0.07620459]
Stock Position:  -0.07620458906344071
Bond Position:  [21.88769229]


portfolio before change:  [14.83419254]
curr_Stock_Price:  92.5779912017247
curr_Factors:  [92.5779912]
mat_Sqrt:  [[0.15]]
grads:  [-0.04892872]
Stock Position:  -0.048928715240435204
Bond Position:  [19.36391471]


portfolio before change:  [14.84472143]
curr_Stock_Price:  92.38753855889338
curr_Factors:  [92.38753856]
mat_Sqrt:  [[0.15]]
grads:  [-0.17973262]
Stock Position:  -0.1797326188195588
Bond Position:  [31.44977568]


portfolio before change:  [14.95026882]
curr_Stock_Price:  91.81122848813817
curr_Factors:  [91.81122849]
mat_Sqrt:  [[0.15]]
grads:  [-0.08453094]
Stock Position:  -0.08453094436108008
Bond Position:  [22.71115866]


portfolio before change:  [14.92743514]
curr_Stock_Price:  92.0981432048949
curr_Factors:  [92.0981432]
mat_Sqrt:  [[0.15]]
grads:  [0.0248654]
Stock Position:  0.024865395545683358
Bond Position:  [12.63737838]


portfolio before change:  [14.93530205]
curr_Stock_Price:  92.38275781178554
curr_Factors:  [92.38275781]
mat_Sqrt:  [[0.15]]
grads:  [-0.02229616]
Stock Position:  -0.0222961637175074
Bond Position:  [16.99508315]


portfolio before change:  [14.93607075]
curr_Stock_Price:  92.39592266080135
curr_Factors:  [92.39592266]
mat_Sqrt:  [[0.15]]
grads:  [-0.14678051]
Stock Position:  -0.14678051308832032
Bond Position:  [28.49799169]


portfolio before change:  [15.05131749]
curr_Stock_Price:  91.6228938889582
curr_Factors:  [91.62289389]
mat_Sqrt:  [[0.15]]
grads:  [-0.03373797]
Stock Position:  -0.033737966970555554
Bond Position:  [18.14248766]


portfolio before change:  [15.06682154]
curr_Stock_Price:  91.19696101472218
curr_Factors:  [91.19696101]
mat_Sqrt:  [[0.15]]
grads:  [0.0198502]
Stock Position:  0.01985019730078041
Bond Position:  [13.25654387]


portfolio before change:  [15.06817868]
curr_Stock_Price:  91.22358931632056
curr_Factors:  [91.22358932]
mat_Sqrt:  [[0.15]]
grads:  [0.03145252]
Stock Position:  0.03145252144003203
Bond Position:  [12.19896678]


portfolio before change:  [15.08649453]
curr_Stock_Price:  91.78168084815547
curr_Factors:  [91.78168085]
mat_Sqrt:  [[0.15]]
grads:  [-0.02791971]
Stock Position:  -0.02791970951042378
Bond Position:  [17.64901239]


portfolio before change:  [15.07800774]
curr_Stock_Price:  92.12516176620846
curr_Factors:  [92.12516177]
mat_Sqrt:  [[0.15]]
grads:  [0.19778819]
Stock Position:  0.19778818801627288
Bond Position:  [-3.14326108]


portfolio before change:  [15.20449906]
curr_Stock_Price:  92.76568428939622
curr_Factors:  [92.76568429]
mat_Sqrt:  [[0.15]]
grads:  [0.0605303]
Stock Position:  0.06053029825463861
Bond Position:  [9.58936453]


portfolio before change:  [15.19499194]
curr_Stock_Price:  92.59871869895149
curr_Factors:  [92.5987187]
mat_Sqrt:  [[0.15]]
grads:  [-0.02754405]
Stock Position:  -0.027544045968473763
Bond Position:  [17.74553531]


portfolio before change:  [15.1601455]
curr_Stock_Price:  93.9041034122489
curr_Factors:  [93.90410341]
mat_Sqrt:  [[0.15]]
grads:  [0.09972754]
Stock Position:  0.09972754422880256
Bond Position:  [5.79531987]


portfolio before change:  [15.14896752]
curr_Stock_Price:  93.788386234751
curr_Factors:  [93.78838623]
mat_Sqrt:  [[0.15]]
grads:  [0.08608701]
Stock Position:  0.08608701221960188
Bond Position:  [7.07500557]


portfolio before change:  [15.14925657]
curr_Stock_Price:  93.78660710195591
curr_Factors:  [93.7866071]
mat_Sqrt:  [[0.15]]
grads:  [-0.05642781]
Stock Position:  -0.05642780881752397
Bond Position:  [20.4414293]


portfolio before change:  [15.20503061]
curr_Stock_Price:  92.82083472539526
curr_Factors:  [92.82083473]
mat_Sqrt:  [[0.15]]
grads:  [-0.07898164]
Stock Position:  -0.07898163905057541
Bond Position:  [22.53617228]


portfolio before change:  [15.21313391]
curr_Stock_Price:  92.73607150972252
curr_Factors:  [92.73607151]
mat_Sqrt:  [[0.15]]
grads:  [-0.25794238]
Stock Position:  -0.25794237857345753
Bond Position:  [39.13369677]


portfolio before change:  [15.1688776]
curr_Stock_Price:  92.91712837690993
curr_Factors:  [92.91712838]
mat_Sqrt:  [[0.15]]
grads:  [-0.08678861]
Stock Position:  -0.0867886142635748
Bond Position:  [23.23302641]


portfolio before change:  [15.22679012]
curr_Stock_Price:  92.26657749317535
curr_Factors:  [92.26657749]
mat_Sqrt:  [[0.15]]
grads:  [-0.03395039]
Stock Position:  -0.0339503865453259
Bond Position:  [18.35927609]


portfolio before change:  [15.22880655]
curr_Stock_Price:  92.24098323712813
curr_Factors:  [92.24098324]
mat_Sqrt:  [[0.15]]
grads:  [-0.00939387]
Stock Position:  -0.009393869040877611
Bond Position:  [16.09530626]


portfolio before change:  [15.23024052]
curr_Stock_Price:  92.19542328618834
curr_Factors:  [92.19542329]
mat_Sqrt:  [[0.15]]
grads:  [0.50187989]
Stock Position:  0.5018798894321334
Bond Position:  [-31.04078833]


portfolio before change:  [15.37649732]
curr_Stock_Price:  92.49070691833035
curr_Factors:  [92.49070692]
mat_Sqrt:  [[0.15]]
grads:  [0.05753514]
Stock Position:  0.05753514176235567
Bond Position:  [10.05503139]


portfolio before change:  [15.42967087]
curr_Stock_Price:  93.40397629024676
curr_Factors:  [93.40397629]
mat_Sqrt:  [[0.15]]
grads:  [0.01126003]
Stock Position:  0.011260032001830752
Bond Position:  [14.3779391]


portfolio before change:  [15.43279123]
curr_Stock_Price:  93.60128581483488
curr_Factors:  [93.60128581]
mat_Sqrt:  [[0.15]]
grads:  [0.10515191]
Stock Position:  0.10515190532009121
Bond Position:  [5.59043768]


portfolio before change:  [15.44230367]
curr_Stock_Price:  93.6884267009362
curr_Factors:  [93.6884267]
mat_Sqrt:  [[0.15]]
grads:  [-0.13122383]
Stock Position:  -0.1312238340286023
Bond Position:  [27.73645823]


portfolio before change:  [15.45249105]
curr_Stock_Price:  93.62400401190474
curr_Factors:  [93.62400401]
mat_Sqrt:  [[0.15]]
grads:  [0.16391805]
Stock Position:  0.16391805232433726
Bond Position:  [0.10582666]


portfolio before change:  [15.44736213]
curr_Stock_Price:  93.5926741753899
curr_Factors:  [93.59267418]
mat_Sqrt:  [[0.15]]
grads:  [-0.16232884]
Stock Position:  -0.16232884007933807
Bond Position:  [30.64015237]


portfolio before change:  [15.40737721]
curr_Stock_Price:  93.85079217955
curr_Factors:  [93.85079218]
mat_Sqrt:  [[0.15]]
grads:  [-0.03973419]
Stock Position:  -0.0397341939170263
Bond Position:  [19.13646278]


portfolio before change:  [15.430838]
curr_Stock_Price:  93.29045043381835
curr_Factors:  [93.29045043]
mat_Sqrt:  [[0.15]]
grads:  [0.05317866]
Stock Position:  0.053178657679294465
Bond Position:  [10.46977707]


portfolio before change:  [15.39238839]
curr_Stock_Price:  92.55511805994375
curr_Factors:  [92.55511806]
mat_Sqrt:  [[0.15]]
grads:  [-0.08608996]
Stock Position:  -0.08608995847515
Bond Position:  [23.36045466]


portfolio before change:  [15.3335269]
curr_Stock_Price:  93.25579870201598
curr_Factors:  [93.2557987]
mat_Sqrt:  [[0.15]]
grads:  [0.02616475]
Stock Position:  0.026164747151845597
Bond Position:  [12.89351251]


portfolio before change:  [15.31711485]
curr_Stock_Price:  92.59774088087582
curr_Factors:  [92.59774088]
mat_Sqrt:  [[0.15]]
grads:  [0.14873465]
Stock Position:  0.14873465220999418
Bond Position:  [1.54462207]


portfolio before change:  [15.35789331]
curr_Stock_Price:  92.87126098222181
curr_Factors:  [92.87126098]
mat_Sqrt:  [[0.15]]
grads:  [-0.11386221]
Stock Position:  -0.11386220771440195
Bond Position:  [25.93242012]


portfolio before change:  [15.33155769]
curr_Stock_Price:  93.11678977015833
curr_Factors:  [93.11678977]
mat_Sqrt:  [[0.15]]
grads:  [-0.37108852]
Stock Position:  -0.3710885180540609
Bond Position:  [49.88612921]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.33155769]
Stock Price:  92.70291897594481
PL:  [15.33155769]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-6.89874206e-02]
 [-1.16213104e-03]
 [ 1.33269852e-04]
 [ 2.33733757e-03]
 [ 1.24808257e-02]
 [ 1.19779509e-02]
 [ 3.51371949e-04]
 [ 8.11877658e-03]
 [ 4.64166283e-03]
 [-2.03368214e-02]
 [ 7.69205906e-03]
 [-6.83252076e-03]
 [-7.58627679e-03]
 [ 4.30340819e-03]
 [-2.54548013e-04]
 [ 1.37869802e-02]
 [-2.13953929e-03]
 [ 4.63633540e-03]
 [ 2.15768737e-02]
 [ 1.00491031e-02]
 [ 3.21863777e-02]
 [-1.84579041e-02]
 [-1.26207920e-03]
 [ 1.15008628e-02]
 [ 1.48969760e-02]
 [-6.37715840e-03]
 [ 1.28276408e-02]
 [-6.99396577e-04]
 [ 4.20652192e-03]
 [-2.52218282e-02]
 [-5.67727672e-03]
 [ 3.25102960e-02]
 [ 6.79529141e-03]
 [-3.65026980e-03]
 [-3.68761291e-03]
 [-4.35350729e-03]
 [-6.92727824e-03]
 [ 6.44745865e-03]
 [ 2.20194872e-03]
 [-7.97592583e-03]
 [-4.53998150e-02]
 [-3.49537447e-03]
 [ 1.53130888e-02]
 [-1.37357041e-02]
 [-2.34963146e-03]
 [ 2.63853846e-03]
 [-1.35836401e-02]
 [ 1.46903280e-02]
 [ 1.79412636e-02]
 [-1.03918485e-02]
 [-3.79548953e-03]
 [ 3.45329038e-03]
 [ 2.09653107e-03]
 [ 3.66045723e-04]
 [-9.18333325e-03]
 [ 1.15715347e-02]
 [-2.61693106e-02]
 [-8.30642929e-03]
 [ 1.72243492e-02]
 [-2.64050629e-03]
 [ 1.29850379e-02]
 [-1.47234171e-02]
 [-1.27427193e-02]
 [-3.12523410e-03]
 [ 7.02671145e-02]
 [-1.62008866e-02]
 [ 6.42770450e-03]
 [ 6.03134305e-03]
 [ 1.44332837e-02]
 [-3.28072616e-02]
 [-8.00302204e-03]
 [-4.66137123e-03]
 [ 2.01528007e-02]
 [ 3.12378480e-03]
 [-2.72205673e-03]
 [ 8.47384830e-03]
 [-1.83314158e-03]
 [-6.61348436e-04]
 [ 2.91025577e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.59601517]
curr_Stock_Price:  100.67674226345002
curr_Factors:  [100.67674226]
mat_Sqrt:  [[0.15]]
grads:  [-0.45991614]
Stock Position:  -0.4599161376364323
Bond Position:  [58.89887362]


portfolio before change:  [12.6538722]
curr_Stock_Price:  100.55894743081745
curr_Factors:  [100.55894743]
mat_Sqrt:  [[0.15]]
grads:  [-0.00774754]
Stock Position:  -0.0077475402738028405
Bond Position:  [13.4329567]


portfolio before change:  [12.6563852]
curr_Stock_Price:  100.34295534787509
curr_Factors:  [100.34295535]
mat_Sqrt:  [[0.15]]
grads:  [0.00088847]
Stock Position:  0.0008884656795286738
Bond Position:  [12.56723393]


portfolio before change:  [12.65749017]
curr_Stock_Price:  100.70255410841149
curr_Factors:  [100.70255411]
mat_Sqrt:  [[0.15]]
grads:  [0.01558225]
Stock Position:  0.015582250448096592
Bond Position:  [11.08831775]


portfolio before change:  [12.65190939]
curr_Stock_Price:  100.29992813874082
curr_Factors:  [100.29992814]
mat_Sqrt:  [[0.15]]
grads:  [0.0832055]
Stock Position:  0.08320550453833937
Bond Position:  [4.30640326]


portfolio before change:  [12.64099077]
curr_Stock_Price:  100.16546858820112
curr_Factors:  [100.16546859]
mat_Sqrt:  [[0.15]]
grads:  [0.07985301]
Stock Position:  0.07985300567467919
Bond Position:  [4.64247704]


portfolio before change:  [12.71766882]
curr_Stock_Price:  101.12207484848238
curr_Factors:  [101.12207485]
mat_Sqrt:  [[0.15]]
grads:  [0.00234248]
Stock Position:  0.002342479661113219
Bond Position:  [12.48079242]


portfolio before change:  [12.71813476]
curr_Stock_Price:  100.9879725235304
curr_Factors:  [100.98797252]
mat_Sqrt:  [[0.15]]
grads:  [0.05412518]
Stock Position:  0.05412517719221656
Bond Position:  [7.25214286]


portfolio before change:  [12.69022723]
curr_Stock_Price:  100.46398698307507
curr_Factors:  [100.46398698]
mat_Sqrt:  [[0.15]]
grads:  [0.03094442]
Stock Position:  0.030944418872907553
Bond Position:  [9.58142753]


portfolio before change:  [12.69542835]
curr_Stock_Price:  100.61271385348358
curr_Factors:  [100.61271385]
mat_Sqrt:  [[0.15]]
grads:  [-0.13557881]
Stock Position:  -0.13557880933329952
Bond Position:  [26.3363803]


portfolio before change:  [12.81750307]
curr_Stock_Price:  99.72445820923248
curr_Factors:  [99.72445821]
mat_Sqrt:  [[0.15]]
grads:  [0.05128039]
Stock Position:  0.051280393735166505
Bond Position:  [7.70359359]


portfolio before change:  [12.7663614]
curr_Stock_Price:  98.71777406661329
curr_Factors:  [98.71777407]
mat_Sqrt:  [[0.15]]
grads:  [-0.04555014]
Stock Position:  -0.045550138404735915
Bond Position:  [17.26296967]


portfolio before change:  [12.73846395]
curr_Stock_Price:  99.35391734982285
curr_Factors:  [99.35391735]
mat_Sqrt:  [[0.15]]
grads:  [-0.05057518]
Stock Position:  -0.050575178615086584
Bond Position:  [17.76330607]


portfolio before change:  [12.71376508]
curr_Stock_Price:  99.86422925573792
curr_Factors:  [99.86422926]
mat_Sqrt:  [[0.15]]
grads:  [0.02868939]
Stock Position:  0.028689387942084383
Bond Position:  [9.84872146]


portfolio before change:  [12.69983144]
curr_Stock_Price:  99.35710092562192
curr_Factors:  [99.35710093]
mat_Sqrt:  [[0.15]]
grads:  [-0.00169699]
Stock Position:  -0.0016969867540761001
Bond Position:  [12.86843913]


portfolio before change:  [12.70165142]
curr_Stock_Price:  98.7585857059611
curr_Factors:  [98.75858571]
mat_Sqrt:  [[0.15]]
grads:  [0.0919132]
Stock Position:  0.0919132011502998
Bond Position:  [3.62443366]


portfolio before change:  [12.68567089]
curr_Stock_Price:  98.58225562538236
curr_Factors:  [98.58225563]
mat_Sqrt:  [[0.15]]
grads:  [-0.0142636]
Stock Position:  -0.014263595257527956
Bond Position:  [14.09180828]


portfolio before change:  [12.68489387]
curr_Stock_Price:  98.6984806298164
curr_Factors:  [98.69848063]
mat_Sqrt:  [[0.15]]
grads:  [0.0309089]
Stock Position:  0.030908902684597842
Bond Position:  [9.63423214]


portfolio before change:  [12.70617719]
curr_Stock_Price:  99.36758115530378
curr_Factors:  [99.36758116]
mat_Sqrt:  [[0.15]]
grads:  [0.14384582]
Stock Position:  0.14384582477631974
Bond Position:  [-1.58743448]


portfolio before change:  [12.7390241]
curr_Stock_Price:  99.59661892800825
curr_Factors:  [99.59661893]
mat_Sqrt:  [[0.15]]
grads:  [0.06699402]
Stock Position:  0.06699402059566886
Bond Position:  [6.06664616]


portfolio before change:  [12.67444326]
curr_Stock_Price:  98.62697985082539
curr_Factors:  [98.62697985]
mat_Sqrt:  [[0.15]]
grads:  [0.21457585]
Stock Position:  0.2145758513313782
Bond Position:  [-8.48852491]


portfolio before change:  [12.69491217]
curr_Stock_Price:  98.72484483132249
curr_Factors:  [98.72484483]
mat_Sqrt:  [[0.15]]
grads:  [-0.12305269]
Stock Position:  -0.12305269401732512
Bond Position:  [24.84327029]


portfolio before change:  [12.66293823]
curr_Stock_Price:  98.99730280669905
curr_Factors:  [98.99730281]
mat_Sqrt:  [[0.15]]
grads:  [-0.00841386]
Stock Position:  -0.00841386132487572
Bond Position:  [13.49588781]


portfolio before change:  [12.65502485]
curr_Stock_Price:  100.03807411011019
curr_Factors:  [100.03807411]
mat_Sqrt:  [[0.15]]
grads:  [0.07667242]
Stock Position:  0.07667241865728344
Bond Position:  [4.98486375]


portfolio before change:  [12.71525411]
curr_Stock_Price:  100.81955066676933
curr_Factors:  [100.81955067]
mat_Sqrt:  [[0.15]]
grads:  [0.09931317]
Stock Position:  0.09931317345672193
Bond Position:  [2.70254459]


portfolio before change:  [12.68653603]
curr_Stock_Price:  100.52868294273759
curr_Factors:  [100.52868294]
mat_Sqrt:  [[0.15]]
grads:  [-0.04251439]
Stock Position:  -0.042514389302852715
Bond Position:  [16.96045159]


portfolio before change:  [12.67773238]
curr_Stock_Price:  100.7606915385171
curr_Factors:  [100.76069154]
mat_Sqrt:  [[0.15]]
grads:  [0.08551761]
Stock Position:  0.08551760555096044
Bond Position:  [4.06091931]


portfolio before change:  [12.71733005]
curr_Stock_Price:  101.22075882214862
curr_Factors:  [101.22075882]
mat_Sqrt:  [[0.15]]
grads:  [-0.00466264]
Stock Position:  -0.004662643845473348
Bond Position:  [13.1892864]


portfolio before change:  [12.71839725]
curr_Stock_Price:  101.16867564251163
curr_Factors:  [101.16867564]
mat_Sqrt:  [[0.15]]
grads:  [0.02804348]
Stock Position:  0.02804347949601032
Bond Position:  [9.88127557]


portfolio before change:  [12.72543306]
curr_Stock_Price:  101.39754191812392
curr_Factors:  [101.39754192]
mat_Sqrt:  [[0.15]]
grads:  [-0.16814552]
Stock Position:  -0.16814552138027453
Bond Position:  [29.77497561]


portfolio before change:  [12.58103429]
curr_Stock_Price:  102.26738229508085
curr_Factors:  [102.2673823]
mat_Sqrt:  [[0.15]]
grads:  [-0.03784851]
Stock Position:  -0.037848511493656325
Bond Position:  [16.45170248]


portfolio before change:  [12.5840709]
curr_Stock_Price:  102.21431952710496
curr_Factors:  [102.21431953]
mat_Sqrt:  [[0.15]]
grads:  [0.21673531]
Stock Position:  0.2167353066324262
Bond Position:  [-9.56938099]


portfolio before change:  [12.64830022]
curr_Stock_Price:  102.51342826162097
curr_Factors:  [102.51342826]
mat_Sqrt:  [[0.15]]
grads:  [0.04530194]
Stock Position:  0.045301942703508985
Bond Position:  [8.00424276]


portfolio before change:  [12.66262693]
curr_Stock_Price:  102.81863451020362
curr_Factors:  [102.81863451]
mat_Sqrt:  [[0.15]]
grads:  [-0.02433513]
Stock Position:  -0.02433513201069018
Bond Position:  [15.16473198]


portfolio before change:  [12.68188666]
curr_Stock_Price:  102.06614632297246
curr_Factors:  [102.06614632]
mat_Sqrt:  [[0.15]]
grads:  [-0.02458409]
Stock Position:  -0.02458408603759159
Bond Position:  [15.19108958]


portfolio before change:  [12.67884461]
curr_Stock_Price:  102.2285081546278
curr_Factors:  [102.22850815]
mat_Sqrt:  [[0.15]]
grads:  [-0.02902338]
Stock Position:  -0.029023381935486276
Bond Position:  [15.64586165]


portfolio before change:  [12.68359259]
curr_Stock_Price:  102.09861001985476
curr_Factors:  [102.09861002]
mat_Sqrt:  [[0.15]]
grads:  [-0.04618185]
Stock Position:  -0.04618185495977852
Bond Position:  [17.39869579]


portfolio before change:  [12.69631407]
curr_Stock_Price:  101.84669233691588
curr_Factors:  [101.84669234]
mat_Sqrt:  [[0.15]]
grads:  [0.04298306]
Stock Position:  0.042983057699044036
Bond Position:  [8.31863182]


portfolio before change:  [12.7327065]
curr_Stock_Price:  102.68126535576508
curr_Factors:  [102.68126536]
mat_Sqrt:  [[0.15]]
grads:  [0.01467966]
Stock Position:  0.014679658148049243
Bond Position:  [11.22538063]


portfolio before change:  [12.74025658]
curr_Stock_Price:  103.14779338057815
curr_Factors:  [103.14779338]
mat_Sqrt:  [[0.15]]
grads:  [-0.05317284]
Stock Position:  -0.05317283886555264
Bond Position:  [18.22491758]


portfolio before change:  [12.70427183]
curr_Stock_Price:  103.84596651528638
curr_Factors:  [103.84596652]
mat_Sqrt:  [[0.15]]
grads:  [-0.30266543]
Stock Position:  -0.30266543331981616
Bond Position:  [44.13485628]


portfolio before change:  [12.75764858]
curr_Stock_Price:  103.67872496293167
curr_Factors:  [103.67872496]
mat_Sqrt:  [[0.15]]
grads:  [-0.0233025]
Stock Position:  -0.023302496478189903
Bond Position:  [15.1736217]


portfolio before change:  [12.74785344]
curr_Stock_Price:  104.13977115451198
curr_Factors:  [104.13977115]
mat_Sqrt:  [[0.15]]
grads:  [0.10208726]
Stock Position:  0.1020872588916151
Bond Position:  [2.11650966]


portfolio before change:  [12.74110084]
curr_Stock_Price:  104.07233005353619
curr_Factors:  [104.07233005]
mat_Sqrt:  [[0.15]]
grads:  [-0.09157136]
Stock Position:  -0.0915713609811966
Bond Position:  [22.27114575]


portfolio before change:  [12.75316869]
curr_Stock_Price:  103.9557449793119
curr_Factors:  [103.95574498]
mat_Sqrt:  [[0.15]]
grads:  [-0.01566421]
Stock Position:  -0.015664209766125488
Bond Position:  [14.38155328]


portfolio before change:  [12.74857385]
curr_Stock_Price:  104.30646279962738
curr_Factors:  [104.3064628]
mat_Sqrt:  [[0.15]]
grads:  [0.01759026]
Stock Position:  0.017590256420446315
Bond Position:  [10.91379642]


portfolio before change:  [12.75656132]
curr_Stock_Price:  104.72176885093032
curr_Factors:  [104.72176885]
mat_Sqrt:  [[0.15]]
grads:  [-0.0905576]
Stock Position:  -0.09055760071667548
Bond Position:  [22.23991345]


portfolio before change:  [12.73247404]
curr_Stock_Price:  105.00310707533941
curr_Factors:  [105.00310708]
mat_Sqrt:  [[0.15]]
grads:  [0.09793552]
Stock Position:  0.09793552020371174
Bond Position:  [2.44894013]


portfolio before change:  [12.68698704]
curr_Stock_Price:  104.53708550433899
curr_Factors:  [104.5370855]
mat_Sqrt:  [[0.15]]
grads:  [0.11960842]
Stock Position:  0.11960842382560224
Bond Position:  [0.18347101]


portfolio before change:  [12.60110134]
curr_Stock_Price:  103.81893233011591
curr_Factors:  [103.81893233]
mat_Sqrt:  [[0.15]]
grads:  [-0.06927899]
Stock Position:  -0.06927899024699345
Bond Position:  [19.79357214]


portfolio before change:  [12.6076336]
curr_Stock_Price:  103.74250051122442
curr_Factors:  [103.74250051]
mat_Sqrt:  [[0.15]]
grads:  [-0.02530326]
Stock Position:  -0.02530326350743997
Bond Position:  [15.23265742]


portfolio before change:  [12.60789024]
curr_Stock_Price:  103.7699840194274
curr_Factors:  [103.76998402]
mat_Sqrt:  [[0.15]]
grads:  [0.02302194]
Stock Position:  0.02302193589993725
Bond Position:  [10.21890432]


portfolio before change:  [12.60121808]
curr_Stock_Price:  103.45242336276618
curr_Factors:  [103.45242336]
mat_Sqrt:  [[0.15]]
grads:  [0.01397687]
Stock Position:  0.013976873772639465
Bond Position:  [11.15527662]


portfolio before change:  [12.61083918]
curr_Stock_Price:  104.09089696519251
curr_Factors:  [104.09089697]
mat_Sqrt:  [[0.15]]
grads:  [0.0024403]
Stock Position:  0.002440304818694614
Bond Position:  [12.35682566]


portfolio before change:  [12.61395552]
curr_Stock_Price:  105.05144162113575
curr_Factors:  [105.05144162]
mat_Sqrt:  [[0.15]]
grads:  [-0.06122222]
Stock Position:  -0.06122222164072261
Bond Position:  [19.04543817]


portfolio before change:  [12.62237667]
curr_Stock_Price:  104.93333475232136
curr_Factors:  [104.93333475]
mat_Sqrt:  [[0.15]]
grads:  [0.07714356]
Stock Position:  0.07714356491058544
Bond Position:  [4.52744514]


portfolio before change:  [12.66345115]
curr_Stock_Price:  105.46210869209067
curr_Factors:  [105.46210869]
mat_Sqrt:  [[0.15]]
grads:  [-0.17446207]
Stock Position:  -0.17446207048436435
Bond Position:  [31.06258899]


portfolio before change:  [12.761144]
curr_Stock_Price:  104.91327089766499
curr_Factors:  [104.9132709]
mat_Sqrt:  [[0.15]]
grads:  [-0.0553762]
Stock Position:  -0.055376195274018894
Bond Position:  [18.57084177]


portfolio before change:  [12.78398839]
curr_Stock_Price:  104.52170043483588
curr_Factors:  [104.52170043]
mat_Sqrt:  [[0.15]]
grads:  [0.11482899]
Stock Position:  0.1148289947082573
Bond Position:  [0.78186661]


portfolio before change:  [12.79472701]
curr_Stock_Price:  104.614793170845
curr_Factors:  [104.61479317]
mat_Sqrt:  [[0.15]]
grads:  [-0.01760338]
Stock Position:  -0.017603375249903488
Bond Position:  [14.63630047]


portfolio before change:  [12.80059857]
curr_Stock_Price:  104.33321284638974
curr_Factors:  [104.33321285]
mat_Sqrt:  [[0.15]]
grads:  [0.08656692]
Stock Position:  0.08656691932320978
Bond Position:  [3.76879375]


portfolio before change:  [12.80923038]
curr_Stock_Price:  104.43020435544895
curr_Factors:  [104.43020436]
mat_Sqrt:  [[0.15]]
grads:  [-0.09815611]
Stock Position:  -0.09815611391455643
Bond Position:  [23.05969342]


portfolio before change:  [12.7697861]
curr_Stock_Price:  104.8467403794371
curr_Factors:  [104.84674038]
mat_Sqrt:  [[0.15]]
grads:  [-0.08495146]
Stock Position:  -0.0849514621053858
Bond Position:  [21.67666999]


portfolio before change:  [12.74617024]
curr_Stock_Price:  105.14068108840783
curr_Factors:  [105.14068109]
mat_Sqrt:  [[0.15]]
grads:  [-0.02083489]
Stock Position:  -0.020834894031163082
Bond Position:  [14.93676519]


portfolio before change:  [12.73549898]
curr_Stock_Price:  105.69767145627337
curr_Factors:  [105.69767146]
mat_Sqrt:  [[0.15]]
grads:  [0.46844743]
Stock Position:  0.4684474302921426
Bond Position:  [-36.7783036]


portfolio before change:  [12.5092804]
curr_Stock_Price:  105.21966719704196
curr_Factors:  [105.2196672]
mat_Sqrt:  [[0.15]]
grads:  [-0.10800591]
Stock Position:  -0.10800591038671394
Bond Position:  [23.87362635]


portfolio before change:  [12.35204446]
curr_Stock_Price:  106.68929131677956
curr_Factors:  [106.68929132]
mat_Sqrt:  [[0.15]]
grads:  [0.04285136]
Stock Position:  0.04285136333114106
Bond Position:  [7.78026287]


portfolio before change:  [12.36114308]
curr_Stock_Price:  106.8902730346177
curr_Factors:  [106.89027303]
mat_Sqrt:  [[0.15]]
grads:  [0.04020895]
Stock Position:  0.04020895369239118
Bond Position:  [8.06319704]


portfolio before change:  [12.35950849]
curr_Stock_Price:  106.83708687869863
curr_Factors:  [106.83708688]
mat_Sqrt:  [[0.15]]
grads:  [0.09622189]
Stock Position:  0.09622189160261001
Bond Position:  [2.07944189]


portfolio before change:  [12.53536893]
curr_Stock_Price:  108.66339143581493
curr_Factors:  [108.66339144]
mat_Sqrt:  [[0.15]]
grads:  [-0.21871508]
Stock Position:  -0.21871507747455787
Bond Position:  [36.30169101]


portfolio before change:  [12.41905552]
curr_Stock_Price:  109.2055686822662
curr_Factors:  [109.20556868]
mat_Sqrt:  [[0.15]]
grads:  [-0.05335348]
Stock Position:  -0.05335348028821146
Bond Position:  [18.24555268]


portfolio before change:  [12.48355587]
curr_Stock_Price:  108.01801790637516
curr_Factors:  [108.01801791]
mat_Sqrt:  [[0.15]]
grads:  [-0.03107581]
Stock Position:  -0.031075808220567665
Bond Position:  [15.84030308]


portfolio before change:  [12.44211042]
curr_Stock_Price:  109.38356573258494
curr_Factors:  [109.38356573]
mat_Sqrt:  [[0.15]]
grads:  [0.134352]
Stock Position:  0.13435200449063486
Bond Position:  [-2.2537909]


portfolio before change:  [12.39894633]
curr_Stock_Price:  109.06333808124049
curr_Factors:  [109.06333808]
mat_Sqrt:  [[0.15]]
grads:  [0.02082523]
Stock Position:  0.020825232031937303
Bond Position:  [10.127677]


portfolio before change:  [12.38644222]
curr_Stock_Price:  108.43251190684308
curr_Factors:  [108.43251191]
mat_Sqrt:  [[0.15]]
grads:  [-0.01814704]
Stock Position:  -0.018147044851552097
Bond Position:  [14.35417188]


portfolio before change:  [12.36951019]
curr_Stock_Price:  109.4149967775611
curr_Factors:  [109.41499678]
mat_Sqrt:  [[0.15]]
grads:  [0.05649232]
Stock Position:  0.05649232199617535
Bond Position:  [6.18840296]


portfolio before change:  [12.39919492]
curr_Stock_Price:  109.93361487556946
curr_Factors:  [109.93361488]
mat_Sqrt:  [[0.15]]
grads:  [-0.01222094]
Stock Position:  -0.01222094387970097
Bond Position:  [13.74268746]


portfolio before change:  [12.39882033]
curr_Stock_Price:  110.03455120917414
curr_Factors:  [110.03455121]
mat_Sqrt:  [[0.15]]
grads:  [-0.00440899]
Stock Position:  -0.004408989571796999
Bond Position:  [12.88396151]


portfolio before change:  [12.40013847]
curr_Stock_Price:  109.91822698430327
curr_Factors:  [109.91822698]
mat_Sqrt:  [[0.15]]
grads:  [0.19401705]
Stock Position:  0.19401705106353045
Bond Position:  [-8.92587179]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.40013847]
Stock Price:  109.40471291490714
PL:  [2.99542556]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-7.30731223e-02]
 [-1.42012321e-03]
 [ 1.73735083e-03]
 [ 3.06178388e-03]
 [ 6.22096527e-03]
 [ 1.21546110e-02]
 [ 2.75304039e-04]
 [ 8.81828192e-03]
 [ 1.43434404e-03]
 [-1.82766774e-02]
 [ 1.00728556e-02]
 [-5.34919758e-03]
 [-3.52872717e-03]
 [ 4.15462999e-03]
 [ 5.24477071e-03]
 [-9.94753876e-03]
 [ 8.94708911e-03]
 [ 2.69052234e-02]
 [ 1.32785115e-02]
 [-1.74811357e-03]
 [ 3.07310209e-02]
 [-1.28627757e-02]
 [ 8.56024914e-03]
 [-4.22056673e-03]
 [ 1.72887404e-02]
 [ 1.82703529e-02]
 [ 1.10421850e-02]
 [ 2.37973309e-03]
 [ 4.21764307e-03]
 [-2.56959080e-02]
 [-5.35372933e-03]
 [ 2.85631531e-02]
 [ 7.68943104e-03]
 [ 7.92930067e-03]
 [-3.55051536e-05]
 [-4.68204733e-03]
 [-7.10882551e-03]
 [ 3.61408790e-03]
 [ 1.40300498e-03]
 [-8.48274090e-03]
 [-3.15752799e-02]
 [-2.55565660e-03]
 [ 1.33333560e-02]
 [-1.19818623e-02]
 [-4.36079927e-04]
 [ 2.41958715e-03]
 [-1.36125278e-02]
 [ 6.49776369e-03]
 [ 1.42601963e-02]
 [-1.20111302e-02]
 [-4.36024446e-03]
 [ 3.51166965e-03]
 [ 3.22202937e-03]
 [ 6.87372414e-04]
 [-8.32730533e-03]
 [ 1.18004564e-02]
 [-2.24718572e-02]
 [-8.75184314e-03]
 [ 1.69861619e-02]
 [-3.35150901e-03]
 [ 1.30088134e-02]
 [-1.43485508e-02]
 [-1.27213110e-02]
 [-2.85505872e-03]
 [ 7.18072786e-02]
 [-1.52088407e-02]
 [ 8.84262778e-03]
 [ 5.60282137e-03]
 [ 1.42350721e-02]
 [-2.90179600e-02]
 [-7.79834846e-03]
 [-5.44076876e-03]
 [ 1.33549872e-02]
 [ 4.53149797e-03]
 [-1.74902120e-03]
 [ 3.11995327e-03]
 [ 6.55381991e-03]
 [-2.88788624e-03]
 [ 2.08068749e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.56974573]
curr_Stock_Price:  100.73932456934978
curr_Factors:  [100.73932457]
mat_Sqrt:  [[0.15]]
grads:  [-0.48715415]
Stock Position:  -0.4871541485573954
Bond Position:  [62.64532562]


portfolio before change:  [13.68762183]
curr_Stock_Price:  100.50539318435965
curr_Factors:  [100.50539318]
mat_Sqrt:  [[0.15]]
grads:  [-0.00946749]
Stock Position:  -0.009467488060062647
Bond Position:  [14.63915544]


portfolio before change:  [13.68491457]
curr_Stock_Price:  100.88799051879388
curr_Factors:  [100.88799052]
mat_Sqrt:  [[0.15]]
grads:  [0.01158234]
Stock Position:  0.011582338897383356
Bond Position:  [12.51639568]


portfolio before change:  [13.69304494]
curr_Stock_Price:  101.52241073415777
curr_Factors:  [101.52241073]
mat_Sqrt:  [[0.15]]
grads:  [0.02041189]
Stock Position:  0.02041189252836162
Bond Position:  [11.62078041]


portfolio before change:  [13.69490779]
curr_Stock_Price:  101.57809033857262
curr_Factors:  [101.57809034]
mat_Sqrt:  [[0.15]]
grads:  [0.0414731]
Stock Position:  0.04147310182005037
Bond Position:  [9.48214931]


portfolio before change:  [13.69967278]
curr_Stock_Price:  101.67869366609476
curr_Factors:  [101.67869367]
mat_Sqrt:  [[0.15]]
grads:  [0.08103074]
Stock Position:  0.08103073980542193
Bond Position:  [5.460573]


portfolio before change:  [13.66123902]
curr_Stock_Price:  101.20017095243564
curr_Factors:  [101.20017095]
mat_Sqrt:  [[0.15]]
grads:  [0.00183536]
Stock Position:  0.0018353602579665
Bond Position:  [13.47550025]


portfolio before change:  [13.66142433]
curr_Stock_Price:  100.84223559649273
curr_Factors:  [100.8422356]
mat_Sqrt:  [[0.15]]
grads:  [0.05878855]
Stock Position:  0.05878854613072987
Bond Position:  [7.73305591]


portfolio before change:  [13.64868987]
curr_Stock_Price:  100.61739946268935
curr_Factors:  [100.61739946]
mat_Sqrt:  [[0.15]]
grads:  [0.00956229]
Stock Position:  0.009562293590993247
Bond Position:  [12.68655675]


portfolio before change:  [13.65660418]
curr_Stock_Price:  101.36213457165435
curr_Factors:  [101.36213457]
mat_Sqrt:  [[0.15]]
grads:  [-0.12184452]
Stock Position:  -0.12184451615596582
Bond Position:  [26.00702442]


portfolio before change:  [13.64138851]
curr_Stock_Price:  101.50035303634787
curr_Factors:  [101.50035304]
mat_Sqrt:  [[0.15]]
grads:  [0.06715237]
Stock Position:  0.06715237073592278
Bond Position:  [6.82539917]


portfolio before change:  [13.56147877]
curr_Stock_Price:  100.30402395856039
curr_Factors:  [100.30402396]
mat_Sqrt:  [[0.15]]
grads:  [-0.03566132]
Stock Position:  -0.035661317226562385
Bond Position:  [17.13845239]


portfolio before change:  [13.55766348]
curr_Stock_Price:  100.44104859667524
curr_Factors:  [100.4410486]
mat_Sqrt:  [[0.15]]
grads:  [-0.02352485]
Stock Position:  -0.023524847820599704
Bond Position:  [15.92052386]


portfolio before change:  [13.54564334]
curr_Stock_Price:  100.99430195868221
curr_Factors:  [100.99430196]
mat_Sqrt:  [[0.15]]
grads:  [0.02769753]
Stock Position:  0.027697533238966593
Bond Position:  [10.74835031]


portfolio before change:  [13.54236281]
curr_Stock_Price:  100.85160593447858
curr_Factors:  [100.85160593]
mat_Sqrt:  [[0.15]]
grads:  [0.03496514]
Stock Position:  0.03496513809423375
Bond Position:  [10.01607248]


portfolio before change:  [13.54830702]
curr_Stock_Price:  101.00370564382473
curr_Factors:  [101.00370564]
mat_Sqrt:  [[0.15]]
grads:  [-0.06631693]
Stock Position:  -0.06631692507521769
Bond Position:  [20.2465622]


portfolio before change:  [13.45382446]
curr_Stock_Price:  102.44750008395597
curr_Factors:  [102.44750008]
mat_Sqrt:  [[0.15]]
grads:  [0.05964726]
Stock Position:  0.059647260731123766
Bond Position:  [7.34311171]


portfolio before change:  [13.45937487]
curr_Stock_Price:  102.5328594220077
curr_Factors:  [102.53285942]
mat_Sqrt:  [[0.15]]
grads:  [0.17936816]
Stock Position:  0.17936815625738245
Bond Position:  [-4.93175508]


portfolio before change:  [13.45157959]
curr_Stock_Price:  102.49111824423332
curr_Factors:  [102.49111824]
mat_Sqrt:  [[0.15]]
grads:  [0.08852341]
Stock Position:  0.08852340978895029
Bond Position:  [4.37871633]


portfolio before change:  [13.45750945]
curr_Stock_Price:  102.55501304007778
curr_Factors:  [102.55501304]
mat_Sqrt:  [[0.15]]
grads:  [-0.01165409]
Stock Position:  -0.01165409047908693
Bond Position:  [14.65269485]


portfolio before change:  [13.45156205]
curr_Stock_Price:  103.14392443487468
curr_Factors:  [103.14392443]
mat_Sqrt:  [[0.15]]
grads:  [0.20487347]
Stock Position:  0.20487347273405773
Bond Position:  [-7.67989194]


portfolio before change:  [13.2119529]
curr_Stock_Price:  101.97672040996221
curr_Factors:  [101.97672041]
mat_Sqrt:  [[0.15]]
grads:  [-0.08575184]
Stock Position:  -0.08575183813155215
Bond Position:  [21.95664412]


portfolio before change:  [13.21828223]
curr_Stock_Price:  101.91891403413952
curr_Factors:  [101.91891403]
mat_Sqrt:  [[0.15]]
grads:  [0.05706833]
Stock Position:  0.0570683276314603
Bond Position:  [7.40194026]


portfolio before change:  [13.21329587]
curr_Stock_Price:  101.82343208229352
curr_Factors:  [101.82343208]
mat_Sqrt:  [[0.15]]
grads:  [-0.02813711]
Stock Position:  -0.028137111519569876
Bond Position:  [16.07831314]


portfolio before change:  [13.20032]
curr_Stock_Price:  102.32031326517998
curr_Factors:  [102.32031327]
mat_Sqrt:  [[0.15]]
grads:  [0.11525827]
Stock Position:  0.11525826919164352
Bond Position:  [1.40705779]


portfolio before change:  [13.20034875]
curr_Stock_Price:  102.31979968157982
curr_Factors:  [102.31979968]
mat_Sqrt:  [[0.15]]
grads:  [0.12180235]
Stock Position:  0.12180235273155592
Bond Position:  [0.73755642]


portfolio before change:  [13.15627562]
curr_Stock_Price:  101.95757986806922
curr_Factors:  [101.95757987]
mat_Sqrt:  [[0.15]]
grads:  [0.07361457]
Stock Position:  0.07361456689780542
Bond Position:  [5.65071254]


portfolio before change:  [13.12122915]
curr_Stock_Price:  101.47670154988674
curr_Factors:  [101.47670155]
mat_Sqrt:  [[0.15]]
grads:  [0.01586489]
Stock Position:  0.01586488726849381
Bond Position:  [11.51131272]


portfolio before change:  [13.1171794]
curr_Stock_Price:  101.17608566570986
curr_Factors:  [101.17608567]
mat_Sqrt:  [[0.15]]
grads:  [0.02811762]
Stock Position:  0.02811762046286299
Bond Position:  [10.27234862]


portfolio before change:  [13.12249675]
curr_Stock_Price:  101.34236253793244
curr_Factors:  [101.34236254]
mat_Sqrt:  [[0.15]]
grads:  [-0.17130605]
Stock Position:  -0.17130605315354516
Bond Position:  [30.48305689]


portfolio before change:  [13.10276754]
curr_Stock_Price:  101.46865377989432
curr_Factors:  [101.46865378]
mat_Sqrt:  [[0.15]]
grads:  [-0.03569153]
Stock Position:  -0.03569152884291335
Bond Position:  [16.72433893]


portfolio before change:  [13.08653099]
curr_Stock_Price:  101.95285420787506
curr_Factors:  [101.95285421]
mat_Sqrt:  [[0.15]]
grads:  [0.19042102]
Stock Position:  0.190421020990987
Bond Position:  [-6.3274356]


portfolio before change:  [13.00890348]
curr_Stock_Price:  101.54726855643834
curr_Factors:  [101.54726856]
mat_Sqrt:  [[0.15]]
grads:  [0.05126287]
Stock Position:  0.05126287361151463
Bond Position:  [7.80329869]


portfolio before change:  [12.99879244]
curr_Stock_Price:  101.34051532856765
curr_Factors:  [101.34051533]
mat_Sqrt:  [[0.15]]
grads:  [0.052862]
Stock Position:  0.05286200445638479
Bond Position:  [7.64172967]


portfolio before change:  [13.00452413]
curr_Stock_Price:  101.43990743415245
curr_Factors:  [101.43990743]
mat_Sqrt:  [[0.15]]
grads:  [-0.0002367]
Stock Position:  -0.0002367010239066996
Bond Position:  [13.02853506]


portfolio before change:  [13.00537266]
curr_Stock_Price:  101.29532929434512
curr_Factors:  [101.29532929]
mat_Sqrt:  [[0.15]]
grads:  [-0.03121365]
Stock Position:  -0.031213648837382018
Bond Position:  [16.1671695]


portfolio before change:  [12.99059207]
curr_Stock_Price:  101.80123204225029
curr_Factors:  [101.80123204]
mat_Sqrt:  [[0.15]]
grads:  [-0.04739217]
Stock Position:  -0.047392170072304354
Bond Position:  [17.81517337]


portfolio before change:  [12.94836813]
curr_Stock_Price:  102.71567462139377
curr_Factors:  [102.71567462]
mat_Sqrt:  [[0.15]]
grads:  [0.02409392]
Stock Position:  0.02409391934930712
Bond Position:  [10.47354495]


portfolio before change:  [12.93619324]
curr_Stock_Price:  102.18319547528303
curr_Factors:  [102.18319548]
mat_Sqrt:  [[0.15]]
grads:  [0.00935337]
Stock Position:  0.009353366515361155
Bond Position:  [11.98043636]


portfolio before change:  [12.9397573]
curr_Stock_Price:  102.48418390209122
curr_Factors:  [102.4841839]
mat_Sqrt:  [[0.15]]
grads:  [-0.05655161]
Stock Position:  -0.05655160600455967
Bond Position:  [18.73540249]


portfolio before change:  [12.93376131]
curr_Stock_Price:  102.61091737519166
curr_Factors:  [102.61091738]
mat_Sqrt:  [[0.15]]
grads:  [-0.21050187]
Stock Position:  -0.21050186623829936
Bond Position:  [34.53355092]


portfolio before change:  [12.88576431]
curr_Stock_Price:  102.8491832970742
curr_Factors:  [102.8491833]
mat_Sqrt:  [[0.15]]
grads:  [-0.01703771]
Stock Position:  -0.01703771068084993
Bond Position:  [14.63807894]


portfolio before change:  [12.88112735]
curr_Stock_Price:  103.17504102729939
curr_Factors:  [103.17504103]
mat_Sqrt:  [[0.15]]
grads:  [0.08888904]
Stock Position:  0.08888904011235942
Bond Position:  [3.70999699]


portfolio before change:  [12.86374723]
curr_Stock_Price:  102.97690640516953
curr_Factors:  [102.97690641]
mat_Sqrt:  [[0.15]]
grads:  [-0.07987908]
Stock Position:  -0.07987908170411026
Bond Position:  [21.08944795]


portfolio before change:  [12.89055863]
curr_Stock_Price:  102.65775821903797
curr_Factors:  [102.65775822]
mat_Sqrt:  [[0.15]]
grads:  [-0.0029072]
Stock Position:  -0.0029071995139649752
Bond Position:  [13.18900521]


portfolio before change:  [12.89009493]
curr_Stock_Price:  103.10080787864545
curr_Factors:  [103.10080788]
mat_Sqrt:  [[0.15]]
grads:  [0.01613058]
Stock Position:  0.016130581008168336
Bond Position:  [11.227019]


portfolio before change:  [12.9008938]
curr_Stock_Price:  103.72677164630532
curr_Factors:  [103.72677165]
mat_Sqrt:  [[0.15]]
grads:  [-0.09075019]
Stock Position:  -0.09075018517349305
Bond Position:  [22.31411754]


portfolio before change:  [12.91242832]
curr_Stock_Price:  103.61503804491858
curr_Factors:  [103.61503804]
mat_Sqrt:  [[0.15]]
grads:  [0.04331842]
Stock Position:  0.04331842462552066
Bond Position:  [8.42398811]


portfolio before change:  [12.93626919]
curr_Stock_Price:  104.15324667702983
curr_Factors:  [104.15324668]
mat_Sqrt:  [[0.15]]
grads:  [0.09506798]
Stock Position:  0.0950679755223597
Bond Position:  [3.03463088]


portfolio before change:  [12.99558218]
curr_Stock_Price:  104.77515238594151
curr_Factors:  [104.77515239]
mat_Sqrt:  [[0.15]]
grads:  [-0.0800742]
Stock Position:  -0.08007420110266182
Bond Position:  [21.3853688]


portfolio before change:  [12.95924033]
curr_Stock_Price:  105.24569685662405
curr_Factors:  [105.24569686]
mat_Sqrt:  [[0.15]]
grads:  [-0.0290683]
Stock Position:  -0.02906829639224953
Bond Position:  [16.01855344]


portfolio before change:  [12.97263772]
curr_Stock_Price:  104.8192460289262
curr_Factors:  [104.81924603]
mat_Sqrt:  [[0.15]]
grads:  [0.02341113]
Stock Position:  0.023411131029501486
Bond Position:  [10.51870062]


portfolio before change:  [12.98508318]
curr_Stock_Price:  105.32276818976312
curr_Factors:  [105.32276819]
mat_Sqrt:  [[0.15]]
grads:  [0.0214802]
Stock Position:  0.02148019581340813
Bond Position:  [10.7227295]


portfolio before change:  [12.9568311]
curr_Stock_Price:  103.97630579182163
curr_Factors:  [103.97630579]
mat_Sqrt:  [[0.15]]
grads:  [0.00458248]
Stock Position:  0.004582482758122329
Bond Position:  [12.48036147]


portfolio before change:  [12.96058794]
curr_Stock_Price:  104.62590902278761
curr_Factors:  [104.62590902]
mat_Sqrt:  [[0.15]]
grads:  [-0.05551537]
Stock Position:  -0.05551536884058961
Bond Position:  [18.76893387]


portfolio before change:  [12.92603878]
curr_Stock_Price:  105.26937507861658
curr_Factors:  [105.26937508]
mat_Sqrt:  [[0.15]]
grads:  [0.07866971]
Stock Position:  0.07866970934790057
Bond Position:  [4.64452764]


portfolio before change:  [12.89888113]
curr_Stock_Price:  104.92047409212925
curr_Factors:  [104.92047409]
mat_Sqrt:  [[0.15]]
grads:  [-0.14981238]
Stock Position:  -0.14981238126724195
Bond Position:  [28.6172672]


portfolio before change:  [12.84860294]
curr_Stock_Price:  105.26802099625901
curr_Factors:  [105.268021]
mat_Sqrt:  [[0.15]]
grads:  [-0.05834562]
Stock Position:  -0.05834562093474682
Bond Position:  [18.99053099]


portfolio before change:  [12.90203959]
curr_Stock_Price:  104.37250034441836
curr_Factors:  [104.37250034]
mat_Sqrt:  [[0.15]]
grads:  [0.11324108]
Stock Position:  0.11324107944392828
Bond Position:  [1.08278499]


portfolio before change:  [12.957157]
curr_Stock_Price:  104.85862895823303
curr_Factors:  [104.85862896]
mat_Sqrt:  [[0.15]]
grads:  [-0.02234339]
Stock Position:  -0.022343393410863683
Bond Position:  [15.3000546]


portfolio before change:  [12.96393278]
curr_Stock_Price:  104.59817189458062
curr_Factors:  [104.59817189]
mat_Sqrt:  [[0.15]]
grads:  [0.08672542]
Stock Position:  0.08672542290456674
Bond Position:  [3.89261208]


portfolio before change:  [13.02243148]
curr_Stock_Price:  105.26989423491435
curr_Factors:  [105.26989423]
mat_Sqrt:  [[0.15]]
grads:  [-0.09565701]
Stock Position:  -0.09565700523964746
Bond Position:  [23.0922343]


portfolio before change:  [12.99200592]
curr_Stock_Price:  105.6030519222134
curr_Factors:  [105.60305192]
mat_Sqrt:  [[0.15]]
grads:  [-0.08480874]
Stock Position:  -0.08480874020966504
Bond Position:  [21.94806772]


portfolio before change:  [12.94218764]
curr_Stock_Price:  106.20664631506506
curr_Factors:  [106.20664632]
mat_Sqrt:  [[0.15]]
grads:  [-0.01903372]
Stock Position:  -0.01903372478631322
Bond Position:  [14.96369571]


portfolio before change:  [12.9518413]
curr_Stock_Price:  105.74859595581906
curr_Factors:  [105.74859596]
mat_Sqrt:  [[0.15]]
grads:  [0.47871519]
Stock Position:  0.478715190414461
Bond Position:  [-37.67161795]


portfolio before change:  [13.03174775]
curr_Stock_Price:  105.92043299921006
curr_Factors:  [105.920433]
mat_Sqrt:  [[0.15]]
grads:  [-0.10139227]
Stock Position:  -0.10139227100867826
Bond Position:  [23.771261]


portfolio before change:  [13.0039534]
curr_Stock_Price:  106.20921345229273
curr_Factors:  [106.20921345]
mat_Sqrt:  [[0.15]]
grads:  [0.05895085]
Stock Position:  0.05895085187649837
Bond Position:  [6.74282979]


portfolio before change:  [13.01037193]
curr_Stock_Price:  106.31094383549667
curr_Factors:  [106.31094384]
mat_Sqrt:  [[0.15]]
grads:  [0.03735214]
Stock Position:  0.03735214246862789
Bond Position:  [9.03943041]


portfolio before change:  [13.02539114]
curr_Stock_Price:  106.69791573339685
curr_Factors:  [106.69791573]
mat_Sqrt:  [[0.15]]
grads:  [0.09490048]
Stock Position:  0.09490048082950148
Bond Position:  [2.89970764]


portfolio before change:  [13.06768299]
curr_Stock_Price:  107.14165009345196
curr_Factors:  [107.14165009]
mat_Sqrt:  [[0.15]]
grads:  [-0.19345307]
Stock Position:  -0.19345306679918134
Bond Position:  [33.79456378]


portfolio before change:  [13.14294443]
curr_Stock_Price:  106.76352625288956
curr_Factors:  [106.76352625]
mat_Sqrt:  [[0.15]]
grads:  [-0.05198899]
Stock Position:  -0.051988989759722694
Bond Position:  [18.6934723]


portfolio before change:  [13.14541153]
curr_Stock_Price:  106.7385454758434
curr_Factors:  [106.73854548]
mat_Sqrt:  [[0.15]]
grads:  [-0.03627179]
Stock Position:  -0.03627179173956935
Bond Position:  [17.01700982]


portfolio before change:  [13.13943641]
curr_Stock_Price:  106.93260026723335
curr_Factors:  [106.93260027]
mat_Sqrt:  [[0.15]]
grads:  [0.08903325]
Stock Position:  0.0890332481835493
Bond Position:  [3.61887967]


portfolio before change:  [13.17491146]
curr_Stock_Price:  107.3285069180534
curr_Factors:  [107.32850692]
mat_Sqrt:  [[0.15]]
grads:  [0.03020999]
Stock Position:  0.030209986444141534
Bond Position:  [9.93251872]


portfolio before change:  [13.16458497]
curr_Stock_Price:  106.96613392310547
curr_Factors:  [106.96613392]
mat_Sqrt:  [[0.15]]
grads:  [-0.01166014]
Stock Position:  -0.011660141359993999
Bond Position:  [14.41182522]


portfolio before change:  [13.167107]
curr_Stock_Price:  106.82709093289515
curr_Factors:  [106.82709093]
mat_Sqrt:  [[0.15]]
grads:  [0.02079969]
Stock Position:  0.020799688453516506
Bond Position:  [10.94513679]


portfolio before change:  [13.15729575]
curr_Stock_Price:  106.32249948403722
curr_Factors:  [106.32249948]
mat_Sqrt:  [[0.15]]
grads:  [0.04369213]
Stock Position:  0.04369213276197764
Bond Position:  [8.51183899]


portfolio before change:  [13.1572364]
curr_Stock_Price:  106.30896487807115
curr_Factors:  [106.30896488]
mat_Sqrt:  [[0.15]]
grads:  [-0.01925257]
Stock Position:  -0.019252574909466736
Bond Position:  [15.20395771]


portfolio before change:  [13.14999644]
curr_Stock_Price:  106.73437472316951
curr_Factors:  [106.73437472]
mat_Sqrt:  [[0.15]]
grads:  [0.1387125]
Stock Position:  0.13871249912198083
Bond Position:  [-1.65539542]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.14999644]
Stock Price:  106.93418416552319
PL:  [6.21581228]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-7.33132859e-02]
 [ 2.83336887e-03]
 [ 2.12645130e-02]
 [ 3.61358263e-03]
 [-1.40628076e-04]
 [ 1.22750704e-02]
 [-1.00679578e-03]
 [ 1.83429003e-02]
 [-9.58787556e-03]
 [-2.00541641e-02]
 [ 1.01980363e-02]
 [-5.55629277e-03]
 [-1.40138737e-03]
 [ 4.26629748e-03]
 [ 3.74228812e-03]
 [-8.56804454e-04]
 [ 1.40650752e-02]
 [ 1.42447522e-02]
 [ 2.00707460e-02]
 [ 8.28665978e-04]
 [ 7.97017177e-02]
 [-1.30559405e-02]
 [ 8.33863662e-03]
 [-2.62015184e-03]
 [ 1.69936760e-02]
 [ 5.90782746e-03]
 [ 1.22160263e-02]
 [-8.14979126e-06]
 [ 2.73098863e-03]
 [-2.32786483e-02]
 [-5.01020944e-03]
 [-8.51679046e-03]
 [ 1.57682991e-02]
 [ 1.97487858e-02]
 [-8.92600295e-03]
 [ 6.26257340e-03]
 [-2.26362194e-03]
 [ 1.13854618e-02]
 [ 1.03129911e-04]
 [-1.38131371e-02]
 [ 1.86400282e-03]
 [-2.66360923e-03]
 [ 3.76860294e-03]
 [-7.82224721e-03]
 [ 2.24379760e-03]
 [-2.96994933e-03]
 [-1.36935671e-02]
 [-5.00048258e-03]
 [-6.41920871e-07]
 [ 1.32920574e-03]
 [-3.12322445e-03]
 [ 3.79134722e-03]
 [ 7.00762940e-04]
 [ 3.27540551e-03]
 [-4.08921141e-03]
 [ 9.48822087e-03]
 [-3.93611198e-03]
 [-8.91347552e-03]
 [ 1.61119660e-02]
 [-1.33570977e-03]
 [ 1.26411656e-02]
 [-1.47259372e-02]
 [-1.27570520e-02]
 [-3.33915557e-03]
 [ 3.56224648e-02]
 [-1.84196646e-02]
 [ 2.10182900e-02]
 [ 3.99322654e-03]
 [ 1.03655320e-02]
 [-2.00962578e-02]
 [-7.73904908e-03]
 [-7.05285268e-03]
 [ 7.58240984e-03]
 [ 6.27876568e-03]
 [-7.40239574e-04]
 [-1.92549254e-03]
 [ 7.82687798e-03]
 [-3.40273735e-03]
 [ 2.21049742e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.62698306]
curr_Stock_Price:  100.74300325031696
curr_Factors:  [100.74300325]
mat_Sqrt:  [[0.15]]
grads:  [-0.48875524]
Stock Position:  -0.48875523932767656
Bond Position:  [62.86565373]


portfolio before change:  [13.31442833]
curr_Stock_Price:  101.39053383136635
curr_Factors:  [101.39053383]
mat_Sqrt:  [[0.15]]
grads:  [0.01888913]
Stock Position:  0.018889125786660205
Bond Position:  [11.39924978]


portfolio before change:  [13.33829491]
curr_Stock_Price:  102.61632440918295
curr_Factors:  [102.61632441]
mat_Sqrt:  [[0.15]]
grads:  [0.14176342]
Stock Position:  0.1417634201849155
Bond Position:  [-1.2089462]


portfolio before change:  [13.26923726]
curr_Stock_Price:  102.12972430802031
curr_Factors:  [102.12972431]
mat_Sqrt:  [[0.15]]
grads:  [0.02409055]
Stock Position:  0.02409055087551741
Bond Position:  [10.80887594]


portfolio before change:  [13.26819087]
curr_Stock_Price:  102.05824562985067
curr_Factors:  [102.05824563]
mat_Sqrt:  [[0.15]]
grads:  [-0.00093752]
Stock Position:  -0.0009375205039071957
Bond Position:  [13.36387257]


portfolio before change:  [13.26868559]
curr_Stock_Price:  102.42149344824767
curr_Factors:  [102.42149345]
mat_Sqrt:  [[0.15]]
grads:  [0.0818338]
Stock Position:  0.08183380244401012
Bond Position:  [4.88714533]


portfolio before change:  [13.30916274]
curr_Stock_Price:  102.91238705723849
curr_Factors:  [102.91238706]
mat_Sqrt:  [[0.15]]
grads:  [-0.00671197]
Stock Position:  -0.006711971846022688
Bond Position:  [13.99990778]


portfolio before change:  [13.31171807]
curr_Stock_Price:  102.66204190810559
curr_Factors:  [102.66204191]
mat_Sqrt:  [[0.15]]
grads:  [0.122286]
Stock Position:  0.12228600167285687
Bond Position:  [0.75758744]


portfolio before change:  [13.21656519]
curr_Stock_Price:  101.88353719830071
curr_Factors:  [101.8835372]
mat_Sqrt:  [[0.15]]
grads:  [-0.06391917]
Stock Position:  -0.06391917038215206
Bond Position:  [19.72887636]


portfolio before change:  [13.27129586]
curr_Stock_Price:  101.0465804742708
curr_Factors:  [101.04658047]
mat_Sqrt:  [[0.15]]
grads:  [-0.13369443]
Stock Position:  -0.1336944275099395
Bond Position:  [26.78066059]


portfolio before change:  [13.36058353]
curr_Stock_Price:  100.39125153834466
curr_Factors:  [100.39125154]
mat_Sqrt:  [[0.15]]
grads:  [0.06798691]
Stock Position:  0.06798690875290127
Bond Position:  [6.53529267]


portfolio before change:  [13.36015362]
curr_Stock_Price:  100.37892002277822
curr_Factors:  [100.37892002]
mat_Sqrt:  [[0.15]]
grads:  [-0.03704195]
Stock Position:  -0.03704195179632375
Bond Position:  [17.07838474]


portfolio before change:  [13.35320563]
curr_Stock_Price:  100.59530774715945
curr_Factors:  [100.59530775]
mat_Sqrt:  [[0.15]]
grads:  [-0.00934258]
Stock Position:  -0.009342582487703172
Bond Position:  [14.29302559]


portfolio before change:  [13.35507429]
curr_Stock_Price:  100.49091221228413
curr_Factors:  [100.49091221]
mat_Sqrt:  [[0.15]]
grads:  [0.02844198]
Stock Position:  0.028441983224573166
Bond Position:  [10.49691345]


portfolio before change:  [13.37298269]
curr_Stock_Price:  101.09749149165809
curr_Factors:  [101.09749149]
mat_Sqrt:  [[0.15]]
grads:  [0.02494859]
Stock Position:  0.024948587483666747
Bond Position:  [10.85074308]


portfolio before change:  [13.34967295]
curr_Stock_Price:  100.13599684533007
curr_Factors:  [100.13599685]
mat_Sqrt:  [[0.15]]
grads:  [-0.00571203]
Stock Position:  -0.0057120296915010955
Bond Position:  [13.92165274]


portfolio before change:  [13.34792539]
curr_Stock_Price:  100.59427313402209
curr_Factors:  [100.59427313]
mat_Sqrt:  [[0.15]]
grads:  [0.09376717]
Stock Position:  0.09376716804136566
Bond Position:  [3.91548528]


portfolio before change:  [13.3536392]
curr_Stock_Price:  100.65259939186302
curr_Factors:  [100.65259939]
mat_Sqrt:  [[0.15]]
grads:  [0.09496501]
Stock Position:  0.09496501484568393
Bond Position:  [3.79516361]


portfolio before change:  [13.37920586]
curr_Stock_Price:  100.91932337830168
curr_Factors:  [100.91932338]
mat_Sqrt:  [[0.15]]
grads:  [0.13380497]
Stock Position:  0.13380497323428603
Bond Position:  [-0.12430151]


portfolio before change:  [13.40497406]
curr_Stock_Price:  101.11196172312536
curr_Factors:  [101.11196172]
mat_Sqrt:  [[0.15]]
grads:  [0.00552444]
Stock Position:  0.005524439851892597
Bond Position:  [12.84638711]


portfolio before change:  [13.40201986]
curr_Stock_Price:  100.43187062170826
curr_Factors:  [100.43187062]
mat_Sqrt:  [[0.15]]
grads:  [0.53134478]
Stock Position:  0.5313447847940199
Bond Position:  [-39.96193082]


portfolio before change:  [13.92159208]
curr_Stock_Price:  101.414415163446
curr_Factors:  [101.41441516]
mat_Sqrt:  [[0.15]]
grads:  [-0.0870396]
Stock Position:  -0.08703960312826282
Bond Position:  [22.74866253]


portfolio before change:  [13.88622889]
curr_Stock_Price:  101.83703918216774
curr_Factors:  [101.83703918]
mat_Sqrt:  [[0.15]]
grads:  [0.05559091]
Stock Position:  0.05559091077588209
Bond Position:  [8.22501513]


portfolio before change:  [13.87413426]
curr_Stock_Price:  101.61022676113097
curr_Factors:  [101.61022676]
mat_Sqrt:  [[0.15]]
grads:  [-0.01746768]
Stock Position:  -0.01746767895177337
Bond Position:  [15.64902908]


portfolio before change:  [13.86878507]
curr_Stock_Price:  101.97245458673403
curr_Factors:  [101.97245459]
mat_Sqrt:  [[0.15]]
grads:  [0.11329117]
Stock Position:  0.11329117341417477
Bond Position:  [2.31620604]


portfolio before change:  [13.78293031]
curr_Stock_Price:  101.21335279843674
curr_Factors:  [101.2133528]
mat_Sqrt:  [[0.15]]
grads:  [0.03938552]
Stock Position:  0.039385516393686294
Bond Position:  [9.79659014]


portfolio before change:  [13.78310715]
curr_Stock_Price:  101.20229629297081
curr_Factors:  [101.20229629]
mat_Sqrt:  [[0.15]]
grads:  [0.08144018]
Stock Position:  0.08144017522725623
Bond Position:  [5.5411744]


portfolio before change:  [13.76316824]
curr_Stock_Price:  100.95321480535544
curr_Factors:  [100.95321481]
mat_Sqrt:  [[0.15]]
grads:  [-5.43319417e-05]
Stock Position:  -5.4331941748281265e-05
Bond Position:  [13.76865323]


portfolio before change:  [13.76410051]
curr_Stock_Price:  99.63349917851471
curr_Factors:  [99.63349918]
mat_Sqrt:  [[0.15]]
grads:  [0.01820659]
Stock Position:  0.018206590869952917
Bond Position:  [11.95011416]


portfolio before change:  [13.77211681]
curr_Stock_Price:  100.0327716742065
curr_Factors:  [100.03277167]
mat_Sqrt:  [[0.15]]
grads:  [-0.15519099]
Stock Position:  -0.15519098858466945
Bond Position:  [29.29630154]


portfolio before change:  [13.65396592]
curr_Stock_Price:  100.8058962443781
curr_Factors:  [100.80589624]
mat_Sqrt:  [[0.15]]
grads:  [-0.0334014]
Stock Position:  -0.03340139626177407
Bond Position:  [17.0210236]


portfolio before change:  [13.69877139]
curr_Stock_Price:  99.49632142921507
curr_Factors:  [99.49632143]
mat_Sqrt:  [[0.15]]
grads:  [-0.0567786]
Stock Position:  -0.056778603054035336
Bond Position:  [19.34803353]


portfolio before change:  [13.7188995]
curr_Stock_Price:  99.16311822340617
curr_Factors:  [99.16311822]
mat_Sqrt:  [[0.15]]
grads:  [0.10512199]
Stock Position:  0.10512199418476235
Bond Position:  [3.29467476]


portfolio before change:  [13.70258198]
curr_Stock_Price:  99.00593471975148
curr_Factors:  [99.00593472]
mat_Sqrt:  [[0.15]]
grads:  [0.13165857]
Stock Position:  0.13165857213101895
Bond Position:  [0.66760198]


portfolio before change:  [13.73478262]
curr_Stock_Price:  99.25019468020389
curr_Factors:  [99.25019468]
mat_Sqrt:  [[0.15]]
grads:  [-0.05950669]
Stock Position:  -0.05950668635541599
Bond Position:  [19.64083283]


portfolio before change:  [13.76941366]
curr_Stock_Price:  98.68885520557458
curr_Factors:  [98.68885521]
mat_Sqrt:  [[0.15]]
grads:  [0.04175049]
Stock Position:  0.041750489357134754
Bond Position:  [9.64910566]


portfolio before change:  [13.78523368]
curr_Stock_Price:  99.0533281973398
curr_Factors:  [99.0533282]
mat_Sqrt:  [[0.15]]
grads:  [-0.01509081]
Stock Position:  -0.015090812910844449
Bond Position:  [15.28002892]


portfolio before change:  [13.78109594]
curr_Stock_Price:  99.39080286122423
curr_Factors:  [99.39080286]
mat_Sqrt:  [[0.15]]
grads:  [0.07590308]
Stock Position:  0.07590307842887399
Bond Position:  [6.23702804]


portfolio before change:  [13.79175619]
curr_Stock_Price:  99.52611251503325
curr_Factors:  [99.52611252]
mat_Sqrt:  [[0.15]]
grads:  [0.00068753]
Stock Position:  0.0006875327379230346
Bond Position:  [13.72332873]


portfolio before change:  [13.7927967]
curr_Stock_Price:  99.79195571600485
curr_Factors:  [99.79195572]
mat_Sqrt:  [[0.15]]
grads:  [-0.09208758]
Stock Position:  -0.09208758041908016
Bond Position:  [22.98239644]


portfolio before change:  [13.84627809]
curr_Stock_Price:  99.22678775508923
curr_Factors:  [99.22678776]
mat_Sqrt:  [[0.15]]
grads:  [0.01242669]
Stock Position:  0.012426685439601431
Bond Position:  [12.61321801]


portfolio before change:  [13.85060115]
curr_Stock_Price:  99.51123246681253
curr_Factors:  [99.51123247]
mat_Sqrt:  [[0.15]]
grads:  [-0.01775739]
Stock Position:  -0.017757394849063014
Bond Position:  [15.61766139]


portfolio before change:  [13.8729467]
curr_Stock_Price:  98.30782311051607
curr_Factors:  [98.30782311]
mat_Sqrt:  [[0.15]]
grads:  [0.02512402]
Stock Position:  0.025124019581359576
Bond Position:  [11.40305902]


portfolio before change:  [13.8808551]
curr_Stock_Price:  98.59422993285239
curr_Factors:  [98.59422993]
mat_Sqrt:  [[0.15]]
grads:  [-0.05214831]
Stock Position:  -0.0521483147121665
Bond Position:  [19.02237803]


portfolio before change:  [13.86588907]
curr_Stock_Price:  98.90401878648055
curr_Factors:  [98.90401879]
mat_Sqrt:  [[0.15]]
grads:  [0.01495865]
Stock Position:  0.014958650656501852
Bond Position:  [12.3864184]


portfolio before change:  [13.87025873]
curr_Stock_Price:  99.14438015223148
curr_Factors:  [99.14438015]
mat_Sqrt:  [[0.15]]
grads:  [-0.01979966]
Stock Position:  -0.01979966217620632
Bond Position:  [15.83328396]


portfolio before change:  [13.86018073]
curr_Stock_Price:  99.70335965236603
curr_Factors:  [99.70335965]
mat_Sqrt:  [[0.15]]
grads:  [-0.09129045]
Stock Position:  -0.09129044729490651
Bond Position:  [22.96214503]


portfolio before change:  [13.83539091]
curr_Stock_Price:  99.99062957932229
curr_Factors:  [99.99062958]
mat_Sqrt:  [[0.15]]
grads:  [-0.03333655]
Stock Position:  -0.03333655053369126
Bond Position:  [17.16873359]


portfolio before change:  [13.81348646]
curr_Stock_Price:  100.67988889561168
curr_Factors:  [100.6798889]
mat_Sqrt:  [[0.15]]
grads:  [-4.27947248e-06]
Stock Position:  -4.279472475858179e-06
Bond Position:  [13.81391732]


portfolio before change:  [13.81434716]
curr_Stock_Price:  101.31035970689227
curr_Factors:  [101.31035971]
mat_Sqrt:  [[0.15]]
grads:  [0.00886137]
Stock Position:  0.008861371627270331
Bond Position:  [12.91659841]


portfolio before change:  [13.81973853]
curr_Stock_Price:  101.82766695467514
curr_Factors:  [101.82766695]
mat_Sqrt:  [[0.15]]
grads:  [-0.0208215]
Stock Position:  -0.02082149632193396
Bond Position:  [15.93994292]


portfolio before change:  [13.83525252]
curr_Stock_Price:  101.13042044536274
curr_Factors:  [101.13042045]
mat_Sqrt:  [[0.15]]
grads:  [0.02527565]
Stock Position:  0.025275648128247247
Bond Position:  [11.2791156]


portfolio before change:  [13.86279497]
curr_Stock_Price:  102.19221253057628
curr_Factors:  [102.19221253]
mat_Sqrt:  [[0.15]]
grads:  [0.00467175]
Stock Position:  0.004671752936331475
Bond Position:  [13.3853782]


portfolio before change:  [13.86496036]
curr_Stock_Price:  102.47664108383118
curr_Factors:  [102.47664108]
mat_Sqrt:  [[0.15]]
grads:  [0.02183604]
Stock Position:  0.02183603674107524
Bond Position:  [11.62727666]


portfolio before change:  [13.87762993]
curr_Stock_Price:  103.0235739324374
curr_Factors:  [103.02357393]
mat_Sqrt:  [[0.15]]
grads:  [-0.02726141]
Stock Position:  -0.027261409424955814
Bond Position:  [16.68619776]


portfolio before change:  [13.87220878]
curr_Stock_Price:  103.26068829442792
curr_Factors:  [103.26068829]
mat_Sqrt:  [[0.15]]
grads:  [0.06325481]
Stock Position:  0.06325480582702897
Bond Position:  [7.340474]


portfolio before change:  [13.86425744]
curr_Stock_Price:  103.12773175703863
curr_Factors:  [103.12773176]
mat_Sqrt:  [[0.15]]
grads:  [-0.02624075]
Stock Position:  -0.026240746545052325
Bond Position:  [16.57040611]


portfolio before change:  [13.84353652]
curr_Stock_Price:  103.95684683351105
curr_Factors:  [103.95684683]
mat_Sqrt:  [[0.15]]
grads:  [-0.05942317]
Stock Position:  -0.05942317010657904
Bond Position:  [20.02098191]


portfolio before change:  [13.85262824]
curr_Stock_Price:  103.8249055908831
curr_Factors:  [103.82490559]
mat_Sqrt:  [[0.15]]
grads:  [0.10741311]
Stock Position:  0.10741310664999881
Bond Position:  [2.70047258]


portfolio before change:  [13.8895766]
curr_Stock_Price:  104.16731797243142
curr_Factors:  [104.16731797]
mat_Sqrt:  [[0.15]]
grads:  [-0.00890473]
Stock Position:  -0.008904731831805072
Bond Position:  [14.81715863]


portfolio before change:  [13.89464882]
curr_Stock_Price:  103.70170991194112
curr_Factors:  [103.70170991]
mat_Sqrt:  [[0.15]]
grads:  [0.08427444]
Stock Position:  0.08427443731078453
Bond Position:  [5.15524557]


portfolio before change:  [13.95588877]
curr_Stock_Price:  104.42455947972279
curr_Factors:  [104.42455948]
mat_Sqrt:  [[0.15]]
grads:  [-0.09817291]
Stock Position:  -0.09817291435271941
Bond Position:  [24.20755211]


portfolio before change:  [14.01414098]
curr_Stock_Price:  103.84660787456853
curr_Factors:  [103.84660787]
mat_Sqrt:  [[0.15]]
grads:  [-0.08504701]
Stock Position:  -0.08504701364431126
Bond Position:  [22.84598486]


portfolio before change:  [13.98718281]
curr_Stock_Price:  104.18037733906947
curr_Factors:  [104.18037734]
mat_Sqrt:  [[0.15]]
grads:  [-0.02226104]
Stock Position:  -0.022261037139676774
Bond Position:  [16.30634606]


portfolio before change:  [13.97995488]
curr_Stock_Price:  104.55084978542271
curr_Factors:  [104.55084979]
mat_Sqrt:  [[0.15]]
grads:  [0.2374831]
Stock Position:  0.2374830985433015
Bond Position:  [-10.84910488]


portfolio before change:  [13.74906412]
curr_Stock_Price:  103.58146428287131
curr_Factors:  [103.58146428]
mat_Sqrt:  [[0.15]]
grads:  [-0.12279776]
Stock Position:  -0.12279776377789149
Bond Position:  [26.4686363]


portfolio before change:  [13.70858641]
curr_Stock_Price:  103.92456541817367
curr_Factors:  [103.92456542]
mat_Sqrt:  [[0.15]]
grads:  [0.14012193]
Stock Position:  0.1401219333368524
Bond Position:  [-0.85352462]


portfolio before change:  [13.74192529]
curr_Stock_Price:  104.16287379676494
curr_Factors:  [104.1628738]
mat_Sqrt:  [[0.15]]
grads:  [0.02662151]
Stock Position:  0.02662151027662967
Bond Position:  [10.96895228]


portfolio before change:  [13.73910803]
curr_Stock_Price:  104.0312943674799
curr_Factors:  [104.03129437]
mat_Sqrt:  [[0.15]]
grads:  [0.06910355]
Stock Position:  0.06910354692613618
Bond Position:  [6.5501766]


portfolio before change:  [13.71227828]
curr_Stock_Price:  103.63711566875236
curr_Factors:  [103.63711567]
mat_Sqrt:  [[0.15]]
grads:  [-0.13397505]
Stock Position:  -0.13397505168464144
Bond Position:  [27.59706621]


portfolio before change:  [13.78025019]
curr_Stock_Price:  103.14264271610934
curr_Factors:  [103.14264272]
mat_Sqrt:  [[0.15]]
grads:  [-0.05159366]
Stock Position:  -0.05159366053754454
Bond Position:  [19.10175669]


portfolio before change:  [13.73245705]
curr_Stock_Price:  104.09212069514817
curr_Factors:  [104.0921207]
mat_Sqrt:  [[0.15]]
grads:  [-0.04701902]
Stock Position:  -0.04701901787484048
Bond Position:  [18.62676633]


portfolio before change:  [13.69953144]
curr_Stock_Price:  104.81714248222919
curr_Factors:  [104.81714248]
mat_Sqrt:  [[0.15]]
grads:  [0.0505494]
Stock Position:  0.050549398954149394
Bond Position:  [8.40108789]


portfolio before change:  [13.71815698]
curr_Stock_Price:  105.17521705882956
curr_Factors:  [105.17521706]
mat_Sqrt:  [[0.15]]
grads:  [0.04185844]
Stock Position:  0.04185843785308512
Bond Position:  [9.3156867]


portfolio before change:  [13.72286579]
curr_Stock_Price:  105.273800704217
curr_Factors:  [105.2738007]
mat_Sqrt:  [[0.15]]
grads:  [-0.00493493]
Stock Position:  -0.004934930496543177
Bond Position:  [14.24238468]


portfolio before change:  [13.72449726]
curr_Stock_Price:  105.12358696107857
curr_Factors:  [105.12358696]
mat_Sqrt:  [[0.15]]
grads:  [-0.01283662]
Stock Position:  -0.01283661692081162
Bond Position:  [15.07392847]


portfolio before change:  [13.72410317]
curr_Stock_Price:  105.22768305921647
curr_Factors:  [105.22768306]
mat_Sqrt:  [[0.15]]
grads:  [0.05217919]
Stock Position:  0.052179186524343356
Bond Position:  [8.23340827]


portfolio before change:  [13.73724337]
curr_Stock_Price:  105.46964929240055
curr_Factors:  [105.46964929]
mat_Sqrt:  [[0.15]]
grads:  [-0.02268492]
Stock Position:  -0.022684915668077454
Bond Position:  [16.12981347]


portfolio before change:  [13.72898721]
curr_Stock_Price:  105.87804016769783
curr_Factors:  [105.87804017]
mat_Sqrt:  [[0.15]]
grads:  [0.14736649]
Stock Position:  0.14736649498854484
Bond Position:  [-1.87388847]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.72898721]
Stock Price:  105.15116461061899
PL:  [8.5778226]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.73017834e-02]
 [ 8.75235806e-04]
 [-1.08380160e-03]
 [ 5.08032625e-04]
 [ 1.85220748e-02]
 [ 1.18197400e-02]
 [ 6.81348089e-04]
 [ 6.42639306e-03]
 [-4.16337782e-03]
 [-1.45248859e-02]
 [ 9.98203975e-03]
 [-7.88438173e-03]
 [ 1.87608665e-02]
 [ 9.53707481e-03]
 [-2.85481367e-03]
 [-1.01112489e-02]
 [ 1.20439655e-02]
 [ 2.10157044e-02]
 [ 1.92163815e-02]
 [ 1.29113444e-03]
 [ 7.91949821e-02]
 [-1.42873008e-02]
 [-2.82896079e-03]
 [ 1.40049914e-02]
 [ 8.35585413e-03]
 [ 7.05416085e-03]
 [ 1.36711404e-02]
 [-1.60576745e-02]
 [ 1.59936602e-03]
 [-6.40867256e-03]
 [-3.53958886e-03]
 [-1.59207780e-02]
 [ 1.54037512e-02]
 [ 1.95300167e-02]
 [-1.22630245e-02]
 [ 6.06202305e-03]
 [-2.33808177e-03]
 [ 1.07978181e-02]
 [ 2.69374034e-03]
 [-1.48249327e-02]
 [ 3.27395972e-02]
 [ 1.59923445e-04]
 [ 5.15247646e-03]
 [-8.40460799e-03]
 [ 5.76481986e-04]
 [-6.77015795e-03]
 [-1.35566877e-02]
 [-3.93028077e-04]
 [-5.98336312e-03]
 [ 7.13473741e-03]
 [-3.15736970e-03]
 [ 3.23209612e-03]
 [ 2.20749570e-03]
 [-2.24154931e-03]
 [ 2.16958597e-03]
 [ 8.81251871e-03]
 [ 1.60993183e-02]
 [-2.22811799e-02]
 [ 1.40178730e-02]
 [ 5.79838564e-03]
 [ 7.85703950e-03]
 [-1.25892845e-02]
 [-1.26339183e-02]
 [-1.07006694e-03]
 [-1.13912813e-02]
 [-5.85316687e-03]
 [ 1.03153246e-02]
 [ 2.32415869e-03]
 [ 9.78128309e-03]
 [-1.72705861e-02]
 [-2.25876903e-03]
 [-8.26907537e-04]
 [ 1.52976252e-03]
 [ 8.38075452e-03]
 [ 3.47419625e-03]
 [ 2.60595919e-03]
 [ 5.71581501e-03]
 [-1.19477818e-02]
 [-3.11373564e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.66669515]
curr_Stock_Price:  99.56725648515837
curr_Factors:  [99.56725649]
mat_Sqrt:  [[0.15]]
grads:  [-0.24867856]
Stock Position:  -0.24867855576245343
Bond Position:  [20.0935464]


portfolio before change:  [-4.67458831]
curr_Stock_Price:  99.60404712740961
curr_Factors:  [99.60404713]
mat_Sqrt:  [[0.15]]
grads:  [0.00583491]
Stock Position:  0.005834905370803457
Bond Position:  [-5.25576849]


portfolio before change:  [-4.67920875]
curr_Stock_Price:  98.8684821446927
curr_Factors:  [98.86848214]
mat_Sqrt:  [[0.15]]
grads:  [-0.00722534]
Stock Position:  -0.007225343995329968
Bond Position:  [-3.96484996]


portfolio before change:  [-4.6824184]
curr_Stock_Price:  99.27840539565258
curr_Factors:  [99.2784054]
mat_Sqrt:  [[0.15]]
grads:  [0.00338688]
Stock Position:  0.0033868841693201965
Bond Position:  [-5.01866286]


portfolio before change:  [-4.68090245]
curr_Stock_Price:  99.81861362392324
curr_Factors:  [99.81861362]
mat_Sqrt:  [[0.15]]
grads:  [0.1234805]
Stock Position:  0.12348049895484256
Bond Position:  [-17.00655467]


portfolio before change:  [-4.62320408]
curr_Stock_Price:  100.29448891816497
curr_Factors:  [100.29448892]
mat_Sqrt:  [[0.15]]
grads:  [0.07879827]
Stock Position:  0.0787982667121946
Bond Position:  [-12.52623597]


portfolio before change:  [-4.57945901]
curr_Stock_Price:  100.85957728968648
curr_Factors:  [100.85957729]
mat_Sqrt:  [[0.15]]
grads:  [0.00454232]
Stock Position:  0.004542320593335263
Bond Position:  [-5.03759554]


portfolio before change:  [-4.57758905]
curr_Stock_Price:  101.34056850747469
curr_Factors:  [101.34056851]
mat_Sqrt:  [[0.15]]
grads:  [0.04284262]
Stock Position:  0.04284262037705443
Bond Position:  [-8.91928456]


portfolio before change:  [-4.58758998]
curr_Stock_Price:  101.12014655300004
curr_Factors:  [101.12014655]
mat_Sqrt:  [[0.15]]
grads:  [-0.02775585]
Stock Position:  -0.027755852149742022
Bond Position:  [-1.78091414]


portfolio before change:  [-4.59856027]
curr_Stock_Price:  101.51137876493003
curr_Factors:  [101.51137876]
mat_Sqrt:  [[0.15]]
grads:  [-0.09683257]
Stock Position:  -0.09683257256404021
Bond Position:  [5.23104768]


portfolio before change:  [-4.63936281]
curr_Stock_Price:  101.93612723263556
curr_Factors:  [101.93612723]
mat_Sqrt:  [[0.15]]
grads:  [0.06654693]
Stock Position:  0.0665469316933951
Bond Position:  [-11.4228993]


portfolio before change:  [-4.68285536]
curr_Stock_Price:  101.29329372986886
curr_Factors:  [101.29329373]
mat_Sqrt:  [[0.15]]
grads:  [-0.05256254]
Stock Position:  -0.052562544876399976
Bond Position:  [0.64137794]


portfolio before change:  [-4.71554188]
curr_Stock_Price:  101.91591600379637
curr_Factors:  [101.915916]
mat_Sqrt:  [[0.15]]
grads:  [0.12507244]
Stock Position:  0.12507244317155924
Bond Position:  [-17.4624145]


portfolio before change:  [-4.68050758]
curr_Stock_Price:  102.20475450135548
curr_Factors:  [102.2047545]
mat_Sqrt:  [[0.15]]
grads:  [0.0635805]
Stock Position:  0.06358049871677296
Bond Position:  [-11.17873684]


portfolio before change:  [-4.68296291]
curr_Stock_Price:  102.17712599741655
curr_Factors:  [102.177126]
mat_Sqrt:  [[0.15]]
grads:  [-0.01903209]
Stock Position:  -0.01903209113727942
Bond Position:  [-2.73831853]


portfolio before change:  [-4.6729408]
curr_Stock_Price:  101.64154332704194
curr_Factors:  [101.64154333]
mat_Sqrt:  [[0.15]]
grads:  [-0.06740833]
Stock Position:  -0.06740832621641511
Bond Position:  [2.17854551]


portfolio before change:  [-4.65427357]
curr_Stock_Price:  101.36663559404177
curr_Factors:  [101.36663559]
mat_Sqrt:  [[0.15]]
grads:  [0.0802931]
Stock Position:  0.08029310356576252
Bond Position:  [-12.79331534]


portfolio before change:  [-4.66547765]
curr_Stock_Price:  101.23705439903462
curr_Factors:  [101.2370544]
mat_Sqrt:  [[0.15]]
grads:  [0.1401047]
Stock Position:  0.14010469625084865
Bond Position:  [-18.84926441]


portfolio before change:  [-4.68653071]
curr_Stock_Price:  101.09519656810232
curr_Factors:  [101.09519657]
mat_Sqrt:  [[0.15]]
grads:  [0.12810921]
Stock Position:  0.12810920967974224
Bond Position:  [-17.63775645]


portfolio before change:  [-4.70402679]
curr_Stock_Price:  100.96723012222876
curr_Factors:  [100.96723012]
mat_Sqrt:  [[0.15]]
grads:  [0.00860756]
Stock Position:  0.008607562944386355
Bond Position:  [-5.57310858]


portfolio before change:  [-4.70937966]
curr_Stock_Price:  100.3858181738227
curr_Factors:  [100.38581817]
mat_Sqrt:  [[0.15]]
grads:  [0.52796655]
Stock Position:  0.5279665470464872
Bond Position:  [-57.70973345]


portfolio before change:  [-4.93849957]
curr_Stock_Price:  99.95868327748657
curr_Factors:  [99.95868328]
mat_Sqrt:  [[0.15]]
grads:  [-0.09524867]
Stock Position:  -0.0952486719084097
Bond Position:  [4.58243226]


portfolio before change:  [-4.93953323]
curr_Stock_Price:  99.97254249119324
curr_Factors:  [99.97254249]
mat_Sqrt:  [[0.15]]
grads:  [-0.01885974]
Stock Position:  -0.018859738603258853
Bond Position:  [-3.05407721]


portfolio before change:  [-4.92577861]
curr_Stock_Price:  99.23310979691743
curr_Factors:  [99.2331098]
mat_Sqrt:  [[0.15]]
grads:  [0.09336661]
Stock Position:  0.09336660947364628
Bond Position:  [-14.19083761]


portfolio before change:  [-4.93450246]
curr_Stock_Price:  99.14917296832016
curr_Factors:  [99.14917297]
mat_Sqrt:  [[0.15]]
grads:  [0.05570569]
Stock Position:  0.055705694233302294
Bond Position:  [-10.45767597]


portfolio before change:  [-4.96705487]
curr_Stock_Price:  98.57654229213038
curr_Factors:  [98.57654229]
mat_Sqrt:  [[0.15]]
grads:  [0.04702774]
Stock Position:  0.047027738973269125
Bond Position:  [-9.60288677]


portfolio before change:  [-4.98372612]
curr_Stock_Price:  98.23480678551412
curr_Factors:  [98.23480679]
mat_Sqrt:  [[0.15]]
grads:  [0.09114094]
Stock Position:  0.09114093587007112
Bond Position:  [-13.93693835]


portfolio before change:  [-4.96440979]
curr_Stock_Price:  98.45630344067145
curr_Factors:  [98.45630344]
mat_Sqrt:  [[0.15]]
grads:  [-0.10705116]
Stock Position:  -0.10705116312480556
Bond Position:  [5.57545201]


portfolio before change:  [-4.93532516]
curr_Stock_Price:  98.18786963064849
curr_Factors:  [98.18786963]
mat_Sqrt:  [[0.15]]
grads:  [0.01066244]
Stock Position:  0.010662440122524248
Bond Position:  [-5.98224745]


portfolio before change:  [-4.93709577]
curr_Stock_Price:  98.05687700229176
curr_Factors:  [98.056877]
mat_Sqrt:  [[0.15]]
grads:  [-0.04272448]
Stock Position:  -0.042724483738280736
Bond Position:  [-0.74766632]


portfolio before change:  [-4.92470683]
curr_Stock_Price:  97.76581043382892
curr_Factors:  [97.76581043]
mat_Sqrt:  [[0.15]]
grads:  [-0.02359726]
Stock Position:  -0.02359725904807763
Bond Position:  [-2.61770167]


portfolio before change:  [-4.93693252]
curr_Stock_Price:  98.27697487732041
curr_Factors:  [98.27697488]
mat_Sqrt:  [[0.15]]
grads:  [-0.10613852]
Stock Position:  -0.10613852004227556
Bond Position:  [5.49404015]


portfolio before change:  [-5.00542049]
curr_Stock_Price:  98.92547982795979
curr_Factors:  [98.92547983]
mat_Sqrt:  [[0.15]]
grads:  [0.10269167]
Stock Position:  0.10269167487236516
Bond Position:  [-15.1642437]


portfolio before change:  [-5.01753977]
curr_Stock_Price:  98.81669311332627
curr_Factors:  [98.81669311]
mat_Sqrt:  [[0.15]]
grads:  [0.13020011]
Stock Position:  0.13020011143673355
Bond Position:  [-17.88348423]


portfolio before change:  [-4.99442124]
curr_Stock_Price:  99.00283958076989
curr_Factors:  [99.00283958]
mat_Sqrt:  [[0.15]]
grads:  [-0.0817535]
Stock Position:  -0.08175349643306044
Bond Position:  [3.09940706]


portfolio before change:  [-4.97339768]
curr_Stock_Price:  98.74805130888275
curr_Factors:  [98.74805131]
mat_Sqrt:  [[0.15]]
grads:  [0.04041349]
Stock Position:  0.04041348699012941
Bond Position:  [-8.96415077]


portfolio before change:  [-4.97561922]
curr_Stock_Price:  98.7069446510853
curr_Factors:  [98.70694465]
mat_Sqrt:  [[0.15]]
grads:  [-0.01558721]
Stock Position:  -0.015587211829002572
Bond Position:  [-3.43705317]


portfolio before change:  [-4.97728707]
curr_Stock_Price:  98.80016355177331
curr_Factors:  [98.80016355]
mat_Sqrt:  [[0.15]]
grads:  [0.07198545]
Stock Position:  0.07198545418557457
Bond Position:  [-12.08946172]


portfolio before change:  [-4.99340054]
curr_Stock_Price:  98.58681694837541
curr_Factors:  [98.58681695]
mat_Sqrt:  [[0.15]]
grads:  [0.01795827]
Stock Position:  0.017958268963835414
Bond Position:  [-6.76384911]


portfolio before change:  [-5.00235753]
curr_Stock_Price:  98.11159097326039
curr_Factors:  [98.11159097]
mat_Sqrt:  [[0.15]]
grads:  [-0.09883288]
Stock Position:  -0.09883288488577281
Bond Position:  [4.69429405]


portfolio before change:  [-4.96669132]
curr_Stock_Price:  97.75368576054603
curr_Factors:  [97.75368576]
mat_Sqrt:  [[0.15]]
grads:  [0.21826398]
Stock Position:  0.218263981589639
Bond Position:  [-26.30279999]


portfolio before change:  [-5.1100497]
curr_Stock_Price:  97.10440590803458
curr_Factors:  [97.10440591]
mat_Sqrt:  [[0.15]]
grads:  [0.00106616]
Stock Position:  0.0010661563017182042
Bond Position:  [-5.21357818]


portfolio before change:  [-5.10983198]
curr_Stock_Price:  97.61425420335583
curr_Factors:  [97.6142542]
mat_Sqrt:  [[0.15]]
grads:  [0.03434984]
Stock Position:  0.03434984309612525
Bond Position:  [-8.4628663]


portfolio before change:  [-5.1063313]
curr_Stock_Price:  97.73156551980193
curr_Factors:  [97.73156552]
mat_Sqrt:  [[0.15]]
grads:  [-0.05603072]
Stock Position:  -0.05603071991663792
Bond Position:  [0.36963867]


portfolio before change:  [-5.08404534]
curr_Stock_Price:  97.33423238553094
curr_Factors:  [97.33423239]
mat_Sqrt:  [[0.15]]
grads:  [0.00384321]
Stock Position:  0.003843213242215155
Bond Position:  [-5.45812155]


portfolio before change:  [-5.08479427]
curr_Stock_Price:  97.228126950067
curr_Factors:  [97.22812695]
mat_Sqrt:  [[0.15]]
grads:  [-0.04513439]
Stock Position:  -0.04513438636040468
Bond Position:  [-0.69646242]


portfolio before change:  [-5.09580069]
curr_Stock_Price:  97.4710213553735
curr_Factors:  [97.47102136]
mat_Sqrt:  [[0.15]]
grads:  [-0.09037792]
Stock Position:  -0.09037791788684117
Bond Position:  [3.71342728]


portfolio before change:  [-5.06314716]
curr_Stock_Price:  97.11228956518069
curr_Factors:  [97.11228957]
mat_Sqrt:  [[0.15]]
grads:  [-0.00262019]
Stock Position:  -0.0026201871782050024
Bond Position:  [-4.80869478]


portfolio before change:  [-5.06586778]
curr_Stock_Price:  98.03591265695525
curr_Factors:  [98.03591266]
mat_Sqrt:  [[0.15]]
grads:  [-0.03988909]
Stock Position:  -0.03988908743374779
Bond Position:  [-1.15530469]


portfolio before change:  [-5.07126075]
curr_Stock_Price:  98.16930153608989
curr_Factors:  [98.16930154]
mat_Sqrt:  [[0.15]]
grads:  [0.04756492]
Stock Position:  0.047564916084148715
Bond Position:  [-9.74067534]


portfolio before change:  [-5.05396051]
curr_Stock_Price:  98.5458194523329
curr_Factors:  [98.54581945]
mat_Sqrt:  [[0.15]]
grads:  [-0.02104913]
Stock Position:  -0.02104913130557125
Bond Position:  [-2.97965662]


portfolio before change:  [-5.05323427]
curr_Stock_Price:  98.5024694331263
curr_Factors:  [98.50246943]
mat_Sqrt:  [[0.15]]
grads:  [0.02154731]
Stock Position:  0.02154730748528468
Bond Position:  [-7.17569727]


portfolio before change:  [-5.03837146]
curr_Stock_Price:  99.21305932611921
curr_Factors:  [99.21305933]
mat_Sqrt:  [[0.15]]
grads:  [0.01471664]
Stock Position:  0.014716637981847844
Bond Position:  [-6.49845414]


portfolio before change:  [-5.03093001]
curr_Stock_Price:  99.74630759833778
curr_Factors:  [99.7463076]
mat_Sqrt:  [[0.15]]
grads:  [-0.01494366]
Stock Position:  -0.014943662086978315
Bond Position:  [-3.54035489]


portfolio before change:  [-5.03864878]
curr_Stock_Price:  100.24802445723493
curr_Factors:  [100.24802446]
mat_Sqrt:  [[0.15]]
grads:  [0.01446391]
Stock Position:  0.01446390647466697
Bond Position:  [-6.48862683]


portfolio before change:  [-5.04196291]
curr_Stock_Price:  100.04693217384158
curr_Factors:  [100.04693217]
mat_Sqrt:  [[0.15]]
grads:  [0.05875012]
Stock Position:  0.05875012473723835
Bond Position:  [-10.91973265]


portfolio before change:  [-5.0668291]
curr_Stock_Price:  99.63529573392893
curr_Factors:  [99.63529573]
mat_Sqrt:  [[0.15]]
grads:  [0.10732879]
Stock Position:  0.10732878895506377
Bond Position:  [-15.76056473]


portfolio before change:  [-5.00718913]
curr_Stock_Price:  100.20014919371651
curr_Factors:  [100.20014919]
mat_Sqrt:  [[0.15]]
grads:  [-0.1485412]
Stock Position:  -0.14854119919142092
Bond Position:  [9.87666119]


portfolio before change:  [-4.92060132]
curr_Stock_Price:  99.6213838572141
curr_Factors:  [99.62138386]
mat_Sqrt:  [[0.15]]
grads:  [0.09345249]
Stock Position:  0.09345248688917479
Bond Position:  [-14.23046739]


portfolio before change:  [-4.94514776]
curr_Stock_Price:  99.3682390933368
curr_Factors:  [99.36823909]
mat_Sqrt:  [[0.15]]
grads:  [0.0386559]
Stock Position:  0.038655904277992266
Bond Position:  [-8.7863169]


portfolio before change:  [-4.90571472]
curr_Stock_Price:  100.40254964681229
curr_Factors:  [100.40254965]
mat_Sqrt:  [[0.15]]
grads:  [0.05238026]
Stock Position:  0.0523802633070243
Bond Position:  [-10.1648267]


portfolio before change:  [-4.95072795]
curr_Stock_Price:  99.5553238006652
curr_Factors:  [99.5553238]
mat_Sqrt:  [[0.15]]
grads:  [-0.08392856]
Stock Position:  -0.08392856321013566
Bond Position:  [3.40480734]


portfolio before change:  [-4.84604312]
curr_Stock_Price:  98.31055064317867
curr_Factors:  [98.31055064]
mat_Sqrt:  [[0.15]]
grads:  [-0.08422612]
Stock Position:  -0.08422612228951268
Bond Position:  [3.43427334]


portfolio before change:  [-4.81938155]
curr_Stock_Price:  97.99655154973661
curr_Factors:  [97.99655155]
mat_Sqrt:  [[0.15]]
grads:  [-0.00713378]
Stock Position:  -0.007133779577739433
Bond Position:  [-4.12029575]


portfolio before change:  [-4.82274896]
curr_Stock_Price:  98.43248963336582
curr_Factors:  [98.43248963]
mat_Sqrt:  [[0.15]]
grads:  [-0.07594188]
Stock Position:  -0.07594187536963393
Bond Position:  [2.6523989]


portfolio before change:  [-4.82162101]
curr_Stock_Price:  98.41981977426978
curr_Factors:  [98.41981977]
mat_Sqrt:  [[0.15]]
grads:  [-0.03902111]
Stock Position:  -0.03902111244162588
Bond Position:  [-0.98117015]


portfolio before change:  [-4.81231274]
curr_Stock_Price:  98.17970384066372
curr_Factors:  [98.17970384]
mat_Sqrt:  [[0.15]]
grads:  [0.06876883]
Stock Position:  0.06876883062831436
Bond Position:  [-11.56401616]


portfolio before change:  [-4.81139732]
curr_Stock_Price:  98.20352564355751
curr_Factors:  [98.20352564]
mat_Sqrt:  [[0.15]]
grads:  [0.01549439]
Stock Position:  0.015494391287641327
Bond Position:  [-6.33300117]


portfolio before change:  [-4.81498003]
curr_Stock_Price:  97.99784518650749
curr_Factors:  [97.99784519]
mat_Sqrt:  [[0.15]]
grads:  [0.06520855]
Stock Position:  0.06520855394035256
Bond Position:  [-11.20527781]


portfolio before change:  [-4.82168004]
curr_Stock_Price:  97.90583801614572
curr_Factors:  [97.90583802]
mat_Sqrt:  [[0.15]]
grads:  [-0.11513724]
Stock Position:  -0.11513724092252715
Bond Position:  [6.45092802]


portfolio before change:  [-4.88169866]
curr_Stock_Price:  98.43061879217618
curr_Factors:  [98.43061879]
mat_Sqrt:  [[0.15]]
grads:  [-0.01505846]
Stock Position:  -0.01505846021784148
Bond Position:  [-3.3994851]


portfolio before change:  [-4.89044967]
curr_Stock_Price:  98.99764471289132
curr_Factors:  [98.99764471]
mat_Sqrt:  [[0.15]]
grads:  [-0.00551272]
Stock Position:  -0.005512716913466202
Bond Position:  [-4.34470368]


portfolio before change:  [-4.88930629]
curr_Stock_Price:  98.74097802868742
curr_Factors:  [98.74097803]
mat_Sqrt:  [[0.15]]
grads:  [0.01019842]
Stock Position:  0.01019841679913933
Bond Position:  [-5.89630794]


portfolio before change:  [-4.89822691]
curr_Stock_Price:  97.90240727666136
curr_Factors:  [97.90240728]
mat_Sqrt:  [[0.15]]
grads:  [0.0558717]
Stock Position:  0.055871696818600255
Bond Position:  [-10.36820053]


portfolio before change:  [-4.89111956]
curr_Stock_Price:  98.041214365253
curr_Factors:  [98.04121437]
mat_Sqrt:  [[0.15]]
grads:  [0.02316131]
Stock Position:  0.02316130831467032
Bond Position:  [-7.16188235]


portfolio before change:  [-4.91405446]
curr_Stock_Price:  97.07031616861764
curr_Factors:  [97.07031617]
mat_Sqrt:  [[0.15]]
grads:  [0.01737306]
Stock Position:  0.017373061234947758
Bond Position:  [-6.60046301]


portfolio before change:  [-4.9226847]
curr_Stock_Price:  96.59730241356816
curr_Factors:  [96.59730241]
mat_Sqrt:  [[0.15]]
grads:  [0.03810543]
Stock Position:  0.03810543340054799
Bond Position:  [-8.60356678]


portfolio before change:  [-4.93981818]
curr_Stock_Price:  96.161780869396
curr_Factors:  [96.16178087]
mat_Sqrt:  [[0.15]]
grads:  [-0.07965188]
Stock Position:  -0.07965187843949179
Bond Position:  [2.7196483]


portfolio before change:  [-4.98645362]
curr_Stock_Price:  96.74940567921568
curr_Factors:  [96.74940568]
mat_Sqrt:  [[0.15]]
grads:  [-0.20758238]
Stock Position:  -0.2075823757919892
Bond Position:  [15.09701787]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.98645362]
Stock Price:  96.73127098308376
PL:  [-4.98645362]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.43937543e-02]
 [-2.34132611e-03]
 [ 3.09651058e-04]
 [ 2.30579853e-03]
 [ 8.74057395e-03]
 [ 1.21695494e-02]
 [-9.21857251e-04]
 [ 1.91164100e-02]
 [-1.50318371e-02]
 [ 1.33918456e-02]
 [ 9.91811210e-03]
 [-9.09879680e-03]
 [ 2.80807954e-03]
 [ 4.03007698e-03]
 [-2.35134691e-03]
 [-1.01131430e-02]
 [ 8.39752925e-03]
 [ 2.55547564e-02]
 [ 1.25328517e-02]
 [-2.77993192e-03]
 [ 1.82222531e-02]
 [-1.00540344e-02]
 [-3.29445810e-03]
 [-9.62839846e-04]
 [ 1.78925643e-02]
 [ 1.61665823e-02]
 [ 9.41776307e-03]
 [ 5.97513720e-03]
 [ 5.74595221e-03]
 [-1.72598296e-02]
 [-5.74014852e-03]
 [ 4.03388571e-02]
 [ 5.31332497e-03]
 [-7.54931831e-03]
 [-3.33582089e-03]
 [-5.87078683e-03]
 [-3.54942121e-04]
 [-3.31579023e-03]
 [ 5.98415822e-03]
 [-6.79738063e-03]
 [-4.42404273e-02]
 [-3.15463780e-03]
 [ 1.30366975e-02]
 [-1.27601121e-02]
 [-9.84575404e-04]
 [ 2.43267746e-03]
 [-1.36304588e-02]
 [ 1.02176797e-03]
 [ 2.29515637e-04]
 [-2.57873101e-03]
 [-3.23990449e-03]
 [ 3.65380066e-03]
 [ 2.29980575e-04]
 [-1.50733439e-04]
 [ 2.28645894e-03]
 [ 8.76147948e-03]
 [ 1.43537759e-02]
 [-2.23718461e-02]
 [ 1.33994521e-02]
 [ 4.97130013e-03]
 [ 9.95637048e-03]
 [-1.33403066e-02]
 [-1.25600197e-02]
 [-2.19861967e-03]
 [-2.01843769e-02]
 [ 3.78491470e-02]
 [ 1.87774709e-02]
 [ 2.27457597e-03]
 [ 8.30418028e-03]
 [-1.60029058e-02]
 [-3.25783594e-03]
 [-1.06204187e-03]
 [ 1.77567962e-03]
 [ 8.56059152e-03]
 [ 7.65969021e-03]
 [-1.85824634e-03]
 [-5.40113308e-03]
 [-9.57742226e-03]
 [-2.55238766e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.97170875]
curr_Stock_Price:  99.80473569805262
curr_Factors:  [99.8047357]
mat_Sqrt:  [[0.15]]
grads:  [-0.2292917]
Stock Position:  -0.2292916955088095
Bond Position:  [21.91268832]


portfolio before change:  [-1.03645266]
curr_Stock_Price:  100.09307364161235
curr_Factors:  [100.09307364]
mat_Sqrt:  [[0.15]]
grads:  [-0.01560884]
Stock Position:  -0.015608840755149464
Bond Position:  [0.52588419]


portfolio before change:  [-1.04394288]
curr_Stock_Price:  100.57504986630728
curr_Factors:  [100.57504987]
mat_Sqrt:  [[0.15]]
grads:  [0.00206434]
Stock Position:  0.0020643403835486746
Bond Position:  [-1.25156402]


portfolio before change:  [-1.044021]
curr_Stock_Price:  100.57510331702174
curr_Factors:  [100.57510332]
mat_Sqrt:  [[0.15]]
grads:  [0.01537199]
Stock Position:  0.015371990169106172
Bond Position:  [-2.5900605]


portfolio before change:  [-1.04501561]
curr_Stock_Price:  100.5209317403965
curr_Factors:  [100.52093174]
mat_Sqrt:  [[0.15]]
grads:  [0.05827049]
Stock Position:  0.0582704930043101
Bond Position:  [-6.90241986]


portfolio before change:  [-0.97511428]
curr_Stock_Price:  101.72793621568712
curr_Factors:  [101.72793622]
mat_Sqrt:  [[0.15]]
grads:  [0.08113033]
Stock Position:  0.0811303293873855
Bond Position:  [-9.22833525]


portfolio before change:  [-0.9044634]
curr_Stock_Price:  102.6058774934664
curr_Factors:  [102.60587749]
mat_Sqrt:  [[0.15]]
grads:  [-0.00614572]
Stock Position:  -0.006145715006608701
Bond Position:  [-0.27387692]


portfolio before change:  [-0.90513746]
curr_Stock_Price:  102.71277211128283
curr_Factors:  [102.71277211]
mat_Sqrt:  [[0.15]]
grads:  [0.12744273]
Stock Position:  0.12744273358621536
Bond Position:  [-13.99513391]


portfolio before change:  [-0.91405447]
curr_Stock_Price:  102.64966698429788
curr_Factors:  [102.64966698]
mat_Sqrt:  [[0.15]]
grads:  [-0.10021225]
Stock Position:  -0.1002122471036145
Bond Position:  [9.37269932]


portfolio before change:  [-0.89427716]
curr_Stock_Price:  102.45815841178528
curr_Factors:  [102.45815841]
mat_Sqrt:  [[0.15]]
grads:  [0.08927897]
Stock Position:  0.08927897040791513
Bond Position:  [-10.04163605]


portfolio before change:  [-0.91412461]
curr_Stock_Price:  102.24288007389153
curr_Factors:  [102.24288007]
mat_Sqrt:  [[0.15]]
grads:  [0.06612075]
Stock Position:  0.06612074733442024
Bond Position:  [-7.67450025]


portfolio before change:  [-0.9476942]
curr_Stock_Price:  101.74243324166376
curr_Factors:  [101.74243324]
mat_Sqrt:  [[0.15]]
grads:  [-0.06065865]
Stock Position:  -0.06065864533691556
Bond Position:  [5.22386398]


portfolio before change:  [-0.8891704]
curr_Stock_Price:  100.78301029281094
curr_Factors:  [100.78301029]
mat_Sqrt:  [[0.15]]
grads:  [0.01872053]
Stock Position:  0.01872053026787364
Bond Position:  [-2.77588179]


portfolio before change:  [-0.87684626]
curr_Stock_Price:  101.45059998525575
curr_Factors:  [101.45059999]
mat_Sqrt:  [[0.15]]
grads:  [0.02686718]
Stock Position:  0.026867179873919612
Bond Position:  [-3.60253778]


portfolio before change:  [-0.85976541]
curr_Stock_Price:  102.09473222719254
curr_Factors:  [102.09473223]
mat_Sqrt:  [[0.15]]
grads:  [-0.01567565]
Stock Position:  -0.015675646054001263
Bond Position:  [0.74063547]


portfolio before change:  [-0.85233614]
curr_Stock_Price:  101.62374803910917
curr_Factors:  [101.62374804]
mat_Sqrt:  [[0.15]]
grads:  [-0.06742095]
Stock Position:  -0.06742095347055765
Bond Position:  [5.99923385]


portfolio before change:  [-0.89297889]
curr_Stock_Price:  102.23213028870124
curr_Factors:  [102.23213029]
mat_Sqrt:  [[0.15]]
grads:  [0.05598353]
Stock Position:  0.055983528354759116
Bond Position:  [-6.61629425]


portfolio before change:  [-0.89831696]
curr_Stock_Price:  102.14416615146924
curr_Factors:  [102.14416615]
mat_Sqrt:  [[0.15]]
grads:  [0.17036504]
Stock Position:  0.1703650427950286
Bond Position:  [-18.3001122]


portfolio before change:  [-0.83261554]
curr_Stock_Price:  102.53653075253139
curr_Factors:  [102.53653075]
mat_Sqrt:  [[0.15]]
grads:  [0.08355234]
Stock Position:  0.0835523445932714
Bond Position:  [-9.39978309]


portfolio before change:  [-0.77674346]
curr_Stock_Price:  103.21226991036029
curr_Factors:  [103.21226991]
mat_Sqrt:  [[0.15]]
grads:  [-0.01853288]
Stock Position:  -0.018532879462138697
Bond Position:  [1.1360771]


portfolio before change:  [-0.78548473]
curr_Stock_Price:  103.68776430228446
curr_Factors:  [103.6877643]
mat_Sqrt:  [[0.15]]
grads:  [0.12148169]
Stock Position:  0.12148168729398913
Bond Position:  [-13.38164929]


portfolio before change:  [-0.76059066]
curr_Stock_Price:  103.89956947188928
curr_Factors:  [103.89956947]
mat_Sqrt:  [[0.15]]
grads:  [-0.0670269]
Stock Position:  -0.06702689607362922
Bond Position:  [6.20347499]


portfolio before change:  [-0.77025345]
curr_Stock_Price:  104.04951699767952
curr_Factors:  [104.049517]
mat_Sqrt:  [[0.15]]
grads:  [-0.02196305]
Stock Position:  -0.021963053993974326
Bond Position:  [1.51499171]


portfolio before change:  [-0.74920276]
curr_Stock_Price:  103.09536943273953
curr_Factors:  [103.09536943]
mat_Sqrt:  [[0.15]]
grads:  [-0.00641893]
Stock Position:  -0.006418932303753337
Bond Position:  [-0.08744057]


portfolio before change:  [-0.7505156]
curr_Stock_Price:  103.29904412639907
curr_Factors:  [103.29904413]
mat_Sqrt:  [[0.15]]
grads:  [0.11928376]
Stock Position:  0.11928376194217392
Bond Position:  [-13.07241419]


portfolio before change:  [-0.68701363]
curr_Stock_Price:  103.8382543684331
curr_Factors:  [103.83825437]
mat_Sqrt:  [[0.15]]
grads:  [0.10777722]
Stock Position:  0.10777721530297722
Bond Position:  [-11.87841153]


portfolio before change:  [-0.77780113]
curr_Stock_Price:  103.00278016995264
curr_Factors:  [103.00278017]
mat_Sqrt:  [[0.15]]
grads:  [0.06278509]
Stock Position:  0.06278508713942733
Bond Position:  [-7.24483966]


portfolio before change:  [-0.82988878]
curr_Stock_Price:  102.18037425349341
curr_Factors:  [102.18037425]
mat_Sqrt:  [[0.15]]
grads:  [0.03983425]
Stock Position:  0.039834248014180076
Bond Position:  [-4.90016715]


portfolio before change:  [-0.82373786]
curr_Stock_Price:  102.34247562091328
curr_Factors:  [102.34247562]
mat_Sqrt:  [[0.15]]
grads:  [0.03830635]
Stock Position:  0.03830634808132021
Bond Position:  [-4.74410436]


portfolio before change:  [-0.825793]
curr_Stock_Price:  102.29656610699885
curr_Factors:  [102.29656611]
mat_Sqrt:  [[0.15]]
grads:  [-0.11506553]
Stock Position:  -0.11506553058260756
Bond Position:  [10.94501565]


portfolio before change:  [-0.97101588]
curr_Stock_Price:  103.56459974158956
curr_Factors:  [103.56459974]
mat_Sqrt:  [[0.15]]
grads:  [-0.03826766]
Stock Position:  -0.038267656798501734
Bond Position:  [2.99215868]


portfolio before change:  [-0.96613747]
curr_Stock_Price:  103.44200543842473
curr_Factors:  [103.44200544]
mat_Sqrt:  [[0.15]]
grads:  [0.26892571]
Stock Position:  0.2689257139682096
Bond Position:  [-28.78435264]


portfolio before change:  [-0.94821044]
curr_Stock_Price:  103.51535695880807
curr_Factors:  [103.51535696]
mat_Sqrt:  [[0.15]]
grads:  [0.03542217]
Stock Position:  0.03542216649613671
Bond Position:  [-4.61494865]


portfolio before change:  [-0.91662339]
curr_Stock_Price:  104.41523117003193
curr_Factors:  [104.41523117]
mat_Sqrt:  [[0.15]]
grads:  [-0.05032879]
Stock Position:  -0.05032878875870113
Bond Position:  [4.33846873]


portfolio before change:  [-0.9502477]
curr_Stock_Price:  105.08871206205325
curr_Factors:  [105.08871206]
mat_Sqrt:  [[0.15]]
grads:  [-0.02223881]
Stock Position:  -0.022238805931885458
Bond Position:  [1.38679977]


portfolio before change:  [-0.95208043]
curr_Stock_Price:  105.17502077866675
curr_Factors:  [105.17502078]
mat_Sqrt:  [[0.15]]
grads:  [-0.03913858]
Stock Position:  -0.03913857885577326
Bond Position:  [3.16432042]


portfolio before change:  [-0.98791935]
curr_Stock_Price:  106.09576702518422
curr_Factors:  [106.09576703]
mat_Sqrt:  [[0.15]]
grads:  [-0.00236628]
Stock Position:  -0.0023662808053539117
Bond Position:  [-0.73686697]


portfolio before change:  [-0.98640588]
curr_Stock_Price:  105.43670487394212
curr_Factors:  [105.43670487]
mat_Sqrt:  [[0.15]]
grads:  [-0.02210527]
Stock Position:  -0.02210526819373195
Bond Position:  [1.34430076]


portfolio before change:  [-0.97835928]
curr_Stock_Price:  105.07649293182293
curr_Factors:  [105.07649293]
mat_Sqrt:  [[0.15]]
grads:  [0.03989439]
Stock Position:  0.03989438812302247
Bond Position:  [-5.17032167]


portfolio before change:  [-0.99042105]
curr_Stock_Price:  104.78225064590531
curr_Factors:  [104.78225065]
mat_Sqrt:  [[0.15]]
grads:  [-0.04531587]
Stock Position:  -0.045315870855201064
Bond Position:  [3.75787789]


portfolio before change:  [-0.94306397]
curr_Stock_Price:  103.74238973471199
curr_Factors:  [103.74238973]
mat_Sqrt:  [[0.15]]
grads:  [-0.29493618]
Stock Position:  -0.2949361817016793
Bond Position:  [29.65432034]


portfolio before change:  [-0.83157789]
curr_Stock_Price:  103.37067328870434
curr_Factors:  [103.37067329]
mat_Sqrt:  [[0.15]]
grads:  [-0.02103092]
Stock Position:  -0.02103091867897451
Bond Position:  [1.34240234]


portfolio before change:  [-0.82450921]
curr_Stock_Price:  103.03855380918168
curr_Factors:  [103.03855381]
mat_Sqrt:  [[0.15]]
grads:  [0.08691132]
Stock Position:  0.08691131658220717
Bond Position:  [-9.77972558]


portfolio before change:  [-0.78823217]
curr_Stock_Price:  103.46298973197811
curr_Factors:  [103.46298973]
mat_Sqrt:  [[0.15]]
grads:  [-0.08506741]
Stock Position:  -0.08506741410633248
Bond Position:  [8.01309682]


portfolio before change:  [-0.75871217]
curr_Stock_Price:  103.12185831293662
curr_Factors:  [103.12185831]
mat_Sqrt:  [[0.15]]
grads:  [-0.00656384]
Stock Position:  -0.006563836026105703
Bond Position:  [-0.0818372]


portfolio before change:  [-0.75905501]
curr_Stock_Price:  103.17330994616462
curr_Factors:  [103.17330995]
mat_Sqrt:  [[0.15]]
grads:  [0.01621785]
Stock Position:  0.01621784974286346
Bond Position:  [-2.43230425]


portfolio before change:  [-0.75924116]
curr_Stock_Price:  103.17120552530882
curr_Factors:  [103.17120553]
mat_Sqrt:  [[0.15]]
grads:  [-0.09086973]
Stock Position:  -0.09086972530024925
Bond Position:  [8.61589794]


portfolio before change:  [-0.70828058]
curr_Stock_Price:  102.61632252264508
curr_Factors:  [102.61632252]
mat_Sqrt:  [[0.15]]
grads:  [0.00681179]
Stock Position:  0.006811786469455751
Bond Position:  [-1.40728106]


portfolio before change:  [-0.71270786]
curr_Stock_Price:  101.97929229179576
curr_Factors:  [101.97929229]
mat_Sqrt:  [[0.15]]
grads:  [0.0015301]
Stock Position:  0.0015301042471924172
Bond Position:  [-0.8687468]


portfolio before change:  [-0.71261006]
curr_Stock_Price:  102.07869130388774
curr_Factors:  [102.0786913]
mat_Sqrt:  [[0.15]]
grads:  [-0.01719154]
Stock Position:  -0.017191540089244516
Bond Position:  [1.04227985]


portfolio before change:  [-0.71600837]
curr_Stock_Price:  102.28015411325464
curr_Factors:  [102.28015411]
mat_Sqrt:  [[0.15]]
grads:  [-0.02159936]
Stock Position:  -0.021599363249353933
Bond Position:  [1.49317783]


portfolio before change:  [-0.71434586]
curr_Stock_Price:  102.20750454082057
curr_Factors:  [102.20750454]
mat_Sqrt:  [[0.15]]
grads:  [0.02435867]
Stock Position:  0.02435867109002405
Bond Position:  [-3.20398485]


portfolio before change:  [-0.72600945]
curr_Stock_Price:  101.73689868890808
curr_Factors:  [101.73689869]
mat_Sqrt:  [[0.15]]
grads:  [0.0015332]
Stock Position:  0.0015332038303155719
Bond Position:  [-0.88199286]


portfolio before change:  [-0.72742849]
curr_Stock_Price:  100.84731749252093
curr_Factors:  [100.84731749]
mat_Sqrt:  [[0.15]]
grads:  [-0.00100489]
Stock Position:  -0.0010048895958347879
Bond Position:  [-0.62608807]


portfolio before change:  [-0.7270586]
curr_Stock_Price:  100.44028765233354
curr_Factors:  [100.44028765]
mat_Sqrt:  [[0.15]]
grads:  [0.01524306]
Stock Position:  0.015243059607488903
Bond Position:  [-2.25807589]


portfolio before change:  [-0.73188922]
curr_Stock_Price:  100.13264046541788
curr_Factors:  [100.13264047]
mat_Sqrt:  [[0.15]]
grads:  [0.05840986]
Stock Position:  0.05840986317555061
Bond Position:  [-6.58062305]


portfolio before change:  [-0.75427427]
curr_Stock_Price:  99.75644107711942
curr_Factors:  [99.75644108]
mat_Sqrt:  [[0.15]]
grads:  [0.09569184]
Stock Position:  0.09569183949377436
Bond Position:  [-10.30015162]


portfolio before change:  [-0.71393137]
curr_Stock_Price:  100.18476065432442
curr_Factors:  [100.18476065]
mat_Sqrt:  [[0.15]]
grads:  [-0.14914564]
Stock Position:  -0.14914564093826022
Bond Position:  [14.22818897]


portfolio before change:  [-0.91037412]
curr_Stock_Price:  101.50784353426315
curr_Factors:  [101.50784353]
mat_Sqrt:  [[0.15]]
grads:  [0.08932968]
Stock Position:  0.08932968082327547
Bond Position:  [-9.97803738]


portfolio before change:  [-0.8962587]
curr_Stock_Price:  101.67283983000911
curr_Factors:  [101.67283983]
mat_Sqrt:  [[0.15]]
grads:  [0.033142]
Stock Position:  0.03314200087181693
Bond Position:  [-4.26590005]


portfolio before change:  [-0.90205141]
curr_Stock_Price:  101.50610030508821
curr_Factors:  [101.50610031]
mat_Sqrt:  [[0.15]]
grads:  [0.0663758]
Stock Position:  0.0663758032105417
Bond Position:  [-7.63960035]


portfolio before change:  [-0.91294222]
curr_Stock_Price:  101.34921606222466
curr_Factors:  [101.34921606]
mat_Sqrt:  [[0.15]]
grads:  [-0.08893538]
Stock Position:  -0.08893537712454747
Bond Position:  [8.10058853]


portfolio before change:  [-0.8823684]
curr_Stock_Price:  101.0111333444484
curr_Factors:  [101.01113334]
mat_Sqrt:  [[0.15]]
grads:  [-0.08373346]
Stock Position:  -0.08373346441694156
Bond Position:  [7.57564374]


portfolio before change:  [-0.82307562]
curr_Stock_Price:  100.308674838656
curr_Factors:  [100.30867484]
mat_Sqrt:  [[0.15]]
grads:  [-0.01465746]
Stock Position:  -0.014657464467461585
Bond Position:  [0.64719521]


portfolio before change:  [-0.83086933]
curr_Stock_Price:  100.8431573827071
curr_Factors:  [100.84315738]
mat_Sqrt:  [[0.15]]
grads:  [-0.13456251]
Stock Position:  -0.13456251241274786
Bond Position:  [12.73883929]


portfolio before change:  [-0.70178958]
curr_Stock_Price:  99.8898194258093
curr_Factors:  [99.88981943]
mat_Sqrt:  [[0.15]]
grads:  [0.25232765]
Stock Position:  0.25232764665799373
Bond Position:  [-25.90675264]


portfolio before change:  [-0.59694857]
curr_Stock_Price:  100.31173211202196
curr_Factors:  [100.31173211]
mat_Sqrt:  [[0.15]]
grads:  [0.12518314]
Stock Position:  0.12518313917252635
Bond Position:  [-13.15428609]


portfolio before change:  [-0.66565977]
curr_Stock_Price:  99.76941435601087
curr_Factors:  [99.76941436]
mat_Sqrt:  [[0.15]]
grads:  [0.01516384]
Stock Position:  0.015163839812228802
Bond Position:  [-2.17854719]


portfolio before change:  [-0.68228558]
curr_Stock_Price:  98.68198263486542
curr_Factors:  [98.68198263]
mat_Sqrt:  [[0.15]]
grads:  [0.0553612]
Stock Position:  0.05536120188359075
Bond Position:  [-6.14543874]


portfolio before change:  [-0.6723256]
curr_Stock_Price:  98.86882964197565
curr_Factors:  [98.86882964]
mat_Sqrt:  [[0.15]]
grads:  [-0.10668604]
Stock Position:  -0.10668603855995265
Bond Position:  [9.87559817]


portfolio before change:  [-0.647772]
curr_Stock_Price:  98.644466970097
curr_Factors:  [98.64446697]
mat_Sqrt:  [[0.15]]
grads:  [-0.02171891]
Stock Position:  -0.02171890624132363
Bond Position:  [1.49467793]


portfolio before change:  [-0.66523194]
curr_Stock_Price:  99.45267384249095
curr_Factors:  [99.45267384]
mat_Sqrt:  [[0.15]]
grads:  [-0.00708028]
Stock Position:  -0.007080279158289985
Bond Position:  [0.03892075]


portfolio before change:  [-0.66512621]
curr_Stock_Price:  99.43808405913691
curr_Factors:  [99.43808406]
mat_Sqrt:  [[0.15]]
grads:  [0.01183786]
Stock Position:  0.011837864127842546
Bond Position:  [-1.84226074]


portfolio before change:  [-0.67764181]
curr_Stock_Price:  98.39055986660142
curr_Factors:  [98.39055987]
mat_Sqrt:  [[0.15]]
grads:  [0.05707061]
Stock Position:  0.05707061010854209
Bond Position:  [-6.29285109]


portfolio before change:  [-0.66063387]
curr_Stock_Price:  98.69546727522392
curr_Factors:  [98.69546728]
mat_Sqrt:  [[0.15]]
grads:  [0.0510646]
Stock Position:  0.0510646013916411
Bond Position:  [-5.70047857]


portfolio before change:  [-0.67764943]
curr_Stock_Price:  98.36922812867545
curr_Factors:  [98.36922813]
mat_Sqrt:  [[0.15]]
grads:  [-0.01238831]
Stock Position:  -0.012388308936681743
Bond Position:  [0.54097895]


portfolio before change:  [-0.67763521]
curr_Stock_Price:  98.37080904239114
curr_Factors:  [98.37080904]
mat_Sqrt:  [[0.15]]
grads:  [-0.03600755]
Stock Position:  -0.036007553851817184
Bond Position:  [2.864457]


portfolio before change:  [-0.69121047]
curr_Stock_Price:  98.75279282701501
curr_Factors:  [98.75279283]
mat_Sqrt:  [[0.15]]
grads:  [-0.06384948]
Stock Position:  -0.06384948175017371
Bond Position:  [5.61410417]


portfolio before change:  [-0.5894942]
curr_Stock_Price:  97.16522495824194
curr_Factors:  [97.16522496]
mat_Sqrt:  [[0.15]]
grads:  [-0.17015918]
Stock Position:  -0.17015917753438273
Bond Position:  [15.94406057]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.5894942]
Stock Price:  98.05597354139421
PL:  [-0.5894942]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.05798074e-02]
 [ 2.66382266e-03]
 [-4.24410264e-04]
 [ 1.56628539e-03]
 [-3.78517850e-03]
 [ 7.98126182e-03]
 [ 7.95757321e-04]
 [ 1.48228266e-02]
 [ 1.77358127e-02]
 [-1.55590864e-02]
 [ 5.95114094e-03]
 [-7.13052487e-03]
 [ 2.25961226e-05]
 [ 3.88990362e-03]
 [-9.95660380e-04]
 [ 1.47218606e-02]
 [ 7.24543024e-04]
 [ 6.51143207e-03]
 [ 4.22610946e-03]
 [ 1.41265238e-02]
 [-6.08111582e-02]
 [-2.76847893e-02]
 [ 5.66905853e-05]
 [ 4.60047935e-03]
 [-2.51847002e-03]
 [ 1.61301080e-02]
 [ 1.47614373e-02]
 [-1.05662524e-02]
 [ 9.98051379e-04]
 [-2.48452865e-03]
 [-3.41478872e-03]
 [-2.21119899e-02]
 [ 1.89047071e-02]
 [ 1.59731330e-02]
 [-1.61927946e-02]
 [ 6.36350276e-03]
 [-2.30676267e-03]
 [ 4.61465085e-03]
 [ 3.51994583e-03]
 [-1.52748889e-02]
 [ 4.26888568e-02]
 [ 1.20544469e-03]
 [ 6.15677791e-03]
 [-9.18386824e-03]
 [ 3.60732708e-04]
 [-4.91132187e-03]
 [-1.36538261e-02]
 [-9.42668480e-04]
 [-4.47698032e-03]
 [ 4.29185491e-05]
 [-3.60039993e-03]
 [ 2.93319834e-03]
 [ 3.47995057e-03]
 [ 8.87329850e-04]
 [ 2.19189864e-03]
 [ 8.96845572e-03]
 [ 1.12314300e-02]
 [ 3.61205309e-03]
 [ 1.37721825e-02]
 [ 9.08617442e-04]
 [ 2.51527309e-03]
 [-1.59141162e-02]
 [-1.26808429e-02]
 [-1.04530086e-03]
 [-1.00345210e-02]
 [-1.51438858e-02]
 [ 1.01958154e-02]
 [ 2.24858828e-03]
 [ 1.16703541e-02]
 [-1.79284959e-02]
 [ 4.39871535e-03]
 [ 1.07176189e-03]
 [-1.05599959e-03]
 [ 8.00216983e-03]
 [-1.85963842e-03]
 [ 3.03413065e-03]
 [ 3.48411520e-03]
 [-1.08090926e-02]
 [-3.48177416e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.4171024]
curr_Stock_Price:  99.13340335819944
curr_Factors:  [99.13340336]
mat_Sqrt:  [[0.15]]
grads:  [-0.20386538]
Stock Position:  -0.2038653825235517
Bond Position:  [8.79276679]


portfolio before change:  [-11.47030147]
curr_Stock_Price:  99.39705104166521
curr_Factors:  [99.39705104]
mat_Sqrt:  [[0.15]]
grads:  [0.01775882]
Stock Position:  0.017758817710754826
Bond Position:  [-13.23547558]


portfolio before change:  [-11.47199103]
curr_Stock_Price:  99.34849419361038
curr_Factors:  [99.34849419]
mat_Sqrt:  [[0.15]]
grads:  [-0.0028294]
Stock Position:  -0.002829401762495263
Bond Position:  [-11.19089423]


portfolio before change:  [-11.473497]
curr_Stock_Price:  99.63354175899275
curr_Factors:  [99.63354176]
mat_Sqrt:  [[0.15]]
grads:  [0.0104419]
Stock Position:  0.010441902628989416
Bond Position:  [-12.51386074]


portfolio before change:  [-11.47781531]
curr_Stock_Price:  99.29488964100169
curr_Factors:  [99.29488964]
mat_Sqrt:  [[0.15]]
grads:  [-0.02523452]
Stock Position:  -0.025234523333463335
Bond Position:  [-8.9721561]


portfolio before change:  [-11.47015987]
curr_Stock_Price:  98.96929546128116
curr_Factors:  [98.96929546]
mat_Sqrt:  [[0.15]]
grads:  [0.05320841]
Stock Position:  0.053208412100563644
Bond Position:  [-16.73615893]


portfolio before change:  [-11.43978458]
curr_Stock_Price:  99.55982864147744
curr_Factors:  [99.55982864]
mat_Sqrt:  [[0.15]]
grads:  [0.00530505]
Stock Position:  0.005305048804362019
Bond Position:  [-11.96795433]


portfolio before change:  [-11.44430446]
curr_Stock_Price:  98.84883420746296
curr_Factors:  [98.84883421]
mat_Sqrt:  [[0.15]]
grads:  [0.09881884]
Stock Position:  0.09881884406714554
Bond Position:  [-21.212432]


portfolio before change:  [-11.40786806]
curr_Stock_Price:  99.2309700139712
curr_Factors:  [99.23097001]
mat_Sqrt:  [[0.15]]
grads:  [0.11823875]
Stock Position:  0.11823875145496532
Bond Position:  [-23.14081406]


portfolio before change:  [-11.44817397]
curr_Stock_Price:  98.90231670609815
curr_Factors:  [98.90231671]
mat_Sqrt:  [[0.15]]
grads:  [-0.10372724]
Stock Position:  -0.10372724295186643
Bond Position:  [-1.18930933]


portfolio before change:  [-11.44981657]
curr_Stock_Price:  98.91743586154138
curr_Factors:  [98.91743586]
mat_Sqrt:  [[0.15]]
grads:  [0.03967427]
Stock Position:  0.03967427294308751
Bond Position:  [-15.37429392]


portfolio before change:  [-11.46383181]
curr_Stock_Price:  98.58839854209229
curr_Factors:  [98.58839854]
mat_Sqrt:  [[0.15]]
grads:  [-0.04753683]
Stock Position:  -0.04753683244335328
Bond Position:  [-6.77725163]


portfolio before change:  [-11.4523923]
curr_Stock_Price:  98.33884249060122
curr_Factors:  [98.33884249]
mat_Sqrt:  [[0.15]]
grads:  [0.00015064]
Stock Position:  0.0001506408172118635
Bond Position:  [-11.46720614]


portfolio before change:  [-11.45298154]
curr_Stock_Price:  99.18509150275227
curr_Factors:  [99.1850915]
mat_Sqrt:  [[0.15]]
grads:  [0.02593269]
Stock Position:  0.025932690828253134
Bond Position:  [-14.02511785]


portfolio before change:  [-11.45673777]
curr_Stock_Price:  99.07404886607357
curr_Factors:  [99.07404887]
mat_Sqrt:  [[0.15]]
grads:  [-0.00663774]
Stock Position:  -0.0066377358650731326
Bond Position:  [-10.7991104]


portfolio before change:  [-11.45239348]
curr_Stock_Price:  98.3178793281263
curr_Factors:  [98.31787933]
mat_Sqrt:  [[0.15]]
grads:  [0.09814574]
Stock Position:  0.09814573761416387
Bond Position:  [-21.10187427]


portfolio before change:  [-11.35121597]
curr_Stock_Price:  99.36220815537445
curr_Factors:  [99.36220816]
mat_Sqrt:  [[0.15]]
grads:  [0.00483029]
Stock Position:  0.004830286823798768
Bond Position:  [-11.83116393]


portfolio before change:  [-11.35230001]
curr_Stock_Price:  99.29087158611445
curr_Factors:  [99.29087159]
mat_Sqrt:  [[0.15]]
grads:  [0.04340955]
Stock Position:  0.043409547119945546
Bond Position:  [-15.66247178]


portfolio before change:  [-11.41174548]
curr_Stock_Price:  97.9440127112245
curr_Factors:  [97.94401271]
mat_Sqrt:  [[0.15]]
grads:  [0.02817406]
Stock Position:  0.028174063088169644
Bond Position:  [-14.17122628]


portfolio before change:  [-11.41420545]
curr_Stock_Price:  97.8881372161635
curr_Factors:  [97.88813722]
mat_Sqrt:  [[0.15]]
grads:  [0.09417683]
Stock Position:  0.09417682556730812
Bond Position:  [-20.63299948]


portfolio before change:  [-11.54856041]
curr_Stock_Price:  96.47520628659132
curr_Factors:  [96.47520629]
mat_Sqrt:  [[0.15]]
grads:  [-0.40540772]
Stock Position:  -0.40540772146959253
Bond Position:  [27.56323315]


portfolio before change:  [-11.70364708]
curr_Stock_Price:  96.86200067254066
curr_Factors:  [96.86200067]
mat_Sqrt:  [[0.15]]
grads:  [-0.18456526]
Stock Position:  -0.18456526179636362
Bond Position:  [6.17371343]


portfolio before change:  [-11.81273079]
curr_Stock_Price:  97.45512192352962
curr_Factors:  [97.45512192]
mat_Sqrt:  [[0.15]]
grads:  [0.00037794]
Stock Position:  0.00037793723556153735
Bond Position:  [-11.84956271]


portfolio before change:  [-11.81354654]
curr_Stock_Price:  97.25633064380688
curr_Factors:  [97.25633064]
mat_Sqrt:  [[0.15]]
grads:  [0.03066986]
Stock Position:  0.03066986231419811
Bond Position:  [-14.79638481]


portfolio before change:  [-11.81605768]
curr_Stock_Price:  97.20460756217679
curr_Factors:  [97.20460756]
mat_Sqrt:  [[0.15]]
grads:  [-0.0167898]
Stock Position:  -0.016789800165404885
Bond Position:  [-10.18401175]


portfolio before change:  [-11.81840582]
curr_Stock_Price:  97.30655160414484
curr_Factors:  [97.3065516]
mat_Sqrt:  [[0.15]]
grads:  [0.10753405]
Stock Position:  0.10753405364788092
Bond Position:  [-22.28217377]


portfolio before change:  [-11.77923735]
curr_Stock_Price:  97.68374514917772
curr_Factors:  [97.68374515]
mat_Sqrt:  [[0.15]]
grads:  [0.09840958]
Stock Position:  0.09840958217650465
Bond Position:  [-21.3922539]


portfolio before change:  [-11.80038741]
curr_Stock_Price:  97.48241313610744
curr_Factors:  [97.48241314]
mat_Sqrt:  [[0.15]]
grads:  [-0.07044168]
Stock Position:  -0.07044168285498867
Bond Position:  [-4.93356218]


portfolio before change:  [-11.79585885]
curr_Stock_Price:  97.41374758068304
curr_Factors:  [97.41374758]
mat_Sqrt:  [[0.15]]
grads:  [0.00665368]
Stock Position:  0.006653675860986701
Bond Position:  [-12.44401835]


portfolio before change:  [-11.79608414]
curr_Stock_Price:  97.49678204085738
curr_Factors:  [97.49678204]
mat_Sqrt:  [[0.15]]
grads:  [-0.01656352]
Stock Position:  -0.016563524307772762
Bond Position:  [-10.18119382]


portfolio before change:  [-11.79120872]
curr_Stock_Price:  97.16401681136867
curr_Factors:  [97.16401681]
mat_Sqrt:  [[0.15]]
grads:  [-0.02276526]
Stock Position:  -0.022765258117794875
Bond Position:  [-9.5792448]


portfolio before change:  [-11.79481302]
curr_Stock_Price:  97.29604157485738
curr_Factors:  [97.29604157]
mat_Sqrt:  [[0.15]]
grads:  [-0.14741327]
Stock Position:  -0.14741326600432633
Bond Position:  [2.54791424]


portfolio before change:  [-11.83427512]
curr_Stock_Price:  97.56481891644265
curr_Factors:  [97.56481892]
mat_Sqrt:  [[0.15]]
grads:  [0.12603138]
Stock Position:  0.12603138049287518
Bond Position:  [-24.13050393]


portfolio before change:  [-11.74642614]
curr_Stock_Price:  98.27382630133364
curr_Factors:  [98.2738263]
mat_Sqrt:  [[0.15]]
grads:  [0.10648755]
Stock Position:  0.1064875530419065
Bond Position:  [-22.21136543]


portfolio before change:  [-11.72886239]
curr_Stock_Price:  98.45180020397908
curr_Factors:  [98.4518002]
mat_Sqrt:  [[0.15]]
grads:  [-0.10795196]
Stock Position:  -0.1079519639112297
Bond Position:  [-1.10079721]


portfolio before change:  [-11.74816846]
curr_Stock_Price:  98.63000228845361
curr_Factors:  [98.63000229]
mat_Sqrt:  [[0.15]]
grads:  [0.04242335]
Stock Position:  0.04242335173456346
Bond Position:  [-15.93238373]


portfolio before change:  [-11.73861531]
curr_Stock_Price:  98.87866144826299
curr_Factors:  [98.87866145]
mat_Sqrt:  [[0.15]]
grads:  [-0.01537842]
Stock Position:  -0.015378417801890608
Bond Position:  [-10.21801794]


portfolio before change:  [-11.72212136]
curr_Stock_Price:  97.76459438981324
curr_Factors:  [97.76459439]
mat_Sqrt:  [[0.15]]
grads:  [0.03076434]
Stock Position:  0.030764339023527355
Bond Position:  [-14.72978449]


portfolio before change:  [-11.71258267]
curr_Stock_Price:  98.10457678453868
curr_Factors:  [98.10457678]
mat_Sqrt:  [[0.15]]
grads:  [0.02346631]
Stock Position:  0.023466305502963428
Bond Position:  [-14.01473464]


portfolio before change:  [-11.72191114]
curr_Stock_Price:  97.74437846710603
curr_Factors:  [97.74437847]
mat_Sqrt:  [[0.15]]
grads:  [-0.10183259]
Stock Position:  -0.10183259262093235
Bond Position:  [-1.76834767]


portfolio before change:  [-11.6079162]
curr_Stock_Price:  96.62385840420251
curr_Factors:  [96.6238584]
mat_Sqrt:  [[0.15]]
grads:  [0.28459238]
Stock Position:  0.2845923786797802
Bond Position:  [-39.1063299]


portfolio before change:  [-11.70107381]
curr_Stock_Price:  96.30510992514876
curr_Factors:  [96.30510993]
mat_Sqrt:  [[0.15]]
grads:  [0.0080363]
Stock Position:  0.008036297909001762
Bond Position:  [-12.47501037]


portfolio before change:  [-11.69674933]
curr_Stock_Price:  96.94025269382242
curr_Factors:  [96.94025269]
mat_Sqrt:  [[0.15]]
grads:  [0.04104519]
Stock Position:  0.041045186041423105
Bond Position:  [-15.67568004]


portfolio before change:  [-11.70891147]
curr_Stock_Price:  96.66781186015812
curr_Factors:  [96.66781186]
mat_Sqrt:  [[0.15]]
grads:  [-0.06122579]
Stock Position:  -0.061225788279648946
Bond Position:  [-5.79034849]


portfolio before change:  [-11.74027356]
curr_Stock_Price:  97.17413736877687
curr_Factors:  [97.17413737]
mat_Sqrt:  [[0.15]]
grads:  [0.00240488]
Stock Position:  0.002404884719905827
Bond Position:  [-11.97396616]


portfolio before change:  [-11.73955448]
curr_Stock_Price:  97.78434563098504
curr_Factors:  [97.78434563]
mat_Sqrt:  [[0.15]]
grads:  [-0.03274215]
Stock Position:  -0.03274214579920484
Bond Position:  [-8.53788518]


portfolio before change:  [-11.74947821]
curr_Stock_Price:  98.07113505012738
curr_Factors:  [98.07113505]
mat_Sqrt:  [[0.15]]
grads:  [-0.09102551]
Stock Position:  -0.0910255076589556
Bond Position:  [-2.82250336]


portfolio before change:  [-11.73953478]
curr_Stock_Price:  97.9599590890882
curr_Factors:  [97.95995909]
mat_Sqrt:  [[0.15]]
grads:  [-0.00628446]
Stock Position:  -0.006284456532980055
Bond Position:  [-11.12390967]


portfolio before change:  [-11.7374127]
curr_Stock_Price:  97.51165654419421
curr_Factors:  [97.51165654]
mat_Sqrt:  [[0.15]]
grads:  [-0.02984654]
Stock Position:  -0.029846535495467105
Bond Position:  [-8.82702759]


portfolio before change:  [-11.71782843]
curr_Stock_Price:  96.83700596386717
curr_Factors:  [96.83700596]
mat_Sqrt:  [[0.15]]
grads:  [0.00028612]
Stock Position:  0.0002861236608151715
Bond Position:  [-11.74553579]


portfolio before change:  [-11.71848568]
curr_Stock_Price:  97.10565618324803
curr_Factors:  [97.10565618]
mat_Sqrt:  [[0.15]]
grads:  [-0.02400267]
Stock Position:  -0.024002666182925597
Bond Position:  [-9.38769103]


portfolio before change:  [-11.70706752]
curr_Stock_Price:  96.60550719164726
curr_Factors:  [96.60550719]
mat_Sqrt:  [[0.15]]
grads:  [0.01955466]
Stock Position:  0.019554655624416755
Bond Position:  [-13.59615494]


portfolio before change:  [-11.7064317]
curr_Stock_Price:  96.68147897693832
curr_Factors:  [96.68147898]
mat_Sqrt:  [[0.15]]
grads:  [0.02319967]
Stock Position:  0.023199670463062268
Bond Position:  [-13.94941016]


portfolio before change:  [-11.70356177]
curr_Stock_Price:  96.8427655451955
curr_Factors:  [96.84276555]
mat_Sqrt:  [[0.15]]
grads:  [0.00591553]
Stock Position:  0.005915532333199196
Bond Position:  [-12.27643829]


portfolio before change:  [-11.69647152]
curr_Stock_Price:  98.17105813167979
curr_Factors:  [98.17105813]
mat_Sqrt:  [[0.15]]
grads:  [0.01461266]
Stock Position:  0.01461265760997682
Bond Position:  [-13.13101158]


portfolio before change:  [-11.70028143]
curr_Stock_Price:  97.96649616332134
curr_Factors:  [97.96649616]
mat_Sqrt:  [[0.15]]
grads:  [0.0597897]
Stock Position:  0.05978970479491415
Bond Position:  [-17.55766931]


portfolio before change:  [-11.79263347]
curr_Stock_Price:  96.44023588535146
curr_Factors:  [96.44023589]
mat_Sqrt:  [[0.15]]
grads:  [0.0748762]
Stock Position:  0.07487620030045078
Bond Position:  [-19.01371189]


portfolio before change:  [-11.76418569]
curr_Stock_Price:  96.8360381132197
curr_Factors:  [96.83603811]
mat_Sqrt:  [[0.15]]
grads:  [0.02408035]
Stock Position:  0.024080353936038502
Bond Position:  [-14.09603176]


portfolio before change:  [-11.73394753]
curr_Stock_Price:  98.12834422225647
curr_Factors:  [98.12834422]
mat_Sqrt:  [[0.15]]
grads:  [0.09181455]
Stock Position:  0.09181454970164714
Bond Position:  [-20.74355727]


portfolio before change:  [-11.76219948]
curr_Stock_Price:  97.83475856265149
curr_Factors:  [97.83475856]
mat_Sqrt:  [[0.15]]
grads:  [0.00605745]
Stock Position:  0.006057449614456622
Bond Position:  [-12.3548286]


portfolio before change:  [-11.76524854]
curr_Stock_Price:  97.45888115034954
curr_Factors:  [97.45888115]
mat_Sqrt:  [[0.15]]
grads:  [0.01676849]
Stock Position:  0.016768487234935157
Bond Position:  [-13.39948655]


portfolio before change:  [-11.76155654]
curr_Stock_Price:  97.72900074407482
curr_Factors:  [97.72900074]
mat_Sqrt:  [[0.15]]
grads:  [-0.10609411]
Stock Position:  -0.10609410824626127
Bond Position:  [-1.39308535]


portfolio before change:  [-11.76009796]
curr_Stock_Price:  97.7144320619869
curr_Factors:  [97.71443206]
mat_Sqrt:  [[0.15]]
grads:  [-0.08453895]
Stock Position:  -0.08453895293166241
Bond Position:  [-3.49942219]


portfolio before change:  [-11.77026489]
curr_Stock_Price:  97.83210813727894
curr_Factors:  [97.83210814]
mat_Sqrt:  [[0.15]]
grads:  [-0.00696867]
Stock Position:  -0.006968672386491987
Bond Position:  [-11.08850498]


portfolio before change:  [-11.7680989]
curr_Stock_Price:  97.42183700335634
curr_Factors:  [97.421837]
mat_Sqrt:  [[0.15]]
grads:  [-0.06689681]
Stock Position:  -0.06689680640282097
Bond Position:  [-5.25088913]


portfolio before change:  [-11.79794248]
curr_Stock_Price:  97.86304480617308
curr_Factors:  [97.86304481]
mat_Sqrt:  [[0.15]]
grads:  [-0.10095924]
Stock Position:  -0.10095923855125899
Bond Position:  [-1.917764]


portfolio before change:  [-11.77433732]
curr_Stock_Price:  97.62804869258855
curr_Factors:  [97.62804869]
mat_Sqrt:  [[0.15]]
grads:  [0.0679721]
Stock Position:  0.06797210293518435
Bond Position:  [-18.41032109]


portfolio before change:  [-11.7820873]
curr_Stock_Price:  97.53096033307902
curr_Factors:  [97.53096033]
mat_Sqrt:  [[0.15]]
grads:  [0.01499059]
Stock Position:  0.014990588564195205
Bond Position:  [-13.2441338]


portfolio before change:  [-11.78912184]
curr_Stock_Price:  97.11691653011734
curr_Factors:  [97.11691653]
mat_Sqrt:  [[0.15]]
grads:  [0.07780236]
Stock Position:  0.07780236036650161
Bond Position:  [-19.34504718]


portfolio before change:  [-11.79890777]
curr_Stock_Price:  97.0066779494513
curr_Factors:  [97.00667795]
mat_Sqrt:  [[0.15]]
grads:  [-0.11952331]
Stock Position:  -0.11952330618964488
Bond Position:  [-0.2043489]


portfolio before change:  [-11.84487475]
curr_Stock_Price:  97.39115702805015
curr_Factors:  [97.39115703]
mat_Sqrt:  [[0.15]]
grads:  [0.02932477]
Stock Position:  0.02932476901914437
Bond Position:  [-14.70084794]


portfolio before change:  [-11.86383681]
curr_Stock_Price:  96.77586748342917
curr_Factors:  [96.77586748]
mat_Sqrt:  [[0.15]]
grads:  [0.00714508]
Stock Position:  0.007145079264860641
Bond Position:  [-12.55530805]


portfolio before change:  [-11.86377812]
curr_Stock_Price:  96.89390873868534
curr_Factors:  [96.89390874]
mat_Sqrt:  [[0.15]]
grads:  [-0.00704]
Stock Position:  -0.007039997275385644
Bond Position:  [-11.18164527]


portfolio before change:  [-11.8650691]
curr_Stock_Price:  96.9780141765078
curr_Factors:  [96.97801418]
mat_Sqrt:  [[0.15]]
grads:  [0.0533478]
Stock Position:  0.05334779885446814
Bond Position:  [-17.03863269]


portfolio before change:  [-11.88595373]
curr_Stock_Price:  96.60649586724765
curr_Factors:  [96.60649587]
mat_Sqrt:  [[0.15]]
grads:  [-0.01239759]
Stock Position:  -0.012397589473688783
Bond Position:  [-10.68826606]


portfolio before change:  [-11.87701768]
curr_Stock_Price:  95.83182217540973
curr_Factors:  [95.83182218]
mat_Sqrt:  [[0.15]]
grads:  [0.02022754]
Stock Position:  0.020227537664426226
Bond Position:  [-13.81545948]


portfolio before change:  [-11.85265129]
curr_Stock_Price:  97.07912622096228
curr_Factors:  [97.07912622]
mat_Sqrt:  [[0.15]]
grads:  [0.02322743]
Stock Position:  0.023227434642013982
Bond Position:  [-14.10755035]


portfolio before change:  [-11.84640294]
curr_Stock_Price:  97.38609477945579
curr_Factors:  [97.38609478]
mat_Sqrt:  [[0.15]]
grads:  [-0.07206062]
Stock Position:  -0.07206061719736992
Bond Position:  [-4.82870085]


portfolio before change:  [-11.78117901]
curr_Stock_Price:  96.47678064151131
curr_Factors:  [96.47678064]
mat_Sqrt:  [[0.15]]
grads:  [-0.23211828]
Stock Position:  -0.23211827720543515
Bond Position:  [10.6128451]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.78117901]
Stock Price:  96.4843011945865
PL:  [-11.78117901]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.42418113e-02]
 [-1.23899117e-03]
 [ 3.03117399e-03]
 [ 2.89009511e-03]
 [ 5.85649280e-03]
 [ 1.18516608e-02]
 [ 1.22312412e-03]
 [ 1.06858428e-02]
 [ 3.30463286e-03]
 [-1.90799110e-02]
 [ 9.54269096e-03]
 [-1.27049230e-02]
 [ 1.13059605e-02]
 [ 6.58244697e-03]
 [-1.26346526e-02]
 [ 1.29090653e-02]
 [ 4.32994383e-03]
 [ 4.73604794e-03]
 [ 1.24982365e-02]
 [ 1.03962195e-02]
 [ 3.20857447e-02]
 [-2.01103505e-02]
 [ 4.37729694e-05]
 [ 3.51220082e-03]
 [-4.28460506e-05]
 [ 1.33810711e-02]
 [ 1.38682281e-02]
 [-5.68030297e-03]
 [ 1.27681223e-03]
 [-6.96181663e-03]
 [-3.59656149e-03]
 [-1.95215828e-02]
 [ 1.74294308e-02]
 [ 1.95223596e-02]
 [-1.56346055e-02]
 [ 7.53340641e-03]
 [-2.43026882e-03]
 [ 2.32104265e-03]
 [ 6.14724499e-03]
 [-1.78257167e-02]
 [ 4.14767055e-02]
 [ 9.13549676e-04]
 [ 7.08704629e-03]
 [-8.90313288e-03]
 [ 9.22469390e-04]
 [-3.90094495e-03]
 [-1.37123761e-02]
 [-8.47455686e-04]
 [-3.85925648e-03]
 [ 4.70911199e-03]
 [-3.53882691e-03]
 [ 3.01083869e-03]
 [ 3.41382766e-03]
 [ 1.03901982e-03]
 [ 5.25276647e-03]
 [ 8.89222243e-03]
 [ 1.13274114e-02]
 [-7.80427887e-04]
 [ 1.36426064e-02]
 [ 1.84315046e-03]
 [ 4.97246305e-03]
 [-1.44852675e-02]
 [-1.26507626e-02]
 [-1.23607612e-03]
 [-1.18637252e-02]
 [ 3.09536061e-03]
 [ 1.35513188e-02]
 [ 2.08737890e-03]
 [ 6.67800702e-03]
 [-1.43881786e-02]
 [-8.35268862e-03]
 [-5.65307490e-03]
 [ 2.18705639e-03]
 [ 8.16995976e-03]
 [ 3.85830762e-03]
 [-1.04458848e-02]
 [ 7.47125083e-04]
 [-8.48537103e-03]
 [ 5.52514183e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.16865125]
curr_Stock_Price:  99.87802738753918
curr_Factors:  [99.87802739]
mat_Sqrt:  [[0.15]]
grads:  [-0.22827874]
Stock Position:  -0.22827874232818796
Bond Position:  [22.96868173]


portfolio before change:  [0.01828938]
curr_Stock_Price:  100.54299273679919
curr_Factors:  [100.54299274]
mat_Sqrt:  [[0.15]]
grads:  [-0.00825994]
Stock Position:  -0.008259941109817974
Bond Position:  [0.84876858]


portfolio before change:  [0.01454681]
curr_Stock_Price:  101.00251463709222
curr_Factors:  [101.00251464]
mat_Sqrt:  [[0.15]]
grads:  [0.02020783]
Stock Position:  0.02020782661237657
Bond Position:  [-2.02649449]


portfolio before change:  [0.02127887]
curr_Stock_Price:  101.34192353683036
curr_Factors:  [101.34192354]
mat_Sqrt:  [[0.15]]
grads:  [0.0192673]
Stock Position:  0.019267300718888235
Bond Position:  [-1.93130645]


portfolio before change:  [0.01716582]
curr_Stock_Price:  101.13471560734767
curr_Factors:  [101.13471561]
mat_Sqrt:  [[0.15]]
grads:  [0.03904329]
Stock Position:  0.03904328534175414
Bond Position:  [-3.93146574]


portfolio before change:  [-0.00083119]
curr_Stock_Price:  100.68005908972887
curr_Factors:  [100.68005909]
mat_Sqrt:  [[0.15]]
grads:  [0.07901107]
Stock Position:  0.07901107183904298
Bond Position:  [-7.95567057]


portfolio before change:  [-0.03639776]
curr_Stock_Price:  100.23620574625201
curr_Factors:  [100.23620575]
mat_Sqrt:  [[0.15]]
grads:  [0.00815416]
Stock Position:  0.00815416076701038
Bond Position:  [-0.8537399]


portfolio before change:  [-0.03567826]
curr_Stock_Price:  100.33098672025508
curr_Factors:  [100.33098672]
mat_Sqrt:  [[0.15]]
grads:  [0.07123895]
Stock Position:  0.07123895198085503
Bond Position:  [-7.18315261]


portfolio before change:  [-0.02209649]
curr_Stock_Price:  100.52793980342362
curr_Factors:  [100.5279398]
mat_Sqrt:  [[0.15]]
grads:  [0.02203089]
Stock Position:  0.022030885760982364
Bond Position:  [-2.23681605]


portfolio before change:  [-0.04411614]
curr_Stock_Price:  99.53479566329311
curr_Factors:  [99.53479566]
mat_Sqrt:  [[0.15]]
grads:  [-0.12719941]
Stock Position:  -0.12719940638426366
Bond Position:  [12.61665078]


portfolio before change:  [0.23993736]
curr_Stock_Price:  97.30785960778114
curr_Factors:  [97.30785961]
mat_Sqrt:  [[0.15]]
grads:  [0.06361794]
Stock Position:  0.06361793976060225
Bond Position:  [-5.95058819]


portfolio before change:  [0.20695756]
curr_Stock_Price:  96.79530169971311
curr_Factors:  [96.7953017]
mat_Sqrt:  [[0.15]]
grads:  [-0.08469949]
Stock Position:  -0.08469948644558514
Bond Position:  [8.40546991]


portfolio before change:  [0.18049899]
curr_Stock_Price:  97.11388611847366
curr_Factors:  [97.11388612]
mat_Sqrt:  [[0.15]]
grads:  [0.07537307]
Stock Position:  0.07537307018165794
Bond Position:  [-7.13927277]


portfolio before change:  [0.19836072]
curr_Stock_Price:  97.35678395716265
curr_Factors:  [97.35678396]
mat_Sqrt:  [[0.15]]
grads:  [0.04388298]
Stock Position:  0.04388297978407926
Bond Position:  [-4.07394506]


portfolio before change:  [0.23859536]
curr_Stock_Price:  98.27944853540694
curr_Factors:  [98.27944854]
mat_Sqrt:  [[0.15]]
grads:  [-0.08423102]
Stock Position:  -0.084231017258345
Bond Position:  [8.51677329]


portfolio before change:  [0.1688743]
curr_Stock_Price:  99.11350443840388
curr_Factors:  [99.11350444]
mat_Sqrt:  [[0.15]]
grads:  [0.08606044]
Stock Position:  0.08606043564799387
Bond Position:  [-8.36087707]


portfolio before change:  [0.21989667]
curr_Stock_Price:  99.71244334548521
curr_Factors:  [99.71244335]
mat_Sqrt:  [[0.15]]
grads:  [0.02886629]
Stock Position:  0.028866292220140432
Bond Position:  [-2.65843185]


portfolio before change:  [0.19184953]
curr_Stock_Price:  98.7465766003727
curr_Factors:  [98.7465766]
mat_Sqrt:  [[0.15]]
grads:  [0.03157365]
Stock Position:  0.031573652946826444
Bond Position:  [-2.92594061]


portfolio before change:  [0.18327529]
curr_Stock_Price:  98.480805775436
curr_Factors:  [98.48080578]
mat_Sqrt:  [[0.15]]
grads:  [0.08332158]
Stock Position:  0.0833215768950828
Bond Position:  [-8.02230074]


portfolio before change:  [0.26101946]
curr_Stock_Price:  99.41988518261711
curr_Factors:  [99.41988518]
mat_Sqrt:  [[0.15]]
grads:  [0.06930813]
Stock Position:  0.06930812974257301
Bond Position:  [-6.62958684]


portfolio before change:  [0.20549616]
curr_Stock_Price:  98.62475563914585
curr_Factors:  [98.62475564]
mat_Sqrt:  [[0.15]]
grads:  [0.21390496]
Stock Position:  0.21390496470607354
Bond Position:  [-20.89082872]


portfolio before change:  [0.14384532]
curr_Stock_Price:  98.34264383829145
curr_Factors:  [98.34264384]
mat_Sqrt:  [[0.15]]
grads:  [-0.134069]
Stock Position:  -0.1340690030809028
Bond Position:  [13.32854554]


portfolio before change:  [0.26229961]
curr_Stock_Price:  97.46532527775825
curr_Factors:  [97.46532528]
mat_Sqrt:  [[0.15]]
grads:  [0.00029182]
Stock Position:  0.0002918197956818895
Bond Position:  [0.2338573]


portfolio before change:  [0.26219833]
curr_Stock_Price:  97.0681848035098
curr_Factors:  [97.0681848]
mat_Sqrt:  [[0.15]]
grads:  [0.02341467]
Stock Position:  0.023414672146222806
Bond Position:  [-2.01062139]


portfolio before change:  [0.27740988]
curr_Stock_Price:  97.72321069218793
curr_Factors:  [97.72321069]
mat_Sqrt:  [[0.15]]
grads:  [-0.00028564]
Stock Position:  -0.00028564033751028614
Bond Position:  [0.30532357]


portfolio before change:  [0.27736815]
curr_Stock_Price:  97.9361128805189
curr_Factors:  [97.93611288]
mat_Sqrt:  [[0.15]]
grads:  [0.08920714]
Stock Position:  0.08920714065034067
Bond Position:  [-8.45923245]


portfolio before change:  [0.29158013]
curr_Stock_Price:  98.10135411768957
curr_Factors:  [98.10135412]
mat_Sqrt:  [[0.15]]
grads:  [0.09245485]
Stock Position:  0.09245485429352217
Bond Position:  [-8.77836627]


portfolio before change:  [0.218931]
curr_Stock_Price:  97.3215089913339
curr_Factors:  [97.32150899]
mat_Sqrt:  [[0.15]]
grads:  [-0.03786869]
Stock Position:  -0.037868686459362366
Bond Position:  [3.90436871]


portfolio before change:  [0.20071007]
curr_Stock_Price:  97.8091138423881
curr_Factors:  [97.80911384]
mat_Sqrt:  [[0.15]]
grads:  [0.00851208]
Stock Position:  0.00851208155741094
Bond Position:  [-0.63184908]


portfolio before change:  [0.20345159]
curr_Stock_Price:  98.13582752312958
curr_Factors:  [98.13582752]
mat_Sqrt:  [[0.15]]
grads:  [-0.04641211]
Stock Position:  -0.04641211086380658
Bond Position:  [4.7581425]


portfolio before change:  [0.20971149]
curr_Stock_Price:  98.00735893252396
curr_Factors:  [98.00735893]
mat_Sqrt:  [[0.15]]
grads:  [-0.02397708]
Stock Position:  -0.023977076603800627
Bond Position:  [2.55964144]


portfolio before change:  [0.21592155]
curr_Stock_Price:  97.75503140896281
curr_Factors:  [97.75503141]
mat_Sqrt:  [[0.15]]
grads:  [-0.13014389]
Stock Position:  -0.13014388522947706
Bond Position:  [12.93814113]


portfolio before change:  [0.1773841]
curr_Stock_Price:  98.05735914277865
curr_Factors:  [98.05735914]
mat_Sqrt:  [[0.15]]
grads:  [0.11619621]
Stock Position:  0.11619620506796276
Bond Position:  [-11.21650891]


portfolio before change:  [0.2646925]
curr_Stock_Price:  98.8147802620076
curr_Factors:  [98.81478026]
mat_Sqrt:  [[0.15]]
grads:  [0.13014906]
Stock Position:  0.13014906423541098
Bond Position:  [-12.59595868]


portfolio before change:  [0.2310999]
curr_Stock_Price:  98.56272056683022
curr_Factors:  [98.56272057]
mat_Sqrt:  [[0.15]]
grads:  [-0.1042307]
Stock Position:  -0.10423070333555945
Bond Position:  [10.50436159]


portfolio before change:  [0.31150855]
curr_Stock_Price:  97.79757070141665
curr_Factors:  [97.7975707]
mat_Sqrt:  [[0.15]]
grads:  [0.05022271]
Stock Position:  0.05022270941889396
Bond Position:  [-4.60015042]


portfolio before change:  [0.34373508]
curr_Stock_Price:  98.44496809867005
curr_Factors:  [98.4449681]
mat_Sqrt:  [[0.15]]
grads:  [-0.01620179]
Stock Position:  -0.01620179216599136
Bond Position:  [1.93872]


portfolio before change:  [0.36082237]
curr_Stock_Price:  97.39779331917099
curr_Factors:  [97.39779332]
mat_Sqrt:  [[0.15]]
grads:  [0.01547362]
Stock Position:  0.01547361769022983
Bond Position:  [-1.14627385]


portfolio before change:  [0.34807406]
curr_Stock_Price:  96.57854979344448
curr_Factors:  [96.57854979]
mat_Sqrt:  [[0.15]]
grads:  [0.04098163]
Stock Position:  0.040981633264329215
Bond Position:  [-3.60987265]


portfolio before change:  [0.33391728]
curr_Stock_Price:  96.23861323766619
curr_Factors:  [96.23861324]
mat_Sqrt:  [[0.15]]
grads:  [-0.11883811]
Stock Position:  -0.11883811148343512
Bond Position:  [11.77073233]


portfolio before change:  [0.23601386]
curr_Stock_Price:  97.0686425577873
curr_Factors:  [97.06864256]
mat_Sqrt:  [[0.15]]
grads:  [0.27651137]
Stock Position:  0.2765113701265015
Bond Position:  [-26.60456949]


portfolio before change:  [0.08585876]
curr_Stock_Price:  96.53162211977696
curr_Factors:  [96.53162212]
mat_Sqrt:  [[0.15]]
grads:  [0.00609033]
Stock Position:  0.006090331175840931
Bond Position:  [-0.50205078]


portfolio before change:  [0.08491214]
curr_Stock_Price:  96.38134341247414
curr_Factors:  [96.38134341]
mat_Sqrt:  [[0.15]]
grads:  [0.04724698]
Stock Position:  0.04724697528663208
Bond Position:  [-4.46881481]


portfolio before change:  [0.11420385]
curr_Stock_Price:  97.00722526923342
curr_Factors:  [97.00722527]
mat_Sqrt:  [[0.15]]
grads:  [-0.05935422]
Stock Position:  -0.05935421918969346
Bond Position:  [5.87199196]


portfolio before change:  [0.07992318]
curr_Stock_Price:  97.59096955562248
curr_Factors:  [97.59096956]
mat_Sqrt:  [[0.15]]
grads:  [0.0061498]
Stock Position:  0.006149795932711382
Bond Position:  [-0.52024137]


portfolio before change:  [0.08438961]
curr_Stock_Price:  98.32253113495523
curr_Factors:  [98.32253113]
mat_Sqrt:  [[0.15]]
grads:  [-0.0260063]
Stock Position:  -0.026006299674678
Bond Position:  [2.64139482]


portfolio before change:  [0.0763139]
curr_Stock_Price:  98.63940848166332
curr_Factors:  [98.63940848]
mat_Sqrt:  [[0.15]]
grads:  [-0.09141584]
Stock Position:  -0.09141584061826309
Bond Position:  [9.09351834]


portfolio before change:  [0.16149056]
curr_Stock_Price:  97.71387634536862
curr_Factors:  [97.71387635]
mat_Sqrt:  [[0.15]]
grads:  [-0.0056497]
Stock Position:  -0.005649704574964115
Bond Position:  [0.71354509]


portfolio before change:  [0.16389223]
curr_Stock_Price:  97.29667433494714
curr_Factors:  [97.29667433]
mat_Sqrt:  [[0.15]]
grads:  [-0.02572838]
Stock Position:  -0.025728376546780722
Bond Position:  [2.6671777]


portfolio before change:  [0.15450377]
curr_Stock_Price:  97.66806036781702
curr_Factors:  [97.66806037]
mat_Sqrt:  [[0.15]]
grads:  [0.03139408]
Stock Position:  0.03139407993703444
Bond Position:  [-2.91169512]


portfolio before change:  [0.14192044]
curr_Stock_Price:  97.27303859462924
curr_Factors:  [97.27303859]
mat_Sqrt:  [[0.15]]
grads:  [-0.02359218]
Stock Position:  -0.02359217936828722
Bond Position:  [2.43680341]


portfolio before change:  [0.13794763]
curr_Stock_Price:  97.44788946687795
curr_Factors:  [97.44788947]
mat_Sqrt:  [[0.15]]
grads:  [0.02007226]
Stock Position:  0.02007225791245271
Bond Position:  [-1.81805154]


portfolio before change:  [0.128312]
curr_Stock_Price:  96.97350359521381
curr_Factors:  [96.9735036]
mat_Sqrt:  [[0.15]]
grads:  [0.02275885]
Stock Position:  0.02275885104358566
Bond Position:  [-2.07869352]


portfolio before change:  [0.12743889]
curr_Stock_Price:  96.94084853891641
curr_Factors:  [96.94084854]
mat_Sqrt:  [[0.15]]
grads:  [0.0069268]
Stock Position:  0.0069267987848144015
Bond Position:  [-0.54405086]


portfolio before change:  [0.12703231]
curr_Stock_Price:  96.88706101670611
curr_Factors:  [96.88706102]
mat_Sqrt:  [[0.15]]
grads:  [0.03501844]
Stock Position:  0.03501844310104355
Bond Position:  [-3.26580172]


portfolio before change:  [0.13335653]
curr_Stock_Price:  97.07348669912767
curr_Factors:  [97.0734867]
mat_Sqrt:  [[0.15]]
grads:  [0.05928148]
Stock Position:  0.05928148283658995
Bond Position:  [-5.62130371]


portfolio before change:  [0.13470529]
curr_Stock_Price:  97.1021652653285
curr_Factors:  [97.10216527]
mat_Sqrt:  [[0.15]]
grads:  [0.07551608]
Stock Position:  0.07551607582019412
Bond Position:  [-7.19806918]


portfolio before change:  [0.16609398]
curr_Stock_Price:  97.52377852263207
curr_Factors:  [97.52377852]
mat_Sqrt:  [[0.15]]
grads:  [-0.00520285]
Stock Position:  -0.005202852578255635
Bond Position:  [0.67349582]


portfolio before change:  [0.16638531]
curr_Stock_Price:  97.47587430399291
curr_Factors:  [97.4758743]
mat_Sqrt:  [[0.15]]
grads:  [0.09095071]
Stock Position:  0.09095070933108164
Bond Position:  [-8.6991146]


portfolio before change:  [0.22609577]
curr_Stock_Price:  98.13836690787252
curr_Factors:  [98.13836691]
mat_Sqrt:  [[0.15]]
grads:  [0.01228767]
Stock Position:  0.012287669735418564
Bond Position:  [-0.97979607]


portfolio before change:  [0.23184589]
curr_Stock_Price:  98.611309049815
curr_Factors:  [98.61130905]
mat_Sqrt:  [[0.15]]
grads:  [0.03314975]
Stock Position:  0.033149753673008056
Bond Position:  [-3.03709471]


portfolio before change:  [0.22744493]
curr_Stock_Price:  98.48427539844205
curr_Factors:  [98.4842754]
mat_Sqrt:  [[0.15]]
grads:  [-0.09656845]
Stock Position:  -0.09656844978051489
Bond Position:  [9.73791873]


portfolio before change:  [0.26549414]
curr_Stock_Price:  98.09656521583645
curr_Factors:  [98.09656522]
mat_Sqrt:  [[0.15]]
grads:  [-0.08433842]
Stock Position:  -0.08433841739447706
Bond Position:  [8.5388032]


portfolio before change:  [0.23226776]
curr_Stock_Price:  98.49685811262303
curr_Factors:  [98.49685811]
mat_Sqrt:  [[0.15]]
grads:  [-0.00824051]
Stock Position:  -0.008240507497045071
Bond Position:  [1.04393186]


portfolio before change:  [0.22996341]
curr_Stock_Price:  98.78441375380503
curr_Factors:  [98.78441375]
mat_Sqrt:  [[0.15]]
grads:  [-0.0790915]
Stock Position:  -0.07909150150816918
Bond Position:  [8.04297102]


portfolio before change:  [0.22244465]
curr_Stock_Price:  98.88583373325031
curr_Factors:  [98.88583373]
mat_Sqrt:  [[0.15]]
grads:  [0.02063574]
Stock Position:  0.020635737431348042
Bond Position:  [-1.81813745]


portfolio before change:  [0.23102897]
curr_Stock_Price:  99.30733350653061
curr_Factors:  [99.30733351]
mat_Sqrt:  [[0.15]]
grads:  [0.09034213]
Stock Position:  0.09034212532787157
Bond Position:  [-8.7406066]


portfolio before change:  [0.17187625]
curr_Stock_Price:  98.65861707467084
curr_Factors:  [98.65861707]
mat_Sqrt:  [[0.15]]
grads:  [0.01391586]
Stock Position:  0.013915859356017555
Bond Position:  [-1.20104319]


portfolio before change:  [0.18590416]
curr_Stock_Price:  99.67206346625784
curr_Factors:  [99.67206347]
mat_Sqrt:  [[0.15]]
grads:  [0.04452005]
Stock Position:  0.0445200468032088
Bond Position:  [-4.25150077]


portfolio before change:  [0.20671696]
curr_Stock_Price:  100.14552512017431
curr_Factors:  [100.14552512]
mat_Sqrt:  [[0.15]]
grads:  [-0.09592119]
Stock Position:  -0.09592119060987696
Bond Position:  [9.81279497]


portfolio before change:  [0.09306711]
curr_Stock_Price:  101.33674444179208
curr_Factors:  [101.33674444]
mat_Sqrt:  [[0.15]]
grads:  [-0.05568459]
Stock Position:  -0.05568459080108594
Bond Position:  [5.73596225]


portfolio before change:  [0.08418041]
curr_Stock_Price:  101.50277251759721
curr_Factors:  [101.50277252]
mat_Sqrt:  [[0.15]]
grads:  [-0.03768717]
Stock Position:  -0.03768716602373666
Bond Position:  [3.90953225]


portfolio before change:  [0.09041728]
curr_Stock_Price:  101.34376565751224
curr_Factors:  [101.34376566]
mat_Sqrt:  [[0.15]]
grads:  [0.01458038]
Stock Position:  0.014580375965392162
Bond Position:  [-1.38721292]


portfolio before change:  [0.09907399]
curr_Stock_Price:  101.94343557935528
curr_Factors:  [101.94343558]
mat_Sqrt:  [[0.15]]
grads:  [0.0544664]
Stock Position:  0.054466398422734305
Bond Position:  [-5.45341779]


portfolio before change:  [0.08738629]
curr_Stock_Price:  101.73510795585986
curr_Factors:  [101.73510796]
mat_Sqrt:  [[0.15]]
grads:  [0.02572205]
Stock Position:  0.02572205079344736
Bond Position:  [-2.52944933]


portfolio before change:  [0.07644975]
curr_Stock_Price:  101.31607280138745
curr_Factors:  [101.3160728]
mat_Sqrt:  [[0.15]]
grads:  [-0.06963923]
Stock Position:  -0.06963923226158178
Bond Position:  [7.13202327]


portfolio before change:  [0.10335849]
curr_Stock_Price:  100.93607183713524
curr_Factors:  [100.93607184]
mat_Sqrt:  [[0.15]]
grads:  [0.00498083]
Stock Position:  0.004980833889997628
Bond Position:  [-0.39938732]


portfolio before change:  [0.10065037]
curr_Stock_Price:  100.39737561705518
curr_Factors:  [100.39737562]
mat_Sqrt:  [[0.15]]
grads:  [-0.05656914]
Stock Position:  -0.05656914019735489
Bond Position:  [5.78004359]


portfolio before change:  [0.09239179]
curr_Stock_Price:  100.54975284137907
curr_Factors:  [100.54975284]
mat_Sqrt:  [[0.15]]
grads:  [0.03683428]
Stock Position:  0.03683427885276837
Bond Position:  [-3.61128585]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.09239179]
Stock Price:  100.43595326580592
PL:  [-0.34356148]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-7.40947618e-02]
 [-2.07667174e-03]
 [ 5.77572945e-04]
 [ 2.84433205e-03]
 [ 7.01629355e-03]
 [ 1.21183874e-02]
 [ 1.01938543e-03]
 [ 1.01073631e-02]
 [-4.69126383e-03]
 [-1.96646035e-02]
 [ 1.02585714e-02]
 [-5.52225022e-03]
 [ 1.38900358e-02]
 [ 5.36717315e-03]
 [-1.45531226e-03]
 [-8.28350093e-03]
 [ 1.30936515e-02]
 [ 2.33089354e-02]
 [-1.23379951e-03]
 [-2.48010001e-03]
 [ 1.48406537e-02]
 [-1.06749472e-02]
 [ 4.31466390e-03]
 [ 1.92577035e-04]
 [ 1.78826999e-02]
 [ 1.75079728e-02]
 [ 9.54851022e-03]
 [ 4.26691060e-03]
 [ 6.73667842e-03]
 [-1.31685924e-02]
 [-5.68243007e-03]
 [ 3.32778321e-02]
 [ 6.67137185e-03]
 [-2.32774585e-03]
 [-4.47502464e-03]
 [-4.25210479e-03]
 [-6.83160027e-03]
 [ 3.44281214e-03]
 [ 1.95993661e-03]
 [-8.42358546e-03]
 [-2.81231197e-02]
 [-2.42017792e-03]
 [ 1.04866548e-02]
 [-1.16856926e-02]
 [ 1.31188793e-04]
 [ 2.30482146e-03]
 [-1.36286848e-02]
 [ 1.28456220e-02]
 [ 1.91884224e-02]
 [-1.03760571e-02]
 [-3.79742866e-03]
 [ 3.45013701e-03]
 [ 1.16525663e-03]
 [ 3.17713109e-03]
 [-2.84543526e-03]
 [ 8.51753043e-03]
 [-9.90964602e-03]
 [-1.50293343e-02]
 [ 1.41178975e-02]
 [ 7.87770622e-04]
 [ 1.26409342e-02]
 [-1.46265211e-02]
 [-1.27508168e-02]
 [-3.36257198e-03]
 [ 4.47994864e-02]
 [-1.78484105e-02]
 [ 2.24336825e-02]
 [ 3.30313192e-03]
 [ 8.72901295e-03]
 [-2.01184268e-02]
 [-7.71510435e-03]
 [-8.00225696e-03]
 [ 3.38549873e-03]
 [ 6.95537340e-03]
 [-9.02944019e-04]
 [-8.61332559e-03]
 [ 7.38419406e-03]
 [-4.05533145e-03]
 [ 1.78282446e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.81322941]
curr_Stock_Price:  100.75497342578466
curr_Factors:  [100.75497343]
mat_Sqrt:  [[0.15]]
grads:  [-0.49396508]
Stock Position:  -0.4939650788410551
Bond Position:  [63.5826678]


portfolio before change:  [14.00780836]
curr_Stock_Price:  100.36910624923316
curr_Factors:  [100.36910625]
mat_Sqrt:  [[0.15]]
grads:  [-0.01384448]
Stock Position:  -0.01384447826851692
Bond Position:  [15.39736627]


portfolio before change:  [14.00470652]
curr_Stock_Price:  100.66266788919478
curr_Factors:  [100.66266789]
mat_Sqrt:  [[0.15]]
grads:  [0.00385049]
Stock Position:  0.0038504862989428386
Bond Position:  [13.61710629]


portfolio before change:  [14.00798784]
curr_Stock_Price:  101.2938152877045
curr_Factors:  [101.29381529]
mat_Sqrt:  [[0.15]]
grads:  [0.01896221]
Stock Position:  0.01896221366156258
Bond Position:  [12.08723287]


portfolio before change:  [13.99629506]
curr_Stock_Price:  100.63733838479294
curr_Factors:  [100.63733838]
mat_Sqrt:  [[0.15]]
grads:  [0.04677529]
Stock Position:  0.04677529031834423
Bond Position:  [9.28895434]


portfolio before change:  [13.96593008]
curr_Stock_Price:  99.9757592145837
curr_Factors:  [99.97575921]
mat_Sqrt:  [[0.15]]
grads:  [0.08078925]
Stock Position:  0.0807892493808119
Bond Position:  [5.88896354]


portfolio before change:  [13.94028948]
curr_Stock_Price:  99.65382684221103
curr_Factors:  [99.65382684]
mat_Sqrt:  [[0.15]]
grads:  [0.0067959]
Stock Position:  0.006795902886825911
Bond Position:  [13.26305175]


portfolio before change:  [13.94698922]
curr_Stock_Price:  100.51769696687715
curr_Factors:  [100.51769697]
mat_Sqrt:  [[0.15]]
grads:  [0.06738242]
Stock Position:  0.06738242096028918
Bond Position:  [7.17386345]


portfolio before change:  [13.99303792]
curr_Stock_Price:  101.19443605615115
curr_Factors:  [101.19443606]
mat_Sqrt:  [[0.15]]
grads:  [-0.03127509]
Stock Position:  -0.03127509221420875
Bond Position:  [17.15790324]


portfolio before change:  [13.99224076]
curr_Stock_Price:  101.25421389988422
curr_Factors:  [101.2542139]
mat_Sqrt:  [[0.15]]
grads:  [-0.13109736]
Stock Position:  -0.13109735650443033
Bond Position:  [27.26640054]


portfolio before change:  [14.07207536]
curr_Stock_Price:  100.65824160333348
curr_Factors:  [100.6582416]
mat_Sqrt:  [[0.15]]
grads:  [0.06839048]
Stock Position:  0.06839047583704048
Bond Position:  [7.18801032]


portfolio before change:  [14.0525797]
curr_Stock_Price:  100.36660852084732
curr_Factors:  [100.36660852]
mat_Sqrt:  [[0.15]]
grads:  [-0.036815]
Stock Position:  -0.03681500148392765
Bond Position:  [17.74757654]


portfolio before change:  [14.01096142]
curr_Stock_Price:  101.52720987921596
curr_Factors:  [101.52720988]
mat_Sqrt:  [[0.15]]
grads:  [0.09260024]
Stock Position:  0.0926002386379079
Bond Position:  [4.60951755]


portfolio before change:  [14.03667644]
curr_Stock_Price:  101.8017979199483
curr_Factors:  [101.80179792]
mat_Sqrt:  [[0.15]]
grads:  [0.03578115]
Stock Position:  0.03578115435462491
Bond Position:  [10.39409059]


portfolio before change:  [14.04256072]
curr_Stock_Price:  101.94809360467313
curr_Factors:  [101.9480936]
mat_Sqrt:  [[0.15]]
grads:  [-0.00970208]
Stock Position:  -0.009702081763451713
Bond Position:  [15.03166946]


portfolio before change:  [14.03261102]
curr_Stock_Price:  103.07045119173183
curr_Factors:  [103.07045119]
mat_Sqrt:  [[0.15]]
grads:  [-0.05522334]
Stock Position:  -0.055223339500084734
Bond Position:  [19.72450554]


portfolio before change:  [14.02010105]
curr_Stock_Price:  103.31930955693214
curr_Factors:  [103.31930956]
mat_Sqrt:  [[0.15]]
grads:  [0.08729101]
Stock Position:  0.08729100978596498
Bond Position:  [5.00125419]


portfolio before change:  [14.03544573]
curr_Stock_Price:  103.49151616198712
curr_Factors:  [103.49151616]
mat_Sqrt:  [[0.15]]
grads:  [0.1553929]
Stock Position:  0.1553929027004669
Bond Position:  [-2.04640137]


portfolio before change:  [14.01720482]
curr_Stock_Price:  103.37495355504252
curr_Factors:  [103.37495356]
mat_Sqrt:  [[0.15]]
grads:  [-0.00822533]
Stock Position:  -0.008225330083253615
Bond Position:  [14.86749794]


portfolio before change:  [14.02104315]
curr_Stock_Price:  103.02128030012531
curr_Factors:  [103.0212803]
mat_Sqrt:  [[0.15]]
grads:  [-0.016534]
Stock Position:  -0.016534000049593316
Bond Position:  [15.724397]


portfolio before change:  [14.00857547]
curr_Stock_Price:  103.83478506471909
curr_Factors:  [103.83478506]
mat_Sqrt:  [[0.15]]
grads:  [0.09893769]
Stock Position:  0.09893769114568028
Bond Position:  [3.73540157]


portfolio before change:  [13.97095639]
curr_Stock_Price:  103.45219534947462
curr_Factors:  [103.45219535]
mat_Sqrt:  [[0.15]]
grads:  [-0.07116631]
Stock Position:  -0.07116631450893732
Bond Position:  [21.33326786]


portfolio before change:  [14.00840785]
curr_Stock_Price:  102.94467879276837
curr_Factors:  [102.94467879]
mat_Sqrt:  [[0.15]]
grads:  [0.02876443]
Stock Position:  0.028764426000914493
Bond Position:  [11.04726325]


portfolio before change:  [14.020682]
curr_Stock_Price:  103.34738738592293
curr_Factors:  [103.34738739]
mat_Sqrt:  [[0.15]]
grads:  [0.00128385]
Stock Position:  0.0012838469030591534
Bond Position:  [13.88799978]


portfolio before change:  [14.02144994]
curr_Stock_Price:  103.26942459042802
curr_Factors:  [103.26942459]
mat_Sqrt:  [[0.15]]
grads:  [0.119218]
Stock Position:  0.11921799927601343
Bond Position:  [1.70987575]


portfolio before change:  [13.99836675]
curr_Stock_Price:  103.07490651287976
curr_Factors:  [103.07490651]
mat_Sqrt:  [[0.15]]
grads:  [0.11671982]
Stock Position:  0.11671981838782391
Bond Position:  [1.96748239]


portfolio before change:  [13.98025192]
curr_Stock_Price:  102.91865365171728
curr_Factors:  [102.91865365]
mat_Sqrt:  [[0.15]]
grads:  [0.06365673]
Stock Position:  0.0636567348271775
Bond Position:  [7.42878648]


portfolio before change:  [13.95446818]
curr_Stock_Price:  102.50631625659871
curr_Factors:  [102.50631626]
mat_Sqrt:  [[0.15]]
grads:  [0.02844607]
Stock Position:  0.028446070636501977
Bond Position:  [11.03856627]


portfolio before change:  [13.96950812]
curr_Stock_Price:  103.0107797382726
curr_Factors:  [103.01077974]
mat_Sqrt:  [[0.15]]
grads:  [0.04491119]
Stock Position:  0.04491118949426671
Bond Position:  [9.34317147]


portfolio before change:  [13.96223633]
curr_Stock_Price:  102.83586221744466
curr_Factors:  [102.83586222]
mat_Sqrt:  [[0.15]]
grads:  [-0.08779062]
Stock Position:  -0.08779061591402351
Bond Position:  [22.99026001]


portfolio before change:  [14.006448]
curr_Stock_Price:  102.34862637483555
curr_Factors:  [102.34862637]
mat_Sqrt:  [[0.15]]
grads:  [-0.03788287]
Stock Position:  -0.03788286714322668
Bond Position:  [17.88370742]


portfolio before change:  [14.00848471]
curr_Stock_Price:  102.32436877492975
curr_Factors:  [102.32436877]
mat_Sqrt:  [[0.15]]
grads:  [0.22185221]
Stock Position:  0.22185221374883932
Bond Position:  [-8.69240302]


portfolio before change:  [14.06847138]
curr_Stock_Price:  102.5972078676887
curr_Factors:  [102.59720787]
mat_Sqrt:  [[0.15]]
grads:  [0.04447581]
Stock Position:  0.04447581230020311
Bond Position:  [9.50537722]


portfolio before change:  [14.0687173]
curr_Stock_Price:  102.58937935289195
curr_Factors:  [102.58937935]
mat_Sqrt:  [[0.15]]
grads:  [-0.01551831]
Stock Position:  -0.01551830569220459
Bond Position:  [15.66073065]


portfolio before change:  [14.07213995]
curr_Stock_Price:  102.43189946979419
curr_Factors:  [102.43189947]
mat_Sqrt:  [[0.15]]
grads:  [-0.0298335]
Stock Position:  -0.029833497630373535
Bond Position:  [17.12804178]


portfolio before change:  [14.07558471]
curr_Stock_Price:  102.3523168854008
curr_Factors:  [102.35231689]
mat_Sqrt:  [[0.15]]
grads:  [-0.02834737]
Stock Position:  -0.02834736529050651
Bond Position:  [16.97700323]


portfolio before change:  [14.077771]
curr_Stock_Price:  102.31262379946449
curr_Factors:  [102.3126238]
mat_Sqrt:  [[0.15]]
grads:  [-0.045544]
Stock Position:  -0.045544001787387975
Bond Position:  [18.73749733]


portfolio before change:  [14.05279884]
curr_Stock_Price:  102.88664648317993
curr_Factors:  [102.88664648]
mat_Sqrt:  [[0.15]]
grads:  [0.02295208]
Stock Position:  0.022952080933604374
Bond Position:  [11.69133621]


portfolio before change:  [14.04535213]
curr_Stock_Price:  102.53036318177008
curr_Factors:  [102.53036318]
mat_Sqrt:  [[0.15]]
grads:  [0.01306624]
Stock Position:  0.01306624409318662
Bond Position:  [12.70566538]


portfolio before change:  [14.04655494]
curr_Stock_Price:  102.56164037838201
curr_Factors:  [102.56164038]
mat_Sqrt:  [[0.15]]
grads:  [-0.05615724]
Stock Position:  -0.056157236416302235
Bond Position:  [19.80613322]


portfolio before change:  [14.06405728]
curr_Stock_Price:  102.27201757454509
curr_Factors:  [102.27201757]
mat_Sqrt:  [[0.15]]
grads:  [-0.18748746]
Stock Position:  -0.18748746457006873
Bond Position:  [33.23877855]


portfolio before change:  [14.11250662]
curr_Stock_Price:  102.02468448782838
curr_Factors:  [102.02468449]
mat_Sqrt:  [[0.15]]
grads:  [-0.01613452]
Stock Position:  -0.01613451943510032
Bond Position:  [15.75862587]


portfolio before change:  [14.11726576]
curr_Stock_Price:  101.79076352140206
curr_Factors:  [101.79076352]
mat_Sqrt:  [[0.15]]
grads:  [0.06991103]
Stock Position:  0.06991103195882246
Bond Position:  [7.00096844]


portfolio before change:  [14.1485567]
curr_Stock_Price:  102.23208678818773
curr_Factors:  [102.23208679]
mat_Sqrt:  [[0.15]]
grads:  [-0.07790462]
Stock Position:  -0.07790461749473836
Bond Position:  [22.11290832]


portfolio before change:  [14.15073289]
curr_Stock_Price:  102.22189366584625
curr_Factors:  [102.22189367]
mat_Sqrt:  [[0.15]]
grads:  [0.00087459]
Stock Position:  0.0008745919528593653
Bond Position:  [14.06133045]


portfolio before change:  [14.15182452]
curr_Stock_Price:  102.46516597577784
curr_Factors:  [102.46516598]
mat_Sqrt:  [[0.15]]
grads:  [0.01536548]
Stock Position:  0.015365476419008858
Bond Position:  [12.57739843]


portfolio before change:  [14.1644694]
curr_Stock_Price:  103.23694574699401
curr_Factors:  [103.23694575]
mat_Sqrt:  [[0.15]]
grads:  [-0.0908579]
Stock Position:  -0.09085789839853146
Bond Position:  [23.54436132]


portfolio before change:  [14.03386882]
curr_Stock_Price:  104.69055788244968
curr_Factors:  [104.69055788]
mat_Sqrt:  [[0.15]]
grads:  [0.08563748]
Stock Position:  0.08563747971233257
Bond Position:  [5.06843329]


portfolio before change:  [14.03217943]
curr_Stock_Price:  104.66713147929502
curr_Factors:  [104.66713148]
mat_Sqrt:  [[0.15]]
grads:  [0.12792282]
Stock Position:  0.12792281595686741
Bond Position:  [0.64286523]


portfolio before change:  [13.92256583]
curr_Stock_Price:  103.8099444553544
curr_Factors:  [103.80994446]
mat_Sqrt:  [[0.15]]
grads:  [-0.06917371]
Stock Position:  -0.06917371431025837
Bond Position:  [21.10348527]


portfolio before change:  [13.92819713]
curr_Stock_Price:  103.74760447610299
curr_Factors:  [103.74760448]
mat_Sqrt:  [[0.15]]
grads:  [-0.02531619]
Stock Position:  -0.02531619107156378
Bond Position:  [16.55469131]


portfolio before change:  [13.93251761]
curr_Stock_Price:  103.6178148923203
curr_Factors:  [103.61781489]
mat_Sqrt:  [[0.15]]
grads:  [0.02300091]
Stock Position:  0.023000913390530058
Bond Position:  [11.54921322]


portfolio before change:  [13.91004486]
curr_Stock_Price:  102.60939437442201
curr_Factors:  [102.60939437]
mat_Sqrt:  [[0.15]]
grads:  [0.00776838]
Stock Position:  0.0077683775479125815
Bond Position:  [13.11293635]


portfolio before change:  [13.90914698]
curr_Stock_Price:  102.38830978731934
curr_Factors:  [102.38830979]
mat_Sqrt:  [[0.15]]
grads:  [0.02118087]
Stock Position:  0.021180873905078387
Bond Position:  [11.7404731]


portfolio before change:  [13.915461]
curr_Stock_Price:  102.65176551893252
curr_Factors:  [102.65176552]
mat_Sqrt:  [[0.15]]
grads:  [-0.01896957]
Stock Position:  -0.018969568372781978
Bond Position:  [15.86272069]


portfolio before change:  [13.92917831]
curr_Stock_Price:  101.98090911848227
curr_Factors:  [101.98090912]
mat_Sqrt:  [[0.15]]
grads:  [0.05678354]
Stock Position:  0.056783536208188164
Bond Position:  [8.13834166]


portfolio before change:  [13.93574296]
curr_Stock_Price:  102.08755949799617
curr_Factors:  [102.0875595]
mat_Sqrt:  [[0.15]]
grads:  [-0.06606431]
Stock Position:  -0.0660643068286642
Bond Position:  [20.68008681]


portfolio before change:  [13.9501547]
curr_Stock_Price:  101.8889772777426
curr_Factors:  [101.88897728]
mat_Sqrt:  [[0.15]]
grads:  [-0.10019556]
Stock Position:  -0.1001955621223755
Bond Position:  [24.15897805]


portfolio before change:  [13.88284562]
curr_Stock_Price:  102.57582466733871
curr_Factors:  [102.57582467]
mat_Sqrt:  [[0.15]]
grads:  [0.09411932]
Stock Position:  0.09411931668426919
Bond Position:  [4.2284791]


portfolio before change:  [13.96435874]
curr_Stock_Price:  103.43907812624865
curr_Factors:  [103.43907813]
mat_Sqrt:  [[0.15]]
grads:  [0.0052518]
Stock Position:  0.0052518041443843245
Bond Position:  [13.42111696]


portfolio before change:  [13.96657585]
curr_Stock_Price:  103.7015148247677
curr_Factors:  [103.70151482]
mat_Sqrt:  [[0.15]]
grads:  [0.08427289]
Stock Position:  0.08427289496602898
Bond Position:  [5.22734898]


portfolio before change:  [14.04660229]
curr_Stock_Price:  104.64724858290954
curr_Factors:  [104.64724858]
mat_Sqrt:  [[0.15]]
grads:  [-0.09751014]
Stock Position:  -0.09751014077024395
Bond Position:  [24.25077023]


portfolio before change:  [14.05655999]
curr_Stock_Price:  104.56067322560797
curr_Factors:  [104.56067323]
mat_Sqrt:  [[0.15]]
grads:  [-0.08500545]
Stock Position:  -0.0850054452118026
Bond Position:  [22.94478657]


portfolio before change:  [14.10448062]
curr_Stock_Price:  104.01380784351198
curr_Factors:  [104.01380784]
mat_Sqrt:  [[0.15]]
grads:  [-0.02241715]
Stock Position:  -0.022417146503275493
Bond Position:  [16.43617338]


portfolio before change:  [14.0866373]
curr_Stock_Price:  104.85560126103888
curr_Factors:  [104.85560126]
mat_Sqrt:  [[0.15]]
grads:  [0.29866324]
Stock Position:  0.29866324295689034
Bond Position:  [-17.22987661]


portfolio before change:  [13.84671362]
curr_Stock_Price:  104.05588187228565
curr_Factors:  [104.05588187]
mat_Sqrt:  [[0.15]]
grads:  [-0.1189894]
Stock Position:  -0.1189894036273581
Bond Position:  [26.22826094]


portfolio before change:  [13.8904629]
curr_Stock_Price:  103.70198511179431
curr_Factors:  [103.70198511]
mat_Sqrt:  [[0.15]]
grads:  [0.14955788]
Stock Position:  0.1495578835530094
Bond Position:  [-1.61898652]


portfolio before change:  [13.84205235]
curr_Stock_Price:  103.37897068232405
curr_Factors:  [103.37897068]
mat_Sqrt:  [[0.15]]
grads:  [0.02202088]
Stock Position:  0.02202087945510585
Bond Position:  [11.5655565]


portfolio before change:  [13.84336606]
curr_Stock_Price:  103.4058015114048
curr_Factors:  [103.40580151]
mat_Sqrt:  [[0.15]]
grads:  [0.05819342]
Stock Position:  0.058193419661830954
Bond Position:  [7.82582886]


portfolio before change:  [13.85768963]
curr_Stock_Price:  103.64353347147794
curr_Factors:  [103.64353347]
mat_Sqrt:  [[0.15]]
grads:  [-0.13412285]
Stock Position:  -0.13412284563115437
Bond Position:  [27.75865527]


portfolio before change:  [13.90174107]
curr_Stock_Price:  103.32802811850222
curr_Factors:  [103.32802812]
mat_Sqrt:  [[0.15]]
grads:  [-0.05143403]
Stock Position:  -0.051434028979591824
Bond Position:  [19.21631787]


portfolio before change:  [13.95551517]
curr_Stock_Price:  102.30588312368567
curr_Factors:  [102.30588312]
mat_Sqrt:  [[0.15]]
grads:  [-0.05334838]
Stock Position:  -0.05334837973813618
Bond Position:  [19.41336827]


portfolio before change:  [13.91854271]
curr_Stock_Price:  103.0216653945472
curr_Factors:  [103.02166539]
mat_Sqrt:  [[0.15]]
grads:  [0.02256999]
Stock Position:  0.022569991516829015
Bond Position:  [11.5933446]


portfolio before change:  [13.94069143]
curr_Stock_Price:  103.97089523386602
curr_Factors:  [103.97089523]
mat_Sqrt:  [[0.15]]
grads:  [0.04636916]
Stock Position:  0.0463691559717699
Bond Position:  [9.11964877]


portfolio before change:  [13.91139517]
curr_Stock_Price:  103.32679772507332
curr_Factors:  [103.32679773]
mat_Sqrt:  [[0.15]]
grads:  [-0.00601963]
Stock Position:  -0.006019626791439909
Bond Position:  [14.53338393]


portfolio before change:  [13.91172632]
curr_Stock_Price:  103.42268635677684
curr_Factors:  [103.42268636]
mat_Sqrt:  [[0.15]]
grads:  [-0.05742217]
Stock Position:  -0.05742217061677056
Bond Position:  [19.85048146]


portfolio before change:  [13.90673963]
curr_Stock_Price:  103.53113543078892
curr_Factors:  [103.53113543]
mat_Sqrt:  [[0.15]]
grads:  [0.04922796]
Stock Position:  0.04922796039135282
Bond Position:  [8.810113]


portfolio before change:  [13.87229239]
curr_Stock_Price:  102.82020023372225
curr_Factors:  [102.82020023]
mat_Sqrt:  [[0.15]]
grads:  [-0.02703554]
Stock Position:  -0.02703554298237846
Bond Position:  [16.65209233]


portfolio before change:  [13.88628983]
curr_Stock_Price:  102.34095516322976
curr_Factors:  [102.34095516]
mat_Sqrt:  [[0.15]]
grads:  [0.11885496]
Stock Position:  0.1188549636733463
Bond Position:  [1.72255932]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.88628983]
Stock Price:  102.27998112978064
PL:  [11.6063087]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.48050127e-02]
 [-2.30684039e-03]
 [ 1.16075825e-04]
 [ 2.18502386e-03]
 [ 6.24100251e-03]
 [ 1.17583792e-02]
 [ 1.22139184e-03]
 [ 1.27808563e-02]
 [ 1.71510764e-02]
 [ 2.11165589e-02]
 [ 1.04627737e-02]
 [-1.31259311e-02]
 [ 1.41668385e-02]
 [ 9.88295451e-03]
 [-4.38106837e-02]
 [ 2.02575416e-02]
 [-5.69789978e-03]
 [-1.47765667e-02]
 [-2.20995718e-02]
 [ 1.61670153e-02]
 [-8.34254298e-02]
 [-3.51135589e-02]
 [ 1.68258541e-03]
 [-3.20258057e-03]
 [-8.10496683e-03]
 [ 1.63165407e-02]
 [ 2.01316811e-02]
 [ 5.13718112e-02]
 [ 7.63736765e-05]
 [ 7.00337974e-03]
 [-3.44079573e-03]
 [-5.59023875e-02]
 [ 2.54623203e-02]
 [ 1.14539269e-02]
 [-3.79879242e-02]
 [ 8.74125377e-03]
 [ 8.58601087e-04]
 [-1.67132684e-02]
 [ 1.17311806e-02]
 [-2.22212556e-02]
 [ 6.06354207e-02]
 [ 4.73320410e-03]
 [ 1.16544103e-02]
 [-1.01881841e-02]
 [-3.85505875e-03]
 [-1.51696975e-02]
 [-1.31390663e-02]
 [ 1.52682406e-03]
 [-2.73865864e-03]
 [-6.97365643e-03]
 [-3.87513697e-03]
 [ 2.92895322e-03]
 [ 3.59170405e-03]
 [ 1.15939806e-04]
 [ 9.58021589e-03]
 [ 8.84366653e-03]
 [ 7.66423724e-03]
 [ 4.66823031e-03]
 [ 1.35307471e-02]
 [-2.05787402e-03]
 [ 1.46853976e-03]
 [-1.91370555e-02]
 [-1.27874545e-02]
 [-1.87094550e-03]
 [-9.54555741e-03]
 [-1.98580526e-02]
 [ 1.05537835e-02]
 [ 2.26352871e-03]
 [ 1.04791558e-02]
 [-1.73526237e-02]
 [-5.61740521e-03]
 [-1.08298774e-03]
 [ 1.67736965e-03]
 [ 8.76946381e-03]
 [ 1.00491069e-02]
 [-2.87081187e-03]
 [-4.85232104e-03]
 [-8.74973344e-03]
 [-3.17305765e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.26758546]
curr_Stock_Price:  100.27000991219582
curr_Factors:  [100.27000991]
mat_Sqrt:  [[0.15]]
grads:  [-0.29870008]
Stock Position:  -0.298700084483833
Bond Position:  [36.21824589]


portfolio before change:  [6.28624779]
curr_Stock_Price:  100.21510998008955
curr_Factors:  [100.21510998]
mat_Sqrt:  [[0.15]]
grads:  [-0.01537894]
Stock Position:  -0.015378935950049048
Bond Position:  [7.82744955]


portfolio before change:  [6.28803023]
curr_Stock_Price:  100.13102014114696
curr_Factors:  [100.13102014]
mat_Sqrt:  [[0.15]]
grads:  [0.00077384]
Stock Position:  0.0007738388310957508
Bond Position:  [6.21054496]


portfolio before change:  [6.28835325]
curr_Stock_Price:  100.0468217666065
curr_Factors:  [100.04682177]
mat_Sqrt:  [[0.15]]
grads:  [0.01456683]
Stock Position:  0.014566825710259556
Bond Position:  [4.83098863]


portfolio before change:  [6.30965679]
curr_Stock_Price:  101.48856341759526
curr_Factors:  [101.48856342]
mat_Sqrt:  [[0.15]]
grads:  [0.04160668]
Stock Position:  0.04160668339219378
Bond Position:  [2.08705427]


portfolio before change:  [6.2633544]
curr_Stock_Price:  100.37256883031658
curr_Factors:  [100.37256883]
mat_Sqrt:  [[0.15]]
grads:  [0.07838919]
Stock Position:  0.07838919448609898
Bond Position:  [-1.60477042]


portfolio before change:  [6.24990052]
curr_Stock_Price:  100.20221906164633
curr_Factors:  [100.20221906]
mat_Sqrt:  [[0.15]]
grads:  [0.00814261]
Stock Position:  0.008142612262266563
Bond Position:  [5.4339927]


portfolio before change:  [6.2462653]
curr_Stock_Price:  99.71406363274664
curr_Factors:  [99.71406363]
mat_Sqrt:  [[0.15]]
grads:  [0.08520571]
Stock Position:  0.08520570880804858
Bond Position:  [-2.24994217]


portfolio before change:  [6.1885361]
curr_Stock_Price:  99.03818669585898
curr_Factors:  [99.0381867]
mat_Sqrt:  [[0.15]]
grads:  [0.11434051]
Stock Position:  0.11434050939051608
Bond Position:  [-5.13554062]


portfolio before change:  [6.0406787]
curr_Stock_Price:  97.74786171103509
curr_Factors:  [97.74786171]
mat_Sqrt:  [[0.15]]
grads:  [0.14077706]
Stock Position:  0.14077705910873453
Bond Position:  [-7.71997781]


portfolio before change:  [5.87815914]
curr_Stock_Price:  96.59684290469298
curr_Factors:  [96.5968429]
mat_Sqrt:  [[0.15]]
grads:  [0.06975182]
Stock Position:  0.06975182466585317
Bond Position:  [-0.85964691]


portfolio before change:  [5.88306732]
curr_Stock_Price:  96.66797950894956
curr_Factors:  [96.66797951]
mat_Sqrt:  [[0.15]]
grads:  [-0.08750621]
Stock Position:  -0.08750620746136846
Bond Position:  [14.34211559]


portfolio before change:  [5.8943856]
curr_Stock_Price:  96.54888093137544
curr_Factors:  [96.54888093]
mat_Sqrt:  [[0.15]]
grads:  [0.09444559]
Stock Position:  0.0944455897475663
Bond Position:  [-3.2242304]


portfolio before change:  [5.87577275]
curr_Stock_Price:  96.35393980642895
curr_Factors:  [96.35393981]
mat_Sqrt:  [[0.15]]
grads:  [0.06588636]
Stock Position:  0.06588636336699905
Bond Position:  [-0.47263794]


portfolio before change:  [5.84826593]
curr_Stock_Price:  95.93689947155384
curr_Factors:  [95.93689947]
mat_Sqrt:  [[0.15]]
grads:  [-0.29207122]
Stock Position:  -0.2920712245213705
Bond Position:  [33.86867364]


portfolio before change:  [5.66843689]
curr_Stock_Price:  96.55984992953188
curr_Factors:  [96.55984993]
mat_Sqrt:  [[0.15]]
grads:  [0.13505028]
Stock Position:  0.13505027721598736
Bond Position:  [-7.37199761]


portfolio before change:  [5.61926083]
curr_Stock_Price:  96.19913019808924
curr_Factors:  [96.1991302]
mat_Sqrt:  [[0.15]]
grads:  [-0.037986]
Stock Position:  -0.03798599854233717
Bond Position:  [9.27348084]


portfolio before change:  [5.62564922]
curr_Stock_Price:  96.04621117529886
curr_Factors:  [96.04621118]
mat_Sqrt:  [[0.15]]
grads:  [-0.09851044]
Stock Position:  -0.09851044488131855
Bond Position:  [15.08720421]


portfolio before change:  [5.54943542]
curr_Stock_Price:  96.82944561977517
curr_Factors:  [96.82944562]
mat_Sqrt:  [[0.15]]
grads:  [-0.14733048]
Stock Position:  -0.1473304789275832
Bond Position:  [19.81536402]


portfolio before change:  [5.65346498]
curr_Stock_Price:  96.13175522219441
curr_Factors:  [96.13175522]
mat_Sqrt:  [[0.15]]
grads:  [0.1077801]
Stock Position:  0.1077801023017276
Bond Position:  [-4.70762543]


portfolio before change:  [5.53722371]
curr_Stock_Price:  95.05598113762737
curr_Factors:  [95.05598114]
mat_Sqrt:  [[0.15]]
grads:  [-0.55616953]
Stock Position:  -0.5561695316757068
Bond Position:  [58.40446422]


portfolio before change:  [5.35124723]
curr_Stock_Price:  95.39693269156464
curr_Factors:  [95.39693269]
mat_Sqrt:  [[0.15]]
grads:  [-0.23409039]
Stock Position:  -0.23409039292201617
Bond Position:  [27.68275269]


portfolio before change:  [5.29402557]
curr_Stock_Price:  95.64876655306742
curr_Factors:  [95.64876655]
mat_Sqrt:  [[0.15]]
grads:  [0.01121724]
Stock Position:  0.011217236093165404
Bond Position:  [4.22111078]


portfolio before change:  [5.29618682]
curr_Stock_Price:  95.81791894159726
curr_Factors:  [95.81791894]
mat_Sqrt:  [[0.15]]
grads:  [-0.02135054]
Stock Position:  -0.021350537107477786
Bond Position:  [7.34195086]


portfolio before change:  [5.29749615]
curr_Stock_Price:  95.77808648800249
curr_Factors:  [95.77808649]
mat_Sqrt:  [[0.15]]
grads:  [-0.05403311]
Stock Position:  -0.05403311220023318
Bond Position:  [10.47268425]


portfolio before change:  [5.32005182]
curr_Stock_Price:  95.37275900439377
curr_Factors:  [95.372759]
mat_Sqrt:  [[0.15]]
grads:  [0.10877694]
Stock Position:  0.10877693783894449
Bond Position:  [-5.05430486]


portfolio before change:  [5.31572739]
curr_Stock_Price:  95.33590815085886
curr_Factors:  [95.33590815]
mat_Sqrt:  [[0.15]]
grads:  [0.13421121]
Stock Position:  0.13421120761705194
Bond Position:  [-7.47941997]


portfolio before change:  [5.369285]
curr_Stock_Price:  95.73844591507603
curr_Factors:  [95.73844592]
mat_Sqrt:  [[0.15]]
grads:  [0.34247874]
Stock Position:  0.34247874134261264
Bond Position:  [-27.41909746]


portfolio before change:  [5.47546449]
curr_Stock_Price:  96.05348223526185
curr_Factors:  [96.05348224]
mat_Sqrt:  [[0.15]]
grads:  [0.00050916]
Stock Position:  0.0005091578431102792
Bond Position:  [5.42655811]


portfolio before change:  [5.47583753]
curr_Stock_Price:  96.12000114655316
curr_Factors:  [96.12000115]
mat_Sqrt:  [[0.15]]
grads:  [0.0466892]
Stock Position:  0.04668919826174331
Bond Position:  [0.98807174]


portfolio before change:  [5.4504752]
curr_Stock_Price:  95.57546222558827
curr_Factors:  [95.57546223]
mat_Sqrt:  [[0.15]]
grads:  [-0.02293864]
Stock Position:  -0.02293863818940379
Bond Position:  [7.64284615]


portfolio before change:  [5.46785671]
curr_Stock_Price:  94.83854772958608
curr_Factors:  [94.83854773]
mat_Sqrt:  [[0.15]]
grads:  [-0.37268258]
Stock Position:  -0.37268258309167757
Bond Position:  [40.81253165]


portfolio before change:  [5.63233389]
curr_Stock_Price:  94.40405915820827
curr_Factors:  [94.40405916]
mat_Sqrt:  [[0.15]]
grads:  [0.1697488]
Stock Position:  0.16974880227359293
Bond Position:  [-10.39264208]


portfolio before change:  [5.77896971]
curr_Stock_Price:  95.27172579405035
curr_Factors:  [95.27172579]
mat_Sqrt:  [[0.15]]
grads:  [0.07635951]
Stock Position:  0.07635951284882889
Bond Position:  [-1.49593286]


portfolio before change:  [5.75287454]
curr_Stock_Price:  94.93120933641957
curr_Factors:  [94.93120934]
mat_Sqrt:  [[0.15]]
grads:  [-0.25325283]
Stock Position:  -0.2532528282173926
Bond Position:  [29.79447179]


portfolio before change:  [5.82452624]
curr_Stock_Price:  94.65563692445691
curr_Factors:  [94.65563692]
mat_Sqrt:  [[0.15]]
grads:  [0.05827503]
Stock Position:  0.05827502516655397
Bond Position:  [0.30846662]


portfolio before change:  [5.83815068]
curr_Stock_Price:  94.88910149584072
curr_Factors:  [94.8891015]
mat_Sqrt:  [[0.15]]
grads:  [0.00572401]
Stock Position:  0.005724007247719267
Bond Position:  [5.29500477]


portfolio before change:  [5.83549606]
curr_Stock_Price:  94.36751513982678
curr_Factors:  [94.36751514]
mat_Sqrt:  [[0.15]]
grads:  [-0.11142179]
Stock Position:  -0.11142178948628621
Bond Position:  [16.35009347]


portfolio before change:  [5.91909028]
curr_Stock_Price:  93.62643649164959
curr_Factors:  [93.62643649]
mat_Sqrt:  [[0.15]]
grads:  [0.07820787]
Stock Position:  0.07820787089476032
Bond Position:  [-1.40323398]


portfolio before change:  [5.95013666]
curr_Stock_Price:  94.0245304243401
curr_Factors:  [94.02453042]
mat_Sqrt:  [[0.15]]
grads:  [-0.1481417]
Stock Position:  -0.14814170370796037
Bond Position:  [19.87909078]


portfolio before change:  [5.96751808]
curr_Stock_Price:  93.91558779408231
curr_Factors:  [93.91558779]
mat_Sqrt:  [[0.15]]
grads:  [0.40423614]
Stock Position:  0.4042361381059486
Bond Position:  [-31.99655643]


portfolio before change:  [5.82482817]
curr_Stock_Price:  93.56754847580561
curr_Factors:  [93.56754848]
mat_Sqrt:  [[0.15]]
grads:  [0.03155469]
Stock Position:  0.03155469398983701
Bond Position:  [2.87233281]


portfolio before change:  [5.84556924]
curr_Stock_Price:  94.21916461805775
curr_Factors:  [94.21916462]
mat_Sqrt:  [[0.15]]
grads:  [0.07769607]
Stock Position:  0.0776960685068458
Bond Position:  [-1.47488943]


portfolio before change:  [5.84367958]
curr_Stock_Price:  94.19602994478406
curr_Factors:  [94.19602994]
mat_Sqrt:  [[0.15]]
grads:  [-0.06792123]
Stock Position:  -0.06792122733688528
Bond Position:  [12.24158955]


portfolio before change:  [5.81314636]
curr_Stock_Price:  94.6568336312866
curr_Factors:  [94.65683363]
mat_Sqrt:  [[0.15]]
grads:  [-0.02570039]
Stock Position:  -0.02570039167431958
Bond Position:  [8.24586406]


portfolio before change:  [5.79933474]
curr_Stock_Price:  95.21429597456759
curr_Factors:  [95.21429597]
mat_Sqrt:  [[0.15]]
grads:  [-0.10113132]
Stock Position:  -0.10113131645839954
Bond Position:  [15.42848184]


portfolio before change:  [5.82312476]
curr_Stock_Price:  94.98859230941639
curr_Factors:  [94.98859231]
mat_Sqrt:  [[0.15]]
grads:  [-0.08759378]
Stock Position:  -0.08759377566085441
Bond Position:  [14.1435342]


portfolio before change:  [5.83056415]
curr_Stock_Price:  94.91375368804744
curr_Factors:  [94.91375369]
mat_Sqrt:  [[0.15]]
grads:  [0.01017883]
Stock Position:  0.010178827095763926
Bond Position:  [4.86445347]


portfolio before change:  [5.83413348]
curr_Stock_Price:  95.23454608469403
curr_Factors:  [95.23454608]
mat_Sqrt:  [[0.15]]
grads:  [-0.01825772]
Stock Position:  -0.018257724274867618
Bond Position:  [7.57289957]


portfolio before change:  [5.83067071]
curr_Stock_Price:  95.45013131243222
curr_Factors:  [95.45013131]
mat_Sqrt:  [[0.15]]
grads:  [-0.04649104]
Stock Position:  -0.04649104284321244
Bond Position:  [10.26824685]


portfolio before change:  [5.78952554]
curr_Stock_Price:  96.3489486631308
curr_Factors:  [96.34894866]
mat_Sqrt:  [[0.15]]
grads:  [-0.02583425]
Stock Position:  -0.02583424646600227
Bond Position:  [8.27862802]


portfolio before change:  [5.78460486]
curr_Stock_Price:  96.55944847660203
curr_Factors:  [96.55944848]
mat_Sqrt:  [[0.15]]
grads:  [0.01952635]
Stock Position:  0.0195263548196724
Bond Position:  [3.89915081]


portfolio before change:  [5.7775942]
curr_Stock_Price:  96.18793196407388
curr_Factors:  [96.18793196]
mat_Sqrt:  [[0.15]]
grads:  [0.02394469]
Stock Position:  0.023944693636040324
Bond Position:  [3.47440364]


portfolio before change:  [5.78154797]
curr_Stock_Price:  96.34398341743658
curr_Factors:  [96.34398342]
mat_Sqrt:  [[0.15]]
grads:  [0.00077293]
Stock Position:  0.0007729320379523848
Bond Position:  [5.70708061]


portfolio before change:  [5.78148819]
curr_Stock_Price:  95.80514897492417
curr_Factors:  [95.80514897]
mat_Sqrt:  [[0.15]]
grads:  [0.06386811]
Stock Position:  0.06386810596235559
Bond Position:  [-0.33740522]


portfolio before change:  [5.82032758]
curr_Stock_Price:  96.41359797470756
curr_Factors:  [96.41359797]
mat_Sqrt:  [[0.15]]
grads:  [0.05895778]
Stock Position:  0.05895777687592429
Bond Position:  [0.13599619]


portfolio before change:  [5.787933]
curr_Stock_Price:  95.86399987758887
curr_Factors:  [95.86399988]
mat_Sqrt:  [[0.15]]
grads:  [0.05109491]
Stock Position:  0.05109491495233909
Bond Position:  [0.88977008]


portfolio before change:  [5.82835915]
curr_Stock_Price:  96.65410849563874
curr_Factors:  [96.6541085]
mat_Sqrt:  [[0.15]]
grads:  [0.03112154]
Stock Position:  0.031121535392535978
Bond Position:  [2.82033489]


portfolio before change:  [5.83651435]
curr_Stock_Price:  96.91048826640183
curr_Factors:  [96.91048827]
mat_Sqrt:  [[0.15]]
grads:  [0.09020498]
Stock Position:  0.09020498042667112
Bond Position:  [-2.90529434]


portfolio before change:  [5.80639874]
curr_Stock_Price:  96.57864377390062
curr_Factors:  [96.57864377]
mat_Sqrt:  [[0.15]]
grads:  [-0.01371916]
Stock Position:  -0.013719160110117543
Bond Position:  [7.13137662]


portfolio before change:  [5.79887507]
curr_Stock_Price:  97.15953952380991
curr_Factors:  [97.15953952]
mat_Sqrt:  [[0.15]]
grads:  [0.00979027]
Stock Position:  0.009790265066582614
Bond Position:  [4.84765742]


portfolio before change:  [5.79360282]
curr_Stock_Price:  96.59007265441053
curr_Factors:  [96.59007265]
mat_Sqrt:  [[0.15]]
grads:  [-0.12758037]
Stock Position:  -0.12758036986739127
Bond Position:  [18.11660002]


portfolio before change:  [5.82407955]
curr_Stock_Price:  96.36006543953947
curr_Factors:  [96.36006544]
mat_Sqrt:  [[0.15]]
grads:  [-0.0852497]
Stock Position:  -0.0852496963870322
Bond Position:  [14.03874587]


portfolio before change:  [5.81916132]
curr_Stock_Price:  96.42805023293167
curr_Factors:  [96.42805023]
mat_Sqrt:  [[0.15]]
grads:  [-0.01247297]
Stock Position:  -0.012472970013751894
Bond Position:  [7.0219055]


portfolio before change:  [5.81174775]
curr_Stock_Price:  97.05760738988407
curr_Factors:  [97.05760739]
mat_Sqrt:  [[0.15]]
grads:  [-0.06363705]
Stock Position:  -0.06363704941432817
Bond Position:  [11.98820751]


portfolio before change:  [5.79634609]
curr_Stock_Price:  97.31140520332683
curr_Factors:  [97.3114052]
mat_Sqrt:  [[0.15]]
grads:  [-0.13238702]
Stock Position:  -0.13238701717377507
Bond Position:  [18.67911277]


portfolio before change:  [5.7104701]
curr_Stock_Price:  97.96889774705772
curr_Factors:  [97.96889775]
mat_Sqrt:  [[0.15]]
grads:  [0.07035856]
Stock Position:  0.07035855693712496
Bond Position:  [-1.18248017]


portfolio before change:  [5.68279331]
curr_Stock_Price:  97.57658036689534
curr_Factors:  [97.57658037]
mat_Sqrt:  [[0.15]]
grads:  [0.01509019]
Stock Position:  0.015090191399386547
Bond Position:  [4.21034403]


portfolio before change:  [5.68246206]
curr_Stock_Price:  97.53719043933847
curr_Factors:  [97.53719044]
mat_Sqrt:  [[0.15]]
grads:  [0.06986104]
Stock Position:  0.06986103856532774
Bond Position:  [-1.13158736]


portfolio before change:  [5.69717994]
curr_Stock_Price:  97.74887651654228
curr_Factors:  [97.74887652]
mat_Sqrt:  [[0.15]]
grads:  [-0.11568416]
Stock Position:  -0.11568415826156461
Bond Position:  [17.00517644]


portfolio before change:  [5.51770324]
curr_Stock_Price:  99.30950124208016
curr_Factors:  [99.30950124]
mat_Sqrt:  [[0.15]]
grads:  [-0.03744937]
Stock Position:  -0.03744936809852044
Bond Position:  [9.23678131]


portfolio before change:  [5.5222264]
curr_Stock_Price:  99.20413665331726
curr_Factors:  [99.20413665]
mat_Sqrt:  [[0.15]]
grads:  [-0.00721992]
Stock Position:  -0.0072199182380477235
Bond Position:  [6.23847215]


portfolio before change:  [5.52190728]
curr_Stock_Price:  99.30234229765685
curr_Factors:  [99.3023423]
mat_Sqrt:  [[0.15]]
grads:  [0.01118246]
Stock Position:  0.011182464302096457
Bond Position:  [4.41146238]


portfolio before change:  [5.5222624]
curr_Stock_Price:  99.30944283970065
curr_Factors:  [99.30944284]
mat_Sqrt:  [[0.15]]
grads:  [0.05846309]
Stock Position:  0.058463092076558705
Bond Position:  [-0.2836747]


portfolio before change:  [5.50738672]
curr_Stock_Price:  99.05530047601175
curr_Factors:  [99.05530048]
mat_Sqrt:  [[0.15]]
grads:  [0.06699405]
Stock Position:  0.06699404596086977
Bond Position:  [-1.12872863]


portfolio before change:  [5.47440328]
curr_Stock_Price:  98.56401960479005
curr_Factors:  [98.5640196]
mat_Sqrt:  [[0.15]]
grads:  [-0.01913875]
Stock Position:  -0.01913874582431793
Bond Position:  [7.360795]


portfolio before change:  [5.46337861]
curr_Stock_Price:  99.16409732942475
curr_Factors:  [99.16409733]
mat_Sqrt:  [[0.15]]
grads:  [-0.03234881]
Stock Position:  -0.03234880691217684
Bond Position:  [8.67121885]


portfolio before change:  [5.45045424]
curr_Stock_Price:  99.58038279652285
curr_Factors:  [99.5803828]
mat_Sqrt:  [[0.15]]
grads:  [-0.05833156]
Stock Position:  -0.05833155625504189
Bond Position:  [11.25913294]


portfolio before change:  [5.45795836]
curr_Stock_Price:  99.46380086772996
curr_Factors:  [99.46380087]
mat_Sqrt:  [[0.15]]
grads:  [-0.02115372]
Stock Position:  -0.02115371766437326
Bond Position:  [7.56198753]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.45795836]
Stock Price:  99.10323120441828
PL:  [5.45795836]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-8.98572781e-02]
 [-1.76659633e-03]
 [ 5.40449585e-03]
 [ 2.42411944e-03]
 [ 8.02295285e-03]
 [ 1.20291286e-02]
 [-4.77502777e-04]
 [ 1.32331055e-02]
 [-1.20719818e-02]
 [-1.12653769e-02]
 [ 9.93334936e-03]
 [-8.47229788e-03]
 [ 1.59779198e-02]
 [ 6.12394607e-03]
 [ 3.14831045e-04]
 [-1.00845366e-02]
 [ 8.49597300e-03]
 [ 2.65973025e-02]
 [ 3.88120689e-03]
 [-1.92760303e-03]
 [ 4.05694959e-02]
 [-1.28283761e-02]
 [ 8.12375208e-03]
 [ 1.03178138e-03]
 [ 1.57820878e-02]
 [ 1.48197455e-02]
 [ 1.07915655e-02]
 [ 2.53015134e-03]
 [ 6.87582498e-03]
 [-1.47398900e-02]
 [-5.63189439e-03]
 [ 3.57466750e-02]
 [ 7.13672921e-03]
 [-3.77184251e-03]
 [-4.79005914e-03]
 [-3.90951418e-03]
 [-6.04961577e-03]
 [ 3.15167833e-03]
 [ 2.56009403e-03]
 [-8.33025221e-03]
 [-2.42956045e-02]
 [-2.41829721e-03]
 [ 1.29502484e-02]
 [-1.25599942e-02]
 [-2.17688776e-03]
 [ 2.51536227e-03]
 [-1.36402171e-02]
 [ 5.27797106e-03]
 [ 5.10742746e-03]
 [-8.07721021e-03]
 [-3.87714385e-03]
 [ 3.45687233e-03]
 [ 2.35725930e-03]
 [ 1.93293848e-03]
 [-5.81642488e-03]
 [ 9.54247227e-03]
 [-4.88099613e-03]
 [-1.20910104e-02]
 [ 1.52325011e-02]
 [ 2.90863314e-04]
 [ 1.11719592e-02]
 [-1.52939574e-02]
 [-1.27469452e-02]
 [-3.03641467e-03]
 [ 1.50223865e-02]
 [-1.49265057e-02]
 [ 2.96924720e-02]
 [ 2.48837145e-03]
 [ 6.28430831e-03]
 [-1.43382992e-02]
 [-5.78664320e-03]
 [-7.21382602e-04]
 [ 1.96239900e-03]
 [ 8.79143170e-03]
 [ 1.23222988e-02]
 [-8.02153795e-03]
 [-3.70296064e-03]
 [-9.75109226e-03]
 [-6.94048083e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.10115771]
curr_Stock_Price:  101.03056140597411
curr_Factors:  [101.03056141]
mat_Sqrt:  [[0.15]]
grads:  [-0.59904852]
Stock Position:  -0.599048520581616
Bond Position:  [78.62336605]


portfolio before change:  [18.46375736]
curr_Stock_Price:  100.43347198184273
curr_Factors:  [100.43347198]
mat_Sqrt:  [[0.15]]
grads:  [-0.01177731]
Stock Position:  -0.011777308872340794
Bond Position:  [19.64659338]


portfolio before change:  [18.45580938]
curr_Stock_Price:  101.21259171855117
curr_Factors:  [101.21259172]
mat_Sqrt:  [[0.15]]
grads:  [0.03602997]
Stock Position:  0.036029972307534686
Bond Position:  [14.8091225]


portfolio before change:  [18.44374533]
curr_Stock_Price:  100.85206830682117
curr_Factors:  [100.85206831]
mat_Sqrt:  [[0.15]]
grads:  [0.0161608]
Stock Position:  0.016160796255421286
Bond Position:  [16.8138956]


portfolio before change:  [18.44022774]
curr_Stock_Price:  100.56937853859303
curr_Factors:  [100.56937854]
mat_Sqrt:  [[0.15]]
grads:  [0.05348635]
Stock Position:  0.05348635230819336
Bond Position:  [13.06113852]


portfolio before change:  [18.47825343]
curr_Stock_Price:  101.26505778278663
curr_Factors:  [101.26505778]
mat_Sqrt:  [[0.15]]
grads:  [0.08019419]
Stock Position:  0.08019419041785476
Bond Position:  [10.3573841]


portfolio before change:  [18.53567763]
curr_Stock_Price:  101.97304980500509
curr_Factors:  [101.97304981]
mat_Sqrt:  [[0.15]]
grads:  [-0.00318335]
Stock Position:  -0.003183351849033574
Bond Position:  [18.86029373]


portfolio before change:  [18.53572995]
curr_Stock_Price:  102.32691890033382
curr_Factors:  [102.3269189]
mat_Sqrt:  [[0.15]]
grads:  [0.0882207]
Stock Position:  0.08822070327380047
Bond Position:  [9.5083772]


portfolio before change:  [18.52804976]
curr_Stock_Price:  102.23312596717776
curr_Factors:  [102.23312597]
mat_Sqrt:  [[0.15]]
grads:  [-0.08047988]
Stock Position:  -0.08047987881786771
Bond Position:  [26.75575935]


portfolio before change:  [18.57953908]
curr_Stock_Price:  101.61412612487702
curr_Factors:  [101.61412612]
mat_Sqrt:  [[0.15]]
grads:  [-0.07510251]
Stock Position:  -0.07510251269076951
Bond Position:  [26.21101528]


portfolio before change:  [18.53944744]
curr_Stock_Price:  102.1697650222487
curr_Factors:  [102.16976502]
mat_Sqrt:  [[0.15]]
grads:  [0.06622233]
Stock Position:  0.06622232908762665
Bond Position:  [11.77352764]


portfolio before change:  [18.49654039]
curr_Stock_Price:  101.51072875459536
curr_Factors:  [101.51072875]
mat_Sqrt:  [[0.15]]
grads:  [-0.05648199]
Stock Position:  -0.05648198584650192
Bond Position:  [24.23006794]


portfolio before change:  [18.48771296]
curr_Stock_Price:  101.69382895658043
curr_Factors:  [101.69382896]
mat_Sqrt:  [[0.15]]
grads:  [0.10651947]
Stock Position:  0.10651946557375183
Bond Position:  [7.65534065]


portfolio before change:  [18.51182294]
curr_Stock_Price:  101.91568052917545
curr_Factors:  [101.91568053]
mat_Sqrt:  [[0.15]]
grads:  [0.04082631]
Stock Position:  0.04082630715123256
Bond Position:  [14.35098207]


portfolio before change:  [18.50221628]
curr_Stock_Price:  101.658404608363
curr_Factors:  [101.65840461]
mat_Sqrt:  [[0.15]]
grads:  [0.00209887]
Stock Position:  0.002098873632828367
Bond Position:  [18.28884814]


portfolio before change:  [18.50385073]
curr_Stock_Price:  101.89251014224635
curr_Factors:  [101.89251014]
mat_Sqrt:  [[0.15]]
grads:  [-0.06723024]
Stock Position:  -0.06723024414385176
Bond Position:  [25.35410906]


portfolio before change:  [18.48001822]
curr_Stock_Price:  102.27057192530123
curr_Factors:  [102.27057193]
mat_Sqrt:  [[0.15]]
grads:  [0.05663982]
Stock Position:  0.05663982002386915
Bond Position:  [12.68743144]


portfolio before change:  [18.49064736]
curr_Stock_Price:  102.4442331989749
curr_Factors:  [102.4442332]
mat_Sqrt:  [[0.15]]
grads:  [0.17731535]
Stock Position:  0.17731535009328578
Bond Position:  [0.32571228]


portfolio before change:  [18.60046208]
curr_Stock_Price:  103.06343712723223
curr_Factors:  [103.06343713]
mat_Sqrt:  [[0.15]]
grads:  [0.02587471]
Stock Position:  0.02587471261875321
Bond Position:  [15.93372526]


portfolio before change:  [18.59126097]
curr_Stock_Price:  102.66934584135407
curr_Factors:  [102.66934584]
mat_Sqrt:  [[0.15]]
grads:  [-0.01285069]
Stock Position:  -0.01285068689272774
Bond Position:  [19.91063258]


portfolio before change:  [18.59226082]
curr_Stock_Price:  102.68838000741302
curr_Factors:  [102.68838001]
mat_Sqrt:  [[0.15]]
grads:  [0.27046331]
Stock Position:  0.27046330594608226
Bond Position:  [-9.18117792]


portfolio before change:  [18.42629279]
curr_Stock_Price:  102.07685829408273
curr_Factors:  [102.07685829]
mat_Sqrt:  [[0.15]]
grads:  [-0.08552251]
Stock Position:  -0.0855225070648157
Bond Position:  [27.15616163]


portfolio before change:  [18.45378078]
curr_Stock_Price:  101.77529231678346
curr_Factors:  [101.77529232]
mat_Sqrt:  [[0.15]]
grads:  [0.05415835]
Stock Position:  0.05415834717682609
Bond Position:  [12.94179917]


portfolio before change:  [18.42354103]
curr_Stock_Price:  101.20199855869198
curr_Factors:  [101.20199856]
mat_Sqrt:  [[0.15]]
grads:  [0.00687854]
Stock Position:  0.006878542513699653
Bond Position:  [17.72741878]


portfolio before change:  [18.42580946]
curr_Stock_Price:  101.3707018953363
curr_Factors:  [101.3707019]
mat_Sqrt:  [[0.15]]
grads:  [0.10521392]
Stock Position:  0.10521391852771851
Bond Position:  [7.76020069]


portfolio before change:  [18.45669559]
curr_Stock_Price:  101.65964754430473
curr_Factors:  [101.65964754]
mat_Sqrt:  [[0.15]]
grads:  [0.0987983]
Stock Position:  0.09879830352578924
Bond Position:  [8.41289488]


portfolio before change:  [18.50258843]
curr_Stock_Price:  102.11883578302879
curr_Factors:  [102.11883578]
mat_Sqrt:  [[0.15]]
grads:  [0.07194377]
Stock Position:  0.07194376976559372
Bond Position:  [11.15577442]


portfolio before change:  [18.55500367]
curr_Stock_Price:  102.83770249490938
curr_Factors:  [102.83770249]
mat_Sqrt:  [[0.15]]
grads:  [0.01686768]
Stock Position:  0.016867675626195934
Bond Position:  [16.82037066]


portfolio before change:  [18.56059003]
curr_Stock_Price:  103.10656312212214
curr_Factors:  [103.10656312]
mat_Sqrt:  [[0.15]]
grads:  [0.04583883]
Stock Position:  0.04583883319560097
Bond Position:  [13.83430548]


portfolio before change:  [18.53955175]
curr_Stock_Price:  102.62873790166594
curr_Factors:  [102.6287379]
mat_Sqrt:  [[0.15]]
grads:  [-0.09826593]
Stock Position:  -0.09826593351641334
Bond Position:  [28.62446049]


portfolio before change:  [18.60260817]
curr_Stock_Price:  102.00525286925021
curr_Factors:  [102.00525287]
mat_Sqrt:  [[0.15]]
grads:  [-0.03754596]
Stock Position:  -0.03754596261247184
Bond Position:  [22.43249359]


portfolio before change:  [18.57873812]
curr_Stock_Price:  102.67835123676956
curr_Factors:  [102.67835124]
mat_Sqrt:  [[0.15]]
grads:  [0.23831117]
Stock Position:  0.23831116657109835
Bond Position:  [-5.89065954]


portfolio before change:  [18.45904646]
curr_Stock_Price:  102.17764667494052
curr_Factors:  [102.17764667]
mat_Sqrt:  [[0.15]]
grads:  [0.04757819]
Stock Position:  0.04757819474913043
Bond Position:  [13.59761848]


portfolio before change:  [18.49139605]
curr_Stock_Price:  102.83970873715123
curr_Factors:  [102.83970874]
mat_Sqrt:  [[0.15]]
grads:  [-0.02514562]
Stock Position:  -0.025145616716780343
Bond Position:  [21.07736395]


portfolio before change:  [18.49928839]
curr_Stock_Price:  102.57823315138346
curr_Factors:  [102.57823315]
mat_Sqrt:  [[0.15]]
grads:  [-0.03193373]
Stock Position:  -0.03193372761123424
Bond Position:  [21.77499375]


portfolio before change:  [18.49618896]
curr_Stock_Price:  102.71791039369337
curr_Factors:  [102.71791039]
mat_Sqrt:  [[0.15]]
grads:  [-0.02606343]
Stock Position:  -0.026063427838423782
Bond Position:  [21.1733698]


portfolio before change:  [18.49502144]
curr_Stock_Price:  102.81348077462175
curr_Factors:  [102.81348077]
mat_Sqrt:  [[0.15]]
grads:  [-0.04033077]
Stock Position:  -0.04033077180294764
Bond Position:  [22.64156848]


portfolio before change:  [18.48176494]
curr_Stock_Price:  103.17726372028497
curr_Factors:  [103.17726372]
mat_Sqrt:  [[0.15]]
grads:  [0.02101119]
Stock Position:  0.021011188893679512
Bond Position:  [16.31388796]


portfolio before change:  [18.4771286]
curr_Stock_Price:  102.90807445491923
curr_Factors:  [102.90807445]
mat_Sqrt:  [[0.15]]
grads:  [0.01706729]
Stock Position:  0.017067293564493494
Bond Position:  [16.72076629]


portfolio before change:  [18.47434675]
curr_Stock_Price:  102.68384833298587
curr_Factors:  [102.68384833]
mat_Sqrt:  [[0.15]]
grads:  [-0.05553501]
Stock Position:  -0.05553501471132803
Bond Position:  [24.17689578]


portfolio before change:  [18.5185966]
curr_Stock_Price:  101.91426641620079
curr_Factors:  [101.91426642]
mat_Sqrt:  [[0.15]]
grads:  [-0.1619707]
Stock Position:  -0.16197069679657208
Bond Position:  [35.02572134]


portfolio before change:  [18.49103241]
curr_Stock_Price:  102.09796238926837
curr_Factors:  [102.09796239]
mat_Sqrt:  [[0.15]]
grads:  [-0.01612198]
Stock Position:  -0.016121981391649394
Bond Position:  [20.13705386]


portfolio before change:  [18.47779726]
curr_Stock_Price:  102.99696778314208
curr_Factors:  [102.99696778]
mat_Sqrt:  [[0.15]]
grads:  [0.08633499]
Stock Position:  0.08633498945854144
Bond Position:  [9.58555514]


portfolio before change:  [18.50783931]
curr_Stock_Price:  103.33799907190128
curr_Factors:  [103.33799907]
mat_Sqrt:  [[0.15]]
grads:  [-0.08373329]
Stock Position:  -0.08373329492164551
Bond Position:  [27.16067047]


portfolio before change:  [18.46357773]
curr_Stock_Price:  103.8868748715632
curr_Factors:  [103.88687487]
mat_Sqrt:  [[0.15]]
grads:  [-0.01451259]
Stock Position:  -0.014512585060446606
Bond Position:  [19.97124484]


portfolio before change:  [18.46853548]
curr_Stock_Price:  103.63126850254233
curr_Factors:  [103.6312685]
mat_Sqrt:  [[0.15]]
grads:  [0.01676908]
Stock Position:  0.016769081799071058
Bond Position:  [16.73073426]


portfolio before change:  [18.45377904]
curr_Stock_Price:  102.68893057710906
curr_Factors:  [102.68893058]
mat_Sqrt:  [[0.15]]
grads:  [-0.09093478]
Stock Position:  -0.0909347807753398
Bond Position:  [27.79177443]


portfolio before change:  [18.39055843]
curr_Stock_Price:  103.40326289880001
curr_Factors:  [103.4032629]
mat_Sqrt:  [[0.15]]
grads:  [0.03518647]
Stock Position:  0.03518647374869076
Bond Position:  [14.75216223]


portfolio before change:  [18.37020812]
curr_Stock_Price:  102.79870261731678
curr_Factors:  [102.79870262]
mat_Sqrt:  [[0.15]]
grads:  [0.03404952]
Stock Position:  0.03404951639488361
Bond Position:  [14.86996201]


portfolio before change:  [18.38305808]
curr_Stock_Price:  103.14879725520292
curr_Factors:  [103.14879726]
mat_Sqrt:  [[0.15]]
grads:  [-0.05384807]
Stock Position:  -0.05384806807702737
Bond Position:  [23.93742153]


portfolio before change:  [18.34101136]
curr_Stock_Price:  103.95742154476441
curr_Factors:  [103.95742154]
mat_Sqrt:  [[0.15]]
grads:  [-0.02584763]
Stock Position:  -0.025847625686402528
Bond Position:  [21.02806388]


portfolio before change:  [18.3427027]
curr_Stock_Price:  103.94283413579063
curr_Factors:  [103.94283414]
mat_Sqrt:  [[0.15]]
grads:  [0.02304582]
Stock Position:  0.023045815534830073
Bond Position:  [15.94725532]


portfolio before change:  [18.33844692]
curr_Stock_Price:  103.71491761169354
curr_Factors:  [103.71491761]
mat_Sqrt:  [[0.15]]
grads:  [0.01571506]
Stock Position:  0.015715062007714622
Bond Position:  [16.70856055]


portfolio before change:  [18.33678738]
curr_Stock_Price:  103.54286300660648
curr_Factors:  [103.54286301]
mat_Sqrt:  [[0.15]]
grads:  [0.01288626]
Stock Position:  0.01288625656090084
Bond Position:  [17.00250749]


portfolio before change:  [18.33781188]
curr_Stock_Price:  103.5398987500374
curr_Factors:  [103.53989875]
mat_Sqrt:  [[0.15]]
grads:  [-0.03877617]
Stock Position:  -0.0387761658514546
Bond Position:  [22.35269216]


portfolio before change:  [18.3479723]
curr_Stock_Price:  103.31390076021788
curr_Factors:  [103.31390076]
mat_Sqrt:  [[0.15]]
grads:  [0.06361648]
Stock Position:  0.06361648177835211
Bond Position:  [11.77550541]


portfolio before change:  [18.32523666]
curr_Stock_Price:  102.94494553181511
curr_Factors:  [102.94494553]
mat_Sqrt:  [[0.15]]
grads:  [-0.03253997]
Stock Position:  -0.03253997418374118
Bond Position:  [21.67506253]


portfolio before change:  [18.31839984]
curr_Stock_Price:  103.19668371698172
curr_Factors:  [103.19668372]
mat_Sqrt:  [[0.15]]
grads:  [-0.08060674]
Stock Position:  -0.08060673593059146
Bond Position:  [26.63674767]


portfolio before change:  [18.31383164]
curr_Stock_Price:  103.27401037224317
curr_Factors:  [103.27401037]
mat_Sqrt:  [[0.15]]
grads:  [0.10155001]
Stock Position:  0.10155000747709411
Bond Position:  [7.82635511]


portfolio before change:  [18.34838883]
curr_Stock_Price:  103.60949067250893
curr_Factors:  [103.60949067]
mat_Sqrt:  [[0.15]]
grads:  [0.00193909]
Stock Position:  0.0019390887600597452
Bond Position:  [18.14748083]


portfolio before change:  [18.34739494]
curr_Stock_Price:  102.51199570968546
curr_Factors:  [102.51199571]
mat_Sqrt:  [[0.15]]
grads:  [0.07447973]
Stock Position:  0.07447972787753493
Bond Position:  [10.71232939]


portfolio before change:  [18.41120356]
curr_Stock_Price:  103.35973075481571
curr_Factors:  [103.35973075]
mat_Sqrt:  [[0.15]]
grads:  [-0.10195972]
Stock Position:  -0.10195971584130963
Bond Position:  [28.94973233]


portfolio before change:  [18.41365655]
curr_Stock_Price:  103.3534186939124
curr_Factors:  [103.35341869]
mat_Sqrt:  [[0.15]]
grads:  [-0.08497963]
Stock Position:  -0.08497963498389682
Bond Position:  [27.19659234]


portfolio before change:  [18.49765018]
curr_Stock_Price:  102.38502445576208
curr_Factors:  [102.38502446]
mat_Sqrt:  [[0.15]]
grads:  [-0.02024276]
Stock Position:  -0.020242764456756854
Bond Position:  [20.57020611]


portfolio before change:  [18.46905462]
curr_Stock_Price:  103.86116822295028
curr_Factors:  [103.86116822]
mat_Sqrt:  [[0.15]]
grads:  [0.10014924]
Stock Position:  0.10014924306403335
Bond Position:  [8.06743724]


portfolio before change:  [18.37759455]
curr_Stock_Price:  102.94289564107737
curr_Factors:  [102.94289564]
mat_Sqrt:  [[0.15]]
grads:  [-0.09951004]
Stock Position:  -0.09951003781159058
Bond Position:  [28.62144599]


portfolio before change:  [18.42523349]
curr_Stock_Price:  102.48213770422295
curr_Factors:  [102.4821377]
mat_Sqrt:  [[0.15]]
grads:  [0.19794981]
Stock Position:  0.19794981327158173
Bond Position:  [-1.86108654]


portfolio before change:  [18.45878559]
curr_Stock_Price:  102.65222338301076
curr_Factors:  [102.65222338]
mat_Sqrt:  [[0.15]]
grads:  [0.01658914]
Stock Position:  0.016589142968465323
Bond Position:  [16.75587318]


portfolio before change:  [18.44116302]
curr_Stock_Price:  101.52679783486242
curr_Factors:  [101.52679783]
mat_Sqrt:  [[0.15]]
grads:  [0.04189539]
Stock Position:  0.04189538870768593
Bond Position:  [14.18765836]


portfolio before change:  [18.38925245]
curr_Stock_Price:  100.26657983242777
curr_Factors:  [100.26657983]
mat_Sqrt:  [[0.15]]
grads:  [-0.09558866]
Stock Position:  -0.09558866132777183
Bond Position:  [27.9736006]


portfolio before change:  [18.44781364]
curr_Stock_Price:  99.67223337213517
curr_Factors:  [99.67223337]
mat_Sqrt:  [[0.15]]
grads:  [-0.03857762]
Stock Position:  -0.03857762130070704
Bond Position:  [22.29293132]


portfolio before change:  [18.45317041]
curr_Stock_Price:  99.56949468034969
curr_Factors:  [99.56949468]
mat_Sqrt:  [[0.15]]
grads:  [-0.00480922]
Stock Position:  -0.004809217348284275
Bond Position:  [18.93202175]


portfolio before change:  [18.4536906]
curr_Stock_Price:  99.70737564452384
curr_Factors:  [99.70737564]
mat_Sqrt:  [[0.15]]
grads:  [0.01308266]
Stock Position:  0.013082660030625968
Bond Position:  [17.1492529]


portfolio before change:  [18.46080554]
curr_Stock_Price:  100.16929100330677
curr_Factors:  [100.169291]
mat_Sqrt:  [[0.15]]
grads:  [0.05860954]
Stock Position:  0.05860954466424452
Bond Position:  [12.58992901]


portfolio before change:  [18.44746111]
curr_Stock_Price:  99.9281813397096
curr_Factors:  [99.92818134]
mat_Sqrt:  [[0.15]]
grads:  [0.08214866]
Stock Position:  0.08214865856807986
Bond Position:  [10.23849506]


portfolio before change:  [18.44068345]
curr_Stock_Price:  99.8378866654283
curr_Factors:  [99.83788667]
mat_Sqrt:  [[0.15]]
grads:  [-0.05347692]
Stock Position:  -0.05347691966481938
Bond Position:  [23.77970609]


portfolio before change:  [18.46052323]
curr_Stock_Price:  99.4946824112605
curr_Factors:  [99.49468241]
mat_Sqrt:  [[0.15]]
grads:  [-0.0246864]
Stock Position:  -0.02468640425827147
Bond Position:  [20.91668918]


portfolio before change:  [18.4823632]
curr_Stock_Price:  98.66294391852492
curr_Factors:  [98.66294392]
mat_Sqrt:  [[0.15]]
grads:  [-0.06500728]
Stock Position:  -0.06500728171187603
Bond Position:  [24.89617299]


portfolio before change:  [18.4766393]
curr_Stock_Price:  98.77493080194441
curr_Factors:  [98.7749308]
mat_Sqrt:  [[0.15]]
grads:  [-0.04626987]
Stock Position:  -0.04626987221335861
Bond Position:  [23.04694272]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.4766393]
Stock Price:  99.76996650048409
PL:  [18.4766393]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.83235835e-02]
 [-9.33355021e-04]
 [-7.33670800e-04]
 [ 1.85657445e-03]
 [-1.58431965e-03]
 [ 9.88673092e-03]
 [ 6.82735384e-04]
 [ 1.55087924e-02]
 [ 1.70315371e-02]
 [-1.67769251e-02]
 [ 9.08584441e-03]
 [-5.86705302e-03]
 [-4.18544675e-03]
 [ 3.54908530e-03]
 [-1.35326266e-02]
 [ 1.73061775e-02]
 [-3.65111121e-03]
 [ 3.09442107e-03]
 [ 1.27149085e-02]
 [ 1.30433673e-02]
 [ 7.58381665e-02]
 [-1.48536110e-02]
 [ 3.21787615e-03]
 [ 4.65341096e-03]
 [ 9.46634695e-03]
 [ 3.17445944e-03]
 [ 1.28585308e-02]
 [-7.58748537e-03]
 [ 2.80569516e-03]
 [-2.82780011e-02]
 [-5.10783090e-03]
 [ 1.75229807e-02]
 [ 9.88819452e-03]
 [ 9.65264407e-03]
 [ 2.97849385e-03]
 [-3.93477150e-03]
 [-7.11162253e-03]
 [ 7.92108351e-03]
 [ 9.09520471e-04]
 [-1.06116942e-02]
 [-2.75678582e-02]
 [-2.70412900e-03]
 [ 1.14751673e-02]
 [-1.17357447e-02]
 [ 4.68504298e-04]
 [ 4.56456390e-04]
 [-1.36968194e-02]
 [-3.24358823e-03]
 [-6.64325478e-03]
 [ 9.50260187e-03]
 [-3.07001540e-03]
 [ 3.42127594e-03]
 [ 2.15410938e-03]
 [-1.23473390e-03]
 [ 1.97571833e-03]
 [ 9.04551164e-03]
 [ 1.41030139e-02]
 [-8.67539020e-03]
 [ 1.36030649e-02]
 [-9.24764826e-04]
 [ 1.21695538e-03]
 [-1.67304503e-02]
 [-1.27677726e-02]
 [-1.99689600e-03]
 [-9.39276127e-03]
 [-7.30611662e-03]
 [ 8.70952377e-03]
 [ 1.96907895e-03]
 [ 1.37041533e-02]
 [-1.88493491e-02]
 [ 1.45003707e-02]
 [-9.70335133e-03]
 [-4.12474335e-03]
 [ 7.89778133e-03]
 [-9.25230207e-03]
 [ 3.88216206e-03]
 [ 1.91270176e-02]
 [-1.62569590e-02]
 [-5.29343519e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.46994143]
curr_Stock_Price:  100.34728612317241
curr_Factors:  [100.34728612]
mat_Sqrt:  [[0.15]]
grads:  [-0.32215722]
Stock Position:  -0.3221572230881647
Bond Position:  [39.79754447]


portfolio before change:  [7.63771325]
curr_Stock_Price:  99.83423103630382
curr_Factors:  [99.83423104]
mat_Sqrt:  [[0.15]]
grads:  [-0.00622237]
Stock Position:  -0.006222366807784979
Bond Position:  [8.25891846]


portfolio before change:  [7.64264276]
curr_Stock_Price:  99.12496528648994
curr_Factors:  [99.12496529]
mat_Sqrt:  [[0.15]]
grads:  [-0.00489114]
Stock Position:  -0.004891138665685701
Bond Position:  [8.12747671]


portfolio before change:  [7.64019338]
curr_Stock_Price:  99.72960253112164
curr_Factors:  [99.72960253]
mat_Sqrt:  [[0.15]]
grads:  [0.01237716]
Stock Position:  0.012377162987774741
Bond Position:  [6.40582384]


portfolio before change:  [7.63617837]
curr_Stock_Price:  99.3728659226098
curr_Factors:  [99.37286592]
mat_Sqrt:  [[0.15]]
grads:  [-0.01056213]
Stock Position:  -0.0105621310187895
Bond Position:  [8.6857676]


portfolio before change:  [7.63737252]
curr_Stock_Price:  99.31120527577984
curr_Factors:  [99.31120528]
mat_Sqrt:  [[0.15]]
grads:  [0.06591154]
Stock Position:  0.06591153945780852
Bond Position:  [1.09161809]


portfolio before change:  [7.64790381]
curr_Stock_Price:  99.46994939309972
curr_Factors:  [99.46994939]
mat_Sqrt:  [[0.15]]
grads:  [0.00455157]
Stock Position:  0.004551569226855128
Bond Position:  [7.19515945]


portfolio before change:  [7.64650051]
curr_Stock_Price:  99.06283352615725
curr_Factors:  [99.06283353]
mat_Sqrt:  [[0.15]]
grads:  [0.10339195]
Stock Position:  0.10339194936516817
Bond Position:  [-2.59579896]


portfolio before change:  [7.64253264]
curr_Stock_Price:  99.02602576886213
curr_Factors:  [99.02602577]
mat_Sqrt:  [[0.15]]
grads:  [0.11354358]
Stock Position:  0.11354358040545791
Bond Position:  [-3.60123688]


portfolio before change:  [7.63469056]
curr_Stock_Price:  98.95894142422608
curr_Factors:  [98.95894142]
mat_Sqrt:  [[0.15]]
grads:  [-0.11184617]
Stock Position:  -0.11184616739304559
Bond Position:  [18.70286889]


portfolio before change:  [7.51955173]
curr_Stock_Price:  99.99883219087687
curr_Factors:  [99.99883219]
mat_Sqrt:  [[0.15]]
grads:  [0.0605723]
Stock Position:  0.0605722960950379
Bond Position:  [1.46239286]


portfolio before change:  [7.47449104]
curr_Stock_Price:  99.25340735562888
curr_Factors:  [99.25340736]
mat_Sqrt:  [[0.15]]
grads:  [-0.03911369]
Stock Position:  -0.03911368678022845
Bond Position:  [11.35665773]


portfolio before change:  [7.48999302]
curr_Stock_Price:  98.87522347946124
curr_Factors:  [98.87522348]
mat_Sqrt:  [[0.15]]
grads:  [-0.02790298]
Stock Position:  -0.02790297836441204
Bond Position:  [10.24890624]


portfolio before change:  [7.49668162]
curr_Stock_Price:  98.65847151985673
curr_Factors:  [98.65847152]
mat_Sqrt:  [[0.15]]
grads:  [0.02366057]
Stock Position:  0.023660568635233716
Bond Position:  [5.16236608]


portfolio before change:  [7.48660705]
curr_Stock_Price:  98.2190389670214
curr_Factors:  [98.21903897]
mat_Sqrt:  [[0.15]]
grads:  [-0.09021751]
Stock Position:  -0.09021751069841147
Bond Position:  [16.34768425]


portfolio before change:  [7.5629267]
curr_Stock_Price:  97.38441291710112
curr_Factors:  [97.38441292]
mat_Sqrt:  [[0.15]]
grads:  [0.11537452]
Stock Position:  0.11537451665019453
Bond Position:  [-3.67275287]


portfolio before change:  [7.5676876]
curr_Stock_Price:  97.4276673035413
curr_Factors:  [97.4276673]
mat_Sqrt:  [[0.15]]
grads:  [-0.02434074]
Stock Position:  -0.02434074143025922
Bond Position:  [9.93914926]


portfolio before change:  [7.54693568]
curr_Stock_Price:  98.30574809895776
curr_Factors:  [98.3057481]
mat_Sqrt:  [[0.15]]
grads:  [0.02062947]
Stock Position:  0.02062947380366128
Bond Position:  [5.51893982]


portfolio before change:  [7.55118203]
curr_Stock_Price:  98.49486600282458
curr_Factors:  [98.494866]
mat_Sqrt:  [[0.15]]
grads:  [0.08476606]
Stock Position:  0.08476605640820606
Bond Position:  [-0.79783934]


portfolio before change:  [7.56870036]
curr_Stock_Price:  98.70212112175945
curr_Factors:  [98.70212112]
mat_Sqrt:  [[0.15]]
grads:  [0.08695578]
Stock Position:  0.08695578196767838
Bond Position:  [-1.01401977]


portfolio before change:  [7.69456683]
curr_Stock_Price:  100.15032673630033
curr_Factors:  [100.15032674]
mat_Sqrt:  [[0.15]]
grads:  [0.50558778]
Stock Position:  0.5055877768362637
Bond Position:  [-42.94021421]


portfolio before change:  [7.51349943]
curr_Stock_Price:  99.79750263475027
curr_Factors:  [99.79750263]
mat_Sqrt:  [[0.15]]
grads:  [-0.09902407]
Stock Position:  -0.09902407356327604
Bond Position:  [17.39585467]


portfolio before change:  [7.40539929]
curr_Stock_Price:  100.90013766987084
curr_Factors:  [100.90013767]
mat_Sqrt:  [[0.15]]
grads:  [0.02145251]
Stock Position:  0.021452507653211463
Bond Position:  [5.24083832]


portfolio before change:  [7.40371918]
curr_Stock_Price:  100.80655070526963
curr_Factors:  [100.80655071]
mat_Sqrt:  [[0.15]]
grads:  [0.03102274]
Stock Position:  0.03102273970227296
Bond Position:  [4.2764238]


portfolio before change:  [7.36004767]
curr_Stock_Price:  99.39020908338985
curr_Factors:  [99.39020908]
mat_Sqrt:  [[0.15]]
grads:  [0.06310898]
Stock Position:  0.06310897968284619
Bond Position:  [1.08763298]


portfolio before change:  [7.33443555]
curr_Stock_Price:  98.98329242355261
curr_Factors:  [98.98329242]
mat_Sqrt:  [[0.15]]
grads:  [0.02116306]
Stock Position:  0.021163062931726283
Bond Position:  [5.23964591]


portfolio before change:  [7.33070072]
curr_Stock_Price:  98.7913392649369
curr_Factors:  [98.79133926]
mat_Sqrt:  [[0.15]]
grads:  [0.08572354]
Stock Position:  0.08572353854838163
Bond Position:  [-1.13804246]


portfolio before change:  [7.37369877]
curr_Stock_Price:  99.29375880122164
curr_Factors:  [99.2937588]
mat_Sqrt:  [[0.15]]
grads:  [-0.05058324]
Stock Position:  -0.050583235812946506
Bond Position:  [12.39629839]


portfolio before change:  [7.35200898]
curr_Stock_Price:  99.73787014529356
curr_Factors:  [99.73787015]
mat_Sqrt:  [[0.15]]
grads:  [0.01870463]
Stock Position:  0.018704634431858498
Bond Position:  [5.48644858]


portfolio before change:  [7.37221177]
curr_Stock_Price:  100.79963248176702
curr_Factors:  [100.79963248]
mat_Sqrt:  [[0.15]]
grads:  [-0.18852001]
Stock Position:  -0.18852000749154602
Bond Position:  [26.37495924]


portfolio before change:  [7.34240364]
curr_Stock_Price:  100.96649337243862
curr_Factors:  [100.96649337]
mat_Sqrt:  [[0.15]]
grads:  [-0.03405221]
Stock Position:  -0.034052205974707137
Bond Position:  [10.78053547]


portfolio before change:  [7.33191453]
curr_Stock_Price:  101.29431102493447
curr_Factors:  [101.29431102]
mat_Sqrt:  [[0.15]]
grads:  [0.11681987]
Stock Position:  0.11681987158004072
Bond Position:  [-4.50127388]


portfolio before change:  [7.29524545]
curr_Stock_Price:  100.9828251467883
curr_Factors:  [100.98282515]
mat_Sqrt:  [[0.15]]
grads:  [0.0659213]
Stock Position:  0.06592129683116138
Bond Position:  [0.63832666]


portfolio before change:  [7.30624439]
curr_Stock_Price:  101.14906952868613
curr_Factors:  [101.14906953]
mat_Sqrt:  [[0.15]]
grads:  [0.06435096]
Stock Position:  0.06435096043520981
Bond Position:  [0.79720462]


portfolio before change:  [7.29571657]
curr_Stock_Price:  100.98469515761602
curr_Factors:  [100.98469516]
mat_Sqrt:  [[0.15]]
grads:  [0.01985663]
Stock Position:  0.019856625689109557
Bond Position:  [5.29050128]


portfolio before change:  [7.32992784]
curr_Stock_Price:  102.69095719111161
curr_Factors:  [102.69095719]
mat_Sqrt:  [[0.15]]
grads:  [-0.02623181]
Stock Position:  -0.02623181000997166
Bond Position:  [10.02369752]


portfolio before change:  [7.35403643]
curr_Stock_Price:  101.79578133981937
curr_Factors:  [101.79578134]
mat_Sqrt:  [[0.15]]
grads:  [-0.04741082]
Stock Position:  -0.04741081684052354
Bond Position:  [12.18025757]


portfolio before change:  [7.3615031]
curr_Stock_Price:  101.65434979316427
curr_Factors:  [101.65434979]
mat_Sqrt:  [[0.15]]
grads:  [0.05280722]
Stock Position:  0.05280722341614404
Bond Position:  [1.99341914]


portfolio before change:  [7.37295254]
curr_Stock_Price:  101.86880613914927
curr_Factors:  [101.86880614]
mat_Sqrt:  [[0.15]]
grads:  [0.00606347]
Stock Position:  0.006063469807618307
Bond Position:  [6.75527411]


portfolio before change:  [7.36912289]
curr_Stock_Price:  101.16757980642492
curr_Factors:  [101.16757981]
mat_Sqrt:  [[0.15]]
grads:  [-0.07074463]
Stock Position:  -0.07074462807201135
Bond Position:  [14.5261857]


portfolio before change:  [7.29624429]
curr_Stock_Price:  102.21057801788348
curr_Factors:  [102.21057802]
mat_Sqrt:  [[0.15]]
grads:  [-0.18378572]
Stock Position:  -0.183785721557927
Bond Position:  [26.08108912]


portfolio before change:  [7.49013127]
curr_Stock_Price:  101.16448554363602
curr_Factors:  [101.16448554]
mat_Sqrt:  [[0.15]]
grads:  [-0.01802753]
Stock Position:  -0.018027526640304554
Bond Position:  [9.31387672]


portfolio before change:  [7.47069806]
curr_Stock_Price:  102.2747508199928
curr_Factors:  [102.27475082]
mat_Sqrt:  [[0.15]]
grads:  [0.07650112]
Stock Position:  0.07650111547501863
Bond Position:  [-0.35343446]


portfolio before change:  [7.46246374]
curr_Stock_Price:  102.16740291028864
curr_Factors:  [102.16740291]
mat_Sqrt:  [[0.15]]
grads:  [-0.0782383]
Stock Position:  -0.07823829769076865
Bond Position:  [15.45586742]


portfolio before change:  [7.47378491]
curr_Stock_Price:  102.03504894259846
curr_Factors:  [102.03504894]
mat_Sqrt:  [[0.15]]
grads:  [0.00312336]
Stock Position:  0.0031233619896775013
Bond Position:  [7.15509252]


portfolio before change:  [7.46963678]
curr_Stock_Price:  100.56376921094143
curr_Factors:  [100.56376921]
mat_Sqrt:  [[0.15]]
grads:  [0.00304304]
Stock Position:  0.0030430426024191876
Bond Position:  [7.16361694]


portfolio before change:  [7.46838306]
curr_Stock_Price:  100.00463948797291
curr_Factors:  [100.00463949]
mat_Sqrt:  [[0.15]]
grads:  [-0.09131213]
Stock Position:  -0.09131212938394868
Bond Position:  [16.60001964]


portfolio before change:  [7.52858995]
curr_Stock_Price:  99.35664943723968
curr_Factors:  [99.35664944]
mat_Sqrt:  [[0.15]]
grads:  [-0.02162392]
Stock Position:  -0.021623921524154106
Bond Position:  [9.67707034]


portfolio before change:  [7.55278819]
curr_Stock_Price:  98.26557024510019
curr_Factors:  [98.26557025]
mat_Sqrt:  [[0.15]]
grads:  [-0.04428837]
Stock Position:  -0.04428836519289429
Bond Position:  [11.90480966]


portfolio before change:  [7.53184136]
curr_Stock_Price:  98.75533564247634
curr_Factors:  [98.75533564]
mat_Sqrt:  [[0.15]]
grads:  [0.06335068]
Stock Position:  0.06335067914161478
Bond Position:  [1.27562378]


portfolio before change:  [7.56598829]
curr_Stock_Price:  99.29309162029591
curr_Factors:  [99.29309162]
mat_Sqrt:  [[0.15]]
grads:  [-0.02046677]
Stock Position:  -0.020466769308689813
Bond Position:  [9.59819709]


portfolio before change:  [7.56876288]
curr_Stock_Price:  99.18683731701894
curr_Factors:  [99.18683732]
mat_Sqrt:  [[0.15]]
grads:  [0.02280851]
Stock Position:  0.022808506235758686
Bond Position:  [5.30645929]


portfolio before change:  [7.57066288]
curr_Stock_Price:  99.25559822290936
curr_Factors:  [99.25559822]
mat_Sqrt:  [[0.15]]
grads:  [0.01436073]
Stock Position:  0.014360729211531042
Bond Position:  [6.14528011]


portfolio before change:  [7.57399002]
curr_Stock_Price:  99.46053526409516
curr_Factors:  [99.46053526]
mat_Sqrt:  [[0.15]]
grads:  [-0.00823156]
Stock Position:  -0.00823155933420901
Bond Position:  [8.39270532]


portfolio before change:  [7.57347559]
curr_Stock_Price:  99.58675504698792
curr_Factors:  [99.58675505]
mat_Sqrt:  [[0.15]]
grads:  [0.01317146]
Stock Position:  0.013171455519322126
Bond Position:  [6.26177308]


portfolio before change:  [7.56531885]
curr_Stock_Price:  98.93776697766498
curr_Factors:  [98.93776698]
mat_Sqrt:  [[0.15]]
grads:  [0.06030341]
Stock Position:  0.06030341090843906
Bond Position:  [1.59903403]


portfolio before change:  [7.5173629]
curr_Stock_Price:  98.14086521885687
curr_Factors:  [98.14086522]
mat_Sqrt:  [[0.15]]
grads:  [0.09402009]
Stock Position:  0.09402009238098456
Bond Position:  [-1.70985032]


portfolio before change:  [7.50625538]
curr_Stock_Price:  98.0238620570047
curr_Factors:  [98.02386206]
mat_Sqrt:  [[0.15]]
grads:  [-0.05783593]
Stock Position:  -0.057835934634587534
Bond Position:  [13.17555706]


portfolio before change:  [7.55033134]
curr_Stock_Price:  97.27601445073174
curr_Factors:  [97.27601445]
mat_Sqrt:  [[0.15]]
grads:  [0.0906871]
Stock Position:  0.09068709958570641
Bond Position:  [-1.27134827]


portfolio before change:  [7.53944593]
curr_Stock_Price:  97.15685806000212
curr_Factors:  [97.15685806]
mat_Sqrt:  [[0.15]]
grads:  [-0.0061651]
Stock Position:  -0.006165098838132767
Bond Position:  [8.13842757]


portfolio before change:  [7.54038163]
curr_Stock_Price:  97.08759218440336
curr_Factors:  [97.08759218]
mat_Sqrt:  [[0.15]]
grads:  [0.00811304]
Stock Position:  0.008113035859924842
Bond Position:  [6.75270652]


portfolio before change:  [7.54250664]
curr_Stock_Price:  97.29749502690981
curr_Factors:  [97.29749503]
mat_Sqrt:  [[0.15]]
grads:  [-0.11153634]
Stock Position:  -0.11153633520828514
Bond Position:  [18.39471266]


portfolio before change:  [7.62032592]
curr_Stock_Price:  96.61009953785613
curr_Factors:  [96.61009954]
mat_Sqrt:  [[0.15]]
grads:  [-0.08511848]
Stock Position:  -0.08511848368874765
Bond Position:  [15.8436311]


portfolio before change:  [7.65060428]
curr_Stock_Price:  96.26601320096343
curr_Factors:  [96.2660132]
mat_Sqrt:  [[0.15]]
grads:  [-0.01331264]
Stock Position:  -0.013312639970272376
Bond Position:  [8.93215906]


portfolio before change:  [7.64213957]
curr_Stock_Price:  96.94378933639254
curr_Factors:  [96.94378934]
mat_Sqrt:  [[0.15]]
grads:  [-0.06261841]
Stock Position:  -0.06261840847585856
Bond Position:  [13.71260537]


portfolio before change:  [7.66224188]
curr_Stock_Price:  96.63644773976297
curr_Factors:  [96.63644774]
mat_Sqrt:  [[0.15]]
grads:  [-0.04870744]
Stock Position:  -0.04870744413402649
Bond Position:  [12.36915626]


portfolio before change:  [7.69923595]
curr_Stock_Price:  95.89280420301674
curr_Factors:  [95.8928042]
mat_Sqrt:  [[0.15]]
grads:  [0.05806349]
Stock Position:  0.05806349180524283
Bond Position:  [2.1313649]


portfolio before change:  [7.7449307]
curr_Stock_Price:  96.67748894601891
curr_Factors:  [96.67748895]
mat_Sqrt:  [[0.15]]
grads:  [0.01312719]
Stock Position:  0.01312719297250988
Bond Position:  [6.47582665]


portfolio before change:  [7.73474209]
curr_Stock_Price:  95.87051056460122
curr_Factors:  [95.87051056]
mat_Sqrt:  [[0.15]]
grads:  [0.09136102]
Stock Position:  0.09136102229301611
Bond Position:  [-1.02408576]


portfolio before change:  [7.73586999]
curr_Stock_Price:  95.88355666007959
curr_Factors:  [95.88355666]
mat_Sqrt:  [[0.15]]
grads:  [-0.12566233]
Stock Position:  -0.12566232758319756
Bond Position:  [19.7848209]


portfolio before change:  [7.76355989]
curr_Stock_Price:  95.67304556381386
curr_Factors:  [95.67304556]
mat_Sqrt:  [[0.15]]
grads:  [0.09666914]
Stock Position:  0.09666913822034297
Bond Position:  [-1.48507097]


portfolio before change:  [7.72027669]
curr_Stock_Price:  95.22625992153455
curr_Factors:  [95.22625992]
mat_Sqrt:  [[0.15]]
grads:  [-0.06468901]
Stock Position:  -0.06468900886736266
Bond Position:  [13.88036906]


portfolio before change:  [7.73511821]
curr_Stock_Price:  95.01024230878701
curr_Factors:  [95.01024231]
mat_Sqrt:  [[0.15]]
grads:  [-0.02749829]
Stock Position:  -0.02749828903188801
Bond Position:  [10.34773731]


portfolio before change:  [7.76528632]
curr_Stock_Price:  93.93667151947157
curr_Factors:  [93.93667152]
mat_Sqrt:  [[0.15]]
grads:  [0.05265188]
Stock Position:  0.05265187552328789
Bond Position:  [2.81934438]


portfolio before change:  [7.7629594]
curr_Stock_Price:  93.889130333549
curr_Factors:  [93.88913033]
mat_Sqrt:  [[0.15]]
grads:  [-0.06168201]
Stock Position:  -0.06168201378733848
Bond Position:  [13.55423003]


portfolio before change:  [7.79528012]
curr_Stock_Price:  93.3788754154137
curr_Factors:  [93.37887542]
mat_Sqrt:  [[0.15]]
grads:  [0.02588108]
Stock Position:  0.025881080392589222
Bond Position:  [5.37853394]


portfolio before change:  [7.79877339]
curr_Stock_Price:  93.5008602909738
curr_Factors:  [93.50086029]
mat_Sqrt:  [[0.15]]
grads:  [0.12751345]
Stock Position:  0.127513450927804
Bond Position:  [-4.12384397]


portfolio before change:  [7.78112735]
curr_Stock_Price:  93.36449595359416
curr_Factors:  [93.36449595]
mat_Sqrt:  [[0.15]]
grads:  [-0.10837973]
Stock Position:  -0.108379726574719
Bond Position:  [17.89994589]


portfolio before change:  [7.73451619]
curr_Stock_Price:  93.8048914165611
curr_Factors:  [93.80489142]
mat_Sqrt:  [[0.15]]
grads:  [-0.35289568]
Stock Position:  -0.35289567911212893
Bond Position:  [40.83785705]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.73451619]
Stock Price:  93.69453561063669
PL:  [7.73451619]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-5.92667622e-02]
 [ 1.39056141e-03]
 [ 5.45194937e-03]
 [ 2.42266279e-03]
 [ 4.91805138e-03]
 [ 1.20979914e-02]
 [ 4.61648299e-04]
 [ 5.94172608e-03]
 [-5.44074942e-03]
 [-2.00063468e-02]
 [ 1.00456692e-02]
 [-8.90085651e-03]
 [ 7.77774722e-03]
 [ 4.05746511e-03]
 [ 4.43673793e-03]
 [-1.00997373e-02]
 [ 1.47189792e-02]
 [ 9.55740081e-03]
 [ 2.40295164e-02]
 [ 1.03946842e-02]
 [ 6.06348931e-02]
 [-1.37737135e-02]
 [-2.19750561e-03]
 [ 4.91284524e-03]
 [ 1.30657320e-02]
 [-3.96600955e-03]
 [ 1.30955441e-02]
 [-1.52706026e-04]
 [ 3.58461446e-03]
 [-2.68371316e-02]
 [-4.56073167e-03]
 [ 1.01858064e-03]
 [ 1.57944798e-02]
 [ 1.73175026e-02]
 [-1.27606302e-03]
 [ 2.62761516e-03]
 [-4.41711340e-03]
 [ 1.17426826e-02]
 [-1.92893084e-03]
 [-1.37268474e-02]
 [-2.41251133e-03]
 [-1.98331061e-03]
 [ 3.42796399e-03]
 [-8.74331494e-03]
 [ 2.72486224e-03]
 [-2.46945392e-03]
 [-1.36928711e-02]
 [-4.00101305e-03]
 [-4.61698621e-05]
 [ 1.11760693e-02]
 [-3.01132112e-03]
 [ 3.63528192e-03]
 [ 1.58593870e-03]
 [-9.33564374e-04]
 [ 2.17519700e-03]
 [ 8.53586462e-03]
 [ 4.40666029e-03]
 [-1.98746230e-02]
 [ 1.33839340e-02]
 [ 4.49020278e-03]
 [ 1.03735599e-02]
 [-1.37789585e-02]
 [-1.27030665e-02]
 [-2.79004579e-03]
 [-1.63847904e-02]
 [ 1.26484344e-03]
 [ 2.85844040e-02]
 [ 2.22305609e-03]
 [ 7.27280824e-03]
 [-1.47386594e-02]
 [-7.82260076e-03]
 [-7.53742684e-03]
 [ 2.37989593e-03]
 [ 7.91004642e-03]
 [ 5.92855095e-03]
 [-9.79981629e-03]
 [-2.13171772e-03]
 [-8.50117519e-03]
 [ 1.06287457e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.27932561]
curr_Stock_Price:  100.52784709774521
curr_Factors:  [100.5278471]
mat_Sqrt:  [[0.15]]
grads:  [-0.39511175]
Stock Position:  -0.3951117477815231
Bond Position:  [49.99905898]


portfolio before change:  [10.06052884]
curr_Stock_Price:  101.08951555999033
curr_Factors:  [101.08951556]
mat_Sqrt:  [[0.15]]
grads:  [0.00927041]
Stock Position:  0.009270409390067461
Bond Position:  [9.12338765]


portfolio before change:  [10.06227898]
curr_Stock_Price:  101.21679211688404
curr_Factors:  [101.21679212]
mat_Sqrt:  [[0.15]]
grads:  [0.03634633]
Stock Position:  0.03634632911304098
Bond Position:  [6.38342014]


portfolio before change:  [10.04936593]
curr_Stock_Price:  100.85053701074781
curr_Factors:  [100.85053701]
mat_Sqrt:  [[0.15]]
grads:  [0.01615109]
Stock Position:  0.016151085267775672
Bond Position:  [8.4205203]


portfolio before change:  [10.05183474]
curr_Stock_Price:  100.97080850852619
curr_Factors:  [100.97080851]
mat_Sqrt:  [[0.15]]
grads:  [0.03278701]
Stock Position:  0.032787009192985835
Bond Position:  [6.74130391]


portfolio before change:  [10.06934619]
curr_Stock_Price:  101.4920548416861
curr_Factors:  [101.49205484]
mat_Sqrt:  [[0.15]]
grads:  [0.08065328]
Stock Position:  0.08065327595241523
Bond Position:  [1.88367949]


portfolio before change:  [10.03202818]
curr_Stock_Price:  101.02789824511547
curr_Factors:  [101.02789825]
mat_Sqrt:  [[0.15]]
grads:  [0.00307766]
Stock Position:  0.0030776553298699234
Bond Position:  [9.72109913]


portfolio before change:  [10.03390883]
curr_Stock_Price:  101.44154539960267
curr_Factors:  [101.4415454]
mat_Sqrt:  [[0.15]]
grads:  [0.03961151]
Stock Position:  0.03961150722111548
Bond Position:  [6.01565632]


portfolio before change:  [10.02867448]
curr_Stock_Price:  101.29991131226498
curr_Factors:  [101.29991131]
mat_Sqrt:  [[0.15]]
grads:  [-0.03627166]
Stock Position:  -0.036271662811412156
Bond Position:  [13.7029907]


portfolio before change:  [10.03760031]
curr_Stock_Price:  101.07744096429012
curr_Factors:  [101.07744096]
mat_Sqrt:  [[0.15]]
grads:  [-0.13337565]
Stock Position:  -0.13337564515269396
Bond Position:  [23.51886921]


portfolio before change:  [9.96526496]
curr_Stock_Price:  101.63080531466598
curr_Factors:  [101.63080531]
mat_Sqrt:  [[0.15]]
grads:  [0.06697113]
Stock Position:  0.06697112801170163
Bond Position:  [3.15893529]


portfolio before change:  [9.96803554]
curr_Stock_Price:  101.66922696672758
curr_Factors:  [101.66922697]
mat_Sqrt:  [[0.15]]
grads:  [-0.05933904]
Stock Position:  -0.05933904343002725
Bond Position:  [16.00099021]


portfolio before change:  [10.00838891]
curr_Stock_Price:  101.00603336739087
curr_Factors:  [101.00603337]
mat_Sqrt:  [[0.15]]
grads:  [0.05185165]
Stock Position:  0.05185164816110688
Bond Position:  [4.7710596]


portfolio before change:  [10.02455178]
curr_Stock_Price:  101.31199620319546
curr_Factors:  [101.3119962]
mat_Sqrt:  [[0.15]]
grads:  [0.02704977]
Stock Position:  0.027049767410363933
Bond Position:  [7.28408585]


portfolio before change:  [10.01613058]
curr_Stock_Price:  100.98384280121158
curr_Factors:  [100.9838428]
mat_Sqrt:  [[0.15]]
grads:  [0.02957825]
Stock Position:  0.029578252896878106
Bond Position:  [7.02920494]


portfolio before change:  [10.03922254]
curr_Stock_Price:  101.7496967563714
curr_Factors:  [101.74969676]
mat_Sqrt:  [[0.15]]
grads:  [-0.06733158]
Stock Position:  -0.0673315822579195
Bond Position:  [16.89019062]


portfolio before change:  [10.09163882]
curr_Stock_Price:  100.98689559772943
curr_Factors:  [100.9868956]
mat_Sqrt:  [[0.15]]
grads:  [0.09812653]
Stock Position:  0.0981265276805756
Bond Position:  [0.18214541]


portfolio before change:  [9.9846138]
curr_Stock_Price:  99.89609572174511
curr_Factors:  [99.89609572]
mat_Sqrt:  [[0.15]]
grads:  [0.06371601]
Stock Position:  0.06371600540561707
Bond Position:  [3.61963363]


portfolio before change:  [9.98080778]
curr_Stock_Price:  99.83281083837716
curr_Factors:  [99.83281084]
mat_Sqrt:  [[0.15]]
grads:  [0.16019678]
Stock Position:  0.16019677611980804
Bond Position:  [-6.01208667]


portfolio before change:  [9.91486169]
curr_Stock_Price:  99.42349975195765
curr_Factors:  [99.42349975]
mat_Sqrt:  [[0.15]]
grads:  [0.06929789]
Stock Position:  0.06929789498829757
Bond Position:  [3.02502245]


portfolio before change:  [9.93629616]
curr_Stock_Price:  99.73008040679693
curr_Factors:  [99.73008041]
mat_Sqrt:  [[0.15]]
grads:  [0.40423262]
Stock Position:  0.4042326206873958
Bond Position:  [-30.37785561]


portfolio before change:  [10.11106667]
curr_Stock_Price:  100.16712871897269
curr_Factors:  [100.16712872]
mat_Sqrt:  [[0.15]]
grads:  [-0.09182476]
Stock Position:  -0.0918247569782316
Bond Position:  [19.30888892]


portfolio before change:  [10.10855302]
curr_Stock_Price:  100.20764599407775
curr_Factors:  [100.20764599]
mat_Sqrt:  [[0.15]]
grads:  [-0.01465004]
Stock Position:  -0.014650037377249764
Bond Position:  [11.57659878]


portfolio before change:  [10.10091761]
curr_Stock_Price:  100.77822292407487
curr_Factors:  [100.77822292]
mat_Sqrt:  [[0.15]]
grads:  [0.0327523]
Stock Position:  0.03275230158802339
Bond Position:  [6.80019886]


portfolio before change:  [10.07635219]
curr_Stock_Price:  100.01520961048641
curr_Factors:  [100.01520961]
mat_Sqrt:  [[0.15]]
grads:  [0.08710488]
Stock Position:  0.08710488014639993
Bond Position:  [1.36453934]


portfolio before change:  [10.04647927]
curr_Stock_Price:  99.67127708618226
curr_Factors:  [99.67127709]
mat_Sqrt:  [[0.15]]
grads:  [-0.02644006]
Stock Position:  -0.026440063664356247
Bond Position:  [12.68179419]


portfolio before change:  [10.02544696]
curr_Stock_Price:  100.49672728685368
curr_Factors:  [100.49672729]
mat_Sqrt:  [[0.15]]
grads:  [0.08730363]
Stock Position:  0.08730362730089884
Bond Position:  [1.25171813]


portfolio before change:  [10.07026283]
curr_Stock_Price:  101.0091646576825
curr_Factors:  [101.00916466]
mat_Sqrt:  [[0.15]]
grads:  [-0.00101804]
Stock Position:  -0.001018040170325992
Bond Position:  [10.17309422]


portfolio before change:  [10.07113302]
curr_Stock_Price:  100.7789702188165
curr_Factors:  [100.77897022]
mat_Sqrt:  [[0.15]]
grads:  [0.02389743]
Stock Position:  0.02389742970893299
Bond Position:  [7.66277466]


portfolio before change:  [10.06589953]
curr_Stock_Price:  100.539930776072
curr_Factors:  [100.53993078]
mat_Sqrt:  [[0.15]]
grads:  [-0.17891421]
Stock Position:  -0.17891421040309285
Bond Position:  [28.05392186]


portfolio before change:  [10.1485068]
curr_Stock_Price:  100.08801671984898
curr_Factors:  [100.08801672]
mat_Sqrt:  [[0.15]]
grads:  [-0.03040488]
Stock Position:  -0.03040487782221225
Bond Position:  [13.19167072]


portfolio before change:  [10.15747021]
curr_Stock_Price:  99.82033252705874
curr_Factors:  [99.82033253]
mat_Sqrt:  [[0.15]]
grads:  [0.00679054]
Stock Position:  0.006790537620607329
Bond Position:  [9.47963649]


portfolio before change:  [10.15433338]
curr_Stock_Price:  99.27113822340392
curr_Factors:  [99.27113822]
mat_Sqrt:  [[0.15]]
grads:  [0.10529653]
Stock Position:  0.10529653228360826
Bond Position:  [-0.29857323]


portfolio before change:  [10.21946691]
curr_Stock_Price:  99.88988781314033
curr_Factors:  [99.88988781]
mat_Sqrt:  [[0.15]]
grads:  [0.11545002]
Stock Position:  0.11545001743789467
Bond Position:  [-1.31282238]


portfolio before change:  [10.21802533]
curr_Stock_Price:  99.87811195926457
curr_Factors:  [99.87811196]
mat_Sqrt:  [[0.15]]
grads:  [-0.00850709]
Stock Position:  -0.008507086776354637
Bond Position:  [11.06769709]


portfolio before change:  [10.22072834]
curr_Stock_Price:  99.64168992242331
curr_Factors:  [99.64168992]
mat_Sqrt:  [[0.15]]
grads:  [0.01751743]
Stock Position:  0.017517434400087392
Bond Position:  [8.47526158]


portfolio before change:  [10.2312238]
curr_Stock_Price:  100.21059365452979
curr_Factors:  [100.21059365]
mat_Sqrt:  [[0.15]]
grads:  [-0.02944742]
Stock Position:  -0.02944742269713976
Bond Position:  [13.18216751]


portfolio before change:  [10.24533011]
curr_Stock_Price:  99.7595387171969
curr_Factors:  [99.75953872]
mat_Sqrt:  [[0.15]]
grads:  [0.07828455]
Stock Position:  0.07828455065453765
Bond Position:  [2.43569945]


portfolio before change:  [10.27343534]
curr_Stock_Price:  100.11660778529836
curr_Factors:  [100.11660779]
mat_Sqrt:  [[0.15]]
grads:  [-0.01285954]
Stock Position:  -0.012859538963578034
Bond Position:  [11.56088876]


portfolio before change:  [10.2823957]
curr_Stock_Price:  99.4760109864255
curr_Factors:  [99.47601099]
mat_Sqrt:  [[0.15]]
grads:  [-0.09151232]
Stock Position:  -0.09151231618974456
Bond Position:  [19.38567587]


portfolio before change:  [10.25169408]
curr_Stock_Price:  99.82474286935911
curr_Factors:  [99.82474287]
mat_Sqrt:  [[0.15]]
grads:  [-0.01608341]
Stock Position:  -0.01608340888297491
Bond Position:  [11.85721624]


portfolio before change:  [10.26730071]
curr_Stock_Price:  98.90046561176543
curr_Factors:  [98.90046561]
mat_Sqrt:  [[0.15]]
grads:  [-0.01322207]
Stock Position:  -0.013222070757373245
Bond Position:  [11.57496966]


portfolio before change:  [10.27360284]
curr_Stock_Price:  98.47854433651001
curr_Factors:  [98.47854434]
mat_Sqrt:  [[0.15]]
grads:  [0.02285309]
Stock Position:  0.02285309323938523
Bond Position:  [8.02306348]


portfolio before change:  [10.28710827]
curr_Stock_Price:  99.04756881015997
curr_Factors:  [99.04756881]
mat_Sqrt:  [[0.15]]
grads:  [-0.05828877]
Stock Position:  -0.058288766254104805
Bond Position:  [16.06046885]


portfolio before change:  [10.26569846]
curr_Stock_Price:  99.43209595835677
curr_Factors:  [99.43209596]
mat_Sqrt:  [[0.15]]
grads:  [0.01816575]
Stock Position:  0.01816574827800797
Bond Position:  [8.45944004]


portfolio before change:  [10.26694029]
curr_Stock_Price:  99.47135076724862
curr_Factors:  [99.47135077]
mat_Sqrt:  [[0.15]]
grads:  [-0.01646303]
Stock Position:  -0.01646302612119464
Bond Position:  [11.90453973]


portfolio before change:  [10.26287424]
curr_Stock_Price:  99.76352702560607
curr_Factors:  [99.76352703]
mat_Sqrt:  [[0.15]]
grads:  [-0.09128581]
Stock Position:  -0.09128580756531288
Bond Position:  [19.36986837]


portfolio before change:  [10.28187473]
curr_Stock_Price:  99.5686464196798
curr_Factors:  [99.56864642]
mat_Sqrt:  [[0.15]]
grads:  [-0.02667342]
Stock Position:  -0.02667342035815494
Bond Position:  [12.93771109]


portfolio before change:  [10.25366737]
curr_Stock_Price:  100.6564707297546
curr_Factors:  [100.65647073]
mat_Sqrt:  [[0.15]]
grads:  [-0.0003078]
Stock Position:  -0.00030779908056524093
Bond Position:  [10.28464933]


portfolio before change:  [10.25462311]
curr_Stock_Price:  99.63978290092533
curr_Factors:  [99.6397829]
mat_Sqrt:  [[0.15]]
grads:  [0.07450713]
Stock Position:  0.07450712882070057
Bond Position:  [2.83074897]


portfolio before change:  [10.25951825]
curr_Stock_Price:  99.70310847321849
curr_Factors:  [99.70310847]
mat_Sqrt:  [[0.15]]
grads:  [-0.02007547]
Stock Position:  -0.020075474137190165
Bond Position:  [12.26110542]


portfolio before change:  [10.2565849]
curr_Stock_Price:  99.88739752854148
curr_Factors:  [99.88739753]
mat_Sqrt:  [[0.15]]
grads:  [0.02423521]
Stock Position:  0.02423521282805554
Bond Position:  [7.83579256]


portfolio before change:  [10.25310334]
curr_Stock_Price:  99.72353206969798
curr_Factors:  [99.72353207]
mat_Sqrt:  [[0.15]]
grads:  [0.01057292]
Stock Position:  0.010572924698873715
Bond Position:  [9.19873394]


portfolio before change:  [10.24998783]
curr_Stock_Price:  99.3744849859716
curr_Factors:  [99.37448499]
mat_Sqrt:  [[0.15]]
grads:  [-0.00622376]
Stock Position:  -0.006223762492922209
Bond Position:  [10.86847102]


portfolio before change:  [10.24533308]
curr_Stock_Price:  100.23153046373892
curr_Factors:  [100.23153046]
mat_Sqrt:  [[0.15]]
grads:  [0.01450131]
Stock Position:  0.014501313317110525
Bond Position:  [8.79184425]


portfolio before change:  [10.25737901]
curr_Stock_Price:  101.02431569848433
curr_Factors:  [101.0243157]
mat_Sqrt:  [[0.15]]
grads:  [0.05690576]
Stock Position:  0.05690576415912505
Bond Position:  [4.50851313]


portfolio before change:  [10.22016246]
curr_Stock_Price:  100.3653604886328
curr_Factors:  [100.36536049]
mat_Sqrt:  [[0.15]]
grads:  [0.02937774]
Stock Position:  0.029377735254276963
Bond Position:  [7.27165547]


portfolio before change:  [10.23623317]
curr_Stock_Price:  100.89692709121734
curr_Factors:  [100.89692709]
mat_Sqrt:  [[0.15]]
grads:  [-0.13249749]
Stock Position:  -0.13249748694332025
Bond Position:  [23.60482245]


portfolio before change:  [10.1238455]
curr_Stock_Price:  101.75628692608016
curr_Factors:  [101.75628693]
mat_Sqrt:  [[0.15]]
grads:  [0.08922623]
Stock Position:  0.08922622635902866
Bond Position:  [1.04451601]


portfolio before change:  [10.13480926]
curr_Stock_Price:  101.87843128436437
curr_Factors:  [101.87843128]
mat_Sqrt:  [[0.15]]
grads:  [0.02993469]
Stock Position:  0.029934685233330163
Bond Position:  [7.08511049]


portfolio before change:  [10.13595092]
curr_Stock_Price:  101.90177602306645
curr_Factors:  [101.90177602]
mat_Sqrt:  [[0.15]]
grads:  [0.06915707]
Stock Position:  0.06915706587441102
Bond Position:  [3.08872308]


portfolio before change:  [10.13086551]
curr_Stock_Price:  101.82545033932767
curr_Factors:  [101.82545034]
mat_Sqrt:  [[0.15]]
grads:  [-0.09185972]
Stock Position:  -0.0918597231412738
Bond Position:  [19.48452318]


portfolio before change:  [10.0734618]
curr_Stock_Price:  102.46361384319295
curr_Factors:  [102.46361384]
mat_Sqrt:  [[0.15]]
grads:  [-0.08468711]
Stock Position:  -0.08468711001447365
Bond Position:  [18.75080914]


portfolio before change:  [10.1378105]
curr_Stock_Price:  101.71761209159305
curr_Factors:  [101.71761209]
mat_Sqrt:  [[0.15]]
grads:  [-0.01860031]
Stock Position:  -0.018600305248614356
Bond Position:  [12.02978913]


portfolio before change:  [10.1277961]
curr_Stock_Price:  102.2964349302673
curr_Factors:  [102.29643493]
mat_Sqrt:  [[0.15]]
grads:  [-0.10923194]
Stock Position:  -0.109231936200945
Bond Position:  [21.30183376]


portfolio before change:  [10.16077919]
curr_Stock_Price:  102.00666908659011
curr_Factors:  [102.00666909]
mat_Sqrt:  [[0.15]]
grads:  [0.00843229]
Stock Position:  0.008432289627055374
Bond Position:  [9.30062942]


portfolio before change:  [10.16187154]
curr_Stock_Price:  102.06727453907548
curr_Factors:  [102.06727454]
mat_Sqrt:  [[0.15]]
grads:  [0.19056269]
Stock Position:  0.19056269328762043
Bond Position:  [-9.28834319]


portfolio before change:  [10.21893136]
curr_Stock_Price:  102.36974906255732
curr_Factors:  [102.36974906]
mat_Sqrt:  [[0.15]]
grads:  [0.01482037]
Stock Position:  0.014820373929230697
Bond Position:  [8.7017734]


portfolio before change:  [10.22116867]
curr_Stock_Price:  102.48401274468287
curr_Factors:  [102.48401274]
mat_Sqrt:  [[0.15]]
grads:  [0.04848539]
Stock Position:  0.04848538823451393
Bond Position:  [5.25219153]


portfolio before change:  [10.218223]
curr_Stock_Price:  102.4164883882693
curr_Factors:  [102.41648839]
mat_Sqrt:  [[0.15]]
grads:  [-0.09825773]
Stock Position:  -0.09825772940770826
Bond Position:  [20.2814346]


portfolio before change:  [10.21170087]
curr_Stock_Price:  102.49576723577343
curr_Factors:  [102.49576724]
mat_Sqrt:  [[0.15]]
grads:  [-0.05215067]
Stock Position:  -0.05215067171207354
Bond Position:  [15.55692398]


portfolio before change:  [10.24173822]
curr_Stock_Price:  101.93843948616065
curr_Factors:  [101.93843949]
mat_Sqrt:  [[0.15]]
grads:  [-0.05024951]
Stock Position:  -0.05024951225616861
Bond Position:  [15.36409509]


portfolio before change:  [10.20795689]
curr_Stock_Price:  102.62982165940066
curr_Factors:  [102.62982166]
mat_Sqrt:  [[0.15]]
grads:  [0.01586597]
Stock Position:  0.015865972862700684
Bond Position:  [8.57963493]


portfolio before change:  [10.20442929]
curr_Stock_Price:  102.3736856251288
curr_Factors:  [102.37368563]
mat_Sqrt:  [[0.15]]
grads:  [0.05273364]
Stock Position:  0.052733642790265815
Bond Position:  [4.80589192]


portfolio before change:  [10.14910864]
curr_Stock_Price:  101.31893160402139
curr_Factors:  [101.3189316]
mat_Sqrt:  [[0.15]]
grads:  [0.03952367]
Stock Position:  0.03952367301434458
Bond Position:  [6.14461232]


portfolio before change:  [10.1400474]
curr_Stock_Price:  101.07995342849028
curr_Factors:  [101.07995343]
mat_Sqrt:  [[0.15]]
grads:  [-0.06533211]
Stock Position:  -0.06533210860767323
Bond Position:  [16.7438139]


portfolio before change:  [10.21151659]
curr_Stock_Price:  100.00203526095699
curr_Factors:  [100.00203526]
mat_Sqrt:  [[0.15]]
grads:  [-0.01421145]
Stock Position:  -0.014211451452735443
Bond Position:  [11.63269066]


portfolio before change:  [10.20730474]
curr_Stock_Price:  100.3495659247517
curr_Factors:  [100.34956592]
mat_Sqrt:  [[0.15]]
grads:  [-0.0566745]
Stock Position:  -0.0566745012338384
Bond Position:  [15.89456634]


portfolio before change:  [10.16887528]
curr_Stock_Price:  101.04516798455127
curr_Factors:  [101.04516798]
mat_Sqrt:  [[0.15]]
grads:  [0.0708583]
Stock Position:  0.07085830493802361
Bond Position:  [3.00898595]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.16887528]
Stock Price:  100.77158918911513
PL:  [9.39728609]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-6.31451954e-02]
 [ 1.49393915e-03]
 [ 7.85042637e-03]
 [ 2.74541245e-03]
 [ 1.25902719e-02]
 [ 1.20595462e-02]
 [ 5.95712774e-04]
 [ 6.61717985e-03]
 [ 1.31568125e-03]
 [-2.03584556e-02]
 [ 1.01496072e-02]
 [-7.92978054e-03]
 [ 5.44860821e-03]
 [ 4.08458490e-03]
 [ 4.85603034e-03]
 [-1.00539007e-02]
 [ 8.56360921e-03]
 [ 2.64991432e-02]
 [ 1.43061470e-02]
 [-2.41736466e-03]
 [ 4.79311449e-02]
 [-1.16866533e-02]
 [ 4.25521628e-03]
 [ 2.31924320e-04]
 [ 1.79767789e-02]
 [ 1.32730605e-02]
 [ 6.40063657e-03]
 [ 2.86199498e-03]
 [ 7.43074546e-03]
 [-1.85301087e-02]
 [-5.32362634e-03]
 [ 1.52558498e-02]
 [ 1.16903805e-02]
 [ 1.70612921e-02]
 [-1.10652308e-02]
 [ 6.08741952e-03]
 [-2.58828191e-03]
 [ 8.18187949e-03]
 [ 3.67707756e-03]
 [-1.51504090e-02]
 [ 2.74536086e-02]
 [ 1.00645743e-03]
 [ 6.17294001e-03]
 [-8.82550453e-03]
 [ 3.35915367e-04]
 [-5.85058434e-03]
 [-1.35607656e-02]
 [-6.76039651e-04]
 [-2.74021166e-03]
 [-2.78179363e-03]
 [-3.96017271e-03]
 [ 2.88811672e-03]
 [ 3.66352151e-03]
 [-1.75889223e-03]
 [ 1.74194882e-02]
 [ 8.91898387e-03]
 [ 4.71435284e-03]
 [ 3.28119170e-03]
 [ 1.35715138e-02]
 [-3.59711753e-03]
 [-2.25475579e-03]
 [-1.63076486e-02]
 [-1.26289477e-02]
 [-1.30435401e-03]
 [-1.14145677e-02]
 [-9.82692387e-03]
 [ 9.92841624e-03]
 [ 2.31937550e-03]
 [ 9.27691187e-03]
 [-1.75642714e-02]
 [ 5.26448573e-04]
 [ 1.79250018e-03]
 [-5.03487873e-04]
 [ 8.07474098e-03]
 [-3.10708882e-04]
 [ 1.16060029e-03]
 [-3.90698820e-03]
 [-1.06632770e-02]
 [-8.13039737e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.20365865]
curr_Stock_Price:  100.5872545917547
curr_Factors:  [100.58725459]
mat_Sqrt:  [[0.15]]
grads:  [-0.42096797]
Stock Position:  -0.42096796939806025
Bond Position:  [53.54767096]


portfolio before change:  [10.98649023]
curr_Stock_Price:  101.11108364077246
curr_Factors:  [101.11108364]
mat_Sqrt:  [[0.15]]
grads:  [0.00995959]
Stock Position:  0.009959594306696542
Bond Position:  [9.97946486]


portfolio before change:  [10.99028124]
curr_Stock_Price:  101.42909583294357
curr_Factors:  [101.42909583]
mat_Sqrt:  [[0.15]]
grads:  [0.05233618]
Stock Position:  0.05233617581021123
Bond Position:  [5.68187025]


portfolio before change:  [10.97811392]
curr_Stock_Price:  101.18982641465175
curr_Factors:  [101.18982641]
mat_Sqrt:  [[0.15]]
grads:  [0.01830275]
Stock Position:  0.018302749643421524
Bond Position:  [9.12606186]


portfolio before change:  [10.96230902]
curr_Stock_Price:  100.2951357442297
curr_Factors:  [100.29513574]
mat_Sqrt:  [[0.15]]
grads:  [0.08393515]
Stock Position:  0.08393514595697765
Bond Position:  [2.54402216]


portfolio before change:  [11.05229455]
curr_Stock_Price:  101.36532539672938
curr_Factors:  [101.3653254]
mat_Sqrt:  [[0.15]]
grads:  [0.08039697]
Stock Position:  0.08039697459210426
Bond Position:  [2.90282906]


portfolio before change:  [11.01757311]
curr_Stock_Price:  100.93119378291051
curr_Factors:  [100.93119378]
mat_Sqrt:  [[0.15]]
grads:  [0.00397142]
Stock Position:  0.003971418490730849
Bond Position:  [10.61673311]


portfolio before change:  [11.01970462]
curr_Stock_Price:  101.30081944603577
curr_Factors:  [101.30081945]
mat_Sqrt:  [[0.15]]
grads:  [0.04411453]
Stock Position:  0.04411453232289216
Bond Position:  [6.55086635]


portfolio before change:  [10.9902157]
curr_Stock_Price:  100.6230753415303
curr_Factors:  [100.62307534]
mat_Sqrt:  [[0.15]]
grads:  [0.00877121]
Stock Position:  0.00877120832356754
Bond Position:  [10.10762974]


portfolio before change:  [10.9910405]
curr_Stock_Price:  100.64508592967654
curr_Factors:  [100.64508593]
mat_Sqrt:  [[0.15]]
grads:  [-0.13572304]
Stock Position:  -0.1357230370807276
Bond Position:  [24.65089723]


portfolio before change:  [10.92648691]
curr_Stock_Price:  101.13206531599424
curr_Factors:  [101.13206532]
mat_Sqrt:  [[0.15]]
grads:  [0.06766405]
Stock Position:  0.06766404803734428
Bond Position:  [4.08348199]


portfolio before change:  [10.9387876]
curr_Stock_Price:  101.31008403522614
curr_Factors:  [101.31008404]
mat_Sqrt:  [[0.15]]
grads:  [-0.0528652]
Stock Position:  -0.05286520361687033
Bond Position:  [16.29456582]


portfolio before change:  [10.96149588]
curr_Stock_Price:  100.89979848301029
curr_Factors:  [100.89979848]
mat_Sqrt:  [[0.15]]
grads:  [0.03632405]
Stock Position:  0.036324054743428716
Bond Position:  [7.29640607]


portfolio before change:  [10.97404947]
curr_Stock_Price:  101.23284365201529
curr_Factors:  [101.23284365]
mat_Sqrt:  [[0.15]]
grads:  [0.02723057]
Stock Position:  0.02723056598111435
Bond Position:  [8.21742184]


portfolio before change:  [10.96591412]
curr_Stock_Price:  100.91522440466102
curr_Factors:  [100.9152244]
mat_Sqrt:  [[0.15]]
grads:  [0.03237354]
Stock Position:  0.03237353558752744
Bond Position:  [7.69893151]


portfolio before change:  [11.00735342]
curr_Stock_Price:  102.18039681527635
curr_Factors:  [102.18039682]
mat_Sqrt:  [[0.15]]
grads:  [-0.067026]
Stock Position:  -0.06702600442059449
Bond Position:  [17.85609715]


portfolio before change:  [11.00065513]
curr_Stock_Price:  102.29698341990162
curr_Factors:  [102.29698342]
mat_Sqrt:  [[0.15]]
grads:  [0.05709073]
Stock Position:  0.057090728086274155
Bond Position:  [5.16044586]


portfolio before change:  [11.00777132]
curr_Stock_Price:  102.41598084312781
curr_Factors:  [102.41598084]
mat_Sqrt:  [[0.15]]
grads:  [0.17666095]
Stock Position:  0.17666095449513794
Bond Position:  [-7.08513362]


portfolio before change:  [11.00954591]
curr_Stock_Price:  102.42853272069756
curr_Factors:  [102.42853272]
mat_Sqrt:  [[0.15]]
grads:  [0.09537431]
Stock Position:  0.09537431341575967
Bond Position:  [1.24049492]


portfolio before change:  [11.06234501]
curr_Stock_Price:  102.98131857966803
curr_Factors:  [102.98131858]
mat_Sqrt:  [[0.15]]
grads:  [-0.01611576]
Stock Position:  -0.01611576441775097
Bond Position:  [12.72196768]


portfolio before change:  [11.07378351]
curr_Stock_Price:  102.32088786012245
curr_Factors:  [102.32088786]
mat_Sqrt:  [[0.15]]
grads:  [0.31954097]
Stock Position:  0.31954096610605537
Bond Position:  [-21.62193185]


portfolio before change:  [11.20100345]
curr_Stock_Price:  102.7232505184405
curr_Factors:  [102.72325052]
mat_Sqrt:  [[0.15]]
grads:  [-0.07791102]
Stock Position:  -0.07791102217244508
Bond Position:  [19.20427689]


portfolio before change:  [11.18427954]
curr_Stock_Price:  102.95331053736419
curr_Factors:  [102.95331054]
mat_Sqrt:  [[0.15]]
grads:  [0.02836811]
Stock Position:  0.02836810855881208
Bond Position:  [8.26368885]


portfolio before change:  [11.19622442]
curr_Stock_Price:  103.35617074257131
curr_Factors:  [103.35617074]
mat_Sqrt:  [[0.15]]
grads:  [0.00154616]
Stock Position:  0.001546162131646284
Bond Position:  [11.03641902]


portfolio before change:  [11.19721686]
curr_Stock_Price:  103.55191287756939
curr_Factors:  [103.55191288]
mat_Sqrt:  [[0.15]]
grads:  [0.11984519]
Stock Position:  0.11984519285999164
Bond Position:  [-1.2129821]


portfolio before change:  [11.35940336]
curr_Stock_Price:  104.90584546619202
curr_Factors:  [104.90584547]
mat_Sqrt:  [[0.15]]
grads:  [0.08848707]
Stock Position:  0.08848707014504366
Bond Position:  [2.07659246]


portfolio before change:  [11.36291704]
curr_Stock_Price:  104.94408704849499
curr_Factors:  [104.94408705]
mat_Sqrt:  [[0.15]]
grads:  [0.04267091]
Stock Position:  0.04267091045186715
Bond Position:  [6.8848573]


portfolio before change:  [11.34212001]
curr_Stock_Price:  104.44662049780777
curr_Factors:  [104.4466205]
mat_Sqrt:  [[0.15]]
grads:  [0.01907997]
Stock Position:  0.019079966542130934
Bond Position:  [9.34928198]


portfolio before change:  [11.3244244]
curr_Stock_Price:  103.48855002142997
curr_Factors:  [103.48855002]
mat_Sqrt:  [[0.15]]
grads:  [0.0495383]
Stock Position:  0.04953830305032852
Bond Position:  [6.19777725]


portfolio before change:  [11.25781061]
curr_Stock_Price:  102.13603776241065
curr_Factors:  [102.13603776]
mat_Sqrt:  [[0.15]]
grads:  [-0.12353406]
Stock Position:  -0.12353405815685274
Bond Position:  [23.87508984]


portfolio before change:  [11.34874011]
curr_Stock_Price:  101.41204908493512
curr_Factors:  [101.41204908]
mat_Sqrt:  [[0.15]]
grads:  [-0.03549084]
Stock Position:  -0.035490842282928016
Bond Position:  [14.94793915]


portfolio before change:  [11.36060594]
curr_Stock_Price:  101.1040384438909
curr_Factors:  [101.10403844]
mat_Sqrt:  [[0.15]]
grads:  [0.10170567]
Stock Position:  0.1017056651280948
Bond Position:  [1.07775247]


portfolio before change:  [11.31146818]
curr_Stock_Price:  100.6202391797483
curr_Factors:  [100.62023918]
mat_Sqrt:  [[0.15]]
grads:  [0.07793587]
Stock Position:  0.07793587003967598
Bond Position:  [3.4695423]


portfolio before change:  [11.2568968]
curr_Stock_Price:  99.91724795207426
curr_Factors:  [99.91724795]
mat_Sqrt:  [[0.15]]
grads:  [0.11374195]
Stock Position:  0.11374194703091366
Bond Position:  [-0.10788552]


portfolio before change:  [11.1630261]
curr_Stock_Price:  99.09201185853433
curr_Factors:  [99.09201186]
mat_Sqrt:  [[0.15]]
grads:  [-0.07376821]
Stock Position:  -0.07376820505374873
Bond Position:  [18.47286595]


portfolio before change:  [11.19010702]
curr_Stock_Price:  98.74055507502634
curr_Factors:  [98.74055508]
mat_Sqrt:  [[0.15]]
grads:  [0.0405828]
Stock Position:  0.04058279682387789
Bond Position:  [7.18293914]


portfolio before change:  [11.1603369]
curr_Stock_Price:  97.99592755760244
curr_Factors:  [97.99592756]
mat_Sqrt:  [[0.15]]
grads:  [-0.01725521]
Stock Position:  -0.01725521272789522
Bond Position:  [12.85127748]


portfolio before change:  [11.15528804]
curr_Stock_Price:  98.33507686451848
curr_Factors:  [98.33507686]
mat_Sqrt:  [[0.15]]
grads:  [0.05454586]
Stock Position:  0.05454586324583677
Bond Position:  [5.79151639]


portfolio before change:  [11.13807454]
curr_Stock_Price:  98.01286202821075
curr_Factors:  [98.01286203]
mat_Sqrt:  [[0.15]]
grads:  [0.02451385]
Stock Position:  0.024513850412977573
Bond Position:  [8.7354019]


portfolio before change:  [11.13452929]
curr_Stock_Price:  97.8459674299179
curr_Factors:  [97.84596743]
mat_Sqrt:  [[0.15]]
grads:  [-0.10100273]
Stock Position:  -0.10100272655578935
Bond Position:  [21.01723878]


portfolio before change:  [11.1163371]
curr_Stock_Price:  98.03908902172488
curr_Factors:  [98.03908902]
mat_Sqrt:  [[0.15]]
grads:  [0.18302406]
Stock Position:  0.1830240571874572
Bond Position:  [-6.82717474]


portfolio before change:  [10.8268122]
curr_Stock_Price:  96.45952517439403
curr_Factors:  [96.45952517]
mat_Sqrt:  [[0.15]]
grads:  [0.00670972]
Stock Position:  0.006709716182939415
Bond Position:  [10.17959616]


portfolio before change:  [10.83059947]
curr_Stock_Price:  96.92914558543075
curr_Factors:  [96.92914559]
mat_Sqrt:  [[0.15]]
grads:  [0.04115293]
Stock Position:  0.04115293339323447
Bond Position:  [6.84168079]


portfolio before change:  [10.83885857]
curr_Stock_Price:  97.11944756286923
curr_Factors:  [97.11944756]
mat_Sqrt:  [[0.15]]
grads:  [-0.0588367]
Stock Position:  -0.058836696897808474
Bond Position:  [16.55304607]


portfolio before change:  [10.83766388]
curr_Stock_Price:  97.15733689088752
curr_Factors:  [97.15733689]
mat_Sqrt:  [[0.15]]
grads:  [0.00223944]
Stock Position:  0.0022394357826257573
Bond Position:  [10.62008627]


portfolio before change:  [10.83898519]
curr_Stock_Price:  97.45094891250558
curr_Factors:  [97.45094891]
mat_Sqrt:  [[0.15]]
grads:  [-0.0390039]
Stock Position:  -0.03900389556668014
Bond Position:  [14.63995182]


portfolio before change:  [10.83819807]
curr_Stock_Price:  97.49458912875738
curr_Factors:  [97.49458913]
mat_Sqrt:  [[0.15]]
grads:  [-0.0904051]
Stock Position:  -0.09040510382364324
Bond Position:  [19.65220652]


portfolio before change:  [10.84829644]
curr_Stock_Price:  97.39647445491019
curr_Factors:  [97.39647445]
mat_Sqrt:  [[0.15]]
grads:  [-0.00450693]
Stock Position:  -0.004506931008512356
Bond Position:  [11.28725563]


portfolio before change:  [10.8512322]
curr_Stock_Price:  96.90161875791286
curr_Factors:  [96.90161876]
mat_Sqrt:  [[0.15]]
grads:  [-0.01826808]
Stock Position:  -0.01826807770923088
Bond Position:  [12.6214385]


portfolio before change:  [10.86093474]
curr_Stock_Price:  96.41368115891123
curr_Factors:  [96.41368116]
mat_Sqrt:  [[0.15]]
grads:  [-0.01854529]
Stock Position:  -0.018545290874623737
Bond Position:  [12.6489545]


portfolio before change:  [10.8686363]
curr_Stock_Price:  96.04102751548052
curr_Factors:  [96.04102752]
mat_Sqrt:  [[0.15]]
grads:  [-0.02640115]
Stock Position:  -0.02640115136826642
Bond Position:  [13.40423]


portfolio before change:  [10.86748468]
curr_Stock_Price:  96.1163805368024
curr_Factors:  [96.11638054]
mat_Sqrt:  [[0.15]]
grads:  [0.01925411]
Stock Position:  0.019254111461592643
Bond Position:  [9.01684918]


portfolio before change:  [10.86331901]
curr_Stock_Price:  95.8707579780407
curr_Factors:  [95.87075798]
mat_Sqrt:  [[0.15]]
grads:  [0.02442348]
Stock Position:  0.02442347673734834
Bond Position:  [8.52182178]


portfolio before change:  [10.83334364]
curr_Stock_Price:  94.62163220179015
curr_Factors:  [94.6216322]
mat_Sqrt:  [[0.15]]
grads:  [-0.01172595]
Stock Position:  -0.011725948214390334
Bond Position:  [11.942872]


portfolio before change:  [10.83739521]
curr_Stock_Price:  94.33976938911131
curr_Factors:  [94.33976939]
mat_Sqrt:  [[0.15]]
grads:  [0.11612992]
Stock Position:  0.11612992105936161
Bond Position:  [-0.11827477]


portfolio before change:  [10.92685296]
curr_Stock_Price:  95.11015782251556
curr_Factors:  [95.11015782]
mat_Sqrt:  [[0.15]]
grads:  [0.05945989]
Stock Position:  0.059459892484449016
Bond Position:  [5.2716132]


portfolio before change:  [10.94747745]
curr_Stock_Price:  95.45148044475367
curr_Factors:  [95.45148044]
mat_Sqrt:  [[0.15]]
grads:  [0.03142902]
Stock Position:  0.031429018904093664
Bond Position:  [7.94753107]


portfolio before change:  [10.99432945]
curr_Stock_Price:  96.92639942425056
curr_Factors:  [96.92639942]
mat_Sqrt:  [[0.15]]
grads:  [0.02187461]
Stock Position:  0.021874611351067674
Bond Position:  [8.87410213]


portfolio before change:  [10.99904337]
curr_Stock_Price:  97.11654104072848
curr_Factors:  [97.11654104]
mat_Sqrt:  [[0.15]]
grads:  [0.09047676]
Stock Position:  0.09047675846757226
Bond Position:  [2.21225354]


portfolio before change:  [10.87944851]
curr_Stock_Price:  95.79318320491399
curr_Factors:  [95.7931832]
mat_Sqrt:  [[0.15]]
grads:  [-0.02398078]
Stock Position:  -0.023980783538445818
Bond Position:  [13.1766441]


portfolio before change:  [10.87380833]
curr_Stock_Price:  96.06272203113942
curr_Factors:  [96.06272203]
mat_Sqrt:  [[0.15]]
grads:  [-0.01503171]
Stock Position:  -0.01503170525733304
Bond Position:  [12.31779485]


portfolio before change:  [10.85265805]
curr_Stock_Price:  97.52098361352176
curr_Factors:  [97.52098361]
mat_Sqrt:  [[0.15]]
grads:  [-0.10871766]
Stock Position:  -0.10871765734752549
Bond Position:  [21.45491093]


portfolio before change:  [10.76129407]
curr_Stock_Price:  98.37369658085234
curr_Factors:  [98.37369658]
mat_Sqrt:  [[0.15]]
grads:  [-0.08419298]
Stock Position:  -0.08419298461379703
Bond Position:  [19.04366919]


portfolio before change:  [10.74386092]
curr_Stock_Price:  98.5948957917423
curr_Factors:  [98.59489579]
mat_Sqrt:  [[0.15]]
grads:  [-0.00869569]
Stock Position:  -0.008695693402220775
Bond Position:  [11.6012119]


portfolio before change:  [10.74584741]
curr_Stock_Price:  98.44983566808
curr_Factors:  [98.44983567]
mat_Sqrt:  [[0.15]]
grads:  [-0.07609712]
Stock Position:  -0.07609711771070324
Bond Position:  [18.23759615]


portfolio before change:  [10.76548038]
curr_Stock_Price:  98.20681622784859
curr_Factors:  [98.20681623]
mat_Sqrt:  [[0.15]]
grads:  [-0.06551283]
Stock Position:  -0.06551282580494186
Bond Position:  [17.19928642]


portfolio before change:  [10.81974946]
curr_Stock_Price:  97.39485163863252
curr_Factors:  [97.39485164]
mat_Sqrt:  [[0.15]]
grads:  [0.06618944]
Stock Position:  0.06618944160766463
Bond Position:  [4.37323862]


portfolio before change:  [10.87415754]
curr_Stock_Price:  98.2127273689811
curr_Factors:  [98.21272737]
mat_Sqrt:  [[0.15]]
grads:  [0.0154625]
Stock Position:  0.01546250333590124
Bond Position:  [9.35554291]


portfolio before change:  [10.87512411]
curr_Stock_Price:  98.23742186925942
curr_Factors:  [98.23742187]
mat_Sqrt:  [[0.15]]
grads:  [0.06184608]
Stock Position:  0.0618460791048251
Bond Position:  [4.79952475]


portfolio before change:  [10.82083457]
curr_Stock_Price:  97.35475435592714
curr_Factors:  [97.35475436]
mat_Sqrt:  [[0.15]]
grads:  [-0.11709514]
Stock Position:  -0.11709514255092687
Bond Position:  [22.22060341]


portfolio before change:  [10.75269448]
curr_Stock_Price:  97.94853573810497
curr_Factors:  [97.94853574]
mat_Sqrt:  [[0.15]]
grads:  [0.00350966]
Stock Position:  0.0035096571542572283
Bond Position:  [10.4089287]


portfolio before change:  [10.75139077]
curr_Stock_Price:  97.3917029767259
curr_Factors:  [97.39170298]
mat_Sqrt:  [[0.15]]
grads:  [0.01195]
Stock Position:  0.011950001223260155
Bond Position:  [9.5875598]


portfolio before change:  [10.75166411]
curr_Stock_Price:  97.36443053033697
curr_Factors:  [97.36443053]
mat_Sqrt:  [[0.15]]
grads:  [-0.00335659]
Stock Position:  -0.0033565858232874886
Bond Position:  [11.07847617]


portfolio before change:  [10.75316668]
curr_Stock_Price:  97.1230687543186
curr_Factors:  [97.12306875]
mat_Sqrt:  [[0.15]]
grads:  [0.05383161]
Stock Position:  0.05383160655309681
Bond Position:  [5.52487586]


portfolio before change:  [10.75991651]
curr_Stock_Price:  97.24204179491812
curr_Factors:  [97.24204179]
mat_Sqrt:  [[0.15]]
grads:  [-0.00207139]
Stock Position:  -0.00207139254378193
Bond Position:  [10.96134295]


portfolio before change:  [10.75969179]
curr_Stock_Price:  97.68127744362984
curr_Factors:  [97.68127744]
mat_Sqrt:  [[0.15]]
grads:  [0.00773734]
Stock Position:  0.007737335264858106
Bond Position:  [10.00389899]


portfolio before change:  [10.76388923]
curr_Stock_Price:  98.1429580890158
curr_Factors:  [98.14295809]
mat_Sqrt:  [[0.15]]
grads:  [-0.02604659]
Stock Position:  -0.026046587971389513
Bond Position:  [13.32017842]


portfolio before change:  [10.77551547]
curr_Stock_Price:  97.72855819295631
curr_Factors:  [97.72855819]
mat_Sqrt:  [[0.15]]
grads:  [-0.07108851]
Stock Position:  -0.07108851366076482
Bond Position:  [17.72289341]


portfolio before change:  [10.71834895]
curr_Stock_Price:  98.54830014385037
curr_Factors:  [98.54830014]
mat_Sqrt:  [[0.15]]
grads:  [-0.05420265]
Stock Position:  -0.05420264914153608
Bond Position:  [16.05992788]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.71834895]
Stock Price:  98.4882852672671
PL:  [10.71834895]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.07851274e-02]
 [ 1.01838351e-02]
 [-6.26246878e-04]
 [-2.28152017e-03]
 [-1.96332579e-02]
 [ 6.59243159e-03]
 [ 7.55770312e-04]
 [ 1.48056172e-02]
 [ 1.74500057e-02]
 [-1.90381096e-02]
 [ 7.50514486e-03]
 [-4.88393679e-03]
 [-1.81290028e-03]
 [ 4.12648201e-03]
 [ 2.26189262e-03]
 [-1.01715593e-02]
 [ 1.46708063e-02]
 [ 2.22183154e-02]
 [ 2.14012330e-02]
 [ 2.52557336e-03]
 [ 6.93235376e-02]
 [-1.32248552e-02]
 [ 3.05955465e-03]
 [ 8.02994398e-03]
 [ 1.28535781e-02]
 [-7.82877599e-03]
 [ 1.26899973e-02]
 [ 7.43548167e-05]
 [ 3.84777371e-03]
 [-2.78285705e-02]
 [-4.93956727e-03]
 [ 6.53744866e-03]
 [ 1.57964074e-02]
 [ 1.97704005e-02]
 [-8.93824335e-03]
 [ 2.46604987e-03]
 [-2.21725153e-03]
 [ 1.01036187e-02]
 [ 2.76683527e-03]
 [-1.45326913e-02]
 [ 3.26730431e-02]
 [-1.20846254e-04]
 [ 6.37818819e-03]
 [-9.27927982e-03]
 [-6.77942963e-04]
 [-9.66795446e-03]
 [-1.33631473e-02]
 [ 5.97008150e-04]
 [-2.64620641e-03]
 [-5.72509244e-03]
 [-4.15739940e-03]
 [ 2.90158918e-03]
 [ 3.68988449e-03]
 [-4.35485643e-04]
 [ 4.82984193e-03]
 [ 8.84321980e-03]
 [ 1.12586357e-02]
 [ 4.43062094e-03]
 [ 1.35040163e-02]
 [-2.04959930e-03]
 [ 6.84239115e-04]
 [-1.52125566e-02]
 [-1.26493095e-02]
 [-1.04203799e-03]
 [-1.09895108e-02]
 [-1.02178922e-02]
 [ 1.02584391e-02]
 [ 2.31261492e-03]
 [ 1.10447869e-02]
 [-1.79519107e-02]
 [ 4.67563574e-03]
 [ 5.89666323e-04]
 [-6.04817174e-04]
 [ 8.13497976e-03]
 [-1.01823181e-03]
 [ 2.55086660e-03]
 [ 6.91255464e-03]
 [-1.22381525e-02]
 [-4.30177951e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.34416776]
curr_Stock_Price:  99.13809091560154
curr_Factors:  [99.13809092]
mat_Sqrt:  [[0.15]]
grads:  [-0.20523418]
Stock Position:  -0.2052341828062806
Bond Position:  [9.00235731]


portfolio before change:  [-11.22105116]
curr_Stock_Price:  98.54094898497328
curr_Factors:  [98.54094898]
mat_Sqrt:  [[0.15]]
grads:  [0.06789223]
Stock Position:  0.06789223382692976
Bond Position:  [-17.91121631]


portfolio before change:  [-11.21517103]
curr_Stock_Price:  98.64404800204629
curr_Factors:  [98.644048]
mat_Sqrt:  [[0.15]]
grads:  [-0.00417498]
Stock Position:  -0.0041749791892096875
Bond Position:  [-10.80333418]


portfolio before change:  [-11.21407634]
curr_Stock_Price:  98.22011352958197
curr_Factors:  [98.22011353]
mat_Sqrt:  [[0.15]]
grads:  [-0.01521013]
Stock Position:  -0.015210134444541954
Bond Position:  [-9.72013521]


portfolio before change:  [-11.21723026]
curr_Stock_Price:  98.38752763098182
curr_Factors:  [98.38752763]
mat_Sqrt:  [[0.15]]
grads:  [-0.13088839]
Stock Position:  -0.13088838588603122
Bond Position:  [1.66055443]


portfolio before change:  [-11.26121291]
curr_Stock_Price:  98.72435229414356
curr_Factors:  [98.72435229]
mat_Sqrt:  [[0.15]]
grads:  [0.04394954]
Stock Position:  0.04394954394674303
Bond Position:  [-15.60010317]


portfolio before change:  [-11.27138553]
curr_Stock_Price:  98.51507629336913
curr_Factors:  [98.51507629]
mat_Sqrt:  [[0.15]]
grads:  [0.00503847]
Stock Position:  0.005038468748288956
Bond Position:  [-11.76775066]


portfolio before change:  [-11.27055633]
curr_Stock_Price:  98.82562859411179
curr_Factors:  [98.82562859]
mat_Sqrt:  [[0.15]]
grads:  [0.09870411]
Stock Position:  0.09870411452575044
Bond Position:  [-21.02505249]


portfolio before change:  [-11.20926933]
curr_Stock_Price:  99.45985852528264
curr_Factors:  [99.45985853]
mat_Sqrt:  [[0.15]]
grads:  [0.11633337]
Stock Position:  0.11633337133426389
Bond Position:  [-22.77976998]


portfolio before change:  [-11.1996437]
curr_Stock_Price:  99.55483906316434
curr_Factors:  [99.55483906]
mat_Sqrt:  [[0.15]]
grads:  [-0.12692073]
Stock Position:  -0.1269207305922279
Bond Position:  [1.4359292]


portfolio before change:  [-11.21624512]
curr_Stock_Price:  99.68634761189112
curr_Factors:  [99.68634761]
mat_Sqrt:  [[0.15]]
grads:  [0.0500343]
Stock Position:  0.050034299077330674
Bond Position:  [-16.20398165]


portfolio before change:  [-11.2052529]
curr_Stock_Price:  99.9262828623508
curr_Factors:  [99.92628286]
mat_Sqrt:  [[0.15]]
grads:  [-0.03255958]
Stock Position:  -0.03255957858347138
Bond Position:  [-7.95169525]


portfolio before change:  [-11.22663836]
curr_Stock_Price:  100.56782874046182
curr_Factors:  [100.56782874]
mat_Sqrt:  [[0.15]]
grads:  [-0.012086]
Stock Position:  -0.012086001873359212
Bond Position:  [-10.0111754]


portfolio before change:  [-11.2336852]
curr_Stock_Price:  101.09911426066469
curr_Factors:  [101.09911426]
mat_Sqrt:  [[0.15]]
grads:  [0.02750988]
Stock Position:  0.027509880037988647
Bond Position:  [-14.01490971]


portfolio before change:  [-11.22794096]
curr_Stock_Price:  101.33976243359862
curr_Factors:  [101.33976243]
mat_Sqrt:  [[0.15]]
grads:  [0.01507928]
Stock Position:  0.015079284140870158
Bond Position:  [-12.75607203]


portfolio before change:  [-11.23273192]
curr_Stock_Price:  101.07491664939843
curr_Factors:  [101.07491665]
mat_Sqrt:  [[0.15]]
grads:  [-0.0678104]
Stock Position:  -0.06781039552204131
Bond Position:  [-4.37880185]


portfolio before change:  [-11.21204004]
curr_Stock_Price:  100.76573749253818
curr_Factors:  [100.76573749]
mat_Sqrt:  [[0.15]]
grads:  [0.09780538]
Stock Position:  0.09780537501825934
Bond Position:  [-21.06747079]


portfolio before change:  [-11.1507723]
curr_Stock_Price:  101.4056256599899
curr_Factors:  [101.40562566]
mat_Sqrt:  [[0.15]]
grads:  [0.1481221]
Stock Position:  0.1481221026904861
Bond Position:  [-26.1711868]


portfolio before change:  [-11.25436329]
curr_Stock_Price:  100.71730678914655
curr_Factors:  [100.71730679]
mat_Sqrt:  [[0.15]]
grads:  [0.14267489]
Stock Position:  0.1426748866820939
Bond Position:  [-25.62419362]


portfolio before change:  [-11.27474861]
curr_Stock_Price:  100.58565254085602
curr_Factors:  [100.58565254]
mat_Sqrt:  [[0.15]]
grads:  [0.01683716]
Stock Position:  0.016837155744107022
Bond Position:  [-12.9683249]


portfolio before change:  [-11.28531516]
curr_Stock_Price:  100.00621911994239
curr_Factors:  [100.00621912]
mat_Sqrt:  [[0.15]]
grads:  [0.46215692]
Stock Position:  0.46215691730078723
Bond Position:  [-57.5038811]


portfolio before change:  [-11.02911133]
curr_Stock_Price:  100.56836138327742
curr_Factors:  [100.56836138]
mat_Sqrt:  [[0.15]]
grads:  [-0.0881657]
Stock Position:  -0.08816570157152089
Bond Position:  [-2.16243119]


portfolio before change:  [-11.05705045]
curr_Stock_Price:  100.88372173491652
curr_Factors:  [100.88372173]
mat_Sqrt:  [[0.15]]
grads:  [0.02039703]
Stock Position:  0.02039703099835731
Bond Position:  [-13.11477885]


portfolio before change:  [-11.06675237]
curr_Stock_Price:  100.44825583625739
curr_Factors:  [100.44825584]
mat_Sqrt:  [[0.15]]
grads:  [0.05353296]
Stock Position:  0.053532959858613546
Bond Position:  [-16.44404481]


portfolio before change:  [-11.09319554]
curr_Stock_Price:  99.97349430396257
curr_Factors:  [99.9734943]
mat_Sqrt:  [[0.15]]
grads:  [0.08569052]
Stock Position:  0.08569052049659874
Bond Position:  [-19.6599763]


portfolio before change:  [-11.07283183]
curr_Stock_Price:  100.22547665178531
curr_Factors:  [100.22547665]
mat_Sqrt:  [[0.15]]
grads:  [-0.05219184]
Stock Position:  -0.052191839953946995
Bond Position:  [-5.84187979]


portfolio before change:  [-11.10676757]
curr_Stock_Price:  100.86869245498717
curr_Factors:  [100.86869245]
mat_Sqrt:  [[0.15]]
grads:  [0.08459998]
Stock Position:  0.08459998202805515
Bond Position:  [-19.64025714]


portfolio before change:  [-11.17500222]
curr_Stock_Price:  100.07664624661021
curr_Factors:  [100.07664625]
mat_Sqrt:  [[0.15]]
grads:  [0.0004957]
Stock Position:  0.0004956987782308668
Bond Position:  [-11.22461009]


portfolio before change:  [-11.17526358]
curr_Stock_Price:  100.96469941446212
curr_Factors:  [100.96469941]
mat_Sqrt:  [[0.15]]
grads:  [0.02565182]
Stock Position:  0.025651824711773005
Bond Position:  [-13.76519235]


portfolio before change:  [-11.17560007]
curr_Stock_Price:  100.98512123648581
curr_Factors:  [100.98512124]
mat_Sqrt:  [[0.15]]
grads:  [-0.1855238]
Stock Position:  -0.1855238036467987
Bond Position:  [7.55954373]


portfolio before change:  [-11.12066892]
curr_Stock_Price:  100.69158118737933
curr_Factors:  [100.69158119]
mat_Sqrt:  [[0.15]]
grads:  [-0.03293045]
Stock Position:  -0.03293044849001642
Bond Position:  [-7.80484999]


portfolio before change:  [-11.1063513]
curr_Stock_Price:  100.24198396158368
curr_Factors:  [100.24198396]
mat_Sqrt:  [[0.15]]
grads:  [0.04358299]
Stock Position:  0.043582991088053705
Bond Position:  [-15.47519679]


portfolio before change:  [-11.14119429]
curr_Stock_Price:  99.46471362255716
curr_Factors:  [99.46471362]
mat_Sqrt:  [[0.15]]
grads:  [0.10530938]
Stock Position:  0.10530938298563614
Bond Position:  [-21.61576191]


portfolio before change:  [-11.17384318]
curr_Stock_Price:  99.16751451480809
curr_Factors:  [99.16751451]
mat_Sqrt:  [[0.15]]
grads:  [0.13180267]
Stock Position:  0.1318026702953839
Bond Position:  [-24.2443864]


portfolio before change:  [-11.16457383]
curr_Stock_Price:  99.24933889989065
curr_Factors:  [99.2493389]
mat_Sqrt:  [[0.15]]
grads:  [-0.05958829]
Stock Position:  -0.05958828902756362
Bond Position:  [-5.25047553]


portfolio before change:  [-11.1903402]
curr_Stock_Price:  99.6762383204171
curr_Factors:  [99.67623832]
mat_Sqrt:  [[0.15]]
grads:  [0.01644033]
Stock Position:  0.016440332456166492
Bond Position:  [-12.82905069]


portfolio before change:  [-11.19829633]
curr_Stock_Price:  99.24107112704583
curr_Factors:  [99.24107113]
mat_Sqrt:  [[0.15]]
grads:  [-0.01478168]
Stock Position:  -0.014781676883935155
Bond Position:  [-9.73134688]


portfolio before change:  [-11.19005531]
curr_Stock_Price:  98.64240746989657
curr_Factors:  [98.64240747]
mat_Sqrt:  [[0.15]]
grads:  [0.06735746]
Stock Position:  0.06735745792248692
Bond Position:  [-17.83435712]


portfolio before change:  [-11.19778817]
curr_Stock_Price:  98.54415285657481
curr_Factors:  [98.54415286]
mat_Sqrt:  [[0.15]]
grads:  [0.01844557]
Stock Position:  0.018445568434449368
Bond Position:  [-13.01549108]


portfolio before change:  [-11.20218124]
curr_Stock_Price:  98.35009137655832
curr_Factors:  [98.35009138]
mat_Sqrt:  [[0.15]]
grads:  [-0.09688461]
Stock Position:  -0.0968846083629936
Bond Position:  [-1.67357115]


portfolio before change:  [-11.14487005]
curr_Stock_Price:  97.75747100448731
curr_Factors:  [97.757471]
mat_Sqrt:  [[0.15]]
grads:  [0.21782029]
Stock Position:  0.2178202872394786
Bond Position:  [-32.43843046]


portfolio before change:  [-11.24672747]
curr_Stock_Price:  97.2991575971475
curr_Factors:  [97.2991576]
mat_Sqrt:  [[0.15]]
grads:  [-0.00080564]
Stock Position:  -0.0008056416961101908
Bond Position:  [-11.16833921]


portfolio before change:  [-11.24701378]
curr_Stock_Price:  96.78809254010089
curr_Factors:  [96.78809254]
mat_Sqrt:  [[0.15]]
grads:  [0.04252125]
Stock Position:  0.042521254612699975
Bond Position:  [-15.3625649]


portfolio before change:  [-11.26980268]
curr_Stock_Price:  96.27473244820234
curr_Factors:  [96.27473245]
mat_Sqrt:  [[0.15]]
grads:  [-0.06186187]
Stock Position:  -0.06186186548454755
Bond Position:  [-5.31406813]


portfolio before change:  [-11.28731361]
curr_Stock_Price:  96.55242834526904
curr_Factors:  [96.55242835]
mat_Sqrt:  [[0.15]]
grads:  [-0.00451962]
Stock Position:  -0.004519619750263064
Bond Position:  [-10.85093335]


portfolio before change:  [-11.28790566]
curr_Stock_Price:  96.53336596365413
curr_Factors:  [96.53336596]
mat_Sqrt:  [[0.15]]
grads:  [-0.06445303]
Stock Position:  -0.0644530297144365
Bond Position:  [-5.06603775]


portfolio before change:  [-11.27541837]
curr_Stock_Price:  96.33471081624332
curr_Factors:  [96.33471082]
mat_Sqrt:  [[0.15]]
grads:  [-0.08908765]
Stock Position:  -0.08908764858357612
Bond Position:  [-2.69318551]


portfolio before change:  [-11.24598032]
curr_Stock_Price:  96.00238213128284
curr_Factors:  [96.00238213]
mat_Sqrt:  [[0.15]]
grads:  [0.00398005]
Stock Position:  0.003980054330307322
Bond Position:  [-11.62807501]


portfolio before change:  [-11.24787091]
curr_Stock_Price:  95.70996955012895
curr_Factors:  [95.70996955]
mat_Sqrt:  [[0.15]]
grads:  [-0.01764138]
Stock Position:  -0.01764137606828376
Bond Position:  [-9.55941535]


portfolio before change:  [-11.24894752]
curr_Stock_Price:  95.73712869212062
curr_Factors:  [95.73712869]
mat_Sqrt:  [[0.15]]
grads:  [-0.03816728]
Stock Position:  -0.038167282928025265
Bond Position:  [-7.59492144]


portfolio before change:  [-11.23092777]
curr_Stock_Price:  95.25256583341145
curr_Factors:  [95.25256583]
mat_Sqrt:  [[0.15]]
grads:  [-0.027716]
Stock Position:  -0.027715996017738734
Bond Position:  [-8.59090803]


portfolio before change:  [-11.25945755]
curr_Stock_Price:  96.26255401544746
curr_Factors:  [96.26255402]
mat_Sqrt:  [[0.15]]
grads:  [0.01934393]
Stock Position:  0.019343927842138096
Bond Position:  [-13.12155344]


portfolio before change:  [-11.27010874]
curr_Stock_Price:  95.75432875729429
curr_Factors:  [95.75432876]
mat_Sqrt:  [[0.15]]
grads:  [0.02459923]
Stock Position:  0.024599229938577168
Bond Position:  [-13.62559149]


portfolio before change:  [-11.26522624]
curr_Stock_Price:  95.98743077515574
curr_Factors:  [95.98743078]
mat_Sqrt:  [[0.15]]
grads:  [-0.00290324]
Stock Position:  -0.0029032376189338438
Bond Position:  [-10.98655192]


portfolio before change:  [-11.26903016]
curr_Stock_Price:  97.0611437180578
curr_Factors:  [97.06114372]
mat_Sqrt:  [[0.15]]
grads:  [0.03219895]
Stock Position:  0.03219894619355964
Bond Position:  [-14.39429671]


portfolio before change:  [-11.28961221]
curr_Stock_Price:  96.44986970207314
curr_Factors:  [96.4498697]
mat_Sqrt:  [[0.15]]
grads:  [0.0589548]
Stock Position:  0.058954798643459885
Bond Position:  [-16.97579486]


portfolio before change:  [-11.27687776]
curr_Stock_Price:  96.68387051220358
curr_Factors:  [96.68387051]
mat_Sqrt:  [[0.15]]
grads:  [0.07505757]
Stock Position:  0.07505757157685272
Bond Position:  [-18.53373429]


portfolio before change:  [-11.27701009]
curr_Stock_Price:  96.69754094967678
curr_Factors:  [96.69754095]
mat_Sqrt:  [[0.15]]
grads:  [0.02953747]
Stock Position:  0.029537472941048595
Bond Position:  [-14.13321109]


portfolio before change:  [-11.2755943]
curr_Stock_Price:  96.77537905357124
curr_Factors:  [96.77537905]
mat_Sqrt:  [[0.15]]
grads:  [0.09002678]
Stock Position:  0.0900267750261819
Bond Position:  [-19.98796958]


portfolio before change:  [-11.29417489]
curr_Stock_Price:  96.5828662792445
curr_Factors:  [96.58286628]
mat_Sqrt:  [[0.15]]
grads:  [-0.013664]
Stock Position:  -0.013663995329765833
Bond Position:  [-9.97446706]


portfolio before change:  [-11.29961325]
curr_Stock_Price:  96.93524760038295
curr_Factors:  [96.9352476]
mat_Sqrt:  [[0.15]]
grads:  [0.00456159]
Stock Position:  0.004561594098453341
Bond Position:  [-11.74179251]


portfolio before change:  [-11.29503475]
curr_Stock_Price:  98.09983788601365
curr_Factors:  [98.09983789]
mat_Sqrt:  [[0.15]]
grads:  [-0.10141704]
Stock Position:  -0.10141704416090241
Bond Position:  [-1.34603916]


portfolio before change:  [-11.29665918]
curr_Stock_Price:  98.11502571875262
curr_Factors:  [98.11502572]
mat_Sqrt:  [[0.15]]
grads:  [-0.08432873]
Stock Position:  -0.08432872970621522
Bond Position:  [-3.0227437]


portfolio before change:  [-11.27116305]
curr_Stock_Price:  97.81044316713253
curr_Factors:  [97.81044317]
mat_Sqrt:  [[0.15]]
grads:  [-0.00694692]
Stock Position:  -0.006946919965304032
Bond Position:  [-10.59168173]


portfolio before change:  [-11.27406729]
curr_Stock_Price:  98.13321021358976
curr_Factors:  [98.13321021]
mat_Sqrt:  [[0.15]]
grads:  [-0.07326341]
Stock Position:  -0.07326340512986708
Bond Position:  [-4.08449415]


portfolio before change:  [-11.27786323]
curr_Stock_Price:  98.18153792840366
curr_Factors:  [98.18153793]
mat_Sqrt:  [[0.15]]
grads:  [-0.06811928]
Stock Position:  -0.06811928166239004
Bond Position:  [-4.58980739]


portfolio before change:  [-11.2814508]
curr_Stock_Price:  98.22999258023613
curr_Factors:  [98.22999258]
mat_Sqrt:  [[0.15]]
grads:  [0.06838959]
Stock Position:  0.06838959428382546
Bond Position:  [-17.99936014]


portfolio before change:  [-11.31701196]
curr_Stock_Price:  97.7264632802835
curr_Factors:  [97.72646328]
mat_Sqrt:  [[0.15]]
grads:  [0.01541743]
Stock Position:  0.015417432785929679
Bond Position:  [-12.82370314]


portfolio before change:  [-11.32388731]
curr_Stock_Price:  97.33250400966895
curr_Factors:  [97.33250401]
mat_Sqrt:  [[0.15]]
grads:  [0.07363191]
Stock Position:  0.07363191295212981
Bond Position:  [-18.49066577]


portfolio before change:  [-11.35104004]
curr_Stock_Price:  96.97943657800154
curr_Factors:  [96.97943658]
mat_Sqrt:  [[0.15]]
grads:  [-0.1196794]
Stock Position:  -0.11967940495353611
Bond Position:  [0.25540122]


portfolio before change:  [-11.39579327]
curr_Stock_Price:  97.35351258780595
curr_Factors:  [97.35351259]
mat_Sqrt:  [[0.15]]
grads:  [0.0311709]
Stock Position:  0.0311709049259431
Bond Position:  [-14.43039036]


portfolio before change:  [-11.41693953]
curr_Stock_Price:  96.70405003745633
curr_Factors:  [96.70405004]
mat_Sqrt:  [[0.15]]
grads:  [0.00393111]
Stock Position:  0.003931108821230795
Bond Position:  [-11.79709368]


portfolio before change:  [-11.41542007]
curr_Stock_Price:  97.27813798180185
curr_Factors:  [97.27813798]
mat_Sqrt:  [[0.15]]
grads:  [-0.00403211]
Stock Position:  -0.0040321144962301905
Bond Position:  [-11.02318348]


portfolio before change:  [-11.41596927]
curr_Stock_Price:  97.2434734775918
curr_Factors:  [97.24347348]
mat_Sqrt:  [[0.15]]
grads:  [0.0542332]
Stock Position:  0.05423319837425822
Bond Position:  [-16.68979386]


portfolio before change:  [-11.43293402]
curr_Stock_Price:  96.94989668922554
curr_Factors:  [96.94989669]
mat_Sqrt:  [[0.15]]
grads:  [-0.00678821]
Stock Position:  -0.006788212062993962
Bond Position:  [-10.77481757]


portfolio before change:  [-11.43550665]
curr_Stock_Price:  97.22967249055263
curr_Factors:  [97.22967249]
mat_Sqrt:  [[0.15]]
grads:  [0.01700578]
Stock Position:  0.01700577736651845
Bond Position:  [-13.08897281]


portfolio before change:  [-11.45147256]
curr_Stock_Price:  96.33892642548265
curr_Factors:  [96.33892643]
mat_Sqrt:  [[0.15]]
grads:  [0.0460837]
Stock Position:  0.046083697593763295
Bond Position:  [-15.89112652]


portfolio before change:  [-11.47284422]
curr_Stock_Price:  95.89672177726887
curr_Factors:  [95.89672178]
mat_Sqrt:  [[0.15]]
grads:  [-0.08158768]
Stock Position:  -0.08158768325856848
Bond Position:  [-3.64885285]


portfolio before change:  [-11.47083994]
curr_Stock_Price:  95.8693605583016
curr_Factors:  [95.86936056]
mat_Sqrt:  [[0.15]]
grads:  [-0.2867853]
Stock Position:  -0.2867853004681394
Bond Position:  [16.02308344]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.47083994]
Stock Price:  96.26198830898645
PL:  [-11.47083994]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.94676684e-02]
 [-1.63284048e-03]
 [-8.96332770e-04]
 [-1.30008689e-03]
 [-1.27693937e-02]
 [ 1.21519142e-02]
 [ 1.13928479e-03]
 [ 1.02897340e-02]
 [-3.54562598e-03]
 [-2.04083424e-02]
 [ 1.02677618e-02]
 [-5.52012076e-03]
 [ 6.26873038e-03]
 [ 4.05503175e-03]
 [ 6.33485317e-03]
 [-5.21108711e-03]
 [ 6.69762583e-03]
 [ 8.92168474e-03]
 [ 2.00799181e-02]
 [ 1.42820929e-02]
 [-2.14150538e-02]
 [-2.78963745e-02]
 [-5.08643801e-04]
 [ 4.80178149e-03]
 [-2.96948536e-03]
 [ 1.69981393e-02]
 [ 1.70072603e-02]
 [ 1.60142191e-02]
 [ 7.29891044e-04]
 [ 1.28894672e-04]
 [-3.42405223e-03]
 [-2.34180945e-02]
 [ 1.92985977e-02]
 [ 1.03052953e-02]
 [-2.55474574e-02]
 [ 8.03307445e-03]
 [-2.61244902e-03]
 [-2.77534918e-03]
 [ 5.95211888e-03]
 [-1.66871723e-02]
 [ 4.82003324e-02]
 [ 1.32914221e-03]
 [ 7.62321054e-03]
 [-9.06406104e-03]
 [-5.81484041e-04]
 [-8.62132548e-03]
 [-1.33235428e-02]
 [-6.03136162e-04]
 [-2.70375795e-03]
 [-6.51219321e-03]
 [-4.05455886e-03]
 [ 2.84954132e-03]
 [ 3.55497548e-03]
 [ 1.62467958e-03]
 [ 1.98700355e-03]
 [ 9.01247847e-03]
 [ 1.41726419e-02]
 [-1.02506763e-02]
 [ 1.38500197e-02]
 [ 1.96441893e-03]
 [ 3.78175287e-03]
 [-1.56552970e-02]
 [-1.26049964e-02]
 [-1.10767430e-03]
 [-1.15517119e-02]
 [-5.65291842e-03]
 [ 1.34322646e-02]
 [ 2.00226680e-03]
 [ 8.67535558e-03]
 [-1.58712621e-02]
 [-2.92664617e-03]
 [ 2.06618872e-03]
 [ 5.38303622e-04]
 [ 8.46939365e-03]
 [ 6.16553073e-03]
 [-4.18965161e-03]
 [-6.27233560e-03]
 [-1.05560195e-02]
 [-1.00256996e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.50480215]
curr_Stock_Price:  100.15671466570073
curr_Factors:  [100.15671467]
mat_Sqrt:  [[0.15]]
grads:  [-0.26311779]
Stock Position:  -0.26311778952143067
Bond Position:  [30.85781551]


portfolio before change:  [4.57383525]
curr_Stock_Price:  99.90167894453526
curr_Factors:  [99.90167894]
mat_Sqrt:  [[0.15]]
grads:  [-0.0108856]
Stock Position:  -0.010885603231225293
Bond Position:  [5.66132529]


portfolio before change:  [4.58674491]
curr_Stock_Price:  98.74824618502245
curr_Factors:  [98.74824619]
mat_Sqrt:  [[0.15]]
grads:  [-0.00597555]
Stock Position:  -0.005975551800322278
Bond Position:  [5.17682017]


portfolio before change:  [4.58785221]
curr_Stock_Price:  98.61708919631059
curr_Factors:  [98.6170892]
mat_Sqrt:  [[0.15]]
grads:  [-0.00866725]
Stock Position:  -0.008667245910578733
Bond Position:  [5.44259077]


portfolio before change:  [4.58587193]
curr_Stock_Price:  98.8848156531495
curr_Factors:  [98.88481565]
mat_Sqrt:  [[0.15]]
grads:  [-0.08512929]
Stock Position:  -0.08512929116012158
Bond Position:  [13.00386619]


portfolio before change:  [4.50319668]
curr_Stock_Price:  99.86553586351333
curr_Factors:  [99.86553586]
mat_Sqrt:  [[0.15]]
grads:  [0.08101276]
Stock Position:  0.08101276112362692
Bond Position:  [-3.58718612]


portfolio before change:  [4.49022507]
curr_Stock_Price:  99.70818531113636
curr_Factors:  [99.70818531]
mat_Sqrt:  [[0.15]]
grads:  [0.00759523]
Stock Position:  0.007595231921725704
Bond Position:  [3.73291828]


portfolio before change:  [4.49396861]
curr_Stock_Price:  100.17034681837784
curr_Factors:  [100.17034682]
mat_Sqrt:  [[0.15]]
grads:  [0.06859823]
Stock Position:  0.06859822699551286
Bond Position:  [-2.37753958]


portfolio before change:  [4.55301091]
curr_Stock_Price:  101.03321021374181
curr_Factors:  [101.03321021]
mat_Sqrt:  [[0.15]]
grads:  [-0.02363751]
Stock Position:  -0.02363750655314656
Bond Position:  [6.94118408]


portfolio before change:  [4.56085455]
curr_Stock_Price:  100.71973368136086
curr_Factors:  [100.71973368]
mat_Sqrt:  [[0.15]]
grads:  [-0.13605562]
Stock Position:  -0.13605561621503623
Bond Position:  [18.26433998]


portfolio before change:  [4.56484752]
curr_Stock_Price:  100.69877594499668
curr_Factors:  [100.69877594]
mat_Sqrt:  [[0.15]]
grads:  [0.06845175]
Stock Position:  0.06845174525571047
Bond Position:  [-2.32815944]


portfolio before change:  [4.54191185]
curr_Stock_Price:  100.36583840074803
curr_Factors:  [100.3658384]
mat_Sqrt:  [[0.15]]
grads:  [-0.03680081]
Stock Position:  -0.03680080508465018
Bond Position:  [8.23545551]


portfolio before change:  [4.5214309]
curr_Stock_Price:  100.93636086418128
curr_Factors:  [100.93636086]
mat_Sqrt:  [[0.15]]
grads:  [0.04179154]
Stock Position:  0.04179153587171779
Bond Position:  [0.30314535]


portfolio before change:  [4.53766287]
curr_Stock_Price:  101.32431076450251
curr_Factors:  [101.32431076]
mat_Sqrt:  [[0.15]]
grads:  [0.02703355]
Stock Position:  0.02703354501456761
Bond Position:  [1.79850755]


portfolio before change:  [4.50933507]
curr_Stock_Price:  100.27227671346556
curr_Factors:  [100.27227671]
mat_Sqrt:  [[0.15]]
grads:  [0.04223235]
Stock Position:  0.042232354451498075
Bond Position:  [0.27460074]


portfolio before change:  [4.51407232]
curr_Stock_Price:  100.38404154054082
curr_Factors:  [100.38404154]
mat_Sqrt:  [[0.15]]
grads:  [-0.03474058]
Stock Position:  -0.03474058071263644
Bond Position:  [8.00147222]


portfolio before change:  [4.53196732]
curr_Stock_Price:  99.88333357307553
curr_Factors:  [99.88333357]
mat_Sqrt:  [[0.15]]
grads:  [0.04465084]
Stock Position:  0.044650838839414994
Bond Position:  [0.07209269]


portfolio before change:  [4.5268668]
curr_Stock_Price:  99.7690014856872
curr_Factors:  [99.76900149]
mat_Sqrt:  [[0.15]]
grads:  [0.0594779]
Stock Position:  0.05947789824790111
Bond Position:  [-1.40718372]


portfolio before change:  [4.48936531]
curr_Stock_Price:  99.13996891743878
curr_Factors:  [99.13996892]
mat_Sqrt:  [[0.15]]
grads:  [0.13386612]
Stock Position:  0.13386612034516457
Bond Position:  [-8.7821177]


portfolio before change:  [4.29540145]
curr_Stock_Price:  97.69513010891582
curr_Factors:  [97.69513011]
mat_Sqrt:  [[0.15]]
grads:  [0.09521395]
Stock Position:  0.09521395292642333
Bond Position:  [-5.00653807]


portfolio before change:  [4.26687615]
curr_Stock_Price:  97.39882501479146
curr_Factors:  [97.39882501]
mat_Sqrt:  [[0.15]]
grads:  [-0.14276703]
Stock Position:  -0.14276702540533084
Bond Position:  [18.17221667]


portfolio before change:  [4.35061013]
curr_Stock_Price:  96.82027279778937
curr_Factors:  [96.8202728]
mat_Sqrt:  [[0.15]]
grads:  [-0.18597583]
Stock Position:  -0.1859758301082011
Bond Position:  [22.35684073]


portfolio before change:  [4.15089416]
curr_Stock_Price:  97.90166771076753
curr_Factors:  [97.90166771]
mat_Sqrt:  [[0.15]]
grads:  [-0.00339096]
Stock Position:  -0.0033909586710580662
Bond Position:  [4.48287466]


portfolio before change:  [4.15324464]
curr_Stock_Price:  97.29113254486539
curr_Factors:  [97.29113254]
mat_Sqrt:  [[0.15]]
grads:  [0.03201188]
Stock Position:  0.032011876626010224
Bond Position:  [1.03877291]


portfolio before change:  [4.14751525]
curr_Stock_Price:  97.11012715315623
curr_Factors:  [97.11012715]
mat_Sqrt:  [[0.15]]
grads:  [-0.01979657]
Stock Position:  -0.019796569081448237
Bond Position:  [6.06996259]


portfolio before change:  [4.1542353]
curr_Stock_Price:  96.78983570756863
curr_Factors:  [96.78983571]
mat_Sqrt:  [[0.15]]
grads:  [0.11332093]
Stock Position:  0.1133209285029587
Bond Position:  [-6.81407875]


portfolio before change:  [4.1438428]
curr_Stock_Price:  96.70188539474432
curr_Factors:  [96.70188539]
mat_Sqrt:  [[0.15]]
grads:  [0.11338174]
Stock Position:  0.11338173534920888
Bond Position:  [-6.82038478]


portfolio before change:  [4.13870889]
curr_Stock_Price:  96.66036527835891
curr_Factors:  [96.66036528]
mat_Sqrt:  [[0.15]]
grads:  [0.10676146]
Stock Position:  0.10676146072428892
Bond Position:  [-6.1808929]


portfolio before change:  [4.17650215]
curr_Stock_Price:  97.01798102401189
curr_Factors:  [97.01798102]
mat_Sqrt:  [[0.15]]
grads:  [0.00486594]
Stock Position:  0.004865940294154491
Bond Position:  [3.70441845]


portfolio before change:  [4.17724843]
curr_Stock_Price:  97.12376686488844
curr_Factors:  [97.12376686]
mat_Sqrt:  [[0.15]]
grads:  [0.0008593]
Stock Position:  0.000859297815990837
Bond Position:  [4.09379019]


portfolio before change:  [4.17705267]
curr_Stock_Price:  96.59818523513324
curr_Factors:  [96.59818524]
mat_Sqrt:  [[0.15]]
grads:  [-0.02282701]
Stock Position:  -0.02282701483681758
Bond Position:  [6.38210088]


portfolio before change:  [4.1673099]
curr_Stock_Price:  97.04246875115466
curr_Factors:  [97.04246875]
mat_Sqrt:  [[0.15]]
grads:  [-0.15612063]
Stock Position:  -0.15612062973136775
Bond Position:  [19.31764123]


portfolio before change:  [4.11636632]
curr_Stock_Price:  97.37651149970257
curr_Factors:  [97.3765115]
mat_Sqrt:  [[0.15]]
grads:  [0.12865732]
Stock Position:  0.12865731806877992
Bond Position:  [-8.41183449]


portfolio before change:  [4.04074046]
curr_Stock_Price:  96.79278948457832
curr_Factors:  [96.79278948]
mat_Sqrt:  [[0.15]]
grads:  [0.06870197]
Stock Position:  0.0687019688187379
Bond Position:  [-2.60911475]


portfolio before change:  [4.05000642]
curr_Stock_Price:  96.9300350081691
curr_Factors:  [96.93003501]
mat_Sqrt:  [[0.15]]
grads:  [-0.17031638]
Stock Position:  -0.17031638233634258
Bond Position:  [20.55877932]


portfolio before change:  [4.07846708]
curr_Stock_Price:  96.77047490910542
curr_Factors:  [96.77047491]
mat_Sqrt:  [[0.15]]
grads:  [0.05355383]
Stock Position:  0.05355382965649385
Bond Position:  [-1.10396245]


portfolio before change:  [4.08903084]
curr_Stock_Price:  96.96901830762836
curr_Factors:  [96.96901831]
mat_Sqrt:  [[0.15]]
grads:  [-0.01741633]
Stock Position:  -0.01741632678192408
Bond Position:  [5.77787495]


portfolio before change:  [4.09611913]
curr_Stock_Price:  96.5827622334486
curr_Factors:  [96.58276223]
mat_Sqrt:  [[0.15]]
grads:  [-0.01850233]
Stock Position:  -0.018502327875944913
Bond Position:  [5.88312507]


portfolio before change:  [4.09448247]
curr_Stock_Price:  96.69109287119365
curr_Factors:  [96.69109287]
mat_Sqrt:  [[0.15]]
grads:  [0.03968079]
Stock Position:  0.03968079254709582
Bond Position:  [0.25770327]


portfolio before change:  [4.10015266]
curr_Stock_Price:  96.83358194721193
curr_Factors:  [96.83358195]
mat_Sqrt:  [[0.15]]
grads:  [-0.11124782]
Stock Position:  -0.11124781554619323
Bond Position:  [14.87267712]


portfolio before change:  [4.22191711]
curr_Stock_Price:  95.74740438524063
curr_Factors:  [95.74740439]
mat_Sqrt:  [[0.15]]
grads:  [0.32133555]
Stock Position:  0.3213355494931985
Bond Position:  [-26.54512769]


portfolio before change:  [4.36862361]
curr_Stock_Price:  96.20911993810678
curr_Factors:  [96.20911994]
mat_Sqrt:  [[0.15]]
grads:  [0.00886095]
Stock Position:  0.008860948086475993
Bond Position:  [3.51611959]


portfolio before change:  [4.36824053]
curr_Stock_Price:  96.14108569577128
curr_Factors:  [96.1410857]
mat_Sqrt:  [[0.15]]
grads:  [0.0508214]
Stock Position:  0.05082140356671021
Bond Position:  [-0.51778439]


portfolio before change:  [4.40233854]
curr_Stock_Price:  96.81266062699207
curr_Factors:  [96.81266063]
mat_Sqrt:  [[0.15]]
grads:  [-0.06042707]
Stock Position:  -0.06042707359285066
Bond Position:  [10.25244431]


portfolio before change:  [4.41522676]
curr_Stock_Price:  96.60997960676929
curr_Factors:  [96.60997961]
mat_Sqrt:  [[0.15]]
grads:  [-0.00387656]
Stock Position:  -0.0038765602741065433
Bond Position:  [4.78974117]


portfolio before change:  [4.41485037]
curr_Stock_Price:  96.78430041619107
curr_Factors:  [96.78430042]
mat_Sqrt:  [[0.15]]
grads:  [-0.0574755]
Stock Position:  -0.05747550321452519
Bond Position:  [9.97757674]


portfolio before change:  [4.45498867]
curr_Stock_Price:  96.09679551562596
curr_Factors:  [96.09679552]
mat_Sqrt:  [[0.15]]
grads:  [-0.08882362]
Stock Position:  -0.08882361891331235
Bond Position:  [12.99065382]


portfolio before change:  [4.34686083]
curr_Stock_Price:  97.32326872051078
curr_Factors:  [97.32326872]
mat_Sqrt:  [[0.15]]
grads:  [-0.00402091]
Stock Position:  -0.0040209077443877144
Bond Position:  [4.73818871]


portfolio before change:  [4.35050671]
curr_Stock_Price:  96.49018980693599
curr_Factors:  [96.49018981]
mat_Sqrt:  [[0.15]]
grads:  [-0.01802505]
Stock Position:  -0.0180250529690328
Bond Position:  [6.08974749]


portfolio before change:  [4.36772247]
curr_Stock_Price:  95.55620415818194
curr_Factors:  [95.55620416]
mat_Sqrt:  [[0.15]]
grads:  [-0.04341462]
Stock Position:  -0.043414621370305606
Bond Position:  [8.51625889]


portfolio before change:  [4.36358804]
curr_Stock_Price:  95.66369592656254
curr_Factors:  [95.66369593]
mat_Sqrt:  [[0.15]]
grads:  [-0.02703039]
Stock Position:  -0.027030392372678638
Bond Position:  [6.94941527]


portfolio before change:  [4.36309932]
curr_Stock_Price:  95.69784516294831
curr_Factors:  [95.69784516]
mat_Sqrt:  [[0.15]]
grads:  [0.01899694]
Stock Position:  0.018996942153191025
Bond Position:  [2.54513289]


portfolio before change:  [4.37565]
curr_Stock_Price:  96.35013967396242
curr_Factors:  [96.35013967]
mat_Sqrt:  [[0.15]]
grads:  [0.02369984]
Stock Position:  0.023699836510877554
Bond Position:  [2.09216744]


portfolio before change:  [4.39875532]
curr_Stock_Price:  97.3195371488685
curr_Factors:  [97.31953715]
mat_Sqrt:  [[0.15]]
grads:  [0.0108312]
Stock Position:  0.010831197216442996
Bond Position:  [3.34466822]


portfolio before change:  [4.40983518]
curr_Stock_Price:  98.32319422241824
curr_Factors:  [98.32319422]
mat_Sqrt:  [[0.15]]
grads:  [0.01324669]
Stock Position:  0.013246690312808026
Bond Position:  [3.10737828]


portfolio before change:  [4.4120266]
curr_Stock_Price:  98.47396390474508
curr_Factors:  [98.4739639]
mat_Sqrt:  [[0.15]]
grads:  [0.06008319]
Stock Position:  0.06008318983312213
Bond Position:  [-1.50460327]


portfolio before change:  [4.39348449]
curr_Stock_Price:  98.16692178936803
curr_Factors:  [98.16692179]
mat_Sqrt:  [[0.15]]
grads:  [0.09448428]
Stock Position:  0.0944842795705745
Bond Position:  [-4.8817464]


portfolio before change:  [4.3890903]
curr_Stock_Price:  98.12364399549364
curr_Factors:  [98.123644]
mat_Sqrt:  [[0.15]]
grads:  [-0.06833784]
Stock Position:  -0.06833784200655528
Bond Position:  [11.09464838]


portfolio before change:  [4.3601108]
curr_Stock_Price:  98.55785335044803
curr_Factors:  [98.55785335]
mat_Sqrt:  [[0.15]]
grads:  [0.09233346]
Stock Position:  0.0923334646243385
Bond Position:  [-4.74007726]


portfolio before change:  [4.3247196]
curr_Stock_Price:  98.17776425108319
curr_Factors:  [98.17776425]
mat_Sqrt:  [[0.15]]
grads:  [0.01309613]
Stock Position:  0.013096126170319211
Bond Position:  [3.03897121]


portfolio before change:  [4.32275849]
curr_Stock_Price:  98.01351334720388
curr_Factors:  [98.01351335]
mat_Sqrt:  [[0.15]]
grads:  [0.02521169]
Stock Position:  0.02521168582259009
Bond Position:  [1.85167258]


portfolio before change:  [4.31915037]
curr_Stock_Price:  97.8658099179405
curr_Factors:  [97.86580992]
mat_Sqrt:  [[0.15]]
grads:  [-0.10436865]
Stock Position:  -0.10436864657786038
Bond Position:  [14.53327249]


portfolio before change:  [4.23529493]
curr_Stock_Price:  98.6779675627085
curr_Factors:  [98.67796756]
mat_Sqrt:  [[0.15]]
grads:  [-0.08403331]
Stock Position:  -0.0840333095262477
Bond Position:  [12.52753112]


portfolio before change:  [4.27235579]
curr_Stock_Price:  98.24625937906401
curr_Factors:  [98.24625938]
mat_Sqrt:  [[0.15]]
grads:  [-0.0073845]
Stock Position:  -0.007384495357207733
Bond Position:  [4.99785484]


portfolio before change:  [4.27041047]
curr_Stock_Price:  98.55199463740455
curr_Factors:  [98.55199464]
mat_Sqrt:  [[0.15]]
grads:  [-0.07701141]
Stock Position:  -0.07701141298455082
Bond Position:  [11.86003883]


portfolio before change:  [4.28052761]
curr_Stock_Price:  98.43024814591953
curr_Factors:  [98.43024815]
mat_Sqrt:  [[0.15]]
grads:  [-0.03768612]
Stock Position:  -0.03768612281322462
Bond Position:  [7.98998203]


portfolio before change:  [4.24902821]
curr_Stock_Price:  99.27933498900384
curr_Factors:  [99.27933499]
mat_Sqrt:  [[0.15]]
grads:  [0.08954843]
Stock Position:  0.08954843050761943
Bond Position:  [-4.64128042]


portfolio before change:  [4.20729979]
curr_Stock_Price:  98.81658729140163
curr_Factors:  [98.81658729]
mat_Sqrt:  [[0.15]]
grads:  [0.01334845]
Stock Position:  0.013348445361723398
Bond Position:  [2.88825198]


portfolio before change:  [4.20341918]
curr_Stock_Price:  98.51234696632164
curr_Factors:  [98.51234697]
mat_Sqrt:  [[0.15]]
grads:  [0.0578357]
Stock Position:  0.05783570383688128
Bond Position:  [-1.49411174]


portfolio before change:  [4.22679423]
curr_Stock_Price:  98.9181246482656
curr_Factors:  [98.91812465]
mat_Sqrt:  [[0.15]]
grads:  [-0.10580841]
Stock Position:  -0.10580841404520293
Bond Position:  [14.69316412]


portfolio before change:  [4.26437182]
curr_Stock_Price:  98.57165662179519
curr_Factors:  [98.57165662]
mat_Sqrt:  [[0.15]]
grads:  [-0.01951097]
Stock Position:  -0.01951097445684227
Bond Position:  [6.18760089]


portfolio before change:  [4.27376513]
curr_Stock_Price:  98.1100409129341
curr_Factors:  [98.11004091]
mat_Sqrt:  [[0.15]]
grads:  [0.01377459]
Stock Position:  0.013774591496498872
Bond Position:  [2.92233939]


portfolio before change:  [4.27270703]
curr_Stock_Price:  98.01996609011911
curr_Factors:  [98.01996609]
mat_Sqrt:  [[0.15]]
grads:  [0.00358869]
Stock Position:  0.003588690814690946
Bond Position:  [3.92094368]


portfolio before change:  [4.27339367]
curr_Stock_Price:  98.14301084217205
curr_Factors:  [98.14301084]
mat_Sqrt:  [[0.15]]
grads:  [0.05646262]
Stock Position:  0.0564626243651151
Bond Position:  [-1.26801829]


portfolio before change:  [4.29132022]
curr_Stock_Price:  98.46190865676076
curr_Factors:  [98.46190866]
mat_Sqrt:  [[0.15]]
grads:  [0.04110354]
Stock Position:  0.0411035381967985
Bond Position:  [0.2441874]


portfolio before change:  [4.30994195]
curr_Stock_Price:  98.91458182758026
curr_Factors:  [98.91458183]
mat_Sqrt:  [[0.15]]
grads:  [-0.02793101]
Stock Position:  -0.027931010705662385
Bond Position:  [7.0727262]


portfolio before change:  [4.3149035]
curr_Stock_Price:  98.75277284788304
curr_Factors:  [98.75277285]
mat_Sqrt:  [[0.15]]
grads:  [-0.04181557]
Stock Position:  -0.041815570668694374
Bond Position:  [8.44430705]


portfolio before change:  [4.34772582]
curr_Stock_Price:  97.98046399889397
curr_Factors:  [97.980464]
mat_Sqrt:  [[0.15]]
grads:  [-0.07037346]
Stock Position:  -0.0703734634825858
Bond Position:  [11.24295043]


portfolio before change:  [4.33470071]
curr_Stock_Price:  98.1755349328874
curr_Factors:  [98.17553493]
mat_Sqrt:  [[0.15]]
grads:  [-0.066838]
Stock Position:  -0.06683799747241338
Bond Position:  [10.89655687]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.33470071]
Stock Price:  98.74845086662086
PL:  [4.33470071]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.12071243e-02]
 [-4.15247275e-04]
 [ 3.37456805e-04]
 [ 2.17647469e-03]
 [ 5.67322334e-03]
 [ 1.21913340e-02]
 [-6.11732141e-04]
 [ 1.66627765e-02]
 [-1.00737968e-02]
 [-1.06067250e-02]
 [ 9.95057042e-03]
 [-1.24082833e-02]
 [ 3.76042498e-02]
 [ 2.35178422e-02]
 [-1.26474002e-02]
 [-5.37108969e-03]
 [ 1.74247716e-02]
 [ 2.20215081e-02]
 [-1.21035556e-03]
 [-2.00632290e-03]
 [ 5.10628396e-02]
 [-1.28564558e-02]
 [ 7.66677439e-03]
 [-4.08848186e-03]
 [ 1.78075422e-02]
 [ 1.64836429e-02]
 [ 1.02620819e-02]
 [ 6.07135278e-03]
 [ 6.03770123e-03]
 [-1.36955367e-02]
 [-5.65469315e-03]
 [ 3.24055041e-02]
 [ 7.50867839e-03]
 [ 3.05048380e-04]
 [-5.82386315e-03]
 [-3.76368155e-03]
 [-5.83022702e-03]
 [ 2.56204470e-03]
 [ 3.06440559e-03]
 [-8.51109762e-03]
 [-3.19505925e-02]
 [-2.58609223e-03]
 [ 1.19704662e-02]
 [-1.23340810e-02]
 [-9.51538767e-04]
 [ 2.34270364e-03]
 [-1.36098539e-02]
 [ 1.28421531e-02]
 [ 1.80202999e-02]
 [-1.14412582e-02]
 [-3.90455195e-03]
 [ 3.45468563e-03]
 [ 2.84666655e-03]
 [-5.84557847e-04]
 [-7.06094590e-03]
 [ 1.15366502e-02]
 [-2.89684194e-02]
 [-9.09276179e-03]
 [ 1.86342670e-02]
 [-3.77026045e-03]
 [ 1.30838033e-02]
 [-1.43037477e-02]
 [-1.27466068e-02]
 [-3.08091939e-03]
 [ 8.02087064e-02]
 [-1.47116917e-02]
 [ 6.18923886e-03]
 [ 6.15967068e-03]
 [ 1.47716319e-02]
 [-2.84373733e-02]
 [-7.85139042e-03]
 [-5.22550232e-03]
 [ 1.47820322e-02]
 [ 4.70643035e-03]
 [-1.34716562e-03]
 [ 7.93429046e-04]
 [ 7.14193021e-03]
 [-3.62975905e-03]
 [ 2.32719578e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.19426426]
curr_Stock_Price:  99.14772531247426
curr_Factors:  [99.14772531]
mat_Sqrt:  [[0.15]]
grads:  [-0.2080475]
Stock Position:  -0.20804749558992222
Bond Position:  [9.43317168]


portfolio before change:  [-11.32264351]
curr_Stock_Price:  99.76762625893075
curr_Factors:  [99.76762626]
mat_Sqrt:  [[0.15]]
grads:  [-0.00276832]
Stock Position:  -0.0027683151688691473
Bond Position:  [-11.04645528]


portfolio before change:  [-11.32547277]
curr_Stock_Price:  100.54023986739878
curr_Factors:  [100.54023987]
mat_Sqrt:  [[0.15]]
grads:  [0.00224971]
Stock Position:  0.0022497120348237277
Bond Position:  [-11.55165936]


portfolio before change:  [-11.32725316]
curr_Stock_Price:  100.06978733494809
curr_Factors:  [100.06978733]
mat_Sqrt:  [[0.15]]
grads:  [0.01450983]
Stock Position:  0.014509831240875855
Bond Position:  [-12.77924888]


portfolio before change:  [-11.31306441]
curr_Stock_Price:  101.1027059741959
curr_Factors:  [101.10270597]
mat_Sqrt:  [[0.15]]
grads:  [0.03782149]
Stock Position:  0.03782148893477643
Bond Position:  [-15.13691929]


portfolio before change:  [-11.2876474]
curr_Stock_Price:  101.79974624962988
curr_Factors:  [101.79974625]
mat_Sqrt:  [[0.15]]
grads:  [0.08127556]
Stock Position:  0.08127556011407094
Bond Position:  [-19.56147879]


portfolio before change:  [-11.26358424]
curr_Stock_Price:  102.1108581173428
curr_Factors:  [102.11085812]
mat_Sqrt:  [[0.15]]
grads:  [-0.00407821]
Stock Position:  -0.004078214275758593
Bond Position:  [-10.84715428]


portfolio before change:  [-11.26606067]
curr_Stock_Price:  102.55185193780089
curr_Factors:  [102.55185194]
mat_Sqrt:  [[0.15]]
grads:  [0.11108518]
Stock Position:  0.11108517650728442
Bond Position:  [-22.65805125]


portfolio before change:  [-11.33412028]
curr_Stock_Price:  101.95192098539158
curr_Factors:  [101.95192099]
mat_Sqrt:  [[0.15]]
grads:  [-0.06715865]
Stock Position:  -0.06715864504656936
Bond Position:  [-4.48716741]


portfolio before change:  [-11.31431004]
curr_Stock_Price:  101.65276823416158
curr_Factors:  [101.65276823]
mat_Sqrt:  [[0.15]]
grads:  [-0.0707115]
Stock Position:  -0.07071150015411157
Bond Position:  [-4.12629031]


portfolio before change:  [-11.34528238]
curr_Stock_Price:  102.0871308782401
curr_Factors:  [102.08713088]
mat_Sqrt:  [[0.15]]
grads:  [0.06633714]
Stock Position:  0.06633713610799369
Bond Position:  [-18.11745027]


portfolio before change:  [-11.29368899]
curr_Stock_Price:  102.8819461275772
curr_Factors:  [102.88194613]
mat_Sqrt:  [[0.15]]
grads:  [-0.08272189]
Stock Position:  -0.08272188862816422
Bond Position:  [-2.7831001]


portfolio before change:  [-11.3383446]
curr_Stock_Price:  103.41967152247388
curr_Factors:  [103.41967152]
mat_Sqrt:  [[0.15]]
grads:  [0.250695]
Stock Position:  0.2506949988331525
Bond Position:  [-37.26513903]


portfolio before change:  [-11.34327493]
curr_Stock_Price:  103.40929561603718
curr_Factors:  [103.40929562]
mat_Sqrt:  [[0.15]]
grads:  [0.15678561]
Stock Position:  0.15678561462066862
Bond Position:  [-27.5563649]


portfolio before change:  [-11.27277541]
curr_Stock_Price:  103.86993636099314
curr_Factors:  [103.86993636]
mat_Sqrt:  [[0.15]]
grads:  [-0.084316]
Stock Position:  -0.08431600139485662
Bond Position:  [-2.51487771]


portfolio before change:  [-11.32192065]
curr_Stock_Price:  104.45094172738528
curr_Factors:  [104.45094173]
mat_Sqrt:  [[0.15]]
grads:  [-0.03580726]
Stock Position:  -0.0358072645768094
Bond Position:  [-7.58181814]


portfolio before change:  [-11.3125693]
curr_Stock_Price:  104.17654983644266
curr_Factors:  [104.17654984]
mat_Sqrt:  [[0.15]]
grads:  [0.11616514]
Stock Position:  0.1161651438682842
Bond Position:  [-23.4142532]


portfolio before change:  [-11.36439653]
curr_Stock_Price:  103.74299646219092
curr_Factors:  [103.74299646]
mat_Sqrt:  [[0.15]]
grads:  [0.14681005]
Stock Position:  0.14681005375141454
Bond Position:  [-26.59491142]


portfolio before change:  [-11.42030078]
curr_Stock_Price:  103.37352576089219
curr_Factors:  [103.37352576]
mat_Sqrt:  [[0.15]]
grads:  [-0.00806904]
Stock Position:  -0.008069037068987664
Bond Position:  [-10.58617597]


portfolio before change:  [-11.41568499]
curr_Stock_Price:  102.7194895221115
curr_Factors:  [102.71948952]
mat_Sqrt:  [[0.15]]
grads:  [-0.01337549]
Stock Position:  -0.013375485969556861
Bond Position:  [-10.0417619]


portfolio before change:  [-11.40889009]
curr_Stock_Price:  102.16455424549157
curr_Factors:  [102.16455425]
mat_Sqrt:  [[0.15]]
grads:  [0.34041893]
Stock Position:  0.34041893062040524
Bond Position:  [-46.18763839]


portfolio before change:  [-11.46945626]
curr_Stock_Price:  101.9951178635004
curr_Factors:  [101.99511786]
mat_Sqrt:  [[0.15]]
grads:  [-0.08570971]
Stock Position:  -0.085709705149792
Bond Position:  [-2.72748478]


portfolio before change:  [-11.50929638]
curr_Stock_Price:  102.45795512865412
curr_Factors:  [102.45795513]
mat_Sqrt:  [[0.15]]
grads:  [0.05111183]
Stock Position:  0.051111829290048726
Bond Position:  [-16.74610989]


portfolio before change:  [-11.52260898]
curr_Stock_Price:  102.2179727192393
curr_Factors:  [102.21797272]
mat_Sqrt:  [[0.15]]
grads:  [-0.02725655]
Stock Position:  -0.02725654572469389
Bond Position:  [-8.73650014]


portfolio before change:  [-11.5456629]
curr_Stock_Price:  103.04375098551326
curr_Factors:  [103.04375099]
mat_Sqrt:  [[0.15]]
grads:  [0.11871695]
Stock Position:  0.11871694828197776
Bond Position:  [-23.77870255]


portfolio before change:  [-11.47088315]
curr_Stock_Price:  103.68616944023401
curr_Factors:  [103.68616944]
mat_Sqrt:  [[0.15]]
grads:  [0.10989095]
Stock Position:  0.10989095295290165
Bond Position:  [-22.86505512]


portfolio before change:  [-11.60710984]
curr_Stock_Price:  102.4595208813222
curr_Factors:  [102.45952088]
mat_Sqrt:  [[0.15]]
grads:  [0.06841388]
Stock Position:  0.0684138794954693
Bond Position:  [-18.61676316]


portfolio before change:  [-11.62862691]
curr_Stock_Price:  102.16201562564017
curr_Factors:  [102.16201563]
mat_Sqrt:  [[0.15]]
grads:  [0.04047569]
Stock Position:  0.04047568516683843
Bond Position:  [-15.7637045]


portfolio before change:  [-11.61436863]
curr_Stock_Price:  102.53862550578458
curr_Factors:  [102.53862551]
mat_Sqrt:  [[0.15]]
grads:  [0.04025134]
Stock Position:  0.04025134150901994
Bond Position:  [-15.74168587]


portfolio before change:  [-11.60618422]
curr_Stock_Price:  102.76640180547206
curr_Factors:  [102.76640181]
mat_Sqrt:  [[0.15]]
grads:  [-0.09130358]
Stock Position:  -0.09130357803761617
Bond Position:  [-2.22324403]


portfolio before change:  [-11.54899261]
curr_Stock_Price:  102.13849030128351
curr_Factors:  [102.1384903]
mat_Sqrt:  [[0.15]]
grads:  [-0.03769795]
Stock Position:  -0.03769795436384904
Bond Position:  [-7.69858046]


portfolio before change:  [-11.55176598]
curr_Stock_Price:  102.19929447195993
curr_Factors:  [102.19929447]
mat_Sqrt:  [[0.15]]
grads:  [0.21603669]
Stock Position:  0.21603669384664387
Bond Position:  [-33.63056367]


portfolio before change:  [-11.60357278]
curr_Stock_Price:  101.96921859812987
curr_Factors:  [101.9692186]
mat_Sqrt:  [[0.15]]
grads:  [0.05005786]
Stock Position:  0.05005785595785315
Bond Position:  [-16.70793324]


portfolio before change:  [-11.5935374]
curr_Stock_Price:  102.1905558349012
curr_Factors:  [102.19055583]
mat_Sqrt:  [[0.15]]
grads:  [0.00203366]
Stock Position:  0.002033655869580382
Bond Position:  [-11.80135782]


portfolio before change:  [-11.59251003]
curr_Stock_Price:  103.05843563138899
curr_Factors:  [103.05843563]
mat_Sqrt:  [[0.15]]
grads:  [-0.03882575]
Stock Position:  -0.038825754343822474
Bond Position:  [-7.59118853]


portfolio before change:  [-11.58580558]
curr_Stock_Price:  102.87353479789125
curr_Factors:  [102.8735348]
mat_Sqrt:  [[0.15]]
grads:  [-0.02509121]
Stock Position:  -0.0250912103423703
Bond Position:  [-9.00458408]


portfolio before change:  [-11.58790487]
curr_Stock_Price:  102.9347705238534
curr_Factors:  [102.93477052]
mat_Sqrt:  [[0.15]]
grads:  [-0.03886818]
Stock Position:  -0.03886818012016828
Bond Position:  [-7.58701767]


portfolio before change:  [-11.61270766]
curr_Stock_Price:  103.56069612032555
curr_Factors:  [103.56069612]
mat_Sqrt:  [[0.15]]
grads:  [0.0170803]
Stock Position:  0.017080298026180708
Bond Position:  [-13.38155521]


portfolio before change:  [-11.619236]
curr_Stock_Price:  103.2274488711841
curr_Factors:  [103.22744887]
mat_Sqrt:  [[0.15]]
grads:  [0.02042937]
Stock Position:  0.02042937061618146
Bond Position:  [-13.72810781]


portfolio before change:  [-11.636037]
curr_Stock_Price:  102.44705441094108
curr_Factors:  [102.44705441]
mat_Sqrt:  [[0.15]]
grads:  [-0.05674065]
Stock Position:  -0.05674065077961605
Bond Position:  [-5.82312446]


portfolio before change:  [-11.64760113]
curr_Stock_Price:  102.64444685401484
curr_Factors:  [102.64444685]
mat_Sqrt:  [[0.15]]
grads:  [-0.21300395]
Stock Position:  -0.21300394997764927
Bond Position:  [10.21607149]


portfolio before change:  [-11.69621648]
curr_Stock_Price:  102.87568142072207
curr_Factors:  [102.87568142]
mat_Sqrt:  [[0.15]]
grads:  [-0.01724061]
Stock Position:  -0.01724061489950076
Bond Position:  [-9.92257647]


portfolio before change:  [-11.69065717]
curr_Stock_Price:  102.51725492909401
curr_Factors:  [102.51725493]
mat_Sqrt:  [[0.15]]
grads:  [0.07980311]
Stock Position:  0.0798031077724425
Bond Position:  [-19.87185271]


portfolio before change:  [-11.63766165]
curr_Stock_Price:  103.19689702926314
curr_Factors:  [103.19689703]
mat_Sqrt:  [[0.15]]
grads:  [-0.08222721]
Stock Position:  -0.0822272068510143
Bond Position:  [-3.15206905]


portfolio before change:  [-11.6293899]
curr_Stock_Price:  103.09390492584377
curr_Factors:  [103.09390493]
mat_Sqrt:  [[0.15]]
grads:  [-0.00634359]
Stock Position:  -0.006343591778742959
Bond Position:  [-10.97540426]


portfolio before change:  [-11.6274184]
curr_Stock_Price:  102.67498044191095
curr_Factors:  [102.67498044]
mat_Sqrt:  [[0.15]]
grads:  [0.01561802]
Stock Position:  0.015618024292562005
Bond Position:  [-13.23099874]


portfolio before change:  [-11.61055244]
curr_Stock_Price:  103.8078333812804
curr_Factors:  [103.80783338]
mat_Sqrt:  [[0.15]]
grads:  [-0.09073236]
Stock Position:  -0.09073235961360811
Bond Position:  [-2.19182277]


portfolio before change:  [-11.69072778]
curr_Stock_Price:  104.68997015778409
curr_Factors:  [104.68997016]
mat_Sqrt:  [[0.15]]
grads:  [0.08561435]
Stock Position:  0.085614354195135
Bond Position:  [-20.65369197]


portfolio before change:  [-11.70440222]
curr_Stock_Price:  104.54532691704551
curr_Factors:  [104.54532692]
mat_Sqrt:  [[0.15]]
grads:  [0.12013533]
Stock Position:  0.12013533238221748
Bond Position:  [-24.26398982]


portfolio before change:  [-11.72142937]
curr_Stock_Price:  104.41621744548928
curr_Factors:  [104.41621745]
mat_Sqrt:  [[0.15]]
grads:  [-0.07627505]
Stock Position:  -0.07627505457669508
Bond Position:  [-3.75707669]


portfolio before change:  [-11.69217203]
curr_Stock_Price:  104.02956194797085
curr_Factors:  [104.02956195]
mat_Sqrt:  [[0.15]]
grads:  [-0.02603035]
Stock Position:  -0.02603034631841265
Bond Position:  [-8.9842465]


portfolio before change:  [-11.68772925]
curr_Stock_Price:  103.83731290947574
curr_Factors:  [103.83731291]
mat_Sqrt:  [[0.15]]
grads:  [0.02303124]
Stock Position:  0.023031237538524044
Bond Position:  [-14.07923107]


portfolio before change:  [-11.67501489]
curr_Stock_Price:  104.42756959983315
curr_Factors:  [104.4275696]
mat_Sqrt:  [[0.15]]
grads:  [0.01897778]
Stock Position:  0.018977776975694333
Bond Position:  [-13.65681802]


portfolio before change:  [-11.67582424]
curr_Stock_Price:  104.42990017156052
curr_Factors:  [104.42990017]
mat_Sqrt:  [[0.15]]
grads:  [-0.00389705]
Stock Position:  -0.003897052315492619
Bond Position:  [-11.26885546]


portfolio before change:  [-11.67485888]
curr_Stock_Price:  104.00145240660484
curr_Factors:  [104.00145241]
mat_Sqrt:  [[0.15]]
grads:  [-0.04707297]
Stock Position:  -0.047072972686453995
Bond Position:  [-6.77920135]


portfolio before change:  [-11.71673855]
curr_Stock_Price:  104.88212673069327
curr_Factors:  [104.88212673]
mat_Sqrt:  [[0.15]]
grads:  [0.076911]
Stock Position:  0.07691100104476843
Bond Position:  [-19.78332791]


portfolio before change:  [-11.63782674]
curr_Stock_Price:  105.92421839446992
curr_Factors:  [105.92421839]
mat_Sqrt:  [[0.15]]
grads:  [-0.1931228]
Stock Position:  -0.19312279591080314
Bond Position:  [8.81855447]


portfolio before change:  [-11.56298652]
curr_Stock_Price:  105.53954583892377
curr_Factors:  [105.53954584]
mat_Sqrt:  [[0.15]]
grads:  [-0.06061841]
Stock Position:  -0.0606184119460235
Bond Position:  [-5.16534685]


portfolio before change:  [-11.55514555]
curr_Stock_Price:  105.40487041936298
curr_Factors:  [105.40487042]
mat_Sqrt:  [[0.15]]
grads:  [0.12422845]
Stock Position:  0.12422844678300708
Bond Position:  [-24.64942889]


portfolio before change:  [-11.60670456]
curr_Stock_Price:  105.00223823354663
curr_Factors:  [105.00223823]
mat_Sqrt:  [[0.15]]
grads:  [-0.02513507]
Stock Position:  -0.02513506964658199
Bond Position:  [-8.96746599]


portfolio before change:  [-11.61811421]
curr_Stock_Price:  105.4338725271968
curr_Factors:  [105.43387253]
mat_Sqrt:  [[0.15]]
grads:  [0.08722536]
Stock Position:  0.08722535504168862
Bond Position:  [-20.81462117]


portfolio before change:  [-11.62496449]
curr_Stock_Price:  105.37025190102872
curr_Factors:  [105.3702519]
mat_Sqrt:  [[0.15]]
grads:  [-0.09535832]
Stock Position:  -0.09535831792649344
Bond Position:  [-1.57703451]


portfolio before change:  [-11.5620456]
curr_Stock_Price:  104.70940282485837
curr_Factors:  [104.70940282]
mat_Sqrt:  [[0.15]]
grads:  [-0.08497738]
Stock Position:  -0.08497737877468743
Bond Position:  [-2.66411502]


portfolio before change:  [-11.61371861]
curr_Stock_Price:  105.3155228609897
curr_Factors:  [105.31552286]
mat_Sqrt:  [[0.15]]
grads:  [-0.02053946]
Stock Position:  -0.020539462608435522
Bond Position:  [-9.45059436]


portfolio before change:  [-11.62893757]
curr_Stock_Price:  106.02772642968462
curr_Factors:  [106.02772643]
mat_Sqrt:  [[0.15]]
grads:  [0.53472471]
Stock Position:  0.5347247092768321
Bond Position:  [-68.32458276]


portfolio before change:  [-11.50279672]
curr_Stock_Price:  106.27161129516035
curr_Factors:  [106.2716113]
mat_Sqrt:  [[0.15]]
grads:  [-0.09807794]
Stock Position:  -0.09807794459659813
Bond Position:  [-1.07989552]


portfolio before change:  [-11.54847891]
curr_Stock_Price:  106.73669740927504
curr_Factors:  [106.73669741]
mat_Sqrt:  [[0.15]]
grads:  [0.04126159]
Stock Position:  0.04126159238028351
Bond Position:  [-15.95260501]


portfolio before change:  [-11.53579747]
curr_Stock_Price:  107.06820453289369
curr_Factors:  [107.06820453]
mat_Sqrt:  [[0.15]]
grads:  [0.04106447]
Stock Position:  0.041064471225206074
Bond Position:  [-15.93249667]


portfolio before change:  [-11.53652849]
curr_Stock_Price:  107.07465266663371
curr_Factors:  [107.07465267]
mat_Sqrt:  [[0.15]]
grads:  [0.09847755]
Stock Position:  0.0984775458965999
Bond Position:  [-22.08097751]


portfolio before change:  [-11.5542716]
curr_Stock_Price:  106.90849291646481
curr_Factors:  [106.90849292]
mat_Sqrt:  [[0.15]]
grads:  [-0.18958249]
Stock Position:  -0.18958248844915543
Bond Position:  [8.71370653]


portfolio before change:  [-11.42718013]
curr_Stock_Price:  106.2409901306547
curr_Factors:  [106.24099013]
mat_Sqrt:  [[0.15]]
grads:  [-0.0523426]
Stock Position:  -0.05234260281151693
Bond Position:  [-5.86625019]


portfolio before change:  [-11.47208722]
curr_Stock_Price:  107.0919305757099
curr_Factors:  [107.09193058]
mat_Sqrt:  [[0.15]]
grads:  [-0.03483668]
Stock Position:  -0.034836682149905214
Bond Position:  [-7.74135968]


portfolio before change:  [-11.48401684]
curr_Stock_Price:  107.42048563226284
curr_Factors:  [107.42048563]
mat_Sqrt:  [[0.15]]
grads:  [0.09854688]
Stock Position:  0.09854688136052218
Bond Position:  [-22.0699707]


portfolio before change:  [-11.51570544]
curr_Stock_Price:  107.1129245453308
curr_Factors:  [107.11292455]
mat_Sqrt:  [[0.15]]
grads:  [0.0313762]
Stock Position:  0.03137620230798686
Bond Position:  [-14.87650223]


portfolio before change:  [-11.54024248]
curr_Stock_Price:  106.36053200222644
curr_Factors:  [106.360532]
mat_Sqrt:  [[0.15]]
grads:  [-0.0089811]
Stock Position:  -0.008981104127703168
Bond Position:  [-10.58500746]


portfolio before change:  [-11.53781981]
curr_Stock_Price:  106.01711684031166
curr_Factors:  [106.01711684]
mat_Sqrt:  [[0.15]]
grads:  [0.00528953]
Stock Position:  0.005289526976021446
Bond Position:  [-12.09860021]


portfolio before change:  [-11.53928061]
curr_Stock_Price:  105.88390728658922
curr_Factors:  [105.88390729]
mat_Sqrt:  [[0.15]]
grads:  [0.04761287]
Stock Position:  0.047612868051286165
Bond Position:  [-16.58071712]


portfolio before change:  [-11.57766215]
curr_Stock_Price:  105.09955618765198
curr_Factors:  [105.09955619]
mat_Sqrt:  [[0.15]]
grads:  [-0.02419839]
Stock Position:  -0.024198393637027978
Bond Position:  [-9.03442171]


portfolio before change:  [-11.57843599]
curr_Stock_Price:  105.10820053998128
curr_Factors:  [105.10820054]
mat_Sqrt:  [[0.15]]
grads:  [0.15514639]
Stock Position:  0.15514638535219685
Bond Position:  [-27.88559338]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.57843599]
Stock Price:  104.32821169347787
PL:  [-15.90664769]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-1.05738730e-01]
 [ 5.71630828e-03]
 [ 4.95165773e-03]
 [ 3.47973312e-03]
 [ 6.22676285e-03]
 [ 1.18482455e-02]
 [ 1.22755975e-03]
 [ 1.03389490e-02]
 [ 1.58865667e-02]
 [-1.88668911e-02]
 [ 1.01927758e-02]
 [-7.88034750e-03]
 [ 1.68513684e-02]
 [ 4.26156925e-03]
 [ 5.83795438e-03]
 [-8.44560952e-03]
 [ 1.24872100e-02]
 [ 1.43593791e-02]
 [ 2.17440929e-02]
 [ 3.53634929e-03]
 [ 7.72811737e-02]
 [-1.33405742e-02]
 [ 1.57593155e-04]
 [ 4.78371994e-03]
 [ 1.61345551e-02]
 [ 9.86160874e-03]
 [ 1.20799493e-02]
 [ 5.51498707e-03]
 [ 6.19950263e-03]
 [-1.96170003e-02]
 [-5.66269734e-03]
 [ 2.77232575e-02]
 [ 7.59101622e-03]
 [ 2.55623150e-03]
 [-5.02658266e-03]
 [-3.87327198e-03]
 [-3.58272951e-03]
 [ 3.76274823e-04]
 [ 6.36125763e-03]
 [-6.50384807e-03]
 [-5.18236708e-02]
 [-4.07381550e-03]
 [ 1.52814786e-02]
 [-1.58090468e-02]
 [-6.08834883e-03]
 [ 3.18089422e-03]
 [-1.35278125e-02]
 [ 2.05425109e-02]
 [ 3.96428479e-02]
 [-1.47866261e-02]
 [-5.37561929e-03]
 [ 3.91910668e-03]
 [ 3.55095183e-03]
 [-8.55462028e-03]
 [-1.47516313e-02]
 [ 1.39110763e-02]
 [-4.14327974e-02]
 [-1.25683177e-02]
 [ 2.27487414e-02]
 [-1.45515435e-02]
 [ 1.33685023e-02]
 [-1.24944725e-02]
 [-1.25949317e-02]
 [-2.20663250e-03]
 [ 1.87403244e-01]
 [-6.88218055e-03]
 [-4.61204790e-03]
 [ 7.91298515e-03]
 [ 1.77690401e-02]
 [-3.23566650e-02]
 [-7.95757732e-03]
 [-4.43895918e-03]
 [ 1.60298962e-02]
 [ 4.49128391e-03]
 [-2.76196057e-03]
 [ 6.90349591e-03]
 [ 1.95938942e-03]
 [-2.37751830e-03]
 [ 2.22208917e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.50608324]
curr_Stock_Price:  101.31366887537176
curr_Factors:  [101.31366888]
mat_Sqrt:  [[0.15]]
grads:  [-0.70492487]
Stock Position:  -0.7049248651788667
Bond Position:  [93.92460761]


portfolio before change:  [22.02964835]
curr_Stock_Price:  101.99786287434307
curr_Factors:  [101.99786287]
mat_Sqrt:  [[0.15]]
grads:  [0.03810872]
Stock Position:  0.03810872188940841
Bond Position:  [18.14264016]


portfolio before change:  [21.99932909]
curr_Stock_Price:  101.17250827625404
curr_Factors:  [101.17250828]
mat_Sqrt:  [[0.15]]
grads:  [0.03301105]
Stock Position:  0.03301105154005147
Bond Position:  [18.65951821]


portfolio before change:  [22.02654998]
curr_Stock_Price:  101.96177835985499
curr_Factors:  [101.96177836]
mat_Sqrt:  [[0.15]]
grads:  [0.02319822]
Stock Position:  0.023198220828471092
Bond Position:  [19.66121813]


portfolio before change:  [22.01827705]
curr_Stock_Price:  101.55218661060746
curr_Factors:  [101.55218661]
mat_Sqrt:  [[0.15]]
grads:  [0.04151175]
Stock Position:  0.04151175232503842
Bond Position:  [17.80266783]


portfolio before change:  [21.98271887]
curr_Stock_Price:  100.66880116999809
curr_Factors:  [100.66880117]
mat_Sqrt:  [[0.15]]
grads:  [0.0789883]
Stock Position:  0.07898830349075373
Bond Position:  [14.03106105]


portfolio before change:  [21.95629987]
curr_Stock_Price:  100.32323142223827
curr_Factors:  [100.32323142]
mat_Sqrt:  [[0.15]]
grads:  [0.00818373]
Stock Position:  0.008183731654657094
Bond Position:  [21.13528147]


portfolio before change:  [21.95651936]
curr_Stock_Price:  100.18863364008045
curr_Factors:  [100.18863364]
mat_Sqrt:  [[0.15]]
grads:  [0.06892633]
Stock Position:  0.06892632670132001
Bond Position:  [15.05088486]


portfolio before change:  [21.92786476]
curr_Stock_Price:  99.75925776248009
curr_Factors:  [99.75925776]
mat_Sqrt:  [[0.15]]
grads:  [0.10591044]
Stock Position:  0.10591044454269824
Bond Position:  [11.36231743]


portfolio before change:  [21.97152178]
curr_Stock_Price:  100.16475933579581
curr_Factors:  [100.16475934]
mat_Sqrt:  [[0.15]]
grads:  [-0.12577927]
Stock Position:  -0.1257792742105093
Bond Position:  [34.57017251]


portfolio before change:  [21.94811272]
curr_Stock_Price:  100.36805010236687
curr_Factors:  [100.3680501]
mat_Sqrt:  [[0.15]]
grads:  [0.06795184]
Stock Position:  0.0679518387743019
Bond Position:  [15.12791916]


portfolio before change:  [22.01182887]
curr_Stock_Price:  101.2918017089327
curr_Factors:  [101.29180171]
mat_Sqrt:  [[0.15]]
grads:  [-0.05253565]
Stock Position:  -0.05253565000059615
Bond Position:  [27.33325951]


portfolio before change:  [21.98875456]
curr_Stock_Price:  101.76353263234846
curr_Factors:  [101.76353263]
mat_Sqrt:  [[0.15]]
grads:  [0.11234246]
Stock Position:  0.1123424559337064
Bond Position:  [10.55638938]


portfolio before change:  [21.97319303]
curr_Stock_Price:  101.61914088822608
curr_Factors:  [101.61914089]
mat_Sqrt:  [[0.15]]
grads:  [0.02841046]
Stock Position:  0.028410461673329876
Bond Position:  [19.08614632]


portfolio before change:  [21.94453512]
curr_Stock_Price:  100.56844230601548
curr_Factors:  [100.56844231]
mat_Sqrt:  [[0.15]]
grads:  [0.0389197]
Stock Position:  0.03891969585612563
Bond Position:  [18.03044193]


portfolio before change:  [21.95384176]
curr_Stock_Price:  100.77861110456388
curr_Factors:  [100.7786111]
mat_Sqrt:  [[0.15]]
grads:  [-0.05630406]
Stock Position:  -0.056304063469365354
Bond Position:  [27.62808708]


portfolio before change:  [21.92600318]
curr_Stock_Price:  101.30371343157401
curr_Factors:  [101.30371343]
mat_Sqrt:  [[0.15]]
grads:  [0.08324807]
Stock Position:  0.08324806648882924
Bond Position:  [13.49266491]


portfolio before change:  [21.87339435]
curr_Stock_Price:  100.66163067355203
curr_Factors:  [100.66163067]
mat_Sqrt:  [[0.15]]
grads:  [0.09572919]
Stock Position:  0.09572919388959958
Bond Position:  [12.23713759]


portfolio before change:  [21.8151414]
curr_Stock_Price:  100.04512290547126
curr_Factors:  [100.04512291]
mat_Sqrt:  [[0.15]]
grads:  [0.14496062]
Stock Position:  0.14496061953575723
Bond Position:  [7.3125384]


portfolio before change:  [21.84866231]
curr_Stock_Price:  100.27321145721442
curr_Factors:  [100.27321146]
mat_Sqrt:  [[0.15]]
grads:  [0.02357566]
Stock Position:  0.02357566192946426
Bond Position:  [19.48465497]


portfolio before change:  [21.84843444]
curr_Stock_Price:  100.21189009761505
curr_Factors:  [100.2118901]
mat_Sqrt:  [[0.15]]
grads:  [0.51520782]
Stock Position:  0.5152078247770343
Bond Position:  [-29.78151547]


portfolio before change:  [21.93294352]
curr_Stock_Price:  100.37953210784522
curr_Factors:  [100.37953211]
mat_Sqrt:  [[0.15]]
grads:  [-0.08893716]
Stock Position:  -0.08893716102869599
Bond Position:  [30.86041413]


portfolio before change:  [21.92298022]
curr_Stock_Price:  100.51324592648638
curr_Factors:  [100.51324593]
mat_Sqrt:  [[0.15]]
grads:  [0.00105062]
Stock Position:  0.0010506210317141017
Bond Position:  [21.81737889]


portfolio before change:  [21.92463706]
curr_Stock_Price:  100.79232219141647
curr_Factors:  [100.79232219]
mat_Sqrt:  [[0.15]]
grads:  [0.03189147]
Stock Position:  0.03189146623902817
Bond Position:  [18.71022212]


portfolio before change:  [21.94806172]
curr_Stock_Price:  101.49016518409844
curr_Factors:  [101.49016518]
mat_Sqrt:  [[0.15]]
grads:  [0.1075637]
Stock Position:  0.10756370093915713
Bond Position:  [11.03140394]


portfolio before change:  [21.9372413]
curr_Stock_Price:  101.38315971846146
curr_Factors:  [101.38315972]
mat_Sqrt:  [[0.15]]
grads:  [0.06574406]
Stock Position:  0.06574405829838631
Bond Position:  [15.27190094]


portfolio before change:  [21.93206141]
curr_Stock_Price:  101.2898521910185
curr_Factors:  [101.28985219]
mat_Sqrt:  [[0.15]]
grads:  [0.080533]
Stock Position:  0.08053299521216681
Bond Position:  [13.77488623]


portfolio before change:  [22.01170957]
curr_Stock_Price:  102.26817422998862
curr_Factors:  [102.26817423]
mat_Sqrt:  [[0.15]]
grads:  [0.03676658]
Stock Position:  0.036766580464256154
Bond Position:  [18.25165851]


portfolio before change:  [22.02679348]
curr_Stock_Price:  102.64740848234865
curr_Factors:  [102.64740848]
mat_Sqrt:  [[0.15]]
grads:  [0.04133002]
Stock Position:  0.04133001751538904
Bond Position:  [17.78437429]


portfolio before change:  [22.00149881]
curr_Stock_Price:  102.00849693660486
curr_Factors:  [102.00849694]
mat_Sqrt:  [[0.15]]
grads:  [-0.13078]
Stock Position:  -0.1307800022059763
Bond Position:  [35.34217027]


portfolio before change:  [21.98073287]
curr_Stock_Price:  102.18417285675888
curr_Factors:  [102.18417286]
mat_Sqrt:  [[0.15]]
grads:  [-0.03775132]
Stock Position:  -0.03775131558693204
Bond Position:  [25.83831983]


portfolio before change:  [21.99297172]
curr_Stock_Price:  101.90275466933451
curr_Factors:  [101.90275467]
mat_Sqrt:  [[0.15]]
grads:  [0.18482172]
Stock Position:  0.1848217167736405
Bond Position:  [3.15912966]


portfolio before change:  [21.97781337]
curr_Stock_Price:  101.8196702386426
curr_Factors:  [101.81967024]
mat_Sqrt:  [[0.15]]
grads:  [0.05060677]
Stock Position:  0.05060677480886216
Bond Position:  [16.82504824]


portfolio before change:  [21.98324863]
curr_Stock_Price:  101.90629234983743
curr_Factors:  [101.90629235]
mat_Sqrt:  [[0.15]]
grads:  [0.01704154]
Stock Position:  0.017041543314832038
Bond Position:  [20.24660814]


portfolio before change:  [21.99783727]
curr_Stock_Price:  102.6880984424762
curr_Factors:  [102.68809844]
mat_Sqrt:  [[0.15]]
grads:  [-0.03351055]
Stock Position:  -0.03351055104452029
Bond Position:  [25.43897203]


portfolio before change:  [21.99713219]
curr_Stock_Price:  102.75658602969416
curr_Factors:  [102.75658603]
mat_Sqrt:  [[0.15]]
grads:  [-0.02582181]
Stock Position:  -0.025821813226726144
Bond Position:  [24.65049357]


portfolio before change:  [21.96076454]
curr_Stock_Price:  104.22466094994293
curr_Factors:  [104.22466095]
mat_Sqrt:  [[0.15]]
grads:  [-0.02388486]
Stock Position:  -0.02388486340961986
Bond Position:  [24.45015633]


portfolio before change:  [21.95743315]
curr_Stock_Price:  104.42811924870446
curr_Factors:  [104.42811925]
mat_Sqrt:  [[0.15]]
grads:  [0.0025085]
Stock Position:  0.0025084988208203623
Bond Position:  [21.69547534]


portfolio before change:  [21.96101467]
curr_Stock_Price:  105.3153054297632
curr_Factors:  [105.31530543]
mat_Sqrt:  [[0.15]]
grads:  [0.04240838]
Stock Position:  0.04240838416682355
Bond Position:  [17.49476273]


portfolio before change:  [21.95855498]
curr_Stock_Price:  105.2315214807897
curr_Factors:  [105.23152148]
mat_Sqrt:  [[0.15]]
grads:  [-0.04335899]
Stock Position:  -0.04335898713651597
Bond Position:  [26.52128717]


portfolio before change:  [21.99190589]
curr_Stock_Price:  104.50057096616996
curr_Factors:  [104.50057097]
mat_Sqrt:  [[0.15]]
grads:  [-0.34549114]
Stock Position:  -0.34549113864100667
Bond Position:  [58.09592714]


portfolio before change:  [21.99311274]
curr_Stock_Price:  104.5075878053247
curr_Factors:  [104.50758781]
mat_Sqrt:  [[0.15]]
grads:  [-0.02715877]
Stock Position:  -0.027158769990698918
Bond Position:  [24.83141028]


portfolio before change:  [22.00507001]
curr_Stock_Price:  104.12446074027346
curr_Factors:  [104.12446074]
mat_Sqrt:  [[0.15]]
grads:  [0.10187652]
Stock Position:  0.10187652371202106
Bond Position:  [11.39723192]


portfolio before change:  [22.13239944]
curr_Stock_Price:  105.36730916800784
curr_Factors:  [105.36730917]
mat_Sqrt:  [[0.15]]
grads:  [-0.10539365]
Stock Position:  -0.10539364561689252
Bond Position:  [33.23744428]


portfolio before change:  [22.12615057]
curr_Stock_Price:  105.44631082187958
curr_Factors:  [105.44631082]
mat_Sqrt:  [[0.15]]
grads:  [-0.04058899]
Stock Position:  -0.04058899216962784
Bond Position:  [26.40611006]


portfolio before change:  [22.0955221]
curr_Stock_Price:  106.24157334388339
curr_Factors:  [106.24157334]
mat_Sqrt:  [[0.15]]
grads:  [0.02120596]
Stock Position:  0.021205961493007137
Bond Position:  [19.84256739]


portfolio before change:  [22.10125176]
curr_Stock_Price:  106.4532806233376
curr_Factors:  [106.45328062]
mat_Sqrt:  [[0.15]]
grads:  [-0.09018542]
Stock Position:  -0.09018541673569153
Bond Position:  [31.70178523]


portfolio before change:  [22.14459547]
curr_Stock_Price:  105.99464445224656
curr_Factors:  [105.99464445]
mat_Sqrt:  [[0.15]]
grads:  [0.13695007]
Stock Position:  0.13695007243204532
Bond Position:  [7.62862124]


portfolio before change:  [22.25536467]
curr_Stock_Price:  106.79999191639908
curr_Factors:  [106.79999192]
mat_Sqrt:  [[0.15]]
grads:  [0.26428565]
Stock Position:  0.2642856525716899
Bond Position:  [-5.97034089]


portfolio before change:  [22.34523193]
curr_Stock_Price:  107.14144222356228
curr_Factors:  [107.14144222]
mat_Sqrt:  [[0.15]]
grads:  [-0.09857751]
Stock Position:  -0.09857750732569846
Bond Position:  [32.90696824]


portfolio before change:  [22.26092857]
curr_Stock_Price:  108.01750526591107
curr_Factors:  [108.01750527]
mat_Sqrt:  [[0.15]]
grads:  [-0.03583746]
Stock Position:  -0.03583746191075681
Bond Position:  [26.1320018]


portfolio before change:  [22.27055964]
curr_Stock_Price:  107.79433730536195
curr_Factors:  [107.79433731]
mat_Sqrt:  [[0.15]]
grads:  [0.02612738]
Stock Position:  0.02612737784365184
Bond Position:  [19.45417626]


portfolio before change:  [22.26978105]
curr_Stock_Price:  107.7179989277047
curr_Factors:  [107.71799893]
mat_Sqrt:  [[0.15]]
grads:  [0.02367301]
Stock Position:  0.023673012179276857
Bond Position:  [19.71977155]


portfolio before change:  [22.26832331]
curr_Stock_Price:  107.60435644298438
curr_Factors:  [107.60435644]
mat_Sqrt:  [[0.15]]
grads:  [-0.0570308]
Stock Position:  -0.0570308018944622
Bond Position:  [28.40508605]


portfolio before change:  [22.24465218]
curr_Stock_Price:  108.05054518587583
curr_Factors:  [108.05054519]
mat_Sqrt:  [[0.15]]
grads:  [-0.09834421]
Stock Position:  -0.09834420868635976
Bond Position:  [32.87079755]


portfolio before change:  [22.22749757]
curr_Stock_Price:  108.24587036111136
curr_Factors:  [108.24587036]
mat_Sqrt:  [[0.15]]
grads:  [0.09274051]
Stock Position:  0.09274050853498306
Bond Position:  [12.18872051]


portfolio before change:  [22.20378644]
curr_Stock_Price:  107.98198405849685
curr_Factors:  [107.98198406]
mat_Sqrt:  [[0.15]]
grads:  [-0.27621865]
Stock Position:  -0.2762186492344922
Bond Position:  [52.03042422]


portfolio before change:  [22.19734281]
curr_Stock_Price:  108.01708535874614
curr_Factors:  [108.01708536]
mat_Sqrt:  [[0.15]]
grads:  [-0.08378878]
Stock Position:  -0.08378878440628354
Bond Position:  [31.24796309]


portfolio before change:  [22.2022214]
curr_Stock_Price:  107.98216975612925
curr_Factors:  [107.98216976]
mat_Sqrt:  [[0.15]]
grads:  [0.15165828]
Stock Position:  0.15165827572040086
Bond Position:  [5.82583173]


portfolio before change:  [22.30096082]
curr_Stock_Price:  108.63083391777359
curr_Factors:  [108.63083392]
mat_Sqrt:  [[0.15]]
grads:  [-0.09701029]
Stock Position:  -0.09701028984784062
Bond Position:  [32.8392695]


portfolio before change:  [22.3053631]
curr_Stock_Price:  108.60661207960102
curr_Factors:  [108.60661208]
mat_Sqrt:  [[0.15]]
grads:  [0.08912335]
Stock Position:  0.08912334865693744
Bond Position:  [12.62597815]


portfolio before change:  [22.37890943]
curr_Stock_Price:  109.42297699029844
curr_Factors:  [109.42297699]
mat_Sqrt:  [[0.15]]
grads:  [-0.08329648]
Stock Position:  -0.0832964833429161
Bond Position:  [31.49345861]


portfolio before change:  [22.32716803]
curr_Stock_Price:  110.06777976163288
curr_Factors:  [110.06777976]
mat_Sqrt:  [[0.15]]
grads:  [-0.08396621]
Stock Position:  -0.08396621119208578
Bond Position:  [31.56914247]


portfolio before change:  [22.30227548]
curr_Stock_Price:  110.38773793605748
curr_Factors:  [110.38773794]
mat_Sqrt:  [[0.15]]
grads:  [-0.01471088]
Stock Position:  -0.01471088335784707
Bond Position:  [23.92617662]


portfolio before change:  [22.31133146]
curr_Stock_Price:  109.87379606558396
curr_Factors:  [109.87379607]
mat_Sqrt:  [[0.15]]
grads:  [1.24935496]
Stock Position:  1.249354957742511
Bond Position:  [-114.96004039]


portfolio before change:  [22.4342121]
curr_Stock_Price:  109.9779024870832
curr_Factors:  [109.97790249]
mat_Sqrt:  [[0.15]]
grads:  [-0.0458812]
Stock Position:  -0.04588120369913843
Bond Position:  [27.48013065]


portfolio before change:  [22.42628224]
curr_Stock_Price:  110.18817201813766
curr_Factors:  [110.18817202]
mat_Sqrt:  [[0.15]]
grads:  [-0.03074699]
Stock Position:  -0.03074698601638115
Bond Position:  [25.81423643]


portfolio before change:  [22.44907806]
curr_Stock_Price:  109.49924662044636
curr_Factors:  [109.49924662]
mat_Sqrt:  [[0.15]]
grads:  [0.05275323]
Stock Position:  0.05275323431135959
Bond Position:  [16.67263865]


portfolio before change:  [22.43323851]
curr_Stock_Price:  109.17923531861574
curr_Factors:  [109.17923532]
mat_Sqrt:  [[0.15]]
grads:  [0.11846027]
Stock Position:  0.11846026705044213
Bond Position:  [9.49983713]


portfolio before change:  [22.35128933]
curr_Stock_Price:  108.48243686673334
curr_Factors:  [108.48243687]
mat_Sqrt:  [[0.15]]
grads:  [-0.2157111]
Stock Position:  -0.2157111003014074
Bond Position:  [45.75215515]


portfolio before change:  [22.30153302]
curr_Stock_Price:  108.72635531547905
curr_Factors:  [108.72635532]
mat_Sqrt:  [[0.15]]
grads:  [-0.05305052]
Stock Position:  -0.053050515468003843
Bond Position:  [28.06952221]


portfolio before change:  [22.32149552]
curr_Stock_Price:  108.38313336247704
curr_Factors:  [108.38313336]
mat_Sqrt:  [[0.15]]
grads:  [-0.02959306]
Stock Position:  -0.029593061232694225
Bond Position:  [25.52888422]


portfolio before change:  [22.33895364]
curr_Stock_Price:  107.84711171173218
curr_Factors:  [107.84711171]
mat_Sqrt:  [[0.15]]
grads:  [0.10686597]
Stock Position:  0.10686597497292498
Bond Position:  [10.8137669]


portfolio before change:  [22.28950447]
curr_Stock_Price:  107.37806574090303
curr_Factors:  [107.37806574]
mat_Sqrt:  [[0.15]]
grads:  [0.02994189]
Stock Position:  0.029941892700340516
Bond Position:  [19.07440195]


portfolio before change:  [22.32406935]
curr_Stock_Price:  108.49264754825505
curr_Factors:  [108.49264755]
mat_Sqrt:  [[0.15]]
grads:  [-0.01841307]
Stock Position:  -0.01841307046470823
Bond Position:  [24.32175211]


portfolio before change:  [22.32258284]
curr_Stock_Price:  108.65593742115847
curr_Factors:  [108.65593742]
mat_Sqrt:  [[0.15]]
grads:  [0.04602331]
Stock Position:  0.04602330609242928
Bond Position:  [17.32187737]


portfolio before change:  [22.30731589]
curr_Stock_Price:  108.30069131175536
curr_Factors:  [108.30069131]
mat_Sqrt:  [[0.15]]
grads:  [0.0130626]
Stock Position:  0.013062596100116806
Bond Position:  [20.8926277]


portfolio before change:  [22.30491915]
curr_Stock_Price:  108.01724330629834
curr_Factors:  [108.01724331]
mat_Sqrt:  [[0.15]]
grads:  [-0.01585012]
Stock Position:  -0.01585012199850962
Bond Position:  [24.01700563]


portfolio before change:  [22.29838684]
curr_Stock_Price:  108.52407958670625
curr_Factors:  [108.52407959]
mat_Sqrt:  [[0.15]]
grads:  [0.14813928]
Stock Position:  0.14813927825584092
Bond Position:  [6.22170802]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.29838684]
Stock Price:  108.46344631727715
PL:  [13.83494053]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-5.74964488e-02]
 [ 4.44472419e-04]
 [-3.32994636e-06]
 [ 8.62700513e-05]
 [ 2.07407809e-02]
 [ 1.18001962e-02]
 [ 6.23979468e-04]
 [ 6.29153734e-03]
 [-2.56733533e-03]
 [-1.82498180e-02]
 [ 1.02693855e-02]
 [-5.54890419e-03]
 [-4.48637172e-03]
 [ 4.22640554e-03]
 [ 4.16678787e-03]
 [-5.54500166e-03]
 [ 1.16310901e-02]
 [ 9.51384419e-03]
 [ 2.39282830e-02]
 [ 1.03787484e-02]
 [ 3.64257579e-02]
 [-1.75152692e-02]
 [-1.88194929e-03]
 [ 1.00651767e-02]
 [ 1.34357472e-02]
 [-7.54412694e-03]
 [ 1.31279016e-02]
 [ 1.05947750e-03]
 [ 2.95525439e-03]
 [-2.48332748e-02]
 [-4.41519630e-03]
 [ 4.05119697e-03]
 [ 1.19499363e-02]
 [ 1.15356159e-02]
 [ 3.17133221e-04]
 [-4.71664615e-03]
 [-6.30375565e-03]
 [ 1.40339962e-02]
 [-1.07665677e-03]
 [-1.27474662e-02]
 [-1.11989018e-03]
 [-2.86936867e-03]
 [ 5.47901686e-03]
 [-7.86750513e-03]
 [ 2.61476041e-03]
 [-1.91402935e-03]
 [-1.36933397e-02]
 [-2.18616856e-03]
 [-8.18707339e-03]
 [ 8.95552288e-03]
 [-3.21145236e-03]
 [ 3.24844407e-03]
 [ 2.40527876e-03]
 [ 6.03909918e-05]
 [ 2.26977323e-03]
 [ 9.01145608e-03]
 [ 1.75839176e-02]
 [-2.70243438e-02]
 [ 1.40196207e-02]
 [ 6.30450296e-03]
 [ 5.31508878e-03]
 [-1.33297440e-02]
 [-1.25393342e-02]
 [-2.19375832e-03]
 [-2.01517135e-02]
 [ 4.12686951e-02]
 [ 1.99963854e-02]
 [ 1.94410304e-03]
 [ 6.16537490e-03]
 [-1.36368458e-02]
 [-8.32832287e-03]
 [-7.79236392e-03]
 [ 1.60538514e-03]
 [ 8.24587183e-03]
 [ 4.66842165e-03]
 [-1.21285224e-02]
 [ 4.93089104e-03]
 [-5.03980787e-03]
 [ 1.73405965e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.8574132]
curr_Stock_Price:  100.50073050891184
curr_Factors:  [100.50073051]
mat_Sqrt:  [[0.15]]
grads:  [-0.38330966]
Stock Position:  -0.3833096588018482
Bond Position:  [48.38031392]


portfolio before change:  [10.18510454]
curr_Stock_Price:  99.65371956323116
curr_Factors:  [99.65371956]
mat_Sqrt:  [[0.15]]
grads:  [0.00296315]
Stock Position:  0.0029631494573585256
Bond Position:  [9.88981568]


portfolio before change:  [10.18569914]
curr_Stock_Price:  99.6457771843565
curr_Factors:  [99.64577718]
mat_Sqrt:  [[0.15]]
grads:  [-2.21996424e-05]
Stock Position:  -2.2199642396997232e-05
Bond Position:  [10.18791124]


portfolio before change:  [10.18634721]
curr_Stock_Price:  99.13642743030098
curr_Factors:  [99.13642743]
mat_Sqrt:  [[0.15]]
grads:  [0.00057513]
Stock Position:  0.000575133675007634
Bond Position:  [10.12933052]


portfolio before change:  [10.18746157]
curr_Stock_Price:  99.97319661882355
curr_Factors:  [99.97319662]
mat_Sqrt:  [[0.15]]
grads:  [0.13827187]
Stock Position:  0.13827187265935417
Bond Position:  [-3.63601954]


portfolio before change:  [10.26151625]
curr_Stock_Price:  100.51041315036116
curr_Factors:  [100.51041315]
mat_Sqrt:  [[0.15]]
grads:  [0.07866797]
Stock Position:  0.07866797489700218
Bond Position:  [2.35456559]


portfolio before change:  [10.29316137]
curr_Stock_Price:  100.91080422392544
curr_Factors:  [100.91080422]
mat_Sqrt:  [[0.15]]
grads:  [0.00415986]
Stock Position:  0.00415986312163559
Bond Position:  [9.87338623]


portfolio before change:  [10.29568311]
curr_Stock_Price:  101.36866472976922
curr_Factors:  [101.36866473]
mat_Sqrt:  [[0.15]]
grads:  [0.04194358]
Stock Position:  0.04194358227462232
Bond Position:  [6.04391818]


portfolio before change:  [10.27696113]
curr_Stock_Price:  100.91329751089903
curr_Factors:  [100.91329751]
mat_Sqrt:  [[0.15]]
grads:  [-0.01711557]
Stock Position:  -0.017115568880699292
Bond Position:  [12.00414963]


portfolio before change:  [10.27001057]
curr_Stock_Price:  101.36322995891096
curr_Factors:  [101.36322996]
mat_Sqrt:  [[0.15]]
grads:  [-0.12166545]
Stock Position:  -0.12166545329332763
Bond Position:  [22.60241389]


portfolio before change:  [10.35139308]
curr_Stock_Price:  100.70593721674133
curr_Factors:  [100.70593722]
mat_Sqrt:  [[0.15]]
grads:  [0.06846257]
Stock Position:  0.06846256982911486
Bond Position:  [3.45680582]


portfolio before change:  [10.32903776]
curr_Stock_Price:  100.37624793916046
curr_Factors:  [100.37624794]
mat_Sqrt:  [[0.15]]
grads:  [-0.03699269]
Stock Position:  -0.03699269458829179
Bond Position:  [14.04222565]


portfolio before change:  [10.33013585]
curr_Stock_Price:  100.37028952742367
curr_Factors:  [100.37028953]
mat_Sqrt:  [[0.15]]
grads:  [-0.02990914]
Stock Position:  -0.02990914482771955
Bond Position:  [13.33212537]


portfolio before change:  [10.32029911]
curr_Stock_Price:  100.72703727888894
curr_Factors:  [100.72703728]
mat_Sqrt:  [[0.15]]
grads:  [0.02817604]
Stock Position:  0.028176036923390404
Bond Position:  [7.48221039]


portfolio before change:  [10.29377784]
curr_Stock_Price:  99.76916907925185
curr_Factors:  [99.76916908]
mat_Sqrt:  [[0.15]]
grads:  [0.02777859]
Stock Position:  0.027778585828709748
Bond Position:  [7.52233141]


portfolio before change:  [10.31231406]
curr_Stock_Price:  100.41952841251289
curr_Factors:  [100.41952841]
mat_Sqrt:  [[0.15]]
grads:  [-0.03696668]
Stock Position:  -0.03696667770845292
Bond Position:  [14.0244904]


portfolio before change:  [10.3198747]
curr_Stock_Price:  100.23871459750198
curr_Factors:  [100.2387146]
mat_Sqrt:  [[0.15]]
grads:  [0.0775406]
Stock Position:  0.07754060059383418
Bond Position:  [2.54730457]


portfolio before change:  [10.29285615]
curr_Stock_Price:  99.88821737830885
curr_Factors:  [99.88821738]
mat_Sqrt:  [[0.15]]
grads:  [0.06342563]
Stock Position:  0.0634256279298293
Bond Position:  [3.95738324]


portfolio before change:  [10.2723002]
curr_Stock_Price:  99.56022232911546
curr_Factors:  [99.56022233]
mat_Sqrt:  [[0.15]]
grads:  [0.15952189]
Stock Position:  0.15952188641391582
Bond Position:  [-5.60973428]


portfolio before change:  [10.25612459]
curr_Stock_Price:  99.46101966374161
curr_Factors:  [99.46101966]
mat_Sqrt:  [[0.15]]
grads:  [0.06919166]
Stock Position:  0.0691916563077438
Bond Position:  [3.3742519]


portfolio before change:  [10.20410917]
curr_Stock_Price:  98.70621313953947
curr_Factors:  [98.70621314]
mat_Sqrt:  [[0.15]]
grads:  [0.24283839]
Stock Position:  0.24283838577162256
Bond Position:  [-13.7655483]


portfolio before change:  [10.27602175]
curr_Stock_Price:  99.00588964235432
curr_Factors:  [99.00588964]
mat_Sqrt:  [[0.15]]
grads:  [-0.11676846]
Stock Position:  -0.11676846153050792
Bond Position:  [21.83678717]


portfolio before change:  [10.2246412]
curr_Stock_Price:  99.45759889296771
curr_Factors:  [99.45759889]
mat_Sqrt:  [[0.15]]
grads:  [-0.01254633]
Stock Position:  -0.012546328599288878
Bond Position:  [11.47246892]


portfolio before change:  [10.2157413]
curr_Stock_Price:  100.22411403349993
curr_Factors:  [100.22411403]
mat_Sqrt:  [[0.15]]
grads:  [0.06710118]
Stock Position:  0.0671011779224427
Bond Position:  [3.49058519]


portfolio before change:  [10.21113024]
curr_Stock_Price:  100.15214468932079
curr_Factors:  [100.15214469]
mat_Sqrt:  [[0.15]]
grads:  [0.08957165]
Stock Position:  0.08957164821098228
Bond Position:  [1.24033757]


portfolio before change:  [10.23047964]
curr_Stock_Price:  100.36730062968246
curr_Factors:  [100.36730063]
mat_Sqrt:  [[0.15]]
grads:  [-0.05029418]
Stock Position:  -0.050294179610134646
Bond Position:  [15.27837068]


portfolio before change:  [10.22770841]
curr_Stock_Price:  100.44138781239606
curr_Factors:  [100.44138781]
mat_Sqrt:  [[0.15]]
grads:  [0.08751934]
Stock Position:  0.0875193436698717
Bond Position:  [1.43714407]


portfolio before change:  [10.20811971]
curr_Stock_Price:  100.21654006739024
curr_Factors:  [100.21654007]
mat_Sqrt:  [[0.15]]
grads:  [0.00706318]
Stock Position:  0.007063183342325373
Bond Position:  [9.50027191]


portfolio before change:  [10.20707229]
curr_Stock_Price:  99.98417897973638
curr_Factors:  [99.98417898]
mat_Sqrt:  [[0.15]]
grads:  [0.0197017]
Stock Position:  0.0197016959085749
Bond Position:  [8.2372144]


portfolio before change:  [10.21249412]
curr_Stock_Price:  100.23324352152777
curr_Factors:  [100.23324352]
mat_Sqrt:  [[0.15]]
grads:  [-0.16555517]
Stock Position:  -0.1655551653466896
Bond Position:  [26.80662533]


portfolio before change:  [10.2699449]
curr_Stock_Price:  99.89634484999775
curr_Factors:  [99.89634485]
mat_Sqrt:  [[0.15]]
grads:  [-0.02943464]
Stock Position:  -0.02943464196824498
Bond Position:  [13.21035805]


portfolio before change:  [10.26703809]
curr_Stock_Price:  100.02315063435772
curr_Factors:  [100.02315063]
mat_Sqrt:  [[0.15]]
grads:  [0.02700798]
Stock Position:  0.027007979788356146
Bond Position:  [7.56561486]


portfolio before change:  [10.28230024]
curr_Stock_Price:  100.57073989298274
curr_Factors:  [100.57073989]
mat_Sqrt:  [[0.15]]
grads:  [0.07966624]
Stock Position:  0.07966624177943012
Bond Position:  [2.27020736]


portfolio before change:  [10.31154126]
curr_Stock_Price:  100.93600286716847
curr_Factors:  [100.93600287]
mat_Sqrt:  [[0.15]]
grads:  [0.07690411]
Stock Position:  0.07690410624184535
Bond Position:  [2.54914817]


portfolio before change:  [10.34635701]
curr_Stock_Price:  101.386647523718
curr_Factors:  [101.38664752]
mat_Sqrt:  [[0.15]]
grads:  [0.00211422]
Stock Position:  0.0021142214714354435
Bond Position:  [10.13200318]


portfolio before change:  [10.34727955]
curr_Stock_Price:  101.52346577757903
curr_Factors:  [101.52346578]
mat_Sqrt:  [[0.15]]
grads:  [-0.03144431]
Stock Position:  -0.03144430769764938
Bond Position:  [13.53961464]


portfolio before change:  [10.3665345]
curr_Stock_Price:  100.93802762369401
curr_Factors:  [100.93802762]
mat_Sqrt:  [[0.15]]
grads:  [-0.04202504]
Stock Position:  -0.04202503767472647
Bond Position:  [14.60845891]


portfolio before change:  [10.3828664]
curr_Stock_Price:  100.57113082841116
curr_Factors:  [100.57113083]
mat_Sqrt:  [[0.15]]
grads:  [0.09355997]
Stock Position:  0.09355997484146791
Bond Position:  [0.97343393]


portfolio before change:  [10.4290361]
curr_Stock_Price:  101.06395749159549
curr_Factors:  [101.06395749]
mat_Sqrt:  [[0.15]]
grads:  [-0.00717771]
Stock Position:  -0.007177711791280484
Bond Position:  [11.15444406]


portfolio before change:  [10.4336016]
curr_Stock_Price:  100.52502187369024
curr_Factors:  [100.52502187]
mat_Sqrt:  [[0.15]]
grads:  [-0.08498311]
Stock Position:  -0.08498310790268639
Bond Position:  [18.97653038]


portfolio before change:  [10.46604822]
curr_Stock_Price:  100.15717748792811
curr_Factors:  [100.15717749]
mat_Sqrt:  [[0.15]]
grads:  [-0.00746593]
Stock Position:  -0.00746593453527925
Bond Position:  [11.21381515]


portfolio before change:  [10.4628827]
curr_Stock_Price:  100.67505100656848
curr_Factors:  [100.67505101]
mat_Sqrt:  [[0.15]]
grads:  [-0.01912912]
Stock Position:  -0.019129124455603563
Bond Position:  [12.38870828]


portfolio before change:  [10.47733934]
curr_Stock_Price:  99.95978976635256
curr_Factors:  [99.95978977]
mat_Sqrt:  [[0.15]]
grads:  [0.03652678]
Stock Position:  0.036526779085673665
Bond Position:  [6.82613018]


portfolio before change:  [10.42490789]
curr_Stock_Price:  98.51268455771304
curr_Factors:  [98.51268456]
mat_Sqrt:  [[0.15]]
grads:  [-0.05245003]
Stock Position:  -0.05245003417607346
Bond Position:  [15.59190157]


portfolio before change:  [10.38417366]
curr_Stock_Price:  99.3078939066887
curr_Factors:  [99.30789391]
mat_Sqrt:  [[0.15]]
grads:  [0.01743174]
Stock Position:  0.01743173606655243
Bond Position:  [8.65306466]


portfolio before change:  [10.39194449]
curr_Stock_Price:  99.7226546732287
curr_Factors:  [99.72265467]
mat_Sqrt:  [[0.15]]
grads:  [-0.0127602]
Stock Position:  -0.012760195693536844
Bond Position:  [11.66442508]


portfolio before change:  [10.3964286]
curr_Stock_Price:  99.42837558173687
curr_Factors:  [99.42837558]
mat_Sqrt:  [[0.15]]
grads:  [-0.09128893]
Stock Position:  -0.09128893121627223
Bond Position:  [19.47313874]


portfolio before change:  [10.43155482]
curr_Stock_Price:  99.05692738923037
curr_Factors:  [99.05692739]
mat_Sqrt:  [[0.15]]
grads:  [-0.01457446]
Stock Position:  -0.014574457089597847
Bond Position:  [11.87525576]


portfolio before change:  [10.43600002]
curr_Stock_Price:  98.80285489092319
curr_Factors:  [98.80285489]
mat_Sqrt:  [[0.15]]
grads:  [-0.05458049]
Stock Position:  -0.054580489271146344
Bond Position:  [15.82870818]


portfolio before change:  [10.44791045]
curr_Stock_Price:  98.60276313637308
curr_Factors:  [98.60276314]
mat_Sqrt:  [[0.15]]
grads:  [0.05970349]
Stock Position:  0.05970348586865471
Bond Position:  [4.56098177]


portfolio before change:  [10.42069735]
curr_Stock_Price:  98.14218417054484
curr_Factors:  [98.14218417]
mat_Sqrt:  [[0.15]]
grads:  [-0.02140968]
Stock Position:  -0.02140968237236118
Bond Position:  [12.52189034]


portfolio before change:  [10.41225986]
curr_Stock_Price:  98.57283636261477
curr_Factors:  [98.57283636]
mat_Sqrt:  [[0.15]]
grads:  [0.02165629]
Stock Position:  0.021656293781308532
Bond Position:  [8.27753756]


portfolio before change:  [10.42319649]
curr_Stock_Price:  99.05395596579713
curr_Factors:  [99.05395597]
mat_Sqrt:  [[0.15]]
grads:  [0.01603519]
Stock Position:  0.01603519171035591
Bond Position:  [8.83484732]


portfolio before change:  [10.42219925]
curr_Stock_Price:  98.95732874808228
curr_Factors:  [98.95732875]
mat_Sqrt:  [[0.15]]
grads:  [0.00040261]
Stock Position:  0.0004026066118931309
Bond Position:  [10.38235838]


portfolio before change:  [10.42324924]
curr_Stock_Price:  99.95351720609163
curr_Factors:  [99.95351721]
mat_Sqrt:  [[0.15]]
grads:  [0.01513182]
Stock Position:  0.01513182151565965
Bond Position:  [8.91077046]


portfolio before change:  [10.4204953]
curr_Stock_Price:  99.73471482370992
curr_Factors:  [99.73471482]
mat_Sqrt:  [[0.15]]
grads:  [0.06007637]
Stock Position:  0.060076373882253245
Bond Position:  [4.42879529]


portfolio before change:  [10.40522885]
curr_Stock_Price:  99.47598971437864
curr_Factors:  [99.47598971]
mat_Sqrt:  [[0.15]]
grads:  [0.11722612]
Stock Position:  0.11722611757672953
Bond Position:  [-1.25595522]


portfolio before change:  [10.44244203]
curr_Stock_Price:  99.79410727274664
curr_Factors:  [99.79410727]
mat_Sqrt:  [[0.15]]
grads:  [-0.18016229]
Stock Position:  -0.18016229195458103
Bond Position:  [28.42157712]


portfolio before change:  [10.47293956]
curr_Stock_Price:  99.63468919203233
curr_Factors:  [99.63468919]
mat_Sqrt:  [[0.15]]
grads:  [0.09346414]
Stock Position:  0.09346413805592899
Bond Position:  [1.16066922]


portfolio before change:  [10.46131861]
curr_Stock_Price:  99.50957703557114
curr_Factors:  [99.50957704]
mat_Sqrt:  [[0.15]]
grads:  [0.04203002]
Stock Position:  0.04203001973912533
Bond Position:  [6.27892912]


portfolio before change:  [10.45033157]
curr_Stock_Price:  99.23883055999852
curr_Factors:  [99.23883056]
mat_Sqrt:  [[0.15]]
grads:  [0.03543393]
Stock Position:  0.03543392521721071
Bond Position:  [6.93391027]


portfolio before change:  [10.444679]
curr_Stock_Price:  99.06707551692224
curr_Factors:  [99.06707552]
mat_Sqrt:  [[0.15]]
grads:  [-0.08886496]
Stock Position:  -0.08886495993759258
Bond Position:  [19.2482707]


portfolio before change:  [10.3804379]
curr_Stock_Price:  99.80352055942731
curr_Factors:  [99.80352056]
mat_Sqrt:  [[0.15]]
grads:  [-0.08359556]
Stock Position:  -0.08359556166450448
Bond Position:  [18.72356925]


portfolio before change:  [10.34173485]
curr_Stock_Price:  100.28049928292118
curr_Factors:  [100.28049928]
mat_Sqrt:  [[0.15]]
grads:  [-0.01462506]
Stock Position:  -0.014625055449309634
Bond Position:  [11.80834271]


portfolio before change:  [10.33542575]
curr_Stock_Price:  100.7623537476006
curr_Factors:  [100.76235375]
mat_Sqrt:  [[0.15]]
grads:  [-0.13434476]
Stock Position:  -0.1343447563438707
Bond Position:  [23.87231961]


portfolio before change:  [10.43504802]
curr_Stock_Price:  100.03191808730418
curr_Factors:  [100.03191809]
mat_Sqrt:  [[0.15]]
grads:  [0.27512463]
Stock Position:  0.2751246343008716
Bond Position:  [-17.08619687]


portfolio before change:  [10.60095064]
curr_Stock_Price:  100.63880866891544
curr_Factors:  [100.63880867]
mat_Sqrt:  [[0.15]]
grads:  [0.13330924]
Stock Position:  0.1333092357523976
Bond Position:  [-2.81513203]


portfolio before change:  [10.66867191]
curr_Stock_Price:  101.14812982800221
curr_Factors:  [101.14812983]
mat_Sqrt:  [[0.15]]
grads:  [0.01296069]
Stock Position:  0.012960686953440253
Bond Position:  [9.35772266]


portfolio before change:  [10.66400924]
curr_Stock_Price:  100.74324833484097
curr_Factors:  [100.74324833]
mat_Sqrt:  [[0.15]]
grads:  [0.0411025]
Stock Position:  0.041102499347818205
Bond Position:  [6.52320994]


portfolio before change:  [10.68506053]
curr_Stock_Price:  101.24549450017882
curr_Factors:  [101.2454945]
mat_Sqrt:  [[0.15]]
grads:  [-0.09091231]
Stock Position:  -0.09091230504126208
Bond Position:  [19.88952181]


portfolio before change:  [10.68559911]
curr_Stock_Price:  101.25324432438136
curr_Factors:  [101.25324432]
mat_Sqrt:  [[0.15]]
grads:  [-0.05552215]
Stock Position:  -0.0555221524691708
Bond Position:  [16.30739718]


portfolio before change:  [10.63984756]
curr_Stock_Price:  102.09562512503024
curr_Factors:  [102.09562513]
mat_Sqrt:  [[0.15]]
grads:  [-0.05194909]
Stock Position:  -0.05194909279164043
Bond Position:  [15.94362266]


portfolio before change:  [10.63255344]
curr_Stock_Price:  102.25521645474812
curr_Factors:  [102.25521645]
mat_Sqrt:  [[0.15]]
grads:  [0.01070257]
Stock Position:  0.010702567577326414
Bond Position:  [9.53816007]


portfolio before change:  [10.6279001]
curr_Stock_Price:  101.76472741188
curr_Factors:  [101.76472741]
mat_Sqrt:  [[0.15]]
grads:  [0.05497248]
Stock Position:  0.05497247887403019
Bond Position:  [5.03364077]


portfolio before change:  [10.61763389]
curr_Stock_Price:  101.57225255695177
curr_Factors:  [101.57225256]
mat_Sqrt:  [[0.15]]
grads:  [0.03112281]
Stock Position:  0.031122811029904482
Bond Position:  [7.45641987]


portfolio before change:  [10.63150683]
curr_Stock_Price:  102.00302641399401
curr_Factors:  [102.00302641]
mat_Sqrt:  [[0.15]]
grads:  [-0.08085682]
Stock Position:  -0.08085681579621286
Bond Position:  [18.87914674]


portfolio before change:  [10.61525354]
curr_Stock_Price:  102.21863307709995
curr_Factors:  [102.21863308]
mat_Sqrt:  [[0.15]]
grads:  [0.03287261]
Stock Position:  0.032872606953511824
Bond Position:  [7.25506059]


portfolio before change:  [10.61329746]
curr_Stock_Price:  102.14533376733658
curr_Factors:  [102.14533377]
mat_Sqrt:  [[0.15]]
grads:  [-0.03359872]
Stock Position:  -0.03359871912167716
Bond Position:  [14.04524984]


portfolio before change:  [10.61010918]
curr_Stock_Price:  102.26635414646478
curr_Factors:  [102.26635415]
mat_Sqrt:  [[0.15]]
grads:  [0.11560398]
Stock Position:  0.1156039766711189
Bond Position:  [-1.21228804]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.61010918]
Stock Price:  101.5558189668624
PL:  [9.05429022]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-6.58953127e-02]
 [-2.32542944e-03]
 [ 2.83572510e-04]
 [ 1.78376479e-03]
 [ 1.29172785e-02]
 [ 1.19197300e-02]
 [ 9.11426372e-04]
 [ 6.80652889e-03]
 [-4.79365656e-03]
 [-2.04386256e-02]
 [ 1.02803020e-02]
 [-5.93766729e-03]
 [-6.10896869e-03]
 [ 4.30509624e-03]
 [-1.51131981e-03]
 [ 9.26013716e-03]
 [-8.10504849e-04]
 [ 5.55063160e-03]
 [ 1.65371509e-02]
 [ 1.37193903e-02]
 [ 3.88459900e-02]
 [-1.99560758e-02]
 [-1.05331482e-03]
 [ 1.28331608e-02]
 [ 1.16695770e-02]
 [-7.14791857e-03]
 [ 1.28808692e-02]
 [-7.72496193e-03]
 [ 2.47124669e-03]
 [-1.99317065e-02]
 [-4.96109248e-03]
 [ 1.32949692e-02]
 [ 1.19645517e-02]
 [ 1.50169610e-02]
 [ 2.64017109e-03]
 [-2.85589149e-03]
 [-5.69003475e-03]
 [ 1.19833708e-02]
 [ 7.40694665e-04]
 [-1.45420290e-02]
 [ 3.39196540e-02]
 [ 1.16520450e-03]
 [ 6.46950903e-03]
 [-9.22918127e-03]
 [-1.20069399e-03]
 [-8.29082564e-03]
 [-1.34092944e-02]
 [ 6.33846047e-04]
 [-2.67188481e-03]
 [-2.55659736e-03]
 [-4.01491162e-03]
 [ 2.94758976e-03]
 [ 3.44834940e-03]
 [-7.67800469e-04]
 [ 5.91660034e-03]
 [ 8.87500555e-03]
 [ 1.12429011e-02]
 [ 7.10736264e-03]
 [ 1.35256222e-02]
 [-2.73264552e-03]
 [-1.78077334e-03]
 [-2.30464525e-02]
 [-1.28283113e-02]
 [-2.36890244e-03]
 [-7.23559990e-03]
 [ 1.39669103e-02]
 [ 8.97941170e-03]
 [ 1.76059974e-03]
 [ 1.42320616e-02]
 [-1.87377153e-02]
 [ 1.47983591e-02]
 [-3.06422147e-03]
 [-2.57321027e-03]
 [ 7.67799401e-03]
 [-4.28039106e-03]
 [ 3.44604650e-03]
 [ 1.28387700e-02]
 [-1.33721809e-02]
 [-4.80590707e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.85908421]
curr_Stock_Price:  100.62937922512194
curr_Factors:  [100.62937923]
mat_Sqrt:  [[0.15]]
grads:  [-0.43930208]
Stock Position:  -0.4393020848832957
Bond Position:  [56.06578031]


portfolio before change:  [12.09264834]
curr_Stock_Price:  100.10568512705352
curr_Factors:  [100.10568513]
mat_Sqrt:  [[0.15]]
grads:  [-0.01550286]
Stock Position:  -0.015502862925819323
Bond Position:  [13.64457306]


portfolio before change:  [12.09390966]
curr_Stock_Price:  100.07933475854912
curr_Factors:  [100.07933476]
mat_Sqrt:  [[0.15]]
grads:  [0.00189048]
Stock Position:  0.001890483398113736
Bond Position:  [11.90471134]


portfolio before change:  [12.09394702]
curr_Stock_Price:  99.70550877937318
curr_Factors:  [99.70550878]
mat_Sqrt:  [[0.15]]
grads:  [0.01189177]
Stock Position:  0.011891765237789348
Bond Position:  [10.90827251]


portfolio before change:  [12.10147024]
curr_Stock_Price:  100.28081688632284
curr_Factors:  [100.28081689]
mat_Sqrt:  [[0.15]]
grads:  [0.08611519]
Stock Position:  0.08611519014411785
Bond Position:  [3.46576862]


portfolio before change:  [12.15539028]
curr_Stock_Price:  100.90444008108317
curr_Factors:  [100.90444008]
mat_Sqrt:  [[0.15]]
grads:  [0.07946487]
Stock Position:  0.07946486656158468
Bond Position:  [4.13703242]


portfolio before change:  [12.13527567]
curr_Stock_Price:  100.64806027331366
curr_Factors:  [100.64806027]
mat_Sqrt:  [[0.15]]
grads:  [0.00607618]
Stock Position:  0.006076175810750638
Bond Position:  [11.52372036]


portfolio before change:  [12.1397225]
curr_Stock_Price:  101.26136993040897
curr_Factors:  [101.26136993]
mat_Sqrt:  [[0.15]]
grads:  [0.04537686]
Stock Position:  0.04537685923997961
Bond Position:  [7.54479957]


portfolio before change:  [12.13781069]
curr_Stock_Price:  101.20884580470938
curr_Factors:  [101.2088458]
mat_Sqrt:  [[0.15]]
grads:  [-0.03195771]
Stock Position:  -0.03195771038089482
Bond Position:  [15.37221367]


portfolio before change:  [12.15295425]
curr_Stock_Price:  100.76504764100095
curr_Factors:  [100.76504764]
mat_Sqrt:  [[0.15]]
grads:  [-0.1362575]
Stock Position:  -0.13625750411023882
Bond Position:  [25.88294815]


portfolio before change:  [12.15606576]
curr_Stock_Price:  100.7540847861648
curr_Factors:  [100.75408479]
mat_Sqrt:  [[0.15]]
grads:  [0.06853535]
Stock Position:  0.0685353469723447
Bond Position:  [5.2508496]


portfolio before change:  [12.13947437]
curr_Stock_Price:  100.50721099210617
curr_Factors:  [100.50721099]
mat_Sqrt:  [[0.15]]
grads:  [-0.03958445]
Stock Position:  -0.039584448613528375
Bond Position:  [16.11799689]


portfolio before change:  [12.14951293]
curr_Stock_Price:  100.27906174736184
curr_Factors:  [100.27906175]
mat_Sqrt:  [[0.15]]
grads:  [-0.04072646]
Stock Position:  -0.040726457947855975
Bond Position:  [16.23352392]


portfolio before change:  [12.1676061]
curr_Stock_Price:  99.8597141043485
curr_Factors:  [99.8597141]
mat_Sqrt:  [[0.15]]
grads:  [0.02870064]
Stock Position:  0.02870064160789056
Bond Position:  [9.30156824]


portfolio before change:  [12.14975209]
curr_Stock_Price:  99.21738062718468
curr_Factors:  [99.21738063]
mat_Sqrt:  [[0.15]]
grads:  [-0.01007547]
Stock Position:  -0.010075465400829568
Bond Position:  [13.14941337]


portfolio before change:  [12.14893646]
curr_Stock_Price:  99.37990360029275
curr_Factors:  [99.3799036]
mat_Sqrt:  [[0.15]]
grads:  [0.06173425]
Stock Position:  0.061734247737052356
Bond Position:  [6.01379287]


portfolio before change:  [12.12437205]
curr_Stock_Price:  98.97590932719386
curr_Factors:  [98.97590933]
mat_Sqrt:  [[0.15]]
grads:  [-0.00540337]
Stock Position:  -0.005403365658000228
Bond Position:  [12.65917508]


portfolio before change:  [12.12486424]
curr_Stock_Price:  99.03125142260704
curr_Factors:  [99.03125142]
mat_Sqrt:  [[0.15]]
grads:  [0.03700421]
Stock Position:  0.037004210661488186
Bond Position:  [8.46029095]


portfolio before change:  [12.11510886]
curr_Stock_Price:  98.75333266087456
curr_Factors:  [98.75333266]
mat_Sqrt:  [[0.15]]
grads:  [0.11024767]
Stock Position:  0.11024767251617523
Bond Position:  [1.22778378]


portfolio before change:  [12.07548713]
curr_Stock_Price:  98.39324827409138
curr_Factors:  [98.39324827]
mat_Sqrt:  [[0.15]]
grads:  [0.0914626]
Stock Position:  0.09146260169731425
Bond Position:  [3.07618466]


portfolio before change:  [12.10818654]
curr_Stock_Price:  98.74866282777081
curr_Factors:  [98.74866283]
mat_Sqrt:  [[0.15]]
grads:  [0.25897327]
Stock Position:  0.2589732663386351
Bond Position:  [-13.46507722]


portfolio before change:  [12.00997666]
curr_Stock_Price:  98.37268469294527
curr_Factors:  [98.37268469]
mat_Sqrt:  [[0.15]]
grads:  [-0.13304051]
Stock Position:  -0.1330405054751834
Bond Position:  [25.09752836]


portfolio before change:  [11.99341641]
curr_Stock_Price:  98.50895070258393
curr_Factors:  [98.5089507]
mat_Sqrt:  [[0.15]]
grads:  [-0.0070221]
Stock Position:  -0.007022098770454345
Bond Position:  [12.68515599]


portfolio before change:  [11.99306959]
curr_Stock_Price:  98.67124686599016
curr_Factors:  [98.67124687]
mat_Sqrt:  [[0.15]]
grads:  [0.08555441]
Stock Position:  0.0855544051660549
Bond Position:  [3.55130976]


portfolio before change:  [12.08407985]
curr_Stock_Price:  99.73242306032344
curr_Factors:  [99.73242306]
mat_Sqrt:  [[0.15]]
grads:  [0.07779718]
Stock Position:  0.07779718000875675
Bond Position:  [4.32517859]


portfolio before change:  [12.10799151]
curr_Stock_Price:  100.03630707040162
curr_Factors:  [100.03630707]
mat_Sqrt:  [[0.15]]
grads:  [-0.04765279]
Stock Position:  -0.04765279044283126
Bond Position:  [16.87500068]


portfolio before change:  [12.07651751]
curr_Stock_Price:  100.71892634190603
curr_Factors:  [100.71892634]
mat_Sqrt:  [[0.15]]
grads:  [0.08587246]
Stock Position:  0.08587246112165085
Bond Position:  [3.42753543]


portfolio before change:  [11.95331328]
curr_Stock_Price:  99.28169651416033
curr_Factors:  [99.28169651]
mat_Sqrt:  [[0.15]]
grads:  [-0.05149975]
Stock Position:  -0.0514997461802081
Bond Position:  [17.06629545]


portfolio before change:  [11.95419111]
curr_Stock_Price:  99.28536349195586
curr_Factors:  [99.28536349]
mat_Sqrt:  [[0.15]]
grads:  [0.01647498]
Stock Position:  0.016474977951082232
Bond Position:  [10.31846693]


portfolio before change:  [11.96160099]
curr_Stock_Price:  99.69598351067462
curr_Factors:  [99.69598351]
mat_Sqrt:  [[0.15]]
grads:  [-0.13287804]
Stock Position:  -0.13287804355333427
Bond Position:  [25.20900823]


portfolio before change:  [11.82625503]
curr_Stock_Price:  100.72641386324051
curr_Factors:  [100.72641386]
mat_Sqrt:  [[0.15]]
grads:  [-0.03307395]
Stock Position:  -0.03307394989317238
Bond Position:  [15.15767539]


portfolio before change:  [11.82471564]
curr_Stock_Price:  100.80160204785396
curr_Factors:  [100.80160205]
mat_Sqrt:  [[0.15]]
grads:  [0.08863313]
Stock Position:  0.08863312786285041
Bond Position:  [2.89035436]


portfolio before change:  [11.80418722]
curr_Stock_Price:  100.56795261227438
curr_Factors:  [100.56795261]
mat_Sqrt:  [[0.15]]
grads:  [0.07976368]
Stock Position:  0.07976367816859188
Bond Position:  [3.78251741]


portfolio before change:  [11.78812998]
curr_Stock_Price:  100.36367848470914
curr_Factors:  [100.36367848]
mat_Sqrt:  [[0.15]]
grads:  [0.10011307]
Stock Position:  0.10011307325907234
Bond Position:  [1.74041368]


portfolio before change:  [11.8555262]
curr_Stock_Price:  101.03579294322809
curr_Factors:  [101.03579294]
mat_Sqrt:  [[0.15]]
grads:  [0.01760114]
Stock Position:  0.01760114060327845
Bond Position:  [10.077181]


portfolio before change:  [11.84860356]
curr_Stock_Price:  100.6067025455606
curr_Factors:  [100.60670255]
mat_Sqrt:  [[0.15]]
grads:  [-0.01903928]
Stock Position:  -0.019039276567161045
Bond Position:  [13.7640824]


portfolio before change:  [11.847604]
curr_Stock_Price:  100.70438718871434
curr_Factors:  [100.70438719]
mat_Sqrt:  [[0.15]]
grads:  [-0.03793357]
Stock Position:  -0.037933565025170465
Bond Position:  [15.66768042]


portfolio before change:  [11.87947479]
curr_Stock_Price:  99.8900283911223
curr_Factors:  [99.89002839]
mat_Sqrt:  [[0.15]]
grads:  [0.07988914]
Stock Position:  0.0798891389407481
Bond Position:  [3.89934644]


portfolio before change:  [11.83414021]
curr_Stock_Price:  99.31950903367495
curr_Factors:  [99.31950903]
mat_Sqrt:  [[0.15]]
grads:  [0.00493796]
Stock Position:  0.004937964432824054
Bond Position:  [11.34370401]


portfolio before change:  [11.83002463]
curr_Stock_Price:  98.34247079539652
curr_Factors:  [98.3424708]
mat_Sqrt:  [[0.15]]
grads:  [-0.09694686]
Stock Position:  -0.09694685982740277
Bond Position:  [21.36401836]


portfolio before change:  [11.8949474]
curr_Stock_Price:  97.68657044999426
curr_Factors:  [97.68657045]
mat_Sqrt:  [[0.15]]
grads:  [0.22613103]
Stock Position:  0.22613102650484232
Bond Position:  [-10.19501705]


portfolio before change:  [11.58898041]
curr_Stock_Price:  96.3363365370845
curr_Factors:  [96.33633654]
mat_Sqrt:  [[0.15]]
grads:  [0.00776803]
Stock Position:  0.0077680300211909175
Bond Position:  [10.84063686]


portfolio before change:  [11.59267972]
curr_Stock_Price:  96.72533396750332
curr_Factors:  [96.72533397]
mat_Sqrt:  [[0.15]]
grads:  [0.04313006]
Stock Position:  0.04313006023180445
Bond Position:  [7.42091024]


portfolio before change:  [11.56179772]
curr_Stock_Price:  95.9985597024678
curr_Factors:  [95.9985597]
mat_Sqrt:  [[0.15]]
grads:  [-0.06152788]
Stock Position:  -0.061527875142212966
Bond Position:  [17.46838512]


portfolio before change:  [11.54800136]
curr_Stock_Price:  96.24053411250716
curr_Factors:  [96.24053411]
mat_Sqrt:  [[0.15]]
grads:  [-0.00800463]
Stock Position:  -0.00800462662426884
Bond Position:  [12.3183709]


portfolio before change:  [11.54378436]
curr_Stock_Price:  96.8635393805213
curr_Factors:  [96.86353938]
mat_Sqrt:  [[0.15]]
grads:  [-0.05527217]
Stock Position:  -0.05527217095843193
Bond Position:  [16.89764247]


portfolio before change:  [11.55874751]
curr_Stock_Price:  96.61192969786852
curr_Factors:  [96.6119297]
mat_Sqrt:  [[0.15]]
grads:  [-0.0893953]
Stock Position:  -0.08939529592578765
Bond Position:  [20.19539955]


portfolio before change:  [11.61835605]
curr_Stock_Price:  95.95925232201444
curr_Factors:  [95.95925232]
mat_Sqrt:  [[0.15]]
grads:  [0.00422564]
Stock Position:  0.004225640313967443
Bond Position:  [11.21286676]


portfolio before change:  [11.61978033]
curr_Stock_Price:  96.1304588333027
curr_Factors:  [96.13045883]
mat_Sqrt:  [[0.15]]
grads:  [-0.01781257]
Stock Position:  -0.017812565427256854
Bond Position:  [13.33211042]


portfolio before change:  [11.61466198]
curr_Stock_Price:  96.46458407722314
curr_Factors:  [96.46458408]
mat_Sqrt:  [[0.15]]
grads:  [-0.01704398]
Stock Position:  -0.01704398242522099
Bond Position:  [13.25880266]


portfolio before change:  [11.62643955]
curr_Stock_Price:  95.82219541012172
curr_Factors:  [95.82219541]
mat_Sqrt:  [[0.15]]
grads:  [-0.02676608]
Stock Position:  -0.026766077438115134
Bond Position:  [14.19122385]


portfolio before change:  [11.60218098]
curr_Stock_Price:  96.76165120989339
curr_Factors:  [96.76165121]
mat_Sqrt:  [[0.15]]
grads:  [0.0196506]
Stock Position:  0.019650598408926544
Bond Position:  [9.70075663]


portfolio before change:  [11.60395436]
curr_Stock_Price:  96.82104209509193
curr_Factors:  [96.8210421]
mat_Sqrt:  [[0.15]]
grads:  [0.022989]
Stock Position:  0.022988995989491764
Bond Position:  [9.37813581]


portfolio before change:  [11.58043686]
curr_Stock_Price:  95.7725554374476
curr_Factors:  [95.77255544]
mat_Sqrt:  [[0.15]]
grads:  [-0.00511867]
Stock Position:  -0.005118669795912814
Bond Position:  [12.07066494]


portfolio before change:  [11.57688516]
curr_Stock_Price:  96.61381606706314
curr_Factors:  [96.61381607]
mat_Sqrt:  [[0.15]]
grads:  [0.039444]
Stock Position:  0.039444002243462305
Bond Position:  [7.76604958]


portfolio before change:  [11.58741963]
curr_Stock_Price:  96.8685841821011
curr_Factors:  [96.86858418]
mat_Sqrt:  [[0.15]]
grads:  [0.0591667]
Stock Position:  0.05916670368522652
Bond Position:  [5.85602481]


portfolio before change:  [11.56851966]
curr_Stock_Price:  96.5429621420262
curr_Factors:  [96.54296214]
mat_Sqrt:  [[0.15]]
grads:  [0.07495267]
Stock Position:  0.07495267379904093
Bond Position:  [4.33236651]


portfolio before change:  [11.55177751]
curr_Stock_Price:  96.31597989225108
curr_Factors:  [96.31597989]
mat_Sqrt:  [[0.15]]
grads:  [0.04738242]
Stock Position:  0.047382417571086986
Bond Position:  [6.98809354]


portfolio before change:  [11.57915617]
curr_Stock_Price:  96.88458492501037
curr_Factors:  [96.88458493]
mat_Sqrt:  [[0.15]]
grads:  [0.09017081]
Stock Position:  0.09017081461939593
Bond Position:  [2.84299422]


portfolio before change:  [11.52069846]
curr_Stock_Price:  96.23431462524667
curr_Factors:  [96.23431463]
mat_Sqrt:  [[0.15]]
grads:  [-0.01821764]
Stock Position:  -0.01821763679805941
Bond Position:  [13.27386025]


portfolio before change:  [11.52173587]
curr_Stock_Price:  96.22290960225898
curr_Factors:  [96.2229096]
mat_Sqrt:  [[0.15]]
grads:  [-0.01187182]
Stock Position:  -0.011871822262805178
Bond Position:  [12.66407715]


portfolio before change:  [11.52679493]
curr_Stock_Price:  95.86344271480863
curr_Factors:  [95.86344271]
mat_Sqrt:  [[0.15]]
grads:  [-0.15364302]
Stock Position:  -0.15364301657344795
Bond Position:  [26.25554344]


portfolio before change:  [11.5363189]
curr_Stock_Price:  95.81213580126571
curr_Factors:  [95.8121358]
mat_Sqrt:  [[0.15]]
grads:  [-0.08552208]
Stock Position:  -0.08552207544883678
Bond Position:  [19.73037161]


portfolio before change:  [11.53966568]
curr_Stock_Price:  95.7874218221166
curr_Factors:  [95.78742182]
mat_Sqrt:  [[0.15]]
grads:  [-0.01579268]
Stock Position:  -0.01579268294184561
Bond Position:  [13.05240606]


portfolio before change:  [11.54759616]
curr_Stock_Price:  95.33691688983265
curr_Factors:  [95.33691689]
mat_Sqrt:  [[0.15]]
grads:  [-0.04823733]
Stock Position:  -0.04823733265570355
Bond Position:  [16.14639473]


portfolio before change:  [11.541099]
curr_Stock_Price:  95.49252951729048
curr_Factors:  [95.49252952]
mat_Sqrt:  [[0.15]]
grads:  [0.09311274]
Stock Position:  0.09311273508653962
Bond Position:  [2.6495284]


portfolio before change:  [11.60141022]
curr_Stock_Price:  96.13847356051805
curr_Factors:  [96.13847356]
mat_Sqrt:  [[0.15]]
grads:  [0.05986274]
Stock Position:  0.059862744673694616
Bond Position:  [5.84629732]


portfolio before change:  [11.56983492]
curr_Stock_Price:  95.60490795870201
curr_Factors:  [95.60490796]
mat_Sqrt:  [[0.15]]
grads:  [0.01173733]
Stock Position:  0.011737331600376408
Bond Position:  [10.44768842]


portfolio before change:  [11.56680832]
curr_Stock_Price:  95.2914118500523
curr_Factors:  [95.29141185]
mat_Sqrt:  [[0.15]]
grads:  [0.09488041]
Stock Position:  0.09488041041633716
Bond Position:  [2.52552005]


portfolio before change:  [11.63738818]
curr_Stock_Price:  96.03363051594013
curr_Factors:  [96.03363052]
mat_Sqrt:  [[0.15]]
grads:  [-0.1249181]
Stock Position:  -0.12491810219919702
Bond Position:  [23.63372705]


portfolio before change:  [11.6910296]
curr_Stock_Price:  95.61604279231163
curr_Factors:  [95.61604279]
mat_Sqrt:  [[0.15]]
grads:  [0.09865573]
Stock Position:  0.09865572700162306
Bond Position:  [2.25795938]


portfolio before change:  [11.74480886]
curr_Stock_Price:  96.15973287870393
curr_Factors:  [96.15973288]
mat_Sqrt:  [[0.15]]
grads:  [-0.02042814]
Stock Position:  -0.020428143119478957
Bond Position:  [13.70917365]


portfolio before change:  [11.74912534]
curr_Stock_Price:  95.99037700219289
curr_Factors:  [95.990377]
mat_Sqrt:  [[0.15]]
grads:  [-0.01715474]
Stock Position:  -0.017154735151713493
Bond Position:  [13.39581484]


portfolio before change:  [11.75435827]
curr_Stock_Price:  95.73414068785836
curr_Factors:  [95.73414069]
mat_Sqrt:  [[0.15]]
grads:  [0.05118663]
Stock Position:  0.05118662670225792
Bond Position:  [6.85405055]


portfolio before change:  [11.75307616]
curr_Stock_Price:  95.70072362042367
curr_Factors:  [95.70072362]
mat_Sqrt:  [[0.15]]
grads:  [-0.02853594]
Stock Position:  -0.02853594038327016
Bond Position:  [14.4839863]


portfolio before change:  [11.78424025]
curr_Stock_Price:  94.64034784517305
curr_Factors:  [94.64034785]
mat_Sqrt:  [[0.15]]
grads:  [0.02297364]
Stock Position:  0.022973643346521598
Bond Position:  [9.61000666]


portfolio before change:  [11.79446936]
curr_Stock_Price:  95.05945700703182
curr_Factors:  [95.05945701]
mat_Sqrt:  [[0.15]]
grads:  [0.0855918]
Stock Position:  0.0855918001971751
Bond Position:  [3.65815931]


portfolio before change:  [11.7977147]
curr_Stock_Price:  95.09470215312514
curr_Factors:  [95.09470215]
mat_Sqrt:  [[0.15]]
grads:  [-0.08914787]
Stock Position:  -0.08914787277834664
Bond Position:  [20.27520511]


portfolio before change:  [11.80437567]
curr_Stock_Price:  95.03419891958126
curr_Factors:  [95.03419892]
mat_Sqrt:  [[0.15]]
grads:  [-0.3203938]
Stock Position:  -0.3203938045279445
Bond Position:  [42.25274423]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.80437567]
Stock Price:  95.61232752772395
PL:  [11.80437567]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.41532764e-02]
 [-2.33649203e-03]
 [ 3.02954003e-04]
 [ 2.16859983e-03]
 [ 1.83192793e-02]
 [ 1.05352692e-02]
 [ 1.22230141e-03]
 [ 1.03609512e-02]
 [ 1.60022369e-02]
 [-1.89605576e-02]
 [ 7.85105535e-03]
 [-5.02413608e-03]
 [-9.77187045e-03]
 [ 4.36612616e-03]
 [-9.74515692e-04]
 [ 1.39159750e-02]
 [-1.10911683e-03]
 [ 4.36653966e-03]
 [ 8.86202330e-03]
 [ 1.41904346e-02]
 [ 1.34209475e-02]
 [-2.03692052e-02]
 [-1.03612997e-03]
 [ 1.42464032e-02]
 [-2.35708067e-03]
 [ 1.69719796e-02]
 [ 1.62920271e-02]
 [ 1.37646722e-02]
 [ 6.78327215e-04]
 [ 3.62324078e-03]
 [-3.43136983e-03]
 [-2.92547899e-02]
 [ 2.21366283e-02]
 [ 1.15614062e-02]
 [-3.14410840e-02]
 [ 8.20486374e-03]
 [-1.42335483e-03]
 [-2.78656277e-03]
 [ 6.14301748e-03]
 [-1.68110979e-02]
 [ 4.74579514e-02]
 [ 1.29223244e-03]
 [ 6.38877830e-03]
 [-8.92229196e-03]
 [-9.37179024e-04]
 [-1.03277705e-02]
 [-1.34839874e-02]
 [ 1.75957172e-05]
 [-2.67590264e-03]
 [-5.91153569e-03]
 [-4.08094871e-03]
 [ 2.80644667e-03]
 [ 3.87789354e-03]
 [-1.58885120e-03]
 [ 1.48357103e-02]
 [ 8.96854048e-03]
 [ 2.46847735e-03]
 [ 1.32284807e-02]
 [ 1.30725488e-02]
 [-3.95644200e-03]
 [-3.88543295e-03]
 [-2.24468701e-02]
 [-1.27676380e-02]
 [-1.73466209e-03]
 [-9.32218809e-03]
 [-9.60698734e-03]
 [ 9.72404064e-03]
 [ 2.23396252e-03]
 [ 9.78548300e-03]
 [-1.74717680e-02]
 [ 5.12193288e-03]
 [ 1.59928210e-03]
 [-1.70478643e-03]
 [ 7.66373864e-03]
 [-5.35834917e-03]
 [ 3.31319035e-03]
 [ 1.21691775e-02]
 [-1.43251671e-02]
 [-4.98997266e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.04487602]
curr_Stock_Price:  100.25569622948926
curr_Factors:  [100.25569623]
mat_Sqrt:  [[0.15]]
grads:  [-0.29435518]
Stock Position:  -0.2943551763297812
Bond Position:  [35.55565916]


portfolio before change:  [6.11234429]
curr_Stock_Price:  100.03403895340215
curr_Factors:  [100.03403895]
mat_Sqrt:  [[0.15]]
grads:  [-0.01557661]
Stock Position:  -0.015576613522741287
Bond Position:  [7.67053585]


portfolio before change:  [6.11735168]
curr_Stock_Price:  99.74334871157164
curr_Factors:  [99.74334871]
mat_Sqrt:  [[0.15]]
grads:  [0.00201969]
Stock Position:  0.002019693352962766
Bond Position:  [5.9159007]


portfolio before change:  [6.1182046]
curr_Stock_Price:  99.98257567645875
curr_Factors:  [99.98257568]
mat_Sqrt:  [[0.15]]
grads:  [0.01445733]
Stock Position:  0.01445733223047097
Bond Position:  [4.67272329]


portfolio before change:  [6.11949807]
curr_Stock_Price:  100.0518424320329
curr_Factors:  [100.05184243]
mat_Sqrt:  [[0.15]]
grads:  [0.12212853]
Stock Position:  0.122128528553871
Bond Position:  [-6.09968623]


portfolio before change:  [6.04616145]
curr_Stock_Price:  99.4544768930377
curr_Factors:  [99.45447689]
mat_Sqrt:  [[0.15]]
grads:  [0.07023513]
Stock Position:  0.07023512788365589
Bond Position:  [-0.93903645]


portfolio before change:  [6.0998739]
curr_Stock_Price:  100.22006445964578
curr_Factors:  [100.22006446]
mat_Sqrt:  [[0.15]]
grads:  [0.00814868]
Stock Position:  0.008148676038885265
Bond Position:  [5.28321306]


portfolio before change:  [6.10001461]
curr_Stock_Price:  100.19680901425808
curr_Factors:  [100.19680901]
mat_Sqrt:  [[0.15]]
grads:  [0.06907301]
Stock Position:  0.06907300816987431
Bond Position:  [-0.8208804]


portfolio before change:  [6.06875561]
curr_Stock_Price:  99.74500166220601
curr_Factors:  [99.74500166]
mat_Sqrt:  [[0.15]]
grads:  [0.10668158]
Stock Position:  0.10668157935916937
Bond Position:  [-4.5721987]


portfolio before change:  [6.05467977]
curr_Stock_Price:  99.6157378561817
curr_Factors:  [99.61573786]
mat_Sqrt:  [[0.15]]
grads:  [-0.12640372]
Stock Position:  -0.1264037174666493
Bond Position:  [18.64647935]


portfolio before change:  [6.03805404]
curr_Stock_Price:  99.75648669310831
curr_Factors:  [99.75648669]
mat_Sqrt:  [[0.15]]
grads:  [0.05234037]
Stock Position:  0.05234036901983655
Bond Position:  [0.81676271]


portfolio before change:  [6.057745]
curr_Stock_Price:  100.13172123887217
curr_Factors:  [100.13172124]
mat_Sqrt:  [[0.15]]
grads:  [-0.03349424]
Stock Position:  -0.033494240500365265
Bond Position:  [9.41158095]


portfolio before change:  [6.06516519]
curr_Stock_Price:  99.92774754410138
curr_Factors:  [99.92774754]
mat_Sqrt:  [[0.15]]
grads:  [-0.0651458]
Stock Position:  -0.06514580301186684
Bond Position:  [12.57503854]


portfolio before change:  [6.0800558]
curr_Stock_Price:  99.71123858712434
curr_Factors:  [99.71123859]
mat_Sqrt:  [[0.15]]
grads:  [0.02910751]
Stock Position:  0.029107507746260596
Bond Position:  [3.17771015]


portfolio before change:  [6.06817007]
curr_Stock_Price:  99.29607626055063
curr_Factors:  [99.29607626]
mat_Sqrt:  [[0.15]]
grads:  [-0.00649677]
Stock Position:  -0.0064967712783816035
Bond Position:  [6.71327397]


portfolio before change:  [6.07247668]
curr_Stock_Price:  98.69777702671139
curr_Factors:  [98.69777703]
mat_Sqrt:  [[0.15]]
grads:  [0.09277317]
Stock Position:  0.09277316671876921
Bond Position:  [-3.08402864]


portfolio before change:  [6.09057358]
curr_Stock_Price:  98.89492092444287
curr_Factors:  [98.89492092]
mat_Sqrt:  [[0.15]]
grads:  [-0.00739411]
Stock Position:  -0.007394112196349321
Bond Position:  [6.82181373]


portfolio before change:  [6.0934147]
curr_Stock_Price:  98.5683456607398
curr_Factors:  [98.56834566]
mat_Sqrt:  [[0.15]]
grads:  [0.02911026]
Stock Position:  0.02911026438250791
Bond Position:  [3.22406409]


portfolio before change:  [6.08419903]
curr_Stock_Price:  98.24484541978617
curr_Factors:  [98.24484542]
mat_Sqrt:  [[0.15]]
grads:  [0.05908016]
Stock Position:  0.05908015531450202
Bond Position:  [0.2798783]


portfolio before change:  [6.05845762]
curr_Stock_Price:  97.80884614578598
curr_Factors:  [97.80884615]
mat_Sqrt:  [[0.15]]
grads:  [0.0946029]
Stock Position:  0.09460289764099827
Bond Position:  [-3.19454264]


portfolio before change:  [6.09673187]
curr_Stock_Price:  98.21553477997887
curr_Factors:  [98.21553478]
mat_Sqrt:  [[0.15]]
grads:  [0.08947298]
Stock Position:  0.08947298301167583
Bond Position:  [-2.690905]


portfolio before change:  [6.10342663]
curr_Stock_Price:  98.2922388091989
curr_Factors:  [98.29223881]
mat_Sqrt:  [[0.15]]
grads:  [-0.1357947]
Stock Position:  -0.13579470137861424
Bond Position:  [19.45099184]


portfolio before change:  [6.08067292]
curr_Stock_Price:  98.46875104270183
curr_Factors:  [98.46875104]
mat_Sqrt:  [[0.15]]
grads:  [-0.00690753]
Stock Position:  -0.006907533110036788
Bond Position:  [6.76084908]


portfolio before change:  [6.07795443]
curr_Stock_Price:  98.92348141930535
curr_Factors:  [98.92348142]
mat_Sqrt:  [[0.15]]
grads:  [0.09497602]
Stock Position:  0.09497602147862091
Bond Position:  [-3.31740427]


portfolio before change:  [5.91770627]
curr_Stock_Price:  97.23841601892697
curr_Factors:  [97.23841602]
mat_Sqrt:  [[0.15]]
grads:  [-0.01571387]
Stock Position:  -0.015713871113978782
Bond Position:  [7.44569821]


portfolio before change:  [5.924383]
curr_Stock_Price:  96.8431376248895
curr_Factors:  [96.84313762]
mat_Sqrt:  [[0.15]]
grads:  [0.11314653]
Stock Position:  0.1131465305216188
Bond Position:  [-5.03308203]


portfolio before change:  [5.94346663]
curr_Stock_Price:  97.01458086417429
curr_Factors:  [97.01458086]
mat_Sqrt:  [[0.15]]
grads:  [0.10861351]
Stock Position:  0.10861351418159643
Bond Position:  [-4.59362793]


portfolio before change:  [5.91107765]
curr_Stock_Price:  96.71902031599761
curr_Factors:  [96.71902032]
mat_Sqrt:  [[0.15]]
grads:  [0.09176448]
Stock Position:  0.0917644810345211
Bond Position:  [-2.96429306]


portfolio before change:  [5.93134299]
curr_Stock_Price:  96.94188013848203
curr_Factors:  [96.94188014]
mat_Sqrt:  [[0.15]]
grads:  [0.00452218]
Stock Position:  0.004522181435716557
Bond Position:  [5.49295422]


portfolio before change:  [5.93021046]
curr_Stock_Price:  96.61552313815466
curr_Factors:  [96.61552314]
mat_Sqrt:  [[0.15]]
grads:  [0.02415494]
Stock Position:  0.02415493850630803
Bond Position:  [3.59646844]


portfolio before change:  [5.91921986]
curr_Stock_Price:  96.15121266436786
curr_Factors:  [96.15121266]
mat_Sqrt:  [[0.15]]
grads:  [-0.0228758]
Stock Position:  -0.022875798893103875
Bond Position:  [8.11875566]


portfolio before change:  [5.91217598]
curr_Stock_Price:  96.48131337570382
curr_Factors:  [96.48131338]
mat_Sqrt:  [[0.15]]
grads:  [-0.19503193]
Stock Position:  -0.19503193270502364
Bond Position:  [24.729113]


portfolio before change:  [6.00605767]
curr_Stock_Price:  96.00787259388991
curr_Factors:  [96.00787259]
mat_Sqrt:  [[0.15]]
grads:  [0.14757752]
Stock Position:  0.14757752183292838
Bond Position:  [-8.16254624]


portfolio before change:  [5.94998766]
curr_Stock_Price:  95.63139363802408
curr_Factors:  [95.63139364]
mat_Sqrt:  [[0.15]]
grads:  [0.07707604]
Stock Position:  0.07707604148208484
Bond Position:  [-1.4209016]


portfolio before change:  [5.98158065]
curr_Stock_Price:  96.04243960051305
curr_Factors:  [96.0424396]
mat_Sqrt:  [[0.15]]
grads:  [-0.20960723]
Stock Position:  -0.209607226487006
Bond Position:  [26.11277004]


portfolio before change:  [5.93157484]
curr_Stock_Price:  96.28879518351442
curr_Factors:  [96.28879518]
mat_Sqrt:  [[0.15]]
grads:  [0.05469909]
Stock Position:  0.05469909162965358
Bond Position:  [0.66466521]


portfolio before change:  [5.93008303]
curr_Stock_Price:  96.26076275383382
curr_Factors:  [96.26076275]
mat_Sqrt:  [[0.15]]
grads:  [-0.00948903]
Stock Position:  -0.009489032217159458
Bond Position:  [6.84350451]


portfolio before change:  [5.92747232]
curr_Stock_Price:  96.58096892136382
curr_Factors:  [96.58096892]
mat_Sqrt:  [[0.15]]
grads:  [-0.01857709]
Stock Position:  -0.018577085115077836
Bond Position:  [7.7216652]


portfolio before change:  [5.92795458]
curr_Stock_Price:  96.58098809557819
curr_Factors:  [96.5809881]
mat_Sqrt:  [[0.15]]
grads:  [0.04095345]
Stock Position:  0.040953449898813624
Bond Position:  [1.97262992]


portfolio before change:  [5.93577033]
curr_Stock_Price:  96.76882220517635
curr_Factors:  [96.76882221]
mat_Sqrt:  [[0.15]]
grads:  [-0.11207399]
Stock Position:  -0.1120739860640426
Bond Position:  [16.78103796]


portfolio before change:  [6.04059478]
curr_Stock_Price:  95.84286596510562
curr_Factors:  [95.84286597]
mat_Sqrt:  [[0.15]]
grads:  [0.31638634]
Stock Position:  0.31638634250382264
Bond Position:  [-24.28277903]


portfolio before change:  [6.16401682]
curr_Stock_Price:  96.2377621333937
curr_Factors:  [96.23776213]
mat_Sqrt:  [[0.15]]
grads:  [0.00861488]
Stock Position:  0.008614882927447663
Bond Position:  [5.33493976]


portfolio before change:  [6.16902859]
curr_Stock_Price:  96.78081468545797
curr_Factors:  [96.78081469]
mat_Sqrt:  [[0.15]]
grads:  [0.04259186]
Stock Position:  0.04259185530704727
Bond Position:  [2.04695414]


portfolio before change:  [6.1778132]
curr_Stock_Price:  96.98406164544797
curr_Factors:  [96.98406165]
mat_Sqrt:  [[0.15]]
grads:  [-0.05948195]
Stock Position:  -0.059481946383519335
Bond Position:  [11.94661395]


portfolio before change:  [6.21343438]
curr_Stock_Price:  96.3977577130317
curr_Factors:  [96.39775771]
mat_Sqrt:  [[0.15]]
grads:  [-0.00624786]
Stock Position:  -0.0062478601597786764
Bond Position:  [6.81571409]


portfolio before change:  [6.21400149]
curr_Stock_Price:  96.3751718092046
curr_Factors:  [96.37517181]
mat_Sqrt:  [[0.15]]
grads:  [-0.0688518]
Stock Position:  -0.06885180355215888
Bond Position:  [12.84960589]


portfolio before change:  [6.16828248]
curr_Stock_Price:  97.05085696620252
curr_Factors:  [97.05085697]
mat_Sqrt:  [[0.15]]
grads:  [-0.08989325]
Stock Position:  -0.08989324916806046
Bond Position:  [14.89249934]


portfolio before change:  [6.20248267]
curr_Stock_Price:  96.68075818848128
curr_Factors:  [96.68075819]
mat_Sqrt:  [[0.15]]
grads:  [0.0001173]
Stock Position:  0.00011730478134097436
Bond Position:  [6.19114155]


portfolio before change:  [6.20281039]
curr_Stock_Price:  96.17580539087092
curr_Factors:  [96.17580539]
mat_Sqrt:  [[0.15]]
grads:  [-0.01783935]
Stock Position:  -0.017839350939909262
Bond Position:  [7.91852434]


portfolio before change:  [6.21189555]
curr_Stock_Price:  95.69427247849687
curr_Factors:  [95.69427248]
mat_Sqrt:  [[0.15]]
grads:  [-0.03941024]
Stock Position:  -0.0394102379454727
Bond Position:  [9.9832296]


portfolio before change:  [6.21788233]
curr_Stock_Price:  95.55819606648599
curr_Factors:  [95.55819607]
mat_Sqrt:  [[0.15]]
grads:  [-0.02720632]
Stock Position:  -0.027206324735273263
Bond Position:  [8.81766964]


portfolio before change:  [6.22735493]
curr_Stock_Price:  95.23027674101992
curr_Factors:  [95.23027674]
mat_Sqrt:  [[0.15]]
grads:  [0.01870964]
Stock Position:  0.01870964445935337
Bond Position:  [4.44563031]


portfolio before change:  [6.2219026]
curr_Stock_Price:  94.92400733719306
curr_Factors:  [94.92400734]
mat_Sqrt:  [[0.15]]
grads:  [0.02585262]
Stock Position:  0.025852623602952114
Bond Position:  [3.76786796]


portfolio before change:  [6.22213261]
curr_Stock_Price:  94.92379528531572
curr_Factors:  [94.92379529]
mat_Sqrt:  [[0.15]]
grads:  [-0.01059234]
Stock Position:  -0.010592341303290592
Bond Position:  [7.22759785]


portfolio before change:  [6.22365466]
curr_Stock_Price:  94.82274985215734
curr_Factors:  [94.82274985]
mat_Sqrt:  [[0.15]]
grads:  [0.09890474]
Stock Position:  0.09890473524433145
Bond Position:  [-3.15476431]


portfolio before change:  [6.1803146]
curr_Stock_Price:  94.38654339215195
curr_Factors:  [94.38654339]
mat_Sqrt:  [[0.15]]
grads:  [0.05979027]
Stock Position:  0.05979026988078629
Bond Position:  [0.5369177]


portfolio before change:  [6.19874706]
curr_Stock_Price:  94.69426750997435
curr_Factors:  [94.69426751]
mat_Sqrt:  [[0.15]]
grads:  [0.01645652]
Stock Position:  0.01645651565174529
Bond Position:  [4.64040937]


portfolio before change:  [6.19589129]
curr_Stock_Price:  94.50310861408079
curr_Factors:  [94.50310861]
mat_Sqrt:  [[0.15]]
grads:  [0.08818987]
Stock Position:  0.08818987152653542
Bond Position:  [-2.13832572]


portfolio before change:  [6.20382218]
curr_Stock_Price:  94.59455386251159
curr_Factors:  [94.59455386]
mat_Sqrt:  [[0.15]]
grads:  [0.08715033]
Stock Position:  0.08715032553448775
Bond Position:  [-2.04012398]


portfolio before change:  [6.29217575]
curr_Stock_Price:  95.60982352275003
curr_Factors:  [95.60982352]
mat_Sqrt:  [[0.15]]
grads:  [-0.02637628]
Stock Position:  -0.026376279995679933
Bond Position:  [8.81400723]


portfolio before change:  [6.29531698]
curr_Stock_Price:  95.5116167852658
curr_Factors:  [95.51161679]
mat_Sqrt:  [[0.15]]
grads:  [-0.02590289]
Stock Position:  -0.02590288635122263
Bond Position:  [8.76934353]


portfolio before change:  [6.28413827]
curr_Stock_Price:  95.96433875418101
curr_Factors:  [95.96433875]
mat_Sqrt:  [[0.15]]
grads:  [-0.1496458]
Stock Position:  -0.14964580070817382
Bond Position:  [20.64479858]


portfolio before change:  [6.18853744]
curr_Stock_Price:  96.61180881107296
curr_Factors:  [96.61180881]
mat_Sqrt:  [[0.15]]
grads:  [-0.08511759]
Stock Position:  -0.08511758669768764
Bond Position:  [14.41190145]


portfolio before change:  [6.19015559]
curr_Stock_Price:  96.60338071145839
curr_Factors:  [96.60338071]
mat_Sqrt:  [[0.15]]
grads:  [-0.01156441]
Stock Position:  -0.011564413904737775
Bond Position:  [7.30731707]


portfolio before change:  [6.18728362]
curr_Stock_Price:  96.89121927594144
curr_Factors:  [96.89121928]
mat_Sqrt:  [[0.15]]
grads:  [-0.06214792]
Stock Position:  -0.06214792058689388
Bond Position:  [12.20887143]


portfolio before change:  [6.19619096]
curr_Stock_Price:  96.76017286613713
curr_Factors:  [96.76017287]
mat_Sqrt:  [[0.15]]
grads:  [-0.06404658]
Stock Position:  -0.06404658224002231
Bond Position:  [12.39334933]


portfolio before change:  [6.16968834]
curr_Stock_Price:  97.18606965674651
curr_Factors:  [97.18606966]
mat_Sqrt:  [[0.15]]
grads:  [0.06482694]
Stock Position:  0.06482693758970573
Bond Position:  [-0.13058693]


portfolio before change:  [6.18914326]
curr_Stock_Price:  97.4863010953753
curr_Factors:  [97.4863011]
mat_Sqrt:  [[0.15]]
grads:  [0.01489308]
Stock Position:  0.01489308344811648
Bond Position:  [4.73727165]


portfolio before change:  [6.19701438]
curr_Stock_Price:  97.99492808294806
curr_Factors:  [97.99492808]
mat_Sqrt:  [[0.15]]
grads:  [0.06523655]
Stock Position:  0.06523655330087048
Bond Position:  [-0.19583697]


portfolio before change:  [6.16607944]
curr_Stock_Price:  97.52091939327946
curr_Factors:  [97.52091939]
mat_Sqrt:  [[0.15]]
grads:  [-0.11647845]
Stock Position:  -0.11647845306369461
Bond Position:  [17.52516527]


portfolio before change:  [6.19374077]
curr_Stock_Price:  97.29284314326718
curr_Factors:  [97.29284314]
mat_Sqrt:  [[0.15]]
grads:  [0.03414622]
Stock Position:  0.03414621918966963
Bond Position:  [2.87155802]


portfolio before change:  [6.18476134]
curr_Stock_Price:  97.02461721057867
curr_Factors:  [97.02461721]
mat_Sqrt:  [[0.15]]
grads:  [0.01066188]
Stock Position:  0.010661880646460464
Bond Position:  [5.15029646]


portfolio before change:  [6.17926637]
curr_Stock_Price:  96.47903979125039
curr_Factors:  [96.47903979]
mat_Sqrt:  [[0.15]]
grads:  [-0.01136524]
Stock Position:  -0.01136524284716276
Bond Position:  [7.27577408]


portfolio before change:  [6.18686208]
curr_Stock_Price:  95.85072420726567
curr_Factors:  [95.85072421]
mat_Sqrt:  [[0.15]]
grads:  [0.05109159]
Stock Position:  0.05109159093342943
Bond Position:  [1.28969608]


portfolio before change:  [6.15921163]
curr_Stock_Price:  95.30795277608699
curr_Factors:  [95.30795278]
mat_Sqrt:  [[0.15]]
grads:  [-0.03572233]
Stock Position:  -0.03572232782005621
Bond Position:  [9.56383356]


portfolio before change:  [6.16993009]
curr_Stock_Price:  95.02463677046073
curr_Factors:  [95.02463677]
mat_Sqrt:  [[0.15]]
grads:  [0.02208794]
Stock Position:  0.02208793563589955
Bond Position:  [4.07103203]


portfolio before change:  [6.17414679]
curr_Stock_Price:  95.20402198050316
curr_Factors:  [95.20402198]
mat_Sqrt:  [[0.15]]
grads:  [0.08112785]
Stock Position:  0.0811278499671803
Bond Position:  [-1.54955082]


portfolio before change:  [6.11881053]
curr_Stock_Price:  94.52312870753727
curr_Factors:  [94.52312871]
mat_Sqrt:  [[0.15]]
grads:  [-0.09550111]
Stock Position:  -0.095501113763389
Bond Position:  [15.1458746]


portfolio before change:  [6.11527371]
curr_Stock_Price:  94.57007550855204
curr_Factors:  [94.57007551]
mat_Sqrt:  [[0.15]]
grads:  [-0.33266484]
Stock Position:  -0.332664844003255
Bond Position:  [37.57541312]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.11527371]
Stock Price:  94.13624423899016
PL:  [6.11527371]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.89447119e-02]
 [ 8.60710906e-03]
 [-4.40322142e-04]
 [-2.44325976e-04]
 [-9.82965005e-03]
 [ 1.20441720e-02]
 [ 6.52489371e-04]
 [ 1.54349165e-02]
 [ 1.04200967e-02]
 [ 4.42294745e-03]
 [ 6.42090928e-03]
 [-6.50735806e-03]
 [-2.09290828e-03]
 [ 3.90681395e-03]
 [-8.71908111e-03]
 [ 1.32986443e-02]
 [-1.57714814e-03]
 [ 7.90515711e-04]
 [ 5.97706909e-03]
 [ 1.40309385e-02]
 [ 7.06824190e-03]
 [-2.18587904e-02]
 [-5.07498861e-05]
 [ 1.87703165e-03]
 [-4.97642668e-03]
 [ 1.68742066e-02]
 [ 1.77803244e-02]
 [ 3.37890578e-02]
 [-4.20740274e-04]
 [ 1.21482100e-02]
 [-3.46803508e-03]
 [-5.36740502e-02]
 [ 2.43502771e-02]
 [ 1.09270471e-02]
 [-3.65440712e-02]
 [ 8.60861445e-03]
 [ 1.61812178e-05]
 [-9.10127039e-03]
 [ 7.90399861e-03]
 [-1.96914181e-02]
 [ 5.12752298e-02]
 [ 2.87675671e-03]
 [ 1.02966125e-02]
 [-9.77920399e-03]
 [-3.95015700e-03]
 [-1.65882511e-02]
 [-1.32044574e-02]
 [ 7.42939346e-04]
 [-2.67750029e-03]
 [-3.92352442e-03]
 [-3.93291471e-03]
 [ 2.81822980e-03]
 [ 3.60033039e-03]
 [ 5.36015676e-04]
 [ 3.96216086e-03]
 [ 8.91696876e-03]
 [ 1.12280112e-02]
 [ 2.72438535e-03]
 [ 1.35888954e-02]
 [ 1.80635557e-03]
 [ 5.29381137e-03]
 [-1.50157135e-02]
 [-1.25483786e-02]
 [-1.55810204e-03]
 [-1.11491551e-02]
 [-1.42158974e-02]
 [ 1.16012726e-02]
 [ 2.16102370e-03]
 [ 8.18129142e-03]
 [-1.66211965e-02]
 [-7.99093885e-04]
 [-6.05968530e-04]
 [ 1.21684967e-03]
 [ 8.44455025e-03]
 [ 3.12617873e-03]
 [ 1.09589684e-03]
 [ 1.02885879e-03]
 [-1.08335611e-02]
 [-2.71574642e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.45966693]
curr_Stock_Price:  99.45202100613723
curr_Factors:  [99.45202101]
mat_Sqrt:  [[0.15]]
grads:  [-0.25963141]
Stock Position:  -0.2596314124147458
Bond Position:  [19.36120175]


portfolio before change:  [-6.26687069]
curr_Stock_Price:  98.71410520358388
curr_Factors:  [98.7141052]
mat_Sqrt:  [[0.15]]
grads:  [0.05738073]
Stock Position:  0.05738072707274152
Bond Position:  [-11.93115782]


portfolio before change:  [-6.23187464]
curr_Stock_Price:  99.33699332538612
curr_Factors:  [99.33699333]
mat_Sqrt:  [[0.15]]
grads:  [-0.00293548]
Stock Position:  -0.002935480948145575
Bond Position:  [-5.94027279]


portfolio before change:  [-6.23133048]
curr_Stock_Price:  99.02513886621016
curr_Factors:  [99.02513887]
mat_Sqrt:  [[0.15]]
grads:  [-0.00162884]
Stock Position:  -0.0016288398381977503
Bond Position:  [-6.07003439]


portfolio before change:  [-6.23182822]
curr_Stock_Price:  99.09780053313567
curr_Factors:  [99.09780053]
mat_Sqrt:  [[0.15]]
grads:  [-0.065531]
Stock Position:  -0.06553100030245901
Bond Position:  [0.26214978]


portfolio before change:  [-6.29736273]
curr_Stock_Price:  100.09810405905615
curr_Factors:  [100.09810406]
mat_Sqrt:  [[0.15]]
grads:  [0.08029448]
Stock Position:  0.08029447967662322
Bond Position:  [-14.33468791]


portfolio before change:  [-6.35067451]
curr_Stock_Price:  99.44530905006314
curr_Factors:  [99.44530905]
mat_Sqrt:  [[0.15]]
grads:  [0.00434993]
Stock Position:  0.004349929140877257
Bond Position:  [-6.78325455]


portfolio before change:  [-6.35283659]
curr_Stock_Price:  99.04573598217854
curr_Factors:  [99.04573598]
mat_Sqrt:  [[0.15]]
grads:  [0.10289944]
Stock Position:  0.10289944357023165
Bond Position:  [-16.54458771]


portfolio before change:  [-6.4251082]
curr_Stock_Price:  98.35343348099506
curr_Factors:  [98.35343348]
mat_Sqrt:  [[0.15]]
grads:  [0.06946731]
Stock Position:  0.06946731142804834
Bond Position:  [-13.25745679]


portfolio before change:  [-6.43250594]
curr_Stock_Price:  98.25886923411917
curr_Factors:  [98.25886923]
mat_Sqrt:  [[0.15]]
grads:  [0.02948632]
Stock Position:  0.029486316361472094
Bond Position:  [-9.32979804]


portfolio before change:  [-6.42065457]
curr_Stock_Price:  98.68057318667462
curr_Factors:  [98.68057319]
mat_Sqrt:  [[0.15]]
grads:  [0.04280606]
Stock Position:  0.04280606185643904
Bond Position:  [-10.64478129]


portfolio before change:  [-6.4136847]
curr_Stock_Price:  98.85894022488303
curr_Factors:  [98.85894022]
mat_Sqrt:  [[0.15]]
grads:  [-0.04338239]
Stock Position:  -0.04338238707675207
Bond Position:  [-2.12494789]


portfolio before change:  [-6.40196534]
curr_Stock_Price:  98.58573766620782
curr_Factors:  [98.58573767]
mat_Sqrt:  [[0.15]]
grads:  [-0.01395272]
Stock Position:  -0.013952721862494077
Bond Position:  [-5.02642596]


portfolio before change:  [-6.39986241]
curr_Stock_Price:  98.41250364788196
curr_Factors:  [98.41250365]
mat_Sqrt:  [[0.15]]
grads:  [0.02604543]
Stock Position:  0.026045426324467377
Bond Position:  [-8.96305803]


portfolio before change:  [-6.39788101]
curr_Stock_Price:  98.51008749294157
curr_Factors:  [98.51008749]
mat_Sqrt:  [[0.15]]
grads:  [-0.05812721]
Stock Position:  -0.058127207405942995
Bond Position:  [-0.67176472]


portfolio before change:  [-6.42605361]
curr_Stock_Price:  98.99403667561673
curr_Factors:  [98.99403668]
mat_Sqrt:  [[0.15]]
grads:  [0.08865763]
Stock Position:  0.08865762881289886
Bond Position:  [-15.20263017]


portfolio before change:  [-6.44774858]
curr_Stock_Price:  98.76004914206783
curr_Factors:  [98.76004914]
mat_Sqrt:  [[0.15]]
grads:  [-0.01051432]
Stock Position:  -0.010514320945822176
Bond Position:  [-5.40935373]


portfolio before change:  [-6.44024723]
curr_Stock_Price:  98.01445142944769
curr_Factors:  [98.01445143]
mat_Sqrt:  [[0.15]]
grads:  [0.0052701]
Stock Position:  0.005270104742129122
Bond Position:  [-6.95679365]


portfolio before change:  [-6.44045445]
curr_Stock_Price:  98.05763560098853
curr_Factors:  [98.0576356]
mat_Sqrt:  [[0.15]]
grads:  [0.03984713]
Stock Position:  0.039847127253496706
Bond Position:  [-10.34776954]


portfolio before change:  [-6.44312984]
curr_Stock_Price:  98.0067253238718
curr_Factors:  [98.00672532]
mat_Sqrt:  [[0.15]]
grads:  [0.09353959]
Stock Position:  0.09353959011663197
Bond Position:  [-15.61063875]


portfolio before change:  [-6.43850495]
curr_Stock_Price:  98.06659929729865
curr_Factors:  [98.0665993]
mat_Sqrt:  [[0.15]]
grads:  [0.04712161]
Stock Position:  0.047121612640454634
Bond Position:  [-11.05956125]


portfolio before change:  [-6.44223164]
curr_Stock_Price:  98.00218197745961
curr_Factors:  [98.00218198]
mat_Sqrt:  [[0.15]]
grads:  [-0.14572527]
Stock Position:  -0.14572526961324536
Bond Position:  [7.83916275]


portfolio before change:  [-6.37438817]
curr_Stock_Price:  97.5399869009374
curr_Factors:  [97.5399869]
mat_Sqrt:  [[0.15]]
grads:  [-0.00033833]
Stock Position:  -0.0003383325739597596
Bond Position:  [-6.34138722]


portfolio before change:  [-6.37452583]
curr_Stock_Price:  96.7753866280871
curr_Factors:  [96.77538663]
mat_Sqrt:  [[0.15]]
grads:  [0.01251354]
Stock Position:  0.012513544328202956
Bond Position:  [-7.58552892]


portfolio before change:  [-6.3769548]
curr_Stock_Price:  96.6191677963804
curr_Factors:  [96.6191678]
mat_Sqrt:  [[0.15]]
grads:  [-0.03317618]
Stock Position:  -0.03317617786734888
Bond Position:  [-3.1715001]


portfolio before change:  [-6.39119278]
curr_Stock_Price:  97.04235576321464
curr_Factors:  [97.04235576]
mat_Sqrt:  [[0.15]]
grads:  [0.11249471]
Stock Position:  0.11249471079511515
Bond Position:  [-17.30794453]


portfolio before change:  [-6.4685965]
curr_Stock_Price:  96.3639066288596
curr_Factors:  [96.36390663]
mat_Sqrt:  [[0.15]]
grads:  [0.1185355]
Stock Position:  0.118535495679133
Bond Position:  [-17.89113994]


portfolio before change:  [-6.48951078]
curr_Stock_Price:  96.19690136556174
curr_Factors:  [96.19690137]
mat_Sqrt:  [[0.15]]
grads:  [0.22526039]
Stock Position:  0.225260385402756
Bond Position:  [-28.15886186]


portfolio before change:  [-6.6888441]
curr_Stock_Price:  95.31981266917504
curr_Factors:  [95.31981267]
mat_Sqrt:  [[0.15]]
grads:  [-0.00280494]
Stock Position:  -0.002804935163201043
Bond Position:  [-6.42147821]


portfolio before change:  [-6.68937439]
curr_Stock_Price:  95.36577874586399
curr_Factors:  [95.36577875]
mat_Sqrt:  [[0.15]]
grads:  [0.08098807]
Stock Position:  0.08098806648264306
Bond Position:  [-14.41286442]


portfolio before change:  [-6.70820634]
curr_Stock_Price:  95.14437425333162
curr_Factors:  [95.14437425]
mat_Sqrt:  [[0.15]]
grads:  [-0.02312023]
Stock Position:  -0.023120233882042415
Bond Position:  [-4.50844616]


portfolio before change:  [-6.70459342]
curr_Stock_Price:  94.97591981024294
curr_Factors:  [94.97591981]
mat_Sqrt:  [[0.15]]
grads:  [-0.357827]
Stock Position:  -0.3578270012676164
Bond Position:  [27.28035515]


portfolio before change:  [-6.69015746]
curr_Stock_Price:  94.94034146568517
curr_Factors:  [94.94034147]
mat_Sqrt:  [[0.15]]
grads:  [0.16233518]
Stock Position:  0.16233518098204688
Bond Position:  [-22.10231497]


portfolio before change:  [-6.78017474]
curr_Stock_Price:  94.39433631038818
curr_Factors:  [94.39433631]
mat_Sqrt:  [[0.15]]
grads:  [0.07284698]
Stock Position:  0.07284698087563454
Bond Position:  [-13.65651715]


portfolio before change:  [-6.72294214]
curr_Stock_Price:  95.19170848656763
curr_Factors:  [95.19170849]
mat_Sqrt:  [[0.15]]
grads:  [-0.24362714]
Stock Position:  -0.2436271413836967
Bond Position:  [16.46834168]


portfolio before change:  [-6.71139393]
curr_Stock_Price:  95.14853222074261
curr_Factors:  [95.14853222]
mat_Sqrt:  [[0.15]]
grads:  [0.05739076]
Stock Position:  0.05739076303034718
Bond Position:  [-12.1720408]


portfolio before change:  [-6.69798266]
curr_Stock_Price:  95.39547179324673
curr_Factors:  [95.39547179]
mat_Sqrt:  [[0.15]]
grads:  [0.00010787]
Stock Position:  0.00010787478542978342
Bond Position:  [-6.70827342]


portfolio before change:  [-6.69838299]
curr_Stock_Price:  95.57110092567078
curr_Factors:  [95.57110093]
mat_Sqrt:  [[0.15]]
grads:  [-0.06067514]
Stock Position:  -0.06067513591553039
Bond Position:  [-0.89959345]


portfolio before change:  [-6.69808756]
curr_Stock_Price:  95.56530527393299
curr_Factors:  [95.56530527]
mat_Sqrt:  [[0.15]]
grads:  [0.05269332]
Stock Position:  0.05269332405735854
Bond Position:  [-11.73374116]


portfolio before change:  [-6.71418764]
curr_Stock_Price:  95.27368030058756
curr_Factors:  [95.2736803]
mat_Sqrt:  [[0.15]]
grads:  [-0.13127612]
Stock Position:  -0.13127612083460957
Bond Position:  [5.79297153]


portfolio before change:  [-6.72157308]
curr_Stock_Price:  95.33269724462093
curr_Factors:  [95.33269724]
mat_Sqrt:  [[0.15]]
grads:  [0.34183487]
Stock Position:  0.34183486532815927
Bond Position:  [-39.3096128]


portfolio before change:  [-6.83496738]
curr_Stock_Price:  95.00816225303763
curr_Factors:  [95.00816225]
mat_Sqrt:  [[0.15]]
grads:  [0.01917838]
Stock Position:  0.019178378046105286
Bond Position:  [-8.65706983]


portfolio before change:  [-6.83746799]
curr_Stock_Price:  94.90598857859393
curr_Factors:  [94.90598858]
mat_Sqrt:  [[0.15]]
grads:  [0.06864408]
Stock Position:  0.0686440830795927
Bond Position:  [-13.35220256]


portfolio before change:  [-6.83949583]
curr_Stock_Price:  94.88860475142813
curr_Factors:  [94.88860475]
mat_Sqrt:  [[0.15]]
grads:  [-0.06519469]
Stock Position:  -0.06519469326192029
Bond Position:  [-0.65326235]


portfolio before change:  [-6.8207273]
curr_Stock_Price:  94.60009420199981
curr_Factors:  [94.6000942]
mat_Sqrt:  [[0.15]]
grads:  [-0.02633438]
Stock Position:  -0.026334379995747136
Bond Position:  [-4.32949247]


portfolio before change:  [-6.82821606]
curr_Stock_Price:  94.87419075873893
curr_Factors:  [94.87419076]
mat_Sqrt:  [[0.15]]
grads:  [-0.11058834]
Stock Position:  -0.1105883405226947
Bond Position:  [3.66376325]


portfolio before change:  [-6.88408019]
curr_Stock_Price:  95.38141523477637
curr_Factors:  [95.38141523]
mat_Sqrt:  [[0.15]]
grads:  [-0.08802972]
Stock Position:  -0.08802971612868357
Bond Position:  [1.51231872]


portfolio before change:  [-6.92360878]
curr_Stock_Price:  95.83152589133182
curr_Factors:  [95.83152589]
mat_Sqrt:  [[0.15]]
grads:  [0.00495293]
Stock Position:  0.00495292897233769
Bond Position:  [-7.39825552]


portfolio before change:  [-6.92227668]
curr_Stock_Price:  96.19383694709576
curr_Factors:  [96.19383695]
mat_Sqrt:  [[0.15]]
grads:  [-0.01785]
Stock Position:  -0.017850001902259858
Bond Position:  [-5.20521651]


portfolio before change:  [-6.92184167]
curr_Stock_Price:  96.15124066857658
curr_Factors:  [96.15124067]
mat_Sqrt:  [[0.15]]
grads:  [-0.02615683]
Stock Position:  -0.026156829474528222
Bond Position:  [-4.40683007]


portfolio before change:  [-6.92189371]
curr_Stock_Price:  96.1426998487145
curr_Factors:  [96.14269985]
mat_Sqrt:  [[0.15]]
grads:  [-0.02621943]
Stock Position:  -0.026219431395246986
Bond Position:  [-4.40108678]


portfolio before change:  [-6.90159758]
curr_Stock_Price:  95.35812141434008
curr_Factors:  [95.35812141]
mat_Sqrt:  [[0.15]]
grads:  [0.0187882]
Stock Position:  0.01878819869460909
Bond Position:  [-8.69320492]


portfolio before change:  [-6.88726606]
curr_Stock_Price:  96.14983463884533
curr_Factors:  [96.14983464]
mat_Sqrt:  [[0.15]]
grads:  [0.0240022]
Stock Position:  0.024002202625830412
Bond Position:  [-9.19507387]


portfolio before change:  [-6.87666125]
curr_Stock_Price:  96.61560519656197
curr_Factors:  [96.6156052]
mat_Sqrt:  [[0.15]]
grads:  [0.00357344]
Stock Position:  0.003573437837552356
Bond Position:  [-7.22191111]


portfolio before change:  [-6.87424427]
curr_Stock_Price:  97.41829552908871
curr_Factors:  [97.41829553]
mat_Sqrt:  [[0.15]]
grads:  [0.02641441]
Stock Position:  0.026414405748788373
Bond Position:  [-9.44749066]


portfolio before change:  [-6.87613598]
curr_Stock_Price:  97.36903376881584
curr_Factors:  [97.36903377]
mat_Sqrt:  [[0.15]]
grads:  [0.05944646]
Stock Position:  0.059446458427785356
Bond Position:  [-12.6643802]


portfolio before change:  [-6.93396134]
curr_Stock_Price:  96.4096189670084
curr_Factors:  [96.40961897]
mat_Sqrt:  [[0.15]]
grads:  [0.07485341]
Stock Position:  0.07485340785246798
Bond Position:  [-14.15054987]


portfolio before change:  [-6.88302133]
curr_Stock_Price:  97.10196476400154
curr_Factors:  [97.10196476]
mat_Sqrt:  [[0.15]]
grads:  [0.01816257]
Stock Position:  0.018162568978517202
Bond Position:  [-8.64664247]


portfolio before change:  [-6.88170136]
curr_Stock_Price:  97.20439556270674
curr_Factors:  [97.20439556]
mat_Sqrt:  [[0.15]]
grads:  [0.09059264]
Stock Position:  0.09059263620785303
Bond Position:  [-15.6877038]


portfolio before change:  [-6.79915387]
curr_Stock_Price:  98.1264130930506
curr_Factors:  [98.12641309]
mat_Sqrt:  [[0.15]]
grads:  [0.01204237]
Stock Position:  0.012042370491184484
Bond Position:  [-7.98082849]


portfolio before change:  [-6.78688357]
curr_Stock_Price:  99.18676215551598
curr_Factors:  [99.18676216]
mat_Sqrt:  [[0.15]]
grads:  [0.03529208]
Stock Position:  0.03529207582050411
Bond Position:  [-10.2873903]


portfolio before change:  [-6.82221425]
curr_Stock_Price:  98.20388713473194
curr_Factors:  [98.20388713]
mat_Sqrt:  [[0.15]]
grads:  [-0.10010476]
Stock Position:  -0.10010475650345617
Bond Position:  [3.00846195]


portfolio before change:  [-6.92706177]
curr_Stock_Price:  99.25314348154312
curr_Factors:  [99.25314348]
mat_Sqrt:  [[0.15]]
grads:  [-0.08365586]
Stock Position:  -0.08365585736199525
Bond Position:  [1.37604504]


portfolio before change:  [-6.90355474]
curr_Stock_Price:  98.97317474378622
curr_Factors:  [98.97317474]
mat_Sqrt:  [[0.15]]
grads:  [-0.01038735]
Stock Position:  -0.010387346958413392
Bond Position:  [-5.87548604]


portfolio before change:  [-6.89643222]
curr_Stock_Price:  98.2521295076069
curr_Factors:  [98.25212951]
mat_Sqrt:  [[0.15]]
grads:  [-0.0743277]
Stock Position:  -0.07432770079776686
Bond Position:  [0.40642266]


portfolio before change:  [-6.87194669]
curr_Stock_Price:  97.92304446341184
curr_Factors:  [97.92304446]
mat_Sqrt:  [[0.15]]
grads:  [-0.09477265]
Stock Position:  -0.09477264920431012
Bond Position:  [2.40847966]


portfolio before change:  [-6.94449765]
curr_Stock_Price:  98.69015925679959
curr_Factors:  [98.69015926]
mat_Sqrt:  [[0.15]]
grads:  [0.07734182]
Stock Position:  0.077341817210495
Bond Position:  [-14.57737391]


portfolio before change:  [-6.95877349]
curr_Stock_Price:  98.51735857479531
curr_Factors:  [98.51735857]
mat_Sqrt:  [[0.15]]
grads:  [0.01440682]
Stock Position:  0.014406824673223182
Bond Position:  [-8.3780958]


portfolio before change:  [-6.95611629]
curr_Stock_Price:  98.7381456792853
curr_Factors:  [98.73814568]
mat_Sqrt:  [[0.15]]
grads:  [0.05454194]
Stock Position:  0.05454194279549465
Bond Position:  [-12.34148659]


portfolio before change:  [-6.9645011]
curr_Stock_Price:  98.59855694240503
curr_Factors:  [98.59855694]
mat_Sqrt:  [[0.15]]
grads:  [-0.11080798]
Stock Position:  -0.11080797633645129
Bond Position:  [3.96100546]


portfolio before change:  [-6.91764903]
curr_Stock_Price:  98.1779689986572
curr_Factors:  [98.177969]
mat_Sqrt:  [[0.15]]
grads:  [-0.00532729]
Stock Position:  -0.005327292568451935
Bond Position:  [-6.39462627]


portfolio before change:  [-6.92194874]
curr_Stock_Price:  98.91005404224217
curr_Factors:  [98.91005404]
mat_Sqrt:  [[0.15]]
grads:  [-0.00403979]
Stock Position:  -0.004039790203188143
Bond Position:  [-6.52237287]


portfolio before change:  [-6.92041933]
curr_Stock_Price:  98.43055683083821
curr_Factors:  [98.43055683]
mat_Sqrt:  [[0.15]]
grads:  [0.00811233]
Stock Position:  0.00811233116266844
Bond Position:  [-7.7189206]


portfolio before change:  [-6.92378151]
curr_Stock_Price:  98.07557547899034
curr_Factors:  [98.07557548]
mat_Sqrt:  [[0.15]]
grads:  [0.056297]
Stock Position:  0.05629700165861565
Bond Position:  [-12.44514234]


portfolio before change:  [-6.92955634]
curr_Stock_Price:  97.98681422195048
curr_Factors:  [97.98681422]
mat_Sqrt:  [[0.15]]
grads:  [0.02084119]
Stock Position:  0.020841191554216227
Bond Position:  [-8.97171831]


portfolio before change:  [-6.93606736]
curr_Stock_Price:  97.70130898110551
curr_Factors:  [97.70130898]
mat_Sqrt:  [[0.15]]
grads:  [0.00730598]
Stock Position:  0.007305978921683061
Bond Position:  [-7.64987107]


portfolio before change:  [-6.93813259]
curr_Stock_Price:  97.48407679525486
curr_Factors:  [97.4840768]
mat_Sqrt:  [[0.15]]
grads:  [0.00685906]
Stock Position:  0.0068590586151812015
Bond Position:  [-7.60678159]


portfolio before change:  [-6.93967426]
curr_Stock_Price:  97.32862782595191
curr_Factors:  [97.32862783]
mat_Sqrt:  [[0.15]]
grads:  [-0.07222374]
Stock Position:  -0.07222374069184202
Bond Position:  [0.08976332]


portfolio before change:  [-6.91912742]
curr_Stock_Price:  97.04421673919691
curr_Factors:  [97.04421674]
mat_Sqrt:  [[0.15]]
grads:  [-0.18104976]
Stock Position:  -0.18104976101749254
Bond Position:  [10.65070483]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.91912742]
Stock Price:  97.90475789026392
PL:  [-6.91912742]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-9.82402377e-02]
 [ 3.95019985e-03]
 [ 8.42516499e-03]
 [ 2.87209374e-03]
 [ 9.65266495e-05]
 [ 1.22304768e-02]
 [-7.73303949e-04]
 [ 1.25802524e-02]
 [-1.52159306e-02]
 [ 3.06268268e-02]
 [ 9.86491738e-03]
 [-9.57329340e-03]
 [ 8.03449271e-03]
 [ 4.32901487e-03]
 [ 6.00515577e-03]
 [-1.67348028e-03]
 [ 1.21814031e-02]
 [ 8.40418410e-03]
 [ 2.31161909e-02]
 [ 2.21274230e-03]
 [ 7.87893003e-02]
 [-1.31613346e-02]
 [-1.31561627e-03]
 [ 6.63794321e-03]
 [ 1.09631781e-02]
 [-4.96324383e-03]
 [ 1.32509832e-02]
 [-1.79706308e-03]
 [ 5.59273437e-03]
 [-1.50580898e-02]
 [-5.72166329e-03]
 [ 3.88001313e-02]
 [ 7.29024781e-03]
 [ 5.37121818e-03]
 [-1.31458857e-03]
 [-3.86869980e-03]
 [-6.50896512e-03]
 [ 9.13300647e-03]
 [-2.00205121e-03]
 [-1.11539173e-02]
 [-1.45787949e-02]
 [-2.88063064e-03]
 [ 8.01197179e-03]
 [-1.49106911e-02]
 [ 2.30478618e-03]
 [ 4.33723491e-04]
 [-1.37074354e-02]
 [-5.00732701e-03]
 [-5.05244931e-03]
 [ 8.81793038e-04]
 [-3.00520940e-03]
 [ 3.65742362e-03]
 [ 8.99184032e-04]
 [ 3.04077355e-03]
 [-2.40947548e-03]
 [ 9.63953883e-03]
 [-7.14302949e-03]
 [-1.47183268e-02]
 [ 1.46341955e-02]
 [ 3.11477887e-03]
 [ 1.16537197e-02]
 [-1.39898916e-02]
 [-1.26330981e-02]
 [-2.95888885e-03]
 [-1.76034901e-02]
 [-1.36648090e-03]
 [ 2.96880163e-02]
 [ 3.55205467e-03]
 [ 7.50182164e-03]
 [-1.52745165e-02]
 [-7.86049719e-03]
 [-4.02323874e-03]
 [ 2.19511215e-03]
 [ 8.61149124e-03]
 [ 6.91159747e-03]
 [-1.08210233e-02]
 [ 3.82619021e-03]
 [-6.00073208e-03]
 [ 1.71422309e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.42286944]
curr_Stock_Price:  101.17977935055136
curr_Factors:  [101.17977935]
mat_Sqrt:  [[0.15]]
grads:  [-0.65493492]
Stock Position:  -0.6549349183173553
Bond Position:  [86.68903997]


portfolio before change:  [20.13765175]
curr_Stock_Price:  101.62354242041373
curr_Factors:  [101.62354242]
mat_Sqrt:  [[0.15]]
grads:  [0.02633467]
Stock Position:  0.026334665639677658
Bond Position:  [17.46142974]


portfolio before change:  [20.13496218]
curr_Stock_Price:  101.47996942638828
curr_Factors:  [101.47996943]
mat_Sqrt:  [[0.15]]
grads:  [0.05616777]
Stock Position:  0.05616776658597937
Bond Position:  [14.43505894]


portfolio before change:  [20.12704775]
curr_Stock_Price:  101.32299966699453
curr_Factors:  [101.32299967]
mat_Sqrt:  [[0.15]]
grads:  [0.01914729]
Stock Position:  0.019147291617199216
Bond Position:  [18.18698673]


portfolio before change:  [20.14200165]
curr_Stock_Price:  102.04462526773754
curr_Factors:  [102.04462527]
mat_Sqrt:  [[0.15]]
grads:  [0.00064351]
Stock Position:  0.0006435109964885815
Bond Position:  [20.07633481]


portfolio before change:  [20.14368375]
curr_Stock_Price:  102.70861965543875
curr_Factors:  [102.70861966]
mat_Sqrt:  [[0.15]]
grads:  [0.08153651]
Stock Position:  0.08153651200959024
Bond Position:  [11.76918115]


portfolio before change:  [20.10941568]
curr_Stock_Price:  102.27931909963607
curr_Factors:  [102.2793191]
mat_Sqrt:  [[0.15]]
grads:  [-0.00515536]
Stock Position:  -0.0051553596625803465
Bond Position:  [20.63670235]


portfolio before change:  [20.11068085]
curr_Stock_Price:  102.28410189747486
curr_Factors:  [102.2841019]
mat_Sqrt:  [[0.15]]
grads:  [0.08386835]
Stock Position:  0.08386834922732413
Bond Position:  [11.53228208]


portfolio before change:  [20.1442338]
curr_Stock_Price:  102.67557450148108
curr_Factors:  [102.6755745]
mat_Sqrt:  [[0.15]]
grads:  [-0.10143954]
Stock Position:  -0.10143953721291174
Bond Position:  [30.55959657]


portfolio before change:  [20.11640233]
curr_Stock_Price:  102.96876896199575
curr_Factors:  [102.96876896]
mat_Sqrt:  [[0.15]]
grads:  [0.20417885]
Stock Position:  0.20417884536141925
Bond Position:  [-0.90764203]


portfolio before change:  [20.02025141]
curr_Stock_Price:  102.49813162305244
curr_Factors:  [102.49813162]
mat_Sqrt:  [[0.15]]
grads:  [0.06576612]
Stock Position:  0.06576611584213779
Bond Position:  [13.27934741]


portfolio before change:  [19.98292321]
curr_Stock_Price:  101.91792115861193
curr_Factors:  [101.91792116]
mat_Sqrt:  [[0.15]]
grads:  [-0.06382196]
Stock Position:  -0.06382195599631672
Bond Position:  [26.48752429]


portfolio before change:  [20.04161462]
curr_Stock_Price:  101.02424922226417
curr_Factors:  [101.02424922]
mat_Sqrt:  [[0.15]]
grads:  [0.05356328]
Stock Position:  0.05356328474812183
Bond Position:  [14.63042399]


portfolio before change:  [19.9920699]
curr_Stock_Price:  100.08220192618249
curr_Factors:  [100.08220193]
mat_Sqrt:  [[0.15]]
grads:  [0.0288601]
Stock Position:  0.028860099141217763
Bond Position:  [17.10368763]


portfolio before change:  [19.99769709]
curr_Stock_Price:  100.24014226422692
curr_Factors:  [100.24014226]
mat_Sqrt:  [[0.15]]
grads:  [0.04003437]
Stock Position:  0.04003437179020651
Bond Position:  [15.98464597]


portfolio before change:  [19.99620947]
curr_Stock_Price:  100.1780283839638
curr_Factors:  [100.17802838]
mat_Sqrt:  [[0.15]]
grads:  [-0.01115654]
Stock Position:  -0.01115653518500687
Bond Position:  [21.11384917]


portfolio before change:  [19.99596877]
curr_Stock_Price:  100.31788907352427
curr_Factors:  [100.31788907]
mat_Sqrt:  [[0.15]]
grads:  [0.08120935]
Stock Position:  0.08120935426863324
Bond Position:  [11.84921777]


portfolio before change:  [19.94296056]
curr_Stock_Price:  99.65603415263075
curr_Factors:  [99.65603415]
mat_Sqrt:  [[0.15]]
grads:  [0.05602789]
Stock Position:  0.056027893992030176
Bond Position:  [14.35944284]


portfolio before change:  [19.9902572]
curr_Stock_Price:  100.48417796787822
curr_Factors:  [100.48417797]
mat_Sqrt:  [[0.15]]
grads:  [0.15410794]
Stock Position:  0.15410793906193657
Bond Position:  [4.50484763]


portfolio before change:  [20.02107893]
curr_Stock_Price:  100.68235179224082
curr_Factors:  [100.68235179]
mat_Sqrt:  [[0.15]]
grads:  [0.01475162]
Stock Position:  0.014751615340837104
Bond Position:  [18.5358516]


portfolio before change:  [20.02175843]
curr_Stock_Price:  100.64987946867731
curr_Factors:  [100.64987947]
mat_Sqrt:  [[0.15]]
grads:  [0.525262]
Stock Position:  0.5252620017935576
Bond Position:  [-32.84579874]


portfolio before change:  [20.07205323]
curr_Stock_Price:  100.7495396788685
curr_Factors:  [100.74953968]
mat_Sqrt:  [[0.15]]
grads:  [-0.08774223]
Stock Position:  -0.0877422309061337
Bond Position:  [28.9120426]


portfolio before change:  [20.11136648]
curr_Stock_Price:  100.32208082254456
curr_Factors:  [100.32208082]
mat_Sqrt:  [[0.15]]
grads:  [-0.00877078]
Stock Position:  -0.008770775108816714
Bond Position:  [20.99126889]


portfolio before change:  [20.11028639]
curr_Stock_Price:  100.59481509714207
curr_Factors:  [100.5948151]
mat_Sqrt:  [[0.15]]
grads:  [0.04425295]
Stock Position:  0.044252954732937076
Bond Position:  [15.65866859]


portfolio before change:  [20.06811129]
curr_Stock_Price:  99.61965322095682
curr_Factors:  [99.61965322]
mat_Sqrt:  [[0.15]]
grads:  [0.07308785]
Stock Position:  0.07308785380700902
Bond Position:  [12.78712464]


portfolio before change:  [20.07977058]
curr_Stock_Price:  99.76824254703057
curr_Factors:  [99.76824255]
mat_Sqrt:  [[0.15]]
grads:  [-0.03308829]
Stock Position:  -0.03308829219567502
Bond Position:  [23.38093134]


portfolio before change:  [20.08071131]
curr_Stock_Price:  99.783977020545
curr_Factors:  [99.78397702]
mat_Sqrt:  [[0.15]]
grads:  [0.08833989]
Stock Position:  0.08833988777555925
Bond Position:  [11.26580598]


portfolio before change:  [20.08789879]
curr_Stock_Price:  99.85736791432244
curr_Factors:  [99.85736791]
mat_Sqrt:  [[0.15]]
grads:  [-0.01198042]
Stock Position:  -0.01198042053937779
Bond Position:  [21.28423205]


portfolio before change:  [20.06069059]
curr_Stock_Price:  102.23946357849643
curr_Factors:  [102.23946358]
mat_Sqrt:  [[0.15]]
grads:  [0.0372849]
Stock Position:  0.03728489580972618
Bond Position:  [16.24870284]


portfolio before change:  [20.07465633]
curr_Stock_Price:  102.58679364274384
curr_Factors:  [102.58679364]
mat_Sqrt:  [[0.15]]
grads:  [-0.10038727]
Stock Position:  -0.10038726549114552
Bond Position:  [30.37306402]


portfolio before change:  [20.01748966]
curr_Stock_Price:  103.17516547643848
curr_Factors:  [103.17516548]
mat_Sqrt:  [[0.15]]
grads:  [-0.03814442]
Stock Position:  -0.03814442196397589
Bond Position:  [23.95304671]


portfolio before change:  [20.02123768]
curr_Stock_Price:  103.11615550873677
curr_Factors:  [103.11615551]
mat_Sqrt:  [[0.15]]
grads:  [0.25866754]
Stock Position:  0.2586675419130853
Bond Position:  [-6.6515648]


portfolio before change:  [19.75580784]
curr_Stock_Price:  102.09161990687628
curr_Factors:  [102.09161991]
mat_Sqrt:  [[0.15]]
grads:  [0.04860165]
Stock Position:  0.04860165206325464
Bond Position:  [14.79398645]


portfolio before change:  [19.73403903]
curr_Stock_Price:  101.62469209112375
curr_Factors:  [101.62469209]
mat_Sqrt:  [[0.15]]
grads:  [0.03580812]
Stock Position:  0.035808121230779165
Bond Position:  [16.09504973]


portfolio before change:  [19.73534574]
curr_Stock_Price:  101.6330907998335
curr_Factors:  [101.6330908]
mat_Sqrt:  [[0.15]]
grads:  [-0.00876392]
Stock Position:  -0.008763923777397176
Bond Position:  [20.6260504]


portfolio before change:  [19.72674592]
curr_Stock_Price:  102.76146521254785
curr_Factors:  [102.76146521]
mat_Sqrt:  [[0.15]]
grads:  [-0.02579133]
Stock Position:  -0.025791331973086386
Bond Position:  [22.37710098]


portfolio before change:  [19.73335276]
curr_Stock_Price:  102.5595280658556
curr_Factors:  [102.55952807]
mat_Sqrt:  [[0.15]]
grads:  [-0.0433931]
Stock Position:  -0.043393100829213695
Bond Position:  [24.1837287]


portfolio before change:  [19.78100689]
curr_Stock_Price:  101.49616547467102
curr_Factors:  [101.49616547]
mat_Sqrt:  [[0.15]]
grads:  [0.06088671]
Stock Position:  0.06088670977632802
Bond Position:  [13.60123932]


portfolio before change:  [19.73779069]
curr_Stock_Price:  100.77242290097499
curr_Factors:  [100.7724229]
mat_Sqrt:  [[0.15]]
grads:  [-0.01334701]
Stock Position:  -0.01334700809581541
Bond Position:  [21.08280104]


portfolio before change:  [19.73568852]
curr_Stock_Price:  101.02865181912969
curr_Factors:  [101.02865182]
mat_Sqrt:  [[0.15]]
grads:  [-0.07435945]
Stock Position:  -0.0743594486408789
Bond Position:  [27.24812336]


portfolio before change:  [19.71244496]
curr_Stock_Price:  101.36413870597147
curr_Factors:  [101.36413871]
mat_Sqrt:  [[0.15]]
grads:  [-0.09719197]
Stock Position:  -0.09719196587169107
Bond Position:  [29.56422487]


portfolio before change:  [19.78450866]
curr_Stock_Price:  100.64169340805695
curr_Factors:  [100.64169341]
mat_Sqrt:  [[0.15]]
grads:  [-0.0192042]
Stock Position:  -0.019204204277031928
Bond Position:  [21.7172523]


portfolio before change:  [19.78467296]
curr_Stock_Price:  100.70381864947605
curr_Factors:  [100.70381865]
mat_Sqrt:  [[0.15]]
grads:  [0.05341315]
Stock Position:  0.05341314527520627
Bond Position:  [14.40576527]


portfolio before change:  [19.78861273]
curr_Stock_Price:  100.7607218661158
curr_Factors:  [100.76072187]
mat_Sqrt:  [[0.15]]
grads:  [-0.09940461]
Stock Position:  -0.0994046070515964
Bond Position:  [29.8046927]


portfolio before change:  [19.8222781]
curr_Stock_Price:  100.44079184456389
curr_Factors:  [100.44079184]
mat_Sqrt:  [[0.15]]
grads:  [0.01536524]
Stock Position:  0.015365241204731992
Bond Position:  [18.27898111]


portfolio before change:  [19.8251172]
curr_Stock_Price:  100.55121141737912
curr_Factors:  [100.55121142]
mat_Sqrt:  [[0.15]]
grads:  [0.00289149]
Stock Position:  0.0028914899397367673
Bond Position:  [19.53437438]


portfolio before change:  [19.82708686]
curr_Stock_Price:  100.81015106044748
curr_Factors:  [100.81015106]
mat_Sqrt:  [[0.15]]
grads:  [-0.0913829]
Stock Position:  -0.09138290294457788
Bond Position:  [29.03941111]


portfolio before change:  [19.90320904]
curr_Stock_Price:  99.99701031514518
curr_Factors:  [99.99701032]
mat_Sqrt:  [[0.15]]
grads:  [-0.03338218]
Stock Position:  -0.03338218005720112
Bond Position:  [23.24132724]


portfolio before change:  [19.90241826]
curr_Stock_Price:  100.06421397145532
curr_Factors:  [100.06421397]
mat_Sqrt:  [[0.15]]
grads:  [-0.033683]
Stock Position:  -0.0336829953722859
Bond Position:  [23.27288072]


portfolio before change:  [19.85918419]
curr_Stock_Price:  101.39095682333998
curr_Factors:  [101.39095682]
mat_Sqrt:  [[0.15]]
grads:  [0.00587862]
Stock Position:  0.005878620254813194
Bond Position:  [19.26314526]


portfolio before change:  [19.85985284]
curr_Stock_Price:  101.2998922571619
curr_Factors:  [101.29989226]
mat_Sqrt:  [[0.15]]
grads:  [-0.02003473]
Stock Position:  -0.020034729313710732
Bond Position:  [21.88936876]


portfolio before change:  [19.84327647]
curr_Stock_Price:  102.19556184149303
curr_Factors:  [102.19556184]
mat_Sqrt:  [[0.15]]
grads:  [0.02438282]
Stock Position:  0.024382824131056732
Bond Position:  [17.35146006]


portfolio before change:  [19.84862458]
curr_Stock_Price:  102.37042308193533
curr_Factors:  [102.37042308]
mat_Sqrt:  [[0.15]]
grads:  [0.00599456]
Stock Position:  0.005994560214554975
Bond Position:  [19.23495892]


portfolio before change:  [19.84919932]
curr_Stock_Price:  102.26574851827323
curr_Factors:  [102.26574852]
mat_Sqrt:  [[0.15]]
grads:  [0.02027182]
Stock Position:  0.020271823638835236
Bond Position:  [17.77608611]


portfolio before change:  [19.85549373]
curr_Stock_Price:  102.52144181675874
curr_Factors:  [102.52144182]
mat_Sqrt:  [[0.15]]
grads:  [-0.01606317]
Stock Position:  -0.01606316985003412
Bond Position:  [21.50231307]


portfolio before change:  [19.84257893]
curr_Stock_Price:  103.40910847352535
curr_Factors:  [103.40910847]
mat_Sqrt:  [[0.15]]
grads:  [0.06426359]
Stock Position:  0.0642635921832657
Bond Position:  [13.19713816]


portfolio before change:  [19.78552261]
curr_Stock_Price:  102.50842473890818
curr_Factors:  [102.50842474]
mat_Sqrt:  [[0.15]]
grads:  [-0.0476202]
Stock Position:  -0.04762019657738007
Bond Position:  [24.66699394]


portfolio before change:  [19.81357831]
curr_Stock_Price:  101.9516447298676
curr_Factors:  [101.95164473]
mat_Sqrt:  [[0.15]]
grads:  [-0.09812218]
Stock Position:  -0.09812217894709886
Bond Position:  [29.81729584]


portfolio before change:  [19.72246254]
curr_Stock_Price:  102.89923282359008
curr_Factors:  [102.89923282]
mat_Sqrt:  [[0.15]]
grads:  [0.0975613]
Stock Position:  0.09756130352544995
Bond Position:  [9.68347926]


portfolio before change:  [19.68430637]
curr_Stock_Price:  102.50192971967766
curr_Factors:  [102.50192972]
mat_Sqrt:  [[0.15]]
grads:  [0.02076519]
Stock Position:  0.02076519249569284
Bond Position:  [17.55583407]


portfolio before change:  [19.69325508]
curr_Stock_Price:  102.88003511745492
curr_Factors:  [102.88003512]
mat_Sqrt:  [[0.15]]
grads:  [0.07769146]
Stock Position:  0.07769146435861635
Bond Position:  [11.7003545]


portfolio before change:  [19.62799111]
curr_Stock_Price:  102.03058185922195
curr_Factors:  [102.03058186]
mat_Sqrt:  [[0.15]]
grads:  [-0.09326594]
Stock Position:  -0.09326594422407855
Bond Position:  [29.14396966]


portfolio before change:  [19.66345201]
curr_Stock_Price:  101.66989978676035
curr_Factors:  [101.66989979]
mat_Sqrt:  [[0.15]]
grads:  [-0.08422065]
Stock Position:  -0.0842206538397727
Bond Position:  [28.22615745]


portfolio before change:  [19.63148634]
curr_Stock_Price:  102.07039372323621
curr_Factors:  [102.07039372]
mat_Sqrt:  [[0.15]]
grads:  [-0.01972593]
Stock Position:  -0.019725925696348668
Bond Position:  [21.64491935]


portfolio before change:  [19.64421041]
curr_Stock_Price:  101.49393340330737
curr_Factors:  [101.4939334]
mat_Sqrt:  [[0.15]]
grads:  [-0.1173566]
Stock Position:  -0.11735660045479893
Bond Position:  [31.5551934]


portfolio before change:  [19.56815393]
curr_Stock_Price:  102.15881920740384
curr_Factors:  [102.15881921]
mat_Sqrt:  [[0.15]]
grads:  [-0.00910987]
Stock Position:  -0.009109872664740289
Bond Position:  [20.49880776]


portfolio before change:  [19.5663495]
curr_Stock_Price:  102.49753366293983
curr_Factors:  [102.49753366]
mat_Sqrt:  [[0.15]]
grads:  [0.19792011]
Stock Position:  0.197920108714088
Bond Position:  [-0.71997351]


portfolio before change:  [19.79270273]
curr_Stock_Price:  103.64142062765332
curr_Factors:  [103.64142063]
mat_Sqrt:  [[0.15]]
grads:  [0.02368036]
Stock Position:  0.02368036446589559
Bond Position:  [17.33843612]


portfolio before change:  [19.77025028]
curr_Stock_Price:  102.64751133725608
curr_Factors:  [102.64751134]
mat_Sqrt:  [[0.15]]
grads:  [0.05001214]
Stock Position:  0.05001214429259839
Bond Position:  [14.63662814]


portfolio before change:  [19.76516525]
curr_Stock_Price:  102.5275435119005
curr_Factors:  [102.52754351]
mat_Sqrt:  [[0.15]]
grads:  [-0.10183011]
Stock Position:  -0.10183010985564449
Bond Position:  [30.20555627]


portfolio before change:  [19.80016615]
curr_Stock_Price:  102.2023647339059
curr_Factors:  [102.20236473]
mat_Sqrt:  [[0.15]]
grads:  [-0.05240331]
Stock Position:  -0.05240331457324682
Bond Position:  [25.15590882]


portfolio before change:  [19.85600432]
curr_Stock_Price:  101.16682186263468
curr_Factors:  [101.16682186]
mat_Sqrt:  [[0.15]]
grads:  [-0.02682159]
Stock Position:  -0.026821591588865972
Bond Position:  [22.5694595]


portfolio before change:  [19.85320716]
curr_Stock_Price:  101.32370282150555
curr_Factors:  [101.32370282]
mat_Sqrt:  [[0.15]]
grads:  [0.01463408]
Stock Position:  0.014634081013367013
Bond Position:  [18.37042789]


portfolio before change:  [19.84539091]
curr_Stock_Price:  100.71113022498594
curr_Factors:  [100.71113022]
mat_Sqrt:  [[0.15]]
grads:  [0.05740994]
Stock Position:  0.057409941620021485
Bond Position:  [14.06357081]


portfolio before change:  [19.86981842]
curr_Stock_Price:  101.12131197727217
curr_Factors:  [101.12131198]
mat_Sqrt:  [[0.15]]
grads:  [0.04607732]
Stock Position:  0.046077316487306265
Bond Position:  [15.21041973]


portfolio before change:  [19.88390292]
curr_Stock_Price:  101.40635054961511
curr_Factors:  [101.40635055]
mat_Sqrt:  [[0.15]]
grads:  [-0.07214016]
Stock Position:  -0.0721401554782204
Bond Position:  [27.19937281]


portfolio before change:  [19.85744053]
curr_Stock_Price:  101.79673511976189
curr_Factors:  [101.79673512]
mat_Sqrt:  [[0.15]]
grads:  [0.02550793]
Stock Position:  0.025507934756095047
Bond Position:  [17.26081605]


portfolio before change:  [19.85283725]
curr_Stock_Price:  101.5739766479323
curr_Factors:  [101.57397665]
mat_Sqrt:  [[0.15]]
grads:  [-0.04000488]
Stock Position:  -0.040004880544974836
Bond Position:  [23.91629206]


portfolio before change:  [19.82784759]
curr_Stock_Price:  102.23600792468655
curr_Factors:  [102.23600792]
mat_Sqrt:  [[0.15]]
grads:  [0.11428154]
Stock Position:  0.11428153929900434
Bond Position:  [8.14415923]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.82784759]
Stock Price:  102.50424428814523
PL:  [17.3236033]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-5.00361451e-02]
 [-9.00549813e-04]
 [-5.45683318e-04]
 [ 1.77845882e-03]
 [ 2.14048616e-02]
 [ 1.18225363e-02]
 [ 1.16504530e-03]
 [ 1.04062225e-02]
 [ 9.89066029e-03]
 [-1.89302327e-02]
 [ 7.11684110e-03]
 [-6.12171208e-03]
 [-7.27668691e-03]
 [ 4.27757468e-03]
 [ 6.12636736e-03]
 [-8.95899878e-03]
 [ 1.35013053e-02]
 [ 1.53384415e-02]
 [ 1.82478747e-02]
 [-1.77735414e-03]
 [ 4.01894999e-02]
 [-1.14739914e-02]
 [ 2.48816023e-03]
 [-2.36198772e-03]
 [ 1.69691832e-02]
 [ 1.82990492e-02]
 [ 8.93275979e-03]
 [ 1.95116662e-03]
 [ 8.23522727e-03]
 [-9.58467614e-03]
 [-5.73080100e-03]
 [ 4.22663963e-02]
 [ 3.38533143e-03]
 [-9.47238191e-03]
 [-3.59392463e-03]
 [-5.46173881e-03]
 [-2.55246118e-03]
 [-1.66046819e-03]
 [ 6.12567960e-03]
 [-6.92815939e-03]
 [-5.36149282e-02]
 [-4.29582587e-03]
 [ 1.56671525e-02]
 [-1.57074712e-02]
 [-5.48350048e-03]
 [ 3.17774469e-03]
 [-1.35522980e-02]
 [ 2.29812770e-02]
 [ 3.81250334e-02]
 [-1.33409370e-02]
 [-4.64575738e-03]
 [ 3.67444802e-03]
 [ 3.42927904e-03]
 [-6.63580846e-03]
 [-1.27251374e-02]
 [ 1.29348232e-02]
 [-3.19458145e-02]
 [-1.09525140e-02]
 [ 2.11827701e-02]
 [-9.72232011e-03]
 [ 1.31945963e-02]
 [-1.38083869e-02]
 [-1.27207553e-02]
 [-2.95144704e-03]
 [ 6.02467687e-02]
 [-1.56848992e-02]
 [ 1.16846320e-02]
 [ 4.81295218e-03]
 [ 1.26446525e-02]
 [-2.65315839e-02]
 [-7.90696306e-03]
 [-5.78817368e-03]
 [ 1.02407170e-02]
 [ 4.82131003e-03]
 [-1.80238363e-03]
 [ 4.92663121e-03]
 [ 3.11309851e-03]
 [-2.75667573e-03]
 [ 2.17848441e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.05515312]
curr_Stock_Price:  100.38489806434721
curr_Factors:  [100.38489806]
mat_Sqrt:  [[0.15]]
grads:  [-0.3335743]
Stock Position:  -0.3335743009464809
Bond Position:  [41.54097531]


portfolio before change:  [8.24235961]
curr_Stock_Price:  99.83146783334399
curr_Factors:  [99.83146783]
mat_Sqrt:  [[0.15]]
grads:  [-0.00600367]
Stock Position:  -0.006003665423324409
Bond Position:  [8.84171434]


portfolio before change:  [8.24633809]
curr_Stock_Price:  99.26083983759081
curr_Factors:  [99.26083984]
mat_Sqrt:  [[0.15]]
grads:  [-0.00363789]
Stock Position:  -0.0036378887848633867
Bond Position:  [8.60743799]


portfolio before change:  [8.24526481]
curr_Stock_Price:  99.70375295942459
curr_Factors:  [99.70375296]
mat_Sqrt:  [[0.15]]
grads:  [0.01185639]
Stock Position:  0.011856392122746027
Bond Position:  [7.06313802]


portfolio before change:  [8.24808385]
curr_Stock_Price:  99.90428436190436
curr_Factors:  [99.90428436]
mat_Sqrt:  [[0.15]]
grads:  [0.14269908]
Stock Position:  0.14269907716351737
Bond Position:  [-6.00816534]


portfolio before change:  [8.22410143]
curr_Stock_Price:  99.73885308685152
curr_Factors:  [99.73885309]
mat_Sqrt:  [[0.15]]
grads:  [0.07881691]
Stock Position:  0.0788169087254748
Bond Position:  [0.36299335]


portfolio before change:  [8.2486249]
curr_Stock_Price:  100.04970997593622
curr_Factors:  [100.04970998]
mat_Sqrt:  [[0.15]]
grads:  [0.00776697]
Stock Position:  0.007766968652324198
Bond Position:  [7.47154194]


portfolio before change:  [8.25036505]
curr_Stock_Price:  100.21363049016988
curr_Factors:  [100.21363049]
mat_Sqrt:  [[0.15]]
grads:  [0.06937482]
Stock Position:  0.06937481683776384
Bond Position:  [1.29806279]


portfolio before change:  [8.24974507]
curr_Stock_Price:  100.20352439347288
curr_Factors:  [100.20352439]
mat_Sqrt:  [[0.15]]
grads:  [0.06593774]
Stock Position:  0.06593773525682341
Bond Position:  [1.64255161]


portfolio before change:  [8.2127508]
curr_Stock_Price:  99.64091883995651
curr_Factors:  [99.64091884]
mat_Sqrt:  [[0.15]]
grads:  [-0.12620155]
Stock Position:  -0.1262015513534103
Bond Position:  [20.78758934]


portfolio before change:  [8.22049956]
curr_Stock_Price:  99.58981411629537
curr_Factors:  [99.58981412]
mat_Sqrt:  [[0.15]]
grads:  [0.04744561]
Stock Position:  0.04744560732658688
Bond Position:  [3.49540035]


portfolio before change:  [8.19613254]
curr_Stock_Price:  99.07163138553804
curr_Factors:  [99.07163139]
mat_Sqrt:  [[0.15]]
grads:  [-0.04081141]
Stock Position:  -0.040811413837858655
Bond Position:  [12.23938588]


portfolio before change:  [8.18715548]
curr_Stock_Price:  99.31034011249547
curr_Factors:  [99.31034011]
mat_Sqrt:  [[0.15]]
grads:  [-0.04851125]
Stock Position:  -0.04851124608486365
Bond Position:  [13.00482383]


portfolio before change:  [8.17447135]
curr_Stock_Price:  99.58856338729369
curr_Factors:  [99.58856339]
mat_Sqrt:  [[0.15]]
grads:  [0.02851716]
Stock Position:  0.028517164511155966
Bond Position:  [5.3344879]


portfolio before change:  [8.20040453]
curr_Stock_Price:  100.4862602220993
curr_Factors:  [100.48626022]
mat_Sqrt:  [[0.15]]
grads:  [0.04084245]
Stock Position:  0.04084244909483635
Bond Position:  [4.09629957]


portfolio before change:  [8.21491146]
curr_Stock_Price:  100.8351840021462
curr_Factors:  [100.835184]
mat_Sqrt:  [[0.15]]
grads:  [-0.05972666]
Stock Position:  -0.05972665855422958
Bond Position:  [14.23746007]


portfolio before change:  [8.19641583]
curr_Stock_Price:  101.15975433165411
curr_Factors:  [101.15975433]
mat_Sqrt:  [[0.15]]
grads:  [0.0900087]
Stock Position:  0.09000870194727296
Bond Position:  [-0.90884235]


portfolio before change:  [8.15846673]
curr_Stock_Price:  100.7387695600085
curr_Factors:  [100.73876956]
mat_Sqrt:  [[0.15]]
grads:  [0.10225628]
Stock Position:  0.10225627637145732
Bond Position:  [-2.14270473]


portfolio before change:  [8.26065828]
curr_Stock_Price:  101.73944622021774
curr_Factors:  [101.73944622]
mat_Sqrt:  [[0.15]]
grads:  [0.1216525]
Stock Position:  0.12165249811963229
Bond Position:  [-4.11619951]


portfolio before change:  [8.36188264]
curr_Stock_Price:  102.57363895787714
curr_Factors:  [102.57363896]
mat_Sqrt:  [[0.15]]
grads:  [-0.01184903]
Stock Position:  -0.01184902759416407
Bond Position:  [9.57728052]


portfolio before change:  [8.3608969]
curr_Stock_Price:  102.70734933877826
curr_Factors:  [102.70734934]
mat_Sqrt:  [[0.15]]
grads:  [0.26793]
Stock Position:  0.267929999030357
Bond Position:  [-19.15748311]


portfolio before change:  [8.40501353]
curr_Stock_Price:  102.87647564937896
curr_Factors:  [102.87647565]
mat_Sqrt:  [[0.15]]
grads:  [-0.07649328]
Stock Position:  -0.07649327604011227
Bond Position:  [16.27437218]


portfolio before change:  [8.38052709]
curr_Stock_Price:  103.2098856118558
curr_Factors:  [103.20988561]
mat_Sqrt:  [[0.15]]
grads:  [0.01658773]
Stock Position:  0.016587734834765604
Bond Position:  [6.66850888]


portfolio before change:  [8.37409746]
curr_Stock_Price:  102.79714534655973
curr_Factors:  [102.79714535]
mat_Sqrt:  [[0.15]]
grads:  [-0.01574658]
Stock Position:  -0.015746584802462545
Bond Position:  [9.99280143]


portfolio before change:  [8.38816278]
curr_Stock_Price:  101.94357938109744
curr_Factors:  [101.94357938]
mat_Sqrt:  [[0.15]]
grads:  [0.11312789]
Stock Position:  0.11312788786575909
Bond Position:  [-3.14449904]


portfolio before change:  [8.45944887]
curr_Stock_Price:  102.5754538930344
curr_Factors:  [102.57545389]
mat_Sqrt:  [[0.15]]
grads:  [0.12199366]
Stock Position:  0.12199366130465852
Bond Position:  [-4.05410631]


portfolio before change:  [8.54939656]
curr_Stock_Price:  103.3148453740641
curr_Factors:  [103.31484537]
mat_Sqrt:  [[0.15]]
grads:  [0.05955173]
Stock Position:  0.05955173195848302
Bond Position:  [2.39681858]


portfolio before change:  [8.60883649]
curr_Stock_Price:  104.31045256077776
curr_Factors:  [104.31045256]
mat_Sqrt:  [[0.15]]
grads:  [0.01300778]
Stock Position:  0.013007777496207667
Bond Position:  [7.25198934]


portfolio before change:  [8.60580202]
curr_Stock_Price:  104.04232578876459
curr_Factors:  [104.04232579]
mat_Sqrt:  [[0.15]]
grads:  [0.05490152]
Stock Position:  0.05490151514279863
Bond Position:  [2.8937207]


portfolio before change:  [8.60599887]
curr_Stock_Price:  104.04261687892314
curr_Factors:  [104.04261688]
mat_Sqrt:  [[0.15]]
grads:  [-0.06389784]
Stock Position:  -0.06389784096491094
Bond Position:  [15.25409746]


portfolio before change:  [8.65007976]
curr_Stock_Price:  103.36767254827882
curr_Factors:  [103.36767255]
mat_Sqrt:  [[0.15]]
grads:  [-0.03820534]
Stock Position:  -0.038205340016818745
Bond Position:  [12.59927684]


portfolio before change:  [8.61624236]
curr_Stock_Price:  104.27395633374155
curr_Factors:  [104.27395633]
mat_Sqrt:  [[0.15]]
grads:  [0.28177598]
Stock Position:  0.28177597549108613
Bond Position:  [-20.7656534]


portfolio before change:  [8.76847845]
curr_Stock_Price:  104.81883591766167
curr_Factors:  [104.81883592]
mat_Sqrt:  [[0.15]]
grads:  [0.02256888]
Stock Position:  0.022568876196490357
Bond Position:  [6.40283512]


portfolio before change:  [8.78045976]
curr_Stock_Price:  105.3319817509981
curr_Factors:  [105.33198175]
mat_Sqrt:  [[0.15]]
grads:  [-0.06314921]
Stock Position:  -0.06314921272389577
Bond Position:  [15.43209148]


portfolio before change:  [8.80336493]
curr_Stock_Price:  104.9845405610939
curr_Factors:  [104.98454056]
mat_Sqrt:  [[0.15]]
grads:  [-0.0239595]
Stock Position:  -0.02395949756505599
Bond Position:  [11.31874178]


portfolio before change:  [8.80916961]
curr_Stock_Price:  104.77179687128752
curr_Factors:  [104.77179687]
mat_Sqrt:  [[0.15]]
grads:  [-0.03641159]
Stock Position:  -0.0364115920763204
Bond Position:  [12.62407754]


portfolio before change:  [8.80813452]
curr_Stock_Price:  104.82189400961896
curr_Factors:  [104.82189401]
mat_Sqrt:  [[0.15]]
grads:  [-0.01701641]
Stock Position:  -0.0170164078481254
Bond Position:  [10.59182662]


portfolio before change:  [8.8060294]
curr_Stock_Price:  104.98450969600901
curr_Factors:  [104.9845097]
mat_Sqrt:  [[0.15]]
grads:  [-0.01106979]
Stock Position:  -0.011069787936786025
Bond Position:  [9.96818566]


portfolio before change:  [8.80464208]
curr_Stock_Price:  105.16611671470316
curr_Factors:  [105.16611671]
mat_Sqrt:  [[0.15]]
grads:  [0.04083786]
Stock Position:  0.040837864019529845
Bond Position:  [4.5098825]


portfolio before change:  [8.78107335]
curr_Stock_Price:  104.58208517758395
curr_Factors:  [104.58208518]
mat_Sqrt:  [[0.15]]
grads:  [-0.04618773]
Stock Position:  -0.046187729243475216
Bond Position:  [13.61148239]


portfolio before change:  [8.77153285]
curr_Stock_Price:  104.80706378237602
curr_Factors:  [104.80706378]
mat_Sqrt:  [[0.15]]
grads:  [-0.35743285]
Stock Position:  -0.3574328543637073
Bond Position:  [46.23302081]


portfolio before change:  [8.74026646]
curr_Stock_Price:  104.90262309911202
curr_Factors:  [104.9026231]
mat_Sqrt:  [[0.15]]
grads:  [-0.02863884]
Stock Position:  -0.028638839107759564
Bond Position:  [11.74455581]


portfolio before change:  [8.75793643]
curr_Stock_Price:  104.31126161301985
curr_Factors:  [104.31126161]
mat_Sqrt:  [[0.15]]
grads:  [0.10444768]
Stock Position:  0.10444768311067068
Bond Position:  [-2.13713317]


portfolio before change:  [8.86147814]
curr_Stock_Price:  105.30386653772386
curr_Factors:  [105.30386654]
mat_Sqrt:  [[0.15]]
grads:  [-0.10471647]
Stock Position:  -0.1047164747775929
Bond Position:  [19.88852782]


portfolio before change:  [8.87305661]
curr_Stock_Price:  105.2051676170543
curr_Factors:  [105.20516762]
mat_Sqrt:  [[0.15]]
grads:  [-0.03655667]
Stock Position:  -0.03655666985503654
Bond Position:  [12.71900719]


portfolio before change:  [8.83637483]
curr_Stock_Price:  106.23033589317257
curr_Factors:  [106.23033589]
mat_Sqrt:  [[0.15]]
grads:  [0.02118496]
Stock Position:  0.021184964600783895
Bond Position:  [6.58588893]


portfolio before change:  [8.82897376]
curr_Stock_Price:  105.86155051063334
curr_Factors:  [105.86155051]
mat_Sqrt:  [[0.15]]
grads:  [-0.09034865]
Stock Position:  -0.09034865302046657
Bond Position:  [18.39342226]


portfolio before change:  [8.78076637]
curr_Stock_Price:  106.4078454416722
curr_Factors:  [106.40784544]
mat_Sqrt:  [[0.15]]
grads:  [0.15320851]
Stock Position:  0.15320851306998712
Bond Position:  [-7.52182141]


portfolio before change:  [8.81612838]
curr_Stock_Price:  106.64172364481806
curr_Factors:  [106.64172364]
mat_Sqrt:  [[0.15]]
grads:  [0.25416689]
Stock Position:  0.2541668890166698
Bond Position:  [-18.28866676]


portfolio before change:  [8.6535046]
curr_Stock_Price:  106.00639030407051
curr_Factors:  [106.0063903]
mat_Sqrt:  [[0.15]]
grads:  [-0.08893958]
Stock Position:  -0.08893957967557034
Bond Position:  [18.0816684]


portfolio before change:  [8.65297064]
curr_Stock_Price:  106.02510077338488
curr_Factors:  [106.02510077]
mat_Sqrt:  [[0.15]]
grads:  [-0.03097172]
Stock Position:  -0.030971715871261775
Bond Position:  [11.93674994]


portfolio before change:  [8.65181736]
curr_Stock_Price:  106.08642591265503
curr_Factors:  [106.08642591]
mat_Sqrt:  [[0.15]]
grads:  [0.02449632]
Stock Position:  0.0244963201129887
Bond Position:  [6.05309032]


portfolio before change:  [8.65700783]
curr_Stock_Price:  106.28286922794508
curr_Factors:  [106.28286923]
mat_Sqrt:  [[0.15]]
grads:  [0.02286186]
Stock Position:  0.02286186023982123
Bond Position:  [6.22718373]


portfolio before change:  [8.66534075]
curr_Stock_Price:  106.63033445087443
curr_Factors:  [106.63033445]
mat_Sqrt:  [[0.15]]
grads:  [-0.04423872]
Stock Position:  -0.0442387230903995
Bond Position:  [13.38253058]


portfolio before change:  [8.6516364]
curr_Stock_Price:  106.95902336549872
curr_Factors:  [106.95902337]
mat_Sqrt:  [[0.15]]
grads:  [-0.08483425]
Stock Position:  -0.08483424953444221
Bond Position:  [17.72542488]


portfolio before change:  [8.65911852]
curr_Stock_Price:  106.8838857468683
curr_Factors:  [106.88388575]
mat_Sqrt:  [[0.15]]
grads:  [0.08623215]
Stock Position:  0.08623215433841723
Bond Position:  [-0.55770921]


portfolio before change:  [8.61871632]
curr_Stock_Price:  106.41576168695114
curr_Factors:  [106.41576169]
mat_Sqrt:  [[0.15]]
grads:  [-0.2129721]
Stock Position:  -0.21297209656165147
Bond Position:  [31.28230419]


portfolio before change:  [8.47237208]
curr_Stock_Price:  107.11209443440346
curr_Factors:  [107.11209443]
mat_Sqrt:  [[0.15]]
grads:  [-0.07301676]
Stock Position:  -0.07301676019256852
Bond Position:  [16.29335019]


portfolio before change:  [8.48148407]
curr_Stock_Price:  107.00124820240323
curr_Factors:  [107.0012482]
mat_Sqrt:  [[0.15]]
grads:  [0.14121847]
Stock Position:  0.14121846764848836
Bond Position:  [-6.62906823]


portfolio before change:  [8.47861088]
curr_Stock_Price:  106.98383646072615
curr_Factors:  [106.98383646]
mat_Sqrt:  [[0.15]]
grads:  [-0.06481547]
Stock Position:  -0.06481546742012483
Bond Position:  [15.41281825]


portfolio before change:  [8.50000828]
curr_Stock_Price:  106.66857123319936
curr_Factors:  [106.66857123]
mat_Sqrt:  [[0.15]]
grads:  [0.08796398]
Stock Position:  0.08796397547429653
Bond Position:  [-0.8829833]


portfolio before change:  [8.48335207]
curr_Stock_Price:  106.47984602380488
curr_Factors:  [106.47984602]
mat_Sqrt:  [[0.15]]
grads:  [-0.09205591]
Stock Position:  -0.0920559126389324
Bond Position:  [18.28545147]


portfolio before change:  [8.56340177]
curr_Stock_Price:  105.62268409955928
curr_Factors:  [105.6226841]
mat_Sqrt:  [[0.15]]
grads:  [-0.08480504]
Stock Position:  -0.08480503546445167
Bond Position:  [17.52073724]


portfolio before change:  [8.54722492]
curr_Stock_Price:  105.82635039723999
curr_Factors:  [105.8263504]
mat_Sqrt:  [[0.15]]
grads:  [-0.01967631]
Stock Position:  -0.01967631358189381
Bond Position:  [10.62949738]


portfolio before change:  [8.55694029]
curr_Stock_Price:  105.36635538090582
curr_Factors:  [105.36635538]
mat_Sqrt:  [[0.15]]
grads:  [0.40164512]
Stock Position:  0.40164512458683294
Bond Position:  [-33.76294264]


portfolio before change:  [8.64230726]
curr_Stock_Price:  105.58415266208941
curr_Factors:  [105.58415266]
mat_Sqrt:  [[0.15]]
grads:  [-0.10456599]
Stock Position:  -0.10456599448770541
Bond Position:  [19.68281919]


portfolio before change:  [8.63725507]
curr_Stock_Price:  105.64423346211379
curr_Factors:  [105.64423346]
mat_Sqrt:  [[0.15]]
grads:  [0.07789755]
Stock Position:  0.07789754688807637
Bond Position:  [0.40782844]


portfolio before change:  [8.60710287]
curr_Stock_Price:  105.25683114278263
curr_Factors:  [105.25683114]
mat_Sqrt:  [[0.15]]
grads:  [0.03208635]
Stock Position:  0.032086347876050435
Bond Position:  [5.22979557]


portfolio before change:  [8.61783844]
curr_Stock_Price:  105.58122780573188
curr_Factors:  [105.58122781]
mat_Sqrt:  [[0.15]]
grads:  [0.08429768]
Stock Position:  0.08429768342766221
Bond Position:  [-0.28241447]


portfolio before change:  [8.66518946]
curr_Stock_Price:  106.14314912571814
curr_Factors:  [106.14314913]
mat_Sqrt:  [[0.15]]
grads:  [-0.17687723]
Stock Position:  -0.1768772260803531
Bond Position:  [27.43949524]


portfolio before change:  [8.74643303]
curr_Stock_Price:  105.69352337720493
curr_Factors:  [105.69352338]
mat_Sqrt:  [[0.15]]
grads:  [-0.05271309]
Stock Position:  -0.05271308703491425
Bond Position:  [14.31786493]


portfolio before change:  [8.72230417]
curr_Stock_Price:  106.16823956738577
curr_Factors:  [106.16823957]
mat_Sqrt:  [[0.15]]
grads:  [-0.03858782]
Stock Position:  -0.03858782452810183
Bond Position:  [12.81910557]


portfolio before change:  [8.73497209]
curr_Stock_Price:  105.86071527712568
curr_Factors:  [105.86071528]
mat_Sqrt:  [[0.15]]
grads:  [0.06827145]
Stock Position:  0.0682714464251315
Bond Position:  [1.50770793]


portfolio before change:  [8.81089093]
curr_Stock_Price:  106.97134964659521
curr_Factors:  [106.97134965]
mat_Sqrt:  [[0.15]]
grads:  [0.03214207]
Stock Position:  0.03214206683922178
Bond Position:  [5.37261066]


portfolio before change:  [8.81364389]
curr_Stock_Price:  107.04655184081057
curr_Factors:  [107.04655184]
mat_Sqrt:  [[0.15]]
grads:  [-0.01201589]
Stock Position:  -0.012015890884966452
Bond Position:  [10.09990357]


portfolio before change:  [8.80641879]
curr_Stock_Price:  107.70038269073768
curr_Factors:  [107.70038269]
mat_Sqrt:  [[0.15]]
grads:  [0.03284421]
Stock Position:  0.03284420806103874
Bond Position:  [5.26908501]


portfolio before change:  [8.8101496]
curr_Stock_Price:  107.80394684880363
curr_Factors:  [107.80394685]
mat_Sqrt:  [[0.15]]
grads:  [0.02075399]
Stock Position:  0.020753990092531965
Bond Position:  [6.57278756]


portfolio before change:  [8.78630845]
curr_Stock_Price:  106.63540241336905
curr_Factors:  [106.63540241]
mat_Sqrt:  [[0.15]]
grads:  [-0.01837784]
Stock Position:  -0.018377838199975356
Bond Position:  [10.74603663]


portfolio before change:  [8.79701767]
curr_Stock_Price:  106.0892246775149
curr_Factors:  [106.08922468]
mat_Sqrt:  [[0.15]]
grads:  [0.14523229]
Stock Position:  0.1452322942099336
Bond Position:  [-6.61056382]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.79701767]
Stock Price:  105.33026687345247
PL:  [3.4667508]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-8.47872893e-02]
 [ 1.00549202e-03]
 [ 7.70417501e-03]
 [ 2.95373428e-03]
 [ 5.56440637e-03]
 [ 1.21873720e-02]
 [ 8.59912514e-04]
 [ 1.00156398e-02]
 [-4.79951789e-04]
 [-1.01154387e-02]
 [ 1.00910054e-02]
 [-7.72180727e-03]
 [ 1.43282791e-02]
 [ 4.26177296e-03]
 [-4.66090940e-03]
 [-7.12325477e-03]
 [ 1.14501718e-02]
 [ 2.09181665e-02]
 [-2.71451971e-02]
 [-5.81444430e-03]
 [-1.71643963e-02]
 [-8.19309646e-03]
 [-3.53095022e-03]
 [ 2.75856021e-03]
 [ 1.85749442e-02]
 [ 1.37397614e-02]
 [ 6.94360091e-03]
 [ 4.52626699e-03]
 [ 8.56787633e-03]
 [-9.23497821e-03]
 [-5.78120621e-03]
 [ 4.19784472e-02]
 [ 4.71241156e-03]
 [-2.21108958e-03]
 [-7.11771656e-04]
 [-4.36116163e-03]
 [-7.07503587e-03]
 [ 9.06465031e-03]
 [ 6.87920844e-04]
 [-9.66541603e-03]
 [-9.79829784e-03]
 [-2.42122585e-03]
 [ 1.06484388e-02]
 [-1.15839345e-02]
 [ 1.45418092e-04]
 [ 2.27656571e-03]
 [-1.36489762e-02]
 [-2.38179373e-04]
 [ 3.39531964e-03]
 [-4.18041058e-03]
 [-3.33846513e-03]
 [ 3.71572479e-03]
 [ 6.24260586e-04]
 [ 1.19569929e-03]
 [ 2.45279515e-03]
 [ 8.55497663e-03]
 [-2.84006324e-03]
 [-1.99352391e-02]
 [ 1.38258495e-02]
 [ 7.81414069e-03]
 [ 1.05378461e-02]
 [-1.37923154e-02]
 [-1.26699546e-02]
 [-2.85419026e-03]
 [-1.99414039e-02]
 [ 7.84426143e-03]
 [ 2.66015209e-02]
 [ 1.90967472e-03]
 [ 6.95260563e-03]
 [-1.35862597e-02]
 [-8.06924894e-03]
 [-4.81382536e-03]
 [ 1.75714106e-03]
 [ 7.85596054e-03]
 [-6.69212298e-04]
 [-1.21766736e-02]
 [ 4.22534640e-03]
 [-7.17276300e-03]
 [ 9.98702356e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.69639887]
curr_Stock_Price:  100.94027662847726
curr_Factors:  [100.94027663]
mat_Sqrt:  [[0.15]]
grads:  [-0.5652486]
Stock Position:  -0.5652485951674069
Bond Position:  [73.75274843]


portfolio before change:  [16.66206266]
curr_Stock_Price:  101.00917710626169
curr_Factors:  [101.00917711]
mat_Sqrt:  [[0.15]]
grads:  [0.00670328]
Stock Position:  0.0067032801635791405
Bond Position:  [15.98496984]


portfolio before change:  [16.6657898]
curr_Stock_Price:  101.41615023994845
curr_Factors:  [101.41615024]
mat_Sqrt:  [[0.15]]
grads:  [0.05136117]
Stock Position:  0.051361166746601676
Bond Position:  [11.456938]


portfolio before change:  [16.6661296]
curr_Stock_Price:  101.40882398251073
curr_Factors:  [101.40882398]
mat_Sqrt:  [[0.15]]
grads:  [0.01969156]
Stock Position:  0.019691561848263213
Bond Position:  [14.66923147]


portfolio before change:  [16.67225427]
curr_Stock_Price:  101.67329324695135
curr_Factors:  [101.67329325]
mat_Sqrt:  [[0.15]]
grads:  [0.03709604]
Stock Position:  0.03709604248186077
Bond Position:  [12.90057746]


portfolio before change:  [16.677267]
curr_Stock_Price:  101.7866859761561
curr_Factors:  [101.78668598]
mat_Sqrt:  [[0.15]]
grads:  [0.08124915]
Stock Position:  0.08124914663251183
Bond Position:  [8.40718563]


portfolio before change:  [16.5891279]
curr_Stock_Price:  100.69541831729683
curr_Factors:  [100.69541832]
mat_Sqrt:  [[0.15]]
grads:  [0.00573275]
Stock Position:  0.005732750094485065
Bond Position:  [16.01186623]


portfolio before change:  [16.58649376]
curr_Stock_Price:  100.06135692498711
curr_Factors:  [100.06135692]
mat_Sqrt:  [[0.15]]
grads:  [0.06677093]
Stock Position:  0.06677093193369328
Bond Position:  [9.90530371]


portfolio before change:  [16.63162471]
curr_Stock_Price:  100.72799205973345
curr_Factors:  [100.72799206]
mat_Sqrt:  [[0.15]]
grads:  [-0.00319968]
Stock Position:  -0.0031996785952916125
Bond Position:  [16.95392191]


portfolio before change:  [16.62963307]
curr_Stock_Price:  101.68161570956816
curr_Factors:  [101.68161571]
mat_Sqrt:  [[0.15]]
grads:  [-0.06743626]
Stock Position:  -0.06743625827717378
Bond Position:  [23.48666077]


portfolio before change:  [16.64919776]
curr_Stock_Price:  101.41326263765586
curr_Factors:  [101.41326264]
mat_Sqrt:  [[0.15]]
grads:  [0.06727337]
Stock Position:  0.06727336901449604
Bond Position:  [9.82678592]


portfolio before change:  [16.63769633]
curr_Stock_Price:  101.23316715856731
curr_Factors:  [101.23316716]
mat_Sqrt:  [[0.15]]
grads:  [-0.05147872]
Stock Position:  -0.05147871513348057
Bond Position:  [21.8490497]


portfolio before change:  [16.62212462]
curr_Stock_Price:  101.56218293727446
curr_Factors:  [101.56218294]
mat_Sqrt:  [[0.15]]
grads:  [0.09552186]
Stock Position:  0.09552186045610975
Bond Position:  [6.92071596]


portfolio before change:  [16.62800103]
curr_Stock_Price:  101.61917351373668
curr_Factors:  [101.61917351]
mat_Sqrt:  [[0.15]]
grads:  [0.02841182]
Stock Position:  0.028411819759819913
Bond Position:  [13.74081539]


portfolio before change:  [16.65311006]
curr_Stock_Price:  102.47269870907984
curr_Factors:  [102.47269871]
mat_Sqrt:  [[0.15]]
grads:  [-0.03107273]
Stock Position:  -0.031072729308298415
Bond Position:  [19.83721649]


portfolio before change:  [16.61868737]
curr_Stock_Price:  103.62041090191539
curr_Factors:  [103.6204109]
mat_Sqrt:  [[0.15]]
grads:  [-0.04748837]
Stock Position:  -0.04748836511096146
Bond Position:  [21.53945128]


portfolio before change:  [16.64977979]
curr_Stock_Price:  102.99402257847531
curr_Factors:  [102.99402258]
mat_Sqrt:  [[0.15]]
grads:  [0.07633448]
Stock Position:  0.07633447862931217
Bond Position:  [8.78778477]


portfolio before change:  [16.72395332]
curr_Stock_Price:  103.95851827512998
curr_Factors:  [103.95851828]
mat_Sqrt:  [[0.15]]
grads:  [0.13945444]
Stock Position:  0.1394544431362579
Bond Position:  [2.22647604]


portfolio before change:  [16.86278033]
curr_Stock_Price:  104.95302117838197
curr_Factors:  [104.95302118]
mat_Sqrt:  [[0.15]]
grads:  [-0.18096798]
Stock Position:  -0.180967980353055
Bond Position:  [35.8559166]


portfolio before change:  [16.83023943]
curr_Stock_Price:  105.14522071706998
curr_Factors:  [105.14522072]
mat_Sqrt:  [[0.15]]
grads:  [-0.03876296]
Stock Position:  -0.03876296196893725
Bond Position:  [20.90597962]


portfolio before change:  [16.82840482]
curr_Stock_Price:  105.22625881920867
curr_Factors:  [105.22625882]
mat_Sqrt:  [[0.15]]
grads:  [-0.11442931]
Stock Position:  -0.11442930846865328
Bond Position:  [28.86937285]


portfolio before change:  [16.82859165]
curr_Stock_Price:  105.24039467140075
curr_Factors:  [105.24039467]
mat_Sqrt:  [[0.15]]
grads:  [-0.05462064]
Stock Position:  -0.054620643071272616
Bond Position:  [22.57688969]


portfolio before change:  [16.89317367]
curr_Stock_Price:  104.08385545716456
curr_Factors:  [104.08385546]
mat_Sqrt:  [[0.15]]
grads:  [-0.02353967]
Stock Position:  -0.02353966811615136
Bond Position:  [19.34327308]


portfolio before change:  [16.8978372]
curr_Stock_Price:  103.93710137478284
curr_Factors:  [103.93710137]
mat_Sqrt:  [[0.15]]
grads:  [0.0183904]
Stock Position:  0.018390401393105986
Bond Position:  [14.98639219]


portfolio before change:  [16.90669764]
curr_Stock_Price:  104.36796508734062
curr_Factors:  [104.36796509]
mat_Sqrt:  [[0.15]]
grads:  [0.12383296]
Stock Position:  0.1238329615615288
Bond Position:  [3.98250343]


portfolio before change:  [16.95535223]
curr_Stock_Price:  104.75886003396776
curr_Factors:  [104.75886003]
mat_Sqrt:  [[0.15]]
grads:  [0.09159841]
Stock Position:  0.09159840965160024
Bond Position:  [7.35960726]


portfolio before change:  [16.94077799]
curr_Stock_Price:  104.59472801164358
curr_Factors:  [104.59472801]
mat_Sqrt:  [[0.15]]
grads:  [0.04629067]
Stock Position:  0.046290672722478075
Bond Position:  [12.09901767]


portfolio before change:  [16.94619565]
curr_Stock_Price:  104.69542751442057
curr_Factors:  [104.69542751]
mat_Sqrt:  [[0.15]]
grads:  [0.03017511]
Stock Position:  0.030175113268867473
Bond Position:  [13.78699927]


portfolio before change:  [16.93425955]
curr_Stock_Price:  104.27130919854416
curr_Factors:  [104.2713092]
mat_Sqrt:  [[0.15]]
grads:  [0.05711918]
Stock Position:  0.05711917554750685
Bond Position:  [10.97836833]


portfolio before change:  [16.9587948]
curr_Stock_Price:  104.68884117261828
curr_Factors:  [104.68884117]
mat_Sqrt:  [[0.15]]
grads:  [-0.06156652]
Stock Position:  -0.061566521406470405
Bond Position:  [23.40412258]


portfolio before change:  [16.97621968]
curr_Stock_Price:  104.42957553634592
curr_Factors:  [104.42957554]
mat_Sqrt:  [[0.15]]
grads:  [-0.03854137]
Stock Position:  -0.038541374749063426
Bond Position:  [21.00107909]


portfolio before change:  [16.98869702]
curr_Stock_Price:  104.13989392350537
curr_Factors:  [104.13989392]
mat_Sqrt:  [[0.15]]
grads:  [0.27985631]
Stock Position:  0.27985631485636114
Bond Position:  [-12.15550992]


portfolio before change:  [16.92685274]
curr_Stock_Price:  103.92162283823663
curr_Factors:  [103.92162284]
mat_Sqrt:  [[0.15]]
grads:  [0.03141608]
Stock Position:  0.03141607706011788
Bond Position:  [13.66204302]


portfolio before change:  [16.88521748]
curr_Stock_Price:  102.56915737360701
curr_Factors:  [102.56915737]
mat_Sqrt:  [[0.15]]
grads:  [-0.0147406]
Stock Position:  -0.014740597215492004
Bond Position:  [18.39714812]


portfolio before change:  [16.90150758]
curr_Stock_Price:  101.54204576048751
curr_Factors:  [101.54204576]
mat_Sqrt:  [[0.15]]
grads:  [-0.00474514]
Stock Position:  -0.004745144373867402
Bond Position:  [17.38333924]


portfolio before change:  [16.89944321]
curr_Stock_Price:  102.20606254175172
curr_Factors:  [102.20606254]
mat_Sqrt:  [[0.15]]
grads:  [-0.02907441]
Stock Position:  -0.02907441084762205
Bond Position:  [19.87102427]


portfolio before change:  [16.9167515]
curr_Stock_Price:  101.6534699165894
curr_Factors:  [101.65346992]
mat_Sqrt:  [[0.15]]
grads:  [-0.04716691]
Stock Position:  -0.047166905823039194
Bond Position:  [21.71143114]


portfolio before change:  [16.92510724]
curr_Stock_Price:  101.50508755337586
curr_Factors:  [101.50508755]
mat_Sqrt:  [[0.15]]
grads:  [0.060431]
Stock Position:  0.06043100206846636
Bond Position:  [10.79105309]


portfolio before change:  [16.93587295]
curr_Stock_Price:  101.6720754985306
curr_Factors:  [101.6720755]
mat_Sqrt:  [[0.15]]
grads:  [0.00458614]
Stock Position:  0.0045861389600355875
Bond Position:  [16.46959069]


portfolio before change:  [16.93570058]
curr_Stock_Price:  101.4100344846835
curr_Factors:  [101.41003448]
mat_Sqrt:  [[0.15]]
grads:  [-0.06443611]
Stock Position:  -0.06443610683701545
Bond Position:  [23.47016839]


portfolio before change:  [16.95887832]
curr_Stock_Price:  101.07309903093157
curr_Factors:  [101.07309903]
mat_Sqrt:  [[0.15]]
grads:  [-0.06532199]
Stock Position:  -0.06532198560198538
Bond Position:  [23.56117384]


portfolio before change:  [16.89964484]
curr_Stock_Price:  102.00243546735433
curr_Factors:  [102.00243547]
mat_Sqrt:  [[0.15]]
grads:  [-0.01614151]
Stock Position:  -0.016141505660198157
Bond Position:  [18.54611773]


portfolio before change:  [16.90294212]
curr_Stock_Price:  101.86997486848414
curr_Factors:  [101.86997487]
mat_Sqrt:  [[0.15]]
grads:  [0.07098959]
Stock Position:  0.07098959206612572
Bond Position:  [9.67123416]


portfolio before change:  [16.96059185]
curr_Stock_Price:  102.67354702356394
curr_Factors:  [102.67354702]
mat_Sqrt:  [[0.15]]
grads:  [-0.07722623]
Stock Position:  -0.0772262300370652
Bond Position:  [24.88968281]


portfolio before change:  [16.99762217]
curr_Stock_Price:  102.214186620364
curr_Factors:  [102.21418662]
mat_Sqrt:  [[0.15]]
grads:  [0.00096945]
Stock Position:  0.0009694539452929976
Bond Position:  [16.89853023]


portfolio before change:  [16.99876996]
curr_Stock_Price:  102.30866849509736
curr_Factors:  [102.3086685]
mat_Sqrt:  [[0.15]]
grads:  [0.0151771]
Stock Position:  0.015177104727148508
Bond Position:  [15.44602058]


portfolio before change:  [17.00060906]
curr_Stock_Price:  102.36623509062603
curr_Factors:  [102.36623509]
mat_Sqrt:  [[0.15]]
grads:  [-0.09099317]
Stock Position:  -0.0909931747963586
Bond Position:  [26.31523778]


portfolio before change:  [17.00196831]
curr_Stock_Price:  102.36937273433239
curr_Factors:  [102.36937273]
mat_Sqrt:  [[0.15]]
grads:  [-0.00158786]
Stock Position:  -0.0015878624895468603
Bond Position:  [17.1645168]


portfolio before change:  [17.00301083]
curr_Stock_Price:  102.38845316032942
curr_Factors:  [102.38845316]
mat_Sqrt:  [[0.15]]
grads:  [0.02263546]
Stock Position:  0.022635464271537738
Bond Position:  [14.68540066]


portfolio before change:  [17.0036733]
curr_Stock_Price:  102.37717005116129
curr_Factors:  [102.37717005]
mat_Sqrt:  [[0.15]]
grads:  [-0.0278694]
Stock Position:  -0.027869403874132167
Bond Position:  [19.856864]


portfolio before change:  [17.00038829]
curr_Stock_Price:  102.53957399291079
curr_Factors:  [102.53957399]
mat_Sqrt:  [[0.15]]
grads:  [-0.02225643]
Stock Position:  -0.022256434214581487
Bond Position:  [19.28255357]


portfolio before change:  [17.01885198]
curr_Stock_Price:  101.76413568001266
curr_Factors:  [101.76413568]
mat_Sqrt:  [[0.15]]
grads:  [0.0247715]
Stock Position:  0.024771498627488387
Bond Position:  [14.49800183]


portfolio before change:  [17.02866019]
curr_Stock_Price:  102.12350246214065
curr_Factors:  [102.12350246]
mat_Sqrt:  [[0.15]]
grads:  [0.00416174]
Stock Position:  0.0041617372390522975
Bond Position:  [16.603649]


portfolio before change:  [17.02667235]
curr_Stock_Price:  101.39649858320603
curr_Factors:  [101.39649858]
mat_Sqrt:  [[0.15]]
grads:  [0.00797133]
Stock Position:  0.00797132858751161
Bond Position:  [16.21840754]


portfolio before change:  [17.02275476]
curr_Stock_Price:  100.77787287734796
curr_Factors:  [100.77787288]
mat_Sqrt:  [[0.15]]
grads:  [0.01635197]
Stock Position:  0.01635196764544165
Bond Position:  [15.37483824]


portfolio before change:  [17.02478717]
curr_Stock_Price:  100.8433972467344
curr_Factors:  [100.84339725]
mat_Sqrt:  [[0.15]]
grads:  [0.05703318]
Stock Position:  0.057033177529757534
Bond Position:  [11.27336779]


portfolio before change:  [17.03182585]
curr_Stock_Price:  100.9544566048973
curr_Factors:  [100.9544566]
mat_Sqrt:  [[0.15]]
grads:  [-0.01893375]
Stock Position:  -0.018933754907346785
Bond Position:  [18.94327278]


portfolio before change:  [17.03434662]
curr_Stock_Price:  100.88385337747812
curr_Factors:  [100.88385338]
mat_Sqrt:  [[0.15]]
grads:  [-0.13290159]
Stock Position:  -0.13290159427833903
Bond Position:  [30.44197157]


portfolio before change:  [17.11450684]
curr_Stock_Price:  100.29501520929628
curr_Factors:  [100.29501521]
mat_Sqrt:  [[0.15]]
grads:  [0.09217233]
Stock Position:  0.09217233031872156
Bond Position:  [7.87008156]


portfolio before change:  [17.15585941]
curr_Stock_Price:  100.73832266726684
curr_Factors:  [100.73832267]
mat_Sqrt:  [[0.15]]
grads:  [0.05209427]
Stock Position:  0.0520942712689126
Bond Position:  [11.9079699]


portfolio before change:  [17.22375414]
curr_Stock_Price:  102.02734065392251
curr_Factors:  [102.02734065]
mat_Sqrt:  [[0.15]]
grads:  [0.07025231]
Stock Position:  0.07025230764430034
Bond Position:  [10.05609801]


portfolio before change:  [17.21111195]
curr_Stock_Price:  101.83843986823011
curr_Factors:  [101.83843987]
mat_Sqrt:  [[0.15]]
grads:  [-0.09194877]
Stock Position:  -0.09194876918065255
Bond Position:  [26.57503115]


portfolio before change:  [17.19540159]
curr_Stock_Price:  102.02736406762727
curr_Factors:  [102.02736407]
mat_Sqrt:  [[0.15]]
grads:  [-0.08446636]
Stock Position:  -0.08446636373043781
Bond Position:  [25.81328203]


portfolio before change:  [17.2164511]
curr_Stock_Price:  101.79725914879526
curr_Factors:  [101.79725915]
mat_Sqrt:  [[0.15]]
grads:  [-0.01902794]
Stock Position:  -0.01902793509408314
Bond Position:  [19.15344274]


portfolio before change:  [17.23003831]
curr_Stock_Price:  101.14610698015049
curr_Factors:  [101.14610698]
mat_Sqrt:  [[0.15]]
grads:  [-0.13294269]
Stock Position:  -0.13294269293522568
Bond Position:  [30.67667415]


portfolio before change:  [17.15886809]
curr_Stock_Price:  101.69587444049448
curr_Factors:  [101.69587444]
mat_Sqrt:  [[0.15]]
grads:  [0.05229508]
Stock Position:  0.05229507621567188
Bond Position:  [11.84067459]


portfolio before change:  [17.16192715]
curr_Stock_Price:  101.74021882212763
curr_Factors:  [101.74021882]
mat_Sqrt:  [[0.15]]
grads:  [0.17734347]
Stock Position:  0.17734347241513873
Bond Position:  [-0.88103654]


portfolio before change:  [17.2021269]
curr_Stock_Price:  101.96720669695989
curr_Factors:  [101.9672067]
mat_Sqrt:  [[0.15]]
grads:  [0.01273116]
Stock Position:  0.012731164825059508
Bond Position:  [15.90396558]


portfolio before change:  [17.20679012]
curr_Stock_Price:  102.2554118296454
curr_Factors:  [102.25541183]
mat_Sqrt:  [[0.15]]
grads:  [0.0463507]
Stock Position:  0.046350704220271995
Bond Position:  [12.46717977]


portfolio before change:  [17.16569769]
curr_Stock_Price:  101.35204591228221
curr_Factors:  [101.35204591]
mat_Sqrt:  [[0.15]]
grads:  [-0.09057506]
Stock Position:  -0.090575064477106
Bond Position:  [26.34566579]


portfolio before change:  [17.12144876]
curr_Stock_Price:  101.8587592217461
curr_Factors:  [101.85875922]
mat_Sqrt:  [[0.15]]
grads:  [-0.05379499]
Stock Position:  -0.05379499293439555
Bond Position:  [22.60093999]


portfolio before change:  [17.15131769]
curr_Stock_Price:  101.32978185783534
curr_Factors:  [101.32978186]
mat_Sqrt:  [[0.15]]
grads:  [-0.03209217]
Stock Position:  -0.03209216907280199
Bond Position:  [20.40321019]


portfolio before change:  [17.13309452]
curr_Stock_Price:  101.9373574289169
curr_Factors:  [101.93735743]
mat_Sqrt:  [[0.15]]
grads:  [0.01171427]
Stock Position:  0.011714273718215715
Bond Position:  [15.93897241]


portfolio before change:  [17.1401124]
curr_Stock_Price:  102.4514027574682
curr_Factors:  [102.45140276]
mat_Sqrt:  [[0.15]]
grads:  [0.05237307]
Stock Position:  0.05237307024143435
Bond Position:  [11.77441789]


portfolio before change:  [17.16228548]
curr_Stock_Price:  102.86071912734765
curr_Factors:  [102.86071913]
mat_Sqrt:  [[0.15]]
grads:  [-0.00446142]
Stock Position:  -0.004461415319591255
Bond Position:  [17.62118987]


portfolio before change:  [17.16710313]
curr_Stock_Price:  102.02773370198301
curr_Factors:  [102.0277337]
mat_Sqrt:  [[0.15]]
grads:  [-0.08117782]
Stock Position:  -0.08117782393158901
Bond Position:  [25.44949254]


portfolio before change:  [17.1767291]
curr_Stock_Price:  101.92874945995094
curr_Factors:  [101.92874946]
mat_Sqrt:  [[0.15]]
grads:  [0.02816898]
Stock Position:  0.028168975978337618
Bond Position:  [14.30550061]


portfolio before change:  [17.1571411]
curr_Stock_Price:  101.20163328099693
curr_Factors:  [101.20163328]
mat_Sqrt:  [[0.15]]
grads:  [-0.04781842]
Stock Position:  -0.04781842000055895
Bond Position:  [21.99644331]


portfolio before change:  [17.16988154]
curr_Stock_Price:  100.96395047484492
curr_Factors:  [100.96395047]
mat_Sqrt:  [[0.15]]
grads:  [0.06658016]
Stock Position:  0.06658015707240071
Bond Position:  [10.44768586]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.16988154]
Stock Price:  101.55608368568613
PL:  [15.61379786]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-6.46628758e-02]
 [ 2.14358674e-03]
 [ 1.22084333e-03]
 [ 2.62259586e-03]
 [ 5.53784302e-03]
 [ 1.19579286e-02]
 [-3.63996191e-04]
 [ 6.42629751e-03]
 [-5.15935922e-03]
 [-1.94529173e-02]
 [ 1.01759581e-02]
 [-6.56949549e-03]
 [ 4.06506784e-03]
 [ 4.22614133e-03]
 [ 6.46129890e-04]
 [-1.01541745e-02]
 [ 1.34718377e-02]
 [ 1.90892578e-02]
 [ 1.82315293e-02]
 [-1.55326538e-04]
 [ 7.99522801e-02]
 [-1.30454370e-02]
 [ 2.13600296e-03]
 [ 3.32961654e-03]
 [ 1.56556236e-02]
 [ 7.66489837e-03]
 [ 1.22186269e-02]
 [ 5.04289601e-03]
 [ 5.91194871e-03]
 [-1.44201797e-02]
 [-5.64863820e-03]
 [ 3.19433905e-02]
 [ 6.49613484e-03]
 [-9.03594595e-04]
 [-5.65549902e-03]
 [-4.25938002e-03]
 [-6.58814474e-03]
 [ 6.51789460e-03]
 [ 8.80668519e-04]
 [-8.71222941e-03]
 [-1.61157258e-02]
 [-2.41728287e-03]
 [ 1.30505560e-02]
 [-1.15839771e-02]
 [-7.47059892e-04]
 [ 2.34697177e-03]
 [-1.36423125e-02]
 [ 4.61244766e-03]
 [ 7.26796588e-03]
 [-1.04432845e-02]
 [-3.82708472e-03]
 [ 3.45144439e-03]
 [ 2.02421513e-03]
 [ 3.79317352e-03]
 [-2.74987805e-03]
 [ 8.71468731e-03]
 [-6.69402362e-03]
 [-1.25733267e-02]
 [ 1.39488150e-02]
 [ 9.82855806e-04]
 [ 1.25521506e-02]
 [-1.49600783e-02]
 [-1.27595185e-02]
 [-3.35211017e-03]
 [ 1.61144341e-02]
 [-1.72158833e-02]
 [ 1.94731666e-02]
 [ 4.72051236e-03]
 [ 1.02178764e-02]
 [-1.92090609e-02]
 [-7.78018857e-03]
 [-7.42429051e-03]
 [ 1.71464829e-03]
 [ 7.46247060e-03]
 [ 4.54540572e-04]
 [-1.26614009e-02]
 [ 4.88662895e-03]
 [-5.65108584e-03]
 [ 1.83317297e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.56536195]
curr_Stock_Price:  100.61050150143551
curr_Factors:  [100.6105015]
mat_Sqrt:  [[0.15]]
grads:  [-0.43108584]
Stock Position:  -0.4310858385091584
Bond Position:  [54.93712435]


portfolio before change:  [11.29457308]
curr_Stock_Price:  101.24662202851536
curr_Factors:  [101.24662203]
mat_Sqrt:  [[0.15]]
grads:  [0.01429058]
Stock Position:  0.014290578291790744
Bond Position:  [9.8477003]


portfolio before change:  [11.28898843]
curr_Stock_Price:  100.81275918249283
curr_Factors:  [100.81275918]
mat_Sqrt:  [[0.15]]
grads:  [0.00813896]
Stock Position:  0.008138955538063465
Bond Position:  [10.46847786]


portfolio before change:  [11.29166083]
curr_Stock_Price:  101.06071592558847
curr_Factors:  [101.06071593]
mat_Sqrt:  [[0.15]]
grads:  [0.01748397]
Stock Position:  0.01748397240887424
Bond Position:  [9.52471807]


portfolio before change:  [11.29257689]
curr_Stock_Price:  101.07906060292318
curr_Factors:  [101.0790606]
mat_Sqrt:  [[0.15]]
grads:  [0.03691895]
Stock Position:  0.036918953453483574
Bond Position:  [7.56084375]


portfolio before change:  [11.29125136]
curr_Stock_Price:  101.03035675963977
curr_Factors:  [101.03035676]
mat_Sqrt:  [[0.15]]
grads:  [0.07971952]
Stock Position:  0.07971952415920072
Bond Position:  [3.23715939]


portfolio before change:  [11.35731477]
curr_Stock_Price:  101.85651680022951
curr_Factors:  [101.8565168]
mat_Sqrt:  [[0.15]]
grads:  [-0.00242664]
Stock Position:  -0.002426641272741167
Bond Position:  [11.604484]


portfolio before change:  [11.35842188]
curr_Stock_Price:  101.6991785555394
curr_Factors:  [101.69917856]
mat_Sqrt:  [[0.15]]
grads:  [0.04284198]
Stock Position:  0.04284198337078916
Bond Position:  [7.00142736]


portfolio before change:  [11.34005753]
curr_Stock_Price:  101.26031121387695
curr_Factors:  [101.26031121]
mat_Sqrt:  [[0.15]]
grads:  [-0.03439573]
Stock Position:  -0.034395728165295125
Bond Position:  [14.82297967]


portfolio before change:  [11.33994621]
curr_Stock_Price:  101.29048334673293
curr_Factors:  [101.29048335]
mat_Sqrt:  [[0.15]]
grads:  [-0.12968612]
Stock Position:  -0.12968611541225492
Bond Position:  [24.47591552]


portfolio before change:  [11.37841856]
curr_Stock_Price:  101.00562203153758
curr_Factors:  [101.00562203]
mat_Sqrt:  [[0.15]]
grads:  [0.06783972]
Stock Position:  0.06783972090124407
Bond Position:  [4.52622535]


portfolio before change:  [11.35942367]
curr_Stock_Price:  100.72145536063704
curr_Factors:  [100.72145536]
mat_Sqrt:  [[0.15]]
grads:  [-0.04379664]
Stock Position:  -0.04379663657734806
Bond Position:  [15.77068464]


portfolio before change:  [11.35529993]
curr_Stock_Price:  100.83811800119231
curr_Factors:  [100.838118]
mat_Sqrt:  [[0.15]]
grads:  [0.02710045]
Stock Position:  0.027100452244827624
Bond Position:  [8.62254133]


portfolio before change:  [11.35285518]
curr_Stock_Price:  100.72802107971206
curr_Factors:  [100.72802108]
mat_Sqrt:  [[0.15]]
grads:  [0.02817428]
Stock Position:  0.028174275552157343
Bond Position:  [8.51491616]


portfolio before change:  [11.37807271]
curr_Stock_Price:  101.60418660838252
curr_Factors:  [101.60418661]
mat_Sqrt:  [[0.15]]
grads:  [0.00430753]
Stock Position:  0.004307532600186041
Bond Position:  [10.94040937]


portfolio before change:  [11.37718023]
curr_Stock_Price:  101.23825021706786
curr_Factors:  [101.23825022]
mat_Sqrt:  [[0.15]]
grads:  [-0.0676945]
Stock Position:  -0.06769449661235458
Bond Position:  [18.23045261]


portfolio before change:  [11.42780573]
curr_Stock_Price:  100.50722964784572
curr_Factors:  [100.50722965]
mat_Sqrt:  [[0.15]]
grads:  [0.08981225]
Stock Position:  0.08981225151121701
Bond Position:  [2.40102515]


portfolio before change:  [11.47571955]
curr_Stock_Price:  101.0390473189471
curr_Factors:  [101.03904732]
mat_Sqrt:  [[0.15]]
grads:  [0.12726172]
Stock Position:  0.12726171874279094
Bond Position:  [-1.38268328]


portfolio before change:  [11.55696481]
curr_Stock_Price:  101.67813723106262
curr_Factors:  [101.67813723]
mat_Sqrt:  [[0.15]]
grads:  [0.12154353]
Stock Position:  0.12154352845298275
Bond Position:  [-0.80135476]


portfolio before change:  [11.54017673]
curr_Stock_Price:  101.54042532350759
curr_Factors:  [101.54042532]
mat_Sqrt:  [[0.15]]
grads:  [-0.00103551]
Stock Position:  -0.0010355102517205692
Bond Position:  [11.64532288]


portfolio before change:  [11.54194957]
curr_Stock_Price:  100.53127899329951
curr_Factors:  [100.53127899]
mat_Sqrt:  [[0.15]]
grads:  [0.5330152]
Stock Position:  0.5330152008912548
Bond Position:  [-42.0427503]


portfolio before change:  [12.02634415]
curr_Stock_Price:  101.44499090068321
curr_Factors:  [101.4449909]
mat_Sqrt:  [[0.15]]
grads:  [-0.08696958]
Stock Position:  -0.08696958001464854
Bond Position:  [20.8489724]


portfolio before change:  [12.08635385]
curr_Stock_Price:  100.76996632879911
curr_Factors:  [100.76996633]
mat_Sqrt:  [[0.15]]
grads:  [0.01424002]
Stock Position:  0.0142400197058433
Bond Position:  [10.65138755]


portfolio before change:  [12.08959888]
curr_Stock_Price:  100.95109659279095
curr_Factors:  [100.95109659]
mat_Sqrt:  [[0.15]]
grads:  [0.02219744]
Stock Position:  0.022197443570535713
Bond Position:  [9.84874261]


portfolio before change:  [12.09857716]
curr_Stock_Price:  101.32783884045332
curr_Factors:  [101.32783884]
mat_Sqrt:  [[0.15]]
grads:  [0.10437082]
Stock Position:  0.10437082393767186
Bond Position:  [1.52290714]


portfolio before change:  [12.09459944]
curr_Stock_Price:  101.28881544491797
curr_Factors:  [101.28881544]
mat_Sqrt:  [[0.15]]
grads:  [0.05109932]
Stock Position:  0.05109932245780438
Bond Position:  [6.9188096]


portfolio before change:  [12.09052531]
curr_Stock_Price:  101.20062295319313
curr_Factors:  [101.20062295]
mat_Sqrt:  [[0.15]]
grads:  [0.08145751]
Stock Position:  0.08145751295593716
Bond Position:  [3.84697425]


portfolio before change:  [12.13032349]
curr_Stock_Price:  101.68624716825735
curr_Factors:  [101.68624717]
mat_Sqrt:  [[0.15]]
grads:  [0.03361931]
Stock Position:  0.033619306748909505
Bond Position:  [8.71170236]


portfolio before change:  [12.15668197]
curr_Stock_Price:  102.4540790638862
curr_Factors:  [102.45407906]
mat_Sqrt:  [[0.15]]
grads:  [0.03941299]
Stock Position:  0.039412991418038994
Bond Position:  [8.11866023]


portfolio before change:  [12.16573422]
curr_Stock_Price:  102.67088127182276
curr_Factors:  [102.67088127]
mat_Sqrt:  [[0.15]]
grads:  [-0.09613453]
Stock Position:  -0.09613453148585883
Bond Position:  [22.03595129]


portfolio before change:  [12.22161485]
curr_Stock_Price:  102.10393262039055
curr_Factors:  [102.10393262]
mat_Sqrt:  [[0.15]]
grads:  [-0.03765759]
Stock Position:  -0.037657587967963944
Bond Position:  [16.06660268]


portfolio before change:  [12.22071539]
curr_Stock_Price:  102.15448441876431
curr_Factors:  [102.15448442]
mat_Sqrt:  [[0.15]]
grads:  [0.21295594]
Stock Position:  0.2129559369416052
Bond Position:  [-9.53368855]


portfolio before change:  [12.33962992]
curr_Stock_Price:  102.71568220334672
curr_Factors:  [102.7156822]
mat_Sqrt:  [[0.15]]
grads:  [0.04330757]
Stock Position:  0.04330756557176386
Bond Position:  [7.89126377]


portfolio before change:  [12.32448157]
curr_Stock_Price:  102.35450820796802
curr_Factors:  [102.35450821]
mat_Sqrt:  [[0.15]]
grads:  [-0.00602396]
Stock Position:  -0.006023963968691294
Bond Position:  [12.94106144]


portfolio before change:  [12.32152108]
curr_Stock_Price:  102.98023040646302
curr_Factors:  [102.98023041]
mat_Sqrt:  [[0.15]]
grads:  [-0.03770333]
Stock Position:  -0.03770332677782645
Bond Position:  [16.20421836]


portfolio before change:  [12.34650102]
curr_Stock_Price:  102.34455316828878
curr_Factors:  [102.34455317]
mat_Sqrt:  [[0.15]]
grads:  [-0.02839587]
Stock Position:  -0.028395866819875173
Bond Position:  [15.25266333]


portfolio before change:  [12.34259297]
curr_Stock_Price:  102.51575336940242
curr_Factors:  [102.51575337]
mat_Sqrt:  [[0.15]]
grads:  [-0.04392096]
Stock Position:  -0.04392096495090745
Bond Position:  [16.84518378]


portfolio before change:  [12.37343542]
curr_Stock_Price:  101.83749879732748
curr_Factors:  [101.8374988]
mat_Sqrt:  [[0.15]]
grads:  [0.04345263]
Stock Position:  0.04345263065301242
Bond Position:  [7.9483282]


portfolio before change:  [12.37431156]
curr_Stock_Price:  101.84622913508264
curr_Factors:  [101.84622914]
mat_Sqrt:  [[0.15]]
grads:  [0.00587112]
Stock Position:  0.0058711234609233
Bond Position:  [11.77635978]


portfolio before change:  [12.37601478]
curr_Stock_Price:  102.01096296264997
curr_Factors:  [102.01096296]
mat_Sqrt:  [[0.15]]
grads:  [-0.05808153]
Stock Position:  -0.05808152941077782
Bond Position:  [18.30096752]


portfolio before change:  [12.40911858]
curr_Stock_Price:  101.4607027961032
curr_Factors:  [101.4607028]
mat_Sqrt:  [[0.15]]
grads:  [-0.10743817]
Stock Position:  -0.10743817179424349
Bond Position:  [23.309871]


portfolio before change:  [12.33747381]
curr_Stock_Price:  102.1411098005263
curr_Factors:  [102.1411098]
mat_Sqrt:  [[0.15]]
grads:  [-0.01611522]
Stock Position:  -0.016115219158179032
Bond Position:  [13.98350018]


portfolio before change:  [12.32378254]
curr_Stock_Price:  103.0449298816661
curr_Factors:  [103.04492988]
mat_Sqrt:  [[0.15]]
grads:  [0.08700371]
Stock Position:  0.08700370698151569
Bond Position:  [3.35849166]


portfolio before change:  [12.28964222]
curr_Stock_Price:  102.65011641057767
curr_Factors:  [102.65011641]
mat_Sqrt:  [[0.15]]
grads:  [-0.07722651]
Stock Position:  -0.07722651415247485
Bond Position:  [20.21695289]


portfolio before change:  [12.26999503]
curr_Stock_Price:  102.92088861287111
curr_Factors:  [102.92088861]
mat_Sqrt:  [[0.15]]
grads:  [-0.0049804]
Stock Position:  -0.0049803992788294
Bond Position:  [12.78258214]


portfolio before change:  [12.27190095]
curr_Stock_Price:  102.69861992322205
curr_Factors:  [102.69861992]
mat_Sqrt:  [[0.15]]
grads:  [0.01564648]
Stock Position:  0.01564647848281421
Bond Position:  [10.6650292]


portfolio before change:  [12.27079563]
curr_Stock_Price:  102.58537384597804
curr_Factors:  [102.58537385]
mat_Sqrt:  [[0.15]]
grads:  [-0.09094875]
Stock Position:  -0.09094874984499125
Bond Position:  [21.60080714]


portfolio before change:  [12.20840734]
curr_Stock_Price:  103.28619029530473
curr_Factors:  [103.2861903]
mat_Sqrt:  [[0.15]]
grads:  [0.03074965]
Stock Position:  0.030749651052019752
Bond Position:  [9.03239303]


portfolio before change:  [12.20990093]
curr_Stock_Price:  103.31640349023036
curr_Factors:  [103.31640349]
mat_Sqrt:  [[0.15]]
grads:  [0.04845311]
Stock Position:  0.04845310583807292
Bond Position:  [7.2039003]


portfolio before change:  [12.23611876]
curr_Stock_Price:  103.8482077627962
curr_Factors:  [103.84820776]
mat_Sqrt:  [[0.15]]
grads:  [-0.0696219]
Stock Position:  -0.06962189651577458
Bond Position:  [19.46622793]


portfolio before change:  [12.23890513]
curr_Stock_Price:  103.82566172258164
curr_Factors:  [103.82566172]
mat_Sqrt:  [[0.15]]
grads:  [-0.0255139]
Stock Position:  -0.025513898164615873
Bond Position:  [14.88790249]


portfolio before change:  [12.243529]
curr_Stock_Price:  103.68090378150289
curr_Factors:  [103.68090378]
mat_Sqrt:  [[0.15]]
grads:  [0.02300963]
Stock Position:  0.023009629263398255
Bond Position:  [9.85786984]


portfolio before change:  [12.23731619]
curr_Stock_Price:  103.38411752958706
curr_Factors:  [103.38411753]
mat_Sqrt:  [[0.15]]
grads:  [0.01349477]
Stock Position:  0.013494767564594137
Bond Position:  [10.84217155]


portfolio before change:  [12.23396862]
curr_Stock_Price:  103.0858371323463
curr_Factors:  [103.08583713]
mat_Sqrt:  [[0.15]]
grads:  [0.02528782]
Stock Position:  0.025287823437083277
Bond Position:  [9.62715217]


portfolio before change:  [12.22287126]
curr_Stock_Price:  102.62320011147968
curr_Factors:  [102.62320011]
mat_Sqrt:  [[0.15]]
grads:  [-0.01833252]
Stock Position:  -0.0183325203405525
Bond Position:  [14.10421316]


portfolio before change:  [12.22686207]
curr_Stock_Price:  102.45359588927941
curr_Factors:  [102.45359589]
mat_Sqrt:  [[0.15]]
grads:  [0.05809792]
Stock Position:  0.05809791539368746
Bond Position:  [6.27452172]


portfolio before change:  [12.23544059]
curr_Stock_Price:  102.59450191792057
curr_Factors:  [102.59450192]
mat_Sqrt:  [[0.15]]
grads:  [-0.04462682]
Stock Position:  -0.04462682412268982
Bond Position:  [16.81390738]


portfolio before change:  [12.23290443]
curr_Stock_Price:  102.67488088457797
curr_Factors:  [102.67488088]
mat_Sqrt:  [[0.15]]
grads:  [-0.08382218]
Stock Position:  -0.08382217808297539
Bond Position:  [20.83933658]


portfolio before change:  [12.25315478]
curr_Stock_Price:  102.44883267136677
curr_Factors:  [102.44883267]
mat_Sqrt:  [[0.15]]
grads:  [0.0929921]
Stock Position:  0.09299209992270838
Bond Position:  [2.7262227]


portfolio before change:  [12.33918866]
curr_Stock_Price:  103.37217437493119
curr_Factors:  [103.37217437]
mat_Sqrt:  [[0.15]]
grads:  [0.00655237]
Stock Position:  0.00655237203754808
Bond Position:  [11.66185572]


portfolio before change:  [12.34158496]
curr_Stock_Price:  103.62664803568282
curr_Factors:  [103.62664804]
mat_Sqrt:  [[0.15]]
grads:  [0.083681]
Stock Position:  0.0836810036720961
Bond Position:  [3.67000304]


portfolio before change:  [12.36469623]
curr_Stock_Price:  103.90008992298935
curr_Factors:  [103.90008992]
mat_Sqrt:  [[0.15]]
grads:  [-0.09973386]
Stock Position:  -0.09973385542276389
Bond Position:  [22.72705278]


portfolio before change:  [12.359447]
curr_Stock_Price:  103.96696507803047
curr_Factors:  [103.96696508]
mat_Sqrt:  [[0.15]]
grads:  [-0.08506346]
Stock Position:  -0.08506345663912655
Bond Position:  [21.20323642]


portfolio before change:  [12.37575254]
curr_Stock_Price:  103.79085779058978
curr_Factors:  [103.79085779]
mat_Sqrt:  [[0.15]]
grads:  [-0.0223474]
Stock Position:  -0.022347401163623878
Bond Position:  [14.69520847]


portfolio before change:  [12.37434945]
curr_Stock_Price:  103.89474288198932
curr_Factors:  [103.89474288]
mat_Sqrt:  [[0.15]]
grads:  [0.10742956]
Stock Position:  0.10742956068405733
Bond Position:  [1.21298287]


portfolio before change:  [12.43973668]
curr_Stock_Price:  104.50268926786786
curr_Factors:  [104.50268927]
mat_Sqrt:  [[0.15]]
grads:  [-0.11477256]
Stock Position:  -0.11477255546399542
Bond Position:  [24.43377738]


portfolio before change:  [12.479729]
curr_Stock_Price:  104.16754679989772
curr_Factors:  [104.1675468]
mat_Sqrt:  [[0.15]]
grads:  [0.12982111]
Stock Position:  0.12982111086654174
Bond Position:  [-1.04341765]


portfolio before change:  [12.60506054]
curr_Stock_Price:  105.13346642609488
curr_Factors:  [105.13346643]
mat_Sqrt:  [[0.15]]
grads:  [0.03147008]
Stock Position:  0.03147008240221706
Bond Position:  [9.29650169]


portfolio before change:  [12.56918012]
curr_Stock_Price:  103.97485900373083
curr_Factors:  [103.974859]
mat_Sqrt:  [[0.15]]
grads:  [0.06811918]
Stock Position:  0.06811917597013008
Bond Position:  [5.4864984]


portfolio before change:  [12.52902068]
curr_Stock_Price:  103.38027816149109
curr_Factors:  [103.38027816]
mat_Sqrt:  [[0.15]]
grads:  [-0.12806041]
Stock Position:  -0.12806040605998353
Bond Position:  [25.76794108]


portfolio before change:  [12.49362431]
curr_Stock_Price:  103.66925826891377
curr_Factors:  [103.66925827]
mat_Sqrt:  [[0.15]]
grads:  [-0.05186792]
Stock Position:  -0.051867923786180534
Bond Position:  [17.8707335]


portfolio before change:  [12.50443519]
curr_Stock_Price:  103.48236194321873
curr_Factors:  [103.48236194]
mat_Sqrt:  [[0.15]]
grads:  [-0.04949527]
Stock Position:  -0.04949527007847379
Bond Position:  [17.62632265]


portfolio before change:  [12.56056379]
curr_Stock_Price:  102.37060090023597
curr_Factors:  [102.3706009]
mat_Sqrt:  [[0.15]]
grads:  [0.01143099]
Stock Position:  0.011430988584267476
Bond Position:  [11.39036662]


portfolio before change:  [12.56866259]
curr_Stock_Price:  103.01681665120118
curr_Factors:  [103.01681665]
mat_Sqrt:  [[0.15]]
grads:  [0.0497498]
Stock Position:  0.0497498040107954
Bond Position:  [7.44359615]


portfolio before change:  [12.54209902]
curr_Stock_Price:  102.47352171886034
curr_Factors:  [102.47352172]
mat_Sqrt:  [[0.15]]
grads:  [0.00303027]
Stock Position:  0.003030270480758185
Bond Position:  [12.23157653]


portfolio before change:  [12.54226635]
curr_Stock_Price:  102.27645633027363
curr_Factors:  [102.27645633]
mat_Sqrt:  [[0.15]]
grads:  [-0.08440934]
Stock Position:  -0.08440933955438504
Bond Position:  [21.17535448]


portfolio before change:  [12.55000572]
curr_Stock_Price:  102.20044733312822
curr_Factors:  [102.20044733]
mat_Sqrt:  [[0.15]]
grads:  [0.03257753]
Stock Position:  0.03257752636395209
Bond Position:  [9.22056795]


portfolio before change:  [12.53608003]
curr_Stock_Price:  101.75529407183133
curr_Factors:  [101.75529407]
mat_Sqrt:  [[0.15]]
grads:  [-0.03767391]
Stock Position:  -0.037673905607062574
Bond Position:  [16.36959938]


portfolio before change:  [12.51213724]
curr_Stock_Price:  102.41797896558786
curr_Factors:  [102.41797897]
mat_Sqrt:  [[0.15]]
grads:  [0.12221153]
Stock Position:  0.12221153160213452
Bond Position:  [-0.00452084]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.51213724]
Stock Price:  102.47709265982488
PL:  [10.03504458]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.58872092e-02]
 [ 1.60060808e-04]
 [-3.82187140e-05]
 [ 1.68590254e-03]
 [-2.38774550e-02]
 [ 2.30522080e-03]
 [ 1.26811458e-03]
 [ 2.72977798e-04]
 [ 1.25613985e-02]
 [-1.93400229e-02]
 [ 6.11523998e-03]
 [-1.00253345e-02]
 [ 8.72648461e-03]
 [ 6.30716277e-03]
 [-2.27355597e-02]
 [ 1.65710778e-02]
 [-3.31996877e-03]
 [-1.29791627e-03]
 [-8.64152493e-03]
 [ 1.45742434e-02]
 [-6.16585268e-02]
 [-2.88553490e-02]
 [ 4.98628290e-04]
 [ 7.69618188e-03]
 [ 4.24694694e-03]
 [ 1.03412531e-02]
 [ 1.47870362e-02]
 [-1.83729472e-02]
 [ 1.56930758e-03]
 [-1.11534147e-02]
 [-3.63030580e-03]
 [-2.03736333e-02]
 [ 1.98410481e-02]
 [ 1.03907390e-02]
 [-2.43831191e-02]
 [ 7.76249077e-03]
 [-2.75277834e-03]
 [ 5.53507390e-03]
 [ 4.27922371e-03]
 [-1.45985116e-02]
 [ 2.54016294e-02]
 [-7.89214637e-04]
 [ 3.43585283e-03]
 [-8.07205313e-03]
 [ 2.04300627e-03]
 [-1.69552766e-03]
 [-1.37075975e-02]
 [-5.09126069e-03]
 [-1.47314171e-04]
 [ 1.07874915e-02]
 [-3.15450007e-03]
 [ 2.97822123e-03]
 [ 3.31491993e-03]
 [ 1.32729684e-03]
 [ 4.17966258e-03]
 [ 8.93686105e-03]
 [ 1.57011756e-02]
 [-2.30691044e-02]
 [ 1.39130059e-02]
 [ 7.64760109e-03]
 [ 8.53400609e-03]
 [-1.35447430e-02]
 [-1.26754650e-02]
 [-2.81821519e-03]
 [-1.68021895e-02]
 [-3.32732830e-04]
 [ 2.88929896e-02]
 [ 2.36517184e-03]
 [ 6.34237332e-03]
 [-1.37318574e-02]
 [-8.22421612e-03]
 [-4.93136291e-03]
 [ 2.27732444e-03]
 [ 8.65065474e-03]
 [ 8.83945944e-03]
 [-8.51389688e-03]
 [-3.05113805e-03]
 [-8.57455255e-03]
 [ 9.42730205e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.89763079]
curr_Stock_Price:  99.68095541799121
curr_Factors:  [99.68095542]
mat_Sqrt:  [[0.15]]
grads:  [-0.23924806]
Stock Position:  -0.23924806129711357
Bond Position:  [20.95084454]


portfolio before change:  [-2.89847106]
curr_Stock_Price:  99.68994078359088
curr_Factors:  [99.68994078]
mat_Sqrt:  [[0.15]]
grads:  [0.00106707]
Stock Position:  0.0010670720522827262
Bond Position:  [-3.00484741]


portfolio before change:  [-2.89872536]
curr_Stock_Price:  99.62762769204441
curr_Factors:  [99.62762769]
mat_Sqrt:  [[0.15]]
grads:  [-0.00025479]
Stock Position:  -0.00025479142662434076
Bond Position:  [-2.87334109]


portfolio before change:  [-2.89891654]
curr_Stock_Price:  99.67312477035436
curr_Factors:  [99.67312477]
mat_Sqrt:  [[0.15]]
grads:  [0.01123935]
Stock Position:  0.011239350235039138
Bond Position:  [-4.0191777]


portfolio before change:  [-2.91707304]
curr_Stock_Price:  98.08003489194128
curr_Factors:  [98.08003489]
mat_Sqrt:  [[0.15]]
grads:  [-0.15918303]
Stock Position:  -0.15918303354706112
Bond Position:  [12.69560444]


portfolio before change:  [-2.89848239]
curr_Stock_Price:  97.96823180385053
curr_Factors:  [97.9682318]
mat_Sqrt:  [[0.15]]
grads:  [0.01536814]
Stock Position:  0.015368138676955193
Bond Position:  [-4.40407176]


portfolio before change:  [-2.89653644]
curr_Stock_Price:  98.11276494639306
curr_Factors:  [98.11276495]
mat_Sqrt:  [[0.15]]
grads:  [0.0084541]
Stock Position:  0.008454097211056595
Bond Position:  [-3.7259913]


portfolio before change:  [-2.89751169]
curr_Stock_Price:  98.02495436621352
curr_Factors:  [98.02495437]
mat_Sqrt:  [[0.15]]
grads:  [0.00181985]
Stock Position:  0.0018198519865528693
Bond Position:  [-3.07590259]


portfolio before change:  [-2.89670972]
curr_Stock_Price:  98.57127149997277
curr_Factors:  [98.5712715]
mat_Sqrt:  [[0.15]]
grads:  [0.08374266]
Stock Position:  0.0837426566723655
Bond Position:  [-11.15132987]


portfolio before change:  [-2.82716313]
curr_Stock_Price:  99.41007420332568
curr_Factors:  [99.4100742]
mat_Sqrt:  [[0.15]]
grads:  [-0.12893349]
Stock Position:  -0.12893348602462115
Bond Position:  [9.99012428]


portfolio before change:  [-2.75235311]
curr_Stock_Price:  98.83469521246101
curr_Factors:  [98.83469521]
mat_Sqrt:  [[0.15]]
grads:  [0.04076827]
Stock Position:  0.04076826653080282
Bond Position:  [-6.78167231]


portfolio before change:  [-2.80057894]
curr_Stock_Price:  97.6621665361096
curr_Factors:  [97.66216654]
mat_Sqrt:  [[0.15]]
grads:  [-0.06683556]
Stock Position:  -0.06683556315372986
Bond Position:  [3.72672696]


portfolio before change:  [-2.78296757]
curr_Stock_Price:  97.40214858634181
curr_Factors:  [97.40214859]
mat_Sqrt:  [[0.15]]
grads:  [0.05817656]
Stock Position:  0.05817656404782749
Bond Position:  [-8.4494899]


portfolio before change:  [-2.7802074]
curr_Stock_Price:  97.45867095547644
curr_Factors:  [97.45867096]
mat_Sqrt:  [[0.15]]
grads:  [0.04204775]
Stock Position:  0.042047751818969505
Bond Position:  [-6.87812541]


portfolio before change:  [-2.77478679]
curr_Stock_Price:  97.59781048100427
curr_Factors:  [97.59781048]
mat_Sqrt:  [[0.15]]
grads:  [-0.1515704]
Stock Position:  -0.151570397836573
Bond Position:  [12.01815217]


portfolio before change:  [-2.77281963]
curr_Stock_Price:  97.58978779183126
curr_Factors:  [97.58978779]
mat_Sqrt:  [[0.15]]
grads:  [0.11047385]
Stock Position:  0.11047385178609244
Bond Position:  [-13.55393938]


portfolio before change:  [-2.76325525]
curr_Stock_Price:  97.6840320962904
curr_Factors:  [97.6840321]
mat_Sqrt:  [[0.15]]
grads:  [-0.02213313]
Stock Position:  -0.022133125100493308
Bond Position:  [-0.60120234]


portfolio before change:  [-2.76476172]
curr_Stock_Price:  97.7503983599333
curr_Factors:  [97.75039836]
mat_Sqrt:  [[0.15]]
grads:  [-0.00865278]
Stock Position:  -0.008652775163511262
Bond Position:  [-1.9189495]


portfolio before change:  [-2.76121485]
curr_Stock_Price:  97.3266260907697
curr_Factors:  [97.32662609]
mat_Sqrt:  [[0.15]]
grads:  [-0.05761017]
Stock Position:  -0.05761016617094543
Bond Position:  [2.84578825]


portfolio before change:  [-2.73926943]
curr_Stock_Price:  96.9487839544873
curr_Factors:  [96.94878395]
mat_Sqrt:  [[0.15]]
grads:  [0.09716162]
Stock Position:  0.09716162282313577
Bond Position:  [-12.15897061]


portfolio before change:  [-2.78797319]
curr_Stock_Price:  96.45534022466869
curr_Factors:  [96.45534022]
mat_Sqrt:  [[0.15]]
grads:  [-0.41105685]
Stock Position:  -0.4110568450441894
Bond Position:  [36.86065465]


portfolio before change:  [-2.85793641]
curr_Stock_Price:  96.63114822897548
curr_Factors:  [96.63114823]
mat_Sqrt:  [[0.15]]
grads:  [-0.19236899]
Stock Position:  -0.1923689935594634
Bond Position:  [15.73090033]


portfolio before change:  [-2.95404077]
curr_Stock_Price:  97.13584275673114
curr_Factors:  [97.13584276]
mat_Sqrt:  [[0.15]]
grads:  [0.00332419]
Stock Position:  0.003324188600775582
Bond Position:  [-3.27693863]


portfolio before change:  [-2.95206972]
curr_Stock_Price:  97.79039857584299
curr_Factors:  [97.79039858]
mat_Sqrt:  [[0.15]]
grads:  [0.05130788]
Stock Position:  0.05130787920639676
Bond Position:  [-7.96948768]


portfolio before change:  [-2.91883978]
curr_Stock_Price:  98.44776445458133
curr_Factors:  [98.44776445]
mat_Sqrt:  [[0.15]]
grads:  [0.02831298]
Stock Position:  0.02831297963162825
Bond Position:  [-5.70618933]


portfolio before change:  [-2.92497091]
curr_Stock_Price:  98.24381265169872
curr_Factors:  [98.24381265]
mat_Sqrt:  [[0.15]]
grads:  [0.06894169]
Stock Position:  0.06894168748840791
Bond Position:  [-9.69806514]


portfolio before change:  [-2.96496063]
curr_Stock_Price:  97.67255349894326
curr_Factors:  [97.6725535]
mat_Sqrt:  [[0.15]]
grads:  [0.09858024]
Stock Position:  0.09858024107234922
Bond Position:  [-12.5935445]


portfolio before change:  [-2.95296877]
curr_Stock_Price:  97.80218371923897
curr_Factors:  [97.80218372]
mat_Sqrt:  [[0.15]]
grads:  [-0.12248631]
Stock Position:  -0.12248631494916179
Bond Position:  [9.02646031]


portfolio before change:  [-2.99606873]
curr_Stock_Price:  98.15866543140163
curr_Factors:  [98.15866543]
mat_Sqrt:  [[0.15]]
grads:  [0.01046205]
Stock Position:  0.010462050560461482
Bond Position:  [-4.02300965]


portfolio before change:  [-2.99012947]
curr_Stock_Price:  98.75039489675801
curr_Factors:  [98.7503949]
mat_Sqrt:  [[0.15]]
grads:  [-0.0743561]
Stock Position:  -0.07435609798365951
Bond Position:  [4.35256456]


portfolio before change:  [-2.94704378]
curr_Stock_Price:  98.17460288345498
curr_Factors:  [98.17460288]
mat_Sqrt:  [[0.15]]
grads:  [-0.02420204]
Stock Position:  -0.024202038692121588
Bond Position:  [-0.57101825]


portfolio before change:  [-2.93393588]
curr_Stock_Price:  97.63152507207006
curr_Factors:  [97.63152507]
mat_Sqrt:  [[0.15]]
grads:  [-0.13582422]
Stock Position:  -0.13582422208544595
Bond Position:  [10.32679006]


portfolio before change:  [-2.86312228]
curr_Stock_Price:  97.11491505031866
curr_Factors:  [97.11491505]
mat_Sqrt:  [[0.15]]
grads:  [0.13227365]
Stock Position:  0.13227365405433547
Bond Position:  [-15.70886696]


portfolio before change:  [-2.91220354]
curr_Stock_Price:  96.75127938731674
curr_Factors:  [96.75127939]
mat_Sqrt:  [[0.15]]
grads:  [0.06927159]
Stock Position:  0.06927159355274136
Bond Position:  [-9.61431884]


portfolio before change:  [-2.88827483]
curr_Stock_Price:  97.10538735360561
curr_Factors:  [97.10538735]
mat_Sqrt:  [[0.15]]
grads:  [-0.16255413]
Stock Position:  -0.1625541275786335
Bond Position:  [12.8966067]


portfolio before change:  [-2.95635541]
curr_Stock_Price:  97.52916402890516
curr_Factors:  [97.52916403]
mat_Sqrt:  [[0.15]]
grads:  [0.05174994]
Stock Position:  0.05174993849771495
Bond Position:  [-8.00348365]


portfolio before change:  [-2.95689194]
curr_Stock_Price:  97.52846269081633
curr_Factors:  [97.52846269]
mat_Sqrt:  [[0.15]]
grads:  [-0.01835186]
Stock Position:  -0.018351855586621012
Bond Position:  [-1.16706368]


portfolio before change:  [-2.96399968]
curr_Stock_Price:  97.91179135157303
curr_Factors:  [97.91179135]
mat_Sqrt:  [[0.15]]
grads:  [0.03690049]
Stock Position:  0.036900492659709516
Bond Position:  [-6.57699301]


portfolio before change:  [-2.97365028]
curr_Stock_Price:  97.66140096352999
curr_Factors:  [97.66140096]
mat_Sqrt:  [[0.15]]
grads:  [0.02852816]
Stock Position:  0.028528158078562016
Bond Position:  [-5.75975016]


portfolio before change:  [-2.95589564]
curr_Stock_Price:  98.29637488850463
curr_Factors:  [98.29637489]
mat_Sqrt:  [[0.15]]
grads:  [-0.09732341]
Stock Position:  -0.09732341086023893
Bond Position:  [6.61064284]


portfolio before change:  [-2.94064718]
curr_Stock_Price:  98.14394212114566
curr_Factors:  [98.14394212]
mat_Sqrt:  [[0.15]]
grads:  [0.1693442]
Stock Position:  0.16934419593410693
Bond Position:  [-19.56075415]


portfolio before change:  [-3.00642053]
curr_Stock_Price:  97.7627612966797
curr_Factors:  [97.7627613]
mat_Sqrt:  [[0.15]]
grads:  [-0.00526143]
Stock Position:  -0.005261430914282395
Bond Position:  [-2.49204851]


portfolio before change:  [-3.01032153]
curr_Stock_Price:  98.47459060841067
curr_Factors:  [98.47459061]
mat_Sqrt:  [[0.15]]
grads:  [0.02290569]
Stock Position:  0.022905685559042942
Bond Position:  [-5.26594954]


portfolio before change:  [-3.01659203]
curr_Stock_Price:  98.21520645953707
curr_Factors:  [98.21520646]
mat_Sqrt:  [[0.15]]
grads:  [-0.05381369]
Stock Position:  -0.05381368751515701
Bond Position:  [2.2687304]


portfolio before change:  [-3.03820586]
curr_Stock_Price:  98.61948339660387
curr_Factors:  [98.6194834]
mat_Sqrt:  [[0.15]]
grads:  [0.01362004]
Stock Position:  0.013620041794321336
Bond Position:  [-4.38140735]


portfolio before change:  [-3.02239188]
curr_Stock_Price:  99.80067174709976
curr_Factors:  [99.80067175]
mat_Sqrt:  [[0.15]]
grads:  [-0.01130352]
Stock Position:  -0.011303517745805684
Bond Position:  [-1.89429321]


portfolio before change:  [-3.03031765]
curr_Stock_Price:  100.4913750174125
curr_Factors:  [100.49137502]
mat_Sqrt:  [[0.15]]
grads:  [-0.09138398]
Stock Position:  -0.09138398319132479
Bond Position:  [6.15298448]


portfolio before change:  [-3.05810892]
curr_Stock_Price:  100.79969867960767
curr_Factors:  [100.79969868]
mat_Sqrt:  [[0.15]]
grads:  [-0.03394174]
Stock Position:  -0.033941737923029416
Bond Position:  [0.36320804]


portfolio before change:  [-3.05145898]
curr_Stock_Price:  100.60444522327984
curr_Factors:  [100.60444522]
mat_Sqrt:  [[0.15]]
grads:  [-0.00098209]
Stock Position:  -0.000982094472965729
Bond Position:  [-2.95265591]


portfolio before change:  [-3.05036078]
curr_Stock_Price:  99.29831280283051
curr_Factors:  [99.2983128]
mat_Sqrt:  [[0.15]]
grads:  [0.07191661]
Stock Position:  0.0719166097315791
Bond Position:  [-10.19155879]


portfolio before change:  [-3.10264983]
curr_Stock_Price:  98.58009126900663
curr_Factors:  [98.58009127]
mat_Sqrt:  [[0.15]]
grads:  [-0.02103]
Stock Position:  -0.021030000448656987
Bond Position:  [-1.02951047]


portfolio before change:  [-3.0714616]
curr_Stock_Price:  97.09399659048482
curr_Factors:  [97.09399659]
mat_Sqrt:  [[0.15]]
grads:  [0.01985481]
Stock Position:  0.01985480822490967
Bond Position:  [-4.99924429]


portfolio before change:  [-3.06549355]
curr_Stock_Price:  97.4103187641494
curr_Factors:  [97.41031876]
mat_Sqrt:  [[0.15]]
grads:  [0.02209947]
Stock Position:  0.022099466193343003
Bond Position:  [-5.2182096]


portfolio before change:  [-3.07207539]
curr_Stock_Price:  97.12724895557896
curr_Factors:  [97.12724896]
mat_Sqrt:  [[0.15]]
grads:  [0.00884865]
Stock Position:  0.008848645588087074
Bond Position:  [-3.93151999]


portfolio before change:  [-3.07053794]
curr_Stock_Price:  97.32876823947898
curr_Factors:  [97.32876824]
mat_Sqrt:  [[0.15]]
grads:  [0.02786442]
Stock Position:  0.02786441723315806
Bond Position:  [-5.78254735]


portfolio before change:  [-3.06327779]
curr_Stock_Price:  97.60229186660463
curr_Factors:  [97.60229187]
mat_Sqrt:  [[0.15]]
grads:  [0.05957907]
Stock Position:  0.05957907364890756
Bond Position:  [-8.87833192]


portfolio before change:  [-2.99611242]
curr_Stock_Price:  98.73893737006084
curr_Factors:  [98.73893737]
mat_Sqrt:  [[0.15]]
grads:  [0.1046745]
Stock Position:  0.10467450413178206
Bond Position:  [-13.33156172]


portfolio before change:  [-2.97636112]
curr_Stock_Price:  98.93559022011323
curr_Factors:  [98.93559022]
mat_Sqrt:  [[0.15]]
grads:  [-0.15379403]
Stock Position:  -0.1537940294800001
Bond Position:  [12.23934195]


portfolio before change:  [-2.97468782]
curr_Stock_Price:  98.92968410171441
curr_Factors:  [98.9296841]
mat_Sqrt:  [[0.15]]
grads:  [0.09275337]
Stock Position:  0.09275337271557986
Bond Position:  [-12.15074968]


portfolio before change:  [-2.89260815]
curr_Stock_Price:  99.82279568924439
curr_Factors:  [99.82279569]
mat_Sqrt:  [[0.15]]
grads:  [0.05098401]
Stock Position:  0.050984007292103076
Bond Position:  [-7.98197429]


portfolio before change:  [-2.85302979]
curr_Stock_Price:  100.6088706654725
curr_Factors:  [100.60887067]
mat_Sqrt:  [[0.15]]
grads:  [0.05689337]
Stock Position:  0.05689337394373064
Bond Position:  [-8.57700789]


portfolio before change:  [-2.79846601]
curr_Stock_Price:  101.57734648154299
curr_Factors:  [101.57734648]
mat_Sqrt:  [[0.15]]
grads:  [-0.09029829]
Stock Position:  -0.0902982867675614
Bond Position:  [6.37379435]


portfolio before change:  [-2.84518578]
curr_Stock_Price:  102.0991520518373
curr_Factors:  [102.09915205]
mat_Sqrt:  [[0.15]]
grads:  [-0.0845031]
Stock Position:  -0.0845030997550685
Bond Position:  [5.78250905]


portfolio before change:  [-2.81553876]
curr_Stock_Price:  101.75258953915898
curr_Factors:  [101.75258954]
mat_Sqrt:  [[0.15]]
grads:  [-0.0187881]
Stock Position:  -0.018788101270500453
Bond Position:  [-0.9038008]


portfolio before change:  [-2.82049523]
curr_Stock_Price:  102.01339171223557
curr_Factors:  [102.01339171]
mat_Sqrt:  [[0.15]]
grads:  [-0.1120146]
Stock Position:  -0.11201459661998081
Bond Position:  [8.6064937]


portfolio before change:  [-2.82955174]
curr_Stock_Price:  102.09904516467743
curr_Factors:  [102.09904516]
mat_Sqrt:  [[0.15]]
grads:  [-0.00221822]
Stock Position:  -0.0022182188642995383
Bond Position:  [-2.60307371]


portfolio before change:  [-2.83105192]
curr_Stock_Price:  102.70199619318096
curr_Factors:  [102.70199619]
mat_Sqrt:  [[0.15]]
grads:  [0.19261993]
Stock Position:  0.19261993074461375
Bond Position:  [-22.61350331]


portfolio before change:  [-2.86335867]
curr_Stock_Price:  102.54161108813854
curr_Factors:  [102.54161109]
mat_Sqrt:  [[0.15]]
grads:  [0.01576781]
Stock Position:  0.015767812279526918
Bond Position:  [-4.48021555]


portfolio before change:  [-2.87745622]
curr_Stock_Price:  101.66529880734842
curr_Factors:  [101.66529881]
mat_Sqrt:  [[0.15]]
grads:  [0.04228249]
Stock Position:  0.04228248878703117
Bond Position:  [-7.17611808]


portfolio before change:  [-2.8984095]
curr_Stock_Price:  101.18035204095857
curr_Factors:  [101.18035204]
mat_Sqrt:  [[0.15]]
grads:  [-0.09154572]
Stock Position:  -0.09154571571255776
Bond Position:  [6.36421825]


portfolio before change:  [-2.93704877]
curr_Stock_Price:  101.60677341524476
curr_Factors:  [101.60677342]
mat_Sqrt:  [[0.15]]
grads:  [-0.05482811]
Stock Position:  -0.05482810749162264
Bond Position:  [2.63385832]


portfolio before change:  [-2.92302557]
curr_Stock_Price:  101.35400933408184
curr_Factors:  [101.35400933]
mat_Sqrt:  [[0.15]]
grads:  [-0.03287575]
Stock Position:  -0.032875752740929555
Bond Position:  [0.40906378]


portfolio before change:  [-2.90617722]
curr_Stock_Price:  100.84230122244684
curr_Factors:  [100.84230122]
mat_Sqrt:  [[0.15]]
grads:  [0.01518216]
Stock Position:  0.01518216295903139
Bond Position:  [-4.43718147]


portfolio before change:  [-2.91108931]
curr_Stock_Price:  100.53702481188881
curr_Factors:  [100.53702481]
mat_Sqrt:  [[0.15]]
grads:  [0.05767103]
Stock Position:  0.05767103158084057
Bond Position:  [-8.70916324]


portfolio before change:  [-2.90028783]
curr_Stock_Price:  100.733758230026
curr_Factors:  [100.73375823]
mat_Sqrt:  [[0.15]]
grads:  [0.05892973]
Stock Position:  0.05892972961975794
Bond Position:  [-8.83650096]


portfolio before change:  [-2.93618946]
curr_Stock_Price:  100.1339025678269
curr_Factors:  [100.13390257]
mat_Sqrt:  [[0.15]]
grads:  [-0.05675931]
Stock Position:  -0.056759312532413814
Bond Position:  [2.74734201]


portfolio before change:  [-2.91203583]
curr_Stock_Price:  99.71138311556038
curr_Factors:  [99.71138312]
mat_Sqrt:  [[0.15]]
grads:  [-0.02034092]
Stock Position:  -0.020340920323135028
Bond Position:  [-0.88381453]


portfolio before change:  [-2.92054488]
curr_Stock_Price:  100.12698904697147
curr_Factors:  [100.12698905]
mat_Sqrt:  [[0.15]]
grads:  [-0.05716368]
Stock Position:  -0.05716368368296445
Bond Position:  [2.80308265]


portfolio before change:  [-2.91168374]
curr_Stock_Price:  99.97504056715493
curr_Factors:  [99.97504057]
mat_Sqrt:  [[0.15]]
grads:  [0.00628487]
Stock Position:  0.006284868032246048
Bond Position:  [-3.54001368]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.91168374]
Stock Price:  100.20263921060995
PL:  [-3.11432295]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.48142744e-02]
 [-2.29766324e-03]
 [ 9.68846961e-05]
 [ 2.59208569e-03]
 [ 6.27198805e-03]
 [ 1.20596279e-02]
 [ 1.86887926e-04]
 [ 6.63452635e-03]
 [-1.31642886e-03]
 [-2.04038600e-02]
 [ 9.35994723e-03]
 [-6.62827121e-03]
 [-8.88100303e-03]
 [ 4.31578892e-03]
 [ 5.20450845e-03]
 [-5.69945134e-03]
 [ 1.38097991e-02]
 [ 1.71363087e-02]
 [ 2.29472120e-02]
 [ 2.97948011e-03]
 [ 7.89796342e-02]
 [-1.33097036e-02]
 [ 1.66823654e-03]
 [ 1.41640767e-02]
 [ 8.77534561e-03]
 [-3.11321319e-03]
 [ 1.28111546e-02]
 [ 2.97263028e-03]
 [ 4.28442638e-03]
 [-2.32291347e-02]
 [-5.68640238e-03]
 [ 3.66251496e-02]
 [ 6.97041486e-03]
 [ 6.63774444e-03]
 [ 2.10407733e-03]
 [ 1.05993599e-03]
 [-2.75581496e-03]
 [ 1.14161250e-02]
 [ 1.08968708e-03]
 [-1.35337436e-02]
 [-9.55258492e-04]
 [-2.81272471e-03]
 [ 1.02635538e-02]
 [-1.27766828e-02]
 [ 1.29170971e-03]
 [ 2.28925338e-03]
 [-1.36236236e-02]
 [ 2.83553850e-03]
 [ 1.38708954e-02]
 [-1.15704964e-02]
 [-4.04826096e-03]
 [ 3.49524212e-03]
 [ 2.71087697e-03]
 [ 1.42616927e-03]
 [-5.96759372e-03]
 [ 9.22632746e-03]
 [-6.60737743e-03]
 [-1.22673272e-02]
 [ 1.45212474e-02]
 [ 3.10180447e-03]
 [ 1.13218150e-02]
 [-1.44903625e-02]
 [-1.26633997e-02]
 [-2.87283167e-03]
 [-1.81967601e-02]
 [ 2.78141248e-02]
 [ 2.09416265e-02]
 [ 2.00160073e-03]
 [ 6.86706949e-03]
 [-1.45965729e-02]
 [-5.32277586e-03]
 [-2.93469122e-04]
 [ 1.53205194e-03]
 [ 8.32226612e-03]
 [ 1.68653756e-03]
 [ 2.04954754e-03]
 [ 1.91318731e-03]
 [-1.09133235e-02]
 [-3.19543397e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.51400087]
curr_Stock_Price:  99.76988222588041
curr_Factors:  [99.76988223]
mat_Sqrt:  [[0.15]]
grads:  [-0.23209516]
Stock Position:  -0.2320951624081184
Bond Position:  [21.64210615]


portfolio before change:  [-1.61414873]
curr_Stock_Price:  100.20720515352905
curr_Factors:  [100.20720515]
mat_Sqrt:  [[0.15]]
grads:  [-0.01531775]
Stock Position:  -0.015317754946549203
Bond Position:  [-0.07919932]


portfolio before change:  [-1.61459256]
curr_Stock_Price:  100.23585661217632
curr_Factors:  [100.23585661]
mat_Sqrt:  [[0.15]]
grads:  [0.0006459]
Stock Position:  0.0006458979736684127
Bond Position:  [-1.67933469]


portfolio before change:  [-1.61418546]
curr_Stock_Price:  101.02864221889452
curr_Factors:  [101.02864222]
mat_Sqrt:  [[0.15]]
grads:  [0.01728057]
Stock Position:  0.017280571267269937
Bond Position:  [-3.36001811]


portfolio before change:  [-1.61130841]
curr_Stock_Price:  101.2072855299915
curr_Factors:  [101.20728553]
mat_Sqrt:  [[0.15]]
grads:  [0.04181325]
Stock Position:  0.041813253692233536
Bond Position:  [-5.84311432]


portfolio before change:  [-1.60505419]
curr_Stock_Price:  101.36559470088575
curr_Factors:  [101.3655947]
mat_Sqrt:  [[0.15]]
grads:  [0.08039752]
Stock Position:  0.08039751924075841
Bond Position:  [-9.75459655]


portfolio before change:  [-1.61166557]
curr_Stock_Price:  101.290944497518
curr_Factors:  [101.2909445]
mat_Sqrt:  [[0.15]]
grads:  [0.00124592]
Stock Position:  0.0012459195090241601
Bond Position:  [-1.73786593]


portfolio before change:  [-1.61176639]
curr_Stock_Price:  101.29720542600784
curr_Factors:  [101.29720543]
mat_Sqrt:  [[0.15]]
grads:  [0.04423018]
Stock Position:  0.0442301756885384
Bond Position:  [-6.09215958]


portfolio before change:  [-1.63427122]
curr_Stock_Price:  100.79700264886438
curr_Factors:  [100.79700265]
mat_Sqrt:  [[0.15]]
grads:  [-0.00877619]
Stock Position:  -0.008776192384429046
Bond Position:  [-0.74965733]


portfolio before change:  [-1.63358108]
curr_Stock_Price:  100.71302642603419
curr_Factors:  [100.71302643]
mat_Sqrt:  [[0.15]]
grads:  [-0.13602573]
Stock Position:  -0.13602573328996706
Bond Position:  [12.06598219]


portfolio before change:  [-1.54229106]
curr_Stock_Price:  100.04744742266357
curr_Factors:  [100.04744742]
mat_Sqrt:  [[0.15]]
grads:  [0.06239965]
Stock Position:  0.062399648217256236
Bond Position:  [-7.78521658]


portfolio before change:  [-1.49907605]
curr_Stock_Price:  100.74779757437776
curr_Factors:  [100.74779757]
mat_Sqrt:  [[0.15]]
grads:  [-0.04418847]
Stock Position:  -0.04418847471394446
Bond Position:  [2.95281546]


portfolio before change:  [-1.44869417]
curr_Stock_Price:  99.61181527164612
curr_Factors:  [99.61181527]
mat_Sqrt:  [[0.15]]
grads:  [-0.05920669]
Stock Position:  -0.05920668685632601
Bond Position:  [4.44899139]


portfolio before change:  [-1.4781259]
curr_Stock_Price:  100.11361338751935
curr_Factors:  [100.11361339]
mat_Sqrt:  [[0.15]]
grads:  [0.02877193]
Stock Position:  0.028771926113462847
Bond Position:  [-4.35858739]


portfolio before change:  [-1.45697527]
curr_Stock_Price:  100.858194968267
curr_Factors:  [100.85819497]
mat_Sqrt:  [[0.15]]
grads:  [0.03469672]
Stock Position:  0.03469672301864529
Bond Position:  [-4.95642413]


portfolio before change:  [-1.47180928]
curr_Stock_Price:  100.43959013156217
curr_Factors:  [100.43959013]
mat_Sqrt:  [[0.15]]
grads:  [-0.03799634]
Stock Position:  -0.037996342256140854
Bond Position:  [2.34452777]


portfolio before change:  [-1.49736236]
curr_Stock_Price:  101.11596111437346
curr_Factors:  [101.11596111]
mat_Sqrt:  [[0.15]]
grads:  [0.09206533]
Stock Position:  0.09206532759825017
Bond Position:  [-10.80663645]


portfolio before change:  [-1.51972289]
curr_Stock_Price:  100.88042087680718
curr_Factors:  [100.88042088]
mat_Sqrt:  [[0.15]]
grads:  [0.11424206]
Stock Position:  0.1142420577442571
Bond Position:  [-13.04450975]


portfolio before change:  [-1.56318157]
curr_Stock_Price:  100.50714870249807
curr_Factors:  [100.5071487]
mat_Sqrt:  [[0.15]]
grads:  [0.15298141]
Stock Position:  0.1529814133467403
Bond Position:  [-16.93890723]


portfolio before change:  [-1.57369505]
curr_Stock_Price:  100.44534536306405
curr_Factors:  [100.44534536]
mat_Sqrt:  [[0.15]]
grads:  [0.0198632]
Stock Position:  0.019863200764760187
Bond Position:  [-3.56886111]


portfolio before change:  [-1.57024096]
curr_Stock_Price:  100.63046925319941
curr_Factors:  [100.63046925]
mat_Sqrt:  [[0.15]]
grads:  [0.52653089]
Stock Position:  0.5265308943898983
Bond Position:  [-54.55529194]


portfolio before change:  [-1.68678948]
curr_Stock_Price:  100.41559353219066
curr_Factors:  [100.41559353]
mat_Sqrt:  [[0.15]]
grads:  [-0.08873136]
Stock Position:  -0.08873135742694155
Bond Position:  [7.22322244]


portfolio before change:  [-1.71239619]
curr_Stock_Price:  100.7092684989344
curr_Factors:  [100.7092685]
mat_Sqrt:  [[0.15]]
grads:  [0.01112158]
Stock Position:  0.011121576958294233
Bond Position:  [-2.83244207]


portfolio before change:  [-1.73066218]
curr_Stock_Price:  99.08279425743513
curr_Factors:  [99.08279426]
mat_Sqrt:  [[0.15]]
grads:  [0.09442718]
Stock Position:  0.0944271780323188
Bond Position:  [-11.08677084]


portfolio before change:  [-1.71640694]
curr_Stock_Price:  99.24109813030108
curr_Factors:  [99.24109813]
mat_Sqrt:  [[0.15]]
grads:  [0.0585023]
Stock Position:  0.05850230405938745
Bond Position:  [-7.52223984]


portfolio before change:  [-1.69672621]
curr_Stock_Price:  99.58554414965774
curr_Factors:  [99.58554415]
mat_Sqrt:  [[0.15]]
grads:  [-0.02075475]
Stock Position:  -0.020754754587187254
Bond Position:  [0.37014732]


portfolio before change:  [-1.72136145]
curr_Stock_Price:  100.77362736854825
curr_Factors:  [100.77362737]
mat_Sqrt:  [[0.15]]
grads:  [0.0854077]
Stock Position:  0.08540769702135848
Bond Position:  [-10.32820488]


portfolio before change:  [-1.65797469]
curr_Stock_Price:  101.5233524727668
curr_Factors:  [101.52335247]
mat_Sqrt:  [[0.15]]
grads:  [0.01981754]
Stock Position:  0.0198175351950005
Bond Position:  [-3.6699173]


portfolio before change:  [-1.6642042]
curr_Stock_Price:  101.22058341303998
curr_Factors:  [101.22058341]
mat_Sqrt:  [[0.15]]
grads:  [0.02856284]
Stock Position:  0.02856284255212884
Bond Position:  [-4.55535179]


portfolio before change:  [-1.65314428]
curr_Stock_Price:  101.61776520847953
curr_Factors:  [101.61776521]
mat_Sqrt:  [[0.15]]
grads:  [-0.1548609]
Stock Position:  -0.1548608977381441
Bond Position:  [14.08347407]


portfolio before change:  [-1.77840553]
curr_Stock_Price:  102.43231229244628
curr_Factors:  [102.43231229]
mat_Sqrt:  [[0.15]]
grads:  [-0.03790935]
Stock Position:  -0.03790934919971678
Bond Position:  [2.10473677]


portfolio before change:  [-1.79237605]
curr_Stock_Price:  102.80430683897902
curr_Factors:  [102.80430684]
mat_Sqrt:  [[0.15]]
grads:  [0.24416766]
Stock Position:  0.24416766382152733
Bond Position:  [-26.89386348]


portfolio before change:  [-1.90543135]
curr_Stock_Price:  102.34816788808891
curr_Factors:  [102.34816789]
mat_Sqrt:  [[0.15]]
grads:  [0.04646943]
Stock Position:  0.04646943239585369
Bond Position:  [-6.66149262]


portfolio before change:  [-1.94600537]
curr_Stock_Price:  101.48399399619366
curr_Factors:  [101.483994]
mat_Sqrt:  [[0.15]]
grads:  [0.04425163]
Stock Position:  0.04425162962822989
Bond Position:  [-6.43683749]


portfolio before change:  [-1.96265836]
curr_Stock_Price:  101.11676060864474
curr_Factors:  [101.11676061]
mat_Sqrt:  [[0.15]]
grads:  [0.01402718]
Stock Position:  0.014027182170554299
Bond Position:  [-3.38104159]


portfolio before change:  [-1.97890304]
curr_Stock_Price:  99.97374042013035
curr_Factors:  [99.97374042]
mat_Sqrt:  [[0.15]]
grads:  [0.00706624]
Stock Position:  0.007066239963676481
Bond Position:  [-2.68534148]


portfolio before change:  [-1.97994646]
curr_Stock_Price:  99.84983009259864
curr_Factors:  [99.84983009]
mat_Sqrt:  [[0.15]]
grads:  [-0.0183721]
Stock Position:  -0.018372099708947934
Bond Position:  [-0.14549542]


portfolio before change:  [-1.96438516]
curr_Stock_Price:  99.00232831483825
curr_Factors:  [99.00232831]
mat_Sqrt:  [[0.15]]
grads:  [0.0761075]
Stock Position:  0.07610749979043817
Bond Position:  [-9.49920485]


portfolio before change:  [-1.9493495]
curr_Stock_Price:  99.20768761138824
curr_Factors:  [99.20768761]
mat_Sqrt:  [[0.15]]
grads:  [0.00726458]
Stock Position:  0.007264580507654311
Bond Position:  [-2.67005173]


portfolio before change:  [-1.94220381]
curr_Stock_Price:  100.21429443140532
curr_Factors:  [100.21429443]
mat_Sqrt:  [[0.15]]
grads:  [-0.09022496]
Stock Position:  -0.09022495701926625
Bond Position:  [7.0996266]


portfolio before change:  [-1.94898028]
curr_Stock_Price:  100.29431903464807
curr_Factors:  [100.29431903]
mat_Sqrt:  [[0.15]]
grads:  [-0.00636839]
Stock Position:  -0.006368389945217434
Bond Position:  [-1.31026695]


portfolio before change:  [-1.9525553]
curr_Stock_Price:  100.84282856878436
curr_Factors:  [100.84282857]
mat_Sqrt:  [[0.15]]
grads:  [-0.0187515]
Stock Position:  -0.018751498068425042
Bond Position:  [-0.0616012]


portfolio before change:  [-1.96791366]
curr_Stock_Price:  101.66167033049832
curr_Factors:  [101.66167033]
mat_Sqrt:  [[0.15]]
grads:  [0.06842369]
Stock Position:  0.06842369212023607
Bond Position:  [-8.92398049]


portfolio before change:  [-1.97064933]
curr_Stock_Price:  101.6298406493905
curr_Factors:  [101.62984065]
mat_Sqrt:  [[0.15]]
grads:  [-0.08517789]
Stock Position:  -0.08517788548856395
Bond Position:  [6.6859656]


portfolio before change:  [-1.9398478]
curr_Stock_Price:  101.27313251493143
curr_Factors:  [101.27313251]
mat_Sqrt:  [[0.15]]
grads:  [0.0086114]
Stock Position:  0.008611398091849017
Bond Position:  [-2.81195106]


portfolio before change:  [-1.930501]
curr_Stock_Price:  102.37894052715531
curr_Factors:  [102.37894053]
mat_Sqrt:  [[0.15]]
grads:  [0.01526169]
Stock Position:  0.015261689229797738
Bond Position:  [-3.49297657]


portfolio before change:  [-1.91528301]
curr_Stock_Price:  103.39038217848986
curr_Factors:  [103.39038218]
mat_Sqrt:  [[0.15]]
grads:  [-0.09082416]
Stock Position:  -0.09082415756755857
Bond Position:  [7.47506135]


portfolio before change:  [-1.8768004]
curr_Stock_Price:  102.97182170300003
curr_Factors:  [102.9718217]
mat_Sqrt:  [[0.15]]
grads:  [0.01890359]
Stock Position:  0.018903589991933624
Bond Position:  [-3.8233375]


portfolio before change:  [-1.85547356]
curr_Stock_Price:  104.11265279051472
curr_Factors:  [104.11265279]
mat_Sqrt:  [[0.15]]
grads:  [0.09247264]
Stock Position:  0.09247263575322946
Bond Position:  [-11.48304498]


portfolio before change:  [-1.82131779]
curr_Stock_Price:  104.48977507910972
curr_Factors:  [104.48977508]
mat_Sqrt:  [[0.15]]
grads:  [-0.07713664]
Stock Position:  -0.077136642993188
Bond Position:  [6.23867269]


portfolio before change:  [-1.81460582]
curr_Stock_Price:  104.40781611998283
curr_Factors:  [104.40781612]
mat_Sqrt:  [[0.15]]
grads:  [-0.02698841]
Stock Position:  -0.026988406410934092
Bond Position:  [1.00319476]


portfolio before change:  [-1.82219559]
curr_Stock_Price:  104.69136270096043
curr_Factors:  [104.6913627]
mat_Sqrt:  [[0.15]]
grads:  [0.02330161]
Stock Position:  0.023301614146184094
Bond Position:  [-4.26167332]


portfolio before change:  [-1.83617955]
curr_Stock_Price:  104.10266530309694
curr_Factors:  [104.1026653]
mat_Sqrt:  [[0.15]]
grads:  [0.01807251]
Stock Position:  0.01807251314713171
Bond Position:  [-3.71757634]


portfolio before change:  [-1.84345708]
curr_Stock_Price:  103.71283686374959
curr_Factors:  [103.71283686]
mat_Sqrt:  [[0.15]]
grads:  [0.0095078]
Stock Position:  0.009507795143343567
Bond Position:  [-2.82953749]


portfolio before change:  [-1.84484854]
curr_Stock_Price:  103.58508843179872
curr_Factors:  [103.58508843]
mat_Sqrt:  [[0.15]]
grads:  [-0.03978396]
Stock Position:  -0.03978395815725812
Bond Position:  [2.27617628]


portfolio before change:  [-1.82158073]
curr_Stock_Price:  103.00381020519367
curr_Factors:  [103.00381021]
mat_Sqrt:  [[0.15]]
grads:  [0.06150885]
Stock Position:  0.06150884976356404
Bond Position:  [-8.15722661]


portfolio before change:  [-1.79295753]
curr_Stock_Price:  103.47745002692842
curr_Factors:  [103.47745003]
mat_Sqrt:  [[0.15]]
grads:  [-0.04404918]
Stock Position:  -0.04404918286350895
Bond Position:  [2.76513959]


portfolio before change:  [-1.77201472]
curr_Stock_Price:  103.00593209782318
curr_Factors:  [103.0059321]
mat_Sqrt:  [[0.15]]
grads:  [-0.08178218]
Stock Position:  -0.08178218144140327
Bond Position:  [6.65203511]


portfolio before change:  [-1.75708673]
curr_Stock_Price:  102.8284822876465
curr_Factors:  [102.82848229]
mat_Sqrt:  [[0.15]]
grads:  [0.09680832]
Stock Position:  0.09680831567088556
Bond Position:  [-11.7117389]


portfolio before change:  [-1.78867089]
curr_Stock_Price:  102.50978897941538
curr_Factors:  [102.50978898]
mat_Sqrt:  [[0.15]]
grads:  [0.0206787]
Stock Position:  0.020678696437839882
Bond Position:  [-3.9084397]


portfolio before change:  [-1.7865011]
curr_Stock_Price:  102.62653112511853
curr_Factors:  [102.62653113]
mat_Sqrt:  [[0.15]]
grads:  [0.07547877]
Stock Position:  0.07547876694019659
Bond Position:  [-9.53262513]


portfolio before change:  [-1.80426884]
curr_Stock_Price:  102.39902441866833
curr_Factors:  [102.39902442]
mat_Sqrt:  [[0.15]]
grads:  [-0.09660242]
Stock Position:  -0.09660241666730045
Bond Position:  [8.08772439]


portfolio before change:  [-1.75961067]
curr_Stock_Price:  101.94196884461407
curr_Factors:  [101.94196884]
mat_Sqrt:  [[0.15]]
grads:  [-0.08442266]
Stock Position:  -0.08442266448117657
Bond Position:  [6.84660197]


portfolio before change:  [-1.75342498]
curr_Stock_Price:  101.87376720593956
curr_Factors:  [101.87376721]
mat_Sqrt:  [[0.15]]
grads:  [-0.01915221]
Stock Position:  -0.019152211120038853
Bond Position:  [0.19768292]


portfolio before change:  [-1.74412809]
curr_Stock_Price:  101.38899124483457
curr_Factors:  [101.38899124]
mat_Sqrt:  [[0.15]]
grads:  [-0.12131173]
Stock Position:  -0.12131173385792109
Bond Position:  [10.55554623]


portfolio before change:  [-1.69397567]
curr_Stock_Price:  100.98101194348627
curr_Factors:  [100.98101194]
mat_Sqrt:  [[0.15]]
grads:  [0.1854275]
Stock Position:  0.18542749892798804
Bond Position:  [-20.41863215]


portfolio before change:  [-1.71980092]
curr_Stock_Price:  100.8486203122726
curr_Factors:  [100.84862031]
mat_Sqrt:  [[0.15]]
grads:  [0.13961084]
Stock Position:  0.13961084340241847
Bond Position:  [-15.79936186]


portfolio before change:  [-1.9772619]
curr_Stock_Price:  99.01156040130077
curr_Factors:  [99.0115604]
mat_Sqrt:  [[0.15]]
grads:  [0.013344]
Stock Position:  0.01334400484731416
Bond Position:  [-3.29847264]


portfolio before change:  [-1.97047719]
curr_Stock_Price:  99.53545624568319
curr_Factors:  [99.53545625]
mat_Sqrt:  [[0.15]]
grads:  [0.04578046]
Stock Position:  0.045780463269660544
Bond Position:  [-6.52725649]


portfolio before change:  [-1.96636392]
curr_Stock_Price:  99.6342152590657
curr_Factors:  [99.63421526]
mat_Sqrt:  [[0.15]]
grads:  [-0.09731049]
Stock Position:  -0.09731048620509254
Bond Position:  [7.72909001]


portfolio before change:  [-1.91461718]
curr_Stock_Price:  99.10741014874795
curr_Factors:  [99.10741015]
mat_Sqrt:  [[0.15]]
grads:  [-0.03548517]
Stock Position:  -0.035485172380037275
Bond Position:  [1.60222636]


portfolio before change:  [-1.90419387]
curr_Stock_Price:  98.81649531592346
curr_Factors:  [98.81649532]
mat_Sqrt:  [[0.15]]
grads:  [-0.00195646]
Stock Position:  -0.00195646081655724
Bond Position:  [-1.71086327]


portfolio before change:  [-1.90412416]
curr_Stock_Price:  98.72620631298359
curr_Factors:  [98.72620631]
mat_Sqrt:  [[0.15]]
grads:  [0.01021368]
Stock Position:  0.01021367956812904
Bond Position:  [-2.91248199]


portfolio before change:  [-1.91434176]
curr_Stock_Price:  97.74364535878935
curr_Factors:  [97.74364536]
mat_Sqrt:  [[0.15]]
grads:  [0.05548177]
Stock Position:  0.05548177412394288
Bond Position:  [-7.33733261]


portfolio before change:  [-1.91565493]
curr_Stock_Price:  97.72824261073538
curr_Factors:  [97.72824261]
mat_Sqrt:  [[0.15]]
grads:  [0.01124358]
Stock Position:  0.011243583744225889
Bond Position:  [-3.01447061]


portfolio before change:  [-1.91946573]
curr_Stock_Price:  97.4060683202528
curr_Factors:  [97.40606832]
mat_Sqrt:  [[0.15]]
grads:  [0.01366365]
Stock Position:  0.013663650267513679
Bond Position:  [-3.25038818]


portfolio before change:  [-1.92046044]
curr_Stock_Price:  97.34813704836523
curr_Factors:  [97.34813705]
mat_Sqrt:  [[0.15]]
grads:  [0.01275458]
Stock Position:  0.01275458207189843
Bond Position:  [-3.16209524]


portfolio before change:  [-1.92329623]
curr_Stock_Price:  97.14129730668712
curr_Factors:  [97.14129731]
mat_Sqrt:  [[0.15]]
grads:  [-0.07275549]
Stock Position:  -0.0727554899331112
Bond Position:  [5.14426645]


portfolio before change:  [-1.89005941]
curr_Stock_Price:  96.68888752556079
curr_Factors:  [96.68888753]
mat_Sqrt:  [[0.15]]
grads:  [-0.21302893]
Stock Position:  -0.2130289314873264
Bond Position:  [18.70747099]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.89005941]
Stock Price:  96.39890744035989
PL:  [-1.89005941]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-6.03393541e-02]
 [-2.30470576e-03]
 [-2.69906858e-04]
 [-2.18372944e-04]
 [ 5.98300554e-03]
 [ 1.21136334e-02]
 [ 1.15121731e-03]
 [ 9.99172372e-03]
 [-8.63703764e-04]
 [-1.95715841e-02]
 [ 9.99629685e-03]
 [-4.98352644e-03]
 [-9.24259515e-03]
 [ 4.30340210e-03]
 [ 6.68559437e-04]
 [ 2.48691761e-04]
 [-2.39885651e-03]
 [ 4.96753191e-03]
 [ 2.41615819e-02]
 [ 4.84520731e-03]
 [ 7.87158634e-02]
 [-1.50956663e-02]
 [-2.81534236e-03]
 [ 2.57492746e-03]
 [ 1.53657229e-02]
 [ 1.72651975e-02]
 [ 1.17185605e-02]
 [-3.64732249e-04]
 [ 3.36699565e-03]
 [-2.80193418e-02]
 [-5.39081070e-03]
 [ 2.49217075e-02]
 [ 7.64787748e-03]
 [ 5.22160171e-03]
 [-8.32642723e-04]
 [-4.31544179e-03]
 [-6.57248620e-03]
 [ 1.43650574e-02]
 [-1.52046448e-03]
 [-1.01422964e-02]
 [-8.60220417e-03]
 [-2.92002106e-03]
 [ 7.15749722e-03]
 [-1.39526695e-02]
 [ 1.23710629e-03]
 [ 8.08414139e-04]
 [-1.37074582e-02]
 [-5.07719211e-03]
 [-7.58703572e-03]
 [ 1.07469159e-02]
 [-3.00564339e-03]
 [ 3.62433961e-03]
 [ 1.45617087e-03]
 [-2.37848543e-04]
 [ 2.30178897e-03]
 [ 8.92048659e-03]
 [ 1.61662662e-02]
 [-2.10616118e-02]
 [ 1.34002419e-02]
 [ 5.00024386e-03]
 [ 9.99376321e-03]
 [-1.33008898e-02]
 [-1.25567486e-02]
 [-2.31783631e-03]
 [-1.63193529e-02]
 [ 4.24191252e-02]
 [ 1.94720927e-02]
 [ 2.30902427e-03]
 [ 5.95964413e-03]
 [-1.38913044e-02]
 [-7.22417366e-03]
 [-6.56691927e-04]
 [ 2.26371204e-03]
 [ 8.45650982e-03]
 [ 6.41719615e-03]
 [-8.94062444e-03]
 [-4.52552650e-04]
 [-8.54024944e-03]
 [ 4.03233089e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.53495258]
curr_Stock_Price:  100.54427641181687
curr_Factors:  [100.54427641]
mat_Sqrt:  [[0.15]]
grads:  [-0.40226236]
Stock Position:  -0.4022623605573577
Bond Position:  [50.98013055]


portfolio before change:  [10.64834899]
curr_Stock_Price:  100.27030087698137
curr_Factors:  [100.27030088]
mat_Sqrt:  [[0.15]]
grads:  [-0.01536471]
Stock Position:  -0.015364705092858021
Bond Position:  [12.18897259]


portfolio before change:  [10.66155829]
curr_Stock_Price:  99.46016695370871
curr_Factors:  [99.46016695]
mat_Sqrt:  [[0.15]]
grads:  [-0.00179938]
Stock Position:  -0.0017993790529411062
Bond Position:  [10.84052483]


portfolio before change:  [10.6630029]
curr_Stock_Price:  99.03387543711456
curr_Factors:  [99.03387544]
mat_Sqrt:  [[0.15]]
grads:  [-0.00145582]
Stock Position:  -0.001455819626940159
Bond Position:  [10.80717836]


portfolio before change:  [10.66291824]
curr_Stock_Price:  99.55601048558607
curr_Factors:  [99.55601049]
mat_Sqrt:  [[0.15]]
grads:  [0.0398867]
Stock Position:  0.039886703591424086
Bond Position:  [6.69195716]


portfolio before change:  [10.67838305]
curr_Stock_Price:  99.93324271832823
curr_Factors:  [99.93324272]
mat_Sqrt:  [[0.15]]
grads:  [0.08075756]
Stock Position:  0.08075755603483467
Bond Position:  [2.6080186]


portfolio before change:  [10.68507682]
curr_Stock_Price:  100.01411143546018
curr_Factors:  [100.01411144]
mat_Sqrt:  [[0.15]]
grads:  [0.00767478]
Stock Position:  0.0076747820395444205
Bond Position:  [9.91749031]


portfolio before change:  [10.68553254]
curr_Stock_Price:  99.99272417357194
curr_Factors:  [99.99272417]
mat_Sqrt:  [[0.15]]
grads:  [0.06661149]
Stock Position:  0.0666114914778569
Bond Position:  [4.02486804]


portfolio before change:  [10.73648875]
curr_Stock_Price:  100.75392397922441
curr_Factors:  [100.75392398]
mat_Sqrt:  [[0.15]]
grads:  [-0.00575803]
Stock Position:  -0.005758025092514388
Bond Position:  [11.31663237]


portfolio before change:  [10.74005193]
curr_Stock_Price:  100.25794348610536
curr_Factors:  [100.25794349]
mat_Sqrt:  [[0.15]]
grads:  [-0.13047723]
Stock Position:  -0.13047722734862663
Bond Position:  [23.82143042]


portfolio before change:  [10.75445856]
curr_Stock_Price:  100.15893965460083
curr_Factors:  [100.15893965]
mat_Sqrt:  [[0.15]]
grads:  [0.06664198]
Stock Position:  0.06664197899611521
Bond Position:  [4.07966861]


portfolio before change:  [10.75083039]
curr_Stock_Price:  100.10067061576761
curr_Factors:  [100.10067062]
mat_Sqrt:  [[0.15]]
grads:  [-0.03322351]
Stock Position:  -0.03322350957273935
Bond Position:  [14.07652597]


portfolio before change:  [10.76357068]
curr_Stock_Price:  99.7436799687658
curr_Factors:  [99.74367997]
mat_Sqrt:  [[0.15]]
grads:  [-0.0616173]
Stock Position:  -0.0616173010163633
Bond Position:  [16.90950703]


portfolio before change:  [10.75719863]
curr_Stock_Price:  99.86424555366676
curr_Factors:  [99.86424555]
mat_Sqrt:  [[0.15]]
grads:  [0.02868935]
Stock Position:  0.028689347320756692
Bond Position:  [7.8921586]


portfolio before change:  [10.74551637]
curr_Stock_Price:  99.43985340486901
curr_Factors:  [99.4398534]
mat_Sqrt:  [[0.15]]
grads:  [0.00445706]
Stock Position:  0.004457062914643868
Bond Position:  [10.30230669]


portfolio before change:  [10.7487584]
curr_Stock_Price:  100.02277309095322
curr_Factors:  [100.02277309]
mat_Sqrt:  [[0.15]]
grads:  [0.00165795]
Stock Position:  0.0016579450741060927
Bond Position:  [10.58292613]


portfolio before change:  [10.74672464]
curr_Stock_Price:  98.39714137493377
curr_Factors:  [98.39714137]
mat_Sqrt:  [[0.15]]
grads:  [-0.01599238]
Stock Position:  -0.015992376710048547
Bond Position:  [12.32032879]


portfolio before change:  [10.74041845]
curr_Stock_Price:  98.83961725103048
curr_Factors:  [98.83961725]
mat_Sqrt:  [[0.15]]
grads:  [0.03311688]
Stock Position:  0.03311687939513436
Bond Position:  [7.46715876]


portfolio before change:  [10.77098053]
curr_Stock_Price:  99.74837969440296
curr_Factors:  [99.74837969]
mat_Sqrt:  [[0.15]]
grads:  [0.16107721]
Stock Position:  0.16107721242073886
Bond Position:  [-5.29621041]


portfolio before change:  [10.83660972]
curr_Stock_Price:  100.15787403876301
curr_Factors:  [100.15787404]
mat_Sqrt:  [[0.15]]
grads:  [0.03230138]
Stock Position:  0.032301382069421194
Bond Position:  [7.60137196]


portfolio before change:  [10.84304124]
curr_Stock_Price:  100.34227557822554
curr_Factors:  [100.34227558]
mat_Sqrt:  [[0.15]]
grads:  [0.52477242]
Stock Position:  0.5247724228071552
Bond Position:  [-41.81381782]


portfolio before change:  [10.52031854]
curr_Stock_Price:  99.73227924776474
curr_Factors:  [99.73227925]
mat_Sqrt:  [[0.15]]
grads:  [-0.10063778]
Stock Position:  -0.10063777505779571
Bond Position:  [20.55715323]


portfolio before change:  [10.49816908]
curr_Stock_Price:  99.9651373829187
curr_Factors:  [99.96513738]
mat_Sqrt:  [[0.15]]
grads:  [-0.01876895]
Stock Position:  -0.01876894907830483
Bond Position:  [12.37440966]


portfolio before change:  [10.47889043]
curr_Stock_Price:  101.03350153422988
curr_Factors:  [101.03350153]
mat_Sqrt:  [[0.15]]
grads:  [0.01716618]
Stock Position:  0.01716618309410221
Bond Position:  [8.74453085]


portfolio before change:  [10.4819455]
curr_Stock_Price:  101.1796326955288
curr_Factors:  [101.1796327]
mat_Sqrt:  [[0.15]]
grads:  [0.10243815]
Stock Position:  0.10243815261445723
Bond Position:  [0.11729084]


portfolio before change:  [10.55025741]
curr_Stock_Price:  101.84642116885774
curr_Factors:  [101.84642117]
mat_Sqrt:  [[0.15]]
grads:  [0.11510132]
Stock Position:  0.11510131634208769
Bond Position:  [-1.17239973]


portfolio before change:  [10.51288659]
curr_Stock_Price:  101.52238023182694
curr_Factors:  [101.52238023]
mat_Sqrt:  [[0.15]]
grads:  [0.07812374]
Stock Position:  0.07812373671247773
Bond Position:  [2.58157889]


portfolio before change:  [10.47936476]
curr_Stock_Price:  101.09122847138886
curr_Factors:  [101.09122847]
mat_Sqrt:  [[0.15]]
grads:  [-0.00243155]
Stock Position:  -0.0024315483253615584
Bond Position:  [10.72517297]


portfolio before change:  [10.48139963]
curr_Stock_Price:  100.53005367564873
curr_Factors:  [100.53005368]
mat_Sqrt:  [[0.15]]
grads:  [0.02244664]
Stock Position:  0.022446637654466896
Bond Position:  [8.22483794]


portfolio before change:  [10.49035752]
curr_Stock_Price:  100.90622668866197
curr_Factors:  [100.90622669]
mat_Sqrt:  [[0.15]]
grads:  [-0.18679561]
Stock Position:  -0.18679561172006126
Bond Position:  [29.33919786]


portfolio before change:  [10.37410773]
curr_Stock_Price:  101.53838042578097
curr_Factors:  [101.53838043]
mat_Sqrt:  [[0.15]]
grads:  [-0.03593874]
Stock Position:  -0.03593873803134538
Bond Position:  [14.02326898]


portfolio before change:  [10.36789484]
curr_Stock_Price:  101.73564299790482
curr_Factors:  [101.735643]
mat_Sqrt:  [[0.15]]
grads:  [0.16614472]
Stock Position:  0.16614471666821642
Bond Position:  [-6.53494474]


portfolio before change:  [10.35529825]
curr_Stock_Price:  101.66228436609408
curr_Factors:  [101.66228437]
mat_Sqrt:  [[0.15]]
grads:  [0.05098585]
Stock Position:  0.05098584986338426
Bond Position:  [5.17196028]


portfolio before change:  [10.35455226]
curr_Stock_Price:  101.6413129490819
curr_Factors:  [101.64131295]
mat_Sqrt:  [[0.15]]
grads:  [0.03481068]
Stock Position:  0.03481067806133044
Bond Position:  [6.81634924]


portfolio before change:  [10.35215822]
curr_Stock_Price:  101.5603012388346
curr_Factors:  [101.56030124]
mat_Sqrt:  [[0.15]]
grads:  [-0.00555095]
Stock Position:  -0.005550951487685331
Bond Position:  [10.91591453]


portfolio before change:  [10.35625484]
curr_Stock_Price:  100.94520733535371
curr_Factors:  [100.94520734]
mat_Sqrt:  [[0.15]]
grads:  [-0.02876961]
Stock Position:  -0.028769611916350867
Bond Position:  [13.26040928]


portfolio before change:  [10.35095653]
curr_Stock_Price:  101.15817898819357
curr_Factors:  [101.15817899]
mat_Sqrt:  [[0.15]]
grads:  [-0.04381657]
Stock Position:  -0.04381657466918421
Bond Position:  [14.78336144]


portfolio before change:  [10.37395617]
curr_Stock_Price:  100.65435937999018
curr_Factors:  [100.65435938]
mat_Sqrt:  [[0.15]]
grads:  [0.09576705]
Stock Position:  0.09576704922234003
Bond Position:  [0.73458518]


portfolio before change:  [10.4010612]
curr_Stock_Price:  100.93691075779606
curr_Factors:  [100.93691076]
mat_Sqrt:  [[0.15]]
grads:  [-0.01013643]
Stock Position:  -0.010136429877743287
Bond Position:  [11.42420112]


portfolio before change:  [10.39821798]
curr_Stock_Price:  101.28784856467865
curr_Factors:  [101.28784856]
mat_Sqrt:  [[0.15]]
grads:  [-0.06761531]
Stock Position:  -0.06761530913785105
Bond Position:  [17.24682717]


portfolio before change:  [10.41866069]
curr_Stock_Price:  101.00145263704597
curr_Factors:  [101.00145264]
mat_Sqrt:  [[0.15]]
grads:  [-0.05734803]
Stock Position:  -0.05734802781305402
Bond Position:  [16.2108948]


portfolio before change:  [10.4643891]
curr_Stock_Price:  100.22173609750772
curr_Factors:  [100.2217361]
mat_Sqrt:  [[0.15]]
grads:  [-0.01946681]
Stock Position:  -0.019466807035467555
Bond Position:  [12.4153863]


portfolio before change:  [10.46030079]
curr_Stock_Price:  100.471612823349
curr_Factors:  [100.47161282]
mat_Sqrt:  [[0.15]]
grads:  [0.04771665]
Stock Position:  0.04771664812526221
Bond Position:  [5.66613219]


portfolio before change:  [10.46598941]
curr_Stock_Price:  100.58340765480914
curr_Factors:  [100.58340765]
mat_Sqrt:  [[0.15]]
grads:  [-0.0930178]
Stock Position:  -0.09301779637128332
Bond Position:  [19.82203634]


portfolio before change:  [10.39934137]
curr_Stock_Price:  101.31323525111779
curr_Factors:  [101.31323525]
mat_Sqrt:  [[0.15]]
grads:  [0.00824738]
Stock Position:  0.008247375246834682
Bond Position:  [9.5637731]


portfolio before change:  [10.39536306]
curr_Stock_Price:  100.75838433221419
curr_Factors:  [100.75838433]
mat_Sqrt:  [[0.15]]
grads:  [0.00538943]
Stock Position:  0.005389427590521381
Bond Position:  [9.85233304]


portfolio before change:  [10.39601614]
curr_Stock_Price:  100.76530330434157
curr_Factors:  [100.7653033]
mat_Sqrt:  [[0.15]]
grads:  [-0.09138305]
Stock Position:  -0.0913830549216279
Bond Position:  [19.60425738]


portfolio before change:  [10.39151056]
curr_Stock_Price:  100.82801608341238
curr_Factors:  [100.82801608]
mat_Sqrt:  [[0.15]]
grads:  [-0.03384795]
Stock Position:  -0.03384794739171014
Bond Position:  [13.80433194]


portfolio before change:  [10.42662267]
curr_Stock_Price:  99.81615825043096
curr_Factors:  [99.81615825]
mat_Sqrt:  [[0.15]]
grads:  [-0.05058024]
Stock Position:  -0.050580238132681074
Bond Position:  [15.47534772]


portfolio before change:  [10.45112053]
curr_Stock_Price:  99.35094455043836
curr_Factors:  [99.35094455]
mat_Sqrt:  [[0.15]]
grads:  [0.07164611]
Stock Position:  0.071646106112708
Bond Position:  [3.33301221]


portfolio before change:  [10.47937794]
curr_Stock_Price:  99.74243962236466
curr_Factors:  [99.74243962]
mat_Sqrt:  [[0.15]]
grads:  [-0.02003762]
Stock Position:  -0.02003762261010181
Bond Position:  [12.47797931]


portfolio before change:  [10.47793222]
curr_Stock_Price:  99.85351167972262
curr_Factors:  [99.85351168]
mat_Sqrt:  [[0.15]]
grads:  [0.02416226]
Stock Position:  0.024162264092629848
Bond Position:  [8.0652453]


portfolio before change:  [10.47751132]
curr_Stock_Price:  99.81522899715533
curr_Factors:  [99.815229]
mat_Sqrt:  [[0.15]]
grads:  [0.00970781]
Stock Position:  0.009707805815975561
Bond Position:  [9.50852446]


portfolio before change:  [10.47092541]
curr_Stock_Price:  99.07559633358412
curr_Factors:  [99.07559633]
mat_Sqrt:  [[0.15]]
grads:  [-0.00158566]
Stock Position:  -0.0015856569552316017
Bond Position:  [10.62802532]


portfolio before change:  [10.47034683]
curr_Stock_Price:  99.8594047663631
curr_Factors:  [99.85940477]
mat_Sqrt:  [[0.15]]
grads:  [0.01534526]
Stock Position:  0.0153452597715778
Bond Position:  [8.93797832]


portfolio before change:  [10.47100093]
curr_Stock_Price:  99.86562572045541
curr_Factors:  [99.86562572]
mat_Sqrt:  [[0.15]]
grads:  [0.05946991]
Stock Position:  0.059469910604377015
Bond Position:  [4.5320011]


portfolio before change:  [10.45731017]
curr_Stock_Price:  99.63064937335768
curr_Factors:  [99.63064937]
mat_Sqrt:  [[0.15]]
grads:  [0.10777511]
Stock Position:  0.10777510791147044
Bond Position:  [-0.28039382]


portfolio before change:  [10.56617432]
curr_Stock_Price:  100.64091670489346
curr_Factors:  [100.6409167]
mat_Sqrt:  [[0.15]]
grads:  [-0.14041075]
Stock Position:  -0.14041074533476602
Bond Position:  [24.69724044]


portfolio before change:  [10.44776747]
curr_Stock_Price:  101.49519940998218
curr_Factors:  [101.49519941]
mat_Sqrt:  [[0.15]]
grads:  [0.08933495]
Stock Position:  0.0893349459707756
Bond Position:  [1.38069931]


portfolio before change:  [10.4626183]
curr_Stock_Price:  101.66047105745628
curr_Factors:  [101.66047106]
mat_Sqrt:  [[0.15]]
grads:  [0.03333496]
Stock Position:  0.03333495907507484
Bond Position:  [7.07377066]


portfolio before change:  [10.46004956]
curr_Stock_Price:  101.57014965774725
curr_Factors:  [101.57014966]
mat_Sqrt:  [[0.15]]
grads:  [0.06662509]
Stock Position:  0.06662508804830472
Bond Position:  [3.6929294]


portfolio before change:  [10.44263014]
curr_Stock_Price:  101.30523089826616
curr_Factors:  [101.3052309]
mat_Sqrt:  [[0.15]]
grads:  [-0.0886726]
Stock Position:  -0.08867259847237251
Bond Position:  [19.42562821]


portfolio before change:  [10.47275401]
curr_Stock_Price:  100.97920321092397
curr_Factors:  [100.97920321]
mat_Sqrt:  [[0.15]]
grads:  [-0.08371166]
Stock Position:  -0.08371165703553203
Bond Position:  [18.92589043]


portfolio before change:  [10.47222663]
curr_Stock_Price:  100.99963377596072
curr_Factors:  [100.99963378]
mat_Sqrt:  [[0.15]]
grads:  [-0.01545224]
Stock Position:  -0.015452242073699761
Bond Position:  [12.03289742]


portfolio before change:  [10.48727645]
curr_Stock_Price:  100.07434792516074
curr_Factors:  [100.07434793]
mat_Sqrt:  [[0.15]]
grads:  [-0.10879569]
Stock Position:  -0.1087956862250873
Bond Position:  [21.37493381]


portfolio before change:  [10.48619746]
curr_Stock_Price:  100.09654519378977
curr_Factors:  [100.09654519]
mat_Sqrt:  [[0.15]]
grads:  [0.28279417]
Stock Position:  0.2827941683325284
Bond Position:  [-17.82052179]


portfolio before change:  [10.60310189]
curr_Stock_Price:  100.51387432877485
curr_Factors:  [100.51387433]
mat_Sqrt:  [[0.15]]
grads:  [0.12981395]
Stock Position:  0.1298139512603154
Bond Position:  [-2.44500129]


portfolio before change:  [10.56944257]
curr_Stock_Price:  100.25576256150492
curr_Factors:  [100.25576256]
mat_Sqrt:  [[0.15]]
grads:  [0.0153935]
Stock Position:  0.015393495164253129
Bond Position:  [9.02615597]


portfolio before change:  [10.57101183]
curr_Stock_Price:  100.32105708971149
curr_Factors:  [100.32105709]
mat_Sqrt:  [[0.15]]
grads:  [0.03973096]
Stock Position:  0.03973096083974169
Bond Position:  [6.58515984]


portfolio before change:  [10.60271427]
curr_Stock_Price:  101.1086256855592
curr_Factors:  [101.10862569]
mat_Sqrt:  [[0.15]]
grads:  [-0.0926087]
Stock Position:  -0.09260869604816627
Bond Position:  [19.96625226]


portfolio before change:  [10.63970747]
curr_Stock_Price:  100.72264393851755
curr_Factors:  [100.72264394]
mat_Sqrt:  [[0.15]]
grads:  [-0.04816116]
Stock Position:  -0.04816115772279532
Bond Position:  [15.49062661]


portfolio before change:  [10.67373327]
curr_Stock_Price:  100.0362483865604
curr_Factors:  [100.03624839]
mat_Sqrt:  [[0.15]]
grads:  [-0.00437795]
Stock Position:  -0.004377946177541338
Bond Position:  [11.11168658]


portfolio before change:  [10.66953932]
curr_Stock_Price:  101.15285504502792
curr_Factors:  [101.15285505]
mat_Sqrt:  [[0.15]]
grads:  [0.01509141]
Stock Position:  0.01509141356740228
Bond Position:  [9.14299976]


portfolio before change:  [10.67163607]
curr_Stock_Price:  101.25392521228078
curr_Factors:  [101.25392521]
mat_Sqrt:  [[0.15]]
grads:  [0.05637673]
Stock Position:  0.05637673214798261
Bond Position:  [4.96327065]


portfolio before change:  [10.67007318]
curr_Stock_Price:  101.22070036015816
curr_Factors:  [101.22070036]
mat_Sqrt:  [[0.15]]
grads:  [0.04278131]
Stock Position:  0.04278130769757403
Bond Position:  [6.33971925]


portfolio before change:  [10.63945107]
curr_Stock_Price:  100.49565586250313
curr_Factors:  [100.49565586]
mat_Sqrt:  [[0.15]]
grads:  [-0.05960416]
Stock Position:  -0.05960416294837345
Bond Position:  [16.62941052]


portfolio before change:  [10.63750982]
curr_Stock_Price:  100.54566285854281
curr_Factors:  [100.54566286]
mat_Sqrt:  [[0.15]]
grads:  [-0.00301702]
Stock Position:  -0.0030170176660266473
Bond Position:  [10.94085786]


portfolio before change:  [10.63914189]
curr_Stock_Price:  100.23136105832508
curr_Factors:  [100.23136106]
mat_Sqrt:  [[0.15]]
grads:  [-0.056935]
Stock Position:  -0.05693499626411578
Bond Position:  [16.34581406]


portfolio before change:  [10.63113632]
curr_Stock_Price:  100.38991422332666
curr_Factors:  [100.38991422]
mat_Sqrt:  [[0.15]]
grads:  [0.02688221]
Stock Position:  0.02688220591045063
Bond Position:  [7.93243397]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.63113632]
Stock Price:  100.27606104350043
PL:  [10.35507527]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.43229957e-02]
 [ 1.50108487e-03]
 [ 3.24240301e-04]
 [ 2.57218537e-03]
 [ 4.63916326e-03]
 [ 1.19237657e-02]
 [ 8.15889650e-04]
 [ 8.53923973e-03]
 [-1.11365086e-02]
 [-9.26733569e-04]
 [ 9.91543192e-03]
 [-1.27475941e-02]
 [ 4.16980563e-02]
 [ 1.89658223e-02]
 [-5.36868495e-04]
 [-1.00779335e-02]
 [ 9.01474701e-03]
 [ 2.68817175e-02]
 [ 5.12012548e-03]
 [-3.16748676e-03]
 [ 2.40748121e-02]
 [-9.93509582e-03]
 [-5.64646389e-03]
 [ 4.30833688e-03]
 [ 1.92518407e-02]
 [ 1.29493676e-02]
 [ 7.94916225e-03]
 [ 3.53197752e-03]
 [ 9.42015382e-03]
 [-9.61603171e-03]
 [-5.73878508e-03]
 [ 3.72320791e-02]
 [ 7.42410309e-03]
 [-2.07634235e-04]
 [-1.67854454e-03]
 [-4.65519580e-03]
 [-7.04066842e-03]
 [ 6.27723472e-03]
 [ 5.05080102e-04]
 [-9.55597329e-03]
 [-8.27183655e-03]
 [-2.88458409e-03]
 [ 6.15942954e-03]
 [-1.37835393e-02]
 [ 2.05535727e-03]
 [ 6.91137068e-05]
 [-1.36996006e-02]
 [-5.09859168e-03]
 [-8.38123762e-03]
 [ 1.12351743e-02]
 [-3.05830966e-03]
 [ 3.48031360e-03]
 [ 1.39216065e-03]
 [-1.59201046e-03]
 [ 1.99860527e-03]
 [ 9.04548147e-03]
 [ 1.49563493e-02]
 [-2.20077343e-02]
 [ 1.39996374e-02]
 [ 6.50240241e-03]
 [ 6.41836274e-03]
 [-1.25252781e-02]
 [-1.25416749e-02]
 [-2.05617349e-03]
 [-1.24036894e-02]
 [ 2.78720170e-02]
 [ 1.76792715e-02]
 [ 2.30471894e-03]
 [ 6.83512566e-03]
 [-1.43854541e-02]
 [-6.95418177e-03]
 [-7.30720600e-04]
 [ 2.01403460e-03]
 [ 8.80502182e-03]
 [ 1.18310166e-02]
 [-9.65971257e-03]
 [ 2.16168999e-03]
 [-8.38161688e-03]
 [ 1.15925737e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.46686469]
curr_Stock_Price:  99.83718235900731
curr_Factors:  [99.83718236]
mat_Sqrt:  [[0.15]]
grads:  [-0.22881997]
Stock Position:  -0.22881997143567664
Bond Position:  [22.37787653]


portfolio before change:  [-0.39554648]
curr_Stock_Price:  99.53161658955915
curr_Factors:  [99.53161659]
mat_Sqrt:  [[0.15]]
grads:  [0.01000723]
Stock Position:  0.010007232499399044
Bond Position:  [-1.3915825]


portfolio before change:  [-0.38668851]
curr_Stock_Price:  100.42546430175454
curr_Factors:  [100.4254643]
mat_Sqrt:  [[0.15]]
grads:  [0.0021616]
Stock Position:  0.002161602003504324
Bond Position:  [-0.6037684]


portfolio before change:  [-0.38546764]
curr_Stock_Price:  101.00772208220226
curr_Factors:  [101.00772208]
mat_Sqrt:  [[0.15]]
grads:  [0.0171479]
Stock Position:  0.01714790248263825
Bond Position:  [-2.11753821]


portfolio before change:  [-0.38706826]
curr_Stock_Price:  100.92209823001713
curr_Factors:  [100.92209823]
mat_Sqrt:  [[0.15]]
grads:  [0.03092776]
Stock Position:  0.030927755043366652
Bond Position:  [-3.50836219]


portfolio before change:  [-0.38742223]
curr_Stock_Price:  100.91774323737279
curr_Factors:  [100.91774324]
mat_Sqrt:  [[0.15]]
grads:  [0.07949177]
Stock Position:  0.07949177125650102
Bond Position:  [-8.40955239]


portfolio before change:  [-0.4024037]
curr_Stock_Price:  100.73588969406038
curr_Factors:  [100.73588969]
mat_Sqrt:  [[0.15]]
grads:  [0.00543926]
Stock Position:  0.005439264334004829
Bond Position:  [-0.95033283]


portfolio before change:  [-0.40156844]
curr_Stock_Price:  100.90037203834308
curr_Factors:  [100.90037204]
mat_Sqrt:  [[0.15]]
grads:  [0.05692826]
Stock Position:  0.05692826485109044
Bond Position:  [-6.14565154]


portfolio before change:  [-0.33357575]
curr_Stock_Price:  102.10147663914256
curr_Factors:  [102.10147664]
mat_Sqrt:  [[0.15]]
grads:  [-0.07424339]
Stock Position:  -0.07424339088848686
Bond Position:  [7.24678409]


portfolio before change:  [-0.32810943]
curr_Stock_Price:  102.03395037436368
curr_Factors:  [102.03395037]
mat_Sqrt:  [[0.15]]
grads:  [-0.00617822]
Stock Position:  -0.0061782237960048
Bond Position:  [0.30227915]


portfolio before change:  [-0.32946081]
curr_Stock_Price:  102.25574073406275
curr_Factors:  [102.25574073]
mat_Sqrt:  [[0.15]]
grads:  [0.06610288]
Stock Position:  0.0661028794894522
Bond Position:  [-7.08885972]


portfolio before change:  [-0.28065467]
curr_Stock_Price:  103.00077946808713
curr_Factors:  [103.00077947]
mat_Sqrt:  [[0.15]]
grads:  [-0.08498396]
Stock Position:  -0.08498396063084786
Bond Position:  [8.47275951]


portfolio before change:  [-0.34348825]
curr_Stock_Price:  103.74636890656085
curr_Factors:  [103.74636891]
mat_Sqrt:  [[0.15]]
grads:  [0.27798704]
Stock Position:  0.2779870418595734
Bond Position:  [-29.18363445]


portfolio before change:  [-0.54631499]
curr_Stock_Price:  103.02330387932845
curr_Factors:  [103.02330388]
mat_Sqrt:  [[0.15]]
grads:  [0.12643882]
Stock Position:  0.1264388152783994
Bond Position:  [-13.57245948]


portfolio before change:  [-0.70211612]
curr_Stock_Price:  101.7977876648833
curr_Factors:  [101.79778766]
mat_Sqrt:  [[0.15]]
grads:  [-0.00357912]
Stock Position:  -0.00357912330162323
Bond Position:  [-0.33776928]


portfolio before change:  [-0.70269829]
curr_Stock_Price:  101.95454727804318
curr_Factors:  [101.95454728]
mat_Sqrt:  [[0.15]]
grads:  [-0.06718622]
Stock Position:  -0.06718622357599462
Bond Position:  [6.14724272]


portfolio before change:  [-0.73721805]
curr_Stock_Price:  102.47405813021727
curr_Factors:  [102.47405813]
mat_Sqrt:  [[0.15]]
grads:  [0.06009831]
Stock Position:  0.06009831338858571
Bond Position:  [-6.89573611]


portfolio before change:  [-0.73452178]
curr_Stock_Price:  102.52609389759662
curr_Factors:  [102.5260939]
mat_Sqrt:  [[0.15]]
grads:  [0.17921145]
Stock Position:  0.17921144970102537
Bond Position:  [-19.1083717]


portfolio before change:  [-0.65294011]
curr_Stock_Price:  102.98798394848647
curr_Factors:  [102.98798395]
mat_Sqrt:  [[0.15]]
grads:  [0.03413417]
Stock Position:  0.03413416986573793
Bond Position:  [-4.16834945]


portfolio before change:  [-0.63711818]
curr_Stock_Price:  103.45913805381076
curr_Factors:  [103.45913805]
mat_Sqrt:  [[0.15]]
grads:  [-0.02111658]
Stock Position:  -0.02111657838141129
Bond Position:  [1.54758481]


portfolio before change:  [-0.63647615]
curr_Stock_Price:  103.43331438753309
curr_Factors:  [103.43331439]
mat_Sqrt:  [[0.15]]
grads:  [0.16049875]
Stock Position:  0.16049874721872995
Bond Position:  [-17.23739353]


portfolio before change:  [-0.54896598]
curr_Stock_Price:  103.98526596430187
curr_Factors:  [103.98526596]
mat_Sqrt:  [[0.15]]
grads:  [-0.06623397]
Stock Position:  -0.06623397215880976
Bond Position:  [6.33839123]


portfolio before change:  [-0.57544494]
curr_Stock_Price:  104.39102628815046
curr_Factors:  [104.39102629]
mat_Sqrt:  [[0.15]]
grads:  [-0.03764309]
Stock Position:  -0.03764309259458273
Bond Position:  [3.35415613]


portfolio before change:  [-0.5722871]
curr_Stock_Price:  104.31270659446784
curr_Factors:  [104.31270659]
mat_Sqrt:  [[0.15]]
grads:  [0.02872225]
Stock Position:  0.028722245862146823
Bond Position:  [-3.56838231]


portfolio before change:  [-0.5501002]
curr_Stock_Price:  105.0929356931892
curr_Factors:  [105.09293569]
mat_Sqrt:  [[0.15]]
grads:  [0.1283456]
Stock Position:  0.1283456047752452
Bond Position:  [-14.03831659]


portfolio before change:  [-0.56190555]
curr_Stock_Price:  105.00779115755888
curr_Factors:  [105.00779116]
mat_Sqrt:  [[0.15]]
grads:  [0.08632912]
Stock Position:  0.08632911712702626
Bond Position:  [-9.62713545]


portfolio before change:  [-0.65402222]
curr_Stock_Price:  103.94772061756696
curr_Factors:  [103.94772062]
mat_Sqrt:  [[0.15]]
grads:  [0.05299442]
Stock Position:  0.05299441502435813
Bond Position:  [-6.16267087]


portfolio before change:  [-0.62266048]
curr_Stock_Price:  104.5467822230051
curr_Factors:  [104.54678222]
mat_Sqrt:  [[0.15]]
grads:  [0.02354652]
Stock Position:  0.023546516772893652
Bond Position:  [-3.08437304]


portfolio before change:  [-0.6155255]
curr_Stock_Price:  104.85798575673125
curr_Factors:  [104.85798576]
mat_Sqrt:  [[0.15]]
grads:  [0.06280103]
Stock Position:  0.06280102548901312
Bond Position:  [-7.20071454]


portfolio before change:  [-0.67082047]
curr_Stock_Price:  103.9846733587137
curr_Factors:  [103.98467336]
mat_Sqrt:  [[0.15]]
grads:  [-0.06410688]
Stock Position:  -0.06410687807983695
Bond Position:  [5.9953123]


portfolio before change:  [-0.64167473]
curr_Stock_Price:  103.5358756625347
curr_Factors:  [103.53587566]
mat_Sqrt:  [[0.15]]
grads:  [-0.03825857]
Stock Position:  -0.03825856718455147
Bond Position:  [3.31945952]


portfolio before change:  [-0.6168078]
curr_Stock_Price:  102.89132833391174
curr_Factors:  [102.89132833]
mat_Sqrt:  [[0.15]]
grads:  [0.24821386]
Stock Position:  0.2482138605516586
Bond Position:  [-26.15586163]


portfolio before change:  [-0.83555936]
curr_Stock_Price:  102.0166118144624
curr_Factors:  [102.01661181]
mat_Sqrt:  [[0.15]]
grads:  [0.04949402]
Stock Position:  0.04949402059606011
Bond Position:  [-5.88477165]


portfolio before change:  [-0.82389266]
curr_Stock_Price:  102.2597626541542
curr_Factors:  [102.25976265]
mat_Sqrt:  [[0.15]]
grads:  [-0.00138423]
Stock Position:  -0.0013842282332775235
Bond Position:  [-0.68234181]


portfolio before change:  [-0.82314394]
curr_Stock_Price:  101.68806003706611
curr_Factors:  [101.68806004]
mat_Sqrt:  [[0.15]]
grads:  [-0.0111903]
Stock Position:  -0.011190296921996275
Bond Position:  [0.31477565]


portfolio before change:  [-0.82189799]
curr_Stock_Price:  101.5784765035589
curr_Factors:  [101.5784765]
mat_Sqrt:  [[0.15]]
grads:  [-0.03103464]
Stock Position:  -0.03103463864756222
Bond Position:  [2.33055332]


portfolio before change:  [-0.82302855]
curr_Stock_Price:  101.61959886230255
curr_Factors:  [101.61959886]
mat_Sqrt:  [[0.15]]
grads:  [-0.04693779]
Stock Position:  -0.04693778947568631
Bond Position:  [3.94677079]


portfolio before change:  [-0.83468526]
curr_Stock_Price:  101.87319822164336
curr_Factors:  [101.87319822]
mat_Sqrt:  [[0.15]]
grads:  [0.04184823]
Stock Position:  0.04184823149185911
Bond Position:  [-5.09789844]


portfolio before change:  [-0.85189254]
curr_Stock_Price:  101.46962908004926
curr_Factors:  [101.46962908]
mat_Sqrt:  [[0.15]]
grads:  [0.0033672]
Stock Position:  0.003367200676753536
Bond Position:  [-1.19356115]


portfolio before change:  [-0.85207339]
curr_Stock_Price:  101.43807582054939
curr_Factors:  [101.43807582]
mat_Sqrt:  [[0.15]]
grads:  [-0.06370649]
Stock Position:  -0.06370648856757966
Bond Position:  [5.61019023]


portfolio before change:  [-0.82264631]
curr_Stock_Price:  100.98166351056976
curr_Factors:  [100.98166351]
mat_Sqrt:  [[0.15]]
grads:  [-0.05514558]
Stock Position:  -0.055145576989736995
Bond Position:  [4.74604579]


portfolio before change:  [-0.75497285]
curr_Stock_Price:  99.75986429807828
curr_Factors:  [99.7598643]
mat_Sqrt:  [[0.15]]
grads:  [-0.01923056]
Stock Position:  -0.019230560595963092
Bond Position:  [1.16346526]


portfolio before change:  [-0.76318738]
curr_Stock_Price:  100.19080583105973
curr_Factors:  [100.19080583]
mat_Sqrt:  [[0.15]]
grads:  [0.04106286]
Stock Position:  0.04106286357010047
Bond Position:  [-4.87730877]


portfolio before change:  [-0.74856127]
curr_Stock_Price:  100.55441788270511
curr_Factors:  [100.55441788]
mat_Sqrt:  [[0.15]]
grads:  [-0.09189026]
Stock Position:  -0.09189026187617146
Bond Position:  [8.49141052]


portfolio before change:  [-0.75640892]
curr_Stock_Price:  100.64559598702668
curr_Factors:  [100.64559599]
mat_Sqrt:  [[0.15]]
grads:  [0.01370238]
Stock Position:  0.01370238179735556
Bond Position:  [-2.13549331]


portfolio before change:  [-0.75961862]
curr_Stock_Price:  100.42109333625072
curr_Factors:  [100.42109334]
mat_Sqrt:  [[0.15]]
grads:  [0.00046076]
Stock Position:  0.00046075804559628144
Bond Position:  [-0.80588844]


portfolio before change:  [-0.75983106]
curr_Stock_Price:  100.0693340479138
curr_Factors:  [100.06933405]
mat_Sqrt:  [[0.15]]
grads:  [-0.09133067]
Stock Position:  -0.09133067086708699
Bond Position:  [8.37956835]


portfolio before change:  [-0.77307562]
curr_Stock_Price:  100.22008622072217
curr_Factors:  [100.22008622]
mat_Sqrt:  [[0.15]]
grads:  [-0.03399061]
Stock Position:  -0.03399061120052091
Bond Position:  [2.63346637]


portfolio before change:  [-0.7557496]
curr_Stock_Price:  99.71519921747087
curr_Factors:  [99.71519922]
mat_Sqrt:  [[0.15]]
grads:  [-0.05587492]
Stock Position:  -0.05587491744725687
Bond Position:  [4.81582892]


portfolio before change:  [-0.75382459]
curr_Stock_Price:  99.68613403238288
curr_Factors:  [99.68613403]
mat_Sqrt:  [[0.15]]
grads:  [0.07490116]
Stock Position:  0.07490116198307112
Bond Position:  [-8.22043186]


portfolio before change:  [-0.77876054]
curr_Stock_Price:  99.36007554767596
curr_Factors:  [99.36007555]
mat_Sqrt:  [[0.15]]
grads:  [-0.02038873]
Stock Position:  -0.020388731056068542
Bond Position:  [1.24706531]


portfolio before change:  [-0.77899022]
curr_Stock_Price:  99.37516328186966
curr_Factors:  [99.37516328]
mat_Sqrt:  [[0.15]]
grads:  [0.02320209]
Stock Position:  0.023202090669638926
Bond Position:  [-3.08470177]


portfolio before change:  [-0.76729133]
curr_Stock_Price:  99.88769008781799
curr_Factors:  [99.88769009]
mat_Sqrt:  [[0.15]]
grads:  [0.00928107]
Stock Position:  0.009281071013765182
Bond Position:  [-1.69435607]


portfolio before change:  [-0.77041426]
curr_Stock_Price:  99.56261646686596
curr_Factors:  [99.56261647]
mat_Sqrt:  [[0.15]]
grads:  [-0.0106134]
Stock Position:  -0.010613403076580973
Bond Position:  [0.28628392]


portfolio before change:  [-0.77076933]
curr_Stock_Price:  99.59775743342243
curr_Factors:  [99.59775743]
mat_Sqrt:  [[0.15]]
grads:  [0.01332404]
Stock Position:  0.013324035107978392
Bond Position:  [-2.09781335]


portfolio before change:  [-0.77970133]
curr_Stock_Price:  98.93723042771143
curr_Factors:  [98.93723043]
mat_Sqrt:  [[0.15]]
grads:  [0.06030321]
Stock Position:  0.06030320980950208
Bond Position:  [-6.7459339]


portfolio before change:  [-0.80888915]
curr_Stock_Price:  98.4602047071124
curr_Factors:  [98.46020471]
mat_Sqrt:  [[0.15]]
grads:  [0.099709]
Stock Position:  0.0997089952822713
Bond Position:  [-10.62625723]


portfolio before change:  [-0.76885648]
curr_Stock_Price:  98.86836080404348
curr_Factors:  [98.8683608]
mat_Sqrt:  [[0.15]]
grads:  [-0.14671823]
Stock Position:  -0.14671822887993097
Bond Position:  [13.73693431]


portfolio before change:  [-0.85811109]
curr_Stock_Price:  99.48255306728501
curr_Factors:  [99.48255307]
mat_Sqrt:  [[0.15]]
grads:  [0.09333092]
Stock Position:  0.09333091605265093
Bond Position:  [-10.1429089]


portfolio before change:  [-0.85113291]
curr_Stock_Price:  99.56411378033765
curr_Factors:  [99.56411378]
mat_Sqrt:  [[0.15]]
grads:  [0.04334935]
Stock Position:  0.04334934942836996
Bond Position:  [-5.16717247]


portfolio before change:  [-0.83905351]
curr_Stock_Price:  99.85021621344612
curr_Factors:  [99.85021621]
mat_Sqrt:  [[0.15]]
grads:  [0.04278908]
Stock Position:  0.042789084904570465
Bond Position:  [-5.11155289]


portfolio before change:  [-0.84797411]
curr_Stock_Price:  99.64920437859921
curr_Factors:  [99.64920438]
mat_Sqrt:  [[0.15]]
grads:  [-0.08350185]
Stock Position:  -0.08350185414555257
Bond Position:  [7.47291922]


portfolio before change:  [-0.87752589]
curr_Stock_Price:  100.00870364074895
curr_Factors:  [100.00870364]
mat_Sqrt:  [[0.15]]
grads:  [-0.08361117]
Stock Position:  -0.08361116579565495
Bond Position:  [7.48431841]


portfolio before change:  [-0.8417467]
curr_Stock_Price:  99.58637478638647
curr_Factors:  [99.58637479]
mat_Sqrt:  [[0.15]]
grads:  [-0.01370782]
Stock Position:  -0.013707823267888043
Bond Position:  [0.52336573]


portfolio before change:  [-0.83649823]
curr_Stock_Price:  99.2058801571591
curr_Factors:  [99.20588016]
mat_Sqrt:  [[0.15]]
grads:  [-0.08269126]
Stock Position:  -0.08269126272412261
Bond Position:  [7.36696127]


portfolio before change:  [-0.86347346]
curr_Stock_Price:  99.5376646282285
curr_Factors:  [99.53766463]
mat_Sqrt:  [[0.15]]
grads:  [0.18581345]
Stock Position:  0.18581344661146149
Bond Position:  [-19.35890999]


portfolio before change:  [-0.7801779]
curr_Stock_Price:  99.99245158010646
curr_Factors:  [99.99245158]
mat_Sqrt:  [[0.15]]
grads:  [0.11786181]
Stock Position:  0.11786181028265841
Bond Position:  [-12.56546926]


portfolio before change:  [-0.73990654]
curr_Stock_Price:  100.34079788185082
curr_Factors:  [100.34079788]
mat_Sqrt:  [[0.15]]
grads:  [0.01536479]
Stock Position:  0.015364792955538933
Bond Position:  [-2.28162212]


portfolio before change:  [-0.75206842]
curr_Stock_Price:  99.55853728361936
curr_Factors:  [99.55853728]
mat_Sqrt:  [[0.15]]
grads:  [0.0455675]
Stock Position:  0.04556750439270543
Bond Position:  [-5.2887025]


portfolio before change:  [-0.72538956]
curr_Stock_Price:  100.1512714013308
curr_Factors:  [100.1512714]
mat_Sqrt:  [[0.15]]
grads:  [-0.09590303]
Stock Position:  -0.09590302765979751
Bond Position:  [8.8794206]


portfolio before change:  [-0.77076378]
curr_Stock_Price:  100.63018433577709
curr_Factors:  [100.63018434]
mat_Sqrt:  [[0.15]]
grads:  [-0.04636121]
Stock Position:  -0.04636121182304094
Bond Position:  [3.89457352]


portfolio before change:  [-0.74424608]
curr_Stock_Price:  100.06345456020576
curr_Factors:  [100.06345456]
mat_Sqrt:  [[0.15]]
grads:  [-0.00487147]
Stock Position:  -0.004871470665499767
Bond Position:  [-0.25678989]


portfolio before change:  [-0.74338789]
curr_Stock_Price:  99.8839930186253
curr_Factors:  [99.88399302]
mat_Sqrt:  [[0.15]]
grads:  [0.0134269]
Stock Position:  0.01342689732492742
Bond Position:  [-2.08452]


portfolio before change:  [-0.74043111]
curr_Stock_Price:  100.11390968156977
curr_Factors:  [100.11390968]
mat_Sqrt:  [[0.15]]
grads:  [0.05870015]
Stock Position:  0.05870014548334259
Bond Position:  [-6.61713217]


portfolio before change:  [-0.74417735]
curr_Stock_Price:  100.05713538832478
curr_Factors:  [100.05713539]
mat_Sqrt:  [[0.15]]
grads:  [0.07887344]
Stock Position:  0.07887344423638663
Bond Position:  [-8.63602824]


portfolio before change:  [-0.66936333]
curr_Stock_Price:  101.0125112270821
curr_Factors:  [101.01251123]
mat_Sqrt:  [[0.15]]
grads:  [-0.06439808]
Stock Position:  -0.06439808379844134
Bond Position:  [5.83564883]


portfolio before change:  [-0.68693705]
curr_Stock_Price:  101.29106700055652
curr_Factors:  [101.291067]
mat_Sqrt:  [[0.15]]
grads:  [0.01441127]
Stock Position:  0.014411266580757419
Bond Position:  [-2.14666962]


portfolio before change:  [-0.69542718]
curr_Stock_Price:  100.71124585060872
curr_Factors:  [100.71124585]
mat_Sqrt:  [[0.15]]
grads:  [-0.05587745]
Stock Position:  -0.05587744586645057
Bond Position:  [4.93206001]


portfolio before change:  [-0.72307239]
curr_Stock_Price:  101.21150981498403
curr_Factors:  [101.21150981]
mat_Sqrt:  [[0.15]]
grads:  [0.07728382]
Stock Position:  0.07728382451361006
Bond Position:  [-8.54508495]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.72307239]
Stock Price:  101.22511798859202
PL:  [-1.94819038]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.81789459e-02]
 [ 6.12062417e-03]
 [ 3.45407907e-04]
 [ 7.13139219e-04]
 [ 2.17844040e-03]
 [ 1.21645615e-02]
 [ 4.59716180e-04]
 [ 1.02247334e-02]
 [ 8.56194597e-03]
 [-2.02233051e-02]
 [ 1.02028159e-02]
 [-5.17157483e-03]
 [-9.45374680e-03]
 [ 4.33793697e-03]
 [ 5.07243456e-03]
 [-5.81409305e-03]
 [ 5.62688299e-03]
 [ 1.20740619e-02]
 [ 2.19140896e-02]
 [ 3.08978052e-03]
 [ 7.81564254e-02]
 [-1.32862632e-02]
 [ 5.02381215e-03]
 [ 6.34718022e-03]
 [ 1.42851636e-02]
 [-5.43043626e-03]
 [ 1.24295022e-02]
 [-5.57658194e-03]
 [ 2.24637808e-03]
 [-1.72581199e-02]
 [-4.34870320e-03]
 [ 6.84903765e-03]
 [ 1.05394772e-02]
 [ 6.32067226e-03]
 [-1.96037989e-03]
 [-4.09296823e-03]
 [-6.81716534e-03]
 [ 5.76598478e-03]
 [ 8.61209731e-04]
 [-8.64474606e-03]
 [-1.98174451e-02]
 [-2.60778258e-03]
 [ 9.87763873e-03]
 [-1.16520466e-02]
 [ 4.76464382e-04]
 [ 2.38690062e-03]
 [-1.36355426e-02]
 [ 2.82821581e-04]
 [ 4.24584797e-03]
 [-6.70887014e-03]
 [-3.46260090e-03]
 [ 3.48428516e-03]
 [ 1.60499935e-03]
 [ 3.62077426e-03]
 [-9.03485625e-04]
 [ 8.51673725e-03]
 [-9.16688240e-03]
 [-1.40922610e-02]
 [ 1.38931563e-02]
 [ 4.45871895e-03]
 [ 1.13870609e-02]
 [-1.51335742e-02]
 [-1.27406290e-02]
 [-3.19908086e-03]
 [-1.61389138e-02]
 [-1.89487994e-02]
 [ 2.25340571e-02]
 [ 4.11739776e-03]
 [ 9.71434484e-03]
 [-2.03050233e-02]
 [-8.01954088e-03]
 [-7.02614816e-03]
 [ 5.95423864e-03]
 [ 6.67171875e-03]
 [-6.96026327e-04]
 [-1.85584129e-03]
 [ 8.29514211e-03]
 [-3.77257987e-03]
 [ 2.44375904e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.59119032]
curr_Stock_Price:  99.31502659170104
curr_Factors:  [99.31502659]
mat_Sqrt:  [[0.15]]
grads:  [-0.25452631]
Stock Position:  -0.2545263060448618
Bond Position:  [16.68709653]


portfolio before change:  [-8.5091986]
curr_Stock_Price:  98.99698974074332
curr_Factors:  [98.99698974]
mat_Sqrt:  [[0.15]]
grads:  [0.04080416]
Stock Position:  0.04080416113183605
Bond Position:  [-12.54868772]


portfolio before change:  [-8.47896032]
curr_Stock_Price:  99.75726993208482
curr_Factors:  [99.75726993]
mat_Sqrt:  [[0.15]]
grads:  [0.00230272]
Stock Position:  0.002302719383255045
Bond Position:  [-8.70867332]


portfolio before change:  [-8.48044833]
curr_Stock_Price:  99.34745044300863
curr_Factors:  [99.34745044]
mat_Sqrt:  [[0.15]]
grads:  [0.00475426]
Stock Position:  0.0047542614630602924
Bond Position:  [-8.95277209]


portfolio before change:  [-8.48038002]
curr_Stock_Price:  99.47951705573536
curr_Factors:  [99.47951706]
mat_Sqrt:  [[0.15]]
grads:  [0.01452294]
Stock Position:  0.014522936029080237
Bond Position:  [-9.92511468]


portfolio before change:  [-8.47570608]
curr_Stock_Price:  99.84406317757698
curr_Factors:  [99.84406318]
mat_Sqrt:  [[0.15]]
grads:  [0.08109708]
Stock Position:  0.081097076937742
Bond Position:  [-16.57276775]


portfolio before change:  [-8.54384101]
curr_Stock_Price:  99.01667086294897
curr_Factors:  [99.01667086]
mat_Sqrt:  [[0.15]]
grads:  [0.00306477]
Stock Position:  0.003064774533429422
Bond Position:  [-8.84730478]


portfolio before change:  [-8.54093224]
curr_Stock_Price:  100.14619451333208
curr_Factors:  [100.14619451]
mat_Sqrt:  [[0.15]]
grads:  [0.06816489]
Stock Position:  0.06816488957313377
Bond Position:  [-15.36738653]


portfolio before change:  [-8.53339024]
curr_Stock_Price:  100.27092878196527
curr_Factors:  [100.27092878]
mat_Sqrt:  [[0.15]]
grads:  [0.05707964]
Stock Position:  0.057079639828769985
Bond Position:  [-14.25681874]


portfolio before change:  [-8.52328048]
curr_Stock_Price:  100.46365665244865
curr_Factors:  [100.46365665]
mat_Sqrt:  [[0.15]]
grads:  [-0.13482203]
Stock Position:  -0.13482203393945455
Bond Position:  [5.02143405]


portfolio before change:  [-8.51604693]
curr_Stock_Price:  100.41233193063734
curr_Factors:  [100.41233193]
mat_Sqrt:  [[0.15]]
grads:  [0.06801877]
Stock Position:  0.06801877268180972
Bond Position:  [-15.34597051]


portfolio before change:  [-8.5287424]
curr_Stock_Price:  100.23978661136482
curr_Factors:  [100.23978661]
mat_Sqrt:  [[0.15]]
grads:  [-0.03447717]
Stock Position:  -0.03447716552067266
Bond Position:  [-5.07275869]


portfolio before change:  [-8.51448686]
curr_Stock_Price:  99.81711277691005
curr_Factors:  [99.81711278]
mat_Sqrt:  [[0.15]]
grads:  [-0.06302498]
Stock Position:  -0.06302497865649044
Bond Position:  [-2.22351546]


portfolio before change:  [-8.51221352]
curr_Stock_Price:  99.77883724155397
curr_Factors:  [99.77883724]
mat_Sqrt:  [[0.15]]
grads:  [0.02891958]
Stock Position:  0.028919579821451727
Bond Position:  [-11.39777557]


portfolio before change:  [-8.50812824]
curr_Stock_Price:  99.94473384559112
curr_Factors:  [99.94473385]
mat_Sqrt:  [[0.15]]
grads:  [0.03381623]
Stock Position:  0.033816230368216085
Bond Position:  [-11.88788239]


portfolio before change:  [-8.49163353]
curr_Stock_Price:  100.45448112839952
curr_Factors:  [100.45448113]
mat_Sqrt:  [[0.15]]
grads:  [-0.03876062]
Stock Position:  -0.03876062030656647
Bond Position:  [-4.59795553]


portfolio before change:  [-8.46699239]
curr_Stock_Price:  99.8113406774546
curr_Factors:  [99.81134068]
mat_Sqrt:  [[0.15]]
grads:  [0.03751255]
Stock Position:  0.03751255326847109
Bond Position:  [-12.21117062]


portfolio before change:  [-8.44750039]
curr_Stock_Price:  100.35129907508828
curr_Factors:  [100.35129908]
mat_Sqrt:  [[0.15]]
grads:  [0.08049375]
Stock Position:  0.08049374577495547
Bond Position:  [-16.52515235]


portfolio before change:  [-8.42468369]
curr_Stock_Price:  100.64758982005564
curr_Factors:  [100.64758982]
mat_Sqrt:  [[0.15]]
grads:  [0.14609393]
Stock Position:  0.1460939309471649
Bond Position:  [-23.12868573]


portfolio before change:  [-8.46065704]
curr_Stock_Price:  100.411250390566
curr_Factors:  [100.41125039]
mat_Sqrt:  [[0.15]]
grads:  [0.02059854]
Stock Position:  0.020598536785202678
Bond Position:  [-10.52898187]


portfolio before change:  [-8.46378317]
curr_Stock_Price:  100.29143351150677
curr_Factors:  [100.29143351]
mat_Sqrt:  [[0.15]]
grads:  [0.52104284]
Stock Position:  0.5210428362848768
Bond Position:  [-60.71991614]


portfolio before change:  [-8.38089546]
curr_Stock_Price:  100.45779760764647
curr_Factors:  [100.45779761]
mat_Sqrt:  [[0.15]]
grads:  [-0.08857509]
Stock Position:  -0.08857508775217444
Bond Position:  [0.51716277]


portfolio before change:  [-8.43662938]
curr_Stock_Price:  101.08739036925637
curr_Factors:  [101.08739037]
mat_Sqrt:  [[0.15]]
grads:  [0.03349208]
Stock Position:  0.03349208098911326
Bond Position:  [-11.82225644]


portfolio before change:  [-8.45284035]
curr_Stock_Price:  100.62542859186809
curr_Factors:  [100.62542859]
mat_Sqrt:  [[0.15]]
grads:  [0.04231453]
Stock Position:  0.042314534831954784
Bond Position:  [-12.71075855]


portfolio before change:  [-8.45856101]
curr_Stock_Price:  100.50900967147423
curr_Factors:  [100.50900967]
mat_Sqrt:  [[0.15]]
grads:  [0.09523442]
Stock Position:  0.095234424119603
Bond Position:  [-18.03047867]


portfolio before change:  [-8.52563765]
curr_Stock_Price:  99.81651112093246
curr_Factors:  [99.81651112]
mat_Sqrt:  [[0.15]]
grads:  [-0.03620291]
Stock Position:  -0.036202908416703455
Bond Position:  [-4.91198964]


portfolio before change:  [-8.51097181]
curr_Stock_Price:  99.40292972188412
curr_Factors:  [99.40292972]
mat_Sqrt:  [[0.15]]
grads:  [0.08286335]
Stock Position:  0.08286334785520344
Bond Position:  [-16.74783135]


portfolio before change:  [-8.50552234]
curr_Stock_Price:  99.48132673149081
curr_Factors:  [99.48132673]
mat_Sqrt:  [[0.15]]
grads:  [-0.03717721]
Stock Position:  -0.03717721294386671
Bond Position:  [-4.80708388]


portfolio before change:  [-8.48733242]
curr_Stock_Price:  98.98396899860722
curr_Factors:  [98.983969]
mat_Sqrt:  [[0.15]]
grads:  [0.01497585]
Stock Position:  0.014975853849449033
Bond Position:  [-9.96970188]


portfolio before change:  [-8.48213905]
curr_Stock_Price:  99.37236067979677
curr_Factors:  [99.37236068]
mat_Sqrt:  [[0.15]]
grads:  [-0.11505413]
Stock Position:  -0.11505413245482403
Bond Position:  [2.9510617]


portfolio before change:  [-8.5321656]
curr_Stock_Price:  99.80877263797167
curr_Factors:  [99.80877264]
mat_Sqrt:  [[0.15]]
grads:  [-0.02899135]
Stock Position:  -0.02899135469826181
Bond Position:  [-5.63857407]


portfolio before change:  [-8.54581739]
curr_Stock_Price:  100.26750835087465
curr_Factors:  [100.26750835]
mat_Sqrt:  [[0.15]]
grads:  [0.04566025]
Stock Position:  0.04566025102891956
Bond Position:  [-13.124057]


portfolio before change:  [-8.5205101]
curr_Stock_Price:  100.83972531462398
curr_Factors:  [100.83972531]
mat_Sqrt:  [[0.15]]
grads:  [0.07026318]
Stock Position:  0.07026318160568565
Bond Position:  [-15.60583004]


portfolio before change:  [-8.47374222]
curr_Stock_Price:  101.51921746776232
curr_Factors:  [101.51921747]
mat_Sqrt:  [[0.15]]
grads:  [0.04213782]
Stock Position:  0.04213781509417306
Bond Position:  [-12.75154023]


portfolio before change:  [-8.4656309]
curr_Stock_Price:  101.73062637907528
curr_Factors:  [101.73062638]
mat_Sqrt:  [[0.15]]
grads:  [-0.0130692]
Stock Position:  -0.013069199273830906
Bond Position:  [-7.13609308]


portfolio before change:  [-8.47642135]
curr_Stock_Price:  102.52213850680306
curr_Factors:  [102.52213851]
mat_Sqrt:  [[0.15]]
grads:  [-0.02728645]
Stock Position:  -0.02728645487361885
Bond Position:  [-5.67895565]


portfolio before change:  [-8.47219271]
curr_Stock_Price:  102.35415802844305
curr_Factors:  [102.35415803]
mat_Sqrt:  [[0.15]]
grads:  [-0.04544777]
Stock Position:  -0.04544776891289277
Bond Position:  [-3.82042459]


portfolio before change:  [-8.45453838]
curr_Stock_Price:  101.96045098064512
curr_Factors:  [101.96045098]
mat_Sqrt:  [[0.15]]
grads:  [0.0384399]
Stock Position:  0.038439898519951776
Bond Position:  [-12.37388777]


portfolio before change:  [-8.46028777]
curr_Stock_Price:  101.83100239653493
curr_Factors:  [101.8310024]
mat_Sqrt:  [[0.15]]
grads:  [0.0057414]
Stock Position:  0.005741398209375915
Bond Position:  [-9.0449401]


portfolio before change:  [-8.45826048]
curr_Stock_Price:  102.28256732331344
curr_Factors:  [102.28256732]
mat_Sqrt:  [[0.15]]
grads:  [-0.05763164]
Stock Position:  -0.057631640382591345
Bond Position:  [-2.56354834]


portfolio before change:  [-8.42288452]
curr_Stock_Price:  101.66595831106154
curr_Factors:  [101.66595831]
mat_Sqrt:  [[0.15]]
grads:  [-0.1321163]
Stock Position:  -0.13211630073880648
Bond Position:  [5.00884581]


portfolio before change:  [-8.39402141]
curr_Stock_Price:  101.4498604959297
curr_Factors:  [101.4498605]
mat_Sqrt:  [[0.15]]
grads:  [-0.01738522]
Stock Position:  -0.01738521719914553
Bond Position:  [-6.63029355]


portfolio before change:  [-8.39446019]
curr_Stock_Price:  101.45126247912151
curr_Factors:  [101.45126248]
mat_Sqrt:  [[0.15]]
grads:  [0.06585092]
Stock Position:  0.06585092488649623
Bond Position:  [-15.07511966]


portfolio before change:  [-8.34018375]
curr_Stock_Price:  102.28980299469865
curr_Factors:  [102.28980299]
mat_Sqrt:  [[0.15]]
grads:  [-0.07768031]
Stock Position:  -0.07768031056777273
Bond Position:  [-0.39428008]


portfolio before change:  [-8.31955935]
curr_Stock_Price:  102.02398224737824
curr_Factors:  [102.02398225]
mat_Sqrt:  [[0.15]]
grads:  [0.00317643]
Stock Position:  0.0031764292113632166
Bond Position:  [-8.64363131]


portfolio before change:  [-8.31725419]
curr_Stock_Price:  102.91977006915535
curr_Factors:  [102.91977007]
mat_Sqrt:  [[0.15]]
grads:  [0.01591267]
Stock Position:  0.015912670800821434
Bond Position:  [-9.95498261]


portfolio before change:  [-8.31787345]
curr_Stock_Price:  102.91995505219928
curr_Factors:  [102.91995505]
mat_Sqrt:  [[0.15]]
grads:  [-0.09090362]
Stock Position:  -0.09090361720974172
Bond Position:  [1.03792275]


portfolio before change:  [-8.27704139]
curr_Stock_Price:  102.47148896635308
curr_Factors:  [102.47148897]
mat_Sqrt:  [[0.15]]
grads:  [0.00188548]
Stock Position:  0.0018854772037182367
Bond Position:  [-8.47024905]


portfolio before change:  [-8.2773431]
curr_Stock_Price:  102.59225386921634
curr_Factors:  [102.59225387]
mat_Sqrt:  [[0.15]]
grads:  [0.02830565]
Stock Position:  0.028305653163662646
Bond Position:  [-11.18128385]


portfolio before change:  [-8.27223392]
curr_Stock_Price:  102.79744355336462
curr_Factors:  [102.79744355]
mat_Sqrt:  [[0.15]]
grads:  [-0.0447258]
Stock Position:  -0.044725800911315394
Bond Position:  [-3.67453593]


portfolio before change:  [-8.27554368]
curr_Stock_Price:  102.86630974404864
curr_Factors:  [102.86630974]
mat_Sqrt:  [[0.15]]
grads:  [-0.02308401]
Stock Position:  -0.023084006009229843
Bond Position:  [-5.90097717]


portfolio before change:  [-8.27468644]
curr_Stock_Price:  102.81319664325757
curr_Factors:  [102.81319664]
mat_Sqrt:  [[0.15]]
grads:  [0.02322857]
Stock Position:  0.02322856771279179
Bond Position:  [-10.66288974]


portfolio before change:  [-8.27091276]
curr_Stock_Price:  103.00434630348282
curr_Factors:  [103.0043463]
mat_Sqrt:  [[0.15]]
grads:  [0.0107]
Stock Position:  0.010699995694682728
Bond Position:  [-9.37305882]


portfolio before change:  [-8.27298824]
curr_Stock_Price:  102.86512690428917
curr_Factors:  [102.8651269]
mat_Sqrt:  [[0.15]]
grads:  [0.0241385]
Stock Position:  0.024138495070576013
Bond Position:  [-10.7559976]


portfolio before change:  [-8.29043367]
curr_Stock_Price:  102.17025518233781
curr_Factors:  [102.17025518]
mat_Sqrt:  [[0.15]]
grads:  [-0.00602324]
Stock Position:  -0.00602323749866969
Bond Position:  [-7.67503796]


portfolio before change:  [-8.28828127]
curr_Stock_Price:  101.73326245957917
curr_Factors:  [101.73326246]
mat_Sqrt:  [[0.15]]
grads:  [0.05677825]
Stock Position:  0.05677824834151887
Bond Position:  [-14.06451771]


portfolio before change:  [-8.29057026]
curr_Stock_Price:  101.70843021251946
curr_Factors:  [101.70843021]
mat_Sqrt:  [[0.15]]
grads:  [-0.06111255]
Stock Position:  -0.06111254930757512
Bond Position:  [-2.0749088]


portfolio before change:  [-8.31327282]
curr_Stock_Price:  102.07779588076606
curr_Factors:  [102.07779588]
mat_Sqrt:  [[0.15]]
grads:  [-0.09394841]
Stock Position:  -0.09394840667863406
Bond Position:  [1.27677346]


portfolio before change:  [-8.34173727]
curr_Stock_Price:  102.38162485322437
curr_Factors:  [102.38162485]
mat_Sqrt:  [[0.15]]
grads:  [0.09262104]
Stock Position:  0.09262104176865914
Bond Position:  [-17.82443002]


portfolio before change:  [-8.38821149]
curr_Stock_Price:  101.8918855426593
curr_Factors:  [101.89188554]
mat_Sqrt:  [[0.15]]
grads:  [0.02972479]
Stock Position:  0.029724792982852785
Bond Position:  [-11.4169267]


portfolio before change:  [-8.36560558]
curr_Stock_Price:  102.67639876492225
curr_Factors:  [102.67639876]
mat_Sqrt:  [[0.15]]
grads:  [0.07591374]
Stock Position:  0.0759137391270812
Bond Position:  [-16.16015493]


portfolio before change:  [-8.35411225]
curr_Stock_Price:  102.84110371085738
curr_Factors:  [102.84110371]
mat_Sqrt:  [[0.15]]
grads:  [-0.10089049]
Stock Position:  -0.10089049437322013
Bond Position:  [2.02157754]


portfolio before change:  [-8.37851654]
curr_Stock_Price:  103.08424498101378
curr_Factors:  [103.08424498]
mat_Sqrt:  [[0.15]]
grads:  [-0.08493753]
Stock Position:  -0.08493752652699144
Bond Position:  [0.37720425]


portfolio before change:  [-8.38062943]
curr_Stock_Price:  103.10939827949312
curr_Factors:  [103.10939828]
mat_Sqrt:  [[0.15]]
grads:  [-0.02132721]
Stock Position:  -0.021327205763666705
Bond Position:  [-6.18159407]


portfolio before change:  [-8.36723348]
curr_Stock_Price:  102.46316675213713
curr_Factors:  [102.46316675]
mat_Sqrt:  [[0.15]]
grads:  [-0.10759276]
Stock Position:  -0.10759275881829063
Bond Position:  [2.65706131]


portfolio before change:  [-8.44875448]
curr_Stock_Price:  103.22239144772993
curr_Factors:  [103.22239145]
mat_Sqrt:  [[0.15]]
grads:  [-0.12632533]
Stock Position:  -0.12632532944998143
Bond Position:  [4.59084812]


portfolio before change:  [-8.50705838]
curr_Stock_Price:  103.68620051632745
curr_Factors:  [103.68620052]
mat_Sqrt:  [[0.15]]
grads:  [0.15022705]
Stock Position:  0.15022704723343686
Bond Position:  [-24.08353012]


portfolio before change:  [-8.41206007]
curr_Stock_Price:  104.32858535668623
curr_Factors:  [104.32858536]
mat_Sqrt:  [[0.15]]
grads:  [0.02744932]
Stock Position:  0.027449318386893892
Bond Position:  [-11.27580863]


portfolio before change:  [-8.42775712]
curr_Stock_Price:  103.78240454853223
curr_Factors:  [103.78240455]
mat_Sqrt:  [[0.15]]
grads:  [0.0647623]
Stock Position:  0.06476229894362862
Bond Position:  [-15.14894423]


portfolio before change:  [-8.43357545]
curr_Stock_Price:  103.70718349562964
curr_Factors:  [103.7071835]
mat_Sqrt:  [[0.15]]
grads:  [-0.13536682]
Stock Position:  -0.1353668217938052
Bond Position:  [5.60493638]


portfolio before change:  [-8.55198159]
curr_Stock_Price:  104.58447717284827
curr_Factors:  [104.58447717]
mat_Sqrt:  [[0.15]]
grads:  [-0.05346361]
Stock Position:  -0.053463605891344836
Bond Position:  [-2.96051832]


portfolio before change:  [-8.52818724]
curr_Stock_Price:  104.13595930015
curr_Factors:  [104.1359593]
mat_Sqrt:  [[0.15]]
grads:  [-0.04684099]
Stock Position:  -0.04684098772456127
Bond Position:  [-3.65035605]


portfolio before change:  [-8.52538257]
curr_Stock_Price:  104.0712120659258
curr_Factors:  [104.07121207]
mat_Sqrt:  [[0.15]]
grads:  [0.03969492]
Stock Position:  0.03969492429913259
Bond Position:  [-12.65648146]


portfolio before change:  [-8.50157312]
curr_Stock_Price:  104.69095132790407
curr_Factors:  [104.69095133]
mat_Sqrt:  [[0.15]]
grads:  [0.04447813]
Stock Position:  0.044478125031538314
Bond Position:  [-13.15803035]


portfolio before change:  [-8.49340241]
curr_Stock_Price:  104.89314315871935
curr_Factors:  [104.89314316]
mat_Sqrt:  [[0.15]]
grads:  [-0.00464018]
Stock Position:  -0.0046401755128032815
Bond Position:  [-8.00667982]


portfolio before change:  [-8.49507836]
curr_Stock_Price:  105.1464767230846
curr_Factors:  [105.14647672]
mat_Sqrt:  [[0.15]]
grads:  [-0.01237228]
Stock Position:  -0.012372275291585612
Bond Position:  [-7.1941772]


portfolio before change:  [-8.49098217]
curr_Stock_Price:  104.7790557611026
curr_Factors:  [104.77905576]
mat_Sqrt:  [[0.15]]
grads:  [0.05530095]
Stock Position:  0.05530094740034269
Bond Position:  [-14.28536323]


portfolio before change:  [-8.50713527]
curr_Stock_Price:  104.50310682971738
curr_Factors:  [104.50310683]
mat_Sqrt:  [[0.15]]
grads:  [-0.02515053]
Stock Position:  -0.025150532447180986
Bond Position:  [-5.8788265]


portfolio before change:  [-8.505238]
curr_Stock_Price:  104.41306039410105
curr_Factors:  [104.41306039]
mat_Sqrt:  [[0.15]]
grads:  [0.16291727]
Stock Position:  0.16291726919193053
Bond Position:  [-25.51592866]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.505238]
Stock Price:  104.38837953768224
PL:  [-12.89361753]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-7.62497179e-02]
 [ 3.19949894e-03]
 [ 1.16887806e-02]
 [ 2.87214317e-03]
 [ 4.88001963e-03]
 [ 1.21373375e-02]
 [-5.15400665e-04]
 [ 5.80437204e-03]
 [-6.66017058e-03]
 [-2.00480392e-02]
 [ 1.01310167e-02]
 [-7.67074358e-03]
 [ 4.83296263e-03]
 [ 4.18360903e-03]
 [ 5.48311565e-03]
 [-1.01571160e-02]
 [ 1.47753540e-02]
 [ 2.40318580e-02]
 [ 1.82486913e-02]
 [-7.85350274e-04]
 [ 4.39932658e-02]
 [-1.20823451e-02]
 [ 7.07722547e-03]
 [ 6.06095938e-03]
 [ 1.32584589e-02]
 [-7.79231971e-03]
 [ 1.34766515e-02]
 [-2.23644998e-03]
 [ 2.87302971e-03]
 [-2.70236641e-02]
 [-4.96606504e-03]
 [ 1.71063186e-02]
 [ 9.77658252e-03]
 [ 1.60997025e-02]
 [-3.94476528e-04]
 [ 4.20905835e-03]
 [-3.09890533e-03]
 [ 1.13913228e-02]
 [ 2.37233620e-03]
 [-1.37272753e-02]
 [-1.17907615e-03]
 [-2.86676108e-03]
 [ 4.06838476e-03]
 [-1.05603145e-02]
 [ 2.58026401e-03]
 [-1.47489204e-03]
 [-1.37047642e-02]
 [-5.08090070e-03]
 [-1.69574202e-03]
 [ 8.74493023e-03]
 [-2.97889899e-03]
 [ 3.69461942e-03]
 [ 1.35479486e-03]
 [-1.95889558e-03]
 [ 2.22366733e-03]
 [ 8.56677237e-03]
 [ 6.24508126e-03]
 [-2.10123815e-02]
 [ 1.40138027e-02]
 [ 3.27276772e-03]
 [ 5.07487555e-03]
 [-1.40651757e-02]
 [-1.25363884e-02]
 [-2.11725377e-03]
 [-1.23926483e-02]
 [ 3.57275928e-02]
 [ 1.28298250e-02]
 [ 2.16116362e-03]
 [ 1.01106445e-02]
 [-1.76294033e-02]
 [ 6.23141080e-03]
 [ 2.05102112e-03]
 [ 3.65487639e-04]
 [ 8.70507862e-03]
 [ 7.73579279e-03]
 [-2.64841801e-03]
 [-6.09602317e-03]
 [-9.70832349e-03]
 [-8.76092179e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.32681233]
curr_Stock_Price:  100.78798173890107
curr_Factors:  [100.78798174]
mat_Sqrt:  [[0.15]]
grads:  [-0.50833145]
Stock Position:  -0.508331452534406
Bond Position:  [65.56051349]


portfolio before change:  [13.98578386]
curr_Stock_Price:  101.46692090543397
curr_Factors:  [101.46692091]
mat_Sqrt:  [[0.15]]
grads:  [0.02132999]
Stock Position:  0.021329992908988182
Bond Position:  [11.82149515]


portfolio before change:  [13.99296291]
curr_Stock_Price:  101.76885179475447
curr_Factors:  [101.76885179]
mat_Sqrt:  [[0.15]]
grads:  [0.0779252]
Stock Position:  0.07792520385285845
Bond Position:  [6.06260439]


portfolio before change:  [13.95860276]
curr_Stock_Price:  101.32305163178032
curr_Factors:  [101.32305163]
mat_Sqrt:  [[0.15]]
grads:  [0.01914762]
Stock Position:  0.019147621161172756
Bond Position:  [12.01850736]


portfolio before change:  [13.95248214]
curr_Stock_Price:  100.96416592761815
curr_Factors:  [100.96416593]
mat_Sqrt:  [[0.15]]
grads:  [0.03253346]
Stock Position:  0.03253346422269534
Bond Position:  [10.66776806]


portfolio before change:  [13.97454251]
curr_Stock_Price:  101.62175407389357
curr_Factors:  [101.62175407]
mat_Sqrt:  [[0.15]]
grads:  [0.08091558]
Stock Position:  0.08091558349789053
Bond Position:  [5.75175899]


portfolio before change:  [14.0064756]
curr_Stock_Price:  102.01195816192374
curr_Factors:  [102.01195816]
mat_Sqrt:  [[0.15]]
grads:  [-0.003436]
Stock Position:  -0.0034360044365408645
Bond Position:  [14.35698914]


portfolio before change:  [14.00897619]
curr_Stock_Price:  101.54535486974305
curr_Factors:  [101.54535487]
mat_Sqrt:  [[0.15]]
grads:  [0.03869581]
Stock Position:  0.038695813630027685
Bond Position:  [10.07959607]


portfolio before change:  [14.00674911]
curr_Stock_Price:  101.47152069478267
curr_Factors:  [101.47152069]
mat_Sqrt:  [[0.15]]
grads:  [-0.04440114]
Stock Position:  -0.04440113721597506
Bond Position:  [18.51220003]


portfolio before change:  [14.02659848]
curr_Stock_Price:  101.05053338400967
curr_Factors:  [101.05053338]
mat_Sqrt:  [[0.15]]
grads:  [-0.13365359]
Stock Position:  -0.13365359478551608
Bond Position:  [27.53236552]


portfolio before change:  [14.00549962]
curr_Stock_Price:  101.22127089873003
curr_Factors:  [101.2212709]
mat_Sqrt:  [[0.15]]
grads:  [0.06754011]
Stock Position:  0.06754011104644445
Bond Position:  [7.16900374]


portfolio before change:  [14.00547565]
curr_Stock_Price:  101.21428175212604
curr_Factors:  [101.21428175]
mat_Sqrt:  [[0.15]]
grads:  [-0.05113829]
Stock Position:  -0.05113829051313222
Bond Position:  [19.18140099]


portfolio before change:  [14.02416023]
curr_Stock_Price:  100.8723520009907
curr_Factors:  [100.872352]
mat_Sqrt:  [[0.15]]
grads:  [0.03221975]
Stock Position:  0.03221975087497452
Bond Position:  [10.77407818]


portfolio before change:  [14.02528609]
curr_Stock_Price:  100.88639510879219
curr_Factors:  [100.88639511]
mat_Sqrt:  [[0.15]]
grads:  [0.02789073]
Stock Position:  0.02789072683748804
Bond Position:  [11.21149121]


portfolio before change:  [14.00310312]
curr_Stock_Price:  100.06591752272881
curr_Factors:  [100.06591752]
mat_Sqrt:  [[0.15]]
grads:  [0.0365541]
Stock Position:  0.03655410431641189
Bond Position:  [10.34528313]


portfolio before change:  [14.04559309]
curr_Stock_Price:  101.21061450748469
curr_Factors:  [101.21061451]
mat_Sqrt:  [[0.15]]
grads:  [-0.06771411]
Stock Position:  -0.0677141064736636
Bond Position:  [20.89897942]


portfolio before change:  [14.07352066]
curr_Stock_Price:  100.81747130362157
curr_Factors:  [100.8174713]
mat_Sqrt:  [[0.15]]
grads:  [0.09850236]
Stock Position:  0.09850235967225
Bond Position:  [4.14276184]


portfolio before change:  [14.16166915]
curr_Stock_Price:  101.70972968648124
curr_Factors:  [101.70972969]
mat_Sqrt:  [[0.15]]
grads:  [0.16021239]
Stock Position:  0.1602123863522582
Bond Position:  [-2.13348936]


portfolio before change:  [14.16678747]
curr_Stock_Price:  101.74250910055291
curr_Factors:  [101.7425091]
mat_Sqrt:  [[0.15]]
grads:  [0.12165794]
Stock Position:  0.12165794203664498
Bond Position:  [1.78900319]


portfolio before change:  [14.19113773]
curr_Stock_Price:  101.94174347259049
curr_Factors:  [101.94174347]
mat_Sqrt:  [[0.15]]
grads:  [-0.00523567]
Stock Position:  -0.005235668496431807
Bond Position:  [14.7248709]


portfolio before change:  [14.18904377]
curr_Stock_Price:  102.51746605406278
curr_Factors:  [102.51746605]
mat_Sqrt:  [[0.15]]
grads:  [0.29328844]
Stock Position:  0.2932884383494924
Bond Position:  [-15.87814375]


portfolio before change:  [14.18417006]
curr_Stock_Price:  102.50423233174449
curr_Factors:  [102.50423233]
mat_Sqrt:  [[0.15]]
grads:  [-0.08054897]
Stock Position:  -0.08054896735886015
Bond Position:  [22.44078012]


portfolio before change:  [14.26900352]
curr_Stock_Price:  101.46845398377502
curr_Factors:  [101.46845398]
mat_Sqrt:  [[0.15]]
grads:  [0.0471815]
Stock Position:  0.047181503128830404
Bond Position:  [9.48156934]


portfolio before change:  [14.23124276]
curr_Stock_Price:  100.65556385940376
curr_Factors:  [100.65556386]
mat_Sqrt:  [[0.15]]
grads:  [0.0404064]
Stock Position:  0.04040639586136706
Bond Position:  [10.1641142]


portfolio before change:  [14.20853363]
curr_Stock_Price:  100.07782349073379
curr_Factors:  [100.07782349]
mat_Sqrt:  [[0.15]]
grads:  [0.08838973]
Stock Position:  0.08838972598471859
Bond Position:  [5.36268224]


portfolio before change:  [14.21253857]
curr_Stock_Price:  100.11934139940216
curr_Factors:  [100.1193414]
mat_Sqrt:  [[0.15]]
grads:  [-0.0519488]
Stock Position:  -0.051948798058410975
Bond Position:  [19.41361802]


portfolio before change:  [14.20690574]
curr_Stock_Price:  100.25112917687547
curr_Factors:  [100.25112918]
mat_Sqrt:  [[0.15]]
grads:  [0.08984434]
Stock Position:  0.08984434306072883
Bond Position:  [5.1999089]


portfolio before change:  [14.16747378]
curr_Stock_Price:  99.80861983792823
curr_Factors:  [99.80861984]
mat_Sqrt:  [[0.15]]
grads:  [-0.01490967]
Stock Position:  -0.014909666550403888
Bond Position:  [15.65558702]


portfolio before change:  [14.16807156]
curr_Stock_Price:  99.83415581056624
curr_Factors:  [99.83415581]
mat_Sqrt:  [[0.15]]
grads:  [0.01915353]
Stock Position:  0.019153531387156895
Bond Position:  [12.25589492]


portfolio before change:  [14.18290148]
curr_Stock_Price:  100.56842783079368
curr_Factors:  [100.56842783]
mat_Sqrt:  [[0.15]]
grads:  [-0.18015776]
Stock Position:  -0.18015776098898675
Bond Position:  [32.30108426]


portfolio before change:  [14.15500827]
curr_Stock_Price:  100.73446058820309
curr_Factors:  [100.73446059]
mat_Sqrt:  [[0.15]]
grads:  [-0.0331071]
Stock Position:  -0.03310710026977689
Bond Position:  [17.49003415]


portfolio before change:  [14.13838924]
curr_Stock_Price:  101.26945724698257
curr_Factors:  [101.26945725]
mat_Sqrt:  [[0.15]]
grads:  [0.11404212]
Stock Position:  0.11404212416445694
Bond Position:  [2.58940522]


portfolio before change:  [14.10918242]
curr_Stock_Price:  101.01193252067137
curr_Factors:  [101.01193252]
mat_Sqrt:  [[0.15]]
grads:  [0.06517722]
Stock Position:  0.06517721680275401
Bond Position:  [7.52550579]


portfolio before change:  [14.04787842]
curr_Stock_Price:  100.06414184359302
curr_Factors:  [100.06414184]
mat_Sqrt:  [[0.15]]
grads:  [0.10733135]
Stock Position:  0.1073313502784005
Bond Position:  [3.30785896]


portfolio before change:  [14.03718435]
curr_Stock_Price:  99.96257955463768
curr_Factors:  [99.96257955]
mat_Sqrt:  [[0.15]]
grads:  [-0.00262984]
Stock Position:  -0.0026298435188233313
Bond Position:  [14.30007029]


portfolio before change:  [14.03984046]
curr_Stock_Price:  99.2924518507496
curr_Factors:  [99.29245185]
mat_Sqrt:  [[0.15]]
grads:  [0.02806039]
Stock Position:  0.028060388982496656
Bond Position:  [11.25365564]


portfolio before change:  [14.05845634]
curr_Stock_Price:  99.93080733980982
curr_Factors:  [99.93080734]
mat_Sqrt:  [[0.15]]
grads:  [-0.02065937]
Stock Position:  -0.020659368865812943
Bond Position:  [16.12296375]


portfolio before change:  [14.07014537]
curr_Stock_Price:  99.41378699889393
curr_Factors:  [99.413787]
mat_Sqrt:  [[0.15]]
grads:  [0.07594215]
Stock Position:  0.0759421521847641
Bond Position:  [6.52044843]


portfolio before change:  [14.02199757]
curr_Stock_Price:  98.77441433562036
curr_Factors:  [98.77441434]
mat_Sqrt:  [[0.15]]
grads:  [0.01581557]
Stock Position:  0.015815574636243192
Bond Position:  [12.45982345]


portfolio before change:  [14.0300864]
curr_Stock_Price:  99.2366208472389
curr_Factors:  [99.23662085]
mat_Sqrt:  [[0.15]]
grads:  [-0.09151517]
Stock Position:  -0.0915151686596516
Bond Position:  [23.11174249]


portfolio before change:  [14.01031313]
curr_Stock_Price:  99.46847093241493
curr_Factors:  [99.46847093]
mat_Sqrt:  [[0.15]]
grads:  [-0.00786051]
Stock Position:  -0.007860507695975974
Bond Position:  [14.79218581]


portfolio before change:  [14.00926042]
curr_Stock_Price:  99.72001251747191
curr_Factors:  [99.72001252]
mat_Sqrt:  [[0.15]]
grads:  [-0.01911174]
Stock Position:  -0.019111740538506304
Bond Position:  [15.91508343]


portfolio before change:  [14.02184049]
curr_Stock_Price:  99.11382253025971
curr_Factors:  [99.11382253]
mat_Sqrt:  [[0.15]]
grads:  [0.02712257]
Stock Position:  0.027122565056819255
Bond Position:  [11.33361939]


portfolio before change:  [14.03840813]
curr_Stock_Price:  99.69854812382694
curr_Factors:  [99.69854812]
mat_Sqrt:  [[0.15]]
grads:  [-0.0704021]
Stock Position:  -0.07040209660226947
Bond Position:  [21.05739494]


portfolio before change:  [14.00622296]
curr_Stock_Price:  100.1744045773891
curr_Factors:  [100.17440458]
mat_Sqrt:  [[0.15]]
grads:  [0.01720176]
Stock Position:  0.01720176004385464
Bond Position:  [12.28304689]


portfolio before change:  [14.00191216]
curr_Stock_Price:  99.87917196973177
curr_Factors:  [99.87917197]
mat_Sqrt:  [[0.15]]
grads:  [-0.00983261]
Stock Position:  -0.009832613567462895
Bond Position:  [14.98398546]


portfolio before change:  [13.99064296]
curr_Stock_Price:  101.12052263201329
curr_Factors:  [101.12052263]
mat_Sqrt:  [[0.15]]
grads:  [-0.09136509]
Stock Position:  -0.09136509435953145
Bond Position:  [23.22952905]


portfolio before change:  [14.07963048]
curr_Stock_Price:  100.16243650223079
curr_Factors:  [100.1624365]
mat_Sqrt:  [[0.15]]
grads:  [-0.03387267]
Stock Position:  -0.03387267131859859
Bond Position:  [17.47239977]


portfolio before change:  [14.07575463]
curr_Stock_Price:  100.30910069662359
curr_Factors:  [100.3091007]
mat_Sqrt:  [[0.15]]
grads:  [-0.01130495]
Stock Position:  -0.011304946784529717
Bond Position:  [15.20974368]


portfolio before change:  [14.07832455]
curr_Stock_Price:  100.16586443106786
curr_Factors:  [100.16586443]
mat_Sqrt:  [[0.15]]
grads:  [0.05829953]
Stock Position:  0.05829953487111339
Bond Position:  [8.23870124]


portfolio before change:  [14.1139085]
curr_Stock_Price:  100.76739599234728
curr_Factors:  [100.76739599]
mat_Sqrt:  [[0.15]]
grads:  [-0.01985933]
Stock Position:  -0.019859326598291576
Bond Position:  [16.11508112]


portfolio before change:  [14.12874265]
curr_Stock_Price:  100.07115227950533
curr_Factors:  [100.07115228]
mat_Sqrt:  [[0.15]]
grads:  [0.0246308]
Stock Position:  0.02463079615202431
Bond Position:  [11.6639105]


portfolio before change:  [14.12603942]
curr_Stock_Price:  99.93180457281602
curr_Factors:  [99.93180457]
mat_Sqrt:  [[0.15]]
grads:  [0.00903197]
Stock Position:  0.009031965758599173
Bond Position:  [13.22345879]


portfolio before change:  [14.13084291]
curr_Stock_Price:  100.37212890044172
curr_Factors:  [100.3721289]
mat_Sqrt:  [[0.15]]
grads:  [-0.0130593]
Stock Position:  -0.013059303849198175
Bond Position:  [15.44163304]


portfolio before change:  [14.13212106]
curr_Stock_Price:  100.34815957938349
curr_Factors:  [100.34815958]
mat_Sqrt:  [[0.15]]
grads:  [0.01482445]
Stock Position:  0.014824448890515643
Bond Position:  [12.6445149]


portfolio before change:  [14.13859151]
curr_Stock_Price:  100.73131984130849
curr_Factors:  [100.73131984]
mat_Sqrt:  [[0.15]]
grads:  [0.05711182]
Stock Position:  0.05711181576745891
Bond Position:  [8.38564293]


portfolio before change:  [14.11154188]
curr_Stock_Price:  100.24851693491084
curr_Factors:  [100.24851693]
mat_Sqrt:  [[0.15]]
grads:  [0.04163388]
Stock Position:  0.04163387507203265
Bond Position:  [9.93780765]


portfolio before change:  [14.12235645]
curr_Stock_Price:  100.49335213295853
curr_Factors:  [100.49335213]
mat_Sqrt:  [[0.15]]
grads:  [-0.14008254]
Stock Position:  -0.1400825431450653
Bond Position:  [28.19972079]


portfolio before change:  [14.25060737]
curr_Stock_Price:  99.59039603916104
curr_Factors:  [99.59039604]
mat_Sqrt:  [[0.15]]
grads:  [0.09342535]
Stock Position:  0.09342535159040796
Bond Position:  [4.94633961]


portfolio before change:  [14.15832888]
curr_Stock_Price:  98.59936260210921
curr_Factors:  [98.5993626]
mat_Sqrt:  [[0.15]]
grads:  [0.02181845]
Stock Position:  0.02181845149307157
Bond Position:  [12.00704347]


portfolio before change:  [14.16234396]
curr_Stock_Price:  98.748988683892
curr_Factors:  [98.74898868]
mat_Sqrt:  [[0.15]]
grads:  [0.0338325]
Stock Position:  0.03383250365554871
Bond Position:  [10.82141843]


portfolio before change:  [14.16127514]
curr_Stock_Price:  98.69740595525276
curr_Factors:  [98.69740596]
mat_Sqrt:  [[0.15]]
grads:  [-0.09376784]
Stock Position:  -0.0937678382004567
Bond Position:  [23.41591753]


portfolio before change:  [14.0832348]
curr_Stock_Price:  99.54528606473332
curr_Factors:  [99.54528606]
mat_Sqrt:  [[0.15]]
grads:  [-0.08357592]
Stock Position:  -0.083575922984274
Bond Position:  [22.40282396]


portfolio before change:  [14.07205812]
curr_Stock_Price:  99.6957707400844
curr_Factors:  [99.69577074]
mat_Sqrt:  [[0.15]]
grads:  [-0.01411503]
Stock Position:  -0.014115025155231794
Bond Position:  [15.47926643]


portfolio before change:  [14.07370903]
curr_Stock_Price:  99.64735290753964
curr_Factors:  [99.64735291]
mat_Sqrt:  [[0.15]]
grads:  [-0.08261766]
Stock Position:  -0.08261765515106294
Bond Position:  [22.30633967]


portfolio before change:  [14.06216389]
curr_Stock_Price:  99.80396984545963
curr_Factors:  [99.80396985]
mat_Sqrt:  [[0.15]]
grads:  [0.23818395]
Stock Position:  0.23818395189545696
Bond Position:  [-9.70954006]


portfolio before change:  [13.88877078]
curr_Stock_Price:  99.0785378953002
curr_Factors:  [99.0785379]
mat_Sqrt:  [[0.15]]
grads:  [0.08553217]
Stock Position:  0.08553216639260802
Bond Position:  [5.41436879]


portfolio before change:  [13.84108728]
curr_Stock_Price:  98.51708939914558
curr_Factors:  [98.5170894]
mat_Sqrt:  [[0.15]]
grads:  [0.01440776]
Stock Position:  0.014407757483074836
Bond Position:  [12.42167695]


portfolio before change:  [13.83108656]
curr_Stock_Price:  97.7690824898179
curr_Factors:  [97.76908249]
mat_Sqrt:  [[0.15]]
grads:  [0.0674043]
Stock Position:  0.06740429676783743
Bond Position:  [7.24103031]


portfolio before change:  [13.80003338]
curr_Stock_Price:  97.3016678125202
curr_Factors:  [97.30166781]
mat_Sqrt:  [[0.15]]
grads:  [-0.11752936]
Stock Position:  -0.11752935529080244
Bond Position:  [25.23583566]


portfolio before change:  [13.82037383]
curr_Stock_Price:  97.14202118381736
curr_Factors:  [97.14202118]
mat_Sqrt:  [[0.15]]
grads:  [0.04154274]
Stock Position:  0.041542738650918225
Bond Position:  [9.78482823]


portfolio before change:  [13.85280459]
curr_Stock_Price:  97.90795971845525
curr_Factors:  [97.90795972]
mat_Sqrt:  [[0.15]]
grads:  [0.01367347]
Stock Position:  0.013673474140420047
Bond Position:  [12.51406263]


portfolio before change:  [13.8536884]
curr_Stock_Price:  97.91539449577998
curr_Factors:  [97.9153945]
mat_Sqrt:  [[0.15]]
grads:  [0.00243658]
Stock Position:  0.002436584260665042
Bond Position:  [13.61510929]


portfolio before change:  [13.85636197]
curr_Stock_Price:  98.6634070442479
curr_Factors:  [98.66340704]
mat_Sqrt:  [[0.15]]
grads:  [0.05803386]
Stock Position:  0.058033857442553904
Bond Position:  [8.13054387]


portfolio before change:  [13.85942109]
curr_Stock_Price:  98.70736320405418
curr_Factors:  [98.7073632]
mat_Sqrt:  [[0.15]]
grads:  [0.05157195]
Stock Position:  0.051571951964355496
Bond Position:  [8.76888969]


portfolio before change:  [13.85034411]
curr_Stock_Price:  98.52072976751911
curr_Factors:  [98.52072977]
mat_Sqrt:  [[0.15]]
grads:  [-0.01765612]
Stock Position:  -0.017656120043271564
Bond Position:  [15.58983794]


portfolio before change:  [13.84969695]
curr_Stock_Price:  98.6125705379138
curr_Factors:  [98.61257054]
mat_Sqrt:  [[0.15]]
grads:  [-0.04064015]
Stock Position:  -0.040640154490380644
Bond Position:  [17.85732705]


portfolio before change:  [13.84733856]
curr_Stock_Price:  98.69806510662228
curr_Factors:  [98.69806511]
mat_Sqrt:  [[0.15]]
grads:  [-0.06472216]
Stock Position:  -0.06472215661199493
Bond Position:  [20.23529019]


portfolio before change:  [13.86606885]
curr_Stock_Price:  98.42821091074902
curr_Factors:  [98.42821091]
mat_Sqrt:  [[0.15]]
grads:  [-0.05840615]
Stock Position:  -0.058406145286676314
Bond Position:  [19.61488124]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.86606885]
Stock Price:  98.7926916243045
PL:  [13.86606885]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.47467759e-02]
 [-9.38584310e-04]
 [ 3.50578789e-04]
 [ 2.20692654e-03]
 [ 4.95642734e-03]
 [ 1.21234742e-02]
 [-1.63799125e-04]
 [ 6.30831655e-03]
 [-7.80287952e-03]
 [-4.30342758e-03]
 [ 1.00271044e-02]
 [-8.58076781e-03]
 [ 2.27472989e-03]
 [ 4.21212710e-03]
 [ 5.33832815e-03]
 [-2.75029796e-03]
 [ 1.28432463e-02]
 [ 2.25308592e-02]
 [ 2.05412848e-02]
 [ 2.57214505e-04]
 [ 7.92913644e-02]
 [-1.37997216e-02]
 [-3.88579635e-04]
 [ 5.72825021e-03]
 [ 1.21154005e-02]
 [-2.02489186e-03]
 [ 1.31276291e-02]
 [ 9.87570323e-04]
 [ 2.76638821e-03]
 [-2.14615897e-02]
 [-4.93604323e-03]
 [-1.65473520e-04]
 [ 1.24383036e-02]
 [ 1.50853083e-02]
 [ 3.02275921e-03]
 [-3.42594380e-03]
 [-4.04851775e-03]
 [ 1.25688168e-02]
 [-5.08710391e-04]
 [-1.37269414e-02]
 [ 2.56941574e-03]
 [-2.88204066e-03]
 [ 6.11517355e-03]
 [-1.18117493e-02]
 [ 1.11427911e-03]
 [ 4.82791100e-04]
 [-1.36932365e-02]
 [-2.40677802e-03]
 [-6.63295786e-03]
 [ 9.92733850e-03]
 [-2.98388545e-03]
 [ 3.80324065e-03]
 [-1.51198720e-05]
 [ 1.38583187e-03]
 [ 1.95113086e-03]
 [ 8.56310928e-03]
 [-4.13824357e-03]
 [-1.89544546e-02]
 [ 1.33877642e-02]
 [ 5.14175972e-03]
 [ 9.96379614e-03]
 [-1.45662128e-02]
 [-1.27369043e-02]
 [-2.88452540e-03]
 [-2.01562064e-02]
 [ 2.25115749e-02]
 [ 1.98587301e-02]
 [ 2.20001905e-03]
 [ 6.15804093e-03]
 [-1.35859142e-02]
 [-8.12899338e-03]
 [-6.14383689e-03]
 [ 2.26196351e-03]
 [ 8.58803114e-03]
 [ 1.04594020e-02]
 [-9.39979282e-03]
 [-4.28968449e-04]
 [-8.17256917e-03]
 [ 5.81782760e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.42695652]
curr_Stock_Price:  99.77547662334743
curr_Factors:  [99.77547662]
mat_Sqrt:  [[0.15]]
grads:  [-0.23164517]
Stock Position:  -0.23164517257516912
Bond Position:  [21.68555098]


portfolio before change:  [-1.43931334]
curr_Stock_Price:  99.83467150254044
curr_Factors:  [99.8346715]
mat_Sqrt:  [[0.15]]
grads:  [-0.00625723]
Stock Position:  -0.006257228733295761
Bond Position:  [-0.81462497]


portfolio before change:  [-1.44417059]
curr_Stock_Price:  100.60279598569065
curr_Factors:  [100.60279599]
mat_Sqrt:  [[0.15]]
grads:  [0.00233719]
Stock Position:  0.0023371919283181417
Bond Position:  [-1.67929863]


portfolio before change:  [-1.4448904]
curr_Stock_Price:  100.3397248892822
curr_Factors:  [100.33972489]
mat_Sqrt:  [[0.15]]
grads:  [0.01471284]
Stock Position:  0.014712843582903744
Bond Position:  [-2.92117307]


portfolio before change:  [-1.43568933]
curr_Stock_Price:  100.9775112102904
curr_Factors:  [100.97751121]
mat_Sqrt:  [[0.15]]
grads:  [0.03304285]
Stock Position:  0.03304284895515244
Bond Position:  [-4.77227398]


portfolio before change:  [-1.41620999]
curr_Stock_Price:  101.57605549257487
curr_Factors:  [101.57605549]
mat_Sqrt:  [[0.15]]
grads:  [0.08082316]
Stock Position:  0.08082316134169588
Bond Position:  [-9.62590792]


portfolio before change:  [-1.41075584]
curr_Stock_Price:  101.65098189360174
curr_Factors:  [101.65098189]
mat_Sqrt:  [[0.15]]
grads:  [-0.00109199]
Stock Position:  -0.0010919941661799441
Bond Position:  [-1.29975356]


portfolio before change:  [-1.41085785]
curr_Stock_Price:  101.66999778280751
curr_Factors:  [101.66999778]
mat_Sqrt:  [[0.15]]
grads:  [0.04205544]
Stock Position:  0.04205544366276677
Bond Position:  [-5.68663471]


portfolio before change:  [-1.41279722]
curr_Stock_Price:  101.63233435127954
curr_Factors:  [101.63233435]
mat_Sqrt:  [[0.15]]
grads:  [-0.0520192]
Stock Position:  -0.052019196818635025
Bond Position:  [3.87403518]


portfolio before change:  [-1.42773848]
curr_Stock_Price:  101.92421495943469
curr_Factors:  [101.92421496]
mat_Sqrt:  [[0.15]]
grads:  [-0.02868952]
Stock Position:  -0.028689517210526497
Bond Position:  [1.49641804]


portfolio before change:  [-1.42178289]
curr_Stock_Price:  101.71988711934254
curr_Factors:  [101.71988712]
mat_Sqrt:  [[0.15]]
grads:  [0.06684736]
Stock Position:  0.06684736299075852
Bond Position:  [-8.22148911]


portfolio before change:  [-1.43359675]
curr_Stock_Price:  101.55084529546713
curr_Factors:  [101.5508453]
mat_Sqrt:  [[0.15]]
grads:  [-0.05720512]
Stock Position:  -0.05720511871835324
Bond Position:  [4.37563141]


portfolio before change:  [-1.38807986]
curr_Stock_Price:  100.75994760270223
curr_Factors:  [100.7599476]
mat_Sqrt:  [[0.15]]
grads:  [0.01516487]
Stock Position:  0.015164865932017768
Bond Position:  [-2.91609096]


portfolio before change:  [-1.38795493]
curr_Stock_Price:  100.78020470725743
curr_Factors:  [100.78020471]
mat_Sqrt:  [[0.15]]
grads:  [0.02808085]
Stock Position:  0.02808084735181912
Bond Position:  [-4.21794847]


portfolio before change:  [-1.3871135]
curr_Stock_Price:  100.81955754963585
curr_Factors:  [100.81955755]
mat_Sqrt:  [[0.15]]
grads:  [0.03558885]
Stock Position:  0.03558885430900769
Bond Position:  [-4.97516604]


portfolio before change:  [-1.4082834]
curr_Stock_Price:  100.23344854289273
curr_Factors:  [100.23344854]
mat_Sqrt:  [[0.15]]
grads:  [-0.01833532]
Stock Position:  -0.01833531972508454
Bond Position:  [0.42952892]


portfolio before change:  [-1.4269535]
curr_Stock_Price:  101.2531711667071
curr_Factors:  [101.25317117]
mat_Sqrt:  [[0.15]]
grads:  [0.08562164]
Stock Position:  0.0856216422349916
Bond Position:  [-10.0964163]


portfolio before change:  [-1.4100438]
curr_Stock_Price:  101.45803459483682
curr_Factors:  [101.45803459]
mat_Sqrt:  [[0.15]]
grads:  [0.15020573]
Stock Position:  0.150205728139387
Bond Position:  [-16.64962176]


portfolio before change:  [-1.50478693]
curr_Stock_Price:  100.83420686873299
curr_Factors:  [100.83420687]
mat_Sqrt:  [[0.15]]
grads:  [0.1369419]
Stock Position:  0.13694189868924028
Bond Position:  [-15.31321467]


portfolio before change:  [-1.44501929]
curr_Stock_Price:  101.27764124412953
curr_Factors:  [101.27764124]
mat_Sqrt:  [[0.15]]
grads:  [0.00171476]
Stock Position:  0.00171476336561001
Bond Position:  [-1.61868648]


portfolio before change:  [-1.44663471]
curr_Stock_Price:  100.39457745740992
curr_Factors:  [100.39457746]
mat_Sqrt:  [[0.15]]
grads:  [0.5286091]
Stock Position:  0.5286090957885052
Bond Position:  [-54.51612152]


portfolio before change:  [-1.57585337]
curr_Stock_Price:  100.15657304058075
curr_Factors:  [100.15657304]
mat_Sqrt:  [[0.15]]
grads:  [-0.09199814]
Stock Position:  -0.09199814405058328
Bond Position:  [7.63836546]


portfolio before change:  [-1.60166912]
curr_Stock_Price:  100.44237400791924
curr_Factors:  [100.44237401]
mat_Sqrt:  [[0.15]]
grads:  [-0.00259053]
Stock Position:  -0.002590530899964199
Bond Position:  [-1.34147005]


portfolio before change:  [-1.60239598]
curr_Stock_Price:  100.69059373215777
curr_Factors:  [100.69059373]
mat_Sqrt:  [[0.15]]
grads:  [0.03818833]
Stock Position:  0.03818833473887838
Bond Position:  [-5.44760208]


portfolio before change:  [-1.63586528]
curr_Stock_Price:  99.82308238999711
curr_Factors:  [99.82308239]
mat_Sqrt:  [[0.15]]
grads:  [0.08076934]
Stock Position:  0.08076933660000134
Bond Position:  [-9.69850943]


portfolio before change:  [-1.66285922]
curr_Stock_Price:  99.49637726792858
curr_Factors:  [99.49637727]
mat_Sqrt:  [[0.15]]
grads:  [-0.01349928]
Stock Position:  -0.013499279071228337
Bond Position:  [-0.31972985]


portfolio before change:  [-1.67564245]
curr_Stock_Price:  100.44185372502784
curr_Factors:  [100.44185373]
mat_Sqrt:  [[0.15]]
grads:  [0.08751753]
Stock Position:  0.08751752751635446
Bond Position:  [-10.46606515]


portfolio before change:  [-1.6977255]
curr_Stock_Price:  100.19700102975368
curr_Factors:  [100.19700103]
mat_Sqrt:  [[0.15]]
grads:  [0.0065838]
Stock Position:  0.006583802150476442
Bond Position:  [-2.35740273]


portfolio before change:  [-1.70125901]
curr_Stock_Price:  99.68268394779633
curr_Factors:  [99.68268395]
mat_Sqrt:  [[0.15]]
grads:  [0.01844259]
Stock Position:  0.01844258807914102
Bond Position:  [-3.53966568]


portfolio before change:  [-1.69837957]
curr_Stock_Price:  99.85080941646805
curr_Factors:  [99.85080942]
mat_Sqrt:  [[0.15]]
grads:  [-0.14307726]
Stock Position:  -0.14307726445151217
Bond Position:  [12.58800109]


portfolio before change:  [-1.8170722]
curr_Stock_Price:  100.68587848201888
curr_Factors:  [100.68587848]
mat_Sqrt:  [[0.15]]
grads:  [-0.03290695]
Stock Position:  -0.03290695485363113
Bond Position:  [1.49619346]


portfolio before change:  [-1.78706858]
curr_Stock_Price:  99.7769490760468
curr_Factors:  [99.77694908]
mat_Sqrt:  [[0.15]]
grads:  [-0.00110316]
Stock Position:  -0.0011031568007192905
Bond Position:  [-1.67699896]


portfolio before change:  [-1.78794633]
curr_Stock_Price:  100.47760447608935
curr_Factors:  [100.47760448]
mat_Sqrt:  [[0.15]]
grads:  [0.08292202]
Stock Position:  0.0829220239107142
Bond Position:  [-10.11975265]


portfolio before change:  [-1.7995937]
curr_Stock_Price:  100.34477045055034
curr_Factors:  [100.34477045]
mat_Sqrt:  [[0.15]]
grads:  [0.10056872]
Stock Position:  0.1005687217832079
Bond Position:  [-11.891139]


portfolio before change:  [-1.73665286]
curr_Stock_Price:  100.97800964312368
curr_Factors:  [100.97800964]
mat_Sqrt:  [[0.15]]
grads:  [0.02015173]
Stock Position:  0.020151728070708086
Bond Position:  [-3.77153426]


portfolio before change:  [-1.74282532]
curr_Stock_Price:  100.68340838378998
curr_Factors:  [100.68340838]
mat_Sqrt:  [[0.15]]
grads:  [-0.02283963]
Stock Position:  -0.02283962532936761
Bond Position:  [0.55674601]


portfolio before change:  [-1.73018098]
curr_Stock_Price:  100.13131791795762
curr_Factors:  [100.13131792]
mat_Sqrt:  [[0.15]]
grads:  [-0.02699012]
Stock Position:  -0.026990118341559417
Bond Position:  [0.97237514]


portfolio before change:  [-1.73145624]
curr_Stock_Price:  100.18081881960597
curr_Factors:  [100.18081882]
mat_Sqrt:  [[0.15]]
grads:  [0.08379211]
Stock Position:  0.08379211198023043
Bond Position:  [-10.12581863]


portfolio before change:  [-1.7705242]
curr_Stock_Price:  99.7221231776961
curr_Factors:  [99.72212318]
mat_Sqrt:  [[0.15]]
grads:  [-0.0033914]
Stock Position:  -0.0033914026051584945
Bond Position:  [-1.43232633]


portfolio before change:  [-1.76960076]
curr_Stock_Price:  99.42343691299043
curr_Factors:  [99.42343691]
mat_Sqrt:  [[0.15]]
grads:  [-0.09151294]
Stock Position:  -0.09151294263978496
Bond Position:  [7.32893052]


portfolio before change:  [-1.74601979]
curr_Stock_Price:  99.17076343313013
curr_Factors:  [99.17076343]
mat_Sqrt:  [[0.15]]
grads:  [0.01712944]
Stock Position:  0.017129438243709227
Bond Position:  [-3.44475926]


portfolio before change:  [-1.73648903]
curr_Stock_Price:  99.73972955506322
curr_Factors:  [99.73972956]
mat_Sqrt:  [[0.15]]
grads:  [-0.0192136]
Stock Position:  -0.019213604393454962
Bond Position:  [0.17987068]


portfolio before change:  [-1.74485588]
curr_Stock_Price:  100.17577988570108
curr_Factors:  [100.17577989]
mat_Sqrt:  [[0.15]]
grads:  [0.04076782]
Stock Position:  0.04076782366587723
Bond Position:  [-5.82880441]


portfolio before change:  [-1.7458163]
curr_Stock_Price:  100.16115788534964
curr_Factors:  [100.16115789]
mat_Sqrt:  [[0.15]]
grads:  [-0.078745]
Stock Position:  -0.07874499514309136
Bond Position:  [6.14137359]


portfolio before change:  [-1.84377158]
curr_Stock_Price:  101.40998805607705
curr_Factors:  [101.40998806]
mat_Sqrt:  [[0.15]]
grads:  [0.00742853]
Stock Position:  0.007428527390821948
Bond Position:  [-2.59709845]


portfolio before change:  [-1.850112]
curr_Stock_Price:  100.57831666665803
curr_Factors:  [100.57831667]
mat_Sqrt:  [[0.15]]
grads:  [0.00321861]
Stock Position:  0.0032186073334497193
Bond Position:  [-2.1738341]


portfolio before change:  [-1.85236256]
curr_Stock_Price:  99.92129631207733
curr_Factors:  [99.92129631]
mat_Sqrt:  [[0.15]]
grads:  [-0.09128824]
Stock Position:  -0.09128824320106142
Bond Position:  [7.26927704]


portfolio before change:  [-1.77871933]
curr_Stock_Price:  99.11956235894102
curr_Factors:  [99.11956236]
mat_Sqrt:  [[0.15]]
grads:  [-0.01604519]
Stock Position:  -0.01604518681331856
Bond Position:  [-0.18832743]


portfolio before change:  [-1.76497114]
curr_Stock_Price:  98.26198668012886
curr_Factors:  [98.26198668]
mat_Sqrt:  [[0.15]]
grads:  [-0.04421972]
Stock Position:  -0.04421971909326354
Bond Position:  [2.58014631]


portfolio before change:  [-1.79372676]
curr_Stock_Price:  98.91592320373678
curr_Factors:  [98.9159232]
mat_Sqrt:  [[0.15]]
grads:  [0.06618226]
Stock Position:  0.06618225663943804
Bond Position:  [-8.34020578]


portfolio before change:  [-1.71580178]
curr_Stock_Price:  100.10122974035639
curr_Factors:  [100.10122974]
mat_Sqrt:  [[0.15]]
grads:  [-0.01989257]
Stock Position:  -0.01989256965003157
Bond Position:  [0.27546891]


portfolio before change:  [-1.73066692]
curr_Stock_Price:  100.84936627816887
curr_Factors:  [100.84936628]
mat_Sqrt:  [[0.15]]
grads:  [0.02535494]
Stock Position:  0.025354937679611486
Bond Position:  [-4.28769632]


portfolio before change:  [-1.72052721]
curr_Stock_Price:  101.25984658876074
curr_Factors:  [101.25984659]
mat_Sqrt:  [[0.15]]
grads:  [-0.0001008]
Stock Position:  -0.00010079914665295404
Bond Position:  [-1.7103203]


portfolio before change:  [-1.72065762]
curr_Stock_Price:  101.49311595596589
curr_Factors:  [101.49311596]
mat_Sqrt:  [[0.15]]
grads:  [0.00923888]
Stock Position:  0.00923887914579821
Bond Position:  [-2.65834025]


portfolio before change:  [-1.72366927]
curr_Stock_Price:  101.18512460048133
curr_Factors:  [101.1851246]
mat_Sqrt:  [[0.15]]
grads:  [0.01300754]
Stock Position:  0.013007539074570659
Bond Position:  [-3.03983873]


portfolio before change:  [-1.72930942]
curr_Stock_Price:  100.7661247073541
curr_Factors:  [100.76612471]
mat_Sqrt:  [[0.15]]
grads:  [0.0570874]
Stock Position:  0.05708739520455549
Bond Position:  [-7.481785]


portfolio before change:  [-1.70980707]
curr_Stock_Price:  101.11593874981365
curr_Factors:  [101.11593875]
mat_Sqrt:  [[0.15]]
grads:  [-0.02758829]
Stock Position:  -0.02758829048113781
Bond Position:  [1.07980882]


portfolio before change:  [-1.70917266]
curr_Stock_Price:  101.09538952294481
curr_Factors:  [101.09538952]
mat_Sqrt:  [[0.15]]
grads:  [-0.12636303]
Stock Position:  -0.12636303073704805
Bond Position:  [11.06554715]


portfolio before change:  [-1.79824204]
curr_Stock_Price:  101.80573171087096
curr_Factors:  [101.80573171]
mat_Sqrt:  [[0.15]]
grads:  [0.08925176]
Stock Position:  0.08925176162400467
Bond Position:  [-10.88458294]


portfolio before change:  [-1.81728463]
curr_Stock_Price:  101.59999587271726
curr_Factors:  [101.59999587]
mat_Sqrt:  [[0.15]]
grads:  [0.0342784]
Stock Position:  0.03427839812200461
Bond Position:  [-5.29996974]


portfolio before change:  [-1.82039848]
curr_Stock_Price:  101.51881958361898
curr_Factors:  [101.51881958]
mat_Sqrt:  [[0.15]]
grads:  [0.06642531]
Stock Position:  0.06642530758729764
Bond Position:  [-8.5638173]


portfolio before change:  [-1.75900298]
curr_Stock_Price:  102.45115630476393
curr_Factors:  [102.4511563]
mat_Sqrt:  [[0.15]]
grads:  [-0.09710809]
Stock Position:  -0.09710808518080874
Bond Position:  [8.18983263]


portfolio before change:  [-1.8140636]
curr_Stock_Price:  103.02343092126469
curr_Factors:  [103.02343092]
mat_Sqrt:  [[0.15]]
grads:  [-0.0849127]
Stock Position:  -0.08491269544974869
Bond Position:  [6.93393362]


portfolio before change:  [-1.71827789]
curr_Stock_Price:  101.90048546886533
curr_Factors:  [101.90048547]
mat_Sqrt:  [[0.15]]
grads:  [-0.01923017]
Stock Position:  -0.01923016935835248
Bond Position:  [0.24128571]


portfolio before change:  [-1.69659008]
curr_Stock_Price:  100.77346864366375
curr_Factors:  [100.77346864]
mat_Sqrt:  [[0.15]]
grads:  [-0.13437471]
Stock Position:  -0.13437470965066808
Bond Position:  [11.84481551]


portfolio before change:  [-1.74761431]
curr_Stock_Price:  101.15869406357477
curr_Factors:  [101.15869406]
mat_Sqrt:  [[0.15]]
grads:  [0.15007717]
Stock Position:  0.15007716577656174
Bond Position:  [-16.92922441]


portfolio before change:  [-1.83128093]
curr_Stock_Price:  100.60825385535945
curr_Factors:  [100.60825386]
mat_Sqrt:  [[0.15]]
grads:  [0.13239153]
Stock Position:  0.13239153431424766
Bond Position:  [-15.15096202]


portfolio before change:  [-1.82695183]
curr_Stock_Price:  100.64810578745937
curr_Factors:  [100.64810579]
mat_Sqrt:  [[0.15]]
grads:  [0.01466679]
Stock Position:  0.014666793685384455
Bond Position:  [-3.30313684]


portfolio before change:  [-1.82011564]
curr_Stock_Price:  101.12828199873819
curr_Factors:  [101.128282]
mat_Sqrt:  [[0.15]]
grads:  [0.04105361]
Stock Position:  0.041053606209580575
Bond Position:  [-5.97179631]


portfolio before change:  [-1.81120939]
curr_Stock_Price:  101.35431574213199
curr_Factors:  [101.35431574]
mat_Sqrt:  [[0.15]]
grads:  [-0.09057276]
Stock Position:  -0.09057276113813578
Bond Position:  [7.36873084]


portfolio before change:  [-1.84763871]
curr_Stock_Price:  101.76161122551663
curr_Factors:  [101.76161123]
mat_Sqrt:  [[0.15]]
grads:  [-0.05419329]
Stock Position:  -0.05419328921347419
Bond Position:  [3.66715772]


portfolio before change:  [-1.83886429]
curr_Stock_Price:  101.60393103529265
curr_Factors:  [101.60393104]
mat_Sqrt:  [[0.15]]
grads:  [-0.04095891]
Stock Position:  -0.04095891259575495
Bond Position:  [2.32272224]


portfolio before change:  [-1.8204219]
curr_Stock_Price:  101.15720973928434
curr_Factors:  [101.15720974]
mat_Sqrt:  [[0.15]]
grads:  [0.01507976]
Stock Position:  0.015079756737636063
Bond Position:  [-3.34584801]


portfolio before change:  [-1.82578506]
curr_Stock_Price:  100.8154245872042
curr_Factors:  [100.81542459]
mat_Sqrt:  [[0.15]]
grads:  [0.05725354]
Stock Position:  0.05725354090587463
Bond Position:  [-7.59782509]


portfolio before change:  [-1.85127666]
curr_Stock_Price:  100.37847826033747
curr_Factors:  [100.37847826]
mat_Sqrt:  [[0.15]]
grads:  [0.06972935]
Stock Position:  0.06972934684662256
Bond Position:  [-8.85060239]


portfolio before change:  [-1.81919999]
curr_Stock_Price:  100.84642826313974
curr_Factors:  [100.84642826]
mat_Sqrt:  [[0.15]]
grads:  [-0.06266529]
Stock Position:  -0.06266528547523273
Bond Position:  [4.50037022]


portfolio before change:  [-1.80055212]
curr_Stock_Price:  100.5533378227206
curr_Factors:  [100.55333782]
mat_Sqrt:  [[0.15]]
grads:  [-0.00285979]
Stock Position:  -0.002859789662682186
Bond Position:  [-1.51299072]


portfolio before change:  [-1.80164933]
curr_Stock_Price:  100.90394073194037
curr_Factors:  [100.90394073]
mat_Sqrt:  [[0.15]]
grads:  [-0.05448379]
Stock Position:  -0.05448379449701515
Bond Position:  [3.69598024]


portfolio before change:  [-1.78382827]
curr_Stock_Price:  100.58109136385896
curr_Factors:  [100.58109136]
mat_Sqrt:  [[0.15]]
grads:  [0.03878552]
Stock Position:  0.03878551732957943
Bond Position:  [-5.68491793]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.78382827]
Stock Price:  101.73610301540745
PL:  [-3.51993128]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.88489906e-02]
 [-1.01032312e-03]
 [ 7.23600681e-04]
 [ 2.15603049e-03]
 [ 1.73260473e-02]
 [ 1.11088391e-02]
 [ 6.74227397e-04]
 [ 9.17234811e-03]
 [-8.13775630e-03]
 [-2.00299747e-02]
 [ 1.00000234e-02]
 [-8.04864809e-03]
 [ 2.14958366e-02]
 [ 5.21560390e-03]
 [-5.59857778e-05]
 [-1.00507478e-02]
 [ 8.07256538e-03]
 [ 2.50479966e-02]
 [ 1.62773913e-02]
 [-4.19666312e-03]
 [ 2.07711301e-02]
 [-9.85353706e-03]
 [-6.40170185e-03]
 [ 7.86657185e-03]
 [ 1.94251056e-02]
 [ 1.38514846e-02]
 [ 7.19389252e-03]
 [ 7.21028342e-03]
 [ 1.00337468e-02]
 [-9.03508638e-03]
 [-5.83381781e-03]
 [ 4.37096468e-02]
 [ 2.65446302e-03]
 [-1.02268882e-02]
 [-5.38429852e-03]
 [-4.36935952e-03]
 [-4.62055372e-03]
 [ 3.59725382e-03]
 [ 2.83078915e-03]
 [-7.84046388e-03]
 [-4.05773766e-02]
 [-3.78870144e-03]
 [ 1.49920458e-02]
 [-1.30648135e-02]
 [-5.46263085e-03]
 [ 2.89482172e-03]
 [-1.35888464e-02]
 [ 1.03830434e-02]
 [ 9.05299240e-03]
 [-8.72344269e-03]
 [-3.63503537e-03]
 [ 3.58938380e-03]
 [ 7.25153639e-04]
 [ 2.81969648e-03]
 [-4.16192398e-03]
 [ 9.08130999e-03]
 [-8.91970446e-03]
 [-1.25862449e-02]
 [ 1.51396549e-02]
 [ 1.20668099e-03]
 [ 1.18514062e-02]
 [-1.47887129e-02]
 [-1.26772447e-02]
 [-3.00043222e-03]
 [-1.75604422e-02]
 [-2.82830090e-03]
 [ 2.93135389e-02]
 [ 2.71900215e-03]
 [ 6.69938142e-03]
 [-1.41551028e-02]
 [-8.02452759e-03]
 [-7.80007280e-03]
 [ 1.72680638e-03]
 [ 7.59104432e-03]
 [ 4.45100336e-03]
 [-1.16491189e-02]
 [ 4.69164265e-04]
 [-8.52443768e-03]
 [-3.25077328e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.17371232]
curr_Stock_Price:  99.34185817804718
curr_Factors:  [99.34185818]
mat_Sqrt:  [[0.15]]
grads:  [-0.25899327]
Stock Position:  -0.2589932705042114
Bond Position:  [17.55516042]


portfolio before change:  [-8.30181542]
curr_Stock_Price:  99.84071410675695
curr_Factors:  [99.84071411]
mat_Sqrt:  [[0.15]]
grads:  [-0.00673549]
Stock Position:  -0.006735487452292566
Bond Position:  [-7.62933954]


portfolio before change:  [-8.302778]
curr_Stock_Price:  99.91282893109067
curr_Factors:  [99.91282893]
mat_Sqrt:  [[0.15]]
grads:  [0.004824]
Stock Position:  0.004824004541686185
Bond Position:  [-8.78475794]


portfolio before change:  [-8.30322981]
curr_Stock_Price:  99.93298826015666
curr_Factors:  [99.93298826]
mat_Sqrt:  [[0.15]]
grads:  [0.01437354]
Stock Position:  0.014373536617054861
Bond Position:  [-9.73962028]


portfolio before change:  [-8.30161384]
curr_Stock_Price:  100.08776717790789
curr_Factors:  [100.08776718]
mat_Sqrt:  [[0.15]]
grads:  [0.11550698]
Stock Position:  0.1155069822407101
Bond Position:  [-19.86244978]


portfolio before change:  [-8.36136884]
curr_Stock_Price:  99.58118689960523
curr_Factors:  [99.5811869]
mat_Sqrt:  [[0.15]]
grads:  [0.07405893]
Stock Position:  0.07405892723987026
Bond Position:  [-15.73624471]


portfolio before change:  [-8.26719136]
curr_Stock_Price:  100.86612352880609
curr_Factors:  [100.86612353]
mat_Sqrt:  [[0.15]]
grads:  [0.00449485]
Stock Position:  0.00449484931560928
Bond Position:  [-8.72056938]


portfolio before change:  [-8.26817535]
curr_Stock_Price:  100.76846844118873
curr_Factors:  [100.76846844]
mat_Sqrt:  [[0.15]]
grads:  [0.06114899]
Stock Position:  0.06114898742532539
Bond Position:  [-14.43006516]


portfolio before change:  [-8.21337095]
curr_Stock_Price:  101.67946162614588
curr_Factors:  [101.67946163]
mat_Sqrt:  [[0.15]]
grads:  [-0.05425171]
Stock Position:  -0.054251708637989
Bond Position:  [-2.69708642]


portfolio before change:  [-8.18005159]
curr_Stock_Price:  101.06219190638345
curr_Factors:  [101.06219191]
mat_Sqrt:  [[0.15]]
grads:  [-0.13353316]
Stock Position:  -0.13353316470673243
Bond Position:  [5.31510273]


portfolio before change:  [-8.28489568]
curr_Stock_Price:  101.84983366116829
curr_Factors:  [101.84983366]
mat_Sqrt:  [[0.15]]
grads:  [0.06666682]
Stock Position:  0.06666682290707986
Bond Position:  [-15.0749005]


portfolio before change:  [-8.31889047]
curr_Stock_Price:  101.35404603228105
curr_Factors:  [101.35404603]
mat_Sqrt:  [[0.15]]
grads:  [-0.05365765]
Stock Position:  -0.053657653925192096
Bond Position:  [-2.88047015]


portfolio before change:  [-8.36093037]
curr_Stock_Price:  102.13417439166689
curr_Factors:  [102.13417439]
mat_Sqrt:  [[0.15]]
grads:  [0.14330558]
Stock Position:  0.1433055775729462
Bond Position:  [-22.99732722]


portfolio before change:  [-8.41405332]
curr_Stock_Price:  101.77350752659449
curr_Factors:  [101.77350753]
mat_Sqrt:  [[0.15]]
grads:  [0.03477069]
Stock Position:  0.0347706926476618
Bond Position:  [-11.95278867]


portfolio before change:  [-8.41669253]
curr_Stock_Price:  101.71908983797327
curr_Factors:  [101.71908984]
mat_Sqrt:  [[0.15]]
grads:  [-0.00037324]
Stock Position:  -0.0003732385183595824
Bond Position:  [-8.37872705]


portfolio before change:  [-8.41740107]
curr_Stock_Price:  102.21436221111534
curr_Factors:  [102.21436221]
mat_Sqrt:  [[0.15]]
grads:  [-0.06700499]
Stock Position:  -0.06700498551327466
Bond Position:  [-1.56852921]


portfolio before change:  [-8.41018698]
curr_Stock_Price:  102.1052340361287
curr_Factors:  [102.10523404]
mat_Sqrt:  [[0.15]]
grads:  [0.0538171]
Stock Position:  0.05381710255267275
Bond Position:  [-13.90519483]


portfolio before change:  [-8.41681043]
curr_Stock_Price:  101.99830985470933
curr_Factors:  [101.99830985]
mat_Sqrt:  [[0.15]]
grads:  [0.16698664]
Stock Position:  0.16698664422612877
Bond Position:  [-25.44916591]


portfolio before change:  [-8.36660693]
curr_Stock_Price:  102.30847911113814
curr_Factors:  [102.30847911]
mat_Sqrt:  [[0.15]]
grads:  [0.10851594]
Stock Position:  0.10851594206527626
Bond Position:  [-19.46870792]


portfolio before change:  [-8.1718187]
curr_Stock_Price:  104.11471200596549
curr_Factors:  [104.11471201]
mat_Sqrt:  [[0.15]]
grads:  [-0.02797775]
Stock Position:  -0.027977754100608106
Bond Position:  [-5.25892289]


portfolio before change:  [-8.15710195]
curr_Stock_Price:  103.57694755823643
curr_Factors:  [103.57694756]
mat_Sqrt:  [[0.15]]
grads:  [0.1384742]
Stock Position:  0.13847420052556983
Bond Position:  [-22.49983695]


portfolio before change:  [-8.09382938]
curr_Stock_Price:  104.04402990585447
curr_Factors:  [104.04402991]
mat_Sqrt:  [[0.15]]
grads:  [-0.06569025]
Stock Position:  -0.06569024705088158
Bond Position:  [-1.25915135]


portfolio before change:  [-8.12390594]
curr_Stock_Price:  104.5006862141662
curr_Factors:  [104.50068621]
mat_Sqrt:  [[0.15]]
grads:  [-0.04267801]
Stock Position:  -0.04267801234887472
Bond Position:  [-3.66402437]


portfolio before change:  [-8.15291689]
curr_Stock_Price:  105.17508351080541
curr_Factors:  [105.17508351]
mat_Sqrt:  [[0.15]]
grads:  [0.05244381]
Stock Position:  0.05244381230034239
Bond Position:  [-13.66869923]


portfolio before change:  [-8.14834734]
curr_Stock_Price:  105.2785060368318
curr_Factors:  [105.27850604]
mat_Sqrt:  [[0.15]]
grads:  [0.1295007]
Stock Position:  0.12950070367877328
Bond Position:  [-21.78198795]


portfolio before change:  [-8.22155998]
curr_Stock_Price:  104.7236733254945
curr_Factors:  [104.72367333]
mat_Sqrt:  [[0.15]]
grads:  [0.09234323]
Stock Position:  0.09234323037649687
Bond Position:  [-17.89208227]


portfolio before change:  [-8.2494569]
curr_Stock_Price:  104.4336831130539
curr_Factors:  [104.43368311]
mat_Sqrt:  [[0.15]]
grads:  [0.04795928]
Stock Position:  0.047959283481893496
Bond Position:  [-13.25802152]


portfolio before change:  [-8.21848844]
curr_Stock_Price:  105.09668531202873
curr_Factors:  [105.09668531]
mat_Sqrt:  [[0.15]]
grads:  [0.04806856]
Stock Position:  0.04806855614808682
Bond Position:  [-13.27033436]


portfolio before change:  [-8.20909186]
curr_Stock_Price:  105.3094233672146
curr_Factors:  [105.30942337]
mat_Sqrt:  [[0.15]]
grads:  [0.06689165]
Stock Position:  0.06689164529783664
Bond Position:  [-15.25341245]


portfolio before change:  [-8.22684787]
curr_Stock_Price:  105.05823128619629
curr_Factors:  [105.05823129]
mat_Sqrt:  [[0.15]]
grads:  [-0.06023391]
Stock Position:  -0.06023390917743315
Bond Position:  [-1.89877991]


portfolio before change:  [-8.25586256]
curr_Stock_Price:  105.53796113459723
curr_Factors:  [105.53796113]
mat_Sqrt:  [[0.15]]
grads:  [-0.03889212]
Stock Position:  -0.03889211870770902
Bond Position:  [-4.15126764]


portfolio before change:  [-8.23309552]
curr_Stock_Price:  104.94590021413728
curr_Factors:  [104.94590021]
mat_Sqrt:  [[0.15]]
grads:  [0.29139765]
Stock Position:  0.29139764508263927
Bond Position:  [-38.8140837]


portfolio before change:  [-8.1189414]
curr_Stock_Price:  105.34597232185294
curr_Factors:  [105.34597232]
mat_Sqrt:  [[0.15]]
grads:  [0.01769642]
Stock Position:  0.017696420133905627
Bond Position:  [-9.98318799]


portfolio before change:  [-8.11344784]
curr_Stock_Price:  105.69166514945888
curr_Factors:  [105.69166515]
mat_Sqrt:  [[0.15]]
grads:  [-0.06817925]
Stock Position:  -0.06817925443562245
Bond Position:  [-0.90746891]


portfolio before change:  [-8.01602696]
curr_Stock_Price:  104.26193990761679
curr_Factors:  [104.26193991]
mat_Sqrt:  [[0.15]]
grads:  [-0.03589532]
Stock Position:  -0.035895323459001774
Bond Position:  [-4.2735109]


portfolio before change:  [-7.99594254]
curr_Stock_Price:  103.6949710965149
curr_Factors:  [103.6949711]
mat_Sqrt:  [[0.15]]
grads:  [-0.02912906]
Stock Position:  -0.029129063441882062
Bond Position:  [-4.97540514]


portfolio before change:  [-7.99415845]
curr_Stock_Price:  103.6230478477646
curr_Factors:  [103.62304785]
mat_Sqrt:  [[0.15]]
grads:  [-0.03080369]
Stock Position:  -0.030803691479462884
Bond Position:  [-4.80218606]


portfolio before change:  [-7.96702578]
curr_Stock_Price:  102.7324788336143
curr_Factors:  [102.73247883]
mat_Sqrt:  [[0.15]]
grads:  [0.02398169]
Stock Position:  0.023981692139176954
Bond Position:  [-10.43072446]


portfolio before change:  [-7.95935551]
curr_Stock_Price:  103.07950240144817
curr_Factors:  [103.0795024]
mat_Sqrt:  [[0.15]]
grads:  [0.01887193]
Stock Position:  0.018871927673209724
Bond Position:  [-9.90466443]


portfolio before change:  [-7.95533848]
curr_Stock_Price:  103.32516347225881
curr_Factors:  [103.32516347]
mat_Sqrt:  [[0.15]]
grads:  [-0.05226976]
Stock Position:  -0.05226975918293665
Bond Position:  [-2.55455706]


portfolio before change:  [-7.9602013]
curr_Stock_Price:  103.4151420168277
curr_Factors:  [103.41514202]
mat_Sqrt:  [[0.15]]
grads:  [-0.27051584]
Stock Position:  -0.2705158440645974
Bond Position:  [20.01523313]


portfolio before change:  [-8.13460573]
curr_Stock_Price:  104.06447709201777
curr_Factors:  [104.06447709]
mat_Sqrt:  [[0.15]]
grads:  [-0.02525801]
Stock Position:  -0.025258009594593563
Bond Position:  [-5.50614417]


portfolio before change:  [-8.13287731]
curr_Stock_Price:  103.98242127829096
curr_Factors:  [103.98242128]
mat_Sqrt:  [[0.15]]
grads:  [0.09994697]
Stock Position:  0.09994697232841528
Bond Position:  [-18.52560549]


portfolio before change:  [-8.1669297]
curr_Stock_Price:  103.65330167943254
curr_Factors:  [103.65330168]
mat_Sqrt:  [[0.15]]
grads:  [-0.08709876]
Stock Position:  -0.08709875644837632
Bond Position:  [0.86114397]


portfolio before change:  [-8.30131678]
curr_Stock_Price:  105.1968472347325
curr_Factors:  [105.19684723]
mat_Sqrt:  [[0.15]]
grads:  [-0.03641754]
Stock Position:  -0.0364175389874409
Bond Position:  [-4.47030649]


portfolio before change:  [-8.3024712]
curr_Stock_Price:  105.22087447517508
curr_Factors:  [105.22087448]
mat_Sqrt:  [[0.15]]
grads:  [0.01929881]
Stock Position:  0.019298811491628456
Bond Position:  [-10.33310902]


portfolio before change:  [-8.31670642]
curr_Stock_Price:  104.51671813891413
curr_Factors:  [104.51671814]
mat_Sqrt:  [[0.15]]
grads:  [-0.09059231]
Stock Position:  -0.09059230907354253
Bond Position:  [1.15170442]


portfolio before change:  [-8.29458464]
curr_Stock_Price:  104.27332233745702
curr_Factors:  [104.27332234]
mat_Sqrt:  [[0.15]]
grads:  [0.06922029]
Stock Position:  0.06922028925562004
Bond Position:  [-15.51241418]


portfolio before change:  [-8.34195329]
curr_Stock_Price:  103.60301176354201
curr_Factors:  [103.60301176]
mat_Sqrt:  [[0.15]]
grads:  [0.06035328]
Stock Position:  0.06035328269724997
Bond Position:  [-14.59473515]


portfolio before change:  [-8.36026408]
curr_Stock_Price:  103.31473273990824
curr_Factors:  [103.31473274]
mat_Sqrt:  [[0.15]]
grads:  [-0.05815628]
Stock Position:  -0.05815628460024787
Bond Position:  [-2.35186308]


portfolio before change:  [-8.36072738]
curr_Stock_Price:  103.3201717243741
curr_Factors:  [103.32017172]
mat_Sqrt:  [[0.15]]
grads:  [-0.02423357]
Stock Position:  -0.02423356914173856
Bond Position:  [-5.85691086]


portfolio before change:  [-8.3392754]
curr_Stock_Price:  102.4198480656209
curr_Factors:  [102.41984807]
mat_Sqrt:  [[0.15]]
grads:  [0.02392923]
Stock Position:  0.023929225306716474
Bond Position:  [-10.79010302]


portfolio before change:  [-8.34487274]
curr_Stock_Price:  102.2141188698706
curr_Factors:  [102.21411887]
mat_Sqrt:  [[0.15]]
grads:  [0.00483436]
Stock Position:  0.004834357590414945
Bond Position:  [-8.83901234]


portfolio before change:  [-8.3457692]
curr_Stock_Price:  102.1429604451814
curr_Factors:  [102.14296045]
mat_Sqrt:  [[0.15]]
grads:  [0.01879798]
Stock Position:  0.01879797651119585
Bond Position:  [-10.26585017]


portfolio before change:  [-8.32944848]
curr_Stock_Price:  103.04531027551882
curr_Factors:  [103.04531028]
mat_Sqrt:  [[0.15]]
grads:  [-0.02774616]
Stock Position:  -0.02774615989143322
Bond Position:  [-5.47033683]


portfolio before change:  [-8.3246923]
curr_Stock_Price:  102.8615698500473
curr_Factors:  [102.86156985]
mat_Sqrt:  [[0.15]]
grads:  [0.06054207]
Stock Position:  0.0605420666047609
Bond Position:  [-14.55214431]


portfolio before change:  [-8.36192446]
curr_Stock_Price:  102.26161306827653
curr_Factors:  [102.26161307]
mat_Sqrt:  [[0.15]]
grads:  [-0.0594647]
Stock Position:  -0.05946469642861241
Bond Position:  [-2.28096868]


portfolio before change:  [-8.38581081]
curr_Stock_Price:  102.66090510618953
curr_Factors:  [102.66090511]
mat_Sqrt:  [[0.15]]
grads:  [-0.0839083]
Stock Position:  -0.08390829932293771
Bond Position:  [0.22829115]


portfolio before change:  [-8.43236116]
curr_Stock_Price:  103.21585168753184
curr_Factors:  [103.21585169]
mat_Sqrt:  [[0.15]]
grads:  [0.10093103]
Stock Position:  0.10093103289773585
Bond Position:  [-18.85004368]


portfolio before change:  [-8.42550898]
curr_Stock_Price:  103.29541434403019
curr_Factors:  [103.29541434]
mat_Sqrt:  [[0.15]]
grads:  [0.00804454]
Stock Position:  0.008044539960903438
Bond Position:  [-9.25647307]


portfolio before change:  [-8.42817645]
curr_Stock_Price:  103.0357458692959
curr_Factors:  [103.03574587]
mat_Sqrt:  [[0.15]]
grads:  [0.07900937]
Stock Position:  0.07900937487479294
Bond Position:  [-16.56896632]


portfolio before change:  [-8.46331764]
curr_Stock_Price:  102.60408059025835
curr_Factors:  [102.60408059]
mat_Sqrt:  [[0.15]]
grads:  [-0.09859142]
Stock Position:  -0.09859141912317756
Bond Position:  [1.65256427]


portfolio before change:  [-8.41571861]
curr_Stock_Price:  102.12233740555348
curr_Factors:  [102.12233741]
mat_Sqrt:  [[0.15]]
grads:  [-0.08451496]
Stock Position:  -0.08451496438303602
Bond Position:  [0.2151471]


portfolio before change:  [-8.42436393]
curr_Stock_Price:  102.22478992817933
curr_Factors:  [102.22478993]
mat_Sqrt:  [[0.15]]
grads:  [-0.02000288]
Stock Position:  -0.02000288149189639
Bond Position:  [-6.37957358]


portfolio before change:  [-8.4105186]
curr_Stock_Price:  101.51268926301965
curr_Factors:  [101.51268926]
mat_Sqrt:  [[0.15]]
grads:  [-0.11706961]
Stock Position:  -0.11706961452721147
Bond Position:  [3.4735328]


portfolio before change:  [-8.49583915]
curr_Stock_Price:  102.24334549961978
curr_Factors:  [102.2433455]
mat_Sqrt:  [[0.15]]
grads:  [-0.01885534]
Stock Position:  -0.018855339365953305
Bond Position:  [-6.56800617]


portfolio before change:  [-8.49519738]
curr_Stock_Price:  102.1875376759918
curr_Factors:  [102.18753768]
mat_Sqrt:  [[0.15]]
grads:  [0.19542359]
Stock Position:  0.19542359278373836
Bond Position:  [-28.46505313]


portfolio before change:  [-8.36570015]
curr_Stock_Price:  102.85929053707531
curr_Factors:  [102.85929054]
mat_Sqrt:  [[0.15]]
grads:  [0.01812668]
Stock Position:  0.018126680983572483
Bond Position:  [-10.23019769]


portfolio before change:  [-8.38056287]
curr_Stock_Price:  102.0746285211131
curr_Factors:  [102.07462852]
mat_Sqrt:  [[0.15]]
grads:  [0.04466254]
Stock Position:  0.04466254282904393
Bond Position:  [-12.93947534]


portfolio before change:  [-8.37813141]
curr_Stock_Price:  102.14717717959209
curr_Factors:  [102.14717718]
mat_Sqrt:  [[0.15]]
grads:  [-0.09436735]
Stock Position:  -0.0943673522843931
Bond Position:  [1.26122725]


portfolio before change:  [-8.35769769]
curr_Stock_Price:  101.93147878069635
curr_Factors:  [101.93147878]
mat_Sqrt:  [[0.15]]
grads:  [-0.05349685]
Stock Position:  -0.053496850606501195
Bond Position:  [-2.9046846]


portfolio before change:  [-8.36691483]
curr_Stock_Price:  102.10037816467131
curr_Factors:  [102.10037816]
mat_Sqrt:  [[0.15]]
grads:  [-0.05200049]
Stock Position:  -0.05200048535979365
Bond Position:  [-3.05764561]


portfolio before change:  [-8.36150788]
curr_Stock_Price:  101.99272426920056
curr_Factors:  [101.99272427]
mat_Sqrt:  [[0.15]]
grads:  [0.01151204]
Stock Position:  0.011512042554228876
Bond Position:  [-9.53565246]


portfolio before change:  [-8.35244133]
curr_Stock_Price:  102.83206639591019
curr_Factors:  [102.8320664]
mat_Sqrt:  [[0.15]]
grads:  [0.05060696]
Stock Position:  0.050606962123071426
Bond Position:  [-13.55645982]


portfolio before change:  [-8.41483211]
curr_Stock_Price:  101.6159596667258
curr_Factors:  [101.61595967]
mat_Sqrt:  [[0.15]]
grads:  [0.02967336]
Stock Position:  0.029673355733361176
Bond Position:  [-11.43011863]


portfolio before change:  [-8.41136032]
curr_Stock_Price:  101.7570355811547
curr_Factors:  [101.75703558]
mat_Sqrt:  [[0.15]]
grads:  [-0.07766079]
Stock Position:  -0.0776607928816592
Bond Position:  [-0.50882825]


portfolio before change:  [-8.34061052]
curr_Stock_Price:  100.84561554526113
curr_Factors:  [100.84561555]
mat_Sqrt:  [[0.15]]
grads:  [0.00312776]
Stock Position:  0.003127761767204827
Bond Position:  [-8.65603158]


portfolio before change:  [-8.34292317]
curr_Stock_Price:  100.27919375408885
curr_Factors:  [100.27919375]
mat_Sqrt:  [[0.15]]
grads:  [-0.05682958]
Stock Position:  -0.056829584533550914
Bond Position:  [-2.64409825]


portfolio before change:  [-8.31567893]
curr_Stock_Price:  99.79688329771028
curr_Factors:  [99.7968833]
mat_Sqrt:  [[0.15]]
grads:  [-0.00216718]
Stock Position:  -0.002167182188576265
Bond Position:  [-8.0994009]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.31567893]
Stock Price:  99.88213801707704
PL:  [-8.31567893]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.44120407e-02]
 [-1.51465474e-03]
 [ 7.25701508e-04]
 [-7.92655390e-04]
 [-1.38548283e-02]
 [ 7.56134810e-03]
 [ 7.67419351e-04]
 [ 1.59298071e-02]
 [ 1.73098647e-02]
 [-2.02967868e-02]
 [ 1.00661821e-02]
 [-8.99370349e-03]
 [ 1.50667254e-02]
 [ 4.02322775e-03]
 [ 2.19343836e-03]
 [-8.34788727e-03]
 [ 1.41188980e-02]
 [ 1.50893554e-02]
 [ 2.15188842e-02]
 [ 1.03694830e-02]
 [ 5.53784850e-02]
 [-1.68119549e-02]
 [-2.73632284e-03]
 [ 1.25897629e-02]
 [ 9.33064553e-03]
 [ 6.84610403e-03]
 [ 1.40234399e-02]
 [-1.54724916e-02]
 [ 2.28642677e-03]
 [-9.95901503e-03]
 [-3.67034045e-03]
 [-2.60996764e-03]
 [ 1.47594374e-02]
 [ 1.96000410e-02]
 [ 3.34835158e-03]
 [-4.19020871e-03]
 [-6.95332011e-03]
 [ 9.84143823e-03]
 [ 6.61665603e-04]
 [-8.48418709e-03]
 [-2.98669473e-02]
 [-2.53606954e-03]
 [ 9.32771729e-03]
 [-1.36833328e-02]
 [-1.56702680e-04]
 [ 2.25150455e-03]
 [-1.36487891e-02]
 [-3.53571867e-03]
 [-6.33614023e-04]
 [-1.37414964e-03]
 [-3.03188100e-03]
 [ 3.74847850e-03]
 [ 4.55640385e-04]
 [-1.26915040e-03]
 [ 2.01577893e-03]
 [ 9.02053236e-03]
 [ 1.55951128e-02]
 [-1.92798132e-02]
 [ 1.38130161e-02]
 [ 3.34973778e-03]
 [ 4.26599261e-03]
 [-1.50959338e-02]
 [-1.25499023e-02]
 [-1.49790701e-03]
 [-1.19603114e-02]
 [-1.17013878e-02]
 [ 1.11182649e-02]
 [ 2.00110994e-03]
 [ 6.47332473e-03]
 [-1.45591188e-02]
 [-6.02542068e-03]
 [-1.12989526e-03]
 [ 1.80362831e-03]
 [ 8.77130393e-03]
 [ 1.09987255e-02]
 [-6.78630674e-03]
 [-9.30094676e-04]
 [-8.49009222e-03]
 [ 9.95554381e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.99529043]
curr_Stock_Price:  99.80322008773042
curr_Factors:  [99.80322009]
mat_Sqrt:  [[0.15]]
grads:  [-0.2294136]
Stock Position:  -0.22941360483680145
Bond Position:  [21.90092606]


portfolio before change:  [-1.0135585]
curr_Stock_Price:  99.88881623771314
curr_Factors:  [99.88881624]
mat_Sqrt:  [[0.15]]
grads:  [-0.0100977]
Stock Position:  -0.010097698242406701
Bond Position:  [-0.00491138]


portfolio before change:  [-1.01379014]
curr_Stock_Price:  99.91172523199864
curr_Factors:  [99.91172523]
mat_Sqrt:  [[0.15]]
grads:  [0.00483801]
Stock Position:  0.004838010050025784
Bond Position:  [-1.49716407]


portfolio before change:  [-1.01917814]
curr_Stock_Price:  98.81738493643981
curr_Factors:  [98.81738494]
mat_Sqrt:  [[0.15]]
grads:  [-0.00528437]
Stock Position:  -0.005284369263656528
Bond Position:  [-0.49699059]


portfolio before change:  [-1.01914997]
curr_Stock_Price:  98.8061757435164
curr_Factors:  [98.80617574]
mat_Sqrt:  [[0.15]]
grads:  [-0.09236552]
Stock Position:  -0.09236552230530677
Bond Position:  [8.10713406]


portfolio before change:  [-1.02686943]
curr_Stock_Price:  98.8952367357264
curr_Factors:  [98.89523674]
mat_Sqrt:  [[0.15]]
grads:  [0.05040899]
Stock Position:  0.05040898730515287
Bond Position:  [-6.01207816]


portfolio before change:  [-1.0468698]
curr_Stock_Price:  98.5059290446435
curr_Factors:  [98.50592904]
mat_Sqrt:  [[0.15]]
grads:  [0.00511613]
Stock Position:  0.005116129006539537
Bond Position:  [-1.55083884]


portfolio before change:  [-1.04327317]
curr_Stock_Price:  99.22787386801414
curr_Factors:  [99.22787387]
mat_Sqrt:  [[0.15]]
grads:  [0.10619871]
Stock Position:  0.10619871371578693
Bond Position:  [-11.58114574]


portfolio before change:  [-1.00832045]
curr_Stock_Price:  99.5638153914044
curr_Factors:  [99.56381539]
mat_Sqrt:  [[0.15]]
grads:  [0.1153991]
Stock Position:  0.11539909792107148
Bond Position:  [-12.49789494]


portfolio before change:  [-0.8949727]
curr_Stock_Price:  100.55280839023702
curr_Factors:  [100.55280839]
mat_Sqrt:  [[0.15]]
grads:  [-0.13531191]
Stock Position:  -0.1353119117153896
Bond Position:  [12.71102003]


portfolio before change:  [-1.0267253]
curr_Stock_Price:  101.53237526924029
curr_Factors:  [101.53237527]
mat_Sqrt:  [[0.15]]
grads:  [0.06710788]
Stock Position:  0.0671078809286163
Bond Position:  [-7.84034785]


portfolio before change:  [-1.01572712]
curr_Stock_Price:  101.70356550927141
curr_Factors:  [101.70356551]
mat_Sqrt:  [[0.15]]
grads:  [-0.05995802]
Stock Position:  -0.05995802324098076
Bond Position:  [5.08221762]


portfolio before change:  [-1.01046579]
curr_Stock_Price:  101.62111305618254
curr_Factors:  [101.62111306]
mat_Sqrt:  [[0.15]]
grads:  [0.10044484]
Stock Position:  0.10044483633265681
Bond Position:  [-11.21778186]


portfolio before change:  [-1.02481246]
curr_Stock_Price:  101.48526204307475
curr_Factors:  [101.48526204]
mat_Sqrt:  [[0.15]]
grads:  [0.02682152]
Stock Position:  0.026821518351187793
Bond Position:  [-3.74680127]


portfolio before change:  [-1.02864868]
curr_Stock_Price:  101.35096516929704
curr_Factors:  [101.35096517]
mat_Sqrt:  [[0.15]]
grads:  [0.01462292]
Stock Position:  0.014622922366770118
Bond Position:  [-2.51069598]


portfolio before change:  [-1.03733256]
curr_Stock_Price:  100.76784260724884
curr_Factors:  [100.76784261]
mat_Sqrt:  [[0.15]]
grads:  [-0.05565258]
Stock Position:  -0.055652581796040566
Bond Position:  [4.57065804]


portfolio before change:  [-1.0539786]
curr_Stock_Price:  101.0720820049679
curr_Factors:  [101.072082]
mat_Sqrt:  [[0.15]]
grads:  [0.09412599]
Stock Position:  0.09412598693202781
Bond Position:  [-10.56748807]


portfolio before change:  [-1.08785968]
curr_Stock_Price:  100.71914443926963
curr_Factors:  [100.71914444]
mat_Sqrt:  [[0.15]]
grads:  [0.1005957]
Stock Position:  0.10059570298670457
Bond Position:  [-11.21977282]


portfolio before change:  [-1.15183214]
curr_Stock_Price:  100.09017921348438
curr_Factors:  [100.09017921]
mat_Sqrt:  [[0.15]]
grads:  [0.14345923]
Stock Position:  0.14345922827130442
Bond Position:  [-15.51069201]


portfolio before change:  [-1.23993078]
curr_Stock_Price:  99.48283458115156
curr_Factors:  [99.48283458]
mat_Sqrt:  [[0.15]]
grads:  [0.06912989]
Stock Position:  0.06912988675840803
Bond Position:  [-8.11716787]


portfolio before change:  [-1.2518752]
curr_Stock_Price:  99.31739118983927
curr_Factors:  [99.31739119]
mat_Sqrt:  [[0.15]]
grads:  [0.3691899]
Stock Position:  0.3691899000429901
Bond Position:  [-37.91885293]


portfolio before change:  [-1.29183232]
curr_Stock_Price:  99.21558148745153
curr_Factors:  [99.21558149]
mat_Sqrt:  [[0.15]]
grads:  [-0.1120797]
Stock Position:  -0.11207969926394099
Bond Position:  [9.82822022]


portfolio before change:  [-1.37041226]
curr_Stock_Price:  99.9221700080767
curr_Factors:  [99.92217001]
mat_Sqrt:  [[0.15]]
grads:  [-0.01824215]
Stock Position:  -0.018242152250251373
Bond Position:  [0.45238318]


portfolio before change:  [-1.36774067]
curr_Stock_Price:  99.77726816667634
curr_Factors:  [99.77726817]
mat_Sqrt:  [[0.15]]
grads:  [0.08393175]
Stock Position:  0.0839317525194281
Bond Position:  [-9.74222165]


portfolio before change:  [-1.40313799]
curr_Stock_Price:  99.36278364276329
curr_Factors:  [99.36278364]
mat_Sqrt:  [[0.15]]
grads:  [0.0622043]
Stock Position:  0.06220430351754036
Bond Position:  [-7.58393074]


portfolio before change:  [-1.45120956]
curr_Stock_Price:  98.59760244564319
curr_Factors:  [98.59760245]
mat_Sqrt:  [[0.15]]
grads:  [0.04564069]
Stock Position:  0.04564069356546657
Bond Position:  [-5.95127252]


portfolio before change:  [-1.47760589]
curr_Stock_Price:  98.02740161291491
curr_Factors:  [98.02740161]
mat_Sqrt:  [[0.15]]
grads:  [0.0934896]
Stock Position:  0.09348959965171655
Bond Position:  [-10.64214842]


portfolio before change:  [-1.43550824]
curr_Stock_Price:  98.48480873124356
curr_Factors:  [98.48480873]
mat_Sqrt:  [[0.15]]
grads:  [-0.10314994]
Stock Position:  -0.10314994407805407
Bond Position:  [8.72319428]


portfolio before change:  [-1.49198824]
curr_Stock_Price:  99.03764681291457
curr_Factors:  [99.03764681]
mat_Sqrt:  [[0.15]]
grads:  [0.01524285]
Stock Position:  0.015242845141350473
Bond Position:  [-3.00160375]


portfolio before change:  [-1.49940137]
curr_Stock_Price:  98.56361910249026
curr_Factors:  [98.5636191]
mat_Sqrt:  [[0.15]]
grads:  [-0.06639343]
Stock Position:  -0.06639343353756738
Bond Position:  [5.04457572]


portfolio before change:  [-1.48672485]
curr_Stock_Price:  98.37743755609083
curr_Factors:  [98.37743756]
mat_Sqrt:  [[0.15]]
grads:  [-0.02446894]
Stock Position:  -0.024468936350307773
Bond Position:  [0.92046641]


portfolio before change:  [-1.51886802]
curr_Stock_Price:  99.69342043069436
curr_Factors:  [99.69342043]
mat_Sqrt:  [[0.15]]
grads:  [-0.01739978]
Stock Position:  -0.017399784265299766
Bond Position:  [0.21577599]


portfolio before change:  [-1.52206626]
curr_Stock_Price:  99.87800492712631
curr_Factors:  [99.87800493]
mat_Sqrt:  [[0.15]]
grads:  [0.09839625]
Stock Position:  0.09839624922642937
Bond Position:  [-11.34968732]


portfolio before change:  [-1.58025476]
curr_Stock_Price:  99.29384519881265
curr_Factors:  [99.2938452]
mat_Sqrt:  [[0.15]]
grads:  [0.13066694]
Stock Position:  0.13066693975341265
Bond Position:  [-14.55467765]


portfolio before change:  [-1.43995775]
curr_Stock_Price:  100.37450649477778
curr_Factors:  [100.37450649]
mat_Sqrt:  [[0.15]]
grads:  [0.02232234]
Stock Position:  0.02232234387623136
Bond Position:  [-3.680552]


portfolio before change:  [-1.4285187]
curr_Stock_Price:  100.89726052581597
curr_Factors:  [100.89726053]
mat_Sqrt:  [[0.15]]
grads:  [-0.02793472]
Stock Position:  -0.02793472472657522
Bond Position:  [1.3900185]


portfolio before change:  [-1.44620534]
curr_Stock_Price:  101.53351219636336
curr_Factors:  [101.5335122]
mat_Sqrt:  [[0.15]]
grads:  [-0.04635547]
Stock Position:  -0.046355467405379644
Bond Position:  [3.26042808]


portfolio before change:  [-1.43998398]
curr_Stock_Price:  101.40369854468652
curr_Factors:  [101.40369854]
mat_Sqrt:  [[0.15]]
grads:  [0.06560959]
Stock Position:  0.06560958816714546
Bond Position:  [-8.09303888]


portfolio before change:  [-1.42478781]
curr_Stock_Price:  101.64302340629365
curr_Factors:  [101.64302341]
mat_Sqrt:  [[0.15]]
grads:  [0.0044111]
Stock Position:  0.0044111040187975615
Bond Position:  [-1.87314576]


portfolio before change:  [-1.42120279]
curr_Stock_Price:  102.48229030442036
curr_Factors:  [102.4822903]
mat_Sqrt:  [[0.15]]
grads:  [-0.05656125]
Stock Position:  -0.05656124725561442
Bond Position:  [4.37532337]


portfolio before change:  [-1.41957236]
curr_Stock_Price:  102.45829923953919
curr_Factors:  [102.45829924]
mat_Sqrt:  [[0.15]]
grads:  [-0.19911298]
Stock Position:  -0.1991129819207219
Bond Position:  [18.98120513]


portfolio before change:  [-1.25988668]
curr_Stock_Price:  101.66227219933809
curr_Factors:  [101.6622722]
mat_Sqrt:  [[0.15]]
grads:  [-0.01690713]
Stock Position:  -0.016907130242265492
Bond Position:  [0.4589306]


portfolio before change:  [-1.25249084]
curr_Stock_Price:  101.22652951761219
curr_Factors:  [101.22652952]
mat_Sqrt:  [[0.15]]
grads:  [0.06218478]
Stock Position:  0.062184781925213956
Bond Position:  [-7.5472405]


portfolio before change:  [-1.24639421]
curr_Stock_Price:  101.33215565059764
curr_Factors:  [101.33215565]
mat_Sqrt:  [[0.15]]
grads:  [-0.09122222]
Stock Position:  -0.09122221883590248
Bond Position:  [7.99734986]


portfolio before change:  [-1.34525473]
curr_Stock_Price:  102.42136792612389
curr_Factors:  [102.42136793]
mat_Sqrt:  [[0.15]]
grads:  [-0.00104468]
Stock Position:  -0.001044684535948124
Bond Position:  [-1.23825671]


portfolio before change:  [-1.34506938]
curr_Stock_Price:  102.16986459176579
curr_Factors:  [102.16986459]
mat_Sqrt:  [[0.15]]
grads:  [0.01501003]
Stock Position:  0.015010030305287487
Bond Position:  [-2.87864214]


portfolio before change:  [-1.34224267]
curr_Stock_Price:  102.3701724943737
curr_Factors:  [102.37017249]
mat_Sqrt:  [[0.15]]
grads:  [-0.09099193]
Stock Position:  -0.09099192732822886
Bond Position:  [7.97261663]


portfolio before change:  [-1.28286187]
curr_Stock_Price:  101.72305474696826
curr_Factors:  [101.72305475]
mat_Sqrt:  [[0.15]]
grads:  [-0.02357146]
Stock Position:  -0.023571457805989973
Bond Position:  [1.11489882]


portfolio before change:  [-1.28335686]
curr_Stock_Price:  101.74701015328073
curr_Factors:  [101.74701015]
mat_Sqrt:  [[0.15]]
grads:  [-0.00422409]
Stock Position:  -0.004224093485834872
Bond Position:  [-0.85356797]


portfolio before change:  [-1.28375998]
curr_Stock_Price:  101.82981449029751
curr_Factors:  [101.82981449]
mat_Sqrt:  [[0.15]]
grads:  [-0.009161]
Stock Position:  -0.009160997620274147
Bond Position:  [-0.35089729]


portfolio before change:  [-1.28008701]
curr_Stock_Price:  101.42648486587949
curr_Factors:  [101.42648487]
mat_Sqrt:  [[0.15]]
grads:  [-0.02021254]
Stock Position:  -0.020212540022075776
Bond Position:  [0.76999988]


portfolio before change:  [-1.25842758]
curr_Stock_Price:  100.35728232104344
curr_Factors:  [100.35728232]
mat_Sqrt:  [[0.15]]
grads:  [0.02498986]
Stock Position:  0.02498985666900745
Bond Position:  [-3.76634168]


portfolio before change:  [-1.25047145]
curr_Stock_Price:  100.68507675745707
curr_Factors:  [100.68507676]
mat_Sqrt:  [[0.15]]
grads:  [0.0030376]
Stock Position:  0.0030376025655947984
Bond Position:  [-1.5563127]


portfolio before change:  [-1.2509502]
curr_Stock_Price:  100.55949170832024
curr_Factors:  [100.55949171]
mat_Sqrt:  [[0.15]]
grads:  [-0.008461]
Stock Position:  -0.008461002651251732
Bond Position:  [-0.40011607]


portfolio before change:  [-1.24290782]
curr_Stock_Price:  99.6060132907692
curr_Factors:  [99.60601329]
mat_Sqrt:  [[0.15]]
grads:  [0.01343853]
Stock Position:  0.013438526207293093
Bond Position:  [-2.58146584]


portfolio before change:  [-1.24657284]
curr_Stock_Price:  99.3452950255451
curr_Factors:  [99.34529503]
mat_Sqrt:  [[0.15]]
grads:  [0.06013688]
Stock Position:  0.06013688241738521
Bond Position:  [-7.22088917]


portfolio before change:  [-1.28587553]
curr_Stock_Price:  98.69924602142721
curr_Factors:  [98.69924602]
mat_Sqrt:  [[0.15]]
grads:  [0.10396742]
Stock Position:  0.10396741892402593
Bond Position:  [-11.54738139]


portfolio before change:  [-1.28697961]
curr_Stock_Price:  98.69556853943055
curr_Factors:  [98.69556854]
mat_Sqrt:  [[0.15]]
grads:  [-0.12853209]
Stock Position:  -0.1285320883314709
Bond Position:  [11.39856793]


portfolio before change:  [-1.24048906]
curr_Stock_Price:  98.33940754726815
curr_Factors:  [98.33940755]
mat_Sqrt:  [[0.15]]
grads:  [0.09208677]
Stock Position:  0.09208677399979888
Bond Position:  [-10.29624785]


portfolio before change:  [-1.21493151]
curr_Stock_Price:  98.62393351228106
curr_Factors:  [98.62393351]
mat_Sqrt:  [[0.15]]
grads:  [0.02233159]
Stock Position:  0.022331585219988764
Bond Position:  [-3.41736029]


portfolio before change:  [-1.22397837]
curr_Stock_Price:  98.22838310648488
curr_Factors:  [98.22838311]
mat_Sqrt:  [[0.15]]
grads:  [0.02843995]
Stock Position:  0.02843995076463568
Bond Position:  [-4.01758875]


portfolio before change:  [-1.2261321]
curr_Stock_Price:  98.16148352503019
curr_Factors:  [98.16148353]
mat_Sqrt:  [[0.15]]
grads:  [-0.10063956]
Stock Position:  -0.10063955838168415
Bond Position:  [8.65279625]


portfolio before change:  [-1.33425391]
curr_Stock_Price:  99.24120436117097
curr_Factors:  [99.24120436]
mat_Sqrt:  [[0.15]]
grads:  [-0.08366602]
Stock Position:  -0.08366601518263377
Bond Position:  [6.9688622]


portfolio before change:  [-1.30620645]
curr_Stock_Price:  98.91117919205992
curr_Factors:  [98.91117919]
mat_Sqrt:  [[0.15]]
grads:  [-0.00998605]
Stock Position:  -0.00998604675992363
Bond Position:  [-0.31847479]


portfolio before change:  [-1.30567894]
curr_Stock_Price:  98.85636095918692
curr_Factors:  [98.85636096]
mat_Sqrt:  [[0.15]]
grads:  [-0.07973541]
Stock Position:  -0.07973540962785913
Bond Position:  [6.57667349]


portfolio before change:  [-1.24381267]
curr_Stock_Price:  98.08562161377449
curr_Factors:  [98.08562161]
mat_Sqrt:  [[0.15]]
grads:  [-0.07800925]
Stock Position:  -0.0780092523320886
Bond Position:  [6.40777334]


portfolio before change:  [-1.28196026]
curr_Stock_Price:  98.57976920308113
curr_Factors:  [98.5797692]
mat_Sqrt:  [[0.15]]
grads:  [0.07412177]
Stock Position:  0.07412176614009904
Bond Position:  [-8.58886685]


portfolio before change:  [-1.23984344]
curr_Stock_Price:  99.15522278786085
curr_Factors:  [99.15522279]
mat_Sqrt:  [[0.15]]
grads:  [0.01334073]
Stock Position:  0.013340732935111128
Bond Position:  [-2.56264679]


portfolio before change:  [-1.23113557]
curr_Stock_Price:  99.81995680138115
curr_Factors:  [99.8199568]
mat_Sqrt:  [[0.15]]
grads:  [0.0431555]
Stock Position:  0.04315549817917738
Bond Position:  [-5.53891554]


portfolio before change:  [-1.23647682]
curr_Stock_Price:  99.70421119659032
curr_Factors:  [99.7042112]
mat_Sqrt:  [[0.15]]
grads:  [-0.09706079]
Stock Position:  -0.09706079203926732
Bond Position:  [8.44089288]


portfolio before change:  [-1.25320936]
curr_Stock_Price:  99.8820389861843
curr_Factors:  [99.88203899]
mat_Sqrt:  [[0.15]]
grads:  [-0.04016947]
Stock Position:  -0.04016947122738722
Bond Position:  [2.75899933]


portfolio before change:  [-1.22888358]
curr_Stock_Price:  99.28075309096758
curr_Factors:  [99.28075309]
mat_Sqrt:  [[0.15]]
grads:  [-0.00753264]
Stock Position:  -0.0075326350907624065
Bond Position:  [-0.48103789]


portfolio before change:  [-1.23040239]
curr_Stock_Price:  99.47839239858007
curr_Factors:  [99.4783924]
mat_Sqrt:  [[0.15]]
grads:  [0.01202419]
Stock Position:  0.012024188760729772
Bond Position:  [-2.42654936]


portfolio before change:  [-1.23228693]
curr_Stock_Price:  99.33427628619204
curr_Factors:  [99.33427629]
mat_Sqrt:  [[0.15]]
grads:  [0.05847536]
Stock Position:  0.05847535954374587
Bond Position:  [-7.04089445]


portfolio before change:  [-1.24073577]
curr_Stock_Price:  99.19731650935292
curr_Factors:  [99.19731651]
mat_Sqrt:  [[0.15]]
grads:  [0.07332484]
Stock Position:  0.0733248368220745
Bond Position:  [-8.51436282]


portfolio before change:  [-1.21275133]
curr_Stock_Price:  99.58622437575319
curr_Factors:  [99.58622438]
mat_Sqrt:  [[0.15]]
grads:  [-0.04524204]
Stock Position:  -0.045242044904000175
Bond Position:  [3.2927331]


portfolio before change:  [-1.24892162]
curr_Stock_Price:  100.39025721129357
curr_Factors:  [100.39025721]
mat_Sqrt:  [[0.15]]
grads:  [-0.00620063]
Stock Position:  -0.006200631173452221
Bond Position:  [-0.62643866]


portfolio before change:  [-1.24891635]
curr_Stock_Price:  100.38309339564597
curr_Factors:  [100.3830934]
mat_Sqrt:  [[0.15]]
grads:  [-0.05660061]
Stock Position:  -0.056600614770364176
Bond Position:  [4.43282844]


portfolio before change:  [-1.2259634]
curr_Stock_Price:  99.98246362682927
curr_Factors:  [99.98246363]
mat_Sqrt:  [[0.15]]
grads:  [0.00663703]
Stock Position:  0.006637029206219651
Bond Position:  [-1.88954993]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.2259634]
Stock Price:  99.4510074071677
PL:  [-1.2259634]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-9.98242641e-02]
 [ 4.74926310e-03]
 [ 1.10838982e-02]
 [ 3.33837327e-03]
 [ 6.03190143e-03]
 [ 1.19590712e-02]
 [ 7.63988185e-04]
 [ 1.05174921e-02]
 [ 7.30546299e-03]
 [-1.97602091e-02]
 [ 1.01884356e-02]
 [-4.89534053e-03]
 [-6.64476032e-03]
 [ 4.19767038e-03]
 [ 5.77868433e-03]
 [-4.67648198e-03]
 [ 8.60830642e-03]
 [ 2.73455512e-02]
 [ 9.33041242e-03]
 [-1.97262617e-03]
 [ 6.28074994e-02]
 [-1.31410325e-02]
 [-1.76769714e-03]
 [ 1.11093275e-02]
 [ 9.62258160e-03]
 [ 2.93447387e-03]
 [ 1.31075247e-02]
 [-2.16005435e-02]
 [ 1.29088586e-03]
 [-5.49011960e-03]
 [-3.54039713e-03]
 [-1.75923512e-02]
 [ 1.74525108e-02]
 [ 1.01867912e-02]
 [-1.78108084e-02]
 [ 6.45530253e-03]
 [-2.43346717e-03]
 [ 1.11910507e-02]
 [ 2.37853837e-03]
 [-1.49703686e-02]
 [ 2.59379142e-02]
 [-6.96874805e-04]
 [ 5.78882044e-03]
 [-8.88819787e-03]
 [-2.63086196e-04]
 [-1.00020102e-02]
 [-1.33260026e-02]
 [ 2.75483419e-04]
 [-2.66192087e-03]
 [-1.15890256e-02]
 [-4.11830902e-03]
 [ 2.76986602e-03]
 [ 3.90956701e-03]
 [-1.44300210e-03]
 [ 1.11603701e-02]
 [ 8.91794186e-03]
 [ 3.90688657e-03]
 [ 9.99700161e-03]
 [ 1.33479465e-02]
 [-4.57424577e-03]
 [-2.90011763e-03]
 [-1.97937094e-02]
 [-1.27079143e-02]
 [-1.55913063e-03]
 [-8.97792115e-03]
 [-2.13276234e-02]
 [ 9.72444150e-03]
 [ 2.07949683e-03]
 [ 1.31221964e-02]
 [-1.87381784e-02]
 [ 7.72644671e-03]
 [ 1.61441174e-03]
 [-9.24972710e-04]
 [ 8.32742080e-03]
 [ 4.98303940e-04]
 [ 1.51981662e-03]
 [-4.05716374e-03]
 [-1.06698420e-02]
 [-2.58766168e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.8615752]
curr_Stock_Price:  101.20797525883467
curr_Factors:  [101.20797526]
mat_Sqrt:  [[0.15]]
grads:  [-0.66549509]
Stock Position:  -0.6654950942352433
Bond Position:  [88.21498623]


portfolio before change:  [20.47958519]
curr_Stock_Price:  101.790253951702
curr_Factors:  [101.79025395]
mat_Sqrt:  [[0.15]]
grads:  [0.03166175]
Stock Position:  0.03166175403259623
Bond Position:  [17.25672721]


portfolio before change:  [20.47829092]
curr_Stock_Price:  101.71530999360274
curr_Factors:  [101.71530999]
mat_Sqrt:  [[0.15]]
grads:  [0.07389265]
Stock Position:  0.07389265459655531
Bond Position:  [12.96227665]


portfolio before change:  [20.48633254]
curr_Stock_Price:  101.81317432549363
curr_Factors:  [101.81317433]
mat_Sqrt:  [[0.15]]
grads:  [0.02225582]
Stock Position:  0.022255821793507123
Bond Position:  [18.22039668]


portfolio before change:  [20.48299223]
curr_Stock_Price:  101.61191841788911
curr_Factors:  [101.61191842]
mat_Sqrt:  [[0.15]]
grads:  [0.04021268]
Stock Position:  0.04021267621092314
Bond Position:  [16.39690506]


portfolio before change:  [20.46078238]
curr_Stock_Price:  101.03412314658026
curr_Factors:  [101.03412315]
mat_Sqrt:  [[0.15]]
grads:  [0.07972714]
Stock Position:  0.07972714141102893
Bond Position:  [12.40562056]


portfolio before change:  [20.44158459]
curr_Stock_Price:  100.78360407641374
curr_Factors:  [100.78360408]
mat_Sqrt:  [[0.15]]
grads:  [0.00509325]
Stock Position:  0.005093254563379748
Bond Position:  [19.92826803]


portfolio before change:  [20.4401377]
curr_Stock_Price:  100.2549749832615
curr_Factors:  [100.25497498]
mat_Sqrt:  [[0.15]]
grads:  [0.07011661]
Stock Position:  0.07011661419548275
Bond Position:  [13.4105983]


portfolio before change:  [20.44666699]
curr_Stock_Price:  100.33614117389372
curr_Factors:  [100.33614117]
mat_Sqrt:  [[0.15]]
grads:  [0.04870309]
Stock Position:  0.04870308658567858
Bond Position:  [15.55998721]


portfolio before change:  [20.49147973]
curr_Stock_Price:  101.23629393434608
curr_Factors:  [101.23629393]
mat_Sqrt:  [[0.15]]
grads:  [-0.13173473]
Stock Position:  -0.13173472745442982
Bond Position:  [33.82781532]


portfolio before change:  [20.61049363]
curr_Stock_Price:  100.34890760399145
curr_Factors:  [100.3489076]
mat_Sqrt:  [[0.15]]
grads:  [0.0679229]
Stock Position:  0.06792290405625222
Bond Position:  [13.79450441]


portfolio before change:  [20.58991493]
curr_Stock_Price:  100.0332426013041
curr_Factors:  [100.0332426]
mat_Sqrt:  [[0.15]]
grads:  [-0.0326356]
Stock Position:  -0.0326356035316204
Bond Position:  [23.85456018]


portfolio before change:  [20.58444316]
curr_Stock_Price:  100.24659013220842
curr_Factors:  [100.24659013]
mat_Sqrt:  [[0.15]]
grads:  [-0.0442984]
Stock Position:  -0.0442984021030955
Bond Position:  [25.02520692]


portfolio before change:  [20.55998438]
curr_Stock_Price:  100.83403600484796
curr_Factors:  [100.834036]
mat_Sqrt:  [[0.15]]
grads:  [0.02798447]
Stock Position:  0.027984469206175974
Bond Position:  [17.7381974]


portfolio before change:  [20.55413317]
curr_Stock_Price:  100.58533106045186
curr_Factors:  [100.58533106]
mat_Sqrt:  [[0.15]]
grads:  [0.03852456]
Stock Position:  0.038524562199945246
Bond Position:  [16.67912733]


portfolio before change:  [20.54577275]
curr_Stock_Price:  100.34125564903101
curr_Factors:  [100.34125565]
mat_Sqrt:  [[0.15]]
grads:  [-0.03117655]
Stock Position:  -0.031176546532450198
Bond Position:  [23.67406658]


portfolio before change:  [20.49846287]
curr_Stock_Price:  101.9061997889109
curr_Factors:  [101.90619979]
mat_Sqrt:  [[0.15]]
grads:  [0.05738871]
Stock Position:  0.057388709470833105
Bond Position:  [14.65019758]


portfolio before change:  [20.54510712]
curr_Stock_Price:  102.70302168064202
curr_Factors:  [102.70302168]
mat_Sqrt:  [[0.15]]
grads:  [0.18230367]
Stock Position:  0.18230367473733242
Bond Position:  [1.82196886]


portfolio before change:  [20.55042494]
curr_Stock_Price:  102.7315671539843
curr_Factors:  [102.73156715]
mat_Sqrt:  [[0.15]]
grads:  [0.06220275]
Stock Position:  0.062202749437922346
Bond Position:  [14.16023901]


portfolio before change:  [20.54922357]
curr_Stock_Price:  102.69802508347334
curr_Factors:  [102.69802508]
mat_Sqrt:  [[0.15]]
grads:  [-0.01315084]
Stock Position:  -0.013150841160643491
Bond Position:  [21.89978899]


portfolio before change:  [20.56534563]
curr_Stock_Price:  101.57617442059384
curr_Factors:  [101.57617442]
mat_Sqrt:  [[0.15]]
grads:  [0.41871666]
Stock Position:  0.418716662908199
Bond Position:  [-21.96629115]


portfolio before change:  [20.34722822]
curr_Stock_Price:  101.05853446880494
curr_Factors:  [101.05853447]
mat_Sqrt:  [[0.15]]
grads:  [-0.08760688]
Stock Position:  -0.0876068835573988
Bond Position:  [29.20065149]


portfolio before change:  [20.41871097]
curr_Stock_Price:  100.26341836319813
curr_Factors:  [100.26341836]
mat_Sqrt:  [[0.15]]
grads:  [-0.01178465]
Stock Position:  -0.011784647619745908
Bond Position:  [21.60028002]


portfolio before change:  [20.42211872]
curr_Stock_Price:  100.08881026847328
curr_Factors:  [100.08881027]
mat_Sqrt:  [[0.15]]
grads:  [0.07406218]
Stock Position:  0.07406218330131077
Bond Position:  [13.00932291]


portfolio before change:  [20.373006]
curr_Stock_Price:  99.41470343161205
curr_Factors:  [99.41470343]
mat_Sqrt:  [[0.15]]
grads:  [0.06415054]
Stock Position:  0.06415054400843848
Bond Position:  [13.9954987]


portfolio before change:  [20.34795476]
curr_Stock_Price:  99.01056053485563
curr_Factors:  [99.01056053]
mat_Sqrt:  [[0.15]]
grads:  [0.01956316]
Stock Position:  0.019563159126161703
Bond Position:  [18.41099541]


portfolio before change:  [20.34148075]
curr_Stock_Price:  98.62081061119983
curr_Factors:  [98.62081061]
mat_Sqrt:  [[0.15]]
grads:  [0.0873835]
Stock Position:  0.08738349822042933
Bond Position:  [11.72364932]


portfolio before change:  [20.29776966]
curr_Stock_Price:  98.11220388679433
curr_Factors:  [98.11220389]
mat_Sqrt:  [[0.15]]
grads:  [-0.14400362]
Stock Position:  -0.1440036236106659
Bond Position:  [34.42628254]


portfolio before change:  [20.34111065]
curr_Stock_Price:  97.82617445555671
curr_Factors:  [97.82617446]
mat_Sqrt:  [[0.15]]
grads:  [0.00860591]
Stock Position:  0.008605905705504065
Bond Position:  [19.49922781]


portfolio before change:  [20.34318651]
curr_Stock_Price:  97.9257714939123
curr_Factors:  [97.92577149]
mat_Sqrt:  [[0.15]]
grads:  [-0.0366008]
Stock Position:  -0.036600797360086076
Bond Position:  [23.92734783]


portfolio before change:  [20.35041129]
curr_Stock_Price:  97.76923728128695
curr_Factors:  [97.76923728]
mat_Sqrt:  [[0.15]]
grads:  [-0.02360265]
Stock Position:  -0.023602647518022078
Bond Position:  [22.65802414]


portfolio before change:  [20.34556238]
curr_Stock_Price:  98.03467717863795
curr_Factors:  [98.03467718]
mat_Sqrt:  [[0.15]]
grads:  [-0.11728234]
Stock Position:  -0.11728234134383032
Bond Position:  [31.84329885]


portfolio before change:  [20.34575095]
curr_Stock_Price:  98.05003922398888
curr_Factors:  [98.05003922]
mat_Sqrt:  [[0.15]]
grads:  [0.11635007]
Stock Position:  0.11635007229033559
Bond Position:  [8.9376218]


portfolio before change:  [20.29289848]
curr_Stock_Price:  97.59098414955852
curr_Factors:  [97.59098415]
mat_Sqrt:  [[0.15]]
grads:  [0.06791194]
Stock Position:  0.06791194119881291
Bond Position:  [13.6653053]


portfolio before change:  [20.33037702]
curr_Stock_Price:  98.13027712018761
curr_Factors:  [98.13027712]
mat_Sqrt:  [[0.15]]
grads:  [-0.11873872]
Stock Position:  -0.11873872249303044
Bond Position:  [31.98224076]


portfolio before change:  [20.28220801]
curr_Stock_Price:  98.5527842926485
curr_Factors:  [98.55278429]
mat_Sqrt:  [[0.15]]
grads:  [0.04303535]
Stock Position:  0.0430353501888816
Bond Position:  [16.04095443]


portfolio before change:  [20.27817954]
curr_Stock_Price:  98.43587906063016
curr_Factors:  [98.43587906]
mat_Sqrt:  [[0.15]]
grads:  [-0.01622311]
Stock Position:  -0.01622311447140364
Bond Position:  [21.87511608]


portfolio before change:  [20.27198209]
curr_Stock_Price:  98.90216983755202
curr_Factors:  [98.90216984]
mat_Sqrt:  [[0.15]]
grads:  [0.074607]
Stock Position:  0.07460700472970387
Bond Position:  [12.89318744]


portfolio before change:  [20.2629864]
curr_Stock_Price:  98.77079424587389
curr_Factors:  [98.77079425]
mat_Sqrt:  [[0.15]]
grads:  [0.01585692]
Stock Position:  0.015856922470981444
Bond Position:  [18.69678558]


portfolio before change:  [20.25181997]
curr_Stock_Price:  97.99289967969798
curr_Factors:  [97.99289968]
mat_Sqrt:  [[0.15]]
grads:  [-0.09980246]
Stock Position:  -0.09980245750497334
Bond Position:  [30.03175218]


portfolio before change:  [20.24135753]
curr_Stock_Price:  98.11653875958541
curr_Factors:  [98.11653876]
mat_Sqrt:  [[0.15]]
grads:  [0.17291943]
Stock Position:  0.17291942819801084
Bond Position:  [3.27510175]


portfolio before change:  [20.16931172]
curr_Stock_Price:  97.69871115795799
curr_Factors:  [97.69871116]
mat_Sqrt:  [[0.15]]
grads:  [-0.00464583]
Stock Position:  -0.004645832035700095
Bond Position:  [20.62320353]


portfolio before change:  [20.17294958]
curr_Stock_Price:  97.19312470967225
curr_Factors:  [97.19312471]
mat_Sqrt:  [[0.15]]
grads:  [0.03859214]
Stock Position:  0.038592136238158097
Bond Position:  [16.42205927]


portfolio before change:  [20.16761395]
curr_Stock_Price:  97.0282714318219
curr_Factors:  [97.02827143]
mat_Sqrt:  [[0.15]]
grads:  [-0.05925465]
Stock Position:  -0.05925465249289106
Bond Position:  [25.91699046]


portfolio before change:  [20.18276301]
curr_Stock_Price:  96.79994853236364
curr_Factors:  [96.79994853]
mat_Sqrt:  [[0.15]]
grads:  [-0.00175391]
Stock Position:  -0.0017539079708519308
Bond Position:  [20.35254121]


portfolio before change:  [20.18464312]
curr_Stock_Price:  96.45327444770128
curr_Factors:  [96.45327445]
mat_Sqrt:  [[0.15]]
grads:  [-0.06668007]
Stock Position:  -0.0666800681674241
Bond Position:  [26.61615403]


portfolio before change:  [20.20909141]
curr_Stock_Price:  96.11157225328436
curr_Factors:  [96.11157225]
mat_Sqrt:  [[0.15]]
grads:  [-0.08884002]
Stock Position:  -0.08884001759452957
Bond Position:  [28.74764518]


portfolio before change:  [20.18714561]
curr_Stock_Price:  96.37882327534797
curr_Factors:  [96.37882328]
mat_Sqrt:  [[0.15]]
grads:  [0.00183656]
Stock Position:  0.0018365561274740795
Bond Position:  [20.01014049]


portfolio before change:  [20.18701948]
curr_Stock_Price:  95.6291599881543
curr_Factors:  [95.62915999]
mat_Sqrt:  [[0.15]]
grads:  [-0.01774614]
Stock Position:  -0.017746139152605447
Bond Position:  [21.88406786]


portfolio before change:  [20.20676939]
curr_Stock_Price:  94.59332253867389
curr_Factors:  [94.59332254]
mat_Sqrt:  [[0.15]]
grads:  [-0.07726017]
Stock Position:  -0.07726017093400941
Bond Position:  [27.51506566]


portfolio before change:  [20.14548219]
curr_Stock_Price:  95.40883913604239
curr_Factors:  [95.40883914]
mat_Sqrt:  [[0.15]]
grads:  [-0.02745539]
Stock Position:  -0.027455393479286338
Bond Position:  [22.76496941]


portfolio before change:  [20.16270439]
curr_Stock_Price:  94.83338394295032
curr_Factors:  [94.83338394]
mat_Sqrt:  [[0.15]]
grads:  [0.01846577]
Stock Position:  0.01846577344446341
Bond Position:  [18.41153261]


portfolio before change:  [20.16294554]
curr_Stock_Price:  94.78412493362457
curr_Factors:  [94.78412493]
mat_Sqrt:  [[0.15]]
grads:  [0.02606378]
Stock Position:  0.026063780046885483
Bond Position:  [17.69251296]


portfolio before change:  [20.17234161]
curr_Stock_Price:  95.10220054123397
curr_Factors:  [95.10220054]
mat_Sqrt:  [[0.15]]
grads:  [-0.00962001]
Stock Position:  -0.009620013996900672
Bond Position:  [21.08722611]


portfolio before change:  [20.16973874]
curr_Stock_Price:  95.50977388233926
curr_Factors:  [95.50977388]
mat_Sqrt:  [[0.15]]
grads:  [0.07440247]
Stock Position:  0.0744024675860511
Bond Position:  [13.06357589]


portfolio before change:  [20.14195487]
curr_Stock_Price:  95.12537309100577
curr_Factors:  [95.12537309]
mat_Sqrt:  [[0.15]]
grads:  [0.05945295]
Stock Position:  0.05945294571752805
Bond Position:  [14.48647123]


portfolio before change:  [20.15516046]
curr_Stock_Price:  95.33226204557258
curr_Factors:  [95.33226205]
mat_Sqrt:  [[0.15]]
grads:  [0.02604591]
Stock Position:  0.026045910488715244
Bond Position:  [17.6721449]


portfolio before change:  [20.16076825]
curr_Stock_Price:  95.50515831901116
curr_Factors:  [95.50515832]
mat_Sqrt:  [[0.15]]
grads:  [0.06664668]
Stock Position:  0.0666466774164261
Bond Position:  [13.79566677]


portfolio before change:  [20.19371261]
curr_Stock_Price:  95.98653430361823
curr_Factors:  [95.9865343]
mat_Sqrt:  [[0.15]]
grads:  [0.08898631]
Stock Position:  0.08898631011898527
Bond Position:  [11.6522251]


portfolio before change:  [20.13645795]
curr_Stock_Price:  95.33494023530952
curr_Factors:  [95.33494024]
mat_Sqrt:  [[0.15]]
grads:  [-0.03049497]
Stock Position:  -0.030494971782259357
Bond Position:  [23.04369426]


portfolio before change:  [20.12235571]
curr_Stock_Price:  95.84461491173157
curr_Factors:  [95.84461491]
mat_Sqrt:  [[0.15]]
grads:  [-0.01933412]
Stock Position:  -0.019334117565513228
Bond Position:  [21.97542676]


portfolio before change:  [20.11213181]
curr_Stock_Price:  96.44445631690027
curr_Factors:  [96.44445632]
mat_Sqrt:  [[0.15]]
grads:  [-0.13195806]
Stock Position:  -0.1319580624989909
Bond Position:  [32.83875541]


portfolio before change:  [19.99198216]
curr_Stock_Price:  97.370524284463
curr_Factors:  [97.37052428]
mat_Sqrt:  [[0.15]]
grads:  [-0.08471943]
Stock Position:  -0.08471942858579817
Bond Position:  [28.24115734]


portfolio before change:  [20.03960761]
curr_Stock_Price:  96.8292043245518
curr_Factors:  [96.82920432]
mat_Sqrt:  [[0.15]]
grads:  [-0.0103942]
Stock Position:  -0.01039420422436901
Bond Position:  [21.04607013]


portfolio before change:  [20.04294397]
curr_Stock_Price:  96.63477436823919
curr_Factors:  [96.63477437]
mat_Sqrt:  [[0.15]]
grads:  [-0.05985281]
Stock Position:  -0.0598528076989639
Bond Position:  [25.82680654]


portfolio before change:  [19.99526192]
curr_Stock_Price:  97.45839962261884
curr_Factors:  [97.45839962]
mat_Sqrt:  [[0.15]]
grads:  [-0.14218416]
Stock Position:  -0.14218415575200896
Bond Position:  [33.85230219]


portfolio before change:  [20.03601634]
curr_Stock_Price:  97.18664928743493
curr_Factors:  [97.18664929]
mat_Sqrt:  [[0.15]]
grads:  [0.06482961]
Stock Position:  0.06482960999255465
Bond Position:  [13.73544377]


portfolio before change:  [20.02572392]
curr_Stock_Price:  97.01464586512745
curr_Factors:  [97.01464587]
mat_Sqrt:  [[0.15]]
grads:  [0.01386331]
Stock Position:  0.013863312221846493
Bond Position:  [18.68077959]


portfolio before change:  [20.01988018]
curr_Stock_Price:  96.50889897772718
curr_Factors:  [96.50889898]
mat_Sqrt:  [[0.15]]
grads:  [0.08748131]
Stock Position:  0.08748130965892525
Bond Position:  [11.5771553]


portfolio before change:  [19.9789722]
curr_Stock_Price:  96.0330079323733
curr_Factors:  [96.03300793]
mat_Sqrt:  [[0.15]]
grads:  [-0.12492119]
Stock Position:  -0.1249211896289925
Bond Position:  [31.9755298]


portfolio before change:  [19.86781978]
curr_Stock_Price:  96.93878663314504
curr_Factors:  [96.93878663]
mat_Sqrt:  [[0.15]]
grads:  [0.05150964]
Stock Position:  0.05150964476147195
Bond Position:  [14.87453732]


portfolio before change:  [19.87465117]
curr_Stock_Price:  97.0533612888381
curr_Factors:  [97.05336129]
mat_Sqrt:  [[0.15]]
grads:  [0.01076274]
Stock Position:  0.010762744918741228
Bond Position:  [18.8300906]


portfolio before change:  [19.87531288]
curr_Stock_Price:  97.0054918981688
curr_Factors:  [97.0054919]
mat_Sqrt:  [[0.15]]
grads:  [-0.00616648]
Stock Position:  -0.006166484730812643
Bond Position:  [20.47349577]


portfolio before change:  [19.87195442]
curr_Stock_Price:  97.75763730396817
curr_Factors:  [97.7576373]
mat_Sqrt:  [[0.15]]
grads:  [0.05551614]
Stock Position:  0.05551613864309679
Bond Position:  [14.44482788]


portfolio before change:  [19.85676432]
curr_Stock_Price:  97.46775891647741
curr_Factors:  [97.46775892]
mat_Sqrt:  [[0.15]]
grads:  [0.00332203]
Stock Position:  0.003322026268952489
Bond Position:  [19.53297387]


portfolio before change:  [19.85832504]
curr_Stock_Price:  97.57006768166053
curr_Factors:  [97.57006768]
mat_Sqrt:  [[0.15]]
grads:  [0.01013211]
Stock Position:  0.010132110818492688
Bond Position:  [18.86973431]


portfolio before change:  [19.86549543]
curr_Stock_Price:  98.16135511311136
curr_Factors:  [98.16135511]
mat_Sqrt:  [[0.15]]
grads:  [-0.02704776]
Stock Position:  -0.027047758296529605
Bond Position:  [22.52054004]


portfolio before change:  [19.87902623]
curr_Stock_Price:  97.71313971170454
curr_Factors:  [97.71313971]
mat_Sqrt:  [[0.15]]
grads:  [-0.07113228]
Stock Position:  -0.07113227997145094
Bond Position:  [26.82958464]


portfolio before change:  [19.92153619]
curr_Stock_Price:  97.1390956830238
curr_Factors:  [97.13909568]
mat_Sqrt:  [[0.15]]
grads:  [-0.17251078]
Stock Position:  -0.17251077856910557
Bond Position:  [36.67907722]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.92153619]
Stock Price:  97.21903925562798
PL:  [19.92153619]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.48297613e-02]
 [-2.25421905e-03]
 [ 2.90048242e-04]
 [ 2.33865908e-03]
 [ 7.23861163e-03]
 [ 1.18266491e-02]
 [ 8.41254666e-04]
 [ 1.03066008e-02]
 [ 3.80655289e-03]
 [-1.94571496e-02]
 [ 1.01531237e-02]
 [-6.74518977e-03]
 [-9.06554978e-03]
 [ 4.35386817e-03]
 [ 5.38064542e-03]
 [-1.00578841e-02]
 [ 1.47701486e-02]
 [ 9.16791631e-03]
 [ 2.20047447e-02]
 [ 1.07613838e-03]
 [ 7.27310530e-02]
 [-1.29863084e-02]
 [ 7.18252100e-03]
 [-3.79932095e-03]
 [ 1.72152947e-02]
 [ 1.75515495e-02]
 [ 1.19737548e-02]
 [ 5.18542151e-04]
 [ 4.77818726e-03]
 [-1.92194953e-02]
 [-5.62006814e-03]
 [ 2.91167607e-02]
 [ 8.79542904e-03]
 [ 7.97291486e-03]
 [-3.59413747e-03]
 [-4.73079401e-03]
 [-6.82594896e-03]
 [ 5.87464809e-03]
 [ 1.47524524e-03]
 [-9.81113739e-03]
 [-2.58454800e-02]
 [-2.71240655e-03]
 [ 9.08549214e-03]
 [-1.41834931e-02]
 [ 9.83335373e-04]
 [ 1.42953632e-03]
 [-1.37016004e-02]
 [-5.12020081e-03]
 [-9.19183990e-04]
 [ 4.78433076e-03]
 [-3.00709158e-03]
 [ 3.33347488e-03]
 [ 2.95892635e-03]
 [ 1.85774190e-03]
 [ 2.04940694e-03]
 [ 9.02594194e-03]
 [ 1.56410725e-02]
 [-2.60651918e-02]
 [ 1.40692825e-02]
 [ 8.64876680e-03]
 [ 7.55261272e-03]
 [-1.26605739e-02]
 [-1.25387197e-02]
 [-1.97975671e-03]
 [-1.23032086e-02]
 [ 5.92142178e-03]
 [ 1.07239193e-02]
 [ 2.00098944e-03]
 [ 8.14692688e-03]
 [-1.72278160e-02]
 [ 1.65729098e-03]
 [ 1.67801350e-03]
 [-1.30572030e-04]
 [ 8.09196407e-03]
 [ 2.16918232e-03]
 [ 7.09129034e-04]
 [-4.04598290e-03]
 [-9.78302347e-03]
 [-9.80790267e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.53397244]
curr_Stock_Price:  99.7685986398638
curr_Factors:  [99.76859864]
mat_Sqrt:  [[0.15]]
grads:  [-0.23219841]
Stock Position:  -0.23219840867558184
Bond Position:  [21.6321374]


portfolio before change:  [-1.62377288]
curr_Stock_Price:  100.16116159464504
curr_Factors:  [100.16116159]
mat_Sqrt:  [[0.15]]
grads:  [-0.01502813]
Stock Position:  -0.015028126993143806
Bond Position:  [-0.11853823]


portfolio before change:  [-1.62753026]
curr_Stock_Price:  100.41069159203342
curr_Factors:  [100.41069159]
mat_Sqrt:  [[0.15]]
grads:  [0.00193365]
Stock Position:  0.0019336549448494811
Bond Position:  [-1.82168989]


portfolio before change:  [-1.62706943]
curr_Stock_Price:  100.70789440420113
curr_Factors:  [100.7078944]
mat_Sqrt:  [[0.15]]
grads:  [0.01559106]
Stock Position:  0.015591060531348153
Bond Position:  [-3.19721231]


portfolio before change:  [-1.62860331]
curr_Stock_Price:  100.622329629629
curr_Factors:  [100.62232963]
mat_Sqrt:  [[0.15]]
grads:  [0.04825741]
Stock Position:  0.04825741089288612
Bond Position:  [-6.48437642]


portfolio before change:  [-1.63020143]
curr_Stock_Price:  100.597611506141
curr_Factors:  [100.59761151]
mat_Sqrt:  [[0.15]]
grads:  [0.07884433]
Stock Position:  0.07884432741879285
Bond Position:  [-9.56175245]


portfolio before change:  [-1.62173516]
curr_Stock_Price:  100.7125709677493
curr_Factors:  [100.71257097]
mat_Sqrt:  [[0.15]]
grads:  [0.00560836]
Stock Position:  0.005608364440601651
Bond Position:  [-2.18656796]


portfolio before change:  [-1.6233254]
curr_Stock_Price:  100.45339095324123
curr_Factors:  [100.45339095]
mat_Sqrt:  [[0.15]]
grads:  [0.06871067]
Stock Position:  0.06871067230633435
Bond Position:  [-8.52554542]


portfolio before change:  [-1.62038555]
curr_Stock_Price:  100.50393196346442
curr_Factors:  [100.50393196]
mat_Sqrt:  [[0.15]]
grads:  [0.02537702]
Stock Position:  0.02537701928966483
Bond Position:  [-4.17087577]


portfolio before change:  [-1.60070431]
curr_Stock_Price:  101.2897581988907
curr_Factors:  [101.2897582]
mat_Sqrt:  [[0.15]]
grads:  [-0.12971433]
Stock Position:  -0.12971433085312203
Bond Position:  [11.53802889]


portfolio before change:  [-1.57733937]
curr_Stock_Price:  101.1151915410409
curr_Factors:  [101.11519154]
mat_Sqrt:  [[0.15]]
grads:  [0.06768749]
Stock Position:  0.0676874914679985
Bond Position:  [-8.42157303]


portfolio before change:  [-1.59918683]
curr_Stock_Price:  100.80019835753143
curr_Factors:  [100.80019836]
mat_Sqrt:  [[0.15]]
grads:  [-0.04496793]
Stock Position:  -0.044967931802450116
Bond Position:  [2.93358962]


portfolio before change:  [-1.56620282]
curr_Stock_Price:  100.07077520292285
curr_Factors:  [100.0707752]
mat_Sqrt:  [[0.15]]
grads:  [-0.060437]
Stock Position:  -0.06043699852374021
Bond Position:  [4.48177447]


portfolio before change:  [-1.54202408]
curr_Stock_Price:  99.67534486952451
curr_Factors:  [99.67534487]
mat_Sqrt:  [[0.15]]
grads:  [0.02902579]
Stock Position:  0.029025787786951564
Bond Position:  [-4.43517949]


portfolio before change:  [-1.53274782]
curr_Stock_Price:  100.00448227700198
curr_Factors:  [100.00448228]
mat_Sqrt:  [[0.15]]
grads:  [0.03587097]
Stock Position:  0.03587096947204632
Bond Position:  [-5.12000555]


portfolio before change:  [-1.4964492]
curr_Stock_Price:  101.02532512587936
curr_Factors:  [101.02532513]
mat_Sqrt:  [[0.15]]
grads:  [-0.06705256]
Stock Position:  -0.06705256057359998
Bond Position:  [5.27755753]


portfolio before change:  [-1.4820095]
curr_Stock_Price:  100.81489550702894
curr_Factors:  [100.81489551]
mat_Sqrt:  [[0.15]]
grads:  [0.09846766]
Stock Position:  0.09846765720863337
Bond Position:  [-11.40901607]


portfolio before change:  [-1.58013153]
curr_Stock_Price:  99.82564735829833
curr_Factors:  [99.82564736]
mat_Sqrt:  [[0.15]]
grads:  [0.06111944]
Stock Position:  0.06111944203965314
Bond Position:  [-7.6814194]


portfolio before change:  [-1.53112818]
curr_Stock_Price:  100.63526630802328
curr_Factors:  [100.63526631]
mat_Sqrt:  [[0.15]]
grads:  [0.1466983]
Stock Position:  0.14669829791390546
Bond Position:  [-16.29415046]


portfolio before change:  [-1.47289498]
curr_Stock_Price:  101.03916746486965
curr_Factors:  [101.03916746]
mat_Sqrt:  [[0.15]]
grads:  [0.00717426]
Stock Position:  0.0071742558959511475
Bond Position:  [-2.19777583]


portfolio before change:  [-1.47292616]
curr_Stock_Price:  101.05396906046393
curr_Factors:  [101.05396906]
mat_Sqrt:  [[0.15]]
grads:  [0.48487369]
Stock Position:  0.4848736869889898
Bond Position:  [-50.47133672]


portfolio before change:  [-1.20302606]
curr_Stock_Price:  101.61711501220388
curr_Factors:  [101.61711501]
mat_Sqrt:  [[0.15]]
grads:  [-0.08657539]
Stock Position:  -0.08657538947973975
Bond Position:  [7.59451525]


portfolio before change:  [-1.19232283]
curr_Stock_Price:  101.49896868750145
curr_Factors:  [101.49896869]
mat_Sqrt:  [[0.15]]
grads:  [0.04788347]
Stock Position:  0.04788347334463441
Bond Position:  [-6.05244599]


portfolio before change:  [-1.18045883]
curr_Stock_Price:  101.7546369426173
curr_Factors:  [101.75463694]
mat_Sqrt:  [[0.15]]
grads:  [-0.02532881]
Stock Position:  -0.02532880633336448
Bond Position:  [1.39686466]


portfolio before change:  [-1.19250629]
curr_Stock_Price:  102.2337263330181
curr_Factors:  [102.23372633]
mat_Sqrt:  [[0.15]]
grads:  [0.11476863]
Stock Position:  0.11476863130363528
Bond Position:  [-12.92573113]


portfolio before change:  [-1.23525462]
curr_Stock_Price:  101.86829157138094
curr_Factors:  [101.86829157]
mat_Sqrt:  [[0.15]]
grads:  [0.11701033]
Stock Position:  0.11701033028067842
Bond Position:  [-13.15489706]


portfolio before change:  [-1.29576506]
curr_Stock_Price:  101.3581807915409
curr_Factors:  [101.35818079]
mat_Sqrt:  [[0.15]]
grads:  [0.07982503]
Stock Position:  0.07982503215958987
Bond Position:  [-9.3866851]


portfolio before change:  [-1.3449508]
curr_Stock_Price:  100.74936101411134
curr_Factors:  [100.74936101]
mat_Sqrt:  [[0.15]]
grads:  [0.00345695]
Stock Position:  0.0034569476752280746
Bond Position:  [-1.69323607]


portfolio before change:  [-1.34207812]
curr_Stock_Price:  101.61096261023692
curr_Factors:  [101.61096261]
mat_Sqrt:  [[0.15]]
grads:  [0.03185458]
Stock Position:  0.03185458176042939
Bond Position:  [-4.57885284]


portfolio before change:  [-1.32835539]
curr_Stock_Price:  102.05073961944993
curr_Factors:  [102.05073962]
mat_Sqrt:  [[0.15]]
grads:  [-0.12812997]
Stock Position:  -0.12812996853109476
Bond Position:  [11.74740266]


portfolio before change:  [-1.31678657]
curr_Stock_Price:  101.9661802624789
curr_Factors:  [101.96618026]
mat_Sqrt:  [[0.15]]
grads:  [-0.03746712]
Stock Position:  -0.03746712092002048
Bond Position:  [2.50359264]


portfolio before change:  [-1.31736806]
curr_Stock_Price:  101.98587674574254
curr_Factors:  [101.98587675]
mat_Sqrt:  [[0.15]]
grads:  [0.19411174]
Stock Position:  0.19411173832961368
Bond Position:  [-21.11402388]


portfolio before change:  [-1.46495204]
curr_Stock_Price:  101.23237099936696
curr_Factors:  [101.232371]
mat_Sqrt:  [[0.15]]
grads:  [0.05863619]
Stock Position:  0.0586361935783819
Bond Position:  [-7.40083294]


portfolio before change:  [-1.45935753]
curr_Stock_Price:  101.33567023818026
curr_Factors:  [101.33567024]
mat_Sqrt:  [[0.15]]
grads:  [0.05315277]
Stock Position:  0.053152765759106324
Bond Position:  [-6.84562868]


portfolio before change:  [-1.42326643]
curr_Stock_Price:  102.02272693520983
curr_Factors:  [102.02272694]
mat_Sqrt:  [[0.15]]
grads:  [-0.02396092]
Stock Position:  -0.023960916450526705
Bond Position:  [1.0212916]


portfolio before change:  [-1.41093637]
curr_Stock_Price:  101.51080053132031
curr_Factors:  [101.51080053]
mat_Sqrt:  [[0.15]]
grads:  [-0.03153863]
Stock Position:  -0.031538626747461954
Bond Position:  [1.79057487]


portfolio before change:  [-1.40758167]
curr_Stock_Price:  101.40798077286672
curr_Factors:  [101.40798077]
mat_Sqrt:  [[0.15]]
grads:  [-0.04550633]
Stock Position:  -0.04550632639589091
Bond Position:  [3.20712301]


portfolio before change:  [-1.43165969]
curr_Stock_Price:  101.94149938398674
curr_Factors:  [101.94149938]
mat_Sqrt:  [[0.15]]
grads:  [0.03916432]
Stock Position:  0.03916432060708576
Bond Position:  [-5.42412925]


portfolio before change:  [-1.42076921]
curr_Stock_Price:  102.22822701056805
curr_Factors:  [102.22822701]
mat_Sqrt:  [[0.15]]
grads:  [0.00983497]
Stock Position:  0.009834968273044063
Bond Position:  [-2.42618058]


portfolio before change:  [-1.42933496]
curr_Stock_Price:  101.37269786706067
curr_Factors:  [101.37269787]
mat_Sqrt:  [[0.15]]
grads:  [-0.06540758]
Stock Position:  -0.06540758260645953
Bond Position:  [5.20120815]


portfolio before change:  [-1.47134816]
curr_Stock_Price:  102.01999725090903
curr_Factors:  [102.01999725]
mat_Sqrt:  [[0.15]]
grads:  [-0.1723032]
Stock Position:  -0.17230320018685122
Bond Position:  [16.10702385]


portfolio before change:  [-1.31870953]
curr_Stock_Price:  101.13996771224625
curr_Factors:  [101.13996771]
mat_Sqrt:  [[0.15]]
grads:  [-0.01808271]
Stock Position:  -0.018082710301140316
Bond Position:  [0.5101752]


portfolio before change:  [-1.31845293]
curr_Stock_Price:  101.12754088057643
curr_Factors:  [101.12754088]
mat_Sqrt:  [[0.15]]
grads:  [0.06056995]
Stock Position:  0.06056994762374694
Bond Position:  [-7.44374279]


portfolio before change:  [-1.31647148]
curr_Stock_Price:  101.16793547434351
curr_Factors:  [101.16793547]
mat_Sqrt:  [[0.15]]
grads:  [-0.09455662]
Stock Position:  -0.09455662094438522
Bond Position:  [8.24962664]


portfolio before change:  [-1.34939426]
curr_Stock_Price:  101.52156905816526
curr_Factors:  [101.52156906]
mat_Sqrt:  [[0.15]]
grads:  [0.00655557]
Stock Position:  0.006555569153803939
Bond Position:  [-2.01492593]


portfolio before change:  [-1.352162]
curr_Stock_Price:  101.11858389446651
curr_Factors:  [101.11858389]
mat_Sqrt:  [[0.15]]
grads:  [0.00953024]
Stock Position:  0.009530242121856857
Bond Position:  [-2.31584658]


portfolio before change:  [-1.35140182]
curr_Stock_Price:  101.21353628942602
curr_Factors:  [101.21353629]
mat_Sqrt:  [[0.15]]
grads:  [-0.091344]
Stock Position:  -0.0913440024168921
Bond Position:  [7.89384768]


portfolio before change:  [-1.30778598]
curr_Stock_Price:  100.74144766669858
curr_Factors:  [100.74144767]
mat_Sqrt:  [[0.15]]
grads:  [-0.03413467]
Stock Position:  -0.034134672045391355
Bond Position:  [2.1309903]


portfolio before change:  [-1.29482861]
curr_Stock_Price:  100.36575405835238
curr_Factors:  [100.36575406]
mat_Sqrt:  [[0.15]]
grads:  [-0.00612789]
Stock Position:  -0.006127893269049596
Bond Position:  [-0.67979798]


portfolio before change:  [-1.29696519]
curr_Stock_Price:  100.70748495736555
curr_Factors:  [100.70748496]
mat_Sqrt:  [[0.15]]
grads:  [0.03189554]
Stock Position:  0.03189553840742919
Bond Position:  [-4.50908464]


portfolio before change:  [-1.32830792]
curr_Stock_Price:  99.73365267029548
curr_Factors:  [99.73365267]
mat_Sqrt:  [[0.15]]
grads:  [-0.02004728]
Stock Position:  -0.020047277214153933
Bond Position:  [0.67108026]


portfolio before change:  [-1.31168899]
curr_Stock_Price:  98.90675817563114
curr_Factors:  [98.90675818]
mat_Sqrt:  [[0.15]]
grads:  [0.02222317]
Stock Position:  0.022223165863855317
Bond Position:  [-3.50971028]


portfolio before change:  [-1.32454707]
curr_Stock_Price:  98.33804028329116
curr_Factors:  [98.33804028]
mat_Sqrt:  [[0.15]]
grads:  [0.01972618]
Stock Position:  0.01972617569892978
Bond Position:  [-3.26438053]


portfolio before change:  [-1.32659461]
curr_Stock_Price:  98.24458503872087
curr_Factors:  [98.24458504]
mat_Sqrt:  [[0.15]]
grads:  [0.01238495]
Stock Position:  0.012384946016281801
Bond Position:  [-2.54334849]


portfolio before change:  [-1.32635386]
curr_Stock_Price:  98.27685925478802
curr_Factors:  [98.27685925]
mat_Sqrt:  [[0.15]]
grads:  [0.01366271]
Stock Position:  0.013662712902786783
Bond Position:  [-2.66908238]


portfolio before change:  [-1.32170727]
curr_Stock_Price:  98.62916259049642
curr_Factors:  [98.62916259]
mat_Sqrt:  [[0.15]]
grads:  [0.06017295]
Stock Position:  0.060172946261954
Bond Position:  [-7.25651457]


portfolio before change:  [-1.31690876]
curr_Stock_Price:  98.71644526559707
curr_Factors:  [98.71644527]
mat_Sqrt:  [[0.15]]
grads:  [0.10427382]
Stock Position:  0.10427381645285122
Bond Position:  [-11.61044925]


portfolio before change:  [-1.27178344]
curr_Stock_Price:  99.15616251908757
curr_Factors:  [99.15616252]
mat_Sqrt:  [[0.15]]
grads:  [-0.17376795]
Stock Position:  -0.17376794533675494
Bond Position:  [15.95837919]


portfolio before change:  [-1.43292861]
curr_Stock_Price:  100.08926099855204
curr_Factors:  [100.089261]
mat_Sqrt:  [[0.15]]
grads:  [0.09379522]
Stock Position:  0.09379521696895503
Bond Position:  [-10.82082256]


portfolio before change:  [-1.42572457]
curr_Stock_Price:  100.17327766459849
curr_Factors:  [100.17327766]
mat_Sqrt:  [[0.15]]
grads:  [0.05765845]
Stock Position:  0.057658445358618644
Bond Position:  [-7.20156003]


portfolio before change:  [-1.41830483]
curr_Stock_Price:  100.30976863912628
curr_Factors:  [100.30976864]
mat_Sqrt:  [[0.15]]
grads:  [0.05035075]
Stock Position:  0.050350751455099714
Bond Position:  [-6.46897706]


portfolio before change:  [-1.40736631]
curr_Stock_Price:  100.5350451375716
curr_Factors:  [100.53504514]
mat_Sqrt:  [[0.15]]
grads:  [-0.08440383]
Stock Position:  -0.08440382626197233
Bond Position:  [7.07817617]


portfolio before change:  [-1.34063337]
curr_Stock_Price:  99.74964785238797
curr_Factors:  [99.74964785]
mat_Sqrt:  [[0.15]]
grads:  [-0.08359146]
Stock Position:  -0.08359146465620995
Bond Position:  [6.99758579]


portfolio before change:  [-1.31510712]
curr_Stock_Price:  99.44951087869804
curr_Factors:  [99.44951088]
mat_Sqrt:  [[0.15]]
grads:  [-0.01319838]
Stock Position:  -0.013198378086086916
Bond Position:  [-0.00253488]


portfolio before change:  [-1.31064985]
curr_Stock_Price:  99.11178552360927
curr_Factors:  [99.11178552]
mat_Sqrt:  [[0.15]]
grads:  [-0.08202139]
Stock Position:  -0.08202139071811367
Bond Position:  [6.81863663]


portfolio before change:  [-1.30287441]
curr_Stock_Price:  99.02218371610586
curr_Factors:  [99.02218372]
mat_Sqrt:  [[0.15]]
grads:  [0.03947615]
Stock Position:  0.03947614520570331
Bond Position:  [-5.21188851]


portfolio before change:  [-1.32422283]
curr_Stock_Price:  98.48964261027038
curr_Factors:  [98.48964261]
mat_Sqrt:  [[0.15]]
grads:  [0.0714928]
Stock Position:  0.07149279530553761
Bond Position:  [-8.36552269]


portfolio before change:  [-1.27463967]
curr_Stock_Price:  99.19049685433411
curr_Factors:  [99.19049685]
mat_Sqrt:  [[0.15]]
grads:  [0.01333993]
Stock Position:  0.013339929567915881
Bond Position:  [-2.59783391]


portfolio before change:  [-1.28062686]
curr_Stock_Price:  98.75385106561816
curr_Factors:  [98.75385107]
mat_Sqrt:  [[0.15]]
grads:  [0.05431285]
Stock Position:  0.05431284587565778
Bond Position:  [-6.64422955]


portfolio before change:  [-1.32265563]
curr_Stock_Price:  97.98766967272097
curr_Factors:  [97.98766967]
mat_Sqrt:  [[0.15]]
grads:  [-0.11485211]
Stock Position:  -0.11485210633871999
Bond Position:  [9.93143463]


portfolio before change:  [-1.29632587]
curr_Stock_Price:  97.76382509873766
curr_Factors:  [97.7638251]
mat_Sqrt:  [[0.15]]
grads:  [0.01104861]
Stock Position:  0.011048606532717005
Bond Position:  [-2.37647991]


portfolio before change:  [-1.302989]
curr_Stock_Price:  97.17419522685704
curr_Factors:  [97.17419523]
mat_Sqrt:  [[0.15]]
grads:  [0.01118676]
Stock Position:  0.011186756679185204
Bond Position:  [-2.39005308]


portfolio before change:  [-1.29820467]
curr_Stock_Price:  97.61522694430869
curr_Factors:  [97.61522694]
mat_Sqrt:  [[0.15]]
grads:  [-0.00087048]
Stock Position:  -0.000870480201166319
Bond Position:  [-1.21323254]


portfolio before change:  [-1.29788205]
curr_Stock_Price:  97.15749410174709
curr_Factors:  [97.1574941]
mat_Sqrt:  [[0.15]]
grads:  [0.05394643]
Stock Position:  0.053946427114882865
Bond Position:  [-6.53918172]


portfolio before change:  [-1.26179311]
curr_Stock_Price:  97.83404763683052
curr_Factors:  [97.83404764]
mat_Sqrt:  [[0.15]]
grads:  [0.01446122]
Stock Position:  0.014461215457308626
Bond Position:  [-2.67659236]


portfolio before change:  [-1.26214839]
curr_Stock_Price:  97.82104840141211
curr_Factors:  [97.8210484]
mat_Sqrt:  [[0.15]]
grads:  [0.00472753]
Stock Position:  0.0047275268912243045
Bond Position:  [-1.72460003]


portfolio before change:  [-1.26065385]
curr_Stock_Price:  98.1599854210826
curr_Factors:  [98.15998542]
mat_Sqrt:  [[0.15]]
grads:  [-0.02697322]
Stock Position:  -0.026973219338127855
Bond Position:  [1.38703697]


portfolio before change:  [-1.27310009]
curr_Stock_Price:  98.62462917871653
curr_Factors:  [98.62462918]
mat_Sqrt:  [[0.15]]
grads:  [-0.06522016]
Stock Position:  -0.06522015647320269
Bond Position:  [5.15921365]


portfolio before change:  [-1.24640506]
curr_Stock_Price:  98.22026693115198
curr_Factors:  [98.22026693]
mat_Sqrt:  [[0.15]]
grads:  [-0.06538602]
Stock Position:  -0.06538601778889412
Bond Position:  [5.17582706]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.24640506]
Stock Price:  98.73213724592831
PL:  [-1.24640506]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.44417327e-02]
 [ 4.31402157e-03]
 [-3.34932080e-04]
 [ 6.14786789e-04]
 [ 5.92283576e-03]
 [ 1.18242436e-02]
 [ 1.22185280e-03]
 [ 1.02576096e-02]
 [ 1.53030907e-02]
 [-1.93531649e-02]
 [ 8.20489420e-03]
 [-7.30700308e-03]
 [ 1.31028335e-02]
 [ 1.29812930e-02]
 [-8.93298538e-03]
 [-7.63196812e-03]
 [ 1.10730660e-02]
 [ 2.18322274e-02]
 [ 3.65516017e-03]
 [-2.74189316e-03]
 [ 4.12280243e-02]
 [-1.22522208e-02]
 [ 2.26068670e-03]
 [ 2.10978306e-03]
 [ 1.82332270e-02]
 [ 1.40672679e-02]
 [ 7.40993660e-03]
 [ 3.80222253e-03]
 [ 9.40521937e-03]
 [-8.91497817e-03]
 [-5.81860415e-03]
 [ 4.33093008e-02]
 [ 2.05408470e-03]
 [-1.08733885e-02]
 [-2.08206188e-03]
 [-6.22286730e-03]
 [-1.21611339e-03]
 [-2.94933011e-03]
 [ 6.52387207e-03]
 [-6.08854127e-03]
 [-6.29717454e-02]
 [-5.42761945e-03]
 [ 2.28176673e-02]
 [-1.92235649e-02]
 [-1.15280706e-02]
 [ 3.37026126e-03]
 [-1.35398907e-02]
 [ 1.87751750e-02]
 [ 3.34393611e-02]
 [-1.27821216e-02]
 [-4.75874474e-03]
 [ 3.65053441e-03]
 [ 3.33041800e-03]
 [-3.37176446e-03]
 [-1.00724844e-02]
 [ 1.17921062e-02]
 [-2.82018394e-02]
 [-1.07327654e-02]
 [ 2.12635385e-02]
 [-1.01522169e-02]
 [ 1.31848715e-02]
 [-1.35881237e-02]
 [-1.26822367e-02]
 [-2.46804473e-03]
 [ 1.29958828e-01]
 [-1.21187037e-02]
 [ 1.02888895e-03]
 [ 5.37173279e-03]
 [ 1.40571744e-02]
 [-2.99535556e-02]
 [-7.85710340e-03]
 [-4.01379527e-03]
 [ 1.73847268e-02]
 [ 3.91052140e-03]
 [-2.36096896e-03]
 [ 5.31856669e-03]
 [ 3.33580405e-03]
 [-2.63491953e-03]
 [ 1.99558438e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.03358044]
curr_Stock_Price:  99.80075916406487
curr_Factors:  [99.80075916]
mat_Sqrt:  [[0.15]]
grads:  [-0.22961155]
Stock Position:  -0.22961155119933213
Bond Position:  [21.88182669]


portfolio before change:  [-0.89566547]
curr_Stock_Price:  99.2060708186034
curr_Factors:  [99.20607082]
mat_Sqrt:  [[0.15]]
grads:  [0.02876014]
Stock Position:  0.028760143799912062
Bond Position:  [-3.74884633]


portfolio before change:  [-0.88994364]
curr_Stock_Price:  99.41316769194478
curr_Factors:  [99.41316769]
mat_Sqrt:  [[0.15]]
grads:  [-0.00223288]
Stock Position:  -0.002232880534470521
Bond Position:  [-0.66796591]


portfolio before change:  [-0.88976472]
curr_Stock_Price:  99.31434205727888
curr_Factors:  [99.31434206]
mat_Sqrt:  [[0.15]]
grads:  [0.00409858]
Stock Position:  0.004098578592052929
Bond Position:  [-1.29681236]


portfolio before change:  [-0.88412707]
curr_Stock_Price:  100.70963331404158
curr_Factors:  [100.70963331]
mat_Sqrt:  [[0.15]]
grads:  [0.03948557]
Stock Position:  0.03948557170586753
Bond Position:  [-4.86070451]


portfolio before change:  [-0.88916721]
curr_Stock_Price:  100.58968221543297
curr_Factors:  [100.58968222]
mat_Sqrt:  [[0.15]]
grads:  [0.07882829]
Stock Position:  0.078828290987832
Bond Position:  [-8.81847995]


portfolio before change:  [-0.91954852]
curr_Stock_Price:  100.21126293066241
curr_Factors:  [100.21126293]
mat_Sqrt:  [[0.15]]
grads:  [0.00814569]
Stock Position:  0.008145685323538963
Bond Position:  [-1.73583794]


portfolio before change:  [-0.92008754]
curr_Stock_Price:  100.15841031513648
curr_Factors:  [100.15841032]
mat_Sqrt:  [[0.15]]
grads:  [0.06838406]
Stock Position:  0.06838406385303247
Bond Position:  [-7.76932667]


portfolio before change:  [-1.01003468]
curr_Stock_Price:  98.85018818287124
curr_Factors:  [98.85018818]
mat_Sqrt:  [[0.15]]
grads:  [0.1020206]
Stock Position:  0.1020206044863455
Bond Position:  [-11.09479063]


portfolio before change:  [-0.9542511]
curr_Stock_Price:  99.4037727074383
curr_Factors:  [99.40377271]
mat_Sqrt:  [[0.15]]
grads:  [-0.1290211]
Stock Position:  -0.12902109962155092
Bond Position:  [11.87093296]


portfolio before change:  [-1.00819331]
curr_Stock_Price:  99.82761161636074
curr_Factors:  [99.82761162]
mat_Sqrt:  [[0.15]]
grads:  [0.05469929]
Stock Position:  0.054699294671251765
Bond Position:  [-6.46869325]


portfolio before change:  [-0.94024469]
curr_Stock_Price:  101.07722411479087
curr_Factors:  [101.07722411]
mat_Sqrt:  [[0.15]]
grads:  [-0.04871335]
Stock Position:  -0.04871335384457203
Bond Position:  [3.98356589]


portfolio before change:  [-0.9588558]
curr_Stock_Price:  101.46438889692746
curr_Factors:  [101.4643889]
mat_Sqrt:  [[0.15]]
grads:  [0.08735222]
Stock Position:  0.08735222308868298
Bond Position:  [-9.82199574]


portfolio before change:  [-0.86898978]
curr_Stock_Price:  102.50019443689958
curr_Factors:  [102.50019444]
mat_Sqrt:  [[0.15]]
grads:  [0.08654195]
Stock Position:  0.08654195303159092
Bond Position:  [-9.73955679]


portfolio before change:  [-0.81074001]
curr_Stock_Price:  103.18030978141287
curr_Factors:  [103.18030978]
mat_Sqrt:  [[0.15]]
grads:  [-0.05955324]
Stock Position:  -0.05955323589097415
Bond Position:  [5.33398131]


portfolio before change:  [-0.82225592]
curr_Stock_Price:  103.37927944483461
curr_Factors:  [103.37927944]
mat_Sqrt:  [[0.15]]
grads:  [-0.05087979]
Stock Position:  -0.050879787446807344
Bond Position:  [4.43765985]


portfolio before change:  [-0.79857915]
curr_Stock_Price:  102.91938362788788
curr_Factors:  [102.91938363]
mat_Sqrt:  [[0.15]]
grads:  [0.07382044]
Stock Position:  0.07382044012862991
Bond Position:  [-8.39613335]


portfolio before change:  [-0.73557508]
curr_Stock_Price:  103.77996970089636
curr_Factors:  [103.7799697]
mat_Sqrt:  [[0.15]]
grads:  [0.14554818]
Stock Position:  0.14554818265173386
Bond Position:  [-15.84056107]


portfolio before change:  [-0.83885143]
curr_Stock_Price:  103.07720392694345
curr_Factors:  [103.07720393]
mat_Sqrt:  [[0.15]]
grads:  [0.02436773]
Stock Position:  0.024367734443243538
Bond Position:  [-3.35060936]


portfolio before change:  [-0.83636004]
curr_Stock_Price:  103.18803963965587
curr_Factors:  [103.18803964]
mat_Sqrt:  [[0.15]]
grads:  [-0.01827929]
Stock Position:  -0.01827928771328961
Bond Position:  [1.04984383]


portfolio before change:  [-0.82656009]
curr_Stock_Price:  102.65550639255144
curr_Factors:  [102.65550639]
mat_Sqrt:  [[0.15]]
grads:  [0.2748535]
Stock Position:  0.2748534952611482
Bond Position:  [-29.04178483]


portfolio before change:  [-0.89229022]
curr_Stock_Price:  102.42296445775558
curr_Factors:  [102.42296446]
mat_Sqrt:  [[0.15]]
grads:  [-0.08168147]
Stock Position:  -0.08168147200064414
Bond Position:  [7.47376828]


portfolio before change:  [-0.95879783]
curr_Stock_Price:  103.24291457917718
curr_Factors:  [103.24291458]
mat_Sqrt:  [[0.15]]
grads:  [0.01507124]
Stock Position:  0.01507124466308236
Bond Position:  [-2.51479706]


portfolio before change:  [-0.95086253]
curr_Stock_Price:  103.77986318246492
curr_Factors:  [103.77986318]
mat_Sqrt:  [[0.15]]
grads:  [0.01406522]
Stock Position:  0.014065220425215486
Bond Position:  [-2.41054918]


portfolio before change:  [-0.94788909]
curr_Stock_Price:  104.00197864968216
curr_Factors:  [104.00197865]
mat_Sqrt:  [[0.15]]
grads:  [0.12155485]
Stock Position:  0.12155484683399644
Bond Position:  [-13.58983367]


portfolio before change:  [-0.86927386]
curr_Stock_Price:  104.65571330118985
curr_Factors:  [104.6557133]
mat_Sqrt:  [[0.15]]
grads:  [0.09378179]
Stock Position:  0.09378178592098808
Bond Position:  [-10.68407356]


portfolio before change:  [-0.90380054]
curr_Stock_Price:  104.29467407780045
curr_Factors:  [104.29467408]
mat_Sqrt:  [[0.15]]
grads:  [0.04939958]
Stock Position:  0.049399577300022264
Bond Position:  [-6.05591336]


portfolio before change:  [-0.8897292]
curr_Stock_Price:  104.58718358531056
curr_Factors:  [104.58718359]
mat_Sqrt:  [[0.15]]
grads:  [0.02534815]
Stock Position:  0.025348150218934853
Bond Position:  [-3.54082084]


portfolio before change:  [-0.88334676]
curr_Stock_Price:  104.84770542814516
curr_Factors:  [104.84770543]
mat_Sqrt:  [[0.15]]
grads:  [0.06270146]
Stock Position:  0.06270146247842327
Bond Position:  [-7.45745123]


portfolio before change:  [-0.85669575]
curr_Stock_Price:  105.2801852486603
curr_Factors:  [105.28018525]
mat_Sqrt:  [[0.15]]
grads:  [-0.05943319]
Stock Position:  -0.0594331877888778
Bond Position:  [5.40044127]


portfolio before change:  [-0.85262967]
curr_Stock_Price:  105.21745015657733
curr_Factors:  [105.21745016]
mat_Sqrt:  [[0.15]]
grads:  [-0.03879069]
Stock Position:  -0.038790694357376906
Bond Position:  [3.22882828]


portfolio before change:  [-0.87075002]
curr_Stock_Price:  105.68978397974747
curr_Factors:  [105.68978398]
mat_Sqrt:  [[0.15]]
grads:  [0.28872867]
Stock Position:  0.28872867196092483
Bond Position:  [-31.38642098]


portfolio before change:  [-0.82644969]
curr_Stock_Price:  105.8500106801044
curr_Factors:  [105.85001068]
mat_Sqrt:  [[0.15]]
grads:  [0.0136939]
Stock Position:  0.013693898025136705
Bond Position:  [-2.27594894]


portfolio before change:  [-0.82453991]
curr_Stock_Price:  105.99986066239707
curr_Factors:  [105.99986066]
mat_Sqrt:  [[0.15]]
grads:  [-0.07248926]
Stock Position:  -0.07248925676567172
Bond Position:  [6.85931121]


portfolio before change:  [-0.7947438]
curr_Stock_Price:  105.59473322619178
curr_Factors:  [105.59473323]
mat_Sqrt:  [[0.15]]
grads:  [-0.01388041]
Stock Position:  -0.013880412558247845
Bond Position:  [0.67095466]


portfolio before change:  [-0.79369352]
curr_Stock_Price:  105.52208825848035
curr_Factors:  [105.52208826]
mat_Sqrt:  [[0.15]]
grads:  [-0.04148578]
Stock Position:  -0.04148578201438835
Bond Position:  [3.58397283]


portfolio before change:  [-0.79655892]
curr_Stock_Price:  105.59655731958082
curr_Factors:  [105.59655732]
mat_Sqrt:  [[0.15]]
grads:  [-0.00810742]
Stock Position:  -0.00810742259791238
Bond Position:  [0.05955699]


portfolio before change:  [-0.79444759]
curr_Stock_Price:  105.33659656088658
curr_Factors:  [105.33659656]
mat_Sqrt:  [[0.15]]
grads:  [-0.0196622]
Stock Position:  -0.019662200761367567
Bond Position:  [1.27670172]


portfolio before change:  [-0.79597401]
curr_Stock_Price:  105.41828719608624
curr_Factors:  [105.4182872]
mat_Sqrt:  [[0.15]]
grads:  [0.04349248]
Stock Position:  0.04349248049910374
Bond Position:  [-5.38087681]


portfolio before change:  [-0.77678705]
curr_Stock_Price:  105.86717578283522
curr_Factors:  [105.86717578]
mat_Sqrt:  [[0.15]]
grads:  [-0.04059028]
Stock Position:  -0.04059027513075011
Bond Position:  [3.52039075]


portfolio before change:  [-0.79852168]
curr_Stock_Price:  106.40806055820964
curr_Factors:  [106.40806056]
mat_Sqrt:  [[0.15]]
grads:  [-0.41981164]
Stock Position:  -0.4198116357218714
Bond Position:  [43.87282028]


portfolio before change:  [-1.0092224]
curr_Stock_Price:  106.9164858569749
curr_Factors:  [106.91648586]
mat_Sqrt:  [[0.15]]
grads:  [-0.03618413]
Stock Position:  -0.03618412966986308
Bond Position:  [2.85945759]


portfolio before change:  [-1.04009408]
curr_Stock_Price:  107.7746081743027
curr_Factors:  [107.77460817]
mat_Sqrt:  [[0.15]]
grads:  [0.15211778]
Stock Position:  0.15211778192179354
Bond Position:  [-17.43452843]


portfolio before change:  [-1.08296165]
curr_Stock_Price:  107.4999665433313
curr_Factors:  [107.49996654]
mat_Sqrt:  [[0.15]]
grads:  [-0.1281571]
Stock Position:  -0.12815709943843495
Bond Position:  [12.69392225]


portfolio before change:  [-1.09691567]
curr_Stock_Price:  107.61503948773696
curr_Factors:  [107.61503949]
mat_Sqrt:  [[0.15]]
grads:  [-0.0768538]
Stock Position:  -0.07685380419270255
Bond Position:  [7.1737095]


portfolio before change:  [-1.04283797]
curr_Stock_Price:  106.91722976154223
curr_Factors:  [106.91722976]
mat_Sqrt:  [[0.15]]
grads:  [0.02246841]
Stock Position:  0.02246840840793341
Bond Position:  [-3.44509795]


portfolio before change:  [-1.06003576]
curr_Stock_Price:  106.16139221027271
curr_Factors:  [106.16139221]
mat_Sqrt:  [[0.15]]
grads:  [-0.09026594]
Stock Position:  -0.0902659378704025
Bond Position:  [8.52272187]


portfolio before change:  [-1.01742217]
curr_Stock_Price:  105.69520412824168
curr_Factors:  [105.69520413]
mat_Sqrt:  [[0.15]]
grads:  [0.12516783]
Stock Position:  0.12516783362567985
Bond Position:  [-14.2470619]


portfolio before change:  [-0.96099494]
curr_Stock_Price:  106.15313084946624
curr_Factors:  [106.15313085]
mat_Sqrt:  [[0.15]]
grads:  [0.22292907]
Stock Position:  0.22292907412513233
Bond Position:  [-24.62561412]


portfolio before change:  [-1.09305515]
curr_Stock_Price:  105.56764840512263
curr_Factors:  [105.56764841]
mat_Sqrt:  [[0.15]]
grads:  [-0.08521414]
Stock Position:  -0.08521414420735593
Bond Position:  [7.90280166]


portfolio before change:  [-1.15782583]
curr_Stock_Price:  106.33353791662397
curr_Factors:  [106.33353792]
mat_Sqrt:  [[0.15]]
grads:  [-0.03172496]
Stock Position:  -0.0317249649297629
Bond Position:  [2.21560193]


portfolio before change:  [-1.14394181]
curr_Stock_Price:  105.90026577362714
curr_Factors:  [105.90026577]
mat_Sqrt:  [[0.15]]
grads:  [0.0243369]
Stock Position:  0.024336896061796325
Bond Position:  [-3.72122557]


portfolio before change:  [-1.1519609]
curr_Stock_Price:  105.5803192430417
curr_Factors:  [105.58031924]
mat_Sqrt:  [[0.15]]
grads:  [0.02220279]
Stock Position:  0.02220278667635229
Bond Position:  [-3.4961382]


portfolio before change:  [-1.15565301]
curr_Stock_Price:  105.42387074681294
curr_Factors:  [105.42387075]
mat_Sqrt:  [[0.15]]
grads:  [-0.02247843]
Stock Position:  -0.022478429712289156
Bond Position:  [1.21411006]


portfolio before change:  [-1.15796805]
curr_Stock_Price:  105.530236108594
curr_Factors:  [105.53023611]
mat_Sqrt:  [[0.15]]
grads:  [-0.0671499]
Stock Position:  -0.06714989626068482
Bond Position:  [5.92837636]


portfolio before change:  [-1.13925764]
curr_Stock_Price:  105.25711765404999
curr_Factors:  [105.25711765]
mat_Sqrt:  [[0.15]]
grads:  [0.07861404]
Stock Position:  0.07861404162336187
Bond Position:  [-9.41394506]


portfolio before change:  [-1.09735162]
curr_Stock_Price:  105.7976623749326
curr_Factors:  [105.79766237]
mat_Sqrt:  [[0.15]]
grads:  [-0.18801226]
Stock Position:  -0.18801226237409238
Bond Position:  [18.79390624]


portfolio before change:  [-1.30393514]
curr_Stock_Price:  106.90268697895984
curr_Factors:  [106.90268698]
mat_Sqrt:  [[0.15]]
grads:  [-0.07155177]
Stock Position:  -0.07155176943695807
Bond Position:  [6.34514127]


portfolio before change:  [-1.31421082]
curr_Stock_Price:  107.05184135987452
curr_Factors:  [107.05184136]
mat_Sqrt:  [[0.15]]
grads:  [0.14175692]
Stock Position:  0.14175692340139323
Bond Position:  [-16.48955049]


portfolio before change:  [-1.30464895]
curr_Stock_Price:  107.1265643273271
curr_Factors:  [107.12656433]
mat_Sqrt:  [[0.15]]
grads:  [-0.06768145]
Stock Position:  -0.06768144575542093
Bond Position:  [5.9458318]


portfolio before change:  [-1.26594471]
curr_Stock_Price:  106.56019622141346
curr_Factors:  [106.56019622]
mat_Sqrt:  [[0.15]]
grads:  [0.08789914]
Stock Position:  0.08789914346491635
Bond Position:  [-10.63249469]


portfolio before change:  [-1.230304]
curr_Stock_Price:  106.97322936864067
curr_Factors:  [106.97322937]
mat_Sqrt:  [[0.15]]
grads:  [-0.09058749]
Stock Position:  -0.09058749122849472
Bond Position:  [8.46013248]


portfolio before change:  [-1.23070276]
curr_Stock_Price:  106.98346841396702
curr_Factors:  [106.98346841]
mat_Sqrt:  [[0.15]]
grads:  [-0.08454824]
Stock Position:  -0.08454824483514775
Bond Position:  [7.81456172]


portfolio before change:  [-1.29363606]
curr_Stock_Price:  107.73359314050126
curr_Factors:  [107.73359314]
mat_Sqrt:  [[0.15]]
grads:  [-0.01645363]
Stock Position:  -0.016453631560269178
Bond Position:  [0.47897279]


portfolio before change:  [-1.29344551]
curr_Stock_Price:  107.72383148715463
curr_Factors:  [107.72383149]
mat_Sqrt:  [[0.15]]
grads:  [0.86639219]
Stock Position:  0.8663921851233213
Bond Position:  [-94.62453126]


portfolio before change:  [-1.08193704]
curr_Stock_Price:  107.97478329409726
curr_Factors:  [107.97478329]
mat_Sqrt:  [[0.15]]
grads:  [-0.08079136]
Stock Position:  -0.08079135782377352
Bond Position:  [7.64149231]


portfolio before change:  [-1.08617198]
curr_Stock_Price:  108.03311316108268
curr_Factors:  [108.03311316]
mat_Sqrt:  [[0.15]]
grads:  [0.00685926]
Stock Position:  0.006859259639283178
Bond Position:  [-1.82719916]


portfolio before change:  [-1.10021437]
curr_Stock_Price:  106.00254668876678
curr_Factors:  [106.00254669]
mat_Sqrt:  [[0.15]]
grads:  [0.03581155]
Stock Position:  0.03581155194273696
Bond Position:  [-4.89633008]


portfolio before change:  [-1.08009131]
curr_Stock_Price:  106.57300767193007
curr_Factors:  [106.57300767]
mat_Sqrt:  [[0.15]]
grads:  [0.0937145]
Stock Position:  0.09371449606439526
Bond Position:  [-11.06752701]


portfolio before change:  [-0.99228215]
curr_Stock_Price:  107.5173748616574
curr_Factors:  [107.51737486]
mat_Sqrt:  [[0.15]]
grads:  [-0.19969037]
Stock Position:  -0.1996903706307716
Bond Position:  [20.47790228]


portfolio before change:  [-1.0208531]
curr_Stock_Price:  107.66686055007592
curr_Factors:  [107.66686055]
mat_Sqrt:  [[0.15]]
grads:  [-0.05238069]
Stock Position:  -0.052380689325083045
Bond Position:  [4.61881128]


portfolio before change:  [-1.09464271]
curr_Stock_Price:  109.08108978052239
curr_Factors:  [109.08108978]
mat_Sqrt:  [[0.15]]
grads:  [-0.02675864]
Stock Position:  -0.0267586351375281
Bond Position:  [1.82421837]


portfolio before change:  [-1.07390363]
curr_Stock_Price:  108.31030804828431
curr_Factors:  [108.31030805]
mat_Sqrt:  [[0.15]]
grads:  [0.11589818]
Stock Position:  0.11589817874605578
Bond Position:  [-13.62687107]


portfolio before change:  [-1.09985017]
curr_Stock_Price:  108.09378319934915
curr_Factors:  [108.0937832]
mat_Sqrt:  [[0.15]]
grads:  [0.02607014]
Stock Position:  0.026070142688826743
Bond Position:  [-3.91787052]


portfolio before change:  [-1.10545078]
curr_Stock_Price:  107.88834764535954
curr_Factors:  [107.88834765]
mat_Sqrt:  [[0.15]]
grads:  [-0.01573979]
Stock Position:  -0.01573979304680166
Bond Position:  [0.59268948]


portfolio before change:  [-1.1054371]
curr_Stock_Price:  107.88983207382138
curr_Factors:  [107.88983207]
mat_Sqrt:  [[0.15]]
grads:  [0.03545711]
Stock Position:  0.035457111238804746
Bond Position:  [-4.93089888]


portfolio before change:  [-1.11219047]
curr_Stock_Price:  107.70805808095696
curr_Factors:  [107.70805808]
mat_Sqrt:  [[0.15]]
grads:  [0.02223869]
Stock Position:  0.022238693693602193
Bond Position:  [-3.50747698]


portfolio before change:  [-1.12148639]
curr_Stock_Price:  107.29990943886803
curr_Factors:  [107.29990944]
mat_Sqrt:  [[0.15]]
grads:  [-0.01756613]
Stock Position:  -0.01756613021037254
Bond Position:  [0.76335779]


portfolio before change:  [-1.12136624]
curr_Stock_Price:  107.29578578516522
curr_Factors:  [107.29578579]
mat_Sqrt:  [[0.15]]
grads:  [0.13303896]
Stock Position:  0.1330389583558043
Bond Position:  [-15.39588582]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.12136624]
Stock Price:  107.93189350835175
PL:  [-9.05325975]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.66309253e-02]
 [ 1.90716355e-03]
 [ 2.84664700e-04]
 [ 1.26993284e-03]
 [-9.54668057e-03]
 [ 7.37729261e-03]
 [ 7.75217287e-04]
 [-3.02764610e-03]
 [ 3.97742718e-03]
 [ 1.30677186e-02]
 [ 9.34630094e-03]
 [-1.17363479e-02]
 [ 1.43624840e-02]
 [ 6.92412029e-03]
 [-2.52475864e-02]
 [ 1.54712168e-02]
 [-2.79027494e-03]
 [ 1.53369020e-03]
 [ 1.15657326e-02]
 [ 9.43863068e-03]
 [ 6.30831299e-02]
 [-1.31620709e-02]
 [ 2.62385834e-03]
 [ 9.29750007e-03]
 [ 1.41590162e-02]
 [-5.11377559e-04]
 [ 1.29670029e-02]
 [ 4.56550539e-03]
 [ 5.40141994e-03]
 [-2.21420553e-02]
 [-5.34617023e-03]
 [ 1.42236775e-02]
 [ 1.33127377e-02]
 [ 1.53652282e-02]
 [ 2.92179617e-03]
 [ 5.78767153e-04]
 [-5.14942482e-03]
 [ 1.29511395e-02]
 [ 5.53569749e-04]
 [-8.71178722e-03]
 [-2.10900051e-02]
 [-2.58475559e-03]
 [ 8.74301117e-03]
 [-1.43199766e-02]
 [-5.07791212e-04]
 [ 2.41935142e-03]
 [-1.36048170e-02]
 [ 3.05517684e-03]
 [ 1.53866091e-02]
 [-6.77052776e-03]
 [-3.38443777e-03]
 [ 3.65601025e-03]
 [-5.15234412e-05]
 [-1.22771460e-03]
 [ 1.49163111e-03]
 [ 8.52731629e-03]
 [-6.55890084e-03]
 [-1.89380636e-02]
 [ 1.35022745e-02]
 [ 7.89635029e-03]
 [ 9.61530616e-03]
 [-1.35494991e-02]
 [-1.26893493e-02]
 [-2.98011480e-03]
 [-1.68429048e-02]
 [-1.13341687e-02]
 [ 2.49881293e-02]
 [ 2.16512121e-03]
 [ 6.15883241e-03]
 [-1.38169182e-02]
 [-7.99861477e-03]
 [-2.29089254e-03]
 [ 2.12787016e-03]
 [ 8.62123049e-03]
 [ 1.01460557e-02]
 [-8.64426023e-03]
 [-1.06906685e-03]
 [-6.61866714e-03]
 [ 1.32225303e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.85670844]
curr_Stock_Price:  99.61931486499783
curr_Factors:  [99.61931486]
mat_Sqrt:  [[0.15]]
grads:  [-0.24420617]
Stock Position:  -0.244206168458375
Bond Position:  [20.47094275]


portfolio before change:  [-3.82253576]
curr_Stock_Price:  99.48462043945364
curr_Factors:  [99.48462044]
mat_Sqrt:  [[0.15]]
grads:  [0.01271442]
Stock Position:  0.012714423662739796
Bond Position:  [-5.08742537]


portfolio before change:  [-3.81529584]
curr_Stock_Price:  100.07905479783318
curr_Factors:  [100.0790548]
mat_Sqrt:  [[0.15]]
grads:  [0.00189776]
Stock Position:  0.0018977646649083152
Bond Position:  [-4.00522234]


portfolio before change:  [-3.81657885]
curr_Stock_Price:  99.53490385382874
curr_Factors:  [99.53490385]
mat_Sqrt:  [[0.15]]
grads:  [0.00846622]
Stock Position:  0.00846621893868157
Bond Position:  [-4.65926313]


portfolio before change:  [-3.8203971]
curr_Stock_Price:  99.11830171535372
curr_Factors:  [99.11830172]
mat_Sqrt:  [[0.15]]
grads:  [-0.06364454]
Stock Position:  -0.06364453713164024
Bond Position:  [2.48794133]


portfolio before change:  [-3.80397876]
curr_Stock_Price:  98.86277550866998
curr_Factors:  [98.86277551]
mat_Sqrt:  [[0.15]]
grads:  [0.04918195]
Stock Position:  0.04918195074422723
Bond Position:  [-8.66624291]


portfolio before change:  [-3.82237197]
curr_Stock_Price:  98.49980582162256
curr_Factors:  [98.49980582]
mat_Sqrt:  [[0.15]]
grads:  [0.00516812]
Stock Position:  0.0051681152480198955
Bond Position:  [-4.33143032]


portfolio before change:  [-3.82605989]
curr_Stock_Price:  97.83859783888069
curr_Factors:  [97.83859784]
mat_Sqrt:  [[0.15]]
grads:  [-0.02018431]
Stock Position:  -0.020184307347746202
Bond Position:  [-1.85125556]


portfolio before change:  [-3.82333794]
curr_Stock_Price:  97.69801051487083
curr_Factors:  [97.69801051]
mat_Sqrt:  [[0.15]]
grads:  [0.02651618]
Stock Position:  0.02651618119657459
Bond Position:  [-6.41391609]


portfolio before change:  [-3.81588383]
curr_Stock_Price:  97.99424446315484
curr_Factors:  [97.99424446]
mat_Sqrt:  [[0.15]]
grads:  [0.08711812]
Stock Position:  0.08711812407381891
Bond Position:  [-12.35295858]


portfolio before change:  [-3.86323097]
curr_Stock_Price:  97.45962486165129
curr_Factors:  [97.45962486]
mat_Sqrt:  [[0.15]]
grads:  [0.06230867]
Stock Position:  0.06230867290960914
Bond Position:  [-9.93581086]


portfolio before change:  [-3.88689689]
curr_Stock_Price:  97.0897741553007
curr_Factors:  [97.08977416]
mat_Sqrt:  [[0.15]]
grads:  [-0.07824232]
Stock Position:  -0.07824231902714643
Bond Position:  [3.7096322]


portfolio before change:  [-3.8413211]
curr_Stock_Price:  96.51024217840187
curr_Factors:  [96.51024218]
mat_Sqrt:  [[0.15]]
grads:  [0.09574989]
Stock Position:  0.0957498934759541
Bond Position:  [-13.08216651]


portfolio before change:  [-3.77319088]
curr_Stock_Price:  97.23032529984735
curr_Factors:  [97.2303253]
mat_Sqrt:  [[0.15]]
grads:  [0.0461608]
Stock Position:  0.0461608019613547
Bond Position:  [-8.26142067]


portfolio before change:  [-3.76478867]
curr_Stock_Price:  97.42353173669625
curr_Factors:  [97.42353174]
mat_Sqrt:  [[0.15]]
grads:  [-0.16831724]
Stock Position:  -0.16831724236146578
Bond Position:  [12.63327153]


portfolio before change:  [-3.85507521]
curr_Stock_Price:  97.96462984358381
curr_Factors:  [97.96462984]
mat_Sqrt:  [[0.15]]
grads:  [0.10314145]
Stock Position:  0.10314144542322594
Bond Position:  [-13.95928873]


portfolio before change:  [-3.84259272]
curr_Stock_Price:  98.09411194777586
curr_Factors:  [98.09411195]
mat_Sqrt:  [[0.15]]
grads:  [-0.01860183]
Stock Position:  -0.01860183296423923
Bond Position:  [-2.01786243]


portfolio before change:  [-3.84298491]
curr_Stock_Price:  98.10841546863574
curr_Factors:  [98.10841547]
mat_Sqrt:  [[0.15]]
grads:  [0.0102246]
Stock Position:  0.010224601334311013
Bond Position:  [-4.84610435]


portfolio before change:  [-3.84009897]
curr_Stock_Price:  98.42029393093887
curr_Factors:  [98.42029393]
mat_Sqrt:  [[0.15]]
grads:  [0.07710488]
Stock Position:  0.07710488371781682
Bond Position:  [-11.42878429]


portfolio before change:  [-3.73968551]
curr_Stock_Price:  99.73185524798387
curr_Factors:  [99.73185525]
mat_Sqrt:  [[0.15]]
grads:  [0.0629242]
Stock Position:  0.06292420452203519
Bond Position:  [-10.01523316]


portfolio before change:  [-3.7311936]
curr_Stock_Price:  99.87675775632063
curr_Factors:  [99.87675776]
mat_Sqrt:  [[0.15]]
grads:  [0.4205542]
Stock Position:  0.42055419949224065
Bond Position:  [-45.73478351]


portfolio before change:  [-3.38059437]
curr_Stock_Price:  100.71721481970889
curr_Factors:  [100.71721482]
mat_Sqrt:  [[0.15]]
grads:  [-0.08774714]
Stock Position:  -0.0877471390041351
Bond Position:  [5.45705308]


portfolio before change:  [-3.39043688]
curr_Stock_Price:  100.83327092331328
curr_Factors:  [100.83327092]
mat_Sqrt:  [[0.15]]
grads:  [0.01749239]
Stock Position:  0.01749238892710352
Bond Position:  [-5.15425168]


portfolio before change:  [-3.39982835]
curr_Stock_Price:  100.31479895266268
curr_Factors:  [100.31479895]
mat_Sqrt:  [[0.15]]
grads:  [0.06198333]
Stock Position:  0.061983333832524676
Bond Position:  [-9.61767402]


portfolio before change:  [-3.39171784]
curr_Stock_Price:  100.45534692711426
curr_Factors:  [100.45534693]
mat_Sqrt:  [[0.15]]
grads:  [0.09439344]
Stock Position:  0.09439344159852446
Bond Position:  [-12.87404376]


portfolio before change:  [-3.35591257]
curr_Stock_Price:  100.8431908050339
curr_Factors:  [100.84319081]
mat_Sqrt:  [[0.15]]
grads:  [-0.00340918]
Stock Position:  -0.0034091837256209024
Bond Position:  [-3.01211961]


portfolio before change:  [-3.35544679]
curr_Stock_Price:  100.65134214560152
curr_Factors:  [100.65134215]
mat_Sqrt:  [[0.15]]
grads:  [0.08644669]
Stock Position:  0.08644668632577532
Bond Position:  [-12.05642179]


portfolio before change:  [-3.26998339]
curr_Stock_Price:  101.6486846471143
curr_Factors:  [101.64868465]
mat_Sqrt:  [[0.15]]
grads:  [0.0304367]
Stock Position:  0.030436702587098782
Bond Position:  [-6.36383417]


portfolio before change:  [-3.25665702]
curr_Stock_Price:  102.09959165363745
curr_Factors:  [102.09959165]
mat_Sqrt:  [[0.15]]
grads:  [0.03600947]
Stock Position:  0.03600946624536346
Bond Position:  [-6.93320882]


portfolio before change:  [-3.27018409]
curr_Stock_Price:  101.73597236957488
curr_Factors:  [101.73597237]
mat_Sqrt:  [[0.15]]
grads:  [-0.1476137]
Stock Position:  -0.14761370172385338
Bond Position:  [11.74743939]


portfolio before change:  [-3.2278918]
curr_Stock_Price:  101.45443988613816
curr_Factors:  [101.45443989]
mat_Sqrt:  [[0.15]]
grads:  [-0.03564113]
Stock Position:  -0.03564113483506691
Bond Position:  [0.38805957]


portfolio before change:  [-3.21158417]
curr_Stock_Price:  100.9975696069677
curr_Factors:  [100.99756961]
mat_Sqrt:  [[0.15]]
grads:  [0.09482452]
Stock Position:  0.09482451669186368
Bond Position:  [-12.7886299]


portfolio before change:  [-3.28303316]
curr_Stock_Price:  100.25251256740353
curr_Factors:  [100.25251257]
mat_Sqrt:  [[0.15]]
grads:  [0.08875158]
Stock Position:  0.08875158479677228
Bond Position:  [-12.18060253]


portfolio before change:  [-3.28247926]
curr_Stock_Price:  100.26733159758109
curr_Factors:  [100.2673316]
mat_Sqrt:  [[0.15]]
grads:  [0.10243485]
Stock Position:  0.1024348543895839
Bond Position:  [-13.55334877]


portfolio before change:  [-3.27742424]
curr_Stock_Price:  100.32495001233691
curr_Factors:  [100.32495001]
mat_Sqrt:  [[0.15]]
grads:  [0.01947864]
Stock Position:  0.019478641152787756
Bond Position:  [-5.23161794]


portfolio before change:  [-3.28306589]
curr_Stock_Price:  100.05210418758232
curr_Factors:  [100.05210419]
mat_Sqrt:  [[0.15]]
grads:  [0.00385845]
Stock Position:  0.003858447687299325
Bond Position:  [-3.6691117]


portfolio before change:  [-3.28151897]
curr_Stock_Price:  100.51245535168
curr_Factors:  [100.51245535]
mat_Sqrt:  [[0.15]]
grads:  [-0.0343295]
Stock Position:  -0.03432949880468019
Bond Position:  [0.16902324]


portfolio before change:  [-3.29817038]
curr_Stock_Price:  100.99780972636623
curr_Factors:  [100.99780973]
mat_Sqrt:  [[0.15]]
grads:  [0.08634093]
Stock Position:  0.08634092994999015
Bond Position:  [-12.0184152]


portfolio before change:  [-3.25354052]
curr_Stock_Price:  101.5234125946104
curr_Factors:  [101.52341259]
mat_Sqrt:  [[0.15]]
grads:  [0.00369046]
Stock Position:  0.0036904649948116697
Bond Position:  [-3.62820912]


portfolio before change:  [-3.25135995]
curr_Stock_Price:  102.17572414413642
curr_Factors:  [102.17572414]
mat_Sqrt:  [[0.15]]
grads:  [-0.05807858]
Stock Position:  -0.058078581471269375
Bond Position:  [2.68286117]


portfolio before change:  [-3.22568392]
curr_Stock_Price:  101.73652010675907
curr_Factors:  [101.73652011]
mat_Sqrt:  [[0.15]]
grads:  [-0.14060003]
Stock Position:  -0.1406000342605948
Bond Position:  [11.07847429]


portfolio before change:  [-3.1942768]
curr_Stock_Price:  101.5180656855955
curr_Factors:  [101.51806569]
mat_Sqrt:  [[0.15]]
grads:  [-0.0172317]
Stock Position:  -0.017231703946120794
Bond Position:  [-1.44494754]


portfolio before change:  [-3.18522596]
curr_Stock_Price:  100.98758132167278
curr_Factors:  [100.98758132]
mat_Sqrt:  [[0.15]]
grads:  [0.05828674]
Stock Position:  0.058286741153753506
Bond Position:  [-9.07146297]


portfolio before change:  [-3.17789265]
curr_Stock_Price:  101.12312317375165
curr_Factors:  [101.12312317]
mat_Sqrt:  [[0.15]]
grads:  [-0.09546651]
Stock Position:  -0.09546651053887827
Bond Position:  [6.47597905]


portfolio before change:  [-3.32978679]
curr_Stock_Price:  102.7184354994677
curr_Factors:  [102.7184355]
mat_Sqrt:  [[0.15]]
grads:  [-0.00338527]
Stock Position:  -0.003385274743842474
Bond Position:  [-2.98205666]


portfolio before change:  [-3.33126319]
curr_Stock_Price:  103.09950227779915
curr_Factors:  [103.09950228]
mat_Sqrt:  [[0.15]]
grads:  [0.01612901]
Stock Position:  0.0161290094925168
Bond Position:  [-4.99415604]


portfolio before change:  [-3.31768769]
curr_Stock_Price:  103.96053734279596
curr_Factors:  [103.96053734]
mat_Sqrt:  [[0.15]]
grads:  [-0.09069878]
Stock Position:  -0.0906987798535462
Bond Position:  [6.1114062]


portfolio before change:  [-3.2312972]
curr_Stock_Price:  103.01224989267463
curr_Factors:  [103.01224989]
mat_Sqrt:  [[0.15]]
grads:  [0.02036785]
Stock Position:  0.02036784557714965
Bond Position:  [-5.3294348]


portfolio before change:  [-3.20599834]
curr_Stock_Price:  104.27070200576335
curr_Factors:  [104.27070201]
mat_Sqrt:  [[0.15]]
grads:  [0.10257739]
Stock Position:  0.10257739410549813
Bond Position:  [-13.90181524]


portfolio before change:  [-3.35636624]
curr_Stock_Price:  102.8132756081233
curr_Factors:  [102.81327561]
mat_Sqrt:  [[0.15]]
grads:  [-0.04513685]
Stock Position:  -0.045136851748507345
Bond Position:  [1.28430134]


portfolio before change:  [-3.34939367]
curr_Stock_Price:  102.66057784135036
curr_Factors:  [102.66057784]
mat_Sqrt:  [[0.15]]
grads:  [-0.02256292]
Stock Position:  -0.02256291849634054
Bond Position:  [-1.03307142]


portfolio before change:  [-3.33907124]
curr_Stock_Price:  102.20022085989235
curr_Factors:  [102.20022086]
mat_Sqrt:  [[0.15]]
grads:  [0.0243734]
Stock Position:  0.024373401683125566
Bond Position:  [-5.83003828]


portfolio before change:  [-3.36408271]
curr_Stock_Price:  101.18899237620134
curr_Factors:  [101.18899238]
mat_Sqrt:  [[0.15]]
grads:  [-0.00034349]
Stock Position:  -0.0003434896079612353
Bond Position:  [-3.32932534]


portfolio before change:  [-3.36407823]
curr_Stock_Price:  100.57015525421556
curr_Factors:  [100.57015525]
mat_Sqrt:  [[0.15]]
grads:  [-0.00818476]
Stock Position:  -0.008184764009227326
Bond Position:  [-2.54093525]


portfolio before change:  [-3.37113663]
curr_Stock_Price:  101.41313412954152
curr_Factors:  [101.41313413]
mat_Sqrt:  [[0.15]]
grads:  [0.00994421]
Stock Position:  0.009944207388894082
Bond Position:  [-4.37960987]


portfolio before change:  [-3.37101795]
curr_Stock_Price:  101.4525956723076
curr_Factors:  [101.45259567]
mat_Sqrt:  [[0.15]]
grads:  [0.05684878]
Stock Position:  0.05684877525398276
Bond Position:  [-9.13847376]


portfolio before change:  [-3.37451381]
curr_Stock_Price:  101.40114888572833
curr_Factors:  [101.40114889]
mat_Sqrt:  [[0.15]]
grads:  [-0.04372601]
Stock Position:  -0.043726005567633876
Bond Position:  [1.05935339]


portfolio before change:  [-3.36123254]
curr_Stock_Price:  101.09892473606497
curr_Factors:  [101.09892474]
mat_Sqrt:  [[0.15]]
grads:  [-0.12625376]
Stock Position:  -0.1262537576122734
Bond Position:  [9.4028866]


portfolio before change:  [-3.33048929]
curr_Stock_Price:  100.8600760098768
curr_Factors:  [100.86007601]
mat_Sqrt:  [[0.15]]
grads:  [0.09001516]
Stock Position:  0.0900151635875506
Bond Position:  [-12.40942554]


portfolio before change:  [-3.34633672]
curr_Stock_Price:  100.69263966460572
curr_Factors:  [100.69263966]
mat_Sqrt:  [[0.15]]
grads:  [0.05264234]
Stock Position:  0.052642335254895825
Bond Position:  [-8.64703241]


portfolio before change:  [-3.32937735]
curr_Stock_Price:  101.02506836099
curr_Factors:  [101.02506836]
mat_Sqrt:  [[0.15]]
grads:  [0.06410204]
Stock Position:  0.0641020410937361
Bond Position:  [-9.80529043]


portfolio before change:  [-3.29424784]
curr_Stock_Price:  101.58265377194554
curr_Factors:  [101.58265377]
mat_Sqrt:  [[0.15]]
grads:  [-0.09032999]
Stock Position:  -0.09032999388180575
Bond Position:  [5.88171266]


portfolio before change:  [-3.35687456]
curr_Stock_Price:  102.28003387578156
curr_Factors:  [102.28003388]
mat_Sqrt:  [[0.15]]
grads:  [-0.08459566]
Stock Position:  -0.08459566230871568
Bond Position:  [5.29557265]


portfolio before change:  [-3.34421629]
curr_Stock_Price:  102.13431377372916
curr_Factors:  [102.13431377]
mat_Sqrt:  [[0.15]]
grads:  [-0.01986743]
Stock Position:  -0.019867431982317538
Bond Position:  [-1.31506976]


portfolio before change:  [-3.34134754]
curr_Stock_Price:  101.98578218037729
curr_Factors:  [101.98578218]
mat_Sqrt:  [[0.15]]
grads:  [-0.11228603]
Stock Position:  -0.1122860320284131
Bond Position:  [8.11023126]


portfolio before change:  [-3.42498723]
curr_Stock_Price:  102.73517723423423
curr_Factors:  [102.73517723]
mat_Sqrt:  [[0.15]]
grads:  [-0.07556112]
Stock Position:  -0.0755611248278367
Bond Position:  [4.33779832]


portfolio before change:  [-3.32942822]
curr_Stock_Price:  101.47410685357666
curr_Factors:  [101.47410685]
mat_Sqrt:  [[0.15]]
grads:  [0.16658753]
Stock Position:  0.16658752868202004
Bond Position:  [-20.2337489]


portfolio before change:  [-3.45693549]
curr_Stock_Price:  100.716291283286
curr_Factors:  [100.71629128]
mat_Sqrt:  [[0.15]]
grads:  [0.01443414]
Stock Position:  0.014434141404657146
Bond Position:  [-4.91068868]


portfolio before change:  [-3.45189546]
curr_Stock_Price:  101.08672913904749
curr_Factors:  [101.08672914]
mat_Sqrt:  [[0.15]]
grads:  [0.04105888]
Stock Position:  0.041058882760447384
Bond Position:  [-7.60240362]


portfolio before change:  [-3.41835013]
curr_Stock_Price:  101.91530742507308
curr_Factors:  [101.91530743]
mat_Sqrt:  [[0.15]]
grads:  [-0.09211279]
Stock Position:  -0.09211278805373112
Bond Position:  [5.96935298]


portfolio before change:  [-3.42334787]
curr_Stock_Price:  101.97361456216744
curr_Factors:  [101.97361456]
mat_Sqrt:  [[0.15]]
grads:  [-0.0533241]
Stock Position:  -0.05332409845898024
Bond Position:  [2.0143032]


portfolio before change:  [-3.3519392]
curr_Stock_Price:  100.63683115736376
curr_Factors:  [100.63683116]
mat_Sqrt:  [[0.15]]
grads:  [-0.01527262]
Stock Position:  -0.015272616935039571
Bond Position:  [-1.81495143]


portfolio before change:  [-3.34688277]
curr_Stock_Price:  100.29832557624201
curr_Factors:  [100.29832558]
mat_Sqrt:  [[0.15]]
grads:  [0.0141858]
Stock Position:  0.01418580108529888
Bond Position:  [-4.76969487]


portfolio before change:  [-3.34193912]
curr_Stock_Price:  100.66783338981176
curr_Factors:  [100.66783339]
mat_Sqrt:  [[0.15]]
grads:  [0.05747487]
Stock Position:  0.05747486992292789
Bond Position:  [-9.12780975]


portfolio before change:  [-3.35503643]
curr_Stock_Price:  100.44988061541873
curr_Factors:  [100.44988062]
mat_Sqrt:  [[0.15]]
grads:  [0.06764037]
Stock Position:  0.06764037156774243
Bond Position:  [-10.14950368]


portfolio before change:  [-3.36923251]
curr_Stock_Price:  100.24938335151796
curr_Factors:  [100.24938335]
mat_Sqrt:  [[0.15]]
grads:  [-0.0576284]
Stock Position:  -0.057628401521766494
Bond Position:  [2.40797921]


portfolio before change:  [-3.37459407]
curr_Stock_Price:  100.34503174603992
curr_Factors:  [100.34503175]
mat_Sqrt:  [[0.15]]
grads:  [-0.00712711]
Stock Position:  -0.007127112318827007
Bond Position:  [-2.65942376]


portfolio before change:  [-3.38193029]
curr_Stock_Price:  101.35104996304791
curr_Factors:  [101.35104996]
mat_Sqrt:  [[0.15]]
grads:  [-0.04412445]
Stock Position:  -0.04412444758048301
Bond Position:  [1.0901288]


portfolio before change:  [-3.38829917]
curr_Stock_Price:  101.49693308303665
curr_Factors:  [101.49693308]
mat_Sqrt:  [[0.15]]
grads:  [0.0881502]
Stock Position:  0.08815020169727168
Bond Position:  [-12.33527429]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.38829917]
Stock Price:  101.92138123435687
PL:  [-5.3096804]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.33922660e-02]
 [ 3.51018670e-04]
 [ 8.56357315e-04]
 [ 3.13195851e-03]
 [ 4.82676469e-03]
 [ 1.19796860e-02]
 [ 7.66817152e-04]
 [ 1.14331232e-02]
 [ 4.89242894e-03]
 [-1.89541402e-02]
 [ 7.26884177e-03]
 [-5.12199600e-03]
 [-8.33242806e-03]
 [ 4.31689357e-03]
 [ 5.32456092e-03]
 [-7.73917157e-03]
 [ 1.41480744e-02]
 [ 1.08901715e-02]
 [ 2.12975875e-02]
 [ 6.63507756e-03]
 [ 5.57464002e-02]
 [-1.85103599e-02]
 [-5.94739228e-04]
 [ 5.32657796e-03]
 [-3.31884438e-03]
 [ 1.52055230e-02]
 [ 1.55897642e-02]
 [-1.52489246e-02]
 [ 2.44168132e-03]
 [-1.25176493e-02]
 [-3.62664340e-03]
 [-2.14401113e-02]
 [ 1.83158725e-02]
 [ 1.19063607e-02]
 [-1.93351310e-02]
 [ 7.74795684e-03]
 [-2.00294265e-03]
 [ 6.53297629e-03]
 [ 3.15472749e-03]
 [-1.40060693e-02]
 [-1.98501423e-03]
 [-2.82266988e-03]
 [ 8.35156262e-03]
 [-1.08274305e-02]
 [ 2.30346250e-03]
 [-3.18010740e-03]
 [-1.36996902e-02]
 [-5.04539637e-03]
 [-7.53571437e-04]
 [ 8.96383540e-03]
 [-2.97922664e-03]
 [ 3.80107962e-03]
 [ 8.83589734e-04]
 [-2.15692948e-03]
 [ 2.29253518e-03]
 [ 8.64516135e-03]
 [-2.73310429e-03]
 [-1.90322942e-02]
 [ 1.34472553e-02]
 [ 3.00002128e-03]
 [ 9.97839501e-03]
 [-1.34446630e-02]
 [-1.26336548e-02]
 [-2.86524989e-03]
 [-1.73808688e-02]
 [ 1.27922753e-02]
 [ 2.53213253e-02]
 [ 1.89149123e-03]
 [ 6.99738834e-03]
 [-1.40844069e-02]
 [-8.15520569e-03]
 [-7.85382674e-03]
 [ 1.62183351e-03]
 [ 7.84384092e-03]
 [ 1.73831207e-03]
 [-1.13929005e-02]
 [ 5.69328103e-03]
 [-5.09552067e-03]
 [ 2.12367953e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.78482571]
curr_Stock_Price:  100.23898262463129
curr_Factors:  [100.23898262]
mat_Sqrt:  [[0.15]]
grads:  [-0.28928177]
Stock Position:  -0.28928177352215156
Bond Position:  [34.78213638]


portfolio before change:  [5.95291772]
curr_Stock_Price:  99.66543090654578
curr_Factors:  [99.66543091]
mat_Sqrt:  [[0.15]]
grads:  [0.00234012]
Stock Position:  0.0023401244659055753
Bond Position:  [5.71968821]


portfolio before change:  [5.95576403]
curr_Stock_Price:  100.72897248570058
curr_Factors:  [100.72897249]
mat_Sqrt:  [[0.15]]
grads:  [0.00570905]
Stock Position:  0.00570904876944783
Bond Position:  [5.38069742]


portfolio before change:  [5.96105128]
curr_Stock_Price:  101.5961815600678
curr_Factors:  [101.59618156]
mat_Sqrt:  [[0.15]]
grads:  [0.02087972]
Stock Position:  0.020879723401493012
Bond Position:  [3.83975111]


portfolio before change:  [5.94790074]
curr_Stock_Price:  100.95486447975092
curr_Factors:  [100.95486448]
mat_Sqrt:  [[0.15]]
grads:  [0.03217843]
Stock Position:  0.032178431238404824
Bond Position:  [2.69933158]


portfolio before change:  [5.95280653]
curr_Stock_Price:  101.10207703187206
curr_Factors:  [101.10207703]
mat_Sqrt:  [[0.15]]
grads:  [0.07986457]
Stock Position:  0.07986457334916057
Bond Position:  [-2.12166772]


portfolio before change:  [5.9270315]
curr_Stock_Price:  100.78100333222933
curr_Factors:  [100.78100333]
mat_Sqrt:  [[0.15]]
grads:  [0.00511211]
Stock Position:  0.0051121143464118194
Bond Position:  [5.41182749]


portfolio before change:  [5.92257439]
curr_Stock_Price:  99.84296347619556
curr_Factors:  [99.84296348]
mat_Sqrt:  [[0.15]]
grads:  [0.07622082]
Stock Position:  0.07622082129309887
Bond Position:  [-1.68753829]


portfolio before change:  [5.96898489]
curr_Stock_Price:  100.4532425941634
curr_Factors:  [100.45324259]
mat_Sqrt:  [[0.15]]
grads:  [0.03261619]
Stock Position:  0.03261619293907397
Bond Position:  [2.69258255]


portfolio before change:  [5.96012457]
curr_Stock_Price:  100.17642895519216
curr_Factors:  [100.17642896]
mat_Sqrt:  [[0.15]]
grads:  [-0.12636093]
Stock Position:  -0.12636093468012236
Bond Position:  [18.61851177]


portfolio before change:  [6.02930356]
curr_Stock_Price:  99.63816693847589
curr_Factors:  [99.63816694]
mat_Sqrt:  [[0.15]]
grads:  [0.04845895]
Stock Position:  0.048458945135331534
Bond Position:  [1.20094309]


portfolio before change:  [6.03355074]
curr_Stock_Price:  99.72426289919132
curr_Factors:  [99.7242629]
mat_Sqrt:  [[0.15]]
grads:  [-0.03414664]
Stock Position:  -0.03414663998603031
Bond Position:  [9.43879924]


portfolio before change:  [6.02042104]
curr_Stock_Price:  100.12604892360594
curr_Factors:  [100.12604892]
mat_Sqrt:  [[0.15]]
grads:  [-0.05554952]
Stock Position:  -0.055549520379908485
Bond Position:  [11.58237503]


portfolio before change:  [6.04842002]
curr_Stock_Price:  99.63504451297374
curr_Factors:  [99.63504451]
mat_Sqrt:  [[0.15]]
grads:  [0.02877929]
Stock Position:  0.02877929048438437
Bond Position:  [3.18099413]


portfolio before change:  [6.06405738]
curr_Stock_Price:  100.17149057496849
curr_Factors:  [100.17149057]
mat_Sqrt:  [[0.15]]
grads:  [0.03549707]
Stock Position:  0.03549707277690588
Bond Position:  [2.50826268]


portfolio before change:  [6.08300185]
curr_Stock_Price:  100.70076521853723
curr_Factors:  [100.70076522]
mat_Sqrt:  [[0.15]]
grads:  [-0.05159448]
Stock Position:  -0.051594477107735785
Bond Position:  [11.27860517]


portfolio before change:  [6.08857286]
curr_Stock_Price:  100.60645128616899
curr_Factors:  [100.60645129]
mat_Sqrt:  [[0.15]]
grads:  [0.0943205]
Stock Position:  0.09432049577843278
Bond Position:  [-3.4006775]


portfolio before change:  [6.0440967]
curr_Stock_Price:  100.13716183325226
curr_Factors:  [100.13716183]
mat_Sqrt:  [[0.15]]
grads:  [0.07260114]
Stock Position:  0.07260114344559074
Bond Position:  [-1.22597575]


portfolio before change:  [6.08716217]
curr_Stock_Price:  100.73139620726559
curr_Factors:  [100.73139621]
mat_Sqrt:  [[0.15]]
grads:  [0.14198392]
Stock Position:  0.14198391653743225
Bond Position:  [-8.21507599]


portfolio before change:  [5.98849109]
curr_Stock_Price:  100.04006704359261
curr_Factors:  [100.04006704]
mat_Sqrt:  [[0.15]]
grads:  [0.04423385]
Stock Position:  0.04423385041542737
Bond Position:  [1.56333373]


portfolio before change:  [5.95786052]
curr_Stock_Price:  99.34538907754998
curr_Factors:  [99.34538908]
mat_Sqrt:  [[0.15]]
grads:  [0.37164267]
Stock Position:  0.3716426677222771
Bond Position:  [-30.96312491]


portfolio before change:  [5.7194922]
curr_Stock_Price:  98.7092052463458
curr_Factors:  [98.70920525]
mat_Sqrt:  [[0.15]]
grads:  [-0.1234024]
Stock Position:  -0.12340239906126434
Bond Position:  [17.90044494]


portfolio before change:  [5.81187111]
curr_Stock_Price:  97.96967268532659
curr_Factors:  [97.96967269]
mat_Sqrt:  [[0.15]]
grads:  [-0.00396493]
Stock Position:  -0.003964928189012588
Bond Position:  [6.20031383]


portfolio before change:  [5.81458927]
curr_Stock_Price:  97.38186140652351
curr_Factors:  [97.38186141]
mat_Sqrt:  [[0.15]]
grads:  [0.03551052]
Stock Position:  0.03551051972125127
Bond Position:  [2.35650876]


portfolio before change:  [5.80248829]
curr_Stock_Price:  97.03694209681161
curr_Factors:  [97.0369421]
mat_Sqrt:  [[0.15]]
grads:  [-0.02212563]
Stock Position:  -0.022125629198958097
Bond Position:  [7.94949169]


portfolio before change:  [5.78996126]
curr_Stock_Price:  97.62557570645723
curr_Factors:  [97.62557571]
mat_Sqrt:  [[0.15]]
grads:  [0.10137015]
Stock Position:  0.10137015346341677
Bond Position:  [-4.10635833]


portfolio before change:  [5.75889113]
curr_Stock_Price:  97.32160581148284
curr_Factors:  [97.32160581]
mat_Sqrt:  [[0.15]]
grads:  [0.10393176]
Stock Position:  0.10393176149931285
Bond Position:  [-4.35591479]


portfolio before change:  [5.88064446]
curr_Stock_Price:  98.4956990742006
curr_Factors:  [98.49569907]
mat_Sqrt:  [[0.15]]
grads:  [-0.1016595]
Stock Position:  -0.10165949747965099
Bond Position:  [15.89366773]


portfolio before change:  [5.80538941]
curr_Stock_Price:  99.24573661688108
curr_Factors:  [99.24573662]
mat_Sqrt:  [[0.15]]
grads:  [0.01627788]
Stock Position:  0.016277875466438243
Bond Position:  [4.18987966]


portfolio before change:  [5.80118547]
curr_Stock_Price:  98.97138827524817
curr_Factors:  [98.97138828]
mat_Sqrt:  [[0.15]]
grads:  [-0.083451]
Stock Position:  -0.0834509954956352
Bond Position:  [14.06044635]


portfolio before change:  [5.87010529]
curr_Stock_Price:  98.15604737510257
curr_Factors:  [98.15604738]
mat_Sqrt:  [[0.15]]
grads:  [-0.02417762]
Stock Position:  -0.02417762264105224
Bond Position:  [8.24328516]


portfolio before change:  [5.88825964]
curr_Stock_Price:  97.42648300365087
curr_Factors:  [97.426483]
mat_Sqrt:  [[0.15]]
grads:  [-0.14293408]
Stock Position:  -0.14293407557297708
Bond Position:  [19.81382393]


portfolio before change:  [5.83950851]
curr_Stock_Price:  97.77622143692447
curr_Factors:  [97.77622144]
mat_Sqrt:  [[0.15]]
grads:  [0.12210582]
Stock Position:  0.12210581679269139
Bond Position:  [-6.09953688]


portfolio before change:  [5.85433136]
curr_Stock_Price:  97.90073710603224
curr_Factors:  [97.90073711]
mat_Sqrt:  [[0.15]]
grads:  [0.07937574]
Stock Position:  0.07937573816300689
Bond Position:  [-1.91661191]


portfolio before change:  [5.85142471]
curr_Stock_Price:  97.86562741627787
curr_Factors:  [97.86562742]
mat_Sqrt:  [[0.15]]
grads:  [-0.12890087]
Stock Position:  -0.12890087344741985
Bond Position:  [18.46638956]


portfolio before change:  [5.89069639]
curr_Stock_Price:  97.56991570389107
curr_Factors:  [97.5699157]
mat_Sqrt:  [[0.15]]
grads:  [0.05165305]
Stock Position:  0.05165304560140991
Bond Position:  [0.85091309]


portfolio before change:  [5.84112296]
curr_Stock_Price:  96.60914729255671
curr_Factors:  [96.60914729]
mat_Sqrt:  [[0.15]]
grads:  [-0.01335295]
Stock Position:  -0.013352951027769962
Bond Position:  [7.13114018]


portfolio before change:  [5.82204356]
curr_Stock_Price:  98.07137905464688
curr_Factors:  [98.07137905]
mat_Sqrt:  [[0.15]]
grads:  [0.04355318]
Stock Position:  0.04355317524771454
Bond Position:  [1.55072361]


portfolio before change:  [5.83287062]
curr_Stock_Price:  98.31774766654353
curr_Factors:  [98.31774767]
mat_Sqrt:  [[0.15]]
grads:  [0.02103152]
Stock Position:  0.021031516584057924
Bond Position:  [3.76509928]


portfolio before change:  [5.84282511]
curr_Stock_Price:  98.77987143579047
curr_Factors:  [98.77987144]
mat_Sqrt:  [[0.15]]
grads:  [-0.0933738]
Stock Position:  -0.09337379501516589
Bond Position:  [15.06627658]


portfolio before change:  [5.77153108]
curr_Stock_Price:  99.55349002201807
curr_Factors:  [99.55349002]
mat_Sqrt:  [[0.15]]
grads:  [-0.01323343]
Stock Position:  -0.013233428201430211
Bond Position:  [7.08896504]


portfolio before change:  [5.77051078]
curr_Stock_Price:  99.6640718043124
curr_Factors:  [99.6640718]
mat_Sqrt:  [[0.15]]
grads:  [-0.0188178]
Stock Position:  -0.018817799208734824
Bond Position:  [7.64596927]


portfolio before change:  [5.74896272]
curr_Stock_Price:  100.83455634365463
curr_Factors:  [100.83455634]
mat_Sqrt:  [[0.15]]
grads:  [0.05567708]
Stock Position:  0.055677084152082466
Bond Position:  [0.13478864]


portfolio before change:  [5.69074572]
curr_Stock_Price:  99.78878636356932
curr_Factors:  [99.78878636]
mat_Sqrt:  [[0.15]]
grads:  [-0.07218287]
Stock Position:  -0.0721828699204706
Bond Position:  [12.89378671]


portfolio before change:  [5.75140564]
curr_Stock_Price:  98.95958642731922
curr_Factors:  [98.95958643]
mat_Sqrt:  [[0.15]]
grads:  [0.01535642]
Stock Position:  0.015356416635460078
Bond Position:  [4.231741]


portfolio before change:  [5.75230636]
curr_Stock_Price:  99.00101688427912
curr_Factors:  [99.00101688]
mat_Sqrt:  [[0.15]]
grads:  [-0.02120072]
Stock Position:  -0.021200715980098876
Bond Position:  [7.8511988]


portfolio before change:  [5.7301038]
curr_Stock_Price:  100.07141800611673
curr_Factors:  [100.07141801]
mat_Sqrt:  [[0.15]]
grads:  [-0.09133127]
Stock Position:  -0.09133126813022496
Bond Position:  [14.86975331]


portfolio before change:  [5.73328722]
curr_Stock_Price:  100.04673831023932
curr_Factors:  [100.04673831]
mat_Sqrt:  [[0.15]]
grads:  [-0.03363598]
Stock Position:  -0.0336359757811496
Bond Position:  [9.09845689]


portfolio before change:  [5.72271909]
curr_Stock_Price:  100.37783623065057
curr_Factors:  [100.37783623]
mat_Sqrt:  [[0.15]]
grads:  [-0.00502381]
Stock Position:  -0.005023809580770124
Bond Position:  [6.22699823]


portfolio before change:  [5.72431055]
curr_Stock_Price:  100.13852414433028
curr_Factors:  [100.13852414]
mat_Sqrt:  [[0.15]]
grads:  [0.0597589]
Stock Position:  0.05975890268451037
Bond Position:  [-0.25985777]


portfolio before change:  [5.75168443]
curr_Stock_Price:  100.59686801132027
curr_Factors:  [100.59686801]
mat_Sqrt:  [[0.15]]
grads:  [-0.01986151]
Stock Position:  -0.01986151092278271
Bond Position:  [7.74969023]


portfolio before change:  [5.7459513]
curr_Stock_Price:  100.90991090903353
curr_Factors:  [100.90991091]
mat_Sqrt:  [[0.15]]
grads:  [0.02534053]
Stock Position:  0.025340530800183454
Bond Position:  [3.18884059]


portfolio before change:  [5.73202065]
curr_Stock_Price:  100.35230792826633
curr_Factors:  [100.35230793]
mat_Sqrt:  [[0.15]]
grads:  [0.0058906]
Stock Position:  0.0058905982248480615
Bond Position:  [5.14088552]


portfolio before change:  [5.73082938]
curr_Stock_Price:  100.09552742647865
curr_Factors:  [100.09552743]
mat_Sqrt:  [[0.15]]
grads:  [-0.01437953]
Stock Position:  -0.014379529874682362
Bond Position:  [7.170156]


portfolio before change:  [5.72619184]
curr_Stock_Price:  100.44920272893053
curr_Factors:  [100.44920273]
mat_Sqrt:  [[0.15]]
grads:  [0.01528357]
Stock Position:  0.015283567853093837
Bond Position:  [4.19096963]


portfolio before change:  [5.72488085]
curr_Stock_Price:  100.34628619399294
curr_Factors:  [100.34628619]
mat_Sqrt:  [[0.15]]
grads:  [0.05763441]
Stock Position:  0.05763440900908729
Bond Position:  [-0.05851805]


portfolio before change:  [5.75908482]
curr_Stock_Price:  100.93981397216112
curr_Factors:  [100.93981397]
mat_Sqrt:  [[0.15]]
grads:  [-0.0182207]
Stock Position:  -0.01822069527288324
Bond Position:  [7.59827841]


portfolio before change:  [5.75703093]
curr_Stock_Price:  101.07860102940533
curr_Factors:  [101.07860103]
mat_Sqrt:  [[0.15]]
grads:  [-0.12688196]
Stock Position:  -0.12688196158703693
Bond Position:  [18.5820821]


portfolio before change:  [5.65378709]
curr_Stock_Price:  101.90145445792406
curr_Factors:  [101.90145446]
mat_Sqrt:  [[0.15]]
grads:  [0.08964837]
Stock Position:  0.08964836846833044
Bond Position:  [-3.48151205]


portfolio before change:  [5.71363298]
curr_Stock_Price:  102.57144423426755
curr_Factors:  [102.57144423]
mat_Sqrt:  [[0.15]]
grads:  [0.02000014]
Stock Position:  0.020000141883263028
Bond Position:  [3.66218954]


portfolio before change:  [5.69330935]
curr_Stock_Price:  101.54382573686081
curr_Factors:  [101.54382574]
mat_Sqrt:  [[0.15]]
grads:  [0.06652263]
Stock Position:  0.06652263339302678
Bond Position:  [-1.06165334]


portfolio before change:  [5.6880437]
curr_Stock_Price:  101.46566735096877
curr_Factors:  [101.46566735]
mat_Sqrt:  [[0.15]]
grads:  [-0.08963109]
Stock Position:  -0.0896310869945639
Bond Position:  [14.78252176]


portfolio before change:  [5.6702316]
curr_Stock_Price:  101.67470232998204
curr_Factors:  [101.67470233]
mat_Sqrt:  [[0.15]]
grads:  [-0.08422437]
Stock Position:  -0.08422436563633591
Bond Position:  [14.23371891]


portfolio before change:  [5.65700156]
curr_Stock_Price:  101.84234599031038
curr_Factors:  [101.84234599]
mat_Sqrt:  [[0.15]]
grads:  [-0.01910167]
Stock Position:  -0.019101665904340804
Bond Position:  [7.60236002]


portfolio before change:  [5.66170513]
curr_Stock_Price:  101.62098248750279
curr_Factors:  [101.62098249]
mat_Sqrt:  [[0.15]]
grads:  [-0.11587246]
Stock Position:  -0.11587245841692809
Bond Position:  [17.4367782]


portfolio before change:  [5.67637064]
curr_Stock_Price:  101.5038219925747
curr_Factors:  [101.50382199]
mat_Sqrt:  [[0.15]]
grads:  [0.08528184]
Stock Position:  0.08528183555753646
Bond Position:  [-2.98006162]


portfolio before change:  [5.67833707]
curr_Stock_Price:  101.52906403643924
curr_Factors:  [101.52906404]
mat_Sqrt:  [[0.15]]
grads:  [0.16880884]
Stock Position:  0.16880883563720633
Bond Position:  [-11.46066602]


portfolio before change:  [5.63066858]
curr_Stock_Price:  101.25092594583086
curr_Factors:  [101.25092595]
mat_Sqrt:  [[0.15]]
grads:  [0.01260994]
Stock Position:  0.012609941520370834
Bond Position:  [4.35390033]


portfolio before change:  [5.64401038]
curr_Stock_Price:  102.28738336190459
curr_Factors:  [102.28738336]
mat_Sqrt:  [[0.15]]
grads:  [0.04664926]
Stock Position:  0.046649255601019346
Bond Position:  [0.87238009]


portfolio before change:  [5.63607511]
curr_Stock_Price:  102.11610957072074
curr_Factors:  [102.11610957]
mat_Sqrt:  [[0.15]]
grads:  [-0.09389605]
Stock Position:  -0.09389604593340937
Bond Position:  [15.22437402]


portfolio before change:  [5.67431476]
curr_Stock_Price:  101.71898845847188
curr_Factors:  [101.71898846]
mat_Sqrt:  [[0.15]]
grads:  [-0.05436804]
Stock Position:  -0.054368037949185204
Bond Position:  [11.20457659]


portfolio before change:  [5.65247775]
curr_Stock_Price:  102.13352103339763
curr_Factors:  [102.13352103]
mat_Sqrt:  [[0.15]]
grads:  [-0.05235884]
Stock Position:  -0.05235884490829949
Bond Position:  [11.00007094]


portfolio before change:  [5.65050546]
curr_Stock_Price:  102.18432073622206
curr_Factors:  [102.18432074]
mat_Sqrt:  [[0.15]]
grads:  [0.01081222]
Stock Position:  0.010812223378292407
Bond Position:  [4.54566576]


portfolio before change:  [5.65386562]
curr_Stock_Price:  102.46881768856616
curr_Factors:  [102.46881769]
mat_Sqrt:  [[0.15]]
grads:  [0.05229227]
Stock Position:  0.05229227279169964
Bond Position:  [0.29553825]


portfolio before change:  [5.63913306]
curr_Stock_Price:  102.18672950532127
curr_Factors:  [102.18672951]
mat_Sqrt:  [[0.15]]
grads:  [0.01158875]
Stock Position:  0.011588747162896583
Bond Position:  [4.45491689]


portfolio before change:  [5.64916509]
curr_Stock_Price:  103.02837275443211
curr_Factors:  [103.02837275]
mat_Sqrt:  [[0.15]]
grads:  [-0.07595267]
Stock Position:  -0.07595267028431774
Bond Position:  [13.47444512]


portfolio before change:  [5.68363418]
curr_Stock_Price:  102.58563769428201
curr_Factors:  [102.58563769]
mat_Sqrt:  [[0.15]]
grads:  [0.03795521]
Stock Position:  0.03795520687722781
Bond Position:  [1.78997508]


portfolio before change:  [5.66573111]
curr_Stock_Price:  102.11100073255122
curr_Factors:  [102.11100073]
mat_Sqrt:  [[0.15]]
grads:  [-0.03397014]
Stock Position:  -0.03397013777717179
Bond Position:  [9.13445588]


portfolio before change:  [5.64114744]
curr_Stock_Price:  102.85149198341729
curr_Factors:  [102.85149198]
mat_Sqrt:  [[0.15]]
grads:  [0.14157864]
Stock Position:  0.14157863504296275
Bond Position:  [-8.9204264]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.64114744]
Stock Price:  102.69098042670264
PL:  [2.95016702]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.93343466e-02]
 [ 7.08081279e-03]
 [-1.06078471e-03]
 [-1.47255465e-03]
 [-1.15025923e-02]
 [ 5.77513073e-03]
 [ 4.91108632e-04]
 [ 1.29871452e-02]
 [ 1.39543691e-02]
 [-1.83913334e-02]
 [ 9.67579259e-03]
 [-6.73579705e-03]
 [-8.00307866e-03]
 [ 4.30316494e-03]
 [ 3.19597928e-03]
 [ 1.04910852e-02]
 [-1.29265893e-03]
 [ 4.35005341e-03]
 [ 3.05352491e-03]
 [ 1.41363073e-02]
 [ 8.98801141e-03]
 [-2.58735160e-02]
 [ 9.94344650e-04]
 [ 2.10561696e-03]
 [-3.32689107e-03]
 [ 1.71521242e-02]
 [ 1.72767717e-02]
 [ 1.86886218e-02]
 [ 6.44089974e-04]
 [ 2.00475906e-03]
 [-3.43113526e-03]
 [-4.40454339e-02]
 [ 2.37481035e-02]
 [ 1.14871649e-02]
 [-3.82264404e-02]
 [ 8.56485966e-03]
 [ 7.93244527e-04]
 [-1.54658543e-02]
 [ 8.76908966e-03]
 [-2.17353387e-02]
 [ 5.94002663e-02]
 [ 4.75726530e-03]
 [ 1.27873041e-02]
 [-1.07365295e-02]
 [-6.82044443e-03]
 [-2.39445930e-02]
 [-1.28476221e-02]
 [ 3.17961029e-03]
 [-3.17346498e-03]
 [-2.21506546e-02]
 [-4.78639536e-03]
 [ 2.81815220e-03]
 [ 4.28116686e-03]
 [-2.89199740e-03]
 [ 1.99126222e-02]
 [ 9.02822525e-03]
 [ 1.02480489e-03]
 [ 1.38046741e-02]
 [ 1.29433801e-02]
 [-7.64417195e-03]
 [-6.04123207e-03]
 [-2.82811674e-02]
 [-1.29295389e-02]
 [-3.12724807e-03]
 [-6.88849607e-03]
 [ 2.06129853e-02]
 [ 8.30590634e-03]
 [ 1.74774494e-03]
 [ 1.40653581e-02]
 [-1.85087175e-02]
 [ 1.01319861e-02]
 [ 1.55821163e-03]
 [-1.71290216e-03]
 [ 8.32544846e-03]
 [ 6.04540523e-04]
 [ 2.55369011e-03]
 [ 3.68547013e-04]
 [-1.06327222e-02]
 [-1.01682891e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.88488568]
curr_Stock_Price:  99.42469191664422
curr_Factors:  [99.42469192]
mat_Sqrt:  [[0.15]]
grads:  [-0.26222898]
Stock Position:  -0.2622289770033402
Bond Position:  [19.18714957]


portfolio before change:  [-6.74239055]
curr_Stock_Price:  98.88586553884575
curr_Factors:  [98.88586554]
mat_Sqrt:  [[0.15]]
grads:  [0.04720542]
Stock Position:  0.04720541861218133
Bond Position:  [-11.41033923]


portfolio before change:  [-6.74297784]
curr_Stock_Price:  98.88853222519913
curr_Factors:  [98.88853223]
mat_Sqrt:  [[0.15]]
grads:  [-0.0070719]
Stock Position:  -0.00707189807563073
Bond Position:  [-6.04364822]


portfolio before change:  [-6.74095453]
curr_Stock_Price:  98.5490119103632
curr_Factors:  [98.54901191]
mat_Sqrt:  [[0.15]]
grads:  [-0.00981703]
Stock Position:  -0.009817031026670791
Bond Position:  [-5.77349582]


portfolio before change:  [-6.74551298]
curr_Stock_Price:  98.97659560996105
curr_Factors:  [98.97659561]
mat_Sqrt:  [[0.15]]
grads:  [-0.07668395]
Stock Position:  -0.07668394852071211
Bond Position:  [0.84440318]


portfolio before change:  [-6.71506362]
curr_Stock_Price:  98.58020777765417
curr_Factors:  [98.58020778]
mat_Sqrt:  [[0.15]]
grads:  [0.03850087]
Stock Position:  0.03850087155115127
Bond Position:  [-10.51048754]


portfolio before change:  [-6.69062437]
curr_Stock_Price:  99.23204183774337
curr_Factors:  [99.23204184]
mat_Sqrt:  [[0.15]]
grads:  [0.00327406]
Stock Position:  0.0032740575460179304
Bond Position:  [-7.01551578]


portfolio before change:  [-6.68998782]
curr_Stock_Price:  99.56039130887547
curr_Factors:  [99.56039131]
mat_Sqrt:  [[0.15]]
grads:  [0.08658097]
Stock Position:  0.08658096773462608
Bond Position:  [-15.31002285]


portfolio before change:  [-6.65754694]
curr_Stock_Price:  99.94613183456505
curr_Factors:  [99.94613183]
mat_Sqrt:  [[0.15]]
grads:  [0.09302913]
Stock Position:  0.09302912742530933
Bond Position:  [-15.95544837]


portfolio before change:  [-6.65512519]
curr_Stock_Price:  99.98288371714321
curr_Factors:  [99.98288372]
mat_Sqrt:  [[0.15]]
grads:  [-0.12260889]
Stock Position:  -0.1226088893970286
Bond Position:  [5.60366514]


portfolio before change:  [-6.66939074]
curr_Stock_Price:  100.102090351313
curr_Factors:  [100.10209035]
mat_Sqrt:  [[0.15]]
grads:  [0.06450528]
Stock Position:  0.06450528394590956
Bond Position:  [-13.1265045]


portfolio before change:  [-6.62545106]
curr_Stock_Price:  100.79598870837505
curr_Factors:  [100.79598871]
mat_Sqrt:  [[0.15]]
grads:  [-0.04490531]
Stock Position:  -0.04490531363765221
Bond Position:  [-2.09917558]


portfolio before change:  [-6.59655167]
curr_Stock_Price:  100.14950410698991
curr_Factors:  [100.14950411]
mat_Sqrt:  [[0.15]]
grads:  [-0.05335386]
Stock Position:  -0.05335385775430287
Bond Position:  [-1.25318927]


portfolio before change:  [-6.59631473]
curr_Stock_Price:  100.14359515236832
curr_Factors:  [100.14359515]
mat_Sqrt:  [[0.15]]
grads:  [0.02868777]
Stock Position:  0.028687766291803474
Bond Position:  [-9.46921079]


portfolio before change:  [-6.61059551]
curr_Stock_Price:  99.66642535802517
curr_Factors:  [99.66642536]
mat_Sqrt:  [[0.15]]
grads:  [0.02130653]
Stock Position:  0.021306528525191725
Bond Position:  [-8.73414105]


portfolio before change:  [-6.61910273]
curr_Stock_Price:  99.29276916616986
curr_Factors:  [99.29276917]
mat_Sqrt:  [[0.15]]
grads:  [0.06994057]
Stock Position:  0.06994056830783565
Bond Position:  [-13.56369543]


portfolio before change:  [-6.65125783]
curr_Stock_Price:  98.84514133505441
curr_Factors:  [98.84514134]
mat_Sqrt:  [[0.15]]
grads:  [-0.00861773]
Stock Position:  -0.008617726218720829
Bond Position:  [-5.79943747]


portfolio before change:  [-6.64916643]
curr_Stock_Price:  98.56039358266656
curr_Factors:  [98.56039358]
mat_Sqrt:  [[0.15]]
grads:  [0.02900036]
Stock Position:  0.029000356090330654
Bond Position:  [-9.50745294]


portfolio before change:  [-6.6698426]
curr_Stock_Price:  97.86792161048957
curr_Factors:  [97.86792161]
mat_Sqrt:  [[0.15]]
grads:  [0.02035683]
Stock Position:  0.020356832747226255
Bond Position:  [-8.66212351]


portfolio before change:  [-6.67021956]
curr_Stock_Price:  97.87599931264809
curr_Factors:  [97.87599931]
mat_Sqrt:  [[0.15]]
grads:  [0.09424205]
Stock Position:  0.09424204882254213
Bond Position:  [-15.89425427]


portfolio before change:  [-6.64900881]
curr_Stock_Price:  98.11160717581357
curr_Factors:  [98.11160718]
mat_Sqrt:  [[0.15]]
grads:  [0.05992008]
Stock Position:  0.059920076097959574
Bond Position:  [-12.52786378]


portfolio before change:  [-6.70326424]
curr_Stock_Price:  97.21921169599162
curr_Factors:  [97.2192117]
mat_Sqrt:  [[0.15]]
grads:  [-0.17249011]
Stock Position:  -0.17249010691914632
Bond Position:  [10.06608798]


portfolio before change:  [-6.62386479]
curr_Stock_Price:  96.7625460878221
curr_Factors:  [96.76254609]
mat_Sqrt:  [[0.15]]
grads:  [0.00662896]
Stock Position:  0.006628964334602922
Bond Position:  [-7.26530025]


portfolio before change:  [-6.62395957]
curr_Stock_Price:  96.81674907310278
curr_Factors:  [96.81674907]
mat_Sqrt:  [[0.15]]
grads:  [0.01403745]
Stock Position:  0.014037446377337682
Bond Position:  [-7.9830195]


portfolio before change:  [-6.62139124]
curr_Stock_Price:  97.03525644510341
curr_Factors:  [97.03525645]
mat_Sqrt:  [[0.15]]
grads:  [-0.02217927]
Stock Position:  -0.02217927381387906
Bond Position:  [-4.46921972]


portfolio before change:  [-6.6092685]
curr_Stock_Price:  96.47608242363441
curr_Factors:  [96.47608242]
mat_Sqrt:  [[0.15]]
grads:  [0.11434749]
Stock Position:  0.11434749456487917
Bond Position:  [-17.64106681]


portfolio before change:  [-6.59802451]
curr_Stock_Price:  96.5840567178334
curr_Factors:  [96.58405672]
mat_Sqrt:  [[0.15]]
grads:  [0.11517848]
Stock Position:  0.1151784776954369
Bond Position:  [-17.72242914]


portfolio before change:  [-6.59837481]
curr_Stock_Price:  96.59063248523834
curr_Factors:  [96.59063249]
mat_Sqrt:  [[0.15]]
grads:  [0.12459081]
Stock Position:  0.12459081220441064
Bond Position:  [-18.63268017]


portfolio before change:  [-6.56207265]
curr_Stock_Price:  96.89135083458126
curr_Factors:  [96.89135083]
mat_Sqrt:  [[0.15]]
grads:  [0.00429393]
Stock Position:  0.004293933161000073
Bond Position:  [-6.97811763]


portfolio before change:  [-6.56267437]
curr_Stock_Price:  96.85278950323021
curr_Factors:  [96.8527895]
mat_Sqrt:  [[0.15]]
grads:  [0.01336506]
Stock Position:  0.013365060372826481
Bond Position:  [-7.85711775]


portfolio before change:  [-6.57235058]
curr_Stock_Price:  96.16554093253451
curr_Factors:  [96.16554093]
mat_Sqrt:  [[0.15]]
grads:  [-0.02287424]
Stock Position:  -0.022874235058796245
Bond Position:  [-4.37263739]


portfolio before change:  [-6.55898996]
curr_Stock_Price:  95.5695027762258
curr_Factors:  [95.56950278]
mat_Sqrt:  [[0.15]]
grads:  [-0.29363623]
Stock Position:  -0.29363622626906416
Bond Position:  [21.50367818]


portfolio before change:  [-6.45817274]
curr_Stock_Price:  95.23073940014741
curr_Factors:  [95.2307394]
mat_Sqrt:  [[0.15]]
grads:  [0.15832069]
Stock Position:  0.15832069033051085
Bond Position:  [-21.53516914]


portfolio before change:  [-6.37413641]
curr_Stock_Price:  95.77003919042089
curr_Factors:  [95.77003919]
mat_Sqrt:  [[0.15]]
grads:  [0.0765811]
Stock Position:  0.076581099349954
Bond Position:  [-13.7083113]


portfolio before change:  [-6.44252723]
curr_Stock_Price:  94.88817638555783
curr_Factors:  [94.88817639]
mat_Sqrt:  [[0.15]]
grads:  [-0.25484294]
Stock Position:  -0.25484293593286744
Bond Position:  [17.73905422]


portfolio before change:  [-6.5411199]
curr_Stock_Price:  95.2794032227822
curr_Factors:  [95.27940322]
mat_Sqrt:  [[0.15]]
grads:  [0.05709906]
Stock Position:  0.05709906440662977
Bond Position:  [-11.98148468]


portfolio before change:  [-6.56191148]
curr_Stock_Price:  94.92838668138263
curr_Factors:  [94.92838668]
mat_Sqrt:  [[0.15]]
grads:  [0.0052883]
Stock Position:  0.005288296845787777
Bond Position:  [-7.06392097]


portfolio before change:  [-6.56430518]
curr_Stock_Price:  94.55923431425364
curr_Factors:  [94.55923431]
mat_Sqrt:  [[0.15]]
grads:  [-0.1031057]
Stock Position:  -0.10310569511532787
Bond Position:  [3.1852904]


portfolio before change:  [-6.62028515]
curr_Stock_Price:  95.1041029395909
curr_Factors:  [95.10410294]
mat_Sqrt:  [[0.15]]
grads:  [0.0584606]
Stock Position:  0.05846059773168322
Bond Position:  [-12.18012786]


portfolio before change:  [-6.67013246]
curr_Stock_Price:  94.26446004951202
curr_Factors:  [94.26446005]
mat_Sqrt:  [[0.15]]
grads:  [-0.14490226]
Stock Position:  -0.14490225818260427
Bond Position:  [6.98900067]


portfolio before change:  [-6.6462531]
curr_Stock_Price:  94.10267835584811
curr_Factors:  [94.10267836]
mat_Sqrt:  [[0.15]]
grads:  [0.39600178]
Stock Position:  0.3960017751917557
Bond Position:  [-43.91108078]


portfolio before change:  [-6.86830401]
curr_Stock_Price:  93.54887684608182
curr_Factors:  [93.54887685]
mat_Sqrt:  [[0.15]]
grads:  [0.0317151]
Stock Position:  0.03171510199946326
Bond Position:  [-9.83521618]


portfolio before change:  [-6.86583512]
curr_Stock_Price:  93.64610537287325
curr_Factors:  [93.64610537]
mat_Sqrt:  [[0.15]]
grads:  [0.08524869]
Stock Position:  0.08524869368362789
Bond Position:  [-14.84904327]


portfolio before change:  [-6.89904298]
curr_Stock_Price:  93.26745122113975
curr_Factors:  [93.26745122]
mat_Sqrt:  [[0.15]]
grads:  [-0.07157686]
Stock Position:  -0.07157686353244924
Bond Position:  [-0.22325136]


portfolio before change:  [-6.87186592]
curr_Stock_Price:  92.88756559564268
curr_Factors:  [92.8875656]
mat_Sqrt:  [[0.15]]
grads:  [-0.04546963]
Stock Position:  -0.04546962950721472
Bond Position:  [-2.64830272]


portfolio before change:  [-6.88216689]
curr_Stock_Price:  93.11047154338029
curr_Factors:  [93.11047154]
mat_Sqrt:  [[0.15]]
grads:  [-0.15963062]
Stock Position:  -0.15963062004689194
Bond Position:  [7.98111541]


portfolio before change:  [-6.86921726]
curr_Stock_Price:  93.03247399598337
curr_Factors:  [93.032474]
mat_Sqrt:  [[0.15]]
grads:  [-0.08565081]
Stock Position:  -0.08565081420625667
Bond Position:  [1.09908989]


portfolio before change:  [-6.86454035]
curr_Stock_Price:  92.97867162755898
curr_Factors:  [92.97867163]
mat_Sqrt:  [[0.15]]
grads:  [0.0211974]
Stock Position:  0.02119740193644139
Bond Position:  [-8.83544662]


portfolio before change:  [-6.86102258]
curr_Stock_Price:  93.170676013078
curr_Factors:  [93.17067601]
mat_Sqrt:  [[0.15]]
grads:  [-0.02115643]
Stock Position:  -0.021156433190168005
Bond Position:  [-4.8898634]


portfolio before change:  [-6.84402577]
curr_Stock_Price:  92.35284228568536
curr_Factors:  [92.35284229]
mat_Sqrt:  [[0.15]]
grads:  [-0.14767103]
Stock Position:  -0.147671030893581
Bond Position:  [6.79381366]


portfolio before change:  [-6.90047801]
curr_Stock_Price:  92.73800155049777
curr_Factors:  [92.73800155]
mat_Sqrt:  [[0.15]]
grads:  [-0.0319093]
Stock Position:  -0.03190930238675208
Bond Position:  [-3.94127307]


portfolio before change:  [-6.91916143]
curr_Stock_Price:  93.31579820066658
curr_Factors:  [93.3157982]
mat_Sqrt:  [[0.15]]
grads:  [0.01878768]
Stock Position:  0.018787681302943116
Bond Position:  [-8.67234891]


portfolio before change:  [-6.92295005]
curr_Stock_Price:  93.14299477842772
curr_Factors:  [93.14299478]
mat_Sqrt:  [[0.15]]
grads:  [0.02854111]
Stock Position:  0.02854111242581846
Bond Position:  [-9.58135473]


portfolio before change:  [-6.92250998]
curr_Stock_Price:  93.17939539265203
curr_Factors:  [93.17939539]
mat_Sqrt:  [[0.15]]
grads:  [-0.01927998]
Stock Position:  -0.019279982684010204
Bond Position:  [-5.12601285]


portfolio before change:  [-6.93621718]
curr_Stock_Price:  93.87373279999412
curr_Factors:  [93.8737328]
mat_Sqrt:  [[0.15]]
grads:  [0.13275081]
Stock Position:  0.1327508145702884
Bond Position:  [-19.39803168]


portfolio before change:  [-6.98504638]
curr_Stock_Price:  93.51503981797607
curr_Factors:  [93.51503982]
mat_Sqrt:  [[0.15]]
grads:  [0.06018817]
Stock Position:  0.06018816836049203
Bond Position:  [-12.61354534]


portfolio before change:  [-6.9424477]
curr_Stock_Price:  94.23589667899326
curr_Factors:  [94.23589668]
mat_Sqrt:  [[0.15]]
grads:  [0.00683203]
Stock Position:  0.006832032610641891
Bond Position:  [-7.58627042]


portfolio before change:  [-6.94245877]
curr_Stock_Price:  94.30367912982894
curr_Factors:  [94.30367913]
mat_Sqrt:  [[0.15]]
grads:  [0.09203116]
Stock Position:  0.09203116056616811
Bond Position:  [-15.6213358]


portfolio before change:  [-6.97675047]
curr_Stock_Price:  93.94167847876388
curr_Factors:  [93.94167848]
mat_Sqrt:  [[0.15]]
grads:  [0.0862892]
Stock Position:  0.0862892005468365
Bond Position:  [-15.0829028]


portfolio before change:  [-6.96291025]
curr_Stock_Price:  94.11299694813763
curr_Factors:  [94.11299695]
mat_Sqrt:  [[0.15]]
grads:  [-0.05096115]
Stock Position:  -0.05096114630888
Bond Position:  [-2.16680404]


portfolio before change:  [-6.99719188]
curr_Stock_Price:  94.7830408110662
curr_Factors:  [94.78304081]
mat_Sqrt:  [[0.15]]
grads:  [-0.04027488]
Stock Position:  -0.04027488047663712
Bond Position:  [-3.17981624]


portfolio before change:  [-6.99875987]
curr_Stock_Price:  94.81703831487155
curr_Factors:  [94.81703831]
mat_Sqrt:  [[0.15]]
grads:  [-0.18854112]
Stock Position:  -0.18854111601554316
Bond Position:  [10.87815035]


portfolio before change:  [-6.91135536]
curr_Stock_Price:  94.35706117548445
curr_Factors:  [94.35706118]
mat_Sqrt:  [[0.15]]
grads:  [-0.08619693]
Stock Position:  -0.08619692591429841
Bond Position:  [1.22193325]


portfolio before change:  [-6.95047606]
curr_Stock_Price:  94.81179980537397
curr_Factors:  [94.81179981]
mat_Sqrt:  [[0.15]]
grads:  [-0.02084832]
Stock Position:  -0.02084832044907488
Bond Position:  [-4.97380928]


portfolio before change:  [-6.95634424]
curr_Stock_Price:  95.07835877408952
curr_Factors:  [95.07835877]
mat_Sqrt:  [[0.15]]
grads:  [-0.04592331]
Stock Position:  -0.045923307124691885
Bond Position:  [-2.59003157]


portfolio before change:  [-6.95911411]
curr_Stock_Price:  95.13514895578139
curr_Factors:  [95.13514896]
mat_Sqrt:  [[0.15]]
grads:  [0.1374199]
Stock Position:  0.13741990170690774
Bond Position:  [-20.03257693]


portfolio before change:  [-6.90673715]
curr_Stock_Price:  95.52540565513814
curr_Factors:  [95.52540566]
mat_Sqrt:  [[0.15]]
grads:  [0.05537271]
Stock Position:  0.05537270896663832
Bond Position:  [-12.19623764]


portfolio before change:  [-6.92497909]
curr_Stock_Price:  95.20973293599079
curr_Factors:  [95.20973294]
mat_Sqrt:  [[0.15]]
grads:  [0.01165163]
Stock Position:  0.011651632947211154
Bond Position:  [-8.03432796]


portfolio before change:  [-6.92239885]
curr_Stock_Price:  95.47428036013804
curr_Factors:  [95.47428036]
mat_Sqrt:  [[0.15]]
grads:  [0.09376905]
Stock Position:  0.09376905367118103
Bond Position:  [-15.87493177]


portfolio before change:  [-6.84299783]
curr_Stock_Price:  96.33163394229781
curr_Factors:  [96.33163394]
mat_Sqrt:  [[0.15]]
grads:  [-0.12339145]
Stock Position:  -0.12339144973312353
Bond Position:  [5.04350214]


portfolio before change:  [-6.86452887]
curr_Stock_Price:  96.50868246330025
curr_Factors:  [96.50868246]
mat_Sqrt:  [[0.15]]
grads:  [0.06754657]
Stock Position:  0.067546573720504
Bond Position:  [-13.38335971]


portfolio before change:  [-6.83578624]
curr_Stock_Price:  96.94658939456812
curr_Factors:  [96.94658939]
mat_Sqrt:  [[0.15]]
grads:  [0.01038808]
Stock Position:  0.010388077506608754
Bond Position:  [-7.84287493]


portfolio before change:  [-6.84118062]
curr_Stock_Price:  96.47449227503917
curr_Factors:  [96.47449228]
mat_Sqrt:  [[0.15]]
grads:  [-0.01141935]
Stock Position:  -0.011419347727693631
Bond Position:  [-5.73950485]


portfolio before change:  [-6.85613089]
curr_Stock_Price:  97.7522835676144
curr_Factors:  [97.75228357]
mat_Sqrt:  [[0.15]]
grads:  [0.05550299]
Stock Position:  0.05550298975113623
Bond Position:  [-12.28167489]


portfolio before change:  [-6.87139788]
curr_Stock_Price:  97.49104802152122
curr_Factors:  [97.49104802]
mat_Sqrt:  [[0.15]]
grads:  [0.00403027]
Stock Position:  0.004030270156071241
Bond Position:  [-7.26431314]


portfolio before change:  [-6.87293824]
curr_Stock_Price:  97.22150546334034
curr_Factors:  [97.22150546]
mat_Sqrt:  [[0.15]]
grads:  [0.0170246]
Stock Position:  0.017024600700990905
Bond Position:  [-8.52809555]


portfolio before change:  [-6.86727303]
curr_Stock_Price:  97.58558049463298
curr_Factors:  [97.58558049]
mat_Sqrt:  [[0.15]]
grads:  [0.00245698]
Stock Position:  0.002456980089074861
Bond Position:  [-7.10703886]


portfolio before change:  [-6.86718962]
curr_Stock_Price:  97.80031956998322
curr_Factors:  [97.80031957]
mat_Sqrt:  [[0.15]]
grads:  [-0.07088481]
Stock Position:  -0.07088481456284827
Bond Position:  [0.06536789]


portfolio before change:  [-6.89264925]
curr_Stock_Price:  98.15954612976012
curr_Factors:  [98.15954613]
mat_Sqrt:  [[0.15]]
grads:  [-0.06778859]
Stock Position:  -0.06778859424852393
Bond Position:  [-0.2385516]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.89264925]
Stock Price:  98.31700168570443
PL:  [-6.89264925]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.36399605e-02]
 [ 2.38971749e-03]
 [-7.04099563e-05]
 [ 2.44225919e-03]
 [ 6.29133560e-03]
 [ 1.21971871e-02]
 [-8.65256034e-04]
 [ 2.67424357e-02]
 [-1.92046044e-02]
 [ 4.77360508e-02]
 [ 9.78127800e-03]
 [-1.05240582e-02]
 [ 2.45931545e-02]
 [ 2.25822661e-02]
 [-9.05134638e-03]
 [-8.07081702e-03]
 [ 8.46007658e-03]
 [ 2.55298155e-02]
 [ 1.15101534e-02]
 [-5.03812958e-04]
 [ 6.22455281e-02]
 [-1.17229092e-02]
 [ 8.63867976e-03]
 [-2.17944711e-03]
 [ 1.82584382e-02]
 [ 1.49742146e-02]
 [ 6.19895449e-03]
 [ 5.72950452e-03]
 [ 9.29942390e-03]
 [-9.56292430e-03]
 [-5.73907924e-03]
 [ 3.96452729e-02]
 [ 6.34357228e-03]
 [-4.31297203e-03]
 [-5.22607147e-03]
 [-4.04784799e-03]
 [-6.14936307e-03]
 [ 9.62771057e-03]
 [-6.10049997e-06]
 [-1.30307816e-02]
 [ 2.38601726e-03]
 [-2.24816705e-03]
 [ 4.94263000e-03]
 [-1.28386089e-02]
 [ 2.35557732e-03]
 [ 9.85707389e-04]
 [-1.37065324e-02]
 [-5.15470223e-03]
 [-3.38957485e-05]
 [ 5.65087380e-03]
 [-2.98124129e-03]
 [ 3.77550670e-03]
 [-2.60444955e-05]
 [ 1.64435226e-03]
 [ 1.08024422e-03]
 [ 8.51266509e-03]
 [-3.90604738e-03]
 [-1.16627323e-02]
 [ 1.50121055e-02]
 [ 3.42413419e-03]
 [ 1.11144160e-02]
 [-1.51461975e-02]
 [-1.27617533e-02]
 [-3.34653323e-03]
 [ 2.30169703e-02]
 [-1.75365807e-02]
 [ 2.23015392e-02]
 [ 3.39446464e-03]
 [ 9.79202159e-03]
 [-1.99587657e-02]
 [-7.71713367e-03]
 [-7.99060731e-03]
 [ 2.26918940e-03]
 [ 8.75434007e-03]
 [ 1.08783092e-02]
 [-8.57841401e-03]
 [-2.23863583e-03]
 [-8.80799024e-03]
 [-5.35501550e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.83190547]
curr_Stock_Price:  99.98492583312867
curr_Factors:  [99.98492583]
mat_Sqrt:  [[0.15]]
grads:  [-0.2242664]
Stock Position:  -0.22426640339698795
Bond Position:  [24.25516518]


portfolio before change:  [1.9581477]
curr_Stock_Price:  99.42877368187628
curr_Factors:  [99.42877368]
mat_Sqrt:  [[0.15]]
grads:  [0.01593145]
Stock Position:  0.01593144991436222
Bond Position:  [0.37410318]


portfolio before change:  [1.96096844]
curr_Stock_Price:  99.60436034176625
curr_Factors:  [99.60436034]
mat_Sqrt:  [[0.15]]
grads:  [-0.0004694]
Stock Position:  -0.0004693997085058905
Bond Position:  [2.00772269]


portfolio before change:  [1.9604993]
curr_Stock_Price:  100.87113765373493
curr_Factors:  [100.87113765]
mat_Sqrt:  [[0.15]]
grads:  [0.01628173]
Stock Position:  0.01628172792599241
Bond Position:  [0.31814288]


portfolio before change:  [1.96691035]
curr_Stock_Price:  101.2636737777299
curr_Factors:  [101.26367378]
mat_Sqrt:  [[0.15]]
grads:  [0.04194224]
Stock Position:  0.04194223733869276
Bond Position:  [-2.28031469]


portfolio before change:  [1.99006113]
curr_Stock_Price:  101.81904002665746
curr_Factors:  [101.81904003]
mat_Sqrt:  [[0.15]]
grads:  [0.08131458]
Stock Position:  0.08131458041672737
Bond Position:  [-6.28931139]


portfolio before change:  [2.03803691]
curr_Stock_Price:  102.41387651826064
curr_Factors:  [102.41387652]
mat_Sqrt:  [[0.15]]
grads:  [-0.00576837]
Stock Position:  -0.005768373557775007
Bond Position:  [2.62879841]


portfolio before change:  [2.03359203]
curr_Stock_Price:  103.21292070097412
curr_Factors:  [103.2129207]
mat_Sqrt:  [[0.15]]
grads:  [0.1782829]
Stock Position:  0.1782829043789728
Bond Position:  [-16.36750724]


portfolio before change:  [2.03684438]
curr_Stock_Price:  103.2369013664984
curr_Factors:  [103.23690137]
mat_Sqrt:  [[0.15]]
grads:  [-0.1280307]
Stock Position:  -0.12803069624398322
Bond Position:  [15.25433674]


portfolio before change:  [2.00723016]
curr_Stock_Price:  103.47565377827088
curr_Factors:  [103.47565378]
mat_Sqrt:  [[0.15]]
grads:  [0.31824034]
Stock Position:  0.31824033896321424
Bond Position:  [-30.92289697]


portfolio before change:  [1.82193249]
curr_Stock_Price:  102.89946995324375
curr_Factors:  [102.89946995]
mat_Sqrt:  [[0.15]]
grads:  [0.06520852]
Stock Position:  0.06520851996695602
Bond Position:  [-4.88798965]


portfolio before change:  [1.77745364]
curr_Stock_Price:  102.22205330631274
curr_Factors:  [102.22205331]
mat_Sqrt:  [[0.15]]
grads:  [-0.07016039]
Stock Position:  -0.07016038804803441
Bond Position:  [8.94939257]


portfolio before change:  [1.76683674]
curr_Stock_Price:  102.38134915441118
curr_Factors:  [102.38134915]
mat_Sqrt:  [[0.15]]
grads:  [0.16395436]
Stock Position:  0.16395436323345985
Bond Position:  [-15.01903217]


portfolio before change:  [1.92180799]
curr_Stock_Price:  103.3322843454866
curr_Factors:  [103.33228435]
mat_Sqrt:  [[0.15]]
grads:  [0.15054844]
Stock Position:  0.15054844047579868
Bond Position:  [-13.63470627]


portfolio before change:  [1.9010898]
curr_Stock_Price:  103.20032685907394
curr_Factors:  [103.20032686]
mat_Sqrt:  [[0.15]]
grads:  [-0.06034231]
Stock Position:  -0.06034230917228959
Bond Position:  [8.12843583]


portfolio before change:  [1.90335157]
curr_Stock_Price:  103.17126391954001
curr_Factors:  [103.17126392]
mat_Sqrt:  [[0.15]]
grads:  [-0.05380545]
Stock Position:  -0.05380544678311885
Bond Position:  [7.45452752]


portfolio before change:  [1.95303384]
curr_Stock_Price:  102.25655460933629
curr_Factors:  [102.25655461]
mat_Sqrt:  [[0.15]]
grads:  [0.05640051]
Stock Position:  0.05640051055359897
Bond Position:  [-3.81428805]


portfolio before change:  [1.9460518]
curr_Stock_Price:  102.13698761335398
curr_Factors:  [102.13698761]
mat_Sqrt:  [[0.15]]
grads:  [0.17019877]
Stock Position:  0.1701987698028158
Bond Position:  [-15.43753785]


portfolio before change:  [2.02368947]
curr_Stock_Price:  102.59881558427608
curr_Factors:  [102.59881558]
mat_Sqrt:  [[0.15]]
grads:  [0.07673436]
Stock Position:  0.07673435609388285
Bond Position:  [-5.84916458]


portfolio before change:  [1.95914264]
curr_Stock_Price:  101.76240731741125
curr_Factors:  [101.76240732]
mat_Sqrt:  [[0.15]]
grads:  [-0.00335875]
Stock Position:  -0.003358753055472495
Bond Position:  [2.30093743]


portfolio before change:  [1.95981072]
curr_Stock_Price:  101.60631651943608
curr_Factors:  [101.60631652]
mat_Sqrt:  [[0.15]]
grads:  [0.41497019]
Stock Position:  0.41497018732022684
Bond Position:  [-40.20378148]


portfolio before change:  [2.40995206]
curr_Stock_Price:  102.69712776899945
curr_Factors:  [102.69712777]
mat_Sqrt:  [[0.15]]
grads:  [-0.07815273]
Stock Position:  -0.07815272812994115
Bond Position:  [10.43601276]


portfolio before change:  [2.46434643]
curr_Stock_Price:  102.0094729191354
curr_Factors:  [102.00947292]
mat_Sqrt:  [[0.15]]
grads:  [0.0575912]
Stock Position:  0.0575911984330772
Bond Position:  [-3.41050137]


portfolio before change:  [2.51173702]
curr_Stock_Price:  102.83605331938341
curr_Factors:  [102.83605332]
mat_Sqrt:  [[0.15]]
grads:  [-0.01452965]
Stock Position:  -0.014529647382761196
Bond Position:  [4.00590861]


portfolio before change:  [2.49465459]
curr_Stock_Price:  104.02898037912153
curr_Factors:  [104.02898038]
mat_Sqrt:  [[0.15]]
grads:  [0.12172292]
Stock Position:  0.12172292147058206
Bond Position:  [-10.16805682]


portfolio before change:  [2.53553802]
curr_Stock_Price:  104.37007435917744
curr_Factors:  [104.37007436]
mat_Sqrt:  [[0.15]]
grads:  [0.0998281]
Stock Position:  0.0998280975278306
Bond Position:  [-7.88352794]


portfolio before change:  [2.60530238]
curr_Stock_Price:  105.07385515563594
curr_Factors:  [105.07385516]
mat_Sqrt:  [[0.15]]
grads:  [0.04132636]
Stock Position:  0.041326363299485414
Bond Position:  [-1.73701793]


portfolio before change:  [2.59698868]
curr_Stock_Price:  104.8753103335131
curr_Factors:  [104.87531033]
mat_Sqrt:  [[0.15]]
grads:  [0.0381967]
Stock Position:  0.03819669681832415
Bond Position:  [-1.40890175]


portfolio before change:  [2.5930645]
curr_Stock_Price:  104.7748797034379
curr_Factors:  [104.7748797]
mat_Sqrt:  [[0.15]]
grads:  [0.06199616]
Stock Position:  0.061996159302604
Bond Position:  [-3.90257563]


portfolio before change:  [2.54991512]
curr_Stock_Price:  104.08281319623634
curr_Factors:  [104.0828132]
mat_Sqrt:  [[0.15]]
grads:  [-0.06375283]
Stock Position:  -0.06375282868102752
Bond Position:  [9.18548888]


portfolio before change:  [2.58496295]
curr_Stock_Price:  103.54207289646602
curr_Factors:  [103.5420729]
mat_Sqrt:  [[0.15]]
grads:  [-0.03826053]
Stock Position:  -0.038260528273151954
Bond Position:  [6.54653736]


portfolio before change:  [2.59644698]
curr_Stock_Price:  103.25261398371744
curr_Factors:  [103.25261398]
mat_Sqrt:  [[0.15]]
grads:  [0.26430182]
Stock Position:  0.2643018195730015
Bond Position:  [-24.69340677]


portfolio before change:  [2.48025284]
curr_Stock_Price:  102.81882678035656
curr_Factors:  [102.81882678]
mat_Sqrt:  [[0.15]]
grads:  [0.04229048]
Stock Position:  0.04229048188035693
Bond Position:  [-1.86800489]


portfolio before change:  [2.48498617]
curr_Stock_Price:  102.93351175148126
curr_Factors:  [102.93351175]
mat_Sqrt:  [[0.15]]
grads:  [-0.02875315]
Stock Position:  -0.028753146838224674
Bond Position:  [5.44464855]


portfolio before change:  [2.48971854]
curr_Stock_Price:  102.78076109834257
curr_Factors:  [102.7807611]
mat_Sqrt:  [[0.15]]
grads:  [-0.03484048]
Stock Position:  -0.03484047649874998
Bond Position:  [6.07064923]


portfolio before change:  [2.46903839]
curr_Stock_Price:  103.38521830216284
curr_Factors:  [103.3852183]
mat_Sqrt:  [[0.15]]
grads:  [-0.02698565]
Stock Position:  -0.026985653287257105
Bond Position:  [5.25895604]


portfolio before change:  [2.48628393]
curr_Stock_Price:  102.75833517361941
curr_Factors:  [102.75833517]
mat_Sqrt:  [[0.15]]
grads:  [-0.04099575]
Stock Position:  -0.04099575378105223
Bond Position:  [6.69893934]


portfolio before change:  [2.54109334]
curr_Stock_Price:  101.43159500740481
curr_Factors:  [101.43159501]
mat_Sqrt:  [[0.15]]
grads:  [0.06418474]
Stock Position:  0.06418473713148812
Bond Position:  [-3.96926692]


portfolio before change:  [2.53394239]
curr_Stock_Price:  101.32404826157094
curr_Factors:  [101.32404826]
mat_Sqrt:  [[0.15]]
grads:  [-4.06699998e-05]
Stock Position:  -4.066999977653975e-05
Bond Position:  [2.53806324]


portfolio before change:  [2.53413808]
curr_Stock_Price:  100.41305899812555
curr_Factors:  [100.413059]
mat_Sqrt:  [[0.15]]
grads:  [-0.08687188]
Stock Position:  -0.08687187735302113
Bond Position:  [11.25720902]


portfolio before change:  [2.64149688]
curr_Stock_Price:  99.18532905134624
curr_Factors:  [99.18532905]
mat_Sqrt:  [[0.15]]
grads:  [0.01590678]
Stock Position:  0.01590678173464359
Bond Position:  [1.0637775]


portfolio before change:  [2.64185788]
curr_Stock_Price:  99.20384350273791
curr_Factors:  [99.2038435]
mat_Sqrt:  [[0.15]]
grads:  [-0.01498778]
Stock Position:  -0.014987780305068813
Bond Position:  [4.12870329]


portfolio before change:  [2.63538167]
curr_Stock_Price:  99.65315995322773
curr_Factors:  [99.65315995]
mat_Sqrt:  [[0.15]]
grads:  [0.03295087]
Stock Position:  0.03295086664162321
Bond Position:  [-0.64827631]


portfolio before change:  [2.65970147]
curr_Stock_Price:  100.39245200782123
curr_Factors:  [100.39245201]
mat_Sqrt:  [[0.15]]
grads:  [-0.08559073]
Stock Position:  -0.08559072594648855
Bond Position:  [11.25236431]


portfolio before change:  [2.66036471]
curr_Stock_Price:  100.39291992362361
curr_Factors:  [100.39291992]
mat_Sqrt:  [[0.15]]
grads:  [0.01570385]
Stock Position:  0.01570384883192998
Bond Position:  [1.08380947]


portfolio before change:  [2.66772041]
curr_Stock_Price:  100.85700732274081
curr_Factors:  [100.85700732]
mat_Sqrt:  [[0.15]]
grads:  [0.00657138]
Stock Position:  0.0065713825949326775
Bond Position:  [2.00495043]


portfolio before change:  [2.66923576]
curr_Stock_Price:  101.06853678313385
curr_Factors:  [101.06853678]
mat_Sqrt:  [[0.15]]
grads:  [-0.09137688]
Stock Position:  -0.09137688276322531
Bond Position:  [11.9045636]


portfolio before change:  [2.72564024]
curr_Stock_Price:  100.45940662342888
curr_Factors:  [100.45940662]
mat_Sqrt:  [[0.15]]
grads:  [-0.03436468]
Stock Position:  -0.03436468150670595
Bond Position:  [6.17789575]


portfolio before change:  [2.71903736]
curr_Stock_Price:  100.66278415444914
curr_Factors:  [100.66278415]
mat_Sqrt:  [[0.15]]
grads:  [-0.00022597]
Stock Position:  -0.00022597165647541325
Bond Position:  [2.7417843]


portfolio before change:  [2.71923226]
curr_Stock_Price:  100.55865638425968
curr_Factors:  [100.55865638]
mat_Sqrt:  [[0.15]]
grads:  [0.03767249]
Stock Position:  0.037672492004702844
Bond Position:  [-1.06906292]


portfolio before change:  [2.7125305]
curr_Stock_Price:  100.38253456231936
curr_Factors:  [100.38253456]
mat_Sqrt:  [[0.15]]
grads:  [-0.01987494]
Stock Position:  -0.019874941935928397
Bond Position:  [4.70762754]


portfolio before change:  [2.7104484]
curr_Stock_Price:  100.50209860284863
curr_Factors:  [100.5020986]
mat_Sqrt:  [[0.15]]
grads:  [0.02517004]
Stock Position:  0.025170044663075562
Bond Position:  [0.18080609]


portfolio before change:  [2.72519408]
curr_Stock_Price:  101.08749199118441
curr_Factors:  [101.08749199]
mat_Sqrt:  [[0.15]]
grads:  [-0.00017363]
Stock Position:  -0.00017362996998216847
Bond Position:  [2.7427459]


portfolio before change:  [2.72527217]
curr_Stock_Price:  101.6250650767487
curr_Factors:  [101.62506508]
mat_Sqrt:  [[0.15]]
grads:  [0.01096235]
Stock Position:  0.010962348366752552
Bond Position:  [1.6112228]


portfolio before change:  [2.72642236]
curr_Stock_Price:  101.7208001347078
curr_Factors:  [101.72080013]
mat_Sqrt:  [[0.15]]
grads:  [0.00720163]
Stock Position:  0.007201628145575845
Bond Position:  [1.99386698]


portfolio before change:  [2.72735757]
curr_Stock_Price:  101.83335669724433
curr_Factors:  [101.8333567]
mat_Sqrt:  [[0.15]]
grads:  [0.0567511]
Stock Position:  0.05675110061825163
Bond Position:  [-3.05179751]


portfolio before change:  [2.80463577]
curr_Stock_Price:  103.1984218819499
curr_Factors:  [103.19842188]
mat_Sqrt:  [[0.15]]
grads:  [-0.02604032]
Stock Position:  -0.02604031588385168
Bond Position:  [5.49195528]


portfolio before change:  [2.80209898]
curr_Stock_Price:  103.30902154632832
curr_Factors:  [103.30902155]
mat_Sqrt:  [[0.15]]
grads:  [-0.07775155]
Stock Position:  -0.07775154868294192
Bond Position:  [10.8345354]


portfolio before change:  [2.81623236]
curr_Stock_Price:  103.13595497282303
curr_Factors:  [103.13595497]
mat_Sqrt:  [[0.15]]
grads:  [0.1000807]
Stock Position:  0.10008070356817018
Bond Position:  [-7.50568658]


portfolio before change:  [2.73355519]
curr_Stock_Price:  102.3145374562131
curr_Factors:  [102.31453746]
mat_Sqrt:  [[0.15]]
grads:  [0.02282756]
Stock Position:  0.022827561294123125
Bond Position:  [0.39796382]


portfolio before change:  [2.73708359]
curr_Stock_Price:  102.46801522593016
curr_Factors:  [102.46801523]
mat_Sqrt:  [[0.15]]
grads:  [0.07409611]
Stock Position:  0.07409610660982337
Bond Position:  [-4.85539739]


portfolio before change:  [2.76506738]
curr_Stock_Price:  102.84977970490829
curr_Factors:  [102.8497797]
mat_Sqrt:  [[0.15]]
grads:  [-0.10097465]
Stock Position:  -0.10097464972119435
Bond Position:  [13.15028786]


portfolio before change:  [2.64207011]
curr_Stock_Price:  104.07602005396264
curr_Factors:  [104.07602005]
mat_Sqrt:  [[0.15]]
grads:  [-0.08507836]
Stock Position:  -0.08507835554299152
Bond Position:  [11.49668675]


portfolio before change:  [2.63837504]
curr_Stock_Price:  104.12789733172248
curr_Factors:  [104.12789733]
mat_Sqrt:  [[0.15]]
grads:  [-0.02231022]
Stock Position:  -0.022310221538783995
Bond Position:  [4.9614915]


portfolio before change:  [2.63907239]
curr_Stock_Price:  104.11053996442489
curr_Factors:  [104.11053996]
mat_Sqrt:  [[0.15]]
grads:  [0.15344647]
Stock Position:  0.1534464684449497
Bond Position:  [-13.3363223]


portfolio before change:  [2.66365167]
curr_Stock_Price:  104.27615359579876
curr_Factors:  [104.2761536]
mat_Sqrt:  [[0.15]]
grads:  [-0.11691054]
Stock Position:  -0.1169105382774984
Bond Position:  [14.85463292]


portfolio before change:  [2.72927701]
curr_Stock_Price:  103.72276556931105
curr_Factors:  [103.72276557]
mat_Sqrt:  [[0.15]]
grads:  [0.14867693]
Stock Position:  0.14867692797438448
Bond Position:  [-12.69190514]


portfolio before change:  [2.69168636]
curr_Stock_Price:  103.47526668939473
curr_Factors:  [103.47526669]
mat_Sqrt:  [[0.15]]
grads:  [0.02262976]
Stock Position:  0.022629764246955245
Bond Position:  [0.35006547]


portfolio before change:  [2.69933055]
curr_Stock_Price:  103.81209332622774
curr_Factors:  [103.81209333]
mat_Sqrt:  [[0.15]]
grads:  [0.06528014]
Stock Position:  0.06528014393551564
Bond Position:  [-4.07753784]


portfolio before change:  [2.68505478]
curr_Stock_Price:  103.59731263754207
curr_Factors:  [103.59731264]
mat_Sqrt:  [[0.15]]
grads:  [-0.13305844]
Stock Position:  -0.13305843780333432
Bond Position:  [16.46955136]


portfolio before change:  [2.70604835]
curr_Stock_Price:  103.44727189617696
curr_Factors:  [103.4472719]
mat_Sqrt:  [[0.15]]
grads:  [-0.05144756]
Stock Position:  -0.05144755777908219
Bond Position:  [8.02815785]


portfolio before change:  [2.76614575]
curr_Stock_Price:  102.2888956583487
curr_Factors:  [102.28889566]
mat_Sqrt:  [[0.15]]
grads:  [-0.05327072]
Stock Position:  -0.053270715392256925
Bond Position:  [8.2151484]


portfolio before change:  [2.84529765]
curr_Stock_Price:  100.81269174460283
curr_Factors:  [100.81269174]
mat_Sqrt:  [[0.15]]
grads:  [0.01512793]
Stock Position:  0.015127929364143955
Bond Position:  [1.32021037]


portfolio before change:  [2.83701126]
curr_Stock_Price:  100.25948266245237
curr_Factors:  [100.25948266]
mat_Sqrt:  [[0.15]]
grads:  [0.05836227]
Stock Position:  0.058362267139759304
Bond Position:  [-3.01435945]


portfolio before change:  [2.83819665]
curr_Stock_Price:  100.28302169615495
curr_Factors:  [100.2830217]
mat_Sqrt:  [[0.15]]
grads:  [0.07252206]
Stock Position:  0.07252206149247924
Bond Position:  [-4.43453482]


portfolio before change:  [2.83124982]
curr_Stock_Price:  100.1910542776061
curr_Factors:  [100.19105428]
mat_Sqrt:  [[0.15]]
grads:  [-0.05718943]
Stock Position:  -0.05718942670469611
Bond Position:  [8.56111877]


portfolio before change:  [2.84448792]
curr_Stock_Price:  99.9689324745146
curr_Factors:  [99.96893247]
mat_Sqrt:  [[0.15]]
grads:  [-0.01492424]
Stock Position:  -0.014924238894752802
Bond Position:  [4.33644815]


portfolio before change:  [2.85327062]
curr_Stock_Price:  99.39860764720444
curr_Factors:  [99.39860765]
mat_Sqrt:  [[0.15]]
grads:  [-0.05871993]
Stock Position:  -0.05871993492981892
Bond Position:  [8.68995039]


portfolio before change:  [2.87270457]
curr_Stock_Price:  99.07689740262781
curr_Factors:  [99.0768974]
mat_Sqrt:  [[0.15]]
grads:  [-0.0357001]
Stock Position:  -0.03570010330774381
Bond Position:  [6.40976004]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.87270457]
Stock Price:  99.71313663955372
PL:  [2.87270457]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.77660531e-02]
 [ 5.71726190e-03]
 [ 2.23229837e-03]
 [-1.93847811e-03]
 [-2.68061944e-02]
 [-1.23901647e-03]
 [ 3.04824849e-03]
 [-2.68458806e-02]
 [-1.11998439e-02]
 [ 5.39611716e-02]
 [ 1.03580078e-02]
 [-1.15615376e-02]
 [ 9.13848656e-03]
 [ 8.55453441e-03]
 [-4.36335379e-02]
 [ 2.04436369e-02]
 [-4.30700366e-03]
 [-4.53789826e-03]
 [-2.82156898e-02]
 [ 1.45606596e-02]
 [-5.77967644e-02]
 [-2.85153740e-02]
 [ 4.22558053e-04]
 [ 5.26518369e-03]
 [ 1.90510846e-03]
 [ 1.47645228e-02]
 [ 1.45124887e-02]
 [-1.35346861e-02]
 [ 2.26580863e-03]
 [-1.26491869e-02]
 [-4.09266047e-03]
 [-9.37546983e-03]
 [ 1.57948878e-02]
 [ 1.60800539e-02]
 [ 2.95717423e-03]
 [ 2.57075495e-03]
 [-2.18256911e-03]
 [ 1.13625469e-02]
 [ 1.53888419e-03]
 [-1.37270399e-02]
 [ 2.47640004e-03]
 [-2.20224096e-03]
 [ 3.87756734e-03]
 [-7.85285854e-03]
 [ 2.04570563e-03]
 [-3.85045401e-03]
 [-1.37101397e-02]
 [-1.12393173e-03]
 [-8.43687291e-03]
 [ 9.10484641e-03]
 [-3.13133576e-03]
 [ 3.62955532e-03]
 [ 1.13009709e-03]
 [-1.62772073e-03]
 [ 2.25577319e-03]
 [ 8.82294791e-03]
 [ 1.74009358e-02]
 [-2.60140346e-02]
 [ 1.39071694e-02]
 [ 3.29518389e-03]
 [ 5.12035465e-03]
 [-1.40103790e-02]
 [-1.26218408e-02]
 [-1.50788889e-03]
 [-1.16960923e-02]
 [-1.07348066e-02]
 [ 1.26971285e-02]
 [ 2.00182316e-03]
 [ 8.21894334e-03]
 [-1.49063146e-02]
 [-5.60061762e-03]
 [-1.74298047e-03]
 [ 2.16552387e-03]
 [ 8.63519402e-03]
 [ 6.95743956e-03]
 [-9.54134011e-03]
 [ 5.76342483e-04]
 [-5.82550718e-03]
 [ 1.49908135e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.8484473]
curr_Stock_Price:  99.29849251622323
curr_Factors:  [99.29849252]
mat_Sqrt:  [[0.15]]
grads:  [-0.25177369]
Stock Position:  -0.25177368730011973
Bond Position:  [16.15230031]


portfolio before change:  [-8.78328052]
curr_Stock_Price:  99.04367151650808
curr_Factors:  [99.04367152]
mat_Sqrt:  [[0.15]]
grads:  [0.03811508]
Stock Position:  0.03811507935480324
Bond Position:  [-12.55833792]


portfolio before change:  [-8.81685069]
curr_Stock_Price:  98.1835069078804
curr_Factors:  [98.18350691]
mat_Sqrt:  [[0.15]]
grads:  [0.01488199]
Stock Position:  0.01488198911111048
Bond Position:  [-10.27801657]


portfolio before change:  [-8.81484864]
curr_Stock_Price:  98.36120122518673
curr_Factors:  [98.36120123]
mat_Sqrt:  [[0.15]]
grads:  [-0.01292319]
Stock Position:  -0.012923187407824924
Bond Position:  [-7.5437084]


portfolio before change:  [-8.80845719]
curr_Stock_Price:  97.83014477810802
curr_Factors:  [97.83014478]
mat_Sqrt:  [[0.15]]
grads:  [-0.17870796]
Stock Position:  -0.17870796272235887
Bond Position:  [8.67456867]


portfolio before change:  [-8.71998869]
curr_Stock_Price:  97.33813352834612
curr_Factors:  [97.33813353]
mat_Sqrt:  [[0.15]]
grads:  [-0.00826011]
Stock Position:  -0.008260109801258932
Bond Position:  [-7.91596502]


portfolio before change:  [-8.71842948]
curr_Stock_Price:  97.08947262204026
curr_Factors:  [97.08947262]
mat_Sqrt:  [[0.15]]
grads:  [0.02032166]
Stock Position:  0.02032165659606115
Bond Position:  [-10.69144841]


portfolio before change:  [-8.73120285]
curr_Stock_Price:  96.49379649303557
curr_Factors:  [96.49379649]
mat_Sqrt:  [[0.15]]
grads:  [-0.17897254]
Stock Position:  -0.17897253714826886
Bond Position:  [8.53853673]


portfolio before change:  [-8.66985542]
curr_Stock_Price:  96.15400271541158
curr_Factors:  [96.15400272]
mat_Sqrt:  [[0.15]]
grads:  [-0.07466563]
Stock Position:  -0.07466562582056807
Bond Position:  [-1.49045663]


portfolio before change:  [-8.71641333]
curr_Stock_Price:  96.77630720919775
curr_Factors:  [96.77630721]
mat_Sqrt:  [[0.15]]
grads:  [0.35974114]
Stock Position:  0.3597411440869749
Bond Position:  [-43.5308328]


portfolio before change:  [-8.75456999]
curr_Stock_Price:  96.67780330968792
curr_Factors:  [96.67780331]
mat_Sqrt:  [[0.15]]
grads:  [0.06905339]
Stock Position:  0.06905338565033553
Bond Position:  [-15.43049963]


portfolio before change:  [-8.72304821]
curr_Stock_Price:  97.14825413572994
curr_Factors:  [97.14825414]
mat_Sqrt:  [[0.15]]
grads:  [-0.07707692]
Stock Position:  -0.07707691766506711
Bond Position:  [-1.23516022]


portfolio before change:  [-8.73956293]
curr_Stock_Price:  97.36151538496632
curr_Factors:  [97.36151538]
mat_Sqrt:  [[0.15]]
grads:  [0.06092324]
Stock Position:  0.060923243719009326
Bond Position:  [-14.67114226]


portfolio before change:  [-8.78177186]
curr_Stock_Price:  96.6837451664724
curr_Factors:  [96.68374517]
mat_Sqrt:  [[0.15]]
grads:  [0.05703023]
Stock Position:  0.057030229426721486
Bond Position:  [-14.29566803]


portfolio before change:  [-8.82425839]
curr_Stock_Price:  95.95442977535674
curr_Factors:  [95.95442978]
mat_Sqrt:  [[0.15]]
grads:  [-0.29089025]
Stock Position:  -0.2908902527238191
Bond Position:  [19.08794993]


portfolio before change:  [-8.98405222]
curr_Stock_Price:  96.50785792522612
curr_Factors:  [96.50785793]
mat_Sqrt:  [[0.15]]
grads:  [0.13629091]
Stock Position:  0.13629091285386735
Bond Position:  [-22.13719627]


portfolio before change:  [-8.91418389]
curr_Stock_Price:  97.03065099228454
curr_Factors:  [97.03065099]
mat_Sqrt:  [[0.15]]
grads:  [-0.02871336]
Stock Position:  -0.028713357709745955
Bond Position:  [-6.1281081]


portfolio before change:  [-8.92347083]
curr_Stock_Price:  97.34074786842335
curr_Factors:  [97.34074787]
mat_Sqrt:  [[0.15]]
grads:  [-0.03025266]
Stock Position:  -0.03025265509321206
Bond Position:  [-5.97865476]


portfolio before change:  [-8.90154074]
curr_Stock_Price:  96.60349794406076
curr_Factors:  [96.60349794]
mat_Sqrt:  [[0.15]]
grads:  [-0.1881046]
Stock Position:  -0.1881045988184554
Bond Position:  [9.27002149]


portfolio before change:  [-8.97437405]
curr_Stock_Price:  96.993773930749
curr_Factors:  [96.99377393]
mat_Sqrt:  [[0.15]]
grads:  [0.09707106]
Stock Position:  0.09707106411687702
Bond Position:  [-18.3896629]


portfolio before change:  [-9.01900128]
curr_Stock_Price:  96.54587699339218
curr_Factors:  [96.54587699]
mat_Sqrt:  [[0.15]]
grads:  [-0.38531176]
Stock Position:  -0.3853117629763085
Bond Position:  [28.1812608]


portfolio before change:  [-9.07593041]
curr_Stock_Price:  96.69819654294635
curr_Factors:  [96.69819654]
mat_Sqrt:  [[0.15]]
grads:  [-0.19010249]
Stock Position:  -0.19010249358521036
Bond Position:  [9.30663788]


portfolio before change:  [-9.16833567]
curr_Stock_Price:  97.18733768089216
curr_Factors:  [97.18733768]
mat_Sqrt:  [[0.15]]
grads:  [0.00281705]
Stock Position:  0.002817053689604422
Bond Position:  [-9.44211762]


portfolio before change:  [-9.16840774]
curr_Stock_Price:  97.37124732637906
curr_Factors:  [97.37124733]
mat_Sqrt:  [[0.15]]
grads:  [0.03510122]
Stock Position:  0.035101224624508084
Bond Position:  [-12.58625776]


portfolio before change:  [-9.14499809]
curr_Stock_Price:  98.06057703455757
curr_Factors:  [98.06057703]
mat_Sqrt:  [[0.15]]
grads:  [0.01270072]
Stock Position:  0.012700723078471737
Bond Position:  [-10.39043832]


portfolio before change:  [-9.14923973]
curr_Stock_Price:  97.77774095269872
curr_Factors:  [97.77774095]
mat_Sqrt:  [[0.15]]
grads:  [0.09843015]
Stock Position:  0.09843015180655566
Bond Position:  [-18.77351762]


portfolio before change:  [-9.14846807]
curr_Stock_Price:  97.79750158225043
curr_Factors:  [97.79750158]
mat_Sqrt:  [[0.15]]
grads:  [0.09674992]
Stock Position:  0.09674992438417132
Bond Position:  [-18.61036896]


portfolio before change:  [-9.07138526]
curr_Stock_Price:  98.60624642555297
curr_Factors:  [98.60624643]
mat_Sqrt:  [[0.15]]
grads:  [-0.09023124]
Stock Position:  -0.0902312408497871
Bond Position:  [-0.17402129]


portfolio before change:  [-9.10782841]
curr_Stock_Price:  99.01001203804283
curr_Factors:  [99.01001204]
mat_Sqrt:  [[0.15]]
grads:  [0.01510539]
Stock Position:  0.015105390881343448
Bond Position:  [-10.60341334]


portfolio before change:  [-9.1087527]
curr_Stock_Price:  98.9926961514727
curr_Factors:  [98.99269615]
mat_Sqrt:  [[0.15]]
grads:  [-0.08432791]
Stock Position:  -0.08432791294802203
Bond Position:  [-0.76090524]


portfolio before change:  [-9.14918195]
curr_Stock_Price:  99.47156122381242
curr_Factors:  [99.47156122]
mat_Sqrt:  [[0.15]]
grads:  [-0.0272844]
Stock Position:  -0.02728440310104378
Bond Position:  [-6.43515978]


portfolio before change:  [-9.14947797]
curr_Stock_Price:  99.46766899594112
curr_Factors:  [99.467669]
mat_Sqrt:  [[0.15]]
grads:  [-0.06250313]
Stock Position:  -0.06250313219565123
Bond Position:  [-2.9324371]


portfolio before change:  [-9.13993822]
curr_Stock_Price:  99.31210841029778
curr_Factors:  [99.31210841]
mat_Sqrt:  [[0.15]]
grads:  [0.10529925]
Stock Position:  0.10529925213161619
Bond Position:  [-19.59742897]


portfolio before change:  [-9.06140217]
curr_Stock_Price:  100.06957756365321
curr_Factors:  [100.06957756]
mat_Sqrt:  [[0.15]]
grads:  [0.10720036]
Stock Position:  0.10720035951530786
Bond Position:  [-19.78889686]


portfolio before change:  [-9.03482238]
curr_Stock_Price:  100.32906017537323
curr_Factors:  [100.32906018]
mat_Sqrt:  [[0.15]]
grads:  [0.01971449]
Stock Position:  0.019714494894709132
Bond Position:  [-11.01275913]


portfolio before change:  [-9.04881761]
curr_Stock_Price:  99.65407900056476
curr_Factors:  [99.654079]
mat_Sqrt:  [[0.15]]
grads:  [0.01713837]
Stock Position:  0.017138366361926907
Bond Position:  [-10.75672573]


portfolio before change:  [-9.05416162]
curr_Stock_Price:  99.38149215422719
curr_Factors:  [99.38149215]
mat_Sqrt:  [[0.15]]
grads:  [-0.01455046]
Stock Position:  -0.014550460728390153
Bond Position:  [-7.60811513]


portfolio before change:  [-9.05346511]
curr_Stock_Price:  99.30094247304909
curr_Factors:  [99.30094247]
mat_Sqrt:  [[0.15]]
grads:  [0.07575031]
Stock Position:  0.07575031294677458
Bond Position:  [-16.57554258]


portfolio before change:  [-9.07239274]
curr_Stock_Price:  99.06475043862714
curr_Factors:  [99.06475044]
mat_Sqrt:  [[0.15]]
grads:  [0.01025923]
Stock Position:  0.010259227951166199
Bond Position:  [-10.08872059]


portfolio before change:  [-9.06990895]
curr_Stock_Price:  99.36831620942354
curr_Factors:  [99.36831621]
mat_Sqrt:  [[0.15]]
grads:  [-0.0915136]
Stock Position:  -0.09151359943437436
Bond Position:  [0.02364334]


portfolio before change:  [-9.05250475]
curr_Stock_Price:  99.17815079582637
curr_Factors:  [99.1781508]
mat_Sqrt:  [[0.15]]
grads:  [0.01650933]
Stock Position:  0.01650933362807546
Bond Position:  [-10.68986993]


portfolio before change:  [-9.05359983]
curr_Stock_Price:  99.15229008257589
curr_Factors:  [99.15229008]
mat_Sqrt:  [[0.15]]
grads:  [-0.01468161]
Stock Position:  -0.014681606423028874
Bond Position:  [-7.59788493]


portfolio before change:  [-9.04087481]
curr_Stock_Price:  98.25321239798686
curr_Factors:  [98.2532124]
mat_Sqrt:  [[0.15]]
grads:  [0.02585045]
Stock Position:  0.025850448910311324
Bond Position:  [-11.58076446]


portfolio before change:  [-9.03434052]
curr_Stock_Price:  98.53398537523711
curr_Factors:  [98.53398538]
mat_Sqrt:  [[0.15]]
grads:  [-0.05235239]
Stock Position:  -0.052352390244907
Bond Position:  [-3.87585087]


portfolio before change:  [-9.03932382]
curr_Stock_Price:  98.62454568349709
curr_Factors:  [98.62454568]
mat_Sqrt:  [[0.15]]
grads:  [0.01363804]
Stock Position:  0.013638037533573346
Bond Position:  [-10.38436907]


portfolio before change:  [-9.04371103]
curr_Stock_Price:  98.35044735968035
curr_Factors:  [98.35044736]
mat_Sqrt:  [[0.15]]
grads:  [-0.02566969]
Stock Position:  -0.025669693411954714
Bond Position:  [-6.51908519]


portfolio before change:  [-9.04816945]
curr_Stock_Price:  98.50825868304125
curr_Factors:  [98.50825868]
mat_Sqrt:  [[0.15]]
grads:  [-0.09140093]
Stock Position:  -0.09140093131695107
Bond Position:  [-0.04442286]


portfolio before change:  [-9.03596065]
curr_Stock_Price:  98.37465416384795
curr_Factors:  [98.37465416]
mat_Sqrt:  [[0.15]]
grads:  [-0.00749288]
Stock Position:  -0.0074928781760939325
Bond Position:  [-8.29885135]


portfolio before change:  [-9.0403392]
curr_Stock_Price:  98.88979091198283
curr_Factors:  [98.88979091]
mat_Sqrt:  [[0.15]]
grads:  [-0.05624582]
Stock Position:  -0.05624581941331821
Bond Position:  [-3.47820188]


portfolio before change:  [-9.02641193]
curr_Stock_Price:  98.63831154057218
curr_Factors:  [98.63831154]
mat_Sqrt:  [[0.15]]
grads:  [0.06069898]
Stock Position:  0.060698976091586934
Bond Position:  [-15.01365644]


portfolio before change:  [-9.01409185]
curr_Stock_Price:  98.85674127802855
curr_Factors:  [98.85674128]
mat_Sqrt:  [[0.15]]
grads:  [-0.02087557]
Stock Position:  -0.02087557175909218
Bond Position:  [-6.95040086]


portfolio before change:  [-9.0356716]
curr_Stock_Price:  99.86966352365808
curr_Factors:  [99.86966352]
mat_Sqrt:  [[0.15]]
grads:  [0.02419704]
Stock Position:  0.024197035439104998
Bond Position:  [-11.45222138]


portfolio before change:  [-9.02934694]
curr_Stock_Price:  100.16062644667892
curr_Factors:  [100.16062645]
mat_Sqrt:  [[0.15]]
grads:  [0.00753398]
Stock Position:  0.0075339806181389316
Bond Position:  [-9.78395516]


portfolio before change:  [-9.03438698]
curr_Stock_Price:  99.57281961786722
curr_Factors:  [99.57281962]
mat_Sqrt:  [[0.15]]
grads:  [-0.01085147]
Stock Position:  -0.010851471503531048
Bond Position:  [-7.95387537]


portfolio before change:  [-9.03946183]
curr_Stock_Price:  99.99467125841959
curr_Factors:  [99.99467126]
mat_Sqrt:  [[0.15]]
grads:  [0.01503849]
Stock Position:  0.015038487954462313
Bond Position:  [-10.54323049]


portfolio before change:  [-9.03959825]
curr_Stock_Price:  100.02941880900714
curr_Factors:  [100.02941881]
mat_Sqrt:  [[0.15]]
grads:  [0.05881965]
Stock Position:  0.05881965272291358
Bond Position:  [-14.92329393]


portfolio before change:  [-9.06902669]
curr_Stock_Price:  99.54495997756266
curr_Factors:  [99.54495998]
mat_Sqrt:  [[0.15]]
grads:  [0.11600624]
Stock Position:  0.11600623873312436
Bond Position:  [-20.61686308]


portfolio before change:  [-9.11593817]
curr_Stock_Price:  99.15168033826129
curr_Factors:  [99.15168034]
mat_Sqrt:  [[0.15]]
grads:  [-0.1734269]
Stock Position:  -0.1734268975159711
Bond Position:  [8.07963013]


portfolio before change:  [-9.07095767]
curr_Stock_Price:  98.89522930702363
curr_Factors:  [98.89522931]
mat_Sqrt:  [[0.15]]
grads:  [0.09271446]
Stock Position:  0.09271446295079186
Bond Position:  [-18.23997575]


portfolio before change:  [-9.09886538]
curr_Stock_Price:  98.60651844383571
curr_Factors:  [98.60651844]
mat_Sqrt:  [[0.15]]
grads:  [0.02196789]
Stock Position:  0.02196789258860546
Bond Position:  [-11.26504278]


portfolio before change:  [-9.09444198]
curr_Stock_Price:  98.83992649947788
curr_Factors:  [98.8399265]
mat_Sqrt:  [[0.15]]
grads:  [0.0341357]
Stock Position:  0.03413569768847775
Bond Position:  [-12.46841183]


portfolio before change:  [-9.09886813]
curr_Stock_Price:  98.73309269406764
curr_Factors:  [98.73309269]
mat_Sqrt:  [[0.15]]
grads:  [-0.09340253]
Stock Position:  -0.09340252637779534
Bond Position:  [0.12305217]


portfolio before change:  [-9.07372465]
curr_Stock_Price:  98.46398018331428
curr_Factors:  [98.46398018]
mat_Sqrt:  [[0.15]]
grads:  [-0.08414561]
Stock Position:  -0.0841456056556084
Bond Position:  [-0.7884134]


portfolio before change:  [-9.11226881]
curr_Stock_Price:  98.92145963807235
curr_Factors:  [98.92145964]
mat_Sqrt:  [[0.15]]
grads:  [-0.01005259]
Stock Position:  -0.010052592583139555
Bond Position:  [-8.11785168]


portfolio before change:  [-9.11014326]
curr_Stock_Price:  98.6595437323951
curr_Factors:  [98.65954373]
mat_Sqrt:  [[0.15]]
grads:  [-0.07797395]
Stock Position:  -0.07797394843206476
Bond Position:  [-1.41726909]


portfolio before change:  [-9.07035384]
curr_Stock_Price:  98.1481165181446
curr_Factors:  [98.14811652]
mat_Sqrt:  [[0.15]]
grads:  [-0.07156538]
Stock Position:  -0.07156537702666627
Bond Position:  [-2.04634688]


portfolio before change:  [-9.13256503]
curr_Stock_Price:  99.01562097538978
curr_Factors:  [99.01562098]
mat_Sqrt:  [[0.15]]
grads:  [0.08464752]
Stock Position:  0.08464752349719352
Bond Position:  [-17.51399213]


portfolio before change:  [-9.13951474]
curr_Stock_Price:  98.94645120434657
curr_Factors:  [98.9464512]
mat_Sqrt:  [[0.15]]
grads:  [0.01334549]
Stock Position:  0.01334548770988645
Bond Position:  [-10.46000338]


portfolio before change:  [-9.14317809]
curr_Stock_Price:  98.72093788248486
curr_Factors:  [98.72093788]
mat_Sqrt:  [[0.15]]
grads:  [0.05479296]
Stock Position:  0.05479295561113674
Bond Position:  [-14.55239006]


portfolio before change:  [-9.11260408]
curr_Stock_Price:  99.29552944094756
curr_Factors:  [99.29552944]
mat_Sqrt:  [[0.15]]
grads:  [-0.09937543]
Stock Position:  -0.09937543079220158
Bond Position:  [0.75493194]


portfolio before change:  [-9.12005683]
curr_Stock_Price:  99.37100018444812
curr_Factors:  [99.37100018]
mat_Sqrt:  [[0.15]]
grads:  [-0.03733745]
Stock Position:  -0.03733745081599219
Bond Position:  [-5.409797]


portfolio before change:  [-9.16013949]
curr_Stock_Price:  100.4354687634234
curr_Factors:  [100.43546876]
mat_Sqrt:  [[0.15]]
grads:  [-0.01161987]
Stock Position:  -0.01161986981745659
Bond Position:  [-7.99309242]


portfolio before change:  [-9.16063799]
curr_Stock_Price:  100.43537549945121
curr_Factors:  [100.4353755]
mat_Sqrt:  [[0.15]]
grads:  [0.01443683]
Stock Position:  0.014436825775900941
Bond Position:  [-10.61060601]


portfolio before change:  [-9.15884141]
curr_Stock_Price:  100.6057570617644
curr_Factors:  [100.60575706]
mat_Sqrt:  [[0.15]]
grads:  [0.05756796]
Stock Position:  0.05756796011334395
Bond Position:  [-14.95050962]


portfolio before change:  [-9.13062692]
curr_Stock_Price:  101.11209644567954
curr_Factors:  [101.11209645]
mat_Sqrt:  [[0.15]]
grads:  [0.04638293]
Stock Position:  0.04638293040564716
Bond Position:  [-13.82050225]


portfolio before change:  [-9.13879771]
curr_Stock_Price:  100.95456044931193
curr_Factors:  [100.95456045]
mat_Sqrt:  [[0.15]]
grads:  [-0.06360893]
Stock Position:  -0.06360893403586483
Bond Position:  [-2.71718573]


portfolio before change:  [-9.13425627]
curr_Stock_Price:  100.88049436113663
curr_Factors:  [100.88049436]
mat_Sqrt:  [[0.15]]
grads:  [0.00384228]
Stock Position:  0.003842283223211782
Bond Position:  [-9.5218677]


portfolio before change:  [-9.1319275]
curr_Stock_Price:  101.64147585750214
curr_Factors:  [101.64147586]
mat_Sqrt:  [[0.15]]
grads:  [-0.03883671]
Stock Position:  -0.03883671453000502
Bond Position:  [-5.18450652]


portfolio before change:  [-9.1420949]
curr_Stock_Price:  101.89493075791107
curr_Factors:  [101.89493076]
mat_Sqrt:  [[0.15]]
grads:  [0.09993876]
Stock Position:  0.09993875680156221
Bond Position:  [-19.3253476]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.1420949]
Stock Price:  101.31934043769122
PL:  [-10.46143534]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.38247216e-02]
 [ 1.81886376e-03]
 [ 4.90643959e-03]
 [ 3.02343697e-03]
 [ 1.30438962e-03]
 [ 1.21862030e-02]
 [-9.33980759e-04]
 [ 3.43387513e-02]
 [-2.23955137e-02]
 [ 4.51687668e-02]
 [ 9.80060016e-03]
 [-1.23387517e-02]
 [ 2.95619627e-02]
 [ 1.64884969e-02]
 [-2.19639907e-03]
 [-9.85845012e-03]
 [ 1.39593621e-02]
 [ 2.36424244e-02]
 [-2.42005905e-03]
 [-2.98822327e-03]
 [ 8.77973765e-03]
 [-8.55820149e-03]
 [-1.27678067e-02]
 [ 6.15617725e-03]
 [ 1.87598094e-02]
 [ 1.54170235e-02]
 [ 6.58747065e-03]
 [ 4.35226345e-03]
 [ 8.87178927e-03]
 [-9.64043662e-03]
 [-5.73491460e-03]
 [ 3.16449776e-02]
 [ 7.48941134e-03]
 [-1.02251618e-04]
 [-4.48070047e-03]
 [-4.44296526e-03]
 [-6.82234299e-03]
 [ 3.59980405e-03]
 [ 8.33148813e-04]
 [-1.06989434e-02]
 [-9.52738949e-04]
 [-2.90670100e-03]
 [ 5.34493356e-03]
 [-1.26184166e-02]
 [ 1.90399051e-03]
 [ 8.87970920e-04]
 [-1.37075731e-02]
 [-5.14137440e-03]
 [-6.44210096e-03]
 [ 4.65388463e-03]
 [-2.98037001e-03]
 [ 3.79807279e-03]
 [ 9.58236561e-05]
 [-1.69244843e-04]
 [ 2.18185546e-03]
 [ 8.56763202e-03]
 [-1.04976583e-03]
 [-2.19530666e-02]
 [ 1.40241234e-02]
 [ 7.54240563e-03]
 [ 7.77783366e-03]
 [-1.33752398e-02]
 [-1.25525313e-02]
 [-2.20346268e-03]
 [-1.52773365e-02]
 [ 4.16513643e-02]
 [ 1.62773958e-02]
 [ 2.27167828e-03]
 [ 6.57680625e-03]
 [-1.49214834e-02]
 [-5.18101494e-03]
 [ 6.00426803e-04]
 [ 1.53551466e-03]
 [ 8.61674664e-03]
 [ 6.46486598e-03]
 [-4.01495117e-03]
 [-6.21236516e-03]
 [-9.78804658e-03]
 [-2.52439380e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.9326032]
curr_Stock_Price:  100.24848038117375
curr_Factors:  [100.24848038]
mat_Sqrt:  [[0.15]]
grads:  [-0.29216481]
Stock Position:  -0.2921648107315501
Bond Position:  [35.2216815]


portfolio before change:  [5.66297639]
curr_Stock_Price:  101.17887386807449
curr_Factors:  [101.17887387]
mat_Sqrt:  [[0.15]]
grads:  [0.01212576]
Stock Position:  0.012125758399986196
Bond Position:  [4.43610581]


portfolio before change:  [5.66312793]
curr_Stock_Price:  101.1685057450459
curr_Factors:  [101.16850575]
mat_Sqrt:  [[0.15]]
grads:  [0.0327096]
Stock Position:  0.03270959727629019
Bond Position:  [2.35394685]


portfolio before change:  [5.67353255]
curr_Stock_Price:  101.482098687077
curr_Factors:  [101.48209869]
mat_Sqrt:  [[0.15]]
grads:  [0.02015625]
Stock Position:  0.020156246479251218
Bond Position:  [3.62803436]


portfolio before change:  [5.68369949]
curr_Stock_Price:  101.97525481329916
curr_Factors:  [101.97525481]
mat_Sqrt:  [[0.15]]
grads:  [0.00869593]
Stock Position:  0.008695930803895592
Bond Position:  [4.79692973]


portfolio before change:  [5.69285552]
curr_Stock_Price:  102.99368671284618
curr_Factors:  [102.99368671]
mat_Sqrt:  [[0.15]]
grads:  [0.08124135]
Stock Position:  0.08124135361856578
Bond Position:  [-2.674491]


portfolio before change:  [5.66473644]
curr_Stock_Price:  102.64962643970217
curr_Factors:  [102.64962644]
mat_Sqrt:  [[0.15]]
grads:  [-0.00622654]
Stock Position:  -0.00622653839012168
Bond Position:  [6.30388828]


portfolio before change:  [5.65852101]
curr_Stock_Price:  103.71112078114628
curr_Factors:  [103.71112078]
mat_Sqrt:  [[0.15]]
grads:  [0.22892501]
Stock Position:  0.22892500891945067
Bond Position:  [-18.08354824]


portfolio before change:  [5.65163051]
curr_Stock_Price:  103.68595866210582
curr_Factors:  [103.68595866]
mat_Sqrt:  [[0.15]]
grads:  [-0.14930342]
Stock Position:  -0.1493034246768034
Bond Position:  [21.13229923]


portfolio before change:  [5.69570649]
curr_Stock_Price:  103.39959437809009
curr_Factors:  [103.39959438]
mat_Sqrt:  [[0.15]]
grads:  [0.30112511]
Stock Position:  0.3011251117784095
Bond Position:  [-25.44050792]


portfolio before change:  [5.8398585]
curr_Stock_Price:  103.88358619857985
curr_Factors:  [103.8835862]
mat_Sqrt:  [[0.15]]
grads:  [0.06533733]
Stock Position:  0.06533733437558498
Bond Position:  [-0.94761811]


portfolio before change:  [5.77276373]
curr_Stock_Price:  102.85759480670308
curr_Factors:  [102.85759481]
mat_Sqrt:  [[0.15]]
grads:  [-0.08225834]
Stock Position:  -0.08225834497163352
Bond Position:  [14.23365925]


portfolio before change:  [5.78021105]
curr_Stock_Price:  102.7778741669972
curr_Factors:  [102.77787417]
mat_Sqrt:  [[0.15]]
grads:  [0.19707975]
Stock Position:  0.19707975153368656
Bond Position:  [-14.47522685]


portfolio before change:  [5.78499916]
curr_Stock_Price:  102.8067601509042
curr_Factors:  [102.80676015]
mat_Sqrt:  [[0.15]]
grads:  [0.10992331]
Stock Position:  0.10992331278003384
Bond Position:  [-5.51586049]


portfolio before change:  [5.70359854]
curr_Stock_Price:  102.06937457170397
curr_Factors:  [102.06937457]
mat_Sqrt:  [[0.15]]
grads:  [-0.01464266]
Stock Position:  -0.014642660455009514
Bond Position:  [7.19816574]


portfolio before change:  [5.7003212]
curr_Stock_Price:  102.32392116049932
curr_Factors:  [102.32392116]
mat_Sqrt:  [[0.15]]
grads:  [-0.065723]
Stock Position:  -0.06572300077594037
Bond Position:  [12.42535635]


portfolio before change:  [5.6244165]
curr_Stock_Price:  103.49065600929977
curr_Factors:  [103.49065601]
mat_Sqrt:  [[0.15]]
grads:  [0.09306241]
Stock Position:  0.09306241432497878
Bond Position:  [-4.00667381]


portfolio before change:  [5.61818383]
curr_Stock_Price:  103.42637391158607
curr_Factors:  [103.42637391]
mat_Sqrt:  [[0.15]]
grads:  [0.15761616]
Stock Position:  0.1576161627130426
Bond Position:  [-10.68348435]


portfolio before change:  [5.62079856]
curr_Stock_Price:  103.44719966841846
curr_Factors:  [103.44719967]
mat_Sqrt:  [[0.15]]
grads:  [-0.01613373]
Stock Position:  -0.016133726980621377
Bond Position:  [7.28978744]


portfolio before change:  [5.62290387]
curr_Stock_Price:  103.34494919336096
curr_Factors:  [103.34494919]
mat_Sqrt:  [[0.15]]
grads:  [-0.01992149]
Stock Position:  -0.019921488439009333
Bond Position:  [7.68168908]


portfolio before change:  [5.60837625]
curr_Stock_Price:  104.09829365451137
curr_Factors:  [104.09829365]
mat_Sqrt:  [[0.15]]
grads:  [0.05853158]
Stock Position:  0.058531584314576494
Bond Position:  [-0.4846618]


portfolio before change:  [5.6597975]
curr_Stock_Price:  104.97733268712493
curr_Factors:  [104.97733269]
mat_Sqrt:  [[0.15]]
grads:  [-0.05705468]
Stock Position:  -0.05705467663017124
Bond Position:  [11.64924527]


portfolio before change:  [5.63493367]
curr_Stock_Price:  105.42588370826755
curr_Factors:  [105.42588371]
mat_Sqrt:  [[0.15]]
grads:  [-0.08511871]
Stock Position:  -0.08511871134345934
Bond Position:  [14.60864903]


portfolio before change:  [5.69247902]
curr_Stock_Price:  104.7605507915167
curr_Factors:  [104.76055079]
mat_Sqrt:  [[0.15]]
grads:  [0.04104118]
Stock Position:  0.041041181669673125
Bond Position:  [1.39298222]


portfolio before change:  [5.68457983]
curr_Stock_Price:  104.56595963463843
curr_Factors:  [104.56595963]
mat_Sqrt:  [[0.15]]
grads:  [0.1250654]
Stock Position:  0.12506539601198546
Bond Position:  [-7.39300332]


portfolio before change:  [5.63807326]
curr_Stock_Price:  104.19779629275553
curr_Factors:  [104.19779629]
mat_Sqrt:  [[0.15]]
grads:  [0.10278016]
Stock Position:  0.10278015667812937
Bond Position:  [-5.07139257]


portfolio before change:  [5.70210451]
curr_Stock_Price:  104.82387256909144
curr_Factors:  [104.82387257]
mat_Sqrt:  [[0.15]]
grads:  [0.04391647]
Stock Position:  0.043916471009990625
Bond Position:  [1.09860995]


portfolio before change:  [5.6953899]
curr_Stock_Price:  104.66941415823204
curr_Factors:  [104.66941416]
mat_Sqrt:  [[0.15]]
grads:  [0.02901509]
Stock Position:  0.02901508969840957
Bond Position:  [2.65839746]


portfolio before change:  [5.69007504]
curr_Stock_Price:  104.48051171770462
curr_Factors:  [104.48051172]
mat_Sqrt:  [[0.15]]
grads:  [0.05914526]
Stock Position:  0.05914526182054258
Bond Position:  [-0.48945218]


portfolio before change:  [5.65805056]
curr_Stock_Price:  103.93957429997367
curr_Factors:  [103.9395743]
mat_Sqrt:  [[0.15]]
grads:  [-0.06426958]
Stock Position:  -0.06426957749973453
Bond Position:  [12.33820309]


portfolio before change:  [5.69000785]
curr_Stock_Price:  103.4543349461525
curr_Factors:  [103.45433495]
mat_Sqrt:  [[0.15]]
grads:  [-0.03823276]
Stock Position:  -0.03823276396796342
Bond Position:  [9.64535302]


portfolio before change:  [5.74098814]
curr_Stock_Price:  102.13668417072682
curr_Factors:  [102.13668417]
mat_Sqrt:  [[0.15]]
grads:  [0.21096652]
Stock Position:  0.21096651734195349
Bond Position:  [-15.80643242]


portfolio before change:  [5.7069483]
curr_Stock_Price:  101.98001521897415
curr_Factors:  [101.98001522]
mat_Sqrt:  [[0.15]]
grads:  [0.04992941]
Stock Position:  0.04992940895444317
Bond Position:  [0.61514641]


portfolio before change:  [5.7202441]
curr_Stock_Price:  102.24553709727371
curr_Factors:  [102.2455371]
mat_Sqrt:  [[0.15]]
grads:  [-0.00068168]
Stock Position:  -0.0006816774551757857
Bond Position:  [5.78994258]


portfolio before change:  [5.72047714]
curr_Stock_Price:  102.4345358940272
curr_Factors:  [102.43453589]
mat_Sqrt:  [[0.15]]
grads:  [-0.02987134]
Stock Position:  -0.0298713364734636
Bond Position:  [8.78033363]


portfolio before change:  [5.73501631]
curr_Stock_Price:  101.96618117436326
curr_Factors:  [101.96618117]
mat_Sqrt:  [[0.15]]
grads:  [-0.02961977]
Stock Position:  -0.029619768432064757
Bond Position:  [8.75523099]


portfolio before change:  [5.72451302]
curr_Stock_Price:  102.33926014869938
curr_Factors:  [102.33926015]
mat_Sqrt:  [[0.15]]
grads:  [-0.04548229]
Stock Position:  -0.04548228660653671
Bond Position:  [10.37913658]


portfolio before change:  [5.70739304]
curr_Stock_Price:  102.72993312953521
curr_Factors:  [102.72993313]
mat_Sqrt:  [[0.15]]
grads:  [0.02399869]
Stock Position:  0.0239986936661073
Bond Position:  [3.24200884]


portfolio before change:  [5.68549554]
curr_Stock_Price:  101.80904438552486
curr_Factors:  [101.80904439]
mat_Sqrt:  [[0.15]]
grads:  [0.00555433]
Stock Position:  0.005554325416812564
Bond Position:  [5.12001498]


portfolio before change:  [5.68212848]
curr_Stock_Price:  101.14522489587992
curr_Factors:  [101.1452249]
mat_Sqrt:  [[0.15]]
grads:  [-0.07132629]
Stock Position:  -0.07132628906074767
Bond Position:  [12.89644203]


portfolio before change:  [5.74347679]
curr_Stock_Price:  100.29641786499228
curr_Factors:  [100.29641786]
mat_Sqrt:  [[0.15]]
grads:  [-0.00635159]
Stock Position:  -0.006351592993856954
Bond Position:  [6.38051882]


portfolio before change:  [5.74563787]
curr_Stock_Price:  100.01896196366934
curr_Factors:  [100.01896196]
mat_Sqrt:  [[0.15]]
grads:  [-0.01937801]
Stock Position:  -0.01937800669230714
Bond Position:  [7.68380599]


portfolio before change:  [5.74828664]
curr_Stock_Price:  99.90705604015137
curr_Factors:  [99.90705604]
mat_Sqrt:  [[0.15]]
grads:  [0.03563289]
Stock Position:  0.03563289038369421
Bond Position:  [2.18830946]


portfolio before change:  [5.76437461]
curr_Stock_Price:  100.35470993727694
curr_Factors:  [100.35470994]
mat_Sqrt:  [[0.15]]
grads:  [-0.08412278]
Stock Position:  -0.08412277765414085
Bond Position:  [14.20649157]


portfolio before change:  [5.7300149]
curr_Stock_Price:  100.77371241734691
curr_Factors:  [100.77371242]
mat_Sqrt:  [[0.15]]
grads:  [0.01269327]
Stock Position:  0.012693270055234507
Bond Position:  [4.45086695]


portfolio before change:  [5.73066026]
curr_Stock_Price:  100.80263941606538
curr_Factors:  [100.80263942]
mat_Sqrt:  [[0.15]]
grads:  [0.00591981]
Stock Position:  0.005919806131561719
Bond Position:  [5.13392818]


portfolio before change:  [5.72942191]
curr_Stock_Price:  100.53924639131536
curr_Factors:  [100.53924639]
mat_Sqrt:  [[0.15]]
grads:  [-0.09138382]
Stock Position:  -0.09138382096804278
Bond Position:  [14.9170824]


portfolio before change:  [5.74677993]
curr_Stock_Price:  100.35950255876922
curr_Factors:  [100.35950256]
mat_Sqrt:  [[0.15]]
grads:  [-0.03427583]
Stock Position:  -0.03427582935730639
Bond Position:  [9.18668512]


portfolio before change:  [5.76098905]
curr_Stock_Price:  99.96170248429371
curr_Factors:  [99.96170248]
mat_Sqrt:  [[0.15]]
grads:  [-0.04294734]
Stock Position:  -0.04294733970056259
Bond Position:  [10.05407824]


portfolio before change:  [5.72862588]
curr_Stock_Price:  100.72988905091135
curr_Factors:  [100.72988905]
mat_Sqrt:  [[0.15]]
grads:  [0.0310259]
Stock Position:  0.031025897544104456
Bond Position:  [2.60339066]


portfolio before change:  [5.72088749]
curr_Stock_Price:  100.47522745954487
curr_Factors:  [100.47522746]
mat_Sqrt:  [[0.15]]
grads:  [-0.01986913]
Stock Position:  -0.019869133418746653
Bond Position:  [7.71724319]


portfolio before change:  [5.71105925]
curr_Stock_Price:  100.99415189818964
curr_Factors:  [100.9941519]
mat_Sqrt:  [[0.15]]
grads:  [0.02532049]
Stock Position:  0.02532048526094503
Bond Position:  [3.15383832]


portfolio before change:  [5.71051485]
curr_Stock_Price:  100.96486639110822
curr_Factors:  [100.96486639]
mat_Sqrt:  [[0.15]]
grads:  [0.00063882]
Stock Position:  0.0006388243739835516
Bond Position:  [5.64601603]


portfolio before change:  [5.7107896]
curr_Stock_Price:  100.8425535631937
curr_Factors:  [100.84255356]
mat_Sqrt:  [[0.15]]
grads:  [-0.0011283]
Stock Position:  -0.0011282989552513386
Bond Position:  [5.82457015]


portfolio before change:  [5.71178069]
curr_Stock_Price:  100.28681304767258
curr_Factors:  [100.28681305]
mat_Sqrt:  [[0.15]]
grads:  [0.0145457]
Stock Position:  0.014545703066348966
Bond Position:  [4.25303848]


portfolio before change:  [5.71839337]
curr_Stock_Price:  100.72315184094316
curr_Factors:  [100.72315184]
mat_Sqrt:  [[0.15]]
grads:  [0.05711755]
Stock Position:  0.05711754678123314
Bond Position:  [-0.03466597]


portfolio before change:  [5.71760377]
curr_Stock_Price:  100.70936567480243
curr_Factors:  [100.70936567]
mat_Sqrt:  [[0.15]]
grads:  [-0.00699844]
Stock Position:  -0.006998438890612061
Bond Position:  [6.42241211]


portfolio before change:  [5.72117916]
curr_Stock_Price:  100.25583897151476
curr_Factors:  [100.25583897]
mat_Sqrt:  [[0.15]]
grads:  [-0.14635378]
Stock Position:  -0.14635377738901403
Bond Position:  [20.3939999]


portfolio before change:  [5.80834444]
curr_Stock_Price:  99.66896913213947
curr_Factors:  [99.66896913]
mat_Sqrt:  [[0.15]]
grads:  [0.09349416]
Stock Position:  0.09349415618805186
Bond Position:  [-3.51012172]


portfolio before change:  [5.82039072]
curr_Stock_Price:  99.80016098520683
curr_Factors:  [99.80016099]
mat_Sqrt:  [[0.15]]
grads:  [0.0502827]
Stock Position:  0.050282704192384675
Bond Position:  [0.80216875]


portfolio before change:  [5.84951678]
curr_Stock_Price:  100.37840986122403
curr_Factors:  [100.37840986]
mat_Sqrt:  [[0.15]]
grads:  [0.05185222]
Stock Position:  0.051852224410097535
Bond Position:  [0.64467294]


portfolio before change:  [5.90191683]
curr_Stock_Price:  101.3881979728546
curr_Factors:  [101.38819797]
mat_Sqrt:  [[0.15]]
grads:  [-0.08916827]
Stock Position:  -0.08916826505794703
Bond Position:  [14.94252654]


portfolio before change:  [5.96274795]
curr_Stock_Price:  100.71646590187669
curr_Factors:  [100.7164659]
mat_Sqrt:  [[0.15]]
grads:  [-0.08368354]
Stock Position:  -0.08368354214465036
Bond Position:  [14.39105857]


portfolio before change:  [5.99542389]
curr_Stock_Price:  100.33674410555285
curr_Factors:  [100.33674411]
mat_Sqrt:  [[0.15]]
grads:  [-0.01468975]
Stock Position:  -0.014689751226556354
Bond Position:  [7.4693457]


portfolio before change:  [6.00124748]
curr_Stock_Price:  99.9720856197471
curr_Factors:  [99.97208562]
mat_Sqrt:  [[0.15]]
grads:  [-0.10184891]
Stock Position:  -0.10184891029391487
Bond Position:  [16.18329546]


portfolio before change:  [5.99406137]
curr_Stock_Price:  100.05257343257381
curr_Factors:  [100.05257343]
mat_Sqrt:  [[0.15]]
grads:  [0.27767576]
Stock Position:  0.27767576173406566
Bond Position:  [-21.78811317]


portfolio before change:  [5.91791939]
curr_Stock_Price:  99.78326587416477
curr_Factors:  [99.78326587]
mat_Sqrt:  [[0.15]]
grads:  [0.10851597]
Stock Position:  0.1085159722979857
Bond Position:  [-4.91015873]


portfolio before change:  [5.91560682]
curr_Stock_Price:  99.76478308882504
curr_Factors:  [99.76478309]
mat_Sqrt:  [[0.15]]
grads:  [0.01514452]
Stock Position:  0.015144521876807513
Bond Position:  [4.40471688]


portfolio before change:  [5.91558533]
curr_Stock_Price:  99.74518615240207
curr_Factors:  [99.74518615]
mat_Sqrt:  [[0.15]]
grads:  [0.04384538]
Stock Position:  0.04384537501573171
Bond Position:  [1.54222024]


portfolio before change:  [5.89541374]
curr_Stock_Price:  99.28292573433433
curr_Factors:  [99.28292573]
mat_Sqrt:  [[0.15]]
grads:  [-0.09947656]
Stock Position:  -0.09947655603647941
Bond Position:  [15.77173727]


portfolio before change:  [5.91722482]
curr_Stock_Price:  99.07357677424902
curr_Factors:  [99.07357677]
mat_Sqrt:  [[0.15]]
grads:  [-0.0345401]
Stock Position:  -0.03454009957670677
Bond Position:  [9.33923603]


portfolio before change:  [5.93593186]
curr_Stock_Price:  98.54887316326612
curr_Factors:  [98.54887316]
mat_Sqrt:  [[0.15]]
grads:  [0.00400285]
Stock Position:  0.004002845354896462
Bond Position:  [5.54145596]


portfolio before change:  [5.93689861]
curr_Stock_Price:  98.70386417779052
curr_Factors:  [98.70386418]
mat_Sqrt:  [[0.15]]
grads:  [0.01023676]
Stock Position:  0.010236764418597643
Bond Position:  [4.92649041]


portfolio before change:  [5.93547791]
curr_Stock_Price:  98.53499990482089
curr_Factors:  [98.5349999]
mat_Sqrt:  [[0.15]]
grads:  [0.05744498]
Stock Position:  0.05744497759068423
Bond Position:  [0.27513704]


portfolio before change:  [5.93398425]
curr_Stock_Price:  98.50869906253456
curr_Factors:  [98.50869906]
mat_Sqrt:  [[0.15]]
grads:  [0.04309911]
Stock Position:  0.043099106555149355
Bond Position:  [1.68834733]


portfolio before change:  [5.94958155]
curr_Stock_Price:  98.86814451374262
curr_Factors:  [98.86814451]
mat_Sqrt:  [[0.15]]
grads:  [-0.02676634]
Stock Position:  -0.026766341106100565
Bond Position:  [8.59592003]


portfolio before change:  [5.95448333]
curr_Stock_Price:  98.70508480903004
curr_Factors:  [98.70508481]
mat_Sqrt:  [[0.15]]
grads:  [-0.04141577]
Stock Position:  -0.04141576775252193
Bond Position:  [10.0424302]


portfolio before change:  [5.95869276]
curr_Stock_Price:  98.6186018767299
curr_Factors:  [98.61860188]
mat_Sqrt:  [[0.15]]
grads:  [-0.06525364]
Stock Position:  -0.06525364385895194
Bond Position:  [12.39391588]


portfolio before change:  [5.89948523]
curr_Stock_Price:  99.53781759018968
curr_Factors:  [99.53781759]
mat_Sqrt:  [[0.15]]
grads:  [-0.01682929]
Stock Position:  -0.016829291971153817
Bond Position:  [7.57463622]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.89948523]
Stock Price:  99.29390494169026
PL:  [5.89948523]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.37660468e-02]
 [-1.70885771e-03]
 [ 1.05214298e-04]
 [ 2.31702914e-03]
 [ 5.37961922e-03]
 [ 1.19461369e-02]
 [ 1.21284477e-03]
 [ 1.29682278e-02]
 [ 1.01173575e-02]
 [-1.62357907e-02]
 [ 9.94363422e-03]
 [-8.26750473e-03]
 [ 8.98432604e-03]
 [ 4.09800695e-03]
 [ 5.01825093e-03]
 [-1.01643530e-02]
 [ 8.00306120e-03]
 [ 1.56767934e-02]
 [ 2.24117248e-02]
 [ 1.80237703e-03]
 [ 7.16553620e-02]
 [-1.29538049e-02]
 [ 8.66756843e-03]
 [-4.21534772e-03]
 [ 1.74663773e-02]
 [ 1.80619893e-02]
 [ 1.09590916e-02]
 [ 6.81053966e-03]
 [ 5.52144977e-03]
 [-1.73393055e-02]
 [-5.24291627e-03]
 [ 3.12276513e-02]
 [ 7.39657662e-03]
 [ 5.53517235e-03]
 [ 1.82794949e-03]
 [-4.56640333e-03]
 [-6.18015103e-03]
 [ 1.27693080e-02]
 [-2.06284700e-03]
 [-1.33683294e-02]
 [-1.01886886e-03]
 [-2.90334022e-03]
 [ 5.59285969e-03]
 [-1.16272940e-02]
 [ 1.80785422e-03]
 [-8.87747397e-04]
 [-1.37043638e-02]
 [-5.15421127e-03]
 [-8.42883066e-04]
 [ 1.67682125e-03]
 [-2.98056007e-03]
 [ 3.79983058e-03]
 [ 7.57756151e-04]
 [-1.35427522e-03]
 [ 2.48714822e-03]
 [ 8.56717389e-03]
 [-9.88992955e-03]
 [-1.69998343e-02]
 [ 1.34108121e-02]
 [ 6.51040721e-03]
 [ 7.91828457e-03]
 [-1.25274853e-02]
 [-1.25424575e-02]
 [-2.25847144e-03]
 [-2.01155927e-02]
 [ 3.63168031e-02]
 [ 2.24101925e-02]
 [ 2.25871245e-03]
 [ 6.58511799e-03]
 [-1.44126998e-02]
 [-5.87254585e-03]
 [-4.52163562e-04]
 [ 1.98528066e-03]
 [ 8.78126705e-03]
 [ 1.26935606e-02]
 [-8.43230740e-03]
 [-1.42734263e-03]
 [-7.74418985e-03]
 [ 7.38575084e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.59624943]
curr_Stock_Price:  99.96978006433994
curr_Factors:  [99.96978006]
mat_Sqrt:  [[0.15]]
grads:  [-0.22510698]
Stock Position:  -0.2251069787948709
Bond Position:  [24.10014459]


portfolio before change:  [1.60979272]
curr_Stock_Price:  99.91630779060307
curr_Factors:  [99.91630779]
mat_Sqrt:  [[0.15]]
grads:  [-0.01139238]
Stock Position:  -0.011392384758330454
Bond Position:  [2.74807774]


portfolio before change:  [1.60524204]
curr_Stock_Price:  100.33083392064991
curr_Factors:  [100.33083392]
mat_Sqrt:  [[0.15]]
grads:  [0.00070143]
Stock Position:  0.0007014286541736093
Bond Position:  [1.53486712]


portfolio before change:  [1.60554114]
curr_Stock_Price:  100.62048676616713
curr_Factors:  [100.62048677]
mat_Sqrt:  [[0.15]]
grads:  [0.01544686]
Stock Position:  0.015446860921769265
Bond Position:  [0.05127048]


portfolio before change:  [1.60812504]
curr_Stock_Price:  100.7875558802934
curr_Factors:  [100.78755588]
mat_Sqrt:  [[0.15]]
grads:  [0.03586413]
Stock Position:  0.03586412814069905
Bond Position:  [-2.00653278]


portfolio before change:  [1.58654805]
curr_Stock_Price:  100.18942127866578
curr_Factors:  [100.18942128]
mat_Sqrt:  [[0.15]]
grads:  [0.07964091]
Stock Position:  0.07964091250935192
Bond Position:  [-6.39262888]


portfolio before change:  [1.58482191]
curr_Stock_Price:  100.17276409591581
curr_Factors:  [100.1727641]
mat_Sqrt:  [[0.15]]
grads:  [0.00808563]
Stock Position:  0.008085631787322266
Bond Position:  [0.77486182]


portfolio before change:  [1.57920886]
curr_Stock_Price:  99.47257448304977
curr_Factors:  [99.47257448]
mat_Sqrt:  [[0.15]]
grads:  [0.08645485]
Stock Position:  0.08645485222061301
Bond Position:  [-7.02067786]


portfolio before change:  [1.64097465]
curr_Stock_Price:  100.19207824602336
curr_Factors:  [100.19207825]
mat_Sqrt:  [[0.15]]
grads:  [0.06744905]
Stock Position:  0.06744905023008894
Bond Position:  [-5.11688587]


portfolio before change:  [1.72518793]
curr_Stock_Price:  101.44536647035623
curr_Factors:  [101.44536647]
mat_Sqrt:  [[0.15]]
grads:  [-0.1082386]
Stock Position:  -0.10823860468097894
Bond Position:  [12.70549285]


portfolio before change:  [1.65291587]
curr_Stock_Price:  102.12041380480778
curr_Factors:  [102.1204138]
mat_Sqrt:  [[0.15]]
grads:  [0.06629089]
Stock Position:  0.06629089476703012
Bond Position:  [-5.11673774]


portfolio before change:  [1.60715857]
curr_Stock_Price:  101.4349880177995
curr_Factors:  [101.43498802]
mat_Sqrt:  [[0.15]]
grads:  [-0.0551167]
Stock Position:  -0.05511669822884762
Bond Position:  [7.1979202]


portfolio before change:  [1.62624118]
curr_Stock_Price:  101.09692862247942
curr_Factors:  [101.09692862]
mat_Sqrt:  [[0.15]]
grads:  [0.05989551]
Stock Position:  0.05989550692060742
Bond Position:  [-4.42901061]


portfolio before change:  [1.63196306]
curr_Stock_Price:  101.19708152344795
curr_Factors:  [101.19708152]
mat_Sqrt:  [[0.15]]
grads:  [0.02732005]
Stock Position:  0.027320046309598386
Bond Position:  [-1.13274589]


portfolio before change:  [1.62346663]
curr_Stock_Price:  100.8886765425571
curr_Factors:  [100.88867654]
mat_Sqrt:  [[0.15]]
grads:  [0.03345501]
Stock Position:  0.03345500620099681
Bond Position:  [-1.75176467]


portfolio before change:  [1.63185286]
curr_Stock_Price:  101.1426212740837
curr_Factors:  [101.14262127]
mat_Sqrt:  [[0.15]]
grads:  [-0.06776235]
Stock Position:  -0.06776235339393659
Bond Position:  [8.48551491]


portfolio before change:  [1.56899345]
curr_Stock_Price:  102.07809311171685
curr_Factors:  [102.07809311]
mat_Sqrt:  [[0.15]]
grads:  [0.05335374]
Stock Position:  0.05335374135999548
Bond Position:  [-3.87725473]


portfolio before change:  [1.49871551]
curr_Stock_Price:  100.76542781080941
curr_Factors:  [100.76542781]
mat_Sqrt:  [[0.15]]
grads:  [0.10451196]
Stock Position:  0.10451195583213602
Bond Position:  [-9.03247643]


portfolio before change:  [1.47876548]
curr_Stock_Price:  100.57994203549933
curr_Factors:  [100.57994204]
mat_Sqrt:  [[0.15]]
grads:  [0.1494115]
Stock Position:  0.1494114987193731
Bond Position:  [-13.5490344]


portfolio before change:  [1.51217239]
curr_Stock_Price:  100.80919985816281
curr_Factors:  [100.80919986]
mat_Sqrt:  [[0.15]]
grads:  [0.01201585]
Stock Position:  0.012015846834169092
Bond Position:  [0.30086449]


portfolio before change:  [1.51573486]
curr_Stock_Price:  101.10411584741203
curr_Factors:  [101.10411585]
mat_Sqrt:  [[0.15]]
grads:  [0.47770241]
Stock Position:  0.4777024136591504
Bond Position:  [-46.78194531]


portfolio before change:  [1.80307117]
curr_Stock_Price:  101.71173318289493
curr_Factors:  [101.71173318]
mat_Sqrt:  [[0.15]]
grads:  [-0.0863587]
Stock Position:  -0.08635869940077708
Bond Position:  [10.58676416]


portfolio before change:  [1.77513987]
curr_Stock_Price:  102.0428288380323
curr_Factors:  [102.04282884]
mat_Sqrt:  [[0.15]]
grads:  [0.05778379]
Stock Position:  0.057783789541648936
Bond Position:  [-4.12128148]


portfolio before change:  [1.76200537]
curr_Stock_Price:  101.81998233929534
curr_Factors:  [101.81998234]
mat_Sqrt:  [[0.15]]
grads:  [-0.02810232]
Stock Position:  -0.028102318102576827
Bond Position:  [4.6233829]


portfolio before change:  [1.74234868]
curr_Stock_Price:  102.52973381994697
curr_Factors:  [102.52973382]
mat_Sqrt:  [[0.15]]
grads:  [0.11644252]
Stock Position:  0.11644251530801962
Bond Position:  [-10.19647142]


portfolio before change:  [1.68435337]
curr_Stock_Price:  102.03714737273215
curr_Factors:  [102.03714737]
mat_Sqrt:  [[0.15]]
grads:  [0.12041326]
Stock Position:  0.12041326196028884
Bond Position:  [-10.60227239]


portfolio before change:  [1.68054759]
curr_Stock_Price:  102.01104457600282
curr_Factors:  [102.01104458]
mat_Sqrt:  [[0.15]]
grads:  [0.07306061]
Stock Position:  0.0730606109036181
Bond Position:  [-5.77244165]


portfolio before change:  [1.6809122]
curr_Stock_Price:  102.0209734167881
curr_Factors:  [102.02097342]
mat_Sqrt:  [[0.15]]
grads:  [0.0454036]
Stock Position:  0.04540359773055981
Bond Position:  [-2.95120703]


portfolio before change:  [1.68847196]
curr_Stock_Price:  102.19153722734904
curr_Factors:  [102.19153723]
mat_Sqrt:  [[0.15]]
grads:  [0.03680967]
Stock Position:  0.03680966515610417
Bond Position:  [-2.07316431]


portfolio before change:  [1.69182283]
curr_Stock_Price:  102.28608980809186
curr_Factors:  [102.28608981]
mat_Sqrt:  [[0.15]]
grads:  [-0.11559537]
Stock Position:  -0.11559536966951292
Bond Position:  [13.51562119]


portfolio before change:  [1.811792]
curr_Stock_Price:  101.25556046198743
curr_Factors:  [101.25556046]
mat_Sqrt:  [[0.15]]
grads:  [-0.03495278]
Stock Position:  -0.034952775135399176
Bond Position:  [5.35095484]


portfolio before change:  [1.78219882]
curr_Stock_Price:  102.11179077660414
curr_Factors:  [102.11179078]
mat_Sqrt:  [[0.15]]
grads:  [0.20818434]
Stock Position:  0.2081843422809544
Bond Position:  [-19.47587718]


portfolio before change:  [1.764378]
curr_Stock_Price:  102.03203673919802
curr_Factors:  [102.03203674]
mat_Sqrt:  [[0.15]]
grads:  [0.04931051]
Stock Position:  0.04931051083048693
Bond Position:  [-3.26687385]


portfolio before change:  [1.74318932]
curr_Stock_Price:  101.60647846298899
curr_Factors:  [101.60647846]
mat_Sqrt:  [[0.15]]
grads:  [0.03690115]
Stock Position:  0.036901148980588175
Bond Position:  [-2.00620648]


portfolio before change:  [1.72653171]
curr_Stock_Price:  101.15846492896692
curr_Factors:  [101.15846493]
mat_Sqrt:  [[0.15]]
grads:  [0.01218633]
Stock Position:  0.012186329942328543
Bond Position:  [0.49378128]


portfolio before change:  [1.72532472]
curr_Stock_Price:  101.05688767205851
curr_Factors:  [101.05688767]
mat_Sqrt:  [[0.15]]
grads:  [-0.03044269]
Stock Position:  -0.03044268883602692
Bond Position:  [4.80176811]


portfolio before change:  [1.73105872]
curr_Stock_Price:  100.87839234785709
curr_Factors:  [100.87839235]
mat_Sqrt:  [[0.15]]
grads:  [-0.04120101]
Stock Position:  -0.04120100687300353
Bond Position:  [5.88735006]


portfolio before change:  [1.72552874]
curr_Stock_Price:  101.02154299411694
curr_Factors:  [101.02154299]
mat_Sqrt:  [[0.15]]
grads:  [0.08512872]
Stock Position:  0.08512871994775412
Bond Position:  [-6.8743059]


portfolio before change:  [1.69802562]
curr_Stock_Price:  100.70351327187186
curr_Factors:  [100.70351327]
mat_Sqrt:  [[0.15]]
grads:  [-0.01375231]
Stock Position:  -0.013752313349492663
Bond Position:  [3.08293189]


portfolio before change:  [1.70404721]
curr_Stock_Price:  100.27966411507846
curr_Factors:  [100.27966412]
mat_Sqrt:  [[0.15]]
grads:  [-0.0891222]
Stock Position:  -0.08912219629722168
Bond Position:  [10.64119112]


portfolio before change:  [1.7081287]
curr_Stock_Price:  100.24133030331012
curr_Factors:  [100.2413303]
mat_Sqrt:  [[0.15]]
grads:  [-0.00679246]
Stock Position:  -0.006792459067997206
Bond Position:  [2.38901384]


portfolio before change:  [1.71013596]
curr_Stock_Price:  99.96780002717193
curr_Factors:  [99.96780003]
mat_Sqrt:  [[0.15]]
grads:  [-0.0193556]
Stock Position:  -0.019355601480006552
Bond Position:  [3.64507286]


portfolio before change:  [1.70977069]
curr_Stock_Price:  99.99844207773438
curr_Factors:  [99.99844208]
mat_Sqrt:  [[0.15]]
grads:  [0.03728573]
Stock Position:  0.03728573128308269
Bond Position:  [-2.01874435]


portfolio before change:  [1.71193803]
curr_Stock_Price:  100.0599539264604
curr_Factors:  [100.05995393]
mat_Sqrt:  [[0.15]]
grads:  [-0.07751529]
Stock Position:  -0.07751529304092335
Bond Position:  [9.46811468]


portfolio before change:  [1.65089523]
curr_Stock_Price:  100.85508192341824
curr_Factors:  [100.85508192]
mat_Sqrt:  [[0.15]]
grads:  [0.01205236]
Stock Position:  0.012052361439361104
Bond Position:  [0.43535333]


portfolio before change:  [1.64167817]
curr_Stock_Price:  100.0880728869495
curr_Factors:  [100.08807289]
mat_Sqrt:  [[0.15]]
grads:  [-0.00591832]
Stock Position:  -0.005918315980873411
Bond Position:  [2.23403101]


portfolio before change:  [1.64127296]
curr_Stock_Price:  100.18013218856716
curr_Factors:  [100.18013219]
mat_Sqrt:  [[0.15]]
grads:  [-0.09136243]
Stock Position:  -0.09136242565232018
Bond Position:  [10.79397284]


portfolio before change:  [1.6173053]
curr_Stock_Price:  100.44985255953465
curr_Factors:  [100.44985256]
mat_Sqrt:  [[0.15]]
grads:  [-0.03436141]
Stock Position:  -0.034361408437608154
Bond Position:  [5.06890371]


portfolio before change:  [1.58862908]
curr_Stock_Price:  101.29361992061389
curr_Factors:  [101.29361992]
mat_Sqrt:  [[0.15]]
grads:  [-0.00561922]
Stock Position:  -0.00561922044144318
Bond Position:  [2.15782026]


portfolio before change:  [1.58902176]
curr_Stock_Price:  101.24774010132646
curr_Factors:  [101.2477401]
mat_Sqrt:  [[0.15]]
grads:  [0.01117881]
Stock Position:  0.01117880831330091
Bond Position:  [0.45719268]


portfolio before change:  [1.58520391]
curr_Stock_Price:  100.90365819582443
curr_Factors:  [100.9036582]
mat_Sqrt:  [[0.15]]
grads:  [-0.0198704]
Stock Position:  -0.019870400493057584
Bond Position:  [3.59020001]


portfolio before change:  [1.58460872]
curr_Stock_Price:  100.9449045921899
curr_Factors:  [100.94490459]
mat_Sqrt:  [[0.15]]
grads:  [0.0253322]
Stock Position:  0.02533220388883263
Bond Position:  [-0.97254818]


portfolio before change:  [1.57201483]
curr_Stock_Price:  100.45015477448077
curr_Factors:  [100.45015477]
mat_Sqrt:  [[0.15]]
grads:  [0.00505171]
Stock Position:  0.00505170767070477
Bond Position:  [1.06457001]


portfolio before change:  [1.57252304]
curr_Stock_Price:  100.53758474649769
curr_Factors:  [100.53758475]
mat_Sqrt:  [[0.15]]
grads:  [-0.0090285]
Stock Position:  -0.009028501440504651
Bond Position:  [2.48022677]


portfolio before change:  [1.56980811]
curr_Stock_Price:  100.8554610927627
curr_Factors:  [100.85546109]
mat_Sqrt:  [[0.15]]
grads:  [0.01658099]
Stock Position:  0.016580988133183875
Bond Position:  [-0.10247509]


portfolio before change:  [1.56768006]
curr_Stock_Price:  100.72750470144149
curr_Factors:  [100.7275047]
mat_Sqrt:  [[0.15]]
grads:  [0.05711449]
Stock Position:  0.057114492630601706
Bond Position:  [-4.18532026]


portfolio before change:  [1.6444795]
curr_Stock_Price:  102.07674248041066
curr_Factors:  [102.07674248]
mat_Sqrt:  [[0.15]]
grads:  [-0.06593286]
Stock Position:  -0.06593286364453332
Bond Position:  [8.37469145]


portfolio before change:  [1.68356163]
curr_Stock_Price:  101.4919250359557
curr_Factors:  [101.49192504]
mat_Sqrt:  [[0.15]]
grads:  [-0.11333223]
Stock Position:  -0.11333222892326421
Bond Position:  [13.18586771]


portfolio before change:  [1.70319354]
curr_Stock_Price:  101.32597253800199
curr_Factors:  [101.32597254]
mat_Sqrt:  [[0.15]]
grads:  [0.08940541]
Stock Position:  0.08940541383570387
Bond Position:  [-7.35589697]


portfolio before change:  [1.68395689]
curr_Stock_Price:  101.11595292989226
curr_Factors:  [101.11595293]
mat_Sqrt:  [[0.15]]
grads:  [0.04340271]
Stock Position:  0.043402714733825794
Bond Position:  [-2.70474997]


portfolio before change:  [1.65363434]
curr_Stock_Price:  100.42121548011515
curr_Factors:  [100.42121548]
mat_Sqrt:  [[0.15]]
grads:  [0.05278856]
Stock Position:  0.05278856378638993
Bond Position:  [-3.64745739]


portfolio before change:  [1.65033353]
curr_Stock_Price:  100.36300520657863
curr_Factors:  [100.36300521]
mat_Sqrt:  [[0.15]]
grads:  [-0.08351657]
Stock Position:  -0.0835165688484088
Bond Position:  [10.03230737]


portfolio before change:  [1.6748211]
curr_Stock_Price:  100.07730711791952
curr_Factors:  [100.07730712]
mat_Sqrt:  [[0.15]]
grads:  [-0.08361638]
Stock Position:  -0.08361638307598943
Bond Position:  [10.04292355]


portfolio before change:  [1.62709694]
curr_Stock_Price:  100.65556529358004
curr_Factors:  [100.65556529]
mat_Sqrt:  [[0.15]]
grads:  [-0.01505648]
Stock Position:  -0.015056476261804756
Bond Position:  [3.14261507]


portfolio before change:  [1.62188948]
curr_Stock_Price:  101.01447270623375
curr_Factors:  [101.01447271]
mat_Sqrt:  [[0.15]]
grads:  [-0.13410395]
Stock Position:  -0.13410395162589334
Bond Position:  [15.16832944]


portfolio before change:  [1.67646366]
curr_Stock_Price:  100.61458795352098
curr_Factors:  [100.61458795]
mat_Sqrt:  [[0.15]]
grads:  [0.24211202]
Stock Position:  0.24211202042927538
Bond Position:  [-22.68353752]


portfolio before change:  [1.78314846]
curr_Stock_Price:  101.06108609396264
curr_Factors:  [101.06108609]
mat_Sqrt:  [[0.15]]
grads:  [0.14940128]
Stock Position:  0.14940128312933648
Bond Position:  [-13.31550748]


portfolio before change:  [1.58555087]
curr_Stock_Price:  99.74406030534429
curr_Factors:  [99.74406031]
mat_Sqrt:  [[0.15]]
grads:  [0.01505808]
Stock Position:  0.015058083030382167
Bond Position:  [0.08359653]


portfolio before change:  [1.58548261]
curr_Stock_Price:  99.73918049940212
curr_Factors:  [99.7391805]
mat_Sqrt:  [[0.15]]
grads:  [0.04390079]
Stock Position:  0.043900786610383
Bond Position:  [-2.79314587]


portfolio before change:  [1.59578562]
curr_Stock_Price:  99.97784547043642
curr_Factors:  [99.97784547]
mat_Sqrt:  [[0.15]]
grads:  [-0.09608467]
Stock Position:  -0.09608466565014333
Bond Position:  [11.20212347]


portfolio before change:  [1.61859796]
curr_Stock_Price:  99.74771309595785
curr_Factors:  [99.7477131]
mat_Sqrt:  [[0.15]]
grads:  [-0.03915031]
Stock Position:  -0.03915030565606862
Bond Position:  [5.52375142]


portfolio before change:  [1.62227766]
curr_Stock_Price:  99.66254251951892
curr_Factors:  [99.66254252]
mat_Sqrt:  [[0.15]]
grads:  [-0.00301442]
Stock Position:  -0.003014423747731698
Bond Position:  [1.9227028]


portfolio before change:  [1.62204577]
curr_Stock_Price:  99.77933596739408
curr_Factors:  [99.77933597]
mat_Sqrt:  [[0.15]]
grads:  [0.0132352]
Stock Position:  0.013235204376186825
Bond Position:  [0.30144587]


portfolio before change:  [1.61795373]
curr_Stock_Price:  99.46873408094437
curr_Factors:  [99.46873408]
mat_Sqrt:  [[0.15]]
grads:  [0.05854178]
Stock Position:  0.058541780311630556
Bond Position:  [-4.20512305]


portfolio before change:  [1.63684476]
curr_Stock_Price:  99.79591676059007
curr_Factors:  [99.79591676]
mat_Sqrt:  [[0.15]]
grads:  [0.08462374]
Stock Position:  0.08462373710565108
Bond Position:  [-6.80825866]


portfolio before change:  [1.65890467]
curr_Stock_Price:  100.06162752547704
curr_Factors:  [100.06162753]
mat_Sqrt:  [[0.15]]
grads:  [-0.05621538]
Stock Position:  -0.05621538269834447
Bond Position:  [7.28390735]


portfolio before change:  [1.64998257]
curr_Stock_Price:  100.22843869919552
curr_Factors:  [100.2284387]
mat_Sqrt:  [[0.15]]
grads:  [-0.00951562]
Stock Position:  -0.009515617533251189
Bond Position:  [2.60371806]


portfolio before change:  [1.64250378]
curr_Stock_Price:  101.03149078841643
curr_Factors:  [101.03149079]
mat_Sqrt:  [[0.15]]
grads:  [-0.05162793]
Stock Position:  -0.05162793231251796
Bond Position:  [6.85855074]


portfolio before change:  [1.66018865]
curr_Stock_Price:  100.69724919668015
curr_Factors:  [100.6972492]
mat_Sqrt:  [[0.15]]
grads:  [0.04923834]
Stock Position:  0.0492383389076542
Bond Position:  [-3.29797663]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.66018865]
Stock Price:  100.30279146792631
PL:  [1.35739718]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.40110665e-02]
 [ 1.28933163e-04]
 [-9.77433605e-04]
 [-4.65668679e-05]
 [-7.18567774e-03]
 [ 1.18198131e-02]
 [ 1.18584448e-03]
 [ 1.03930516e-02]
 [-5.77308067e-03]
 [-1.66919476e-02]
 [ 1.01998250e-02]
 [-4.86669724e-03]
 [-3.26253875e-03]
 [ 3.85889356e-03]
 [-7.91904562e-03]
 [ 1.35303690e-02]
 [-2.47918014e-03]
 [ 5.08932973e-03]
 [ 1.97023893e-02]
 [ 1.37453344e-02]
 [ 2.04819723e-02]
 [-2.48323780e-02]
 [-6.26024012e-05]
 [ 4.50748664e-03]
 [-1.02789186e-03]
 [ 1.69224697e-02]
 [ 1.75347963e-02]
 [ 1.84483203e-03]
 [ 2.44287936e-04]
 [ 8.71316500e-03]
 [-3.41575290e-03]
 [-1.67870889e-02]
 [ 1.72933151e-02]
 [ 1.09350794e-02]
 [-2.01592684e-02]
 [ 7.92672789e-03]
 [-1.93855832e-03]
 [-2.53172275e-03]
 [ 5.80289154e-03]
 [-1.71793361e-02]
 [ 4.56345193e-02]
 [ 1.08728037e-03]
 [ 6.75202243e-03]
 [-9.23778544e-03]
 [-4.54710192e-04]
 [-9.69922135e-03]
 [-1.33989358e-02]
 [ 3.60869367e-04]
 [-2.69295252e-03]
 [-7.05486952e-03]
 [-4.08879935e-03]
 [ 2.78994638e-03]
 [ 4.05731300e-03]
 [-2.13659443e-03]
 [ 2.68736870e-02]
 [ 9.14922944e-03]
 [-6.29905877e-03]
 [ 1.80525854e-02]
 [ 1.26265981e-02]
 [-1.36193898e-02]
 [-1.51558006e-02]
 [-4.13428969e-02]
 [-1.30469564e-02]
 [-4.67242732e-03]
 [-3.03962758e-03]
 [ 6.58642376e-02]
 [ 8.64168851e-03]
 [ 1.65327441e-03]
 [ 1.71595136e-02]
 [-1.90426945e-02]
 [ 3.65631715e-02]
 [-4.59155837e-02]
 [-9.81085402e-03]
 [ 8.11247482e-03]
 [-1.34212381e-02]
 [ 4.16230689e-03]
 [ 2.07984362e-02]
 [-1.69623638e-02]
 [-5.74770708e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.99628045]
curr_Stock_Price:  100.25257296015585
curr_Factors:  [100.25257296]
mat_Sqrt:  [[0.15]]
grads:  [-0.29340711]
Stock Position:  -0.2934071101561601
Bond Position:  [35.41109817]


portfolio before change:  [6.16240174]
curr_Stock_Price:  99.69393608780095
curr_Factors:  [99.69393609]
mat_Sqrt:  [[0.15]]
grads:  [0.00085955]
Stock Position:  0.0008595544193530575
Bond Position:  [6.07670938]


portfolio before change:  [6.16201339]
curr_Stock_Price:  98.80026142833627
curr_Factors:  [98.80026143]
mat_Sqrt:  [[0.15]]
grads:  [-0.00651622]
Stock Position:  -0.006516224035927257
Bond Position:  [6.80581803]


portfolio before change:  [6.16053962]
curr_Stock_Price:  99.09171052875716
curr_Factors:  [99.09171053]
mat_Sqrt:  [[0.15]]
grads:  [-0.00031045]
Stock Position:  -0.00031044578592199075
Bond Position:  [6.19130222]


portfolio before change:  [6.16089549]
curr_Stock_Price:  99.19187006583739
curr_Factors:  [99.19187007]
mat_Sqrt:  [[0.15]]
grads:  [-0.04790452]
Stock Position:  -0.04790451825785468
Bond Position:  [10.91263424]


portfolio before change:  [6.09531566]
curr_Stock_Price:  100.575077656676
curr_Factors:  [100.57507766]
mat_Sqrt:  [[0.15]]
grads:  [0.07879875]
Stock Position:  0.07879875429825335
Bond Position:  [-1.82987517]


portfolio before change:  [6.04218164]
curr_Stock_Price:  99.90222889789335
curr_Factors:  [99.9022289]
mat_Sqrt:  [[0.15]]
grads:  [0.00790563]
Stock Position:  0.007905629898702759
Bond Position:  [5.2523916]


portfolio before change:  [6.04493307]
curr_Stock_Price:  100.20873656511756
curr_Factors:  [100.20873657]
mat_Sqrt:  [[0.15]]
grads:  [0.06928701]
Stock Position:  0.06928701068992278
Bond Position:  [-0.89823074]


portfolio before change:  [6.12372165]
curr_Stock_Price:  101.34668035531784
curr_Factors:  [101.34668036]
mat_Sqrt:  [[0.15]]
grads:  [-0.0384872]
Stock Position:  -0.03848720448428648
Bond Position:  [10.02427206]


portfolio before change:  [6.12126601]
curr_Stock_Price:  101.42676337945956
curr_Factors:  [101.42676338]
mat_Sqrt:  [[0.15]]
grads:  [-0.11127965]
Stock Position:  -0.11127965038399593
Bond Position:  [17.40800078]


portfolio before change:  [6.23670755]
curr_Stock_Price:  100.39914056808203
curr_Factors:  [100.39914057]
mat_Sqrt:  [[0.15]]
grads:  [0.06799883]
Stock Position:  0.06799883336413326
Bond Position:  [-0.59031688]


portfolio before change:  [6.20564504]
curr_Stock_Price:  99.94287357991249
curr_Factors:  [99.94287358]
mat_Sqrt:  [[0.15]]
grads:  [-0.03244465]
Stock Position:  -0.032444648257822915
Bond Position:  [9.44825641]


portfolio before change:  [6.24508988]
curr_Stock_Price:  98.74531683914088
curr_Factors:  [98.74531684]
mat_Sqrt:  [[0.15]]
grads:  [-0.02175026]
Stock Position:  -0.02175025833687028
Bond Position:  [8.39282603]


portfolio before change:  [6.25237709]
curr_Stock_Price:  98.43439439150609
curr_Factors:  [98.43439439]
mat_Sqrt:  [[0.15]]
grads:  [0.02572596]
Stock Position:  0.025725957093089374
Bond Position:  [3.72005808]


portfolio before change:  [6.25559523]
curr_Stock_Price:  98.55044943798529
curr_Factors:  [98.55044944]
mat_Sqrt:  [[0.15]]
grads:  [-0.05279364]
Stock Position:  -0.05279363747778085
Bond Position:  [11.45843193]


portfolio before change:  [6.23893682]
curr_Stock_Price:  98.8795532152303
curr_Factors:  [98.87955322]
mat_Sqrt:  [[0.15]]
grads:  [0.09020246]
Stock Position:  0.09020246027977383
Bond Position:  [-2.68024216]


portfolio before change:  [6.1896453]
curr_Stock_Price:  98.33495619725562
curr_Factors:  [98.3349562]
mat_Sqrt:  [[0.15]]
grads:  [-0.01652787]
Stock Position:  -0.016527867610493924
Bond Position:  [7.81491244]


portfolio before change:  [6.18113119]
curr_Stock_Price:  98.87964578153611
curr_Factors:  [98.87964578]
mat_Sqrt:  [[0.15]]
grads:  [0.03392886]
Stock Position:  0.03392886484063509
Bond Position:  [2.82625706]


portfolio before change:  [6.18673453]
curr_Stock_Price:  99.03958887930169
curr_Factors:  [99.03958888]
mat_Sqrt:  [[0.15]]
grads:  [0.13134926]
Stock Position:  0.1313492617825193
Bond Position:  [-6.82204236]


portfolio before change:  [6.09718396]
curr_Stock_Price:  98.36106066346977
curr_Factors:  [98.36106066]
mat_Sqrt:  [[0.15]]
grads:  [0.09163556]
Stock Position:  0.09163556243475299
Bond Position:  [-2.91618716]


portfolio before change:  [6.09883564]
curr_Stock_Price:  98.381074131216
curr_Factors:  [98.38107413]
mat_Sqrt:  [[0.15]]
grads:  [0.13654648]
Stock Position:  0.1365464817053377
Bond Position:  [-7.3347539]


portfolio before change:  [5.96757677]
curr_Stock_Price:  97.42315543053493
curr_Factors:  [97.42315543]
mat_Sqrt:  [[0.15]]
grads:  [-0.16554919]
Stock Position:  -0.16554918687600698
Bond Position:  [22.09590093]


portfolio before change:  [5.94806657]
curr_Stock_Price:  97.54934895427884
curr_Factors:  [97.54934895]
mat_Sqrt:  [[0.15]]
grads:  [-0.00041735]
Stock Position:  -0.0004173493411640447
Bond Position:  [5.98877873]


portfolio before change:  [5.94856988]
curr_Stock_Price:  97.2402537019593
curr_Factors:  [97.2402537]
mat_Sqrt:  [[0.15]]
grads:  [0.03004991]
Stock Position:  0.030049910949663836
Bond Position:  [3.02650892]


portfolio before change:  [5.95707103]
curr_Stock_Price:  97.5168595480436
curr_Factors:  [97.51685955]
mat_Sqrt:  [[0.15]]
grads:  [-0.00685261]
Stock Position:  -0.006852612394840566
Bond Position:  [6.62531627]


portfolio before change:  [5.96141059]
curr_Stock_Price:  96.94401699912571
curr_Factors:  [96.944017]
mat_Sqrt:  [[0.15]]
grads:  [0.11281646]
Stock Position:  0.11281646436058895
Bond Position:  [-4.97547065]


portfolio before change:  [5.90776371]
curr_Stock_Price:  96.47124994356857
curr_Factors:  [96.47124994]
mat_Sqrt:  [[0.15]]
grads:  [0.11689864]
Stock Position:  0.11689864220527205
Bond Position:  [-5.36959442]


portfolio before change:  [5.97785266]
curr_Stock_Price:  97.07369115736225
curr_Factors:  [97.07369116]
mat_Sqrt:  [[0.15]]
grads:  [0.01229888]
Stock Position:  0.012298880225086833
Bond Position:  [4.78395495]


portfolio before change:  [5.96865211]
curr_Stock_Price:  96.30129982659629
curr_Factors:  [96.30129983]
mat_Sqrt:  [[0.15]]
grads:  [0.00162859]
Stock Position:  0.0016285862400968402
Bond Position:  [5.81181714]


portfolio before change:  [5.9683119]
curr_Stock_Price:  95.86934985493977
curr_Factors:  [95.86934985]
mat_Sqrt:  [[0.15]]
grads:  [0.05808777]
Stock Position:  0.05808776665826773
Bond Position:  [0.39947547]


portfolio before change:  [6.04012016]
curr_Stock_Price:  97.1051229657543
curr_Factors:  [97.10512297]
mat_Sqrt:  [[0.15]]
grads:  [-0.02277169]
Stock Position:  -0.022771685985783382
Bond Position:  [8.25136753]


portfolio before change:  [6.01681036]
curr_Stock_Price:  98.15140147221813
curr_Factors:  [98.15140147]
mat_Sqrt:  [[0.15]]
grads:  [-0.11191393]
Stock Position:  -0.11191392605849874
Bond Position:  [17.00131905]


portfolio before change:  [6.02356636]
curr_Stock_Price:  98.100528635676
curr_Factors:  [98.10052864]
mat_Sqrt:  [[0.15]]
grads:  [0.11528877]
Stock Position:  0.1152887674099592
Bond Position:  [-5.28632267]


portfolio before change:  [5.98992929]
curr_Stock_Price:  97.81163091683312
curr_Factors:  [97.81163092]
mat_Sqrt:  [[0.15]]
grads:  [0.07290053]
Stock Position:  0.0729005291873653
Bond Position:  [-1.14059036]


portfolio before change:  [5.98474617]
curr_Stock_Price:  97.7415101967556
curr_Factors:  [97.7415102]
mat_Sqrt:  [[0.15]]
grads:  [-0.13439512]
Stock Position:  -0.134395122613875
Bond Position:  [19.12072841]


portfolio before change:  [6.07636905]
curr_Stock_Price:  97.06865986276529
curr_Factors:  [97.06865986]
mat_Sqrt:  [[0.15]]
grads:  [0.05284485]
Stock Position:  0.052844852570161145
Bond Position:  [0.94679003]


portfolio before change:  [6.05010022]
curr_Stock_Price:  96.57044650346401
curr_Factors:  [96.5704465]
mat_Sqrt:  [[0.15]]
grads:  [-0.01292372]
Stock Position:  -0.01292372214319048
Bond Position:  [7.29814983]


portfolio before change:  [6.04989367]
curr_Stock_Price:  96.6217237428396
curr_Factors:  [96.62172374]
mat_Sqrt:  [[0.15]]
grads:  [-0.01687815]
Stock Position:  -0.016878151638457045
Bond Position:  [7.68068978]


portfolio before change:  [6.0477502]
curr_Stock_Price:  96.77716287149734
curr_Factors:  [96.77716287]
mat_Sqrt:  [[0.15]]
grads:  [0.03868594]
Stock Position:  0.03868594361310028
Bond Position:  [2.30383434]


portfolio before change:  [6.04012719]
curr_Stock_Price:  96.57639211845917
curr_Factors:  [96.57639212]
mat_Sqrt:  [[0.15]]
grads:  [-0.11452891]
Stock Position:  -0.11452890727582793
Bond Position:  [17.10091585]


portfolio before change:  [6.09835214]
curr_Stock_Price:  96.07733814717987
curr_Factors:  [96.07733815]
mat_Sqrt:  [[0.15]]
grads:  [0.30423013]
Stock Position:  0.3042301288315049
Bond Position:  [-23.13126882]


portfolio before change:  [6.19409817]
curr_Stock_Price:  96.3968061067201
curr_Factors:  [96.39680611]
mat_Sqrt:  [[0.15]]
grads:  [0.00724854]
Stock Position:  0.0072485358232181624
Bond Position:  [5.49536247]


portfolio before change:  [6.19541775]
curr_Stock_Price:  96.531469181011
curr_Factors:  [96.53146918]
mat_Sqrt:  [[0.15]]
grads:  [0.04501348]
Stock Position:  0.04501348285196326
Bond Position:  [1.85020012]


portfolio before change:  [6.19873637]
curr_Stock_Price:  96.60262513023322
curr_Factors:  [96.60262513]
mat_Sqrt:  [[0.15]]
grads:  [-0.06158524]
Stock Position:  -0.06158523627298228
Bond Position:  [12.14803186]


portfolio before change:  [6.19438451]
curr_Stock_Price:  96.68561797007894
curr_Factors:  [96.68561797]
mat_Sqrt:  [[0.15]]
grads:  [-0.0030314]
Stock Position:  -0.0030314012798588904
Bond Position:  [6.48747742]


portfolio before change:  [6.19527425]
curr_Stock_Price:  96.52586957298925
curr_Factors:  [96.52586957]
mat_Sqrt:  [[0.15]]
grads:  [-0.06466148]
Stock Position:  -0.0646614756412077
Bond Position:  [12.43677942]


portfolio before change:  [6.19451049]
curr_Stock_Price:  96.54970271750354
curr_Factors:  [96.54970272]
mat_Sqrt:  [[0.15]]
grads:  [-0.08932624]
Stock Position:  -0.08932623870641318
Bond Position:  [14.81893228]


portfolio before change:  [6.21963065]
curr_Stock_Price:  96.27885340984977
curr_Factors:  [96.27885341]
mat_Sqrt:  [[0.15]]
grads:  [0.0024058]
Stock Position:  0.0024057957826266233
Bond Position:  [5.98800339]


portfolio before change:  [6.21805797]
curr_Stock_Price:  95.46958383235865
curr_Factors:  [95.46958383]
mat_Sqrt:  [[0.15]]
grads:  [-0.01795302]
Stock Position:  -0.017953016777689092
Bond Position:  [7.93202501]


portfolio before change:  [6.21923812]
curr_Stock_Price:  95.43146351004914
curr_Factors:  [95.43146351]
mat_Sqrt:  [[0.15]]
grads:  [-0.04703246]
Stock Position:  -0.04703246348388027
Bond Position:  [10.70761494]


portfolio before change:  [6.21542293]
curr_Stock_Price:  95.52681121088817
curr_Factors:  [95.52681121]
mat_Sqrt:  [[0.15]]
grads:  [-0.02725866]
Stock Position:  -0.02725866235724742
Bond Position:  [8.81935602]


portfolio before change:  [6.26189267]
curr_Stock_Price:  93.84226358590821
curr_Factors:  [93.84226359]
mat_Sqrt:  [[0.15]]
grads:  [0.01859964]
Stock Position:  0.018599642552378347
Bond Position:  [4.51646011]


portfolio before change:  [6.2675569]
curr_Stock_Price:  94.13162088843397
curr_Factors:  [94.13162089]
mat_Sqrt:  [[0.15]]
grads:  [0.02704875]
Stock Position:  0.027048753355319706
Bond Position:  [3.7214139]


portfolio before change:  [6.26407002]
curr_Stock_Price:  93.99411075427317
curr_Factors:  [93.99411075]
mat_Sqrt:  [[0.15]]
grads:  [-0.01424396]
Stock Position:  -0.014243962851917258
Bond Position:  [7.60291864]


portfolio before change:  [6.28404216]
curr_Stock_Price:  92.62532419495798
curr_Factors:  [92.62532419]
mat_Sqrt:  [[0.15]]
grads:  [0.17915791]
Stock Position:  0.17915791329589256
Bond Position:  [-10.31051764]


portfolio before change:  [6.12624755]
curr_Stock_Price:  91.74816404101313
curr_Factors:  [91.74816404]
mat_Sqrt:  [[0.15]]
grads:  [0.06099486]
Stock Position:  0.06099486291266002
Bond Position:  [0.53008086]


portfolio before change:  [6.13618511]
curr_Stock_Price:  91.91054548281377
curr_Factors:  [91.91054548]
mat_Sqrt:  [[0.15]]
grads:  [-0.04199373]
Stock Position:  -0.04199372513737488
Bond Position:  [9.9958513]


portfolio before change:  [6.14437925]
curr_Stock_Price:  91.73029538085447
curr_Factors:  [91.73029538]
mat_Sqrt:  [[0.15]]
grads:  [0.12035057]
Stock Position:  0.1203505695119504
Bond Position:  [-4.89541404]


portfolio before change:  [6.20302466]
curr_Stock_Price:  92.22012597046059
curr_Factors:  [92.22012597]
mat_Sqrt:  [[0.15]]
grads:  [0.08417732]
Stock Position:  0.08417732060525993
Bond Position:  [-1.55981845]


portfolio before change:  [6.14288482]
curr_Stock_Price:  91.50684178738501
curr_Factors:  [91.50684179]
mat_Sqrt:  [[0.15]]
grads:  [-0.09079593]
Stock Position:  -0.09079593194736237
Bond Position:  [14.4513338]


portfolio before change:  [6.12600744]
curr_Stock_Price:  91.70267231874938
curr_Factors:  [91.70267232]
mat_Sqrt:  [[0.15]]
grads:  [-0.10103867]
Stock Position:  -0.10103867099872398
Bond Position:  [15.39152358]


portfolio before change:  [6.07611022]
curr_Stock_Price:  92.206036287918
curr_Factors:  [92.20603629]
mat_Sqrt:  [[0.15]]
grads:  [-0.27561931]
Stock Position:  -0.275619312920694
Bond Position:  [31.48987458]


portfolio before change:  [6.02094532]
curr_Stock_Price:  92.41332609236603
curr_Factors:  [92.41332609]
mat_Sqrt:  [[0.15]]
grads:  [-0.08697971]
Stock Position:  -0.08697970935923732
Bond Position:  [14.05902956]


portfolio before change:  [5.98670996]
curr_Stock_Price:  92.81703038331014
curr_Factors:  [92.81703038]
mat_Sqrt:  [[0.15]]
grads:  [-0.03114952]
Stock Position:  -0.031149515497367684
Bond Position:  [8.87791548]


portfolio before change:  [5.99126687]
curr_Stock_Price:  92.68855242028374
curr_Factors:  [92.68855242]
mat_Sqrt:  [[0.15]]
grads:  [-0.02026418]
Stock Position:  -0.020264183883181363
Bond Position:  [7.86952474]


portfolio before change:  [5.99148936]
curr_Stock_Price:  92.70184538882971
curr_Factors:  [92.70184539]
mat_Sqrt:  [[0.15]]
grads:  [0.43909492]
Stock Position:  0.43909491761603675
Bond Position:  [-34.71341981]


portfolio before change:  [5.86361647]
curr_Stock_Price:  92.41556734473542
curr_Factors:  [92.41556734]
mat_Sqrt:  [[0.15]]
grads:  [0.05761126]
Stock Position:  0.057611256701834736
Bond Position:  [0.53943949]


portfolio before change:  [5.85731324]
curr_Stock_Price:  92.30557251266472
curr_Factors:  [92.30557251]
mat_Sqrt:  [[0.15]]
grads:  [0.01102183]
Stock Position:  0.01102182938536839
Bond Position:  [4.83993697]


portfolio before change:  [5.85513051]
curr_Stock_Price:  92.08008902121814
curr_Factors:  [92.08008902]
mat_Sqrt:  [[0.15]]
grads:  [0.11439676]
Stock Position:  0.11439675735340797
Bond Position:  [-4.67853309]


portfolio before change:  [5.75590937]
curr_Stock_Price:  91.21530294927355
curr_Factors:  [91.21530295]
mat_Sqrt:  [[0.15]]
grads:  [-0.1269513]
Stock Position:  -0.12695129689697152
Bond Position:  [17.33581037]


portfolio before change:  [5.78749859]
curr_Stock_Price:  90.97500843871575
curr_Factors:  [90.97500844]
mat_Sqrt:  [[0.15]]
grads:  [0.24375448]
Stock Position:  0.24375447664189773
Bond Position:  [-16.38806698]


portfolio before change:  [5.89491222]
curr_Stock_Price:  91.41987377838151
curr_Factors:  [91.41987378]
mat_Sqrt:  [[0.15]]
grads:  [-0.30610389]
Stock Position:  -0.30610389135351407
Bond Position:  [33.87889133]


portfolio before change:  [5.89753849]
curr_Stock_Price:  91.41821169272731
curr_Factors:  [91.41821169]
mat_Sqrt:  [[0.15]]
grads:  [-0.06540569]
Stock Position:  -0.06540569345947968
Bond Position:  [11.87681002]


portfolio before change:  [5.85429076]
curr_Stock_Price:  92.09078385587593
curr_Factors:  [92.09078386]
mat_Sqrt:  [[0.15]]
grads:  [0.05408317]
Stock Position:  0.054083165496189294
Bond Position:  [0.87372966]


portfolio before change:  [5.86945241]
curr_Stock_Price:  92.37011349972663
curr_Factors:  [92.3701135]
mat_Sqrt:  [[0.15]]
grads:  [-0.08947492]
Stock Position:  -0.08947492063938044
Bond Position:  [14.13426098]


portfolio before change:  [5.85258063]
curr_Stock_Price:  92.56855122421102
curr_Factors:  [92.56855122]
mat_Sqrt:  [[0.15]]
grads:  [0.02774871]
Stock Position:  0.027748712627149615
Bond Position:  [3.2839225]


portfolio before change:  [5.86549758]
curr_Stock_Price:  93.02665197928023
curr_Factors:  [93.02665198]
mat_Sqrt:  [[0.15]]
grads:  [0.13865624]
Stock Position:  0.13865624103907512
Bond Position:  [-7.0332283]


portfolio before change:  [5.8532393]
curr_Stock_Price:  92.94141462818259
curr_Factors:  [92.94141463]
mat_Sqrt:  [[0.15]]
grads:  [-0.11308243]
Stock Position:  -0.11308242512966395
Bond Position:  [16.36327986]


portfolio before change:  [5.88614843]
curr_Stock_Price:  92.65943984622827
curr_Factors:  [92.65943985]
mat_Sqrt:  [[0.15]]
grads:  [-0.38318047]
Stock Position:  -0.38318047212750667
Bond Position:  [41.39143634]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.88614843]
Stock Price:  91.80252298567358
PL:  [5.88614843]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.41901210e-02]
 [-1.94916373e-03]
 [ 3.40239039e-04]
 [ 2.13478443e-03]
 [ 1.13882346e-03]
 [ 7.62409650e-03]
 [ 4.76671554e-04]
 [ 1.55769625e-02]
 [ 1.33101507e-02]
 [-1.58864743e-03]
 [ 5.89532327e-03]
 [-6.12065152e-03]
 [ 4.41198800e-03]
 [ 7.72606040e-03]
 [-2.41065000e-02]
 [ 1.63857664e-02]
 [-2.69464079e-03]
 [-4.59623153e-03]
 [-2.65913250e-02]
 [ 1.44208749e-02]
 [-3.26575922e-02]
 [-2.29756057e-02]
 [-7.52492829e-04]
 [ 9.44803840e-03]
 [ 2.86738710e-03]
 [ 9.35986244e-03]
 [ 1.30070863e-02]
 [-9.22590615e-03]
 [ 2.70738131e-03]
 [-1.71149865e-02]
 [-4.43910603e-03]
 [-9.86050499e-03]
 [ 1.23916029e-02]
 [ 1.03543065e-02]
 [ 9.15687295e-04]
 [-4.64618830e-03]
 [-6.71638676e-03]
 [ 1.42170072e-02]
 [-1.84700970e-04]
 [-1.38022186e-02]
 [-1.83623361e-03]
 [-2.92111201e-03]
 [ 4.89685400e-03]
 [-1.02808403e-02]
 [ 2.88879302e-03]
 [-5.01185333e-04]
 [-1.37076965e-02]
 [-4.61759786e-03]
 [-9.01735387e-03]
 [ 1.07098723e-02]
 [-3.02206265e-03]
 [ 3.55290649e-03]
 [ 1.09130237e-03]
 [-6.90183096e-04]
 [ 1.53483586e-03]
 [ 8.95304713e-03]
 [ 1.24144316e-02]
 [-5.44518603e-03]
 [ 1.37017071e-02]
 [ 3.21333531e-03]
 [ 5.07430173e-03]
 [-1.47879209e-02]
 [-1.27015908e-02]
 [-1.21192140e-03]
 [-1.03353657e-02]
 [-2.91202944e-03]
 [ 9.20203441e-03]
 [ 1.87611831e-03]
 [ 1.35042063e-02]
 [-1.85339410e-02]
 [ 1.02572985e-02]
 [ 1.58084922e-03]
 [-1.09844111e-03]
 [ 7.95039446e-03]
 [-1.00847676e-03]
 [ 2.46850845e-03]
 [ 1.76136204e-03]
 [-1.20726360e-02]
 [-4.27315115e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.57328642]
curr_Stock_Price:  99.904033556776
curr_Factors:  [99.90403356]
mat_Sqrt:  [[0.15]]
grads:  [-0.22793414]
Stock Position:  -0.22793413990603179
Bond Position:  [23.34482638]


portfolio before change:  [0.46270656]
curr_Stock_Price:  100.3955744774714
curr_Factors:  [100.39557448]
mat_Sqrt:  [[0.15]]
grads:  [-0.01299442]
Stock Position:  -0.012994424844640274
Bond Position:  [1.76728931]


portfolio before change:  [0.47113344]
curr_Stock_Price:  99.7555749890046
curr_Factors:  [99.75557499]
mat_Sqrt:  [[0.15]]
grads:  [0.00226826]
Stock Position:  0.002268260263013702
Bond Position:  [0.24486184]


portfolio before change:  [0.47136231]
curr_Stock_Price:  99.84972479870615
curr_Factors:  [99.8497248]
mat_Sqrt:  [[0.15]]
grads:  [0.0142319]
Stock Position:  0.01423189620903535
Bond Position:  [-0.94968861]


portfolio before change:  [0.46569628]
curr_Stock_Price:  99.45577360302646
curr_Factors:  [99.4557736]
mat_Sqrt:  [[0.15]]
grads:  [0.00759216]
Stock Position:  0.0075921563981324585
Bond Position:  [-0.28938751]


portfolio before change:  [0.46150652]
curr_Stock_Price:  98.90630345458474
curr_Factors:  [98.90630345]
mat_Sqrt:  [[0.15]]
grads:  [0.05082731]
Stock Position:  0.050827310020589836
Bond Position:  [-4.56563482]


portfolio before change:  [0.47274328]
curr_Stock_Price:  99.13299485825844
curr_Factors:  [99.13299486]
mat_Sqrt:  [[0.15]]
grads:  [0.00317781]
Stock Position:  0.003177810360090656
Bond Position:  [0.15771742]


portfolio before change:  [0.47258031]
curr_Stock_Price:  99.07861055589534
curr_Factors:  [99.07861056]
mat_Sqrt:  [[0.15]]
grads:  [0.10384642]
Stock Position:  0.10384641689468754
Bond Position:  [-9.81637838]


portfolio before change:  [0.42719159]
curr_Stock_Price:  98.64744324763375
curr_Factors:  [98.64744325]
mat_Sqrt:  [[0.15]]
grads:  [0.08873434]
Stock Position:  0.08873433810991445
Bond Position:  [-8.32622399]


portfolio before change:  [0.4076759]
curr_Stock_Price:  98.43337407659877
curr_Factors:  [98.43337408]
mat_Sqrt:  [[0.15]]
grads:  [-0.01059098]
Stock Position:  -0.010590982838020157
Bond Position:  [1.45018207]


portfolio before change:  [0.40234178]
curr_Stock_Price:  98.94557978084404
curr_Factors:  [98.94557978]
mat_Sqrt:  [[0.15]]
grads:  [0.03930216]
Stock Position:  0.039302155155851136
Bond Position:  [-3.48643275]


portfolio before change:  [0.40741111]
curr_Stock_Price:  99.08010792392956
curr_Factors:  [99.08010792]
mat_Sqrt:  [[0.15]]
grads:  [-0.04080434]
Stock Position:  -0.04080434348219222
Bond Position:  [4.45030987]


portfolio before change:  [0.45875465]
curr_Stock_Price:  97.82863859818823
curr_Factors:  [97.8286386]
mat_Sqrt:  [[0.15]]
grads:  [0.02941325]
Stock Position:  0.029413253316534303
Bond Position:  [-2.41870388]


portfolio before change:  [0.43227497]
curr_Stock_Price:  96.93351468778613
curr_Factors:  [96.93351469]
mat_Sqrt:  [[0.15]]
grads:  [0.05150707]
Stock Position:  0.05150706934199186
Bond Position:  [-4.56048629]


portfolio before change:  [0.46130688]
curr_Stock_Price:  97.50269773642033
curr_Factors:  [97.50269774]
mat_Sqrt:  [[0.15]]
grads:  [-0.16071]
Stock Position:  -0.16070999975536882
Bond Position:  [16.13096541]


portfolio before change:  [0.43999842]
curr_Stock_Price:  97.64156075167715
curr_Factors:  [97.64156075]
mat_Sqrt:  [[0.15]]
grads:  [0.10923844]
Stock Position:  0.10923844299735495
Bond Position:  [-10.22621365]


portfolio before change:  [0.49688308]
curr_Stock_Price:  98.16815026772875
curr_Factors:  [98.16815027]
mat_Sqrt:  [[0.15]]
grads:  [-0.01796427]
Stock Position:  -0.01796427192317858
Bond Position:  [2.26040243]


portfolio before change:  [0.51202054]
curr_Stock_Price:  97.33337244087136
curr_Factors:  [97.33337244]
mat_Sqrt:  [[0.15]]
grads:  [-0.03064154]
Stock Position:  -0.030641543555095335
Bond Position:  [3.49446531]


portfolio before change:  [0.53276467]
curr_Stock_Price:  96.6635068364167
curr_Factors:  [96.66350684]
mat_Sqrt:  [[0.15]]
grads:  [-0.1772755]
Stock Position:  -0.1772754997197225
Bond Position:  [17.66883614]


portfolio before change:  [0.39324728]
curr_Stock_Price:  97.45674519161898
curr_Factors:  [97.45674519]
mat_Sqrt:  [[0.15]]
grads:  [0.09613917]
Stock Position:  0.0961391659052324
Bond Position:  [-8.97616292]


portfolio before change:  [0.36177799]
curr_Stock_Price:  97.13525024926155
curr_Factors:  [97.13525025]
mat_Sqrt:  [[0.15]]
grads:  [-0.21771728]
Stock Position:  -0.21771728114413424
Bond Position:  [21.50980058]


portfolio before change:  [0.22172333]
curr_Stock_Price:  97.78471210841496
curr_Factors:  [97.78471211]
mat_Sqrt:  [[0.15]]
grads:  [-0.1531707]
Stock Position:  -0.15317070491147447
Bond Position:  [15.19947661]


portfolio before change:  [0.17525675]
curr_Stock_Price:  98.09427894951313
curr_Factors:  [98.09427895]
mat_Sqrt:  [[0.15]]
grads:  [-0.00501662]
Stock Position:  -0.005016618860951486
Bond Position:  [0.66735836]


portfolio before change:  [0.17531595]
curr_Stock_Price:  98.09079299972908
curr_Factors:  [98.090793]
mat_Sqrt:  [[0.15]]
grads:  [0.06298692]
Stock Position:  0.06298692263626225
Bond Position:  [-6.00312124]


portfolio before change:  [0.18305864]
curr_Stock_Price:  98.21967519042346
curr_Factors:  [98.21967519]
mat_Sqrt:  [[0.15]]
grads:  [0.01911591]
Stock Position:  0.019115914011999434
Bond Position:  [-1.69450023]


portfolio before change:  [0.1853131]
curr_Stock_Price:  98.34315204960573
curr_Factors:  [98.34315205]
mat_Sqrt:  [[0.15]]
grads:  [0.06239908]
Stock Position:  0.06239908296289824
Bond Position:  [-5.9512094]


portfolio before change:  [0.20655905]
curr_Stock_Price:  98.68959793566567
curr_Factors:  [98.68959794]
mat_Sqrt:  [[0.15]]
grads:  [0.08671391]
Stock Position:  0.08671390878745676
Bond Position:  [-8.35120175]


portfolio before change:  [0.24507808]
curr_Stock_Price:  99.13982564170017
curr_Factors:  [99.13982564]
mat_Sqrt:  [[0.15]]
grads:  [-0.06150604]
Stock Position:  -0.06150604102874077
Bond Position:  [6.34277627]


portfolio before change:  [0.21705674]
curr_Stock_Price:  99.60185796464252
curr_Factors:  [99.60185796]
mat_Sqrt:  [[0.15]]
grads:  [0.01804921]
Stock Position:  0.01804920874331304
Bond Position:  [-1.58067799]


portfolio before change:  [0.21250098]
curr_Stock_Price:  99.35492382279743
curr_Factors:  [99.35492382]
mat_Sqrt:  [[0.15]]
grads:  [-0.11409991]
Stock Position:  -0.11409990972471834
Bond Position:  [11.54888882]


portfolio before change:  [0.14785378]
curr_Stock_Price:  99.9278342560249
curr_Factors:  [99.92783426]
mat_Sqrt:  [[0.15]]
grads:  [-0.02959404]
Stock Position:  -0.02959404016669416
Bond Position:  [3.10512212]


portfolio before change:  [0.16214497]
curr_Stock_Price:  99.45148433129772
curr_Factors:  [99.45148433]
mat_Sqrt:  [[0.15]]
grads:  [-0.0657367]
Stock Position:  -0.0657366999527928
Bond Position:  [6.69975736]


portfolio before change:  [0.09452451]
curr_Stock_Price:  100.48651065250704
curr_Factors:  [100.48651065]
mat_Sqrt:  [[0.15]]
grads:  [0.08261069]
Stock Position:  0.08261068617254778
Bond Position:  [-8.20673509]


portfolio before change:  [0.14230671]
curr_Stock_Price:  101.0711220143659
curr_Factors:  [101.07112201]
mat_Sqrt:  [[0.15]]
grads:  [0.06902871]
Stock Position:  0.069028710280013
Bond Position:  [-6.83450248]


portfolio before change:  [0.15741958]
curr_Stock_Price:  101.29624631185122
curr_Factors:  [101.29624631]
mat_Sqrt:  [[0.15]]
grads:  [0.00610458]
Stock Position:  0.006104581966790562
Bond Position:  [-0.46095165]


portfolio before change:  [0.15654444]
curr_Stock_Price:  101.15760733028189
curr_Factors:  [101.15760733]
mat_Sqrt:  [[0.15]]
grads:  [-0.03097459]
Stock Position:  -0.03097458868815632
Bond Position:  [3.28985972]


portfolio before change:  [0.15233948]
curr_Stock_Price:  101.30000106808929
curr_Factors:  [101.30000107]
mat_Sqrt:  [[0.15]]
grads:  [-0.04477591]
Stock Position:  -0.044775911707958714
Bond Position:  [4.68813938]


portfolio before change:  [0.17615401]
curr_Stock_Price:  100.77468468825259
curr_Factors:  [100.77468469]
mat_Sqrt:  [[0.15]]
grads:  [0.09478005]
Stock Position:  0.09478004780176066
Bond Position:  [-9.37527542]


portfolio before change:  [0.22383243]
curr_Stock_Price:  101.2839099287161
curr_Factors:  [101.28390993]
mat_Sqrt:  [[0.15]]
grads:  [-0.00123134]
Stock Position:  -0.0012313397978002717
Bond Position:  [0.34854734]


portfolio before change:  [0.22572049]
curr_Stock_Price:  99.76826538729861
curr_Factors:  [99.76826539]
mat_Sqrt:  [[0.15]]
grads:  [-0.09201479]
Stock Position:  -0.09201479076938791
Bond Position:  [9.40587656]


portfolio before change:  [0.21012039]
curr_Stock_Price:  99.94419350094088
curr_Factors:  [99.9441935]
mat_Sqrt:  [[0.15]]
grads:  [-0.01224156]
Stock Position:  -0.012241557398770184
Bond Position:  [1.43359297]


portfolio before change:  [0.20660913]
curr_Stock_Price:  100.2383440165544
curr_Factors:  [100.23834402]
mat_Sqrt:  [[0.15]]
grads:  [-0.01947408]
Stock Position:  -0.019474080097778842
Bond Position:  [2.15865867]


portfolio before change:  [0.21921581]
curr_Stock_Price:  99.59791560537734
curr_Factors:  [99.59791561]
mat_Sqrt:  [[0.15]]
grads:  [0.03264569]
Stock Position:  0.032645693324028606
Bond Position:  [-3.0322272]


portfolio before change:  [0.21922932]
curr_Stock_Price:  99.6041349842155
curr_Factors:  [99.60413498]
mat_Sqrt:  [[0.15]]
grads:  [-0.06853894]
Stock Position:  -0.06853893525972095
Bond Position:  [7.04599068]


portfolio before change:  [0.21261777]
curr_Stock_Price:  99.70702448975887
curr_Factors:  [99.70702449]
mat_Sqrt:  [[0.15]]
grads:  [0.01925862]
Stock Position:  0.019258620109235364
Bond Position:  [-1.70760193]


portfolio before change:  [0.22247737]
curr_Stock_Price:  100.22452372102543
curr_Factors:  [100.22452372]
mat_Sqrt:  [[0.15]]
grads:  [-0.00334124]
Stock Position:  -0.003341235553471853
Bond Position:  [0.55735111]


portfolio before change:  [0.22227134]
curr_Stock_Price:  100.29661075873416
curr_Factors:  [100.29661076]
mat_Sqrt:  [[0.15]]
grads:  [-0.09138464]
Stock Position:  -0.09138464319530391
Bond Position:  [9.38784133]


portfolio before change:  [0.27451319]
curr_Stock_Price:  99.73136167285942
curr_Factors:  [99.73136167]
mat_Sqrt:  [[0.15]]
grads:  [-0.03078399]
Stock Position:  -0.030783985745590065
Bond Position:  [3.344642]


portfolio before change:  [0.29334518]
curr_Stock_Price:  99.12640610815353
curr_Factors:  [99.12640611]
mat_Sqrt:  [[0.15]]
grads:  [-0.06011569]
Stock Position:  -0.060115692443123904
Bond Position:  [6.25239772]


portfolio before change:  [0.2773491]
curr_Stock_Price:  99.39899494520559
curr_Factors:  [99.39899495]
mat_Sqrt:  [[0.15]]
grads:  [0.07139915]
Stock Position:  0.07139914859631383
Bond Position:  [-6.81965451]


portfolio before change:  [0.29158162]
curr_Stock_Price:  99.60430216541829
curr_Factors:  [99.60430217]
mat_Sqrt:  [[0.15]]
grads:  [-0.02014708]
Stock Position:  -0.020147084357232406
Bond Position:  [2.29831789]


portfolio before change:  [0.2911612]
curr_Stock_Price:  99.63229952794745
curr_Factors:  [99.63229953]
mat_Sqrt:  [[0.15]]
grads:  [0.02368604]
Stock Position:  0.023686043271984362
Bond Position:  [-2.06873376]


portfolio before change:  [0.3042604]
curr_Stock_Price:  100.19079281122436
curr_Factors:  [100.19079281]
mat_Sqrt:  [[0.15]]
grads:  [0.00727535]
Stock Position:  0.007275349101140094
Bond Position:  [-0.4246626]


portfolio before change:  [0.29742542]
curr_Stock_Price:  99.25497065878112
curr_Factors:  [99.25497066]
mat_Sqrt:  [[0.15]]
grads:  [-0.00460122]
Stock Position:  -0.0046012206378198035
Bond Position:  [0.75411944]


portfolio before change:  [0.30021506]
curr_Stock_Price:  98.65893200446206
curr_Factors:  [98.658932]
mat_Sqrt:  [[0.15]]
grads:  [0.01023224]
Stock Position:  0.010232239050981588
Bond Position:  [-0.70928672]


portfolio before change:  [0.2912681]
curr_Stock_Price:  97.78887523123942
curr_Factors:  [97.78887523]
mat_Sqrt:  [[0.15]]
grads:  [0.05968698]
Stock Position:  0.05968698085448715
Bond Position:  [-5.54545462]


portfolio before change:  [0.27421393]
curr_Stock_Price:  97.50895547212347
curr_Factors:  [97.50895547]
mat_Sqrt:  [[0.15]]
grads:  [0.08276288]
Stock Position:  0.08276287764947324
Bond Position:  [-7.79590782]


portfolio before change:  [0.29940788]
curr_Stock_Price:  97.81925412429257
curr_Factors:  [97.81925412]
mat_Sqrt:  [[0.15]]
grads:  [-0.03630124]
Stock Position:  -0.0363012401853398
Bond Position:  [3.85036812]


portfolio before change:  [0.30126972]
curr_Stock_Price:  97.77459505083505
curr_Factors:  [97.77459505]
mat_Sqrt:  [[0.15]]
grads:  [0.09134471]
Stock Position:  0.09134471392344197
Bond Position:  [-8.6299227]


portfolio before change:  [0.37433546]
curr_Stock_Price:  98.58039017777418
curr_Factors:  [98.58039018]
mat_Sqrt:  [[0.15]]
grads:  [0.02142224]
Stock Position:  0.021422235368409967
Bond Position:  [-1.73747687]


portfolio before change:  [0.37781404]
curr_Stock_Price:  98.74784130385436
curr_Factors:  [98.7478413]
mat_Sqrt:  [[0.15]]
grads:  [0.03382868]
Stock Position:  0.033828678197694216
Bond Position:  [-2.96269491]


portfolio before change:  [0.36330088]
curr_Stock_Price:  98.32429592763106
curr_Factors:  [98.32429593]
mat_Sqrt:  [[0.15]]
grads:  [-0.09858614]
Stock Position:  -0.0985861393609403
Bond Position:  [10.05671362]


portfolio before change:  [0.45003846]
curr_Stock_Price:  97.45085659070338
curr_Factors:  [97.45085659]
mat_Sqrt:  [[0.15]]
grads:  [-0.08467727]
Stock Position:  -0.0846772718610467
Bond Position:  [8.70191114]


portfolio before change:  [0.46518422]
curr_Stock_Price:  97.2784150711655
curr_Factors:  [97.27841507]
mat_Sqrt:  [[0.15]]
grads:  [-0.00807948]
Stock Position:  -0.008079476003129867
Bond Position:  [1.25114284]


portfolio before change:  [0.46229304]
curr_Stock_Price:  97.64593662542828
curr_Factors:  [97.64593663]
mat_Sqrt:  [[0.15]]
grads:  [-0.06890244]
Stock Position:  -0.06890243769184101
Bond Position:  [7.1903361]


portfolio before change:  [0.54857924]
curr_Stock_Price:  96.40016371576887
curr_Factors:  [96.40016372]
mat_Sqrt:  [[0.15]]
grads:  [-0.01941353]
Stock Position:  -0.019413529611562685
Bond Position:  [2.42004667]


portfolio before change:  [0.54812669]
curr_Stock_Price:  96.43126621689197
curr_Factors:  [96.43126622]
mat_Sqrt:  [[0.15]]
grads:  [0.0613469]
Stock Position:  0.061346896067738826
Bond Position:  [-5.36763218]


portfolio before change:  [0.54548277]
curr_Stock_Price:  96.39363709713737
curr_Factors:  [96.3936371]
mat_Sqrt:  [[0.15]]
grads:  [0.01250746]
Stock Position:  0.012507455402021908
Bond Position:  [-0.66015635]


portfolio before change:  [0.54164186]
curr_Stock_Price:  96.0898461889091
curr_Factors:  [96.08984619]
mat_Sqrt:  [[0.15]]
grads:  [0.09002804]
Stock Position:  0.09002804197063415
Bond Position:  [-8.10913885]


portfolio before change:  [0.56026077]
curr_Stock_Price:  96.30228830891056
curr_Factors:  [96.30228831]
mat_Sqrt:  [[0.15]]
grads:  [-0.12355961]
Stock Position:  -0.12355960635863743
Bond Position:  [12.45933361]


portfolio before change:  [0.5384994]
curr_Stock_Price:  96.48471119094226
curr_Factors:  [96.48471119]
mat_Sqrt:  [[0.15]]
grads:  [0.06838199]
Stock Position:  0.06838199030612584
Bond Position:  [-6.05931718]


portfolio before change:  [0.57264581]
curr_Stock_Price:  96.98959746601243
curr_Factors:  [96.98959747]
mat_Sqrt:  [[0.15]]
grads:  [0.01053899]
Stock Position:  0.010538994776916397
Bond Position:  [-0.44952705]


portfolio before change:  [0.57122834]
curr_Stock_Price:  96.85776532489595
curr_Factors:  [96.85776532]
mat_Sqrt:  [[0.15]]
grads:  [-0.00732294]
Stock Position:  -0.007322940736521569
Bond Position:  [1.28051201]


portfolio before change:  [0.57118564]
curr_Stock_Price:  96.87452603640496
curr_Factors:  [96.87452604]
mat_Sqrt:  [[0.15]]
grads:  [0.05300263]
Stock Position:  0.05300262974878285
Bond Position:  [-4.563419]


portfolio before change:  [0.57510875]
curr_Stock_Price:  96.95392467295639
curr_Factors:  [96.95392467]
mat_Sqrt:  [[0.15]]
grads:  [-0.00672318]
Stock Position:  -0.006723178379682097
Bond Position:  [1.22694728]


portfolio before change:  [0.57301763]
curr_Stock_Price:  97.27636223812794
curr_Factors:  [97.27636224]
mat_Sqrt:  [[0.15]]
grads:  [0.01645672]
Stock Position:  0.016456723007980727
Bond Position:  [-1.02783252]


portfolio before change:  [0.57451865]
curr_Stock_Price:  97.3714757599488
curr_Factors:  [97.37147576]
mat_Sqrt:  [[0.15]]
grads:  [0.01174241]
Stock Position:  0.011742413631551872
Bond Position:  [-0.5688575]


portfolio before change:  [0.55894006]
curr_Stock_Price:  96.04781020057845
curr_Factors:  [96.0478102]
mat_Sqrt:  [[0.15]]
grads:  [-0.08048424]
Stock Position:  -0.08048423988825347
Bond Position:  [8.28927506]


portfolio before change:  [0.57211375]
curr_Stock_Price:  95.89056705160274
curr_Factors:  [95.89056705]
mat_Sqrt:  [[0.15]]
grads:  [-0.28487674]
Stock Position:  -0.2848767434502538
Bond Position:  [27.88910622]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.57211375]
Stock Price:  95.39926860061037
PL:  [0.57211375]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-1.02632791e-01]
 [-8.35739842e-04]
 [ 2.95859635e-04]
 [ 2.51899557e-03]
 [ 6.29042004e-03]
 [ 1.20700224e-02]
 [ 2.63420922e-04]
 [ 8.00176204e-03]
 [-6.85720695e-03]
 [-1.29515051e-02]
 [ 1.02116120e-02]
 [-4.85564569e-03]
 [-7.15907975e-03]
 [ 4.35952172e-03]
 [ 6.48212301e-03]
 [-7.46468389e-03]
 [ 1.18371201e-02]
 [ 2.56344929e-02]
 [ 1.81706328e-02]
 [-3.95096465e-04]
 [ 4.33948614e-02]
 [-1.17515363e-02]
 [ 5.82620572e-03]
 [-4.41403341e-03]
 [ 1.67018352e-02]
 [ 6.49439417e-03]
 [ 1.33422544e-02]
 [ 9.00169350e-04]
 [ 3.59334072e-03]
 [-2.67326352e-02]
 [-5.15866947e-03]
 [ 2.28965371e-02]
 [ 7.87147467e-03]
 [ 7.58550666e-03]
 [-2.40143147e-03]
 [-4.68541604e-03]
 [-6.03283853e-03]
 [ 1.42729281e-02]
 [-1.43821831e-03]
 [-1.37273463e-02]
 [ 1.92222669e-02]
 [-1.35353803e-03]
 [ 5.03656522e-03]
 [-8.78027091e-03]
 [ 8.56428617e-04]
 [-8.31188567e-03]
 [-1.33400787e-02]
 [ 2.39872198e-04]
 [-2.65919927e-03]
 [-6.95467520e-03]
 [-4.09526832e-03]
 [ 2.84479426e-03]
 [ 3.78034176e-03]
 [-1.36730740e-03]
 [ 1.63427632e-02]
 [ 8.92137228e-03]
 [ 6.50203454e-03]
 [ 1.12404965e-02]
 [ 1.31082726e-02]
 [-4.97004165e-03]
 [-3.93546890e-03]
 [-2.71461865e-02]
 [-1.28627622e-02]
 [-3.44051753e-03]
 [-6.09881932e-03]
 [ 2.15699158e-02]
 [ 8.25964443e-03]
 [ 1.76029611e-03]
 [ 1.38875485e-02]
 [-1.83531943e-02]
 [ 9.58422551e-03]
 [ 1.69248877e-03]
 [-6.68083973e-04]
 [ 8.17936066e-03]
 [-1.36440745e-03]
 [ 2.78395631e-03]
 [ 7.97707683e-03]
 [-1.17460791e-02]
 [-3.99138383e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.63941394]
curr_Stock_Price:  101.25796746782952
curr_Factors:  [101.25796747]
mat_Sqrt:  [[0.15]]
grads:  [-0.68421861]
Stock Position:  -0.6842186095838164
Bond Position:  [90.92199965]


portfolio before change:  [22.07702169]
curr_Stock_Price:  100.62670000981575
curr_Factors:  [100.62670001]
mat_Sqrt:  [[0.15]]
grads:  [-0.0055716]
Stock Position:  -0.005571598943859222
Bond Position:  [22.6376733]


portfolio before change:  [22.07962611]
curr_Stock_Price:  100.41320240984939
curr_Factors:  [100.41320241]
mat_Sqrt:  [[0.15]]
grads:  [0.0019724]
Stock Position:  0.0019723975686990482
Bond Position:  [21.88157135]


portfolio before change:  [22.08205609]
curr_Stock_Price:  100.95180649946393
curr_Factors:  [100.9518065]
mat_Sqrt:  [[0.15]]
grads:  [0.0167933]
Stock Position:  0.016793303824273933
Bond Position:  [20.38674173]


portfolio before change:  [22.0876747]
curr_Stock_Price:  101.21050483870559
curr_Factors:  [101.21050484]
mat_Sqrt:  [[0.15]]
grads:  [0.04193613]
Stock Position:  0.04193613357033751
Bond Position:  [17.84329745]


portfolio before change:  [22.09673071]
curr_Stock_Price:  101.39985874513944
curr_Factors:  [101.39985875]
mat_Sqrt:  [[0.15]]
grads:  [0.08046682]
Stock Position:  0.0804668158525677
Bond Position:  [13.93740695]


portfolio before change:  [22.08251528]
curr_Stock_Price:  101.21237090775507
curr_Factors:  [101.21237091]
mat_Sqrt:  [[0.15]]
grads:  [0.00175614]
Stock Position:  0.0017561394806571856
Bond Position:  [21.90477224]


portfolio before change:  [22.08353311]
curr_Stock_Price:  101.01235166489728
curr_Factors:  [101.01235166]
mat_Sqrt:  [[0.15]]
grads:  [0.05334508]
Stock Position:  0.05334508025378997
Bond Position:  [16.6950211]


portfolio before change:  [22.11055019]
curr_Stock_Price:  101.49924966183798
curr_Factors:  [101.49924966]
mat_Sqrt:  [[0.15]]
grads:  [-0.04571471]
Stock Position:  -0.04571471299274172
Bond Position:  [26.75055926]


portfolio before change:  [22.10957455]
curr_Stock_Price:  101.55716541529776
curr_Factors:  [101.55716542]
mat_Sqrt:  [[0.15]]
grads:  [-0.08634337]
Stock Position:  -0.0863433672216031
Bond Position:  [30.87836218]


portfolio before change:  [22.20700358]
curr_Stock_Price:  100.45112707746108
curr_Factors:  [100.45112708]
mat_Sqrt:  [[0.15]]
grads:  [0.06807741]
Stock Position:  0.06807741323191059
Bond Position:  [15.3685507]


portfolio before change:  [22.17408761]
curr_Stock_Price:  99.95350918799619
curr_Factors:  [99.95350919]
mat_Sqrt:  [[0.15]]
grads:  [-0.03237097]
Stock Position:  -0.03237097128176769
Bond Position:  [25.40967979]


portfolio before change:  [22.19703165]
curr_Stock_Price:  99.29378596863123
curr_Factors:  [99.29378597]
mat_Sqrt:  [[0.15]]
grads:  [-0.0477272]
Stock Position:  -0.04772719830838948
Bond Position:  [26.93604586]


portfolio before change:  [22.18021037]
curr_Stock_Price:  99.68150694223128
curr_Factors:  [99.68150694]
mat_Sqrt:  [[0.15]]
grads:  [0.02906348]
Stock Position:  0.029063478130919845
Bond Position:  [19.28311907]


portfolio before change:  [22.20185833]
curr_Stock_Price:  100.38488912665902
curr_Factors:  [100.38488913]
mat_Sqrt:  [[0.15]]
grads:  [0.04321415]
Stock Position:  0.04321415339803121
Bond Position:  [17.86381033]


portfolio before change:  [22.21531807]
curr_Stock_Price:  100.67051806632507
curr_Factors:  [100.67051807]
mat_Sqrt:  [[0.15]]
grads:  [-0.04976456]
Stock Position:  -0.04976455926868891
Bond Position:  [27.22514203]


portfolio before change:  [22.18091645]
curr_Stock_Price:  101.395998990006
curr_Factors:  [101.39599899]
mat_Sqrt:  [[0.15]]
grads:  [0.07891413]
Stock Position:  0.07891413401089085
Bond Position:  [14.179339]


portfolio before change:  [22.24265472]
curr_Stock_Price:  102.16711601698876
curr_Factors:  [102.16711602]
mat_Sqrt:  [[0.15]]
grads:  [0.17089662]
Stock Position:  0.17089661938479478
Bond Position:  [4.78263998]


portfolio before change:  [22.12035394]
curr_Stock_Price:  101.4497249535847
curr_Factors:  [101.44972495]
mat_Sqrt:  [[0.15]]
grads:  [0.12113755]
Stock Position:  0.12113755193830791
Bond Position:  [9.83098261]


portfolio before change:  [22.15045705]
curr_Stock_Price:  101.69315611422653
curr_Factors:  [101.69315611]
mat_Sqrt:  [[0.15]]
grads:  [-0.00263398]
Stock Position:  -0.0026339764345367257
Bond Position:  [22.41831443]


portfolio before change:  [22.14960834]
curr_Stock_Price:  102.54733828727589
curr_Factors:  [102.54733829]
mat_Sqrt:  [[0.15]]
grads:  [0.28929908]
Stock Position:  0.2892990760715169
Bond Position:  [-7.51724188]


portfolio before change:  [22.18650535]
curr_Stock_Price:  102.67650168683095
curr_Factors:  [102.67650169]
mat_Sqrt:  [[0.15]]
grads:  [-0.07834358]
Stock Position:  -0.07834357507548127
Bond Position:  [30.23054957]


portfolio before change:  [22.18457929]
curr_Stock_Price:  102.72520417422594
curr_Factors:  [102.72520417]
mat_Sqrt:  [[0.15]]
grads:  [0.03884137]
Stock Position:  0.03884137145048992
Bond Position:  [18.19459148]


portfolio before change:  [22.15565748]
curr_Stock_Price:  101.95131266098606
curr_Factors:  [101.95131266]
mat_Sqrt:  [[0.15]]
grads:  [-0.02942689]
Stock Position:  -0.0294268894253682
Bond Position:  [25.15576749]


portfolio before change:  [22.16514198]
curr_Stock_Price:  101.68243586217413
curr_Factors:  [101.68243586]
mat_Sqrt:  [[0.15]]
grads:  [0.11134557]
Stock Position:  0.11134556783951663
Bond Position:  [10.84325342]


portfolio before change:  [22.11639438]
curr_Stock_Price:  101.2385446539022
curr_Factors:  [101.23854465]
mat_Sqrt:  [[0.15]]
grads:  [0.04329596]
Stock Position:  0.043295961137908595
Bond Position:  [17.73317429]


portfolio before change:  [22.07671067]
curr_Stock_Price:  100.29637654859825
curr_Factors:  [100.29637655]
mat_Sqrt:  [[0.15]]
grads:  [0.08894836]
Stock Position:  0.0889483627087768
Bond Position:  [13.15551219]


portfolio before change:  [22.06659513]
curr_Stock_Price:  100.17340883177147
curr_Factors:  [100.17340883]
mat_Sqrt:  [[0.15]]
grads:  [0.00600113]
Stock Position:  0.006001129001804578
Bond Position:  [21.46544159]


portfolio before change:  [22.07163072]
curr_Stock_Price:  100.78895148476985
curr_Factors:  [100.78895148]
mat_Sqrt:  [[0.15]]
grads:  [0.0239556]
Stock Position:  0.02395560479506564
Bond Position:  [19.65717043]


portfolio before change:  [22.08322597]
curr_Stock_Price:  101.22169515586654
curr_Factors:  [101.22169516]
mat_Sqrt:  [[0.15]]
grads:  [-0.17821757]
Stock Position:  -0.17821756781161616
Bond Position:  [40.12271029]


portfolio before change:  [22.1118881]
curr_Stock_Price:  101.0749397735898
curr_Factors:  [101.07493977]
mat_Sqrt:  [[0.15]]
grads:  [-0.03439113]
Stock Position:  -0.03439112977558496
Bond Position:  [25.58796947]


portfolio before change:  [22.09491955]
curr_Stock_Price:  101.61484215372886
curr_Factors:  [101.61484215]
mat_Sqrt:  [[0.15]]
grads:  [0.15264358]
Stock Position:  0.152643580810334
Bond Position:  [6.58406618]


portfolio before change:  [22.06028629]
curr_Stock_Price:  101.38525652600633
curr_Factors:  [101.38525653]
mat_Sqrt:  [[0.15]]
grads:  [0.0524765]
Stock Position:  0.05247649778806344
Bond Position:  [16.7399431]


portfolio before change:  [22.06098889]
curr_Stock_Price:  101.37870732209397
curr_Factors:  [101.37870732]
mat_Sqrt:  [[0.15]]
grads:  [0.05057004]
Stock Position:  0.05057004436825971
Bond Position:  [16.93426316]


portfolio before change:  [22.08321251]
curr_Stock_Price:  101.79723957030566
curr_Factors:  [101.79723957]
mat_Sqrt:  [[0.15]]
grads:  [-0.01600954]
Stock Position:  -0.016009543117307772
Bond Position:  [23.7129398]


portfolio before change:  [22.08863002]
curr_Stock_Price:  101.55142316051412
curr_Factors:  [101.55142316]
mat_Sqrt:  [[0.15]]
grads:  [-0.03123611]
Stock Position:  -0.03123610694577948
Bond Position:  [25.26070114]


portfolio before change:  [22.11286538]
curr_Stock_Price:  100.8260922392268
curr_Factors:  [100.82609224]
mat_Sqrt:  [[0.15]]
grads:  [-0.04021892]
Stock Position:  -0.04021892355761953
Bond Position:  [26.16798228]


portfolio before change:  [22.12233936]
curr_Stock_Price:  100.63119813926986
curr_Factors:  [100.63119814]
mat_Sqrt:  [[0.15]]
grads:  [0.09515285]
Stock Position:  0.09515285397259474
Bond Position:  [12.54699366]


portfolio before change:  [22.05832679]
curr_Stock_Price:  99.95022243207623
curr_Factors:  [99.95022243]
mat_Sqrt:  [[0.15]]
grads:  [-0.00958812]
Stock Position:  -0.009588122037073
Bond Position:  [23.01666172]


portfolio before change:  [22.06698851]
curr_Stock_Price:  99.19688043895155
curr_Factors:  [99.19688044]
mat_Sqrt:  [[0.15]]
grads:  [-0.09151564]
Stock Position:  -0.09151564218925946
Bond Position:  [31.14505473]


portfolio before change:  [22.13639883]
curr_Stock_Price:  98.45969839788333
curr_Factors:  [98.4596984]
mat_Sqrt:  [[0.15]]
grads:  [0.12814845]
Stock Position:  0.12814844607543166
Bond Position:  [9.51894148]


portfolio before change:  [22.10886676]
curr_Stock_Price:  98.24021059743659
curr_Factors:  [98.2402106]
mat_Sqrt:  [[0.15]]
grads:  [-0.00902359]
Stock Position:  -0.009023586881890436
Bond Position:  [22.99534583]


portfolio before change:  [22.11542818]
curr_Stock_Price:  97.67234653021924
curr_Factors:  [97.67234653]
mat_Sqrt:  [[0.15]]
grads:  [0.0335771]
Stock Position:  0.03357710148433885
Bond Position:  [18.83587389]


portfolio before change:  [22.10024956]
curr_Stock_Price:  97.18523168770942
curr_Factors:  [97.18523169]
mat_Sqrt:  [[0.15]]
grads:  [-0.05853514]
Stock Position:  -0.058535139431739186
Bond Position:  [27.78900064]


portfolio before change:  [22.08110502]
curr_Stock_Price:  97.54196453123775
curr_Factors:  [97.54196453]
mat_Sqrt:  [[0.15]]
grads:  [0.00570952]
Stock Position:  0.005709524113275009
Bond Position:  [21.52418682]


portfolio before change:  [22.07854801]
curr_Stock_Price:  96.85849013567346
curr_Factors:  [96.85849014]
mat_Sqrt:  [[0.15]]
grads:  [-0.05541257]
Stock Position:  -0.05541257112817402
Bond Position:  [27.44572598]


portfolio before change:  [22.11696644]
curr_Stock_Price:  96.19613099518727
curr_Factors:  [96.196131]
mat_Sqrt:  [[0.15]]
grads:  [-0.08893386]
Stock Position:  -0.08893385778338928
Bond Position:  [30.67205948]


portfolio before change:  [22.098928]
curr_Stock_Price:  96.42051689229837
curr_Factors:  [96.42051689]
mat_Sqrt:  [[0.15]]
grads:  [0.00159915]
Stock Position:  0.001599147984363853
Bond Position:  [21.94473733]


portfolio before change:  [22.09960679]
curr_Stock_Price:  95.98728549843916
curr_Factors:  [95.9872855]
mat_Sqrt:  [[0.15]]
grads:  [-0.017728]
Stock Position:  -0.01772799514501037
Bond Position:  [23.80126892]


portfolio before change:  [22.11053973]
curr_Stock_Price:  95.4544943744668
curr_Factors:  [95.45449437]
mat_Sqrt:  [[0.15]]
grads:  [-0.0463645]
Stock Position:  -0.046364501336421324
Bond Position:  [26.53623977]


portfolio before change:  [22.11004441]
curr_Stock_Price:  95.50094993546725
curr_Factors:  [95.50094994]
mat_Sqrt:  [[0.15]]
grads:  [-0.02730179]
Stock Position:  -0.02730178881524662
Bond Position:  [24.71739118]


portfolio before change:  [22.10761987]
curr_Stock_Price:  95.64634049460858
curr_Factors:  [95.64634049]
mat_Sqrt:  [[0.15]]
grads:  [0.0189653]
Stock Position:  0.01896529507921873
Bond Position:  [20.2936588]


portfolio before change:  [22.10335976]
curr_Stock_Price:  95.35483409217315
curr_Factors:  [95.35483409]
mat_Sqrt:  [[0.15]]
grads:  [0.02520228]
Stock Position:  0.025202278432922134
Bond Position:  [19.70020068]


portfolio before change:  [22.10038048]
curr_Stock_Price:  95.18776261904716
curr_Factors:  [95.18776262]
mat_Sqrt:  [[0.15]]
grads:  [-0.00911538]
Stock Position:  -0.009115382650747428
Bond Position:  [22.96805336]


portfolio before change:  [22.10771116]
curr_Stock_Price:  94.54103945067637
curr_Factors:  [94.54103945]
mat_Sqrt:  [[0.15]]
grads:  [0.10895175]
Stock Position:  0.10895175449834658
Bond Position:  [11.80729904]


portfolio before change:  [22.1666559]
curr_Stock_Price:  95.07528285888
curr_Factors:  [95.07528286]
mat_Sqrt:  [[0.15]]
grads:  [0.05947582]
Stock Position:  0.05947581519024345
Bond Position:  [16.51197594]


portfolio before change:  [22.20493118]
curr_Stock_Price:  95.70147445806731
curr_Factors:  [95.70147446]
mat_Sqrt:  [[0.15]]
grads:  [0.0433469]
Stock Position:  0.043346896917064455
Bond Position:  [18.05656923]


portfolio before change:  [22.18112156]
curr_Stock_Price:  95.12615774159113
curr_Factors:  [95.12615774]
mat_Sqrt:  [[0.15]]
grads:  [0.07493664]
Stock Position:  0.07493664325242211
Bond Position:  [15.05268661]


portfolio before change:  [22.15575658]
curr_Stock_Price:  94.77511721494886
curr_Factors:  [94.77511721]
mat_Sqrt:  [[0.15]]
grads:  [0.08738848]
Stock Position:  0.08738848371675104
Bond Position:  [13.87350279]


portfolio before change:  [22.19177849]
curr_Stock_Price:  95.17739894877306
curr_Factors:  [95.17739895]
mat_Sqrt:  [[0.15]]
grads:  [-0.03313361]
Stock Position:  -0.0331336109885567
Bond Position:  [25.34534941]


portfolio before change:  [22.18284908]
curr_Stock_Price:  95.49470658791334
curr_Factors:  [95.49470659]
mat_Sqrt:  [[0.15]]
grads:  [-0.02623646]
Stock Position:  -0.02623645932866826
Bond Position:  [24.68829207]


portfolio before change:  [22.19621925]
curr_Stock_Price:  95.0439177268485
curr_Factors:  [95.04391773]
mat_Sqrt:  [[0.15]]
grads:  [-0.18097458]
Stock Position:  -0.18097457646256376
Bond Position:  [39.39675201]


portfolio before change:  [22.14927348]
curr_Stock_Price:  95.31692924697609
curr_Factors:  [95.31692925]
mat_Sqrt:  [[0.15]]
grads:  [-0.08575175]
Stock Position:  -0.08575174777473729
Bond Position:  [30.32286676]


portfolio before change:  [22.22904459]
curr_Stock_Price:  94.40877435361608
curr_Factors:  [94.40877435]
mat_Sqrt:  [[0.15]]
grads:  [-0.02293678]
Stock Position:  -0.022936783558054553
Bond Position:  [24.39447821]


portfolio before change:  [22.22870331]
curr_Stock_Price:  94.4901274872385
curr_Factors:  [94.49012749]
mat_Sqrt:  [[0.15]]
grads:  [-0.0406588]
Stock Position:  -0.04065879546161472
Bond Position:  [26.07055808]


portfolio before change:  [22.20619916]
curr_Stock_Price:  95.08369176221402
curr_Factors:  [95.08369176]
mat_Sqrt:  [[0.15]]
grads:  [0.14379944]
Stock Position:  0.1437994385221723
Bond Position:  [8.53321768]


portfolio before change:  [22.18461592]
curr_Stock_Price:  94.92989014017778
curr_Factors:  [94.92989014]
mat_Sqrt:  [[0.15]]
grads:  [0.0550643]
Stock Position:  0.05506429618223361
Bond Position:  [16.95736833]


portfolio before change:  [22.22233119]
curr_Stock_Price:  95.59557387833172
curr_Factors:  [95.59557388]
mat_Sqrt:  [[0.15]]
grads:  [0.01173531]
Stock Position:  0.011735307388140548
Bond Position:  [21.10048775]


portfolio before change:  [22.22451559]
curr_Stock_Price:  95.66933185539544
curr_Factors:  [95.66933186]
mat_Sqrt:  [[0.15]]
grads:  [0.09258366]
Stock Position:  0.0925836566074358
Bond Position:  [13.36709902]


portfolio before change:  [22.30342145]
curr_Stock_Price:  96.51257344150403
curr_Factors:  [96.51257344]
mat_Sqrt:  [[0.15]]
grads:  [-0.12235463]
Stock Position:  -0.12235462850636215
Bond Position:  [34.11218152]


portfolio before change:  [22.29320902]
curr_Stock_Price:  96.61346465702705
curr_Factors:  [96.61346466]
mat_Sqrt:  [[0.15]]
grads:  [0.06389484]
Stock Position:  0.06389483670755106
Bond Position:  [16.12010747]


portfolio before change:  [22.33180151]
curr_Stock_Price:  97.20169608482901
curr_Factors:  [97.20169608]
mat_Sqrt:  [[0.15]]
grads:  [0.01128326]
Stock Position:  0.011283258435178673
Bond Position:  [21.23504965]


portfolio before change:  [22.33338333]
curr_Stock_Price:  97.22425965426962
curr_Factors:  [97.22425965]
mat_Sqrt:  [[0.15]]
grads:  [-0.00445389]
Stock Position:  -0.004453893151700088
Bond Position:  [22.76640979]


portfolio before change:  [22.33422067]
curr_Stock_Price:  97.35574034187786
curr_Factors:  [97.35574034]
mat_Sqrt:  [[0.15]]
grads:  [0.05452907]
Stock Position:  0.05452907103561672
Bond Position:  [17.02550259]


portfolio before change:  [22.30536012]
curr_Stock_Price:  96.8069564194491
curr_Factors:  [96.80695642]
mat_Sqrt:  [[0.15]]
grads:  [-0.00909605]
Stock Position:  -0.009096049645843797
Bond Position:  [23.18592101]


portfolio before change:  [22.30909695]
curr_Stock_Price:  96.55545613497696
curr_Factors:  [96.55545613]
mat_Sqrt:  [[0.15]]
grads:  [0.01855971]
Stock Position:  0.018559708758930673
Bond Position:  [20.5170558]


portfolio before change:  [22.30209499]
curr_Stock_Price:  96.10909617164168
curr_Factors:  [96.10909617]
mat_Sqrt:  [[0.15]]
grads:  [0.05318051]
Stock Position:  0.05318051219454635
Bond Position:  [17.19096403]


portfolio before change:  [22.31576287]
curr_Stock_Price:  96.34590106119843
curr_Factors:  [96.34590106]
mat_Sqrt:  [[0.15]]
grads:  [-0.07830719]
Stock Position:  -0.07830719430992607
Bond Position:  [29.86034006]


portfolio before change:  [22.33694089]
curr_Stock_Price:  96.09928657999023
curr_Factors:  [96.09928658]
mat_Sqrt:  [[0.15]]
grads:  [-0.26609226]
Stock Position:  -0.2660922553683876
Bond Position:  [47.90821679]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.33694089]
Stock Price:  96.8628784710282
PL:  [22.33694089]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-5.64277645e-02]
 [ 1.67648396e-03]
 [ 3.07582444e-03]
 [ 2.59715065e-03]
 [ 5.99050939e-03]
 [ 9.58204576e-03]
 [ 4.90751485e-04]
 [ 1.48064756e-02]
 [ 1.76473592e-02]
 [-1.91881752e-02]
 [ 5.94671189e-03]
 [-5.95536299e-03]
 [-9.16082860e-03]
 [ 4.32109624e-03]
 [-9.72544455e-04]
 [ 1.46997682e-02]
 [-2.75190972e-03]
 [-4.49847980e-03]
 [-1.29985973e-03]
 [ 1.40294903e-02]
 [-2.80888020e-02]
 [-2.60155289e-02]
 [ 2.36713484e-04]
 [ 6.18614955e-03]
 [-1.11514770e-03]
 [ 1.48570051e-02]
 [ 1.63176624e-02]
 [ 1.07776681e-02]
 [ 3.91203515e-04]
 [ 3.35980386e-03]
 [-3.43359958e-03]
 [-4.41031907e-02]
 [ 2.39342184e-02]
 [ 1.09796554e-02]
 [-3.79628681e-02]
 [ 8.83870683e-03]
 [ 1.99140541e-03]
 [-1.32442864e-02]
 [ 1.04556977e-02]
 [-2.13393695e-02]
 [ 5.43722979e-02]
 [ 2.76047000e-03]
 [ 1.13045463e-02]
 [-1.04875095e-02]
 [-5.77486231e-03]
 [-2.34170609e-02]
 [-1.28736129e-02]
 [ 2.77634846e-03]
 [-3.09046123e-03]
 [-1.67679931e-02]
 [-4.62133426e-03]
 [ 2.80094659e-03]
 [ 3.99681856e-03]
 [-1.84470357e-03]
 [ 1.29074023e-02]
 [ 8.88894694e-03]
 [ 5.64290008e-03]
 [ 1.17120982e-02]
 [ 1.32012697e-02]
 [-6.20923236e-03]
 [-4.94547310e-03]
 [-2.76079904e-02]
 [-1.29043123e-02]
 [-3.69856995e-03]
 [-5.96029228e-03]
 [ 3.05461542e-02]
 [ 8.28139991e-03]
 [ 1.74312484e-03]
 [ 1.38141758e-02]
 [-1.89914719e-02]
 [ 1.61155689e-02]
 [-1.21712859e-02]
 [-5.60586364e-03]
 [ 7.92793228e-03]
 [-1.12948460e-02]
 [ 4.11302262e-03]
 [ 2.22130302e-02]
 [-1.85355564e-02]
 [-5.99033509e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.6027175]
curr_Stock_Price:  100.48436104839355
curr_Factors:  [100.48436105]
mat_Sqrt:  [[0.15]]
grads:  [-0.3761851]
Stock Position:  -0.37618509638828157
Bond Position:  [47.40343655]


portfolio before change:  [9.3555896]
curr_Stock_Price:  101.14916864144061
curr_Factors:  [101.14916864]
mat_Sqrt:  [[0.15]]
grads:  [0.01117656]
Stock Position:  0.011176559704565856
Bond Position:  [8.22508988]


portfolio before change:  [9.35450877]
curr_Stock_Price:  101.00646691871047
curr_Factors:  [101.00646692]
mat_Sqrt:  [[0.15]]
grads:  [0.0205055]
Stock Position:  0.020505496282756525
Bond Position:  [7.28332104]


portfolio before change:  [9.35552789]
curr_Stock_Price:  101.03396673786646
curr_Factors:  [101.03396674]
mat_Sqrt:  [[0.15]]
grads:  [0.01731434]
Stock Position:  0.01731433765566159
Bond Position:  [7.60619168]


portfolio before change:  [9.35022763]
curr_Stock_Price:  100.700389934405
curr_Factors:  [100.70038993]
mat_Sqrt:  [[0.15]]
grads:  [0.03993673]
Stock Position:  0.0399367292643823
Bond Position:  [5.32858342]


portfolio before change:  [9.29270155]
curr_Stock_Price:  99.25162017041563
curr_Factors:  [99.25162017]
mat_Sqrt:  [[0.15]]
grads:  [0.06388031]
Stock Position:  0.06388030505021777
Bond Position:  [2.95247778]


portfolio before change:  [9.2914789]
curr_Stock_Price:  99.22959159841173
curr_Factors:  [99.2295916]
mat_Sqrt:  [[0.15]]
grads:  [0.00327168]
Stock Position:  0.0032716765684078506
Bond Position:  [8.96683177]


portfolio before change:  [9.29072149]
curr_Stock_Price:  98.82678609172112
curr_Factors:  [98.82678609]
mat_Sqrt:  [[0.15]]
grads:  [0.09870984]
Stock Position:  0.09870983724326296
Bond Position:  [-0.46445448]


portfolio before change:  [9.31654341]
curr_Stock_Price:  99.08867433208782
curr_Factors:  [99.08867433]
mat_Sqrt:  [[0.15]]
grads:  [0.11764906]
Stock Position:  0.11764906150239499
Bond Position:  [-2.34114613]


portfolio before change:  [9.36277546]
curr_Stock_Price:  99.48288386204125
curr_Factors:  [99.48288386]
mat_Sqrt:  [[0.15]]
grads:  [-0.12792117]
Stock Position:  -0.12792116828208464
Bond Position:  [22.08874219]


portfolio before change:  [9.43620315]
curr_Stock_Price:  98.91966904136918
curr_Factors:  [98.91966904]
mat_Sqrt:  [[0.15]]
grads:  [0.03964475]
Stock Position:  0.03964474592778145
Bond Position:  [5.514558]


portfolio before change:  [9.44760677]
curr_Stock_Price:  99.1986202293959
curr_Factors:  [99.19862023]
mat_Sqrt:  [[0.15]]
grads:  [-0.03970242]
Stock Position:  -0.03970241991186698
Bond Position:  [13.38603205]


portfolio before change:  [9.41412928]
curr_Stock_Price:  100.0629037597691
curr_Factors:  [100.06290376]
mat_Sqrt:  [[0.15]]
grads:  [-0.06107219]
Stock Position:  -0.061072190665664154
Bond Position:  [15.52519001]


portfolio before change:  [9.41277249]
curr_Stock_Price:  100.10100857307742
curr_Factors:  [100.10100857]
mat_Sqrt:  [[0.15]]
grads:  [0.02880731]
Stock Position:  0.02880730825126652
Bond Position:  [6.52913188]


portfolio before change:  [9.38242524]
curr_Stock_Price:  99.03338622945536
curr_Factors:  [99.03338623]
mat_Sqrt:  [[0.15]]
grads:  [-0.00648363]
Stock Position:  -0.006483629697054127
Bond Position:  [10.02452105]


portfolio before change:  [9.38762335]
curr_Stock_Price:  98.32829379799622
curr_Factors:  [98.3282938]
mat_Sqrt:  [[0.15]]
grads:  [0.09799845]
Stock Position:  0.09799845460107161
Bond Position:  [-0.24839748]


portfolio before change:  [9.36756909]
curr_Stock_Price:  98.12381364780957
curr_Factors:  [98.12381365]
mat_Sqrt:  [[0.15]]
grads:  [-0.01834606]
Stock Position:  -0.01834606477815913
Bond Position:  [11.16775493]


portfolio before change:  [9.38254184]
curr_Stock_Price:  97.3457317828941
curr_Factors:  [97.34573178]
mat_Sqrt:  [[0.15]]
grads:  [-0.02998987]
Stock Position:  -0.029989865333699177
Bond Position:  [12.30192722]


portfolio before change:  [9.37574977]
curr_Stock_Price:  97.59784914283745
curr_Factors:  [97.59784914]
mat_Sqrt:  [[0.15]]
grads:  [-0.00866573]
Stock Position:  -0.008665731548138194
Bond Position:  [10.22150653]


portfolio before change:  [9.37282985]
curr_Stock_Price:  98.00852206503728
curr_Factors:  [98.00852207]
mat_Sqrt:  [[0.15]]
grads:  [0.09352994]
Stock Position:  0.09352993529383131
Bond Position:  [0.20609912]


portfolio before change:  [9.30118391]
curr_Stock_Price:  97.24236287508245
curr_Factors:  [97.24236288]
mat_Sqrt:  [[0.15]]
grads:  [-0.18725868]
Stock Position:  -0.18725867983611072
Bond Position:  [27.51066041]


portfolio before change:  [9.31248322]
curr_Stock_Price:  97.19120455925236
curr_Factors:  [97.19120456]
mat_Sqrt:  [[0.15]]
grads:  [-0.17343686]
Stock Position:  -0.1734368596551812
Bond Position:  [26.16902052]


portfolio before change:  [9.29297019]
curr_Stock_Price:  97.31314315278021
curr_Factors:  [97.31314315]
mat_Sqrt:  [[0.15]]
grads:  [0.00157809]
Stock Position:  0.001578089891710015
Bond Position:  [9.1394013]


portfolio before change:  [9.29388438]
curr_Stock_Price:  97.53046749869235
curr_Factors:  [97.5304675]
mat_Sqrt:  [[0.15]]
grads:  [0.041241]
Stock Position:  0.04124099697816121
Bond Position:  [5.27163066]


portfolio before change:  [9.29289883]
curr_Stock_Price:  97.49858086350454
curr_Factors:  [97.49858086]
mat_Sqrt:  [[0.15]]
grads:  [-0.00743432]
Stock Position:  -0.007434317968174845
Bond Position:  [10.01773428]


portfolio before change:  [9.29168682]
curr_Stock_Price:  97.74583031754898
curr_Factors:  [97.74583032]
mat_Sqrt:  [[0.15]]
grads:  [0.0990467]
Stock Position:  0.09904670073956774
Bond Position:  [-0.38971518]


portfolio before change:  [9.21812455]
curr_Stock_Price:  97.00337328824693
curr_Factors:  [97.00337329]
mat_Sqrt:  [[0.15]]
grads:  [0.10878442]
Stock Position:  0.10878441592466259
Bond Position:  [-1.33433076]


portfolio before change:  [9.1955805]
curr_Stock_Price:  96.79690392492678
curr_Factors:  [96.79690392]
mat_Sqrt:  [[0.15]]
grads:  [0.07185112]
Stock Position:  0.07185112067710972
Bond Position:  [2.24061447]


portfolio before change:  [9.17569006]
curr_Stock_Price:  96.5181263490755
curr_Factors:  [96.51812635]
mat_Sqrt:  [[0.15]]
grads:  [0.00260802]
Stock Position:  0.002608023434914454
Bond Position:  [8.92396852]


portfolio before change:  [9.17660256]
curr_Stock_Price:  96.6541424924245
curr_Factors:  [96.65414249]
mat_Sqrt:  [[0.15]]
grads:  [0.02239869]
Stock Position:  0.022398692415411516
Bond Position:  [7.01167615]


portfolio before change:  [9.1627252]
curr_Stock_Price:  96.01501558134215
curr_Factors:  [96.01501558]
mat_Sqrt:  [[0.15]]
grads:  [-0.02289066]
Stock Position:  -0.02289066389064268
Bond Position:  [11.36057265]


portfolio before change:  [9.17371484]
curr_Stock_Price:  95.56594219742117
curr_Factors:  [95.5659422]
mat_Sqrt:  [[0.15]]
grads:  [-0.29402127]
Stock Position:  -0.29402127153823676
Bond Position:  [37.27213468]


portfolio before change:  [9.3009907]
curr_Stock_Price:  95.14098559528746
curr_Factors:  [95.1409856]
mat_Sqrt:  [[0.15]]
grads:  [0.15956146]
Stock Position:  0.15956145607912833
Bond Position:  [-5.87984349]


portfolio before change:  [9.19546533]
curr_Stock_Price:  94.48194251830438
curr_Factors:  [94.48194252]
mat_Sqrt:  [[0.15]]
grads:  [0.0731977]
Stock Position:  0.0731977026612111
Bond Position:  [2.27960419]


portfolio before change:  [9.22882401]
curr_Stock_Price:  94.93572994563449
curr_Factors:  [94.93572995]
mat_Sqrt:  [[0.15]]
grads:  [-0.25308579]
Stock Position:  -0.253085787485876
Bond Position:  [33.25570798]


portfolio before change:  [9.39344288]
curr_Stock_Price:  94.29349580669806
curr_Factors:  [94.29349581]
mat_Sqrt:  [[0.15]]
grads:  [0.05892471]
Stock Position:  0.05892471219098065
Bond Position:  [3.83722578]


portfolio before change:  [9.38865574]
curr_Stock_Price:  94.20818395722816
curr_Factors:  [94.20818396]
mat_Sqrt:  [[0.15]]
grads:  [0.01327604]
Stock Position:  0.01327603609367324
Bond Position:  [8.13794449]


portfolio before change:  [9.39846229]
curr_Stock_Price:  94.90853671386564
curr_Factors:  [94.90853671]
mat_Sqrt:  [[0.15]]
grads:  [-0.08829524]
Stock Position:  -0.08829524266818807
Bond Position:  [17.77843457]


portfolio before change:  [9.45659576]
curr_Stock_Price:  94.26272292803756
curr_Factors:  [94.26272293]
mat_Sqrt:  [[0.15]]
grads:  [0.06970465]
Stock Position:  0.06970465145249737
Bond Position:  [2.88604551]


portfolio before change:  [9.47052564]
curr_Stock_Price:  94.45997653592659
curr_Factors:  [94.45997654]
mat_Sqrt:  [[0.15]]
grads:  [-0.14226246]
Stock Position:  -0.1422624632569247
Bond Position:  [22.90863458]


portfolio before change:  [9.41444144]
curr_Stock_Price:  94.86427172798739
curr_Factors:  [94.86427173]
mat_Sqrt:  [[0.15]]
grads:  [0.36248199]
Stock Position:  0.36248198584456487
Bond Position:  [-24.97214816]


portfolio before change:  [9.49774842]
curr_Stock_Price:  95.09840140216558
curr_Factors:  [95.0984014]
mat_Sqrt:  [[0.15]]
grads:  [0.01840313]
Stock Position:  0.018403133329060444
Bond Position:  [7.74763986]


portfolio before change:  [9.48530883]
curr_Stock_Price:  94.39613865333571
curr_Factors:  [94.39613865]
mat_Sqrt:  [[0.15]]
grads:  [0.07536364]
Stock Position:  0.07536364203312806
Bond Position:  [2.37127203]


portfolio before change:  [9.43217554]
curr_Stock_Price:  93.68914648723427
curr_Factors:  [93.68914649]
mat_Sqrt:  [[0.15]]
grads:  [-0.06991673]
Stock Position:  -0.06991673021366823
Bond Position:  [15.98261431]


portfolio before change:  [9.44560181]
curr_Stock_Price:  93.51140182718126
curr_Factors:  [93.51140183]
mat_Sqrt:  [[0.15]]
grads:  [-0.03849908]
Stock Position:  -0.03849908203695857
Bond Position:  [13.04570494]


portfolio before change:  [9.45698333]
curr_Stock_Price:  93.23694995789393
curr_Factors:  [93.23694996]
mat_Sqrt:  [[0.15]]
grads:  [-0.15611374]
Stock Position:  -0.15611373952286023
Bond Position:  [24.01255225]


portfolio before change:  [9.46243484]
curr_Stock_Price:  93.21164354699812
curr_Factors:  [93.21164355]
mat_Sqrt:  [[0.15]]
grads:  [-0.08582409]
Stock Position:  -0.08582408592574031
Bond Position:  [17.46223895]


portfolio before change:  [9.44299998]
curr_Stock_Price:  93.45081056376276
curr_Factors:  [93.45081056]
mat_Sqrt:  [[0.15]]
grads:  [0.01850899]
Stock Position:  0.018508989744533626
Bond Position:  [7.71331988]


portfolio before change:  [9.44537763]
curr_Stock_Price:  93.55322354741195
curr_Factors:  [93.55322355]
mat_Sqrt:  [[0.15]]
grads:  [-0.02060307]
Stock Position:  -0.02060307485636703
Bond Position:  [11.3728617]


portfolio before change:  [9.44495276]
curr_Stock_Price:  93.60834622453622
curr_Factors:  [93.60834622]
mat_Sqrt:  [[0.15]]
grads:  [-0.11178662]
Stock Position:  -0.11178662045518727
Bond Position:  [19.90911343]


portfolio before change:  [9.46972517]
curr_Stock_Price:  93.39787340858052
curr_Factors:  [93.39787341]
mat_Sqrt:  [[0.15]]
grads:  [-0.0308089]
Stock Position:  -0.03080889509788976
Bond Position:  [12.34721045]


portfolio before change:  [9.46313141]
curr_Stock_Price:  93.63694325044287
curr_Factors:  [93.63694325]
mat_Sqrt:  [[0.15]]
grads:  [0.01867298]
Stock Position:  0.018672977249072076
Bond Position:  [7.7146509]


portfolio before change:  [9.4778395]
curr_Stock_Price:  94.39878798291718
curr_Factors:  [94.39878798]
mat_Sqrt:  [[0.15]]
grads:  [0.02664546]
Stock Position:  0.02664545707095565
Bond Position:  [6.96254065]


portfolio before change:  [9.48014938]
curr_Stock_Price:  94.46914537630161
curr_Factors:  [94.46914538]
mat_Sqrt:  [[0.15]]
grads:  [-0.01229802]
Stock Position:  -0.012298023787648885
Bond Position:  [10.64193318]


portfolio before change:  [9.47203301]
curr_Stock_Price:  95.18320462931322
curr_Factors:  [95.18320463]
mat_Sqrt:  [[0.15]]
grads:  [0.08604935]
Stock Position:  0.08604934876499605
Bond Position:  [1.28158023]


portfolio before change:  [9.50356808]
curr_Stock_Price:  95.54875038135302
curr_Factors:  [95.54875038]
mat_Sqrt:  [[0.15]]
grads:  [0.05925965]
Stock Position:  0.05925964624617426
Bond Position:  [3.84138293]


portfolio before change:  [9.50573888]
curr_Stock_Price:  95.58133088227788
curr_Factors:  [95.58133088]
mat_Sqrt:  [[0.15]]
grads:  [0.03761933]
Stock Position:  0.03761933383936746
Bond Position:  [5.91003289]


portfolio before change:  [9.48357764]
curr_Stock_Price:  94.9824198474167
curr_Factors:  [94.98241985]
mat_Sqrt:  [[0.15]]
grads:  [0.07808065]
Stock Position:  0.07808065490579642
Bond Position:  [2.06728809]


portfolio before change:  [9.5042222]
curr_Stock_Price:  95.24516551056256
curr_Factors:  [95.24516551]
mat_Sqrt:  [[0.15]]
grads:  [0.08800846]
Stock Position:  0.08800846471593089
Bond Position:  [1.12184141]


portfolio before change:  [9.45491869]
curr_Stock_Price:  94.68415556738984
curr_Factors:  [94.68415557]
mat_Sqrt:  [[0.15]]
grads:  [-0.04139488]
Stock Position:  -0.041394882385900764
Bond Position:  [13.37435818]


portfolio before change:  [9.43633177]
curr_Stock_Price:  95.15336458305477
curr_Factors:  [95.15336458]
mat_Sqrt:  [[0.15]]
grads:  [-0.03296982]
Stock Position:  -0.03296982065584367
Bond Position:  [12.57352113]


portfolio before change:  [9.44376963]
curr_Stock_Price:  94.95160446048884
curr_Factors:  [94.95160446]
mat_Sqrt:  [[0.15]]
grads:  [-0.18405327]
Stock Position:  -0.18405326912616307
Bond Position:  [26.91992284]


portfolio before change:  [9.48813939]
curr_Stock_Price:  94.71967588146425
curr_Factors:  [94.71967588]
mat_Sqrt:  [[0.15]]
grads:  [-0.08602875]
Stock Position:  -0.08602874848973345
Bond Position:  [17.63675457]


portfolio before change:  [9.5445487]
curr_Stock_Price:  94.07678639004159
curr_Factors:  [94.07678639]
mat_Sqrt:  [[0.15]]
grads:  [-0.02465713]
Stock Position:  -0.02465713300875638
Bond Position:  [11.86421254]


portfolio before change:  [9.53764278]
curr_Stock_Price:  94.38693850884069
curr_Factors:  [94.38693851]
mat_Sqrt:  [[0.15]]
grads:  [-0.03973528]
Stock Position:  -0.039735281883844446
Bond Position:  [13.28813438]


portfolio before change:  [9.52996708]
curr_Stock_Price:  94.60101091233224
curr_Factors:  [94.60101091]
mat_Sqrt:  [[0.15]]
grads:  [0.20364103]
Stock Position:  0.20364102797478925
Bond Position:  [-9.73468003]


portfolio before change:  [9.56717503]
curr_Stock_Price:  94.78671211192713
curr_Factors:  [94.78671211]
mat_Sqrt:  [[0.15]]
grads:  [0.05520933]
Stock Position:  0.05520933276460471
Bond Position:  [4.3340639]


portfolio before change:  [9.58295931]
curr_Stock_Price:  95.06770440334624
curr_Factors:  [95.0677044]
mat_Sqrt:  [[0.15]]
grads:  [0.01162083]
Stock Position:  0.011620832281027444
Bond Position:  [8.47819347]


portfolio before change:  [9.59141596]
curr_Stock_Price:  95.74981937648172
curr_Factors:  [95.74981938]
mat_Sqrt:  [[0.15]]
grads:  [0.09209451]
Stock Position:  0.09209450541668028
Bond Position:  [0.7733837]


portfolio before change:  [9.58618507]
curr_Stock_Price:  95.69249532551096
curr_Factors:  [95.69249533]
mat_Sqrt:  [[0.15]]
grads:  [-0.12660981]
Stock Position:  -0.1266098123684166
Bond Position:  [21.70179395]


portfolio before change:  [9.6291232]
curr_Stock_Price:  95.36407112504112
curr_Factors:  [95.36407113]
mat_Sqrt:  [[0.15]]
grads:  [0.10743713]
Stock Position:  0.10743712611974171
Bond Position:  [-0.61651854]


portfolio before change:  [9.58121848]
curr_Stock_Price:  94.91854370775295
curr_Factors:  [94.91854371]
mat_Sqrt:  [[0.15]]
grads:  [-0.08114191]
Stock Position:  -0.08114190576066915
Bond Position:  [17.28309001]


portfolio before change:  [9.65077882]
curr_Stock_Price:  94.07458879946891
curr_Factors:  [94.0745888]
mat_Sqrt:  [[0.15]]
grads:  [-0.03737242]
Stock Position:  -0.0373724242419948
Bond Position:  [13.16657426]


portfolio before change:  [9.66597139]
curr_Stock_Price:  93.69009042390303
curr_Factors:  [93.69009042]
mat_Sqrt:  [[0.15]]
grads:  [0.05285288]
Stock Position:  0.05285288184146266
Bond Position:  [4.71418011]


portfolio before change:  [9.63745103]
curr_Stock_Price:  93.14489762262836
curr_Factors:  [93.14489762]
mat_Sqrt:  [[0.15]]
grads:  [-0.07529897]
Stock Position:  -0.07529897309305623
Bond Position:  [16.65116617]


portfolio before change:  [9.67115575]
curr_Stock_Price:  92.71110690601982
curr_Factors:  [92.71110691]
mat_Sqrt:  [[0.15]]
grads:  [0.02742015]
Stock Position:  0.02742015081268548
Bond Position:  [7.12900322]


portfolio before change:  [9.66924873]
curr_Stock_Price:  92.62530889234158
curr_Factors:  [92.62530889]
mat_Sqrt:  [[0.15]]
grads:  [0.14808687]
Stock Position:  0.14808686819192993
Bond Position:  [-4.04734318]


portfolio before change:  [9.57607873]
curr_Stock_Price:  91.99785932150522
curr_Factors:  [91.99785932]
mat_Sqrt:  [[0.15]]
grads:  [-0.12357038]
Stock Position:  -0.12357037605235134
Bond Position:  [20.9442888]


portfolio before change:  [9.57123505]
curr_Stock_Price:  92.04765066839333
curr_Factors:  [92.04765067]
mat_Sqrt:  [[0.15]]
grads:  [-0.39935567]
Stock Position:  -0.3993556724586692
Bond Position:  [46.33098648]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.57123505]
Stock Price:  93.00111532275209
PL:  [9.57123505]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.43097657e-02]
 [-3.24656906e-04]
 [-1.39527761e-04]
 [ 2.43186939e-03]
 [ 4.85242971e-03]
 [ 1.18124211e-02]
 [ 9.68124553e-04]
 [ 1.00210456e-02]
 [ 1.19140891e-03]
 [-1.93647400e-02]
 [ 6.10586742e-03]
 [-6.71582809e-03]
 [ 7.66483352e-03]
 [ 8.52508087e-03]
 [-4.04586254e-02]
 [ 2.28915122e-02]
 [-4.26828730e-03]
 [-9.92286585e-03]
 [-3.21185531e-02]
 [ 1.46550680e-02]
 [-1.01330552e-02]
 [-2.54344343e-02]
 [-1.37607741e-04]
 [ 6.65319147e-03]
 [-3.56058848e-03]
 [ 1.66904455e-02]
 [ 1.42807429e-02]
 [ 1.35213498e-03]
 [ 1.04009087e-03]
 [ 3.43391308e-04]
 [-3.41903971e-03]
 [-2.12575864e-02]
 [ 1.92481170e-02]
 [ 1.82949007e-02]
 [-1.47728224e-02]
 [ 7.70419438e-03]
 [-2.75602768e-03]
 [-5.52471666e-03]
 [ 6.19354333e-03]
 [-1.76767440e-02]
 [ 4.31926416e-02]
 [ 1.05739004e-03]
 [ 6.44129983e-03]
 [-8.57484542e-03]
 [-1.89620463e-05]
 [-7.14913501e-03]
 [-1.33810884e-02]
 [-8.48111600e-04]
 [-5.63743485e-03]
 [ 6.39525896e-03]
 [-3.23936439e-03]
 [ 3.01578272e-03]
 [ 3.24586455e-03]
 [ 2.41348990e-03]
 [ 2.72149888e-03]
 [ 9.01640397e-03]
 [ 1.19374937e-02]
 [ 1.95030442e-03]
 [ 1.37404111e-02]
 [ 1.73239278e-03]
 [ 3.37885945e-03]
 [-1.31838543e-02]
 [-1.25389768e-02]
 [-1.63998370e-03]
 [-1.22498815e-02]
 [ 2.22076382e-02]
 [ 1.50524636e-02]
 [ 2.00155141e-03]
 [ 6.57952736e-03]
 [-1.45644979e-02]
 [-5.63874411e-03]
 [-2.07625068e-04]
 [ 1.57943042e-03]
 [ 8.74520730e-03]
 [ 9.96849606e-03]
 [-6.34602229e-03]
 [-5.13587092e-03]
 [-1.03589072e-02]
 [-2.09118995e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.36329913]
curr_Stock_Price:  99.84383858556373
curr_Factors:  [99.84383859]
mat_Sqrt:  [[0.15]]
grads:  [-0.22873177]
Stock Position:  -0.22873177114085802
Bond Position:  [22.4741589]


portfolio before change:  [-0.34151996]
curr_Stock_Price:  99.75476266727439
curr_Factors:  [99.75476267]
mat_Sqrt:  [[0.15]]
grads:  [-0.00216438]
Stock Position:  -0.0021643793742971073
Bond Position:  [-0.12561281]


portfolio before change:  [-0.34109416]
curr_Stock_Price:  99.55440302235074
curr_Factors:  [99.55440302]
mat_Sqrt:  [[0.15]]
grads:  [-0.00093019]
Stock Position:  -0.0009301850733622828
Bond Position:  [-0.24849014]


portfolio before change:  [-0.34232434]
curr_Stock_Price:  100.86021541971589
curr_Factors:  [100.86021542]
mat_Sqrt:  [[0.15]]
grads:  [0.01621246]
Stock Position:  0.016212462627486622
Bond Position:  [-1.97751681]


portfolio before change:  [-0.34084077]
curr_Stock_Price:  100.95934710255075
curr_Factors:  [100.9593471]
mat_Sqrt:  [[0.15]]
grads:  [0.03234953]
Stock Position:  0.032349531369568016
Bond Position:  [-3.60682833]


portfolio before change:  [-0.35428539]
curr_Stock_Price:  100.5507107878314
curr_Factors:  [100.55071079]
mat_Sqrt:  [[0.15]]
grads:  [0.07874947]
Stock Position:  0.07874947402535767
Bond Position:  [-8.27260098]


portfolio before change:  [-0.35124097]
curr_Stock_Price:  100.59593614381475
curr_Factors:  [100.59593614]
mat_Sqrt:  [[0.15]]
grads:  [0.00645416]
Stock Position:  0.006454163687830981
Bond Position:  [-1.00050361]


portfolio before change:  [-0.35469469]
curr_Stock_Price:  100.07051012454892
curr_Factors:  [100.07051012]
mat_Sqrt:  [[0.15]]
grads:  [0.06680697]
Stock Position:  0.06680697040611014
Bond Position:  [-7.0401023]


portfolio before change:  [-0.31782239]
curr_Stock_Price:  100.62901953634916
curr_Factors:  [100.62901954]
mat_Sqrt:  [[0.15]]
grads:  [0.00794273]
Stock Position:  0.00794272606034736
Bond Position:  [-1.11709113]


portfolio before change:  [-0.32105082]
curr_Stock_Price:  100.23134694777104
curr_Factors:  [100.23134695]
mat_Sqrt:  [[0.15]]
grads:  [-0.12909827]
Stock Position:  -0.12909826691596424
Bond Position:  [12.61864237]


portfolio before change:  [-0.14056689]
curr_Stock_Price:  98.83942096490375
curr_Factors:  [98.83942096]
mat_Sqrt:  [[0.15]]
grads:  [0.04070578]
Stock Position:  0.0407057828190249
Bond Position:  [-4.1639029]


portfolio before change:  [-0.14371668]
curr_Stock_Price:  98.76843503090343
curr_Factors:  [98.76843503]
mat_Sqrt:  [[0.15]]
grads:  [-0.04477219]
Stock Position:  -0.0447721872728007
Bond Position:  [4.27836219]


portfolio before change:  [-0.08696548]
curr_Stock_Price:  97.50685265922658
curr_Factors:  [97.50685266]
mat_Sqrt:  [[0.15]]
grads:  [0.05109889]
Stock Position:  0.05109889015684253
Bond Position:  [-5.06945743]


portfolio before change:  [-0.12896855]
curr_Stock_Price:  96.69105756561117
curr_Factors:  [96.69105757]
mat_Sqrt:  [[0.15]]
grads:  [0.05683387]
Stock Position:  0.05683387244153154
Bond Position:  [-5.62429578]


portfolio before change:  [-0.15332894]
curr_Stock_Price:  96.2686183730701
curr_Factors:  [96.26861837]
mat_Sqrt:  [[0.15]]
grads:  [-0.26972417]
Stock Position:  -0.2697241692843145
Bond Position:  [25.81264418]


portfolio before change:  [-0.03178089]
curr_Stock_Price:  95.82396148718001
curr_Factors:  [95.82396149]
mat_Sqrt:  [[0.15]]
grads:  [0.15261008]
Stock Position:  0.15261008163739798
Bond Position:  [-14.65548347]


portfolio before change:  [0.15498839]
curr_Stock_Price:  97.0537968316664
curr_Factors:  [97.05379683]
mat_Sqrt:  [[0.15]]
grads:  [-0.02845525]
Stock Position:  -0.028455248643977357
Bond Position:  [2.91667831]


portfolio before change:  [0.16637929]
curr_Stock_Price:  96.65989389238348
curr_Factors:  [96.65989389]
mat_Sqrt:  [[0.15]]
grads:  [-0.06615244]
Stock Position:  -0.0661524390234437
Bond Position:  [6.56066703]


portfolio before change:  [0.18005816]
curr_Stock_Price:  96.45931450966471
curr_Factors:  [96.45931451]
mat_Sqrt:  [[0.15]]
grads:  [-0.21412369]
Stock Position:  -0.21412368762631762
Bond Position:  [20.83428229]


portfolio before change:  [0.13387288]
curr_Stock_Price:  96.68109038386056
curr_Factors:  [96.68109038]
mat_Sqrt:  [[0.15]]
grads:  [0.09770045]
Stock Position:  0.09770045359044287
Bond Position:  [-9.3119135]


portfolio before change:  [0.22925562]
curr_Stock_Price:  97.66332490253674
curr_Factors:  [97.6633249]
mat_Sqrt:  [[0.15]]
grads:  [-0.0675537]
Stock Position:  -0.06755370143807625
Bond Position:  [6.82677472]


portfolio before change:  [0.25383408]
curr_Stock_Price:  97.3058053978798
curr_Factors:  [97.3058054]
mat_Sqrt:  [[0.15]]
grads:  [-0.1695629]
Stock Position:  -0.16956289501065153
Bond Position:  [16.75328814]


portfolio before change:  [0.20353946]
curr_Stock_Price:  97.60859410075041
curr_Factors:  [97.6085941]
mat_Sqrt:  [[0.15]]
grads:  [-0.00091738]
Stock Position:  -0.0009173849397640007
Bond Position:  [0.29308412]


portfolio before change:  [0.20355538]
curr_Stock_Price:  97.6112115304662
curr_Factors:  [97.61121153]
mat_Sqrt:  [[0.15]]
grads:  [0.04435461]
Stock Position:  0.044354609825106264
Bond Position:  [-4.12595182]


portfolio before change:  [0.17557982]
curr_Stock_Price:  96.98630062263486
curr_Factors:  [96.98630062]
mat_Sqrt:  [[0.15]]
grads:  [-0.02373726]
Stock Position:  -0.02373725654049704
Bond Position:  [2.47776852]


portfolio before change:  [0.17272221]
curr_Stock_Price:  97.11320957369504
curr_Factors:  [97.11320957]
mat_Sqrt:  [[0.15]]
grads:  [0.11126964]
Stock Position:  0.11126963653492986
Bond Position:  [-10.63302932]


portfolio before change:  [0.26030231]
curr_Stock_Price:  97.90628020053168
curr_Factors:  [97.9062802]
mat_Sqrt:  [[0.15]]
grads:  [0.09520495]
Stock Position:  0.0952049529817022
Bond Position:  [-9.06086049]


portfolio before change:  [0.18201414]
curr_Stock_Price:  97.08991666259624
curr_Factors:  [97.08991666]
mat_Sqrt:  [[0.15]]
grads:  [0.00901423]
Stock Position:  0.009014233181047979
Bond Position:  [-0.69317701]


portfolio before change:  [0.18544918]
curr_Stock_Price:  97.47579189416666
curr_Factors:  [97.47579189]
mat_Sqrt:  [[0.15]]
grads:  [0.00693394]
Stock Position:  0.006933939122408519
Bond Position:  [-0.49044203]


portfolio before change:  [0.18276532]
curr_Stock_Price:  97.09315165617015
curr_Factors:  [97.09315166]
mat_Sqrt:  [[0.15]]
grads:  [0.00228928]
Stock Position:  0.0022892753883375916
Bond Position:  [-0.03950764]


portfolio before change:  [0.18233065]
curr_Stock_Price:  96.90435853083837
curr_Factors:  [96.90435853]
mat_Sqrt:  [[0.15]]
grads:  [-0.0227936]
Stock Position:  -0.022793598076443548
Bond Position:  [2.39112965]


portfolio before change:  [0.16977129]
curr_Stock_Price:  97.46191918990385
curr_Factors:  [97.46191919]
mat_Sqrt:  [[0.15]]
grads:  [-0.14171724]
Stock Position:  -0.14171724263994376
Bond Position:  [13.98180574]


portfolio before change:  [0.17929891]
curr_Stock_Price:  97.40085582073438
curr_Factors:  [97.40085582]
mat_Sqrt:  [[0.15]]
grads:  [0.12832078]
Stock Position:  0.12832077969297806
Bond Position:  [-12.31925485]


portfolio before change:  [0.32575453]
curr_Stock_Price:  98.54818048127584
curr_Factors:  [98.54818048]
mat_Sqrt:  [[0.15]]
grads:  [0.121966]
Stock Position:  0.12196600468371797
Bond Position:  [-11.69377331]


portfolio before change:  [0.34768359]
curr_Stock_Price:  98.7339695188129
curr_Factors:  [98.73396952]
mat_Sqrt:  [[0.15]]
grads:  [-0.09848548]
Stock Position:  -0.09848548255501503
Bond Position:  [10.07154623]


portfolio before change:  [0.45087078]
curr_Stock_Price:  97.69262118381562
curr_Factors:  [97.69262118]
mat_Sqrt:  [[0.15]]
grads:  [0.0513613]
Stock Position:  0.051361295891821236
Bond Position:  [-4.56674884]


portfolio before change:  [0.41768911]
curr_Stock_Price:  97.05213422758398
curr_Factors:  [97.05213423]
mat_Sqrt:  [[0.15]]
grads:  [-0.01837352]
Stock Position:  -0.0183735178956566
Bond Position:  [2.20087823]


portfolio before change:  [0.43452929]
curr_Stock_Price:  96.14307469964056
curr_Factors:  [96.1430747]
mat_Sqrt:  [[0.15]]
grads:  [-0.03683144]
Stock Position:  -0.036831444367921955
Bond Position:  [3.9756176]


portfolio before change:  [0.41972213]
curr_Stock_Price:  96.55184625280131
curr_Factors:  [96.55184625]
mat_Sqrt:  [[0.15]]
grads:  [0.04129029]
Stock Position:  0.04129028888009575
Bond Position:  [-3.5669315]


portfolio before change:  [0.4097801]
curr_Stock_Price:  96.31646188229352
curr_Factors:  [96.31646188]
mat_Sqrt:  [[0.15]]
grads:  [-0.11784496]
Stock Position:  -0.11784495967300503
Bond Position:  [11.76018966]


portfolio before change:  [0.39607455]
curr_Stock_Price:  96.4390006906466
curr_Factors:  [96.43900069]
mat_Sqrt:  [[0.15]]
grads:  [0.28795094]
Stock Position:  0.28795094429491236
Bond Position:  [-27.37362677]


portfolio before change:  [0.38889272]
curr_Stock_Price:  96.42000117262029
curr_Factors:  [96.42000117]
mat_Sqrt:  [[0.15]]
grads:  [0.00704927]
Stock Position:  0.0070492669640324366
Bond Position:  [-0.29079761]


portfolio before change:  [0.39116357]
curr_Stock_Price:  96.74472022646246
curr_Factors:  [96.74472023]
mat_Sqrt:  [[0.15]]
grads:  [0.042942]
Stock Position:  0.04294199885788792
Bond Position:  [-3.76324809]


portfolio before change:  [0.42267391]
curr_Stock_Price:  97.48398593994176
curr_Factors:  [97.48398594]
mat_Sqrt:  [[0.15]]
grads:  [-0.05716564]
Stock Position:  -0.05716563614353048
Bond Position:  [5.99540798]


portfolio before change:  [0.45382565]
curr_Stock_Price:  96.94560279167423
curr_Factors:  [96.94560279]
mat_Sqrt:  [[0.15]]
grads:  [-0.00012641]
Stock Position:  -0.00012641364230763186
Bond Position:  [0.4660809]


portfolio before change:  [0.45383055]
curr_Stock_Price:  97.1372653330945
curr_Factors:  [97.13726533]
mat_Sqrt:  [[0.15]]
grads:  [-0.0476609]
Stock Position:  -0.047660900092738955
Bond Position:  [5.08348005]


portfolio before change:  [0.48726199]
curr_Stock_Price:  96.4424879519369
curr_Factors:  [96.44248795]
mat_Sqrt:  [[0.15]]
grads:  [-0.08920726]
Stock Position:  -0.08920725569385993
Bond Position:  [9.09063168]


portfolio before change:  [0.37426188]
curr_Stock_Price:  97.71557159009272
curr_Factors:  [97.71557159]
mat_Sqrt:  [[0.15]]
grads:  [-0.00565408]
Stock Position:  -0.00565407733142668
Bond Position:  [0.92675328]


portfolio before change:  [0.37318927]
curr_Stock_Price:  97.91552160746183
curr_Factors:  [97.91552161]
mat_Sqrt:  [[0.15]]
grads:  [-0.0375829]
Stock Position:  -0.037582899030766524
Bond Position:  [4.05313843]


portfolio before change:  [0.370521]
curr_Stock_Price:  97.99325909670316
curr_Factors:  [97.9932591]
mat_Sqrt:  [[0.15]]
grads:  [0.04263506]
Stock Position:  0.04263505970440326
Bond Position:  [-3.80742745]


portfolio before change:  [0.37351182]
curr_Stock_Price:  98.06899013124321
curr_Factors:  [98.06899013]
mat_Sqrt:  [[0.15]]
grads:  [-0.02159576]
Stock Position:  -0.021595762616074637
Bond Position:  [2.49138645]


portfolio before change:  [0.38592225]
curr_Stock_Price:  97.50153119234812
curr_Factors:  [97.50153119]
mat_Sqrt:  [[0.15]]
grads:  [0.02010522]
Stock Position:  0.020105218102444783
Bond Position:  [-1.5743673]


portfolio before change:  [0.3901216]
curr_Stock_Price:  97.71529428672291
curr_Factors:  [97.71529429]
mat_Sqrt:  [[0.15]]
grads:  [0.0216391]
Stock Position:  0.021639097017588788
Bond Position:  [-1.72434913]


portfolio before change:  [0.39529327]
curr_Stock_Price:  97.95927115108671
curr_Factors:  [97.95927115]
mat_Sqrt:  [[0.15]]
grads:  [0.01608993]
Stock Position:  0.01608993265805948
Bond Position:  [-1.18086481]


portfolio before change:  [0.39476753]
curr_Stock_Price:  97.93118366359943
curr_Factors:  [97.93118366]
mat_Sqrt:  [[0.15]]
grads:  [0.01814333]
Stock Position:  0.018143325839087555
Bond Position:  [-1.38202984]


portfolio before change:  [0.40534999]
curr_Stock_Price:  98.51921460176055
curr_Factors:  [98.5192146]
mat_Sqrt:  [[0.15]]
grads:  [0.06010936]
Stock Position:  0.06010935977745255
Bond Position:  [-5.51657693]


portfolio before change:  [0.33355072]
curr_Stock_Price:  97.33047336116077
curr_Factors:  [97.33047336]
mat_Sqrt:  [[0.15]]
grads:  [0.07958329]
Stock Position:  0.0795832915468263
Bond Position:  [-7.41232872]


portfolio before change:  [0.33432615]
curr_Stock_Price:  97.34603845327405
curr_Factors:  [97.34603845]
mat_Sqrt:  [[0.15]]
grads:  [0.01300203]
Stock Position:  0.013002029444407905
Bond Position:  [-0.9313699]


portfolio before change:  [0.34238359]
curr_Stock_Price:  97.97022186077763
curr_Factors:  [97.97022186]
mat_Sqrt:  [[0.15]]
grads:  [0.09160274]
Stock Position:  0.09160274039907512
Bond Position:  [-8.63195721]


portfolio before change:  [0.35395052]
curr_Stock_Price:  98.10238427722922
curr_Factors:  [98.10238428]
mat_Sqrt:  [[0.15]]
grads:  [0.01154929]
Stock Position:  0.011549285191753167
Bond Position:  [-0.7790619]


portfolio before change:  [0.35044692]
curr_Stock_Price:  97.8032395145503
curr_Factors:  [97.80323951]
mat_Sqrt:  [[0.15]]
grads:  [0.02252573]
Stock Position:  0.02252572965277925
Bond Position:  [-1.85264241]


portfolio before change:  [0.38072841]
curr_Stock_Price:  99.1526866427841
curr_Factors:  [99.15268664]
mat_Sqrt:  [[0.15]]
grads:  [-0.08789236]
Stock Position:  -0.08789236225866323
Bond Position:  [9.09549226]


portfolio before change:  [0.32684771]
curr_Stock_Price:  99.77218506666578
curr_Factors:  [99.77218507]
mat_Sqrt:  [[0.15]]
grads:  [-0.08359318]
Stock Position:  -0.0835931786067223
Bond Position:  [8.6671218]


portfolio before change:  [0.38713175]
curr_Stock_Price:  99.0575056050114
curr_Factors:  [99.05750561]
mat_Sqrt:  [[0.15]]
grads:  [-0.01093322]
Stock Position:  -0.010933224693285148
Bond Position:  [1.47014972]


portfolio before change:  [0.38706449]
curr_Stock_Price:  99.0720620812053
curr_Factors:  [99.07206208]
mat_Sqrt:  [[0.15]]
grads:  [-0.08166588]
Stock Position:  -0.08166587660230938
Bond Position:  [8.47787129]


portfolio before change:  [0.3616058]
curr_Stock_Price:  99.39029260210347
curr_Factors:  [99.3902926]
mat_Sqrt:  [[0.15]]
grads:  [0.14805092]
Stock Position:  0.14805092125346153
Bond Position:  [-14.35321858]


portfolio before change:  [0.39182763]
curr_Stock_Price:  99.60048339212334
curr_Factors:  [99.60048339]
mat_Sqrt:  [[0.15]]
grads:  [0.10034976]
Stock Position:  0.10034975723130521
Bond Position:  [-9.60305669]


portfolio before change:  [0.33357779]
curr_Stock_Price:  99.02599631051032
curr_Factors:  [99.02599631]
mat_Sqrt:  [[0.15]]
grads:  [0.01334368]
Stock Position:  0.01334367606934647
Bond Position:  [-0.98779303]


portfolio before change:  [0.34308645]
curr_Stock_Price:  99.74322001072694
curr_Factors:  [99.74322001]
mat_Sqrt:  [[0.15]]
grads:  [0.04386352]
Stock Position:  0.04386351576504402
Bond Position:  [-4.03200186]


portfolio before change:  [0.34068243]
curr_Stock_Price:  99.69415851173082
curr_Factors:  [99.69415851]
mat_Sqrt:  [[0.15]]
grads:  [-0.09709665]
Stock Position:  -0.09709665264559768
Bond Position:  [10.02065151]


portfolio before change:  [0.38624791]
curr_Stock_Price:  99.23132926186396
curr_Factors:  [99.23132926]
mat_Sqrt:  [[0.15]]
grads:  [-0.03759163]
Stock Position:  -0.03759162738394532
Bond Position:  [4.11651506]


portfolio before change:  [0.40306562]
curr_Stock_Price:  98.7907945938841
curr_Factors:  [98.79079459]
mat_Sqrt:  [[0.15]]
grads:  [-0.00138417]
Stock Position:  -0.0013841671183742292
Bond Position:  [0.53980859]


portfolio before change:  [0.40262482]
curr_Stock_Price:  99.1336271823982
curr_Factors:  [99.13362718]
mat_Sqrt:  [[0.15]]
grads:  [0.01052954]
Stock Position:  0.010529536146337677
Bond Position:  [-0.64120629]


portfolio before change:  [0.40102591]
curr_Stock_Price:  98.98558340096254
curr_Factors:  [98.9855834]
mat_Sqrt:  [[0.15]]
grads:  [0.05830138]
Stock Position:  0.0583013820209083
Bond Position:  [-5.3699704]


portfolio before change:  [0.40405203]
curr_Stock_Price:  99.04324507816146
curr_Factors:  [99.04324508]
mat_Sqrt:  [[0.15]]
grads:  [0.06645664]
Stock Position:  0.06645664042472568
Bond Position:  [-6.17802929]


portfolio before change:  [0.43320746]
curr_Stock_Price:  99.48776906382686
curr_Factors:  [99.48776906]
mat_Sqrt:  [[0.15]]
grads:  [-0.04230682]
Stock Position:  -0.042306815284873046
Bond Position:  [4.64221813]


portfolio before change:  [0.48367468]
curr_Stock_Price:  98.30174111265072
curr_Factors:  [98.30174111]
mat_Sqrt:  [[0.15]]
grads:  [-0.03423914]
Stock Position:  -0.03423913946279742
Bond Position:  [3.8494417]


portfolio before change:  [0.48919211]
curr_Stock_Price:  98.14762386081557
curr_Factors:  [98.14762386]
mat_Sqrt:  [[0.15]]
grads:  [-0.06905938]
Stock Position:  -0.06905938135905086
Bond Position:  [7.2672063]


portfolio before change:  [0.53444502]
curr_Stock_Price:  97.4989257047935
curr_Factors:  [97.4989257]
mat_Sqrt:  [[0.15]]
grads:  [-0.13941266]
Stock Position:  -0.13941266335663363
Bond Position:  [14.12702993]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.53444502]
Stock Price:  97.36530550355859
PL:  [0.53444502]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.90598206e-02]
 [-2.13664188e-03]
 [ 1.93473844e-04]
 [ 2.40414811e-03]
 [ 5.21025061e-03]
 [ 1.20163316e-02]
 [ 4.60782424e-04]
 [ 6.10908015e-03]
 [-5.58080413e-03]
 [-1.98289327e-02]
 [ 1.01647619e-02]
 [-7.51467799e-03]
 [ 1.43843263e-02]
 [ 4.75750625e-03]
 [ 5.36916835e-03]
 [-9.33081359e-03]
 [ 1.30638494e-02]
 [ 2.20928184e-02]
 [ 1.90827214e-02]
 [-4.33087029e-05]
 [ 7.19990852e-02]
 [-1.36412107e-02]
 [ 1.05568613e-03]
 [ 2.77913989e-03]
 [ 1.54440322e-02]
 [ 3.69251923e-03]
 [ 1.23842665e-02]
 [ 5.94023303e-04]
 [ 2.73843115e-03]
 [-2.35154870e-02]
 [-4.60575481e-03]
 [-5.69004101e-03]
 [ 1.40787378e-02]
 [ 1.61778478e-02]
 [-4.88869913e-03]
 [ 7.18116765e-03]
 [-2.81490909e-03]
 [ 2.33393575e-03]
 [ 7.09937553e-03]
 [-1.78628910e-02]
 [ 5.13849224e-02]
 [ 2.65854138e-03]
 [ 8.84891106e-03]
 [-9.22055579e-03]
 [-1.29876660e-04]
 [-9.81469420e-03]
 [-1.33598415e-02]
 [ 3.11506197e-04]
 [-2.70867610e-03]
 [ 1.14975694e-03]
 [-3.65839458e-03]
 [ 2.91168605e-03]
 [ 3.62524026e-03]
 [-8.37478676e-04]
 [ 6.35700892e-03]
 [ 8.84605887e-03]
 [ 8.37541725e-03]
 [ 7.94766508e-03]
 [ 1.33453237e-02]
 [-4.12849897e-04]
 [ 6.44603461e-04]
 [-1.69277161e-02]
 [-1.26911086e-02]
 [-1.03941511e-03]
 [-1.11288242e-02]
 [-9.80772204e-03]
 [ 1.27575425e-02]
 [ 2.00199435e-03]
 [ 7.62299563e-03]
 [-1.70466811e-02]
 [-4.05124746e-03]
 [-1.17757057e-03]
 [ 1.55157413e-03]
 [ 8.78790137e-03]
 [ 1.27491227e-02]
 [-5.13177988e-03]
 [-5.76500139e-03]
 [-1.05609793e-02]
 [-1.14589494e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.32770772]
curr_Stock_Price:  100.14533268985058
curr_Factors:  [100.14533269]
mat_Sqrt:  [[0.15]]
grads:  [-0.2603988]
Stock Position:  -0.26039880407235294
Bond Position:  [30.40543258]


portfolio before change:  [4.27457936]
curr_Stock_Price:  100.35665759349361
curr_Factors:  [100.35665759]
mat_Sqrt:  [[0.15]]
grads:  [-0.01424428]
Stock Position:  -0.01424427920490025
Bond Position:  [5.70408761]


portfolio before change:  [4.27476055]
curr_Stock_Price:  100.36896653663695
curr_Factors:  [100.36896654]
mat_Sqrt:  [[0.15]]
grads:  [0.00128983]
Stock Position:  0.0012898256251525342
Bond Position:  [4.14530208]


portfolio before change:  [4.27561567]
curr_Stock_Price:  100.8310735238851
curr_Factors:  [100.83107352]
mat_Sqrt:  [[0.15]]
grads:  [0.01602765]
Stock Position:  0.016027654088297365
Bond Position:  [2.65953011]


portfolio before change:  [4.27549057]
curr_Stock_Price:  100.81289705011233
curr_Factors:  [100.81289705]
mat_Sqrt:  [[0.15]]
grads:  [0.034735]
Stock Position:  0.03473500405003729
Bond Position:  [0.77375419]


portfolio before change:  [4.2897795]
curr_Stock_Price:  101.22287438688136
curr_Factors:  [101.22287439]
mat_Sqrt:  [[0.15]]
grads:  [0.08010888]
Stock Position:  0.08010887747612479
Bond Position:  [-3.81907134]


portfolio before change:  [4.27397151]
curr_Stock_Price:  101.02852282508907
curr_Factors:  [101.02852283]
mat_Sqrt:  [[0.15]]
grads:  [0.00307188]
Stock Position:  0.0030718828292146676
Bond Position:  [3.96362373]


portfolio before change:  [4.27603841]
curr_Stock_Price:  101.62071972683896
curr_Factors:  [101.62071973]
mat_Sqrt:  [[0.15]]
grads:  [0.0407272]
Stock Position:  0.04072720098360817
Bond Position:  [0.13731093]


portfolio before change:  [4.26378409]
curr_Stock_Price:  101.31962123928301
curr_Factors:  [101.31962124]
mat_Sqrt:  [[0.15]]
grads:  [-0.03720536]
Stock Position:  -0.037205360869514245
Bond Position:  [8.03341716]


portfolio before change:  [4.26903659]
curr_Stock_Price:  101.19194090665
curr_Factors:  [101.19194091]
mat_Sqrt:  [[0.15]]
grads:  [-0.13219288]
Stock Position:  -0.13219288488197106
Bond Position:  [17.64589118]


portfolio before change:  [4.2876675]
curr_Stock_Price:  101.05934667722902
curr_Factors:  [101.05934668]
mat_Sqrt:  [[0.15]]
grads:  [0.06776508]
Stock Position:  0.0677650790378096
Bond Position:  [-2.56062711]


portfolio before change:  [4.29409529]
curr_Stock_Price:  101.15656242379004
curr_Factors:  [101.15656242]
mat_Sqrt:  [[0.15]]
grads:  [-0.05009785]
Stock Position:  -0.05009785325822599
Bond Position:  [9.36182191]


portfolio before change:  [4.27413563]
curr_Stock_Price:  101.56665566802458
curr_Factors:  [101.56665567]
mat_Sqrt:  [[0.15]]
grads:  [0.09589551]
Stock Position:  0.09589550887211687
Bond Position:  [-5.4656505]


portfolio before change:  [4.28644376]
curr_Stock_Price:  101.69856733530649
curr_Factors:  [101.69856734]
mat_Sqrt:  [[0.15]]
grads:  [0.03171671]
Stock Position:  0.03171670831129488
Bond Position:  [1.06089996]


portfolio before change:  [4.25900155]
curr_Stock_Price:  100.83124790762307
curr_Factors:  [100.83124791]
mat_Sqrt:  [[0.15]]
grads:  [0.03579446]
Stock Position:  0.03579445563800708
Bond Position:  [0.64980192]


portfolio before change:  [4.261089]
curr_Stock_Price:  100.88843099513896
curr_Factors:  [100.888431]
mat_Sqrt:  [[0.15]]
grads:  [-0.06220542]
Stock Position:  -0.06220542391423842
Bond Position:  [10.53689662]


portfolio before change:  [4.24100681]
curr_Stock_Price:  101.22185476192895
curr_Factors:  [101.22185476]
mat_Sqrt:  [[0.15]]
grads:  [0.08709233]
Stock Position:  0.08709232937246364
Bond Position:  [-4.57464031]


portfolio before change:  [4.25489315]
curr_Stock_Price:  101.3845816789144
curr_Factors:  [101.38458168]
mat_Sqrt:  [[0.15]]
grads:  [0.14728546]
Stock Position:  0.14728545575913396
Bond Position:  [-10.67758117]


portfolio before change:  [4.21563496]
curr_Stock_Price:  101.12256784999424
curr_Factors:  [101.12256785]
mat_Sqrt:  [[0.15]]
grads:  [0.12721814]
Stock Position:  0.12721814265100498
Bond Position:  [-8.64899031]


portfolio before change:  [4.25917589]
curr_Stock_Price:  101.46907120217485
curr_Factors:  [101.4690712]
mat_Sqrt:  [[0.15]]
grads:  [-0.00028872]
Stock Position:  -0.00028872468596750336
Bond Position:  [4.28847252]


portfolio before change:  [4.25955393]
curr_Stock_Price:  101.08809208916975
curr_Factors:  [101.08809209]
mat_Sqrt:  [[0.15]]
grads:  [0.4799939]
Stock Position:  0.4799939014516917
Bond Position:  [-44.26211379]


portfolio before change:  [3.84087349]
curr_Stock_Price:  100.2215936569529
curr_Factors:  [100.22159366]
mat_Sqrt:  [[0.15]]
grads:  [-0.0909414]
Stock Position:  -0.09094140434622924
Bond Position:  [12.95516597]


portfolio before change:  [3.80456187]
curr_Stock_Price:  100.62978335495498
curr_Factors:  [100.62978335]
mat_Sqrt:  [[0.15]]
grads:  [0.00703791]
Stock Position:  0.00703790755309437
Bond Position:  [3.09633876]


portfolio before change:  [3.8074398]
curr_Stock_Price:  101.01120345959032
curr_Factors:  [101.01120346]
mat_Sqrt:  [[0.15]]
grads:  [0.0185276]
Stock Position:  0.018527599286816642
Bond Position:  [1.9359447]


portfolio before change:  [3.8116038]
curr_Stock_Price:  101.22941837973737
curr_Factors:  [101.22941838]
mat_Sqrt:  [[0.15]]
grads:  [0.10296021]
Stock Position:  0.10296021494583549
Bond Position:  [-6.61099888]


portfolio before change:  [3.79738733]
curr_Stock_Price:  101.095354307477
curr_Factors:  [101.09535431]
mat_Sqrt:  [[0.15]]
grads:  [0.02461679]
Stock Position:  0.024616794861338175
Bond Position:  [1.30874373]


portfolio before change:  [3.79743692]
curr_Stock_Price:  101.09404562616467
curr_Factors:  [101.09404563]
mat_Sqrt:  [[0.15]]
grads:  [0.08256178]
Stock Position:  0.08256177689814694
Bond Position:  [-4.54906713]


portfolio before change:  [3.7662828]
curr_Stock_Price:  100.72014636769366
curr_Factors:  [100.72014637]
mat_Sqrt:  [[0.15]]
grads:  [0.00396016]
Stock Position:  0.003960155350972531
Bond Position:  [3.36741538]


portfolio before change:  [3.76222949]
curr_Stock_Price:  99.64347449216893
curr_Factors:  [99.64347449]
mat_Sqrt:  [[0.15]]
grads:  [0.01825621]
Stock Position:  0.01825620767931868
Bond Position:  [1.94311752]


portfolio before change:  [3.76988944]
curr_Stock_Price:  100.05640291586711
curr_Factors:  [100.05640292]
mat_Sqrt:  [[0.15]]
grads:  [-0.15676991]
Stock Position:  -0.15676991304686388
Bond Position:  [19.45572303]


portfolio before change:  [3.75685354]
curr_Stock_Price:  100.14731273750787
curr_Factors:  [100.14731274]
mat_Sqrt:  [[0.15]]
grads:  [-0.03070503]
Stock Position:  -0.03070503205128504
Bond Position:  [6.83187998]


portfolio before change:  [3.77437306]
curr_Stock_Price:  99.590644470591
curr_Factors:  [99.59064447]
mat_Sqrt:  [[0.15]]
grads:  [-0.03793361]
Stock Position:  -0.03793360675233652
Bond Position:  [7.5522054]


portfolio before change:  [3.75775652]
curr_Stock_Price:  100.0411306835924
curr_Factors:  [100.04113068]
mat_Sqrt:  [[0.15]]
grads:  [0.09385825]
Stock Position:  0.09385825182046878
Bond Position:  [-5.63192912]


portfolio before change:  [3.75753522]
curr_Stock_Price:  100.04252322965695
curr_Factors:  [100.04252323]
mat_Sqrt:  [[0.15]]
grads:  [0.10785232]
Stock Position:  0.10785231874350397
Bond Position:  [-7.03228289]


portfolio before change:  [3.70253354]
curr_Stock_Price:  99.53662644238246
curr_Factors:  [99.53662644]
mat_Sqrt:  [[0.15]]
grads:  [-0.03259133]
Stock Position:  -0.03259132751224178
Bond Position:  [6.94656433]


portfolio before change:  [3.75335271]
curr_Stock_Price:  97.99066337076839
curr_Factors:  [97.99066337]
mat_Sqrt:  [[0.15]]
grads:  [0.04787445]
Stock Position:  0.04787445102442181
Bond Position:  [-0.93789651]


portfolio before change:  [3.72271364]
curr_Stock_Price:  97.35189991626375
curr_Factors:  [97.35189992]
mat_Sqrt:  [[0.15]]
grads:  [-0.01876606]
Stock Position:  -0.018766060630865555
Bond Position:  [5.54962529]


portfolio before change:  [3.72216057]
curr_Stock_Price:  97.39985522338316
curr_Factors:  [97.39985522]
mat_Sqrt:  [[0.15]]
grads:  [0.01555957]
Stock Position:  0.015559571645241643
Bond Position:  [2.20666054]


portfolio before change:  [3.70097461]
curr_Stock_Price:  96.02938852037329
curr_Factors:  [96.02938852]
mat_Sqrt:  [[0.15]]
grads:  [0.04732917]
Stock Position:  0.04732917021307773
Bond Position:  [-0.84401666]


portfolio before change:  [3.70990487]
curr_Stock_Price:  96.21918708686206
curr_Factors:  [96.21918709]
mat_Sqrt:  [[0.15]]
grads:  [-0.11908594]
Stock Position:  -0.11908594003501956
Bond Position:  [15.16825721]


portfolio before change:  [3.81839178]
curr_Stock_Price:  95.31615126527457
curr_Factors:  [95.31615127]
mat_Sqrt:  [[0.15]]
grads:  [0.34256615]
Stock Position:  0.3425661496390356
Bond Position:  [-28.83369515]


portfolio before change:  [3.76909191]
curr_Stock_Price:  95.17749859450112
curr_Factors:  [95.17749859]
mat_Sqrt:  [[0.15]]
grads:  [0.01772361]
Stock Position:  0.017723609185894464
Bond Position:  [2.08220312]


portfolio before change:  [3.77656574]
curr_Stock_Price:  95.59184352893564
curr_Factors:  [95.59184353]
mat_Sqrt:  [[0.15]]
grads:  [0.05899274]
Stock Position:  0.05899274041570174
Bond Position:  [-1.86265907]


portfolio before change:  [3.79763759]
curr_Stock_Price:  95.95101098924881
curr_Factors:  [95.95101099]
mat_Sqrt:  [[0.15]]
grads:  [-0.06147037]
Stock Position:  -0.06147037196258774
Bond Position:  [9.69578193]


portfolio before change:  [3.74117354]
curr_Stock_Price:  96.87942668419899
curr_Factors:  [96.87942668]
mat_Sqrt:  [[0.15]]
grads:  [-0.00086584]
Stock Position:  -0.0008658444019082051
Bond Position:  [3.82505605]


portfolio before change:  [3.74174271]
curr_Stock_Price:  96.49818438755898
curr_Factors:  [96.49818439]
mat_Sqrt:  [[0.15]]
grads:  [-0.06543129]
Stock Position:  -0.06543129466383162
Bond Position:  [10.05574385]


portfolio before change:  [3.75436688]
curr_Stock_Price:  96.31485214139647
curr_Factors:  [96.31485214]
mat_Sqrt:  [[0.15]]
grads:  [-0.08906561]
Stock Position:  -0.08906561015495014
Bond Position:  [12.33270795]


portfolio before change:  [3.75319645]
curr_Stock_Price:  96.33664780828867
curr_Factors:  [96.33664781]
mat_Sqrt:  [[0.15]]
grads:  [0.00207671]
Stock Position:  0.002076707979285526
Bond Position:  [3.55313337]


portfolio before change:  [3.75385267]
curr_Stock_Price:  96.54569772890584
curr_Factors:  [96.54569773]
mat_Sqrt:  [[0.15]]
grads:  [-0.01805784]
Stock Position:  -0.018057840643025076
Bond Position:  [5.49725949]


portfolio before change:  [3.74590812]
curr_Stock_Price:  97.00467485320974
curr_Factors:  [97.00467485]
mat_Sqrt:  [[0.15]]
grads:  [0.00766505]
Stock Position:  0.007665046265964495
Bond Position:  [3.0023628]


portfolio before change:  [3.74566137]
curr_Stock_Price:  96.94800135298524
curr_Factors:  [96.94800135]
mat_Sqrt:  [[0.15]]
grads:  [-0.0243893]
Stock Position:  -0.024389297182878918
Bond Position:  [6.11015498]


portfolio before change:  [3.76008902]
curr_Stock_Price:  96.37210306178278
curr_Factors:  [96.37210306]
mat_Sqrt:  [[0.15]]
grads:  [0.01941124]
Stock Position:  0.019411240318554804
Bond Position:  [1.88938697]


portfolio before change:  [3.75375714]
curr_Stock_Price:  96.03982293895868
curr_Factors:  [96.03982294]
mat_Sqrt:  [[0.15]]
grads:  [0.02416827]
Stock Position:  0.02416826839783982
Bond Position:  [1.43264092]


portfolio before change:  [3.74629841]
curr_Stock_Price:  95.72750138905735
curr_Factors:  [95.72750139]
mat_Sqrt:  [[0.15]]
grads:  [-0.00558319]
Stock Position:  -0.005583191176409654
Bond Position:  [4.28076335]


portfolio before change:  [3.74262962]
curr_Stock_Price:  96.43253664405734
curr_Factors:  [96.43253664]
mat_Sqrt:  [[0.15]]
grads:  [0.04238006]
Stock Position:  0.0423800594656143
Bond Position:  [-0.34418702]


portfolio before change:  [3.73357353]
curr_Stock_Price:  96.21935678229866
curr_Factors:  [96.21935678]
mat_Sqrt:  [[0.15]]
grads:  [0.05897373]
Stock Position:  0.05897372581100825
Bond Position:  [-1.94084043]


portfolio before change:  [3.71836063]
curr_Stock_Price:  95.96345312162995
curr_Factors:  [95.96345312]
mat_Sqrt:  [[0.15]]
grads:  [0.05583612]
Stock Position:  0.055836115010553154
Bond Position:  [-1.63986577]


portfolio before change:  [3.72754455]
curr_Stock_Price:  96.12976863527733
curr_Factors:  [96.12976864]
mat_Sqrt:  [[0.15]]
grads:  [0.05298443]
Stock Position:  0.052984433897153516
Bond Position:  [-1.36583682]


portfolio before change:  [3.71916759]
curr_Stock_Price:  95.9732775060501
curr_Factors:  [95.97327751]
mat_Sqrt:  [[0.15]]
grads:  [0.08896882]
Stock Position:  0.08896882476124883
Bond Position:  [-4.81946212]


portfolio before change:  [3.84740902]
curr_Stock_Price:  97.41808312784937
curr_Factors:  [97.41808313]
mat_Sqrt:  [[0.15]]
grads:  [-0.00275233]
Stock Position:  -0.0027523326444760707
Bond Position:  [4.11553599]


portfolio before change:  [3.84902637]
curr_Stock_Price:  96.92391271621871
curr_Factors:  [96.92391272]
mat_Sqrt:  [[0.15]]
grads:  [0.00429736]
Stock Position:  0.004297356408343323
Bond Position:  [3.43250978]


portfolio before change:  [3.85040212]
curr_Stock_Price:  97.19412792945522
curr_Factors:  [97.19412793]
mat_Sqrt:  [[0.15]]
grads:  [-0.11285144]
Stock Position:  -0.11285144068841342
Bond Position:  [14.81889949]


portfolio before change:  [3.80732853]
curr_Stock_Price:  97.58401932924149
curr_Factors:  [97.58401933]
mat_Sqrt:  [[0.15]]
grads:  [-0.08460739]
Stock Position:  -0.08460739082341152
Bond Position:  [12.06365779]


portfolio before change:  [3.79039889]
curr_Stock_Price:  97.7930275715729
curr_Factors:  [97.79302757]
mat_Sqrt:  [[0.15]]
grads:  [-0.00692943]
Stock Position:  -0.006929434071380009
Bond Position:  [4.46804922]


portfolio before change:  [3.78760178]
curr_Stock_Price:  98.23698495611231
curr_Factors:  [98.23698496]
mat_Sqrt:  [[0.15]]
grads:  [-0.07419216]
Stock Position:  -0.07419216113886354
Bond Position:  [11.07601599]


portfolio before change:  [3.79044022]
curr_Stock_Price:  98.20805773390823
curr_Factors:  [98.20805773]
mat_Sqrt:  [[0.15]]
grads:  [-0.06538481]
Stock Position:  -0.06538481360426843
Bond Position:  [10.21175577]


portfolio before change:  [3.73640317]
curr_Stock_Price:  99.04426575674813
curr_Factors:  [99.04426576]
mat_Sqrt:  [[0.15]]
grads:  [0.08505028]
Stock Position:  0.08505028323742614
Bond Position:  [-4.68733969]


portfolio before change:  [3.7235291]
curr_Stock_Price:  98.89634026090059
curr_Factors:  [98.89634026]
mat_Sqrt:  [[0.15]]
grads:  [0.01334663]
Stock Position:  0.013346628987094041
Bond Position:  [2.40359634]


portfolio before change:  [3.72502035]
curr_Stock_Price:  98.99681702435473
curr_Factors:  [98.99681702]
mat_Sqrt:  [[0.15]]
grads:  [0.05081997]
Stock Position:  0.050819970848066574
Bond Position:  [-1.305995]


portfolio before change:  [3.69126621]
curr_Stock_Price:  98.33423270562585
curr_Factors:  [98.33423271]
mat_Sqrt:  [[0.15]]
grads:  [-0.11364454]
Stock Position:  -0.11364454058378005
Bond Position:  [14.86641491]


portfolio before change:  [3.63711624]
curr_Stock_Price:  98.81889436866116
curr_Factors:  [98.81889437]
mat_Sqrt:  [[0.15]]
grads:  [-0.02700832]
Stock Position:  -0.027008316419362948
Bond Position:  [6.30604821]


portfolio before change:  [3.6229332]
curr_Stock_Price:  99.35862358401307
curr_Factors:  [99.35862358]
mat_Sqrt:  [[0.15]]
grads:  [-0.00785047]
Stock Position:  -0.00785047048289694
Bond Position:  [4.40294514]


portfolio before change:  [3.62624323]
curr_Stock_Price:  98.97204302037242
curr_Factors:  [98.97204302]
mat_Sqrt:  [[0.15]]
grads:  [0.01034383]
Stock Position:  0.010343827516988263
Bond Position:  [2.60249349]


portfolio before change:  [3.6324697]
curr_Stock_Price:  99.55826801965428
curr_Factors:  [99.55826802]
mat_Sqrt:  [[0.15]]
grads:  [0.05858601]
Stock Position:  0.05858600915661352
Bond Position:  [-2.2002519]


portfolio before change:  [3.63104633]
curr_Stock_Price:  99.53631981780217
curr_Factors:  [99.53631982]
mat_Sqrt:  [[0.15]]
grads:  [0.08499415]
Stock Position:  0.08499415160669473
Bond Position:  [-4.82895873]


portfolio before change:  [3.59918534]
curr_Stock_Price:  99.1650099693522
curr_Factors:  [99.16500997]
mat_Sqrt:  [[0.15]]
grads:  [-0.03421187]
Stock Position:  -0.034211865895011545
Bond Position:  [6.99180536]


portfolio before change:  [3.62366232]
curr_Stock_Price:  98.46233057141146
curr_Factors:  [98.46233057]
mat_Sqrt:  [[0.15]]
grads:  [-0.03843334]
Stock Position:  -0.03843334261627824
Bond Position:  [7.4078988]


portfolio before change:  [3.64309276]
curr_Stock_Price:  97.96881550553287
curr_Factors:  [97.96881551]
mat_Sqrt:  [[0.15]]
grads:  [-0.07040653]
Stock Position:  -0.07040652844995468
Bond Position:  [10.54073695]


portfolio before change:  [3.63591051]
curr_Stock_Price:  98.08018393005788
curr_Factors:  [98.08018393]
mat_Sqrt:  [[0.15]]
grads:  [-0.076393]
Stock Position:  -0.07639299620344686
Bond Position:  [11.12854963]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.63591051]
Stock Price:  97.61799469950076
PL:  [3.63591051]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.98619180e-02]
 [ 6.78422070e-03]
 [-6.45409153e-05]
 [ 1.91010574e-03]
 [-3.40463631e-03]
 [ 1.18663747e-02]
 [ 7.19945905e-06]
 [ 7.82359591e-03]
 [-9.20256724e-03]
 [-9.57643992e-03]
 [ 9.97296132e-03]
 [-1.06649955e-02]
 [ 3.72774214e-02]
 [ 2.76337442e-02]
 [-9.64080046e-03]
 [-6.62194990e-03]
 [ 1.28323227e-02]
 [ 2.64502696e-02]
 [ 1.66754625e-03]
 [-2.57213390e-03]
 [ 4.99052736e-02]
 [-1.21228993e-02]
 [ 5.20221528e-03]
 [-2.55841713e-03]
 [ 1.71409072e-02]
 [ 1.79786964e-02]
 [ 1.11256957e-02]
 [ 5.06458217e-03]
 [ 5.13323461e-03]
 [-2.43097745e-02]
 [-5.68515676e-03]
 [ 3.98353909e-02]
 [ 6.59230941e-03]
 [ 5.47388357e-03]
 [ 1.19686443e-03]
 [-2.49553950e-03]
 [-5.92757245e-03]
 [ 1.16738178e-02]
 [-2.09168359e-03]
 [-1.38828613e-02]
 [-2.00643205e-03]
 [-2.91063605e-03]
 [ 8.19099159e-03]
 [-1.35593762e-02]
 [ 2.47163125e-03]
 [ 2.67856722e-04]
 [-1.36909514e-02]
 [-5.05414645e-03]
 [ 9.51618705e-05]
 [ 2.60953819e-03]
 [-2.98626357e-03]
 [ 3.73112212e-03]
 [ 1.89236136e-03]
 [ 6.92875728e-04]
 [ 1.78096687e-03]
 [ 8.97124209e-03]
 [ 1.17460847e-02]
 [-1.24975078e-03]
 [ 1.36864657e-02]
 [ 2.25656458e-03]
 [ 3.34202471e-03]
 [-1.40697126e-02]
 [-1.26720078e-02]
 [-1.01383091e-03]
 [-1.06557582e-02]
 [-2.39059546e-03]
 [ 1.29368159e-02]
 [ 2.23706302e-03]
 [ 7.00453125e-03]
 [-1.48158799e-02]
 [-5.74896453e-03]
 [-1.19342144e-03]
 [ 1.57184488e-03]
 [ 8.66913565e-03]
 [ 4.63504638e-03]
 [ 2.81990162e-04]
 [-7.50130323e-04]
 [-1.15899332e-02]
 [-2.33075613e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.46063847]
curr_Stock_Price:  99.38768790511809
curr_Factors:  [99.38768791]
mat_Sqrt:  [[0.15]]
grads:  [-0.26574612]
Stock Position:  -0.2657461197899917
Bond Position:  [18.95125395]


portfolio before change:  [-7.33521839]
curr_Stock_Price:  98.92019062777429
curr_Factors:  [98.92019063]
mat_Sqrt:  [[0.15]]
grads:  [0.04522814]
Stock Position:  0.04522813797920258
Bond Position:  [-11.80919442]


portfolio before change:  [-7.3048209]
curr_Stock_Price:  99.60860239715929
curr_Factors:  [99.6086024]
mat_Sqrt:  [[0.15]]
grads:  [-0.00043027]
Stock Position:  -0.00043027276845206944
Bond Position:  [-7.26196204]


portfolio before change:  [-7.30533518]
curr_Stock_Price:  99.74895111492376
curr_Factors:  [99.74895111]
mat_Sqrt:  [[0.15]]
grads:  [0.01273404]
Stock Position:  0.012734038251877395
Bond Position:  [-8.57554214]


portfolio before change:  [-7.31140526]
curr_Stock_Price:  99.31436036230461
curr_Factors:  [99.31436036]
mat_Sqrt:  [[0.15]]
grads:  [-0.02269758]
Stock Position:  -0.02269757537921051
Bond Position:  [-5.05721008]


portfolio before change:  [-7.34382028]
curr_Stock_Price:  100.72856146304053
curr_Factors:  [100.72856146]
mat_Sqrt:  [[0.15]]
grads:  [0.07910916]
Stock Position:  0.07910916446670602
Bond Position:  [-15.31237262]


portfolio before change:  [-7.28569367]
curr_Stock_Price:  101.47542398610803
curr_Factors:  [101.47542399]
mat_Sqrt:  [[0.15]]
grads:  [4.79963936e-05]
Stock Position:  4.79963936458355e-05
Bond Position:  [-7.29056412]


portfolio before change:  [-7.2861268]
curr_Stock_Price:  101.94506788908105
curr_Factors:  [101.94506789]
mat_Sqrt:  [[0.15]]
grads:  [0.05215731]
Stock Position:  0.052157306057762295
Bond Position:  [-12.60330691]


portfolio before change:  [-7.29295201]
curr_Stock_Price:  101.82931268229598
curr_Factors:  [101.82931268]
mat_Sqrt:  [[0.15]]
grads:  [-0.06135045]
Stock Position:  -0.06135044827329622
Bond Position:  [-1.04567803]


portfolio before change:  [-7.28589778]
curr_Stock_Price:  101.71326478225801
curr_Factors:  [101.71326478]
mat_Sqrt:  [[0.15]]
grads:  [-0.06384293]
Stock Position:  -0.06384293280313864
Bond Position:  [-0.79222465]


portfolio before change:  [-7.30295663]
curr_Stock_Price:  101.97968950826275
curr_Factors:  [101.97968951]
mat_Sqrt:  [[0.15]]
grads:  [0.06648641]
Stock Position:  0.06648640882932762
Bond Position:  [-14.08321996]


portfolio before change:  [-7.28444126]
curr_Stock_Price:  102.27141232553336
curr_Factors:  [102.27141233]
mat_Sqrt:  [[0.15]]
grads:  [-0.07109997]
Stock Position:  -0.07109996994466176
Bond Position:  [-0.01294691]


portfolio before change:  [-7.36422884]
curr_Stock_Price:  103.39358968819616
curr_Factors:  [103.39358969]
mat_Sqrt:  [[0.15]]
grads:  [0.24851614]
Stock Position:  0.24851614287045545
Bond Position:  [-33.05920495]


portfolio before change:  [-7.27817553]
curr_Stock_Price:  103.74817261265602
curr_Factors:  [103.74817261]
mat_Sqrt:  [[0.15]]
grads:  [0.18422496]
Stock Position:  0.18422496166592095
Bond Position:  [-26.39117865]


portfolio before change:  [-7.36238691]
curr_Stock_Price:  103.30001466940753
curr_Factors:  [103.30001467]
mat_Sqrt:  [[0.15]]
grads:  [-0.064272]
Stock Position:  -0.06427200305363465
Bond Position:  [-0.72308805]


portfolio before change:  [-7.39829691]
curr_Stock_Price:  103.85803071702094
curr_Factors:  [103.85803072]
mat_Sqrt:  [[0.15]]
grads:  [-0.04414633]
Stock Position:  -0.0441463326853928
Bond Position:  [-2.81334573]


portfolio before change:  [-7.37240677]
curr_Stock_Price:  103.26758586361542
curr_Factors:  [103.26758586]
mat_Sqrt:  [[0.15]]
grads:  [0.08554882]
Stock Position:  0.08554881813707017
Bond Position:  [-16.2068267]


portfolio before change:  [-7.40675673]
curr_Stock_Price:  102.87790198087063
curr_Factors:  [102.87790198]
mat_Sqrt:  [[0.15]]
grads:  [0.17633513]
Stock Position:  0.17633513087997743
Bond Position:  [-25.54774504]


portfolio before change:  [-7.35186411]
curr_Stock_Price:  103.19825448648274
curr_Factors:  [103.19825449]
mat_Sqrt:  [[0.15]]
grads:  [0.01111697]
Stock Position:  0.011116974994032705
Bond Position:  [-8.49911653]


portfolio before change:  [-7.35371101]
curr_Stock_Price:  103.07990487285048
curr_Factors:  [103.07990487]
mat_Sqrt:  [[0.15]]
grads:  [-0.01714756]
Stock Position:  -0.017147559349208783
Bond Position:  [-5.58614223]


portfolio before change:  [-7.33935501]
curr_Stock_Price:  102.22233972613685
curr_Factors:  [102.22233973]
mat_Sqrt:  [[0.15]]
grads:  [0.33270182]
Stock Position:  0.3327018237320042
Bond Position:  [-41.34891386]


portfolio before change:  [-7.25460795]
curr_Stock_Price:  102.48483137212843
curr_Factors:  [102.48483137]
mat_Sqrt:  [[0.15]]
grads:  [-0.08081933]
Stock Position:  -0.0808193285205567
Bond Position:  [1.02814731]


portfolio before change:  [-7.28129292]
curr_Stock_Price:  102.81580706784511
curr_Factors:  [102.81580707]
mat_Sqrt:  [[0.15]]
grads:  [0.03468144]
Stock Position:  0.03468143522352412
Bond Position:  [-10.84709267]


portfolio before change:  [-7.28407015]
curr_Stock_Price:  102.755277019837
curr_Factors:  [102.75527702]
mat_Sqrt:  [[0.15]]
grads:  [-0.01705611]
Stock Position:  -0.017056114181443212
Bond Position:  [-5.53146441]


portfolio before change:  [-7.27402448]
curr_Stock_Price:  102.14602909394708
curr_Factors:  [102.14602909]
mat_Sqrt:  [[0.15]]
grads:  [0.11427271]
Stock Position:  0.11427271477384543
Bond Position:  [-18.94652852]


portfolio before change:  [-7.30133608]
curr_Stock_Price:  101.91738822645306
curr_Factors:  [101.91738823]
mat_Sqrt:  [[0.15]]
grads:  [0.11985798]
Stock Position:  0.11985797614673963
Bond Position:  [-19.51694797]


portfolio before change:  [-7.30417899]
curr_Stock_Price:  101.90384667549962
curr_Factors:  [101.90384668]
mat_Sqrt:  [[0.15]]
grads:  [0.0741713]
Stock Position:  0.07417130470225948
Bond Position:  [-14.86252026]


portfolio before change:  [-7.27171096]
curr_Stock_Price:  102.35411474627008
curr_Factors:  [102.35411475]
mat_Sqrt:  [[0.15]]
grads:  [0.03376388]
Stock Position:  0.033763881106645854
Bond Position:  [-10.72758312]


portfolio before change:  [-7.28807446]
curr_Stock_Price:  101.88932806581866
curr_Factors:  [101.88932807]
mat_Sqrt:  [[0.15]]
grads:  [0.03422156]
Stock Position:  0.034221564092239254
Bond Position:  [-10.77488663]


portfolio before change:  [-7.30206249]
curr_Stock_Price:  101.50025827133057
curr_Factors:  [101.50025827]
mat_Sqrt:  [[0.15]]
grads:  [-0.16206516]
Stock Position:  -0.16206516352598715
Bond Position:  [9.14759347]


portfolio before change:  [-7.44829132]
curr_Stock_Price:  102.4060703352369
curr_Factors:  [102.40607034]
mat_Sqrt:  [[0.15]]
grads:  [-0.03790105]
Stock Position:  -0.037901045042780135
Bond Position:  [-3.56699424]


portfolio before change:  [-7.48256675]
curr_Stock_Price:  103.3045279588163
curr_Factors:  [103.30452796]
mat_Sqrt:  [[0.15]]
grads:  [0.26556927]
Stock Position:  0.2655692724201413
Bond Position:  [-34.91707508]


portfolio before change:  [-7.65839626]
curr_Stock_Price:  102.65066044492325
curr_Factors:  [102.65066044]
mat_Sqrt:  [[0.15]]
grads:  [0.04394873]
Stock Position:  0.04394872938275887
Bond Position:  [-12.16976235]


portfolio before change:  [-7.70474813]
curr_Stock_Price:  101.61328701817997
curr_Factors:  [101.61328702]
mat_Sqrt:  [[0.15]]
grads:  [0.03649256]
Stock Position:  0.036492557144585214
Bond Position:  [-11.41287682]


portfolio before change:  [-7.71858081]
curr_Stock_Price:  101.25377938256493
curr_Factors:  [101.25377938]
mat_Sqrt:  [[0.15]]
grads:  [0.0079791]
Stock Position:  0.007979096184949469
Bond Position:  [-8.52649446]


portfolio before change:  [-7.72466372]
curr_Stock_Price:  100.55821383659419
curr_Factors:  [100.55821384]
mat_Sqrt:  [[0.15]]
grads:  [-0.01663693]
Stock Position:  -0.016636930026725928
Bond Position:  [-6.05168375]


portfolio before change:  [-7.72887688]
curr_Stock_Price:  100.78871979749844
curr_Factors:  [100.7887198]
mat_Sqrt:  [[0.15]]
grads:  [-0.03951715]
Stock Position:  -0.039517149652405915
Bond Position:  [-3.74599395]


portfolio before change:  [-7.74396196]
curr_Stock_Price:  101.16453010949306
curr_Factors:  [101.16453011]
mat_Sqrt:  [[0.15]]
grads:  [0.07782545]
Stock Position:  0.07782545209309197
Bond Position:  [-15.61713725]


portfolio before change:  [-7.81476361]
curr_Stock_Price:  100.26732302568944
curr_Factors:  [100.26732303]
mat_Sqrt:  [[0.15]]
grads:  [-0.01394456]
Stock Position:  -0.013944557258433223
Bond Position:  [-6.41658018]


portfolio before change:  [-7.81064546]
curr_Stock_Price:  99.9432401404177
curr_Factors:  [99.94324014]
mat_Sqrt:  [[0.15]]
grads:  [-0.09255241]
Stock Position:  -0.09255240893173859
Bond Position:  [1.43934217]


portfolio before change:  [-7.80737861]
curr_Stock_Price:  99.90891483143254
curr_Factors:  [99.90891483]
mat_Sqrt:  [[0.15]]
grads:  [-0.01337621]
Stock Position:  -0.013376213674895268
Bond Position:  [-6.47097562]


portfolio before change:  [-7.81005637]
curr_Stock_Price:  100.07886612018402
curr_Factors:  [100.07886612]
mat_Sqrt:  [[0.15]]
grads:  [-0.01940424]
Stock Position:  -0.019404240362028907
Bond Position:  [-5.86810199]


portfolio before change:  [-7.82388721]
curr_Stock_Price:  100.77273875378552
curr_Factors:  [100.77273875]
mat_Sqrt:  [[0.15]]
grads:  [0.05460661]
Stock Position:  0.05460661059157823
Bond Position:  [-13.32674491]


portfolio before change:  [-7.83874005]
curr_Stock_Price:  100.51599519214555
curr_Factors:  [100.51599519]
mat_Sqrt:  [[0.15]]
grads:  [-0.09039584]
Stock Position:  -0.09039584140106463
Bond Position:  [1.24748791]


portfolio before change:  [-7.8167819]
curr_Stock_Price:  100.2739466434589
curr_Factors:  [100.27394664]
mat_Sqrt:  [[0.15]]
grads:  [0.01647754]
Stock Position:  0.016477541654698682
Bond Position:  [-9.46905003]


portfolio before change:  [-7.81382036]
curr_Stock_Price:  100.48959571017413
curr_Factors:  [100.48959571]
mat_Sqrt:  [[0.15]]
grads:  [0.00178571]
Stock Position:  0.0017857114819617357
Bond Position:  [-7.99326579]


portfolio before change:  [-7.81543427]
curr_Stock_Price:  99.86557819798418
curr_Factors:  [99.8655782]
mat_Sqrt:  [[0.15]]
grads:  [-0.09127301]
Stock Position:  -0.09127300954774695
Bond Position:  [1.2995976]


portfolio before change:  [-7.83449063]
curr_Stock_Price:  100.0752522668116
curr_Factors:  [100.07525227]
mat_Sqrt:  [[0.15]]
grads:  [-0.03369431]
Stock Position:  -0.033694309676947844
Bond Position:  [-4.46252409]


portfolio before change:  [-7.86116063]
curr_Stock_Price:  100.85850273787244
curr_Factors:  [100.85850274]
mat_Sqrt:  [[0.15]]
grads:  [0.00063441]
Stock Position:  0.0006344124697681424
Bond Position:  [-7.92514652]


portfolio before change:  [-7.86151416]
curr_Stock_Price:  101.08202552890636
curr_Factors:  [101.08202553]
mat_Sqrt:  [[0.15]]
grads:  [0.01739692]
Stock Position:  0.017396921271202275
Bond Position:  [-9.6200302]


portfolio before change:  [-7.88274938]
curr_Stock_Price:  99.89595661073736
curr_Factors:  [99.89595661]
mat_Sqrt:  [[0.15]]
grads:  [-0.01990842]
Stock Position:  -0.01990842380878392
Bond Position:  [-5.89397834]


portfolio before change:  [-7.89062636]
curr_Stock_Price:  100.2731134062076
curr_Factors:  [100.27311341]
mat_Sqrt:  [[0.15]]
grads:  [0.02487415]
Stock Position:  0.024874147477263277
Bond Position:  [-10.38483457]


portfolio before change:  [-7.91118843]
curr_Stock_Price:  99.47256368761417
curr_Factors:  [99.47256369]
mat_Sqrt:  [[0.15]]
grads:  [0.01261574]
Stock Position:  0.012615742422148099
Bond Position:  [-9.16610867]


portfolio before change:  [-7.92142559]
curr_Stock_Price:  98.7065154457457
curr_Factors:  [98.70651545]
mat_Sqrt:  [[0.15]]
grads:  [0.00461917]
Stock Position:  0.004619171523318502
Bond Position:  [-8.37736792]


portfolio before change:  [-7.92301316]
curr_Stock_Price:  98.47617794627375
curr_Factors:  [98.47617795]
mat_Sqrt:  [[0.15]]
grads:  [0.01187311]
Stock Position:  0.011873112467002898
Bond Position:  [-9.0922319]


portfolio before change:  [-7.9292516]
curr_Stock_Price:  97.99861575741176
curr_Factors:  [97.99861576]
mat_Sqrt:  [[0.15]]
grads:  [0.05980828]
Stock Position:  0.05980828059693937
Bond Position:  [-13.7903803]


portfolio before change:  [-7.97435804]
curr_Stock_Price:  97.25884332323791
curr_Factors:  [97.25884332]
mat_Sqrt:  [[0.15]]
grads:  [0.07830723]
Stock Position:  0.07830723159951233
Bond Position:  [-15.59042881]


portfolio before change:  [-7.95225822]
curr_Stock_Price:  97.55350642302912
curr_Factors:  [97.55350642]
mat_Sqrt:  [[0.15]]
grads:  [-0.00833167]
Stock Position:  -0.008331671892260046
Bond Position:  [-7.13947441]


portfolio before change:  [-7.95390464]
curr_Stock_Price:  97.69755819534508
curr_Factors:  [97.6975582]
mat_Sqrt:  [[0.15]]
grads:  [0.0912431]
Stock Position:  0.09124310439291919
Bond Position:  [-16.86813314]


portfolio before change:  [-7.90248343]
curr_Stock_Price:  98.27267567477814
curr_Factors:  [98.27267567]
mat_Sqrt:  [[0.15]]
grads:  [0.01504376]
Stock Position:  0.015043763878310752
Bond Position:  [-9.38087436]


portfolio before change:  [-7.91044035]
curr_Stock_Price:  97.78273162582408
curr_Factors:  [97.78273163]
mat_Sqrt:  [[0.15]]
grads:  [0.02228016]
Stock Position:  0.02228016473178981
Bond Position:  [-10.08905572]


portfolio before change:  [-7.89075768]
curr_Stock_Price:  98.69445129530482
curr_Factors:  [98.6944513]
mat_Sqrt:  [[0.15]]
grads:  [-0.09379808]
Stock Position:  -0.09379808395130913
Bond Position:  [1.36659275]


portfolio before change:  [-7.80927619]
curr_Stock_Price:  97.82667166651581
curr_Factors:  [97.82667167]
mat_Sqrt:  [[0.15]]
grads:  [-0.08448005]
Stock Position:  -0.08448005191990528
Bond Position:  [0.45512611]


portfolio before change:  [-7.79205439]
curr_Stock_Price:  97.62315194323891
curr_Factors:  [97.62315194]
mat_Sqrt:  [[0.15]]
grads:  [-0.00675887]
Stock Position:  -0.006758872737019045
Bond Position:  [-7.13223193]


portfolio before change:  [-7.79426725]
curr_Stock_Price:  97.88459748614159
curr_Factors:  [97.88459749]
mat_Sqrt:  [[0.15]]
grads:  [-0.07103839]
Stock Position:  -0.07103838814675695
Bond Position:  [-0.84070322]


portfolio before change:  [-7.84515083]
curr_Stock_Price:  98.60014068309273
curr_Factors:  [98.60014068]
mat_Sqrt:  [[0.15]]
grads:  [-0.0159373]
Stock Position:  -0.015937303085052666
Bond Position:  [-6.2737305]


portfolio before change:  [-7.85397579]
curr_Stock_Price:  99.12926678248128
curr_Factors:  [99.12926678]
mat_Sqrt:  [[0.15]]
grads:  [0.08624544]
Stock Position:  0.08624543954235657
Bond Position:  [-16.40342298]


portfolio before change:  [-7.92039145]
curr_Stock_Price:  98.37107701239701
curr_Factors:  [98.37107701]
mat_Sqrt:  [[0.15]]
grads:  [0.01491375]
Stock Position:  0.014913753448804017
Bond Position:  [-9.38747344]


portfolio before change:  [-7.9050942]
curr_Stock_Price:  99.4361331554647
curr_Factors:  [99.43613316]
mat_Sqrt:  [[0.15]]
grads:  [0.04669687]
Stock Position:  0.04669687499287436
Bond Position:  [-12.54845088]


portfolio before change:  [-7.90893536]
curr_Stock_Price:  99.37067139868255
curr_Factors:  [99.3706714]
mat_Sqrt:  [[0.15]]
grads:  [-0.09877253]
Stock Position:  -0.0987725328460149
Bond Position:  [1.90615754]


portfolio before change:  [-7.9353322]
curr_Stock_Price:  99.63912642136656
curr_Factors:  [99.63912642]
mat_Sqrt:  [[0.15]]
grads:  [-0.03832643]
Stock Position:  -0.03832643022847346
Bond Position:  [-4.11652018]


portfolio before change:  [-7.9258311]
curr_Stock_Price:  99.38451361414245
curr_Factors:  [99.38451361]
mat_Sqrt:  [[0.15]]
grads:  [-0.00795614]
Stock Position:  -0.007956142959809516
Bond Position:  [-7.1351137]


portfolio before change:  [-7.92393089]
curr_Stock_Price:  99.08962624417849
curr_Factors:  [99.08962624]
mat_Sqrt:  [[0.15]]
grads:  [0.01047897]
Stock Position:  0.010478965881130804
Bond Position:  [-8.9622877]


portfolio before change:  [-7.92950491]
curr_Stock_Price:  98.61115718911562
curr_Factors:  [98.61115719]
mat_Sqrt:  [[0.15]]
grads:  [0.05779424]
Stock Position:  0.05779423769019576
Bond Position:  [-13.62866157]


portfolio before change:  [-7.95280894]
curr_Stock_Price:  98.2226719388227
curr_Factors:  [98.22267194]
mat_Sqrt:  [[0.15]]
grads:  [0.03090031]
Stock Position:  0.030900309210480422
Bond Position:  [-10.98791987]


portfolio before change:  [-7.96216599]
curr_Stock_Price:  97.94208289516675
curr_Factors:  [97.9420829]
mat_Sqrt:  [[0.15]]
grads:  [0.00187993]
Stock Position:  0.001879934414011793
Bond Position:  [-8.14629068]


portfolio before change:  [-7.96302454]
curr_Stock_Price:  97.75623208182958
curr_Factors:  [97.75623208]
mat_Sqrt:  [[0.15]]
grads:  [-0.00500087]
Stock Position:  -0.005000868818983961
Bond Position:  [-7.47415844]


portfolio before change:  [-7.9571516]
curr_Stock_Price:  96.48843575397109
curr_Factors:  [96.48843575]
mat_Sqrt:  [[0.15]]
grads:  [-0.07726622]
Stock Position:  -0.07726622135955225
Bond Position:  [-0.50185477]


portfolio before change:  [-8.02216101]
curr_Stock_Price:  97.32939882166616
curr_Factors:  [97.32939882]
mat_Sqrt:  [[0.15]]
grads:  [-0.15538374]
Stock Position:  -0.15538374178732112
Bond Position:  [7.10124517]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.02216101]
Stock Price:  96.60339972701014
PL:  [-8.02216101]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-6.67783632e-02]
 [-2.39265584e-04]
 [-4.54372925e-04]
 [ 1.75711797e-03]
 [ 1.92893691e-02]
 [ 8.19398540e-03]
 [ 7.17642622e-04]
 [ 1.04817754e-02]
 [-1.61069719e-03]
 [-2.03812674e-02]
 [ 1.02059658e-02]
 [-8.97436512e-03]
 [ 8.19545714e-03]
 [ 9.33018966e-03]
 [-1.79163202e-03]
 [-9.30297615e-03]
 [ 1.18046319e-02]
 [ 2.39662869e-02]
 [ 1.25207578e-02]
 [-2.29256152e-03]
 [ 1.38072684e-02]
 [-9.11512238e-03]
 [-2.86749052e-04]
 [-2.30281256e-03]
 [ 1.77561393e-02]
 [ 1.81802318e-02]
 [ 1.15483633e-02]
 [ 3.76852294e-03]
 [ 4.54028122e-03]
 [-1.96308771e-02]
 [-5.51295501e-03]
 [ 2.64424063e-02]
 [ 7.01434059e-03]
 [ 1.71701556e-03]
 [-1.55806717e-03]
 [-4.72485820e-03]
 [-7.08363565e-03]
 [ 1.11741138e-02]
 [ 1.01917886e-03]
 [-8.71297140e-03]
 [-2.64062585e-02]
 [-2.40659008e-03]
 [ 1.30687497e-02]
 [-1.27338796e-02]
 [-2.09694317e-04]
 [ 2.25473559e-03]
 [-1.36631857e-02]
 [-3.03830906e-03]
 [-9.92147928e-04]
 [ 1.39224212e-03]
 [-3.02881167e-03]
 [ 3.69617753e-03]
 [ 3.12101340e-04]
 [ 2.07282614e-03]
 [-1.77308308e-03]
 [ 8.52301512e-03]
 [-6.75882255e-03]
 [-1.33642445e-02]
 [ 1.37703446e-02]
 [ 3.32873465e-03]
 [ 1.12102679e-02]
 [-1.44726678e-02]
 [-1.27143001e-02]
 [-2.72389420e-03]
 [-1.64062126e-02]
 [ 3.69726876e-04]
 [ 2.96778914e-02]
 [ 2.39145275e-03]
 [ 6.97178533e-03]
 [-1.51213757e-02]
 [-8.36002229e-03]
 [-7.93287770e-03]
 [ 2.23192183e-03]
 [ 8.31040108e-03]
 [ 6.06364395e-03]
 [-1.03956313e-02]
 [ 2.50489861e-03]
 [-6.29735018e-03]
 [ 5.57529507e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.06953846]
curr_Stock_Price:  100.64290525858213
curr_Factors:  [100.64290526]
mat_Sqrt:  [[0.15]]
grads:  [-0.44518909]
Stock Position:  -0.44518908827521964
Bond Position:  [56.8746617]


portfolio before change:  [12.4738827]
curr_Stock_Price:  99.74263732646087
curr_Factors:  [99.74263733]
mat_Sqrt:  [[0.15]]
grads:  [-0.0015951]
Stock Position:  -0.0015951038924333044
Bond Position:  [12.63298257]


portfolio before change:  [12.47533553]
curr_Stock_Price:  99.32683762925313
curr_Factors:  [99.32683763]
mat_Sqrt:  [[0.15]]
grads:  [-0.00302915]
Stock Position:  -0.003029152830519427
Bond Position:  [12.7762117]


portfolio before change:  [12.47501373]
curr_Stock_Price:  99.69669097110082
curr_Factors:  [99.69669097]
mat_Sqrt:  [[0.15]]
grads:  [0.01171412]
Stock Position:  0.01171411983246239
Bond Position:  [11.30715474]


portfolio before change:  [12.47735419]
curr_Stock_Price:  99.83615892824805
curr_Factors:  [99.83615893]
mat_Sqrt:  [[0.15]]
grads:  [0.12859579]
Stock Position:  0.12859579401433638
Bond Position:  [-0.36115594]


portfolio before change:  [12.37068119]
curr_Stock_Price:  99.00681278228042
curr_Factors:  [99.00681278]
mat_Sqrt:  [[0.15]]
grads:  [0.05462657]
Stock Position:  0.05462656935179834
Bond Position:  [6.96227867]


portfolio before change:  [12.34588995]
curr_Stock_Price:  98.54501554218955
curr_Factors:  [98.54501554]
mat_Sqrt:  [[0.15]]
grads:  [0.00478428]
Stock Position:  0.004784284144266397
Bond Position:  [11.87442259]


portfolio before change:  [12.35318242]
curr_Stock_Price:  99.91414370929608
curr_Factors:  [99.91414371]
mat_Sqrt:  [[0.15]]
grads:  [0.0698785]
Stock Position:  0.06987850296742097
Bond Position:  [5.37133163]


portfolio before change:  [12.41711889]
curr_Stock_Price:  100.82430554410082
curr_Factors:  [100.82430554]
mat_Sqrt:  [[0.15]]
grads:  [-0.01073798]
Stock Position:  -0.010737981265225462
Bond Position:  [13.49976839]


portfolio before change:  [12.41784272]
curr_Stock_Price:  100.83547370743048
curr_Factors:  [100.83547371]
mat_Sqrt:  [[0.15]]
grads:  [-0.13587512]
Stock Position:  -0.13587511591513302
Bond Position:  [26.1188744]


portfolio before change:  [12.4118588]
curr_Stock_Price:  100.89152814576437
curr_Factors:  [100.89152815]
mat_Sqrt:  [[0.15]]
grads:  [0.06803977]
Stock Position:  0.0680397720826914
Bond Position:  [5.54722222]


portfolio before change:  [12.46696972]
curr_Stock_Price:  101.69641340258431
curr_Factors:  [101.6964134]
mat_Sqrt:  [[0.15]]
grads:  [-0.0598291]
Stock Position:  -0.05982910077318964
Bond Position:  [18.55137469]


portfolio before change:  [12.50766093]
curr_Stock_Price:  101.03566949956613
curr_Factors:  [101.0356695]
mat_Sqrt:  [[0.15]]
grads:  [0.05463638]
Stock Position:  0.05463638093821724
Bond Position:  [6.98743761]


portfolio before change:  [12.57102354]
curr_Stock_Price:  102.1873907398852
curr_Factors:  [102.18739074]
mat_Sqrt:  [[0.15]]
grads:  [0.06220126]
Stock Position:  0.062201264419288055
Bond Position:  [6.21483863]


portfolio before change:  [12.55995094]
curr_Stock_Price:  102.00313329018246
curr_Factors:  [102.00313329]
mat_Sqrt:  [[0.15]]
grads:  [-0.01194421]
Stock Position:  -0.011944213435672937
Bond Position:  [13.77829813]


portfolio before change:  [12.55383568]
curr_Stock_Price:  102.58721727405647
curr_Factors:  [102.58721727]
mat_Sqrt:  [[0.15]]
grads:  [-0.06201984]
Stock Position:  -0.062019840967305374
Bond Position:  [18.91627858]


portfolio before change:  [12.52543687]
curr_Stock_Price:  103.06417936293457
curr_Factors:  [103.06417936]
mat_Sqrt:  [[0.15]]
grads:  [0.07869755]
Stock Position:  0.07869754584591294
Bond Position:  [4.41453889]


portfolio before change:  [12.54923806]
curr_Stock_Price:  103.36311206287763
curr_Factors:  [103.36311206]
mat_Sqrt:  [[0.15]]
grads:  [0.15977525]
Stock Position:  0.15977524591463904
Bond Position:  [-3.96562859]


portfolio before change:  [12.41704065]
curr_Stock_Price:  102.5372673011062
curr_Factors:  [102.5372673]
mat_Sqrt:  [[0.15]]
grads:  [0.08347172]
Stock Position:  0.08347171854722572
Bond Position:  [3.85807874]


portfolio before change:  [12.44771166]
curr_Stock_Price:  102.90182035672318
curr_Factors:  [102.90182036]
mat_Sqrt:  [[0.15]]
grads:  [-0.01528374]
Stock Position:  -0.01528374344560015
Bond Position:  [14.02043668]


portfolio before change:  [12.4336421]
curr_Stock_Price:  103.87971323923283
curr_Factors:  [103.87971324]
mat_Sqrt:  [[0.15]]
grads:  [0.09204846]
Stock Position:  0.0920484560715607
Bond Position:  [2.87167488]


portfolio before change:  [12.49791973]
curr_Stock_Price:  104.57606538434007
curr_Factors:  [104.57606538]
mat_Sqrt:  [[0.15]]
grads:  [-0.06076748]
Stock Position:  -0.06076748250653453
Bond Position:  [18.85274395]


portfolio before change:  [12.55763326]
curr_Stock_Price:  103.61280013801479
curr_Factors:  [103.61280014]
mat_Sqrt:  [[0.15]]
grads:  [-0.00191166]
Stock Position:  -0.0019116603477400153
Bond Position:  [12.75570574]


portfolio before change:  [12.55996566]
curr_Stock_Price:  102.80975835152282
curr_Factors:  [102.80975835]
mat_Sqrt:  [[0.15]]
grads:  [-0.01535208]
Stock Position:  -0.015352083711798655
Bond Position:  [14.13830968]


portfolio before change:  [12.55962659]
curr_Stock_Price:  102.88940489006434
curr_Factors:  [102.88940489]
mat_Sqrt:  [[0.15]]
grads:  [0.11837426]
Stock Position:  0.11837426192936033
Bond Position:  [0.38016923]


portfolio before change:  [12.53136664]
curr_Stock_Price:  102.6504702565084
curr_Factors:  [102.65047026]
mat_Sqrt:  [[0.15]]
grads:  [0.12120155]
Stock Position:  0.12120154509296181
Bond Position:  [0.08997105]


portfolio before change:  [12.40791877]
curr_Stock_Price:  101.63189006003505
curr_Factors:  [101.63189006]
mat_Sqrt:  [[0.15]]
grads:  [0.07698909]
Stock Position:  0.07698908867823379
Bond Position:  [4.58337218]


portfolio before change:  [12.40467034]
curr_Stock_Price:  101.5859756863367
curr_Factors:  [101.58597569]
mat_Sqrt:  [[0.15]]
grads:  [0.02512349]
Stock Position:  0.025123486288500415
Bond Position:  [9.85247647]


portfolio before change:  [12.40123086]
curr_Stock_Price:  101.4245618229061
curr_Factors:  [101.42456182]
mat_Sqrt:  [[0.15]]
grads:  [0.03026854]
Stock Position:  0.030268541480840707
Bond Position:  [9.3312573]


portfolio before change:  [12.41944431]
curr_Stock_Price:  102.00702226370497
curr_Factors:  [102.00702226]
mat_Sqrt:  [[0.15]]
grads:  [-0.13087251]
Stock Position:  -0.13087251367970315
Bond Position:  [25.76935973]


portfolio before change:  [12.45232897]
curr_Stock_Price:  101.76805669197076
curr_Factors:  [101.76805669]
mat_Sqrt:  [[0.15]]
grads:  [-0.03675303]
Stock Position:  -0.03675303337919809
Bond Position:  [16.19261375]


portfolio before change:  [12.4511985]
curr_Stock_Price:  101.8263522514051
curr_Factors:  [101.82635225]
mat_Sqrt:  [[0.15]]
grads:  [0.17628271]
Stock Position:  0.17628270836379087
Bond Position:  [-5.49902666]


portfolio before change:  [12.53041577]
curr_Stock_Price:  102.27767824209624
curr_Factors:  [102.27767824]
mat_Sqrt:  [[0.15]]
grads:  [0.04676227]
Stock Position:  0.04676227062113581
Bond Position:  [7.7476793]


portfolio before change:  [12.51791304]
curr_Stock_Price:  101.99995495583245
curr_Factors:  [101.99995496]
mat_Sqrt:  [[0.15]]
grads:  [0.01144677]
Stock Position:  0.011446770380423653
Bond Position:  [11.35034298]


portfolio before change:  [12.51484399]
curr_Stock_Price:  101.66986402083946
curr_Factors:  [101.66986402]
mat_Sqrt:  [[0.15]]
grads:  [-0.01038711]
Stock Position:  -0.010387114499722586
Bond Position:  [13.5709005]


portfolio before change:  [12.51826244]
curr_Stock_Price:  101.42241799676611
curr_Factors:  [101.422418]
mat_Sqrt:  [[0.15]]
grads:  [-0.03149905]
Stock Position:  -0.0314990546364794
Bond Position:  [15.71297273]


portfolio before change:  [12.51169965]
curr_Stock_Price:  101.66194547895792
curr_Factors:  [101.66194548]
mat_Sqrt:  [[0.15]]
grads:  [-0.04722424]
Stock Position:  -0.04722423766382546
Bond Position:  [17.31260752]


portfolio before change:  [12.53319167]
curr_Stock_Price:  101.229753177294
curr_Factors:  [101.22975318]
mat_Sqrt:  [[0.15]]
grads:  [0.07449409]
Stock Position:  0.07449409224853411
Bond Position:  [4.9921731]


portfolio before change:  [12.58670598]
curr_Stock_Price:  101.94393445366909
curr_Factors:  [101.94393445]
mat_Sqrt:  [[0.15]]
grads:  [0.00679453]
Stock Position:  0.006794525742447805
Bond Position:  [11.89404529]


portfolio before change:  [12.58602635]
curr_Stock_Price:  101.73449732406017
curr_Factors:  [101.73449732]
mat_Sqrt:  [[0.15]]
grads:  [-0.05808648]
Stock Position:  -0.058086475988434104
Bond Position:  [18.49542479]


portfolio before change:  [12.5669944]
curr_Stock_Price:  102.08204725959112
curr_Factors:  [102.08204726]
mat_Sqrt:  [[0.15]]
grads:  [-0.17604172]
Stock Position:  -0.1760417230298351
Bond Position:  [30.53769389]


portfolio before change:  [12.47843373]
curr_Stock_Price:  102.59595573817299
curr_Factors:  [102.59595574]
mat_Sqrt:  [[0.15]]
grads:  [-0.01604393]
Stock Position:  -0.016043933898328002
Bond Position:  [14.12447646]


portfolio before change:  [12.47197893]
curr_Stock_Price:  103.05330047317999
curr_Factors:  [103.05330047]
mat_Sqrt:  [[0.15]]
grads:  [0.087125]
Stock Position:  0.08712499830847364
Bond Position:  [3.4934603]


portfolio before change:  [12.50646396]
curr_Stock_Price:  103.44660532243296
curr_Factors:  [103.44660532]
mat_Sqrt:  [[0.15]]
grads:  [-0.08489253]
Stock Position:  -0.08489253099834253
Bond Position:  [21.28830811]


portfolio before change:  [12.59102311]
curr_Stock_Price:  102.46620589580756
curr_Factors:  [102.4662059]
mat_Sqrt:  [[0.15]]
grads:  [-0.00139796]
Stock Position:  -0.0013979621138479007
Bond Position:  [12.73426699]


portfolio before change:  [12.59220829]
curr_Stock_Price:  102.1877600488833
curr_Factors:  [102.18776005]
mat_Sqrt:  [[0.15]]
grads:  [0.01503157]
Stock Position:  0.01503157057238432
Bond Position:  [11.05616576]


portfolio before change:  [12.59108769]
curr_Stock_Price:  102.06723858964871
curr_Factors:  [102.06723859]
mat_Sqrt:  [[0.15]]
grads:  [-0.0910879]
Stock Position:  -0.09108790437701067
Bond Position:  [21.88817856]


portfolio before change:  [12.61492636]
curr_Stock_Price:  101.82054707424743
curr_Factors:  [101.82054707]
mat_Sqrt:  [[0.15]]
grads:  [-0.02025539]
Stock Position:  -0.02025539371483864
Bond Position:  [14.67734163]


portfolio before change:  [12.62238906]
curr_Stock_Price:  101.49740657643676
curr_Factors:  [101.49740658]
mat_Sqrt:  [[0.15]]
grads:  [-0.00661432]
Stock Position:  -0.006614319519221958
Bond Position:  [13.29372534]


portfolio before change:  [12.62453224]
curr_Stock_Price:  101.29900430655455
curr_Factors:  [101.29900431]
mat_Sqrt:  [[0.15]]
grads:  [0.00928161]
Stock Position:  0.009281614154981837
Bond Position:  [11.68431397]


portfolio before change:  [12.62631054]
curr_Stock_Price:  101.41191675697645
curr_Factors:  [101.41191676]
mat_Sqrt:  [[0.15]]
grads:  [-0.02019208]
Stock Position:  -0.020192077802442025
Bond Position:  [14.67402785]


portfolio before change:  [12.61610926]
curr_Stock_Price:  101.96255039377562
curr_Factors:  [101.96255039]
mat_Sqrt:  [[0.15]]
grads:  [0.02464118]
Stock Position:  0.024641183511784147
Bond Position:  [10.10363134]


portfolio before change:  [12.61353536]
curr_Stock_Price:  101.83246758992094
curr_Factors:  [101.83246759]
mat_Sqrt:  [[0.15]]
grads:  [0.00208068]
Stock Position:  0.002080675599553716
Bond Position:  [12.40165503]


portfolio before change:  [12.61432771]
curr_Stock_Price:  101.84074643691672
curr_Factors:  [101.84074644]
mat_Sqrt:  [[0.15]]
grads:  [0.01381884]
Stock Position:  0.01381884090280422
Bond Position:  [11.20700664]


portfolio before change:  [12.62203694]
curr_Stock_Price:  102.34793525072638
curr_Factors:  [102.34793525]
mat_Sqrt:  [[0.15]]
grads:  [-0.01182055]
Stock Position:  -0.01182055383360624
Bond Position:  [13.83184621]


portfolio before change:  [12.63199715]
curr_Stock_Price:  101.57845385497983
curr_Factors:  [101.57845385]
mat_Sqrt:  [[0.15]]
grads:  [0.0568201]
Stock Position:  0.05682010077052705
Bond Position:  [6.86029916]


portfolio before change:  [12.68945205]
curr_Stock_Price:  102.58207956443425
curr_Factors:  [102.58207956]
mat_Sqrt:  [[0.15]]
grads:  [-0.04505882]
Stock Position:  -0.04505881702922803
Bond Position:  [17.3116792]


portfolio before change:  [12.70221496]
curr_Stock_Price:  102.32284271744068
curr_Factors:  [102.32284272]
mat_Sqrt:  [[0.15]]
grads:  [-0.08909496]
Stock Position:  -0.08909496303692499
Bond Position:  [21.81866485]


portfolio before change:  [12.71093553]
curr_Stock_Price:  102.24026949001819
curr_Factors:  [102.24026949]
mat_Sqrt:  [[0.15]]
grads:  [0.0918023]
Stock Position:  0.09180229731983519
Bond Position:  [3.32504391]


portfolio before change:  [12.72326643]
curr_Stock_Price:  102.37232581614693
curr_Factors:  [102.37232582]
mat_Sqrt:  [[0.15]]
grads:  [0.02219156]
Stock Position:  0.022191564331193403
Bond Position:  [10.45146437]


portfolio before change:  [12.72766892]
curr_Stock_Price:  102.54127517748925
curr_Factors:  [102.54127518]
mat_Sqrt:  [[0.15]]
grads:  [0.07473512]
Stock Position:  0.0747351190328324
Bond Position:  [5.06423451]


portfolio before change:  [12.71644542]
curr_Stock_Price:  102.38686283462629
curr_Factors:  [102.38686283]
mat_Sqrt:  [[0.15]]
grads:  [-0.09648445]
Stock Position:  -0.09648445181728184
Bond Position:  [22.59518575]


portfolio before change:  [12.69234948]
curr_Stock_Price:  102.65123884995924
curr_Factors:  [102.65123885]
mat_Sqrt:  [[0.15]]
grads:  [-0.084762]
Stock Position:  -0.08476200075983557
Bond Position:  [21.39327387]


portfolio before change:  [12.77978496]
curr_Stock_Price:  101.63547283654292
curr_Factors:  [101.63547284]
mat_Sqrt:  [[0.15]]
grads:  [-0.01815929]
Stock Position:  -0.018159294642851025
Bond Position:  [14.62541346]


portfolio before change:  [12.76896027]
curr_Stock_Price:  102.28190828758589
curr_Factors:  [102.28190829]
mat_Sqrt:  [[0.15]]
grads:  [-0.10937475]
Stock Position:  -0.10937475083502053
Bond Position:  [23.9560185]


portfolio before change:  [12.79490077]
curr_Stock_Price:  102.0584270898442
curr_Factors:  [102.05842709]
mat_Sqrt:  [[0.15]]
grads:  [0.00246485]
Stock Position:  0.0024648458410940705
Bond Position:  [12.54334248]


portfolio before change:  [12.79636543]
curr_Stock_Price:  102.33457985837813
curr_Factors:  [102.33457986]
mat_Sqrt:  [[0.15]]
grads:  [0.19785261]
Stock Position:  0.19785260954491646
Bond Position:  [-7.45079825]


portfolio before change:  [12.84152989]
curr_Stock_Price:  102.56520687291214
curr_Factors:  [102.56520687]
mat_Sqrt:  [[0.15]]
grads:  [0.01594302]
Stock Position:  0.015943018319565558
Bond Position:  [11.20633092]


portfolio before change:  [12.83750955]
curr_Stock_Price:  102.26910470881144
curr_Factors:  [102.26910471]
mat_Sqrt:  [[0.15]]
grads:  [0.04647857]
Stock Position:  0.046478568845222966
Bond Position:  [8.08418792]


portfolio before change:  [12.84855155]
curr_Stock_Price:  102.49580544587415
curr_Factors:  [102.49580545]
mat_Sqrt:  [[0.15]]
grads:  [-0.10080917]
Stock Position:  -0.10080917139895207
Bond Position:  [23.18106877]


portfolio before change:  [12.96431085]
curr_Stock_Price:  101.36187652271329
curr_Factors:  [101.36187652]
mat_Sqrt:  [[0.15]]
grads:  [-0.05573348]
Stock Position:  -0.05573348190961342
Bond Position:  [18.61356116]


portfolio before change:  [12.90003754]
curr_Stock_Price:  102.53597678573567
curr_Factors:  [102.53597679]
mat_Sqrt:  [[0.15]]
grads:  [-0.05288585]
Stock Position:  -0.05288585131376455
Bond Position:  [18.32273996]


portfolio before change:  [12.97014316]
curr_Stock_Price:  101.2320284545263
curr_Factors:  [101.23202845]
mat_Sqrt:  [[0.15]]
grads:  [0.01487948]
Stock Position:  0.014879478836239343
Bond Position:  [11.46386334]


portfolio before change:  [12.97642745]
curr_Stock_Price:  101.60621976771382
curr_Factors:  [101.60621977]
mat_Sqrt:  [[0.15]]
grads:  [0.05540267]
Stock Position:  0.05540267389904792
Bond Position:  [7.34717119]


portfolio before change:  [12.95946553]
curr_Stock_Price:  101.29177416409014
curr_Factors:  [101.29177416]
mat_Sqrt:  [[0.15]]
grads:  [0.04042429]
Stock Position:  0.040424292967309094
Bond Position:  [8.86481718]


portfolio before change:  [12.96051298]
curr_Stock_Price:  101.30397918612498
curr_Factors:  [101.30397919]
mat_Sqrt:  [[0.15]]
grads:  [-0.06930421]
Stock Position:  -0.06930420836281606
Bond Position:  [19.98130506]


portfolio before change:  [12.9562772]
curr_Stock_Price:  101.38311792137371
curr_Factors:  [101.38311792]
mat_Sqrt:  [[0.15]]
grads:  [0.01669932]
Stock Position:  0.016699324090293614
Bond Position:  [11.26324766]


portfolio before change:  [12.9582603]
curr_Stock_Price:  101.4597149952364
curr_Factors:  [101.459715]
mat_Sqrt:  [[0.15]]
grads:  [-0.04198233]
Stock Position:  -0.04198233450842407
Bond Position:  [17.21777599]


portfolio before change:  [12.99731333]
curr_Stock_Price:  100.55512286202973
curr_Factors:  [100.55512286]
mat_Sqrt:  [[0.15]]
grads:  [0.03716863]
Stock Position:  0.03716863382823249
Bond Position:  [9.25981679]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.99731333]
Stock Price:  100.26724446901851
PL:  [12.73006886]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.88442058e-02]
 [-2.25112286e-03]
 [ 3.10306422e-04]
 [ 2.59897106e-03]
 [ 4.78100598e-03]
 [ 1.22930725e-02]
 [-6.15194491e-04]
 [ 7.30618453e-03]
 [-1.10726321e-02]
 [ 1.29487190e-02]
 [ 1.00568821e-02]
 [-8.73298420e-03]
 [ 1.87097316e-02]
 [ 4.37702516e-03]
 [ 1.08904042e-03]
 [-9.29090935e-03]
 [ 8.44445572e-03]
 [ 2.26249862e-02]
 [ 2.14284133e-02]
 [ 7.85472876e-03]
 [ 7.99122397e-02]
 [-1.35160639e-02]
 [-1.98862767e-03]
 [ 1.20065005e-02]
 [ 1.40646840e-02]
 [-2.63339904e-03]
 [ 1.11402150e-02]
 [ 1.18477583e-03]
 [ 6.45086678e-03]
 [-1.07767353e-02]
 [-5.73889840e-03]
 [ 4.11164459e-02]
 [ 4.23879022e-03]
 [-7.18061049e-03]
 [-6.92294104e-03]
 [-4.39911637e-03]
 [-5.59904863e-03]
 [ 3.54874778e-03]
 [ 1.73496615e-03]
 [-8.04122813e-03]
 [-3.48526507e-02]
 [-2.87917277e-03]
 [ 1.29484520e-02]
 [-1.19974219e-02]
 [-6.56530778e-04]
 [ 2.38415870e-03]
 [-1.36286727e-02]
 [ 4.38353025e-03]
 [ 4.56639792e-03]
 [-7.67042091e-03]
 [-3.63971775e-03]
 [ 3.43575375e-03]
 [ 9.63057921e-04]
 [ 2.92083385e-03]
 [-3.50604301e-03]
 [ 9.79945486e-03]
 [-1.13046269e-02]
 [-8.85016723e-03]
 [ 1.62564637e-02]
 [ 2.27574070e-03]
 [ 1.14342176e-02]
 [-1.45652108e-02]
 [-1.26792823e-02]
 [-3.04079656e-03]
 [-1.55234368e-02]
 [-5.00929448e-03]
 [ 2.93700481e-02]
 [ 2.22609406e-03]
 [ 6.29966027e-03]
 [-1.35584593e-02]
 [-8.35875076e-03]
 [-4.14059631e-03]
 [ 2.23941768e-03]
 [ 8.49084326e-03]
 [ 2.81442106e-03]
 [-1.16993753e-02]
 [ 2.57593827e-03]
 [-6.20346037e-03]
 [ 1.15158985e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.23408411]
curr_Stock_Price:  100.13931543913937
curr_Factors:  [100.13931544]
mat_Sqrt:  [[0.15]]
grads:  [-0.25896137]
Stock Position:  -0.2589613720005729
Bond Position:  [30.16629863]


portfolio before change:  [4.2672129]
curr_Stock_Price:  100.01866679149468
curr_Factors:  [100.01866679]
mat_Sqrt:  [[0.15]]
grads:  [-0.01500749]
Stock Position:  -0.015007485730150639
Bond Position:  [5.76824162]


portfolio before change:  [4.25923583]
curr_Stock_Price:  100.57422941614531
curr_Factors:  [100.57422942]
mat_Sqrt:  [[0.15]]
grads:  [0.00206871]
Stock Position:  0.0020687094788107247
Bond Position:  [4.05117697]


portfolio before change:  [4.26044406]
curr_Stock_Price:  101.03588043755605
curr_Factors:  [101.03588044]
mat_Sqrt:  [[0.15]]
grads:  [0.01732647]
Stock Position:  0.017326473724163516
Bond Position:  [2.50984853]


portfolio before change:  [4.27341739]
curr_Stock_Price:  101.77558443443176
curr_Factors:  [101.77558443]
mat_Sqrt:  [[0.15]]
grads:  [0.03187337]
Stock Position:  0.0318733732289341
Bond Position:  [1.0294862]


portfolio before change:  [4.29037457]
curr_Stock_Price:  102.30558255459086
curr_Factors:  [102.30558255]
mat_Sqrt:  [[0.15]]
grads:  [0.08195382]
Stock Position:  0.08195381656695029
Bond Position:  [-4.09395838]


portfolio before change:  [4.27445159]
curr_Stock_Price:  102.11441278386486
curr_Factors:  [102.11441278]
mat_Sqrt:  [[0.15]]
grads:  [-0.0041013]
Stock Position:  -0.004101296609880311
Bond Position:  [4.69325309]


portfolio before change:  [4.27560443]
curr_Stock_Price:  101.90484407807426
curr_Factors:  [101.90484408]
mat_Sqrt:  [[0.15]]
grads:  [0.0487079]
Stock Position:  0.0487078968735417
Bond Position:  [-0.6879662]


portfolio before change:  [4.28470114]
curr_Stock_Price:  102.09248728708761
curr_Factors:  [102.09248729]
mat_Sqrt:  [[0.15]]
grads:  [-0.07381755]
Stock Position:  -0.0738175475786859
Bond Position:  [11.82091818]


portfolio before change:  [4.25941612]
curr_Stock_Price:  102.44503016375496
curr_Factors:  [102.44503016]
mat_Sqrt:  [[0.15]]
grads:  [0.08632479]
Stock Position:  0.08632479318533337
Bond Position:  [-4.58412992]


portfolio before change:  [4.18419714]
curr_Stock_Price:  101.57700072029418
curr_Factors:  [101.57700072]
mat_Sqrt:  [[0.15]]
grads:  [0.06704588]
Stock Position:  0.06704588095113115
Bond Position:  [-2.62612236]


portfolio before change:  [4.18605379]
curr_Stock_Price:  101.6071410379608
curr_Factors:  [101.60714104]
mat_Sqrt:  [[0.15]]
grads:  [-0.05821989]
Stock Position:  -0.05821989469499053
Bond Position:  [10.10161084]


portfolio before change:  [4.16894589]
curr_Stock_Price:  101.91183529439512
curr_Factors:  [101.91183529]
mat_Sqrt:  [[0.15]]
grads:  [0.12473154]
Stock Position:  0.1247315439113197
Bond Position:  [-8.54267467]


portfolio before change:  [4.13421011]
curr_Stock_Price:  101.6376316490168
curr_Factors:  [101.63763165]
mat_Sqrt:  [[0.15]]
grads:  [0.02918017]
Stock Position:  0.029180167708849902
Bond Position:  [1.16840698]


portfolio before change:  [4.13119213]
curr_Stock_Price:  101.53170303737922
curr_Factors:  [101.53170304]
mat_Sqrt:  [[0.15]]
grads:  [0.00726027]
Stock Position:  0.007260269498267242
Bond Position:  [3.3940446]


portfolio before change:  [4.1391091]
curr_Stock_Price:  102.59293696527997
curr_Factors:  [102.59293697]
mat_Sqrt:  [[0.15]]
grads:  [-0.0619394]
Stock Position:  -0.0619393956832088
Bond Position:  [10.49365362]


portfolio before change:  [4.16097812]
curr_Stock_Price:  102.2504547662592
curr_Factors:  [102.25045477]
mat_Sqrt:  [[0.15]]
grads:  [0.05629637]
Stock Position:  0.056296371485950854
Bond Position:  [-1.59535147]


portfolio before change:  [4.11715659]
curr_Stock_Price:  101.47381828512829
curr_Factors:  [101.47381829]
mat_Sqrt:  [[0.15]]
grads:  [0.15083324]
Stock Position:  0.1508332413461507
Bond Position:  [-11.18846833]


portfolio before change:  [4.0017929]
curr_Stock_Price:  100.71361194340518
curr_Factors:  [100.71361194]
mat_Sqrt:  [[0.15]]
grads:  [0.14285609]
Stock Position:  0.14285608849432216
Bond Position:  [-10.38575976]


portfolio before change:  [3.88675097]
curr_Stock_Price:  99.9128564224005
curr_Factors:  [99.91285642]
mat_Sqrt:  [[0.15]]
grads:  [0.05236486]
Stock Position:  0.05236485843252378
Bond Position:  [-1.34517161]


portfolio before change:  [3.91484686]
curr_Stock_Price:  100.45100298963045
curr_Factors:  [100.45100299]
mat_Sqrt:  [[0.15]]
grads:  [0.53274826]
Stock Position:  0.5327482647496355
Bond Position:  [-49.60025067]


portfolio before change:  [3.8245551]
curr_Stock_Price:  100.28733910475117
curr_Factors:  [100.2873391]
mat_Sqrt:  [[0.15]]
grads:  [-0.09010709]
Stock Position:  -0.09010709279218122
Bond Position:  [12.86115567]


portfolio before change:  [3.83009758]
curr_Stock_Price:  100.23475020017989
curr_Factors:  [100.2347502]
mat_Sqrt:  [[0.15]]
grads:  [-0.01325752]
Stock Position:  -0.013257517823656292
Bond Position:  [5.15896157]


portfolio before change:  [3.83417019]
curr_Stock_Price:  99.95187964652327
curr_Factors:  [99.95187965]
mat_Sqrt:  [[0.15]]
grads:  [0.08004334]
Stock Position:  0.08004333644055671
Bond Position:  [-4.16631174]


portfolio before change:  [3.87104366]
curr_Stock_Price:  100.415801818043
curr_Factors:  [100.41580182]
mat_Sqrt:  [[0.15]]
grads:  [0.09376456]
Stock Position:  0.09376455987648592
Bond Position:  [-5.5443998]


portfolio before change:  [3.90025654]
curr_Stock_Price:  100.73105320691921
curr_Factors:  [100.73105321]
mat_Sqrt:  [[0.15]]
grads:  [-0.01755599]
Stock Position:  -0.01755599361276015
Bond Position:  [5.66869026]


portfolio before change:  [3.8801853]
curr_Stock_Price:  101.89450452066639
curr_Factors:  [101.89450452]
mat_Sqrt:  [[0.15]]
grads:  [0.0742681]
Stock Position:  0.0742681001935006
Bond Position:  [-3.68732597]


portfolio before change:  [3.96906952]
curr_Stock_Price:  103.09440988278615
curr_Factors:  [103.09440988]
mat_Sqrt:  [[0.15]]
grads:  [0.00789851]
Stock Position:  0.007898505530137129
Bond Position:  [3.15477776]


portfolio before change:  [3.96707089]
curr_Stock_Price:  102.81640665573403
curr_Factors:  [102.81640666]
mat_Sqrt:  [[0.15]]
grads:  [0.04300578]
Stock Position:  0.043005778562832275
Bond Position:  [-0.45462872]


portfolio before change:  [3.98225252]
curr_Stock_Price:  103.17008114346221
curr_Factors:  [103.17008114]
mat_Sqrt:  [[0.15]]
grads:  [-0.0718449]
Stock Position:  -0.0718449018941901
Bond Position:  [11.39449688]


portfolio before change:  [3.9565127]
curr_Stock_Price:  103.5382631412153
curr_Factors:  [103.53826314]
mat_Sqrt:  [[0.15]]
grads:  [-0.03825932]
Stock Position:  -0.03825932269213377
Bond Position:  [7.91781652]


portfolio before change:  [3.94934412]
curr_Stock_Price:  103.73856613437258
curr_Factors:  [103.73856613]
mat_Sqrt:  [[0.15]]
grads:  [0.27410964]
Stock Position:  0.27410963943062505
Bond Position:  [-24.48639683]


portfolio before change:  [4.08576288]
curr_Stock_Price:  104.24182901794796
curr_Factors:  [104.24182902]
mat_Sqrt:  [[0.15]]
grads:  [0.0282586]
Stock Position:  0.028258601478624457
Bond Position:  [1.14003458]


portfolio before change:  [4.08576728]
curr_Stock_Price:  104.23946313381124
curr_Factors:  [104.23946313]
mat_Sqrt:  [[0.15]]
grads:  [-0.04787074]
Stock Position:  -0.04787073660071499
Bond Position:  [9.07578717]


portfolio before change:  [4.11843212]
curr_Stock_Price:  103.56895785941478
curr_Factors:  [103.56895786]
mat_Sqrt:  [[0.15]]
grads:  [-0.04615294]
Stock Position:  -0.04615294024901333
Bond Position:  [8.89844404]


portfolio before change:  [4.1118186]
curr_Stock_Price:  103.72430426566591
curr_Factors:  [103.72430427]
mat_Sqrt:  [[0.15]]
grads:  [-0.02932744]
Stock Position:  -0.02932744246408341
Bond Position:  [7.15378716]


portfolio before change:  [4.13167245]
curr_Stock_Price:  103.0625782121767
curr_Factors:  [103.06257821]
mat_Sqrt:  [[0.15]]
grads:  [-0.03732699]
Stock Position:  -0.03732699083483228
Bond Position:  [7.97868837]


portfolio before change:  [4.14268538]
curr_Stock_Price:  102.78089881024738
curr_Factors:  [102.78089881]
mat_Sqrt:  [[0.15]]
grads:  [0.02365832]
Stock Position:  0.02365831852184902
Bond Position:  [1.71106214]


portfolio before change:  [4.1335473]
curr_Stock_Price:  102.39012607794986
curr_Factors:  [102.39012608]
mat_Sqrt:  [[0.15]]
grads:  [0.01156644]
Stock Position:  0.011566441004869086
Bond Position:  [2.94925795]


portfolio before change:  [4.14150616]
curr_Stock_Price:  103.06228837132822
curr_Factors:  [103.06228837]
mat_Sqrt:  [[0.15]]
grads:  [-0.05360819]
Stock Position:  -0.05360818755305589
Bond Position:  [9.66648865]


portfolio before change:  [4.15061146]
curr_Stock_Price:  102.90370942707827
curr_Factors:  [102.90370943]
mat_Sqrt:  [[0.15]]
grads:  [-0.232351]
Stock Position:  -0.23235100489922492
Bond Position:  [28.06039176]


portfolio before change:  [4.09958997]
curr_Stock_Price:  103.13084563512712
curr_Factors:  [103.13084564]
mat_Sqrt:  [[0.15]]
grads:  [-0.01919449]
Stock Position:  -0.019194485152336044
Bond Position:  [6.07913345]


portfolio before change:  [4.10255652]
curr_Stock_Price:  102.99608823694244
curr_Factors:  [102.99608824]
mat_Sqrt:  [[0.15]]
grads:  [0.08632301]
Stock Position:  0.08632301335311716
Bond Position:  [-4.78837618]


portfolio before change:  [4.10144032]
curr_Stock_Price:  102.98662474421634
curr_Factors:  [102.98662474]
mat_Sqrt:  [[0.15]]
grads:  [-0.07998281]
Stock Position:  -0.07998281283536184
Bond Position:  [12.33860026]


portfolio before change:  [4.11359593]
curr_Stock_Price:  102.84428894718047
curr_Factors:  [102.84428895]
mat_Sqrt:  [[0.15]]
grads:  [-0.00437687]
Stock Position:  -0.004376871854326609
Bond Position:  [4.5637322]


portfolio before change:  [4.11361727]
curr_Stock_Price:  102.90458365136146
curr_Factors:  [102.90458365]
mat_Sqrt:  [[0.15]]
grads:  [0.01589439]
Stock Position:  0.01589439132947983
Bond Position:  [2.47801155]


portfolio before change:  [4.11906068]
curr_Stock_Price:  103.23731286846049
curr_Factors:  [103.23731287]
mat_Sqrt:  [[0.15]]
grads:  [-0.09085782]
Stock Position:  -0.0908578176681389
Bond Position:  [13.49897763]


portfolio before change:  [4.11912225]
curr_Stock_Price:  103.24592130208046
curr_Factors:  [103.2459213]
mat_Sqrt:  [[0.15]]
grads:  [0.02922353]
Stock Position:  0.02922353496870587
Bond Position:  [1.10191145]


portfolio before change:  [4.10233328]
curr_Stock_Price:  102.6690629584235
curr_Factors:  [102.66906296]
mat_Sqrt:  [[0.15]]
grads:  [0.03044265]
Stock Position:  0.030442652817959256
Bond Position:  [0.97681464]


portfolio before change:  [4.1138189]
curr_Stock_Price:  103.04434447449508
curr_Factors:  [103.04434447]
mat_Sqrt:  [[0.15]]
grads:  [-0.05113614]
Stock Position:  -0.05113613942270285
Bond Position:  [9.38310886]


portfolio before change:  [4.09967039]
curr_Stock_Price:  103.33249614002187
curr_Factors:  [103.33249614]
mat_Sqrt:  [[0.15]]
grads:  [-0.02426479]
Stock Position:  -0.024264785005751265
Bond Position:  [6.6070112]


portfolio before change:  [4.10616374]
curr_Stock_Price:  103.08191096248716
curr_Factors:  [103.08191096]
mat_Sqrt:  [[0.15]]
grads:  [0.02290503]
Stock Position:  0.022905025032257335
Bond Position:  [1.74506999]


portfolio before change:  [4.09129018]
curr_Stock_Price:  102.42779098023509
curr_Factors:  [102.42779098]
mat_Sqrt:  [[0.15]]
grads:  [0.00642039]
Stock Position:  0.0064203861425295265
Bond Position:  [3.43366421]


portfolio before change:  [4.08993882]
curr_Stock_Price:  102.18388472520476
curr_Factors:  [102.18388473]
mat_Sqrt:  [[0.15]]
grads:  [0.01947223]
Stock Position:  0.019472225666893085
Bond Position:  [2.10019115]


portfolio before change:  [4.10302611]
curr_Stock_Price:  102.84924439638986
curr_Factors:  [102.8492444]
mat_Sqrt:  [[0.15]]
grads:  [-0.02337362]
Stock Position:  -0.02337362003907502
Bond Position:  [6.50698527]


portfolio before change:  [4.08668053]
curr_Stock_Price:  103.5659620794904
curr_Factors:  [103.56596208]
mat_Sqrt:  [[0.15]]
grads:  [0.0653297]
Stock Position:  0.06532969908723482
Bond Position:  [-2.67925261]


portfolio before change:  [4.10803366]
curr_Stock_Price:  103.89537718360111
curr_Factors:  [103.89537718]
mat_Sqrt:  [[0.15]]
grads:  [-0.07536418]
Stock Position:  -0.07536417915022946
Bond Position:  [11.93802348]


portfolio before change:  [4.10302293]
curr_Stock_Price:  103.97176457835523
curr_Factors:  [103.97176458]
mat_Sqrt:  [[0.15]]
grads:  [-0.05900111]
Stock Position:  -0.05900111483886985
Bond Position:  [10.23747296]


portfolio before change:  [4.10698727]
curr_Stock_Price:  103.91541871795306
curr_Factors:  [103.91541872]
mat_Sqrt:  [[0.15]]
grads:  [0.10837642]
Stock Position:  0.10837642494085446
Bond Position:  [-7.15499431]


portfolio before change:  [3.99961214]
curr_Stock_Price:  102.92878422123113
curr_Factors:  [102.92878422]
mat_Sqrt:  [[0.15]]
grads:  [0.0151716]
Stock Position:  0.01517160469179597
Bond Position:  [2.43801732]


portfolio before change:  [3.99648225]
curr_Stock_Price:  102.71244081577105
curr_Factors:  [102.71244082]
mat_Sqrt:  [[0.15]]
grads:  [0.07622812]
Stock Position:  0.0762281171433502
Bond Position:  [-3.83309372]


portfolio before change:  [3.97627295]
curr_Stock_Price:  102.45046765459148
curr_Factors:  [102.45046765]
mat_Sqrt:  [[0.15]]
grads:  [-0.09710141]
Stock Position:  -0.09710140541655873
Bond Position:  [13.92435735]


portfolio before change:  [4.00642758]
curr_Stock_Price:  102.14888260238767
curr_Factors:  [102.1488826]
mat_Sqrt:  [[0.15]]
grads:  [-0.08452855]
Stock Position:  -0.08452854834162545
Bond Position:  [12.64092435]


portfolio before change:  [3.98560752]
curr_Stock_Price:  102.40453758126334
curr_Factors:  [102.40453758]
mat_Sqrt:  [[0.15]]
grads:  [-0.02027198]
Stock Position:  -0.020271977052004272
Bond Position:  [6.06154996]


portfolio before change:  [3.97799252]
curr_Stock_Price:  102.79886806080059
curr_Factors:  [102.79886806]
mat_Sqrt:  [[0.15]]
grads:  [-0.10348958]
Stock Position:  -0.10348957864291536
Bond Position:  [14.61660406]


portfolio before change:  [4.02334573]
curr_Stock_Price:  102.36945630614616
curr_Factors:  [102.36945631]
mat_Sqrt:  [[0.15]]
grads:  [-0.0333953]
Stock Position:  -0.033395296501734485
Bond Position:  [7.44200408]


portfolio before change:  [4.02957483]
curr_Stock_Price:  102.19685827428758
curr_Factors:  [102.19685827]
mat_Sqrt:  [[0.15]]
grads:  [0.19580032]
Stock Position:  0.19580032078802237
Bond Position:  [-15.9806028]


portfolio before change:  [4.06415623]
curr_Stock_Price:  102.37857511656152
curr_Factors:  [102.37857512]
mat_Sqrt:  [[0.15]]
grads:  [0.01484063]
Stock Position:  0.01484062707283732
Bond Position:  [2.54479398]


portfolio before change:  [4.05221782]
curr_Stock_Price:  101.56341648674682
curr_Factors:  [101.56341649]
mat_Sqrt:  [[0.15]]
grads:  [0.04199774]
Stock Position:  0.04199773515909009
Bond Position:  [-0.21321565]


portfolio before change:  [4.05099785]
curr_Stock_Price:  101.53468542025244
curr_Factors:  [101.53468542]
mat_Sqrt:  [[0.15]]
grads:  [-0.09038973]
Stock Position:  -0.09038972869246019
Bond Position:  [13.22869052]


portfolio before change:  [4.06783869]
curr_Stock_Price:  101.35751908424413
curr_Factors:  [101.35751908]
mat_Sqrt:  [[0.15]]
grads:  [-0.05572501]
Stock Position:  -0.055725005094750216
Bond Position:  [9.71598696]


portfolio before change:  [4.07772455]
curr_Stock_Price:  101.19101224075344
curr_Factors:  [101.19101224]
mat_Sqrt:  [[0.15]]
grads:  [-0.02760398]
Stock Position:  -0.027603975400817375
Bond Position:  [6.87099877]


portfolio before change:  [4.09158836]
curr_Stock_Price:  100.70433023836752
curr_Factors:  [100.70433024]
mat_Sqrt:  [[0.15]]
grads:  [0.01492945]
Stock Position:  0.014929451226112694
Bond Position:  [2.58812797]


portfolio before change:  [4.09888078]
curr_Stock_Price:  101.18195388981385
curr_Factors:  [101.18195389]
mat_Sqrt:  [[0.15]]
grads:  [0.05660562]
Stock Position:  0.056605621755375264
Bond Position:  [-1.62858663]


portfolio before change:  [4.14204691]
curr_Stock_Price:  101.94632871926015
curr_Factors:  [101.94632872]
mat_Sqrt:  [[0.15]]
grads:  [0.01876281]
Stock Position:  0.018762807073667884
Bond Position:  [2.22924761]


portfolio before change:  [4.13911841]
curr_Stock_Price:  101.78282305252876
curr_Factors:  [101.78282305]
mat_Sqrt:  [[0.15]]
grads:  [-0.07799584]
Stock Position:  -0.07799583524266372
Bond Position:  [12.07775471]


portfolio before change:  [4.16928387]
curr_Stock_Price:  101.40574423840836
curr_Factors:  [101.40574424]
mat_Sqrt:  [[0.15]]
grads:  [0.01717292]
Stock Position:  0.017172921787679495
Bond Position:  [2.42785096]


portfolio before change:  [4.17098356]
curr_Stock_Price:  101.49588272902203
curr_Factors:  [101.49588273]
mat_Sqrt:  [[0.15]]
grads:  [-0.0413564]
Stock Position:  -0.041356402475796084
Bond Position:  [8.36848814]


portfolio before change:  [4.18382253]
curr_Stock_Price:  101.19808314255314
curr_Factors:  [101.19808314]
mat_Sqrt:  [[0.15]]
grads:  [0.07677266]
Stock Position:  0.07677265635289614
Bond Position:  [-3.58542313]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.18382253]
Stock Price:  101.1168245624523
PL:  [3.06699796]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-6.48725765e-02]
 [ 1.27367040e-03]
 [ 3.42416279e-04]
 [ 2.78857221e-03]
 [ 4.81698466e-03]
 [ 1.18302367e-02]
 [ 6.20873276e-04]
 [ 1.49761052e-02]
 [ 1.68678497e-02]
 [-2.73308458e-03]
 [ 5.93369461e-03]
 [-7.88625134e-03]
 [ 8.89841806e-04]
 [ 4.73044681e-03]
 [-1.30515834e-02]
 [ 1.49626442e-02]
 [-3.23181446e-03]
 [-3.49964592e-03]
 [ 2.76101315e-03]
 [ 1.41408931e-02]
 [-5.68514881e-03]
 [-2.11023341e-02]
 [-3.56423638e-04]
 [ 2.51557960e-03]
 [-2.69484481e-03]
 [ 8.91854233e-03]
 [ 1.39021289e-02]
 [-2.19873409e-02]
 [ 1.39475290e-03]
 [-7.62177254e-03]
 [-3.64549731e-03]
 [-1.98331418e-02]
 [ 1.87658698e-02]
 [ 1.28326175e-02]
 [-1.68608282e-02]
 [ 4.94140035e-03]
 [-2.15811394e-03]
 [ 1.10988566e-02]
 [ 2.57932570e-03]
 [-1.41523023e-02]
 [ 9.63351808e-03]
 [-2.02436568e-03]
 [ 3.24828894e-03]
 [-1.00119951e-02]
 [ 2.80642369e-03]
 [-1.28579885e-03]
 [-1.37076550e-02]
 [-3.10401613e-03]
 [-8.82400754e-03]
 [ 7.25937290e-03]
 [-3.18428276e-03]
 [ 3.25665447e-03]
 [ 3.09237586e-03]
 [-3.40241779e-04]
 [ 1.93502405e-03]
 [ 8.93750102e-03]
 [ 1.19620840e-02]
 [ 2.90040097e-03]
 [ 1.35450073e-02]
 [-1.11674931e-03]
 [-2.19900992e-03]
 [-1.95670506e-02]
 [-1.27756725e-02]
 [-1.69755074e-03]
 [-9.74523640e-03]
 [-1.41708357e-02]
 [ 9.33015336e-03]
 [ 2.09860184e-03]
 [ 1.02312578e-02]
 [-1.70679165e-02]
 [ 2.96183423e-03]
 [ 8.67708365e-05]
 [-8.43493620e-04]
 [ 7.99808435e-03]
 [-1.14885754e-04]
 [ 1.58380086e-03]
 [ 3.05028692e-03]
 [-1.18734467e-02]
 [-2.36713644e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.61533917]
curr_Stock_Price:  100.61371357060582
curr_Factors:  [100.61371357]
mat_Sqrt:  [[0.15]]
grads:  [-0.43248384]
Stock Position:  -0.43248384348647806
Bond Position:  [55.12914473]


portfolio before change:  [11.42355534]
curr_Stock_Price:  101.06512815463705
curr_Factors:  [101.06512815]
mat_Sqrt:  [[0.15]]
grads:  [0.00849114]
Stock Position:  0.008491135976963805
Bond Position:  [10.56539759]


portfolio before change:  [11.41970608]
curr_Stock_Price:  100.53403110567294
curr_Factors:  [100.53403111]
mat_Sqrt:  [[0.15]]
grads:  [0.00228278]
Stock Position:  0.0022827751905141625
Bond Position:  [11.19020949]


portfolio before change:  [11.4220061]
curr_Stock_Price:  101.23519795728117
curr_Factors:  [101.23519796]
mat_Sqrt:  [[0.15]]
grads:  [0.01859048]
Stock Position:  0.018590481387533043
Bond Position:  [9.53999503]


portfolio before change:  [11.41735907]
curr_Stock_Price:  100.95315631245981
curr_Factors:  [100.95315631]
mat_Sqrt:  [[0.15]]
grads:  [0.03211323]
Stock Position:  0.03211323109540982
Bond Position:  [8.17542704]


portfolio before change:  [11.39637337]
curr_Stock_Price:  100.28375360252235
curr_Factors:  [100.2837536]
mat_Sqrt:  [[0.15]]
grads:  [0.07886824]
Stock Position:  0.07886824472360443
Bond Position:  [3.48716975]


portfolio before change:  [11.32833465]
curr_Stock_Price:  99.41830165118934
curr_Factors:  [99.41830165]
mat_Sqrt:  [[0.15]]
grads:  [0.00413916]
Stock Position:  0.004139155172772002
Bond Position:  [10.91682687]


portfolio before change:  [11.32703535]
curr_Stock_Price:  98.9395504658207
curr_Factors:  [98.93955047]
mat_Sqrt:  [[0.15]]
grads:  [0.0998407]
Stock Position:  0.09984070120291061
Bond Position:  [1.44884125]


portfolio before change:  [11.33409709]
curr_Stock_Price:  99.0093735936374
curr_Factors:  [99.00937359]
mat_Sqrt:  [[0.15]]
grads:  [0.11245233]
Stock Position:  0.11245233126760067
Bond Position:  [0.20026221]


portfolio before change:  [11.27246894]
curr_Stock_Price:  98.46122428851947
curr_Factors:  [98.46122429]
mat_Sqrt:  [[0.15]]
grads:  [-0.01822056]
Stock Position:  -0.018220563836824057
Bond Position:  [13.06648796]


portfolio before change:  [11.26481291]
curr_Stock_Price:  98.92623250372924
curr_Factors:  [98.9262325]
mat_Sqrt:  [[0.15]]
grads:  [0.03955796]
Stock Position:  0.03955796408820325
Bond Position:  [7.35149256]


portfolio before change:  [11.2417588]
curr_Stock_Price:  98.33182385472311
curr_Factors:  [98.33182385]
mat_Sqrt:  [[0.15]]
grads:  [-0.05257501]
Stock Position:  -0.05257500891348876
Bond Position:  [16.41155531]


portfolio before change:  [11.24771536]
curr_Stock_Price:  98.23803761015215
curr_Factors:  [98.23803761]
mat_Sqrt:  [[0.15]]
grads:  [0.00593228]
Stock Position:  0.00593227870450946
Bond Position:  [10.66493995]


portfolio before change:  [11.24722041]
curr_Stock_Price:  98.04223826365006
curr_Factors:  [98.04223826]
mat_Sqrt:  [[0.15]]
grads:  [0.03153631]
Stock Position:  0.03153631207485796
Bond Position:  [8.15532978]


portfolio before change:  [11.25432633]
curr_Stock_Price:  98.2514002761352
curr_Factors:  [98.25140028]
mat_Sqrt:  [[0.15]]
grads:  [-0.08701056]
Stock Position:  -0.08701055574244634
Bond Position:  [19.80323527]


portfolio before change:  [11.25965594]
curr_Stock_Price:  98.20437302280324
curr_Factors:  [98.20437302]
mat_Sqrt:  [[0.15]]
grads:  [0.09975096]
Stock Position:  0.09975096100639079
Bond Position:  [1.46367535]


portfolio before change:  [11.21465067]
curr_Stock_Price:  97.7522796434707
curr_Factors:  [97.75227964]
mat_Sqrt:  [[0.15]]
grads:  [-0.02154543]
Stock Position:  -0.021545429738715812
Bond Position:  [13.32076554]


portfolio before change:  [11.22152155]
curr_Stock_Price:  97.47202038241758
curr_Factors:  [97.47202038]
mat_Sqrt:  [[0.15]]
grads:  [-0.02333097]
Stock Position:  -0.023330972832087578
Bond Position:  [13.49563861]


portfolio before change:  [11.21357115]
curr_Stock_Price:  97.84894000112703
curr_Factors:  [97.84894]
mat_Sqrt:  [[0.15]]
grads:  [0.01840675]
Stock Position:  0.01840675433863894
Bond Position:  [9.41248975]


portfolio before change:  [11.2145528]
curr_Stock_Price:  97.87030997633701
curr_Factors:  [97.87030998]
mat_Sqrt:  [[0.15]]
grads:  [0.09427262]
Stock Position:  0.09427262057934127
Bond Position:  [1.98806221]


portfolio before change:  [11.20499465]
curr_Stock_Price:  97.76760347820273
curr_Factors:  [97.76760348]
mat_Sqrt:  [[0.15]]
grads:  [-0.03790099]
Stock Position:  -0.03790099208810729
Bond Position:  [14.91048382]


portfolio before change:  [11.19145303]
curr_Stock_Price:  98.14948158503036
curr_Factors:  [98.14948159]
mat_Sqrt:  [[0.15]]
grads:  [-0.14068223]
Stock Position:  -0.14068222754750823
Bond Position:  [24.99934073]


portfolio before change:  [11.24479354]
curr_Stock_Price:  97.78143219343607
curr_Factors:  [97.78143219]
mat_Sqrt:  [[0.15]]
grads:  [-0.00237616]
Stock Position:  -0.002376157586708548
Bond Position:  [11.47713763]


portfolio before change:  [11.24762686]
curr_Stock_Price:  96.89093169435883
curr_Factors:  [96.89093169]
mat_Sqrt:  [[0.15]]
grads:  [0.01677053]
Stock Position:  0.016770530664290025
Bond Position:  [9.62271451]


portfolio before change:  [11.25286917]
curr_Stock_Price:  97.167659900093
curr_Factors:  [97.1676599]
mat_Sqrt:  [[0.15]]
grads:  [-0.01796563]
Stock Position:  -0.017965632097396395
Bond Position:  [12.9985476]


portfolio before change:  [11.23176059]
curr_Stock_Price:  98.38782383603976
curr_Factors:  [98.38782384]
mat_Sqrt:  [[0.15]]
grads:  [0.05945695]
Stock Position:  0.059456948842462
Bond Position:  [5.38192078]


portfolio before change:  [11.21410398]
curr_Stock_Price:  98.08520168230757
curr_Factors:  [98.08520168]
mat_Sqrt:  [[0.15]]
grads:  [0.09268086]
Stock Position:  0.0926808595868652
Bond Position:  [2.12348318]


portfolio before change:  [11.22089503]
curr_Stock_Price:  98.1570430655122
curr_Factors:  [98.15704307]
mat_Sqrt:  [[0.15]]
grads:  [-0.14658227]
Stock Position:  -0.14658227283228192
Bond Position:  [25.60897749]


portfolio before change:  [11.25253867]
curr_Stock_Price:  97.9520862769075
curr_Factors:  [97.95208628]
mat_Sqrt:  [[0.15]]
grads:  [0.00929835]
Stock Position:  0.009298352644915731
Bond Position:  [10.34174563]


portfolio before change:  [11.2557694]
curr_Stock_Price:  98.23002334984669
curr_Factors:  [98.23002335]
mat_Sqrt:  [[0.15]]
grads:  [-0.05081182]
Stock Position:  -0.05081181693321818
Bond Position:  [16.24701537]


portfolio before change:  [11.25569003]
curr_Stock_Price:  98.25157033456371
curr_Factors:  [98.25157033]
mat_Sqrt:  [[0.15]]
grads:  [-0.02430332]
Stock Position:  -0.02430331542252736
Bond Position:  [13.64352894]


portfolio before change:  [11.2377186]
curr_Stock_Price:  99.02612230365443
curr_Factors:  [99.0261223]
mat_Sqrt:  [[0.15]]
grads:  [-0.13222095]
Stock Position:  -0.13222094528146003
Bond Position:  [24.3310461]


portfolio before change:  [11.42454377]
curr_Stock_Price:  97.6246466765314
curr_Factors:  [97.62464668]
mat_Sqrt:  [[0.15]]
grads:  [0.1251058]
Stock Position:  0.12510579840530317
Bond Position:  [-0.7888656]


portfolio before change:  [11.46966592]
curr_Stock_Price:  97.98571270153518
curr_Factors:  [97.9857127]
mat_Sqrt:  [[0.15]]
grads:  [0.08555078]
Stock Position:  0.08555078328228138
Bond Position:  [3.08691145]


portfolio before change:  [11.4983763]
curr_Stock_Price:  98.31905212114732
curr_Factors:  [98.31905212]
mat_Sqrt:  [[0.15]]
grads:  [-0.11240552]
Stock Position:  -0.11240552135045745
Bond Position:  [22.54998062]


portfolio before change:  [11.41438321]
curr_Stock_Price:  99.07882358282691
curr_Factors:  [99.07882358]
mat_Sqrt:  [[0.15]]
grads:  [0.03294267]
Stock Position:  0.03294266900569576
Bond Position:  [8.15046232]


portfolio before change:  [11.43429968]
curr_Stock_Price:  99.66793933510853
curr_Factors:  [99.66793934]
mat_Sqrt:  [[0.15]]
grads:  [-0.01438743]
Stock Position:  -0.014387426282572696
Bond Position:  [12.86826481]


portfolio before change:  [11.44646551]
curr_Stock_Price:  98.87825426345672
curr_Factors:  [98.87825426]
mat_Sqrt:  [[0.15]]
grads:  [0.07399238]
Stock Position:  0.0739923770545162
Bond Position:  [4.13022843]


portfolio before change:  [11.43010084]
curr_Stock_Price:  98.65359856291592
curr_Factors:  [98.65359856]
mat_Sqrt:  [[0.15]]
grads:  [0.0171955]
Stock Position:  0.01719550468036176
Bond Position:  [9.73370243]


portfolio before change:  [11.4308284]
curr_Stock_Price:  98.66052961165973
curr_Factors:  [98.66052961]
mat_Sqrt:  [[0.15]]
grads:  [-0.09434868]
Stock Position:  -0.0943486817278274
Bond Position:  [20.73931931]


portfolio before change:  [11.41152164]
curr_Stock_Price:  98.87890055300377
curr_Factors:  [98.87890055]
mat_Sqrt:  [[0.15]]
grads:  [0.06422345]
Stock Position:  0.06422345388181608
Bond Position:  [5.06117713]


portfolio before change:  [11.41617211]
curr_Stock_Price:  98.94638580556607
curr_Factors:  [98.94638581]
mat_Sqrt:  [[0.15]]
grads:  [-0.01349577]
Stock Position:  -0.013495771195515554
Bond Position:  [12.75152989]


portfolio before change:  [11.42090327]
curr_Stock_Price:  98.65487466176424
curr_Factors:  [98.65487466]
mat_Sqrt:  [[0.15]]
grads:  [0.02165526]
Stock Position:  0.021655259622756023
Bond Position:  [9.28450635]


portfolio before change:  [11.44007327]
curr_Stock_Price:  99.51331257655823
curr_Factors:  [99.51331258]
mat_Sqrt:  [[0.15]]
grads:  [-0.06674663]
Stock Position:  -0.0667466338948831
Bond Position:  [18.08225191]


portfolio before change:  [11.43887839]
curr_Stock_Price:  99.54814655723473
curr_Factors:  [99.54814656]
mat_Sqrt:  [[0.15]]
grads:  [0.01870949]
Stock Position:  0.018709491255709945
Bond Position:  [9.57638322]


portfolio before change:  [11.44692899]
curr_Stock_Price:  99.94644966880156
curr_Factors:  [99.94644967]
mat_Sqrt:  [[0.15]]
grads:  [-0.00857199]
Stock Position:  -0.008571992318846167
Bond Position:  [12.30366918]


portfolio before change:  [11.4439961]
curr_Stock_Price:  100.37830807733953
curr_Factors:  [100.37830808]
mat_Sqrt:  [[0.15]]
grads:  [-0.09138437]
Stock Position:  -0.09138436634494272
Bond Position:  [20.61700418]


portfolio before change:  [11.54226065]
curr_Stock_Price:  99.31712057373922
curr_Factors:  [99.31712057]
mat_Sqrt:  [[0.15]]
grads:  [-0.02069344]
Stock Position:  -0.020693440896660115
Bond Position:  [13.59747362]


portfolio before change:  [11.54869564]
curr_Stock_Price:  99.04722236518823
curr_Factors:  [99.04722237]
mat_Sqrt:  [[0.15]]
grads:  [-0.05882672]
Stock Position:  -0.058826716918579096
Bond Position:  [17.37531856]


portfolio before change:  [11.59968138]
curr_Stock_Price:  98.19897263101421
curr_Factors:  [98.19897263]
mat_Sqrt:  [[0.15]]
grads:  [0.04839582]
Stock Position:  0.04839581934313684
Bond Position:  [6.84726164]


portfolio before change:  [11.60153337]
curr_Stock_Price:  98.22839714423725
curr_Factors:  [98.22839714]
mat_Sqrt:  [[0.15]]
grads:  [-0.02122855]
Stock Position:  -0.02122855174191229
Bond Position:  [13.68677998]


portfolio before change:  [11.59432666]
curr_Stock_Price:  98.6081766158954
curr_Factors:  [98.60817662]
mat_Sqrt:  [[0.15]]
grads:  [0.02171103]
Stock Position:  0.021711029767852188
Bond Position:  [9.4534416]


portfolio before change:  [11.58290196]
curr_Stock_Price:  98.05474568466965
curr_Factors:  [98.05474568]
mat_Sqrt:  [[0.15]]
grads:  [0.02061584]
Stock Position:  0.020615839083627074
Bond Position:  [9.5614211]


portfolio before change:  [11.60538235]
curr_Stock_Price:  99.1162006106758
curr_Factors:  [99.11620061]
mat_Sqrt:  [[0.15]]
grads:  [-0.00226828]
Stock Position:  -0.0022682785245163365
Bond Position:  [11.8302055]


portfolio before change:  [11.60783298]
curr_Stock_Price:  98.36178937371328
curr_Factors:  [98.36178937]
mat_Sqrt:  [[0.15]]
grads:  [0.01290016]
Stock Position:  0.01290016034583962
Bond Position:  [10.33895012]


portfolio before change:  [11.59877671]
curr_Stock_Price:  97.60966904181018
curr_Factors:  [97.60966904]
mat_Sqrt:  [[0.15]]
grads:  [0.05958334]
Stock Position:  0.05958334010836966
Bond Position:  [5.7828666]


portfolio before change:  [11.58305104]
curr_Stock_Price:  97.3396756517413
curr_Factors:  [97.33967565]
mat_Sqrt:  [[0.15]]
grads:  [0.07974723]
Stock Position:  0.07974722660499298
Bond Position:  [3.82048187]


portfolio before change:  [11.55990715]
curr_Stock_Price:  97.04646567940156
curr_Factors:  [97.04646568]
mat_Sqrt:  [[0.15]]
grads:  [0.01933601]
Stock Position:  0.019336006480276165
Bond Position:  [9.68341606]


portfolio before change:  [11.5592768]
curr_Stock_Price:  96.98256551989422
curr_Factors:  [96.98256552]
mat_Sqrt:  [[0.15]]
grads:  [0.09030005]
Stock Position:  0.09030004837618895
Bond Position:  [2.80174645]


portfolio before change:  [11.56634405]
curr_Stock_Price:  97.05889029586282
curr_Factors:  [97.0588903]
mat_Sqrt:  [[0.15]]
grads:  [-0.007445]
Stock Position:  -0.007444995427989184
Bond Position:  [12.28894704]


portfolio before change:  [11.57438834]
curr_Stock_Price:  96.08156195969234
curr_Factors:  [96.08156196]
mat_Sqrt:  [[0.15]]
grads:  [-0.01466007]
Stock Position:  -0.014660066125555475
Bond Position:  [12.98295039]


portfolio before change:  [11.56915833]
curr_Stock_Price:  96.49366577356345
curr_Factors:  [96.49366577]
mat_Sqrt:  [[0.15]]
grads:  [-0.130447]
Stock Position:  -0.13044700403611786
Bond Position:  [24.15646794]


portfolio before change:  [11.5685713]
curr_Stock_Price:  96.5097401854226
curr_Factors:  [96.50974019]
mat_Sqrt:  [[0.15]]
grads:  [-0.08517115]
Stock Position:  -0.08517115019111492
Bond Position:  [19.78841687]


portfolio before change:  [11.55776621]
curr_Stock_Price:  96.65112497007705
curr_Factors:  [96.65112497]
mat_Sqrt:  [[0.15]]
grads:  [-0.011317]
Stock Position:  -0.01131700490772356
Bond Position:  [12.65156746]


portfolio before change:  [11.55227349]
curr_Stock_Price:  97.20634853847902
curr_Factors:  [97.20634854]
mat_Sqrt:  [[0.15]]
grads:  [-0.06496824]
Stock Position:  -0.06496824265253441
Bond Position:  [17.86759912]


portfolio before change:  [11.56643347]
curr_Stock_Price:  97.00558549057317
curr_Factors:  [97.00558549]
mat_Sqrt:  [[0.15]]
grads:  [-0.09447224]
Stock Position:  -0.09447223828498112
Bond Position:  [20.73076826]


portfolio before change:  [11.60448489]
curr_Stock_Price:  96.61652190100116
curr_Factors:  [96.6165219]
mat_Sqrt:  [[0.15]]
grads:  [0.06220102]
Stock Position:  0.06220102237246834
Bond Position:  [5.59483845]


portfolio before change:  [11.63322688]
curr_Stock_Price:  97.07298230714053
curr_Factors:  [97.07298231]
mat_Sqrt:  [[0.15]]
grads:  [0.01399068]
Stock Position:  0.013990678962583152
Bond Position:  [10.27510995]


portfolio before change:  [11.64243596]
curr_Stock_Price:  97.6853087765076
curr_Factors:  [97.68530878]
mat_Sqrt:  [[0.15]]
grads:  [0.06820839]
Stock Position:  0.06820838560222668
Bond Position:  [4.97947875]


portfolio before change:  [11.68423797]
curr_Stock_Price:  98.29360330196491
curr_Factors:  [98.2936033]
mat_Sqrt:  [[0.15]]
grads:  [-0.11378611]
Stock Position:  -0.1137861098564557
Bond Position:  [22.86868472]


portfolio before change:  [11.76612743]
curr_Stock_Price:  97.58648604127154
curr_Factors:  [97.58648604]
mat_Sqrt:  [[0.15]]
grads:  [0.01974556]
Stock Position:  0.019745561502487685
Bond Position:  [9.83922747]


portfolio before change:  [11.74783895]
curr_Stock_Price:  96.62913404163828
curr_Factors:  [96.62913404]
mat_Sqrt:  [[0.15]]
grads:  [0.00057847]
Stock Position:  0.0005784722431298057
Bond Position:  [11.69194168]


portfolio before change:  [11.74882757]
curr_Stock_Price:  97.07487990569733
curr_Factors:  [97.07487991]
mat_Sqrt:  [[0.15]]
grads:  [-0.00562329]
Stock Position:  -0.0056232907999392125
Bond Position:  [12.29470785]


portfolio before change:  [11.75018664]
curr_Stock_Price:  96.96984815875123
curr_Factors:  [96.96984816]
mat_Sqrt:  [[0.15]]
grads:  [0.05332056]
Stock Position:  0.05332056233206817
Bond Position:  [6.57969981]


portfolio before change:  [11.76942279]
curr_Stock_Price:  97.32289962454956
curr_Factors:  [97.32289962]
mat_Sqrt:  [[0.15]]
grads:  [-0.00076591]
Stock Position:  -0.0007659050252333828
Bond Position:  [11.84396288]


portfolio before change:  [11.76998892]
curr_Stock_Price:  97.55025880626754
curr_Factors:  [97.55025881]
mat_Sqrt:  [[0.15]]
grads:  [0.01055867]
Stock Position:  0.010558672387334246
Bond Position:  [10.7399877]


portfolio before change:  [11.76667462]
curr_Stock_Price:  97.17278971084114
curr_Factors:  [97.17278971]
mat_Sqrt:  [[0.15]]
grads:  [0.02033525]
Stock Position:  0.020335246118423703
Bond Position:  [9.79064202]


portfolio before change:  [11.74810729]
curr_Stock_Price:  96.2296361372317
curr_Factors:  [96.22963614]
mat_Sqrt:  [[0.15]]
grads:  [-0.07915631]
Stock Position:  -0.07915631138151254
Bond Position:  [19.36529034]


portfolio before change:  [11.66439767]
curr_Stock_Price:  97.30245005356734
curr_Factors:  [97.30245005]
mat_Sqrt:  [[0.15]]
grads:  [-0.1578091]
Stock Position:  -0.15780909612327745
Bond Position:  [27.01960936]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.66439767]
Stock Price:  96.93200175885198
PL:  [11.66439767]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-5.77541709e-02]
 [-2.30649448e-03]
 [ 1.19558707e-04]
 [ 2.32361284e-03]
 [ 6.29853383e-03]
 [ 1.19265875e-02]
 [-2.07377419e-04]
 [ 8.05612888e-03]
 [-1.07893565e-02]
 [-7.98517779e-03]
 [ 9.94663880e-03]
 [-1.01162782e-02]
 [ 1.98030510e-02]
 [ 1.81852981e-02]
 [-6.49654784e-03]
 [-8.69988759e-03]
 [ 1.36956237e-02]
 [ 2.70417546e-02]
 [-5.98751895e-03]
 [-2.17423623e-03]
 [ 2.00773550e-02]
 [-9.19702070e-03]
 [-1.27909343e-02]
 [ 9.28819217e-03]
 [ 1.93778068e-02]
 [ 1.15089454e-02]
 [ 7.21382964e-03]
 [ 2.01908764e-03]
 [ 9.62102122e-03]
 [-9.01436224e-03]
 [-5.81762666e-03]
 [ 4.33904452e-02]
 [ 2.26965135e-03]
 [-9.85069769e-03]
 [-4.37801073e-03]
 [-5.29480554e-03]
 [-2.32794090e-03]
 [-2.64155208e-03]
 [ 7.07232131e-03]
 [-6.35307715e-03]
 [-5.64836386e-02]
 [-4.17442540e-03]
 [ 1.60268324e-02]
 [-1.40129869e-02]
 [-2.38594249e-03]
 [ 2.67920725e-03]
 [-1.35933720e-02]
 [ 1.46921440e-02]
 [ 2.14249314e-02]
 [-1.33500999e-02]
 [-5.04690367e-03]
 [ 3.73117167e-03]
 [ 3.46104906e-03]
 [-7.34981478e-03]
 [-1.37130125e-02]
 [ 1.32986081e-02]
 [-4.37541637e-02]
 [-1.37842451e-02]
 [ 2.45270696e-02]
 [-1.46721415e-02]
 [ 1.33630118e-02]
 [-1.31916977e-02]
 [-1.26631655e-02]
 [-2.52526258e-03]
 [ 1.02705806e-01]
 [-1.40340403e-02]
 [ 5.48189755e-03]
 [ 6.16666904e-03]
 [ 1.59622910e-02]
 [-3.03639821e-02]
 [-7.79962063e-03]
 [-5.36749934e-03]
 [ 1.26855925e-02]
 [ 5.26874541e-03]
 [-7.42047961e-04]
 [ 1.36816858e-03]
 [ 7.23339970e-03]
 [-2.77824311e-03]
 [ 2.28365583e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.91883518]
curr_Stock_Price:  100.50467813993356
curr_Factors:  [100.50467814]
mat_Sqrt:  [[0.15]]
grads:  [-0.38502781]
Stock Position:  -0.38502780605346176
Bond Position:  [48.6159309]


portfolio before change:  [10.01387059]
curr_Stock_Price:  100.26574261517236
curr_Factors:  [100.26574262]
mat_Sqrt:  [[0.15]]
grads:  [-0.01537663]
Stock Position:  -0.015376629851670728
Bond Position:  [11.5556198]


portfolio before change:  [10.01467337]
curr_Stock_Price:  100.26050531688895
curr_Factors:  [100.26050532]
mat_Sqrt:  [[0.15]]
grads:  [0.00079706]
Stock Position:  0.0007970580492838401
Bond Position:  [9.93475993]


portfolio before change:  [10.01560245]
curr_Stock_Price:  100.64709183403691
curr_Factors:  [100.64709183]
mat_Sqrt:  [[0.15]]
grads:  [0.01549075]
Stock Position:  0.015490752285109283
Bond Position:  [8.45650328]


portfolio before change:  [10.0251841]
curr_Stock_Price:  101.2315118746394
curr_Factors:  [101.23151187]
mat_Sqrt:  [[0.15]]
grads:  [0.04199023]
Stock Position:  0.04199022555867458
Bond Position:  [5.77445008]


portfolio before change:  [10.01276039]
curr_Stock_Price:  100.92704510713654
curr_Factors:  [100.92704511]
mat_Sqrt:  [[0.15]]
grads:  [0.07951058]
Stock Position:  0.07951058363175192
Bond Position:  [1.98799213]


portfolio before change:  [10.0740026]
curr_Stock_Price:  101.69572211243737
curr_Factors:  [101.69572211]
mat_Sqrt:  [[0.15]]
grads:  [-0.00138252]
Stock Position:  -0.0013825161246910714
Bond Position:  [10.21459857]


portfolio before change:  [10.07560146]
curr_Stock_Price:  101.00102472238896
curr_Factors:  [101.00102472]
mat_Sqrt:  [[0.15]]
grads:  [0.05370753]
Stock Position:  0.0537075258805442
Bond Position:  [4.65108631]


portfolio before change:  [10.13237084]
curr_Stock_Price:  102.0526218558709
curr_Factors:  [102.05262186]
mat_Sqrt:  [[0.15]]
grads:  [-0.07192904]
Stock Position:  -0.07192904359394695
Bond Position:  [17.47291833]


portfolio before change:  [10.15241987]
curr_Stock_Price:  101.78907129698214
curr_Factors:  [101.7890713]
mat_Sqrt:  [[0.15]]
grads:  [-0.05323452]
Stock Position:  -0.053234518594105974
Bond Position:  [15.57111208]


portfolio before change:  [10.13652174]
curr_Stock_Price:  102.1059964833311
curr_Factors:  [102.10599648]
mat_Sqrt:  [[0.15]]
grads:  [0.06631093]
Stock Position:  0.06631092534567626
Bond Position:  [3.36577863]


portfolio before change:  [10.13495791]
curr_Stock_Price:  102.07924071024355
curr_Factors:  [102.07924071]
mat_Sqrt:  [[0.15]]
grads:  [-0.06744185]
Stock Position:  -0.06744185490058224
Bond Position:  [17.01937125]


portfolio before change:  [10.14142748]
curr_Stock_Price:  101.99908528945309
curr_Factors:  [101.99908529]
mat_Sqrt:  [[0.15]]
grads:  [0.13202034]
Stock Position:  0.1320203400118216
Bond Position:  [-3.32452644]


portfolio before change:  [10.26743018]
curr_Stock_Price:  102.9550780335631
curr_Factors:  [102.95507803]
mat_Sqrt:  [[0.15]]
grads:  [0.12123532]
Stock Position:  0.12123532065682735
Bond Position:  [-2.21436172]


portfolio before change:  [10.24523036]
curr_Stock_Price:  102.77310617083637
curr_Factors:  [102.77310617]
mat_Sqrt:  [[0.15]]
grads:  [-0.04331032]
Stock Position:  -0.04331031893736177
Bond Position:  [14.69636637]


portfolio before change:  [10.24181889]
curr_Stock_Price:  102.87308282453351
curr_Factors:  [102.87308282]
mat_Sqrt:  [[0.15]]
grads:  [-0.05799925]
Stock Position:  -0.05799925060272288
Bond Position:  [16.2083806]


portfolio before change:  [10.21004076]
curr_Stock_Price:  103.43845537909603
curr_Factors:  [103.43845538]
mat_Sqrt:  [[0.15]]
grads:  [0.09130416]
Stock Position:  0.09130415817240423
Bond Position:  [0.76567967]


portfolio before change:  [10.14835866]
curr_Stock_Price:  102.76236395941518
curr_Factors:  [102.76236396]
mat_Sqrt:  [[0.15]]
grads:  [0.18027836]
Stock Position:  0.18027836375038908
Bond Position:  [-8.37747217]


portfolio before change:  [10.31046466]
curr_Stock_Price:  103.66446672089793
curr_Factors:  [103.66446672]
mat_Sqrt:  [[0.15]]
grads:  [-0.03991679]
Stock Position:  -0.039916792995365394
Bond Position:  [14.44841772]


portfolio before change:  [10.34481872]
curr_Stock_Price:  102.82644845992156
curr_Factors:  [102.82644846]
mat_Sqrt:  [[0.15]]
grads:  [-0.01449491]
Stock Position:  -0.014494908217255107
Bond Position:  [11.83527865]


portfolio before change:  [10.33424282]
curr_Stock_Price:  103.60711060369455
curr_Factors:  [103.6071106]
mat_Sqrt:  [[0.15]]
grads:  [0.13384903]
Stock Position:  0.1338490335126334
Bond Position:  [-3.5334688]


portfolio before change:  [10.45581739]
curr_Stock_Price:  104.51705679113013
curr_Factors:  [104.51705679]
mat_Sqrt:  [[0.15]]
grads:  [-0.06131347]
Stock Position:  -0.061313471302793986
Bond Position:  [16.86412095]


portfolio before change:  [10.40090239]
curr_Stock_Price:  105.42989104336583
curr_Factors:  [105.42989104]
mat_Sqrt:  [[0.15]]
grads:  [-0.0852729]
Stock Position:  -0.08527289518095625
Bond Position:  [19.39121444]


portfolio before change:  [10.39446219]
curr_Stock_Price:  105.51962864667877
curr_Factors:  [105.51962865]
mat_Sqrt:  [[0.15]]
grads:  [0.06192128]
Stock Position:  0.06192128111558791
Bond Position:  [3.86055161]


portfolio before change:  [10.37663606]
curr_Stock_Price:  105.22784805821388
curr_Factors:  [105.22784806]
mat_Sqrt:  [[0.15]]
grads:  [0.12918538]
Stock Position:  0.1291853786413349
Bond Position:  [-3.21726334]


portfolio before change:  [10.4066124]
curr_Stock_Price:  105.46144587867356
curr_Factors:  [105.46144588]
mat_Sqrt:  [[0.15]]
grads:  [0.0767263]
Stock Position:  0.07672630251621101
Bond Position:  [2.3149456]


portfolio before change:  [10.32691639]
curr_Stock_Price:  104.42085499188819
curr_Factors:  [104.42085499]
mat_Sqrt:  [[0.15]]
grads:  [0.0480922]
Stock Position:  0.04809219760204039
Bond Position:  [5.305088]


portfolio before change:  [10.32242681]
curr_Stock_Price:  104.32060668485204
curr_Factors:  [104.32060668]
mat_Sqrt:  [[0.15]]
grads:  [0.01346058]
Stock Position:  0.01346058424587071
Bond Position:  [8.9182105]


portfolio before change:  [10.33207884]
curr_Stock_Price:  104.99625550182299
curr_Factors:  [104.9962555]
mat_Sqrt:  [[0.15]]
grads:  [0.06414014]
Stock Position:  0.06414014145009604
Bond Position:  [3.59760416]


portfolio before change:  [10.33873522]
curr_Stock_Price:  105.0965284579527
curr_Factors:  [105.09652846]
mat_Sqrt:  [[0.15]]
grads:  [-0.06009575]
Stock Position:  -0.060095748253401415
Bond Position:  [16.65458974]


portfolio before change:  [10.33374685]
curr_Stock_Price:  105.19685698182202
curr_Factors:  [105.19685698]
mat_Sqrt:  [[0.15]]
grads:  [-0.03878418]
Stock Position:  -0.03878417773387863
Bond Position:  [14.41372045]


portfolio before change:  [10.31619811]
curr_Stock_Price:  105.67255683563738
curr_Factors:  [105.67255684]
mat_Sqrt:  [[0.15]]
grads:  [0.28926963]
Stock Position:  0.28926963466375155
Bond Position:  [-20.2516638]


portfolio before change:  [10.30265684]
curr_Stock_Price:  105.63012064828567
curr_Factors:  [105.63012065]
mat_Sqrt:  [[0.15]]
grads:  [0.01513101]
Stock Position:  0.015131008998274619
Bond Position:  [8.70436653]


portfolio before change:  [10.30141859]
curr_Stock_Price:  105.51233003277525
curr_Factors:  [105.51233003]
mat_Sqrt:  [[0.15]]
grads:  [-0.06567132]
Stock Position:  -0.06567131795271483
Bond Position:  [17.23055236]


portfolio before change:  [10.35793848]
curr_Stock_Price:  104.66808089344849
curr_Factors:  [104.66808089]
mat_Sqrt:  [[0.15]]
grads:  [-0.02918674]
Stock Position:  -0.029186738195542124
Bond Position:  [13.41285836]


portfolio before change:  [10.36055255]
curr_Stock_Price:  104.60724042800092
curr_Factors:  [104.60724043]
mat_Sqrt:  [[0.15]]
grads:  [-0.0352987]
Stock Position:  -0.03529870358656516
Bond Position:  [14.05305252]


portfolio before change:  [10.34925972]
curr_Stock_Price:  104.952045476217
curr_Factors:  [104.95204548]
mat_Sqrt:  [[0.15]]
grads:  [-0.01551961]
Stock Position:  -0.015519605971355637
Bond Position:  [11.97807411]


portfolio before change:  [10.34534515]
curr_Stock_Price:  105.25251881574519
curr_Factors:  [105.25251882]
mat_Sqrt:  [[0.15]]
grads:  [-0.01761035]
Stock Position:  -0.01761034717726417
Bond Position:  [12.19887854]


portfolio before change:  [10.33707183]
curr_Stock_Price:  105.76561346934794
curr_Factors:  [105.76561347]
mat_Sqrt:  [[0.15]]
grads:  [0.04714881]
Stock Position:  0.047148808724883855
Bond Position:  [5.35034915]


portfolio before change:  [10.32310472]
curr_Stock_Price:  105.46228626871155
curr_Factors:  [105.46228627]
mat_Sqrt:  [[0.15]]
grads:  [-0.04235385]
Stock Position:  -0.04235384764989435
Bond Position:  [14.78983832]


portfolio before change:  [10.33099091]
curr_Stock_Price:  105.2979140517673
curr_Factors:  [105.29791405]
mat_Sqrt:  [[0.15]]
grads:  [-0.37655759]
Stock Position:  -0.37655759096288705
Bond Position:  [49.98171975]


portfolio before change:  [10.56430659]
curr_Stock_Price:  104.68660855158798
curr_Factors:  [104.68660855]
mat_Sqrt:  [[0.15]]
grads:  [-0.0278295]
Stock Position:  -0.02782950266199303
Bond Position:  [13.47768284]


portfolio before change:  [10.57074649]
curr_Stock_Price:  104.48547229980926
curr_Factors:  [104.4854723]
mat_Sqrt:  [[0.15]]
grads:  [0.10684555]
Stock Position:  0.10684554902049406
Bond Position:  [-0.59306116]


portfolio before change:  [10.54507124]
curr_Stock_Price:  104.24551675752541
curr_Factors:  [104.24551676]
mat_Sqrt:  [[0.15]]
grads:  [-0.09341991]
Stock Position:  -0.0934199127384453
Bond Position:  [20.28367832]


portfolio before change:  [10.57205706]
curr_Stock_Price:  103.97022159609381
curr_Factors:  [103.9702216]
mat_Sqrt:  [[0.15]]
grads:  [-0.01590628]
Stock Position:  -0.01590628328808829
Bond Position:  [12.22583686]


portfolio before change:  [10.56516477]
curr_Stock_Price:  104.45156793818727
curr_Factors:  [104.45156794]
mat_Sqrt:  [[0.15]]
grads:  [0.01786138]
Stock Position:  0.017861381699104402
Bond Position:  [8.69951544]


portfolio before change:  [10.5636885]
curr_Stock_Price:  104.33847450999474
curr_Factors:  [104.33847451]
mat_Sqrt:  [[0.15]]
grads:  [-0.09062248]
Stock Position:  -0.09062247987090762
Bond Position:  [20.01909981]


portfolio before change:  [10.5046812]
curr_Stock_Price:  105.00341476395043
curr_Factors:  [105.00341476]
mat_Sqrt:  [[0.15]]
grads:  [0.09794763]
Stock Position:  0.09794762699228479
Bond Position:  [0.2198459]


portfolio before change:  [10.49459908]
curr_Stock_Price:  104.90034074120645
curr_Factors:  [104.90034074]
mat_Sqrt:  [[0.15]]
grads:  [0.14283288]
Stock Position:  0.1428328756709806
Bond Position:  [-4.48861824]


portfolio before change:  [10.65332633]
curr_Stock_Price:  106.01358437427294
curr_Factors:  [106.01358437]
mat_Sqrt:  [[0.15]]
grads:  [-0.08900067]
Stock Position:  -0.08900066580469809
Bond Position:  [20.08860592]


portfolio before change:  [10.55609549]
curr_Stock_Price:  107.1201650019264
curr_Factors:  [107.120165]
mat_Sqrt:  [[0.15]]
grads:  [-0.03364602]
Stock Position:  -0.03364602445318168
Bond Position:  [14.16026318]


portfolio before change:  [10.57749579]
curr_Stock_Price:  106.51042699065901
curr_Factors:  [106.51042699]
mat_Sqrt:  [[0.15]]
grads:  [0.02487448]
Stock Position:  0.02487447780289413
Bond Position:  [7.92810454]


portfolio before change:  [10.58165208]
curr_Stock_Price:  106.65759639604943
curr_Factors:  [106.6575964]
mat_Sqrt:  [[0.15]]
grads:  [0.02307366]
Stock Position:  0.023073660378321245
Bond Position:  [8.12067092]


portfolio before change:  [10.58934982]
curr_Stock_Price:  106.96921518996997
curr_Factors:  [106.96921519]
mat_Sqrt:  [[0.15]]
grads:  [-0.04899877]
Stock Position:  -0.04899876520473696
Bond Position:  [15.83070928]


portfolio before change:  [10.56476666]
curr_Stock_Price:  107.49111835740179
curr_Factors:  [107.49111836]
mat_Sqrt:  [[0.15]]
grads:  [-0.09142008]
Stock Position:  -0.09142008361613439
Bond Position:  [20.39161369]


portfolio before change:  [10.57515676]
curr_Stock_Price:  107.39140736671075
curr_Factors:  [107.39140737]
mat_Sqrt:  [[0.15]]
grads:  [0.08865739]
Stock Position:  0.08865738765589144
Bond Position:  [1.05411513]


portfolio before change:  [10.66155855]
curr_Stock_Price:  108.36522242183773
curr_Factors:  [108.36522242]
mat_Sqrt:  [[0.15]]
grads:  [-0.29169442]
Stock Position:  -0.2916944244332411
Bond Position:  [42.27108973]


portfolio before change:  [10.62793187]
curr_Stock_Price:  108.48956042110598
curr_Factors:  [108.48956042]
mat_Sqrt:  [[0.15]]
grads:  [-0.09189497]
Stock Position:  -0.09189496731238306
Bond Position:  [20.59757648]


portfolio before change:  [10.57348028]
curr_Stock_Price:  109.0961113519714
curr_Factors:  [109.09611135]
mat_Sqrt:  [[0.15]]
grads:  [0.1635138]
Stock Position:  0.16351379711223696
Bond Position:  [-7.26523913]


portfolio before change:  [10.50501306]
curr_Stock_Price:  108.68016397818572
curr_Factors:  [108.68016398]
mat_Sqrt:  [[0.15]]
grads:  [-0.09781428]
Stock Position:  -0.09781427637835395
Bond Position:  [21.13548465]


portfolio before change:  [10.51951346]
curr_Stock_Price:  108.54542503958274
curr_Factors:  [108.54542504]
mat_Sqrt:  [[0.15]]
grads:  [0.08908675]
Stock Position:  0.08908674539676667
Bond Position:  [0.84955481]


portfolio before change:  [10.45861227]
curr_Stock_Price:  107.86121228633063
curr_Factors:  [107.86121229]
mat_Sqrt:  [[0.15]]
grads:  [-0.08794465]
Stock Position:  -0.08794465145271597
Bond Position:  [19.94442899]


portfolio before change:  [10.47779916]
curr_Stock_Price:  107.65721660624777
curr_Factors:  [107.65721661]
mat_Sqrt:  [[0.15]]
grads:  [-0.0844211]
Stock Position:  -0.08442110328857325
Bond Position:  [19.56634017]


portfolio before change:  [10.49163241]
curr_Stock_Price:  107.50784262686108
curr_Factors:  [107.50784263]
mat_Sqrt:  [[0.15]]
grads:  [-0.01683508]
Stock Position:  -0.016835083855343456
Bond Position:  [12.30153596]


portfolio before change:  [10.50440696]
curr_Stock_Price:  106.7947083738776
curr_Factors:  [106.79470837]
mat_Sqrt:  [[0.15]]
grads:  [0.68470537]
Stock Position:  0.6847053748788602
Bond Position:  [-62.61850387]


portfolio before change:  [10.47008222]
curr_Stock_Price:  106.75029370345162
curr_Factors:  [106.7502937]
mat_Sqrt:  [[0.15]]
grads:  [-0.09356027]
Stock Position:  -0.09356026862660477
Bond Position:  [20.45766837]


portfolio before change:  [10.45947678]
curr_Stock_Price:  106.87731425961975
curr_Factors:  [106.87731426]
mat_Sqrt:  [[0.15]]
grads:  [0.03654598]
Stock Position:  0.03654598364496117
Bond Position:  [6.55354021]


portfolio before change:  [10.46721729]
curr_Stock_Price:  107.07790804484743
curr_Factors:  [107.07790804]
mat_Sqrt:  [[0.15]]
grads:  [0.04111113]
Stock Position:  0.04111112695893932
Bond Position:  [6.06512382]


portfolio before change:  [10.50183154]
curr_Stock_Price:  107.9106551099267
curr_Factors:  [107.91065511]
mat_Sqrt:  [[0.15]]
grads:  [0.10641527]
Stock Position:  0.1064152734515246
Bond Position:  [-0.98151033]


portfolio before change:  [10.47745882]
curr_Stock_Price:  107.68219756169762
curr_Factors:  [107.68219756]
mat_Sqrt:  [[0.15]]
grads:  [-0.20242655]
Stock Position:  -0.2024265470702541
Bond Position:  [32.27519426]


portfolio before change:  [10.60528241]
curr_Stock_Price:  107.06070632664188
curr_Factors:  [107.06070633]
mat_Sqrt:  [[0.15]]
grads:  [-0.05199747]
Stock Position:  -0.05199747087157459
Bond Position:  [16.17216837]


portfolio before change:  [10.61679048]
curr_Stock_Price:  106.85882582001952
curr_Factors:  [106.85882582]
mat_Sqrt:  [[0.15]]
grads:  [-0.03578333]
Stock Position:  -0.035783328939523476
Bond Position:  [14.44055499]


portfolio before change:  [10.62324238]
curr_Stock_Price:  106.70374419438997
curr_Factors:  [106.70374419]
mat_Sqrt:  [[0.15]]
grads:  [0.08457062]
Stock Position:  0.08457061641917382
Bond Position:  [1.59924096]


portfolio before change:  [10.59934095]
curr_Stock_Price:  106.4199412553162
curr_Factors:  [106.41994126]
mat_Sqrt:  [[0.15]]
grads:  [0.03512497]
Stock Position:  0.03512496940795108
Bond Position:  [6.86134376]


portfolio before change:  [10.56005852]
curr_Stock_Price:  105.28937015404475
curr_Factors:  [105.28937015]
mat_Sqrt:  [[0.15]]
grads:  [-0.00494699]
Stock Position:  -0.004946986406074126
Bond Position:  [11.0809236]


portfolio before change:  [10.55621656]
curr_Stock_Price:  106.205995749042
curr_Factors:  [106.20599575]
mat_Sqrt:  [[0.15]]
grads:  [0.00912112]
Stock Position:  0.00912112383505606
Bond Position:  [9.58749852]


portfolio before change:  [10.55307867]
curr_Stock_Price:  105.79627360253004
curr_Factors:  [105.7962736]
mat_Sqrt:  [[0.15]]
grads:  [0.04822266]
Stock Position:  0.04822266466300779
Bond Position:  [5.45130045]


portfolio before change:  [10.58820823]
curr_Stock_Price:  106.51769445373263
curr_Factors:  [106.51769445]
mat_Sqrt:  [[0.15]]
grads:  [-0.01852162]
Stock Position:  -0.01852162071484791
Bond Position:  [12.56108856]


portfolio before change:  [10.60977954]
curr_Stock_Price:  105.39542633760708
curr_Factors:  [105.39542634]
mat_Sqrt:  [[0.15]]
grads:  [0.15224372]
Stock Position:  0.1522437220770296
Bond Position:  [-5.43601245]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.60977954]
Stock Price:  105.0375175266136
PL:  [5.57226202]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.80525418e-02]
 [ 2.99947017e-03]
 [-9.12465192e-04]
 [ 8.43360952e-04]
 [-1.21299538e-02]
 [ 7.62101885e-03]
 [ 5.55911299e-04]
 [ 1.36877565e-02]
 [ 1.77285904e-02]
 [-1.67440164e-02]
 [ 5.92017688e-03]
 [-6.23889892e-03]
 [-7.36703839e-03]
 [ 3.81285101e-03]
 [ 3.17207785e-03]
 [-9.06324306e-03]
 [ 1.35112621e-02]
 [ 6.20539072e-03]
 [ 1.61029410e-02]
 [ 1.41081051e-02]
 [-1.35678744e-03]
 [-2.26586635e-02]
 [-6.18925898e-04]
 [ 7.38845397e-03]
 [ 9.59804096e-04]
 [ 1.52801444e-02]
 [ 1.60561894e-02]
 [-2.04282047e-02]
 [ 1.40476014e-03]
 [-3.47936060e-03]
 [-3.48975157e-03]
 [-1.98396869e-02]
 [ 1.73408669e-02]
 [ 9.68502686e-03]
 [-2.35136406e-02]
 [ 7.49148403e-03]
 [-2.51051072e-03]
 [ 2.26580084e-03]
 [ 5.25279205e-03]
 [-1.83088764e-02]
 [ 4.69234838e-02]
 [ 7.87825607e-04]
 [ 7.05075119e-03]
 [-9.24635435e-03]
 [-2.01458121e-03]
 [-1.56403111e-02]
 [-1.32083207e-02]
 [ 5.15359723e-04]
 [-2.68532060e-03]
 [-3.46608967e-03]
 [-4.19364483e-03]
 [ 2.91579660e-03]
 [ 3.71087358e-03]
 [-1.24683490e-03]
 [ 1.11844691e-02]
 [ 8.86799005e-03]
 [ 1.02337766e-02]
 [ 1.04023484e-02]
 [ 1.32093422e-02]
 [-3.44857599e-03]
 [-2.88958004e-03]
 [-2.28867011e-02]
 [-1.28093886e-02]
 [-1.64909141e-03]
 [-7.86563519e-03]
 [ 2.25505459e-03]
 [ 8.69821009e-03]
 [ 1.88249579e-03]
 [ 1.16946740e-02]
 [-1.83282224e-02]
 [ 7.90038992e-03]
 [ 2.04819204e-04]
 [-2.04247411e-03]
 [ 7.68929850e-03]
 [-3.58812582e-03]
 [ 3.03692978e-03]
 [ 8.34985804e-03]
 [-1.21291661e-02]
 [-4.49328772e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.48601791]
curr_Stock_Price:  99.51459807060465
curr_Factors:  [99.51459807]
mat_Sqrt:  [[0.15]]
grads:  [-0.25368361]
Stock Position:  -0.25368361211352963
Bond Position:  [19.75920478]


portfolio before change:  [-5.44510882]
curr_Stock_Price:  99.35820600490395
curr_Factors:  [99.358206]
mat_Sqrt:  [[0.15]]
grads:  [0.01999647]
Stock Position:  0.019996467816638518
Bond Position:  [-7.43192199]


portfolio before change:  [-5.45756347]
curr_Stock_Price:  98.75859295732066
curr_Factors:  [98.75859296]
mat_Sqrt:  [[0.15]]
grads:  [-0.0060831]
Stock Position:  -0.006083101283000063
Bond Position:  [-4.85680495]


portfolio before change:  [-5.46171577]
curr_Stock_Price:  99.3912869942164
curr_Factors:  [99.39128699]
mat_Sqrt:  [[0.15]]
grads:  [0.00562241]
Stock Position:  0.00562240634893855
Bond Position:  [-6.02053398]


portfolio before change:  [-5.46467918]
curr_Stock_Price:  98.93114316863917
curr_Factors:  [98.93114317]
mat_Sqrt:  [[0.15]]
grads:  [-0.08086636]
Stock Position:  -0.08086635886493423
Bond Position:  [2.53552214]


portfolio before change:  [-5.46246812]
curr_Stock_Price:  98.90576065984877
curr_Factors:  [98.90576066]
mat_Sqrt:  [[0.15]]
grads:  [0.05080679]
Stock Position:  0.05080679234314793
Bond Position:  [-10.48755256]


portfolio before change:  [-5.47499959]
curr_Stock_Price:  98.67201285673931
curr_Factors:  [98.67201286]
mat_Sqrt:  [[0.15]]
grads:  [0.00370608]
Stock Position:  0.0037060753253212995
Bond Position:  [-5.8406855]


portfolio before change:  [-5.4750385]
curr_Stock_Price:  98.76001581358884
curr_Factors:  [98.76001581]
mat_Sqrt:  [[0.15]]
grads:  [0.09125171]
Stock Position:  0.09125171023463392
Bond Position:  [-14.48705884]


portfolio before change:  [-5.43244079]
curr_Stock_Price:  99.23675398267035
curr_Factors:  [99.23675398]
mat_Sqrt:  [[0.15]]
grads:  [0.1181906]
Stock Position:  0.11819060286544034
Bond Position:  [-17.16129257]


portfolio before change:  [-5.46652909]
curr_Stock_Price:  98.95741129725766
curr_Factors:  [98.9574113]
mat_Sqrt:  [[0.15]]
grads:  [-0.11162678]
Stock Position:  -0.11162677583309077
Bond Position:  [5.57976768]


portfolio before change:  [-5.46346078]
curr_Stock_Price:  98.9330483041821
curr_Factors:  [98.9330483]
mat_Sqrt:  [[0.15]]
grads:  [0.03946785]
Stock Position:  0.03946784584434752
Bond Position:  [-9.36813508]


portfolio before change:  [-5.4614768]
curr_Stock_Price:  98.99815200715922
curr_Factors:  [98.99815201]
mat_Sqrt:  [[0.15]]
grads:  [-0.04159266]
Stock Position:  -0.04159265946245997
Bond Position:  [-1.34388038]


portfolio before change:  [-5.47507449]
curr_Stock_Price:  99.32305780071044
curr_Factors:  [99.3230578]
mat_Sqrt:  [[0.15]]
grads:  [-0.04911359]
Stock Position:  -0.049113589235232534
Bond Position:  [-0.59696263]


portfolio before change:  [-5.46452335]
curr_Stock_Price:  99.1074665899375
curr_Factors:  [99.10746659]
mat_Sqrt:  [[0.15]]
grads:  [0.02541901]
Stock Position:  0.025419006729110183
Bond Position:  [-7.98373671]


portfolio before change:  [-5.45086863]
curr_Stock_Price:  99.66428270109478
curr_Factors:  [99.6642827]
mat_Sqrt:  [[0.15]]
grads:  [0.02114719]
Stock Position:  0.021147185659666456
Bond Position:  [-7.55848772]


portfolio before change:  [-5.42633536]
curr_Stock_Price:  100.84674227427438
curr_Factors:  [100.84674227]
mat_Sqrt:  [[0.15]]
grads:  [-0.06042162]
Stock Position:  -0.06042162042736913
Bond Position:  [0.66698822]


portfolio before change:  [-5.40612928]
curr_Stock_Price:  100.5130142328625
curr_Factors:  [100.51301423]
mat_Sqrt:  [[0.15]]
grads:  [0.09007508]
Stock Position:  0.09007508049369338
Bond Position:  [-14.45984713]


portfolio before change:  [-5.52170045]
curr_Stock_Price:  99.23999406455853
curr_Factors:  [99.23999406]
mat_Sqrt:  [[0.15]]
grads:  [0.04136927]
Stock Position:  0.04136927148085564
Bond Position:  [-9.6271867]


portfolio before change:  [-5.54370129]
curr_Stock_Price:  98.72272301072329
curr_Factors:  [98.72272301]
mat_Sqrt:  [[0.15]]
grads:  [0.10735294]
Stock Position:  0.10735294025174999
Bond Position:  [-16.14187588]


portfolio before change:  [-5.63185229]
curr_Stock_Price:  97.91098841491434
curr_Factors:  [97.91098841]
mat_Sqrt:  [[0.15]]
grads:  [0.09405403]
Stock Position:  0.09405403421650563
Bond Position:  [-14.84077574]


portfolio before change:  [-5.63672158]
curr_Stock_Price:  97.8690793901917
curr_Factors:  [97.86907939]
mat_Sqrt:  [[0.15]]
grads:  [-0.00904525]
Stock Position:  -0.009045249621217333
Bond Position:  [-4.75147132]


portfolio before change:  [-5.63681367]
curr_Stock_Price:  97.84642812451067
curr_Factors:  [97.84642812]
mat_Sqrt:  [[0.15]]
grads:  [-0.15105776]
Stock Position:  -0.1510577565443116
Bond Position:  [9.14364825]


portfolio before change:  [-5.65774511]
curr_Stock_Price:  97.98877722864691
curr_Factors:  [97.98877723]
mat_Sqrt:  [[0.15]]
grads:  [-0.00412617]
Stock Position:  -0.004126172650780249
Bond Position:  [-5.25342649]


portfolio before change:  [-5.65703719]
curr_Stock_Price:  97.73763184154286
curr_Factors:  [97.73763184]
mat_Sqrt:  [[0.15]]
grads:  [0.04925636]
Stock Position:  0.049256359828736544
Bond Position:  [-10.47123715]


portfolio before change:  [-5.64948292]
curr_Stock_Price:  97.90428531717852
curr_Factors:  [97.90428532]
mat_Sqrt:  [[0.15]]
grads:  [0.00639869]
Stock Position:  0.006398693976635006
Bond Position:  [-6.27594248]


portfolio before change:  [-5.6518233]
curr_Stock_Price:  97.59982790261208
curr_Factors:  [97.5998279]
mat_Sqrt:  [[0.15]]
grads:  [0.10186763]
Stock Position:  0.10186762964694117
Bond Position:  [-15.59408643]


portfolio before change:  [-5.70191245]
curr_Stock_Price:  97.11768766270073
curr_Factors:  [97.11768766]
mat_Sqrt:  [[0.15]]
grads:  [0.10704126]
Stock Position:  0.10704126236690015
Bond Position:  [-16.09751233]


portfolio before change:  [-5.60883035]
curr_Stock_Price:  97.99667785193395
curr_Factors:  [97.99667785]
mat_Sqrt:  [[0.15]]
grads:  [-0.13618803]
Stock Position:  -0.1361880313293164
Bond Position:  [7.73714428]


portfolio before change:  [-5.60392605]
curr_Stock_Price:  97.96421746075448
curr_Factors:  [97.96421746]
mat_Sqrt:  [[0.15]]
grads:  [0.00936507]
Stock Position:  0.009365067596984257
Bond Position:  [-6.52136757]


portfolio before change:  [-5.60738144]
curr_Stock_Price:  97.63877488797671
curr_Factors:  [97.63877489]
mat_Sqrt:  [[0.15]]
grads:  [-0.02319574]
Stock Position:  -0.023195737358570473
Bond Position:  [-3.34257806]


portfolio before change:  [-5.60563586]
curr_Stock_Price:  97.55451387779078
curr_Factors:  [97.55451388]
mat_Sqrt:  [[0.15]]
grads:  [-0.02326501]
Stock Position:  -0.023265010485653655
Bond Position:  [-3.33602907]


portfolio before change:  [-5.60943667]
curr_Stock_Price:  97.70892162241508
curr_Factors:  [97.70892162]
mat_Sqrt:  [[0.15]]
grads:  [-0.13226458]
Stock Position:  -0.1322645790055002
Bond Position:  [7.31399271]


portfolio before change:  [-5.65878056]
curr_Stock_Price:  98.08544745649259
curr_Factors:  [98.08544746]
mat_Sqrt:  [[0.15]]
grads:  [0.11560578]
Stock Position:  0.115605779007725
Bond Position:  [-16.99802512]


portfolio before change:  [-5.7544474]
curr_Stock_Price:  97.26711092262735
curr_Factors:  [97.26711092]
mat_Sqrt:  [[0.15]]
grads:  [0.06456685]
Stock Position:  0.06456684570338544
Bond Position:  [-12.03467795]


portfolio before change:  [-5.75718682]
curr_Stock_Price:  97.23633306457758
curr_Factors:  [97.23633306]
mat_Sqrt:  [[0.15]]
grads:  [-0.1567576]
Stock Position:  -0.15675760421041943
Bond Position:  [9.48534779]


portfolio before change:  [-5.84817473]
curr_Stock_Price:  97.82055200146378
curr_Factors:  [97.820552]
mat_Sqrt:  [[0.15]]
grads:  [0.04994323]
Stock Position:  0.049943226873374616
Bond Position:  [-10.73364875]


portfolio before change:  [-5.89432114]
curr_Stock_Price:  96.91000748426636
curr_Factors:  [96.91000748]
mat_Sqrt:  [[0.15]]
grads:  [-0.01673674]
Stock Position:  -0.016736738133127146
Bond Position:  [-4.27236372]


portfolio before change:  [-5.90260425]
curr_Stock_Price:  97.38895887347418
curr_Factors:  [97.38895887]
mat_Sqrt:  [[0.15]]
grads:  [0.01510534]
Stock Position:  0.01510533891981216
Bond Position:  [-7.37369748]


portfolio before change:  [-5.90751386]
curr_Stock_Price:  97.0944442964197
curr_Factors:  [97.0944443]
mat_Sqrt:  [[0.15]]
grads:  [0.03501861]
Stock Position:  0.035018613692723466
Bond Position:  [-9.3076267]


portfolio before change:  [-5.94690729]
curr_Stock_Price:  95.98612865515884
curr_Factors:  [95.98612866]
mat_Sqrt:  [[0.15]]
grads:  [-0.12205918]
Stock Position:  -0.12205917617150092
Bond Position:  [5.7690805]


portfolio before change:  [-5.93744886]
curr_Stock_Price:  95.91159228881747
curr_Factors:  [95.91159229]
mat_Sqrt:  [[0.15]]
grads:  [0.31282323]
Stock Position:  0.31282322525655215
Bond Position:  [-35.9408225]


portfolio before change:  [-5.71521565]
curr_Stock_Price:  96.62918471583066
curr_Factors:  [96.62918472]
mat_Sqrt:  [[0.15]]
grads:  [0.00525217]
Stock Position:  0.005252170711090137
Bond Position:  [-6.22272863]


portfolio before change:  [-5.71682087]
curr_Stock_Price:  96.39760742077334
curr_Factors:  [96.39760742]
mat_Sqrt:  [[0.15]]
grads:  [0.04700501]
Stock Position:  0.04700500790256679
Bond Position:  [-10.24799117]


portfolio before change:  [-5.73176876]
curr_Stock_Price:  96.09322784110597
curr_Factors:  [96.09322784]
mat_Sqrt:  [[0.15]]
grads:  [-0.06164236]
Stock Position:  -0.06164236234096915
Bond Position:  [0.19164481]


portfolio before change:  [-5.71090369]
curr_Stock_Price:  95.75493635567038
curr_Factors:  [95.75493636]
mat_Sqrt:  [[0.15]]
grads:  [-0.01343054]
Stock Position:  -0.013430541382590207
Bond Position:  [-4.42486306]


portfolio before change:  [-5.70240377]
curr_Stock_Price:  95.10146403540082
curr_Factors:  [95.10146404]
mat_Sqrt:  [[0.15]]
grads:  [-0.10426874]
Stock Position:  -0.10426874074435553
Bond Position:  [4.21370613]


portfolio before change:  [-5.73375042]
curr_Stock_Price:  95.40462314889913
curr_Factors:  [95.40462315]
mat_Sqrt:  [[0.15]]
grads:  [-0.08805547]
Stock Position:  -0.0880554714201568
Bond Position:  [2.66714865]


portfolio before change:  [-5.79463724]
curr_Stock_Price:  96.09797610588278
curr_Factors:  [96.09797611]
mat_Sqrt:  [[0.15]]
grads:  [0.00343573]
Stock Position:  0.0034357314899719055
Bond Position:  [-6.12480408]


portfolio before change:  [-5.79438745]
curr_Stock_Price:  96.28209967440132
curr_Factors:  [96.28209967]
mat_Sqrt:  [[0.15]]
grads:  [-0.01790214]
Stock Position:  -0.017902137334931092
Bond Position:  [-4.07073208]


portfolio before change:  [-5.79418158]
curr_Stock_Price:  96.25638752131157
curr_Factors:  [96.25638752]
mat_Sqrt:  [[0.15]]
grads:  [-0.02310726]
Stock Position:  -0.02310726449608177
Bond Position:  [-3.56995977]


portfolio before change:  [-5.76786089]
curr_Stock_Price:  95.10766593200206
curr_Factors:  [95.10766593]
mat_Sqrt:  [[0.15]]
grads:  [-0.02795763]
Stock Position:  -0.027957632186508832
Bond Position:  [-3.10887575]


portfolio before change:  [-5.80465275]
curr_Stock_Price:  96.41670171794418
curr_Factors:  [96.41670172]
mat_Sqrt:  [[0.15]]
grads:  [0.01943864]
Stock Position:  0.019438643989253056
Bond Position:  [-7.67886269]


portfolio before change:  [-5.81981021]
curr_Stock_Price:  95.6616327284862
curr_Factors:  [95.66163273]
mat_Sqrt:  [[0.15]]
grads:  [0.02473916]
Stock Position:  0.024739157215422095
Bond Position:  [-8.18639838]


portfolio before change:  [-5.82867612]
curr_Stock_Price:  95.32393961661663
curr_Factors:  [95.32393962]
mat_Sqrt:  [[0.15]]
grads:  [-0.00831223]
Stock Position:  -0.008312232664738236
Bond Position:  [-5.03632135]


portfolio before change:  [-5.83049815]
curr_Stock_Price:  95.5052691204497
curr_Factors:  [95.50526912]
mat_Sqrt:  [[0.15]]
grads:  [0.07456313]
Stock Position:  0.0745631270050898
Bond Position:  [-12.95166966]


portfolio before change:  [-5.73588014]
curr_Stock_Price:  96.78509085870458
curr_Factors:  [96.78509086]
mat_Sqrt:  [[0.15]]
grads:  [0.05911993]
Stock Position:  0.059119933675062485
Bond Position:  [-11.4578083]


portfolio before change:  [-5.76980749]
curr_Stock_Price:  96.2233308810184
curr_Factors:  [96.22333088]
mat_Sqrt:  [[0.15]]
grads:  [0.06822518]
Stock Position:  0.06822517742697969
Bond Position:  [-12.33466131]


portfolio before change:  [-5.82800471]
curr_Stock_Price:  95.38161406191996
curr_Factors:  [95.38161406]
mat_Sqrt:  [[0.15]]
grads:  [0.06934899]
Stock Position:  0.06934898905270755
Bond Position:  [-12.44262322]


portfolio before change:  [-5.83541539]
curr_Stock_Price:  95.28596748519578
curr_Factors:  [95.28596749]
mat_Sqrt:  [[0.15]]
grads:  [0.08806228]
Stock Position:  0.08806228141782657
Bond Position:  [-14.22651508]


portfolio before change:  [-5.78496295]
curr_Stock_Price:  95.86898246653365
curr_Factors:  [95.86898247]
mat_Sqrt:  [[0.15]]
grads:  [-0.02299051]
Stock Position:  -0.022990506610999745
Bond Position:  [-3.58088647]


portfolio before change:  [-5.78470841]
curr_Stock_Price:  95.84817620669322
curr_Factors:  [95.84817621]
mat_Sqrt:  [[0.15]]
grads:  [-0.01926387]
Stock Position:  -0.019263866950504784
Bond Position:  [-3.9383019]


portfolio before change:  [-5.78586383]
curr_Stock_Price:  95.89537655877531
curr_Factors:  [95.89537656]
mat_Sqrt:  [[0.15]]
grads:  [-0.15257801]
Stock Position:  -0.1525780072306119
Bond Position:  [8.84566163]


portfolio before change:  [-5.81369702]
curr_Stock_Price:  96.08141948602922
curr_Factors:  [96.08141949]
mat_Sqrt:  [[0.15]]
grads:  [-0.08539592]
Stock Position:  -0.08539592399227604
Bond Position:  [2.39126458]


portfolio before change:  [-5.86752197]
curr_Stock_Price:  96.71346856164561
curr_Factors:  [96.71346856]
mat_Sqrt:  [[0.15]]
grads:  [-0.01099394]
Stock Position:  -0.010993942702832075
Bond Position:  [-4.80425964]


portfolio before change:  [-5.85784813]
curr_Stock_Price:  95.80623103536806
curr_Factors:  [95.80623104]
mat_Sqrt:  [[0.15]]
grads:  [-0.05243757]
Stock Position:  -0.05243756791698105
Bond Position:  [-0.83400238]


portfolio before change:  [-5.87447484]
curr_Stock_Price:  96.1223131956805
curr_Factors:  [96.1223132]
mat_Sqrt:  [[0.15]]
grads:  [0.0150337]
Stock Position:  0.015033697280489795
Bond Position:  [-7.31954859]


portfolio before change:  [-5.87853751]
curr_Stock_Price:  95.88250576406752
curr_Factors:  [95.88250576]
mat_Sqrt:  [[0.15]]
grads:  [0.05798807]
Stock Position:  0.05798806727526358
Bond Position:  [-11.43857871]


portfolio before change:  [-5.8484837]
curr_Stock_Price:  96.41311050110585
curr_Factors:  [96.4131105]
mat_Sqrt:  [[0.15]]
grads:  [0.01254997]
Stock Position:  0.01254997194757946
Bond Position:  [-7.05846554]


portfolio before change:  [-5.84019731]
curr_Stock_Price:  97.10853521133866
curr_Factors:  [97.10853521]
mat_Sqrt:  [[0.15]]
grads:  [0.07796449]
Stock Position:  0.07796449338694517
Bond Position:  [-13.41121506]


portfolio before change:  [-5.88523431]
curr_Stock_Price:  96.54162629770113
curr_Factors:  [96.5416263]
mat_Sqrt:  [[0.15]]
grads:  [-0.12218815]
Stock Position:  -0.12218814955546768
Bond Position:  [5.91100837]


portfolio before change:  [-5.93050391]
curr_Stock_Price:  96.91514086696775
curr_Factors:  [96.91514087]
mat_Sqrt:  [[0.15]]
grads:  [0.05266927]
Stock Position:  0.05266926614780387
Bond Position:  [-11.03495326]


portfolio before change:  [-5.94533117]
curr_Stock_Price:  96.6467196260173
curr_Factors:  [96.64671963]
mat_Sqrt:  [[0.15]]
grads:  [0.00136546]
Stock Position:  0.0013654613606426703
Bond Position:  [-6.07729853]


portfolio before change:  [-5.94619834]
curr_Stock_Price:  96.28982208442791
curr_Factors:  [96.28982208]
mat_Sqrt:  [[0.15]]
grads:  [-0.01361649]
Stock Position:  -0.01361649406792731
Bond Position:  [-4.63506855]


portfolio before change:  [-5.93766275]
curr_Stock_Price:  95.64169000285733
curr_Factors:  [95.64169]
mat_Sqrt:  [[0.15]]
grads:  [0.05126199]
Stock Position:  0.05126199002953142
Bond Position:  [-10.84044611]


portfolio before change:  [-5.92238392]
curr_Stock_Price:  95.95296125070473
curr_Factors:  [95.95296125]
mat_Sqrt:  [[0.15]]
grads:  [-0.02392084]
Stock Position:  -0.023920838820939046
Bond Position:  [-3.6271086]


portfolio before change:  [-5.9195192]
curr_Stock_Price:  95.82372563056597
curr_Factors:  [95.82372563]
mat_Sqrt:  [[0.15]]
grads:  [0.0202462]
Stock Position:  0.02024619855139331
Bond Position:  [-7.85958537]


portfolio before change:  [-5.91586225]
curr_Stock_Price:  96.02861273914945
curr_Factors:  [96.02861274]
mat_Sqrt:  [[0.15]]
grads:  [0.05566572]
Stock Position:  0.05566572025260799
Bond Position:  [-11.26136414]


portfolio before change:  [-5.91836995]
curr_Stock_Price:  95.99620777599691
curr_Factors:  [95.99620778]
mat_Sqrt:  [[0.15]]
grads:  [-0.08086111]
Stock Position:  -0.080861107632647
Bond Position:  [1.84398974]


portfolio before change:  [-5.89652674]
curr_Stock_Price:  95.72750058654775
curr_Factors:  [95.72750059]
mat_Sqrt:  [[0.15]]
grads:  [-0.29955251]
Stock Position:  -0.2995525147738222
Bond Position:  [22.77888679]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.89652674]
Stock Price:  95.54322626231156
PL:  [-5.89652674]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-7.09590871e-02]
 [-1.93470603e-03]
 [ 2.99162958e-04]
 [ 2.33138320e-03]
 [ 1.19737694e-02]
 [ 1.17894249e-02]
 [ 1.28107280e-03]
 [ 1.50837516e-02]
 [-1.62629120e-03]
 [-1.10052821e-02]
 [ 1.00764695e-02]
 [-7.54758257e-03]
 [-1.96958050e-03]
 [ 4.25467101e-03]
 [ 5.35301750e-03]
 [ 2.51945186e-03]
 [ 1.99374509e-03]
 [ 1.16062656e-02]
 [ 2.36060537e-02]
 [ 3.60963779e-03]
 [ 7.97992685e-02]
 [-1.30490063e-02]
 [ 5.33513309e-03]
 [-4.26348000e-03]
 [ 1.73035288e-02]
 [ 1.78770526e-02]
 [ 1.11830828e-02]
 [-6.70569054e-04]
 [ 4.58502284e-03]
 [-2.09762883e-02]
 [-5.20212219e-03]
 [ 1.38349766e-02]
 [ 1.48961693e-02]
 [ 1.95235673e-02]
 [-5.58444481e-03]
 [ 1.51156459e-03]
 [-2.15262011e-03]
 [ 1.14133810e-02]
 [ 1.78874337e-03]
 [-1.43503112e-02]
 [ 7.74662145e-03]
 [-1.80719869e-03]
 [ 3.84929381e-03]
 [-7.98400930e-03]
 [ 2.12771248e-03]
 [-4.32583066e-03]
 [-1.36835789e-02]
 [-8.11615115e-04]
 [-4.02788475e-03]
 [ 4.48498881e-03]
 [-3.62359854e-03]
 [ 3.05479321e-03]
 [ 3.25705431e-03]
 [ 2.35540980e-03]
 [ 4.17693051e-03]
 [ 8.92059053e-03]
 [ 1.12947143e-02]
 [-4.58820083e-03]
 [ 1.37419297e-02]
 [ 9.82846850e-04]
 [ 5.00920818e-03]
 [-1.29442120e-02]
 [-1.26352381e-02]
 [-1.11903512e-03]
 [-1.16512148e-02]
 [-8.10913433e-03]
 [ 1.08976622e-02]
 [ 2.36513539e-03]
 [ 9.69857474e-03]
 [-1.49558305e-02]
 [-5.61631598e-03]
 [-8.79892933e-04]
 [ 1.62010381e-03]
 [ 8.81900105e-03]
 [ 1.01839376e-02]
 [-1.10419461e-02]
 [ 1.48836639e-05]
 [-8.57551727e-03]
 [ 8.85230588e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.06591534]
curr_Stock_Price:  100.70694305790411
curr_Factors:  [100.70694306]
mat_Sqrt:  [[0.15]]
grads:  [-0.47306058]
Stock Position:  -0.47306058089935804
Bond Position:  [60.70640033]


portfolio before change:  [13.21558609]
curr_Stock_Price:  100.39857561821783
curr_Factors:  [100.39857562]
mat_Sqrt:  [[0.15]]
grads:  [-0.01289804]
Stock Position:  -0.012898040230450172
Bond Position:  [14.51053096]


portfolio before change:  [13.21628596]
curr_Stock_Price:  100.41462961350592
curr_Factors:  [100.41462961]
mat_Sqrt:  [[0.15]]
grads:  [0.00199442]
Stock Position:  0.001994419721828023
Bond Position:  [13.01601705]


portfolio before change:  [13.21762574]
curr_Stock_Price:  100.67849220348758
curr_Factors:  [100.6784922]
mat_Sqrt:  [[0.15]]
grads:  [0.01554255]
Stock Position:  0.015542554634620837
Bond Position:  [11.65282478]


portfolio before change:  [13.2128153]
curr_Stock_Price:  100.3221309503249
curr_Factors:  [100.32213095]
mat_Sqrt:  [[0.15]]
grads:  [0.07982513]
Stock Position:  0.07982512946604585
Bond Position:  [5.20458821]


portfolio before change:  [13.22533595]
curr_Stock_Price:  100.4749068179401
curr_Factors:  [100.47490682]
mat_Sqrt:  [[0.15]]
grads:  [0.07859617]
Stock Position:  0.07859616584503118
Bond Position:  [5.32839351]


portfolio before change:  [13.17355459]
curr_Stock_Price:  99.8118414415262
curr_Factors:  [99.81184144]
mat_Sqrt:  [[0.15]]
grads:  [0.00854049]
Stock Position:  0.008540485342149583
Bond Position:  [12.32111302]


portfolio before change:  [13.16992094]
curr_Stock_Price:  99.29620923666177
curr_Factors:  [99.29620924]
mat_Sqrt:  [[0.15]]
grads:  [0.10055834]
Stock Position:  0.10055834403560085
Bond Position:  [3.18485857]


portfolio before change:  [13.32392832]
curr_Stock_Price:  100.82575239281651
curr_Factors:  [100.82575239]
mat_Sqrt:  [[0.15]]
grads:  [-0.01084194]
Stock Position:  -0.01084194136535625
Bond Position:  [14.41707522]


portfolio before change:  [13.31611669]
curr_Stock_Price:  101.62936565473323
curr_Factors:  [101.62936565]
mat_Sqrt:  [[0.15]]
grads:  [-0.07336855]
Stock Position:  -0.07336854750719217
Bond Position:  [20.77251563]


portfolio before change:  [13.32815278]
curr_Stock_Price:  101.48301185300272
curr_Factors:  [101.48301185]
mat_Sqrt:  [[0.15]]
grads:  [0.06717646]
Stock Position:  0.06717646355631053
Bond Position:  [6.51088293]


portfolio before change:  [13.3074475]
curr_Stock_Price:  101.16873185893373
curr_Factors:  [101.16873186]
mat_Sqrt:  [[0.15]]
grads:  [-0.05031722]
Stock Position:  -0.05031721710149455
Bond Position:  [18.39797655]


portfolio before change:  [13.3394157]
curr_Stock_Price:  100.55625184960371
curr_Factors:  [100.55625185]
mat_Sqrt:  [[0.15]]
grads:  [-0.01313054]
Stock Position:  -0.013130536664996806
Bond Position:  [14.65977326]


portfolio before change:  [13.33947145]
curr_Stock_Price:  100.6217874782355
curr_Factors:  [100.62178748]
mat_Sqrt:  [[0.15]]
grads:  [0.02836447]
Stock Position:  0.028364473410533022
Bond Position:  [10.48538743]


portfolio before change:  [13.3260659]
curr_Stock_Price:  100.12606500477914
curr_Factors:  [100.126065]
mat_Sqrt:  [[0.15]]
grads:  [0.03568678]
Stock Position:  0.03568678332671762
Bond Position:  [9.75288871]


portfolio before change:  [13.31307196]
curr_Stock_Price:  99.74487295686679
curr_Factors:  [99.74487296]
mat_Sqrt:  [[0.15]]
grads:  [0.01679635]
Stock Position:  0.016796345700583495
Bond Position:  [11.63772259]


portfolio before change:  [13.31005625]
curr_Stock_Price:  99.52202152127781
curr_Factors:  [99.52202152]
mat_Sqrt:  [[0.15]]
grads:  [0.01329163]
Stock Position:  0.01329163392347251
Bond Position:  [11.98724597]


portfolio before change:  [13.32070328]
curr_Stock_Price:  100.26668599947317
curr_Factors:  [100.266686]
mat_Sqrt:  [[0.15]]
grads:  [0.0773751]
Stock Position:  0.07737510395455731
Bond Position:  [5.56255803]


portfolio before change:  [13.28978825]
curr_Stock_Price:  99.86264510956094
curr_Factors:  [99.86264511]
mat_Sqrt:  [[0.15]]
grads:  [0.15737369]
Stock Position:  0.15737369151222744
Bond Position:  [-2.42596486]


portfolio before change:  [13.35068378]
curr_Stock_Price:  100.25055724035913
curr_Factors:  [100.25055724]
mat_Sqrt:  [[0.15]]
grads:  [0.02406425]
Stock Position:  0.024064251901770386
Bond Position:  [10.93822912]


portfolio before change:  [13.35594396]
curr_Stock_Price:  100.44073609200514
curr_Factors:  [100.44073609]
mat_Sqrt:  [[0.15]]
grads:  [0.53199512]
Stock Position:  0.531995123001469
Bond Position:  [-40.0780378]


portfolio before change:  [13.88217009]
curr_Stock_Price:  101.43460063109129
curr_Factors:  [101.43460063]
mat_Sqrt:  [[0.15]]
grads:  [-0.08699338]
Stock Position:  -0.08699337532079189
Bond Position:  [22.70630837]


portfolio before change:  [13.91001907]
curr_Stock_Price:  101.13078676102015
curr_Factors:  [101.13078676]
mat_Sqrt:  [[0.15]]
grads:  [0.03556755]
Stock Position:  0.03556755395834612
Bond Position:  [10.31304435]


portfolio before change:  [13.94595209]
curr_Stock_Price:  102.12293929630127
curr_Factors:  [102.1229393]
mat_Sqrt:  [[0.15]]
grads:  [-0.0284232]
Stock Position:  -0.028423200016209224
Bond Position:  [16.84861282]


portfolio before change:  [13.94089962]
curr_Stock_Price:  102.33774765652508
curr_Factors:  [102.33774766]
mat_Sqrt:  [[0.15]]
grads:  [0.11535686]
Stock Position:  0.11535685841687439
Bond Position:  [2.13553856]


portfolio before change:  [13.88974596]
curr_Stock_Price:  101.89315216430853
curr_Factors:  [101.89315216]
mat_Sqrt:  [[0.15]]
grads:  [0.11918035]
Stock Position:  0.11918035062530317
Bond Position:  [1.74608436]


portfolio before change:  [13.88672899]
curr_Stock_Price:  101.86692212166857
curr_Factors:  [101.86692212]
mat_Sqrt:  [[0.15]]
grads:  [0.07455389]
Stock Position:  0.07455388563682296
Bond Position:  [6.29215413]


portfolio before change:  [13.83811644]
curr_Stock_Price:  101.20960125682551
curr_Factors:  [101.20960126]
mat_Sqrt:  [[0.15]]
grads:  [-0.00447046]
Stock Position:  -0.004470460362129581
Bond Position:  [14.29056995]


portfolio before change:  [13.83789205]
curr_Stock_Price:  101.45959131126651
curr_Factors:  [101.45959131]
mat_Sqrt:  [[0.15]]
grads:  [0.03056682]
Stock Position:  0.03056681893367572
Bond Position:  [10.7365951]


portfolio before change:  [13.85088596]
curr_Stock_Price:  101.86273588192323
curr_Factors:  [101.86273588]
mat_Sqrt:  [[0.15]]
grads:  [-0.13984192]
Stock Position:  -0.1398419219692661
Bond Position:  [28.09556672]


portfolio before change:  [13.94984678]
curr_Stock_Price:  101.16763103252565
curr_Factors:  [101.16763103]
mat_Sqrt:  [[0.15]]
grads:  [-0.03468081]
Stock Position:  -0.034680814573357914
Bond Position:  [17.45842264]


portfolio before change:  [13.95968036]
curr_Stock_Price:  100.91554948668211
curr_Factors:  [100.91554949]
mat_Sqrt:  [[0.15]]
grads:  [0.09223318]
Stock Position:  0.09223317729473389
Bond Position:  [4.6519186]


portfolio before change:  [13.86125288]
curr_Stock_Price:  99.84523790801684
curr_Factors:  [99.84523791]
mat_Sqrt:  [[0.15]]
grads:  [0.0993078]
Stock Position:  0.09930779533012976
Bond Position:  [3.94584243]


portfolio before change:  [13.81237358]
curr_Stock_Price:  99.35055450481823
curr_Factors:  [99.3505545]
mat_Sqrt:  [[0.15]]
grads:  [0.13015712]
Stock Position:  0.13015711515021341
Bond Position:  [0.88119202]


portfolio before change:  [13.82977382]
curr_Stock_Price:  99.48381772215026
curr_Factors:  [99.48381772]
mat_Sqrt:  [[0.15]]
grads:  [-0.03722963]
Stock Position:  -0.037229632065442574
Bond Position:  [17.53351975]


portfolio before change:  [13.81618751]
curr_Stock_Price:  99.8781859576397
curr_Factors:  [99.87818596]
mat_Sqrt:  [[0.15]]
grads:  [0.0100771]
Stock Position:  0.01007709726626664
Bond Position:  [12.80970532]


portfolio before change:  [13.81484159]
curr_Stock_Price:  99.6651730375946
curr_Factors:  [99.66517304]
mat_Sqrt:  [[0.15]]
grads:  [-0.0143508]
Stock Position:  -0.014350800707800995
Bond Position:  [15.24511663]


portfolio before change:  [13.81816068]
curr_Stock_Price:  99.50028784820117
curr_Factors:  [99.50028785]
mat_Sqrt:  [[0.15]]
grads:  [0.07608921]
Stock Position:  0.07608920634527648
Bond Position:  [6.24726274]


portfolio before change:  [13.77936185]
curr_Stock_Price:  98.9852437750277
curr_Factors:  [98.98524378]
mat_Sqrt:  [[0.15]]
grads:  [0.01192496]
Stock Position:  0.01192495578312937
Bond Position:  [12.59896719]


portfolio before change:  [13.77435007]
curr_Stock_Price:  98.4989330538551
curr_Factors:  [98.49893305]
mat_Sqrt:  [[0.15]]
grads:  [-0.09566874]
Stock Position:  -0.09566874146516641
Bond Position:  [23.19761903]


portfolio before change:  [13.73247622]
curr_Stock_Price:  98.95178473454182
curr_Factors:  [98.95178473]
mat_Sqrt:  [[0.15]]
grads:  [0.05164414]
Stock Position:  0.051644143021796485
Bond Position:  [8.6221961]


portfolio before change:  [13.72019184]
curr_Stock_Price:  98.70348397902569
curr_Factors:  [98.70348398]
mat_Sqrt:  [[0.15]]
grads:  [-0.01204799]
Stock Position:  -0.012047991235389731
Bond Position:  [14.90937055]


portfolio before change:  [13.72637786]
curr_Stock_Price:  98.2673825071449
curr_Factors:  [98.26738251]
mat_Sqrt:  [[0.15]]
grads:  [0.02566196]
Stock Position:  0.025661958733016063
Bond Position:  [11.20464434]


portfolio before change:  [13.72902508]
curr_Stock_Price:  98.34325029472275
curr_Factors:  [98.34325029]
mat_Sqrt:  [[0.15]]
grads:  [-0.05322673]
Stock Position:  -0.05322672866181384
Bond Position:  [18.96351458]


portfolio before change:  [13.70714583]
curr_Stock_Price:  98.77657605129325
curr_Factors:  [98.77657605]
mat_Sqrt:  [[0.15]]
grads:  [0.01418475]
Stock Position:  0.014184749858399737
Bond Position:  [12.3060248]


portfolio before change:  [13.69814222]
curr_Stock_Price:  98.08761364348689
curr_Factors:  [98.08761364]
mat_Sqrt:  [[0.15]]
grads:  [-0.02883887]
Stock Position:  -0.02883887104240753
Bond Position:  [16.52687826]


portfolio before change:  [13.69400172]
curr_Stock_Price:  98.2670054607634
curr_Factors:  [98.26700546]
mat_Sqrt:  [[0.15]]
grads:  [-0.09122386]
Stock Position:  -0.09122385940083756
Bond Position:  [22.65829721]


portfolio before change:  [13.75432673]
curr_Stock_Price:  97.62124440219485
curr_Factors:  [97.6212444]
mat_Sqrt:  [[0.15]]
grads:  [-0.00541077]
Stock Position:  -0.005410767433677247
Bond Position:  [14.28253258]


portfolio before change:  [13.75665805]
curr_Stock_Price:  97.35536087831474
curr_Factors:  [97.35536088]
mat_Sqrt:  [[0.15]]
grads:  [-0.02685256]
Stock Position:  -0.026852564983504124
Bond Position:  [16.3708992]


portfolio before change:  [13.75040615]
curr_Stock_Price:  97.62628873582783
curr_Factors:  [97.62628874]
mat_Sqrt:  [[0.15]]
grads:  [0.02989993]
Stock Position:  0.02989992542183642
Bond Position:  [10.8313874]


portfolio before change:  [13.73363065]
curr_Stock_Price:  97.04259220652732
curr_Factors:  [97.04259221]
mat_Sqrt:  [[0.15]]
grads:  [-0.02415732]
Stock Position:  -0.024157323597100076
Bond Position:  [16.07791996]


portfolio before change:  [13.71780497]
curr_Stock_Price:  97.73929937449506
curr_Factors:  [97.73929937]
mat_Sqrt:  [[0.15]]
grads:  [0.02036529]
Stock Position:  0.020365288054692145
Bond Position:  [11.72731599]


portfolio before change:  [13.71704266]
curr_Stock_Price:  97.66587595325349
curr_Factors:  [97.66587595]
mat_Sqrt:  [[0.15]]
grads:  [0.0217137]
Stock Position:  0.021713695389466242
Bond Position:  [11.59635558]


portfolio before change:  [13.72491003]
curr_Stock_Price:  97.99481920299142
curr_Factors:  [97.9948192]
mat_Sqrt:  [[0.15]]
grads:  [0.01570273]
Stock Position:  0.015702732014126333
Bond Position:  [12.18612365]


portfolio before change:  [13.71523053]
curr_Stock_Price:  97.32989280563666
curr_Factors:  [97.32989281]
mat_Sqrt:  [[0.15]]
grads:  [0.0278462]
Stock Position:  0.027846203414213247
Bond Position:  [11.00496254]


portfolio before change:  [13.71821429]
curr_Stock_Price:  97.41234300972013
curr_Factors:  [97.41234301]
mat_Sqrt:  [[0.15]]
grads:  [0.0594706]
Stock Position:  0.059470603556117295
Bond Position:  [7.92504345]


portfolio before change:  [13.69460151]
curr_Stock_Price:  97.0069645088879
curr_Factors:  [97.00696451]
mat_Sqrt:  [[0.15]]
grads:  [0.0752981]
Stock Position:  0.07529809555874178
Bond Position:  [6.39016183]


portfolio before change:  [13.75207735]
curr_Stock_Price:  97.76497087733476
curr_Factors:  [97.76497088]
mat_Sqrt:  [[0.15]]
grads:  [-0.03058801]
Stock Position:  -0.030588005505460654
Bond Position:  [16.74251281]


portfolio before change:  [13.74661078]
curr_Stock_Price:  97.97789758444412
curr_Factors:  [97.97789758]
mat_Sqrt:  [[0.15]]
grads:  [0.09161286]
Stock Position:  0.09161286447116002
Bond Position:  [4.77057493]


portfolio before change:  [13.73600486]
curr_Stock_Price:  97.8588739949382
curr_Factors:  [97.85887399]
mat_Sqrt:  [[0.15]]
grads:  [0.00655231]
Stock Position:  0.006552312334217869
Bond Position:  [13.09480295]


portfolio before change:  [13.74203837]
curr_Stock_Price:  98.65478486713272
curr_Factors:  [98.65478487]
mat_Sqrt:  [[0.15]]
grads:  [0.03339472]
Stock Position:  0.03339472122079011
Bond Position:  [10.44748933]


portfolio before change:  [13.76408419]
curr_Stock_Price:  99.2953902540106
curr_Factors:  [99.29539025]
mat_Sqrt:  [[0.15]]
grads:  [-0.08629475]
Stock Position:  -0.08629474699228487
Bond Position:  [22.33275477]


portfolio before change:  [13.85191337]
curr_Stock_Price:  98.2937842969084
curr_Factors:  [98.2937843]
mat_Sqrt:  [[0.15]]
grads:  [-0.08423492]
Stock Position:  -0.08423492091957675
Bond Position:  [22.13168252]


portfolio before change:  [13.8509457]
curr_Stock_Price:  98.3216936570369
curr_Factors:  [98.32169366]
mat_Sqrt:  [[0.15]]
grads:  [-0.00746023]
Stock Position:  -0.007460234126999698
Bond Position:  [14.58444855]


portfolio before change:  [13.84958621]
curr_Stock_Price:  98.62611442105356
curr_Factors:  [98.62611442]
mat_Sqrt:  [[0.15]]
grads:  [-0.07767477]
Stock Position:  -0.07767476509486351
Bond Position:  [21.51034647]


portfolio before change:  [13.8760801]
curr_Stock_Price:  98.30233537997874
curr_Factors:  [98.30233538]
mat_Sqrt:  [[0.15]]
grads:  [-0.0540609]
Stock Position:  -0.05406089555878823
Bond Position:  [19.19039239]


portfolio before change:  [13.86500687]
curr_Stock_Price:  98.5293510575658
curr_Factors:  [98.52935106]
mat_Sqrt:  [[0.15]]
grads:  [0.07265108]
Stock Position:  0.07265108107414026
Bond Position:  [6.706743]


portfolio before change:  [13.83602744]
curr_Stock_Price:  98.12469622554624
curr_Factors:  [98.12469623]
mat_Sqrt:  [[0.15]]
grads:  [0.01576757]
Stock Position:  0.01576756925824151
Bond Position:  [12.2888395]


portfolio before change:  [13.83553437]
curr_Stock_Price:  98.04471221380453
curr_Factors:  [98.04471221]
mat_Sqrt:  [[0.15]]
grads:  [0.06465716]
Stock Position:  0.06465716490378864
Bond Position:  [7.49624124]


portfolio before change:  [13.91463913]
curr_Stock_Price:  99.26091518360641
curr_Factors:  [99.26091518]
mat_Sqrt:  [[0.15]]
grads:  [-0.09970554]
Stock Position:  -0.0997055366975498
Bond Position:  [23.81150195]


portfolio before change:  [13.8900387]
curr_Stock_Price:  99.52257267535795
curr_Factors:  [99.52257268]
mat_Sqrt:  [[0.15]]
grads:  [-0.03744211]
Stock Position:  -0.037442106551630966
Bond Position:  [17.61637347]


portfolio before change:  [13.90984119]
curr_Stock_Price:  99.0230967308647
curr_Factors:  [99.02309673]
mat_Sqrt:  [[0.15]]
grads:  [-0.00586595]
Stock Position:  -0.0058659528865095956
Bond Position:  [14.49070601]


portfolio before change:  [13.90957751]
curr_Stock_Price:  99.22244638473795
curr_Factors:  [99.22244638]
mat_Sqrt:  [[0.15]]
grads:  [0.01080069]
Stock Position:  0.010800692038074773
Bond Position:  [12.83790642]


portfolio before change:  [13.91947314]
curr_Stock_Price:  100.06435925546491
curr_Factors:  [100.06435926]
mat_Sqrt:  [[0.15]]
grads:  [0.05879334]
Stock Position:  0.05879334034206314
Bond Position:  [8.03635521]


portfolio before change:  [13.94213401]
curr_Stock_Price:  100.44124845837888
curr_Factors:  [100.44124846]
mat_Sqrt:  [[0.15]]
grads:  [0.06789292]
Stock Position:  0.06789291733656394
Bond Position:  [7.12288463]


portfolio before change:  [14.01171236]
curr_Stock_Price:  101.45951601624077
curr_Factors:  [101.45951602]
mat_Sqrt:  [[0.15]]
grads:  [-0.07361297]
Stock Position:  -0.07361297411202374
Bond Position:  [21.48044908]


portfolio before change:  [14.06912859]
curr_Stock_Price:  100.69777982190821
curr_Factors:  [100.69777982]
mat_Sqrt:  [[0.15]]
grads:  [9.92244259e-05]
Stock Position:  9.922442588426728e-05
Bond Position:  [14.05913691]


portfolio before change:  [14.06995038]
curr_Stock_Price:  100.12397890022231
curr_Factors:  [100.1239789]
mat_Sqrt:  [[0.15]]
grads:  [-0.05717012]
Stock Position:  -0.05717011512757967
Bond Position:  [19.79404978]


portfolio before change:  [14.03137659]
curr_Stock_Price:  100.82033857078191
curr_Factors:  [100.82033857]
mat_Sqrt:  [[0.15]]
grads:  [0.05901537]
Stock Position:  0.05901537254420356
Bond Position:  [8.08142675]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.03137659]
Stock Price:  101.02361816981087
PL:  [13.00775842]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-5.84630284e-02]
 [-1.65056159e-03]
 [ 1.07024729e-04]
 [ 2.31446123e-03]
 [ 6.25452958e-03]
 [ 1.22127952e-02]
 [ 5.43815173e-04]
 [ 1.00297795e-02]
 [-3.17867773e-03]
 [-1.47509735e-02]
 [ 9.94546468e-03]
 [-1.21416124e-02]
 [ 3.73875953e-02]
 [ 3.21544599e-02]
 [-1.19201833e-02]
 [-6.06091279e-03]
 [ 1.84100084e-02]
 [ 1.75872143e-02]
 [-1.19160274e-02]
 [-5.13152477e-03]
 [-1.36454657e-02]
 [-8.97265399e-03]
 [ 4.75125861e-04]
 [ 4.53588042e-03]
 [ 1.88238941e-02]
 [ 1.36352797e-02]
 [ 6.24536330e-03]
 [ 5.72413301e-03]
 [ 1.08610963e-02]
 [-8.95636873e-03]
 [-5.81851479e-03]
 [ 4.28822412e-02]
 [ 3.86309993e-03]
 [-5.47594407e-03]
 [-5.93159845e-03]
 [-3.81547461e-03]
 [-4.45838968e-03]
 [-1.49056756e-03]
 [ 5.37699482e-03]
 [-7.10905978e-03]
 [-4.55852467e-02]
 [-4.18365385e-03]
 [ 1.70769882e-02]
 [-1.75418665e-02]
 [-8.30971491e-03]
 [ 2.99862135e-03]
 [-1.35609662e-02]
 [ 1.73016379e-02]
 [ 2.85579224e-02]
 [-1.18056044e-02]
 [-4.04268101e-03]
 [ 3.54891103e-03]
 [ 3.23244017e-03]
 [-5.55427192e-05]
 [-6.13617205e-03]
 [ 9.78547829e-03]
 [-4.93150081e-03]
 [-1.22627778e-02]
 [ 1.51161834e-02]
 [-9.30531365e-04]
 [ 1.25614844e-02]
 [-1.49793088e-02]
 [-1.27552417e-02]
 [-3.26111658e-03]
 [ 1.30251415e-02]
 [-1.68777445e-02]
 [ 2.08961544e-02]
 [ 4.25402513e-03]
 [ 1.12737251e-02]
 [-2.21662223e-02]
 [-7.83210039e-03]
 [-7.36677809e-03]
 [ 5.53986666e-03]
 [ 6.56447285e-03]
 [-1.52183000e-03]
 [ 6.79410420e-05]
 [ 7.21144951e-03]
 [-2.85442324e-03]
 [ 2.21443799e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.08777464]
curr_Stock_Price:  100.51553599047085
curr_Factors:  [100.51553599]
mat_Sqrt:  [[0.15]]
grads:  [-0.38975352]
Stock Position:  -0.3897535228077608
Bond Position:  [49.26405889]


portfolio before change:  [10.11345064]
curr_Stock_Price:  100.45755857688337
curr_Factors:  [100.45755858]
mat_Sqrt:  [[0.15]]
grads:  [-0.01100374]
Stock Position:  -0.011003743962762302
Bond Position:  [11.2188599]


portfolio before change:  [10.11720092]
curr_Stock_Price:  100.18046407685229
curr_Factors:  [100.18046408]
mat_Sqrt:  [[0.15]]
grads:  [0.0007135]
Stock Position:  0.0007134981932760062
Bond Position:  [10.04572234]


portfolio before change:  [10.11813535]
curr_Stock_Price:  100.61010970557942
curr_Factors:  [100.61010971]
mat_Sqrt:  [[0.15]]
grads:  [0.01542974]
Stock Position:  0.015429741501556316
Bond Position:  [8.56574736]


portfolio before change:  [10.13129247]
curr_Stock_Price:  101.42812406976194
curr_Factors:  [101.42812407]
mat_Sqrt:  [[0.15]]
grads:  [0.04169686]
Stock Position:  0.04169686389895839
Bond Position:  [5.90205779]


portfolio before change:  [10.15010665]
curr_Stock_Price:  101.87049028257131
curr_Factors:  [101.87049028]
mat_Sqrt:  [[0.15]]
grads:  [0.08141863]
Stock Position:  0.08141863492894884
Bond Position:  [1.85595039]


portfolio before change:  [10.07679433]
curr_Stock_Price:  100.96862897627517
curr_Factors:  [100.96862898]
mat_Sqrt:  [[0.15]]
grads:  [0.00362543]
Stock Position:  0.0036254344897224747
Bond Position:  [9.71073918]


portfolio before change:  [10.07585723]
curr_Stock_Price:  100.5427378809921
curr_Factors:  [100.54273788]
mat_Sqrt:  [[0.15]]
grads:  [0.0668652]
Stock Position:  0.06686519673818937
Bond Position:  [3.35304728]


portfolio before change:  [10.10540937]
curr_Stock_Price:  100.98156951248664
curr_Factors:  [100.98156951]
mat_Sqrt:  [[0.15]]
grads:  [-0.02119118]
Stock Position:  -0.021191184837349514
Bond Position:  [12.24532847]


portfolio before change:  [10.09508686]
curr_Stock_Price:  101.50479943286803
curr_Factors:  [101.50479943]
mat_Sqrt:  [[0.15]]
grads:  [-0.09833982]
Stock Position:  -0.09833982335570461
Bond Position:  [20.07705091]


portfolio before change:  [10.03666606]
curr_Stock_Price:  102.11163042311186
curr_Factors:  [102.11163042]
mat_Sqrt:  [[0.15]]
grads:  [0.0663031]
Stock Position:  0.0663030978810498
Bond Position:  [3.26634864]


portfolio before change:  [10.08175226]
curr_Stock_Price:  102.78855270876447
curr_Factors:  [102.78855271]
mat_Sqrt:  [[0.15]]
grads:  [-0.08094408]
Stock Position:  -0.08094408252572993
Bond Position:  [18.40187736]


portfolio before change:  [10.03321658]
curr_Stock_Price:  103.40238187799777
curr_Factors:  [103.40238188]
mat_Sqrt:  [[0.15]]
grads:  [0.24925064]
Stock Position:  0.2492506355050765
Bond Position:  [-15.73989282]


portfolio before change:  [10.21135701]
curr_Stock_Price:  104.121032850535
curr_Factors:  [104.12103285]
mat_Sqrt:  [[0.15]]
grads:  [0.21436307]
Stock Position:  0.2143630662926729
Bond Position:  [-12.10834685]


portfolio before change:  [10.12667106]
curr_Stock_Price:  103.72950477952314
curr_Factors:  [103.72950478]
mat_Sqrt:  [[0.15]]
grads:  [-0.07946789]
Stock Position:  -0.07946788866253522
Bond Position:  [18.3698358]


portfolio before change:  [10.09647239]
curr_Stock_Price:  104.12396377283643
curr_Factors:  [104.12396377]
mat_Sqrt:  [[0.15]]
grads:  [-0.04040609]
Stock Position:  -0.040406085285692256
Bond Position:  [14.30371415]


portfolio before change:  [10.08736226]
curr_Stock_Price:  104.37155359734693
curr_Factors:  [104.3715536]
mat_Sqrt:  [[0.15]]
grads:  [0.12273339]
Stock Position:  0.12273338952062493
Bond Position:  [-2.72251228]


portfolio before change:  [10.11605425]
curr_Stock_Price:  104.60671492893698
curr_Factors:  [104.60671493]
mat_Sqrt:  [[0.15]]
grads:  [0.1172481]
Stock Position:  0.11724809565670352
Bond Position:  [-2.14888387]


portfolio before change:  [10.04777681]
curr_Stock_Price:  104.02552742012075
curr_Factors:  [104.02552742]
mat_Sqrt:  [[0.15]]
grads:  [-0.07944018]
Stock Position:  -0.07944018297534015
Bond Position:  [18.31158374]


portfolio before change:  [9.99453013]
curr_Stock_Price:  104.71020853740877
curr_Factors:  [104.71020854]
mat_Sqrt:  [[0.15]]
grads:  [-0.03421017]
Stock Position:  -0.03421016514893517
Bond Position:  [13.57668365]


portfolio before change:  [9.98295839]
curr_Stock_Price:  105.07326735190784
curr_Factors:  [105.07326735]
mat_Sqrt:  [[0.15]]
grads:  [-0.09096977]
Stock Position:  -0.09096977124112986
Bond Position:  [19.54144949]


portfolio before change:  [10.02007208]
curr_Stock_Price:  104.67871534178697
curr_Factors:  [104.67871534]
mat_Sqrt:  [[0.15]]
grads:  [-0.05981769]
Stock Position:  -0.05981769326985294
Bond Position:  [16.28171136]


portfolio before change:  [10.09146755]
curr_Stock_Price:  103.50217653241121
curr_Factors:  [103.50217653]
mat_Sqrt:  [[0.15]]
grads:  [0.00316751]
Stock Position:  0.003167505737640628
Bond Position:  [9.76362382]


portfolio before change:  [10.09481984]
curr_Stock_Price:  104.36785424377877
curr_Factors:  [104.36785424]
mat_Sqrt:  [[0.15]]
grads:  [0.0302392]
Stock Position:  0.030239202777685645
Bond Position:  [6.93881913]


portfolio before change:  [10.10331958]
curr_Stock_Price:  104.63459574801622
curr_Factors:  [104.63459575]
mat_Sqrt:  [[0.15]]
grads:  [0.12549263]
Stock Position:  0.1254926275283415
Bond Position:  [-3.02755077]


portfolio before change:  [10.12285407]
curr_Stock_Price:  104.79176611388036
curr_Factors:  [104.79176611]
mat_Sqrt:  [[0.15]]
grads:  [0.09090186]
Stock Position:  0.09090186452540198
Bond Position:  [0.59708715]


portfolio before change:  [10.14581941]
curr_Stock_Price:  105.04399438342514
curr_Factors:  [105.04399438]
mat_Sqrt:  [[0.15]]
grads:  [0.04163576]
Stock Position:  0.04163575531520102
Bond Position:  [5.77223337]


portfolio before change:  [10.13912347]
curr_Stock_Price:  104.87450729754076
curr_Factors:  [104.8745073]
mat_Sqrt:  [[0.15]]
grads:  [0.03816089]
Stock Position:  0.03816088672718934
Bond Position:  [6.13701927]


portfolio before change:  [10.18068958]
curr_Stock_Price:  105.95368929766484
curr_Factors:  [105.9536893]
mat_Sqrt:  [[0.15]]
grads:  [0.07240731]
Stock Position:  0.07240730896444966
Bond Position:  [2.50886807]


portfolio before change:  [10.12654151]
curr_Stock_Price:  105.20369756721436
curr_Factors:  [105.20369757]
mat_Sqrt:  [[0.15]]
grads:  [-0.05970912]
Stock Position:  -0.05970912484273744
Bond Position:  [16.40816222]


portfolio before change:  [10.12685831]
curr_Stock_Price:  105.21556742706582
curr_Factors:  [105.21556743]
mat_Sqrt:  [[0.15]]
grads:  [-0.0387901]
Stock Position:  -0.03879009857554526
Bond Position:  [14.20818055]


portfolio before change:  [10.15314952]
curr_Stock_Price:  104.56067942119842
curr_Factors:  [104.56067942]
mat_Sqrt:  [[0.15]]
grads:  [0.28588161]
Stock Position:  0.2858816082563621
Bond Position:  [-19.73882567]


portfolio before change:  [10.13337538]
curr_Stock_Price:  104.49582592314516
curr_Factors:  [104.49582592]
mat_Sqrt:  [[0.15]]
grads:  [0.025754]
Stock Position:  0.025753999516669915
Bond Position:  [7.44218993]


portfolio before change:  [10.1063095]
curr_Stock_Price:  103.4268254560332
curr_Factors:  [103.42682546]
mat_Sqrt:  [[0.15]]
grads:  [-0.03650629]
Stock Position:  -0.0365062937789543
Bond Position:  [13.88203957]


portfolio before change:  [10.11879881]
curr_Stock_Price:  103.1084787300707
curr_Factors:  [103.10847873]
mat_Sqrt:  [[0.15]]
grads:  [-0.03954399]
Stock Position:  -0.039543989647171984
Bond Position:  [14.19611943]


portfolio before change:  [10.13116234]
curr_Stock_Price:  102.81826415134893
curr_Factors:  [102.81826415]
mat_Sqrt:  [[0.15]]
grads:  [-0.0254365]
Stock Position:  -0.02543649738050281
Bond Position:  [12.74649885]


portfolio before change:  [10.109097]
curr_Stock_Price:  103.7170522212809
curr_Factors:  [103.71705222]
mat_Sqrt:  [[0.15]]
grads:  [-0.0297226]
Stock Position:  -0.02972259784001659
Bond Position:  [13.19183723]


portfolio before change:  [10.0736289]
curr_Stock_Price:  104.93809682535536
curr_Factors:  [104.93809683]
mat_Sqrt:  [[0.15]]
grads:  [-0.00993712]
Stock Position:  -0.009937117039879156
Bond Position:  [11.11641105]


portfolio before change:  [10.07676935]
curr_Stock_Price:  104.69198368962206
curr_Factors:  [104.69198369]
mat_Sqrt:  [[0.15]]
grads:  [0.03584663]
Stock Position:  0.035846632155327254
Bond Position:  [6.32391432]


portfolio before change:  [10.0632999]
curr_Stock_Price:  104.30520525864652
curr_Factors:  [104.30520526]
mat_Sqrt:  [[0.15]]
grads:  [-0.04739373]
Stock Position:  -0.04739373186667882
Bond Position:  [15.00671283]


portfolio before change:  [10.08521777]
curr_Stock_Price:  103.86253251664385
curr_Factors:  [103.86253252]
mat_Sqrt:  [[0.15]]
grads:  [-0.30390164]
Stock Position:  -0.3039016446800091
Bond Position:  [41.64921222]


portfolio before change:  [9.83239258]
curr_Stock_Price:  104.70302925095416
curr_Factors:  [104.70302925]
mat_Sqrt:  [[0.15]]
grads:  [-0.02789103]
Stock Position:  -0.0278910256965033
Bond Position:  [12.75266746]


portfolio before change:  [9.82507098]
curr_Stock_Price:  104.99411449111618
curr_Factors:  [104.99411449]
mat_Sqrt:  [[0.15]]
grads:  [0.11384659]
Stock Position:  0.11384658778172213
Bond Position:  [-2.12815069]


portfolio before change:  [9.99064033]
curr_Stock_Price:  106.44960261990897
curr_Factors:  [106.44960262]
mat_Sqrt:  [[0.15]]
grads:  [-0.11694578]
Stock Position:  -0.11694577644614619
Bond Position:  [22.43947176]


portfolio before change:  [10.00580376]
curr_Stock_Price:  106.33193337364727
curr_Factors:  [106.33193337]
mat_Sqrt:  [[0.15]]
grads:  [-0.0553981]
Stock Position:  -0.05539809939861084
Bond Position:  [15.89639077]


portfolio before change:  [10.04783094]
curr_Stock_Price:  105.5912287245795
curr_Factors:  [105.59122872]
mat_Sqrt:  [[0.15]]
grads:  [0.01999081]
Stock Position:  0.01999080903264275
Bond Position:  [7.93697686]


portfolio before change:  [10.04879802]
curr_Stock_Price:  105.6147894938998
curr_Factors:  [105.61478949]
mat_Sqrt:  [[0.15]]
grads:  [-0.09040644]
Stock Position:  -0.09040644162602399
Bond Position:  [19.59705532]


portfolio before change:  [10.06532392]
curr_Stock_Price:  105.44554222079299
curr_Factors:  [105.44554222]
mat_Sqrt:  [[0.15]]
grads:  [0.11534425]
Stock Position:  0.11534425283645583
Bond Position:  [-2.09721336]


portfolio before change:  [10.08809819]
curr_Stock_Price:  105.64412473953877
curr_Factors:  [105.64412474]
mat_Sqrt:  [[0.15]]
grads:  [0.19038615]
Stock Position:  0.19038614923585642
Bond Position:  [-10.02507991]


portfolio before change:  [9.89317589]
curr_Stock_Price:  104.62358983184315
curr_Factors:  [104.62358983]
mat_Sqrt:  [[0.15]]
grads:  [-0.07870403]
Stock Position:  -0.07870402947962502
Bond Position:  [18.12747399]


portfolio before change:  [9.91244707]
curr_Stock_Price:  104.3931292181478
curr_Factors:  [104.39312922]
mat_Sqrt:  [[0.15]]
grads:  [-0.02695121]
Stock Position:  -0.026951206729946896
Bond Position:  [12.72596788]


portfolio before change:  [9.89394461]
curr_Stock_Price:  105.10915874095211
curr_Factors:  [105.10915874]
mat_Sqrt:  [[0.15]]
grads:  [0.02365941]
Stock Position:  0.023659406838085914
Bond Position:  [7.40712426]


portfolio before change:  [9.90004673]
curr_Stock_Price:  105.34750613930863
curr_Factors:  [105.34750614]
mat_Sqrt:  [[0.15]]
grads:  [0.0215496]
Stock Position:  0.021549601145213253
Bond Position:  [7.62984999]


portfolio before change:  [9.87668409]
curr_Stock_Price:  104.24124337467853
curr_Factors:  [104.24124337]
mat_Sqrt:  [[0.15]]
grads:  [-0.00037028]
Stock Position:  -0.0003702847947894874
Bond Position:  [9.91528304]


portfolio before change:  [9.87752812]
curr_Stock_Price:  103.63548241849315
curr_Factors:  [103.63548242]
mat_Sqrt:  [[0.15]]
grads:  [-0.04090781]
Stock Position:  -0.04090781364970545
Bond Position:  [14.11702912]


portfolio before change:  [9.88181519]
curr_Stock_Price:  103.5522531634007
curr_Factors:  [103.55225316]
mat_Sqrt:  [[0.15]]
grads:  [0.06523652]
Stock Position:  0.06523652194923259
Bond Position:  [3.12642635]


portfolio before change:  [9.86583812]
curr_Stock_Price:  103.30434788078789
curr_Factors:  [103.30434788]
mat_Sqrt:  [[0.15]]
grads:  [-0.03287667]
Stock Position:  -0.03287667205531051
Bond Position:  [13.26214128]


portfolio before change:  [9.87631613]
curr_Stock_Price:  103.01085399517301
curr_Factors:  [103.010854]
mat_Sqrt:  [[0.15]]
grads:  [-0.08175185]
Stock Position:  -0.08175185183177709
Bond Position:  [18.2976442]


portfolio before change:  [9.86190278]
curr_Stock_Price:  103.20114918671169
curr_Factors:  [103.20114919]
mat_Sqrt:  [[0.15]]
grads:  [0.10077456]
Stock Position:  0.10077455628025657
Bond Position:  [-0.53814724]


portfolio before change:  [9.9452313]
curr_Stock_Price:  104.0283635166249
curr_Factors:  [104.02836352]
mat_Sqrt:  [[0.15]]
grads:  [-0.00620354]
Stock Position:  -0.006203542432477906
Bond Position:  [10.59057567]


portfolio before change:  [9.94833647]
curr_Stock_Price:  103.63451879394857
curr_Factors:  [103.63451879]
mat_Sqrt:  [[0.15]]
grads:  [0.08374323]
Stock Position:  0.08374322930446382
Bond Position:  [1.2696472]


portfolio before change:  [9.9670483]
curr_Stock_Price:  103.85701409486383
curr_Factors:  [103.85701409]
mat_Sqrt:  [[0.15]]
grads:  [-0.09986206]
Stock Position:  -0.09986205891595827
Bond Position:  [20.33842356]


portfolio before change:  [9.97818061]
curr_Stock_Price:  103.75826671124487
curr_Factors:  [103.75826671]
mat_Sqrt:  [[0.15]]
grads:  [-0.08503494]
Stock Position:  -0.08503494462601631
Bond Position:  [18.80125907]


portfolio before change:  [10.01104104]
curr_Stock_Price:  103.3856514150644
curr_Factors:  [103.38565142]
mat_Sqrt:  [[0.15]]
grads:  [-0.02174078]
Stock Position:  -0.02174077718433703
Bond Position:  [12.25872545]


portfolio before change:  [10.00280412]
curr_Stock_Price:  103.7997635590882
curr_Factors:  [103.79976356]
mat_Sqrt:  [[0.15]]
grads:  [0.08683428]
Stock Position:  0.08683427668575827
Bond Position:  [0.98942673]


portfolio before change:  [10.08464489]
curr_Stock_Price:  104.74154525090869
curr_Factors:  [104.74154525]
mat_Sqrt:  [[0.15]]
grads:  [-0.1125183]
Stock Position:  -0.1125182968654298
Bond Position:  [21.86998517]


portfolio before change:  [10.17577588]
curr_Stock_Price:  103.94377208794452
curr_Factors:  [103.94377209]
mat_Sqrt:  [[0.15]]
grads:  [0.1393077]
Stock Position:  0.13930769607245075
Bond Position:  [-4.30439153]


portfolio before change:  [10.25451494]
curr_Stock_Price:  104.51092016829169
curr_Factors:  [104.51092017]
mat_Sqrt:  [[0.15]]
grads:  [0.02836017]
Stock Position:  0.028360167550960533
Bond Position:  [7.29056774]


portfolio before change:  [10.25802594]
curr_Stock_Price:  104.61865283074239
curr_Factors:  [104.61865283]
mat_Sqrt:  [[0.15]]
grads:  [0.07515817]
Stock Position:  0.07515816719304566
Bond Position:  [2.39507973]


portfolio before change:  [10.24099565]
curr_Stock_Price:  104.39006849199075
curr_Factors:  [104.39006849]
mat_Sqrt:  [[0.15]]
grads:  [-0.14777482]
Stock Position:  -0.14777481527560463
Bond Position:  [25.66721874]


portfolio before change:  [10.32211064]
curr_Stock_Price:  103.85201515731637
curr_Factors:  [103.85201516]
mat_Sqrt:  [[0.15]]
grads:  [-0.052214]
Stock Position:  -0.05221400261300385
Bond Position:  [15.74464003]


portfolio before change:  [10.33746608]
curr_Stock_Price:  103.57677532050798
curr_Factors:  [103.57677532]
mat_Sqrt:  [[0.15]]
grads:  [-0.04911185]
Stock Position:  -0.04911185396050054
Bond Position:  [15.42431354]


portfolio before change:  [10.32396465]
curr_Stock_Price:  103.87131686745198
curr_Factors:  [103.87131687]
mat_Sqrt:  [[0.15]]
grads:  [0.03693244]
Stock Position:  0.036932444416882544
Bond Position:  [6.48774301]


portfolio before change:  [10.35952251]
curr_Stock_Price:  104.82311854843061
curr_Factors:  [104.82311855]
mat_Sqrt:  [[0.15]]
grads:  [0.04376315]
Stock Position:  0.043763152340071
Bond Position:  [5.7721324]


portfolio before change:  [10.43868475]
curr_Stock_Price:  106.62375363909645
curr_Factors:  [106.62375364]
mat_Sqrt:  [[0.15]]
grads:  [-0.01014553]
Stock Position:  -0.010145533336407848
Bond Position:  [11.52043959]


portfolio before change:  [10.44797835]
curr_Stock_Price:  105.77869686797104
curr_Factors:  [105.77869687]
mat_Sqrt:  [[0.15]]
grads:  [0.00045294]
Stock Position:  0.00045294027985699455
Bond Position:  [10.40006691]


portfolio before change:  [10.44864586]
curr_Stock_Price:  105.81730329794544
curr_Factors:  [105.8173033]
mat_Sqrt:  [[0.15]]
grads:  [0.04807633]
Stock Position:  0.048076330098307855
Bond Position:  [5.36133825]


portfolio before change:  [10.47524088]
curr_Stock_Price:  106.36351659450237
curr_Factors:  [106.36351659]
mat_Sqrt:  [[0.15]]
grads:  [-0.01902949]
Stock Position:  -0.019029488286323136
Bond Position:  [12.49928418]


portfolio before change:  [10.48575516]
curr_Stock_Price:  105.85204492213549
curr_Factors:  [105.85204492]
mat_Sqrt:  [[0.15]]
grads:  [0.1476292]
Stock Position:  0.14762919926248685
Bond Position:  [-5.14109748]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.48575516]
Stock Price:  106.19208383514845
PL:  [4.29367132]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-6.15179861e-02]
 [-2.17871481e-04]
 [ 1.31840918e-03]
 [ 2.98224856e-03]
 [ 5.03638244e-03]
 [ 1.22472794e-02]
 [-9.84934056e-04]
 [ 1.49652861e-02]
 [-1.65239226e-02]
 [ 5.47817653e-02]
 [ 9.79211003e-03]
 [-1.73771898e-02]
 [ 4.59427055e-02]
 [ 3.88931691e-02]
 [-1.76691313e-02]
 [-2.43913461e-03]
 [ 2.60145225e-02]
 [ 8.71511691e-03]
 [-5.87430267e-02]
 [-8.17423510e-03]
 [-6.89302050e-02]
 [-4.55308317e-03]
 [-3.33156956e-02]
 [ 2.22833595e-02]
 [ 2.50231745e-02]
 [-1.18578528e-03]
 [-1.00387031e-03]
 [ 3.54690145e-02]
 [ 1.60115013e-02]
 [-6.92941584e-03]
 [-6.02334286e-03]
 [ 2.90638220e-02]
 [ 5.11906252e-04]
 [-2.00195263e-02]
 [ 1.41458147e-02]
 [-1.30376376e-02]
 [ 8.83192150e-03]
 [-2.75593637e-02]
 [ 1.62799408e-02]
 [ 1.95755638e-03]
 [-8.23395715e-02]
 [-7.22641900e-03]
 [ 2.74767730e-02]
 [-2.16572691e-02]
 [-1.35447186e-02]
 [ 3.44523115e-03]
 [-1.35196976e-02]
 [ 2.80436205e-02]
 [ 5.08842051e-02]
 [-1.59058137e-02]
 [-5.15738350e-03]
 [ 3.73599751e-03]
 [ 3.42935216e-03]
 [-7.44597832e-03]
 [-1.18130068e-02]
 [ 1.31080084e-02]
 [-4.49868955e-02]
 [-1.38158601e-02]
 [ 2.36407986e-02]
 [-1.63259013e-02]
 [ 1.34996591e-02]
 [-1.22308539e-02]
 [-1.25975947e-02]
 [-2.22815502e-03]
 [ 1.83796021e-01]
 [-8.93024688e-03]
 [-2.73768862e-03]
 [ 7.95850594e-03]
 [ 1.97093507e-02]
 [-3.96095897e-02]
 [-8.25721324e-03]
 [-1.75423910e-03]
 [ 3.02077404e-02]
 [-1.60339204e-03]
 [-6.19533201e-03]
 [ 1.60729736e-02]
 [-1.11139675e-02]
 [ 1.74384121e-03]
 [ 4.24461031e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.81585171]
curr_Stock_Price:  100.56232998413354
curr_Factors:  [100.56232998]
mat_Sqrt:  [[0.15]]
grads:  [-0.41011991]
Stock Position:  -0.4101199073967424
Bond Position:  [52.05846517]


portfolio before change:  [10.74010502]
curr_Stock_Price:  100.75495768020016
curr_Factors:  [100.75495768]
mat_Sqrt:  [[0.15]]
grads:  [-0.00145248]
Stock Position:  -0.001452476542943649
Bond Position:  [10.88644923]


portfolio before change:  [10.74066891]
curr_Stock_Price:  100.83518725805791
curr_Factors:  [100.83518726]
mat_Sqrt:  [[0.15]]
grads:  [0.00878939]
Stock Position:  0.008789394506409833
Bond Position:  [9.85438867]


portfolio before change:  [10.74659021]
curr_Stock_Price:  101.43879952351081
curr_Factors:  [101.43879952]
mat_Sqrt:  [[0.15]]
grads:  [0.01988166]
Stock Position:  0.019881657097240865
Bond Position:  [8.72981878]


portfolio before change:  [10.73824231]
curr_Stock_Price:  100.99147607493133
curr_Factors:  [100.99147607]
mat_Sqrt:  [[0.15]]
grads:  [0.03357588]
Stock Position:  0.033575882912816116
Bond Position:  [7.34736434]


portfolio before change:  [10.77203187]
curr_Stock_Price:  101.98416269283777
curr_Factors:  [101.98416269]
mat_Sqrt:  [[0.15]]
grads:  [0.08164853]
Stock Position:  0.08164852935791186
Bond Position:  [2.44517496]


portfolio before change:  [10.84153157]
curr_Stock_Price:  102.83349674712937
curr_Factors:  [102.83349675]
mat_Sqrt:  [[0.15]]
grads:  [-0.00656623]
Stock Position:  -0.006566227037563843
Bond Position:  [11.51675966]


portfolio before change:  [10.84483175]
curr_Stock_Price:  102.44052299127316
curr_Factors:  [102.44052299]
mat_Sqrt:  [[0.15]]
grads:  [0.09976857]
Stock Position:  0.0997685742568562
Bond Position:  [0.62448682]


portfolio before change:  [10.88668633]
curr_Stock_Price:  102.85964847987762
curr_Factors:  [102.85964848]
mat_Sqrt:  [[0.15]]
grads:  [-0.11015948]
Stock Position:  -0.1101594840711001
Bond Position:  [22.21765214]


portfolio before change:  [10.79722155]
curr_Stock_Price:  103.68439297418891
curr_Factors:  [103.68439297]
mat_Sqrt:  [[0.15]]
grads:  [0.36521177]
Stock Position:  0.36521176855664933
Bond Position:  [-27.06953898]


portfolio before change:  [10.82387193]
curr_Stock_Price:  103.76199803869164
curr_Factors:  [103.76199804]
mat_Sqrt:  [[0.15]]
grads:  [0.06528073]
Stock Position:  0.0652807335435075
Bond Position:  [4.05021259]


portfolio before change:  [10.86528361]
curr_Stock_Price:  104.39248312454413
curr_Factors:  [104.39248312]
mat_Sqrt:  [[0.15]]
grads:  [-0.11584793]
Stock Position:  -0.11584793209341512
Bond Position:  [22.9589369]


portfolio before change:  [10.90232782]
curr_Stock_Price:  104.08510397487352
curr_Factors:  [104.08510397]
mat_Sqrt:  [[0.15]]
grads:  [0.3062847]
Stock Position:  0.30628470357725973
Bond Position:  [-20.97734739]


portfolio before change:  [11.08225305]
curr_Stock_Price:  104.67682907352767
curr_Factors:  [104.67682907]
mat_Sqrt:  [[0.15]]
grads:  [0.25928779]
Stock Position:  0.25928779416119774
Bond Position:  [-16.05917106]


portfolio before change:  [11.39906014]
curr_Stock_Price:  105.90253592266923
curr_Factors:  [105.90253592]
mat_Sqrt:  [[0.15]]
grads:  [-0.11779421]
Stock Position:  -0.11779420834614691
Bond Position:  [23.87376552]


portfolio before change:  [11.40441929]
curr_Stock_Price:  105.86970751573061
curr_Factors:  [105.86970752]
mat_Sqrt:  [[0.15]]
grads:  [-0.0162609]
Stock Position:  -0.01626089738819355
Bond Position:  [13.12595575]


portfolio before change:  [11.40512627]
curr_Stock_Price:  105.87668289382331
curr_Factors:  [105.87668289]
mat_Sqrt:  [[0.15]]
grads:  [0.17343015]
Stock Position:  0.17343014999307996
Bond Position:  [-6.95708273]


portfolio before change:  [11.44762677]
curr_Stock_Price:  106.1242484688375
curr_Factors:  [106.12424847]
mat_Sqrt:  [[0.15]]
grads:  [0.05810078]
Stock Position:  0.058100779411648505
Bond Position:  [5.28172522]


portfolio before change:  [11.49171595]
curr_Stock_Price:  106.8774064554135
curr_Factors:  [106.87740646]
mat_Sqrt:  [[0.15]]
grads:  [-0.39162018]
Stock Position:  -0.3916201780016902
Bond Position:  [53.3470649]


portfolio before change:  [11.5847411]
curr_Stock_Price:  106.648381345546
curr_Factors:  [106.64838135]
mat_Sqrt:  [[0.15]]
grads:  [-0.0544949]
Stock Position:  -0.05449490063467298
Bond Position:  [17.39653405]


portfolio before change:  [11.54068029]
curr_Stock_Price:  107.47686503236535
curr_Factors:  [107.47686503]
mat_Sqrt:  [[0.15]]
grads:  [-0.4595347]
Stock Position:  -0.4595347001192262
Bond Position:  [60.93002923]


portfolio before change:  [11.33687464]
curr_Stock_Price:  107.92865657789051
curr_Factors:  [107.92865658]
mat_Sqrt:  [[0.15]]
grads:  [-0.03035389]
Stock Position:  -0.030353887770229866
Bond Position:  [14.61292897]


portfolio before change:  [11.30568638]
curr_Stock_Price:  108.98623424195885
curr_Factors:  [108.98623424]
mat_Sqrt:  [[0.15]]
grads:  [-0.22210464]
Stock Position:  -0.22210463706534703
Bond Position:  [35.51203438]


portfolio before change:  [11.31037756]
curr_Stock_Price:  108.97510613583222
curr_Factors:  [108.97510614]
mat_Sqrt:  [[0.15]]
grads:  [0.14855573]
Stock Position:  0.14855572977328135
Bond Position:  [-4.87849886]


portfolio before change:  [11.40936182]
curr_Stock_Price:  109.64346927804948
curr_Factors:  [109.64346928]
mat_Sqrt:  [[0.15]]
grads:  [0.16682116]
Stock Position:  0.1668211635036269
Bond Position:  [-6.8814893]


portfolio before change:  [11.37825779]
curr_Stock_Price:  109.45959623334848
curr_Factors:  [109.45959623]
mat_Sqrt:  [[0.15]]
grads:  [-0.00790524]
Stock Position:  -0.007905235204304872
Bond Position:  [12.24356165]


portfolio before change:  [11.37705649]
curr_Stock_Price:  109.70836197018394
curr_Factors:  [109.70836197]
mat_Sqrt:  [[0.15]]
grads:  [-0.00669247]
Stock Position:  -0.006692468734692802
Bond Position:  [12.11127627]


portfolio before change:  [11.38142031]
curr_Stock_Price:  109.16942215908266
curr_Factors:  [109.16942216]
mat_Sqrt:  [[0.15]]
grads:  [0.2364601]
Stock Position:  0.23646009661570916
Bond Position:  [-14.43279181]


portfolio before change:  [11.46100427]
curr_Stock_Price:  109.509801140507
curr_Factors:  [109.50980114]
mat_Sqrt:  [[0.15]]
grads:  [0.10674334]
Stock Position:  0.10674334199716166
Bond Position:  [-0.22843788]


portfolio before change:  [11.40117145]
curr_Stock_Price:  108.9494051367671
curr_Factors:  [108.94940514]
mat_Sqrt:  [[0.15]]
grads:  [-0.04619611]
Stock Position:  -0.04619610559803369
Bond Position:  [16.43420968]


portfolio before change:  [11.37534289]
curr_Stock_Price:  109.53074716942274
curr_Factors:  [109.53074717]
mat_Sqrt:  [[0.15]]
grads:  [-0.04015562]
Stock Position:  -0.040155619047382324
Bond Position:  [15.77361784]


portfolio before change:  [11.36008781]
curr_Stock_Price:  109.93519757931226
curr_Factors:  [109.93519758]
mat_Sqrt:  [[0.15]]
grads:  [0.19375881]
Stock Position:  0.19375881310671372
Bond Position:  [-9.94082559]


portfolio before change:  [11.37571937]
curr_Stock_Price:  110.01907959781023
curr_Factors:  [110.0190796]
mat_Sqrt:  [[0.15]]
grads:  [0.00341271]
Stock Position:  0.0034127083486936694
Bond Position:  [11.00025634]


portfolio before change:  [11.3775702]
curr_Stock_Price:  110.35994900033839
curr_Factors:  [110.359949]
mat_Sqrt:  [[0.15]]
grads:  [-0.13346351]
Stock Position:  -0.13346350884544445
Bond Position:  [26.10659623]


portfolio before change:  [11.36335001]
curr_Stock_Price:  110.47872226814012
curr_Factors:  [110.47872227]
mat_Sqrt:  [[0.15]]
grads:  [0.09430543]
Stock Position:  0.0943054314707146
Bond Position:  [0.94460644]


portfolio before change:  [11.52949093]
curr_Stock_Price:  112.23982846678648
curr_Factors:  [112.23982847]
mat_Sqrt:  [[0.15]]
grads:  [-0.08691758]
Stock Position:  -0.08691758404943617
Bond Position:  [21.28510566]


portfolio before change:  [11.60196828]
curr_Stock_Price:  111.4212715420124
curr_Factors:  [111.42127154]
mat_Sqrt:  [[0.15]]
grads:  [0.05887948]
Stock Position:  0.05887947664855281
Bond Position:  [5.04154213]


portfolio before change:  [11.63986082]
curr_Stock_Price:  112.05948084561682
curr_Factors:  [112.05948085]
mat_Sqrt:  [[0.15]]
grads:  [-0.18372909]
Stock Position:  -0.18372909137479962
Bond Position:  [32.22844742]


portfolio before change:  [11.67712037]
curr_Stock_Price:  111.86764834726043
curr_Factors:  [111.86764835]
mat_Sqrt:  [[0.15]]
grads:  [0.10853294]
Stock Position:  0.10853293882723157
Bond Position:  [-0.46420426]


portfolio before change:  [11.55475382]
curr_Stock_Price:  110.74045565290167
curr_Factors:  [110.74045565]
mat_Sqrt:  [[0.15]]
grads:  [0.01305038]
Stock Position:  0.013050375841206335
Bond Position:  [10.10954925]


portfolio before change:  [11.54209432]
curr_Stock_Price:  109.72198948361218
curr_Factors:  [109.72198948]
mat_Sqrt:  [[0.15]]
grads:  [-0.54893048]
Stock Position:  -0.548930476555603
Bond Position:  [71.7718383]


portfolio before change:  [11.37948493]
curr_Stock_Price:  110.02639100013204
curr_Factors:  [110.026391]
mat_Sqrt:  [[0.15]]
grads:  [-0.04817613]
Stock Position:  -0.04817612666593413
Bond Position:  [16.68013028]


portfolio before change:  [11.38029374]
curr_Stock_Price:  110.03124257918394
curr_Factors:  [110.03124258]
mat_Sqrt:  [[0.15]]
grads:  [0.18317849]
Stock Position:  0.18317848669325631
Bond Position:  [-8.77506276]


portfolio before change:  [11.18475842]
curr_Stock_Price:  108.96677881849628
curr_Factors:  [108.96677882]
mat_Sqrt:  [[0.15]]
grads:  [-0.14438179]
Stock Position:  -0.14438179388088887
Bond Position:  [26.91757742]


portfolio before change:  [11.26552372]
curr_Stock_Price:  108.41904426204486
curr_Factors:  [108.41904426]
mat_Sqrt:  [[0.15]]
grads:  [-0.09029812]
Stock Position:  -0.09029812411384107
Bond Position:  [21.05556004]


portfolio before change:  [11.37829688]
curr_Stock_Price:  107.1847202698679
curr_Factors:  [107.18472027]
mat_Sqrt:  [[0.15]]
grads:  [0.02296821]
Stock Position:  0.022968207652315515
Bond Position:  [8.91645597]


portfolio before change:  [11.36655858]
curr_Stock_Price:  106.64938944308071
curr_Factors:  [106.64938944]
mat_Sqrt:  [[0.15]]
grads:  [-0.09013132]
Stock Position:  -0.09013131762114726
Bond Position:  [20.97900858]


portfolio before change:  [11.31233354]
curr_Stock_Price:  107.2655600632039
curr_Factors:  [107.26556006]
mat_Sqrt:  [[0.15]]
grads:  [0.18695747]
Stock Position:  0.18695746966820953
Bond Position:  [-8.74176415]


portfolio before change:  [11.43557868]
curr_Stock_Price:  107.92769737005513
curr_Factors:  [107.92769737]
mat_Sqrt:  [[0.15]]
grads:  [0.33922803]
Stock Position:  0.33922803420105674
Bond Position:  [-25.17652193]


portfolio before change:  [11.4653671]
curr_Stock_Price:  108.02014847067397
curr_Factors:  [108.02014847]
mat_Sqrt:  [[0.15]]
grads:  [-0.10603876]
Stock Position:  -0.10603875829575997
Bond Position:  [22.91968952]


portfolio before change:  [11.53025232]
curr_Stock_Price:  107.42175701219799
curr_Factors:  [107.42175701]
mat_Sqrt:  [[0.15]]
grads:  [-0.03438256]
Stock Position:  -0.03438255668598233
Bond Position:  [15.22368697]


portfolio before change:  [11.56139575]
curr_Stock_Price:  106.54363967206852
curr_Factors:  [106.54363967]
mat_Sqrt:  [[0.15]]
grads:  [0.02490665]
Stock Position:  0.02490665006024707
Bond Position:  [8.9077506]


portfolio before change:  [11.55547906]
curr_Stock_Price:  106.28373168051458
curr_Factors:  [106.28373168]
mat_Sqrt:  [[0.15]]
grads:  [0.02286235]
Stock Position:  0.022862347708009316
Bond Position:  [9.12558343]


portfolio before change:  [11.57276465]
curr_Stock_Price:  107.01485620257401
curr_Factors:  [107.0148562]
mat_Sqrt:  [[0.15]]
grads:  [-0.04963986]
Stock Position:  -0.04963985546768917
Bond Position:  [16.88496665]


portfolio before change:  [11.60097944]
curr_Stock_Price:  106.46772628054231
curr_Factors:  [106.46772628]
mat_Sqrt:  [[0.15]]
grads:  [-0.07875338]
Stock Position:  -0.07875337838252659
Bond Position:  [19.98567258]


portfolio before change:  [11.55042677]
curr_Stock_Price:  107.1254989232321
curr_Factors:  [107.12549892]
mat_Sqrt:  [[0.15]]
grads:  [0.08738672]
Stock Position:  0.08738672254270412
Bond Position:  [2.18908052]


portfolio before change:  [11.67668337]
curr_Stock_Price:  108.56873625205782
curr_Factors:  [108.56873625]
mat_Sqrt:  [[0.15]]
grads:  [-0.29991264]
Stock Position:  -0.29991263687644787
Bond Position:  [44.23781934]


portfolio before change:  [11.69950982]
curr_Stock_Price:  108.50184510072934
curr_Factors:  [108.5018451]
mat_Sqrt:  [[0.15]]
grads:  [-0.09210573]
Stock Position:  -0.0921057336954229
Bond Position:  [21.69315187]


portfolio before change:  [11.69726365]
curr_Stock_Price:  108.54095279523439
curr_Factors:  [108.5409528]
mat_Sqrt:  [[0.15]]
grads:  [0.15760532]
Stock Position:  0.15760532384054732
Bond Position:  [-5.40936837]


portfolio before change:  [11.82548015]
curr_Stock_Price:  109.35662700820042
curr_Factors:  [109.35662701]
mat_Sqrt:  [[0.15]]
grads:  [-0.10883934]
Stock Position:  -0.10883934223025554
Bond Position:  [23.7277835]


portfolio before change:  [11.74951081]
curr_Stock_Price:  110.06824810945652
curr_Factors:  [110.06824811]
mat_Sqrt:  [[0.15]]
grads:  [0.08999773]
Stock Position:  0.08999772734660366
Bond Position:  [1.84361862]


portfolio before change:  [11.7446966]
curr_Stock_Price:  110.01347520586076
curr_Factors:  [110.01347521]
mat_Sqrt:  [[0.15]]
grads:  [-0.08153903]
Stock Position:  -0.08153902591831347
Bond Position:  [20.71508821]


portfolio before change:  [11.7492344]
curr_Stock_Price:  109.97370208389367
curr_Factors:  [109.97370208]
mat_Sqrt:  [[0.15]]
grads:  [-0.08398396]
Stock Position:  -0.08398396438472204
Bond Position:  [20.98526187]


portfolio before change:  [11.80064776]
curr_Stock_Price:  109.37713887590138
curr_Factors:  [109.37713888]
mat_Sqrt:  [[0.15]]
grads:  [-0.01485437]
Stock Position:  -0.01485436681227516
Bond Position:  [13.4253759]


portfolio before change:  [11.79615382]
curr_Stock_Price:  109.73616141902964
curr_Factors:  [109.73616142]
mat_Sqrt:  [[0.15]]
grads:  [1.22530681]
Stock Position:  1.2253068080038287
Bond Position:  [-122.66431185]


portfolio before change:  [11.12473516]
curr_Stock_Price:  109.19445880388687
curr_Factors:  [109.1944588]
mat_Sqrt:  [[0.15]]
grads:  [-0.05953498]
Stock Position:  -0.059534979182955805
Bond Position:  [17.62562499]


portfolio before change:  [11.10930783]
curr_Stock_Price:  109.47209334323595
curr_Factors:  [109.47209334]
mat_Sqrt:  [[0.15]]
grads:  [-0.01825126]
Stock Position:  -0.018251257433851444
Bond Position:  [13.10731118]


portfolio before change:  [11.10847952]
curr_Stock_Price:  109.56236306241945
curr_Factors:  [109.56236306]
mat_Sqrt:  [[0.15]]
grads:  [0.05305671]
Stock Position:  0.05305670628366388
Bond Position:  [5.29546141]


portfolio before change:  [11.16076525]
curr_Stock_Price:  110.54159365515349
curr_Factors:  [110.54159366]
mat_Sqrt:  [[0.15]]
grads:  [0.13139567]
Stock Position:  0.13139567100096317
Bond Position:  [-3.36392162]


portfolio before change:  [11.27270607]
curr_Stock_Price:  111.39513066790795
curr_Factors:  [111.39513067]
mat_Sqrt:  [[0.15]]
grads:  [-0.26406393]
Stock Position:  -0.26406393126617494
Bond Position:  [40.68814219]


portfolio before change:  [11.14562616]
curr_Stock_Price:  111.8860079755479
curr_Factors:  [111.88600798]
mat_Sqrt:  [[0.15]]
grads:  [-0.05504809]
Stock Position:  -0.055048088295518924
Bond Position:  [17.30473701]


portfolio before change:  [11.0969218]
curr_Stock_Price:  112.79041618070154
curr_Factors:  [112.79041618]
mat_Sqrt:  [[0.15]]
grads:  [-0.01169493]
Stock Position:  -0.01169492732952307
Bond Position:  [12.41599752]


portfolio before change:  [11.09170971]
curr_Stock_Price:  113.3024425953228
curr_Factors:  [113.3024426]
mat_Sqrt:  [[0.15]]
grads:  [0.20138494]
Stock Position:  0.20138493576309657
Bond Position:  [-11.72569541]


portfolio before change:  [11.15900558]
curr_Stock_Price:  113.64024712061487
curr_Factors:  [113.64024712]
mat_Sqrt:  [[0.15]]
grads:  [-0.01068928]
Stock Position:  -0.010689280236228435
Bond Position:  [12.37373802]


portfolio before change:  [11.15949528]
curr_Stock_Price:  113.6667857683812
curr_Factors:  [113.66678577]
mat_Sqrt:  [[0.15]]
grads:  [-0.04130221]
Stock Position:  -0.04130221341296124
Bond Position:  [15.85418512]


portfolio before change:  [11.18438402]
curr_Stock_Price:  113.08817690717018
curr_Factors:  [113.08817691]
mat_Sqrt:  [[0.15]]
grads:  [0.10715316]
Stock Position:  0.10715315750243415
Bond Position:  [-0.93337121]


portfolio before change:  [11.27448632]
curr_Stock_Price:  113.92959523193852
curr_Factors:  [113.92959523]
mat_Sqrt:  [[0.15]]
grads:  [-0.07409312]
Stock Position:  -0.07409311679564391
Bond Position:  [19.71588512]


portfolio before change:  [11.32720385]
curr_Stock_Price:  113.2347229447804
curr_Factors:  [113.23472294]
mat_Sqrt:  [[0.15]]
grads:  [0.01162561]
Stock Position:  0.011625608033801235
Bond Position:  [10.01078135]


portfolio before change:  [11.32766941]
curr_Stock_Price:  113.220948379817
curr_Factors:  [113.22094838]
mat_Sqrt:  [[0.15]]
grads:  [0.28297402]
Stock Position:  0.28297402099511837
Bond Position:  [-20.71091762]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.32766941]
Stock Price:  113.34723801609958
PL:  [-2.01956861]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-8.93833043e-02]
 [-1.74052722e-04]
 [ 3.43157167e-04]
 [ 2.64833943e-03]
 [ 6.28218430e-03]
 [ 1.20750191e-02]
 [-9.01562220e-04]
 [ 1.02466040e-02]
 [-1.16031011e-02]
 [ 2.20038332e-02]
 [ 9.91214335e-03]
 [-1.03547749e-02]
 [ 2.45469041e-02]
 [ 1.48099755e-02]
 [-1.03249358e-02]
 [-8.28641596e-03]
 [ 8.89240591e-03]
 [ 2.69821880e-02]
 [ 9.81459805e-03]
 [-1.80717051e-03]
 [ 2.50304064e-02]
 [-1.21037671e-02]
 [ 8.31281507e-03]
 [-4.43922956e-03]
 [ 1.79094985e-02]
 [ 1.72458385e-02]
 [ 9.72122177e-03]
 [ 3.67500480e-03]
 [ 5.68977647e-03]
 [-1.41049309e-02]
 [-5.70922709e-03]
 [ 3.75627099e-02]
 [ 5.75832181e-03]
 [-4.48100602e-03]
 [-6.13526529e-03]
 [-4.54230031e-03]
 [-2.99493910e-03]
 [-1.59858520e-03]
 [ 5.46654794e-03]
 [-6.37533615e-03]
 [-5.68307008e-02]
 [-4.51786395e-03]
 [ 1.79580978e-02]
 [-1.62023874e-02]
 [-7.14040016e-03]
 [ 2.99112505e-03]
 [-1.35602612e-02]
 [ 1.78330438e-02]
 [ 3.06754290e-02]
 [-1.39051826e-02]
 [-4.59646220e-03]
 [ 3.76041551e-03]
 [ 3.44889597e-03]
 [-5.03410571e-03]
 [-1.10116329e-02]
 [ 1.22113865e-02]
 [-2.66346790e-02]
 [-9.92097497e-03]
 [ 1.85109761e-02]
 [-3.23593472e-03]
 [ 1.30546981e-02]
 [-1.46032055e-02]
 [-1.27516534e-02]
 [-3.26794281e-03]
 [ 1.91451949e-02]
 [-1.74992140e-02]
 [ 1.84009008e-02]
 [ 4.98183065e-03]
 [ 1.25290381e-02]
 [-2.68214280e-02]
 [-7.96203572e-03]
 [-6.19639810e-03]
 [ 1.08219924e-02]
 [ 5.23210934e-03]
 [-7.61305501e-04]
 [-3.59026918e-03]
 [ 8.45702663e-03]
 [-3.80673215e-03]
 [ 2.48820503e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.96988777]
curr_Stock_Price:  101.02212460046212
curr_Factors:  [101.0221246]
mat_Sqrt:  [[0.15]]
grads:  [-0.5958887]
Stock Position:  -0.5958886950673487
Bond Position:  [78.16782977]


portfolio before change:  [18.12855499]
curr_Stock_Price:  100.76405361780942
curr_Factors:  [100.76405362]
mat_Sqrt:  [[0.15]]
grads:  [-0.00116035]
Stock Position:  -0.0011603514774307113
Bond Position:  [18.24547671]


portfolio before change:  [18.13002844]
curr_Stock_Price:  100.47701156265029
curr_Factors:  [100.47701156]
mat_Sqrt:  [[0.15]]
grads:  [0.00228771]
Stock Position:  0.0022877144487091702
Bond Position:  [17.90016573]


portfolio before change:  [18.1325445]
curr_Stock_Price:  101.08777875394142
curr_Factors:  [101.08777875]
mat_Sqrt:  [[0.15]]
grads:  [0.0176556]
Stock Position:  0.017655596170186128
Bond Position:  [16.3477795]


portfolio before change:  [18.1373937]
curr_Stock_Price:  101.30456203206167
curr_Factors:  [101.30456203]
mat_Sqrt:  [[0.15]]
grads:  [0.04188123]
Stock Position:  0.041881228680782576
Bond Position:  [13.89463418]


portfolio before change:  [18.14294312]
curr_Stock_Price:  101.41632991903712
curr_Factors:  [101.41632992]
mat_Sqrt:  [[0.15]]
grads:  [0.08050013]
Stock Position:  0.080500127639559
Bond Position:  [9.97891562]


portfolio before change:  [18.23342999]
curr_Stock_Price:  102.53264074860822
curr_Factors:  [102.53264075]
mat_Sqrt:  [[0.15]]
grads:  [-0.00601041]
Stock Position:  -0.006010414798804442
Bond Position:  [18.84969369]


portfolio before change:  [18.23702185]
curr_Stock_Price:  102.13105088720651
curr_Factors:  [102.13105089]
mat_Sqrt:  [[0.15]]
grads:  [0.06831069]
Stock Position:  0.06831069363771239
Bond Position:  [11.26037892]


portfolio before change:  [18.24019094]
curr_Stock_Price:  102.16714029428623
curr_Factors:  [102.16714029]
mat_Sqrt:  [[0.15]]
grads:  [-0.07735401]
Stock Position:  -0.07735400754574034
Bond Position:  [26.14322868]


portfolio before change:  [18.19957725]
curr_Stock_Price:  102.71330065237892
curr_Factors:  [102.71330065]
mat_Sqrt:  [[0.15]]
grads:  [0.14669222]
Stock Position:  0.14669222112802316
Bond Position:  [3.13233504]


portfolio before change:  [18.13496736]
curr_Stock_Price:  102.27152076740863
curr_Factors:  [102.27152077]
mat_Sqrt:  [[0.15]]
grads:  [0.06608096]
Stock Position:  0.06608095563906963
Bond Position:  [11.37676753]


portfolio before change:  [18.12849187]
curr_Stock_Price:  102.16276696255736
curr_Factors:  [102.16276696]
mat_Sqrt:  [[0.15]]
grads:  [-0.06903183]
Stock Position:  -0.06903183289865401
Bond Position:  [25.18097493]


portfolio before change:  [18.11523139]
curr_Stock_Price:  102.37765824453218
curr_Factors:  [102.37765824]
mat_Sqrt:  [[0.15]]
grads:  [0.16364603]
Stock Position:  0.16364602751933688
Bond Position:  [1.36153431]


portfolio before change:  [18.16152716]
curr_Stock_Price:  102.6600401077129
curr_Factors:  [102.66004011]
mat_Sqrt:  [[0.15]]
grads:  [0.09873317]
Stock Position:  0.09873316999677707
Bond Position:  [8.02557597]


portfolio before change:  [18.23720512]
curr_Stock_Price:  103.4214493245897
curr_Factors:  [103.42144932]
mat_Sqrt:  [[0.15]]
grads:  [-0.06883291]
Stock Position:  -0.06883290500935452
Bond Position:  [25.35600392]


portfolio before change:  [18.26304525]
curr_Stock_Price:  103.06906945910416
curr_Factors:  [103.06906946]
mat_Sqrt:  [[0.15]]
grads:  [-0.05524277]
Stock Position:  -0.055242773044560704
Bond Position:  [23.95686646]


portfolio before change:  [18.3000656]
curr_Stock_Price:  102.42603505279135
curr_Factors:  [102.42603505]
mat_Sqrt:  [[0.15]]
grads:  [0.05928271]
Stock Position:  0.059282706077741755
Bond Position:  [12.22797307]


portfolio before change:  [18.32145815]
curr_Stock_Price:  102.77399943121564
curr_Factors:  [102.77399943]
mat_Sqrt:  [[0.15]]
grads:  [0.17988125]
Stock Position:  0.1798812531344348
Bond Position:  [-0.16565766]


portfolio before change:  [18.30851067]
curr_Stock_Price:  102.70207906213334
curr_Factors:  [102.70207906]
mat_Sqrt:  [[0.15]]
grads:  [0.06543065]
Stock Position:  0.0654306536559649
Bond Position:  [11.5886465]


portfolio before change:  [18.30207376]
curr_Stock_Price:  102.59263165424369
curr_Factors:  [102.59263165]
mat_Sqrt:  [[0.15]]
grads:  [-0.0120478]
Stock Position:  -0.012047803379449513
Bond Position:  [19.53808962]


portfolio before change:  [18.29366709]
curr_Stock_Price:  103.39176830490361
curr_Factors:  [103.3917683]
mat_Sqrt:  [[0.15]]
grads:  [0.16686938]
Stock Position:  0.16686937617797673
Bond Position:  [1.04074721]


portfolio before change:  [18.14391946]
curr_Stock_Price:  102.49398413724377
curr_Factors:  [102.49398414]
mat_Sqrt:  [[0.15]]
grads:  [-0.08069178]
Stock Position:  -0.08069178059208885
Bond Position:  [26.41434154]


portfolio before change:  [18.19917918]
curr_Stock_Price:  101.82961938451346
curr_Factors:  [101.82961938]
mat_Sqrt:  [[0.15]]
grads:  [0.05541877]
Stock Position:  0.05541876710566075
Bond Position:  [12.55590722]


portfolio before change:  [18.21093013]
curr_Stock_Price:  102.0274978147158
curr_Factors:  [102.02749781]
mat_Sqrt:  [[0.15]]
grads:  [-0.02959486]
Stock Position:  -0.02959486373869651
Bond Position:  [21.23042002]


portfolio before change:  [18.17312099]
curr_Stock_Price:  103.3498920967526
curr_Factors:  [103.3498921]
mat_Sqrt:  [[0.15]]
grads:  [0.11939666]
Stock Position:  0.11939665696195241
Bond Position:  [5.83348938]


portfolio before change:  [18.16998416]
curr_Stock_Price:  103.320566004509
curr_Factors:  [103.320566]
mat_Sqrt:  [[0.15]]
grads:  [0.11497226]
Stock Position:  0.11497225690711123
Bond Position:  [6.2909855]


portfolio before change:  [18.11139199]
curr_Stock_Price:  102.80752602149917
curr_Factors:  [102.80752602]
mat_Sqrt:  [[0.15]]
grads:  [0.06480815]
Stock Position:  0.06480814515482011
Bond Position:  [11.44862692]


portfolio before change:  [18.09990613]
curr_Stock_Price:  102.6192561679487
curr_Factors:  [102.61925617]
mat_Sqrt:  [[0.15]]
grads:  [0.02450003]
Stock Position:  0.024500031981712057
Bond Position:  [15.58573108]


portfolio before change:  [18.09317382]
curr_Stock_Price:  102.30470731635783
curr_Factors:  [102.30470732]
mat_Sqrt:  [[0.15]]
grads:  [0.03793184]
Stock Position:  0.03793184312464443
Bond Position:  [14.21256771]


portfolio before change:  [18.10952805]
curr_Stock_Price:  102.71243653650718
curr_Factors:  [102.71243654]
mat_Sqrt:  [[0.15]]
grads:  [-0.09403287]
Stock Position:  -0.09403287290471175
Bond Position:  [27.76787354]


portfolio before change:  [18.09238825]
curr_Stock_Price:  102.91316788864792
curr_Factors:  [102.91316789]
mat_Sqrt:  [[0.15]]
grads:  [-0.03806151]
Stock Position:  -0.03806151392976624
Bond Position:  [22.00941922]


portfolio before change:  [18.09279079]
curr_Stock_Price:  102.93873414670526
curr_Factors:  [102.93873415]
mat_Sqrt:  [[0.15]]
grads:  [0.25041807]
Stock Position:  0.2504180659018732
Bond Position:  [-7.68492792]


portfolio before change:  [18.16136803]
curr_Stock_Price:  103.2145032480672
curr_Factors:  [103.21450325]
mat_Sqrt:  [[0.15]]
grads:  [0.03838881]
Stock Position:  0.03838881206844368
Bond Position:  [14.19908587]


portfolio before change:  [18.15258677]
curr_Stock_Price:  102.96263988849499
curr_Factors:  [102.96263989]
mat_Sqrt:  [[0.15]]
grads:  [-0.02987337]
Stock Position:  -0.02987337343658233
Bond Position:  [21.22842816]


portfolio before change:  [18.14673077]
curr_Stock_Price:  103.20308207892404
curr_Factors:  [103.20308208]
mat_Sqrt:  [[0.15]]
grads:  [-0.04090177]
Stock Position:  -0.040901768576764336
Bond Position:  [22.36791935]


portfolio before change:  [18.12103681]
curr_Stock_Price:  103.86544952447011
curr_Factors:  [103.86544952]
mat_Sqrt:  [[0.15]]
grads:  [-0.030282]
Stock Position:  -0.030282002071531453
Bond Position:  [21.26629056]


portfolio before change:  [18.10117023]
curr_Stock_Price:  104.56539535331807
curr_Factors:  [104.56539535]
mat_Sqrt:  [[0.15]]
grads:  [-0.01996626]
Stock Position:  -0.019966260663274876
Bond Position:  [20.18895017]


portfolio before change:  [18.09440146]
curr_Stock_Price:  104.96760471422523
curr_Factors:  [104.96760471]
mat_Sqrt:  [[0.15]]
grads:  [-0.01065723]
Stock Position:  -0.010657234681415925
Bond Position:  [19.21306586]


portfolio before change:  [18.09793527]
curr_Stock_Price:  104.74869659371997
curr_Factors:  [104.74869659]
mat_Sqrt:  [[0.15]]
grads:  [0.03644365]
Stock Position:  0.03644365290492893
Bond Position:  [14.28051013]


portfolio before change:  [18.12359205]
curr_Stock_Price:  105.42821740024881
curr_Factors:  [105.4282174]
mat_Sqrt:  [[0.15]]
grads:  [-0.04250224]
Stock Position:  -0.04250224102162487
Bond Position:  [22.60452756]


portfolio before change:  [18.12801911]
curr_Stock_Price:  105.3572980732355
curr_Factors:  [105.35729807]
mat_Sqrt:  [[0.15]]
grads:  [-0.37887134]
Stock Position:  -0.3788713388399901
Bond Position:  [58.04487969]


portfolio before change:  [18.15422411]
curr_Stock_Price:  105.2977077168014
curr_Factors:  [105.29770772]
mat_Sqrt:  [[0.15]]
grads:  [-0.03011909]
Stock Position:  -0.030119093025483015
Bond Position:  [21.32569556]


portfolio before change:  [18.15184719]
curr_Stock_Price:  105.42087928764305
curr_Factors:  [105.42087929]
mat_Sqrt:  [[0.15]]
grads:  [0.11972065]
Stock Position:  0.11972065197355673
Bond Position:  [5.53079079]


portfolio before change:  [18.17519176]
curr_Stock_Price:  105.6129838633009
curr_Factors:  [105.61298386]
mat_Sqrt:  [[0.15]]
grads:  [-0.10801592]
Stock Position:  -0.10801591614479528
Bond Position:  [29.58307497]


portfolio before change:  [18.14973836]
curr_Stock_Price:  105.86574658837071
curr_Factors:  [105.86574659]
mat_Sqrt:  [[0.15]]
grads:  [-0.04760267]
Stock Position:  -0.04760266772389174
Bond Position:  [23.18923032]


portfolio before change:  [18.16552872]
curr_Stock_Price:  105.56448211561414
curr_Factors:  [105.56448212]
mat_Sqrt:  [[0.15]]
grads:  [0.01994083]
Stock Position:  0.01994083367077164
Bond Position:  [16.06048495]


portfolio before change:  [18.16808945]
curr_Stock_Price:  105.64255884191016
curr_Factors:  [105.64255884]
mat_Sqrt:  [[0.15]]
grads:  [-0.09040174]
Stock Position:  -0.09040174118664861
Bond Position:  [27.71836071]


portfolio before change:  [18.17949311]
curr_Stock_Price:  105.53557850861877
curr_Factors:  [105.53557851]
mat_Sqrt:  [[0.15]]
grads:  [0.11888696]
Stock Position:  0.11888695887622348
Bond Position:  [5.63268913]


portfolio before change:  [18.21900019]
curr_Stock_Price:  105.86492517752625
curr_Factors:  [105.86492518]
mat_Sqrt:  [[0.15]]
grads:  [0.20450286]
Stock Position:  0.2045028600744938
Bond Position:  [-3.43067979]


portfolio before change:  [18.33831167]
curr_Stock_Price:  106.44939574418193
curr_Factors:  [106.44939574]
mat_Sqrt:  [[0.15]]
grads:  [-0.09270122]
Stock Position:  -0.09270121762982252
Bond Position:  [28.20630027]


portfolio before change:  [18.39188188]
curr_Stock_Price:  105.8905329441458
curr_Factors:  [105.89053294]
mat_Sqrt:  [[0.15]]
grads:  [-0.03064308]
Stock Position:  -0.0306430813572263
Bond Position:  [21.63669409]


portfolio before change:  [18.36807141]
curr_Stock_Price:  106.71169072491924
curr_Factors:  [106.71169072]
mat_Sqrt:  [[0.15]]
grads:  [0.02506944]
Stock Position:  0.02506943672760721
Bond Position:  [15.69286943]


portfolio before change:  [18.36410254]
curr_Stock_Price:  106.51425087653428
curr_Factors:  [106.51425088]
mat_Sqrt:  [[0.15]]
grads:  [0.02299264]
Stock Position:  0.022992639829316864
Bond Position:  [15.91505873]


portfolio before change:  [18.35365709]
curr_Stock_Price:  106.01669306698328
curr_Factors:  [106.01669307]
mat_Sqrt:  [[0.15]]
grads:  [-0.0335607]
Stock Position:  -0.03356070471578454
Bond Position:  [21.91165202]


portfolio before change:  [18.35437579]
curr_Stock_Price:  106.03608565540783
curr_Factors:  [106.03608566]
mat_Sqrt:  [[0.15]]
grads:  [-0.07341089]
Stock Position:  -0.0734108858138846
Bond Position:  [26.13857876]


portfolio before change:  [18.36801182]
curr_Stock_Price:  105.87259057799112
curr_Factors:  [105.87259058]
mat_Sqrt:  [[0.15]]
grads:  [0.08140924]
Stock Position:  0.08140924358482438
Bond Position:  [9.7490043]


portfolio before change:  [18.34145868]
curr_Stock_Price:  105.53893716149595
curr_Factors:  [105.53893716]
mat_Sqrt:  [[0.15]]
grads:  [-0.17756453]
Stock Position:  -0.17756452638417317
Bond Position:  [37.08143007]


portfolio before change:  [18.22654122]
curr_Stock_Price:  106.1991766644075
curr_Factors:  [106.19917666]
mat_Sqrt:  [[0.15]]
grads:  [-0.06613983]
Stock Position:  -0.06613983310295031
Bond Position:  [25.25053704]


portfolio before change:  [18.28576264]
curr_Stock_Price:  105.32764120263154
curr_Factors:  [105.3276412]
mat_Sqrt:  [[0.15]]
grads:  [0.12340651]
Stock Position:  0.12340650725363499
Bond Position:  [5.28764632]


portfolio before change:  [18.22332265]
curr_Stock_Price:  104.81899317714588
curr_Factors:  [104.81899318]
mat_Sqrt:  [[0.15]]
grads:  [-0.0215729]
Stock Position:  -0.021572898135377418
Bond Position:  [20.48457212]


portfolio before change:  [18.2183355]
curr_Stock_Price:  105.10951884004922
curr_Factors:  [105.10951884]
mat_Sqrt:  [[0.15]]
grads:  [0.08703132]
Stock Position:  0.08703132044883279
Bond Position:  [9.07051528]


portfolio before change:  [18.18321576]
curr_Stock_Price:  104.69947491835147
curr_Factors:  [104.69947492]
mat_Sqrt:  [[0.15]]
grads:  [-0.0973547]
Stock Position:  -0.09735470327938749
Bond Position:  [28.37620207]


portfolio before change:  [18.20137983]
curr_Stock_Price:  104.5311163373989
curr_Factors:  [104.53111634]
mat_Sqrt:  [[0.15]]
grads:  [-0.08501102]
Stock Position:  -0.08501102282747844
Bond Position:  [27.08767694]


portfolio before change:  [18.19911868]
curr_Stock_Price:  104.5776300993618
curr_Factors:  [104.5776301]
mat_Sqrt:  [[0.15]]
grads:  [-0.02178629]
Stock Position:  -0.021786285408096018
Bond Position:  [20.47747677]


portfolio before change:  [18.21324609]
curr_Stock_Price:  103.98792266464342
curr_Factors:  [103.98792266]
mat_Sqrt:  [[0.15]]
grads:  [0.12763463]
Stock Position:  0.12763463298868136
Bond Position:  [4.94078575]


portfolio before change:  [18.25371211]
curr_Stock_Price:  104.3025489014221
curr_Factors:  [104.3025489]
mat_Sqrt:  [[0.15]]
grads:  [-0.11666143]
Stock Position:  -0.11666142647420302
Bond Position:  [30.42179625]


portfolio before change:  [18.25169147]
curr_Stock_Price:  104.33616804534478
curr_Factors:  [104.33616805]
mat_Sqrt:  [[0.15]]
grads:  [0.12267267]
Stock Position:  0.12267267216005104
Bond Position:  [5.45249493]


portfolio before change:  [18.39261984]
curr_Stock_Price:  105.48220635312971
curr_Factors:  [105.48220635]
mat_Sqrt:  [[0.15]]
grads:  [0.0332122]
Stock Position:  0.03321220431640036
Bond Position:  [14.88932326]


portfolio before change:  [18.39414312]
curr_Stock_Price:  105.50005099919612
curr_Factors:  [105.500051]
mat_Sqrt:  [[0.15]]
grads:  [0.08352692]
Stock Position:  0.08352692087878535
Bond Position:  [9.5820487]


portfolio before change:  [18.4581804]
curr_Stock_Price:  106.25954726768917
curr_Factors:  [106.25954727]
mat_Sqrt:  [[0.15]]
grads:  [-0.17880952]
Stock Position:  -0.17880951971213416
Bond Position:  [37.45839901]


portfolio before change:  [18.65874365]
curr_Stock_Price:  105.15098195763211
curr_Factors:  [105.15098196]
mat_Sqrt:  [[0.15]]
grads:  [-0.05308024]
Stock Position:  -0.053080238163681036
Bond Position:  [24.24018282]


portfolio before change:  [18.64183406]
curr_Stock_Price:  105.49809131689364
curr_Factors:  [105.49809132]
mat_Sqrt:  [[0.15]]
grads:  [-0.04130932]
Stock Position:  -0.0413093206555314
Bond Position:  [22.99988855]


portfolio before change:  [18.6197866]
curr_Stock_Price:  106.0666071688912
curr_Factors:  [106.06660717]
mat_Sqrt:  [[0.15]]
grads:  [0.07214662]
Stock Position:  0.07214661607291072
Bond Position:  [10.96743981]


portfolio before change:  [18.64922132]
curr_Stock_Price:  106.46509065232122
curr_Factors:  [106.46509065]
mat_Sqrt:  [[0.15]]
grads:  [0.03488073]
Stock Position:  0.034880728924068495
Bond Position:  [14.93564135]


portfolio before change:  [18.61492804]
curr_Stock_Price:  105.45516951155973
curr_Factors:  [105.45516951]
mat_Sqrt:  [[0.15]]
grads:  [-0.00507537]
Stock Position:  -0.005075370008360304
Bond Position:  [19.15015204]


portfolio before change:  [18.62058461]
curr_Stock_Price:  104.57648487424449
curr_Factors:  [104.57648487]
mat_Sqrt:  [[0.15]]
grads:  [-0.02393513]
Stock Position:  -0.02393512787460899
Bond Position:  [21.12363615]


portfolio before change:  [18.62076856]
curr_Stock_Price:  104.62395993058794
curr_Factors:  [104.62395993]
mat_Sqrt:  [[0.15]]
grads:  [0.05638018]
Stock Position:  0.056380177526923946
Bond Position:  [12.72205112]


portfolio before change:  [18.60480395]
curr_Stock_Price:  104.32669655659238
curr_Factors:  [104.32669656]
mat_Sqrt:  [[0.15]]
grads:  [-0.02537821]
Stock Position:  -0.025378214316316216
Bond Position:  [21.25242921]


portfolio before change:  [18.63057548]
curr_Stock_Price:  103.36353933473708
curr_Factors:  [103.36353933]
mat_Sqrt:  [[0.15]]
grads:  [0.16588034]
Stock Position:  0.16588033541811248
Bond Position:  [1.4845969]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.63057548]
Stock Price:  104.25918951173605
PL:  [14.37138597]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.83808222e-02]
 [ 8.83770986e-04]
 [-2.85612799e-04]
 [ 5.93322330e-04]
 [-1.36160876e-02]
 [ 4.82075781e-03]
 [ 2.76345258e-03]
 [-1.62223760e-02]
 [ 1.43849910e-03]
 [ 2.94127930e-02]
 [ 9.45223384e-03]
 [-1.11625359e-02]
 [ 1.34419621e-02]
 [ 8.60863639e-03]
 [-3.44047955e-02]
 [ 2.08271221e-02]
 [-4.89437831e-03]
 [-7.41113373e-03]
 [-3.61770571e-02]
 [ 1.43972728e-02]
 [ 3.27973807e-03]
 [-2.45874487e-02]
 [ 5.32325726e-04]
 [ 3.09667508e-03]
 [-6.64674836e-03]
 [ 1.67031070e-02]
 [ 1.89814118e-02]
 [ 5.79433950e-02]
 [-2.15409648e-04]
 [ 1.05913053e-02]
 [-3.45250380e-03]
 [-3.61900640e-02]
 [ 2.14672442e-02]
 [ 1.00371068e-02]
 [-2.62356655e-02]
 [ 7.83644288e-03]
 [-2.82754417e-03]
 [ 7.88570461e-04]
 [ 4.80343731e-03]
 [-1.54877463e-02]
 [ 4.00963399e-02]
 [-1.69674278e-04]
 [ 5.13754402e-03]
 [-8.17801039e-03]
 [ 1.62335681e-03]
 [-3.50637006e-03]
 [-1.36389436e-02]
 [-1.58990919e-03]
 [-8.53736432e-03]
 [ 9.62751774e-03]
 [-3.22146287e-03]
 [ 3.09606713e-03]
 [ 2.96070289e-03]
 [ 2.41175414e-03]
 [ 2.12034695e-03]
 [ 8.97679506e-03]
 [ 1.47366097e-02]
 [-1.49548375e-02]
 [ 1.39346354e-02]
 [ 4.16797264e-03]
 [ 3.91666220e-03]
 [-1.52330441e-02]
 [-1.26450575e-02]
 [-1.41771409e-03]
 [-1.23929269e-02]
 [ 3.47068549e-02]
 [ 2.05316323e-02]
 [ 2.16967395e-03]
 [ 6.10527426e-03]
 [-1.48318512e-02]
 [-6.79135286e-03]
 [-1.71094355e-03]
 [ 2.06568922e-03]
 [ 8.80608129e-03]
 [ 1.18578639e-02]
 [-8.28574662e-03]
 [-1.33950284e-03]
 [-8.70914055e-03]
 [ 4.31546134e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.46540926]
curr_Stock_Price:  99.32311062355939
curr_Factors:  [99.32311062]
mat_Sqrt:  [[0.15]]
grads:  [-0.25587215]
Stock Position:  -0.25587214831201643
Bond Position:  [16.94860843]


portfolio before change:  [-8.53598102]
curr_Stock_Price:  99.60305933702455
curr_Factors:  [99.60305934]
mat_Sqrt:  [[0.15]]
grads:  [0.00589181]
Stock Position:  0.00589180657219324
Bond Position:  [-9.12282298]


portfolio before change:  [-8.53745999]
curr_Stock_Price:  99.4488149336177
curr_Factors:  [99.44881493]
mat_Sqrt:  [[0.15]]
grads:  [-0.00190409]
Stock Position:  -0.001904085325829365
Bond Position:  [-8.34810096]


portfolio before change:  [-8.53771196]
curr_Stock_Price:  99.30711647498875
curr_Factors:  [99.30711647]
mat_Sqrt:  [[0.15]]
grads:  [0.00395548]
Stock Position:  0.003955482200118731
Bond Position:  [-8.93051949]


portfolio before change:  [-8.54018318]
curr_Stock_Price:  98.82347254782397
curr_Factors:  [98.82347255]
mat_Sqrt:  [[0.15]]
grads:  [-0.09077392]
Stock Position:  -0.09077391729677445
Bond Position:  [0.43041055]


portfolio before change:  [-8.50279516]
curr_Stock_Price:  98.41188833636566
curr_Factors:  [98.41188834]
mat_Sqrt:  [[0.15]]
grads:  [0.03213839]
Stock Position:  0.03213838537598284
Bond Position:  [-11.66559436]


portfolio before change:  [-8.54111823]
curr_Stock_Price:  97.24213615876718
curr_Factors:  [97.24213616]
mat_Sqrt:  [[0.15]]
grads:  [0.01842302]
Stock Position:  0.018423017204400396
Bond Position:  [-10.33261178]


portfolio before change:  [-8.54450034]
curr_Stock_Price:  97.09361018717178
curr_Factors:  [97.09361019]
mat_Sqrt:  [[0.15]]
grads:  [-0.10814917]
Stock Position:  -0.1081491735367853
Bond Position:  [1.95609336]


portfolio before change:  [-8.58180971]
curr_Stock_Price:  97.43972134390378
curr_Factors:  [97.43972134]
mat_Sqrt:  [[0.15]]
grads:  [0.00958999]
Stock Position:  0.009589993996900265
Bond Position:  [-9.51625606]


portfolio before change:  [-8.58187514]
curr_Stock_Price:  97.49492065839466
curr_Factors:  [97.49492066]
mat_Sqrt:  [[0.15]]
grads:  [0.19608529]
Stock Position:  0.19608528689042626
Bond Position:  [-27.69919462]


portfolio before change:  [-8.60657936]
curr_Stock_Price:  97.37776258822535
curr_Factors:  [97.37776259]
mat_Sqrt:  [[0.15]]
grads:  [0.06301489]
Stock Position:  0.06301489227280557
Bond Position:  [-14.74282858]


portfolio before change:  [-8.61355206]
curr_Stock_Price:  97.2817338500943
curr_Factors:  [97.28173385]
mat_Sqrt:  [[0.15]]
grads:  [-0.07441691]
Stock Position:  -0.07441690581505625
Bond Position:  [-1.37414643]


portfolio before change:  [-8.56975471]
curr_Stock_Price:  96.69203940523808
curr_Factors:  [96.69203941]
mat_Sqrt:  [[0.15]]
grads:  [0.08961308]
Stock Position:  0.08961308049611333
Bond Position:  [-17.23462622]


portfolio before change:  [-8.57277885]
curr_Stock_Price:  96.67031333028852
curr_Factors:  [96.67031333]
mat_Sqrt:  [[0.15]]
grads:  [0.05739091]
Stock Position:  0.05739090925403761
Bond Position:  [-14.12077603]


portfolio before change:  [-8.56689435]
curr_Stock_Price:  96.78822522580099
curr_Factors:  [96.78822523]
mat_Sqrt:  [[0.15]]
grads:  [-0.2293653]
Stock Position:  -0.22936530307511566
Bond Position:  [13.63296626]


portfolio before change:  [-8.47716165]
curr_Stock_Price:  96.40071843378396
curr_Factors:  [96.40071843]
mat_Sqrt:  [[0.15]]
grads:  [0.13884748]
Stock Position:  0.1388474804084841
Bond Position:  [-21.86215852]


portfolio before change:  [-8.43981993]
curr_Stock_Price:  96.67950022949589
curr_Factors:  [96.67950023]
mat_Sqrt:  [[0.15]]
grads:  [-0.03262919]
Stock Position:  -0.032629188707791766
Bond Position:  [-5.28524627]


portfolio before change:  [-8.4498727]
curr_Stock_Price:  96.97746735477733
curr_Factors:  [96.97746735]
mat_Sqrt:  [[0.15]]
grads:  [-0.04940756]
Stock Position:  -0.0494075582074035
Bond Position:  [-3.65845283]


portfolio before change:  [-8.41709285]
curr_Stock_Price:  96.30938124408961
curr_Factors:  [96.30938124]
mat_Sqrt:  [[0.15]]
grads:  [-0.24118038]
Stock Position:  -0.24118038084902918
Bond Position:  [14.8108404]


portfolio before change:  [-8.71174206]
curr_Stock_Price:  97.53491590222283
curr_Factors:  [97.5349159]
mat_Sqrt:  [[0.15]]
grads:  [0.09598182]
Stock Position:  0.09598181889134345
Bond Position:  [-18.0733207]


portfolio before change:  [-8.67036478]
curr_Stock_Price:  97.9777800311139
curr_Factors:  [97.97778003]
mat_Sqrt:  [[0.15]]
grads:  [0.02186492]
Stock Position:  0.021864920476861727
Bond Position:  [-10.81264114]


portfolio before change:  [-8.6821246]
curr_Stock_Price:  97.4708488606166
curr_Factors:  [97.47084886]
mat_Sqrt:  [[0.15]]
grads:  [-0.16391632]
Stock Position:  -0.16391632458853866
Bond Position:  [7.2949387]


portfolio before change:  [-8.62301656]
curr_Stock_Price:  97.11303164165012
curr_Factors:  [97.11303164]
mat_Sqrt:  [[0.15]]
grads:  [0.00354884]
Stock Position:  0.00354883817563793
Bond Position:  [-8.967655]


portfolio before change:  [-8.6239921]
curr_Stock_Price:  96.99608075360281
curr_Factors:  [96.99608075]
mat_Sqrt:  [[0.15]]
grads:  [0.0206445]
Stock Position:  0.02064450056103367
Bond Position:  [-10.62642774]


portfolio before change:  [-8.6417079]
curr_Stock_Price:  96.17011607296456
curr_Factors:  [96.17011607]
mat_Sqrt:  [[0.15]]
grads:  [-0.04431166]
Stock Position:  -0.04431165575047488
Bond Position:  [-4.38025082]


portfolio before change:  [-8.62922669]
curr_Stock_Price:  95.88226896196214
curr_Factors:  [95.88226896]
mat_Sqrt:  [[0.15]]
grads:  [0.11135405]
Stock Position:  0.11135404653194604
Bond Position:  [-19.30610533]


portfolio before change:  [-8.63527395]
curr_Stock_Price:  95.83879871476238
curr_Factors:  [95.83879871]
mat_Sqrt:  [[0.15]]
grads:  [0.12654275]
Stock Position:  0.12654274527518095
Bond Position:  [-20.76297864]


portfolio before change:  [-8.67095351]
curr_Stock_Price:  95.5670974150514
curr_Factors:  [95.56709742]
mat_Sqrt:  [[0.15]]
grads:  [0.3862893]
Stock Position:  0.3862893001316246
Bond Position:  [-45.58750068]


portfolio before change:  [-8.65226561]
curr_Stock_Price:  95.62285150230531
curr_Factors:  [95.6228515]
mat_Sqrt:  [[0.15]]
grads:  [-0.00143606]
Stock Position:  -0.0014360643200577864
Bond Position:  [-8.51494504]


portfolio before change:  [-8.6527564]
curr_Stock_Price:  95.59401802744858
curr_Factors:  [95.59401803]
mat_Sqrt:  [[0.15]]
grads:  [0.0706087]
Stock Position:  0.07060870220660267
Bond Position:  [-15.40252595]


portfolio before change:  [-8.66929564]
curr_Stock_Price:  95.37341420433745
curr_Factors:  [95.3734142]
mat_Sqrt:  [[0.15]]
grads:  [-0.02301669]
Stock Position:  -0.023016692032161053
Bond Position:  [-6.47411513]


portfolio before change:  [-8.6853598]
curr_Stock_Price:  96.05376901555591
curr_Factors:  [96.05376902]
mat_Sqrt:  [[0.15]]
grads:  [-0.24126709]
Stock Position:  -0.2412670934103368
Bond Position:  [14.48925386]


portfolio before change:  [-8.75126437]
curr_Stock_Price:  96.33068275942932
curr_Factors:  [96.33068276]
mat_Sqrt:  [[0.15]]
grads:  [0.14311496]
Stock Position:  0.14311496119461495
Bond Position:  [-22.53762629]


portfolio before change:  [-8.66789206]
curr_Stock_Price:  96.92308030564044
curr_Factors:  [96.92308031]
mat_Sqrt:  [[0.15]]
grads:  [0.06691405]
Stock Position:  0.06691404541728384
Bond Position:  [-15.15340746]


portfolio before change:  [-8.67530918]
curr_Stock_Price:  96.82638908279901
curr_Factors:  [96.82638908]
mat_Sqrt:  [[0.15]]
grads:  [-0.17490444]
Stock Position:  -0.17490443660683688
Bond Position:  [8.26005585]


portfolio before change:  [-8.7614442]
curr_Stock_Price:  97.32180984726307
curr_Factors:  [97.32180985]
mat_Sqrt:  [[0.15]]
grads:  [0.05224295]
Stock Position:  0.052242952520505606
Bond Position:  [-13.84582289]


portfolio before change:  [-8.76261345]
curr_Stock_Price:  97.31599365261185
curr_Factors:  [97.31599365]
mat_Sqrt:  [[0.15]]
grads:  [-0.01885029]
Stock Position:  -0.018850294442677166
Bond Position:  [-6.92817831]


portfolio before change:  [-8.75996863]
curr_Stock_Price:  97.1527155237974
curr_Factors:  [97.15271552]
mat_Sqrt:  [[0.15]]
grads:  [0.00525714]
Stock Position:  0.005257136403861457
Bond Position:  [-9.27071371]


portfolio before change:  [-8.75948238]
curr_Stock_Price:  97.35542762020751
curr_Factors:  [97.35542762]
mat_Sqrt:  [[0.15]]
grads:  [0.03202292]
Stock Position:  0.03202291542438524
Bond Position:  [-11.87708701]


portfolio before change:  [-8.75333223]
curr_Stock_Price:  97.57066400462077
curr_Factors:  [97.570664]
mat_Sqrt:  [[0.15]]
grads:  [-0.10325164]
Stock Position:  -0.10325164183111113
Bond Position:  [1.32099903]


portfolio before change:  [-8.73186238]
curr_Stock_Price:  97.36352653363069
curr_Factors:  [97.36352653]
mat_Sqrt:  [[0.15]]
grads:  [0.26730893]
Stock Position:  0.2673089324680712
Bond Position:  [-34.75800272]


portfolio before change:  [-8.74218777]
curr_Stock_Price:  97.33302642319198
curr_Factors:  [97.33302642]
mat_Sqrt:  [[0.15]]
grads:  [-0.00113116]
Stock Position:  -0.0011311618549731217
Bond Position:  [-8.63208837]


portfolio before change:  [-8.74305387]
curr_Stock_Price:  97.62173803727897
curr_Factors:  [97.62173804]
mat_Sqrt:  [[0.15]]
grads:  [0.03425029]
Stock Position:  0.034250293461941875
Bond Position:  [-12.08662705]


portfolio before change:  [-8.72876067]
curr_Stock_Price:  98.06111077609172
curr_Factors:  [98.06111078]
mat_Sqrt:  [[0.15]]
grads:  [-0.05452007]
Stock Position:  -0.05452006924395295
Bond Position:  [-3.38246212]


portfolio before change:  [-8.72777888]
curr_Stock_Price:  98.03922522721048
curr_Factors:  [98.03922523]
mat_Sqrt:  [[0.15]]
grads:  [0.01082238]
Stock Position:  0.010822378743792015
Bond Position:  [-9.7887965]


portfolio before change:  [-8.72184604]
curr_Stock_Price:  98.64395888695614
curr_Factors:  [98.64395889]
mat_Sqrt:  [[0.15]]
grads:  [-0.0233758]
Stock Position:  -0.023375800416984352
Bond Position:  [-6.41596454]


portfolio before change:  [-8.70656657]
curr_Stock_Price:  97.97315941751255
curr_Factors:  [97.97315942]
mat_Sqrt:  [[0.15]]
grads:  [-0.09092629]
Stock Position:  -0.09092629084857554
Bond Position:  [0.20176941]


portfolio before change:  [-8.77423852]
curr_Stock_Price:  98.71754866238983
curr_Factors:  [98.71754866]
mat_Sqrt:  [[0.15]]
grads:  [-0.01059939]
Stock Position:  -0.010599394582912758
Bond Position:  [-7.72789227]


portfolio before change:  [-8.77697157]
curr_Stock_Price:  98.92982948380613
curr_Factors:  [98.92982948]
mat_Sqrt:  [[0.15]]
grads:  [-0.05691576]
Stock Position:  -0.05691576215449741
Bond Position:  [-3.14630493]


portfolio before change:  [-8.76992485]
curr_Stock_Price:  98.80256475612985
curr_Factors:  [98.80256476]
mat_Sqrt:  [[0.15]]
grads:  [0.06418345]
Stock Position:  0.06418345158310279
Bond Position:  [-15.11141449]


portfolio before change:  [-8.81493971]
curr_Stock_Price:  98.11593347979654
curr_Factors:  [98.11593348]
mat_Sqrt:  [[0.15]]
grads:  [-0.02147642]
Stock Position:  -0.021476419158289337
Bond Position:  [-6.7077608]


portfolio before change:  [-8.81108563]
curr_Stock_Price:  97.9169558961696
curr_Factors:  [97.9169559]
mat_Sqrt:  [[0.15]]
grads:  [0.02064045]
Stock Position:  0.020640447513866168
Bond Position:  [-10.83213542]


portfolio before change:  [-8.8031492]
curr_Stock_Price:  98.33426581286642
curr_Factors:  [98.33426581]
mat_Sqrt:  [[0.15]]
grads:  [0.01973802]
Stock Position:  0.019738019249604468
Bond Position:  [-10.74407283]


portfolio before change:  [-8.81120141]
curr_Stock_Price:  97.96033352639974
curr_Factors:  [97.96033353]
mat_Sqrt:  [[0.15]]
grads:  [0.01607836]
Stock Position:  0.01607836092956073
Bond Position:  [-10.38624301]


portfolio before change:  [-8.80760826]
curr_Stock_Price:  98.22418578112529
curr_Factors:  [98.22418578]
mat_Sqrt:  [[0.15]]
grads:  [0.01413565]
Stock Position:  0.01413564632773762
Bond Position:  [-10.19607061]


portfolio before change:  [-8.81052927]
curr_Stock_Price:  98.0626270467072
curr_Factors:  [98.06262705]
mat_Sqrt:  [[0.15]]
grads:  [0.0598453]
Stock Position:  0.05984530039967968
Bond Position:  [-14.67911664]


portfolio before change:  [-8.79257479]
curr_Stock_Price:  98.37797263281801
curr_Factors:  [98.37797263]
mat_Sqrt:  [[0.15]]
grads:  [0.09824406]
Stock Position:  0.09824406437570675
Bond Position:  [-18.45762667]


portfolio before change:  [-8.78944078]
curr_Stock_Price:  98.4216154704203
curr_Factors:  [98.42161547]
mat_Sqrt:  [[0.15]]
grads:  [-0.09969892]
Stock Position:  -0.09969891673167361
Bond Position:  [1.02308767]


portfolio before change:  [-8.85276096]
curr_Stock_Price:  99.05737089075649
curr_Factors:  [99.05737089]
mat_Sqrt:  [[0.15]]
grads:  [0.09289757]
Stock Position:  0.09289756927727032
Bond Position:  [-18.05494994]


portfolio before change:  [-8.86988963]
curr_Stock_Price:  98.88513605396787
curr_Factors:  [98.88513605]
mat_Sqrt:  [[0.15]]
grads:  [0.02778648]
Stock Position:  0.027786484235071275
Bond Position:  [-11.6175599]


portfolio before change:  [-8.8931717]
curr_Stock_Price:  98.07337612259624
curr_Factors:  [98.07337612]
mat_Sqrt:  [[0.15]]
grads:  [0.02611108]
Stock Position:  0.02611108134376208
Bond Position:  [-11.4539736]


portfolio before change:  [-8.89347942]
curr_Stock_Price:  98.08900840803032
curr_Factors:  [98.08900841]
mat_Sqrt:  [[0.15]]
grads:  [-0.10155363]
Stock Position:  -0.10155362746610787
Bond Position:  [1.0678152]


portfolio before change:  [-8.90154036]
curr_Stock_Price:  98.16904181160753
curr_Factors:  [98.16904181]
mat_Sqrt:  [[0.15]]
grads:  [-0.08430038]
Stock Position:  -0.08430038318331295
Bond Position:  [-0.62585252]


portfolio before change:  [-8.95367193]
curr_Stock_Price:  98.78698023531916
curr_Factors:  [98.78698024]
mat_Sqrt:  [[0.15]]
grads:  [-0.00945143]
Stock Position:  -0.009451427268473577
Bond Position:  [-8.01999397]


portfolio before change:  [-8.96219965]
curr_Stock_Price:  99.63621276654084
curr_Factors:  [99.63621277]
mat_Sqrt:  [[0.15]]
grads:  [-0.08261951]
Stock Position:  -0.08261951256749868
Bond Position:  [-0.73030432]


portfolio before change:  [-9.0497868]
curr_Stock_Price:  100.69578692021324
curr_Factors:  [100.69578692]
mat_Sqrt:  [[0.15]]
grads:  [0.23137903]
Stock Position:  0.23137903238316448
Bond Position:  [-32.34868054]


portfolio before change:  [-9.03750283]
curr_Stock_Price:  100.75761543329627
curr_Factors:  [100.75761543]
mat_Sqrt:  [[0.15]]
grads:  [0.13687755]
Stock Position:  0.13687754875599004
Bond Position:  [-22.82895825]


portfolio before change:  [-9.04580362]
curr_Stock_Price:  100.7073958589427
curr_Factors:  [100.70739586]
mat_Sqrt:  [[0.15]]
grads:  [0.01446449]
Stock Position:  0.0144644930320292
Bond Position:  [-10.50248504]


portfolio before change:  [-9.05544978]
curr_Stock_Price:  100.0858919217158
curr_Factors:  [100.08589192]
mat_Sqrt:  [[0.15]]
grads:  [0.04070183]
Stock Position:  0.04070182842974801
Bond Position:  [-13.12912858]


portfolio before change:  [-9.0859213]
curr_Stock_Price:  99.35740093307099
curr_Factors:  [99.35740093]
mat_Sqrt:  [[0.15]]
grads:  [-0.09887901]
Stock Position:  -0.09887900779959995
Bond Position:  [0.73843993]


portfolio before change:  [-9.20027889]
curr_Stock_Price:  100.51440834237125
curr_Factors:  [100.51440834]
mat_Sqrt:  [[0.15]]
grads:  [-0.04527569]
Stock Position:  -0.04527568576346026
Bond Position:  [-4.64942012]


portfolio before change:  [-9.19646237]
curr_Stock_Price:  100.42369491902565
curr_Factors:  [100.42369492]
mat_Sqrt:  [[0.15]]
grads:  [-0.01140629]
Stock Position:  -0.011406290333496459
Bond Position:  [-8.05100055]


portfolio before change:  [-9.19295407]
curr_Stock_Price:  100.07200273787865
curr_Factors:  [100.07200274]
mat_Sqrt:  [[0.15]]
grads:  [0.01377126]
Stock Position:  0.013771261484356414
Bond Position:  [-10.57107179]


portfolio before change:  [-9.19731081]
curr_Stock_Price:  99.80361617464185
curr_Factors:  [99.80361617]
mat_Sqrt:  [[0.15]]
grads:  [0.05870721]
Stock Position:  0.0587072086220918
Bond Position:  [-15.05650252]


portfolio before change:  [-9.22424931]
curr_Stock_Price:  99.36078389072362
curr_Factors:  [99.36078389]
mat_Sqrt:  [[0.15]]
grads:  [0.07905243]
Stock Position:  0.07905242631374923
Bond Position:  [-17.07896036]


portfolio before change:  [-9.17990494]
curr_Stock_Price:  99.93523615855325
curr_Factors:  [99.93523616]
mat_Sqrt:  [[0.15]]
grads:  [-0.05523831]
Stock Position:  -0.055238310789469974
Bond Position:  [-3.6596513]


portfolio before change:  [-9.1979087]
curr_Stock_Price:  100.25702424639167
curr_Factors:  [100.25702425]
mat_Sqrt:  [[0.15]]
grads:  [-0.00893002]
Stock Position:  -0.008930018902946561
Bond Position:  [-8.30261158]


portfolio before change:  [-9.19351628]
curr_Stock_Price:  99.70704231218146
curr_Factors:  [99.70704231]
mat_Sqrt:  [[0.15]]
grads:  [-0.05806094]
Stock Position:  -0.05806093700359924
Bond Position:  [-3.40443198]


portfolio before change:  [-9.23513739]
curr_Stock_Price:  100.42022963691463
curr_Factors:  [100.42022964]
mat_Sqrt:  [[0.15]]
grads:  [0.02876974]
Stock Position:  0.028769742295463054
Bond Position:  [-12.12420152]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.23513739]
Stock Price:  100.96052751832346
PL:  [-10.19566491]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.11363868e-02]
 [-1.35580926e-03]
 [ 4.47886942e-03]
 [ 3.43155951e-03]
 [-8.77687197e-03]
 [ 1.22075521e-02]
 [-1.05305314e-03]
 [ 2.52836575e-02]
 [-1.77845119e-02]
 [ 8.59208550e-02]
 [ 9.82332993e-03]
 [-1.52134636e-02]
 [ 5.39707489e-02]
 [ 4.57160662e-02]
 [-1.54137211e-02]
 [-4.43038129e-03]
 [ 2.27941275e-02]
 [ 1.26633410e-02]
 [-1.64719313e-02]
 [-4.09363539e-03]
 [ 1.54995487e-02]
 [-1.02346231e-02]
 [ 5.88340686e-03]
 [-4.01845885e-03]
 [ 1.64977510e-02]
 [ 1.63755143e-02]
 [ 1.24930711e-02]
 [ 1.53050033e-03]
 [ 3.46435162e-03]
 [-2.80237332e-02]
 [-5.28304378e-03]
 [ 3.62833819e-02]
 [ 6.52287758e-03]
 [-4.59707725e-03]
 [-3.77066352e-03]
 [-3.91482511e-03]
 [-6.81830000e-03]
 [ 4.80531740e-03]
 [ 1.27764995e-03]
 [-8.66128487e-03]
 [-3.05096405e-02]
 [-3.22235269e-03]
 [ 1.39641071e-02]
 [-1.26074055e-02]
 [-8.37261261e-04]
 [ 2.50155117e-03]
 [-1.36129842e-02]
 [ 2.52517698e-03]
 [ 6.55691622e-03]
 [-8.06650343e-03]
 [-3.61260273e-03]
 [ 3.48733787e-03]
 [ 1.59237671e-03]
 [ 1.90999778e-03]
 [-5.76915921e-03]
 [ 9.10453953e-03]
 [-1.01040579e-02]
 [-9.78746897e-03]
 [ 1.63866609e-02]
 [ 5.63066873e-04]
 [ 1.27611701e-02]
 [-1.48854160e-02]
 [-1.27556940e-02]
 [-3.33850943e-03]
 [ 2.42096924e-02]
 [-1.80015791e-02]
 [ 2.22122069e-02]
 [ 3.40460473e-03]
 [ 9.41201385e-03]
 [-1.78300960e-02]
 [-7.85751030e-03]
 [-7.97945254e-03]
 [ 2.01927983e-03]
 [ 7.32706786e-03]
 [-7.94617188e-04]
 [-1.30262052e-02]
 [ 5.60385756e-03]
 [-4.26155606e-03]
 [ 2.37777732e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.06232203]
curr_Stock_Price:  100.19254683625279
curr_Factors:  [100.19254684]
mat_Sqrt:  [[0.15]]
grads:  [-0.27424258]
Stock Position:  -0.2742425787963873
Bond Position:  [32.53938445]


portfolio before change:  [4.97489878]
curr_Stock_Price:  100.51874353082134
curr_Factors:  [100.51874353]
mat_Sqrt:  [[0.15]]
grads:  [-0.00903873]
Stock Position:  -0.009038728431063145
Bond Position:  [5.8834604]


portfolio before change:  [4.96973557]
curr_Stock_Price:  101.13065892113747
curr_Factors:  [101.13065892]
mat_Sqrt:  [[0.15]]
grads:  [0.02985913]
Stock Position:  0.029859129448863594
Bond Position:  [1.95006213]


portfolio before change:  [4.99316182]
curr_Stock_Price:  101.91113602807148
curr_Factors:  [101.91113603]
mat_Sqrt:  [[0.15]]
grads:  [0.02287706]
Stock Position:  0.022877063433207882
Bond Position:  [2.6617343]


portfolio before change:  [5.0124502]
curr_Stock_Price:  102.74699579983118
curr_Factors:  [102.7469958]
mat_Sqrt:  [[0.15]]
grads:  [-0.05851248]
Stock Position:  -0.05851247978297728
Bond Position:  [11.02443172]


portfolio before change:  [5.00674792]
curr_Stock_Price:  102.85622592576546
curr_Factors:  [102.85622593]
mat_Sqrt:  [[0.15]]
grads:  [0.08138368]
Stock Position:  0.08138368049811713
Bond Position:  [-3.3640703]


portfolio before change:  [5.06530153]
curr_Stock_Price:  103.57828549865313
curr_Factors:  [103.5782855]
mat_Sqrt:  [[0.15]]
grads:  [-0.00702035]
Stock Position:  -0.007020354272771112
Bond Position:  [5.79245779]


portfolio before change:  [5.06890022]
curr_Stock_Price:  103.11724755818102
curr_Factors:  [103.11724756]
mat_Sqrt:  [[0.15]]
grads:  [0.16855772]
Stock Position:  0.16855771666449146
Bond Position:  [-12.31230758]


portfolio before change:  [5.054613]
curr_Stock_Price:  103.03705146370699
curr_Factors:  [103.03705146]
mat_Sqrt:  [[0.15]]
grads:  [-0.11856341]
Stock Position:  -0.11856341277928291
Bond Position:  [17.27103747]


portfolio before change:  [4.87624608]
curr_Stock_Price:  104.55055712931586
curr_Factors:  [104.55055713]
mat_Sqrt:  [[0.15]]
grads:  [0.5728057]
Stock Position:  0.5728057001951176
Bond Position:  [-55.010909]


portfolio before change:  [4.67722042]
curr_Stock_Price:  104.20910213553164
curr_Factors:  [104.20910214]
mat_Sqrt:  [[0.15]]
grads:  [0.06548887]
Stock Position:  0.06548886617689603
Bond Position:  [-2.14731552]


portfolio before change:  [4.64719008]
curr_Stock_Price:  103.75259504329445
curr_Factors:  [103.75259504]
mat_Sqrt:  [[0.15]]
grads:  [-0.10142309]
Stock Position:  -0.10142309040342415
Bond Position:  [15.17009891]


portfolio before change:  [4.54943637]
curr_Stock_Price:  104.72576464313201
curr_Factors:  [104.72576464]
mat_Sqrt:  [[0.15]]
grads:  [0.35980499]
Stock Position:  0.3598049929187588
Bond Position:  [-33.13141663]


portfolio before change:  [4.73223495]
curr_Stock_Price:  105.239568960489
curr_Factors:  [105.23956896]
mat_Sqrt:  [[0.15]]
grads:  [0.30477377]
Stock Position:  0.30477377487977386
Bond Position:  [-27.34202574]


portfolio before change:  [4.63838432]
curr_Stock_Price:  104.9372407775638
curr_Factors:  [104.93724078]
mat_Sqrt:  [[0.15]]
grads:  [-0.10275814]
Stock Position:  -0.10275814090878442
Bond Position:  [15.4215401]


portfolio before change:  [4.64349971]
curr_Stock_Price:  104.89683996583405
curr_Factors:  [104.89683997]
mat_Sqrt:  [[0.15]]
grads:  [-0.02953588]
Stock Position:  -0.029535875253752678
Bond Position:  [7.74171969]


portfolio before change:  [4.63386921]
curr_Stock_Price:  105.23928373510688
curr_Factors:  [105.23928374]
mat_Sqrt:  [[0.15]]
grads:  [0.15196085]
Stock Position:  0.1519608499466046
Bond Position:  [-11.3583818]


portfolio before change:  [4.66766186]
curr_Stock_Price:  105.46633280286231
curr_Factors:  [105.4663328]
mat_Sqrt:  [[0.15]]
grads:  [0.08442227]
Stock Position:  0.08442227342682891
Bond Position:  [-4.23604573]


portfolio before change:  [4.56918532]
curr_Stock_Price:  104.30299313331463
curr_Factors:  [104.30299313]
mat_Sqrt:  [[0.15]]
grads:  [-0.10981288]
Stock Position:  -0.1098128754678719
Bond Position:  [16.02299691]


portfolio before change:  [4.59806922]
curr_Stock_Price:  104.04908448716729
curr_Factors:  [104.04908449]
mat_Sqrt:  [[0.15]]
grads:  [-0.0272909]
Stock Position:  -0.02729090262182476
Bond Position:  [7.43766265]


portfolio before change:  [4.60516431]
curr_Stock_Price:  103.80613848847771
curr_Factors:  [103.80613849]
mat_Sqrt:  [[0.15]]
grads:  [0.10333032]
Stock Position:  0.1033303244972777
Bond Position:  [-6.12115767]


portfolio before change:  [4.60099104]
curr_Stock_Price:  103.76945344383495
curr_Factors:  [103.76945344]
mat_Sqrt:  [[0.15]]
grads:  [-0.06823082]
Stock Position:  -0.06823082061524119
Bond Position:  [11.68126601]


portfolio before change:  [4.67353783]
curr_Stock_Price:  102.71689861541172
curr_Factors:  [102.71689862]
mat_Sqrt:  [[0.15]]
grads:  [0.03922271]
Stock Position:  0.03922271241672432
Bond Position:  [0.64470245]


portfolio before change:  [4.65550039]
curr_Stock_Price:  102.25599898522981
curr_Factors:  [102.25599899]
mat_Sqrt:  [[0.15]]
grads:  [-0.02678973]
Stock Position:  -0.026789725683527336
Bond Position:  [7.39491055]


portfolio before change:  [4.67318126]
curr_Stock_Price:  101.61326473809456
curr_Factors:  [101.61326474]
mat_Sqrt:  [[0.15]]
grads:  [0.10998501]
Stock Position:  0.10998500684688199
Bond Position:  [-6.50275436]


portfolio before change:  [4.69094501]
curr_Stock_Price:  101.77847080462439
curr_Factors:  [101.7784708]
mat_Sqrt:  [[0.15]]
grads:  [0.1091701]
Stock Position:  0.10917009526298915
Bond Position:  [-6.42022034]


portfolio before change:  [4.60798511]
curr_Stock_Price:  101.02223229604019
curr_Factors:  [101.0222323]
mat_Sqrt:  [[0.15]]
grads:  [0.08328714]
Stock Position:  0.08328714088691891
Bond Position:  [-3.80586779]


portfolio before change:  [4.55502245]
curr_Stock_Price:  100.38918396320264
curr_Factors:  [100.38918396]
mat_Sqrt:  [[0.15]]
grads:  [0.01020334]
Stock Position:  0.010203335538282987
Bond Position:  [3.53071792]


portfolio before change:  [4.55781668]
curr_Stock_Price:  100.64141129100878
curr_Factors:  [100.64141129]
mat_Sqrt:  [[0.15]]
grads:  [0.02309568]
Stock Position:  0.02309567745516732
Bond Position:  [2.23343511]


portfolio before change:  [4.56403043]
curr_Stock_Price:  100.90441057772394
curr_Factors:  [100.90441058]
mat_Sqrt:  [[0.15]]
grads:  [-0.18682489]
Stock Position:  -0.1868248880720614
Bond Position:  [23.41548564]


portfolio before change:  [4.48491107]
curr_Stock_Price:  101.33573891845398
curr_Factors:  [101.33573892]
mat_Sqrt:  [[0.15]]
grads:  [-0.03522029]
Stock Position:  -0.035220291848656736
Bond Position:  [8.05398537]


portfolio before change:  [4.43541696]
curr_Stock_Price:  102.75530421959378
curr_Factors:  [102.75530422]
mat_Sqrt:  [[0.15]]
grads:  [0.24188921]
Stock Position:  0.24188921252075668
Bond Position:  [-20.41998266]


portfolio before change:  [4.42018311]
curr_Stock_Price:  102.69760195389995
curr_Factors:  [102.69760195]
mat_Sqrt:  [[0.15]]
grads:  [0.04348585]
Stock Position:  0.04348585053236941
Bond Position:  [-0.04570946]


portfolio before change:  [4.43367199]
curr_Stock_Price:  103.00785768505155
curr_Factors:  [103.00785769]
mat_Sqrt:  [[0.15]]
grads:  [-0.03064718]
Stock Position:  -0.030647181646102983
Bond Position:  [7.59057251]


portfolio before change:  [4.46182494]
curr_Stock_Price:  102.10472337691156
curr_Factors:  [102.10472338]
mat_Sqrt:  [[0.15]]
grads:  [-0.02513776]
Stock Position:  -0.02513775682873325
Bond Position:  [7.02850864]


portfolio before change:  [4.44699255]
curr_Stock_Price:  102.7122428571245
curr_Factors:  [102.71224286]
mat_Sqrt:  [[0.15]]
grads:  [-0.02609883]
Stock Position:  -0.026098834099030407
Bond Position:  [7.12766234]


portfolio before change:  [4.45686885]
curr_Stock_Price:  102.35089321901148
curr_Factors:  [102.35089322]
mat_Sqrt:  [[0.15]]
grads:  [-0.04545533]
Stock Position:  -0.045455333324319364
Bond Position:  [9.10926282]


portfolio before change:  [4.46905695]
curr_Stock_Price:  102.09528513364252
curr_Factors:  [102.09528513]
mat_Sqrt:  [[0.15]]
grads:  [0.03203545]
Stock Position:  0.03203544936616547
Bond Position:  [1.19838861]


portfolio before change:  [4.46944481]
curr_Stock_Price:  102.10505443662355
curr_Factors:  [102.10505444]
mat_Sqrt:  [[0.15]]
grads:  [0.00851767]
Stock Position:  0.008517666348192846
Bond Position:  [3.59974803]


portfolio before change:  [4.47100953]
curr_Stock_Price:  102.26234223311162
curr_Factors:  [102.26234223]
mat_Sqrt:  [[0.15]]
grads:  [-0.0577419]
Stock Position:  -0.05774189912353658
Bond Position:  [10.37583138]


portfolio before change:  [4.45702777]
curr_Stock_Price:  102.51571583076141
curr_Factors:  [102.51571583]
mat_Sqrt:  [[0.15]]
grads:  [-0.2033976]
Stock Position:  -0.20339760322436895
Bond Position:  [25.30847866]


portfolio before change:  [4.2727221]
curr_Stock_Price:  103.42962778368833
curr_Factors:  [103.42962778]
mat_Sqrt:  [[0.15]]
grads:  [-0.02148235]
Stock Position:  -0.02148235123697928
Bond Position:  [6.49463369]


portfolio before change:  [4.27236303]
curr_Stock_Price:  103.46523820161167
curr_Factors:  [103.4652382]
mat_Sqrt:  [[0.15]]
grads:  [0.09309405]
Stock Position:  0.09309404764300021
Bond Position:  [-5.35963479]


portfolio before change:  [4.26293957]
curr_Stock_Price:  103.36761145020391
curr_Factors:  [103.36761145]
mat_Sqrt:  [[0.15]]
grads:  [-0.08404937]
Stock Position:  -0.08404937007456866
Bond Position:  [12.9509222]


portfolio before change:  [4.29488096]
curr_Stock_Price:  102.997210963382
curr_Factors:  [102.99721096]
mat_Sqrt:  [[0.15]]
grads:  [-0.00558174]
Stock Position:  -0.0055817417418875526
Bond Position:  [4.86978479]


portfolio before change:  [4.29207315]
curr_Stock_Price:  103.55477424991408
curr_Factors:  [103.55477425]
mat_Sqrt:  [[0.15]]
grads:  [0.01667701]
Stock Position:  0.01667700778150525
Bond Position:  [2.56508938]


portfolio before change:  [4.29487112]
curr_Stock_Price:  103.71293464967677
curr_Factors:  [103.71293465]
mat_Sqrt:  [[0.15]]
grads:  [-0.09075323]
Stock Position:  -0.09075322794345235
Bond Position:  [13.70715472]


portfolio before change:  [4.36850683]
curr_Stock_Price:  102.91099081905757
curr_Factors:  [102.91099082]
mat_Sqrt:  [[0.15]]
grads:  [0.01683451]
Stock Position:  0.01683451321938985
Bond Position:  [2.6360504]


portfolio before change:  [4.37262826]
curr_Stock_Price:  103.14602418839928
curr_Factors:  [103.14602419]
mat_Sqrt:  [[0.15]]
grads:  [0.04371277]
Stock Position:  0.04371277480602212
Bond Position:  [-0.13617066]


portfolio before change:  [4.3726208]
curr_Stock_Price:  103.1460480364419
curr_Factors:  [103.14604804]
mat_Sqrt:  [[0.15]]
grads:  [-0.05377669]
Stock Position:  -0.0537766895547476
Bond Position:  [9.9194738]


portfolio before change:  [4.36705221]
curr_Stock_Price:  103.26112712708223
curr_Factors:  [103.26112713]
mat_Sqrt:  [[0.15]]
grads:  [-0.02408402]
Stock Position:  -0.02408401818756546
Bond Position:  [6.85399507]


portfolio before change:  [4.37859082]
curr_Stock_Price:  102.7998161707507
curr_Factors:  [102.79981617]
mat_Sqrt:  [[0.15]]
grads:  [0.02324892]
Stock Position:  0.02324891912507903
Bond Position:  [1.98860621]


portfolio before change:  [4.38320664]
curr_Stock_Price:  102.99300936313553
curr_Factors:  [102.99300936]
mat_Sqrt:  [[0.15]]
grads:  [0.01061584]
Stock Position:  0.010615844744641743
Bond Position:  [3.28984885]


portfolio before change:  [4.38930802]
curr_Stock_Price:  103.54838222273914
curr_Factors:  [103.54838222]
mat_Sqrt:  [[0.15]]
grads:  [0.01273332]
Stock Position:  0.01273331853929453
Bond Position:  [3.07079348]


portfolio before change:  [4.38921201]
curr_Stock_Price:  103.52576938152698
curr_Factors:  [103.52576938]
mat_Sqrt:  [[0.15]]
grads:  [-0.03846106]
Stock Position:  -0.03846106142239805
Bond Position:  [8.37092299]


portfolio before change:  [4.41440471]
curr_Stock_Price:  102.88435453652872
curr_Factors:  [102.88435454]
mat_Sqrt:  [[0.15]]
grads:  [0.06069693]
Stock Position:  0.060696930188630406
Bond Position:  [-1.83035978]


portfolio before change:  [4.46930867]
curr_Stock_Price:  103.79079848607212
curr_Factors:  [103.79079849]
mat_Sqrt:  [[0.15]]
grads:  [-0.06736039]
Stock Position:  -0.06736038593341642
Bond Position:  [11.46069691]


portfolio before change:  [4.47271242]
curr_Stock_Price:  103.75090206277766
curr_Factors:  [103.75090206]
mat_Sqrt:  [[0.15]]
grads:  [-0.06524979]
Stock Position:  -0.06524979311513515
Bond Position:  [11.24243732]


portfolio before change:  [4.45735896]
curr_Stock_Price:  103.99697395673611
curr_Factors:  [103.99697396]
mat_Sqrt:  [[0.15]]
grads:  [0.10924441]
Stock Position:  0.10924440570539164
Bond Position:  [-6.90372866]


portfolio before change:  [4.40439898]
curr_Stock_Price:  103.51613945603202
curr_Factors:  [103.51613946]
mat_Sqrt:  [[0.15]]
grads:  [0.00375378]
Stock Position:  0.0037537791555436752
Bond Position:  [4.01582226]


portfolio before change:  [4.4057223]
curr_Stock_Price:  103.80180352732803
curr_Factors:  [103.80180353]
mat_Sqrt:  [[0.15]]
grads:  [0.08507447]
Stock Position:  0.0850744674555076
Bond Position:  [-4.42516086]


portfolio before change:  [4.42803537]
curr_Stock_Price:  104.06733146905236
curr_Factors:  [104.06733147]
mat_Sqrt:  [[0.15]]
grads:  [-0.09923611]
Stock Position:  -0.09923610642186217
Bond Position:  [14.75527215]


portfolio before change:  [4.39709903]
curr_Stock_Price:  104.38836957170837
curr_Factors:  [104.38836957]
mat_Sqrt:  [[0.15]]
grads:  [-0.08503796]
Stock Position:  -0.08503796025716855
Bond Position:  [13.27407305]


portfolio before change:  [4.41522507]
curr_Stock_Price:  104.18497356828875
curr_Factors:  [104.18497357]
mat_Sqrt:  [[0.15]]
grads:  [-0.02225673]
Stock Position:  -0.022256729541722062
Bond Position:  [6.73404184]


portfolio before change:  [4.41637535]
curr_Stock_Price:  104.15220174028198
curr_Factors:  [104.15220174]
mat_Sqrt:  [[0.15]]
grads:  [0.16139795]
Stock Position:  0.1613979496065763
Bond Position:  [-12.39357646]


portfolio before change:  [4.3825923]
curr_Stock_Price:  103.94768596980863
curr_Factors:  [103.94768597]
mat_Sqrt:  [[0.15]]
grads:  [-0.12001053]
Stock Position:  -0.12001052748778385
Bond Position:  [16.85740893]


portfolio before change:  [4.40895282]
curr_Stock_Price:  103.73681368682274
curr_Factors:  [103.73681369]
mat_Sqrt:  [[0.15]]
grads:  [0.14808138]
Stock Position:  0.14808137960971823
Bond Position:  [-10.95253767]


portfolio before change:  [4.37112118]
curr_Stock_Price:  103.48595782416776
curr_Factors:  [103.48595782]
mat_Sqrt:  [[0.15]]
grads:  [0.02269736]
Stock Position:  0.02269736486269131
Bond Position:  [2.02226264]


portfolio before change:  [4.37535337]
curr_Stock_Price:  103.6668508249556
curr_Factors:  [103.66685082]
mat_Sqrt:  [[0.15]]
grads:  [0.06274676]
Stock Position:  0.0627467590092539
Bond Position:  [-2.12940554]


portfolio before change:  [4.3369655]
curr_Stock_Price:  103.05718138390735
curr_Factors:  [103.05718138]
mat_Sqrt:  [[0.15]]
grads:  [-0.11886731]
Stock Position:  -0.11886730648897426
Bond Position:  [16.58709506]


portfolio before change:  [4.43686316]
curr_Stock_Price:  102.22548983763244
curr_Factors:  [102.22548984]
mat_Sqrt:  [[0.15]]
grads:  [-0.0523834]
Stock Position:  -0.05238340202194547
Bond Position:  [9.79178209]


portfolio before change:  [4.43500581]
curr_Stock_Price:  102.27262982857722
curr_Factors:  [102.27262983]
mat_Sqrt:  [[0.15]]
grads:  [-0.05319635]
Stock Position:  -0.053196350264539234
Bond Position:  [9.87553645]


portfolio before change:  [4.42409678]
curr_Stock_Price:  102.4893037939482
curr_Factors:  [102.48930379]
mat_Sqrt:  [[0.15]]
grads:  [0.01346187]
Stock Position:  0.013461865544564366
Bond Position:  [3.04439956]


portfolio before change:  [4.43400755]
curr_Stock_Price:  103.21137967903695
curr_Factors:  [103.21137968]
mat_Sqrt:  [[0.15]]
grads:  [0.04884712]
Stock Position:  0.048847119046188804
Bond Position:  [-0.607571]


portfolio before change:  [4.42905586]
curr_Stock_Price:  103.11078589279045
curr_Factors:  [103.11078589]
mat_Sqrt:  [[0.15]]
grads:  [-0.00529745]
Stock Position:  -0.005297447921264997
Bond Position:  [4.97527988]


portfolio before change:  [4.43251663]
curr_Stock_Price:  102.51619753735878
curr_Factors:  [102.51619754]
mat_Sqrt:  [[0.15]]
grads:  [-0.08684137]
Stock Position:  -0.08684136829295593
Bond Position:  [13.33516349]


portfolio before change:  [4.43148563]
curr_Stock_Price:  102.53766737012042
curr_Factors:  [102.53766737]
mat_Sqrt:  [[0.15]]
grads:  [0.03735905]
Stock Position:  0.03735905042802006
Bond Position:  [0.60077575]


portfolio before change:  [4.43646448]
curr_Stock_Price:  102.66993239708098
curr_Factors:  [102.6699324]
mat_Sqrt:  [[0.15]]
grads:  [-0.02841037]
Stock Position:  -0.028410373765443028
Bond Position:  [7.35335563]


portfolio before change:  [4.42208069]
curr_Stock_Price:  103.19239605455684
curr_Factors:  [103.19239605]
mat_Sqrt:  [[0.15]]
grads:  [0.15851849]
Stock Position:  0.15851848827101075
Bond Position:  [-11.93582194]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.42208069]
Stock Price:  102.69902136488864
PL:  [1.72305932]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.69330711e-02]
 [ 5.12372559e-03]
 [-4.18635224e-04]
 [ 1.86296967e-03]
 [ 1.43891980e-02]
 [ 1.18309643e-02]
 [ 1.14154651e-03]
 [ 1.01750624e-02]
 [ 9.19195650e-03]
 [-2.02895996e-02]
 [ 9.65221785e-03]
 [-5.25481124e-03]
 [-3.72033320e-03]
 [ 4.33400297e-03]
 [ 7.20578849e-04]
 [ 8.37374809e-03]
 [-6.40596352e-04]
 [ 7.62353384e-03]
 [ 2.41681128e-02]
 [ 3.45866955e-03]
 [ 7.92038711e-02]
 [-1.42085173e-02]
 [-1.89311648e-03]
 [ 5.99851737e-03]
 [ 1.50009360e-02]
 [-7.93762940e-03]
 [ 1.33012813e-02]
 [ 7.75426761e-04]
 [ 2.85091579e-03]
 [-1.86507037e-02]
 [-3.98614098e-03]
 [-2.05581931e-02]
 [ 1.54681191e-02]
 [ 1.97750858e-02]
 [-1.00706598e-02]
 [ 4.00483011e-03]
 [-2.31548425e-03]
 [ 1.13444255e-02]
 [ 5.37564847e-04]
 [-1.37272546e-02]
 [-1.11449347e-03]
 [-2.85672731e-03]
 [ 9.84983480e-03]
 [-1.35384404e-02]
 [ 5.48649824e-04]
 [ 2.23361827e-03]
 [-1.36776742e-02]
 [-2.37018856e-03]
 [ 2.55087910e-03]
 [-1.13503375e-03]
 [-3.15957259e-03]
 [ 3.68934833e-03]
 [ 1.23971999e-03]
 [ 2.89719792e-03]
 [-2.32324551e-03]
 [ 9.20239871e-03]
 [-7.03001985e-03]
 [-1.38351675e-02]
 [ 1.38243043e-02]
 [ 3.82527272e-03]
 [ 1.22858447e-02]
 [-1.52892979e-02]
 [-1.27511182e-02]
 [-3.30024437e-03]
 [-8.12783133e-03]
 [-3.48538531e-03]
 [ 2.69518901e-02]
 [ 3.47431232e-03]
 [ 8.54484023e-03]
 [-2.39487836e-02]
 [-8.00875533e-03]
 [-6.26132084e-03]
 [ 1.02551314e-02]
 [ 6.79338411e-03]
 [-6.39714934e-04]
 [-4.82114122e-03]
 [ 8.43045647e-03]
 [-3.88028114e-03]
 [ 2.48913485e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.16026964]
curr_Stock_Price:  99.27845148848246
curr_Factors:  [99.27845149]
mat_Sqrt:  [[0.15]]
grads:  [-0.24622047]
Stock Position:  -0.24622047382387538
Bond Position:  [15.28411773]


portfolio before change:  [-9.11841983]
curr_Stock_Price:  99.11236244617298
curr_Factors:  [99.11236245]
mat_Sqrt:  [[0.15]]
grads:  [0.03415817]
Stock Position:  0.03415817060008729
Bond Position:  [-12.50391682]


portfolio before change:  [-9.11099294]
curr_Stock_Price:  99.35266830699952
curr_Factors:  [99.35266831]
mat_Sqrt:  [[0.15]]
grads:  [-0.0027909]
Stock Position:  -0.0027909014909941895
Bond Position:  [-8.83370943]


portfolio before change:  [-9.11260296]
curr_Stock_Price:  99.73171880182022
curr_Factors:  [99.7317188]
mat_Sqrt:  [[0.15]]
grads:  [0.0124198]
Stock Position:  0.012419797818836998
Bond Position:  [-10.35125074]


portfolio before change:  [-9.10723072]
curr_Stock_Price:  100.21636496210621
curr_Factors:  [100.21636496]
mat_Sqrt:  [[0.15]]
grads:  [0.09592799]
Stock Position:  0.0959279869224945
Bond Position:  [-18.72078487]


portfolio before change:  [-9.10200643]
curr_Stock_Price:  100.2830230822741
curr_Factors:  [100.28302308]
mat_Sqrt:  [[0.15]]
grads:  [0.0788731]
Stock Position:  0.07887309502191332
Bond Position:  [-17.01163884]


portfolio before change:  [-9.12624324]
curr_Stock_Price:  99.98921510827802
curr_Factors:  [99.98921511]
mat_Sqrt:  [[0.15]]
grads:  [0.00761031]
Stock Position:  0.007610310068421868
Bond Position:  [-9.88719217]


portfolio before change:  [-9.125807]
curr_Stock_Price:  100.1277382136734
curr_Factors:  [100.12773821]
mat_Sqrt:  [[0.15]]
grads:  [0.06783375]
Stock Position:  0.06783374911654151
Bond Position:  [-15.91784687]


portfolio before change:  [-9.11926799]
curr_Stock_Price:  100.23880257472851
curr_Factors:  [100.23880257]
mat_Sqrt:  [[0.15]]
grads:  [0.06127971]
Stock Position:  0.061279710030747704
Bond Position:  [-15.26187274]


portfolio before change:  [-9.10163873]
curr_Stock_Price:  100.542053949522
curr_Factors:  [100.54205395]
mat_Sqrt:  [[0.15]]
grads:  [-0.135264]
Stock Position:  -0.13526399731070515
Bond Position:  [4.49808139]


portfolio before change:  [-9.04129682]
curr_Stock_Price:  100.09802766710727
curr_Factors:  [100.09802767]
mat_Sqrt:  [[0.15]]
grads:  [0.06434812]
Stock Position:  0.06434811896719604
Bond Position:  [-15.48241661]


portfolio before change:  [-9.03120554]
curr_Stock_Price:  100.26988909695973
curr_Factors:  [100.2698891]
mat_Sqrt:  [[0.15]]
grads:  [-0.03503207]
Stock Position:  -0.035032074949920874
Bond Position:  [-5.51854327]


portfolio before change:  [-9.03705056]
curr_Stock_Price:  100.42689108466847
curr_Factors:  [100.42689108]
mat_Sqrt:  [[0.15]]
grads:  [-0.02480222]
Stock Position:  -0.02480222134301971
Bond Position:  [-6.54624058]


portfolio before change:  [-9.02861684]
curr_Stock_Price:  100.07035525472689
curr_Factors:  [100.07035525]
mat_Sqrt:  [[0.15]]
grads:  [0.02889335]
Stock Position:  0.028893353146176595
Bond Position:  [-11.91998495]


portfolio before change:  [-9.04744443]
curr_Stock_Price:  99.44451671384904
curr_Factors:  [99.44451671]
mat_Sqrt:  [[0.15]]
grads:  [0.00480386]
Stock Position:  0.0048038589906611775
Bond Position:  [-9.52516187]


portfolio before change:  [-9.04804875]
curr_Stock_Price:  99.44264792776357
curr_Factors:  [99.44264793]
mat_Sqrt:  [[0.15]]
grads:  [0.05582499]
Stock Position:  0.055824987289023464
Bond Position:  [-14.59943331]


portfolio before change:  [-9.0724444]
curr_Stock_Price:  99.02199126170231
curr_Factors:  [99.02199126]
mat_Sqrt:  [[0.15]]
grads:  [-0.00427064]
Stock Position:  -0.004270642348402466
Bond Position:  [-8.64955689]


portfolio before change:  [-9.07504053]
curr_Stock_Price:  99.50330600593053
curr_Factors:  [99.50330601]
mat_Sqrt:  [[0.15]]
grads:  [0.05082356]
Stock Position:  0.050823558947087275
Bond Position:  [-14.13215267]


portfolio before change:  [-9.06389199]
curr_Stock_Price:  99.74004321235327
curr_Factors:  [99.74004321]
mat_Sqrt:  [[0.15]]
grads:  [0.16112075]
Stock Position:  0.1611207522703095
Bond Position:  [-25.13408279]


portfolio before change:  [-8.97568969]
curr_Stock_Price:  100.29722305181889
curr_Factors:  [100.29722305]
mat_Sqrt:  [[0.15]]
grads:  [0.0230578]
Stock Position:  0.023057797003134036
Bond Position:  [-11.2883227]


portfolio before change:  [-8.9743338]
curr_Stock_Price:  100.38662601703167
curr_Factors:  [100.38662602]
mat_Sqrt:  [[0.15]]
grads:  [0.52802581]
Stock Position:  0.5280258074451841
Bond Position:  [-61.98106305]


portfolio before change:  [-9.1872888]
curr_Stock_Price:  99.99065849465526
curr_Factors:  [99.99065849]
mat_Sqrt:  [[0.15]]
grads:  [-0.09472345]
Stock Position:  -0.09472344850856447
Bond Position:  [0.28417119]


portfolio before change:  [-9.21156622]
curr_Stock_Price:  100.2471438260724
curr_Factors:  [100.24714383]
mat_Sqrt:  [[0.15]]
grads:  [-0.01262078]
Stock Position:  -0.012620776561794349
Bond Position:  [-7.94636941]


portfolio before change:  [-9.21730043]
curr_Stock_Price:  100.66213817679379
curr_Factors:  [100.66213818]
mat_Sqrt:  [[0.15]]
grads:  [0.03999012]
Stock Position:  0.039990115793434526
Bond Position:  [-13.24279099]


portfolio before change:  [-9.2067078]
curr_Stock_Price:  100.94771699821813
curr_Factors:  [100.947717]
mat_Sqrt:  [[0.15]]
grads:  [0.10000624]
Stock Position:  0.10000623967510648
Bond Position:  [-19.30210938]


portfolio before change:  [-9.28888444]
curr_Stock_Price:  100.13806528370267
curr_Factors:  [100.13806528]
mat_Sqrt:  [[0.15]]
grads:  [-0.05291753]
Stock Position:  -0.05291752931109124
Bond Position:  [-3.98982544]


portfolio before change:  [-9.29824122]
curr_Stock_Price:  100.31017094358435
curr_Factors:  [100.31017094]
mat_Sqrt:  [[0.15]]
grads:  [0.08867521]
Stock Position:  0.08867520856956307
Bond Position:  [-18.19326655]


portfolio before change:  [-9.26924969]
curr_Stock_Price:  100.64993495990532
curr_Factors:  [100.64993496]
mat_Sqrt:  [[0.15]]
grads:  [0.00516951]
Stock Position:  0.005169511740871653
Bond Position:  [-9.78956071]


portfolio before change:  [-9.27424828]
curr_Stock_Price:  99.80135903068205
curr_Factors:  [99.80135903]
mat_Sqrt:  [[0.15]]
grads:  [0.01900611]
Stock Position:  0.01900610529973258
Bond Position:  [-11.17108342]


portfolio before change:  [-9.27987574]
curr_Stock_Price:  99.54200859708766
curr_Factors:  [99.5420086]
mat_Sqrt:  [[0.15]]
grads:  [-0.12433802]
Stock Position:  -0.12433802454616015
Bond Position:  [3.09698097]


portfolio before change:  [-9.24960825]
curr_Stock_Price:  99.30013633486364
curr_Factors:  [99.30013633]
mat_Sqrt:  [[0.15]]
grads:  [-0.02657427]
Stock Position:  -0.02657427321901544
Bond Position:  [-6.6107793]


portfolio before change:  [-9.23877328]
curr_Stock_Price:  98.87686367814747
curr_Factors:  [98.87686368]
mat_Sqrt:  [[0.15]]
grads:  [-0.13705462]
Stock Position:  -0.1370546207822952
Bond Position:  [4.31275778]


portfolio before change:  [-9.23404073]
curr_Stock_Price:  98.84430007520064
curr_Factors:  [98.84430008]
mat_Sqrt:  [[0.15]]
grads:  [0.10312079]
Stock Position:  0.10312079423643739
Bond Position:  [-19.42694346]


portfolio before change:  [-9.21375047]
curr_Stock_Price:  99.05283686453855
curr_Factors:  [99.05283686]
mat_Sqrt:  [[0.15]]
grads:  [0.13183391]
Stock Position:  0.13183390557931932
Bond Position:  [-22.27227281]


portfolio before change:  [-9.19967448]
curr_Stock_Price:  99.17016667901706
curr_Factors:  [99.17016668]
mat_Sqrt:  [[0.15]]
grads:  [-0.06713773]
Stock Position:  -0.06713773213028358
Bond Position:  [-2.5416144]


portfolio before change:  [-9.21134387]
curr_Stock_Price:  99.34161320960783
curr_Factors:  [99.34161321]
mat_Sqrt:  [[0.15]]
grads:  [0.02669887]
Stock Position:  0.026698867395010296
Bond Position:  [-11.86365243]


portfolio before change:  [-9.20145036]
curr_Stock_Price:  99.7399450125951
curr_Factors:  [99.73994501]
mat_Sqrt:  [[0.15]]
grads:  [-0.01543656]
Stock Position:  -0.015436561645780928
Bond Position:  [-7.66180855]


portfolio before change:  [-9.19405558]
curr_Stock_Price:  99.22987921145916
curr_Factors:  [99.22987921]
mat_Sqrt:  [[0.15]]
grads:  [0.0756295]
Stock Position:  0.075629503170222
Bond Position:  [-16.69876204]


portfolio before change:  [-9.18250738]
curr_Stock_Price:  99.39637388648333
curr_Factors:  [99.39637389]
mat_Sqrt:  [[0.15]]
grads:  [0.00358377]
Stock Position:  0.0035837656434623494
Bond Position:  [-9.53872068]


portfolio before change:  [-9.18363465]
curr_Stock_Price:  99.24818161241184
curr_Factors:  [99.24818161]
mat_Sqrt:  [[0.15]]
grads:  [-0.09151503]
Stock Position:  -0.09151503090654751
Bond Position:  [-0.10093424]


portfolio before change:  [-9.26723916]
curr_Stock_Price:  100.16167306007237
curr_Factors:  [100.16167306]
mat_Sqrt:  [[0.15]]
grads:  [-0.00742996]
Stock Position:  -0.007429956445457256
Bond Position:  [-8.52304229]


portfolio before change:  [-9.27186444]
curr_Stock_Price:  100.71249429065145
curr_Factors:  [100.71249429]
mat_Sqrt:  [[0.15]]
grads:  [-0.01904485]
Stock Position:  -0.019044848752073185
Bond Position:  [-7.35381022]


portfolio before change:  [-9.2861774]
curr_Stock_Price:  101.43990001825614
curr_Factors:  [101.43990002]
mat_Sqrt:  [[0.15]]
grads:  [0.06566557]
Stock Position:  0.06566556531287307
Bond Position:  [-15.94728578]


portfolio before change:  [-9.29112531]
curr_Stock_Price:  101.37972890475287
curr_Factors:  [101.3797289]
mat_Sqrt:  [[0.15]]
grads:  [-0.09025627]
Stock Position:  -0.09025626956839476
Bond Position:  [-0.14096917]


portfolio before change:  [-9.34022413]
curr_Stock_Price:  101.923624718191
curr_Factors:  [101.92362472]
mat_Sqrt:  [[0.15]]
grads:  [0.00365767]
Stock Position:  0.0036576654922252008
Bond Position:  [-9.71302665]


portfolio before change:  [-9.34029289]
curr_Stock_Price:  102.0707995574997
curr_Factors:  [102.07079956]
mat_Sqrt:  [[0.15]]
grads:  [0.01489079]
Stock Position:  0.014890788461726999
Bond Position:  [-10.86020758]


portfolio before change:  [-9.3452897]
curr_Stock_Price:  101.78081991378824
curr_Factors:  [101.78081991]
mat_Sqrt:  [[0.15]]
grads:  [-0.09118449]
Stock Position:  -0.09118449445861226
Bond Position:  [-0.06445709]


portfolio before change:  [-9.36085699]
curr_Stock_Price:  101.95149874886644
curr_Factors:  [101.95149875]
mat_Sqrt:  [[0.15]]
grads:  [-0.01580126]
Stock Position:  -0.015801257086867884
Bond Position:  [-7.74989515]


portfolio before change:  [-9.36612326]
curr_Stock_Price:  102.25412521771783
curr_Factors:  [102.25412522]
mat_Sqrt:  [[0.15]]
grads:  [0.01700586]
Stock Position:  0.01700586064812776
Bond Position:  [-11.10504266]


portfolio before change:  [-9.37487326]
curr_Stock_Price:  101.7804111012243
curr_Factors:  [101.7804111]
mat_Sqrt:  [[0.15]]
grads:  [-0.00756689]
Stock Position:  -0.007566891651381054
Bond Position:  [-8.60471192]


portfolio before change:  [-9.37691205]
curr_Stock_Price:  101.97877249254212
curr_Factors:  [101.97877249]
mat_Sqrt:  [[0.15]]
grads:  [-0.02106382]
Stock Position:  -0.021063817256514825
Bond Position:  [-7.22884982]


portfolio before change:  [-9.37848231]
curr_Stock_Price:  102.03187022291408
curr_Factors:  [102.03187022]
mat_Sqrt:  [[0.15]]
grads:  [0.02459566]
Stock Position:  0.024595655529592416
Bond Position:  [-11.88802304]


portfolio before change:  [-9.36337582]
curr_Stock_Price:  102.67627312743517
curr_Factors:  [102.67627313]
mat_Sqrt:  [[0.15]]
grads:  [0.0082648]
Stock Position:  0.008264799900964388
Bond Position:  [-10.21197467]


portfolio before change:  [-9.36816263]
curr_Stock_Price:  102.17432066987212
curr_Factors:  [102.17432067]
mat_Sqrt:  [[0.15]]
grads:  [0.01931465]
Stock Position:  0.01931465279745173
Bond Position:  [-11.34162415]


portfolio before change:  [-9.36266485]
curr_Stock_Price:  102.49566464838747
curr_Factors:  [102.49566465]
mat_Sqrt:  [[0.15]]
grads:  [-0.0154883]
Stock Position:  -0.015488303399609315
Bond Position:  [-7.7751809]


portfolio before change:  [-9.37065761]
curr_Stock_Price:  102.98033968939129
curr_Factors:  [102.98033969]
mat_Sqrt:  [[0.15]]
grads:  [0.06134932]
Stock Position:  0.06134932471609892
Bond Position:  [-15.68843191]


portfolio before change:  [-9.39926072]
curr_Stock_Price:  102.53008937992782
curr_Factors:  [102.53008938]
mat_Sqrt:  [[0.15]]
grads:  [-0.0468668]
Stock Position:  -0.046866798982186396
Bond Position:  [-4.59400363]


portfolio before change:  [-9.38165029]
curr_Stock_Price:  102.14820785422553
curr_Factors:  [102.14820785]
mat_Sqrt:  [[0.15]]
grads:  [-0.09223445]
Stock Position:  -0.09223444970837393
Bond Position:  [0.03993345]


portfolio before change:  [-9.39550864]
curr_Stock_Price:  102.2984862701822
curr_Factors:  [102.29848627]
mat_Sqrt:  [[0.15]]
grads:  [0.09216203]
Stock Position:  0.09216202896320651
Bond Position:  [-18.8235447]


portfolio before change:  [-9.41086224]
curr_Stock_Price:  102.14465840160871
curr_Factors:  [102.1446584]
mat_Sqrt:  [[0.15]]
grads:  [0.02550182]
Stock Position:  0.025501818161541526
Bond Position:  [-12.01573674]


portfolio before change:  [-9.37954656]
curr_Stock_Price:  103.40208584315037
curr_Factors:  [103.40208584]
mat_Sqrt:  [[0.15]]
grads:  [0.08190563]
Stock Position:  0.08190563159682564
Bond Position:  [-17.84875971]


portfolio before change:  [-9.40941912]
curr_Stock_Price:  103.05098694686347
curr_Factors:  [103.05098695]
mat_Sqrt:  [[0.15]]
grads:  [-0.10192865]
Stock Position:  -0.10192865257771826
Bond Position:  [1.09442913]


portfolio before change:  [-9.46093276]
curr_Stock_Price:  103.55704728815199
curr_Factors:  [103.55704729]
mat_Sqrt:  [[0.15]]
grads:  [-0.08500745]
Stock Position:  -0.08500745437337266
Bond Position:  [-0.65781179]


portfolio before change:  [-9.46121575]
curr_Stock_Price:  103.55989259614574
curr_Factors:  [103.5598926]
mat_Sqrt:  [[0.15]]
grads:  [-0.02200163]
Stock Position:  -0.022001629147700534
Bond Position:  [-7.1827294]


portfolio before change:  [-9.45235371]
curr_Stock_Price:  103.13669803040445
curr_Factors:  [103.13669803]
mat_Sqrt:  [[0.15]]
grads:  [-0.05418554]
Stock Position:  -0.05418554221499848
Bond Position:  [-3.86383581]


portfolio before change:  [-9.40624717]
curr_Stock_Price:  102.28133985459611
curr_Factors:  [102.28133985]
mat_Sqrt:  [[0.15]]
grads:  [-0.0232359]
Stock Position:  -0.023235902047088697
Bond Position:  [-7.02964797]


portfolio before change:  [-9.42357721]
curr_Stock_Price:  103.00826151961493
curr_Factors:  [103.00826152]
mat_Sqrt:  [[0.15]]
grads:  [0.17967927]
Stock Position:  0.1796792675983259
Bond Position:  [-27.9320262]


portfolio before change:  [-9.32628524]
curr_Stock_Price:  103.55945353411539
curr_Factors:  [103.55945353]
mat_Sqrt:  [[0.15]]
grads:  [0.02316208]
Stock Position:  0.023162082159021657
Bond Position:  [-11.72493781]


portfolio before change:  [-9.33230699]
curr_Stock_Price:  103.33110973717764
curr_Factors:  [103.33110974]
mat_Sqrt:  [[0.15]]
grads:  [0.0569656]
Stock Position:  0.056965601539479854
Bond Position:  [-15.21862581]


portfolio before change:  [-9.23215475]
curr_Stock_Price:  105.10592527746046
curr_Factors:  [105.10592528]
mat_Sqrt:  [[0.15]]
grads:  [-0.15965856]
Stock Position:  -0.1596585574419934
Bond Position:  [7.54890566]


portfolio before change:  [-9.13078]
curr_Stock_Price:  104.47393332680524
curr_Factors:  [104.47393333]
mat_Sqrt:  [[0.15]]
grads:  [-0.0533917]
Stock Position:  -0.05339170219170686
Bond Position:  [-3.55273887]


portfolio before change:  [-9.1799932]
curr_Stock_Price:  105.39151301963061
curr_Factors:  [105.39151302]
mat_Sqrt:  [[0.15]]
grads:  [-0.04174214]
Stock Position:  -0.041742138950671796
Bond Position:  [-4.78072602]


portfolio before change:  [-9.20011372]
curr_Stock_Price:  105.86637397579852
curr_Factors:  [105.86637398]
mat_Sqrt:  [[0.15]]
grads:  [0.06836754]
Stock Position:  0.06836754295715555
Bond Position:  [-16.43793759]


portfolio before change:  [-9.29175273]
curr_Stock_Price:  104.54101392967908
curr_Factors:  [104.54101393]
mat_Sqrt:  [[0.15]]
grads:  [0.04528923]
Stock Position:  0.04528922739665913
Bond Position:  [-14.02633448]


portfolio before change:  [-9.29863875]
curr_Stock_Price:  104.40832564958394
curr_Factors:  [104.40832565]
mat_Sqrt:  [[0.15]]
grads:  [-0.00426477]
Stock Position:  -0.00426476622770612
Bond Position:  [-8.85336165]


portfolio before change:  [-9.29818414]
curr_Stock_Price:  104.17197856328043
curr_Factors:  [104.17197856]
mat_Sqrt:  [[0.15]]
grads:  [-0.03214094]
Stock Position:  -0.032140941435097416
Bond Position:  [-5.94999868]


portfolio before change:  [-9.29440516]
curr_Stock_Price:  104.04283295288461
curr_Factors:  [104.04283295]
mat_Sqrt:  [[0.15]]
grads:  [0.05620304]
Stock Position:  0.05620304313994423
Bond Position:  [-15.14192899]


portfolio before change:  [-9.30074967]
curr_Stock_Price:  103.94678641666896
curr_Factors:  [103.94678642]
mat_Sqrt:  [[0.15]]
grads:  [-0.02586854]
Stock Position:  -0.025868540923882348
Bond Position:  [-6.61179797]


portfolio before change:  [-9.29503557]
curr_Stock_Price:  103.70992137695123
curr_Factors:  [103.70992138]
mat_Sqrt:  [[0.15]]
grads:  [0.16594232]
Stock Position:  0.16594232316156932
Bond Position:  [-26.50490086]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.29503557]
Stock Price:  103.36349011511824
PL:  [-12.65852569]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-7.45874017e-02]
 [ 3.62925943e-03]
 [-9.06022787e-04]
 [ 8.62147647e-04]
 [-1.93969174e-03]
 [ 3.85973928e-03]
 [ 1.43525629e-03]
 [-2.46351898e-03]
 [ 1.80074794e-04]
 [ 1.65541493e-02]
 [ 8.42436636e-03]
 [-8.43977649e-03]
 [ 4.21310155e-04]
 [ 6.46463336e-03]
 [-2.39581985e-02]
 [ 1.67050738e-02]
 [-2.23715439e-03]
 [ 4.15379336e-03]
 [ 1.98778048e-02]
 [ 1.35936860e-02]
 [ 5.55254451e-02]
 [-1.79473161e-02]
 [-2.83997281e-03]
 [ 1.42489933e-02]
 [ 1.22264535e-02]
 [-5.35697896e-03]
 [ 1.34505026e-02]
 [-7.13263375e-04]
 [ 3.48784070e-03]
 [-2.63176488e-02]
 [-5.17171414e-03]
 [ 1.24987441e-02]
 [ 1.07821234e-02]
 [ 1.12628495e-02]
 [ 3.88586622e-03]
 [-3.34702231e-03]
 [-6.89902962e-03]
 [ 9.67635082e-03]
 [ 1.09466135e-03]
 [-7.85168664e-03]
 [-3.08223372e-02]
 [-3.26937512e-03]
 [ 1.50146731e-02]
 [-1.59285906e-02]
 [-2.89056118e-03]
 [ 2.63745339e-03]
 [-1.36006340e-02]
 [ 7.31709400e-03]
 [ 1.68058658e-02]
 [-1.15909884e-02]
 [-4.19156678e-03]
 [ 3.49877412e-03]
 [ 2.99693841e-03]
 [-3.82591578e-03]
 [-8.92473165e-03]
 [ 1.21281613e-02]
 [-2.64463893e-02]
 [-8.64431678e-03]
 [ 1.74928953e-02]
 [-2.01218645e-03]
 [ 1.26824955e-02]
 [-1.52193104e-02]
 [-1.27500630e-02]
 [-3.36478140e-03]
 [-5.43944474e-03]
 [-1.86754769e-02]
 [ 2.40822165e-02]
 [ 3.14210353e-03]
 [ 7.29576221e-03]
 [-1.48603126e-02]
 [-7.85518925e-03]
 [-5.31707761e-03]
 [ 2.24033959e-03]
 [ 8.20859861e-03]
 [ 2.77717597e-03]
 [-1.17993696e-02]
 [ 2.79697953e-03]
 [-7.63251891e-03]
 [ 2.77234114e-05]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.9306385]
curr_Stock_Price:  100.76251938552558
curr_Factors:  [100.76251939]
mat_Sqrt:  [[0.15]]
grads:  [-0.49724934]
Stock Position:  -0.4972493447510046
Bond Position:  [64.03473524]


portfolio before change:  [14.66917749]
curr_Stock_Price:  99.28531946233808
curr_Factors:  [99.28531946]
mat_Sqrt:  [[0.15]]
grads:  [0.02419506]
Stock Position:  0.024195062882782357
Bond Position:  [12.26696294]


portfolio before change:  [14.66305036]
curr_Stock_Price:  99.00039183844855
curr_Factors:  [99.00039184]
mat_Sqrt:  [[0.15]]
grads:  [-0.00604015]
Stock Position:  -0.006040151910967207
Bond Position:  [15.26102776]


portfolio before change:  [14.66160494]
curr_Stock_Price:  99.3976111605956
curr_Factors:  [99.39761116]
mat_Sqrt:  [[0.15]]
grads:  [0.00574765]
Stock Position:  0.0057476509803771605
Bond Position:  [14.09030216]


portfolio before change:  [14.6622877]
curr_Stock_Price:  99.3631781309654
curr_Factors:  [99.36317813]
mat_Sqrt:  [[0.15]]
grads:  [-0.01293128]
Stock Position:  -0.012931278256079124
Bond Position:  [15.9471806]


portfolio before change:  [14.67777756]
curr_Stock_Price:  98.24239683292785
curr_Factors:  [98.24239683]
mat_Sqrt:  [[0.15]]
grads:  [0.0257316]
Stock Position:  0.025731595172924223
Bond Position:  [12.14984398]


portfolio before change:  [14.67186463]
curr_Stock_Price:  97.98309234833265
curr_Factors:  [97.98309235]
mat_Sqrt:  [[0.15]]
grads:  [0.00956838]
Stock Position:  0.009568375266788257
Bond Position:  [13.73432564]


portfolio before change:  [14.67164524]
curr_Stock_Price:  97.8704490206565
curr_Factors:  [97.87044902]
mat_Sqrt:  [[0.15]]
grads:  [-0.01642346]
Stock Position:  -0.016423459853902915
Bond Position:  [16.27901663]


portfolio before change:  [14.68183931]
curr_Stock_Price:  97.31169984808297
curr_Factors:  [97.31169985]
mat_Sqrt:  [[0.15]]
grads:  [0.0012005]
Stock Position:  0.001200498627300919
Bond Position:  [14.56501675]


portfolio before change:  [14.68344092]
curr_Stock_Price:  97.88752146156483
curr_Factors:  [97.88752146]
mat_Sqrt:  [[0.15]]
grads:  [0.110361]
Stock Position:  0.11036099541842519
Bond Position:  [3.88047662]


portfolio before change:  [14.68309772]
curr_Stock_Price:  97.88221398967119
curr_Factors:  [97.88221399]
mat_Sqrt:  [[0.15]]
grads:  [0.05616244]
Stock Position:  0.05616244237569052
Bond Position:  [9.18579352]


portfolio before change:  [14.69968405]
curr_Stock_Price:  98.16731913795026
curr_Factors:  [98.16731914]
mat_Sqrt:  [[0.15]]
grads:  [-0.05626518]
Stock Position:  -0.05626517659797298
Bond Position:  [20.2230856]


portfolio before change:  [14.69390484]
curr_Stock_Price:  98.29249769907925
curr_Factors:  [98.2924977]
mat_Sqrt:  [[0.15]]
grads:  [0.00280873]
Stock Position:  0.0028087343673321333
Bond Position:  [14.41782733]


portfolio before change:  [14.69230029]
curr_Stock_Price:  97.40038861948725
curr_Factors:  [97.40038862]
mat_Sqrt:  [[0.15]]
grads:  [0.04309756]
Stock Position:  0.043097555765002446
Bond Position:  [10.49458161]


portfolio before change:  [14.69780892]
curr_Stock_Price:  97.51298655689423
curr_Factors:  [97.51298656]
mat_Sqrt:  [[0.15]]
grads:  [-0.15972132]
Stock Position:  -0.1597213233823277
Bond Position:  [30.27271218]


portfolio before change:  [14.6934136]
curr_Stock_Price:  97.55235147885689
curr_Factors:  [97.55235148]
mat_Sqrt:  [[0.15]]
grads:  [0.11136716]
Stock Position:  0.11136715883680119
Bond Position:  [3.82928538]


portfolio before change:  [14.80167651]
curr_Stock_Price:  98.52232837109125
curr_Factors:  [98.52232837]
mat_Sqrt:  [[0.15]]
grads:  [-0.01491436]
Stock Position:  -0.014914362626960142
Bond Position:  [16.27107424]


portfolio before change:  [14.80353764]
curr_Stock_Price:  98.46572827717931
curr_Factors:  [98.46572828]
mat_Sqrt:  [[0.15]]
grads:  [0.02769196]
Stock Position:  0.027691955700054546
Bond Position:  [12.07682905]


portfolio before change:  [14.82153483]
curr_Stock_Price:  99.08837733958265
curr_Factors:  [99.08837734]
mat_Sqrt:  [[0.15]]
grads:  [0.1325187]
Stock Position:  0.13251869871840669
Bond Position:  [1.69047201]


portfolio before change:  [14.75018988]
curr_Stock_Price:  98.54920350085524
curr_Factors:  [98.5492035]
mat_Sqrt:  [[0.15]]
grads:  [0.09062457]
Stock Position:  0.09062457332219219
Bond Position:  [5.81921036]


portfolio before change:  [14.82118377]
curr_Stock_Price:  99.3285746729494
curr_Factors:  [99.32857467]
mat_Sqrt:  [[0.15]]
grads:  [0.37016963]
Stock Position:  0.37016963416428567
Bond Position:  [-21.94723838]


portfolio before change:  [14.65268081]
curr_Stock_Price:  98.87707569005983
curr_Factors:  [98.87707569]
mat_Sqrt:  [[0.15]]
grads:  [-0.11964877]
Stock Position:  -0.11964877382231769
Bond Position:  [26.48320168]


portfolio before change:  [14.52214579]
curr_Stock_Price:  99.98189493690447
curr_Factors:  [99.98189494]
mat_Sqrt:  [[0.15]]
grads:  [-0.01893315]
Stock Position:  -0.018933152044359206
Bond Position:  [16.41511821]


portfolio before change:  [14.54129038]
curr_Stock_Price:  99.02491669013645
curr_Factors:  [99.02491669]
mat_Sqrt:  [[0.15]]
grads:  [0.09499329]
Stock Position:  0.09499328846117937
Bond Position:  [5.13458791]


portfolio before change:  [14.62000619]
curr_Stock_Price:  99.85018434342636
curr_Factors:  [99.85018434]
mat_Sqrt:  [[0.15]]
grads:  [0.08150969]
Stock Position:  0.081509689834326
Bond Position:  [6.48124864]


portfolio before change:  [14.61690253]
curr_Stock_Price:  99.8071372473436
curr_Factors:  [99.80713725]
mat_Sqrt:  [[0.15]]
grads:  [-0.03571319]
Stock Position:  -0.0357131930397159
Bond Position:  [18.18133409]


portfolio before change:  [14.60186813]
curr_Stock_Price:  100.2599326821792
curr_Factors:  [100.25993268]
mat_Sqrt:  [[0.15]]
grads:  [0.08967002]
Stock Position:  0.08967001762523663
Bond Position:  [5.6115582]


portfolio before change:  [14.57750818]
curr_Stock_Price:  99.98435921456188
curr_Factors:  [99.98435921]
mat_Sqrt:  [[0.15]]
grads:  [-0.00475509]
Stock Position:  -0.004755089164610154
Bond Position:  [15.05294273]


portfolio before change:  [14.57519692]
curr_Stock_Price:  100.6682785513963
curr_Factors:  [100.66827855]
mat_Sqrt:  [[0.15]]
grads:  [0.02325227]
Stock Position:  0.023252271337596428
Bond Position:  [12.2344308]


portfolio before change:  [14.57113186]
curr_Stock_Price:  100.46056808775954
curr_Factors:  [100.46056809]
mat_Sqrt:  [[0.15]]
grads:  [-0.17545099]
Stock Position:  -0.17545099223851668
Bond Position:  [32.19703821]


portfolio before change:  [14.46046997]
curr_Stock_Price:  101.1027660491365
curr_Factors:  [101.10276605]
mat_Sqrt:  [[0.15]]
grads:  [-0.03447809]
Stock Position:  -0.03447809427576613
Bond Position:  [17.94630067]


portfolio before change:  [14.47443307]
curr_Stock_Price:  100.73031451590327
curr_Factors:  [100.73031452]
mat_Sqrt:  [[0.15]]
grads:  [0.08332496]
Stock Position:  0.08332496049722408
Bond Position:  [6.08108359]


portfolio before change:  [14.48007398]
curr_Stock_Price:  100.79345082884309
curr_Factors:  [100.79345083]
mat_Sqrt:  [[0.15]]
grads:  [0.07188082]
Stock Position:  0.07188082233748372
Bond Position:  [7.23495785]


portfolio before change:  [14.49312149]
curr_Stock_Price:  100.96867578865263
curr_Factors:  [100.96867579]
mat_Sqrt:  [[0.15]]
grads:  [0.07508566]
Stock Position:  0.07508566352012491
Bond Position:  [6.91182147]


portfolio before change:  [14.46451481]
curr_Stock_Price:  100.58193503374163
curr_Factors:  [100.58193503]
mat_Sqrt:  [[0.15]]
grads:  [0.02590577]
Stock Position:  0.025905774788910544
Bond Position:  [11.85886185]


portfolio before change:  [14.46760964]
curr_Stock_Price:  100.67278876354943
curr_Factors:  [100.67278876]
mat_Sqrt:  [[0.15]]
grads:  [-0.02231348]
Stock Position:  -0.022313482058296943
Bond Position:  [16.71397011]


portfolio before change:  [14.45064248]
curr_Stock_Price:  101.48000587308294
curr_Factors:  [101.48000587]
mat_Sqrt:  [[0.15]]
grads:  [-0.04599353]
Stock Position:  -0.04599353083126291
Bond Position:  [19.11806625]


portfolio before change:  [14.45435598]
curr_Stock_Price:  101.42524631640582
curr_Factors:  [101.42524632]
mat_Sqrt:  [[0.15]]
grads:  [0.06450901]
Stock Position:  0.06450900544594523
Bond Position:  [7.91151421]


portfolio before change:  [14.49134584]
curr_Stock_Price:  101.99098705466507
curr_Factors:  [101.99098705]
mat_Sqrt:  [[0.15]]
grads:  [0.00729774]
Stock Position:  0.00729774232611053
Bond Position:  [13.74704189]


portfolio before change:  [14.50183429]
curr_Stock_Price:  103.31046870217963
curr_Factors:  [103.3104687]
mat_Sqrt:  [[0.15]]
grads:  [-0.05234458]
Stock Position:  -0.05234457759326396
Bond Position:  [19.90957713]


portfolio before change:  [14.54321741]
curr_Stock_Price:  102.54365136865611
curr_Factors:  [102.54365137]
mat_Sqrt:  [[0.15]]
grads:  [-0.20548225]
Stock Position:  -0.20548224806734153
Bond Position:  [35.61411741]


portfolio before change:  [14.35497868]
curr_Stock_Price:  103.47056684915614
curr_Factors:  [103.47056685]
mat_Sqrt:  [[0.15]]
grads:  [-0.02179583]
Stock Position:  -0.021795834153786154
Bond Position:  [16.610206]


portfolio before change:  [14.34460177]
curr_Stock_Price:  103.99429450808
curr_Factors:  [103.99429451]
mat_Sqrt:  [[0.15]]
grads:  [0.10009782]
Stock Position:  0.10009782079876316
Bond Position:  [3.93499951]


portfolio before change:  [14.48975732]
curr_Stock_Price:  105.44197441038119
curr_Factors:  [105.44197441]
mat_Sqrt:  [[0.15]]
grads:  [-0.1061906]
Stock Position:  -0.10619060382335663
Bond Position:  [25.68670425]


portfolio before change:  [14.62628534]
curr_Stock_Price:  104.17140486419709
curr_Factors:  [104.17140486]
mat_Sqrt:  [[0.15]]
grads:  [-0.01927041]
Stock Position:  -0.019270407862459277
Bond Position:  [16.6337108]


portfolio before change:  [14.62479696]
curr_Stock_Price:  104.30259128395039
curr_Factors:  [104.30259128]
mat_Sqrt:  [[0.15]]
grads:  [0.01758302]
Stock Position:  0.017583022591395384
Bond Position:  [12.79084214]


portfolio before change:  [14.62181184]
curr_Stock_Price:  104.08735115922757
curr_Factors:  [104.08735116]
mat_Sqrt:  [[0.15]]
grads:  [-0.09067089]
Stock Position:  -0.09067089336333307
Bond Position:  [24.05950496]


portfolio before change:  [14.65355378]
curr_Stock_Price:  103.75385746353082
curr_Factors:  [103.75385746]
mat_Sqrt:  [[0.15]]
grads:  [0.04878063]
Stock Position:  0.04878062664018229
Bond Position:  [9.59237559]


portfolio before change:  [14.68658443]
curr_Stock_Price:  104.41869327414922
curr_Factors:  [104.41869327]
mat_Sqrt:  [[0.15]]
grads:  [0.11203911]
Stock Position:  0.11203910514868398
Bond Position:  [2.98760747]


portfolio before change:  [14.69604184]
curr_Stock_Price:  104.50143836069428
curr_Factors:  [104.50143836]
mat_Sqrt:  [[0.15]]
grads:  [-0.07727326]
Stock Position:  -0.07727325625569988
Bond Position:  [22.77120827]


portfolio before change:  [14.67553526]
curr_Stock_Price:  104.78523417314449
curr_Factors:  [104.78523417]
mat_Sqrt:  [[0.15]]
grads:  [-0.02794378]
Stock Position:  -0.027943778511025936
Bond Position:  [17.60363064]


portfolio before change:  [14.67849032]
curr_Stock_Price:  104.71885820420351
curr_Factors:  [104.7188582]
mat_Sqrt:  [[0.15]]
grads:  [0.02332516]
Stock Position:  0.02332516077941866
Bond Position:  [12.23590611]


portfolio before change:  [14.68084744]
curr_Stock_Price:  104.78712573206263
curr_Factors:  [104.78712573]
mat_Sqrt:  [[0.15]]
grads:  [0.01997959]
Stock Position:  0.019979589398967657
Bond Position:  [12.58724369]


portfolio before change:  [14.69759194]
curr_Stock_Price:  105.58582969630316
curr_Factors:  [105.5858297]
mat_Sqrt:  [[0.15]]
grads:  [-0.02550611]
Stock Position:  -0.025506105217172708
Bond Position:  [17.39067522]


portfolio before change:  [14.71558789]
curr_Stock_Price:  104.92289042954063
curr_Factors:  [104.92289043]
mat_Sqrt:  [[0.15]]
grads:  [-0.05949821]
Stock Position:  -0.05949821099955714
Bond Position:  [20.95831217]


portfolio before change:  [14.66766118]
curr_Stock_Price:  105.75042193422874
curr_Factors:  [105.75042193]
mat_Sqrt:  [[0.15]]
grads:  [0.08085441]
Stock Position:  0.08085440840135738
Bond Position:  [6.11727338]


portfolio before change:  [14.64843068]
curr_Stock_Price:  105.50785209633314
curr_Factors:  [105.5078521]
mat_Sqrt:  [[0.15]]
grads:  [-0.17630926]
Stock Position:  -0.17630926196778196
Bond Position:  [33.25044222]


portfolio before change:  [14.70789237]
curr_Stock_Price:  105.18238156894613
curr_Factors:  [105.18238157]
mat_Sqrt:  [[0.15]]
grads:  [-0.05762878]
Stock Position:  -0.0576287785320502
Bond Position:  [20.76942454]


portfolio before change:  [14.73757062]
curr_Stock_Price:  104.68991724167213
curr_Factors:  [104.68991724]
mat_Sqrt:  [[0.15]]
grads:  [0.1166193]
Stock Position:  0.11661930217083646
Bond Position:  [2.52870552]


portfolio before change:  [14.70383862]
curr_Stock_Price:  104.39931317765847
curr_Factors:  [104.39931318]
mat_Sqrt:  [[0.15]]
grads:  [-0.01341458]
Stock Position:  -0.013414576337451932
Bond Position:  [16.10431118]


portfolio before change:  [14.71373571]
curr_Stock_Price:  103.73656129013168
curr_Factors:  [103.73656129]
mat_Sqrt:  [[0.15]]
grads:  [0.08454997]
Stock Position:  0.08454996972755716
Bond Position:  [5.94281259]


portfolio before change:  [14.69192209]
curr_Stock_Price:  103.47417133823829
curr_Factors:  [103.47417134]
mat_Sqrt:  [[0.15]]
grads:  [-0.10146207]
Stock Position:  -0.10146206954775273
Bond Position:  [25.19062565]


portfolio before change:  [14.58055603]
curr_Stock_Price:  104.58730181395201
curr_Factors:  [104.58730181]
mat_Sqrt:  [[0.15]]
grads:  [-0.08500042]
Stock Position:  -0.08500042018918443
Bond Position:  [23.47052063]


portfolio before change:  [14.63210611]
curr_Stock_Price:  103.99809138522609
curr_Factors:  [103.99809139]
mat_Sqrt:  [[0.15]]
grads:  [-0.02243188]
Stock Position:  -0.022431876008776035
Bond Position:  [16.96497841]


portfolio before change:  [14.65034963]
curr_Stock_Price:  103.23207570098747
curr_Factors:  [103.2320757]
mat_Sqrt:  [[0.15]]
grads:  [-0.03626296]
Stock Position:  -0.03626296493329235
Bond Position:  [18.39385077]


portfolio before change:  [14.64512449]
curr_Stock_Price:  103.40786909962027
curr_Factors:  [103.4078691]
mat_Sqrt:  [[0.15]]
grads:  [-0.12450318]
Stock Position:  -0.12450317936310379
Bond Position:  [27.51973296]


portfolio before change:  [14.64250278]
curr_Stock_Price:  103.44274169201853
curr_Factors:  [103.44274169]
mat_Sqrt:  [[0.15]]
grads:  [0.16054811]
Stock Position:  0.16054811014880385
Bond Position:  [-1.96503391]


portfolio before change:  [14.60886455]
curr_Stock_Price:  103.2339854885755
curr_Factors:  [103.23398549]
mat_Sqrt:  [[0.15]]
grads:  [0.02094736]
Stock Position:  0.020947356877522774
Bond Position:  [12.44638541]


portfolio before change:  [14.5942758]
curr_Stock_Price:  102.5004001819638
curr_Factors:  [102.50040018]
mat_Sqrt:  [[0.15]]
grads:  [0.04863841]
Stock Position:  0.04863841474533189
Bond Position:  [9.60881882]


portfolio before change:  [14.59202132]
curr_Stock_Price:  102.44170072889727
curr_Factors:  [102.44170073]
mat_Sqrt:  [[0.15]]
grads:  [-0.09906875]
Stock Position:  -0.09906875072542053
Bond Position:  [24.74079263]


portfolio before change:  [14.61320713]
curr_Stock_Price:  102.2434599818858
curr_Factors:  [102.24345998]
mat_Sqrt:  [[0.15]]
grads:  [-0.05236793]
Stock Position:  -0.05236792830024587
Bond Position:  [19.96748531]


portfolio before change:  [14.65687028]
curr_Stock_Price:  101.43351493563472
curr_Factors:  [101.43351494]
mat_Sqrt:  [[0.15]]
grads:  [-0.03544718]
Stock Position:  -0.03544718404758484
Bond Position:  [18.25240275]


portfolio before change:  [14.68373969]
curr_Stock_Price:  100.7076857360736
curr_Factors:  [100.70768574]
mat_Sqrt:  [[0.15]]
grads:  [0.0149356]
Stock Position:  0.014935597254901069
Bond Position:  [13.17961026]


portfolio before change:  [14.70171845]
curr_Stock_Price:  101.85628418861715
curr_Factors:  [101.85628419]
mat_Sqrt:  [[0.15]]
grads:  [0.05472399]
Stock Position:  0.054723990732867156
Bond Position:  [9.12773609]


portfolio before change:  [14.70767187]
curr_Stock_Price:  101.9546492056649
curr_Factors:  [101.95464921]
mat_Sqrt:  [[0.15]]
grads:  [0.01851451]
Stock Position:  0.018514506438164713
Bond Position:  [12.82003186]


portfolio before change:  [14.70624183]
curr_Stock_Price:  101.83413199788532
curr_Factors:  [101.834132]
mat_Sqrt:  [[0.15]]
grads:  [-0.07866246]
Stock Position:  -0.07866246400759908
Bond Position:  [22.71676558]


portfolio before change:  [14.7358217]
curr_Stock_Price:  101.47614646307254
curr_Factors:  [101.47614646]
mat_Sqrt:  [[0.15]]
grads:  [0.01864653]
Stock Position:  0.018646530216338913
Bond Position:  [12.84364367]


portfolio before change:  [14.72895317]
curr_Stock_Price:  101.0647408390985
curr_Factors:  [101.06474084]
mat_Sqrt:  [[0.15]]
grads:  [-0.05088346]
Stock Position:  -0.050883459397342914
Bond Position:  [19.8714768]


portfolio before change:  [14.7921855]
curr_Stock_Price:  99.84646023648592
curr_Factors:  [99.84646024]
mat_Sqrt:  [[0.15]]
grads:  [0.00018482]
Stock Position:  0.00018482274297910994
Bond Position:  [14.77373161]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.7921855]
Stock Price:  100.2649103669682
PL:  [14.52727514]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.74938453e-02]
 [-2.34678058e-03]
 [ 4.78822496e-04]
 [ 2.74867970e-03]
 [ 6.28245326e-03]
 [ 1.22846843e-02]
 [-2.74557194e-04]
 [ 6.60167232e-03]
 [ 6.34409810e-03]
 [-1.88792154e-02]
 [ 9.93867190e-03]
 [-1.22772143e-02]
 [ 2.39500528e-02]
 [ 1.51899675e-02]
 [-6.78431577e-03]
 [-9.85128157e-03]
 [ 7.96783624e-03]
 [ 2.21269308e-02]
 [ 2.41922198e-02]
 [ 1.00455325e-02]
 [ 7.70649133e-02]
 [-1.32520610e-02]
 [ 3.80484583e-03]
 [ 3.00438224e-03]
 [ 1.64686941e-02]
 [ 4.26274753e-03]
 [ 1.25116282e-02]
 [ 4.99695499e-03]
 [ 4.99485642e-03]
 [-1.72505946e-02]
 [-5.66948874e-03]
 [ 3.25532471e-02]
 [ 6.43281188e-03]
 [ 1.09728043e-04]
 [-4.89896665e-03]
 [-4.37789584e-03]
 [-6.84208611e-03]
 [ 2.86396393e-03]
 [ 2.46880766e-03]
 [-8.71215488e-03]
 [-2.12318924e-02]
 [-2.41376567e-03]
 [ 1.31661190e-02]
 [-1.15822117e-02]
 [-6.95842204e-04]
 [ 2.35011431e-03]
 [-1.36252234e-02]
 [ 4.16774594e-03]
 [ 4.24015435e-03]
 [-5.33961426e-03]
 [-3.30355349e-03]
 [ 3.63575888e-03]
 [ 1.41537751e-03]
 [ 3.68365889e-03]
 [-1.36769306e-03]
 [ 8.57176728e-03]
 [-9.88731854e-03]
 [-1.48320025e-02]
 [ 1.33921482e-02]
 [ 6.59675644e-03]
 [ 9.87599960e-03]
 [-1.28760166e-02]
 [-1.26071376e-02]
 [-2.67854581e-03]
 [-1.74961033e-02]
 [ 2.21740683e-02]
 [ 2.94244915e-02]
 [ 1.76653582e-03]
 [ 6.70139836e-03]
 [-1.93358288e-02]
 [-7.71090807e-03]
 [-7.22448600e-03]
 [ 6.06278998e-03]
 [ 6.85313051e-03]
 [-6.23823725e-04]
 [-3.17790608e-03]
 [ 8.80112023e-03]
 [-3.70509415e-03]
 [ 2.41437638e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.18640567]
curr_Stock_Price:  100.32906309310931
curr_Factors:  [100.32906309]
mat_Sqrt:  [[0.15]]
grads:  [-0.31662564]
Stock Position:  -0.31662563533846827
Bond Position:  [38.95315902]


portfolio before change:  [7.26493075]
curr_Stock_Price:  100.08874638519431
curr_Factors:  [100.08874639]
mat_Sqrt:  [[0.15]]
grads:  [-0.0156452]
Stock Position:  -0.015645203897642117
Bond Position:  [8.8308396]


portfolio before change:  [7.25692181]
curr_Stock_Price:  100.6359357187194
curr_Factors:  [100.63593572]
mat_Sqrt:  [[0.15]]
grads:  [0.00319215]
Stock Position:  0.0031921499715541145
Bond Position:  [6.93567681]


portfolio before change:  [7.25913437]
curr_Stock_Price:  101.19326109935947
curr_Factors:  [101.1932611]
mat_Sqrt:  [[0.15]]
grads:  [0.01832453]
Stock Position:  0.018324531310170228
Bond Position:  [5.40481528]


portfolio before change:  [7.26148969]
curr_Stock_Price:  101.30336030634187
curr_Factors:  [101.30336031]
mat_Sqrt:  [[0.15]]
grads:  [0.04188302]
Stock Position:  0.04188302175496716
Bond Position:  [3.01859885]


portfolio before change:  [7.29535661]
curr_Stock_Price:  102.10746290621121
curr_Factors:  [102.10746291]
mat_Sqrt:  [[0.15]]
grads:  [0.0818979]
Stock Position:  0.08189789533931456
Bond Position:  [-1.0670297]


portfolio before change:  [7.26721779]
curr_Stock_Price:  101.7646930979754
curr_Factors:  [101.7646931]
mat_Sqrt:  [[0.15]]
grads:  [-0.00183038]
Stock Position:  -0.0018303812965750651
Bond Position:  [7.45348598]


portfolio before change:  [7.26772417]
curr_Stock_Price:  101.74255481417133
curr_Factors:  [101.74255481]
mat_Sqrt:  [[0.15]]
grads:  [0.04401115]
Stock Position:  0.044011148769967326
Bond Position:  [2.78991745]


portfolio before change:  [7.20819663]
curr_Stock_Price:  100.38603671940572
curr_Factors:  [100.38603672]
mat_Sqrt:  [[0.15]]
grads:  [0.04229399]
Stock Position:  0.042293987314593565
Bond Position:  [2.96247086]


portfolio before change:  [7.24862557]
curr_Stock_Price:  101.33756173491578
curr_Factors:  [101.33756173]
mat_Sqrt:  [[0.15]]
grads:  [-0.12586144]
Stock Position:  -0.12586143570926817
Bond Position:  [20.00311658]


portfolio before change:  [7.14834799]
curr_Stock_Price:  102.14422517833565
curr_Factors:  [102.14422518]
mat_Sqrt:  [[0.15]]
grads:  [0.06625781]
Stock Position:  0.06625781264488344
Bond Position:  [0.38049505]


portfolio before change:  [7.19421012]
curr_Stock_Price:  102.83604319191402
curr_Factors:  [102.83604319]
mat_Sqrt:  [[0.15]]
grads:  [-0.0818481]
Stock Position:  -0.08184809559029185
Bond Position:  [15.61114441]


portfolio before change:  [7.23660224]
curr_Stock_Price:  102.3300278127077
curr_Factors:  [102.33002781]
mat_Sqrt:  [[0.15]]
grads:  [0.15966702]
Stock Position:  0.15966701863209629
Bond Position:  [-9.10212822]


portfolio before change:  [7.29402879]
curr_Stock_Price:  102.6932553150454
curr_Factors:  [102.69325532]
mat_Sqrt:  [[0.15]]
grads:  [0.10126645]
Stock Position:  0.10126644973512591
Bond Position:  [-3.10535259]


portfolio before change:  [7.30668996]
curr_Stock_Price:  102.82020021203428
curr_Factors:  [102.82020021]
mat_Sqrt:  [[0.15]]
grads:  [-0.04522877]
Stock Position:  -0.04522877178398659
Bond Position:  [11.95712133]


portfolio before change:  [7.32972971]
curr_Stock_Price:  102.32731906973231
curr_Factors:  [102.32731907]
mat_Sqrt:  [[0.15]]
grads:  [-0.06567521]
Stock Position:  -0.06567521047347459
Bond Position:  [14.05009793]


portfolio before change:  [7.35187117]
curr_Stock_Price:  102.00355463220434
curr_Factors:  [102.00355463]
mat_Sqrt:  [[0.15]]
grads:  [0.05311891]
Stock Position:  0.05311890825685388
Bond Position:  [1.93355371]


portfolio before change:  [7.3194167]
curr_Stock_Price:  101.39030182571231
curr_Factors:  [101.39030183]
mat_Sqrt:  [[0.15]]
grads:  [0.14751287]
Stock Position:  0.14751287200932917
Bond Position:  [-7.63695792]


portfolio before change:  [7.0709658]
curr_Stock_Price:  99.7092717727872
curr_Factors:  [99.70927177]
mat_Sqrt:  [[0.15]]
grads:  [0.16128147]
Stock Position:  0.16128146560740375
Bond Position:  [-9.01029168]


portfolio before change:  [7.05242458]
curr_Stock_Price:  99.5978016342445
curr_Factors:  [99.59780163]
mat_Sqrt:  [[0.15]]
grads:  [0.06697022]
Stock Position:  0.0669702166795772
Bond Position:  [0.38233822]


portfolio before change:  [7.09225789]
curr_Stock_Price:  100.19223621562575
curr_Factors:  [100.19223622]
mat_Sqrt:  [[0.15]]
grads:  [0.51376609]
Stock Position:  0.5137660884726625
Bond Position:  [-44.38311541]


portfolio before change:  [7.25755821]
curr_Stock_Price:  100.51937799390677
curr_Factors:  [100.51937799]
mat_Sqrt:  [[0.15]]
grads:  [-0.08834707]
Stock Position:  -0.08834707311545997
Bond Position:  [16.13815104]


portfolio before change:  [7.21955095]
curr_Stock_Price:  100.96099899460243
curr_Factors:  [100.96099899]
mat_Sqrt:  [[0.15]]
grads:  [0.02536564]
Stock Position:  0.025365638864834703
Bond Position:  [4.65861071]


portfolio before change:  [7.22049174]
curr_Stock_Price:  100.986609115545
curr_Factors:  [100.98660912]
mat_Sqrt:  [[0.15]]
grads:  [0.02002921]
Stock Position:  0.020029214954255053
Bond Position:  [5.19780924]


portfolio before change:  [7.23317078]
curr_Stock_Price:  101.60341633499252
curr_Factors:  [101.60341633]
mat_Sqrt:  [[0.15]]
grads:  [0.10979129]
Stock Position:  0.10979129374363732
Bond Position:  [-3.92199975]


portfolio before change:  [7.18099467]
curr_Stock_Price:  101.13041911688174
curr_Factors:  [101.13041912]
mat_Sqrt:  [[0.15]]
grads:  [0.02841832]
Stock Position:  0.028418316870387657
Bond Position:  [4.30703837]


portfolio before change:  [7.17779273]
curr_Stock_Price:  101.00827480275616
curr_Factors:  [101.0082748]
mat_Sqrt:  [[0.15]]
grads:  [0.08341085]
Stock Position:  0.08341085469351281
Bond Position:  [-1.2473938]


portfolio before change:  [7.23396351]
curr_Stock_Price:  101.68263239116388
curr_Factors:  [101.68263239]
mat_Sqrt:  [[0.15]]
grads:  [0.03331303]
Stock Position:  0.03331303325417162
Bond Position:  [3.84660659]


portfolio before change:  [7.2374754]
curr_Stock_Price:  101.78083631489066
curr_Factors:  [101.78083631]
mat_Sqrt:  [[0.15]]
grads:  [0.03329904]
Stock Position:  0.03329904280791888
Bond Position:  [3.84827097]


portfolio before change:  [7.25492977]
curr_Stock_Price:  102.29778343790618
curr_Factors:  [102.29778344]
mat_Sqrt:  [[0.15]]
grads:  [-0.11500396]
Stock Position:  -0.11500396404063187
Bond Position:  [19.01958038]


portfolio before change:  [7.26472655]
curr_Stock_Price:  102.22293366072942
curr_Factors:  [102.22293366]
mat_Sqrt:  [[0.15]]
grads:  [-0.03779659]
Stock Position:  -0.037796591598442904
Bond Position:  [11.12840502]


portfolio before change:  [7.26551492]
curr_Stock_Price:  102.22047784967441
curr_Factors:  [102.22047785]
mat_Sqrt:  [[0.15]]
grads:  [0.21702165]
Stock Position:  0.2170216472045211
Bond Position:  [-14.91854156]


portfolio before change:  [7.38134355]
curr_Stock_Price:  102.75849362471638
curr_Factors:  [102.75849362]
mat_Sqrt:  [[0.15]]
grads:  [0.04288541]
Stock Position:  0.04288541251492519
Bond Position:  [2.97450316]


portfolio before change:  [7.35830394]
curr_Stock_Price:  102.21692204837294
curr_Factors:  [102.21692205]
mat_Sqrt:  [[0.15]]
grads:  [0.00073152]
Stock Position:  0.0007315202874183293
Bond Position:  [7.28353019]


portfolio before change:  [7.35906049]
curr_Stock_Price:  102.62882074501209
curr_Factors:  [102.62882075]
mat_Sqrt:  [[0.15]]
grads:  [-0.03265978]
Stock Position:  -0.03265977768832219
Bond Position:  [10.71089496]


portfolio before change:  [7.37513979]
curr_Stock_Price:  102.15699104809524
curr_Factors:  [102.15699105]
mat_Sqrt:  [[0.15]]
grads:  [-0.02918597]
Stock Position:  -0.029185972289583213
Bond Position:  [10.3566909]


portfolio before change:  [7.37212539]
curr_Stock_Price:  102.28245243969438
curr_Factors:  [102.28245244]
mat_Sqrt:  [[0.15]]
grads:  [-0.04561391]
Stock Position:  -0.04561390742304108
Bond Position:  [12.03762771]


portfolio before change:  [7.32072303]
curr_Stock_Price:  103.42584803404065
curr_Factors:  [103.42584803]
mat_Sqrt:  [[0.15]]
grads:  [0.01909309]
Stock Position:  0.0190930928676024
Bond Position:  [5.34600371]


portfolio before change:  [7.31006748]
curr_Stock_Price:  102.85026389974414
curr_Factors:  [102.8502639]
mat_Sqrt:  [[0.15]]
grads:  [0.01645872]
Stock Position:  0.0164587177644262
Bond Position:  [5.61728402]


portfolio before change:  [7.29706184]
curr_Stock_Price:  102.03873437156216
curr_Factors:  [102.03873437]
mat_Sqrt:  [[0.15]]
grads:  [-0.05808103]
Stock Position:  -0.058081032519260056
Bond Position:  [13.22357689]


portfolio before change:  [7.3149843]
curr_Stock_Price:  101.74438757325719
curr_Factors:  [101.74438757]
mat_Sqrt:  [[0.15]]
grads:  [-0.14154595]
Stock Position:  -0.14154594966143874
Bond Position:  [21.71649027]


portfolio before change:  [7.23901004]
curr_Stock_Price:  102.29072315004709
curr_Factors:  [102.29072315]
mat_Sqrt:  [[0.15]]
grads:  [-0.01609177]
Stock Position:  -0.01609177116048347
Bond Position:  [8.88504895]


portfolio before change:  [7.22657328]
curr_Stock_Price:  103.09809831971356
curr_Factors:  [103.09809832]
mat_Sqrt:  [[0.15]]
grads:  [0.08777413]
Stock Position:  0.08777412689656763
Bond Position:  [-1.82277229]


portfolio before change:  [7.16944695]
curr_Stock_Price:  102.44856292882201
curr_Factors:  [102.44856293]
mat_Sqrt:  [[0.15]]
grads:  [-0.07721474]
Stock Position:  -0.07721474481624975
Bond Position:  [15.07998659]


portfolio before change:  [7.13726522]
curr_Stock_Price:  102.87755163957331
curr_Factors:  [102.87755164]
mat_Sqrt:  [[0.15]]
grads:  [-0.00463895]
Stock Position:  -0.004638948025167319
Bond Position:  [7.61450884]


portfolio before change:  [7.13849046]
curr_Stock_Price:  102.71602517513905
curr_Factors:  [102.71602518]
mat_Sqrt:  [[0.15]]
grads:  [0.01566743]
Stock Position:  0.01566742870346061
Bond Position:  [5.52919445]


portfolio before change:  [7.1486416]
curr_Stock_Price:  103.34188155292648
curr_Factors:  [103.34188155]
mat_Sqrt:  [[0.15]]
grads:  [-0.09083482]
Stock Position:  -0.09083482290559634
Bond Position:  [16.53568311]


portfolio before change:  [7.16183962]
curr_Stock_Price:  103.2079625608785
curr_Factors:  [103.20796256]
mat_Sqrt:  [[0.15]]
grads:  [0.02778497]
Stock Position:  0.027784972918544062
Bond Position:  [4.29420918]


portfolio before change:  [7.14496266]
curr_Stock_Price:  102.59088958168842
curr_Factors:  [102.59088958]
mat_Sqrt:  [[0.15]]
grads:  [0.0282677]
Stock Position:  0.02826769565100924
Bond Position:  [4.24495462]


portfolio before change:  [7.14384699]
curr_Stock_Price:  102.5420355632249
curr_Factors:  [102.54203556]
mat_Sqrt:  [[0.15]]
grads:  [-0.03559743]
Stock Position:  -0.03559742836805137
Bond Position:  [10.79407976]


portfolio before change:  [7.14788033]
curr_Stock_Price:  102.44768361906654
curr_Factors:  [102.44768362]
mat_Sqrt:  [[0.15]]
grads:  [-0.02202369]
Stock Position:  -0.0220236899209792
Bond Position:  [9.40415634]


portfolio before change:  [7.15244792]
curr_Stock_Price:  102.26697740797196
curr_Factors:  [102.26697741]
mat_Sqrt:  [[0.15]]
grads:  [0.02423839]
Stock Position:  0.024238392536470827
Bond Position:  [4.67366078]


portfolio before change:  [7.16648469]
curr_Stock_Price:  102.83403873451282
curr_Factors:  [102.83403873]
mat_Sqrt:  [[0.15]]
grads:  [0.00943585]
Stock Position:  0.009435850053181392
Bond Position:  [6.19615812]


portfolio before change:  [7.16792495]
curr_Stock_Price:  102.9456335260354
curr_Factors:  [102.94563353]
mat_Sqrt:  [[0.15]]
grads:  [0.02455773]
Stock Position:  0.024557725954795058
Bond Position:  [4.6398143]


portfolio before change:  [7.1515027]
curr_Stock_Price:  102.26510413661252
curr_Factors:  [102.26510414]
mat_Sqrt:  [[0.15]]
grads:  [-0.00911795]
Stock Position:  -0.009117953731927239
Bond Position:  [8.08395119]


portfolio before change:  [7.15335028]
curr_Stock_Price:  102.11788727582733
curr_Factors:  [102.11788728]
mat_Sqrt:  [[0.15]]
grads:  [0.05714512]
Stock Position:  0.05714511517466108
Bond Position:  [1.31781185]


portfolio before change:  [7.15099956]
curr_Stock_Price:  102.0753100066444
curr_Factors:  [102.07531001]
mat_Sqrt:  [[0.15]]
grads:  [-0.06591546]
Stock Position:  -0.0659154569137478
Bond Position:  [13.87934026]


portfolio before change:  [7.16152832]
curr_Stock_Price:  101.92873929455939
curr_Factors:  [101.92873929]
mat_Sqrt:  [[0.15]]
grads:  [-0.09888002]
Stock Position:  -0.09888001643019496
Bond Position:  [17.24024374]


portfolio before change:  [7.19266155]
curr_Stock_Price:  101.62477820406298
curr_Factors:  [101.6247782]
mat_Sqrt:  [[0.15]]
grads:  [0.08928099]
Stock Position:  0.0892809879861364
Bond Position:  [-1.88049905]


portfolio before change:  [7.14505277]
curr_Stock_Price:  101.09284810605557
curr_Factors:  [101.09284811]
mat_Sqrt:  [[0.15]]
grads:  [0.04397838]
Stock Position:  0.0439783762427703
Bond Position:  [2.69915346]


portfolio before change:  [7.15734131]
curr_Stock_Price:  101.368434412658
curr_Factors:  [101.36843441]
mat_Sqrt:  [[0.15]]
grads:  [0.06584]
Stock Position:  0.06583999733218006
Bond Position:  [0.48324386]


portfolio before change:  [7.12199443]
curr_Stock_Price:  100.8311153247725
curr_Factors:  [100.83111532]
mat_Sqrt:  [[0.15]]
grads:  [-0.08584011]
Stock Position:  -0.08584011042036951
Bond Position:  [15.7773485]


portfolio before change:  [7.0724342]
curr_Stock_Price:  101.41995825283617
curr_Factors:  [101.41995825]
mat_Sqrt:  [[0.15]]
grads:  [-0.08404758]
Stock Position:  -0.08404758367863083
Bond Position:  [15.59653663]


portfolio before change:  [7.06002811]
curr_Stock_Price:  101.5791645529531
curr_Factors:  [101.57916455]
mat_Sqrt:  [[0.15]]
grads:  [-0.01785697]
Stock Position:  -0.017856972078076325
Bond Position:  [8.87392441]


portfolio before change:  [7.06123138]
curr_Stock_Price:  101.54284060658017
curr_Factors:  [101.54284061]
mat_Sqrt:  [[0.15]]
grads:  [-0.11664069]
Stock Position:  -0.11664068851487785
Bond Position:  [18.90525822]


portfolio before change:  [7.1058597]
curr_Stock_Price:  101.17035736929469
curr_Factors:  [101.17035737]
mat_Sqrt:  [[0.15]]
grads:  [0.14782712]
Stock Position:  0.14782712226600586
Bond Position:  [-7.84986309]


portfolio before change:  [7.31331849]
curr_Stock_Price:  102.57706421049603
curr_Factors:  [102.57706421]
mat_Sqrt:  [[0.15]]
grads:  [0.19616328]
Stock Position:  0.1961632764411156
Bond Position:  [-12.80853451]


portfolio before change:  [7.15135886]
curr_Stock_Price:  101.7555084168632
curr_Factors:  [101.75550842]
mat_Sqrt:  [[0.15]]
grads:  [0.01177691]
Stock Position:  0.011776905447701675
Bond Position:  [5.95299385]


portfolio before change:  [7.15550613]
curr_Stock_Price:  102.07606846150746
curr_Factors:  [102.07606846]
mat_Sqrt:  [[0.15]]
grads:  [0.04467599]
Stock Position:  0.044675989047055956
Bond Position:  [2.59515682]


portfolio before change:  [7.21557474]
curr_Stock_Price:  103.4169766248549
curr_Factors:  [103.41697662]
mat_Sqrt:  [[0.15]]
grads:  [-0.12890553]
Stock Position:  -0.1289055256380426
Bond Position:  [20.54659447]


portfolio before change:  [7.21577898]
curr_Stock_Price:  103.42535451552097
curr_Factors:  [103.42535452]
mat_Sqrt:  [[0.15]]
grads:  [-0.05140605]
Stock Position:  -0.051406053781882594
Bond Position:  [12.53246832]


portfolio before change:  [7.19677044]
curr_Stock_Price:  103.81036448363102
curr_Factors:  [103.81036448]
mat_Sqrt:  [[0.15]]
grads:  [-0.04816324]
Stock Position:  -0.04816323997489068
Bond Position:  [12.19661394]


portfolio before change:  [7.18244739]
curr_Stock_Price:  104.12357779408741
curr_Factors:  [104.12357779]
mat_Sqrt:  [[0.15]]
grads:  [0.0404186]
Stock Position:  0.0404185998634795
Bond Position:  [2.97391816]


portfolio before change:  [7.1877155]
curr_Stock_Price:  104.24931797946105
curr_Factors:  [104.24931798]
mat_Sqrt:  [[0.15]]
grads:  [0.04568754]
Stock Position:  0.04568753674511996
Bond Position:  [2.42482096]


portfolio before change:  [7.18888091]
curr_Stock_Price:  104.27150899216988
curr_Factors:  [104.27150899]
mat_Sqrt:  [[0.15]]
grads:  [-0.00415882]
Stock Position:  -0.004158824832064915
Bond Position:  [7.62252785]


portfolio before change:  [7.18752541]
curr_Stock_Price:  104.71200137848507
curr_Factors:  [104.71200138]
mat_Sqrt:  [[0.15]]
grads:  [-0.02118604]
Stock Position:  -0.021186040559959183
Bond Position:  [9.40595811]


portfolio before change:  [7.19696282]
curr_Stock_Price:  104.29429602292215
curr_Factors:  [104.29429602]
mat_Sqrt:  [[0.15]]
grads:  [0.05867413]
Stock Position:  0.058674134879735086
Bond Position:  [1.07758523]


portfolio before change:  [7.22973523]
curr_Stock_Price:  104.85169771121146
curr_Factors:  [104.85169771]
mat_Sqrt:  [[0.15]]
grads:  [-0.02470063]
Stock Position:  -0.02470062767657939
Bond Position:  [9.81963798]


portfolio before change:  [7.237223]
curr_Stock_Price:  104.57340421038795
curr_Factors:  [104.57340421]
mat_Sqrt:  [[0.15]]
grads:  [0.16095843]
Stock Position:  0.16095842500786647
Bond Position:  [-9.59474744]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.237223]
Stock Price:  104.58662132095851
PL:  [2.65060168]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.70807050e-02]
 [-4.17133355e-04]
 [ 1.09201424e-04]
 [ 2.17135877e-03]
 [ 8.22319814e-03]
 [ 1.20969921e-02]
 [ 1.17350067e-03]
 [ 1.29797199e-02]
 [ 1.29051387e-02]
 [ 3.71790612e-03]
 [ 8.66315213e-03]
 [-1.06488808e-02]
 [ 5.39342100e-03]
 [ 4.47866727e-03]
 [-1.80443907e-02]
 [ 1.70011810e-02]
 [-5.42491683e-03]
 [-1.49425272e-02]
 [-3.20753439e-02]
 [ 1.46371334e-02]
 [-5.72062555e-02]
 [-2.82654010e-02]
 [ 4.80581022e-04]
 [ 6.94345088e-03]
 [-3.74940615e-03]
 [ 1.50170175e-02]
 [ 1.48612313e-02]
 [-1.00050933e-02]
 [ 1.82798595e-03]
 [ 2.29621168e-03]
 [-3.42042832e-03]
 [-2.09749646e-02]
 [ 2.05712201e-02]
 [ 1.00071553e-02]
 [-2.66984965e-02]
 [ 7.89609237e-03]
 [-2.79164007e-03]
 [ 5.19540186e-03]
 [ 3.86317571e-03]
 [-1.51536113e-02]
 [ 3.57478602e-02]
 [-6.70077717e-04]
 [ 4.90631911e-03]
 [-8.60313695e-03]
 [ 7.68145084e-04]
 [-7.16036786e-03]
 [-1.35983314e-02]
 [-7.76125427e-04]
 [-7.92967368e-03]
 [ 8.79811182e-03]
 [-3.12711573e-03]
 [ 3.48046056e-03]
 [ 1.66030691e-03]
 [-2.12267858e-03]
 [ 2.27985622e-03]
 [ 8.98481552e-03]
 [ 1.68188947e-02]
 [-2.21158468e-02]
 [ 1.39782489e-02]
 [ 3.13393486e-03]
 [ 4.70741104e-03]
 [-1.52930932e-02]
 [-1.26625119e-02]
 [-1.02679275e-03]
 [-1.07565461e-02]
 [-1.68983665e-02]
 [ 9.90636451e-03]
 [ 2.26084555e-03]
 [ 1.09581874e-02]
 [-1.74939313e-02]
 [ 3.18212370e-03]
 [ 1.99720357e-03]
 [ 1.44282492e-03]
 [ 8.78001773e-03]
 [ 1.20510685e-02]
 [-8.21056773e-03]
 [-5.72893999e-03]
 [-8.90831728e-03]
 [-9.99696740e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.42542637]
curr_Stock_Price:  99.5827629885572
curr_Factors:  [99.58276299]
mat_Sqrt:  [[0.15]]
grads:  [-0.2472047]
Stock Position:  -0.24720469970398248
Bond Position:  [20.19190065]


portfolio before change:  [-4.46992961]
curr_Stock_Price:  99.76789407723857
curr_Factors:  [99.76789408]
mat_Sqrt:  [[0.15]]
grads:  [-0.00278089]
Stock Position:  -0.002780889033684538
Bond Position:  [-4.19248617]


portfolio before change:  [-4.46995052]
curr_Stock_Price:  99.68118323640945
curr_Factors:  [99.68118324]
mat_Sqrt:  [[0.15]]
grads:  [0.00072801]
Stock Position:  0.0007280094951409948
Bond Position:  [-4.54251937]


portfolio before change:  [-4.46993735]
curr_Stock_Price:  100.08926430228448
curr_Factors:  [100.0892643]
mat_Sqrt:  [[0.15]]
grads:  [0.01447573]
Stock Position:  0.01447572511758385
Bond Position:  [-5.91880202]


portfolio before change:  [-4.46355297]
curr_Stock_Price:  100.55585992372325
curr_Factors:  [100.55585992]
mat_Sqrt:  [[0.15]]
grads:  [0.05482132]
Stock Position:  0.054821320932771714
Bond Position:  [-9.97615804]


portfolio before change:  [-4.49221696]
curr_Stock_Price:  100.04437182972408
curr_Factors:  [100.04437183]
mat_Sqrt:  [[0.15]]
grads:  [0.08064661]
Stock Position:  0.08064661428837941
Bond Position:  [-12.56045682]


portfolio before change:  [-4.51886329]
curr_Stock_Price:  99.72369768118719
curr_Factors:  [99.72369768]
mat_Sqrt:  [[0.15]]
grads:  [0.00782334]
Stock Position:  0.007823337827334608
Bond Position:  [-5.29903547]


portfolio before change:  [-4.52074176]
curr_Stock_Price:  99.52592218437526
curr_Factors:  [99.52592218]
mat_Sqrt:  [[0.15]]
grads:  [0.08653147]
Stock Position:  0.08653146593001057
Bond Position:  [-13.1328657]


portfolio before change:  [-4.60114397]
curr_Stock_Price:  98.6062407302092
curr_Factors:  [98.60624073]
mat_Sqrt:  [[0.15]]
grads:  [0.08603426]
Stock Position:  0.08603425772940557
Bond Position:  [-13.0846587]


portfolio before change:  [-4.62999085]
curr_Stock_Price:  98.28045122848222
curr_Factors:  [98.28045123]
mat_Sqrt:  [[0.15]]
grads:  [0.02478604]
Stock Position:  0.024786040780137505
Bond Position:  [-7.06597412]


portfolio before change:  [-4.64249431]
curr_Stock_Price:  97.79381341759384
curr_Factors:  [97.79381342]
mat_Sqrt:  [[0.15]]
grads:  [0.05775435]
Stock Position:  0.057754347523930445
Bond Position:  [-10.2905122]


portfolio before change:  [-4.66278808]
curr_Stock_Price:  97.45356900608829
curr_Factors:  [97.45356901]
mat_Sqrt:  [[0.15]]
grads:  [-0.07099254]
Stock Position:  -0.07099253864908533
Bond Position:  [2.25568818]


portfolio before change:  [-4.68233326]
curr_Stock_Price:  97.73086801217809
curr_Factors:  [97.73086801]
mat_Sqrt:  [[0.15]]
grads:  [0.03595614]
Stock Position:  0.03595614001272986
Bond Position:  [-8.19635803]


portfolio before change:  [-4.66772942]
curr_Stock_Price:  98.15127255760002
curr_Factors:  [98.15127256]
mat_Sqrt:  [[0.15]]
grads:  [0.02985778]
Stock Position:  0.029857781768273438
Bond Position:  [-7.5983087]


portfolio before change:  [-4.67512556]
curr_Stock_Price:  97.91946590711626
curr_Factors:  [97.91946591]
mat_Sqrt:  [[0.15]]
grads:  [-0.12029594]
Stock Position:  -0.12029593798543815
Bond Position:  [7.10418844]


portfolio before change:  [-4.62056738]
curr_Stock_Price:  97.46962395025555
curr_Factors:  [97.46962395]
mat_Sqrt:  [[0.15]]
grads:  [0.11334121]
Stock Position:  0.11334120699261055
Bond Position:  [-15.6678922]


portfolio before change:  [-4.74704892]
curr_Stock_Price:  96.36232786562555
curr_Factors:  [96.36232787]
mat_Sqrt:  [[0.15]]
grads:  [-0.03616611]
Stock Position:  -0.03616611217708366
Bond Position:  [-1.26199816]


portfolio before change:  [-4.7349362]
curr_Stock_Price:  96.0252277943935
curr_Factors:  [96.02522779]
mat_Sqrt:  [[0.15]]
grads:  [-0.09961685]
Stock Position:  -0.09961684782106446
Bond Position:  [4.8307943]


portfolio before change:  [-4.77803563]
curr_Stock_Price:  96.46091078917303
curr_Factors:  [96.46091079]
mat_Sqrt:  [[0.15]]
grads:  [-0.21383563]
Stock Position:  -0.21383562583570132
Bond Position:  [15.84874359]


portfolio before change:  [-4.83682914]
curr_Stock_Price:  96.74049040472431
curr_Factors:  [96.7404904]
mat_Sqrt:  [[0.15]]
grads:  [0.09758089]
Stock Position:  0.09758088942330521
Bond Position:  [-14.27685224]


portfolio before change:  [-4.8553611]
curr_Stock_Price:  96.55972113152883
curr_Factors:  [96.55972113]
mat_Sqrt:  [[0.15]]
grads:  [-0.38137504]
Stock Position:  -0.38137503674327966
Bond Position:  [31.9701061]


portfolio before change:  [-4.9249752]
curr_Stock_Price:  96.74749508969026
curr_Factors:  [96.74749509]
mat_Sqrt:  [[0.15]]
grads:  [-0.18843601]
Stock Position:  -0.18843600641635536
Bond Position:  [13.3057364]


portfolio before change:  [-4.99962436]
curr_Stock_Price:  97.14805965951122
curr_Factors:  [97.14805966]
mat_Sqrt:  [[0.15]]
grads:  [0.00320387]
Stock Position:  0.0032038734822059656
Bond Position:  [-5.31087445]


portfolio before change:  [-4.99831186]
curr_Stock_Price:  97.66132624886127
curr_Factors:  [97.66132625]
mat_Sqrt:  [[0.15]]
grads:  [0.04628967]
Stock Position:  0.04628967250031967
Bond Position:  [-9.51902266]


portfolio before change:  [-5.03198448]
curr_Stock_Price:  96.94674637861293
curr_Factors:  [96.94674638]
mat_Sqrt:  [[0.15]]
grads:  [-0.02499604]
Stock Position:  -0.024996041008680334
Bond Position:  [-2.60869963]


portfolio before change:  [-5.05074139]
curr_Stock_Price:  97.69061873396322
curr_Factors:  [97.69061873]
mat_Sqrt:  [[0.15]]
grads:  [0.10011345]
Stock Position:  0.10011344989043776
Bond Position:  [-14.83088626]


portfolio before change:  [-5.05672437]
curr_Stock_Price:  97.64011586990502
curr_Factors:  [97.64011587]
mat_Sqrt:  [[0.15]]
grads:  [0.09907488]
Stock Position:  0.09907487500385222
Bond Position:  [-14.73040664]


portfolio before change:  [-5.07510034]
curr_Stock_Price:  97.46393303713805
curr_Factors:  [97.46393304]
mat_Sqrt:  [[0.15]]
grads:  [-0.06670062]
Stock Position:  -0.06670062200184462
Bond Position:  [1.42580462]


portfolio before change:  [-5.13922276]
curr_Stock_Price:  98.42661567921922
curr_Factors:  [98.42661568]
mat_Sqrt:  [[0.15]]
grads:  [0.01218657]
Stock Position:  0.01218657297590407
Bond Position:  [-6.33870589]


portfolio before change:  [-5.15931917]
curr_Stock_Price:  96.81006309816667
curr_Factors:  [96.8100631]
mat_Sqrt:  [[0.15]]
grads:  [0.01530808]
Stock Position:  0.015308077890588273
Bond Position:  [-6.64129516]


portfolio before change:  [-5.15958919]
curr_Stock_Price:  96.81953994033147
curr_Factors:  [96.81953994]
mat_Sqrt:  [[0.15]]
grads:  [-0.02280286]
Stock Position:  -0.02280285545634568
Bond Position:  [-2.95182722]


portfolio before change:  [-5.17567295]
curr_Stock_Price:  97.51678860651228
curr_Factors:  [97.51678861]
mat_Sqrt:  [[0.15]]
grads:  [-0.1398331]
Stock Position:  -0.13983309764000332
Bond Position:  [8.46040167]


portfolio before change:  [-5.06971019]
curr_Stock_Price:  96.7627899294906
curr_Factors:  [96.76278993]
mat_Sqrt:  [[0.15]]
grads:  [0.13714147]
Stock Position:  0.13714146762316462
Bond Position:  [-18.33990121]


portfolio before change:  [-5.04687847]
curr_Stock_Price:  96.93763127222438
curr_Factors:  [96.93763127]
mat_Sqrt:  [[0.15]]
grads:  [0.06671437]
Stock Position:  0.06671436892850946
Bond Position:  [-11.51401137]


portfolio before change:  [-5.0596698]
curr_Stock_Price:  96.7566855421033
curr_Factors:  [96.75668554]
mat_Sqrt:  [[0.15]]
grads:  [-0.17798998]
Stock Position:  -0.17798997640413877
Bond Position:  [12.16205038]


portfolio before change:  [-5.12972708]
curr_Stock_Price:  97.1545587251672
curr_Factors:  [97.15455873]
mat_Sqrt:  [[0.15]]
grads:  [0.05264062]
Stock Position:  0.05264061582233896
Bond Position:  [-10.24400289]


portfolio before change:  [-5.11649829]
curr_Stock_Price:  97.41802568057139
curr_Factors:  [97.41802568]
mat_Sqrt:  [[0.15]]
grads:  [-0.01861093]
Stock Position:  -0.018610933791699424
Bond Position:  [-3.30345787]


portfolio before change:  [-5.12488323]
curr_Stock_Price:  97.85746992517613
curr_Factors:  [97.85746993]
mat_Sqrt:  [[0.15]]
grads:  [0.03463601]
Stock Position:  0.03463601237341197
Bond Position:  [-8.51427577]


portfolio before change:  [-5.12379546]
curr_Stock_Price:  97.90424014007999
curr_Factors:  [97.90424014]
mat_Sqrt:  [[0.15]]
grads:  [0.0257545]
Stock Position:  0.025754504704426744
Bond Position:  [-7.64527067]


portfolio before change:  [-5.12584139]
curr_Stock_Price:  97.84335396709128
curr_Factors:  [97.84335397]
mat_Sqrt:  [[0.15]]
grads:  [-0.10102408]
Stock Position:  -0.10102407556903154
Bond Position:  [4.75869299]


portfolio before change:  [-5.09920072]
curr_Stock_Price:  97.58259186871169
curr_Factors:  [97.58259187]
mat_Sqrt:  [[0.15]]
grads:  [0.23831907]
Stock Position:  0.2383190676901435
Bond Position:  [-28.35499303]


portfolio before change:  [-5.07772925]
curr_Stock_Price:  97.68012375971725
curr_Factors:  [97.68012376]
mat_Sqrt:  [[0.15]]
grads:  [-0.00446718]
Stock Position:  -0.004467184779954367
Bond Position:  [-4.64137409]


portfolio before change:  [-5.07827621]
curr_Stock_Price:  97.73762320120258
curr_Factors:  [97.7376232]
mat_Sqrt:  [[0.15]]
grads:  [0.03270879]
Stock Position:  0.03270879403873912
Bond Position:  [-8.27515599]


portfolio before change:  [-5.08843539]
curr_Stock_Price:  97.44284103164163
curr_Factors:  [97.44284103]
mat_Sqrt:  [[0.15]]
grads:  [-0.05735425]
Stock Position:  -0.05735424630318196
Bond Position:  [0.50032532]


portfolio before change:  [-5.09033199]
curr_Stock_Price:  97.47645444540943
curr_Factors:  [97.47645445]
mat_Sqrt:  [[0.15]]
grads:  [0.00512097]
Stock Position:  0.005120967224645823
Bond Position:  [-5.58950572]


portfolio before change:  [-5.09243211]
curr_Stock_Price:  97.13457220348013
curr_Factors:  [97.1345722]
mat_Sqrt:  [[0.15]]
grads:  [-0.04773579]
Stock Position:  -0.04773578571749866
Bond Position:  [-0.45563699]


portfolio before change:  [-5.1200101]
curr_Stock_Price:  97.7116971462752
curr_Factors:  [97.71169715]
mat_Sqrt:  [[0.15]]
grads:  [-0.09065554]
Stock Position:  -0.09065554262188359
Bond Position:  [3.73809682]


portfolio before change:  [-5.10326104]
curr_Stock_Price:  97.52951933547814
curr_Factors:  [97.52951934]
mat_Sqrt:  [[0.15]]
grads:  [-0.00517417]
Stock Position:  -0.0051741695121101825
Bond Position:  [-4.59862677]


portfolio before change:  [-5.10967341]
curr_Stock_Price:  98.71327382731184
curr_Factors:  [98.71327383]
mat_Sqrt:  [[0.15]]
grads:  [-0.05286449]
Stock Position:  -0.052864491189091777
Bond Position:  [0.10875359]


portfolio before change:  [-5.10184349]
curr_Stock_Price:  98.56528939166682
curr_Factors:  [98.56528939]
mat_Sqrt:  [[0.15]]
grads:  [0.05865408]
Stock Position:  0.05865407880489955
Bond Position:  [-10.88309974]


portfolio before change:  [-5.08247272]
curr_Stock_Price:  98.90714086873005
curr_Factors:  [98.90714087]
mat_Sqrt:  [[0.15]]
grads:  [-0.02084744]
Stock Position:  -0.02084743822396543
Bond Position:  [-3.02051221]


portfolio before change:  [-5.09242835]
curr_Stock_Price:  99.37563206725154
curr_Factors:  [99.37563207]
mat_Sqrt:  [[0.15]]
grads:  [0.02320307]
Stock Position:  0.02320307038918681
Bond Position:  [-7.39824813]


portfolio before change:  [-5.08603773]
curr_Stock_Price:  99.67098178816198
curr_Factors:  [99.67098179]
mat_Sqrt:  [[0.15]]
grads:  [0.01106871]
Stock Position:  0.011068712748909911
Bond Position:  [-6.1892672]


portfolio before change:  [-5.08124919]
curr_Stock_Price:  100.13855010184703
curr_Factors:  [100.1385501]
mat_Sqrt:  [[0.15]]
grads:  [-0.01415119]
Stock Position:  -0.014151190528871843
Bond Position:  [-3.66416949]


portfolio before change:  [-5.07573867]
curr_Stock_Price:  99.73296257120569
curr_Factors:  [99.73296257]
mat_Sqrt:  [[0.15]]
grads:  [0.01519904]
Stock Position:  0.015199041446827426
Bond Position:  [-6.5915841]


portfolio before change:  [-5.07810279]
curr_Stock_Price:  99.60452449985104
curr_Factors:  [99.6045245]
mat_Sqrt:  [[0.15]]
grads:  [0.05989877]
Stock Position:  0.05989877010633554
Bond Position:  [-11.0442913]


portfolio before change:  [-5.10556736]
curr_Stock_Price:  99.15753235904259
curr_Factors:  [99.15753236]
mat_Sqrt:  [[0.15]]
grads:  [0.11212596]
Stock Position:  0.11212596471856878
Bond Position:  [-16.22370133]


portfolio before change:  [-5.13823716]
curr_Stock_Price:  98.87520887228035
curr_Factors:  [98.87520887]
mat_Sqrt:  [[0.15]]
grads:  [-0.14743898]
Stock Position:  -0.14743897834010075
Bond Position:  [9.43982262]


portfolio before change:  [-5.20318526]
curr_Stock_Price:  99.31971889288603
curr_Factors:  [99.31971889]
mat_Sqrt:  [[0.15]]
grads:  [0.09318833]
Stock Position:  0.09318832602052285
Bond Position:  [-14.4586236]


portfolio before change:  [-5.27534778]
curr_Stock_Price:  98.55504342388979
curr_Factors:  [98.55504342]
mat_Sqrt:  [[0.15]]
grads:  [0.0208929]
Stock Position:  0.020892899084365178
Bond Position:  [-7.33444835]


portfolio before change:  [-5.27853881]
curr_Stock_Price:  98.42425193630747
curr_Factors:  [98.42425194]
mat_Sqrt:  [[0.15]]
grads:  [0.03138274]
Stock Position:  0.03138274028825951
Bond Position:  [-8.36736155]


portfolio before change:  [-5.29057878]
curr_Stock_Price:  98.05726709168981
curr_Factors:  [98.05726709]
mat_Sqrt:  [[0.15]]
grads:  [-0.10195395]
Stock Position:  -0.10195395460136193
Bond Position:  [4.70674738]


portfolio before change:  [-5.27907352]
curr_Stock_Price:  97.94730491875656
curr_Factors:  [97.94730492]
mat_Sqrt:  [[0.15]]
grads:  [-0.08441675]
Stock Position:  -0.08441674609627596
Bond Position:  [2.98931925]


portfolio before change:  [-5.25878805]
curr_Stock_Price:  97.70921681101626
curr_Factors:  [97.70921681]
mat_Sqrt:  [[0.15]]
grads:  [-0.00684529]
Stock Position:  -0.006845285007182092
Bond Position:  [-4.58994062]


portfolio before change:  [-5.26078939]
curr_Stock_Price:  97.9596745418882
curr_Factors:  [97.95967454]
mat_Sqrt:  [[0.15]]
grads:  [-0.07171031]
Stock Position:  -0.07171030758464217
Bond Position:  [1.763929]


portfolio before change:  [-5.24561519]
curr_Stock_Price:  97.74960778314055
curr_Factors:  [97.74960778]
mat_Sqrt:  [[0.15]]
grads:  [-0.11265578]
Stock Position:  -0.1126557766739622
Bond Position:  [5.7664428]


portfolio before change:  [-5.20312294]
curr_Stock_Price:  97.37562046814811
curr_Factors:  [97.37562047]
mat_Sqrt:  [[0.15]]
grads:  [0.06604243]
Stock Position:  0.06604243004245057
Bond Position:  [-11.63404555]


portfolio before change:  [-5.1911193]
curr_Stock_Price:  97.5683874260252
curr_Factors:  [97.56838743]
mat_Sqrt:  [[0.15]]
grads:  [0.0150723]
Stock Position:  0.015072303641071733
Bond Position:  [-6.66169966]


portfolio before change:  [-5.19464115]
curr_Stock_Price:  97.36234855643866
curr_Factors:  [97.36234856]
mat_Sqrt:  [[0.15]]
grads:  [0.07305458]
Stock Position:  0.07305458298302535
Bond Position:  [-12.30740692]


portfolio before change:  [-5.18692392]
curr_Stock_Price:  97.47851461328099
curr_Factors:  [97.47851461]
mat_Sqrt:  [[0.15]]
grads:  [-0.11662621]
Stock Position:  -0.11662620846548326
Bond Position:  [6.18162565]


portfolio before change:  [-5.19563736]
curr_Stock_Price:  97.55653998364407
curr_Factors:  [97.55653998]
mat_Sqrt:  [[0.15]]
grads:  [0.02121416]
Stock Position:  0.021214157977677534
Bond Position:  [-7.26521721]


portfolio before change:  [-5.19133801]
curr_Stock_Price:  97.78060911097731
curr_Factors:  [97.78060911]
mat_Sqrt:  [[0.15]]
grads:  [0.01331469]
Stock Position:  0.013314690459868054
Bond Position:  [-6.49325655]


portfolio before change:  [-5.18115793]
curr_Stock_Price:  98.57566514323999
curr_Factors:  [98.57566514]
mat_Sqrt:  [[0.15]]
grads:  [0.00961883]
Stock Position:  0.009618832771672456
Bond Position:  [-6.12934077]


portfolio before change:  [-5.17311292]
curr_Stock_Price:  99.45187384558686
curr_Factors:  [99.45187385]
mat_Sqrt:  [[0.15]]
grads:  [0.05853345]
Stock Position:  0.05853345152874946
Bond Position:  [-10.99437436]


portfolio before change:  [-5.14171149]
curr_Stock_Price:  100.00008341457013
curr_Factors:  [100.00008341]
mat_Sqrt:  [[0.15]]
grads:  [0.08034046]
Stock Position:  0.08034045676086353
Bond Position:  [-13.17576387]


portfolio before change:  [-5.15063887]
curr_Stock_Price:  99.89921436637243
curr_Factors:  [99.89921437]
mat_Sqrt:  [[0.15]]
grads:  [-0.05473712]
Stock Position:  -0.05473711819910773
Bond Position:  [0.31755624]


portfolio before change:  [-5.09741466]
curr_Stock_Price:  98.92721663049963
curr_Factors:  [98.92721663]
mat_Sqrt:  [[0.15]]
grads:  [-0.03819293]
Stock Position:  -0.03819293324703068
Bond Position:  [-1.31909408]


portfolio before change:  [-5.10327833]
curr_Stock_Price:  99.07858560866792
curr_Factors:  [99.07858561]
mat_Sqrt:  [[0.15]]
grads:  [-0.05938878]
Stock Position:  -0.05938878188291714
Bond Position:  [0.78087818]


portfolio before change:  [-5.04994891]
curr_Stock_Price:  98.18143607020238
curr_Factors:  [98.18143607]
mat_Sqrt:  [[0.15]]
grads:  [-0.06664645]
Stock Position:  -0.06664644932291251
Bond Position:  [1.49349519]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.04994891]
Stock Price:  99.2425821787075
PL:  [-5.04994891]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.95070394e-02]
 [ 5.68140585e-03]
 [-7.93894320e-04]
 [-2.43524640e-03]
 [-3.02008130e-03]
 [ 8.88832266e-03]
 [ 1.06296885e-03]
 [ 1.29900314e-02]
 [ 1.75211188e-02]
 [-1.90178782e-02]
 [ 1.00256123e-02]
 [-6.19878442e-03]
 [-9.34975328e-03]
 [ 4.27550054e-03]
 [ 3.98324392e-03]
 [-7.76763610e-03]
 [ 1.32729871e-02]
 [ 2.31101769e-02]
 [ 2.04141606e-02]
 [ 1.25829453e-03]
 [ 7.84177594e-02]
 [-1.30663089e-02]
 [ 5.72051390e-03]
 [-4.18014081e-03]
 [ 1.77408167e-02]
 [ 1.75202715e-02]
 [ 9.34794899e-03]
 [ 5.47530874e-04]
 [ 5.62477349e-03]
 [-1.84900817e-02]
 [-5.68565398e-03]
 [ 2.24126296e-02]
 [ 1.18901649e-02]
 [ 1.35700273e-02]
 [ 3.83296154e-03]
 [-4.67723934e-03]
 [-6.72738158e-03]
 [ 8.57846360e-03]
 [ 8.62214728e-05]
 [-1.07709733e-02]
 [-4.87727119e-03]
 [-2.92154957e-03]
 [ 5.67533208e-03]
 [-1.40770760e-02]
 [ 7.60191381e-04]
 [ 2.14147958e-03]
 [-1.36508926e-02]
 [-3.70501847e-03]
 [ 7.89784448e-05]
 [ 4.71557866e-03]
 [-2.97961072e-03]
 [ 3.62322180e-03]
 [ 2.93364472e-05]
 [ 2.05771692e-03]
 [-4.05480855e-04]
 [ 8.51387189e-03]
 [-4.51989010e-03]
 [-2.10752901e-02]
 [ 1.38878602e-02]
 [ 8.64925054e-03]
 [ 9.67947023e-03]
 [-1.27482300e-02]
 [-1.25871680e-02]
 [-2.29781733e-03]
 [-1.98953901e-02]
 [ 4.27828517e-02]
 [ 1.92018816e-02]
 [ 2.20796703e-03]
 [ 6.15353064e-03]
 [-1.44286780e-02]
 [-5.62894831e-03]
 [-1.17777518e-03]
 [ 1.98707409e-03]
 [ 8.82170038e-03]
 [ 1.13206253e-02]
 [-8.36860322e-03]
 [-3.20688933e-03]
 [-8.53485903e-03]
 [ 3.13443098e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.07334995]
curr_Stock_Price:  99.41257919360064
curr_Factors:  [99.41257919]
mat_Sqrt:  [[0.15]]
grads:  [-0.26338026]
Stock Position:  -0.2633802623565309
Bond Position:  [19.10996124]


portfolio before change:  [-6.97608548]
curr_Stock_Price:  99.04782119683748
curr_Factors:  [99.0478212]
mat_Sqrt:  [[0.15]]
grads:  [0.03787604]
Stock Position:  0.037876038967597725
Bond Position:  [-10.72762462]


portfolio before change:  [-6.99059117]
curr_Stock_Price:  98.68254574100452
curr_Factors:  [98.68254574]
mat_Sqrt:  [[0.15]]
grads:  [-0.00529263]
Stock Position:  -0.005292628801517854
Bond Position:  [-6.46830108]


portfolio before change:  [-6.98821334]
curr_Stock_Price:  98.1568883955157
curr_Factors:  [98.1568884]
mat_Sqrt:  [[0.15]]
grads:  [-0.01623498]
Stock Position:  -0.016234975997018196
Bond Position:  [-5.39463861]


portfolio before change:  [-7.00765644]
curr_Stock_Price:  99.33372565181003
curr_Factors:  [99.33372565]
mat_Sqrt:  [[0.15]]
grads:  [-0.02013388]
Stock Position:  -0.020133875316730804
Bond Position:  [-5.00768359]


portfolio before change:  [-7.00385296]
curr_Stock_Price:  99.12927063473153
curr_Factors:  [99.12927063]
mat_Sqrt:  [[0.15]]
grads:  [0.05925548]
Stock Position:  0.0592554843915382
Bond Position:  [-12.87780591]


portfolio before change:  [-6.92291653]
curr_Stock_Price:  100.50874328404956
curr_Factors:  [100.50874328]
mat_Sqrt:  [[0.15]]
grads:  [0.00708646]
Stock Position:  0.007086459023523796
Bond Position:  [-7.63516762]


portfolio before change:  [-6.93001925]
curr_Stock_Price:  99.57378985565931
curr_Factors:  [99.57378986]
mat_Sqrt:  [[0.15]]
grads:  [0.08660021]
Stock Position:  0.08660020965778592
Bond Position:  [-15.55313033]


portfolio before change:  [-6.94578979]
curr_Stock_Price:  99.40290759319697
curr_Factors:  [99.40290759]
mat_Sqrt:  [[0.15]]
grads:  [0.11680746]
Stock Position:  0.11680745879819879
Bond Position:  [-18.55679082]


portfolio before change:  [-6.9276492]
curr_Stock_Price:  99.56814038537013
curr_Factors:  [99.56814039]
mat_Sqrt:  [[0.15]]
grads:  [-0.12678585]
Stock Position:  -0.12678585486684144
Bond Position:  [5.69618259]


portfolio before change:  [-7.00368733]
curr_Stock_Price:  100.170685144498
curr_Factors:  [100.17068514]
mat_Sqrt:  [[0.15]]
grads:  [0.06683742]
Stock Position:  0.06683741510708703
Bond Position:  [-13.698837]


portfolio before change:  [-6.97715098]
curr_Stock_Price:  100.5805237992269
curr_Factors:  [100.5805238]
mat_Sqrt:  [[0.15]]
grads:  [-0.04132523]
Stock Position:  -0.041325229498992117
Bond Position:  [-2.82063775]


portfolio before change:  [-6.95493298]
curr_Stock_Price:  100.03862005962759
curr_Factors:  [100.03862006]
mat_Sqrt:  [[0.15]]
grads:  [-0.06233169]
Stock Position:  -0.062331688512813545
Bond Position:  [-0.71935687]


portfolio before change:  [-6.96561657]
curr_Stock_Price:  100.2092977469096
curr_Factors:  [100.20929775]
mat_Sqrt:  [[0.15]]
grads:  [0.02850334]
Stock Position:  0.028503336900571614
Bond Position:  [-9.82191594]


portfolio before change:  [-6.94203795]
curr_Stock_Price:  101.05805838823844
curr_Factors:  [101.05805839]
mat_Sqrt:  [[0.15]]
grads:  [0.02655496]
Stock Position:  0.026554959491300233
Bond Position:  [-9.62563059]


portfolio before change:  [-6.95204418]
curr_Stock_Price:  100.70390186551289
curr_Factors:  [100.70390187]
mat_Sqrt:  [[0.15]]
grads:  [-0.05178424]
Stock Position:  -0.05178424063374603
Bond Position:  [-1.73716909]


portfolio before change:  [-6.97743714]
curr_Stock_Price:  101.19216596081783
curr_Factors:  [101.19216596]
mat_Sqrt:  [[0.15]]
grads:  [0.08848658]
Stock Position:  0.0884865806676032
Bond Position:  [-15.9315859]


portfolio before change:  [-6.94631124]
curr_Stock_Price:  101.55517752147749
curr_Factors:  [101.55517752]
mat_Sqrt:  [[0.15]]
grads:  [0.15406785]
Stock Position:  0.1540678458244803
Bond Position:  [-22.59269868]


portfolio before change:  [-7.05613927]
curr_Stock_Price:  100.85148794145984
curr_Factors:  [100.85148794]
mat_Sqrt:  [[0.15]]
grads:  [0.1360944]
Stock Position:  0.1360944041212538
Bond Position:  [-20.78146243]


portfolio before change:  [-7.04030477]
curr_Stock_Price:  100.97738127296765
curr_Factors:  [100.97738127]
mat_Sqrt:  [[0.15]]
grads:  [0.00838863]
Stock Position:  0.008388630173940974
Bond Position:  [-7.88736668]


portfolio before change:  [-7.04635268]
curr_Stock_Price:  100.31518370110113
curr_Factors:  [100.3151837]
mat_Sqrt:  [[0.15]]
grads:  [0.52278506]
Stock Position:  0.5227850626090488
Bond Position:  [-59.48963227]


portfolio before change:  [-6.49118816]
curr_Stock_Price:  101.38423249437888
curr_Factors:  [101.38423249]
mat_Sqrt:  [[0.15]]
grads:  [-0.08710873]
Stock Position:  -0.08710872605566344
Bond Position:  [2.34026318]


portfolio before change:  [-6.47372223]
curr_Stock_Price:  101.18540448372771
curr_Factors:  [101.18540448]
mat_Sqrt:  [[0.15]]
grads:  [0.03813676]
Stock Position:  0.03813675935739532
Bond Position:  [-10.33260565]


portfolio before change:  [-6.45088073]
curr_Stock_Price:  101.80127509152291
curr_Factors:  [101.80127509]
mat_Sqrt:  [[0.15]]
grads:  [-0.02786761]
Stock Position:  -0.02786760536827295
Bond Position:  [-3.61392297]


portfolio before change:  [-6.48042339]
curr_Stock_Price:  102.85327722630494
curr_Factors:  [102.85327723]
mat_Sqrt:  [[0.15]]
grads:  [0.11827211]
Stock Position:  0.11827211137075945
Bond Position:  [-18.64509765]


portfolio before change:  [-6.45629455]
curr_Stock_Price:  103.06714158848162
curr_Factors:  [103.06714159]
mat_Sqrt:  [[0.15]]
grads:  [0.11680181]
Stock Position:  0.11680181013220506
Bond Position:  [-18.49472326]


portfolio before change:  [-6.45972126]
curr_Stock_Price:  103.04770058039887
curr_Factors:  [103.04770058]
mat_Sqrt:  [[0.15]]
grads:  [0.06231966]
Stock Position:  0.062319659914818935
Bond Position:  [-12.88161891]


portfolio before change:  [-6.45003797]
curr_Stock_Price:  103.21600083361213
curr_Factors:  [103.21600083]
mat_Sqrt:  [[0.15]]
grads:  [0.00365021]
Stock Position:  0.0036502058254836204
Bond Position:  [-6.82679762]


portfolio before change:  [-6.45395059]
curr_Stock_Price:  102.26100424805806
curr_Factors:  [102.26100425]
mat_Sqrt:  [[0.15]]
grads:  [0.03749849]
Stock Position:  0.03749848992298874
Bond Position:  [-10.28858383]


portfolio before change:  [-6.45909202]
curr_Stock_Price:  102.14104291284919
curr_Factors:  [102.14104291]
mat_Sqrt:  [[0.15]]
grads:  [-0.12326721]
Stock Position:  -0.12326721152360712
Bond Position:  [6.13154953]


portfolio before change:  [-6.49266921]
curr_Stock_Price:  102.41654544847727
curr_Factors:  [102.41654545]
mat_Sqrt:  [[0.15]]
grads:  [-0.03790436]
Stock Position:  -0.03790435984828727
Bond Position:  [-2.61063562]


portfolio before change:  [-6.46135022]
curr_Stock_Price:  101.58597720497932
curr_Factors:  [101.5859772]
mat_Sqrt:  [[0.15]]
grads:  [0.14941753]
Stock Position:  0.1494175305516867
Bond Position:  [-21.64007608]


portfolio before change:  [-6.61269383]
curr_Stock_Price:  100.58213875100442
curr_Factors:  [100.58213875]
mat_Sqrt:  [[0.15]]
grads:  [0.07926777]
Stock Position:  0.07926776610280852
Bond Position:  [-14.58561528]


portfolio before change:  [-6.60613594]
curr_Stock_Price:  100.67637027478713
curr_Factors:  [100.67637027]
mat_Sqrt:  [[0.15]]
grads:  [0.09046685]
Stock Position:  0.09046684859845847
Bond Position:  [-15.71400989]


portfolio before change:  [-6.61163448]
curr_Stock_Price:  100.6264472206751
curr_Factors:  [100.62644722]
mat_Sqrt:  [[0.15]]
grads:  [0.02555308]
Stock Position:  0.02555307693529315
Bond Position:  [-9.18294983]


portfolio before change:  [-6.5883854]
curr_Stock_Price:  101.55874299630955
curr_Factors:  [101.558743]
mat_Sqrt:  [[0.15]]
grads:  [-0.0311816]
Stock Position:  -0.031181595573247865
Bond Position:  [-3.42162175]


portfolio before change:  [-6.58086916]
curr_Stock_Price:  101.31083708123022
curr_Factors:  [101.31083708]
mat_Sqrt:  [[0.15]]
grads:  [-0.04484921]
Stock Position:  -0.044849210511405835
Bond Position:  [-2.0371581]


portfolio before change:  [-6.59255454]
curr_Stock_Price:  101.56854630121406
curr_Factors:  [101.5685463]
mat_Sqrt:  [[0.15]]
grads:  [0.05718976]
Stock Position:  0.05718975734536876
Bond Position:  [-12.40123506]


portfolio before change:  [-6.60612584]
curr_Stock_Price:  101.34479652766947
curr_Factors:  [101.34479653]
mat_Sqrt:  [[0.15]]
grads:  [0.00057481]
Stock Position:  0.000574809818336943
Bond Position:  [-6.66437982]


portfolio before change:  [-6.6066677]
curr_Stock_Price:  101.12676944216855
curr_Factors:  [101.12676944]
mat_Sqrt:  [[0.15]]
grads:  [-0.07180649]
Stock Position:  -0.07180648858700908
Bond Position:  [0.65489052]


portfolio before change:  [-6.58177654]
curr_Stock_Price:  100.78069723751986
curr_Factors:  [100.78069724]
mat_Sqrt:  [[0.15]]
grads:  [-0.03251514]
Stock Position:  -0.03251514125041571
Bond Position:  [-3.30487793]


portfolio before change:  [-6.56456499]
curr_Stock_Price:  100.24500503247076
curr_Factors:  [100.24500503]
mat_Sqrt:  [[0.15]]
grads:  [-0.019477]
Stock Position:  -0.01947699713896142
Bond Position:  [-4.61209331]


portfolio before change:  [-6.56059633]
curr_Stock_Price:  100.0264433866925
curr_Factors:  [100.02644339]
mat_Sqrt:  [[0.15]]
grads:  [0.03783555]
Stock Position:  0.037835547172594804
Bond Position:  [-10.34515155]


portfolio before change:  [-6.53936307]
curr_Stock_Price:  100.60473157664268
curr_Factors:  [100.60473158]
mat_Sqrt:  [[0.15]]
grads:  [-0.09384717]
Stock Position:  -0.09384717362033984
Bond Position:  [2.90210664]


portfolio before change:  [-6.6430691]
curr_Stock_Price:  101.7117166061396
curr_Factors:  [101.71171661]
mat_Sqrt:  [[0.15]]
grads:  [0.00506794]
Stock Position:  0.0050679425404331025
Bond Position:  [-7.15853824]


portfolio before change:  [-6.64321793]
curr_Stock_Price:  101.7706348147213
curr_Factors:  [101.77063481]
mat_Sqrt:  [[0.15]]
grads:  [0.01427653]
Stock Position:  0.014276530520235005
Bond Position:  [-8.09614951]


portfolio before change:  [-6.63579655]
curr_Stock_Price:  102.32591055623045
curr_Factors:  [102.32591056]
mat_Sqrt:  [[0.15]]
grads:  [-0.09100595]
Stock Position:  -0.09100595061888762
Bond Position:  [2.67647022]


portfolio before change:  [-6.57774596]
curr_Stock_Price:  101.68987197206889
curr_Factors:  [101.68987197]
mat_Sqrt:  [[0.15]]
grads:  [-0.02470012]
Stock Position:  -0.024700123121092044
Bond Position:  [-4.06599361]


portfolio before change:  [-6.55765059]
curr_Stock_Price:  100.86600950680374
curr_Factors:  [100.86600951]
mat_Sqrt:  [[0.15]]
grads:  [0.00052652]
Stock Position:  0.0005265229652675219
Bond Position:  [-6.61075886]


portfolio before change:  [-6.55814103]
curr_Stock_Price:  100.71929311584624
curr_Factors:  [100.71929312]
mat_Sqrt:  [[0.15]]
grads:  [0.03143719]
Stock Position:  0.03143719104718268
Bond Position:  [-9.72447269]


portfolio before change:  [-6.56388209]
curr_Stock_Price:  100.55600692377193
curr_Factors:  [100.55600692]
mat_Sqrt:  [[0.15]]
grads:  [-0.01986407]
Stock Position:  -0.01986407144614743
Bond Position:  [-4.56643038]


portfolio before change:  [-6.55014432]
curr_Stock_Price:  99.85005006312981
curr_Factors:  [99.85005006]
mat_Sqrt:  [[0.15]]
grads:  [0.02415481]
Stock Position:  0.024154811997971603
Bond Position:  [-8.96200351]


portfolio before change:  [-6.52248769]
curr_Stock_Price:  101.01821349497502
curr_Factors:  [101.01821349]
mat_Sqrt:  [[0.15]]
grads:  [0.00019558]
Stock Position:  0.0001955763146683504
Bond Position:  [-6.54224446]


portfolio before change:  [-6.52273692]
curr_Stock_Price:  101.83463263526751
curr_Factors:  [101.83463264]
mat_Sqrt:  [[0.15]]
grads:  [0.01371811]
Stock Position:  0.01371811278742334
Bond Position:  [-7.9197159]


portfolio before change:  [-6.51989929]
curr_Stock_Price:  102.07756921935639
curr_Factors:  [102.07756922]
mat_Sqrt:  [[0.15]]
grads:  [-0.00270321]
Stock Position:  -0.002703205700078544
Bond Position:  [-6.24396262]


portfolio before change:  [-6.51954921]
curr_Stock_Price:  101.80369357062226
curr_Factors:  [101.80369357]
mat_Sqrt:  [[0.15]]
grads:  [0.05675915]
Stock Position:  0.05675914590009366
Bond Position:  [-12.2978399]


portfolio before change:  [-6.55680194]
curr_Stock_Price:  101.16090565165729
curr_Factors:  [101.16090565]
mat_Sqrt:  [[0.15]]
grads:  [-0.0301326]
Stock Position:  -0.030132600654224382
Bond Position:  [-3.50856077]


portfolio before change:  [-6.53926747]
curr_Stock_Price:  100.57171788871685
curr_Factors:  [100.57171789]
mat_Sqrt:  [[0.15]]
grads:  [-0.14050193]
Stock Position:  -0.14050193370323216
Bond Position:  [7.59125337]


portfolio before change:  [-6.49042874]
curr_Stock_Price:  100.22749299740518
curr_Factors:  [100.227493]
mat_Sqrt:  [[0.15]]
grads:  [0.09258573]
Stock Position:  0.09258573444905811
Bond Position:  [-15.77006479]


portfolio before change:  [-6.49719933]
curr_Stock_Price:  100.16501111234614
curr_Factors:  [100.16501111]
mat_Sqrt:  [[0.15]]
grads:  [0.05766167]
Stock Position:  0.0576616702713217
Bond Position:  [-12.27288118]


portfolio before change:  [-6.44636465]
curr_Stock_Price:  101.05991688713107
curr_Factors:  [101.05991689]
mat_Sqrt:  [[0.15]]
grads:  [0.0645298]
Stock Position:  0.06452980156025337
Bond Position:  [-12.96774103]


portfolio before change:  [-6.47114142]
curr_Stock_Price:  100.68851848090857
curr_Factors:  [100.68851848]
mat_Sqrt:  [[0.15]]
grads:  [-0.0849882]
Stock Position:  -0.08498820029743974
Bond Position:  [2.08619455]


portfolio before change:  [-6.51776228]
curr_Stock_Price:  101.23860945966332
curr_Factors:  [101.23860946]
mat_Sqrt:  [[0.15]]
grads:  [-0.08391445]
Stock Position:  -0.08391445364274551
Bond Position:  [1.97762032]


portfolio before change:  [-6.48784885]
curr_Stock_Price:  100.88360723852657
curr_Factors:  [100.88360724]
mat_Sqrt:  [[0.15]]
grads:  [-0.01531878]
Stock Position:  -0.015318782198295706
Bond Position:  [-4.94243485]


portfolio before change:  [-6.48267522]
curr_Stock_Price:  100.52571042988616
curr_Factors:  [100.52571043]
mat_Sqrt:  [[0.15]]
grads:  [-0.13263593]
Stock Position:  -0.13263593370852156
Bond Position:  [6.85064624]


portfolio before change:  [-6.4291402]
curr_Stock_Price:  100.12531481981416
curr_Factors:  [100.12531482]
mat_Sqrt:  [[0.15]]
grads:  [0.28521901]
Stock Position:  0.2852190113231304
Bond Position:  [-34.9867835]


portfolio before change:  [-6.34293036]
curr_Stock_Price:  100.43524008838502
curr_Factors:  [100.43524009]
mat_Sqrt:  [[0.15]]
grads:  [0.12801254]
Stock Position:  0.12801254432632286
Bond Position:  [-19.19990098]


portfolio before change:  [-6.31892307]
curr_Stock_Price:  100.6321530113914
curr_Factors:  [100.63215301]
mat_Sqrt:  [[0.15]]
grads:  [0.01471978]
Stock Position:  0.014719780190412018
Bond Position:  [-7.80020624]


portfolio before change:  [-6.32796468]
curr_Stock_Price:  100.05102424532294
curr_Factors:  [100.05102425]
mat_Sqrt:  [[0.15]]
grads:  [0.04102354]
Stock Position:  0.04102353758456141
Bond Position:  [-10.43241164]


portfolio before change:  [-6.33284377]
curr_Stock_Price:  99.94798477040477
curr_Factors:  [99.94798477]
mat_Sqrt:  [[0.15]]
grads:  [-0.09619119]
Stock Position:  -0.09619118672620967
Bond Position:  [3.28127149]


portfolio before change:  [-6.29278548]
curr_Stock_Price:  99.53367227052622
curr_Factors:  [99.53367227]
mat_Sqrt:  [[0.15]]
grads:  [-0.03752632]
Stock Position:  -0.037526322075771654
Bond Position:  [-2.55765283]


portfolio before change:  [-6.28638894]
curr_Stock_Price:  99.35895777998843
curr_Factors:  [99.35895778]
mat_Sqrt:  [[0.15]]
grads:  [-0.00785183]
Stock Position:  -0.007851834533703646
Bond Position:  [-5.50623885]


portfolio before change:  [-6.29008509]
curr_Stock_Price:  99.78586359293561
curr_Factors:  [99.78586359]
mat_Sqrt:  [[0.15]]
grads:  [0.01324716]
Stock Position:  0.013247160568088029
Bond Position:  [-7.61196444]


portfolio before change:  [-6.28753333]
curr_Stock_Price:  100.01440450742852
curr_Factors:  [100.01440451]
mat_Sqrt:  [[0.15]]
grads:  [0.05881134]
Stock Position:  0.05881133589080546
Bond Position:  [-12.16951407]


portfolio before change:  [-6.2786135]
curr_Stock_Price:  100.17900621052694
curr_Factors:  [100.17900621]
mat_Sqrt:  [[0.15]]
grads:  [0.07547084]
Stock Position:  0.07547083535767996
Bond Position:  [-13.83920679]


portfolio before change:  [-6.29259609]
curr_Stock_Price:  100.00519594676429
curr_Factors:  [100.00519595]
mat_Sqrt:  [[0.15]]
grads:  [-0.05579069]
Stock Position:  -0.05579068811156156
Bond Position:  [-0.71323739]


portfolio before change:  [-6.2733598]
curr_Stock_Price:  99.65960305539089
curr_Factors:  [99.65960306]
mat_Sqrt:  [[0.15]]
grads:  [-0.02137926]
Stock Position:  -0.02137926221664146
Bond Position:  [-4.14271101]


portfolio before change:  [-6.28619112]
curr_Stock_Price:  100.24766778109706
curr_Factors:  [100.24766778]
mat_Sqrt:  [[0.15]]
grads:  [-0.05689906]
Stock Position:  -0.05689906017814393
Bond Position:  [-0.58219304]


portfolio before change:  [-6.28823941]
curr_Stock_Price:  100.28302692614284
curr_Factors:  [100.28302693]
mat_Sqrt:  [[0.15]]
grads:  [0.02089621]
Stock Position:  0.020896206551343315
Bond Position:  [-8.38377425]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.28823941]
Stock Price:  99.51915977658432
PL:  [-6.28823941]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [ 2.07826972e-02]
 [ 7.30009691e-03]
 [-9.79776587e-04]
 [-3.53256791e-04]
 [-1.28405314e-02]
 [ 4.74206289e-03]
 [ 4.54543628e-04]
 [ 1.09529027e-02]
 [ 8.94784111e-03]
 [-8.77665050e-03]
 [ 6.78936469e-03]
 [-7.92196568e-03]
 [-4.19561937e-03]
 [ 4.17562271e-03]
 [-9.44641626e-04]
 [ 2.13486221e-03]
 [ 3.30910993e-04]
 [ 9.09774159e-03]
 [ 1.99616268e-02]
 [ 7.60407827e-03]
 [ 5.23535785e-02]
 [-1.46731462e-02]
 [ 5.55161884e-03]
 [ 1.46408351e-03]
 [ 1.33767038e-02]
 [-7.89125227e-03]
 [ 1.25248260e-02]
 [-6.91628376e-03]
 [ 2.77893991e-03]
 [-2.07681176e-02]
 [-4.94988362e-03]
 [-4.39565718e-04]
 [ 1.55640947e-02]
 [ 1.92668485e-02]
 [-3.18434454e-03]
 [ 6.59384350e-03]
 [-2.43565319e-03]
 [ 9.86257309e-03]
 [ 3.09444321e-05]
 [-1.37132715e-02]
 [-2.24032001e-03]
 [-2.51725820e-03]
 [ 4.95939126e-03]
 [-1.47691906e-02]
 [-1.81439234e-04]
 [ 2.31385882e-03]
 [-1.36486172e-02]
 [ 3.04218484e-04]
 [ 3.32428128e-03]
 [-4.36266373e-03]
 [-3.45016401e-03]
 [ 3.50115268e-03]
 [ 1.58329324e-03]
 [ 3.78883319e-03]
 [-3.05101762e-03]
 [ 8.97667681e-03]
 [-4.69342624e-03]
 [-1.10634981e-02]
 [ 1.46144819e-02]
 [ 3.09889949e-03]
 [ 1.13764747e-02]
 [-1.39756181e-02]
 [-1.26269255e-02]
 [-2.32884923e-03]
 [-1.87154998e-02]
 [ 1.64802907e-02]
 [ 2.88356037e-02]
 [ 3.73334075e-03]
 [ 6.95464391e-03]
 [-1.35502530e-02]
 [-7.86734884e-03]
 [-7.94801079e-03]
 [ 1.92811507e-03]
 [ 7.25858055e-03]
 [-8.81120608e-04]
 [-4.97692876e-03]
 [ 8.62389745e-03]
 [-3.85252325e-03]
 [ 2.32897814e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.51584563]
curr_Stock_Price:  98.54862112960086
curr_Factors:  [98.54862113]
mat_Sqrt:  [[0.15]]
grads:  [0.13855131]
Stock Position:  0.13855131453805775
Bond Position:  [-34.16988663]


portfolio before change:  [-20.47477183]
curr_Stock_Price:  98.86048742890783
curr_Factors:  [98.86048743]
mat_Sqrt:  [[0.15]]
grads:  [0.04866731]
Stock Position:  0.048667312720783396
Bond Position:  [-25.28604608]


portfolio before change:  [-20.47213785]
curr_Stock_Price:  98.94708369044318
curr_Factors:  [98.94708369]
mat_Sqrt:  [[0.15]]
grads:  [-0.00653184]
Stock Position:  -0.0065318439135778755
Bond Position:  [-19.82583094]


portfolio before change:  [-20.47364733]
curr_Stock_Price:  98.98846947806295
curr_Factors:  [98.98846948]
mat_Sqrt:  [[0.15]]
grads:  [-0.00235505]
Stock Position:  -0.002355045274328076
Bond Position:  [-20.240525]


portfolio before change:  [-20.47465615]
curr_Stock_Price:  98.87966171718917
curr_Factors:  [98.87966172]
mat_Sqrt:  [[0.15]]
grads:  [-0.08560354]
Stock Position:  -0.08560354236527198
Bond Position:  [-12.01020684]


portfolio before change:  [-20.43417565]
curr_Stock_Price:  98.3980091872897
curr_Factors:  [98.39800919]
mat_Sqrt:  [[0.15]]
grads:  [0.03161375]
Stock Position:  0.03161375260960229
Bond Position:  [-23.54490597]


portfolio before change:  [-20.4248703]
curr_Stock_Price:  98.73890373980652
curr_Factors:  [98.73890374]
mat_Sqrt:  [[0.15]]
grads:  [0.00303029]
Stock Position:  0.003030290854390624
Bond Position:  [-20.72407789]


portfolio before change:  [-20.4265018]
curr_Stock_Price:  98.62795361246171
curr_Factors:  [98.62795361]
mat_Sqrt:  [[0.15]]
grads:  [0.07301935]
Stock Position:  0.07301935158448795
Bond Position:  [-27.62825102]


portfolio before change:  [-20.45921037]
curr_Stock_Price:  98.20365858899342
curr_Factors:  [98.20365859]
mat_Sqrt:  [[0.15]]
grads:  [0.05965227]
Stock Position:  0.059652274079253324
Bond Position:  [-26.31728193]


portfolio before change:  [-20.43591626]
curr_Stock_Price:  98.62173143641343
curr_Factors:  [98.62173144]
mat_Sqrt:  [[0.15]]
grads:  [-0.058511]
Stock Position:  -0.05851100336211973
Bond Position:  [-14.6654598]


portfolio before change:  [-20.42940562]
curr_Stock_Price:  98.49479367275623
curr_Factors:  [98.49479367]
mat_Sqrt:  [[0.15]]
grads:  [0.04526243]
Stock Position:  0.045262431237324485
Bond Position:  [-24.88751945]


portfolio before change:  [-20.43881797]
curr_Stock_Price:  98.32120974265491
curr_Factors:  [98.32120974]
mat_Sqrt:  [[0.15]]
grads:  [-0.0528131]
Stock Position:  -0.05281310453847684
Bond Position:  [-15.24616964]


portfolio before change:  [-20.46910569]
curr_Stock_Price:  98.87665535587159
curr_Factors:  [98.87665536]
mat_Sqrt:  [[0.15]]
grads:  [-0.0279708]
Stock Position:  -0.027970795795801192
Bond Position:  [-17.70344696]


portfolio before change:  [-20.48619929]
curr_Stock_Price:  99.44821947806902
curr_Factors:  [99.44821948]
mat_Sqrt:  [[0.15]]
grads:  [0.02783748]
Stock Position:  0.027837484718206736
Bond Position:  [-23.25458758]


portfolio before change:  [-20.49181884]
curr_Stock_Price:  99.29856189614328
curr_Factors:  [99.2985619]
mat_Sqrt:  [[0.15]]
grads:  [-0.00629761]
Stock Position:  -0.006297610838321826
Bond Position:  [-19.86647514]


portfolio before change:  [-20.4961]
curr_Stock_Price:  99.7812001803908
curr_Factors:  [99.78120018]
mat_Sqrt:  [[0.15]]
grads:  [0.01423241]
Stock Position:  0.01423241474621164
Bond Position:  [-21.91622743]


portfolio before change:  [-20.50452511]
curr_Stock_Price:  99.2854797792559
curr_Factors:  [99.28547978]
mat_Sqrt:  [[0.15]]
grads:  [0.00220607]
Stock Position:  0.002206073284912115
Bond Position:  [-20.72355615]


portfolio before change:  [-20.5046632]
curr_Stock_Price:  99.81001922001838
curr_Factors:  [99.81001922]
mat_Sqrt:  [[0.15]]
grads:  [0.06065161]
Stock Position:  0.06065161061981228
Bond Position:  [-26.55830162]


portfolio before change:  [-20.54867789]
curr_Stock_Price:  99.11169080640089
curr_Factors:  [99.11169081]
mat_Sqrt:  [[0.15]]
grads:  [0.13307751]
Stock Position:  0.13307751178698782
Bond Position:  [-33.73821509]


portfolio before change:  [-20.44084471]
curr_Stock_Price:  99.93784004220927
curr_Factors:  [99.93784004]
mat_Sqrt:  [[0.15]]
grads:  [0.05069386]
Stock Position:  0.05069385516578931
Bond Position:  [-25.5070791]


portfolio before change:  [-20.4855612]
curr_Stock_Price:  99.08719954845856
curr_Factors:  [99.08719955]
mat_Sqrt:  [[0.15]]
grads:  [0.34902386]
Stock Position:  0.349023856666637
Bond Position:  [-55.06935773]


portfolio before change:  [-20.22495803]
curr_Stock_Price:  99.84372407938223
curr_Factors:  [99.84372408]
mat_Sqrt:  [[0.15]]
grads:  [-0.09782097]
Stock Position:  -0.09782097494496866
Bond Position:  [-10.4581476]


portfolio before change:  [-20.35451468]
curr_Stock_Price:  101.16146799358707
curr_Factors:  [101.16146799]
mat_Sqrt:  [[0.15]]
grads:  [0.03701079]
Stock Position:  0.03701079224168658
Bond Position:  [-24.09858075]


portfolio before change:  [-20.35626785]
curr_Stock_Price:  101.15479523628245
curr_Factors:  [101.15479524]
mat_Sqrt:  [[0.15]]
grads:  [0.00976056]
Stock Position:  0.009760556701786863
Bond Position:  [-21.34359497]


portfolio before change:  [-20.36762988]
curr_Stock_Price:  100.12739304504515
curr_Factors:  [100.12739305]
mat_Sqrt:  [[0.15]]
grads:  [0.08917803]
Stock Position:  0.08917802540803854
Bond Position:  [-29.29679309]


portfolio before change:  [-20.36349005]
curr_Stock_Price:  100.19434837592077
curr_Factors:  [100.19434838]
mat_Sqrt:  [[0.15]]
grads:  [-0.05260835]
Stock Position:  -0.052608348470738225
Bond Position:  [-15.09243085]


portfolio before change:  [-20.32505207]
curr_Stock_Price:  99.44577354538096
curr_Factors:  [99.44577355]
mat_Sqrt:  [[0.15]]
grads:  [0.08349884]
Stock Position:  0.0834988398518931
Bond Position:  [-28.62865879]


portfolio before change:  [-20.33461708]
curr_Stock_Price:  99.35265048977894
curr_Factors:  [99.35265049]
mat_Sqrt:  [[0.15]]
grads:  [-0.04610856]
Stock Position:  -0.046108558429298736
Bond Position:  [-15.75360959]


portfolio before change:  [-20.35163162]
curr_Stock_Price:  99.70030629100243
curr_Factors:  [99.70030629]
mat_Sqrt:  [[0.15]]
grads:  [0.01852627]
Stock Position:  0.018526266081484364
Bond Position:  [-22.19870602]


portfolio before change:  [-20.351531]
curr_Stock_Price:  99.78062926280883
curr_Factors:  [99.78062926]
mat_Sqrt:  [[0.15]]
grads:  [-0.13845412]
Stock Position:  -0.13845411765853596
Bond Position:  [-6.53649202]


portfolio before change:  [-20.48037597]
curr_Stock_Price:  100.70827537646342
curr_Factors:  [100.70827538]
mat_Sqrt:  [[0.15]]
grads:  [-0.03299922]
Stock Position:  -0.03299922412952416
Bond Position:  [-17.15708102]


portfolio before change:  [-20.45038387]
curr_Stock_Price:  99.76690640587918
curr_Factors:  [99.76690641]
mat_Sqrt:  [[0.15]]
grads:  [-0.00293044]
Stock Position:  -0.0029304381171738987
Bond Position:  [-20.15802313]


portfolio before change:  [-20.45135195]
curr_Stock_Price:  99.66731948698146
curr_Factors:  [99.66731949]
mat_Sqrt:  [[0.15]]
grads:  [0.10376063]
Stock Position:  0.10376063127559772
Bond Position:  [-30.79289594]


portfolio before change:  [-20.46639133]
curr_Stock_Price:  99.5409251182495
curr_Factors:  [99.54092512]
mat_Sqrt:  [[0.15]]
grads:  [0.12844566]
Stock Position:  0.12844565667382365
Bond Position:  [-33.25199082]


portfolio before change:  [-20.44841319]
curr_Stock_Price:  99.6970724913265
curr_Factors:  [99.69707249]
mat_Sqrt:  [[0.15]]
grads:  [-0.02122896]
Stock Position:  -0.021228963598004445
Bond Position:  [-18.33194767]


portfolio before change:  [-20.42279301]
curr_Stock_Price:  98.43624962159758
curr_Factors:  [98.43624962]
mat_Sqrt:  [[0.15]]
grads:  [0.04395896]
Stock Position:  0.04395895663339039
Bond Position:  [-24.74994784]


portfolio before change:  [-20.4246293]
curr_Stock_Price:  98.42966685106121
curr_Factors:  [98.42966685]
mat_Sqrt:  [[0.15]]
grads:  [-0.01623769]
Stock Position:  -0.016237687920115526
Bond Position:  [-18.82635909]


portfolio before change:  [-20.42863446]
curr_Stock_Price:  98.60385869608068
curr_Factors:  [98.6038587]
mat_Sqrt:  [[0.15]]
grads:  [0.06575049]
Stock Position:  0.06575048726363109
Bond Position:  [-26.91188622]


portfolio before change:  [-20.36830414]
curr_Stock_Price:  99.54700562745766
curr_Factors:  [99.54700563]
mat_Sqrt:  [[0.15]]
grads:  [0.0002063]
Stock Position:  0.00020629621390193514
Bond Position:  [-20.38884031]


portfolio before change:  [-20.36967709]
curr_Stock_Price:  99.06900686389872
curr_Factors:  [99.06900686]
mat_Sqrt:  [[0.15]]
grads:  [-0.09142181]
Stock Position:  -0.09142180974820766
Bond Position:  [-11.31260919]


portfolio before change:  [-20.41774048]
curr_Stock_Price:  99.58700501083494
curr_Factors:  [99.58700501]
mat_Sqrt:  [[0.15]]
grads:  [-0.01493547]
Stock Position:  -0.014935466712006329
Bond Position:  [-18.93036208]


portfolio before change:  [-20.41629819]
curr_Stock_Price:  99.41121716960134
curr_Factors:  [99.41121717]
mat_Sqrt:  [[0.15]]
grads:  [-0.01678172]
Stock Position:  -0.016781721303621527
Bond Position:  [-18.74800685]


portfolio before change:  [-20.42174834]
curr_Stock_Price:  99.66615899741556
curr_Factors:  [99.666159]
mat_Sqrt:  [[0.15]]
grads:  [0.03306261]
Stock Position:  0.033062608376644056
Bond Position:  [-23.71697152]


portfolio before change:  [-20.37990878]
curr_Stock_Price:  100.97645835231432
curr_Factors:  [100.97645835]
mat_Sqrt:  [[0.15]]
grads:  [-0.09846127]
Stock Position:  -0.09846127067313462
Bond Position:  [-10.43763838]


portfolio before change:  [-20.52488962]
curr_Stock_Price:  102.44229833922545
curr_Factors:  [102.44229834]
mat_Sqrt:  [[0.15]]
grads:  [-0.00120959]
Stock Position:  -0.001209594894225367
Bond Position:  [-20.40097594]


portfolio before change:  [-20.52625293]
curr_Stock_Price:  102.51522035988948
curr_Factors:  [102.51522036]
mat_Sqrt:  [[0.15]]
grads:  [0.01542573]
Stock Position:  0.015425725497646698
Bond Position:  [-22.10762458]


portfolio before change:  [-20.52981637]
curr_Stock_Price:  102.37378982542636
curr_Factors:  [102.37378983]
mat_Sqrt:  [[0.15]]
grads:  [-0.09099078]
Stock Position:  -0.09099078126714595
Bond Position:  [-11.21474525]


portfolio before change:  [-20.53978863]
curr_Stock_Price:  102.47568276128045
curr_Factors:  [102.47568276]
mat_Sqrt:  [[0.15]]
grads:  [0.00202812]
Stock Position:  0.0020281232267687437
Bond Position:  [-20.74762194]


portfolio before change:  [-20.54129683]
curr_Stock_Price:  102.371431189798
curr_Factors:  [102.37143119]
mat_Sqrt:  [[0.15]]
grads:  [0.02216188]
Stock Position:  0.022161875201330228
Bond Position:  [-22.81003971]


portfolio before change:  [-20.54202087]
curr_Stock_Price:  102.40309065426769
curr_Factors:  [102.40309065]
mat_Sqrt:  [[0.15]]
grads:  [-0.02908442]
Stock Position:  -0.029084424852116934
Bond Position:  [-17.56368587]


portfolio before change:  [-20.55563902]
curr_Stock_Price:  102.83357479193354
curr_Factors:  [102.83357479]
mat_Sqrt:  [[0.15]]
grads:  [-0.02300109]
Stock Position:  -0.02300109337118741
Bond Position:  [-18.19035436]


portfolio before change:  [-20.55460669]
curr_Stock_Price:  102.73926387721839
curr_Factors:  [102.73926388]
mat_Sqrt:  [[0.15]]
grads:  [0.02334102]
Stock Position:  0.023341017867479996
Bond Position:  [-22.95264569]


portfolio before change:  [-20.55030902]
curr_Stock_Price:  102.9848511049677
curr_Factors:  [102.9848511]
mat_Sqrt:  [[0.15]]
grads:  [0.01055529]
Stock Position:  0.010555288266926354
Bond Position:  [-21.63734381]


portfolio before change:  [-20.55065412]
curr_Stock_Price:  103.08028052916451
curr_Factors:  [103.08028053]
mat_Sqrt:  [[0.15]]
grads:  [0.02525889]
Stock Position:  0.02525888793321223
Bond Position:  [-23.15434737]


portfolio before change:  [-20.56137281]
curr_Stock_Price:  102.71322131448976
curr_Factors:  [102.71322131]
mat_Sqrt:  [[0.15]]
grads:  [-0.02034012]
Stock Position:  -0.020340117478144897
Bond Position:  [-18.47217383]


portfolio before change:  [-20.56345729]
curr_Stock_Price:  102.75894041952829
curr_Factors:  [102.75894042]
mat_Sqrt:  [[0.15]]
grads:  [0.05984451]
Stock Position:  0.05984451206813701
Bond Position:  [-26.71301594]


portfolio before change:  [-20.55182406]
curr_Stock_Price:  102.98123060720854
curr_Factors:  [102.98123061]
mat_Sqrt:  [[0.15]]
grads:  [-0.03128951]
Stock Position:  -0.03128950823910833
Bond Position:  [-17.329592]


portfolio before change:  [-20.56758174]
curr_Stock_Price:  103.450223011128
curr_Factors:  [103.45022301]
mat_Sqrt:  [[0.15]]
grads:  [-0.07375665]
Stock Position:  -0.07375665383461032
Bond Position:  [-12.93743945]


portfolio before change:  [-20.52684037]
curr_Stock_Price:  102.88688424443619
curr_Factors:  [102.88688424]
mat_Sqrt:  [[0.15]]
grads:  [0.09742988]
Stock Position:  0.09742987936024755
Bond Position:  [-30.55109709]


portfolio before change:  [-20.56531877]
curr_Stock_Price:  102.5115486682912
curr_Factors:  [102.51154867]
mat_Sqrt:  [[0.15]]
grads:  [0.02065933]
Stock Position:  0.020659329963657113
Bond Position:  [-22.68313868]


portfolio before change:  [-20.56349798]
curr_Stock_Price:  102.66830768379327
curr_Factors:  [102.66830768]
mat_Sqrt:  [[0.15]]
grads:  [0.07584316]
Stock Position:  0.07584316439631827
Bond Position:  [-28.35018731]


portfolio before change:  [-20.61468984]
curr_Stock_Price:  102.01670095391432
curr_Factors:  [102.01670095]
mat_Sqrt:  [[0.15]]
grads:  [-0.09317079]
Stock Position:  -0.0931707876060119
Bond Position:  [-11.10971346]


portfolio before change:  [-20.57796097]
curr_Stock_Price:  101.61503814746747
curr_Factors:  [101.61503815]
mat_Sqrt:  [[0.15]]
grads:  [-0.0841795]
Stock Position:  -0.084179503625668
Bond Position:  [-12.0240575]


portfolio before change:  [-20.53228116]
curr_Stock_Price:  101.06346274365231
curr_Factors:  [101.06346274]
mat_Sqrt:  [[0.15]]
grads:  [-0.01552566]
Stock Position:  -0.015525661536726664
Bond Position:  [-18.96320404]


portfolio before change:  [-20.53788]
curr_Stock_Price:  101.34774062054971
curr_Factors:  [101.34774062]
mat_Sqrt:  [[0.15]]
grads:  [-0.12477]
Stock Position:  -0.12476999836757138
Bond Position:  [-7.89272256]


portfolio before change:  [-20.54079112]
curr_Stock_Price:  101.36711880711077
curr_Factors:  [101.36711881]
mat_Sqrt:  [[0.15]]
grads:  [0.1098686]
Stock Position:  0.10986860459388167
Bond Position:  [-31.67785502]


portfolio before change:  [-20.39471743]
curr_Stock_Price:  102.71467045417185
curr_Factors:  [102.71467045]
mat_Sqrt:  [[0.15]]
grads:  [0.19223736]
Stock Position:  0.1922373581979399
Bond Position:  [-40.14031433]


portfolio before change:  [-20.18232647]
curr_Stock_Price:  103.83255833030753
curr_Factors:  [103.83255833]
mat_Sqrt:  [[0.15]]
grads:  [0.02488894]
Stock Position:  0.024888938360447227
Bond Position:  [-22.76660861]


portfolio before change:  [-20.22296671]
curr_Stock_Price:  102.25686700611571
curr_Factors:  [102.25686701]
mat_Sqrt:  [[0.15]]
grads:  [0.04636429]
Stock Position:  0.04636429271333895
Bond Position:  [-24.96403402]


portfolio before change:  [-20.25551083]
curr_Stock_Price:  101.58859804118453
curr_Factors:  [101.58859804]
mat_Sqrt:  [[0.15]]
grads:  [-0.09033502]
Stock Position:  -0.0903350201684734
Bond Position:  [-11.07850278]


portfolio before change:  [-20.3102654]
curr_Stock_Price:  102.18706073272382
curr_Factors:  [102.18706073]
mat_Sqrt:  [[0.15]]
grads:  [-0.05244899]
Stock Position:  -0.05244899224149974
Bond Position:  [-14.95065704]


portfolio before change:  [-20.31328316]
curr_Stock_Price:  102.2267816273304
curr_Factors:  [102.22678163]
mat_Sqrt:  [[0.15]]
grads:  [-0.05298674]
Stock Position:  -0.052986738619190954
Bond Position:  [-14.8966194]


portfolio before change:  [-20.28393958]
curr_Stock_Price:  101.65541881501338
curr_Factors:  [101.65541882]
mat_Sqrt:  [[0.15]]
grads:  [0.0128541]
Stock Position:  0.012854100485862831
Bond Position:  [-21.59062855]


portfolio before change:  [-20.26402357]
curr_Stock_Price:  103.30979052038393
curr_Factors:  [103.30979052]
mat_Sqrt:  [[0.15]]
grads:  [0.04839054]
Stock Position:  0.048390536992412456
Bond Position:  [-25.26323981]


portfolio before change:  [-20.2488638]
curr_Stock_Price:  103.65570061080987
curr_Factors:  [103.65570061]
mat_Sqrt:  [[0.15]]
grads:  [-0.00587414]
Stock Position:  -0.005874137389102313
Bond Position:  [-19.63997597]


portfolio before change:  [-20.25282329]
curr_Stock_Price:  104.12078148987501
curr_Factors:  [104.12078149]
mat_Sqrt:  [[0.15]]
grads:  [-0.03317953]
Stock Position:  -0.03317952508094101
Bond Position:  [-16.79814521]


portfolio before change:  [-20.25354067]
curr_Stock_Price:  104.11075913333516
curr_Factors:  [104.11075913]
mat_Sqrt:  [[0.15]]
grads:  [0.05749265]
Stock Position:  0.05749264965792279
Bond Position:  [-26.23914407]


portfolio before change:  [-20.25636456]
curr_Stock_Price:  104.0901670983214
curr_Factors:  [104.0901671]
mat_Sqrt:  [[0.15]]
grads:  [-0.02568349]
Stock Position:  -0.02568348831317988
Bond Position:  [-17.58296597]


portfolio before change:  [-20.23272413]
curr_Stock_Price:  103.12692582649815
curr_Factors:  [103.12692583]
mat_Sqrt:  [[0.15]]
grads:  [0.15526521]
Stock Position:  0.15526520927550377
Bond Position:  [-36.24474785]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.23272413]
Stock Price:  102.90719155232979
PL:  [-23.13991568]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.50435740e-02]
 [-2.33060670e-03]
 [ 3.42898537e-04]
 [ 3.13970900e-03]
 [ 6.26699523e-03]
 [ 1.22894487e-02]
 [-7.04578233e-04]
 [ 2.04902365e-02]
 [-1.84672028e-02]
 [ 3.35297346e-02]
 [ 9.76652314e-03]
 [-1.30856783e-02]
 [ 3.21463749e-02]
 [ 2.12373231e-02]
 [-6.38998740e-03]
 [-1.00534458e-02]
 [ 9.93399347e-03]
 [ 2.25993477e-02]
 [ 1.81820061e-02]
 [-9.59906855e-04]
 [ 4.55708469e-02]
 [-1.14942343e-02]
 [ 7.77902872e-03]
 [-2.49509210e-03]
 [ 1.54341169e-02]
 [ 1.05159024e-02]
 [ 1.20119989e-02]
 [ 7.20250580e-03]
 [ 5.38870146e-03]
 [-1.55639649e-02]
 [-5.68537584e-03]
 [ 3.90777832e-02]
 [ 5.65757011e-03]
 [-5.97421808e-03]
 [-4.66071854e-03]
 [-4.18223418e-03]
 [-6.91562471e-03]
 [ 4.05631623e-03]
 [ 2.05634573e-03]
 [-8.41344627e-03]
 [-3.13604044e-02]
 [-2.71269142e-03]
 [ 1.25534908e-02]
 [-1.15886977e-02]
 [ 7.60869145e-04]
 [ 2.00041860e-03]
 [-1.37044335e-02]
 [-4.83215279e-03]
 [ 2.84665873e-03]
 [-1.56956778e-03]
 [-3.00484642e-03]
 [ 3.76575130e-03]
 [-6.02657703e-05]
 [ 1.42099757e-03]
 [ 8.27166763e-04]
 [ 8.51396724e-03]
 [-4.09393894e-03]
 [-1.99697962e-02]
 [ 1.35298772e-02]
 [ 8.56716329e-03]
 [ 9.09166635e-03]
 [-1.27069251e-02]
 [-1.26111851e-02]
 [-2.37807919e-03]
 [-2.01935091e-02]
 [ 3.32530492e-02]
 [ 2.08061009e-02]
 [ 2.23494426e-03]
 [ 6.75364116e-03]
 [-1.46301549e-02]
 [-6.31819716e-03]
 [-1.34045027e-04]
 [ 1.97453336e-03]
 [ 8.65053731e-03]
 [ 8.45509922e-03]
 [-9.06491804e-03]
 [ 2.74124318e-03]
 [-4.57859282e-03]
 [ 1.93984094e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.80969998]
curr_Stock_Price:  99.75087744899619
curr_Factors:  [99.75087745]
mat_Sqrt:  [[0.15]]
grads:  [-0.23362383]
Stock Position:  -0.2336238268309982
Bond Position:  [21.49448174]


portfolio before change:  [-1.89028849]
curr_Stock_Price:  100.10157779458943
curr_Factors:  [100.10157779]
mat_Sqrt:  [[0.15]]
grads:  [-0.01553738]
Stock Position:  -0.015537377985992869
Bond Position:  [-0.33497244]


portfolio before change:  [-1.89665954]
curr_Stock_Price:  100.51027719786047
curr_Factors:  [100.5102772]
mat_Sqrt:  [[0.15]]
grads:  [0.00228599]
Stock Position:  0.002285990248723736
Bond Position:  [-2.12642506]


portfolio before change:  [-1.89429146]
curr_Stock_Price:  101.60432923193457
curr_Factors:  [101.60432923]
mat_Sqrt:  [[0.15]]
grads:  [0.02093139]
Stock Position:  0.02093139331837944
Bond Position:  [-4.02101164]


portfolio before change:  [-1.89939681]
curr_Stock_Price:  101.37242721953015
curr_Factors:  [101.37242722]
mat_Sqrt:  [[0.15]]
grads:  [0.04177997]
Stock Position:  0.04177996820698304
Bond Position:  [-6.1347336]


portfolio before change:  [-1.85981822]
curr_Stock_Price:  102.32891492306675
curr_Factors:  [102.32891492]
mat_Sqrt:  [[0.15]]
grads:  [0.08192966]
Stock Position:  0.08192965823592199
Bond Position:  [-10.24359124]


portfolio before change:  [-1.87051411]
curr_Stock_Price:  102.20617975814491
curr_Factors:  [102.20617976]
mat_Sqrt:  [[0.15]]
grads:  [-0.00469719]
Stock Position:  -0.004697188221238373
Bond Position:  [-1.39043245]


portfolio before change:  [-1.8734038]
curr_Stock_Price:  102.80287374608197
curr_Factors:  [102.80287375]
mat_Sqrt:  [[0.15]]
grads:  [0.13660158]
Stock Position:  0.13660157677064153
Bond Position:  [-15.91643845]


portfolio before change:  [-1.82928554]
curr_Stock_Price:  103.13312669430262
curr_Factors:  [103.13312669]
mat_Sqrt:  [[0.15]]
grads:  [-0.12311469]
Stock Position:  -0.12311468565598073
Bond Position:  [10.86791694]


portfolio before change:  [-1.81895962]
curr_Stock_Price:  103.05477168740205
curr_Factors:  [103.05477169]
mat_Sqrt:  [[0.15]]
grads:  [0.22353156]
Stock Position:  0.22353156416202133
Bond Position:  [-24.85495393]


portfolio before change:  [-1.71072764]
curr_Stock_Price:  103.54591244921502
curr_Factors:  [103.54591245]
mat_Sqrt:  [[0.15]]
grads:  [0.06511015]
Stock Position:  0.06511015428096231
Bond Position:  [-8.45261797]


portfolio before change:  [-1.73904035]
curr_Stock_Price:  103.11918322514147
curr_Factors:  [103.11918323]
mat_Sqrt:  [[0.15]]
grads:  [-0.08723786]
Stock Position:  -0.08723785522554539
Bond Position:  [7.25685603]


portfolio before change:  [-1.72680395]
curr_Stock_Price:  102.98411759703453
curr_Factors:  [102.9841176]
mat_Sqrt:  [[0.15]]
grads:  [0.21430917]
Stock Position:  0.21430916578879625
Bond Position:  [-23.79724428]


portfolio before change:  [-1.67740174]
curr_Stock_Price:  103.22157633593463
curr_Factors:  [103.22157634]
mat_Sqrt:  [[0.15]]
grads:  [0.14158215]
Stock Position:  0.14158215372490013
Bond Position:  [-16.29173482]


portfolio before change:  [-1.74438441]
curr_Stock_Price:  102.75566725048172
curr_Factors:  [102.75566725]
mat_Sqrt:  [[0.15]]
grads:  [-0.04259992]
Stock Position:  -0.04259991597457834
Bond Position:  [2.63299838]


portfolio before change:  [-1.71992213]
curr_Stock_Price:  102.18529711462955
curr_Factors:  [102.18529711]
mat_Sqrt:  [[0.15]]
grads:  [-0.06702297]
Stock Position:  -0.06702297195371462
Bond Position:  [5.12884018]


portfolio before change:  [-1.68645805]
curr_Stock_Price:  101.69078729875196
curr_Factors:  [101.6907873]
mat_Sqrt:  [[0.15]]
grads:  [0.06622662]
Stock Position:  0.06622662314390504
Bond Position:  [-8.42109549]


portfolio before change:  [-1.70163823]
curr_Stock_Price:  101.46951909677797
curr_Factors:  [101.4695191]
mat_Sqrt:  [[0.15]]
grads:  [0.15066232]
Stock Position:  0.1506623182338517
Bond Position:  [-16.9892712]


portfolio before change:  [-1.69925515]
curr_Stock_Price:  101.49238440068955
curr_Factors:  [101.4923844]
mat_Sqrt:  [[0.15]]
grads:  [0.12121337]
Stock Position:  0.1212133741920187
Bond Position:  [-14.00148952]


portfolio before change:  [-1.63218415]
curr_Stock_Price:  102.05293408319292
curr_Factors:  [102.05293408]
mat_Sqrt:  [[0.15]]
grads:  [-0.00639938]
Stock Position:  -0.006399379036120725
Bond Position:  [-0.97910874]


portfolio before change:  [-1.6347141]
curr_Stock_Price:  102.43871349922368
curr_Factors:  [102.4387135]
mat_Sqrt:  [[0.15]]
grads:  [0.30380565]
Stock Position:  0.30380564572825675
Bond Position:  [-32.7561736]


portfolio before change:  [-1.50819787]
curr_Stock_Price:  102.86189046380903
curr_Factors:  [102.86189046]
mat_Sqrt:  [[0.15]]
grads:  [-0.07662823]
Stock Position:  -0.07662822838314161
Bond Position:  [6.37392656]


portfolio before change:  [-1.41694492]
curr_Stock_Price:  101.67623639352863
curr_Factors:  [101.67623639]
mat_Sqrt:  [[0.15]]
grads:  [0.05186019]
Stock Position:  0.05186019148839534
Bond Position:  [-6.68989401]


portfolio before change:  [-1.4215806]
curr_Stock_Price:  101.59491097613024
curr_Factors:  [101.59491098]
mat_Sqrt:  [[0.15]]
grads:  [-0.01663395]
Stock Position:  -0.01663394731595174
Bond Position:  [0.2683438]


portfolio before change:  [-1.41537939]
curr_Stock_Price:  101.22311462351573
curr_Factors:  [101.22311462]
mat_Sqrt:  [[0.15]]
grads:  [0.10289411]
Stock Position:  0.10289411253664285
Bond Position:  [-11.83064193]


portfolio before change:  [-1.39675974]
curr_Stock_Price:  101.41126030955593
curr_Factors:  [101.41126031]
mat_Sqrt:  [[0.15]]
grads:  [0.07010602]
Stock Position:  0.07010601603133604
Bond Position:  [-8.50629918]


portfolio before change:  [-1.40273772]
curr_Stock_Price:  101.33357342525196
curr_Factors:  [101.33357343]
mat_Sqrt:  [[0.15]]
grads:  [0.08007999]
Stock Position:  0.0800799928352164
Bond Position:  [-9.51752955]


portfolio before change:  [-1.35427478]
curr_Stock_Price:  101.94618344041014
curr_Factors:  [101.94618344]
mat_Sqrt:  [[0.15]]
grads:  [0.04801671]
Stock Position:  0.048016705304759974
Bond Position:  [-6.24939463]


portfolio before change:  [-1.34777802]
curr_Stock_Price:  102.08962006557205
curr_Factors:  [102.08962007]
mat_Sqrt:  [[0.15]]
grads:  [0.03592468]
Stock Position:  0.03592467636825178
Bond Position:  [-5.01531458]


portfolio before change:  [-1.33262626]
curr_Stock_Price:  102.52011051689267
curr_Factors:  [102.52011052]
mat_Sqrt:  [[0.15]]
grads:  [-0.10375977]
Stock Position:  -0.10375976629765203
Bond Position:  [9.30483645]


portfolio before change:  [-1.3206908]
curr_Stock_Price:  102.41068578562727
curr_Factors:  [102.41068579]
mat_Sqrt:  [[0.15]]
grads:  [-0.03790251]
Stock Position:  -0.037902505582635
Bond Position:  [2.56093078]


portfolio before change:  [-1.3487787]
curr_Stock_Price:  103.15596521422286
curr_Factors:  [103.15596521]
mat_Sqrt:  [[0.15]]
grads:  [0.26051855]
Stock Position:  0.2605185547035449
Bond Position:  [-28.22282167]


portfolio before change:  [-1.31754688]
curr_Stock_Price:  103.28261951698424
curr_Factors:  [103.28261952]
mat_Sqrt:  [[0.15]]
grads:  [0.03771713]
Stock Position:  0.03771713403898809
Bond Position:  [-5.21307129]


portfolio before change:  [-1.30347458]
curr_Stock_Price:  103.66435945562795
curr_Factors:  [103.66435946]
mat_Sqrt:  [[0.15]]
grads:  [-0.03982812]
Stock Position:  -0.039828120504980115
Bond Position:  [2.82528202]


portfolio before change:  [-1.2576468]
curr_Stock_Price:  102.5181543749827
curr_Factors:  [102.51815437]
mat_Sqrt:  [[0.15]]
grads:  [-0.03107146]
Stock Position:  -0.031071456901990032
Bond Position:  [1.92774162]


portfolio before change:  [-1.25469025]
curr_Stock_Price:  102.4268788910017
curr_Factors:  [102.42687889]
mat_Sqrt:  [[0.15]]
grads:  [-0.02788156]
Stock Position:  -0.02788156118504073
Bond Position:  [1.60113104]


portfolio before change:  [-1.24580358]
curr_Stock_Price:  102.11173906631653
curr_Factors:  [102.11173907]
mat_Sqrt:  [[0.15]]
grads:  [-0.04610416]
Stock Position:  -0.04610416472777437
Bond Position:  [3.46197286]


portfolio before change:  [-1.25300902]
curr_Stock_Price:  102.2727184405516
curr_Factors:  [102.27271844]
mat_Sqrt:  [[0.15]]
grads:  [0.02704211]
Stock Position:  0.027042108198885226
Bond Position:  [-4.01867894]


portfolio before change:  [-1.24466778]
curr_Stock_Price:  102.59046056014115
curr_Factors:  [102.59046056]
mat_Sqrt:  [[0.15]]
grads:  [0.01370897]
Stock Position:  0.013708971525693463
Bond Position:  [-2.65107748]


portfolio before change:  [-1.24504657]
curr_Stock_Price:  102.57491635992335
curr_Factors:  [102.57491636]
mat_Sqrt:  [[0.15]]
grads:  [-0.05608964]
Stock Position:  -0.05608964176670136
Bond Position:  [4.50834374]


portfolio before change:  [-1.24570735]
curr_Stock_Price:  102.5917209317465
curr_Factors:  [102.59172093]
mat_Sqrt:  [[0.15]]
grads:  [-0.20906936]
Stock Position:  -0.2090693623437168
Bond Position:  [20.20307832]


portfolio before change:  [-1.32685586]
curr_Stock_Price:  102.98590225163343
curr_Factors:  [102.98590225]
mat_Sqrt:  [[0.15]]
grads:  [-0.01808461]
Stock Position:  -0.01808460943557879
Bond Position:  [0.53560396]


portfolio before change:  [-1.32350943]
curr_Stock_Price:  102.8027105931546
curr_Factors:  [102.80271059]
mat_Sqrt:  [[0.15]]
grads:  [0.08368994]
Stock Position:  0.08368993842235403
Bond Position:  [-9.92706195]


portfolio before change:  [-1.35796066]
curr_Stock_Price:  102.3984712501557
curr_Factors:  [102.39847125]
mat_Sqrt:  [[0.15]]
grads:  [-0.07725798]
Stock Position:  -0.07725798477898944
Bond Position:  [6.55313887]


portfolio before change:  [-1.30444918]
curr_Stock_Price:  101.7111390639152
curr_Factors:  [101.71113906]
mat_Sqrt:  [[0.15]]
grads:  [0.00507246]
Stock Position:  0.005072460964112685
Bond Position:  [-1.82037496]


portfolio before change:  [-1.30507335]
curr_Stock_Price:  101.61051791930632
curr_Factors:  [101.61051792]
mat_Sqrt:  [[0.15]]
grads:  [0.01333612]
Stock Position:  0.01333612401136575
Bond Position:  [-2.66016382]


portfolio before change:  [-1.31164462]
curr_Stock_Price:  101.13024342616782
curr_Factors:  [101.13024343]
mat_Sqrt:  [[0.15]]
grads:  [-0.09136289]
Stock Position:  -0.09136289005493341
Bond Position:  [7.92790669]


portfolio before change:  [-1.31256268]
curr_Stock_Price:  101.14571546297479
curr_Factors:  [101.14571546]
mat_Sqrt:  [[0.15]]
grads:  [-0.03221435]
Stock Position:  -0.03221435196148663
Bond Position:  [1.945781]


portfolio before change:  [-1.3495438]
curr_Stock_Price:  102.2974610747257
curr_Factors:  [102.29746107]
mat_Sqrt:  [[0.15]]
grads:  [0.01897772]
Stock Position:  0.018977724891343906
Bond Position:  [-3.29091687]


portfolio before change:  [-1.35785813]
curr_Stock_Price:  101.87018954828393
curr_Factors:  [101.87018955]
mat_Sqrt:  [[0.15]]
grads:  [-0.01046379]
Stock Position:  -0.010463785184811851
Bond Position:  [-0.29191035]


portfolio before change:  [-1.35189088]
curr_Stock_Price:  101.29816945107495
curr_Factors:  [101.29816945]
mat_Sqrt:  [[0.15]]
grads:  [-0.02003231]
Stock Position:  -0.020032309477562307
Bond Position:  [0.6773454]


portfolio before change:  [-1.35173754]
curr_Stock_Price:  101.2926283643007
curr_Factors:  [101.29262836]
mat_Sqrt:  [[0.15]]
grads:  [0.02510501]
Stock Position:  0.02510500863661455
Bond Position:  [-3.89468985]


portfolio before change:  [-1.35500993]
curr_Stock_Price:  101.17197671379286
curr_Factors:  [101.17197671]
mat_Sqrt:  [[0.15]]
grads:  [-0.00040177]
Stock Position:  -0.00040177180192277226
Bond Position:  [-1.31436188]


portfolio before change:  [-1.35522832]
curr_Stock_Price:  101.5110645702456
curr_Factors:  [101.51106457]
mat_Sqrt:  [[0.15]]
grads:  [0.00947332]
Stock Position:  0.00947331711769471
Bond Position:  [-2.31687482]


portfolio before change:  [-1.35204022]
curr_Stock_Price:  101.86288536835276
curr_Factors:  [101.86288537]
mat_Sqrt:  [[0.15]]
grads:  [0.00551445]
Stock Position:  0.005514445085213182
Bond Position:  [-1.9137575]


portfolio before change:  [-1.35249916]
curr_Stock_Price:  101.80134973612397
curr_Factors:  [101.80134974]
mat_Sqrt:  [[0.15]]
grads:  [0.05675978]
Stock Position:  0.05675978159872955
Bond Position:  [-7.13072154]


portfolio before change:  [-1.39214492]
curr_Stock_Price:  101.11071862562468
curr_Factors:  [101.11071863]
mat_Sqrt:  [[0.15]]
grads:  [-0.02729293]
Stock Position:  -0.02729292623467776
Bond Position:  [1.36746247]


portfolio before change:  [-1.38566421]
curr_Stock_Price:  100.87640009241709
curr_Factors:  [100.87640009]
mat_Sqrt:  [[0.15]]
grads:  [-0.13313197]
Stock Position:  -0.1331319746601654
Bond Position:  [12.04421013]


portfolio before change:  [-1.36189025]
curr_Stock_Price:  100.70348011621486
curr_Factors:  [100.70348012]
mat_Sqrt:  [[0.15]]
grads:  [0.09019918]
Stock Position:  0.09019918135837139
Bond Position:  [-10.44526171]


portfolio before change:  [-1.39714387]
curr_Stock_Price:  100.31987598422126
curr_Factors:  [100.31987598]
mat_Sqrt:  [[0.15]]
grads:  [0.05711442]
Stock Position:  0.05711442195236508
Bond Position:  [-7.1268556]


portfolio before change:  [-1.37315073]
curr_Stock_Price:  100.74776420914573
curr_Factors:  [100.74776421]
mat_Sqrt:  [[0.15]]
grads:  [0.06061111]
Stock Position:  0.06061110903172173
Bond Position:  [-7.47958445]


portfolio before change:  [-1.38124266]
curr_Stock_Price:  100.62197130197636
curr_Factors:  [100.6219713]
mat_Sqrt:  [[0.15]]
grads:  [-0.08471283]
Stock Position:  -0.08471283367171252
Bond Position:  [7.14272965]


portfolio before change:  [-1.45177625]
curr_Stock_Price:  101.45986114852343
curr_Factors:  [101.45986115]
mat_Sqrt:  [[0.15]]
grads:  [-0.08407457]
Stock Position:  -0.08407456743262373
Bond Position:  [7.07841768]


portfolio before change:  [-1.42912843]
curr_Stock_Price:  101.19574544499432
curr_Factors:  [101.19574544]
mat_Sqrt:  [[0.15]]
grads:  [-0.01585386]
Stock Position:  -0.01585386129049367
Bond Position:  [0.17521489]


portfolio before change:  [-1.42388576]
curr_Stock_Price:  100.86574907890342
curr_Factors:  [100.86574908]
mat_Sqrt:  [[0.15]]
grads:  [-0.13462339]
Stock Position:  -0.13462339431424314
Bond Position:  [12.15500375]


portfolio before change:  [-1.40970442]
curr_Stock_Price:  100.76605148580364
curr_Factors:  [100.76605149]
mat_Sqrt:  [[0.15]]
grads:  [0.22168699]
Stock Position:  0.22168699437737802
Bond Position:  [-23.74822751]


portfolio before change:  [-1.39955311]
curr_Stock_Price:  100.81853820134533
curr_Factors:  [100.8185382]
mat_Sqrt:  [[0.15]]
grads:  [0.13870734]
Stock Position:  0.13870733939608731
Bond Position:  [-15.3838243]


portfolio before change:  [-1.55482178]
curr_Stock_Price:  99.70607251059317
curr_Factors:  [99.70607251]
mat_Sqrt:  [[0.15]]
grads:  [0.01489963]
Stock Position:  0.014899628392298532
Bond Position:  [-3.04040521]


portfolio before change:  [-1.55633279]
curr_Stock_Price:  99.61741396293003
curr_Factors:  [99.61741396]
mat_Sqrt:  [[0.15]]
grads:  [0.04502427]
Stock Position:  0.04502427442447235
Bond Position:  [-6.04153458]


portfolio before change:  [-1.55877964]
curr_Stock_Price:  99.57145573454329
curr_Factors:  [99.57145573]
mat_Sqrt:  [[0.15]]
grads:  [-0.09753437]
Stock Position:  -0.09753436615695006
Bond Position:  [8.15285919]


portfolio before change:  [-1.61365358]
curr_Stock_Price:  100.1392916632261
curr_Factors:  [100.13929166]
mat_Sqrt:  [[0.15]]
grads:  [-0.04212131]
Stock Position:  -0.0421213143987115
Bond Position:  [2.604345]


portfolio before change:  [-1.59948383]
curr_Stock_Price:  99.80675281508714
curr_Factors:  [99.80675282]
mat_Sqrt:  [[0.15]]
grads:  [-0.00089363]
Stock Position:  -0.0008936335134397273
Bond Position:  [-1.51029317]


portfolio before change:  [-1.59951877]
curr_Stock_Price:  99.74021851845731
curr_Factors:  [99.74021852]
mat_Sqrt:  [[0.15]]
grads:  [0.01316356]
Stock Position:  0.013163555700386402
Bond Position:  [-2.91245469]


portfolio before change:  [-1.58920513]
curr_Stock_Price:  100.53754683231251
curr_Factors:  [100.53754683]
mat_Sqrt:  [[0.15]]
grads:  [0.05767025]
Stock Position:  0.05767024875456569
Bond Position:  [-7.38723047]


portfolio before change:  [-1.57389528]
curr_Stock_Price:  100.81102529852231
curr_Factors:  [100.8110253]
mat_Sqrt:  [[0.15]]
grads:  [0.05636733]
Stock Position:  0.05636732816472235
Bond Position:  [-7.25634342]


portfolio before change:  [-1.58677318]
curr_Stock_Price:  100.59060744533244
curr_Factors:  [100.59060745]
mat_Sqrt:  [[0.15]]
grads:  [-0.06043279]
Stock Position:  -0.06043278694681867
Bond Position:  [4.49219757]


portfolio before change:  [-1.63893518]
curr_Stock_Price:  101.45839428865986
curr_Factors:  [101.45839429]
mat_Sqrt:  [[0.15]]
grads:  [0.01827495]
Stock Position:  0.018274954545736098
Bond Position:  [-3.49308273]


portfolio before change:  [-1.62123444]
curr_Stock_Price:  102.43892007530434
curr_Factors:  [102.43892008]
mat_Sqrt:  [[0.15]]
grads:  [-0.03052395]
Stock Position:  -0.030523952148845936
Bond Position:  [1.50560625]


portfolio before change:  [-1.62548209]
curr_Stock_Price:  102.58116096569202
curr_Factors:  [102.58116097]
mat_Sqrt:  [[0.15]]
grads:  [0.12932273]
Stock Position:  0.1293227290675443
Bond Position:  [-14.89155778]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.62548209]
Stock Price:  102.90301879844148
PL:  [-4.52850089]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.99828143e-02]
 [-7.51143376e-04]
 [ 2.36333692e-03]
 [ 2.90364235e-03]
 [ 4.69913217e-03]
 [ 1.20370392e-02]
 [ 4.14387691e-05]
 [ 6.34557663e-03]
 [-4.82817363e-03]
 [-1.75415643e-02]
 [ 1.01740882e-02]
 [-1.00187742e-02]
 [ 1.20261961e-02]
 [ 7.37349657e-03]
 [-5.14201608e-04]
 [-9.47771630e-03]
 [ 1.18464111e-02]
 [ 2.56111950e-02]
 [ 1.40816478e-02]
 [-1.67614599e-03]
 [ 5.92717182e-02]
 [-1.16217703e-02]
 [ 2.42245249e-03]
 [-1.81144357e-03]
 [ 1.80083712e-02]
 [ 1.73868996e-02]
 [ 9.08383026e-03]
 [ 3.85006218e-03]
 [ 6.26157102e-03]
 [-1.40054827e-02]
 [-5.66596648e-03]
 [ 3.22875893e-02]
 [ 6.93255044e-03]
 [-4.26741965e-03]
 [-6.86682581e-03]
 [-4.14110923e-03]
 [-4.98186726e-03]
 [-5.37833794e-04]
 [ 5.41742004e-03]
 [-6.67598998e-03]
 [-5.64903965e-02]
 [-4.90254993e-03]
 [ 1.92031777e-02]
 [-1.58239000e-02]
 [-6.28623164e-03]
 [ 2.94963651e-03]
 [-1.35764601e-02]
 [ 1.36619722e-02]
 [ 1.91682818e-02]
 [-1.18109605e-02]
 [-4.19953586e-03]
 [ 3.67970284e-03]
 [ 3.46145687e-03]
 [-5.07639125e-03]
 [-1.14928016e-02]
 [ 1.22543643e-02]
 [-2.95372426e-02]
 [-1.04478873e-02]
 [ 1.97120679e-02]
 [-7.56563816e-03]
 [ 1.30904112e-02]
 [-1.43143955e-02]
 [-1.27240657e-02]
 [-2.76363980e-03]
 [ 9.00130050e-02]
 [-1.46791349e-02]
 [ 3.76718997e-03]
 [ 6.82171642e-03]
 [ 1.72080622e-02]
 [-3.31077795e-02]
 [-7.99049690e-03]
 [-3.88710623e-03]
 [ 2.02393800e-02]
 [ 3.00901348e-03]
 [-3.21870048e-03]
 [ 8.27932101e-03]
 [-6.63623470e-05]
 [-1.00358191e-03]
 [ 2.76260052e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.03692905]
curr_Stock_Price:  100.38372679134919
curr_Factors:  [100.38372679]
mat_Sqrt:  [[0.15]]
grads:  [-0.33321876]
Stock Position:  -0.33321876186516813
Bond Position:  [41.4866702]


portfolio before change:  [7.95270728]
curr_Stock_Price:  100.6442606202282
curr_Factors:  [100.64426062]
mat_Sqrt:  [[0.15]]
grads:  [-0.00500762]
Stock Position:  -0.005007622508712518
Bond Position:  [8.45669575]


portfolio before change:  [7.95173786]
curr_Stock_Price:  100.94340033594918
curr_Factors:  [100.94340034]
mat_Sqrt:  [[0.15]]
grads:  [0.01575558]
Stock Position:  0.015755579471198104
Bond Position:  [6.3613161]


portfolio before change:  [7.95863881]
curr_Stock_Price:  101.35616503070793
curr_Factors:  [101.35616503]
mat_Sqrt:  [[0.15]]
grads:  [0.01935762]
Stock Position:  0.01935761569683845
Bond Position:  [5.99662512]


portfolio before change:  [7.95081386]
curr_Stock_Price:  100.93257233178338
curr_Factors:  [100.93257233]
mat_Sqrt:  [[0.15]]
grads:  [0.03132755]
Stock Position:  0.03132754781336264
Bond Position:  [4.78884388]


portfolio before change:  [7.96234604]
curr_Stock_Price:  101.29113420132687
curr_Factors:  [101.2911342]
mat_Sqrt:  [[0.15]]
grads:  [0.08024693]
Stock Position:  0.080246928134383
Bond Position:  [-0.16595633]


portfolio before change:  [7.9743035]
curr_Stock_Price:  101.44027175562884
curr_Factors:  [101.44027176]
mat_Sqrt:  [[0.15]]
grads:  [0.00027626]
Stock Position:  0.0002762584609897447
Bond Position:  [7.94627976]


portfolio before change:  [7.97477726]
curr_Stock_Price:  101.35740603177858
curr_Factors:  [101.35740603]
mat_Sqrt:  [[0.15]]
grads:  [0.04230384]
Stock Position:  0.04230384417642705
Bond Position:  [3.68696935]


portfolio before change:  [7.96892853]
curr_Stock_Price:  101.21370339923035
curr_Factors:  [101.2137034]
mat_Sqrt:  [[0.15]]
grads:  [-0.03218782]
Stock Position:  -0.03218782419953745
Bond Position:  [11.22677742]


portfolio before change:  [7.96388757]
curr_Stock_Price:  101.39211412051485
curr_Factors:  [101.39211412]
mat_Sqrt:  [[0.15]]
grads:  [-0.11694376]
Stock Position:  -0.11694376182718405
Bond Position:  [19.82106282]


portfolio before change:  [8.00927496]
curr_Stock_Price:  101.01459480584974
curr_Factors:  [101.01459481]
mat_Sqrt:  [[0.15]]
grads:  [0.06782725]
Stock Position:  0.06782725465626062
Bond Position:  [1.15773231]


portfolio before change:  [8.07961382]
curr_Stock_Price:  102.05055745135398
curr_Factors:  [102.05055745]
mat_Sqrt:  [[0.15]]
grads:  [-0.06679183]
Stock Position:  -0.06679182810939793
Bond Position:  [14.89575711]


portfolio before change:  [8.12585963]
curr_Stock_Price:  101.37210931730989
curr_Factors:  [101.37210932]
mat_Sqrt:  [[0.15]]
grads:  [0.08017464]
Stock Position:  0.08017464049521648
Bond Position:  [-0.0016128]


portfolio before change:  [8.17804995]
curr_Stock_Price:  102.02306858985736
curr_Factors:  [102.02306859]
mat_Sqrt:  [[0.15]]
grads:  [0.04915664]
Stock Position:  0.04915664378250098
Bond Position:  [3.16293831]


portfolio before change:  [8.16699124]
curr_Stock_Price:  101.79407816424833
curr_Factors:  [101.79407816]
mat_Sqrt:  [[0.15]]
grads:  [-0.00342801]
Stock Position:  -0.003428010721948464
Bond Position:  [8.51594243]


portfolio before change:  [8.16508855]
curr_Stock_Price:  102.50438998527808
curr_Factors:  [102.50438999]
mat_Sqrt:  [[0.15]]
grads:  [-0.06318478]
Stock Position:  -0.06318477531714643
Bond Position:  [14.6418054]


portfolio before change:  [8.13011103]
curr_Stock_Price:  103.07244855084072
curr_Factors:  [103.07244855]
mat_Sqrt:  [[0.15]]
grads:  [0.07897607]
Stock Position:  0.07897607410229676
Bond Position:  [-0.0101463]


portfolio before change:  [8.12769014]
curr_Stock_Price:  103.04180307472504
curr_Factors:  [103.04180307]
mat_Sqrt:  [[0.15]]
grads:  [0.1707413]
Stock Position:  0.17074129975285995
Bond Position:  [-9.46580124]


portfolio before change:  [8.0247224]
curr_Stock_Price:  102.44220527386786
curr_Factors:  [102.44220527]
mat_Sqrt:  [[0.15]]
grads:  [0.09387765]
Stock Position:  0.09387765190667179
Bond Position:  [-1.59231129]


portfolio before change:  [8.03090942]
curr_Stock_Price:  102.5091704874956
curr_Factors:  [102.50917049]
mat_Sqrt:  [[0.15]]
grads:  [-0.01117431]
Stock Position:  -0.011174306607795096
Bond Position:  [9.17637832]


portfolio before change:  [8.03991288]
curr_Stock_Price:  101.7547685555376
curr_Factors:  [101.75476856]
mat_Sqrt:  [[0.15]]
grads:  [0.39514479]
Stock Position:  0.3951447879707137
Bond Position:  [-32.16795357]


portfolio before change:  [8.43906549]
curr_Stock_Price:  102.76999938412277
curr_Factors:  [102.76999938]
mat_Sqrt:  [[0.15]]
grads:  [-0.07747847]
Stock Position:  -0.07747846895414438
Bond Position:  [16.40152769]


portfolio before change:  [8.4052697]
curr_Stock_Price:  103.21942632012853
curr_Factors:  [103.21942632]
mat_Sqrt:  [[0.15]]
grads:  [0.01614968]
Stock Position:  0.016149683284871343
Bond Position:  [6.73830866]


portfolio before change:  [8.40076627]
curr_Stock_Price:  102.91449214574813
curr_Factors:  [102.91449215]
mat_Sqrt:  [[0.15]]
grads:  [-0.01207629]
Stock Position:  -0.01207629049898599
Bond Position:  [9.64359157]


portfolio before change:  [8.39252577]
curr_Stock_Price:  103.64677389931018
curr_Factors:  [103.6467739]
mat_Sqrt:  [[0.15]]
grads:  [0.12005581]
Stock Position:  0.12005580769576935
Bond Position:  [-4.05087139]


portfolio before change:  [8.33279371]
curr_Stock_Price:  103.15134707329581
curr_Factors:  [103.15134707]
mat_Sqrt:  [[0.15]]
grads:  [0.11591266]
Stock Position:  0.11591266373072287
Bond Position:  [-3.62375369]


portfolio before change:  [8.34025167]
curr_Stock_Price:  103.21764224447628
curr_Factors:  [103.21764224]
mat_Sqrt:  [[0.15]]
grads:  [0.06055887]
Stock Position:  0.06055886841110899
Bond Position:  [2.08950806]


portfolio before change:  [8.30212188]
curr_Stock_Price:  102.58585395232166
curr_Factors:  [102.58585395]
mat_Sqrt:  [[0.15]]
grads:  [0.02566708]
Stock Position:  0.025667081189069803
Bond Position:  [5.66904244]


portfolio before change:  [8.30512722]
curr_Stock_Price:  102.68913855526064
curr_Factors:  [102.68913856]
mat_Sqrt:  [[0.15]]
grads:  [0.04174381]
Stock Position:  0.041743806784775975
Bond Position:  [4.01849167]


portfolio before change:  [8.30689815]
curr_Stock_Price:  102.72554553862071
curr_Factors:  [102.72554554]
mat_Sqrt:  [[0.15]]
grads:  [-0.09336988]
Stock Position:  -0.0933698847853626
Bond Position:  [17.89837051]


portfolio before change:  [8.35682264]
curr_Stock_Price:  102.20283091834808
curr_Factors:  [102.20283092]
mat_Sqrt:  [[0.15]]
grads:  [-0.03777311]
Stock Position:  -0.03777310983588327
Bond Position:  [12.2173414]


portfolio before change:  [8.35835845]
curr_Stock_Price:  102.18238785728768
curr_Factors:  [102.18238786]
mat_Sqrt:  [[0.15]]
grads:  [0.2152506]
Stock Position:  0.2152505950895804
Bond Position:  [-13.63646135]


portfolio before change:  [8.40639996]
curr_Stock_Price:  102.4095362124502
curr_Factors:  [102.40953621]
mat_Sqrt:  [[0.15]]
grads:  [0.046217]
Stock Position:  0.04621700292435148
Bond Position:  [3.67333813]


portfolio before change:  [8.43048118]
curr_Stock_Price:  102.92561539677196
curr_Factors:  [102.9256154]
mat_Sqrt:  [[0.15]]
grads:  [-0.02844946]
Stock Position:  -0.02844946430022932
Bond Position:  [11.35865981]


portfolio before change:  [8.41019622]
curr_Stock_Price:  103.663587128255
curr_Factors:  [103.66358713]
mat_Sqrt:  [[0.15]]
grads:  [-0.04577884]
Stock Position:  -0.045778838735738604
Bond Position:  [13.15579486]


portfolio before change:  [8.41988202]
curr_Stock_Price:  103.46997068601186
curr_Factors:  [103.46997069]
mat_Sqrt:  [[0.15]]
grads:  [-0.02760739]
Stock Position:  -0.027607394876143183
Bond Position:  [11.27641836]


portfolio before change:  [8.42214309]
curr_Stock_Price:  103.4135991237393
curr_Factors:  [103.41359912]
mat_Sqrt:  [[0.15]]
grads:  [-0.03321245]
Stock Position:  -0.03321244837942383
Bond Position:  [11.85676191]


portfolio before change:  [8.38089588]
curr_Stock_Price:  104.67783229500564
curr_Factors:  [104.6778323]
mat_Sqrt:  [[0.15]]
grads:  [-0.00358556]
Stock Position:  -0.0035855586278998068
Bond Position:  [8.75622439]


portfolio before change:  [8.38130063]
curr_Stock_Price:  104.71758449027718
curr_Factors:  [104.71758449]
mat_Sqrt:  [[0.15]]
grads:  [0.03611613]
Stock Position:  0.036116133593150614
Bond Position:  [4.59930636]


portfolio before change:  [8.39063383]
curr_Stock_Price:  104.9680469979642
curr_Factors:  [104.968047]
mat_Sqrt:  [[0.15]]
grads:  [-0.0445066]
Stock Position:  -0.04450659985850069
Bond Position:  [13.0624047]


portfolio before change:  [8.37671753]
curr_Stock_Price:  105.29907035918949
curr_Factors:  [105.29907036]
mat_Sqrt:  [[0.15]]
grads:  [-0.37660264]
Stock Position:  -0.37660264355072526
Bond Position:  [48.0326258]


portfolio before change:  [8.12245098]
curr_Stock_Price:  105.98220069710689
curr_Factors:  [105.9822007]
mat_Sqrt:  [[0.15]]
grads:  [-0.03268367]
Stock Position:  -0.032683666209013126
Bond Position:  [11.58633785]


portfolio before change:  [8.12181119]
curr_Stock_Price:  106.02393281348843
curr_Factors:  [106.02393281]
mat_Sqrt:  [[0.15]]
grads:  [0.12802118]
Stock Position:  0.1280211846106363
Bond Position:  [-5.45149829]


portfolio before change:  [8.03859638]
curr_Stock_Price:  105.37658623085794
curr_Factors:  [105.37658623]
mat_Sqrt:  [[0.15]]
grads:  [-0.10549267]
Stock Position:  -0.10549266667589215
Bond Position:  [19.15505347]


portfolio before change:  [8.02411558]
curr_Stock_Price:  105.52520348470303
curr_Factors:  [105.52520348]
mat_Sqrt:  [[0.15]]
grads:  [-0.04190821]
Stock Position:  -0.04190821095081218
Bond Position:  [12.44648807]


portfolio before change:  [8.02945108]
curr_Stock_Price:  105.41645214796063
curr_Factors:  [105.41645215]
mat_Sqrt:  [[0.15]]
grads:  [0.01966424]
Stock Position:  0.019664243422982116
Bond Position:  [5.95651631]


portfolio before change:  [8.02172377]
curr_Stock_Price:  105.0045571496796
curr_Factors:  [105.00455715]
mat_Sqrt:  [[0.15]]
grads:  [-0.09050973]
Stock Position:  -0.09050973393731002
Bond Position:  [17.5256583]


portfolio before change:  [8.03872034]
curr_Stock_Price:  104.82887238046462
curr_Factors:  [104.82887238]
mat_Sqrt:  [[0.15]]
grads:  [0.09107981]
Stock Position:  0.09107981434582038
Bond Position:  [-1.50907389]


portfolio before change:  [8.02370341]
curr_Stock_Price:  104.66503134102454
curr_Factors:  [104.66503134]
mat_Sqrt:  [[0.15]]
grads:  [0.12778855]
Stock Position:  0.12778854518749927
Bond Position:  [-5.35128868]


portfolio before change:  [8.01846276]
curr_Stock_Price:  104.62663832941324
curr_Factors:  [104.62663833]
mat_Sqrt:  [[0.15]]
grads:  [-0.07873974]
Stock Position:  -0.07873973685715767
Bond Position:  [16.25673673]


portfolio before change:  [8.00527811]
curr_Stock_Price:  104.80698848074671
curr_Factors:  [104.80698848]
mat_Sqrt:  [[0.15]]
grads:  [-0.02799691]
Stock Position:  -0.027996905743199168
Bond Position:  [10.93954949]


portfolio before change:  [7.96899629]
curr_Stock_Price:  106.12733312077783
curr_Factors:  [106.12733312]
mat_Sqrt:  [[0.15]]
grads:  [0.02453135]
Stock Position:  0.024531352278714225
Bond Position:  [5.3655493]


portfolio before change:  [7.98245772]
curr_Stock_Price:  106.66240658963072
curr_Factors:  [106.66240659]
mat_Sqrt:  [[0.15]]
grads:  [0.02307638]
Stock Position:  0.02307637915548353
Bond Position:  [5.52107559]


portfolio before change:  [7.96825006]
curr_Stock_Price:  106.0317728898448
curr_Factors:  [106.03177289]
mat_Sqrt:  [[0.15]]
grads:  [-0.03384261]
Stock Position:  -0.03384260831197066
Bond Position:  [11.55664182]


portfolio before change:  [7.96005543]
curr_Stock_Price:  106.29525555278441
curr_Factors:  [106.29525555]
mat_Sqrt:  [[0.15]]
grads:  [-0.07661868]
Stock Position:  -0.07661867759742856
Bond Position:  [16.10425735]


portfolio before change:  [7.98869739]
curr_Stock_Price:  105.93456791511329
curr_Factors:  [105.93456792]
mat_Sqrt:  [[0.15]]
grads:  [0.08169576]
Stock Position:  0.08169576190816114
Bond Position:  [-0.66570785]


portfolio before change:  [7.99548216]
curr_Stock_Price:  106.01812639756315
curr_Factors:  [106.0181264]
mat_Sqrt:  [[0.15]]
grads:  [-0.19691495]
Stock Position:  -0.19691495057028283
Bond Position:  [28.87203627]


portfolio before change:  [7.87656041]
curr_Stock_Price:  106.63121494826039
curr_Factors:  [106.63121495]
mat_Sqrt:  [[0.15]]
grads:  [-0.06965258]
Stock Position:  -0.06965258196753864
Bond Position:  [15.30369985]


portfolio before change:  [7.91591026]
curr_Stock_Price:  106.08000294640564
curr_Factors:  [106.08000295]
mat_Sqrt:  [[0.15]]
grads:  [0.13141379]
Stock Position:  0.13141378589463923
Bond Position:  [-6.02446453]


portfolio before change:  [7.9402138]
curr_Stock_Price:  106.2678072884329
curr_Factors:  [106.26780729]
mat_Sqrt:  [[0.15]]
grads:  [-0.05043759]
Stock Position:  -0.050437587724284916
Bond Position:  [13.30010565]


portfolio before change:  [7.97939252]
curr_Stock_Price:  105.50751254821552
curr_Factors:  [105.50751255]
mat_Sqrt:  [[0.15]]
grads:  [0.08726941]
Stock Position:  0.08726940791379231
Bond Position:  [-1.22818563]


portfolio before change:  [7.96525566]
curr_Stock_Price:  105.34640114697544
curr_Factors:  [105.34640115]
mat_Sqrt:  [[0.15]]
grads:  [-0.0954293]
Stock Position:  -0.09542930321262752
Bond Position:  [18.01838931]


portfolio before change:  [7.95117658]
curr_Stock_Price:  105.50573650039522
curr_Factors:  [105.5057365]
mat_Sqrt:  [[0.15]]
grads:  [-0.0848271]
Stock Position:  -0.08482710438989928
Bond Position:  [16.9009227]


portfolio before change:  [7.86218054]
curr_Stock_Price:  106.5673356630943
curr_Factors:  [106.56733566]
mat_Sqrt:  [[0.15]]
grads:  [-0.01842427]
Stock Position:  -0.01842426535520913
Bond Position:  [9.82560541]


portfolio before change:  [7.8665782]
curr_Stock_Price:  106.36197929096683
curr_Factors:  [106.36197929]
mat_Sqrt:  [[0.15]]
grads:  [0.6000867]
Stock Position:  0.6000866998608967
Bond Position:  [-55.95983095]


portfolio before change:  [7.82265253]
curr_Stock_Price:  106.29460892045655
curr_Factors:  [106.29460892]
mat_Sqrt:  [[0.15]]
grads:  [-0.0978609]
Stock Position:  -0.09786089918743326
Bond Position:  [18.22473854]


portfolio before change:  [7.73340896]
curr_Stock_Price:  107.21819181870377
curr_Factors:  [107.21819182]
mat_Sqrt:  [[0.15]]
grads:  [0.0251146]
Stock Position:  0.025114599772037477
Bond Position:  [5.04066699]


portfolio before change:  [7.75301118]
curr_Stock_Price:  107.98615797224538
curr_Factors:  [107.98615797]
mat_Sqrt:  [[0.15]]
grads:  [0.04547811]
Stock Position:  0.045478109447119074
Bond Position:  [2.84200487]


portfolio before change:  [7.78953472]
curr_Stock_Price:  108.78535363789234
curr_Factors:  [108.78535364]
mat_Sqrt:  [[0.15]]
grads:  [0.11472041]
Stock Position:  0.11472041497759058
Bond Position:  [-4.6903662]


portfolio before change:  [7.789095]
curr_Stock_Price:  108.7840760694054
curr_Factors:  [108.78407607]
mat_Sqrt:  [[0.15]]
grads:  [-0.22071853]
Stock Position:  -0.22071852997811028
Bond Position:  [31.79975635]


portfolio before change:  [7.72720321]
curr_Stock_Price:  109.07349143815195
curr_Factors:  [109.07349144]
mat_Sqrt:  [[0.15]]
grads:  [-0.05326998]
Stock Position:  -0.05326997936505302
Bond Position:  [13.53754585]


portfolio before change:  [7.71656575]
curr_Stock_Price:  109.28906468993137
curr_Factors:  [109.28906469]
mat_Sqrt:  [[0.15]]
grads:  [-0.02591404]
Stock Position:  -0.025914041556714517
Bond Position:  [10.54868711]


portfolio before change:  [7.71390172]
curr_Stock_Price:  109.41730971021636
curr_Factors:  [109.41730971]
mat_Sqrt:  [[0.15]]
grads:  [0.1349292]
Stock Position:  0.13492919989958826
Bond Position:  [-7.04968834]


portfolio before change:  [7.68472042]
curr_Stock_Price:  109.20430412550687
curr_Factors:  [109.20430413]
mat_Sqrt:  [[0.15]]
grads:  [0.02006009]
Stock Position:  0.020060089879703567
Bond Position:  [5.49407227]


portfolio before change:  [7.68459555]
curr_Stock_Price:  109.18096090610467
curr_Factors:  [109.18096091]
mat_Sqrt:  [[0.15]]
grads:  [-0.021458]
Stock Position:  -0.021458003199541133
Bond Position:  [10.02740095]


portfolio before change:  [7.682218]
curr_Stock_Price:  109.32096835170748
curr_Factors:  [109.32096835]
mat_Sqrt:  [[0.15]]
grads:  [0.05519547]
Stock Position:  0.05519547336719384
Bond Position:  [1.6481954]


portfolio before change:  [7.67414859]
curr_Stock_Price:  109.1729050891289
curr_Factors:  [109.17290509]
mat_Sqrt:  [[0.15]]
grads:  [-0.00044242]
Stock Position:  -0.00044241564682775497
Bond Position:  [7.72244839]


portfolio before change:  [7.67445151]
curr_Stock_Price:  109.57920004347906
curr_Factors:  [109.57920004]
mat_Sqrt:  [[0.15]]
grads:  [-0.00669055]
Stock Position:  -0.006690546098880434
Bond Position:  [8.4075962]


portfolio before change:  [7.67471009]
curr_Stock_Price:  109.6190942267894
curr_Factors:  [109.61909423]
mat_Sqrt:  [[0.15]]
grads:  [0.18417337]
Stock Position:  0.18417336831361872
Bond Position:  [-12.51420773]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.67471009]
Stock Price:  108.87149395301358
PL:  [-1.19678387]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-5.96185634e-02]
 [-6.14182254e-04]
 [ 3.27659085e-04]
 [ 2.31545203e-03]
 [ 4.64755543e-03]
 [ 1.19838882e-02]
 [ 9.95023832e-04]
 [ 1.26318191e-02]
 [ 1.40409643e-02]
 [-1.86286631e-02]
 [ 1.00298175e-02]
 [-5.88009668e-03]
 [-7.43566932e-03]
 [ 4.23024095e-03]
 [ 1.21547107e-03]
 [-9.39387244e-03]
 [ 1.44557534e-02]
 [ 1.11703895e-02]
 [ 2.24856800e-02]
 [ 3.21379720e-03]
 [ 5.73799518e-02]
 [-1.45892084e-02]
 [ 1.36752634e-03]
 [ 8.88357032e-03]
 [ 1.39155894e-02]
 [-7.30205286e-03]
 [ 1.33459372e-02]
 [-6.55550268e-03]
 [ 2.42742027e-03]
 [-1.17506731e-02]
 [-4.05388817e-03]
 [-1.94710197e-02]
 [ 1.53962541e-02]
 [ 1.66353587e-02]
 [-1.37670268e-02]
 [ 6.46546460e-03]
 [-2.31847698e-03]
 [ 1.05354181e-02]
 [ 1.61737511e-03]
 [-1.38067900e-02]
 [-1.22677960e-03]
 [-2.89118378e-03]
 [ 5.84446433e-03]
 [-1.12249959e-02]
 [ 2.37331564e-03]
 [-3.72840947e-03]
 [-1.35583811e-02]
 [-1.88535389e-03]
 [-6.67072941e-03]
 [ 6.98045175e-03]
 [-3.14405443e-03]
 [ 3.22372441e-03]
 [ 2.78663076e-03]
 [ 2.19298228e-03]
 [ 1.47174329e-03]
 [ 9.04337300e-03]
 [ 1.76151894e-02]
 [-2.10286876e-02]
 [ 1.37652161e-02]
 [ 8.33639014e-03]
 [ 6.30694830e-03]
 [-1.24965561e-02]
 [-1.25413621e-02]
 [-2.20566105e-03]
 [-2.02131212e-02]
 [ 3.93770914e-02]
 [ 1.85355832e-02]
 [ 2.19029764e-03]
 [ 6.16322804e-03]
 [-1.44046941e-02]
 [-8.26804989e-03]
 [-7.81345348e-03]
 [ 4.39297619e-03]
 [ 7.29591695e-03]
 [-7.52307361e-04]
 [-1.21732955e-02]
 [ 5.81427165e-03]
 [-3.95938924e-03]
 [ 1.84707541e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.36316913]
curr_Stock_Price:  100.53323577576742
curr_Factors:  [100.53323578]
mat_Sqrt:  [[0.15]]
grads:  [-0.39745709]
Stock Position:  -0.39745708914772243
Bond Position:  [50.32081638]


portfolio before change:  [10.31088676]
curr_Stock_Price:  100.67269113333184
curr_Factors:  [100.67269113]
mat_Sqrt:  [[0.15]]
grads:  [-0.00409455]
Stock Position:  -0.004094548358498091
Bond Position:  [10.72309596]


portfolio before change:  [10.3125632]
curr_Stock_Price:  100.42694139079833
curr_Factors:  [100.42694139]
mat_Sqrt:  [[0.15]]
grads:  [0.00218439]
Stock Position:  0.0021843939021649046
Bond Position:  [10.09319121]


portfolio before change:  [10.31360291]
curr_Stock_Price:  100.6141135775706
curr_Factors:  [100.61411358]
mat_Sqrt:  [[0.15]]
grads:  [0.01543635]
Stock Position:  0.015436346837095858
Bond Position:  [8.76048855]


portfolio before change:  [10.31892724]
curr_Stock_Price:  100.92356399743609
curr_Factors:  [100.923564]
mat_Sqrt:  [[0.15]]
grads:  [0.0309837]
Stock Position:  0.030983702868742025
Bond Position:  [7.19194152]


portfolio before change:  [10.29570101]
curr_Stock_Price:  100.15942876652224
curr_Factors:  [100.15942877]
mat_Sqrt:  [[0.15]]
grads:  [0.07989259]
Stock Position:  0.07989258769627777
Bond Position:  [2.29370506]


portfolio before change:  [10.32874239]
curr_Stock_Price:  100.57120692930033
curr_Factors:  [100.57120693]
mat_Sqrt:  [[0.15]]
grads:  [0.00663349]
Stock Position:  0.006633492213526041
Bond Position:  [9.66160408]


portfolio before change:  [10.32375731]
curr_Stock_Price:  99.72867132895614
curr_Factors:  [99.72867133]
mat_Sqrt:  [[0.15]]
grads:  [0.08421213]
Stock Position:  0.08421212748026935
Bond Position:  [1.92539373]


portfolio before change:  [10.34175076]
curr_Stock_Price:  99.94091052607969
curr_Factors:  [99.94091053]
mat_Sqrt:  [[0.15]]
grads:  [0.09360643]
Stock Position:  0.09360642852895859
Bond Position:  [0.98663907]


portfolio before change:  [10.33717175]
curr_Stock_Price:  99.89133397194873
curr_Factors:  [99.89133397]
mat_Sqrt:  [[0.15]]
grads:  [-0.12419109]
Stock Position:  -0.12419108764858201
Bond Position:  [22.74278516]


portfolio before change:  [10.30356549]
curr_Stock_Price:  100.17338101646685
curr_Factors:  [100.17338102]
mat_Sqrt:  [[0.15]]
grads:  [0.06686545]
Stock Position:  0.066865449867841
Bond Position:  [3.6054273]


portfolio before change:  [10.32503172]
curr_Stock_Price:  100.4910471235687
curr_Factors:  [100.49104712]
mat_Sqrt:  [[0.15]]
grads:  [-0.03920064]
Stock Position:  -0.03920064454858743
Bond Position:  [14.26434554]


portfolio before change:  [10.33772792]
curr_Stock_Price:  100.18991313908582
curr_Factors:  [100.18991314]
mat_Sqrt:  [[0.15]]
grads:  [-0.04957113]
Stock Position:  -0.04957112879169212
Bond Position:  [15.304255]


portfolio before change:  [10.31276657]
curr_Stock_Price:  100.7127556851073
curr_Factors:  [100.71275569]
mat_Sqrt:  [[0.15]]
grads:  [0.02820161]
Stock Position:  0.028201606314936078
Bond Position:  [7.47250508]


portfolio before change:  [10.33574573]
curr_Stock_Price:  101.51101230225436
curr_Factors:  [101.5110123]
mat_Sqrt:  [[0.15]]
grads:  [0.00810314]
Stock Position:  0.008103140457933339
Bond Position:  [9.51318774]


portfolio before change:  [10.33137507]
curr_Stock_Price:  100.89825585454892
curr_Factors:  [100.89825585]
mat_Sqrt:  [[0.15]]
grads:  [-0.06262582]
Stock Position:  -0.06262581624362659
Bond Position:  [16.6502107]


portfolio before change:  [10.32452447]
curr_Stock_Price:  101.02426264076865
curr_Factors:  [101.02426264]
mat_Sqrt:  [[0.15]]
grads:  [0.09637169]
Stock Position:  0.09637168928349822
Bond Position:  [0.58864562]


portfolio before change:  [10.24395442]
curr_Stock_Price:  100.18784650860539
curr_Factors:  [100.18784651]
mat_Sqrt:  [[0.15]]
grads:  [0.07446926]
Stock Position:  0.07446926308384386
Bond Position:  [2.78303932]


portfolio before change:  [10.22608571]
curr_Stock_Price:  99.94556326315066
curr_Factors:  [99.94556326]
mat_Sqrt:  [[0.15]]
grads:  [0.14990453]
Stock Position:  0.1499045333756207
Bond Position:  [-4.75620731]


portfolio before change:  [10.28985049]
curr_Stock_Price:  100.37291557607605
curr_Factors:  [100.37291558]
mat_Sqrt:  [[0.15]]
grads:  [0.02142531]
Stock Position:  0.021425314690157567
Bond Position:  [8.13932919]


portfolio before change:  [10.27100754]
curr_Stock_Price:  99.46970033785512
curr_Factors:  [99.46970034]
mat_Sqrt:  [[0.15]]
grads:  [0.38253301]
Stock Position:  0.3825330121867697
Bond Position:  [-27.77943655]


portfolio before change:  [10.4205716]
curr_Stock_Price:  99.86522260354056
curr_Factors:  [99.8652226]
mat_Sqrt:  [[0.15]]
grads:  [-0.09726139]
Stock Position:  -0.09726138956384331
Bond Position:  [20.13360192]


portfolio before change:  [10.34353209]
curr_Stock_Price:  100.67024804734383
curr_Factors:  [100.67024805]
mat_Sqrt:  [[0.15]]
grads:  [0.00911684]
Stock Position:  0.00911684228260698
Bond Position:  [9.42573732]


portfolio before change:  [10.34127797]
curr_Stock_Price:  100.35838027844277
curr_Factors:  [100.35838028]
mat_Sqrt:  [[0.15]]
grads:  [0.0592238]
Stock Position:  0.05922380213059323
Bond Position:  [4.39767311]


portfolio before change:  [10.34125195]
curr_Stock_Price:  100.35329974903877
curr_Factors:  [100.35329975]
mat_Sqrt:  [[0.15]]
grads:  [0.0927706]
Stock Position:  0.09277059602837735
Bond Position:  [1.03141651]


portfolio before change:  [10.3500327]
curr_Stock_Price:  100.44725504493152
curr_Factors:  [100.44725504]
mat_Sqrt:  [[0.15]]
grads:  [-0.04868035]
Stock Position:  -0.04868035240374373
Bond Position:  [15.23984047]


portfolio before change:  [10.38163954]
curr_Stock_Price:  99.8175487690324
curr_Factors:  [99.81754877]
mat_Sqrt:  [[0.15]]
grads:  [0.08897291]
Stock Position:  0.08897291464478692
Bond Position:  [1.5005813]


portfolio before change:  [10.34328417]
curr_Stock_Price:  99.3854041710704
curr_Factors:  [99.38540417]
mat_Sqrt:  [[0.15]]
grads:  [-0.04370335]
Stock Position:  -0.0437033512044339
Bond Position:  [14.68675939]


portfolio before change:  [10.35114142]
curr_Stock_Price:  99.22662233054068
curr_Factors:  [99.22662233]
mat_Sqrt:  [[0.15]]
grads:  [0.0161828]
Stock Position:  0.01618280177408231
Bond Position:  [8.74537666]


portfolio before change:  [10.34554702]
curr_Stock_Price:  98.84714523575568
curr_Factors:  [98.84714524]
mat_Sqrt:  [[0.15]]
grads:  [-0.07833782]
Stock Position:  -0.0783378209811738
Bond Position:  [18.08901699]


portfolio before change:  [10.30240115]
curr_Stock_Price:  99.41234433354849
curr_Factors:  [99.41234433]
mat_Sqrt:  [[0.15]]
grads:  [-0.02702592]
Stock Position:  -0.027025921156689527
Bond Position:  [12.98911133]


portfolio before change:  [10.31224404]
curr_Stock_Price:  99.0781820968787
curr_Factors:  [99.0781821]
mat_Sqrt:  [[0.15]]
grads:  [-0.1298068]
Stock Position:  -0.1298067979371204
Bond Position:  [23.1732656]


portfolio before change:  [10.33462668]
curr_Stock_Price:  98.91690960786707
curr_Factors:  [98.91690961]
mat_Sqrt:  [[0.15]]
grads:  [0.10264169]
Stock Position:  0.1026416942322377
Bond Position:  [0.18162749]


portfolio before change:  [10.2762371]
curr_Stock_Price:  98.34793094040154
curr_Factors:  [98.34793094]
mat_Sqrt:  [[0.15]]
grads:  [0.11090239]
Stock Position:  0.11090239118762403
Bond Position:  [-0.63078361]


portfolio before change:  [10.33585866]
curr_Stock_Price:  98.88589041867772
curr_Factors:  [98.88589042]
mat_Sqrt:  [[0.15]]
grads:  [-0.09178018]
Stock Position:  -0.0917801783524404
Bond Position:  [19.41162332]


portfolio before change:  [10.36842899]
curr_Stock_Price:  98.54423639645947
curr_Factors:  [98.5442364]
mat_Sqrt:  [[0.15]]
grads:  [0.0431031]
Stock Position:  0.04310309734031721
Bond Position:  [6.12086718]


portfolio before change:  [10.38075766]
curr_Stock_Price:  98.82138827294314
curr_Factors:  [98.82138827]
mat_Sqrt:  [[0.15]]
grads:  [-0.01545651]
Stock Position:  -0.01545651320650972
Bond Position:  [11.90819176]


portfolio before change:  [10.3828821]
curr_Stock_Price:  98.73209582395722
curr_Factors:  [98.73209582]
mat_Sqrt:  [[0.15]]
grads:  [0.07023612]
Stock Position:  0.07023612092114181
Bond Position:  [3.44832268]


portfolio before change:  [10.40470776]
curr_Stock_Price:  99.0397741660038
curr_Factors:  [99.03977417]
mat_Sqrt:  [[0.15]]
grads:  [0.0107825]
Stock Position:  0.010782500725597137
Bond Position:  [9.33681132]


portfolio before change:  [10.41325323]
curr_Stock_Price:  99.77818410365722
curr_Factors:  [99.7781841]
mat_Sqrt:  [[0.15]]
grads:  [-0.09204527]
Stock Position:  -0.09204526649212241
Bond Position:  [19.59736278]


portfolio before change:  [10.38756989]
curr_Stock_Price:  100.0705209018335
curr_Factors:  [100.0705209]
mat_Sqrt:  [[0.15]]
grads:  [-0.00817853]
Stock Position:  -0.008178530638774639
Bond Position:  [11.20599971]


portfolio before change:  [10.39038371]
curr_Stock_Price:  99.81210987535303
curr_Factors:  [99.81210988]
mat_Sqrt:  [[0.15]]
grads:  [-0.01927456]
Stock Position:  -0.01927455850483941
Bond Position:  [12.31421806]


portfolio before change:  [10.38591536]
curr_Stock_Price:  100.08386775464366
curr_Factors:  [100.08386775]
mat_Sqrt:  [[0.15]]
grads:  [0.0389631]
Stock Position:  0.038963095530850485
Bond Position:  [6.48633806]


portfolio before change:  [10.38005651]
curr_Stock_Price:  99.92309357931013
curr_Factors:  [99.92309358]
mat_Sqrt:  [[0.15]]
grads:  [-0.07483331]
Stock Position:  -0.07483330622015905
Bond Position:  [17.85763197]


portfolio before change:  [10.44761128]
curr_Stock_Price:  99.03527181714034
curr_Factors:  [99.03527182]
mat_Sqrt:  [[0.15]]
grads:  [0.0158221]
Stock Position:  0.015822104276842955
Bond Position:  [8.88066488]


portfolio before change:  [10.43839862]
curr_Stock_Price:  98.41792526816866
curr_Factors:  [98.41792527]
mat_Sqrt:  [[0.15]]
grads:  [-0.02485606]
Stock Position:  -0.02485606310139921
Bond Position:  [12.88468078]


portfolio before change:  [10.46249698]
curr_Stock_Price:  97.48080828154333
curr_Factors:  [97.48080828]
mat_Sqrt:  [[0.15]]
grads:  [-0.09038921]
Stock Position:  -0.09038920731804902
Bond Position:  [19.27370997]


portfolio before change:  [10.33671369]
curr_Stock_Price:  98.88570978835492
curr_Factors:  [98.88570979]
mat_Sqrt:  [[0.15]]
grads:  [-0.01256903]
Stock Position:  -0.012569025953531416
Bond Position:  [11.57961074]


portfolio before change:  [10.3451118]
curr_Stock_Price:  98.27513205462394
curr_Factors:  [98.27513205]
mat_Sqrt:  [[0.15]]
grads:  [-0.04447153]
Stock Position:  -0.04447152942585047
Bond Position:  [14.71555723]


portfolio before change:  [10.35237143]
curr_Stock_Price:  98.13257183183211
curr_Factors:  [98.13257183]
mat_Sqrt:  [[0.15]]
grads:  [0.04653634]
Stock Position:  0.04653634497656697
Bond Position:  [5.78564021]


portfolio before change:  [10.37936445]
curr_Stock_Price:  98.70484296852801
curr_Factors:  [98.70484297]
mat_Sqrt:  [[0.15]]
grads:  [-0.02096036]
Stock Position:  -0.020960362852959148
Bond Position:  [12.44825377]


portfolio before change:  [10.38513961]
curr_Stock_Price:  98.46643483699658
curr_Factors:  [98.46643484]
mat_Sqrt:  [[0.15]]
grads:  [0.0214915]
Stock Position:  0.021491496080844556
Bond Position:  [8.26894861]


portfolio before change:  [10.3907643]
curr_Stock_Price:  98.70410429216938
curr_Factors:  [98.70410429]
mat_Sqrt:  [[0.15]]
grads:  [0.01857754]
Stock Position:  0.01857753836668463
Bond Position:  [8.55708502]


portfolio before change:  [10.37996924]
curr_Stock_Price:  98.09423333076612
curr_Factors:  [98.09423333]
mat_Sqrt:  [[0.15]]
grads:  [0.01461988]
Stock Position:  0.014619881837311907
Bond Position:  [8.94584314]


portfolio before change:  [10.39084216]
curr_Stock_Price:  98.79969632661904
curr_Factors:  [98.79969633]
mat_Sqrt:  [[0.15]]
grads:  [0.00981162]
Stock Position:  0.00981162193043391
Bond Position:  [9.42145689]


portfolio before change:  [10.39526034]
curr_Stock_Price:  99.18998130596081
curr_Factors:  [99.18998131]
mat_Sqrt:  [[0.15]]
grads:  [0.06028915]
Stock Position:  0.06028915335793255
Bond Position:  [4.41518035]


portfolio before change:  [10.41356432]
curr_Stock_Price:  99.48900725452994
curr_Factors:  [99.48900725]
mat_Sqrt:  [[0.15]]
grads:  [0.1174346]
Stock Position:  0.11743459586588309
Bond Position:  [-1.26988704]


portfolio before change:  [10.5338152]
curr_Stock_Price:  100.51366481604578
curr_Factors:  [100.51366482]
mat_Sqrt:  [[0.15]]
grads:  [-0.14019125]
Stock Position:  -0.14019125067191118
Bond Position:  [24.62495158]


portfolio before change:  [10.55675128]
curr_Stock_Price:  100.36103780669393
curr_Factors:  [100.36103781]
mat_Sqrt:  [[0.15]]
grads:  [0.09176811]
Stock Position:  0.09176810756452998
Bond Position:  [1.34680877]


portfolio before change:  [10.56482629]
curr_Stock_Price:  100.44811417885097
curr_Factors:  [100.44811418]
mat_Sqrt:  [[0.15]]
grads:  [0.05557593]
Stock Position:  0.05557593428715181
Bond Position:  [4.9823285]


portfolio before change:  [10.52913739]
curr_Stock_Price:  99.80034632496522
curr_Factors:  [99.80034632]
mat_Sqrt:  [[0.15]]
grads:  [0.04204632]
Stock Position:  0.04204632201215409
Bond Position:  [6.33289989]


portfolio before change:  [10.52494956]
curr_Stock_Price:  99.69133213515714
curr_Factors:  [99.69133214]
mat_Sqrt:  [[0.15]]
grads:  [-0.08331037]
Stock Position:  -0.08331037369251912
Bond Position:  [18.8302717]


portfolio before change:  [10.50197038]
curr_Stock_Price:  99.98128536296893
curr_Factors:  [99.98128536]
mat_Sqrt:  [[0.15]]
grads:  [-0.08360908]
Stock Position:  -0.08360908064126676
Bond Position:  [18.86131373]


portfolio before change:  [10.49199224]
curr_Stock_Price:  100.11472793298924
curr_Factors:  [100.11472793]
mat_Sqrt:  [[0.15]]
grads:  [-0.01470441]
Stock Position:  -0.014704407006300834
Bond Position:  [11.96411995]


portfolio before change:  [10.48098329]
curr_Stock_Price:  100.9142658088108
curr_Factors:  [100.91426581]
mat_Sqrt:  [[0.15]]
grads:  [-0.13475414]
Stock Position:  -0.13475414106054334
Bond Position:  [24.0795985]


portfolio before change:  [10.54367017]
curr_Stock_Price:  100.46023997485868
curr_Factors:  [100.46023997]
mat_Sqrt:  [[0.15]]
grads:  [0.26251394]
Stock Position:  0.2625139427370139
Bond Position:  [-15.82854351]


portfolio before change:  [10.48521664]
curr_Stock_Price:  100.24134027627146
curr_Factors:  [100.24134028]
mat_Sqrt:  [[0.15]]
grads:  [0.12357055]
Stock Position:  0.12357055487860077
Bond Position:  [-1.9016614]


portfolio before change:  [10.53770915]
curr_Stock_Price:  100.66710006956336
curr_Factors:  [100.66710007]
mat_Sqrt:  [[0.15]]
grads:  [0.01460198]
Stock Position:  0.014601984256360126
Bond Position:  [9.06776974]


portfolio before change:  [10.54103361]
curr_Stock_Price:  100.85595844314655
curr_Factors:  [100.85595844]
mat_Sqrt:  [[0.15]]
grads:  [0.04108819]
Stock Position:  0.041088186960557334
Bond Position:  [6.39704514]


portfolio before change:  [10.52607334]
curr_Stock_Price:  100.48212586167558
curr_Factors:  [100.48212586]
mat_Sqrt:  [[0.15]]
grads:  [-0.09603129]
Stock Position:  -0.09603129411094379
Bond Position:  [20.17550192]


portfolio before change:  [10.42617774]
curr_Stock_Price:  101.53549711427029
curr_Factors:  [101.53549711]
mat_Sqrt:  [[0.15]]
grads:  [-0.05512033]
Stock Position:  -0.05512033261788836
Bond Position:  [16.02284811]


portfolio before change:  [10.35898247]
curr_Stock_Price:  102.77273077541918
curr_Factors:  [102.77273078]
mat_Sqrt:  [[0.15]]
grads:  [-0.05208969]
Stock Position:  -0.052089689893113335
Bond Position:  [15.71238215]


portfolio before change:  [10.32654853]
curr_Stock_Price:  103.41423961347685
curr_Factors:  [103.41423961]
mat_Sqrt:  [[0.15]]
grads:  [0.02928651]
Stock Position:  0.0292865079512441
Bond Position:  [7.29790658]


portfolio before change:  [10.32237451]
curr_Stock_Price:  103.25614106820825
curr_Factors:  [103.25614107]
mat_Sqrt:  [[0.15]]
grads:  [0.04863945]
Stock Position:  0.0486394463272283
Bond Position:  [5.30005298]


portfolio before change:  [10.31153212]
curr_Stock_Price:  103.02641692206453
curr_Factors:  [103.02641692]
mat_Sqrt:  [[0.15]]
grads:  [-0.00501538]
Stock Position:  -0.005015382409794047
Bond Position:  [10.82824899]


portfolio before change:  [10.31275433]
curr_Stock_Price:  102.91766505870737
curr_Factors:  [102.91766506]
mat_Sqrt:  [[0.15]]
grads:  [-0.0811553]
Stock Position:  -0.08115530318012333
Bond Position:  [18.66506864]


portfolio before change:  [10.33156153]
curr_Stock_Price:  102.70029673429353
curr_Factors:  [102.70029673]
mat_Sqrt:  [[0.15]]
grads:  [0.03876181]
Stock Position:  0.03876181100645773
Bond Position:  [6.35071204]


portfolio before change:  [10.3509001]
curr_Stock_Price:  103.18896424783068
curr_Factors:  [103.18896425]
mat_Sqrt:  [[0.15]]
grads:  [-0.02639593]
Stock Position:  -0.026395928279134822
Bond Position:  [13.0746686]


portfolio before change:  [10.37150677]
curr_Stock_Price:  102.43924709342072
curr_Factors:  [102.43924709]
mat_Sqrt:  [[0.15]]
grads:  [0.12313836]
Stock Position:  0.12313836088871313
Bond Position:  [-2.24269421]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.37150677]
Stock Price:  103.50112209591325
PL:  [6.87038468]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.37895548e-02]
 [-1.42259147e-04]
 [-3.73217879e-04]
 [-2.33892962e-03]
 [-2.94884084e-02]
 [-1.96318388e-03]
 [ 2.84465869e-03]
 [-7.10185051e-04]
 [ 3.34301918e-03]
 [ 3.15238191e-02]
 [ 9.81810031e-03]
 [-1.32621943e-02]
 [ 8.81225133e-03]
 [ 6.63026052e-03]
 [-2.65669262e-02]
 [ 1.56519383e-02]
 [-3.14362043e-03]
 [-4.84440756e-03]
 [-3.69029664e-03]
 [ 1.44514434e-02]
 [-4.56585269e-02]
 [-2.81988228e-02]
 [ 5.02679393e-04]
 [ 6.77912282e-03]
 [ 3.35761289e-03]
 [ 8.04013736e-03]
 [ 1.32224335e-02]
 [-7.10868049e-03]
 [ 2.70000444e-03]
 [-1.56369863e-02]
 [-3.76111824e-03]
 [-1.94459833e-02]
 [ 1.56784466e-02]
 [ 1.95988830e-02]
 [-1.55025543e-02]
 [ 6.48587989e-03]
 [-2.29593562e-03]
 [ 1.13242577e-02]
 [ 2.67386329e-03]
 [-1.51622291e-02]
 [ 2.21347169e-02]
 [-1.79245377e-03]
 [ 3.79607585e-03]
 [-8.20736741e-03]
 [ 2.04999999e-03]
 [-4.10811957e-03]
 [-1.37095951e-02]
 [-1.94354587e-03]
 [-8.75314852e-03]
 [ 1.08185153e-02]
 [-3.04270006e-03]
 [ 3.33611250e-03]
 [ 1.88375770e-03]
 [-8.61322131e-04]
 [ 2.24881564e-03]
 [ 9.02591946e-03]
 [ 1.67797162e-02]
 [-2.52183928e-02]
 [ 1.40381443e-02]
 [ 6.39362800e-03]
 [ 5.71367549e-03]
 [-1.23898545e-02]
 [-1.25365903e-02]
 [-2.19515952e-03]
 [-1.18892983e-02]
 [-1.52632077e-02]
 [ 1.00146218e-02]
 [ 2.31875771e-03]
 [ 9.25104122e-03]
 [-1.71099368e-02]
 [ 4.54822387e-03]
 [ 1.66858369e-03]
 [-8.78271563e-04]
 [ 7.93458801e-03]
 [-1.89642025e-03]
 [ 2.93591499e-03]
 [ 1.04485349e-02]
 [-1.18883597e-02]
 [-3.57099845e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.08104993]
curr_Stock_Price:  100.00093851221487
curr_Factors:  [100.00093851]
mat_Sqrt:  [[0.15]]
grads:  [-0.2252637]
Stock Position:  -0.22526369896871148
Bond Position:  [24.60763124]


portfolio before change:  [2.14387677]
curr_Stock_Price:  99.72886267022781
curr_Factors:  [99.72886267]
mat_Sqrt:  [[0.15]]
grads:  [-0.00094839]
Stock Position:  -0.0009483943124568709
Bond Position:  [2.23845905]


portfolio before change:  [2.14434232]
curr_Stock_Price:  99.38549528685704
curr_Factors:  [99.38549529]
mat_Sqrt:  [[0.15]]
grads:  [-0.00248812]
Stock Position:  -0.002488119194671001
Bond Position:  [2.39162528]


portfolio before change:  [2.14745016]
curr_Stock_Price:  98.19650194405388
curr_Factors:  [98.19650194]
mat_Sqrt:  [[0.15]]
grads:  [-0.01559286]
Stock Position:  -0.015592864103029696
Bond Position:  [3.67861487]


portfolio before change:  [2.15724519]
curr_Stock_Price:  97.58307326300438
curr_Factors:  [97.58307326]
mat_Sqrt:  [[0.15]]
grads:  [-0.19658939]
Stock Position:  -0.19658938905377676
Bond Position:  [21.34104195]


portfolio before change:  [2.23228737]
curr_Stock_Price:  97.2081378539443
curr_Factors:  [97.20813785]
mat_Sqrt:  [[0.15]]
grads:  [-0.01308789]
Stock Position:  -0.013087892503373336
Bond Position:  [3.50453703]


portfolio before change:  [2.23263116]
curr_Stock_Price:  97.19860599541153
curr_Factors:  [97.198606]
mat_Sqrt:  [[0.15]]
grads:  [0.01896439]
Stock Position:  0.018964391291785194
Bond Position:  [0.38931877]


portfolio before change:  [2.24727397]
curr_Stock_Price:  97.96944400819677
curr_Factors:  [97.96944401]
mat_Sqrt:  [[0.15]]
grads:  [-0.00473457]
Stock Position:  -0.004734567007975074
Bond Position:  [2.71111687]


portfolio before change:  [2.24903411]
curr_Stock_Price:  97.63347118565757
curr_Factors:  [97.63347119]
mat_Sqrt:  [[0.15]]
grads:  [0.02228679]
Stock Position:  0.022286794560212476
Bond Position:  [0.07309699]


portfolio before change:  [2.24456072]
curr_Stock_Price:  97.43254684361082
curr_Factors:  [97.43254684]
mat_Sqrt:  [[0.15]]
grads:  [0.21015879]
Stock Position:  0.21015879377998023
Bond Position:  [-18.2317458]


portfolio before change:  [2.17248911]
curr_Stock_Price:  97.09503022404105
curr_Factors:  [97.09503022]
mat_Sqrt:  [[0.15]]
grads:  [0.065454]
Stock Position:  0.06545400203402989
Bond Position:  [-4.18276919]


portfolio before change:  [2.14157821]
curr_Stock_Price:  96.62677050229361
curr_Factors:  [96.6267705]
mat_Sqrt:  [[0.15]]
grads:  [-0.08841463]
Stock Position:  -0.08841462872185099
Bond Position:  [10.68479825]


portfolio before change:  [2.07443913]
curr_Stock_Price:  97.39368994543496
curr_Factors:  [97.39368995]
mat_Sqrt:  [[0.15]]
grads:  [0.05874834]
Stock Position:  0.05874834220554596
Bond Position:  [-3.6472787]


portfolio before change:  [2.07100336]
curr_Stock_Price:  97.33908741057557
curr_Factors:  [97.33908741]
mat_Sqrt:  [[0.15]]
grads:  [0.04420174]
Stock Position:  0.044201736816084976
Bond Position:  [-2.23155336]


portfolio before change:  [2.07055056]
curr_Stock_Price:  97.33199891784206
curr_Factors:  [97.33199892]
mat_Sqrt:  [[0.15]]
grads:  [-0.17711284]
Stock Position:  -0.17711284100066185
Bond Position:  [19.30929741]


portfolio before change:  [1.97479911]
curr_Stock_Price:  97.87943703004571
curr_Factors:  [97.87943703]
mat_Sqrt:  [[0.15]]
grads:  [0.10434626]
Stock Position:  0.10434625511861396
Bond Position:  [-8.2385536]


portfolio before change:  [1.96814037]
curr_Stock_Price:  97.82055794450422
curr_Factors:  [97.82055794]
mat_Sqrt:  [[0.15]]
grads:  [-0.02095747]
Stock Position:  -0.02095746954841838
Bond Position:  [4.01821174]


portfolio before change:  [1.9792593]
curr_Stock_Price:  97.3019940464115
curr_Factors:  [97.30199405]
mat_Sqrt:  [[0.15]]
grads:  [-0.03229605]
Stock Position:  -0.032296050425627186
Bond Position:  [5.12172941]


portfolio before change:  [1.97287653]
curr_Stock_Price:  97.50953925977501
curr_Factors:  [97.50953926]
mat_Sqrt:  [[0.15]]
grads:  [-0.02460198]
Stock Position:  -0.024601977619942705
Bond Position:  [4.37180403]


portfolio before change:  [1.97693942]
curr_Stock_Price:  97.35550123963637
curr_Factors:  [97.35550124]
mat_Sqrt:  [[0.15]]
grads:  [0.09634296]
Stock Position:  0.09634295621743326
Bond Position:  [-7.40257738]


portfolio before change:  [1.92589184]
curr_Stock_Price:  96.83045090563003
curr_Factors:  [96.83045091]
mat_Sqrt:  [[0.15]]
grads:  [-0.30439018]
Stock Position:  -0.3043901790912234
Bond Position:  [31.40013013]


portfolio before change:  [1.94910863]
curr_Stock_Price:  96.7606253373205
curr_Factors:  [96.76062534]
mat_Sqrt:  [[0.15]]
grads:  [-0.18799215]
Stock Position:  -0.1879921517665755
Bond Position:  [20.13934679]


portfolio before change:  [1.88034499]
curr_Stock_Price:  97.13310040655665
curr_Factors:  [97.13310041]
mat_Sqrt:  [[0.15]]
grads:  [0.0033512]
Stock Position:  0.0033511959521757553
Bond Position:  [1.55483293]


portfolio before change:  [1.88211737]
curr_Stock_Price:  97.63298303308639
curr_Factors:  [97.63298303]
mat_Sqrt:  [[0.15]]
grads:  [0.04519415]
Stock Position:  0.04519415212645535
Bond Position:  [-2.53032252]


portfolio before change:  [1.91213732]
curr_Stock_Price:  98.30072657863117
curr_Factors:  [98.30072658]
mat_Sqrt:  [[0.15]]
grads:  [0.02238409]
Stock Position:  0.022384085965030703
Bond Position:  [-0.28823459]


portfolio before change:  [1.91605918]
curr_Stock_Price:  98.47673870221176
curr_Factors:  [98.4767387]
mat_Sqrt:  [[0.15]]
grads:  [0.05360092]
Stock Position:  0.05360091570698428
Bond Position:  [-3.36238419]


portfolio before change:  [1.91935314]
curr_Stock_Price:  98.54211293469596
curr_Factors:  [98.54211293]
mat_Sqrt:  [[0.15]]
grads:  [0.08814956]
Stock Position:  0.08814955698191862
Bond Position:  [-6.76709046]


portfolio before change:  [1.98889066]
curr_Stock_Price:  99.33576946913958
curr_Factors:  [99.33576947]
mat_Sqrt:  [[0.15]]
grads:  [-0.0473912]
Stock Position:  -0.04739120328323886
Bond Position:  [6.6965323]


portfolio before change:  [1.97716752]
curr_Stock_Price:  99.59197063924131
curr_Factors:  [99.59197064]
mat_Sqrt:  [[0.15]]
grads:  [0.01800003]
Stock Position:  0.01800002958398283
Bond Position:  [0.18450911]


portfolio before change:  [1.97037241]
curr_Stock_Price:  99.21382442043475
curr_Factors:  [99.21382442]
mat_Sqrt:  [[0.15]]
grads:  [-0.10424658]
Stock Position:  -0.10424657553819959
Bond Position:  [12.31307385]


portfolio before change:  [2.010387]
curr_Stock_Price:  98.83736123891113
curr_Factors:  [98.83736124]
mat_Sqrt:  [[0.15]]
grads:  [-0.02507412]
Stock Position:  -0.025074121609287
Bond Position:  [4.48864702]


portfolio before change:  [2.00453893]
curr_Stock_Price:  99.08178140830461
curr_Factors:  [99.08178141]
mat_Sqrt:  [[0.15]]
grads:  [-0.12963989]
Stock Position:  -0.12963988855116168
Bond Position:  [14.84949003]


portfolio before change:  [2.0585097]
curr_Stock_Price:  98.67262760833326
curr_Factors:  [98.67262761]
mat_Sqrt:  [[0.15]]
grads:  [0.10452298]
Stock Position:  0.10452297761620054
Bond Position:  [-8.25504714]


portfolio before change:  [2.0748501]
curr_Stock_Price:  98.83389692644074
curr_Factors:  [98.83389693]
mat_Sqrt:  [[0.15]]
grads:  [0.13065922]
Stock Position:  0.13065922004751745
Bond Position:  [-10.83870979]


portfolio before change:  [2.04216953]
curr_Stock_Price:  98.58896108071536
curr_Factors:  [98.58896108]
mat_Sqrt:  [[0.15]]
grads:  [-0.10335036]
Stock Position:  -0.10335036191495782
Bond Position:  [12.23137434]


portfolio before change:  [2.04933111]
curr_Stock_Price:  98.52706393734968
curr_Factors:  [98.52706394]
mat_Sqrt:  [[0.15]]
grads:  [0.0432392]
Stock Position:  0.04323919927254768
Bond Position:  [-2.21090024]


portfolio before change:  [2.06629116]
curr_Stock_Price:  98.92249764477323
curr_Factors:  [98.92249764]
mat_Sqrt:  [[0.15]]
grads:  [-0.01530624]
Stock Position:  -0.01530623746655
Bond Position:  [3.5804224]


portfolio before change:  [2.06371231]
curr_Stock_Price:  99.10560145734688
curr_Factors:  [99.10560146]
mat_Sqrt:  [[0.15]]
grads:  [0.07549505]
Stock Position:  0.0754950510516083
Bond Position:  [-5.41827013]


portfolio before change:  [2.02508388]
curr_Stock_Price:  98.598418799107
curr_Factors:  [98.5984188]
mat_Sqrt:  [[0.15]]
grads:  [0.01782576]
Stock Position:  0.017825755285914777
Bond Position:  [0.26749259]


portfolio before change:  [2.01151563]
curr_Stock_Price:  97.83632094101151
curr_Factors:  [97.83632094]
mat_Sqrt:  [[0.15]]
grads:  [-0.10108153]
Stock Position:  -0.10108152737794188
Bond Position:  [11.90096038]


portfolio before change:  [1.96429066]
curr_Stock_Price:  98.31087651293318
curr_Factors:  [98.31087651]
mat_Sqrt:  [[0.15]]
grads:  [0.14756478]
Stock Position:  0.1475647794869031
Bond Position:  [-12.54293216]


portfolio before change:  [2.01900806]
curr_Stock_Price:  98.68699175812189
curr_Factors:  [98.68699176]
mat_Sqrt:  [[0.15]]
grads:  [-0.01194969]
Stock Position:  -0.011949691822566954
Bond Position:  [3.1982872]


portfolio before change:  [2.01587236]
curr_Stock_Price:  98.9661290609937
curr_Factors:  [98.96612906]
mat_Sqrt:  [[0.15]]
grads:  [0.02530717]
Stock Position:  0.02530717230044218
Bond Position:  [-0.48868052]


portfolio before change:  [2.01225398]
curr_Stock_Price:  98.82435764701933
curr_Factors:  [98.82435765]
mat_Sqrt:  [[0.15]]
grads:  [-0.05471578]
Stock Position:  -0.054715782740870994
Bond Position:  [7.41950606]


portfolio before change:  [2.02320993]
curr_Stock_Price:  98.63259918008187
curr_Factors:  [98.63259918]
mat_Sqrt:  [[0.15]]
grads:  [0.01366667]
Stock Position:  0.013666666615184791
Bond Position:  [0.67523108]


portfolio before change:  [2.01744907]
curr_Stock_Price:  98.20798517096998
curr_Factors:  [98.20798517]
mat_Sqrt:  [[0.15]]
grads:  [-0.02738746]
Stock Position:  -0.027387463826591803
Bond Position:  [4.70711672]


portfolio before change:  [1.99941471]
curr_Stock_Price:  98.87721725153474
curr_Factors:  [98.87721725]
mat_Sqrt:  [[0.15]]
grads:  [-0.0913973]
Stock Position:  -0.09139730092916974
Bond Position:  [11.03652549]


portfolio before change:  [1.99630109]
curr_Stock_Price:  98.91883147743003
curr_Factors:  [98.91883148]
mat_Sqrt:  [[0.15]]
grads:  [-0.01295697]
Stock Position:  -0.012956972439235775
Bond Position:  [3.27798966]


portfolio before change:  [1.99521842]
curr_Stock_Price:  99.01820251024776
curr_Factors:  [99.01820251]
mat_Sqrt:  [[0.15]]
grads:  [-0.05835432]
Stock Position:  -0.05835432345316096
Bond Position:  [7.77335864]


portfolio before change:  [1.98170691]
curr_Stock_Price:  99.25807084877204
curr_Factors:  [99.25807085]
mat_Sqrt:  [[0.15]]
grads:  [0.07212344]
Stock Position:  0.07212343535865819
Bond Position:  [-5.17712614]


portfolio before change:  [1.99518255]
curr_Stock_Price:  99.44939861759426
curr_Factors:  [99.44939862]
mat_Sqrt:  [[0.15]]
grads:  [-0.02028467]
Stock Position:  -0.02028466704298608
Bond Position:  [4.01248049]


portfolio before change:  [2.00626995]
curr_Stock_Price:  98.91517200109303
curr_Factors:  [98.915172]
mat_Sqrt:  [[0.15]]
grads:  [0.02224075]
Stock Position:  0.022240750007039237
Bond Position:  [-0.19367767]


portfolio before change:  [2.01881965]
curr_Stock_Price:  99.47998245511171
curr_Factors:  [99.47998246]
mat_Sqrt:  [[0.15]]
grads:  [0.01255838]
Stock Position:  0.012558384646844832
Bond Position:  [0.76951176]


portfolio before change:  [2.01728365]
curr_Stock_Price:  99.3538439032486
curr_Factors:  [99.3538439]
mat_Sqrt:  [[0.15]]
grads:  [-0.00574215]
Stock Position:  -0.005742147539482239
Bond Position:  [2.58778808]


portfolio before change:  [2.01535412]
curr_Stock_Price:  99.7180405046413
curr_Factors:  [99.7180405]
mat_Sqrt:  [[0.15]]
grads:  [0.0149921]
Stock Position:  0.014992104270802314
Bond Position:  [0.52037086]


portfolio before change:  [2.00924922]
curr_Stock_Price:  99.30866336942185
curr_Factors:  [99.30866337]
mat_Sqrt:  [[0.15]]
grads:  [0.0601728]
Stock Position:  0.06017279641613958
Bond Position:  [-3.96643076]


portfolio before change:  [2.02581425]
curr_Stock_Price:  99.58807428928533
curr_Factors:  [99.58807429]
mat_Sqrt:  [[0.15]]
grads:  [0.11186477]
Stock Position:  0.1118647748240575
Bond Position:  [-9.11458326]


portfolio before change:  [2.06485155]
curr_Stock_Price:  99.94213557158467
curr_Factors:  [99.94213557]
mat_Sqrt:  [[0.15]]
grads:  [-0.16812262]
Stock Position:  -0.16812261884140844
Bond Position:  [18.86738512]


portfolio before change:  [2.03680862]
curr_Stock_Price:  100.11595028045362
curr_Factors:  [100.11595028]
mat_Sqrt:  [[0.15]]
grads:  [0.09358763]
Stock Position:  0.09358762878273955
Bond Position:  [-7.33280577]


portfolio before change:  [1.98193057]
curr_Stock_Price:  99.5344660272413
curr_Factors:  [99.53446603]
mat_Sqrt:  [[0.15]]
grads:  [0.04262419]
Stock Position:  0.04262418667178831
Bond Position:  [-2.26064509]


portfolio before change:  [1.98235073]
curr_Stock_Price:  99.54763833420166
curr_Factors:  [99.54763833]
mat_Sqrt:  [[0.15]]
grads:  [0.03809117]
Stock Position:  0.03809116994727454
Bond Position:  [-1.80953528]


portfolio before change:  [1.99367249]
curr_Stock_Price:  99.8478353443578
curr_Factors:  [99.84783534]
mat_Sqrt:  [[0.15]]
grads:  [-0.08259903]
Stock Position:  -0.08259903020197085
Bond Position:  [10.24100686]


portfolio before change:  [2.01784114]
curr_Stock_Price:  99.56298254423281
curr_Factors:  [99.56298254]
mat_Sqrt:  [[0.15]]
grads:  [-0.08357727]
Stock Position:  -0.08357726879790167
Bond Position:  [10.33904329]


portfolio before change:  [1.98220218]
curr_Stock_Price:  99.99713372449052
curr_Factors:  [99.99713372]
mat_Sqrt:  [[0.15]]
grads:  [-0.0146344]
Stock Position:  -0.014634396801109882
Bond Position:  [3.44559991]


portfolio before change:  [1.99988618]
curr_Stock_Price:  98.80346317279702
curr_Factors:  [98.80346317]
mat_Sqrt:  [[0.15]]
grads:  [-0.07926199]
Stock Position:  -0.07926198867996705
Bond Position:  [9.83124516]


portfolio before change:  [2.07565158]
curr_Stock_Price:  97.85532997247581
curr_Factors:  [97.85532997]
mat_Sqrt:  [[0.15]]
grads:  [-0.10175472]
Stock Position:  -0.1017547182283329
Bond Position:  [12.03289311]


portfolio before change:  [2.11560965]
curr_Stock_Price:  97.47003094783454
curr_Factors:  [97.47003095]
mat_Sqrt:  [[0.15]]
grads:  [0.06676415]
Stock Position:  0.06676414546807177
Bond Position:  [-4.39189367]


portfolio before change:  [2.13370792]
curr_Stock_Price:  97.74522007122837
curr_Factors:  [97.74522007]
mat_Sqrt:  [[0.15]]
grads:  [0.01545838]
Stock Position:  0.015458384740606483
Bond Position:  [0.6227247]


portfolio before change:  [2.14153825]
curr_Stock_Price:  98.24924534927969
curr_Factors:  [98.24924535]
mat_Sqrt:  [[0.15]]
grads:  [0.06167361]
Stock Position:  0.061673608157788995
Bond Position:  [-3.91784721]


portfolio before change:  [2.13907073]
curr_Stock_Price:  98.21320643425472
curr_Factors:  [98.21320643]
mat_Sqrt:  [[0.15]]
grads:  [-0.11406625]
Stock Position:  -0.11406624505563577
Bond Position:  [13.3418824]


portfolio before change:  [2.23599101]
curr_Stock_Price:  97.37083290342586
curr_Factors:  [97.3708329]
mat_Sqrt:  [[0.15]]
grads:  [0.03032149]
Stock Position:  0.030321492466212525
Bond Position:  [-0.71643797]


portfolio before change:  [2.22944067]
curr_Stock_Price:  97.15627997390206
curr_Factors:  [97.15627997]
mat_Sqrt:  [[0.15]]
grads:  [0.01112389]
Stock Position:  0.011123891245278373
Bond Position:  [1.14868477]


portfolio before change:  [2.22827752]
curr_Stock_Price:  97.0452628327282
curr_Factors:  [97.04526283]
mat_Sqrt:  [[0.15]]
grads:  [-0.00585514]
Stock Position:  -0.0058551437506159315
Bond Position:  [2.79649148]


portfolio before change:  [2.22963698]
curr_Stock_Price:  96.84293223307264
curr_Factors:  [96.84293223]
mat_Sqrt:  [[0.15]]
grads:  [0.05289725]
Stock Position:  0.052897253375890435
Bond Position:  [-2.89308814]


portfolio before change:  [2.21621291]
curr_Stock_Price:  96.59257427673325
curr_Factors:  [96.59257428]
mat_Sqrt:  [[0.15]]
grads:  [-0.0126428]
Stock Position:  -0.012642801679554744
Bond Position:  [3.43741367]


portfolio before change:  [2.22245409]
curr_Stock_Price:  96.11591282264267
curr_Factors:  [96.11591282]
mat_Sqrt:  [[0.15]]
grads:  [0.01957277]
Stock Position:  0.019572766578890812
Bond Position:  [0.34119976]


portfolio before change:  [2.21189821]
curr_Stock_Price:  95.57550857729504
curr_Factors:  [95.57550858]
mat_Sqrt:  [[0.15]]
grads:  [0.0696569]
Stock Position:  0.06965689929794365
Bond Position:  [-4.44559537]


portfolio before change:  [2.25623661]
curr_Stock_Price:  96.21602314190162
curr_Factors:  [96.21602314]
mat_Sqrt:  [[0.15]]
grads:  [-0.07925573]
Stock Position:  -0.07925573110618811
Bond Position:  [9.88190787]


portfolio before change:  [2.24142597]
curr_Stock_Price:  96.41068762800765
curr_Factors:  [96.41068763]
mat_Sqrt:  [[0.15]]
grads:  [-0.23806656]
Stock Position:  -0.23806656308958693
Bond Position:  [25.19358702]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.24142597]
Stock Price:  97.0248552671754
PL:  [2.24142597]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.62292316e-02]
 [-2.30375618e-03]
 [ 6.76037977e-04]
 [ 2.29742863e-03]
 [ 8.30653025e-03]
 [ 1.18060672e-02]
 [ 7.08203523e-04]
 [ 6.11311778e-03]
 [-4.40705380e-03]
 [-1.05241289e-02]
 [ 1.01674368e-02]
 [-8.65637371e-03]
 [ 2.51295435e-02]
 [ 1.69627957e-02]
 [-4.01387202e-03]
 [-1.00602339e-02]
 [ 1.00320538e-02]
 [ 2.50325991e-02]
 [ 1.83307665e-02]
 [-8.20837530e-04]
 [ 5.85538409e-02]
 [-1.30678111e-02]
 [ 1.86770346e-03]
 [ 2.58547982e-03]
 [ 1.54828350e-02]
 [ 1.66173610e-02]
 [ 1.11317998e-02]
 [ 6.33538247e-03]
 [ 5.01586199e-03]
 [-1.88516334e-02]
 [-5.68377077e-03]
 [ 3.82533473e-02]
 [ 6.00443608e-03]
 [-5.63118335e-03]
 [-6.64344876e-03]
 [-3.78763588e-03]
 [-4.93981747e-03]
 [ 3.11438400e-03]
 [ 2.04753584e-03]
 [-8.57080036e-03]
 [-3.37984692e-02]
 [-2.41196780e-03]
 [ 1.21705172e-02]
 [-1.28797156e-02]
 [ 6.12450510e-04]
 [ 2.06682871e-03]
 [-1.36769751e-02]
 [-1.62616417e-03]
 [ 6.98868787e-03]
 [-8.34697809e-03]
 [-3.49912185e-03]
 [ 3.44208989e-03]
 [ 2.73861482e-03]
 [-6.56707648e-04]
 [-7.64390778e-03]
 [ 1.02941420e-02]
 [-1.18112708e-02]
 [-8.70478154e-03]
 [ 1.60077133e-02]
 [ 2.01459023e-03]
 [ 1.11864551e-02]
 [-1.41977174e-02]
 [-1.26387215e-02]
 [-2.45505464e-03]
 [-1.77404918e-02]
 [-1.46022293e-03]
 [ 2.96864703e-02]
 [ 2.57781157e-03]
 [ 7.09311523e-03]
 [-1.37435854e-02]
 [-7.95987832e-03]
 [-7.69322618e-03]
 [ 3.06241111e-03]
 [ 6.81776543e-03]
 [-9.76678217e-04]
 [ 9.19801953e-04]
 [ 7.33728661e-03]
 [-3.17552488e-03]
 [ 2.16976683e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.11919387]
curr_Stock_Price:  100.06766070789217
curr_Factors:  [100.06766071]
mat_Sqrt:  [[0.15]]
grads:  [-0.24152821]
Stock Position:  -0.241528210892651
Bond Position:  [27.28835693]


portfolio before change:  [3.10756257]
curr_Stock_Price:  100.12287941649281
curr_Factors:  [100.12287942]
mat_Sqrt:  [[0.15]]
grads:  [-0.01535837]
Stock Position:  -0.015358374516412152
Bond Position:  [4.64528725]


portfolio before change:  [3.11226528]
curr_Stock_Price:  99.83558553938961
curr_Factors:  [99.83558554]
mat_Sqrt:  [[0.15]]
grads:  [0.00450692]
Stock Position:  0.004506919844707167
Bond Position:  [2.66231429]


portfolio before change:  [3.11561219]
curr_Stock_Price:  100.54128017438036
curr_Factors:  [100.54128017]
mat_Sqrt:  [[0.15]]
grads:  [0.01531619]
Stock Position:  0.015316190881156976
Bond Position:  [1.57570275]


portfolio before change:  [3.11584781]
curr_Stock_Price:  100.55023414988203
curr_Factors:  [100.55023415]
mat_Sqrt:  [[0.15]]
grads:  [0.05537687]
Stock Position:  0.05537686834937772
Bond Position:  [-2.45230927]


portfolio before change:  [3.10235561]
curr_Stock_Price:  100.30935879996277
curr_Factors:  [100.3093588]
mat_Sqrt:  [[0.15]]
grads:  [0.07870711]
Stock Position:  0.07870711478292448
Bond Position:  [-4.7927046]


portfolio before change:  [3.14341898]
curr_Stock_Price:  100.83488838309154
curr_Factors:  [100.83488838]
mat_Sqrt:  [[0.15]]
grads:  [0.00472136]
Stock Position:  0.004721356818610968
Bond Position:  [2.66734149]


portfolio before change:  [3.14628134]
curr_Stock_Price:  101.40583716785743
curr_Factors:  [101.40583717]
mat_Sqrt:  [[0.15]]
grads:  [0.04075412]
Stock Position:  0.04075411851500506
Bond Position:  [-0.98642416]


portfolio before change:  [3.13597419]
curr_Stock_Price:  101.15443912147776
curr_Factors:  [101.15443912]
mat_Sqrt:  [[0.15]]
grads:  [-0.02938036]
Stock Position:  -0.02938035865175473
Bond Position:  [6.10792789]


portfolio before change:  [3.12157236]
curr_Stock_Price:  101.65761813407562
curr_Factors:  [101.65761813]
mat_Sqrt:  [[0.15]]
grads:  [-0.07016086]
Stock Position:  -0.07016085941090917
Bond Position:  [10.25395822]


portfolio before change:  [3.16508905]
curr_Stock_Price:  101.0465111417308
curr_Factors:  [101.04651114]
mat_Sqrt:  [[0.15]]
grads:  [0.06778291]
Stock Position:  0.06778291197603446
Bond Position:  [-3.68413772]


portfolio before change:  [3.20093937]
curr_Stock_Price:  101.57880739884516
curr_Factors:  [101.5788074]
mat_Sqrt:  [[0.15]]
grads:  [-0.05770916]
Stock Position:  -0.057709158091623254
Bond Position:  [9.06296683]


portfolio before change:  [3.15272155]
curr_Stock_Price:  102.4241545224312
curr_Factors:  [102.42415452]
mat_Sqrt:  [[0.15]]
grads:  [0.16753029]
Stock Position:  0.16753029007789674
Bond Position:  [-14.00642676]


portfolio before change:  [3.22288973]
curr_Stock_Price:  102.84821874611082
curr_Factors:  [102.84821875]
mat_Sqrt:  [[0.15]]
grads:  [0.1130853]
Stock Position:  0.11308530476057316
Bond Position:  [-8.40773243]


portfolio before change:  [3.16792388]
curr_Stock_Price:  102.36680919804542
curr_Factors:  [102.3668092]
mat_Sqrt:  [[0.15]]
grads:  [-0.02675915]
Stock Position:  -0.026759146767823552
Bond Position:  [5.90717235]


portfolio before change:  [3.17487507]
curr_Stock_Price:  102.12083822154197
curr_Factors:  [102.12083822]
mat_Sqrt:  [[0.15]]
grads:  [-0.06706823]
Stock Position:  -0.06706822615931361
Bond Position:  [10.02393854]


portfolio before change:  [3.205413]
curr_Stock_Price:  101.67485335512048
curr_Factors:  [101.67485336]
mat_Sqrt:  [[0.15]]
grads:  [0.06688036]
Stock Position:  0.06688035876611788
Bond Position:  [-3.59463767]


portfolio before change:  [3.22652481]
curr_Stock_Price:  101.99387810644252
curr_Factors:  [101.99387811]
mat_Sqrt:  [[0.15]]
grads:  [0.16688399]
Stock Position:  0.16688399379323737
Bond Position:  [-13.79462091]


portfolio before change:  [3.23508839]
curr_Stock_Price:  102.05035904064697
curr_Factors:  [102.05035904]
mat_Sqrt:  [[0.15]]
grads:  [0.12220511]
Stock Position:  0.12220510984698475
Bond Position:  [-9.23598695]


portfolio before change:  [3.22400019]
curr_Stock_Price:  101.96434846168302
curr_Factors:  [101.96434846]
mat_Sqrt:  [[0.15]]
grads:  [-0.00547225]
Stock Position:  -0.005472250199814756
Bond Position:  [3.78197461]


portfolio before change:  [3.22518734]
curr_Stock_Price:  101.79060485718965
curr_Factors:  [101.79060486]
mat_Sqrt:  [[0.15]]
grads:  [0.39035894]
Stock Position:  0.3903589392203729
Bond Position:  [-36.5096852]


portfolio before change:  [3.06256733]
curr_Stock_Price:  101.37985961421121
curr_Factors:  [101.37985961]
mat_Sqrt:  [[0.15]]
grads:  [-0.08711874]
Stock Position:  -0.08711874061990524
Bond Position:  [11.89465303]


portfolio before change:  [3.11947693]
curr_Stock_Price:  100.73515152286217
curr_Factors:  [100.73515152]
mat_Sqrt:  [[0.15]]
grads:  [0.01245136]
Stock Position:  0.012451356431993015
Bond Position:  [1.86518765]


portfolio before change:  [3.12329402]
curr_Stock_Price:  101.03234931650786
curr_Factors:  [101.03234932]
mat_Sqrt:  [[0.15]]
grads:  [0.01723653]
Stock Position:  0.017236532121524824
Bond Position:  [1.38184669]


portfolio before change:  [3.12720239]
curr_Stock_Price:  101.25408749618965
curr_Factors:  [101.2540875]
mat_Sqrt:  [[0.15]]
grads:  [0.1032189]
Stock Position:  0.10321890008098775
Bond Position:  [-7.32413315]


portfolio before change:  [3.18277747]
curr_Stock_Price:  101.7969420691602
curr_Factors:  [101.79694207]
mat_Sqrt:  [[0.15]]
grads:  [0.11078241]
Stock Position:  0.11078240676136562
Bond Position:  [-8.09453278]


portfolio before change:  [3.19367959]
curr_Stock_Price:  101.89991910006674
curr_Factors:  [101.8999191]
mat_Sqrt:  [[0.15]]
grads:  [0.074212]
Stock Position:  0.07421199891041601
Bond Position:  [-4.3685171]


portfolio before change:  [3.20911854]
curr_Stock_Price:  102.111636848884
curr_Factors:  [102.11163685]
mat_Sqrt:  [[0.15]]
grads:  [0.04223588]
Stock Position:  0.042235883117098694
Bond Position:  [-1.10365662]


portfolio before change:  [3.19577349]
curr_Stock_Price:  101.79730517038449
curr_Factors:  [101.79730517]
mat_Sqrt:  [[0.15]]
grads:  [0.03343908]
Stock Position:  0.033439079903748725
Bond Position:  [-0.20823474]


portfolio before change:  [3.2057464]
curr_Stock_Price:  102.09593578138973
curr_Factors:  [102.09593578]
mat_Sqrt:  [[0.15]]
grads:  [-0.12567756]
Stock Position:  -0.12567755567720337
Bond Position:  [16.03691406]


portfolio before change:  [3.17144145]
curr_Stock_Price:  102.37687128567863
curr_Factors:  [102.37687129]
mat_Sqrt:  [[0.15]]
grads:  [-0.03789181]
Stock Position:  -0.03789180512641265
Bond Position:  [7.05068591]


portfolio before change:  [3.14683996]
curr_Stock_Price:  103.03775767145511
curr_Factors:  [103.03775767]
mat_Sqrt:  [[0.15]]
grads:  [0.25502232]
Stock Position:  0.25502231525841046
Bond Position:  [-23.13008756]


portfolio before change:  [3.1480344]
curr_Stock_Price:  103.04811017267936
curr_Factors:  [103.04811017]
mat_Sqrt:  [[0.15]]
grads:  [0.04002957]
Stock Position:  0.04002957388303545
Bond Position:  [-0.97693754]


portfolio before change:  [3.16609553]
curr_Stock_Price:  103.50083013330661
curr_Factors:  [103.50083013]
mat_Sqrt:  [[0.15]]
grads:  [-0.03754122]
Stock Position:  -0.037541222316498896
Bond Position:  [7.0516432]


portfolio before change:  [3.15704162]
curr_Stock_Price:  103.75374282515878
curr_Factors:  [103.75374283]
mat_Sqrt:  [[0.15]]
grads:  [-0.04428966]
Stock Position:  -0.0442896583753103
Bond Position:  [7.75225944]


portfolio before change:  [3.19764243]
curr_Stock_Price:  102.84797207886204
curr_Factors:  [102.84797208]
mat_Sqrt:  [[0.15]]
grads:  [-0.02525091]
Stock Position:  -0.025250905878652058
Bond Position:  [5.79464689]


portfolio before change:  [3.1831065]
curr_Stock_Price:  103.4379748326667
curr_Factors:  [103.43797483]
mat_Sqrt:  [[0.15]]
grads:  [-0.03293212]
Stock Position:  -0.032932116487484564
Bond Position:  [6.58953793]


portfolio before change:  [3.19087812]
curr_Stock_Price:  103.21449187828973
curr_Factors:  [103.21449188]
mat_Sqrt:  [[0.15]]
grads:  [0.02076256]
Stock Position:  0.020762560022755304
Bond Position:  [1.04788104]


portfolio before change:  [3.17787311]
curr_Stock_Price:  102.58496884392034
curr_Factors:  [102.58496884]
mat_Sqrt:  [[0.15]]
grads:  [0.01365024]
Stock Position:  0.013650238902702375
Bond Position:  [1.77756378]


portfolio before change:  [3.17509071]
curr_Stock_Price:  102.37299452037209
curr_Factors:  [102.37299452]
mat_Sqrt:  [[0.15]]
grads:  [-0.05713867]
Stock Position:  -0.05713866908825157
Bond Position:  [9.02454737]


portfolio before change:  [3.15071162]
curr_Stock_Price:  102.80953150126774
curr_Factors:  [102.8095315]
mat_Sqrt:  [[0.15]]
grads:  [-0.22532313]
Stock Position:  -0.22532312778789795
Bond Position:  [26.31607682]


portfolio before change:  [3.2520238]
curr_Stock_Price:  102.36720063550646
curr_Factors:  [102.36720064]
mat_Sqrt:  [[0.15]]
grads:  [-0.01607979]
Stock Position:  -0.016079785305554373
Bond Position:  [4.89806641]


portfolio before change:  [3.24834213]
curr_Stock_Price:  102.61520225839696
curr_Factors:  [102.61520226]
mat_Sqrt:  [[0.15]]
grads:  [0.08113678]
Stock Position:  0.08113678136713046
Bond Position:  [-5.0775251]


portfolio before change:  [3.1653309]
curr_Stock_Price:  101.59601136491511
curr_Factors:  [101.59601136]
mat_Sqrt:  [[0.15]]
grads:  [-0.08586477]
Stock Position:  -0.08586477086438193
Bond Position:  [11.88884914]


portfolio before change:  [3.14532909]
curr_Stock_Price:  101.83761094044502
curr_Factors:  [101.83761094]
mat_Sqrt:  [[0.15]]
grads:  [0.004083]
Stock Position:  0.004083003401430525
Bond Position:  [2.72952577]


portfolio before change:  [3.14488025]
curr_Stock_Price:  101.68589936715175
curr_Factors:  [101.68589937]
mat_Sqrt:  [[0.15]]
grads:  [0.01377886]
Stock Position:  0.013778858077737034
Bond Position:  [1.74376467]


portfolio before change:  [3.14648496]
curr_Stock_Price:  101.79445108820862
curr_Factors:  [101.79445109]
mat_Sqrt:  [[0.15]]
grads:  [-0.09117983]
Stock Position:  -0.09117983403064182
Bond Position:  [12.42808611]


portfolio before change:  [3.11964551]
curr_Stock_Price:  102.0973275934084
curr_Factors:  [102.09732759]
mat_Sqrt:  [[0.15]]
grads:  [-0.01084109]
Stock Position:  -0.01084109449422648
Bond Position:  [4.22649228]


portfolio before change:  [3.10741903]
curr_Stock_Price:  103.24948384355001
curr_Factors:  [103.24948384]
mat_Sqrt:  [[0.15]]
grads:  [0.04659125]
Stock Position:  0.04659125246501919
Bond Position:  [-1.70310373]


portfolio before change:  [3.10584882]
curr_Stock_Price:  103.21806654237108
curr_Factors:  [103.21806654]
mat_Sqrt:  [[0.15]]
grads:  [-0.05564652]
Stock Position:  -0.055646520578369676
Bond Position:  [8.84957508]


portfolio before change:  [3.12062689]
curr_Stock_Price:  102.96243594665034
curr_Factors:  [102.96243595]
mat_Sqrt:  [[0.15]]
grads:  [-0.02332748]
Stock Position:  -0.02332747901064703
Bond Position:  [5.52248095]


portfolio before change:  [3.11474227]
curr_Stock_Price:  103.22949363900345
curr_Factors:  [103.22949364]
mat_Sqrt:  [[0.15]]
grads:  [0.02294727]
Stock Position:  0.02294726593025959
Bond Position:  [0.74590763]


portfolio before change:  [3.13634877]
curr_Stock_Price:  104.16903376608354
curr_Factors:  [104.16903377]
mat_Sqrt:  [[0.15]]
grads:  [0.01825743]
Stock Position:  0.018257432120203518
Bond Position:  [1.2344897]


portfolio before change:  [3.14165844]
curr_Stock_Price:  104.45563015473049
curr_Factors:  [104.45563015]
mat_Sqrt:  [[0.15]]
grads:  [-0.00437805]
Stock Position:  -0.004378050988489554
Bond Position:  [3.59897051]


portfolio before change:  [3.14262519]
curr_Stock_Price:  104.2861912096787
curr_Factors:  [104.28619121]
mat_Sqrt:  [[0.15]]
grads:  [-0.05095939]
Stock Position:  -0.050959385208497944
Bond Position:  [8.45698538]


portfolio before change:  [3.16087455]
curr_Stock_Price:  103.93844797068547
curr_Factors:  [103.93844797]
mat_Sqrt:  [[0.15]]
grads:  [0.06862761]
Stock Position:  0.0686276134030967
Bond Position:  [-3.97217307]


portfolio before change:  [3.16153651]
curr_Stock_Price:  103.95171122689138
curr_Factors:  [103.95171123]
mat_Sqrt:  [[0.15]]
grads:  [-0.07874181]
Stock Position:  -0.07874180547224337
Bond Position:  [11.34688193]


portfolio before change:  [3.15796912]
curr_Stock_Price:  104.00602275470837
curr_Factors:  [104.00602275]
mat_Sqrt:  [[0.15]]
grads:  [-0.05803188]
Stock Position:  -0.058031876931739515
Bond Position:  [9.19363384]


portfolio before change:  [3.17284401]
curr_Stock_Price:  103.75960187777889
curr_Factors:  [103.75960188]
mat_Sqrt:  [[0.15]]
grads:  [0.10671809]
Stock Position:  0.10671808855339186
Bond Position:  [-7.90018237]


portfolio before change:  [3.0932447]
curr_Stock_Price:  103.01834482110971
curr_Factors:  [103.01834482]
mat_Sqrt:  [[0.15]]
grads:  [0.0134306]
Stock Position:  0.013430601558177324
Bond Position:  [1.70964636]


portfolio before change:  [3.08669978]
curr_Stock_Price:  102.52307496999308
curr_Factors:  [102.52307497]
mat_Sqrt:  [[0.15]]
grads:  [0.07457637]
Stock Position:  0.07457636710297313
Bond Position:  [-4.55909869]


portfolio before change:  [3.06216368]
curr_Stock_Price:  102.19788949716768
curr_Factors:  [102.1978895]
mat_Sqrt:  [[0.15]]
grads:  [-0.09465145]
Stock Position:  -0.09465144952631971
Bond Position:  [12.73534206]


portfolio before change:  [3.10834346]
curr_Stock_Price:  101.71840610339727
curr_Factors:  [101.7184061]
mat_Sqrt:  [[0.15]]
grads:  [-0.08425814]
Stock Position:  -0.08425814347205231
Bond Position:  [11.67894752]


portfolio before change:  [3.14481555]
curr_Stock_Price:  101.29420818921854
curr_Factors:  [101.29420819]
mat_Sqrt:  [[0.15]]
grads:  [-0.01636703]
Stock Position:  -0.016367030933961323
Bond Position:  [4.80270098]


portfolio before change:  [3.14282378]
curr_Stock_Price:  101.43424209644056
curr_Factors:  [101.4342421]
mat_Sqrt:  [[0.15]]
grads:  [-0.11826995]
Stock Position:  -0.11826994515522077
Bond Position:  [15.13944603]


portfolio before change:  [3.05743326]
curr_Stock_Price:  102.16423961930005
curr_Factors:  [102.16423962]
mat_Sqrt:  [[0.15]]
grads:  [-0.00973482]
Stock Position:  -0.009734819557078894
Bond Position:  [4.0519837]


portfolio before change:  [3.05527657]
curr_Stock_Price:  102.41179943875703
curr_Factors:  [102.41179944]
mat_Sqrt:  [[0.15]]
grads:  [0.1979098]
Stock Position:  0.1979098017901724
Bond Position:  [-17.21302236]


portfolio before change:  [3.11767553]
curr_Stock_Price:  102.73252540531804
curr_Factors:  [102.73252541]
mat_Sqrt:  [[0.15]]
grads:  [0.01718541]
Stock Position:  0.01718541045736369
Bond Position:  [1.35217492]


portfolio before change:  [3.11128458]
curr_Stock_Price:  102.35572526313562
curr_Factors:  [102.35572526]
mat_Sqrt:  [[0.15]]
grads:  [0.04728743]
Stock Position:  0.04728743486656098
Bond Position:  [-1.72885511]


portfolio before change:  [3.08826106]
curr_Stock_Price:  101.87112575154937
curr_Factors:  [101.87112575]
mat_Sqrt:  [[0.15]]
grads:  [-0.0916239]
Stock Position:  -0.09162390262772459
Bond Position:  [12.42209116]


portfolio before change:  [3.07387585]
curr_Stock_Price:  102.03660231770753
curr_Factors:  [102.03660232]
mat_Sqrt:  [[0.15]]
grads:  [-0.05306586]
Stock Position:  -0.05306585547268254
Bond Position:  [8.48853545]


portfolio before change:  [3.02269508]
curr_Stock_Price:  103.01107685721745
curr_Factors:  [103.01107686]
mat_Sqrt:  [[0.15]]
grads:  [-0.05128817]
Stock Position:  -0.05128817455077483
Bond Position:  [8.30594517]


portfolio before change:  [3.02912805]
curr_Stock_Price:  102.8957708965722
curr_Factors:  [102.8957709]
mat_Sqrt:  [[0.15]]
grads:  [0.02041607]
Stock Position:  0.020416074056439106
Bond Position:  [0.92840037]


portfolio before change:  [3.05878635]
curr_Stock_Price:  104.34562241531953
curr_Factors:  [104.34562242]
mat_Sqrt:  [[0.15]]
grads:  [0.04545177]
Stock Position:  0.0454517695309417
Bond Position:  [-1.68390683]


portfolio before change:  [3.12488524]
curr_Stock_Price:  105.8022023666293
curr_Factors:  [105.80220237]
mat_Sqrt:  [[0.15]]
grads:  [-0.00651119]
Stock Position:  -0.006511188115077236
Bond Position:  [3.81378328]


portfolio before change:  [3.12345385]
curr_Stock_Price:  106.05864726489652
curr_Factors:  [106.05864726]
mat_Sqrt:  [[0.15]]
grads:  [0.00613201]
Stock Position:  0.006132013018869233
Bond Position:  [2.47310084]


portfolio before change:  [3.12138922]
curr_Stock_Price:  105.69674322405064
curr_Factors:  [105.69674322]
mat_Sqrt:  [[0.15]]
grads:  [0.04891524]
Stock Position:  0.04891524409991826
Bond Position:  [-2.04879277]


portfolio before change:  [3.12827122]
curr_Stock_Price:  105.8400534075708
curr_Factors:  [105.84005341]
mat_Sqrt:  [[0.15]]
grads:  [-0.02117017]
Stock Position:  -0.021170165836951357
Bond Position:  [5.3689227]


portfolio before change:  [3.12211433]
curr_Stock_Price:  106.14673312073245
curr_Factors:  [106.14673312]
mat_Sqrt:  [[0.15]]
grads:  [0.14465112]
Stock Position:  0.1446511220188579
Bond Position:  [-12.23212972]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.12211433]
Stock Price:  106.73926497693083
PL:  [-3.61715065]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.94257523e-02]
 [ 6.90475496e-03]
 [-6.97665030e-04]
 [ 1.99034314e-03]
 [ 3.34546147e-03]
 [ 1.18875643e-02]
 [ 1.23019692e-03]
 [ 1.29863510e-02]
 [ 1.63532589e-02]
 [-1.97449728e-02]
 [ 7.17647962e-03]
 [-4.86072722e-03]
 [-9.82455453e-03]
 [ 4.25513798e-03]
 [ 5.31565293e-03]
 [ 1.35837026e-03]
 [ 6.37558626e-03]
 [ 1.14913090e-02]
 [ 2.16013415e-02]
 [ 1.17446639e-02]
 [ 5.63886263e-02]
 [-1.42132439e-02]
 [-2.29372026e-03]
 [ 9.63178009e-03]
 [ 1.41527033e-02]
 [-7.81314296e-03]
 [ 1.31864312e-02]
 [-6.33747060e-04]
 [ 3.33407503e-03]
 [-2.41928615e-02]
 [-4.57064314e-03]
 [-6.01122312e-03]
 [ 1.55290402e-02]
 [ 1.96788468e-02]
 [-9.07708480e-03]
 [ 5.56259389e-03]
 [-2.24043027e-03]
 [ 1.13198196e-02]
 [ 1.14007139e-04]
 [-1.37274014e-02]
 [-2.62263358e-03]
 [-2.89992785e-03]
 [ 6.19253399e-03]
 [-1.10547036e-02]
 [ 2.07479923e-03]
 [-1.10851724e-03]
 [-1.37074251e-02]
 [-5.13348607e-03]
 [-2.07959604e-03]
 [ 1.07582469e-02]
 [-3.03201678e-03]
 [ 3.71479608e-03]
 [ 1.39491289e-03]
 [-2.07721888e-03]
 [ 2.29527996e-03]
 [ 9.00348593e-03]
 [ 9.10397195e-03]
 [-2.84188248e-02]
 [ 1.38998080e-02]
 [ 5.24632477e-03]
 [ 6.91427858e-03]
 [-1.24507861e-02]
 [-1.25378675e-02]
 [-2.03228226e-03]
 [-1.23661704e-02]
 [ 2.17729788e-02]
 [ 1.33546453e-02]
 [ 2.00736732e-03]
 [ 9.17292564e-03]
 [-1.47278116e-02]
 [-5.03918129e-03]
 [ 8.25700466e-04]
 [ 1.48022719e-03]
 [ 8.58145867e-03]
 [ 5.86804692e-03]
 [-2.82126011e-03]
 [-1.91502262e-03]
 [-1.09230018e-02]
 [-2.86747397e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.98463919]
curr_Stock_Price:  99.41828069258933
curr_Factors:  [99.41828069]
mat_Sqrt:  [[0.15]]
grads:  [-0.26283835]
Stock Position:  -0.2628383485149221
Bond Position:  [19.14629752]


portfolio before change:  [-6.84885884]
curr_Stock_Price:  98.9062409998755
curr_Factors:  [98.906241]
mat_Sqrt:  [[0.15]]
grads:  [0.0460317]
Stock Position:  0.046031699745319295
Bond Position:  [-11.40168123]


portfolio before change:  [-6.83830527]
curr_Stock_Price:  99.1509897203585
curr_Factors:  [99.15098972]
mat_Sqrt:  [[0.15]]
grads:  [-0.0046511]
Stock Position:  -0.004651100200940244
Bond Position:  [-6.37714408]


portfolio before change:  [-6.84162568]
curr_Stock_Price:  99.77919159782716
curr_Factors:  [99.7791916]
mat_Sqrt:  [[0.15]]
grads:  [0.01326895]
Stock Position:  0.013268954264522681
Bond Position:  [-8.16559121]


portfolio before change:  [-6.84580108]
curr_Stock_Price:  99.50298082642318
curr_Factors:  [99.50298083]
mat_Sqrt:  [[0.15]]
grads:  [0.02230308]
Stock Position:  0.0223030764545235
Bond Position:  [-9.06502367]


portfolio before change:  [-6.83013182]
curr_Stock_Price:  100.23094502351844
curr_Factors:  [100.23094502]
mat_Sqrt:  [[0.15]]
grads:  [0.07925043]
Stock Position:  0.0792504283599803
Bond Position:  [-14.77347715]


portfolio before change:  [-6.86044235]
curr_Stock_Price:  99.8601310880897
curr_Factors:  [99.86013109]
mat_Sqrt:  [[0.15]]
grads:  [0.00820131]
Stock Position:  0.008201312781983239
Bond Position:  [-7.67942652]


portfolio before change:  [-6.86341082]
curr_Stock_Price:  99.55670486171746
curr_Factors:  [99.55670486]
mat_Sqrt:  [[0.15]]
grads:  [0.08657567]
Stock Position:  0.08657567355354007
Bond Position:  [-15.4825996]


portfolio before change:  [-6.91629634]
curr_Stock_Price:  98.95702346149044
curr_Factors:  [98.95702346]
mat_Sqrt:  [[0.15]]
grads:  [0.10902173]
Stock Position:  0.10902172620843562
Bond Position:  [-17.70476186]


portfolio before change:  [-6.90099537]
curr_Stock_Price:  99.10752148589492
curr_Factors:  [99.10752149]
mat_Sqrt:  [[0.15]]
grads:  [-0.13163315]
Stock Position:  -0.1316331517505447
Bond Position:  [6.14484005]


portfolio before change:  [-6.96678924]
curr_Stock_Price:  99.61026671322225
curr_Factors:  [99.61026671]
mat_Sqrt:  [[0.15]]
grads:  [0.0478432]
Stock Position:  0.04784319748156353
Bond Position:  [-11.7324629]


portfolio before change:  [-6.94855223]
curr_Stock_Price:  100.0067768461362
curr_Factors:  [100.00677685]
mat_Sqrt:  [[0.15]]
grads:  [-0.03240485]
Stock Position:  -0.03240484814797491
Bond Position:  [-3.70784781]


portfolio before change:  [-6.94681677]
curr_Stock_Price:  99.94606963579257
curr_Factors:  [99.94606964]
mat_Sqrt:  [[0.15]]
grads:  [-0.06549703]
Stock Position:  -0.06549703020099115
Bond Position:  [-0.40064603]


portfolio before change:  [-6.99098544]
curr_Stock_Price:  100.62004867099971
curr_Factors:  [100.62004867]
mat_Sqrt:  [[0.15]]
grads:  [0.02836759]
Stock Position:  0.02836758652547763
Bond Position:  [-9.84533337]


portfolio before change:  [-7.00942033]
curr_Stock_Price:  99.99188311308228
curr_Factors:  [99.99188311]
mat_Sqrt:  [[0.15]]
grads:  [0.03543769]
Stock Position:  0.035437686218074624
Bond Position:  [-10.55290131]


portfolio before change:  [-7.01374313]
curr_Stock_Price:  99.88851234869716
curr_Factors:  [99.88851235]
mat_Sqrt:  [[0.15]]
grads:  [0.0090558]
Stock Position:  0.00905580171754646
Bond Position:  [-7.91831369]


portfolio before change:  [-7.01448102]
curr_Stock_Price:  99.86168079117749
curr_Factors:  [99.86168079]
mat_Sqrt:  [[0.15]]
grads:  [0.04250391]
Stock Position:  0.04250390837828427
Bond Position:  [-11.25899275]


portfolio before change:  [-6.9988542]
curr_Stock_Price:  100.24589312484002
curr_Factors:  [100.24589312]
mat_Sqrt:  [[0.15]]
grads:  [0.07660873]
Stock Position:  0.07660872679682093
Bond Position:  [-14.67856444]


portfolio before change:  [-7.01368421]
curr_Stock_Price:  100.06428759417962
curr_Factors:  [100.06428759]
mat_Sqrt:  [[0.15]]
grads:  [0.14400894]
Stock Position:  0.14400894305788478
Bond Position:  [-21.4238365]


portfolio before change:  [-7.17371133]
curr_Stock_Price:  98.96235537869339
curr_Factors:  [98.96235538]
mat_Sqrt:  [[0.15]]
grads:  [0.07829776]
Stock Position:  0.0782977595147512
Bond Position:  [-14.92224204]


portfolio before change:  [-7.14082671]
curr_Stock_Price:  99.39426169312607
curr_Factors:  [99.39426169]
mat_Sqrt:  [[0.15]]
grads:  [0.37592418]
Stock Position:  0.3759241754247808
Bond Position:  [-44.50553258]


portfolio before change:  [-6.92012957]
curr_Stock_Price:  99.98874014097268
curr_Factors:  [99.98874014]
mat_Sqrt:  [[0.15]]
grads:  [-0.09475496]
Stock Position:  -0.09475495929512016
Bond Position:  [2.55429943]


portfolio before change:  [-6.93952933]
curr_Stock_Price:  100.19516108634572
curr_Factors:  [100.19516109]
mat_Sqrt:  [[0.15]]
grads:  [-0.01529147]
Stock Position:  -0.01529146838157969
Bond Position:  [-5.40739819]


portfolio before change:  [-6.94115855]
curr_Stock_Price:  100.27960369022472
curr_Factors:  [100.27960369]
mat_Sqrt:  [[0.15]]
grads:  [0.06421187]
Stock Position:  0.06421186728617453
Bond Position:  [-13.38029916]


portfolio before change:  [-6.93087998]
curr_Stock_Price:  100.45270048515135
curr_Factors:  [100.45270049]
mat_Sqrt:  [[0.15]]
grads:  [0.09435136]
Stock Position:  0.09435135550954916
Bond Position:  [-16.40872844]


portfolio before change:  [-6.95260953]
curr_Stock_Price:  100.23326567582322
curr_Factors:  [100.23326568]
mat_Sqrt:  [[0.15]]
grads:  [-0.05208762]
Stock Position:  -0.05208761976316613
Bond Position:  [-1.7316973]


portfolio before change:  [-6.95915606]
curr_Stock_Price:  100.35687083147756
curr_Factors:  [100.35687083]
mat_Sqrt:  [[0.15]]
grads:  [0.08790954]
Stock Position:  0.08790954101252972
Bond Position:  [-15.78148251]


portfolio before change:  [-6.88643216]
curr_Stock_Price:  101.19534946648906
curr_Factors:  [101.19534947]
mat_Sqrt:  [[0.15]]
grads:  [-0.00422498]
Stock Position:  -0.004224980400200223
Bond Position:  [-6.4588838]


portfolio before change:  [-6.8838659]
curr_Stock_Price:  100.49239844588746
curr_Factors:  [100.49239845]
mat_Sqrt:  [[0.15]]
grads:  [0.02222717]
Stock Position:  0.022227166873410923
Bond Position:  [-9.11752721]


portfolio before change:  [-6.89239796]
curr_Stock_Price:  100.13417932143689
curr_Factors:  [100.13417932]
mat_Sqrt:  [[0.15]]
grads:  [-0.16128574]
Stock Position:  -0.16128574325709555
Bond Position:  [9.25781758]


portfolio before change:  [-6.88647931]
curr_Stock_Price:  100.10107024070506
curr_Factors:  [100.10107024]
mat_Sqrt:  [[0.15]]
grads:  [-0.03047095]
Stock Position:  -0.03047095425776278
Bond Position:  [-3.83630417]


portfolio before change:  [-6.87083936]
curr_Stock_Price:  99.57992725853205
curr_Factors:  [99.57992726]
mat_Sqrt:  [[0.15]]
grads:  [-0.04007482]
Stock Position:  -0.04007482080427338
Bond Position:  [-2.88019162]


portfolio before change:  [-6.83907255]
curr_Stock_Price:  98.78274781877853
curr_Factors:  [98.78274782]
mat_Sqrt:  [[0.15]]
grads:  [0.10352693]
Stock Position:  0.1035269349348745
Bond Position:  [-17.06574766]


portfolio before change:  [-6.82994581]
curr_Stock_Price:  98.88120898155745
curr_Factors:  [98.88120898]
mat_Sqrt:  [[0.15]]
grads:  [0.13119231]
Stock Position:  0.13119231213654187
Bond Position:  [-19.80240025]


portfolio before change:  [-6.78416117]
curr_Stock_Price:  99.23963188317563
curr_Factors:  [99.23963188]
mat_Sqrt:  [[0.15]]
grads:  [-0.0605139]
Stock Position:  -0.060513898661581265
Bond Position:  [-0.77878415]


portfolio before change:  [-6.76338309]
curr_Stock_Price:  98.89546695556828
curr_Factors:  [98.89546696]
mat_Sqrt:  [[0.15]]
grads:  [0.03708396]
Stock Position:  0.03708395924189018
Bond Position:  [-10.43081855]


portfolio before change:  [-6.75469882]
curr_Stock_Price:  99.14722583228053
curr_Factors:  [99.14722583]
mat_Sqrt:  [[0.15]]
grads:  [-0.0149362]
Stock Position:  -0.014936201805929803
Bond Position:  [-5.27381584]


portfolio before change:  [-6.75482175]
curr_Stock_Price:  99.13338723745318
curr_Factors:  [99.13338724]
mat_Sqrt:  [[0.15]]
grads:  [0.07546546]
Stock Position:  0.07546546378393518
Bond Position:  [-14.23596879]


portfolio before change:  [-6.72631191]
curr_Stock_Price:  99.52296424798196
curr_Factors:  [99.52296425]
mat_Sqrt:  [[0.15]]
grads:  [0.00076005]
Stock Position:  0.0007600475964886222
Bond Position:  [-6.8019541]


portfolio before change:  [-6.72700829]
curr_Stock_Price:  99.16609157475943
curr_Factors:  [99.16609157]
mat_Sqrt:  [[0.15]]
grads:  [-0.09151601]
Stock Position:  -0.09151600905611906
Bond Position:  [2.34827665]


portfolio before change:  [-6.78315276]
curr_Stock_Price:  99.78118880744304
curr_Factors:  [99.78118881]
mat_Sqrt:  [[0.15]]
grads:  [-0.01748422]
Stock Position:  -0.01748422389081276
Bond Position:  [-5.03855611]


portfolio before change:  [-6.78582217]
curr_Stock_Price:  99.9158526703142
curr_Factors:  [99.91585267]
mat_Sqrt:  [[0.15]]
grads:  [-0.01933285]
Stock Position:  -0.019332852310633097
Bond Position:  [-4.85416375]


portfolio before change:  [-6.79165849]
curr_Stock_Price:  100.20204556854007
curr_Factors:  [100.20204557]
mat_Sqrt:  [[0.15]]
grads:  [0.04128356]
Stock Position:  0.04128355990504235
Bond Position:  [-10.92835564]


portfolio before change:  [-6.80623266]
curr_Stock_Price:  99.86556471252636
curr_Factors:  [99.86556471]
mat_Sqrt:  [[0.15]]
grads:  [-0.07369802]
Stock Position:  -0.07369802397964373
Bond Position:  [0.55366212]


portfolio before change:  [-6.86247207]
curr_Stock_Price:  100.62914035876042
curr_Factors:  [100.62914036]
mat_Sqrt:  [[0.15]]
grads:  [0.01383199]
Stock Position:  0.013831994897454866
Bond Position:  [-8.25437383]


portfolio before change:  [-6.87155851]
curr_Stock_Price:  100.00952491032308
curr_Factors:  [100.00952491]
mat_Sqrt:  [[0.15]]
grads:  [-0.00739011]
Stock Position:  -0.007390114953492649
Bond Position:  [-6.13247662]


portfolio before change:  [-6.87800928]
curr_Stock_Price:  100.83055185126324
curr_Factors:  [100.83055185]
mat_Sqrt:  [[0.15]]
grads:  [-0.09138283]
Stock Position:  -0.0913828338117544
Bond Position:  [2.33617228]


portfolio before change:  [-6.86727703]
curr_Stock_Price:  100.71470692350402
curr_Factors:  [100.71470692]
mat_Sqrt:  [[0.15]]
grads:  [-0.03422324]
Stock Position:  -0.034223240493593154
Bond Position:  [-3.42049339]


portfolio before change:  [-6.85265127]
curr_Stock_Price:  100.28109683877304
curr_Factors:  [100.28109684]
mat_Sqrt:  [[0.15]]
grads:  [-0.01386397]
Stock Position:  -0.013863973580259354
Bond Position:  [-5.4623568]


portfolio before change:  [-6.83989331]
curr_Stock_Price:  99.33624673678288
curr_Factors:  [99.33624674]
mat_Sqrt:  [[0.15]]
grads:  [0.07172165]
Stock Position:  0.07172164629451849
Bond Position:  [-13.96445246]


portfolio before change:  [-6.82793738]
curr_Stock_Price:  99.51511503772063
curr_Factors:  [99.51511504]
mat_Sqrt:  [[0.15]]
grads:  [-0.02021345]
Stock Position:  -0.0202134452096629
Bond Position:  [-4.81639406]


portfolio before change:  [-6.84130722]
curr_Stock_Price:  100.1616553595094
curr_Factors:  [100.16165536]
mat_Sqrt:  [[0.15]]
grads:  [0.02476531]
Stock Position:  0.024765307177928512
Bond Position:  [-9.32184139]


portfolio before change:  [-6.84875516]
curr_Stock_Price:  99.88444076465296
curr_Factors:  [99.88444076]
mat_Sqrt:  [[0.15]]
grads:  [0.00929942]
Stock Position:  0.009299419260971909
Bond Position:  [-7.77762245]


portfolio before change:  [-6.85095114]
curr_Stock_Price:  99.70057330003726
curr_Factors:  [99.7005733]
mat_Sqrt:  [[0.15]]
grads:  [-0.01384813]
Stock Position:  -0.013848125855882229
Bond Position:  [-5.47028505]


portfolio before change:  [-6.85184425]
curr_Stock_Price:  99.74037719333803
curr_Factors:  [99.74037719]
mat_Sqrt:  [[0.15]]
grads:  [0.01530187]
Stock Position:  0.015301866411368626
Bond Position:  [-8.37805818]


portfolio before change:  [-6.85305054]
curr_Stock_Price:  99.69576532375469
curr_Factors:  [99.69576532]
mat_Sqrt:  [[0.15]]
grads:  [0.06002324]
Stock Position:  0.06002323953204109
Bond Position:  [-12.83711334]


portfolio before change:  [-6.83178754]
curr_Stock_Price:  100.0633787469282
curr_Factors:  [100.06337875]
mat_Sqrt:  [[0.15]]
grads:  [0.06069315]
Stock Position:  0.06069314633446216
Bond Position:  [-12.90494883]


portfolio before change:  [-6.86574501]
curr_Stock_Price:  99.51717387396963
curr_Factors:  [99.51717387]
mat_Sqrt:  [[0.15]]
grads:  [-0.18945883]
Stock Position:  -0.1894588320803784
Bond Position:  [11.98866252]


portfolio before change:  [-6.73892943]
curr_Stock_Price:  98.8517719856175
curr_Factors:  [98.85177199]
mat_Sqrt:  [[0.15]]
grads:  [0.09266539]
Stock Position:  0.09266538664169167
Bond Position:  [-15.89906711]


portfolio before change:  [-6.70658243]
curr_Stock_Price:  99.21156902781561
curr_Factors:  [99.21156903]
mat_Sqrt:  [[0.15]]
grads:  [0.0349755]
Stock Position:  0.03497549843374074
Bond Position:  [-10.1765565]


portfolio before change:  [-6.67711777]
curr_Stock_Price:  100.07219165014305
curr_Factors:  [100.07219165]
mat_Sqrt:  [[0.15]]
grads:  [0.04609519]
Stock Position:  0.046095190501127245
Bond Position:  [-11.28996451]


portfolio before change:  [-6.6671661]
curr_Stock_Price:  100.30339411774925
curr_Factors:  [100.30339412]
mat_Sqrt:  [[0.15]]
grads:  [-0.08300524]
Stock Position:  -0.08300524058562105
Bond Position:  [1.65854126]


portfolio before change:  [-6.61489769]
curr_Stock_Price:  99.67494290450344
curr_Factors:  [99.6749429]
mat_Sqrt:  [[0.15]]
grads:  [-0.08358578]
Stock Position:  -0.08358578336028209
Bond Position:  [1.71651049]


portfolio before change:  [-6.60381076]
curr_Stock_Price:  99.5435851392338
curr_Factors:  [99.54358514]
mat_Sqrt:  [[0.15]]
grads:  [-0.01354855]
Stock Position:  -0.013548548409080773
Bond Position:  [-5.25513968]


portfolio before change:  [-6.59892439]
curr_Stock_Price:  99.15868584464992
curr_Factors:  [99.15868584]
mat_Sqrt:  [[0.15]]
grads:  [-0.08244114]
Stock Position:  -0.08244113596567208
Bond Position:  [1.57583031]


portfolio before change:  [-6.61708384]
curr_Stock_Price:  99.38015218170499
curr_Factors:  [99.38015218]
mat_Sqrt:  [[0.15]]
grads:  [0.14515319]
Stock Position:  0.1451531923209147
Bond Position:  [-21.04243018]


portfolio before change:  [-6.6356826]
curr_Stock_Price:  99.26108092445541
curr_Factors:  [99.26108092]
mat_Sqrt:  [[0.15]]
grads:  [0.08903097]
Stock Position:  0.08903096895034941
Bond Position:  [-15.47299282]


portfolio before change:  [-6.67876895]
curr_Stock_Price:  98.78799546918573
curr_Factors:  [98.78799547]
mat_Sqrt:  [[0.15]]
grads:  [0.01338245]
Stock Position:  0.013382448775758284
Bond Position:  [-8.00079424]


portfolio before change:  [-6.68600105]
curr_Stock_Price:  98.28494597442977
curr_Factors:  [98.28494597]
mat_Sqrt:  [[0.15]]
grads:  [0.06115284]
Stock Position:  0.06115283757088396
Bond Position:  [-12.69640439]


portfolio before change:  [-6.61592451]
curr_Stock_Price:  99.44384711401057
curr_Factors:  [99.44384711]
mat_Sqrt:  [[0.15]]
grads:  [-0.09818541]
Stock Position:  -0.09818541095284317
Bond Position:  [3.14801049]


portfolio before change:  [-6.57603249]
curr_Stock_Price:  99.03955835033067
curr_Factors:  [99.03955835]
mat_Sqrt:  [[0.15]]
grads:  [-0.03359454]
Stock Position:  -0.03359454194048144
Bond Position:  [-3.2488439]


portfolio before change:  [-6.55748545]
curr_Stock_Price:  98.4814288212029
curr_Factors:  [98.48142882]
mat_Sqrt:  [[0.15]]
grads:  [0.00550467]
Stock Position:  0.005504669773750276
Bond Position:  [-7.09959319]


portfolio before change:  [-6.55726639]
curr_Stock_Price:  98.60183442956733
curr_Factors:  [98.60183443]
mat_Sqrt:  [[0.15]]
grads:  [0.00986818]
Stock Position:  0.009868181246804433
Bond Position:  [-7.53028717]


portfolio before change:  [-6.55926299]
curr_Stock_Price:  98.4472020266976
curr_Factors:  [98.44720203]
mat_Sqrt:  [[0.15]]
grads:  [0.05720972]
Stock Position:  0.05720972447546301
Bond Position:  [-12.19140029]


portfolio before change:  [-6.56184392]
curr_Stock_Price:  98.4154076577339
curr_Factors:  [98.41540766]
mat_Sqrt:  [[0.15]]
grads:  [0.03912031]
Stock Position:  0.03912031277365744
Bond Position:  [-10.41188545]


portfolio before change:  [-6.55707803]
curr_Stock_Price:  98.55386922673918
curr_Factors:  [98.55386923]
mat_Sqrt:  [[0.15]]
grads:  [-0.0188084]
Stock Position:  -0.018808400722729896
Bond Position:  [-4.70343736]


portfolio before change:  [-6.54505374]
curr_Stock_Price:  97.89893541685522
curr_Factors:  [97.89893542]
mat_Sqrt:  [[0.15]]
grads:  [-0.01276682]
Stock Position:  -0.01276681746286502
Bond Position:  [-5.29519591]


portfolio before change:  [-6.53542188]
curr_Stock_Price:  97.11856685044697
curr_Factors:  [97.11856685]
mat_Sqrt:  [[0.15]]
grads:  [-0.07282001]
Stock Position:  -0.0728200117361085
Bond Position:  [0.5367533]


portfolio before change:  [-6.52178974]
curr_Stock_Price:  96.93182434728325
curr_Factors:  [96.93182435]
mat_Sqrt:  [[0.15]]
grads:  [-0.19116493]
Stock Position:  -0.19116493118247657
Bond Position:  [12.00817579]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.52178974]
Stock Price:  96.36055744256132
PL:  [-6.52178974]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.68733219e-02]
 [-2.26514789e-03]
 [ 1.10881720e-04]
 [ 1.60337745e-03]
 [ 1.50072289e-02]
 [ 1.13826632e-02]
 [ 7.54902276e-04]
 [ 1.55450206e-02]
 [ 1.39116729e-02]
 [-2.04442569e-02]
 [ 1.02780226e-02]
 [-7.27712322e-03]
 [-2.42585333e-03]
 [ 4.03773757e-03]
 [ 1.00025009e-03]
 [-1.00743900e-02]
 [ 8.50683025e-03]
 [ 2.70542106e-02]
 [ 1.45776575e-02]
 [-2.44045786e-03]
 [ 4.09234241e-02]
 [-1.09212343e-02]
 [ 2.14852980e-03]
 [-2.33759089e-03]
 [ 1.76098676e-02]
 [ 1.82606110e-02]
 [ 9.00565758e-03]
 [-1.13345890e-03]
 [ 7.68613455e-03]
 [-9.36701444e-03]
 [-5.80975974e-03]
 [ 4.37649506e-02]
 [ 1.92957609e-03]
 [-1.03251556e-02]
 [-1.32184287e-03]
 [-6.05845687e-03]
 [-1.43170160e-03]
 [-3.28667811e-03]
 [ 8.07119906e-03]
 [-5.28187557e-03]
 [-6.19392511e-02]
 [-5.35098498e-03]
 [ 2.16805046e-02]
 [-1.68331102e-02]
 [-7.63932787e-03]
 [ 3.26333022e-03]
 [-1.35227655e-02]
 [ 2.83239652e-02]
 [ 4.83656472e-02]
 [-1.42647320e-02]
 [-4.48222660e-03]
 [ 3.54253257e-03]
 [ 3.11459373e-03]
 [-2.40162423e-04]
 [-8.70696718e-03]
 [ 1.05564833e-02]
 [-1.36549421e-02]
 [-8.01255407e-03]
 [ 1.87220306e-02]
 [-6.45393489e-03]
 [ 1.30841203e-02]
 [-1.43270856e-02]
 [-1.26986299e-02]
 [-2.72822223e-03]
 [ 6.56210918e-02]
 [-1.51244558e-02]
 [ 9.54718634e-03]
 [ 5.28263350e-03]
 [ 1.43080474e-02]
 [-2.62279563e-02]
 [-7.81499233e-03]
 [-5.91961090e-03]
 [ 9.86711674e-03]
 [ 5.71020803e-03]
 [-9.30254057e-04]
 [-1.21367113e-03]
 [ 7.34496342e-03]
 [-3.21544486e-03]
 [ 2.18144818e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.16929711]
curr_Stock_Price:  99.59922458526992
curr_Factors:  [99.59922459]
mat_Sqrt:  [[0.15]]
grads:  [-0.24582215]
Stock Position:  -0.24582214617034337
Bond Position:  [20.31439804]


portfolio before change:  [-4.30428279]
curr_Stock_Price:  100.15350895723617
curr_Factors:  [100.15350896]
mat_Sqrt:  [[0.15]]
grads:  [-0.01510099]
Stock Position:  -0.015100985943391841
Bond Position:  [-2.79186606]


portfolio before change:  [-4.30657984]
curr_Stock_Price:  100.29406617077748
curr_Factors:  [100.29406617]
mat_Sqrt:  [[0.15]]
grads:  [0.00073921]
Stock Position:  0.0007392114633884521
Bond Position:  [-4.38071836]


portfolio before change:  [-4.30733284]
curr_Stock_Price:  99.64581604803288
curr_Factors:  [99.64581605]
mat_Sqrt:  [[0.15]]
grads:  [0.01068918]
Stock Position:  0.010689183017073065
Bond Position:  [-5.3724652]


portfolio before change:  [-4.30668068]
curr_Stock_Price:  99.73824153625438
curr_Factors:  [99.73824154]
mat_Sqrt:  [[0.15]]
grads:  [0.10004819]
Stock Position:  0.1000481927740635
Bond Position:  [-14.28531149]


portfolio before change:  [-4.31723448]
curr_Stock_Price:  99.64167865289323
curr_Factors:  [99.64167865]
mat_Sqrt:  [[0.15]]
grads:  [0.07588442]
Stock Position:  0.07588442100744999
Bond Position:  [-11.87848557]


portfolio before change:  [-4.32665349]
curr_Stock_Price:  99.5273391899647
curr_Factors:  [99.52733919]
mat_Sqrt:  [[0.15]]
grads:  [0.00503268]
Stock Position:  0.0050326818382258175
Bond Position:  [-4.82754292]


portfolio before change:  [-4.32925073]
curr_Stock_Price:  99.07121803394803
curr_Factors:  [99.07121803]
mat_Sqrt:  [[0.15]]
grads:  [0.10363347]
Stock Position:  0.10363347052632073
Bond Position:  [-14.59634489]


portfolio before change:  [-4.23922589]
curr_Stock_Price:  99.94870622948717
curr_Factors:  [99.94870623]
mat_Sqrt:  [[0.15]]
grads:  [0.09274449]
Stock Position:  0.09274448593478261
Bond Position:  [-13.50891727]


portfolio before change:  [-4.16357756]
curr_Stock_Price:  100.77347397024975
curr_Factors:  [100.77347397]
mat_Sqrt:  [[0.15]]
grads:  [-0.13629505]
Stock Position:  -0.13629504604852544
Bond Position:  [9.57134772]


portfolio before change:  [-4.15896646]
curr_Stock_Price:  100.74403142894445
curr_Factors:  [100.74403143]
mat_Sqrt:  [[0.15]]
grads:  [0.06852015]
Stock Position:  0.06852015088608057
Bond Position:  [-11.06196269]


portfolio before change:  [-4.1379559]
curr_Stock_Price:  101.06075504365444
curr_Factors:  [101.06075504]
mat_Sqrt:  [[0.15]]
grads:  [-0.04851415]
Stock Position:  -0.0485141547959085
Bond Position:  [0.76492121]


portfolio before change:  [-4.11179697]
curr_Stock_Price:  100.52253846301814
curr_Factors:  [100.52253846]
mat_Sqrt:  [[0.15]]
grads:  [-0.01617236]
Stock Position:  -0.016172355549200854
Bond Position:  [-2.48611074]


portfolio before change:  [-4.12633433]
curr_Stock_Price:  101.4118318465644
curr_Factors:  [101.41183185]
mat_Sqrt:  [[0.15]]
grads:  [0.02691825]
Stock Position:  0.02691825047842235
Bond Position:  [-6.85616342]


portfolio before change:  [-4.12314498]
curr_Stock_Price:  101.54623382844782
curr_Factors:  [101.54623383]
mat_Sqrt:  [[0.15]]
grads:  [0.00666833]
Stock Position:  0.006668333941661729
Bond Position:  [-4.80028918]


portfolio before change:  [-4.12050024]
curr_Stock_Price:  101.98783975836945
curr_Factors:  [101.98783976]
mat_Sqrt:  [[0.15]]
grads:  [-0.0671626]
Stock Position:  -0.06716259975986397
Bond Position:  [2.72926823]


portfolio before change:  [-4.13960343]
curr_Stock_Price:  102.2748116084223
curr_Factors:  [102.27481161]
mat_Sqrt:  [[0.15]]
grads:  [0.0567122]
Stock Position:  0.05671220166414598
Bond Position:  [-9.93983317]


portfolio before change:  [-4.12315831]
curr_Stock_Price:  102.57574110780402
curr_Factors:  [102.57574111]
mat_Sqrt:  [[0.15]]
grads:  [0.1803614]
Stock Position:  0.1803614039206274
Bond Position:  [-22.62386299]


portfolio before change:  [-4.15410545]
curr_Stock_Price:  102.41199706505103
curr_Factors:  [102.41199707]
mat_Sqrt:  [[0.15]]
grads:  [0.09718438]
Stock Position:  0.09718438349012785
Bond Position:  [-14.10695225]


portfolio before change:  [-4.09822841]
curr_Stock_Price:  102.99602869367382
curr_Factors:  [102.99602869]
mat_Sqrt:  [[0.15]]
grads:  [-0.01626972]
Stock Position:  -0.01626971909626031
Bond Position:  [-2.42251196]


portfolio before change:  [-4.09308701]
curr_Stock_Price:  102.67071197602615
curr_Factors:  [102.67071198]
mat_Sqrt:  [[0.15]]
grads:  [0.27282283]
Stock Position:  0.27282282749366626
Bond Position:  [-32.10400095]


portfolio before change:  [-3.93030014]
curr_Stock_Price:  103.27474293046178
curr_Factors:  [103.27474293]
mat_Sqrt:  [[0.15]]
grads:  [-0.07280823]
Stock Position:  -0.07280822846383281
Bond Position:  [3.58895094]


portfolio before change:  [-3.92894415]
curr_Stock_Price:  103.25919966844077
curr_Factors:  [103.25919967]
mat_Sqrt:  [[0.15]]
grads:  [0.01432353]
Stock Position:  0.014323531978851847
Bond Position:  [-5.4079806]


portfolio before change:  [-3.93582592]
curr_Stock_Price:  102.80234545718467
curr_Factors:  [102.80234546]
mat_Sqrt:  [[0.15]]
grads:  [-0.01558394]
Stock Position:  -0.015583939237895222
Bond Position:  [-2.33376042]


portfolio before change:  [-3.93435967]
curr_Stock_Price:  102.69889804044166
curr_Factors:  [102.69889804]
mat_Sqrt:  [[0.15]]
grads:  [0.11739912]
Stock Position:  0.11739911706744786
Bond Position:  [-15.99111962]


portfolio before change:  [-3.98115668]
curr_Stock_Price:  102.30879681541272
curr_Factors:  [102.30879682]
mat_Sqrt:  [[0.15]]
grads:  [0.12173741]
Stock Position:  0.12173740654486893
Bond Position:  [-16.43596428]


portfolio before change:  [-3.86542026]
curr_Stock_Price:  103.26794081805717
curr_Factors:  [103.26794082]
mat_Sqrt:  [[0.15]]
grads:  [0.06003772]
Stock Position:  0.06003771721789935
Bond Position:  [-10.06539169]


portfolio before change:  [-3.83114564]
curr_Stock_Price:  103.84930410019582
curr_Factors:  [103.8493041]
mat_Sqrt:  [[0.15]]
grads:  [-0.00755639]
Stock Position:  -0.007556392689264993
Bond Position:  [-3.04641952]


portfolio before change:  [-3.82993847]
curr_Stock_Price:  103.6643505022632
curr_Factors:  [103.6643505]
mat_Sqrt:  [[0.15]]
grads:  [0.0512409]
Stock Position:  0.051240896988674435
Bond Position:  [-9.14179277]


portfolio before change:  [-3.79051662]
curr_Stock_Price:  104.44484482772667
curr_Factors:  [104.44484483]
mat_Sqrt:  [[0.15]]
grads:  [-0.06244676]
Stock Position:  -0.062446762921039754
Bond Position:  [2.73172584]


portfolio before change:  [-3.826957]
curr_Stock_Price:  105.03112211251174
curr_Factors:  [105.03112211]
mat_Sqrt:  [[0.15]]
grads:  [-0.03873173]
Stock Position:  -0.03873173163187297
Bond Position:  [0.24108023]


portfolio before change:  [-3.84870631]
curr_Stock_Price:  105.59304848694232
curr_Factors:  [105.59304849]
mat_Sqrt:  [[0.15]]
grads:  [0.29176634]
Stock Position:  0.29176633701514165
Bond Position:  [-34.65720328]


portfolio before change:  [-3.71458182]
curr_Stock_Price:  106.06017103289301
curr_Factors:  [106.06017103]
mat_Sqrt:  [[0.15]]
grads:  [0.01286384]
Stock Position:  0.012863840582007464
Bond Position:  [-5.07892295]


portfolio before change:  [-3.71903705]
curr_Stock_Price:  105.73851055299963
curr_Factors:  [105.73851055]
mat_Sqrt:  [[0.15]]
grads:  [-0.06883437]
Stock Position:  -0.06883437039265859
Bond Position:  [3.55940675]


portfolio before change:  [-3.72840411]
curr_Stock_Price:  105.87782364896572
curr_Factors:  [105.87782365]
mat_Sqrt:  [[0.15]]
grads:  [-0.00881229]
Stock Position:  -0.008812285795875043
Bond Position:  [-2.79537847]


portfolio before change:  [-3.72401578]
curr_Stock_Price:  105.36001873960532
curr_Factors:  [105.36001874]
mat_Sqrt:  [[0.15]]
grads:  [-0.04038971]
Stock Position:  -0.040389712492626254
Bond Position:  [0.53144508]


portfolio before change:  [-3.72848864]
curr_Stock_Price:  105.47158365745469
curr_Factors:  [105.47158366]
mat_Sqrt:  [[0.15]]
grads:  [-0.00954468]
Stock Position:  -0.009544677335847069
Bond Position:  [-2.72179641]


portfolio before change:  [-3.72824995]
curr_Stock_Price:  105.42875212598935
curr_Factors:  [105.42875213]
mat_Sqrt:  [[0.15]]
grads:  [-0.02191119]
Stock Position:  -0.02191118741334325
Bond Position:  [-1.4181808]


portfolio before change:  [-3.7495822]
curr_Stock_Price:  106.3982850002678
curr_Factors:  [106.398285]
mat_Sqrt:  [[0.15]]
grads:  [0.05380799]
Stock Position:  0.053807993753013095
Bond Position:  [-9.47466046]


portfolio before change:  [-3.74105491]
curr_Stock_Price:  106.56776680941996
curr_Factors:  [106.56776681]
mat_Sqrt:  [[0.15]]
grads:  [-0.0352125]
Stock Position:  -0.035212503806539217
Bond Position:  [0.01146298]


portfolio before change:  [-3.72920973]
curr_Stock_Price:  106.23139578722954
curr_Factors:  [106.23139579]
mat_Sqrt:  [[0.15]]
grads:  [-0.41292834]
Stock Position:  -0.41292834070903817
Bond Position:  [40.13674426]


portfolio before change:  [-3.95328733]
curr_Stock_Price:  106.78012592124169
curr_Factors:  [106.78012592]
mat_Sqrt:  [[0.15]]
grads:  [-0.03567323]
Stock Position:  -0.035673233218692375
Bond Position:  [-0.14409499]


portfolio before change:  [-3.96912449]
curr_Stock_Price:  107.22382424487928
curr_Factors:  [107.22382424]
mat_Sqrt:  [[0.15]]
grads:  [0.1445367]
Stock Position:  0.14453669701602334
Bond Position:  [-19.46690189]


portfolio before change:  [-4.14622796]
curr_Stock_Price:  106.00692396480987
curr_Factors:  [106.00692396]
mat_Sqrt:  [[0.15]]
grads:  [-0.11222073]
Stock Position:  -0.11222073470257841
Bond Position:  [7.74994694]


portfolio before change:  [-4.15222286]
curr_Stock_Price:  106.06466095726446
curr_Factors:  [106.06466096]
mat_Sqrt:  [[0.15]]
grads:  [-0.05092885]
Stock Position:  -0.050928852465295826
Bond Position:  [1.24952861]


portfolio before change:  [-4.17613437]
curr_Stock_Price:  106.53570270969352
curr_Factors:  [106.53570271]
mat_Sqrt:  [[0.15]]
grads:  [0.02175553]
Stock Position:  0.02175553476834558
Bond Position:  [-6.49387556]


portfolio before change:  [-4.17567988]
curr_Stock_Price:  106.57525027887495
curr_Factors:  [106.57525028]
mat_Sqrt:  [[0.15]]
grads:  [-0.09015177]
Stock Position:  -0.09015176985344277
Bond Position:  [5.43226756]


portfolio before change:  [-4.24185511]
curr_Stock_Price:  107.31305897574181
curr_Factors:  [107.31305898]
mat_Sqrt:  [[0.15]]
grads:  [0.18882643]
Stock Position:  0.18882643481986106
Bond Position:  [-24.50539744]


portfolio before change:  [-4.17261025]
curr_Stock_Price:  107.68788198206148
curr_Factors:  [107.68788198]
mat_Sqrt:  [[0.15]]
grads:  [0.32243765]
Stock Position:  0.3224376482750463
Bond Position:  [-38.89523767]


portfolio before change:  [-4.48335414]
curr_Stock_Price:  106.73168823468134
curr_Factors:  [106.73168823]
mat_Sqrt:  [[0.15]]
grads:  [-0.09509821]
Stock Position:  -0.09509821335564458
Bond Position:  [5.66663872]


portfolio before change:  [-4.37335173]
curr_Stock_Price:  105.57868828254283
curr_Factors:  [105.57868828]
mat_Sqrt:  [[0.15]]
grads:  [-0.02988151]
Stock Position:  -0.029881510635606182
Bond Position:  [-1.21850103]


portfolio before change:  [-4.35791389]
curr_Stock_Price:  105.05950443121897
curr_Factors:  [105.05950443]
mat_Sqrt:  [[0.15]]
grads:  [0.02361688]
Stock Position:  0.023616883818613762
Bond Position:  [-6.839092]


portfolio before change:  [-4.35815295]
curr_Stock_Price:  105.06748160944858
curr_Factors:  [105.06748161]
mat_Sqrt:  [[0.15]]
grads:  [0.02076396]
Stock Position:  0.02076395820529385
Bond Position:  [-6.53976975]


portfolio before change:  [-4.3743506]
curr_Stock_Price:  104.30708225167746
curr_Factors:  [104.30708225]
mat_Sqrt:  [[0.15]]
grads:  [-0.00160108]
Stock Position:  -0.0016010828197586392
Bond Position:  [-4.20734632]


portfolio before change:  [-4.37542621]
curr_Stock_Price:  104.81463942778507
curr_Factors:  [104.81463943]
mat_Sqrt:  [[0.15]]
grads:  [-0.05804645]
Stock Position:  -0.058046447879918465
Bond Position:  [1.70869129]


portfolio before change:  [-4.33551599]
curr_Stock_Price:  104.1289226674167
curr_Factors:  [104.12892267]
mat_Sqrt:  [[0.15]]
grads:  [0.07037656]
Stock Position:  0.07037655506865148
Bond Position:  [-11.66375085]


portfolio before change:  [-4.33514309]
curr_Stock_Price:  104.14457993297621
curr_Factors:  [104.14457993]
mat_Sqrt:  [[0.15]]
grads:  [-0.09103295]
Stock Position:  -0.09103294707957599
Bond Position:  [5.14544494]


portfolio before change:  [-4.38349079]
curr_Stock_Price:  104.67921382445607
curr_Factors:  [104.67921382]
mat_Sqrt:  [[0.15]]
grads:  [-0.05341703]
Stock Position:  -0.05341702716662156
Bond Position:  [1.20816162]


portfolio before change:  [-4.4251143]
curr_Stock_Price:  105.45984536330701
curr_Factors:  [105.45984536]
mat_Sqrt:  [[0.15]]
grads:  [0.12481354]
Stock Position:  0.12481353726385104
Bond Position:  [-17.58793064]


portfolio before change:  [-4.37143655]
curr_Stock_Price:  105.89871625587097
curr_Factors:  [105.89871626]
mat_Sqrt:  [[0.15]]
grads:  [-0.04302623]
Stock Position:  -0.04302623261707194
Bond Position:  [0.18498625]


portfolio before change:  [-4.35157655]
curr_Stock_Price:  105.43740622668491
curr_Factors:  [105.43740623]
mat_Sqrt:  [[0.15]]
grads:  [0.08722747]
Stock Position:  0.08722746896845635
Bond Position:  [-13.54861463]


portfolio before change:  [-4.36284099]
curr_Stock_Price:  105.31797564949731
curr_Factors:  [105.31797565]
mat_Sqrt:  [[0.15]]
grads:  [-0.0955139]
Stock Position:  -0.09551390397902167
Bond Position:  [5.69649002]


portfolio before change:  [-4.46624689]
curr_Stock_Price:  106.40432994055764
curr_Factors:  [106.40432994]
mat_Sqrt:  [[0.15]]
grads:  [-0.08465753]
Stock Position:  -0.08465753278876856
Bond Position:  [4.54168116]


portfolio before change:  [-4.49159261]
curr_Stock_Price:  106.70707415047232
curr_Factors:  [106.70707415]
mat_Sqrt:  [[0.15]]
grads:  [-0.01818815]
Stock Position:  -0.0181881482103972
Bond Position:  [-2.55078853]


portfolio before change:  [-4.47059885]
curr_Stock_Price:  105.54405380302397
curr_Factors:  [105.5440538]
mat_Sqrt:  [[0.15]]
grads:  [0.43747395]
Stock Position:  0.43747394546284757
Bond Position:  [-50.64337249]


portfolio before change:  [-4.28303105]
curr_Stock_Price:  105.980041162879
curr_Factors:  [105.98004116]
mat_Sqrt:  [[0.15]]
grads:  [-0.10082971]
Stock Position:  -0.1008297051738821
Bond Position:  [6.40290526]


portfolio before change:  [-4.29161565]
curr_Stock_Price:  106.06914980335533
curr_Factors:  [106.0691498]
mat_Sqrt:  [[0.15]]
grads:  [0.06364791]
Stock Position:  0.0636479089134838
Bond Position:  [-11.04269524]


portfolio before change:  [-4.30411315]
curr_Stock_Price:  105.88364004175612
curr_Factors:  [105.88364004]
mat_Sqrt:  [[0.15]]
grads:  [0.03521756]
Stock Position:  0.03521755664870625
Bond Position:  [-8.03307624]


portfolio before change:  [-4.27413394]
curr_Stock_Price:  106.74915418865896
curr_Factors:  [106.74915419]
mat_Sqrt:  [[0.15]]
grads:  [0.09538698]
Stock Position:  0.09538698287440436
Bond Position:  [-14.45661368]


portfolio before change:  [-4.34447337]
curr_Stock_Price:  106.02121565532842
curr_Factors:  [106.02121566]
mat_Sqrt:  [[0.15]]
grads:  [-0.17485304]
Stock Position:  -0.17485304197959903
Bond Position:  [14.1936587]


portfolio before change:  [-4.44471174]
curr_Stock_Price:  106.59956132999885
curr_Factors:  [106.59956133]
mat_Sqrt:  [[0.15]]
grads:  [-0.05209995]
Stock Position:  -0.052099948857674806
Bond Position:  [1.10911996]


portfolio before change:  [-4.41092899]
curr_Stock_Price:  105.95246995005115
curr_Factors:  [105.95246995]
mat_Sqrt:  [[0.15]]
grads:  [-0.03946407]
Stock Position:  -0.03946407269790884
Bond Position:  [-0.22961301]


portfolio before change:  [-4.40153435]
curr_Stock_Price:  105.71405087384097
curr_Factors:  [105.71405087]
mat_Sqrt:  [[0.15]]
grads:  [0.06578078]
Stock Position:  0.06578077828005717
Bond Position:  [-11.35548689]


portfolio before change:  [-4.39159795]
curr_Stock_Price:  105.87589355435333
curr_Factors:  [105.87589355]
mat_Sqrt:  [[0.15]]
grads:  [0.03806805]
Stock Position:  0.03806805353648433
Bond Position:  [-8.42208714]


portfolio before change:  [-4.39759294]
curr_Stock_Price:  105.73224051536381
curr_Factors:  [105.73224052]
mat_Sqrt:  [[0.15]]
grads:  [-0.00620169]
Stock Position:  -0.006201693713031442
Bond Position:  [-3.74187397]


portfolio before change:  [-4.39550289]
curr_Stock_Price:  105.35751562591585
curr_Factors:  [105.35751563]
mat_Sqrt:  [[0.15]]
grads:  [-0.00809114]
Stock Position:  -0.00809114087240809
Bond Position:  [-3.54304039]


portfolio before change:  [-4.39840956]
curr_Stock_Price:  105.68938834538434
curr_Factors:  [105.68938835]
mat_Sqrt:  [[0.15]]
grads:  [0.04896642]
Stock Position:  0.04896642282347056
Bond Position:  [-9.57364084]


portfolio before change:  [-4.39481704]
curr_Stock_Price:  105.77497543453435
curr_Factors:  [105.77497543]
mat_Sqrt:  [[0.15]]
grads:  [-0.0214363]
Stock Position:  -0.021436299080697017
Bond Position:  [-2.12739303]


portfolio before change:  [-4.40126724]
curr_Stock_Price:  106.06967319271801
curr_Factors:  [106.06967319]
mat_Sqrt:  [[0.15]]
grads:  [0.14542988]
Stock Position:  0.14542987874921953
Bond Position:  [-19.82696695]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.40126724]
Stock Price:  106.19392545933903
PL:  [-10.59519269]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.93977652e-02]
 [-2.29531963e-03]
 [ 6.84483503e-04]
 [ 2.28860509e-03]
 [ 2.14063565e-02]
 [ 9.24996299e-03]
 [ 6.83297414e-04]
 [ 6.78279396e-03]
 [ 1.38091213e-02]
 [-7.48724929e-04]
 [ 6.36378592e-03]
 [-7.90862585e-03]
 [ 4.11221908e-03]
 [ 6.79418749e-03]
 [-2.32013646e-02]
 [ 1.88460302e-02]
 [-5.30834670e-03]
 [-1.62667023e-02]
 [-4.53233549e-02]
 [ 1.76330079e-02]
 [-7.96200946e-02]
 [-3.95062449e-02]
 [ 2.00933171e-03]
 [-3.68379446e-03]
 [-1.43553502e-02]
 [ 1.49660819e-02]
 [ 2.45148627e-02]
 [ 1.63791633e-01]
 [-2.66565914e-03]
 [ 3.49419793e-02]
 [-3.66058980e-03]
 [-1.09475717e-01]
 [ 3.09281813e-02]
 [ 9.02892233e-03]
 [-5.31702320e-02]
 [ 9.14334724e-03]
 [ 4.04018495e-03]
 [-1.98588513e-02]
 [ 1.02232668e-02]
 [-2.14759064e-02]
 [ 5.59599753e-02]
 [ 2.45914525e-03]
 [ 6.71150505e-03]
 [-8.90299053e-03]
 [ 6.35108671e-04]
 [-8.44287715e-03]
 [-1.35316325e-02]
 [-7.92053067e-04]
 [-5.36255213e-03]
 [ 7.24207173e-03]
 [-3.16781643e-03]
 [ 3.19216346e-03]
 [ 3.09529678e-03]
 [ 2.22942233e-03]
 [ 3.24320457e-03]
 [ 8.97506248e-03]
 [ 1.12948670e-02]
 [ 1.07050431e-03]
 [ 1.35574310e-02]
 [-1.17345623e-03]
 [ 7.94125926e-04]
 [-1.61169609e-02]
 [-1.26764596e-02]
 [-1.09068191e-03]
 [-1.08460805e-02]
 [ 6.64644003e-04]
 [ 1.49795134e-02]
 [ 2.32717318e-03]
 [ 6.83144509e-03]
 [-1.47129035e-02]
 [-5.49086187e-03]
 [-1.16947097e-03]
 [ 1.99925178e-03]
 [ 8.68214043e-03]
 [ 9.70952372e-03]
 [-6.06248446e-03]
 [-5.04544849e-03]
 [-8.93353661e-03]
 [-6.18399174e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.47444897]
curr_Stock_Price:  100.15476384710131
curr_Factors:  [100.15476385]
mat_Sqrt:  [[0.15]]
grads:  [-0.26265177]
Stock Position:  -0.2626517678521314
Bond Position:  [30.78027475]


portfolio before change:  [4.51002865]
curr_Stock_Price:  100.02662516784002
curr_Factors:  [100.02662517]
mat_Sqrt:  [[0.15]]
grads:  [-0.01530213]
Stock Position:  -0.015302130893875202
Bond Position:  [6.04064916]


portfolio before change:  [4.51183305]
curr_Stock_Price:  99.93337969990112
curr_Factors:  [99.9333797]
mat_Sqrt:  [[0.15]]
grads:  [0.00456322]
Stock Position:  0.004563223350444809
Bond Position:  [4.05581472]


portfolio before change:  [4.51464254]
curr_Stock_Price:  100.49350866445195
curr_Factors:  [100.49350866]
mat_Sqrt:  [[0.15]]
grads:  [0.01525737]
Stock Position:  0.01525736723986831
Bond Position:  [2.98137618]


portfolio before change:  [4.50589317]
curr_Stock_Price:  99.90784290701336
curr_Factors:  [99.90784291]
mat_Sqrt:  [[0.15]]
grads:  [0.14270904]
Stock Position:  0.1427090436176037
Bond Position:  [-9.75185954]


portfolio before change:  [4.40327652]
curr_Stock_Price:  99.19305188461102
curr_Factors:  [99.19305188]
mat_Sqrt:  [[0.15]]
grads:  [0.06166642]
Stock Position:  0.061666419916791664
Bond Position:  [-1.71360387]


portfolio before change:  [4.36487042]
curr_Stock_Price:  98.57198464788088
curr_Factors:  [98.57198465]
mat_Sqrt:  [[0.15]]
grads:  [0.00455532]
Stock Position:  0.004555316093260252
Bond Position:  [3.91584387]


portfolio before change:  [4.36429758]
curr_Stock_Price:  98.39250509909945
curr_Factors:  [98.3925051]
mat_Sqrt:  [[0.15]]
grads:  [0.04521863]
Stock Position:  0.04521862639822262
Bond Position:  [-0.08487635]


portfolio before change:  [4.37811557]
curr_Stock_Price:  98.6982043171419
curr_Factors:  [98.69820432]
mat_Sqrt:  [[0.15]]
grads:  [0.09206081]
Stock Position:  0.09206080883160113
Bond Position:  [-4.70812095]


portfolio before change:  [4.35155912]
curr_Stock_Price:  98.41293431758974
curr_Factors:  [98.41293432]
mat_Sqrt:  [[0.15]]
grads:  [-0.0049915]
Stock Position:  -0.004991499523518637
Bond Position:  [4.84278724]


portfolio before change:  [4.35038212]
curr_Stock_Price:  98.70937545209934
curr_Factors:  [98.70937545]
mat_Sqrt:  [[0.15]]
grads:  [0.04242524]
Stock Position:  0.04242523944283028
Bond Position:  [0.16261323]


portfolio before change:  [4.33409246]
curr_Stock_Price:  98.32517426944038
curr_Factors:  [98.32517427]
mat_Sqrt:  [[0.15]]
grads:  [-0.05272417]
Stock Position:  -0.05272417232476895
Bond Position:  [9.51820589]


portfolio before change:  [4.35902968]
curr_Stock_Price:  97.86348243842336
curr_Factors:  [97.86348244]
mat_Sqrt:  [[0.15]]
grads:  [0.02741479]
Stock Position:  0.027414793857577613
Bond Position:  [1.67612248]


portfolio before change:  [4.34309495]
curr_Stock_Price:  97.27841546972904
curr_Factors:  [97.27841547]
mat_Sqrt:  [[0.15]]
grads:  [0.04529458]
Stock Position:  0.04529458324773689
Bond Position:  [-0.06309034]


portfolio before change:  [4.35609411]
curr_Stock_Price:  97.56549398796078
curr_Factors:  [97.56549399]
mat_Sqrt:  [[0.15]]
grads:  [-0.15467576]
Stock Position:  -0.1546757638221844
Bond Position:  [19.44711142]


portfolio before change:  [4.45186146]
curr_Stock_Price:  96.95420319664619
curr_Factors:  [96.9542032]
mat_Sqrt:  [[0.15]]
grads:  [0.1256402]
Stock Position:  0.1256402011162186
Bond Position:  [-7.72948413]


portfolio before change:  [4.38577079]
curr_Stock_Price:  96.43201709666589
curr_Factors:  [96.4320171]
mat_Sqrt:  [[0.15]]
grads:  [-0.03538898]
Stock Position:  -0.035388978022595066
Bond Position:  [7.79840132]


portfolio before change:  [4.40657901]
curr_Stock_Price:  95.8578043377177
curr_Factors:  [95.85780434]
mat_Sqrt:  [[0.15]]
grads:  [-0.10844468]
Stock Position:  -0.10844468188098039
Bond Position:  [14.8018481]


portfolio before change:  [4.39517558]
curr_Stock_Price:  95.97148967331096
curr_Factors:  [95.97148967]
mat_Sqrt:  [[0.15]]
grads:  [-0.3021557]
Stock Position:  -0.3021556990216239
Bond Position:  [33.39350813]


portfolio before change:  [4.46164863]
curr_Stock_Price:  95.7584012370297
curr_Factors:  [95.75840124]
mat_Sqrt:  [[0.15]]
grads:  [0.11755339]
Stock Position:  0.1175533861442103
Bond Position:  [-6.79507569]


portfolio before change:  [4.41396431]
curr_Stock_Price:  95.35637441325892
curr_Factors:  [95.35637441]
mat_Sqrt:  [[0.15]]
grads:  [-0.53080063]
Stock Position:  -0.5308006306167626
Bond Position:  [55.02918798]


portfolio before change:  [4.85571085]
curr_Stock_Price:  94.53062725452992
curr_Factors:  [94.53062725]
mat_Sqrt:  [[0.15]]
grads:  [-0.26337497]
Stock Position:  -0.2633749660074428
Bond Position:  [29.75271159]


portfolio before change:  [4.8176236]
curr_Stock_Price:  94.68230019167063
curr_Factors:  [94.68230019]
mat_Sqrt:  [[0.15]]
grads:  [0.01339554]
Stock Position:  0.013395544762582525
Bond Position:  [3.54930261]


portfolio before change:  [4.81378669]
curr_Stock_Price:  94.37930765372815
curr_Factors:  [94.37930765]
mat_Sqrt:  [[0.15]]
grads:  [-0.02455863]
Stock Position:  -0.02455862970341432
Bond Position:  [7.13161315]


portfolio before change:  [4.82114773]
curr_Stock_Price:  94.09772428779252
curr_Factors:  [94.09772429]
mat_Sqrt:  [[0.15]]
grads:  [-0.09570233]
Stock Position:  -0.09570233456451664
Bond Position:  [13.82651962]


portfolio before change:  [4.87033434]
curr_Stock_Price:  93.59280001382675
curr_Factors:  [93.59280001]
mat_Sqrt:  [[0.15]]
grads:  [0.09977388]
Stock Position:  0.09977387966581486
Bond Position:  [-4.46778242]


portfolio before change:  [4.85277512]
curr_Stock_Price:  93.41960857798834
curr_Factors:  [93.41960858]
mat_Sqrt:  [[0.15]]
grads:  [0.16343242]
Stock Position:  0.16343241828411095
Bond Position:  [-10.41501743]


portfolio before change:  [4.75203576]
curr_Stock_Price:  92.8071939727994
curr_Factors:  [92.80719397]
mat_Sqrt:  [[0.15]]
grads:  [1.09194422]
Stock Position:  1.091944219733505
Bond Position:  [-96.58824325]


portfolio before change:  [3.87182908]
curr_Stock_Price:  92.00663135490133
curr_Factors:  [92.00663135]
mat_Sqrt:  [[0.15]]
grads:  [-0.01777106]
Stock Position:  -0.01777106096400389
Bond Position:  [5.50688454]


portfolio before change:  [3.87186008]
curr_Stock_Price:  92.0242551906607
curr_Factors:  [92.02425519]
mat_Sqrt:  [[0.15]]
grads:  [0.23294653]
Stock Position:  0.23294652856521322
Bond Position:  [-17.56487071]


portfolio before change:  [3.88247105]
curr_Stock_Price:  92.07451914532335
curr_Factors:  [92.07451915]
mat_Sqrt:  [[0.15]]
grads:  [-0.02440393]
Stock Position:  -0.024403931979474842
Bond Position:  [6.12945136]


portfolio before change:  [3.89599931]
curr_Stock_Price:  91.53587008914604
curr_Factors:  [91.53587009]
mat_Sqrt:  [[0.15]]
grads:  [-0.72983811]
Stock Position:  -0.7298381105573294
Bond Position:  [70.70236579]


portfolio before change:  [3.73089142]
curr_Stock_Price:  91.76815026495649
curr_Factors:  [91.76815026]
mat_Sqrt:  [[0.15]]
grads:  [0.20618788]
Stock Position:  0.20618787553992196
Bond Position:  [-15.19058852]


portfolio before change:  [3.72949191]
curr_Stock_Price:  91.76596744364205
curr_Factors:  [91.76596744]
mat_Sqrt:  [[0.15]]
grads:  [0.06019282]
Stock Position:  0.06019281554647635
Bond Position:  [-1.79416004]


portfolio before change:  [3.73988046]
curr_Stock_Price:  91.94041826501218
curr_Factors:  [91.94041827]
mat_Sqrt:  [[0.15]]
grads:  [-0.35446821]
Stock Position:  -0.354468213067355
Bond Position:  [36.32983623]


portfolio before change:  [3.30933966]
curr_Stock_Price:  93.16143461369215
curr_Factors:  [93.16143461]
mat_Sqrt:  [[0.15]]
grads:  [0.06095565]
Stock Position:  0.06095564828712074
Bond Position:  [-2.36937598]


portfolio before change:  [3.2979299]
curr_Stock_Price:  92.97668273196761
curr_Factors:  [92.97668273]
mat_Sqrt:  [[0.15]]
grads:  [0.02693457]
Stock Position:  0.026934566311510335
Bond Position:  [0.79364327]


portfolio before change:  [3.32241932]
curr_Stock_Price:  93.884060193313
curr_Factors:  [93.88406019]
mat_Sqrt:  [[0.15]]
grads:  [-0.13239234]
Stock Position:  -0.1323923417084849
Bond Position:  [15.7519499]


portfolio before change:  [3.25792087]
curr_Stock_Price:  94.37867321449875
curr_Factors:  [94.37867321]
mat_Sqrt:  [[0.15]]
grads:  [0.06815511]
Stock Position:  0.0681551123239098
Bond Position:  [-3.1744682]


portfolio before change:  [3.25866886]
curr_Stock_Price:  94.3925591517746
curr_Factors:  [94.39255915]
mat_Sqrt:  [[0.15]]
grads:  [-0.14317271]
Stock Position:  -0.14317270909782848
Bond Position:  [16.77310727]


portfolio before change:  [3.22661212]
curr_Stock_Price:  94.6237840177254
curr_Factors:  [94.62378402]
mat_Sqrt:  [[0.15]]
grads:  [0.3730665]
Stock Position:  0.3730665020489629
Bond Position:  [-32.07435199]


portfolio before change:  [3.4889053]
curr_Stock_Price:  95.33223112849882
curr_Factors:  [95.33223113]
mat_Sqrt:  [[0.15]]
grads:  [0.0163943]
Stock Position:  0.016394301665867084
Bond Position:  [1.92599994]


portfolio before change:  [3.50913813]
curr_Stock_Price:  96.55902665178486
curr_Factors:  [96.55902665]
mat_Sqrt:  [[0.15]]
grads:  [0.04474337]
Stock Position:  0.044743366974085354
Bond Position:  [-0.81123783]


portfolio before change:  [3.52914904]
curr_Stock_Price:  97.0073973698627
curr_Factors:  [97.00739737]
mat_Sqrt:  [[0.15]]
grads:  [-0.05935327]
Stock Position:  -0.05935327020473963
Bond Position:  [9.28685531]


portfolio before change:  [3.50774869]
curr_Stock_Price:  97.3777358455442
curr_Factors:  [97.37773585]
mat_Sqrt:  [[0.15]]
grads:  [0.00423406]
Stock Position:  0.004234057808303881
Bond Position:  [3.09544573]


portfolio before change:  [3.50561067]
curr_Stock_Price:  96.82708428235864
curr_Factors:  [96.82708428]
mat_Sqrt:  [[0.15]]
grads:  [-0.05628585]
Stock Position:  -0.05628584768123813
Bond Position:  [8.95560519]


portfolio before change:  [3.47807629]
curr_Stock_Price:  97.32621721162974
curr_Factors:  [97.32621721]
mat_Sqrt:  [[0.15]]
grads:  [-0.09021088]
Stock Position:  -0.09021088317225981
Bond Position:  [12.2579603]


portfolio before change:  [3.45678877]
curr_Stock_Price:  97.5706852044359
curr_Factors:  [97.5706852]
mat_Sqrt:  [[0.15]]
grads:  [-0.00528035]
Stock Position:  -0.005280353779765039
Bond Position:  [3.9719965]


portfolio before change:  [3.45572131]
curr_Stock_Price:  97.81985605039041
curr_Factors:  [97.81985605]
mat_Sqrt:  [[0.15]]
grads:  [-0.03575035]
Stock Position:  -0.03575034753120539
Bond Position:  [6.95281516]


portfolio before change:  [3.44274958]
curr_Stock_Price:  98.19485386269831
curr_Factors:  [98.19485386]
mat_Sqrt:  [[0.15]]
grads:  [0.04828048]
Stock Position:  0.04828047819966277
Bond Position:  [-1.29814492]


portfolio before change:  [3.45358953]
curr_Stock_Price:  98.4210547131142
curr_Factors:  [98.42105471]
mat_Sqrt:  [[0.15]]
grads:  [-0.02111878]
Stock Position:  -0.021118776180153242
Bond Position:  [5.53212175]


portfolio before change:  [3.45584588]
curr_Stock_Price:  98.33058612478612
curr_Factors:  [98.33058612]
mat_Sqrt:  [[0.15]]
grads:  [0.02128109]
Stock Position:  0.021281089742653386
Bond Position:  [1.36326385]


portfolio before change:  [3.44992937]
curr_Stock_Price:  98.04856491553417
curr_Factors:  [98.04856492]
mat_Sqrt:  [[0.15]]
grads:  [0.02063531]
Stock Position:  0.020635311856298674
Bond Position:  [1.42666665]


portfolio before change:  [3.44276937]
curr_Stock_Price:  97.69726571342547
curr_Factors:  [97.69726571]
mat_Sqrt:  [[0.15]]
grads:  [0.01486282]
Stock Position:  0.014862815517631172
Bond Position:  [1.99071293]


portfolio before change:  [3.44314593]
curr_Stock_Price:  97.71422977493367
curr_Factors:  [97.71422977]
mat_Sqrt:  [[0.15]]
grads:  [0.02162136]
Stock Position:  0.021621363795166607
Bond Position:  [1.33043102]


portfolio before change:  [3.45033008]
curr_Stock_Price:  98.04265487609864
curr_Factors:  [98.04265488]
mat_Sqrt:  [[0.15]]
grads:  [0.05983375]
Stock Position:  0.05983374984626378
Bond Position:  [-2.41592961]


portfolio before change:  [3.38829167]
curr_Stock_Price:  97.00833210801845
curr_Factors:  [97.00833211]
mat_Sqrt:  [[0.15]]
grads:  [0.07529911]
Stock Position:  0.07529911365376055
Bond Position:  [-3.91634976]


portfolio before change:  [3.41803133]
curr_Stock_Price:  97.40653658025447
curr_Factors:  [97.40653658]
mat_Sqrt:  [[0.15]]
grads:  [0.0071367]
Stock Position:  0.0071366954161520306
Bond Position:  [2.72287055]


portfolio before change:  [3.41562392]
curr_Stock_Price:  97.04536067549826
curr_Factors:  [97.04536068]
mat_Sqrt:  [[0.15]]
grads:  [0.09038287]
Stock Position:  0.09038287348943441
Bond Position:  [-5.35561464]


portfolio before change:  [3.41389662]
curr_Stock_Price:  97.02995332157954
curr_Factors:  [97.02995332]
mat_Sqrt:  [[0.15]]
grads:  [-0.00782304]
Stock Position:  -0.007823041564198573
Bond Position:  [4.17296598]


portfolio before change:  [3.41465248]
curr_Stock_Price:  96.96667269778953
curr_Factors:  [96.9666727]
mat_Sqrt:  [[0.15]]
grads:  [0.00529417]
Stock Position:  0.005294172837669199
Bond Position:  [2.90129416]


portfolio before change:  [3.41830207]
curr_Stock_Price:  97.62177917660615
curr_Factors:  [97.62177918]
mat_Sqrt:  [[0.15]]
grads:  [-0.10744641]
Stock Position:  -0.10744640575282079
Bond Position:  [13.90741136]


portfolio before change:  [3.403233]
curr_Stock_Price:  97.77011642413309
curr_Factors:  [97.77011642]
mat_Sqrt:  [[0.15]]
grads:  [-0.08450973]
Stock Position:  -0.08450973093570806
Bond Position:  [11.66575924]


portfolio before change:  [3.37325842]
curr_Stock_Price:  98.13343216932229
curr_Factors:  [98.13343217]
mat_Sqrt:  [[0.15]]
grads:  [-0.00727121]
Stock Position:  -0.007271212718406384
Bond Position:  [4.08680748]


portfolio before change:  [3.37429233]
curr_Stock_Price:  98.02636879558099
curr_Factors:  [98.0263688]
mat_Sqrt:  [[0.15]]
grads:  [-0.0723072]
Stock Position:  -0.07230720320083019
Bond Position:  [10.4623049]


portfolio before change:  [3.32195374]
curr_Stock_Price:  98.75924889862635
curr_Factors:  [98.7592489]
mat_Sqrt:  [[0.15]]
grads:  [0.00443096]
Stock Position:  0.004430960021080585
Bond Position:  [2.88435545]


portfolio before change:  [3.32581326]
curr_Stock_Price:  99.58959787478479
curr_Factors:  [99.58959787]
mat_Sqrt:  [[0.15]]
grads:  [0.09986342]
Stock Position:  0.09986342246494292
Bond Position:  [-6.61954483]


portfolio before change:  [3.35175154]
curr_Stock_Price:  99.85347845701124
curr_Factors:  [99.85347846]
mat_Sqrt:  [[0.15]]
grads:  [0.01551449]
Stock Position:  0.015514487876616653
Bond Position:  [1.80257596]


portfolio before change:  [3.3473296]
curr_Stock_Price:  99.56119668281124
curr_Factors:  [99.56119668]
mat_Sqrt:  [[0.15]]
grads:  [0.04554297]
Stock Position:  0.04554296725244149
Bond Position:  [-1.18698272]


portfolio before change:  [3.34247512]
curr_Stock_Price:  99.4562342402152
curr_Factors:  [99.45623424]
mat_Sqrt:  [[0.15]]
grads:  [-0.09808602]
Stock Position:  -0.09808602343123679
Bond Position:  [13.09774164]


portfolio before change:  [3.37357398]
curr_Stock_Price:  99.14752324295222
curr_Factors:  [99.14752324]
mat_Sqrt:  [[0.15]]
grads:  [-0.03660575]
Stock Position:  -0.0366057457930626
Bond Position:  [7.00294302]


portfolio before change:  [3.36676847]
curr_Stock_Price:  99.34539408637978
curr_Factors:  [99.34539409]
mat_Sqrt:  [[0.15]]
grads:  [-0.00779647]
Stock Position:  -0.007796473103355535
Bond Position:  [4.14131216]


portfolio before change:  [3.36324763]
curr_Stock_Price:  99.83018732541531
curr_Factors:  [99.83018733]
mat_Sqrt:  [[0.15]]
grads:  [0.01332835]
Stock Position:  0.013328345226725576
Bond Position:  [2.03267643]


portfolio before change:  [3.3711727]
curr_Stock_Price:  100.41525735612797
curr_Factors:  [100.41525736]
mat_Sqrt:  [[0.15]]
grads:  [0.05788094]
Stock Position:  0.05788093621181789
Bond Position:  [-2.44095641]


portfolio before change:  [3.37878173]
curr_Stock_Price:  100.54935335558942
curr_Factors:  [100.54935336]
mat_Sqrt:  [[0.15]]
grads:  [0.06473016]
Stock Position:  0.06473015810345975
Bond Position:  [-3.12979381]


portfolio before change:  [3.30499105]
curr_Stock_Price:  99.41240156439116
curr_Factors:  [99.41240156]
mat_Sqrt:  [[0.15]]
grads:  [-0.04041656]
Stock Position:  -0.040416563068849526
Bond Position:  [7.32289864]


portfolio before change:  [3.31759357]
curr_Stock_Price:  99.11191026943662
curr_Factors:  [99.11191027]
mat_Sqrt:  [[0.15]]
grads:  [-0.03363632]
Stock Position:  -0.03363632325689905
Bond Position:  [6.65135382]


portfolio before change:  [3.32103384]
curr_Stock_Price:  99.0219911680114
curr_Factors:  [99.02199117]
mat_Sqrt:  [[0.15]]
grads:  [-0.05955691]
Stock Position:  -0.05955691075789316
Bond Position:  [9.21847773]


portfolio before change:  [3.32774318]
curr_Stock_Price:  98.9190111771573
curr_Factors:  [98.91901118]
mat_Sqrt:  [[0.15]]
grads:  [-0.04122661]
Stock Position:  -0.041226611579937913
Bond Position:  [7.40583883]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.32774318]
Stock Price:  97.98824050403425
PL:  [3.32774318]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-6.13914394e-02]
 [-1.74384188e-03]
 [ 6.99223131e-04]
 [ 2.58121961e-03]
 [ 3.85417655e-03]
 [ 1.21278429e-02]
 [ 4.03516839e-04]
 [ 1.84993420e-02]
 [-1.96947528e-02]
 [ 5.65298827e-02]
 [ 9.78236713e-03]
 [-1.28290927e-02]
 [ 3.58906130e-02]
 [ 2.72886413e-02]
 [-1.34517245e-02]
 [-6.91450984e-03]
 [ 9.77630093e-03]
 [ 2.61587495e-02]
 [ 8.37407848e-03]
 [-2.66659737e-03]
 [ 2.86505501e-02]
 [-1.00076996e-02]
 [-9.21408886e-03]
 [ 6.55038213e-03]
 [ 1.89160366e-02]
 [ 1.11829199e-02]
 [ 4.85387158e-03]
 [ 9.84585068e-03]
 [ 9.31738282e-03]
 [-9.23321626e-03]
 [-5.79238830e-03]
 [ 4.33877607e-02]
 [ 3.21559341e-03]
 [-8.05477780e-03]
 [-1.89788105e-03]
 [-6.88658508e-03]
 [ 1.57964894e-03]
 [-1.37384611e-02]
 [ 1.06640515e-02]
 [-2.65508767e-03]
 [-7.70805516e-02]
 [-6.37568503e-03]
 [ 2.45237271e-02]
 [-2.15905229e-02]
 [-1.50466394e-02]
 [ 3.97286375e-03]
 [-1.34485883e-02]
 [ 3.65014198e-02]
 [ 6.07471314e-02]
 [-1.69018018e-02]
 [-5.76486636e-03]
 [ 4.22650662e-03]
 [ 3.74701533e-03]
 [-1.26382185e-02]
 [-1.79974974e-02]
 [ 1.50142389e-02]
 [-4.56023496e-02]
 [-1.40224598e-02]
 [ 2.24884366e-02]
 [-1.20803754e-02]
 [ 1.33103625e-02]
 [-1.34747679e-02]
 [-1.26523588e-02]
 [-2.50941168e-03]
 [ 1.21670607e-01]
 [-1.38272707e-02]
 [ 5.92895815e-03]
 [ 5.75945802e-03]
 [ 1.42888795e-02]
 [-2.76834979e-02]
 [-7.81604379e-03]
 [-5.53478898e-03]
 [ 1.27678019e-02]
 [ 4.36420700e-03]
 [-2.45716825e-03]
 [ 4.39238785e-03]
 [ 2.68256736e-03]
 [-2.41609279e-03]
 [ 1.93177143e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.78569229]
curr_Stock_Price:  100.56039161825676
curr_Factors:  [100.56039162]
mat_Sqrt:  [[0.15]]
grads:  [-0.40927626]
Stock Position:  -0.40927626269299217
Bond Position:  [51.94267355]


portfolio before change:  [11.04976237]
curr_Stock_Price:  99.92311165097097
curr_Factors:  [99.92311165]
mat_Sqrt:  [[0.15]]
grads:  [-0.01162561]
Stock Position:  -0.011625612534774536
Bond Position:  [12.21142975]


portfolio before change:  [11.04157692]
curr_Stock_Price:  100.69285106078397
curr_Factors:  [100.69285106]
mat_Sqrt:  [[0.15]]
grads:  [0.00466149]
Stock Position:  0.0046614875424606855
Bond Position:  [10.57219845]


portfolio before change:  [11.04374974]
curr_Stock_Price:  101.01721928810623
curr_Factors:  [101.01721929]
mat_Sqrt:  [[0.15]]
grads:  [0.01720813]
Stock Position:  0.017208130710742623
Bond Position:  [9.30543223]


portfolio before change:  [11.05829738]
curr_Stock_Price:  101.82881446171292
curr_Factors:  [101.82881446]
mat_Sqrt:  [[0.15]]
grads:  [0.02569451]
Stock Position:  0.02569451034706694
Bond Position:  [8.44185586]


portfolio before change:  [11.05270053]
curr_Stock_Price:  101.59045647496474
curr_Factors:  [101.59045647]
mat_Sqrt:  [[0.15]]
grads:  [0.08085229]
Stock Position:  0.0808522863124367
Bond Position:  [2.83887985]


portfolio before change:  [11.01078413]
curr_Stock_Price:  101.06983009666014
curr_Factors:  [101.0698301]
mat_Sqrt:  [[0.15]]
grads:  [0.00269011]
Stock Position:  0.002690112259748495
Bond Position:  [10.73889494]


portfolio before change:  [11.01576616]
curr_Stock_Price:  102.67230205519785
curr_Factors:  [102.67230206]
mat_Sqrt:  [[0.15]]
grads:  [0.12332895]
Stock Position:  0.12332894699206766
Bond Position:  [-1.64670074]


portfolio before change:  [11.09380174]
curr_Stock_Price:  103.3058800427734
curr_Factors:  [103.30588004]
mat_Sqrt:  [[0.15]]
grads:  [-0.13129835]
Stock Position:  -0.13129835198058265
Bond Position:  [24.65769354]


portfolio before change:  [11.03884477]
curr_Stock_Price:  103.73618341023735
curr_Factors:  [103.73618341]
mat_Sqrt:  [[0.15]]
grads:  [0.37686588]
Stock Position:  0.3768658846404243
Bond Position:  [-28.05578376]


portfolio before change:  [11.00902874]
curr_Stock_Price:  103.66172059531206
curr_Factors:  [103.6617206]
mat_Sqrt:  [[0.15]]
grads:  [0.06521578]
Stock Position:  0.06521578088075888
Bond Position:  [4.24864868]


portfolio before change:  [10.96805191]
curr_Stock_Price:  103.02932187364064
curr_Factors:  [103.02932187]
mat_Sqrt:  [[0.15]]
grads:  [-0.08552728]
Stock Position:  -0.08552728438338028
Bond Position:  [19.77987002]


portfolio before change:  [10.94759877]
curr_Stock_Price:  103.28291843988328
curr_Factors:  [103.28291844]
mat_Sqrt:  [[0.15]]
grads:  [0.23927075]
Stock Position:  0.2392707536574872
Bond Position:  [-13.76498297]


portfolio before change:  [11.05124967]
curr_Stock_Price:  103.71970915977951
curr_Factors:  [103.71970916]
mat_Sqrt:  [[0.15]]
grads:  [0.18192428]
Stock Position:  0.18192427515209225
Bond Position:  [-7.81788324]


portfolio before change:  [11.11949472]
curr_Stock_Price:  104.09752393510207
curr_Factors:  [104.09752394]
mat_Sqrt:  [[0.15]]
grads:  [-0.08967816]
Stock Position:  -0.08967816310555562
Bond Position:  [20.45476945]


portfolio before change:  [11.15468654]
curr_Stock_Price:  103.7193565439573
curr_Factors:  [103.71935654]
mat_Sqrt:  [[0.15]]
grads:  [-0.04609673]
Stock Position:  -0.046096732245975436
Bond Position:  [15.93580995]


portfolio before change:  [11.20439003]
curr_Stock_Price:  102.66272039943128
curr_Factors:  [102.6627204]
mat_Sqrt:  [[0.15]]
grads:  [0.06517534]
Stock Position:  0.06517533950796332
Bond Position:  [4.51331237]


portfolio before change:  [11.22240801]
curr_Stock_Price:  102.93484622715447
curr_Factors:  [102.93484623]
mat_Sqrt:  [[0.15]]
grads:  [0.17439166]
Stock Position:  0.17439166308557946
Bond Position:  [-6.72857101]


portfolio before change:  [11.1966944]
curr_Stock_Price:  102.78981023457523
curr_Factors:  [102.78981023]
mat_Sqrt:  [[0.15]]
grads:  [0.05582719]
Stock Position:  0.05582718989132748
Bond Position:  [5.45822814]


portfolio before change:  [11.21658996]
curr_Stock_Price:  103.14007705384672
curr_Factors:  [103.14007705]
mat_Sqrt:  [[0.15]]
grads:  [-0.01777732]
Stock Position:  -0.0177773157723637
Bond Position:  [13.05014368]


portfolio before change:  [11.21572923]
curr_Stock_Price:  103.23437642896914
curr_Factors:  [103.23437643]
mat_Sqrt:  [[0.15]]
grads:  [0.19100367]
Stock Position:  0.1910036670501218
Bond Position:  [-8.50241523]


portfolio before change:  [11.34862872]
curr_Stock_Price:  103.93295415786801
curr_Factors:  [103.93295416]
mat_Sqrt:  [[0.15]]
grads:  [-0.066718]
Stock Position:  -0.06671799759767029
Bond Position:  [18.28282731]


portfolio before change:  [11.28464877]
curr_Stock_Price:  104.9090424750326
curr_Factors:  [104.90904248]
mat_Sqrt:  [[0.15]]
grads:  [-0.06142726]
Stock Position:  -0.06142725903658719
Bond Position:  [17.7289237]


portfolio before change:  [11.28900955]
curr_Stock_Price:  104.8560906275187
curr_Factors:  [104.85609063]
mat_Sqrt:  [[0.15]]
grads:  [0.04366921]
Stock Position:  0.04366921417411489
Bond Position:  [6.71002647]


portfolio before change:  [11.284066]
curr_Stock_Price:  104.73328230111133
curr_Factors:  [104.7332823]
mat_Sqrt:  [[0.15]]
grads:  [0.12610691]
Stock Position:  0.12610691064619065
Bond Position:  [-1.92352467]


portfolio before change:  [11.38872093]
curr_Stock_Price:  105.56412619125089
curr_Factors:  [105.56412619]
mat_Sqrt:  [[0.15]]
grads:  [0.0745528]
Stock Position:  0.07455279927692376
Bond Position:  [3.51861982]


portfolio before change:  [11.41691265]
curr_Stock_Price:  105.93932059271016
curr_Factors:  [105.93932059]
mat_Sqrt:  [[0.15]]
grads:  [0.03235914]
Stock Position:  0.03235914389141397
Bond Position:  [7.98880693]


portfolio before change:  [11.40289498]
curr_Stock_Price:  105.49070000646907
curr_Factors:  [105.49070001]
mat_Sqrt:  [[0.15]]
grads:  [0.065639]
Stock Position:  0.06563900454950536
Bond Position:  [4.47859045]


portfolio before change:  [11.35700062]
curr_Stock_Price:  104.7872419649565
curr_Factors:  [104.78724196]
mat_Sqrt:  [[0.15]]
grads:  [0.06211589]
Stock Position:  0.062115885434330366
Bond Position:  [4.8480483]


portfolio before change:  [11.35139363]
curr_Stock_Price:  104.69209716604477
curr_Factors:  [104.69209717]
mat_Sqrt:  [[0.15]]
grads:  [-0.06155478]
Stock Position:  -0.06155477508057179
Bond Position:  [17.79569212]


portfolio before change:  [11.35416449]
curr_Stock_Price:  104.66515212427845
curr_Factors:  [104.66515212]
mat_Sqrt:  [[0.15]]
grads:  [-0.03861592]
Stock Position:  -0.038615921969043544
Bond Position:  [15.39590584]


portfolio before change:  [11.3500725]
curr_Stock_Price:  104.7960375602088
curr_Factors:  [104.79603756]
mat_Sqrt:  [[0.15]]
grads:  [0.28925174]
Stock Position:  0.289251738285536
Bond Position:  [-18.96236353]


portfolio before change:  [11.38867532]
curr_Stock_Price:  104.93359249225817
curr_Factors:  [104.93359249]
mat_Sqrt:  [[0.15]]
grads:  [0.02143729]
Stock Position:  0.02143728940940571
Bond Position:  [9.13918353]


portfolio before change:  [11.38329979]
curr_Stock_Price:  104.65619058205826
curr_Factors:  [104.65619058]
mat_Sqrt:  [[0.15]]
grads:  [-0.05369852]
Stock Position:  -0.05369851863367518
Bond Position:  [17.00318219]


portfolio before change:  [11.32997244]
curr_Stock_Price:  105.66906920207722
curr_Factors:  [105.6690692]
mat_Sqrt:  [[0.15]]
grads:  [-0.01265254]
Stock Position:  -0.012652540342030309
Bond Position:  [12.6669546]


portfolio before change:  [11.32434569]
curr_Stock_Price:  106.17635588776407
curr_Factors:  [106.17635589]
mat_Sqrt:  [[0.15]]
grads:  [-0.04591057]
Stock Position:  -0.0459105672084941
Bond Position:  [16.19896241]


portfolio before change:  [11.2775713]
curr_Stock_Price:  107.21722412708425
curr_Factors:  [107.21722413]
mat_Sqrt:  [[0.15]]
grads:  [0.01053099]
Stock Position:  0.01053099295357222
Bond Position:  [10.14846747]


portfolio before change:  [11.28943912]
curr_Stock_Price:  108.28393424519578
curr_Factors:  [108.28393425]
mat_Sqrt:  [[0.15]]
grads:  [-0.09158974]
Stock Position:  -0.09158974093199393
Bond Position:  [21.2071366]


portfolio before change:  [11.30524219]
curr_Stock_Price:  108.12586430153881
curr_Factors:  [108.1258643]
mat_Sqrt:  [[0.15]]
grads:  [0.07109368]
Stock Position:  0.0710936769990161
Bond Position:  [3.61817692]


portfolio before change:  [11.30233592]
curr_Stock_Price:  108.08180391014645
curr_Factors:  [108.08180391]
mat_Sqrt:  [[0.15]]
grads:  [-0.01770058]
Stock Position:  -0.017700584486522973
Bond Position:  [13.21544702]


portfolio before change:  [11.29005743]
curr_Stock_Price:  108.82214568988461
curr_Factors:  [108.82214569]
mat_Sqrt:  [[0.15]]
grads:  [-0.51387034]
Stock Position:  -0.5138703439477743
Bond Position:  [67.21053086]


portfolio before change:  [11.40664909]
curr_Stock_Price:  108.60343123386248
curr_Factors:  [108.60343123]
mat_Sqrt:  [[0.15]]
grads:  [-0.04250457]
Stock Position:  -0.042504566840329126
Bond Position:  [16.02279089]


portfolio before change:  [11.40775656]
curr_Stock_Price:  108.60093698740224
curr_Factors:  [108.60093699]
mat_Sqrt:  [[0.15]]
grads:  [0.16349151]
Stock Position:  0.16349151408342338
Bond Position:  [-6.34757506]


portfolio before change:  [11.4606192]
curr_Stock_Price:  108.92669926636871
curr_Factors:  [108.92669927]
mat_Sqrt:  [[0.15]]
grads:  [-0.14393682]
Stock Position:  -0.14393681908981865
Bond Position:  [27.1391818]


portfolio before change:  [11.44919756]
curr_Stock_Price:  109.01783565820564
curr_Factors:  [109.01783566]
mat_Sqrt:  [[0.15]]
grads:  [-0.10031093]
Stock Position:  -0.10031092920314012
Bond Position:  [22.38487796]


portfolio before change:  [11.44563495]
curr_Stock_Price:  109.06729899814678
curr_Factors:  [109.067299]
mat_Sqrt:  [[0.15]]
grads:  [0.02648576]
Stock Position:  0.026485758356350402
Bond Position:  [8.55690482]


portfolio before change:  [11.42764463]
curr_Stock_Price:  108.3678611109803
curr_Factors:  [108.36786111]
mat_Sqrt:  [[0.15]]
grads:  [-0.08965726]
Stock Position:  -0.08965725533407333
Bond Position:  [21.14360962]


portfolio before change:  [11.39931588]
curr_Stock_Price:  108.6985679605216
curr_Factors:  [108.69856796]
mat_Sqrt:  [[0.15]]
grads:  [0.2433428]
Stock Position:  0.24334279891107444
Bond Position:  [-15.05169789]


portfolio before change:  [11.43932256]
curr_Stock_Price:  108.86683857663456
curr_Factors:  [108.86683858]
mat_Sqrt:  [[0.15]]
grads:  [0.40498088]
Stock Position:  0.40498087612421735
Bond Position:  [-32.64966511]


portfolio before change:  [11.41107503]
curr_Stock_Price:  108.80212722394135
curr_Factors:  [108.80212722]
mat_Sqrt:  [[0.15]]
grads:  [-0.11267868]
Stock Position:  -0.11267867891833631
Bond Position:  [23.67075499]


portfolio before change:  [11.38123441]
curr_Stock_Price:  109.08008657351981
curr_Factors:  [109.08008657]
mat_Sqrt:  [[0.15]]
grads:  [-0.03843244]
Stock Position:  -0.03843244240218462
Bond Position:  [15.57344855]


portfolio before change:  [11.36400855]
curr_Stock_Price:  109.55362480695882
curr_Factors:  [109.55362481]
mat_Sqrt:  [[0.15]]
grads:  [0.02817671]
Stock Position:  0.02817671082255539
Bond Position:  [8.27714774]


portfolio before change:  [11.37796454]
curr_Stock_Price:  110.03056655115644
curr_Factors:  [110.03056655]
mat_Sqrt:  [[0.15]]
grads:  [0.0249801]
Stock Position:  0.024980102202707775
Bond Position:  [8.62938974]


portfolio before change:  [11.37343535]
curr_Stock_Price:  109.82766337884806
curr_Factors:  [109.82766338]
mat_Sqrt:  [[0.15]]
grads:  [-0.08425479]
Stock Position:  -0.08425479003398736
Bond Position:  [20.62694207]


portfolio before change:  [11.37715204]
curr_Stock_Price:  109.79885233062367
curr_Factors:  [109.79885233]
mat_Sqrt:  [[0.15]]
grads:  [-0.11998332]
Stock Position:  -0.11998331627872043
Bond Position:  [24.55118247]


portfolio before change:  [11.3803596]
curr_Stock_Price:  109.78490821151387
curr_Factors:  [109.78490821]
mat_Sqrt:  [[0.15]]
grads:  [0.10009493]
Stock Position:  0.10009492601341229
Bond Position:  [0.39144733]


portfolio before change:  [11.26882171]
curr_Stock_Price:  108.6703426326635
curr_Factors:  [108.67034263]
mat_Sqrt:  [[0.15]]
grads:  [-0.30401566]
Stock Position:  -0.3040156642751256
Bond Position:  [44.30630811]


portfolio before change:  [11.29841081]
curr_Stock_Price:  108.58212391804842
curr_Factors:  [108.58212392]
mat_Sqrt:  [[0.15]]
grads:  [-0.09348307]
Stock Position:  -0.09348306517493703
Bond Position:  [21.44900058]


portfolio before change:  [11.3710798]
curr_Stock_Price:  107.81911530515191
curr_Factors:  [107.81911531]
mat_Sqrt:  [[0.15]]
grads:  [0.14992291]
Stock Position:  0.14992291047431314
Bond Position:  [-4.79347577]


portfolio before change:  [11.36292533]
curr_Stock_Price:  107.7667225858955
curr_Factors:  [107.76672259]
mat_Sqrt:  [[0.15]]
grads:  [-0.08053584]
Stock Position:  -0.0805358360290972
Bond Position:  [20.04200843]


portfolio before change:  [11.34871766]
curr_Stock_Price:  107.95869098658949
curr_Factors:  [107.95869099]
mat_Sqrt:  [[0.15]]
grads:  [0.08873575]
Stock Position:  0.088735749839761
Bond Position:  [1.76892226]


portfolio before change:  [11.28391378]
curr_Stock_Price:  107.2271432157919
curr_Factors:  [107.22714322]
mat_Sqrt:  [[0.15]]
grads:  [-0.08983179]
Stock Position:  -0.08983178568337233
Bond Position:  [20.91631953]


portfolio before change:  [11.212291]
curr_Stock_Price:  108.03899492037262
curr_Factors:  [108.03899492]
mat_Sqrt:  [[0.15]]
grads:  [-0.08434906]
Stock Position:  -0.08434905873860252
Bond Position:  [20.32527853]


portfolio before change:  [11.25308846]
curr_Stock_Price:  107.57038164643076
curr_Factors:  [107.57038165]
mat_Sqrt:  [[0.15]]
grads:  [-0.01672941]
Stock Position:  -0.016729411216278817
Bond Position:  [13.05267761]


portfolio before change:  [11.25606431]
curr_Stock_Price:  107.44126547474686
curr_Factors:  [107.44126547]
mat_Sqrt:  [[0.15]]
grads:  [0.81113738]
Stock Position:  0.8111373790117921
Bond Position:  [-75.89356216]


portfolio before change:  [10.80932155]
curr_Stock_Price:  106.89635251816644
curr_Factors:  [106.89635252]
mat_Sqrt:  [[0.15]]
grads:  [-0.0921818]
Stock Position:  -0.09218180477246345
Bond Position:  [20.66322025]


portfolio before change:  [10.82056059]
curr_Stock_Price:  106.78844025583228
curr_Factors:  [106.78844026]
mat_Sqrt:  [[0.15]]
grads:  [0.03952639]
Stock Position:  0.03952638768313969
Bond Position:  [6.5995993]


portfolio before change:  [10.81036188]
curr_Stock_Price:  106.51998184459865
curr_Factors:  [106.51998184]
mat_Sqrt:  [[0.15]]
grads:  [0.03839639]
Stock Position:  0.038396386813260734
Bond Position:  [6.72037946]


portfolio before change:  [10.81906456]
curr_Stock_Price:  106.73569575158088
curr_Factors:  [106.73569575]
mat_Sqrt:  [[0.15]]
grads:  [0.0952592]
Stock Position:  0.09525919687605243
Bond Position:  [0.6515079]


portfolio before change:  [10.80672627]
curr_Stock_Price:  106.60574497571811
curr_Factors:  [106.60574498]
mat_Sqrt:  [[0.15]]
grads:  [-0.18455665]
Stock Position:  -0.18455665291575576
Bond Position:  [30.48152574]


portfolio before change:  [10.81168437]
curr_Stock_Price:  106.58920295047076
curr_Factors:  [106.58920295]
mat_Sqrt:  [[0.15]]
grads:  [-0.05210696]
Stock Position:  -0.0521069586279868
Bond Position:  [16.36572355]


portfolio before change:  [10.81296793]
curr_Stock_Price:  106.58420026994449
curr_Factors:  [106.58420027]
mat_Sqrt:  [[0.15]]
grads:  [-0.03689859]
Stock Position:  -0.03689859316721275
Bond Position:  [14.74577497]


portfolio before change:  [10.80844149]
curr_Stock_Price:  106.73185037256712
curr_Factors:  [106.73185037]
mat_Sqrt:  [[0.15]]
grads:  [0.08511868]
Stock Position:  0.08511867932154835
Bond Position:  [1.72356734]


portfolio before change:  [10.87688435]
curr_Stock_Price:  107.53467219879589
curr_Factors:  [107.5346722]
mat_Sqrt:  [[0.15]]
grads:  [0.02909471]
Stock Position:  0.029094713344863736
Bond Position:  [7.74819389]


portfolio before change:  [10.89187668]
curr_Stock_Price:  108.03332131036294
curr_Factors:  [108.03332131]
mat_Sqrt:  [[0.15]]
grads:  [-0.01638112]
Stock Position:  -0.016381121670201258
Bond Position:  [12.66158366]


portfolio before change:  [10.90235217]
curr_Stock_Price:  107.44214611720595
curr_Factors:  [107.44214612]
mat_Sqrt:  [[0.15]]
grads:  [0.02928259]
Stock Position:  0.029282585676136723
Bond Position:  [7.75616832]


portfolio before change:  [10.91885954]
curr_Stock_Price:  107.98931763963007
curr_Factors:  [107.98931764]
mat_Sqrt:  [[0.15]]
grads:  [0.01788378]
Stock Position:  0.01788378238360326
Bond Position:  [8.98760208]


portfolio before change:  [10.91923583]
curr_Stock_Price:  107.97894807856977
curr_Factors:  [107.97894808]
mat_Sqrt:  [[0.15]]
grads:  [-0.01610729]
Stock Position:  -0.01610728525394356
Bond Position:  [12.65848355]


portfolio before change:  [10.92425033]
curr_Stock_Price:  107.7167491398455
curr_Factors:  [107.71674914]
mat_Sqrt:  [[0.15]]
grads:  [0.12878476]
Stock Position:  0.1287847622497374
Bond Position:  [-2.9480256]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.92425033]
Stock Price:  106.48395193000967
PL:  [4.4402984]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-5.92271674e-02]
 [ 1.61655470e-03]
 [ 6.78946861e-04]
 [ 2.15745242e-03]
 [ 1.56052483e-02]
 [ 1.10719975e-02]
 [ 4.27169189e-04]
 [ 9.78633861e-03]
 [ 8.81951897e-03]
 [ 3.11838672e-02]
 [ 6.87617470e-03]
 [-1.08485856e-02]
 [ 9.20720349e-03]
 [ 5.74726736e-03]
 [-1.37457615e-02]
 [ 1.36140900e-02]
 [-1.96091553e-03]
 [ 7.01045397e-03]
 [ 2.00286595e-02]
 [ 1.15720830e-02]
 [ 3.57226081e-03]
 [-2.32388437e-02]
 [ 7.16643749e-04]
 [ 5.53295847e-03]
 [-2.24752645e-03]
 [ 1.52020069e-02]
 [ 1.54028175e-02]
 [ 4.76391416e-03]
 [ 4.84869513e-04]
 [ 4.33705784e-03]
 [-3.42239618e-03]
 [-2.98455002e-02]
 [ 2.14777561e-02]
 [ 1.07172042e-02]
 [-2.89274861e-02]
 [ 8.14289871e-03]
 [-1.27502769e-03]
 [-5.50778990e-03]
 [ 6.00515922e-03]
 [-1.81962065e-02]
 [ 4.10055523e-02]
 [ 5.17925401e-04]
 [ 5.71946401e-03]
 [-8.35801710e-03]
 [ 1.31954832e-03]
 [-7.19536061e-03]
 [-1.34603318e-02]
 [-2.99565424e-04]
 [-4.26223223e-03]
 [ 6.91002977e-04]
 [-3.69393812e-03]
 [ 2.97348328e-03]
 [ 3.56172200e-03]
 [ 1.52185984e-05]
 [ 1.03590567e-02]
 [ 8.85319395e-03]
 [ 3.80432118e-03]
 [ 1.44323907e-02]
 [ 1.29459535e-02]
 [-1.08271952e-02]
 [-1.25757182e-02]
 [-3.71620157e-02]
 [-1.30296294e-02]
 [-4.72583193e-03]
 [-9.02168192e-04]
 [ 8.25691138e-02]
 [ 8.66807569e-03]
 [ 1.64363551e-03]
 [ 1.67671807e-02]
 [-1.92863273e-02]
 [ 2.91269595e-02]
 [-3.66947203e-02]
 [-9.26414810e-03]
 [ 8.17547157e-03]
 [-1.58234263e-02]
 [ 4.45398373e-03]
 [ 2.32989888e-02]
 [-1.73919488e-02]
 [-5.75673903e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.26988913]
curr_Stock_Price:  100.52724060858623
curr_Factors:  [100.52724061]
mat_Sqrt:  [[0.15]]
grads:  [-0.39484778]
Stock Position:  -0.3948477824626045
Bond Position:  [49.96284716]


portfolio before change:  [10.67140839]
curr_Stock_Price:  99.51825307814968
curr_Factors:  [99.51825308]
mat_Sqrt:  [[0.15]]
grads:  [0.01077703]
Stock Position:  0.01077703130031562
Bond Position:  [9.59889706]


portfolio before change:  [10.67651352]
curr_Stock_Price:  99.9362884536513
curr_Factors:  [99.93628845]
mat_Sqrt:  [[0.15]]
grads:  [0.00452631]
Stock Position:  0.00452631240686894
Bond Position:  [10.22417066]


portfolio before change:  [10.677163]
curr_Stock_Price:  99.93859793010841
curr_Factors:  [99.93859793]
mat_Sqrt:  [[0.15]]
grads:  [0.01438302]
Stock Position:  0.014383016153794656
Bond Position:  [9.23974454]


portfolio before change:  [10.68096977]
curr_Stock_Price:  100.16311695489345
curr_Factors:  [100.16311695]
mat_Sqrt:  [[0.15]]
grads:  [0.10403499]
Stock Position:  0.1040349888465336
Bond Position:  [0.26050101]


portfolio before change:  [10.61959824]
curr_Stock_Price:  99.573048043024
curr_Factors:  [99.57304804]
mat_Sqrt:  [[0.15]]
grads:  [0.07381332]
Stock Position:  0.07381331637298856
Bond Position:  [3.26978134]


portfolio before change:  [10.5641806]
curr_Stock_Price:  98.81949834702404
curr_Factors:  [98.81949835]
mat_Sqrt:  [[0.15]]
grads:  [0.00284779]
Stock Position:  0.0028477945919564507
Bond Position:  [10.28276297]


portfolio before change:  [10.56409024]
curr_Stock_Price:  98.5620882348555
curr_Factors:  [98.56208823]
mat_Sqrt:  [[0.15]]
grads:  [0.06524226]
Stock Position:  0.06524225740805349
Bond Position:  [4.13367711]


portfolio before change:  [10.54011215]
curr_Stock_Price:  98.1906041743549
curr_Factors:  [98.19060417]
mat_Sqrt:  [[0.15]]
grads:  [0.05879679]
Stock Position:  0.05879679312692953
Bond Position:  [4.76681951]


portfolio before change:  [10.49642932]
curr_Stock_Price:  97.44259129235434
curr_Factors:  [97.44259129]
mat_Sqrt:  [[0.15]]
grads:  [0.20789245]
Stock Position:  0.20789244821359998
Bond Position:  [-9.76114954]


portfolio before change:  [10.70656987]
curr_Stock_Price:  98.4563397055205
curr_Factors:  [98.45633971]
mat_Sqrt:  [[0.15]]
grads:  [0.04584116]
Stock Position:  0.04584116469359776
Bond Position:  [6.19321659]


portfolio before change:  [10.65792622]
curr_Stock_Price:  97.38676092421571
curr_Factors:  [97.38676092]
mat_Sqrt:  [[0.15]]
grads:  [-0.0723239]
Stock Position:  -0.07232390417008466
Bond Position:  [17.70131699]


portfolio before change:  [10.6613486]
curr_Stock_Price:  97.35473825933012
curr_Factors:  [97.35473826]
mat_Sqrt:  [[0.15]]
grads:  [0.06138136]
Stock Position:  0.0613813566065955
Bond Position:  [4.68558269]


portfolio before change:  [10.6807408]
curr_Stock_Price:  97.6658970281443
curr_Factors:  [97.66589703]
mat_Sqrt:  [[0.15]]
grads:  [0.03831512]
Stock Position:  0.038315115761828916
Bond Position:  [6.93866065]


portfolio before change:  [10.70181881]
curr_Stock_Price:  98.20470070353566
curr_Factors:  [98.2047007]
mat_Sqrt:  [[0.15]]
grads:  [-0.09163841]
Stock Position:  -0.09163841011208795
Bond Position:  [19.70114144]


portfolio before change:  [10.64482439]
curr_Stock_Price:  98.84008682980435
curr_Factors:  [98.84008683]
mat_Sqrt:  [[0.15]]
grads:  [0.0907606]
Stock Position:  0.09076059989071641
Bond Position:  [1.67403882]


portfolio before change:  [10.62665335]
curr_Stock_Price:  98.63872547948303
curr_Factors:  [98.63872548]
mat_Sqrt:  [[0.15]]
grads:  [-0.01307277]
Stock Position:  -0.013072770207703688
Bond Position:  [11.91613474]


portfolio before change:  [10.61739874]
curr_Stock_Price:  99.40362752044801
curr_Factors:  [99.40362752]
mat_Sqrt:  [[0.15]]
grads:  [0.04673636]
Stock Position:  0.04673635982005503
Bond Position:  [5.97163503]


portfolio before change:  [10.60499926]
curr_Stock_Price:  99.13033467906402
curr_Factors:  [99.13033468]
mat_Sqrt:  [[0.15]]
grads:  [0.1335244]
Stock Position:  0.13352439683305628
Bond Position:  [-2.63131888]


portfolio before change:  [10.58799398]
curr_Stock_Price:  99.00420921493813
curr_Factors:  [99.00420921]
mat_Sqrt:  [[0.15]]
grads:  [0.07714722]
Stock Position:  0.07714722002322291
Bond Position:  [2.95009446]


portfolio before change:  [10.50952128]
curr_Stock_Price:  97.98463805645628
curr_Factors:  [97.98463806]
mat_Sqrt:  [[0.15]]
grads:  [0.02381507]
Stock Position:  0.023815072086563104
Bond Position:  [8.17601006]


portfolio before change:  [10.50405032]
curr_Stock_Price:  97.73345355888064
curr_Factors:  [97.73345356]
mat_Sqrt:  [[0.15]]
grads:  [-0.15492562]
Stock Position:  -0.15492562487218198
Bond Position:  [25.64546668]


portfolio before change:  [10.62110286]
curr_Stock_Price:  96.98825954931623
curr_Factors:  [96.98825955]
mat_Sqrt:  [[0.15]]
grads:  [0.00477762]
Stock Position:  0.0047776249928504644
Bond Position:  [10.15772933]


portfolio before change:  [10.62378869]
curr_Stock_Price:  97.41754127540537
curr_Factors:  [97.41754128]
mat_Sqrt:  [[0.15]]
grads:  [0.03688639]
Stock Position:  0.036886389809569896
Bond Position:  [7.03040728]


portfolio before change:  [10.61846735]
curr_Stock_Price:  97.26136585421483
curr_Factors:  [97.26136585]
mat_Sqrt:  [[0.15]]
grads:  [-0.01498351]
Stock Position:  -0.014983509633888082
Bond Position:  [12.07578396]


portfolio before change:  [10.61374679]
curr_Stock_Price:  97.62678892402799
curr_Factors:  [97.62678892]
mat_Sqrt:  [[0.15]]
grads:  [0.10134671]
Stock Position:  0.10134671275171502
Bond Position:  [0.71959266]


portfolio before change:  [10.59114572]
curr_Stock_Price:  97.40333773032877
curr_Factors:  [97.40333773]
mat_Sqrt:  [[0.15]]
grads:  [0.10268545]
Stock Position:  0.10268545030004535
Bond Position:  [0.58924013]


portfolio before change:  [10.54746137]
curr_Stock_Price:  96.97755991070277
curr_Factors:  [96.97755991]
mat_Sqrt:  [[0.15]]
grads:  [0.03175943]
Stock Position:  0.0317594277165974
Bond Position:  [7.46750956]


portfolio before change:  [10.5377271]
curr_Stock_Price:  96.65636405514118
curr_Factors:  [96.65636406]
mat_Sqrt:  [[0.15]]
grads:  [0.00323246]
Stock Position:  0.003232463422693078
Bond Position:  [10.22528894]


portfolio before change:  [10.53789593]
curr_Stock_Price:  96.51087890345562
curr_Factors:  [96.5108789]
mat_Sqrt:  [[0.15]]
grads:  [0.02891372]
Stock Position:  0.028913718957193878
Bond Position:  [7.7474075]


portfolio before change:  [10.54382925]
curr_Stock_Price:  96.69933944280314
curr_Factors:  [96.69933944]
mat_Sqrt:  [[0.15]]
grads:  [-0.02281597]
Stock Position:  -0.022815974533937022
Bond Position:  [12.75011892]


portfolio before change:  [10.5504315]
curr_Stock_Price:  96.44489738526974
curr_Factors:  [96.44489739]
mat_Sqrt:  [[0.15]]
grads:  [-0.19897]
Stock Position:  -0.19897000165623152
Bond Position:  [29.74007289]


portfolio before change:  [10.57602425]
curr_Stock_Price:  96.32561341000724
curr_Factors:  [96.32561341]
mat_Sqrt:  [[0.15]]
grads:  [0.14318504]
Stock Position:  0.14318504039783683
Bond Position:  [-3.2163626]


portfolio before change:  [10.61406269]
curr_Stock_Price:  96.59267672855802
curr_Factors:  [96.59267673]
mat_Sqrt:  [[0.15]]
grads:  [0.07144803]
Stock Position:  0.07144802780049524
Bond Position:  [3.71270644]


portfolio before change:  [10.60202835]
curr_Stock_Price:  96.42099393334064
curr_Factors:  [96.42099393]
mat_Sqrt:  [[0.15]]
grads:  [-0.19284991]
Stock Position:  -0.19284990759441997
Bond Position:  [29.19680812]


portfolio before change:  [10.59584127]
curr_Stock_Price:  96.4625388456834
curr_Factors:  [96.46253885]
mat_Sqrt:  [[0.15]]
grads:  [0.05428599]
Stock Position:  0.05428599139149115
Bond Position:  [5.35927672]


portfolio before change:  [10.58038259]
curr_Stock_Price:  96.17160476950558
curr_Factors:  [96.17160477]
mat_Sqrt:  [[0.15]]
grads:  [-0.00850018]
Stock Position:  -0.00850018462356398
Bond Position:  [11.39785899]


portfolio before change:  [10.58131448]
curr_Stock_Price:  96.14578168044345
curr_Factors:  [96.14578168]
mat_Sqrt:  [[0.15]]
grads:  [-0.0367186]
Stock Position:  -0.03671859930714005
Bond Position:  [14.11165291]


portfolio before change:  [10.56329672]
curr_Stock_Price:  96.6605007438166
curr_Factors:  [96.66050074]
mat_Sqrt:  [[0.15]]
grads:  [0.04003439]
Stock Position:  0.04003439479180734
Bond Position:  [6.69355208]


portfolio before change:  [10.53907414]
curr_Stock_Price:  96.04500651500629
curr_Factors:  [96.04500652]
mat_Sqrt:  [[0.15]]
grads:  [-0.12130804]
Stock Position:  -0.1213080435938988
Bond Position:  [22.19010598]


portfolio before change:  [10.39531357]
curr_Stock_Price:  97.24152648789828
curr_Factors:  [97.24152649]
mat_Sqrt:  [[0.15]]
grads:  [0.27337035]
Stock Position:  0.2733703487868433
Bond Position:  [-16.18763644]


portfolio before change:  [10.28416154]
curr_Stock_Price:  96.83862881665843
curr_Factors:  [96.83862882]
mat_Sqrt:  [[0.15]]
grads:  [0.00345284]
Stock Position:  0.003452836007117073
Bond Position:  [9.94979363]


portfolio before change:  [10.28617201]
curr_Stock_Price:  97.24078864218195
curr_Factors:  [97.24078864]
mat_Sqrt:  [[0.15]]
grads:  [0.03812976]
Stock Position:  0.03812976004412643
Bond Position:  [6.57840407]


portfolio before change:  [10.30787997]
curr_Stock_Price:  97.79932355075957
curr_Factors:  [97.79932355]
mat_Sqrt:  [[0.15]]
grads:  [-0.05572011]
Stock Position:  -0.05572011397377464
Bond Position:  [15.75726943]


portfolio before change:  [10.30560191]
curr_Stock_Price:  97.8578827296464
curr_Factors:  [97.85788273]
mat_Sqrt:  [[0.15]]
grads:  [0.00879699]
Stock Position:  0.008796988807629823
Bond Position:  [9.44474721]


portfolio before change:  [10.29975547]
curr_Stock_Price:  97.12618251849739
curr_Factors:  [97.12618252]
mat_Sqrt:  [[0.15]]
grads:  [-0.04796907]
Stock Position:  -0.04796907073954792
Bond Position:  [14.95880819]


portfolio before change:  [10.31086181]
curr_Stock_Price:  96.91414202540176
curr_Factors:  [96.91414203]
mat_Sqrt:  [[0.15]]
grads:  [-0.08973555]
Stock Position:  -0.08973554552419187
Bond Position:  [19.00750521]


portfolio before change:  [10.30269063]
curr_Stock_Price:  97.01843943293503
curr_Factors:  [97.01843943]
mat_Sqrt:  [[0.15]]
grads:  [-0.0019971]
Stock Position:  -0.0019971028257731046
Bond Position:  [10.49644643]


portfolio before change:  [10.30251093]
curr_Stock_Price:  97.43691923115377
curr_Factors:  [97.43691923]
mat_Sqrt:  [[0.15]]
grads:  [-0.02841488]
Stock Position:  -0.028414881520116137
Bond Position:  [13.07116945]


portfolio before change:  [10.31773609]
curr_Stock_Price:  96.92985433766383
curr_Factors:  [96.92985434]
mat_Sqrt:  [[0.15]]
grads:  [0.00460669]
Stock Position:  0.004606686510415121
Bond Position:  [9.87121064]


portfolio before change:  [10.31799155]
curr_Stock_Price:  96.8513784514677
curr_Factors:  [96.85137845]
mat_Sqrt:  [[0.15]]
grads:  [-0.02462625]
Stock Position:  -0.024626254141126586
Bond Position:  [12.70307821]


portfolio before change:  [10.31407667]
curr_Stock_Price:  97.04259073474567
curr_Factors:  [97.04259073]
mat_Sqrt:  [[0.15]]
grads:  [0.01982322]
Stock Position:  0.019823221866398334
Bond Position:  [8.39037987]


portfolio before change:  [10.30028384]
curr_Stock_Price:  96.32034439473549
curr_Factors:  [96.32034439]
mat_Sqrt:  [[0.15]]
grads:  [0.02374481]
Stock Position:  0.02374481332745392
Bond Position:  [8.01317524]


portfolio before change:  [10.29979957]
curr_Stock_Price:  96.27885691175746
curr_Factors:  [96.27885691]
mat_Sqrt:  [[0.15]]
grads:  [0.00010146]
Stock Position:  0.00010145732245150398
Bond Position:  [10.29003137]


portfolio before change:  [10.30037988]
curr_Stock_Price:  95.65956181480179
curr_Factors:  [95.65956181]
mat_Sqrt:  [[0.15]]
grads:  [0.06906038]
Stock Position:  0.06906037786001079
Bond Position:  [3.6940944]


portfolio before change:  [10.32901155]
curr_Stock_Price:  96.07080743187935
curr_Factors:  [96.07080743]
mat_Sqrt:  [[0.15]]
grads:  [0.05902129]
Stock Position:  0.05902129299912007
Bond Position:  [4.65878827]


portfolio before change:  [10.27992307]
curr_Stock_Price:  95.23416591033387
curr_Factors:  [95.23416591]
mat_Sqrt:  [[0.15]]
grads:  [0.02536214]
Stock Position:  0.02536214120032172
Bond Position:  [7.8645807]


portfolio before change:  [10.25130524]
curr_Stock_Price:  94.08641664297457
curr_Factors:  [94.08641664]
mat_Sqrt:  [[0.15]]
grads:  [0.09621594]
Stock Position:  0.09621593802075515
Bond Position:  [1.19869241]


portfolio before change:  [10.23870553]
curr_Stock_Price:  93.95468553097834
curr_Factors:  [93.95468553]
mat_Sqrt:  [[0.15]]
grads:  [0.08630636]
Stock Position:  0.08630635649720067
Bond Position:  [2.12981894]


portfolio before change:  [10.13704259]
curr_Stock_Price:  92.7752121305179
curr_Factors:  [92.77521213]
mat_Sqrt:  [[0.15]]
grads:  [-0.0721813]
Stock Position:  -0.07218130131821458
Bond Position:  [16.83367813]


portfolio before change:  [10.15257232]
curr_Stock_Price:  92.57463951750034
curr_Factors:  [92.57463952]
mat_Sqrt:  [[0.15]]
grads:  [-0.08383812]
Stock Position:  -0.08383812101933351
Bond Position:  [17.91385615]


portfolio before change:  [10.11452759]
curr_Stock_Price:  93.04178238072863
curr_Factors:  [93.04178238]
mat_Sqrt:  [[0.15]]
grads:  [-0.24774677]
Stock Position:  -0.24774677123699893
Bond Position:  [33.16532877]


portfolio before change:  [10.19707522]
curr_Stock_Price:  92.71695582438599
curr_Factors:  [92.71695582]
mat_Sqrt:  [[0.15]]
grads:  [-0.0868642]
Stock Position:  -0.08686419579787384
Bond Position:  [18.25085903]


portfolio before change:  [10.19560097]
curr_Stock_Price:  92.74705995482607
curr_Factors:  [92.74705995]
mat_Sqrt:  [[0.15]]
grads:  [-0.03150555]
Stock Position:  -0.03150554623290656
Bond Position:  [13.11764775]


portfolio before change:  [10.21674882]
curr_Stock_Price:  92.10184083176473
curr_Factors:  [92.10184083]
mat_Sqrt:  [[0.15]]
grads:  [-0.00601445]
Stock Position:  -0.006014454614819814
Bond Position:  [10.77069117]


portfolio before change:  [10.21921594]
curr_Stock_Price:  91.80357113838124
curr_Factors:  [91.80357114]
mat_Sqrt:  [[0.15]]
grads:  [0.55046076]
Stock Position:  0.5504607588843673
Bond Position:  [-40.31504749]


portfolio before change:  [10.45798289]
curr_Stock_Price:  92.24190704154555
curr_Factors:  [92.24190704]
mat_Sqrt:  [[0.15]]
grads:  [0.05778717]
Stock Position:  0.057787171241069045
Bond Position:  [5.12758401]


portfolio before change:  [10.44485929]
curr_Stock_Price:  92.00925889274872
curr_Factors:  [92.00925889]
mat_Sqrt:  [[0.15]]
grads:  [0.01095757]
Stock Position:  0.010957570065619142
Bond Position:  [9.43666139]


portfolio before change:  [10.45094111]
curr_Stock_Price:  92.51046592521689
curr_Factors:  [92.51046593]
mat_Sqrt:  [[0.15]]
grads:  [0.1117812]
Stock Position:  0.11178120438043232
Bond Position:  [0.11000982]


portfolio before change:  [10.42074273]
curr_Stock_Price:  92.24024824131115
curr_Factors:  [92.24024824]
mat_Sqrt:  [[0.15]]
grads:  [-0.12857552]
Stock Position:  -0.1285755151636063
Bond Position:  [22.28058017]


portfolio before change:  [10.36944069]
curr_Stock_Price:  92.6500822992127
curr_Factors:  [92.6500823]
mat_Sqrt:  [[0.15]]
grads:  [0.19417973]
Stock Position:  0.1941797296792709
Bond Position:  [-7.62132725]


portfolio before change:  [10.31047613]
curr_Stock_Price:  92.34887574036081
curr_Factors:  [92.34887574]
mat_Sqrt:  [[0.15]]
grads:  [-0.24463147]
Stock Position:  -0.24463146852936335
Bond Position:  [32.90191722]


portfolio before change:  [10.4557151]
curr_Stock_Price:  91.76357683399621
curr_Factors:  [91.76357683]
mat_Sqrt:  [[0.15]]
grads:  [-0.06176099]
Stock Position:  -0.06176098730727164
Bond Position:  [16.1231242]


portfolio before change:  [10.48245155]
curr_Stock_Price:  91.3469914592913
curr_Factors:  [91.34699146]
mat_Sqrt:  [[0.15]]
grads:  [0.05450314]
Stock Position:  0.05450314381226177
Bond Position:  [5.50375333]


portfolio before change:  [10.49085369]
curr_Stock_Price:  91.49483876695433
curr_Factors:  [91.49483877]
mat_Sqrt:  [[0.15]]
grads:  [-0.10548951]
Stock Position:  -0.10548950887582009
Bond Position:  [20.14259929]


portfolio before change:  [10.4678467]
curr_Stock_Price:  91.72487049773248
curr_Factors:  [91.7248705]
mat_Sqrt:  [[0.15]]
grads:  [0.02969322]
Stock Position:  0.02969322488231235
Bond Position:  [7.7442395]


portfolio before change:  [10.47852156]
curr_Stock_Price:  92.0680741117713
curr_Factors:  [92.06807411]
mat_Sqrt:  [[0.15]]
grads:  [0.15532659]
Stock Position:  0.15532659201718263
Bond Position:  [-3.82209863]


portfolio before change:  [10.57391537]
curr_Stock_Price:  92.68376200899435
curr_Factors:  [92.68376201]
mat_Sqrt:  [[0.15]]
grads:  [-0.11594633]
Stock Position:  -0.11594632511096307
Bond Position:  [21.32025697]


portfolio before change:  [10.58070857]
curr_Stock_Price:  92.63666568640899
curr_Factors:  [92.63666569]
mat_Sqrt:  [[0.15]]
grads:  [-0.3837826]
Stock Position:  -0.38378260209448944
Bond Position:  [46.13304918]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.58070857]
Stock Price:  92.85699705905971
PL:  [10.58070857]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-6.67046458e-02]
 [ 1.75259457e-04]
 [ 2.12157178e-04]
 [ 2.13967879e-03]
 [ 8.97420817e-03]
 [ 1.20136332e-02]
 [ 5.05085571e-04]
 [ 8.99829472e-03]
 [-7.91277614e-04]
 [-2.03450773e-02]
 [ 1.02767944e-02]
 [-5.13121232e-03]
 [-9.43710306e-03]
 [ 4.31398849e-03]
 [ 5.03430525e-03]
 [ 1.50323267e-03]
 [-4.65976250e-06]
 [ 9.50309885e-03]
 [ 2.19402100e-02]
 [ 3.10993635e-03]
 [ 7.88284435e-02]
 [-1.32818991e-02]
 [ 1.63292493e-03]
 [ 9.71343541e-03]
 [ 1.26204656e-02]
 [ 1.11998340e-03]
 [ 1.27017729e-02]
 [ 6.04378373e-03]
 [ 4.69764900e-03]
 [-2.55818115e-02]
 [-5.32740325e-03]
 [ 2.15095328e-02]
 [ 8.78809851e-03]
 [ 6.79869860e-03]
 [ 2.61192798e-03]
 [-4.34837256e-03]
 [-6.39897768e-03]
 [ 1.26751643e-02]
 [-1.92522186e-03]
 [-1.34739086e-02]
 [-3.95651084e-03]
 [-2.76047223e-03]
 [ 1.02300956e-02]
 [-1.18876946e-02]
 [ 5.15553457e-04]
 [ 1.76298514e-03]
 [-1.37073826e-02]
 [-5.05381399e-03]
 [-4.81223343e-04]
 [ 7.08838283e-03]
 [-2.98316018e-03]
 [ 3.70462641e-03]
 [ 1.88320693e-03]
 [-2.32091624e-03]
 [ 1.42142788e-03]
 [ 9.05349175e-03]
 [ 1.65080780e-02]
 [-2.81586276e-02]
 [ 1.35271129e-02]
 [ 8.14751069e-03]
 [ 7.22130984e-03]
 [-1.23561486e-02]
 [-1.25513288e-02]
 [-2.36726805e-03]
 [-2.01091887e-02]
 [ 2.39931283e-02]
 [ 2.53423387e-02]
 [ 1.88554031e-03]
 [ 6.30581046e-03]
 [-1.43816588e-02]
 [-7.84849808e-03]
 [-6.83115754e-03]
 [ 1.59786392e-03]
 [ 7.65103292e-03]
 [-6.74060296e-04]
 [-1.26085943e-02]
 [ 2.74425408e-03]
 [-6.45060693e-03]
 [ 1.21695624e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.05196966]
curr_Stock_Price:  100.64177609998461
curr_Factors:  [100.6417761]
mat_Sqrt:  [[0.15]]
grads:  [-0.44469764]
Stock Position:  -0.444697638914755
Bond Position:  [56.80712987]


portfolio before change:  [11.96889843]
curr_Stock_Price:  100.83656415419055
curr_Factors:  [100.83656415]
mat_Sqrt:  [[0.15]]
grads:  [0.0011684]
Stock Position:  0.0011683963769062466
Bond Position:  [11.85108135]


portfolio before change:  [11.96910224]
curr_Stock_Price:  100.37703868777082
curr_Factors:  [100.37703869]
mat_Sqrt:  [[0.15]]
grads:  [0.00141438]
Stock Position:  0.0014143811835245642
Bond Position:  [11.82713084]


portfolio before change:  [11.96912216]
curr_Stock_Price:  99.86847902288517
curr_Factors:  [99.86847902]
mat_Sqrt:  [[0.15]]
grads:  [0.01426453]
Stock Position:  0.014264525268787784
Bond Position:  [10.54454572]


portfolio before change:  [11.97886315]
curr_Stock_Price:  100.50515902987487
curr_Factors:  [100.50515903]
mat_Sqrt:  [[0.15]]
grads:  [0.05982805]
Stock Position:  0.05982805447593577
Bond Position:  [5.96583502]


portfolio before change:  [12.02164337]
curr_Stock_Price:  101.21397938343844
curr_Factors:  [101.21397938]
mat_Sqrt:  [[0.15]]
grads:  [0.08009089]
Stock Position:  0.08009088795929911
Bond Position:  [3.91532589]


portfolio before change:  [12.00447523]
curr_Stock_Price:  100.99656572357178
curr_Factors:  [100.99656572]
mat_Sqrt:  [[0.15]]
grads:  [0.00336724]
Stock Position:  0.0033672371428919044
Bond Position:  [11.66439585]


portfolio before change:  [12.00455833]
curr_Stock_Price:  100.80473121878431
curr_Factors:  [100.80473122]
mat_Sqrt:  [[0.15]]
grads:  [0.05998863]
Stock Position:  0.059988631473672435
Bond Position:  [5.95742046]


portfolio before change:  [12.00143598]
curr_Stock_Price:  100.74647526177844
curr_Factors:  [100.74647526]
mat_Sqrt:  [[0.15]]
grads:  [-0.00527518]
Stock Position:  -0.005275184096545448
Bond Position:  [12.53289219]


portfolio before change:  [12.00162662]
curr_Stock_Price:  100.85883018281771
curr_Factors:  [100.85883018]
mat_Sqrt:  [[0.15]]
grads:  [-0.13563385]
Stock Position:  -0.13563384844736956
Bond Position:  [25.68149791]


portfolio before change:  [12.01953711]
curr_Stock_Price:  100.73861425681915
curr_Factors:  [100.73861426]
mat_Sqrt:  [[0.15]]
grads:  [0.06851196]
Stock Position:  0.06851196259503317
Bond Position:  [5.11773694]


portfolio before change:  [11.98388675]
curr_Stock_Price:  100.21359303410733
curr_Factors:  [100.21359303]
mat_Sqrt:  [[0.15]]
grads:  [-0.03420808]
Stock Position:  -0.034208082119445524
Bond Position:  [15.41200157]


portfolio before change:  [11.99122]
curr_Stock_Price:  100.02738059313978
curr_Factors:  [100.02738059]
mat_Sqrt:  [[0.15]]
grads:  [-0.06291402]
Stock Position:  -0.06291402042351096
Bond Position:  [18.28434466]


portfolio before change:  [11.98666853]
curr_Stock_Price:  100.11788938247173
curr_Factors:  [100.11788938]
mat_Sqrt:  [[0.15]]
grads:  [0.02875992]
Stock Position:  0.028759923251909462
Bond Position:  [9.10728572]


portfolio before change:  [11.98204523]
curr_Stock_Price:  99.93734226230806
curr_Factors:  [99.93734226]
mat_Sqrt:  [[0.15]]
grads:  [0.03356203]
Stock Position:  0.033562034988483355
Bond Position:  [8.62794466]


portfolio before change:  [11.98029629]
curr_Stock_Price:  99.8691636968924
curr_Factors:  [99.8691637]
mat_Sqrt:  [[0.15]]
grads:  [0.01002155]
Stock Position:  0.01002155116331766
Bond Position:  [10.97945235]


portfolio before change:  [11.97422102]
curr_Stock_Price:  99.1944675586204
curr_Factors:  [99.19446756]
mat_Sqrt:  [[0.15]]
grads:  [-3.10650833e-05]
Stock Position:  -3.106508333894553e-05
Bond Position:  [11.97730251]


portfolio before change:  [11.97494814]
curr_Stock_Price:  99.88627380568244
curr_Factors:  [99.88627381]
mat_Sqrt:  [[0.15]]
grads:  [0.06335399]
Stock Position:  0.06335399234833484
Bond Position:  [5.64675391]


portfolio before change:  [11.99718005]
curr_Stock_Price:  100.23161878572687
curr_Factors:  [100.23161879]
mat_Sqrt:  [[0.15]]
grads:  [0.14626807]
Stock Position:  0.14626806676819534
Bond Position:  [-2.66350506]


portfolio before change:  [12.02237664]
curr_Stock_Price:  100.40502002001296
curr_Factors:  [100.40502002]
mat_Sqrt:  [[0.15]]
grads:  [0.02073291]
Stock Position:  0.0207329089683338
Bond Position:  [9.9406885]


portfolio before change:  [12.0219092]
curr_Stock_Price:  100.3525069216527
curr_Factors:  [100.35250692]
mat_Sqrt:  [[0.15]]
grads:  [0.52552296]
Stock Position:  0.5255229564304599
Bond Position:  [-40.71563692]


portfolio before change:  [12.07882633]
curr_Stock_Price:  100.46565502763806
curr_Factors:  [100.46565503]
mat_Sqrt:  [[0.15]]
grads:  [-0.08854599]
Stock Position:  -0.08854599396316633
Bond Position:  [20.97465761]


portfolio before change:  [12.05897201]
curr_Stock_Price:  100.70468642968014
curr_Factors:  [100.70468643]
mat_Sqrt:  [[0.15]]
grads:  [0.01088617]
Stock Position:  0.010886166225050307
Bond Position:  [10.96268405]


portfolio before change:  [12.05492179]
curr_Stock_Price:  100.269693579387
curr_Factors:  [100.26969358]
mat_Sqrt:  [[0.15]]
grads:  [0.06475624]
Stock Position:  0.06475623605017534
Bond Position:  [5.56183385]


portfolio before change:  [12.03312048]
curr_Stock_Price:  99.92765796869396
curr_Factors:  [99.92765797]
mat_Sqrt:  [[0.15]]
grads:  [0.08413644]
Stock Position:  0.0841364371516373
Bond Position:  [3.62556337]


portfolio before change:  [12.11827142]
curr_Stock_Price:  100.93702245685554
curr_Factors:  [100.93702246]
mat_Sqrt:  [[0.15]]
grads:  [0.00746656]
Stock Position:  0.007466555984039179
Bond Position:  [11.36461949]


portfolio before change:  [12.11840255]
curr_Stock_Price:  100.85945284701567
curr_Factors:  [100.85945285]
mat_Sqrt:  [[0.15]]
grads:  [0.08467849]
Stock Position:  0.08467848582130208
Bond Position:  [3.5777768]


portfolio before change:  [12.22937065]
curr_Stock_Price:  102.16727599883612
curr_Factors:  [102.167276]
mat_Sqrt:  [[0.15]]
grads:  [0.04029189]
Stock Position:  0.04029189153957495
Bond Position:  [8.11285785]


portfolio before change:  [12.20491862]
curr_Stock_Price:  101.54781871778242
curr_Factors:  [101.54781872]
mat_Sqrt:  [[0.15]]
grads:  [0.03131766]
Stock Position:  0.03131765997360371
Bond Position:  [9.02467856]


portfolio before change:  [12.19946417]
curr_Stock_Price:  101.35564252325447
curr_Factors:  [101.35564252]
mat_Sqrt:  [[0.15]]
grads:  [-0.17054541]
Stock Position:  -0.17054541003988086
Bond Position:  [29.48520378]


portfolio before change:  [12.19047596]
curr_Stock_Price:  101.4191510663652
curr_Factors:  [101.41915107]
mat_Sqrt:  [[0.15]]
grads:  [-0.03551602]
Stock Position:  -0.035516021682327856
Bond Position:  [15.79248073]


portfolio before change:  [12.18745125]
curr_Stock_Price:  101.53210773322108
curr_Factors:  [101.53210773]
mat_Sqrt:  [[0.15]]
grads:  [0.14339689]
Stock Position:  0.14339688506893772
Bond Position:  [-2.37193673]


portfolio before change:  [12.14449562]
curr_Stock_Price:  101.2335839719251
curr_Factors:  [101.23358397]
mat_Sqrt:  [[0.15]]
grads:  [0.05858732]
Stock Position:  0.05858732340653236
Bond Position:  [6.2134909]


portfolio before change:  [12.15850727]
curr_Stock_Price:  101.46611363756357
curr_Factors:  [101.46611364]
mat_Sqrt:  [[0.15]]
grads:  [0.04532466]
Stock Position:  0.045324657364090144
Bond Position:  [7.55959043]


portfolio before change:  [12.13966896]
curr_Stock_Price:  101.04005857519324
curr_Factors:  [101.04005858]
mat_Sqrt:  [[0.15]]
grads:  [0.01741285]
Stock Position:  0.017412853201704874
Bond Position:  [10.38027325]


portfolio before change:  [12.13892129]
curr_Stock_Price:  100.95986185277043
curr_Factors:  [100.95986185]
mat_Sqrt:  [[0.15]]
grads:  [-0.02898915]
Stock Position:  -0.028989150427626155
Bond Position:  [15.06566191]


portfolio before change:  [12.13869597]
curr_Stock_Price:  101.00011660501859
curr_Factors:  [101.00011661]
mat_Sqrt:  [[0.15]]
grads:  [-0.04265985]
Stock Position:  -0.04265985123260846
Bond Position:  [16.44734592]


portfolio before change:  [12.1734027]
curr_Stock_Price:  100.2106452066965
curr_Factors:  [100.21064521]
mat_Sqrt:  [[0.15]]
grads:  [0.0845011]
Stock Position:  0.08450109541315272
Bond Position:  [3.7054934]


portfolio before change:  [12.16548993]
curr_Stock_Price:  100.11426342230004
curr_Factors:  [100.11426342]
mat_Sqrt:  [[0.15]]
grads:  [-0.01283481]
Stock Position:  -0.01283481238529883
Bond Position:  [13.45043772]


portfolio before change:  [12.16474324]
curr_Stock_Price:  100.23794048861826
curr_Factors:  [100.23794049]
mat_Sqrt:  [[0.15]]
grads:  [-0.08982606]
Stock Position:  -0.08982605738169042
Bond Position:  [21.16872223]


portfolio before change:  [12.12188273]
curr_Stock_Price:  100.72982001327416
curr_Factors:  [100.72982001]
mat_Sqrt:  [[0.15]]
grads:  [-0.02637674]
Stock Position:  -0.026376738925024033
Bond Position:  [14.77880689]


portfolio before change:  [12.1157433]
curr_Stock_Price:  100.9975987181542
curr_Factors:  [100.99759872]
mat_Sqrt:  [[0.15]]
grads:  [-0.01840315]
Stock Position:  -0.018403148196262695
Bond Position:  [13.97441708]


portfolio before change:  [12.1049427]
curr_Stock_Price:  101.63194824371071
curr_Factors:  [101.63194824]
mat_Sqrt:  [[0.15]]
grads:  [0.06820064]
Stock Position:  0.06820063758536796
Bond Position:  [5.17357903]


portfolio before change:  [12.13377952]
curr_Stock_Price:  102.05003029865608
curr_Factors:  [102.0500303]
mat_Sqrt:  [[0.15]]
grads:  [-0.0792513]
Stock Position:  -0.0792512973214728
Bond Position:  [20.22137681]


portfolio before change:  [12.14141461]
curr_Stock_Price:  101.96963773045512
curr_Factors:  [101.96963773]
mat_Sqrt:  [[0.15]]
grads:  [0.00343702]
Stock Position:  0.003437023044443009
Bond Position:  [11.79094262]


portfolio before change:  [12.13999096]
curr_Stock_Price:  101.34100958853116
curr_Factors:  [101.34100959]
mat_Sqrt:  [[0.15]]
grads:  [0.01175323]
Stock Position:  0.011753234286964166
Bond Position:  [10.94890633]


portfolio before change:  [12.13565741]
curr_Stock_Price:  100.91407340086404
curr_Factors:  [100.9140734]
mat_Sqrt:  [[0.15]]
grads:  [-0.09138255]
Stock Position:  -0.09138255077956228
Bond Position:  [21.35744284]


portfolio before change:  [12.14055635]
curr_Stock_Price:  100.87507183373067
curr_Factors:  [100.87507183]
mat_Sqrt:  [[0.15]]
grads:  [-0.03369209]
Stock Position:  -0.03369209327971533
Bond Position:  [15.53924868]


portfolio before change:  [12.1106054]
curr_Stock_Price:  101.79285945034601
curr_Factors:  [101.79285945]
mat_Sqrt:  [[0.15]]
grads:  [-0.00320816]
Stock Position:  -0.003208155620604571
Bond Position:  [12.43717273]


portfolio before change:  [12.11593865]
curr_Stock_Price:  100.37275986617828
curr_Factors:  [100.37275987]
mat_Sqrt:  [[0.15]]
grads:  [0.04725589]
Stock Position:  0.047255885562071526
Bond Position:  [7.37273499]


portfolio before change:  [12.10721431]
curr_Stock_Price:  100.1783893471869
curr_Factors:  [100.17838935]
mat_Sqrt:  [[0.15]]
grads:  [-0.01988773]
Stock Position:  -0.019887734512546093
Bond Position:  [14.09953552]


portfolio before change:  [12.10961195]
curr_Stock_Price:  100.10214164978527
curr_Factors:  [100.10214165]
mat_Sqrt:  [[0.15]]
grads:  [0.02469751]
Stock Position:  0.024697509409987634
Bond Position:  [9.63733836]


portfolio before change:  [12.09486025]
curr_Stock_Price:  99.48045736618636
curr_Factors:  [99.48045737]
mat_Sqrt:  [[0.15]]
grads:  [0.01255471]
Stock Position:  0.012554712899116121
Bond Position:  [10.84591167]


portfolio before change:  [12.0992716]
curr_Stock_Price:  99.7778328302774
curr_Factors:  [99.77783283]
mat_Sqrt:  [[0.15]]
grads:  [-0.01547277]
Stock Position:  -0.01547277495913634
Bond Position:  [13.64311156]


portfolio before change:  [12.10954604]
curr_Stock_Price:  99.16891080180939
curr_Factors:  [99.1689108]
mat_Sqrt:  [[0.15]]
grads:  [0.00947619]
Stock Position:  0.009476185835778897
Bond Position:  [11.16980301]


portfolio before change:  [12.1093989]
curr_Stock_Price:  99.07971143691144
curr_Factors:  [99.07971144]
mat_Sqrt:  [[0.15]]
grads:  [0.06035661]
Stock Position:  0.06035661169562524
Bond Position:  [6.12928323]


portfolio before change:  [12.10743949]
curr_Stock_Price:  99.04090045208589
curr_Factors:  [99.04090045]
mat_Sqrt:  [[0.15]]
grads:  [0.11005385]
Stock Position:  0.11005385343430048
Bond Position:  [1.20760675]


portfolio before change:  [12.18042915]
curr_Stock_Price:  99.70343224946785
curr_Factors:  [99.70343225]
mat_Sqrt:  [[0.15]]
grads:  [-0.18772418]
Stock Position:  -0.18772418376224426
Bond Position:  [30.89717459]


portfolio before change:  [11.99168314]
curr_Stock_Price:  100.71916255018473
curr_Factors:  [100.71916255]
mat_Sqrt:  [[0.15]]
grads:  [0.09018075]
Stock Position:  0.0901807527363132
Bond Position:  [2.90875325]


portfolio before change:  [11.97688682]
curr_Stock_Price:  100.55307248746115
curr_Factors:  [100.55307249]
mat_Sqrt:  [[0.15]]
grads:  [0.05431674]
Stock Position:  0.054316737964053924
Bond Position:  [6.51517193]


portfolio before change:  [11.95801487]
curr_Stock_Price:  100.19813284835016
curr_Factors:  [100.19813285]
mat_Sqrt:  [[0.15]]
grads:  [0.04814207]
Stock Position:  0.04814206560728631
Bond Position:  [7.13426978]


portfolio before change:  [11.94766359]
curr_Stock_Price:  99.97385543322123
curr_Factors:  [99.97385543]
mat_Sqrt:  [[0.15]]
grads:  [-0.08237432]
Stock Position:  -0.08237432418977109
Bond Position:  [20.18294237]


portfolio before change:  [11.8989902]
curr_Stock_Price:  100.58005001643531
curr_Factors:  [100.58005002]
mat_Sqrt:  [[0.15]]
grads:  [-0.08367553]
Stock Position:  -0.08367552515798914
Bond Position:  [20.3150787]


portfolio before change:  [11.84989844]
curr_Stock_Price:  101.18191642097638
curr_Factors:  [101.18191642]
mat_Sqrt:  [[0.15]]
grads:  [-0.01578179]
Stock Position:  -0.015781786970600297
Bond Position:  [13.44672989]


portfolio before change:  [11.85330954]
curr_Stock_Price:  101.01902950944118
curr_Factors:  [101.01902951]
mat_Sqrt:  [[0.15]]
grads:  [-0.13406126]
Stock Position:  -0.1340612582222998
Bond Position:  [25.39604774]


portfolio before change:  [11.84303696]
curr_Stock_Price:  101.10749561363686
curr_Factors:  [101.10749561]
mat_Sqrt:  [[0.15]]
grads:  [0.15995419]
Stock Position:  0.1599541888778562
Bond Position:  [-4.32953049]


portfolio before change:  [11.91075238]
curr_Stock_Price:  101.53252997103651
curr_Factors:  [101.53252997]
mat_Sqrt:  [[0.15]]
grads:  [0.16894892]
Stock Position:  0.16894892477981
Bond Position:  [-5.24305939]


portfolio before change:  [11.8648124]
curr_Stock_Price:  101.26255320819439
curr_Factors:  [101.26255321]
mat_Sqrt:  [[0.15]]
grads:  [0.01257027]
Stock Position:  0.012570268726696997
Bond Position:  [10.59191489]


portfolio before change:  [11.86944075]
curr_Stock_Price:  101.5780863779725
curr_Factors:  [101.57808638]
mat_Sqrt:  [[0.15]]
grads:  [0.04203874]
Stock Position:  0.04203873643117882
Bond Position:  [7.59922635]


portfolio before change:  [11.89847486]
curr_Stock_Price:  102.25743943173809
curr_Factors:  [102.25743943]
mat_Sqrt:  [[0.15]]
grads:  [-0.09587773]
Stock Position:  -0.09587772528679983
Bond Position:  [21.70268555]


portfolio before change:  [11.89620474]
curr_Stock_Price:  102.29526443852092
curr_Factors:  [102.29526444]
mat_Sqrt:  [[0.15]]
grads:  [-0.05232332]
Stock Position:  -0.05232332054788339
Bond Position:  [17.24863266]


portfolio before change:  [11.92604281]
curr_Stock_Price:  101.74560528896548
curr_Factors:  [101.74560529]
mat_Sqrt:  [[0.15]]
grads:  [-0.04554105]
Stock Position:  -0.04554105025808115
Bond Position:  [16.55964453]


portfolio before change:  [11.90469178]
curr_Stock_Price:  102.2371626392435
curr_Factors:  [102.23716264]
mat_Sqrt:  [[0.15]]
grads:  [0.01065243]
Stock Position:  0.0106524261517104
Bond Position:  [10.81561796]


portfolio before change:  [11.91078672]
curr_Stock_Price:  102.7458675169858
curr_Factors:  [102.74586752]
mat_Sqrt:  [[0.15]]
grads:  [0.05100689]
Stock Position:  0.051006886162271045
Bond Position:  [6.67003995]


portfolio before change:  [11.91755493]
curr_Stock_Price:  102.87038639979029
curr_Factors:  [102.8703864]
mat_Sqrt:  [[0.15]]
grads:  [-0.00449374]
Stock Position:  -0.004493735307883185
Bond Position:  [12.37982722]


portfolio before change:  [11.92111942]
curr_Stock_Price:  102.24936025090538
curr_Factors:  [102.24936025]
mat_Sqrt:  [[0.15]]
grads:  [-0.0840573]
Stock Position:  -0.08405729517307217
Bond Position:  [20.51592408]


portfolio before change:  [11.98880756]
curr_Stock_Price:  101.4593532681601
curr_Factors:  [101.45935327]
mat_Sqrt:  [[0.15]]
grads:  [0.01829503]
Stock Position:  0.018295027210786404
Bond Position:  [10.13260593]


portfolio before change:  [11.9883674]
curr_Stock_Price:  101.40067824003908
curr_Factors:  [101.40067824]
mat_Sqrt:  [[0.15]]
grads:  [-0.04300405]
Stock Position:  -0.04300404619208796
Bond Position:  [16.34900685]


portfolio before change:  [11.99317925]
curr_Stock_Price:  101.3125468676077
curr_Factors:  [101.31254687]
mat_Sqrt:  [[0.15]]
grads:  [0.08113042]
Stock Position:  0.08113041603652589
Bond Position:  [3.77365018]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.99317925]
Stock Price:  100.98061616883837
PL:  [11.01256308]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.92250301e-02]
 [ 2.16264966e-03]
 [-7.71099620e-04]
 [-1.13823387e-04]
 [ 1.00940362e-04]
 [ 1.03341799e-02]
 [ 1.26523911e-03]
 [ 1.23504189e-02]
 [ 1.65027652e-02]
 [-1.87839808e-02]
 [ 6.15342727e-03]
 [-5.07145324e-03]
 [-8.88176132e-03]
 [ 4.29840869e-03]
 [ 5.12017987e-03]
 [ 9.64670839e-04]
 [ 9.00109970e-03]
 [ 1.19512027e-02]
 [ 2.15661376e-02]
 [ 3.64651252e-03]
 [ 7.72547702e-02]
 [-1.42678145e-02]
 [-1.60330999e-03]
 [ 9.51316776e-03]
 [ 1.20770477e-02]
 [-5.80992947e-03]
 [ 1.34221077e-02]
 [-9.79206414e-03]
 [ 2.54560071e-03]
 [-2.03966932e-02]
 [-4.52456782e-03]
 [-6.02533379e-03]
 [ 1.54908564e-02]
 [ 1.94474886e-02]
 [-9.79888719e-03]
 [ 6.37361731e-03]
 [-2.33620963e-03]
 [ 1.13955762e-02]
 [-1.45292451e-03]
 [-1.39479538e-02]
 [-2.42318999e-03]
 [-2.29822228e-03]
 [ 5.36079622e-03]
 [-1.09662105e-02]
 [ 2.53928724e-03]
 [-2.96507303e-03]
 [-1.36939579e-02]
 [-1.25459067e-03]
 [-6.46251517e-03]
 [ 7.72233168e-03]
 [-3.13508305e-03]
 [ 3.18187263e-03]
 [ 2.86791339e-03]
 [ 2.12588142e-03]
 [ 1.95109667e-03]
 [ 8.97401273e-03]
 [ 1.46819522e-02]
 [-1.45383351e-02]
 [ 1.38649926e-02]
 [ 4.15998140e-03]
 [ 4.94893857e-03]
 [-1.58143732e-02]
 [-1.26898114e-02]
 [-1.53838203e-03]
 [-9.12468586e-03]
 [ 6.91407703e-04]
 [ 8.32066814e-03]
 [ 1.74632685e-03]
 [ 1.34960215e-02]
 [-1.84570807e-02]
 [ 1.17961582e-02]
 [ 6.58727579e-04]
 [-1.66330251e-03]
 [ 7.76398487e-03]
 [-2.48393939e-03]
 [ 2.69064279e-03]
 [ 5.18511344e-03]
 [-1.18067994e-02]
 [-2.59860233e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.76558568]
curr_Stock_Price:  99.4323594063647
curr_Factors:  [99.43235941]
mat_Sqrt:  [[0.15]]
grads:  [-0.2615002]
Stock Position:  -0.2615002004450724
Bond Position:  [19.23599624]


portfolio before change:  [-6.77031767]
curr_Stock_Price:  99.45505261376312
curr_Factors:  [99.45505261]
mat_Sqrt:  [[0.15]]
grads:  [0.01441766]
Stock Position:  0.014417664380305681
Bond Position:  [-8.20422724]


portfolio before change:  [-6.78217898]
curr_Stock_Price:  98.66792601640941
curr_Factors:  [98.66792602]
mat_Sqrt:  [[0.15]]
grads:  [-0.00514066]
Stock Position:  -0.005140664133524402
Bond Position:  [-6.27496031]


portfolio before change:  [-6.78463332]
curr_Stock_Price:  99.06906996199888
curr_Factors:  [99.06906996]
mat_Sqrt:  [[0.15]]
grads:  [-0.00075882]
Stock Position:  -0.0007588225788734623
Bond Position:  [-6.70945747]


portfolio before change:  [-6.7853212]
curr_Stock_Price:  99.42294071721321
curr_Factors:  [99.42294072]
mat_Sqrt:  [[0.15]]
grads:  [0.00067294]
Stock Position:  0.0006729357437480765
Bond Position:  [-6.85222645]


portfolio before change:  [-6.78575815]
curr_Stock_Price:  99.41005332065463
curr_Factors:  [99.41005332]
mat_Sqrt:  [[0.15]]
grads:  [0.06889453]
Stock Position:  0.06889453267668945
Bond Position:  [-13.63456732]


portfolio before change:  [-6.75789393]
curr_Stock_Price:  99.82687024066726
curr_Factors:  [99.82687024]
mat_Sqrt:  [[0.15]]
grads:  [0.00843493]
Stock Position:  0.008434927388350975
Bond Position:  [-7.59992633]


portfolio before change:  [-6.75896459]
curr_Stock_Price:  99.75625242552069
curr_Factors:  [99.75625243]
mat_Sqrt:  [[0.15]]
grads:  [0.08233613]
Stock Position:  0.0823361258060028
Bond Position:  [-14.97250794]


portfolio before change:  [-6.76590598]
curr_Stock_Price:  99.68331265579178
curr_Factors:  [99.68331266]
mat_Sqrt:  [[0.15]]
grads:  [0.11001843]
Stock Position:  0.11001843444049746
Bond Position:  [-17.73290798]


portfolio before change:  [-6.75831739]
curr_Stock_Price:  99.76236241826052
curr_Factors:  [99.76236242]
mat_Sqrt:  [[0.15]]
grads:  [-0.12522654]
Stock Position:  -0.12522653876362683
Bond Position:  [5.73457795]


portfolio before change:  [-6.69497703]
curr_Stock_Price:  99.25941836409592
curr_Factors:  [99.25941836]
mat_Sqrt:  [[0.15]]
grads:  [0.04102285]
Stock Position:  0.04102284845687257
Bond Position:  [-10.76688111]


portfolio before change:  [-6.67487617]
curr_Stock_Price:  99.76581451484437
curr_Factors:  [99.76581451]
mat_Sqrt:  [[0.15]]
grads:  [-0.03380969]
Stock Position:  -0.033809688241782786
Bond Position:  [-3.30182508]


portfolio before change:  [-6.68590652]
curr_Stock_Price:  100.0859588542072
curr_Factors:  [100.08595885]
mat_Sqrt:  [[0.15]]
grads:  [-0.05921174]
Stock Position:  -0.059211742138957614
Bond Position:  [-0.75964253]


portfolio before change:  [-6.67361681]
curr_Stock_Price:  99.87760180189642
curr_Factors:  [99.8776018]
mat_Sqrt:  [[0.15]]
grads:  [0.02865606]
Stock Position:  0.02865605790451417
Bond Position:  [-9.53571515]


portfolio before change:  [-6.6482389]
curr_Stock_Price:  100.78400395446253
curr_Factors:  [100.78400395]
mat_Sqrt:  [[0.15]]
grads:  [0.03413453]
Stock Position:  0.03413453248097773
Bond Position:  [-10.08845376]


portfolio before change:  [-6.67781067]
curr_Stock_Price:  99.93614630421449
curr_Factors:  [99.9361463]
mat_Sqrt:  [[0.15]]
grads:  [0.00643114]
Stock Position:  0.006431138928143175
Bond Position:  [-7.32051391]


portfolio before change:  [-6.67761183]
curr_Stock_Price:  100.03821086804095
curr_Factors:  [100.03821087]
mat_Sqrt:  [[0.15]]
grads:  [0.06000733]
Stock Position:  0.060007331315277204
Bond Position:  [-12.68063789]


portfolio before change:  [-6.6609503]
curr_Stock_Price:  100.32907680635472
curr_Factors:  [100.32907681]
mat_Sqrt:  [[0.15]]
grads:  [0.07967468]
Stock Position:  0.07967468446424429
Bond Position:  [-14.65463784]


portfolio before change:  [-6.68211545]
curr_Stock_Price:  100.07492836480733
curr_Factors:  [100.07492836]
mat_Sqrt:  [[0.15]]
grads:  [0.14377425]
Stock Position:  0.14377425078006018
Bond Position:  [-21.07031329]


portfolio before change:  [-6.65929428]
curr_Stock_Price:  100.24281728786406
curr_Factors:  [100.24281729]
mat_Sqrt:  [[0.15]]
grads:  [0.02431008]
Stock Position:  0.024310083492829912
Bond Position:  [-9.09620553]


portfolio before change:  [-6.66067298]
curr_Stock_Price:  100.20949052794184
curr_Factors:  [100.20949053]
mat_Sqrt:  [[0.15]]
grads:  [0.5150318]
Stock Position:  0.515031801194791
Bond Position:  [-58.27174739]


portfolio before change:  [-6.78941555]
curr_Stock_Price:  99.96659200513521
curr_Factors:  [99.96659201]
mat_Sqrt:  [[0.15]]
grads:  [-0.09511876]
Stock Position:  -0.09511876352335769
Bond Position:  [2.71928308]


portfolio before change:  [-6.72641916]
curr_Stock_Price:  99.30608698126905
curr_Factors:  [99.30608698]
mat_Sqrt:  [[0.15]]
grads:  [-0.01068873]
Stock Position:  -0.010688733277519102
Bond Position:  [-5.66496289]


portfolio before change:  [-6.73731238]
curr_Stock_Price:  100.2920919988866
curr_Factors:  [100.292092]
mat_Sqrt:  [[0.15]]
grads:  [0.06342112]
Stock Position:  0.06342111842667751
Bond Position:  [-13.09794902]


portfolio before change:  [-6.76861601]
curr_Stock_Price:  99.81141647238773
curr_Factors:  [99.81141647]
mat_Sqrt:  [[0.15]]
grads:  [0.08051365]
Stock Position:  0.08051365141299306
Bond Position:  [-14.8047976]


portfolio before change:  [-6.76523211]
curr_Stock_Price:  99.86493818106817
curr_Factors:  [99.86493818]
mat_Sqrt:  [[0.15]]
grads:  [-0.03873286]
Stock Position:  -0.038732863166569334
Bond Position:  [-2.89717712]


portfolio before change:  [-6.78108273]
curr_Stock_Price:  100.26949240497994
curr_Factors:  [100.2694924]
mat_Sqrt:  [[0.15]]
grads:  [0.08948072]
Stock Position:  0.08948071770629207
Bond Position:  [-15.75326887]


portfolio before change:  [-6.88942426]
curr_Stock_Price:  99.06971527694961
curr_Factors:  [99.06971528]
mat_Sqrt:  [[0.15]]
grads:  [-0.06528043]
Stock Position:  -0.06528042761659986
Bond Position:  [-0.42211088]


portfolio before change:  [-6.91003395]
curr_Stock_Price:  99.38502119632341
curr_Factors:  [99.3850212]
mat_Sqrt:  [[0.15]]
grads:  [0.01697067]
Stock Position:  0.01697067136893779
Bond Position:  [-8.59666448]


portfolio before change:  [-6.90449542]
curr_Stock_Price:  99.7430406854621
curr_Factors:  [99.74304069]
mat_Sqrt:  [[0.15]]
grads:  [-0.13597795]
Stock Position:  -0.13597795450197173
Bond Position:  [6.65835922]


portfolio before change:  [-6.94451201]
curr_Stock_Price:  100.0403884782383
curr_Factors:  [100.04038848]
mat_Sqrt:  [[0.15]]
grads:  [-0.03016379]
Stock Position:  -0.03016378544017435
Bond Position:  [-3.92691519]


portfolio before change:  [-6.93085399]
curr_Stock_Price:  99.57945641332736
curr_Factors:  [99.57945641]
mat_Sqrt:  [[0.15]]
grads:  [-0.04016889]
Stock Position:  -0.040168891945445526
Bond Position:  [-2.93085757]


portfolio before change:  [-6.90742242]
curr_Stock_Price:  98.99156964781784
curr_Factors:  [98.99156965]
mat_Sqrt:  [[0.15]]
grads:  [0.10327238]
Stock Position:  0.10327237632187446
Bond Position:  [-17.13051705]


portfolio before change:  [-6.92868216]
curr_Stock_Price:  98.79607636478795
curr_Factors:  [98.79607636]
mat_Sqrt:  [[0.15]]
grads:  [0.12964992]
Stock Position:  0.12964992371280512
Bond Position:  [-19.73758593]


portfolio before change:  [-6.87895156]
curr_Stock_Price:  99.18916749999836
curr_Factors:  [99.1891675]
mat_Sqrt:  [[0.15]]
grads:  [-0.06532591]
Stock Position:  -0.06532591460994054
Bond Position:  [-0.39932848]


portfolio before change:  [-6.84189276]
curr_Stock_Price:  98.62149436308206
curr_Factors:  [98.62149436]
mat_Sqrt:  [[0.15]]
grads:  [0.04249078]
Stock Position:  0.04249078209354331
Bond Position:  [-11.03239718]


portfolio before change:  [-6.83872539]
curr_Stock_Price:  98.7122648921787
curr_Factors:  [98.71226489]
mat_Sqrt:  [[0.15]]
grads:  [-0.01557473]
Stock Position:  -0.01557473088162806
Bond Position:  [-5.30130843]


portfolio before change:  [-6.85024253]
curr_Stock_Price:  99.43046655171634
curr_Factors:  [99.43046655]
mat_Sqrt:  [[0.15]]
grads:  [0.07597051]
Stock Position:  0.07597050794840875
Bond Position:  [-14.40402558]


portfolio before change:  [-6.81141206]
curr_Stock_Price:  99.95344259006545
curr_Factors:  [99.95344259]
mat_Sqrt:  [[0.15]]
grads:  [-0.00968616]
Stock Position:  -0.009686163413223856
Bond Position:  [-5.84324668]


portfolio before change:  [-6.80085635]
curr_Stock_Price:  98.82596616641455
curr_Factors:  [98.82596617]
mat_Sqrt:  [[0.15]]
grads:  [-0.09298636]
Stock Position:  -0.09298635850425814
Bond Position:  [2.38861037]


portfolio before change:  [-6.87370552]
curr_Stock_Price:  99.61101106898265
curr_Factors:  [99.61101107]
mat_Sqrt:  [[0.15]]
grads:  [-0.0161546]
Stock Position:  -0.016154599908730964
Bond Position:  [-5.26452949]


portfolio before change:  [-6.86827809]
curr_Stock_Price:  99.25467435076081
curr_Factors:  [99.25467435]
mat_Sqrt:  [[0.15]]
grads:  [-0.01532148]
Stock Position:  -0.015321481852660485
Bond Position:  [-5.3475494]


portfolio before change:  [-6.87875633]
curr_Stock_Price:  99.91675197005434
curr_Factors:  [99.91675197]
mat_Sqrt:  [[0.15]]
grads:  [0.03573864]
Stock Position:  0.03573864147225351
Bond Position:  [-10.44964531]


portfolio before change:  [-6.88230723]
curr_Stock_Price:  99.8356695970876
curr_Factors:  [99.8356696]
mat_Sqrt:  [[0.15]]
grads:  [-0.07310807]
Stock Position:  -0.07310806983082696
Bond Position:  [0.41648587]


portfolio before change:  [-6.83747221]
curr_Stock_Price:  99.22275524374444
curr_Factors:  [99.22275524]
mat_Sqrt:  [[0.15]]
grads:  [0.01692858]
Stock Position:  0.016928581590206906
Bond Position:  [-8.51717272]


portfolio before change:  [-6.83927502]
curr_Stock_Price:  99.14770660830511
curr_Factors:  [99.14770661]
mat_Sqrt:  [[0.15]]
grads:  [-0.01976715]
Stock Position:  -0.01976715354270479
Bond Position:  [-4.87940708]


portfolio before change:  [-6.8498959]
curr_Stock_Price:  99.66957763216321
curr_Factors:  [99.66957763]
mat_Sqrt:  [[0.15]]
grads:  [-0.09129305]
Stock Position:  -0.09129305235194038
Bond Position:  [2.24924407]


portfolio before change:  [-6.74460066]
curr_Stock_Price:  98.51774128874887
curr_Factors:  [98.51774129]
mat_Sqrt:  [[0.15]]
grads:  [-0.00836394]
Stock Position:  -0.008363937821848884
Bond Position:  [-5.9206044]


portfolio before change:  [-6.74233546]
curr_Stock_Price:  98.20266867331424
curr_Factors:  [98.20266867]
mat_Sqrt:  [[0.15]]
grads:  [-0.04308343]
Stock Position:  -0.04308343446097946
Bond Position:  [-2.51142722]


portfolio before change:  [-6.74708156]
curr_Stock_Price:  98.30918597463396
curr_Factors:  [98.30918597]
mat_Sqrt:  [[0.15]]
grads:  [0.05148221]
Stock Position:  0.0514822112215362
Bond Position:  [-11.80825584]


portfolio before change:  [-6.72193426]
curr_Stock_Price:  98.81198761579559
curr_Factors:  [98.81198762]
mat_Sqrt:  [[0.15]]
grads:  [-0.02090055]
Stock Position:  -0.020900553682773652
Bond Position:  [-4.65670901]


portfolio before change:  [-6.71123796]
curr_Stock_Price:  98.2862910073051
curr_Factors:  [98.28629101]
mat_Sqrt:  [[0.15]]
grads:  [0.02121248]
Stock Position:  0.021212484208472878
Bond Position:  [-8.79613436]


portfolio before change:  [-6.70658818]
curr_Stock_Price:  98.53140894874889
curr_Factors:  [98.53140895]
mat_Sqrt:  [[0.15]]
grads:  [0.01911942]
Stock Position:  0.01911942261027784
Bond Position:  [-8.59045183]


portfolio before change:  [-6.71469842]
curr_Stock_Price:  98.13530255847151
curr_Factors:  [98.13530256]
mat_Sqrt:  [[0.15]]
grads:  [0.01417254]
Stock Position:  0.014172542797299039
Bond Position:  [-8.1055252]


portfolio before change:  [-6.71216428]
curr_Stock_Price:  98.34985534004404
curr_Factors:  [98.34985534]
mat_Sqrt:  [[0.15]]
grads:  [0.01300731]
Stock Position:  0.013007311118784719
Bond Position:  [-7.99143144]


portfolio before change:  [-6.71681701]
curr_Stock_Price:  98.0305540221116
curr_Factors:  [98.03055402]
mat_Sqrt:  [[0.15]]
grads:  [0.05982675]
Stock Position:  0.05982675153030247
Bond Position:  [-12.58166661]


portfolio before change:  [-6.69804217]
curr_Stock_Price:  98.35751843891806
curr_Factors:  [98.35751844]
mat_Sqrt:  [[0.15]]
grads:  [0.09787968]
Stock Position:  0.09787968124333371
Bond Position:  [-16.32524472]


portfolio before change:  [-6.69537101]
curr_Stock_Price:  98.39523333181685
curr_Factors:  [98.39523333]
mat_Sqrt:  [[0.15]]
grads:  [-0.09692223]
Stock Position:  -0.09692223409668262
Bond Position:  [2.84131483]


portfolio before change:  [-6.7195219]
curr_Stock_Price:  98.64624364263302
curr_Factors:  [98.64624364]
mat_Sqrt:  [[0.15]]
grads:  [0.09243328]
Stock Position:  0.09243328369188271
Bond Position:  [-15.83771812]


portfolio before change:  [-6.69866598]
curr_Stock_Price:  98.88258503657184
curr_Factors:  [98.88258504]
mat_Sqrt:  [[0.15]]
grads:  [0.02773321]
Stock Position:  0.02773320932361308
Bond Position:  [-9.44099741]


portfolio before change:  [-6.70755132]
curr_Stock_Price:  98.58347553911516
curr_Factors:  [98.58347554]
mat_Sqrt:  [[0.15]]
grads:  [0.03299292]
Stock Position:  0.03299292380107089
Bond Position:  [-9.96010842]


portfolio before change:  [-6.73462598]
curr_Stock_Price:  97.78172385980145
curr_Factors:  [97.78172386]
mat_Sqrt:  [[0.15]]
grads:  [-0.10542915]
Stock Position:  -0.1054291549200004
Bond Position:  [3.57441853]


portfolio before change:  [-6.71529621]
curr_Stock_Price:  97.6004991862988
curr_Factors:  [97.60049919]
mat_Sqrt:  [[0.15]]
grads:  [-0.08459874]
Stock Position:  -0.08459874253693224
Bond Position:  [1.54158329]


portfolio before change:  [-6.65220751]
curr_Stock_Price:  96.85589768047414
curr_Factors:  [96.85589768]
mat_Sqrt:  [[0.15]]
grads:  [-0.01025588]
Stock Position:  -0.010255880233029254
Bond Position:  [-5.65886502]


portfolio before change:  [-6.65141461]
curr_Stock_Price:  96.74409959652817
curr_Factors:  [96.7440996]
mat_Sqrt:  [[0.15]]
grads:  [-0.06083124]
Stock Position:  -0.06083123906135711
Bond Position:  [-0.76635116]


portfolio before change:  [-6.6187533]
curr_Stock_Price:  96.20639545535072
curr_Factors:  [96.20639546]
mat_Sqrt:  [[0.15]]
grads:  [0.00460938]
Stock Position:  0.004609384684151323
Bond Position:  [-7.06220558]


portfolio before change:  [-6.62227171]
curr_Stock_Price:  95.5388427887348
curr_Factors:  [95.53884279]
mat_Sqrt:  [[0.15]]
grads:  [0.05547112]
Stock Position:  0.05547112091924542
Bond Position:  [-11.92191841]


portfolio before change:  [-6.64369115]
curr_Stock_Price:  95.16613887764399
curr_Factors:  [95.16613888]
mat_Sqrt:  [[0.15]]
grads:  [0.01164218]
Stock Position:  0.011642179029651551
Bond Position:  [-7.75163238]


portfolio before change:  [-6.63331715]
curr_Stock_Price:  96.09882461971443
curr_Factors:  [96.09882462]
mat_Sqrt:  [[0.15]]
grads:  [0.08997348]
Stock Position:  0.08997347686463679
Bond Position:  [-15.27966252]


portfolio before change:  [-6.6079203]
curr_Stock_Price:  96.39170941658708
curr_Factors:  [96.39170942]
mat_Sqrt:  [[0.15]]
grads:  [-0.1230472]
Stock Position:  -0.1230472046831256
Bond Position:  [5.2528101]


portfolio before change:  [-6.582814]
curr_Stock_Price:  96.19033969690479
curr_Factors:  [96.1903397]
mat_Sqrt:  [[0.15]]
grads:  [0.07864105]
Stock Position:  0.07864105477215144
Bond Position:  [-14.14732378]


portfolio before change:  [-6.54249046]
curr_Stock_Price:  96.71433804530866
curr_Factors:  [96.71433805]
mat_Sqrt:  [[0.15]]
grads:  [0.00439152]
Stock Position:  0.004391517190163074
Bond Position:  [-6.96721313]


portfolio before change:  [-6.54385716]
curr_Stock_Price:  96.5022846164777
curr_Factors:  [96.50228462]
mat_Sqrt:  [[0.15]]
grads:  [-0.01108868]
Stock Position:  -0.011088683417032258
Bond Position:  [-5.47377387]


portfolio before change:  [-6.54419537]
curr_Stock_Price:  96.50193219995107
curr_Factors:  [96.5019322]
mat_Sqrt:  [[0.15]]
grads:  [0.0517599]
Stock Position:  0.051759899121052395
Bond Position:  [-11.53912565]


portfolio before change:  [-6.55173485]
curr_Stock_Price:  96.37020359426316
curr_Factors:  [96.37020359]
mat_Sqrt:  [[0.15]]
grads:  [-0.0165596]
Stock Position:  -0.016559595921703942
Bond Position:  [-4.95588322]


portfolio before change:  [-6.55958193]
curr_Stock_Price:  96.82536725790663
curr_Factors:  [96.82536726]
mat_Sqrt:  [[0.15]]
grads:  [0.01793762]
Stock Position:  0.017937618589190515
Bond Position:  [-8.29639843]


portfolio before change:  [-6.56213614]
curr_Stock_Price:  96.71188083997859
curr_Factors:  [96.71188084]
mat_Sqrt:  [[0.15]]
grads:  [0.03456742]
Stock Position:  0.03456742290847858
Bond Position:  [-9.90521663]


portfolio before change:  [-6.5773222]
curr_Stock_Price:  96.2904737933469
curr_Factors:  [96.29047379]
mat_Sqrt:  [[0.15]]
grads:  [-0.078712]
Stock Position:  -0.07871199601415793
Bond Position:  [1.00189319]


portfolio before change:  [-6.64341839]
curr_Stock_Price:  97.13099138359716
curr_Factors:  [97.13099138]
mat_Sqrt:  [[0.15]]
grads:  [-0.17324016]
Stock Position:  -0.1732401550542268
Bond Position:  [10.18356962]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.64341839]
Stock Price:  97.01758166726948
PL:  [-6.64341839]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-7.88281526e-02]
 [-5.12255305e-04]
 [ 3.42821619e-04]
 [ 2.15390281e-03]
 [ 1.20063344e-02]
 [ 1.04720192e-02]
 [ 1.20034315e-03]
 [ 1.29100496e-02]
 [ 1.74424854e-02]
 [-2.04086477e-02]
 [ 9.99312855e-03]
 [-6.39326024e-03]
 [ 1.16472908e-02]
 [ 4.25931539e-03]
 [ 5.30742165e-03]
 [-1.93213414e-03]
 [ 4.07710903e-03]
 [ 3.99297822e-03]
 [ 1.54673385e-02]
 [ 3.58769381e-03]
 [ 6.94250149e-02]
 [-1.28990512e-02]
 [ 7.66809226e-03]
 [ 8.36897543e-04]
 [ 1.38977225e-02]
 [-6.83675445e-03]
 [ 1.18752702e-02]
 [ 2.41174297e-03]
 [ 5.30084282e-03]
 [-1.90317317e-02]
 [-5.42343702e-03]
 [ 2.86887379e-02]
 [ 7.70867069e-03]
 [ 3.17099168e-03]
 [ 3.70495662e-03]
 [-4.31767966e-03]
 [-6.38682812e-03]
 [ 1.23906431e-02]
 [-1.27747187e-03]
 [-1.32035881e-02]
 [-2.48783077e-03]
 [-2.92661931e-03]
 [ 4.89493139e-03]
 [-1.17713789e-02]
 [ 2.94889989e-03]
 [-5.94888137e-04]
 [-1.37075305e-02]
 [-4.67344901e-03]
 [ 1.34950052e-04]
 [ 4.79447319e-03]
 [-2.98220262e-03]
 [ 3.80242728e-03]
 [ 1.49704650e-04]
 [ 9.45002981e-04]
 [ 1.17685797e-03]
 [ 8.56368378e-03]
 [-9.84808526e-03]
 [-1.29340003e-02]
 [ 1.43948058e-02]
 [ 5.23211401e-03]
 [ 9.82464394e-03]
 [-1.33527870e-02]
 [-1.26118025e-02]
 [-2.35332193e-03]
 [-1.75460890e-02]
 [-1.21285310e-03]
 [ 2.63587331e-02]
 [ 3.09284543e-03]
 [ 8.87343722e-03]
 [-1.77234673e-02]
 [-7.86399824e-03]
 [-7.81195343e-03]
 [ 2.30942924e-03]
 [ 7.47698466e-03]
 [-7.70131855e-04]
 [-1.14125691e-02]
 [ 4.54536445e-03]
 [-5.67330706e-03]
 [ 1.37002405e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.02954168]
curr_Stock_Price:  100.83314661743552
curr_Factors:  [100.83314662]
mat_Sqrt:  [[0.15]]
grads:  [-0.52552102]
Stock Position:  -0.5255210173031104
Bond Position:  [68.01947946]


portfolio before change:  [15.10699674]
curr_Stock_Price:  100.69384922109501
curr_Factors:  [100.69384922]
mat_Sqrt:  [[0.15]]
grads:  [-0.00341504]
Stock Position:  -0.003415035367153197
Bond Position:  [15.45086979]


portfolio before change:  [15.10855556]
curr_Stock_Price:  100.52017063757356
curr_Factors:  [100.52017064]
mat_Sqrt:  [[0.15]]
grads:  [0.00228548]
Stock Position:  0.0022854774592195497
Bond Position:  [14.87881898]


portfolio before change:  [15.10865258]
curr_Stock_Price:  100.15572140284843
curr_Factors:  [100.1557214]
mat_Sqrt:  [[0.15]]
grads:  [0.01435935]
Stock Position:  0.014359352069032745
Bond Position:  [13.67048131]


portfolio before change:  [15.10263451]
curr_Stock_Price:  99.67711370333673
curr_Factors:  [99.6771137]
mat_Sqrt:  [[0.15]]
grads:  [0.08004223]
Stock Position:  0.08004222900156145
Bond Position:  [7.12425615]


portfolio before change:  [15.08414103]
curr_Stock_Price:  99.44050404952648
curr_Factors:  [99.44050405]
mat_Sqrt:  [[0.15]]
grads:  [0.06981346]
Stock Position:  0.06981346150173308
Bond Position:  [8.14185523]


portfolio before change:  [15.13352465]
curr_Stock_Price:  100.14058015944019
curr_Factors:  [100.14058016]
mat_Sqrt:  [[0.15]]
grads:  [0.00800229]
Stock Position:  0.008002287693718626
Bond Position:  [14.33217092]


portfolio before change:  [15.12897109]
curr_Stock_Price:  99.45960689514662
curr_Factors:  [99.4596069]
mat_Sqrt:  [[0.15]]
grads:  [0.086067]
Stock Position:  0.08606699747166471
Bond Position:  [6.56878136]


portfolio before change:  [15.12992166]
curr_Stock_Price:  99.4658811500233
curr_Factors:  [99.46588115]
mat_Sqrt:  [[0.15]]
grads:  [0.11628324]
Stock Position:  0.11628323605491048
Bond Position:  [3.56370712]


portfolio before change:  [15.27599954]
curr_Stock_Price:  100.72019039994679
curr_Factors:  [100.7201904]
mat_Sqrt:  [[0.15]]
grads:  [-0.13605765]
Stock Position:  -0.1360576510395081
Bond Position:  [28.97975206]


portfolio before change:  [15.35425347]
curr_Stock_Price:  100.15835028893466
curr_Factors:  [100.15835029]
mat_Sqrt:  [[0.15]]
grads:  [0.06662086]
Stock Position:  0.06662085701465917
Bond Position:  [8.68161834]


portfolio before change:  [15.38704856]
curr_Stock_Price:  100.64246991386636
curr_Factors:  [100.64246991]
mat_Sqrt:  [[0.15]]
grads:  [-0.04262173]
Stock Position:  -0.042621734931438546
Bond Position:  [19.67660523]


portfolio before change:  [15.35864085]
curr_Stock_Price:  101.3378319142028
curr_Factors:  [101.33783191]
mat_Sqrt:  [[0.15]]
grads:  [0.07764861]
Stock Position:  0.07764860560520477
Bond Position:  [7.48989951]


portfolio before change:  [15.27446465]
curr_Stock_Price:  100.24773725680433
curr_Factors:  [100.24773726]
mat_Sqrt:  [[0.15]]
grads:  [0.02839544]
Stock Position:  0.028395435904292384
Bond Position:  [12.42788645]


portfolio before change:  [15.26793102]
curr_Stock_Price:  99.99028743238541
curr_Factors:  [99.99028743]
mat_Sqrt:  [[0.15]]
grads:  [0.03538281]
Stock Position:  0.03538281101135038
Bond Position:  [11.72999358]


portfolio before change:  [15.27577799]
curr_Stock_Price:  100.19134042210686
curr_Factors:  [100.19134042]
mat_Sqrt:  [[0.15]]
grads:  [-0.01288089]
Stock Position:  -0.012880894253353715
Bond Position:  [16.56633205]


portfolio before change:  [15.28324389]
curr_Stock_Price:  99.69211475464198
curr_Factors:  [99.69211475]
mat_Sqrt:  [[0.15]]
grads:  [0.02718073]
Stock Position:  0.02718072684432496
Bond Position:  [12.57353975]


portfolio before change:  [15.24962245]
curr_Stock_Price:  98.42624320928489
curr_Factors:  [98.42624321]
mat_Sqrt:  [[0.15]]
grads:  [0.02661985]
Stock Position:  0.026619854826844126
Bond Position:  [12.62953014]


portfolio before change:  [15.25711132]
curr_Stock_Price:  98.6779161703324
curr_Factors:  [98.67791617]
mat_Sqrt:  [[0.15]]
grads:  [0.10311559]
Stock Position:  0.10311559007278716
Bond Position:  [5.08187976]


portfolio before change:  [15.4202922]
curr_Stock_Price:  100.25734034562251
curr_Factors:  [100.25734035]
mat_Sqrt:  [[0.15]]
grads:  [0.02391796]
Stock Position:  0.023917958731101575
Bond Position:  [13.02234127]


portfolio before change:  [15.44388468]
curr_Stock_Price:  101.20970253657237
curr_Factors:  [101.20970254]
mat_Sqrt:  [[0.15]]
grads:  [0.46283343]
Stock Position:  0.4628334325701026
Bond Position:  [-31.39934935]


portfolio before change:  [15.74804917]
curr_Stock_Price:  101.87112193713149
curr_Factors:  [101.87112194]
mat_Sqrt:  [[0.15]]
grads:  [-0.08599367]
Stock Position:  -0.08599367478141451
Bond Position:  [24.5083213]


portfolio before change:  [15.76908118]
curr_Stock_Price:  101.64435890762023
curr_Factors:  [101.64435891]
mat_Sqrt:  [[0.15]]
grads:  [0.05112062]
Stock Position:  0.051120615063623705
Bond Position:  [10.57295903]


portfolio before change:  [15.74821609]
curr_Stock_Price:  101.22327803860823
curr_Factors:  [101.22327804]
mat_Sqrt:  [[0.15]]
grads:  [0.00557932]
Stock Position:  0.0055793169528033214
Bond Position:  [15.18345934]


portfolio before change:  [15.74426942]
curr_Stock_Price:  100.34580974923017
curr_Factors:  [100.34580975]
mat_Sqrt:  [[0.15]]
grads:  [0.09265148]
Stock Position:  0.09265148334697838
Bond Position:  [6.4470813]


portfolio before change:  [15.7581161]
curr_Stock_Price:  100.49090967931335
curr_Factors:  [100.49090968]
mat_Sqrt:  [[0.15]]
grads:  [-0.04557836]
Stock Position:  -0.04557836298749031
Bond Position:  [20.33832725]


portfolio before change:  [15.71697028]
curr_Stock_Price:  101.42154866590694
curr_Factors:  [101.42154867]
mat_Sqrt:  [[0.15]]
grads:  [0.07916847]
Stock Position:  0.07916846794740794
Bond Position:  [7.68758165]


portfolio before change:  [15.72201653]
curr_Stock_Price:  101.47922018286785
curr_Factors:  [101.47922018]
mat_Sqrt:  [[0.15]]
grads:  [0.01607829]
Stock Position:  0.016078286464389843
Bond Position:  [14.09040456]


portfolio before change:  [15.73160387]
curr_Stock_Price:  102.02073683240766
curr_Factors:  [102.02073683]
mat_Sqrt:  [[0.15]]
grads:  [0.03533895]
Stock Position:  0.03533895212485643
Bond Position:  [12.12629794]


portfolio before change:  [15.73423178]
curr_Stock_Price:  102.07365272328312
curr_Factors:  [102.07365272]
mat_Sqrt:  [[0.15]]
grads:  [-0.12687821]
Stock Position:  -0.12687821124161278
Bond Position:  [28.68515425]


portfolio before change:  [15.79615514]
curr_Stock_Price:  101.59972990598119
curr_Factors:  [101.59972991]
mat_Sqrt:  [[0.15]]
grads:  [-0.03615625]
Stock Position:  -0.03615624677593173
Bond Position:  [19.46962005]


portfolio before change:  [15.78433353]
curr_Stock_Price:  101.96034530086654
curr_Factors:  [101.9603453]
mat_Sqrt:  [[0.15]]
grads:  [0.19125825]
Stock Position:  0.19125825242667563
Bond Position:  [-3.71642393]


portfolio before change:  [15.69491178]
curr_Stock_Price:  101.4940152632681
curr_Factors:  [101.49401526]
mat_Sqrt:  [[0.15]]
grads:  [0.05139114]
Stock Position:  0.051391137951160376
Bond Position:  [10.47901884]


portfolio before change:  [15.71397836]
curr_Stock_Price:  101.85227982358644
curr_Factors:  [101.85227982]
mat_Sqrt:  [[0.15]]
grads:  [0.02113994]
Stock Position:  0.021139944535098553
Bond Position:  [13.56082681]


portfolio before change:  [15.69418586]
curr_Stock_Price:  100.87592521094984
curr_Factors:  [100.87592521]
mat_Sqrt:  [[0.15]]
grads:  [0.02469971]
Stock Position:  0.024699710778138068
Bond Position:  [13.20257968]


portfolio before change:  [15.69674689]
curr_Stock_Price:  100.94620321232496
curr_Factors:  [100.94620321]
mat_Sqrt:  [[0.15]]
grads:  [-0.02878453]
Stock Position:  -0.028784531093930168
Bond Position:  [18.60243601]


portfolio before change:  [15.69665006]
curr_Stock_Price:  100.98996001079925
curr_Factors:  [100.98996001]
mat_Sqrt:  [[0.15]]
grads:  [-0.04257885]
Stock Position:  -0.04257885414259102
Bond Position:  [19.99668684]


portfolio before change:  [15.73469536]
curr_Stock_Price:  100.12578764205941
curr_Factors:  [100.12578764]
mat_Sqrt:  [[0.15]]
grads:  [0.08260429]
Stock Position:  0.08260428713436246
Bond Position:  [7.46387605]


portfolio before change:  [15.71775192]
curr_Stock_Price:  99.9150244419852
curr_Factors:  [99.91502444]
mat_Sqrt:  [[0.15]]
grads:  [-0.00851648]
Stock Position:  -0.008516479155627862
Bond Position:  [16.56867615]


portfolio before change:  [15.7151276]
curr_Stock_Price:  100.34476792299746
curr_Factors:  [100.34476792]
mat_Sqrt:  [[0.15]]
grads:  [-0.08802392]
Stock Position:  -0.08802392079404514
Bond Position:  [24.5478675]


portfolio before change:  [15.68991149]
curr_Stock_Price:  100.64866712103318
curr_Factors:  [100.64866712]
mat_Sqrt:  [[0.15]]
grads:  [-0.01658554]
Stock Position:  -0.016585538445240203
Bond Position:  [17.35922382]


portfolio before change:  [15.69642227]
curr_Stock_Price:  100.32152676936526
curr_Factors:  [100.32152677]
mat_Sqrt:  [[0.15]]
grads:  [-0.0195108]
Stock Position:  -0.01951079539998457
Bond Position:  [17.65377505]


portfolio before change:  [15.71168917]
curr_Stock_Price:  99.59559532528748
curr_Factors:  [99.59559533]
mat_Sqrt:  [[0.15]]
grads:  [0.03263288]
Stock Position:  0.032632875948127645
Bond Position:  [12.46159846]


portfolio before change:  [15.73020116]
curr_Stock_Price:  100.13900810914664
curr_Factors:  [100.13900811]
mat_Sqrt:  [[0.15]]
grads:  [-0.07847586]
Stock Position:  -0.07847585916601794
Bond Position:  [23.58869586]


portfolio before change:  [15.74955427]
curr_Stock_Price:  99.91118303451384
curr_Factors:  [99.91118303]
mat_Sqrt:  [[0.15]]
grads:  [0.01965933]
Stock Position:  0.01965933257574483
Bond Position:  [13.78536709]


portfolio before change:  [15.75594101]
curr_Stock_Price:  100.19222641225997
curr_Factors:  [100.19222641]
mat_Sqrt:  [[0.15]]
grads:  [-0.00396592]
Stock Position:  -0.003965920915208398
Bond Position:  [16.15329545]


portfolio before change:  [15.75524141]
curr_Stock_Price:  100.62319982957649
curr_Factors:  [100.62319983]
mat_Sqrt:  [[0.15]]
grads:  [-0.09138354]
Stock Position:  -0.09138353647229551
Bond Position:  [24.95054527]


portfolio before change:  [15.68136155]
curr_Stock_Price:  101.44872401522254
curr_Factors:  [101.44872402]
mat_Sqrt:  [[0.15]]
grads:  [-0.03115633]
Stock Position:  -0.031156326751674446
Bond Position:  [18.84213115]


portfolio before change:  [15.70150337]
curr_Stock_Price:  100.84004677627101
curr_Factors:  [100.84004678]
mat_Sqrt:  [[0.15]]
grads:  [0.00089967]
Stock Position:  0.0008996670114341524
Bond Position:  [15.61078091]


portfolio before change:  [15.70235824]
curr_Stock_Price:  100.70574299788824
curr_Factors:  [100.705743]
mat_Sqrt:  [[0.15]]
grads:  [0.03196315]
Stock Position:  0.03196315458393699
Bond Position:  [12.48348501]


portfolio before change:  [15.68953875]
curr_Stock_Price:  100.28026116852146
curr_Factors:  [100.28026117]
mat_Sqrt:  [[0.15]]
grads:  [-0.01988135]
Stock Position:  -0.01988135080632617
Bond Position:  [17.6832458]


portfolio before change:  [15.67887635]
curr_Stock_Price:  100.8721540457463
curr_Factors:  [100.87215405]
mat_Sqrt:  [[0.15]]
grads:  [0.02534952]
Stock Position:  0.02534951522323122
Bond Position:  [13.12181615]


portfolio before change:  [15.68098463]
curr_Stock_Price:  100.92296910783737
curr_Factors:  [100.92296911]
mat_Sqrt:  [[0.15]]
grads:  [0.00099803]
Stock Position:  0.0009980309967819439
Bond Position:  [15.58026038]


portfolio before change:  [15.68232011]
curr_Stock_Price:  101.28536804721818
curr_Factors:  [101.28536805]
mat_Sqrt:  [[0.15]]
grads:  [0.00630002]
Stock Position:  0.006300019872929963
Bond Position:  [15.04422028]


portfolio before change:  [15.685522]
curr_Stock_Price:  101.64435098504713
curr_Factors:  [101.64435099]
mat_Sqrt:  [[0.15]]
grads:  [0.00784572]
Stock Position:  0.007845719800949218
Bond Position:  [14.88804891]


portfolio before change:  [15.69000052]
curr_Stock_Price:  102.09656948357323
curr_Factors:  [102.09656948]
mat_Sqrt:  [[0.15]]
grads:  [0.05709123]
Stock Position:  0.05709122522703443
Bond Position:  [9.86118227]


portfolio before change:  [15.68817427]
curr_Stock_Price:  102.05378552032954
curr_Factors:  [102.05378552]
mat_Sqrt:  [[0.15]]
grads:  [-0.0656539]
Stock Position:  -0.06565390173038636
Bond Position:  [22.38840348]


portfolio before change:  [15.66143387]
curr_Stock_Price:  102.48239242937856
curr_Factors:  [102.48239243]
mat_Sqrt:  [[0.15]]
grads:  [-0.08622667]
Stock Position:  -0.08622666867209577
Bond Position:  [24.49814917]


portfolio before change:  [15.63995227]
curr_Stock_Price:  102.74927950937158
curr_Factors:  [102.74927951]
mat_Sqrt:  [[0.15]]
grads:  [0.09596537]
Stock Position:  0.09596537180772795
Bond Position:  [5.77957946]


portfolio before change:  [15.52577062]
curr_Stock_Price:  101.5556938660583
curr_Factors:  [101.55569387]
mat_Sqrt:  [[0.15]]
grads:  [0.03488076]
Stock Position:  0.03488076006204782
Bond Position:  [11.98343083]


portfolio before change:  [15.51691952]
curr_Stock_Price:  101.28046819392398
curr_Factors:  [101.28046819]
mat_Sqrt:  [[0.15]]
grads:  [0.06549763]
Stock Position:  0.065497626275247
Bond Position:  [8.88328927]


portfolio before change:  [15.52288975]
curr_Stock_Price:  101.36314300212715
curr_Factors:  [101.363143]
mat_Sqrt:  [[0.15]]
grads:  [-0.08901858]
Stock Position:  -0.08901858023594081
Bond Position:  [24.54609283]


portfolio before change:  [15.51527243]
curr_Stock_Price:  101.46594735847837
curr_Factors:  [101.46594736]
mat_Sqrt:  [[0.15]]
grads:  [-0.08407868]
Stock Position:  -0.0840786831437606
Bond Position:  [24.04639567]


portfolio before change:  [15.54215621]
curr_Stock_Price:  101.1640773173397
curr_Factors:  [101.16407732]
mat_Sqrt:  [[0.15]]
grads:  [-0.01568881]
Stock Position:  -0.015688812856125424
Bond Position:  [17.12930049]


portfolio before change:  [15.53765941]
curr_Stock_Price:  101.51894292355354
curr_Factors:  [101.51894292]
mat_Sqrt:  [[0.15]]
grads:  [-0.11697393]
Stock Position:  -0.11697392642777654
Bond Position:  [27.41272877]


portfolio before change:  [15.46556301]
curr_Stock_Price:  102.14993604230943
curr_Factors:  [102.14993604]
mat_Sqrt:  [[0.15]]
grads:  [-0.00808569]
Stock Position:  -0.008085687321231544
Bond Position:  [16.29151546]


portfolio before change:  [15.45895022]
curr_Stock_Price:  103.09370754036726
curr_Factors:  [103.09370754]
mat_Sqrt:  [[0.15]]
grads:  [0.17572489]
Stock Position:  0.17572488735679515
Bond Position:  [-2.65717992]


portfolio before change:  [15.47596686]
curr_Stock_Price:  103.19148941938201
curr_Factors:  [103.19148942]
mat_Sqrt:  [[0.15]]
grads:  [0.02061897]
Stock Position:  0.02061896954287893
Bond Position:  [13.34826468]


portfolio before change:  [15.48235822]
curr_Stock_Price:  103.46100181552265
curr_Factors:  [103.46100182]
mat_Sqrt:  [[0.15]]
grads:  [0.05915625]
Stock Position:  0.05915624815316352
Bond Position:  [9.36199352]


portfolio before change:  [15.45774759]
curr_Stock_Price:  103.03508284050332
curr_Factors:  [103.03508284]
mat_Sqrt:  [[0.15]]
grads:  [-0.11815645]
Stock Position:  -0.1181564486572675
Bond Position:  [27.63200707]


portfolio before change:  [15.55894282]
curr_Stock_Price:  102.19324831655295
curr_Factors:  [102.19324832]
mat_Sqrt:  [[0.15]]
grads:  [-0.05242665]
Stock Position:  -0.05242665490809917
Bond Position:  [20.91659299]


portfolio before change:  [15.56473499]
curr_Stock_Price:  102.10770336050375
curr_Factors:  [102.10770336]
mat_Sqrt:  [[0.15]]
grads:  [-0.05207969]
Stock Position:  -0.05207968954374356
Bond Position:  [20.88247248]


portfolio before change:  [15.54027843]
curr_Stock_Price:  102.6023635689411
curr_Factors:  [102.60236357]
mat_Sqrt:  [[0.15]]
grads:  [0.01539619]
Stock Position:  0.015396194902415637
Bond Position:  [13.96059244]


portfolio before change:  [15.5472109]
curr_Stock_Price:  102.9959610993697
curr_Factors:  [102.9959611]
mat_Sqrt:  [[0.15]]
grads:  [0.04984656]
Stock Position:  0.049846564393671154
Bond Position:  [10.41321609]


portfolio before change:  [15.55115158]
curr_Stock_Price:  103.06196030042796
curr_Factors:  [103.0619603]
mat_Sqrt:  [[0.15]]
grads:  [-0.00513421]
Stock Position:  -0.005134212367196925
Bond Position:  [16.08029357]


portfolio before change:  [15.5523434]
curr_Stock_Price:  103.02558254805399
curr_Factors:  [103.02558255]
mat_Sqrt:  [[0.15]]
grads:  [-0.07608379]
Stock Position:  -0.07608379413613173
Bond Position:  [23.39092061]


portfolio before change:  [15.62725278]
curr_Stock_Price:  102.06023368586165
curr_Factors:  [102.06023369]
mat_Sqrt:  [[0.15]]
grads:  [0.03030243]
Stock Position:  0.030302429685804256
Bond Position:  [12.53457973]


portfolio before change:  [15.61825944]
curr_Stock_Price:  101.73759365747081
curr_Factors:  [101.73759366]
mat_Sqrt:  [[0.15]]
grads:  [-0.03782205]
Stock Position:  -0.037822047053772415
Bond Position:  [19.4661835]


portfolio before change:  [15.62388281]
curr_Stock_Price:  101.62108242836024
curr_Factors:  [101.62108243]
mat_Sqrt:  [[0.15]]
grads:  [0.09133494]
Stock Position:  0.09133493666322696
Bond Position:  [6.34232768]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.62388281]
Stock Price:  101.2092540089416
PL:  [14.4146288]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-6.61712841e-02]
 [ 3.36938276e-03]
 [ 9.31302680e-03]
 [ 3.00986014e-03]
 [ 1.54990956e-02]
 [ 1.11219999e-02]
 [ 1.10873738e-03]
 [ 1.29973647e-02]
 [ 1.74099425e-02]
 [-1.90174496e-02]
 [ 7.54641134e-03]
 [-7.01207666e-03]
 [ 4.83310093e-03]
 [ 4.15026035e-03]
 [ 2.66858601e-03]
 [-9.20309480e-03]
 [ 1.14560498e-02]
 [ 2.39810030e-02]
 [ 1.82508808e-02]
 [-1.45474764e-04]
 [ 7.56933896e-02]
 [-1.29760781e-02]
 [ 3.99304076e-03]
 [ 1.28228050e-02]
 [ 1.34013905e-02]
 [-4.33160188e-03]
 [ 1.39247247e-02]
 [-8.48422924e-03]
 [ 2.28679968e-03]
 [-1.27644107e-02]
 [-3.75673589e-03]
 [ 2.99573712e-03]
 [ 1.45111044e-02]
 [ 1.46638984e-02]
 [-1.77069836e-02]
 [ 6.90180577e-03]
 [-2.46588548e-03]
 [ 3.79327114e-03]
 [ 2.31951205e-03]
 [-1.37271038e-02]
 [-1.78326345e-03]
 [-2.71148104e-03]
 [ 3.85199297e-03]
 [-8.54189078e-03]
 [ 2.55123449e-03]
 [-2.21572356e-03]
 [-1.37075226e-02]
 [-4.86397914e-03]
 [-1.68475068e-05]
 [ 3.12309120e-03]
 [-3.19550859e-03]
 [ 3.44202219e-03]
 [ 1.33509710e-03]
 [ 2.37511814e-03]
 [-6.90341484e-03]
 [ 1.03643158e-02]
 [-5.02152962e-03]
 [-7.60063900e-03]
 [ 1.54269607e-02]
 [-5.02465748e-04]
 [ 1.29793016e-02]
 [-1.52483491e-02]
 [-1.27455214e-02]
 [-3.21066983e-03]
 [-1.56922723e-02]
 [-1.90065307e-02]
 [ 2.50854402e-02]
 [ 3.29434220e-03]
 [ 7.96242383e-03]
 [-1.84778337e-02]
 [-7.77286974e-03]
 [-7.62134224e-03]
 [ 2.64681038e-03]
 [ 7.28425975e-03]
 [-8.84265628e-04]
 [-5.45811139e-03]
 [ 7.69254699e-03]
 [-4.93355421e-03]
 [ 1.32455110e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.92485549]
curr_Stock_Price:  100.6336063881555
curr_Factors:  [100.63360639]
mat_Sqrt:  [[0.15]]
grads:  [-0.44114189]
Stock Position:  -0.44114189425461064
Bond Position:  [56.31855523]


portfolio before change:  [11.54512995]
curr_Stock_Price:  101.50236439672686
curr_Factors:  [101.5023644]
mat_Sqrt:  [[0.15]]
grads:  [0.02246255]
Stock Position:  0.02246255170448272
Bond Position:  [9.26512784]


portfolio before change:  [11.54697132]
curr_Stock_Price:  101.55855944916114
curr_Factors:  [101.55855945]
mat_Sqrt:  [[0.15]]
grads:  [0.06208685]
Stock Position:  0.06208684534441554
Bond Position:  [5.24152075]


portfolio before change:  [11.54166558]
curr_Stock_Price:  101.46782609176255
curr_Factors:  [101.46782609]
mat_Sqrt:  [[0.15]]
grads:  [0.02006573]
Stock Position:  0.02006573426598207
Bond Position:  [9.50563915]


portfolio before change:  [11.51617303]
curr_Stock_Price:  100.16776513523182
curr_Factors:  [100.16776514]
mat_Sqrt:  [[0.15]]
grads:  [0.1033273]
Stock Position:  0.10332730401626546
Bond Position:  [1.1661079]


portfolio before change:  [11.45593678]
curr_Stock_Price:  99.58409431527969
curr_Factors:  [99.58409432]
mat_Sqrt:  [[0.15]]
grads:  [0.07414667]
Stock Position:  0.07414666596300232
Bond Position:  [4.0721082]


portfolio before change:  [11.46436535]
curr_Stock_Price:  99.69433611018714
curr_Factors:  [99.69433611]
mat_Sqrt:  [[0.15]]
grads:  [0.00739158]
Stock Position:  0.007391582542930732
Bond Position:  [10.72746644]


portfolio before change:  [11.46439644]
curr_Stock_Price:  99.60783174162245
curr_Factors:  [99.60783174]
mat_Sqrt:  [[0.15]]
grads:  [0.0866491]
Stock Position:  0.08664909789652439
Bond Position:  [2.83346767]


portfolio before change:  [11.45453189]
curr_Stock_Price:  99.49194315626399
curr_Factors:  [99.49194316]
mat_Sqrt:  [[0.15]]
grads:  [0.11606628]
Stock Position:  0.11606628314490194
Bond Position:  [-0.09312815]


portfolio before change:  [11.46341131]
curr_Stock_Price:  99.56849629991537
curr_Factors:  [99.5684963]
mat_Sqrt:  [[0.15]]
grads:  [-0.126783]
Stock Position:  -0.12678299739864654
Bond Position:  [24.08700372]


portfolio before change:  [11.44890851]
curr_Stock_Price:  99.69476158000448
curr_Factors:  [99.69476158]
mat_Sqrt:  [[0.15]]
grads:  [0.05030941]
Stock Position:  0.050309408927311686
Bond Position:  [6.43332398]


portfolio before change:  [11.51102053]
curr_Stock_Price:  100.92136960640455
curr_Factors:  [100.92136961]
mat_Sqrt:  [[0.15]]
grads:  [-0.04674718]
Stock Position:  -0.046747177747782566
Bond Position:  [16.22880973]


portfolio before change:  [11.514326]
curr_Stock_Price:  100.87235816676657
curr_Factors:  [100.87235817]
mat_Sqrt:  [[0.15]]
grads:  [0.03222067]
Stock Position:  0.03222067289542687
Bond Position:  [8.26415075]


portfolio before change:  [11.5192959]
curr_Stock_Price:  101.01057279988976
curr_Factors:  [101.0105728]
mat_Sqrt:  [[0.15]]
grads:  [0.0276684]
Stock Position:  0.027668402350917692
Bond Position:  [8.72449473]


portfolio before change:  [11.52710783]
curr_Stock_Price:  101.27320590193794
curr_Factors:  [101.2732059]
mat_Sqrt:  [[0.15]]
grads:  [0.01779057]
Stock Position:  0.01779057339059316
Bond Position:  [9.72539943]


portfolio before change:  [11.52051631]
curr_Stock_Price:  100.8685318194861
curr_Factors:  [100.86853182]
mat_Sqrt:  [[0.15]]
grads:  [-0.06135397]
Stock Position:  -0.06135396533793118
Bond Position:  [17.70920071]


portfolio before change:  [11.48594196]
curr_Stock_Price:  101.45009502594067
curr_Factors:  [101.45009503]
mat_Sqrt:  [[0.15]]
grads:  [0.07637367]
Stock Position:  0.07637366537150223
Bond Position:  [3.73782635]


portfolio before change:  [11.50535354]
curr_Stock_Price:  101.70120207232584
curr_Factors:  [101.70120207]
mat_Sqrt:  [[0.15]]
grads:  [0.15987335]
Stock Position:  0.1598733534387965
Bond Position:  [-4.75395868]


portfolio before change:  [11.51297325]
curr_Stock_Price:  101.75072149837656
curr_Factors:  [101.7507215]
mat_Sqrt:  [[0.15]]
grads:  [0.12167254]
Stock Position:  0.12167253862787206
Bond Position:  [-0.86729534]


portfolio before change:  [11.48656822]
curr_Stock_Price:  101.53414985295105
curr_Factors:  [101.53414985]
mat_Sqrt:  [[0.15]]
grads:  [-0.00096983]
Stock Position:  -0.0009698317633248695
Bond Position:  [11.58503926]


portfolio before change:  [11.48789076]
curr_Stock_Price:  100.91708391424648
curr_Factors:  [100.91708391]
mat_Sqrt:  [[0.15]]
grads:  [0.5046226]
Stock Position:  0.5046225975402391
Bond Position:  [-39.43715026]


portfolio before change:  [11.8537053]
curr_Stock_Price:  101.64689555478425
curr_Factors:  [101.64689555]
mat_Sqrt:  [[0.15]]
grads:  [-0.08650719]
Stock Position:  -0.086507187483483
Bond Position:  [20.64689236]


portfolio before change:  [11.91264271]
curr_Stock_Price:  100.98051242579261
curr_Factors:  [100.98051243]
mat_Sqrt:  [[0.15]]
grads:  [0.02662027]
Stock Position:  0.026620271703881555
Bond Position:  [9.22451403]


portfolio before change:  [11.87933138]
curr_Stock_Price:  99.70750226028285
curr_Factors:  [99.70750226]
mat_Sqrt:  [[0.15]]
grads:  [0.08548537]
Stock Position:  0.0854853667057072
Bond Position:  [3.35579899]


portfolio before change:  [11.91632032]
curr_Stock_Price:  100.13774196614459
curr_Factors:  [100.13774197]
mat_Sqrt:  [[0.15]]
grads:  [0.0893426]
Stock Position:  0.08934260321488016
Bond Position:  [2.96975378]


portfolio before change:  [11.87838422]
curr_Stock_Price:  99.71105061838385
curr_Factors:  [99.71105062]
mat_Sqrt:  [[0.15]]
grads:  [-0.02887735]
Stock Position:  -0.028877345885815985
Bond Position:  [14.75777472]


portfolio before change:  [11.86983296]
curr_Stock_Price:  100.03911575579679
curr_Factors:  [100.03911576]
mat_Sqrt:  [[0.15]]
grads:  [0.0928315]
Stock Position:  0.0928314981083165
Bond Position:  [2.58305198]


portfolio before change:  [11.79314648]
curr_Stock_Price:  99.21129410390043
curr_Factors:  [99.2112941]
mat_Sqrt:  [[0.15]]
grads:  [-0.05656153]
Stock Position:  -0.0565615282468245
Bond Position:  [17.4046889]


portfolio before change:  [11.8040278]
curr_Stock_Price:  99.0381466335015
curr_Factors:  [99.03814663]
mat_Sqrt:  [[0.15]]
grads:  [0.01524533]
Stock Position:  0.015245331228870049
Bond Position:  [10.29415845]


portfolio before change:  [11.80424144]
curr_Stock_Price:  99.00995726249914
curr_Factors:  [99.00995726]
mat_Sqrt:  [[0.15]]
grads:  [-0.08509607]
Stock Position:  -0.08509607115989795
Bond Position:  [20.22959981]


portfolio before change:  [11.82208247]
curr_Stock_Price:  98.8151581502211
curr_Factors:  [98.81515815]
mat_Sqrt:  [[0.15]]
grads:  [-0.02504491]
Stock Position:  -0.025044905931814986
Bond Position:  [14.29689881]


portfolio before change:  [11.79525771]
curr_Stock_Price:  99.92190403311643
curr_Factors:  [99.92190403]
mat_Sqrt:  [[0.15]]
grads:  [0.01997158]
Stock Position:  0.019971580784515035
Bond Position:  [9.79965933]


portfolio before change:  [11.79618201]
curr_Stock_Price:  99.93751650111437
curr_Factors:  [99.9375165]
mat_Sqrt:  [[0.15]]
grads:  [0.0967407]
Stock Position:  0.09674069602482002
Bond Position:  [2.12815711]


portfolio before change:  [11.62374893]
curr_Stock_Price:  98.15371598936443
curr_Factors:  [98.15371599]
mat_Sqrt:  [[0.15]]
grads:  [0.09775932]
Stock Position:  0.0977593224092143
Bond Position:  [2.02830816]


portfolio before change:  [11.62360125]
curr_Stock_Price:  98.15090863418902
curr_Factors:  [98.15090863]
mat_Sqrt:  [[0.15]]
grads:  [-0.11804656]
Stock Position:  -0.11804655707185466
Bond Position:  [23.20997809]


portfolio before change:  [11.62194772]
curr_Stock_Price:  98.17720507522425
curr_Factors:  [98.17720508]
mat_Sqrt:  [[0.15]]
grads:  [0.04601204]
Stock Position:  0.046012038435463525
Bond Position:  [7.10461438]


portfolio before change:  [11.63005498]
curr_Stock_Price:  98.34375291800797
curr_Factors:  [98.34375292]
mat_Sqrt:  [[0.15]]
grads:  [-0.01643924]
Stock Position:  -0.01643923654513963
Bond Position:  [13.24675119]


portfolio before change:  [11.64256327]
curr_Stock_Price:  97.63323675000633
curr_Factors:  [97.63323675]
mat_Sqrt:  [[0.15]]
grads:  [0.02528847]
Stock Position:  0.025288474240007984
Bond Position:  [9.17356767]


portfolio before change:  [11.67277498]
curr_Stock_Price:  98.80524676742631
curr_Factors:  [98.80524677]
mat_Sqrt:  [[0.15]]
grads:  [0.01546341]
Stock Position:  0.015463413672240876
Bond Position:  [10.14490857]


portfolio before change:  [11.68156354]
curr_Stock_Price:  99.33258704484332
curr_Factors:  [99.33258704]
mat_Sqrt:  [[0.15]]
grads:  [-0.09151403]
Stock Position:  -0.09151402516772797
Bond Position:  [20.77188841]


portfolio before change:  [11.66506981]
curr_Stock_Price:  99.52700540785176
curr_Factors:  [99.52700541]
mat_Sqrt:  [[0.15]]
grads:  [-0.01188842]
Stock Position:  -0.01188842303090539
Bond Position:  [12.84828896]


portfolio before change:  [11.66551898]
curr_Stock_Price:  99.55677168312478
curr_Factors:  [99.55677168]
mat_Sqrt:  [[0.15]]
grads:  [-0.01807654]
Stock Position:  -0.018076540282641464
Bond Position:  [13.46516098]


portfolio before change:  [11.67648913]
curr_Stock_Price:  98.99645709725064
curr_Factors:  [98.9964571]
mat_Sqrt:  [[0.15]]
grads:  [0.02567995]
Stock Position:  0.02567995315263282
Bond Position:  [9.13426475]


portfolio before change:  [11.67621832]
curr_Stock_Price:  98.9636797739868
curr_Factors:  [98.96367977]
mat_Sqrt:  [[0.15]]
grads:  [-0.05694594]
Stock Position:  -0.05694593850763192
Bond Position:  [17.31179794]


portfolio before change:  [11.66177957]
curr_Stock_Price:  99.23623252173262
curr_Factors:  [99.23623252]
mat_Sqrt:  [[0.15]]
grads:  [0.01700823]
Stock Position:  0.01700822992521944
Bond Position:  [9.97394691]


portfolio before change:  [11.66856143]
curr_Stock_Price:  99.59832025577735
curr_Factors:  [99.59832026]
mat_Sqrt:  [[0.15]]
grads:  [-0.01477149]
Stock Position:  -0.014771490403680532
Bond Position:  [13.13977706]


portfolio before change:  [11.65401445]
curr_Stock_Price:  100.63871944450815
curr_Factors:  [100.63871944]
mat_Sqrt:  [[0.15]]
grads:  [-0.09138348]
Stock Position:  -0.09138348388047153
Bond Position:  [20.85073124]


portfolio before change:  [11.61403248]
curr_Stock_Price:  101.09049882096618
curr_Factors:  [101.09049882]
mat_Sqrt:  [[0.15]]
grads:  [-0.03242653]
Stock Position:  -0.03242652758135161
Bond Position:  [14.89204633]


portfolio before change:  [11.62080134]
curr_Stock_Price:  100.91045888919848
curr_Factors:  [100.91045889]
mat_Sqrt:  [[0.15]]
grads:  [-0.00011232]
Stock Position:  -0.0001123167120702746
Bond Position:  [11.63213527]


portfolio before change:  [11.62151903]
curr_Stock_Price:  100.99355772035263
curr_Factors:  [100.99355772]
mat_Sqrt:  [[0.15]]
grads:  [0.02082061]
Stock Position:  0.020820608032907237
Bond Position:  [9.51877175]


portfolio before change:  [11.64573718]
curr_Stock_Price:  102.1281646780334
curr_Factors:  [102.12816468]
mat_Sqrt:  [[0.15]]
grads:  [-0.02130339]
Stock Position:  -0.021303390567449305
Bond Position:  [13.82141336]


portfolio before change:  [11.6232086]
curr_Stock_Price:  103.22622673944178
curr_Factors:  [103.22622674]
mat_Sqrt:  [[0.15]]
grads:  [0.02294681]
Stock Position:  0.022946814600689206
Bond Position:  [9.25449552]


portfolio before change:  [11.61313302]
curr_Stock_Price:  102.76193543383302
curr_Factors:  [102.76193543]
mat_Sqrt:  [[0.15]]
grads:  [0.00890065]
Stock Position:  0.0089006473382141
Bond Position:  [10.69848527]


portfolio before change:  [11.61980559]
curr_Stock_Price:  103.43648069385641
curr_Factors:  [103.43648069]
mat_Sqrt:  [[0.15]]
grads:  [0.01583412]
Stock Position:  0.015834120905191346
Bond Position:  [9.98197984]


portfolio before change:  [11.62821726]
curr_Stock_Price:  103.92831593598794
curr_Factors:  [103.92831594]
mat_Sqrt:  [[0.15]]
grads:  [-0.04602277]
Stock Position:  -0.046022765624951875
Bond Position:  [16.41128578]


portfolio before change:  [11.62643182]
curr_Stock_Price:  103.98939812040436
curr_Factors:  [103.98939812]
mat_Sqrt:  [[0.15]]
grads:  [0.06909544]
Stock Position:  0.06909543848033177
Bond Position:  [4.44123876]


portfolio before change:  [11.58001813]
curr_Stock_Price:  103.31364756335044
curr_Factors:  [103.31364756]
mat_Sqrt:  [[0.15]]
grads:  [-0.03347686]
Stock Position:  -0.03347686410425535
Bond Position:  [15.03863507]


portfolio before change:  [11.54622595]
curr_Stock_Price:  104.35114384075797
curr_Factors:  [104.35114384]
mat_Sqrt:  [[0.15]]
grads:  [-0.05067093]
Stock Position:  -0.05067092665257264
Bond Position:  [16.83379511]


portfolio before change:  [11.59568526]
curr_Stock_Price:  103.39581952025362
curr_Factors:  [103.39581952]
mat_Sqrt:  [[0.15]]
grads:  [0.1028464]
Stock Position:  0.10284640485138145
Bond Position:  [0.96179695]


portfolio before change:  [11.64570204]
curr_Stock_Price:  103.88155997685233
curr_Factors:  [103.88155998]
mat_Sqrt:  [[0.15]]
grads:  [-0.00334977]
Stock Position:  -0.0033497716547376856
Bond Position:  [11.99368154]


portfolio before change:  [11.64515287]
curr_Stock_Price:  104.2692865191666
curr_Factors:  [104.26928652]
mat_Sqrt:  [[0.15]]
grads:  [0.08652868]
Stock Position:  0.08652867736892651
Bond Position:  [2.62286942]


portfolio before change:  [11.57266437]
curr_Stock_Price:  103.42965236381167
curr_Factors:  [103.42965236]
mat_Sqrt:  [[0.15]]
grads:  [-0.10165566]
Stock Position:  -0.10165566085910203
Bond Position:  [22.08687404]


portfolio before change:  [11.58885751]
curr_Stock_Price:  103.28393822470512
curr_Factors:  [103.28393822]
mat_Sqrt:  [[0.15]]
grads:  [-0.08497014]
Stock Position:  -0.08497014268130024
Bond Position:  [20.36490848]


portfolio before change:  [11.60057597]
curr_Stock_Price:  103.16100545621522
curr_Factors:  [103.16100546]
mat_Sqrt:  [[0.15]]
grads:  [-0.02140447]
Stock Position:  -0.02140446553250012
Bond Position:  [13.80868216]


portfolio before change:  [11.60989308]
curr_Stock_Price:  102.76603962323725
curr_Factors:  [102.76603962]
mat_Sqrt:  [[0.15]]
grads:  [-0.10461515]
Stock Position:  -0.10461514869828319
Bond Position:  [22.36077759]


portfolio before change:  [11.56764783]
curr_Stock_Price:  103.18321476648039
curr_Factors:  [103.18321477]
mat_Sqrt:  [[0.15]]
grads:  [-0.1267102]
Stock Position:  -0.12671020489138857
Bond Position:  [24.64201411]


portfolio before change:  [11.55629359]
curr_Stock_Price:  103.28497780574732
curr_Factors:  [103.28497781]
mat_Sqrt:  [[0.15]]
grads:  [0.16723627]
Stock Position:  0.16723626778942335
Bond Position:  [-5.71670062]


portfolio before change:  [11.57010546]
curr_Stock_Price:  103.36970330352437
curr_Factors:  [103.3697033]
mat_Sqrt:  [[0.15]]
grads:  [0.02196228]
Stock Position:  0.021962281324372435
Bond Position:  [9.29987095]


portfolio before change:  [11.56204772]
curr_Stock_Price:  102.97634714166279
curr_Factors:  [102.97634714]
mat_Sqrt:  [[0.15]]
grads:  [0.05308283]
Stock Position:  0.05308282550514869
Bond Position:  [6.09577225]


portfolio before change:  [11.57384558]
curr_Stock_Price:  103.1914235176933
curr_Factors:  [103.19142352]
mat_Sqrt:  [[0.15]]
grads:  [-0.12318556]
Stock Position:  -0.12318555816747116
Bond Position:  [24.28553868]


portfolio before change:  [11.61362833]
curr_Stock_Price:  102.88079575474264
curr_Factors:  [102.88079575]
mat_Sqrt:  [[0.15]]
grads:  [-0.05181913]
Stock Position:  -0.051819131571663755
Bond Position:  [16.94482182]


portfolio before change:  [11.60055176]
curr_Stock_Price:  103.15358405571398
curr_Factors:  [103.15358406]
mat_Sqrt:  [[0.15]]
grads:  [-0.05080895]
Stock Position:  -0.050808948271379516
Bond Position:  [16.84167688]


portfolio before change:  [11.62293178]
curr_Stock_Price:  102.73382768971985
curr_Factors:  [102.73382769]
mat_Sqrt:  [[0.15]]
grads:  [0.0176454]
Stock Position:  0.017645402530348308
Bond Position:  [9.81015203]


portfolio before change:  [11.63305693]
curr_Stock_Price:  103.27289154623212
curr_Factors:  [103.27289155]
mat_Sqrt:  [[0.15]]
grads:  [0.04856173]
Stock Position:  0.04856173164098854
Bond Position:  [6.61794648]


portfolio before change:  [11.65171695]
curr_Stock_Price:  103.64862736662779
curr_Factors:  [103.64862737]
mat_Sqrt:  [[0.15]]
grads:  [-0.0058951]
Stock Position:  -0.0058951041853258675
Bond Position:  [12.2627364]


portfolio before change:  [11.65117667]
curr_Stock_Price:  103.87028856254426
curr_Factors:  [103.87028856]
mat_Sqrt:  [[0.15]]
grads:  [-0.03638741]
Stock Position:  -0.036387409259704344
Bond Position:  [15.43074737]


portfolio before change:  [11.65854651]
curr_Stock_Price:  103.69425547679441
curr_Factors:  [103.69425548]
mat_Sqrt:  [[0.15]]
grads:  [0.05128365]
Stock Position:  0.05128364656846879
Bond Position:  [6.34072697]


portfolio before change:  [11.58286646]
curr_Stock_Price:  102.21081262845067
curr_Factors:  [102.21081263]
mat_Sqrt:  [[0.15]]
grads:  [-0.03289036]
Stock Position:  -0.032890361392441746
Bond Position:  [14.94461703]


portfolio before change:  [11.60714793]
curr_Stock_Price:  101.50095726935788
curr_Factors:  [101.50095727]
mat_Sqrt:  [[0.15]]
grads:  [0.08830341]
Stock Position:  0.08830340688871281
Bond Position:  [2.6442676]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.60714793]
Stock Price:  102.21226429224048
PL:  [9.39488364]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.36129897e-02]
 [ 7.42927574e-04]
 [ 3.06018556e-03]
 [ 2.93011550e-03]
 [ 6.23612854e-03]
 [ 1.21838671e-02]
 [-8.84542284e-04]
 [ 1.24602705e-02]
 [-1.19273297e-02]
 [-3.93259945e-03]
 [ 1.01224771e-02]
 [-8.67800739e-03]
 [ 2.20302155e-02]
 [ 1.49890245e-02]
 [-7.92182469e-03]
 [-7.69187547e-03]
 [ 1.27017087e-02]
 [ 2.17771734e-02]
 [-8.12114658e-03]
 [-3.50348102e-03]
 [ 2.56954396e-02]
 [-1.10703644e-02]
 [-1.10684153e-03]
 [ 2.97887771e-03]
 [ 1.80016744e-02]
 [ 1.52739643e-02]
 [ 7.11530983e-03]
 [ 2.87423362e-03]
 [ 8.84563864e-03]
 [-1.29524135e-02]
 [-5.70378198e-03]
 [ 3.41353159e-02]
 [ 7.59823685e-03]
 [-5.33971879e-04]
 [-2.44852062e-04]
 [-4.47438249e-03]
 [-6.55854728e-03]
 [ 4.90822723e-03]
 [ 7.72287679e-04]
 [-8.71212436e-03]
 [-2.50600860e-02]
 [-2.41405237e-03]
 [ 1.16034131e-02]
 [-1.24986974e-02]
 [ 7.31784081e-04]
 [ 2.29083612e-03]
 [-1.36324975e-02]
 [ 7.65964847e-04]
 [ 2.93642596e-03]
 [-7.02720198e-04]
 [-2.98571370e-03]
 [ 3.72158285e-03]
 [ 4.58888202e-04]
 [ 3.41724529e-03]
 [-5.06130318e-03]
 [ 9.70573546e-03]
 [-1.00722551e-02]
 [-8.84950032e-03]
 [ 1.66525787e-02]
 [ 1.50327151e-03]
 [ 1.17833667e-02]
 [-1.52417778e-02]
 [-1.27180835e-02]
 [-3.04080052e-03]
 [ 1.23519956e-02]
 [-1.78817195e-02]
 [ 2.52727534e-02]
 [ 3.33986717e-03]
 [ 8.05404016e-03]
 [-1.54313058e-02]
 [-7.80922746e-03]
 [-7.70975204e-03]
 [ 2.55608864e-03]
 [ 7.65374287e-03]
 [ 1.18849421e-03]
 [-1.07845451e-02]
 [ 6.67489459e-03]
 [-4.32578669e-03]
 [ 2.33397696e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.86025076]
curr_Stock_Price:  100.24383024231749
curr_Factors:  [100.24383024]
mat_Sqrt:  [[0.15]]
grads:  [-0.29075326]
Stock Position:  -0.2907532644056849
Bond Position:  [35.00647164]


portfolio before change:  [5.65583791]
curr_Stock_Price:  100.95440121291605
curr_Factors:  [100.95440121]
mat_Sqrt:  [[0.15]]
grads:  [0.00495285]
Stock Position:  0.004952850490250498
Bond Position:  [5.15582585]


portfolio before change:  [5.65641117]
curr_Stock_Price:  101.00508262635171
curr_Factors:  [101.00508263]
mat_Sqrt:  [[0.15]]
grads:  [0.02040124]
Stock Position:  0.020401237049750085
Bond Position:  [3.59578254]


portfolio before change:  [5.66436619]
curr_Stock_Price:  101.38399482794097
curr_Factors:  [101.38399483]
mat_Sqrt:  [[0.15]]
grads:  [0.0195341]
Stock Position:  0.019534103328337684
Bond Position:  [3.68392076]


portfolio before change:  [5.66706449]
curr_Stock_Price:  101.51034043349844
curr_Factors:  [101.51034043]
mat_Sqrt:  [[0.15]]
grads:  [0.04157419]
Stock Position:  0.04157419028297944
Bond Position:  [1.44685428]


portfolio before change:  [5.67816345]
curr_Stock_Price:  101.7751326455667
curr_Factors:  [101.77513265]
mat_Sqrt:  [[0.15]]
grads:  [0.08122578]
Stock Position:  0.08122578083660545
Bond Position:  [-2.58860117]


portfolio before change:  [5.7345421]
curr_Stock_Price:  102.47122252721356
curr_Factors:  [102.47122253]
mat_Sqrt:  [[0.15]]
grads:  [-0.00589695]
Stock Position:  -0.0058969485581386715
Bond Position:  [6.33880963]


portfolio before change:  [5.73608813]
curr_Stock_Price:  102.27623294999997
curr_Factors:  [102.27623295]
mat_Sqrt:  [[0.15]]
grads:  [0.08306847]
Stock Position:  0.08306846966787003
Bond Position:  [-2.75984203]


portfolio before change:  [5.73064378]
curr_Stock_Price:  102.21276905059007
curr_Factors:  [102.21276905]
mat_Sqrt:  [[0.15]]
grads:  [-0.07951553]
Stock Position:  -0.0795155315897177
Bond Position:  [13.85814645]


portfolio before change:  [5.75337213]
curr_Stock_Price:  101.93782671169707
curr_Factors:  [101.93782671]
mat_Sqrt:  [[0.15]]
grads:  [-0.02621733]
Stock Position:  -0.02621732967283734
Bond Position:  [8.42590974]


portfolio before change:  [5.77161065]
curr_Stock_Price:  101.26224746226029
curr_Factors:  [101.26224746]
mat_Sqrt:  [[0.15]]
grads:  [0.06748318]
Stock Position:  0.06748318061871106
Bond Position:  [-1.06188788]


portfolio before change:  [5.79344669]
curr_Stock_Price:  101.5868084037169
curr_Factors:  [101.5868084]
mat_Sqrt:  [[0.15]]
grads:  [-0.05785338]
Stock Position:  -0.05785338263104941
Bond Position:  [11.67058718]


portfolio before change:  [5.76004199]
curr_Stock_Price:  102.17681934119696
curr_Factors:  [102.17681934]
mat_Sqrt:  [[0.15]]
grads:  [0.1468681]
Stock Position:  0.14686810318265336
Bond Position:  [-9.24647365]


portfolio before change:  [5.83273238]
curr_Stock_Price:  102.67569083641908
curr_Factors:  [102.67569084]
mat_Sqrt:  [[0.15]]
grads:  [0.09992683]
Stock Position:  0.09992683028391158
Bond Position:  [-4.42732395]


portfolio before change:  [5.86579251]
curr_Stock_Price:  103.00930342411702
curr_Factors:  [103.00930342]
mat_Sqrt:  [[0.15]]
grads:  [-0.05281216]
Stock Position:  -0.0528121646036447
Bond Position:  [11.3059368]


portfolio before change:  [5.84845959]
curr_Stock_Price:  103.35088320351716
curr_Factors:  [103.3508832]
mat_Sqrt:  [[0.15]]
grads:  [-0.05127917]
Stock Position:  -0.05127916979295183
Bond Position:  [11.14820708]


portfolio before change:  [5.85475345]
curr_Stock_Price:  103.24173398271596
curr_Factors:  [103.24173398]
mat_Sqrt:  [[0.15]]
grads:  [0.08467806]
Stock Position:  0.08467805798590522
Bond Position:  [-2.88755608]


portfolio before change:  [5.90106036]
curr_Stock_Price:  103.79072369332984
curr_Factors:  [103.79072369]
mat_Sqrt:  [[0.15]]
grads:  [0.14518116]
Stock Position:  0.14518115631773912
Bond Position:  [-9.16739692]


portfolio before change:  [5.90102254]
curr_Stock_Price:  103.79440987367929
curr_Factors:  [103.79440987]
mat_Sqrt:  [[0.15]]
grads:  [-0.05414098]
Stock Position:  -0.05414097722161682
Bond Position:  [11.52055332]


portfolio before change:  [5.90830704]
curr_Stock_Price:  103.67316268194095
curr_Factors:  [103.67316268]
mat_Sqrt:  [[0.15]]
grads:  [-0.02335654]
Stock Position:  -0.023356540138602007
Bond Position:  [8.32975343]


portfolio before change:  [5.91607538]
curr_Stock_Price:  103.36285486256837
curr_Factors:  [103.36285486]
mat_Sqrt:  [[0.15]]
grads:  [0.17130293]
Stock Position:  0.1713029304722541
Bond Position:  [-11.79028456]


portfolio before change:  [5.88183816]
curr_Stock_Price:  103.16729308853024
curr_Factors:  [103.16729309]
mat_Sqrt:  [[0.15]]
grads:  [-0.07380243]
Stock Position:  -0.07380242959053565
Bond Position:  [13.49583505]


portfolio before change:  [5.84101402]
curr_Stock_Price:  103.73187688577144
curr_Factors:  [103.73187689]
mat_Sqrt:  [[0.15]]
grads:  [-0.00737894]
Stock Position:  -0.007378943532581883
Bond Position:  [6.60644569]


portfolio before change:  [5.83951859]
curr_Stock_Price:  103.99049771507524
curr_Factors:  [103.99049772]
mat_Sqrt:  [[0.15]]
grads:  [0.01985918]
Stock Position:  0.01985918471720264
Bond Position:  [3.77435209]


portfolio before change:  [5.83252909]
curr_Stock_Price:  103.62666570124026
curr_Factors:  [103.6266657]
mat_Sqrt:  [[0.15]]
grads:  [0.12001116]
Stock Position:  0.12001116254271751
Bond Position:  [-6.60382753]


portfolio before change:  [5.90889372]
curr_Stock_Price:  104.26641770202504
curr_Factors:  [104.2664177]
mat_Sqrt:  [[0.15]]
grads:  [0.10182643]
Stock Position:  0.10182642866522629
Bond Position:  [-4.70818323]


portfolio before change:  [5.93078007]
curr_Stock_Price:  104.48424549892938
curr_Factors:  [104.4842455]
mat_Sqrt:  [[0.15]]
grads:  [0.0474354]
Stock Position:  0.047435398889258865
Bond Position:  [0.97452821]


portfolio before change:  [5.92914302]
curr_Stock_Price:  104.44845016157063
curr_Factors:  [104.44845016]
mat_Sqrt:  [[0.15]]
grads:  [0.01916156]
Stock Position:  0.01916155744011265
Bond Position:  [3.92774804]


portfolio before change:  [5.92965793]
curr_Stock_Price:  104.46251058357024
curr_Factors:  [104.46251058]
mat_Sqrt:  [[0.15]]
grads:  [0.05897092]
Stock Position:  0.058970924289067875
Bond Position:  [-0.23059287]


portfolio before change:  [5.835399]
curr_Stock_Price:  102.86435834937318
curr_Factors:  [102.86435835]
mat_Sqrt:  [[0.15]]
grads:  [-0.08634942]
Stock Position:  -0.08634942330817927
Bond Position:  [14.71767702]


portfolio before change:  [5.84200968]
curr_Stock_Price:  102.79845404815407
curr_Factors:  [102.79845405]
mat_Sqrt:  [[0.15]]
grads:  [-0.03802521]
Stock Position:  -0.03802521321764069
Bond Position:  [9.75094282]


portfolio before change:  [5.85597128]
curr_Stock_Price:  102.44731472087422
curr_Factors:  [102.44731472]
mat_Sqrt:  [[0.15]]
grads:  [0.22756877]
Stock Position:  0.22756877245480053
Bond Position:  [-17.45783837]


portfolio before change:  [5.70749968]
curr_Stock_Price:  101.79968432555759
curr_Factors:  [101.79968433]
mat_Sqrt:  [[0.15]]
grads:  [0.05065491]
Stock Position:  0.05065491230030094
Bond Position:  [0.5508456]


portfolio before change:  [5.73308363]
curr_Stock_Price:  102.30406825651617
curr_Factors:  [102.30406826]
mat_Sqrt:  [[0.15]]
grads:  [-0.00355981]
Stock Position:  -0.0035598125274371546
Bond Position:  [6.09726694]


portfolio before change:  [5.73642842]
curr_Stock_Price:  101.47152565379889
curr_Factors:  [101.47152565]
mat_Sqrt:  [[0.15]]
grads:  [-0.00163235]
Stock Position:  -0.001632347077818036
Bond Position:  [5.90206517]


portfolio before change:  [5.73614025]
curr_Stock_Price:  101.874053170473
curr_Factors:  [101.87405317]
mat_Sqrt:  [[0.15]]
grads:  [-0.02982922]
Stock Position:  -0.029829216569733984
Bond Position:  [8.77496344]


portfolio before change:  [5.75845245]
curr_Stock_Price:  101.14444140276652
curr_Factors:  [101.1444414]
mat_Sqrt:  [[0.15]]
grads:  [-0.04372365]
Stock Position:  -0.04372364855688066
Bond Position:  [10.18085646]


portfolio before change:  [5.71811842]
curr_Stock_Price:  102.08147087850797
curr_Factors:  [102.08147088]
mat_Sqrt:  [[0.15]]
grads:  [0.03272151]
Stock Position:  0.032721514880291465
Bond Position:  [2.37785805]


portfolio before change:  [5.70779449]
curr_Stock_Price:  101.7614198070403
curr_Factors:  [101.76141981]
mat_Sqrt:  [[0.15]]
grads:  [0.00514858]
Stock Position:  0.005148584528546892
Bond Position:  [5.18386722]


portfolio before change:  [5.7096048]
curr_Stock_Price:  102.05010355057891
curr_Factors:  [102.05010355]
mat_Sqrt:  [[0.15]]
grads:  [-0.05808083]
Stock Position:  -0.05808082909967007
Bond Position:  [11.63675943]


portfolio before change:  [5.71575964]
curr_Stock_Price:  101.95665591895747
curr_Factors:  [101.95665592]
mat_Sqrt:  [[0.15]]
grads:  [-0.16706724]
Stock Position:  -0.1670672400740453
Bond Position:  [22.74937675]


portfolio before change:  [5.66340727]
curr_Stock_Price:  102.27852781012005
curr_Factors:  [102.27852781]
mat_Sqrt:  [[0.15]]
grads:  [-0.01609368]
Stock Position:  -0.016093682462539213
Bond Position:  [7.30944542]


portfolio before change:  [5.66291438]
curr_Stock_Price:  102.33754147157084
curr_Factors:  [102.33754147]
mat_Sqrt:  [[0.15]]
grads:  [0.07735609]
Stock Position:  0.07735608757684971
Bond Position:  [-2.25351744]


portfolio before change:  [5.61508903]
curr_Stock_Price:  101.72111301861253
curr_Factors:  [101.72111302]
mat_Sqrt:  [[0.15]]
grads:  [-0.08332465]
Stock Position:  -0.08332464925826573
Bond Position:  [14.0909651]


portfolio before change:  [5.61473569]
curr_Stock_Price:  101.73592330074399
curr_Factors:  [101.7359233]
mat_Sqrt:  [[0.15]]
grads:  [0.00487856]
Stock Position:  0.004878560539461598
Bond Position:  [5.11841082]


portfolio before change:  [5.61823536]
curr_Stock_Price:  102.38770667172824
curr_Factors:  [102.38770667]
mat_Sqrt:  [[0.15]]
grads:  [0.01527224]
Stock Position:  0.015272240795721481
Bond Position:  [4.05454565]


portfolio before change:  [5.62891576]
curr_Stock_Price:  103.07044779340166
curr_Factors:  [103.07044779]
mat_Sqrt:  [[0.15]]
grads:  [-0.09088332]
Stock Position:  -0.09088331680472764
Bond Position:  [14.99629992]


portfolio before change:  [5.67568213]
curr_Stock_Price:  102.56618508831313
curr_Factors:  [102.56618509]
mat_Sqrt:  [[0.15]]
grads:  [0.00510643]
Stock Position:  0.005106432312358232
Bond Position:  [5.15193485]


portfolio before change:  [5.67469908]
curr_Stock_Price:  102.31061322997293
curr_Factors:  [102.31061323]
mat_Sqrt:  [[0.15]]
grads:  [0.01957617]
Stock Position:  0.01957617306899348
Bond Position:  [3.6718488]


portfolio before change:  [5.66280071]
curr_Stock_Price:  101.69109142444557
curr_Factors:  [101.69109142]
mat_Sqrt:  [[0.15]]
grads:  [-0.0046848]
Stock Position:  -0.004684801321876425
Bond Position:  [6.13920327]


portfolio before change:  [5.6655891]
curr_Stock_Price:  101.17779632146768
curr_Factors:  [101.17779632]
mat_Sqrt:  [[0.15]]
grads:  [-0.01990476]
Stock Position:  -0.01990475797538838
Bond Position:  [7.67950865]


portfolio before change:  [5.65558173]
curr_Stock_Price:  101.70467339541578
curr_Factors:  [101.7046734]
mat_Sqrt:  [[0.15]]
grads:  [0.02481055]
Stock Position:  0.02481055235667168
Bond Position:  [3.1322326]


portfolio before change:  [5.66248382]
curr_Stock_Price:  101.97497438255056
curr_Factors:  [101.97497438]
mat_Sqrt:  [[0.15]]
grads:  [0.00305925]
Stock Position:  0.003059254680056675
Bond Position:  [5.3505164]


portfolio before change:  [5.66474431]
curr_Stock_Price:  102.60456356454567
curr_Factors:  [102.60456356]
mat_Sqrt:  [[0.15]]
grads:  [0.02278164]
Stock Position:  0.022781635262695065
Bond Position:  [3.32724456]


portfolio before change:  [5.68111818]
curr_Stock_Price:  103.31416633109913
curr_Factors:  [103.31416633]
mat_Sqrt:  [[0.15]]
grads:  [-0.03374202]
Stock Position:  -0.0337420211947626
Bond Position:  [9.16714697]


portfolio before change:  [5.67629677]
curr_Stock_Price:  103.47403742041186
curr_Factors:  [103.47403742]
mat_Sqrt:  [[0.15]]
grads:  [0.0647049]
Stock Position:  0.06470490303561918
Bond Position:  [-1.01898079]


portfolio before change:  [5.69654983]
curr_Stock_Price:  103.78802822527759
curr_Factors:  [103.78802823]
mat_Sqrt:  [[0.15]]
grads:  [-0.06714837]
Stock Position:  -0.06714836766315832
Bond Position:  [12.6657465]


portfolio before change:  [5.68499331]
curr_Stock_Price:  103.97192172657456
curr_Factors:  [103.97192173]
mat_Sqrt:  [[0.15]]
grads:  [-0.05899667]
Stock Position:  -0.05899666877584631
Bond Position:  [11.81899034]


portfolio before change:  [5.67442692]
curr_Stock_Price:  104.16354442928608
curr_Factors:  [104.16354443]
mat_Sqrt:  [[0.15]]
grads:  [0.11101719]
Stock Position:  0.11101719146717237
Bond Position:  [-5.88951724]


portfolio before change:  [5.56638938]
curr_Stock_Price:  103.19369971040092
curr_Factors:  [103.19369971]
mat_Sqrt:  [[0.15]]
grads:  [0.01002181]
Stock Position:  0.010021810056498477
Bond Position:  [4.53220172]


portfolio before change:  [5.56451467]
curr_Stock_Price:  102.97837156050916
curr_Factors:  [102.97837156]
mat_Sqrt:  [[0.15]]
grads:  [0.07855578]
Stock Position:  0.07855577783555312
Bond Position:  [-2.52503141]


portfolio before change:  [5.56058854]
curr_Stock_Price:  102.9304016686153
curr_Factors:  [102.93040167]
mat_Sqrt:  [[0.15]]
grads:  [-0.10161185]
Stock Position:  -0.1016118519142699
Bond Position:  [16.01953727]


portfolio before change:  [5.58353518]
curr_Stock_Price:  102.71442896933294
curr_Factors:  [102.71442897]
mat_Sqrt:  [[0.15]]
grads:  [-0.08478722]
Stock Position:  -0.08478722317139453
Bond Position:  [14.29240639]


portfolio before change:  [5.61070182]
curr_Stock_Price:  102.4045552117906
curr_Factors:  [102.40455521]
mat_Sqrt:  [[0.15]]
grads:  [-0.020272]
Stock Position:  -0.0202720034462104
Bond Position:  [7.68664731]


portfolio before change:  [5.58331812]
curr_Stock_Price:  103.77906790212468
curr_Factors:  [103.7790679]
mat_Sqrt:  [[0.15]]
grads:  [0.08234664]
Stock Position:  0.08234663748518323
Bond Position:  [-2.96253916]


portfolio before change:  [5.60399013]
curr_Stock_Price:  104.03235295141377
curr_Factors:  [104.03235295]
mat_Sqrt:  [[0.15]]
grads:  [-0.11921146]
Stock Position:  -0.11921146326143203
Bond Position:  [18.00583915]


portfolio before change:  [5.69772274]
curr_Stock_Price:  103.25552149851994
curr_Factors:  [103.2555215]
mat_Sqrt:  [[0.15]]
grads:  [0.16848502]
Stock Position:  0.16848502269083673
Bond Position:  [-11.69928614]


portfolio before change:  [5.72431654]
curr_Stock_Price:  103.41770223136061
curr_Factors:  [103.41770223]
mat_Sqrt:  [[0.15]]
grads:  [0.02226578]
Stock Position:  0.0222657811066958
Bond Position:  [3.42164062]


portfolio before change:  [5.71615963]
curr_Stock_Price:  103.041754413548
curr_Factors:  [103.04175441]
mat_Sqrt:  [[0.15]]
grads:  [0.0536936]
Stock Position:  0.05369360109056413
Bond Position:  [0.18347677]


portfolio before change:  [5.69030599]
curr_Stock_Price:  102.56003772297484
curr_Factors:  [102.56003772]
mat_Sqrt:  [[0.15]]
grads:  [-0.10287537]
Stock Position:  -0.10287537170865482
Bond Position:  [16.24120799]


portfolio before change:  [5.68728133]
curr_Stock_Price:  102.59930622555187
curr_Factors:  [102.59930623]
mat_Sqrt:  [[0.15]]
grads:  [-0.05206152]
Stock Position:  -0.05206151641702953
Bond Position:  [11.0287568]


portfolio before change:  [5.66823888]
curr_Stock_Price:  102.97831496721086
curr_Factors:  [102.97831497]
mat_Sqrt:  [[0.15]]
grads:  [-0.05139835]
Stock Position:  -0.05139834694079769
Bond Position:  [10.96115404]


portfolio before change:  [5.68330719]
curr_Stock_Price:  102.69847700641986
curr_Factors:  [102.69847701]
mat_Sqrt:  [[0.15]]
grads:  [0.01704059]
Stock Position:  0.017040590920458475
Bond Position:  [3.93326445]


portfolio before change:  [5.68429423]
curr_Stock_Price:  102.741973541231
curr_Factors:  [102.74197354]
mat_Sqrt:  [[0.15]]
grads:  [0.05102495]
Stock Position:  0.05102495245886139
Bond Position:  [0.44188991]


portfolio before change:  [5.66225786]
curr_Stock_Price:  102.3095578143672
curr_Factors:  [102.30955781]
mat_Sqrt:  [[0.15]]
grads:  [0.00792329]
Stock Position:  0.007923294722944573
Bond Position:  [4.85162908]


portfolio before change:  [5.66894027]
curr_Stock_Price:  103.11467473153364
curr_Factors:  [103.11467473]
mat_Sqrt:  [[0.15]]
grads:  [-0.07189697]
Stock Position:  -0.07189696754294923
Bond Position:  [13.08257269]


portfolio before change:  [5.66679306]
curr_Stock_Price:  103.15591290882486
curr_Factors:  [103.15591291]
mat_Sqrt:  [[0.15]]
grads:  [0.0444993]
Stock Position:  0.04449929723417008
Bond Position:  [1.07642743]


portfolio before change:  [5.64315187]
curr_Stock_Price:  102.62313004538761
curr_Factors:  [102.62313005]
mat_Sqrt:  [[0.15]]
grads:  [-0.02883858]
Stock Position:  -0.02883857793252271
Bond Position:  [8.60265701]


portfolio before change:  [5.6289674]
curr_Stock_Price:  103.13363237717796
curr_Factors:  [103.13363238]
mat_Sqrt:  [[0.15]]
grads:  [0.15559846]
Stock Position:  0.15559846426950458
Bond Position:  [-10.41846742]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.6289674]
Stock Price:  103.4126733311694
PL:  [2.21629406]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.71749741e-02]
 [-1.65891682e-03]
 [ 1.17755987e-04]
 [ 2.17656447e-03]
 [ 2.65061623e-03]
 [ 1.20337218e-02]
 [ 8.05130671e-04]
 [ 1.29884533e-02]
 [ 7.19517888e-03]
 [-2.00348302e-02]
 [ 1.00843463e-02]
 [-7.90581406e-03]
 [ 8.68224087e-03]
 [ 6.24216787e-03]
 [ 9.89746778e-04]
 [-9.53731797e-03]
 [ 1.18428222e-02]
 [ 1.62927095e-02]
 [ 2.42525269e-02]
 [ 1.14381881e-02]
 [ 4.84977793e-02]
 [-1.78345497e-02]
 [-1.17324022e-03]
 [ 1.40532379e-02]
 [ 1.37556885e-02]
 [-7.85161065e-03]
 [ 1.27427090e-02]
 [-1.28442077e-02]
 [ 1.89106459e-03]
 [-5.38056733e-03]
 [-3.64315012e-03]
 [-1.78332342e-02]
 [ 1.80067819e-02]
 [ 1.03170651e-02]
 [-1.47573931e-02]
 [ 5.34598906e-03]
 [-2.30554555e-03]
 [ 1.11056965e-02]
 [ 9.97048406e-04]
 [-1.45482401e-02]
 [ 1.04738756e-02]
 [-2.30587740e-03]
 [ 3.52148399e-03]
 [-8.01565817e-03]
 [ 3.66979601e-04]
 [-8.60325392e-03]
 [-1.35412805e-02]
 [-7.10364026e-04]
 [-5.04885737e-03]
 [ 7.17604839e-03]
 [-3.38317915e-03]
 [ 3.21128217e-03]
 [ 3.10840604e-03]
 [ 1.83700011e-03]
 [ 2.04017061e-03]
 [ 8.96718431e-03]
 [ 1.29882117e-02]
 [-4.91385908e-05]
 [ 1.38289603e-02]
 [ 3.76717189e-03]
 [ 5.17478079e-03]
 [-1.45897182e-02]
 [-1.25501209e-02]
 [-1.92894816e-03]
 [-1.23953852e-02]
 [ 2.29632876e-02]
 [ 1.34150424e-02]
 [ 2.08232024e-03]
 [ 6.11420989e-03]
 [-1.44444288e-02]
 [-8.06976716e-03]
 [-3.10589363e-03]
 [ 2.05934177e-03]
 [ 7.67569346e-03]
 [ 2.53455257e-03]
 [-1.28875276e-02]
 [ 8.77694869e-03]
 [-3.82560563e-03]
 [ 2.48960845e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.52163111]
curr_Stock_Price:  100.09352561505295
curr_Factors:  [100.09352562]
mat_Sqrt:  [[0.15]]
grads:  [-0.24783316]
Stock Position:  -0.2478331606422458
Bond Position:  [28.32812593]


portfolio before change:  [3.43361208]
curr_Stock_Price:  100.45582419245741
curr_Factors:  [100.45582419]
mat_Sqrt:  [[0.15]]
grads:  [-0.01105945]
Stock Position:  -0.011059445440259223
Bond Position:  [4.54459778]


portfolio before change:  [3.43521852]
curr_Stock_Price:  100.33625256866347
curr_Factors:  [100.33625257]
mat_Sqrt:  [[0.15]]
grads:  [0.00078504]
Stock Position:  0.0007850399143886101
Bond Position:  [3.35645056]


portfolio before change:  [3.43541509]
curr_Stock_Price:  100.31942388203582
curr_Factors:  [100.31942388]
mat_Sqrt:  [[0.15]]
grads:  [0.01451043]
Stock Position:  0.014510429821253602
Bond Position:  [1.97973713]


portfolio before change:  [3.42348917]
curr_Stock_Price:  99.48901047928815
curr_Factors:  [99.48901048]
mat_Sqrt:  [[0.15]]
grads:  [0.01767077]
Stock Position:  0.017670774854375248
Bond Position:  [1.66544127]


portfolio before change:  [3.43454427]
curr_Stock_Price:  100.10873467997602
curr_Factors:  [100.10873468]
mat_Sqrt:  [[0.15]]
grads:  [0.08022481]
Stock Position:  0.08022481181402223
Bond Position:  [-4.59666013]


portfolio before change:  [3.39081909]
curr_Stock_Price:  99.56728267855799
curr_Factors:  [99.56728268]
mat_Sqrt:  [[0.15]]
grads:  [0.00536754]
Stock Position:  0.0053675378083485594
Bond Position:  [2.85638793]


portfolio before change:  [3.39099322]
curr_Stock_Price:  99.56646398745
curr_Factors:  [99.56646399]
mat_Sqrt:  [[0.15]]
grads:  [0.08658969]
Stock Position:  0.08658968883075588
Bond Position:  [-5.23043591]


portfolio before change:  [3.45780804]
curr_Stock_Price:  100.34186500046557
curr_Factors:  [100.341865]
mat_Sqrt:  [[0.15]]
grads:  [0.04796786]
Stock Position:  0.04796785917543563
Bond Position:  [-1.35537641]


portfolio before change:  [3.49212556]
curr_Stock_Price:  101.05905824415773
curr_Factors:  [101.05905824]
mat_Sqrt:  [[0.15]]
grads:  [-0.13356553]
Stock Position:  -0.13356553477702343
Bond Position:  [16.99013271]


portfolio before change:  [3.44161016]
curr_Stock_Price:  101.44521559732738
curr_Factors:  [101.4452156]
mat_Sqrt:  [[0.15]]
grads:  [0.06722898]
Stock Position:  0.06722897545132898
Bond Position:  [-3.37844775]


portfolio before change:  [3.43171834]
curr_Stock_Price:  101.30122026580857
curr_Factors:  [101.30122027]
mat_Sqrt:  [[0.15]]
grads:  [-0.05270543]
Stock Position:  -0.05270542705351098
Bond Position:  [8.77084242]


portfolio before change:  [3.44444222]
curr_Stock_Price:  101.0702063548937
curr_Factors:  [101.07020635]
mat_Sqrt:  [[0.15]]
grads:  [0.05788161]
Stock Position:  0.05788160580360559
Bond Position:  [-2.40566362]


portfolio before change:  [3.49392154]
curr_Stock_Price:  101.92764077826742
curr_Factors:  [101.92764078]
mat_Sqrt:  [[0.15]]
grads:  [0.04161445]
Stock Position:  0.04161445248952043
Bond Position:  [-0.74774142]


portfolio before change:  [3.4780743]
curr_Stock_Price:  101.54795272554082
curr_Factors:  [101.54795273]
mat_Sqrt:  [[0.15]]
grads:  [0.00659831]
Stock Position:  0.006598311855274044
Bond Position:  [2.80802924]


portfolio before change:  [3.47412837]
curr_Stock_Price:  100.92333285810592
curr_Factors:  [100.92333286]
mat_Sqrt:  [[0.15]]
grads:  [-0.06358212]
Stock Position:  -0.06358211976724658
Bond Position:  [9.89104781]


portfolio before change:  [3.51640066]
curr_Stock_Price:  100.26821037366659
curr_Factors:  [100.26821037]
mat_Sqrt:  [[0.15]]
grads:  [0.07895215]
Stock Position:  0.07895214790094063
Bond Position:  [-4.39998992]


portfolio before change:  [3.55921335]
curr_Stock_Price:  100.813954938408
curr_Factors:  [100.81395494]
mat_Sqrt:  [[0.15]]
grads:  [0.10861806]
Stock Position:  0.10861806338688193
Bond Position:  [-7.39100319]


portfolio before change:  [3.43040154]
curr_Stock_Price:  99.63229270455842
curr_Factors:  [99.6322927]
mat_Sqrt:  [[0.15]]
grads:  [0.16168351]
Stock Position:  0.16168351254170027
Bond Position:  [-12.67849751]


portfolio before change:  [3.33330852]
curr_Stock_Price:  99.0366810281421
curr_Factors:  [99.03668103]
mat_Sqrt:  [[0.15]]
grads:  [0.07625459]
Stock Position:  0.07625458730888475
Bond Position:  [-4.21869272]


portfolio before change:  [3.32584074]
curr_Stock_Price:  98.94220666191673
curr_Factors:  [98.94220666]
mat_Sqrt:  [[0.15]]
grads:  [0.32331853]
Stock Position:  0.3233185286745957
Bond Position:  [-28.66400794]


portfolio before change:  [3.31386145]
curr_Stock_Price:  98.91069676878345
curr_Factors:  [98.91069677]
mat_Sqrt:  [[0.15]]
grads:  [-0.118897]
Stock Position:  -0.11889699806676794
Bond Position:  [15.07404637]


portfolio before change:  [3.32921518]
curr_Stock_Price:  98.78948620540393
curr_Factors:  [98.78948621]
mat_Sqrt:  [[0.15]]
grads:  [-0.0078216]
Stock Position:  -0.00782160143404599
Bond Position:  [4.10190717]


portfolio before change:  [3.32864128]
curr_Stock_Price:  98.89563757122042
curr_Factors:  [98.89563757]
mat_Sqrt:  [[0.15]]
grads:  [0.09368825]
Stock Position:  0.0936882528728635
Bond Position:  [-5.93671822]


portfolio before change:  [3.45855592]
curr_Stock_Price:  100.28626753183613
curr_Factors:  [100.28626753]
mat_Sqrt:  [[0.15]]
grads:  [0.09170459]
Stock Position:  0.09170458970859545
Bond Position:  [-5.7381551]


portfolio before change:  [3.45157913]
curr_Stock_Price:  100.21409947972985
curr_Factors:  [100.21409948]
mat_Sqrt:  [[0.15]]
grads:  [-0.05234407]
Stock Position:  -0.05234407096984639
Bond Position:  [8.69719307]


portfolio before change:  [3.5224437]
curr_Stock_Price:  98.87066223534906
curr_Factors:  [98.87066224]
mat_Sqrt:  [[0.15]]
grads:  [0.08495139]
Stock Position:  0.08495139305221013
Bond Position:  [-4.87675679]


portfolio before change:  [3.50694022]
curr_Stock_Price:  98.69175205522443
curr_Factors:  [98.69175206]
mat_Sqrt:  [[0.15]]
grads:  [-0.08562805]
Stock Position:  -0.08562805125055198
Bond Position:  [11.95772262]


portfolio before change:  [3.52321518]
curr_Stock_Price:  98.51041452155476
curr_Factors:  [98.51041452]
mat_Sqrt:  [[0.15]]
grads:  [0.0126071]
Stock Position:  0.01260709726906308
Bond Position:  [2.2812848]


portfolio before change:  [3.51578998]
curr_Stock_Price:  97.91013504514387
curr_Factors:  [97.91013505]
mat_Sqrt:  [[0.15]]
grads:  [-0.03587045]
Stock Position:  -0.03587044888342764
Bond Position:  [7.02787048]


portfolio before change:  [3.50440837]
curr_Stock_Price:  98.23967833506687
curr_Factors:  [98.23967834]
mat_Sqrt:  [[0.15]]
grads:  [-0.02428767]
Stock Position:  -0.024287667472521486
Bond Position:  [5.89042101]


portfolio before change:  [3.51060358]
curr_Stock_Price:  97.99976072945448
curr_Factors:  [97.99976073]
mat_Sqrt:  [[0.15]]
grads:  [-0.11888823]
Stock Position:  -0.1188882281198976
Bond Position:  [15.16162148]


portfolio before change:  [3.5264729]
curr_Stock_Price:  97.87425046212374
curr_Factors:  [97.87425046]
mat_Sqrt:  [[0.15]]
grads:  [0.12004521]
Stock Position:  0.12004521280888493
Bond Position:  [-8.22286233]


portfolio before change:  [3.50680737]
curr_Stock_Price:  97.71471401706785
curr_Factors:  [97.71471402]
mat_Sqrt:  [[0.15]]
grads:  [0.06878043]
Stock Position:  0.06878043399125801
Bond Position:  [-3.21405307]


portfolio before change:  [3.5769222]
curr_Stock_Price:  98.73703555275371
curr_Factors:  [98.73703555]
mat_Sqrt:  [[0.15]]
grads:  [-0.09838262]
Stock Position:  -0.09838262036691595
Bond Position:  [13.29093049]


portfolio before change:  [3.55587593]
curr_Stock_Price:  98.95940182868837
curr_Factors:  [98.95940183]
mat_Sqrt:  [[0.15]]
grads:  [0.03563993]
Stock Position:  0.03563992708574082
Bond Position:  [0.02897007]


portfolio before change:  [3.55317579]
curr_Stock_Price:  98.88358926362329
curr_Factors:  [98.88358926]
mat_Sqrt:  [[0.15]]
grads:  [-0.0153703]
Stock Position:  -0.015370303699994894
Bond Position:  [5.07304659]


portfolio before change:  [3.5535476]
curr_Stock_Price:  98.8800285743566
curr_Factors:  [98.88002857]
mat_Sqrt:  [[0.15]]
grads:  [0.07403798]
Stock Position:  0.07403797665330088
Bond Position:  [-3.76732965]


portfolio before change:  [3.57975385]
curr_Stock_Price:  99.23716578278162
curr_Factors:  [99.23716578]
mat_Sqrt:  [[0.15]]
grads:  [0.00664699]
Stock Position:  0.006646989373749711
Bond Position:  [2.92012546]


portfolio before change:  [3.57395564]
curr_Stock_Price:  98.33740181793732
curr_Factors:  [98.33740182]
mat_Sqrt:  [[0.15]]
grads:  [-0.09698827]
Stock Position:  -0.09698826759712433
Bond Position:  [13.11152988]


portfolio before change:  [3.52540435]
curr_Stock_Price:  98.8464404978551
curr_Factors:  [98.8464405]
mat_Sqrt:  [[0.15]]
grads:  [0.06982584]
Stock Position:  0.06982583721976221
Bond Position:  [-3.37663111]


portfolio before change:  [3.55408758]
curr_Stock_Price:  99.26024535517442
curr_Factors:  [99.26024536]
mat_Sqrt:  [[0.15]]
grads:  [-0.01537252]
Stock Position:  -0.015372515972981143
Bond Position:  [5.07996729]


portfolio before change:  [3.56121585]
curr_Stock_Price:  98.81719738301094
curr_Factors:  [98.81719738]
mat_Sqrt:  [[0.15]]
grads:  [0.02347656]
Stock Position:  0.023476559946703085
Bond Position:  [1.24132799]


portfolio before change:  [3.54908622]
curr_Stock_Price:  98.29722273157377
curr_Factors:  [98.29722273]
mat_Sqrt:  [[0.15]]
grads:  [-0.05343772]
Stock Position:  -0.053437721136764885
Bond Position:  [8.8018658]


portfolio before change:  [3.60940377]
curr_Stock_Price:  97.17877282514915
curr_Factors:  [97.17877283]
mat_Sqrt:  [[0.15]]
grads:  [0.00244653]
Stock Position:  0.0024465306702256364
Bond Position:  [3.37165292]


portfolio before change:  [3.60866001]
curr_Stock_Price:  96.78863316309318
curr_Factors:  [96.78863316]
mat_Sqrt:  [[0.15]]
grads:  [-0.05735503]
Stock Position:  -0.057355026109762244
Bond Position:  [9.1599746]


portfolio before change:  [3.57520128]
curr_Stock_Price:  97.38197696342081
curr_Factors:  [97.38197696]
mat_Sqrt:  [[0.15]]
grads:  [-0.0902752]
Stock Position:  -0.09027520325305827
Bond Position:  [12.36637904]


portfolio before change:  [3.57155395]
curr_Stock_Price:  97.43094113194489
curr_Factors:  [97.43094113]
mat_Sqrt:  [[0.15]]
grads:  [-0.00473576]
Stock Position:  -0.004735760170781686
Bond Position:  [4.03296352]


portfolio before change:  [3.57048123]
curr_Stock_Price:  97.71068300597406
curr_Factors:  [97.71068301]
mat_Sqrt:  [[0.15]]
grads:  [-0.03365905]
Stock Position:  -0.03365904913310496
Bond Position:  [6.85932991]


portfolio before change:  [3.55514226]
curr_Stock_Price:  98.17913615002243
curr_Factors:  [98.17913615]
mat_Sqrt:  [[0.15]]
grads:  [0.04784032]
Stock Position:  0.04784032259638814
Bond Position:  [-1.14177928]


portfolio before change:  [3.5317596]
curr_Stock_Price:  97.69186312129547
curr_Factors:  [97.69186312]
mat_Sqrt:  [[0.15]]
grads:  [-0.02255453]
Stock Position:  -0.022554527654752167
Bond Position:  [5.73515343]


portfolio before change:  [3.51585588]
curr_Stock_Price:  98.41287932610685
curr_Factors:  [98.41287933]
mat_Sqrt:  [[0.15]]
grads:  [0.02140855]
Stock Position:  0.021408547786724467
Bond Position:  [1.40897905]


portfolio before change:  [3.50755064]
curr_Stock_Price:  98.02082522485782
curr_Factors:  [98.02082522]
mat_Sqrt:  [[0.15]]
grads:  [0.02072271]
Stock Position:  0.020722706916473356
Bond Position:  [1.4762938]


portfolio before change:  [3.51245026]
curr_Stock_Price:  98.25281024660039
curr_Factors:  [98.25281025]
mat_Sqrt:  [[0.15]]
grads:  [0.01224667]
Stock Position:  0.012246667373917693
Bond Position:  [2.30918078]


portfolio before change:  [3.5129731]
curr_Stock_Price:  98.2837172945723
curr_Factors:  [98.28371729]
mat_Sqrt:  [[0.15]]
grads:  [0.01360114]
Stock Position:  0.013601137388242283
Bond Position:  [2.17620276]


portfolio before change:  [3.50859521]
curr_Stock_Price:  97.95184007471775
curr_Factors:  [97.95184007]
mat_Sqrt:  [[0.15]]
grads:  [0.05978123]
Stock Position:  0.059781228703977285
Bond Position:  [-2.34708614]


portfolio before change:  [3.49480872]
curr_Stock_Price:  97.72367833785408
curr_Factors:  [97.72367834]
mat_Sqrt:  [[0.15]]
grads:  [0.08658808]
Stock Position:  0.08658807803574718
Bond Position:  [-4.96689676]


portfolio before change:  [3.47317846]
curr_Stock_Price:  97.47745711899714
curr_Factors:  [97.47745712]
mat_Sqrt:  [[0.15]]
grads:  [-0.00032759]
Stock Position:  -0.0003275906051926174
Bond Position:  [3.50511116]


portfolio before change:  [3.47308434]
curr_Stock_Price:  98.43353215771435
curr_Factors:  [98.43353216]
mat_Sqrt:  [[0.15]]
grads:  [0.09219307]
Stock Position:  0.09219306882715432
Bond Position:  [-5.60180507]


portfolio before change:  [3.50257319]
curr_Stock_Price:  98.7571896896555
curr_Factors:  [98.75718969]
mat_Sqrt:  [[0.15]]
grads:  [0.02511448]
Stock Position:  0.025114479237862208
Bond Position:  [1.0223378]


portfolio before change:  [3.50744814]
curr_Stock_Price:  98.94875436755828
curr_Factors:  [98.94875437]
mat_Sqrt:  [[0.15]]
grads:  [0.03449854]
Stock Position:  0.034498538603511535
Bond Position:  [0.09386072]


portfolio before change:  [3.48952544]
curr_Stock_Price:  98.42906380658489
curr_Factors:  [98.42906381]
mat_Sqrt:  [[0.15]]
grads:  [-0.09726479]
Stock Position:  -0.09726478821096571
Bond Position:  [13.06320749]


portfolio before change:  [3.41151582]
curr_Stock_Price:  99.23949165258497
curr_Factors:  [99.23949165]
mat_Sqrt:  [[0.15]]
grads:  [-0.08366747]
Stock Position:  -0.08366747235754114
Bond Position:  [11.71463325]


portfolio before change:  [3.4022899]
curr_Stock_Price:  99.35851179271259
curr_Factors:  [99.35851179]
mat_Sqrt:  [[0.15]]
grads:  [-0.01285965]
Stock Position:  -0.012859654410235618
Bond Position:  [4.68000602]


portfolio before change:  [3.40027531]
curr_Stock_Price:  99.53791743791719
curr_Factors:  [99.53791744]
mat_Sqrt:  [[0.15]]
grads:  [-0.0826359]
Stock Position:  -0.0826359015305255
Bond Position:  [11.62568086]


portfolio before change:  [3.41157643]
curr_Stock_Price:  99.40995258508521
curr_Factors:  [99.40995259]
mat_Sqrt:  [[0.15]]
grads:  [0.15308858]
Stock Position:  0.15308858427138095
Bond Position:  [-11.80695247]


portfolio before change:  [3.39022237]
curr_Stock_Price:  99.27528478022595
curr_Factors:  [99.27528478]
mat_Sqrt:  [[0.15]]
grads:  [0.08943362]
Stock Position:  0.08943361622415359
Bond Position:  [-5.48832535]


portfolio before change:  [3.40659042]
curr_Stock_Price:  99.46213939528853
curr_Factors:  [99.4621394]
mat_Sqrt:  [[0.15]]
grads:  [0.01388213]
Stock Position:  0.01388213491168303
Bond Position:  [2.02584358]


portfolio before change:  [3.41528643]
curr_Stock_Price:  100.07943547994962
curr_Factors:  [100.07943548]
mat_Sqrt:  [[0.15]]
grads:  [0.0407614]
Stock Position:  0.04076139925977104
Bond Position:  [-0.6640914]


portfolio before change:  [3.43691718]
curr_Stock_Price:  100.61112131907659
curr_Factors:  [100.61112132]
mat_Sqrt:  [[0.15]]
grads:  [-0.09629619]
Stock Position:  -0.09629619167609585
Bond Position:  [13.125385]


portfolio before change:  [3.39584193]
curr_Stock_Price:  101.04619157023077
curr_Factors:  [101.04619157]
mat_Sqrt:  [[0.15]]
grads:  [-0.05379845]
Stock Position:  -0.053798447720509866
Bond Position:  [8.83197019]


portfolio before change:  [3.4023032]
curr_Stock_Price:  100.93635106068852
curr_Factors:  [100.93635106]
mat_Sqrt:  [[0.15]]
grads:  [-0.02070596]
Stock Position:  -0.020705957501363594
Bond Position:  [5.49228699]


portfolio before change:  [3.39079291]
curr_Stock_Price:  101.50882262242949
curr_Factors:  [101.50882262]
mat_Sqrt:  [[0.15]]
grads:  [0.01372895]
Stock Position:  0.013728945109989215
Bond Position:  [1.99718385]


portfolio before change:  [3.40741457]
curr_Stock_Price:  102.71043227194133
curr_Factors:  [102.71043227]
mat_Sqrt:  [[0.15]]
grads:  [0.05117129]
Stock Position:  0.051171289765949486
Bond Position:  [-1.84841073]


portfolio before change:  [3.37139821]
curr_Stock_Price:  102.008850830301
curr_Factors:  [102.00885083]
mat_Sqrt:  [[0.15]]
grads:  [0.01689702]
Stock Position:  0.016897017124707262
Bond Position:  [1.64775291]


portfolio before change:  [3.38404201]
curr_Stock_Price:  102.75104189546374
curr_Factors:  [102.7510419]
mat_Sqrt:  [[0.15]]
grads:  [-0.08591685]
Stock Position:  -0.08591685096843628
Bond Position:  [12.21208797]


portfolio before change:  [3.2633652]
curr_Stock_Price:  104.16450258619705
curr_Factors:  [104.16450259]
mat_Sqrt:  [[0.15]]
grads:  [0.05851299]
Stock Position:  0.05851299125006958
Bond Position:  [-2.83161143]


portfolio before change:  [3.26697429]
curr_Stock_Price:  104.22920743543219
curr_Factors:  [104.22920744]
mat_Sqrt:  [[0.15]]
grads:  [-0.02550404]
Stock Position:  -0.02550403751772567
Bond Position:  [5.92523991]


portfolio before change:  [3.27608888]
curr_Stock_Price:  103.8863501046988
curr_Factors:  [103.8863501]
mat_Sqrt:  [[0.15]]
grads:  [0.1659739]
Stock Position:  0.16597389644592347
Bond Position:  [-13.96633344]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.27608888]
Stock Price:  103.8072811739056
PL:  [-0.5311923]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.22811302e-02]
 [-1.26148575e-03]
 [ 1.03538031e-02]
 [ 3.59697066e-03]
 [ 5.07541727e-04]
 [ 1.22423812e-02]
 [-9.45096195e-04]
 [ 1.89152534e-02]
 [-1.37677041e-02]
 [ 1.11629608e-02]
 [ 9.91394362e-03]
 [-1.11124212e-02]
 [ 2.27904357e-02]
 [ 1.64088540e-02]
 [-1.32079798e-02]
 [-4.93008288e-03]
 [ 1.66604733e-02]
 [ 1.43687302e-02]
 [-2.07298161e-02]
 [-6.21984531e-03]
 [-2.76234748e-02]
 [-7.72716059e-03]
 [-1.25068813e-02]
 [ 9.28610489e-03]
 [ 1.99962121e-02]
 [ 7.89297424e-03]
 [ 3.90255841e-03]
 [ 2.05063008e-02]
 [ 1.18084959e-02]
 [-7.70415046e-03]
 [-5.92948938e-03]
 [ 3.10649714e-02]
 [ 1.00056145e-03]
 [-1.34690773e-02]
 [ 4.07481928e-03]
 [-8.28790808e-03]
 [ 1.89321787e-03]
 [-1.17932146e-02]
 [ 1.04458874e-02]
 [-2.30697577e-03]
 [-8.14539859e-02]
 [-6.64066741e-03]
 [ 2.61195612e-02]
 [-2.37027286e-02]
 [-2.22474620e-02]
 [ 4.60169390e-03]
 [-1.33407810e-02]
 [ 4.86506724e-02]
 [ 7.47137361e-02]
 [-1.78979609e-02]
 [-6.16697852e-03]
 [ 4.49427040e-03]
 [ 3.88362354e-03]
 [-1.56521555e-02]
 [-2.06118485e-02]
 [ 1.61795761e-02]
 [-6.03860861e-02]
 [-2.04450487e-02]
 [ 2.73659423e-02]
 [-1.90547208e-02]
 [ 1.35540777e-02]
 [-1.18695425e-02]
 [-1.25753072e-02]
 [-2.17784213e-03]
 [ 2.60353245e-01]
 [ 1.61004397e-03]
 [-1.38593992e-02]
 [ 1.05016344e-02]
 [ 2.20850367e-02]
 [-4.23090950e-02]
 [-8.42472156e-03]
 [-1.50868711e-03]
 [ 3.26336785e-02]
 [-2.21471108e-03]
 [-6.50641016e-03]
 [ 1.75191116e-02]
 [-8.16294159e-03]
 [ 1.38681904e-03]
 [ 4.20273270e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.40513156]
curr_Stock_Price:  100.21457943075059
curr_Factors:  [100.21457943]
mat_Sqrt:  [[0.15]]
grads:  [-0.2818742]
Stock Position:  -0.28187420146324954
Bond Position:  [33.65303611]


portfolio before change:  [5.31597989]
curr_Stock_Price:  100.53832329054612
curr_Factors:  [100.53832329]
mat_Sqrt:  [[0.15]]
grads:  [-0.00840991]
Stock Position:  -0.008409905011418053
Bond Position:  [6.16149764]


portfolio before change:  [5.30701014]
curr_Stock_Price:  101.65068485735651
curr_Factors:  [101.65068486]
mat_Sqrt:  [[0.15]]
grads:  [0.06902535]
Stock Position:  0.0690253539174132
Bond Position:  [-1.70946435]


portfolio before change:  [5.33834046]
curr_Stock_Price:  102.10612856949817
curr_Factors:  [102.10612857]
mat_Sqrt:  [[0.15]]
grads:  [0.0239798]
Stock Position:  0.023979804409765902
Bond Position:  [2.88985547]


portfolio before change:  [5.33648019]
curr_Stock_Price:  102.02101969047632
curr_Factors:  [102.02101969]
mat_Sqrt:  [[0.15]]
grads:  [0.00338361]
Stock Position:  0.0033836115110721355
Bond Position:  [4.99128069]


portfolio before change:  [5.33885937]
curr_Stock_Price:  102.63197027958185
curr_Factors:  [102.63197028]
mat_Sqrt:  [[0.15]]
grads:  [0.08161587]
Stock Position:  0.08161587476253931
Bond Position:  [-3.03753866]


portfolio before change:  [5.34338426]
curr_Stock_Price:  102.68973765659952
curr_Factors:  [102.68973766]
mat_Sqrt:  [[0.15]]
grads:  [-0.00630064]
Stock Position:  -0.006300641301057938
Bond Position:  [5.99039546]


portfolio before change:  [5.34369666]
curr_Stock_Price:  102.69957936883618
curr_Factors:  [102.69957937]
mat_Sqrt:  [[0.15]]
grads:  [0.12610169]
Stock Position:  0.12610168955842324
Bond Position:  [-7.60689382]


portfolio before change:  [5.31449347]
curr_Stock_Price:  102.47176529404385
curr_Factors:  [102.47176529]
mat_Sqrt:  [[0.15]]
grads:  [-0.09178469]
Stock Position:  -0.09178469368998013
Bond Position:  [14.71983306]


portfolio before change:  [5.32272329]
curr_Stock_Price:  102.39212456779391
curr_Factors:  [102.39212457]
mat_Sqrt:  [[0.15]]
grads:  [0.07441974]
Stock Position:  0.07441973881902728
Bond Position:  [-2.29727187]


portfolio before change:  [5.31296153]
curr_Stock_Price:  102.26288228760133
curr_Factors:  [102.26288229]
mat_Sqrt:  [[0.15]]
grads:  [0.06609296]
Stock Position:  0.06609295743492631
Bond Position:  [-1.44589479]


portfolio before change:  [5.32379153]
curr_Stock_Price:  102.42810965716706
curr_Factors:  [102.42810966]
mat_Sqrt:  [[0.15]]
grads:  [-0.07408281]
Stock Position:  -0.07408280830688196
Bond Position:  [12.91195354]


portfolio before change:  [5.3387204]
curr_Stock_Price:  102.23748707219673
curr_Factors:  [102.23748707]
mat_Sqrt:  [[0.15]]
grads:  [0.15193624]
Stock Position:  0.1519362378094078
Bond Position:  [-10.19485874]


portfolio before change:  [5.4235187]
curr_Stock_Price:  102.79979854110329
curr_Factors:  [102.79979854]
mat_Sqrt:  [[0.15]]
grads:  [0.10939236]
Stock Position:  0.10939236004870209
Bond Position:  [-5.82199388]


portfolio before change:  [5.55370418]
curr_Stock_Price:  103.99320340350252
curr_Factors:  [103.9932034]
mat_Sqrt:  [[0.15]]
grads:  [-0.0880532]
Stock Position:  -0.08805319839275702
Bond Position:  [14.71063835]


portfolio before change:  [5.49591181]
curr_Stock_Price:  104.65998010354419
curr_Factors:  [104.6599801]
mat_Sqrt:  [[0.15]]
grads:  [-0.03286722]
Stock Position:  -0.03286721923168163
Bond Position:  [8.93579432]


portfolio before change:  [5.51733129]
curr_Stock_Price:  104.02527551053153
curr_Factors:  [104.02527551]
mat_Sqrt:  [[0.15]]
grads:  [0.11106982]
Stock Position:  0.11106982196849596
Bond Position:  [-6.03673755]


portfolio before change:  [5.64544825]
curr_Stock_Price:  105.18215382605273
curr_Factors:  [105.18215383]
mat_Sqrt:  [[0.15]]
grads:  [0.09579153]
Stock Position:  0.09579153490542022
Bond Position:  [-4.43011171]


portfolio before change:  [5.58579544]
curr_Stock_Price:  104.56230875122684
curr_Factors:  [104.56230875]
mat_Sqrt:  [[0.15]]
grads:  [-0.13819877]
Stock Position:  -0.13819877378553166
Bond Position:  [20.0361783]


portfolio before change:  [5.47080213]
curr_Stock_Price:  105.4034566786041
curr_Factors:  [105.40345668]
mat_Sqrt:  [[0.15]]
grads:  [-0.04146564]
Stock Position:  -0.041465635409939354
Bond Position:  [9.84142344]


portfolio before change:  [5.45990935]
curr_Stock_Price:  105.68098497406136
curr_Factors:  [105.68098497]
mat_Sqrt:  [[0.15]]
grads:  [-0.1841565]
Stock Position:  -0.18415649879044993
Bond Position:  [24.92174954]


portfolio before change:  [5.4807811]
curr_Stock_Price:  105.576106323977
curr_Factors:  [105.57610632]
mat_Sqrt:  [[0.15]]
grads:  [-0.0515144]
Stock Position:  -0.05151440394389216
Bond Position:  [10.91947129]


portfolio before change:  [5.49119739]
curr_Stock_Price:  105.3871532111285
curr_Factors:  [105.38715321]
mat_Sqrt:  [[0.15]]
grads:  [-0.08337921]
Stock Position:  -0.08337920882691598
Bond Position:  [14.27829485]


portfolio before change:  [5.4810863]
curr_Stock_Price:  105.51912277283985
curr_Factors:  [105.51912277]
mat_Sqrt:  [[0.15]]
grads:  [0.06190737]
Stock Position:  0.06190736594734535
Bond Position:  [-1.05132465]


portfolio before change:  [5.50399135]
curr_Stock_Price:  105.89017335760572
curr_Factors:  [105.89017336]
mat_Sqrt:  [[0.15]]
grads:  [0.13330808]
Stock Position:  0.13330808064257688
Bond Position:  [-8.61202442]


portfolio before change:  [5.59811608]
curr_Stock_Price:  106.60028030435194
curr_Factors:  [106.6002803]
mat_Sqrt:  [[0.15]]
grads:  [0.05261983]
Stock Position:  0.05261982824579597
Bond Position:  [-0.01117236]


portfolio before change:  [5.59554452]
curr_Stock_Price:  106.5514231371282
curr_Factors:  [106.55142314]
mat_Sqrt:  [[0.15]]
grads:  [0.02601706]
Stock Position:  0.026017056061089228
Bond Position:  [2.82339017]


portfolio before change:  [5.60958817]
curr_Stock_Price:  107.08442673535856
curr_Factors:  [107.08442674]
mat_Sqrt:  [[0.15]]
grads:  [0.13670867]
Stock Position:  0.13670867187672944
Bond Position:  [-9.02978158]


portfolio before change:  [5.54398346]
curr_Stock_Price:  106.60866809182343
curr_Factors:  [106.60866809]
mat_Sqrt:  [[0.15]]
grads:  [0.07872331]
Stock Position:  0.0787233057603067
Bond Position:  [-2.84860331]


portfolio before change:  [5.61537012]
curr_Stock_Price:  107.51773430012246
curr_Factors:  [107.5177343]
mat_Sqrt:  [[0.15]]
grads:  [-0.051361]
Stock Position:  -0.05136100307292383
Bond Position:  [11.1375888]


portfolio before change:  [5.614229]
curr_Stock_Price:  107.55350543597183
curr_Factors:  [107.55350544]
mat_Sqrt:  [[0.15]]
grads:  [-0.03952993]
Stock Position:  -0.03952992922076966
Bond Position:  [9.86581145]


portfolio before change:  [5.58576038]
curr_Stock_Price:  108.28928330500645
curr_Factors:  [108.28928331]
mat_Sqrt:  [[0.15]]
grads:  [0.20709981]
Stock Position:  0.20709980927755664
Bond Position:  [-16.84092954]


portfolio before change:  [5.44781241]
curr_Stock_Price:  107.62827169378036
curr_Factors:  [107.62827169]
mat_Sqrt:  [[0.15]]
grads:  [0.00667041]
Stock Position:  0.006670409671399551
Bond Position:  [4.72988775]


portfolio before change:  [5.44549984]
curr_Stock_Price:  107.23726080377853
curr_Factors:  [107.2372608]
mat_Sqrt:  [[0.15]]
grads:  [-0.08979385]
Stock Position:  -0.08979384839230926
Bond Position:  [15.07474618]


portfolio before change:  [5.42376979]
curr_Stock_Price:  107.48975300417622
curr_Factors:  [107.489753]
mat_Sqrt:  [[0.15]]
grads:  [0.02716546]
Stock Position:  0.027165461864476874
Bond Position:  [2.50376101]


portfolio before change:  [5.42577281]
curr_Stock_Price:  107.55772656230468
curr_Factors:  [107.55772656]
mat_Sqrt:  [[0.15]]
grads:  [-0.05525272]
Stock Position:  -0.05525272053338045
Bond Position:  [11.36862982]


portfolio before change:  [5.43525368]
curr_Stock_Price:  107.39899592822276
curr_Factors:  [107.39899593]
mat_Sqrt:  [[0.15]]
grads:  [0.01262145]
Stock Position:  0.012621452478920546
Bond Position:  [4.07972235]


portfolio before change:  [5.43997089]
curr_Stock_Price:  107.75253847701512
curr_Factors:  [107.75253848]
mat_Sqrt:  [[0.15]]
grads:  [-0.07862143]
Stock Position:  -0.07862143035604681
Bond Position:  [13.91162959]


portfolio before change:  [5.42291735]
curr_Stock_Price:  107.9805047814614
curr_Factors:  [107.98050478]
mat_Sqrt:  [[0.15]]
grads:  [0.06963925]
Stock Position:  0.0696392496283012
Bond Position:  [-2.09676397]


portfolio before change:  [5.44381353]
curr_Stock_Price:  108.28244985582766
curr_Factors:  [108.28244986]
mat_Sqrt:  [[0.15]]
grads:  [-0.01537984]
Stock Position:  -0.015379838442075335
Bond Position:  [7.10918011]


portfolio before change:  [5.42444846]
curr_Stock_Price:  109.570461495334
curr_Factors:  [109.5704615]
mat_Sqrt:  [[0.15]]
grads:  [-0.54302657]
Stock Position:  -0.5430265725670863
Bond Position:  [64.92412062]


portfolio before change:  [5.69759365]
curr_Stock_Price:  109.07492900395827
curr_Factors:  [109.074929]
mat_Sqrt:  [[0.15]]
grads:  [-0.04427112]
Stock Position:  -0.0442711160556947
Bond Position:  [10.52646249]


portfolio before change:  [5.68501677]
curr_Stock_Price:  109.37387806011598
curr_Factors:  [109.37387806]
mat_Sqrt:  [[0.15]]
grads:  [0.17413041]
Stock Position:  0.17413040818756748
Bond Position:  [-13.36030126]


portfolio before change:  [5.82712966]
curr_Stock_Price:  110.19480269424169
curr_Factors:  [110.19480269]
mat_Sqrt:  [[0.15]]
grads:  [-0.15801819]
Stock Position:  -0.15801819045368312
Bond Position:  [23.23991298]


portfolio before change:  [5.56091774]
curr_Stock_Price:  111.88868658122024
curr_Factors:  [111.88868658]
mat_Sqrt:  [[0.15]]
grads:  [-0.14831641]
Stock Position:  -0.14831641311102972
Bond Position:  [22.1558464]


portfolio before change:  [5.64799066]
curr_Stock_Price:  111.31094780673904
curr_Factors:  [111.31094781]
mat_Sqrt:  [[0.15]]
grads:  [0.03067796]
Stock Position:  0.030677959366443606
Bond Position:  [2.23319793]


portfolio before change:  [5.63776874]
curr_Stock_Price:  110.97319692452363
curr_Factors:  [110.97319692]
mat_Sqrt:  [[0.15]]
grads:  [-0.08893854]
Stock Position:  -0.08893854028195171
Bond Position:  [15.50756288]


portfolio before change:  [5.65796444]
curr_Stock_Price:  110.75702005078763
curr_Factors:  [110.75702005]
mat_Sqrt:  [[0.15]]
grads:  [0.32433782]
Stock Position:  0.32433781579658194
Bond Position:  [-30.26472552]


portfolio before change:  [5.47434936]
curr_Stock_Price:  110.19672928346695
curr_Factors:  [110.19672928]
mat_Sqrt:  [[0.15]]
grads:  [0.49809157]
Stock Position:  0.4980915742906003
Bond Position:  [-49.41371301]


portfolio before change:  [5.16618526]
curr_Stock_Price:  109.5842402170228
curr_Factors:  [109.58424022]
mat_Sqrt:  [[0.15]]
grads:  [-0.11931974]
Stock Position:  -0.11931973939504038
Bond Position:  [18.24174824]


portfolio before change:  [5.0965035]
curr_Stock_Price:  110.1777874840604
curr_Factors:  [110.17778748]
mat_Sqrt:  [[0.15]]
grads:  [-0.04111319]
Stock Position:  -0.04111319015097175
Bond Position:  [9.62626383]


portfolio before change:  [5.05976278]
curr_Stock_Price:  111.08606964084184
curr_Factors:  [111.08606964]
mat_Sqrt:  [[0.15]]
grads:  [0.0299618]
Stock Position:  0.02996180264727209
Bond Position:  [1.73142389]


portfolio before change:  [5.07652346]
curr_Stock_Price:  111.64185946604512
curr_Factors:  [111.64185947]
mat_Sqrt:  [[0.15]]
grads:  [0.02589082]
Stock Position:  0.0258908236330858
Bond Position:  [2.18602377]


portfolio before change:  [5.07217415]
curr_Stock_Price:  111.46859540174577
curr_Factors:  [111.4685954]
mat_Sqrt:  [[0.15]]
grads:  [-0.1043477]
Stock Position:  -0.1043477035262852
Bond Position:  [16.70366609]


portfolio before change:  [5.10051408]
curr_Stock_Price:  111.20700917241204
curr_Factors:  [111.20700917]
mat_Sqrt:  [[0.15]]
grads:  [-0.13741232]
Stock Position:  -0.1374123232457838
Bond Position:  [20.38172757]


portfolio before change:  [5.07380018]
curr_Stock_Price:  111.41068668595167
curr_Factors:  [111.41068669]
mat_Sqrt:  [[0.15]]
grads:  [0.10786384]
Stock Position:  0.10786384061504624
Bond Position:  [-6.94338437]


portfolio before change:  [5.04104248]
curr_Stock_Price:  111.11101518048821
curr_Factors:  [111.11101518]
mat_Sqrt:  [[0.15]]
grads:  [-0.40257391]
Stock Position:  -0.4025739071259217
Bond Position:  [49.77143799]


portfolio before change:  [5.05754073]
curr_Stock_Price:  111.07776057647267
curr_Factors:  [111.07776058]
mat_Sqrt:  [[0.15]]
grads:  [-0.13630032]
Stock Position:  -0.1363003243955848
Bond Position:  [20.19747553]


portfolio before change:  [5.08652448]
curr_Stock_Price:  110.8743761019204
curr_Factors:  [110.8743761]
mat_Sqrt:  [[0.15]]
grads:  [0.18243962]
Stock Position:  0.18243961500256378
Bond Position:  [-15.14135401]


portfolio before change:  [5.01696429]
curr_Stock_Price:  110.49828546553805
curr_Factors:  [110.49828547]
mat_Sqrt:  [[0.15]]
grads:  [-0.12703147]
Stock Position:  -0.1270314719089418
Bond Position:  [19.05372413]


portfolio before change:  [4.98772022]
curr_Stock_Price:  110.73787147003122
curr_Factors:  [110.73787147]
mat_Sqrt:  [[0.15]]
grads:  [0.09036052]
Stock Position:  0.09036051786216193
Bond Position:  [-5.01861119]


portfolio before change:  [4.99508096]
curr_Stock_Price:  110.82280249563803
curr_Factors:  [110.8228025]
mat_Sqrt:  [[0.15]]
grads:  [-0.07913028]
Stock Position:  -0.07913028323820548
Bond Position:  [13.76452071]


portfolio before change:  [5.00082592]
curr_Stock_Price:  110.76107323378903
curr_Factors:  [110.76107323]
mat_Sqrt:  [[0.15]]
grads:  [-0.08383538]
Stock Position:  -0.0838353812985293
Bond Position:  [14.28652273]


portfolio before change:  [4.89341575]
curr_Stock_Price:  112.05292765474547
curr_Factors:  [112.05292765]
mat_Sqrt:  [[0.15]]
grads:  [-0.01451895]
Stock Position:  -0.014518947536551903
Bond Position:  [6.52030633]


portfolio before change:  [4.88504952]
curr_Stock_Price:  112.65722505965175
curr_Factors:  [112.65722506]
mat_Sqrt:  [[0.15]]
grads:  [1.7356883]
Stock Position:  1.7356882968550833
Bond Position:  [-190.65277757]


portfolio before change:  [5.86107863]
curr_Stock_Price:  113.22642016692204
curr_Factors:  [113.22642017]
mat_Sqrt:  [[0.15]]
grads:  [0.01073363]
Stock Position:  0.010733626450198366
Bond Position:  [4.64574854]


portfolio before change:  [5.86667788]
curr_Stock_Price:  113.72102248409632
curr_Factors:  [113.72102248]
mat_Sqrt:  [[0.15]]
grads:  [-0.09239599]
Stock Position:  -0.09239599483701384
Bond Position:  [16.37404488]


portfolio before change:  [5.92614249]
curr_Stock_Price:  113.08851453928851
curr_Factors:  [113.08851454]
mat_Sqrt:  [[0.15]]
grads:  [0.0700109]
Stock Position:  0.070010896188498
Bond Position:  [-1.99128576]


portfolio before change:  [5.86996023]
curr_Stock_Price:  112.28781346960612
curr_Factors:  [112.28781347]
mat_Sqrt:  [[0.15]]
grads:  [0.14723358]
Stock Position:  0.14723357775183527
Bond Position:  [-10.66257628]


portfolio before change:  [5.90352245]
curr_Stock_Price:  112.5202920115584
curr_Factors:  [112.52029201]
mat_Sqrt:  [[0.15]]
grads:  [-0.28206063]
Stock Position:  -0.282060633454943
Bond Position:  [37.64106729]


portfolio before change:  [5.58655802]
curr_Stock_Price:  113.65237860439828
curr_Factors:  [113.6523786]
mat_Sqrt:  [[0.15]]
grads:  [-0.05616481]
Stock Position:  -0.05616481040111755
Bond Position:  [11.96982232]


portfolio before change:  [5.61307795]
curr_Stock_Price:  113.19351856361452
curr_Factors:  [113.19351856]
mat_Sqrt:  [[0.15]]
grads:  [-0.01005791]
Stock Position:  -0.01005791406678654
Bond Position:  [6.75156863]


portfolio before change:  [5.60289462]
curr_Stock_Price:  114.2479433199726
curr_Factors:  [114.24794332]
mat_Sqrt:  [[0.15]]
grads:  [0.21755786]
Stock Position:  0.2175578565548035
Bond Position:  [-19.25264304]


portfolio before change:  [5.59739123]
curr_Stock_Price:  114.22817817180419
curr_Factors:  [114.22817817]
mat_Sqrt:  [[0.15]]
grads:  [-0.01476474]
Stock Position:  -0.014764740519556235
Bond Position:  [7.28394064]


portfolio before change:  [5.59921361]
curr_Stock_Price:  114.13558483242952
curr_Factors:  [114.13558483]
mat_Sqrt:  [[0.15]]
grads:  [-0.04337607]
Stock Position:  -0.04337606771188035
Bond Position:  [10.54996646]


portfolio before change:  [5.61498479]
curr_Stock_Price:  113.78719487861935
curr_Factors:  [113.78719488]
mat_Sqrt:  [[0.15]]
grads:  [0.11679408]
Stock Position:  0.11679407714643542
Bond Position:  [-7.67468563]


portfolio before change:  [5.48273776]
curr_Stock_Price:  112.65899262450962
curr_Factors:  [112.65899262]
mat_Sqrt:  [[0.15]]
grads:  [-0.05441961]
Stock Position:  -0.05441961061611863
Bond Position:  [11.61359627]


portfolio before change:  [5.47798345]
curr_Stock_Price:  112.75969502446148
curr_Factors:  [112.75969502]
mat_Sqrt:  [[0.15]]
grads:  [0.00924546]
Stock Position:  0.0092454602845446
Bond Position:  [4.43546817]


portfolio before change:  [5.47920827]
curr_Stock_Price:  112.8621879349522
curr_Factors:  [112.86218793]
mat_Sqrt:  [[0.15]]
grads:  [0.28018218]
Stock Position:  0.2801821802992846
Bond Position:  [-26.14276562]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.47920827]
Stock Price:  113.91009677983108
PL:  [-8.43088851]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.45420889e-02]
 [-2.02732818e-03]
 [ 7.65866661e-04]
 [ 2.13365143e-03]
 [ 1.00137705e-02]
 [ 7.54224431e-03]
 [ 4.67233005e-04]
 [ 7.92538416e-03]
 [ 3.21509261e-04]
 [ 1.58069988e-02]
 [ 9.49778068e-03]
 [-9.95722715e-03]
 [ 8.93809409e-03]
 [ 6.99064762e-03]
 [-2.09428471e-02]
 [ 1.57720220e-02]
 [-4.48846438e-03]
 [-8.63567680e-03]
 [ 6.09611972e-04]
 [ 1.36782331e-02]
 [ 1.72795770e-02]
 [-2.20774220e-02]
 [-2.06318918e-04]
 [ 8.06928622e-03]
 [ 4.58455226e-03]
 [ 1.01374798e-02]
 [ 1.28897309e-02]
 [-6.22225844e-03]
 [ 2.68406346e-03]
 [-1.81406571e-02]
 [-3.95537879e-03]
 [ 7.22688731e-03]
 [ 1.50404555e-02]
 [ 1.53029830e-02]
 [-2.14626212e-03]
 [-1.68248940e-03]
 [-4.70011027e-03]
 [ 1.36057769e-02]
 [-2.23240880e-03]
 [-1.20939756e-02]
 [-7.73863129e-03]
 [-2.65680469e-03]
 [ 8.35389288e-03]
 [-1.26182429e-02]
 [ 5.88127122e-04]
 [ 2.10393944e-03]
 [-1.36508558e-02]
 [-2.04369954e-03]
 [ 2.15197781e-05]
 [-3.41978530e-04]
 [-3.07191433e-03]
 [ 3.69341520e-03]
 [ 4.92219128e-04]
 [ 1.68344462e-03]
 [-9.42995720e-04]
 [ 8.52851862e-03]
 [-5.58808998e-03]
 [-1.23367594e-02]
 [ 1.37785943e-02]
 [ 4.36577162e-03]
 [ 1.03595395e-02]
 [-1.35411455e-02]
 [-1.26975050e-02]
 [-3.12352653e-03]
 [-1.57272118e-02]
 [-1.87831337e-02]
 [ 2.28576039e-02]
 [ 3.38757303e-03]
 [ 9.64312235e-03]
 [-2.22142236e-02]
 [-8.02054623e-03]
 [-6.89483659e-03]
 [ 5.38160068e-03]
 [ 6.88226093e-03]
 [-6.48372136e-04]
 [-6.80136494e-03]
 [ 8.48396012e-03]
 [-3.90194145e-03]
 [ 2.48950496e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.40127212]
curr_Stock_Price:  100.02151940359774
curr_Factors:  [100.0215194]
mat_Sqrt:  [[0.15]]
grads:  [-0.23028059]
Stock Position:  -0.23028059252120625
Bond Position:  [25.43428688]


portfolio before change:  [2.3204606]
curr_Stock_Price:  100.37934903043404
curr_Factors:  [100.37934903]
mat_Sqrt:  [[0.15]]
grads:  [-0.01351552]
Stock Position:  -0.013515521182630136
Bond Position:  [3.67713981]


portfolio before change:  [2.31624623]
curr_Stock_Price:  100.70817082880114
curr_Factors:  [100.70817083]
mat_Sqrt:  [[0.15]]
grads:  [0.00510578]
Stock Position:  0.005105777739159451
Bond Position:  [1.80205269]


portfolio before change:  [2.31401434]
curr_Stock_Price:  100.2489813034056
curr_Factors:  [100.2489813]
mat_Sqrt:  [[0.15]]
grads:  [0.01422434]
Stock Position:  0.014224342880558988
Bond Position:  [0.88803846]


portfolio before change:  [2.30536555]
curr_Stock_Price:  99.63705182032332
curr_Factors:  [99.63705182]
mat_Sqrt:  [[0.15]]
grads:  [0.06675847]
Stock Position:  0.06675846998010347
Bond Position:  [-4.34625158]


portfolio before change:  [2.25534653]
curr_Stock_Price:  98.89186746674214
curr_Factors:  [98.89186747]
mat_Sqrt:  [[0.15]]
grads:  [0.05028163]
Stock Position:  0.05028162871146461
Bond Position:  [-2.71709763]


portfolio before change:  [2.26404504]
curr_Stock_Price:  99.0682407738077
curr_Factors:  [99.06824077]
mat_Sqrt:  [[0.15]]
grads:  [0.00311489]
Stock Position:  0.003114886700650354
Bond Position:  [1.9554587]


portfolio before change:  [2.26226337]
curr_Stock_Price:  98.45701688487553
curr_Factors:  [98.45701688]
mat_Sqrt:  [[0.15]]
grads:  [0.05283589]
Stock Position:  0.05283589440312447
Bond Position:  [-2.93980118]


portfolio before change:  [2.202326]
curr_Stock_Price:  97.32608820018416
curr_Factors:  [97.3260882]
mat_Sqrt:  [[0.15]]
grads:  [0.0021434]
Stock Position:  0.0021433950725832083
Bond Position:  [1.99371774]


portfolio before change:  [2.20370301]
curr_Stock_Price:  97.91039245735128
curr_Factors:  [97.91039246]
mat_Sqrt:  [[0.15]]
grads:  [0.10537999]
Stock Position:  0.10537999221698328
Bond Position:  [-8.11409339]


portfolio before change:  [2.14335822]
curr_Stock_Price:  97.34256514392267
curr_Factors:  [97.34256514]
mat_Sqrt:  [[0.15]]
grads:  [0.06331854]
Stock Position:  0.06331853784311896
Bond Position:  [-4.02023067]


portfolio before change:  [2.16478631]
curr_Stock_Price:  97.68495076044427
curr_Factors:  [97.68495076]
mat_Sqrt:  [[0.15]]
grads:  [-0.06638151]
Stock Position:  -0.06638151433431078
Bond Position:  [8.64926126]


portfolio before change:  [2.1854851]
curr_Stock_Price:  97.38127885375499
curr_Factors:  [97.38127885]
mat_Sqrt:  [[0.15]]
grads:  [0.05958729]
Stock Position:  0.059587293901709866
Bond Position:  [-3.61720178]


portfolio before change:  [2.1747969]
curr_Stock_Price:  97.20570249299882
curr_Factors:  [97.20570249]
mat_Sqrt:  [[0.15]]
grads:  [0.04660432]
Stock Position:  0.04660431746829656
Bond Position:  [-2.35540852]


portfolio before change:  [2.19871999]
curr_Stock_Price:  97.72218483563351
curr_Factors:  [97.72218484]
mat_Sqrt:  [[0.15]]
grads:  [-0.13961898]
Stock Position:  -0.13961898065067624
Bond Position:  [15.84259182]


portfolio before change:  [2.18565834]
curr_Stock_Price:  97.82282906805763
curr_Factors:  [97.82282907]
mat_Sqrt:  [[0.15]]
grads:  [0.10514681]
Stock Position:  0.10514681350619454
Bond Position:  [-8.10010043]


portfolio before change:  [2.09045044]
curr_Stock_Price:  96.92216815001224
curr_Factors:  [96.92216815]
mat_Sqrt:  [[0.15]]
grads:  [-0.0299231]
Stock Position:  -0.029923095866520612
Bond Position:  [4.99066177]


portfolio before change:  [2.09374053]
curr_Stock_Price:  96.82264097898057
curr_Factors:  [96.82264098]
mat_Sqrt:  [[0.15]]
grads:  [-0.05757118]
Stock Position:  -0.0575711786508552
Bond Position:  [7.66793409]


portfolio before change:  [2.04317196]
curr_Stock_Price:  97.70933174542311
curr_Factors:  [97.70933175]
mat_Sqrt:  [[0.15]]
grads:  [0.00406408]
Stock Position:  0.004064079810419582
Bond Position:  [1.64607343]


portfolio before change:  [2.04626185]
curr_Stock_Price:  98.44430996913776
curr_Factors:  [98.44430997]
mat_Sqrt:  [[0.15]]
grads:  [0.09118822]
Stock Position:  0.09118822070849758
Bond Position:  [-6.93069962]


portfolio before change:  [2.03321625]
curr_Stock_Price:  98.30599810185144
curr_Factors:  [98.3059981]
mat_Sqrt:  [[0.15]]
grads:  [0.11519718]
Stock Position:  0.11519717969529854
Bond Position:  [-9.29135748]


portfolio before change:  [1.99273251]
curr_Stock_Price:  97.959609328184
curr_Factors:  [97.95960933]
mat_Sqrt:  [[0.15]]
grads:  [-0.14718281]
Stock Position:  -0.14718281362634572
Bond Position:  [16.41070344]


portfolio before change:  [2.0374335]
curr_Stock_Price:  97.66286761958814
curr_Factors:  [97.66286762]
mat_Sqrt:  [[0.15]]
grads:  [-0.00137546]
Stock Position:  -0.0013754594504441012
Bond Position:  [2.17176481]


portfolio before change:  [2.03730582]
curr_Stock_Price:  97.85437554014932
curr_Factors:  [97.85437554]
mat_Sqrt:  [[0.15]]
grads:  [0.05379524]
Stock Position:  0.05379524143828626
Bond Position:  [-3.22679393]


portfolio before change:  [2.07202838]
curr_Stock_Price:  98.50358236449955
curr_Factors:  [98.50358236]
mat_Sqrt:  [[0.15]]
grads:  [0.03056368]
Stock Position:  0.030563681707254615
Bond Position:  [-0.93860376]


portfolio before change:  [2.06466062]
curr_Stock_Price:  98.26443921634771
curr_Factors:  [98.26443922]
mat_Sqrt:  [[0.15]]
grads:  [0.0675832]
Stock Position:  0.0675831987310622
Bond Position:  [-4.5763645]


portfolio before change:  [2.09854006]
curr_Stock_Price:  98.76997122388528
curr_Factors:  [98.76997122]
mat_Sqrt:  [[0.15]]
grads:  [0.08593154]
Stock Position:  0.08593153928983485
Bond Position:  [-6.3889156]


portfolio before change:  [2.15383185]
curr_Stock_Price:  99.4180581336566
curr_Factors:  [99.41805813]
mat_Sqrt:  [[0.15]]
grads:  [-0.04148172]
Stock Position:  -0.04148172290699364
Bond Position:  [6.27786418]


portfolio before change:  [2.14789633]
curr_Stock_Price:  99.57060472461274
curr_Factors:  [99.57060472]
mat_Sqrt:  [[0.15]]
grads:  [0.01789376]
Stock Position:  0.017893756382978812
Bond Position:  [0.36620418]


portfolio before change:  [2.14629569]
curr_Stock_Price:  99.47987349639726
curr_Factors:  [99.4798735]
mat_Sqrt:  [[0.15]]
grads:  [-0.12093771]
Stock Position:  -0.12093771419100917
Bond Position:  [14.1771642]


portfolio before change:  [2.17508065]
curr_Stock_Price:  99.24918567667551
curr_Factors:  [99.24918568]
mat_Sqrt:  [[0.15]]
grads:  [-0.02636919]
Stock Position:  -0.026369191941713298
Bond Position:  [4.79220148]


portfolio before change:  [2.14771164]
curr_Stock_Price:  100.29846060550885
curr_Factors:  [100.29846061]
mat_Sqrt:  [[0.15]]
grads:  [0.04817925]
Stock Position:  0.048179248756864995
Bond Position:  [-2.68459284]


portfolio before change:  [2.12404201]
curr_Stock_Price:  99.81066054152689
curr_Factors:  [99.81066054]
mat_Sqrt:  [[0.15]]
grads:  [0.1002697]
Stock Position:  0.10026970350965736
Bond Position:  [-7.88394333]


portfolio before change:  [2.17106615]
curr_Stock_Price:  100.2845515099712
curr_Factors:  [100.28455151]
mat_Sqrt:  [[0.15]]
grads:  [0.10201989]
Stock Position:  0.1020198864664034
Bond Position:  [-8.0599524]


portfolio before change:  [2.12059693]
curr_Stock_Price:  99.79478948884753
curr_Factors:  [99.79478949]
mat_Sqrt:  [[0.15]]
grads:  [-0.01430841]
Stock Position:  -0.014308414122002466
Bond Position:  [3.5485021]


portfolio before change:  [2.11232282]
curr_Stock_Price:  100.38855853557543
curr_Factors:  [100.38855854]
mat_Sqrt:  [[0.15]]
grads:  [-0.0112166]
Stock Position:  -0.011216596016051563
Bond Position:  [3.23834073]


portfolio before change:  [2.11292479]
curr_Stock_Price:  100.3529359620048
curr_Factors:  [100.35293596]
mat_Sqrt:  [[0.15]]
grads:  [-0.03133407]
Stock Position:  -0.03133406848564031
Bond Position:  [5.25739056]


portfolio before change:  [2.10978969]
curr_Stock_Price:  100.46347679015027
curr_Factors:  [100.46347679]
mat_Sqrt:  [[0.15]]
grads:  [0.09070518]
Stock Position:  0.09070517963795614
Bond Position:  [-7.00276802]


portfolio before change:  [2.11369178]
curr_Stock_Price:  100.51132165884727
curr_Factors:  [100.51132166]
mat_Sqrt:  [[0.15]]
grads:  [-0.01488273]
Stock Position:  -0.01488272533233763
Bond Position:  [3.60957418]


portfolio before change:  [2.10990628]
curr_Stock_Price:  100.78083610323074
curr_Factors:  [100.7808361]
mat_Sqrt:  [[0.15]]
grads:  [-0.0806265]
Stock Position:  -0.08062650395887389
Bond Position:  [10.23551276]


portfolio before change:  [2.09692915]
curr_Stock_Price:  100.9497243450562
curr_Factors:  [100.94972435]
mat_Sqrt:  [[0.15]]
grads:  [-0.05159088]
Stock Position:  -0.05159087529706646
Bond Position:  [7.30501379]


portfolio before change:  [2.07907436]
curr_Stock_Price:  101.3046585901217
curr_Factors:  [101.30465859]
mat_Sqrt:  [[0.15]]
grads:  [-0.01771203]
Stock Position:  -0.017712031287856374
Bond Position:  [3.87338564]


portfolio before change:  [2.08762703]
curr_Stock_Price:  100.83545345846967
curr_Factors:  [100.83545346]
mat_Sqrt:  [[0.15]]
grads:  [0.05569262]
Stock Position:  0.05569261917524149
Bond Position:  [-3.52816348]


portfolio before change:  [2.13454522]
curr_Stock_Price:  101.6818620180745
curr_Factors:  [101.68186202]
mat_Sqrt:  [[0.15]]
grads:  [-0.08412162]
Stock Position:  -0.08412161965459221
Bond Position:  [10.68818814]


portfolio before change:  [2.11949274]
curr_Stock_Price:  101.86874046422218
curr_Factors:  [101.86874046]
mat_Sqrt:  [[0.15]]
grads:  [0.00392085]
Stock Position:  0.003920847482373171
Bond Position:  [1.72008094]


portfolio before change:  [2.11904851]
curr_Stock_Price:  101.72802337842641
curr_Factors:  [101.72802338]
mat_Sqrt:  [[0.15]]
grads:  [0.01402626]
Stock Position:  0.014026262914557745
Bond Position:  [0.69218451]


portfolio before change:  [2.12748875]
curr_Stock_Price:  102.32668433614155
curr_Factors:  [102.32668434]
mat_Sqrt:  [[0.15]]
grads:  [-0.09100571]
Stock Position:  -0.09100570546603047
Bond Position:  [11.43980085]


portfolio before change:  [2.15652417]
curr_Stock_Price:  102.01549062480616
curr_Factors:  [102.01549062]
mat_Sqrt:  [[0.15]]
grads:  [-0.01362466]
Stock Position:  -0.013624663627143542
Bond Position:  [3.54645091]


portfolio before change:  [2.17204399]
curr_Stock_Price:  100.89266201798553
curr_Factors:  [100.89266202]
mat_Sqrt:  [[0.15]]
grads:  [0.00014347]
Stock Position:  0.00014346518749224282
Bond Position:  [2.1575694]


portfolio before change:  [2.17228269]
curr_Stock_Price:  101.61655911039946
curr_Factors:  [101.61655911]
mat_Sqrt:  [[0.15]]
grads:  [-0.00227986]
Stock Position:  -0.002279856865124395
Bond Position:  [2.4039539]


portfolio before change:  [2.17246359]
curr_Stock_Price:  101.60311992887995
curr_Factors:  [101.60311993]
mat_Sqrt:  [[0.15]]
grads:  [-0.02047943]
Stock Position:  -0.020479428897068813
Bond Position:  [4.25323746]


portfolio before change:  [2.16479427]
curr_Stock_Price:  101.99058944571718
curr_Factors:  [101.99058945]
mat_Sqrt:  [[0.15]]
grads:  [0.02462277]
Stock Position:  0.0246227679808555
Bond Position:  [-0.34649635]


portfolio before change:  [2.16512523]
curr_Stock_Price:  102.00491032694109
curr_Factors:  [102.00491033]
mat_Sqrt:  [[0.15]]
grads:  [0.00328146]
Stock Position:  0.0032814608559440447
Bond Position:  [1.83040011]


portfolio before change:  [2.16405866]
curr_Stock_Price:  101.64501786525663
curr_Factors:  [101.64501787]
mat_Sqrt:  [[0.15]]
grads:  [0.01122296]
Stock Position:  0.011222964100011145
Bond Position:  [1.02330027]


portfolio before change:  [2.17010794]
curr_Stock_Price:  102.17832806306626
curr_Factors:  [102.17832806]
mat_Sqrt:  [[0.15]]
grads:  [-0.00628664]
Stock Position:  -0.006286638136352071
Bond Position:  [2.81246611]


portfolio before change:  [2.17138072]
curr_Stock_Price:  102.00383188303131
curr_Factors:  [102.00383188]
mat_Sqrt:  [[0.15]]
grads:  [0.05685679]
Stock Position:  0.056856790798897806
Bond Position:  [-3.62822981]


portfolio before change:  [2.21688543]
curr_Stock_Price:  102.80815943346961
curr_Factors:  [102.80815943]
mat_Sqrt:  [[0.15]]
grads:  [-0.03725393]
Stock Position:  -0.037253933182746356
Bond Position:  [6.04689373]


portfolio before change:  [2.21269395]
curr_Stock_Price:  102.93081561852635
curr_Factors:  [102.93081562]
mat_Sqrt:  [[0.15]]
grads:  [-0.08224506]
Stock Position:  -0.08224506258897588
Bond Position:  [10.67824532]


portfolio before change:  [2.26943945]
curr_Stock_Price:  102.24897421118517
curr_Factors:  [102.24897421]
mat_Sqrt:  [[0.15]]
grads:  [0.0918573]
Stock Position:  0.0918572951558992
Bond Position:  [-7.12287475]


portfolio before change:  [2.23984163]
curr_Stock_Price:  101.93160552099516
curr_Factors:  [101.93160552]
mat_Sqrt:  [[0.15]]
grads:  [0.02910514]
Stock Position:  0.029105144135693636
Bond Position:  [-0.72689245]


portfolio before change:  [2.23861612]
curr_Stock_Price:  101.89106019171469
curr_Factors:  [101.89106019]
mat_Sqrt:  [[0.15]]
grads:  [0.0690636]
Stock Position:  0.06906359667042018
Bond Position:  [-4.79834697]


portfolio before change:  [2.21637276]
curr_Stock_Price:  101.57333198556846
curr_Factors:  [101.57333199]
mat_Sqrt:  [[0.15]]
grads:  [-0.0902743]
Stock Position:  -0.09027430313884634
Bond Position:  [11.38583452]


portfolio before change:  [2.14369572]
curr_Stock_Price:  102.38628399974839
curr_Factors:  [102.386284]
mat_Sqrt:  [[0.15]]
grads:  [-0.08465003]
Stock Position:  -0.08465003362466794
Bond Position:  [10.8106981]


portfolio before change:  [2.11164055]
curr_Stock_Price:  102.77294494640817
curr_Factors:  [102.77294495]
mat_Sqrt:  [[0.15]]
grads:  [-0.02082351]
Stock Position:  -0.02082351018509718
Bond Position:  [4.25173401]


portfolio before change:  [2.11254345]
curr_Stock_Price:  102.74234676934987
curr_Factors:  [102.74234677]
mat_Sqrt:  [[0.15]]
grads:  [-0.10484808]
Stock Position:  -0.10484807838013491
Bond Position:  [12.88488108]


portfolio before change:  [2.05122985]
curr_Stock_Price:  103.33481281173984
curr_Factors:  [103.33481281]
mat_Sqrt:  [[0.15]]
grads:  [-0.12522089]
Stock Position:  -0.12522089128123282
Bond Position:  [14.99090721]


portfolio before change:  [2.01453697]
curr_Stock_Price:  103.63532052608974
curr_Factors:  [103.63532053]
mat_Sqrt:  [[0.15]]
grads:  [0.15238403]
Stock Position:  0.15238402627031214
Bond Position:  [-13.77783044]


portfolio before change:  [1.98817894]
curr_Stock_Price:  103.46800057345203
curr_Factors:  [103.46800057]
mat_Sqrt:  [[0.15]]
grads:  [0.02258382]
Stock Position:  0.02258382020807029
Bond Position:  [-0.34852378]


portfolio before change:  [1.99464283]
curr_Stock_Price:  103.75518264898741
curr_Factors:  [103.75518265]
mat_Sqrt:  [[0.15]]
grads:  [0.06428748]
Stock Position:  0.06428748234816233
Bond Position:  [-4.67551665]


portfolio before change:  [2.03640507]
curr_Stock_Price:  104.40934529766736
curr_Factors:  [104.4093453]
mat_Sqrt:  [[0.15]]
grads:  [-0.14809482]
Stock Position:  -0.14809482423983053
Bond Position:  [17.49888871]


portfolio before change:  [2.01302939]
curr_Stock_Price:  104.57457315472672
curr_Factors:  [104.57457315]
mat_Sqrt:  [[0.15]]
grads:  [-0.05347031]
Stock Position:  -0.05347030818411265
Bond Position:  [7.60466404]


portfolio before change:  [2.02543128]
curr_Stock_Price:  104.3515226435511
curr_Factors:  [104.35152264]
mat_Sqrt:  [[0.15]]
grads:  [-0.04596558]
Stock Position:  -0.04596557724061082
Bond Position:  [6.82200925]


portfolio before change:  [2.0512332]
curr_Stock_Price:  103.79946756995999
curr_Factors:  [103.79946757]
mat_Sqrt:  [[0.15]]
grads:  [0.03587734]
Stock Position:  0.03587733785283436
Bond Position:  [-1.67281537]


portfolio before change:  [2.06442205]
curr_Stock_Price:  104.16999147416115
curr_Factors:  [104.16999147]
mat_Sqrt:  [[0.15]]
grads:  [0.04588174]
Stock Position:  0.04588173952506812
Bond Position:  [-2.71507836]


portfolio before change:  [2.07860733]
curr_Stock_Price:  104.4828605325143
curr_Factors:  [104.48286053]
mat_Sqrt:  [[0.15]]
grads:  [-0.00432248]
Stock Position:  -0.004322480907123528
Bond Position:  [2.5302325]


portfolio before change:  [2.08223698]
curr_Stock_Price:  103.67973311547793
curr_Factors:  [103.67973312]
mat_Sqrt:  [[0.15]]
grads:  [-0.04534243]
Stock Position:  -0.0453424329452047
Bond Position:  [6.78332833]


portfolio before change:  [2.04101743]
curr_Stock_Price:  104.5981559030692
curr_Factors:  [104.5981559]
mat_Sqrt:  [[0.15]]
grads:  [0.05655973]
Stock Position:  0.05655973415196629
Bond Position:  [-3.87502646]


portfolio before change:  [1.9976058]
curr_Stock_Price:  103.83490221448875
curr_Factors:  [103.83490221]
mat_Sqrt:  [[0.15]]
grads:  [-0.02601294]
Stock Position:  -0.026012942969340556
Bond Position:  [4.69865719]


portfolio before change:  [1.99756402]
curr_Stock_Price:  103.84779803113982
curr_Factors:  [103.84779803]
mat_Sqrt:  [[0.15]]
grads:  [0.165967]
Stock Position:  0.16596699725441172
Bond Position:  [-15.23774319]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.99756402]
Stock Price:  104.14986723461023
PL:  [-2.15230321]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-5.41504965e-02]
 [-2.31003595e-03]
 [ 6.67091337e-04]
 [ 2.72949348e-03]
 [ 4.95029448e-03]
 [ 1.21216145e-02]
 [ 2.77765025e-04]
 [ 1.00280667e-02]
 [ 1.66764473e-03]
 [-1.95630755e-02]
 [ 9.88940361e-03]
 [-9.53729409e-03]
 [ 1.99763145e-02]
 [ 1.15024376e-02]
 [-1.37998075e-03]
 [-1.00972277e-02]
 [ 1.32651048e-02]
 [ 1.95563687e-02]
 [ 1.82944509e-02]
 [-9.40879345e-04]
 [ 5.44768655e-02]
 [-1.30812351e-02]
 [ 7.95396947e-03]
 [-1.59041167e-03]
 [ 1.57790259e-02]
 [ 1.80555328e-02]
 [ 1.14289515e-02]
 [ 3.98408522e-03]
 [ 5.15330594e-03]
 [-2.77009078e-02]
 [-4.68629634e-03]
 [-8.97289677e-03]
 [ 1.54637797e-02]
 [ 1.68784273e-02]
 [-1.54679201e-02]
 [ 7.55457181e-03]
 [-2.63770748e-03]
 [ 3.91166407e-03]
 [ 4.98454104e-03]
 [-1.63058793e-02]
 [ 4.21475736e-02]
 [ 2.43355074e-04]
 [ 7.45393722e-03]
 [-9.17033191e-03]
 [ 8.49741997e-04]
 [-4.85124674e-03]
 [-1.35877155e-02]
 [-1.85578446e-04]
 [-2.71370919e-03]
 [-3.60615962e-03]
 [-4.01782777e-03]
 [ 2.80309807e-03]
 [ 3.87286268e-03]
 [-1.74679610e-03]
 [ 1.45407573e-02]
 [ 8.88453350e-03]
 [ 9.40714564e-03]
 [ 5.26551695e-03]
 [ 1.34689655e-02]
 [-1.04707681e-03]
 [ 2.36012176e-03]
 [-1.65785850e-02]
 [-1.27170647e-02]
 [-1.38971590e-03]
 [-9.66119370e-03]
 [-1.93427762e-02]
 [ 1.03692876e-02]
 [ 2.25912181e-03]
 [ 1.02548464e-02]
 [-1.79713881e-02]
 [ 6.10558081e-03]
 [ 1.54528246e-03]
 [ 2.85019747e-04]
 [ 8.25862107e-03]
 [ 1.53132192e-03]
 [ 7.70032796e-04]
 [ 1.05639208e-03]
 [-1.12327637e-02]
 [-1.66300657e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.05998443]
curr_Stock_Price:  100.44947923575762
curr_Factors:  [100.44947924]
mat_Sqrt:  [[0.15]]
grads:  [-0.36100331]
Stock Position:  -0.36100331010123715
Bond Position:  [45.32257893]


portfolio before change:  [9.13240473]
curr_Stock_Price:  100.25671772112761
curr_Factors:  [100.25671772]
mat_Sqrt:  [[0.15]]
grads:  [-0.01540024]
Stock Position:  -0.015400239659378987
Bond Position:  [10.67638221]


portfolio before change:  [9.12646921]
curr_Stock_Price:  100.68546472281164
curr_Factors:  [100.68546472]
mat_Sqrt:  [[0.15]]
grads:  [0.00444728]
Stock Position:  0.004447275581357666
Bond Position:  [8.6786932]


portfolio before change:  [9.12918026]
curr_Stock_Price:  101.17309166020809
curr_Factors:  [101.17309166]
mat_Sqrt:  [[0.15]]
grads:  [0.01819662]
Stock Position:  0.018196623208120898
Bond Position:  [7.28817163]


portfolio before change:  [9.12605739]
curr_Stock_Price:  100.97644005153269
curr_Factors:  [100.97644005]
mat_Sqrt:  [[0.15]]
grads:  [0.03300196]
Stock Position:  0.033001963203189086
Bond Position:  [5.79363663]


portfolio before change:  [9.14600568]
curr_Stock_Price:  101.56992539335283
curr_Factors:  [101.56992539]
mat_Sqrt:  [[0.15]]
grads:  [0.08081076]
Stock Position:  0.0808107636485634
Bond Position:  [0.93806245]


portfolio before change:  [9.11598]
curr_Stock_Price:  101.19764434871331
curr_Factors:  [101.19764435]
mat_Sqrt:  [[0.15]]
grads:  [0.00185177]
Stock Position:  0.001851766835334616
Bond Position:  [8.92858556]


portfolio before change:  [9.11532634]
curr_Stock_Price:  100.54329070482063
curr_Factors:  [100.5432907]
mat_Sqrt:  [[0.15]]
grads:  [0.06685378]
Stock Position:  0.06685377807059067
Bond Position:  [2.3936275]


portfolio before change:  [9.11968436]
curr_Stock_Price:  100.60624022352174
curr_Factors:  [100.60624022]
mat_Sqrt:  [[0.15]]
grads:  [0.01111763]
Stock Position:  0.011117631530466255
Bond Position:  [8.00118125]


portfolio before change:  [9.12758178]
curr_Stock_Price:  101.2716092834266
curr_Factors:  [101.27160928]
mat_Sqrt:  [[0.15]]
grads:  [-0.1304205]
Stock Position:  -0.1304205036102697
Bond Position:  [22.33547606]


portfolio before change:  [8.98433797]
curr_Stock_Price:  102.38063597152667
curr_Factors:  [102.38063597]
mat_Sqrt:  [[0.15]]
grads:  [0.06592936]
Stock Position:  0.06592935739101083
Bond Position:  [2.23444843]


portfolio before change:  [8.95309336]
curr_Stock_Price:  101.90460716761469
curr_Factors:  [101.90460717]
mat_Sqrt:  [[0.15]]
grads:  [-0.06358196]
Stock Position:  -0.0635819606144511
Bond Position:  [15.43238808]


portfolio before change:  [8.94717166]
curr_Stock_Price:  102.01291221259225
curr_Factors:  [102.01291221]
mat_Sqrt:  [[0.15]]
grads:  [0.13317543]
Stock Position:  0.13317543031746298
Bond Position:  [-4.63844182]


portfolio before change:  [8.99456056]
curr_Stock_Price:  102.37092726377995
curr_Factors:  [102.37092726]
mat_Sqrt:  [[0.15]]
grads:  [0.07668292]
Stock Position:  0.07668291746335182
Bond Position:  [1.14445919]


portfolio before change:  [8.96126261]
curr_Stock_Price:  101.93576538730102
curr_Factors:  [101.93576539]
mat_Sqrt:  [[0.15]]
grads:  [-0.00919987]
Stock Position:  -0.009199871651306934
Bond Position:  [9.89905857]


portfolio before change:  [8.9633762]
curr_Stock_Price:  101.77327561665108
curr_Factors:  [101.77327562]
mat_Sqrt:  [[0.15]]
grads:  [-0.06731485]
Stock Position:  -0.06731485107254796
Bond Position:  [15.8142291]


portfolio before change:  [9.00340661]
curr_Stock_Price:  101.19328491768204
curr_Factors:  [101.19328492]
mat_Sqrt:  [[0.15]]
grads:  [0.08843403]
Stock Position:  0.08843403199609255
Bond Position:  [0.05447642]


portfolio before change:  [8.99374861]
curr_Stock_Price:  101.08403500058331
curr_Factors:  [101.084035]
mat_Sqrt:  [[0.15]]
grads:  [0.13037579]
Stock Position:  0.13037579134516455
Bond Position:  [-4.18516245]


portfolio before change:  [9.10171332]
curr_Stock_Price:  101.91414537222894
curr_Factors:  [101.91414537]
mat_Sqrt:  [[0.15]]
grads:  [0.12196301]
Stock Position:  0.1219630057404715
Bond Position:  [-3.32804217]


portfolio before change:  [9.11695417]
curr_Stock_Price:  102.0408137694969
curr_Factors:  [102.04081377]
mat_Sqrt:  [[0.15]]
grads:  [-0.00627253]
Stock Position:  -0.006272528965633965
Bond Position:  [9.75700813]


portfolio before change:  [9.11785685]
curr_Stock_Price:  101.99412670726272
curr_Factors:  [101.99412671]
mat_Sqrt:  [[0.15]]
grads:  [0.3631791]
Stock Position:  0.3631791034969239
Bond Position:  [-27.92427865]


portfolio before change:  [8.87422716]
curr_Stock_Price:  101.32810718542248
curr_Factors:  [101.32810719]
mat_Sqrt:  [[0.15]]
grads:  [-0.08720823]
Stock Position:  -0.08720823403677294
Bond Position:  [17.71087244]


portfolio before change:  [8.7804387]
curr_Stock_Price:  102.4162546418888
curr_Factors:  [102.41625464]
mat_Sqrt:  [[0.15]]
grads:  [0.05302646]
Stock Position:  0.05302646312400121
Bond Position:  [3.34966695]


portfolio before change:  [8.73144283]
curr_Stock_Price:  101.48831735192609
curr_Factors:  [101.48831735]
mat_Sqrt:  [[0.15]]
grads:  [-0.01060274]
Stock Position:  -0.0106027444443933
Bond Position:  [9.80749752]


portfolio before change:  [8.73331387]
curr_Stock_Price:  101.36966410293547
curr_Factors:  [101.3696641]
mat_Sqrt:  [[0.15]]
grads:  [0.10519351]
Stock Position:  0.10519350567657869
Bond Position:  [-1.93011647]


portfolio before change:  [8.80243161]
curr_Stock_Price:  102.02786424265473
curr_Factors:  [102.02786424]
mat_Sqrt:  [[0.15]]
grads:  [0.12037022]
Stock Position:  0.12037021898112994
Bond Position:  [-3.47868475]


portfolio before change:  [8.7637991]
curr_Stock_Price:  101.70872309863425
curr_Factors:  [101.7087231]
mat_Sqrt:  [[0.15]]
grads:  [0.07619301]
Stock Position:  0.07619300984551114
Bond Position:  [1.01430536]


portfolio before change:  [8.75580231]
curr_Stock_Price:  101.6029367709339
curr_Factors:  [101.60293677]
mat_Sqrt:  [[0.15]]
grads:  [0.02656057]
Stock Position:  0.02656056816653339
Bond Position:  [6.05717059]


portfolio before change:  [8.76420558]
curr_Stock_Price:  101.90506445836078
curr_Factors:  [101.90506446]
mat_Sqrt:  [[0.15]]
grads:  [0.03435537]
Stock Position:  0.03435537294806794
Bond Position:  [5.26321909]


portfolio before change:  [8.73474337]
curr_Stock_Price:  101.03791690140689
curr_Factors:  [101.0379169]
mat_Sqrt:  [[0.15]]
grads:  [-0.18467272]
Stock Position:  -0.18467271881607245
Bond Position:  [27.39369018]


portfolio before change:  [8.8807437]
curr_Stock_Price:  100.25659861827128
curr_Factors:  [100.25659862]
mat_Sqrt:  [[0.15]]
grads:  [-0.03124198]
Stock Position:  -0.03124197557803388
Bond Position:  [12.0129579]


portfolio before change:  [8.90572257]
curr_Stock_Price:  99.48110206322593
curr_Factors:  [99.48110206]
mat_Sqrt:  [[0.15]]
grads:  [-0.05981931]
Stock Position:  -0.059819311788569765
Bond Position:  [14.85661364]


portfolio before change:  [8.89316539]
curr_Stock_Price:  99.70654357775096
curr_Factors:  [99.70654358]
mat_Sqrt:  [[0.15]]
grads:  [0.10309186]
Stock Position:  0.10309186473076637
Bond Position:  [-1.38576812]


portfolio before change:  [8.75604055]
curr_Stock_Price:  98.37726094661744
curr_Factors:  [98.37726095]
mat_Sqrt:  [[0.15]]
grads:  [0.11252285]
Stock Position:  0.11252284859888155
Bond Position:  [-2.31364909]


portfolio before change:  [8.78049146]
curr_Stock_Price:  98.59584340846513
curr_Factors:  [98.59584341]
mat_Sqrt:  [[0.15]]
grads:  [-0.10311947]
Stock Position:  -0.10311946711561014
Bond Position:  [18.94764229]


portfolio before change:  [8.86518964]
curr_Stock_Price:  97.7859681109177
curr_Factors:  [97.78596811]
mat_Sqrt:  [[0.15]]
grads:  [0.05036381]
Stock Position:  0.05036381203365535
Bond Position:  [3.94031552]


portfolio before change:  [8.86893631]
curr_Stock_Price:  97.85547028225537
curr_Factors:  [97.85547028]
mat_Sqrt:  [[0.15]]
grads:  [-0.01758472]
Stock Position:  -0.017584716566385713
Bond Position:  [10.58969702]


portfolio before change:  [8.87317315]
curr_Stock_Price:  97.65217052226683
curr_Factors:  [97.65217052]
mat_Sqrt:  [[0.15]]
grads:  [0.02607776]
Stock Position:  0.02607776047332388
Bond Position:  [6.32662324]


portfolio before change:  [8.86307359]
curr_Stock_Price:  97.24972087642433
curr_Factors:  [97.24972088]
mat_Sqrt:  [[0.15]]
grads:  [0.03323027]
Stock Position:  0.033230273605747776
Bond Position:  [5.63143876]


portfolio before change:  [8.85621836]
curr_Stock_Price:  97.03283408929812
curr_Factors:  [97.03283409]
mat_Sqrt:  [[0.15]]
grads:  [-0.10870586]
Stock Position:  -0.10870586216226076
Bond Position:  [19.40425625]


portfolio before change:  [8.88029836]
curr_Stock_Price:  96.82247566822318
curr_Factors:  [96.82247567]
mat_Sqrt:  [[0.15]]
grads:  [0.28098382]
Stock Position:  0.28098382429122076
Bond Position:  [-18.32525113]


portfolio before change:  [8.94210999]
curr_Stock_Price:  97.04653481073176
curr_Factors:  [97.04653481]
mat_Sqrt:  [[0.15]]
grads:  [0.00162237]
Stock Position:  0.0016223671595388233
Bond Position:  [8.78466488]


portfolio before change:  [8.94131314]
curr_Stock_Price:  96.21693786276882
curr_Factors:  [96.21693786]
mat_Sqrt:  [[0.15]]
grads:  [0.04969291]
Stock Position:  0.049692914814956454
Bond Position:  [4.16001304]


portfolio before change:  [8.96479165]
curr_Stock_Price:  96.68417749815117
curr_Factors:  [96.6841775]
mat_Sqrt:  [[0.15]]
grads:  [-0.06113555]
Stock Position:  -0.06113554605177462
Bond Position:  [14.87563163]


portfolio before change:  [8.91358346]
curr_Stock_Price:  97.53700277895683
curr_Factors:  [97.53700278]
mat_Sqrt:  [[0.15]]
grads:  [0.00566495]
Stock Position:  0.005664946649397771
Bond Position:  [8.36104155]


portfolio before change:  [8.91567251]
curr_Stock_Price:  97.81352268881207
curr_Factors:  [97.81352269]
mat_Sqrt:  [[0.15]]
grads:  [-0.03234164]
Stock Position:  -0.032341644916791076
Bond Position:  [12.07912273]


portfolio before change:  [8.92170496]
curr_Stock_Price:  97.6503436444934
curr_Factors:  [97.65034364]
mat_Sqrt:  [[0.15]]
grads:  [-0.09058477]
Stock Position:  -0.0905847700293753
Bond Position:  [17.76733888]


portfolio before change:  [8.99042465]
curr_Stock_Price:  96.90397988522625
curr_Factors:  [96.90397989]
mat_Sqrt:  [[0.15]]
grads:  [-0.00123719]
Stock Position:  -0.00123718963804209
Bond Position:  [9.11031324]


portfolio before change:  [8.99136704]
curr_Stock_Price:  96.60250297833979
curr_Factors:  [96.60250298]
mat_Sqrt:  [[0.15]]
grads:  [-0.01809139]
Stock Position:  -0.018091394628355673
Bond Position:  [10.73904105]


portfolio before change:  [8.99888245]
curr_Stock_Price:  96.22419076851887
curr_Factors:  [96.22419077]
mat_Sqrt:  [[0.15]]
grads:  [-0.02404106]
Stock Position:  -0.02404106410284493
Bond Position:  [11.31221439]


portfolio before change:  [9.00953415]
curr_Stock_Price:  95.81053735539238
curr_Factors:  [95.81053736]
mat_Sqrt:  [[0.15]]
grads:  [-0.02678552]
Stock Position:  -0.026785518498134566
Bond Position:  [11.57586907]


portfolio before change:  [9.02677341]
curr_Stock_Price:  95.19394505549097
curr_Factors:  [95.19394506]
mat_Sqrt:  [[0.15]]
grads:  [0.01868732]
Stock Position:  0.018687320433657506
Bond Position:  [7.24785366]


portfolio before change:  [9.0225972]
curr_Stock_Price:  94.94622556630745
curr_Factors:  [94.94622557]
mat_Sqrt:  [[0.15]]
grads:  [0.02581908]
Stock Position:  0.025819084557792697
Bond Position:  [6.57117258]


portfolio before change:  [9.01518219]
curr_Stock_Price:  94.64312703950137
curr_Factors:  [94.64312704]
mat_Sqrt:  [[0.15]]
grads:  [-0.01164531]
Stock Position:  -0.011645307335636667
Bond Position:  [10.11733049]


portfolio before change:  [9.01308071]
curr_Stock_Price:  94.87788483345541
curr_Factors:  [94.87788483]
mat_Sqrt:  [[0.15]]
grads:  [0.09693838]
Stock Position:  0.09693838179852593
Bond Position:  [-0.18422791]


portfolio before change:  [9.08434892]
curr_Stock_Price:  95.61319444698404
curr_Factors:  [95.61319445]
mat_Sqrt:  [[0.15]]
grads:  [0.05923022]
Stock Position:  0.059230223308047066
Bond Position:  [3.42115806]


portfolio before change:  [9.11385436]
curr_Stock_Price:  96.10773267600533
curr_Factors:  [96.10773268]
mat_Sqrt:  [[0.15]]
grads:  [0.0627143]
Stock Position:  0.06271430423604589
Bond Position:  [3.08652477]


portfolio before change:  [9.14146586]
curr_Stock_Price:  96.54493087930132
curr_Factors:  [96.54493088]
mat_Sqrt:  [[0.15]]
grads:  [0.03510345]
Stock Position:  0.035103446302556116
Bond Position:  [5.75240606]


portfolio before change:  [9.14369593]
curr_Stock_Price:  96.59821725211782
curr_Factors:  [96.59821725]
mat_Sqrt:  [[0.15]]
grads:  [0.0897931]
Stock Position:  0.0897931033977417
Bond Position:  [0.46984222]


portfolio before change:  [9.18828299]
curr_Stock_Price:  97.09444347799356
curr_Factors:  [97.09444348]
mat_Sqrt:  [[0.15]]
grads:  [-0.00698051]
Stock Position:  -0.006980512064839305
Bond Position:  [9.86605192]


portfolio before change:  [9.1866654]
curr_Stock_Price:  97.41451144305233
curr_Factors:  [97.41451144]
mat_Sqrt:  [[0.15]]
grads:  [0.01573415]
Stock Position:  0.015734145039885915
Bond Position:  [7.65393134]


portfolio before change:  [9.18656568]
curr_Stock_Price:  97.37776941472181
curr_Factors:  [97.37776941]
mat_Sqrt:  [[0.15]]
grads:  [-0.1105239]
Stock Position:  -0.11052390033122111
Bond Position:  [19.94913656]


portfolio before change:  [9.20146107]
curr_Stock_Price:  97.25427996674216
curr_Factors:  [97.25427997]
mat_Sqrt:  [[0.15]]
grads:  [-0.08478043]
Stock Position:  -0.0847804311878076
Bond Position:  [17.44672086]


portfolio before change:  [9.22011136]
curr_Stock_Price:  97.04715870178194
curr_Factors:  [97.0471587]
mat_Sqrt:  [[0.15]]
grads:  [-0.00926477]
Stock Position:  -0.00926477263561869
Bond Position:  [10.11923122]


portfolio before change:  [9.21984898]
curr_Stock_Price:  97.1437450179023
curr_Factors:  [97.14374502]
mat_Sqrt:  [[0.15]]
grads:  [-0.06440796]
Stock Position:  -0.0644079579964931
Bond Position:  [15.47667923]


portfolio before change:  [9.21180227]
curr_Stock_Price:  97.28369715813542
curr_Factors:  [97.28369716]
mat_Sqrt:  [[0.15]]
grads:  [-0.12895184]
Stock Position:  -0.12895184160116957
Bond Position:  [21.75671418]


portfolio before change:  [9.10377207]
curr_Stock_Price:  98.1319986334
curr_Factors:  [98.13199863]
mat_Sqrt:  [[0.15]]
grads:  [0.06912858]
Stock Position:  0.06912858409538525
Bond Position:  [2.32004595]


portfolio before change:  [9.06459158]
curr_Stock_Price:  97.56312407654283
curr_Factors:  [97.56312408]
mat_Sqrt:  [[0.15]]
grads:  [0.01506081]
Stock Position:  0.015060812099150491
Bond Position:  [7.5952117]


portfolio before change:  [9.06665975]
curr_Stock_Price:  97.66892501882558
curr_Factors:  [97.66892502]
mat_Sqrt:  [[0.15]]
grads:  [0.06836564]
Stock Position:  0.06836564252801983
Bond Position:  [2.38946093]


portfolio before change:  [9.01812258]
curr_Stock_Price:  96.95677616931798
curr_Factors:  [96.95677617]
mat_Sqrt:  [[0.15]]
grads:  [-0.11980925]
Stock Position:  -0.11980925384133172
Bond Position:  [20.63444159]


portfolio before change:  [8.99516884]
curr_Stock_Price:  97.1591264589238
curr_Factors:  [97.15912646]
mat_Sqrt:  [[0.15]]
grads:  [0.04070387]
Stock Position:  0.040703872078197284
Bond Position:  [5.04041618]


portfolio before change:  [8.98583296]
curr_Stock_Price:  96.92202590149088
curr_Factors:  [96.9220259]
mat_Sqrt:  [[0.15]]
grads:  [0.01030188]
Stock Position:  0.01030188309704928
Bond Position:  [7.98735358]


portfolio before change:  [8.99606414]
curr_Stock_Price:  97.86670307486288
curr_Factors:  [97.86670307]
mat_Sqrt:  [[0.15]]
grads:  [0.00190013]
Stock Position:  0.0019001316463777406
Bond Position:  [8.81010452]


portfolio before change:  [8.9960527]
curr_Stock_Price:  97.57088615204657
curr_Factors:  [97.57088615]
mat_Sqrt:  [[0.15]]
grads:  [0.05505747]
Stock Position:  0.055057473785908896
Bond Position:  [3.62404619]


portfolio before change:  [9.00306946]
curr_Stock_Price:  97.69421635257503
curr_Factors:  [97.69421635]
mat_Sqrt:  [[0.15]]
grads:  [0.01020881]
Stock Position:  0.01020881279453729
Bond Position:  [8.00572749]


portfolio before change:  [9.00467215]
curr_Stock_Price:  97.80219320960411
curr_Factors:  [97.80219321]
mat_Sqrt:  [[0.15]]
grads:  [0.00513355]
Stock Position:  0.005133551970329797
Bond Position:  [8.5025995]


portfolio before change:  [9.00354878]
curr_Stock_Price:  97.47984435378075
curr_Factors:  [97.47984435]
mat_Sqrt:  [[0.15]]
grads:  [0.00704261]
Stock Position:  0.007042613892874437
Bond Position:  [8.31703587]


portfolio before change:  [8.99938264]
curr_Stock_Price:  96.81447081594084
curr_Factors:  [96.81447082]
mat_Sqrt:  [[0.15]]
grads:  [-0.07488509]
Stock Position:  -0.07488509102712722
Bond Position:  [16.2493431]


portfolio before change:  [8.92942642]
curr_Stock_Price:  97.76221400036145
curr_Factors:  [97.762214]
mat_Sqrt:  [[0.15]]
grads:  [-0.1108671]
Stock Position:  -0.11086710472049464
Bond Position:  [19.76804004]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.92942642]
Stock Price:  98.1781359635703
PL:  [8.92942642]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-5.12385059e-02]
 [-1.33965434e-03]
 [ 5.63225948e-03]
 [ 2.52762550e-03]
 [ 6.27266961e-03]
 [ 1.23008606e-02]
 [-3.04759822e-04]
 [ 8.51194219e-03]
 [ 1.34538360e-02]
 [-2.02808343e-02]
 [ 1.02478838e-02]
 [-6.01920995e-03]
 [ 1.17472246e-02]
 [ 4.07643330e-03]
 [ 2.53156136e-04]
 [-1.01509246e-02]
 [ 8.00798190e-03]
 [ 2.55696273e-02]
 [ 1.27921282e-02]
 [-8.65143297e-04]
 [ 6.25087466e-02]
 [-1.31066540e-02]
 [ 5.15522394e-03]
 [ 8.60073571e-04]
 [ 1.74721714e-02]
 [ 1.82332959e-02]
 [ 9.66395502e-03]
 [ 1.53581941e-03]
 [ 7.28462876e-03]
 [-9.98591632e-03]
 [-5.70715579e-03]
 [ 3.63918648e-02]
 [ 6.57199973e-03]
 [-8.34797641e-04]
 [-1.18919880e-03]
 [-4.51248974e-03]
 [-5.37297741e-03]
 [ 3.40620393e-03]
 [ 3.16253619e-03]
 [-8.07039039e-03]
 [-3.62357205e-02]
 [-2.40835851e-03]
 [ 1.12694101e-02]
 [-1.22467065e-02]
 [-3.52701329e-04]
 [ 2.27855271e-03]
 [-1.36599976e-02]
 [-2.36412847e-04]
 [ 3.81411423e-03]
 [-9.01295300e-03]
 [-3.78182752e-03]
 [ 3.44809816e-03]
 [ 1.22674133e-03]
 [ 3.59506313e-03]
 [-3.62974521e-03]
 [ 8.51992999e-03]
 [-3.71705423e-03]
 [-1.79188679e-02]
 [ 1.34639172e-02]
 [ 6.74481059e-03]
 [ 8.89571528e-03]
 [-1.23706473e-02]
 [-1.25525361e-02]
 [-2.20286001e-03]
 [-1.23930610e-02]
 [ 4.19891846e-02]
 [ 2.01756314e-02]
 [ 2.16790441e-03]
 [ 6.30397041e-03]
 [-1.78668486e-02]
 [-7.77485737e-03]
 [-7.85428207e-03]
 [ 1.61060291e-03]
 [ 7.93028390e-03]
 [ 1.81245542e-03]
 [-1.30551499e-02]
 [ 3.98047155e-03]
 [-7.11461749e-03]
 [ 1.19237366e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.3659802]
curr_Stock_Price:  100.4048751259614
curr_Factors:  [100.40487513]
mat_Sqrt:  [[0.15]]
grads:  [-0.34159004]
Stock Position:  -0.3415900396523075
Bond Position:  [42.66328547]


portfolio before change:  [8.32860492]
curr_Stock_Price:  100.52209698551142
curr_Factors:  [100.52209699]
mat_Sqrt:  [[0.15]]
grads:  [-0.00893103]
Stock Position:  -0.008931028904844313
Bond Position:  [9.22637067]


portfolio before change:  [8.3228347]
curr_Stock_Price:  101.23275245597542
curr_Factors:  [101.23275246]
mat_Sqrt:  [[0.15]]
grads:  [0.0375484]
Stock Position:  0.03754839650989487
Bond Position:  [4.52170717]


portfolio before change:  [8.31290889]
curr_Stock_Price:  100.96087867979446
curr_Factors:  [100.96087868]
mat_Sqrt:  [[0.15]]
grads:  [0.01685084]
Stock Position:  0.016850836676765138
Bond Position:  [6.61163361]


portfolio before change:  [8.31982984]
curr_Stock_Price:  101.34707391678153
curr_Factors:  [101.34707392]
mat_Sqrt:  [[0.15]]
grads:  [0.0418178]
Stock Position:  0.041817797432016746
Bond Position:  [4.08171844]


portfolio before change:  [8.35411261]
curr_Stock_Price:  102.16078602496566
curr_Factors:  [102.16078602]
mat_Sqrt:  [[0.15]]
grads:  [0.08200574]
Stock Position:  0.08200573758448049
Bond Position:  [-0.023658]


portfolio before change:  [8.32417206]
curr_Stock_Price:  101.79570101564592
curr_Factors:  [101.79570102]
mat_Sqrt:  [[0.15]]
grads:  [-0.00203173]
Stock Position:  -0.002031732143876075
Bond Position:  [8.53099366]


portfolio before change:  [8.32651278]
curr_Stock_Price:  100.90605928528332
curr_Factors:  [100.90605929]
mat_Sqrt:  [[0.15]]
grads:  [0.05674628]
Stock Position:  0.05674628125046047
Bond Position:  [2.60046916]


portfolio before change:  [8.27413687]
curr_Stock_Price:  99.98021108122369
curr_Factors:  [99.98021108]
mat_Sqrt:  [[0.15]]
grads:  [0.08969224]
Stock Position:  0.08969224003025729
Bond Position:  [-0.69331222]


portfolio before change:  [8.32331009]
curr_Stock_Price:  100.5289380945676
curr_Factors:  [100.52893809]
mat_Sqrt:  [[0.15]]
grads:  [-0.13520556]
Stock Position:  -0.13520556206532985
Bond Position:  [21.91538167]


portfolio before change:  [8.31357054]
curr_Stock_Price:  100.61110415887988
curr_Factors:  [100.61110416]
mat_Sqrt:  [[0.15]]
grads:  [0.06831923]
Stock Position:  0.06831922554159335
Bond Position:  [1.43989782]


portfolio before change:  [8.30812676]
curr_Stock_Price:  100.53010539760488
curr_Factors:  [100.5301054]
mat_Sqrt:  [[0.15]]
grads:  [-0.04012807]
Stock Position:  -0.04012806636657127
Bond Position:  [12.3422055]


portfolio before change:  [8.2761229]
curr_Stock_Price:  101.34687234907551
curr_Factors:  [101.34687235]
mat_Sqrt:  [[0.15]]
grads:  [0.07831483]
Stock Position:  0.07831483034334982
Bond Position:  [0.33915978]


portfolio before change:  [8.2689149]
curr_Stock_Price:  101.25456303148047
curr_Factors:  [101.25456303]
mat_Sqrt:  [[0.15]]
grads:  [0.02717622]
Stock Position:  0.027176221978481692
Bond Position:  [5.51719842]


portfolio before change:  [8.28050893]
curr_Stock_Price:  101.6684978829809
curr_Factors:  [101.66849788]
mat_Sqrt:  [[0.15]]
grads:  [0.00168771]
Stock Position:  0.0016877075716892921
Bond Position:  [8.10892223]


portfolio before change:  [8.28034115]
curr_Stock_Price:  101.26878339143445
curr_Factors:  [101.26878339]
mat_Sqrt:  [[0.15]]
grads:  [-0.06767283]
Stock Position:  -0.06767283075597944
Bond Position:  [15.13348639]


portfolio before change:  [8.23217329]
curr_Stock_Price:  101.99453592724004
curr_Factors:  [101.99453593]
mat_Sqrt:  [[0.15]]
grads:  [0.05338655]
Stock Position:  0.05338654601763663
Bond Position:  [2.78703731]


portfolio before change:  [8.24056423]
curr_Stock_Price:  102.1484463178532
curr_Factors:  [102.14844632]
mat_Sqrt:  [[0.15]]
grads:  [0.17046418]
Stock Position:  0.17046418221038082
Bond Position:  [-9.17208713]


portfolio before change:  [8.30345373]
curr_Stock_Price:  102.52074018023126
curr_Factors:  [102.52074018]
mat_Sqrt:  [[0.15]]
grads:  [0.08528085]
Stock Position:  0.08528085436564094
Bond Position:  [-0.43960259]


portfolio before change:  [8.25838351]
curr_Stock_Price:  101.9925707452693
curr_Factors:  [101.99257075]
mat_Sqrt:  [[0.15]]
grads:  [-0.00576762]
Stock Position:  -0.005767621982427773
Bond Position:  [8.8466381]


portfolio before change:  [8.26124264]
curr_Stock_Price:  101.59271907860501
curr_Factors:  [101.59271908]
mat_Sqrt:  [[0.15]]
grads:  [0.41672498]
Stock Position:  0.41672497705605516
Bond Position:  [-34.07498089]


portfolio before change:  [8.09789142]
curr_Stock_Price:  101.20584170227276
curr_Factors:  [101.2058417]
mat_Sqrt:  [[0.15]]
grads:  [-0.08737769]
Stock Position:  -0.08737769322028487
Bond Position:  [16.94102441]


portfolio before change:  [8.1077363]
curr_Stock_Price:  101.1052893105643
curr_Factors:  [101.10528931]
mat_Sqrt:  [[0.15]]
grads:  [0.03436816]
Stock Position:  0.03436815962028769
Bond Position:  [4.63293358]


portfolio before change:  [8.11199395]
curr_Stock_Price:  101.22074743453925
curr_Factors:  [101.22074743]
mat_Sqrt:  [[0.15]]
grads:  [0.00573382]
Stock Position:  0.005733823806535962
Bond Position:  [7.53161202]


portfolio before change:  [8.12000936]
curr_Stock_Price:  102.53656466884453
curr_Factors:  [102.53656467]
mat_Sqrt:  [[0.15]]
grads:  [0.11648114]
Stock Position:  0.11648114287391202
Bond Position:  [-3.82356688]


portfolio before change:  [8.12913582]
curr_Stock_Price:  102.61696778524468
curr_Factors:  [102.61696779]
mat_Sqrt:  [[0.15]]
grads:  [0.12155531]
Stock Position:  0.12155530591781238
Bond Position:  [-4.34450109]


portfolio before change:  [8.15650661]
curr_Stock_Price:  102.8443731145164
curr_Factors:  [102.84437311]
mat_Sqrt:  [[0.15]]
grads:  [0.06442637]
Stock Position:  0.06442636680356424
Bond Position:  [1.5306173]


portfolio before change:  [8.16839585]
curr_Stock_Price:  103.02742822587037
curr_Factors:  [103.02742823]
mat_Sqrt:  [[0.15]]
grads:  [0.0102388]
Stock Position:  0.010238796081034573
Bond Position:  [7.11351902]


portfolio before change:  [8.17253196]
curr_Stock_Price:  103.38796864726754
curr_Factors:  [103.38796865]
mat_Sqrt:  [[0.15]]
grads:  [0.04856419]
Stock Position:  0.04856419173306801
Bond Position:  [3.15157883]


portfolio before change:  [8.16851242]
curr_Stock_Price:  103.30114510024546
curr_Factors:  [103.3011451]
mat_Sqrt:  [[0.15]]
grads:  [-0.06657278]
Stock Position:  -0.06657277546757229
Bond Position:  [15.04555636]


portfolio before change:  [8.19818654]
curr_Stock_Price:  102.86953117373406
curr_Factors:  [102.86953117]
mat_Sqrt:  [[0.15]]
grads:  [-0.03804771]
Stock Position:  -0.03804770527494854
Bond Position:  [12.11213614]


portfolio before change:  [8.20269784]
curr_Stock_Price:  102.77085849473
curr_Factors:  [102.77085849]
mat_Sqrt:  [[0.15]]
grads:  [0.24261243]
Stock Position:  0.24261243219475132
Bond Position:  [-16.7307901]


portfolio before change:  [8.17582189]
curr_Stock_Price:  102.66439142336897
curr_Factors:  [102.66439142]
mat_Sqrt:  [[0.15]]
grads:  [0.04381333]
Stock Position:  0.043813331530064344
Bond Position:  [3.67775288]


portfolio before change:  [8.16206341]
curr_Stock_Price:  102.34511994560475
curr_Factors:  [102.34511995]
mat_Sqrt:  [[0.15]]
grads:  [-0.00556532]
Stock Position:  -0.0055653176066816695
Bond Position:  [8.73164651]


portfolio before change:  [8.16667722]
curr_Stock_Price:  101.61415284964419
curr_Factors:  [101.61415285]
mat_Sqrt:  [[0.15]]
grads:  [-0.00792799]
Stock Position:  -0.00792799197141817
Bond Position:  [8.97227341]


portfolio before change:  [8.16606344]
curr_Stock_Price:  101.76230727457222
curr_Factors:  [101.76230727]
mat_Sqrt:  [[0.15]]
grads:  [-0.03008326]
Stock Position:  -0.03008326494591002
Bond Position:  [11.22740589]


portfolio before change:  [8.12388885]
curr_Stock_Price:  103.187562379658
curr_Factors:  [103.18756238]
mat_Sqrt:  [[0.15]]
grads:  [-0.03581985]
Stock Position:  -0.035819849423499125
Bond Position:  [11.8200518]


portfolio before change:  [8.13409741]
curr_Stock_Price:  102.92318973856042
curr_Factors:  [102.92318974]
mat_Sqrt:  [[0.15]]
grads:  [0.02270803]
Stock Position:  0.022708026196220348
Bond Position:  [5.79691492]


portfolio before change:  [8.14278004]
curr_Stock_Price:  103.2895937912731
curr_Factors:  [103.28959379]
mat_Sqrt:  [[0.15]]
grads:  [0.02108357]
Stock Position:  0.02108357458202697
Bond Position:  [5.96506619]


portfolio before change:  [8.1375554]
curr_Stock_Price:  103.02410412514008
curr_Factors:  [103.02410413]
mat_Sqrt:  [[0.15]]
grads:  [-0.0538026]
Stock Position:  -0.05380260261256129
Bond Position:  [13.68052034]


portfolio before change:  [8.13824016]
curr_Stock_Price:  103.02726939404451
curr_Factors:  [103.02726939]
mat_Sqrt:  [[0.15]]
grads:  [-0.24157147]
Stock Position:  -0.24157146984623915
Bond Position:  [33.02668906]


portfolio before change:  [8.26266958]
curr_Stock_Price:  102.52073114610452
curr_Factors:  [102.52073115]
mat_Sqrt:  [[0.15]]
grads:  [-0.01605572]
Stock Position:  -0.016055723394834284
Bond Position:  [9.90871408]


portfolio before change:  [8.26885576]
curr_Stock_Price:  102.17400966039769
curr_Factors:  [102.17400966]
mat_Sqrt:  [[0.15]]
grads:  [0.0751294]
Stock Position:  0.07512940043790223
Bond Position:  [0.59258368]


portfolio before change:  [8.34164169]
curr_Stock_Price:  103.14232418426678
curr_Factors:  [103.14232418]
mat_Sqrt:  [[0.15]]
grads:  [-0.08164471]
Stock Position:  -0.08164470989141878
Bond Position:  [16.76266682]


portfolio before change:  [8.38801162]
curr_Stock_Price:  102.58720884019122
curr_Factors:  [102.58720884]
mat_Sqrt:  [[0.15]]
grads:  [-0.00235134]
Stock Position:  -0.002351342193547823
Bond Position:  [8.62922925]


portfolio before change:  [8.38918003]
curr_Stock_Price:  102.31967372284804
curr_Factors:  [102.31967372]
mat_Sqrt:  [[0.15]]
grads:  [0.01519035]
Stock Position:  0.015190351415604354
Bond Position:  [6.83490823]


portfolio before change:  [8.38679168]
curr_Stock_Price:  102.13432287760175
curr_Factors:  [102.13432288]
mat_Sqrt:  [[0.15]]
grads:  [-0.09106665]
Stock Position:  -0.09106665039428724
Bond Position:  [17.68782235]


portfolio before change:  [8.36646047]
curr_Stock_Price:  102.36971897369264
curr_Factors:  [102.36971897]
mat_Sqrt:  [[0.15]]
grads:  [-0.00157609]
Stock Position:  -0.0015760856457528647
Bond Position:  [8.52780391]


portfolio before change:  [8.36680579]
curr_Stock_Price:  102.48880329730784
curr_Factors:  [102.4888033]
mat_Sqrt:  [[0.15]]
grads:  [0.02542743]
Stock Position:  0.025427428220662133
Bond Position:  [5.7607791]


portfolio before change:  [8.39005735]
curr_Stock_Price:  103.38907136393676
curr_Factors:  [103.38907136]
mat_Sqrt:  [[0.15]]
grads:  [-0.06008635]
Stock Position:  -0.06008635331895287
Bond Position:  [14.60232962]


portfolio before change:  [8.37189443]
curr_Stock_Price:  103.70654095433855
curr_Factors:  [103.70654095]
mat_Sqrt:  [[0.15]]
grads:  [-0.02521218]
Stock Position:  -0.02521218343761851
Bond Position:  [10.98656277]


portfolio before change:  [8.37729863]
curr_Stock_Price:  103.51942851711696
curr_Factors:  [103.51942852]
mat_Sqrt:  [[0.15]]
grads:  [0.02298732]
Stock Position:  0.02298732109005769
Bond Position:  [5.99766428]


portfolio before change:  [8.35802365]
curr_Stock_Price:  102.6646164376244
curr_Factors:  [102.66461644]
mat_Sqrt:  [[0.15]]
grads:  [0.00817828]
Stock Position:  0.008178275539729414
Bond Position:  [7.51840413]


portfolio before change:  [8.3598642]
curr_Stock_Price:  102.83221081980827
curr_Factors:  [102.83221082]
mat_Sqrt:  [[0.15]]
grads:  [0.02396709]
Stock Position:  0.023967087565172976
Bond Position:  [5.8952756]


portfolio before change:  [8.36152719]
curr_Stock_Price:  102.88622333261733
curr_Factors:  [102.88622333]
mat_Sqrt:  [[0.15]]
grads:  [-0.0241983]
Stock Position:  -0.02419830138123773
Bond Position:  [10.85119903]


portfolio before change:  [8.39200414]
curr_Stock_Price:  101.65478452196535
curr_Factors:  [101.65478452]
mat_Sqrt:  [[0.15]]
grads:  [0.05679953]
Stock Position:  0.056799533256441305
Bond Position:  [2.61805982]


portfolio before change:  [8.35874285]
curr_Stock_Price:  101.06631277746611
curr_Factors:  [101.06631278]
mat_Sqrt:  [[0.15]]
grads:  [-0.02478036]
Stock Position:  -0.02478036151302408
Bond Position:  [10.86320262]


portfolio before change:  [8.35346392]
curr_Stock_Price:  101.30674141015751
curr_Factors:  [101.30674141]
mat_Sqrt:  [[0.15]]
grads:  [-0.11945912]
Stock Position:  -0.11945911937511738
Bond Position:  [20.45547803]


portfolio before change:  [8.38632312]
curr_Stock_Price:  101.0423773271836
curr_Factors:  [101.04237733]
mat_Sqrt:  [[0.15]]
grads:  [0.08975945]
Stock Position:  0.08975944777729046
Bond Position:  [-0.68318487]


portfolio before change:  [8.38725479]
curr_Stock_Price:  101.05323263567547
curr_Factors:  [101.05323264]
mat_Sqrt:  [[0.15]]
grads:  [0.0449654]
Stock Position:  0.04496540395688494
Bond Position:  [3.84335536]


portfolio before change:  [8.37152155]
curr_Stock_Price:  100.69799382942898
curr_Factors:  [100.69799383]
mat_Sqrt:  [[0.15]]
grads:  [0.05930477]
Stock Position:  0.059304768519258894
Bond Position:  [2.39965034]


portfolio before change:  [8.32292381]
curr_Stock_Price:  99.87600726800501
curr_Factors:  [99.87600727]
mat_Sqrt:  [[0.15]]
grads:  [-0.08247098]
Stock Position:  -0.08247098225582944
Bond Position:  [16.55979623]


portfolio before change:  [8.25460025]
curr_Stock_Price:  100.71701319003839
curr_Factors:  [100.71701319]
mat_Sqrt:  [[0.15]]
grads:  [-0.08368357]
Stock Position:  -0.08368357430807384
Bond Position:  [16.6829599]


portfolio before change:  [8.30506891]
curr_Stock_Price:  100.12638421044828
curr_Factors:  [100.12638421]
mat_Sqrt:  [[0.15]]
grads:  [-0.01468573]
Stock Position:  -0.01468573337141303
Bond Position:  [9.77549829]


portfolio before change:  [8.3129572]
curr_Stock_Price:  99.63084864805217
curr_Factors:  [99.63084865]
mat_Sqrt:  [[0.15]]
grads:  [-0.08262041]
Stock Position:  -0.08262040693695495
Bond Position:  [16.54449846]


portfolio before change:  [8.27764164]
curr_Stock_Price:  100.07080797512799
curr_Factors:  [100.07080798]
mat_Sqrt:  [[0.15]]
grads:  [0.2799279]
Stock Position:  0.2799278974952675
Bond Position:  [-19.73496923]


portfolio before change:  [8.44654478]
curr_Stock_Price:  100.67859523974093
curr_Factors:  [100.67859524]
mat_Sqrt:  [[0.15]]
grads:  [0.13450421]
Stock Position:  0.13450420927755738
Bond Position:  [-5.09515006]


portfolio before change:  [8.45056517]
curr_Stock_Price:  100.71085330076724
curr_Factors:  [100.7108533]
mat_Sqrt:  [[0.15]]
grads:  [0.0144527]
Stock Position:  0.014452696069695547
Bond Position:  [6.99502181]


portfolio before change:  [8.46347279]
curr_Stock_Price:  101.57369733464766
curr_Factors:  [101.57369733]
mat_Sqrt:  [[0.15]]
grads:  [0.04202647]
Stock Position:  0.04202646937637909
Bond Position:  [4.19468891]


portfolio before change:  [8.52640068]
curr_Stock_Price:  103.06479826945406
curr_Factors:  [103.06479827]
mat_Sqrt:  [[0.15]]
grads:  [-0.11911232]
Stock Position:  -0.11911232366703432
Bond Position:  [20.80268829]


portfolio before change:  [8.55145083]
curr_Stock_Price:  102.86540708911598
curr_Factors:  [102.86540709]
mat_Sqrt:  [[0.15]]
grads:  [-0.05183238]
Stock Position:  -0.051832382435200434
Bond Position:  [13.88320995]


portfolio before change:  [8.56131757]
curr_Stock_Price:  102.69178964995857
curr_Factors:  [102.69178965]
mat_Sqrt:  [[0.15]]
grads:  [-0.05236188]
Stock Position:  -0.05236188045480981
Bond Position:  [13.93845278]


portfolio before change:  [8.58439272]
curr_Stock_Price:  102.26774113315312
curr_Factors:  [102.26774113]
mat_Sqrt:  [[0.15]]
grads:  [0.01073735]
Stock Position:  0.010737352757802293
Bond Position:  [7.48630791]


portfolio before change:  [8.58568596]
curr_Stock_Price:  102.34460597120656
curr_Factors:  [102.34460597]
mat_Sqrt:  [[0.15]]
grads:  [0.05286856]
Stock Position:  0.05286855930890536
Bond Position:  [3.17487409]


portfolio before change:  [8.576662]
curr_Stock_Price:  102.17016601739492
curr_Factors:  [102.17016602]
mat_Sqrt:  [[0.15]]
grads:  [0.01208304]
Stock Position:  0.012083036123685869
Bond Position:  [7.3421362]


portfolio before change:  [8.58269646]
curr_Stock_Price:  102.63160306470444
curr_Factors:  [102.63160306]
mat_Sqrt:  [[0.15]]
grads:  [-0.08703433]
Stock Position:  -0.08703433293299506
Bond Position:  [17.51516957]


portfolio before change:  [8.65228716]
curr_Stock_Price:  101.84460369210892
curr_Factors:  [101.84460369]
mat_Sqrt:  [[0.15]]
grads:  [0.02653648]
Stock Position:  0.026536477015145013
Bond Position:  [5.94969018]


portfolio before change:  [8.63605628]
curr_Stock_Price:  101.2189461214555
curr_Factors:  [101.21894612]
mat_Sqrt:  [[0.15]]
grads:  [-0.04743078]
Stock Position:  -0.04743078327394452
Bond Position:  [13.43695018]


portfolio before change:  [8.6344983]
curr_Stock_Price:  101.26950007507277
curr_Factors:  [101.26950008]
mat_Sqrt:  [[0.15]]
grads:  [0.07949158]
Stock Position:  0.07949157738324239
Bond Position:  [0.584426]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.6344983]
Stock Price:  100.9405905939129
PL:  [7.69390771]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.37676972e-02]
 [ 1.40674842e-03]
 [ 5.70504236e-03]
 [ 2.48650317e-03]
 [ 5.85252732e-03]
 [ 1.18680997e-02]
 [-4.02750065e-04]
 [ 9.39962895e-03]
 [-5.70819843e-03]
 [-1.26985576e-02]
 [ 1.00346506e-02]
 [-1.01324824e-02]
 [ 2.65555955e-02]
 [ 1.97659209e-02]
 [-7.56266675e-03]
 [-6.87649913e-03]
 [ 1.70062361e-02]
 [ 2.13494337e-02]
 [ 1.19480110e-02]
 [-1.10552455e-03]
 [ 5.47668484e-02]
 [-1.25970773e-02]
 [ 6.38410160e-03]
 [-3.84553838e-03]
 [ 1.75083810e-02]
 [ 1.84068601e-02]
 [ 9.99513047e-03]
 [ 6.01265871e-03]
 [ 6.36211382e-03]
 [-1.24777662e-02]
 [-5.68596315e-03]
 [ 3.70072684e-02]
 [ 6.42952205e-03]
 [-7.30709156e-04]
 [-3.84270063e-03]
 [-4.43599699e-03]
 [-6.92564807e-03]
 [ 8.18906264e-03]
 [ 1.25797468e-03]
 [-8.71195579e-03]
 [-3.65624242e-02]
 [-2.72615957e-03]
 [ 1.29532610e-02]
 [-1.25879360e-02]
 [-1.42144867e-03]
 [ 2.54335049e-03]
 [-1.36182345e-02]
 [ 1.09323748e-02]
 [ 9.82843163e-03]
 [-1.19728617e-02]
 [-3.90993002e-03]
 [ 3.44592657e-03]
 [ 2.93093249e-03]
 [-1.69576568e-03]
 [-7.46163396e-03]
 [ 9.96619127e-03]
 [-1.15990961e-02]
 [-9.39375461e-03]
 [ 1.54226386e-02]
 [ 1.98338550e-03]
 [ 1.16410883e-02]
 [-1.53130935e-02]
 [-1.27547364e-02]
 [-3.34534495e-03]
 [ 2.34928970e-02]
 [-1.75248611e-02]
 [ 1.52911524e-02]
 [ 5.46227524e-03]
 [ 1.28406935e-02]
 [-2.62233183e-02]
 [-7.91811739e-03]
 [-6.28314884e-03]
 [ 7.44757162e-03]
 [ 5.09571260e-03]
 [-1.53456639e-03]
 [ 5.03476038e-03]
 [ 3.78375202e-03]
 [-2.67620166e-03]
 [ 2.05443319e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.91311697]
curr_Stock_Price:  100.24722798808013
curr_Factors:  [100.24722799]
mat_Sqrt:  [[0.15]]
grads:  [-0.29178465]
Stock Position:  -0.2917846477032009
Bond Position:  [35.16371907]


portfolio before change:  [5.66856278]
curr_Stock_Price:  101.09289271530893
curr_Factors:  [101.09289272]
mat_Sqrt:  [[0.15]]
grads:  [0.00937832]
Stock Position:  0.009378322770502996
Bond Position:  [4.720481]


portfolio before change:  [5.67022989]
curr_Stock_Price:  101.23919490914643
curr_Factors:  [101.23919491]
mat_Sqrt:  [[0.15]]
grads:  [0.03803362]
Stock Position:  0.0380336157065728
Bond Position:  [1.81973726]


portfolio before change:  [5.65811407]
curr_Stock_Price:  100.91764897599943
curr_Factors:  [100.91764898]
mat_Sqrt:  [[0.15]]
grads:  [0.01657669]
Stock Position:  0.01657668778630397
Bond Position:  [3.98523371]


portfolio before change:  [5.65507414]
curr_Stock_Price:  100.71923657492789
curr_Factors:  [100.71923657]
mat_Sqrt:  [[0.15]]
grads:  [0.03901685]
Stock Position:  0.03901684880303267
Bond Position:  [1.72532691]


portfolio before change:  [5.65576766]
curr_Stock_Price:  100.73424770174032
curr_Factors:  [100.7342477]
mat_Sqrt:  [[0.15]]
grads:  [0.07912066]
Stock Position:  0.07912066448325167
Bond Position:  [-2.31439295]


portfolio before change:  [5.74756567]
curr_Stock_Price:  101.89630396647121
curr_Factors:  [101.89630397]
mat_Sqrt:  [[0.15]]
grads:  [-0.002685]
Stock Position:  -0.0026850004350557305
Bond Position:  [6.02115729]


portfolio before change:  [5.75110401]
curr_Stock_Price:  100.71864839813334
curr_Factors:  [100.7186484]
mat_Sqrt:  [[0.15]]
grads:  [0.06266419]
Stock Position:  0.0626641930035083
Bond Position:  [-0.56034881]


portfolio before change:  [5.78985192]
curr_Stock_Price:  101.3375494643714
curr_Factors:  [101.33754946]
mat_Sqrt:  [[0.15]]
grads:  [-0.03805466]
Stock Position:  -0.03805465619845885
Bond Position:  [9.64621753]


portfolio before change:  [5.78180833]
curr_Stock_Price:  101.56476207200747
curr_Factors:  [101.56476207]
mat_Sqrt:  [[0.15]]
grads:  [-0.08465705]
Stock Position:  -0.08465705093007024
Bond Position:  [14.37998157]


portfolio before change:  [5.7726401]
curr_Stock_Price:  101.68367730593863
curr_Factors:  [101.68367731]
mat_Sqrt:  [[0.15]]
grads:  [0.06689767]
Stock Position:  0.06689767077617614
Bond Position:  [-1.02976107]


portfolio before change:  [5.79941765]
curr_Stock_Price:  102.08491571347447
curr_Factors:  [102.08491571]
mat_Sqrt:  [[0.15]]
grads:  [-0.06754988]
Stock Position:  -0.06754988237728819
Bond Position:  [12.6952417]


portfolio before change:  [5.76960821]
curr_Stock_Price:  102.53795752004571
curr_Factors:  [102.53795752]
mat_Sqrt:  [[0.15]]
grads:  [0.1770373]
Stock Position:  0.1770373031692662
Bond Position:  [-12.38343527]


portfolio before change:  [5.86714006]
curr_Stock_Price:  103.09324072863667
curr_Factors:  [103.09324073]
mat_Sqrt:  [[0.15]]
grads:  [0.13177281]
Stock Position:  0.131772805867195
Bond Position:  [-7.71774554]


portfolio before change:  [5.8475931]
curr_Stock_Price:  102.9485630373749
curr_Factors:  [102.94856304]
mat_Sqrt:  [[0.15]]
grads:  [-0.05041778]
Stock Position:  -0.05041777831576979
Bond Position:  [11.03803093]


portfolio before change:  [5.80851292]
curr_Stock_Price:  103.73737371980745
curr_Factors:  [103.73737372]
mat_Sqrt:  [[0.15]]
grads:  [-0.04584333]
Stock Position:  -0.0458433275125293
Bond Position:  [10.56417931]


portfolio before change:  [5.79283752]
curr_Stock_Price:  104.09371086982402
curr_Factors:  [104.09371087]
mat_Sqrt:  [[0.15]]
grads:  [0.11337491]
Stock Position:  0.11337490700406105
Bond Position:  [-6.00877727]


portfolio before change:  [5.7675836]
curr_Stock_Price:  103.87427646750729
curr_Factors:  [103.87427647]
mat_Sqrt:  [[0.15]]
grads:  [0.14232956]
Stock Position:  0.1423295578447843
Bond Position:  [-9.01679624]


portfolio before change:  [5.58168881]
curr_Stock_Price:  102.57214898586525
curr_Factors:  [102.57214899]
mat_Sqrt:  [[0.15]]
grads:  [0.07965341]
Stock Position:  0.07965340646601965
Bond Position:  [-2.58853227]


portfolio before change:  [5.54755818]
curr_Stock_Price:  102.14569094561996
curr_Factors:  [102.14569095]
mat_Sqrt:  [[0.15]]
grads:  [-0.00737016]
Stock Position:  -0.007370163690058757
Bond Position:  [6.30038864]


portfolio before change:  [5.54917571]
curr_Stock_Price:  101.97965081430567
curr_Factors:  [101.97965081]
mat_Sqrt:  [[0.15]]
grads:  [0.36511232]
Stock Position:  0.3651123229147966
Bond Position:  [-31.68485149]


portfolio before change:  [5.64881911]
curr_Stock_Price:  102.2579864344332
curr_Factors:  [102.25798643]
mat_Sqrt:  [[0.15]]
grads:  [-0.08398052]
Stock Position:  -0.0839805154975913
Bond Position:  [14.23649753]


portfolio before change:  [5.61727466]
curr_Stock_Price:  102.64419815511691
curr_Factors:  [102.64419816]
mat_Sqrt:  [[0.15]]
grads:  [0.04256068]
Stock Position:  0.04256067731405607
Bond Position:  [1.24866806]


portfolio before change:  [5.57973328]
curr_Stock_Price:  101.76029708675443
curr_Factors:  [101.76029709]
mat_Sqrt:  [[0.15]]
grads:  [-0.02563692]
Stock Position:  -0.025636922517431514
Bond Position:  [8.18855413]


portfolio before change:  [5.55924957]
curr_Stock_Price:  102.57925305084105
curr_Factors:  [102.57925305]
mat_Sqrt:  [[0.15]]
grads:  [0.11672254]
Stock Position:  0.1167225401457796
Bond Position:  [-6.41406142]


portfolio before change:  [5.54695051]
curr_Stock_Price:  102.47731762754196
curr_Factors:  [102.47731763]
mat_Sqrt:  [[0.15]]
grads:  [0.1227124]
Stock Position:  0.12271240087265659
Bond Position:  [-7.02828717]


portfolio before change:  [5.56540496]
curr_Stock_Price:  102.63128520595416
curr_Factors:  [102.63128521]
mat_Sqrt:  [[0.15]]
grads:  [0.0666342]
Stock Position:  0.0666342031277326
Bond Position:  [-1.27334894]


portfolio before change:  [5.53480223]
curr_Stock_Price:  102.17321487899211
curr_Factors:  [102.17321488]
mat_Sqrt:  [[0.15]]
grads:  [0.04008439]
Stock Position:  0.040084391370842146
Bond Position:  [1.43925109]


portfolio before change:  [5.55828227]
curr_Stock_Price:  102.75673590049416
curr_Factors:  [102.7567359]
mat_Sqrt:  [[0.15]]
grads:  [0.04241409]
Stock Position:  0.04241409212445593
Bond Position:  [1.1999486]


portfolio before change:  [5.56557569]
curr_Stock_Price:  102.92692509924507
curr_Factors:  [102.9269251]
mat_Sqrt:  [[0.15]]
grads:  [-0.08318511]
Stock Position:  -0.08318510832278914
Bond Position:  [14.1275631]


portfolio before change:  [5.60837285]
curr_Stock_Price:  102.42305895169258
curr_Factors:  [102.42305895]
mat_Sqrt:  [[0.15]]
grads:  [-0.03790642]
Stock Position:  -0.03790642101897193
Bond Position:  [9.49086444]


portfolio before change:  [5.59243748]
curr_Stock_Price:  102.85909500538895
curr_Factors:  [102.85909501]
mat_Sqrt:  [[0.15]]
grads:  [0.24671512]
Stock Position:  0.2467151229286038
Bond Position:  [-19.78445679]


portfolio before change:  [5.56692977]
curr_Stock_Price:  102.7607178161611
curr_Factors:  [102.76071782]
mat_Sqrt:  [[0.15]]
grads:  [0.04286348]
Stock Position:  0.042863480301806686
Bond Position:  [1.16224777]


portfolio before change:  [5.5485796]
curr_Stock_Price:  102.33091568299109
curr_Factors:  [102.33091568]
mat_Sqrt:  [[0.15]]
grads:  [-0.00487139]
Stock Position:  -0.00487139437353116
Bond Position:  [6.04707384]


portfolio before change:  [5.54989642]
curr_Stock_Price:  102.1381846468681
curr_Factors:  [102.13818465]
mat_Sqrt:  [[0.15]]
grads:  [-0.025618]
Stock Position:  -0.025618004175735894
Bond Position:  [8.16647286]


portfolio before change:  [5.55428975]
curr_Stock_Price:  101.9866149683346
curr_Factors:  [101.98661497]
mat_Sqrt:  [[0.15]]
grads:  [-0.02957331]
Stock Position:  -0.02957331328366134
Bond Position:  [8.57037187]


portfolio before change:  [5.5690317]
curr_Stock_Price:  101.50623984497773
curr_Factors:  [101.50623984]
mat_Sqrt:  [[0.15]]
grads:  [-0.04617099]
Stock Position:  -0.046170987126723725
Bond Position:  [10.255675]


portfolio before change:  [5.56444927]
curr_Stock_Price:  101.61937224268667
curr_Factors:  [101.61937224]
mat_Sqrt:  [[0.15]]
grads:  [0.05459375]
Stock Position:  0.054593750960013655
Bond Position:  [0.01666657]


portfolio before change:  [5.59029594]
curr_Stock_Price:  102.09278970169014
curr_Factors:  [102.0927897]
mat_Sqrt:  [[0.15]]
grads:  [0.0083865]
Stock Position:  0.008386497871167627
Bond Position:  [4.73409498]


portfolio before change:  [5.59076061]
curr_Stock_Price:  102.11291477265402
curr_Factors:  [102.11291477]
mat_Sqrt:  [[0.15]]
grads:  [-0.05807971]
Stock Position:  -0.05807970526891425
Bond Position:  [11.52144861]


portfolio before change:  [5.53668011]
curr_Stock_Price:  103.05645628209143
curr_Factors:  [103.05645628]
mat_Sqrt:  [[0.15]]
grads:  [-0.24374949]
Stock Position:  -0.24374949469325605
Bond Position:  [30.65663926]


portfolio before change:  [5.55293557]
curr_Stock_Price:  102.99762801167147
curr_Factors:  [102.99762801]
mat_Sqrt:  [[0.15]]
grads:  [-0.0181744]
Stock Position:  -0.018174397158295268
Bond Position:  [7.42485537]


portfolio before change:  [5.55338483]
curr_Stock_Price:  102.99844276281945
curr_Factors:  [102.99844276]
mat_Sqrt:  [[0.15]]
grads:  [0.08635507]
Stock Position:  0.0863550731245527
Bond Position:  [-3.34105322]


portfolio before change:  [5.58400549]
curr_Stock_Price:  103.3554510633697
curr_Factors:  [103.35545106]
mat_Sqrt:  [[0.15]]
grads:  [-0.08391957]
Stock Position:  -0.08391957313327113
Bond Position:  [14.25755082]


portfolio before change:  [5.57797425]
curr_Stock_Price:  103.43793914174661
curr_Factors:  [103.43793914]
mat_Sqrt:  [[0.15]]
grads:  [-0.00947632]
Stock Position:  -0.009476324464901542
Bond Position:  [6.55818572]


portfolio before change:  [5.57508312]
curr_Stock_Price:  103.78628422455336
curr_Factors:  [103.78628422]
mat_Sqrt:  [[0.15]]
grads:  [0.01695567]
Stock Position:  0.016955669938977253
Bond Position:  [3.81531714]


portfolio before change:  [5.57137902]
curr_Stock_Price:  103.5537625009865
curr_Factors:  [103.5537625]
mat_Sqrt:  [[0.15]]
grads:  [-0.09078823]
Stock Position:  -0.09078823006460567
Bond Position:  [14.97284184]


portfolio before change:  [5.49853732]
curr_Stock_Price:  104.36639575450783
curr_Factors:  [104.36639575]
mat_Sqrt:  [[0.15]]
grads:  [0.0728825]
Stock Position:  0.07288249884566624
Bond Position:  [-2.1079464]


portfolio before change:  [5.44881737]
curr_Stock_Price:  103.68601016332995
curr_Factors:  [103.68601016]
mat_Sqrt:  [[0.15]]
grads:  [0.06552288]
Stock Position:  0.06552287752005535
Bond Position:  [-1.34498838]


portfolio before change:  [5.51664395]
curr_Stock_Price:  104.72245187275661
curr_Factors:  [104.72245187]
mat_Sqrt:  [[0.15]]
grads:  [-0.07981908]
Stock Position:  -0.0798190777247381
Bond Position:  [13.87549347]


portfolio before change:  [5.57168714]
curr_Stock_Price:  104.04371748561651
curr_Factors:  [104.04371749]
mat_Sqrt:  [[0.15]]
grads:  [-0.0260662]
Stock Position:  -0.026066200134999436
Bond Position:  [8.28371151]


portfolio before change:  [5.58860265]
curr_Stock_Price:  103.41463605239568
curr_Factors:  [103.41463605]
mat_Sqrt:  [[0.15]]
grads:  [0.02297284]
Stock Position:  0.02297284377381565
Bond Position:  [3.21287438]


portfolio before change:  [5.61670529]
curr_Stock_Price:  104.62919308910358
curr_Factors:  [104.62919309]
mat_Sqrt:  [[0.15]]
grads:  [0.01953955]
Stock Position:  0.019539549945946273
Bond Position:  [3.57229795]


portfolio before change:  [5.62077756]
curr_Stock_Price:  104.82617789347012
curr_Factors:  [104.82617789]
mat_Sqrt:  [[0.15]]
grads:  [-0.0113051]
Stock Position:  -0.011305104513491602
Bond Position:  [6.80584846]


portfolio before change:  [5.62833189]
curr_Stock_Price:  104.19558265419211
curr_Factors:  [104.19558265]
mat_Sqrt:  [[0.15]]
grads:  [-0.04974423]
Stock Position:  -0.04974422639198852
Bond Position:  [10.81146054]


portfolio before change:  [5.65364324]
curr_Stock_Price:  103.70033704805736
curr_Factors:  [103.70033705]
mat_Sqrt:  [[0.15]]
grads:  [0.06644128]
Stock Position:  0.06644127516103826
Bond Position:  [-1.23633939]


portfolio before change:  [5.66869723]
curr_Stock_Price:  103.92807609839414
curr_Factors:  [103.9280761]
mat_Sqrt:  [[0.15]]
grads:  [-0.07732731]
Stock Position:  -0.07732730730815032
Bond Position:  [13.70517551]


portfolio before change:  [5.6760803]
curr_Stock_Price:  103.843675540986
curr_Factors:  [103.84367554]
mat_Sqrt:  [[0.15]]
grads:  [-0.06262503]
Stock Position:  -0.06262503075390816
Bond Position:  [12.17929368]


portfolio before change:  [5.70505808]
curr_Stock_Price:  103.39311216322902
curr_Factors:  [103.39311216]
mat_Sqrt:  [[0.15]]
grads:  [0.10281759]
Stock Position:  0.10281759083703797
Bond Position:  [-4.92557262]


portfolio before change:  [5.66731785]
curr_Stock_Price:  103.02904637182624
curr_Factors:  [103.02904637]
mat_Sqrt:  [[0.15]]
grads:  [0.01322257]
Stock Position:  0.013222569975569493
Bond Position:  [4.30500908]


portfolio before change:  [5.66549123]
curr_Stock_Price:  102.87055289908204
curr_Factors:  [102.8705529]
mat_Sqrt:  [[0.15]]
grads:  [0.07760726]
Stock Position:  0.07760725517597744
Bond Position:  [-2.31801002]


portfolio before change:  [5.70103331]
curr_Stock_Price:  103.33039337177455
curr_Factors:  [103.33039337]
mat_Sqrt:  [[0.15]]
grads:  [-0.10208729]
Stock Position:  -0.10208728981460176
Bond Position:  [16.24975312]


portfolio before change:  [5.66088572]
curr_Stock_Price:  103.73360943732015
curr_Factors:  [103.73360944]
mat_Sqrt:  [[0.15]]
grads:  [-0.08503158]
Stock Position:  -0.08503157599152131
Bond Position:  [14.48151801]


portfolio before change:  [5.62754517]
curr_Stock_Price:  104.1363499855123
curr_Factors:  [104.13634999]
mat_Sqrt:  [[0.15]]
grads:  [-0.0223023]
Stock Position:  -0.02230229968971175
Bond Position:  [7.95002526]


portfolio before change:  [5.62824693]
curr_Stock_Price:  104.12716408108784
curr_Factors:  [104.12716408]
mat_Sqrt:  [[0.15]]
grads:  [0.15661931]
Stock Position:  0.1566193132830449
Bond Position:  [-10.680078]


portfolio before change:  [5.65221063]
curr_Stock_Price:  104.2844321969194
curr_Factors:  [104.2844322]
mat_Sqrt:  [[0.15]]
grads:  [-0.11683241]
Stock Position:  -0.11683240706419278
Bond Position:  [17.83601187]


portfolio before change:  [5.57822108]
curr_Stock_Price:  104.92727047116118
curr_Factors:  [104.92727047]
mat_Sqrt:  [[0.15]]
grads:  [0.10194102]
Stock Position:  0.1019410163211548
Bond Position:  [-5.11817152]


portfolio before change:  [5.69983373]
curr_Stock_Price:  106.12337928395661
curr_Factors:  [106.12337928]
mat_Sqrt:  [[0.15]]
grads:  [0.03641517]
Stock Position:  0.03641516826455502
Bond Position:  [1.83533301]


portfolio before change:  [5.68521834]
curr_Stock_Price:  105.71887484465363
curr_Factors:  [105.71887484]
mat_Sqrt:  [[0.15]]
grads:  [0.08560462]
Stock Position:  0.08560462302152175
Bond Position:  [-3.36480609]


portfolio before change:  [5.71073036]
curr_Stock_Price:  106.01935309768459
curr_Factors:  [106.0193531]
mat_Sqrt:  [[0.15]]
grads:  [-0.17482212]
Stock Position:  -0.17482212217097481
Bond Position:  [24.24525866]


portfolio before change:  [5.7884184]
curr_Stock_Price:  105.58363788869676
curr_Factors:  [105.58363789]
mat_Sqrt:  [[0.15]]
grads:  [-0.05278745]
Stock Position:  -0.05278744924890452
Bond Position:  [11.36190932]


portfolio before change:  [5.80116186]
curr_Stock_Price:  105.35567980273021
curr_Factors:  [105.3556798]
mat_Sqrt:  [[0.15]]
grads:  [-0.04188766]
Stock Position:  -0.041887658932192484
Bond Position:  [10.21426465]


portfolio before change:  [5.8265756]
curr_Stock_Price:  104.76420898328143
curr_Factors:  [104.76420898]
mat_Sqrt:  [[0.15]]
grads:  [0.04965048]
Stock Position:  0.049650477493428206
Bond Position:  [0.6249826]


portfolio before change:  [5.9194101]
curr_Stock_Price:  106.63318265213978
curr_Factors:  [106.63318265]
mat_Sqrt:  [[0.15]]
grads:  [0.03397142]
Stock Position:  0.03397141730318695
Bond Position:  [2.29692975]


portfolio before change:  [5.91988539]
curr_Stock_Price:  106.64294755604567
curr_Factors:  [106.64294756]
mat_Sqrt:  [[0.15]]
grads:  [-0.01023044]
Stock Position:  -0.010230442608270517
Bond Position:  [7.01088995]


portfolio before change:  [5.90897085]
curr_Stock_Price:  107.75264896091511
curr_Factors:  [107.75264896]
mat_Sqrt:  [[0.15]]
grads:  [0.03356507]
Stock Position:  0.03356506922835155
Bond Position:  [2.29224573]


portfolio before change:  [5.90114373]
curr_Stock_Price:  107.51518825668866
curr_Factors:  [107.51518826]
mat_Sqrt:  [[0.15]]
grads:  [0.02522501]
Stock Position:  0.02522501345825638
Bond Position:  [3.18907166]


portfolio before change:  [5.89022933]
curr_Stock_Price:  107.0746045710184
curr_Factors:  [107.07460457]
mat_Sqrt:  [[0.15]]
grads:  [-0.01784134]
Stock Position:  -0.017841344398202424
Bond Position:  [7.80058422]


portfolio before change:  [5.893697]
curr_Stock_Price:  106.90756992583266
curr_Factors:  [106.90756993]
mat_Sqrt:  [[0.15]]
grads:  [0.13696221]
Stock Position:  0.1369622129068809
Bond Position:  [-8.74860035]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.893697]
Stock Price:  107.64605104510066
PL:  [-1.75235404]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.99024705e-02]
 [ 1.85520846e-03]
 [-5.26594014e-04]
 [ 3.18239332e-04]
 [-1.45816885e-02]
 [ 7.82555315e-03]
 [ 4.24358497e-04]
 [ 2.80125569e-03]
 [ 6.06219370e-03]
 [ 2.59688607e-02]
 [ 8.98459237e-03]
 [-9.47171852e-03]
 [ 5.63583986e-04]
 [ 3.55043704e-03]
 [-4.93593487e-03]
 [ 1.32594347e-02]
 [ 5.79070413e-03]
 [ 1.06319852e-02]
 [ 2.14622490e-02]
 [ 3.56837903e-03]
 [ 5.99735207e-02]
 [-1.41789456e-02]
 [-2.68290244e-03]
 [ 1.00341549e-02]
 [ 1.38830131e-02]
 [ 1.93636586e-04]
 [ 1.31720337e-02]
 [-7.79639614e-04]
 [ 2.93805467e-03]
 [-1.91714810e-02]
 [-4.55366487e-03]
 [-2.00467895e-02]
 [ 1.77442545e-02]
 [ 9.90208077e-03]
 [-1.80122930e-02]
 [ 7.68531588e-03]
 [-2.64392066e-03]
 [ 5.63473829e-03]
 [ 4.02880565e-03]
 [-1.53260753e-02]
 [ 3.85834246e-02]
 [-1.61199244e-03]
 [ 3.43861391e-03]
 [-8.28902712e-03]
 [ 2.08597204e-03]
 [-3.07641118e-03]
 [-1.36810732e-02]
 [-9.26682187e-04]
 [-4.26151803e-03]
 [ 1.25134517e-04]
 [-3.75790370e-03]
 [ 2.89395734e-03]
 [ 3.45028523e-03]
 [-6.89595338e-04]
 [ 6.31137769e-03]
 [ 8.84448451e-03]
 [ 1.22080165e-02]
 [ 2.55668475e-03]
 [ 1.35701040e-02]
 [ 8.17230243e-04]
 [ 3.64196135e-03]
 [-1.59442415e-02]
 [-1.26375049e-02]
 [-1.07067806e-03]
 [-1.10674531e-02]
 [-4.32204308e-03]
 [ 1.10343427e-02]
 [ 2.23075165e-03]
 [ 1.14241347e-02]
 [-1.77931217e-02]
 [ 5.73114957e-03]
 [ 2.00206148e-03]
 [ 4.24386478e-04]
 [ 8.34052070e-03]
 [ 8.08086669e-03]
 [-7.63615953e-03]
 [-2.45830751e-04]
 [-8.73474215e-03]
 [ 3.78660834e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.50489452]
curr_Stock_Price:  99.38484353925962
curr_Factors:  [99.38484354]
mat_Sqrt:  [[0.15]]
grads:  [-0.26601647]
Stock Position:  -0.2660164699614759
Bond Position:  [18.93311072]


portfolio before change:  [-7.53185298]
curr_Stock_Price:  99.49063328659231
curr_Factors:  [99.49063329]
mat_Sqrt:  [[0.15]]
grads:  [0.01236806]
Stock Position:  0.012368056426193492
Bond Position:  [-8.76235875]


portfolio before change:  [-7.5350721]
curr_Stock_Price:  99.27463730193584
curr_Factors:  [99.2746373]
mat_Sqrt:  [[0.15]]
grads:  [-0.00351063]
Stock Position:  -0.003510626759664389
Bond Position:  [-7.1865559]


portfolio before change:  [-7.5353102]
curr_Stock_Price:  99.2145152659408
curr_Factors:  [99.21451527]
mat_Sqrt:  [[0.15]]
grads:  [0.0021216]
Stock Position:  0.0021215955496818118
Bond Position:  [-7.74580328]


portfolio before change:  [-7.53677239]
curr_Stock_Price:  98.75351461445595
curr_Factors:  [98.75351461]
mat_Sqrt:  [[0.15]]
grads:  [-0.09721126]
Stock Position:  -0.09721125653905426
Bond Position:  [2.06318085]


portfolio before change:  [-7.55495017]
curr_Stock_Price:  98.94183366389073
curr_Factors:  [98.94183366]
mat_Sqrt:  [[0.15]]
grads:  [0.05217035]
Stock Position:  0.052170354316481427
Bond Position:  [-12.71678069]


portfolio before change:  [-7.56267493]
curr_Stock_Price:  98.80900073898854
curr_Factors:  [98.80900074]
mat_Sqrt:  [[0.15]]
grads:  [0.00282906]
Stock Position:  0.0028290566492081416
Bond Position:  [-7.84221119]


portfolio before change:  [-7.56497935]
curr_Stock_Price:  98.16770346527238
curr_Factors:  [98.16770347]
mat_Sqrt:  [[0.15]]
grads:  [0.01867504]
Stock Position:  0.01867503793294492
Bond Position:  [-9.39826494]


portfolio before change:  [-7.57037757]
curr_Stock_Price:  97.91009711201977
curr_Factors:  [97.91009711]
mat_Sqrt:  [[0.15]]
grads:  [0.04041462]
Stock Position:  0.040414624683169954
Bond Position:  [-11.5273774]


portfolio before change:  [-7.58365767]
curr_Stock_Price:  97.599328078693
curr_Factors:  [97.59932808]
mat_Sqrt:  [[0.15]]
grads:  [0.17312574]
Stock Position:  0.17312573798244787
Bond Position:  [-24.48061337]


portfolio before change:  [-7.57329608]
curr_Stock_Price:  97.6680161547414
curr_Factors:  [97.66801615]
mat_Sqrt:  [[0.15]]
grads:  [0.05989728]
Stock Position:  0.059897282494574905
Bond Position:  [-13.42334483]


portfolio before change:  [-7.56339226]
curr_Stock_Price:  97.8473699699242
curr_Factors:  [97.84736997]
mat_Sqrt:  [[0.15]]
grads:  [-0.06314479]
Stock Position:  -0.06314479013285869
Bond Position:  [-1.38484062]


portfolio before change:  [-7.59054207]
curr_Stock_Price:  98.27596040548364
curr_Factors:  [98.27596041]
mat_Sqrt:  [[0.15]]
grads:  [0.00375723]
Stock Position:  0.0037572265710797154
Bond Position:  [-7.95978712]


portfolio before change:  [-7.58917375]
curr_Stock_Price:  98.77255598534508
curr_Factors:  [98.77255599]
mat_Sqrt:  [[0.15]]
grads:  [0.02366958]
Stock Position:  0.02366958026160844
Bond Position:  [-9.92707869]


portfolio before change:  [-7.59148914]
curr_Stock_Price:  98.70094795172356
curr_Factors:  [98.70094795]
mat_Sqrt:  [[0.15]]
grads:  [-0.03290623]
Stock Position:  -0.03290623249177546
Bond Position:  [-4.3436128]


portfolio before change:  [-7.6020559]
curr_Stock_Price:  99.01381510524774
curr_Factors:  [99.01381511]
mat_Sqrt:  [[0.15]]
grads:  [0.08839623]
Stock Position:  0.08839623110822126
Bond Position:  [-16.35450399]


portfolio before change:  [-7.53160618]
curr_Stock_Price:  99.82235542174121
curr_Factors:  [99.82235542]
mat_Sqrt:  [[0.15]]
grads:  [0.03860469]
Stock Position:  0.0386046942294727
Bond Position:  [-11.38521768]


portfolio before change:  [-7.5219676]
curr_Stock_Price:  100.09046215079312
curr_Factors:  [100.09046215]
mat_Sqrt:  [[0.15]]
grads:  [0.0708799]
Stock Position:  0.0708799014075529
Bond Position:  [-14.61636969]


portfolio before change:  [-7.51561773]
curr_Stock_Price:  100.19293711528084
curr_Factors:  [100.19293712]
mat_Sqrt:  [[0.15]]
grads:  [0.14308166]
Stock Position:  0.14308165992446126
Bond Position:  [-21.85138949]


portfolio before change:  [-7.50691431]
curr_Stock_Price:  100.26331073912354
curr_Factors:  [100.26331074]
mat_Sqrt:  [[0.15]]
grads:  [0.02378919]
Stock Position:  0.02378919354738485
Bond Position:  [-9.89209762]


portfolio before change:  [-7.52171673]
curr_Stock_Price:  99.667067721681
curr_Factors:  [99.66706772]
mat_Sqrt:  [[0.15]]
grads:  [0.39982347]
Stock Position:  0.3998234715598228
Bond Position:  [-47.37094974]


portfolio before change:  [-7.39049963]
curr_Stock_Price:  100.00266052014173
curr_Factors:  [100.00266052]
mat_Sqrt:  [[0.15]]
grads:  [-0.0945263]
Stock Position:  -0.09452630380747393
Bond Position:  [2.06238224]


portfolio before change:  [-7.40379345]
curr_Stock_Price:  100.14466042286647
curr_Factors:  [100.14466042]
mat_Sqrt:  [[0.15]]
grads:  [-0.01788602]
Stock Position:  -0.017886016294154528
Bond Position:  [-5.61260442]


portfolio before change:  [-7.40563726]
curr_Stock_Price:  100.2281339227832
curr_Factors:  [100.22813392]
mat_Sqrt:  [[0.15]]
grads:  [0.06689437]
Stock Position:  0.06689436571054452
Bond Position:  [-14.1103347]


portfolio before change:  [-7.39905982]
curr_Stock_Price:  100.3396434010119
curr_Factors:  [100.3396434]
mat_Sqrt:  [[0.15]]
grads:  [0.09255342]
Stock Position:  0.09255342055799469
Bond Position:  [-16.68583704]


portfolio before change:  [-7.35007703]
curr_Stock_Price:  100.88014952474393
curr_Factors:  [100.88014952]
mat_Sqrt:  [[0.15]]
grads:  [0.00129091]
Stock Position:  0.0012909105741717767
Bond Position:  [-7.48030428]


portfolio before change:  [-7.35119561]
curr_Stock_Price:  100.37582302223345
curr_Factors:  [100.37582302]
mat_Sqrt:  [[0.15]]
grads:  [0.08781356]
Stock Position:  0.08781355779428546
Bond Position:  [-16.16555374]


portfolio before change:  [-7.38726478]
curr_Stock_Price:  99.97658175815869
curr_Factors:  [99.97658176]
mat_Sqrt:  [[0.15]]
grads:  [-0.0051976]
Stock Position:  -0.005197597428246321
Bond Position:  [-6.86762676]


portfolio before change:  [-7.3875704]
curr_Stock_Price:  99.9527972080858
curr_Factors:  [99.95279721]
mat_Sqrt:  [[0.15]]
grads:  [0.01958703]
Stock Position:  0.019587031127573058
Bond Position:  [-9.34534895]


portfolio before change:  [-7.39495798]
curr_Stock_Price:  99.60545094416146
curr_Factors:  [99.60545094]
mat_Sqrt:  [[0.15]]
grads:  [-0.12780987]
Stock Position:  -0.12780987326472934
Bond Position:  [5.33560208]


portfolio before change:  [-7.45511163]
curr_Stock_Price:  100.07870965626384
curr_Factors:  [100.07870966]
mat_Sqrt:  [[0.15]]
grads:  [-0.03035777]
Stock Position:  -0.030357765813588032
Bond Position:  [-4.4169456]


portfolio before change:  [-7.41479874]
curr_Stock_Price:  98.74168894318328
curr_Factors:  [98.74168894]
mat_Sqrt:  [[0.15]]
grads:  [-0.13364526]
Stock Position:  -0.1336452630476724
Bond Position:  [5.78156025]


portfolio before change:  [-7.30963582]
curr_Stock_Price:  97.95751181940125
curr_Factors:  [97.95751182]
mat_Sqrt:  [[0.15]]
grads:  [0.11829503]
Stock Position:  0.11829503030778964
Bond Position:  [-18.89752265]


portfolio before change:  [-7.37667122]
curr_Stock_Price:  97.40081666706774
curr_Factors:  [97.40081667]
mat_Sqrt:  [[0.15]]
grads:  [0.06601387]
Stock Position:  0.066013871795934
Bond Position:  [-13.80647625]


portfolio before change:  [-7.33202271]
curr_Stock_Price:  98.0902391712976
curr_Factors:  [98.09023917]
mat_Sqrt:  [[0.15]]
grads:  [-0.12008195]
Stock Position:  -0.12008195322997849
Bond Position:  [4.44684481]


portfolio before change:  [-7.28660077]
curr_Stock_Price:  97.71429592359601
curr_Factors:  [97.71429592]
mat_Sqrt:  [[0.15]]
grads:  [0.05123544]
Stock Position:  0.05123543919637117
Bond Position:  [-12.29303564]


portfolio before change:  [-7.28104062]
curr_Stock_Price:  97.83781370900556
curr_Factors:  [97.83781371]
mat_Sqrt:  [[0.15]]
grads:  [-0.01762614]
Stock Position:  -0.01762613776472532
Bond Position:  [-5.55653784]


portfolio before change:  [-7.28297279]
curr_Stock_Price:  97.9277299965339
curr_Factors:  [97.92773]
mat_Sqrt:  [[0.15]]
grads:  [0.03756492]
Stock Position:  0.0375649219594939
Bond Position:  [-10.96162033]


portfolio before change:  [-7.2881719]
curr_Stock_Price:  97.80756514551882
curr_Factors:  [97.80756515]
mat_Sqrt:  [[0.15]]
grads:  [0.0268587]
Stock Position:  0.026858704317802937
Bond Position:  [-9.91515637]


portfolio before change:  [-7.29161071]
curr_Stock_Price:  97.70260484682366
curr_Factors:  [97.70260485]
mat_Sqrt:  [[0.15]]
grads:  [-0.10217384]
Stock Position:  -0.10217383549743167
Bond Position:  [2.69103916]


portfolio before change:  [-7.26449952]
curr_Stock_Price:  97.43890722690347
curr_Factors:  [97.43890723]
mat_Sqrt:  [[0.15]]
grads:  [0.25722283]
Stock Position:  0.25722283052908496
Bond Position:  [-32.32801104]


portfolio before change:  [-6.99822696]
curr_Stock_Price:  98.48194500552384
curr_Factors:  [98.48194501]
mat_Sqrt:  [[0.15]]
grads:  [-0.01074662]
Stock Position:  -0.010746616265919105
Bond Position:  [-5.93987928]


portfolio before change:  [-7.00171801]
curr_Stock_Price:  98.77225074757754
curr_Factors:  [98.77225075]
mat_Sqrt:  [[0.15]]
grads:  [0.02292409]
Stock Position:  0.02292409275370658
Bond Position:  [-9.26598225]


portfolio before change:  [-7.02230058]
curr_Stock_Price:  97.89965700775097
curr_Factors:  [97.89965701]
mat_Sqrt:  [[0.15]]
grads:  [-0.05526018]
Stock Position:  -0.05526018077369333
Bond Position:  [-1.61234783]


portfolio before change:  [-7.06663176]
curr_Stock_Price:  98.70005990196006
curr_Factors:  [98.7000599]
mat_Sqrt:  [[0.15]]
grads:  [0.01390648]
Stock Position:  0.013906480277720698
Bond Position:  [-8.4392022]


portfolio before change:  [-7.06199025]
curr_Stock_Price:  99.0717552054123
curr_Factors:  [99.07175521]
mat_Sqrt:  [[0.15]]
grads:  [-0.02050941]
Stock Position:  -0.020509407841548654
Bond Position:  [-5.03008722]


portfolio before change:  [-7.04546139]
curr_Stock_Price:  98.25050980213871
curr_Factors:  [98.2505098]
mat_Sqrt:  [[0.15]]
grads:  [-0.09120715]
Stock Position:  -0.09120715477142942
Bond Position:  [1.91568807]


portfolio before change:  [-7.0150729]
curr_Stock_Price:  97.91864162927268
curr_Factors:  [97.91864163]
mat_Sqrt:  [[0.15]]
grads:  [-0.00617788]
Stock Position:  -0.00617788124809112
Bond Position:  [-6.41014316]


portfolio before change:  [-7.01249599]
curr_Stock_Price:  97.43667067470892
curr_Factors:  [97.43667067]
mat_Sqrt:  [[0.15]]
grads:  [-0.02841012]
Stock Position:  -0.028410120219396567
Bond Position:  [-4.24430846]


portfolio before change:  [-6.99605935]
curr_Stock_Price:  96.84878470535924
curr_Factors:  [96.84878471]
mat_Sqrt:  [[0.15]]
grads:  [0.00083423]
Stock Position:  0.0008342301146461023
Bond Position:  [-7.07685353]


portfolio before change:  [-6.99664457]
curr_Stock_Price:  96.67749201208163
curr_Factors:  [96.67749201]
mat_Sqrt:  [[0.15]]
grads:  [-0.02505269]
Stock Position:  -0.025052691363672164
Bond Position:  [-4.5746132]


portfolio before change:  [-6.98446072]
curr_Stock_Price:  96.17975012714255
curr_Factors:  [96.17975013]
mat_Sqrt:  [[0.15]]
grads:  [0.01929305]
Stock Position:  0.01929304894391679
Bond Position:  [-8.84006134]


portfolio before change:  [-6.9728057]
curr_Stock_Price:  96.81249270256409
curr_Factors:  [96.8124927]
mat_Sqrt:  [[0.15]]
grads:  [0.0230019]
Stock Position:  0.02300190153928157
Bond Position:  [-9.19967713]


portfolio before change:  [-6.99613809]
curr_Stock_Price:  95.82312300961021
curr_Factors:  [95.82312301]
mat_Sqrt:  [[0.15]]
grads:  [-0.0045973]
Stock Position:  -0.004597302254734422
Bond Position:  [-6.55561023]


portfolio before change:  [-6.99943583]
curr_Stock_Price:  96.45131920810593
curr_Factors:  [96.45131921]
mat_Sqrt:  [[0.15]]
grads:  [0.04207585]
Stock Position:  0.042075851288475255
Bond Position:  [-11.0577072]


portfolio before change:  [-7.00450855]
curr_Stock_Price:  96.34718379316952
curr_Factors:  [96.34718379]
mat_Sqrt:  [[0.15]]
grads:  [0.05896323]
Stock Position:  0.05896323007283311
Bond Position:  [-12.68544971]


portfolio before change:  [-6.94135426]
curr_Stock_Price:  97.4317097573308
curr_Factors:  [97.43170976]
mat_Sqrt:  [[0.15]]
grads:  [0.08138678]
Stock Position:  0.08138677670625252
Bond Position:  [-14.87100706]


portfolio before change:  [-6.96481709]
curr_Stock_Price:  97.15484205692718
curr_Factors:  [97.15484206]
mat_Sqrt:  [[0.15]]
grads:  [0.01704456]
Stock Position:  0.017044564979754435
Bond Position:  [-8.62077911]


portfolio before change:  [-6.96613019]
curr_Stock_Price:  97.10941531540448
curr_Factors:  [97.10941532]
mat_Sqrt:  [[0.15]]
grads:  [0.09046736]
Stock Position:  0.09046735982843777
Bond Position:  [-15.75136261]


portfolio before change:  [-6.90418073]
curr_Stock_Price:  97.8050689574112
curr_Factors:  [97.80506896]
mat_Sqrt:  [[0.15]]
grads:  [0.0054482]
Stock Position:  0.0054482016182697945
Bond Position:  [-7.43704247]


portfolio before change:  [-6.90385746]
curr_Stock_Price:  97.94972255974209
curr_Factors:  [97.94972256]
mat_Sqrt:  [[0.15]]
grads:  [0.02427974]
Stock Position:  0.024279742359744994
Bond Position:  [-9.28205149]


portfolio before change:  [-6.9101833]
curr_Stock_Price:  97.71307686762701
curr_Factors:  [97.71307687]
mat_Sqrt:  [[0.15]]
grads:  [-0.10629494]
Stock Position:  -0.10629494301228354
Bond Position:  [3.47622263]


portfolio before change:  [-6.96863137]
curr_Stock_Price:  98.26498778280107
curr_Factors:  [98.26498778]
mat_Sqrt:  [[0.15]]
grads:  [-0.08425003]
Stock Position:  -0.08425003273169619
Bond Position:  [1.31019707]


portfolio before change:  [-6.94627559]
curr_Stock_Price:  98.00060929690494
curr_Factors:  [98.0006093]
mat_Sqrt:  [[0.15]]
grads:  [-0.00713785]
Stock Position:  -0.007137853704077127
Bond Position:  [-6.24676157]


portfolio before change:  [-6.94802693]
curr_Stock_Price:  98.1912695760113
curr_Factors:  [98.19126958]
mat_Sqrt:  [[0.15]]
grads:  [-0.07378302]
Stock Position:  -0.07378302079372476
Bond Position:  [0.29682156]


portfolio before change:  [-6.9707547]
curr_Stock_Price:  98.49955636319496
curr_Factors:  [98.49955636]
mat_Sqrt:  [[0.15]]
grads:  [-0.02881362]
Stock Position:  -0.028813620534519267
Bond Position:  [-4.13262586]


portfolio before change:  [-6.97277157]
curr_Stock_Price:  98.56058900263501
curr_Factors:  [98.560589]
mat_Sqrt:  [[0.15]]
grads:  [0.07356228]
Stock Position:  0.07356228434897263
Bond Position:  [-14.22311365]


portfolio before change:  [-6.98670832]
curr_Stock_Price:  98.3832185756135
curr_Factors:  [98.38321858]
mat_Sqrt:  [[0.15]]
grads:  [0.01487168]
Stock Position:  0.014871677689740065
Bond Position:  [-8.44983183]


portfolio before change:  [-7.00480657]
curr_Stock_Price:  97.20177041824567
curr_Factors:  [97.20177042]
mat_Sqrt:  [[0.15]]
grads:  [0.0761609]
Stock Position:  0.07616089825988846
Bond Position:  [-14.40778071]


portfolio before change:  [-7.00857033]
curr_Stock_Price:  97.16417569819157
curr_Factors:  [97.1641757]
mat_Sqrt:  [[0.15]]
grads:  [-0.11862081]
Stock Position:  -0.1186208111027378
Bond Position:  [4.517123]


portfolio before change:  [-7.01372686]
curr_Stock_Price:  97.21002648380772
curr_Factors:  [97.21002648]
mat_Sqrt:  [[0.15]]
grads:  [0.03820766]
Stock Position:  0.03820766379390342
Bond Position:  [-10.72789487]


portfolio before change:  [-6.99224411]
curr_Stock_Price:  97.78983841610606
curr_Factors:  [97.78983842]
mat_Sqrt:  [[0.15]]
grads:  [0.01334708]
Stock Position:  0.013347076509512274
Bond Position:  [-8.29745257]


portfolio before change:  [-6.99061122]
curr_Stock_Price:  97.95103440204213
curr_Factors:  [97.9510344]
mat_Sqrt:  [[0.15]]
grads:  [0.00282924]
Stock Position:  0.002829243183472686
Bond Position:  [-7.26773852]


portfolio before change:  [-6.99151203]
curr_Stock_Price:  97.79319589174258
curr_Factors:  [97.79319589]
mat_Sqrt:  [[0.15]]
grads:  [0.05560347]
Stock Position:  0.055603471301640166
Bond Position:  [-12.4291532]


portfolio before change:  [-6.93845875]
curr_Stock_Price:  98.76130321785085
curr_Factors:  [98.76130322]
mat_Sqrt:  [[0.15]]
grads:  [0.05387244]
Stock Position:  0.05387244461881093
Bond Position:  [-12.25897159]


portfolio before change:  [-6.88545662]
curr_Stock_Price:  99.75937082532502
curr_Factors:  [99.75937083]
mat_Sqrt:  [[0.15]]
grads:  [-0.05090773]
Stock Position:  -0.05090773017351475
Bond Position:  [-1.80693349]


portfolio before change:  [-6.92902262]
curr_Stock_Price:  100.6129359963807
curr_Factors:  [100.612936]
mat_Sqrt:  [[0.15]]
grads:  [-0.00163887]
Stock Position:  -0.001638871671343911
Bond Position:  [-6.76413093]


portfolio before change:  [-6.92782983]
curr_Stock_Price:  99.6271591858231
curr_Factors:  [99.62715919]
mat_Sqrt:  [[0.15]]
grads:  [-0.05823161]
Stock Position:  -0.05823161436443999
Bond Position:  [-1.12637952]


portfolio before change:  [-6.97078461]
curr_Stock_Price:  100.36360415844214
curr_Factors:  [100.36360416]
mat_Sqrt:  [[0.15]]
grads:  [0.02524406]
Stock Position:  0.025244055580834757
Bond Position:  [-9.50436901]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.97078461]
Stock Price:  99.91507906814702
PL:  [-6.97078461]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.79527132e-02]
 [-2.38126118e-03]
 [ 7.39320598e-04]
 [ 2.13959482e-03]
 [ 2.14031685e-02]
 [ 1.04506927e-02]
 [ 6.87329749e-04]
 [ 2.58901781e-04]
 [ 8.80068098e-03]
 [ 5.96150351e-03]
 [ 7.63064604e-03]
 [-8.25891182e-03]
 [-2.00690852e-03]
 [ 3.55056067e-03]
 [ 4.31892980e-03]
 [ 1.37972053e-02]
 [-1.79022165e-03]
 [ 1.20216469e-03]
 [ 6.30906535e-03]
 [ 1.38940529e-02]
 [ 2.41254421e-02]
 [-2.29516042e-02]
 [-1.04912940e-03]
 [ 1.42891407e-02]
 [ 5.91294733e-03]
 [ 8.16017160e-03]
 [ 1.31153687e-02]
 [-9.67270687e-03]
 [ 1.18432460e-03]
 [-9.06535155e-03]
 [-3.73587228e-03]
 [-1.61012090e-02]
 [ 1.79413139e-02]
 [ 9.61891797e-03]
 [-2.76788130e-02]
 [ 8.23110794e-03]
 [-2.16587732e-03]
 [-4.10366091e-03]
 [ 6.03712177e-03]
 [-1.72877175e-02]
 [ 4.47284544e-02]
 [ 1.41748698e-03]
 [ 5.90606553e-03]
 [-8.08970841e-03]
 [ 2.14192715e-03]
 [-5.15825301e-03]
 [-1.34935993e-02]
 [-3.54140227e-04]
 [-3.92765081e-03]
 [ 3.96647661e-03]
 [-3.22446300e-03]
 [ 3.00626927e-03]
 [ 3.33478713e-03]
 [ 2.50836303e-03]
 [ 2.34816581e-03]
 [ 9.00021508e-03]
 [ 1.34897108e-02]
 [-6.64802716e-03]
 [ 1.38093043e-02]
 [ 2.96444755e-03]
 [ 3.62955834e-03]
 [-1.70575840e-02]
 [-1.27045289e-02]
 [-1.57531561e-03]
 [-9.22694597e-03]
 [-1.77946318e-02]
 [ 9.60890970e-03]
 [ 1.94651029e-03]
 [ 1.36356339e-02]
 [-1.87251922e-02]
 [ 1.22744612e-02]
 [-7.08563205e-03]
 [-3.10277670e-03]
 [ 7.72570739e-03]
 [-6.96062617e-03]
 [ 3.42505727e-03]
 [ 1.05924579e-02]
 [-1.24920236e-02]
 [-4.71056407e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.85257868]
curr_Stock_Price:  100.1147958333278
curr_Factors:  [100.11479583]
mat_Sqrt:  [[0.15]]
grads:  [-0.25301809]
Stock Position:  -0.2530180877155267
Bond Position:  [29.18343287]


portfolio before change:  [3.86955643]
curr_Stock_Price:  100.05490394383557
curr_Factors:  [100.05490394]
mat_Sqrt:  [[0.15]]
grads:  [-0.01587507]
Stock Position:  -0.01587507455163088
Bond Position:  [5.45793549]


portfolio before change:  [3.87228412]
curr_Stock_Price:  99.90457024821293
curr_Factors:  [99.90457025]
mat_Sqrt:  [[0.15]]
grads:  [0.0049288]
Stock Position:  0.004928803986359321
Bond Position:  [3.37987408]


portfolio before change:  [3.87400173]
curr_Stock_Price:  100.2101937709067
curr_Factors:  [100.21019377]
mat_Sqrt:  [[0.15]]
grads:  [0.01426397]
Stock Position:  0.014263965489134736
Bond Position:  [2.44460698]


portfolio before change:  [3.86973356]
curr_Stock_Price:  99.90025429935896
curr_Factors:  [99.9002543]
mat_Sqrt:  [[0.15]]
grads:  [0.14268779]
Stock Position:  0.14268779012566649
Bond Position:  [-10.38481296]


portfolio before change:  [3.80281149]
curr_Stock_Price:  99.4357927068002
curr_Factors:  [99.43579271]
mat_Sqrt:  [[0.15]]
grads:  [0.06967128]
Stock Position:  0.06967128465420815
Bond Position:  [-3.12500793]


portfolio before change:  [3.74221295]
curr_Stock_Price:  98.56881831184742
curr_Factors:  [98.56881831]
mat_Sqrt:  [[0.15]]
grads:  [0.0045822]
Stock Position:  0.004582198326535101
Bond Position:  [3.29055107]


portfolio before change:  [3.73992288]
curr_Stock_Price:  98.02415962019288
curr_Factors:  [98.02415962]
mat_Sqrt:  [[0.15]]
grads:  [0.00172601]
Stock Position:  0.0017260118709484565
Bond Position:  [3.57073202]


portfolio before change:  [3.74043004]
curr_Stock_Price:  98.18868775563082
curr_Factors:  [98.18868776]
mat_Sqrt:  [[0.15]]
grads:  [0.05867121]
Stock Position:  0.0586712065142379
Bond Position:  [-2.02041874]


portfolio before change:  [3.74165817]
curr_Stock_Price:  98.21177255159178
curr_Factors:  [98.21177255]
mat_Sqrt:  [[0.15]]
grads:  [0.03974336]
Stock Position:  0.039743356703601636
Bond Position:  [-0.16160734]


portfolio before change:  [3.74022858]
curr_Stock_Price:  98.17605616324362
curr_Factors:  [98.17605616]
mat_Sqrt:  [[0.15]]
grads:  [0.05087097]
Stock Position:  0.05087097357760812
Bond Position:  [-1.25408298]


portfolio before change:  [3.74244015]
curr_Stock_Price:  98.22107115150148
curr_Factors:  [98.22107115]
mat_Sqrt:  [[0.15]]
grads:  [-0.05505941]
Stock Position:  -0.05505941212341042
Bond Position:  [9.15043459]


portfolio before change:  [3.7234984]
curr_Stock_Price:  98.57548232235887
curr_Factors:  [98.57548232]
mat_Sqrt:  [[0.15]]
grads:  [-0.01337939]
Stock Position:  -0.013379390136997033
Bond Position:  [5.04237824]


portfolio before change:  [3.72103724]
curr_Stock_Price:  98.78298982664593
curr_Factors:  [98.78298983]
mat_Sqrt:  [[0.15]]
grads:  [0.0236704]
Stock Position:  0.023670404439370935
Bond Position:  [1.38280391]


portfolio before change:  [3.74516505]
curr_Stock_Price:  99.79866265747799
curr_Factors:  [99.79866266]
mat_Sqrt:  [[0.15]]
grads:  [0.02879287]
Stock Position:  0.028792865317928316
Bond Position:  [0.8716756]


portfolio before change:  [3.71513395]
curr_Stock_Price:  98.753765562863
curr_Factors:  [98.75376556]
mat_Sqrt:  [[0.15]]
grads:  [0.09198137]
Stock Position:  0.09198136834535435
Bond Position:  [-5.36837254]


portfolio before change:  [3.70918046]
curr_Stock_Price:  98.69268839427797
curr_Factors:  [98.69268839]
mat_Sqrt:  [[0.15]]
grads:  [-0.01193481]
Stock Position:  -0.011934810995257597
Bond Position:  [4.88705904]


portfolio before change:  [3.71695936]
curr_Stock_Price:  98.06649869619852
curr_Factors:  [98.0664987]
mat_Sqrt:  [[0.15]]
grads:  [0.00801443]
Stock Position:  0.00801443127361515
Bond Position:  [2.93101215]


portfolio before change:  [3.71724418]
curr_Stock_Price:  98.07917942984339
curr_Factors:  [98.07917943]
mat_Sqrt:  [[0.15]]
grads:  [0.04206044]
Stock Position:  0.04206043565563339
Bond Position:  [-0.40800883]


portfolio before change:  [3.72131425]
curr_Stock_Price:  98.17655270280099
curr_Factors:  [98.1765527]
mat_Sqrt:  [[0.15]]
grads:  [0.09262702]
Stock Position:  0.09262701946819246
Bond Position:  [-5.37248721]


portfolio before change:  [3.74697536]
curr_Stock_Price:  98.45721494890205
curr_Factors:  [98.45721495]
mat_Sqrt:  [[0.15]]
grads:  [0.16083628]
Stock Position:  0.1608362809475386
Bond Position:  [-12.08851692]


portfolio before change:  [3.63880864]
curr_Stock_Price:  97.78938576249365
curr_Factors:  [97.78938576]
mat_Sqrt:  [[0.15]]
grads:  [-0.15301069]
Stock Position:  -0.1530106947491379
Bond Position:  [18.6016305]


portfolio before change:  [3.53136824]
curr_Stock_Price:  98.49915996003764
curr_Factors:  [98.49915996]
mat_Sqrt:  [[0.15]]
grads:  [-0.0069942]
Stock Position:  -0.006994195975030671
Bond Position:  [4.22029067]


portfolio before change:  [3.52862114]
curr_Stock_Price:  98.92964181688394
curr_Factors:  [98.92964182]
mat_Sqrt:  [[0.15]]
grads:  [0.09526094]
Stock Position:  0.09526093779394107
Bond Position:  [-5.89550931]


portfolio before change:  [3.50858799]
curr_Stock_Price:  98.72321231109939
curr_Factors:  [98.72321231]
mat_Sqrt:  [[0.15]]
grads:  [0.03941965]
Stock Position:  0.03941964885841362
Bond Position:  [-0.38304637]


portfolio before change:  [3.49836919]
curr_Stock_Price:  98.46458846541003
curr_Factors:  [98.46458847]
mat_Sqrt:  [[0.15]]
grads:  [0.05440114]
Stock Position:  0.05440114397451806
Bond Position:  [-1.85821706]


portfolio before change:  [3.50645946]
curr_Stock_Price:  98.61543848215047
curr_Factors:  [98.61543848]
mat_Sqrt:  [[0.15]]
grads:  [0.08743579]
Stock Position:  0.08743579158802213
Bond Position:  [-5.11605947]


portfolio before change:  [3.54715211]
curr_Stock_Price:  99.08449592490683
curr_Factors:  [99.08449592]
mat_Sqrt:  [[0.15]]
grads:  [-0.06448471]
Stock Position:  -0.06448471246652032
Bond Position:  [9.93658733]


portfolio before change:  [3.63724566]
curr_Stock_Price:  97.69699659912264
curr_Factors:  [97.6969966]
mat_Sqrt:  [[0.15]]
grads:  [0.0078955]
Stock Position:  0.007895497339014642
Bond Position:  [2.86587928]


portfolio before change:  [3.6432601]
curr_Stock_Price:  98.43606608102415
curr_Factors:  [98.43606608]
mat_Sqrt:  [[0.15]]
grads:  [-0.06043568]
Stock Position:  -0.06043567699701924
Bond Position:  [9.59231039]


portfolio before change:  [3.62733731]
curr_Stock_Price:  98.70945314674465
curr_Factors:  [98.70945315]
mat_Sqrt:  [[0.15]]
grads:  [-0.02490582]
Stock Position:  -0.024905815225478654
Bond Position:  [6.08577671]


portfolio before change:  [3.63914028]
curr_Stock_Price:  98.25082106903899
curr_Factors:  [98.25082107]
mat_Sqrt:  [[0.15]]
grads:  [-0.10734139]
Stock Position:  -0.10734139306760107
Bond Position:  [14.18552029]


portfolio before change:  [3.67821975]
curr_Stock_Price:  97.89501383408192
curr_Factors:  [97.89501383]
mat_Sqrt:  [[0.15]]
grads:  [0.11960876]
Stock Position:  0.11960875955550061
Bond Position:  [-8.03088142]


portfolio before change:  [3.5857662]
curr_Stock_Price:  97.12624399488169
curr_Factors:  [97.12624399]
mat_Sqrt:  [[0.15]]
grads:  [0.06412612]
Stock Position:  0.0641261198262169
Bond Position:  [-2.64256296]


portfolio before change:  [3.55243522]
curr_Stock_Price:  96.60904733826449
curr_Factors:  [96.60904734]
mat_Sqrt:  [[0.15]]
grads:  [-0.18452542]
Stock Position:  -0.18452541992680466
Bond Position:  [21.37926025]


portfolio before change:  [3.62644463]
curr_Stock_Price:  96.21520911301157
curr_Factors:  [96.21520911]
mat_Sqrt:  [[0.15]]
grads:  [0.05487405]
Stock Position:  0.05487405296562799
Bond Position:  [-1.65327385]


portfolio before change:  [3.65333256]
curr_Stock_Price:  96.70708571869912
curr_Factors:  [96.70708572]
mat_Sqrt:  [[0.15]]
grads:  [-0.01443918]
Stock Position:  -0.01443918214594878
Bond Position:  [5.04970378]


portfolio before change:  [3.65851059]
curr_Stock_Price:  96.37033442539558
curr_Factors:  [96.37033443]
mat_Sqrt:  [[0.15]]
grads:  [-0.02735774]
Stock Position:  -0.02735773936832362
Bond Position:  [6.29498508]


portfolio before change:  [3.65147008]
curr_Stock_Price:  96.6420656702534
curr_Factors:  [96.64206567]
mat_Sqrt:  [[0.15]]
grads:  [0.04024748]
Stock Position:  0.040247478482033645
Bond Position:  [-0.23812937]


portfolio before change:  [3.64653252]
curr_Stock_Price:  96.51975531044171
curr_Factors:  [96.51975531]
mat_Sqrt:  [[0.15]]
grads:  [-0.11525145]
Stock Position:  -0.11525144970015384
Bond Position:  [14.77057424]


portfolio before change:  [3.68501705]
curr_Stock_Price:  96.19384756832989
curr_Factors:  [96.19384757]
mat_Sqrt:  [[0.15]]
grads:  [0.2981897]
Stock Position:  0.2981896962061592
Bond Position:  [-24.99899714]


portfolio before change:  [3.66756592]
curr_Stock_Price:  96.14056389245567
curr_Factors:  [96.14056389]
mat_Sqrt:  [[0.15]]
grads:  [0.00944991]
Stock Position:  0.009449913216645183
Bond Position:  [2.75904593]


portfolio before change:  [3.67692355]
curr_Stock_Price:  97.1125501706545
curr_Factors:  [97.11255017]
mat_Sqrt:  [[0.15]]
grads:  [0.03937377]
Stock Position:  0.039373770205923926
Bond Position:  [-0.14676369]


portfolio before change:  [3.71931913]
curr_Stock_Price:  98.18953004849448
curr_Factors:  [98.18953005]
mat_Sqrt:  [[0.15]]
grads:  [-0.05393139]
Stock Position:  -0.0539313893690695
Bond Position:  [9.01481691]


portfolio before change:  [3.68684572]
curr_Stock_Price:  98.80210196037083
curr_Factors:  [98.80210196]
mat_Sqrt:  [[0.15]]
grads:  [0.01427951]
Stock Position:  0.014279514361125577
Bond Position:  [2.27599969]


portfolio before change:  [3.67067998]
curr_Stock_Price:  97.6600465049752
curr_Factors:  [97.6600465]
mat_Sqrt:  [[0.15]]
grads:  [-0.03438835]
Stock Position:  -0.034388353422778434
Bond Position:  [7.02904818]


portfolio before change:  [3.69015801]
curr_Stock_Price:  97.10640840461512
curr_Factors:  [97.1064084]
mat_Sqrt:  [[0.15]]
grads:  [-0.08995733]
Stock Position:  -0.0899573289548672
Bond Position:  [12.42559114]


portfolio before change:  [3.69391833]
curr_Stock_Price:  97.07324049351848
curr_Factors:  [97.07324049]
mat_Sqrt:  [[0.15]]
grads:  [-0.00236093]
Stock Position:  -0.0023609348474141804
Bond Position:  [3.92310193]


portfolio before change:  [3.69357983]
curr_Stock_Price:  97.32047714479367
curr_Factors:  [97.32047714]
mat_Sqrt:  [[0.15]]
grads:  [-0.02618434]
Stock Position:  -0.02618433871554228
Bond Position:  [6.24185216]


portfolio before change:  [3.68849291]
curr_Stock_Price:  97.52964946235568
curr_Factors:  [97.52964946]
mat_Sqrt:  [[0.15]]
grads:  [0.02644318]
Stock Position:  0.026443177386682275
Bond Position:  [1.10949909]


portfolio before change:  [3.70385744]
curr_Stock_Price:  98.10806620364838
curr_Factors:  [98.1080662]
mat_Sqrt:  [[0.15]]
grads:  [-0.02149642]
Stock Position:  -0.02149642003099675
Bond Position:  [5.81282964]


portfolio before change:  [3.71947792]
curr_Stock_Price:  97.39831218253562
curr_Factors:  [97.39831218]
mat_Sqrt:  [[0.15]]
grads:  [0.0200418]
Stock Position:  0.020041795120719384
Bond Position:  [1.7674409]


portfolio before change:  [3.71807053]
curr_Stock_Price:  97.32257744579933
curr_Factors:  [97.32257745]
mat_Sqrt:  [[0.15]]
grads:  [0.02223191]
Stock Position:  0.022231914194636868
Bond Position:  [1.55440334]


portfolio before change:  [3.73027098]
curr_Stock_Price:  97.8669884453669
curr_Factors:  [97.86698845]
mat_Sqrt:  [[0.15]]
grads:  [0.01672242]
Stock Position:  0.016722420215713345
Bond Position:  [2.09369807]


portfolio before change:  [3.73415071]
curr_Stock_Price:  98.09117077834877
curr_Factors:  [98.09117078]
mat_Sqrt:  [[0.15]]
grads:  [0.01565444]
Stock Position:  0.01565443870334225
Bond Position:  [2.19858849]


portfolio before change:  [3.73806755]
curr_Stock_Price:  98.33259890432683
curr_Factors:  [98.3325989]
mat_Sqrt:  [[0.15]]
grads:  [0.06000143]
Stock Position:  0.060001433872767636
Bond Position:  [-2.16202938]


portfolio before change:  [3.71265699]
curr_Stock_Price:  97.91135184081422
curr_Factors:  [97.91135184]
mat_Sqrt:  [[0.15]]
grads:  [0.08993141]
Stock Position:  0.08993140504274223
Bond Position:  [-5.09264845]


portfolio before change:  [3.71090813]
curr_Stock_Price:  97.89544461388452
curr_Factors:  [97.89544461]
mat_Sqrt:  [[0.15]]
grads:  [-0.04432018]
Stock Position:  -0.04432018105216128
Bond Position:  [8.04965196]


portfolio before change:  [3.69270588]
curr_Stock_Price:  98.31749541181475
curr_Factors:  [98.31749541]
mat_Sqrt:  [[0.15]]
grads:  [0.09206203]
Stock Position:  0.09206202864739883
Bond Position:  [-5.3586022]


portfolio before change:  [3.7092591]
curr_Stock_Price:  98.50093852115874
curr_Factors:  [98.50093852]
mat_Sqrt:  [[0.15]]
grads:  [0.01976298]
Stock Position:  0.01976298366044684
Bond Position:  [1.76258667]


portfolio before change:  [3.69833913]
curr_Stock_Price:  97.94281713321733
curr_Factors:  [97.94281713]
mat_Sqrt:  [[0.15]]
grads:  [0.02419706]
Stock Position:  0.024197055617020027
Bond Position:  [1.32841133]


portfolio before change:  [3.67870835]
curr_Stock_Price:  97.12809799077854
curr_Factors:  [97.12809799]
mat_Sqrt:  [[0.15]]
grads:  [-0.11371723]
Stock Position:  -0.11371722695026051
Bond Position:  [14.72384631]


portfolio before change:  [3.64716995]
curr_Stock_Price:  97.41353112545413
curr_Factors:  [97.41353113]
mat_Sqrt:  [[0.15]]
grads:  [-0.08469686]
Stock Position:  -0.08469685948946641
Bond Position:  [11.89779011]


portfolio before change:  [3.69916781]
curr_Stock_Price:  96.80838212830591
curr_Factors:  [96.80838213]
mat_Sqrt:  [[0.15]]
grads:  [-0.0105021]
Stock Position:  -0.01050210408160584
Bond Position:  [4.71585951]


portfolio before change:  [3.69933768]
curr_Stock_Price:  96.82027329447132
curr_Factors:  [96.82027329]
mat_Sqrt:  [[0.15]]
grads:  [-0.06151297]
Stock Position:  -0.061512973151681
Bond Position:  [9.65504055]


portfolio before change:  [3.67655543]
curr_Stock_Price:  97.20044851584964
curr_Factors:  [97.20044852]
mat_Sqrt:  [[0.15]]
grads:  [-0.11863088]
Stock Position:  -0.1186308788462268
Bond Position:  [15.20753006]


portfolio before change:  [3.69896084]
curr_Stock_Price:  97.01959419107669
curr_Factors:  [97.01959419]
mat_Sqrt:  [[0.15]]
grads:  [0.0640594]
Stock Position:  0.06405939798624109
Bond Position:  [-2.51605596]


portfolio before change:  [3.67247402]
curr_Stock_Price:  96.60857639766259
curr_Factors:  [96.6085764]
mat_Sqrt:  [[0.15]]
grads:  [0.01297674]
Stock Position:  0.012976735276134929
Bond Position:  [2.4188101]


portfolio before change:  [3.6640229]
curr_Stock_Price:  95.94567429043276
curr_Factors:  [95.94567429]
mat_Sqrt:  [[0.15]]
grads:  [0.09090423]
Stock Position:  0.09090422569279892
Bond Position:  [-5.05784433]


portfolio before change:  [3.67323278]
curr_Stock_Price:  96.05046592150703
curr_Factors:  [96.05046592]
mat_Sqrt:  [[0.15]]
grads:  [-0.12483461]
Stock Position:  -0.12483461439846735
Bond Position:  [15.66365565]


portfolio before change:  [3.6681725]
curr_Stock_Price:  96.09884417906257
curr_Factors:  [96.09884418]
mat_Sqrt:  [[0.15]]
grads:  [0.08182974]
Stock Position:  0.08182974129550127
Bond Position:  [-4.19557105]


portfolio before change:  [3.6238713]
curr_Stock_Price:  95.56066610114289
curr_Factors:  [95.5606661]
mat_Sqrt:  [[0.15]]
grads:  [-0.04723755]
Stock Position:  -0.04723754702907855
Bond Position:  [8.13792276]


portfolio before change:  [3.61988419]
curr_Stock_Price:  95.65583922338428
curr_Factors:  [95.65583922]
mat_Sqrt:  [[0.15]]
grads:  [-0.02068518]
Stock Position:  -0.02068517802180165
Bond Position:  [5.59854225]


portfolio before change:  [3.62668601]
curr_Stock_Price:  95.34393014612976
curr_Factors:  [95.34393015]
mat_Sqrt:  [[0.15]]
grads:  [0.05150472]
Stock Position:  0.051504715905832124
Bond Position:  [-1.28397603]


portfolio before change:  [3.59468355]
curr_Stock_Price:  94.72413817516144
curr_Factors:  [94.72413818]
mat_Sqrt:  [[0.15]]
grads:  [-0.04640417]
Stock Position:  -0.046404174433668434
Bond Position:  [7.99027898]


portfolio before change:  [3.5962539]
curr_Stock_Price:  94.70105959791704
curr_Factors:  [94.7010596]
mat_Sqrt:  [[0.15]]
grads:  [0.02283372]
Stock Position:  0.02283371512066803
Bond Position:  [1.43387688]


portfolio before change:  [3.61560092]
curr_Stock_Price:  95.54443560285362
curr_Factors:  [95.5444356]
mat_Sqrt:  [[0.15]]
grads:  [0.07061639]
Stock Position:  0.0706163862889744
Bond Position:  [-3.13140185]


portfolio before change:  [3.62391766]
curr_Stock_Price:  95.66498062894478
curr_Factors:  [95.66498063]
mat_Sqrt:  [[0.15]]
grads:  [-0.08328016]
Stock Position:  -0.0832801572955992
Bond Position:  [11.59091229]


portfolio before change:  [3.65715246]
curr_Stock_Price:  95.27460734178936
curr_Factors:  [95.27460734]
mat_Sqrt:  [[0.15]]
grads:  [-0.3140376]
Stock Position:  -0.3140376044979334
Bond Position:  [33.57696192]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.65715246]
Stock Price:  95.13610645939559
PL:  [3.65715246]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.97355426e-02]
 [ 9.97854155e-04]
 [ 2.50909571e-04]
 [ 2.14429512e-03]
 [-1.07494206e-02]
 [ 8.41108843e-03]
 [ 4.76581938e-04]
 [ 1.48267665e-02]
 [ 1.77669497e-02]
 [-1.95831572e-02]
 [ 6.40491927e-03]
 [-6.49297336e-03]
 [-3.57666255e-03]
 [ 3.63827636e-03]
 [-2.98747701e-06]
 [ 9.35654674e-03]
 [ 1.64357011e-03]
 [ 1.09505329e-02]
 [ 2.00199995e-02]
 [ 7.71566665e-03]
 [ 5.65840615e-02]
 [-1.59076746e-02]
 [-1.97556876e-03]
 [ 1.10928001e-02]
 [ 1.25760540e-02]
 [ 1.48032471e-03]
 [ 1.34446298e-02]
 [ 1.59189306e-03]
 [ 3.30947378e-03]
 [-2.40207479e-02]
 [-4.62722353e-03]
 [ 1.33098902e-02]
 [ 9.09122874e-03]
 [ 1.62279014e-02]
 [-9.24548599e-04]
 [ 1.77413267e-03]
 [-3.45182959e-03]
 [ 1.30401162e-02]
 [-1.17175822e-03]
 [-1.38142468e-02]
 [-9.09349333e-04]
 [-2.91196501e-03]
 [ 4.97006517e-03]
 [-1.09528999e-02]
 [ 2.73002523e-03]
 [ 7.99075985e-04]
 [-1.36949443e-02]
 [-4.04622147e-03]
 [ 1.29600001e-04]
 [ 4.65432530e-03]
 [-2.98490460e-03]
 [ 3.78127839e-03]
 [ 1.33015538e-04]
 [-1.71527979e-03]
 [ 2.18909035e-03]
 [ 9.01383773e-03]
 [ 1.65717662e-02]
 [-2.80039437e-02]
 [ 1.39645223e-02]
 [ 5.32219762e-03]
 [ 5.19286580e-03]
 [-1.48079038e-02]
 [-1.26152939e-02]
 [-1.39864854e-03]
 [-1.17240349e-02]
 [-1.01573021e-02]
 [ 1.16226299e-02]
 [ 2.00185955e-03]
 [ 8.42317857e-03]
 [-1.76576589e-02]
 [ 3.53588353e-03]
 [ 1.63389005e-03]
 [-1.65369534e-03]
 [ 7.64663140e-03]
 [-2.07307652e-03]
 [ 2.82985083e-03]
 [ 7.90648979e-03]
 [-1.12326943e-02]
 [-3.47963301e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.62133724]
curr_Stock_Price:  99.37735968897404
curr_Factors:  [99.37735969]
mat_Sqrt:  [[0.15]]
grads:  [-0.26490362]
Stock Position:  -0.2649036175674728
Bond Position:  [18.70408485]


portfolio before change:  [-7.67645932]
curr_Stock_Price:  99.58985630495633
curr_Factors:  [99.5898563]
mat_Sqrt:  [[0.15]]
grads:  [0.00665236]
Stock Position:  0.006652361035998292
Bond Position:  [-8.338967]


portfolio before change:  [-7.67367091]
curr_Stock_Price:  100.08736531311857
curr_Factors:  [100.08736531]
mat_Sqrt:  [[0.15]]
grads:  [0.00167273]
Stock Position:  0.001672730471907995
Bond Position:  [-7.8410901]


portfolio before change:  [-7.67449667]
curr_Stock_Price:  99.8866909629062
curr_Factors:  [99.88669096]
mat_Sqrt:  [[0.15]]
grads:  [0.0142953]
Stock Position:  0.014295300832415942
Bond Position:  [-9.10240697]


portfolio before change:  [-7.68729562]
curr_Stock_Price:  99.0311630135886
curr_Factors:  [99.03116301]
mat_Sqrt:  [[0.15]]
grads:  [-0.0716628]
Stock Position:  -0.07166280407276107
Bond Position:  [-0.59044479]


portfolio before change:  [-7.68833146]
curr_Stock_Price:  99.04510249054992
curr_Factors:  [99.04510249]
mat_Sqrt:  [[0.15]]
grads:  [0.05607392]
Stock Position:  0.056073922893676985
Bond Position:  [-13.2421789]


portfolio before change:  [-7.7071088]
curr_Stock_Price:  98.72499514884073
curr_Factors:  [98.72499515]
mat_Sqrt:  [[0.15]]
grads:  [0.00317721]
Stock Position:  0.003177212918005981
Bond Position:  [-8.02077913]


portfolio before change:  [-7.70719977]
curr_Stock_Price:  98.85414682234953
curr_Factors:  [98.85414682]
mat_Sqrt:  [[0.15]]
grads:  [0.09884511]
Stock Position:  0.09884510986155853
Bond Position:  [-17.47844878]


portfolio before change:  [-7.67350989]
curr_Stock_Price:  99.20603393379642
curr_Factors:  [99.20603393]
mat_Sqrt:  [[0.15]]
grads:  [0.11844633]
Stock Position:  0.11844633160471188
Bond Position:  [-19.42410068]


portfolio before change:  [-7.66436468]
curr_Stock_Price:  99.29349338114852
curr_Factors:  [99.29349338]
mat_Sqrt:  [[0.15]]
grads:  [-0.13055438]
Stock Position:  -0.13055438134004205
Bond Position:  [5.29883592]


portfolio before change:  [-7.67084482]
curr_Stock_Price:  99.34566571485756
curr_Factors:  [99.34566571]
mat_Sqrt:  [[0.15]]
grads:  [0.04269946]
Stock Position:  0.042699461831608616
Bond Position:  [-11.91285128]


portfolio before change:  [-7.69210566]
curr_Stock_Price:  98.86518519819846
curr_Factors:  [98.8651852]
mat_Sqrt:  [[0.15]]
grads:  [-0.04328649]
Stock Position:  -0.043286489098343574
Bond Position:  [-3.4125789]


portfolio before change:  [-7.6890442]
curr_Stock_Price:  98.78953226143905
curr_Factors:  [98.78953226]
mat_Sqrt:  [[0.15]]
grads:  [-0.02384442]
Stock Position:  -0.023844416985182578
Bond Position:  [-5.3334654]


portfolio before change:  [-7.69276496]
curr_Stock_Price:  98.93159531559706
curr_Factors:  [98.93159532]
mat_Sqrt:  [[0.15]]
grads:  [0.02425518]
Stock Position:  0.02425517576494102
Bond Position:  [-10.0923682]


portfolio before change:  [-7.68252806]
curr_Stock_Price:  99.37965220937173
curr_Factors:  [99.37965221]
mat_Sqrt:  [[0.15]]
grads:  [-1.99165134e-05]
Stock Position:  -1.991651337283675e-05
Bond Position:  [-7.68054876]


portfolio before change:  [-7.68300798]
curr_Stock_Price:  99.37307910938691
curr_Factors:  [99.37307911]
mat_Sqrt:  [[0.15]]
grads:  [0.06237698]
Stock Position:  0.06237697825650269
Bond Position:  [-13.88160037]


portfolio before change:  [-7.67670593]
curr_Stock_Price:  99.48802009017352
curr_Factors:  [99.48802009]
mat_Sqrt:  [[0.15]]
grads:  [0.01095713]
Stock Position:  0.010957134080659568
Bond Position:  [-8.76680951]


portfolio before change:  [-7.67002151]
curr_Stock_Price:  100.14807975133864
curr_Factors:  [100.14807975]
mat_Sqrt:  [[0.15]]
grads:  [0.07300355]
Stock Position:  0.0730035525967571
Bond Position:  [-14.98118712]


portfolio before change:  [-7.61388503]
curr_Stock_Price:  100.92986136672097
curr_Factors:  [100.92986137]
mat_Sqrt:  [[0.15]]
grads:  [0.13346666]
Stock Position:  0.13346666361070708
Bond Position:  [-21.08465689]


portfolio before change:  [-7.74908913]
curr_Stock_Price:  99.92671745676095
curr_Factors:  [99.92671746]
mat_Sqrt:  [[0.15]]
grads:  [0.05143778]
Stock Position:  0.05143777765424097
Bond Position:  [-12.88909741]


portfolio before change:  [-7.77651807]
curr_Stock_Price:  99.40913406818267
curr_Factors:  [99.40913407]
mat_Sqrt:  [[0.15]]
grads:  [0.37722708]
Stock Position:  0.37722707660182414
Bond Position:  [-45.2763351]


portfolio before change:  [-7.75065721]
curr_Stock_Price:  99.48519095920774
curr_Factors:  [99.48519096]
mat_Sqrt:  [[0.15]]
grads:  [-0.10605116]
Stock Position:  -0.10605116383237218
Bond Position:  [2.79986308]


portfolio before change:  [-7.7529547]
curr_Stock_Price:  99.5085050817503
curr_Factors:  [99.50850508]
mat_Sqrt:  [[0.15]]
grads:  [-0.01317046]
Stock Position:  -0.013170458392593011
Bond Position:  [-6.44238207]


portfolio before change:  [-7.76102845]
curr_Stock_Price:  100.090951935298
curr_Factors:  [100.09095194]
mat_Sqrt:  [[0.15]]
grads:  [0.073952]
Stock Position:  0.07395200045249281
Bond Position:  [-15.16295458]


portfolio before change:  [-7.77469787]
curr_Stock_Price:  99.91892542735279
curr_Factors:  [99.91892543]
mat_Sqrt:  [[0.15]]
grads:  [0.08384036]
Stock Position:  0.0838403598806689
Bond Position:  [-16.15193654]


portfolio before change:  [-7.83801242]
curr_Stock_Price:  99.17578672295329
curr_Factors:  [99.17578672]
mat_Sqrt:  [[0.15]]
grads:  [0.00986883]
Stock Position:  0.009868831412046681
Bond Position:  [-8.81676154]


portfolio before change:  [-7.83188568]
curr_Stock_Price:  99.85244230412634
curr_Factors:  [99.8524423]
mat_Sqrt:  [[0.15]]
grads:  [0.08963087]
Stock Position:  0.08963086504272626
Bond Position:  [-16.78174646]


portfolio before change:  [-7.78108153]
curr_Stock_Price:  100.43095999643526
curr_Factors:  [100.43096]
mat_Sqrt:  [[0.15]]
grads:  [0.01061262]
Stock Position:  0.010612620416201174
Bond Position:  [-8.84691719]


portfolio before change:  [-7.78128109]
curr_Stock_Price:  100.4642590676412
curr_Factors:  [100.46425907]
mat_Sqrt:  [[0.15]]
grads:  [0.02206316]
Stock Position:  0.022063158544122198
Bond Position:  [-9.99783997]


portfolio before change:  [-7.78977598]
curr_Stock_Price:  100.10755543573424
curr_Factors:  [100.10755544]
mat_Sqrt:  [[0.15]]
grads:  [-0.16013832]
Stock Position:  -0.16013831961035518
Bond Position:  [8.24127972]


portfolio before change:  [-7.8002917]
curr_Stock_Price:  100.1764384506268
curr_Factors:  [100.17643845]
mat_Sqrt:  [[0.15]]
grads:  [-0.03084816]
Stock Position:  -0.030848156868140304
Bond Position:  [-4.71003321]


portfolio before change:  [-7.81996835]
curr_Stock_Price:  100.80475054172916
curr_Factors:  [100.80475054]
mat_Sqrt:  [[0.15]]
grads:  [0.0887326]
Stock Position:  0.0887326012139256
Bond Position:  [-16.76463609]


portfolio before change:  [-7.78741537]
curr_Stock_Price:  101.1834254081147
curr_Factors:  [101.18342541]
mat_Sqrt:  [[0.15]]
grads:  [0.06060819]
Stock Position:  0.060608191575957926
Bond Position:  [-13.9199598]


portfolio before change:  [-7.85827266]
curr_Stock_Price:  100.02867608008691
curr_Factors:  [100.02867608]
mat_Sqrt:  [[0.15]]
grads:  [0.10818601]
Stock Position:  0.10818600934359912
Bond Position:  [-18.67997595]


portfolio before change:  [-7.87208546]
curr_Stock_Price:  99.91179166957541
curr_Factors:  [99.91179167]
mat_Sqrt:  [[0.15]]
grads:  [-0.00616366]
Stock Position:  -0.006163657329054205
Bond Position:  [-7.25626341]


portfolio before change:  [-7.87198944]
curr_Stock_Price:  99.82263245115215
curr_Factors:  [99.82263245]
mat_Sqrt:  [[0.15]]
grads:  [0.01182755]
Stock Position:  0.01182755115751121
Bond Position:  [-9.05264673]


portfolio before change:  [-7.87039547]
curr_Stock_Price:  100.00523803621878
curr_Factors:  [100.00523804]
mat_Sqrt:  [[0.15]]
grads:  [-0.0230122]
Stock Position:  -0.02301219729093589
Bond Position:  [-5.5690552]


portfolio before change:  [-7.87782583]
curr_Stock_Price:  100.31300017920348
curr_Factors:  [100.31300018]
mat_Sqrt:  [[0.15]]
grads:  [0.08693411]
Stock Position:  0.08693410815332883
Bond Position:  [-16.59844704]


portfolio before change:  [-7.91547326]
curr_Stock_Price:  99.8918767545159
curr_Factors:  [99.89187675]
mat_Sqrt:  [[0.15]]
grads:  [-0.00781172]
Stock Position:  -0.007811721456843791
Bond Position:  [-7.13514574]


portfolio before change:  [-7.91515747]
curr_Stock_Price:  99.79436347269126
curr_Factors:  [99.79436347]
mat_Sqrt:  [[0.15]]
grads:  [-0.09209498]
Stock Position:  -0.09209497836479556
Bond Position:  [1.27540227]


portfolio before change:  [-7.97532163]
curr_Stock_Price:  100.44851287089817
curr_Factors:  [100.44851287]
mat_Sqrt:  [[0.15]]
grads:  [-0.00606233]
Stock Position:  -0.006062328887457419
Bond Position:  [-7.36636971]


portfolio before change:  [-7.97366377]
curr_Stock_Price:  100.09909704043095
curr_Factors:  [100.09909704]
mat_Sqrt:  [[0.15]]
grads:  [-0.0194131]
Stock Position:  -0.01941310003572778
Bond Position:  [-6.03042999]


portfolio before change:  [-7.96576358]
curr_Stock_Price:  99.67273019767306
curr_Factors:  [99.6727302]
mat_Sqrt:  [[0.15]]
grads:  [0.03313377]
Stock Position:  0.03313376777492786
Bond Position:  [-11.26829668]


portfolio before change:  [-7.96121807]
curr_Stock_Price:  99.83117297591505
curr_Factors:  [99.83117298]
mat_Sqrt:  [[0.15]]
grads:  [-0.07301933]
Stock Position:  -0.07301933291586771
Bond Position:  [-0.67161241]


portfolio before change:  [-7.93254498]
curr_Stock_Price:  99.43792014622574
curr_Factors:  [99.43792015]
mat_Sqrt:  [[0.15]]
grads:  [0.01820017]
Stock Position:  0.018200168200708296
Bond Position:  [-9.74233186]


portfolio before change:  [-7.90921577]
curr_Stock_Price:  100.75318979385605
curr_Factors:  [100.75318979]
mat_Sqrt:  [[0.15]]
grads:  [0.00532717]
Stock Position:  0.005327173236083075
Bond Position:  [-8.44594547]


portfolio before change:  [-7.90624886]
curr_Stock_Price:  101.40922133628624
curr_Factors:  [101.40922134]
mat_Sqrt:  [[0.15]]
grads:  [-0.09129963]
Stock Position:  -0.09129962852709397
Bond Position:  [1.35237537]


portfolio before change:  [-7.9256819]
curr_Stock_Price:  101.62299615488934
curr_Factors:  [101.62299615]
mat_Sqrt:  [[0.15]]
grads:  [-0.02697481]
Stock Position:  -0.026974809777001545
Bond Position:  [-5.18442091]


portfolio before change:  [-7.9023729]
curr_Stock_Price:  100.74688131496389
curr_Factors:  [100.74688131]
mat_Sqrt:  [[0.15]]
grads:  [0.000864]
Stock Position:  0.0008640000072604843
Bond Position:  [-7.98941821]


portfolio before change:  [-7.90288701]
curr_Stock_Price:  100.72981336599332
curr_Factors:  [100.72981337]
mat_Sqrt:  [[0.15]]
grads:  [0.03102884]
Stock Position:  0.031028835341936716
Bond Position:  [-11.0284158]


portfolio before change:  [-7.92644482]
curr_Stock_Price:  99.99280467836654
curr_Factors:  [99.99280468]
mat_Sqrt:  [[0.15]]
grads:  [-0.01989936]
Stock Position:  -0.01989936400919342
Bond Position:  [-5.93665161]


portfolio before change:  [-7.95019927]
curr_Stock_Price:  101.16788720650591
curr_Factors:  [101.16788721]
mat_Sqrt:  [[0.15]]
grads:  [0.02520852]
Stock Position:  0.02520852258497242
Bond Position:  [-10.50049224]


portfolio before change:  [-7.95670246]
curr_Stock_Price:  100.93594638186255
curr_Factors:  [100.93594638]
mat_Sqrt:  [[0.15]]
grads:  [0.00088677]
Stock Position:  0.0008867702559462853
Bond Position:  [-8.04620945]


portfolio before change:  [-7.957641]
curr_Stock_Price:  100.44467983925902
curr_Factors:  [100.44467984]
mat_Sqrt:  [[0.15]]
grads:  [-0.0114352]
Stock Position:  -0.011435198580922934
Bond Position:  [-6.80903614]


portfolio before change:  [-7.94942899]
curr_Stock_Price:  99.68932890101472
curr_Factors:  [99.6893289]
mat_Sqrt:  [[0.15]]
grads:  [0.01459394]
Stock Position:  0.014593935682825502
Bond Position:  [-9.40428865]


portfolio before change:  [-7.95437323]
curr_Stock_Price:  99.39081773579146
curr_Factors:  [99.39081774]
mat_Sqrt:  [[0.15]]
grads:  [0.06009225]
Stock Position:  0.06009225155074949
Bond Position:  [-13.92699125]


portfolio before change:  [-7.97483879]
curr_Stock_Price:  99.06473416590718
curr_Factors:  [99.06473417]
mat_Sqrt:  [[0.15]]
grads:  [0.11047844]
Stock Position:  0.11047844133743447
Bond Position:  [-18.91935621]


portfolio before change:  [-7.94715396]
curr_Stock_Price:  99.32602797273017
curr_Factors:  [99.32602797]
mat_Sqrt:  [[0.15]]
grads:  [-0.18669296]
Stock Position:  -0.18669295774404984
Bond Position:  [10.59631599]


portfolio before change:  [-7.9292742]
curr_Stock_Price:  99.23380453222634
curr_Factors:  [99.23380453]
mat_Sqrt:  [[0.15]]
grads:  [0.09309682]
Stock Position:  0.09309681561009256
Bond Position:  [-17.1676254]


portfolio before change:  [-7.93030663]
curr_Stock_Price:  99.23424045421496
curr_Factors:  [99.23424045]
mat_Sqrt:  [[0.15]]
grads:  [0.03548132]
Stock Position:  0.03548131743597734
Bond Position:  [-11.45126821]


portfolio before change:  [-7.9398687]
curr_Stock_Price:  98.98491628597851
curr_Factors:  [98.98491629]
mat_Sqrt:  [[0.15]]
grads:  [0.03461911]
Stock Position:  0.03461910536458492
Bond Position:  [-11.36663795]


portfolio before change:  [-7.9638149]
curr_Stock_Price:  98.31373318810009
curr_Factors:  [98.31373319]
mat_Sqrt:  [[0.15]]
grads:  [-0.09871936]
Stock Position:  -0.09871935851327478
Bond Position:  [1.74165378]


portfolio before change:  [-7.98674884]
curr_Stock_Price:  98.54715040541014
curr_Factors:  [98.54715041]
mat_Sqrt:  [[0.15]]
grads:  [-0.08410196]
Stock Position:  -0.08410195965159697
Bond Position:  [0.30125963]


portfolio before change:  [-8.00417602]
curr_Stock_Price:  98.75458920507043
curr_Factors:  [98.75458921]
mat_Sqrt:  [[0.15]]
grads:  [-0.00932432]
Stock Position:  -0.009324323573097633
Bond Position:  [-7.08335628]


portfolio before change:  [-8.00392659]
curr_Stock_Price:  98.68035821150923
curr_Factors:  [98.68035821]
mat_Sqrt:  [[0.15]]
grads:  [-0.07816023]
Stock Position:  -0.07816023241679453
Bond Position:  [-0.29104686]


portfolio before change:  [-7.96526306]
curr_Stock_Price:  98.18545541974714
curr_Factors:  [98.18545542]
mat_Sqrt:  [[0.15]]
grads:  [-0.06771535]
Stock Position:  -0.06771534751796969
Bond Position:  [-1.31660083]


portfolio before change:  [-7.99985208]
curr_Stock_Price:  98.69504041758886
curr_Factors:  [98.69504042]
mat_Sqrt:  [[0.15]]
grads:  [0.0774842]
Stock Position:  0.07748419948584373
Bond Position:  [-15.64715828]


portfolio before change:  [-7.98217516]
curr_Stock_Price:  98.93579781245978
curr_Factors:  [98.93579781]
mat_Sqrt:  [[0.15]]
grads:  [0.01334573]
Stock Position:  0.013345730340986734
Bond Position:  [-9.30254564]


portfolio before change:  [-7.98686975]
curr_Stock_Price:  98.62759767366464
curr_Factors:  [98.62759767]
mat_Sqrt:  [[0.15]]
grads:  [0.05615452]
Stock Position:  0.056154523794461265
Bond Position:  [-13.52525553]


portfolio before change:  [-8.0634653]
curr_Stock_Price:  97.2786377771858
curr_Factors:  [97.27863778]
mat_Sqrt:  [[0.15]]
grads:  [-0.11771773]
Stock Position:  -0.11771772571577681
Bond Position:  [3.3879547]


portfolio before change:  [-8.09030652]
curr_Stock_Price:  97.50845002158111
curr_Factors:  [97.50845002]
mat_Sqrt:  [[0.15]]
grads:  [0.02357256]
Stock Position:  0.02357255685796658
Bond Position:  [-10.38883]


portfolio before change:  [-8.10081113]
curr_Stock_Price:  97.09036719664175
curr_Factors:  [97.0903672]
mat_Sqrt:  [[0.15]]
grads:  [0.0108926]
Stock Position:  0.010892600325027452
Bond Position:  [-9.15837769]


portfolio before change:  [-8.10773065]
curr_Stock_Price:  96.50766783473343
curr_Factors:  [96.50766783]
mat_Sqrt:  [[0.15]]
grads:  [-0.01102464]
Stock Position:  -0.011024635623232318
Bond Position:  [-7.04376878]


portfolio before change:  [-8.10552167]
curr_Stock_Price:  96.26736713147189
curr_Factors:  [96.26736713]
mat_Sqrt:  [[0.15]]
grads:  [0.05097754]
Stock Position:  0.05097754266135064
Bond Position:  [-13.01299549]


portfolio before change:  [-8.09316525]
curr_Stock_Price:  96.52571147562166
curr_Factors:  [96.52571148]
mat_Sqrt:  [[0.15]]
grads:  [-0.01382051]
Stock Position:  -0.013820510141384317
Bond Position:  [-6.75913068]


portfolio before change:  [-8.09216411]
curr_Stock_Price:  96.42270538655183
curr_Factors:  [96.42270539]
mat_Sqrt:  [[0.15]]
grads:  [0.01886567]
Stock Position:  0.018865672198764265
Bond Position:  [-9.91124327]


portfolio before change:  [-8.09841253]
curr_Stock_Price:  96.12433590722682
curr_Factors:  [96.12433591]
mat_Sqrt:  [[0.15]]
grads:  [0.05270993]
Stock Position:  0.052709931945839825
Bond Position:  [-13.16511973]


portfolio before change:  [-8.06285507]
curr_Stock_Price:  96.81453408552949
curr_Factors:  [96.81453409]
mat_Sqrt:  [[0.15]]
grads:  [-0.07488463]
Stock Position:  -0.07488462895063848
Bond Position:  [-0.81293461]


portfolio before change:  [-8.03773211]
curr_Stock_Price:  96.47836669912999
curr_Factors:  [96.4783667]
mat_Sqrt:  [[0.15]]
grads:  [-0.23197553]
Stock Position:  -0.23197553406747617
Bond Position:  [14.34288853]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.03773211]
Stock Price:  97.05114210807602
PL:  [-8.03773211]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.69098721e-02]
 [-6.34050703e-04]
 [ 3.29187452e-04]
 [ 6.40789199e-04]
 [ 1.84307733e-02]
 [ 1.12990775e-02]
 [ 8.27605448e-04]
 [ 1.25723923e-02]
 [ 1.77993997e-02]
 [-1.90704162e-02]
 [ 7.13078324e-03]
 [-4.85072618e-03]
 [-9.37595907e-03]
 [ 4.31256031e-03]
 [ 3.32794999e-03]
 [-2.81124647e-04]
 [ 1.41588922e-02]
 [ 1.69453134e-02]
 [ 1.91316710e-02]
 [ 2.34913815e-04]
 [ 7.79709991e-02]
 [-1.31507987e-02]
 [ 2.57520480e-04]
 [ 2.09297276e-03]
 [ 1.55192996e-02]
 [ 7.16604039e-04]
 [ 1.25369554e-02]
 [-5.63981577e-04]
 [ 4.54985694e-03]
 [-1.74920262e-02]
 [-5.68905163e-03]
 [ 3.65023042e-02]
 [ 5.75204357e-03]
 [-5.95915609e-03]
 [-6.67619801e-03]
 [-4.39669487e-03]
 [-3.89992413e-03]
 [ 1.24137088e-03]
 [ 4.16195323e-03]
 [-7.24242516e-03]
 [-5.26788298e-02]
 [-3.87952519e-03]
 [ 1.63130158e-02]
 [-1.49710481e-02]
 [-4.08447181e-03]
 [ 2.88775661e-03]
 [-1.35753586e-02]
 [ 1.04890166e-02]
 [ 1.58981164e-02]
 [-1.18206190e-02]
 [-4.07060062e-03]
 [ 3.47990175e-03]
 [ 3.03356934e-03]
 [-1.75261461e-03]
 [-8.30114839e-03]
 [ 9.76031639e-03]
 [-4.33710627e-03]
 [-1.25447832e-02]
 [ 1.46935201e-02]
 [ 2.44611413e-03]
 [ 1.25118539e-02]
 [-1.48583768e-02]
 [-1.27464647e-02]
 [-3.23884282e-03]
 [-1.23457717e-02]
 [-6.84119572e-03]
 [ 2.96801883e-02]
 [ 2.46699415e-03]
 [ 8.02493599e-03]
 [-1.62920073e-02]
 [-7.74537650e-03]
 [-7.29441131e-03]
 [ 4.96649434e-03]
 [ 6.87241670e-03]
 [-6.40436842e-04]
 [-4.73459942e-03]
 [ 8.44652379e-03]
 [-3.80981731e-03]
 [ 2.48872845e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.40882353]
curr_Stock_Price:  100.08627539703696
curr_Factors:  [100.0862754]
mat_Sqrt:  [[0.15]]
grads:  [-0.24606581]
Stock Position:  -0.24606581386692888
Bond Position:  [28.03663434]


portfolio before change:  [3.48088255]
curr_Stock_Price:  99.80055232887221
curr_Factors:  [99.80055233]
mat_Sqrt:  [[0.15]]
grads:  [-0.004227]
Stock Position:  -0.004227004684217944
Bond Position:  [3.90273995]


portfolio before change:  [3.48133192]
curr_Stock_Price:  99.75195102098034
curr_Factors:  [99.75195102]
mat_Sqrt:  [[0.15]]
grads:  [0.00219458]
Stock Position:  0.0021945830101579296
Bond Position:  [3.26241798]


portfolio before change:  [3.48059467]
curr_Stock_Price:  99.3230952503132
curr_Factors:  [99.32309525]
mat_Sqrt:  [[0.15]]
grads:  [0.00427193]
Stock Position:  0.004271927990180544
Bond Position:  [3.05629356]


portfolio before change:  [3.48289359]
curr_Stock_Price:  99.81652588034831
curr_Factors:  [99.81652588]
mat_Sqrt:  [[0.15]]
grads:  [0.12287182]
Stock Position:  0.12287182188679638
Bond Position:  [-8.7817448]


portfolio before change:  [3.45859205]
curr_Stock_Price:  99.62321335413398
curr_Factors:  [99.62321335]
mat_Sqrt:  [[0.15]]
grads:  [0.07532718]
Stock Position:  0.07532718326892614
Bond Position:  [-4.045744]


portfolio before change:  [3.45514944]
curr_Stock_Price:  99.58086818357529
curr_Factors:  [99.58086818]
mat_Sqrt:  [[0.15]]
grads:  [0.00551737]
Stock Position:  0.005517369651786179
Bond Position:  [2.90572498]


portfolio before change:  [3.45617868]
curr_Stock_Price:  99.73449597623913
curr_Factors:  [99.73449598]
mat_Sqrt:  [[0.15]]
grads:  [0.08381595]
Stock Position:  0.0838159485963273
Bond Position:  [-4.90316271]


portfolio before change:  [3.4094005]
curr_Stock_Price:  99.18004639087326
curr_Factors:  [99.18004639]
mat_Sqrt:  [[0.15]]
grads:  [0.11866266]
Stock Position:  0.11866266464557937
Bond Position:  [-8.35956808]


portfolio before change:  [3.45151374]
curr_Stock_Price:  99.5393483419589
curr_Factors:  [99.53934834]
mat_Sqrt:  [[0.15]]
grads:  [-0.12713611]
Stock Position:  -0.12713610767540048
Bond Position:  [16.10655905]


portfolio before change:  [3.44549653]
curr_Stock_Price:  99.59459547217057
curr_Factors:  [99.59459547]
mat_Sqrt:  [[0.15]]
grads:  [0.04753855]
Stock Position:  0.04753855493760195
Bond Position:  [-1.28908662]


portfolio before change:  [3.46460101]
curr_Stock_Price:  99.99816368699238
curr_Factors:  [99.99816369]
mat_Sqrt:  [[0.15]]
grads:  [-0.03233817]
Stock Position:  -0.03233817453077049
Bond Position:  [6.69835908]


portfolio before change:  [3.47174935]
curr_Stock_Price:  99.79006031765171
curr_Factors:  [99.79006032]
mat_Sqrt:  [[0.15]]
grads:  [-0.06250639]
Stock Position:  -0.06250639380360598
Bond Position:  [9.70926616]


portfolio before change:  [3.46925031]
curr_Stock_Price:  99.8397494107698
curr_Factors:  [99.83974941]
mat_Sqrt:  [[0.15]]
grads:  [0.0287504]
Stock Position:  0.028750402063316857
Bond Position:  [0.59881737]


portfolio before change:  [3.46464474]
curr_Stock_Price:  99.6782559459008
curr_Factors:  [99.67825595]
mat_Sqrt:  [[0.15]]
grads:  [0.02218633]
Stock Position:  0.022186333288253743
Bond Position:  [1.25314973]


portfolio before change:  [3.47378884]
curr_Stock_Price:  100.08687593192687
curr_Factors:  [100.08687593]
mat_Sqrt:  [[0.15]]
grads:  [-0.00187416]
Stock Position:  -0.0018741643123886334
Bond Position:  [3.66136809]


portfolio before change:  [3.47304094]
curr_Stock_Price:  100.60803854547
curr_Factors:  [100.60803855]
mat_Sqrt:  [[0.15]]
grads:  [0.09439261]
Stock Position:  0.09439261465053822
Bond Position:  [-6.02361487]


portfolio before change:  [3.49695489]
curr_Stock_Price:  100.86537263906814
curr_Factors:  [100.86537264]
mat_Sqrt:  [[0.15]]
grads:  [0.11296876]
Stock Position:  0.11296875586706732
Bond Position:  [-7.89768077]


portfolio before change:  [3.52438389]
curr_Stock_Price:  101.11254381367668
curr_Factors:  [101.11254381]
mat_Sqrt:  [[0.15]]
grads:  [0.12754447]
Stock Position:  0.12754447330269708
Bond Position:  [-9.37196226]


portfolio before change:  [3.54666719]
curr_Stock_Price:  101.29184653700968
curr_Factors:  [101.29184654]
mat_Sqrt:  [[0.15]]
grads:  [0.00156609]
Stock Position:  0.001566092097825371
Bond Position:  [3.38803483]


portfolio before change:  [3.54600426]
curr_Stock_Price:  100.73332967214557
curr_Factors:  [100.73332967]
mat_Sqrt:  [[0.15]]
grads:  [0.51980666]
Stock Position:  0.519806660740569
Bond Position:  [-48.81585146]


portfolio before change:  [3.65710161]
curr_Stock_Price:  100.95292753888032
curr_Factors:  [100.95292754]
mat_Sqrt:  [[0.15]]
grads:  [-0.08767199]
Stock Position:  -0.08767199108068593
Bond Position:  [12.50784577]


portfolio before change:  [3.69529433]
curr_Stock_Price:  100.52621259446349
curr_Factors:  [100.52621259]
mat_Sqrt:  [[0.15]]
grads:  [0.0017168]
Stock Position:  0.0017168031967644086
Bond Position:  [3.5227106]


portfolio before change:  [3.69647576]
curr_Stock_Price:  101.08612645099143
curr_Factors:  [101.08612645]
mat_Sqrt:  [[0.15]]
grads:  [0.01395315]
Stock Position:  0.013953151701146839
Bond Position:  [2.28600571]


portfolio before change:  [3.6992857]
curr_Stock_Price:  101.27727011449855
curr_Factors:  [101.27727011]
mat_Sqrt:  [[0.15]]
grads:  [0.103462]
Stock Position:  0.10346199750857515
Bond Position:  [-6.77906297]


portfolio before change:  [3.6610609]
curr_Stock_Price:  100.91190800266274
curr_Factors:  [100.911908]
mat_Sqrt:  [[0.15]]
grads:  [0.00477736]
Stock Position:  0.004777360263060309
Bond Position:  [3.17896836]


portfolio before change:  [3.66162682]
curr_Stock_Price:  100.98877554951372
curr_Factors:  [100.98877555]
mat_Sqrt:  [[0.15]]
grads:  [0.0835797]
Stock Position:  0.08357970298004017
Bond Position:  [-4.77898505]


portfolio before change:  [3.67633665]
curr_Stock_Price:  101.16834704414816
curr_Factors:  [101.16834704]
mat_Sqrt:  [[0.15]]
grads:  [-0.00375988]
Stock Position:  -0.003759877177954447
Bond Position:  [4.05671721]


portfolio before change:  [3.67559868]
curr_Stock_Price:  101.43205892302063
curr_Factors:  [101.43205892]
mat_Sqrt:  [[0.15]]
grads:  [0.03033238]
Stock Position:  0.030332379579268116
Bond Position:  [0.59892297]


portfolio before change:  [3.70093028]
curr_Stock_Price:  102.26595856438256
curr_Factors:  [102.26595856]
mat_Sqrt:  [[0.15]]
grads:  [-0.11661351]
Stock Position:  -0.11661350783833845
Bond Position:  [15.62652244]


portfolio before change:  [3.67599936]
curr_Stock_Price:  102.48812494661861
curr_Factors:  [102.48812495]
mat_Sqrt:  [[0.15]]
grads:  [-0.03792701]
Stock Position:  -0.0379270108792783
Bond Position:  [7.56306759]


portfolio before change:  [3.66514826]
curr_Stock_Price:  102.78669327976995
curr_Factors:  [102.78669328]
mat_Sqrt:  [[0.15]]
grads:  [0.24334869]
Stock Position:  0.24334869460325723
Bond Position:  [-21.34785937]


portfolio before change:  [3.7689539]
curr_Stock_Price:  103.21874784351849
curr_Factors:  [103.21874784]
mat_Sqrt:  [[0.15]]
grads:  [0.03834696]
Stock Position:  0.03834695714077533
Bond Position:  [-0.189171]


portfolio before change:  [3.78575458]
curr_Stock_Price:  103.65717920417872
curr_Factors:  [103.6571792]
mat_Sqrt:  [[0.15]]
grads:  [-0.03972771]
Stock Position:  -0.039727707295905475
Bond Position:  [7.90381666]


portfolio before change:  [3.7943067]
curr_Stock_Price:  103.45434560073971
curr_Factors:  [103.4543456]
mat_Sqrt:  [[0.15]]
grads:  [-0.04450799]
Stock Position:  -0.0445079867480199
Bond Position:  [8.39885134]


portfolio before change:  [3.78292257]
curr_Stock_Price:  103.72191724613644
curr_Factors:  [103.72191725]
mat_Sqrt:  [[0.15]]
grads:  [-0.0293113]
Stock Position:  -0.029311299148719567
Bond Position:  [6.82314671]


portfolio before change:  [3.77400253]
curr_Stock_Price:  104.04078738201578
curr_Factors:  [104.04078738]
mat_Sqrt:  [[0.15]]
grads:  [-0.02599949]
Stock Position:  -0.02599949422213068
Bond Position:  [6.47901038]


portfolio before change:  [3.77155353]
curr_Stock_Price:  104.15055699083007
curr_Factors:  [104.15055699]
mat_Sqrt:  [[0.15]]
grads:  [0.00827581]
Stock Position:  0.008275805874919252
Bond Position:  [2.90962374]


portfolio before change:  [3.76984813]
curr_Stock_Price:  103.92251253141205
curr_Factors:  [103.92251253]
mat_Sqrt:  [[0.15]]
grads:  [0.02774635]
Stock Position:  0.0277463548907651
Bond Position:  [0.88637722]


portfolio before change:  [3.7750562]
curr_Stock_Price:  104.1082186485808
curr_Factors:  [104.10821865]
mat_Sqrt:  [[0.15]]
grads:  [-0.04828283]
Stock Position:  -0.04828283436712655
Bond Position:  [8.80169608]


portfolio before change:  [3.74959761]
curr_Stock_Price:  104.64689282359632
curr_Factors:  [104.64689282]
mat_Sqrt:  [[0.15]]
grads:  [-0.3511922]
Stock Position:  -0.35119219893675047
Bond Position:  [40.50077001]


portfolio before change:  [3.90815683]
curr_Stock_Price:  104.20261232684834
curr_Factors:  [104.20261233]
mat_Sqrt:  [[0.15]]
grads:  [-0.0258635]
Stock Position:  -0.025863501284516227
Bond Position:  [6.60320123]


portfolio before change:  [3.89766878]
curr_Stock_Price:  104.62408505327859
curr_Factors:  [104.62408505]
mat_Sqrt:  [[0.15]]
grads:  [0.10875344]
Stock Position:  0.10875343884250452
Bond Position:  [-7.48056025]


portfolio before change:  [3.92110769]
curr_Stock_Price:  104.84390756011352
curr_Factors:  [104.84390756]
mat_Sqrt:  [[0.15]]
grads:  [-0.09980699]
Stock Position:  -0.09980698717410527
Bond Position:  [14.38526222]


portfolio before change:  [3.94161986]
curr_Stock_Price:  104.64739762540553
curr_Factors:  [104.64739763]
mat_Sqrt:  [[0.15]]
grads:  [-0.02722981]
Stock Position:  -0.027229812043038915
Bond Position:  [6.79114883]


portfolio before change:  [3.92711506]
curr_Stock_Price:  105.19566633872411
curr_Factors:  [105.19566634]
mat_Sqrt:  [[0.15]]
grads:  [0.01925171]
Stock Position:  0.019251710726710336
Bond Position:  [1.90191853]


portfolio before change:  [3.92438994]
curr_Stock_Price:  105.04793916032148
curr_Factors:  [105.04793916]
mat_Sqrt:  [[0.15]]
grads:  [-0.09050239]
Stock Position:  -0.09050239078647596
Bond Position:  [13.43147958]


portfolio before change:  [3.99370913]
curr_Stock_Price:  104.29127742032276
curr_Factors:  [104.29127742]
mat_Sqrt:  [[0.15]]
grads:  [0.06992678]
Stock Position:  0.06992677751773145
Bond Position:  [-3.29904383]


portfolio before change:  [3.99579383]
curr_Stock_Price:  104.32403881028553
curr_Factors:  [104.32403881]
mat_Sqrt:  [[0.15]]
grads:  [0.10598744]
Stock Position:  0.10598744280539796
Bond Position:  [-7.06124427]


portfolio before change:  [4.02800687]
curr_Stock_Price:  104.63213557341831
curr_Factors:  [104.63213557]
mat_Sqrt:  [[0.15]]
grads:  [-0.07880413]
Stock Position:  -0.07880412666314063
Bond Position:  [12.27345094]


portfolio before change:  [4.04181762]
curr_Stock_Price:  104.46661596485072
curr_Factors:  [104.46661596]
mat_Sqrt:  [[0.15]]
grads:  [-0.02713734]
Stock Position:  -0.02713733744456877
Bond Position:  [6.87676343]


portfolio before change:  [4.03938915]
curr_Stock_Price:  104.57194255984727
curr_Factors:  [104.57194256]
mat_Sqrt:  [[0.15]]
grads:  [0.02319934]
Stock Position:  0.023199344977340306
Bond Position:  [1.61338858]


portfolio before change:  [4.04651545]
curr_Stock_Price:  104.8747727179552
curr_Factors:  [104.87477272]
mat_Sqrt:  [[0.15]]
grads:  [0.0202238]
Stock Position:  0.02022379560617425
Bond Position:  [1.92554948]


portfolio before change:  [4.04606303]
curr_Stock_Price:  104.84645129771238
curr_Factors:  [104.8464513]
mat_Sqrt:  [[0.15]]
grads:  [-0.0116841]
Stock Position:  -0.011684097397911519
Bond Position:  [5.27109918]


portfolio before change:  [4.04912125]
curr_Stock_Price:  104.61290637537057
curr_Factors:  [104.61290638]
mat_Sqrt:  [[0.15]]
grads:  [-0.05534099]
Stock Position:  -0.0553409892628346
Bond Position:  [9.83850297]


portfolio before change:  [4.10979959]
curr_Stock_Price:  103.52757311799036
curr_Factors:  [103.52757312]
mat_Sqrt:  [[0.15]]
grads:  [0.06506878]
Stock Position:  0.06506877593765473
Bond Position:  [-2.62661287]


portfolio before change:  [4.07857074]
curr_Stock_Price:  103.05016009704258
curr_Factors:  [103.0501601]
mat_Sqrt:  [[0.15]]
grads:  [-0.02891404]
Stock Position:  -0.028914041778481583
Bond Position:  [7.05816737]


portfolio before change:  [4.08896985]
curr_Stock_Price:  102.70576115959491
curr_Factors:  [102.70576116]
mat_Sqrt:  [[0.15]]
grads:  [-0.08363189]
Stock Position:  -0.08363188831871782
Bond Position:  [12.6784466]


portfolio before change:  [4.07047405]
curr_Stock_Price:  102.93639360288995
curr_Factors:  [102.9363936]
mat_Sqrt:  [[0.15]]
grads:  [0.0979568]
Stock Position:  0.09795680039491889
Bond Position:  [-6.01284571]


portfolio before change:  [4.06362934]
curr_Stock_Price:  102.87035527655539
curr_Factors:  [102.87035528]
mat_Sqrt:  [[0.15]]
grads:  [0.01630743]
Stock Position:  0.016307427541491355
Bond Position:  [2.38607847]


portfolio before change:  [4.07555753]
curr_Stock_Price:  103.59266791819033
curr_Factors:  [103.59266792]
mat_Sqrt:  [[0.15]]
grads:  [0.08341236]
Stock Position:  0.08341235937792423
Bond Position:  [-4.56535131]


portfolio before change:  [3.99680557]
curr_Stock_Price:  102.65196058484595
curr_Factors:  [102.65196058]
mat_Sqrt:  [[0.15]]
grads:  [-0.09905585]
Stock Position:  -0.09905584516841014
Bond Position:  [14.16508228]


portfolio before change:  [3.9305304]
curr_Stock_Price:  103.32996716234496
curr_Factors:  [103.32996716]
mat_Sqrt:  [[0.15]]
grads:  [-0.08497643]
Stock Position:  -0.08497643107585573
Bond Position:  [12.71114223]


portfolio before change:  [3.93502166]
curr_Stock_Price:  103.28646344170701
curr_Factors:  [103.28646344]
mat_Sqrt:  [[0.15]]
grads:  [-0.02159229]
Stock Position:  -0.021592285436107653
Bond Position:  [6.16521246]


portfolio before change:  [3.94280107]
curr_Stock_Price:  102.94402325122583
curr_Factors:  [102.94402325]
mat_Sqrt:  [[0.15]]
grads:  [-0.08230514]
Stock Position:  -0.08230514434059788
Bond Position:  [12.41562376]


portfolio before change:  [3.98214868]
curr_Stock_Price:  102.47538167246165
curr_Factors:  [102.47538167]
mat_Sqrt:  [[0.15]]
grads:  [-0.04560797]
Stock Position:  -0.0456079714361119
Bond Position:  [8.65584296]


portfolio before change:  [3.98816844]
curr_Stock_Price:  102.35525450706359
curr_Factors:  [102.35525451]
mat_Sqrt:  [[0.15]]
grads:  [0.19786792]
Stock Position:  0.19786792210647708
Bond Position:  [-16.26465308]


portfolio before change:  [4.04211477]
curr_Stock_Price:  102.63303020877464
curr_Factors:  [102.63303021]
mat_Sqrt:  [[0.15]]
grads:  [0.01644663]
Stock Position:  0.01644662768084304
Bond Position:  [2.35414754]


portfolio before change:  [4.04864232]
curr_Stock_Price:  103.02097619294996
curr_Factors:  [103.02097619]
mat_Sqrt:  [[0.15]]
grads:  [0.05349957]
Stock Position:  0.05349957327861176
Bond Position:  [-1.46293595]


portfolio before change:  [4.03343403]
curr_Stock_Price:  102.73841610181486
curr_Factors:  [102.7384161]
mat_Sqrt:  [[0.15]]
grads:  [-0.10861338]
Stock Position:  -0.1086133819153583
Bond Position:  [15.19220086]


portfolio before change:  [3.99579994]
curr_Stock_Price:  103.09365447519743
curr_Factors:  [103.09365448]
mat_Sqrt:  [[0.15]]
grads:  [-0.05163584]
Stock Position:  -0.051635843304457016
Bond Position:  [9.31912772]


portfolio before change:  [3.96530178]
curr_Stock_Price:  103.69557388052934
curr_Factors:  [103.69557388]
mat_Sqrt:  [[0.15]]
grads:  [-0.04862941]
Stock Position:  -0.04862940873915608
Bond Position:  [9.00795623]


portfolio before change:  [3.96867834]
curr_Stock_Price:  103.63771700742069
curr_Factors:  [103.63771701]
mat_Sqrt:  [[0.15]]
grads:  [0.03310996]
Stock Position:  0.0331099622606899
Bond Position:  [0.53723744]


portfolio before change:  [3.9872231]
curr_Stock_Price:  104.19679877813178
curr_Factors:  [104.19679878]
mat_Sqrt:  [[0.15]]
grads:  [0.04581611]
Stock Position:  0.04581611136037926
Bond Position:  [-0.78666904]


portfolio before change:  [3.99715003]
curr_Stock_Price:  104.41454097305592
curr_Factors:  [104.41454097]
mat_Sqrt:  [[0.15]]
grads:  [-0.00426958]
Stock Position:  -0.004269578946094593
Bond Position:  [4.44295616]


portfolio before change:  [3.99834193]
curr_Stock_Price:  104.20041913357949
curr_Factors:  [104.20041913]
mat_Sqrt:  [[0.15]]
grads:  [-0.031564]
Stock Position:  -0.03156399612892561
Bond Position:  [7.28732356]


portfolio before change:  [3.98511116]
curr_Stock_Price:  104.63402232926543
curr_Factors:  [104.63402233]
mat_Sqrt:  [[0.15]]
grads:  [0.05631016]
Stock Position:  0.05631015859886909
Bond Position:  [-1.90684724]


portfolio before change:  [3.96678905]
curr_Stock_Price:  104.31076043565074
curr_Factors:  [104.31076044]
mat_Sqrt:  [[0.15]]
grads:  [-0.02539878]
Stock Position:  -0.02539878208563308
Bond Position:  [6.61615532]


portfolio before change:  [3.98630839]
curr_Stock_Price:  103.55852659923725
curr_Factors:  [103.5585266]
mat_Sqrt:  [[0.15]]
grads:  [0.16591523]
Stock Position:  0.1659152298960476
Bond Position:  [-13.19562836]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.98630839]
Stock Price:  103.93660921769859
PL:  [0.04969917]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.38310615e-02]
 [-6.28314654e-04]
 [ 1.12254949e-03]
 [ 2.30165806e-03]
 [ 1.62815316e-02]
 [ 1.14938106e-02]
 [ 4.69634742e-04]
 [ 9.64010305e-03]
 [ 1.65385178e-02]
 [-1.46679789e-02]
 [ 8.25196741e-03]
 [-1.23249291e-02]
 [ 1.02006476e-02]
 [ 6.64011246e-03]
 [-2.48316816e-02]
 [ 1.84461757e-02]
 [-3.22977293e-03]
 [-1.98952687e-03]
 [-2.45690009e-02]
 [ 1.45102345e-02]
 [-4.36459200e-02]
 [-2.62787936e-02]
 [-4.14990619e-04]
 [ 8.03907685e-03]
 [-4.25923076e-03]
 [ 1.71542336e-02]
 [ 1.77148669e-02]
 [ 3.95027530e-02]
 [ 2.45611577e-04]
 [ 9.45414263e-03]
 [-3.42157239e-03]
 [-2.40872062e-02]
 [ 1.92994121e-02]
 [ 9.66147953e-03]
 [-2.30873929e-02]
 [ 8.23161577e-03]
 [-2.87701550e-04]
 [-1.25523178e-02]
 [ 8.72164254e-03]
 [-2.10077567e-02]
 [ 5.36115171e-02]
 [ 2.47899182e-03]
 [ 9.71846199e-03]
 [-9.61735076e-03]
 [-4.12610930e-03]
 [-2.08435923e-02]
 [-1.28783944e-02]
 [ 3.34599175e-03]
 [-3.34432129e-03]
 [-2.29369102e-02]
 [-4.81371542e-03]
 [ 2.83752195e-03]
 [ 4.34585449e-03]
 [-2.22365963e-03]
 [ 2.39780327e-02]
 [ 9.03898199e-03]
 [-1.13036797e-03]
 [ 1.84515471e-02]
 [ 1.26966352e-02]
 [-9.68281601e-03]
 [-1.12645114e-02]
 [-4.01975563e-02]
 [-1.30208515e-02]
 [-5.14078185e-03]
 [ 1.39930625e-03]
 [ 7.98087430e-02]
 [ 8.62053507e-03]
 [ 1.64056667e-03]
 [ 1.72103431e-02]
 [-1.91356994e-02]
 [ 3.23644428e-02]
 [-4.27646077e-02]
 [-9.31603740e-03]
 [ 8.16619899e-03]
 [-1.51991466e-02]
 [ 4.48284050e-03]
 [ 2.34262926e-02]
 [-1.78730255e-02]
 [-5.71842898e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.47473661]
curr_Stock_Price:  99.9619703548859
curr_Factors:  [99.96197035]
mat_Sqrt:  [[0.15]]
grads:  [-0.22554041]
Stock Position:  -0.2255404100536762
Bond Position:  [24.02020039]


portfolio before change:  [1.31660331]
curr_Stock_Price:  100.66975751701678
curr_Factors:  [100.66975752]
mat_Sqrt:  [[0.15]]
grads:  [-0.00418876]
Stock Position:  -0.004188764358545209
Bond Position:  [1.7382852]


portfolio before change:  [1.3162076]
curr_Stock_Price:  100.79016375746889
curr_Factors:  [100.79016376]
mat_Sqrt:  [[0.15]]
grads:  [0.00748366]
Stock Position:  0.007483663250536817
Bond Position:  [0.56192796]


portfolio before change:  [1.31450807]
curr_Stock_Price:  100.55837150031414
curr_Factors:  [100.5583715]
mat_Sqrt:  [[0.15]]
grads:  [0.01534439]
Stock Position:  0.015344387072957487
Bond Position:  [-0.22849851]


portfolio before change:  [1.30797446]
curr_Stock_Price:  100.13350408576981
curr_Factors:  [100.13350409]
mat_Sqrt:  [[0.15]]
grads:  [0.10854354]
Stock Position:  0.10854354418086457
Bond Position:  [-9.56087097]


portfolio before change:  [1.2566576]
curr_Stock_Price:  99.66623276325265
curr_Factors:  [99.66623276]
mat_Sqrt:  [[0.15]]
grads:  [0.0766254]
Stock Position:  0.07662540424885353
Bond Position:  [-6.38030778]


portfolio before change:  [1.21170002]
curr_Stock_Price:  99.0847181272102
curr_Factors:  [99.08471813]
mat_Sqrt:  [[0.15]]
grads:  [0.0031309]
Stock Position:  0.0031308982832829323
Bond Position:  [0.90147585]


portfolio before change:  [1.21009422]
curr_Stock_Price:  98.55383162863099
curr_Factors:  [98.55383163]
mat_Sqrt:  [[0.15]]
grads:  [0.06426735]
Stock Position:  0.06426735364951658
Bond Position:  [-5.12369974]


portfolio before change:  [1.23689727]
curr_Stock_Price:  98.97587014188419
curr_Factors:  [98.97587014]
mat_Sqrt:  [[0.15]]
grads:  [0.11025679]
Stock Position:  0.110256785499704
Bond Position:  [-9.67586401]


portfolio before change:  [1.22364803]
curr_Stock_Price:  98.86118799454952
curr_Factors:  [98.86118799]
mat_Sqrt:  [[0.15]]
grads:  [-0.09778653]
Stock Position:  -0.0977865262608426
Bond Position:  [10.89094018]


portfolio before change:  [1.31381811]
curr_Stock_Price:  97.94603757898311
curr_Factors:  [97.94603758]
mat_Sqrt:  [[0.15]]
grads:  [0.05501312]
Stock Position:  0.055013116098526764
Bond Position:  [-4.07449862]


portfolio before change:  [1.25657991]
curr_Stock_Price:  96.91022026304657
curr_Factors:  [96.91022026]
mat_Sqrt:  [[0.15]]
grads:  [-0.08216619]
Stock Position:  -0.08216619397804752
Bond Position:  [9.21932387]


portfolio before change:  [1.2286822]
curr_Stock_Price:  97.2567610199659
curr_Factors:  [97.25676102]
mat_Sqrt:  [[0.15]]
grads:  [0.06800432]
Stock Position:  0.0680043172026202
Bond Position:  [-5.38519743]


portfolio before change:  [1.2336962]
curr_Stock_Price:  97.33544105285922
curr_Factors:  [97.33544105]
mat_Sqrt:  [[0.15]]
grads:  [0.04426742]
Stock Position:  0.04426741641959268
Bond Position:  [-3.0750923]


portfolio before change:  [1.23868086]
curr_Stock_Price:  97.4523862713598
curr_Factors:  [97.45238627]
mat_Sqrt:  [[0.15]]
grads:  [-0.16554454]
Stock Position:  -0.16554454390206652
Bond Position:  [17.3713917]


portfolio before change:  [1.30374465]
curr_Stock_Price:  97.06591600858397
curr_Factors:  [97.06591601]
mat_Sqrt:  [[0.15]]
grads:  [0.1229745]
Stock Position:  0.12297450477408783
Bond Position:  [-10.6328883]


portfolio before change:  [1.38767967]
curr_Stock_Price:  97.7538601626942
curr_Factors:  [97.75386016]
mat_Sqrt:  [[0.15]]
grads:  [-0.02153182]
Stock Position:  -0.021531819523327365
Bond Position:  [3.49249814]


portfolio before change:  [1.38985533]
curr_Stock_Price:  97.66295385576679
curr_Factors:  [97.66295386]
mat_Sqrt:  [[0.15]]
grads:  [-0.01326351]
Stock Position:  -0.013263512437490996
Bond Position:  [2.68520913]


portfolio before change:  [1.40228841]
curr_Stock_Price:  96.73821753218412
curr_Factors:  [96.73821753]
mat_Sqrt:  [[0.15]]
grads:  [-0.16379334]
Stock Position:  -0.16379333905257382
Bond Position:  [17.24736408]


portfolio before change:  [1.33415291]
curr_Stock_Price:  97.16078353597285
curr_Factors:  [97.16078354]
mat_Sqrt:  [[0.15]]
grads:  [0.0967349]
Stock Position:  0.09673489648490924
Bond Position:  [-8.06468543]


portfolio before change:  [1.30625854]
curr_Stock_Price:  96.87763530131792
curr_Factors:  [96.8776353]
mat_Sqrt:  [[0.15]]
grads:  [-0.2909728]
Stock Position:  -0.29097280009222176
Bond Position:  [29.49501535]


portfolio before change:  [1.23196917]
curr_Stock_Price:  97.13928471297909
curr_Factors:  [97.13928471]
mat_Sqrt:  [[0.15]]
grads:  [-0.17519196]
Stock Position:  -0.17519195718519118
Bond Position:  [18.24999058]


portfolio before change:  [1.11250623]
curr_Stock_Price:  97.82769302459214
curr_Factors:  [97.82769302]
mat_Sqrt:  [[0.15]]
grads:  [-0.0027666]
Stock Position:  -0.002766604125818076
Bond Position:  [1.38315673]


portfolio before change:  [1.11253319]
curr_Stock_Price:  97.84919547869416
curr_Factors:  [97.84919548]
mat_Sqrt:  [[0.15]]
grads:  [0.05359385]
Stock Position:  0.0535938456802641
Bond Position:  [-4.13158149]


portfolio before change:  [1.05668658]
curr_Stock_Price:  96.81197979603873
curr_Factors:  [96.8119798]
mat_Sqrt:  [[0.15]]
grads:  [-0.02839487]
Stock Position:  -0.02839487173747936
Bond Position:  [3.80565033]


portfolio before change:  [1.06751104]
curr_Stock_Price:  96.43914511834389
curr_Factors:  [96.43914512]
mat_Sqrt:  [[0.15]]
grads:  [0.11436156]
Stock Position:  0.1143615570989144
Bond Position:  [-9.96141976]


portfolio before change:  [1.06155679]
curr_Stock_Price:  96.39252422871675
curr_Factors:  [96.39252423]
mat_Sqrt:  [[0.15]]
grads:  [0.11809911]
Stock Position:  0.11809911249246914
Bond Position:  [-10.32231477]


portfolio before change:  [1.02021436]
curr_Stock_Price:  96.04792158772
curr_Factors:  [96.04792159]
mat_Sqrt:  [[0.15]]
grads:  [0.26335169]
Stock Position:  0.26335168654966684
Bond Position:  [-24.27416778]


portfolio before change:  [1.08593922]
curr_Stock_Price:  96.30325333192619
curr_Factors:  [96.30325333]
mat_Sqrt:  [[0.15]]
grads:  [0.00163741]
Stock Position:  0.0016374105101100685
Bond Position:  [0.92825126]


portfolio before change:  [1.0851089]
curr_Stock_Price:  95.76072393340509
curr_Factors:  [95.76072393]
mat_Sqrt:  [[0.15]]
grads:  [0.06302762]
Stock Position:  0.0630276175095381
Bond Position:  [-4.95046138]


portfolio before change:  [1.14712965]
curr_Stock_Price:  96.74965818858833
curr_Factors:  [96.74965819]
mat_Sqrt:  [[0.15]]
grads:  [-0.02281048]
Stock Position:  -0.022810482580543908
Bond Position:  [3.35403605]


portfolio before change:  [1.14362332]
curr_Stock_Price:  96.91256448617774
curr_Factors:  [96.91256449]
mat_Sqrt:  [[0.15]]
grads:  [-0.16058137]
Stock Position:  -0.1605813746500502
Bond Position:  [16.70597614]


portfolio before change:  [1.07022929]
curr_Stock_Price:  97.3761187798166
curr_Factors:  [97.37611878]
mat_Sqrt:  [[0.15]]
grads:  [0.12866275]
Stock Position:  0.12866274706852085
Bond Position:  [-11.45844965]


portfolio before change:  [1.05362158]
curr_Stock_Price:  97.25260571181697
curr_Factors:  [97.25260571]
mat_Sqrt:  [[0.15]]
grads:  [0.06440986]
Stock Position:  0.06440986352877212
Bond Position:  [-5.21040548]


portfolio before change:  [1.05638253]
curr_Stock_Price:  97.30052707644714
curr_Factors:  [97.30052708]
mat_Sqrt:  [[0.15]]
grads:  [-0.15391595]
Stock Position:  -0.15391595260427485
Bond Position:  [16.03248584]


portfolio before change:  [1.2246515]
curr_Stock_Price:  96.21378521968134
curr_Factors:  [96.21378522]
mat_Sqrt:  [[0.15]]
grads:  [0.05487744]
Stock Position:  0.05487743847429336
Bond Position:  [-4.05531458]


portfolio before change:  [1.18951505]
curr_Stock_Price:  95.578132736018
curr_Factors:  [95.57813274]
mat_Sqrt:  [[0.15]]
grads:  [-0.00191801]
Stock Position:  -0.0019180103337118847
Bond Position:  [1.3728349]


portfolio before change:  [1.1906729]
curr_Stock_Price:  95.01919852430444
curr_Factors:  [95.01919852]
mat_Sqrt:  [[0.15]]
grads:  [-0.08368212]
Stock Position:  -0.08368211844067461
Bond Position:  [9.14208073]


portfolio before change:  [1.18215861]
curr_Stock_Price:  95.12777237466136
curr_Factors:  [95.12777237]
mat_Sqrt:  [[0.15]]
grads:  [0.05814428]
Stock Position:  0.0581442835860901
Bond Position:  [-4.34897757]


portfolio before change:  [1.15257879]
curr_Stock_Price:  94.6237159576622
curr_Factors:  [94.62371596]
mat_Sqrt:  [[0.15]]
grads:  [-0.14005171]
Stock Position:  -0.14005171109705397
Bond Position:  [14.40479212]


portfolio before change:  [1.1036498]
curr_Stock_Price:  94.97950825121198
curr_Factors:  [94.97950825]
mat_Sqrt:  [[0.15]]
grads:  [0.35741011]
Stock Position:  0.357410113996808
Bond Position:  [-32.84298707]


portfolio before change:  [1.22215928]
curr_Stock_Price:  95.31683007612394
curr_Factors:  [95.31683008]
mat_Sqrt:  [[0.15]]
grads:  [0.01652661]
Stock Position:  0.016526612138715487
Bond Position:  [-0.353105]


portfolio before change:  [1.22018059]
curr_Stock_Price:  95.1984383025529
curr_Factors:  [95.1984383]
mat_Sqrt:  [[0.15]]
grads:  [0.06478975]
Stock Position:  0.06478974660971452
Bond Position:  [-4.9477021]


portfolio before change:  [1.21755524]
curr_Stock_Price:  95.16269013692764
curr_Factors:  [95.16269014]
mat_Sqrt:  [[0.15]]
grads:  [-0.06411567]
Stock Position:  -0.06411567170952592
Bond Position:  [7.31897504]


portfolio before change:  [1.26081478]
curr_Stock_Price:  94.49511400343013
curr_Factors:  [94.495114]
mat_Sqrt:  [[0.15]]
grads:  [-0.0275074]
Stock Position:  -0.027507395317031315
Bond Position:  [3.86012924]


portfolio before change:  [1.27869275]
curr_Stock_Price:  93.85395173754205
curr_Factors:  [93.85395174]
mat_Sqrt:  [[0.15]]
grads:  [-0.13895728]
Stock Position:  -0.1389572820318208
Bond Position:  [14.32038279]


portfolio before change:  [1.36426469]
curr_Stock_Price:  93.24457819844058
curr_Factors:  [93.2445782]
mat_Sqrt:  [[0.15]]
grads:  [-0.08585596]
Stock Position:  -0.08585596292005722
Bond Position:  [9.36986774]


portfolio before change:  [1.40793919]
curr_Stock_Price:  92.7427043343792
curr_Factors:  [92.74270433]
mat_Sqrt:  [[0.15]]
grads:  [0.02230661]
Stock Position:  0.02230661167740405
Bond Position:  [-0.6608363]


portfolio before change:  [1.39987932]
curr_Stock_Price:  92.38323375002747
curr_Factors:  [92.38323375]
mat_Sqrt:  [[0.15]]
grads:  [-0.02229548]
Stock Position:  -0.02229547526870302
Bond Position:  [3.45960742]


portfolio before change:  [1.40642675]
curr_Stock_Price:  92.09926558278816
curr_Factors:  [92.09926558]
mat_Sqrt:  [[0.15]]
grads:  [-0.15291273]
Stock Position:  -0.15291273476271505
Bond Position:  [15.48957732]


portfolio before change:  [1.32642493]
curr_Stock_Price:  92.62878295152052
curr_Factors:  [92.62878295]
mat_Sqrt:  [[0.15]]
grads:  [-0.03209144]
Stock Position:  -0.03209143614639305
Bond Position:  [4.29901561]


portfolio before change:  [1.31624864]
curr_Stock_Price:  92.9542590668569
curr_Factors:  [92.95425907]
mat_Sqrt:  [[0.15]]
grads:  [0.01891681]
Stock Position:  0.01891681299689225
Bond Position:  [-0.4421497]


portfolio before change:  [1.31438701]
curr_Stock_Price:  92.85730893105932
curr_Factors:  [92.85730893]
mat_Sqrt:  [[0.15]]
grads:  [0.02897236]
Stock Position:  0.028972363291356152
Bond Position:  [-1.37590868]


portfolio before change:  [1.34451631]
curr_Stock_Price:  93.90020940455189
curr_Factors:  [93.9002094]
mat_Sqrt:  [[0.15]]
grads:  [-0.0148244]
Stock Position:  -0.014824397543262263
Bond Position:  [2.73653034]


portfolio before change:  [1.35590387]
curr_Stock_Price:  93.14358367719049
curr_Factors:  [93.14358368]
mat_Sqrt:  [[0.15]]
grads:  [0.15985355]
Stock Position:  0.15985355140175017
Bond Position:  [-13.53342877]


portfolio before change:  [1.38932879]
curr_Stock_Price:  93.35797232196462
curr_Factors:  [93.35797232]
mat_Sqrt:  [[0.15]]
grads:  [0.06025988]
Stock Position:  0.06025987996297541
Bond Position:  [-4.23641142]


portfolio before change:  [1.40073331]
curr_Stock_Price:  93.55162209145091
curr_Factors:  [93.55162209]
mat_Sqrt:  [[0.15]]
grads:  [-0.00753579]
Stock Position:  -0.007535786452285215
Bond Position:  [2.10571836]


portfolio before change:  [1.4105522]
curr_Stock_Price:  92.26611975758027
curr_Factors:  [92.26611976]
mat_Sqrt:  [[0.15]]
grads:  [0.12301031]
Stock Position:  0.12301031382999184
Bond Position:  [-9.93913215]


portfolio before change:  [1.45983937]
curr_Stock_Price:  92.67184497282278
curr_Factors:  [92.67184497]
mat_Sqrt:  [[0.15]]
grads:  [0.08464423]
Stock Position:  0.08464423450833204
Bond Position:  [-6.38429801]


portfolio before change:  [1.5121913]
curr_Stock_Price:  93.2950529133812
curr_Factors:  [93.29505291]
mat_Sqrt:  [[0.15]]
grads:  [-0.06455211]
Stock Position:  -0.06455210672898624
Bond Position:  [7.53458351]


portfolio before change:  [1.53056102]
curr_Stock_Price:  93.01777622061856
curr_Factors:  [93.01777622]
mat_Sqrt:  [[0.15]]
grads:  [-0.07509674]
Stock Position:  -0.07509674287964506
Bond Position:  [8.51589304]


portfolio before change:  [1.57485888]
curr_Stock_Price:  92.43498658368317
curr_Factors:  [92.43498658]
mat_Sqrt:  [[0.15]]
grads:  [-0.26798371]
Stock Position:  -0.26798370837871116
Bond Position:  [26.34592937]


portfolio before change:  [1.45941939]
curr_Stock_Price:  92.87190182380478
curr_Factors:  [92.87190182]
mat_Sqrt:  [[0.15]]
grads:  [-0.08680568]
Stock Position:  -0.08680567675933719
Bond Position:  [9.52122768]


portfolio before change:  [1.51804468]
curr_Stock_Price:  92.20339484852056
curr_Factors:  [92.20339485]
mat_Sqrt:  [[0.15]]
grads:  [-0.03427188]
Stock Position:  -0.034271878980588956
Bond Position:  [4.67802827]


portfolio before change:  [1.54346816]
curr_Stock_Price:  91.47010872444827
curr_Factors:  [91.47010872]
mat_Sqrt:  [[0.15]]
grads:  [0.00932871]
Stock Position:  0.00932870832170082
Bond Position:  [0.6901702]


portfolio before change:  [1.54800677]
curr_Stock_Price:  91.9520050475815
curr_Factors:  [91.95200505]
mat_Sqrt:  [[0.15]]
grads:  [0.53205829]
Stock Position:  0.532058286407192
Bond Position:  [-47.37581947]


portfolio before change:  [1.86575874]
curr_Stock_Price:  92.55478309268327
curr_Factors:  [92.55478309]
mat_Sqrt:  [[0.15]]
grads:  [0.05747023]
Stock Position:  0.05747023383302385
Bond Position:  [-3.45338629]


portfolio before change:  [1.82876973]
curr_Stock_Price:  91.91491842784576
curr_Factors:  [91.91491843]
mat_Sqrt:  [[0.15]]
grads:  [0.01093711]
Stock Position:  0.01093711115420897
Bond Position:  [0.82348605]


portfolio before change:  [1.83001785]
curr_Stock_Price:  92.02433067877547
curr_Factors:  [92.02433068]
mat_Sqrt:  [[0.15]]
grads:  [0.11473562]
Stock Position:  0.114735620561422
Bond Position:  [-8.72845084]


portfolio before change:  [1.79217647]
curr_Stock_Price:  91.6992718257606
curr_Factors:  [91.69927183]
mat_Sqrt:  [[0.15]]
grads:  [-0.12757133]
Stock Position:  -0.1275713296217347
Bond Position:  [13.49037451]


portfolio before change:  [1.76231892]
curr_Stock_Price:  91.9399271905484
curr_Factors:  [91.93992719]
mat_Sqrt:  [[0.15]]
grads:  [0.21576295]
Stock Position:  0.2157629516773009
Bond Position:  [-18.07491114]


portfolio before change:  [1.71747723]
curr_Stock_Price:  91.73733459928789
curr_Factors:  [91.7373346]
mat_Sqrt:  [[0.15]]
grads:  [-0.28509738]
Stock Position:  -0.28509738478889834
Bond Position:  [27.87155141]


portfolio before change:  [1.72108302]
curr_Stock_Price:  91.73079731561066
curr_Factors:  [91.73079732]
mat_Sqrt:  [[0.15]]
grads:  [-0.06210692]
Stock Position:  -0.0621069160014279
Bond Position:  [7.41819994]


portfolio before change:  [1.73858422]
curr_Stock_Price:  91.4564712935686
curr_Factors:  [91.45647129]
mat_Sqrt:  [[0.15]]
grads:  [0.05444133]
Stock Position:  0.05444132662153116
Bond Position:  [-3.24042741]


portfolio before change:  [1.75285401]
curr_Stock_Price:  91.72230480916515
curr_Factors:  [91.72230481]
mat_Sqrt:  [[0.15]]
grads:  [-0.10132764]
Stock Position:  -0.10132764418650027
Bond Position:  [11.04685908]


portfolio before change:  [1.76174218]
curr_Stock_Price:  91.64140176873605
curr_Factors:  [91.64140177]
mat_Sqrt:  [[0.15]]
grads:  [0.0298856]
Stock Position:  0.029885603303867535
Bond Position:  [-0.9770164]


portfolio before change:  [1.77131172]
curr_Stock_Price:  91.9636508690645
curr_Factors:  [91.96365087]
mat_Sqrt:  [[0.15]]
grads:  [0.15617528]
Stock Position:  0.15617528397423228
Bond Position:  [-12.59113757]


portfolio before change:  [1.83792614]
curr_Stock_Price:  92.39522612659765
curr_Factors:  [92.39522613]
mat_Sqrt:  [[0.15]]
grads:  [-0.1191535]
Stock Position:  -0.11915350348471121
Bond Position:  [12.84714104]


portfolio before change:  [1.7984506]
curr_Stock_Price:  92.73326491284251
curr_Factors:  [92.73326491]
mat_Sqrt:  [[0.15]]
grads:  [-0.3812286]
Stock Position:  -0.38122859836901135
Bond Position:  [37.15102321]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.7984506]
Stock Price:  92.20227212398018
PL:  [1.7984506]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.42703567e-02]
 [-2.38308720e-04]
 [ 2.15251580e-04]
 [ 2.47248453e-03]
 [ 6.28575975e-03]
 [ 1.22506983e-02]
 [ 3.98040208e-04]
 [ 1.00061588e-02]
 [ 1.00340792e-02]
 [-1.82290830e-02]
 [ 8.93090904e-03]
 [-5.49211661e-03]
 [-3.92715708e-03]
 [ 4.30085706e-03]
 [-9.40755023e-04]
 [-2.87713439e-03]
 [ 1.48470799e-02]
 [ 1.74262187e-02]
 [ 2.29058342e-02]
 [ 2.89743438e-03]
 [ 8.02911033e-02]
 [-1.52150788e-02]
 [-2.20195380e-03]
 [ 1.38796457e-02]
 [ 6.46855793e-03]
 [ 9.50183301e-03]
 [ 1.31415653e-02]
 [-2.20494550e-02]
 [ 1.15151376e-03]
 [-2.47967328e-03]
 [-3.72309003e-03]
 [-2.05584929e-02]
 [ 1.69939389e-02]
 [ 1.31363379e-02]
 [-2.02856100e-02]
 [ 7.72470820e-03]
 [-2.48517643e-03]
 [ 1.89176074e-03]
 [ 5.46561169e-03]
 [-1.63095733e-02]
 [ 4.06937257e-02]
 [-1.28873878e-04]
 [ 6.40963804e-03]
 [-9.17697308e-03]
 [-1.59930226e-03]
 [-1.01464839e-02]
 [-1.33473668e-02]
 [ 9.14420091e-04]
 [-2.65118578e-03]
 [-5.05109026e-03]
 [-3.82962301e-03]
 [ 2.98280196e-03]
 [ 3.48493796e-03]
 [-3.88314961e-04]
 [ 7.73937160e-03]
 [ 8.89813525e-03]
 [ 4.24126399e-03]
 [ 1.32896989e-02]
 [ 1.30452802e-02]
 [-9.32851903e-03]
 [-9.65993756e-03]
 [-3.32334201e-02]
 [-1.29230777e-02]
 [-3.22975629e-03]
 [-6.09315085e-03]
 [ 3.29676108e-02]
 [ 8.42542910e-03]
 [ 1.68234605e-03]
 [ 1.65299127e-02]
 [-1.92757525e-02]
 [ 3.29110714e-02]
 [-4.78496737e-02]
 [-9.17636598e-03]
 [ 8.23250824e-03]
 [-1.70752842e-02]
 [ 4.57377153e-03]
 [ 2.36589403e-02]
 [-1.82527824e-02]
 [-6.11348156e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.05480341]
curr_Stock_Price:  99.86366580929071
curr_Factors:  [99.86366581]
mat_Sqrt:  [[0.15]]
grads:  [-0.22846904]
Stock Position:  -0.2284690446601249
Bond Position:  [22.76095292]


portfolio before change:  [-0.0256985]
curr_Stock_Price:  99.74250145428779
curr_Factors:  [99.74250145]
mat_Sqrt:  [[0.15]]
grads:  [-0.00158872]
Stock Position:  -0.00158872479777585
Bond Position:  [0.13276489]


portfolio before change:  [-0.02625007]
curr_Stock_Price:  100.0949043122876
curr_Factors:  [100.09490431]
mat_Sqrt:  [[0.15]]
grads:  [0.00143501]
Stock Position:  0.00143501053103071
Bond Position:  [-0.16988731]


portfolio before change:  [-0.02510119]
curr_Stock_Price:  100.90291193398451
curr_Factors:  [100.90291193]
mat_Sqrt:  [[0.15]]
grads:  [0.01648323]
Stock Position:  0.01648323020130118
Bond Position:  [-1.68830712]


portfolio before change:  [-0.01884955]
curr_Stock_Price:  101.28858681850663
curr_Factors:  [101.28858682]
mat_Sqrt:  [[0.15]]
grads:  [0.04190507]
Stock Position:  0.04190506502094189
Bond Position:  [-4.26335436]


portfolio before change:  [0.01050441]
curr_Stock_Price:  101.99543278699441
curr_Factors:  [101.99543279]
mat_Sqrt:  [[0.15]]
grads:  [0.08167132]
Stock Position:  0.0816713223281182
Bond Position:  [-8.31959745]


portfolio before change:  [-0.06525696]
curr_Stock_Price:  101.07416227702645
curr_Factors:  [101.07416228]
mat_Sqrt:  [[0.15]]
grads:  [0.0026536]
Stock Position:  0.002653601386910217
Bond Position:  [-0.3334675]


portfolio before change:  [-0.06803758]
curr_Stock_Price:  100.03414904100258
curr_Factors:  [100.03414904]
mat_Sqrt:  [[0.15]]
grads:  [0.06670773]
Stock Position:  0.06670772541296753
Bond Position:  [-6.74108813]


portfolio before change:  [-0.05764332]
curr_Stock_Price:  100.19628304475614
curr_Factors:  [100.19628304]
mat_Sqrt:  [[0.15]]
grads:  [0.06689386]
Stock Position:  0.06689386121889887
Bond Position:  [-6.76015958]


portfolio before change:  [-0.06625045]
curr_Stock_Price:  100.07393098487218
curr_Factors:  [100.07393098]
mat_Sqrt:  [[0.15]]
grads:  [-0.12152722]
Stock Position:  -0.12152722031236694
Bond Position:  [12.09545621]


portfolio before change:  [-0.0530284]
curr_Stock_Price:  99.97135265113508
curr_Factors:  [99.97135265]
mat_Sqrt:  [[0.15]]
grads:  [0.05953939]
Stock Position:  0.059539393578290196
Bond Position:  [-6.00526211]


portfolio before change:  [-0.03051929]
curr_Stock_Price:  100.35571068848964
curr_Factors:  [100.35571069]
mat_Sqrt:  [[0.15]]
grads:  [-0.03661411]
Stock Position:  -0.036614110766296226
Bond Position:  [3.64391581]


portfolio before change:  [-0.03233821]
curr_Stock_Price:  100.41160914637211
curr_Factors:  [100.41160915]
mat_Sqrt:  [[0.15]]
grads:  [-0.02618105]
Stock Position:  -0.026181047180616666
Bond Position:  [2.59654286]


portfolio before change:  [-0.0180236]
curr_Stock_Price:  99.87105294292745
curr_Factors:  [99.87105294]
mat_Sqrt:  [[0.15]]
grads:  [0.02867238]
Stock Position:  0.028672380429251895
Bond Position:  [-2.88156442]


portfolio before change:  [-0.04508952]
curr_Stock_Price:  98.93336240794775
curr_Factors:  [98.93336241]
mat_Sqrt:  [[0.15]]
grads:  [-0.0062717]
Stock Position:  -0.0062717001552208
Bond Position:  [0.57539086]


portfolio before change:  [-0.05324825]
curr_Stock_Price:  100.23997638419875
curr_Factors:  [100.23997638]
mat_Sqrt:  [[0.15]]
grads:  [-0.0191809]
Stock Position:  -0.01918089590446653
Bond Position:  [1.8694443]


portfolio before change:  [-0.06488905]
curr_Stock_Price:  100.85296376655666
curr_Factors:  [100.85296377]
mat_Sqrt:  [[0.15]]
grads:  [0.09898053]
Stock Position:  0.09898053248573557
Bond Position:  [-10.04736911]


portfolio before change:  [-0.06053844]
curr_Stock_Price:  100.90326246060906
curr_Factors:  [100.90326246]
mat_Sqrt:  [[0.15]]
grads:  [0.11617479]
Stock Position:  0.11617479113385801
Bond Position:  [-11.78295388]


portfolio before change:  [-0.10663987]
curr_Stock_Price:  100.51277354238638
curr_Factors:  [100.51277354]
mat_Sqrt:  [[0.15]]
grads:  [0.15270556]
Stock Position:  0.15270556118602688
Bond Position:  [-15.45549936]


portfolio before change:  [-0.11402973]
curr_Stock_Price:  100.47070653195718
curr_Factors:  [100.47070653]
mat_Sqrt:  [[0.15]]
grads:  [0.01931623]
Stock Position:  0.019316229183870853
Bond Position:  [-2.05474493]


portfolio before change:  [-0.11365556]
curr_Stock_Price:  100.49672586952589
curr_Factors:  [100.49672587]
mat_Sqrt:  [[0.15]]
grads:  [0.53527402]
Stock Position:  0.535274021922205
Bond Position:  [-53.90694221]


portfolio before change:  [-0.54471006]
curr_Stock_Price:  99.69772350304744
curr_Factors:  [99.6977235]
mat_Sqrt:  [[0.15]]
grads:  [-0.10143386]
Stock Position:  -0.10143385872281362
Bond Position:  [9.56801474]


portfolio before change:  [-0.53740523]
curr_Stock_Price:  99.63160340305083
curr_Factors:  [99.6316034]
mat_Sqrt:  [[0.15]]
grads:  [-0.01467969]
Stock Position:  -0.014679691978268983
Bond Position:  [0.92515602]


portfolio before change:  [-0.53355772]
curr_Stock_Price:  99.37344505107248
curr_Factors:  [99.37344505]
mat_Sqrt:  [[0.15]]
grads:  [0.09253097]
Stock Position:  0.0925309711941747
Bond Position:  [-9.7286791]


portfolio before change:  [-0.58583239]
curr_Stock_Price:  98.81507408338246
curr_Factors:  [98.81507408]
mat_Sqrt:  [[0.15]]
grads:  [0.04312372]
Stock Position:  0.04312371950260655
Bond Position:  [-4.84710592]


portfolio before change:  [-0.60710609]
curr_Stock_Price:  98.32878134981216
curr_Factors:  [98.32878135]
mat_Sqrt:  [[0.15]]
grads:  [0.06334555]
Stock Position:  0.06334555342160034
Bond Position:  [-6.83579716]


portfolio before change:  [-0.59051138]
curr_Stock_Price:  98.59749725288307
curr_Factors:  [98.59749725]
mat_Sqrt:  [[0.15]]
grads:  [0.08761044]
Stock Position:  0.0876104350652219
Bond Position:  [-9.22868101]


portfolio before change:  [-0.6288771]
curr_Stock_Price:  98.16616841081483
curr_Factors:  [98.16616841]
mat_Sqrt:  [[0.15]]
grads:  [-0.14699637]
Stock Position:  -0.1469963663563632
Bond Position:  [13.80119295]


portfolio before change:  [-0.55320122]
curr_Stock_Price:  97.65722197411502
curr_Factors:  [97.65722197]
mat_Sqrt:  [[0.15]]
grads:  [0.00767676]
Stock Position:  0.007676758406821367
Bond Position:  [-1.30289212]


portfolio before change:  [-0.55451964]
curr_Stock_Price:  97.49608903194773
curr_Factors:  [97.49608903]
mat_Sqrt:  [[0.15]]
grads:  [-0.01653116]
Stock Position:  -0.016531155193214644
Bond Position:  [1.05720334]


portfolio before change:  [-0.57344129]
curr_Stock_Price:  98.64469215292786
curr_Factors:  [98.64469215]
mat_Sqrt:  [[0.15]]
grads:  [-0.0248206]
Stock Position:  -0.024820600220731702
Bond Position:  [1.87497917]


portfolio before change:  [-0.57908134]
curr_Stock_Price:  98.87664594385126
curr_Factors:  [98.87664594]
mat_Sqrt:  [[0.15]]
grads:  [-0.13705662]
Stock Position:  -0.13705661924361165
Bond Position:  [12.97261748]


portfolio before change:  [-0.48491177]
curr_Stock_Price:  98.19547670027394
curr_Factors:  [98.1954767]
mat_Sqrt:  [[0.15]]
grads:  [0.11329293]
Stock Position:  0.11329292628262405
Bond Position:  [-11.60976467]


portfolio before change:  [-0.50624543]
curr_Stock_Price:  98.01357627665841
curr_Factors:  [98.01357628]
mat_Sqrt:  [[0.15]]
grads:  [0.08757559]
Stock Position:  0.08757558619836436
Bond Position:  [-9.08984183]


portfolio before change:  [-0.53230625]
curr_Stock_Price:  97.72248282577185
curr_Factors:  [97.72248283]
mat_Sqrt:  [[0.15]]
grads:  [-0.1352374]
Stock Position:  -0.1352373999189073
Bond Position:  [12.68342824]


portfolio before change:  [-0.51969642]
curr_Stock_Price:  97.63510253722804
curr_Factors:  [97.63510254]
mat_Sqrt:  [[0.15]]
grads:  [0.05149805]
Stock Position:  0.05149805464496067
Bond Position:  [-5.54771427]


portfolio before change:  [-0.48637222]
curr_Stock_Price:  98.28893203881039
curr_Factors:  [98.28893204]
mat_Sqrt:  [[0.15]]
grads:  [-0.01656784]
Stock Position:  -0.01656784284253783
Bond Position:  [1.14206336]


portfolio before change:  [-0.47039918]
curr_Stock_Price:  97.32914119920062
curr_Factors:  [97.3291412]
mat_Sqrt:  [[0.15]]
grads:  [0.01261174]
Stock Position:  0.01261173826995162
Bond Position:  [-1.69788883]


portfolio before change:  [-0.4750133]
curr_Stock_Price:  96.9716961036836
curr_Factors:  [96.9716961]
mat_Sqrt:  [[0.15]]
grads:  [0.03643741]
Stock Position:  0.036437411279135606
Bond Position:  [-4.00841087]


portfolio before change:  [-0.47310646]
curr_Stock_Price:  97.03090371747001
curr_Factors:  [97.03090372]
mat_Sqrt:  [[0.15]]
grads:  [-0.10873049]
Stock Position:  -0.10873048882448574
Bond Position:  [10.07711113]


portfolio before change:  [-0.50540654]
curr_Stock_Price:  97.33376190956669
curr_Factors:  [97.33376191]
mat_Sqrt:  [[0.15]]
grads:  [0.2712915]
Stock Position:  0.2712915043900171
Bond Position:  [-26.91122924]


portfolio before change:  [-0.51496579]
curr_Stock_Price:  97.30472583796055
curr_Factors:  [97.30472584]
mat_Sqrt:  [[0.15]]
grads:  [-0.00085916]
Stock Position:  -0.0008591591883217361
Bond Position:  [-0.43136554]


portfolio before change:  [-0.51453031]
curr_Stock_Price:  96.76647921024036
curr_Factors:  [96.76647921]
mat_Sqrt:  [[0.15]]
grads:  [0.04273092]
Stock Position:  0.04273092025871494
Bond Position:  [-4.64945101]


portfolio before change:  [-0.51868083]
curr_Stock_Price:  96.67614821281956
curr_Factors:  [96.67614821]
mat_Sqrt:  [[0.15]]
grads:  [-0.06117982]
Stock Position:  -0.0611798205613824
Bond Position:  [5.39594857]


portfolio before change:  [-0.47714265]
curr_Stock_Price:  96.00270843166516
curr_Factors:  [96.00270843]
mat_Sqrt:  [[0.15]]
grads:  [-0.01066202]
Stock Position:  -0.010662015076790645
Bond Position:  [0.54643967]


portfolio before change:  [-0.48154313]
curr_Stock_Price:  96.41863617641148
curr_Factors:  [96.41863618]
mat_Sqrt:  [[0.15]]
grads:  [-0.06764323]
Stock Position:  -0.06764322589005725
Bond Position:  [6.04052446]


portfolio before change:  [-0.46907615]
curr_Stock_Price:  96.2399126783636
curr_Factors:  [96.23991268]
mat_Sqrt:  [[0.15]]
grads:  [-0.08898245]
Stock Position:  -0.08898244508879853
Bond Position:  [8.0945866]


portfolio before change:  [-0.41436599]
curr_Stock_Price:  95.63075624044727
curr_Factors:  [95.63075624]
mat_Sqrt:  [[0.15]]
grads:  [0.00609613]
Stock Position:  0.006096133939805376
Bond Position:  [-0.99734389]


portfolio before change:  [-0.41280623]
curr_Stock_Price:  95.89684253361693
curr_Factors:  [95.89684253]
mat_Sqrt:  [[0.15]]
grads:  [-0.01767457]
Stock Position:  -0.017674571879641027
Bond Position:  [1.28212941]


portfolio before change:  [-0.4126415]
curr_Stock_Price:  95.89205616102436
curr_Factors:  [95.89205616]
mat_Sqrt:  [[0.15]]
grads:  [-0.03367394]
Stock Position:  -0.03367393509041582
Bond Position:  [2.81642138]


portfolio before change:  [-0.43234896]
curr_Stock_Price:  96.48252755246862
curr_Factors:  [96.48252755]
mat_Sqrt:  [[0.15]]
grads:  [-0.02553082]
Stock Position:  -0.025530820094963772
Bond Position:  [2.03092909]


portfolio before change:  [-0.44910221]
curr_Stock_Price:  97.1436965269081
curr_Factors:  [97.14369653]
mat_Sqrt:  [[0.15]]
grads:  [0.01988535]
Stock Position:  0.019885346380286797
Bond Position:  [-2.38083826]


portfolio before change:  [-0.45888037]
curr_Stock_Price:  96.65945269463563
curr_Factors:  [96.65945269]
mat_Sqrt:  [[0.15]]
grads:  [0.02323292]
Stock Position:  0.023232919759081344
Bond Position:  [-2.70456168]


portfolio before change:  [-0.47395382]
curr_Stock_Price:  96.01793141892823
curr_Factors:  [96.01793142]
mat_Sqrt:  [[0.15]]
grads:  [-0.00258877]
Stock Position:  -0.002588766408077959
Bond Position:  [-0.22538583]


portfolio before change:  [-0.47430788]
curr_Stock_Price:  96.1492543403305
curr_Factors:  [96.14925434]
mat_Sqrt:  [[0.15]]
grads:  [0.05159581]
Stock Position:  0.05159581067800608
Bond Position:  [-5.4352066]


portfolio before change:  [-0.51255347]
curr_Stock_Price:  95.41458464681442
curr_Factors:  [95.41458465]
mat_Sqrt:  [[0.15]]
grads:  [0.0593209]
Stock Position:  0.05932090169409601
Bond Position:  [-6.17263266]


portfolio before change:  [-0.51467513]
curr_Stock_Price:  95.3853224828577
curr_Factors:  [95.38532248]
mat_Sqrt:  [[0.15]]
grads:  [0.02827509]
Stock Position:  0.02827509329998921
Bond Position:  [-3.21170402]


portfolio before change:  [-0.54041965]
curr_Stock_Price:  94.48192003904715
curr_Factors:  [94.48192004]
mat_Sqrt:  [[0.15]]
grads:  [0.08859799]
Stock Position:  0.08859799293018589
Bond Position:  [-8.91132814]


portfolio before change:  [-0.54320875]
curr_Stock_Price:  94.456726261514
curr_Factors:  [94.45672626]
mat_Sqrt:  [[0.15]]
grads:  [0.08696853]
Stock Position:  0.08696853465346886
Bond Position:  [-8.75797182]


portfolio before change:  [-0.63195625]
curr_Stock_Price:  93.44256499360709
curr_Factors:  [93.44256499]
mat_Sqrt:  [[0.15]]
grads:  [-0.06219013]
Stock Position:  -0.062190126846431576
Bond Position:  [5.17924872]


portfolio before change:  [-0.63893954]
curr_Stock_Price:  93.5600595714976
curr_Factors:  [93.56005957]
mat_Sqrt:  [[0.15]]
grads:  [-0.06439958]
Stock Position:  -0.06439958375124291
Bond Position:  [5.38628935]


portfolio before change:  [-0.65580001]
curr_Stock_Price:  93.8270972967291
curr_Factors:  [93.8270973]
mat_Sqrt:  [[0.15]]
grads:  [-0.22155613]
Stock Position:  -0.22155613400956328
Bond Position:  [20.13216893]


portfolio before change:  [-0.79253545]
curr_Stock_Price:  94.44993600398605
curr_Factors:  [94.449936]
mat_Sqrt:  [[0.15]]
grads:  [-0.08615385]
Stock Position:  -0.08615385140792366
Bond Position:  [7.34469031]


portfolio before change:  [-0.81189053]
curr_Stock_Price:  94.67992158125811
curr_Factors:  [94.67992158]
mat_Sqrt:  [[0.15]]
grads:  [-0.02153171]
Stock Position:  -0.021531708569458786
Bond Position:  [1.22672995]


portfolio before change:  [-0.80763635]
curr_Stock_Price:  94.48590503867901
curr_Factors:  [94.48590504]
mat_Sqrt:  [[0.15]]
grads:  [-0.04062101]
Stock Position:  -0.04062100568370775
Bond Position:  [3.03047614]


portfolio before change:  [-0.80683342]
curr_Stock_Price:  94.47080149764335
curr_Factors:  [94.4708015]
mat_Sqrt:  [[0.15]]
grads:  [0.21978407]
Stock Position:  0.21978407226293023
Bond Position:  [-21.57001088]


portfolio before change:  [-0.94708065]
curr_Stock_Price:  93.83882183672122
curr_Factors:  [93.83882184]
mat_Sqrt:  [[0.15]]
grads:  [0.05616953]
Stock Position:  0.05616952733955727
Bond Position:  [-6.21796292]


portfolio before change:  [-0.98339224]
curr_Stock_Price:  93.19927665374534
curr_Factors:  [93.19927665]
mat_Sqrt:  [[0.15]]
grads:  [0.01121564]
Stock Position:  0.011215640321832289
Bond Position:  [-2.0286818]


portfolio before change:  [-0.98832533]
curr_Stock_Price:  92.77074146453192
curr_Factors:  [92.77074146]
mat_Sqrt:  [[0.15]]
grads:  [0.11019942]
Stock Position:  0.11019941768527489
Bond Position:  [-11.21160702]


portfolio before change:  [-1.05061928]
curr_Stock_Price:  92.21181653226782
curr_Factors:  [92.21181653]
mat_Sqrt:  [[0.15]]
grads:  [-0.12850502]
Stock Position:  -0.12850501640044296
Bond Position:  [10.79906172]


portfolio before change:  [-0.99886213]
curr_Stock_Price:  91.81430530084614
curr_Factors:  [91.8143053]
mat_Sqrt:  [[0.15]]
grads:  [0.21940714]
Stock Position:  0.21940714270895237
Bond Position:  [-21.14357651]


portfolio before change:  [-1.12491997]
curr_Stock_Price:  91.2457899506739
curr_Factors:  [91.24578995]
mat_Sqrt:  [[0.15]]
grads:  [-0.31899782]
Stock Position:  -0.3189978249896283
Bond Position:  [27.98228856]


portfolio before change:  [-1.30603353]
curr_Stock_Price:  91.81903056684433
curr_Factors:  [91.81903057]
mat_Sqrt:  [[0.15]]
grads:  [-0.06117577]
Stock Position:  -0.06117577317555049
Bond Position:  [4.31106665]


portfolio before change:  [-1.23568957]
curr_Stock_Price:  90.67356876029508
curr_Factors:  [90.67356876]
mat_Sqrt:  [[0.15]]
grads:  [0.05488339]
Stock Position:  0.054883388262767244
Bond Position:  [-6.21216225]


portfolio before change:  [-1.21603794]
curr_Stock_Price:  91.0387048391596
curr_Factors:  [91.03870484]
mat_Sqrt:  [[0.15]]
grads:  [-0.11383523]
Stock Position:  -0.11383522795212174
Bond Position:  [9.14737378]


portfolio before change:  [-1.25413344]
curr_Stock_Price:  91.37838204284128
curr_Factors:  [91.37838204]
mat_Sqrt:  [[0.15]]
grads:  [0.03049181]
Stock Position:  0.030491810206906122
Bond Position:  [-4.04042572]


portfolio before change:  [-1.24235893]
curr_Stock_Price:  91.77281737759144
curr_Factors:  [91.77281738]
mat_Sqrt:  [[0.15]]
grads:  [0.15772627]
Stock Position:  0.15772626865111736
Bond Position:  [-15.71734298]


portfolio before change:  [-1.18109595]
curr_Stock_Price:  92.16745895485177
curr_Factors:  [92.16745895]
mat_Sqrt:  [[0.15]]
grads:  [-0.12168522]
Stock Position:  -0.12168521614868004
Bond Position:  [10.03432121]


portfolio before change:  [-1.12810478]
curr_Stock_Price:  91.7371354864009
curr_Factors:  [91.73713549]
mat_Sqrt:  [[0.15]]
grads:  [-0.40756544]
Stock Position:  -0.4075654372870851
Bond Position:  [36.26078096]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.12810478]
Stock Price:  91.95303752784308
PL:  [-1.12810478]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-6.36739325e-02]
 [-2.27714777e-03]
 [ 2.13789631e-04]
 [ 2.34415602e-03]
 [ 6.04733066e-03]
 [ 1.18073007e-02]
 [ 1.15706943e-03]
 [ 9.81937228e-03]
 [-9.18793679e-04]
 [-2.02482313e-02]
 [ 1.01780100e-02]
 [-8.14733239e-03]
 [ 4.27169536e-03]
 [ 4.27730291e-03]
 [ 5.41433402e-03]
 [ 2.21798761e-03]
 [ 1.08750170e-02]
 [ 8.78659929e-03]
 [ 2.15585469e-02]
 [ 1.13472872e-03]
 [ 7.78174135e-02]
 [-1.32180024e-02]
 [ 2.27106066e-03]
 [ 4.12212150e-03]
 [ 1.40755535e-02]
 [-3.89144334e-03]
 [ 1.26631870e-02]
 [ 1.29419898e-03]
 [ 2.34940176e-03]
 [-2.52480792e-02]
 [-4.44157014e-03]
 [-6.32217947e-03]
 [ 1.55038848e-02]
 [ 1.86031795e-02]
 [-1.61666142e-02]
 [ 6.72628222e-03]
 [-2.65300768e-03]
 [ 5.01134226e-03]
 [ 3.35965915e-03]
 [-1.56268106e-02]
 [ 4.09534911e-02]
 [-9.84004959e-04]
 [ 4.21015379e-03]
 [-8.11508753e-03]
 [ 2.19317975e-03]
 [-3.16697527e-03]
 [-1.36937272e-02]
 [-1.28781350e-03]
 [-9.55461778e-03]
 [ 1.06871606e-02]
 [-3.03801718e-03]
 [ 3.64625580e-03]
 [ 2.68040115e-04]
 [-8.81659318e-04]
 [ 2.33968921e-03]
 [ 8.60163805e-03]
 [-2.53898093e-03]
 [-2.09560912e-02]
 [ 1.34434943e-02]
 [ 6.56486626e-03]
 [ 7.34098704e-03]
 [-1.26337493e-02]
 [-1.25404406e-02]
 [-1.95614196e-03]
 [-1.23942382e-02]
 [ 4.25623527e-02]
 [ 1.77425521e-02]
 [ 2.16730173e-03]
 [ 6.16144602e-03]
 [-1.44763462e-02]
 [-8.16638437e-03]
 [-7.32253504e-03]
 [ 1.63434852e-03]
 [ 7.27185498e-03]
 [-9.62778600e-04]
 [-6.39020335e-03]
 [ 7.09578479e-03]
 [-4.01006615e-03]
 [ 2.34015288e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.32967066]
curr_Stock_Price:  100.59535346690251
curr_Factors:  [100.59535347]
mat_Sqrt:  [[0.15]]
grads:  [-0.42449288]
Stock Position:  -0.42449288345407005
Bond Position:  [54.03168232]


portfolio before change:  [11.52464877]
curr_Stock_Price:  100.14398896259067
curr_Factors:  [100.14398896]
mat_Sqrt:  [[0.15]]
grads:  [-0.01518099]
Stock Position:  -0.015180985113392177
Bond Position:  [13.04493317]


portfolio before change:  [11.52191547]
curr_Stock_Price:  100.3777439905607
curr_Factors:  [100.37774399]
mat_Sqrt:  [[0.15]]
grads:  [0.00142526]
Stock Position:  0.0014252642035965726
Bond Position:  [11.37885066]


portfolio before change:  [11.52312888]
curr_Stock_Price:  100.73010780554976
curr_Factors:  [100.73010781]
mat_Sqrt:  [[0.15]]
grads:  [0.01562771]
Stock Position:  0.01562770680018618
Bond Position:  [9.94894829]


portfolio before change:  [11.523165]
curr_Stock_Price:  100.69262885283486
curr_Factors:  [100.69262885]
mat_Sqrt:  [[0.15]]
grads:  [0.04031554]
Stock Position:  0.040315537746810265
Bond Position:  [7.46368752]


portfolio before change:  [11.51722952]
curr_Stock_Price:  100.53383212645548
curr_Factors:  [100.53383213]
mat_Sqrt:  [[0.15]]
grads:  [0.07871534]
Stock Position:  0.07871533812369447
Bond Position:  [3.60367493]


portfolio before change:  [11.50867028]
curr_Stock_Price:  100.4222341453572
curr_Factors:  [100.42223415]
mat_Sqrt:  [[0.15]]
grads:  [0.0077138]
Stock Position:  0.0077137962279378155
Bond Position:  [10.73403363]


portfolio before change:  [11.51079457]
curr_Stock_Price:  100.6106489742948
curr_Factors:  [100.61064897]
mat_Sqrt:  [[0.15]]
grads:  [0.06546248]
Stock Position:  0.06546248187545281
Bond Position:  [4.92457179]


portfolio before change:  [11.52086261]
curr_Stock_Price:  100.75974572328539
curr_Factors:  [100.75974572]
mat_Sqrt:  [[0.15]]
grads:  [-0.00612529]
Stock Position:  -0.006125291190966029
Bond Position:  [12.1380454]


portfolio before change:  [11.52328366]
curr_Stock_Price:  100.48834781883538
curr_Factors:  [100.48834782]
mat_Sqrt:  [[0.15]]
grads:  [-0.13498821]
Stock Position:  -0.13498820892574723
Bond Position:  [25.08802575]


portfolio before change:  [11.54700323]
curr_Stock_Price:  100.32424809423688
curr_Factors:  [100.32424809]
mat_Sqrt:  [[0.15]]
grads:  [0.0678534]
Stock Position:  0.0678534002219479
Bond Position:  [4.73966188]


portfolio before change:  [11.61965124]
curr_Stock_Price:  101.39054345524794
curr_Factors:  [101.39054346]
mat_Sqrt:  [[0.15]]
grads:  [-0.05431555]
Stock Position:  -0.05431554928983953
Bond Position:  [17.1267343]


portfolio before change:  [11.65022664]
curr_Stock_Price:  100.8473297923004
curr_Factors:  [100.84732979]
mat_Sqrt:  [[0.15]]
grads:  [0.02847797]
Stock Position:  0.02847796903744876
Bond Position:  [8.77829951]


portfolio before change:  [11.63248354]
curr_Stock_Price:  100.20501711941144
curr_Factors:  [100.20501712]
mat_Sqrt:  [[0.15]]
grads:  [0.02851535]
Stock Position:  0.02851535276583675
Bond Position:  [8.77510213]


portfolio before change:  [11.6296292]
curr_Stock_Price:  100.08568493584697
curr_Factors:  [100.08568494]
mat_Sqrt:  [[0.15]]
grads:  [0.03609556]
Stock Position:  0.036095560131532214
Bond Position:  [8.01698034]


portfolio before change:  [11.6187385]
curr_Stock_Price:  99.77008422206886
curr_Factors:  [99.77008422]
mat_Sqrt:  [[0.15]]
grads:  [0.01478658]
Stock Position:  0.014786584034064514
Bond Position:  [10.14347976]


portfolio before change:  [11.62531469]
curr_Stock_Price:  100.17194862702092
curr_Factors:  [100.17194863]
mat_Sqrt:  [[0.15]]
grads:  [0.07250011]
Stock Position:  0.07250011350916559
Bond Position:  [4.36283704]


portfolio before change:  [11.59409192]
curr_Stock_Price:  99.73752927211184
curr_Factors:  [99.73752927]
mat_Sqrt:  [[0.15]]
grads:  [0.05857733]
Stock Position:  0.05857732860291299
Bond Position:  [5.75173389]


portfolio before change:  [11.61435886]
curr_Stock_Price:  100.07737825550394
curr_Factors:  [100.07737826]
mat_Sqrt:  [[0.15]]
grads:  [0.14372365]
Stock Position:  0.1437236456806471
Bond Position:  [-2.76912679]


portfolio before change:  [11.74920229]
curr_Stock_Price:  101.01679577887047
curr_Factors:  [101.01679578]
mat_Sqrt:  [[0.15]]
grads:  [0.00756486]
Stock Position:  0.0075648581651905035
Bond Position:  [10.98502456]


portfolio before change:  [11.74786298]
curr_Stock_Price:  100.74899230018528
curr_Factors:  [100.7489923]
mat_Sqrt:  [[0.15]]
grads:  [0.51878276]
Stock Position:  0.5187827569729142
Bond Position:  [-40.518977]


portfolio before change:  [11.65802319]
curr_Stock_Price:  100.5806997390265
curr_Factors:  [100.58069974]
mat_Sqrt:  [[0.15]]
grads:  [-0.08812002]
Stock Position:  -0.08812001615324681
Bond Position:  [20.52119608]


portfolio before change:  [11.64108331]
curr_Stock_Price:  100.78749154944096
curr_Factors:  [100.78749155]
mat_Sqrt:  [[0.15]]
grads:  [0.0151404]
Stock Position:  0.01514040440380599
Bond Position:  [10.11511993]


portfolio before change:  [11.64288241]
curr_Stock_Price:  100.86456251231364
curr_Factors:  [100.86456251]
mat_Sqrt:  [[0.15]]
grads:  [0.02748081]
Stock Position:  0.027480809972690902
Bond Position:  [8.87104253]


portfolio before change:  [11.63122978]
curr_Stock_Price:  100.4203584428331
curr_Factors:  [100.42035844]
mat_Sqrt:  [[0.15]]
grads:  [0.09383702]
Stock Position:  0.09383702340262061
Bond Position:  [2.20808225]


portfolio before change:  [11.65428408]
curr_Stock_Price:  100.66457222797814
curr_Factors:  [100.66457223]
mat_Sqrt:  [[0.15]]
grads:  [-0.02594296]
Stock Position:  -0.025942955577366866
Bond Position:  [14.26582061]


portfolio before change:  [11.64933449]
curr_Stock_Price:  100.88972896327621
curr_Factors:  [100.88972896]
mat_Sqrt:  [[0.15]]
grads:  [0.08442125]
Stock Position:  0.0844212465554614
Bond Position:  [3.13209781]


portfolio before change:  [11.59808319]
curr_Stock_Price:  100.2803199556537
curr_Factors:  [100.28031996]
mat_Sqrt:  [[0.15]]
grads:  [0.00862799]
Stock Position:  0.008627993207604458
Bond Position:  [10.73286527]


portfolio before change:  [11.58876049]
curr_Stock_Price:  99.12205305596693
curr_Factors:  [99.12205306]
mat_Sqrt:  [[0.15]]
grads:  [0.01566268]
Stock Position:  0.01566267840333949
Bond Position:  [10.03624365]


portfolio before change:  [11.60779321]
curr_Stock_Price:  100.29716722853405
curr_Factors:  [100.29716723]
mat_Sqrt:  [[0.15]]
grads:  [-0.16832053]
Stock Position:  -0.168320527837549
Bond Position:  [28.48986534]


portfolio before change:  [11.67119396]
curr_Stock_Price:  99.93107953048464
curr_Factors:  [99.93107953]
mat_Sqrt:  [[0.15]]
grads:  [-0.02961047]
Stock Position:  -0.02961046762492918
Bond Position:  [14.63019995]


portfolio before change:  [11.6828134]
curr_Stock_Price:  99.56955125970164
curr_Factors:  [99.56955126]
mat_Sqrt:  [[0.15]]
grads:  [-0.04214786]
Stock Position:  -0.0421478631567374
Bond Position:  [15.87945722]


portfolio before change:  [11.71589674]
curr_Stock_Price:  98.80816391548014
curr_Factors:  [98.80816392]
mat_Sqrt:  [[0.15]]
grads:  [0.10335923]
Stock Position:  0.10335923172030585
Bond Position:  [1.50316083]


portfolio before change:  [11.69308883]
curr_Stock_Price:  98.58658855151381
curr_Factors:  [98.58658855]
mat_Sqrt:  [[0.15]]
grads:  [0.1240212]
Stock Position:  0.12402119661345408
Bond Position:  [-0.53373785]


portfolio before change:  [11.67698407]
curr_Stock_Price:  98.45700263662862
curr_Factors:  [98.45700264]
mat_Sqrt:  [[0.15]]
grads:  [-0.10777743]
Stock Position:  -0.10777742781146699
Bond Position:  [22.28842657]


portfolio before change:  [11.69262044]
curr_Stock_Price:  98.32484789056512
curr_Factors:  [98.32484789]
mat_Sqrt:  [[0.15]]
grads:  [0.04484188]
Stock Position:  0.04484188148127572
Bond Position:  [7.28354927]


portfolio before change:  [11.67007818]
curr_Stock_Price:  97.81199028693827
curr_Factors:  [97.81199029]
mat_Sqrt:  [[0.15]]
grads:  [-0.01768672]
Stock Position:  -0.01768671787118907
Bond Position:  [13.40005126]


portfolio before change:  [11.67063194]
curr_Stock_Price:  97.82803453252991
curr_Factors:  [97.82803453]
mat_Sqrt:  [[0.15]]
grads:  [0.03340895]
Stock Position:  0.03340894838065553
Bond Position:  [8.40230018]


portfolio before change:  [11.6835217]
curr_Stock_Price:  98.1981330154049
curr_Factors:  [98.19813302]
mat_Sqrt:  [[0.15]]
grads:  [0.02239773]
Stock Position:  0.022397727693155088
Bond Position:  [9.48410666]


portfolio before change:  [11.66751865]
curr_Stock_Price:  97.45717260325053
curr_Factors:  [97.4571726]
mat_Sqrt:  [[0.15]]
grads:  [-0.10417874]
Stock Position:  -0.10417873725639955
Bond Position:  [21.82048382]


portfolio before change:  [11.68935806]
curr_Stock_Price:  97.26062973328169
curr_Factors:  [97.26062973]
mat_Sqrt:  [[0.15]]
grads:  [0.27302327]
Stock Position:  0.27302327372111884
Bond Position:  [-14.86505748]


portfolio before change:  [11.86993808]
curr_Stock_Price:  97.92544162150263
curr_Factors:  [97.92544162]
mat_Sqrt:  [[0.15]]
grads:  [-0.00656003]
Stock Position:  -0.006560033056995779
Bond Position:  [12.51233221]


portfolio before change:  [11.8696634]
curr_Stock_Price:  98.08652691855315
curr_Factors:  [98.08652692]
mat_Sqrt:  [[0.15]]
grads:  [0.02806769]
Stock Position:  0.028067691926619398
Bond Position:  [9.11660098]


portfolio before change:  [11.87208831]
curr_Stock_Price:  98.15262069863245
curr_Factors:  [98.1526207]
mat_Sqrt:  [[0.15]]
grads:  [-0.05410058]
Stock Position:  -0.05410058353325007
Bond Position:  [17.18220236]


portfolio before change:  [11.83424588]
curr_Stock_Price:  98.8719538709956
curr_Factors:  [98.87195387]
mat_Sqrt:  [[0.15]]
grads:  [0.0146212]
Stock Position:  0.014621198300450434
Bond Position:  [10.38861944]


portfolio before change:  [11.83691323]
curr_Stock_Price:  99.00997521217408
curr_Factors:  [99.00997521]
mat_Sqrt:  [[0.15]]
grads:  [-0.02111317]
Stock Position:  -0.021113168454480743
Bond Position:  [13.92732751]


portfolio before change:  [11.83186963]
curr_Stock_Price:  99.29008872342166
curr_Factors:  [99.29008872]
mat_Sqrt:  [[0.15]]
grads:  [-0.09129151]
Stock Position:  -0.09129151492215838
Bond Position:  [20.89621225]


portfolio before change:  [11.90114101]
curr_Stock_Price:  98.54560193076642
curr_Factors:  [98.54560193]
mat_Sqrt:  [[0.15]]
grads:  [-0.00858542]
Stock Position:  -0.00858542331138854
Bond Position:  [12.74719672]


portfolio before change:  [11.89317685]
curr_Stock_Price:  99.56603900118911
curr_Factors:  [99.566039]
mat_Sqrt:  [[0.15]]
grads:  [-0.06369745]
Stock Position:  -0.0636974518807744
Bond Position:  [18.23527983]


portfolio before change:  [11.90308034]
curr_Stock_Price:  99.42845500217331
curr_Factors:  [99.428455]
mat_Sqrt:  [[0.15]]
grads:  [0.07124774]
Stock Position:  0.07124773709310311
Bond Position:  [4.81902792]


portfolio before change:  [11.90678295]
curr_Stock_Price:  99.4761955295659
curr_Factors:  [99.47619553]
mat_Sqrt:  [[0.15]]
grads:  [-0.02025345]
Stock Position:  -0.020253447849551093
Bond Position:  [13.92151888]


portfolio before change:  [11.89863652]
curr_Stock_Price:  99.92138112402984
curr_Factors:  [99.92138112]
mat_Sqrt:  [[0.15]]
grads:  [0.02430837]
Stock Position:  0.02430837199043461
Bond Position:  [9.46971042]


portfolio before change:  [11.9213386]
curr_Stock_Price:  100.83095271755708
curr_Factors:  [100.83095272]
mat_Sqrt:  [[0.15]]
grads:  [0.00178693]
Stock Position:  0.0017869341001412915
Bond Position:  [11.74116034]


portfolio before change:  [11.92176556]
curr_Stock_Price:  100.65921294637249
curr_Factors:  [100.65921295]
mat_Sqrt:  [[0.15]]
grads:  [-0.00587773]
Stock Position:  -0.005877728789917154
Bond Position:  [12.51341312]


portfolio before change:  [11.92335172]
curr_Stock_Price:  100.5224171908947
curr_Factors:  [100.52241719]
mat_Sqrt:  [[0.15]]
grads:  [0.01559793]
Stock Position:  0.015597928058431828
Bond Position:  [10.35541029]


portfolio before change:  [11.92449592]
curr_Stock_Price:  100.55427801526919
curr_Factors:  [100.55427802]
mat_Sqrt:  [[0.15]]
grads:  [0.05734425]
Stock Position:  0.05734425365909243
Bond Position:  [6.15828589]


portfolio before change:  [11.94546515]
curr_Stock_Price:  100.91323856846019
curr_Factors:  [100.91323857]
mat_Sqrt:  [[0.15]]
grads:  [-0.01692654]
Stock Position:  -0.016926539502533762
Bond Position:  [13.65357707]


portfolio before change:  [11.95054276]
curr_Stock_Price:  100.66367543718705
curr_Factors:  [100.66367544]
mat_Sqrt:  [[0.15]]
grads:  [-0.13970727]
Stock Position:  -0.1397072749330891
Bond Position:  [26.01399054]


portfolio before change:  [11.88873801]
curr_Stock_Price:  101.11770105593693
curr_Factors:  [101.11770106]
mat_Sqrt:  [[0.15]]
grads:  [0.0896233]
Stock Position:  0.08962329539209507
Bond Position:  [2.82623642]


portfolio before change:  [11.887452]
curr_Stock_Price:  101.10138109375872
curr_Factors:  [101.10138109]
mat_Sqrt:  [[0.15]]
grads:  [0.04376578]
Stock Position:  0.043765775072913904
Bond Position:  [7.4626717]


portfolio before change:  [11.85010716]
curr_Stock_Price:  100.23743480035556
curr_Factors:  [100.2374348]
mat_Sqrt:  [[0.15]]
grads:  [0.04893991]
Stock Position:  0.048939913590503405
Bond Position:  [6.94449576]


portfolio before change:  [11.86264423]
curr_Stock_Price:  100.48473853893275
curr_Factors:  [100.48473854]
mat_Sqrt:  [[0.15]]
grads:  [-0.084225]
Stock Position:  -0.08422499504533354
Bond Position:  [20.32597083]


portfolio before change:  [11.91312159]
curr_Stock_Price:  99.90050635515898
curr_Factors:  [99.90050636]
mat_Sqrt:  [[0.15]]
grads:  [-0.08360294]
Stock Position:  -0.08360293741433035
Bond Position:  [20.26509737]


portfolio before change:  [11.95562869]
curr_Stock_Price:  99.40721640595041
curr_Factors:  [99.40721641]
mat_Sqrt:  [[0.15]]
grads:  [-0.01304095]
Stock Position:  -0.013040946402876773
Bond Position:  [13.25199287]


portfolio before change:  [11.95415441]
curr_Stock_Price:  99.5837794530788
curr_Factors:  [99.58377945]
mat_Sqrt:  [[0.15]]
grads:  [-0.08262825]
Stock Position:  -0.08262825487140807
Bond Position:  [20.18258832]


portfolio before change:  [11.91211084]
curr_Stock_Price:  100.10787403491321
curr_Factors:  [100.10787403]
mat_Sqrt:  [[0.15]]
grads:  [0.28374902]
Stock Position:  0.2837490177618029
Bond Position:  [-16.49340008]


portfolio before change:  [11.88346719]
curr_Stock_Price:  100.01055991258511
curr_Factors:  [100.01055991]
mat_Sqrt:  [[0.15]]
grads:  [0.11828368]
Stock Position:  0.11828368054354138
Bond Position:  [0.05385007]


portfolio before change:  [11.96644312]
curr_Stock_Price:  100.71203084542886
curr_Factors:  [100.71203085]
mat_Sqrt:  [[0.15]]
grads:  [0.01444868]
Stock Position:  0.014448678229129095
Bond Position:  [10.51128739]


portfolio before change:  [11.97053142]
curr_Stock_Price:  100.94951466804687
curr_Factors:  [100.94951467]
mat_Sqrt:  [[0.15]]
grads:  [0.04107631]
Stock Position:  0.041076306811194056
Bond Position:  [7.82389818]


portfolio before change:  [11.9613767]
curr_Stock_Price:  100.71473879979351
curr_Factors:  [100.7147388]
mat_Sqrt:  [[0.15]]
grads:  [-0.09650897]
Stock Position:  -0.09650897450505852
Bond Position:  [21.68125286]


portfolio before change:  [11.86756698]
curr_Stock_Price:  101.700811264596
curr_Factors:  [101.70081126]
mat_Sqrt:  [[0.15]]
grads:  [-0.05444256]
Stock Position:  -0.05444256247841745
Bond Position:  [17.40441975]


portfolio before change:  [11.86070186]
curr_Stock_Price:  101.84689067990459
curr_Factors:  [101.84689068]
mat_Sqrt:  [[0.15]]
grads:  [-0.0488169]
Stock Position:  -0.048816900262113945
Bond Position:  [16.83255136]


portfolio before change:  [11.83842681]
curr_Stock_Price:  102.32473974213384
curr_Factors:  [102.32473974]
mat_Sqrt:  [[0.15]]
grads:  [0.01089566]
Stock Position:  0.010895656774572923
Bond Position:  [10.72353157]


portfolio before change:  [11.849622]
curr_Stock_Price:  103.29071620713512
curr_Factors:  [103.29071621]
mat_Sqrt:  [[0.15]]
grads:  [0.04847903]
Stock Position:  0.04847903322919198
Bond Position:  [6.84218794]


portfolio before change:  [11.85758311]
curr_Stock_Price:  103.44611237130728
curr_Factors:  [103.44611237]
mat_Sqrt:  [[0.15]]
grads:  [-0.00641852]
Stock Position:  -0.0064185239976805785
Bond Position:  [12.52155446]


portfolio before change:  [11.85649185]
curr_Stock_Price:  103.73806095798675
curr_Factors:  [103.73806096]
mat_Sqrt:  [[0.15]]
grads:  [-0.04260136]
Stock Position:  -0.042601355640766114
Bond Position:  [16.27587388]


portfolio before change:  [11.87282411]
curr_Stock_Price:  103.37856566900349
curr_Factors:  [103.37856567]
mat_Sqrt:  [[0.15]]
grads:  [0.04730523]
Stock Position:  0.047305231958958485
Bond Position:  [6.98247708]


portfolio before change:  [11.8681694]
curr_Stock_Price:  103.27094273922567
curr_Factors:  [103.27094274]
mat_Sqrt:  [[0.15]]
grads:  [-0.02673377]
Stock Position:  -0.026733774364682793
Bond Position:  [14.62899148]


portfolio before change:  [11.87253306]
curr_Stock_Price:  103.14191813903318
curr_Factors:  [103.14191814]
mat_Sqrt:  [[0.15]]
grads:  [0.15601019]
Stock Position:  0.15601019179520087
Bond Position:  [-4.21865737]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.87253306]
Stock Price:  103.11336048907151
PL:  [8.75917257]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.57143184e-02]
 [-3.27934856e-04]
 [ 3.34470974e-04]
 [ 2.30889906e-03]
 [ 5.15937068e-03]
 [ 1.20018780e-02]
 [-1.27729139e-04]
 [ 6.49596295e-03]
 [-1.19892404e-02]
 [-1.22513049e-02]
 [ 1.01337328e-02]
 [-5.28972966e-03]
 [ 5.24726730e-03]
 [ 4.18607522e-03]
 [ 4.99867709e-03]
 [-1.01680207e-02]
 [ 8.80796338e-03]
 [ 2.43057341e-02]
 [ 1.91378030e-02]
 [ 3.45608241e-03]
 [ 7.96535218e-02]
 [-1.34474201e-02]
 [-2.87006759e-03]
 [ 1.13771352e-02]
 [ 1.37406338e-02]
 [-3.60892219e-03]
 [ 1.24175496e-02]
 [-6.85702085e-04]
 [ 3.06405463e-03]
 [-2.80334664e-02]
 [-5.04704107e-03]
 [ 1.27208487e-02]
 [ 1.31981537e-02]
 [ 1.63914959e-02]
 [-2.09714488e-03]
 [ 1.24590405e-03]
 [-2.18425455e-03]
 [ 1.14095667e-02]
 [ 2.39416588e-03]
 [-1.43242931e-02]
 [ 1.35996690e-02]
 [-1.67649565e-03]
 [ 4.46990453e-03]
 [-8.60067613e-03]
 [ 1.44856722e-03]
 [-3.45443930e-03]
 [-1.37116282e-02]
 [-1.70132830e-03]
 [-8.70916175e-03]
 [ 6.42449250e-03]
 [-3.35067423e-03]
 [ 3.26288312e-03]
 [ 2.78662249e-03]
 [-2.34174731e-04]
 [ 1.50244515e-03]
 [ 9.02102534e-03]
 [ 1.73151000e-02]
 [-2.31802793e-02]
 [ 1.38002072e-02]
 [ 4.31970566e-03]
 [ 5.00966294e-03]
 [-1.48433497e-02]
 [-1.25375065e-02]
 [-2.20638940e-03]
 [-1.22755056e-02]
 [ 1.34386384e-03]
 [ 1.03473769e-02]
 [ 2.00208965e-03]
 [ 9.25967392e-03]
 [-1.72496147e-02]
 [-2.59863480e-03]
 [ 1.84329433e-03]
 [-4.11515390e-04]
 [ 8.44555826e-03]
 [ 7.58147777e-03]
 [-5.02582312e-03]
 [-4.61340846e-03]
 [-8.76374647e-03]
 [-6.41250014e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.57831081]
curr_Stock_Price:  100.2899804351736
curr_Factors:  [100.28998044]
mat_Sqrt:  [[0.15]]
grads:  [-0.30476212]
Stock Position:  -0.3047621224586613
Bond Position:  [37.14289811]


portfolio before change:  [6.74360456]
curr_Stock_Price:  99.75522812747641
curr_Factors:  [99.75522813]
mat_Sqrt:  [[0.15]]
grads:  [-0.00218623]
Stock Position:  -0.0021862323749567442
Bond Position:  [6.96169267]


portfolio before change:  [6.74231529]
curr_Stock_Price:  100.54397782808336
curr_Factors:  [100.54397783]
mat_Sqrt:  [[0.15]]
grads:  [0.00222981]
Stock Position:  0.0022298064914098165
Bond Position:  [6.51812168]


portfolio before change:  [6.74282003]
curr_Stock_Price:  100.58763270754645
curr_Factors:  [100.58763271]
mat_Sqrt:  [[0.15]]
grads:  [0.01539266]
Stock Position:  0.015392660367530042
Bond Position:  [5.19450876]


portfolio before change:  [6.74969157]
curr_Stock_Price:  101.01295706036741
curr_Factors:  [101.01295706]
mat_Sqrt:  [[0.15]]
grads:  [0.0343958]
Stock Position:  0.034395804550144786
Bond Position:  [3.27526964]


portfolio before change:  [6.75547779]
curr_Stock_Price:  101.17522996116983
curr_Factors:  [101.17522996]
mat_Sqrt:  [[0.15]]
grads:  [0.08001252]
Stock Position:  0.0800125199869459
Bond Position:  [-1.33980732]


portfolio before change:  [6.79049715]
curr_Stock_Price:  101.61395017583682
curr_Factors:  [101.61395018]
mat_Sqrt:  [[0.15]]
grads:  [-0.00085153]
Stock Position:  -0.0008515275915391563
Bond Position:  [6.87702424]


portfolio before change:  [6.79083974]
curr_Stock_Price:  101.71640922947014
curr_Factors:  [101.71640923]
mat_Sqrt:  [[0.15]]
grads:  [0.04330642]
Stock Position:  0.04330641964075753
Bond Position:  [2.38586623]


portfolio before change:  [6.81286174]
curr_Stock_Price:  102.2214817571851
curr_Factors:  [102.22148176]
mat_Sqrt:  [[0.15]]
grads:  [-0.07992827]
Stock Position:  -0.0799282696592784
Bond Position:  [14.9832479]


portfolio before change:  [6.86505739]
curr_Stock_Price:  101.58016711281041
curr_Factors:  [101.58016711]
mat_Sqrt:  [[0.15]]
grads:  [-0.08167537]
Stock Position:  -0.08167536602225493
Bond Position:  [15.16165472]


portfolio before change:  [6.89638251]
curr_Stock_Price:  101.20823746734253
curr_Factors:  [101.20823747]
mat_Sqrt:  [[0.15]]
grads:  [0.06755822]
Stock Position:  0.06755821892958055
Bond Position:  [0.05893425]


portfolio before change:  [6.8338462]
curr_Stock_Price:  100.28251735850844
curr_Factors:  [100.28251736]
mat_Sqrt:  [[0.15]]
grads:  [-0.03526486]
Stock Position:  -0.035264864411319624
Bond Position:  [10.37029557]


portfolio before change:  [6.81304257]
curr_Stock_Price:  100.89082237730246
curr_Factors:  [100.89082238]
mat_Sqrt:  [[0.15]]
grads:  [0.03498178]
Stock Position:  0.03498178197586468
Bond Position:  [3.28370181]


portfolio before change:  [6.81277169]
curr_Stock_Price:  100.87721193887259
curr_Factors:  [100.87721194]
mat_Sqrt:  [[0.15]]
grads:  [0.02790717]
Stock Position:  0.027907168144452415
Bond Position:  [3.99757437]


portfolio before change:  [6.81343088]
curr_Stock_Price:  100.89187985754496
curr_Factors:  [100.89187986]
mat_Sqrt:  [[0.15]]
grads:  [0.03332451]
Stock Position:  0.03332451392212786
Bond Position:  [3.45125803]


portfolio before change:  [6.82085412]
curr_Stock_Price:  101.10816287296657
curr_Factors:  [101.10816287]
mat_Sqrt:  [[0.15]]
grads:  [-0.0677868]
Stock Position:  -0.06778680452897279
Bond Position:  [13.67465339]


portfolio before change:  [6.76981161]
curr_Stock_Price:  101.87375728880218
curr_Factors:  [101.87375729]
mat_Sqrt:  [[0.15]]
grads:  [0.05871976]
Stock Position:  0.05871975585114236
Bond Position:  [0.78780946]


portfolio before change:  [6.76429961]
curr_Stock_Price:  101.77904906708716
curr_Factors:  [101.77904907]
mat_Sqrt:  [[0.15]]
grads:  [0.16203823]
Stock Position:  0.1620382272538061
Bond Position:  [-9.72779707]


portfolio before change:  [6.6554888]
curr_Stock_Price:  101.1112880822734
curr_Factors:  [101.11128808]
mat_Sqrt:  [[0.15]]
grads:  [0.12758535]
Stock Position:  0.1275853534066995
Bond Position:  [-6.24483063]


portfolio before change:  [6.55133774]
curr_Stock_Price:  100.29802276418906
curr_Factors:  [100.29802276]
mat_Sqrt:  [[0.15]]
grads:  [0.02304055]
Stock Position:  0.023040549377789616
Bond Position:  [4.24041619]


portfolio before change:  [6.55458578]
curr_Stock_Price:  100.4274905484572
curr_Factors:  [100.42749055]
mat_Sqrt:  [[0.15]]
grads:  [0.53102348]
Stock Position:  0.5310234787728837
Bond Position:  [-46.77476961]


portfolio before change:  [6.49638823]
curr_Stock_Price:  100.32340091747471
curr_Factors:  [100.32340092]
mat_Sqrt:  [[0.15]]
grads:  [-0.08964947]
Stock Position:  -0.08964946738962115
Bond Position:  [15.49032769]


portfolio before change:  [6.51617582]
curr_Stock_Price:  100.11347872376118
curr_Factors:  [100.11347872]
mat_Sqrt:  [[0.15]]
grads:  [-0.01913378]
Stock Position:  -0.019133783930365217
Bond Position:  [8.43172549]


portfolio before change:  [6.51783882]
curr_Stock_Price:  100.05410705906995
curr_Factors:  [100.05410706]
mat_Sqrt:  [[0.15]]
grads:  [0.07584757]
Stock Position:  0.07584756767160644
Bond Position:  [-1.07102183]


portfolio before change:  [6.53490201]
curr_Stock_Price:  100.27995644595723
curr_Factors:  [100.27995645]
mat_Sqrt:  [[0.15]]
grads:  [0.09160423]
Stock Position:  0.0916042251717746
Bond Position:  [-2.6511657]


portfolio before change:  [6.47542004]
curr_Stock_Price:  99.63242882750001
curr_Factors:  [99.63242883]
mat_Sqrt:  [[0.15]]
grads:  [-0.02405948]
Stock Position:  -0.02405948127753063
Bond Position:  [8.8725246]


portfolio before change:  [6.48162547]
curr_Stock_Price:  99.39755758812814
curr_Factors:  [99.39755759]
mat_Sqrt:  [[0.15]]
grads:  [0.08278366]
Stock Position:  0.08278366430391366
Bond Position:  [-1.74686857]


portfolio before change:  [6.53036122]
curr_Stock_Price:  99.98758863416532
curr_Factors:  [99.98758863]
mat_Sqrt:  [[0.15]]
grads:  [-0.00457135]
Stock Position:  -0.004571347233162451
Bond Position:  [6.98743921]


portfolio before change:  [6.52990607]
curr_Stock_Price:  100.18269063267181
curr_Factors:  [100.18269063]
mat_Sqrt:  [[0.15]]
grads:  [0.02042703]
Stock Position:  0.02042703084070006
Bond Position:  [4.48347116]


portfolio before change:  [6.54121704]
curr_Stock_Price:  100.72269787226288
curr_Factors:  [100.72269787]
mat_Sqrt:  [[0.15]]
grads:  [-0.18688978]
Stock Position:  -0.18688977601048676
Bond Position:  [25.36525948]


portfolio before change:  [6.5161145]
curr_Stock_Price:  100.86549818533484
curr_Factors:  [100.86549819]
mat_Sqrt:  [[0.15]]
grads:  [-0.03364694]
Stock Position:  -0.033646940479858195
Bond Position:  [9.90992991]


portfolio before change:  [6.52067023]
curr_Stock_Price:  100.74850862389222
curr_Factors:  [100.74850862]
mat_Sqrt:  [[0.15]]
grads:  [0.08480566]
Stock Position:  0.08480565769449819
Bond Position:  [-2.02337331]


portfolio before change:  [6.48390996]
curr_Stock_Price:  100.31653507171542
curr_Factors:  [100.31653507]
mat_Sqrt:  [[0.15]]
grads:  [0.08798769]
Stock Position:  0.08798769160757719
Bond Position:  [-2.34271039]


portfolio before change:  [6.4549246]
curr_Stock_Price:  99.9887739533256
curr_Factors:  [99.98877395]
mat_Sqrt:  [[0.15]]
grads:  [0.10927664]
Stock Position:  0.10927663907461435
Bond Position:  [-4.47151257]


portfolio before change:  [6.4339555]
curr_Stock_Price:  99.79944150365868
curr_Factors:  [99.7994415]
mat_Sqrt:  [[0.15]]
grads:  [-0.01398097]
Stock Position:  -0.01398096587441923
Bond Position:  [7.82924809]


portfolio before change:  [6.43255808]
curr_Stock_Price:  99.9343937585386
curr_Factors:  [99.93439376]
mat_Sqrt:  [[0.15]]
grads:  [0.00830603]
Stock Position:  0.00830602699505278
Bond Position:  [5.60250031]


portfolio before change:  [6.42825916]
curr_Stock_Price:  99.37466819315954
curr_Factors:  [99.37466819]
mat_Sqrt:  [[0.15]]
grads:  [-0.0145617]
Stock Position:  -0.01456169700884855
Bond Position:  [7.87532296]


portfolio before change:  [6.43425318]
curr_Stock_Price:  98.99684125038684
curr_Factors:  [98.99684125]
mat_Sqrt:  [[0.15]]
grads:  [0.07606378]
Stock Position:  0.076063778293692
Bond Position:  [-1.0958206]


portfolio before change:  [6.41629689]
curr_Stock_Price:  98.7616727693191
curr_Factors:  [98.76167277]
mat_Sqrt:  [[0.15]]
grads:  [0.01596111]
Stock Position:  0.015961105883982148
Bond Position:  [4.83995137]


portfolio before change:  [6.41274469]
curr_Stock_Price:  98.52016666068796
curr_Factors:  [98.52016666]
mat_Sqrt:  [[0.15]]
grads:  [-0.09549529]
Stock Position:  -0.09549528709312188
Bond Position:  [15.82095629]


portfolio before change:  [6.39410586]
curr_Stock_Price:  98.72570209173507
curr_Factors:  [98.72570209]
mat_Sqrt:  [[0.15]]
grads:  [0.09066446]
Stock Position:  0.09066445969279899
Bond Position:  [-2.55680657]


portfolio before change:  [6.37867728]
curr_Stock_Price:  98.55729230174123
curr_Factors:  [98.5572923]
mat_Sqrt:  [[0.15]]
grads:  [-0.01117664]
Stock Position:  -0.011176637636595627
Bond Position:  [7.48021642]


portfolio before change:  [6.38586137]
curr_Stock_Price:  97.95634519621304
curr_Factors:  [97.9563452]
mat_Sqrt:  [[0.15]]
grads:  [0.02979936]
Stock Position:  0.02979936354966777
Bond Position:  [3.46682463]


portfolio before change:  [6.3708826]
curr_Stock_Price:  97.44641984036694
curr_Factors:  [97.44641984]
mat_Sqrt:  [[0.15]]
grads:  [-0.05733784]
Stock Position:  -0.057337840878721694
Bond Position:  [11.95824992]


portfolio before change:  [6.34340175]
curr_Stock_Price:  97.9387347109888
curr_Factors:  [97.93873471]
mat_Sqrt:  [[0.15]]
grads:  [0.00965711]
Stock Position:  0.00965711481349194
Bond Position:  [5.39759614]


portfolio before change:  [6.35109902]
curr_Stock_Price:  98.70085815301513
curr_Factors:  [98.70085815]
mat_Sqrt:  [[0.15]]
grads:  [-0.0230296]
Stock Position:  -0.02302959532205299
Bond Position:  [8.62413984]


portfolio before change:  [6.35158036]
curr_Stock_Price:  98.70336315837079
curr_Factors:  [98.70336316]
mat_Sqrt:  [[0.15]]
grads:  [-0.09141085]
Stock Position:  -0.09141085468009578
Bond Position:  [15.37413914]


portfolio before change:  [6.34544751]
curr_Stock_Price:  98.78096615949957
curr_Factors:  [98.78096616]
mat_Sqrt:  [[0.15]]
grads:  [-0.01134219]
Stock Position:  -0.011342188680160745
Bond Position:  [7.46583987]


portfolio before change:  [6.34342769]
curr_Stock_Price:  99.00018801491748
curr_Factors:  [99.00018801]
mat_Sqrt:  [[0.15]]
grads:  [-0.05806108]
Stock Position:  -0.05806107836650347
Bond Position:  [12.09148536]


portfolio before change:  [6.40224274]
curr_Stock_Price:  98.00021852100795
curr_Factors:  [98.00021852]
mat_Sqrt:  [[0.15]]
grads:  [0.04282995]
Stock Position:  0.04282994999578921
Bond Position:  [2.20489828]


portfolio before change:  [6.39282444]
curr_Stock_Price:  97.77710112822268
curr_Factors:  [97.77710113]
mat_Sqrt:  [[0.15]]
grads:  [-0.02233783]
Stock Position:  -0.02233782819050617
Bond Position:  [8.57695253]


portfolio before change:  [6.37419721]
curr_Stock_Price:  98.63498678489064
curr_Factors:  [98.63498678]
mat_Sqrt:  [[0.15]]
grads:  [0.02175255]
Stock Position:  0.02175255411793832
Bond Position:  [4.22863433]


portfolio before change:  [6.37596538]
curr_Stock_Price:  98.70412184462724
curr_Factors:  [98.70412184]
mat_Sqrt:  [[0.15]]
grads:  [0.01857748]
Stock Position:  0.018577483290501486
Bond Position:  [4.5422912]


portfolio before change:  [6.38312327]
curr_Stock_Price:  99.0741394747914
curr_Factors:  [99.07413947]
mat_Sqrt:  [[0.15]]
grads:  [-0.00156116]
Stock Position:  -0.0015611648744325978
Bond Position:  [6.53779434]


portfolio before change:  [6.38408173]
curr_Stock_Price:  98.72194808592202
curr_Factors:  [98.72194809]
mat_Sqrt:  [[0.15]]
grads:  [0.0100163]
Stock Position:  0.010016301016525425
Bond Position:  [5.39525298]


portfolio before change:  [6.39062899]
curr_Stock_Price:  99.3419428160319
curr_Factors:  [99.34194282]
mat_Sqrt:  [[0.15]]
grads:  [0.06014017]
Stock Position:  0.06014016895315846
Bond Position:  [0.41618777]


portfolio before change:  [6.39198686]
curr_Stock_Price:  99.36408854668647
curr_Factors:  [99.36408855]
mat_Sqrt:  [[0.15]]
grads:  [0.115434]
Stock Position:  0.11543399988601223
Bond Position:  [-5.07800733]


portfolio before change:  [6.34301909]
curr_Stock_Price:  98.9426322731374
curr_Factors:  [98.94263227]
mat_Sqrt:  [[0.15]]
grads:  [-0.1545352]
Stock Position:  -0.15453519556364576
Bond Position:  [21.63313811]


portfolio before change:  [6.44905571]
curr_Stock_Price:  98.26521696010276
curr_Factors:  [98.26521696]
mat_Sqrt:  [[0.15]]
grads:  [0.09200138]
Stock Position:  0.0920013810586568
Bond Position:  [-2.59147996]


portfolio before change:  [6.51038344]
curr_Stock_Price:  98.93357331074257
curr_Factors:  [98.93357331]
mat_Sqrt:  [[0.15]]
grads:  [0.02879804]
Stock Position:  0.028798037731324635
Bond Position:  [3.66129067]


portfolio before change:  [6.50259922]
curr_Stock_Price:  98.65532292465423
curr_Factors:  [98.65532292]
mat_Sqrt:  [[0.15]]
grads:  [0.03339775]
Stock Position:  0.033397752943705186
Bond Position:  [3.20773311]


portfolio before change:  [6.49076562]
curr_Stock_Price:  98.29499683660114
curr_Factors:  [98.29499684]
mat_Sqrt:  [[0.15]]
grads:  [-0.09895566]
Stock Position:  -0.09895566471558352
Bond Position:  [16.21761237]


portfolio before change:  [6.35835713]
curr_Stock_Price:  99.64329887719451
curr_Factors:  [99.64329888]
mat_Sqrt:  [[0.15]]
grads:  [-0.08358338]
Stock Position:  -0.083583376838511
Bond Position:  [14.68688053]


portfolio before change:  [6.32465611]
curr_Stock_Price:  100.05748390860211
curr_Factors:  [100.05748391]
mat_Sqrt:  [[0.15]]
grads:  [-0.01470926]
Stock Position:  -0.014709262638426058
Bond Position:  [7.79642792]


portfolio before change:  [6.33935746]
curr_Stock_Price:  99.09114955023249
curr_Factors:  [99.09114955]
mat_Sqrt:  [[0.15]]
grads:  [-0.0818367]
Stock Position:  -0.08183670431167935
Bond Position:  [14.44865057]


portfolio before change:  [6.36452747]
curr_Stock_Price:  98.79462074332437
curr_Factors:  [98.79462074]
mat_Sqrt:  [[0.15]]
grads:  [0.00895909]
Stock Position:  0.008959092254495472
Bond Position:  [5.47941735]


portfolio before change:  [6.35910699]
curr_Stock_Price:  98.15136846119466
curr_Factors:  [98.15136846]
mat_Sqrt:  [[0.15]]
grads:  [0.06898251]
Stock Position:  0.06898251277308363
Bond Position:  [-0.41162104]


portfolio before change:  [6.40854693]
curr_Stock_Price:  98.86844388146488
curr_Factors:  [98.86844388]
mat_Sqrt:  [[0.15]]
grads:  [0.01334726]
Stock Position:  0.013347264327397681
Bond Position:  [5.08892367]


portfolio before change:  [6.40054773]
curr_Stock_Price:  98.24530000722646
curr_Factors:  [98.24530001]
mat_Sqrt:  [[0.15]]
grads:  [0.06173116]
Stock Position:  0.06173115947763187
Bond Position:  [0.33575145]


portfolio before change:  [6.38209026]
curr_Stock_Price:  97.94596241775862
curr_Factors:  [97.94596242]
mat_Sqrt:  [[0.15]]
grads:  [-0.11499743]
Stock Position:  -0.114997431281207
Bond Position:  [17.64562434]


portfolio before change:  [6.31953257]
curr_Stock_Price:  98.49954502804256
curr_Factors:  [98.49954503]
mat_Sqrt:  [[0.15]]
grads:  [-0.01732423]
Stock Position:  -0.01732423200072858
Bond Position:  [8.02596154]


portfolio before change:  [6.33755491]
curr_Stock_Price:  97.48820432967891
curr_Factors:  [97.48820433]
mat_Sqrt:  [[0.15]]
grads:  [0.01228863]
Stock Position:  0.012288628840812905
Bond Position:  [5.13955855]


portfolio before change:  [6.33731763]
curr_Stock_Price:  97.44275476527973
curr_Factors:  [97.44275477]
mat_Sqrt:  [[0.15]]
grads:  [-0.00274344]
Stock Position:  -0.002743435935049097
Bond Position:  [6.60464558]


portfolio before change:  [6.33598682]
curr_Stock_Price:  98.07831163479632
curr_Factors:  [98.07831163]
mat_Sqrt:  [[0.15]]
grads:  [0.05630372]
Stock Position:  0.056303721716291735
Bond Position:  [0.81381285]


portfolio before change:  [6.37009749]
curr_Stock_Price:  98.68324154588328
curr_Factors:  [98.68324155]
mat_Sqrt:  [[0.15]]
grads:  [0.05054319]
Stock Position:  0.05054318512635219
Bond Position:  [1.38233214]


portfolio before change:  [6.39311048]
curr_Stock_Price:  99.1368454874697
curr_Factors:  [99.13684549]
mat_Sqrt:  [[0.15]]
grads:  [-0.03350549]
Stock Position:  -0.033505487486677046
Bond Position:  [9.71473881]


portfolio before change:  [6.39064149]
curr_Stock_Price:  99.22865648273752
curr_Factors:  [99.22865648]
mat_Sqrt:  [[0.15]]
grads:  [-0.03075606]
Stock Position:  -0.03075605642746901
Bond Position:  [9.44252365]


portfolio before change:  [6.38175873]
curr_Stock_Price:  99.53665878462697
curr_Factors:  [99.53665878]
mat_Sqrt:  [[0.15]]
grads:  [-0.05842498]
Stock Position:  -0.05842497647150004
Bond Position:  [12.19718568]


portfolio before change:  [6.42114987]
curr_Stock_Price:  98.87548962987026
curr_Factors:  [98.87548963]
mat_Sqrt:  [[0.15]]
grads:  [-0.04275]
Stock Position:  -0.04275000090908171
Bond Position:  [10.64807715]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.42114987]
Stock Price:  98.38918300230176
PL:  [6.42114987]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.56237922e-02]
 [ 5.46608416e-04]
 [-3.30060255e-05]
 [ 1.34342336e-03]
 [ 1.57166519e-02]
 [ 1.18200080e-02]
 [ 1.19731772e-03]
 [ 9.56528377e-03]
 [-2.48771671e-03]
 [-2.00468963e-02]
 [ 1.01204003e-02]
 [-6.72642361e-03]
 [ 1.62423383e-03]
 [ 4.14593247e-03]
 [ 5.38819693e-03]
 [-1.01784839e-03]
 [ 1.00923501e-03]
 [ 4.54331367e-03]
 [ 1.25684597e-02]
 [ 1.39066802e-02]
 [-6.59548355e-03]
 [-2.45595646e-02]
 [-3.35351307e-04]
 [ 4.11012343e-03]
 [-2.27818105e-03]
 [ 1.53613873e-02]
 [ 1.35563443e-02]
 [-1.30852276e-02]
 [ 1.21012503e-03]
 [-3.04432825e-03]
 [-3.52579035e-03]
 [-1.74065867e-02]
 [ 1.91226668e-02]
 [ 9.65603456e-03]
 [-2.70568841e-02]
 [ 7.87750534e-03]
 [-2.58304640e-03]
 [-7.13775138e-05]
 [ 5.42951474e-03]
 [-1.80119944e-02]
 [ 4.77720425e-02]
 [ 5.14516601e-04]
 [ 8.06136091e-03]
 [-9.33587181e-03]
 [-3.01960469e-03]
 [-1.60747267e-02]
 [-1.31694003e-02]
 [ 8.95040401e-04]
 [-2.67074008e-03]
 [-4.81202660e-03]
 [-3.83347714e-03]
 [ 3.02129641e-03]
 [ 3.33871517e-03]
 [ 2.25566593e-03]
 [ 1.74525891e-03]
 [ 9.02652686e-03]
 [ 1.26941321e-02]
 [ 2.88002626e-03]
 [ 1.36494551e-02]
 [ 1.32292031e-03]
 [ 3.43069188e-03]
 [-1.77960877e-02]
 [-1.26744730e-02]
 [-1.26471536e-03]
 [-1.17512680e-02]
 [ 4.75825115e-03]
 [ 1.42101947e-02]
 [ 2.20750141e-03]
 [ 7.89542547e-03]
 [-1.70728171e-02]
 [-5.72466583e-03]
 [-4.97223514e-04]
 [ 1.62211651e-03]
 [ 8.72314951e-03]
 [ 7.53837686e-03]
 [-2.31530391e-03]
 [ 4.87791382e-04]
 [-1.07484710e-02]
 [-2.93830793e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.55793488]
curr_Stock_Price:  99.7027878984017
curr_Factors:  [99.7027879]
mat_Sqrt:  [[0.15]]
grads:  [-0.23749195]
Stock Position:  -0.23749194828036457
Bond Position:  [21.12067447]


portfolio before change:  [-2.54219709]
curr_Stock_Price:  99.64207971351735
curr_Factors:  [99.64207971]
mat_Sqrt:  [[0.15]]
grads:  [0.00364406]
Stock Position:  0.003644056103391562
Bond Position:  [-2.90529842]


portfolio before change:  [-2.54241761]
curr_Stock_Price:  99.63139534561432
curr_Factors:  [99.63139535]
mat_Sqrt:  [[0.15]]
grads:  [-0.00022004]
Stock Position:  -0.00022004017004818507
Bond Position:  [-2.5204947]


portfolio before change:  [-2.54255936]
curr_Stock_Price:  99.55964830481899
curr_Factors:  [99.5596483]
mat_Sqrt:  [[0.15]]
grads:  [0.00895616]
Stock Position:  0.008956155731132228
Bond Position:  [-3.43423108]


portfolio before change:  [-2.53741294]
curr_Stock_Price:  100.15823885103244
curr_Factors:  [100.15823885]
mat_Sqrt:  [[0.15]]
grads:  [0.10477768]
Stock Position:  0.10477767950214593
Bond Position:  [-13.03176079]


portfolio before change:  [-2.52398202]
curr_Stock_Price:  100.2941974926498
curr_Factors:  [100.29419749]
mat_Sqrt:  [[0.15]]
grads:  [0.07880005]
Stock Position:  0.07880005314185874
Bond Position:  [-10.42717011]


portfolio before change:  [-2.53735253]
curr_Stock_Price:  100.13279154311898
curr_Factors:  [100.13279154]
mat_Sqrt:  [[0.15]]
grads:  [0.00798212]
Stock Position:  0.007982118154538354
Bond Position:  [-3.33662431]


portfolio before change:  [-2.53322089]
curr_Stock_Price:  100.67653040351732
curr_Factors:  [100.6765304]
mat_Sqrt:  [[0.15]]
grads:  [0.06376856]
Stock Position:  0.06376855849496126
Bond Position:  [-8.95321811]


portfolio before change:  [-2.51916811]
curr_Stock_Price:  100.90567744013995
curr_Factors:  [100.90567744]
mat_Sqrt:  [[0.15]]
grads:  [-0.01658478]
Stock Position:  -0.016584778078402536
Bond Position:  [-0.84566984]


portfolio before change:  [-2.5216356]
curr_Stock_Price:  101.05127101370144
curr_Factors:  [101.05127101]
mat_Sqrt:  [[0.15]]
grads:  [-0.13364598]
Stock Position:  -0.13364597522627444
Bond Position:  [10.98346006]


portfolio before change:  [-2.55047712]
curr_Stock_Price:  101.27221298108489
curr_Factors:  [101.27221298]
mat_Sqrt:  [[0.15]]
grads:  [0.06746934]
Stock Position:  0.06746933511288063
Bond Position:  [-9.38324599]


portfolio before change:  [-2.58347756]
curr_Stock_Price:  100.79178770550723
curr_Factors:  [100.79178771]
mat_Sqrt:  [[0.15]]
grads:  [-0.04484282]
Stock Position:  -0.044842824085643954
Bond Position:  [1.93631084]


portfolio before change:  [-2.58066739]
curr_Stock_Price:  100.73181935882718
curr_Factors:  [100.73181936]
mat_Sqrt:  [[0.15]]
grads:  [0.01082823]
Stock Position:  0.010828225535543875
Bond Position:  [-3.67141425]


portfolio before change:  [-2.57770396]
curr_Stock_Price:  101.02668817848225
curr_Factors:  [101.02668818]
mat_Sqrt:  [[0.15]]
grads:  [0.02763955]
Stock Position:  0.027639549799064023
Bond Position:  [-5.37003613]


portfolio before change:  [-2.60625244]
curr_Stock_Price:  100.0059461807032
curr_Factors:  [100.00594618]
mat_Sqrt:  [[0.15]]
grads:  [0.03592131]
Stock Position:  0.03592131288873607
Bond Position:  [-6.19859733]


portfolio before change:  [-2.60167055]
curr_Stock_Price:  100.14428523125393
curr_Factors:  [100.14428523]
mat_Sqrt:  [[0.15]]
grads:  [-0.00678566]
Stock Position:  -0.006785655929359344
Bond Position:  [-1.92212588]


portfolio before change:  [-2.59676304]
curr_Stock_Price:  99.40336373019946
curr_Factors:  [99.40336373]
mat_Sqrt:  [[0.15]]
grads:  [0.00672823]
Stock Position:  0.006728233387773376
Bond Position:  [-3.26557208]


portfolio before change:  [-2.60201165]
curr_Stock_Price:  98.65361194276485
curr_Factors:  [98.65361194]
mat_Sqrt:  [[0.15]]
grads:  [0.03028876]
Stock Position:  0.030288757771450722
Bond Position:  [-5.59010701]


portfolio before change:  [-2.60745711]
curr_Stock_Price:  98.48536268416422
curr_Factors:  [98.48536268]
mat_Sqrt:  [[0.15]]
grads:  [0.08378973]
Stock Position:  0.08378973157844354
Bond Position:  [-10.85951921]


portfolio before change:  [-2.63532361]
curr_Stock_Price:  98.16088666194685
curr_Factors:  [98.16088666]
mat_Sqrt:  [[0.15]]
grads:  [0.0927112]
Stock Position:  0.09271120123647382
Bond Position:  [-11.73593733]


portfolio before change:  [-2.67449755]
curr_Stock_Price:  97.74626121038543
curr_Factors:  [97.74626121]
mat_Sqrt:  [[0.15]]
grads:  [-0.04396989]
Stock Position:  -0.04396989032932101
Bond Position:  [1.62339483]


portfolio before change:  [-2.66252498]
curr_Stock_Price:  97.47627854071132
curr_Factors:  [97.47627854]
mat_Sqrt:  [[0.15]]
grads:  [-0.16373043]
Stock Position:  -0.16373043064372272
Bond Position:  [13.29730809]


portfolio before change:  [-2.70893158]
curr_Stock_Price:  97.76478760062686
curr_Factors:  [97.7647876]
mat_Sqrt:  [[0.15]]
grads:  [-0.00223568]
Stock Position:  -0.0022356753797346182
Bond Position:  [-2.49036125]


portfolio before change:  [-2.70776096]
curr_Stock_Price:  97.1715559983123
curr_Factors:  [97.171556]
mat_Sqrt:  [[0.15]]
grads:  [0.02740082]
Stock Position:  0.027400822863128563
Bond Position:  [-5.37034155]


portfolio before change:  [-2.70581171]
curr_Stock_Price:  97.25494421045525
curr_Factors:  [97.25494421]
mat_Sqrt:  [[0.15]]
grads:  [-0.01518787]
Stock Position:  -0.01518787368191002
Bond Position:  [-1.2287159]


portfolio before change:  [-2.71070081]
curr_Stock_Price:  97.57179539418158
curr_Factors:  [97.57179539]
mat_Sqrt:  [[0.15]]
grads:  [0.10240925]
Stock Position:  0.10240924886202006
Bond Position:  [-12.70295508]


portfolio before change:  [-2.6355448]
curr_Stock_Price:  98.31342724063776
curr_Factors:  [98.31342724]
mat_Sqrt:  [[0.15]]
grads:  [0.09037563]
Stock Position:  0.09037562879678307
Bond Position:  [-11.52068261]


portfolio before change:  [-2.70345853]
curr_Stock_Price:  97.56993410086864
curr_Factors:  [97.5699341]
mat_Sqrt:  [[0.15]]
grads:  [-0.08723485]
Stock Position:  -0.0872348503884391
Bond Position:  [5.80804007]


portfolio before change:  [-2.71690818]
curr_Stock_Price:  97.72827292116895
curr_Factors:  [97.72827292]
mat_Sqrt:  [[0.15]]
grads:  [0.0080675]
Stock Position:  0.008067500199784054
Bond Position:  [-3.50533104]


portfolio before change:  [-2.71835022]
curr_Stock_Price:  97.57668250916348
curr_Factors:  [97.57668251]
mat_Sqrt:  [[0.15]]
grads:  [-0.02029552]
Stock Position:  -0.020295521654224616
Bond Position:  [-0.73798055]


portfolio before change:  [-2.72104747]
curr_Stock_Price:  97.70730850812971
curr_Factors:  [97.70730851]
mat_Sqrt:  [[0.15]]
grads:  [-0.02350527]
Stock Position:  -0.023505268998277228
Bond Position:  [-0.4244109]


portfolio before change:  [-2.72940181]
curr_Stock_Price:  98.06160409532865
curr_Factors:  [98.0616041]
mat_Sqrt:  [[0.15]]
grads:  [-0.11604391]
Stock Position:  -0.11604391130741332
Bond Position:  [8.65005028]


portfolio before change:  [-2.65920581]
curr_Stock_Price:  97.46135411545076
curr_Factors:  [97.46135412]
mat_Sqrt:  [[0.15]]
grads:  [0.12748445]
Stock Position:  0.12748444509913004
Bond Position:  [-15.08401246]


portfolio before change:  [-2.70516871]
curr_Stock_Price:  97.10821208891979
curr_Factors:  [97.10821209]
mat_Sqrt:  [[0.15]]
grads:  [0.06437356]
Stock Position:  0.06437356370890435
Bond Position:  [-8.95637039]


portfolio before change:  [-2.73183202]
curr_Stock_Price:  96.70271143469087
curr_Factors:  [96.70271143]
mat_Sqrt:  [[0.15]]
grads:  [-0.18037923]
Stock Position:  -0.18037922743475507
Bond Position:  [14.71132836]


portfolio before change:  [-2.82181707]
curr_Stock_Price:  97.20667488062433
curr_Factors:  [97.20667488]
mat_Sqrt:  [[0.15]]
grads:  [0.0525167]
Stock Position:  0.05251670225931927
Bond Position:  [-7.92679107]


portfolio before change:  [-2.83568733]
curr_Stock_Price:  96.9519974968209
curr_Factors:  [96.9519975]
mat_Sqrt:  [[0.15]]
grads:  [-0.01722031]
Stock Position:  -0.017220309353949668
Bond Position:  [-1.16614394]


portfolio before change:  [-2.83684841]
curr_Stock_Price:  97.01518992648253
curr_Factors:  [97.01518993]
mat_Sqrt:  [[0.15]]
grads:  [-0.00047585]
Stock Position:  -0.0004758500922111044
Bond Position:  [-2.79068372]


portfolio before change:  [-2.83701204]
curr_Stock_Price:  96.99251577656301
curr_Factors:  [96.99251578]
mat_Sqrt:  [[0.15]]
grads:  [0.03619676]
Stock Position:  0.036196764952922955
Bond Position:  [-6.34782734]


portfolio before change:  [-2.86822113]
curr_Stock_Price:  96.1412701745441
curr_Factors:  [96.14127017]
mat_Sqrt:  [[0.15]]
grads:  [-0.12007996]
Stock Position:  -0.12007996276851937
Bond Position:  [8.67641901]


portfolio before change:  [-2.82699662]
curr_Stock_Price:  95.8024774950913
curr_Factors:  [95.8024775]
mat_Sqrt:  [[0.15]]
grads:  [0.31848028]
Stock Position:  0.3184802833161143
Bond Position:  [-33.3381968]


portfolio before change:  [-2.4982441]
curr_Stock_Price:  96.84127406527334
curr_Factors:  [96.84127407]
mat_Sqrt:  [[0.15]]
grads:  [0.00343011]
Stock Position:  0.0034301106707879782
Bond Position:  [-2.83042039]


portfolio before change:  [-2.50149619]
curr_Stock_Price:  95.94474845398068
curr_Factors:  [95.94474845]
mat_Sqrt:  [[0.15]]
grads:  [0.05374241]
Stock Position:  0.05374240605986547
Bond Position:  [-7.65779782]


portfolio before change:  [-2.51807599]
curr_Stock_Price:  95.6451493181564
curr_Factors:  [95.64514932]
mat_Sqrt:  [[0.15]]
grads:  [-0.06223915]
Stock Position:  -0.062239145380909265
Bond Position:  [3.43479636]


portfolio before change:  [-2.48737345]
curr_Stock_Price:  95.15529903516702
curr_Factors:  [95.15529904]
mat_Sqrt:  [[0.15]]
grads:  [-0.0201307]
Stock Position:  -0.020130697923991067
Bond Position:  [-0.57183087]


portfolio before change:  [-2.48422878]
curr_Stock_Price:  94.99731075526265
curr_Factors:  [94.99731076]
mat_Sqrt:  [[0.15]]
grads:  [-0.10716484]
Stock Position:  -0.10716484474629559
Bond Position:  [7.69614328]


portfolio before change:  [-2.50234152]
curr_Stock_Price:  95.17081701630309
curr_Factors:  [95.17081702]
mat_Sqrt:  [[0.15]]
grads:  [-0.087796]
Stock Position:  -0.08779600195377614
Bond Position:  [5.85327571]


portfolio before change:  [-2.54434858]
curr_Stock_Price:  95.65344598065518
curr_Factors:  [95.65344598]
mat_Sqrt:  [[0.15]]
grads:  [0.00596694]
Stock Position:  0.005966936007737791
Bond Position:  [-3.11510657]


portfolio before change:  [-2.54177406]
curr_Stock_Price:  96.11753896547778
curr_Factors:  [96.11753897]
mat_Sqrt:  [[0.15]]
grads:  [-0.01780493]
Stock Position:  -0.017804933860460163
Bond Position:  [-0.83040764]


portfolio before change:  [-2.53878967]
curr_Stock_Price:  95.9470078068124
curr_Factors:  [95.94700781]
mat_Sqrt:  [[0.15]]
grads:  [-0.03208018]
Stock Position:  -0.03208017731123121
Bond Position:  [0.53920735]


portfolio before change:  [-2.55559943]
curr_Stock_Price:  96.47205035720992
curr_Factors:  [96.47205036]
mat_Sqrt:  [[0.15]]
grads:  [-0.02555651]
Stock Position:  -0.025556514255255743
Bond Position:  [-0.0901101]


portfolio before change:  [-2.58344385]
curr_Stock_Price:  97.56135369881449
curr_Factors:  [97.5613537]
mat_Sqrt:  [[0.15]]
grads:  [0.02014198]
Stock Position:  0.02014197607698141
Bond Position:  [-4.54852231]


portfolio before change:  [-2.58888699]
curr_Stock_Price:  97.30522968400834
curr_Factors:  [97.30522968]
mat_Sqrt:  [[0.15]]
grads:  [0.0222581]
Stock Position:  0.02225810113163923
Bond Position:  [-4.75471663]


portfolio before change:  [-2.57247639]
curr_Stock_Price:  98.05586766046986
curr_Factors:  [98.05586766]
mat_Sqrt:  [[0.15]]
grads:  [0.01503777]
Stock Position:  0.015037772873463737
Bond Position:  [-4.04701826]


portfolio before change:  [-2.56601011]
curr_Stock_Price:  98.50269136147962
curr_Factors:  [98.50269136]
mat_Sqrt:  [[0.15]]
grads:  [0.01163506]
Stock Position:  0.011635059432172802
Bond Position:  [-3.71209477]


portfolio before change:  [-2.56469217]
curr_Stock_Price:  98.6359052584683
curr_Factors:  [98.63590526]
mat_Sqrt:  [[0.15]]
grads:  [0.06017685]
Stock Position:  0.06017684576532303
Bond Position:  [-8.50028982]


portfolio before change:  [-2.62674097]
curr_Stock_Price:  97.61362637334793
curr_Factors:  [97.61362637]
mat_Sqrt:  [[0.15]]
grads:  [0.08462755]
Stock Position:  0.08462754711740839
Bond Position:  [-10.88754274]


portfolio before change:  [-2.67487521]
curr_Stock_Price:  97.05288998284131
curr_Factors:  [97.05288998]
mat_Sqrt:  [[0.15]]
grads:  [0.01920018]
Stock Position:  0.019200175076331406
Bond Position:  [-4.53830769]


portfolio before change:  [-2.66637285]
curr_Stock_Price:  97.51049051967621
curr_Factors:  [97.51049052]
mat_Sqrt:  [[0.15]]
grads:  [0.09099637]
Stock Position:  0.09099636718408831
Bond Position:  [-11.53947325]


portfolio before change:  [-2.62533899]
curr_Stock_Price:  97.96935606446466
curr_Factors:  [97.96935606]
mat_Sqrt:  [[0.15]]
grads:  [0.00881947]
Stock Position:  0.008819468765864126
Bond Position:  [-3.48937667]


portfolio before change:  [-2.62676763]
curr_Stock_Price:  97.8320974300864
curr_Factors:  [97.83209743]
mat_Sqrt:  [[0.15]]
grads:  [0.02287128]
Stock Position:  0.02287127920413229
Bond Position:  [-4.86431285]


portfolio before change:  [-2.64841743]
curr_Stock_Price:  96.89879744491432
curr_Factors:  [96.89879744]
mat_Sqrt:  [[0.15]]
grads:  [-0.11864058]
Stock Position:  -0.11864058433617808
Bond Position:  [8.84771252]


portfolio before change:  [-2.75423248]
curr_Stock_Price:  97.79535446502129
curr_Factors:  [97.79535447]
mat_Sqrt:  [[0.15]]
grads:  [-0.08449649]
Stock Position:  -0.08449648653637752
Bond Position:  [5.50913137]


portfolio before change:  [-2.8166374]
curr_Stock_Price:  98.53798011993288
curr_Factors:  [98.53798012]
mat_Sqrt:  [[0.15]]
grads:  [-0.00843144]
Stock Position:  -0.00843143570228336
Bond Position:  [-1.98582076]


portfolio before change:  [-2.81813301]
curr_Stock_Price:  98.70064422114696
curr_Factors:  [98.70064422]
mat_Sqrt:  [[0.15]]
grads:  [-0.07834179]
Stock Position:  -0.07834178674197628
Bond Position:  [4.91425181]


portfolio before change:  [-2.83911823]
curr_Stock_Price:  98.9724323612381
curr_Factors:  [98.97243236]
mat_Sqrt:  [[0.15]]
grads:  [0.03172167]
Stock Position:  0.0317216743427126
Bond Position:  [-5.9786895]


portfolio before change:  [-2.82395299]
curr_Stock_Price:  99.46228431843083
curr_Factors:  [99.46228432]
mat_Sqrt:  [[0.15]]
grads:  [0.09473463]
Stock Position:  0.0947346313482934
Bond Position:  [-12.24647583]


portfolio before change:  [-2.92270603]
curr_Stock_Price:  98.42794650598732
curr_Factors:  [98.42794651]
mat_Sqrt:  [[0.15]]
grads:  [0.01471668]
Stock Position:  0.014716676098241219
Bond Position:  [-4.37123824]


portfolio before change:  [-2.91649144]
curr_Stock_Price:  98.86879301034898
curr_Factors:  [98.86879301]
mat_Sqrt:  [[0.15]]
grads:  [0.05263617]
Stock Position:  0.05263616980161605
Bond Position:  [-8.12056602]


portfolio before change:  [-2.94776831]
curr_Stock_Price:  98.28422692547862
curr_Factors:  [98.28422693]
mat_Sqrt:  [[0.15]]
grads:  [-0.11381878]
Stock Position:  -0.11381878094389222
Bond Position:  [8.23882258]


portfolio before change:  [-3.0990363]
curr_Stock_Price:  99.61777598500173
curr_Factors:  [99.61777599]
mat_Sqrt:  [[0.15]]
grads:  [-0.03816444]
Stock Position:  -0.038164438897993695
Bond Position:  [0.70282022]


portfolio before change:  [-3.1001065]
curr_Stock_Price:  99.64696883960515
curr_Factors:  [99.64696884]
mat_Sqrt:  [[0.15]]
grads:  [-0.00331482]
Stock Position:  -0.003314823427035269
Bond Position:  [-2.76979439]


portfolio before change:  [-3.09888171]
curr_Stock_Price:  99.22525446577549
curr_Factors:  [99.22525447]
mat_Sqrt:  [[0.15]]
grads:  [0.01081411]
Stock Position:  0.010814110089337874
Bond Position:  [-4.17191454]


portfolio before change:  [-3.10432966]
curr_Stock_Price:  98.7455848405695
curr_Factors:  [98.74558484]
mat_Sqrt:  [[0.15]]
grads:  [0.05815433]
Stock Position:  0.058154330079276305
Bond Position:  [-8.846813]


portfolio before change:  [-3.10889994]
curr_Stock_Price:  98.67650425380133
curr_Factors:  [98.67650425]
mat_Sqrt:  [[0.15]]
grads:  [0.05025585]
Stock Position:  0.05025584573107737
Bond Position:  [-8.06797112]


portfolio before change:  [-3.12044257]
curr_Stock_Price:  98.45686094769334
curr_Factors:  [98.45686095]
mat_Sqrt:  [[0.15]]
grads:  [-0.01543536]
Stock Position:  -0.015435359390047277
Bond Position:  [-1.60072553]


portfolio before change:  [-3.10681115]
curr_Stock_Price:  97.56725014683249
curr_Factors:  [97.56725015]
mat_Sqrt:  [[0.15]]
grads:  [0.00325194]
Stock Position:  0.003251942547812005
Bond Position:  [-3.42409424]


portfolio before change:  [-3.10715127]
curr_Stock_Price:  97.52847103226355
curr_Factors:  [97.52847103]
mat_Sqrt:  [[0.15]]
grads:  [-0.07165647]
Stock Position:  -0.07165647341608737
Bond Position:  [3.88139502]


portfolio before change:  [-3.06039524]
curr_Stock_Price:  96.87935399556734
curr_Factors:  [96.879354]
mat_Sqrt:  [[0.15]]
grads:  [-0.1958872]
Stock Position:  -0.19588719509363783
Bond Position:  [15.91702968]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.06039524]
Stock Price:  97.08879530430369
PL:  [-3.06039524]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.32151973e-02]
 [ 4.13963168e-03]
 [-9.40130150e-04]
 [-1.42093216e-03]
 [-2.51487600e-02]
 [ 2.01560460e-03]
 [ 1.90861441e-03]
 [-1.06009988e-02]
 [ 6.99566930e-04]
 [ 1.63511157e-02]
 [ 7.01999514e-03]
 [-9.38217501e-03]
 [ 5.86642809e-03]
 [ 4.84765112e-03]
 [-1.07241274e-02]
 [ 1.57469934e-02]
 [-3.65861654e-03]
 [-3.18707421e-03]
 [ 1.39132627e-03]
 [ 1.19841616e-02]
 [ 5.79805287e-02]
 [-1.55586930e-02]
 [-2.05154108e-03]
 [ 1.26131737e-02]
 [ 1.31352319e-02]
 [-4.13020634e-03]
 [ 1.36636138e-02]
 [-9.58188369e-05]
 [ 3.57920422e-03]
 [-2.51724885e-02]
 [-4.53558206e-03]
 [ 8.04104852e-03]
 [ 1.48895018e-02]
 [ 1.94148514e-02]
 [-1.37853063e-04]
 [-4.62515555e-03]
 [-2.12803479e-03]
 [ 1.02144340e-02]
 [ 3.21904043e-03]
 [-1.50927229e-02]
 [ 4.08341601e-02]
 [-2.87888308e-04]
 [ 4.91145622e-03]
 [-8.93482063e-03]
 [-1.03524628e-03]
 [-8.73325233e-03]
 [-1.35041411e-02]
 [-5.45379566e-04]
 [-4.41408375e-03]
 [ 3.55646758e-03]
 [-3.40383231e-03]
 [ 2.99523774e-03]
 [ 3.33719601e-03]
 [ 1.74575017e-03]
 [ 3.46920624e-03]
 [ 8.97752490e-03]
 [ 1.34356985e-02]
 [-6.73698677e-03]
 [ 1.37520379e-02]
 [ 5.01324089e-03]
 [ 5.24746478e-03]
 [-1.32002462e-02]
 [-1.25368532e-02]
 [-2.17982731e-03]
 [-2.01339559e-02]
 [ 3.29775702e-02]
 [ 2.10828167e-02]
 [ 2.31282721e-03]
 [ 6.23461114e-03]
 [-1.43368935e-02]
 [-6.03431987e-03]
 [-3.83621189e-04]
 [ 1.78317390e-03]
 [ 8.82113077e-03]
 [ 1.10524604e-02]
 [-9.00508529e-03]
 [ 8.54287646e-04]
 [-8.43127099e-03]
 [ 8.66148942e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.72431828]
curr_Stock_Price:  100.23509377182285
curr_Factors:  [100.23509377]
mat_Sqrt:  [[0.15]]
grads:  [-0.28810132]
Stock Position:  -0.2881013150319321
Bond Position:  [34.6021806]


portfolio before change:  [6.01712926]
curr_Stock_Price:  99.22625324563515
curr_Factors:  [99.22625325]
mat_Sqrt:  [[0.15]]
grads:  [0.02759754]
Stock Position:  0.027597544565879907
Bond Position:  [3.27872832]


portfolio before change:  [6.01042063]
curr_Stock_Price:  98.9757395443601
curr_Factors:  [98.97573954]
mat_Sqrt:  [[0.15]]
grads:  [-0.00626753]
Stock Position:  -0.0062675343337832935
Bond Position:  [6.63075447]


portfolio before change:  [6.01338188]
curr_Stock_Price:  98.56938858436392
curr_Factors:  [98.56938858]
mat_Sqrt:  [[0.15]]
grads:  [-0.00947288]
Stock Position:  -0.009472881048371143
Bond Position:  [6.94711797]


portfolio before change:  [6.01937259]
curr_Stock_Price:  97.98281896335745
curr_Factors:  [97.98281896]
mat_Sqrt:  [[0.15]]
grads:  [-0.1676584]
Stock Position:  -0.1676584000275187
Bond Position:  [22.44701525]


portfolio before change:  [6.03178499]
curr_Stock_Price:  97.91715319869685
curr_Factors:  [97.9171532]
mat_Sqrt:  [[0.15]]
grads:  [0.01343736]
Stock Position:  0.0134373639747028
Bond Position:  [4.71603657]


portfolio before change:  [6.0292816]
curr_Stock_Price:  97.70891667544936
curr_Factors:  [97.70891668]
mat_Sqrt:  [[0.15]]
grads:  [0.0127241]
Stock Position:  0.012724096041544364
Bond Position:  [4.78602396]


portfolio before change:  [6.02579]
curr_Stock_Price:  97.41099876731752
curr_Factors:  [97.41099877]
mat_Sqrt:  [[0.15]]
grads:  [-0.07067333]
Stock Position:  -0.07067332555674304
Bond Position:  [12.91014923]


portfolio before change:  [6.0298797]
curr_Stock_Price:  97.36454860510194
curr_Factors:  [97.36454861]
mat_Sqrt:  [[0.15]]
grads:  [0.00466378]
Stock Position:  0.004663779535378831
Bond Position:  [5.57579291]


portfolio before change:  [6.03269621]
curr_Stock_Price:  97.89373651579328
curr_Factors:  [97.89373652]
mat_Sqrt:  [[0.15]]
grads:  [0.10900744]
Stock Position:  0.1090074380439204
Bond Position:  [-4.6384492]


portfolio before change:  [6.08782437]
curr_Stock_Price:  98.40212444253935
curr_Factors:  [98.40212444]
mat_Sqrt:  [[0.15]]
grads:  [0.04679997]
Stock Position:  0.04679996759645133
Bond Position:  [1.48260813]


portfolio before change:  [6.06335645]
curr_Stock_Price:  97.87732533217736
curr_Factors:  [97.87732533]
mat_Sqrt:  [[0.15]]
grads:  [-0.06254783]
Stock Position:  -0.06254783336722412
Bond Position:  [12.18537109]


portfolio before change:  [6.07619649]
curr_Stock_Price:  97.68421825174288
curr_Factors:  [97.68421825]
mat_Sqrt:  [[0.15]]
grads:  [0.03910952]
Stock Position:  0.039109520605827904
Bond Position:  [2.25581354]


portfolio before change:  [6.08864294]
curr_Stock_Price:  97.9988591101906
curr_Factors:  [97.99885911]
mat_Sqrt:  [[0.15]]
grads:  [0.03231767]
Stock Position:  0.03231767414115791
Bond Position:  [2.92154774]


portfolio before change:  [6.10204723]
curr_Stock_Price:  98.40797564025499
curr_Factors:  [98.40797564]
mat_Sqrt:  [[0.15]]
grads:  [-0.07149418]
Stock Position:  -0.07149418283612868
Bond Position:  [13.13764504]


portfolio before change:  [6.14385941]
curr_Stock_Price:  97.83462765245976
curr_Factors:  [97.83462765]
mat_Sqrt:  [[0.15]]
grads:  [0.10497996]
Stock Position:  0.10497995613537653
Bond Position:  [-4.12681551]


portfolio before change:  [6.10026881]
curr_Stock_Price:  97.42185681118326
curr_Factors:  [97.42185681]
mat_Sqrt:  [[0.15]]
grads:  [-0.02439078]
Stock Position:  -0.02439077691943861
Bond Position:  [8.47646359]


portfolio before change:  [6.09861114]
curr_Stock_Price:  97.51154071160317
curr_Factors:  [97.51154071]
mat_Sqrt:  [[0.15]]
grads:  [-0.02124716]
Stock Position:  -0.021247161429727206
Bond Position:  [8.17045459]


portfolio before change:  [6.09384152]
curr_Stock_Price:  97.76005857874749
curr_Factors:  [97.76005858]
mat_Sqrt:  [[0.15]]
grads:  [0.00927551]
Stock Position:  0.009275508436544719
Bond Position:  [5.18706727]


portfolio before change:  [6.10477889]
curr_Stock_Price:  98.90427307698432
curr_Factors:  [98.90427308]
mat_Sqrt:  [[0.15]]
grads:  [0.07989441]
Stock Position:  0.07989441081056997
Bond Position:  [-1.79711974]


portfolio before change:  [6.15349247]
curr_Stock_Price:  99.51540349150994
curr_Factors:  [99.51540349]
mat_Sqrt:  [[0.15]]
grads:  [0.38653686]
Stock Position:  0.3865368577369867
Bond Position:  [-32.31287889]


portfolio before change:  [6.18047879]
curr_Stock_Price:  99.59044403584525
curr_Factors:  [99.59044404]
mat_Sqrt:  [[0.15]]
grads:  [-0.10372462]
Stock Position:  -0.10372462027210502
Bond Position:  [16.51045978]


portfolio before change:  [6.1857249]
curr_Stock_Price:  99.54981551773162
curr_Factors:  [99.54981552]
mat_Sqrt:  [[0.15]]
grads:  [-0.01367694]
Stock Position:  -0.013676940501879647
Bond Position:  [7.5472618]


portfolio before change:  [6.18318162]
curr_Stock_Price:  99.7702596747786
curr_Factors:  [99.77025967]
mat_Sqrt:  [[0.15]]
grads:  [0.08408782]
Stock Position:  0.08408782434590588
Bond Position:  [-2.20628245]


portfolio before change:  [6.20479014]
curr_Stock_Price:  100.0288752063822
curr_Factors:  [100.02887521]
mat_Sqrt:  [[0.15]]
grads:  [0.08756821]
Stock Position:  0.0875682128900878
Bond Position:  [-2.5545597]


portfolio before change:  [6.1748805]
curr_Stock_Price:  99.68914038863748
curr_Factors:  [99.68914039]
mat_Sqrt:  [[0.15]]
grads:  [-0.02753471]
Stock Position:  -0.027534708949316044
Bond Position:  [8.91979197]


portfolio before change:  [6.16169697]
curr_Stock_Price:  100.18818469517176
curr_Factors:  [100.1881847]
mat_Sqrt:  [[0.15]]
grads:  [0.09109076]
Stock Position:  0.09109075841532346
Bond Position:  [-2.96452076]


portfolio before change:  [6.23428974]
curr_Stock_Price:  100.98714672245846
curr_Factors:  [100.98714672]
mat_Sqrt:  [[0.15]]
grads:  [-0.00063879]
Stock Position:  -0.0006387922461733216
Bond Position:  [6.29879954]


portfolio before change:  [6.23482036]
curr_Stock_Price:  100.77278189108057
curr_Factors:  [100.77278189]
mat_Sqrt:  [[0.15]]
grads:  [0.02386136]
Stock Position:  0.023861361488655284
Bond Position:  [3.83024458]


portfolio before change:  [6.22343539]
curr_Stock_Price:  100.28561904998335
curr_Factors:  [100.28561905]
mat_Sqrt:  [[0.15]]
grads:  [-0.16781659]
Stock Position:  -0.1678165899975517
Bond Position:  [23.053026]


portfolio before change:  [6.26359567]
curr_Stock_Price:  100.05489437463198
curr_Factors:  [100.05489437]
mat_Sqrt:  [[0.15]]
grads:  [-0.03023721]
Stock Position:  -0.030237213746508555
Bond Position:  [9.2889769]


portfolio before change:  [6.25479486]
curr_Stock_Price:  100.36515412857364
curr_Factors:  [100.36515413]
mat_Sqrt:  [[0.15]]
grads:  [0.05360699]
Stock Position:  0.05360699012996843
Bond Position:  [0.87452104]


portfolio before change:  [6.22706403]
curr_Stock_Price:  99.8468357459574
curr_Factors:  [99.84683575]
mat_Sqrt:  [[0.15]]
grads:  [0.09926335]
Stock Position:  0.09926334505699995
Bond Position:  [-3.68406688]


portfolio before change:  [6.18557371]
curr_Stock_Price:  99.43117312365132
curr_Factors:  [99.43117312]
mat_Sqrt:  [[0.15]]
grads:  [0.12943234]
Stock Position:  0.12943234247616578
Bond Position:  [-6.68403594]


portfolio before change:  [6.25711959]
curr_Stock_Price:  99.98716746205086
curr_Factors:  [99.98716746]
mat_Sqrt:  [[0.15]]
grads:  [-0.00091902]
Stock Position:  -0.0009190204224323456
Bond Position:  [6.34900984]


portfolio before change:  [6.2565093]
curr_Stock_Price:  101.08303298724694
curr_Factors:  [101.08303299]
mat_Sqrt:  [[0.15]]
grads:  [-0.03083437]
Stock Position:  -0.030834370350339153
Bond Position:  [9.37334097]


portfolio before change:  [6.30275296]
curr_Stock_Price:  99.60228887236262
curr_Factors:  [99.60228887]
mat_Sqrt:  [[0.15]]
grads:  [-0.0141869]
Stock Position:  -0.014186898594221483
Bond Position:  [7.71580053]


portfolio before change:  [6.31660153]
curr_Stock_Price:  98.66012940939595
curr_Factors:  [98.66012941]
mat_Sqrt:  [[0.15]]
grads:  [0.06809623]
Stock Position:  0.06809622686309055
Bond Position:  [-0.40178102]


portfolio before change:  [6.29070531]
curr_Stock_Price:  98.2802094440546
curr_Factors:  [98.28020944]
mat_Sqrt:  [[0.15]]
grads:  [0.02146027]
Stock Position:  0.021460269551122978
Bond Position:  [4.18158552]


portfolio before change:  [6.28265802]
curr_Stock_Price:  97.89304548258043
curr_Factors:  [97.89304548]
mat_Sqrt:  [[0.15]]
grads:  [-0.10061815]
Stock Position:  -0.100618152511166
Bond Position:  [16.1324754]


portfolio before change:  [6.34289306]
curr_Stock_Price:  97.30441678143652
curr_Factors:  [97.30441678]
mat_Sqrt:  [[0.15]]
grads:  [0.27222773]
Stock Position:  0.27222773388947075
Bond Position:  [-20.14606781]


portfolio before change:  [6.3717442]
curr_Stock_Price:  97.41502381085597
curr_Factors:  [97.41502381]
mat_Sqrt:  [[0.15]]
grads:  [-0.00191926]
Stock Position:  -0.0019192553845117015
Bond Position:  [6.55870851]


portfolio before change:  [6.37153992]
curr_Stock_Price:  97.73504858419356
curr_Factors:  [97.73504858]
mat_Sqrt:  [[0.15]]
grads:  [0.03274304]
Stock Position:  0.03274304148250167
Bond Position:  [3.17139717]


portfolio before change:  [6.34665257]
curr_Stock_Price:  96.968914282873
curr_Factors:  [96.96891428]
mat_Sqrt:  [[0.15]]
grads:  [-0.05956547]
Stock Position:  -0.05956547088441295
Bond Position:  [12.12265161]


portfolio before change:  [6.3849167]
curr_Stock_Price:  96.33924685396555
curr_Factors:  [96.33924685]
mat_Sqrt:  [[0.15]]
grads:  [-0.00690164]
Stock Position:  -0.006901641873675325
Bond Position:  [7.04981568]


portfolio before change:  [6.38247093]
curr_Stock_Price:  96.75746540402865
curr_Factors:  [96.7574654]
mat_Sqrt:  [[0.15]]
grads:  [-0.05822168]
Stock Position:  -0.058221682173196246
Bond Position:  [12.01585333]


portfolio before change:  [6.35935872]
curr_Stock_Price:  97.16733370820089
curr_Factors:  [97.16733371]
mat_Sqrt:  [[0.15]]
grads:  [-0.09002761]
Stock Position:  -0.09002760761148658
Bond Position:  [15.10710131]


portfolio before change:  [6.35148573]
curr_Stock_Price:  97.26527267656353
curr_Factors:  [97.26527268]
mat_Sqrt:  [[0.15]]
grads:  [-0.00363586]
Stock Position:  -0.003635863774583877
Bond Position:  [6.70512902]


portfolio before change:  [6.35108859]
curr_Stock_Price:  97.4897670805027
curr_Factors:  [97.48976708]
mat_Sqrt:  [[0.15]]
grads:  [-0.02942723]
Stock Position:  -0.029427225027410985
Bond Position:  [9.2199419]


portfolio before change:  [6.35273995]
curr_Stock_Price:  97.45323279499036
curr_Factors:  [97.45323279]
mat_Sqrt:  [[0.15]]
grads:  [0.02370978]
Stock Position:  0.023709783857557926
Bond Position:  [4.04214487]


portfolio before change:  [6.35736637]
curr_Stock_Price:  97.63770411847133
curr_Factors:  [97.63770412]
mat_Sqrt:  [[0.15]]
grads:  [-0.02269222]
Stock Position:  -0.022692215375513976
Bond Position:  [8.57298218]


portfolio before change:  [6.36605056]
curr_Stock_Price:  97.27862234808644
curr_Factors:  [97.27862235]
mat_Sqrt:  [[0.15]]
grads:  [0.01996825]
Stock Position:  0.019968251631038793
Bond Position:  [4.42356655]


portfolio before change:  [6.36699231]
curr_Stock_Price:  97.31193889046075
curr_Factors:  [97.31193889]
mat_Sqrt:  [[0.15]]
grads:  [0.02224797]
Stock Position:  0.02224797339476908
Bond Position:  [4.20199889]


portfolio before change:  [6.36916566]
curr_Stock_Price:  97.39782159573225
curr_Factors:  [97.3978216]
mat_Sqrt:  [[0.15]]
grads:  [0.01163833]
Stock Position:  0.011638334435580306
Bond Position:  [5.23561724]


portfolio before change:  [6.3720927]
curr_Stock_Price:  97.62120376630585
curr_Factors:  [97.62120377]
mat_Sqrt:  [[0.15]]
grads:  [0.02312804]
Stock Position:  0.0231280416075232
Bond Position:  [4.11430543]


portfolio before change:  [6.38275368]
curr_Stock_Price:  98.07104018583634
curr_Factors:  [98.07104019]
mat_Sqrt:  [[0.15]]
grads:  [0.05985017]
Stock Position:  0.05985016599064679
Bond Position:  [0.51318565]


portfolio before change:  [6.37201865]
curr_Stock_Price:  97.8911390984815
curr_Factors:  [97.8911391]
mat_Sqrt:  [[0.15]]
grads:  [0.08957132]
Stock Position:  0.08957132327168503
Bond Position:  [-2.39622022]


portfolio before change:  [6.37275926]
curr_Stock_Price:  97.90107950276695
curr_Factors:  [97.9010795]
mat_Sqrt:  [[0.15]]
grads:  [-0.04491325]
Stock Position:  -0.044913245107547364
Bond Position:  [10.76981444]


portfolio before change:  [6.36768755]
curr_Stock_Price:  98.02898914754272
curr_Factors:  [98.02898915]
mat_Sqrt:  [[0.15]]
grads:  [0.09168025]
Stock Position:  0.09168025286217242
Bond Position:  [-2.61963496]


portfolio before change:  [6.46955776]
curr_Stock_Price:  99.14192166477932
curr_Factors:  [99.14192166]
mat_Sqrt:  [[0.15]]
grads:  [0.03342161]
Stock Position:  0.033421605923455895
Bond Position:  [3.15607552]


portfolio before change:  [6.4681564]
curr_Stock_Price:  99.09408975179994
curr_Factors:  [99.09408975]
mat_Sqrt:  [[0.15]]
grads:  [0.0349831]
Stock Position:  0.03498309853044211
Bond Position:  [3.00153809]


portfolio before change:  [6.47005243]
curr_Stock_Price:  99.14292550266063
curr_Factors:  [99.1429255]
mat_Sqrt:  [[0.15]]
grads:  [-0.08800164]
Stock Position:  -0.08800164152878465
Bond Position:  [15.19479262]


portfolio before change:  [6.43200864]
curr_Stock_Price:  99.5860251232521
curr_Factors:  [99.58602512]
mat_Sqrt:  [[0.15]]
grads:  [-0.08357902]
Stock Position:  -0.08357902118129873
Bond Position:  [14.75531114]


portfolio before change:  [6.40545743]
curr_Stock_Price:  99.91473730286249
curr_Factors:  [99.9147373]
mat_Sqrt:  [[0.15]]
grads:  [-0.01453218]
Stock Position:  -0.014532182082333846
Bond Position:  [7.85743658]


portfolio before change:  [6.3942692]
curr_Stock_Price:  100.71842455097014
curr_Factors:  [100.71842455]
mat_Sqrt:  [[0.15]]
grads:  [-0.13422637]
Stock Position:  -0.13422637244747104
Bond Position:  [19.91333797]


portfolio before change:  [6.38735788]
curr_Stock_Price:  100.77918721699285
curr_Factors:  [100.77918722]
mat_Sqrt:  [[0.15]]
grads:  [0.21985047]
Stock Position:  0.2198504682066981
Bond Position:  [-15.76899362]


portfolio before change:  [6.40814953]
curr_Stock_Price:  100.87824201251182
curr_Factors:  [100.87824201]
mat_Sqrt:  [[0.15]]
grads:  [0.14055211]
Stock Position:  0.14055211128168466
Bond Position:  [-7.77050037]


portfolio before change:  [6.30833625]
curr_Stock_Price:  100.17154609133065
curr_Factors:  [100.17154609]
mat_Sqrt:  [[0.15]]
grads:  [0.01541885]
Stock Position:  0.015418848047063331
Bond Position:  [4.7638064]


portfolio before change:  [6.30587238]
curr_Stock_Price:  99.99243947191725
curr_Factors:  [99.99243947]
mat_Sqrt:  [[0.15]]
grads:  [0.04156407]
Stock Position:  0.0415640742617096
Bond Position:  [2.1497792]


portfolio before change:  [6.31721146]
curr_Stock_Price:  100.26201639099608
curr_Factors:  [100.26201639]
mat_Sqrt:  [[0.15]]
grads:  [-0.09557929]
Stock Position:  -0.09557929010999151
Bond Position:  [15.90018381]


portfolio before change:  [6.35377585]
curr_Stock_Price:  99.88985839663654
curr_Factors:  [99.8898584]
mat_Sqrt:  [[0.15]]
grads:  [-0.0402288]
Stock Position:  -0.0402287991343714
Bond Position:  [10.3722249]


portfolio before change:  [6.36261577]
curr_Stock_Price:  99.68623222465123
curr_Factors:  [99.68623222]
mat_Sqrt:  [[0.15]]
grads:  [-0.00255747]
Stock Position:  -0.002557474596090505
Bond Position:  [6.61756078]


portfolio before change:  [6.36363637]
curr_Stock_Price:  99.44889250812771
curr_Factors:  [99.44889251]
mat_Sqrt:  [[0.15]]
grads:  [0.01188783]
Stock Position:  0.011887826004667814
Bond Position:  [5.18140524]


portfolio before change:  [6.37118704]
curr_Stock_Price:  100.05681030542812
curr_Factors:  [100.05681031]
mat_Sqrt:  [[0.15]]
grads:  [0.05880754]
Stock Position:  0.05880753847086792
Bond Position:  [0.48709232]


portfolio before change:  [6.3821691]
curr_Stock_Price:  100.24303839466795
curr_Factors:  [100.24303839]
mat_Sqrt:  [[0.15]]
grads:  [0.07368307]
Stock Position:  0.0736830696370233
Bond Position:  [-1.00404568]


portfolio before change:  [6.40434839]
curr_Stock_Price:  100.5448994270809
curr_Factors:  [100.54489943]
mat_Sqrt:  [[0.15]]
grads:  [-0.0600339]
Stock Position:  -0.06003390196021782
Bond Position:  [12.44045103]


portfolio before change:  [6.37989572]
curr_Stock_Price:  100.96516567829454
curr_Factors:  [100.96516568]
mat_Sqrt:  [[0.15]]
grads:  [0.00569525]
Stock Position:  0.005695250974683102
Bond Position:  [5.80487376]


portfolio before change:  [6.37795692]
curr_Stock_Price:  100.56103548927034
curr_Factors:  [100.56103549]
mat_Sqrt:  [[0.15]]
grads:  [-0.05620847]
Stock Position:  -0.0562084732920352
Bond Position:  [12.03033919]


portfolio before change:  [6.36549124]
curr_Stock_Price:  100.79618849728143
curr_Factors:  [100.7961885]
mat_Sqrt:  [[0.15]]
grads:  [0.05774326]
Stock Position:  0.057743262801190264
Bond Position:  [0.54519044]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.36549124]
Stock Price:  99.23814516789054
PL:  [6.36549124]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.38699416e-02]
 [-1.00882932e-03]
 [ 3.15105765e-04]
 [ 2.34510711e-03]
 [ 6.28244494e-03]
 [ 1.20163079e-02]
 [ 7.61772260e-04]
 [ 7.42522664e-03]
 [-2.28026069e-03]
 [-1.40880292e-02]
 [ 1.02962819e-02]
 [-9.06104186e-03]
 [ 1.57093727e-02]
 [ 1.25656003e-02]
 [-3.44392010e-03]
 [-7.49938369e-03]
 [ 1.77142100e-02]
 [ 1.33099896e-02]
 [-3.20402095e-02]
 [-6.74622055e-03]
 [-2.25756373e-02]
 [-7.60786392e-03]
 [-6.53922981e-03]
 [ 3.31193383e-03]
 [ 1.84005184e-02]
 [ 1.23191081e-02]
 [ 5.10936480e-03]
 [ 1.29508766e-02]
 [ 1.13663039e-02]
 [-8.38976812e-03]
 [-5.90110451e-03]
 [ 3.81429307e-02]
 [ 1.33086614e-03]
 [-1.31540703e-02]
 [ 2.33464720e-03]
 [-7.65721541e-03]
 [ 9.18845539e-04]
 [-4.18993870e-03]
 [ 6.11172870e-03]
 [-6.90056334e-03]
 [-6.08124249e-02]
 [-5.04637402e-03]
 [ 1.99556343e-02]
 [-1.65599965e-02]
 [-5.62768941e-03]
 [ 2.90496995e-03]
 [-1.35792722e-02]
 [ 1.12172935e-02]
 [ 1.70942404e-02]
 [-1.10210930e-02]
 [-4.12305724e-03]
 [ 3.46604592e-03]
 [ 2.41156755e-03]
 [ 5.26282730e-04]
 [-7.70243404e-03]
 [ 1.09690103e-02]
 [-2.36529388e-02]
 [-8.26462994e-03]
 [ 1.68238415e-02]
 [-3.35528661e-03]
 [ 1.29870384e-02]
 [-1.42177578e-02]
 [-1.27118406e-02]
 [-2.93332228e-03]
 [ 6.54672704e-02]
 [-1.70291074e-02]
 [ 1.49926761e-02]
 [ 5.20676535e-03]
 [ 1.22053666e-02]
 [-2.20989572e-02]
 [-7.91541523e-03]
 [-6.81623049e-03]
 [ 6.36036032e-03]
 [ 6.58021258e-03]
 [-6.91709854e-04]
 [-1.78501862e-04]
 [ 6.75733146e-03]
 [-2.68066034e-03]
 [ 2.03082430e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.11525651]
curr_Stock_Price:  100.00313699164607
curr_Factors:  [100.00313699]
mat_Sqrt:  [[0.15]]
grads:  [-0.22579961]
Stock Position:  -0.2257996105129916
Bond Position:  [24.69592589]


portfolio before change:  [1.98411276]
curr_Stock_Price:  100.59076994071269
curr_Factors:  [100.59076994]
mat_Sqrt:  [[0.15]]
grads:  [-0.00672553]
Stock Position:  -0.006725528779520145
Bond Position:  [2.66063888]


portfolio before change:  [1.98443071]
curr_Stock_Price:  100.56822112078325
curr_Factors:  [100.56822112]
mat_Sqrt:  [[0.15]]
grads:  [0.00210071]
Stock Position:  0.0021007051026985645
Bond Position:  [1.77316654]


portfolio before change:  [1.98488969]
curr_Stock_Price:  100.73395122158472
curr_Factors:  [100.73395122]
mat_Sqrt:  [[0.15]]
grads:  [0.01563405]
Stock Position:  0.015634047425606975
Bond Position:  [0.41001032]


portfolio before change:  [1.99381806]
curr_Stock_Price:  101.30339748448581
curr_Factors:  [101.30339748]
mat_Sqrt:  [[0.15]]
grads:  [0.04188297]
Stock Position:  0.041882966282100344
Bond Position:  [-2.24906872]


portfolio before change:  [1.99030168]
curr_Stock_Price:  101.22279632756259
curr_Factors:  [101.22279633]
mat_Sqrt:  [[0.15]]
grads:  [0.08010872]
Stock Position:  0.08010871960666067
Bond Position:  [-6.11852693]


portfolio before change:  [1.95489932]
curr_Stock_Price:  100.78564123418488
curr_Factors:  [100.78564123]
mat_Sqrt:  [[0.15]]
grads:  [0.00507848]
Stock Position:  0.005078481732665941
Bond Position:  [1.44306129]


portfolio before change:  [1.95675087]
curr_Stock_Price:  101.13246868593134
curr_Factors:  [101.13246869]
mat_Sqrt:  [[0.15]]
grads:  [0.04950151]
Stock Position:  0.049501510910983884
Bond Position:  [-3.04945913]


portfolio before change:  [1.94438095]
curr_Stock_Price:  100.88642919178524
curr_Factors:  [100.88642919]
mat_Sqrt:  [[0.15]]
grads:  [-0.01520174]
Stock Position:  -0.015201737954998382
Bond Position:  [3.47803001]


portfolio before change:  [1.93490476]
curr_Stock_Price:  101.52409164593942
curr_Factors:  [101.52409165]
mat_Sqrt:  [[0.15]]
grads:  [-0.09392019]
Stock Position:  -0.09392019486594529
Bond Position:  [11.47006723]


portfolio before change:  [2.00500979]
curr_Stock_Price:  100.78529279612371
curr_Factors:  [100.7852928]
mat_Sqrt:  [[0.15]]
grads:  [0.06864188]
Stock Position:  0.06864187906122464
Bond Position:  [-4.91308209]


portfolio before change:  [2.06944416]
curr_Stock_Price:  101.7284699467156
curr_Factors:  [101.72846995]
mat_Sqrt:  [[0.15]]
grads:  [-0.06040695]
Stock Position:  -0.06040694572979729
Bond Position:  [8.21455033]


portfolio before change:  [2.07334472]
curr_Stock_Price:  101.67239813016829
curr_Factors:  [101.67239813]
mat_Sqrt:  [[0.15]]
grads:  [0.10472915]
Stock Position:  0.10472915115734889
Bond Position:  [-8.57471923]


portfolio before change:  [2.15569777]
curr_Stock_Price:  102.46385862380546
curr_Factors:  [102.46385862]
mat_Sqrt:  [[0.15]]
grads:  [0.08377067]
Stock Position:  0.08377066883738764
Bond Position:  [-6.4277682]


portfolio before change:  [2.13935248]
curr_Stock_Price:  102.27353494393732
curr_Factors:  [102.27353494]
mat_Sqrt:  [[0.15]]
grads:  [-0.02295947]
Stock Position:  -0.022959467365529333
Bond Position:  [4.48749836]


portfolio before change:  [2.11280275]
curr_Stock_Price:  103.44212481097323
curr_Factors:  [103.44212481]
mat_Sqrt:  [[0.15]]
grads:  [-0.04999589]
Stock Position:  -0.04999589124758416
Bond Position:  [7.28448398]


portfolio before change:  [2.07367568]
curr_Stock_Price:  104.23383715738588
curr_Factors:  [104.23383716]
mat_Sqrt:  [[0.15]]
grads:  [0.11809473]
Stock Position:  0.11809473330273736
Bond Position:  [-10.23579152]


portfolio before change:  [2.20586189]
curr_Stock_Price:  105.35857796756322
curr_Factors:  [105.35857797]
mat_Sqrt:  [[0.15]]
grads:  [0.08873326]
Stock Position:  0.08873326402807541
Bond Position:  [-7.14294862]


portfolio before change:  [2.19588207]
curr_Stock_Price:  105.25113943768444
curr_Factors:  [105.25113944]
mat_Sqrt:  [[0.15]]
grads:  [-0.2136014]
Stock Position:  -0.21360139697226907
Bond Position:  [24.67767249]


portfolio before change:  [2.09326978]
curr_Stock_Price:  105.73875188293633
curr_Factors:  [105.73875188]
mat_Sqrt:  [[0.15]]
grads:  [-0.0449748]
Stock Position:  -0.04497480368480145
Bond Position:  [6.84884938]


portfolio before change:  [2.10616622]
curr_Stock_Price:  105.46152168855768
curr_Factors:  [105.46152169]
mat_Sqrt:  [[0.15]]
grads:  [-0.15050425]
Stock Position:  -0.15050424871937473
Bond Position:  [17.97857331]


portfolio before change:  [2.07710792]
curr_Stock_Price:  105.66206082264439
curr_Factors:  [105.66206082]
mat_Sqrt:  [[0.15]]
grads:  [-0.05071909]
Stock Position:  -0.05071909277466077
Bond Position:  [7.43619179]


portfolio before change:  [2.13546376]
curr_Stock_Price:  104.52065515917474
curr_Factors:  [104.52065516]
mat_Sqrt:  [[0.15]]
grads:  [-0.04359487]
Stock Position:  -0.04359486538123394
Bond Position:  [6.69202765]


portfolio before change:  [2.1554752]
curr_Stock_Price:  104.07121748580221
curr_Factors:  [104.07121749]
mat_Sqrt:  [[0.15]]
grads:  [0.02207956]
Stock Position:  0.02207955885744279
Bond Position:  [-0.14237138]


portfolio before change:  [2.15789359]
curr_Stock_Price:  104.1811513250711
curr_Factors:  [104.18115133]
mat_Sqrt:  [[0.15]]
grads:  [0.12267012]
Stock Position:  0.12267012288954209
Bond Position:  [-10.62202105]


portfolio before change:  [2.28298341]
curr_Stock_Price:  105.20628862788368
curr_Factors:  [105.20628863]
mat_Sqrt:  [[0.15]]
grads:  [0.08212739]
Stock Position:  0.08212738766290562
Bond Position:  [-6.35733424]


portfolio before change:  [2.329287]
curr_Stock_Price:  105.77492883385383
curr_Factors:  [105.77492883]
mat_Sqrt:  [[0.15]]
grads:  [0.03406243]
Stock Position:  0.034062431980568554
Bond Position:  [-1.27366432]


portfolio before change:  [2.33533759]
curr_Stock_Price:  105.95489831218495
curr_Factors:  [105.95489831]
mat_Sqrt:  [[0.15]]
grads:  [0.08633918]
Stock Position:  0.08633917764886602
Bond Position:  [-6.8127212]


portfolio before change:  [2.36500495]
curr_Stock_Price:  106.30344420517258
curr_Factors:  [106.30344421]
mat_Sqrt:  [[0.15]]
grads:  [0.07577536]
Stock Position:  0.07577535948524998
Bond Position:  [-5.69017675]


portfolio before change:  [2.36065616]
curr_Stock_Price:  106.25074714400816
curr_Factors:  [106.25074714]
mat_Sqrt:  [[0.15]]
grads:  [-0.05593179]
Stock Position:  -0.05593178749895132
Bond Position:  [8.30345037]


portfolio before change:  [2.32175638]
curr_Stock_Price:  106.95551209624011
curr_Factors:  [106.9555121]
mat_Sqrt:  [[0.15]]
grads:  [-0.0393407]
Stock Position:  -0.03934069674467819
Bond Position:  [6.52946075]


portfolio before change:  [2.32880896]
curr_Stock_Price:  106.78661623685352
curr_Factors:  [106.78661624]
mat_Sqrt:  [[0.15]]
grads:  [0.2542862]
Stock Position:  0.25428620497044757
Bond Position:  [-24.82555442]


portfolio before change:  [2.39950719]
curr_Stock_Price:  107.07074440978562
curr_Factors:  [107.07074441]
mat_Sqrt:  [[0.15]]
grads:  [0.00887244]
Stock Position:  0.008872440956971633
Bond Position:  [1.44952834]


portfolio before change:  [2.39974284]
curr_Stock_Price:  107.08709271799648
curr_Factors:  [107.08709272]
mat_Sqrt:  [[0.15]]
grads:  [-0.0876938]
Stock Position:  -0.08769380224481885
Bond Position:  [11.79061717]


portfolio before change:  [2.41045978]
curr_Stock_Price:  106.97328758820737
curr_Factors:  [106.97328759]
mat_Sqrt:  [[0.15]]
grads:  [0.01556431]
Stock Position:  0.015564314690137682
Bond Position:  [0.74549387]


portfolio before change:  [2.40992624]
curr_Stock_Price:  106.9360138219217
curr_Factors:  [106.93601382]
mat_Sqrt:  [[0.15]]
grads:  [-0.0510481]
Stock Position:  -0.05104810272026149
Bond Position:  [7.86880686]


portfolio before change:  [2.41561724]
curr_Stock_Price:  106.83416504867724
curr_Factors:  [106.83416505]
mat_Sqrt:  [[0.15]]
grads:  [0.00612564]
Stock Position:  0.0061256369290869
Bond Position:  [1.76118993]


portfolio before change:  [2.40862977]
curr_Stock_Price:  105.67550174379119
curr_Factors:  [105.67550174]
mat_Sqrt:  [[0.15]]
grads:  [-0.02793292]
Stock Position:  -0.027932924637759197
Bond Position:  [5.36045559]


portfolio before change:  [2.4234402]
curr_Stock_Price:  105.15728177862283
curr_Factors:  [105.15728178]
mat_Sqrt:  [[0.15]]
grads:  [0.04074486]
Stock Position:  0.040744858023006855
Bond Position:  [-1.86117831]


portfolio before change:  [2.40160854]
curr_Stock_Price:  104.62432274319912
curr_Factors:  [104.62432274]
mat_Sqrt:  [[0.15]]
grads:  [-0.04600376]
Stock Position:  -0.0460037555731377
Bond Position:  [7.21472031]


portfolio before change:  [2.33699785]
curr_Stock_Price:  106.03859036660003
curr_Factors:  [106.03859037]
mat_Sqrt:  [[0.15]]
grads:  [-0.40541617]
Stock Position:  -0.4054161661939741
Bond Position:  [45.32675662]


portfolio before change:  [2.25894042]
curr_Stock_Price:  106.23811482664954
curr_Factors:  [106.23811483]
mat_Sqrt:  [[0.15]]
grads:  [-0.03364249]
Stock Position:  -0.033642493447268516
Bond Position:  [5.8330555]


portfolio before change:  [2.25424955]
curr_Stock_Price:  106.38838461266714
curr_Factors:  [106.38838461]
mat_Sqrt:  [[0.15]]
grads:  [0.13303756]
Stock Position:  0.1330375619703151
Bond Position:  [-11.89940177]


portfolio before change:  [2.1800633]
curr_Stock_Price:  105.83634120719348
curr_Factors:  [105.83634121]
mat_Sqrt:  [[0.15]]
grads:  [-0.11039998]
Stock Position:  -0.11039997682056611
Bond Position:  [13.86439292]


portfolio before change:  [2.24426497]
curr_Stock_Price:  105.26265340013785
curr_Factors:  [105.2626534]
mat_Sqrt:  [[0.15]]
grads:  [-0.03751793]
Stock Position:  -0.03751792939402089
Bond Position:  [6.19350177]


portfolio before change:  [2.24486107]
curr_Stock_Price:  105.2570830521121
curr_Factors:  [105.25708305]
mat_Sqrt:  [[0.15]]
grads:  [0.01936647]
Stock Position:  0.01936646630116375
Bond Position:  [0.20640332]


portfolio before change:  [2.23783851]
curr_Stock_Price:  104.89380276580587
curr_Factors:  [104.89380277]
mat_Sqrt:  [[0.15]]
grads:  [-0.09052848]
Stock Position:  -0.09052848102012813
Bond Position:  [11.73371515]


portfolio before change:  [2.28194709]
curr_Stock_Price:  104.41466961907547
curr_Factors:  [104.41466962]
mat_Sqrt:  [[0.15]]
grads:  [0.07478196]
Stock Position:  0.07478195644988922
Bond Position:  [-5.52638619]


portfolio before change:  [2.28415126]
curr_Stock_Price:  104.44876318761489
curr_Factors:  [104.44876319]
mat_Sqrt:  [[0.15]]
grads:  [0.1139616]
Stock Position:  0.11396160257308573
Bond Position:  [-9.61899718]


portfolio before change:  [2.25258803]
curr_Stock_Price:  104.17707498326529
curr_Factors:  [104.17707498]
mat_Sqrt:  [[0.15]]
grads:  [-0.07347395]
Stock Position:  -0.0734739533829437
Bond Position:  [9.90688958]


portfolio before change:  [2.22178895]
curr_Stock_Price:  104.60468619473413
curr_Factors:  [104.60468619]
mat_Sqrt:  [[0.15]]
grads:  [-0.02748705]
Stock Position:  -0.02748704826603294
Bond Position:  [5.097063]


portfolio before change:  [2.22813191]
curr_Stock_Price:  104.38551418424255
curr_Factors:  [104.38551418]
mat_Sqrt:  [[0.15]]
grads:  [0.02310697]
Stock Position:  0.0231069727857119
Bond Position:  [-0.18390132]


portfolio before change:  [2.21399511]
curr_Stock_Price:  103.77421340249016
curr_Factors:  [103.7742134]
mat_Sqrt:  [[0.15]]
grads:  [0.01607712]
Stock Position:  0.01607711701920615
Bond Position:  [0.54560494]


portfolio before change:  [2.21820187]
curr_Stock_Price:  104.03375341885777
curr_Factors:  [104.03375342]
mat_Sqrt:  [[0.15]]
grads:  [0.00350855]
Stock Position:  0.0035085515321019068
Bond Position:  [1.85319408]


portfolio before change:  [2.21930546]
curr_Stock_Price:  104.31528469064543
curr_Factors:  [104.31528469]
mat_Sqrt:  [[0.15]]
grads:  [-0.05134956]
Stock Position:  -0.051349560283133366
Bond Position:  [7.57584946]


portfolio before change:  [2.21396845]
curr_Stock_Price:  104.42844081722855
curr_Factors:  [104.42844082]
mat_Sqrt:  [[0.15]]
grads:  [0.07312674]
Stock Position:  0.0731267354379367
Bond Position:  [-5.42254251]


portfolio before change:  [2.25883909]
curr_Stock_Price:  105.04667652960178
curr_Factors:  [105.04667653]
mat_Sqrt:  [[0.15]]
grads:  [-0.15768626]
Stock Position:  -0.15768625842588005
Bond Position:  [18.82325647]


portfolio before change:  [2.28630137]
curr_Stock_Price:  104.87997978512834
curr_Factors:  [104.87997979]
mat_Sqrt:  [[0.15]]
grads:  [-0.05509753]
Stock Position:  -0.055097532958681
Bond Position:  [8.06492951]


portfolio before change:  [2.32036847]
curr_Stock_Price:  104.27082311480208
curr_Factors:  [104.27082311]
mat_Sqrt:  [[0.15]]
grads:  [0.11215894]
Stock Position:  0.11215894320332312
Bond Position:  [-9.37453686]


portfolio before change:  [2.38585553]
curr_Stock_Price:  104.85992447031464
curr_Factors:  [104.85992447]
mat_Sqrt:  [[0.15]]
grads:  [-0.02236858]
Stock Position:  -0.02236857737118512
Bond Position:  [4.73142286]


portfolio before change:  [2.39743436]
curr_Stock_Price:  104.35550652699403
curr_Factors:  [104.35550653]
mat_Sqrt:  [[0.15]]
grads:  [0.08658026]
Stock Position:  0.0865802558302721
Bond Position:  [-6.63769209]


portfolio before change:  [2.50155306]
curr_Stock_Price:  105.56286680728168
curr_Factors:  [105.56286681]
mat_Sqrt:  [[0.15]]
grads:  [-0.09478505]
Stock Position:  -0.09478505201617897
Bond Position:  [12.50733488]


portfolio before change:  [2.46681341]
curr_Stock_Price:  105.93762397158123
curr_Factors:  [105.93762397]
mat_Sqrt:  [[0.15]]
grads:  [-0.0847456]
Stock Position:  -0.0847456038505852
Bond Position:  [11.44456133]


portfolio before change:  [2.47089847]
curr_Stock_Price:  105.89786085560232
curr_Factors:  [105.89786086]
mat_Sqrt:  [[0.15]]
grads:  [-0.01955548]
Stock Position:  -0.019555481837042962
Bond Position:  [4.54178216]


portfolio before change:  [2.47820067]
curr_Stock_Price:  105.53896780165499
curr_Factors:  [105.5389678]
mat_Sqrt:  [[0.15]]
grads:  [0.43644847]
Stock Position:  0.43644846966034945
Bond Position:  [-43.58412032]


portfolio before change:  [2.08077748]
curr_Stock_Price:  104.6346248551807
curr_Factors:  [104.63462486]
mat_Sqrt:  [[0.15]]
grads:  [-0.11352738]
Stock Position:  -0.11352738283582672
Bond Position:  [13.95967259]


portfolio before change:  [2.04169043]
curr_Stock_Price:  104.98660647087672
curr_Factors:  [104.98660647]
mat_Sqrt:  [[0.15]]
grads:  [0.09995117]
Stock Position:  0.09995117400928583
Bond Position:  [-8.45184414]


portfolio before change:  [2.12070176]
curr_Stock_Price:  105.78239089954674
curr_Factors:  [105.7823909]
mat_Sqrt:  [[0.15]]
grads:  [0.03471177]
Stock Position:  0.034711768995038486
Bond Position:  [-1.55119215]


portfolio before change:  [2.10291567]
curr_Stock_Price:  105.27279017063461
curr_Factors:  [105.27279017]
mat_Sqrt:  [[0.15]]
grads:  [0.08136911]
Stock Position:  0.08136911074856354
Bond Position:  [-6.46303765]


portfolio before change:  [2.02848742]
curr_Stock_Price:  104.36305557113998
curr_Factors:  [104.36305557]
mat_Sqrt:  [[0.15]]
grads:  [-0.14732638]
Stock Position:  -0.14732638118506125
Bond Position:  [17.40391873]


portfolio before change:  [2.06165234]
curr_Stock_Price:  104.14532713585746
curr_Factors:  [104.14532714]
mat_Sqrt:  [[0.15]]
grads:  [-0.05276943]
Stock Position:  -0.05276943483946586
Bond Position:  [7.5573424]


portfolio before change:  [2.04443444]
curr_Stock_Price:  104.48056377289905
curr_Factors:  [104.48056377]
mat_Sqrt:  [[0.15]]
grads:  [-0.04544154]
Stock Position:  -0.04544153657715817
Bond Position:  [6.7921918]


portfolio before change:  [2.05400346]
curr_Stock_Price:  104.27932738271953
curr_Factors:  [104.27932738]
mat_Sqrt:  [[0.15]]
grads:  [0.0424024]
Stock Position:  0.0424024021367381
Bond Position:  [-2.36769052]


portfolio before change:  [2.07609104]
curr_Stock_Price:  104.8037212937844
curr_Factors:  [104.80372129]
mat_Sqrt:  [[0.15]]
grads:  [0.04386808]
Stock Position:  0.04386808386020304
Bond Position:  [-2.5214474]


portfolio before change:  [2.07822593]
curr_Stock_Price:  104.8559801336877
curr_Factors:  [104.85598013]
mat_Sqrt:  [[0.15]]
grads:  [-0.0046114]
Stock Position:  -0.004611399025988382
Bond Position:  [2.5617587]


portfolio before change:  [2.07450451]
curr_Stock_Price:  105.69770736863597
curr_Factors:  [105.69770737]
mat_Sqrt:  [[0.15]]
grads:  [-0.00119001]
Stock Position:  -0.0011900124105896802
Bond Position:  [2.20028609]


portfolio before change:  [2.07401275]
curr_Stock_Price:  106.22650694055665
curr_Factors:  [106.22650694]
mat_Sqrt:  [[0.15]]
grads:  [0.04504888]
Stock Position:  0.04504887640908357
Bond Position:  [-2.71137203]


portfolio before change:  [2.11095291]
curr_Stock_Price:  107.0502704797852
curr_Factors:  [107.05027048]
mat_Sqrt:  [[0.15]]
grads:  [-0.01787107]
Stock Position:  -0.01787106895417509
Bond Position:  [4.02405568]


portfolio before change:  [2.11097132]
curr_Stock_Price:  107.06331386552039
curr_Factors:  [107.06331387]
mat_Sqrt:  [[0.15]]
grads:  [0.13538829]
Stock Position:  0.13538828668647082
Bond Position:  [-12.38414731]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.11097132]
Stock Price:  107.60629666120538
PL:  [-5.49532534]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.62173673e-02]
 [-6.68472754e-04]
 [ 1.16546655e-04]
 [ 6.49424247e-04]
 [-1.58606110e-02]
 [ 7.10954366e-03]
 [ 1.30515622e-03]
 [-4.40381460e-03]
 [ 6.91991949e-03]
 [ 1.56553791e-02]
 [ 1.05169070e-02]
 [-1.23046307e-02]
 [ 1.65409347e-02]
 [ 1.16566949e-02]
 [-4.15950708e-02]
 [ 2.35776973e-02]
 [-8.72286891e-03]
 [-2.62858767e-02]
 [-8.16157235e-02]
 [ 2.14007201e-02]
 [-9.13603333e-02]
 [-4.27478352e-02]
 [ 2.30575945e-03]
 [-4.21231472e-03]
 [-2.02478613e-02]
 [ 1.38870461e-02]
 [ 2.67644594e-02]
 [ 1.62514967e-01]
 [-2.10648978e-03]
 [ 2.91860299e-02]
 [-3.55978960e-03]
 [-6.67180260e-02]
 [ 2.47598904e-02]
 [ 1.13163128e-02]
 [-3.53522715e-02]
 [ 8.08953890e-03]
 [-2.00995986e-03]
 [ 3.18045078e-03]
 [ 3.15958807e-03]
 [-1.62008468e-02]
 [ 4.10032305e-02]
 [ 5.16243021e-04]
 [ 7.58298627e-03]
 [-9.26321916e-03]
 [ 2.47829442e-04]
 [-7.25005541e-03]
 [-1.36833540e-02]
 [-1.25656510e-03]
 [-9.28200175e-03]
 [ 8.10951210e-03]
 [-3.17355896e-03]
 [ 3.27393237e-03]
 [ 2.52313415e-03]
 [-7.89828619e-04]
 [ 1.42783670e-03]
 [ 9.04223792e-03]
 [ 1.54401199e-02]
 [-2.68384079e-02]
 [ 1.38398625e-02]
 [ 1.97864699e-03]
 [ 5.07025356e-03]
 [-1.46664514e-02]
 [-1.26585067e-02]
 [-1.29273058e-03]
 [-1.13212601e-02]
 [-1.31656026e-02]
 [ 9.95482927e-03]
 [ 2.37284541e-03]
 [ 1.12822792e-02]
 [-1.74736972e-02]
 [ 3.67720559e-03]
 [ 1.51891956e-03]
 [-1.44764852e-03]
 [ 7.67141260e-03]
 [-3.45865257e-03]
 [ 2.97260595e-03]
 [ 1.29793701e-02]
 [-1.41625759e-02]
 [-4.91543385e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.75021124]
curr_Stock_Price:  100.30102858921181
curr_Factors:  [100.30102859]
mat_Sqrt:  [[0.15]]
grads:  [-0.30811578]
Stock Position:  -0.3081157817196536
Bond Position:  [37.65454107]


portfolio before change:  [6.64152199]
curr_Stock_Price:  100.66142146237719
curr_Factors:  [100.66142146]
mat_Sqrt:  [[0.15]]
grads:  [-0.00445649]
Stock Position:  -0.00445648502818078
Bond Position:  [7.09011811]


portfolio before change:  [6.64434032]
curr_Stock_Price:  100.12844810933564
curr_Factors:  [100.12844811]
mat_Sqrt:  [[0.15]]
grads:  [0.00077698]
Stock Position:  0.0007769777001556822
Bond Position:  [6.56654275]


portfolio before change:  [6.64412726]
curr_Stock_Price:  99.32600206739605
curr_Factors:  [99.32600207]
mat_Sqrt:  [[0.15]]
grads:  [0.00432949]
Stock Position:  0.004329494981997134
Bond Position:  [6.21409584]


portfolio before change:  [6.64163591]
curr_Stock_Price:  98.66085648097517
curr_Factors:  [98.66085648]
mat_Sqrt:  [[0.15]]
grads:  [-0.10573741]
Stock Position:  -0.10573740661319239
Bond Position:  [17.07377901]


portfolio before change:  [6.62634579]
curr_Stock_Price:  98.81555355463254
curr_Factors:  [98.81555355]
mat_Sqrt:  [[0.15]]
grads:  [0.04739696]
Stock Position:  0.047396957712955254
Bond Position:  [1.94278918]


portfolio before change:  [6.59177857]
curr_Stock_Price:  98.08367850363214
curr_Factors:  [98.0836785]
mat_Sqrt:  [[0.15]]
grads:  [0.00870104]
Stock Position:  0.008701041480766137
Bond Position:  [5.73834841]


portfolio before change:  [6.5893287]
curr_Stock_Price:  97.76089798884917
curr_Factors:  [97.76089799]
mat_Sqrt:  [[0.15]]
grads:  [-0.02935876]
Stock Position:  -0.029358763991759046
Bond Position:  [9.45946783]


portfolio before change:  [6.58297785]
curr_Stock_Price:  97.99735491391415
curr_Factors:  [97.99735491]
mat_Sqrt:  [[0.15]]
grads:  [0.0461328]
Stock Position:  0.046132796621879725
Bond Position:  [2.06208581]


portfolio before change:  [6.57930902]
curr_Stock_Price:  97.91503368191614
curr_Factors:  [97.91503368]
mat_Sqrt:  [[0.15]]
grads:  [0.10436919]
Stock Position:  0.10436919432116355
Bond Position:  [-3.64000415]


portfolio before change:  [6.43713695]
curr_Stock_Price:  96.55501008612359
curr_Factors:  [96.55501009]
mat_Sqrt:  [[0.15]]
grads:  [0.07011271]
Stock Position:  0.07011271308556573
Bond Position:  [-0.33259677]


portfolio before change:  [6.46245131]
curr_Stock_Price:  96.91635895190342
curr_Factors:  [96.91635895]
mat_Sqrt:  [[0.15]]
grads:  [-0.08203087]
Stock Position:  -0.0820308712434908
Bond Position:  [14.41258467]


portfolio before change:  [6.53467859]
curr_Stock_Price:  96.04685139796507
curr_Factors:  [96.0468514]
mat_Sqrt:  [[0.15]]
grads:  [0.1102729]
Stock Position:  0.11027289779035734
Bond Position:  [-4.05668604]


portfolio before change:  [6.51972829]
curr_Stock_Price:  95.91357528043405
curr_Factors:  [95.91357528]
mat_Sqrt:  [[0.15]]
grads:  [0.0777113]
Stock Position:  0.07771129921474831
Bond Position:  [-0.93384025]


portfolio before change:  [6.53852119]
curr_Stock_Price:  96.15615599860486
curr_Factors:  [96.156156]
mat_Sqrt:  [[0.15]]
grads:  [-0.27730047]
Stock Position:  -0.27730047224075555
Bond Position:  [33.20266866]


portfolio before change:  [6.68587509]
curr_Stock_Price:  95.63225257973743
curr_Factors:  [95.63225258]
mat_Sqrt:  [[0.15]]
grads:  [0.15718465]
Stock Position:  0.15718464855106679
Bond Position:  [-8.34604692]


portfolio before change:  [6.50365576]
curr_Stock_Price:  94.47630199492828
curr_Factors:  [94.47630199]
mat_Sqrt:  [[0.15]]
grads:  [-0.05815246]
Stock Position:  -0.058152459409147365
Bond Position:  [11.99768507]


portfolio before change:  [6.49773452]
curr_Stock_Price:  94.59101960053398
curr_Factors:  [94.5910196]
mat_Sqrt:  [[0.15]]
grads:  [-0.17523918]
Stock Position:  -0.17523917813335724
Bond Position:  [23.07378706]


portfolio before change:  [6.49221592]
curr_Stock_Price:  94.630741119672
curr_Factors:  [94.63074112]
mat_Sqrt:  [[0.15]]
grads:  [-0.54410482]
Stock Position:  -0.5441048232900619
Bond Position:  [57.98125859]


portfolio before change:  [6.40436928]
curr_Stock_Price:  94.79885316878895
curr_Factors:  [94.79885317]
mat_Sqrt:  [[0.15]]
grads:  [0.14267147]
Stock Position:  0.14267146711845125
Bond Position:  [-7.12072218]


portfolio before change:  [6.35124227]
curr_Stock_Price:  94.42959960264324
curr_Factors:  [94.4295996]
mat_Sqrt:  [[0.15]]
grads:  [-0.60906889]
Stock Position:  -0.6090688888692165
Bond Position:  [63.86537358]


portfolio before change:  [6.68307381]
curr_Stock_Price:  93.8913356482847
curr_Factors:  [93.89133565]
mat_Sqrt:  [[0.15]]
grads:  [-0.28498557]
Stock Position:  -0.28498556772554995
Bond Position:  [33.44074941]


portfolio before change:  [6.70962255]
curr_Stock_Price:  93.80551157497035
curr_Factors:  [93.80551157]
mat_Sqrt:  [[0.15]]
grads:  [0.01537173]
Stock Position:  0.015371729678366308
Bond Position:  [5.26766958]


portfolio before change:  [6.69448414]
curr_Stock_Price:  92.79927176392192
curr_Factors:  [92.79927176]
mat_Sqrt:  [[0.15]]
grads:  [-0.0280821]
Stock Position:  -0.028082098121981876
Bond Position:  [9.3004824]


portfolio before change:  [6.70308846]
curr_Stock_Price:  92.51357297419476
curr_Factors:  [92.51357297]
mat_Sqrt:  [[0.15]]
grads:  [-0.13498574]
Stock Position:  -0.13498574223503446
Bond Position:  [19.19110177]


portfolio before change:  [6.75058612]
curr_Stock_Price:  92.17058729016507
curr_Factors:  [92.17058729]
mat_Sqrt:  [[0.15]]
grads:  [0.09258031]
Stock Position:  0.09258030725569313
Bond Position:  [-1.78259517]


portfolio before change:  [6.77505586]
curr_Stock_Price:  92.43609899158523
curr_Factors:  [92.43609899]
mat_Sqrt:  [[0.15]]
grads:  [0.17842973]
Stock Position:  0.1784297293643963
Bond Position:  [-9.71829227]


portfolio before change:  [6.84660239]
curr_Stock_Price:  92.84048196511762
curr_Factors:  [92.84048197]
mat_Sqrt:  [[0.15]]
grads:  [1.08343311]
Stock Position:  1.0834331119956704
Bond Position:  [-93.7398499]


portfolio before change:  [6.8314302]
curr_Stock_Price:  92.8318858920582
curr_Factors:  [92.83188589]
mat_Sqrt:  [[0.15]]
grads:  [-0.01404327]
Stock Position:  -0.014043265214473457
Bond Position:  [8.13509299]


portfolio before change:  [6.83143056]
curr_Stock_Price:  92.86806650852164
curr_Factors:  [92.86806651]
mat_Sqrt:  [[0.15]]
grads:  [0.19457353]
Stock Position:  0.19457353252562312
Bond Position:  [-11.2382372]


portfolio before change:  [7.01035895]
curr_Stock_Price:  93.79126917282335
curr_Factors:  [93.79126917]
mat_Sqrt:  [[0.15]]
grads:  [-0.02373193]
Stock Position:  -0.023731930673385585
Bond Position:  [9.23620685]


portfolio before change:  [7.0019058]
curr_Stock_Price:  94.17178745420127
curr_Factors:  [94.17178745]
mat_Sqrt:  [[0.15]]
grads:  [-0.44478684]
Stock Position:  -0.44478684023512677
Bond Position:  [48.88827758]


portfolio before change:  [6.75098002]
curr_Stock_Price:  94.74280568714826
curr_Factors:  [94.74280569]
mat_Sqrt:  [[0.15]]
grads:  [0.16506594]
Stock Position:  0.16506593572294695
Bond Position:  [-8.88782986]


portfolio before change:  [6.79990425]
curr_Stock_Price:  95.04256309941282
curr_Factors:  [95.0425631]
mat_Sqrt:  [[0.15]]
grads:  [0.07544209]
Stock Position:  0.07544208529018318
Bond Position:  [-0.3703049]


portfolio before change:  [6.82735479]
curr_Stock_Price:  95.40673232111507
curr_Factors:  [95.40673232]
mat_Sqrt:  [[0.15]]
grads:  [-0.23568181]
Stock Position:  -0.23568180992308407
Bond Position:  [29.31298614]


portfolio before change:  [6.54509087]
curr_Stock_Price:  96.61215431757695
curr_Factors:  [96.61215432]
mat_Sqrt:  [[0.15]]
grads:  [0.05393026]
Stock Position:  0.053930259353266376
Bond Position:  [1.33477233]


portfolio before change:  [6.5452396]
curr_Stock_Price:  96.61336526419815
curr_Factors:  [96.61336526]
mat_Sqrt:  [[0.15]]
grads:  [-0.01339973]
Stock Position:  -0.013399732380431819
Bond Position:  [7.83983284]


portfolio before change:  [6.53337683]
curr_Stock_Price:  97.53523258165566
curr_Factors:  [97.53523258]
mat_Sqrt:  [[0.15]]
grads:  [0.02120301]
Stock Position:  0.021203005173279582
Bond Position:  [4.46533679]


portfolio before change:  [6.55018744]
curr_Stock_Price:  98.31491063900187
curr_Factors:  [98.31491064]
mat_Sqrt:  [[0.15]]
grads:  [0.02106392]
Stock Position:  0.021063920461905195
Bond Position:  [4.47928998]


portfolio before change:  [6.52461798]
curr_Stock_Price:  97.08772090868831
curr_Factors:  [97.08772091]
mat_Sqrt:  [[0.15]]
grads:  [-0.10800565]
Stock Position:  -0.10800564516674277
Bond Position:  [17.01063991]


portfolio before change:  [6.50897729]
curr_Stock_Price:  97.24237843614098
curr_Factors:  [97.24237844]
mat_Sqrt:  [[0.15]]
grads:  [0.27335487]
Stock Position:  0.2733548702654514
Bond Position:  [-20.07270045]


portfolio before change:  [6.39771266]
curr_Stock_Price:  96.83993435346278
curr_Factors:  [96.83993435]
mat_Sqrt:  [[0.15]]
grads:  [0.00344162]
Stock Position:  0.0034416201377269915
Bond Position:  [6.06442639]


portfolio before change:  [6.39574856]
curr_Stock_Price:  96.15911037591508
curr_Factors:  [96.15911038]
mat_Sqrt:  [[0.15]]
grads:  [0.05055324]
Stock Position:  0.050553241830514885
Bond Position:  [1.5345938]


portfolio before change:  [6.41671108]
curr_Stock_Price:  96.57187536751097
curr_Factors:  [96.57187537]
mat_Sqrt:  [[0.15]]
grads:  [-0.06175479]
Stock Position:  -0.061754794410332214
Bond Position:  [12.38048739]


portfolio before change:  [6.38457539]
curr_Stock_Price:  97.10478129492584
curr_Factors:  [97.10478129]
mat_Sqrt:  [[0.15]]
grads:  [0.0016522]
Stock Position:  0.0016521962829659142
Bond Position:  [6.22413923]


portfolio before change:  [6.38497811]
curr_Stock_Price:  97.1130691705753
curr_Factors:  [97.11306917]
mat_Sqrt:  [[0.15]]
grads:  [-0.0483337]
Stock Position:  -0.04833370274485411
Bond Position:  [11.07881232]


portfolio before change:  [6.3299681]
curr_Stock_Price:  98.26552491394264
curr_Factors:  [98.26552491]
mat_Sqrt:  [[0.15]]
grads:  [-0.09122236]
Stock Position:  -0.0912223600981104
Bond Position:  [15.2939812]


portfolio before change:  [6.3076953]
curr_Stock_Price:  98.52016318345474
curr_Factors:  [98.52016318]
mat_Sqrt:  [[0.15]]
grads:  [-0.0083771]
Stock Position:  -0.008377100687160424
Bond Position:  [7.13300863]


portfolio before change:  [6.30246611]
curr_Stock_Price:  99.19760779519798
curr_Factors:  [99.1976078]
mat_Sqrt:  [[0.15]]
grads:  [-0.06188001]
Stock Position:  -0.06188001168207399
Bond Position:  [12.44081523]


portfolio before change:  [6.35251555]
curr_Stock_Price:  98.40135929582632
curr_Factors:  [98.4013593]
mat_Sqrt:  [[0.15]]
grads:  [0.05406341]
Stock Position:  0.05406341401050806
Bond Position:  [1.03260212]


portfolio before change:  [6.34993707]
curr_Stock_Price:  98.35247200962729
curr_Factors:  [98.35247201]
mat_Sqrt:  [[0.15]]
grads:  [-0.02115706]
Stock Position:  -0.021157059703308508
Bond Position:  [8.4307862]


portfolio before change:  [6.3434337]
curr_Stock_Price:  98.68476386101187
curr_Factors:  [98.68476386]
mat_Sqrt:  [[0.15]]
grads:  [0.02182622]
Stock Position:  0.021826215802870353
Bond Position:  [4.18951874]


portfolio before change:  [6.34968434]
curr_Stock_Price:  98.9591491177351
curr_Factors:  [98.95914912]
mat_Sqrt:  [[0.15]]
grads:  [0.01682089]
Stock Position:  0.01682089430486587
Bond Position:  [4.68510295]


portfolio before change:  [6.35586579]
curr_Stock_Price:  99.30922708520303
curr_Factors:  [99.30922709]
mat_Sqrt:  [[0.15]]
grads:  [-0.00526552]
Stock Position:  -0.005265524127848557
Bond Position:  [6.87878092]


portfolio before change:  [6.35839322]
curr_Stock_Price:  98.91088372784883
curr_Factors:  [98.91088373]
mat_Sqrt:  [[0.15]]
grads:  [0.00951891]
Stock Position:  0.009518911311330777
Bond Position:  [5.41686929]


portfolio before change:  [6.35843339]
curr_Stock_Price:  98.87953656263974
curr_Factors:  [98.87953656]
mat_Sqrt:  [[0.15]]
grads:  [0.06028159]
Stock Position:  0.06028158614730399
Bond Position:  [0.39781809]


portfolio before change:  [6.34409359]
curr_Stock_Price:  98.64124379600136
curr_Factors:  [98.6412438]
mat_Sqrt:  [[0.15]]
grads:  [0.10293413]
Stock Position:  0.1029341329050972
Bond Position:  [-3.80945731]


portfolio before change:  [6.40383158]
curr_Stock_Price:  99.22390852543768
curr_Factors:  [99.22390853]
mat_Sqrt:  [[0.15]]
grads:  [-0.17892272]
Stock Position:  -0.17892271903466192
Bond Position:  [24.15724309]


portfolio before change:  [6.53524239]
curr_Stock_Price:  98.49789155224049
curr_Factors:  [98.49789155]
mat_Sqrt:  [[0.15]]
grads:  [0.09226575]
Stock Position:  0.09226574982628329
Bond Position:  [-2.55273944]


portfolio before change:  [6.50597254]
curr_Stock_Price:  98.18238662142312
curr_Factors:  [98.18238662]
mat_Sqrt:  [[0.15]]
grads:  [0.01319098]
Stock Position:  0.013190979902608323
Bond Position:  [5.21085065]


portfolio before change:  [6.51365035]
curr_Stock_Price:  98.73974678887423
curr_Factors:  [98.73974679]
mat_Sqrt:  [[0.15]]
grads:  [0.03380169]
Stock Position:  0.033801690430002446
Bond Position:  [3.17608]


portfolio before change:  [6.50197624]
curr_Stock_Price:  98.38850345207089
curr_Factors:  [98.38850345]
mat_Sqrt:  [[0.15]]
grads:  [-0.09777634]
Stock Position:  -0.0977763426264569
Bond Position:  [16.12204427]


portfolio before change:  [6.54114771]
curr_Stock_Price:  97.99818602888006
curr_Factors:  [97.99818603]
mat_Sqrt:  [[0.15]]
grads:  [-0.08439004]
Stock Position:  -0.08439004474715614
Bond Position:  [14.81121902]


portfolio before change:  [6.49312552]
curr_Stock_Price:  98.57820613917775
curr_Factors:  [98.57820614]
mat_Sqrt:  [[0.15]]
grads:  [-0.0086182]
Stock Position:  -0.008618203862709969
Bond Position:  [7.3426926]


portfolio before change:  [6.49528978]
curr_Stock_Price:  98.38033074957656
curr_Factors:  [98.38033075]
mat_Sqrt:  [[0.15]]
grads:  [-0.07547507]
Stock Position:  -0.07547506740110242
Bond Position:  [13.92055188]


portfolio before change:  [6.52554824]
curr_Stock_Price:  97.99095191742508
curr_Factors:  [97.99095192]
mat_Sqrt:  [[0.15]]
grads:  [-0.08777068]
Stock Position:  -0.08777068367799287
Bond Position:  [15.12628108]


portfolio before change:  [6.57679202]
curr_Stock_Price:  97.4178862661455
curr_Factors:  [97.41788627]
mat_Sqrt:  [[0.15]]
grads:  [0.06636553]
Stock Position:  0.06636552847910915
Bond Position:  [0.11160252]


portfolio before change:  [6.612188]
curr_Stock_Price:  97.95113001452667
curr_Factors:  [97.95113001]
mat_Sqrt:  [[0.15]]
grads:  [0.01581897]
Stock Position:  0.015818969370187654
Bond Position:  [5.06270208]


portfolio before change:  [6.60142368]
curr_Stock_Price:  97.25065771652909
curr_Factors:  [97.25065772]
mat_Sqrt:  [[0.15]]
grads:  [0.07521519]
Stock Position:  0.07521519442242187
Bond Position:  [-0.71330345]


portfolio before change:  [6.62142925]
curr_Stock_Price:  97.51722826648194
curr_Factors:  [97.51722827]
mat_Sqrt:  [[0.15]]
grads:  [-0.11649131]
Stock Position:  -0.11649131444212996
Bond Position:  [17.98133936]


portfolio before change:  [6.62581366]
curr_Stock_Price:  97.4892387596666
curr_Factors:  [97.48923876]
mat_Sqrt:  [[0.15]]
grads:  [0.0245147]
Stock Position:  0.024514703964025615
Bond Position:  [4.23589383]


portfolio before change:  [6.61094552]
curr_Stock_Price:  96.87194028433822
curr_Factors:  [96.87194028]
mat_Sqrt:  [[0.15]]
grads:  [0.01012613]
Stock Position:  0.010126130398345323
Bond Position:  [5.63000762]


portfolio before change:  [6.60877785]
curr_Stock_Price:  96.62312276463088
curr_Factors:  [96.62312276]
mat_Sqrt:  [[0.15]]
grads:  [-0.00965099]
Stock Position:  -0.009650990121235128
Bond Position:  [7.54128665]


portfolio before change:  [6.61220455]
curr_Stock_Price:  96.31689957845744
curr_Factors:  [96.31689958]
mat_Sqrt:  [[0.15]]
grads:  [0.05114275]
Stock Position:  0.051142750678534236
Bond Position:  [1.68629337]


portfolio before change:  [6.59616847]
curr_Stock_Price:  96.00128346673122
curr_Factors:  [96.00128347]
mat_Sqrt:  [[0.15]]
grads:  [-0.02305768]
Stock Position:  -0.023057683777887365
Bond Position:  [8.80973571]


portfolio before change:  [6.5965231]
curr_Stock_Price:  96.00978351458635
curr_Factors:  [96.00978351]
mat_Sqrt:  [[0.15]]
grads:  [0.01981737]
Stock Position:  0.01981737302025034
Bond Position:  [4.69386141]


portfolio before change:  [6.57738194]
curr_Stock_Price:  95.02910145833002
curr_Factors:  [95.02910146]
mat_Sqrt:  [[0.15]]
grads:  [0.08652913]
Stock Position:  0.08652913415404749
Bond Position:  [-1.64540393]


portfolio before change:  [6.54193581]
curr_Stock_Price:  94.62064615240095
curr_Factors:  [94.62064615]
mat_Sqrt:  [[0.15]]
grads:  [-0.09441717]
Stock Position:  -0.09441717287661926
Bond Position:  [15.47574972]


portfolio before change:  [6.52993207]
curr_Stock_Price:  94.75802594861452
curr_Factors:  [94.75802595]
mat_Sqrt:  [[0.15]]
grads:  [-0.32769559]
Stock Position:  -0.327695589674338
Bond Position:  [37.58171925]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.52993207]
Stock Price:  93.37111662412269
PL:  [6.52993207]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.43355312e-02]
 [ 2.09538736e-03]
 [-5.28380825e-04]
 [-9.35750069e-04]
 [ 4.60926010e-03]
 [ 8.26619352e-03]
 [ 1.22762296e-03]
 [ 8.07318152e-03]
 [-1.94254515e-03]
 [-2.03763824e-02]
 [ 1.02416810e-02]
 [-5.34603210e-03]
 [-8.91786358e-03]
 [ 4.36284191e-03]
 [ 2.00682629e-03]
 [-5.80600265e-03]
 [ 1.18004049e-02]
 [ 1.00057670e-02]
 [ 2.19430323e-02]
 [ 3.30445635e-03]
 [ 7.94781951e-02]
 [-1.31530683e-02]
 [ 3.11612135e-03]
 [ 9.57521998e-03]
 [ 1.33391726e-02]
 [-7.83021989e-03]
 [ 1.31686679e-02]
 [ 7.78939955e-04]
 [ 2.30324335e-03]
 [-1.83437849e-02]
 [-3.99831845e-03]
 [ 3.66573526e-03]
 [ 1.57960283e-02]
 [ 1.90670315e-02]
 [-1.40447048e-02]
 [ 6.51029493e-03]
 [-2.59298676e-03]
 [ 4.69425862e-03]
 [ 3.89985660e-03]
 [-1.51133605e-02]
 [ 3.91510470e-02]
 [ 3.10275226e-04]
 [ 6.37908582e-03]
 [-9.18921646e-03]
 [ 2.21717438e-04]
 [-7.26823241e-03]
 [-1.36260133e-02]
 [-8.85344289e-04]
 [-5.75881502e-03]
 [ 4.01963413e-03]
 [-3.77486855e-03]
 [ 2.89472874e-03]
 [ 3.55887215e-03]
 [ 5.81696355e-05]
 [ 6.39767925e-03]
 [ 8.94001558e-03]
 [ 1.19476022e-02]
 [ 2.36904203e-03]
 [ 1.35117646e-02]
 [-9.00472048e-04]
 [ 1.62589807e-03]
 [-1.79575767e-02]
 [-1.27009737e-02]
 [-1.14661761e-03]
 [-9.93942651e-03]
 [-1.92487140e-02]
 [ 1.01475474e-02]
 [ 2.28727155e-03]
 [ 8.35972754e-03]
 [-1.47241689e-02]
 [-5.58381967e-03]
 [-2.73282300e-03]
 [ 2.29370691e-03]
 [ 8.56904805e-03]
 [ 6.73451957e-03]
 [-1.09504524e-02]
 [ 1.53041506e-04]
 [-6.29292152e-03]
 [ 1.00669631e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.31337663]
curr_Stock_Price:  100.01587030220331
curr_Factors:  [100.0158703]
mat_Sqrt:  [[0.15]]
grads:  [-0.22890354]
Stock Position:  -0.22890354136069851
Bond Position:  [25.20736353]


portfolio before change:  [2.44154342]
curr_Stock_Price:  99.46283698942246
curr_Factors:  [99.46283699]
mat_Sqrt:  [[0.15]]
grads:  [0.01396925]
Stock Position:  0.013969249075014943
Bond Position:  [1.05212228]


portfolio before change:  [2.43896213]
curr_Stock_Price:  99.27334582139493
curr_Factors:  [99.27334582]
mat_Sqrt:  [[0.15]]
grads:  [-0.00352254]
Stock Position:  -0.003522538834595879
Bond Position:  [2.78865635]


portfolio before change:  [2.44094153]
curr_Stock_Price:  98.76090193357287
curr_Factors:  [98.76090193]
mat_Sqrt:  [[0.15]]
grads:  [-0.00623833]
Stock Position:  -0.0062383337924245535
Bond Position:  [3.057045]


portfolio before change:  [2.43634475]
curr_Stock_Price:  99.52839037755712
curr_Factors:  [99.52839038]
mat_Sqrt:  [[0.15]]
grads:  [0.0307284]
Stock Position:  0.030728400695862586
Bond Position:  [-0.62200351]


portfolio before change:  [2.42066996]
curr_Stock_Price:  99.01954787749696
curr_Factors:  [99.01954788]
mat_Sqrt:  [[0.15]]
grads:  [0.05510796]
Stock Position:  0.0551079568055258
Bond Position:  [-3.03609501]


portfolio before change:  [2.49239188]
curr_Stock_Price:  100.32447164078157
curr_Factors:  [100.32447164]
mat_Sqrt:  [[0.15]]
grads:  [0.00818415]
Stock Position:  0.008184153074689298
Bond Position:  [1.67132105]


portfolio before change:  [2.49800428]
curr_Stock_Price:  100.99747192812926
curr_Factors:  [100.99747193]
mat_Sqrt:  [[0.15]]
grads:  [0.05382121]
Stock Position:  0.053821210110978304
Bond Position:  [-2.93780188]


portfolio before change:  [2.49015777]
curr_Stock_Price:  100.85509516431718
curr_Factors:  [100.85509516]
mat_Sqrt:  [[0.15]]
grads:  [-0.0129503]
Stock Position:  -0.012950301023307319
Bond Position:  [3.79626161]


portfolio before change:  [2.49060832]
curr_Stock_Price:  100.83862642534577
curr_Factors:  [100.83862643]
mat_Sqrt:  [[0.15]]
grads:  [-0.13584255]
Stock Position:  -0.1358425490035861
Bond Position:  [16.18878437]


portfolio before change:  [2.52624367]
curr_Stock_Price:  100.58374664800711
curr_Factors:  [100.58374665]
mat_Sqrt:  [[0.15]]
grads:  [0.06827787]
Stock Position:  0.0682778734752059
Bond Position:  [-4.34140066]


portfolio before change:  [2.50679529]
curr_Stock_Price:  100.30287916168923
curr_Factors:  [100.30287916]
mat_Sqrt:  [[0.15]]
grads:  [-0.03564021]
Stock Position:  -0.03564021403306106
Bond Position:  [6.08161137]


portfolio before change:  [2.51501279]
curr_Stock_Price:  100.0829762722641
curr_Factors:  [100.08297627]
mat_Sqrt:  [[0.15]]
grads:  [-0.05945242]
Stock Position:  -0.05945242387620836
Bond Position:  [8.46518832]


portfolio before change:  [2.53919505]
curr_Stock_Price:  99.68512577406199
curr_Factors:  [99.68512577]
mat_Sqrt:  [[0.15]]
grads:  [0.02908561]
Stock Position:  0.029085612731232568
Bond Position:  [-0.36020791]


portfolio before change:  [2.53552804]
curr_Stock_Price:  99.55982307934586
curr_Factors:  [99.55982308]
mat_Sqrt:  [[0.15]]
grads:  [0.01337884]
Stock Position:  0.013378841962085296
Bond Position:  [1.2035329]


portfolio before change:  [2.54755869]
curr_Stock_Price:  100.45343025355253
curr_Factors:  [100.45343025]
mat_Sqrt:  [[0.15]]
grads:  [-0.03870668]
Stock Position:  -0.03870668432174994
Bond Position:  [6.4357779]


portfolio before change:  [2.55537108]
curr_Stock_Price:  100.26198664996512
curr_Factors:  [100.26198665]
mat_Sqrt:  [[0.15]]
grads:  [0.07866937]
Stock Position:  0.07866936616933345
Bond Position:  [-5.33217586]


portfolio before change:  [2.53263338]
curr_Stock_Price:  99.97719435651149
curr_Factors:  [99.97719436]
mat_Sqrt:  [[0.15]]
grads:  [0.06670511]
Stock Position:  0.06670511308337276
Bond Position:  [-4.13635667]


portfolio before change:  [2.57683121]
curr_Stock_Price:  100.64365540461216
curr_Factors:  [100.6436554]
mat_Sqrt:  [[0.15]]
grads:  [0.14628688]
Stock Position:  0.1462868816840352
Bond Position:  [-12.1460153]


portfolio before change:  [2.53236688]
curr_Stock_Price:  100.34489191527135
curr_Factors:  [100.34489192]
mat_Sqrt:  [[0.15]]
grads:  [0.02202971]
Stock Position:  0.022029708995374608
Bond Position:  [0.32179812]


portfolio before change:  [2.53755812]
curr_Stock_Price:  100.57962609964784
curr_Factors:  [100.5796261]
mat_Sqrt:  [[0.15]]
grads:  [0.52985463]
Stock Position:  0.5298546339532033
Bond Position:  [-50.75502285]


portfolio before change:  [2.71917729]
curr_Stock_Price:  100.92838487457324
curr_Factors:  [100.92838487]
mat_Sqrt:  [[0.15]]
grads:  [-0.08768712]
Stock Position:  -0.08768712183099789
Bond Position:  [11.56929687]


portfolio before change:  [2.72330247]
curr_Stock_Price:  100.8895869857193
curr_Factors:  [100.88958699]
mat_Sqrt:  [[0.15]]
grads:  [0.02077414]
Stock Position:  0.02077414234257394
Bond Position:  [0.62740783]


portfolio before change:  [2.71079351]
curr_Stock_Price:  100.28555872195227
curr_Factors:  [100.28555872]
mat_Sqrt:  [[0.15]]
grads:  [0.0638348]
Stock Position:  0.06383479984859604
Bond Position:  [-3.69091506]


portfolio before change:  [2.699462]
curr_Stock_Price:  100.1116595653243
curr_Factors:  [100.11165957]
mat_Sqrt:  [[0.15]]
grads:  [0.08892782]
Stock Position:  0.08892781753017732
Bond Position:  [-6.20324939]


portfolio before change:  [2.70913182]
curr_Stock_Price:  100.22475724144252
curr_Factors:  [100.22475724]
mat_Sqrt:  [[0.15]]
grads:  [-0.05220147]
Stock Position:  -0.05220146594595926
Bond Position:  [7.94101107]


portfolio before change:  [2.70151101]
curr_Stock_Price:  100.38025360330826
curr_Factors:  [100.3802536]
mat_Sqrt:  [[0.15]]
grads:  [0.08779112]
Stock Position:  0.0877911191519285
Bond Position:  [-6.1109838]


portfolio before change:  [2.68172288]
curr_Stock_Price:  100.15920410520597
curr_Factors:  [100.15920411]
mat_Sqrt:  [[0.15]]
grads:  [0.00519293]
Stock Position:  0.005192933036175079
Bond Position:  [2.16160284]


portfolio before change:  [2.67615086]
curr_Stock_Price:  99.06018630889871
curr_Factors:  [99.06018631]
mat_Sqrt:  [[0.15]]
grads:  [0.01535496]
Stock Position:  0.015354955688869371
Bond Position:  [1.15508608]


portfolio before change:  [2.6830473]
curr_Stock_Price:  99.50461900635537
curr_Factors:  [99.50461901]
mat_Sqrt:  [[0.15]]
grads:  [-0.1222919]
Stock Position:  -0.12229189906910777
Bond Position:  [14.85165612]


portfolio before change:  [2.70651559]
curr_Stock_Price:  99.32030556596072
curr_Factors:  [99.32030557]
mat_Sqrt:  [[0.15]]
grads:  [-0.02665546]
Stock Position:  -0.02665545630521463
Bond Position:  [5.35394366]


portfolio before change:  [2.68910118]
curr_Stock_Price:  99.9861746297556
curr_Factors:  [99.98617463]
mat_Sqrt:  [[0.15]]
grads:  [0.02443824]
Stock Position:  0.024438235038816564
Bond Position:  [0.24561555]


portfolio before change:  [2.67544252]
curr_Stock_Price:  99.4266410863303
curr_Factors:  [99.42664109]
mat_Sqrt:  [[0.15]]
grads:  [0.10530686]
Stock Position:  0.10530685550114864
Bond Position:  [-7.7948644]


portfolio before change:  [2.70259405]
curr_Stock_Price:  99.68910004663701
curr_Factors:  [99.68910005]
mat_Sqrt:  [[0.15]]
grads:  [0.12711354]
Stock Position:  0.1271135433155368
Bond Position:  [-9.96924068]


portfolio before change:  [2.59530823]
curr_Stock_Price:  98.84998629033012
curr_Factors:  [98.84998629]
mat_Sqrt:  [[0.15]]
grads:  [-0.09363137]
Stock Position:  -0.09363136566269877
Bond Position:  [11.85076745]


portfolio before change:  [2.62820749]
curr_Stock_Price:  98.50652706462907
curr_Factors:  [98.50652706]
mat_Sqrt:  [[0.15]]
grads:  [0.04340197]
Stock Position:  0.043401966179801584
Bond Position:  [-1.64716947]


portfolio before change:  [2.60536322]
curr_Stock_Price:  97.98255734862133
curr_Factors:  [97.98255735]
mat_Sqrt:  [[0.15]]
grads:  [-0.01728658]
Stock Position:  -0.01728657838816322
Bond Position:  [4.29914638]


portfolio before change:  [2.60917968]
curr_Stock_Price:  97.7773255156338
curr_Factors:  [97.77732552]
mat_Sqrt:  [[0.15]]
grads:  [0.03129506]
Stock Position:  0.03129505747764889
Bond Position:  [-0.45076734]


portfolio before change:  [2.61245328]
curr_Stock_Price:  97.88283020895712
curr_Factors:  [97.88283021]
mat_Sqrt:  [[0.15]]
grads:  [0.02599904]
Stock Position:  0.0259990440268814
Bond Position:  [0.06759327]


portfolio before change:  [2.61228521]
curr_Stock_Price:  97.87620299180408
curr_Factors:  [97.87620299]
mat_Sqrt:  [[0.15]]
grads:  [-0.10075574]
Stock Position:  -0.10075573646872323
Bond Position:  [12.47387412]


portfolio before change:  [2.65997444]
curr_Stock_Price:  97.41062555870212
curr_Factors:  [97.41062556]
mat_Sqrt:  [[0.15]]
grads:  [0.26100698]
Stock Position:  0.26100697970705905
Bond Position:  [-22.76487872]


portfolio before change:  [2.55131452]
curr_Stock_Price:  96.99976653835036
curr_Factors:  [96.99976654]
mat_Sqrt:  [[0.15]]
grads:  [0.0020685]
Stock Position:  0.002068501506343092
Bond Position:  [2.35067036]


portfolio before change:  [2.55102232]
curr_Stock_Price:  96.7874756610714
curr_Factors:  [96.78747566]
mat_Sqrt:  [[0.15]]
grads:  [0.04252724]
Stock Position:  0.042527238805837544
Bond Position:  [-1.56508177]


portfolio before change:  [2.54556054]
curr_Stock_Price:  96.66134578218086
curr_Factors:  [96.66134578]
mat_Sqrt:  [[0.15]]
grads:  [-0.06126144]
Stock Position:  -0.06126144306331892
Bond Position:  [8.46717408]


portfolio before change:  [2.51987868]
curr_Stock_Price:  97.08920182592666
curr_Factors:  [97.08920183]
mat_Sqrt:  [[0.15]]
grads:  [0.00147812]
Stock Position:  0.0014781162556607031
Bond Position:  [2.37636955]


portfolio before change:  [2.52005605]
curr_Stock_Price:  97.1087111461252
curr_Factors:  [97.10871115]
mat_Sqrt:  [[0.15]]
grads:  [-0.04845488]
Stock Position:  -0.04845488272145907
Bond Position:  [7.22544726]


portfolio before change:  [2.48274558]
curr_Stock_Price:  97.888035590652
curr_Factors:  [97.88803559]
mat_Sqrt:  [[0.15]]
grads:  [-0.09084009]
Stock Position:  -0.09084008865357007
Bond Position:  [11.37490341]


portfolio before change:  [2.49038164]
curr_Stock_Price:  97.81180153989555
curr_Factors:  [97.81180154]
mat_Sqrt:  [[0.15]]
grads:  [-0.0059023]
Stock Position:  -0.005902295260623407
Bond Position:  [3.06769577]


portfolio before change:  [2.48971186]
curr_Stock_Price:  97.95776471628479
curr_Factors:  [97.95776472]
mat_Sqrt:  [[0.15]]
grads:  [-0.0383921]
Stock Position:  -0.038392100114097175
Bond Position:  [6.25051617]


portfolio before change:  [2.5061584]
curr_Stock_Price:  97.5395568555485
curr_Factors:  [97.53955686]
mat_Sqrt:  [[0.15]]
grads:  [0.02679756]
Stock Position:  0.02679756086580387
Bond Position:  [-0.10766381]


portfolio before change:  [2.48181459]
curr_Stock_Price:  96.63137413243996
curr_Factors:  [96.63137413]
mat_Sqrt:  [[0.15]]
grads:  [-0.02516579]
Stock Position:  -0.025165790352722265
Bond Position:  [4.9136195]


portfolio before change:  [2.49327655]
curr_Stock_Price:  96.18811959681753
curr_Factors:  [96.1881196]
mat_Sqrt:  [[0.15]]
grads:  [0.01929819]
Stock Position:  0.01929819156951658
Bond Position:  [0.6370198]


portfolio before change:  [2.49611096]
curr_Stock_Price:  96.33293044260503
curr_Factors:  [96.33293044]
mat_Sqrt:  [[0.15]]
grads:  [0.02372581]
Stock Position:  0.02372581433227288
Bond Position:  [0.21053374]


portfolio before change:  [2.4955001]
curr_Stock_Price:  96.30662912616003
curr_Factors:  [96.30662913]
mat_Sqrt:  [[0.15]]
grads:  [0.0003878]
Stock Position:  0.00038779757010240154
Bond Position:  [2.45815262]


portfolio before change:  [2.4956963]
curr_Stock_Price:  96.41638895490287
curr_Factors:  [96.41638895]
mat_Sqrt:  [[0.15]]
grads:  [0.0426512]
Stock Position:  0.04265119501604739
Bond Position:  [-1.61657791]


portfolio before change:  [2.54772639]
curr_Stock_Price:  97.63865546087361
curr_Factors:  [97.63865546]
mat_Sqrt:  [[0.15]]
grads:  [0.0596001]
Stock Position:  0.05960010389375327
Bond Position:  [-3.27154762]


portfolio before change:  [2.52937968]
curr_Stock_Price:  97.33425621323597
curr_Factors:  [97.33425621]
mat_Sqrt:  [[0.15]]
grads:  [0.07965068]
Stock Position:  0.07965068151561314
Bond Position:  [-5.22336016]


portfolio before change:  [2.5194753]
curr_Stock_Price:  97.21400725380828
curr_Factors:  [97.21400725]
mat_Sqrt:  [[0.15]]
grads:  [0.01579361]
Stock Position:  0.015793613521371815
Bond Position:  [0.98411484]


portfolio before change:  [2.51322782]
curr_Stock_Price:  96.81454263305733
curr_Factors:  [96.81454263]
mat_Sqrt:  [[0.15]]
grads:  [0.09007843]
Stock Position:  0.09007843072915502
Bond Position:  [-6.20767425]


portfolio before change:  [2.54479171]
curr_Stock_Price:  97.1692544213218
curr_Factors:  [97.16925442]
mat_Sqrt:  [[0.15]]
grads:  [-0.00600315]
Stock Position:  -0.006003146988776109
Bond Position:  [3.12811303]


portfolio before change:  [2.5447754]
curr_Stock_Price:  97.20454037628639
curr_Factors:  [97.20454038]
mat_Sqrt:  [[0.15]]
grads:  [0.01083932]
Stock Position:  0.010839320455157444
Bond Position:  [1.49114423]


portfolio before change:  [2.54113372]
curr_Stock_Price:  96.85997313474482
curr_Factors:  [96.85997313]
mat_Sqrt:  [[0.15]]
grads:  [-0.11971718]
Stock Position:  -0.11971717804265862
Bond Position:  [14.13693637]


portfolio before change:  [2.47033987]
curr_Stock_Price:  97.45869619265484
curr_Factors:  [97.45869619]
mat_Sqrt:  [[0.15]]
grads:  [-0.08467316]
Stock Position:  -0.0846731578008747
Bond Position:  [10.72247543]


portfolio before change:  [2.47873303]
curr_Stock_Price:  97.36748687502829
curr_Factors:  [97.36748688]
mat_Sqrt:  [[0.15]]
grads:  [-0.00764412]
Stock Position:  -0.007644117403368337
Bond Position:  [3.22302153]


portfolio before change:  [2.47906049]
curr_Stock_Price:  97.35100102116647
curr_Factors:  [97.35100102]
mat_Sqrt:  [[0.15]]
grads:  [-0.06626284]
Stock Position:  -0.06626284343155461
Bond Position:  [8.92981463]


portfolio before change:  [2.46327532]
curr_Stock_Price:  97.5976446299342
curr_Factors:  [97.59764463]
mat_Sqrt:  [[0.15]]
grads:  [-0.12832476]
Stock Position:  -0.12832475993188033
Bond Position:  [14.98746963]


portfolio before change:  [2.4657122]
curr_Stock_Price:  97.58595449310866
curr_Factors:  [97.58595449]
mat_Sqrt:  [[0.15]]
grads:  [0.06765032]
Stock Position:  0.06765031627342051
Bond Position:  [-4.13600849]


portfolio before change:  [2.46972403]
curr_Stock_Price:  97.64907823738854
curr_Factors:  [97.64907824]
mat_Sqrt:  [[0.15]]
grads:  [0.01524848]
Stock Position:  0.015248476977944594
Bond Position:  [0.98072431]


portfolio before change:  [2.48514844]
curr_Stock_Price:  98.6565962566283
curr_Factors:  [98.65659626]
mat_Sqrt:  [[0.15]]
grads:  [0.05573152]
Stock Position:  0.055731516942174625
Bond Position:  [-3.01313332]


portfolio before change:  [2.52900349]
curr_Stock_Price:  99.44687386943603
curr_Factors:  [99.44687387]
mat_Sqrt:  [[0.15]]
grads:  [-0.09816113]
Stock Position:  -0.09816112592375108
Bond Position:  [12.29082059]


portfolio before change:  [2.52514384]
curr_Stock_Price:  99.49401928022111
curr_Factors:  [99.49401928]
mat_Sqrt:  [[0.15]]
grads:  [-0.03722546]
Stock Position:  -0.03722546449388144
Bond Position:  [6.22885492]


portfolio before change:  [2.47694554]
curr_Stock_Price:  100.79924439840839
curr_Factors:  [100.7992444]
mat_Sqrt:  [[0.15]]
grads:  [-0.01821882]
Stock Position:  -0.018218819979580015
Bond Position:  [4.31338883]


portfolio before change:  [2.47220861]
curr_Stock_Price:  101.07404426289114
curr_Factors:  [101.07404426]
mat_Sqrt:  [[0.15]]
grads:  [0.01529138]
Stock Position:  0.015291379396313916
Bond Position:  [0.92664705]


portfolio before change:  [2.46960234]
curr_Stock_Price:  100.89981587800095
curr_Factors:  [100.89981588]
mat_Sqrt:  [[0.15]]
grads:  [0.05712699]
Stock Position:  0.057126987007201174
Bond Position:  [-3.29450014]


portfolio before change:  [2.48408341]
curr_Stock_Price:  101.15690954845567
curr_Factors:  [101.15690955]
mat_Sqrt:  [[0.15]]
grads:  [0.0448968]
Stock Position:  0.04489679715388968
Bond Position:  [-2.05753784]


portfolio before change:  [2.49655233]
curr_Stock_Price:  101.43749788821941
curr_Factors:  [101.43749789]
mat_Sqrt:  [[0.15]]
grads:  [-0.07300302]
Stock Position:  -0.07300301597021608
Bond Position:  [9.90179561]


portfolio before change:  [2.54789061]
curr_Stock_Price:  100.74274028143381
curr_Factors:  [100.74274028]
mat_Sqrt:  [[0.15]]
grads:  [0.00102028]
Stock Position:  0.0010202767092427323
Bond Position:  [2.44510514]


portfolio before change:  [2.54877669]
curr_Stock_Price:  101.4614209781555
curr_Factors:  [101.46142098]
mat_Sqrt:  [[0.15]]
grads:  [-0.04195281]
Stock Position:  -0.04195281014390306
Bond Position:  [6.80536842]


portfolio before change:  [2.56964787]
curr_Stock_Price:  100.97406776076066
curr_Factors:  [100.97406776]
mat_Sqrt:  [[0.15]]
grads:  [0.06711309]
Stock Position:  0.06711308704406324
Bond Position:  [-4.20703353]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.56964787]
Stock Price:  101.26190828097597
PL:  [1.30773959]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-8.05630331e-02]
 [ 8.81025461e-04]
 [ 4.94180081e-04]
 [ 2.52139169e-03]
 [ 4.88704391e-03]
 [ 1.18839899e-02]
 [ 1.35328553e-04]
 [ 8.62693107e-03]
 [-3.48995886e-04]
 [-2.00575099e-02]
 [ 1.02391726e-02]
 [-7.50836630e-03]
 [-1.28584378e-03]
 [ 4.28408941e-03]
 [ 5.06780203e-03]
 [ 1.32579570e-02]
 [ 2.26946192e-04]
 [ 3.75252357e-03]
 [ 1.83012284e-02]
 [ 1.34928380e-02]
 [ 1.95439873e-02]
 [-1.73307440e-02]
 [-1.12048774e-03]
 [ 8.44565744e-03]
 [ 2.87415532e-03]
 [ 1.13323551e-02]
 [ 1.30704576e-02]
 [-1.12981489e-02]
 [ 1.55278207e-03]
 [-6.49369598e-03]
 [-3.63939005e-03]
 [-1.52708475e-02]
 [ 1.57944630e-02]
 [ 1.89112668e-02]
 [-1.49616691e-02]
 [ 6.66076431e-03]
 [-2.22072757e-03]
 [ 1.16437821e-02]
 [ 1.13101581e-03]
 [-1.40994277e-02]
 [ 3.68163531e-04]
 [-2.90794731e-03]
 [ 7.05136546e-03]
 [-1.49484620e-02]
 [ 2.09400591e-03]
 [-1.05385228e-03]
 [-1.37075930e-02]
 [-5.15168663e-03]
 [-8.28163889e-04]
 [ 2.36083883e-03]
 [-2.98543986e-03]
 [ 3.59731496e-03]
 [ 4.05045075e-04]
 [ 3.39967132e-03]
 [ 1.45494627e-03]
 [ 8.52385339e-03]
 [-3.45524151e-03]
 [-1.34196141e-02]
 [ 1.49675309e-02]
 [ 1.21258468e-03]
 [ 1.30865749e-02]
 [-1.45503187e-02]
 [-1.27380826e-02]
 [-2.97593831e-03]
 [ 8.00661234e-02]
 [-1.47532933e-02]
 [ 1.20947167e-02]
 [ 5.03952577e-03]
 [ 1.21424896e-02]
 [-2.48738827e-02]
 [-7.89588155e-03]
 [-6.47848845e-03]
 [ 8.38300002e-03]
 [ 6.41566423e-03]
 [-6.32392501e-04]
 [-3.76654350e-03]
 [ 7.50725894e-03]
 [-3.69121438e-03]
 [ 2.19333316e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.51481298]
curr_Stock_Price:  100.86433532454555
curr_Factors:  [100.86433532]
mat_Sqrt:  [[0.15]]
grads:  [-0.53708689]
Stock Position:  -0.5370868873907922
Bond Position:  [69.68772489]


portfolio before change:  [15.45532301]
curr_Stock_Price:  100.98320918546827
curr_Factors:  [100.98320919]
mat_Sqrt:  [[0.15]]
grads:  [0.0058735]
Stock Position:  0.005873503072709128
Bond Position:  [14.86219782]


portfolio before change:  [15.45423553]
curr_Stock_Price:  100.63990430542309
curr_Factors:  [100.63990431]
mat_Sqrt:  [[0.15]]
grads:  [0.00329453]
Stock Position:  0.003294533871859605
Bond Position:  [15.12267395]


portfolio before change:  [15.45621659]
curr_Stock_Price:  100.95432540343295
curr_Factors:  [100.9543254]
mat_Sqrt:  [[0.15]]
grads:  [0.01680928]
Stock Position:  0.01680927790384561
Bond Position:  [13.75924728]


portfolio before change:  [15.45726261]
curr_Stock_Price:  100.9653927796345
curr_Factors:  [100.96539278]
mat_Sqrt:  [[0.15]]
grads:  [0.03258029]
Stock Position:  0.032580292731423724
Bond Position:  [12.16778056]


portfolio before change:  [15.4521989]
curr_Stock_Price:  100.78662763935264
curr_Factors:  [100.78662764]
mat_Sqrt:  [[0.15]]
grads:  [0.0792266]
Stock Position:  0.0792265992111092
Bond Position:  [7.46721714]


portfolio before change:  [15.49681471]
curr_Stock_Price:  101.34387859444077
curr_Factors:  [101.34387859]
mat_Sqrt:  [[0.15]]
grads:  [0.00090219]
Stock Position:  0.0009021903563682202
Bond Position:  [15.40538324]


portfolio before change:  [15.49736097]
curr_Stock_Price:  100.88210217545334
curr_Factors:  [100.88210218]
mat_Sqrt:  [[0.15]]
grads:  [0.05751287]
Stock Position:  0.05751287379573272
Bond Position:  [9.69534136]


portfolio before change:  [15.48865648]
curr_Stock_Price:  100.7202172970291
curr_Factors:  [100.7202173]
mat_Sqrt:  [[0.15]]
grads:  [-0.00232664]
Stock Position:  -0.0023266392417995276
Bond Position:  [15.72299609]


portfolio before change:  [15.48888489]
curr_Stock_Price:  101.04442114939233
curr_Factors:  [101.04442115]
mat_Sqrt:  [[0.15]]
grads:  [-0.13371673]
Stock Position:  -0.1337167328807998
Bond Position:  [29.00021476]


portfolio before change:  [15.51921778]
curr_Stock_Price:  100.83113210753402
curr_Factors:  [100.83113211]
mat_Sqrt:  [[0.15]]
grads:  [0.06826115]
Stock Position:  0.06826115065606665
Bond Position:  [8.63636868]


portfolio before change:  [15.54181247]
curr_Stock_Price:  101.15422810838045
curr_Factors:  [101.15422811]
mat_Sqrt:  [[0.15]]
grads:  [-0.05005578]
Stock Position:  -0.05005577534798614
Bond Position:  [20.60516579]


portfolio before change:  [15.5707661]
curr_Stock_Price:  100.60152938296316
curr_Factors:  [100.60152938]
mat_Sqrt:  [[0.15]]
grads:  [-0.00857229]
Stock Position:  -0.008572291856733482
Bond Position:  [16.43315177]


portfolio before change:  [15.57767059]
curr_Stock_Price:  99.91590261077027
curr_Factors:  [99.91590261]
mat_Sqrt:  [[0.15]]
grads:  [0.0285606]
Stock Position:  0.028560596099140412
Bond Position:  [12.72401286]


portfolio before change:  [15.57926366]
curr_Stock_Price:  99.94383580424964
curr_Factors:  [99.9438358]
mat_Sqrt:  [[0.15]]
grads:  [0.03378535]
Stock Position:  0.033785346868554916
Bond Position:  [12.2026265]


portfolio before change:  [15.54863046]
curr_Stock_Price:  99.01456047886471
curr_Factors:  [99.01456048]
mat_Sqrt:  [[0.15]]
grads:  [0.08838638]
Stock Position:  0.0883863800251863
Bond Position:  [6.79709189]


portfolio before change:  [15.57050864]
curr_Stock_Price:  99.25728284241484
curr_Factors:  [99.25728284]
mat_Sqrt:  [[0.15]]
grads:  [0.00151297]
Stock Position:  0.0015129746127357172
Bond Position:  [15.42033489]


portfolio before change:  [15.57016285]
curr_Stock_Price:  98.39171090680324
curr_Factors:  [98.39171091]
mat_Sqrt:  [[0.15]]
grads:  [0.02501682]
Stock Position:  0.025016823781081172
Bond Position:  [13.10871476]


portfolio before change:  [15.58313986]
curr_Stock_Price:  98.87769141514269
curr_Factors:  [98.87769142]
mat_Sqrt:  [[0.15]]
grads:  [0.12200819]
Stock Position:  0.12200818910374811
Bond Position:  [3.51925179]


portfolio before change:  [15.55363809]
curr_Stock_Price:  98.63408702901239
curr_Factors:  [98.63408703]
mat_Sqrt:  [[0.15]]
grads:  [0.08995225]
Stock Position:  0.08995225339230618
Bond Position:  [6.6812797]


portfolio before change:  [15.52931871]
curr_Stock_Price:  98.35908588290978
curr_Factors:  [98.35908588]
mat_Sqrt:  [[0.15]]
grads:  [0.13029325]
Stock Position:  0.1302932483911332
Bond Position:  [2.7137939]


portfolio before change:  [15.62093069]
curr_Stock_Price:  99.06090550063337
curr_Factors:  [99.0609055]
mat_Sqrt:  [[0.15]]
grads:  [-0.11553829]
Stock Position:  -0.11553829313630071
Bond Position:  [27.06625863]


portfolio before change:  [15.66823927]
curr_Stock_Price:  98.66608497857689
curr_Factors:  [98.66608498]
mat_Sqrt:  [[0.15]]
grads:  [-0.00746992]
Stock Position:  -0.0074699182832617915
Bond Position:  [16.40526686]


portfolio before change:  [15.67484595]
curr_Stock_Price:  97.91891268470013
curr_Factors:  [97.91891268]
mat_Sqrt:  [[0.15]]
grads:  [0.05630438]
Stock Position:  0.05630438293398286
Bond Position:  [10.16158199]


portfolio before change:  [15.69247832]
curr_Stock_Price:  98.22079421193688
curr_Factors:  [98.22079421]
mat_Sqrt:  [[0.15]]
grads:  [0.01916104]
Stock Position:  0.019161035444288408
Bond Position:  [13.8104662]


portfolio before change:  [15.69186028]
curr_Stock_Price:  98.143490250447
curr_Factors:  [98.14349025]
mat_Sqrt:  [[0.15]]
grads:  [0.07554903]
Stock Position:  0.07554903372030129
Bond Position:  [8.27721442]


portfolio before change:  [15.73035661]
curr_Stock_Price:  98.64619681758722
curr_Factors:  [98.64619682]
mat_Sqrt:  [[0.15]]
grads:  [0.08713638]
Stock Position:  0.08713638386219158
Bond Position:  [7.13468374]


portfolio before change:  [15.75145491]
curr_Stock_Price:  98.88320876395886
curr_Factors:  [98.88320876]
mat_Sqrt:  [[0.15]]
grads:  [-0.07532099]
Stock Position:  -0.07532099271257621
Bond Position:  [23.19943636]


portfolio before change:  [15.80868759]
curr_Stock_Price:  98.14260955694031
curr_Factors:  [98.14260956]
mat_Sqrt:  [[0.15]]
grads:  [0.01035188]
Stock Position:  0.010351880457024006
Bond Position:  [14.79272703]


portfolio before change:  [15.80885029]
curr_Stock_Price:  98.06901243654369
curr_Factors:  [98.06901244]
mat_Sqrt:  [[0.15]]
grads:  [-0.04329131]
Stock Position:  -0.043291306554046526
Bond Position:  [20.05438597]


portfolio before change:  [15.80354009]
curr_Stock_Price:  98.22062803139653
curr_Factors:  [98.22062803]
mat_Sqrt:  [[0.15]]
grads:  [-0.0242626]
Stock Position:  -0.024262600350755392
Bond Position:  [18.18662794]


portfolio before change:  [15.80102393]
curr_Stock_Price:  98.37118353706775
curr_Factors:  [98.37118354]
mat_Sqrt:  [[0.15]]
grads:  [-0.10180565]
Stock Position:  -0.10180564987887049
Bond Position:  [25.8157662]


portfolio before change:  [15.71118872]
curr_Stock_Price:  99.26945136635028
curr_Factors:  [99.26945137]
mat_Sqrt:  [[0.15]]
grads:  [0.10529642]
Stock Position:  0.10529642029986741
Bond Position:  [5.25847085]


portfolio before change:  [15.6475676]
curr_Stock_Price:  98.66212029005052
curr_Factors:  [98.66212029]
mat_Sqrt:  [[0.15]]
grads:  [0.12607511]
Stock Position:  0.12607511230502852
Bond Position:  [3.2087297]


portfolio before change:  [15.65209538]
curr_Stock_Price:  98.69644289580144
curr_Factors:  [98.6964429]
mat_Sqrt:  [[0.15]]
grads:  [-0.09974446]
Stock Position:  -0.09974446097125063
Bond Position:  [25.49651887]


portfolio before change:  [15.6852565]
curr_Stock_Price:  98.37995872966417
curr_Factors:  [98.37995873]
mat_Sqrt:  [[0.15]]
grads:  [0.0444051]
Stock Position:  0.044405095366936376
Bond Position:  [11.31668505]


portfolio before change:  [15.74455671]
curr_Stock_Price:  99.69946701706414
curr_Factors:  [99.69946702]
mat_Sqrt:  [[0.15]]
grads:  [-0.01480485]
Stock Position:  -0.014804850463099775
Bond Position:  [17.22059241]


portfolio before change:  [15.74544737]
curr_Stock_Price:  99.71200712786774
curr_Factors:  [99.71200713]
mat_Sqrt:  [[0.15]]
grads:  [0.07762521]
Stock Position:  0.07762521410752056
Bond Position:  [8.00528147]


portfolio before change:  [15.70577896]
curr_Stock_Price:  99.19453656434693
curr_Factors:  [99.19453656]
mat_Sqrt:  [[0.15]]
grads:  [0.00754011]
Stock Position:  0.007540105401850746
Bond Position:  [14.9578417]


portfolio before change:  [15.70301275]
curr_Stock_Price:  98.70368092494914
curr_Factors:  [98.70368092]
mat_Sqrt:  [[0.15]]
grads:  [-0.09399618]
Stock Position:  -0.0939961846693472
Bond Position:  [24.98078217]


portfolio before change:  [15.64423726]
curr_Stock_Price:  99.345588218286
curr_Factors:  [99.34558822]
mat_Sqrt:  [[0.15]]
grads:  [0.00245442]
Stock Position:  0.0024544235381415472
Bond Position:  [15.40040111]


portfolio before change:  [15.64689913]
curr_Stock_Price:  100.03793477598312
curr_Factors:  [100.03793478]
mat_Sqrt:  [[0.15]]
grads:  [-0.01938632]
Stock Position:  -0.019386315406107538
Bond Position:  [17.58626608]


portfolio before change:  [15.64013057]
curr_Stock_Price:  100.44377422208092
curr_Factors:  [100.44377422]
mat_Sqrt:  [[0.15]]
grads:  [0.0470091]
Stock Position:  0.0470091030736344
Bond Position:  [10.91835883]


portfolio before change:  [15.65867106]
curr_Stock_Price:  100.82365964853871
curr_Factors:  [100.82365965]
mat_Sqrt:  [[0.15]]
grads:  [-0.09965641]
Stock Position:  -0.09965641320785773
Bond Position:  [25.70639535]


portfolio before change:  [15.68128292]
curr_Stock_Price:  100.61288388030796
curr_Factors:  [100.61288388]
mat_Sqrt:  [[0.15]]
grads:  [0.01396004]
Stock Position:  0.013960039389881941
Bond Position:  [14.2767231]


portfolio before change:  [15.67402384]
curr_Stock_Price:  100.0289742259475
curr_Factors:  [100.02897423]
mat_Sqrt:  [[0.15]]
grads:  [-0.00702568]
Stock Position:  -0.007025681851793503
Bond Position:  [16.37679559]


portfolio before change:  [15.67173642]
curr_Stock_Price:  100.50024586263704
curr_Factors:  [100.50024586]
mat_Sqrt:  [[0.15]]
grads:  [-0.09138395]
Stock Position:  -0.09138395313040301
Bond Position:  [24.85584617]


portfolio before change:  [15.68238472]
curr_Stock_Price:  100.40072329962383
curr_Factors:  [100.4007233]
mat_Sqrt:  [[0.15]]
grads:  [-0.03434458]
Stock Position:  -0.03434457754091416
Bond Position:  [19.13060515]


portfolio before change:  [15.65314875]
curr_Stock_Price:  101.2867923511934
curr_Factors:  [101.28679235]
mat_Sqrt:  [[0.15]]
grads:  [-0.00552109]
Stock Position:  -0.005521092593302394
Bond Position:  [16.21236251]


portfolio before change:  [15.65505606]
curr_Stock_Price:  101.1248680137854
curr_Factors:  [101.12486801]
mat_Sqrt:  [[0.15]]
grads:  [0.01573893]
Stock Position:  0.01573892554691883
Bond Position:  [14.06345929]


portfolio before change:  [15.65658874]
curr_Stock_Price:  101.1664011668001
curr_Factors:  [101.16640117]
mat_Sqrt:  [[0.15]]
grads:  [-0.01990293]
Stock Position:  -0.01990293240543704
Bond Position:  [17.67009678]


portfolio before change:  [15.63326623]
curr_Stock_Price:  102.39370380743634
curr_Factors:  [102.39370381]
mat_Sqrt:  [[0.15]]
grads:  [0.0239821]
Stock Position:  0.02398209973010952
Bond Position:  [13.17765022]


portfolio before change:  [15.62281702]
curr_Stock_Price:  101.92365160793567
curr_Factors:  [101.92365161]
mat_Sqrt:  [[0.15]]
grads:  [0.0027003]
Stock Position:  0.002700300497116779
Bond Position:  [15.34759254]


portfolio before change:  [15.62557112]
curr_Stock_Price:  102.58833402635534
curr_Factors:  [102.58833403]
mat_Sqrt:  [[0.15]]
grads:  [0.02266448]
Stock Position:  0.0226644754471144
Bond Position:  [13.30046034]


portfolio before change:  [15.60017971]
curr_Stock_Price:  101.43133760545578
curr_Factors:  [101.43133761]
mat_Sqrt:  [[0.15]]
grads:  [0.00969964]
Stock Position:  0.00969964180083542
Bond Position:  [14.61633207]


portfolio before change:  [15.60228231]
curr_Stock_Price:  101.55392477080879
curr_Factors:  [101.55392477]
mat_Sqrt:  [[0.15]]
grads:  [0.05682569]
Stock Position:  0.05682568927342224
Bond Position:  [9.83141053]


portfolio before change:  [15.57343496]
curr_Stock_Price:  101.0354651060241
curr_Factors:  [101.03546511]
mat_Sqrt:  [[0.15]]
grads:  [-0.02303494]
Stock Position:  -0.02303494341553389
Bond Position:  [17.90078118]


portfolio before change:  [15.5453721]
curr_Stock_Price:  102.30230968849511
curr_Factors:  [102.30230969]
mat_Sqrt:  [[0.15]]
grads:  [-0.08946409]
Stock Position:  -0.08946409420301696
Bond Position:  [24.69775557]


portfolio before change:  [15.47483241]
curr_Stock_Price:  103.1080335033534
curr_Factors:  [103.1080335]
mat_Sqrt:  [[0.15]]
grads:  [0.09978354]
Stock Position:  0.09978353935433319
Bond Position:  [5.18634789]


portfolio before change:  [15.49365206]
curr_Stock_Price:  103.29338969734516
curr_Factors:  [103.2933897]
mat_Sqrt:  [[0.15]]
grads:  [0.0080839]
Stock Position:  0.008083897850733393
Bond Position:  [14.65863885]


portfolio before change:  [15.51212139]
curr_Stock_Price:  105.46476006232479
curr_Factors:  [105.46476006]
mat_Sqrt:  [[0.15]]
grads:  [0.08724383]
Stock Position:  0.08724383255725383
Bond Position:  [6.31097153]


portfolio before change:  [15.45608477]
curr_Stock_Price:  104.81793986222665
curr_Factors:  [104.81793986]
mat_Sqrt:  [[0.15]]
grads:  [-0.09700212]
Stock Position:  -0.09700212457604575
Bond Position:  [25.62364763]


portfolio before change:  [15.4390032]
curr_Stock_Price:  105.0105449383345
curr_Factors:  [105.01054494]
mat_Sqrt:  [[0.15]]
grads:  [-0.08492055]
Stock Position:  -0.08492055090563377
Bond Position:  [24.35655652]


portfolio before change:  [15.37945269]
curr_Stock_Price:  105.72972116074432
curr_Factors:  [105.72972116]
mat_Sqrt:  [[0.15]]
grads:  [-0.01983959]
Stock Position:  -0.019839588709990738
Bond Position:  [17.47708687]


portfolio before change:  [15.37472918]
curr_Stock_Price:  106.0228654216962
curr_Factors:  [106.02286542]
mat_Sqrt:  [[0.15]]
grads:  [0.53377416]
Stock Position:  0.5337741559826871
Bond Position:  [-41.21753633]


portfolio before change:  [15.48924124]
curr_Stock_Price:  106.2422245599382
curr_Factors:  [106.24222456]
mat_Sqrt:  [[0.15]]
grads:  [-0.09835529]
Stock Position:  -0.09835528870879057
Bond Position:  [25.93872591]


portfolio before change:  [15.5576963]
curr_Stock_Price:  105.5627101450934
curr_Factors:  [105.56271015]
mat_Sqrt:  [[0.15]]
grads:  [0.08063144]
Stock Position:  0.0806314444610299
Bond Position:  [7.0460225]


portfolio before change:  [15.55785389]
curr_Stock_Price:  105.55920284565883
curr_Factors:  [105.55920285]
mat_Sqrt:  [[0.15]]
grads:  [0.03359684]
Stock Position:  0.03359683844215338
Bond Position:  [12.0113984]


portfolio before change:  [15.54749883]
curr_Stock_Price:  105.22864209511869
curr_Factors:  [105.2286421]
mat_Sqrt:  [[0.15]]
grads:  [0.08094993]
Stock Position:  0.0809499308785392
Bond Position:  [7.02924752]


portfolio before change:  [15.56807792]
curr_Stock_Price:  105.47743476799883
curr_Factors:  [105.47743477]
mat_Sqrt:  [[0.15]]
grads:  [-0.16582588]
Stock Position:  -0.16582588460510442
Bond Position:  [33.05896685]


portfolio before change:  [15.5162082]
curr_Stock_Price:  105.80269142116332
curr_Factors:  [105.80269142]
mat_Sqrt:  [[0.15]]
grads:  [-0.05263921]
Stock Position:  -0.052639210333304785
Bond Position:  [21.08557832]


portfolio before change:  [15.55793639]
curr_Stock_Price:  105.03500693042619
curr_Factors:  [105.03500693]
mat_Sqrt:  [[0.15]]
grads:  [-0.04318992]
Stock Position:  -0.04318992299019188
Bond Position:  [20.09439025]


portfolio before change:  [15.5550278]
curr_Stock_Price:  105.13143052013945
curr_Factors:  [105.13143052]
mat_Sqrt:  [[0.15]]
grads:  [0.05588667]
Stock Position:  0.05588666680421808
Bond Position:  [9.67958258]


portfolio before change:  [15.54865122]
curr_Stock_Price:  105.00650663719433
curr_Factors:  [105.00650664]
mat_Sqrt:  [[0.15]]
grads:  [0.04277109]
Stock Position:  0.042771094892815234
Bond Position:  [11.05740796]


portfolio before change:  [15.5154929]
curr_Stock_Price:  104.21509767525765
curr_Factors:  [104.21509768]
mat_Sqrt:  [[0.15]]
grads:  [-0.00421595]
Stock Position:  -0.0042159500062740815
Bond Position:  [15.95485854]


portfolio before change:  [15.51521075]
curr_Stock_Price:  104.51855515206718
curr_Factors:  [104.51855515]
mat_Sqrt:  [[0.15]]
grads:  [-0.02511029]
Stock Position:  -0.025110290009076476
Bond Position:  [18.13970198]


portfolio before change:  [15.49084894]
curr_Stock_Price:  105.53389875154707
curr_Factors:  [105.53389875]
mat_Sqrt:  [[0.15]]
grads:  [0.05004839]
Stock Position:  0.050048392941443594
Bond Position:  [10.20904691]


portfolio before change:  [15.46093216]
curr_Stock_Price:  104.92339232528634
curr_Factors:  [104.92339233]
mat_Sqrt:  [[0.15]]
grads:  [-0.0246081]
Stock Position:  -0.024608095856009423
Bond Position:  [18.04289706]


portfolio before change:  [15.43578144]
curr_Stock_Price:  105.99126996320244
curr_Factors:  [105.99126996]
mat_Sqrt:  [[0.15]]
grads:  [0.14622221]
Stock Position:  0.14622221069450628
Bond Position:  [-0.06249637]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.43578144]
Stock Price:  105.78320412527314
PL:  [9.65257732]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.48509185e-02]
 [ 2.92602592e-03]
 [-6.82574847e-04]
 [ 2.15871533e-03]
 [ 8.55685683e-03]
 [ 1.19172978e-02]
 [ 1.22906066e-03]
 [ 1.03202656e-02]
 [-3.31524108e-03]
 [-1.96049117e-02]
 [ 1.01728031e-02]
 [-8.21273970e-03]
 [ 2.37022393e-02]
 [ 7.61430464e-03]
 [-1.00583057e-02]
 [-7.13424095e-03]
 [ 1.57338231e-02]
 [ 2.37449024e-02]
 [ 4.77606543e-03]
 [-2.44559477e-03]
 [ 6.45836408e-02]
 [-1.28053308e-02]
 [ 6.91690658e-03]
 [ 6.32789817e-03]
 [ 1.26768416e-02]
 [-3.16240665e-03]
 [ 1.36816258e-02]
 [-2.80621736e-03]
 [ 2.39141196e-03]
 [-1.14646352e-02]
 [-3.61506232e-03]
 [-1.84632671e-02]
 [ 1.62006461e-02]
 [ 1.35782908e-02]
 [-1.67094992e-02]
 [ 7.16811666e-03]
 [-2.84994764e-03]
 [-8.37802033e-04]
 [ 6.54927231e-03]
 [-1.66835082e-02]
 [ 4.25584696e-02]
 [ 3.63810622e-04]
 [ 6.58737331e-03]
 [-8.58562149e-03]
 [ 8.23169663e-04]
 [-8.42806157e-03]
 [-1.35151431e-02]
 [-6.31442915e-04]
 [-3.62814609e-03]
 [ 5.70201616e-03]
 [-3.18358052e-03]
 [ 3.24023421e-03]
 [ 2.80606537e-03]
 [ 8.43618954e-04]
 [ 1.44009778e-03]
 [ 9.03935581e-03]
 [ 1.51593857e-02]
 [-2.41003200e-02]
 [ 1.39513993e-02]
 [ 3.65978702e-03]
 [ 5.31487826e-03]
 [-1.29957950e-02]
 [-1.25417068e-02]
 [-2.28549411e-03]
 [-2.01546333e-02]
 [ 2.84541196e-02]
 [ 2.17252942e-02]
 [ 1.85351041e-03]
 [ 6.46226523e-03]
 [-1.44165805e-02]
 [-6.18764396e-03]
 [-2.03808969e-03]
 [ 2.17577533e-03]
 [ 8.30727188e-03]
 [ 5.95352100e-03]
 [-8.80998999e-03]
 [ 2.43834353e-03]
 [-5.53093290e-03]
 [ 1.73568514e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.56125627]
curr_Stock_Price:  99.76684509045857
curr_Factors:  [99.76684509]
mat_Sqrt:  [[0.15]]
grads:  [-0.23233946]
Stock Position:  -0.23233945682394375
Bond Position:  [21.61851833]


portfolio before change:  [-1.46693693]
curr_Stock_Price:  99.36670582866952
curr_Factors:  [99.36670583]
mat_Sqrt:  [[0.15]]
grads:  [0.01950684]
Stock Position:  0.019506839459071834
Bond Position:  [-3.40526731]


portfolio before change:  [-1.47114494]
curr_Stock_Price:  99.16189667979867
curr_Factors:  [99.16189668]
mat_Sqrt:  [[0.15]]
grads:  [-0.0045505]
Stock Position:  -0.004550498980860285
Bond Position:  [-1.01990883]


portfolio before change:  [-1.47476574]
curr_Stock_Price:  99.94358024866376
curr_Factors:  [99.94358025]
mat_Sqrt:  [[0.15]]
grads:  [0.01439144]
Stock Position:  0.014391435556754444
Bond Position:  [-2.91309733]


portfolio before change:  [-1.4664604]
curr_Stock_Price:  100.53333453393158
curr_Factors:  [100.53333453]
mat_Sqrt:  [[0.15]]
grads:  [0.05704571]
Stock Position:  0.05704571218275746
Bond Position:  [-7.20145607]


portfolio before change:  [-1.44619787]
curr_Stock_Price:  100.89642286840626
curr_Factors:  [100.89642287]
mat_Sqrt:  [[0.15]]
grads:  [0.07944865]
Stock Position:  0.0794486523146457
Bond Position:  [-9.46228269]


portfolio before change:  [-1.49029645]
curr_Stock_Price:  100.3488091863555
curr_Factors:  [100.34880919]
mat_Sqrt:  [[0.15]]
grads:  [0.00819374]
Stock Position:  0.008193737703137664
Bond Position:  [-2.31252828]


portfolio before change:  [-1.48962021]
curr_Stock_Price:  100.4489805005749
curr_Factors:  [100.4489805]
mat_Sqrt:  [[0.15]]
grads:  [0.06880177]
Stock Position:  0.06880177093552306
Bond Position:  [-8.40068796]


portfolio before change:  [-1.45217993]
curr_Stock_Price:  101.00078810113004
curr_Factors:  [101.0007881]
mat_Sqrt:  [[0.15]]
grads:  [-0.02210161]
Stock Position:  -0.022101607229039602
Bond Position:  [0.78009981]


portfolio before change:  [-1.43580135]
curr_Stock_Price:  100.2619358751073
curr_Factors:  [100.26193588]
mat_Sqrt:  [[0.15]]
grads:  [-0.13069941]
Stock Position:  -0.13069941141408753
Bond Position:  [11.66837465]


portfolio before change:  [-1.53425008]
curr_Stock_Price:  101.0207611995748
curr_Factors:  [101.0207612]
mat_Sqrt:  [[0.15]]
grads:  [0.06781869]
Stock Position:  0.06781868743143514
Bond Position:  [-8.38534551]


portfolio before change:  [-1.50805548]
curr_Stock_Price:  101.41473370666637
curr_Factors:  [101.41473371]
mat_Sqrt:  [[0.15]]
grads:  [-0.0547516]
Stock Position:  -0.05475159800188926
Bond Position:  [4.04456325]


portfolio before change:  [-1.55683373]
curr_Stock_Price:  102.31025159530809
curr_Factors:  [102.3102516]
mat_Sqrt:  [[0.15]]
grads:  [0.15801493]
Stock Position:  0.1580149289538202
Bond Position:  [-17.72338086]


portfolio before change:  [-1.60011158]
curr_Stock_Price:  102.04337741183103
curr_Factors:  [102.04337741]
mat_Sqrt:  [[0.15]]
grads:  [0.05076203]
Stock Position:  0.050762030950938154
Bond Position:  [-6.78004066]


portfolio before change:  [-1.53316168]
curr_Stock_Price:  103.3706226845254
curr_Factors:  [103.37062268]
mat_Sqrt:  [[0.15]]
grads:  [-0.06705537]
Stock Position:  -0.0670553712914763
Bond Position:  [5.39839381]


portfolio before change:  [-1.54922472]
curr_Stock_Price:  103.6152034213543
curr_Factors:  [103.61520342]
mat_Sqrt:  [[0.15]]
grads:  [-0.04756161]
Stock Position:  -0.04756160634668494
Bond Position:  [3.3788808]


portfolio before change:  [-1.55979404]
curr_Stock_Price:  103.84186755178922
curr_Factors:  [103.84186755]
mat_Sqrt:  [[0.15]]
grads:  [0.10489215]
Stock Position:  0.1048921537941615
Bond Position:  [-12.45199118]


portfolio before change:  [-1.60625403]
curr_Stock_Price:  103.40635632599441
curr_Factors:  [103.40635633]
mat_Sqrt:  [[0.15]]
grads:  [0.15829935]
Stock Position:  0.1582993490831827
Bond Position:  [-17.97541292]


portfolio before change:  [-1.67028858]
curr_Stock_Price:  103.0089380489768
curr_Factors:  [103.00893805]
mat_Sqrt:  [[0.15]]
grads:  [0.03184044]
Stock Position:  0.03184043618843366
Bond Position:  [-4.9501381]


portfolio before change:  [-1.67090483]
curr_Stock_Price:  102.99930084367013
curr_Factors:  [102.99930084]
mat_Sqrt:  [[0.15]]
grads:  [-0.01630397]
Stock Position:  -0.016303965112335908
Bond Position:  [0.00839218]


portfolio before change:  [-1.64609802]
curr_Stock_Price:  101.47781335607863
curr_Factors:  [101.47781336]
mat_Sqrt:  [[0.15]]
grads:  [0.43055761]
Stock Position:  0.43055760519086284
Bond Position:  [-45.33814232]


portfolio before change:  [-1.36212446]
curr_Stock_Price:  102.14394322300284
curr_Factors:  [102.14394322]
mat_Sqrt:  [[0.15]]
grads:  [-0.08536887]
Stock Position:  -0.08536887231962101
Bond Position:  [7.35778878]


portfolio before change:  [-1.30003255]
curr_Stock_Price:  101.42199348002283
curr_Factors:  [101.42199348]
mat_Sqrt:  [[0.15]]
grads:  [0.04611271]
Stock Position:  0.04611271051863062
Bond Position:  [-5.97687558]


portfolio before change:  [-1.33704427]
curr_Stock_Price:  100.62745873749033
curr_Factors:  [100.62745874]
mat_Sqrt:  [[0.15]]
grads:  [0.04218599]
Stock Position:  0.042185987774153486
Bond Position:  [-5.58211301]


portfolio before change:  [-1.36644731]
curr_Stock_Price:  99.93874305738743
curr_Factors:  [99.93874306]
mat_Sqrt:  [[0.15]]
grads:  [0.08451228]
Stock Position:  0.08451227766364501
Bond Position:  [-9.81249812]


portfolio before change:  [-1.39656964]
curr_Stock_Price:  99.58957460195967
curr_Factors:  [99.5895746]
mat_Sqrt:  [[0.15]]
grads:  [-0.02108271]
Stock Position:  -0.02108271096995971
Bond Position:  [0.70304858]


portfolio before change:  [-1.40901817]
curr_Stock_Price:  100.18212058274207
curr_Factors:  [100.18212058]
mat_Sqrt:  [[0.15]]
grads:  [0.09121084]
Stock Position:  0.09121083888369444
Bond Position:  [-10.54671343]


portfolio before change:  [-1.44883701]
curr_Stock_Price:  99.7527894282137
curr_Factors:  [99.75278943]
mat_Sqrt:  [[0.15]]
grads:  [-0.01870812]
Stock Position:  -0.018708115750928508
Bond Position:  [0.41734972]


portfolio before change:  [-1.43806444]
curr_Stock_Price:  99.17835989719657
curr_Factors:  [99.1783599]
mat_Sqrt:  [[0.15]]
grads:  [0.01594275]
Stock Position:  0.01594274636953342
Bond Position:  [-3.01923987]


portfolio before change:  [-1.44427233]
curr_Stock_Price:  98.8008097392223
curr_Factors:  [98.80080974]
mat_Sqrt:  [[0.15]]
grads:  [-0.0764309]
Stock Position:  -0.07643090143898358
Bond Position:  [6.10716262]


portfolio before change:  [-1.39012625]
curr_Stock_Price:  98.09737211892153
curr_Factors:  [98.09737212]
mat_Sqrt:  [[0.15]]
grads:  [-0.02410042]
Stock Position:  -0.02410041548379119
Bond Position:  [0.97406118]


portfolio before change:  [-1.40290144]
curr_Stock_Price:  98.62998019933717
curr_Factors:  [98.6299802]
mat_Sqrt:  [[0.15]]
grads:  [-0.12308845]
Stock Position:  -0.12308844722110557
Bond Position:  [10.73730967]


portfolio before change:  [-1.37971645]
curr_Stock_Price:  98.44707193359976
curr_Factors:  [98.44707193]
mat_Sqrt:  [[0.15]]
grads:  [0.10800431]
Stock Position:  0.10800430753889956
Bond Position:  [-12.01242428]


portfolio before change:  [-1.4229076]
curr_Stock_Price:  98.05412141529868
curr_Factors:  [98.05412142]
mat_Sqrt:  [[0.15]]
grads:  [0.09052194]
Stock Position:  0.09052193872451167
Bond Position:  [-10.29895677]


portfolio before change:  [-1.39684715]
curr_Stock_Price:  98.34912340548154
curr_Factors:  [98.34912341]
mat_Sqrt:  [[0.15]]
grads:  [-0.11139666]
Stock Position:  -0.11139666164267949
Bond Position:  [9.55891687]


portfolio before change:  [-1.35711542]
curr_Stock_Price:  97.99781775300774
curr_Factors:  [97.99781775]
mat_Sqrt:  [[0.15]]
grads:  [0.04778744]
Stock Position:  0.04778744441662461
Bond Position:  [-6.04018069]


portfolio before change:  [-1.39311801]
curr_Stock_Price:  97.25232759493846
curr_Factors:  [97.25232759]
mat_Sqrt:  [[0.15]]
grads:  [-0.01899965]
Stock Position:  -0.01899965096645351
Bond Position:  [0.45464227]


portfolio before change:  [-1.3862553]
curr_Stock_Price:  96.89262089569586
curr_Factors:  [96.8926209]
mat_Sqrt:  [[0.15]]
grads:  [-0.00558535]
Stock Position:  -0.005585346884490981
Bond Position:  [-0.8450764]


portfolio before change:  [-1.3832588]
curr_Stock_Price:  96.34667209808681
curr_Factors:  [96.3466721]
mat_Sqrt:  [[0.15]]
grads:  [0.04366182]
Stock Position:  0.04366181540944316
Bond Position:  [-5.58992941]


portfolio before change:  [-1.36226521]
curr_Stock_Price:  96.8354966873874
curr_Factors:  [96.83549669]
mat_Sqrt:  [[0.15]]
grads:  [-0.11122339]
Stock Position:  -0.11122338830432031
Bond Position:  [9.40810684]


portfolio before change:  [-1.34345943]
curr_Stock_Price:  96.67170240080517
curr_Factors:  [96.6717024]
mat_Sqrt:  [[0.15]]
grads:  [0.28372313]
Stock Position:  0.2837231306576701
Bond Position:  [-28.77145748]


portfolio before change:  [-1.26396525]
curr_Stock_Price:  96.95822276500776
curr_Factors:  [96.95822277]
mat_Sqrt:  [[0.15]]
grads:  [0.0024254]
Stock Position:  0.002425404149167176
Bond Position:  [-1.49912813]


portfolio before change:  [-1.26482026]
curr_Stock_Price:  96.64433391082943
curr_Factors:  [96.64433391]
mat_Sqrt:  [[0.15]]
grads:  [0.04391582]
Stock Position:  0.04391582204265795
Bond Position:  [-5.50903563]


portfolio before change:  [-1.22897881]
curr_Stock_Price:  97.46831409792846
curr_Factors:  [97.4683141]
mat_Sqrt:  [[0.15]]
grads:  [-0.05723748]
Stock Position:  -0.0572374765910191
Bond Position:  [4.34986153]


portfolio before change:  [-1.23150991]
curr_Stock_Price:  97.51728499195758
curr_Factors:  [97.51728499]
mat_Sqrt:  [[0.15]]
grads:  [0.0054878]
Stock Position:  0.005487797753617888
Bond Position:  [-1.76666505]


portfolio before change:  [-1.23538852]
curr_Stock_Price:  96.83063639202872
curr_Factors:  [96.83063639]
mat_Sqrt:  [[0.15]]
grads:  [-0.05618708]
Stock Position:  -0.05618707710946934
Bond Position:  [4.20524191]


portfolio before change:  [-1.25761635]
curr_Stock_Price:  97.23091822122397
curr_Factors:  [97.23091822]
mat_Sqrt:  [[0.15]]
grads:  [-0.09010095]
Stock Position:  -0.09010095372375944
Bond Position:  [7.50298211]


portfolio before change:  [-1.26802931]
curr_Stock_Price:  97.35169282843788
curr_Factors:  [97.35169283]
mat_Sqrt:  [[0.15]]
grads:  [-0.00420962]
Stock Position:  -0.004209619432452745
Bond Position:  [-0.85821573]


portfolio before change:  [-1.26751275]
curr_Stock_Price:  97.21624256276866
curr_Factors:  [97.21624256]
mat_Sqrt:  [[0.15]]
grads:  [-0.02418764]
Stock Position:  -0.024187640578369373
Bond Position:  [1.08391878]


portfolio before change:  [-1.28284947]
curr_Stock_Price:  97.85311587269477
curr_Factors:  [97.85311587]
mat_Sqrt:  [[0.15]]
grads:  [0.03801344]
Stock Position:  0.038013441092154626
Bond Position:  [-5.00258312]


portfolio before change:  [-1.26862857]
curr_Stock_Price:  98.23544296996533
curr_Factors:  [98.23544297]
mat_Sqrt:  [[0.15]]
grads:  [-0.02122387]
Stock Position:  -0.021223870163308216
Bond Position:  [0.81630772]


portfolio before change:  [-1.27498833]
curr_Stock_Price:  98.53749843107406
curr_Factors:  [98.53749843]
mat_Sqrt:  [[0.15]]
grads:  [0.02160156]
Stock Position:  0.021601561390741476
Bond Position:  [-3.40355216]


portfolio before change:  [-1.27249407]
curr_Stock_Price:  98.6628129749698
curr_Factors:  [98.66281297]
mat_Sqrt:  [[0.15]]
grads:  [0.0187071]
Stock Position:  0.018707102451879405
Bond Position:  [-3.11818942]


portfolio before change:  [-1.27298969]
curr_Stock_Price:  98.64673786687463
curr_Factors:  [98.64673787]
mat_Sqrt:  [[0.15]]
grads:  [0.00562413]
Stock Position:  0.005624126361078208
Bond Position:  [-1.8277914]


portfolio before change:  [-1.27179296]
curr_Stock_Price:  98.87983422552607
curr_Factors:  [98.87983423]
mat_Sqrt:  [[0.15]]
grads:  [0.00960065]
Stock Position:  0.009600651858795654
Bond Position:  [-2.22110383]


portfolio before change:  [-1.27242682]
curr_Stock_Price:  98.828271657116
curr_Factors:  [98.82827166]
mat_Sqrt:  [[0.15]]
grads:  [0.06026237]
Stock Position:  0.060262372059319454
Bond Position:  [-7.2280529]


portfolio before change:  [-1.29048036]
curr_Stock_Price:  98.5361860004232
curr_Factors:  [98.536186]
mat_Sqrt:  [[0.15]]
grads:  [0.10106257]
Stock Position:  0.10106257107185111
Bond Position:  [-11.24880066]


portfolio before change:  [-1.24421727]
curr_Stock_Price:  99.00090958345056
curr_Factors:  [99.00090958]
mat_Sqrt:  [[0.15]]
grads:  [-0.1606688]
Stock Position:  -0.16066879974156217
Bond Position:  [14.66214004]


portfolio before change:  [-1.26827277]
curr_Stock_Price:  99.15633431560214
curr_Factors:  [99.15633432]
mat_Sqrt:  [[0.15]]
grads:  [0.09300933]
Stock Position:  0.09300932857283184
Bond Position:  [-10.49073685]


portfolio before change:  [-1.309241]
curr_Stock_Price:  98.72290955609756
curr_Factors:  [98.72290956]
mat_Sqrt:  [[0.15]]
grads:  [0.02439858]
Stock Position:  0.024398580129168537
Bond Position:  [-3.71793982]


portfolio before change:  [-1.29689862]
curr_Stock_Price:  99.23829872664403
curr_Factors:  [99.23829873]
mat_Sqrt:  [[0.15]]
grads:  [0.03543252]
Stock Position:  0.03543252175139498
Bond Position:  [-4.8131618]


portfolio before change:  [-1.29626493]
curr_Stock_Price:  99.26467335457407
curr_Factors:  [99.26467335]
mat_Sqrt:  [[0.15]]
grads:  [-0.08663863]
Stock Position:  -0.08663863308636381
Bond Position:  [7.30389068]


portfolio before change:  [-1.36051253]
curr_Stock_Price:  100.01150079676017
curr_Factors:  [100.0115008]
mat_Sqrt:  [[0.15]]
grads:  [-0.08361138]
Stock Position:  -0.08361137851879454
Bond Position:  [7.00158692]


portfolio before change:  [-1.42702114]
curr_Stock_Price:  100.81218397115083
curr_Factors:  [100.81218397]
mat_Sqrt:  [[0.15]]
grads:  [-0.01523663]
Stock Position:  -0.015236627369101287
Bond Position:  [0.10901654]


portfolio before change:  [-1.42636514]
curr_Stock_Price:  100.76957688183882
curr_Factors:  [100.76957688]
mat_Sqrt:  [[0.15]]
grads:  [-0.13436422]
Stock Position:  -0.13436422182106886
Bond Position:  [12.11346064]


portfolio before change:  [-1.45117939]
curr_Stock_Price:  100.95989063351549
curr_Factors:  [100.95989063]
mat_Sqrt:  [[0.15]]
grads:  [0.18969413]
Stock Position:  0.18969413075461544
Bond Position:  [-20.60267808]


portfolio before change:  [-1.45116736]
curr_Stock_Price:  100.96674235202164
curr_Factors:  [100.96674235]
mat_Sqrt:  [[0.15]]
grads:  [0.14483529]
Stock Position:  0.1448352945637677
Bond Position:  [-16.07471523]


portfolio before change:  [-1.40026414]
curr_Stock_Price:  101.32513514618662
curr_Factors:  [101.32513515]
mat_Sqrt:  [[0.15]]
grads:  [0.01235674]
Stock Position:  0.01235673606216593
Bond Position:  [-2.65231209]


portfolio before change:  [-1.41893026]
curr_Stock_Price:  99.82794784543492
curr_Factors:  [99.82794785]
mat_Sqrt:  [[0.15]]
grads:  [0.04308177]
Stock Position:  0.0430817682294196
Bond Position:  [-5.71969477]


portfolio before change:  [-1.41314234]
curr_Stock_Price:  99.9705932083822
curr_Factors:  [99.97059321]
mat_Sqrt:  [[0.15]]
grads:  [-0.09611054]
Stock Position:  -0.09611053640190453
Bond Position:  [8.195085]


portfolio before change:  [-1.41781874]
curr_Stock_Price:  100.02457903368736
curr_Factors:  [100.02457903]
mat_Sqrt:  [[0.15]]
grads:  [-0.04125096]
Stock Position:  -0.04125095975282593
Bond Position:  [2.70829115]


portfolio before change:  [-1.43907294]
curr_Stock_Price:  100.54392393556981
curr_Factors:  [100.54392394]
mat_Sqrt:  [[0.15]]
grads:  [-0.01358726]
Stock Position:  -0.013587264571226299
Bond Position:  [-0.07295604]


portfolio before change:  [-1.4503269]
curr_Stock_Price:  101.37186111813195
curr_Factors:  [101.37186112]
mat_Sqrt:  [[0.15]]
grads:  [0.01450517]
Stock Position:  0.01450516884811551
Bond Position:  [-2.92074286]


portfolio before change:  [-1.44699855]
curr_Stock_Price:  101.61390625263729
curr_Factors:  [101.61390625]
mat_Sqrt:  [[0.15]]
grads:  [0.05538181]
Stock Position:  0.055381812522984054
Bond Position:  [-7.07456085]


portfolio before change:  [-1.46405495]
curr_Stock_Price:  101.31391193222608
curr_Factors:  [101.31391193]
mat_Sqrt:  [[0.15]]
grads:  [0.03969014]
Stock Position:  0.03969013997837467
Bond Position:  [-5.4852183]


portfolio before change:  [-1.50083538]
curr_Stock_Price:  100.39586031051088
curr_Factors:  [100.39586031]
mat_Sqrt:  [[0.15]]
grads:  [-0.05873327]
Stock Position:  -0.05873326657303326
Bond Position:  [4.39574144]


portfolio before change:  [-1.55730048]
curr_Stock_Price:  101.3619199516449
curr_Factors:  [101.36191995]
mat_Sqrt:  [[0.15]]
grads:  [0.01625562]
Stock Position:  0.01625562352526393
Bond Position:  [-3.20500169]


portfolio before change:  [-1.54968578]
curr_Stock_Price:  101.8426777679863
curr_Factors:  [101.84267777]
mat_Sqrt:  [[0.15]]
grads:  [-0.03687289]
Stock Position:  -0.03687288597173515
Bond Position:  [2.20554766]


portfolio before change:  [-1.56526179]
curr_Stock_Price:  102.26884083401552
curr_Factors:  [102.26884083]
mat_Sqrt:  [[0.15]]
grads:  [0.11571234]
Stock Position:  0.11571234233765568
Bond Position:  [-13.39902891]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.56526179]
Stock Price:  101.55058074856808
PL:  [-3.11584254]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.09383598e-02]
 [-2.31219910e-03]
 [-3.82468533e-04]
 [ 2.14618049e-03]
 [ 1.96563128e-02]
 [ 1.21794816e-02]
 [ 1.17757270e-03]
 [ 1.30149816e-02]
 [ 1.64887121e-02]
 [-1.90319362e-02]
 [ 7.32391288e-03]
 [-4.99028570e-03]
 [-8.62602375e-03]
 [ 4.30767810e-03]
 [ 4.37092737e-03]
 [ 7.38108334e-03]
 [ 6.63932538e-03]
 [ 8.59824664e-03]
 [ 2.42440109e-02]
 [ 1.04394092e-02]
 [ 1.21525912e-02]
 [-2.12283585e-02]
 [-1.09434651e-03]
 [ 1.19782477e-02]
 [-2.20541402e-03]
 [ 1.70092572e-02]
 [ 1.69144670e-02]
 [ 4.10826969e-02]
 [-1.41142440e-04]
 [ 1.16607028e-02]
 [-3.45097493e-03]
 [-3.54228186e-02]
 [ 2.19100952e-02]
 [ 1.15942578e-02]
 [-3.75406437e-02]
 [ 8.83957267e-03]
 [ 9.20596551e-04]
 [-1.26247361e-02]
 [ 1.04838108e-02]
 [-2.17922589e-02]
 [ 4.80829615e-02]
 [ 1.71781846e-03]
 [ 9.35129557e-03]
 [-9.65836390e-03]
 [-4.70704826e-03]
 [-1.86155840e-02]
 [-1.29850948e-02]
 [ 2.78771176e-03]
 [-2.97206550e-03]
 [-1.97655733e-02]
 [-4.50226934e-03]
 [ 2.81065966e-03]
 [ 4.37163442e-03]
 [-3.73865516e-03]
 [ 2.66392987e-02]
 [ 9.12019257e-03]
 [-5.02784870e-03]
 [ 1.84605042e-02]
 [ 1.25991720e-02]
 [-1.25080184e-02]
 [-1.41293292e-02]
 [-4.41727672e-02]
 [-1.30806124e-02]
 [-4.92609420e-03]
 [-4.73923762e-03]
 [ 5.97050300e-02]
 [ 8.60511984e-03]
 [ 1.64234444e-03]
 [ 1.71205345e-02]
 [-1.91508012e-02]
 [ 3.66514764e-02]
 [-5.29182167e-02]
 [-1.09554527e-02]
 [ 8.24803946e-03]
 [-1.72792859e-02]
 [ 4.73743402e-03]
 [ 2.57838565e-02]
 [-2.15443063e-02]
 [-6.48463780e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.00617109]
curr_Stock_Price:  100.18893797862505
curr_Factors:  [100.18893798]
mat_Sqrt:  [[0.15]]
grads:  [-0.2729224]
Stock Position:  -0.2729223986417023
Bond Position:  [32.34997636]


portfolio before change:  [4.99222087]
curr_Stock_Price:  100.24746069766584
curr_Factors:  [100.2474607]
mat_Sqrt:  [[0.15]]
grads:  [-0.01541466]
Stock Position:  -0.015414660676812221
Bond Position:  [6.53750146]


portfolio before change:  [5.00601945]
curr_Stock_Price:  99.37880905214185
curr_Factors:  [99.37880905]
mat_Sqrt:  [[0.15]]
grads:  [-0.00254979]
Stock Position:  -0.0025497902198339958
Bond Position:  [5.25941456]


portfolio before change:  [5.00503421]
curr_Stock_Price:  99.8941289399551
curr_Factors:  [99.89412894]
mat_Sqrt:  [[0.15]]
grads:  [0.01430787]
Stock Position:  0.014307869945627825
Bond Position:  [3.57576201]


portfolio before change:  [5.00689294]
curr_Stock_Price:  100.00841809984475
curr_Factors:  [100.0084181]
mat_Sqrt:  [[0.15]]
grads:  [0.13104209]
Stock Position:  0.13104208553112615
Bond Position:  [-8.09841874]


portfolio before change:  [4.9815299]
curr_Stock_Price:  99.81873191046071
curr_Factors:  [99.81873191]
mat_Sqrt:  [[0.15]]
grads:  [0.08119654]
Stock Position:  0.08119654406615859
Bond Position:  [-3.12340617]


portfolio before change:  [5.02880648]
curr_Stock_Price:  100.40338495242386
curr_Factors:  [100.40338495]
mat_Sqrt:  [[0.15]]
grads:  [0.00785048]
Stock Position:  0.007850484677031366
Bond Position:  [4.24059125]


portfolio before change:  [5.02346806]
curr_Stock_Price:  99.6896117096926
curr_Factors:  [99.68961171]
mat_Sqrt:  [[0.15]]
grads:  [0.08676654]
Stock Position:  0.08676654375740596
Bond Position:  [-3.62625499]


portfolio before change:  [5.02284515]
curr_Stock_Price:  99.68504466059474
curr_Factors:  [99.68504466]
mat_Sqrt:  [[0.15]]
grads:  [0.10992475]
Stock Position:  0.10992474758503352
Bond Position:  [-5.93500822]


portfolio before change:  [5.00848677]
curr_Stock_Price:  99.55779916868265
curr_Factors:  [99.55779917]
mat_Sqrt:  [[0.15]]
grads:  [-0.12687957]
Stock Position:  -0.12687957441338021
Bond Position:  [17.64033796]


portfolio before change:  [4.99796761]
curr_Stock_Price:  99.64939558148625
curr_Factors:  [99.64939558]
mat_Sqrt:  [[0.15]]
grads:  [0.04882609]
Stock Position:  0.048826085853295835
Bond Position:  [0.13247767]


portfolio before change:  [5.02026223]
curr_Stock_Price:  100.1058388340864
curr_Factors:  [100.10583883]
mat_Sqrt:  [[0.15]]
grads:  [-0.03326857]
Stock Position:  -0.03326857135893622
Bond Position:  [8.35064047]


portfolio before change:  [5.04046294]
curr_Stock_Price:  99.51432623086039
curr_Factors:  [99.51432623]
mat_Sqrt:  [[0.15]]
grads:  [-0.05750683]
Stock Position:  -0.0575068250194866
Bond Position:  [10.76321589]


portfolio before change:  [5.03479723]
curr_Stock_Price:  99.62454671450884
curr_Factors:  [99.62454671]
mat_Sqrt:  [[0.15]]
grads:  [0.02871785]
Stock Position:  0.028717854017492585
Bond Position:  [2.17379404]


portfolio before change:  [5.04022281]
curr_Stock_Price:  99.80874268208814
curr_Factors:  [99.80874268]
mat_Sqrt:  [[0.15]]
grads:  [0.02913952]
Stock Position:  0.029139515769579516
Bond Position:  [2.13184438]


portfolio before change:  [5.03152637]
curr_Stock_Price:  99.50572865246254
curr_Factors:  [99.50572865]
mat_Sqrt:  [[0.15]]
grads:  [0.04920722]
Stock Position:  0.0492072222562547
Bond Position:  [0.13512587]


portfolio before change:  [5.04992282]
curr_Stock_Price:  99.87941366086169
curr_Factors:  [99.87941366]
mat_Sqrt:  [[0.15]]
grads:  [0.04426217]
Stock Position:  0.04426216919980595
Bond Position:  [0.62904331]


portfolio before change:  [5.04176596]
curr_Stock_Price:  99.69424025980929
curr_Factors:  [99.69424026]
mat_Sqrt:  [[0.15]]
grads:  [0.05732164]
Stock Position:  0.05732164423582732
Bond Position:  [-0.67287181]


portfolio before change:  [5.03879607]
curr_Stock_Price:  99.64316289807329
curr_Factors:  [99.6431629]
mat_Sqrt:  [[0.15]]
grads:  [0.16162674]
Stock Position:  0.16162673960227064
Bond Position:  [-11.06620348]


portfolio before change:  [4.98558129]
curr_Stock_Price:  99.31819736001458
curr_Factors:  [99.31819736]
mat_Sqrt:  [[0.15]]
grads:  [0.06959606]
Stock Position:  0.06959606165893568
Bond Position:  [-1.9265741]


portfolio before change:  [4.9066504]
curr_Stock_Price:  98.18579890538123
curr_Factors:  [98.18579891]
mat_Sqrt:  [[0.15]]
grads:  [0.08101727]
Stock Position:  0.08101727443415396
Bond Position:  [-3.04809542]


portfolio before change:  [4.9015294]
curr_Stock_Price:  98.12494170671911
curr_Factors:  [98.12494171]
mat_Sqrt:  [[0.15]]
grads:  [-0.14152239]
Stock Position:  -0.14152239026520075
Bond Position:  [18.7884057]


portfolio before change:  [4.83477405]
curr_Stock_Price:  98.60493409621522
curr_Factors:  [98.6049341]
mat_Sqrt:  [[0.15]]
grads:  [-0.00729564]
Stock Position:  -0.0072956433952785634
Bond Position:  [5.55416048]


portfolio before change:  [4.83570689]
curr_Stock_Price:  98.52465317692472
curr_Factors:  [98.52465318]
mat_Sqrt:  [[0.15]]
grads:  [0.07985498]
Stock Position:  0.07985498492053036
Bond Position:  [-3.0319778]


portfolio before change:  [4.73534207]
curr_Stock_Price:  97.27018772591364
curr_Factors:  [97.27018773]
mat_Sqrt:  [[0.15]]
grads:  [-0.01470276]
Stock Position:  -0.01470276011258219
Bond Position:  [6.1654823]


portfolio before change:  [4.74312299]
curr_Stock_Price:  96.76718228658521
curr_Factors:  [96.76718229]
mat_Sqrt:  [[0.15]]
grads:  [0.11339505]
Stock Position:  0.11339504799224759
Bond Position:  [-6.22979629]


portfolio before change:  [4.73992956]
curr_Stock_Price:  96.7424540590909
curr_Factors:  [96.74245406]
mat_Sqrt:  [[0.15]]
grads:  [0.11276311]
Stock Position:  0.11276311313369777
Bond Position:  [-6.16905073]


portfolio before change:  [4.65658098]
curr_Stock_Price:  96.00672588411548
curr_Factors:  [96.00672588]
mat_Sqrt:  [[0.15]]
grads:  [0.27388465]
Stock Position:  0.2738846459532269
Bond Position:  [-21.63818715]


portfolio before change:  [4.58011116]
curr_Stock_Price:  95.73245935008501
curr_Factors:  [95.73245935]
mat_Sqrt:  [[0.15]]
grads:  [-0.00094095]
Stock Position:  -0.00094094960008785
Bond Position:  [4.67019058]


portfolio before change:  [4.58068084]
curr_Stock_Price:  95.43724638145433
curr_Factors:  [95.43724638]
mat_Sqrt:  [[0.15]]
grads:  [0.07773802]
Stock Position:  0.07773801846904366
Bond Position:  [-2.83842159]


portfolio before change:  [4.57729395]
curr_Stock_Price:  95.39596057239434
curr_Factors:  [95.39596057]
mat_Sqrt:  [[0.15]]
grads:  [-0.0230065]
Stock Position:  -0.02300649951925464
Bond Position:  [6.77202107]


portfolio before change:  [4.56149516]
curr_Stock_Price:  96.10106800525215
curr_Factors:  [96.10106801]
mat_Sqrt:  [[0.15]]
grads:  [-0.23615212]
Stock Position:  -0.23615212384542997
Bond Position:  [27.25596648]


portfolio before change:  [4.55940846]
curr_Stock_Price:  96.11711805741959
curr_Factors:  [96.11711806]
mat_Sqrt:  [[0.15]]
grads:  [0.1460673]
Stock Position:  0.14606730140772226
Bond Position:  [-9.48015959]


portfolio before change:  [4.47890621]
curr_Stock_Price:  95.57004337960048
curr_Factors:  [95.57004338]
mat_Sqrt:  [[0.15]]
grads:  [0.07729505]
Stock Position:  0.07729505195292949
Bond Position:  [-2.90818526]


portfolio before change:  [4.4355833]
curr_Stock_Price:  95.01190742951157
curr_Factors:  [95.01190743]
mat_Sqrt:  [[0.15]]
grads:  [-0.25027096]
Stock Position:  -0.25027095832745805
Bond Position:  [28.21430442]


portfolio before change:  [4.61794956]
curr_Stock_Price:  94.29027829384337
curr_Factors:  [94.29027829]
mat_Sqrt:  [[0.15]]
grads:  [0.05893048]
Stock Position:  0.058930484461098914
Bond Position:  [-0.93862222]


portfolio before change:  [4.6509838]
curr_Stock_Price:  94.85183663214502
curr_Factors:  [94.85183663]
mat_Sqrt:  [[0.15]]
grads:  [0.00613731]
Stock Position:  0.006137310341870674
Bond Position:  [4.06884864]


portfolio before change:  [4.65219418]
curr_Stock_Price:  95.00761715210349
curr_Factors:  [95.00761715]
mat_Sqrt:  [[0.15]]
grads:  [-0.08416491]
Stock Position:  -0.08416490747580926
Bond Position:  [12.64850149]


portfolio before change:  [4.71685906]
curr_Stock_Price:  94.24869846084114
curr_Factors:  [94.24869846]
mat_Sqrt:  [[0.15]]
grads:  [0.06989207]
Stock Position:  0.06989207195262455
Bond Position:  [-1.87037775]


portfolio before change:  [4.71587943]
curr_Stock_Price:  94.23635475351932
curr_Factors:  [94.23635475]
mat_Sqrt:  [[0.15]]
grads:  [-0.14528173]
Stock Position:  -0.14528172601729586
Bond Position:  [18.4066997]


portfolio before change:  [4.49530932]
curr_Stock_Price:  95.76249691745853
curr_Factors:  [95.76249692]
mat_Sqrt:  [[0.15]]
grads:  [0.32055308]
Stock Position:  0.3205530769419816
Bond Position:  [-26.20165372]


portfolio before change:  [4.54015443]
curr_Stock_Price:  95.90750495050838
curr_Factors:  [95.90750495]
mat_Sqrt:  [[0.15]]
grads:  [0.01145212]
Stock Position:  0.011452123069582739
Bond Position:  [3.44180988]


portfolio before change:  [4.53417645]
curr_Stock_Price:  95.3667226689892
curr_Factors:  [95.36672267]
mat_Sqrt:  [[0.15]]
grads:  [0.06234197]
Stock Position:  0.062341970481112126
Bond Position:  [-1.41117296]


portfolio before change:  [4.51703866]
curr_Stock_Price:  95.09323768664336
curr_Factors:  [95.09323769]
mat_Sqrt:  [[0.15]]
grads:  [-0.06438909]
Stock Position:  -0.06438909267499171
Bond Position:  [10.64000595]


portfolio before change:  [4.57853432]
curr_Stock_Price:  94.14850251969267
curr_Factors:  [94.14850252]
mat_Sqrt:  [[0.15]]
grads:  [-0.03138032]
Stock Position:  -0.03138032170216471
Bond Position:  [7.53294461]


portfolio before change:  [4.57148563]
curr_Stock_Price:  94.38812770822592
curr_Factors:  [94.38812771]
mat_Sqrt:  [[0.15]]
grads:  [-0.12410389]
Stock Position:  -0.12410389321501808
Bond Position:  [16.28541975]


portfolio before change:  [4.62321386]
curr_Stock_Price:  93.97951548321025
curr_Factors:  [93.97951548]
mat_Sqrt:  [[0.15]]
grads:  [-0.0865673]
Stock Position:  -0.08656729856879845
Bond Position:  [12.75876664]


portfolio before change:  [4.67093157]
curr_Stock_Price:  93.4375064160409
curr_Factors:  [93.43750642]
mat_Sqrt:  [[0.15]]
grads:  [0.01858475]
Stock Position:  0.01858474505763266
Bond Position:  [2.93441934]


portfolio before change:  [4.68340654]
curr_Stock_Price:  94.09888555870133
curr_Factors:  [94.09888556]
mat_Sqrt:  [[0.15]]
grads:  [-0.01981377]
Stock Position:  -0.019813770013737957
Bond Position:  [6.54786022]


portfolio before change:  [4.70502957]
curr_Stock_Price:  93.02822750759132
curr_Factors:  [93.02822751]
mat_Sqrt:  [[0.15]]
grads:  [-0.13177049]
Stock Position:  -0.1317704887270504
Bond Position:  [16.96340457]


portfolio before change:  [4.59465983]
curr_Stock_Price:  93.87386438898231
curr_Factors:  [93.87386439]
mat_Sqrt:  [[0.15]]
grads:  [-0.03001513]
Stock Position:  -0.03001512894791526
Bond Position:  [7.41229597]


portfolio before change:  [4.60767595]
curr_Stock_Price:  93.45564741772957
curr_Factors:  [93.45564742]
mat_Sqrt:  [[0.15]]
grads:  [0.01873773]
Stock Position:  0.01873773106351395
Bond Position:  [2.85652916]


portfolio before change:  [4.59450961]
curr_Stock_Price:  92.74345470821116
curr_Factors:  [92.74345471]
mat_Sqrt:  [[0.15]]
grads:  [0.02914423]
Stock Position:  0.029144229460438993
Bond Position:  [1.89157309]


portfolio before change:  [4.58072037]
curr_Stock_Price:  92.26626014880605
curr_Factors:  [92.26626015]
mat_Sqrt:  [[0.15]]
grads:  [-0.02492437]
Stock Position:  -0.02492436772204484
Bond Position:  [6.88039857]


portfolio before change:  [4.57115538]
curr_Stock_Price:  92.66727463807078
curr_Factors:  [92.66727464]
mat_Sqrt:  [[0.15]]
grads:  [0.17759532]
Stock Position:  0.1775953243549619
Bond Position:  [-11.88611932]


portfolio before change:  [4.48248134]
curr_Stock_Price:  92.17215386111037
curr_Factors:  [92.17215386]
mat_Sqrt:  [[0.15]]
grads:  [0.06080128]
Stock Position:  0.06080128378134446
Bond Position:  [-1.12170395]


portfolio before change:  [4.49104532]
curr_Stock_Price:  92.31415892971567
curr_Factors:  [92.31415893]
mat_Sqrt:  [[0.15]]
grads:  [-0.03351899]
Stock Position:  -0.03351899133602381
Bond Position:  [7.58532281]


portfolio before change:  [4.4915039]
curr_Stock_Price:  92.31462173001074
curr_Factors:  [92.31462173]
mat_Sqrt:  [[0.15]]
grads:  [0.12307003]
Stock Position:  0.12307002791536836
Bond Position:  [-6.86965917]


portfolio before change:  [4.44286097]
curr_Stock_Price:  91.92286460171836
curr_Factors:  [91.9228646]
mat_Sqrt:  [[0.15]]
grads:  [0.08399448]
Stock Position:  0.083994480129541
Bond Position:  [-3.27815225]


portfolio before change:  [4.45011681]
curr_Stock_Price:  92.01168860473425
curr_Factors:  [92.0116886]
mat_Sqrt:  [[0.15]]
grads:  [-0.08338679]
Stock Position:  -0.08338678912079286
Bond Position:  [12.12267608]


portfolio before change:  [4.44771489]
curr_Stock_Price:  92.04957962314293
curr_Factors:  [92.04957962]
mat_Sqrt:  [[0.15]]
grads:  [-0.09419553]
Stock Position:  -0.09419552777500603
Bond Position:  [13.11837362]


portfolio before change:  [4.4870821]
curr_Stock_Price:  91.64035338550215
curr_Factors:  [91.64035339]
mat_Sqrt:  [[0.15]]
grads:  [-0.29448511]
Stock Position:  -0.2944851148825247
Bond Position:  [31.47380209]


portfolio before change:  [4.43509881]
curr_Stock_Price:  91.82355607398479
curr_Factors:  [91.82355607]
mat_Sqrt:  [[0.15]]
grads:  [-0.08720408]
Stock Position:  -0.08720408275888894
Bond Position:  [12.44248779]


portfolio before change:  [4.378224]
curr_Stock_Price:  92.48467743349802
curr_Factors:  [92.48467743]
mat_Sqrt:  [[0.15]]
grads:  [-0.03284063]
Stock Position:  -0.03284062798222409
Bond Position:  [7.41547889]


portfolio before change:  [4.35667109]
curr_Stock_Price:  93.15507866583734
curr_Factors:  [93.15507867]
mat_Sqrt:  [[0.15]]
grads:  [-0.03159492]
Stock Position:  -0.031594917459631
Bond Position:  [7.29989811]


portfolio before change:  [4.36098297]
curr_Stock_Price:  93.033045548787
curr_Factors:  [93.03304555]
mat_Sqrt:  [[0.15]]
grads:  [0.39803353]
Stock Position:  0.39803353305176353
Bond Position:  [-32.66928884]


portfolio before change:  [4.20895761]
curr_Stock_Price:  92.65623440855907
curr_Factors:  [92.65623441]
mat_Sqrt:  [[0.15]]
grads:  [0.05736747]
Stock Position:  0.05736746560586318
Bond Position:  [-1.10649573]


portfolio before change:  [4.16949623]
curr_Stock_Price:  91.96956962787227
curr_Factors:  [91.96956963]
mat_Sqrt:  [[0.15]]
grads:  [0.01094896]
Stock Position:  0.01094896295143036
Bond Position:  [3.16252482]


portfolio before change:  [4.17137213]
curr_Stock_Price:  92.1228478285297
curr_Factors:  [92.12284783]
mat_Sqrt:  [[0.15]]
grads:  [0.1141369]
Stock Position:  0.1141368969274755
Bond Position:  [-6.34324385]


portfolio before change:  [4.13159945]
curr_Stock_Price:  91.77785671786873
curr_Factors:  [91.77785672]
mat_Sqrt:  [[0.15]]
grads:  [-0.12767201]
Stock Position:  -0.1276720080065365
Bond Position:  [15.84906271]


portfolio before change:  [4.23768222]
curr_Stock_Price:  90.95471489873273
curr_Factors:  [90.9547149]
mat_Sqrt:  [[0.15]]
grads:  [0.24434318]
Stock Position:  0.2443431760841834
Bond Position:  [-17.9864817]


portfolio before change:  [4.19703713]
curr_Stock_Price:  90.79297147449378
curr_Factors:  [90.79297147]
mat_Sqrt:  [[0.15]]
grads:  [-0.35278811]
Stock Position:  -0.3527881115412422
Bond Position:  [36.22771807]


portfolio before change:  [4.23381323]
curr_Stock_Price:  90.69514562443241
curr_Factors:  [90.69514562]
mat_Sqrt:  [[0.15]]
grads:  [-0.07303635]
Stock Position:  -0.07303635166049198
Bond Position:  [10.85785578]


portfolio before change:  [4.24946077]
curr_Stock_Price:  90.4901941895124
curr_Factors:  [90.49019419]
mat_Sqrt:  [[0.15]]
grads:  [0.05498693]
Stock Position:  0.05498692971304481
Bond Position:  [-0.72631718]


portfolio before change:  [4.27548905]
curr_Stock_Price:  90.96437364819293
curr_Factors:  [90.96437365]
mat_Sqrt:  [[0.15]]
grads:  [-0.11519524]
Stock Position:  -0.11519523912562514
Bond Position:  [14.75415182]


portfolio before change:  [4.28325247]
curr_Stock_Price:  90.90498522005053
curr_Factors:  [90.90498522]
mat_Sqrt:  [[0.15]]
grads:  [0.03158289]
Stock Position:  0.03158289347404903
Bond Position:  [1.41221001]


portfolio before change:  [4.25570037]
curr_Stock_Price:  90.02981638426232
curr_Factors:  [90.02981638]
mat_Sqrt:  [[0.15]]
grads:  [0.17189238]
Stock Position:  0.17189237655797104
Bond Position:  [-11.21973872]


portfolio before change:  [4.28310043]
curr_Stock_Price:  90.19329840839008
curr_Factors:  [90.19329841]
mat_Sqrt:  [[0.15]]
grads:  [-0.14362871]
Stock Position:  -0.14362870878580622
Bond Position:  [17.23744742]


portfolio before change:  [4.19685693]
curr_Stock_Price:  90.80126096179328
curr_Factors:  [90.80126096]
mat_Sqrt:  [[0.15]]
grads:  [-0.43230919]
Stock Position:  -0.4323091863902188
Bond Position:  [43.45107618]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.19685693]
Stock Price:  90.33853668146259
PL:  [4.19685693]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-9.52564242e-02]
 [ 6.07828269e-03]
 [ 3.36172137e-04]
 [ 2.22179876e-03]
 [ 5.44536118e-03]
 [ 1.19739245e-02]
 [-5.60073319e-05]
 [ 7.10832285e-03]
 [-9.30736683e-03]
 [-1.06432280e-02]
 [ 1.01183704e-02]
 [-1.05730135e-02]
 [ 2.75616860e-02]
 [ 1.15880585e-02]
 [-5.97304064e-03]
 [-7.38489538e-03]
 [ 1.25113995e-02]
 [ 2.47430335e-02]
 [ 7.95172058e-03]
 [-1.82073474e-03]
 [ 4.89218246e-02]
 [-1.28312477e-02]
 [ 7.45531587e-03]
 [ 3.35655378e-03]
 [ 1.15848559e-02]
 [-7.41390281e-03]
 [ 1.31159322e-02]
 [ 4.01743392e-04]
 [ 4.46101885e-03]
 [-2.68404401e-02]
 [-5.35731283e-03]
 [ 2.07171311e-02]
 [ 7.65353333e-03]
 [ 1.06918029e-02]
 [-2.01516953e-03]
 [-3.34462080e-03]
 [-5.12151438e-03]
 [ 1.13408070e-02]
 [ 1.28760054e-03]
 [-1.39474532e-02]
 [ 1.76315888e-02]
 [-2.25973639e-03]
 [ 3.71129430e-03]
 [-8.97710357e-03]
 [ 2.49767745e-03]
 [-2.89735947e-03]
 [-1.36926075e-02]
 [-5.15231008e-03]
 [-3.29333440e-03]
 [ 1.01221344e-02]
 [-2.98386675e-03]
 [ 3.73305994e-03]
 [ 7.20845763e-04]
 [-6.94251112e-04]
 [ 2.41172374e-03]
 [ 8.82228242e-03]
 [ 1.18436996e-02]
 [-2.15249689e-02]
 [ 1.39541005e-02]
 [ 3.36487538e-03]
 [ 4.64929842e-03]
 [-1.68120109e-02]
 [-1.27086015e-02]
 [-1.08474556e-03]
 [-1.07089219e-02]
 [-3.22384545e-03]
 [ 1.03648984e-02]
 [ 2.31005599e-03]
 [ 9.82401475e-03]
 [-1.73437109e-02]
 [ 1.94009756e-03]
 [ 1.93213031e-03]
 [ 8.28183850e-04]
 [ 8.40911906e-03]
 [ 5.78722594e-03]
 [-7.30419852e-03]
 [-2.92607791e-03]
 [-8.69828060e-03]
 [ 5.01726812e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.59648411]
curr_Stock_Price:  101.12666702021629
curr_Factors:  [101.12666702]
mat_Sqrt:  [[0.15]]
grads:  [-0.63504283]
Stock Position:  -0.6350428280852668
Bond Position:  [83.81624873]


portfolio before change:  [18.99441486]
curr_Stock_Price:  102.08299297045299
curr_Factors:  [102.08299297]
mat_Sqrt:  [[0.15]]
grads:  [0.04052188]
Stock Position:  0.040521884612199424
Bond Position:  [14.85781959]


portfolio before change:  [18.93289341]
curr_Stock_Price:  100.54184814298348
curr_Factors:  [100.54184814]
mat_Sqrt:  [[0.15]]
grads:  [0.00224115]
Stock Position:  0.0022411475789150255
Bond Position:  [18.70756429]


portfolio before change:  [18.93363196]
curr_Stock_Price:  100.34966891146247
curr_Factors:  [100.34966891]
mat_Sqrt:  [[0.15]]
grads:  [0.01481199]
Stock Position:  0.014811991714374074
Bond Position:  [17.4472535]


portfolio before change:  [18.94528694]
curr_Stock_Price:  101.06290783076876
curr_Factors:  [101.06290783]
mat_Sqrt:  [[0.15]]
grads:  [0.03630241]
Stock Position:  0.03630240783774933
Bond Position:  [15.27646004]


portfolio before change:  [18.94697423]
curr_Stock_Price:  101.08308508101797
curr_Factors:  [101.08308508]
mat_Sqrt:  [[0.15]]
grads:  [0.07982616]
Stock Position:  0.07982616346864262
Bond Position:  [10.87789936]


portfolio before change:  [18.98415312]
curr_Stock_Price:  101.54031605543223
curr_Factors:  [101.54031606]
mat_Sqrt:  [[0.15]]
grads:  [-0.00037338]
Stock Position:  -0.0003733822129533088
Bond Position:  [19.02206646]


portfolio before change:  [18.98546966]
curr_Stock_Price:  101.19849332072553
curr_Factors:  [101.19849332]
mat_Sqrt:  [[0.15]]
grads:  [0.04738882]
Stock Position:  0.04738881897123705
Bond Position:  [14.18979258]


portfolio before change:  [19.01694925]
curr_Stock_Price:  101.84406114876198
curr_Factors:  [101.84406115]
mat_Sqrt:  [[0.15]]
grads:  [-0.06204911]
Stock Position:  -0.062049112174318834
Bond Position:  [25.33628282]


portfolio before change:  [19.03053537]
curr_Stock_Price:  101.65062484019889
curr_Factors:  [101.65062484]
mat_Sqrt:  [[0.15]]
grads:  [-0.07095485]
Stock Position:  -0.07095485363882476
Bond Position:  [26.24314057]


portfolio before change:  [19.05833465]
curr_Stock_Price:  101.2819532377862
curr_Factors:  [101.28195324]
mat_Sqrt:  [[0.15]]
grads:  [0.0674558]
Stock Position:  0.06745580257299769
Bond Position:  [12.22627921]


portfolio before change:  [19.12367056]
curr_Stock_Price:  102.23919842200976
curr_Factors:  [102.23919842]
mat_Sqrt:  [[0.15]]
grads:  [-0.07048676]
Stock Position:  -0.07048675677615855
Bond Position:  [26.33018007]


portfolio before change:  [19.09859839]
curr_Stock_Price:  102.61824640233276
curr_Factors:  [102.6182464]
mat_Sqrt:  [[0.15]]
grads:  [0.18374457]
Stock Position:  0.18374457337299072
Bond Position:  [0.24305248]


portfolio before change:  [19.0545452]
curr_Stock_Price:  102.37841141410453
curr_Factors:  [102.37841141]
mat_Sqrt:  [[0.15]]
grads:  [0.07725372]
Stock Position:  0.07725372366625297
Bond Position:  [11.1454317]


portfolio before change:  [19.07911486]
curr_Stock_Price:  102.68743272621842
curr_Factors:  [102.68743273]
mat_Sqrt:  [[0.15]]
grads:  [-0.03982027]
Stock Position:  -0.039820270949830344
Bond Position:  [23.16815625]


portfolio before change:  [19.04834991]
curr_Stock_Price:  103.4963925678421
curr_Factors:  [103.49639257]
mat_Sqrt:  [[0.15]]
grads:  [-0.04923264]
Stock Position:  -0.049232635864029026
Bond Position:  [24.14375012]


portfolio before change:  [19.06425091]
curr_Stock_Price:  103.20406688941571
curr_Factors:  [103.20406689]
mat_Sqrt:  [[0.15]]
grads:  [0.08340933]
Stock Position:  0.08340933003594962
Bond Position:  [10.45606883]


portfolio before change:  [19.0655149]
curr_Stock_Price:  103.21138585380015
curr_Factors:  [103.21138585]
mat_Sqrt:  [[0.15]]
grads:  [0.16495356]
Stock Position:  0.1649535566334871
Bond Position:  [2.04042972]


portfolio before change:  [19.00034508]
curr_Stock_Price:  102.81553286633604
curr_Factors:  [102.81553287]
mat_Sqrt:  [[0.15]]
grads:  [0.05301147]
Stock Position:  0.05301147051621551
Bond Position:  [13.54994249]


portfolio before change:  [18.98983369]
curr_Stock_Price:  102.60127192254367
curr_Factors:  [102.60127192]
mat_Sqrt:  [[0.15]]
grads:  [-0.01213823]
Stock Position:  -0.012138231620035286
Bond Position:  [20.23523169]


portfolio before change:  [18.99510209]
curr_Stock_Price:  102.27143331448936
curr_Factors:  [102.27143331]
mat_Sqrt:  [[0.15]]
grads:  [0.3261455]
Stock Position:  0.3261454973915295
Bond Position:  [-14.3602654]


portfolio before change:  [18.92801838]
curr_Stock_Price:  102.06849884293963
curr_Factors:  [102.06849884]
mat_Sqrt:  [[0.15]]
grads:  [-0.08554165]
Stock Position:  -0.08554165148617843
Bond Position:  [27.65912633]


portfolio before change:  [18.97125887]
curr_Stock_Price:  101.58321781818
curr_Factors:  [101.58321782]
mat_Sqrt:  [[0.15]]
grads:  [0.04970211]
Stock Position:  0.049702105822813016
Bond Position:  [13.92235903]


portfolio before change:  [18.9405651]
curr_Stock_Price:  100.94815529878508
curr_Factors:  [100.9481553]
mat_Sqrt:  [[0.15]]
grads:  [0.02237703]
Stock Position:  0.022377025231816006
Bond Position:  [16.68164568]


portfolio before change:  [18.91409515]
curr_Stock_Price:  99.71865375918655
curr_Factors:  [99.71865376]
mat_Sqrt:  [[0.15]]
grads:  [0.07723237]
Stock Position:  0.07723237287237407
Bond Position:  [11.2125869]


portfolio before change:  [18.96990356]
curr_Stock_Price:  100.4321836998098
curr_Factors:  [100.4321837]
mat_Sqrt:  [[0.15]]
grads:  [-0.04942602]
Stock Position:  -0.049426018732189075
Bond Position:  [23.93386656]


portfolio before change:  [18.96993277]
curr_Stock_Price:  100.46185851791658
curr_Factors:  [100.46185852]
mat_Sqrt:  [[0.15]]
grads:  [0.08743955]
Stock Position:  0.0874395477139382
Bond Position:  [10.1855933]


portfolio before change:  [18.99966131]
curr_Stock_Price:  100.79456745842776
curr_Factors:  [100.79456746]
mat_Sqrt:  [[0.15]]
grads:  [0.00267829]
Stock Position:  0.002678289277385805
Bond Position:  [18.7297043]


portfolio before change:  [19.00235305]
curr_Stock_Price:  101.3625050550953
curr_Factors:  [101.36250506]
mat_Sqrt:  [[0.15]]
grads:  [0.02974013]
Stock Position:  0.029740125694593944
Bond Position:  [15.98781941]


portfolio before change:  [18.99879145]
curr_Stock_Price:  101.20914745845604
curr_Factors:  [101.20914746]
mat_Sqrt:  [[0.15]]
grads:  [-0.17893627]
Stock Position:  -0.1789362673731122
Bond Position:  [37.10877852]


portfolio before change:  [18.95347]
curr_Stock_Price:  101.4753920837581
curr_Factors:  [101.47539208]
mat_Sqrt:  [[0.15]]
grads:  [-0.03571542]
Stock Position:  -0.03571541885810614
Bond Position:  [22.57770613]


portfolio before change:  [18.95454367]
curr_Stock_Price:  101.48484119445213
curr_Factors:  [101.48484119]
mat_Sqrt:  [[0.15]]
grads:  [0.13811421]
Stock Position:  0.1381142070727332
Bond Position:  [4.9380453]


portfolio before change:  [18.97719758]
curr_Stock_Price:  101.64662957301559
curr_Factors:  [101.64662957]
mat_Sqrt:  [[0.15]]
grads:  [0.05102356]
Stock Position:  0.05102355554461012
Bond Position:  [13.79082513]


portfolio before change:  [18.9467821]
curr_Stock_Price:  101.03362962656566
curr_Factors:  [101.03362963]
mat_Sqrt:  [[0.15]]
grads:  [0.07127869]
Stock Position:  0.0712786859558678
Bond Position:  [11.74523774]


portfolio before change:  [18.99778705]
curr_Stock_Price:  101.73890140360432
curr_Factors:  [101.7389014]
mat_Sqrt:  [[0.15]]
grads:  [-0.01343446]
Stock Position:  -0.013434463525237503
Bond Position:  [20.36459461]


portfolio before change:  [19.01338687]
curr_Stock_Price:  100.67246561829738
curr_Factors:  [100.67246562]
mat_Sqrt:  [[0.15]]
grads:  [-0.02229747]
Stock Position:  -0.022297472003690803
Bond Position:  [21.25812835]


portfolio before change:  [19.01850431]
curr_Stock_Price:  100.50254635493927
curr_Factors:  [100.50254635]
mat_Sqrt:  [[0.15]]
grads:  [-0.03414343]
Stock Position:  -0.03414342920317975
Bond Position:  [22.45000589]


portfolio before change:  [19.06384519]
curr_Stock_Price:  99.21568946857525
curr_Factors:  [99.21568947]
mat_Sqrt:  [[0.15]]
grads:  [0.07560538]
Stock Position:  0.07560538016166889
Bond Position:  [11.56260527]


portfolio before change:  [19.05920147]
curr_Stock_Price:  99.14471037893897
curr_Factors:  [99.14471038]
mat_Sqrt:  [[0.15]]
grads:  [0.008584]
Stock Position:  0.008584003611599948
Bond Position:  [18.20814292]


portfolio before change:  [19.05760671]
curr_Stock_Price:  98.82634965707227
curr_Factors:  [98.82634966]
mat_Sqrt:  [[0.15]]
grads:  [-0.09298302]
Stock Position:  -0.09298302150003254
Bond Position:  [28.2467793]


portfolio before change:  [19.08590675]
curr_Stock_Price:  98.54097969639903
curr_Factors:  [98.5409797]
mat_Sqrt:  [[0.15]]
grads:  [0.11754393]
Stock Position:  0.11754392515684327
Bond Position:  [7.5030132]


portfolio before change:  [19.16581785]
curr_Stock_Price:  99.21683043848448
curr_Factors:  [99.21683044]
mat_Sqrt:  [[0.15]]
grads:  [-0.01506491]
Stock Position:  -0.015064909242796524
Bond Position:  [20.66051039]


portfolio before change:  [19.1715787]
curr_Stock_Price:  98.92014569353161
curr_Factors:  [98.92014569]
mat_Sqrt:  [[0.15]]
grads:  [0.02474196]
Stock Position:  0.024741961986002797
Bond Position:  [16.72410021]


portfolio before change:  [19.17818576]
curr_Stock_Price:  99.1449369860087
curr_Factors:  [99.14493699]
mat_Sqrt:  [[0.15]]
grads:  [-0.05984736]
Stock Position:  -0.059847357151290644
Bond Position:  [25.11174822]


portfolio before change:  [19.17790723]
curr_Stock_Price:  99.17581668852006
curr_Factors:  [99.17581669]
mat_Sqrt:  [[0.15]]
grads:  [0.01665118]
Stock Position:  0.01665118301055328
Bond Position:  [17.52651256]


portfolio before change:  [19.17930376]
curr_Stock_Price:  99.19389868296851
curr_Factors:  [99.19389868]
mat_Sqrt:  [[0.15]]
grads:  [-0.01931573]
Stock Position:  -0.019315729807453785
Bond Position:  [21.0953063]


portfolio before change:  [19.16929943]
curr_Stock_Price:  99.78009557031723
curr_Factors:  [99.78009557]
mat_Sqrt:  [[0.15]]
grads:  [-0.09128405]
Stock Position:  -0.09128404977833325
Bond Position:  [28.27763065]


portfolio before change:  [19.11330594]
curr_Stock_Price:  100.41285565844609
curr_Factors:  [100.41285566]
mat_Sqrt:  [[0.15]]
grads:  [-0.03434873]
Stock Position:  -0.03434873389251324
Bond Position:  [22.5623604]


portfolio before change:  [19.12228338]
curr_Stock_Price:  100.19254922742167
curr_Factors:  [100.19254923]
mat_Sqrt:  [[0.15]]
grads:  [-0.02195556]
Stock Position:  -0.021955562651856435
Bond Position:  [21.32206717]


portfolio before change:  [19.12797843]
curr_Stock_Price:  99.99385772423638
curr_Factors:  [99.99385772]
mat_Sqrt:  [[0.15]]
grads:  [0.0674809]
Stock Position:  0.06748089620968854
Bond Position:  [12.3803033]


portfolio before change:  [19.13613204]
curr_Stock_Price:  100.10321932850795
curr_Factors:  [100.10321933]
mat_Sqrt:  [[0.15]]
grads:  [-0.01989244]
Stock Position:  -0.01989244497427638
Bond Position:  [21.12742983]


portfolio before change:  [19.133886]
curr_Stock_Price:  100.28251078212388
curr_Factors:  [100.28251078]
mat_Sqrt:  [[0.15]]
grads:  [0.02488707]
Stock Position:  0.02488706629383481
Bond Position:  [16.63814851]


portfolio before change:  [19.13981237]
curr_Stock_Price:  100.4788558965977
curr_Factors:  [100.4788559]
mat_Sqrt:  [[0.15]]
grads:  [0.00480564]
Stock Position:  0.0048056384189229355
Bond Position:  [18.65694732]


portfolio before change:  [19.14207698]
curr_Stock_Price:  100.70744264598716
curr_Factors:  [100.70744265]
mat_Sqrt:  [[0.15]]
grads:  [-0.00462834]
Stock Position:  -0.004628340747930652
Bond Position:  [19.60818534]


portfolio before change:  [19.14340588]
curr_Stock_Price:  100.68511094763954
curr_Factors:  [100.68511095]
mat_Sqrt:  [[0.15]]
grads:  [0.01607816]
Stock Position:  0.016078158249617485
Bond Position:  [17.52457474]


portfolio before change:  [19.13397685]
curr_Stock_Price:  100.03053634005522
curr_Factors:  [100.03053634]
mat_Sqrt:  [[0.15]]
grads:  [0.05881522]
Stock Position:  0.058815216129292844
Bond Position:  [13.25065924]


portfolio before change:  [19.12742012]
curr_Stock_Price:  99.9049748641955
curr_Factors:  [99.90497486]
mat_Sqrt:  [[0.15]]
grads:  [0.078958]
Stock Position:  0.07895799730601635
Bond Position:  [11.23912338]


portfolio before change:  [19.04385913]
curr_Stock_Price:  98.83778142316909
curr_Factors:  [98.83778142]
mat_Sqrt:  [[0.15]]
grads:  [-0.14349979]
Stock Position:  -0.1434997924544799
Bond Position:  [33.22706025]


portfolio before change:  [18.99793535]
curr_Stock_Price:  99.17228040503456
curr_Factors:  [99.17228041]
mat_Sqrt:  [[0.15]]
grads:  [0.09302734]
Stock Position:  0.09302733647549596
Bond Position:  [9.77220225]


portfolio before change:  [18.94798442]
curr_Stock_Price:  98.62876584049322
curr_Factors:  [98.62876584]
mat_Sqrt:  [[0.15]]
grads:  [0.0224325]
Stock Position:  0.0224325025473428
Bond Position:  [16.73549438]


portfolio before change:  [18.94386421]
curr_Stock_Price:  98.39846585282258
curr_Factors:  [98.39846585]
mat_Sqrt:  [[0.15]]
grads:  [0.03099532]
Stock Position:  0.030995322768058386
Bond Position:  [15.89397201]


portfolio before change:  [18.9093964]
curr_Stock_Price:  97.25438291180748
curr_Factors:  [97.25438291]
mat_Sqrt:  [[0.15]]
grads:  [-0.11208007]
Stock Position:  -0.11208007288282043
Bond Position:  [29.80967472]


portfolio before change:  [18.8992209]
curr_Stock_Price:  97.36179417182937
curr_Factors:  [97.36179417]
mat_Sqrt:  [[0.15]]
grads:  [-0.08472401]
Stock Position:  -0.08472400996746851
Bond Position:  [27.14810252]


portfolio before change:  [18.83888097]
curr_Stock_Price:  98.09401564600498
curr_Factors:  [98.09401565]
mat_Sqrt:  [[0.15]]
grads:  [-0.00723164]
Stock Position:  -0.00723163708958435
Bond Position:  [19.54826129]


portfolio before change:  [18.84133083]
curr_Stock_Price:  97.92419914930915
curr_Factors:  [97.92419915]
mat_Sqrt:  [[0.15]]
grads:  [-0.07139281]
Stock Position:  -0.07139281237117874
Bond Position:  [25.8324148]


portfolio before change:  [18.797786]
curr_Stock_Price:  98.556747384358
curr_Factors:  [98.55674738]
mat_Sqrt:  [[0.15]]
grads:  [-0.0214923]
Stock Position:  -0.021492303012036914
Bond Position:  [20.91599748]


portfolio before change:  [18.80813873]
curr_Stock_Price:  98.1358788723716
curr_Factors:  [98.13587887]
mat_Sqrt:  [[0.15]]
grads:  [0.06909932]
Stock Position:  0.06909932252200245
Bond Position:  [12.02701598]


portfolio before change:  [18.78006019]
curr_Stock_Price:  97.71864969672413
curr_Factors:  [97.7186497]
mat_Sqrt:  [[0.15]]
grads:  [0.01540037]
Stock Position:  0.01540037328354849
Bond Position:  [17.27515651]


portfolio before change:  [18.78498255]
curr_Stock_Price:  97.96816530176214
curr_Factors:  [97.9681653]
mat_Sqrt:  [[0.15]]
grads:  [0.06549343]
Stock Position:  0.06549343165421606
Bond Position:  [12.36871121]


portfolio before change:  [18.77251049]
curr_Stock_Price:  97.76592934727019
curr_Factors:  [97.76592935]
mat_Sqrt:  [[0.15]]
grads:  [-0.11562474]
Stock Position:  -0.11562473930323197
Bond Position:  [30.07667059]


portfolio before change:  [18.7790788]
curr_Stock_Price:  97.72538049163423
curr_Factors:  [97.72538049]
mat_Sqrt:  [[0.15]]
grads:  [0.01293398]
Stock Position:  0.012933983739443832
Bond Position:  [17.51510031]


portfolio before change:  [18.77928883]
curr_Stock_Price:  97.6569795587505
curr_Factors:  [97.65697956]
mat_Sqrt:  [[0.15]]
grads:  [0.01288087]
Stock Position:  0.0128808687625701
Bond Position:  [17.52138209]


portfolio before change:  [18.78731893]
curr_Stock_Price:  98.19537369454459
curr_Factors:  [98.19537369]
mat_Sqrt:  [[0.15]]
grads:  [0.00552123]
Stock Position:  0.005521225667599371
Bond Position:  [18.24516011]


portfolio before change:  [18.78726685]
curr_Stock_Price:  97.97940045768833
curr_Factors:  [97.97940046]
mat_Sqrt:  [[0.15]]
grads:  [0.05606079]
Stock Position:  0.05606079373188195
Bond Position:  [13.29446389]


portfolio before change:  [18.81183245]
curr_Stock_Price:  98.40277417635696
curr_Factors:  [98.40277418]
mat_Sqrt:  [[0.15]]
grads:  [0.03858151]
Stock Position:  0.038581506253929344
Bond Position:  [15.0153052]


portfolio before change:  [18.8625011]
curr_Stock_Price:  99.69173808826967
curr_Factors:  [99.69173809]
mat_Sqrt:  [[0.15]]
grads:  [-0.04869466]
Stock Position:  -0.04869465677224622
Bond Position:  [23.71695607]


portfolio before change:  [18.86100229]
curr_Stock_Price:  99.75295979773556
curr_Factors:  [99.7529598]
mat_Sqrt:  [[0.15]]
grads:  [-0.01950719]
Stock Position:  -0.01950718604870179
Bond Position:  [20.80690184]


portfolio before change:  [18.86253747]
curr_Stock_Price:  99.7409279435183
curr_Factors:  [99.74092794]
mat_Sqrt:  [[0.15]]
grads:  [-0.05798854]
Stock Position:  -0.05798853735688232
Bond Position:  [24.646368]


portfolio before change:  [18.85409571]
curr_Stock_Price:  99.913069046915
curr_Factors:  [99.91306905]
mat_Sqrt:  [[0.15]]
grads:  [0.00334485]
Stock Position:  0.0033448454164899484
Bond Position:  [18.51990193]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.85409571]
Stock Price:  99.50697998324793
PL:  [18.85409571]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.53047295e-02]
 [ 5.12992406e-03]
 [ 5.84617605e-04]
 [ 2.17135506e-03]
 [ 2.14088810e-02]
 [ 9.06263773e-03]
 [ 5.85992398e-04]
 [ 1.04898721e-02]
 [ 3.24604756e-03]
 [-2.02573404e-02]
 [ 1.00742551e-02]
 [-7.10231636e-03]
 [ 8.27854707e-03]
 [ 4.05555524e-03]
 [-1.07825354e-03]
 [-8.20449783e-03]
 [ 1.32573341e-02]
 [ 2.64318380e-02]
 [ 1.59418205e-02]
 [-2.31596443e-03]
 [ 3.70232184e-02]
 [-1.05560126e-02]
 [ 9.66370376e-04]
 [ 1.31188469e-03]
 [ 1.78487727e-02]
 [ 1.63429732e-02]
 [ 8.67470755e-03]
 [-1.21428087e-03]
 [ 5.99588818e-03]
 [-1.09090781e-02]
 [-5.75301851e-03]
 [ 4.06174618e-02]
 [ 4.76131822e-03]
 [-7.99350275e-03]
 [-6.01377255e-03]
 [-4.27843572e-03]
 [-3.44091213e-03]
 [-3.41771168e-03]
 [ 6.16327778e-03]
 [-6.22762282e-03]
 [-6.30446493e-02]
 [-5.03007505e-03]
 [ 1.82134450e-02]
 [-1.53125523e-02]
 [-5.33944616e-03]
 [ 2.81588617e-03]
 [-1.35813408e-02]
 [ 1.88351019e-02]
 [ 2.17925500e-02]
 [-1.21617819e-02]
 [-4.34268362e-03]
 [ 3.66964002e-03]
 [ 3.39032421e-03]
 [-2.55743342e-03]
 [-1.07143090e-02]
 [ 1.18563834e-02]
 [-3.11127786e-02]
 [-9.70000773e-03]
 [ 1.98817986e-02]
 [-5.55665009e-03]
 [ 1.30793597e-02]
 [-1.37768671e-02]
 [-1.26496888e-02]
 [-2.27910639e-03]
 [ 1.42230517e-01]
 [-1.24379108e-02]
 [ 1.77632505e-03]
 [ 6.89671013e-03]
 [ 1.62392110e-02]
 [-3.33937273e-02]
 [-8.01053177e-03]
 [-3.49033202e-03]
 [ 2.17998873e-02]
 [ 3.09997354e-03]
 [-2.99963919e-03]
 [ 5.90584290e-03]
 [ 5.86538295e-04]
 [-2.00638461e-03]
 [ 2.01811035e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.43834725]
curr_Stock_Price:  100.28098488519714
curr_Factors:  [100.28098489]
mat_Sqrt:  [[0.15]]
grads:  [-0.30203153]
Stock Position:  -0.3020315296933909
Bond Position:  [36.72636652]


portfolio before change:  [6.79382021]
curr_Stock_Price:  99.11164508698826
curr_Factors:  [99.11164509]
mat_Sqrt:  [[0.15]]
grads:  [0.03419949]
Stock Position:  0.034199493739142
Bond Position:  [3.40425213]


portfolio before change:  [6.8239302]
curr_Stock_Price:  99.98584567612521
curr_Factors:  [99.98584568]
mat_Sqrt:  [[0.15]]
grads:  [0.00389745]
Stock Position:  0.0038974507019588246
Bond Position:  [6.4342403]


portfolio before change:  [6.82473548]
curr_Stock_Price:  100.08927843150197
curr_Factors:  [100.08927843]
mat_Sqrt:  [[0.15]]
grads:  [0.0144757]
Stock Position:  0.01447570037590699
Bond Position:  [5.37587307]


portfolio before change:  [6.82253206]
curr_Stock_Price:  99.91385193205545
curr_Factors:  [99.91385193]
mat_Sqrt:  [[0.15]]
grads:  [0.14272587]
Stock Position:  0.1427258731561859
Bond Position:  [-7.4377597]


portfolio before change:  [6.71447501]
curr_Stock_Price:  99.16001397973916
curr_Factors:  [99.16001398]
mat_Sqrt:  [[0.15]]
grads:  [0.06041758]
Stock Position:  0.06041758489574729
Bond Position:  [0.72346644]


portfolio before change:  [6.72832512]
curr_Stock_Price:  99.38850537882053
curr_Factors:  [99.38850538]
mat_Sqrt:  [[0.15]]
grads:  [0.00390662]
Stock Position:  0.003906615986333501
Bond Position:  [6.3400524]


portfolio before change:  [6.73077249]
curr_Stock_Price:  99.91353791321063
curr_Factors:  [99.91353791]
mat_Sqrt:  [[0.15]]
grads:  [0.06993248]
Stock Position:  0.06993248075657933
Bond Position:  [-0.25642908]


portfolio before change:  [6.77391908]
curr_Stock_Price:  100.53074205604585
curr_Factors:  [100.53074206]
mat_Sqrt:  [[0.15]]
grads:  [0.02164032]
Stock Position:  0.02164031703547247
Bond Position:  [4.59840195]


portfolio before change:  [6.77348433]
curr_Stock_Price:  100.4973709499013
curr_Factors:  [100.49737095]
mat_Sqrt:  [[0.15]]
grads:  [-0.13504894]
Stock Position:  -0.1350489358536591
Bond Position:  [20.34554733]


portfolio before change:  [6.64021121]
curr_Stock_Price:  101.49363760137106
curr_Factors:  [101.4936376]
mat_Sqrt:  [[0.15]]
grads:  [0.0671617]
Stock Position:  0.06716170076637698
Bond Position:  [-0.17627411]


portfolio before change:  [6.60491668]
curr_Stock_Price:  100.96828595624578
curr_Factors:  [100.96828596]
mat_Sqrt:  [[0.15]]
grads:  [-0.04734878]
Stock Position:  -0.04734877575012713
Bond Position:  [11.38564141]


portfolio before change:  [6.60215865]
curr_Stock_Price:  101.04156465327549
curr_Factors:  [101.04156465]
mat_Sqrt:  [[0.15]]
grads:  [0.05519031]
Stock Position:  0.05519031380852145
Bond Position:  [1.02564299]


portfolio before change:  [6.61768139]
curr_Stock_Price:  101.3216615376927
curr_Factors:  [101.32166154]
mat_Sqrt:  [[0.15]]
grads:  [0.02703703]
Stock Position:  0.02703703493229922
Bond Position:  [3.87824409]


portfolio before change:  [6.63319229]
curr_Stock_Price:  101.8863868698729
curr_Factors:  [101.88638687]
mat_Sqrt:  [[0.15]]
grads:  [-0.00718836]
Stock Position:  -0.007188356926460758
Bond Position:  [7.365588]


portfolio before change:  [6.62487199]
curr_Stock_Price:  103.10789886482235
curr_Factors:  [103.10789886]
mat_Sqrt:  [[0.15]]
grads:  [-0.05469665]
Stock Position:  -0.05469665220477268
Bond Position:  [12.26452887]


portfolio before change:  [6.61230308]
curr_Stock_Price:  103.35170656574412
curr_Factors:  [103.35170657]
mat_Sqrt:  [[0.15]]
grads:  [0.08838223]
Stock Position:  0.0883822272644967
Bond Position:  [-2.52215094]


portfolio before change:  [6.57058774]
curr_Stock_Price:  102.88150234210747
curr_Factors:  [102.88150234]
mat_Sqrt:  [[0.15]]
grads:  [0.17621225]
Stock Position:  0.17621225303772647
Bond Position:  [-11.55839358]


portfolio before change:  [6.47249287]
curr_Stock_Price:  102.32891619817309
curr_Factors:  [102.3289162]
mat_Sqrt:  [[0.15]]
grads:  [0.1062788]
Stock Position:  0.10627880309480481
Bond Position:  [-4.40290186]


portfolio before change:  [6.53468959]
curr_Stock_Price:  102.91672775063108
curr_Factors:  [102.91672775]
mat_Sqrt:  [[0.15]]
grads:  [-0.01543976]
Stock Position:  -0.015439762837129115
Bond Position:  [8.12369946]


portfolio before change:  [6.53598968]
curr_Stock_Price:  102.86540951833267
curr_Factors:  [102.86540952]
mat_Sqrt:  [[0.15]]
grads:  [0.24682146]
Stock Position:  0.2468214560745751
Bond Position:  [-18.85340048]


portfolio before change:  [6.70079366]
curr_Stock_Price:  103.53788898201758
curr_Factors:  [103.53788898]
mat_Sqrt:  [[0.15]]
grads:  [-0.07037342]
Stock Position:  -0.07037341705563295
Bond Position:  [13.98710871]


portfolio before change:  [6.70920071]
curr_Stock_Price:  103.4308482361324
curr_Factors:  [103.43084824]
mat_Sqrt:  [[0.15]]
grads:  [0.00644247]
Stock Position:  0.00644246917253005
Bond Position:  [6.04285066]


portfolio before change:  [6.71065041]
curr_Stock_Price:  103.59724651799739
curr_Factors:  [103.59724652]
mat_Sqrt:  [[0.15]]
grads:  [0.0087459]
Stock Position:  0.008745897912541527
Bond Position:  [5.80459947]


portfolio before change:  [6.70725515]
curr_Stock_Price:  103.16755238990731
curr_Factors:  [103.16755239]
mat_Sqrt:  [[0.15]]
grads:  [0.11899182]
Stock Position:  0.11899181789625161
Bond Position:  [-5.56883945]


portfolio before change:  [6.77664728]
curr_Stock_Price:  103.75364467730935
curr_Factors:  [103.75364468]
mat_Sqrt:  [[0.15]]
grads:  [0.10895315]
Stock Position:  0.10895315490326847
Bond Position:  [-4.52763964]


portfolio before change:  [6.74664612]
curr_Stock_Price:  103.4808836901891
curr_Factors:  [103.48088369]
mat_Sqrt:  [[0.15]]
grads:  [0.05783138]
Stock Position:  0.05783138363830882
Bond Position:  [0.76220344]


portfolio before change:  [6.75081619]
curr_Stock_Price:  103.55216726974834
curr_Factors:  [103.55216727]
mat_Sqrt:  [[0.15]]
grads:  [-0.00809521]
Stock Position:  -0.008095205832629345
Bond Position:  [7.58909229]


portfolio before change:  [6.75972292]
curr_Stock_Price:  102.51051358570754
curr_Factors:  [102.51051359]
mat_Sqrt:  [[0.15]]
grads:  [0.03997259]
Stock Position:  0.03997258784150827
Bond Position:  [2.66211241]


portfolio before change:  [6.78547773]
curr_Stock_Price:  103.15066289020005
curr_Factors:  [103.15066289]
mat_Sqrt:  [[0.15]]
grads:  [-0.07272719]
Stock Position:  -0.07272718729781615
Bond Position:  [14.28733531]


portfolio before change:  [6.73654727]
curr_Stock_Price:  103.83573610516729
curr_Factors:  [103.83573611]
mat_Sqrt:  [[0.15]]
grads:  [-0.03835346]
Stock Position:  -0.038353456759854555
Bond Position:  [10.71900669]


portfolio before change:  [6.74940037]
curr_Stock_Price:  103.5180817874401
curr_Factors:  [103.51808179]
mat_Sqrt:  [[0.15]]
grads:  [0.27078308]
Stock Position:  0.27078307867541695
Bond Position:  [-21.28154451]


portfolio before change:  [6.84838892]
curr_Stock_Price:  103.88855799614839
curr_Factors:  [103.888558]
mat_Sqrt:  [[0.15]]
grads:  [0.03174212]
Stock Position:  0.03174212145936592
Bond Position:  [3.55074569]


portfolio before change:  [6.87204993]
curr_Stock_Price:  104.62697993368491
curr_Factors:  [104.62697993]
mat_Sqrt:  [[0.15]]
grads:  [-0.05329002]
Stock Position:  -0.05329001832375458
Bond Position:  [12.44762361]


portfolio before change:  [6.90581966]
curr_Stock_Price:  104.00788216378065
curr_Factors:  [104.00788216]
mat_Sqrt:  [[0.15]]
grads:  [-0.04009182]
Stock Position:  -0.04009181703099825
Bond Position:  [11.07568464]


portfolio before change:  [6.92265048]
curr_Stock_Price:  103.60534189568706
curr_Factors:  [103.6053419]
mat_Sqrt:  [[0.15]]
grads:  [-0.0285229]
Stock Position:  -0.028522904825694993
Bond Position:  [9.87777579]


portfolio before change:  [6.90325823]
curr_Stock_Price:  104.30687062933131
curr_Factors:  [104.30687063]
mat_Sqrt:  [[0.15]]
grads:  [-0.02293941]
Stock Position:  -0.02293941419100135
Bond Position:  [9.29599673]


portfolio before change:  [6.87728282]
curr_Stock_Price:  105.46454742543766
curr_Factors:  [105.46454743]
mat_Sqrt:  [[0.15]]
grads:  [-0.02278474]
Stock Position:  -0.02278474454006644
Bond Position:  [9.28026559]


portfolio before change:  [6.88412]
curr_Stock_Price:  105.18992718612238
curr_Factors:  [105.18992719]
mat_Sqrt:  [[0.15]]
grads:  [0.04108852]
Stock Position:  0.04108851853495591
Bond Position:  [2.56202173]


portfolio before change:  [6.90336062]
curr_Stock_Price:  105.65430235234642
curr_Factors:  [105.65430235]
mat_Sqrt:  [[0.15]]
grads:  [-0.04151749]
Stock Position:  -0.04151748544114452
Bond Position:  [11.28986158]


portfolio before change:  [6.87225422]
curr_Stock_Price:  106.42053476791087
curr_Factors:  [106.42053477]
mat_Sqrt:  [[0.15]]
grads:  [-0.42029766]
Stock Position:  -0.4202976616847677
Bond Position:  [51.60055614]


portfolio before change:  [6.96433935]
curr_Stock_Price:  106.2091131736054
curr_Factors:  [106.20911317]
mat_Sqrt:  [[0.15]]
grads:  [-0.03353383]
Stock Position:  -0.03353383365992945
Bond Position:  [10.52593809]


portfolio before change:  [6.98728238]
curr_Stock_Price:  105.54455649697543
curr_Factors:  [105.5445565]
mat_Sqrt:  [[0.15]]
grads:  [0.12142297]
Stock Position:  0.12142296639264144
Bond Position:  [-5.82825076]


portfolio before change:  [6.92774256]
curr_Stock_Price:  105.05720604264243
curr_Factors:  [105.05720604]
mat_Sqrt:  [[0.15]]
grads:  [-0.10208368]
Stock Position:  -0.1020836820681999
Bond Position:  [17.65236898]


portfolio before change:  [6.91960429]
curr_Stock_Price:  105.14773550286436
curr_Factors:  [105.1477355]
mat_Sqrt:  [[0.15]]
grads:  [-0.03559631]
Stock Position:  -0.035596307750742295
Bond Position:  [10.66247544]


portfolio before change:  [6.92769258]
curr_Stock_Price:  104.93923458576721
curr_Factors:  [104.93923459]
mat_Sqrt:  [[0.15]]
grads:  [0.01877257]
Stock Position:  0.018772574486827766
Bond Position:  [4.95771298]


portfolio before change:  [6.92562007]
curr_Stock_Price:  104.8123274008857
curr_Factors:  [104.8123274]
mat_Sqrt:  [[0.15]]
grads:  [-0.09054227]
Stock Position:  -0.09054227212581956
Bond Position:  [16.41556634]


portfolio before change:  [6.8457891]
curr_Stock_Price:  105.70535756027056
curr_Factors:  [105.70535756]
mat_Sqrt:  [[0.15]]
grads:  [0.12556735]
Stock Position:  0.12556734615381326
Bond Position:  [-6.42735213]


portfolio before change:  [6.74911692]
curr_Stock_Price:  104.93867372666871
curr_Factors:  [104.93867373]
mat_Sqrt:  [[0.15]]
grads:  [0.14528367]
Stock Position:  0.14528366642250645
Bond Position:  [-8.49675835]


portfolio before change:  [6.75497033]
curr_Stock_Price:  104.98261862508318
curr_Factors:  [104.98261863]
mat_Sqrt:  [[0.15]]
grads:  [-0.08107855]
Stock Position:  -0.08107854592847524
Bond Position:  [15.2668084]


portfolio before change:  [6.7384813]
curr_Stock_Price:  105.1977586104915
curr_Factors:  [105.19775861]
mat_Sqrt:  [[0.15]]
grads:  [-0.02895122]
Stock Position:  -0.028951224114940992
Bond Position:  [9.78408519]


portfolio before change:  [6.71444843]
curr_Stock_Price:  106.04899709670194
curr_Factors:  [106.0489971]
mat_Sqrt:  [[0.15]]
grads:  [0.02446427]
Stock Position:  0.02446426677707194
Bond Position:  [4.12003747]


portfolio before change:  [6.70918681]
curr_Stock_Price:  105.82339729171156
curr_Factors:  [105.82339729]
mat_Sqrt:  [[0.15]]
grads:  [0.02260216]
Stock Position:  0.02260216137618285
Bond Position:  [4.3173493]


portfolio before change:  [6.69386269]
curr_Stock_Price:  105.13346490166688
curr_Factors:  [105.1334649]
mat_Sqrt:  [[0.15]]
grads:  [-0.01704956]
Stock Position:  -0.017049556120609377
Bond Position:  [8.4863416]


portfolio before change:  [6.68173424]
curr_Stock_Price:  105.87593933252711
curr_Factors:  [105.87593933]
mat_Sqrt:  [[0.15]]
grads:  [-0.07142873]
Stock Position:  -0.07142872637368115
Bond Position:  [14.24431774]


portfolio before change:  [6.72008658]
curr_Stock_Price:  105.35147188216085
curr_Factors:  [105.35147188]
mat_Sqrt:  [[0.15]]
grads:  [0.07904256]
Stock Position:  0.07904255620658501
Bond Position:  [-1.60716306]


portfolio before change:  [6.7932398]
curr_Stock_Price:  106.27823436104804
curr_Factors:  [106.27823436]
mat_Sqrt:  [[0.15]]
grads:  [-0.20741852]
Stock Position:  -0.20741852420838391
Bond Position:  [28.83731433]


portfolio before change:  [6.8479437]
curr_Stock_Price:  106.02318719170385
curr_Factors:  [106.02318719]
mat_Sqrt:  [[0.15]]
grads:  [-0.06466672]
Stock Position:  -0.06466671820224851
Bond Position:  [13.70411527]


portfolio before change:  [6.83825084]
curr_Stock_Price:  106.18632195555311
curr_Factors:  [106.18632196]
mat_Sqrt:  [[0.15]]
grads:  [0.13254532]
Stock Position:  0.1325453239321912
Bond Position:  [-7.2362496]


portfolio before change:  [6.76019212]
curr_Stock_Price:  105.60081322204762
curr_Factors:  [105.60081322]
mat_Sqrt:  [[0.15]]
grads:  [-0.03704433]
Stock Position:  -0.03704433390808489
Bond Position:  [10.6721039]


portfolio before change:  [6.76887777]
curr_Stock_Price:  105.38435297453448
curr_Factors:  [105.38435297]
mat_Sqrt:  [[0.15]]
grads:  [0.08719573]
Stock Position:  0.08719573149609636
Bond Position:  [-2.42018797]


portfolio before change:  [6.87040514]
curr_Stock_Price:  106.55044939490591
curr_Factors:  [106.55044939]
mat_Sqrt:  [[0.15]]
grads:  [-0.09184578]
Stock Position:  -0.09184578089683168
Bond Position:  [16.65661436]


portfolio before change:  [6.72606599]
curr_Stock_Price:  108.13332247631966
curr_Factors:  [108.13332248]
mat_Sqrt:  [[0.15]]
grads:  [-0.08433126]
Stock Position:  -0.08433125839199661
Bond Position:  [15.84508515]


portfolio before change:  [6.69790145]
curr_Stock_Price:  108.47904116554838
curr_Factors:  [108.47904117]
mat_Sqrt:  [[0.15]]
grads:  [-0.01519404]
Stock Position:  -0.01519404257671532
Bond Position:  [8.34613662]


portfolio before change:  [6.70341926]
curr_Stock_Price:  108.15021723086198
curr_Factors:  [108.15021723]
mat_Sqrt:  [[0.15]]
grads:  [0.94820345]
Stock Position:  0.9482034458122331
Bond Position:  [-95.84498938]


portfolio before change:  [6.41530053]
curr_Stock_Price:  107.85267746627392
curr_Factors:  [107.85267747]
mat_Sqrt:  [[0.15]]
grads:  [-0.08291941]
Stock Position:  -0.08291940556239807
Bond Position:  [15.35838044]


portfolio before change:  [6.42497647]
curr_Stock_Price:  107.74756328776
curr_Factors:  [107.74756329]
mat_Sqrt:  [[0.15]]
grads:  [0.01184217]
Stock Position:  0.011842167019265038
Bond Position:  [5.14901183]


portfolio before change:  [6.42935514]
curr_Stock_Price:  108.09013982088193
curr_Factors:  [108.09013982]
mat_Sqrt:  [[0.15]]
grads:  [0.04597807]
Stock Position:  0.0459780675515863
Bond Position:  [1.45957939]


portfolio before change:  [6.43013375]
curr_Stock_Price:  108.10509005285697
curr_Factors:  [108.10509005]
mat_Sqrt:  [[0.15]]
grads:  [0.10826141]
Stock Position:  0.10826140633847951
Bond Position:  [-5.27347533]


portfolio before change:  [6.51574416]
curr_Stock_Price:  108.89890952583029
curr_Factors:  [108.89890953]
mat_Sqrt:  [[0.15]]
grads:  [-0.22262485]
Stock Position:  -0.22262484869426702
Bond Position:  [30.75934742]


portfolio before change:  [6.43176709]
curr_Stock_Price:  109.28475856723443
curr_Factors:  [109.28475857]
mat_Sqrt:  [[0.15]]
grads:  [-0.05340355]
Stock Position:  -0.053403545146423786
Bond Position:  [12.26796063]


portfolio before change:  [6.39751943]
curr_Stock_Price:  109.94041607761018
curr_Factors:  [109.94041608]
mat_Sqrt:  [[0.15]]
grads:  [-0.02326888]
Stock Position:  -0.023268880164646608
Bond Position:  [8.9557098]


portfolio before change:  [6.3960991]
curr_Stock_Price:  110.02551186270854
curr_Factors:  [110.02551186]
mat_Sqrt:  [[0.15]]
grads:  [0.14533258]
Stock Position:  0.145332581918407
Bond Position:  [-9.59419262]


portfolio before change:  [6.25992894]
curr_Stock_Price:  109.09268249974666
curr_Factors:  [109.0926825]
mat_Sqrt:  [[0.15]]
grads:  [0.02066649]
Stock Position:  0.020666490266805875
Bond Position:  [4.00536608]


portfolio before change:  [6.25518109]
curr_Stock_Price:  108.85083251428331
curr_Factors:  [108.85083251]
mat_Sqrt:  [[0.15]]
grads:  [-0.01999759]
Stock Position:  -0.019997594600040827
Bond Position:  [8.43193591]


portfolio before change:  [6.26924907]
curr_Stock_Price:  108.17370307459849
curr_Factors:  [108.17370307]
mat_Sqrt:  [[0.15]]
grads:  [0.03937229]
Stock Position:  0.0393722859832835
Bond Position:  [2.01020309]


portfolio before change:  [6.29764744]
curr_Stock_Price:  108.89179022297978
curr_Factors:  [108.89179022]
mat_Sqrt:  [[0.15]]
grads:  [0.00391026]
Stock Position:  0.003910255301591339
Bond Position:  [5.87185274]


portfolio before change:  [6.29603546]
curr_Stock_Price:  108.38569016763442
curr_Factors:  [108.38569017]
mat_Sqrt:  [[0.15]]
grads:  [-0.0133759]
Stock Position:  -0.013375897403550165
Bond Position:  [7.74579133]


portfolio before change:  [6.30019593]
curr_Stock_Price:  108.11084163816571
curr_Factors:  [108.11084164]
mat_Sqrt:  [[0.15]]
grads:  [0.13454069]
Stock Position:  0.13454068979142472
Bond Position:  [-8.24511127]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.30019593]
Stock Price:  108.3347753096287
PL:  [-2.03457938]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [ 3.26967127e-02]
 [ 1.19017908e-02]
 [ 3.21370196e-03]
 [-1.85884996e-03]
 [-1.34776134e-02]
 [ 4.29773999e-04]
 [ 3.15512169e-03]
 [-3.87164562e-02]
 [-9.59050598e-03]
 [ 6.01740108e-02]
 [ 1.05088781e-02]
 [-1.49393664e-02]
 [ 2.00034005e-02]
 [ 1.39139011e-02]
 [-4.17676991e-02]
 [ 2.26161511e-02]
 [-4.86947843e-03]
 [-1.44700742e-02]
 [-4.71794599e-02]
 [ 1.75821791e-02]
 [-8.28643570e-02]
 [-3.74386454e-02]
 [ 1.92250950e-03]
 [-3.53036254e-03]
 [-1.20971342e-02]
 [ 1.55698002e-02]
 [ 2.24607062e-02]
 [ 1.04185872e-01]
 [-8.67057345e-04]
 [ 2.02588809e-02]
 [-3.52463260e-03]
 [-6.92542920e-02]
 [ 2.70646294e-02]
 [ 1.05505101e-02]
 [-4.06847500e-02]
 [ 9.14293061e-03]
 [ 4.95339937e-03]
 [-2.76868741e-02]
 [ 1.38369211e-02]
 [-2.53989910e-02]
 [ 7.05758288e-02]
 [ 5.79667704e-03]
 [ 1.47073478e-02]
 [-1.08947940e-02]
 [-6.32910809e-03]
 [-2.58808630e-02]
 [-1.28980930e-02]
 [ 2.96802183e-03]
 [-3.18585198e-03]
 [-2.16910040e-02]
 [-4.79773098e-03]
 [ 2.85906280e-03]
 [ 4.43681962e-03]
 [-3.12552565e-03]
 [ 2.55738904e-02]
 [ 9.09262944e-03]
 [-8.89074523e-03]
 [ 1.72376711e-02]
 [ 1.26038291e-02]
 [-1.34394105e-02]
 [-1.50017251e-02]
 [-3.87425975e-02]
 [-1.30561792e-02]
 [-5.22449140e-03]
 [ 1.60599390e-04]
 [ 7.87896281e-02]
 [ 8.76709968e-03]
 [ 1.64240861e-03]
 [ 1.67687084e-02]
 [-1.92329231e-02]
 [ 3.40252717e-02]
 [-4.64796566e-02]
 [-9.50054055e-03]
 [ 8.17077189e-03]
 [-1.61622683e-02]
 [ 4.36004336e-03]
 [ 2.12641365e-02]
 [-1.75366978e-02]
 [-5.62167294e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-23.01330165]
curr_Stock_Price:  98.38810798361884
curr_Factors:  [98.38810798]
mat_Sqrt:  [[0.15]]
grads:  [0.21797808]
Stock Position:  0.21797808488626777
Bond Position:  [-44.45975301]


portfolio before change:  [-23.02388956]
curr_Stock_Price:  98.35228289940582
curr_Factors:  [98.3522829]
mat_Sqrt:  [[0.15]]
grads:  [0.07934527]
Stock Position:  0.0793452722949771
Bond Position:  [-30.82767822]


portfolio before change:  [-23.05302521]
curr_Stock_Price:  98.00936563810028
curr_Factors:  [98.00936564]
mat_Sqrt:  [[0.15]]
grads:  [0.02142468]
Stock Position:  0.021424679749339436
Bond Position:  [-25.15284448]


portfolio before change:  [-23.04635769]
curr_Stock_Price:  98.39395100572906
curr_Factors:  [98.39395101]
mat_Sqrt:  [[0.15]]
grads:  [-0.01239233]
Stock Position:  -0.012392333081773595
Bond Position:  [-21.82702708]


portfolio before change:  [-23.05316903]
curr_Stock_Price:  98.83350502287767
curr_Factors:  [98.83350502]
mat_Sqrt:  [[0.15]]
grads:  [-0.08985076]
Stock Position:  -0.08985075615905694
Bond Position:  [-14.17290387]


portfolio before change:  [-22.94658983]
curr_Stock_Price:  97.63746575917133
curr_Factors:  [97.63746576]
mat_Sqrt:  [[0.15]]
grads:  [0.00286516]
Stock Position:  0.0028651599932319207
Bond Position:  [-23.22633679]


portfolio before change:  [-22.94977575]
curr_Stock_Price:  97.03218373299363
curr_Factors:  [97.03218373]
mat_Sqrt:  [[0.15]]
grads:  [0.02103414]
Stock Position:  0.021034144618940927
Bond Position:  [-24.99076473]


portfolio before change:  [-22.97675984]
curr_Stock_Price:  95.82357191811917
curr_Factors:  [95.82357192]
mat_Sqrt:  [[0.15]]
grads:  [-0.25810971]
Stock Position:  -0.25810970796430655
Bond Position:  [1.75623433]


portfolio before change:  [-23.10419531]
curr_Stock_Price:  96.31772320572337
curr_Factors:  [96.31772321]
mat_Sqrt:  [[0.15]]
grads:  [-0.06393671]
Stock Position:  -0.0639367065357804
Bond Position:  [-16.94595731]


portfolio before change:  [-23.12307155]
curr_Stock_Price:  96.59639067441779
curr_Factors:  [96.59639067]
mat_Sqrt:  [[0.15]]
grads:  [0.40116007]
Stock Position:  0.40116007219602184
Bond Position:  [-61.87368661]


portfolio before change:  [-23.3005692]
curr_Stock_Price:  96.16356986540941
curr_Factors:  [96.16356987]
mat_Sqrt:  [[0.15]]
grads:  [0.07005919]
Stock Position:  0.07005918721430587
Bond Position:  [-30.03771075]


portfolio before change:  [-23.30553016]
curr_Stock_Price:  96.11955650784235
curr_Factors:  [96.11955651]
mat_Sqrt:  [[0.15]]
grads:  [-0.09959578]
Stock Position:  -0.0995957760865681
Bond Position:  [-13.73242833]


portfolio before change:  [-23.21533056]
curr_Stock_Price:  95.20528176780772
curr_Factors:  [95.20528177]
mat_Sqrt:  [[0.15]]
grads:  [0.133356]
Stock Position:  0.1333560033014555
Bond Position:  [-35.91152643]


portfolio before change:  [-23.19785182]
curr_Stock_Price:  95.35318123560288
curr_Factors:  [95.35318124]
mat_Sqrt:  [[0.15]]
grads:  [0.09275934]
Stock Position:  0.0927593406404694
Bond Position:  [-32.04275004]


portfolio before change:  [-23.12695577]
curr_Stock_Price:  96.13907274994725
curr_Factors:  [96.13907275]
mat_Sqrt:  [[0.15]]
grads:  [-0.27845133]
Stock Position:  -0.27845132707487785
Bond Position:  [3.64309662]


portfolio before change:  [-23.06040657]
curr_Stock_Price:  95.90089289200746
curr_Factors:  [95.90089289]
mat_Sqrt:  [[0.15]]
grads:  [0.15077434]
Stock Position:  0.15077434085810676
Bond Position:  [-37.51980049]


portfolio before change:  [-22.94311321]
curr_Stock_Price:  96.69438614892194
curr_Factors:  [96.69438615]
mat_Sqrt:  [[0.15]]
grads:  [-0.03246319]
Stock Position:  -0.032463189510580755
Bond Position:  [-19.80410503]


portfolio before change:  [-22.92456718]
curr_Stock_Price:  96.08496287914686
curr_Factors:  [96.08496288]
mat_Sqrt:  [[0.15]]
grads:  [-0.09646716]
Stock Position:  -0.09646716123456195
Bond Position:  [-13.65552358]


portfolio before change:  [-22.90785948]
curr_Stock_Price:  95.9029196055749
curr_Factors:  [95.90291961]
mat_Sqrt:  [[0.15]]
grads:  [-0.31452973]
Stock Position:  -0.3145297327617607
Bond Position:  [7.25646019]


portfolio before change:  [-22.86602217]
curr_Stock_Price:  95.77134614216598
curr_Factors:  [95.77134614]
mat_Sqrt:  [[0.15]]
grads:  [0.11721453]
Stock Position:  0.11721452748128407
Bond Position:  [-34.09181526]


portfolio before change:  [-22.94681259]
curr_Stock_Price:  95.10027224104607
curr_Factors:  [95.10027224]
mat_Sqrt:  [[0.15]]
grads:  [-0.55242905]
Stock Position:  -0.5524290464133179
Bond Position:  [29.58934012]


portfolio before change:  [-22.85553462]
curr_Stock_Price:  94.93838976707912
curr_Factors:  [94.93838977]
mat_Sqrt:  [[0.15]]
grads:  [-0.24959097]
Stock Position:  -0.24959096952103355
Bond Position:  [0.84023013]


portfolio before change:  [-22.85566118]
curr_Stock_Price:  94.93910723758874
curr_Factors:  [94.93910724]
mat_Sqrt:  [[0.15]]
grads:  [0.01281673]
Stock Position:  0.012816729982436497
Bond Position:  [-24.07247008]


portfolio before change:  [-22.85846162]
curr_Stock_Price:  94.83799948860687
curr_Factors:  [94.83799949]
mat_Sqrt:  [[0.15]]
grads:  [-0.02353575]
Stock Position:  -0.02353575028372712
Bond Position:  [-20.62637815]


portfolio before change:  [-22.85661648]
curr_Stock_Price:  94.70482638804093
curr_Factors:  [94.70482639]
mat_Sqrt:  [[0.15]]
grads:  [-0.08064756]
Stock Position:  -0.08064756101039029
Bond Position:  [-15.21890322]


portfolio before change:  [-22.83205876]
curr_Stock_Price:  94.38852502193168
curr_Factors:  [94.38852502]
mat_Sqrt:  [[0.15]]
grads:  [0.10379867]
Stock Position:  0.10379866820069021
Bond Position:  [-32.62946195]


portfolio before change:  [-22.84145251]
curr_Stock_Price:  94.31767296929343
curr_Factors:  [94.31767297]
mat_Sqrt:  [[0.15]]
grads:  [0.14973804]
Stock Position:  0.14973804129711402
Bond Position:  [-36.96439612]


portfolio before change:  [-22.83722067]
curr_Stock_Price:  94.36136387477117
curr_Factors:  [94.36136387]
mat_Sqrt:  [[0.15]]
grads:  [0.69457248]
Stock Position:  0.6945724782320464
Bond Position:  [-88.37802703]


portfolio before change:  [-22.63454762]
curr_Stock_Price:  94.66111208175711
curr_Factors:  [94.66111208]
mat_Sqrt:  [[0.15]]
grads:  [-0.00578038]
Stock Position:  -0.00578038230033442
Bond Position:  [-22.0873702]


portfolio before change:  [-22.63312843]
curr_Stock_Price:  94.17676969109995
curr_Factors:  [94.17676969]
mat_Sqrt:  [[0.15]]
grads:  [0.13505921]
Stock Position:  0.1350592063023359
Bond Position:  [-35.3525682]


portfolio before change:  [-22.61738054]
curr_Stock_Price:  94.30972991581638
curr_Factors:  [94.30972992]
mat_Sqrt:  [[0.15]]
grads:  [-0.02349755]
Stock Position:  -0.023497550670313613
Bond Position:  [-20.40133288]


portfolio before change:  [-22.61174039]
curr_Stock_Price:  94.01543225128782
curr_Factors:  [94.01543225]
mat_Sqrt:  [[0.15]]
grads:  [-0.46169528]
Stock Position:  -0.46169527970399027
Bond Position:  [20.7947409]


portfolio before change:  [-22.43311004]
curr_Stock_Price:  93.6313463825928
curr_Factors:  [93.63134638]
mat_Sqrt:  [[0.15]]
grads:  [0.18043086]
Stock Position:  0.18043086246033366
Bond Position:  [-39.32709462]


portfolio before change:  [-22.39564009]
curr_Stock_Price:  93.85263871799123
curr_Factors:  [93.85263872]
mat_Sqrt:  [[0.15]]
grads:  [0.07033673]
Stock Position:  0.07033673429098636
Bond Position:  [-28.99692821]


portfolio before change:  [-22.35581235]
curr_Stock_Price:  94.44464954756529
curr_Factors:  [94.44464955]
mat_Sqrt:  [[0.15]]
grads:  [-0.27123167]
Stock Position:  -0.2712316667307579
Bond Position:  [3.26056736]


portfolio before change:  [-22.00797996]
curr_Stock_Price:  93.16298285170873
curr_Factors:  [93.16298285]
mat_Sqrt:  [[0.15]]
grads:  [0.06095287]
Stock Position:  0.06095287072306964
Bond Position:  [-27.68653121]


portfolio before change:  [-22.05452446]
curr_Stock_Price:  92.42775852454395
curr_Factors:  [92.42775852]
mat_Sqrt:  [[0.15]]
grads:  [0.03302266]
Stock Position:  0.03302266246652026
Bond Position:  [-25.10673513]


portfolio before change:  [-22.04773277]
curr_Stock_Price:  92.68094568090828
curr_Factors:  [92.68094568]
mat_Sqrt:  [[0.15]]
grads:  [-0.18457916]
Stock Position:  -0.18457916054983411
Bond Position:  [-4.94076161]


portfolio before change:  [-22.02866496]
curr_Stock_Price:  92.57596841259083
curr_Factors:  [92.57596841]
mat_Sqrt:  [[0.15]]
grads:  [0.09224614]
Stock Position:  0.0922461405835433
Bond Position:  [-30.56844075]


portfolio before change:  [-22.04169106]
curr_Stock_Price:  92.45546999335734
curr_Factors:  [92.45546999]
mat_Sqrt:  [[0.15]]
grads:  [-0.16932661]
Stock Position:  -0.16932660652485246
Bond Position:  [-6.38652007]


portfolio before change:  [-22.03437408]
curr_Stock_Price:  92.40990035049124
curr_Factors:  [92.40990035]
mat_Sqrt:  [[0.15]]
grads:  [0.47050553]
Stock Position:  0.47050552512820726
Bond Position:  [-65.51374277]


portfolio before change:  [-21.93417229]
curr_Stock_Price:  92.63156941450602
curr_Factors:  [92.63156941]
mat_Sqrt:  [[0.15]]
grads:  [0.03864451]
Stock Position:  0.03864451362966283
Bond Position:  [-25.51387424]


portfolio before change:  [-21.93409337]
curr_Stock_Price:  92.67487677067984
curr_Factors:  [92.67487677]
mat_Sqrt:  [[0.15]]
grads:  [0.09804899]
Stock Position:  0.09804898554695038
Bond Position:  [-31.02077102]


portfolio before change:  [-21.90420882]
curr_Stock_Price:  92.99944317246384
curr_Factors:  [92.99944317]
mat_Sqrt:  [[0.15]]
grads:  [-0.07263196]
Stock Position:  -0.07263195977630568
Bond Position:  [-15.14947701]


portfolio before change:  [-21.91832193]
curr_Stock_Price:  93.18071656037799
curr_Factors:  [93.18071656]
mat_Sqrt:  [[0.15]]
grads:  [-0.04219405]
Stock Position:  -0.0421940539437386
Bond Position:  [-17.98664975]


portfolio before change:  [-21.89689446]
curr_Stock_Price:  92.64624128213698
curr_Factors:  [92.64624128]
mat_Sqrt:  [[0.15]]
grads:  [-0.17253909]
Stock Position:  -0.1725390864497232
Bond Position:  [-5.91179662]


portfolio before change:  [-22.02391073]
curr_Stock_Price:  93.38025918382388
curr_Factors:  [93.38025918]
mat_Sqrt:  [[0.15]]
grads:  [-0.08598729]
Stock Position:  -0.08598728667211007
Bond Position:  [-13.99439562]


portfolio before change:  [-22.01155542]
curr_Stock_Price:  93.22639939108274
curr_Factors:  [93.22639939]
mat_Sqrt:  [[0.15]]
grads:  [0.01978681]
Stock Position:  0.01978681219545071
Bond Position:  [-23.85620868]


portfolio before change:  [-22.01527868]
curr_Stock_Price:  93.11358684590991
curr_Factors:  [93.11358685]
mat_Sqrt:  [[0.15]]
grads:  [-0.02123901]
Stock Position:  -0.02123901316673797
Bond Position:  [-20.03763799]


portfolio before change:  [-22.00352214]
curr_Stock_Price:  92.50108503723854
curr_Factors:  [92.50108504]
mat_Sqrt:  [[0.15]]
grads:  [-0.14460669]
Stock Position:  -0.14460669337554644
Bond Position:  [-8.6272461]


portfolio before change:  [-22.03176795]
curr_Stock_Price:  92.69268463358408
curr_Factors:  [92.69268463]
mat_Sqrt:  [[0.15]]
grads:  [-0.03198487]
Stock Position:  -0.03198487321928536
Bond Position:  [-19.06700418]


portfolio before change:  [-22.02846617]
curr_Stock_Price:  92.55219620028586
curr_Factors:  [92.5521962]
mat_Sqrt:  [[0.15]]
grads:  [0.01906042]
Stock Position:  0.01906041863782875
Bond Position:  [-23.79254977]


portfolio before change:  [-22.03179496]
curr_Stock_Price:  92.4555713866504
curr_Factors:  [92.45557139]
mat_Sqrt:  [[0.15]]
grads:  [0.0295788]
Stock Position:  0.029578797475412606
Bond Position:  [-24.76651958]


portfolio before change:  [-22.01938291]
curr_Stock_Price:  92.92753107914275
curr_Factors:  [92.92753108]
mat_Sqrt:  [[0.15]]
grads:  [-0.02083684]
Stock Position:  -0.020836837676047253
Bond Position:  [-20.08306703]


portfolio before change:  [-22.0191885]
curr_Stock_Price:  92.85795967372957
curr_Factors:  [92.85795967]
mat_Sqrt:  [[0.15]]
grads:  [0.1704926]
Stock Position:  0.17049260252863296
Bond Position:  [-37.85078371]


portfolio before change:  [-22.0698608]
curr_Stock_Price:  92.57462444240444
curr_Factors:  [92.57462444]
mat_Sqrt:  [[0.15]]
grads:  [0.06061753]
Stock Position:  0.06061752959241334
Bond Position:  [-27.68150584]


portfolio before change:  [-22.16172607]
curr_Stock_Price:  91.08767636723515
curr_Factors:  [91.08767637]
mat_Sqrt:  [[0.15]]
grads:  [-0.05927163]
Stock Position:  -0.059271634883470495
Bond Position:  [-16.76281058]


portfolio before change:  [-22.12972219]
curr_Stock_Price:  90.53004717076448
curr_Factors:  [90.53004717]
mat_Sqrt:  [[0.15]]
grads:  [0.11491781]
Stock Position:  0.11491780740891105
Bond Position:  [-32.53323671]


portfolio before change:  [-22.00292699]
curr_Stock_Price:  91.65109698732897
curr_Factors:  [91.65109699]
mat_Sqrt:  [[0.15]]
grads:  [0.08402553]
Stock Position:  0.08402552744356152
Bond Position:  [-29.70395875]


portfolio before change:  [-22.01003502]
curr_Stock_Price:  91.58859840220074
curr_Factors:  [91.5885984]
mat_Sqrt:  [[0.15]]
grads:  [-0.08959607]
Stock Position:  -0.0895960700974508
Bond Position:  [-13.80405654]


portfolio before change:  [-22.02578378]
curr_Stock_Price:  91.75474384452342
curr_Factors:  [91.75474384]
mat_Sqrt:  [[0.15]]
grads:  [-0.1000115]
Stock Position:  -0.10001150061563782
Bond Position:  [-12.84925416]


portfolio before change:  [-22.12370653]
curr_Stock_Price:  92.72582862970306
curr_Factors:  [92.72582863]
mat_Sqrt:  [[0.15]]
grads:  [-0.25828398]
Stock Position:  -0.25828398364078514
Bond Position:  [1.82588987]


portfolio before change:  [-22.00113531]
curr_Stock_Price:  92.25171059649351
curr_Factors:  [92.2517106]
mat_Sqrt:  [[0.15]]
grads:  [-0.08704119]
Stock Position:  -0.08704119471304494
Bond Position:  [-13.97143621]


portfolio before change:  [-21.98825678]
curr_Stock_Price:  92.0937190529916
curr_Factors:  [92.09371905]
mat_Sqrt:  [[0.15]]
grads:  [-0.03482994]
Stock Position:  -0.03482994265118515
Bond Position:  [-18.78063783]


portfolio before change:  [-21.97955293]
curr_Stock_Price:  91.81012157885903
curr_Factors:  [91.81012158]
mat_Sqrt:  [[0.15]]
grads:  [0.00107066]
Stock Position:  0.0010706626005547541
Bond Position:  [-22.07785059]


portfolio before change:  [-21.98072225]
curr_Stock_Price:  92.00680609246025
curr_Factors:  [92.00680609]
mat_Sqrt:  [[0.15]]
grads:  [0.52526419]
Stock Position:  0.5252641870970306
Bond Position:  [-70.30860246]


portfolio before change:  [-22.20394147]
curr_Stock_Price:  91.59020660386433
curr_Factors:  [91.5902066]
mat_Sqrt:  [[0.15]]
grads:  [0.05844733]
Stock Position:  0.05844733122068249
Bond Position:  [-27.55714461]


portfolio before change:  [-22.1833758]
curr_Stock_Price:  91.97154207571505
curr_Factors:  [91.97154208]
mat_Sqrt:  [[0.15]]
grads:  [0.01094939]
Stock Position:  0.010949390701449598
Bond Position:  [-23.19040815]


portfolio before change:  [-22.17894271]
curr_Stock_Price:  92.50878999058136
curr_Factors:  [92.50878999]
mat_Sqrt:  [[0.15]]
grads:  [0.11179139]
Stock Position:  0.11179138962917066
Bond Position:  [-32.5206289]


portfolio before change:  [-22.22704741]
curr_Stock_Price:  92.09666434749472
curr_Factors:  [92.09666435]
mat_Sqrt:  [[0.15]]
grads:  [-0.12821949]
Stock Position:  -0.128219487078597
Bond Position:  [-10.41846035]


portfolio before change:  [-22.15866319]
curr_Stock_Price:  91.55824856578727
curr_Factors:  [91.55824857]
mat_Sqrt:  [[0.15]]
grads:  [0.22683514]
Stock Position:  0.22683514478492064
Bond Position:  [-42.92729176]


portfolio before change:  [-22.20445913]
curr_Stock_Price:  91.36818589226057
curr_Factors:  [91.36818589]
mat_Sqrt:  [[0.15]]
grads:  [-0.30986438]
Stock Position:  -0.3098643771368436
Bond Position:  [6.10728689]


portfolio before change:  [-22.28032173]
curr_Stock_Price:  91.61424295809823
curr_Factors:  [91.61424296]
mat_Sqrt:  [[0.15]]
grads:  [-0.06333694]
Stock Position:  -0.0633369370230383
Bond Position:  [-16.47775619]


portfolio before change:  [-22.26793919]
curr_Stock_Price:  91.4024797982565
curr_Factors:  [91.4024798]
mat_Sqrt:  [[0.15]]
grads:  [0.05447181]
Stock Position:  0.05447181262459809
Bond Position:  [-27.24679794]


portfolio before change:  [-22.27133643]
curr_Stock_Price:  91.3713764150969
curr_Factors:  [91.37137642]
mat_Sqrt:  [[0.15]]
grads:  [-0.10774846]
Stock Position:  -0.10774845529991818
Bond Position:  [-12.42621176]


portfolio before change:  [-22.3394794]
curr_Stock_Price:  91.99659478953528
curr_Factors:  [91.99659479]
mat_Sqrt:  [[0.15]]
grads:  [0.02906696]
Stock Position:  0.029066955727579613
Bond Position:  [-25.01354035]


portfolio before change:  [-22.31494269]
curr_Stock_Price:  92.89452530347504
curr_Factors:  [92.8945253]
mat_Sqrt:  [[0.15]]
grads:  [0.14176091]
Stock Position:  0.14176090997948113
Bond Position:  [-35.48375513]


portfolio before change:  [-22.35934564]
curr_Stock_Price:  92.5969457440386
curr_Factors:  [92.59694574]
mat_Sqrt:  [[0.15]]
grads:  [-0.11691132]
Stock Position:  -0.1169113185985767
Bond Position:  [-11.53371462]


portfolio before change:  [-22.4045268]
curr_Stock_Price:  92.97723631640854
curr_Factors:  [92.97723632]
mat_Sqrt:  [[0.15]]
grads:  [-0.3747782]
Stock Position:  -0.374778196056043
Bond Position:  [12.4413141]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-22.4045268]
Stock Price:  93.91666948308533
PL:  [-22.4045268]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.81527689e-02]
 [-1.74370647e-03]
 [ 1.94621324e-04]
 [ 2.15041527e-03]
 [ 1.33810899e-02]
 [ 1.17758467e-02]
 [ 8.27458519e-04]
 [ 6.24711218e-03]
 [-8.28805700e-03]
 [-1.33787309e-02]
 [ 9.79572251e-03]
 [-1.27942145e-02]
 [ 4.49179236e-02]
 [ 2.55745421e-02]
 [-1.21841467e-02]
 [-7.43452377e-03]
 [ 1.48620436e-02]
 [ 2.15549190e-02]
 [-3.02343611e-02]
 [-4.50883799e-03]
 [ 1.02932168e-02]
 [-1.07461151e-02]
 [-3.76595821e-03]
 [ 5.81459337e-03]
 [ 1.90743136e-02]
 [ 1.37449990e-02]
 [ 6.98223638e-03]
 [ 2.21606304e-03]
 [ 9.46753220e-03]
 [-9.23946433e-03]
 [-5.81237021e-03]
 [ 4.31718103e-02]
 [ 3.27706978e-03]
 [-7.43520904e-03]
 [-4.26857012e-03]
 [-4.75405425e-03]
 [-3.70087990e-03]
 [ 1.44164486e-03]
 [ 5.46295572e-03]
 [-6.71139502e-03]
 [-5.13776605e-02]
 [-4.27428702e-03]
 [ 1.72948936e-02]
 [-1.43045775e-02]
 [-2.06736523e-03]
 [ 2.76319246e-03]
 [-1.35638218e-02]
 [ 2.18920822e-02]
 [ 4.35140607e-02]
 [-1.48528488e-02]
 [-5.63026822e-03]
 [ 4.26287302e-03]
 [ 3.75671730e-03]
 [-1.43554362e-02]
 [-1.94483864e-02]
 [ 1.60686071e-02]
 [-5.96615266e-02]
 [-2.04543074e-02]
 [ 2.77212432e-02]
 [-2.16683789e-02]
 [ 1.35529423e-02]
 [-1.19003462e-02]
 [-1.25545383e-02]
 [-2.17816343e-03]
 [ 2.19860315e-01]
 [-4.37364761e-03]
 [-6.74552128e-03]
 [ 9.44176329e-03]
 [ 2.20403153e-02]
 [-4.22478693e-02]
 [-8.24962614e-03]
 [-1.94679078e-03]
 [ 2.95692755e-02]
 [-9.01199992e-04]
 [-5.64246297e-03]
 [ 1.41331234e-02]
 [-4.45678903e-03]
 [-1.51531853e-04]
 [ 2.95905565e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.93770745]
curr_Stock_Price:  100.12026711551385
curr_Factors:  [100.12026712]
mat_Sqrt:  [[0.15]]
grads:  [-0.25435179]
Stock Position:  -0.25435179284094805
Bond Position:  [29.40347689]


portfolio before change:  [3.98969877]
curr_Stock_Price:  99.92308531560757
curr_Factors:  [99.92308532]
mat_Sqrt:  [[0.15]]
grads:  [-0.01162471]
Stock Position:  -0.011624709791637955
Bond Position:  [5.15127564]


portfolio before change:  [3.98797268]
curr_Stock_Price:  100.09926606903835
curr_Factors:  [100.09926607]
mat_Sqrt:  [[0.15]]
grads:  [0.00129748]
Stock Position:  0.001297475490417329
Bond Position:  [3.85809634]


portfolio before change:  [3.98847394]
curr_Stock_Price:  100.29974287721333
curr_Factors:  [100.29974288]
mat_Sqrt:  [[0.15]]
grads:  [0.0143361]
Stock Position:  0.01433610180822449
Bond Position:  [2.55056661]


portfolio before change:  [3.98807087]
curr_Stock_Price:  100.26050766861145
curr_Factors:  [100.26050767]
mat_Sqrt:  [[0.15]]
grads:  [0.08920727]
Stock Position:  0.08920726580441533
Bond Position:  [-4.95589489]


portfolio before change:  [4.00289429]
curr_Stock_Price:  100.4301481946536
curr_Factors:  [100.43014819]
mat_Sqrt:  [[0.15]]
grads:  [0.07850564]
Stock Position:  0.0785056446876323
Bond Position:  [-3.88143924]


portfolio before change:  [4.02581917]
curr_Stock_Price:  100.72525412868634
curr_Factors:  [100.72525413]
mat_Sqrt:  [[0.15]]
grads:  [0.00551639]
Stock Position:  0.005516390126145936
Bond Position:  [3.47017937]


portfolio before change:  [4.03116413]
curr_Stock_Price:  101.6548598243472
curr_Factors:  [101.65485982]
mat_Sqrt:  [[0.15]]
grads:  [0.04164741]
Stock Position:  0.04164741452876361
Bond Position:  [-0.20249796]


portfolio before change:  [4.03305699]
curr_Stock_Price:  101.70061347433993
curr_Factors:  [101.70061347]
mat_Sqrt:  [[0.15]]
grads:  [-0.05525371]
Stock Position:  -0.055253713341811485
Bond Position:  [9.65239354]


portfolio before change:  [4.04227327]
curr_Stock_Price:  101.54473280008878
curr_Factors:  [101.5447328]
mat_Sqrt:  [[0.15]]
grads:  [-0.08919154]
Stock Position:  -0.08919153918489672
Bond Position:  [13.09920429]


portfolio before change:  [3.92844287]
curr_Stock_Price:  102.8301588510941
curr_Factors:  [102.83015885]
mat_Sqrt:  [[0.15]]
grads:  [0.06530482]
Stock Position:  0.06530481673642857
Bond Position:  [-2.78686181]


portfolio before change:  [3.94047729]
curr_Stock_Price:  103.01710684864571
curr_Factors:  [103.01710685]
mat_Sqrt:  [[0.15]]
grads:  [-0.08529476]
Stock Position:  -0.08529476322446534
Bond Position:  [12.72729703]


portfolio before change:  [3.85715366]
curr_Stock_Price:  104.00332346340912
curr_Factors:  [104.00332346]
mat_Sqrt:  [[0.15]]
grads:  [0.29945282]
Stock Position:  0.29945282384290983
Bond Position:  [-27.28693524]


portfolio before change:  [3.72826095]
curr_Stock_Price:  103.57859138106149
curr_Factors:  [103.57859138]
mat_Sqrt:  [[0.15]]
grads:  [0.17049695]
Stock Position:  0.17049694753202566
Bond Position:  [-13.93157271]


portfolio before change:  [3.7618113]
curr_Stock_Price:  103.7804782863015
curr_Factors:  [103.78047829]
mat_Sqrt:  [[0.15]]
grads:  [-0.08122764]
Stock Position:  -0.0812276445852162
Bond Position:  [12.19165511]


portfolio before change:  [3.78755972]
curr_Stock_Price:  103.47286858173997
curr_Factors:  [103.47286858]
mat_Sqrt:  [[0.15]]
grads:  [-0.04956349]
Stock Position:  -0.049563491791582724
Bond Position:  [8.91603639]


portfolio before change:  [3.77838017]
curr_Stock_Price:  103.66931992601639
curr_Factors:  [103.66931993]
mat_Sqrt:  [[0.15]]
grads:  [0.09908029]
Stock Position:  0.0990802905380443
Bond Position:  [-6.49320617]


portfolio before change:  [3.79430455]
curr_Stock_Price:  103.83413788780078
curr_Factors:  [103.83413789]
mat_Sqrt:  [[0.15]]
grads:  [0.14369946]
Stock Position:  0.143699459846537
Bond Position:  [-11.12660498]


portfolio before change:  [3.98142732]
curr_Stock_Price:  105.14115884193026
curr_Factors:  [105.14115884]
mat_Sqrt:  [[0.15]]
grads:  [-0.20156241]
Stock Position:  -0.20156240744618883
Bond Position:  [25.17393241]


portfolio before change:  [4.14981276]
curr_Stock_Price:  104.31356394928814
curr_Factors:  [104.31356395]
mat_Sqrt:  [[0.15]]
grads:  [-0.03005892]
Stock Position:  -0.03005891995650589
Bond Position:  [7.28536582]


portfolio before change:  [4.15871681]
curr_Stock_Price:  104.03249258643889
curr_Factors:  [104.03249259]
mat_Sqrt:  [[0.15]]
grads:  [0.06862145]
Stock Position:  0.06862144509760804
Bond Position:  [-2.98014317]


portfolio before change:  [4.11519099]
curr_Stock_Price:  103.40091810032052
curr_Factors:  [103.4009181]
mat_Sqrt:  [[0.15]]
grads:  [-0.07164077]
Stock Position:  -0.07164076749990317
Bond Position:  [11.52291212]


portfolio before change:  [4.06454044]
curr_Stock_Price:  104.1179784229767
curr_Factors:  [104.11797842]
mat_Sqrt:  [[0.15]]
grads:  [-0.02510639]
Stock Position:  -0.025106388073794363
Bond Position:  [6.67856681]


portfolio before change:  [4.05090366]
curr_Stock_Price:  104.67776422588183
curr_Factors:  [104.67776423]
mat_Sqrt:  [[0.15]]
grads:  [0.03876396]
Stock Position:  0.038763955807415526
Bond Position:  [-0.00682056]


portfolio before change:  [4.05962653]
curr_Stock_Price:  104.90280036978591
curr_Factors:  [104.90280037]
mat_Sqrt:  [[0.15]]
grads:  [0.12716209]
Stock Position:  0.12716209075423268
Bond Position:  [-9.28003289]


portfolio before change:  [4.040533]
curr_Stock_Price:  104.75721050356961
curr_Factors:  [104.7572105]
mat_Sqrt:  [[0.15]]
grads:  [0.09163333]
Stock Position:  0.0916333263710151
Bond Position:  [-5.55871866]


portfolio before change:  [4.02301883]
curr_Stock_Price:  104.56986882558274
curr_Factors:  [104.56986883]
mat_Sqrt:  [[0.15]]
grads:  [0.04654824]
Stock Position:  0.046548242541172784
Bond Position:  [-0.84452479]


portfolio before change:  [4.01273406]
curr_Stock_Price:  104.35005431182324
curr_Factors:  [104.35005431]
mat_Sqrt:  [[0.15]]
grads:  [0.01477375]
Stock Position:  0.014773753570625261
Bond Position:  [2.47109207]


portfolio before change:  [4.02087439]
curr_Stock_Price:  104.89059929376971
curr_Factors:  [104.89059929]
mat_Sqrt:  [[0.15]]
grads:  [0.06311688]
Stock Position:  0.06311688133995573
Bond Position:  [-2.59949312]


portfolio before change:  [4.00745432]
curr_Stock_Price:  104.68055105526945
curr_Factors:  [104.68055106]
mat_Sqrt:  [[0.15]]
grads:  [-0.06159643]
Stock Position:  -0.06159642884403591
Bond Position:  [10.45540244]


portfolio before change:  [3.98312635]
curr_Stock_Price:  105.08611764146465
curr_Factors:  [105.08611764]
mat_Sqrt:  [[0.15]]
grads:  [-0.03874913]
Stock Position:  -0.03874913473559712
Bond Position:  [8.05512249]


portfolio before change:  [3.99876606]
curr_Stock_Price:  104.69549602854018
curr_Factors:  [104.69549603]
mat_Sqrt:  [[0.15]]
grads:  [0.28781207]
Stock Position:  0.28781206835748374
Bond Position:  [-26.13386119]


portfolio before change:  [4.05369736]
curr_Stock_Price:  104.89202951267474
curr_Factors:  [104.89202951]
mat_Sqrt:  [[0.15]]
grads:  [0.02184713]
Stock Position:  0.021847131884173383
Bond Position:  [1.76210735]


portfolio before change:  [4.04220239]
curr_Stock_Price:  104.36083372717117
curr_Factors:  [104.36083373]
mat_Sqrt:  [[0.15]]
grads:  [-0.04956806]
Stock Position:  -0.04956806027422887
Bond Position:  [9.21516648]


portfolio before change:  [4.02535926]
curr_Stock_Price:  104.71225147503337
curr_Factors:  [104.71225148]
mat_Sqrt:  [[0.15]]
grads:  [-0.02845713]
Stock Position:  -0.02845713413430254
Bond Position:  [7.00516984]


portfolio before change:  [4.04395454]
curr_Stock_Price:  104.07418846769846
curr_Factors:  [104.07418847]
mat_Sqrt:  [[0.15]]
grads:  [-0.03169369]
Stock Position:  -0.03169369499976207
Bond Position:  [7.34245012]


portfolio before change:  [4.04181513]
curr_Stock_Price:  104.15617071913961
curr_Factors:  [104.15617072]
mat_Sqrt:  [[0.15]]
grads:  [-0.02467253]
Stock Position:  -0.02467253264367784
Bond Position:  [6.61161166]


portfolio before change:  [4.04457383]
curr_Stock_Price:  104.06110736240873
curr_Factors:  [104.06110736]
mat_Sqrt:  [[0.15]]
grads:  [0.00961097]
Stock Position:  0.00961096572489389
Bond Position:  [3.04444609]


portfolio before change:  [4.05135064]
curr_Stock_Price:  104.74642168565167
curr_Factors:  [104.74642169]
mat_Sqrt:  [[0.15]]
grads:  [0.0364197]
Stock Position:  0.03641970478691587
Bond Position:  [0.23651689]


portfolio before change:  [4.05746338]
curr_Stock_Price:  104.91385726181554
curr_Factors:  [104.91385726]
mat_Sqrt:  [[0.15]]
grads:  [-0.04474263]
Stock Position:  -0.04474263345818126
Bond Position:  [8.75158564]


portfolio before change:  [4.0799164]
curr_Stock_Price:  104.42425644226297
curr_Factors:  [104.42425644]
mat_Sqrt:  [[0.15]]
grads:  [-0.34251774]
Stock Position:  -0.34251773664975793
Bond Position:  [39.84707637]


portfolio before change:  [3.93168494]
curr_Stock_Price:  104.86429783677943
curr_Factors:  [104.86429784]
mat_Sqrt:  [[0.15]]
grads:  [-0.02849525]
Stock Position:  -0.028495246780507272
Bond Position:  [6.91981898]


portfolio before change:  [3.92541083]
curr_Stock_Price:  105.09965683704456
curr_Factors:  [105.09965684]
mat_Sqrt:  [[0.15]]
grads:  [0.11529929]
Stock Position:  0.11529929081624035
Bond Position:  [-8.19250507]


portfolio before change:  [3.84741571]
curr_Stock_Price:  104.42763991160308
curr_Factors:  [104.42763991]
mat_Sqrt:  [[0.15]]
grads:  [-0.09536385]
Stock Position:  -0.0953638499388839
Bond Position:  [13.80603749]


portfolio before change:  [3.90495589]
curr_Stock_Price:  103.83331323773282
curr_Factors:  [103.83331324]
mat_Sqrt:  [[0.15]]
grads:  [-0.01378243]
Stock Position:  -0.013782434870129917
Bond Position:  [5.33603177]


portfolio before change:  [3.89263835]
curr_Stock_Price:  104.75122484077728
curr_Factors:  [104.75122484]
mat_Sqrt:  [[0.15]]
grads:  [0.01842128]
Stock Position:  0.018421283037009184
Bond Position:  [1.96298638]


portfolio before change:  [3.90659721]
curr_Stock_Price:  105.50232208063704
curr_Factors:  [105.50232208]
mat_Sqrt:  [[0.15]]
grads:  [-0.09042548]
Stock Position:  -0.09042547866850512
Bond Position:  [13.44669519]


portfolio before change:  [3.84224263]
curr_Stock_Price:  106.22330278973061
curr_Factors:  [106.22330279]
mat_Sqrt:  [[0.15]]
grads:  [0.14594721]
Stock Position:  0.1459472145045329
Bond Position:  [-11.66075253]


portfolio before change:  [3.98459391]
curr_Stock_Price:  107.20365794226119
curr_Factors:  [107.20365794]
mat_Sqrt:  [[0.15]]
grads:  [0.29009374]
Stock Position:  0.2900937379831898
Bond Position:  [-27.11451594]


portfolio before change:  [3.97993375]
curr_Stock_Price:  107.19343552677098
curr_Factors:  [107.19343553]
mat_Sqrt:  [[0.15]]
grads:  [-0.09901899]
Stock Position:  -0.09901899170717136
Bond Position:  [14.59411965]


portfolio before change:  [3.83041428]
curr_Stock_Price:  108.71265550759044
curr_Factors:  [108.71265551]
mat_Sqrt:  [[0.15]]
grads:  [-0.03753512]
Stock Position:  -0.03753512147134971
Bond Position:  [7.91095701]


portfolio before change:  [3.79153068]
curr_Stock_Price:  109.7617541452615
curr_Factors:  [109.76175415]
mat_Sqrt:  [[0.15]]
grads:  [0.02841915]
Stock Position:  0.028419153468498076
Bond Position:  [0.67219455]


portfolio before change:  [3.80246425]
curr_Stock_Price:  110.14500119614578
curr_Factors:  [110.1450012]
mat_Sqrt:  [[0.15]]
grads:  [0.02504478]
Stock Position:  0.025044781990353145
Bond Position:  [1.04390671]


portfolio before change:  [3.8179971]
curr_Stock_Price:  110.76259914469549
curr_Factors:  [110.76259914]
mat_Sqrt:  [[0.15]]
grads:  [-0.09570291]
Stock Position:  -0.0957029080558748
Bond Position:  [14.41829995]


portfolio before change:  [3.83634115]
curr_Stock_Price:  110.58033851744793
curr_Factors:  [110.58033852]
mat_Sqrt:  [[0.15]]
grads:  [-0.12965591]
Stock Position:  -0.12965590940941532
Bond Position:  [18.1737355]


portfolio before change:  [3.74989009]
curr_Stock_Price:  111.2558723266507
curr_Factors:  [111.25587233]
mat_Sqrt:  [[0.15]]
grads:  [0.10712405]
Stock Position:  0.10712404761407682
Bond Position:  [-8.16828927]


portfolio before change:  [3.72104783]
curr_Stock_Price:  110.99139640753012
curr_Factors:  [110.99139641]
mat_Sqrt:  [[0.15]]
grads:  [-0.39774351]
Stock Position:  -0.39774351064966124
Bond Position:  [47.86715549]


portfolio before change:  [3.68825787]
curr_Stock_Price:  111.08135825999534
curr_Factors:  [111.08135826]
mat_Sqrt:  [[0.15]]
grads:  [-0.13636205]
Stock Position:  -0.13636204930552454
Bond Position:  [18.83553953]


portfolio before change:  [3.68731092]
curr_Stock_Price:  111.0969359867674
curr_Factors:  [111.09693599]
mat_Sqrt:  [[0.15]]
grads:  [0.18480829]
Stock Position:  0.1848082880870565
Bond Position:  [-16.84432363]


portfolio before change:  [3.78239179]
curr_Stock_Price:  111.61711649735321
curr_Factors:  [111.6171165]
mat_Sqrt:  [[0.15]]
grads:  [-0.14445586]
Stock Position:  -0.14445585906793976
Bond Position:  [19.90613824]


portfolio before change:  [3.9198312]
curr_Stock_Price:  110.67430085410044
curr_Factors:  [110.67430085]
mat_Sqrt:  [[0.15]]
grads:  [0.09035295]
Stock Position:  0.09035294863474717
Bond Position:  [-6.07991822]


portfolio before change:  [3.92663445]
curr_Stock_Price:  110.75380296848031
curr_Factors:  [110.75380297]
mat_Sqrt:  [[0.15]]
grads:  [-0.07933564]
Stock Position:  -0.07933564157477878
Bond Position:  [12.71335846]


portfolio before change:  [3.86864195]
curr_Stock_Price:  111.49479532805978
curr_Factors:  [111.49479533]
mat_Sqrt:  [[0.15]]
grads:  [-0.08369692]
Stock Position:  -0.0836969222081892
Bond Position:  [13.20041316]


portfolio before change:  [3.82805799]
curr_Stock_Price:  111.98954491417902
curr_Factors:  [111.98954491]
mat_Sqrt:  [[0.15]]
grads:  [-0.01452109]
Stock Position:  -0.014521089503500536
Bond Position:  [5.45426819]


portfolio before change:  [3.84113882]
curr_Stock_Price:  111.11220528548192
curr_Factors:  [111.11220529]
mat_Sqrt:  [[0.15]]
grads:  [1.46573543]
Stock Position:  1.4657354339049673
Bond Position:  [-159.01995761]


portfolio before change:  [3.5751101]
curr_Stock_Price:  110.93748776580205
curr_Factors:  [110.93748777]
mat_Sqrt:  [[0.15]]
grads:  [-0.02915765]
Stock Position:  -0.029157650705833888
Bond Position:  [6.80978662]


portfolio before change:  [3.57361847]
curr_Stock_Price:  111.00324242557274
curr_Factors:  [111.00324243]
mat_Sqrt:  [[0.15]]
grads:  [-0.04497014]
Stock Position:  -0.04497014185656667
Bond Position:  [8.56545003]


portfolio before change:  [3.54646493]
curr_Stock_Price:  111.61895992827652
curr_Factors:  [111.61895993]
mat_Sqrt:  [[0.15]]
grads:  [0.06294509]
Stock Position:  0.06294508857527979
Bond Position:  [-3.47940039]


portfolio before change:  [3.58616606]
curr_Stock_Price:  112.25314125523771
curr_Factors:  [112.25314126]
mat_Sqrt:  [[0.15]]
grads:  [0.14693544]
Stock Position:  0.14693543558868283
Bond Position:  [-12.90779815]


portfolio before change:  [3.62079463]
curr_Stock_Price:  112.49430387007236
curr_Factors:  [112.49430387]
mat_Sqrt:  [[0.15]]
grads:  [-0.28165246]
Stock Position:  -0.28165246229949203
Bond Position:  [35.30509231]


portfolio before change:  [3.81686315]
curr_Stock_Price:  111.80600211484703
curr_Factors:  [111.80600211]
mat_Sqrt:  [[0.15]]
grads:  [-0.05499751]
Stock Position:  -0.05499750756701112
Bond Position:  [9.9659146]


portfolio before change:  [3.78073022]
curr_Stock_Price:  112.47432001676647
curr_Factors:  [112.47432002]
mat_Sqrt:  [[0.15]]
grads:  [-0.01297861]
Stock Position:  -0.012978605210369261
Bond Position:  [5.24049002]


portfolio before change:  [3.77353947]
curr_Stock_Price:  113.05360318311045
curr_Factors:  [113.05360318]
mat_Sqrt:  [[0.15]]
grads:  [0.1971285]
Stock Position:  0.1971285031674939
Bond Position:  [-18.5125481]


portfolio before change:  [3.75490036]
curr_Stock_Price:  112.96491970936962
curr_Factors:  [112.96491971]
mat_Sqrt:  [[0.15]]
grads:  [-0.006008]
Stock Position:  -0.006007999944593566
Bond Position:  [4.43359359]


portfolio before change:  [3.75596641]
curr_Stock_Price:  112.83360447360054
curr_Factors:  [112.83360447]
mat_Sqrt:  [[0.15]]
grads:  [-0.03761642]
Stock Position:  -0.03761641977029003
Bond Position:  [8.00036264]


portfolio before change:  [3.78216188]
curr_Stock_Price:  112.1505138234703
curr_Factors:  [112.15051382]
mat_Sqrt:  [[0.15]]
grads:  [0.09422082]
Stock Position:  0.09422082269513805
Bond Position:  [-6.7847518]


portfolio before change:  [3.67929591]
curr_Stock_Price:  111.06326042154687
curr_Factors:  [111.06326042]
mat_Sqrt:  [[0.15]]
grads:  [-0.02971193]
Stock Position:  -0.029711926897932908
Bond Position:  [6.97919938]


portfolio before change:  [3.6901427]
curr_Stock_Price:  110.71287635697871
curr_Factors:  [110.71287636]
mat_Sqrt:  [[0.15]]
grads:  [-0.00101021]
Stock Position:  -0.001010212353128789
Bond Position:  [3.80198622]


portfolio before change:  [3.69108323]
curr_Stock_Price:  110.01709001506686
curr_Factors:  [110.01709002]
mat_Sqrt:  [[0.15]]
grads:  [0.19727038]
Stock Position:  0.19727037683974968
Bond Position:  [-18.01202958]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.69108323]
Stock Price:  109.93035011461036
PL:  [-6.23926689]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-7.08989190e-02]
 [ 3.02452186e-03]
 [ 1.55462087e-02]
 [ 3.34254535e-03]
 [-7.25847624e-03]
 [ 1.22245335e-02]
 [-3.16989475e-04]
 [ 1.06972676e-02]
 [-7.93321700e-03]
 [-1.92988071e-02]
 [ 1.00564402e-02]
 [-9.01110924e-03]
 [ 2.40918978e-02]
 [ 2.03527205e-02]
 [-7.99843447e-03]
 [-7.02141089e-03]
 [ 2.38414504e-02]
 [ 7.54681447e-03]
 [-5.00921405e-02]
 [-8.37132558e-03]
 [-6.65290947e-02]
 [-4.58246223e-03]
 [-2.57735007e-02]
 [ 1.53954005e-02]
 [ 2.17327754e-02]
 [ 4.60148642e-03]
 [ 1.51153115e-03]
 [ 3.04100542e-02]
 [ 1.34802855e-02]
 [-7.88303880e-03]
 [-5.93963350e-03]
 [ 3.42911440e-02]
 [ 9.65780496e-04]
 [-1.42899968e-02]
 [ 5.14369316e-03]
 [-8.73801764e-03]
 [ 2.14547750e-03]
 [-1.29019040e-02]
 [ 1.04480226e-02]
 [-2.53973030e-03]
 [-7.37187113e-02]
 [-6.34428181e-03]
 [ 2.45237528e-02]
 [-2.14344507e-02]
 [-1.29460088e-02]
 [ 3.85766446e-03]
 [-1.34504490e-02]
 [ 3.47375441e-02]
 [ 5.98650654e-02]
 [-1.74348054e-02]
 [-5.83523540e-03]
 [ 4.20635374e-03]
 [ 3.63155213e-03]
 [-1.05608108e-02]
 [-1.76835427e-02]
 [ 1.42813151e-02]
 [-4.76817870e-02]
 [-1.69315830e-02]
 [ 2.40904716e-02]
 [-1.43065511e-02]
 [ 1.33946232e-02]
 [-1.26708889e-02]
 [-1.26109120e-02]
 [-2.23260459e-03]
 [ 1.53113776e-01]
 [-1.09645777e-02]
 [-2.06230320e-03]
 [ 8.41272880e-03]
 [ 1.90921701e-02]
 [-3.71503454e-02]
 [-8.05083060e-03]
 [-3.93518532e-03]
 [ 1.93199486e-02]
 [ 3.60661056e-03]
 [-2.37787001e-03]
 [ 5.78645949e-03]
 [ 1.25889272e-03]
 [-1.35404114e-03]
 [ 2.76013930e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.05157568]
curr_Stock_Price:  100.70602143817848
curr_Factors:  [100.70602144]
mat_Sqrt:  [[0.15]]
grads:  [-0.47265946]
Stock Position:  -0.4726594597231587
Bond Position:  [60.65122936]


portfolio before change:  [12.71297513]
curr_Stock_Price:  101.43041478954986
curr_Factors:  [101.43041479]
mat_Sqrt:  [[0.15]]
grads:  [0.02016348]
Stock Position:  0.020163479083015662
Bond Position:  [10.66778508]


portfolio before change:  [12.72735066]
curr_Stock_Price:  102.11029610131305
curr_Factors:  [102.1102961]
mat_Sqrt:  [[0.15]]
grads:  [0.10364139]
Stock Position:  0.10364139110962094
Bond Position:  [2.14449752]


portfolio before change:  [12.69714514]
curr_Stock_Price:  101.81756021185555
curr_Factors:  [101.81756021]
mat_Sqrt:  [[0.15]]
grads:  [0.02228364]
Stock Position:  0.022283635675496884
Bond Position:  [10.42827972]


portfolio before change:  [12.71446527]
curr_Stock_Price:  102.56556842634116
curr_Factors:  [102.56556843]
mat_Sqrt:  [[0.15]]
grads:  [-0.04838984]
Stock Position:  -0.04838984162279052
Bond Position:  [17.67759688]


portfolio before change:  [12.7473325]
curr_Stock_Price:  101.90918376136408
curr_Factors:  [101.90918376]
mat_Sqrt:  [[0.15]]
grads:  [0.08149689]
Stock Position:  0.08149688975956969
Bond Position:  [4.44205099]


portfolio before change:  [12.7393849]
curr_Stock_Price:  101.80825674723884
curr_Factors:  [101.80825675]
mat_Sqrt:  [[0.15]]
grads:  [-0.00211326]
Stock Position:  -0.002113263165132657
Bond Position:  [12.95453254]


portfolio before change:  [12.73944998]
curr_Stock_Price:  102.16060740163475
curr_Factors:  [102.1606074]
mat_Sqrt:  [[0.15]]
grads:  [0.07131512]
Stock Position:  0.07131511726808987
Bond Position:  [5.45385428]


portfolio before change:  [12.70342509]
curr_Stock_Price:  101.65067677095205
curr_Factors:  [101.65067677]
mat_Sqrt:  [[0.15]]
grads:  [-0.05288811]
Stock Position:  -0.05288811336071326
Bond Position:  [18.07953761]


portfolio before change:  [12.72220856]
curr_Stock_Price:  101.31688795686253
curr_Factors:  [101.31688796]
mat_Sqrt:  [[0.15]]
grads:  [-0.12865871]
Stock Position:  -0.12865871427781891
Bond Position:  [25.7575091]


portfolio before change:  [12.69007983]
curr_Stock_Price:  101.57912147155369
curr_Factors:  [101.57912147]
mat_Sqrt:  [[0.15]]
grads:  [0.06704293]
Stock Position:  0.06704293450404247
Bond Position:  [5.87991744]


portfolio before change:  [12.699222]
curr_Stock_Price:  101.71000285800395
curr_Factors:  [101.71000286]
mat_Sqrt:  [[0.15]]
grads:  [-0.06007406]
Stock Position:  -0.060074061622528874
Bond Position:  [18.80935498]


portfolio before change:  [12.66247019]
curr_Stock_Price:  102.34134744745248
curr_Factors:  [102.34134745]
mat_Sqrt:  [[0.15]]
grads:  [0.16061265]
Stock Position:  0.16061265203335845
Bond Position:  [-3.77484503]


portfolio before change:  [12.79123603]
curr_Stock_Price:  103.1445330557025
curr_Factors:  [103.14453306]
mat_Sqrt:  [[0.15]]
grads:  [0.1356848]
Stock Position:  0.13568480351296808
Bond Position:  [-1.20390967]


portfolio before change:  [12.77457013]
curr_Stock_Price:  103.02225958348377
curr_Factors:  [103.02225958]
mat_Sqrt:  [[0.15]]
grads:  [-0.0533229]
Stock Position:  -0.05332289645760839
Bond Position:  [18.26801541]


portfolio before change:  [12.74124263]
curr_Stock_Price:  103.66868516424857
curr_Factors:  [103.66868516]
mat_Sqrt:  [[0.15]]
grads:  [-0.04680941]
Stock Position:  -0.046809405951069076
Bond Position:  [17.5939122]


portfolio before change:  [12.65912028]
curr_Stock_Price:  105.4465759175011
curr_Factors:  [105.44657592]
mat_Sqrt:  [[0.15]]
grads:  [0.158943]
Stock Position:  0.15894300233926292
Bond Position:  [-4.10087509]


portfolio before change:  [12.79751847]
curr_Stock_Price:  106.31892953537906
curr_Factors:  [106.31892954]
mat_Sqrt:  [[0.15]]
grads:  [0.0503121]
Stock Position:  0.05031209646510795
Bond Position:  [7.44839023]


portfolio before change:  [12.79957471]
curr_Stock_Price:  106.35054627997924
curr_Factors:  [106.35054628]
mat_Sqrt:  [[0.15]]
grads:  [-0.3339476]
Stock Position:  -0.333947603214602
Bond Position:  [48.31508474]


portfolio before change:  [12.66120792]
curr_Stock_Price:  106.77392580078153
curr_Factors:  [106.7739258]
mat_Sqrt:  [[0.15]]
grads:  [-0.05580884]
Stock Position:  -0.05580883717091067
Bond Position:  [18.62013656]


portfolio before change:  [12.62896751]
curr_Stock_Price:  107.37247269453702
curr_Factors:  [107.37247269]
mat_Sqrt:  [[0.15]]
grads:  [-0.4435273]
Stock Position:  -0.44352729801531293
Bond Position:  [60.2515902]


portfolio before change:  [12.39589119]
curr_Stock_Price:  107.90646950433685
curr_Factors:  [107.9064695]
mat_Sqrt:  [[0.15]]
grads:  [-0.03054975]
Stock Position:  -0.03054974820324484
Bond Position:  [15.69240666]


portfolio before change:  [12.40380917]
curr_Stock_Price:  107.67939159431269
curr_Factors:  [107.67939159]
mat_Sqrt:  [[0.15]]
grads:  [-0.17182334]
Stock Position:  -0.1718233380284662
Bond Position:  [30.90564167]


portfolio before change:  [12.50013621]
curr_Stock_Price:  107.1300169911723
curr_Factors:  [107.13001699]
mat_Sqrt:  [[0.15]]
grads:  [0.102636]
Stock Position:  0.10263600348276096
Bond Position:  [1.50473941]


portfolio before change:  [12.53223461]
curr_Stock_Price:  107.4418408398647
curr_Factors:  [107.44184084]
mat_Sqrt:  [[0.15]]
grads:  [0.14488517]
Stock Position:  0.14488516909751392
Bond Position:  [-3.03449467]


portfolio before change:  [12.56030904]
curr_Stock_Price:  107.63692011498043
curr_Factors:  [107.63692011]
mat_Sqrt:  [[0.15]]
grads:  [0.03067658]
Stock Position:  0.03067657612842371
Bond Position:  [9.25837687]


portfolio before change:  [12.57478296]
curr_Stock_Price:  108.0898795689792
curr_Factors:  [108.08987957]
mat_Sqrt:  [[0.15]]
grads:  [0.01007687]
Stock Position:  0.010076874300851715
Bond Position:  [11.48557483]


portfolio before change:  [12.57965541]
curr_Stock_Price:  108.50216888140986
curr_Factors:  [108.50216888]
mat_Sqrt:  [[0.15]]
grads:  [0.20273369]
Stock Position:  0.20273369456473564
Bond Position:  [-9.41739015]


portfolio before change:  [12.4291362]
curr_Stock_Price:  107.76262427132464
curr_Factors:  [107.76262427]
mat_Sqrt:  [[0.15]]
grads:  [0.08986857]
Stock Position:  0.08986856984257219
Bond Position:  [2.74466327]


portfolio before change:  [12.37759138]
curr_Stock_Price:  107.18715759558611
curr_Factors:  [107.1871576]
mat_Sqrt:  [[0.15]]
grads:  [-0.05255359]
Stock Position:  -0.05255359199966287
Bond Position:  [18.01066153]


portfolio before change:  [12.34823298]
curr_Stock_Price:  107.76721494182432
curr_Factors:  [107.76721494]
mat_Sqrt:  [[0.15]]
grads:  [-0.03959756]
Stock Position:  -0.03959755669463899
Bond Position:  [16.61555139]


portfolio before change:  [12.35572017]
curr_Stock_Price:  107.60435943565943
curr_Factors:  [107.60435944]
mat_Sqrt:  [[0.15]]
grads:  [0.22860763]
Stock Position:  0.22860762654691438
Bond Position:  [-12.24345705]


portfolio before change:  [12.37384241]
curr_Stock_Price:  107.68697909787194
curr_Factors:  [107.6869791]
mat_Sqrt:  [[0.15]]
grads:  [0.00643854]
Stock Position:  0.006438536641656329
Bond Position:  [11.68049585]


portfolio before change:  [12.37419662]
curr_Stock_Price:  107.62860433302237
curr_Factors:  [107.62860433]
mat_Sqrt:  [[0.15]]
grads:  [-0.09526665]
Stock Position:  -0.09526664553594878
Bond Position:  [22.62761272]


portfolio before change:  [12.35861726]
curr_Stock_Price:  107.80698392560657
curr_Factors:  [107.80698393]
mat_Sqrt:  [[0.15]]
grads:  [0.03429129]
Stock Position:  0.034291287706776225
Bond Position:  [8.66177696]


portfolio before change:  [12.36582636]
curr_Stock_Price:  108.00142736789103
curr_Factors:  [108.00142737]
mat_Sqrt:  [[0.15]]
grads:  [-0.05825345]
Stock Position:  -0.058253450918468064
Bond Position:  [18.6572822]


portfolio before change:  [12.39356769]
curr_Stock_Price:  107.54522753274655
curr_Factors:  [107.54522753]
mat_Sqrt:  [[0.15]]
grads:  [0.01430318]
Stock Position:  0.014303183356147154
Bond Position:  [10.85532858]


portfolio before change:  [12.40154335]
curr_Stock_Price:  108.05540644825619
curr_Factors:  [108.05540645]
mat_Sqrt:  [[0.15]]
grads:  [-0.08601269]
Stock Position:  -0.08601269342163001
Bond Position:  [21.6956799]


portfolio before change:  [12.4092195]
curr_Stock_Price:  107.9819273940207
curr_Factors:  [107.98192739]
mat_Sqrt:  [[0.15]]
grads:  [0.06965348]
Stock Position:  0.0696534838982215
Bond Position:  [4.88790206]


portfolio before change:  [12.42111302]
curr_Stock_Price:  108.14829398943365
curr_Factors:  [108.14829399]
mat_Sqrt:  [[0.15]]
grads:  [-0.01693154]
Stock Position:  -0.016931535363816308
Bond Position:  [14.25222968]


portfolio before change:  [12.42033395]
curr_Stock_Price:  108.246918527752
curr_Factors:  [108.24691853]
mat_Sqrt:  [[0.15]]
grads:  [-0.49145808]
Stock Position:  -0.4914580755912292
Bond Position:  [65.61915621]


portfolio before change:  [12.27668566]
curr_Stock_Price:  108.54755375293594
curr_Factors:  [108.54755375]
mat_Sqrt:  [[0.15]]
grads:  [-0.04229521]
Stock Position:  -0.042295212043025755
Bond Position:  [16.86772747]


portfolio before change:  [12.27548155]
curr_Stock_Price:  108.60094941548027
curr_Factors:  [108.60094942]
mat_Sqrt:  [[0.15]]
grads:  [0.16349169]
Stock Position:  0.16349168514563095
Bond Position:  [-5.47987068]


portfolio before change:  [12.31307437]
curr_Stock_Price:  108.83298156001587
curr_Factors:  [108.83298156]
mat_Sqrt:  [[0.15]]
grads:  [-0.14289634]
Stock Position:  -0.14289633798186596
Bond Position:  [27.86490889]


portfolio before change:  [12.40807487]
curr_Stock_Price:  108.18034837255865
curr_Factors:  [108.18034837]
mat_Sqrt:  [[0.15]]
grads:  [-0.08630673]
Stock Position:  -0.08630672505172027
Bond Position:  [21.74476646]


portfolio before change:  [12.36835864]
curr_Stock_Price:  108.656271080551
curr_Factors:  [108.65627108]
mat_Sqrt:  [[0.15]]
grads:  [0.02571776]
Stock Position:  0.025717763095807495
Bond Position:  [9.5739624]


portfolio before change:  [12.36038333]
curr_Stock_Price:  108.3228945079145
curr_Factors:  [108.32289451]
mat_Sqrt:  [[0.15]]
grads:  [-0.08966966]
Stock Position:  -0.08966965994398894
Bond Position:  [22.07366044]


portfolio before change:  [12.35487461]
curr_Stock_Price:  108.39971387490749
curr_Factors:  [108.39971387]
mat_Sqrt:  [[0.15]]
grads:  [0.23158363]
Stock Position:  0.23158362714065445
Bond Position:  [-12.74872431]


portfolio before change:  [12.44280557]
curr_Stock_Price:  108.78284884399254
curr_Factors:  [108.78284884]
mat_Sqrt:  [[0.15]]
grads:  [0.39910044]
Stock Position:  0.3991004360211852
Bond Position:  [-30.97247683]


portfolio before change:  [12.61557785]
curr_Stock_Price:  109.22060360609828
curr_Factors:  [109.22060361]
mat_Sqrt:  [[0.15]]
grads:  [-0.11623204]
Stock Position:  -0.11623203628045739
Bond Position:  [25.31051101]


portfolio before change:  [12.61116467]
curr_Stock_Price:  109.27218263254366
curr_Factors:  [109.27218263]
mat_Sqrt:  [[0.15]]
grads:  [-0.03890157]
Stock Position:  -0.0389015693500027
Bond Position:  [16.86202406]


portfolio before change:  [12.60575684]
curr_Stock_Price:  109.43828736271462
curr_Factors:  [109.43828736]
mat_Sqrt:  [[0.15]]
grads:  [0.02804236]
Stock Position:  0.028042358234943894
Bond Position:  [9.53684919]


portfolio before change:  [12.58477128]
curr_Stock_Price:  108.66867889350713
curr_Factors:  [108.66867889]
mat_Sqrt:  [[0.15]]
grads:  [0.02421035]
Stock Position:  0.024210347514328052
Bond Position:  [9.9538648]


portfolio before change:  [12.58606995]
curr_Stock_Price:  108.69662290445191
curr_Factors:  [108.6966229]
mat_Sqrt:  [[0.15]]
grads:  [-0.07040541]
Stock Position:  -0.07040540560415738
Bond Position:  [20.23889977]


portfolio before change:  [12.52163786]
curr_Stock_Price:  109.62974821066295
curr_Factors:  [109.62974821]
mat_Sqrt:  [[0.15]]
grads:  [-0.11789028]
Stock Position:  -0.1178902845953951
Bond Position:  [25.44592007]


portfolio before change:  [12.6254807]
curr_Stock_Price:  108.76239574849394
curr_Factors:  [108.76239575]
mat_Sqrt:  [[0.15]]
grads:  [0.09520877]
Stock Position:  0.09520876708757517
Bond Position:  [2.2703471]


portfolio before change:  [12.64954331]
curr_Stock_Price:  109.01364052694812
curr_Factors:  [109.01364053]
mat_Sqrt:  [[0.15]]
grads:  [-0.31787858]
Stock Position:  -0.3178785797511187
Bond Position:  [47.30264453]


portfolio before change:  [12.43033877]
curr_Stock_Price:  109.71252703506589
curr_Factors:  [109.71252704]
mat_Sqrt:  [[0.15]]
grads:  [-0.11287722]
Stock Position:  -0.11287721981751417
Bond Position:  [24.8143838]


portfolio before change:  [12.53233913]
curr_Stock_Price:  108.82262719750705
curr_Factors:  [108.8226272]
mat_Sqrt:  [[0.15]]
grads:  [0.16060314]
Stock Position:  0.16060314429553413
Bond Position:  [-4.94491696]


portfolio before change:  [12.48513293]
curr_Stock_Price:  108.53062087586643
curr_Factors:  [108.53062088]
mat_Sqrt:  [[0.15]]
grads:  [-0.09537701]
Stock Position:  -0.09537700711512156
Bond Position:  [22.83645873]


portfolio before change:  [12.45154859]
curr_Stock_Price:  108.89770795695051
curr_Factors:  [108.89770796]
mat_Sqrt:  [[0.15]]
grads:  [0.08929749]
Stock Position:  0.08929748779048707
Bond Position:  [2.72725684]


portfolio before change:  [12.46333676]
curr_Stock_Price:  109.02780919555256
curr_Factors:  [109.0278092]
mat_Sqrt:  [[0.15]]
grads:  [-0.08447259]
Stock Position:  -0.08447259286625922
Bond Position:  [21.6731985]


portfolio before change:  [12.42453147]
curr_Stock_Price:  109.50322862964649
curr_Factors:  [109.50322863]
mat_Sqrt:  [[0.15]]
grads:  [-0.08407275]
Stock Position:  -0.08407274640043738
Bond Position:  [21.63076864]


portfolio before change:  [12.45404957]
curr_Stock_Price:  109.16820765911686
curr_Factors:  [109.16820766]
mat_Sqrt:  [[0.15]]
grads:  [-0.01488403]
Stock Position:  -0.014884030576970811
Bond Position:  [14.07891251]


portfolio before change:  [12.46390067]
curr_Stock_Price:  108.56547122915111
curr_Factors:  [108.56547123]
mat_Sqrt:  [[0.15]]
grads:  [1.02075851]
Stock Position:  1.0207585079310124
Bond Position:  [-98.35522775]


portfolio before change:  [12.30545418]
curr_Stock_Price:  108.41626933414177
curr_Factors:  [108.41626933]
mat_Sqrt:  [[0.15]]
grads:  [-0.07309718]
Stock Position:  -0.07309718477815733
Bond Position:  [20.23037825]


portfolio before change:  [12.24840166]
curr_Stock_Price:  109.2140696570076
curr_Factors:  [109.21406966]
mat_Sqrt:  [[0.15]]
grads:  [-0.01374869]
Stock Position:  -0.013748688004010825
Bond Position:  [13.74995183]


portfolio before change:  [12.23581357]
curr_Stock_Price:  110.19216159373198
curr_Factors:  [110.19216159]
mat_Sqrt:  [[0.15]]
grads:  [0.05608486]
Stock Position:  0.056084858639483634
Bond Position:  [6.05570177]


portfolio before change:  [12.23148591]
curr_Stock_Price:  110.10825014080854
curr_Factors:  [110.10825014]
mat_Sqrt:  [[0.15]]
grads:  [0.12728113]
Stock Position:  0.1272811342766267
Bond Position:  [-1.78321707]


portfolio before change:  [12.26946657]
curr_Stock_Price:  110.40752555616841
curr_Factors:  [110.40752556]
mat_Sqrt:  [[0.15]]
grads:  [-0.24766897]
Stock Position:  -0.24766896966443547
Bond Position:  [39.61398466]


portfolio before change:  [12.44477012]
curr_Stock_Price:  109.70970859538981
curr_Factors:  [109.7097086]
mat_Sqrt:  [[0.15]]
grads:  [-0.0536722]
Stock Position:  -0.05367220398985392
Bond Position:  [18.33313198]


portfolio before change:  [12.47272908]
curr_Stock_Price:  109.21013723074934
curr_Factors:  [109.21013723]
mat_Sqrt:  [[0.15]]
grads:  [-0.02623457]
Stock Position:  -0.026234568804758513
Bond Position:  [15.33780994]


portfolio before change:  [12.47765367]
curr_Stock_Price:  109.05896461084417
curr_Factors:  [109.05896461]
mat_Sqrt:  [[0.15]]
grads:  [0.12879966]
Stock Position:  0.12879965736498095
Bond Position:  [-1.56910361]


portfolio before change:  [12.40148019]
curr_Stock_Price:  108.46831546633422
curr_Factors:  [108.46831547]
mat_Sqrt:  [[0.15]]
grads:  [0.02404407]
Stock Position:  0.02404407040024532
Bond Position:  [9.79346038]


portfolio before change:  [12.38875992]
curr_Stock_Price:  107.91381775981854
curr_Factors:  [107.91381776]
mat_Sqrt:  [[0.15]]
grads:  [-0.01585247]
Stock Position:  -0.015852466706831343
Bond Position:  [14.09946012]


portfolio before change:  [12.38643612]
curr_Stock_Price:  108.11599685945266
curr_Factors:  [108.11599686]
mat_Sqrt:  [[0.15]]
grads:  [0.0385764]
Stock Position:  0.03857639659859773
Bond Position:  [8.21571055]


portfolio before change:  [12.40570942]
curr_Stock_Price:  108.60229927917392
curr_Factors:  [108.60229928]
mat_Sqrt:  [[0.15]]
grads:  [0.00839262]
Stock Position:  0.008392618110058873
Bond Position:  [11.49425179]


portfolio before change:  [12.41071314]
curr_Stock_Price:  109.11290429438553
curr_Factors:  [109.11290429]
mat_Sqrt:  [[0.15]]
grads:  [-0.00902694]
Stock Position:  -0.00902694093004698
Bond Position:  [13.39566888]


portfolio before change:  [12.40702606]
curr_Stock_Price:  109.61410805682655
curr_Factors:  [109.61410806]
mat_Sqrt:  [[0.15]]
grads:  [0.18400929]
Stock Position:  0.1840092864000927
Bond Position:  [-7.76298774]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.40702606]
Stock Price:  108.51517312493547
PL:  [3.89185294]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.57103333e-02]
 [-2.29315823e-03]
 [ 2.91542366e-04]
 [ 2.15133085e-03]
 [ 1.61596061e-02]
 [ 1.18133471e-02]
 [ 9.09917287e-04]
 [ 9.23674601e-03]
 [-7.22702393e-03]
 [-1.65640259e-02]
 [ 9.83838409e-03]
 [-1.27316979e-02]
 [ 3.45352694e-02]
 [ 1.08552952e-02]
 [ 6.34978347e-05]
 [-1.01166078e-02]
 [ 7.98758898e-03]
 [ 2.40152356e-02]
 [ 1.82865127e-02]
 [-1.57633295e-04]
 [ 7.63036472e-02]
 [-1.31554513e-02]
 [ 2.56025357e-05]
 [ 3.97728649e-05]
 [ 1.53674811e-02]
 [ 1.01300561e-02]
 [ 1.03998242e-02]
 [ 7.22475292e-03]
 [ 6.58584272e-03]
 [-2.54268330e-02]
 [-4.40073894e-03]
 [ 3.95198768e-03]
 [ 1.48754157e-02]
 [ 1.97171119e-02]
 [-1.67218346e-02]
 [ 6.98310148e-03]
 [-2.55064813e-03]
 [ 8.22612061e-03]
 [ 3.40280420e-03]
 [-1.52357178e-02]
 [ 3.82226911e-02]
 [-3.53175059e-04]
 [ 5.25966367e-03]
 [-9.01721854e-03]
 [-1.57943639e-03]
 [-1.01159582e-02]
 [-1.33914602e-02]
 [ 3.22993888e-04]
 [-2.78915352e-03]
 [ 1.04795840e-03]
 [-3.56066025e-03]
 [ 2.97610346e-03]
 [ 3.63129208e-03]
 [-6.90336661e-04]
 [ 1.33195060e-02]
 [ 8.91453400e-03]
 [ 2.54534084e-03]
 [ 1.18992841e-02]
 [ 1.30431692e-02]
 [-5.11036925e-03]
 [-5.67941534e-03]
 [-2.66714328e-02]
 [-1.28557797e-02]
 [-2.34701715e-03]
 [-7.84738155e-03]
 [ 4.72504485e-03]
 [ 9.01341119e-03]
 [ 1.73563964e-03]
 [ 1.45237922e-02]
 [-1.95951134e-02]
 [ 1.86904579e-02]
 [-5.91189499e-03]
 [-2.17465229e-03]
 [ 7.64480523e-03]
 [-2.82027094e-03]
 [ 2.65454160e-03]
 [ 2.17959587e-03]
 [-1.06445307e-02]
 [-2.12638412e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.89838957]
curr_Stock_Price:  100.05346946979625
curr_Factors:  [100.05346947]
mat_Sqrt:  [[0.15]]
grads:  [-0.23806889]
Stock Position:  -0.23806888886519528
Bond Position:  [26.71800787]


portfolio before change:  [2.88153351]
curr_Stock_Price:  100.131287204857
curr_Factors:  [100.1312872]
mat_Sqrt:  [[0.15]]
grads:  [-0.01528772]
Stock Position:  -0.015287721525972416
Bond Position:  [4.41231275]


portfolio before change:  [2.87752797]
curr_Stock_Price:  100.41133712981889
curr_Factors:  [100.41133713]
mat_Sqrt:  [[0.15]]
grads:  [0.00194362]
Stock Position:  0.001943615774123858
Bond Position:  [2.68236691]


portfolio before change:  [2.87748021]
curr_Stock_Price:  100.30050480083575
curr_Factors:  [100.3005048]
mat_Sqrt:  [[0.15]]
grads:  [0.01434221]
Stock Position:  0.014342205635295948
Bond Position:  [1.43894974]


portfolio before change:  [2.86988398]
curr_Stock_Price:  99.76459232507148
curr_Factors:  [99.76459233]
mat_Sqrt:  [[0.15]]
grads:  [0.10773071]
Stock Position:  0.1077307075571959
Bond Position:  [-7.87782614]


portfolio before change:  [2.95440955]
curr_Stock_Price:  100.55376336660954
curr_Factors:  [100.55376337]
mat_Sqrt:  [[0.15]]
grads:  [0.07875565]
Stock Position:  0.07875564765054427
Bond Position:  [-4.96476721]


portfolio before change:  [2.96163492]
curr_Stock_Price:  100.64944761424094
curr_Factors:  [100.64944761]
mat_Sqrt:  [[0.15]]
grads:  [0.00606612]
Stock Position:  0.006066115248455806
Bond Position:  [2.35108377]


portfolio before change:  [2.96242247]
curr_Stock_Price:  100.75505160011973
curr_Factors:  [100.7550516]
mat_Sqrt:  [[0.15]]
grads:  [0.06157831]
Stock Position:  0.0615783067554748
Bond Position:  [-3.241903]


portfolio before change:  [3.01125111]
curr_Stock_Price:  101.5512940784565
curr_Factors:  [101.55129408]
mat_Sqrt:  [[0.15]]
grads:  [-0.04818016]
Stock Position:  -0.04818015950034688
Bond Position:  [7.90400866]


portfolio before change:  [3.01749368]
curr_Stock_Price:  101.43198030757382
curr_Factors:  [101.43198031]
mat_Sqrt:  [[0.15]]
grads:  [-0.11042684]
Stock Position:  -0.1104268395842748
Bond Position:  [14.2183067]


portfolio before change:  [2.88659127]
curr_Stock_Price:  102.62544995832906
curr_Factors:  [102.62544996]
mat_Sqrt:  [[0.15]]
grads:  [0.06558923]
Stock Position:  0.06558922723408628
Bond Position:  [-3.84453269]


portfolio before change:  [2.91060341]
curr_Stock_Price:  102.99521229333452
curr_Factors:  [102.99521229]
mat_Sqrt:  [[0.15]]
grads:  [-0.08487799]
Stock Position:  -0.08487798574124293
Bond Position:  [11.65262957]


portfolio before change:  [2.89609223]
curr_Stock_Price:  103.17475816803892
curr_Factors:  [103.17475817]
mat_Sqrt:  [[0.15]]
grads:  [0.23023513]
Stock Position:  0.23023512944771518
Bond Position:  [-20.85836158]


portfolio before change:  [2.69693227]
curr_Stock_Price:  102.31539204894185
curr_Factors:  [102.31539205]
mat_Sqrt:  [[0.15]]
grads:  [0.07236863]
Stock Position:  0.07236863488657297
Bond Position:  [-4.70749298]


portfolio before change:  [2.65206938]
curr_Stock_Price:  101.69953600435244
curr_Factors:  [101.699536]
mat_Sqrt:  [[0.15]]
grads:  [0.00042332]
Stock Position:  0.00042331889778276144
Bond Position:  [2.60901804]


portfolio before change:  [2.65218659]
curr_Stock_Price:  101.59119600356598
curr_Factors:  [101.591196]
mat_Sqrt:  [[0.15]]
grads:  [-0.06744405]
Stock Position:  -0.06744405187881118
Bond Position:  [9.50390848]


portfolio before change:  [2.62526874]
curr_Stock_Price:  101.9991171876946
curr_Factors:  [101.99911719]
mat_Sqrt:  [[0.15]]
grads:  [0.05325059]
Stock Position:  0.053250593206842674
Bond Position:  [-2.80624475]


portfolio before change:  [2.60953486]
curr_Stock_Price:  101.70694236213153
curr_Factors:  [101.70694236]
mat_Sqrt:  [[0.15]]
grads:  [0.16010157]
Stock Position:  0.16010157051586746
Bond Position:  [-13.67390634]


portfolio before change:  [2.63708676]
curr_Stock_Price:  101.88437063990558
curr_Factors:  [101.88437064]
mat_Sqrt:  [[0.15]]
grads:  [0.12191008]
Stock Position:  0.12191008458322268
Bond Position:  [-9.78364548]


portfolio before change:  [2.594724]
curr_Stock_Price:  101.54189470251025
curr_Factors:  [101.5418947]
mat_Sqrt:  [[0.15]]
grads:  [-0.00105089]
Stock Position:  -0.0010508886350474775
Bond Position:  [2.70143322]


portfolio before change:  [2.59557884]
curr_Stock_Price:  100.88911197295349
curr_Factors:  [100.88911197]
mat_Sqrt:  [[0.15]]
grads:  [0.50869098]
Stock Position:  0.5086909816332984
Bond Position:  [-48.72580256]


portfolio before change:  [2.59940275]
curr_Stock_Price:  100.9026159837612
curr_Factors:  [100.90261598]
mat_Sqrt:  [[0.15]]
grads:  [-0.08770301]
Stock Position:  -0.08770300855983118
Bond Position:  [11.44886575]


portfolio before change:  [2.63576937]
curr_Stock_Price:  100.4961186938962
curr_Factors:  [100.49611869]
mat_Sqrt:  [[0.15]]
grads:  [0.00017068]
Stock Position:  0.00017068357142128085
Bond Position:  [2.61861633]


portfolio before change:  [2.636072]
curr_Stock_Price:  101.31031654876772
curr_Factors:  [101.31031655]
mat_Sqrt:  [[0.15]]
grads:  [0.00026515]
Stock Position:  0.00026515243249151683
Bond Position:  [2.60920933]


portfolio before change:  [2.63620073]
curr_Stock_Price:  101.18075048221822
curr_Factors:  [101.18075048]
mat_Sqrt:  [[0.15]]
grads:  [0.10244987]
Stock Position:  0.10244987394227155
Bond Position:  [-7.7297544]


portfolio before change:  [2.65763558]
curr_Stock_Price:  101.39468898888809
curr_Factors:  [101.39468899]
mat_Sqrt:  [[0.15]]
grads:  [0.06753371]
Stock Position:  0.06753370713970984
Bond Position:  [-4.18992365]


portfolio before change:  [2.72330041]
curr_Stock_Price:  102.37089349087634
curr_Factors:  [102.37089349]
mat_Sqrt:  [[0.15]]
grads:  [0.06933216]
Stock Position:  0.069332161406737
Bond Position:  [-4.3742949]


portfolio before change:  [2.69328663]
curr_Stock_Price:  101.94193852826916
curr_Factors:  [101.94193853]
mat_Sqrt:  [[0.15]]
grads:  [0.04816502]
Stock Position:  0.04816501945866958
Bond Position:  [-2.21674882]


portfolio before change:  [2.73963771]
curr_Stock_Price:  102.90715422496342
curr_Factors:  [102.90715422]
mat_Sqrt:  [[0.15]]
grads:  [0.04390562]
Stock Position:  0.04390561812096755
Bond Position:  [-1.7785645]


portfolio before change:  [2.67219846]
curr_Stock_Price:  101.37368087723311
curr_Factors:  [101.37368088]
mat_Sqrt:  [[0.15]]
grads:  [-0.16951222]
Stock Position:  -0.16951221991180931
Bond Position:  [19.85627614]


portfolio before change:  [2.92709362]
curr_Stock_Price:  99.87730434321918
curr_Factors:  [99.87730434]
mat_Sqrt:  [[0.15]]
grads:  [-0.02933826]
Stock Position:  -0.02933825963332744
Bond Position:  [5.85731991]


portfolio before change:  [2.92346004]
curr_Stock_Price:  100.0136338312349
curr_Factors:  [100.01363383]
mat_Sqrt:  [[0.15]]
grads:  [0.02634658]
Stock Position:  0.0263465845099715
Bond Position:  [0.28844239]


portfolio before change:  [2.91917245]
curr_Stock_Price:  99.8502113976482
curr_Factors:  [99.8502114]
mat_Sqrt:  [[0.15]]
grads:  [0.09916944]
Stock Position:  0.09916943776149888
Bond Position:  [-6.98291688]


portfolio before change:  [2.85495215]
curr_Stock_Price:  99.20703090585708
curr_Factors:  [99.20703091]
mat_Sqrt:  [[0.15]]
grads:  [0.13144741]
Stock Position:  0.1314474124055347
Bond Position:  [-10.18555535]


portfolio before change:  [2.74122361]
curr_Stock_Price:  98.34667219947023
curr_Factors:  [98.3466722]
mat_Sqrt:  [[0.15]]
grads:  [-0.1114789]
Stock Position:  -0.1114788970055859
Bond Position:  [13.70480215]


portfolio before change:  [2.7685954]
curr_Stock_Price:  98.10882263673514
curr_Factors:  [98.10882264]
mat_Sqrt:  [[0.15]]
grads:  [0.04655401]
Stock Position:  0.04655400985315572
Bond Position:  [-1.7987637]


portfolio before change:  [2.76820608]
curr_Stock_Price:  98.10287497902189
curr_Factors:  [98.10287498]
mat_Sqrt:  [[0.15]]
grads:  [-0.01700432]
Stock Position:  -0.017004320876353243
Bond Position:  [4.43637885]


portfolio before change:  [2.76441462]
curr_Stock_Price:  98.34215204415298
curr_Factors:  [98.34215204]
mat_Sqrt:  [[0.15]]
grads:  [0.0548408]
Stock Position:  0.054840804042996794
Bond Position:  [-2.62874807]


portfolio before change:  [2.75497115]
curr_Stock_Price:  98.1729500879258
curr_Factors:  [98.17295009]
mat_Sqrt:  [[0.15]]
grads:  [0.02268536]
Stock Position:  0.022685361314572286
Bond Position:  [0.5278823]


portfolio before change:  [2.74600704]
curr_Stock_Price:  97.77634631031738
curr_Factors:  [97.77634631]
mat_Sqrt:  [[0.15]]
grads:  [-0.10157145]
Stock Position:  -0.1015714517693809
Bond Position:  [12.67729248]


portfolio before change:  [2.77924798]
curr_Stock_Price:  97.45688069753326
curr_Factors:  [97.4568807]
mat_Sqrt:  [[0.15]]
grads:  [0.25481794]
Stock Position:  0.254817940774176
Bond Position:  [-22.05451367]


portfolio before change:  [2.77874312]
curr_Stock_Price:  97.46030898647477
curr_Factors:  [97.46030899]
mat_Sqrt:  [[0.15]]
grads:  [-0.0023545]
Stock Position:  -0.0023545003954313893
Bond Position:  [3.00821346]


portfolio before change:  [2.77869516]
curr_Stock_Price:  97.56053418524853
curr_Factors:  [97.56053419]
mat_Sqrt:  [[0.15]]
grads:  [0.03506442]
Stock Position:  0.03506442444651654
Bond Position:  [-0.64220882]


portfolio before change:  [2.75441708]
curr_Stock_Price:  96.86929393643344
curr_Factors:  [96.86929394]
mat_Sqrt:  [[0.15]]
grads:  [-0.06011479]
Stock Position:  -0.060114790257607305
Bond Position:  [8.57769437]


portfolio before change:  [2.80633528]
curr_Stock_Price:  96.01456120776294
curr_Factors:  [96.01456121]
mat_Sqrt:  [[0.15]]
grads:  [-0.01052958]
Stock Position:  -0.010529575929676281
Bond Position:  [3.81732789]


portfolio before change:  [2.80224207]
curr_Stock_Price:  96.42595487037127
curr_Factors:  [96.42595487]
mat_Sqrt:  [[0.15]]
grads:  [-0.06743972]
Stock Position:  -0.06743972102839743
Bond Position:  [9.30518157]


portfolio before change:  [2.79750673]
curr_Stock_Price:  96.5047946470903
curr_Factors:  [96.50479465]
mat_Sqrt:  [[0.15]]
grads:  [-0.0892764]
Stock Position:  -0.08927640137778144
Bond Position:  [11.41310751]


portfolio before change:  [2.81443237]
curr_Stock_Price:  96.32319802028856
curr_Factors:  [96.32319802]
mat_Sqrt:  [[0.15]]
grads:  [0.00215329]
Stock Position:  0.0021532925845053146
Bond Position:  [2.60702034]


portfolio before change:  [2.81588956]
curr_Stock_Price:  96.92425370993337
curr_Factors:  [96.92425371]
mat_Sqrt:  [[0.15]]
grads:  [-0.01859436]
Stock Position:  -0.018594356783251977
Bond Position:  [4.61813371]


portfolio before change:  [2.81503561]
curr_Stock_Price:  96.98570184356434
curr_Factors:  [96.98570184]
mat_Sqrt:  [[0.15]]
grads:  [0.00698639]
Stock Position:  0.006986389323954285
Bond Position:  [2.13745574]


portfolio before change:  [2.81676199]
curr_Stock_Price:  97.21368600695119
curr_Factors:  [97.21368601]
mat_Sqrt:  [[0.15]]
grads:  [-0.02373774]
Stock Position:  -0.023737735012129765
Bond Position:  [5.12439471]


portfolio before change:  [2.82046886]
curr_Stock_Price:  97.07101921180318
curr_Factors:  [97.07101921]
mat_Sqrt:  [[0.15]]
grads:  [0.01984069]
Stock Position:  0.019840689760967114
Bond Position:  [0.89451289]


portfolio before change:  [2.79953484]
curr_Stock_Price:  96.01309572654225
curr_Factors:  [96.01309573]
mat_Sqrt:  [[0.15]]
grads:  [0.02420861]
Stock Position:  0.024208613880803607
Bond Position:  [0.47519088]


portfolio before change:  [2.79495396]
curr_Stock_Price:  95.82264366873206
curr_Factors:  [95.82264367]
mat_Sqrt:  [[0.15]]
grads:  [-0.00460224]
Stock Position:  -0.004602244409644138
Bond Position:  [3.23595319]


portfolio before change:  [2.7984536]
curr_Stock_Price:  95.10617091117817
curr_Factors:  [95.10617091]
mat_Sqrt:  [[0.15]]
grads:  [0.08879671]
Stock Position:  0.08879670649563899
Bond Position:  [-5.64666115]


portfolio before change:  [2.80422435]
curr_Stock_Price:  95.17513381187918
curr_Factors:  [95.17513381]
mat_Sqrt:  [[0.15]]
grads:  [0.05943023]
Stock Position:  0.059430226688287985
Bond Position:  [-2.85205543]


portfolio before change:  [2.77691846]
curr_Stock_Price:  94.71867192602605
curr_Factors:  [94.71867193]
mat_Sqrt:  [[0.15]]
grads:  [0.01696894]
Stock Position:  0.01696893893992606
Bond Position:  [1.1696431]


portfolio before change:  [2.78049898]
curr_Stock_Price:  94.92536810339469
curr_Factors:  [94.9253681]
mat_Sqrt:  [[0.15]]
grads:  [0.07932856]
Stock Position:  0.0793285606795711
Bond Position:  [-4.74979385]


portfolio before change:  [2.74217898]
curr_Stock_Price:  94.4460561272237
curr_Factors:  [94.44605613]
mat_Sqrt:  [[0.15]]
grads:  [0.08695446]
Stock Position:  0.08695446103469304
Bond Position:  [-5.47032693]


portfolio before change:  [2.8005737]
curr_Stock_Price:  95.12154341274375
curr_Factors:  [95.12154341]
mat_Sqrt:  [[0.15]]
grads:  [-0.03406913]
Stock Position:  -0.03406912834083886
Bond Position:  [6.04128177]


portfolio before change:  [2.80831781]
curr_Stock_Price:  94.90532074735893
curr_Factors:  [94.90532075]
mat_Sqrt:  [[0.15]]
grads:  [-0.03786277]
Stock Position:  -0.037862768921647125
Bond Position:  [6.40169604]


portfolio before change:  [2.79987702]
curr_Stock_Price:  95.13881961033371
curr_Factors:  [95.13881961]
mat_Sqrt:  [[0.15]]
grads:  [-0.17780955]
Stock Position:  -0.1778095521494891
Bond Position:  [19.71646792]


portfolio before change:  [2.75159337]
curr_Stock_Price:  95.41729711893319
curr_Factors:  [95.41729712]
mat_Sqrt:  [[0.15]]
grads:  [-0.0857052]
Stock Position:  -0.0857051980625043
Bond Position:  [10.92935172]


portfolio before change:  [2.71814178]
curr_Stock_Price:  95.81557754706061
curr_Factors:  [95.81557755]
mat_Sqrt:  [[0.15]]
grads:  [-0.01564678]
Stock Position:  -0.015646781007871768
Bond Position:  [4.21734714]


portfolio before change:  [2.71876436]
curr_Stock_Price:  95.79263387682565
curr_Factors:  [95.79263388]
mat_Sqrt:  [[0.15]]
grads:  [-0.05231588]
Stock Position:  -0.052315877008436526
Bond Position:  [7.73024002]


portfolio before change:  [2.70894861]
curr_Stock_Price:  95.98949397417961
curr_Factors:  [95.98949397]
mat_Sqrt:  [[0.15]]
grads:  [0.0315003]
Stock Position:  0.031500299024518216
Bond Position:  [-0.31474915]


portfolio before change:  [2.71459673]
curr_Stock_Price:  96.16942207914623
curr_Factors:  [96.16942208]
mat_Sqrt:  [[0.15]]
grads:  [0.06008941]
Stock Position:  0.06008940790708456
Bond Position:  [-3.0641669]


portfolio before change:  [2.63437672]
curr_Stock_Price:  94.83759847918569
curr_Factors:  [94.83759848]
mat_Sqrt:  [[0.15]]
grads:  [0.01157093]
Stock Position:  0.011570930929341272
Bond Position:  [1.53701742]


portfolio before change:  [2.63602091]
curr_Stock_Price:  94.97139255971615
curr_Factors:  [94.97139256]
mat_Sqrt:  [[0.15]]
grads:  [0.09682528]
Stock Position:  0.09682528105988523
Bond Position:  [-6.55961087]


portfolio before change:  [2.61533489]
curr_Stock_Price:  94.76198417759203
curr_Factors:  [94.76198418]
mat_Sqrt:  [[0.15]]
grads:  [-0.13063409]
Stock Position:  -0.13063408949622052
Bond Position:  [14.99448042]


portfolio before change:  [2.60196355]
curr_Stock_Price:  94.87151555214672
curr_Factors:  [94.87151555]
mat_Sqrt:  [[0.15]]
grads:  [0.12460305]
Stock Position:  0.12460305243317911
Bond Position:  [-9.21931688]


portfolio before change:  [2.70904453]
curr_Stock_Price:  95.73551690664772
curr_Factors:  [95.73551691]
mat_Sqrt:  [[0.15]]
grads:  [-0.03941263]
Stock Position:  -0.03941263327274808
Bond Position:  [6.48223335]


portfolio before change:  [2.6905221]
curr_Stock_Price:  96.2157582270028
curr_Factors:  [96.21575823]
mat_Sqrt:  [[0.15]]
grads:  [-0.01449768]
Stock Position:  -0.014497681945334889
Bond Position:  [4.08542757]


portfolio before change:  [2.69382475]
curr_Stock_Price:  96.00556584753578
curr_Factors:  [96.00556585]
mat_Sqrt:  [[0.15]]
grads:  [0.05096537]
Stock Position:  0.05096536816708529
Bond Position:  [-2.19913426]


portfolio before change:  [2.70578339]
curr_Stock_Price:  96.24290514086476
curr_Factors:  [96.24290514]
mat_Sqrt:  [[0.15]]
grads:  [-0.01880181]
Stock Position:  -0.018801806287597884
Bond Position:  [4.51532385]


portfolio before change:  [2.69315092]
curr_Stock_Price:  96.92979060980811
curr_Factors:  [96.92979061]
mat_Sqrt:  [[0.15]]
grads:  [0.01769694]
Stock Position:  0.017696944029342243
Bond Position:  [0.97778984]


portfolio before change:  [2.69989075]
curr_Stock_Price:  97.3071844940871
curr_Factors:  [97.30718449]
mat_Sqrt:  [[0.15]]
grads:  [0.01453064]
Stock Position:  0.014530639111016534
Bond Position:  [1.28595517]


portfolio before change:  [2.70673371]
curr_Stock_Price:  97.77258607352097
curr_Factors:  [97.77258607]
mat_Sqrt:  [[0.15]]
grads:  [-0.07096354]
Stock Position:  -0.07096353780431161
Bond Position:  [9.64502231]


portfolio before change:  [2.72829215]
curr_Stock_Price:  97.47728494476674
curr_Factors:  [97.47728494]
mat_Sqrt:  [[0.15]]
grads:  [-0.14175894]
Stock Position:  -0.14175894154169974
Bond Position:  [16.54656889]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.72829215]
Stock Price:  97.8841660540688
PL:  [2.72829215]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-7.89269827e-02]
 [ 2.95998066e-03]
 [ 1.58582965e-02]
 [ 4.00820053e-03]
 [-8.19096470e-03]
 [ 1.23064933e-02]
 [-3.81721784e-04]
 [ 6.53061037e-03]
 [-6.10131480e-03]
 [-2.02045087e-02]
 [ 1.02038871e-02]
 [-5.13019381e-03]
 [-5.91611526e-03]
 [ 4.63994166e-03]
 [-2.21176915e-02]
 [ 1.67874255e-02]
 [-3.22018005e-03]
 [-5.61472551e-03]
 [-1.81604978e-02]
 [ 1.44481869e-02]
 [-4.26153620e-02]
 [-3.00224510e-02]
 [ 1.18277394e-03]
 [ 4.47890184e-04]
 [-7.63875835e-03]
 [ 1.60424701e-02]
 [ 1.72707961e-02]
 [ 6.60934800e-03]
 [ 3.63069448e-04]
 [-9.76316212e-04]
 [-3.42326173e-03]
 [-2.48703356e-02]
 [ 1.88683095e-02]
 [ 9.59114003e-03]
 [-2.04637692e-02]
 [ 7.45637996e-03]
 [-2.33004497e-03]
 [ 4.01448906e-03]
 [ 5.42637570e-03]
 [-1.56186626e-02]
 [ 2.22680211e-02]
 [-1.57358559e-03]
 [ 3.40086890e-03]
 [-7.80605038e-03]
 [ 2.26984143e-03]
 [-3.54138440e-03]
 [-1.36989151e-02]
 [-7.65738252e-04]
 [-3.57658657e-03]
 [ 3.62284552e-03]
 [-3.31110664e-03]
 [ 3.12373388e-03]
 [ 3.10160287e-03]
 [ 2.13153465e-03]
 [ 2.22725665e-03]
 [ 9.01922530e-03]
 [ 1.28124211e-02]
 [ 7.74483209e-04]
 [ 1.35301977e-02]
 [-2.54834194e-03]
 [-2.91887320e-03]
 [-1.94307350e-02]
 [-1.28117771e-02]
 [-1.89208176e-03]
 [-9.16174232e-03]
 [-1.21106989e-02]
 [ 1.05275669e-02]
 [ 2.28004664e-03]
 [ 1.00777474e-02]
 [-1.77523092e-02]
 [ 8.33738504e-03]
 [ 1.77820857e-03]
 [-5.56038595e-04]
 [ 8.25625878e-03]
 [-8.45447186e-04]
 [ 6.74861986e-04]
 [-3.97897029e-03]
 [-9.44425001e-03]
 [-2.36156599e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.05718589]
curr_Stock_Price:  100.8349233295248
curr_Factors:  [100.83492333]
mat_Sqrt:  [[0.15]]
grads:  [-0.52617988]
Stock Position:  -0.5261798846660769
Bond Position:  [68.11449422]


portfolio before change:  [14.75519281]
curr_Stock_Price:  101.41694931828677
curr_Factors:  [101.41694932]
mat_Sqrt:  [[0.15]]
grads:  [0.0197332]
Stock Position:  0.01973320437366386
Bond Position:  [12.75391143]


portfolio before change:  [14.77021704]
curr_Stock_Price:  102.13792088450256
curr_Factors:  [102.13792088]
mat_Sqrt:  [[0.15]]
grads:  [0.10572198]
Stock Position:  0.10572197668033723
Bond Position:  [3.97199415]


portfolio before change:  [14.82885776]
curr_Stock_Price:  102.69024186269456
curr_Factors:  [102.69024186]
mat_Sqrt:  [[0.15]]
grads:  [0.02672134]
Stock Position:  0.026721336858909865
Bond Position:  [12.08483722]


portfolio before change:  [14.82925892]
curr_Stock_Price:  102.67698795268429
curr_Factors:  [102.67698795]
mat_Sqrt:  [[0.15]]
grads:  [-0.05460643]
Stock Position:  -0.05460643136586423
Bond Position:  [20.43608282]


portfolio before change:  [14.85771027]
curr_Stock_Price:  102.1793533288674
curr_Factors:  [102.17935333]
mat_Sqrt:  [[0.15]]
grads:  [0.08204329]
Stock Position:  0.08204328864650055
Bond Position:  [6.47458009]


portfolio before change:  [14.83312142]
curr_Stock_Price:  101.87471500972303
curr_Factors:  [101.87471501]
mat_Sqrt:  [[0.15]]
grads:  [-0.00254481]
Stock Position:  -0.0025448118941873658
Bond Position:  [15.0923734]


portfolio before change:  [14.83444577]
curr_Stock_Price:  101.72497873519629
curr_Factors:  [101.72497874]
mat_Sqrt:  [[0.15]]
grads:  [0.0435374]
Stock Position:  0.04353740243870165
Bond Position:  [10.40560443]


portfolio before change:  [14.82063711]
curr_Stock_Price:  101.39287280931352
curr_Factors:  [101.39287281]
mat_Sqrt:  [[0.15]]
grads:  [-0.04067543]
Stock Position:  -0.040675431998029844
Bond Position:  [18.94483601]


portfolio before change:  [14.86037481]
curr_Stock_Price:  100.44503756817541
curr_Factors:  [100.44503757]
mat_Sqrt:  [[0.15]]
grads:  [-0.13469672]
Stock Position:  -0.13469672491089543
Bond Position:  [28.3899924]


portfolio before change:  [14.86591819]
curr_Stock_Price:  100.41705654714599
curr_Factors:  [100.41705655]
mat_Sqrt:  [[0.15]]
grads:  [0.06802591]
Stock Position:  0.06802591414495053
Bond Position:  [8.03495612]


portfolio before change:  [14.81883652]
curr_Stock_Price:  99.71756035498474
curr_Factors:  [99.71756035]
mat_Sqrt:  [[0.15]]
grads:  [-0.03420129]
Stock Position:  -0.03420129207592394
Bond Position:  [18.22930593]


portfolio before change:  [14.84045328]
curr_Stock_Price:  99.1188288329404
curr_Factors:  [99.11882883]
mat_Sqrt:  [[0.15]]
grads:  [-0.03944077]
Stock Position:  -0.039440768376311636
Bond Position:  [18.74977605]


portfolio before change:  [14.88269204]
curr_Stock_Price:  98.07760002035172
curr_Factors:  [98.07760002]
mat_Sqrt:  [[0.15]]
grads:  [0.03093294]
Stock Position:  0.03093294436907417
Bond Position:  [11.8488631]


portfolio before change:  [14.8699173]
curr_Stock_Price:  97.64067678007696
curr_Factors:  [97.64067678]
mat_Sqrt:  [[0.15]]
grads:  [-0.14745128]
Stock Position:  -0.1474512767769277
Bond Position:  [29.26715975]


portfolio before change:  [14.88816275]
curr_Stock_Price:  97.52934375245961
curr_Factors:  [97.52934375]
mat_Sqrt:  [[0.15]]
grads:  [0.11191617]
Stock Position:  0.11191617027993107
Bond Position:  [3.97305211]


portfolio before change:  [14.91436925]
curr_Stock_Price:  97.76128680306584
curr_Factors:  [97.7612868]
mat_Sqrt:  [[0.15]]
grads:  [-0.02146787]
Stock Position:  -0.02146786701103444
Bond Position:  [17.01309555]


portfolio before change:  [14.92738352]
curr_Stock_Price:  97.20459809646906
curr_Factors:  [97.2045981]
mat_Sqrt:  [[0.15]]
grads:  [-0.0374315]
Stock Position:  -0.03743150337392392
Bond Position:  [18.56589776]


portfolio before change:  [14.93713937]
curr_Stock_Price:  96.97496678797665
curr_Factors:  [96.97496679]
mat_Sqrt:  [[0.15]]
grads:  [-0.12106999]
Stock Position:  -0.12106998503161065
Bond Position:  [26.67789715]


portfolio before change:  [14.89142965]
curr_Stock_Price:  97.36628706528226
curr_Factors:  [97.36628707]
mat_Sqrt:  [[0.15]]
grads:  [0.09632125]
Stock Position:  0.09632124581663512
Bond Position:  [5.51298758]


portfolio before change:  [14.84703388]
curr_Stock_Price:  96.90179613371158
curr_Factors:  [96.90179613]
mat_Sqrt:  [[0.15]]
grads:  [-0.28410241]
Stock Position:  -0.28410241338002235
Bond Position:  [42.37706802]


portfolio before change:  [14.99196625]
curr_Stock_Price:  96.40097771910149
curr_Factors:  [96.40097772]
mat_Sqrt:  [[0.15]]
grads:  [-0.20014967]
Stock Position:  -0.20014967324858843
Bond Position:  [34.28659044]


portfolio before change:  [14.97189854]
curr_Stock_Price:  96.5119481034024
curr_Factors:  [96.5119481]
mat_Sqrt:  [[0.15]]
grads:  [0.00788516]
Stock Position:  0.007885159598492794
Bond Position:  [14.21088643]


portfolio before change:  [14.97282488]
curr_Stock_Price:  96.51678389483344
curr_Factors:  [96.51678389]
mat_Sqrt:  [[0.15]]
grads:  [0.00298593]
Stock Position:  0.0029859345612352735
Bond Position:  [14.68463208]


portfolio before change:  [14.97191124]
curr_Stock_Price:  95.90342265661403
curr_Factors:  [95.90342266]
mat_Sqrt:  [[0.15]]
grads:  [-0.05092506]
Stock Position:  -0.05092505568747167
Bond Position:  [19.85579838]


portfolio before change:  [15.01857231]
curr_Stock_Price:  95.01152296979187
curr_Factors:  [95.01152297]
mat_Sqrt:  [[0.15]]
grads:  [0.1069498]
Stock Position:  0.10694980078073883
Bond Position:  [4.85710886]


portfolio before change:  [15.18733746]
curr_Stock_Price:  96.58666918134104
curr_Factors:  [96.58666918]
mat_Sqrt:  [[0.15]]
grads:  [0.11513864]
Stock Position:  0.1151386408413264
Bond Position:  [4.06647965]


portfolio before change:  [15.22560083]
curr_Stock_Price:  96.91678606174503
curr_Factors:  [96.91678606]
mat_Sqrt:  [[0.15]]
grads:  [0.04406232]
Stock Position:  0.04406232001209998
Bond Position:  [10.95522239]


portfolio before change:  [15.20689013]
curr_Stock_Price:  96.47660446301404
curr_Factors:  [96.47660446]
mat_Sqrt:  [[0.15]]
grads:  [0.00242046]
Stock Position:  0.002420462987315305
Bond Position:  [14.97337208]


portfolio before change:  [15.20977425]
curr_Stock_Price:  97.28151414973598
curr_Factors:  [97.28151415]
mat_Sqrt:  [[0.15]]
grads:  [-0.00650877]
Stock Position:  -0.006508774749063202
Bond Position:  [15.84295772]


portfolio before change:  [15.21489783]
curr_Stock_Price:  96.64647009435545
curr_Factors:  [96.64647009]
mat_Sqrt:  [[0.15]]
grads:  [-0.02282174]
Stock Position:  -0.0228217448684926
Bond Position:  [17.42053891]


portfolio before change:  [15.21339547]
curr_Stock_Price:  96.760009662984
curr_Factors:  [96.76000966]
mat_Sqrt:  [[0.15]]
grads:  [-0.16580224]
Stock Position:  -0.1658022374341732
Bond Position:  [31.25642157]


portfolio before change:  [15.07930937]
curr_Stock_Price:  97.58050336454512
curr_Factors:  [97.58050336]
mat_Sqrt:  [[0.15]]
grads:  [0.12578873]
Stock Position:  0.12578872985384798
Bond Position:  [2.80478179]


portfolio before change:  [15.02404149]
curr_Stock_Price:  97.13973901924413
curr_Factors:  [97.13973902]
mat_Sqrt:  [[0.15]]
grads:  [0.06394093]
Stock Position:  0.06394093356624778
Bond Position:  [8.81283589]


portfolio before change:  [15.06013788]
curr_Stock_Price:  97.69565158531051
curr_Factors:  [97.69565159]
mat_Sqrt:  [[0.15]]
grads:  [-0.13642513]
Stock Position:  -0.13642512810929946
Bond Position:  [28.38827966]


portfolio before change:  [15.04224733]
curr_Stock_Price:  97.83979559534401
curr_Factors:  [97.8397956]
mat_Sqrt:  [[0.15]]
grads:  [0.0497092]
Stock Position:  0.04970919970382537
Bond Position:  [10.1787094]


portfolio before change:  [15.08733093]
curr_Stock_Price:  98.73394407869414
curr_Factors:  [98.73394408]
mat_Sqrt:  [[0.15]]
grads:  [-0.01553363]
Stock Position:  -0.015533633164507612
Bond Position:  [16.6210278]


portfolio before change:  [15.10491821]
curr_Stock_Price:  97.66861461891479
curr_Factors:  [97.66861462]
mat_Sqrt:  [[0.15]]
grads:  [0.02676326]
Stock Position:  0.02676326037925729
Bond Position:  [12.49098765]


portfolio before change:  [15.08765277]
curr_Stock_Price:  96.99432628575386
curr_Factors:  [96.99432629]
mat_Sqrt:  [[0.15]]
grads:  [0.03617584]
Stock Position:  0.036175837996583256
Bond Position:  [11.57880173]


portfolio before change:  [15.10536088]
curr_Stock_Price:  97.4638222767632
curr_Factors:  [97.46382228]
mat_Sqrt:  [[0.15]]
grads:  [-0.10412442]
Stock Position:  -0.10412441700113066
Bond Position:  [25.25372455]


portfolio before change:  [15.01944951]
curr_Stock_Price:  98.30406486917313
curr_Factors:  [98.30406487]
mat_Sqrt:  [[0.15]]
grads:  [0.14845347]
Stock Position:  0.148453473689166
Bond Position:  [0.42586961]


portfolio before change:  [15.03861225]
curr_Stock_Price:  98.43296798817524
curr_Factors:  [98.43296799]
mat_Sqrt:  [[0.15]]
grads:  [-0.01049057]
Stock Position:  -0.010490570584751446
Bond Position:  [16.07123025]


portfolio before change:  [15.03899615]
curr_Stock_Price:  98.49212383554035
curr_Factors:  [98.49212384]
mat_Sqrt:  [[0.15]]
grads:  [0.02267246]
Stock Position:  0.022672459332387058
Bond Position:  [12.80593748]


portfolio before change:  [15.0429372]
curr_Stock_Price:  98.63064644856807
curr_Factors:  [98.63064645]
mat_Sqrt:  [[0.15]]
grads:  [-0.05204034]
Stock Position:  -0.05204033589096848
Bond Position:  [20.17570917]


portfolio before change:  [15.02870957]
curr_Stock_Price:  98.92827415948045
curr_Factors:  [98.92827416]
mat_Sqrt:  [[0.15]]
grads:  [0.01513228]
Stock Position:  0.015132276206204632
Bond Position:  [13.5316996]


portfolio before change:  [15.02467245]
curr_Stock_Price:  98.60559453812544
curr_Factors:  [98.60559454]
mat_Sqrt:  [[0.15]]
grads:  [-0.02360923]
Stock Position:  -0.023609229315964226
Bond Position:  [17.35267455]


portfolio before change:  [15.03136721]
curr_Stock_Price:  98.36796778729908
curr_Factors:  [98.36796779]
mat_Sqrt:  [[0.15]]
grads:  [-0.0913261]
Stock Position:  -0.09132610074126148
Bond Position:  [24.01493015]


portfolio before change:  [15.11189218]
curr_Stock_Price:  97.50267310648505
curr_Factors:  [97.50267311]
mat_Sqrt:  [[0.15]]
grads:  [-0.00510492]
Stock Position:  -0.005104921680421047
Bond Position:  [15.60963569]


portfolio before change:  [15.11442162]
curr_Stock_Price:  97.19829865657603
curr_Factors:  [97.19829866]
mat_Sqrt:  [[0.15]]
grads:  [-0.02384391]
Stock Position:  -0.023843910471025295
Bond Position:  [17.43200915]


portfolio before change:  [15.10913755]
curr_Stock_Price:  97.46560418343945
curr_Factors:  [97.46560418]
mat_Sqrt:  [[0.15]]
grads:  [0.0241523]
Stock Position:  0.02415230345830644
Bond Position:  [12.7551187]


portfolio before change:  [15.11996414]
curr_Stock_Price:  97.8808596616982
curr_Factors:  [97.88085966]
mat_Sqrt:  [[0.15]]
grads:  [-0.02207404]
Stock Position:  -0.022074044235136467
Bond Position:  [17.28059057]


portfolio before change:  [15.1176187]
curr_Stock_Price:  98.03604269314341
curr_Factors:  [98.03604269]
mat_Sqrt:  [[0.15]]
grads:  [0.02082489]
Stock Position:  0.020824892522364725
Bond Position:  [13.07602865]


portfolio before change:  [15.11841886]
curr_Stock_Price:  98.0352209788801
curr_Factors:  [98.03522098]
mat_Sqrt:  [[0.15]]
grads:  [0.02067735]
Stock Position:  0.02067735248899545
Bond Position:  [13.09131004]


portfolio before change:  [15.11101753]
curr_Stock_Price:  97.63770551251375
curr_Factors:  [97.63770551]
mat_Sqrt:  [[0.15]]
grads:  [0.01421023]
Stock Position:  0.014210230986571705
Bond Position:  [13.72356318]


portfolio before change:  [15.11908127]
curr_Stock_Price:  98.1448045520897
curr_Factors:  [98.14480455]
mat_Sqrt:  [[0.15]]
grads:  [0.01484838]
Stock Position:  0.014848377687833581
Bond Position:  [13.66179015]


portfolio before change:  [15.12597745]
curr_Stock_Price:  98.55173726652913
curr_Factors:  [98.55173727]
mat_Sqrt:  [[0.15]]
grads:  [0.06012817]
Stock Position:  0.06012816868831146
Bond Position:  [9.20024197]


portfolio before change:  [15.07280727]
curr_Stock_Price:  97.65789310289347
curr_Factors:  [97.6578931]
mat_Sqrt:  [[0.15]]
grads:  [0.08541614]
Stock Position:  0.08541614087234253
Bond Position:  [6.73124692]


portfolio before change:  [15.05335969]
curr_Stock_Price:  97.42528718014924
curr_Factors:  [97.42528718]
mat_Sqrt:  [[0.15]]
grads:  [0.00516322]
Stock Position:  0.005163221396246009
Bond Position:  [14.55033136]


portfolio before change:  [15.05159675]
curr_Stock_Price:  96.90771144679474
curr_Factors:  [96.90771145]
mat_Sqrt:  [[0.15]]
grads:  [0.09020132]
Stock Position:  0.09020131787665099
Bond Position:  [6.31039347]


portfolio before change:  [14.99973316]
curr_Stock_Price:  96.3283628996144
curr_Factors:  [96.3283629]
mat_Sqrt:  [[0.15]]
grads:  [-0.01698895]
Stock Position:  -0.01698894625170759
Bond Position:  [16.63625054]


portfolio before change:  [15.00909902]
curr_Stock_Price:  95.83827626390614
curr_Factors:  [95.83827626]
mat_Sqrt:  [[0.15]]
grads:  [-0.01945915]
Stock Position:  -0.01945915464131088
Bond Position:  [16.87403086]


portfolio before change:  [14.99682445]
curr_Stock_Price:  96.5232610010693
curr_Factors:  [96.523261]
mat_Sqrt:  [[0.15]]
grads:  [-0.12953823]
Stock Position:  -0.12953823320189667
Bond Position:  [27.50027715]


portfolio before change:  [15.05987408]
curr_Stock_Price:  96.04980380635907
curr_Factors:  [96.04980381]
mat_Sqrt:  [[0.15]]
grads:  [-0.08541185]
Stock Position:  -0.08541184717530306
Bond Position:  [23.26366525]


portfolio before change:  [15.03134391]
curr_Stock_Price:  96.40085815313631
curr_Factors:  [96.40085815]
mat_Sqrt:  [[0.15]]
grads:  [-0.01261388]
Stock Position:  -0.012613878373909553
Bond Position:  [16.24733261]


portfolio before change:  [15.0276816]
curr_Stock_Price:  96.77170300217513
curr_Factors:  [96.771703]
mat_Sqrt:  [[0.15]]
grads:  [-0.06107828]
Stock Position:  -0.06107828211094927
Bond Position:  [20.93833098]


portfolio before change:  [15.02147141]
curr_Stock_Price:  96.89480538808984
curr_Factors:  [96.89480539]
mat_Sqrt:  [[0.15]]
grads:  [-0.08073799]
Stock Position:  -0.08073799253243001
Bond Position:  [22.84456348]


portfolio before change:  [14.94033967]
curr_Stock_Price:  97.91736691197508
curr_Factors:  [97.91736691]
mat_Sqrt:  [[0.15]]
grads:  [0.07018378]
Stock Position:  0.07018377925054843
Bond Position:  [8.06812881]


portfolio before change:  [14.92046611]
curr_Stock_Price:  97.62701724556878
curr_Factors:  [97.62701725]
mat_Sqrt:  [[0.15]]
grads:  [0.01520031]
Stock Position:  0.01520031091692799
Bond Position:  [13.4365051]


portfolio before change:  [14.92381267]
curr_Stock_Price:  97.79193166384731
curr_Factors:  [97.79193166]
mat_Sqrt:  [[0.15]]
grads:  [0.06718498]
Stock Position:  0.06718498255833114
Bond Position:  [8.35366345]


portfolio before change:  [14.8846661]
curr_Stock_Price:  97.20149184932417
curr_Factors:  [97.20149185]
mat_Sqrt:  [[0.15]]
grads:  [-0.11834873]
Stock Position:  -0.11834872827418921
Bond Position:  [26.38833905]


portfolio before change:  [14.92847814]
curr_Stock_Price:  96.84523351656144
curr_Factors:  [96.84523352]
mat_Sqrt:  [[0.15]]
grads:  [0.05558257]
Stock Position:  0.0555825669527042
Bond Position:  [9.54557147]


portfolio before change:  [14.95793976]
curr_Stock_Price:  97.36455103124445
curr_Factors:  [97.36455103]
mat_Sqrt:  [[0.15]]
grads:  [0.01185472]
Stock Position:  0.011854723816996753
Bond Position:  [13.8037099]


portfolio before change:  [14.95827056]
curr_Stock_Price:  97.31967806841024
curr_Factors:  [97.31967807]
mat_Sqrt:  [[0.15]]
grads:  [-0.00370692]
Stock Position:  -0.0037069239663772616
Bond Position:  [15.31902721]


portfolio before change:  [14.95832059]
curr_Stock_Price:  97.56447392658197
curr_Factors:  [97.56447393]
mat_Sqrt:  [[0.15]]
grads:  [0.05504173]
Stock Position:  0.0550417252218614
Bond Position:  [9.58820363]


portfolio before change:  [14.92901943]
curr_Stock_Price:  97.02124163080713
curr_Factors:  [97.02124163]
mat_Sqrt:  [[0.15]]
grads:  [-0.00563631]
Stock Position:  -0.005636314576122637
Bond Position:  [15.47586167]


portfolio before change:  [14.92541895]
curr_Stock_Price:  97.83165713447417
curr_Factors:  [97.83165713]
mat_Sqrt:  [[0.15]]
grads:  [0.00449908]
Stock Position:  0.004499079908314124
Bond Position:  [14.4852665]


portfolio before change:  [14.92776455]
curr_Stock_Price:  98.15177614417729
curr_Factors:  [98.15177614]
mat_Sqrt:  [[0.15]]
grads:  [-0.02652647]
Stock Position:  -0.026526468581822504
Bond Position:  [17.53138455]


portfolio before change:  [14.91144052]
curr_Stock_Price:  98.80847002666118
curr_Factors:  [98.80847003]
mat_Sqrt:  [[0.15]]
grads:  [-0.06296167]
Stock Position:  -0.06296166672409331
Bond Position:  [21.13258648]


portfolio before change:  [15.00732308]
curr_Stock_Price:  97.30657636996757
curr_Factors:  [97.30657637]
mat_Sqrt:  [[0.15]]
grads:  [-0.15743773]
Stock Position:  -0.15743773297464853
Bond Position:  [30.32704986]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.00732308]
Stock Price:  97.30834267982141
PL:  [15.00732308]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-5.46243187e-02]
 [-2.15858821e-03]
 [-2.13091243e-04]
 [ 1.23342944e-03]
 [-3.40346029e-04]
 [ 1.12493601e-02]
 [ 4.78492758e-04]
 [ 1.50997409e-02]
 [ 1.73850366e-02]
 [-1.95438228e-02]
 [ 6.81603200e-03]
 [-6.70125584e-03]
 [-3.15565691e-03]
 [ 3.97792735e-03]
 [ 1.06491783e-03]
 [ 3.98027506e-03]
 [ 7.45241616e-03]
 [ 7.99971712e-03]
 [ 2.31013804e-02]
 [ 2.25372408e-03]
 [ 8.03046804e-02]
 [-1.53921048e-02]
 [-9.79429776e-04]
 [ 5.93667437e-03]
 [ 1.38549457e-02]
 [-1.91617525e-03]
 [ 1.24737104e-02]
 [-7.00347179e-05]
 [ 4.32289365e-03]
 [-2.73080013e-02]
 [-5.66266458e-03]
 [ 3.48922080e-02]
 [ 5.78999904e-03]
 [-5.36291697e-03]
 [-6.30515235e-03]
 [-4.50523187e-03]
 [-5.29973901e-03]
 [ 3.05469414e-03]
 [ 2.41243966e-03]
 [-8.54876602e-03]
 [-2.27986348e-02]
 [-2.51790113e-03]
 [ 8.59790397e-03]
 [-1.20754184e-02]
 [-7.50003299e-04]
 [ 2.44457272e-03]
 [-1.36204402e-02]
 [ 5.49644793e-03]
 [ 8.58222069e-03]
 [-1.11158512e-02]
 [-4.34298160e-03]
 [ 3.46328606e-03]
 [ 3.10640616e-03]
 [-1.95844320e-03]
 [-9.63143618e-03]
 [ 1.23530436e-02]
 [-2.83619050e-02]
 [-1.03669420e-02]
 [ 2.04624353e-02]
 [-6.97180199e-03]
 [ 1.31678486e-02]
 [-1.40104303e-02]
 [-1.27184088e-02]
 [-3.01464728e-03]
 [ 2.11911331e-02]
 [-1.82994932e-02]
 [ 1.85755546e-02]
 [ 4.20670365e-03]
 [ 9.99953176e-03]
 [-2.10582833e-02]
 [-7.99935760e-03]
 [-6.20633773e-03]
 [ 1.09358461e-02]
 [ 6.39128381e-03]
 [-7.22560386e-04]
 [-6.52994386e-03]
 [ 7.39799073e-03]
 [-3.83704218e-03]
 [ 2.38572236e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.17290877]
curr_Stock_Price:  100.45673695772632
curr_Factors:  [100.45673696]
mat_Sqrt:  [[0.15]]
grads:  [-0.36416212]
Stock Position:  -0.3641621248397261
Bond Position:  [45.75544756]


portfolio before change:  [9.34136497]
curr_Stock_Price:  100.00200436370832
curr_Factors:  [100.00200436]
mat_Sqrt:  [[0.15]]
grads:  [-0.01439059]
Stock Position:  -0.014390588067847527
Bond Position:  [10.78045262]


portfolio before change:  [9.34924517]
curr_Stock_Price:  99.50123243379261
curr_Factors:  [99.50123243]
mat_Sqrt:  [[0.15]]
grads:  [-0.00142061]
Stock Position:  -0.0014206082853165734
Bond Position:  [9.49059744]


portfolio before change:  [9.34980797]
curr_Stock_Price:  99.52261306420836
curr_Factors:  [99.52261306]
mat_Sqrt:  [[0.15]]
grads:  [0.00822286]
Stock Position:  0.008222862961793724
Bond Position:  [8.53144717]


portfolio before change:  [9.34940682]
curr_Stock_Price:  99.40898085438297
curr_Factors:  [99.40898085]
mat_Sqrt:  [[0.15]]
grads:  [-0.00226897]
Stock Position:  -0.0022689735290677
Bond Position:  [9.57496317]


portfolio before change:  [9.34954411]
curr_Stock_Price:  99.61223004527251
curr_Factors:  [99.61223005]
mat_Sqrt:  [[0.15]]
grads:  [0.07499573]
Stock Position:  0.07499573376078357
Bond Position:  [1.87905183]


portfolio before change:  [9.314658]
curr_Stock_Price:  99.14548940348202
curr_Factors:  [99.1454894]
mat_Sqrt:  [[0.15]]
grads:  [0.00318995]
Stock Position:  0.003189951717893416
Bond Position:  [8.99838867]


portfolio before change:  [9.31465476]
curr_Stock_Price:  98.96816423968909
curr_Factors:  [98.96816424]
mat_Sqrt:  [[0.15]]
grads:  [0.10066494]
Stock Position:  0.10066493943635836
Bond Position:  [-0.6479695]


portfolio before change:  [9.3695053]
curr_Stock_Price:  99.51344881524714
curr_Factors:  [99.51344882]
mat_Sqrt:  [[0.15]]
grads:  [0.11590024]
Stock Position:  0.11590024393538491
Bond Position:  [-2.1641277]


portfolio before change:  [9.34606308]
curr_Stock_Price:  99.3123538777042
curr_Factors:  [99.31235388]
mat_Sqrt:  [[0.15]]
grads:  [-0.13029215]
Stock Position:  -0.13029215218482829
Bond Position:  [22.28568341]


portfolio before change:  [9.32474607]
curr_Stock_Price:  99.4866538270422
curr_Factors:  [99.48665383]
mat_Sqrt:  [[0.15]]
grads:  [0.04544021]
Stock Position:  0.045440213315337076
Bond Position:  [4.80405129]


portfolio before change:  [9.29269779]
curr_Stock_Price:  98.77476142860615
curr_Factors:  [98.77476143]
mat_Sqrt:  [[0.15]]
grads:  [-0.04467504]
Stock Position:  -0.04467503893930845
Bond Position:  [13.7054641]


portfolio before change:  [9.29554195]
curr_Stock_Price:  98.73027237025772
curr_Factors:  [98.73027237]
mat_Sqrt:  [[0.15]]
grads:  [-0.02103771]
Stock Position:  -0.021037712736638743
Bond Position:  [11.37260106]


portfolio before change:  [9.28481884]
curr_Stock_Price:  99.27376901209159
curr_Factors:  [99.27376901]
mat_Sqrt:  [[0.15]]
grads:  [0.02651952]
Stock Position:  0.026519515661254305
Bond Position:  [6.65212657]


portfolio before change:  [9.29058137]
curr_Stock_Price:  99.47538517240221
curr_Factors:  [99.47538517]
mat_Sqrt:  [[0.15]]
grads:  [0.00709945]
Stock Position:  0.007099452172417732
Bond Position:  [8.58436063]


portfolio before change:  [9.29248181]
curr_Stock_Price:  99.6674990330998
curr_Factors:  [99.66749903]
mat_Sqrt:  [[0.15]]
grads:  [0.02653517]
Stock Position:  0.02653516709181236
Bond Position:  [6.64778807]


portfolio before change:  [9.29997116]
curr_Stock_Price:  99.93408295899647
curr_Factors:  [99.93408296]
mat_Sqrt:  [[0.15]]
grads:  [0.04968277]
Stock Position:  0.0496827743676248
Bond Position:  [4.33496867]


portfolio before change:  [9.28248416]
curr_Stock_Price:  99.57665638951404
curr_Factors:  [99.57665639]
mat_Sqrt:  [[0.15]]
grads:  [0.05333145]
Stock Position:  0.0533314474663147
Bond Position:  [3.97191694]


portfolio before change:  [9.33123923]
curr_Stock_Price:  100.48619128464902
curr_Factors:  [100.48619128]
mat_Sqrt:  [[0.15]]
grads:  [0.1540092]
Stock Position:  0.15400920242365818
Bond Position:  [-6.14455895]


portfolio before change:  [9.35911473]
curr_Stock_Price:  100.66968390868446
curr_Factors:  [100.66968391]
mat_Sqrt:  [[0.15]]
grads:  [0.01502483]
Stock Position:  0.015024827207551406
Bond Position:  [7.84657013]


portfolio before change:  [9.35685538]
curr_Stock_Price:  100.48666823805509
curr_Factors:  [100.48666824]
mat_Sqrt:  [[0.15]]
grads:  [0.53536454]
Stock Position:  0.5353645358499832
Bond Position:  [-44.44014312]


portfolio before change:  [8.90295955]
curr_Stock_Price:  99.6440307379601
curr_Factors:  [99.64403074]
mat_Sqrt:  [[0.15]]
grads:  [-0.10261403]
Stock Position:  -0.10261403225790404
Bond Position:  [19.12783534]


portfolio before change:  [8.8301012]
curr_Stock_Price:  100.36570471226155
curr_Factors:  [100.36570471]
mat_Sqrt:  [[0.15]]
grads:  [-0.00652953]
Stock Position:  -0.006529531841782717
Bond Position:  [9.48544227]


portfolio before change:  [8.82871597]
curr_Stock_Price:  100.66864942585967
curr_Factors:  [100.66864943]
mat_Sqrt:  [[0.15]]
grads:  [0.03957783]
Stock Position:  0.039577829157016714
Bond Position:  [4.84446936]


portfolio before change:  [8.81553174]
curr_Stock_Price:  100.32787722832454
curr_Factors:  [100.32787723]
mat_Sqrt:  [[0.15]]
grads:  [0.0923663]
Stock Position:  0.09236630434779311
Bond Position:  [-0.4513835]


portfolio before change:  [8.85624422]
curr_Stock_Price:  100.76895468627644
curr_Factors:  [100.76895469]
mat_Sqrt:  [[0.15]]
grads:  [-0.0127745]
Stock Position:  -0.012774501660706705
Bond Position:  [10.1435174]


portfolio before change:  [8.85346052]
curr_Stock_Price:  101.03649486912805
curr_Factors:  [101.03649487]
mat_Sqrt:  [[0.15]]
grads:  [0.08315807]
Stock Position:  0.08315806907035968
Bond Position:  [0.4514607]


portfolio before change:  [8.87406633]
curr_Stock_Price:  101.28394649687533
curr_Factors:  [101.2839465]
mat_Sqrt:  [[0.15]]
grads:  [-0.0004669]
Stock Position:  -0.000466898119075553
Bond Position:  [8.92135562]


portfolio before change:  [8.87463999]
curr_Stock_Price:  101.24955608061812
curr_Factors:  [101.24955608]
mat_Sqrt:  [[0.15]]
grads:  [0.02881929]
Stock Position:  0.028819291020899217
Bond Position:  [5.95669957]


portfolio before change:  [8.87191645]
curr_Stock_Price:  101.14213315226019
curr_Factors:  [101.14213315]
mat_Sqrt:  [[0.15]]
grads:  [-0.18205334]
Stock Position:  -0.18205334185583327
Bond Position:  [27.28517979]


portfolio before change:  [8.68394905]
curr_Stock_Price:  102.18398587862106
curr_Factors:  [102.18398588]
mat_Sqrt:  [[0.15]]
grads:  [-0.0377511]
Stock Position:  -0.03775109718010213
Bond Position:  [12.54150663]


portfolio before change:  [8.6706951]
curr_Stock_Price:  102.55583783559028
curr_Factors:  [102.55583784]
mat_Sqrt:  [[0.15]]
grads:  [0.23261472]
Stock Position:  0.23261471969171366
Bond Position:  [-15.18530237]


portfolio before change:  [8.8179795]
curr_Stock_Price:  103.19308689092772
curr_Factors:  [103.19308689]
mat_Sqrt:  [[0.15]]
grads:  [0.03859999]
Stock Position:  0.03859999357897363
Bond Position:  [4.83472701]


portfolio before change:  [8.82522416]
curr_Stock_Price:  103.37294390278988
curr_Factors:  [103.3729439]
mat_Sqrt:  [[0.15]]
grads:  [-0.03575278]
Stock Position:  -0.035752779823441515
Bond Position:  [12.52109426]


portfolio before change:  [8.80751054]
curr_Stock_Price:  103.89028034158598
curr_Factors:  [103.89028034]
mat_Sqrt:  [[0.15]]
grads:  [-0.04203435]
Stock Position:  -0.042034349005986044
Bond Position:  [13.17447084]


portfolio before change:  [8.81091368]
curr_Stock_Price:  103.82890887577241
curr_Factors:  [103.82890888]
mat_Sqrt:  [[0.15]]
grads:  [-0.03003488]
Stock Position:  -0.030034879160197217
Bond Position:  [11.92940241]


portfolio before change:  [8.82966748]
curr_Stock_Price:  103.22933303341966
curr_Factors:  [103.22933303]
mat_Sqrt:  [[0.15]]
grads:  [-0.03533159]
Stock Position:  -0.035331593380434574
Bond Position:  [12.4769243]


portfolio before change:  [8.82886647]
curr_Stock_Price:  103.27407583027438
curr_Factors:  [103.27407583]
mat_Sqrt:  [[0.15]]
grads:  [0.02036463]
Stock Position:  0.020364627610809316
Bond Position:  [6.72572838]


portfolio before change:  [8.81992911]
curr_Stock_Price:  102.81456672357926
curr_Factors:  [102.81456672]
mat_Sqrt:  [[0.15]]
grads:  [0.01608293]
Stock Position:  0.016082931068054092
Bond Position:  [7.16636952]


portfolio before change:  [8.81370861]
curr_Stock_Price:  102.39994001713174
curr_Factors:  [102.39994002]
mat_Sqrt:  [[0.15]]
grads:  [-0.05699177]
Stock Position:  -0.0569917734988019
Bond Position:  [14.6496628]


portfolio before change:  [8.84703425]
curr_Stock_Price:  101.83126139304728
curr_Factors:  [101.83126139]
mat_Sqrt:  [[0.15]]
grads:  [-0.1519909]
Stock Position:  -0.15199089837388693
Bond Position:  [24.32445915]


portfolio before change:  [8.86606012]
curr_Stock_Price:  101.71608643278077
curr_Factors:  [101.71608643]
mat_Sqrt:  [[0.15]]
grads:  [-0.01678601]
Stock Position:  -0.016786007523080928
Bond Position:  [10.57346711]


portfolio before change:  [8.8799264]
curr_Stock_Price:  100.92939429720418
curr_Factors:  [100.9293943]
mat_Sqrt:  [[0.15]]
grads:  [0.05731936]
Stock Position:  0.05731935978952024
Bond Position:  [3.09471814]


portfolio before change:  [8.93443683]
curr_Stock_Price:  101.87701487669403
curr_Factors:  [101.87701488]
mat_Sqrt:  [[0.15]]
grads:  [-0.08050279]
Stock Position:  -0.08050278928004649
Bond Position:  [17.1358207]


portfolio before change:  [8.85127262]
curr_Stock_Price:  102.92337912665059
curr_Factors:  [102.92337913]
mat_Sqrt:  [[0.15]]
grads:  [-0.00500002]
Stock Position:  -0.005000021993281974
Bond Position:  [9.36589177]


portfolio before change:  [8.85027893]
curr_Stock_Price:  103.23919308140056
curr_Factors:  [103.23919308]
mat_Sqrt:  [[0.15]]
grads:  [0.01629715]
Stock Position:  0.016297151451718433
Bond Position:  [7.16777416]


portfolio before change:  [8.85476375]
curr_Stock_Price:  103.48689427488405
curr_Factors:  [103.48689427]
mat_Sqrt:  [[0.15]]
grads:  [-0.09080293]
Stock Position:  -0.0908029344571178
Bond Position:  [18.25167743]


portfolio before change:  [8.86000872]
curr_Stock_Price:  103.44169528949791
curr_Factors:  [103.44169529]
mat_Sqrt:  [[0.15]]
grads:  [0.03664299]
Stock Position:  0.036642986188364084
Bond Position:  [5.0695961]


portfolio before change:  [8.8643903]
curr_Stock_Price:  103.55262316083864
curr_Factors:  [103.55262316]
mat_Sqrt:  [[0.15]]
grads:  [0.0572148]
Stock Position:  0.05721480460213786
Bond Position:  [2.9396472]


portfolio before change:  [8.90338768]
curr_Stock_Price:  104.23100785921247
curr_Factors:  [104.23100786]
mat_Sqrt:  [[0.15]]
grads:  [-0.07410567]
Stock Position:  -0.07410567491743461
Bond Position:  [16.62749687]


portfolio before change:  [8.83272494]
curr_Stock_Price:  105.19857206647085
curr_Factors:  [105.19857207]
mat_Sqrt:  [[0.15]]
grads:  [-0.02895321]
Stock Position:  -0.028953210694586166
Bond Position:  [11.87856136]


portfolio before change:  [8.86086398]
curr_Stock_Price:  104.25233477325854
curr_Factors:  [104.25233477]
mat_Sqrt:  [[0.15]]
grads:  [0.02308857]
Stock Position:  0.023088573748578138
Bond Position:  [6.45382626]


portfolio before change:  [8.87963874]
curr_Stock_Price:  105.04802645568459
curr_Factors:  [105.04802646]
mat_Sqrt:  [[0.15]]
grads:  [0.02070937]
Stock Position:  0.020709374400770145
Bond Position:  [6.70415983]


portfolio before change:  [8.87740339]
curr_Stock_Price:  104.91985366455947
curr_Factors:  [104.91985366]
mat_Sqrt:  [[0.15]]
grads:  [-0.01305629]
Stock Position:  -0.013056287998078366
Bond Position:  [10.24726721]


portfolio before change:  [8.87317618]
curr_Stock_Price:  105.29267615249589
curr_Factors:  [105.29267615]
mat_Sqrt:  [[0.15]]
grads:  [-0.06420957]
Stock Position:  -0.06420957455286198
Bond Position:  [15.63397412]


portfolio before change:  [8.82409808]
curr_Stock_Price:  106.07223680895237
curr_Factors:  [106.07223681]
mat_Sqrt:  [[0.15]]
grads:  [0.08235362]
Stock Position:  0.08235362390864495
Bond Position:  [0.08866498]


portfolio before change:  [8.80366766]
curr_Stock_Price:  105.82408788051328
curr_Factors:  [105.82408788]
mat_Sqrt:  [[0.15]]
grads:  [-0.18907937]
Stock Position:  -0.189079366356884
Bond Position:  [28.81281914]


portfolio before change:  [8.66738773]
curr_Stock_Price:  106.55436734737833
curr_Factors:  [106.55436735]
mat_Sqrt:  [[0.15]]
grads:  [-0.06911295]
Stock Position:  -0.06911294666273575
Bond Position:  [16.03167404]


portfolio before change:  [8.66868939]
curr_Stock_Price:  106.5500317167126
curr_Factors:  [106.55003172]
mat_Sqrt:  [[0.15]]
grads:  [0.13641624]
Stock Position:  0.13641623500144345
Bond Position:  [-5.86646477]


portfolio before change:  [8.60292738]
curr_Stock_Price:  106.07065071539031
curr_Factors:  [106.07065072]
mat_Sqrt:  [[0.15]]
grads:  [-0.04647868]
Stock Position:  -0.046478679905806085
Bond Position:  [13.5329512]


portfolio before change:  [8.58983709]
curr_Stock_Price:  106.37048981025039
curr_Factors:  [106.37048981]
mat_Sqrt:  [[0.15]]
grads:  [0.08778566]
Stock Position:  0.08778565745347036
Bond Position:  [-0.74796629]


portfolio before change:  [8.55966096]
curr_Stock_Price:  106.02727455683878
curr_Factors:  [106.02727456]
mat_Sqrt:  [[0.15]]
grads:  [-0.09340287]
Stock Position:  -0.09340286858870685
Bond Position:  [18.46291255]


portfolio before change:  [8.59086185]
curr_Stock_Price:  105.70558297395529
curr_Factors:  [105.70558297]
mat_Sqrt:  [[0.15]]
grads:  [-0.08478939]
Stock Position:  -0.08478939179932461
Bond Position:  [17.55357394]


portfolio before change:  [8.60286174]
curr_Stock_Price:  105.57699657387376
curr_Factors:  [105.57699657]
mat_Sqrt:  [[0.15]]
grads:  [-0.02009765]
Stock Position:  -0.02009764856215527
Bond Position:  [10.72471112]


portfolio before change:  [8.63420453]
curr_Stock_Price:  104.0508243863727
curr_Factors:  [104.05082439]
mat_Sqrt:  [[0.15]]
grads:  [0.14127422]
Stock Position:  0.14127422088451633
Bond Position:  [-6.06549462]


portfolio before change:  [8.57903767]
curr_Stock_Price:  103.66301299018508
curr_Factors:  [103.66301299]
mat_Sqrt:  [[0.15]]
grads:  [-0.12199662]
Stock Position:  -0.12199662152381335
Bond Position:  [21.22557503]


portfolio before change:  [8.50159237]
curr_Stock_Price:  104.30870252252038
curr_Factors:  [104.30870252]
mat_Sqrt:  [[0.15]]
grads:  [0.12383703]
Stock Position:  0.12383703081445065
Bond Position:  [-4.41568764]


portfolio before change:  [8.5185378]
curr_Stock_Price:  104.44776771375776
curr_Factors:  [104.44776771]
mat_Sqrt:  [[0.15]]
grads:  [0.02804469]
Stock Position:  0.028044690983899598
Bond Position:  [5.58933243]


portfolio before change:  [8.50328414]
curr_Stock_Price:  103.89140564792636
curr_Factors:  [103.89140565]
mat_Sqrt:  [[0.15]]
grads:  [0.06666355]
Stock Position:  0.06666354506464964
Bond Position:  [1.57751474]


portfolio before change:  [8.50860587]
curr_Stock_Price:  103.96975619444875
curr_Factors:  [103.96975619]
mat_Sqrt:  [[0.15]]
grads:  [-0.14038856]
Stock Position:  -0.14038855539362408
Bond Position:  [23.10476974]


portfolio before change:  [8.44391401]
curr_Stock_Price:  104.44084839418502
curr_Factors:  [104.44084839]
mat_Sqrt:  [[0.15]]
grads:  [-0.05332905]
Stock Position:  -0.053329050683647114
Bond Position:  [14.0136453]


portfolio before change:  [8.3892783]
curr_Stock_Price:  105.48177423790194
curr_Factors:  [105.48177424]
mat_Sqrt:  [[0.15]]
grads:  [-0.04137558]
Stock Position:  -0.04137558489968075
Bond Position:  [12.7536484]


portfolio before change:  [8.36426708]
curr_Stock_Price:  106.10553205451288
curr_Factors:  [106.10553205]
mat_Sqrt:  [[0.15]]
grads:  [0.07290564]
Stock Position:  0.0729056408557878
Bond Position:  [0.62857527]


portfolio before change:  [8.28637173]
curr_Stock_Price:  105.03655247105169
curr_Factors:  [105.03655247]
mat_Sqrt:  [[0.15]]
grads:  [0.04260856]
Stock Position:  0.0426085587464486
Bond Position:  [3.81091561]


portfolio before change:  [8.29023326]
curr_Stock_Price:  105.121590291721
curr_Factors:  [105.12159029]
mat_Sqrt:  [[0.15]]
grads:  [-0.00481707]
Stock Position:  -0.004817069237280271
Bond Position:  [8.79661124]


portfolio before change:  [8.29754311]
curr_Stock_Price:  103.71823721251992
curr_Factors:  [103.71823721]
mat_Sqrt:  [[0.15]]
grads:  [-0.04353296]
Stock Position:  -0.04353295908177902
Bond Position:  [12.81270489]


portfolio before change:  [8.3061713]
curr_Stock_Price:  103.53843393194622
curr_Factors:  [103.53843393]
mat_Sqrt:  [[0.15]]
grads:  [0.04931994]
Stock Position:  0.04931993822185315
Bond Position:  [3.19966213]


portfolio before change:  [8.33752665]
curr_Stock_Price:  104.17013304968397
curr_Factors:  [104.17013305]
mat_Sqrt:  [[0.15]]
grads:  [-0.02558028]
Stock Position:  -0.025580281187251867
Bond Position:  [11.00222794]


portfolio before change:  [8.32409457]
curr_Stock_Price:  104.72211041214736
curr_Factors:  [104.72211041]
mat_Sqrt:  [[0.15]]
grads:  [0.15904816]
Stock Position:  0.15904815756148868
Bond Position:  [-8.33176415]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.32409457]
Stock Price:  105.73304080870074
PL:  [2.59105376]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.33402796e-02]
 [-2.28123463e-03]
 [ 1.32999173e-03]
 [ 2.44627143e-03]
 [ 5.00668638e-03]
 [ 1.20923288e-02]
 [-4.61046687e-04]
 [ 8.06601305e-03]
 [-1.26256023e-02]
 [-4.90434151e-03]
 [ 9.93116293e-03]
 [-9.40044564e-03]
 [ 1.57244478e-02]
 [ 4.02835950e-03]
 [-7.17473678e-04]
 [-1.00637449e-02]
 [ 8.32215545e-03]
 [ 2.44447717e-02]
 [ 1.10758354e-02]
 [-2.36626608e-03]
 [ 4.52658366e-02]
 [-1.21288172e-02]
 [ 8.84582034e-03]
 [-3.99627178e-03]
 [ 1.65983402e-02]
 [ 1.83083362e-02]
 [ 9.42240923e-03]
 [ 1.24927839e-03]
 [ 7.71652128e-03]
 [-9.69926721e-03]
 [-5.74365853e-03]
 [ 3.31920625e-02]
 [ 7.11798797e-03]
 [-4.13004192e-03]
 [-6.85635708e-03]
 [-4.84488131e-03]
 [-4.98381981e-03]
 [ 7.58882343e-03]
 [-2.19337006e-03]
 [-1.23610409e-02]
 [-3.14038388e-03]
 [-2.91737164e-03]
 [ 7.78135004e-03]
 [-1.18654974e-02]
 [ 7.36012209e-04]
 [ 2.26570453e-03]
 [-1.36654646e-02]
 [ 6.97902726e-04]
 [ 5.69006055e-03]
 [-1.08505759e-02]
 [-3.79746632e-03]
 [ 3.44404494e-03]
 [ 1.42121965e-03]
 [ 3.28326180e-03]
 [-6.52295736e-03]
 [ 9.35288300e-03]
 [-8.39283048e-03]
 [-1.25709441e-02]
 [ 1.58339133e-02]
 [-2.24162743e-03]
 [ 1.30160392e-02]
 [-1.46413259e-02]
 [-1.27622526e-02]
 [-3.34675555e-03]
 [ 6.30641982e-03]
 [-1.80892119e-02]
 [ 1.98552336e-02]
 [ 3.79086965e-03]
 [ 9.79396365e-03]
 [-2.09078249e-02]
 [-7.82103480e-03]
 [-7.37158978e-03]
 [ 6.67058396e-03]
 [ 6.65376853e-03]
 [-6.29120462e-04]
 [-6.03489098e-04]
 [ 7.08078219e-03]
 [-3.34471972e-03]
 [ 2.20207001e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.76706105]
curr_Stock_Price:  100.23784087811704
curr_Factors:  [100.23784088]
mat_Sqrt:  [[0.15]]
grads:  [-0.2889352]
Stock Position:  -0.28893519718388216
Bond Position:  [34.72930137]


portfolio before change:  [5.79728563]
curr_Stock_Price:  100.140746688007
curr_Factors:  [100.14074669]
mat_Sqrt:  [[0.15]]
grads:  [-0.01520823]
Stock Position:  -0.015208230850944051
Bond Position:  [7.32024922]


portfolio before change:  [5.78714145]
curr_Stock_Price:  100.8378498134323
curr_Factors:  [100.83784981]
mat_Sqrt:  [[0.15]]
grads:  [0.00886661]
Stock Position:  0.008866611553670016
Bond Position:  [4.89305141]


portfolio before change:  [5.78777983]
curr_Stock_Price:  100.87535550422015
curr_Factors:  [100.8753555]
mat_Sqrt:  [[0.15]]
grads:  [0.01630848]
Stock Position:  0.01630847617844718
Bond Position:  [4.14265649]


portfolio before change:  [5.78751687]
curr_Stock_Price:  100.84335461602582
curr_Factors:  [100.84335462]
mat_Sqrt:  [[0.15]]
grads:  [0.03337791]
Stock Position:  0.033377909185770646
Bond Position:  [2.42157653]


portfolio before change:  [5.80869745]
curr_Stock_Price:  101.47338897122611
curr_Factors:  [101.47338897]
mat_Sqrt:  [[0.15]]
grads:  [0.08061553]
Stock Position:  0.08061552554648636
Bond Position:  [-2.37163313]


portfolio before change:  [5.84746765]
curr_Stock_Price:  101.95615494733198
curr_Factors:  [101.95615495]
mat_Sqrt:  [[0.15]]
grads:  [-0.00307364]
Stock Position:  -0.0030736445818882107
Bond Position:  [6.16084463]


portfolio before change:  [5.84782887]
curr_Stock_Price:  101.96391351504481
curr_Factors:  [101.96391352]
mat_Sqrt:  [[0.15]]
grads:  [0.05377342]
Stock Position:  0.0537734203357147
Bond Position:  [0.36488049]


portfolio before change:  [5.86651769]
curr_Stock_Price:  102.31103708478443
curr_Factors:  [102.31103708]
mat_Sqrt:  [[0.15]]
grads:  [-0.08417068]
Stock Position:  -0.08417068189123147
Bond Position:  [14.47810745]


portfolio before change:  [5.90183827]
curr_Stock_Price:  101.90215759405059
curr_Factors:  [101.90215759]
mat_Sqrt:  [[0.15]]
grads:  [-0.03269561]
Stock Position:  -0.032695610090101815
Bond Position:  [9.23359148]


portfolio before change:  [5.89332277]
curr_Stock_Price:  102.18025649933537
curr_Factors:  [102.1802565]
mat_Sqrt:  [[0.15]]
grads:  [0.06620775]
Stock Position:  0.06620775284631597
Bond Position:  [-0.87180239]


portfolio before change:  [5.87166725]
curr_Stock_Price:  101.85399510922166
curr_Factors:  [101.85399511]
mat_Sqrt:  [[0.15]]
grads:  [-0.06266964]
Stock Position:  -0.06266963760900926
Bond Position:  [12.25482021]


portfolio before change:  [5.88373842]
curr_Stock_Price:  101.67360116648378
curr_Factors:  [101.67360117]
mat_Sqrt:  [[0.15]]
grads:  [0.10482965]
Stock Position:  0.10482965186682583
Bond Position:  [-4.77466979]


portfolio before change:  [5.86097401]
curr_Stock_Price:  101.45929166911584
curr_Factors:  [101.45929167]
mat_Sqrt:  [[0.15]]
grads:  [0.02685573]
Stock Position:  0.02685573001937759
Bond Position:  [3.13621066]


portfolio before change:  [5.87105435]
curr_Stock_Price:  101.82734421772393
curr_Factors:  [101.82734422]
mat_Sqrt:  [[0.15]]
grads:  [-0.00478316]
Stock Position:  -0.004783157856551752
Bond Position:  [6.35811061]


portfolio before change:  [5.87020569]
curr_Stock_Price:  102.08785231246532
curr_Factors:  [102.08785231]
mat_Sqrt:  [[0.15]]
grads:  [-0.06709163]
Stock Position:  -0.06709163243734668
Bond Position:  [12.71944635]


portfolio before change:  [5.86329554]
curr_Stock_Price:  102.20269731602463
curr_Factors:  [102.20269732]
mat_Sqrt:  [[0.15]]
grads:  [0.05548104]
Stock Position:  0.055481036357193786
Bond Position:  [0.19298398]


portfolio before change:  [5.84231625]
curr_Stock_Price:  101.82434539310924
curr_Factors:  [101.82434539]
mat_Sqrt:  [[0.15]]
grads:  [0.16296514]
Stock Position:  0.16296514473306606
Bond Position:  [-10.75150294]


portfolio before change:  [5.9721665]
curr_Stock_Price:  102.62526661394247
curr_Factors:  [102.62526661]
mat_Sqrt:  [[0.15]]
grads:  [0.0738389]
Stock Position:  0.07383890288303163
Bond Position:  [-1.6055706]


portfolio before change:  [5.99595324]
curr_Stock_Price:  102.9487693465139
curr_Factors:  [102.94876935]
mat_Sqrt:  [[0.15]]
grads:  [-0.01577511]
Stock Position:  -0.015775107185318847
Bond Position:  [7.61998111]


portfolio before change:  [6.00423549]
curr_Stock_Price:  102.45393955655705
curr_Factors:  [102.45393956]
mat_Sqrt:  [[0.15]]
grads:  [0.30177224]
Stock Position:  0.3017722437279915
Bond Position:  [-24.91351973]


portfolio before change:  [6.01114628]
curr_Stock_Price:  102.48200023757691
curr_Factors:  [102.48200024]
mat_Sqrt:  [[0.15]]
grads:  [-0.08085878]
Stock Position:  -0.08085878166315456
Bond Position:  [14.29771596]


portfolio before change:  [6.03090873]
curr_Stock_Price:  102.24864505948125
curr_Factors:  [102.24864506]
mat_Sqrt:  [[0.15]]
grads:  [0.05897214]
Stock Position:  0.05897213558521651
Bond Position:  [0.00108777]


portfolio before change:  [6.03205302]
curr_Stock_Price:  102.26804776219657
curr_Factors:  [102.26804776]
mat_Sqrt:  [[0.15]]
grads:  [-0.02664181]
Stock Position:  -0.02664181185572649
Bond Position:  [8.75665911]


portfolio before change:  [6.04913663]
curr_Stock_Price:  101.6473578702613
curr_Factors:  [101.64735787]
mat_Sqrt:  [[0.15]]
grads:  [0.1106556]
Stock Position:  0.11065560149689013
Bond Position:  [-5.19871289]


portfolio before change:  [6.12796823]
curr_Stock_Price:  102.36269925706681
curr_Factors:  [102.36269926]
mat_Sqrt:  [[0.15]]
grads:  [0.12205557]
Stock Position:  0.1220555743736255
Bond Position:  [-6.36596982]


portfolio before change:  [6.20533091]
curr_Stock_Price:  102.99979069614395
curr_Factors:  [102.9997907]
mat_Sqrt:  [[0.15]]
grads:  [0.06281606]
Stock Position:  0.06281606153356127
Bond Position:  [-0.26471028]


portfolio before change:  [6.21048486]
curr_Stock_Price:  103.0821023278582
curr_Factors:  [103.08210233]
mat_Sqrt:  [[0.15]]
grads:  [0.00832852]
Stock Position:  0.008328522580011155
Bond Position:  [5.35196324]


portfolio before change:  [6.21584284]
curr_Stock_Price:  103.6852676164772
curr_Factors:  [103.68526762]
mat_Sqrt:  [[0.15]]
grads:  [0.05144348]
Stock Position:  0.05144347522793553
Bond Position:  [0.88191235]


portfolio before change:  [6.22338765]
curr_Stock_Price:  103.8308583258255
curr_Factors:  [103.83085833]
mat_Sqrt:  [[0.15]]
grads:  [-0.06466178]
Stock Position:  -0.06466178138206977
Bond Position:  [12.93727592]


portfolio before change:  [6.2366315]
curr_Stock_Price:  103.6385463068435
curr_Factors:  [103.63854631]
mat_Sqrt:  [[0.15]]
grads:  [-0.03829106]
Stock Position:  -0.03829105687792021
Bond Position:  [10.20506097]


portfolio before change:  [6.28806147]
curr_Stock_Price:  102.31207114598311
curr_Factors:  [102.31207115]
mat_Sqrt:  [[0.15]]
grads:  [0.22128042]
Stock Position:  0.22128041679142268
Bond Position:  [-16.35159628]


portfolio before change:  [6.25961784]
curr_Stock_Price:  102.18814864860008
curr_Factors:  [102.18814865]
mat_Sqrt:  [[0.15]]
grads:  [0.04745325]
Stock Position:  0.04745325315250344
Bond Position:  [1.41045775]


portfolio before change:  [6.29357114]
curr_Stock_Price:  102.90180142120425
curr_Factors:  [102.90180142]
mat_Sqrt:  [[0.15]]
grads:  [-0.02753361]
Stock Position:  -0.02753361277045169
Bond Position:  [9.1268295]


portfolio before change:  [6.27662393]
curr_Stock_Price:  103.53802957905064
curr_Factors:  [103.53802958]
mat_Sqrt:  [[0.15]]
grads:  [-0.04570905]
Stock Position:  -0.045709047216515614
Bond Position:  [11.00924861]


portfolio before change:  [6.24871221]
curr_Stock_Price:  104.16372231556788
curr_Factors:  [104.16372232]
mat_Sqrt:  [[0.15]]
grads:  [-0.03229921]
Stock Position:  -0.03229920874779447
Bond Position:  [9.61311802]


portfolio before change:  [6.27357799]
curr_Stock_Price:  103.41246725172475
curr_Factors:  [103.41246725]
mat_Sqrt:  [[0.15]]
grads:  [-0.03322547]
Stock Position:  -0.03322546542948051
Bond Position:  [9.70950535]


portfolio before change:  [6.33115821]
curr_Stock_Price:  101.69771751225022
curr_Factors:  [101.69771751]
mat_Sqrt:  [[0.15]]
grads:  [0.05059216]
Stock Position:  0.05059215622007305
Bond Position:  [1.1860514]


portfolio before change:  [6.27344866]
curr_Stock_Price:  100.55557053536195
curr_Factors:  [100.55557054]
mat_Sqrt:  [[0.15]]
grads:  [-0.01462247]
Stock Position:  -0.014622467043994614
Bond Position:  [7.74381918]


portfolio before change:  [6.27201659]
curr_Stock_Price:  100.68660707413972
curr_Factors:  [100.68660707]
mat_Sqrt:  [[0.15]]
grads:  [-0.08240694]
Stock Position:  -0.08240693949946074
Bond Position:  [14.56929173]


portfolio before change:  [6.27308235]
curr_Stock_Price:  100.6847243763198
curr_Factors:  [100.68472438]
mat_Sqrt:  [[0.15]]
grads:  [-0.02093589]
Stock Position:  -0.020935892517818848
Bond Position:  [8.38100692]


portfolio before change:  [6.2769394]
curr_Stock_Price:  100.52551362801051
curr_Factors:  [100.52551363]
mat_Sqrt:  [[0.15]]
grads:  [-0.01944914]
Stock Position:  -0.019449144284924235
Bond Position:  [8.23207461]


portfolio before change:  [6.27531962]
curr_Stock_Price:  100.63525083602507
curr_Factors:  [100.63525084]
mat_Sqrt:  [[0.15]]
grads:  [0.05187567]
Stock Position:  0.0518756669284038
Bond Position:  [1.05479887]


portfolio before change:  [6.34965576]
curr_Stock_Price:  102.06694727363467
curr_Factors:  [102.06694727]
mat_Sqrt:  [[0.15]]
grads:  [-0.07910332]
Stock Position:  -0.07910331577761417
Bond Position:  [14.42348972]


portfolio before change:  [6.37702735]
curr_Stock_Price:  101.73232038830335
curr_Factors:  [101.73232039]
mat_Sqrt:  [[0.15]]
grads:  [0.00490675]
Stock Position:  0.004906748062726703
Bond Position:  [5.87785248]


portfolio before change:  [6.37992755]
curr_Stock_Price:  102.248512693254
curr_Factors:  [102.24851269]
mat_Sqrt:  [[0.15]]
grads:  [0.0151047]
Stock Position:  0.015104696851193037
Bond Position:  [4.83549476]


portfolio before change:  [6.37676736]
curr_Stock_Price:  102.01928438362543
curr_Factors:  [102.01928438]
mat_Sqrt:  [[0.15]]
grads:  [-0.0911031]
Stock Position:  -0.09110309747061623
Bond Position:  [15.67104016]


portfolio before change:  [6.32913781]
curr_Stock_Price:  102.55284490669597
curr_Factors:  [102.55284491]
mat_Sqrt:  [[0.15]]
grads:  [0.00465268]
Stock Position:  0.004652684838431903
Bond Position:  [5.85199174]


portfolio before change:  [6.33129702]
curr_Stock_Price:  102.93831117774974
curr_Factors:  [102.93831118]
mat_Sqrt:  [[0.15]]
grads:  [0.03793374]
Stock Position:  0.03793373697947345
Bond Position:  [2.4264622]


portfolio before change:  [6.37475808]
curr_Stock_Price:  104.08002296618884
curr_Factors:  [104.08002297]
mat_Sqrt:  [[0.15]]
grads:  [-0.07233717]
Stock Position:  -0.07233717274448802
Bond Position:  [13.90361268]


portfolio before change:  [6.39966612]
curr_Stock_Price:  103.74770360876492
curr_Factors:  [103.74770361]
mat_Sqrt:  [[0.15]]
grads:  [-0.02531644]
Stock Position:  -0.025316442159467895
Bond Position:  [9.02618886]


portfolio before change:  [6.41096109]
curr_Stock_Price:  103.32383647601583
curr_Factors:  [103.32383648]
mat_Sqrt:  [[0.15]]
grads:  [0.0229603]
Stock Position:  0.02296029960677662
Bond Position:  [4.03861484]


portfolio before change:  [6.40008808]
curr_Stock_Price:  102.8392858104515
curr_Factors:  [102.83928581]
mat_Sqrt:  [[0.15]]
grads:  [0.0094748]
Stock Position:  0.009474797636184478
Bond Position:  [5.42570666]


portfolio before change:  [6.40401538]
curr_Stock_Price:  103.21799388009912
curr_Factors:  [103.21799388]
mat_Sqrt:  [[0.15]]
grads:  [0.02188841]
Stock Position:  0.021888411992902392
Bond Position:  [4.1447374]


portfolio before change:  [6.41594341]
curr_Stock_Price:  103.75110614351827
curr_Factors:  [103.75110614]
mat_Sqrt:  [[0.15]]
grads:  [-0.04348638]
Stock Position:  -0.043486382382809
Bond Position:  [10.92770369]


portfolio before change:  [6.44372556]
curr_Stock_Price:  103.12794217504322
curr_Factors:  [103.12794218]
mat_Sqrt:  [[0.15]]
grads:  [0.06235255]
Stock Position:  0.06235255335103122
Bond Position:  [0.01343505]


portfolio before change:  [6.39361371]
curr_Stock_Price:  102.3242431184813
curr_Factors:  [102.32424312]
mat_Sqrt:  [[0.15]]
grads:  [-0.0559522]
Stock Position:  -0.05595220319339279
Bond Position:  [12.11888056]


portfolio before change:  [6.37460799]
curr_Stock_Price:  102.67745850464827
curr_Factors:  [102.6774585]
mat_Sqrt:  [[0.15]]
grads:  [-0.08380629]
Stock Position:  -0.08380629432820834
Bond Position:  [14.9796253]


portfolio before change:  [6.29397764]
curr_Stock_Price:  103.65073390452038
curr_Factors:  [103.6507339]
mat_Sqrt:  [[0.15]]
grads:  [0.10555942]
Stock Position:  0.10555942225466533
Bond Position:  [-4.64733395]


portfolio before change:  [6.38101281]
curr_Stock_Price:  104.4779991238594
curr_Factors:  [104.47799912]
mat_Sqrt:  [[0.15]]
grads:  [-0.01494418]
Stock Position:  -0.014944182873063792
Bond Position:  [7.94235114]


portfolio before change:  [6.37850995]
curr_Stock_Price:  104.67869757164584
curr_Factors:  [104.67869757]
mat_Sqrt:  [[0.15]]
grads:  [0.08677359]
Stock Position:  0.08677359490810145
Bond Position:  [-2.70483695]


portfolio before change:  [6.37273434]
curr_Stock_Price:  104.6140863001774
curr_Factors:  [104.6140863]
mat_Sqrt:  [[0.15]]
grads:  [-0.09760884]
Stock Position:  -0.09760883929035521
Bond Position:  [16.58399388]


portfolio before change:  [6.41841871]
curr_Stock_Price:  104.15667032702835
curr_Factors:  [104.15667033]
mat_Sqrt:  [[0.15]]
grads:  [-0.08508168]
Stock Position:  -0.08508168371445761
Bond Position:  [15.28024359]


portfolio before change:  [6.45252647]
curr_Stock_Price:  103.76701292998759
curr_Factors:  [103.76701293]
mat_Sqrt:  [[0.15]]
grads:  [-0.0223117]
Stock Position:  -0.022311703639849016
Bond Position:  [8.76774531]


portfolio before change:  [6.45695256]
curr_Stock_Price:  103.5931985881386
curr_Factors:  [103.59319859]
mat_Sqrt:  [[0.15]]
grads:  [0.0420428]
Stock Position:  0.042042798805492235
Bond Position:  [2.10160455]


portfolio before change:  [6.46601852]
curr_Stock_Price:  103.80571068859133
curr_Factors:  [103.80571069]
mat_Sqrt:  [[0.15]]
grads:  [-0.12059475]
Stock Position:  -0.12059474576736391
Bond Position:  [18.98444181]


portfolio before change:  [6.4308152]
curr_Stock_Price:  104.10746412079327
curr_Factors:  [104.10746412]
mat_Sqrt:  [[0.15]]
grads:  [0.13236822]
Stock Position:  0.13236822376302923
Bond Position:  [-7.3497049]


portfolio before change:  [6.40199586]
curr_Stock_Price:  103.89321351990802
curr_Factors:  [103.89321352]
mat_Sqrt:  [[0.15]]
grads:  [0.02527246]
Stock Position:  0.025272464361347502
Bond Position:  [3.77635833]


portfolio before change:  [6.40020054]
curr_Stock_Price:  103.8128355982297
curr_Factors:  [103.8128356]
mat_Sqrt:  [[0.15]]
grads:  [0.06529309]
Stock Position:  0.06529309097708062
Bond Position:  [-0.37806038]


portfolio before change:  [6.40699832]
curr_Stock_Price:  103.91730915390193
curr_Factors:  [103.91730915]
mat_Sqrt:  [[0.15]]
grads:  [-0.1393855]
Stock Position:  -0.13938549960408658
Bond Position:  [20.89156437]


portfolio before change:  [6.42283511]
curr_Stock_Price:  103.81305846176157
curr_Factors:  [103.81305846]
mat_Sqrt:  [[0.15]]
grads:  [-0.05214023]
Stock Position:  -0.05214023200105942
Bond Position:  [11.83567207]


portfolio before change:  [6.43630658]
curr_Stock_Price:  103.56887638196697
curr_Factors:  [103.56887638]
mat_Sqrt:  [[0.15]]
grads:  [-0.04914393]
Stock Position:  -0.04914393183376875
Bond Position:  [11.52608838]


portfolio before change:  [6.39340521]
curr_Stock_Price:  104.45650917285145
curr_Factors:  [104.45650917]
mat_Sqrt:  [[0.15]]
grads:  [0.04447056]
Stock Position:  0.04447055973799112
Bond Position:  [1.74816578]


portfolio before change:  [6.404924]
curr_Stock_Price:  104.71307274280453
curr_Factors:  [104.71307274]
mat_Sqrt:  [[0.15]]
grads:  [0.04435846]
Stock Position:  0.044358456875641245
Bond Position:  [1.76001368]


portfolio before change:  [6.38327103]
curr_Stock_Price:  104.22245658979898
curr_Factors:  [104.22245659]
mat_Sqrt:  [[0.15]]
grads:  [-0.00419414]
Stock Position:  -0.004194136414428281
Bond Position:  [6.82039423]


portfolio before change:  [6.37809569]
curr_Stock_Price:  105.55804214394097
curr_Factors:  [105.55804214]
mat_Sqrt:  [[0.15]]
grads:  [-0.00402326]
Stock Position:  -0.00402326065336671
Bond Position:  [6.80278321]


portfolio before change:  [6.37697414]
curr_Stock_Price:  105.94249103615434
curr_Factors:  [105.94249104]
mat_Sqrt:  [[0.15]]
grads:  [0.04720521]
Stock Position:  0.04720521462018517
Bond Position:  [1.37593612]


portfolio before change:  [6.35920426]
curr_Stock_Price:  105.56423023404663
curr_Factors:  [105.56423023]
mat_Sqrt:  [[0.15]]
grads:  [-0.02229813]
Stock Position:  -0.022298131451815955
Bond Position:  [8.71308934]


portfolio before change:  [6.35151182]
curr_Stock_Price:  105.93363439091104
curr_Factors:  [105.93363439]
mat_Sqrt:  [[0.15]]
grads:  [0.14680467]
Stock Position:  0.14680466763401648
Bond Position:  [-9.20004017]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.35151182]
Stock Price:  106.45666242349563
PL:  [-0.1051506]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.42244997e-02]
 [-7.25502966e-04]
 [-9.86663363e-04]
 [-1.21304559e-03]
 [-2.66271217e-02]
 [-1.29409585e-03]
 [ 2.73533445e-03]
 [-1.52690261e-02]
 [ 2.00358721e-03]
 [ 3.45362159e-02]
 [ 8.99450183e-03]
 [-1.13195782e-02]
 [ 8.08180205e-03]
 [ 6.03395838e-03]
 [-2.02820898e-02]
 [ 1.94984191e-02]
 [-3.59601232e-03]
 [-5.43632813e-03]
 [-2.41764893e-02]
 [ 1.45328136e-02]
 [-2.60012819e-02]
 [-2.88700320e-02]
 [ 1.70223277e-03]
 [-3.39068797e-03]
 [-1.03892914e-02]
 [ 1.65526682e-02]
 [ 1.82717645e-02]
 [ 2.45429034e-02]
 [ 1.59333804e-04]
 [ 1.01323578e-02]
 [-3.43554388e-03]
 [-5.34276363e-02]
 [ 2.34102942e-02]
 [ 1.14232362e-02]
 [-3.18813948e-02]
 [ 8.48626619e-03]
 [ 2.99004719e-04]
 [-1.19572613e-02]
 [ 7.64455439e-03]
 [-1.72142765e-02]
 [ 4.50106971e-02]
 [ 1.56463565e-04]
 [ 4.99809007e-03]
 [-8.58251501e-03]
 [ 1.59983778e-03]
 [-4.18103684e-03]
 [-1.36916561e-02]
 [-1.26782754e-03]
 [-7.09104916e-03]
 [ 8.94184997e-03]
 [-3.13934933e-03]
 [ 3.42411625e-03]
 [ 2.56345317e-03]
 [ 9.55495390e-04]
 [ 1.97954457e-03]
 [ 9.01944697e-03]
 [ 1.30781333e-02]
 [ 2.09604471e-03]
 [ 1.36534984e-02]
 [-1.55912611e-03]
 [ 1.77118032e-03]
 [-1.57014989e-02]
 [-1.26753555e-02]
 [-1.03795903e-03]
 [-1.14395115e-02]
 [-1.73942366e-02]
 [ 1.02208486e-02]
 [ 2.27649940e-03]
 [ 8.52871798e-03]
 [-1.70476100e-02]
 [-5.60674465e-03]
 [-7.31884904e-04]
 [ 2.03135180e-03]
 [ 8.81113055e-03]
 [ 1.17732650e-02]
 [-6.29024367e-03]
 [-4.63823075e-03]
 [-9.25800854e-03]
 [-1.43126457e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.30416788]
curr_Stock_Price:  99.88673713072099
curr_Factors:  [99.88673713]
mat_Sqrt:  [[0.15]]
grads:  [-0.22816333]
Stock Position:  -0.22816333130515715
Bond Position:  [23.09465858]


portfolio before change:  [0.32193933]
curr_Stock_Price:  99.81517441336243
curr_Factors:  [99.81517441]
mat_Sqrt:  [[0.15]]
grads:  [-0.00483669]
Stock Position:  -0.00483668644332676
Bond Position:  [0.80471403]


portfolio before change:  [0.32621238]
curr_Stock_Price:  98.9421060313266
curr_Factors:  [98.94210603]
mat_Sqrt:  [[0.15]]
grads:  [-0.00657776]
Stock Position:  -0.006577755753904641
Bond Position:  [0.97702939]


portfolio before change:  [0.32818534]
curr_Stock_Price:  98.65144654335198
curr_Factors:  [98.65144654]
mat_Sqrt:  [[0.15]]
grads:  [-0.00808697]
Stock Position:  -0.00808697062922939
Bond Position:  [1.12597669]


portfolio before change:  [0.33476416]
curr_Stock_Price:  97.84664001567248
curr_Factors:  [97.84664002]
mat_Sqrt:  [[0.15]]
grads:  [-0.17751414]
Stock Position:  -0.17751414491133127
Bond Position:  [17.70392679]


portfolio before change:  [0.42789292]
curr_Stock_Price:  97.32824619957074
curr_Factors:  [97.3282462]
mat_Sqrt:  [[0.15]]
grads:  [-0.00862731]
Stock Position:  -0.008627305671825862
Bond Position:  [1.26757345]


portfolio before change:  [0.42858501]
curr_Stock_Price:  97.2572087514924
curr_Factors:  [97.25720875]
mat_Sqrt:  [[0.15]]
grads:  [0.01823556]
Stock Position:  0.01823556302315892
Bond Position:  [-1.34495495]


portfolio before change:  [0.42649921]
curr_Stock_Price:  97.14743727770986
curr_Factors:  [97.14743728]
mat_Sqrt:  [[0.15]]
grads:  [-0.10179351]
Stock Position:  -0.10179350736477971
Bond Position:  [10.31547758]


portfolio before change:  [0.39153949]
curr_Stock_Price:  97.49720865117689
curr_Factors:  [97.49720865]
mat_Sqrt:  [[0.15]]
grads:  [0.01335725]
Stock Position:  0.013357248043466706
Bond Position:  [-0.91075491]


portfolio before change:  [0.38942998]
curr_Stock_Price:  97.34354051167345
curr_Factors:  [97.34354051]
mat_Sqrt:  [[0.15]]
grads:  [0.23024144]
Stock Position:  0.23024143951963016
Bond Position:  [-22.02308691]


portfolio before change:  [0.46180154]
curr_Stock_Price:  97.66384796753766
curr_Factors:  [97.66384797]
mat_Sqrt:  [[0.15]]
grads:  [0.05996335]
Stock Position:  0.059963345512072865
Bond Position:  [-5.39444952]


portfolio before change:  [0.4354013]
curr_Stock_Price:  97.22919782673239
curr_Factors:  [97.22919783]
mat_Sqrt:  [[0.15]]
grads:  [-0.07546385]
Stock Position:  -0.07546385474928646
Bond Position:  [7.77269137]


portfolio before change:  [0.41803751]
curr_Stock_Price:  97.46572963495609
curr_Factors:  [97.46572963]
mat_Sqrt:  [[0.15]]
grads:  [0.05387868]
Stock Position:  0.053878680351994356
Bond Position:  [-4.83328738]


portfolio before change:  [0.42280317]
curr_Stock_Price:  97.55978818520133
curr_Factors:  [97.55978819]
mat_Sqrt:  [[0.15]]
grads:  [0.04022639]
Stock Position:  0.04022638922298914
Bond Position:  [-3.50167484]


portfolio before change:  [0.43096099]
curr_Stock_Price:  97.76802668815697
curr_Factors:  [97.76802669]
mat_Sqrt:  [[0.15]]
grads:  [-0.13521393]
Stock Position:  -0.1352139318308011
Bond Position:  [13.65056029]


portfolio before change:  [0.56649947]
curr_Stock_Price:  96.77193637000651
curr_Factors:  [96.77193637]
mat_Sqrt:  [[0.15]]
grads:  [0.12998946]
Stock Position:  0.1299894606562579
Bond Position:  [-12.01283235]


portfolio before change:  [0.65653166]
curr_Stock_Price:  97.4703239190944
curr_Factors:  [97.47032392]
mat_Sqrt:  [[0.15]]
grads:  [-0.02397342]
Stock Position:  -0.023973415480163768
Bond Position:  [2.99322824]


portfolio before change:  [0.66254836]
curr_Stock_Price:  97.22715395443795
curr_Factors:  [97.22715395]
mat_Sqrt:  [[0.15]]
grads:  [-0.03624219]
Stock Position:  -0.03624218752068572
Bond Position:  [4.18627311]


portfolio before change:  [0.6800046]
curr_Stock_Price:  96.75271808246544
curr_Factors:  [96.75271808]
mat_Sqrt:  [[0.15]]
grads:  [-0.1611766]
Stock Position:  -0.16117659526981434
Bond Position:  [16.27427829]


portfolio before change:  [0.6273044]
curr_Stock_Price:  97.08600082933296
curr_Factors:  [97.08600083]
mat_Sqrt:  [[0.15]]
grads:  [0.09688542]
Stock Position:  0.0968854239073847
Bond Position:  [-8.77891395]


portfolio before change:  [0.64664654]
curr_Stock_Price:  97.29130356685818
curr_Factors:  [97.29130357]
mat_Sqrt:  [[0.15]]
grads:  [-0.17334188]
Stock Position:  -0.17334187957926278
Bond Position:  [17.51130397]


portfolio before change:  [0.76267555]
curr_Stock_Price:  96.62825251269143
curr_Factors:  [96.62825251]
mat_Sqrt:  [[0.15]]
grads:  [-0.19246688]
Stock Position:  -0.19246688029955494
Bond Position:  [19.36041386]


portfolio before change:  [0.96358923]
curr_Stock_Price:  95.59065263020915
curr_Factors:  [95.59065263]
mat_Sqrt:  [[0.15]]
grads:  [0.01134822]
Stock Position:  0.011348218470858755
Bond Position:  [-0.12119438]


portfolio before change:  [0.95977898]
curr_Stock_Price:  95.25556311712536
curr_Factors:  [95.25556312]
mat_Sqrt:  [[0.15]]
grads:  [-0.02260459]
Stock Position:  -0.022604586461867627
Bond Position:  [3.11299159]


portfolio before change:  [0.96204408]
curr_Stock_Price:  95.16396532610655
curr_Factors:  [95.16396533]
mat_Sqrt:  [[0.15]]
grads:  [-0.06926194]
Stock Position:  -0.06926194277643676
Bond Position:  [7.5532852]


portfolio before change:  [0.92649863]
curr_Stock_Price:  95.68398453886391
curr_Factors:  [95.68398454]
mat_Sqrt:  [[0.15]]
grads:  [0.11035112]
Stock Position:  0.11035112106824728
Bond Position:  [-9.63233633]


portfolio before change:  [0.97721732]
curr_Stock_Price:  96.14905206545149
curr_Factors:  [96.14905207]
mat_Sqrt:  [[0.15]]
grads:  [0.12181176]
Stock Position:  0.1218117634135785
Bond Position:  [-10.73486826]


portfolio before change:  [1.01174205]
curr_Stock_Price:  96.43798703653607
curr_Factors:  [96.43798704]
mat_Sqrt:  [[0.15]]
grads:  [0.16361936]
Stock Position:  0.16361935580581502
Bond Position:  [-14.76737927]


portfolio before change:  [0.96793975]
curr_Stock_Price:  96.17591959654911
curr_Factors:  [96.1759196]
mat_Sqrt:  [[0.15]]
grads:  [0.00106223]
Stock Position:  0.0010622253567562048
Bond Position:  [0.86577925]


portfolio before change:  [0.96744722]
curr_Stock_Price:  95.66129886891666
curr_Factors:  [95.66129887]
mat_Sqrt:  [[0.15]]
grads:  [0.06754905]
Stock Position:  0.06754905201165215
Bond Position:  [-5.49438283]


portfolio before change:  [0.98297484]
curr_Stock_Price:  95.89625443350977
curr_Factors:  [95.89625443]
mat_Sqrt:  [[0.15]]
grads:  [-0.02290363]
Stock Position:  -0.022903625872874735
Bond Position:  [3.17934677]


portfolio before change:  [1.00390463]
curr_Stock_Price:  94.99111068533485
curr_Factors:  [94.99111069]
mat_Sqrt:  [[0.15]]
grads:  [-0.35618424]
Stock Position:  -0.35618424178673846
Bond Position:  [34.83824136]


portfolio before change:  [0.86270471]
curr_Stock_Price:  95.39364778003007
curr_Factors:  [95.39364778]
mat_Sqrt:  [[0.15]]
grads:  [0.15606863]
Stock Position:  0.1560686282788065
Bond Position:  [-14.02525104]


portfolio before change:  [0.93920352]
curr_Stock_Price:  95.88942589467727
curr_Factors:  [95.88942589]
mat_Sqrt:  [[0.15]]
grads:  [0.07615491]
Stock Position:  0.07615490818167497
Bond Position:  [-6.36324691]


portfolio before change:  [0.94540857]
curr_Stock_Price:  95.97612765070436
curr_Factors:  [95.97612765]
mat_Sqrt:  [[0.15]]
grads:  [-0.21254263]
Stock Position:  -0.21254263203641147
Bond Position:  [21.34442735]


portfolio before change:  [1.04798866]
curr_Stock_Price:  95.49977131517592
curr_Factors:  [95.49977132]
mat_Sqrt:  [[0.15]]
grads:  [0.05657511]
Stock Position:  0.056575107962320986
Bond Position:  [-4.35492121]


portfolio before change:  [1.03219781]
curr_Stock_Price:  95.22546936875605
curr_Factors:  [95.22546937]
mat_Sqrt:  [[0.15]]
grads:  [0.00199336]
Stock Position:  0.0019933647909474153
Bond Position:  [0.84237871]


portfolio before change:  [1.03202898]
curr_Stock_Price:  95.11436183741274
curr_Factors:  [95.11436184]
mat_Sqrt:  [[0.15]]
grads:  [-0.07971508]
Stock Position:  -0.07971507521655125
Bond Position:  [8.61407749]


portfolio before change:  [0.98469183]
curr_Stock_Price:  95.7149451724876
curr_Factors:  [95.71494517]
mat_Sqrt:  [[0.15]]
grads:  [0.0509637]
Stock Position:  0.05096369592868446
Bond Position:  [-3.89329553]


portfolio before change:  [1.02742048]
curr_Stock_Price:  96.55813333661943
curr_Factors:  [96.55813334]
mat_Sqrt:  [[0.15]]
grads:  [-0.11476184]
Stock Position:  -0.11476184315193996
Bond Position:  [12.10860983]


portfolio before change:  [1.07414847]
curr_Stock_Price:  96.15755443813357
curr_Factors:  [96.15755444]
mat_Sqrt:  [[0.15]]
grads:  [0.30007131]
Stock Position:  0.3000713140663275
Bond Position:  [-27.77997525]


portfolio before change:  [1.35725527]
curr_Stock_Price:  97.106805801763
curr_Factors:  [97.1068058]
mat_Sqrt:  [[0.15]]
grads:  [0.00104309]
Stock Position:  0.0010430904361724124
Bond Position:  [1.25596409]


portfolio before change:  [1.35794379]
curr_Stock_Price:  97.6916294859446
curr_Factors:  [97.69162949]
mat_Sqrt:  [[0.15]]
grads:  [0.0333206]
Stock Position:  0.033320600443809745
Bond Position:  [-1.89719996]


portfolio before change:  [1.35053475]
curr_Stock_Price:  97.47283190496378
curr_Factors:  [97.4728319]
mat_Sqrt:  [[0.15]]
grads:  [-0.05721677]
Stock Position:  -0.057216766754945164
Bond Position:  [6.92761503]


portfolio before change:  [1.31926576]
curr_Stock_Price:  98.02689987220053
curr_Factors:  [98.02689987]
mat_Sqrt:  [[0.15]]
grads:  [0.01066559]
Stock Position:  0.010665585188605676
Bond Position:  [0.27375151]


portfolio before change:  [1.32078426]
curr_Stock_Price:  98.16766952584862
curr_Factors:  [98.16766953]
mat_Sqrt:  [[0.15]]
grads:  [-0.02787358]
Stock Position:  -0.027873578935894677
Bond Position:  [4.05706854]


portfolio before change:  [1.31678683]
curr_Stock_Price:  98.3201795524005
curr_Factors:  [98.32017955]
mat_Sqrt:  [[0.15]]
grads:  [-0.09127771]
Stock Position:  -0.09127770711405245
Bond Position:  [10.29122739]


portfolio before change:  [1.29791502]
curr_Stock_Price:  98.53397802979549
curr_Factors:  [98.53397803]
mat_Sqrt:  [[0.15]]
grads:  [-0.00845218]
Stock Position:  -0.00845218362170893
Bond Position:  [2.1307423]


portfolio before change:  [1.29899962]
curr_Stock_Price:  98.4214130630519
curr_Factors:  [98.42141306]
mat_Sqrt:  [[0.15]]
grads:  [-0.04727366]
Stock Position:  -0.04727366103474137
Bond Position:  [5.95174013]


portfolio before change:  [1.29095241]
curr_Stock_Price:  98.59950812153625
curr_Factors:  [98.59950812]
mat_Sqrt:  [[0.15]]
grads:  [0.05961233]
Stock Position:  0.059612333100518444
Bond Position:  [-4.58679432]


portfolio before change:  [1.30029476]
curr_Stock_Price:  98.76103572142978
curr_Factors:  [98.76103572]
mat_Sqrt:  [[0.15]]
grads:  [-0.020929]
Stock Position:  -0.02092899551910532
Bond Position:  [3.36726403]


portfolio before change:  [1.29140399]
curr_Stock_Price:  99.19589771928304
curr_Factors:  [99.19589772]
mat_Sqrt:  [[0.15]]
grads:  [0.02282744]
Stock Position:  0.022827441666667874
Bond Position:  [-0.97298457]


portfolio before change:  [1.28519843]
curr_Stock_Price:  98.9267151370835
curr_Factors:  [98.92671514]
mat_Sqrt:  [[0.15]]
grads:  [0.01708969]
Stock Position:  0.017089687786235024
Bond Position:  [-0.40542824]


portfolio before change:  [1.27963019]
curr_Stock_Price:  98.60237300447812
curr_Factors:  [98.602373]
mat_Sqrt:  [[0.15]]
grads:  [0.00636997]
Stock Position:  0.0063699692662934565
Bond Position:  [0.6515361]


portfolio before change:  [1.27792783]
curr_Stock_Price:  98.32873256806386
curr_Factors:  [98.32873257]
mat_Sqrt:  [[0.15]]
grads:  [0.01319696]
Stock Position:  0.013196963788381028
Bond Position:  [-0.0197129]


portfolio before change:  [1.2809033]
curr_Stock_Price:  98.55429247234251
curr_Factors:  [98.55429247]
mat_Sqrt:  [[0.15]]
grads:  [0.06012965]
Stock Position:  0.060129646446629
Bond Position:  [-4.64513146]


portfolio before change:  [1.23269185]
curr_Stock_Price:  97.75732925225789
curr_Factors:  [97.75732925]
mat_Sqrt:  [[0.15]]
grads:  [0.08718756]
Stock Position:  0.08718755536825169
Bond Position:  [-7.2905307]


portfolio before change:  [1.19237021]
curr_Stock_Price:  97.30008541459723
curr_Factors:  [97.30008541]
mat_Sqrt:  [[0.15]]
grads:  [0.01397363]
Stock Position:  0.013973631395896326
Bond Position:  [-0.16726532]


portfolio before change:  [1.19558545]
curr_Stock_Price:  97.53092727674998
curr_Factors:  [97.53092728]
mat_Sqrt:  [[0.15]]
grads:  [0.09102332]
Stock Position:  0.09102332271437918
Bond Position:  [-7.68200361]


portfolio before change:  [1.13159129]
curr_Stock_Price:  96.8331498398205
curr_Factors:  [96.83314984]
mat_Sqrt:  [[0.15]]
grads:  [-0.01039417]
Stock Position:  -0.01039417409323255
Bond Position:  [2.13809191]


portfolio before change:  [1.12743278]
curr_Stock_Price:  97.24608775509931
curr_Factors:  [97.24608776]
mat_Sqrt:  [[0.15]]
grads:  [0.01180787]
Stock Position:  0.01180786880982772
Bond Position:  [-0.02083627]


portfolio before change:  [1.1344607]
curr_Stock_Price:  97.8413880485495
curr_Factors:  [97.84138805]
mat_Sqrt:  [[0.15]]
grads:  [-0.10467666]
Stock Position:  -0.10467665954449222
Bond Position:  [11.37617037]


portfolio before change:  [1.14116395]
curr_Stock_Price:  97.78414307578188
curr_Factors:  [97.78414308]
mat_Sqrt:  [[0.15]]
grads:  [-0.08450237]
Stock Position:  -0.08450237004044168
Bond Position:  [9.40415579]


portfolio before change:  [1.14181795]
curr_Stock_Price:  97.78335940879938
curr_Factors:  [97.78335941]
mat_Sqrt:  [[0.15]]
grads:  [-0.00691973]
Stock Position:  -0.006919726882893759
Bond Position:  [1.81845209]


portfolio before change:  [1.1371912]
curr_Stock_Price:  98.46841637981404
curr_Factors:  [98.46841638]
mat_Sqrt:  [[0.15]]
grads:  [-0.07626341]
Stock Position:  -0.07626341007872006
Bond Position:  [8.64672842]


portfolio before change:  [1.1949955]
curr_Stock_Price:  97.71754699811721
curr_Factors:  [97.717547]
mat_Sqrt:  [[0.15]]
grads:  [-0.11596158]
Stock Position:  -0.11596157741030441
Bond Position:  [12.52647639]


portfolio before change:  [1.13250087]
curr_Stock_Price:  98.26322391654095
curr_Factors:  [98.26322392]
mat_Sqrt:  [[0.15]]
grads:  [0.06813899]
Stock Position:  0.06813899085630083
Bond Position:  [-5.56305605]


portfolio before change:  [1.13433272]
curr_Stock_Price:  98.29521078798695
curr_Factors:  [98.29521079]
mat_Sqrt:  [[0.15]]
grads:  [0.01517666]
Stock Position:  0.015176662674119884
Bond Position:  [-0.35746054]


portfolio before change:  [1.13862287]
curr_Stock_Price:  98.5793637287333
curr_Factors:  [98.57936373]
mat_Sqrt:  [[0.15]]
grads:  [0.05685812]
Stock Position:  0.05685811987170207
Bond Position:  [-4.46641441]


portfolio before change:  [1.12430497]
curr_Stock_Price:  98.3324554731952
curr_Factors:  [98.33245547]
mat_Sqrt:  [[0.15]]
grads:  [-0.11365073]
Stock Position:  -0.11365073318027231
Bond Position:  [12.29986063]


portfolio before change:  [1.00959332]
curr_Stock_Price:  99.34855469529619
curr_Factors:  [99.3485547]
mat_Sqrt:  [[0.15]]
grads:  [-0.0373783]
Stock Position:  -0.03737829766724172
Bond Position:  [4.72307317]


portfolio before change:  [0.98315078]
curr_Stock_Price:  100.06388245204192
curr_Factors:  [100.06388245]
mat_Sqrt:  [[0.15]]
grads:  [-0.00487923]
Stock Position:  -0.004879232694151728
Bond Position:  [1.47138575]


portfolio before change:  [0.98381293]
curr_Stock_Price:  99.94702322666015
curr_Factors:  [99.94702323]
mat_Sqrt:  [[0.15]]
grads:  [0.01354235]
Stock Position:  0.0135423453171629
Bond Position:  [-0.36970417]


portfolio before change:  [0.98575663]
curr_Stock_Price:  100.09225682351102
curr_Factors:  [100.09225682]
mat_Sqrt:  [[0.15]]
grads:  [0.05874087]
Stock Position:  0.058740870361134956
Bond Position:  [-4.89374965]


portfolio before change:  [0.98419773]
curr_Stock_Price:  100.07092528025325
curr_Factors:  [100.07092528]
mat_Sqrt:  [[0.15]]
grads:  [0.07848843]
Stock Position:  0.07848843322337824
Bond Position:  [-6.87021241]


portfolio before change:  [0.93683359]
curr_Stock_Price:  99.4729424866876
curr_Factors:  [99.47294249]
mat_Sqrt:  [[0.15]]
grads:  [-0.04193496]
Stock Position:  -0.0419349577799356
Bond Position:  [5.10822724]


portfolio before change:  [0.94767827]
curr_Stock_Price:  99.22194898347576
curr_Factors:  [99.22194898]
mat_Sqrt:  [[0.15]]
grads:  [-0.03092154]
Stock Position:  -0.030921538348344994
Bond Position:  [4.01577357]


portfolio before change:  [0.95830697]
curr_Stock_Price:  98.88633461890039
curr_Factors:  [98.88633462]
mat_Sqrt:  [[0.15]]
grads:  [-0.06172006]
Stock Position:  -0.06172005695512263
Bond Position:  [7.06157718]


portfolio before change:  [1.01933419]
curr_Stock_Price:  97.90471125451516
curr_Factors:  [97.90471125]
mat_Sqrt:  [[0.15]]
grads:  [-0.09541764]
Stock Position:  -0.0954176381380211
Bond Position:  [10.3611705]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.01933419]
Stock Price:  97.10949291651151
PL:  [1.01933419]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-5.34048743e-02]
 [ 4.83699455e-03]
 [ 3.85153966e-03]
 [ 2.30695872e-03]
 [ 6.02269212e-03]
 [ 1.19204571e-02]
 [ 4.29904087e-04]
 [ 6.72339466e-03]
 [-7.15932019e-03]
 [ 1.03611819e-02]
 [ 9.86941631e-03]
 [-1.07696253e-02]
 [ 1.40180652e-02]
 [ 4.58091137e-03]
 [-7.01593037e-05]
 [-1.00969225e-02]
 [ 1.34247978e-02]
 [ 2.26893739e-02]
 [ 1.82606732e-02]
 [-2.01305600e-03]
 [ 5.02064338e-02]
 [-1.21189365e-02]
 [ 7.57203282e-03]
 [-2.55180964e-03]
 [ 1.76431924e-02]
 [ 1.75697267e-02]
 [ 9.56921997e-03]
 [ 7.35782429e-03]
 [ 5.20068248e-03]
 [-1.84373260e-02]
 [-5.66866170e-03]
 [ 2.47364488e-02]
 [ 7.61930153e-03]
 [-4.90060406e-04]
 [-6.48598901e-03]
 [-4.35901887e-03]
 [-3.74666264e-03]
 [ 1.46171722e-03]
 [ 3.77522381e-03]
 [-7.38955001e-03]
 [-4.30895225e-02]
 [-2.96811161e-03]
 [ 1.38809078e-02]
 [-1.36175054e-02]
 [-1.71443286e-03]
 [ 2.56263612e-03]
 [-1.36041522e-02]
 [ 1.09413176e-02]
 [ 2.00021582e-02]
 [-1.22641169e-02]
 [-4.35643924e-03]
 [ 3.68468060e-03]
 [ 3.38391648e-03]
 [-7.04224283e-03]
 [-1.35490836e-02]
 [ 1.24605532e-02]
 [-3.04049992e-02]
 [-9.80781326e-03]
 [ 1.97554247e-02]
 [-4.62976200e-03]
 [ 1.30235330e-02]
 [-1.50781980e-02]
 [-1.27580817e-02]
 [-3.22358637e-03]
 [-9.66520390e-03]
 [-1.80331793e-02]
 [ 2.84764758e-02]
 [ 2.41712702e-03]
 [ 6.49898746e-03]
 [-1.36315482e-02]
 [-8.12626357e-03]
 [-7.27936242e-03]
 [ 1.62276007e-03]
 [ 7.84805914e-03]
 [-2.03228437e-04]
 [-1.29141418e-02]
 [ 5.14075861e-03]
 [-5.68946286e-03]
 [ 1.10010937e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.88228297]
curr_Stock_Price:  100.43805824592673
curr_Factors:  [100.43805825]
mat_Sqrt:  [[0.15]]
grads:  [-0.3560325]
Stock Position:  -0.3560324954073754
Bond Position:  [44.64149548]


portfolio before change:  [8.39713082]
curr_Stock_Price:  101.80855768807174
curr_Factors:  [101.80855769]
mat_Sqrt:  [[0.15]]
grads:  [0.03224663]
Stock Position:  0.032246630320450165
Bond Position:  [5.11414789]


portfolio before change:  [8.3737999]
curr_Stock_Price:  101.07513016774476
curr_Factors:  [101.07513017]
mat_Sqrt:  [[0.15]]
grads:  [0.02567693]
Stock Position:  0.025676931084585415
Bond Position:  [5.77850074]


portfolio before change:  [8.36144229]
curr_Stock_Price:  100.57979171003637
curr_Factors:  [100.57979171]
mat_Sqrt:  [[0.15]]
grads:  [0.01537972]
Stock Position:  0.015379724784266444
Bond Position:  [6.81455278]


portfolio before change:  [8.37084924]
curr_Stock_Price:  101.16374378850601
curr_Factors:  [101.16374379]
mat_Sqrt:  [[0.15]]
grads:  [0.04015128]
Stock Position:  0.04015128077775739
Bond Position:  [4.30899536]


portfolio before change:  [8.36080341]
curr_Stock_Price:  100.90683676743107
curr_Factors:  [100.90683677]
mat_Sqrt:  [[0.15]]
grads:  [0.07946971]
Stock Position:  0.07946971369061147
Bond Position:  [0.34176598]


portfolio before change:  [8.37226519]
curr_Stock_Price:  101.05079623539226
curr_Factors:  [101.05079624]
mat_Sqrt:  [[0.15]]
grads:  [0.00286603]
Stock Position:  0.00286602724466541
Bond Position:  [8.08265086]


portfolio before change:  [8.37483926]
curr_Stock_Price:  101.7726609624359
curr_Factors:  [101.77266096]
mat_Sqrt:  [[0.15]]
grads:  [0.04482263]
Stock Position:  0.0448226310868752
Bond Position:  [3.81312082]


portfolio before change:  [8.36472827]
curr_Stock_Price:  101.5417661187327
curr_Factors:  [101.54176612]
mat_Sqrt:  [[0.15]]
grads:  [-0.0477288]
Stock Position:  -0.04772880128457908
Bond Position:  [13.21119505]


portfolio before change:  [8.32610115]
curr_Stock_Price:  102.36837073944211
curr_Factors:  [102.36837074]
mat_Sqrt:  [[0.15]]
grads:  [0.06907455]
Stock Position:  0.06907454588056741
Bond Position:  [1.25505243]


portfolio before change:  [8.3336516]
curr_Stock_Price:  102.47654379257048
curr_Factors:  [102.47654379]
mat_Sqrt:  [[0.15]]
grads:  [0.06579611]
Stock Position:  0.06579610870433249
Bond Position:  [1.59109378]


portfolio before change:  [8.32266518]
curr_Stock_Price:  102.30805574418679
curr_Factors:  [102.30805574]
mat_Sqrt:  [[0.15]]
grads:  [-0.0717975]
Stock Position:  -0.07179750189203281
Bond Position:  [15.66812801]


portfolio before change:  [8.37897369]
curr_Stock_Price:  101.53742698993027
curr_Factors:  [101.53742699]
mat_Sqrt:  [[0.15]]
grads:  [0.09345377]
Stock Position:  0.09345376804708776
Bond Position:  [-1.11008146]


portfolio before change:  [8.39132038]
curr_Stock_Price:  101.67028490495166
curr_Factors:  [101.6702849]
mat_Sqrt:  [[0.15]]
grads:  [0.03053941]
Stock Position:  0.03053940914066122
Bond Position:  [5.28636995]


portfolio before change:  [8.3932121]
curr_Stock_Price:  101.72140937588371
curr_Factors:  [101.72140938]
mat_Sqrt:  [[0.15]]
grads:  [-0.00046773]
Stock Position:  -0.0004677286915099124
Bond Position:  [8.44079012]


portfolio before change:  [8.39371407]
curr_Stock_Price:  101.77614234551652
curr_Factors:  [101.77614235]
mat_Sqrt:  [[0.15]]
grads:  [-0.06731282]
Stock Position:  -0.0673128168872019
Bond Position:  [15.2445529]


portfolio before change:  [8.43542662]
curr_Stock_Price:  101.17061518959503
curr_Factors:  [101.17061519]
mat_Sqrt:  [[0.15]]
grads:  [0.08949865]
Stock Position:  0.0894986522085257
Bond Position:  [-0.61920708]


portfolio before change:  [8.46349049]
curr_Stock_Price:  101.48461513735057
curr_Factors:  [101.48461514]
mat_Sqrt:  [[0.15]]
grads:  [0.15126249]
Stock Position:  0.15126249250578808
Bond Position:  [-6.88732535]


portfolio before change:  [8.50886776]
curr_Stock_Price:  101.78745123137487
curr_Factors:  [101.78745123]
mat_Sqrt:  [[0.15]]
grads:  [0.12173782]
Stock Position:  0.12173782149774331
Bond Position:  [-3.88251481]


portfolio before change:  [8.62261153]
curr_Stock_Price:  102.72377843751089
curr_Factors:  [102.72377844]
mat_Sqrt:  [[0.15]]
grads:  [-0.01342037]
Stock Position:  -0.013420373357323311
Bond Position:  [10.00120299]


portfolio before change:  [8.63016788]
curr_Stock_Price:  102.2073058646184
curr_Factors:  [102.20730586]
mat_Sqrt:  [[0.15]]
grads:  [0.33470956]
Stock Position:  0.33470955846030614
Bond Position:  [-25.57959434]


portfolio before change:  [8.72209409]
curr_Stock_Price:  102.48672717321323
curr_Factors:  [102.48672717]
mat_Sqrt:  [[0.15]]
grads:  [-0.08079291]
Stock Position:  -0.0807929096735629
Bond Position:  [17.00229498]


portfolio before change:  [8.72436992]
curr_Stock_Price:  102.47171152707755
curr_Factors:  [102.47171153]
mat_Sqrt:  [[0.15]]
grads:  [0.05048022]
Stock Position:  0.050480218776652014
Bond Position:  [3.55157551]


portfolio before change:  [8.73897745]
curr_Stock_Price:  102.756685386398
curr_Factors:  [102.75668539]
mat_Sqrt:  [[0.15]]
grads:  [-0.01701206]
Stock Position:  -0.017012064238864085
Bond Position:  [10.48708078]


portfolio before change:  [8.73994763]
curr_Stock_Price:  102.73818547438508
curr_Factors:  [102.73818547]
mat_Sqrt:  [[0.15]]
grads:  [0.11762128]
Stock Position:  0.11762128241851229
Bond Position:  [-3.3442495]


portfolio before change:  [8.77475825]
curr_Stock_Price:  103.03591762304538
curr_Factors:  [103.03591762]
mat_Sqrt:  [[0.15]]
grads:  [0.11713151]
Stock Position:  0.11713151165424837
Bond Position:  [-3.29399454]


portfolio before change:  [8.75925625]
curr_Stock_Price:  102.90532839937553
curr_Factors:  [102.9053284]
mat_Sqrt:  [[0.15]]
grads:  [0.0637948]
Stock Position:  0.06379479979926987
Bond Position:  [2.19443143]


portfolio before change:  [8.69631433]
curr_Stock_Price:  101.91654754795928
curr_Factors:  [101.91654755]
mat_Sqrt:  [[0.15]]
grads:  [0.04905216]
Stock Position:  0.0490521619098027
Bond Position:  [3.69708734]


portfolio before change:  [8.69780415]
curr_Stock_Price:  101.94220877857605
curr_Factors:  [101.94220878]
mat_Sqrt:  [[0.15]]
grads:  [0.03467122]
Stock Position:  0.034671216555504245
Bond Position:  [5.16334375]


portfolio before change:  [8.70524941]
curr_Stock_Price:  102.14763971838377
curr_Factors:  [102.14763972]
mat_Sqrt:  [[0.15]]
grads:  [-0.12291551]
Stock Position:  -0.12291550674096509
Bond Position:  [21.2607783]


portfolio before change:  [8.69790364]
curr_Stock_Price:  102.21821345115858
curr_Factors:  [102.21821345]
mat_Sqrt:  [[0.15]]
grads:  [-0.03779108]
Stock Position:  -0.03779107798053587
Bond Position:  [12.56084012]


portfolio before change:  [8.71734319]
curr_Stock_Price:  101.72459236757385
curr_Factors:  [101.72459237]
mat_Sqrt:  [[0.15]]
grads:  [0.16490966]
Stock Position:  0.16490965856550457
Bond Position:  [-8.05802461]


portfolio before change:  [8.71960791]
curr_Stock_Price:  101.74137953016366
curr_Factors:  [101.74137953]
mat_Sqrt:  [[0.15]]
grads:  [0.05079534]
Stock Position:  0.05079534354190449
Bond Position:  [3.55161959]


portfolio before change:  [8.74810748]
curr_Stock_Price:  102.29807595014427
curr_Factors:  [102.29807595]
mat_Sqrt:  [[0.15]]
grads:  [-0.00326707]
Stock Position:  -0.0032670693752777833
Bond Position:  [9.08232239]


portfolio before change:  [8.74518618]
curr_Stock_Price:  103.36599342362565
curr_Factors:  [103.36599342]
mat_Sqrt:  [[0.15]]
grads:  [-0.04323993]
Stock Position:  -0.04323992672770205
Bond Position:  [13.21472417]


portfolio before change:  [8.73222792]
curr_Stock_Price:  103.68477768544233
curr_Factors:  [103.68477769]
mat_Sqrt:  [[0.15]]
grads:  [-0.02906013]
Stock Position:  -0.0290601258200704
Bond Position:  [11.74532061]


portfolio before change:  [8.72003453]
curr_Stock_Price:  104.12963106087695
curr_Factors:  [104.12963106]
mat_Sqrt:  [[0.15]]
grads:  [-0.02497775]
Stock Position:  -0.02497775095073747
Bond Position:  [11.32095852]


portfolio before change:  [8.72267761]
curr_Stock_Price:  104.0521423155535
curr_Factors:  [104.05214232]
mat_Sqrt:  [[0.15]]
grads:  [0.00974478]
Stock Position:  0.00974478149166149
Bond Position:  [7.70871222]


portfolio before change:  [8.7195096]
curr_Stock_Price:  103.67760146221222
curr_Factors:  [103.67760146]
mat_Sqrt:  [[0.15]]
grads:  [0.02516816]
Stock Position:  0.025168158756299863
Bond Position:  [6.11013527]


portfolio before change:  [8.72588091]
curr_Stock_Price:  103.91557747701991
curr_Factors:  [103.91557748]
mat_Sqrt:  [[0.15]]
grads:  [-0.04926367]
Stock Position:  -0.0492636667409704
Bond Position:  [13.84514329]


portfolio before change:  [8.74034336]
curr_Stock_Price:  103.63957080502146
curr_Factors:  [103.63957081]
mat_Sqrt:  [[0.15]]
grads:  [-0.28726348]
Stock Position:  -0.28726348349385306
Bond Position:  [38.5122075]


portfolio before change:  [8.86664504]
curr_Stock_Price:  103.20827830842006
curr_Factors:  [103.20827831]
mat_Sqrt:  [[0.15]]
grads:  [-0.01978741]
Stock Position:  -0.019787410760252203
Bond Position:  [10.90886963]


portfolio before change:  [8.86299972]
curr_Stock_Price:  103.42695966949746
curr_Factors:  [103.42695967]
mat_Sqrt:  [[0.15]]
grads:  [0.09253939]
Stock Position:  0.09253938505476642
Bond Position:  [-0.70806752]


portfolio before change:  [8.91584591]
curr_Stock_Price:  103.99850489468204
curr_Factors:  [103.99850489]
mat_Sqrt:  [[0.15]]
grads:  [-0.09078337]
Stock Position:  -0.09078336961704721
Bond Position:  [18.35718062]


portfolio before change:  [8.95160227]
curr_Stock_Price:  103.61727865300266
curr_Factors:  [103.61727865]
mat_Sqrt:  [[0.15]]
grads:  [-0.01142955]
Stock Position:  -0.01142955241617127
Bond Position:  [10.13590139]


portfolio before change:  [8.94908328]
curr_Stock_Price:  103.89309973917716
curr_Factors:  [103.89309974]
mat_Sqrt:  [[0.15]]
grads:  [0.01708424]
Stock Position:  0.01708424082151884
Bond Position:  [7.17414854]


portfolio before change:  [8.95102808]
curr_Stock_Price:  103.98068969748842
curr_Factors:  [103.9806897]
mat_Sqrt:  [[0.15]]
grads:  [-0.09069435]
Stock Position:  -0.09069434832977603
Bond Position:  [18.38148897]


portfolio before change:  [8.91705818]
curr_Stock_Price:  104.36791093761039
curr_Factors:  [104.36791094]
mat_Sqrt:  [[0.15]]
grads:  [0.07294212]
Stock Position:  0.07294211756672206
Bond Position:  [1.30424175]


portfolio before change:  [8.94515472]
curr_Stock_Price:  104.75198278993464
curr_Factors:  [104.75198279]
mat_Sqrt:  [[0.15]]
grads:  [0.13334772]
Stock Position:  0.13334772103176987
Bond Position:  [-5.02328346]


portfolio before change:  [8.99438796]
curr_Stock_Price:  105.1235467748292
curr_Factors:  [105.12354677]
mat_Sqrt:  [[0.15]]
grads:  [-0.08176078]
Stock Position:  -0.08176077961909628
Bond Position:  [17.5893711]


portfolio before change:  [8.98634955]
curr_Stock_Price:  105.2353092134557
curr_Factors:  [105.23530921]
mat_Sqrt:  [[0.15]]
grads:  [-0.02904293]
Stock Position:  -0.029042928233426493
Bond Position:  [12.04269108]


portfolio before change:  [8.96006983]
curr_Stock_Price:  106.16608344164817
curr_Factors:  [106.16608344]
mat_Sqrt:  [[0.15]]
grads:  [0.02456454]
Stock Position:  0.024564537326654184
Bond Position:  [6.35214911]


portfolio before change:  [8.95019236]
curr_Stock_Price:  105.74781823760242
curr_Factors:  [105.74781824]
mat_Sqrt:  [[0.15]]
grads:  [0.02255944]
Stock Position:  0.02255944321883921
Bond Position:  [6.56458046]


portfolio before change:  [8.97486348]
curr_Stock_Price:  106.82323579594308
curr_Factors:  [106.8232358]
mat_Sqrt:  [[0.15]]
grads:  [-0.04694829]
Stock Position:  -0.046948285542635006
Bond Position:  [13.99003126]


portfolio before change:  [8.9485273]
curr_Stock_Price:  107.40282202140833
curr_Factors:  [107.40282202]
mat_Sqrt:  [[0.15]]
grads:  [-0.09032722]
Stock Position:  -0.09032722420621113
Bond Position:  [18.64992609]


portfolio before change:  [9.05633301]
curr_Stock_Price:  106.22222505735282
curr_Factors:  [106.22222506]
mat_Sqrt:  [[0.15]]
grads:  [0.08307035]
Stock Position:  0.08307035494635574
Bond Position:  [0.23241507]


portfolio before change:  [9.0512936]
curr_Stock_Price:  106.16138583015058
curr_Factors:  [106.16138583]
mat_Sqrt:  [[0.15]]
grads:  [-0.20269999]
Stock Position:  -0.2026999945165517
Bond Position:  [30.57020592]


portfolio before change:  [9.06381298]
curr_Stock_Price:  106.10904896428251
curr_Factors:  [106.10904896]
mat_Sqrt:  [[0.15]]
grads:  [-0.06538542]
Stock Position:  -0.0653854217396999
Bond Position:  [16.0017979]


portfolio before change:  [9.06493653]
curr_Stock_Price:  106.10716158946406
curr_Factors:  [106.10716159]
mat_Sqrt:  [[0.15]]
grads:  [0.13170283]
Stock Position:  0.13170283145587347
Bond Position:  [-4.90967709]


portfolio before change:  [8.95741304]
curr_Stock_Price:  105.29308175163665
curr_Factors:  [105.29308175]
mat_Sqrt:  [[0.15]]
grads:  [-0.03086508]
Stock Position:  -0.03086508000140082
Bond Position:  [12.20729244]


portfolio before change:  [8.97456144]
curr_Stock_Price:  104.76220933532835
curr_Factors:  [104.76220934]
mat_Sqrt:  [[0.15]]
grads:  [0.08682355]
Stock Position:  0.08682355324588788
Bond Position:  [-0.12126582]


portfolio before change:  [8.88150508]
curr_Stock_Price:  103.69050954517927
curr_Factors:  [103.69050955]
mat_Sqrt:  [[0.15]]
grads:  [-0.10052132]
Stock Position:  -0.10052132017703867
Bond Position:  [19.30461199]


portfolio before change:  [8.86196988]
curr_Stock_Price:  103.89685157722771
curr_Factors:  [103.89685158]
mat_Sqrt:  [[0.15]]
grads:  [-0.08505388]
Stock Position:  -0.08505387785283856
Bond Position:  [17.69880001]


portfolio before change:  [8.92077044]
curr_Stock_Price:  103.21852450682309
curr_Factors:  [103.21852451]
mat_Sqrt:  [[0.15]]
grads:  [-0.02149058]
Stock Position:  -0.021490575814746556
Bond Position:  [11.13899597]


portfolio before change:  [8.92473436]
curr_Stock_Price:  103.0664711190996
curr_Factors:  [103.06647112]
mat_Sqrt:  [[0.15]]
grads:  [-0.06443469]
Stock Position:  -0.06443469268928942
Bond Position:  [15.56579076]


portfolio before change:  [8.92209501]
curr_Stock_Price:  103.12253171436735
curr_Factors:  [103.12253171]
mat_Sqrt:  [[0.15]]
grads:  [-0.1202212]
Stock Position:  -0.12022119554357803
Bond Position:  [21.31960906]


portfolio before change:  [8.96356833]
curr_Stock_Price:  102.78864046262343
curr_Factors:  [102.78864046]
mat_Sqrt:  [[0.15]]
grads:  [0.18984317]
Stock Position:  0.18984317178888582
Bond Position:  [-10.5501532]


portfolio before change:  [8.92486769]
curr_Stock_Price:  102.58825800095411
curr_Factors:  [102.588258]
mat_Sqrt:  [[0.15]]
grads:  [0.01611418]
Stock Position:  0.01611418011398794
Bond Position:  [7.27174202]


portfolio before change:  [8.91474007]
curr_Stock_Price:  101.93156208849129
curr_Factors:  [101.93156209]
mat_Sqrt:  [[0.15]]
grads:  [0.04332658]
Stock Position:  0.04332658305546943
Bond Position:  [4.49839378]


portfolio before change:  [8.90947817]
curr_Stock_Price:  101.80362540287464
curr_Factors:  [101.8036254]
mat_Sqrt:  [[0.15]]
grads:  [-0.09087699]
Stock Position:  -0.09087698803428523
Bond Position:  [18.16108501]


portfolio before change:  [8.914028]
curr_Stock_Price:  101.76605006200802
curr_Factors:  [101.76605006]
mat_Sqrt:  [[0.15]]
grads:  [-0.05417509]
Stock Position:  -0.054175090463869646
Bond Position:  [14.42721297]


portfolio before change:  [8.91103229]
curr_Stock_Price:  101.83799170665978
curr_Factors:  [101.83799171]
mat_Sqrt:  [[0.15]]
grads:  [-0.04852908]
Stock Position:  -0.04852908282596052
Bond Position:  [13.85313662]


portfolio before change:  [8.89517318]
curr_Stock_Price:  102.18262957042576
curr_Factors:  [102.18262957]
mat_Sqrt:  [[0.15]]
grads:  [0.0108184]
Stock Position:  0.010818400476817955
Bond Position:  [7.78972057]


portfolio before change:  [8.89869057]
curr_Stock_Price:  102.46275643205936
curr_Factors:  [102.46275643]
mat_Sqrt:  [[0.15]]
grads:  [0.05232039]
Stock Position:  0.052320394296469466
Bond Position:  [3.53779876]


portfolio before change:  [8.90695146]
curr_Stock_Price:  102.61642053262997
curr_Factors:  [102.61642053]
mat_Sqrt:  [[0.15]]
grads:  [-0.00135486]
Stock Position:  -0.0013548562468627813
Bond Position:  [9.04598196]


portfolio before change:  [8.90780175]
curr_Stock_Price:  102.4061423810345
curr_Factors:  [102.40614238]
mat_Sqrt:  [[0.15]]
grads:  [-0.08609428]
Stock Position:  -0.08609427872527028
Bond Position:  [17.72438471]


portfolio before change:  [8.91762936]
curr_Stock_Price:  102.30486032148794
curr_Factors:  [102.30486032]
mat_Sqrt:  [[0.15]]
grads:  [0.03427172]
Stock Position:  0.034271724094370314
Bond Position:  [5.41146541]


portfolio before change:  [8.89808534]
curr_Stock_Price:  101.7247246777934
curr_Factors:  [101.72472468]
mat_Sqrt:  [[0.15]]
grads:  [-0.03792975]
Stock Position:  -0.03792975240056649
Bond Position:  [12.75647896]


portfolio before change:  [8.92227732]
curr_Stock_Price:  101.10793519330373
curr_Factors:  [101.10793519]
mat_Sqrt:  [[0.15]]
grads:  [0.07334062]
Stock Position:  0.07334062495068701
Bond Position:  [1.50695816]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.92227732]
Stock Price:  101.7090421252524
PL:  [7.21323519]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.52180377e-02]
 [-3.45720976e-04]
 [-5.99777991e-05]
 [ 1.27876302e-03]
 [-2.30852989e-03]
 [ 7.02317172e-03]
 [ 8.37727134e-04]
 [ 1.14784060e-02]
 [ 1.43172813e-02]
 [-1.96670679e-02]
 [ 7.37343157e-03]
 [-4.99093073e-03]
 [-7.02968756e-03]
 [ 4.34655611e-03]
 [ 5.41401612e-03]
 [-4.21839323e-03]
 [ 6.27536205e-03]
 [ 9.98171416e-03]
 [ 2.42638905e-02]
 [ 1.04544872e-02]
 [ 7.71795413e-02]
 [-1.33954408e-02]
 [ 3.01951759e-03]
 [ 1.28086819e-02]
 [ 1.08835168e-02]
 [-3.19199286e-03]
 [ 1.14886806e-02]
 [ 2.89425157e-04]
 [ 4.15831671e-03]
 [-2.76480947e-02]
 [-5.08604119e-03]
 [ 1.40576323e-02]
 [ 8.97725239e-03]
 [ 5.38627672e-03]
 [ 3.17031057e-03]
 [-4.65046333e-03]
 [-6.54808437e-03]
 [ 8.76160635e-03]
 [ 6.55065954e-04]
 [-9.98286123e-03]
 [-2.90961672e-03]
 [-2.72895604e-03]
 [ 8.66905862e-03]
 [-1.41814673e-02]
 [ 2.70892327e-03]
 [-5.73351442e-04]
 [-1.37063306e-02]
 [-5.08598834e-03]
 [-2.49786063e-03]
 [ 1.07940540e-02]
 [-3.09571558e-03]
 [ 3.34654108e-03]
 [ 2.38932115e-03]
 [-1.90485753e-03]
 [ 2.44185881e-03]
 [ 8.55386062e-03]
 [ 5.84549341e-03]
 [-2.10951629e-02]
 [ 1.34461831e-02]
 [ 6.12382622e-03]
 [ 9.61597096e-03]
 [-1.26435538e-02]
 [-1.25413200e-02]
 [-2.12342136e-03]
 [-1.34186806e-02]
 [ 1.90754388e-02]
 [ 1.26071020e-02]
 [ 2.14545114e-03]
 [ 7.37224002e-03]
 [-1.63186929e-02]
 [-5.52705137e-03]
 [-1.20383506e-03]
 [ 1.66068913e-03]
 [ 8.73645311e-03]
 [ 7.59621572e-03]
 [-6.00992216e-03]
 [-9.53167979e-04]
 [-8.35947256e-03]
 [ 5.25535746e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.03468395]
curr_Stock_Price:  99.73641758104537
curr_Factors:  [99.73641758]
mat_Sqrt:  [[0.15]]
grads:  [-0.23478692]
Stock Position:  -0.2347869178701986
Bond Position:  [21.38212214]


portfolio before change:  [-2.03835697]
curr_Stock_Price:  99.75775370926323
curr_Factors:  [99.75775371]
mat_Sqrt:  [[0.15]]
grads:  [-0.00230481]
Stock Position:  -0.0023048065091428494
Bond Position:  [-1.80843465]


portfolio before change:  [-2.03813383]
curr_Stock_Price:  99.61190054957035
curr_Factors:  [99.61190055]
mat_Sqrt:  [[0.15]]
grads:  [-0.00039985]
Stock Position:  -0.00039985199368149213
Bond Position:  [-1.99830382]


portfolio before change:  [-2.03822913]
curr_Stock_Price:  99.53787699964818
curr_Factors:  [99.537877]
mat_Sqrt:  [[0.15]]
grads:  [0.00852509]
Stock Position:  0.00852508682493381
Bond Position:  [-2.88679818]


portfolio before change:  [-2.03998461]
curr_Stock_Price:  99.35312324102634
curr_Factors:  [99.35312324]
mat_Sqrt:  [[0.15]]
grads:  [-0.0153902]
Stock Position:  -0.015390199297602401
Bond Position:  [-0.51092024]


portfolio before change:  [-2.03150879]
curr_Stock_Price:  98.80032043557668
curr_Factors:  [98.80032044]
mat_Sqrt:  [[0.15]]
grads:  [0.04682114]
Stock Position:  0.04682114479048039
Bond Position:  [-6.6574529]


portfolio before change:  [-2.04829355]
curr_Stock_Price:  98.45072081708439
curr_Factors:  [98.45072082]
mat_Sqrt:  [[0.15]]
grads:  [0.00558485]
Stock Position:  0.00558484756207403
Bond Position:  [-2.59812582]


portfolio before change:  [-2.04730042]
curr_Stock_Price:  98.65762405275491
curr_Factors:  [98.65762405]
mat_Sqrt:  [[0.15]]
grads:  [0.07652271]
Stock Position:  0.07652270671282338
Bond Position:  [-9.59684885]


portfolio before change:  [-2.04083902]
curr_Stock_Price:  98.74990023209864
curr_Factors:  [98.74990023]
mat_Sqrt:  [[0.15]]
grads:  [0.09544854]
Stock Position:  0.09544854177735439
Bond Position:  [-11.46637299]


portfolio before change:  [-1.99351083]
curr_Stock_Price:  99.25325891151559
curr_Factors:  [99.25325891]
mat_Sqrt:  [[0.15]]
grads:  [-0.13111379]
Stock Position:  -0.13111378606998372
Bond Position:  [11.01995972]


portfolio before change:  [-2.04608484]
curr_Stock_Price:  99.65949212319481
curr_Factors:  [99.65949212]
mat_Sqrt:  [[0.15]]
grads:  [0.04915621]
Stock Position:  0.049156210479078304
Bond Position:  [-6.94496781]


portfolio before change:  [-2.03803034]
curr_Stock_Price:  99.8321777948854
curr_Factors:  [99.83217779]
mat_Sqrt:  [[0.15]]
grads:  [-0.03327287]
Stock Position:  -0.03327287152682659
Bond Position:  [1.28367288]


portfolio before change:  [-2.01943027]
curr_Stock_Price:  99.2755729896418
curr_Factors:  [99.27557299]
mat_Sqrt:  [[0.15]]
grads:  [-0.04686458]
Stock Position:  -0.046864583739088424
Bond Position:  [2.63307813]


portfolio before change:  [-2.04188232]
curr_Stock_Price:  99.75816824548764
curr_Factors:  [99.75816825]
mat_Sqrt:  [[0.15]]
grads:  [0.02897704]
Stock Position:  0.02897704075127942
Bond Position:  [-4.93257883]


portfolio before change:  [-2.02989399]
curr_Stock_Price:  100.18252595620898
curr_Factors:  [100.18252596]
mat_Sqrt:  [[0.15]]
grads:  [0.03609344]
Stock Position:  0.03609344082572468
Bond Position:  [-5.64582606]


portfolio before change:  [-2.02552781]
curr_Stock_Price:  100.31327147335615
curr_Factors:  [100.31327147]
mat_Sqrt:  [[0.15]]
grads:  [-0.02812262]
Stock Position:  -0.028122621519555212
Bond Position:  [0.79554436]


portfolio before change:  [-2.01258866]
curr_Stock_Price:  99.85494207630758
curr_Factors:  [99.85494208]
mat_Sqrt:  [[0.15]]
grads:  [0.04183575]
Stock Position:  0.04183574701725433
Bond Position:  [-6.19009475]


portfolio before change:  [-2.00804305]
curr_Stock_Price:  99.97284378361509
curr_Factors:  [99.97284378]
mat_Sqrt:  [[0.15]]
grads:  [0.06654476]
Stock Position:  0.06654476105174197
Bond Position:  [-8.66071205]


portfolio before change:  [-2.03221149]
curr_Stock_Price:  99.61778752979299
curr_Factors:  [99.61778753]
mat_Sqrt:  [[0.15]]
grads:  [0.16175927]
Stock Position:  0.16175927029221798
Bond Position:  [-18.14631211]


portfolio before change:  [-2.08597544]
curr_Stock_Price:  99.29242896129301
curr_Factors:  [99.29242896]
mat_Sqrt:  [[0.15]]
grads:  [0.06969658]
Stock Position:  0.06969658107075882
Bond Position:  [-9.00631826]


portfolio before change:  [-2.0230988]
curr_Stock_Price:  100.20265368570803
curr_Factors:  [100.20265369]
mat_Sqrt:  [[0.15]]
grads:  [0.51453028]
Stock Position:  0.5145302756610006
Bond Position:  [-53.58039782]


portfolio before change:  [-1.9502692]
curr_Stock_Price:  100.35070810552749
curr_Factors:  [100.35070811]
mat_Sqrt:  [[0.15]]
grads:  [-0.08930294]
Stock Position:  -0.08930293841668156
Bond Position:  [7.01134391]


portfolio before change:  [-1.99705993]
curr_Stock_Price:  100.8795703983691
curr_Factors:  [100.8795704]
mat_Sqrt:  [[0.15]]
grads:  [0.02013012]
Stock Position:  0.020130117245078374
Bond Position:  [-4.02777751]


portfolio before change:  [-2.02082043]
curr_Stock_Price:  99.71173029666507
curr_Factors:  [99.7117303]
mat_Sqrt:  [[0.15]]
grads:  [0.08539121]
Stock Position:  0.0853912127321834
Bond Position:  [-10.53532601]


portfolio before change:  [-2.03028767]
curr_Stock_Price:  99.60857264708798
curr_Factors:  [99.60857265]
mat_Sqrt:  [[0.15]]
grads:  [0.07255678]
Stock Position:  0.07255677864584051
Bond Position:  [-9.25756482]


portfolio before change:  [-1.95156449]
curr_Stock_Price:  100.70153448147707
curr_Factors:  [100.70153448]
mat_Sqrt:  [[0.15]]
grads:  [-0.02127995]
Stock Position:  -0.021279952427301192
Bond Position:  [0.19135937]


portfolio before change:  [-1.97216764]
curr_Stock_Price:  101.67029163893199
curr_Factors:  [101.67029164]
mat_Sqrt:  [[0.15]]
grads:  [0.0765912]
Stock Position:  0.07659120406166331
Bond Position:  [-9.75921769]


portfolio before change:  [-2.03652078]
curr_Stock_Price:  100.83803973512852
curr_Factors:  [100.83803974]
mat_Sqrt:  [[0.15]]
grads:  [0.0019295]
Stock Position:  0.0019295010495518072
Bond Position:  [-2.23108789]


portfolio before change:  [-2.03608424]
curr_Stock_Price:  101.13655649215183
curr_Factors:  [101.13655649]
mat_Sqrt:  [[0.15]]
grads:  [0.02772211]
Stock Position:  0.027722111424890984
Bond Position:  [-4.83980313]


portfolio before change:  [-2.04949189]
curr_Stock_Price:  100.66382367025426
curr_Factors:  [100.66382367]
mat_Sqrt:  [[0.15]]
grads:  [-0.18432063]
Stock Position:  -0.18432063161585072
Bond Position:  [16.50492767]


portfolio before change:  [-2.09726574]
curr_Stock_Price:  100.92860922197316
curr_Factors:  [100.92860922]
mat_Sqrt:  [[0.15]]
grads:  [-0.03390694]
Stock Position:  -0.033906941243173644
Bond Position:  [1.32491468]


portfolio before change:  [-2.09833316]
curr_Stock_Price:  100.96253226548393
curr_Factors:  [100.96253227]
mat_Sqrt:  [[0.15]]
grads:  [0.09371755]
Stock Position:  0.09371754875471079
Bond Position:  [-11.5602942]


portfolio before change:  [-2.07658667]
curr_Stock_Price:  101.20228492559795
curr_Factors:  [101.20228493]
mat_Sqrt:  [[0.15]]
grads:  [0.05984835]
Stock Position:  0.05984834927431848
Bond Position:  [-8.13337636]


portfolio before change:  [-2.05191477]
curr_Stock_Price:  101.62301924199555
curr_Factors:  [101.62301924]
mat_Sqrt:  [[0.15]]
grads:  [0.03590851]
Stock Position:  0.03590851147180292
Bond Position:  [-5.70104612]


portfolio before change:  [-2.07623265]
curr_Stock_Price:  100.95572457006254
curr_Factors:  [100.95572457]
mat_Sqrt:  [[0.15]]
grads:  [0.0211354]
Stock Position:  0.02113540376866667
Bond Position:  [-4.20997265]


portfolio before change:  [-2.07188189]
curr_Stock_Price:  101.17402621341468
curr_Factors:  [101.17402621]
mat_Sqrt:  [[0.15]]
grads:  [-0.03100309]
Stock Position:  -0.03100308886732855
Bond Position:  [1.06482544]


portfolio before change:  [-2.07057842]
curr_Stock_Price:  101.13412961147442
curr_Factors:  [101.13412961]
mat_Sqrt:  [[0.15]]
grads:  [-0.0436539]
Stock Position:  -0.043653895784040955
Bond Position:  [2.34432034]


portfolio before change:  [-2.08835235]
curr_Stock_Price:  101.54464188554965
curr_Factors:  [101.54464189]
mat_Sqrt:  [[0.15]]
grads:  [0.05841071]
Stock Position:  0.058410708967807194
Bond Position:  [-8.01964688]


portfolio before change:  [-2.08353362]
curr_Stock_Price:  101.63572072652377
curr_Factors:  [101.63572073]
mat_Sqrt:  [[0.15]]
grads:  [0.00436711]
Stock Position:  0.004367106357150334
Bond Position:  [-2.52738762]


portfolio before change:  [-2.08503238]
curr_Stock_Price:  101.32869891559618
curr_Factors:  [101.32869892]
mat_Sqrt:  [[0.15]]
grads:  [-0.06655241]
Stock Position:  -0.06655240819458552
Bond Position:  [4.65863655]


portfolio before change:  [-2.04103453]
curr_Stock_Price:  100.67197318386751
curr_Factors:  [100.67197318]
mat_Sqrt:  [[0.15]]
grads:  [-0.01939744]
Stock Position:  -0.01939744480253497
Bond Position:  [-0.08825548]


portfolio before change:  [-2.0491671]
curr_Stock_Price:  101.09094866014541
curr_Factors:  [101.09094866]
mat_Sqrt:  [[0.15]]
grads:  [-0.01819304]
Stock Position:  -0.01819304023622384
Bond Position:  [-0.2100154]


portfolio before change:  [-2.04674983]
curr_Stock_Price:  100.95735959239578
curr_Factors:  [100.95735959]
mat_Sqrt:  [[0.15]]
grads:  [0.05779372]
Stock Position:  0.057793724111115455
Bond Position:  [-7.88145162]


portfolio before change:  [-2.03503403]
curr_Stock_Price:  101.16860062857914
curr_Factors:  [101.16860063]
mat_Sqrt:  [[0.15]]
grads:  [-0.09454312]
Stock Position:  -0.09454311534637412
Bond Position:  [7.52976065]


portfolio before change:  [-1.86868894]
curr_Stock_Price:  99.41411576158141
curr_Factors:  [99.41411576]
mat_Sqrt:  [[0.15]]
grads:  [0.01805949]
Stock Position:  0.018059488487447116
Bond Position:  [-3.66405702]


portfolio before change:  [-1.85473161]
curr_Stock_Price:  100.19964964041156
curr_Factors:  [100.19964964]
mat_Sqrt:  [[0.15]]
grads:  [-0.00382234]
Stock Position:  -0.0038223429472480676
Bond Position:  [-1.47173419]


portfolio before change:  [-1.85492386]
curr_Stock_Price:  100.22588028142127
curr_Factors:  [100.22588028]
mat_Sqrt:  [[0.15]]
grads:  [-0.09137554]
Stock Position:  -0.09137553707147256
Bond Position:  [7.30326978]


portfolio before change:  [-1.85018511]
curr_Stock_Price:  100.17901563441443
curr_Factors:  [100.17901563]
mat_Sqrt:  [[0.15]]
grads:  [-0.03390659]
Stock Position:  -0.03390658893247913
Bond Position:  [1.54654359]


portfolio before change:  [-1.85251504]
curr_Stock_Price:  100.25058257655724
curr_Factors:  [100.25058258]
mat_Sqrt:  [[0.15]]
grads:  [-0.0166524]
Stock Position:  -0.01665240419860108
Bond Position:  [-0.18310182]


portfolio before change:  [-1.83575809]
curr_Stock_Price:  99.24361741117137
curr_Factors:  [99.24361741]
mat_Sqrt:  [[0.15]]
grads:  [0.07196036]
Stock Position:  0.0719603601030925
Bond Position:  [-8.97736454]


portfolio before change:  [-1.84334183]
curr_Stock_Price:  99.14602707436023
curr_Factors:  [99.14602707]
mat_Sqrt:  [[0.15]]
grads:  [-0.0206381]
Stock Position:  -0.020638103845738474
Bond Position:  [0.20284417]


portfolio before change:  [-1.8392513]
curr_Stock_Price:  98.94843842865792
curr_Factors:  [98.94843843]
mat_Sqrt:  [[0.15]]
grads:  [0.02231027]
Stock Position:  0.02231027386728192
Bond Position:  [-4.04681806]


portfolio before change:  [-1.83686371]
curr_Stock_Price:  99.06679280494018
curr_Factors:  [99.0667928]
mat_Sqrt:  [[0.15]]
grads:  [0.01592881]
Stock Position:  0.015928807646059286
Bond Position:  [-3.4148796]


portfolio before change:  [-1.81590619]
curr_Stock_Price:  100.39589180736695
curr_Factors:  [100.39589181]
mat_Sqrt:  [[0.15]]
grads:  [-0.01269905]
Stock Position:  -0.01269905019362237
Bond Position:  [-0.54097372]


portfolio before change:  [-1.82047713]
curr_Stock_Price:  100.75317258491978
curr_Factors:  [100.75317258]
mat_Sqrt:  [[0.15]]
grads:  [0.01627906]
Stock Position:  0.01627905872507165
Bond Position:  [-3.46064394]


portfolio before change:  [-1.81905203]
curr_Stock_Price:  100.85400107361836
curr_Factors:  [100.85400107]
mat_Sqrt:  [[0.15]]
grads:  [0.05702574]
Stock Position:  0.057025737437297504
Bond Position:  [-7.57032582]


portfolio before change:  [-1.85256668]
curr_Stock_Price:  100.27458745733935
curr_Factors:  [100.27458746]
mat_Sqrt:  [[0.15]]
grads:  [0.03896996]
Stock Position:  0.03896995606622886
Bond Position:  [-5.76026295]


portfolio before change:  [-1.84038281]
curr_Stock_Price:  100.59647370789786
curr_Factors:  [100.59647371]
mat_Sqrt:  [[0.15]]
grads:  [-0.14063442]
Stock Position:  -0.14063441959230294
Bond Position:  [12.30694388]


portfolio before change:  [-1.91152147]
curr_Stock_Price:  101.10778424215812
curr_Factors:  [101.10778424]
mat_Sqrt:  [[0.15]]
grads:  [0.08964122]
Stock Position:  0.08964122065776998
Bond Position:  [-10.97494666]


portfolio before change:  [-1.90220276]
curr_Stock_Price:  101.219392022234
curr_Factors:  [101.21939202]
mat_Sqrt:  [[0.15]]
grads:  [0.04082551]
Stock Position:  0.04082550815557259
Bond Position:  [-6.03453588]


portfolio before change:  [-1.91049856]
curr_Stock_Price:  101.02542942073993
curr_Factors:  [101.02542942]
mat_Sqrt:  [[0.15]]
grads:  [0.06410647]
Stock Position:  0.06410647304837423
Bond Position:  [-8.38688253]


portfolio before change:  [-1.94450579]
curr_Stock_Price:  100.50312587334757
curr_Factors:  [100.50312587]
mat_Sqrt:  [[0.15]]
grads:  [-0.08429036]
Stock Position:  -0.0842903588241044
Bond Position:  [6.52693875]


portfolio before change:  [-1.89980072]
curr_Stock_Price:  99.97759567904902
curr_Factors:  [99.97759568]
mat_Sqrt:  [[0.15]]
grads:  [-0.0836088]
Stock Position:  -0.08360880004156322
Bond Position:  [6.45920609]


portfolio before change:  [-1.87675752]
curr_Stock_Price:  99.70681701381781
curr_Factors:  [99.70681701]
mat_Sqrt:  [[0.15]]
grads:  [-0.01415614]
Stock Position:  -0.014156142430234199
Bond Position:  [-0.46529362]


portfolio before change:  [-1.87764584]
curr_Stock_Price:  99.76751418204033
curr_Factors:  [99.76751418]
mat_Sqrt:  [[0.15]]
grads:  [-0.08945787]
Stock Position:  -0.08945787070385991
Bond Position:  [7.04734354]


portfolio before change:  [-1.83710326]
curr_Stock_Price:  99.31923486841208
curr_Factors:  [99.31923487]
mat_Sqrt:  [[0.15]]
grads:  [0.12716959]
Stock Position:  0.1271695920721856
Bond Position:  [-14.46748984]


portfolio before change:  [-1.88204624]
curr_Stock_Price:  98.97293563395486
curr_Factors:  [98.97293563]
mat_Sqrt:  [[0.15]]
grads:  [0.08404735]
Stock Position:  0.08404734656398574
Bond Position:  [-10.20045886]


portfolio before change:  [-1.83308716]
curr_Stock_Price:  99.56303909991784
curr_Factors:  [99.5630391]
mat_Sqrt:  [[0.15]]
grads:  [0.01430301]
Stock Position:  0.01430300762315608
Bond Position:  [-3.25713806]


portfolio before change:  [-1.83890601]
curr_Stock_Price:  99.1704449269981
curr_Factors:  [99.17044493]
mat_Sqrt:  [[0.15]]
grads:  [0.04914827]
Stock Position:  0.04914826677650804
Bond Position:  [-6.71296149]


portfolio before change:  [-1.8603832]
curr_Stock_Price:  98.7419941417005
curr_Factors:  [98.74199414]
mat_Sqrt:  [[0.15]]
grads:  [-0.10879129]
Stock Position:  -0.1087912859355301
Bond Position:  [8.88188532]


portfolio before change:  [-1.90488567]
curr_Stock_Price:  99.15615973142964
curr_Factors:  [99.15615973]
mat_Sqrt:  [[0.15]]
grads:  [-0.03684701]
Stock Position:  -0.0368470091401487
Bond Position:  [1.74872226]


portfolio before change:  [-1.91381726]
curr_Stock_Price:  99.40152269673455
curr_Factors:  [99.4015227]
mat_Sqrt:  [[0.15]]
grads:  [-0.00802557]
Stock Position:  -0.008025567053892664
Bond Position:  [-1.11606368]


portfolio before change:  [-1.91290427]
curr_Stock_Price:  99.27907005330208
curr_Factors:  [99.27907005]
mat_Sqrt:  [[0.15]]
grads:  [0.01107126]
Stock Position:  0.011071260898923593
Bond Position:  [-3.01204875]


portfolio before change:  [-1.91739632]
curr_Stock_Price:  98.89033394743774
curr_Factors:  [98.89033395]
mat_Sqrt:  [[0.15]]
grads:  [0.05824302]
Stock Position:  0.05824302076633546
Bond Position:  [-7.6770681]


portfolio before change:  [-1.92980366]
curr_Stock_Price:  98.6855452994337
curr_Factors:  [98.6855453]
mat_Sqrt:  [[0.15]]
grads:  [0.05064144]
Stock Position:  0.05064143812532997
Bond Position:  [-6.9273816]


portfolio before change:  [-1.89413514]
curr_Stock_Price:  99.39842992249467
curr_Factors:  [99.39842992]
mat_Sqrt:  [[0.15]]
grads:  [-0.04006615]
Stock Position:  -0.04006614774057056
Bond Position:  [2.08837704]


portfolio before change:  [-1.93344246]
curr_Stock_Price:  100.38274850773172
curr_Factors:  [100.38274851]
mat_Sqrt:  [[0.15]]
grads:  [-0.00635445]
Stock Position:  -0.006354453190257313
Bond Position:  [-1.29556499]


portfolio before change:  [-1.93603654]
curr_Stock_Price:  100.77823540030073
curr_Factors:  [100.7782354]
mat_Sqrt:  [[0.15]]
grads:  [-0.05572982]
Stock Position:  -0.05572981704791899
Bond Position:  [3.68031608]


portfolio before change:  [-1.92146339]
curr_Stock_Price:  100.52086642342702
curr_Factors:  [100.52086642]
mat_Sqrt:  [[0.15]]
grads:  [0.03503572]
Stock Position:  0.035035716390179536
Bond Position:  [-5.44328396]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.92146339]
Stock Price:  101.67310128113448
PL:  [-3.59456467]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.54465342e-02]
 [-2.31333812e-03]
 [ 2.02467459e-03]
 [ 3.14364452e-03]
 [ 6.29308536e-03]
 [ 1.17898561e-02]
 [ 3.14680941e-04]
 [ 7.83848257e-03]
 [-1.74286247e-03]
 [-1.96637605e-02]
 [ 1.01516463e-02]
 [-6.92401448e-03]
 [ 1.14358479e-02]
 [ 4.15934501e-03]
 [ 4.36608993e-03]
 [-5.78143841e-03]
 [ 7.52294361e-03]
 [ 8.32145891e-03]
 [ 2.17672501e-02]
 [ 3.25589707e-03]
 [ 7.83963165e-02]
 [-1.55485952e-02]
 [-4.58981350e-04]
 [ 6.31336983e-03]
 [ 1.49092699e-02]
 [ 1.44992965e-03]
 [ 1.20176889e-02]
 [ 4.99127180e-03]
 [ 3.42102923e-03]
 [-2.66844146e-02]
 [-4.81972869e-03]
 [ 1.34368054e-02]
 [ 7.70450600e-03]
 [ 3.51727907e-03]
 [-4.71578981e-03]
 [-3.92875137e-03]
 [-6.19828607e-03]
 [ 3.65176639e-03]
 [ 2.09207676e-03]
 [-8.71047997e-03]
 [-2.95547716e-02]
 [-3.30005103e-03]
 [ 1.50055389e-02]
 [-1.19971569e-02]
 [-5.88125874e-04]
 [ 2.39449764e-03]
 [-1.36389817e-02]
 [ 4.79005322e-03]
 [ 4.90264205e-03]
 [-2.71377113e-03]
 [-3.43521102e-03]
 [ 3.52393508e-03]
 [ 1.65531605e-03]
 [ 2.50241027e-03]
 [-7.56300925e-03]
 [ 1.05779321e-02]
 [-1.09720630e-02]
 [-8.60722888e-03]
 [ 1.58508678e-02]
 [-1.10117146e-03]
 [ 1.29531604e-02]
 [-1.46402354e-02]
 [-1.27555124e-02]
 [-3.28082078e-03]
 [ 2.06869933e-02]
 [-1.73720145e-02]
 [ 1.85315400e-02]
 [ 3.86365800e-03]
 [ 8.25040813e-03]
 [-1.41673068e-02]
 [-7.80137486e-03]
 [-7.71228676e-03]
 [ 3.42646405e-03]
 [ 7.88332541e-03]
 [-5.10143359e-04]
 [-7.52641910e-03]
 [ 6.56071035e-03]
 [-3.88438582e-03]
 [ 2.48851863e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.78613639]
curr_Stock_Price:  100.04625488408747
curr_Factors:  [100.04625488]
mat_Sqrt:  [[0.15]]
grads:  [-0.23631023]
Stock Position:  -0.23631022798637558
Bond Position:  [26.42808969]


portfolio before change:  [2.74248871]
curr_Stock_Price:  100.23794990299041
curr_Factors:  [100.2379499]
mat_Sqrt:  [[0.15]]
grads:  [-0.01542225]
Stock Position:  -0.01542225411523895
Bond Position:  [4.28838384]


portfolio before change:  [2.73233942]
curr_Stock_Price:  100.91342328298917
curr_Factors:  [100.91342328]
mat_Sqrt:  [[0.15]]
grads:  [0.01349783]
Stock Position:  0.0134978305718381
Bond Position:  [1.37022713]


portfolio before change:  [2.74180663]
curr_Stock_Price:  101.60846643875342
curr_Factors:  [101.60846644]
mat_Sqrt:  [[0.15]]
grads:  [0.02095763]
Stock Position:  0.020957630154615364
Bond Position:  [0.61233397]


portfolio before change:  [2.73445502]
curr_Stock_Price:  101.25585580248207
curr_Factors:  [101.2558558]
mat_Sqrt:  [[0.15]]
grads:  [0.0419539]
Stock Position:  0.04195390240449871
Bond Position:  [-1.51362327]


portfolio before change:  [2.7016562]
curr_Stock_Price:  100.47632834269032
curr_Factors:  [100.47632834]
mat_Sqrt:  [[0.15]]
grads:  [0.07859904]
Stock Position:  0.07859904077853458
Bond Position:  [-5.19568683]


portfolio before change:  [2.75504728]
curr_Stock_Price:  101.15974414664484
curr_Factors:  [101.15974415]
mat_Sqrt:  [[0.15]]
grads:  [0.00209787]
Stock Position:  0.0020978729389582963
Bond Position:  [2.54282699]


portfolio before change:  [2.75496837]
curr_Stock_Price:  101.04636977170917
curr_Factors:  [101.04636977]
mat_Sqrt:  [[0.15]]
grads:  [0.05225655]
Stock Position:  0.05225655049075899
Bond Position:  [-2.52536635]


portfolio before change:  [2.74384702]
curr_Stock_Price:  100.83656814352791
curr_Factors:  [100.83656814]
mat_Sqrt:  [[0.15]]
grads:  [-0.01161908]
Stock Position:  -0.011619083104331268
Bond Position:  [3.91547549]


portfolio before change:  [2.73923741]
curr_Stock_Price:  101.25435832693144
curr_Factors:  [101.25435833]
mat_Sqrt:  [[0.15]]
grads:  [-0.13109174]
Stock Position:  -0.13109173686030579
Bond Position:  [16.0128471]


portfolio before change:  [2.75755253]
curr_Stock_Price:  101.12228069522628
curr_Factors:  [101.1222807]
mat_Sqrt:  [[0.15]]
grads:  [0.06767764]
Stock Position:  0.06767764221405255
Bond Position:  [-4.08616501]


portfolio before change:  [2.74092345]
curr_Stock_Price:  100.88034435238335
curr_Factors:  [100.88034435]
mat_Sqrt:  [[0.15]]
grads:  [-0.0461601]
Stock Position:  -0.04616009650005527
Bond Position:  [7.39756988]


portfolio before change:  [2.7211511]
curr_Stock_Price:  101.31870387108118
curr_Factors:  [101.31870387]
mat_Sqrt:  [[0.15]]
grads:  [0.07623899]
Stock Position:  0.07623898585799478
Bond Position:  [-5.00328413]


portfolio before change:  [2.69476779]
curr_Stock_Price:  100.9767450243548
curr_Factors:  [100.97674502]
mat_Sqrt:  [[0.15]]
grads:  [0.02772897]
Stock Position:  0.02772896671446121
Bond Position:  [-0.10521301]


portfolio before change:  [2.69527862]
curr_Stock_Price:  100.99540454865446
curr_Factors:  [100.99540455]
mat_Sqrt:  [[0.15]]
grads:  [0.02910727]
Stock Position:  0.029107266191775612
Bond Position:  [-0.2444215]


portfolio before change:  [2.67939508]
curr_Stock_Price:  100.45023956466896
curr_Factors:  [100.45023956]
mat_Sqrt:  [[0.15]]
grads:  [-0.03854292]
Stock Position:  -0.038542922720960715
Bond Position:  [6.5510409]


portfolio before change:  [2.69951595]
curr_Stock_Price:  99.9388249710959
curr_Factors:  [99.93882497]
mat_Sqrt:  [[0.15]]
grads:  [0.05015296]
Stock Position:  0.05015295738019286
Bond Position:  [-2.31271168]


portfolio before change:  [2.68437178]
curr_Stock_Price:  99.63974761252707
curr_Factors:  [99.63974761]
mat_Sqrt:  [[0.15]]
grads:  [0.05547639]
Stock Position:  0.055476392758698714
Bond Position:  [-2.84328199]


portfolio before change:  [2.71627796]
curr_Stock_Price:  100.21808166223599
curr_Factors:  [100.21808166]
mat_Sqrt:  [[0.15]]
grads:  [0.145115]
Stock Position:  0.14511500099067048
Bond Position:  [-11.82686906]


portfolio before change:  [2.73611903]
curr_Stock_Price:  100.3599020819274
curr_Factors:  [100.35990208]
mat_Sqrt:  [[0.15]]
grads:  [0.02170598]
Stock Position:  0.0217059804393338
Bond Position:  [0.55770896]


portfolio before change:  [2.73514093]
curr_Stock_Price:  100.3132349617711
curr_Factors:  [100.31323496]
mat_Sqrt:  [[0.15]]
grads:  [0.52264211]
Stock Position:  0.5226421102782366
Bond Position:  [-49.69277988]


portfolio before change:  [2.3559717]
curr_Stock_Price:  99.59369221763703
curr_Factors:  [99.59369222]
mat_Sqrt:  [[0.15]]
grads:  [-0.1036573]
Stock Position:  -0.103657301485475
Bond Position:  [12.67958508]


portfolio before change:  [2.26973908]
curr_Stock_Price:  100.43323861208184
curr_Factors:  [100.43323861]
mat_Sqrt:  [[0.15]]
grads:  [-0.00305988]
Stock Position:  -0.00305987566828088
Bond Position:  [2.5770523]


portfolio before change:  [2.26930118]
curr_Stock_Price:  100.62898837941958
curr_Factors:  [100.62898838]
mat_Sqrt:  [[0.15]]
grads:  [0.04208913]
Stock Position:  0.04208913217554997
Bond Position:  [-1.96608561]


portfolio before change:  [2.27619429]
curr_Stock_Price:  100.79568195201398
curr_Factors:  [100.79568195]
mat_Sqrt:  [[0.15]]
grads:  [0.09939513]
Stock Position:  0.09939513235934776
Bond Position:  [-7.74240586]


portfolio before change:  [2.29178949]
curr_Stock_Price:  100.95745168870829
curr_Factors:  [100.95745169]
mat_Sqrt:  [[0.15]]
grads:  [0.0096662]
Stock Position:  0.009666197688442032
Bond Position:  [1.31591481]


portfolio before change:  [2.29547202]
curr_Stock_Price:  101.32991233423898
curr_Factors:  [101.32991233]
mat_Sqrt:  [[0.15]]
grads:  [0.08011793]
Stock Position:  0.08011792595764962
Bond Position:  [-5.82287039]


portfolio before change:  [2.32333145]
curr_Stock_Price:  101.68218522128926
curr_Factors:  [101.68218522]
mat_Sqrt:  [[0.15]]
grads:  [0.03327515]
Stock Position:  0.03327514536324306
Bond Position:  [-1.06015804]


portfolio before change:  [2.2869844]
curr_Stock_Price:  100.59185831991351
curr_Factors:  [100.59185832]
mat_Sqrt:  [[0.15]]
grads:  [0.02280686]
Stock Position:  0.02280686154994337
Bond Position:  [-0.00720018]


portfolio before change:  [2.28526754]
curr_Stock_Price:  100.51659981741858
curr_Factors:  [100.51659982]
mat_Sqrt:  [[0.15]]
grads:  [-0.1778961]
Stock Position:  -0.17789609721257993
Bond Position:  [20.16677836]


portfolio before change:  [2.29100925]
curr_Stock_Price:  100.49140956948965
curr_Factors:  [100.49140957]
mat_Sqrt:  [[0.15]]
grads:  [-0.03213152]
Stock Position:  -0.032131524613846364
Bond Position:  [5.51995145]


portfolio before change:  [2.28042564]
curr_Stock_Price:  100.83153102788816
curr_Factors:  [100.83153103]
mat_Sqrt:  [[0.15]]
grads:  [0.0895787]
Stock Position:  0.08957870249513167
Bond Position:  [-6.75193208]


portfolio before change:  [2.34038072]
curr_Stock_Price:  101.5055426808461
curr_Factors:  [101.50554268]
mat_Sqrt:  [[0.15]]
grads:  [0.05136337]
Stock Position:  0.05136337334703087
Bond Position:  [-2.87328636]


portfolio before change:  [2.35649225]
curr_Stock_Price:  101.82271652459393
curr_Factors:  [101.82271652]
mat_Sqrt:  [[0.15]]
grads:  [0.02344853]
Stock Position:  0.02344852714352361
Bond Position:  [-0.03110048]


portfolio before change:  [2.37339713]
curr_Stock_Price:  102.54373500863083
curr_Factors:  [102.54373501]
mat_Sqrt:  [[0.15]]
grads:  [-0.0314386]
Stock Position:  -0.03143859871878648
Bond Position:  [5.59722847]


portfolio before change:  [2.35066871]
curr_Stock_Price:  103.27780890386737
curr_Factors:  [103.2778089]
mat_Sqrt:  [[0.15]]
grads:  [-0.02619168]
Stock Position:  -0.026191675828699124
Bond Position:  [5.05568761]


portfolio before change:  [2.365299]
curr_Stock_Price:  102.73128793775452
curr_Factors:  [102.73128794]
mat_Sqrt:  [[0.15]]
grads:  [-0.04132191]
Stock Position:  -0.04132190716556141
Bond Position:  [6.61035175]


portfolio before change:  [2.36791152]
curr_Stock_Price:  102.67806298609511
curr_Factors:  [102.67806299]
mat_Sqrt:  [[0.15]]
grads:  [0.02434511]
Stock Position:  0.02434510927970116
Bond Position:  [-0.13179714]


portfolio before change:  [2.36631284]
curr_Stock_Price:  102.6127337773647
curr_Factors:  [102.61273378]
mat_Sqrt:  [[0.15]]
grads:  [0.01394718]
Stock Position:  0.013947178384425246
Bond Position:  [0.93515473]


portfolio before change:  [2.36064525]
curr_Stock_Price:  102.20218219799668
curr_Factors:  [102.2021822]
mat_Sqrt:  [[0.15]]
grads:  [-0.05806987]
Stock Position:  -0.058069866497764876
Bond Position:  [8.29551233]


portfolio before change:  [2.34791056]
curr_Stock_Price:  102.43041024839331
curr_Factors:  [102.43041025]
mat_Sqrt:  [[0.15]]
grads:  [-0.19703181]
Stock Position:  -0.19703181055444646
Bond Position:  [22.52995975]


portfolio before change:  [2.1391126]
curr_Stock_Price:  103.49727416354375
curr_Factors:  [103.49727416]
mat_Sqrt:  [[0.15]]
grads:  [-0.02200034]
Stock Position:  -0.022000340209765563
Bond Position:  [4.41608784]


portfolio before change:  [2.12855945]
curr_Stock_Price:  103.98950147880939
curr_Factors:  [103.98950148]
mat_Sqrt:  [[0.15]]
grads:  [0.10003693]
Stock Position:  0.10003692573089595
Bond Position:  [-8.27423059]


portfolio before change:  [2.02770103]
curr_Stock_Price:  102.98645924453464
curr_Factors:  [102.98645924]
mat_Sqrt:  [[0.15]]
grads:  [-0.07998105]
Stock Position:  -0.07998104633296646
Bond Position:  [10.2646658]


portfolio before change:  [2.04434279]
curr_Stock_Price:  102.78640930392957
curr_Factors:  [102.7864093]
mat_Sqrt:  [[0.15]]
grads:  [-0.00392084]
Stock Position:  -0.003920839158786741
Bond Position:  [2.44735177]


portfolio before change:  [2.0438079]
curr_Stock_Price:  102.96184697058493
curr_Factors:  [102.96184697]
mat_Sqrt:  [[0.15]]
grads:  [0.01596332]
Stock Position:  0.01596331760405474
Bond Position:  [0.40019523]


portfolio before change:  [2.04045091]
curr_Stock_Price:  102.749986544327
curr_Factors:  [102.74998654]
mat_Sqrt:  [[0.15]]
grads:  [-0.09092654]
Stock Position:  -0.09092654475775418
Bond Position:  [11.38315216]


portfolio before change:  [1.98956644]
curr_Stock_Price:  103.31743299146797
curr_Factors:  [103.31743299]
mat_Sqrt:  [[0.15]]
grads:  [0.03193369]
Stock Position:  0.0319336881307528
Bond Position:  [-1.30974025]


portfolio before change:  [1.97135262]
curr_Stock_Price:  102.74963263379519
curr_Factors:  [102.74963263]
mat_Sqrt:  [[0.15]]
grads:  [0.03268428]
Stock Position:  0.03268428034138591
Bond Position:  [-1.38694518]


portfolio before change:  [1.9502486]
curr_Stock_Price:  102.10659174731592
curr_Factors:  [102.10659175]
mat_Sqrt:  [[0.15]]
grads:  [-0.01809181]
Stock Position:  -0.01809180754534383
Bond Position:  [3.79754141]


portfolio before change:  [1.93804557]
curr_Stock_Price:  102.79421727463365
curr_Factors:  [102.79421727]
mat_Sqrt:  [[0.15]]
grads:  [-0.02290141]
Stock Position:  -0.02290140678619833
Bond Position:  [4.29217775]


portfolio before change:  [1.94185925]
curr_Stock_Price:  102.6394053545524
curr_Factors:  [102.63940535]
mat_Sqrt:  [[0.15]]
grads:  [0.0234929]
Stock Position:  0.023492900543082507
Bond Position:  [-0.46943809]


portfolio before change:  [1.95146511]
curr_Stock_Price:  103.04953789874376
curr_Factors:  [103.0495379]
mat_Sqrt:  [[0.15]]
grads:  [0.01103544]
Stock Position:  0.011035440317180347
Bond Position:  [0.81426808]


portfolio before change:  [1.95544813]
curr_Stock_Price:  103.40585596568472
curr_Factors:  [103.40585597]
mat_Sqrt:  [[0.15]]
grads:  [0.01668274]
Stock Position:  0.016682735133414107
Bond Position:  [0.23035562]


portfolio before change:  [1.96947803]
curr_Stock_Price:  104.24597644266748
curr_Factors:  [104.24597644]
mat_Sqrt:  [[0.15]]
grads:  [-0.05042006]
Stock Position:  -0.05042006164876183
Bond Position:  [7.22556659]


portfolio before change:  [1.97504631]
curr_Stock_Price:  104.14449574936378
curr_Factors:  [104.14449575]
mat_Sqrt:  [[0.15]]
grads:  [0.07051955]
Stock Position:  0.0705195473523813
Bond Position:  [-5.36917639]


portfolio before change:  [1.95510013]
curr_Stock_Price:  103.86640834046341
curr_Factors:  [103.86640834]
mat_Sqrt:  [[0.15]]
grads:  [-0.07314709]
Stock Position:  -0.07314708680080327
Bond Position:  [9.55262531]


portfolio before change:  [1.94380337]
curr_Stock_Price:  104.02900972252024
curr_Factors:  [104.02900972]
mat_Sqrt:  [[0.15]]
grads:  [-0.05738153]
Stock Position:  -0.057381525893094934
Bond Position:  [7.91314668]


portfolio before change:  [1.96539459]
curr_Stock_Price:  103.66135415759217
curr_Factors:  [103.66135416]
mat_Sqrt:  [[0.15]]
grads:  [0.10567245]
Stock Position:  0.10567245209209063
Bond Position:  [-8.98875489]


portfolio before change:  [2.00979955]
curr_Stock_Price:  104.08688391295905
curr_Factors:  [104.08688391]
mat_Sqrt:  [[0.15]]
grads:  [-0.00734114]
Stock Position:  -0.007341143046324806
Bond Position:  [2.77391625]


portfolio before change:  [2.01077252]
curr_Stock_Price:  103.97796439263446
curr_Factors:  [103.97796439]
mat_Sqrt:  [[0.15]]
grads:  [0.0863544]
Stock Position:  0.086354402888779
Bond Position:  [-6.96818251]


portfolio before change:  [2.06547985]
curr_Stock_Price:  104.61652893956015
curr_Factors:  [104.61652894]
mat_Sqrt:  [[0.15]]
grads:  [-0.09760157]
Stock Position:  -0.09760156943821056
Bond Position:  [12.27621727]


portfolio before change:  [2.08788949]
curr_Stock_Price:  104.3947871235381
curr_Factors:  [104.39478712]
mat_Sqrt:  [[0.15]]
grads:  [-0.08503675]
Stock Position:  -0.08503674921501037
Bond Position:  [10.96528282]


portfolio before change:  [2.07734714]
curr_Stock_Price:  104.52682061838242
curr_Factors:  [104.52682062]
mat_Sqrt:  [[0.15]]
grads:  [-0.02187214]
Stock Position:  -0.021872138559960834
Bond Position:  [4.36357225]


portfolio before change:  [2.08836994]
curr_Stock_Price:  104.0353247677491
curr_Factors:  [104.03532477]
mat_Sqrt:  [[0.15]]
grads:  [0.13791329]
Stock Position:  0.13791328886618018
Bond Position:  [-12.25948386]


portfolio before change:  [2.13684921]
curr_Stock_Price:  104.39240063005373
curr_Factors:  [104.39240063]
mat_Sqrt:  [[0.15]]
grads:  [-0.11581343]
Stock Position:  -0.11581342999831315
Bond Position:  [14.22689119]


portfolio before change:  [2.14663016]
curr_Stock_Price:  104.31562412395115
curr_Factors:  [104.31562412]
mat_Sqrt:  [[0.15]]
grads:  [0.1235436]
Stock Position:  0.12354360015304464
Bond Position:  [-10.74089759]


portfolio before change:  [2.10572503]
curr_Stock_Price:  103.98995928852638
curr_Factors:  [103.98995929]
mat_Sqrt:  [[0.15]]
grads:  [0.02575772]
Stock Position:  0.02575772001136265
Bond Position:  [-0.57281922]


portfolio before change:  [2.0849902]
curr_Stock_Price:  103.18635456040977
curr_Factors:  [103.18635456]
mat_Sqrt:  [[0.15]]
grads:  [0.05500272]
Stock Position:  0.055002720894079295
Bond Position:  [-3.59054006]


portfolio before change:  [2.02793489]
curr_Stock_Price:  102.15311670333239
curr_Factors:  [102.1531167]
mat_Sqrt:  [[0.15]]
grads:  [-0.09444871]
Stock Position:  -0.09444871191681417
Bond Position:  [11.67616519]


portfolio before change:  [1.98078049]
curr_Stock_Price:  102.66010284194981
curr_Factors:  [102.66010284]
mat_Sqrt:  [[0.15]]
grads:  [-0.05200917]
Stock Position:  -0.05200916570079958
Bond Position:  [7.32004679]


portfolio before change:  [1.9649494]
curr_Stock_Price:  102.97328998480788
curr_Factors:  [102.97328998]
mat_Sqrt:  [[0.15]]
grads:  [-0.05141525]
Stock Position:  -0.05141524505995533
Bond Position:  [7.25934634]


portfolio before change:  [1.96209518]
curr_Stock_Price:  103.03762796435075
curr_Factors:  [103.03762796]
mat_Sqrt:  [[0.15]]
grads:  [0.02284309]
Stock Position:  0.022843093664782935
Bond Position:  [-0.39160301]


portfolio before change:  [1.94778128]
curr_Stock_Price:  102.41208159327745
curr_Factors:  [102.41208159]
mat_Sqrt:  [[0.15]]
grads:  [0.0525555]
Stock Position:  0.05255550276266229
Bond Position:  [-3.43453715]


portfolio before change:  [1.96202375]
curr_Stock_Price:  102.68716473408016
curr_Factors:  [102.68716473]
mat_Sqrt:  [[0.15]]
grads:  [-0.00340096]
Stock Position:  -0.0034009557248364563
Bond Position:  [2.31125825]


portfolio before change:  [1.95914234]
curr_Stock_Price:  103.57687612418682
curr_Factors:  [103.57687612]
mat_Sqrt:  [[0.15]]
grads:  [-0.05017613]
Stock Position:  -0.05017612732346342
Bond Position:  [7.15622887]


portfolio before change:  [1.98374276]
curr_Stock_Price:  103.09550894754636
curr_Factors:  [103.09550895]
mat_Sqrt:  [[0.15]]
grads:  [0.04373807]
Stock Position:  0.04373806897753308
Bond Position:  [-2.52545572]


portfolio before change:  [1.97699152]
curr_Stock_Price:  102.94476164645977
curr_Factors:  [102.94476165]
mat_Sqrt:  [[0.15]]
grads:  [-0.02589591]
Stock Position:  -0.02589590546285833
Bond Position:  [4.64283933]


portfolio before change:  [1.96341183]
curr_Stock_Price:  103.48036263188982
curr_Factors:  [103.48036263]
mat_Sqrt:  [[0.15]]
grads:  [0.16590124]
Stock Position:  0.16590124185000313
Bond Position:  [-15.20410884]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.96341183]
Stock Price:  103.2510397747009
PL:  [-1.28762794]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.79738253e-02]
 [ 9.68861684e-03]
 [-3.21613549e-04]
 [-1.90350923e-04]
 [-6.86416525e-03]
 [ 1.07660121e-02]
 [ 6.00346080e-04]
 [ 1.57672799e-02]
 [ 1.54562128e-02]
 [-1.85729075e-02]
 [ 5.91803492e-03]
 [-6.34499468e-03]
 [-6.19946741e-03]
 [ 4.32106755e-03]
 [ 5.39270520e-03]
 [ 2.14002466e-03]
 [-1.08249523e-03]
 [ 4.63298684e-03]
 [ 1.42029954e-02]
 [ 1.36341111e-02]
 [ 4.17946560e-02]
 [-2.00269630e-02]
 [-1.05599806e-03]
 [ 6.53805410e-03]
 [ 4.05732603e-04]
 [ 9.13346295e-03]
 [ 1.38031963e-02]
 [-1.75201523e-02]
 [ 1.83868086e-03]
 [-7.41766996e-03]
 [-3.75803476e-03]
 [-2.03558866e-02]
 [ 1.55802099e-02]
 [ 1.98082956e-02]
 [-1.20093917e-02]
 [ 4.28803233e-03]
 [-2.24239767e-03]
 [ 1.02361395e-02]
 [ 3.55789321e-03]
 [-1.46537653e-02]
 [ 1.63807006e-02]
 [-2.47595746e-03]
 [ 4.94616618e-03]
 [-1.33705664e-02]
 [ 1.53799927e-03]
 [ 1.41713872e-03]
 [-1.36756652e-02]
 [-5.07734390e-03]
 [-9.64900894e-04]
 [ 1.36246472e-03]
 [-3.10318579e-03]
 [ 3.75508748e-03]
 [ 8.16854235e-05]
 [-3.00244989e-04]
 [ 2.26107046e-03]
 [ 8.63533528e-03]
 [-9.98742548e-04]
 [-2.09981473e-02]
 [ 1.34489557e-02]
 [ 4.96445121e-03]
 [ 1.09557073e-02]
 [-1.42828792e-02]
 [-1.26997858e-02]
 [-3.15515547e-03]
 [-6.03144640e-03]
 [-1.14454742e-02]
 [ 2.78418480e-02]
 [ 3.46189675e-03]
 [ 8.28343753e-03]
 [-1.62813935e-02]
 [-7.79640121e-03]
 [-8.02305734e-03]
 [ 3.85516077e-03]
 [ 7.66261876e-03]
 [ 1.17370558e-03]
 [-1.30589158e-02]
 [ 4.14657101e-03]
 [-7.51719295e-03]
 [ 1.03997672e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.40011245]
curr_Stock_Price:  99.52011927115414
curr_Factors:  [99.52011927]
mat_Sqrt:  [[0.15]]
grads:  [-0.25315884]
Stock Position:  -0.25315883520731214
Bond Position:  [19.79428502]


portfolio before change:  [-5.16475769]
curr_Stock_Price:  98.59533390446616
curr_Factors:  [98.5953339]
mat_Sqrt:  [[0.15]]
grads:  [0.06459078]
Stock Position:  0.0645907789143517
Bond Position:  [-11.5331071]


portfolio before change:  [-5.16525528]
curr_Stock_Price:  98.59879027751256
curr_Factors:  [98.59879028]
mat_Sqrt:  [[0.15]]
grads:  [-0.00214409]
Stock Position:  -0.0021440903299028056
Bond Position:  [-4.95385056]


portfolio before change:  [-5.16651799]
curr_Stock_Price:  99.04330849202157
curr_Factors:  [99.04330849]
mat_Sqrt:  [[0.15]]
grads:  [-0.00126901]
Stock Position:  -0.0012690061539342933
Bond Position:  [-5.04083142]


portfolio before change:  [-5.16703295]
curr_Stock_Price:  99.20083366967846
curr_Factors:  [99.20083367]
mat_Sqrt:  [[0.15]]
grads:  [-0.0457611]
Stock Position:  -0.04576110166251277
Bond Position:  [-0.62749352]


portfolio before change:  [-5.18101181]
curr_Stock_Price:  99.50545138433499
curr_Factors:  [99.50545138]
mat_Sqrt:  [[0.15]]
grads:  [0.07177341]
Stock Position:  0.07177341386663458
Bond Position:  [-12.32285776]


portfolio before change:  [-5.24410505]
curr_Stock_Price:  98.63712105087565
curr_Factors:  [98.63712105]
mat_Sqrt:  [[0.15]]
grads:  [0.00400231]
Stock Position:  0.004002307201754989
Bond Position:  [-5.63888111]


portfolio before change:  [-5.24251423]
curr_Stock_Price:  99.12265685700176
curr_Factors:  [99.12265686]
mat_Sqrt:  [[0.15]]
grads:  [0.1051152]
Stock Position:  0.1051151990406841
Bond Position:  [-15.66181203]


portfolio before change:  [-5.2704963]
curr_Stock_Price:  98.86576554202925
curr_Factors:  [98.86576554]
mat_Sqrt:  [[0.15]]
grads:  [0.10304142]
Stock Position:  0.10304141885575142
Bond Position:  [-15.45776506]


portfolio before change:  [-5.25325688]
curr_Stock_Price:  99.04244755491635
curr_Factors:  [99.04244755]
mat_Sqrt:  [[0.15]]
grads:  [-0.12381938]
Stock Position:  -0.12381938311692184
Bond Position:  [7.01011788]


portfolio before change:  [-5.26968847]
curr_Stock_Price:  99.17869227245264
curr_Factors:  [99.17869227]
mat_Sqrt:  [[0.15]]
grads:  [0.03945357]
Stock Position:  0.03945356611087455
Bond Position:  [-9.18264156]


portfolio before change:  [-5.27966749]
curr_Stock_Price:  98.94030849750963
curr_Factors:  [98.9403085]
mat_Sqrt:  [[0.15]]
grads:  [-0.04229996]
Stock Position:  -0.04229996451179945
Bond Position:  [-1.09449595]


portfolio before change:  [-5.2889744]
curr_Stock_Price:  99.15871290132355
curr_Factors:  [99.1587129]
mat_Sqrt:  [[0.15]]
grads:  [-0.04132978]
Stock Position:  -0.04132978271549931
Bond Position:  [-1.19076634]


portfolio before change:  [-5.32247548]
curr_Stock_Price:  99.96749181013828
curr_Factors:  [99.96749181]
mat_Sqrt:  [[0.15]]
grads:  [0.02880712]
Stock Position:  0.02880711699391053
Bond Position:  [-8.20225071]


portfolio before change:  [-5.3218552]
curr_Stock_Price:  100.00682013421641
curr_Factors:  [100.00682013]
mat_Sqrt:  [[0.15]]
grads:  [0.03595137]
Stock Position:  0.03595136801179365
Bond Position:  [-8.91723719]


portfolio before change:  [-5.33054974]
curr_Stock_Price:  99.78048123525045
curr_Factors:  [99.78048124]
mat_Sqrt:  [[0.15]]
grads:  [0.01426683]
Stock Position:  0.014266831059132786
Bond Position:  [-6.75410101]


portfolio before change:  [-5.34350301]
curr_Stock_Price:  98.9021411322729
curr_Factors:  [98.90214113]
mat_Sqrt:  [[0.15]]
grads:  [-0.00721663]
Stock Position:  -0.007216634887802593
Bond Position:  [-4.62976237]


portfolio before change:  [-5.34231098]
curr_Stock_Price:  98.69686546145886
curr_Factors:  [98.69686546]
mat_Sqrt:  [[0.15]]
grads:  [0.03088658]
Stock Position:  0.030886578910343885
Bond Position:  [-8.39071951]


portfolio before change:  [-5.34609194]
curr_Stock_Price:  98.5914306139429
curr_Factors:  [98.59143061]
mat_Sqrt:  [[0.15]]
grads:  [0.09468664]
Stock Position:  0.09468663582688801
Bond Position:  [-14.68138283]


portfolio before change:  [-5.35575676]
curr_Stock_Price:  98.49905000285656
curr_Factors:  [98.49905]
mat_Sqrt:  [[0.15]]
grads:  [0.09089407]
Stock Position:  0.09089407409691258
Bond Position:  [-14.30873671]


portfolio before change:  [-5.32926189]
curr_Stock_Price:  98.80038099014362
curr_Factors:  [98.80038099]
mat_Sqrt:  [[0.15]]
grads:  [0.27863104]
Stock Position:  0.2786310402304659
Bond Position:  [-32.85811482]


portfolio before change:  [-5.4543311]
curr_Stock_Price:  98.35888130857546
curr_Factors:  [98.35888131]
mat_Sqrt:  [[0.15]]
grads:  [-0.13351309]
Stock Position:  -0.13351308682943455
Bond Position:  [7.67786676]


portfolio before change:  [-5.47472548]
curr_Stock_Price:  98.51522749344781
curr_Factors:  [98.51522749]
mat_Sqrt:  [[0.15]]
grads:  [-0.00703999]
Stock Position:  -0.007039987098185214
Bond Position:  [-4.78117955]


portfolio before change:  [-5.46851992]
curr_Stock_Price:  97.5913061321597
curr_Factors:  [97.59130613]
mat_Sqrt:  [[0.15]]
grads:  [0.04358703]
Stock Position:  0.04358702734837007
Bond Position:  [-9.72223485]


portfolio before change:  [-5.45930543]
curr_Stock_Price:  97.81665187197063
curr_Factors:  [97.81665187]
mat_Sqrt:  [[0.15]]
grads:  [0.00270488]
Stock Position:  0.0027048840197413672
Bond Position:  [-5.72388812]


portfolio before change:  [-5.45817707]
curr_Stock_Price:  98.366068905817
curr_Factors:  [98.36606891]
mat_Sqrt:  [[0.15]]
grads:  [0.06088975]
Stock Position:  0.060889753026164006
Bond Position:  [-11.44766271]


portfolio before change:  [-5.47239204]
curr_Stock_Price:  98.14436553280099
curr_Factors:  [98.14436553]
mat_Sqrt:  [[0.15]]
grads:  [0.09202131]
Stock Position:  0.09202130892705149
Bond Position:  [-14.50376502]


portfolio before change:  [-5.45098994]
curr_Stock_Price:  98.38679425896126
curr_Factors:  [98.38679426]
mat_Sqrt:  [[0.15]]
grads:  [-0.11680102]
Stock Position:  -0.1168010153293748
Bond Position:  [6.04068752]


portfolio before change:  [-5.45692308]
curr_Stock_Price:  98.44082368021104
curr_Factors:  [98.44082368]
mat_Sqrt:  [[0.15]]
grads:  [0.01225787]
Stock Position:  0.012257872404485327
Bond Position:  [-6.66359813]


portfolio before change:  [-5.46028062]
curr_Stock_Price:  98.2008916898045
curr_Factors:  [98.20089169]
mat_Sqrt:  [[0.15]]
grads:  [-0.04945113]
Stock Position:  -0.04945113306890356
Bond Position:  [-0.60413526]


portfolio before change:  [-5.49101998]
curr_Stock_Price:  98.82173885918074
curr_Factors:  [98.82173886]
mat_Sqrt:  [[0.15]]
grads:  [-0.02505357]
Stock Position:  -0.02505356508159303
Bond Position:  [-3.01518311]


portfolio before change:  [-5.48974919]
curr_Stock_Price:  98.76349403468218
curr_Factors:  [98.76349403]
mat_Sqrt:  [[0.15]]
grads:  [-0.13570591]
Stock Position:  -0.13570591046979968
Bond Position:  [7.91304069]


portfolio before change:  [-5.52854169]
curr_Stock_Price:  99.05299562773025
curr_Factors:  [99.05299563]
mat_Sqrt:  [[0.15]]
grads:  [0.10386807]
Stock Position:  0.10386806612955504
Bond Position:  [-15.81698479]


portfolio before change:  [-5.52055424]
curr_Stock_Price:  99.1394133457561
curr_Factors:  [99.13941335]
mat_Sqrt:  [[0.15]]
grads:  [0.1320553]
Stock Position:  0.13205530374076524
Bond Position:  [-18.61243958]


portfolio before change:  [-5.53738534]
curr_Stock_Price:  99.02076770112565
curr_Factors:  [99.0207677]
mat_Sqrt:  [[0.15]]
grads:  [-0.08006261]
Stock Position:  -0.08006261161332724
Bond Position:  [2.39047593]


portfolio before change:  [-5.55720585]
curr_Stock_Price:  99.27019644482586
curr_Factors:  [99.27019644]
mat_Sqrt:  [[0.15]]
grads:  [0.02858688]
Stock Position:  0.02858688218194625
Bond Position:  [-8.39503126]


portfolio before change:  [-5.56147361]
curr_Stock_Price:  99.13926027910219
curr_Factors:  [99.13926028]
mat_Sqrt:  [[0.15]]
grads:  [-0.01494932]
Stock Position:  -0.014949317822951346
Bond Position:  [-4.0794093]


portfolio before change:  [-5.55461779]
curr_Stock_Price:  98.66360061504679
curr_Factors:  [98.66360062]
mat_Sqrt:  [[0.15]]
grads:  [0.06824093]
Stock Position:  0.06824092992571969
Bond Position:  [-12.28751365]


portfolio before change:  [-5.59504557]
curr_Stock_Price:  98.08242763224342
curr_Factors:  [98.08242763]
mat_Sqrt:  [[0.15]]
grads:  [0.02371929]
Stock Position:  0.023719288040092597
Bond Position:  [-7.92149092]


portfolio before change:  [-5.59153558]
curr_Stock_Price:  98.25128194282186
curr_Factors:  [98.25128194]
mat_Sqrt:  [[0.15]]
grads:  [-0.09769177]
Stock Position:  -0.09769176884287484
Bond Position:  [4.00680595]


portfolio before change:  [-5.62583054]
curr_Stock_Price:  98.60489823046123
curr_Factors:  [98.60489823]
mat_Sqrt:  [[0.15]]
grads:  [0.10920467]
Stock Position:  0.10920467069208586
Bond Position:  [-16.39394598]


portfolio before change:  [-5.54177136]
curr_Stock_Price:  99.38402094634861
curr_Factors:  [99.38402095]
mat_Sqrt:  [[0.15]]
grads:  [-0.01650638]
Stock Position:  -0.016506383036040084
Bond Position:  [-3.90130064]


portfolio before change:  [-5.54652815]
curr_Stock_Price:  99.65742756067816
curr_Factors:  [99.65742756]
mat_Sqrt:  [[0.15]]
grads:  [0.03297444]
Stock Position:  0.03297444117864864
Bond Position:  [-8.83267613]


portfolio before change:  [-5.51983657]
curr_Stock_Price:  100.48363223392978
curr_Factors:  [100.48363223]
mat_Sqrt:  [[0.15]]
grads:  [-0.08913711]
Stock Position:  -0.08913710947239616
Bond Position:  [3.43698395]


portfolio before change:  [-5.57309102]
curr_Stock_Price:  101.08348644458543
curr_Factors:  [101.08348644]
mat_Sqrt:  [[0.15]]
grads:  [0.01025333]
Stock Position:  0.010253328452824978
Bond Position:  [-6.60953321]


portfolio before change:  [-5.57322287]
curr_Stock_Price:  101.11091832652895
curr_Factors:  [101.11091833]
mat_Sqrt:  [[0.15]]
grads:  [0.00944759]
Stock Position:  0.009447591445792002
Bond Position:  [-6.52847751]


portfolio before change:  [-5.56693186]
curr_Stock_Price:  101.81999330899893
curr_Factors:  [101.81999331]
mat_Sqrt:  [[0.15]]
grads:  [-0.0911711]
Stock Position:  -0.09117110127757692
Bond Position:  [3.71610906]


portfolio before change:  [-5.47623208]
curr_Stock_Price:  100.82771056205098
curr_Factors:  [100.82771056]
mat_Sqrt:  [[0.15]]
grads:  [-0.03384896]
Stock Position:  -0.033848959313954506
Bond Position:  [-2.06331901]


portfolio before change:  [-5.49767428]
curr_Stock_Price:  101.45736764986681
curr_Factors:  [101.45736765]
mat_Sqrt:  [[0.15]]
grads:  [-0.00643267]
Stock Position:  -0.006432672625576941
Bond Position:  [-4.84503225]


portfolio before change:  [-5.49699291]
curr_Stock_Price:  101.30436842136474
curr_Factors:  [101.30436842]
mat_Sqrt:  [[0.15]]
grads:  [0.0090831]
Stock Position:  0.00908309810977581
Bond Position:  [-6.41715043]


portfolio before change:  [-5.49343028]
curr_Stock_Price:  101.74075202928398
curr_Factors:  [101.74075203]
mat_Sqrt:  [[0.15]]
grads:  [-0.02068791]
Stock Position:  -0.020687905243393027
Bond Position:  [-3.38862724]


portfolio before change:  [-5.48614368]
curr_Stock_Price:  101.37829901361219
curr_Factors:  [101.37829901]
mat_Sqrt:  [[0.15]]
grads:  [0.02503392]
Stock Position:  0.025033916566239482
Bond Position:  [-8.02403956]


portfolio before change:  [-5.48489371]
curr_Stock_Price:  101.44826390970853
curr_Factors:  [101.44826391]
mat_Sqrt:  [[0.15]]
grads:  [0.00054457]
Stock Position:  0.0005445694896993725
Bond Position:  [-5.54013933]


portfolio before change:  [-5.48558819]
curr_Stock_Price:  100.8088405375764
curr_Factors:  [100.80884054]
mat_Sqrt:  [[0.15]]
grads:  [-0.00200163]
Stock Position:  -0.0020016332576000785
Bond Position:  [-5.28380586]


portfolio before change:  [-5.48510616]
curr_Stock_Price:  100.40303757672172
curr_Factors:  [100.40303758]
mat_Sqrt:  [[0.15]]
grads:  [0.0150738]
Stock Position:  0.015073803045837098
Bond Position:  [-6.99856178]


portfolio before change:  [-5.48569122]
curr_Stock_Price:  100.39324364645432
curr_Factors:  [100.39324365]
mat_Sqrt:  [[0.15]]
grads:  [0.0575689]
Stock Position:  0.0575689018368812
Bond Position:  [-11.26522001]


portfolio before change:  [-5.46859864]
curr_Stock_Price:  100.70238060936391
curr_Factors:  [100.70238061]
mat_Sqrt:  [[0.15]]
grads:  [-0.00665828]
Stock Position:  -0.006658283653639769
Bond Position:  [-4.79809363]


portfolio before change:  [-5.46700448]
curr_Stock_Price:  100.41791484584823
curr_Factors:  [100.41791485]
mat_Sqrt:  [[0.15]]
grads:  [-0.13998765]
Stock Position:  -0.1399876485377644
Bond Position:  [8.59026329]


portfolio before change:  [-5.56160926]
curr_Stock_Price:  101.09755833085912
curr_Factors:  [101.09755833]
mat_Sqrt:  [[0.15]]
grads:  [0.0896597]
Stock Position:  0.08965970463668593
Bond Position:  [-14.62598648]


portfolio before change:  [-5.51068143]
curr_Stock_Price:  101.67576663615849
curr_Factors:  [101.67576664]
mat_Sqrt:  [[0.15]]
grads:  [0.03309634]
Stock Position:  0.03309634142958392
Bond Position:  [-8.87577732]


portfolio before change:  [-5.4890303]
curr_Stock_Price:  102.34671352672002
curr_Factors:  [102.34671353]
mat_Sqrt:  [[0.15]]
grads:  [0.07303805]
Stock Position:  0.0730380484064287
Bond Position:  [-12.96423451]


portfolio before change:  [-5.49643536]
curr_Stock_Price:  102.25642117352315
curr_Factors:  [102.25642117]
mat_Sqrt:  [[0.15]]
grads:  [-0.09521919]
Stock Position:  -0.09521919468178067
Bond Position:  [4.24033871]


portfolio before change:  [-5.51136498]
curr_Stock_Price:  102.41599664978926
curr_Factors:  [102.41599665]
mat_Sqrt:  [[0.15]]
grads:  [-0.08466524]
Stock Position:  -0.08466523846229858
Bond Position:  [3.1597098]


portfolio before change:  [-5.55331352]
curr_Stock_Price:  102.91379277815986
curr_Factors:  [102.91379278]
mat_Sqrt:  [[0.15]]
grads:  [-0.02103437]
Stock Position:  -0.02103436982929788
Bond Position:  [-3.38858675]


portfolio before change:  [-5.55983735]
curr_Stock_Price:  103.21387479733332
curr_Factors:  [103.2138748]
mat_Sqrt:  [[0.15]]
grads:  [-0.04020964]
Stock Position:  -0.040209642676754385
Bond Position:  [-1.40964433]


portfolio before change:  [-5.54093599]
curr_Stock_Price:  102.74161321037337
curr_Factors:  [102.74161321]
mat_Sqrt:  [[0.15]]
grads:  [-0.07630316]
Stock Position:  -0.07630316129376183
Bond Position:  [2.2985739]


portfolio before change:  [-5.55135629]
curr_Stock_Price:  102.88006046024073
curr_Factors:  [102.88006046]
mat_Sqrt:  [[0.15]]
grads:  [0.18561232]
Stock Position:  0.18561232020474355
Bond Position:  [-24.64716301]


portfolio before change:  [-5.42922277]
curr_Stock_Price:  103.54636325793015
curr_Factors:  [103.54636326]
mat_Sqrt:  [[0.15]]
grads:  [0.02307931]
Stock Position:  0.023079311644098353
Bond Position:  [-7.81900156]


portfolio before change:  [-5.43746659]
curr_Stock_Price:  103.21034301803186
curr_Factors:  [103.21034302]
mat_Sqrt:  [[0.15]]
grads:  [0.05522292]
Stock Position:  0.055222916891569086
Bond Position:  [-11.13704279]


portfolio before change:  [-5.46434533]
curr_Stock_Price:  102.73621641222535
curr_Factors:  [102.73621641]
mat_Sqrt:  [[0.15]]
grads:  [-0.10854262]
Stock Position:  -0.10854262310816293
Bond Position:  [5.68691308]


portfolio before change:  [-5.45990798]
curr_Stock_Price:  102.69860986815038
curr_Factors:  [102.69860987]
mat_Sqrt:  [[0.15]]
grads:  [-0.05197601]
Stock Position:  -0.0519760080923516
Bond Position:  [-0.1220442]


portfolio before change:  [-5.44107972]
curr_Stock_Price:  102.33621413683505
curr_Factors:  [102.33621414]
mat_Sqrt:  [[0.15]]
grads:  [-0.05348705]
Stock Position:  -0.053487048942127205
Bond Position:  [0.03258237]


portfolio before change:  [-5.48752905]
curr_Stock_Price:  103.20467416224639
curr_Factors:  [103.20467416]
mat_Sqrt:  [[0.15]]
grads:  [0.02570107]
Stock Position:  0.025701071798272336
Bond Position:  [-8.13999979]


portfolio before change:  [-5.50025751]
curr_Stock_Price:  102.72921958812654
curr_Factors:  [102.72921959]
mat_Sqrt:  [[0.15]]
grads:  [0.05108413]
Stock Position:  0.05108412506649787
Bond Position:  [-10.74808981]


portfolio before change:  [-5.52219857]
curr_Stock_Price:  102.31286156785102
curr_Factors:  [102.31286157]
mat_Sqrt:  [[0.15]]
grads:  [0.0078247]
Stock Position:  0.00782470384139338
Bond Position:  [-6.32276641]


portfolio before change:  [-5.52060269]
curr_Stock_Price:  102.56732012235271
curr_Factors:  [102.56732012]
mat_Sqrt:  [[0.15]]
grads:  [-0.08705944]
Stock Position:  -0.08705943892310462
Bond Position:  [3.40885065]


portfolio before change:  [-5.46197826]
curr_Stock_Price:  101.89638340842455
curr_Factors:  [101.89638341]
mat_Sqrt:  [[0.15]]
grads:  [0.02764381]
Stock Position:  0.02764380672592919
Bond Position:  [-8.27878219]


portfolio before change:  [-5.48453622]
curr_Stock_Price:  101.09907917360002
curr_Factors:  [101.09907917]
mat_Sqrt:  [[0.15]]
grads:  [-0.05011462]
Stock Position:  -0.050114619667351236
Bond Position:  [-0.41799432]


portfolio before change:  [-5.48040829]
curr_Stock_Price:  101.01618805421032
curr_Factors:  [101.01618805]
mat_Sqrt:  [[0.15]]
grads:  [0.06933178]
Stock Position:  0.06933178156169381
Bond Position:  [-12.48404058]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.48040829]
Stock Price:  101.16321327240924
PL:  [-6.64362156]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.42045186e-02]
 [-8.77835965e-04]
 [ 6.26468052e-04]
 [ 2.13663668e-03]
 [ 1.30864548e-02]
 [ 1.20502431e-02]
 [-3.07618186e-04]
 [ 5.74470954e-03]
 [-3.54019563e-03]
 [-1.85405563e-02]
 [ 9.39363625e-03]
 [-5.50373992e-03]
 [-9.60903117e-03]
 [ 4.24459659e-03]
 [ 2.81522030e-03]
 [-5.00031847e-03]
 [ 1.22359675e-02]
 [ 1.05426202e-02]
 [ 2.42529497e-02]
 [ 1.16856814e-02]
 [ 5.87466281e-02]
 [-1.46243795e-02]
 [-1.43131784e-03]
 [ 1.29788106e-02]
 [ 7.35916516e-03]
 [ 3.47290474e-03]
 [ 1.31251243e-02]
 [-1.18619941e-02]
 [ 1.98043999e-03]
 [-5.35700662e-03]
 [-3.48722852e-03]
 [-1.82355189e-02]
 [ 1.81325466e-02]
 [ 9.62527724e-03]
 [-2.90114053e-02]
 [ 8.13556426e-03]
 [-2.62446039e-03]
 [ 1.77652641e-03]
 [ 3.64595587e-03]
 [-1.52156633e-02]
 [ 3.37034970e-02]
 [ 6.05931333e-05]
 [ 6.97691551e-03]
 [-9.29259342e-03]
 [-7.49467524e-04]
 [-8.70722242e-03]
 [-1.33389589e-02]
 [ 3.82986584e-05]
 [-2.69374855e-03]
 [-1.81215762e-03]
 [-3.90466337e-03]
 [ 2.93344944e-03]
 [ 3.57367600e-03]
 [ 3.90556738e-04]
 [ 7.34648951e-03]
 [ 8.84424144e-03]
 [ 9.38301814e-03]
 [ 7.69359336e-03]
 [ 1.34423625e-02]
 [-2.34900797e-03]
 [-1.44326043e-03]
 [-2.08546728e-02]
 [-1.28381152e-02]
 [-3.09804420e-03]
 [-7.62093975e-03]
 [ 2.50349380e-02]
 [ 8.23741222e-03]
 [ 1.73688872e-03]
 [ 1.52257675e-02]
 [-1.96401338e-02]
 [ 2.57552678e-02]
 [-2.42342271e-02]
 [-6.64372169e-03]
 [ 7.97438269e-03]
 [-7.58619631e-03]
 [ 3.33882795e-03]
 [ 1.46314310e-02]
 [-1.45272822e-02]
 [-4.98611775e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.4605814]
curr_Stock_Price:  99.89678993082619
curr_Factors:  [99.89678993]
mat_Sqrt:  [[0.15]]
grads:  [-0.22803012]
Stock Position:  -0.2280301237099074
Bond Position:  [23.24005877]


portfolio before change:  [0.29758507]
curr_Stock_Price:  100.61796165866419
curr_Factors:  [100.61796166]
mat_Sqrt:  [[0.15]]
grads:  [-0.00585224]
Stock Position:  -0.00585223976532164
Bond Position:  [0.88642551]


portfolio before change:  [0.29730008]
curr_Stock_Price:  100.67612639231193
curr_Factors:  [100.67612639]
mat_Sqrt:  [[0.15]]
grads:  [0.00417645]
Stock Position:  0.004176453680536022
Bond Position:  [-0.1231691]


portfolio before change:  [0.29539347]
curr_Stock_Price:  100.22145582490367
curr_Factors:  [100.22145582]
mat_Sqrt:  [[0.15]]
grads:  [0.01424424]
Stock Position:  0.014244244503033056
Bond Position:  [-1.13218545]


portfolio before change:  [0.29606274]
curr_Stock_Price:  100.27340905067463
curr_Factors:  [100.27340905]
mat_Sqrt:  [[0.15]]
grads:  [0.08724303]
Stock Position:  0.08724303212349951
Bond Position:  [-8.4520935]


portfolio before change:  [0.38812112]
curr_Stock_Price:  101.33465888394261
curr_Factors:  [101.33465888]
mat_Sqrt:  [[0.15]]
grads:  [0.08033495]
Stock Position:  0.08033495373384264
Bond Position:  [-7.75259401]


portfolio before change:  [0.42491012]
curr_Stock_Price:  101.79863559239556
curr_Factors:  [101.79863559]
mat_Sqrt:  [[0.15]]
grads:  [-0.00205079]
Stock Position:  -0.002050787906384486
Bond Position:  [0.63367753]


portfolio before change:  [0.42549941]
curr_Stock_Price:  101.53059826809951
curr_Factors:  [101.53059827]
mat_Sqrt:  [[0.15]]
grads:  [0.03829806]
Stock Position:  0.03829806360282215
Bond Position:  [-3.4629259]


portfolio before change:  [0.40620471]
curr_Stock_Price:  101.03244599950746
curr_Factors:  [101.032446]
mat_Sqrt:  [[0.15]]
grads:  [-0.0236013]
Stock Position:  -0.023601304219878834
Bond Position:  [2.7907022]


portfolio before change:  [0.4278878]
curr_Stock_Price:  100.12111183808345
curr_Factors:  [100.12111184]
mat_Sqrt:  [[0.15]]
grads:  [-0.12360371]
Stock Position:  -0.12360370848256945
Bond Position:  [12.80322852]


portfolio before change:  [0.43705468]
curr_Stock_Price:  100.05342255022629
curr_Factors:  [100.05342255]
mat_Sqrt:  [[0.15]]
grads:  [0.06262424]
Stock Position:  0.06262424165497069
Bond Position:  [-5.82871503]


portfolio before change:  [0.40064927]
curr_Stock_Price:  99.47790896800896
curr_Factors:  [99.47790897]
mat_Sqrt:  [[0.15]]
grads:  [-0.0366916]
Stock Position:  -0.0366915994839971
Bond Position:  [4.05065286]


portfolio before change:  [0.38647503]
curr_Stock_Price:  99.87111646406265
curr_Factors:  [99.87111646]
mat_Sqrt:  [[0.15]]
grads:  [-0.06406021]
Stock Position:  -0.06406020779739276
Bond Position:  [6.78423951]


portfolio before change:  [0.40752469]
curr_Stock_Price:  99.54914390863858
curr_Factors:  [99.54914391]
mat_Sqrt:  [[0.15]]
grads:  [0.02829731]
Stock Position:  0.028297310586474705
Bond Position:  [-2.40944835]


portfolio before change:  [0.40972696]
curr_Stock_Price:  99.63229200812543
curr_Factors:  [99.63229201]
mat_Sqrt:  [[0.15]]
grads:  [0.01876814]
Stock Position:  0.018768135324724947
Bond Position:  [-1.46018538]


portfolio before change:  [0.42342805]
curr_Stock_Price:  100.36717315771568
curr_Factors:  [100.36717316]
mat_Sqrt:  [[0.15]]
grads:  [-0.03333546]
Stock Position:  -0.03333545648051644
Bond Position:  [3.76921358]


portfolio before change:  [0.42503965]
curr_Stock_Price:  100.32589508781378
curr_Factors:  [100.32589509]
mat_Sqrt:  [[0.15]]
grads:  [0.08157312]
Stock Position:  0.08157311633337753
Bond Position:  [-7.75885626]


portfolio before change:  [0.40403116]
curr_Stock_Price:  100.07429817791693
curr_Factors:  [100.07429818]
mat_Sqrt:  [[0.15]]
grads:  [0.07028413]
Stock Position:  0.0702841348380363
Bond Position:  [-6.6296043]


portfolio before change:  [0.37251289]
curr_Stock_Price:  99.63175296745365
curr_Factors:  [99.63175297]
mat_Sqrt:  [[0.15]]
grads:  [0.16168633]
Stock Position:  0.16168633148525616
Bond Position:  [-15.73657974]


portfolio before change:  [0.26560969]
curr_Stock_Price:  98.97665965441377
curr_Factors:  [98.97665965]
mat_Sqrt:  [[0.15]]
grads:  [0.07790454]
Stock Position:  0.07790454265363109
Bond Position:  [-7.44512171]


portfolio before change:  [0.31165672]
curr_Stock_Price:  99.57370271260207
curr_Factors:  [99.57370271]
mat_Sqrt:  [[0.15]]
grads:  [0.39164419]
Stock Position:  0.3916441875005691
Bond Position:  [-38.68580517]


portfolio before change:  [0.41988286]
curr_Stock_Price:  99.8562144436137
curr_Factors:  [99.85621444]
mat_Sqrt:  [[0.15]]
grads:  [-0.09749586]
Stock Position:  -0.09749586308252693
Bond Position:  [10.15545067]


portfolio before change:  [0.48327074]
curr_Stock_Price:  99.21256514376657
curr_Factors:  [99.21256514]
mat_Sqrt:  [[0.15]]
grads:  [-0.00954212]
Stock Position:  -0.00954211895604298
Bond Position:  [1.42996884]


portfolio before change:  [0.48828713]
curr_Stock_Price:  98.69622173811278
curr_Factors:  [98.69622174]
mat_Sqrt:  [[0.15]]
grads:  [0.0865254]
Stock Position:  0.08652540393627967
Bond Position:  [-8.05144332]


portfolio before change:  [0.51080837]
curr_Stock_Price:  98.96232246034157
curr_Factors:  [98.96232246]
mat_Sqrt:  [[0.15]]
grads:  [0.0490611]
Stock Position:  0.049061101037317555
Bond Position:  [-4.34439213]


portfolio before change:  [0.50990196]
curr_Stock_Price:  98.94938188595425
curr_Factors:  [98.94938189]
mat_Sqrt:  [[0.15]]
grads:  [0.0231527]
Stock Position:  0.023152698280851106
Bond Position:  [-1.78104323]


portfolio before change:  [0.50190426]
curr_Stock_Price:  98.60875718230672
curr_Factors:  [98.60875718]
mat_Sqrt:  [[0.15]]
grads:  [0.08750083]
Stock Position:  0.08750082868328081
Bond Position:  [-8.12644371]


portfolio before change:  [0.51930143]
curr_Stock_Price:  98.81338480271562
curr_Factors:  [98.8133848]
mat_Sqrt:  [[0.15]]
grads:  [-0.07907996]
Stock Position:  -0.079079960787629
Bond Position:  [8.33346002]


portfolio before change:  [0.53439171]
curr_Stock_Price:  98.62914812532297
curr_Factors:  [98.62914813]
mat_Sqrt:  [[0.15]]
grads:  [0.01320293]
Stock Position:  0.013202933242535303
Bond Position:  [-0.76780234]


portfolio before change:  [0.52480624]
curr_Stock_Price:  97.90677221367883
curr_Factors:  [97.90677221]
mat_Sqrt:  [[0.15]]
grads:  [-0.03571338]
Stock Position:  -0.03571337748734988
Bond Position:  [4.02138776]


portfolio before change:  [0.53801995]
curr_Stock_Price:  97.5438168234453
curr_Factors:  [97.54381682]
mat_Sqrt:  [[0.15]]
grads:  [-0.02324819]
Stock Position:  -0.023248190140849664
Bond Position:  [2.80573715]


portfolio before change:  [0.52895109]
curr_Stock_Price:  97.94144880261896
curr_Factors:  [97.9414488]
mat_Sqrt:  [[0.15]]
grads:  [-0.12157013]
Stock Position:  -0.12157012603282724
Bond Position:  [12.43570537]


portfolio before change:  [0.54274668]
curr_Stock_Price:  97.83436380263781
curr_Factors:  [97.8343638]
mat_Sqrt:  [[0.15]]
grads:  [0.12088364]
Stock Position:  0.12088364417419124
Bond Position:  [-11.28382774]


portfolio before change:  [0.46902059]
curr_Stock_Price:  97.23030501104965
curr_Factors:  [97.23030501]
mat_Sqrt:  [[0.15]]
grads:  [0.06416851]
Stock Position:  0.06416851491635846
Bond Position:  [-5.77010368]


portfolio before change:  [0.41591667]
curr_Stock_Price:  96.40835548798924
curr_Factors:  [96.40835549]
mat_Sqrt:  [[0.15]]
grads:  [-0.19340937]
Stock Position:  -0.19340936878847934
Bond Position:  [19.06219585]


portfolio before change:  [0.40265105]
curr_Stock_Price:  96.48310389970888
curr_Factors:  [96.4831039]
mat_Sqrt:  [[0.15]]
grads:  [0.0542371]
Stock Position:  0.05423709505415319
Bond Position:  [-4.83031222]


portfolio before change:  [0.42908086]
curr_Stock_Price:  96.97597154109438
curr_Factors:  [96.97597154]
mat_Sqrt:  [[0.15]]
grads:  [-0.0174964]
Stock Position:  -0.017496402575934874
Bond Position:  [2.1258115]


portfolio before change:  [0.42335696]
curr_Stock_Price:  97.31071256048035
curr_Factors:  [97.31071256]
mat_Sqrt:  [[0.15]]
grads:  [0.01184351]
Stock Position:  0.011843509380297356
Bond Position:  [-0.72914338]


portfolio before change:  [0.43184244]
curr_Stock_Price:  98.03102715672192
curr_Factors:  [98.03102716]
mat_Sqrt:  [[0.15]]
grads:  [0.02430637]
Stock Position:  0.02430637248168819
Bond Position:  [-1.95093622]


portfolio before change:  [0.42592795]
curr_Stock_Price:  97.79271293004682
curr_Factors:  [97.79271293]
mat_Sqrt:  [[0.15]]
grads:  [-0.10143776]
Stock Position:  -0.10143775513602014
Bond Position:  [10.34580122]


portfolio before change:  [0.43609438]
curr_Stock_Price:  97.69886430133606
curr_Factors:  [97.6988643]
mat_Sqrt:  [[0.15]]
grads:  [0.22468998]
Stock Position:  0.22468998004477947
Bond Position:  [-21.51586149]


portfolio before change:  [0.31666166]
curr_Stock_Price:  97.17330488840203
curr_Factors:  [97.17330489]
mat_Sqrt:  [[0.15]]
grads:  [0.00040395]
Stock Position:  0.0004039542222823624
Bond Position:  [0.27740809]


portfolio before change:  [0.31637902]
curr_Stock_Price:  96.43069353221523
curr_Factors:  [96.43069353]
mat_Sqrt:  [[0.15]]
grads:  [0.04651277]
Stock Position:  0.046512770092107775
Bond Position:  [-4.16887966]


portfolio before change:  [0.31227796]
curr_Stock_Price:  96.34812483420177
curr_Factors:  [96.34812483]
mat_Sqrt:  [[0.15]]
grads:  [-0.06195062]
Stock Position:  -0.061950622787732966
Bond Position:  [6.28110429]


portfolio before change:  [0.30265751]
curr_Stock_Price:  96.50975392292699
curr_Factors:  [96.50975392]
mat_Sqrt:  [[0.15]]
grads:  [-0.00499645]
Stock Position:  -0.00499645016129467
Bond Position:  [0.78486369]


portfolio before change:  [0.30143771]
curr_Stock_Price:  96.76370620277812
curr_Factors:  [96.7637062]
mat_Sqrt:  [[0.15]]
grads:  [-0.05804815]
Stock Position:  -0.05804814945094617
Bond Position:  [5.91839179]


portfolio before change:  [0.33514478]
curr_Stock_Price:  96.18940441183055
curr_Factors:  [96.18940441]
mat_Sqrt:  [[0.15]]
grads:  [-0.08892639]
Stock Position:  -0.08892639286801363
Bond Position:  [8.88892154]


portfolio before change:  [0.29416152]
curr_Stock_Price:  96.65651918560067
curr_Factors:  [96.65651919]
mat_Sqrt:  [[0.15]]
grads:  [0.00025532]
Stock Position:  0.00025532438927221523
Bond Position:  [0.26948275]


portfolio before change:  [0.29410705]
curr_Stock_Price:  96.37722036832437
curr_Factors:  [96.37722037]
mat_Sqrt:  [[0.15]]
grads:  [-0.01795832]
Stock Position:  -0.017958323662784992
Bond Position:  [2.02488037]


portfolio before change:  [0.2907494]
curr_Stock_Price:  96.57123687907512
curr_Factors:  [96.57123688]
mat_Sqrt:  [[0.15]]
grads:  [-0.01208105]
Stock Position:  -0.012081050769610855
Bond Position:  [1.45743141]


portfolio before change:  [0.29479931]
curr_Stock_Price:  96.24354845132268
curr_Factors:  [96.24354845]
mat_Sqrt:  [[0.15]]
grads:  [-0.02603109]
Stock Position:  -0.02603108916418982
Bond Position:  [2.8001237]


portfolio before change:  [0.28548123]
curr_Stock_Price:  96.60823149856706
curr_Factors:  [96.6082315]
mat_Sqrt:  [[0.15]]
grads:  [0.01955633]
Stock Position:  0.019556329576417484
Bond Position:  [-1.60382119]


portfolio before change:  [0.27871852]
curr_Stock_Price:  96.2675508467776
curr_Factors:  [96.26755085]
mat_Sqrt:  [[0.15]]
grads:  [0.02382451]
Stock Position:  0.02382450668104972
Bond Position:  [-2.01480839]


portfolio before change:  [0.28464403]
curr_Stock_Price:  96.52155119746428
curr_Factors:  [96.5215512]
mat_Sqrt:  [[0.15]]
grads:  [0.00260371]
Stock Position:  0.0026037115851259337
Bond Position:  [0.03332975]


portfolio before change:  [0.28386797]
curr_Stock_Price:  96.22269500986746
curr_Factors:  [96.22269501]
mat_Sqrt:  [[0.15]]
grads:  [0.0489766]
Stock Position:  0.04897659670157256
Bond Position:  [-4.42879215]


portfolio before change:  [0.29065479]
curr_Stock_Price:  96.36691945312272
curr_Factors:  [96.36691945]
mat_Sqrt:  [[0.15]]
grads:  [0.05896161]
Stock Position:  0.058961609599052285
Bond Position:  [-5.39129389]


portfolio before change:  [0.27483681]
curr_Stock_Price:  96.10435862547341
curr_Factors:  [96.10435863]
mat_Sqrt:  [[0.15]]
grads:  [0.06255345]
Stock Position:  0.0625534542936176
Bond Position:  [-5.73682279]


portfolio before change:  [0.28091173]
curr_Stock_Price:  96.2072062919976
curr_Factors:  [96.20720629]
mat_Sqrt:  [[0.15]]
grads:  [0.05129062]
Stock Position:  0.05129062241802463
Bond Position:  [-4.65361576]


portfolio before change:  [0.29377936]
curr_Stock_Price:  96.46375409895859
curr_Factors:  [96.4637541]
mat_Sqrt:  [[0.15]]
grads:  [0.08961575]
Stock Position:  0.08961575013249969
Bond Position:  [-8.35089232]


portfolio before change:  [0.29023978]
curr_Stock_Price:  96.43008102839502
curr_Factors:  [96.43008103]
mat_Sqrt:  [[0.15]]
grads:  [-0.01566005]
Stock Position:  -0.01566005314797408
Bond Position:  [1.80033997]


portfolio before change:  [0.29196919]
curr_Stock_Price:  96.32683172272309
curr_Factors:  [96.32683172]
mat_Sqrt:  [[0.15]]
grads:  [-0.00962174]
Stock Position:  -0.009621736212613696
Bond Position:  [1.21880056]


portfolio before change:  [0.29312993]
curr_Stock_Price:  96.21411254932426
curr_Factors:  [96.21411255]
mat_Sqrt:  [[0.15]]
grads:  [-0.13903115]
Stock Position:  -0.13903115216442202
Bond Position:  [13.66988885]


portfolio before change:  [0.3694644]
curr_Stock_Price:  95.67121205052962
curr_Factors:  [95.67121205]
mat_Sqrt:  [[0.15]]
grads:  [-0.08558743]
Stock Position:  -0.08558743461124248
Bond Position:  [8.55771801]


portfolio before change:  [0.44033855]
curr_Stock_Price:  94.84937097461068
curr_Factors:  [94.84937097]
mat_Sqrt:  [[0.15]]
grads:  [-0.02065363]
Stock Position:  -0.020653628028112818
Bond Position:  [2.39932217]


portfolio before change:  [0.42449049]
curr_Stock_Price:  95.62395707412898
curr_Factors:  [95.62395707]
mat_Sqrt:  [[0.15]]
grads:  [-0.05080627]
Stock Position:  -0.050806265032777805
Bond Position:  [5.2827866]


portfolio before change:  [0.46173603]
curr_Stock_Price:  94.89736651156964
curr_Factors:  [94.89736651]
mat_Sqrt:  [[0.15]]
grads:  [0.16689959]
Stock Position:  0.16689958669761112
Bond Position:  [-15.37659522]


portfolio before change:  [0.49062313]
curr_Stock_Price:  95.07620555489575
curr_Factors:  [95.07620555]
mat_Sqrt:  [[0.15]]
grads:  [0.05491608]
Stock Position:  0.05491608148785496
Bond Position:  [-4.73058952]


portfolio before change:  [0.47933279]
curr_Stock_Price:  94.87599702655466
curr_Factors:  [94.87599703]
mat_Sqrt:  [[0.15]]
grads:  [0.01157926]
Stock Position:  0.011579258135272575
Bond Position:  [-0.61926087]


portfolio before change:  [0.47148214]
curr_Stock_Price:  94.20134769952433
curr_Factors:  [94.2013477]
mat_Sqrt:  [[0.15]]
grads:  [0.10150512]
Stock Position:  0.10150511658239102
Bond Position:  [-9.09043664]


portfolio before change:  [0.47236306]
curr_Stock_Price:  94.21562367240517
curr_Factors:  [94.21562367]
mat_Sqrt:  [[0.15]]
grads:  [-0.13093423]
Stock Position:  -0.13093422537869512
Bond Position:  [12.80841276]


portfolio before change:  [0.58342674]
curr_Stock_Price:  93.37349752166371
curr_Factors:  [93.37349752]
mat_Sqrt:  [[0.15]]
grads:  [0.17170179]
Stock Position:  0.1717017853330578
Bond Position:  [-15.44896948]


portfolio before change:  [0.62208527]
curr_Stock_Price:  93.60427039192184
curr_Factors:  [93.60427039]
mat_Sqrt:  [[0.15]]
grads:  [-0.16156151]
Stock Position:  -0.16156151390029178
Bond Position:  [15.7449329]


portfolio before change:  [0.65300952]
curr_Stock_Price:  93.41895296553113
curr_Factors:  [93.41895297]
mat_Sqrt:  [[0.15]]
grads:  [-0.04429148]
Stock Position:  -0.044291477939138395
Bond Position:  [4.79067301]


portfolio before change:  [0.65812539]
curr_Stock_Price:  93.3102087312563
curr_Factors:  [93.31020873]
mat_Sqrt:  [[0.15]]
grads:  [0.05316255]
Stock Position:  0.05316255124334791
Bond Position:  [-4.30248336]


portfolio before change:  [0.7209069]
curr_Stock_Price:  94.49620193864048
curr_Factors:  [94.49620194]
mat_Sqrt:  [[0.15]]
grads:  [-0.05057464]
Stock Position:  -0.05057464209984335
Bond Position:  [5.50001849]


portfolio before change:  [0.69827574]
curr_Stock_Price:  94.95047952954216
curr_Factors:  [94.95047953]
mat_Sqrt:  [[0.15]]
grads:  [0.02225885]
Stock Position:  0.02225885297376163
Bond Position:  [-1.41521303]


portfolio before change:  [0.69199803]
curr_Stock_Price:  94.67242165123372
curr_Factors:  [94.67242165]
mat_Sqrt:  [[0.15]]
grads:  [0.09754287]
Stock Position:  0.09754287329631457
Bond Position:  [-8.542622]


portfolio before change:  [0.66507722]
curr_Stock_Price:  94.40190593128342
curr_Factors:  [94.40190593]
mat_Sqrt:  [[0.15]]
grads:  [-0.09684855]
Stock Position:  -0.09684854779196685
Bond Position:  [9.80776472]


portfolio before change:  [0.64846186]
curr_Stock_Price:  94.57979571587748
curr_Factors:  [94.57979572]
mat_Sqrt:  [[0.15]]
grads:  [-0.33240785]
Stock Position:  -0.3324078497535269
Bond Position:  [32.08752838]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.64846186]
Stock Price:  95.23817055167338
PL:  [0.64846186]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.72336749e-02]
 [-1.52773233e-03]
 [ 2.75171334e-04]
 [ 6.53939221e-04]
 [-7.09938531e-03]
 [ 6.67897744e-03]
 [ 7.66777017e-04]
 [ 5.02163602e-04]
 [ 3.28931579e-03]
 [ 2.51517201e-02]
 [ 9.40785834e-03]
 [-8.53491630e-03]
 [ 3.34372949e-03]
 [ 5.56723165e-03]
 [-2.17789577e-02]
 [ 1.45474076e-02]
 [ 5.70404797e-06]
 [ 7.62736812e-03]
 [ 2.22537929e-02]
 [ 1.67938014e-03]
 [ 6.19087195e-02]
 [-1.31616107e-02]
 [-1.57592509e-04]
 [ 8.82296645e-03]
 [ 1.31772023e-02]
 [ 1.22690224e-03]
 [ 1.23128104e-02]
 [-7.82250771e-03]
 [ 1.95189799e-03]
 [-6.08583859e-03]
 [-3.50037488e-03]
 [-1.58071242e-02]
 [ 1.69082849e-02]
 [ 1.29568414e-02]
 [-1.87010310e-02]
 [ 6.98901078e-03]
 [-2.19262207e-03]
 [ 1.14107152e-02]
 [ 2.14861382e-03]
 [-1.39946649e-02]
 [ 1.96211121e-02]
 [-8.26516848e-04]
 [ 3.33641517e-03]
 [-9.19343140e-03]
 [ 2.80814262e-03]
 [-2.02131990e-03]
 [-1.36940826e-02]
 [-5.08238676e-03]
 [-6.63202514e-03]
 [ 3.39522096e-03]
 [-3.45818972e-03]
 [ 3.13275816e-03]
 [ 2.88387014e-03]
 [-1.47793148e-04]
 [ 1.45825799e-03]
 [ 8.75152073e-03]
 [ 1.71130525e-02]
 [-2.50795154e-02]
 [ 1.40402494e-02]
 [ 8.51664908e-03]
 [ 8.04556709e-03]
 [-1.23858934e-02]
 [-1.25496414e-02]
 [-2.18960129e-03]
 [-2.00368352e-02]
 [ 2.94316766e-02]
 [ 2.03220154e-02]
 [ 2.07930537e-03]
 [ 6.88809475e-03]
 [-1.66706830e-02]
 [ 3.15591933e-03]
 [ 9.32403983e-04]
 [ 5.21244843e-04]
 [ 8.65774936e-03]
 [ 9.10036368e-03]
 [-2.30380293e-03]
 [-4.58307237e-03]
 [-9.89177038e-03]
 [-5.74501260e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.54660977]
curr_Stock_Price:  100.09513100982734
curr_Factors:  [100.09513101]
mat_Sqrt:  [[0.15]]
grads:  [-0.2482245]
Stock Position:  -0.24822449911942684
Bond Position:  [28.39267353]


portfolio before change:  [3.45209199]
curr_Stock_Price:  100.48305558539573
curr_Factors:  [100.48305559]
mat_Sqrt:  [[0.15]]
grads:  [-0.01018488]
Stock Position:  -0.01018488222447539
Bond Position:  [4.47550007]


portfolio before change:  [3.45646163]
curr_Stock_Price:  100.081488229338
curr_Factors:  [100.08148823]
mat_Sqrt:  [[0.15]]
grads:  [0.00183448]
Stock Position:  0.0018344755568210254
Bond Position:  [3.27286459]


portfolio before change:  [3.45528306]
curr_Stock_Price:  99.32752194335467
curr_Factors:  [99.32752194]
mat_Sqrt:  [[0.15]]
grads:  [0.00435959]
Stock Position:  0.00435959480746924
Bond Position:  [3.02225531]


portfolio before change:  [3.45489106]
curr_Stock_Price:  99.19427585468219
curr_Factors:  [99.19427585]
mat_Sqrt:  [[0.15]]
grads:  [-0.04732924]
Stock Position:  -0.04732923538879257
Bond Position:  [8.14968029]


portfolio before change:  [3.47691913]
curr_Stock_Price:  98.73961608467862
curr_Factors:  [98.73961608]
mat_Sqrt:  [[0.15]]
grads:  [0.04452652]
Stock Position:  0.04452651625318937
Bond Position:  [-0.91961199]


portfolio before change:  [3.46647884]
curr_Stock_Price:  98.50643342847364
curr_Factors:  [98.50643343]
mat_Sqrt:  [[0.15]]
grads:  [0.00511185]
Stock Position:  0.005111846781394029
Bond Position:  [2.96292904]


portfolio before change:  [3.46426893]
curr_Stock_Price:  98.03789442597882
curr_Factors:  [98.03789443]
mat_Sqrt:  [[0.15]]
grads:  [0.00334776]
Stock Position:  0.003347757345952204
Bond Position:  [3.13606184]


portfolio before change:  [3.46309274]
curr_Stock_Price:  97.62800785431628
curr_Factors:  [97.62800785]
mat_Sqrt:  [[0.15]]
grads:  [0.02192877]
Stock Position:  0.02192877192739993
Bond Position:  [1.32223042]


portfolio before change:  [3.46309498]
curr_Stock_Price:  97.6243415407859
curr_Factors:  [97.62434154]
mat_Sqrt:  [[0.15]]
grads:  [0.16767813]
Stock Position:  0.16767813369240053
Bond Position:  [-12.90637241]


portfolio before change:  [3.42669247]
curr_Stock_Price:  97.41205485415654
curr_Factors:  [97.41205485]
mat_Sqrt:  [[0.15]]
grads:  [0.06271906]
Stock Position:  0.06271905560476553
Bond Position:  [-2.68289961]


portfolio before change:  [3.47211816]
curr_Stock_Price:  98.13900107833993
curr_Factors:  [98.13900108]
mat_Sqrt:  [[0.15]]
grads:  [-0.05689944]
Stock Position:  -0.05689944197339107
Bond Position:  [9.05617256]


portfolio before change:  [3.48327846]
curr_Stock_Price:  97.9528083388333
curr_Factors:  [97.95280834]
mat_Sqrt:  [[0.15]]
grads:  [0.02229153]
Stock Position:  0.022291529906206232
Bond Position:  [1.2997605]


portfolio before change:  [3.47844938]
curr_Stock_Price:  97.73253107154822
curr_Factors:  [97.73253107]
mat_Sqrt:  [[0.15]]
grads:  [0.03711488]
Stock Position:  0.03711487763618933
Bond Position:  [-0.14888156]


portfolio before change:  [3.47590313]
curr_Stock_Price:  97.6641773682852
curr_Factors:  [97.66417737]
mat_Sqrt:  [[0.15]]
grads:  [-0.14519305]
Stock Position:  -0.14519305132017732
Bond Position:  [17.65606305]


portfolio before change:  [3.37015332]
curr_Stock_Price:  98.40011718351721
curr_Factors:  [98.40011718]
mat_Sqrt:  [[0.15]]
grads:  [0.09698272]
Stock Position:  0.09698271738524829
Bond Position:  [-6.17295743]


portfolio before change:  [3.44707836]
curr_Stock_Price:  99.19727839177696
curr_Factors:  [99.19727839]
mat_Sqrt:  [[0.15]]
grads:  [3.80269865e-05]
Stock Position:  3.802698646706041e-05
Bond Position:  [3.44330619]


portfolio before change:  [3.44730524]
curr_Stock_Price:  99.5040536364955
curr_Factors:  [99.50405364]
mat_Sqrt:  [[0.15]]
grads:  [0.05084912]
Stock Position:  0.05084912083264173
Bond Position:  [-1.61238841]


portfolio before change:  [3.47123784]
curr_Stock_Price:  99.97669459787345
curr_Factors:  [99.9766946]
mat_Sqrt:  [[0.15]]
grads:  [0.14835862]
Stock Position:  0.1483586194590779
Bond Position:  [-11.36116655]


portfolio before change:  [3.59967761]
curr_Stock_Price:  100.84721944075253
curr_Factors:  [100.84721944]
mat_Sqrt:  [[0.15]]
grads:  [0.01119587]
Stock Position:  0.011195867625739138
Bond Position:  [2.47060549]


portfolio before change:  [3.60851902]
curr_Stock_Price:  101.62312994420815
curr_Factors:  [101.62312994]
mat_Sqrt:  [[0.15]]
grads:  [0.4127248]
Stock Position:  0.4127247963556223
Bond Position:  [-38.33386659]


portfolio before change:  [3.24056751]
curr_Stock_Price:  100.73741729895261
curr_Factors:  [100.7374173]
mat_Sqrt:  [[0.15]]
grads:  [-0.08774407]
Stock Position:  -0.08774407152756823
Bond Position:  [12.07967865]


portfolio before change:  [3.26458085]
curr_Stock_Price:  100.47234712464804
curr_Factors:  [100.47234712]
mat_Sqrt:  [[0.15]]
grads:  [-0.00105062]
Stock Position:  -0.001050616726876325
Bond Position:  [3.37013877]


portfolio before change:  [3.26490452]
curr_Stock_Price:  100.36476106350348
curr_Factors:  [100.36476106]
mat_Sqrt:  [[0.15]]
grads:  [0.05881978]
Stock Position:  0.05881977636168763
Bond Position:  [-2.63852828]


portfolio before change:  [3.24585838]
curr_Stock_Price:  100.04375985933888
curr_Factors:  [100.04375986]
mat_Sqrt:  [[0.15]]
grads:  [0.08784802]
Stock Position:  0.08784801562726513
Bond Position:  [-5.54278739]


portfolio before change:  [3.1717918]
curr_Stock_Price:  99.2045815880114
curr_Factors:  [99.20458159]
mat_Sqrt:  [[0.15]]
grads:  [0.00817935]
Stock Position:  0.00817934827640703
Bond Position:  [2.36036298]


portfolio before change:  [3.17259046]
curr_Stock_Price:  99.28418843542205
curr_Factors:  [99.28418844]
mat_Sqrt:  [[0.15]]
grads:  [0.0820854]
Stock Position:  0.08208540284536316
Bond Position:  [-4.97719214]


portfolio before change:  [3.17137228]
curr_Stock_Price:  99.27313778055036
curr_Factors:  [99.27313778]
mat_Sqrt:  [[0.15]]
grads:  [-0.05215005]
Stock Position:  -0.0521500513871979
Bond Position:  [8.34847152]


portfolio before change:  [3.20745557]
curr_Stock_Price:  98.59123059352352
curr_Factors:  [98.59123059]
mat_Sqrt:  [[0.15]]
grads:  [0.01301265]
Stock Position:  0.013012653248040271
Bond Position:  [1.92452208]


portfolio before change:  [3.2000229]
curr_Stock_Price:  98.01079875314994
curr_Factors:  [98.01079875]
mat_Sqrt:  [[0.15]]
grads:  [-0.04057226]
Stock Position:  -0.0405722572598624
Bond Position:  [7.17654224]


portfolio before change:  [3.21715658]
curr_Stock_Price:  97.59955382641571
curr_Factors:  [97.59955383]
mat_Sqrt:  [[0.15]]
grads:  [-0.02333583]
Stock Position:  -0.02333583254950018
Bond Position:  [5.49472343]


portfolio before change:  [3.20130739]
curr_Stock_Price:  98.2934492169164
curr_Factors:  [98.29344922]
mat_Sqrt:  [[0.15]]
grads:  [-0.10538083]
Stock Position:  -0.10538082775911733
Bond Position:  [13.55955243]


portfolio before change:  [3.2096166]
curr_Stock_Price:  98.22264212671173
curr_Factors:  [98.22264213]
mat_Sqrt:  [[0.15]]
grads:  [0.1127219]
Stock Position:  0.11272189963183665
Bond Position:  [-7.86222621]


portfolio before change:  [3.18370268]
curr_Stock_Price:  97.99710911089639
curr_Factors:  [97.99710911]
mat_Sqrt:  [[0.15]]
grads:  [0.08637894]
Stock Position:  0.0863789427271985
Bond Position:  [-5.28118399]


portfolio before change:  [3.18026429]
curr_Stock_Price:  97.96112452471135
curr_Factors:  [97.96112452]
mat_Sqrt:  [[0.15]]
grads:  [-0.12467354]
Stock Position:  -0.1246735397186354
Bond Position:  [15.39342444]


portfolio before change:  [3.16343207]
curr_Stock_Price:  98.10385198770172
curr_Factors:  [98.10385199]
mat_Sqrt:  [[0.15]]
grads:  [0.04659341]
Stock Position:  0.04659340519738482
Bond Position:  [-1.40756046]


portfolio before change:  [3.22097725]
curr_Stock_Price:  99.34079004991015
curr_Factors:  [99.34079005]
mat_Sqrt:  [[0.15]]
grads:  [-0.01461748]
Stock Position:  -0.014617480492250975
Bond Position:  [4.67308931]


portfolio before change:  [3.22580617]
curr_Stock_Price:  99.03041913473774
curr_Factors:  [99.03041913]
mat_Sqrt:  [[0.15]]
grads:  [0.07607143]
Stock Position:  0.07607143471910705
Bond Position:  [-4.3075799]


portfolio before change:  [3.21338922]
curr_Stock_Price:  98.87073087526662
curr_Factors:  [98.87073088]
mat_Sqrt:  [[0.15]]
grads:  [0.01432409]
Stock Position:  0.014324092102215892
Bond Position:  [1.79715576]


portfolio before change:  [3.21233338]
curr_Stock_Price:  98.78917863821106
curr_Factors:  [98.78917864]
mat_Sqrt:  [[0.15]]
grads:  [-0.09329777]
Stock Position:  -0.0932977657769842
Bond Position:  [12.42914303]


portfolio before change:  [3.24575145]
curr_Stock_Price:  98.43931800070483
curr_Factors:  [98.439318]
mat_Sqrt:  [[0.15]]
grads:  [0.13080741]
Stock Position:  0.1308074137857832
Bond Position:  [-9.63084116]


portfolio before change:  [3.16038302]
curr_Stock_Price:  97.79129294897312
curr_Factors:  [97.79129295]
mat_Sqrt:  [[0.15]]
grads:  [-0.00551011]
Stock Position:  -0.005510112319623264
Bond Position:  [3.69922403]


portfolio before change:  [3.15652838]
curr_Stock_Price:  98.53280992319114
curr_Factors:  [98.53280992]
mat_Sqrt:  [[0.15]]
grads:  [0.02224277]
Stock Position:  0.022242767800853023
Bond Position:  [0.96488597]


portfolio before change:  [3.17220808]
curr_Stock_Price:  99.23503309157334
curr_Factors:  [99.23503309]
mat_Sqrt:  [[0.15]]
grads:  [-0.06128954]
Stock Position:  -0.061289542637265354
Bond Position:  [9.25427787]


portfolio before change:  [3.15338879]
curr_Stock_Price:  99.55152588828061
curr_Factors:  [99.55152589]
mat_Sqrt:  [[0.15]]
grads:  [0.01872095]
Stock Position:  0.01872095079491468
Bond Position:  [1.28968957]


portfolio before change:  [3.15595221]
curr_Stock_Price:  99.68414786704533
curr_Factors:  [99.68414787]
mat_Sqrt:  [[0.15]]
grads:  [-0.01347547]
Stock Position:  -0.013475465974858564
Bond Position:  [4.49924255]


portfolio before change:  [3.1573546]
curr_Stock_Price:  99.60094595414509
curr_Factors:  [99.60094595]
mat_Sqrt:  [[0.15]]
grads:  [-0.09129388]
Stock Position:  -0.09129388374090877
Bond Position:  [12.25031178]


portfolio before change:  [3.10641751]
curr_Stock_Price:  100.16727915706956
curr_Factors:  [100.16727916]
mat_Sqrt:  [[0.15]]
grads:  [-0.03388258]
Stock Position:  -0.03388257842924582
Bond Position:  [6.50034321]


portfolio before change:  [3.17139102]
curr_Stock_Price:  98.2616620715707
curr_Factors:  [98.26166207]
mat_Sqrt:  [[0.15]]
grads:  [-0.0442135]
Stock Position:  -0.0442135009525006
Bond Position:  [7.51588311]


portfolio before change:  [3.20893301]
curr_Stock_Price:  97.42317997183966
curr_Factors:  [97.42317997]
mat_Sqrt:  [[0.15]]
grads:  [0.02263481]
Stock Position:  0.0226348064322881
Bond Position:  [1.00377819]


portfolio before change:  [3.21055903]
curr_Stock_Price:  97.49224575063525
curr_Factors:  [97.49224575]
mat_Sqrt:  [[0.15]]
grads:  [-0.0230546]
Stock Position:  -0.023054598110660914
Bond Position:  [5.45820358]


portfolio before change:  [3.19746764]
curr_Stock_Price:  98.0748861582948
curr_Factors:  [98.07488616]
mat_Sqrt:  [[0.15]]
grads:  [0.02088505]
Stock Position:  0.02088505438280619
Bond Position:  [1.14916831]


portfolio before change:  [3.20636592]
curr_Stock_Price:  98.49750680030719
curr_Factors:  [98.4975068]
mat_Sqrt:  [[0.15]]
grads:  [0.0192258]
Stock Position:  0.019225800927727858
Bond Position:  [1.31267247]


portfolio before change:  [3.21687562]
curr_Stock_Price:  99.03988465585951
curr_Factors:  [99.03988466]
mat_Sqrt:  [[0.15]]
grads:  [-0.00098529]
Stock Position:  -0.000985287653368569
Bond Position:  [3.31445839]


portfolio before change:  [3.21678905]
curr_Stock_Price:  99.33799750348233
curr_Factors:  [99.3379975]
mat_Sqrt:  [[0.15]]
grads:  [0.00972172]
Stock Position:  0.009721719965210028
Bond Position:  [2.25105286]


portfolio before change:  [3.22481762]
curr_Stock_Price:  100.14936381729537
curr_Factors:  [100.14936382]
mat_Sqrt:  [[0.15]]
grads:  [0.05834347]
Stock Position:  0.05834347153803423
Bond Position:  [-2.61824394]


portfolio before change:  [3.17393122]
curr_Stock_Price:  99.27998190620468
curr_Factors:  [99.27998191]
mat_Sqrt:  [[0.15]]
grads:  [0.11408702]
Stock Position:  0.11408701663800119
Bond Position:  [-8.15262573]


portfolio before change:  [3.25028134]
curr_Stock_Price:  99.95367536028688
curr_Factors:  [99.95367536]
mat_Sqrt:  [[0.15]]
grads:  [-0.16719677]
Stock Position:  -0.16719676954252513
Bond Position:  [19.96221296]


portfolio before change:  [3.22462053]
curr_Stock_Price:  100.11461440278629
curr_Factors:  [100.1146144]
mat_Sqrt:  [[0.15]]
grads:  [0.09360166]
Stock Position:  0.09360166240900292
Bond Position:  [-6.14627381]


portfolio before change:  [3.24607662]
curr_Stock_Price:  100.34794619819124
curr_Factors:  [100.3479462]
mat_Sqrt:  [[0.15]]
grads:  [0.05677766]
Stock Position:  0.05677766052120619
Bond Position:  [-2.45144501]


portfolio before change:  [3.25228599]
curr_Stock_Price:  100.46000773359776
curr_Factors:  [100.46000773]
mat_Sqrt:  [[0.15]]
grads:  [0.05363711]
Stock Position:  0.053637113938725556
Bond Position:  [-2.13609889]


portfolio before change:  [3.23903592]
curr_Stock_Price:  100.21546519898617
curr_Factors:  [100.2154652]
mat_Sqrt:  [[0.15]]
grads:  [-0.08257262]
Stock Position:  -0.0825726225972856
Bond Position:  [11.51408971]


portfolio before change:  [3.22545682]
curr_Stock_Price:  100.38863100734999
curr_Factors:  [100.38863101]
mat_Sqrt:  [[0.15]]
grads:  [-0.08366428]
Stock Position:  -0.08366427570828187
Bond Position:  [11.62439892]


portfolio before change:  [3.23724589]
curr_Stock_Price:  100.2564058675082
curr_Factors:  [100.25640587]
mat_Sqrt:  [[0.15]]
grads:  [-0.01459734]
Stock Position:  -0.0145973419254023
Bond Position:  [4.70072293]


portfolio before change:  [3.22565589]
curr_Stock_Price:  101.07051301835517
curr_Factors:  [101.07051302]
mat_Sqrt:  [[0.15]]
grads:  [-0.1335789]
Stock Position:  -0.13357890115651908
Bond Position:  [16.72654396]


portfolio before change:  [3.24578763]
curr_Stock_Price:  100.9276289894922
curr_Factors:  [100.92762899]
mat_Sqrt:  [[0.15]]
grads:  [0.19621118]
Stock Position:  0.1962111771574807
Bond Position:  [-16.55734127]


portfolio before change:  [3.20226491]
curr_Stock_Price:  100.71108754998026
curr_Factors:  [100.71108755]
mat_Sqrt:  [[0.15]]
grads:  [0.1354801]
Stock Position:  0.13548010264312457
Bond Position:  [-10.44208357]


portfolio before change:  [3.03175182]
curr_Stock_Price:  99.45732085250351
curr_Factors:  [99.45732085]
mat_Sqrt:  [[0.15]]
grads:  [0.01386204]
Stock Position:  0.013862035812535646
Bond Position:  [1.65307087]


portfolio before change:  [3.03272766]
curr_Stock_Price:  99.52026443014455
curr_Factors:  [99.52026443]
mat_Sqrt:  [[0.15]]
grads:  [0.04592063]
Stock Position:  0.04592063166178265
Bond Position:  [-1.53730574]


portfolio before change:  [2.98922867]
curr_Stock_Price:  98.57509204671852
curr_Factors:  [98.57509205]
mat_Sqrt:  [[0.15]]
grads:  [-0.11113789]
Stock Position:  -0.11113788677894468
Bond Position:  [13.94465609]


portfolio before change:  [3.10290406]
curr_Stock_Price:  97.56010219457579
curr_Factors:  [97.56010219]
mat_Sqrt:  [[0.15]]
grads:  [0.02103946]
Stock Position:  0.021039462180211396
Bond Position:  [1.05029198]


portfolio before change:  [3.1216818]
curr_Stock_Price:  98.44948301613474
curr_Factors:  [98.44948302]
mat_Sqrt:  [[0.15]]
grads:  [0.00621603]
Stock Position:  0.0062160265557076036
Bond Position:  [2.5097172]


portfolio before change:  [3.11910461]
curr_Stock_Price:  98.00964375927734
curr_Factors:  [98.00964376]
mat_Sqrt:  [[0.15]]
grads:  [0.00347497]
Stock Position:  0.0034749656191367527
Bond Position:  [2.77852447]


portfolio before change:  [3.12131099]
curr_Stock_Price:  98.5946050704118
curr_Factors:  [98.59460507]
mat_Sqrt:  [[0.15]]
grads:  [0.05771833]
Stock Position:  0.05771832906662605
Bond Position:  [-2.56940487]


portfolio before change:  [3.1395516]
curr_Stock_Price:  98.91341536115974
curr_Factors:  [98.91341536]
mat_Sqrt:  [[0.15]]
grads:  [0.06066909]
Stock Position:  0.06066909118419188
Bond Position:  [-2.86143542]


portfolio before change:  [3.11154023]
curr_Stock_Price:  98.45465583647938
curr_Factors:  [98.45465584]
mat_Sqrt:  [[0.15]]
grads:  [-0.01535869]
Stock Position:  -0.01535868623038456
Bond Position:  [4.6236744]


portfolio before change:  [3.09981568]
curr_Stock_Price:  99.23685392611888
curr_Factors:  [99.23685393]
mat_Sqrt:  [[0.15]]
grads:  [-0.03055382]
Stock Position:  -0.030553815827196774
Bond Position:  [6.13188024]


portfolio before change:  [3.12266911]
curr_Stock_Price:  98.50142465921607
curr_Factors:  [98.50142466]
mat_Sqrt:  [[0.15]]
grads:  [-0.06594514]
Stock Position:  -0.06594513586934979
Bond Position:  [9.61835894]


portfolio before change:  [3.09021896]
curr_Stock_Price:  99.00261883076769
curr_Factors:  [99.00261883]
mat_Sqrt:  [[0.15]]
grads:  [-0.03830008]
Stock Position:  -0.03830008402555797
Bond Position:  [6.88202758]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.09021896]
Stock Price:  99.17884917950761
PL:  [3.09021896]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.41636833e-02]
 [-1.62503133e-03]
 [ 1.19454952e-04]
 [ 2.78219093e-03]
 [ 4.95351922e-03]
 [ 1.22570415e-02]
 [-8.96304191e-04]
 [ 6.01735065e-03]
 [-1.70486444e-03]
 [-2.04205988e-02]
 [ 1.01152139e-02]
 [-1.04367257e-02]
 [ 1.94918350e-02]
 [ 4.05959611e-03]
 [ 3.97152622e-03]
 [-1.01286268e-02]
 [ 1.42984317e-02]
 [ 1.32767712e-02]
 [ 1.97062921e-02]
 [ 7.87862921e-05]
 [ 7.86773130e-02]
 [-1.31563717e-02]
 [ 3.07966273e-03]
 [ 8.70570847e-03]
 [ 1.45839115e-02]
 [-5.82669074e-03]
 [ 1.33208337e-02]
 [-1.06365120e-03]
 [ 3.04468034e-03]
 [-1.85659518e-02]
 [-4.36971554e-03]
 [-1.65059467e-02]
 [ 1.77536285e-02]
 [ 1.56468645e-02]
 [-1.69311518e-02]
 [ 6.61029006e-03]
 [-2.42101608e-03]
 [ 9.44268198e-03]
 [ 1.52917554e-03]
 [-1.37270070e-02]
 [-2.16959236e-03]
 [-2.76705481e-03]
 [ 5.18298340e-03]
 [-8.03663618e-03]
 [ 2.97704050e-03]
 [-2.88860296e-04]
 [-1.36945562e-02]
 [-3.19381132e-03]
 [-7.85801774e-03]
 [ 1.09768125e-02]
 [-2.98345427e-03]
 [ 3.77916931e-03]
 [ 8.98249368e-04]
 [-1.91030406e-03]
 [ 2.34603633e-03]
 [ 9.03070515e-03]
 [ 1.62711093e-02]
 [-2.83372984e-02]
 [ 1.38145256e-02]
 [ 5.83224898e-03]
 [ 6.17506664e-03]
 [-1.35796501e-02]
 [-1.25892333e-02]
 [-1.10664045e-03]
 [-1.04842337e-02]
 [-1.97975448e-02]
 [ 1.02556214e-02]
 [ 2.28920334e-03]
 [ 8.89286510e-03]
 [-1.75324601e-02]
 [ 4.56376050e-03]
 [ 2.00419442e-03]
 [-1.56633905e-04]
 [ 8.10908892e-03]
 [-1.69901129e-03]
 [ 2.59016790e-03]
 [ 6.79691860e-03]
 [-1.19299379e-02]
 [-3.98220366e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.24025104]
curr_Stock_Price:  100.01117047214017
curr_Factors:  [100.01117047]
mat_Sqrt:  [[0.15]]
grads:  [-0.22775789]
Stock Position:  -0.2277578889833033
Bond Position:  [25.0185841]


portfolio before change:  [2.13893931]
curr_Stock_Price:  100.4628581722667
curr_Factors:  [100.46285817]
mat_Sqrt:  [[0.15]]
grads:  [-0.01083354]
Stock Position:  -0.01083354219631969
Bond Position:  [3.22730792]


portfolio before change:  [2.14133424]
curr_Stock_Price:  100.2604114914861
curr_Factors:  [100.26041149]
mat_Sqrt:  [[0.15]]
grads:  [0.00079637]
Stock Position:  0.000796366343586641
Bond Position:  [2.06149022]


portfolio before change:  [2.14223403]
curr_Stock_Price:  101.22848965974741
curr_Factors:  [101.22848966]
mat_Sqrt:  [[0.15]]
grads:  [0.01854794]
Stock Position:  0.018547939520152146
Bond Position:  [0.26465412]


portfolio before change:  [2.13525466]
curr_Stock_Price:  100.85130956145692
curr_Factors:  [100.85130956]
mat_Sqrt:  [[0.15]]
grads:  [0.03302346]
Stock Position:  0.03302346143965857
Bond Position:  [-1.19520468]


portfolio before change:  [2.17365336]
curr_Stock_Price:  102.01634199013992
curr_Factors:  [102.01634199]
mat_Sqrt:  [[0.15]]
grads:  [0.08171361]
Stock Position:  0.08171360971611287
Bond Position:  [-6.1624702]


portfolio before change:  [2.21390638]
curr_Stock_Price:  102.513666600223
curr_Factors:  [102.5136666]
mat_Sqrt:  [[0.15]]
grads:  [-0.00597536]
Stock Position:  -0.005975361271720587
Bond Position:  [2.82646257]


portfolio before change:  [2.2205835]
curr_Stock_Price:  101.42578956207059
curr_Factors:  [101.42578956]
mat_Sqrt:  [[0.15]]
grads:  [0.04011567]
Stock Position:  0.04011567102394168
Bond Position:  [-1.84818011]


portfolio before change:  [2.19668954]
curr_Stock_Price:  100.83304259918559
curr_Factors:  [100.8330426]
mat_Sqrt:  [[0.15]]
grads:  [-0.01136576]
Stock Position:  -0.011365762948001545
Bond Position:  [3.342734]


portfolio before change:  [2.19715934]
curr_Stock_Price:  100.8100898705805
curr_Factors:  [100.81008987]
mat_Sqrt:  [[0.15]]
grads:  [-0.13613733]
Stock Position:  -0.13613732559948596
Bond Position:  [15.92117537]


portfolio before change:  [2.1318543]
curr_Stock_Price:  101.29709921781681
curr_Factors:  [101.29709922]
mat_Sqrt:  [[0.15]]
grads:  [0.06743476]
Stock Position:  0.06743475963900578
Bond Position:  [-4.69909124]


portfolio before change:  [2.19187212]
curr_Stock_Price:  102.19146773513877
curr_Factors:  [102.19146774]
mat_Sqrt:  [[0.15]]
grads:  [-0.06957817]
Stock Position:  -0.06957817127333256
Bond Position:  [9.30216757]


portfolio before change:  [2.20756718]
curr_Stock_Price:  101.97424936737478
curr_Factors:  [101.97424937]
mat_Sqrt:  [[0.15]]
grads:  [0.12994557]
Stock Position:  0.12994556657628795
Bond Position:  [-11.04353443]


portfolio before change:  [2.11941869]
curr_Stock_Price:  101.30121182859446
curr_Factors:  [101.30121183]
mat_Sqrt:  [[0.15]]
grads:  [0.02706397]
Stock Position:  0.027063974038503635
Bond Position:  [-0.62219467]


portfolio before change:  [2.11285101]
curr_Stock_Price:  101.05997602428751
curr_Factors:  [101.05997602]
mat_Sqrt:  [[0.15]]
grads:  [0.02647684]
Stock Position:  0.026476841448262643
Bond Position:  [-0.56289796]


portfolio before change:  [2.12389106]
curr_Stock_Price:  101.47827505523992
curr_Factors:  [101.47827506]
mat_Sqrt:  [[0.15]]
grads:  [-0.06752418]
Stock Position:  -0.06752417879318968
Bond Position:  [8.97612825]


portfolio before change:  [2.1818316]
curr_Stock_Price:  100.62851264735836
curr_Factors:  [100.62851265]
mat_Sqrt:  [[0.15]]
grads:  [0.09532288]
Stock Position:  0.09532287798850105
Bond Position:  [-7.41036784]


portfolio before change:  [2.17568029]
curr_Stock_Price:  100.5688402213388
curr_Factors:  [100.56884022]
mat_Sqrt:  [[0.15]]
grads:  [0.08851181]
Stock Position:  0.08851180813023825
Bond Position:  [-6.7258496]


portfolio before change:  [2.21296869]
curr_Stock_Price:  100.99487128697268
curr_Factors:  [100.99487129]
mat_Sqrt:  [[0.15]]
grads:  [0.13137528]
Stock Position:  0.13137528068498508
Bond Position:  [-11.05526088]


portfolio before change:  [2.26435839]
curr_Stock_Price:  101.39129804131639
curr_Factors:  [101.39129804]
mat_Sqrt:  [[0.15]]
grads:  [0.00052524]
Stock Position:  0.000525241947595869
Bond Position:  [2.21110343]


portfolio before change:  [2.26411316]
curr_Stock_Price:  100.66129990926594
curr_Factors:  [100.66129991]
mat_Sqrt:  [[0.15]]
grads:  [0.52451542]
Stock Position:  0.5245154200502311
Bond Position:  [-50.53429084]


portfolio before change:  [2.38230832]
curr_Stock_Price:  100.89266327188984
curr_Factors:  [100.89266327]
mat_Sqrt:  [[0.15]]
grads:  [-0.08770914]
Stock Position:  -0.08770914448689957
Bond Position:  [11.2315175]


portfolio before change:  [2.3836117]
curr_Stock_Price:  100.88580668873435
curr_Factors:  [100.88580669]
mat_Sqrt:  [[0.15]]
grads:  [0.02053108]
Stock Position:  0.020531084897041554
Bond Position:  [0.31231663]


portfolio before change:  [2.37318706]
curr_Stock_Price:  100.37710677730075
curr_Factors:  [100.37710678]
mat_Sqrt:  [[0.15]]
grads:  [0.05803806]
Stock Position:  0.058038056485186625
Bond Position:  [-3.45250514]


portfolio before change:  [2.38733017]
curr_Stock_Price:  100.62451172375546
curr_Factors:  [100.62451172]
mat_Sqrt:  [[0.15]]
grads:  [0.09722608]
Stock Position:  0.09722607637086432
Bond Position:  [-7.39599629]


portfolio before change:  [2.38081976]
curr_Stock_Price:  100.56230465071985
curr_Factors:  [100.56230465]
mat_Sqrt:  [[0.15]]
grads:  [-0.0388446]
Stock Position:  -0.038844604956477305
Bond Position:  [6.28712275]


portfolio before change:  [2.39126245]
curr_Stock_Price:  100.30358824281828
curr_Factors:  [100.30358824]
mat_Sqrt:  [[0.15]]
grads:  [0.08880556]
Stock Position:  0.08880555803130227
Bond Position:  [-6.51625368]


portfolio before change:  [2.35885988]
curr_Stock_Price:  99.94330346879062
curr_Factors:  [99.94330347]
mat_Sqrt:  [[0.15]]
grads:  [-0.00709101]
Stock Position:  -0.0070910079832709845
Bond Position:  [3.06755864]


portfolio before change:  [2.35760478]
curr_Stock_Price:  100.14734125134892
curr_Factors:  [100.14734125]
mat_Sqrt:  [[0.15]]
grads:  [0.02029787]
Stock Position:  0.020297868946557523
Bond Position:  [0.32482717]


portfolio before change:  [2.34512855]
curr_Stock_Price:  99.53168391991245
curr_Factors:  [99.53168392]
mat_Sqrt:  [[0.15]]
grads:  [-0.12377301]
Stock Position:  -0.12377301207619767
Bond Position:  [14.66446486]


portfolio before change:  [2.30832377]
curr_Stock_Price:  99.8364461432254
curr_Factors:  [99.83644614]
mat_Sqrt:  [[0.15]]
grads:  [-0.02913144]
Stock Position:  -0.029131436949366013
Bond Position:  [5.2167029]


portfolio before change:  [2.35655043]
curr_Stock_Price:  98.19215356909102
curr_Factors:  [98.19215357]
mat_Sqrt:  [[0.15]]
grads:  [-0.11003964]
Stock Position:  -0.11003964459530498
Bond Position:  [13.16158011]


portfolio before change:  [2.38352009]
curr_Stock_Price:  97.95453882707965
curr_Factors:  [97.95453883]
mat_Sqrt:  [[0.15]]
grads:  [0.11835752]
Stock Position:  0.1183575236337133
Bond Position:  [-9.21013655]


portfolio before change:  [2.41719182]
curr_Stock_Price:  98.24389415444195
curr_Factors:  [98.24389415]
mat_Sqrt:  [[0.15]]
grads:  [0.10431243]
Stock Position:  0.10431243021424001
Bond Position:  [-7.83086753]


portfolio before change:  [2.42308459]
curr_Stock_Price:  98.3050777987245
curr_Factors:  [98.3050778]
mat_Sqrt:  [[0.15]]
grads:  [-0.11287435]
Stock Position:  -0.11287434505213986
Bond Position:  [13.51920586]


portfolio before change:  [2.41068515]
curr_Stock_Price:  98.42241548424803
curr_Factors:  [98.42241548]
mat_Sqrt:  [[0.15]]
grads:  [0.0440686]
Stock Position:  0.04406860038400139
Bond Position:  [-1.92665294]


portfolio before change:  [2.41271735]
curr_Stock_Price:  98.47126248468398
curr_Factors:  [98.47126248]
mat_Sqrt:  [[0.15]]
grads:  [-0.01614011]
Stock Position:  -0.016140107208049984
Bond Position:  [4.00205409]


portfolio before change:  [2.41191118]
curr_Stock_Price:  98.53670838336035
curr_Factors:  [98.53670838]
mat_Sqrt:  [[0.15]]
grads:  [0.06295121]
Stock Position:  0.06295121321175239
Bond Position:  [-3.79109415]


portfolio before change:  [2.4451096]
curr_Stock_Price:  99.06783978869721
curr_Factors:  [99.06783979]
mat_Sqrt:  [[0.15]]
grads:  [0.0101945]
Stock Position:  0.010194503610319733
Bond Position:  [1.43516215]


portfolio before change:  [2.44844997]
curr_Stock_Price:  99.38670496784844
curr_Factors:  [99.38670497]
mat_Sqrt:  [[0.15]]
grads:  [-0.09151338]
Stock Position:  -0.09151338032184031
Bond Position:  [11.5436633]


portfolio before change:  [2.43169101]
curr_Stock_Price:  99.57772031625575
curr_Factors:  [99.57772032]
mat_Sqrt:  [[0.15]]
grads:  [-0.01446395]
Stock Position:  -0.014463949092858216
Bond Position:  [3.87197809]


portfolio before change:  [2.43147137]
curr_Stock_Price:  99.60963757113653
curr_Factors:  [99.60963757]
mat_Sqrt:  [[0.15]]
grads:  [-0.01844703]
Stock Position:  -0.01844703209425577
Bond Position:  [4.26897355]


portfolio before change:  [2.42811613]
curr_Stock_Price:  99.8059870409628
curr_Factors:  [99.80598704]
mat_Sqrt:  [[0.15]]
grads:  [0.03455322]
Stock Position:  0.03455322267073304
Bond Position:  [-1.02050237]


portfolio before change:  [2.39167315]
curr_Stock_Price:  98.75314186997812
curr_Factors:  [98.75314187]
mat_Sqrt:  [[0.15]]
grads:  [-0.05357757]
Stock Position:  -0.053577574534796106
Bond Position:  [7.68262697]


portfolio before change:  [2.33114116]
curr_Stock_Price:  99.89190492929555
curr_Factors:  [99.89190493]
mat_Sqrt:  [[0.15]]
grads:  [0.01984694]
Stock Position:  0.01984693667728107
Bond Position:  [0.34859285]


portfolio before change:  [2.33921689]
curr_Stock_Price:  100.29770752105105
curr_Factors:  [100.29770752]
mat_Sqrt:  [[0.15]]
grads:  [-0.00192574]
Stock Position:  -0.0019257353046972848
Bond Position:  [2.53236373]


portfolio before change:  [2.34004092]
curr_Stock_Price:  99.95199497964344
curr_Factors:  [99.95199498]
mat_Sqrt:  [[0.15]]
grads:  [-0.09129704]
Stock Position:  -0.09129704144974825
Bond Position:  [11.46536235]


portfolio before change:  [2.39639788]
curr_Stock_Price:  99.34255188638234
curr_Factors:  [99.34255189]
mat_Sqrt:  [[0.15]]
grads:  [-0.02129208]
Stock Position:  -0.021292075455072983
Bond Position:  [4.51160699]


portfolio before change:  [2.38732925]
curr_Stock_Price:  99.78171098605935
curr_Factors:  [99.78171099]
mat_Sqrt:  [[0.15]]
grads:  [-0.05238678]
Stock Position:  -0.05238678493453254
Bond Position:  [7.61457229]


portfolio before change:  [2.39731976]
curr_Stock_Price:  99.60008919685185
curr_Factors:  [99.6000892]
mat_Sqrt:  [[0.15]]
grads:  [0.07317875]
Stock Position:  0.07317875031405038
Bond Position:  [-4.8912903]


portfolio before change:  [2.43704376]
curr_Stock_Price:  100.14710195320494
curr_Factors:  [100.14710195]
mat_Sqrt:  [[0.15]]
grads:  [-0.0198897]
Stock Position:  -0.019889695108999073
Bond Position:  [4.42893908]


portfolio before change:  [2.42974421]
curr_Stock_Price:  100.52802096621991
curr_Factors:  [100.52802097]
mat_Sqrt:  [[0.15]]
grads:  [0.02519446]
Stock Position:  0.02519446204002018
Bond Position:  [-0.1030052]


portfolio before change:  [2.42502358]
curr_Stock_Price:  100.34090875338276
curr_Factors:  [100.34090875]
mat_Sqrt:  [[0.15]]
grads:  [0.00598833]
Stock Position:  0.005988329122723764
Bond Position:  [1.82414919]


portfolio before change:  [2.42545846]
curr_Stock_Price:  100.39449013647348
curr_Factors:  [100.39449014]
mat_Sqrt:  [[0.15]]
grads:  [-0.01273536]
Stock Position:  -0.012735360410502643
Bond Position:  [3.70401847]


portfolio before change:  [2.4238782]
curr_Stock_Price:  100.53675249952848
curr_Factors:  [100.5367525]
mat_Sqrt:  [[0.15]]
grads:  [0.01564024]
Stock Position:  0.015640242208302364
Bond Position:  [0.85145904]


portfolio before change:  [2.40421484]
curr_Stock_Price:  99.27612122839163
curr_Factors:  [99.27612123]
mat_Sqrt:  [[0.15]]
grads:  [0.0602047]
Stock Position:  0.06020470101822723
Bond Position:  [-3.57267436]


portfolio before change:  [2.42489773]
curr_Stock_Price:  99.62337297778089
curr_Factors:  [99.62337298]
mat_Sqrt:  [[0.15]]
grads:  [0.10847406]
Stock Position:  0.10847406212099556
Bond Position:  [-8.38165422]


portfolio before change:  [2.4191845]
curr_Stock_Price:  99.57553336392708
curr_Factors:  [99.57553336]
mat_Sqrt:  [[0.15]]
grads:  [-0.18891532]
Stock Position:  -0.18891532260956237
Bond Position:  [21.23052851]


portfolio before change:  [2.65235114]
curr_Stock_Price:  98.3483185451604
curr_Factors:  [98.34831855]
mat_Sqrt:  [[0.15]]
grads:  [0.09209684]
Stock Position:  0.09209683718070376
Bond Position:  [-6.40521794]


portfolio before change:  [2.74675318]
curr_Stock_Price:  99.37769574487395
curr_Factors:  [99.37769574]
mat_Sqrt:  [[0.15]]
grads:  [0.03888166]
Stock Position:  0.03888165989363006
Bond Position:  [-1.11721659]


portfolio before change:  [2.76086139]
curr_Stock_Price:  99.74234152244529
curr_Factors:  [99.74234152]
mat_Sqrt:  [[0.15]]
grads:  [0.04116711]
Stock Position:  0.041167110900485984
Bond Position:  [-1.34524265]


portfolio before change:  [2.72820665]
curr_Stock_Price:  98.95115991898531
curr_Factors:  [98.95115992]
mat_Sqrt:  [[0.15]]
grads:  [-0.090531]
Stock Position:  -0.09053100062663891
Bond Position:  [11.68635417]


portfolio before change:  [2.73625381]
curr_Stock_Price:  98.87033965081746
curr_Factors:  [98.87033965]
mat_Sqrt:  [[0.15]]
grads:  [-0.08392822]
Stock Position:  -0.08392822170081295
Bond Position:  [11.03426559]


portfolio before change:  [2.78989755]
curr_Stock_Price:  98.23939475577255
curr_Factors:  [98.23939476]
mat_Sqrt:  [[0.15]]
grads:  [-0.0073776]
Stock Position:  -0.007377603024741144
Bond Position:  [3.51466881]


portfolio before change:  [2.79367741]
curr_Stock_Price:  97.75682860609872
curr_Factors:  [97.75682861]
mat_Sqrt:  [[0.15]]
grads:  [-0.06989489]
Stock Position:  -0.06989489106627204
Bond Position:  [9.62638029]


portfolio before change:  [2.80788544]
curr_Stock_Price:  97.56215963681959
curr_Factors:  [97.56215964]
mat_Sqrt:  [[0.15]]
grads:  [-0.13198363]
Stock Position:  -0.1319836321735297
Bond Position:  [15.68449363]


portfolio before change:  [2.72039396]
curr_Stock_Price:  98.23248357670332
curr_Factors:  [98.23248358]
mat_Sqrt:  [[0.15]]
grads:  [0.06837081]
Stock Position:  0.06837080923567411
Bond Position:  [-3.99584043]


portfolio before change:  [2.68065962]
curr_Stock_Price:  97.65497688632547
curr_Factors:  [97.65497689]
mat_Sqrt:  [[0.15]]
grads:  [0.01526136]
Stock Position:  0.015261355577734446
Bond Position:  [1.19031229]


portfolio before change:  [2.69230156]
curr_Stock_Price:  98.41294009663828
curr_Factors:  [98.4129401]
mat_Sqrt:  [[0.15]]
grads:  [0.05928577]
Stock Position:  0.0592857673483681
Bond Position:  [-3.14218511]


portfolio before change:  [2.63233668]
curr_Stock_Price:  97.40479791518479
curr_Factors:  [97.40479792]
mat_Sqrt:  [[0.15]]
grads:  [-0.11688307]
Stock Position:  -0.11688306725230198
Bond Position:  [14.01730823]


portfolio before change:  [2.63742959]
curr_Stock_Price:  97.368720860072
curr_Factors:  [97.36872086]
mat_Sqrt:  [[0.15]]
grads:  [0.03042507]
Stock Position:  0.0304250700210118
Bond Position:  [-0.32502056]


portfolio before change:  [2.6503451]
curr_Stock_Price:  97.79389069266772
curr_Factors:  [97.79389069]
mat_Sqrt:  [[0.15]]
grads:  [0.0133613]
Stock Position:  0.01336129613147256
Bond Position:  [1.34369196]


portfolio before change:  [2.64783119]
curr_Stock_Price:  97.59945680699184
curr_Factors:  [97.59945681]
mat_Sqrt:  [[0.15]]
grads:  [-0.00104423]
Stock Position:  -0.0010442260321967055
Bond Position:  [2.74974709]


portfolio before change:  [2.64842882]
curr_Stock_Price:  97.19172310420565
curr_Factors:  [97.1917231]
mat_Sqrt:  [[0.15]]
grads:  [0.05406059]
Stock Position:  0.05406059279759182
Bond Position:  [-2.60581334]


portfolio before change:  [2.61999611]
curr_Stock_Price:  96.6687942873026
curr_Factors:  [96.66879429]
mat_Sqrt:  [[0.15]]
grads:  [-0.01132674]
Stock Position:  -0.01132674195944486
Bond Position:  [3.7149386]


portfolio before change:  [2.615163]
curr_Stock_Price:  97.11599276579695
curr_Factors:  [97.11599277]
mat_Sqrt:  [[0.15]]
grads:  [0.01726779]
Stock Position:  0.017267785980693687
Bond Position:  [0.93818482]


portfolio before change:  [2.60223453]
curr_Stock_Price:  96.36389223590659
curr_Factors:  [96.36389224]
mat_Sqrt:  [[0.15]]
grads:  [0.04531279]
Stock Position:  0.045312790696277305
Bond Position:  [-1.76428235]


portfolio before change:  [2.5937041]
curr_Stock_Price:  96.17806928165969
curr_Factors:  [96.17806928]
mat_Sqrt:  [[0.15]]
grads:  [-0.07953292]
Stock Position:  -0.07953291935492628
Bond Position:  [10.24302673]


portfolio before change:  [2.60006929]
curr_Stock_Price:  96.10608680049421
curr_Factors:  [96.1060868]
mat_Sqrt:  [[0.15]]
grads:  [-0.26548024]
Stock Position:  -0.26548024430263845
Bond Position:  [28.11433669]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.60006929]
Stock Price:  96.625758164904
PL:  [2.60006929]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.61627152e-02]
 [-2.32329930e-04]
 [ 5.54630272e-03]
 [ 3.23457922e-03]
 [ 6.18548804e-03]
 [ 1.18025756e-02]
 [ 9.82829987e-04]
 [ 1.22095486e-02]
 [ 1.35537174e-02]
 [-1.90510730e-02]
 [ 1.01690483e-02]
 [-6.92510146e-03]
 [ 1.98051274e-03]
 [ 4.16448843e-03]
 [ 6.19456853e-03]
 [-6.01109493e-03]
 [ 4.55797760e-03]
 [ 5.54325405e-03]
 [ 1.59612500e-02]
 [ 1.40324321e-02]
 [ 2.52499975e-02]
 [-2.12562322e-02]
 [-1.07629822e-03]
 [ 1.23982845e-02]
 [ 9.37001970e-04]
 [ 1.51963741e-02]
 [ 1.61964395e-02]
 [ 1.10363901e-02]
 [ 5.87254038e-04]
 [ 1.65149684e-03]
 [-3.42511682e-03]
 [-2.32052551e-02]
 [ 1.98480958e-02]
 [ 1.09296958e-02]
 [-2.76393284e-02]
 [ 8.40797081e-03]
 [ 9.25796855e-04]
 [-1.52220622e-02]
 [ 9.24436522e-03]
 [-2.08674738e-02]
 [ 5.53009505e-02]
 [ 2.94132845e-03]
 [ 9.57710196e-03]
 [-9.30815983e-03]
 [-1.36326373e-03]
 [-8.85367689e-03]
 [-1.34143043e-02]
 [ 1.06758534e-04]
 [-2.73341033e-03]
 [ 3.33283505e-03]
 [-3.70049632e-03]
 [ 2.96411805e-03]
 [ 3.58767089e-03]
 [-2.08103209e-04]
 [ 7.35280076e-03]
 [ 8.84365403e-03]
 [ 1.10925967e-02]
 [ 5.03060287e-03]
 [ 1.34987798e-02]
 [-1.43127197e-03]
 [ 1.96613486e-03]
 [-1.62887135e-02]
 [-1.26885957e-02]
 [-1.06110148e-03]
 [-8.92679683e-03]
 [-1.85462318e-03]
 [ 8.52321363e-03]
 [ 1.73381899e-03]
 [ 1.44123009e-02]
 [-1.91421297e-02]
 [ 1.82277248e-02]
 [-1.87549311e-02]
 [-6.13733415e-03]
 [ 7.96458880e-03]
 [-1.20227347e-02]
 [ 3.99937955e-03]
 [ 1.68209505e-02]
 [-1.41648403e-02]
 [-5.19363456e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.2529165]
curr_Stock_Price:  99.65812097123478
curr_Factors:  [99.65812097]
mat_Sqrt:  [[0.15]]
grads:  [-0.24108477]
Stock Position:  -0.2410847682779682
Bond Position:  [20.7731385]


portfolio before change:  [-3.5153252]
curr_Stock_Price:  100.75195638238942
curr_Factors:  [100.75195638]
mat_Sqrt:  [[0.15]]
grads:  [-0.00154887]
Stock Position:  -0.0015488662014099346
Bond Position:  [-3.3592739]


portfolio before change:  [-3.51626806]
curr_Stock_Price:  101.22514390330898
curr_Factors:  [101.2251439]
mat_Sqrt:  [[0.15]]
grads:  [0.03697535]
Stock Position:  0.03697535147336905
Bond Position:  [-7.25910334]


portfolio before change:  [-3.49901363]
curr_Stock_Price:  101.70406121158493
curr_Factors:  [101.70406121]
mat_Sqrt:  [[0.15]]
grads:  [0.02156386]
Stock Position:  0.021563861486430646
Bond Position:  [-5.69214592]


portfolio before change:  [-3.51040759]
curr_Stock_Price:  101.19217753791656
curr_Factors:  [101.19217754]
mat_Sqrt:  [[0.15]]
grads:  [0.04123659]
Stock Position:  0.041236586963618406
Bond Position:  [-7.68322762]


portfolio before change:  [-3.53867801]
curr_Stock_Price:  100.51825655085295
curr_Factors:  [100.51825655]
mat_Sqrt:  [[0.15]]
grads:  [0.07868384]
Stock Position:  0.07868383762106117
Bond Position:  [-11.44784019]


portfolio before change:  [-3.53434513]
curr_Stock_Price:  100.58241705151383
curr_Factors:  [100.58241705]
mat_Sqrt:  [[0.15]]
grads:  [0.0065522]
Stock Position:  0.006552199914968018
Bond Position:  [-4.19338123]


portfolio before change:  [-3.53992995]
curr_Stock_Price:  99.77005964870318
curr_Factors:  [99.77005965]
mat_Sqrt:  [[0.15]]
grads:  [0.08139699]
Stock Position:  0.08139699078116026
Bond Position:  [-11.66091258]


portfolio before change:  [-3.52426275]
curr_Stock_Price:  99.97149251587557
curr_Factors:  [99.97149252]
mat_Sqrt:  [[0.15]]
grads:  [0.09035812]
Stock Position:  0.09035811624878522
Bond Position:  [-12.55749849]


portfolio before change:  [-3.50535847]
curr_Stock_Price:  100.18939377747164
curr_Factors:  [100.18939378]
mat_Sqrt:  [[0.15]]
grads:  [-0.12700715]
Stock Position:  -0.12700715323784928
Bond Position:  [9.21941122]


portfolio before change:  [-3.52039398]
curr_Stock_Price:  100.31231389528317
curr_Factors:  [100.3123139]
mat_Sqrt:  [[0.15]]
grads:  [0.06779366]
Stock Position:  0.0677936555672046
Bond Position:  [-10.32093243]


portfolio before change:  [-3.48249717]
curr_Stock_Price:  100.88083152027633
curr_Factors:  [100.88083152]
mat_Sqrt:  [[0.15]]
grads:  [-0.04616734]
Stock Position:  -0.04616734308006094
Bond Position:  [1.17490279]


portfolio before change:  [-3.47625549]
curr_Stock_Price:  100.74722529388755
curr_Factors:  [100.74722529]
mat_Sqrt:  [[0.15]]
grads:  [0.01320342]
Stock Position:  0.013203418264428429
Bond Position:  [-4.80646324]


portfolio before change:  [-3.47377833]
curr_Stock_Price:  100.9575928899698
curr_Factors:  [100.95759289]
mat_Sqrt:  [[0.15]]
grads:  [0.02776326]
Stock Position:  0.027763256194368847
Bond Position:  [-6.27668985]


portfolio before change:  [-3.48779591]
curr_Stock_Price:  100.46682658415887
curr_Factors:  [100.46682658]
mat_Sqrt:  [[0.15]]
grads:  [0.04129712]
Stock Position:  0.041297123502072
Bond Position:  [-7.63678685]


portfolio before change:  [-3.4877263]
curr_Stock_Price:  100.48007002200312
curr_Factors:  [100.48007002]
mat_Sqrt:  [[0.15]]
grads:  [-0.04007397]
Stock Position:  -0.040073966211442484
Bond Position:  [0.53890863]


portfolio before change:  [-3.45766551]
curr_Stock_Price:  99.73077786650425
curr_Factors:  [99.73077787]
mat_Sqrt:  [[0.15]]
grads:  [0.03038652]
Stock Position:  0.030386517308548563
Bond Position:  [-6.48813652]


portfolio before change:  [-3.47940088]
curr_Stock_Price:  99.02882681148314
curr_Factors:  [99.02882681]
mat_Sqrt:  [[0.15]]
grads:  [0.03695503]
Stock Position:  0.03695502701875287
Bond Position:  [-7.13901385]


portfolio before change:  [-3.49152828]
curr_Stock_Price:  98.71273449521055
curr_Factors:  [98.7127345]
mat_Sqrt:  [[0.15]]
grads:  [0.10640833]
Stock Position:  0.10640833363306862
Bond Position:  [-13.99538587]


portfolio before change:  [-3.56772546]
curr_Stock_Price:  98.00487233815774
curr_Factors:  [98.00487234]
mat_Sqrt:  [[0.15]]
grads:  [0.09354955]
Stock Position:  0.09354954717058657
Bond Position:  [-12.73603688]


portfolio before change:  [-3.52400654]
curr_Stock_Price:  98.48071577915546
curr_Factors:  [98.48071578]
mat_Sqrt:  [[0.15]]
grads:  [0.16833332]
Stock Position:  0.16833331691626358
Bond Position:  [-20.10159208]


portfolio before change:  [-3.58606522]
curr_Stock_Price:  98.11951406005025
curr_Factors:  [98.11951406]
mat_Sqrt:  [[0.15]]
grads:  [-0.14170821]
Stock Position:  -0.14170821459236937
Bond Position:  [10.31827594]


portfolio before change:  [-3.64822547]
curr_Stock_Price:  98.56271463196009
curr_Factors:  [98.56271463]
mat_Sqrt:  [[0.15]]
grads:  [-0.00717532]
Stock Position:  -0.007175321461733604
Bond Position:  [-2.9410063]


portfolio before change:  [-3.64865298]
curr_Stock_Price:  98.5966777484141
curr_Factors:  [98.59667775]
mat_Sqrt:  [[0.15]]
grads:  [0.08265523]
Stock Position:  0.0826552303031178
Bond Position:  [-11.79818409]


portfolio before change:  [-3.70693186]
curr_Stock_Price:  97.90051533186757
curr_Factors:  [97.90051533]
mat_Sqrt:  [[0.15]]
grads:  [0.00624668]
Stock Position:  0.0062466797973706936
Bond Position:  [-4.31848503]


portfolio before change:  [-3.70889951]
curr_Stock_Price:  97.62873251167566
curr_Factors:  [97.62873251]
mat_Sqrt:  [[0.15]]
grads:  [0.10130916]
Stock Position:  0.10130916047847548
Bond Position:  [-13.59958444]


portfolio before change:  [-3.76773496]
curr_Stock_Price:  97.0563711595648
curr_Factors:  [97.05637116]
mat_Sqrt:  [[0.15]]
grads:  [0.10797626]
Stock Position:  0.10797626359576248
Bond Position:  [-14.24751927]


portfolio before change:  [-3.79737016]
curr_Stock_Price:  96.79015796763808
curr_Factors:  [96.79015797]
mat_Sqrt:  [[0.15]]
grads:  [0.07357593]
Stock Position:  0.07357593389895146
Bond Position:  [-10.91879643]


portfolio before change:  [-3.79677893]
curr_Stock_Price:  96.8074690681914
curr_Factors:  [96.80746907]
mat_Sqrt:  [[0.15]]
grads:  [0.00391503]
Stock Position:  0.00391502692282468
Bond Position:  [-4.17578278]


portfolio before change:  [-3.79665974]
curr_Stock_Price:  96.90457707781187
curr_Factors:  [96.90457708]
mat_Sqrt:  [[0.15]]
grads:  [0.01100998]
Stock Position:  0.01100997890821733
Bond Position:  [-4.86357709]


portfolio before change:  [-3.80105304]
curr_Stock_Price:  96.53315796649348
curr_Factors:  [96.53315797]
mat_Sqrt:  [[0.15]]
grads:  [-0.02283411]
Stock Position:  -0.02283411212676545
Bond Position:  [-1.59680409]


portfolio before change:  [-3.81372605]
curr_Stock_Price:  97.08379030839802
curr_Factors:  [97.08379031]
mat_Sqrt:  [[0.15]]
grads:  [-0.1547017]
Stock Position:  -0.15470170074902678
Bond Position:  [11.20530143]


portfolio before change:  [-3.81731495]
curr_Stock_Price:  97.1115162942105
curr_Factors:  [97.11151629]
mat_Sqrt:  [[0.15]]
grads:  [0.13232064]
Stock Position:  0.13232063880527173
Bond Position:  [-16.66717282]


portfolio before change:  [-3.90066962]
curr_Stock_Price:  96.48944445831873
curr_Factors:  [96.48944446]
mat_Sqrt:  [[0.15]]
grads:  [0.07286464]
Stock Position:  0.07286463865797124
Bond Position:  [-10.93133813]


portfolio before change:  [-3.89220474]
curr_Stock_Price:  96.61499381740582
curr_Factors:  [96.61499382]
mat_Sqrt:  [[0.15]]
grads:  [-0.18426219]
Stock Position:  -0.1842621894242903
Bond Position:  [13.91028555]


portfolio before change:  [-3.72629349]
curr_Stock_Price:  95.71930362096587
curr_Factors:  [95.71930362]
mat_Sqrt:  [[0.15]]
grads:  [0.05605314]
Stock Position:  0.05605313871939134
Bond Position:  [-9.09166089]


portfolio before change:  [-3.7756612]
curr_Stock_Price:  94.84871078054287
curr_Factors:  [94.84871078]
mat_Sqrt:  [[0.15]]
grads:  [0.00617198]
Stock Position:  0.006171979035403992
Bond Position:  [-4.36106545]


portfolio before change:  [-3.77748915]
curr_Stock_Price:  94.59670351063735
curr_Factors:  [94.59670351]
mat_Sqrt:  [[0.15]]
grads:  [-0.10148041]
Stock Position:  -0.10148041494153992
Bond Position:  [5.82222357]


portfolio before change:  [-3.8045558]
curr_Stock_Price:  94.86700733401554
curr_Factors:  [94.86700733]
mat_Sqrt:  [[0.15]]
grads:  [0.0616291]
Stock Position:  0.06162910148676604
Bond Position:  [-9.65112422]


portfolio before change:  [-3.81588397]
curr_Stock_Price:  94.69298300941027
curr_Factors:  [94.69298301]
mat_Sqrt:  [[0.15]]
grads:  [-0.13911649]
Stock Position:  -0.13911649169395132
Bond Position:  [9.35747161]


portfolio before change:  [-3.81955948]
curr_Stock_Price:  94.72360742630089
curr_Factors:  [94.72360743]
mat_Sqrt:  [[0.15]]
grads:  [0.368673]
Stock Position:  0.3686730031691468
Bond Position:  [-38.7415963]


portfolio before change:  [-3.7355467]
curr_Stock_Price:  94.95805421289343
curr_Factors:  [94.95805421]
mat_Sqrt:  [[0.15]]
grads:  [0.01960886]
Stock Position:  0.019608856322758557
Bond Position:  [-5.59756554]


portfolio before change:  [-3.72986716]
curr_Stock_Price:  95.26553776377013
curr_Factors:  [95.26553776]
mat_Sqrt:  [[0.15]]
grads:  [0.06384735]
Stock Position:  0.06384734642364367
Bond Position:  [-9.81231895]


portfolio before change:  [-3.65588132]
curr_Stock_Price:  96.43393607058083
curr_Factors:  [96.43393607]
mat_Sqrt:  [[0.15]]
grads:  [-0.0620544]
Stock Position:  -0.062054398865050604
Bond Position:  [2.32826862]


portfolio before change:  [-3.63771535]
curr_Stock_Price:  96.14353848692588
curr_Factors:  [96.14353849]
mat_Sqrt:  [[0.15]]
grads:  [-0.00908842]
Stock Position:  -0.009088424868647959
Bond Position:  [-2.76392202]


portfolio before change:  [-3.64320532]
curr_Stock_Price:  96.72859302170293
curr_Factors:  [96.72859302]
mat_Sqrt:  [[0.15]]
grads:  [-0.05902451]
Stock Position:  -0.05902451259666545
Bond Position:  [2.06615274]


portfolio before change:  [-3.6379666]
curr_Stock_Price:  96.64202585445156
curr_Factors:  [96.64202585]
mat_Sqrt:  [[0.15]]
grads:  [-0.0894287]
Stock Position:  -0.08942869553597754
Bond Position:  [5.00460371]


portfolio before change:  [-3.63178196]
curr_Stock_Price:  96.5763663654306
curr_Factors:  [96.57636637]
mat_Sqrt:  [[0.15]]
grads:  [0.00071172]
Stock Position:  0.000711723560019763
Bond Position:  [-3.70051763]


portfolio before change:  [-3.63183639]
curr_Stock_Price:  96.82485668853376
curr_Factors:  [96.82485669]
mat_Sqrt:  [[0.15]]
grads:  [-0.01822274]
Stock Position:  -0.01822273553794353
Bond Position:  [-1.86742264]


portfolio before change:  [-3.64264431]
curr_Stock_Price:  97.4115526100219
curr_Factors:  [97.41155261]
mat_Sqrt:  [[0.15]]
grads:  [0.0222189]
Stock Position:  0.02221890036559844
Bond Position:  [-5.8070219]


portfolio before change:  [-3.65584984]
curr_Stock_Price:  96.83355040080181
curr_Factors:  [96.8335504]
mat_Sqrt:  [[0.15]]
grads:  [-0.02466998]
Stock Position:  -0.024669975459684856
Bond Position:  [-1.26696853]


portfolio before change:  [-3.65857931]
curr_Stock_Price:  96.94097981843989
curr_Factors:  [96.94097982]
mat_Sqrt:  [[0.15]]
grads:  [0.01976079]
Stock Position:  0.01976078697868076
Bond Position:  [-5.57420936]


portfolio before change:  [-3.67345655]
curr_Stock_Price:  96.20574393436773
curr_Factors:  [96.20574393]
mat_Sqrt:  [[0.15]]
grads:  [0.02391781]
Stock Position:  0.02391780596317551
Bond Position:  [-5.97448686]


portfolio before change:  [-3.675535]
curr_Stock_Price:  96.13445664725485
curr_Factors:  [96.13445665]
mat_Sqrt:  [[0.15]]
grads:  [-0.00138735]
Stock Position:  -0.0013873547290175487
Bond Position:  [-3.54216241]


portfolio before change:  [-3.67587717]
curr_Stock_Price:  96.22151526006382
curr_Factors:  [96.22151526]
mat_Sqrt:  [[0.15]]
grads:  [0.04901867]
Stock Position:  0.049018671715238146
Bond Position:  [-8.39252804]


portfolio before change:  [-3.66693635]
curr_Stock_Price:  96.41461260859057
curr_Factors:  [96.41461261]
mat_Sqrt:  [[0.15]]
grads:  [0.05895769]
Stock Position:  0.05895769356542901
Bond Position:  [-9.35131953]


portfolio before change:  [-3.67171755]
curr_Stock_Price:  96.34343049067213
curr_Factors:  [96.34343049]
mat_Sqrt:  [[0.15]]
grads:  [0.07395064]
Stock Position:  0.07395064452231727
Bond Position:  [-10.79637633]


portfolio before change:  [-3.65431584]
curr_Stock_Price:  96.58787066182097
curr_Factors:  [96.58787066]
mat_Sqrt:  [[0.15]]
grads:  [0.03353735]
Stock Position:  0.03353735249848846
Bond Position:  [-6.89361731]


portfolio before change:  [-3.64934582]
curr_Stock_Price:  96.74891154645952
curr_Factors:  [96.74891155]
mat_Sqrt:  [[0.15]]
grads:  [0.08999187]
Stock Position:  0.08999186509956787
Bond Position:  [-12.35596082]


portfolio before change:  [-3.63666602]
curr_Stock_Price:  96.8983925309294
curr_Factors:  [96.89839253]
mat_Sqrt:  [[0.15]]
grads:  [-0.00954181]
Stock Position:  -0.009541813129430091
Bond Position:  [-2.71207967]


portfolio before change:  [-3.64068515]
curr_Stock_Price:  97.30184026272737
curr_Factors:  [97.30184026]
mat_Sqrt:  [[0.15]]
grads:  [0.01310757]
Stock Position:  0.013107565711888154
Bond Position:  [-4.91607542]


portfolio before change:  [-3.63798879]
curr_Stock_Price:  97.53099253186956
curr_Factors:  [97.53099253]
mat_Sqrt:  [[0.15]]
grads:  [-0.10859142]
Stock Position:  -0.10859142308659633
Bond Position:  [6.95304049]


portfolio before change:  [-3.64677912]
curr_Stock_Price:  97.61594318448115
curr_Factors:  [97.61594318]
mat_Sqrt:  [[0.15]]
grads:  [-0.08459064]
Stock Position:  -0.08459063784766205
Bond Position:  [4.61061578]


portfolio before change:  [-3.63534058]
curr_Stock_Price:  97.48412752390438
curr_Factors:  [97.48412752]
mat_Sqrt:  [[0.15]]
grads:  [-0.00707401]
Stock Position:  -0.007074009834331055
Bond Position:  [-2.9457369]


portfolio before change:  [-3.62924696]
curr_Stock_Price:  96.59669178720794
curr_Factors:  [96.59669179]
mat_Sqrt:  [[0.15]]
grads:  [-0.05951198]
Stock Position:  -0.05951197885071896
Bond Position:  [2.11941331]


portfolio before change:  [-3.61403487]
curr_Stock_Price:  96.3433036224278
curr_Factors:  [96.34330362]
mat_Sqrt:  [[0.15]]
grads:  [-0.01236415]
Stock Position:  -0.012364154516635105
Bond Position:  [-2.42283137]


portfolio before change:  [-3.6065194]
curr_Stock_Price:  95.72321272979241
curr_Factors:  [95.72321273]
mat_Sqrt:  [[0.15]]
grads:  [0.05682142]
Stock Position:  0.05682142422397299
Bond Position:  [-9.04564868]


portfolio before change:  [-3.6605869]
curr_Stock_Price:  94.78162903432232
curr_Factors:  [94.78162903]
mat_Sqrt:  [[0.15]]
grads:  [0.01155879]
Stock Position:  0.01155879325421624
Bond Position:  [-4.75614815]


portfolio before change:  [-3.65727706]
curr_Stock_Price:  95.09369492469418
curr_Factors:  [95.09369492]
mat_Sqrt:  [[0.15]]
grads:  [0.09608201]
Stock Position:  0.096082006243444
Bond Position:  [-12.79407005]


portfolio before change:  [-3.62000278]
curr_Stock_Price:  95.48995984753988
curr_Factors:  [95.48995985]
mat_Sqrt:  [[0.15]]
grads:  [-0.1276142]
Stock Position:  -0.12761419812903066
Bond Position:  [8.56587187]


portfolio before change:  [-3.55184117]
curr_Stock_Price:  94.96003267621744
curr_Factors:  [94.96003268]
mat_Sqrt:  [[0.15]]
grads:  [0.12151817]
Stock Position:  0.12151816513742399
Bond Position:  [-15.0912101]


portfolio before change:  [-3.65045137]
curr_Stock_Price:  94.1563094499574
curr_Factors:  [94.15630945]
mat_Sqrt:  [[0.15]]
grads:  [-0.12503287]
Stock Position:  -0.12503287372529445
Bond Position:  [8.12218258]


portfolio before change:  [-3.59774734]
curr_Stock_Price:  93.7388481716364
curr_Factors:  [93.73884817]
mat_Sqrt:  [[0.15]]
grads:  [-0.04091556]
Stock Position:  -0.04091556101402528
Bond Position:  [0.23763023]


portfolio before change:  [-3.58347166]
curr_Stock_Price:  93.39030528135407
curr_Factors:  [93.39030528]
mat_Sqrt:  [[0.15]]
grads:  [0.05309726]
Stock Position:  0.05309725867663052
Bond Position:  [-8.54224085]


portfolio before change:  [-3.61111836]
curr_Stock_Price:  92.8796800282303
curr_Factors:  [92.87968003]
mat_Sqrt:  [[0.15]]
grads:  [-0.08015156]
Stock Position:  -0.08015156440903268
Bond Position:  [3.83333329]


portfolio before change:  [-3.62371437]
curr_Stock_Price:  93.03982162452311
curr_Factors:  [93.03982162]
mat_Sqrt:  [[0.15]]
grads:  [0.02666253]
Stock Position:  0.02666253033076446
Bond Position:  [-6.10439144]


portfolio before change:  [-3.594359]
curr_Stock_Price:  94.15512861802644
curr_Factors:  [94.15512862]
mat_Sqrt:  [[0.15]]
grads:  [0.11213967]
Stock Position:  0.11213967011244205
Bond Position:  [-14.15288406]


portfolio before change:  [-3.5431929]
curr_Stock_Price:  94.61928802429215
curr_Factors:  [94.61928802]
mat_Sqrt:  [[0.15]]
grads:  [-0.09443227]
Stock Position:  -0.09443226895085159
Bond Position:  [5.39192115]


portfolio before change:  [-3.4897143]
curr_Stock_Price:  94.05653979224866
curr_Factors:  [94.05653979]
mat_Sqrt:  [[0.15]]
grads:  [-0.3462423]
Stock Position:  -0.3462423039998676
Bond Position:  [29.07663874]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.4897143]
Stock Price:  93.60690843438908
PL:  [-3.4897143]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-6.68707473e-02]
 [ 1.92324464e-04]
 [ 3.16606421e-04]
 [ 2.28858288e-03]
 [-6.83618359e-03]
 [ 9.93380556e-03]
 [ 7.18137914e-04]
 [ 1.47921746e-02]
 [ 1.76177222e-02]
 [-5.62218777e-03]
 [ 5.73538786e-03]
 [-7.01825111e-03]
 [-7.65468833e-03]
 [ 3.97136051e-03]
 [-5.44356372e-03]
 [ 9.74959633e-03]
 [-8.17282983e-04]
 [ 7.42534783e-03]
 [ 2.07375218e-02]
 [ 1.05089917e-02]
 [ 2.40231711e-02]
 [-1.67900968e-02]
 [-2.27284321e-03]
 [ 1.25964472e-02]
 [ 1.08020668e-02]
 [-5.68752864e-03]
 [ 1.24033142e-02]
 [-1.78294636e-02]
 [ 1.80045128e-03]
 [-6.30093539e-03]
 [-3.45295557e-03]
 [-1.93481599e-02]
 [ 1.76384769e-02]
 [ 1.12496962e-02]
 [-1.61481157e-02]
 [ 6.35051051e-03]
 [-2.41960665e-03]
 [ 9.74944439e-03]
 [ 3.26445308e-03]
 [-1.46324336e-02]
 [ 1.63623503e-02]
 [-1.75103763e-03]
 [ 4.16678835e-03]
 [-1.01327494e-02]
 [ 2.06975545e-03]
 [ 1.05599870e-03]
 [-1.37073956e-02]
 [-4.31321378e-03]
 [-4.81782228e-04]
 [ 1.04583349e-03]
 [-3.19730150e-03]
 [ 3.50292547e-03]
 [ 1.78157023e-03]
 [ 2.37782336e-03]
 [-6.44462400e-03]
 [ 1.09628321e-02]
 [-1.79822755e-02]
 [-8.45543695e-03]
 [ 1.81927845e-02]
 [-3.97547581e-03]
 [ 1.30221458e-02]
 [-1.45606122e-02]
 [-1.27318285e-02]
 [-2.78012341e-03]
 [ 9.75041299e-02]
 [-1.53135239e-02]
 [ 1.41037824e-02]
 [ 5.17902055e-03]
 [ 1.15759241e-02]
 [-2.35866660e-02]
 [-8.00728230e-03]
 [-6.23886139e-03]
 [ 8.80040321e-03]
 [ 5.71567896e-03]
 [-1.05940205e-03]
 [-1.53821007e-03]
 [ 8.31390294e-03]
 [-3.79160031e-03]
 [ 2.46997871e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.09155602]
curr_Stock_Price:  100.64432034132713
curr_Factors:  [100.64432034]
mat_Sqrt:  [[0.15]]
grads:  [-0.44580498]
Stock Position:  -0.4458049818366324
Bond Position:  [56.95929542]


portfolio before change:  [12.00783363]
curr_Stock_Price:  100.84010652390089
curr_Factors:  [100.84010652]
mat_Sqrt:  [[0.15]]
grads:  [0.00128216]
Stock Position:  0.0012821630965299496
Bond Position:  [11.87854017]


portfolio before change:  [12.00822505]
curr_Stock_Price:  100.56634245116118
curr_Factors:  [100.56634245]
mat_Sqrt:  [[0.15]]
grads:  [0.00211071]
Stock Position:  0.002110709472160196
Bond Position:  [11.79595872]


portfolio before change:  [12.00881323]
curr_Stock_Price:  100.49570524279494
curr_Factors:  [100.49570524]
mat_Sqrt:  [[0.15]]
grads:  [0.01525722]
Stock Position:  0.015257219197039689
Bond Position:  [10.47552822]


portfolio before change:  [11.98972373]
curr_Stock_Price:  99.20161378411257
curr_Factors:  [99.20161378]
mat_Sqrt:  [[0.15]]
grads:  [-0.04557456]
Stock Position:  -0.04557455724868393
Bond Position:  [16.51079336]


portfolio before change:  [11.98528715]
curr_Stock_Price:  99.32160475449965
curr_Factors:  [99.32160475]
mat_Sqrt:  [[0.15]]
grads:  [0.06622537]
Stock Position:  0.066225370394377
Bond Position:  [5.40767709]


portfolio before change:  [11.99731379]
curr_Stock_Price:  99.49810280225071
curr_Factors:  [99.4981028]
mat_Sqrt:  [[0.15]]
grads:  [0.00478759]
Stock Position:  0.004787586096325533
Bond Position:  [11.52095806]


portfolio before change:  [11.99715935]
curr_Stock_Price:  99.31543751784349
curr_Factors:  [99.31543752]
mat_Sqrt:  [[0.15]]
grads:  [0.0986145]
Stock Position:  0.09861449748627098
Bond Position:  [2.20321738]


portfolio before change:  [11.97463759]
curr_Stock_Price:  99.08565931119321
curr_Factors:  [99.08565931]
mat_Sqrt:  [[0.15]]
grads:  [0.11745148]
Stock Position:  0.11745148137202319
Bond Position:  [0.33688012]


portfolio before change:  [11.90957551]
curr_Stock_Price:  98.53153145755938
curr_Factors:  [98.53153146]
mat_Sqrt:  [[0.15]]
grads:  [-0.03748125]
Stock Position:  -0.03748125178109419
Bond Position:  [15.60266065]


portfolio before change:  [11.88876804]
curr_Stock_Price:  99.11269307285913
curr_Factors:  [99.11269307]
mat_Sqrt:  [[0.15]]
grads:  [0.03823592]
Stock Position:  0.03823591907244798
Bond Position:  [8.09910313]


portfolio before change:  [11.87109108]
curr_Stock_Price:  98.63714107952664
curr_Factors:  [98.63714108]
mat_Sqrt:  [[0.15]]
grads:  [-0.04678834]
Stock Position:  -0.04678834072587855
Bond Position:  [16.48615925]


portfolio before change:  [11.83813418]
curr_Stock_Price:  99.36354681763012
curr_Factors:  [99.36354682]
mat_Sqrt:  [[0.15]]
grads:  [-0.05103126]
Stock Position:  -0.051031255527600385
Bond Position:  [16.90878073]


portfolio before change:  [11.84411009]
curr_Stock_Price:  99.2671533936769
curr_Factors:  [99.26715339]
mat_Sqrt:  [[0.15]]
grads:  [0.02647574]
Stock Position:  0.026475736700835487
Bond Position:  [9.21593907]


portfolio before change:  [11.82901736]
curr_Stock_Price:  98.67533797841618
curr_Factors:  [98.67533798]
mat_Sqrt:  [[0.15]]
grads:  [-0.03629042]
Stock Position:  -0.03629042478838623
Bond Position:  [15.40998729]


portfolio before change:  [11.80566888]
curr_Stock_Price:  99.34525652755117
curr_Factors:  [99.34525653]
mat_Sqrt:  [[0.15]]
grads:  [0.06499731]
Stock Position:  0.06499730887492138
Bond Position:  [5.34849456]


portfolio before change:  [11.78187711]
curr_Stock_Price:  98.97407098747318
curr_Factors:  [98.97407099]
mat_Sqrt:  [[0.15]]
grads:  [-0.00544855]
Stock Position:  -0.005448553219563744
Bond Position:  [12.32114261]


portfolio before change:  [11.77993873]
curr_Stock_Price:  99.47117179699342
curr_Factors:  [99.4711718]
mat_Sqrt:  [[0.15]]
grads:  [0.04950232]
Stock Position:  0.04950231884037308
Bond Position:  [6.85588507]


portfolio before change:  [11.7689216]
curr_Stock_Price:  99.23995762368214
curr_Factors:  [99.23995762]
mat_Sqrt:  [[0.15]]
grads:  [0.13825015]
Stock Position:  0.13825014531729432
Bond Position:  [-1.95101697]


portfolio before change:  [11.77437579]
curr_Stock_Price:  99.28029131212901
curr_Factors:  [99.28029131]
mat_Sqrt:  [[0.15]]
grads:  [0.07005994]
Stock Position:  0.07005994445611653
Bond Position:  [4.8188041]


portfolio before change:  [11.71686256]
curr_Stock_Price:  98.45507770116627
curr_Factors:  [98.4550777]
mat_Sqrt:  [[0.15]]
grads:  [0.16015447]
Stock Position:  0.16015447426342067
Bond Position:  [-4.05115865]


portfolio before change:  [11.83945115]
curr_Stock_Price:  99.22209842138757
curr_Factors:  [99.22209842]
mat_Sqrt:  [[0.15]]
grads:  [-0.11193398]
Stock Position:  -0.11193397898607876
Bond Position:  [22.94577543]


portfolio before change:  [11.79073311]
curr_Stock_Price:  99.67014997628405
curr_Factors:  [99.67014998]
mat_Sqrt:  [[0.15]]
grads:  [-0.01515229]
Stock Position:  -0.015152288048805565
Bond Position:  [13.30096394]


portfolio before change:  [11.78997169]
curr_Stock_Price:  99.77526709132057
curr_Factors:  [99.77526709]
mat_Sqrt:  [[0.15]]
grads:  [0.08397631]
Stock Position:  0.08397631438669567
Bond Position:  [3.41121249]


portfolio before change:  [11.77523511]
curr_Stock_Price:  99.59724327048983
curr_Factors:  [99.59724327]
mat_Sqrt:  [[0.15]]
grads:  [0.07201378]
Stock Position:  0.07201377874583315
Bond Position:  [4.60286127]


portfolio before change:  [11.7936757]
curr_Stock_Price:  99.84931863269762
curr_Factors:  [99.84931863]
mat_Sqrt:  [[0.15]]
grads:  [-0.03791686]
Stock Position:  -0.03791685760108403
Bond Position:  [15.57964809]


portfolio before change:  [11.82439382]
curr_Stock_Price:  99.06485588942543
curr_Factors:  [99.06485589]
mat_Sqrt:  [[0.15]]
grads:  [0.08268876]
Stock Position:  0.08268876115897139
Bond Position:  [3.63284361]


portfolio before change:  [11.76745459]
curr_Stock_Price:  98.37351301790397
curr_Factors:  [98.37351302]
mat_Sqrt:  [[0.15]]
grads:  [-0.11886309]
Stock Position:  -0.11886309061399615
Bond Position:  [23.46043438]


portfolio before change:  [11.76642423]
curr_Stock_Price:  98.39451774935593
curr_Factors:  [98.39451775]
mat_Sqrt:  [[0.15]]
grads:  [0.01200301]
Stock Position:  0.012003008550949015
Bond Position:  [10.58539399]


portfolio before change:  [11.76284855]
curr_Stock_Price:  98.0414996243227
curr_Factors:  [98.04149962]
mat_Sqrt:  [[0.15]]
grads:  [-0.04200624]
Stock Position:  -0.04200623596085783
Bond Position:  [15.88120292]


portfolio before change:  [11.79085078]
curr_Stock_Price:  97.39850879738673
curr_Factors:  [97.3985088]
mat_Sqrt:  [[0.15]]
grads:  [-0.0230197]
Stock Position:  -0.02301970377234532
Bond Position:  [14.03293561]


portfolio before change:  [11.78294216]
curr_Stock_Price:  97.78016937816919
curr_Factors:  [97.78016938]
mat_Sqrt:  [[0.15]]
grads:  [-0.12898773]
Stock Position:  -0.1289877329496853
Bond Position:  [24.39538453]


portfolio before change:  [11.75726468]
curr_Stock_Price:  97.99105951588496
curr_Factors:  [97.99105952]
mat_Sqrt:  [[0.15]]
grads:  [0.11758985]
Stock Position:  0.11758984613523145
Bond Position:  [0.23451106]


portfolio before change:  [11.73957437]
curr_Stock_Price:  97.84049413147308
curr_Factors:  [97.84049413]
mat_Sqrt:  [[0.15]]
grads:  [0.07499797]
Stock Position:  0.07499797436128909
Bond Position:  [4.4017355]


portfolio before change:  [11.78636207]
curr_Stock_Price:  98.46067856263882
curr_Factors:  [98.46067856]
mat_Sqrt:  [[0.15]]
grads:  [-0.1076541]
Stock Position:  -0.10765410439104883
Bond Position:  [22.38605823]


portfolio before change:  [11.76835634]
curr_Stock_Price:  98.64093080767799
curr_Factors:  [98.64093081]
mat_Sqrt:  [[0.15]]
grads:  [0.04233674]
Stock Position:  0.04233673673240531
Bond Position:  [7.59222123]


portfolio before change:  [11.76181724]
curr_Stock_Price:  98.47526780161346
curr_Factors:  [98.4752678]
mat_Sqrt:  [[0.15]]
grads:  [-0.01613071]
Stock Position:  -0.016130710989168635
Bond Position:  [13.35029333]


portfolio before change:  [11.76086923]
curr_Stock_Price:  98.58576679631096
curr_Factors:  [98.5857668]
mat_Sqrt:  [[0.15]]
grads:  [0.0649963]
Stock Position:  0.06499629590512618
Bond Position:  [5.35315956]


portfolio before change:  [11.7396209]
curr_Stock_Price:  98.25370296133542
curr_Factors:  [98.25370296]
mat_Sqrt:  [[0.15]]
grads:  [0.02176302]
Stock Position:  0.021763020516906192
Bond Position:  [9.60132354]


portfolio before change:  [11.74054718]
curr_Stock_Price:  98.26869088659298
curr_Factors:  [98.26869089]
mat_Sqrt:  [[0.15]]
grads:  [-0.09754956]
Stock Position:  -0.09754955760982612
Bond Position:  [21.3266145]


portfolio before change:  [11.70899179]
curr_Stock_Price:  98.60583590151901
curr_Factors:  [98.6058359]
mat_Sqrt:  [[0.15]]
grads:  [0.10908234]
Stock Position:  0.1090823356343441
Bond Position:  [0.9528369]


portfolio before change:  [11.71285088]
curr_Stock_Price:  98.6406676946913
curr_Factors:  [98.64066769]
mat_Sqrt:  [[0.15]]
grads:  [-0.01167358]
Stock Position:  -0.011673584179978883
Bond Position:  [12.86434101]


portfolio before change:  [11.70750847]
curr_Stock_Price:  99.16719414999612
curr_Factors:  [99.16719415]
mat_Sqrt:  [[0.15]]
grads:  [0.02777859]
Stock Position:  0.02777858899848066
Bond Position:  [8.95278374]


portfolio before change:  [11.71881591]
curr_Stock_Price:  99.55410631019703
curr_Factors:  [99.55410631]
mat_Sqrt:  [[0.15]]
grads:  [-0.06755166]
Stock Position:  -0.06755166281190463
Bond Position:  [18.44386133]


portfolio before change:  [11.64705997]
curr_Stock_Price:  100.63340940243002
curr_Factors:  [100.6334094]
mat_Sqrt:  [[0.15]]
grads:  [0.01379837]
Stock Position:  0.013798369685732646
Bond Position:  [10.25848299]


portfolio before change:  [11.65132114]
curr_Stock_Price:  100.89575890922248
curr_Factors:  [100.89575891]
mat_Sqrt:  [[0.15]]
grads:  [0.00703999]
Stock Position:  0.007039991329051249
Bond Position:  [10.94101587]


portfolio before change:  [11.65195391]
curr_Stock_Price:  100.88850537486522
curr_Factors:  [100.88850537]
mat_Sqrt:  [[0.15]]
grads:  [-0.09138264]
Stock Position:  -0.09138263742276372
Bond Position:  [20.87141162]


portfolio before change:  [11.59117286]
curr_Stock_Price:  101.56790747410237
curr_Factors:  [101.56790747]
mat_Sqrt:  [[0.15]]
grads:  [-0.02875476]
Stock Position:  -0.028754758536181403
Bond Position:  [14.51173352]


portfolio before change:  [11.58561627]
curr_Stock_Price:  101.79269130031325
curr_Factors:  [101.7926913]
mat_Sqrt:  [[0.15]]
grads:  [-0.00321188]
Stock Position:  -0.0032118815225540697
Bond Position:  [11.91256233]


portfolio before change:  [11.58774606]
curr_Stock_Price:  101.36140650636231
curr_Factors:  [101.36140651]
mat_Sqrt:  [[0.15]]
grads:  [0.00697222]
Stock Position:  0.006972223257084564
Bond Position:  [10.88103171]


portfolio before change:  [11.59382412]
curr_Stock_Price:  102.13561813432919
curr_Factors:  [102.13561813]
mat_Sqrt:  [[0.15]]
grads:  [-0.02131534]
Stock Position:  -0.021315343329214014
Bond Position:  [13.77087989]


portfolio before change:  [11.58198354]
curr_Stock_Price:  102.73149347182738
curr_Factors:  [102.73149347]
mat_Sqrt:  [[0.15]]
grads:  [0.02335284]
Stock Position:  0.02335283648776191
Bond Position:  [9.18291177]


portfolio before change:  [11.59263281]
curr_Stock_Price:  103.16293223105916
curr_Factors:  [103.16293223]
mat_Sqrt:  [[0.15]]
grads:  [0.01187713]
Stock Position:  0.011877134857442954
Bond Position:  [10.36735275]


portfolio before change:  [11.59652203]
curr_Stock_Price:  103.43582985542847
curr_Factors:  [103.43582986]
mat_Sqrt:  [[0.15]]
grads:  [0.01585216]
Stock Position:  0.01585215570201118
Bond Position:  [9.95684115]


portfolio before change:  [11.60177096]
curr_Stock_Price:  103.7276895494425
curr_Factors:  [103.72768955]
mat_Sqrt:  [[0.15]]
grads:  [-0.04296416]
Stock Position:  -0.04296415999889596
Bond Position:  [16.05834401]


portfolio before change:  [11.57286018]
curr_Stock_Price:  104.42395505167704
curr_Factors:  [104.42395505]
mat_Sqrt:  [[0.15]]
grads:  [0.07308555]
Stock Position:  0.07308554706798738
Bond Position:  [3.94097829]


portfolio before change:  [11.58051978]
curr_Stock_Price:  104.52538803922752
curr_Factors:  [104.52538804]
mat_Sqrt:  [[0.15]]
grads:  [-0.11988184]
Stock Position:  -0.1198818367837626
Bond Position:  [24.11121529]


portfolio before change:  [11.52129942]
curr_Stock_Price:  105.03194812889825
curr_Factors:  [105.03194813]
mat_Sqrt:  [[0.15]]
grads:  [-0.05636958]
Stock Position:  -0.056369579679449305
Bond Position:  [17.44190619]


portfolio before change:  [11.51695677]
curr_Stock_Price:  105.12832656182351
curr_Factors:  [105.12832656]
mat_Sqrt:  [[0.15]]
grads:  [0.12128523]
Stock Position:  0.12128522998324168
Bond Position:  [-1.2335565]


portfolio before change:  [11.51012281]
curr_Stock_Price:  105.07261609300082
curr_Factors:  [105.07261609]
mat_Sqrt:  [[0.15]]
grads:  [-0.02650317]
Stock Position:  -0.026503172071233323
Bond Position:  [14.29488043]


portfolio before change:  [11.51965276]
curr_Stock_Price:  104.74674972206292
curr_Factors:  [104.74674972]
mat_Sqrt:  [[0.15]]
grads:  [0.08681431]
Stock Position:  0.08681430500890305
Bond Position:  [2.42613648]


portfolio before change:  [11.52398303]
curr_Stock_Price:  104.7948826595229
curr_Factors:  [104.79488266]
mat_Sqrt:  [[0.15]]
grads:  [-0.09707075]
Stock Position:  -0.09707074807229754
Bond Position:  [21.69650068]


portfolio before change:  [11.48295732]
curr_Stock_Price:  105.23148981556633
curr_Factors:  [105.23148982]
mat_Sqrt:  [[0.15]]
grads:  [-0.08487886]
Stock Position:  -0.08487885688148525
Bond Position:  [20.41488588]


portfolio before change:  [11.37636834]
curr_Stock_Price:  106.50230030648596
curr_Factors:  [106.50230031]
mat_Sqrt:  [[0.15]]
grads:  [-0.01853416]
Stock Position:  -0.0185341560732377
Bond Position:  [13.3502986]


portfolio before change:  [11.37507004]
curr_Stock_Price:  106.61737032315618
curr_Factors:  [106.61737032]
mat_Sqrt:  [[0.15]]
grads:  [0.65002753]
Stock Position:  0.6500275326100308
Bond Position:  [-57.92915613]


portfolio before change:  [10.87035357]
curr_Stock_Price:  105.8464863924948
curr_Factors:  [105.84648639]
mat_Sqrt:  [[0.15]]
grads:  [-0.10209016]
Stock Position:  -0.10209015921687997
Bond Position:  [21.67623822]


portfolio before change:  [10.94145343]
curr_Stock_Price:  105.16331526163854
curr_Factors:  [105.16331526]
mat_Sqrt:  [[0.15]]
grads:  [0.09402522]
Stock Position:  0.0940252162362166
Bond Position:  [1.05344997]


portfolio before change:  [10.99624656]
curr_Stock_Price:  105.745364336205
curr_Factors:  [105.74536434]
mat_Sqrt:  [[0.15]]
grads:  [0.0345268]
Stock Position:  0.034526803688791435
Bond Position:  [7.34519713]


portfolio before change:  [10.96512995]
curr_Stock_Price:  104.83083706464204
curr_Factors:  [104.83083706]
mat_Sqrt:  [[0.15]]
grads:  [0.07717283]
Stock Position:  0.07717282714249722
Bond Position:  [2.87503788]


portfolio before change:  [10.97531632]
curr_Stock_Price:  104.96050287203741
curr_Factors:  [104.96050287]
mat_Sqrt:  [[0.15]]
grads:  [-0.15724444]
Stock Position:  -0.1572444399727713
Bond Position:  [27.47977181]


portfolio before change:  [11.01717236]
curr_Stock_Price:  104.70524105628026
curr_Factors:  [104.70524106]
mat_Sqrt:  [[0.15]]
grads:  [-0.05338188]
Stock Position:  -0.05338188199982845
Bond Position:  [16.60653519]


portfolio before change:  [10.97960763]
curr_Stock_Price:  105.4283828437091
curr_Factors:  [105.42838284]
mat_Sqrt:  [[0.15]]
grads:  [-0.04159241]
Stock Position:  -0.0415924092701497
Bond Position:  [15.36462808]


portfolio before change:  [10.98610358]
curr_Stock_Price:  105.29529067314724
curr_Factors:  [105.29529067]
mat_Sqrt:  [[0.15]]
grads:  [0.05866935]
Stock Position:  0.058669354724416825
Bond Position:  [4.80849682]


portfolio before change:  [11.02007215]
curr_Stock_Price:  105.8691513114533
curr_Factors:  [105.86915131]
mat_Sqrt:  [[0.15]]
grads:  [0.03810453]
Stock Position:  0.03810452641934863
Bond Position:  [6.98597828]


portfolio before change:  [11.02270807]
curr_Stock_Price:  105.92686832005441
curr_Factors:  [105.92686832]
mat_Sqrt:  [[0.15]]
grads:  [-0.00706268]
Stock Position:  -0.007062680307077021
Bond Position:  [11.77083567]


portfolio before change:  [11.02821819]
curr_Stock_Price:  105.25086111892205
curr_Factors:  [105.25086112]
mat_Sqrt:  [[0.15]]
grads:  [-0.01025473]
Stock Position:  -0.01025473381534878
Bond Position:  [12.10753775]


portfolio before change:  [11.03399749]
curr_Stock_Price:  104.76108167037376
curr_Factors:  [104.76108167]
mat_Sqrt:  [[0.15]]
grads:  [0.05542602]
Stock Position:  0.05542601962277509
Bond Position:  [5.22750772]


portfolio before change:  [11.01458019]
curr_Stock_Price:  104.40485858173828
curr_Factors:  [104.40485858]
mat_Sqrt:  [[0.15]]
grads:  [-0.02527734]
Stock Position:  -0.02527733540679826
Bond Position:  [13.65365682]


portfolio before change:  [11.02160686]
curr_Stock_Price:  104.1606365454941
curr_Factors:  [104.16063655]
mat_Sqrt:  [[0.15]]
grads:  [0.16466525]
Stock Position:  0.16466524740950794
Bond Position:  [-6.13003013]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.02160686]
Stock Price:  104.22873914687318
PL:  [6.79286771]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.57174565e-02]
 [-1.82026036e-03]
 [ 2.26355196e-04]
 [ 2.14478498e-03]
 [ 2.14136195e-02]
 [ 1.07371828e-02]
 [ 1.22214466e-03]
 [ 1.41034964e-02]
 [ 1.47968722e-02]
 [ 2.74032086e-03]
 [ 6.88601635e-03]
 [-7.92330748e-03]
 [ 1.97811843e-04]
 [ 3.55065928e-03]
 [-1.34651795e-02]
 [ 8.19024263e-03]
 [-5.84624654e-04]
 [ 4.27261770e-03]
 [ 2.13418503e-02]
 [ 1.11851524e-02]
 [ 4.44817466e-02]
 [-1.53362369e-02]
 [-2.53781532e-03]
 [ 1.35536372e-02]
 [ 7.27718909e-03]
 [-6.20233253e-03]
 [ 1.22644827e-02]
 [-2.10728705e-02]
 [ 1.49848415e-03]
 [-9.78765923e-03]
 [-3.64226677e-03]
 [-2.05710181e-02]
 [ 1.57967413e-02]
 [ 1.90988518e-02]
 [ 3.45259996e-03]
 [ 3.86110146e-03]
 [-2.38518257e-03]
 [ 6.63514716e-03]
 [ 4.05643090e-03]
 [-1.56760775e-02]
 [ 2.98676799e-02]
 [-8.90899552e-04]
 [ 3.36317429e-03]
 [-8.11399968e-03]
 [ 1.15138219e-03]
 [-7.13561195e-03]
 [-1.34811542e-02]
 [-6.59018501e-04]
 [-4.53431481e-03]
 [ 5.31658287e-03]
 [-3.38878260e-03]
 [ 3.06824484e-03]
 [ 3.24300961e-03]
 [ 2.45769056e-03]
 [ 2.86845577e-03]
 [ 8.94232308e-03]
 [ 1.29355558e-02]
 [-8.47991813e-03]
 [ 1.36763130e-02]
 [-1.39827260e-03]
 [ 1.26121006e-03]
 [-1.93682450e-02]
 [-1.27745341e-02]
 [-1.57309582e-03]
 [-9.46360098e-03]
 [-1.96723934e-02]
 [ 9.47874750e-03]
 [ 1.77483930e-03]
 [ 1.38248317e-02]
 [-1.87586084e-02]
 [ 1.12379904e-02]
 [-2.24797425e-03]
 [-1.22827432e-03]
 [ 8.22948793e-03]
 [-2.96428680e-03]
 [ 2.68746190e-03]
 [ 4.56823233e-03]
 [-1.18712818e-02]
 [-4.54705591e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.57938317]
curr_Stock_Price:  100.29004935673531
curr_Factors:  [100.29004936]
mat_Sqrt:  [[0.15]]
grads:  [-0.30478304]
Stock Position:  -0.30478304354945274
Bond Position:  [37.14608965]


portfolio before change:  [6.54138726]
curr_Stock_Price:  100.4223323546028
curr_Factors:  [100.42233235]
mat_Sqrt:  [[0.15]]
grads:  [-0.01213507]
Stock Position:  -0.012135069059036309
Bond Position:  [7.7600192]


portfolio before change:  [6.54587413]
curr_Stock_Price:  100.09255672763774
curr_Factors:  [100.09255673]
mat_Sqrt:  [[0.15]]
grads:  [0.00150903]
Stock Position:  0.0015090346384291024
Bond Position:  [6.39483099]


portfolio before change:  [6.54596607]
curr_Stock_Price:  99.88862349573634
curr_Factors:  [99.8886235]
mat_Sqrt:  [[0.15]]
grads:  [0.01429857]
Stock Position:  0.014298566535411375
Bond Position:  [5.11770195]


portfolio before change:  [6.54680795]
curr_Stock_Price:  99.9251311949958
curr_Factors:  [99.92513119]
mat_Sqrt:  [[0.15]]
grads:  [0.14275746]
Stock Position:  0.14275746310455073
Bond Position:  [-7.71825028]


portfolio before change:  [6.48550392]
curr_Stock_Price:  99.4990825711779
curr_Factors:  [99.49908257]
mat_Sqrt:  [[0.15]]
grads:  [0.07158122]
Stock Position:  0.07158121859879668
Bond Position:  [-0.63676166]


portfolio before change:  [6.51185551]
curr_Stock_Price:  99.86777401488115
curr_Factors:  [99.86777401]
mat_Sqrt:  [[0.15]]
grads:  [0.00814763]
Stock Position:  0.00814763106692613
Bond Position:  [5.69816973]


portfolio before change:  [6.50808145]
curr_Stock_Price:  99.36085296032722
curr_Factors:  [99.36085296]
mat_Sqrt:  [[0.15]]
grads:  [0.09402331]
Stock Position:  0.09402330962481138
Bond Position:  [-2.83415479]


portfolio before change:  [6.45504786]
curr_Stock_Price:  98.79868977843483
curr_Factors:  [98.79868978]
mat_Sqrt:  [[0.15]]
grads:  [0.09864581]
Stock Position:  0.09864581478567175
Bond Position:  [-3.29102939]


portfolio before change:  [6.40667206]
curr_Stock_Price:  98.31037605477697
curr_Factors:  [98.31037605]
mat_Sqrt:  [[0.15]]
grads:  [0.01826881]
Stock Position:  0.01826880572100264
Bond Position:  [4.6106589]


portfolio before change:  [6.40955864]
curr_Stock_Price:  98.4526075512221
curr_Factors:  [98.45260755]
mat_Sqrt:  [[0.15]]
grads:  [0.04590678]
Stock Position:  0.045906775686439284
Bond Position:  [1.88991687]


portfolio before change:  [6.40362641]
curr_Stock_Price:  98.32081096723319
curr_Factors:  [98.32081097]
mat_Sqrt:  [[0.15]]
grads:  [-0.05282205]
Stock Position:  -0.052822049863592804
Bond Position:  [11.59713319]


portfolio before change:  [6.40447458]
curr_Stock_Price:  98.3184761744324
curr_Factors:  [98.31847617]
mat_Sqrt:  [[0.15]]
grads:  [0.00131875]
Stock Position:  0.0013187456218768934
Bond Position:  [6.27481752]


portfolio before change:  [6.40549032]
curr_Stock_Price:  98.79131269135618
curr_Factors:  [98.79131269]
mat_Sqrt:  [[0.15]]
grads:  [0.02367106]
Stock Position:  0.023671061869344485
Bond Position:  [4.06699504]


portfolio before change:  [6.39230559]
curr_Stock_Price:  98.22357634884183
curr_Factors:  [98.22357635]
mat_Sqrt:  [[0.15]]
grads:  [-0.08976786]
Stock Position:  -0.08976786327948641
Bond Position:  [15.20962616]


portfolio before change:  [6.28265671]
curr_Stock_Price:  99.45563762610378
curr_Factors:  [99.45563763]
mat_Sqrt:  [[0.15]]
grads:  [0.05460162]
Stock Position:  0.054601617564178084
Bond Position:  [0.85221802]


portfolio before change:  [6.25986106]
curr_Stock_Price:  99.0371716922682
curr_Factors:  [99.03717169]
mat_Sqrt:  [[0.15]]
grads:  [-0.0038975]
Stock Position:  -0.003897497693450518
Bond Position:  [6.64585821]


portfolio before change:  [6.26228026]
curr_Stock_Price:  98.52304275533025
curr_Factors:  [98.52304276]
mat_Sqrt:  [[0.15]]
grads:  [0.02848412]
Stock Position:  0.02848411799431004
Bond Position:  [3.45593828]


portfolio before change:  [6.2855343]
curr_Stock_Price:  99.33184582916057
curr_Factors:  [99.33184583]
mat_Sqrt:  [[0.15]]
grads:  [0.142279]
Stock Position:  0.14227900220120102
Bond Position:  [-7.84730161]


portfolio before change:  [6.2517791]
curr_Stock_Price:  99.0980465343982
curr_Factors:  [99.09804653]
mat_Sqrt:  [[0.15]]
grads:  [0.07456768]
Stock Position:  0.07456768248247042
Bond Position:  [-1.13773257]


portfolio before change:  [6.23302615]
curr_Stock_Price:  98.84751124532785
curr_Factors:  [98.84751125]
mat_Sqrt:  [[0.15]]
grads:  [0.29654498]
Stock Position:  0.29654497717968126
Bond Position:  [-23.07970681]


portfolio before change:  [6.47311673]
curr_Stock_Price:  99.66200187413861
curr_Factors:  [99.66200187]
mat_Sqrt:  [[0.15]]
grads:  [-0.10224158]
Stock Position:  -0.10224157924897176
Bond Position:  [16.66271719]


portfolio before change:  [6.45859411]
curr_Stock_Price:  99.81423026965479
curr_Factors:  [99.81423027]
mat_Sqrt:  [[0.15]]
grads:  [-0.01691877]
Stock Position:  -0.016918768821993776
Bond Position:  [8.147328]


portfolio before change:  [6.46461069]
curr_Stock_Price:  99.48871275183235
curr_Factors:  [99.48871275]
mat_Sqrt:  [[0.15]]
grads:  [0.09035758]
Stock Position:  0.0903575815411416
Bond Position:  [-2.52494878]


portfolio before change:  [6.41566486]
curr_Stock_Price:  98.94876896296796
curr_Factors:  [98.94876896]
mat_Sqrt:  [[0.15]]
grads:  [0.04851459]
Stock Position:  0.048514593926688304
Bond Position:  [1.61520552]


portfolio before change:  [6.46264274]
curr_Stock_Price:  99.91501266406543
curr_Factors:  [99.91501266]
mat_Sqrt:  [[0.15]]
grads:  [-0.04134888]
Stock Position:  -0.04134888354342041
Bond Position:  [10.59401696]


portfolio before change:  [6.4928023]
curr_Stock_Price:  99.201633879197
curr_Factors:  [99.20163388]
mat_Sqrt:  [[0.15]]
grads:  [0.08176322]
Stock Position:  0.08176321802653654
Bond Position:  [-1.61824252]


portfolio before change:  [6.41301794]
curr_Stock_Price:  98.22707314941422
curr_Factors:  [98.22707315]
mat_Sqrt:  [[0.15]]
grads:  [-0.1404858]
Stock Position:  -0.14048580301136412
Bond Position:  [20.21252718]


portfolio before change:  [6.43524731]
curr_Stock_Price:  98.07783349101508
curr_Factors:  [98.07783349]
mat_Sqrt:  [[0.15]]
grads:  [0.00998989]
Stock Position:  0.009989894333489551
Bond Position:  [5.45546012]


portfolio before change:  [6.44019691]
curr_Stock_Price:  98.5391614067301
curr_Factors:  [98.53916141]
mat_Sqrt:  [[0.15]]
grads:  [-0.06525106]
Stock Position:  -0.06525106156388143
Bond Position:  [12.86998179]


portfolio before change:  [6.46083492]
curr_Stock_Price:  98.23520286082199
curr_Factors:  [98.23520286]
mat_Sqrt:  [[0.15]]
grads:  [-0.02428178]
Stock Position:  -0.024281778471495638
Bond Position:  [8.84616036]


portfolio before change:  [6.44819147]
curr_Stock_Price:  98.77867037182432
curr_Factors:  [98.77867037]
mat_Sqrt:  [[0.15]]
grads:  [-0.13714012]
Stock Position:  -0.1371401204574443
Bond Position:  [19.99471022]


portfolio before change:  [6.35075919]
curr_Stock_Price:  99.4982408893682
curr_Factors:  [99.49824089]
mat_Sqrt:  [[0.15]]
grads:  [0.10531161]
Stock Position:  0.10531160872773708
Bond Position:  [-4.12756063]


portfolio before change:  [6.36811591]
curr_Stock_Price:  99.66550358980666
curr_Factors:  [99.66550359]
mat_Sqrt:  [[0.15]]
grads:  [0.12732568]
Stock Position:  0.12732567876715445
Bond Position:  [-6.32186198]


portfolio before change:  [6.45953715]
curr_Stock_Price:  100.38661789371075
curr_Factors:  [100.38661789]
mat_Sqrt:  [[0.15]]
grads:  [0.02301733]
Stock Position:  0.023017333036760547
Bond Position:  [4.14890493]


portfolio before change:  [6.43646407]
curr_Stock_Price:  99.37292975844565
curr_Factors:  [99.37292976]
mat_Sqrt:  [[0.15]]
grads:  [0.02574068]
Stock Position:  0.025740676430810253
Bond Position:  [3.87853764]


portfolio before change:  [6.41611817]
curr_Stock_Price:  98.57309390921755
curr_Factors:  [98.57309391]
mat_Sqrt:  [[0.15]]
grads:  [-0.01590122]
Stock Position:  -0.015901217159956342
Bond Position:  [7.98355034]


portfolio before change:  [6.42433522]
curr_Stock_Price:  98.08771854421224
curr_Factors:  [98.08771854]
mat_Sqrt:  [[0.15]]
grads:  [0.04423431]
Stock Position:  0.04423431443096365
Bond Position:  [2.08549223]


portfolio before change:  [6.41135992]
curr_Stock_Price:  97.79144082210955
curr_Factors:  [97.79144082]
mat_Sqrt:  [[0.15]]
grads:  [0.02704287]
Stock Position:  0.02704287264132121
Bond Position:  [3.76679844]


portfolio before change:  [6.40146846]
curr_Stock_Price:  97.41696551261133
curr_Factors:  [97.41696551]
mat_Sqrt:  [[0.15]]
grads:  [-0.10450718]
Stock Position:  -0.10450718337078106
Bond Position:  [16.58224114]


portfolio before change:  [6.35038004]
curr_Stock_Price:  97.91573355151084
curr_Factors:  [97.91573355]
mat_Sqrt:  [[0.15]]
grads:  [0.19911787]
Stock Position:  0.19911786582727353
Bond Position:  [-13.14639185]


portfolio before change:  [6.33569991]
curr_Stock_Price:  97.84613425888628
curr_Factors:  [97.84613426]
mat_Sqrt:  [[0.15]]
grads:  [-0.00593933]
Stock Position:  -0.005939330346583803
Bond Position:  [6.91684042]


portfolio before change:  [6.33218327]
curr_Stock_Price:  98.51101559976199
curr_Factors:  [98.5110156]
mat_Sqrt:  [[0.15]]
grads:  [0.02242116]
Stock Position:  0.022421161904269914
Bond Position:  [4.12345184]


portfolio before change:  [6.32444084]
curr_Stock_Price:  98.15420277969162
curr_Factors:  [98.15420278]
mat_Sqrt:  [[0.15]]
grads:  [-0.05409333]
Stock Position:  -0.05409333120061692
Bond Position:  [11.63392864]


portfolio before change:  [6.34689751]
curr_Stock_Price:  97.75249844459249
curr_Factors:  [97.75249844]
mat_Sqrt:  [[0.15]]
grads:  [0.00767588]
Stock Position:  0.0076758812889381875
Bond Position:  [5.59656093]


portfolio before change:  [6.34254973]
curr_Stock_Price:  97.14050755475675
curr_Factors:  [97.14050755]
mat_Sqrt:  [[0.15]]
grads:  [-0.04757075]
Stock Position:  -0.047570746320157266
Bond Position:  [10.96359618]


portfolio before change:  [6.34827865]
curr_Stock_Price:  97.03448295059
curr_Factors:  [97.03448295]
mat_Sqrt:  [[0.15]]
grads:  [-0.08987436]
Stock Position:  -0.08987436138658078
Bond Position:  [15.06919084]


portfolio before change:  [6.31822286]
curr_Stock_Price:  97.3793827379832
curr_Factors:  [97.37938274]
mat_Sqrt:  [[0.15]]
grads:  [-0.00439346]
Stock Position:  -0.00439345667322296
Bond Position:  [6.74605495]


portfolio before change:  [6.31797569]
curr_Stock_Price:  97.53161027285651
curr_Factors:  [97.53161027]
mat_Sqrt:  [[0.15]]
grads:  [-0.03022877]
Stock Position:  -0.030228765385735847
Bond Position:  [9.26623586]


portfolio before change:  [6.31100765]
curr_Stock_Price:  97.78127958197096
curr_Factors:  [97.78127958]
mat_Sqrt:  [[0.15]]
grads:  [0.03544389]
Stock Position:  0.03544388579759994
Bond Position:  [2.84525915]


portfolio before change:  [6.30749541]
curr_Stock_Price:  97.67716911523578
curr_Factors:  [97.67716912]
mat_Sqrt:  [[0.15]]
grads:  [-0.02259188]
Stock Position:  -0.022591884033151318
Bond Position:  [8.51420669]


portfolio before change:  [6.30531585]
curr_Stock_Price:  97.79719962646388
curr_Factors:  [97.79719963]
mat_Sqrt:  [[0.15]]
grads:  [0.02045497]
Stock Position:  0.020454965607013938
Bond Position:  [4.30487749]


portfolio before change:  [6.30416745]
curr_Stock_Price:  97.72790282270827
curr_Factors:  [97.72790282]
mat_Sqrt:  [[0.15]]
grads:  [0.02162006]
Stock Position:  0.021620064075960985
Bond Position:  [4.19128393]


portfolio before change:  [6.30884672]
curr_Stock_Price:  97.93221804101655
curr_Factors:  [97.93221804]
mat_Sqrt:  [[0.15]]
grads:  [0.0163846]
Stock Position:  0.016384603704103124
Bond Position:  [4.70426614]


portfolio before change:  [6.30809646]
curr_Stock_Price:  97.86848255114673
curr_Factors:  [97.86848255]
mat_Sqrt:  [[0.15]]
grads:  [0.01912304]
Stock Position:  0.019123038446774435
Bond Position:  [4.43655371]


portfolio before change:  [6.30448743]
curr_Stock_Price:  97.66525483803576
curr_Factors:  [97.66525484]
mat_Sqrt:  [[0.15]]
grads:  [0.05961549]
Stock Position:  0.059615487175458635
Bond Position:  [0.48212568]


portfolio before change:  [6.30682577]
curr_Stock_Price:  97.70397317710982
curr_Factors:  [97.70397318]
mat_Sqrt:  [[0.15]]
grads:  [0.08623704]
Stock Position:  0.08623703862392632
Bond Position:  [-2.11887554]


portfolio before change:  [6.33321186]
curr_Stock_Price:  98.01148044468304
curr_Factors:  [98.01148044]
mat_Sqrt:  [[0.15]]
grads:  [-0.05653279]
Stock Position:  -0.056532787515109796
Bond Position:  [11.87407405]


portfolio before change:  [6.35460194]
curr_Stock_Price:  97.64624235243446
curr_Factors:  [97.64624235]
mat_Sqrt:  [[0.15]]
grads:  [0.09117542]
Stock Position:  0.09117542018289573
Bond Position:  [-2.54833524]


portfolio before change:  [6.28779246]
curr_Stock_Price:  96.91523177991276
curr_Factors:  [96.91523178]
mat_Sqrt:  [[0.15]]
grads:  [-0.00932182]
Stock Position:  -0.009321817322249088
Bond Position:  [7.19121855]


portfolio before change:  [6.28651724]
curr_Stock_Price:  97.10024800399349
curr_Factors:  [97.100248]
mat_Sqrt:  [[0.15]]
grads:  [0.00840807]
Stock Position:  0.008408067065051403
Bond Position:  [5.47009184]


portfolio before change:  [6.28212473]
curr_Stock_Price:  96.53716947991242
curr_Factors:  [96.53716948]
mat_Sqrt:  [[0.15]]
grads:  [-0.12912163]
Stock Position:  -0.12912163355354964
Bond Position:  [18.74716175]


portfolio before change:  [6.28497077]
curr_Stock_Price:  96.52420261588013
curr_Factors:  [96.52420262]
mat_Sqrt:  [[0.15]]
grads:  [-0.08516356]
Stock Position:  -0.08516356060818657
Bond Position:  [14.50531555]


portfolio before change:  [6.26143243]
curr_Stock_Price:  96.81123792140282
curr_Factors:  [96.81123792]
mat_Sqrt:  [[0.15]]
grads:  [-0.01048731]
Stock Position:  -0.01048730546652142
Bond Position:  [7.27672145]


portfolio before change:  [6.25994373]
curr_Stock_Price:  96.99655792829023
curr_Factors:  [96.99655793]
mat_Sqrt:  [[0.15]]
grads:  [-0.06309067]
Stock Position:  -0.06309067316782463
Bond Position:  [12.37952187]


portfolio before change:  [6.22452277]
curr_Stock_Price:  97.57025137670385
curr_Factors:  [97.57025138]
mat_Sqrt:  [[0.15]]
grads:  [-0.13114929]
Stock Position:  -0.13114928954441765
Bond Position:  [19.02079192]


portfolio before change:  [6.32261353]
curr_Stock_Price:  96.83138403085394
curr_Factors:  [96.83138403]
mat_Sqrt:  [[0.15]]
grads:  [0.06319165]
Stock Position:  0.06319164999007734
Bond Position:  [0.20367861]


portfolio before change:  [6.27011952]
curr_Stock_Price:  96.00047138489408
curr_Factors:  [96.00047138]
mat_Sqrt:  [[0.15]]
grads:  [0.01183226]
Stock Position:  0.011832262000517272
Bond Position:  [5.13421679]


portfolio before change:  [6.26733633]
curr_Stock_Price:  95.73813020924594
curr_Factors:  [95.73813021]
mat_Sqrt:  [[0.15]]
grads:  [0.09216554]
Stock Position:  0.0921655446286619
Bond Position:  [-2.55642058]


portfolio before change:  [6.29182281]
curr_Stock_Price:  96.0055431353923
curr_Factors:  [96.00554314]
mat_Sqrt:  [[0.15]]
grads:  [-0.12505739]
Stock Position:  -0.12505738922859935
Bond Position:  [18.29802538]


portfolio before change:  [6.25650354]
curr_Stock_Price:  96.29711271115731
curr_Factors:  [96.29711271]
mat_Sqrt:  [[0.15]]
grads:  [0.07491994]
Stock Position:  0.07491993619023796
Bond Position:  [-0.95807]


portfolio before change:  [6.25526112]
curr_Stock_Price:  96.28132866703478
curr_Factors:  [96.28132867]
mat_Sqrt:  [[0.15]]
grads:  [-0.0149865]
Stock Position:  -0.014986495000817435
Bond Position:  [7.69818077]


portfolio before change:  [6.24876051]
curr_Stock_Price:  96.74719870312263
curr_Factors:  [96.7471987]
mat_Sqrt:  [[0.15]]
grads:  [-0.0081885]
Stock Position:  -0.00818849546339197
Bond Position:  [7.04097451]


portfolio before change:  [6.24310337]
curr_Stock_Price:  97.4918066595179
curr_Factors:  [97.49180666]
mat_Sqrt:  [[0.15]]
grads:  [0.05486325]
Stock Position:  0.05486325284657901
Bond Position:  [0.89438573]


portfolio before change:  [6.17164995]
curr_Stock_Price:  96.18839644231828
curr_Factors:  [96.18839644]
mat_Sqrt:  [[0.15]]
grads:  [-0.01976191]
Stock Position:  -0.01976191197348401
Bond Position:  [8.07251657]


portfolio before change:  [6.15938491]
curr_Stock_Price:  96.83456804567153
curr_Factors:  [96.83456805]
mat_Sqrt:  [[0.15]]
grads:  [0.01791641]
Stock Position:  0.017916412647174144
Bond Position:  [4.42445683]


portfolio before change:  [6.15984952]
curr_Stock_Price:  96.84506542084279
curr_Factors:  [96.84506542]
mat_Sqrt:  [[0.15]]
grads:  [0.03045488]
Stock Position:  0.030454882186445303
Bond Position:  [3.21044446]


portfolio before change:  [6.14136754]
curr_Stock_Price:  96.23161232081684
curr_Factors:  [96.23161232]
mat_Sqrt:  [[0.15]]
grads:  [-0.07914188]
Stock Position:  -0.07914187872924301
Bond Position:  [13.75731813]


portfolio before change:  [6.18533735]
curr_Stock_Price:  95.68689496606567
curr_Factors:  [95.68689497]
mat_Sqrt:  [[0.15]]
grads:  [-0.30313706]
Stock Position:  -0.30313706039166294
Bond Position:  [35.19158141]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.18533735]
Stock Price:  96.26512049782227
PL:  [6.18533735]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.45740167e-02]
 [-2.31259005e-03]
 [ 2.46996907e-04]
 [ 2.30246322e-03]
 [ 1.54553303e-02]
 [ 1.17666860e-02]
 [ 7.62237370e-04]
 [ 7.62798520e-03]
 [-1.22383251e-03]
 [-2.02142098e-02]
 [ 1.02578822e-02]
 [-7.03634643e-03]
 [ 2.12601118e-02]
 [ 1.03456139e-02]
 [-7.51236841e-03]
 [-8.00723863e-03]
 [ 1.32047777e-02]
 [ 2.52621491e-02]
 [-1.50976740e-02]
 [-4.07498408e-03]
 [ 1.67479974e-02]
 [-1.05564881e-02]
 [ 8.86539050e-03]
 [-1.81235039e-03]
 [ 1.77869667e-02]
 [ 1.74400871e-02]
 [ 8.03425506e-03]
 [-1.35861404e-03]
 [ 7.26974782e-03]
 [-9.88717752e-03]
 [-5.70667935e-03]
 [ 3.22764080e-02]
 [ 7.60458589e-03]
 [ 1.54277789e-03]
 [-2.01265801e-03]
 [-4.74331070e-03]
 [-7.01701484e-03]
 [ 4.10640486e-03]
 [ 1.15123107e-03]
 [-8.17364474e-03]
 [-3.09927845e-02]
 [-2.40538620e-03]
 [ 1.18459180e-02]
 [-1.15840292e-02]
 [-1.79656287e-04]
 [ 2.23633622e-03]
 [-1.36832265e-02]
 [-5.14889107e-04]
 [ 2.89809154e-03]
 [-4.66536658e-03]
 [-3.10475586e-03]
 [ 3.56205249e-03]
 [ 1.97787267e-04]
 [ 1.96022865e-03]
 [ 1.29277862e-03]
 [ 8.51533195e-03]
 [-8.59833044e-03]
 [-1.42796048e-02]
 [ 1.33944523e-02]
 [ 6.09151130e-03]
 [ 1.00447306e-02]
 [-1.32718051e-02]
 [-1.25820369e-02]
 [-2.25289662e-03]
 [-1.34888218e-02]
 [ 3.24160415e-02]
 [ 1.32055524e-02]
 [ 2.09407069e-03]
 [ 6.48533248e-03]
 [-1.47870901e-02]
 [-4.61207019e-03]
 [ 2.00132166e-03]
 [-3.99673640e-05]
 [ 8.30043620e-03]
 [ 2.84536424e-03]
 [ 2.42364544e-03]
 [ 4.34290327e-03]
 [-1.08150593e-02]
 [-3.15434266e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.20417054]
curr_Stock_Price:  99.78979522539855
curr_Factors:  [99.78979523]
mat_Sqrt:  [[0.15]]
grads:  [-0.23049344]
Stock Position:  -0.23049344437155608
Bond Position:  [21.79672307]


portfolio before change:  [-1.30754467]
curr_Stock_Price:  100.24419626343477
curr_Factors:  [100.24419626]
mat_Sqrt:  [[0.15]]
grads:  [-0.01541727]
Stock Position:  -0.015417267007952528
Bond Position:  [0.23794687]


portfolio before change:  [-1.2995252]
curr_Stock_Price:  99.72499960858018
curr_Factors:  [99.72499961]
mat_Sqrt:  [[0.15]]
grads:  [0.00164665]
Stock Position:  0.0016466460490867536
Bond Position:  [-1.46373698]


portfolio before change:  [-1.29823906]
curr_Stock_Price:  100.56162520142233
curr_Factors:  [100.5616252]
mat_Sqrt:  [[0.15]]
grads:  [0.01534975]
Stock Position:  0.015349754823877685
Bond Position:  [-2.84183535]


portfolio before change:  [-1.30443292]
curr_Stock_Price:  100.16968151668432
curr_Factors:  [100.16968152]
mat_Sqrt:  [[0.15]]
grads:  [0.10303554]
Stock Position:  0.10303553519831746
Bond Position:  [-11.62546967]


portfolio before change:  [-1.28635489]
curr_Stock_Price:  100.35218791357545
curr_Factors:  [100.35218791]
mat_Sqrt:  [[0.15]]
grads:  [0.07844457]
Stock Position:  0.07844457360150718
Bond Position:  [-9.15843948]


portfolio before change:  [-1.25295879]
curr_Stock_Price:  100.78521364609666
curr_Factors:  [100.78521365]
mat_Sqrt:  [[0.15]]
grads:  [0.00508158]
Stock Position:  0.00508158246768606
Bond Position:  [-1.76510717]


portfolio before change:  [-1.25151917]
curr_Stock_Price:  101.09022539224412
curr_Factors:  [101.09022539]
mat_Sqrt:  [[0.15]]
grads:  [0.05085323]
Stock Position:  0.05085323464803233
Bond Position:  [-6.39228412]


portfolio before change:  [-1.26726692]
curr_Stock_Price:  100.78841134601498
curr_Factors:  [100.78841135]
mat_Sqrt:  [[0.15]]
grads:  [-0.00815888]
Stock Position:  -0.008158883404719335
Bond Position:  [-0.44494603]


portfolio before change:  [-1.26855837]
curr_Stock_Price:  100.94328975753568
curr_Factors:  [100.94328976]
mat_Sqrt:  [[0.15]]
grads:  [-0.1347614]
Stock Position:  -0.13476139884259591
Bond Position:  [12.33470056]


portfolio before change:  [-1.25112631]
curr_Stock_Price:  100.81965562058838
curr_Factors:  [100.81965562]
mat_Sqrt:  [[0.15]]
grads:  [0.06838588]
Stock Position:  0.06838588124616937
Bond Position:  [-8.14576731]


portfolio before change:  [-1.24381674]
curr_Stock_Price:  100.93398765605488
curr_Factors:  [100.93398766]
mat_Sqrt:  [[0.15]]
grads:  [-0.04690898]
Stock Position:  -0.046908976214389816
Bond Position:  [3.49089328]


portfolio before change:  [-1.29901566]
curr_Stock_Price:  102.11536287675976
curr_Factors:  [102.11536288]
mat_Sqrt:  [[0.15]]
grads:  [0.14173408]
Stock Position:  0.14173407838365149
Bond Position:  [-15.7722425]


portfolio before change:  [-1.2777135]
curr_Stock_Price:  102.27261475989712
curr_Factors:  [102.27261476]
mat_Sqrt:  [[0.15]]
grads:  [0.06897076]
Stock Position:  0.06897075912647957
Bond Position:  [-8.33153338]


portfolio before change:  [-1.23220027]
curr_Stock_Price:  102.94005663903386
curr_Factors:  [102.94005664]
mat_Sqrt:  [[0.15]]
grads:  [-0.05008246]
Stock Position:  -0.050082456059205055
Bond Position:  [3.9232906]


portfolio before change:  [-1.24504378]
curr_Stock_Price:  103.20140024041851
curr_Factors:  [103.20140024]
mat_Sqrt:  [[0.15]]
grads:  [-0.05338159]
Stock Position:  -0.05338159087902056
Bond Position:  [4.26401114]


portfolio before change:  [-1.25224558]
curr_Stock_Price:  103.34130429630092
curr_Factors:  [103.3413043]
mat_Sqrt:  [[0.15]]
grads:  [0.08803185]
Stock Position:  0.08803185114493922
Bond Position:  [-10.34957189]


portfolio before change:  [-1.27325599]
curr_Stock_Price:  103.10998413530592
curr_Factors:  [103.10998414]
mat_Sqrt:  [[0.15]]
grads:  [0.16841433]
Stock Position:  0.16841432724774638
Bond Position:  [-18.6384546]


portfolio before change:  [-1.08759666]
curr_Stock_Price:  104.21929749640992
curr_Factors:  [104.2192975]
mat_Sqrt:  [[0.15]]
grads:  [-0.10065116]
Stock Position:  -0.10065116026561487
Bond Position:  [9.40219655]


portfolio before change:  [-1.06868107]
curr_Stock_Price:  104.03720380561046
curr_Factors:  [104.03720381]
mat_Sqrt:  [[0.15]]
grads:  [-0.02716656]
Stock Position:  -0.027166560518912773
Bond Position:  [1.75765193]


portfolio before change:  [-1.0608194]
curr_Stock_Price:  103.75186006629443
curr_Factors:  [103.75186007]
mat_Sqrt:  [[0.15]]
grads:  [0.11165332]
Stock Position:  0.11165331589232358
Bond Position:  [-12.64505861]


portfolio before change:  [-1.08553858]
curr_Stock_Price:  103.537546326941
curr_Factors:  [103.53754633]
mat_Sqrt:  [[0.15]]
grads:  [-0.07037659]
Stock Position:  -0.07037658754017798
Bond Position:  [6.20108061]


portfolio before change:  [-0.99603279]
curr_Stock_Price:  102.27124148899846
curr_Factors:  [102.27124149]
mat_Sqrt:  [[0.15]]
grads:  [0.0591026]
Stock Position:  0.05910260332690663
Bond Position:  [-7.04052941]


portfolio before change:  [-0.95846647]
curr_Stock_Price:  102.91429886147775
curr_Factors:  [102.91429886]
mat_Sqrt:  [[0.15]]
grads:  [-0.01208234]
Stock Position:  -0.012082335914467645
Bond Position:  [0.28497866]


portfolio before change:  [-0.95926628]
curr_Stock_Price:  102.98196934882333
curr_Factors:  [102.98196935]
mat_Sqrt:  [[0.15]]
grads:  [0.11857978]
Stock Position:  0.11857977782959654
Bond Position:  [-13.17084532]


portfolio before change:  [-0.94398667]
curr_Stock_Price:  103.11776665216655
curr_Factors:  [103.11776665]
mat_Sqrt:  [[0.15]]
grads:  [0.11626725]
Stock Position:  0.11626724764735522
Bond Position:  [-12.93320558]


portfolio before change:  [-0.85466432]
curr_Stock_Price:  103.89296943166968
curr_Factors:  [103.89296943]
mat_Sqrt:  [[0.15]]
grads:  [0.0535617]
Stock Position:  0.053561700412960815
Bond Position:  [-6.41934843]


portfolio before change:  [-0.8718158]
curr_Stock_Price:  103.58024119097061
curr_Factors:  [103.58024119]
mat_Sqrt:  [[0.15]]
grads:  [-0.00905743]
Stock Position:  -0.00905742696579825
Bond Position:  [0.06635467]


portfolio before change:  [-0.86997738]
curr_Stock_Price:  103.37772515348225
curr_Factors:  [103.37772515]
mat_Sqrt:  [[0.15]]
grads:  [0.04846499]
Stock Position:  0.04846498546045906
Bond Position:  [-5.88017733]


portfolio before change:  [-0.86521322]
curr_Stock_Price:  103.48360946919459
curr_Factors:  [103.48360947]
mat_Sqrt:  [[0.15]]
grads:  [-0.06591452]
Stock Position:  -0.06591451678525402
Bond Position:  [5.95585889]


portfolio before change:  [-0.82370269]
curr_Stock_Price:  102.85949386693967
curr_Factors:  [102.85949387]
mat_Sqrt:  [[0.15]]
grads:  [-0.03804453]
Stock Position:  -0.0380445290114489
Bond Position:  [3.08953831]


portfolio before change:  [-0.79768842]
curr_Stock_Price:  102.18078468253964
curr_Factors:  [102.18078468]
mat_Sqrt:  [[0.15]]
grads:  [0.21517605]
Stock Position:  0.215176053041912
Bond Position:  [-22.78454636]


portfolio before change:  [-0.88489756]
curr_Stock_Price:  101.78211085493282
curr_Factors:  [101.78211085]
mat_Sqrt:  [[0.15]]
grads:  [0.05069724]
Stock Position:  0.050697239252697306
Bond Position:  [-6.04496958]


portfolio before change:  [-0.87303887]
curr_Stock_Price:  102.02347522835097
curr_Factors:  [102.02347523]
mat_Sqrt:  [[0.15]]
grads:  [0.01028519]
Stock Position:  0.01028518592381016
Bond Position:  [-1.92236928]


portfolio before change:  [-0.87608982]
curr_Stock_Price:  101.73852208171574
curr_Factors:  [101.73852208]
mat_Sqrt:  [[0.15]]
grads:  [-0.01341772]
Stock Position:  -0.013417720043066
Bond Position:  [0.48900919]


portfolio before change:  [-0.8728534]
curr_Stock_Price:  101.49959552212421
curr_Factors:  [101.49959552]
mat_Sqrt:  [[0.15]]
grads:  [-0.03162207]
Stock Position:  -0.031622071301079586
Bond Position:  [2.33677404]


portfolio before change:  [-0.8876926]
curr_Stock_Price:  101.97348129157835
curr_Factors:  [101.97348129]
mat_Sqrt:  [[0.15]]
grads:  [-0.0467801]
Stock Position:  -0.04678009890397676
Bond Position:  [3.88263694]


portfolio before change:  [-0.89871382]
curr_Stock_Price:  102.21426503392196
curr_Factors:  [102.21426503]
mat_Sqrt:  [[0.15]]
grads:  [0.02737603]
Stock Position:  0.027376032433151475
Bond Position:  [-3.69693485]


portfolio before change:  [-0.90409198]
curr_Stock_Price:  102.02625023201726
curr_Factors:  [102.02625023]
mat_Sqrt:  [[0.15]]
grads:  [0.00767487]
Stock Position:  0.007674873776033585
Bond Position:  [-1.68713057]


portfolio before change:  [-0.89757666]
curr_Stock_Price:  102.88890576491274
curr_Factors:  [102.88890576]
mat_Sqrt:  [[0.15]]
grads:  [-0.05449096]
Stock Position:  -0.05449096495757348
Bond Position:  [4.7089391]


portfolio before change:  [-0.87929885]
curr_Stock_Price:  102.55887870070731
curr_Factors:  [102.5588787]
mat_Sqrt:  [[0.15]]
grads:  [-0.20661856]
Stock Position:  -0.2066185633712542
Bond Position:  [20.31126933]


portfolio before change:  [-0.89627118]
curr_Stock_Price:  102.64716615717964
curr_Factors:  [102.64716616]
mat_Sqrt:  [[0.15]]
grads:  [-0.01603591]
Stock Position:  -0.01603590799829501
Bond Position:  [0.74976933]


portfolio before change:  [-0.8931632]
curr_Stock_Price:  102.45627470751809
curr_Factors:  [102.45627471]
mat_Sqrt:  [[0.15]]
grads:  [0.07897279]
Stock Position:  0.0789727869061891
Bond Position:  [-8.98442075]


portfolio before change:  [-0.88067961]
curr_Stock_Price:  102.62145988704292
curr_Factors:  [102.62145989]
mat_Sqrt:  [[0.15]]
grads:  [-0.07722686]
Stock Position:  -0.07722686163633845
Bond Position:  [7.04445367]


portfolio before change:  [-0.86628673]
curr_Stock_Price:  102.44078972917465
curr_Factors:  [102.44078973]
mat_Sqrt:  [[0.15]]
grads:  [-0.00119771]
Stock Position:  -0.0011977085820551472
Bond Position:  [-0.74359252]


portfolio before change:  [-0.86590809]
curr_Stock_Price:  102.08585318990677
curr_Factors:  [102.08585319]
mat_Sqrt:  [[0.15]]
grads:  [0.01490891]
Stock Position:  0.014908908102968736
Bond Position:  [-2.3878967]


portfolio before change:  [-0.87221919]
curr_Stock_Price:  101.67255365168437
curr_Factors:  [101.67255365]
mat_Sqrt:  [[0.15]]
grads:  [-0.09122151]
Stock Position:  -0.09122151013316834
Bond Position:  [8.4025047]


portfolio before change:  [-0.93031149]
curr_Stock_Price:  102.31513760264816
curr_Factors:  [102.3151376]
mat_Sqrt:  [[0.15]]
grads:  [-0.00343259]
Stock Position:  -0.003432594046133385
Bond Position:  [-0.57910516]


portfolio before change:  [-0.93031288]
curr_Stock_Price:  102.30499670098891
curr_Factors:  [102.3049967]
mat_Sqrt:  [[0.15]]
grads:  [0.01932061]
Stock Position:  0.019320610275518086
Bond Position:  [-2.90690785]


portfolio before change:  [-0.92776755]
curr_Stock_Price:  102.44614198445628
curr_Factors:  [102.44614198]
mat_Sqrt:  [[0.15]]
grads:  [-0.03110244]
Stock Position:  -0.031102443842437398
Bond Position:  [2.25855783]


portfolio before change:  [-0.90590196]
curr_Stock_Price:  101.74766226261167
curr_Factors:  [101.74766226]
mat_Sqrt:  [[0.15]]
grads:  [-0.02069837]
Stock Position:  -0.020698372425047417
Bond Position:  [1.20010904]


portfolio before change:  [-0.92160492]
curr_Stock_Price:  102.50994287195807
curr_Factors:  [102.50994287]
mat_Sqrt:  [[0.15]]
grads:  [0.02374702]
Stock Position:  0.02374701662050486
Bond Position:  [-3.35591024]


portfolio before change:  [-0.94166014]
curr_Stock_Price:  101.67423913300237
curr_Factors:  [101.67423913]
mat_Sqrt:  [[0.15]]
grads:  [0.00131858]
Stock Position:  0.0013185817778105901
Bond Position:  [-1.07572594]


portfolio before change:  [-0.94157963]
curr_Stock_Price:  101.78628877861306
curr_Factors:  [101.78628878]
mat_Sqrt:  [[0.15]]
grads:  [0.01306819]
Stock Position:  0.013068191029463314
Bond Position:  [-2.2717423]


portfolio before change:  [-0.94480848]
curr_Stock_Price:  101.55007691471056
curr_Factors:  [101.55007691]
mat_Sqrt:  [[0.15]]
grads:  [0.00861852]
Stock Position:  0.008618524107647716
Bond Position:  [-1.82002027]


portfolio before change:  [-0.94304574]
curr_Stock_Price:  101.76780504580468
curr_Factors:  [101.76780505]
mat_Sqrt:  [[0.15]]
grads:  [0.05676888]
Stock Position:  0.056768879644642216
Bond Position:  [-6.72029002]


portfolio before change:  [-0.95063929]
curr_Stock_Price:  101.64144147262547
curr_Factors:  [101.64144147]
mat_Sqrt:  [[0.15]]
grads:  [-0.0573222]
Stock Position:  -0.057322202954894375
Bond Position:  [4.87567205]


portfolio before change:  [-0.97318347]
curr_Stock_Price:  102.04004643792338
curr_Factors:  [102.04004644]
mat_Sqrt:  [[0.15]]
grads:  [-0.09519737]
Stock Position:  -0.0951973653806728
Bond Position:  [8.74076012]


portfolio before change:  [-0.92959301]
curr_Stock_Price:  101.58788961812235
curr_Factors:  [101.58788962]
mat_Sqrt:  [[0.15]]
grads:  [0.08929635]
Stock Position:  0.08929634878469662
Bond Position:  [-10.00102064]


portfolio before change:  [-0.96235147]
curr_Stock_Price:  101.2280386622787
curr_Factors:  [101.22803866]
mat_Sqrt:  [[0.15]]
grads:  [0.04061008]
Stock Position:  0.04061007531390207
Bond Position:  [-5.07322975]


portfolio before change:  [-0.94551438]
curr_Stock_Price:  101.65045050108115
curr_Factors:  [101.6504505]
mat_Sqrt:  [[0.15]]
grads:  [0.06696487]
Stock Position:  0.06696487044771464
Bond Position:  [-7.75252363]


portfolio before change:  [-0.9712899]
curr_Stock_Price:  101.27277533656937
curr_Factors:  [101.27277534]
mat_Sqrt:  [[0.15]]
grads:  [-0.0884787]
Stock Position:  -0.08847870062158089
Bond Position:  [7.98919367]


portfolio before change:  [-0.96420387]
curr_Stock_Price:  101.1983315681228
curr_Factors:  [101.19833157]
mat_Sqrt:  [[0.15]]
grads:  [-0.08388025]
Stock Position:  -0.08388024624014209
Bond Position:  [7.5243371]


portfolio before change:  [-0.91549599]
curr_Stock_Price:  100.62325459595262
curr_Factors:  [100.6232546]
mat_Sqrt:  [[0.15]]
grads:  [-0.01501931]
Stock Position:  -0.015019310784191301
Bond Position:  [0.59579594]


portfolio before change:  [-0.90272568]
curr_Stock_Price:  99.77547447272026
curr_Factors:  [99.77547447]
mat_Sqrt:  [[0.15]]
grads:  [-0.08992548]
Stock Position:  -0.08992547885696772
Bond Position:  [8.06963164]


portfolio before change:  [-0.89273346]
curr_Stock_Price:  99.6699665359259
curr_Factors:  [99.66996654]
mat_Sqrt:  [[0.15]]
grads:  [0.21610694]
Stock Position:  0.21610694348731418
Bond Position:  [-22.43210528]


portfolio before change:  [-0.99007586]
curr_Stock_Price:  99.22601805845314
curr_Factors:  [99.22601806]
mat_Sqrt:  [[0.15]]
grads:  [0.08803702]
Stock Position:  0.08803701578469945
Bond Position:  [-9.72563837]


portfolio before change:  [-0.96824295]
curr_Stock_Price:  99.48091969156826
curr_Factors:  [99.48091969]
mat_Sqrt:  [[0.15]]
grads:  [0.01396047]
Stock Position:  0.013960471258122765
Bond Position:  [-2.35704347]


portfolio before change:  [-0.96377827]
curr_Stock_Price:  99.81128059393053
curr_Factors:  [99.81128059]
mat_Sqrt:  [[0.15]]
grads:  [0.04323555]
Stock Position:  0.04323554983890007
Bond Position:  [-5.27917387]


portfolio before change:  [-0.98212396]
curr_Stock_Price:  99.39459282644292
curr_Factors:  [99.39459283]
mat_Sqrt:  [[0.15]]
grads:  [-0.0985806]
Stock Position:  -0.09858060040106252
Bond Position:  [8.81625468]


portfolio before change:  [-0.93697462]
curr_Stock_Price:  98.94218833009116
curr_Factors:  [98.94218833]
mat_Sqrt:  [[0.15]]
grads:  [-0.03074713]
Stock Position:  -0.030747134631678733
Bond Position:  [2.10521417]


portfolio before change:  [-0.91185401]
curr_Stock_Price:  98.12946136633353
curr_Factors:  [98.12946137]
mat_Sqrt:  [[0.15]]
grads:  [0.01334214]
Stock Position:  0.013342144381614778
Bond Position:  [-2.22111145]


portfolio before change:  [-0.91812234]
curr_Stock_Price:  97.67005216489902
curr_Factors:  [97.67005216]
mat_Sqrt:  [[0.15]]
grads:  [-0.00026645]
Stock Position:  -0.0002664490934145645
Bond Position:  [-0.89209824]


portfolio before change:  [-0.91818192]
curr_Stock_Price:  97.68438985228886
curr_Factors:  [97.68438985]
mat_Sqrt:  [[0.15]]
grads:  [0.05533624]
Stock Position:  0.05533624132188523
Bond Position:  [-6.32366889]


portfolio before change:  [-0.90427114]
curr_Stock_Price:  97.94291887735557
curr_Factors:  [97.94291888]
mat_Sqrt:  [[0.15]]
grads:  [0.01896909]
Stock Position:  0.01896909492876712
Bond Position:  [-2.76215966]


portfolio before change:  [-0.91682429]
curr_Stock_Price:  97.29025137596452
curr_Factors:  [97.29025138]
mat_Sqrt:  [[0.15]]
grads:  [0.01615764]
Stock Position:  0.016157636244704742
Bond Position:  [-2.48880478]


portfolio before change:  [-0.92338695]
curr_Stock_Price:  96.89371394502324
curr_Factors:  [96.89371395]
mat_Sqrt:  [[0.15]]
grads:  [0.02895269]
Stock Position:  0.02895268849810179
Bond Position:  [-3.72872047]


portfolio before change:  [-0.90976998]
curr_Stock_Price:  97.37208138565057
curr_Factors:  [97.37208139]
mat_Sqrt:  [[0.15]]
grads:  [-0.0721004]
Stock Position:  -0.07210039508061482
Bond Position:  [6.11079556]


portfolio before change:  [-0.86232412]
curr_Stock_Price:  96.71932597218918
curr_Factors:  [96.71932597]
mat_Sqrt:  [[0.15]]
grads:  [-0.21028951]
Stock Position:  -0.21028951058915277
Bond Position:  [19.4767356]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.86232412]
Stock Price:  96.84176589016766
PL:  [-0.86232412]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-7.48048232e-02]
 [ 2.14852879e-04]
 [ 3.12441610e-04]
 [ 2.77968797e-03]
 [ 5.59320125e-03]
 [ 1.19408134e-02]
 [ 4.19343346e-04]
 [ 9.17608879e-03]
 [-5.19348616e-03]
 [-2.01122996e-02]
 [ 1.02147066e-02]
 [-4.84763989e-03]
 [-5.28413453e-03]
 [ 5.51410871e-03]
 [-2.20798479e-02]
 [ 1.51702111e-02]
 [-3.29561447e-03]
 [ 1.81309438e-03]
 [ 4.97486605e-03]
 [ 1.44217157e-02]
 [ 9.56643420e-03]
 [-2.20277499e-02]
 [-5.74013954e-04]
 [ 1.37487532e-02]
 [ 1.30283295e-02]
 [-5.93998405e-03]
 [ 1.28552321e-02]
 [ 1.32642965e-03]
 [ 3.39209704e-03]
 [-2.77825738e-02]
 [-5.62784942e-03]
 [ 3.25859715e-02]
 [ 6.41831088e-03]
 [-4.78691524e-03]
 [-6.86247501e-03]
 [-4.65759650e-03]
 [-4.73107516e-03]
 [ 2.53867376e-03]
 [ 3.46088380e-03]
 [-8.43625702e-03]
 [-2.93326599e-02]
 [-2.71201191e-03]
 [ 1.20089998e-02]
 [-1.15841413e-02]
 [-1.13395075e-03]
 [ 2.52910095e-03]
 [-1.35805218e-02]
 [ 1.28602501e-02]
 [ 2.33878123e-02]
 [-1.22227710e-02]
 [-4.05938070e-03]
 [ 3.55616030e-03]
 [ 3.25070282e-03]
 [-3.47277687e-03]
 [-1.19542932e-02]
 [ 1.28808240e-02]
 [-3.67571909e-02]
 [-1.11123892e-02]
 [ 2.07760355e-02]
 [-7.88332192e-03]
 [ 1.31835078e-02]
 [-1.41021145e-02]
 [-1.26990041e-02]
 [-2.88802922e-03]
 [ 9.09583849e-02]
 [-1.44661751e-02]
 [ 8.63495617e-03]
 [ 5.33808164e-03]
 [ 1.24598048e-02]
 [-2.46828332e-02]
 [-7.98861123e-03]
 [-6.68760704e-03]
 [ 8.35912497e-03]
 [ 6.48789921e-03]
 [-7.49693181e-04]
 [-1.28751692e-03]
 [ 8.83000210e-03]
 [-3.87553098e-03]
 [ 2.38608307e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.98245577]
curr_Stock_Price:  100.76584971570928
curr_Factors:  [100.76584972]
mat_Sqrt:  [[0.15]]
grads:  [-0.49869882]
Stock Position:  -0.4986988210623955
Bond Position:  [64.23426623]


portfolio before change:  [13.94710661]
curr_Stock_Price:  100.84478299237055
curr_Factors:  [100.84478299]
mat_Sqrt:  [[0.15]]
grads:  [0.00143235]
Stock Position:  0.0014323525235857035
Bond Position:  [13.80266133]


portfolio before change:  [13.94757794]
curr_Stock_Price:  100.57155637582072
curr_Factors:  [100.57155638]
mat_Sqrt:  [[0.15]]
grads:  [0.00208294]
Stock Position:  0.0020829440641145607
Bond Position:  [13.73809302]


portfolio before change:  [13.94979948]
curr_Stock_Price:  101.22585843165194
curr_Factors:  [101.22585843]
mat_Sqrt:  [[0.15]]
grads:  [0.01853125]
Stock Position:  0.018531253117063617
Bond Position:  [12.07395747]


portfolio before change:  [13.94801295]
curr_Stock_Price:  101.08872940764014
curr_Factors:  [101.08872941]
mat_Sqrt:  [[0.15]]
grads:  [0.03728801]
Stock Position:  0.0372880083191509
Bond Position:  [10.17861557]


portfolio before change:  [13.94436882]
curr_Stock_Price:  100.97393883351015
curr_Factors:  [100.97393883]
mat_Sqrt:  [[0.15]]
grads:  [0.07960542]
Stock Position:  0.0796054228844901
Bond Position:  [5.90629572]


portfolio before change:  [13.95146266]
curr_Stock_Price:  101.05841399354992
curr_Factors:  [101.05841399]
mat_Sqrt:  [[0.15]]
grads:  [0.00279562]
Stock Position:  0.0027956223072466485
Bond Position:  [13.6689415]


portfolio before change:  [13.95150423]
curr_Stock_Price:  100.76768909730455
curr_Factors:  [100.7676891]
mat_Sqrt:  [[0.15]]
grads:  [0.06117393]
Stock Position:  0.06117392529204115
Bond Position:  [7.78714915]


portfolio before change:  [13.98242037]
curr_Stock_Price:  101.26511390478919
curr_Factors:  [101.2651139]
mat_Sqrt:  [[0.15]]
grads:  [-0.03462324]
Stock Position:  -0.03462324109186832
Bond Position:  [17.48854683]


portfolio before change:  [14.01506961]
curr_Stock_Price:  100.35369802050222
curr_Factors:  [100.35369802]
mat_Sqrt:  [[0.15]]
grads:  [-0.134082]
Stock Position:  -0.13408199704243737
Bond Position:  [27.47069386]


portfolio before change:  [14.00189303]
curr_Stock_Price:  100.46477596337988
curr_Factors:  [100.46477596]
mat_Sqrt:  [[0.15]]
grads:  [0.06809804]
Stock Position:  0.06809804411603061
Bond Position:  [7.16043829]


portfolio before change:  [13.96964399]
curr_Stock_Price:  99.98463611473372
curr_Factors:  [99.98463611]
mat_Sqrt:  [[0.15]]
grads:  [-0.0323176]
Stock Position:  -0.0323175992825757
Bond Position:  [17.2009074]


portfolio before change:  [14.00157475]
curr_Stock_Price:  99.02987252080678
curr_Factors:  [99.02987252]
mat_Sqrt:  [[0.15]]
grads:  [-0.03522756]
Stock Position:  -0.035227563555595205
Bond Position:  [17.49015588]


portfolio before change:  [14.04767746]
curr_Stock_Price:  97.75219270293543
curr_Factors:  [97.7521927]
mat_Sqrt:  [[0.15]]
grads:  [0.03676072]
Stock Position:  0.03676072473779561
Bond Position:  [10.45423602]


portfolio before change:  [14.04432798]
curr_Stock_Price:  97.64330228713415
curr_Factors:  [97.64330229]
mat_Sqrt:  [[0.15]]
grads:  [-0.14719899]
Stock Position:  -0.14719898577804283
Bond Position:  [28.41732305]


portfolio before change:  [13.97791819]
curr_Stock_Price:  98.10652515607848
curr_Factors:  [98.10652516]
mat_Sqrt:  [[0.15]]
grads:  [0.10113474]
Stock Position:  0.10113474038410268
Bond Position:  [4.05594023]


portfolio before change:  [13.93734983]
curr_Stock_Price:  97.70288677496733
curr_Factors:  [97.70288677]
mat_Sqrt:  [[0.15]]
grads:  [-0.02197076]
Stock Position:  -0.021970763115864596
Bond Position:  [16.08395681]


portfolio before change:  [13.92866918]
curr_Stock_Price:  98.14374222655387
curr_Factors:  [98.14374223]
mat_Sqrt:  [[0.15]]
grads:  [0.0120873]
Stock Position:  0.012087295863309559
Bond Position:  [12.74237673]


portfolio before change:  [13.92763871]
curr_Stock_Price:  97.99260086000352
curr_Factors:  [97.99260086]
mat_Sqrt:  [[0.15]]
grads:  [0.03316577]
Stock Position:  0.033165773645345245
Bond Position:  [10.67763829]


portfolio before change:  [13.91044165]
curr_Stock_Price:  97.45396032097459
curr_Factors:  [97.45396032]
mat_Sqrt:  [[0.15]]
grads:  [0.09614477]
Stock Position:  0.09614477147126324
Bond Position:  [4.54075291]


portfolio before change:  [13.97525856]
curr_Stock_Price:  98.12516796124419
curr_Factors:  [98.12516796]
mat_Sqrt:  [[0.15]]
grads:  [0.06377623]
Stock Position:  0.06377622800991939
Bond Position:  [7.71720548]


portfolio before change:  [13.96579906]
curr_Stock_Price:  97.96928165588226
curr_Factors:  [97.96928166]
mat_Sqrt:  [[0.15]]
grads:  [-0.14685167]
Stock Position:  -0.1468516657281247
Bond Position:  [28.35275126]


portfolio before change:  [13.96991777]
curr_Stock_Price:  97.95330222539988
curr_Factors:  [97.95330223]
mat_Sqrt:  [[0.15]]
grads:  [-0.00382676]
Stock Position:  -0.0038267596939318624
Bond Position:  [14.34476152]


portfolio before change:  [13.96516223]
curr_Stock_Price:  99.4303008038479
curr_Factors:  [99.4303008]
mat_Sqrt:  [[0.15]]
grads:  [0.09165835]
Stock Position:  0.09165835488055801
Bond Position:  [4.85154443]


portfolio before change:  [14.01840315]
curr_Stock_Price:  100.00785524337269
curr_Factors:  [100.00785524]
mat_Sqrt:  [[0.15]]
grads:  [0.08685553]
Stock Position:  0.08685552994470505
Bond Position:  [5.33216788]


portfolio before change:  [14.06637342]
curr_Stock_Price:  100.55631769951785
curr_Factors:  [100.5563177]
mat_Sqrt:  [[0.15]]
grads:  [-0.03959989]
Stock Position:  -0.03959989365431199
Bond Position:  [18.0483929]


portfolio before change:  [14.0602656]
curr_Stock_Price:  100.73904230194334
curr_Factors:  [100.7390423]
mat_Sqrt:  [[0.15]]
grads:  [0.08570155]
Stock Position:  0.08570154703388774
Bond Position:  [5.42677383]


portfolio before change:  [14.02204214]
curr_Stock_Price:  100.28907786185881
curr_Factors:  [100.28907786]
mat_Sqrt:  [[0.15]]
grads:  [0.00884286]
Stock Position:  0.00884286435902902
Bond Position:  [13.13519942]


portfolio before change:  [14.02524792]
curr_Stock_Price:  100.5587651234099
curr_Factors:  [100.55876512]
mat_Sqrt:  [[0.15]]
grads:  [0.02261398]
Stock Position:  0.022613980249514953
Bond Position:  [11.75121399]


portfolio before change:  [14.03605417]
curr_Stock_Price:  101.00414345072417
curr_Factors:  [101.00414345]
mat_Sqrt:  [[0.15]]
grads:  [-0.18521716]
Stock Position:  -0.18521715881129347
Bond Position:  [32.74375465]


portfolio before change:  [13.85727189]
curr_Stock_Price:  101.98045055131946
curr_Factors:  [101.98045055]
mat_Sqrt:  [[0.15]]
grads:  [-0.037519]
Stock Position:  -0.03751899613115784
Bond Position:  [17.68347602]


portfolio before change:  [13.84919552]
curr_Stock_Price:  102.22516987536638
curr_Factors:  [102.22516988]
mat_Sqrt:  [[0.15]]
grads:  [0.21723981]
Stock Position:  0.2172398100736744
Bond Position:  [-8.35818097]


portfolio before change:  [13.96666205]
curr_Stock_Price:  102.7682974693459
curr_Factors:  [102.76829747]
mat_Sqrt:  [[0.15]]
grads:  [0.04278874]
Stock Position:  0.04278873917760765
Bond Position:  [9.56933618]


portfolio before change:  [13.98138295]
curr_Stock_Price:  103.09835603705612
curr_Factors:  [103.09835604]
mat_Sqrt:  [[0.15]]
grads:  [-0.03191277]
Stock Position:  -0.03191276823523528
Bond Position:  [17.27153689]


portfolio before change:  [13.96834056]
curr_Stock_Price:  103.54087135987936
curr_Factors:  [103.54087136]
mat_Sqrt:  [[0.15]]
grads:  [-0.04574983]
Stock Position:  -0.04574983340620667
Bond Position:  [18.70531818]


portfolio before change:  [13.94946061]
curr_Stock_Price:  103.97910410146471
curr_Factors:  [103.9791041]
mat_Sqrt:  [[0.15]]
grads:  [-0.03105064]
Stock Position:  -0.031050643323244823
Bond Position:  [17.17807868]


portfolio before change:  [13.96357939]
curr_Stock_Price:  103.5589800155127
curr_Factors:  [103.55898002]
mat_Sqrt:  [[0.15]]
grads:  [-0.0315405]
Stock Position:  -0.031540501091077804
Bond Position:  [17.22988151]


portfolio before change:  [13.96427294]
curr_Stock_Price:  103.57113443097653
curr_Factors:  [103.57113443]
mat_Sqrt:  [[0.15]]
grads:  [0.01692449]
Stock Position:  0.01692449175254144
Bond Position:  [12.21138413]


portfolio before change:  [13.96346895]
curr_Stock_Price:  103.47853372901808
curr_Factors:  [103.47853373]
mat_Sqrt:  [[0.15]]
grads:  [0.02307256]
Stock Position:  0.023072558659927706
Bond Position:  [11.57595441]


portfolio before change:  [13.94265458]
curr_Stock_Price:  102.54504859275775
curr_Factors:  [102.54504859]
mat_Sqrt:  [[0.15]]
grads:  [-0.05624171]
Stock Position:  -0.05624171347978886
Bond Position:  [19.70996382]


portfolio before change:  [13.9517151]
curr_Stock_Price:  102.40585292626044
curr_Factors:  [102.40585293]
mat_Sqrt:  [[0.15]]
grads:  [-0.19555107]
Stock Position:  -0.19555106569138764
Bond Position:  [33.97728877]


portfolio before change:  [13.84052517]
curr_Stock_Price:  102.98531065252142
curr_Factors:  [102.98531065]
mat_Sqrt:  [[0.15]]
grads:  [-0.01808008]
Stock Position:  -0.01808007938065206
Bond Position:  [15.70250776]


portfolio before change:  [13.84962798]
curr_Stock_Price:  102.53612142472869
curr_Factors:  [102.53612142]
mat_Sqrt:  [[0.15]]
grads:  [0.08006]
Stock Position:  0.08005999836079587
Bond Position:  [5.64058627]


portfolio before change:  [13.85188153]
curr_Stock_Price:  102.55986607486575
curr_Factors:  [102.55986607]
mat_Sqrt:  [[0.15]]
grads:  [-0.07722761]
Stock Position:  -0.07722760851185535
Bond Position:  [21.77233471]


portfolio before change:  [13.80008012]
curr_Stock_Price:  103.24824971698439
curr_Factors:  [103.24824972]
mat_Sqrt:  [[0.15]]
grads:  [-0.00755967]
Stock Position:  -0.00755967168513222
Bond Position:  [14.58060299]


portfolio before change:  [13.7975207]
curr_Stock_Price:  103.70736163942291
curr_Factors:  [103.70736164]
mat_Sqrt:  [[0.15]]
grads:  [0.01686067]
Stock Position:  0.01686067300469836
Bond Position:  [12.04894478]


portfolio before change:  [13.81744812]
curr_Stock_Price:  104.84458463920876
curr_Factors:  [104.84458464]
mat_Sqrt:  [[0.15]]
grads:  [-0.09053681]
Stock Position:  -0.09053681203388303
Bond Position:  [23.30974258]


portfolio before change:  [13.83262573]
curr_Stock_Price:  104.69303634203399
curr_Factors:  [104.69303634]
mat_Sqrt:  [[0.15]]
grads:  [0.085735]
Stock Position:  0.08573500098903855
Bond Position:  [4.85676815]


portfolio before change:  [13.86825051]
curr_Stock_Price:  105.10501777360146
curr_Factors:  [105.10501777]
mat_Sqrt:  [[0.15]]
grads:  [0.15591875]
Stock Position:  0.1559187486337628
Bond Position:  [-2.51959233]


portfolio before change:  [13.86210427]
curr_Stock_Price:  105.06660823937342
curr_Factors:  [105.06660824]
mat_Sqrt:  [[0.15]]
grads:  [-0.08148514]
Stock Position:  -0.08148513995979072
Bond Position:  [22.42347155]


portfolio before change:  [13.91480263]
curr_Stock_Price:  104.4370842052406
curr_Factors:  [104.43708421]
mat_Sqrt:  [[0.15]]
grads:  [-0.02706254]
Stock Position:  -0.027062538004303777
Bond Position:  [16.74113519]


portfolio before change:  [13.89613371]
curr_Stock_Price:  105.16559214022375
curr_Factors:  [105.16559214]
mat_Sqrt:  [[0.15]]
grads:  [0.02370774]
Stock Position:  0.023707735342681047
Bond Position:  [11.40289569]


portfolio before change:  [13.90218799]
curr_Stock_Price:  105.39090150429112
curr_Factors:  [105.3909015]
mat_Sqrt:  [[0.15]]
grads:  [0.02167135]
Stock Position:  0.021671352129460055
Bond Position:  [11.61822465]


portfolio before change:  [13.90440931]
curr_Stock_Price:  105.45989368299331
curr_Factors:  [105.45989368]
mat_Sqrt:  [[0.15]]
grads:  [-0.02315185]
Stock Position:  -0.023151845795997893
Bond Position:  [16.3460005]


portfolio before change:  [13.88033591]
curr_Stock_Price:  106.54382677568408
curr_Factors:  [106.54382678]
mat_Sqrt:  [[0.15]]
grads:  [-0.07969529]
Stock Position:  -0.0796952877072996
Bond Position:  [22.37137684]


portfolio before change:  [13.86063691]
curr_Stock_Price:  106.80855079478194
curr_Factors:  [106.80855079]
mat_Sqrt:  [[0.15]]
grads:  [0.08587216]
Stock Position:  0.08587216014580157
Bond Position:  [4.68875593]


portfolio before change:  [13.89541016]
curr_Stock_Price:  107.21008011643512
curr_Factors:  [107.21008012]
mat_Sqrt:  [[0.15]]
grads:  [-0.24504794]
Stock Position:  -0.24504793924022755
Bond Position:  [40.16701935]


portfolio before change:  [13.88459841]
curr_Stock_Price:  107.26444605152903
curr_Factors:  [107.26444605]
mat_Sqrt:  [[0.15]]
grads:  [-0.07408259]
Stock Position:  -0.07408259478866043
Bond Position:  [21.83102691]


portfolio before change:  [13.92433588]
curr_Stock_Price:  106.74647035158428
curr_Factors:  [106.74647035]
mat_Sqrt:  [[0.15]]
grads:  [0.1385069]
Stock Position:  0.13850690335119986
Bond Position:  [-0.86078717]


portfolio before change:  [13.87259262]
curr_Stock_Price:  106.37327988386609
curr_Factors:  [106.37327988]
mat_Sqrt:  [[0.15]]
grads:  [-0.05255548]
Stock Position:  -0.052555479490467134
Bond Position:  [19.46309135]


portfolio before change:  [13.86478432]
curr_Stock_Price:  106.54499900985971
curr_Factors:  [106.54499901]
mat_Sqrt:  [[0.15]]
grads:  [0.08789005]
Stock Position:  0.08789005220166513
Bond Position:  [4.5005388]


portfolio before change:  [13.8015128]
curr_Stock_Price:  105.82190451415786
curr_Factors:  [105.82190451]
mat_Sqrt:  [[0.15]]
grads:  [-0.0940141]
Stock Position:  -0.09401409669539441
Bond Position:  [23.75026357]


portfolio before change:  [13.7494837]
curr_Stock_Price:  106.39111211016585
curr_Factors:  [106.39111211]
mat_Sqrt:  [[0.15]]
grads:  [-0.08466003]
Stock Position:  -0.08466002709660882
Bond Position:  [22.75655814]


portfolio before change:  [13.7775358]
curr_Stock_Price:  106.07656263274914
curr_Factors:  [106.07656263]
mat_Sqrt:  [[0.15]]
grads:  [-0.01925353]
Stock Position:  -0.019253528136352154
Bond Position:  [15.81988388]


portfolio before change:  [13.77240875]
curr_Stock_Price:  106.39420963772127
curr_Factors:  [106.39420964]
mat_Sqrt:  [[0.15]]
grads:  [0.60638923]
Stock Position:  0.6063892326589797
Bond Position:  [-50.7438944]


portfolio before change:  [13.80006038]
curr_Stock_Price:  106.44504039539034
curr_Factors:  [106.4450404]
mat_Sqrt:  [[0.15]]
grads:  [-0.09644117]
Stock Position:  -0.09644116734087363
Bond Position:  [24.06574433]


portfolio before change:  [13.82032645]
curr_Stock_Price:  106.25049780399084
curr_Factors:  [106.2504978]
mat_Sqrt:  [[0.15]]
grads:  [0.05756637]
Stock Position:  0.05756637448973705
Bond Position:  [7.7038705]


portfolio before change:  [13.80394907]
curr_Stock_Price:  105.95763784738622
curr_Factors:  [105.95763785]
mat_Sqrt:  [[0.15]]
grads:  [0.03558721]
Stock Position:  0.03558721090620909
Bond Position:  [10.03321226]


portfolio before change:  [13.78656199]
curr_Stock_Price:  105.45143990813978
curr_Factors:  [105.45143991]
mat_Sqrt:  [[0.15]]
grads:  [0.08306537]
Stock Position:  0.08306536529357303
Bond Position:  [5.02719962]


portfolio before change:  [13.78266242]
curr_Stock_Price:  105.40071140749995
curr_Factors:  [105.40071141]
mat_Sqrt:  [[0.15]]
grads:  [-0.16455222]
Stock Position:  -0.16455222113943038
Bond Position:  [31.12658359]


portfolio before change:  [13.86878206]
curr_Stock_Price:  104.8891767203923
curr_Factors:  [104.88917672]
mat_Sqrt:  [[0.15]]
grads:  [-0.05325741]
Stock Position:  -0.05325740820987828
Bond Position:  [19.45490776]


portfolio before change:  [13.88051437]
curr_Stock_Price:  104.69171424706987
curr_Factors:  [104.69171425]
mat_Sqrt:  [[0.15]]
grads:  [-0.04458405]
Stock Position:  -0.044584046913731155
Bond Position:  [18.54809467]


portfolio before change:  [13.8624872]
curr_Stock_Price:  105.12205788008148
curr_Factors:  [105.12205788]
mat_Sqrt:  [[0.15]]
grads:  [0.0557275]
Stock Position:  0.05572749978410424
Bond Position:  [8.00429774]


portfolio before change:  [13.85158721]
curr_Stock_Price:  104.91748602141385
curr_Factors:  [104.91748602]
mat_Sqrt:  [[0.15]]
grads:  [0.04325266]
Stock Position:  0.04325266141897118
Bond Position:  [9.31362671]


portfolio before change:  [13.87110129]
curr_Stock_Price:  105.35519229334267
curr_Factors:  [105.35519229]
mat_Sqrt:  [[0.15]]
grads:  [-0.00499795]
Stock Position:  -0.004997954536951581
Bond Position:  [14.39766175]


portfolio before change:  [13.87211085]
curr_Stock_Price:  105.33324739422648
curr_Factors:  [105.33324739]
mat_Sqrt:  [[0.15]]
grads:  [-0.00858345]
Stock Position:  -0.008583446132642964
Bond Position:  [14.77623311]


portfolio before change:  [13.88290635]
curr_Stock_Price:  104.1831321234511
curr_Factors:  [104.18313212]
mat_Sqrt:  [[0.15]]
grads:  [0.05886668]
Stock Position:  0.058866680689257635
Bond Position:  [7.74999118]


portfolio before change:  [13.87092223]
curr_Stock_Price:  103.97132287432821
curr_Factors:  [103.97132287]
mat_Sqrt:  [[0.15]]
grads:  [-0.02583687]
Stock Position:  -0.025836873229916128
Bond Position:  [16.55721612]


portfolio before change:  [13.85262056]
curr_Stock_Price:  104.71973088261214
curr_Factors:  [104.71973088]
mat_Sqrt:  [[0.15]]
grads:  [0.1590722]
Stock Position:  0.15907220475032482
Bond Position:  [-2.80537791]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.85262056]
Stock Price:  105.07901346313852
PL:  [8.7736071]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.68778180e-02]
 [ 8.88846063e-04]
 [ 4.87255543e-04]
 [ 2.13574775e-03]
 [ 1.20178975e-02]
 [ 1.19459764e-02]
 [ 7.16290759e-05]
 [ 6.27724256e-03]
 [-3.86793699e-03]
 [-1.98397353e-02]
 [ 9.91183614e-03]
 [-1.21374753e-02]
 [ 3.22256867e-02]
 [ 1.45005411e-02]
 [-6.19203281e-03]
 [-8.72577568e-03]
 [ 1.01294799e-02]
 [ 2.66289770e-02]
 [ 7.35862316e-03]
 [-3.20239527e-04]
 [ 5.81035314e-02]
 [-1.30811850e-02]
 [ 2.85406275e-03]
 [ 1.52049560e-03]
 [ 1.63182240e-02]
 [ 7.75375431e-03]
 [ 1.13286689e-02]
 [ 3.16221657e-03]
 [ 4.64467821e-03]
 [-1.86820532e-02]
 [-5.58726877e-03]
 [ 3.42003488e-02]
 [ 6.93055633e-03]
 [-1.45201682e-03]
 [-6.21590749e-03]
 [-4.14697019e-03]
 [-5.21090362e-03]
 [ 1.32037698e-03]
 [ 4.57787758e-03]
 [-7.54880127e-03]
 [-4.69605162e-02]
 [-4.09037259e-03]
 [ 1.77956804e-02]
 [-1.53895418e-02]
 [-3.42419421e-03]
 [ 2.58758836e-03]
 [-1.35927784e-02]
 [ 8.21224282e-03]
 [ 2.22300624e-02]
 [-1.15207572e-02]
 [-4.15502234e-03]
 [ 3.51506383e-03]
 [ 2.86858683e-03]
 [ 1.87535155e-04]
 [-6.71816423e-03]
 [ 1.06546126e-02]
 [-1.53079079e-02]
 [-8.35766680e-03]
 [ 1.59281643e-02]
 [ 8.29976292e-04]
 [ 1.18254916e-02]
 [-1.52238675e-02]
 [-1.27397470e-02]
 [-3.22908770e-03]
 [ 1.13264438e-02]
 [-1.73713751e-02]
 [ 2.27486172e-02]
 [ 3.88318928e-03]
 [ 1.04736876e-02]
 [-2.31731052e-02]
 [-7.90700717e-03]
 [-7.60743157e-03]
 [ 1.62995717e-03]
 [ 7.32758302e-03]
 [-7.50067657e-04]
 [-1.28512522e-02]
 [ 5.06302402e-03]
 [-4.36062734e-03]
 [ 2.45362299e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.17509515]
curr_Stock_Price:  99.59885194114095
curr_Factors:  [99.59885194]
mat_Sqrt:  [[0.15]]
grads:  [-0.24585212]
Stock Position:  -0.24585212009878168
Bond Position:  [20.31149376]


portfolio before change:  [-4.17471564]
curr_Stock_Price:  99.60247199006454
curr_Factors:  [99.60247199]
mat_Sqrt:  [[0.15]]
grads:  [0.00592564]
Stock Position:  0.005925640418079362
Bond Position:  [-4.76492407]


portfolio before change:  [-4.1738237]
curr_Stock_Price:  99.80325359365737
curr_Factors:  [99.80325359]
mat_Sqrt:  [[0.15]]
grads:  [0.00324837]
Stock Position:  0.003248370283338558
Bond Position:  [-4.49802162]


portfolio before change:  [-4.17260138]
curr_Stock_Price:  100.2660877206149
curr_Factors:  [100.26608772]
mat_Sqrt:  [[0.15]]
grads:  [0.01423832]
Stock Position:  0.014238318301394782
Bond Position:  [-5.60022185]


portfolio before change:  [-4.17218095]
curr_Stock_Price:  100.32019868370789
curr_Factors:  [100.32019868]
mat_Sqrt:  [[0.15]]
grads:  [0.08011932]
Stock Position:  0.08011931679815404
Bond Position:  [-12.20976673]


portfolio before change:  [-4.11920333]
curr_Stock_Price:  100.9909577805124
curr_Factors:  [100.99095778]
mat_Sqrt:  [[0.15]]
grads:  [0.07963984]
Stock Position:  0.07963984250393386
Bond Position:  [-12.1621073]


portfolio before change:  [-4.08664865]
curr_Stock_Price:  101.40927648675526
curr_Factors:  [101.40927649]
mat_Sqrt:  [[0.15]]
grads:  [0.00047753]
Stock Position:  0.00047752717294729445
Bond Position:  [-4.13507433]


portfolio before change:  [-4.08692507]
curr_Stock_Price:  101.37164294487383
curr_Factors:  [101.37164294]
mat_Sqrt:  [[0.15]]
grads:  [0.04184828]
Stock Position:  0.04184828373846509
Bond Position:  [-8.32915434]


portfolio before change:  [-4.09971029]
curr_Stock_Price:  101.07856910605983
curr_Factors:  [101.07856911]
mat_Sqrt:  [[0.15]]
grads:  [-0.02578625]
Stock Position:  -0.025786246608665412
Bond Position:  [-1.49327338]


portfolio before change:  [-4.10254728]
curr_Stock_Price:  101.18496909687734
curr_Factors:  [101.1849691]
mat_Sqrt:  [[0.15]]
grads:  [-0.1322649]
Stock Position:  -0.13226490220743134
Bond Position:  [9.28067276]


portfolio before change:  [-4.24587485]
curr_Stock_Price:  102.2729948849734
curr_Factors:  [102.27299488]
mat_Sqrt:  [[0.15]]
grads:  [0.06607891]
Stock Position:  0.066078907586811
Bond Position:  [-11.00396262]


portfolio before change:  [-4.21259086]
curr_Stock_Price:  102.7871038291523
curr_Factors:  [102.78710383]
mat_Sqrt:  [[0.15]]
grads:  [-0.0809165]
Stock Position:  -0.08091650213463887
Bond Position:  [4.10458205]


portfolio before change:  [-4.22878812]
curr_Stock_Price:  102.99044690496105
curr_Factors:  [102.9904469]
mat_Sqrt:  [[0.15]]
grads:  [0.21483791]
Stock Position:  0.21483791120480494
Bond Position:  [-26.35504061]


portfolio before change:  [-4.30723015]
curr_Stock_Price:  102.63299235630988
curr_Factors:  [102.63299236]
mat_Sqrt:  [[0.15]]
grads:  [0.09667027]
Stock Position:  0.096670273928984
Bond Position:  [-14.22878964]


portfolio before change:  [-4.29939218]
curr_Stock_Price:  102.7232714183932
curr_Factors:  [102.72327142]
mat_Sqrt:  [[0.15]]
grads:  [-0.04128022]
Stock Position:  -0.04128021873246084
Bond Position:  [-0.05895307]


portfolio before change:  [-4.30507356]
curr_Stock_Price:  102.86081180441322
curr_Factors:  [102.8608118]
mat_Sqrt:  [[0.15]]
grads:  [-0.05817184]
Stock Position:  -0.05817183783884482
Bond Position:  [1.6785289]


portfolio before change:  [-4.29751171]
curr_Stock_Price:  102.73262361669207
curr_Factors:  [102.73262362]
mat_Sqrt:  [[0.15]]
grads:  [0.06752987]
Stock Position:  0.06752986590647328
Bond Position:  [-11.235032]


portfolio before change:  [-4.29076062]
curr_Stock_Price:  102.84299407649918
curr_Factors:  [102.84299408]
mat_Sqrt:  [[0.15]]
grads:  [0.17752651]
Stock Position:  0.17752651354536095
Bond Position:  [-22.5481188]


portfolio before change:  [-4.29063256]
curr_Stock_Price:  102.85165395272334
curr_Factors:  [102.85165395]
mat_Sqrt:  [[0.15]]
grads:  [0.04905749]
Stock Position:  0.04905748774584167
Bond Position:  [-9.33627631]


portfolio before change:  [-4.3503883]
curr_Stock_Price:  101.64547307275254
curr_Factors:  [101.64547307]
mat_Sqrt:  [[0.15]]
grads:  [-0.00213493]
Stock Position:  -0.0021349301784988573
Bond Position:  [-4.13338231]


portfolio before change:  [-4.35100448]
curr_Stock_Price:  101.81308422512146
curr_Factors:  [101.81308423]
mat_Sqrt:  [[0.15]]
grads:  [0.38735688]
Stock Position:  0.3873568756712554
Bond Position:  [-43.78900269]


portfolio before change:  [-4.54151217]
curr_Stock_Price:  101.3283354086514
curr_Factors:  [101.32833541]
mat_Sqrt:  [[0.15]]
grads:  [-0.0872079]
Stock Position:  -0.08720789985962923
Bond Position:  [4.29511916]


portfolio before change:  [-4.50061176]
curr_Stock_Price:  100.86241482641917
curr_Factors:  [100.86241483]
mat_Sqrt:  [[0.15]]
grads:  [0.01902708]
Stock Position:  0.019027084993536916
Bond Position:  [-6.4197295]


portfolio before change:  [-4.49556706]
curr_Stock_Price:  101.14863556677923
curr_Factors:  [101.14863557]
mat_Sqrt:  [[0.15]]
grads:  [0.01013664]
Stock Position:  0.010136637324844898
Bond Position:  [-5.52087409]


portfolio before change:  [-4.49181914]
curr_Stock_Price:  101.55241687432785
curr_Factors:  [101.55241687]
mat_Sqrt:  [[0.15]]
grads:  [0.10878816]
Stock Position:  0.10878816017093533
Bond Position:  [-15.53951973]


portfolio before change:  [-4.52105195]
curr_Stock_Price:  101.29263162797977
curr_Factors:  [101.29263163]
mat_Sqrt:  [[0.15]]
grads:  [0.0516917]
Stock Position:  0.05169169537838938
Bond Position:  [-9.75703981]


portfolio before change:  [-4.49681792]
curr_Stock_Price:  101.77324781937779
curr_Factors:  [101.77324782]
mat_Sqrt:  [[0.15]]
grads:  [0.07552446]
Stock Position:  0.07552445937155126
Bond Position:  [-12.18318744]


portfolio before change:  [-4.51532598]
curr_Stock_Price:  101.53826968891411
curr_Factors:  [101.53826969]
mat_Sqrt:  [[0.15]]
grads:  [0.02108144]
Stock Position:  0.021081443813175373
Bond Position:  [-6.65589931]


portfolio before change:  [-4.51641602]
curr_Stock_Price:  101.50629719995466
curr_Factors:  [101.5062972]
mat_Sqrt:  [[0.15]]
grads:  [0.03096452]
Stock Position:  0.030964521388446704
Bond Position:  [-7.65950993]


portfolio before change:  [-4.49798346]
curr_Stock_Price:  102.1170379553107
curr_Factors:  [102.11703796]
mat_Sqrt:  [[0.15]]
grads:  [-0.12454702]
Stock Position:  -0.12454702162701892
Bond Position:  [8.22038948]


portfolio before change:  [-4.47118909]
curr_Stock_Price:  101.90602867255905
curr_Factors:  [101.90602867]
mat_Sqrt:  [[0.15]]
grads:  [-0.03724846]
Stock Position:  -0.037248458462504574
Bond Position:  [-0.67534661]


portfolio before change:  [-4.49174069]
curr_Stock_Price:  102.4566391384661
curr_Factors:  [102.45663914]
mat_Sqrt:  [[0.15]]
grads:  [0.22800233]
Stock Position:  0.22800232542926666
Bond Position:  [-27.85209267]


portfolio before change:  [-4.50348419]
curr_Stock_Price:  102.4127681395671
curr_Factors:  [102.41276814]
mat_Sqrt:  [[0.15]]
grads:  [0.04620371]
Stock Position:  0.04620370887302212
Bond Position:  [-9.23533391]


portfolio before change:  [-4.50291527]
curr_Stock_Price:  102.43757461876405
curr_Factors:  [102.43757462]
mat_Sqrt:  [[0.15]]
grads:  [-0.00968011]
Stock Position:  -0.00968011216659484
Bond Position:  [-3.51130805]


portfolio before change:  [-4.51090753]
curr_Stock_Price:  103.24054042153338
curr_Factors:  [103.24054042]
mat_Sqrt:  [[0.15]]
grads:  [-0.04143938]
Stock Position:  -0.041439383248431834
Bond Position:  [-0.23268321]


portfolio before change:  [-4.52066894]
curr_Stock_Price:  103.4757481917523
curr_Factors:  [103.47574819]
mat_Sqrt:  [[0.15]]
grads:  [-0.02764647]
Stock Position:  -0.027646467910961422
Bond Position:  [-1.65992998]


portfolio before change:  [-4.51538388]
curr_Stock_Price:  103.28082974189104
curr_Factors:  [103.28082974]
mat_Sqrt:  [[0.15]]
grads:  [-0.03473936]
Stock Position:  -0.034739357488652665
Bond Position:  [-0.92747421]


portfolio before change:  [-4.54442977]
curr_Stock_Price:  104.11526999907824
curr_Factors:  [104.11527]
mat_Sqrt:  [[0.15]]
grads:  [0.00880251]
Stock Position:  0.008802513201097406
Bond Position:  [-5.4609058]


portfolio before change:  [-4.54414925]
curr_Stock_Price:  104.18591239438011
curr_Factors:  [104.18591239]
mat_Sqrt:  [[0.15]]
grads:  [0.03051918]
Stock Position:  0.03051918386391579
Bond Position:  [-7.72381827]


portfolio before change:  [-4.55924624]
curr_Stock_Price:  103.70705833842958
curr_Factors:  [103.70705834]
mat_Sqrt:  [[0.15]]
grads:  [-0.05032534]
Stock Position:  -0.05032534177148614
Bond Position:  [0.65984691]


portfolio before change:  [-4.57321242]
curr_Stock_Price:  103.98539562548056
curr_Factors:  [103.98539563]
mat_Sqrt:  [[0.15]]
grads:  [-0.31307011]
Stock Position:  -0.3130701077034709
Bond Position:  [27.98150659]


portfolio before change:  [-4.74416963]
curr_Stock_Price:  104.53704875883477
curr_Factors:  [104.53704876]
mat_Sqrt:  [[0.15]]
grads:  [-0.02726915]
Stock Position:  -0.027269150627910882
Bond Position:  [-1.8935331]


portfolio before change:  [-4.76624411]
curr_Stock_Price:  105.34221255168801
curr_Factors:  [105.34221255]
mat_Sqrt:  [[0.15]]
grads:  [0.11863787]
Stock Position:  0.11863786946543359
Bond Position:  [-17.26381977]


portfolio before change:  [-4.79543081]
curr_Stock_Price:  105.10529256520239
curr_Factors:  [105.10529257]
mat_Sqrt:  [[0.15]]
grads:  [-0.10259695]
Stock Position:  -0.1025969456371151
Bond Position:  [5.98805117]


portfolio before change:  [-4.72107011]
curr_Stock_Price:  104.38415568162311
curr_Factors:  [104.38415568]
mat_Sqrt:  [[0.15]]
grads:  [-0.02282796]
Stock Position:  -0.022827961429751617
Bond Position:  [-2.33819263]


portfolio before change:  [-4.71316128]
curr_Stock_Price:  104.03130035186295
curr_Factors:  [104.03130035]
mat_Sqrt:  [[0.15]]
grads:  [0.01725059]
Stock Position:  0.017250589079104643
Bond Position:  [-6.50776249]


portfolio before change:  [-4.70786578]
curr_Stock_Price:  104.36185389997341
curr_Factors:  [104.3618539]
mat_Sqrt:  [[0.15]]
grads:  [-0.09061852]
Stock Position:  -0.09061852250737186
Bond Position:  [4.74925122]


portfolio before change:  [-4.6662169]
curr_Stock_Price:  103.90552284132663
curr_Factors:  [103.90552284]
mat_Sqrt:  [[0.15]]
grads:  [0.05474829]
Stock Position:  0.05474828549102802
Bond Position:  [-10.35486613]


portfolio before change:  [-4.60780318]
curr_Stock_Price:  104.98429481017662
curr_Factors:  [104.98429481]
mat_Sqrt:  [[0.15]]
grads:  [0.14820042]
Stock Position:  0.1482004162709058
Bond Position:  [-20.16651938]


portfolio before change:  [-4.68654718]
curr_Stock_Price:  104.4614653238341
curr_Factors:  [104.46146532]
mat_Sqrt:  [[0.15]]
grads:  [-0.07680505]
Stock Position:  -0.07680504780695518
Bond Position:  [3.33662066]


portfolio before change:  [-4.7038007]
curr_Stock_Price:  104.68882101765851
curr_Factors:  [104.68882102]
mat_Sqrt:  [[0.15]]
grads:  [-0.02770015]
Stock Position:  -0.02770014893272606
Bond Position:  [-1.80390476]


portfolio before change:  [-4.70825815]
curr_Stock_Price:  104.84566863598587
curr_Factors:  [104.84566864]
mat_Sqrt:  [[0.15]]
grads:  [0.02343376]
Stock Position:  0.02343375885456926
Bond Position:  [-7.16518626]


portfolio before change:  [-4.71727455]
curr_Stock_Price:  104.48001835313819
curr_Factors:  [104.48001835]
mat_Sqrt:  [[0.15]]
grads:  [0.01912391]
Stock Position:  0.019123912190578282
Bond Position:  [-6.71534124]


portfolio before change:  [-4.72391836]
curr_Stock_Price:  104.15455720873072
curr_Factors:  [104.15455721]
mat_Sqrt:  [[0.15]]
grads:  [0.00125023]
Stock Position:  0.0012502343681129431
Bond Position:  [-4.85413597]


portfolio before change:  [-4.7246532]
curr_Stock_Price:  103.8094603399047
curr_Factors:  [103.80946034]
mat_Sqrt:  [[0.15]]
grads:  [-0.04478776]
Stock Position:  -0.044787761543658225
Bond Position:  [-0.07525985]


portfolio before change:  [-4.74215693]
curr_Stock_Price:  104.20017017181986
curr_Factors:  [104.20017017]
mat_Sqrt:  [[0.15]]
grads:  [0.07103075]
Stock Position:  0.0710307507763013
Bond Position:  [-12.14357324]


portfolio before change:  [-4.73653226]
curr_Stock_Price:  104.29004198427926
curr_Factors:  [104.29004198]
mat_Sqrt:  [[0.15]]
grads:  [-0.10205272]
Stock Position:  -0.1020527195195471
Bond Position:  [5.90655014]


portfolio before change:  [-4.71552534]
curr_Stock_Price:  104.08781566231288
curr_Factors:  [104.08781566]
mat_Sqrt:  [[0.15]]
grads:  [-0.05571778]
Stock Position:  -0.05571777866311987
Bond Position:  [1.08401653]


portfolio before change:  [-4.69439387]
curr_Stock_Price:  103.70977250771628
curr_Factors:  [103.70977251]
mat_Sqrt:  [[0.15]]
grads:  [0.10618776]
Stock Position:  0.10618776168084844
Bond Position:  [-15.70710247]


portfolio before change:  [-4.72565701]
curr_Stock_Price:  103.424603845908
curr_Factors:  [103.42460385]
mat_Sqrt:  [[0.15]]
grads:  [0.00553318]
Stock Position:  0.005533175277048873
Bond Position:  [-5.29792347]


portfolio before change:  [-4.72826068]
curr_Stock_Price:  103.01389340523721
curr_Factors:  [103.01389341]
mat_Sqrt:  [[0.15]]
grads:  [0.07883661]
Stock Position:  0.07883661091115282
Bond Position:  [-12.84952691]


portfolio before change:  [-4.69332783]
curr_Stock_Price:  103.46718487862636
curr_Factors:  [103.46718488]
mat_Sqrt:  [[0.15]]
grads:  [-0.10149245]
Stock Position:  -0.10149245025385344
Bond Position:  [5.80781028]


portfolio before change:  [-4.65263773]
curr_Stock_Price:  103.06984391173482
curr_Factors:  [103.06984391]
mat_Sqrt:  [[0.15]]
grads:  [-0.08493165]
Stock Position:  -0.08493164640543535
Bond Position:  [4.10125381]


portfolio before change:  [-4.66708974]
curr_Stock_Price:  103.24302265228825
curr_Factors:  [103.24302265]
mat_Sqrt:  [[0.15]]
grads:  [-0.02152725]
Stock Position:  -0.021527251354384727
Bond Position:  [-2.44455125]


portfolio before change:  [-4.67810335]
curr_Stock_Price:  103.74753763619447
curr_Factors:  [103.74753764]
mat_Sqrt:  [[0.15]]
grads:  [0.07550963]
Stock Position:  0.07550962536991691
Bond Position:  [-12.51204105]


portfolio before change:  [-4.63015791]
curr_Stock_Price:  104.39285229746382
curr_Factors:  [104.3928523]
mat_Sqrt:  [[0.15]]
grads:  [-0.11580917]
Stock Position:  -0.11580916728263854
Bond Position:  [7.45949138]


portfolio before change:  [-4.5439474]
curr_Stock_Price:  103.65245944563492
curr_Factors:  [103.65245945]
mat_Sqrt:  [[0.15]]
grads:  [0.15165745]
Stock Position:  0.15165744810076165
Bond Position:  [-20.26361489]


portfolio before change:  [-4.49007656]
curr_Stock_Price:  104.01602457284639
curr_Factors:  [104.01602457]
mat_Sqrt:  [[0.15]]
grads:  [0.02588793]
Stock Position:  0.02588792851200488
Bond Position:  [-7.18283597]


portfolio before change:  [-4.48906004]
curr_Stock_Price:  104.07263243360823
curr_Factors:  [104.07263243]
mat_Sqrt:  [[0.15]]
grads:  [0.06982458]
Stock Position:  0.06982458403781552
Bond Position:  [-11.75588831]


portfolio before change:  [-4.43939619]
curr_Stock_Price:  104.794421449928
curr_Factors:  [104.79442145]
mat_Sqrt:  [[0.15]]
grads:  [-0.15448737]
Stock Position:  -0.15448736783343212
Bond Position:  [11.75001815]


portfolio before change:  [-4.33381197]
curr_Stock_Price:  104.11572637271139
curr_Factors:  [104.11572637]
mat_Sqrt:  [[0.15]]
grads:  [-0.05271338]
Stock Position:  -0.052713381152668035
Bond Position:  [1.15448]


portfolio before change:  [-4.28447574]
curr_Stock_Price:  103.18116142649899
curr_Factors:  [103.18116143]
mat_Sqrt:  [[0.15]]
grads:  [-0.05071621]
Stock Position:  -0.050716210494367385
Bond Position:  [0.94848177]


portfolio before change:  [-4.24044739]
curr_Stock_Price:  102.31419880483493
curr_Factors:  [102.3141988]
mat_Sqrt:  [[0.15]]
grads:  [0.01086638]
Stock Position:  0.01086638110022255
Bond Position:  [-5.35223247]


portfolio before change:  [-4.23104085]
curr_Stock_Price:  103.21063943516538
curr_Factors:  [103.21063944]
mat_Sqrt:  [[0.15]]
grads:  [0.04885055]
Stock Position:  0.04885055344490498
Bond Position:  [-9.27293771]


portfolio before change:  [-4.24083798]
curr_Stock_Price:  103.02195078381595
curr_Factors:  [103.02195078]
mat_Sqrt:  [[0.15]]
grads:  [-0.00500045]
Stock Position:  -0.0050004510486722185
Bond Position:  [-3.72568175]


portfolio before change:  [-4.23783015]
curr_Stock_Price:  102.37387254656859
curr_Factors:  [102.37387255]
mat_Sqrt:  [[0.15]]
grads:  [-0.08567501]
Stock Position:  -0.08567501460387421
Bond Position:  [4.53305287]


portfolio before change:  [-4.22889788]
curr_Stock_Price:  102.27292189449295
curr_Factors:  [102.27292189]
mat_Sqrt:  [[0.15]]
grads:  [0.03375349]
Stock Position:  0.03375349344722503
Bond Position:  [-7.68096628]


portfolio before change:  [-4.21841411]
curr_Stock_Price:  102.59774302402941
curr_Factors:  [102.59774302]
mat_Sqrt:  [[0.15]]
grads:  [-0.02907085]
Stock Position:  -0.029070848917676455
Bond Position:  [-1.23581062]


portfolio before change:  [-4.23873657]
curr_Stock_Price:  103.29415253383027
curr_Factors:  [103.29415253]
mat_Sqrt:  [[0.15]]
grads:  [0.16357487]
Stock Position:  0.16357486620786818
Bond Position:  [-21.13506375]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.23873657]
Stock Price:  103.66064384605771
PL:  [-7.89938041]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-5.27758653e-02]
 [-2.29837991e-03]
 [ 1.03533703e-04]
 [ 2.43676745e-03]
 [ 5.73250220e-03]
 [ 1.21872168e-02]
 [-5.39056138e-04]
 [ 1.39338992e-02]
 [-1.31538283e-02]
 [-6.63821072e-03]
 [ 9.83248633e-03]
 [-1.11528702e-02]
 [ 1.09211806e-02]
 [ 4.05264734e-03]
 [ 1.91204098e-04]
 [ 1.35709878e-02]
 [-4.46564830e-04]
 [ 5.38066745e-03]
 [ 1.19781694e-02]
 [ 1.38685440e-02]
 [ 5.23167417e-02]
 [-1.51123316e-02]
 [-2.35691772e-03]
 [ 1.24042571e-02]
 [ 1.26515674e-02]
 [-5.72354343e-03]
 [ 1.23521555e-02]
 [-6.40548930e-04]
 [ 2.74153486e-03]
 [-2.17765488e-02]
 [-4.80653239e-03]
 [ 4.68130599e-03]
 [ 1.47953918e-02]
 [ 1.77768247e-02]
 [-1.51398096e-02]
 [ 6.84344470e-03]
 [-2.64802211e-03]
 [ 6.91246539e-03]
 [ 2.40765399e-03]
 [-1.37200502e-02]
 [ 2.90013741e-03]
 [-2.26706480e-03]
 [ 3.54420342e-03]
 [-9.21290666e-03]
 [ 2.42664865e-03]
 [-2.02213811e-03]
 [-1.36949535e-02]
 [-5.05814304e-03]
 [-5.34460886e-03]
 [ 8.16389759e-03]
 [-2.98113511e-03]
 [ 3.76408041e-03]
 [ 1.11103723e-03]
 [-2.19001084e-03]
 [ 2.33879203e-03]
 [ 8.63952261e-03]
 [ 2.42790187e-03]
 [-2.85391701e-02]
 [ 1.40454462e-02]
 [ 8.64909021e-03]
 [ 6.47734542e-03]
 [-1.33342063e-02]
 [-1.25488000e-02]
 [-2.20887543e-03]
 [-1.34652414e-02]
 [ 4.01986200e-02]
 [ 2.00731186e-02]
 [ 2.18671723e-03]
 [ 6.97976551e-03]
 [-1.57357685e-02]
 [-4.54035655e-03]
 [-1.01955595e-03]
 [ 1.99455486e-03]
 [ 8.80271706e-03]
 [ 1.05520214e-02]
 [-9.33360190e-03]
 [ 1.39397821e-04]
 [-7.07352583e-03]
 [ 1.62107978e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.73237351]
curr_Stock_Price:  100.42842346599015
curr_Factors:  [100.42842347]
mat_Sqrt:  [[0.15]]
grads:  [-0.3518391]
Stock Position:  -0.3518391018057745
Bond Position:  [44.06701982]


portfolio before change:  [8.84112946]
curr_Stock_Price:  100.12714462789086
curr_Factors:  [100.12714463]
mat_Sqrt:  [[0.15]]
grads:  [-0.01532253]
Stock Position:  -0.015322532755525822
Bond Position:  [10.37533092]


portfolio before change:  [8.84066874]
curr_Stock_Price:  100.1995347013226
curr_Factors:  [100.1995347]
mat_Sqrt:  [[0.15]]
grads:  [0.00069022]
Stock Position:  0.0006902246890990154
Bond Position:  [8.77150855]


portfolio before change:  [8.84167655]
curr_Stock_Price:  100.86536448294301
curr_Factors:  [100.86536448]
mat_Sqrt:  [[0.15]]
grads:  [0.01624512]
Stock Position:  0.01624511633192384
Bond Position:  [7.20310697]


portfolio before change:  [8.85489315]
curr_Stock_Price:  101.65122487944403
curr_Factors:  [101.65122488]
mat_Sqrt:  [[0.15]]
grads:  [0.03821668]
Stock Position:  0.03821668134260261
Bond Position:  [4.97012068]


portfolio before change:  [8.86036112]
curr_Stock_Price:  101.78617435997973
curr_Factors:  [101.78617436]
mat_Sqrt:  [[0.15]]
grads:  [0.08124811]
Stock Position:  0.08124811192489502
Bond Position:  [0.59042663]


portfolio before change:  [8.88071573]
curr_Stock_Price:  102.03624435902093
curr_Factors:  [102.03624436]
mat_Sqrt:  [[0.15]]
grads:  [-0.00359371]
Stock Position:  -0.003593707588851884
Bond Position:  [9.24740416]


portfolio before change:  [8.88008395]
curr_Stock_Price:  102.3728800598107
curr_Factors:  [102.37288006]
mat_Sqrt:  [[0.15]]
grads:  [0.09289266]
Stock Position:  0.09289266125948796
Bond Position:  [-0.62960532]


portfolio before change:  [8.88120523]
curr_Stock_Price:  102.38537443577735
curr_Factors:  [102.38537444]
mat_Sqrt:  [[0.15]]
grads:  [-0.08769219]
Stock Position:  -0.08769218860219283
Bond Position:  [17.85960279]


portfolio before change:  [8.93027692]
curr_Stock_Price:  101.83851356024611
curr_Factors:  [101.83851356]
mat_Sqrt:  [[0.15]]
grads:  [-0.04425474]
Stock Position:  -0.044254738127909185
Bond Position:  [13.43711367]


portfolio before change:  [8.89503869]
curr_Stock_Price:  102.653749962725
curr_Factors:  [102.65374996]
mat_Sqrt:  [[0.15]]
grads:  [0.06554991]
Stock Position:  0.06554990887216636
Bond Position:  [2.16609473]


portfolio before change:  [8.88131195]
curr_Stock_Price:  102.44227568179345
curr_Factors:  [102.44227568]
mat_Sqrt:  [[0.15]]
grads:  [-0.07435247]
Stock Position:  -0.07435246804681
Bond Position:  [16.49814798]


portfolio before change:  [8.96934524]
curr_Stock_Price:  101.27214485061852
curr_Factors:  [101.27214485]
mat_Sqrt:  [[0.15]]
grads:  [0.07280787]
Stock Position:  0.07280787091133402
Bond Position:  [1.59593599]


portfolio before change:  [8.97412164]
curr_Stock_Price:  101.33637763113502
curr_Factors:  [101.33637763]
mat_Sqrt:  [[0.15]]
grads:  [0.02701765]
Stock Position:  0.027017648915498117
Bond Position:  [6.23625096]


portfolio before change:  [8.92211563]
curr_Stock_Price:  99.39706062082284
curr_Factors:  [99.39706062]
mat_Sqrt:  [[0.15]]
grads:  [0.00127469]
Stock Position:  0.0012746939889155331
Bond Position:  [8.79541479]


portfolio before change:  [8.92198129]
curr_Stock_Price:  98.86040539412075
curr_Factors:  [98.86040539]
mat_Sqrt:  [[0.15]]
grads:  [0.09047325]
Stock Position:  0.09047325167120963
Bond Position:  [-0.02224105]


portfolio before change:  [8.94136021]
curr_Stock_Price:  99.07461575120075
curr_Factors:  [99.07461575]
mat_Sqrt:  [[0.15]]
grads:  [-0.0029771]
Stock Position:  -0.002977098868806992
Bond Position:  [9.23631513]


portfolio before change:  [8.94223289]
curr_Stock_Price:  98.97539315396152
curr_Factors:  [98.97539315]
mat_Sqrt:  [[0.15]]
grads:  [0.03587112]
Stock Position:  0.03587111632656998
Bond Position:  [5.39187505]


portfolio before change:  [8.92361791]
curr_Stock_Price:  98.44705769435602
curr_Factors:  [98.44705769]
mat_Sqrt:  [[0.15]]
grads:  [0.07985446]
Stock Position:  0.07985446285915769
Bond Position:  [1.062181]


portfolio before change:  [8.90461048]
curr_Stock_Price:  98.20820038433115
curr_Factors:  [98.20820038]
mat_Sqrt:  [[0.15]]
grads:  [0.09245696]
Stock Position:  0.09245696004999071
Bond Position:  [-0.17542118]


portfolio before change:  [8.98560992]
curr_Stock_Price:  99.08439631205215
curr_Factors:  [99.08439631]
mat_Sqrt:  [[0.15]]
grads:  [0.34877828]
Stock Position:  0.3487782778670481
Bond Position:  [-25.57287519]


portfolio before change:  [9.20829703]
curr_Stock_Price:  99.72745661764819
curr_Factors:  [99.72745662]
mat_Sqrt:  [[0.15]]
grads:  [-0.10074888]
Stock Position:  -0.10074887719405755
Bond Position:  [19.25572631]


portfolio before change:  [9.21066829]
curr_Stock_Price:  99.71586603572398
curr_Factors:  [99.71586604]
mat_Sqrt:  [[0.15]]
grads:  [-0.01571278]
Stock Position:  -0.015712784825549154
Bond Position:  [10.77748224]


portfolio before change:  [9.2095045]
curr_Stock_Price:  99.832803100617
curr_Factors:  [99.8328031]
mat_Sqrt:  [[0.15]]
grads:  [0.08269505]
Stock Position:  0.08269504729097872
Bond Position:  [0.95382613]


portfolio before change:  [9.21791386]
curr_Stock_Price:  99.93377344596043
curr_Factors:  [99.93377345]
mat_Sqrt:  [[0.15]]
grads:  [0.08434378]
Stock Position:  0.08434378272825435
Bond Position:  [0.78912139]


portfolio before change:  [9.21122758]
curr_Stock_Price:  99.85391447310448
curr_Factors:  [99.85391447]
mat_Sqrt:  [[0.15]]
grads:  [-0.03815696]
Stock Position:  -0.03815695617891124
Bond Position:  [13.02134902]


portfolio before change:  [9.23121591]
curr_Stock_Price:  99.35139865002583
curr_Factors:  [99.35139865]
mat_Sqrt:  [[0.15]]
grads:  [0.0823477]
Stock Position:  0.08234770345971586
Bond Position:  [1.0498564]


portfolio before change:  [9.28410599]
curr_Stock_Price:  99.99287933296088
curr_Factors:  [99.99287933]
mat_Sqrt:  [[0.15]]
grads:  [-0.00427033]
Stock Position:  -0.004270326203139238
Bond Position:  [9.7111082]


portfolio before change:  [9.2861866]
curr_Stock_Price:  99.64779032988723
curr_Factors:  [99.64779033]
mat_Sqrt:  [[0.15]]
grads:  [0.0182769]
Stock Position:  0.018276899089486317
Bond Position:  [7.46493399]


portfolio before change:  [9.29094629]
curr_Stock_Price:  99.88268364229417
curr_Factors:  [99.88268364]
mat_Sqrt:  [[0.15]]
grads:  [-0.14517699]
Stock Position:  -0.14517699232646286
Bond Position:  [23.79161389]


portfolio before change:  [9.20891243]
curr_Stock_Price:  100.45798746959751
curr_Factors:  [100.45798747]
mat_Sqrt:  [[0.15]]
grads:  [-0.03204355]
Stock Position:  -0.03204354927860225
Bond Position:  [12.4279429]


portfolio before change:  [9.22168607]
curr_Stock_Price:  100.08359480657664
curr_Factors:  [100.08359481]
mat_Sqrt:  [[0.15]]
grads:  [0.03120871]
Stock Position:  0.031208706607571482
Bond Position:  [6.09820653]


portfolio before change:  [9.21538213]
curr_Stock_Price:  99.86938866245005
curr_Factors:  [99.86938866]
mat_Sqrt:  [[0.15]]
grads:  [0.09863595]
Stock Position:  0.09863594519840183
Bond Position:  [-0.63532942]


portfolio before change:  [9.21252628]
curr_Stock_Price:  99.84083786230207
curr_Factors:  [99.84083786]
mat_Sqrt:  [[0.15]]
grads:  [0.11851216]
Stock Position:  0.11851216451591327
Bond Position:  [-2.61982752]


portfolio before change:  [9.07254259]
curr_Stock_Price:  98.66104376750852
curr_Factors:  [98.66104377]
mat_Sqrt:  [[0.15]]
grads:  [-0.10093206]
Stock Position:  -0.10093206419525226
Bond Position:  [19.03060539]


portfolio before change:  [9.11761204]
curr_Stock_Price:  98.22629588205268
curr_Factors:  [98.22629588]
mat_Sqrt:  [[0.15]]
grads:  [0.04562296]
Stock Position:  0.045622964650434715
Bond Position:  [4.63623721]


portfolio before change:  [9.09964635]
curr_Stock_Price:  97.82615825879265
curr_Factors:  [97.82615826]
mat_Sqrt:  [[0.15]]
grads:  [-0.01765348]
Stock Position:  -0.017653480709937733
Bond Position:  [10.82661854]


portfolio before change:  [9.09492266]
curr_Stock_Price:  98.1320681514697
curr_Factors:  [98.13206815]
mat_Sqrt:  [[0.15]]
grads:  [0.0460831]
Stock Position:  0.04608310261641681
Bond Position:  [4.57269249]


portfolio before change:  [9.12385979]
curr_Stock_Price:  98.7538000246632
curr_Factors:  [98.75380002]
mat_Sqrt:  [[0.15]]
grads:  [0.01605103]
Stock Position:  0.016051026567657566
Bond Position:  [7.53875993]


portfolio before change:  [9.12994481]
curr_Stock_Price:  99.10354906699499
curr_Factors:  [99.10354907]
mat_Sqrt:  [[0.15]]
grads:  [-0.091467]
Stock Position:  -0.09146700126278903
Bond Position:  [18.19464926]


portfolio before change:  [9.1273366]
curr_Stock_Price:  99.14449731705257
curr_Factors:  [99.14449732]
mat_Sqrt:  [[0.15]]
grads:  [0.01933425]
Stock Position:  0.01933424941709614
Bond Position:  [7.21045216]


portfolio before change:  [9.12934482]
curr_Stock_Price:  99.22505680834055
curr_Factors:  [99.22505681]
mat_Sqrt:  [[0.15]]
grads:  [-0.01511377]
Stock Position:  -0.01511376535333226
Bond Position:  [10.62900905]


portfolio before change:  [9.13598721]
curr_Stock_Price:  98.8295198262435
curr_Factors:  [98.82951983]
mat_Sqrt:  [[0.15]]
grads:  [0.02362802]
Stock Position:  0.023628022799437216
Bond Position:  [6.80084106]


portfolio before change:  [9.1461854]
curr_Stock_Price:  99.24314413828705
curr_Factors:  [99.24314414]
mat_Sqrt:  [[0.15]]
grads:  [-0.06141938]
Stock Position:  -0.06141937770364584
Bond Position:  [15.24163756]


portfolio before change:  [9.15621316]
curr_Stock_Price:  99.0953873359549
curr_Factors:  [99.09538734]
mat_Sqrt:  [[0.15]]
grads:  [0.01617766]
Stock Position:  0.016177657644945796
Bond Position:  [7.55308191]


portfolio before change:  [9.16620526]
curr_Stock_Price:  99.68385420707767
curr_Factors:  [99.68385421]
mat_Sqrt:  [[0.15]]
grads:  [-0.01348092]
Stock Position:  -0.013480920757233315
Bond Position:  [10.5100354]


portfolio before change:  [9.16312278]
curr_Stock_Price:  99.9612372306181
curr_Factors:  [99.96123723]
mat_Sqrt:  [[0.15]]
grads:  [-0.09129969]
Stock Position:  -0.09129969028205753
Bond Position:  [18.28955278]


portfolio before change:  [9.15266732]
curr_Stock_Price:  100.08827596792348
curr_Factors:  [100.08827597]
mat_Sqrt:  [[0.15]]
grads:  [-0.03372095]
Stock Position:  -0.03372095358452488
Bond Position:  [12.52773942]


portfolio before change:  [9.15498046]
curr_Stock_Price:  100.04289963278593
curr_Factors:  [100.04289963]
mat_Sqrt:  [[0.15]]
grads:  [-0.03563073]
Stock Position:  -0.035630725719986066
Bond Position:  [12.71958157]


portfolio before change:  [9.14880847]
curr_Stock_Price:  100.23843283572647
curr_Factors:  [100.23843284]
mat_Sqrt:  [[0.15]]
grads:  [0.05442598]
Stock Position:  0.05442598390785412
Bond Position:  [3.69323313]


portfolio before change:  [9.15749698]
curr_Stock_Price:  100.39383073861174
curr_Factors:  [100.39383074]
mat_Sqrt:  [[0.15]]
grads:  [-0.01987423]
Stock Position:  -0.019874234071183144
Bond Position:  [11.15274748]


portfolio before change:  [9.15741673]
curr_Stock_Price:  100.43294302731589
curr_Factors:  [100.43294303]
mat_Sqrt:  [[0.15]]
grads:  [0.02509387]
Stock Position:  0.025093869405617527
Bond Position:  [6.63716557]


portfolio before change:  [9.15137]
curr_Stock_Price:  100.17544719321097
curr_Factors:  [100.17544719]
mat_Sqrt:  [[0.15]]
grads:  [0.00740691]
Stock Position:  0.007406914854119993
Bond Position:  [8.40937899]


portfolio before change:  [9.14861076]
curr_Stock_Price:  99.73196408418094
curr_Factors:  [99.73196408]
mat_Sqrt:  [[0.15]]
grads:  [-0.01460007]
Stock Position:  -0.01460007226437293
Bond Position:  [10.60470464]


portfolio before change:  [9.13776248]
curr_Stock_Price:  100.52039086541015
curr_Factors:  [100.52039087]
mat_Sqrt:  [[0.15]]
grads:  [0.01559195]
Stock Position:  0.01559194686594901
Bond Position:  [7.57045389]


portfolio before change:  [9.13594117]
curr_Stock_Price:  100.37323296232289
curr_Factors:  [100.37323296]
mat_Sqrt:  [[0.15]]
grads:  [0.05759682]
Stock Position:  0.05759681739155146
Bond Position:  [3.3547624]


portfolio before change:  [9.14247695]
curr_Stock_Price:  100.48306707554065
curr_Factors:  [100.48306708]
mat_Sqrt:  [[0.15]]
grads:  [0.01618601]
Stock Position:  0.016186012452360215
Bond Position:  [7.51605677]


portfolio before change:  [9.12591837]
curr_Stock_Price:  99.43102649484896
curr_Factors:  [99.43102649]
mat_Sqrt:  [[0.15]]
grads:  [-0.19026113]
Stock Position:  -0.19026113375354314
Bond Position:  [28.04377821]


portfolio before change:  [9.05151409]
curr_Stock_Price:  99.83130309026838
curr_Factors:  [99.83130309]
mat_Sqrt:  [[0.15]]
grads:  [0.09363631]
Stock Position:  0.09363630819263269
Bond Position:  [-0.29632058]


portfolio before change:  [9.0829993]
curr_Stock_Price:  100.16775092055757
curr_Factors:  [100.16775092]
mat_Sqrt:  [[0.15]]
grads:  [0.0576606]
Stock Position:  0.057660601428830276
Bond Position:  [3.30726654]


portfolio before change:  [9.06641907]
curr_Stock_Price:  99.87661727804766
curr_Factors:  [99.87661728]
mat_Sqrt:  [[0.15]]
grads:  [0.0431823]
Stock Position:  0.04318230277017311
Bond Position:  [4.75351674]


portfolio before change:  [9.03166892]
curr_Stock_Price:  99.06500574007349
curr_Factors:  [99.06500574]
mat_Sqrt:  [[0.15]]
grads:  [-0.08889471]
Stock Position:  -0.08889470858668423
Bond Position:  [17.83802373]


portfolio before change:  [9.01635288]
curr_Stock_Price:  99.2498417885261
curr_Factors:  [99.24984179]
mat_Sqrt:  [[0.15]]
grads:  [-0.08365867]
Stock Position:  -0.08365866644712254
Bond Position:  [17.31946229]


portfolio before change:  [8.94875143]
curr_Stock_Price:  100.07084403987521
curr_Factors:  [100.07084404]
mat_Sqrt:  [[0.15]]
grads:  [-0.01472584]
Stock Position:  -0.014725836198708354
Bond Position:  [10.42237829]


portfolio before change:  [8.95379182]
curr_Stock_Price:  99.77279833673643
curr_Factors:  [99.77279834]
mat_Sqrt:  [[0.15]]
grads:  [-0.08976828]
Stock Position:  -0.08976827567743836
Bond Position:  [17.91022389]


portfolio before change:  [8.93587198]
curr_Stock_Price:  99.98489183677701
curr_Factors:  [99.98489184]
mat_Sqrt:  [[0.15]]
grads:  [0.2679908]
Stock Position:  0.26799080022949295
Bond Position:  [-17.8591592]


portfolio before change:  [9.11456391]
curr_Stock_Price:  100.6558408672404
curr_Factors:  [100.65584087]
mat_Sqrt:  [[0.15]]
grads:  [0.13382079]
Stock Position:  0.13382079092418797
Bond Position:  [-4.35528033]


portfolio before change:  [8.97687812]
curr_Stock_Price:  99.62899309797855
curr_Factors:  [99.6289931]
mat_Sqrt:  [[0.15]]
grads:  [0.01457811]
Stock Position:  0.014578114850657672
Bond Position:  [7.52447521]


portfolio before change:  [8.97479774]
curr_Stock_Price:  99.45402765460871
curr_Factors:  [99.45402765]
mat_Sqrt:  [[0.15]]
grads:  [0.04653177]
Stock Position:  0.046531770093696044
Bond Position:  [4.34702579]


portfolio before change:  [8.95249379]
curr_Stock_Price:  98.96886129964757
curr_Factors:  [98.9688613]
mat_Sqrt:  [[0.15]]
grads:  [-0.10490512]
Stock Position:  -0.10490512317660582
Bond Position:  [19.33483438]


portfolio before change:  [8.95815431]
curr_Stock_Price:  98.9264224581922
curr_Factors:  [98.92642246]
mat_Sqrt:  [[0.15]]
grads:  [-0.03026904]
Stock Position:  -0.030269043666759123
Bond Position:  [11.95256251]


portfolio before change:  [8.95363129]
curr_Stock_Price:  99.10053030398248
curr_Factors:  [99.1005303]
mat_Sqrt:  [[0.15]]
grads:  [-0.00679704]
Stock Position:  -0.006797039643338246
Bond Position:  [9.62722152]


portfolio before change:  [8.9493897]
curr_Stock_Price:  99.81309171417243
curr_Factors:  [99.81309171]
mat_Sqrt:  [[0.15]]
grads:  [0.01329703]
Stock Position:  0.013297032399819829
Bond Position:  [7.62217179]


portfolio before change:  [8.94913639]
curr_Stock_Price:  99.75821396785935
curr_Factors:  [99.75821397]
mat_Sqrt:  [[0.15]]
grads:  [0.05868478]
Stock Position:  0.05868478039884369
Bond Position:  [3.09484751]


portfolio before change:  [8.98449134]
curr_Stock_Price:  100.35737304182022
curr_Factors:  [100.35737304]
mat_Sqrt:  [[0.15]]
grads:  [0.07034681]
Stock Position:  0.07034680938952792
Bond Position:  [1.92467035]


portfolio before change:  [9.01545801]
curr_Stock_Price:  100.79586304550777
curr_Factors:  [100.79586305]
mat_Sqrt:  [[0.15]]
grads:  [-0.06222401]
Stock Position:  -0.062224012654201674
Bond Position:  [15.28738107]


portfolio before change:  [9.01999529]
curr_Stock_Price:  100.73830024121833
curr_Factors:  [100.73830024]
mat_Sqrt:  [[0.15]]
grads:  [0.00092932]
Stock Position:  0.0009293188048572927
Bond Position:  [8.9263773]


portfolio before change:  [9.02101081]
curr_Stock_Price:  101.23070781401368
curr_Factors:  [101.23070781]
mat_Sqrt:  [[0.15]]
grads:  [-0.04715684]
Stock Position:  -0.04715683883701634
Bond Position:  [13.79473099]


portfolio before change:  [8.9811857]
curr_Stock_Price:  102.09351611334878
curr_Factors:  [102.09351611]
mat_Sqrt:  [[0.15]]
grads:  [0.10807199]
Stock Position:  0.10807198550643
Bond Position:  [-2.0522633]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.9811857]
Stock Price:  102.72660436040985
PL:  [6.25458134]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.46709193e-02]
 [ 4.07130925e-03]
 [-1.81580977e-04]
 [-2.76733031e-03]
 [-1.83243512e-02]
 [ 2.82147872e-03]
 [ 2.28684177e-03]
 [-1.23964333e-02]
 [-1.30901126e-03]
 [ 4.13197828e-02]
 [ 9.56079301e-03]
 [-1.00416371e-02]
 [ 6.39117541e-03]
 [ 4.65885999e-03]
 [-4.30725100e-03]
 [ 1.46699250e-02]
 [-2.27210686e-03]
 [ 2.79819934e-03]
 [ 6.36326673e-03]
 [ 1.37268519e-02]
 [ 3.00044026e-02]
 [-1.66482899e-02]
 [-1.58903115e-03]
 [ 9.50781324e-03]
 [ 5.65868841e-03]
 [ 1.28149732e-02]
 [ 1.44356551e-02]
 [-1.92570533e-02]
 [ 1.92273083e-03]
 [-8.86840046e-03]
 [-3.72748550e-03]
 [-1.47824851e-02]
 [ 1.57957761e-02]
 [ 1.95084240e-02]
 [-6.03015754e-03]
 [ 4.49790700e-03]
 [-2.31475386e-03]
 [ 1.16625267e-02]
 [ 8.01504321e-04]
 [-1.37271363e-02]
 [ 1.12142769e-03]
 [-1.67554559e-03]
 [ 4.51778045e-03]
 [-8.60914480e-03]
 [ 5.15221093e-04]
 [-6.90488792e-03]
 [-1.35486063e-02]
 [-4.80154930e-04]
 [-4.04108411e-03]
 [-5.40127632e-06]
 [-3.78751871e-03]
 [ 2.83475911e-03]
 [ 3.57780871e-03]
 [ 8.50477877e-04]
 [ 4.57935529e-03]
 [ 8.93070115e-03]
 [ 1.50846185e-02]
 [-2.48242515e-03]
 [ 1.36898896e-02]
 [ 7.87531660e-04]
 [ 3.31784420e-03]
 [-1.46385435e-02]
 [-1.25754300e-02]
 [-2.07077620e-03]
 [-1.69941437e-02]
 [ 1.46048094e-02]
 [ 1.30290695e-02]
 [ 2.00080491e-03]
 [ 7.27178738e-03]
 [-1.49946768e-02]
 [-5.77243843e-03]
 [-1.20045092e-03]
 [ 1.00255364e-03]
 [ 8.56849063e-03]
 [ 3.36568225e-03]
 [ 4.34030747e-04]
 [-3.54240627e-03]
 [-9.79258146e-03]
 [-1.06462580e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.96384062]
curr_Stock_Price:  99.22680545154086
curr_Factors:  [99.22680545]
mat_Sqrt:  [[0.15]]
grads:  [-0.23113946]
Stock Position:  -0.23113946170953054
Bond Position:  [12.97138978]


portfolio before change:  [-9.96472988]
curr_Stock_Price:  99.23416031345133
curr_Factors:  [99.23416031]
mat_Sqrt:  [[0.15]]
grads:  [0.02714206]
Stock Position:  0.02714206163649467
Bond Position:  [-12.65814958]


portfolio before change:  [-9.98333095]
curr_Stock_Price:  98.57798639628845
curr_Factors:  [98.5779864]
mat_Sqrt:  [[0.15]]
grads:  [-0.00121054]
Stock Position:  -0.0012105398466722077
Bond Position:  [-9.86399837]


portfolio before change:  [-9.98327238]
curr_Stock_Price:  98.02030760908116
curr_Factors:  [98.02030761]
mat_Sqrt:  [[0.15]]
grads:  [-0.01844887]
Stock Position:  -0.018448868735644438
Bond Position:  [-8.17490859]


portfolio before change:  [-9.99230764]
curr_Stock_Price:  98.48235812136454
curr_Factors:  [98.48235812]
mat_Sqrt:  [[0.15]]
grads:  [-0.12216234]
Stock Position:  -0.12216234142308088
Bond Position:  [2.03852782]


portfolio before change:  [-9.94049631]
curr_Stock_Price:  98.05928242094525
curr_Factors:  [98.05928242]
mat_Sqrt:  [[0.15]]
grads:  [0.01880986]
Stock Position:  0.018809858112756282
Bond Position:  [-11.7849775]


portfolio before change:  [-9.95179766]
curr_Stock_Price:  97.49762119314128
curr_Factors:  [97.49762119]
mat_Sqrt:  [[0.15]]
grads:  [0.01524561]
Stock Position:  0.015245611776474386
Bond Position:  [-11.43820854]


portfolio before change:  [-9.95537866]
curr_Stock_Price:  97.30962674059985
curr_Factors:  [97.30962674]
mat_Sqrt:  [[0.15]]
grads:  [-0.08264289]
Stock Position:  -0.08264288873685323
Bond Position:  [-1.91343001]


portfolio before change:  [-9.94315025]
curr_Stock_Price:  97.16021276788308
curr_Factors:  [97.16021277]
mat_Sqrt:  [[0.15]]
grads:  [-0.00872674]
Stock Position:  -0.008726741714193988
Bond Position:  [-9.09525817]


portfolio before change:  [-9.94356946]
curr_Stock_Price:  97.14310861870887
curr_Factors:  [97.14310862]
mat_Sqrt:  [[0.15]]
grads:  [0.27546522]
Stock Position:  0.27546521870163004
Bond Position:  [-36.70311712]


portfolio before change:  [-9.90433374]
curr_Stock_Price:  97.29387080533655
curr_Factors:  [97.29387081]
mat_Sqrt:  [[0.15]]
grads:  [0.06373862]
Stock Position:  0.0637386200537439
Bond Position:  [-16.1057108]


portfolio before change:  [-9.88221333]
curr_Stock_Price:  97.65671276581718
curr_Factors:  [97.65671277]
mat_Sqrt:  [[0.15]]
grads:  [-0.06694425]
Stock Position:  -0.06694424703632691
Bond Position:  [-3.34465823]


portfolio before change:  [-9.88079917]
curr_Stock_Price:  97.63246567290976
curr_Factors:  [97.63246567]
mat_Sqrt:  [[0.15]]
grads:  [0.04260784]
Stock Position:  0.04260783605723737
Bond Position:  [-14.04070727]


portfolio before change:  [-9.86307876]
curr_Stock_Price:  98.06895784476762
curr_Factors:  [98.06895784]
mat_Sqrt:  [[0.15]]
grads:  [0.03105907]
Stock Position:  0.031059066589437988
Bond Position:  [-12.90900905]


portfolio before change:  [-9.84327147]
curr_Stock_Price:  98.73266517460337
curr_Factors:  [98.73266517]
mat_Sqrt:  [[0.15]]
grads:  [-0.02871501]
Stock Position:  -0.028715006673167866
Bond Position:  [-7.00816233]


portfolio before change:  [-9.83250193]
curr_Stock_Price:  98.3423619824097
curr_Factors:  [98.34236198]
mat_Sqrt:  [[0.15]]
grads:  [0.0977995]
Stock Position:  0.09779950020252579
Bond Position:  [-19.45033578]


portfolio before change:  [-9.81876341]
curr_Stock_Price:  98.49526877513222
curr_Factors:  [98.49526878]
mat_Sqrt:  [[0.15]]
grads:  [-0.01514738]
Stock Position:  -0.015147379045772702
Bond Position:  [-8.32681824]


portfolio before change:  [-9.81584579]
curr_Stock_Price:  98.26829499622282
curr_Factors:  [98.268295]
mat_Sqrt:  [[0.15]]
grads:  [0.01865466]
Stock Position:  0.01865466225372859
Bond Position:  [-11.64900765]


portfolio before change:  [-9.82003615]
curr_Stock_Price:  98.08269665413637
curr_Factors:  [98.08269665]
mat_Sqrt:  [[0.15]]
grads:  [0.04242178]
Stock Position:  0.04242177820677685
Bond Position:  [-13.98087856]


portfolio before change:  [-9.80812855]
curr_Stock_Price:  98.38399095032442
curr_Factors:  [98.38399095]
mat_Sqrt:  [[0.15]]
grads:  [0.09151235]
Stock Position:  0.09151234610252333
Bond Position:  [-18.81147838]


portfolio before change:  [-9.79136039]
curr_Stock_Price:  98.58007279330255
curr_Factors:  [98.58007279]
mat_Sqrt:  [[0.15]]
grads:  [0.20002935]
Stock Position:  0.20002935066374208
Bond Position:  [-29.51026834]


portfolio before change:  [-9.65632373]
curr_Stock_Price:  99.26437789933611
curr_Factors:  [99.2643779]
mat_Sqrt:  [[0.15]]
grads:  [-0.1109886]
Stock Position:  -0.11098859925152879
Bond Position:  [1.36089052]


portfolio before change:  [-9.66000617]
curr_Stock_Price:  99.2983227682999
curr_Factors:  [99.29832277]
mat_Sqrt:  [[0.15]]
grads:  [-0.01059354]
Stock Position:  -0.010593540988496845
Bond Position:  [-8.60808532]


portfolio before change:  [-9.64786076]
curr_Stock_Price:  98.1010427151113
curr_Factors:  [98.10104272]
mat_Sqrt:  [[0.15]]
grads:  [0.06338542]
Stock Position:  0.06338542161485275
Bond Position:  [-15.86603671]


portfolio before change:  [-9.61208052]
curr_Stock_Price:  98.68117446064967
curr_Factors:  [98.68117446]
mat_Sqrt:  [[0.15]]
grads:  [0.03772459]
Stock Position:  0.03772458938018032
Bond Position:  [-13.3347873]


portfolio before change:  [-9.63885941]
curr_Stock_Price:  97.99341506280477
curr_Factors:  [97.99341506]
mat_Sqrt:  [[0.15]]
grads:  [0.08543315]
Stock Position:  0.08543315444704205
Bond Position:  [-18.01074597]


portfolio before change:  [-9.6536415]
curr_Stock_Price:  97.83356632021048
curr_Factors:  [97.83356632]
mat_Sqrt:  [[0.15]]
grads:  [0.0962377]
Stock Position:  0.09623770066165865
Bond Position:  [-19.06891897]


portfolio before change:  [-9.65024256]
curr_Stock_Price:  97.88126883628416
curr_Factors:  [97.88126884]
mat_Sqrt:  [[0.15]]
grads:  [-0.12838036]
Stock Position:  -0.12838035565689304
Bond Position:  [2.91578954]


portfolio before change:  [-9.73623098]
curr_Stock_Price:  98.55248255578348
curr_Factors:  [98.55248256]
mat_Sqrt:  [[0.15]]
grads:  [0.01281821]
Stock Position:  0.012818205559649997
Bond Position:  [-10.99949696]


portfolio before change:  [-9.73877105]
curr_Stock_Price:  98.40795515670412
curr_Factors:  [98.40795516]
mat_Sqrt:  [[0.15]]
grads:  [-0.05912267]
Stock Position:  -0.059122669736952134
Bond Position:  [-3.92063002]


portfolio before change:  [-9.75432925]
curr_Stock_Price:  98.66696168346736
curr_Factors:  [98.66696168]
mat_Sqrt:  [[0.15]]
grads:  [-0.0248499]
Stock Position:  -0.024849903324942916
Bond Position:  [-7.30246479]


portfolio before change:  [-9.77044968]
curr_Stock_Price:  99.2973065841707
curr_Factors:  [99.29730658]
mat_Sqrt:  [[0.15]]
grads:  [-0.0985499]
Stock Position:  -0.09854990070729745
Bond Position:  [0.01529002]


portfolio before change:  [-9.78069855]
curr_Stock_Price:  99.40131306338618
curr_Factors:  [99.40131306]
mat_Sqrt:  [[0.15]]
grads:  [0.10530517]
Stock Position:  0.10530517407428747
Bond Position:  [-20.24817113]


portfolio before change:  [-9.78612671]
curr_Stock_Price:  99.36178405880662
curr_Factors:  [99.36178406]
mat_Sqrt:  [[0.15]]
grads:  [0.13005616]
Stock Position:  0.13005615988714508
Bond Position:  [-22.70873879]


portfolio before change:  [-9.7757276]
curr_Stock_Price:  99.45265598271932
curr_Factors:  [99.45265598]
mat_Sqrt:  [[0.15]]
grads:  [-0.04020105]
Stock Position:  -0.04020105027526432
Bond Position:  [-5.77762638]


portfolio before change:  [-9.76632278]
curr_Stock_Price:  99.20972875254715
curr_Factors:  [99.20972875]
mat_Sqrt:  [[0.15]]
grads:  [0.02998605]
Stock Position:  0.02998604666084231
Bond Position:  [-12.74123034]


portfolio before change:  [-9.77801672]
curr_Stock_Price:  98.84630697467243
curr_Factors:  [98.84630697]
mat_Sqrt:  [[0.15]]
grads:  [-0.01543169]
Stock Position:  -0.015431692422853272
Bond Position:  [-8.25265091]


portfolio before change:  [-9.79203076]
curr_Stock_Price:  99.7210157563166
curr_Factors:  [99.72101576]
mat_Sqrt:  [[0.15]]
grads:  [0.07775018]
Stock Position:  0.07775017769612909
Bond Position:  [-17.54535746]


portfolio before change:  [-9.82590893]
curr_Stock_Price:  99.29938906443509
curr_Factors:  [99.29938906]
mat_Sqrt:  [[0.15]]
grads:  [0.00534336]
Stock Position:  0.005343362138573151
Bond Position:  [-10.35650153]


portfolio before change:  [-9.82647611]
curr_Stock_Price:  99.31438390692364
curr_Factors:  [99.31438391]
mat_Sqrt:  [[0.15]]
grads:  [-0.09151424]
Stock Position:  -0.09151424206848797
Bond Position:  [-0.73779554]


portfolio before change:  [-9.82390305]
curr_Stock_Price:  99.28576352197234
curr_Factors:  [99.28576352]
mat_Sqrt:  [[0.15]]
grads:  [0.00747618]
Stock Position:  0.0074761845966575535
Bond Position:  [-10.56618175]


portfolio before change:  [-9.83001759]
curr_Stock_Price:  98.55622966747241
curr_Factors:  [98.55622967]
mat_Sqrt:  [[0.15]]
grads:  [-0.0111703]
Stock Position:  -0.011170303964176367
Bond Position:  [-8.72911454]


portfolio before change:  [-9.82359426]
curr_Stock_Price:  97.93235077339624
curr_Factors:  [97.93235077]
mat_Sqrt:  [[0.15]]
grads:  [0.03011854]
Stock Position:  0.03011853632105519
Bond Position:  [-12.77317332]


portfolio before change:  [-9.83939908]
curr_Stock_Price:  97.43410369416702
curr_Factors:  [97.43410369]
mat_Sqrt:  [[0.15]]
grads:  [-0.0573943]
Stock Position:  -0.05739429866164174
Bond Position:  [-4.24723703]


portfolio before change:  [-9.83132346]
curr_Stock_Price:  97.28877423230631
curr_Factors:  [97.28877423]
mat_Sqrt:  [[0.15]]
grads:  [0.00343481]
Stock Position:  0.003434807286301298
Bond Position:  [-10.16549165]


portfolio before change:  [-9.83227808]
curr_Stock_Price:  97.19582477586692
curr_Factors:  [97.19582478]
mat_Sqrt:  [[0.15]]
grads:  [-0.04603259]
Stock Position:  -0.04603258616599958
Bond Position:  [-5.3581029]


portfolio before change:  [-9.84313102]
curr_Stock_Price:  97.42431603225104
curr_Factors:  [97.42431603]
mat_Sqrt:  [[0.15]]
grads:  [-0.09032404]
Stock Position:  -0.09032404228552554
Bond Position:  [-1.04337298]


portfolio before change:  [-9.82291501]
curr_Stock_Price:  97.19977763084641
curr_Factors:  [97.19977763]
mat_Sqrt:  [[0.15]]
grads:  [-0.00320103]
Stock Position:  -0.003201032867352789
Bond Position:  [-9.51177533]


portfolio before change:  [-9.82402225]
curr_Stock_Price:  97.3599545615512
curr_Factors:  [97.35995456]
mat_Sqrt:  [[0.15]]
grads:  [-0.02694056]
Stock Position:  -0.026940560719495393
Bond Position:  [-7.20109048]


portfolio before change:  [-9.81019731]
curr_Stock_Price:  96.83008338244959
curr_Factors:  [96.83008338]
mat_Sqrt:  [[0.15]]
grads:  [-3.60085088e-05]
Stock Position:  -3.6008508798139605e-05
Bond Position:  [-9.8067106]


portfolio before change:  [-9.81080185]
curr_Stock_Price:  96.59698546665524
curr_Factors:  [96.59698547]
mat_Sqrt:  [[0.15]]
grads:  [-0.02525012]
Stock Position:  -0.02525012474461656
Bond Position:  [-7.37171592]


portfolio before change:  [-9.78450948]
curr_Stock_Price:  95.53746113191222
curr_Factors:  [95.53746113]
mat_Sqrt:  [[0.15]]
grads:  [0.01889839]
Stock Position:  0.0188983940903107
Bond Position:  [-11.59001407]


portfolio before change:  [-9.77178128]
curr_Stock_Price:  96.24929917780523
curr_Factors:  [96.24929918]
mat_Sqrt:  [[0.15]]
grads:  [0.02385206]
Stock Position:  0.023852058091504043
Bond Position:  [-12.06752515]


portfolio before change:  [-9.75894849]
curr_Stock_Price:  96.81893699598422
curr_Factors:  [96.818937]
mat_Sqrt:  [[0.15]]
grads:  [0.00566985]
Stock Position:  0.005669852511510699
Bond Position:  [-10.30789758]


portfolio before change:  [-9.75763489]
curr_Stock_Price:  97.16424814075111
curr_Factors:  [97.16424814]
mat_Sqrt:  [[0.15]]
grads:  [0.03052904]
Stock Position:  0.03052903529101449
Bond Position:  [-12.72396565]


portfolio before change:  [-9.7472249]
curr_Stock_Price:  97.53128431068987
curr_Factors:  [97.53128431]
mat_Sqrt:  [[0.15]]
grads:  [0.05953801]
Stock Position:  0.059538007678483114
Bond Position:  [-15.55404326]


portfolio before change:  [-9.69003307]
curr_Stock_Price:  98.50820624446852
curr_Factors:  [98.50820624]
mat_Sqrt:  [[0.15]]
grads:  [0.10056412]
Stock Position:  0.10056412311698847
Bond Position:  [-19.59642445]


portfolio before change:  [-9.77941437]
curr_Stock_Price:  97.63158661258478
curr_Factors:  [97.63158661]
mat_Sqrt:  [[0.15]]
grads:  [-0.0165495]
Stock Position:  -0.016549500997576558
Bond Position:  [-8.16366033]


portfolio before change:  [-9.78130282]
curr_Stock_Price:  97.71486426231078
curr_Factors:  [97.71486426]
mat_Sqrt:  [[0.15]]
grads:  [0.09126593]
Stock Position:  0.0912659306275623
Bond Position:  [-18.69934084]


portfolio before change:  [-9.77511952]
curr_Stock_Price:  97.79542056912643
curr_Factors:  [97.79542057]
mat_Sqrt:  [[0.15]]
grads:  [0.00525021]
Stock Position:  0.005250211069680781
Bond Position:  [-10.28856612]


portfolio before change:  [-9.77589988]
curr_Stock_Price:  97.76926902990166
curr_Factors:  [97.76926903]
mat_Sqrt:  [[0.15]]
grads:  [0.02211896]
Stock Position:  0.022118961335957935
Bond Position:  [-11.93845456]


portfolio before change:  [-9.76262294]
curr_Stock_Price:  98.40325527127732
curr_Factors:  [98.40325527]
mat_Sqrt:  [[0.15]]
grads:  [-0.09759029]
Stock Position:  -0.0975902900551222
Bond Position:  [-0.15942071]


portfolio before change:  [-9.82395836]
curr_Stock_Price:  99.03165238211419
curr_Factors:  [99.03165238]
mat_Sqrt:  [[0.15]]
grads:  [-0.0838362]
Stock Position:  -0.0838361999366273
Bond Position:  [-1.52152095]


portfolio before change:  [-9.8727519]
curr_Stock_Price:  99.61252851136497
curr_Factors:  [99.61252851]
mat_Sqrt:  [[0.15]]
grads:  [-0.01380517]
Stock Position:  -0.013805174639783643
Bond Position:  [-8.49758355]


portfolio before change:  [-9.88060526]
curr_Stock_Price:  100.14292682990875
curr_Factors:  [100.14292683]
mat_Sqrt:  [[0.15]]
grads:  [-0.11329429]
Stock Position:  -0.11329429104224918
Bond Position:  [1.46501664]


portfolio before change:  [-9.77575611]
curr_Stock_Price:  99.21827668928334
curr_Factors:  [99.21827669]
mat_Sqrt:  [[0.15]]
grads:  [0.0973654]
Stock Position:  0.0973653962344387
Bond Position:  [-19.43618293]


portfolio before change:  [-9.78137851]
curr_Stock_Price:  99.17300806602887
curr_Factors:  [99.17300807]
mat_Sqrt:  [[0.15]]
grads:  [0.08686046]
Stock Position:  0.08686046354197027
Bond Position:  [-18.39559196]


portfolio before change:  [-9.77631738]
curr_Stock_Price:  99.24451223398177
curr_Factors:  [99.24451223]
mat_Sqrt:  [[0.15]]
grads:  [0.0133387]
Stock Position:  0.013338699367137037
Bond Position:  [-11.1001101]


portfolio before change:  [-9.77703097]
curr_Stock_Price:  99.24302705299343
curr_Factors:  [99.24302705]
mat_Sqrt:  [[0.15]]
grads:  [0.04847858]
Stock Position:  0.04847858250660089
Bond Position:  [-14.58819225]


portfolio before change:  [-9.77778075]
curr_Stock_Price:  99.2463688887689
curr_Factors:  [99.24636889]
mat_Sqrt:  [[0.15]]
grads:  [-0.09996451]
Stock Position:  -0.09996451191449357
Bond Position:  [0.14333407]


portfolio before change:  [-9.81909545]
curr_Stock_Price:  99.65975212742318
curr_Factors:  [99.65975213]
mat_Sqrt:  [[0.15]]
grads:  [-0.03848292]
Stock Position:  -0.03848292284104145
Bond Position:  [-5.9838969]


portfolio before change:  [-9.80931932]
curr_Stock_Price:  99.3959952144455
curr_Factors:  [99.39599521]
mat_Sqrt:  [[0.15]]
grads:  [-0.00800301]
Stock Position:  -0.008003006139840283
Bond Position:  [-9.01385256]


portfolio before change:  [-9.80111853]
curr_Stock_Price:  98.30088550521678
curr_Factors:  [98.30088551]
mat_Sqrt:  [[0.15]]
grads:  [0.00668369]
Stock Position:  0.00668369095629296
Bond Position:  [-10.45813127]


portfolio before change:  [-9.80102952]
curr_Stock_Price:  98.4120013523556
curr_Factors:  [98.41200135]
mat_Sqrt:  [[0.15]]
grads:  [0.05712327]
Stock Position:  0.057123270860029524
Bond Position:  [-15.42264493]


portfolio before change:  [-9.82414297]
curr_Stock_Price:  98.02425206607533
curr_Factors:  [98.02425207]
mat_Sqrt:  [[0.15]]
grads:  [0.02243788]
Stock Position:  0.022437881642812393
Bond Position:  [-12.02359954]


portfolio before change:  [-9.82763262]
curr_Stock_Price:  97.9022195233991
curr_Factors:  [97.90221952]
mat_Sqrt:  [[0.15]]
grads:  [0.00289354]
Stock Position:  0.002893538312317794
Bond Position:  [-10.11091645]


portfolio before change:  [-9.82769722]
curr_Stock_Price:  98.09829554255103
curr_Factors:  [98.09829554]
mat_Sqrt:  [[0.15]]
grads:  [-0.02361604]
Stock Position:  -0.023616041817102786
Bond Position:  [-7.51100377]


portfolio before change:  [-9.84032575]
curr_Stock_Price:  98.61316040618163
curr_Factors:  [98.61316041]
mat_Sqrt:  [[0.15]]
grads:  [-0.06528388]
Stock Position:  -0.06528387639478585
Bond Position:  [-3.40247637]


portfolio before change:  [-9.80900601]
curr_Stock_Price:  98.13015601060674
curr_Factors:  [98.13015601]
mat_Sqrt:  [[0.15]]
grads:  [-0.07097505]
Stock Position:  -0.07097505328881731
Bond Position:  [-2.84421296]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.80900601]
Stock Price:  98.41485897248828
PL:  [-9.80900601]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.44177183e-02]
 [ 9.59348043e-04]
 [ 5.52592674e-04]
 [ 6.98343583e-04]
 [-1.43998427e-02]
 [ 9.89840599e-03]
 [ 4.51313278e-04]
 [ 1.17679270e-02]
 [ 7.18916602e-03]
 [ 2.25205098e-03]
 [ 7.60340994e-03]
 [-1.00357995e-02]
 [ 4.39756461e-03]
 [ 5.23107027e-03]
 [-2.77869349e-02]
 [ 1.92306946e-02]
 [-5.72369455e-03]
 [-2.31442574e-02]
 [-4.14755325e-02]
 [ 1.91787338e-02]
 [-7.37541591e-02]
 [-2.76041511e-02]
 [ 7.02180254e-04]
 [ 3.94128010e-03]
 [-2.17550938e-04]
 [ 7.50287382e-03]
 [ 1.24531118e-02]
 [-1.01659721e-02]
 [ 2.38294458e-03]
 [-1.16668654e-02]
 [-3.63308695e-03]
 [-1.95903246e-02]
 [ 1.85279134e-02]
 [ 1.81506632e-02]
 [-1.47438453e-02]
 [ 6.32700790e-03]
 [-2.40155356e-03]
 [ 1.13481321e-02]
 [-7.28853433e-05]
 [-1.38279557e-02]
 [-2.46951324e-03]
 [-2.40750503e-03]
 [ 5.08635216e-03]
 [-1.16872061e-02]
 [ 2.97983349e-03]
 [ 1.33515287e-03]
 [-1.36847906e-02]
 [-3.74432243e-03]
 [ 3.36862081e-03]
 [-2.64101133e-03]
 [-3.43431839e-03]
 [ 3.52440805e-03]
 [ 1.56276849e-03]
 [ 3.57025551e-03]
 [-5.10148264e-03]
 [ 9.27886358e-03]
 [-4.92991016e-03]
 [-1.76773553e-02]
 [ 1.34498745e-02]
 [ 8.27440663e-03]
 [ 8.22296048e-03]
 [-1.26200110e-02]
 [-1.25364201e-02]
 [-2.16578338e-03]
 [-1.23969949e-02]
 [ 4.30697261e-02]
 [ 1.34764079e-02]
 [ 2.00059687e-03]
 [ 7.32041703e-03]
 [-1.46441297e-02]
 [-5.97708722e-03]
 [-1.09687961e-03]
 [ 1.56983232e-03]
 [ 8.80629470e-03]
 [ 1.04943077e-02]
 [-7.26930065e-03]
 [-2.09545604e-03]
 [-8.62584188e-03]
 [ 4.55500437e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.34834929]
curr_Stock_Price:  100.01811801839567
curr_Factors:  [100.01811802]
mat_Sqrt:  [[0.15]]
grads:  [-0.22945146]
Stock Position:  -0.22945145508627446
Bond Position:  [25.29765201]


portfolio before change:  [2.4471732]
curr_Stock_Price:  99.59431268036997
curr_Factors:  [99.59431268]
mat_Sqrt:  [[0.15]]
grads:  [0.00639565]
Stock Position:  0.00639565362244931
Bond Position:  [1.81020247]


portfolio before change:  [2.4487006]
curr_Stock_Price:  99.81544213040623
curr_Factors:  [99.81544213]
mat_Sqrt:  [[0.15]]
grads:  [0.00368395]
Stock Position:  0.0036839511620636567
Bond Position:  [2.08098539]


portfolio before change:  [2.44708826]
curr_Stock_Price:  99.3424697868793
curr_Factors:  [99.34246979]
mat_Sqrt:  [[0.15]]
grads:  [0.00465562]
Stock Position:  0.004655623887159382
Bond Position:  [1.98458709]


portfolio before change:  [2.44453169]
curr_Stock_Price:  98.76668937108658
curr_Factors:  [98.76668937]
mat_Sqrt:  [[0.15]]
grads:  [-0.09599895]
Stock Position:  -0.09599895117520592
Bond Position:  [11.92603028]


portfolio before change:  [2.39275653]
curr_Stock_Price:  99.31378446966639
curr_Factors:  [99.31378447]
mat_Sqrt:  [[0.15]]
grads:  [0.06598937]
Stock Position:  0.06598937324686831
Bond Position:  [-4.16089786]


portfolio before change:  [2.36908591]
curr_Stock_Price:  98.95902193191186
curr_Factors:  [98.95902193]
mat_Sqrt:  [[0.15]]
grads:  [0.00300876]
Stock Position:  0.003008755183693554
Bond Position:  [2.07134244]


portfolio before change:  [2.36835088]
curr_Stock_Price:  98.67169670835953
curr_Factors:  [98.67169671]
mat_Sqrt:  [[0.15]]
grads:  [0.07845285]
Stock Position:  0.07845284676471594
Bond Position:  [-5.37272462]


portfolio before change:  [2.31725993]
curr_Stock_Price:  98.0247457887776
curr_Factors:  [98.02474579]
mat_Sqrt:  [[0.15]]
grads:  [0.04792777]
Stock Position:  0.04792777344481767
Bond Position:  [-2.38084787]


portfolio before change:  [2.3315171]
curr_Stock_Price:  98.32532246609516
curr_Factors:  [98.32532247]
mat_Sqrt:  [[0.15]]
grads:  [0.01501367]
Stock Position:  0.015013673180157677
Bond Position:  [0.85529284]


portfolio before change:  [2.3294809]
curr_Stock_Price:  98.18613920310085
curr_Factors:  [98.1861392]
mat_Sqrt:  [[0.15]]
grads:  [0.0506894]
Stock Position:  0.050689399604935625
Bond Position:  [-2.64751554]


portfolio before change:  [2.30257811]
curr_Stock_Price:  97.65866562353982
curr_Factors:  [97.65866562]
mat_Sqrt:  [[0.15]]
grads:  [-0.06690533]
Stock Position:  -0.06690533007648512
Bond Position:  [8.83646337]


portfolio before change:  [2.29164614]
curr_Stock_Price:  97.83031510988657
curr_Factors:  [97.83031511]
mat_Sqrt:  [[0.15]]
grads:  [0.0293171]
Stock Position:  0.029317097421001966
Bond Position:  [-0.57645474]


portfolio before change:  [2.29239096]
curr_Stock_Price:  97.85694966805461
curr_Factors:  [97.85694967]
mat_Sqrt:  [[0.15]]
grads:  [0.0348738]
Stock Position:  0.034873801822129916
Bond Position:  [-1.12025291]


portfolio before change:  [2.27106214]
curr_Stock_Price:  97.2473574650465
curr_Factors:  [97.24735747]
mat_Sqrt:  [[0.15]]
grads:  [-0.18524623]
Stock Position:  -0.18524623245901814
Bond Position:  [20.28576873]


portfolio before change:  [2.34654399]
curr_Stock_Price:  96.84673423444161
curr_Factors:  [96.84673423]
mat_Sqrt:  [[0.15]]
grads:  [0.12820463]
Stock Position:  0.12820463051757225
Bond Position:  [-10.06965579]


portfolio before change:  [2.26091175]
curr_Stock_Price:  96.18370928849784
curr_Factors:  [96.18370929]
mat_Sqrt:  [[0.15]]
grads:  [-0.03815796]
Stock Position:  -0.038157963641648224
Bond Position:  [5.93108623]


portfolio before change:  [2.30689937]
curr_Stock_Price:  94.98823350909814
curr_Factors:  [94.98823351]
mat_Sqrt:  [[0.15]]
grads:  [-0.15429505]
Stock Position:  -0.15429504915216544
Bond Position:  [16.96311353]


portfolio before change:  [2.13431499]
curr_Stock_Price:  96.11363972957909
curr_Factors:  [96.11363973]
mat_Sqrt:  [[0.15]]
grads:  [-0.27650355]
Stock Position:  -0.27650355005197713
Bond Position:  [28.71007758]


portfolio before change:  [2.34318257]
curr_Stock_Price:  95.36474105140888
curr_Factors:  [95.36474105]
mat_Sqrt:  [[0.15]]
grads:  [0.12785823]
Stock Position:  0.12785822520963358
Bond Position:  [-9.84998397]


portfolio before change:  [2.40070285]
curr_Stock_Price:  95.81943154307874
curr_Factors:  [95.81943154]
mat_Sqrt:  [[0.15]]
grads:  [-0.49169439]
Stock Position:  -0.49169439401296305
Bond Position:  [49.51458017]


portfolio before change:  [1.88335275]
curr_Stock_Price:  96.87790376106322
curr_Factors:  [96.87790376]
mat_Sqrt:  [[0.15]]
grads:  [-0.18402767]
Stock Position:  -0.18402767408397785
Bond Position:  [19.71156805]


portfolio before change:  [1.86247444]
curr_Stock_Price:  96.99805045609692
curr_Factors:  [96.99805046]
mat_Sqrt:  [[0.15]]
grads:  [0.0046812]
Stock Position:  0.004681201690526534
Bond Position:  [1.408407]


portfolio before change:  [1.86323804]
curr_Stock_Price:  97.14236570424812
curr_Factors:  [97.1423657]
mat_Sqrt:  [[0.15]]
grads:  [0.0262752]
Stock Position:  0.0262752006640913
Bond Position:  [-0.68919711]


portfolio before change:  [1.87749517]
curr_Stock_Price:  97.68661284771322
curr_Factors:  [97.68661285]
mat_Sqrt:  [[0.15]]
grads:  [-0.00145034]
Stock Position:  -0.001450339583645311
Bond Position:  [2.01917393]


portfolio before change:  [1.87639654]
curr_Stock_Price:  98.53112217801069
curr_Factors:  [98.53112218]
mat_Sqrt:  [[0.15]]
grads:  [0.05001916]
Stock Position:  0.0500191587971218
Bond Position:  [-3.0520473]


portfolio before change:  [1.90161946]
curr_Stock_Price:  99.03920098540915
curr_Factors:  [99.03920099]
mat_Sqrt:  [[0.15]]
grads:  [0.08302075]
Stock Position:  0.08302074518137692
Bond Position:  [-6.32068881]


portfolio before change:  [1.89991361]
curr_Stock_Price:  99.02341225804452
curr_Factors:  [99.02341226]
mat_Sqrt:  [[0.15]]
grads:  [-0.06777315]
Stock Position:  -0.06777314740424516
Bond Position:  [8.61104193]


portfolio before change:  [1.89071968]
curr_Stock_Price:  99.16701095913693
curr_Factors:  [99.16701096]
mat_Sqrt:  [[0.15]]
grads:  [0.0158863]
Stock Position:  0.015886297207559248
Bond Position:  [0.31532307]


portfolio before change:  [1.88544224]
curr_Stock_Price:  98.83356916317992
curr_Factors:  [98.83356916]
mat_Sqrt:  [[0.15]]
grads:  [-0.0777791]
Stock Position:  -0.07777910293479934
Bond Position:  [9.57262858]


portfolio before change:  [1.93619839]
curr_Stock_Price:  98.1886935022268
curr_Factors:  [98.1886935]
mat_Sqrt:  [[0.15]]
grads:  [-0.02422058]
Stock Position:  -0.024220579669873173
Bond Position:  [4.31438547]


portfolio before change:  [1.94721294]
curr_Stock_Price:  97.74506714699731
curr_Factors:  [97.74506715]
mat_Sqrt:  [[0.15]]
grads:  [-0.13060216]
Stock Position:  -0.13060216426121857
Bond Position:  [14.71293025]


portfolio before change:  [1.95284662]
curr_Stock_Price:  97.70897203967021
curr_Factors:  [97.70897204]
mat_Sqrt:  [[0.15]]
grads:  [0.12351942]
Stock Position:  0.12351942236113438
Bond Position:  [-10.11610916]


portfolio before change:  [2.0537231]
curr_Stock_Price:  98.53077598693176
curr_Factors:  [98.53077599]
mat_Sqrt:  [[0.15]]
grads:  [0.12100442]
Stock Position:  0.1210044214627172
Bond Position:  [-9.86893645]


portfolio before change:  [2.07839035]
curr_Stock_Price:  98.73972769525068
curr_Factors:  [98.7397277]
mat_Sqrt:  [[0.15]]
grads:  [-0.0982923]
Stock Position:  -0.09829230184035731
Bond Position:  [11.78374547]


portfolio before change:  [2.08689465]
curr_Stock_Price:  98.66070018841624
curr_Factors:  [98.66070019]
mat_Sqrt:  [[0.15]]
grads:  [0.04218005]
Stock Position:  0.042180052654704335
Bond Position:  [-2.07461888]


portfolio before change:  [2.08110741]
curr_Stock_Price:  98.52657094090056
curr_Factors:  [98.52657094]
mat_Sqrt:  [[0.15]]
grads:  [-0.01601036]
Stock Position:  -0.01601035708596257
Bond Position:  [3.65855299]


portfolio before change:  [2.06984314]
curr_Stock_Price:  99.2444147490091
curr_Factors:  [99.24441475]
mat_Sqrt:  [[0.15]]
grads:  [0.07565421]
Stock Position:  0.07565421404056734
Bond Position:  [-5.43841506]


portfolio before change:  [2.09524746]
curr_Stock_Price:  99.58470287481346
curr_Factors:  [99.58470287]
mat_Sqrt:  [[0.15]]
grads:  [-0.0004859]
Stock Position:  -0.00048590228883337895
Bond Position:  [2.14363589]


portfolio before change:  [2.09570544]
curr_Stock_Price:  98.91790120614995
curr_Factors:  [98.91790121]
mat_Sqrt:  [[0.15]]
grads:  [-0.09218637]
Stock Position:  -0.09218637130793544
Bond Position:  [11.21458781]


portfolio before change:  [2.0319505]
curr_Stock_Price:  99.61709210364036
curr_Factors:  [99.6170921]
mat_Sqrt:  [[0.15]]
grads:  [-0.01646342]
Stock Position:  -0.01646342158932638
Bond Position:  [3.67198868]


portfolio before change:  [2.0368373]
curr_Stock_Price:  99.33420476511675
curr_Factors:  [99.33420477]
mat_Sqrt:  [[0.15]]
grads:  [-0.01605003]
Stock Position:  -0.016050033552508336
Bond Position:  [3.63115462]


portfolio before change:  [2.03046564]
curr_Stock_Price:  99.74533230769174
curr_Factors:  [99.74533231]
mat_Sqrt:  [[0.15]]
grads:  [0.03390901]
Stock Position:  0.033909014388742144
Bond Position:  [-1.35180027]


portfolio before change:  [2.04216431]
curr_Stock_Price:  100.09282552641307
curr_Factors:  [100.09282553]
mat_Sqrt:  [[0.15]]
grads:  [-0.07791471]
Stock Position:  -0.07791470701649407
Bond Position:  [9.84086748]


portfolio before change:  [2.06083921]
curr_Stock_Price:  99.86103577267788
curr_Factors:  [99.86103577]
mat_Sqrt:  [[0.15]]
grads:  [0.01986556]
Stock Position:  0.01986555658940153
Bond Position:  [0.07704415]


portfolio before change:  [2.0846666]
curr_Stock_Price:  101.06022561289649
curr_Factors:  [101.06022561]
mat_Sqrt:  [[0.15]]
grads:  [0.00890102]
Stock Position:  0.008901019151683417
Bond Position:  [1.1851276]


portfolio before change:  [2.08991955]
curr_Stock_Price:  101.64205577267794
curr_Factors:  [101.64205577]
mat_Sqrt:  [[0.15]]
grads:  [-0.09123194]
Stock Position:  -0.0912319372001236
Bond Position:  [11.3629212]


portfolio before change:  [2.08697021]
curr_Stock_Price:  101.68216839142843
curr_Factors:  [101.68216839]
mat_Sqrt:  [[0.15]]
grads:  [-0.02496215]
Stock Position:  -0.024962149557920667
Bond Position:  [4.6251757]


portfolio before change:  [2.0697886]
curr_Stock_Price:  102.38205567752235
curr_Factors:  [102.38205568]
mat_Sqrt:  [[0.15]]
grads:  [0.02245747]
Stock Position:  0.02245747207441358
Bond Position:  [-0.22945356]


portfolio before change:  [2.06325043]
curr_Stock_Price:  102.09155894981507
curr_Factors:  [102.09155895]
mat_Sqrt:  [[0.15]]
grads:  [-0.01760674]
Stock Position:  -0.01760674219507404
Bond Position:  [3.86075019]


portfolio before change:  [2.05116158]
curr_Stock_Price:  102.7918678072384
curr_Factors:  [102.79186781]
mat_Sqrt:  [[0.15]]
grads:  [-0.02289546]
Stock Position:  -0.022895455943837253
Bond Position:  [4.40462826]


portfolio before change:  [2.05497504]
curr_Stock_Price:  102.63733228138635
curr_Factors:  [102.63733228]
mat_Sqrt:  [[0.15]]
grads:  [0.02349605]
Stock Position:  0.023496053642996017
Bond Position:  [-0.35659722]


portfolio before change:  [2.06268494]
curr_Stock_Price:  102.96641693623768
curr_Factors:  [102.96641694]
mat_Sqrt:  [[0.15]]
grads:  [0.01041846]
Stock Position:  0.010418456567691246
Bond Position:  [0.9899338]


portfolio before change:  [2.06101771]
curr_Stock_Price:  102.80045142089106
curr_Factors:  [102.80045142]
mat_Sqrt:  [[0.15]]
grads:  [0.0238017]
Stock Position:  0.023801703394262158
Bond Position:  [-0.38580814]


portfolio before change:  [2.07350677]
curr_Stock_Price:  103.32617738566674
curr_Factors:  [103.32617739]
mat_Sqrt:  [[0.15]]
grads:  [-0.03400988]
Stock Position:  -0.034009884297710874
Bond Position:  [5.58761811]


portfolio before change:  [2.08306715]
curr_Stock_Price:  103.05534024273119
curr_Factors:  [103.05534024]
mat_Sqrt:  [[0.15]]
grads:  [0.06185909]
Stock Position:  0.06185909054025851
Bond Position:  [-4.29184247]


portfolio before change:  [2.07538465]
curr_Stock_Price:  102.93548319539661
curr_Factors:  [102.9354832]
mat_Sqrt:  [[0.15]]
grads:  [-0.03286607]
Stock Position:  -0.03286606774479097
Bond Position:  [5.45846922]


portfolio before change:  [2.12765675]
curr_Stock_Price:  101.35540576149042
curr_Factors:  [101.35540576]
mat_Sqrt:  [[0.15]]
grads:  [-0.11784904]
Stock Position:  -0.11784903560965404
Bond Position:  [14.07229357]


portfolio before change:  [2.15932273]
curr_Stock_Price:  101.09416957456578
curr_Factors:  [101.09416957]
mat_Sqrt:  [[0.15]]
grads:  [0.08966583]
Stock Position:  0.08966583002718131
Bond Position:  [-6.9053699]


portfolio before change:  [2.10405045]
curr_Stock_Price:  100.48255776073704
curr_Factors:  [100.48255776]
mat_Sqrt:  [[0.15]]
grads:  [0.05516271]
Stock Position:  0.05516271086311273
Bond Position:  [-3.43883983]


portfolio before change:  [2.10557395]
curr_Stock_Price:  100.51407241812294
curr_Factors:  [100.51407242]
mat_Sqrt:  [[0.15]]
grads:  [0.05481974]
Stock Position:  0.05481973655461415
Bond Position:  [-3.40458102]


portfolio before change:  [2.10234067]
curr_Stock_Price:  100.45897397737701
curr_Factors:  [100.45897398]
mat_Sqrt:  [[0.15]]
grads:  [-0.08413341]
Stock Position:  -0.08413340650598017
Bond Position:  [10.55429637]


portfolio before change:  [2.17963873]
curr_Stock_Price:  99.54805882563294
curr_Factors:  [99.54805883]
mat_Sqrt:  [[0.15]]
grads:  [-0.08357613]
Stock Position:  -0.08357613385217036
Bond Position:  [10.49948062]


portfolio before change:  [2.15595715]
curr_Stock_Price:  99.83926414228148
curr_Factors:  [99.83926414]
mat_Sqrt:  [[0.15]]
grads:  [-0.01443856]
Stock Position:  -0.014438555833384027
Bond Position:  [3.59749194]


portfolio before change:  [2.16146233]
curr_Stock_Price:  99.47355413758913
curr_Factors:  [99.47355414]
mat_Sqrt:  [[0.15]]
grads:  [-0.08264663]
Stock Position:  -0.08264663294334121
Bond Position:  [10.38261664]


portfolio before change:  [2.10637011]
curr_Stock_Price:  100.14800568570115
curr_Factors:  [100.14800569]
mat_Sqrt:  [[0.15]]
grads:  [0.28713151]
Stock Position:  0.2871315070590849
Bond Position:  [-26.64927769]


portfolio before change:  [1.85826258]
curr_Stock_Price:  99.28971637487945
curr_Factors:  [99.28971637]
mat_Sqrt:  [[0.15]]
grads:  [0.08984272]
Stock Position:  0.08984271938161546
Bond Position:  [-7.06219555]


portfolio before change:  [1.85923089]
curr_Stock_Price:  99.30540730114171
curr_Factors:  [99.3054073]
mat_Sqrt:  [[0.15]]
grads:  [0.01333731]
Stock Position:  0.013337312481410644
Bond Position:  [0.53476364]


portfolio before change:  [1.85796369]
curr_Stock_Price:  99.20788966038897
curr_Factors:  [99.20788966]
mat_Sqrt:  [[0.15]]
grads:  [0.04880278]
Stock Position:  0.048802780217677394
Bond Position:  [-2.98365714]


portfolio before change:  [1.87424568]
curr_Stock_Price:  99.54533903613695
curr_Factors:  [99.54533904]
mat_Sqrt:  [[0.15]]
grads:  [-0.09762753]
Stock Position:  -0.09762753138129439
Bond Position:  [11.59261139]


portfolio before change:  [1.84624519]
curr_Stock_Price:  99.83957002013256
curr_Factors:  [99.83957002]
mat_Sqrt:  [[0.15]]
grads:  [-0.03984725]
Stock Position:  -0.039847248102891426
Bond Position:  [5.82457731]


portfolio before change:  [1.83232595]
curr_Stock_Price:  100.19802114324483
curr_Factors:  [100.19802114]
mat_Sqrt:  [[0.15]]
grads:  [-0.00731253]
Stock Position:  -0.007312530729895421
Bond Position:  [2.56502706]


portfolio before change:  [1.84067681]
curr_Stock_Price:  99.07795211802483
curr_Factors:  [99.07795212]
mat_Sqrt:  [[0.15]]
grads:  [0.01046555]
Stock Position:  0.010465548811415206
Bond Position:  [0.80377166]


portfolio before change:  [1.84835166]
curr_Stock_Price:  99.80649615727759
curr_Factors:  [99.80649616]
mat_Sqrt:  [[0.15]]
grads:  [0.05870863]
Stock Position:  0.05870863130389699
Bond Position:  [-4.01115113]


portfolio before change:  [1.88121427]
curr_Stock_Price:  100.37052429433291
curr_Factors:  [100.37052429]
mat_Sqrt:  [[0.15]]
grads:  [0.06996205]
Stock Position:  0.06996205119276981
Bond Position:  [-5.14091349]


portfolio before change:  [1.83290625]
curr_Stock_Price:  99.6846281029924
curr_Factors:  [99.6846281]
mat_Sqrt:  [[0.15]]
grads:  [-0.048462]
Stock Position:  -0.04846200436180708
Bond Position:  [6.66382313]


portfolio before change:  [1.81739649]
curr_Stock_Price:  100.01326219547579
curr_Factors:  [100.0132622]
mat_Sqrt:  [[0.15]]
grads:  [-0.01396971]
Stock Position:  -0.013969706911040025
Bond Position:  [3.21455245]


portfolio before change:  [1.81824431]
curr_Stock_Price:  99.96695407003303
curr_Factors:  [99.96695407]
mat_Sqrt:  [[0.15]]
grads:  [-0.05750561]
Stock Position:  -0.05750561255770026
Bond Position:  [7.56690524]


portfolio before change:  [1.79117644]
curr_Stock_Price:  100.44587804673942
curr_Factors:  [100.44587805]
mat_Sqrt:  [[0.15]]
grads:  [0.0303667]
Stock Position:  0.03036669582609869
Bond Position:  [-1.25903298]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.79117644]
Stock Price:  101.35990265459397
PL:  [0.43127379]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.42392017e-02]
 [-2.14088371e-04]
 [-2.48522720e-04]
 [ 1.48431977e-04]
 [-2.36553620e-02]
 [ 1.46218547e-03]
 [ 3.17386066e-03]
 [-1.30498639e-02]
 [-4.09039431e-03]
 [ 3.05672426e-02]
 [ 9.94593321e-03]
 [-1.09063411e-02]
 [ 8.46597600e-03]
 [ 5.65255926e-03]
 [-2.75623732e-02]
 [ 1.86988279e-02]
 [-4.34492950e-03]
 [-3.03219835e-03]
 [-9.19488863e-03]
 [ 1.45415007e-02]
 [-3.75097828e-02]
 [-3.32317254e-02]
 [ 1.72682018e-03]
 [-3.32746946e-03]
 [-1.08777676e-02]
 [ 1.56309672e-02]
 [ 2.35144052e-02]
 [ 1.52344221e-01]
 [-1.92795784e-03]
 [ 2.18017955e-02]
 [-3.50454469e-03]
 [-6.17636502e-02]
 [ 2.48094132e-02]
 [ 1.12018541e-02]
 [-3.57057952e-02]
 [ 8.81511194e-03]
 [ 1.87322059e-03]
 [-1.89615252e-02]
 [ 1.27855418e-02]
 [-2.50344920e-02]
 [ 7.73892725e-02]
 [ 7.25477882e-03]
 [ 1.66754988e-02]
 [-1.16881338e-02]
 [-9.86571513e-03]
 [-3.21707450e-02]
 [-1.25731022e-02]
 [ 3.60173628e-03]
 [-3.26069956e-03]
 [-2.17567406e-02]
 [-4.91319909e-03]
 [ 2.92495570e-03]
 [ 4.53594031e-03]
 [-2.92714728e-03]
 [ 1.92366721e-02]
 [ 9.04003063e-03]
 [-2.46587895e-03]
 [ 1.56272760e-02]
 [ 1.28775848e-02]
 [-8.83127643e-03]
 [-1.27955797e-02]
 [-3.51050442e-02]
 [-1.29969717e-02]
 [-4.14173445e-03]
 [-5.60655680e-03]
 [ 4.47901410e-02]
 [ 8.46474366e-03]
 [ 1.69533417e-03]
 [ 1.55579175e-02]
 [-1.96704897e-02]
 [ 2.37641372e-02]
 [-1.98369343e-02]
 [-5.95056007e-03]
 [ 7.89341703e-03]
 [-9.16079417e-03]
 [ 3.70031590e-03]
 [ 1.50837444e-02]
 [-1.35659012e-02]
 [-4.80603035e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.18907961]
curr_Stock_Price:  99.87934033196099
curr_Factors:  [99.87934033]
mat_Sqrt:  [[0.15]]
grads:  [-0.22826134]
Stock Position:  -0.22826134477056503
Bond Position:  [22.98767215]


portfolio before change:  [0.22253646]
curr_Stock_Price:  99.73906222911373
curr_Factors:  [99.73906223]
mat_Sqrt:  [[0.15]]
grads:  [-0.00142726]
Stock Position:  -0.0014272558050021382
Bond Position:  [0.36488961]


portfolio before change:  [0.22293526]
curr_Stock_Price:  99.47562309013466
curr_Factors:  [99.47562309]
mat_Sqrt:  [[0.15]]
grads:  [-0.00165682]
Stock Position:  -0.0016568181320263313
Bond Position:  [0.38774827]


portfolio before change:  [0.22348681]
curr_Stock_Price:  99.15735300372621
curr_Factors:  [99.157353]
mat_Sqrt:  [[0.15]]
grads:  [0.00098955]
Stock Position:  0.0009895465120733176
Bond Position:  [0.125366]


portfolio before change:  [0.22244451]
curr_Stock_Price:  98.09612556659371
curr_Factors:  [98.09612557]
mat_Sqrt:  [[0.15]]
grads:  [-0.15770241]
Stock Position:  -0.15770241331733081
Bond Position:  [15.69244025]


portfolio before change:  [0.26704218]
curr_Stock_Price:  97.81954858736258
curr_Factors:  [97.81954859]
mat_Sqrt:  [[0.15]]
grads:  [0.0097479]
Stock Position:  0.009747903116865889
Bond Position:  [-0.68649331]


portfolio before change:  [0.2592262]
curr_Stock_Price:  97.02213879634814
curr_Factors:  [97.0221388]
mat_Sqrt:  [[0.15]]
grads:  [0.02115907]
Stock Position:  0.021159071060517974
Bond Position:  [-1.79367213]


portfolio before change:  [0.26441644]
curr_Stock_Price:  97.27273339353705
curr_Factors:  [97.27273339]
mat_Sqrt:  [[0.15]]
grads:  [-0.08699909]
Stock Position:  -0.08699909293728728
Bond Position:  [8.72705601]


portfolio before change:  [0.29936787]
curr_Stock_Price:  96.87725826864802
curr_Factors:  [96.87725827]
mat_Sqrt:  [[0.15]]
grads:  [-0.0272693]
Stock Position:  -0.02726929541519254
Bond Position:  [2.94114245]


portfolio before change:  [0.28363864]
curr_Stock_Price:  97.46081050527846
curr_Factors:  [97.46081051]
mat_Sqrt:  [[0.15]]
grads:  [0.20378162]
Stock Position:  0.20378161709803463
Bond Position:  [-19.57708293]


portfolio before change:  [0.18774496]
curr_Stock_Price:  96.99624418548878
curr_Factors:  [96.99624419]
mat_Sqrt:  [[0.15]]
grads:  [0.06630622]
Stock Position:  0.06630622138147063
Bond Position:  [-6.24370948]


portfolio before change:  [0.21196729]
curr_Stock_Price:  97.36743973045562
curr_Factors:  [97.36743973]
mat_Sqrt:  [[0.15]]
grads:  [-0.07270894]
Stock Position:  -0.07270894098712437
Bond Position:  [7.29145072]


portfolio before change:  [0.20803131]
curr_Stock_Price:  97.42784093680446
curr_Factors:  [97.42784094]
mat_Sqrt:  [[0.15]]
grads:  [0.05643984]
Stock Position:  0.05643984003072495
Bond Position:  [-5.29078045]


portfolio before change:  [0.22311486]
curr_Stock_Price:  97.70094998195994
curr_Factors:  [97.70094998]
mat_Sqrt:  [[0.15]]
grads:  [0.03768373]
Stock Position:  0.037683728419314506
Bond Position:  [-3.45862121]


portfolio before change:  [0.20639273]
curr_Stock_Price:  97.26293704881282
curr_Factors:  [97.26293705]
mat_Sqrt:  [[0.15]]
grads:  [-0.18374915]
Stock Position:  -0.18374915449846288
Bond Position:  [18.07837517]


portfolio before change:  [0.25669539]
curr_Stock_Price:  96.99532909817988
curr_Factors:  [96.9953291]
mat_Sqrt:  [[0.15]]
grads:  [0.12465885]
Stock Position:  0.12465885293078127
Bond Position:  [-11.83463107]


portfolio before change:  [0.25753247]
curr_Stock_Price:  97.00797774775738
curr_Factors:  [97.00797775]
mat_Sqrt:  [[0.15]]
grads:  [-0.0289662]
Stock Position:  -0.02896619666997095
Bond Position:  [3.06748464]


portfolio before change:  [0.24257068]
curr_Stock_Price:  97.53112260236453
curr_Factors:  [97.5311226]
mat_Sqrt:  [[0.15]]
grads:  [-0.02021466]
Stock Position:  -0.020214655676632914
Bond Position:  [2.21412874]


portfolio before change:  [0.24725614]
curr_Stock_Price:  97.30618318197718
curr_Factors:  [97.30618318]
mat_Sqrt:  [[0.15]]
grads:  [-0.06129926]
Stock Position:  -0.06129925751206811
Bond Position:  [6.21205292]


portfolio before change:  [0.26290512]
curr_Stock_Price:  97.05722884707633
curr_Factors:  [97.05722885]
mat_Sqrt:  [[0.15]]
grads:  [0.09694334]
Stock Position:  0.09694333799639358
Bond Position:  [-9.14614662]


portfolio before change:  [0.25886916]
curr_Stock_Price:  97.02149346552463
curr_Factors:  [97.02149347]
mat_Sqrt:  [[0.15]]
grads:  [-0.25006522]
Stock Position:  -0.2500652186106203
Bond Position:  [24.52057014]


portfolio before change:  [0.57384204]
curr_Stock_Price:  95.76805929091452
curr_Factors:  [95.76805929]
mat_Sqrt:  [[0.15]]
grads:  [-0.22154484]
Stock Position:  -0.22154483617264586
Bond Position:  [21.79076104]


portfolio before change:  [0.63061957]
curr_Stock_Price:  95.51792678911778
curr_Factors:  [95.51792679]
mat_Sqrt:  [[0.15]]
grads:  [0.01151213]
Stock Position:  0.011512134501946426
Bond Position:  [-0.46899565]


portfolio before change:  [0.62974562]
curr_Stock_Price:  95.44455778699415
curr_Factors:  [95.44455779]
mat_Sqrt:  [[0.15]]
grads:  [-0.02218313]
Stock Position:  -0.022183129737462386
Bond Position:  [2.74700463]


portfolio before change:  [0.63905488]
curr_Stock_Price:  95.03264266224846
curr_Factors:  [95.03264266]
mat_Sqrt:  [[0.15]]
grads:  [-0.07251845]
Stock Position:  -0.072518450975139
Bond Position:  [7.53067492]


portfolio before change:  [0.6803895]
curr_Stock_Price:  94.4691455551403
curr_Factors:  [94.46914556]
mat_Sqrt:  [[0.15]]
grads:  [0.10420645]
Stock Position:  0.10420644801712005
Bond Position:  [-9.16390461]


portfolio before change:  [0.61602747]
curr_Stock_Price:  93.85700235962632
curr_Factors:  [93.85700236]
mat_Sqrt:  [[0.15]]
grads:  [0.1567627]
Stock Position:  0.15676270128440437
Bond Position:  [-14.09724976]


portfolio before change:  [0.49736635]
curr_Stock_Price:  93.1056755827794
curr_Factors:  [93.10567558]
mat_Sqrt:  [[0.15]]
grads:  [1.01562814]
Stock Position:  1.0156281380660923
Bond Position:  [-94.06337759]


portfolio before change:  [0.4810243]
curr_Stock_Price:  93.09537367676761
curr_Factors:  [93.09537368]
mat_Sqrt:  [[0.15]]
grads:  [-0.01285305]
Stock Position:  -0.012853052256327411
Bond Position:  [1.677584]


portfolio before change:  [0.47013712]
curr_Stock_Price:  93.95058132300946
curr_Factors:  [93.95058132]
mat_Sqrt:  [[0.15]]
grads:  [0.1453453]
Stock Position:  0.14534530364331597
Bond Position:  [-13.18513865]


portfolio before change:  [0.56457019]
curr_Stock_Price:  94.60596657766772
curr_Factors:  [94.60596658]
mat_Sqrt:  [[0.15]]
grads:  [-0.02336363]
Stock Position:  -0.023363631273998414
Bond Position:  [2.77490911]


portfolio before change:  [0.56775176]
curr_Stock_Price:  94.47721380463737
curr_Factors:  [94.4772138]
mat_Sqrt:  [[0.15]]
grads:  [-0.41175767]
Stock Position:  -0.4117576677975208
Bond Position:  [39.46946898]


portfolio before change:  [0.47069294]
curr_Stock_Price:  94.71892331550002
curr_Factors:  [94.71892332]
mat_Sqrt:  [[0.15]]
grads:  [0.16539609]
Stock Position:  0.16539608806337575
Bond Position:  [-15.19544644]


portfolio before change:  [0.49174695]
curr_Stock_Price:  94.85196007881967
curr_Factors:  [94.85196008]
mat_Sqrt:  [[0.15]]
grads:  [0.07467903]
Stock Position:  0.07467902713130646
Bond Position:  [-6.59170515]


portfolio before change:  [0.52800159]
curr_Stock_Price:  95.34294977974422
curr_Factors:  [95.34294978]
mat_Sqrt:  [[0.15]]
grads:  [-0.23803863]
Stock Position:  -0.23803863438237363
Bond Position:  [23.22330715]


portfolio before change:  [0.75839246]
curr_Stock_Price:  94.38117577245941
curr_Factors:  [94.38117577]
mat_Sqrt:  [[0.15]]
grads:  [0.05876741]
Stock Position:  0.05876741291380972
Bond Position:  [-4.78814506]


portfolio before change:  [0.75210174]
curr_Stock_Price:  94.2792236913083
curr_Factors:  [94.27922369]
mat_Sqrt:  [[0.15]]
grads:  [0.01248814]
Stock Position:  0.012488137279853043
Bond Position:  [-0.42527015]


portfolio before change:  [0.74886258]
curr_Stock_Price:  94.02197317268816
curr_Factors:  [94.02197317]
mat_Sqrt:  [[0.15]]
grads:  [-0.12641017]
Stock Position:  -0.12641016827751517
Bond Position:  [12.63419603]


portfolio before change:  [0.86614104]
curr_Stock_Price:  93.10045870435833
curr_Factors:  [93.1004587]
mat_Sqrt:  [[0.15]]
grads:  [0.08523695]
Stock Position:  0.0852369450527489
Bond Position:  [-7.06945765]


portfolio before change:  [0.82606305]
curr_Stock_Price:  92.63544749328356
curr_Factors:  [92.63544749]
mat_Sqrt:  [[0.15]]
grads:  [-0.16689661]
Stock Position:  -0.16689661353677093
Bond Position:  [16.28660553]


portfolio before change:  [1.03696833]
curr_Stock_Price:  91.37785854252772
curr_Factors:  [91.37785854]
mat_Sqrt:  [[0.15]]
grads:  [0.51592848]
Stock Position:  0.5159284834494687
Bond Position:  [-46.10747165]


portfolio before change:  [0.97237237]
curr_Stock_Price:  91.25824090219217
curr_Factors:  [91.2582409]
mat_Sqrt:  [[0.15]]
grads:  [0.04836519]
Stock Position:  0.0483651921343613
Bond Position:  [-3.44134998]


portfolio before change:  [0.98632509]
curr_Stock_Price:  91.55117479704641
curr_Factors:  [91.5511748]
mat_Sqrt:  [[0.15]]
grads:  [0.11116999]
Stock Position:  0.11116999191404803
Bond Position:  [-9.19141828]


portfolio before change:  [0.99740248]
curr_Stock_Price:  91.65598612143222
curr_Factors:  [91.65598612]
mat_Sqrt:  [[0.15]]
grads:  [-0.07792089]
Stock Position:  -0.07792089231146253
Bond Position:  [8.1393187]


portfolio before change:  [1.04352229]
curr_Stock_Price:  91.07063494994969
curr_Factors:  [91.07063495]
mat_Sqrt:  [[0.15]]
grads:  [-0.06577143]
Stock Position:  -0.0657714341727288
Bond Position:  [7.03336856]


portfolio before change:  [1.03951731]
curr_Stock_Price:  91.13821106848039
curr_Factors:  [91.13821107]
mat_Sqrt:  [[0.15]]
grads:  [-0.21447163]
Stock Position:  -0.214471633663052
Bond Position:  [20.58607833]


portfolio before change:  [1.06258184]
curr_Stock_Price:  91.03666914064361
curr_Factors:  [91.03666914]
mat_Sqrt:  [[0.15]]
grads:  [-0.08382068]
Stock Position:  -0.08382068123135993
Bond Position:  [8.69333747]


portfolio before change:  [0.95612369]
curr_Stock_Price:  92.3132217150102
curr_Factors:  [92.31322172]
mat_Sqrt:  [[0.15]]
grads:  [0.02401158]
Stock Position:  0.024011575175632623
Bond Position:  [-1.26046218]


portfolio before change:  [0.96697996]
curr_Stock_Price:  92.76862943075784
curr_Factors:  [92.76862943]
mat_Sqrt:  [[0.15]]
grads:  [-0.021738]
Stock Position:  -0.02173799706638106
Bond Position:  [2.98358416]


portfolio before change:  [0.97344318]
curr_Stock_Price:  92.47988419398625
curr_Factors:  [92.47988419]
mat_Sqrt:  [[0.15]]
grads:  [-0.14504494]
Stock Position:  -0.1450449376654781
Bond Position:  [14.38718222]


portfolio before change:  [1.01068144]
curr_Stock_Price:  92.22934785961931
curr_Factors:  [92.22934786]
mat_Sqrt:  [[0.15]]
grads:  [-0.03275466]
Stock Position:  -0.032754660626141074
Bond Position:  [4.03162243]


portfolio before change:  [1.0257955]
curr_Stock_Price:  91.77560852867471
curr_Factors:  [91.77560853]
mat_Sqrt:  [[0.15]]
grads:  [0.0194997]
Stock Position:  0.01949970469329048
Bond Position:  [-0.76380176]


portfolio before change:  [1.03047073]
curr_Stock_Price:  92.01781569197037
curr_Factors:  [92.01781569]
mat_Sqrt:  [[0.15]]
grads:  [0.0302396]
Stock Position:  0.030239602075863726
Bond Position:  [-1.7521114]


portfolio before change:  [1.06434055]
curr_Stock_Price:  93.14148563162256
curr_Factors:  [93.14148563]
mat_Sqrt:  [[0.15]]
grads:  [-0.01951432]
Stock Position:  -0.019514315209659888
Bond Position:  [2.88193286]


portfolio before change:  [1.04776566]
curr_Stock_Price:  94.00008680034581
curr_Factors:  [94.0000868]
mat_Sqrt:  [[0.15]]
grads:  [0.12824448]
Stock Position:  0.12824448087553864
Bond Position:  [-11.00722667]


portfolio before change:  [0.96276638]
curr_Stock_Price:  93.34266038664914
curr_Factors:  [93.34266039]
mat_Sqrt:  [[0.15]]
grads:  [0.06026687]
Stock Position:  0.06026687086463533
Bond Position:  [-4.66270368]


portfolio before change:  [0.94951351]
curr_Stock_Price:  93.12759289003732
curr_Factors:  [93.12759289]
mat_Sqrt:  [[0.15]]
grads:  [-0.01643919]
Stock Position:  -0.016439193000216037
Bond Position:  [2.48045598]


portfolio before change:  [0.94070498]
curr_Stock_Price:  93.67284826730405
curr_Factors:  [93.67284827]
mat_Sqrt:  [[0.15]]
grads:  [0.10418184]
Stock Position:  0.10418183972561854
Bond Position:  [-8.81830468]


portfolio before change:  [0.93351453]
curr_Stock_Price:  93.60912037431724
curr_Factors:  [93.60912037]
mat_Sqrt:  [[0.15]]
grads:  [0.08585057]
Stock Position:  0.08585056539422738
Bond Position:  [-7.10288138]


portfolio before change:  [0.93576333]
curr_Stock_Price:  93.64048579637118
curr_Factors:  [93.6404858]
mat_Sqrt:  [[0.15]]
grads:  [-0.05887518]
Stock Position:  -0.058875176198277146
Bond Position:  [6.44886343]


portfolio before change:  [1.00329298]
curr_Stock_Price:  92.50033488267513
curr_Factors:  [92.50033488]
mat_Sqrt:  [[0.15]]
grads:  [-0.08530386]
Stock Position:  -0.08530386489919765
Bond Position:  [8.89392905]


portfolio before change:  [0.92258583]
curr_Stock_Price:  93.45296504453947
curr_Factors:  [93.45296504]
mat_Sqrt:  [[0.15]]
grads:  [-0.23403363]
Stock Position:  -0.23403362793274768
Bond Position:  [22.79372228]


portfolio before change:  [0.96124151]
curr_Stock_Price:  93.29388098214403
curr_Factors:  [93.29388098]
mat_Sqrt:  [[0.15]]
grads:  [-0.08664648]
Stock Position:  -0.0866464778572179
Bond Position:  [9.0448277]


portfolio before change:  [0.94337121]
curr_Stock_Price:  93.50664919997767
curr_Factors:  [93.5066492]
mat_Sqrt:  [[0.15]]
grads:  [-0.02761156]
Stock Position:  -0.02761156301637069
Bond Position:  [3.52523595]


portfolio before change:  [0.93492016]
curr_Stock_Price:  93.8206983273805
curr_Factors:  [93.82069833]
mat_Sqrt:  [[0.15]]
grads:  [-0.03737705]
Stock Position:  -0.03737704531143961
Bond Position:  [4.44166065]


portfolio before change:  [0.93466073]
curr_Stock_Price:  93.83506650184583
curr_Factors:  [93.8350665]
mat_Sqrt:  [[0.15]]
grads:  [0.29860094]
Stock Position:  0.2986009398235464
Bond Position:  [-27.08457832]


portfolio before change:  [0.8568297]
curr_Stock_Price:  93.58008341629687
curr_Factors:  [93.58008342]
mat_Sqrt:  [[0.15]]
grads:  [0.05643162]
Stock Position:  0.05643162437137805
Bond Position:  [-4.42404642]


portfolio before change:  [0.85759531]
curr_Stock_Price:  93.59855033634034
curr_Factors:  [93.59855034]
mat_Sqrt:  [[0.15]]
grads:  [0.01130223]
Stock Position:  0.011302227820728233
Bond Position:  [-0.20027683]


portfolio before change:  [0.86027768]
curr_Stock_Price:  93.83698958679534
curr_Factors:  [93.83698959]
mat_Sqrt:  [[0.15]]
grads:  [0.10371945]
Stock Position:  0.10371944996348466
Bond Position:  [-8.87244326]


portfolio before change:  [0.86078513]
curr_Stock_Price:  93.8472286212074
curr_Factors:  [93.84722862]
mat_Sqrt:  [[0.15]]
grads:  [-0.1311366]
Stock Position:  -0.13113659830415517
Bond Position:  [13.16759145]


portfolio before change:  [0.86770899]
curr_Stock_Price:  93.80070568367249
curr_Factors:  [93.80070568]
mat_Sqrt:  [[0.15]]
grads:  [0.15842758]
Stock Position:  0.15842758126344209
Bond Position:  [-13.99290994]


portfolio before change:  [0.90590137]
curr_Stock_Price:  94.04729762408763
curr_Factors:  [94.04729762]
mat_Sqrt:  [[0.15]]
grads:  [-0.13224623]
Stock Position:  -0.13224622883858475
Bond Position:  [13.34330181]


portfolio before change:  [0.93192303]
curr_Stock_Price:  93.85683711795483
curr_Factors:  [93.85683712]
mat_Sqrt:  [[0.15]]
grads:  [-0.0396704]
Stock Position:  -0.039670400495047345
Bond Position:  [4.65526135]


portfolio before change:  [0.92763101]
curr_Stock_Price:  93.97236368463327
curr_Factors:  [93.97236368]
mat_Sqrt:  [[0.15]]
grads:  [0.05262278]
Stock Position:  0.05262278022427362
Bond Position:  [-4.01745603]


portfolio before change:  [0.92475451]
curr_Stock_Price:  93.92247266259083
curr_Factors:  [93.92247266]
mat_Sqrt:  [[0.15]]
grads:  [-0.06107196]
Stock Position:  -0.061071961137060725
Bond Position:  [6.66078411]


portfolio before change:  [0.92624592]
curr_Stock_Price:  93.9048688359939
curr_Factors:  [93.90486884]
mat_Sqrt:  [[0.15]]
grads:  [0.02466877]
Stock Position:  0.0246687726790752
Bond Position:  [-1.39027194]


portfolio before change:  [0.9426846]
curr_Stock_Price:  94.57476722426597
curr_Factors:  [94.57476722]
mat_Sqrt:  [[0.15]]
grads:  [0.1005583]
Stock Position:  0.1005582959900364
Bond Position:  [-8.56759284]


portfolio before change:  [0.98274923]
curr_Stock_Price:  94.97851433544002
curr_Factors:  [94.97851434]
mat_Sqrt:  [[0.15]]
grads:  [-0.09043934]
Stock Position:  -0.09043934146181636
Bond Position:  [9.57254352]


portfolio before change:  [0.97833957]
curr_Stock_Price:  95.0338880523489
curr_Factors:  [95.03388805]
mat_Sqrt:  [[0.15]]
grads:  [-0.32040202]
Stock Position:  -0.32040202360069403
Bond Position:  [31.42738961]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.97833957]
Stock Price:  94.32343384366375
PL:  [0.97833957]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.99442225e-02]
 [ 1.84240901e-03]
 [ 5.59734436e-03]
 [ 4.05217650e-03]
 [-5.23651034e-03]
 [ 1.22114014e-02]
 [-5.15849306e-05]
 [ 2.41033028e-02]
 [-1.90167803e-02]
 [ 2.74469328e-02]
 [ 9.72495877e-03]
 [-1.25603285e-02]
 [ 2.93273289e-02]
 [ 1.66090657e-02]
 [-7.70824476e-03]
 [-8.28604773e-03]
 [ 1.34379945e-02]
 [ 2.65713814e-02]
 [ 6.03555382e-03]
 [-2.23020528e-03]
 [ 3.07886610e-02]
 [-1.07340280e-02]
 [-1.79153466e-03]
 [ 4.36394826e-03]
 [ 1.91774779e-02]
 [ 1.08737223e-02]
 [ 4.90678454e-03]
 [ 1.67119753e-02]
 [ 1.18224020e-02]
 [-7.88108688e-03]
 [-5.95491239e-03]
 [ 3.37242834e-02]
 [ 1.02119734e-03]
 [-1.37328563e-02]
 [ 2.32061854e-03]
 [-7.51145523e-03]
 [ 1.17683467e-03]
 [-9.37182722e-03]
 [ 7.05889521e-03]
 [-5.73128390e-03]
 [-6.12118954e-02]
 [-4.97837029e-03]
 [ 1.98789903e-02]
 [-1.69730616e-02]
 [-9.87245112e-03]
 [ 3.45882674e-03]
 [-1.35047205e-02]
 [ 2.45249766e-02]
 [ 4.01931661e-02]
 [-1.54448810e-02]
 [-5.36215235e-03]
 [ 3.94704433e-03]
 [ 3.60497513e-03]
 [-1.07430243e-02]
 [-1.71199856e-02]
 [ 1.49567502e-02]
 [-5.56579761e-02]
 [-1.92430096e-02]
 [ 2.71200859e-02]
 [-1.95810467e-02]
 [ 1.35579405e-02]
 [-1.16034626e-02]
 [-1.26048153e-02]
 [-2.21541949e-03]
 [ 1.98589859e-01]
 [-5.16339283e-03]
 [-6.55225659e-03]
 [ 9.15618916e-03]
 [ 2.17481560e-02]
 [-4.05148633e-02]
 [-8.28188124e-03]
 [-1.24969583e-03]
 [ 3.12407720e-02]
 [-1.05304691e-03]
 [-5.78145235e-03]
 [ 1.56241128e-02]
 [-1.14478649e-02]
 [ 2.52694641e-03]
 [ 4.25553373e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.02374156]
curr_Stock_Price:  100.38287922305811
curr_Factors:  [100.38287922]
mat_Sqrt:  [[0.15]]
grads:  [-0.33296148]
Stock Position:  -0.3329614831162576
Bond Position:  [41.44737391]


portfolio before change:  [7.75966093]
curr_Stock_Price:  101.18378620062484
curr_Factors:  [101.1837862]
mat_Sqrt:  [[0.15]]
grads:  [0.01228273]
Stock Position:  0.012282726724306345
Bond Position:  [6.51684813]


portfolio before change:  [7.76063172]
curr_Stock_Price:  101.22966190726976
curr_Factors:  [101.22966191]
mat_Sqrt:  [[0.15]]
grads:  [0.03731563]
Stock Position:  0.03731562903445508
Bond Position:  [3.98318321]


portfolio before change:  [7.81771401]
curr_Stock_Price:  102.7527055854016
curr_Factors:  [102.75270559]
mat_Sqrt:  [[0.15]]
grads:  [0.02701451]
Stock Position:  0.027014509989345903
Bond Position:  [5.04190002]


portfolio before change:  [7.8064471]
curr_Stock_Price:  102.32397135312351
curr_Factors:  [102.32397135]
mat_Sqrt:  [[0.15]]
grads:  [-0.03491007]
Stock Position:  -0.03491006894187073
Bond Position:  [11.37858399]


portfolio before change:  [7.82314973]
curr_Stock_Price:  101.86589571224094
curr_Factors:  [101.86589571]
mat_Sqrt:  [[0.15]]
grads:  [0.08140934]
Stock Position:  0.08140934273465175
Bond Position:  [-0.46968589]


portfolio before change:  [7.79624553]
curr_Stock_Price:  101.5357757399374
curr_Factors:  [101.53577574]
mat_Sqrt:  [[0.15]]
grads:  [-0.0003439]
Stock Position:  -0.00034389953754087655
Bond Position:  [7.83116363]


portfolio before change:  [7.79621774]
curr_Stock_Price:  103.03983466164483
curr_Factors:  [103.03983466]
mat_Sqrt:  [[0.15]]
grads:  [0.16068869]
Stock Position:  0.16068868541541803
Bond Position:  [-8.76111783]


portfolio before change:  [7.82308914]
curr_Stock_Price:  103.21046883820584
curr_Factors:  [103.21046884]
mat_Sqrt:  [[0.15]]
grads:  [-0.12677854]
Stock Position:  -0.12677853532451808
Bond Position:  [20.90796121]


portfolio before change:  [7.86698194]
curr_Stock_Price:  102.87456013260392
curr_Factors:  [102.87456013]
mat_Sqrt:  [[0.15]]
grads:  [0.18297955]
Stock Position:  0.18297955225598703
Bond Position:  [-10.95695901]


portfolio before change:  [7.93355064]
curr_Stock_Price:  103.24210683801016
curr_Factors:  [103.24210684]
mat_Sqrt:  [[0.15]]
grads:  [0.06483306]
Stock Position:  0.06483305845659945
Bond Position:  [1.24004909]


portfolio before change:  [7.91373014]
curr_Stock_Price:  102.9351953722363
curr_Factors:  [102.93519537]
mat_Sqrt:  [[0.15]]
grads:  [-0.08373552]
Stock Position:  -0.08373552356420577
Bond Position:  [16.53306261]


portfolio before change:  [7.92950476]
curr_Stock_Price:  102.75914972190014
curr_Factors:  [102.75914972]
mat_Sqrt:  [[0.15]]
grads:  [0.19551553]
Stock Position:  0.19551552608798045
Bond Position:  [-12.16150446]


portfolio before change:  [7.94011375]
curr_Stock_Price:  102.81729910208044
curr_Factors:  [102.8172991]
mat_Sqrt:  [[0.15]]
grads:  [0.1107271]
Stock Position:  0.11072710458572574
Bond Position:  [-3.44454808]


portfolio before change:  [7.95715903]
curr_Stock_Price:  102.9731830271368
curr_Factors:  [102.97318303]
mat_Sqrt:  [[0.15]]
grads:  [-0.0513883]
Stock Position:  -0.05138829841047665
Bond Position:  [13.24877569]


portfolio before change:  [7.9530507]
curr_Stock_Price:  103.06924400006724
curr_Factors:  [103.069244]
mat_Sqrt:  [[0.15]]
grads:  [-0.05524032]
Stock Position:  -0.05524031819222455
Bond Position:  [13.64662853]


portfolio before change:  [7.93632507]
curr_Stock_Price:  103.38746391778527
curr_Factors:  [103.38746392]
mat_Sqrt:  [[0.15]]
grads:  [0.08958663]
Stock Position:  0.08958663004623987
Bond Position:  [-1.32580941]


portfolio before change:  [7.88847288]
curr_Stock_Price:  102.85424454935689
curr_Factors:  [102.85424455]
mat_Sqrt:  [[0.15]]
grads:  [0.17714254]
Stock Position:  0.1771425426774045
Bond Position:  [-10.33138953]


portfolio before change:  [7.90164206]
curr_Stock_Price:  102.93223211892919
curr_Factors:  [102.93223212]
mat_Sqrt:  [[0.15]]
grads:  [0.04023703]
Stock Position:  0.04023702544219019
Bond Position:  [3.75995522]


portfolio before change:  [7.89905516]
curr_Stock_Price:  102.86210012237612
curr_Factors:  [102.86210012]
mat_Sqrt:  [[0.15]]
grads:  [-0.01486804]
Stock Position:  -0.014868035184820202
Bond Position:  [9.42841249]


portfolio before change:  [7.89549154]
curr_Stock_Price:  103.14141843645601
curr_Factors:  [103.14141844]
mat_Sqrt:  [[0.15]]
grads:  [0.20525774]
Stock Position:  0.20525773967542557
Bond Position:  [-13.27508287]


portfolio before change:  [7.94971371]
curr_Stock_Price:  103.40962700388968
curr_Factors:  [103.409627]
mat_Sqrt:  [[0.15]]
grads:  [-0.07156019]
Stock Position:  -0.07156018662993482
Bond Position:  [15.34972592]


portfolio before change:  [7.92049854]
curr_Stock_Price:  103.83129376063118
curr_Factors:  [103.83129376]
mat_Sqrt:  [[0.15]]
grads:  [-0.01194356]
Stock Position:  -0.01194356440483722
Bond Position:  [9.16061429]


portfolio before change:  [7.91516034]
curr_Stock_Price:  104.32618461750376
curr_Factors:  [104.32618462]
mat_Sqrt:  [[0.15]]
grads:  [0.02909299]
Stock Position:  0.029092988414324228
Bond Position:  [4.87999986]


portfolio before change:  [7.93545534]
curr_Stock_Price:  105.01329148240511
curr_Factors:  [105.01329148]
mat_Sqrt:  [[0.15]]
grads:  [0.12784985]
Stock Position:  0.1278498523896904
Bond Position:  [-5.49047847]


portfolio before change:  [8.01798639]
curr_Stock_Price:  105.66150664268268
curr_Factors:  [105.66150664]
mat_Sqrt:  [[0.15]]
grads:  [0.07249148]
Stock Position:  0.07249148176320067
Bond Position:  [0.35842721]


portfolio before change:  [8.03567991]
curr_Stock_Price:  105.9052748616191
curr_Factors:  [105.90527486]
mat_Sqrt:  [[0.15]]
grads:  [0.0327119]
Stock Position:  0.03271189690444452
Bond Position:  [4.57131748]


portfolio before change:  [8.05598217]
curr_Stock_Price:  106.5171788324397
curr_Factors:  [106.51717883]
mat_Sqrt:  [[0.15]]
grads:  [0.11141317]
Stock Position:  0.11141316856255544
Bond Position:  [-3.81143423]


portfolio before change:  [8.06700648]
curr_Stock_Price:  106.6182668255696
curr_Factors:  [106.61826683]
mat_Sqrt:  [[0.15]]
grads:  [0.07881601]
Stock Position:  0.07881601328625687
Bond Position:  [-0.33622026]


portfolio before change:  [8.11210746]
curr_Stock_Price:  107.19076464758079
curr_Factors:  [107.19076465]
mat_Sqrt:  [[0.15]]
grads:  [-0.05254058]
Stock Position:  -0.05254057919444086
Bond Position:  [13.74397232]


portfolio before change:  [8.06576742]
curr_Stock_Price:  108.089100171271
curr_Factors:  [108.08910017]
mat_Sqrt:  [[0.15]]
grads:  [-0.03969942]
Stock Position:  -0.03969941592105241
Bond Position:  [12.35684156]


portfolio before change:  [8.08100601]
curr_Stock_Price:  107.72470523714271
curr_Factors:  [107.72470524]
mat_Sqrt:  [[0.15]]
grads:  [0.22482856]
Stock Position:  0.2248285561665744
Bond Position:  [-16.13858393]


portfolio before change:  [8.05048514]
curr_Stock_Price:  107.59343999541524
curr_Factors:  [107.59344]
mat_Sqrt:  [[0.15]]
grads:  [0.00680798]
Stock Position:  0.006807982292025324
Bond Position:  [7.31799091]


portfolio before change:  [8.04937375]
curr_Stock_Price:  107.3630078573484
curr_Factors:  [107.36300786]
mat_Sqrt:  [[0.15]]
grads:  [-0.09155238]
Stock Position:  -0.09155237527258782
Bond Position:  [17.87871214]


portfolio before change:  [8.08655221]
curr_Stock_Price:  106.96912402211073
curr_Factors:  [106.96912402]
mat_Sqrt:  [[0.15]]
grads:  [0.01547079]
Stock Position:  0.015470790241909766
Bond Position:  [6.43165533]


portfolio before change:  [8.08421904]
curr_Stock_Price:  106.79232900240038
curr_Factors:  [106.792329]
mat_Sqrt:  [[0.15]]
grads:  [-0.05007637]
Stock Position:  -0.05007636816764179
Bond Position:  [13.43199102]


portfolio before change:  [8.0754745]
curr_Stock_Price:  106.98371796769506
curr_Factors:  [106.98371797]
mat_Sqrt:  [[0.15]]
grads:  [0.00784556]
Stock Position:  0.00784556445440317
Bond Position:  [7.23612685]


portfolio before change:  [8.07676903]
curr_Stock_Price:  107.09107221903062
curr_Factors:  [107.09107222]
mat_Sqrt:  [[0.15]]
grads:  [-0.06247885]
Stock Position:  -0.06247884815517263
Bond Position:  [14.76769587]


portfolio before change:  [8.1610364]
curr_Stock_Price:  105.75711088569969
curr_Factors:  [105.75711089]
mat_Sqrt:  [[0.15]]
grads:  [0.0470593]
Stock Position:  0.047059301425902415
Bond Position:  [3.18418065]


portfolio before change:  [8.18719448]
curr_Stock_Price:  106.30873527841241
curr_Factors:  [106.30873528]
mat_Sqrt:  [[0.15]]
grads:  [-0.03820856]
Stock Position:  -0.03820855936565859
Bond Position:  [12.2490981]


portfolio before change:  [8.19567032]
curr_Stock_Price:  106.10694170634628
curr_Factors:  [106.10694171]
mat_Sqrt:  [[0.15]]
grads:  [-0.4080793]
Stock Position:  -0.4080793028985112
Bond Position:  [51.49571712]


portfolio before change:  [8.19473859]
curr_Stock_Price:  106.1171120510739
curr_Factors:  [106.11711205]
mat_Sqrt:  [[0.15]]
grads:  [-0.03318914]
Stock Position:  -0.03318913529414988
Bond Position:  [11.71667378]


portfolio before change:  [8.18769967]
curr_Stock_Price:  106.35126214478458
curr_Factors:  [106.35126214]
mat_Sqrt:  [[0.15]]
grads:  [0.1325266]
Stock Position:  0.13252660192610327
Bond Position:  [-5.90667172]


portfolio before change:  [8.15328088]
curr_Stock_Price:  106.09433552328444
curr_Factors:  [106.09433552]
mat_Sqrt:  [[0.15]]
grads:  [-0.11315374]
Stock Position:  -0.11315374391344768
Bond Position:  [20.15825215]


portfolio before change:  [8.05715669]
curr_Stock_Price:  106.95497090036932
curr_Factors:  [106.9549709]
mat_Sqrt:  [[0.15]]
grads:  [-0.06581634]
Stock Position:  -0.06581634080686187
Bond Position:  [15.09654151]


portfolio before change:  [8.03978633]
curr_Stock_Price:  107.23322896044593
curr_Factors:  [107.23322896]
mat_Sqrt:  [[0.15]]
grads:  [0.02305884]
Stock Position:  0.02305884491286216
Bond Position:  [5.56711193]


portfolio before change:  [8.03501771]
curr_Stock_Price:  107.0113371448363
curr_Factors:  [107.01133714]
mat_Sqrt:  [[0.15]]
grads:  [-0.09003147]
Stock Position:  -0.0900314697397416
Bond Position:  [17.66940568]


portfolio before change:  [8.06690764]
curr_Stock_Price:  106.66939500323099
curr_Factors:  [106.669395]
mat_Sqrt:  [[0.15]]
grads:  [0.16349984]
Stock Position:  0.16349984375241008
Bond Position:  [-9.37352178]


portfolio before change:  [8.09705659]
curr_Stock_Price:  106.85737568637408
curr_Factors:  [106.85737569]
mat_Sqrt:  [[0.15]]
grads:  [0.26795444]
Stock Position:  0.26795444098058746
Bond Position:  [-20.53585178]


portfolio before change:  [8.31037275]
curr_Stock_Price:  107.6582569611626
curr_Factors:  [107.65825696]
mat_Sqrt:  [[0.15]]
grads:  [-0.10296587]
Stock Position:  -0.10296587314753876
Bond Position:  [19.39549918]


portfolio before change:  [8.27837998]
curr_Stock_Price:  107.9807427286138
curr_Factors:  [107.98074273]
mat_Sqrt:  [[0.15]]
grads:  [-0.03574768]
Stock Position:  -0.03574768236502348
Bond Position:  [12.13844127]


portfolio before change:  [8.2800865]
curr_Stock_Price:  107.95422793843488
curr_Factors:  [107.95422794]
mat_Sqrt:  [[0.15]]
grads:  [0.02631363]
Stock Position:  0.026313628895328567
Bond Position:  [5.43941901]


portfolio before change:  [8.29097759]
curr_Stock_Price:  108.35520343658072
curr_Factors:  [108.35520344]
mat_Sqrt:  [[0.15]]
grads:  [0.02403317]
Stock Position:  0.024033167552893094
Bond Position:  [5.68685883]


portfolio before change:  [8.30192265]
curr_Stock_Price:  108.79582865475622
curr_Factors:  [108.79582865]
mat_Sqrt:  [[0.15]]
grads:  [-0.07162016]
Stock Position:  -0.07162016193226088
Bond Position:  [16.09389752]


portfolio before change:  [8.26494314]
curr_Stock_Price:  109.32620184102886
curr_Factors:  [109.32620184]
mat_Sqrt:  [[0.15]]
grads:  [-0.11413324]
Stock Position:  -0.11413323734456439
Bond Position:  [20.74269648]


portfolio before change:  [8.22303982]
curr_Stock_Price:  109.70470486253028
curr_Factors:  [109.70470486]
mat_Sqrt:  [[0.15]]
grads:  [0.09971167]
Stock Position:  0.09971166779046525
Bond Position:  [-2.71579926]


portfolio before change:  [8.28526351]
curr_Stock_Price:  110.33044335554825
curr_Factors:  [110.33044336]
mat_Sqrt:  [[0.15]]
grads:  [-0.37105317]
Stock Position:  -0.37105317422240736
Bond Position:  [49.22372473]


portfolio before change:  [8.18435659]
curr_Stock_Price:  110.6106821518532
curr_Factors:  [110.61068215]
mat_Sqrt:  [[0.15]]
grads:  [-0.12828673]
Stock Position:  -0.12828673078379182
Bond Position:  [22.3742394]


portfolio before change:  [8.17168326]
curr_Stock_Price:  110.72037213774728
curr_Factors:  [110.72037214]
mat_Sqrt:  [[0.15]]
grads:  [0.18080057]
Stock Position:  0.18080057279559628
Bond Position:  [-11.84662345]


portfolio before change:  [8.17152466]
curr_Stock_Price:  110.72359026760282
curr_Factors:  [110.72359027]
mat_Sqrt:  [[0.15]]
grads:  [-0.13054031]
Stock Position:  -0.13054031103506875
Bond Position:  [22.62541657]


portfolio before change:  [8.14284079]
curr_Stock_Price:  110.95415507829894
curr_Factors:  [110.95415508]
mat_Sqrt:  [[0.15]]
grads:  [0.09038627]
Stock Position:  0.0903862703233122
Bond Position:  [-1.88589146]


portfolio before change:  [8.1847217]
curr_Stock_Price:  111.4188139635042
curr_Factors:  [111.41881396]
mat_Sqrt:  [[0.15]]
grads:  [-0.07735642]
Stock Position:  -0.0773564171167774
Bond Position:  [16.80368195]


portfolio before change:  [8.31729354]
curr_Stock_Price:  109.71861146158112
curr_Factors:  [109.71861146]
mat_Sqrt:  [[0.15]]
grads:  [-0.0840321]
Stock Position:  -0.08403210197768195
Bond Position:  [17.53717909]


portfolio before change:  [8.29683291]
curr_Stock_Price:  109.97514123141231
curr_Factors:  [109.97514123]
mat_Sqrt:  [[0.15]]
grads:  [-0.01476946]
Stock Position:  -0.014769463266341093
Bond Position:  [9.92110672]


portfolio before change:  [8.29264578]
curr_Stock_Price:  110.3006246935947
curr_Factors:  [110.30062469]
mat_Sqrt:  [[0.15]]
grads:  [1.32393239]
Stock Position:  1.323932391667252
Bond Position:  [-137.73792407]


portfolio before change:  [8.72724052]
curr_Stock_Price:  110.63538773251375
curr_Factors:  [110.63538773]
mat_Sqrt:  [[0.15]]
grads:  [-0.03442262]
Stock Position:  -0.034422618841569726
Bond Position:  [12.53560031]


portfolio before change:  [8.71790309]
curr_Stock_Price:  110.92940774411227
curr_Factors:  [110.92940774]
mat_Sqrt:  [[0.15]]
grads:  [-0.04368171]
Stock Position:  -0.04368171061032884
Bond Position:  [13.56348937]


portfolio before change:  [8.70592623]
curr_Stock_Price:  111.22299974578888
curr_Factors:  [111.22299975]
mat_Sqrt:  [[0.15]]
grads:  [0.06104126]
Stock Position:  0.061041261081570174
Bond Position:  [1.91673406]


portfolio before change:  [8.75510073]
curr_Stock_Price:  112.02663158106735
curr_Factors:  [112.02663158]
mat_Sqrt:  [[0.15]]
grads:  [0.14498771]
Stock Position:  0.14498770639219863
Bond Position:  [-7.48738364]


portfolio before change:  [8.71578653]
curr_Stock_Price:  111.75870385798017
curr_Factors:  [111.75870386]
mat_Sqrt:  [[0.15]]
grads:  [-0.27009909]
Stock Position:  -0.27009908873306476
Bond Position:  [38.9017106]


portfolio before change:  [8.61357415]
curr_Stock_Price:  112.14613133537934
curr_Factors:  [112.14613134]
mat_Sqrt:  [[0.15]]
grads:  [-0.05521254]
Stock Position:  -0.05521254161090014
Bond Position:  [14.80544709]


portfolio before change:  [8.53319619]
curr_Stock_Price:  113.61868312318
curr_Factors:  [113.61868312]
mat_Sqrt:  [[0.15]]
grads:  [-0.00833131]
Stock Position:  -0.008331305511846741
Bond Position:  [9.47978816]


portfolio before change:  [8.53306904]
curr_Stock_Price:  113.7050629715733
curr_Factors:  [113.70506297]
mat_Sqrt:  [[0.15]]
grads:  [0.20827181]
Stock Position:  0.20827181303824452
Bond Position:  [-15.14849057]


portfolio before change:  [8.40838675]
curr_Stock_Price:  113.11095722898773
curr_Factors:  [113.11095723]
mat_Sqrt:  [[0.15]]
grads:  [-0.00702031]
Stock Position:  -0.007020312714731136
Bond Position:  [9.20246104]


portfolio before change:  [8.40943856]
curr_Stock_Price:  113.0430633917026
curr_Factors:  [113.04306339]
mat_Sqrt:  [[0.15]]
grads:  [-0.03854302]
Stock Position:  -0.03854301564273361
Bond Position:  [12.76645912]


portfolio before change:  [8.41686018]
curr_Stock_Price:  112.87121159146893
curr_Factors:  [112.87121159]
mat_Sqrt:  [[0.15]]
grads:  [0.10416075]
Stock Position:  0.10416075207131953
Bond Position:  [-3.33989011]


portfolio before change:  [8.54186801]
curr_Stock_Price:  114.07335907629327
curr_Factors:  [114.07335908]
mat_Sqrt:  [[0.15]]
grads:  [-0.0763191]
Stock Position:  -0.07631909906875516
Bond Position:  [17.247844]


portfolio before change:  [8.52742982]
curr_Stock_Price:  114.27666620913645
curr_Factors:  [114.27666621]
mat_Sqrt:  [[0.15]]
grads:  [0.01684631]
Stock Position:  0.016846309406144233
Bond Position:  [6.60228974]


portfolio before change:  [8.511634]
curr_Stock_Price:  113.314527919302
curr_Factors:  [113.31452792]
mat_Sqrt:  [[0.15]]
grads:  [0.28370225]
Stock Position:  0.28370224834116947
Bond Position:  [-23.63595235]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.511634]
Stock Price:  113.08424371542931
PL:  [-4.57260972]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.68968327e-02]
 [ 6.68971000e-04]
 [ 3.40345941e-04]
 [ 4.14228044e-04]
 [-1.09640271e-02]
 [ 6.00582273e-03]
 [ 1.06810164e-03]
 [ 4.59900540e-03]
 [ 3.03126972e-03]
 [ 3.30411147e-02]
 [ 9.22136009e-03]
 [-8.59102923e-03]
 [ 6.15520028e-03]
 [ 4.19333897e-03]
 [-9.85738402e-04]
 [ 1.35673975e-02]
 [-2.09114342e-03]
 [-4.41373294e-03]
 [-5.07893831e-02]
 [ 1.69761485e-02]
 [-7.49494335e-02]
 [-3.52103902e-02]
 [ 1.75510788e-03]
 [-3.24741627e-03]
 [-7.70617825e-03]
 [ 1.68363863e-02]
 [ 1.77671747e-02]
 [ 1.16831303e-02]
 [ 4.54917597e-04]
 [ 3.58932206e-03]
 [-3.43450759e-03]
 [-2.36909900e-02]
 [ 2.07973235e-02]
 [ 1.11687587e-02]
 [-2.82484571e-02]
 [ 8.08886380e-03]
 [-2.18080080e-03]
 [-4.33506763e-03]
 [ 5.20735978e-03]
 [-1.68204553e-02]
 [ 3.16780336e-02]
 [-9.23397344e-04]
 [ 6.00333193e-03]
 [-9.04780440e-03]
 [-1.25648236e-03]
 [-1.03140430e-02]
 [-1.33585205e-02]
 [ 8.22512371e-04]
 [-2.69253141e-03]
 [-6.97619704e-03]
 [-4.21026253e-03]
 [ 2.79090199e-03]
 [ 4.08574411e-03]
 [-2.42434192e-03]
 [ 2.03943967e-02]
 [ 9.08871005e-03]
 [-3.64281078e-03]
 [ 1.81720470e-02]
 [ 1.26036502e-02]
 [-1.19987660e-02]
 [-1.26245711e-02]
 [-4.03798027e-02]
 [-1.30465441e-02]
 [-5.19655827e-03]
 [-1.59013644e-03]
 [ 8.44287741e-02]
 [ 8.82712866e-03]
 [ 1.78786907e-03]
 [ 1.82275078e-02]
 [-1.89255258e-02]
 [ 3.89814883e-02]
 [-5.29213305e-02]
 [-1.25508475e-02]
 [ 8.36127148e-03]
 [-2.22032935e-02]
 [ 5.14469945e-03]
 [ 2.56515379e-02]
 [-2.11204730e-02]
 [-6.85956156e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.19961605]
curr_Stock_Price:  99.59727596651553
curr_Factors:  [99.59727597]
mat_Sqrt:  [[0.15]]
grads:  [-0.24597888]
Stock Position:  -0.2459788848777613
Bond Position:  [20.29921082]


portfolio before change:  [-4.20588473]
curr_Stock_Price:  99.62791849124562
curr_Factors:  [99.62791849]
mat_Sqrt:  [[0.15]]
grads:  [0.00445981]
Stock Position:  0.004459806664023763
Bond Position:  [-4.65020598]


portfolio before change:  [-4.2056059]
curr_Stock_Price:  99.75561004355508
curr_Factors:  [99.75561004]
mat_Sqrt:  [[0.15]]
grads:  [0.00226897]
Stock Position:  0.0022689729412058777
Bond Position:  [-4.43194868]


portfolio before change:  [-4.20703731]
curr_Stock_Price:  99.24682795259092
curr_Factors:  [99.24682795]
mat_Sqrt:  [[0.15]]
grads:  [0.00276152]
Stock Position:  0.0027615202903696788
Bond Position:  [-4.48110944]


portfolio before change:  [-4.20795589]
curr_Stock_Price:  99.01561473870612
curr_Factors:  [99.01561474]
mat_Sqrt:  [[0.15]]
grads:  [-0.07309351]
Stock Position:  -0.07309351414711765
Bond Position:  [3.02944334]


portfolio before change:  [-4.17891503]
curr_Stock_Price:  98.62089412393618
curr_Factors:  [98.62089412]
mat_Sqrt:  [[0.15]]
grads:  [0.04003882]
Stock Position:  0.040038818170720455
Bond Position:  [-8.12757908]


portfolio before change:  [-4.19347952]
curr_Stock_Price:  98.26982237984184
curr_Factors:  [98.26982238]
mat_Sqrt:  [[0.15]]
grads:  [0.00712068]
Stock Position:  0.007120677599581387
Bond Position:  [-4.89322724]


portfolio before change:  [-4.19378974]
curr_Stock_Price:  98.26920621236474
curr_Factors:  [98.26920621]
mat_Sqrt:  [[0.15]]
grads:  [0.03066004]
Stock Position:  0.030660036000116977
Bond Position:  [-7.20672714]


portfolio before change:  [-4.21470421]
curr_Stock_Price:  97.60175641938815
curr_Factors:  [97.60175642]
mat_Sqrt:  [[0.15]]
grads:  [0.02020846]
Stock Position:  0.02020846479957955
Bond Position:  [-6.18708587]


portfolio before change:  [-4.21941635]
curr_Stock_Price:  97.38771579109682
curr_Factors:  [97.38771579]
mat_Sqrt:  [[0.15]]
grads:  [0.2202741]
Stock Position:  0.22027409823278837
Bond Position:  [-25.67140762]


portfolio before change:  [-4.18391344]
curr_Stock_Price:  97.55617599453218
curr_Factors:  [97.55617599]
mat_Sqrt:  [[0.15]]
grads:  [0.06147573]
Stock Position:  0.06147573391676874
Bond Position:  [-10.18125096]


portfolio before change:  [-4.14975803]
curr_Stock_Price:  98.12211900730685
curr_Factors:  [98.12211901]
mat_Sqrt:  [[0.15]]
grads:  [-0.05727353]
Stock Position:  -0.05727352820306709
Bond Position:  [1.47004192]


portfolio before change:  [-4.12295489]
curr_Stock_Price:  97.6557384389414
curr_Factors:  [97.65573844]
mat_Sqrt:  [[0.15]]
grads:  [0.04103467]
Stock Position:  0.04103466851967304
Bond Position:  [-8.13022574]


portfolio before change:  [-4.09778041]
curr_Stock_Price:  98.28161476077874
curr_Factors:  [98.28161476]
mat_Sqrt:  [[0.15]]
grads:  [0.02795559]
Stock Position:  0.027955593145511205
Bond Position:  [-6.84530125]


portfolio before change:  [-4.07643809]
curr_Stock_Price:  99.06035569862141
curr_Factors:  [99.0603557]
mat_Sqrt:  [[0.15]]
grads:  [-0.00657159]
Stock Position:  -0.00657158934678911
Bond Position:  [-3.42545411]


portfolio before change:  [-4.07534932]
curr_Stock_Price:  98.86209787160146
curr_Factors:  [98.86209787]
mat_Sqrt:  [[0.15]]
grads:  [0.09044932]
Stock Position:  0.09044931639787743
Bond Position:  [-13.01735849]


portfolio before change:  [-4.10009062]
curr_Stock_Price:  98.59755542334015
curr_Factors:  [98.59755542]
mat_Sqrt:  [[0.15]]
grads:  [-0.01394096]
Stock Position:  -0.013940956161756609
Bond Position:  [-2.72554642]


portfolio before change:  [-4.08295873]
curr_Stock_Price:  97.3564468408302
curr_Factors:  [97.35644684]
mat_Sqrt:  [[0.15]]
grads:  [-0.02942489]
Stock Position:  -0.029424886236502624
Bond Position:  [-1.21825635]


portfolio before change:  [-4.03634085]
curr_Stock_Price:  95.76955825696204
curr_Factors:  [95.76955826]
mat_Sqrt:  [[0.15]]
grads:  [-0.33859589]
Stock Position:  -0.3385958870160849
Bond Position:  [28.39083767]


portfolio before change:  [-4.08743124]
curr_Stock_Price:  95.92568794955189
curr_Factors:  [95.92568795]
mat_Sqrt:  [[0.15]]
grads:  [0.11317432]
Stock Position:  0.11317432340611236
Bond Position:  [-14.94375607]


portfolio before change:  [-4.11106932]
curr_Stock_Price:  95.7250765466201
curr_Factors:  [95.72507655]
mat_Sqrt:  [[0.15]]
grads:  [-0.49966289]
Stock Position:  -0.49966288986076035
Bond Position:  [43.71919906]


portfolio before change:  [-3.93483361]
curr_Stock_Price:  95.37783608206789
curr_Factors:  [95.37783608]
mat_Sqrt:  [[0.15]]
grads:  [-0.23473593]
Stock Position:  -0.23473593435877077
Bond Position:  [18.45377186]


portfolio before change:  [-3.946924]
curr_Stock_Price:  95.4342560138361
curr_Factors:  [95.43425601]
mat_Sqrt:  [[0.15]]
grads:  [0.01170072]
Stock Position:  0.01170071920851539
Bond Position:  [-5.06357343]


portfolio before change:  [-3.94431969]
curr_Stock_Price:  95.68388052643982
curr_Factors:  [95.68388053]
mat_Sqrt:  [[0.15]]
grads:  [-0.02164944]
Stock Position:  -0.021649441787889735
Bond Position:  [-1.87281709]


portfolio before change:  [-3.94879731]
curr_Stock_Price:  95.88529739288484
curr_Factors:  [95.88529739]
mat_Sqrt:  [[0.15]]
grads:  [-0.05137452]
Stock Position:  -0.051374521668465796
Bond Position:  [0.97726398]


portfolio before change:  [-3.95760548]
curr_Stock_Price:  96.05793644250397
curr_Factors:  [96.05793644]
mat_Sqrt:  [[0.15]]
grads:  [0.11224258]
Stock Position:  0.1122425751749241
Bond Position:  [-14.73939563]


portfolio before change:  [-3.92353856]
curr_Stock_Price:  96.3696555722321
curr_Factors:  [96.36965557]
mat_Sqrt:  [[0.15]]
grads:  [0.11844783]
Stock Position:  0.11844783136621476
Bond Position:  [-15.33831527]


portfolio before change:  [-3.87668705]
curr_Stock_Price:  96.77329476232968
curr_Factors:  [96.77329476]
mat_Sqrt:  [[0.15]]
grads:  [0.07788754]
Stock Position:  0.07788753538614239
Bond Position:  [-11.41412047]


portfolio before change:  [-3.8899509]
curr_Stock_Price:  96.6121592821697
curr_Factors:  [96.61215928]
mat_Sqrt:  [[0.15]]
grads:  [0.00303278]
Stock Position:  0.0030327839815356646
Bond Position:  [-4.18295471]


portfolio before change:  [-3.89018706]
curr_Stock_Price:  96.62049555748098
curr_Factors:  [96.62049556]
mat_Sqrt:  [[0.15]]
grads:  [0.02392881]
Stock Position:  0.02392881375178425
Bond Position:  [-6.2022009]


portfolio before change:  [-3.90639028]
curr_Stock_Price:  95.95955302914754
curr_Factors:  [95.95955303]
mat_Sqrt:  [[0.15]]
grads:  [-0.02289672]
Stock Position:  -0.022896717255983218
Bond Position:  [-1.70923153]


portfolio before change:  [-3.93007923]
curr_Stock_Price:  96.9894876313497
curr_Factors:  [96.98948763]
mat_Sqrt:  [[0.15]]
grads:  [-0.15793993]
Stock Position:  -0.15793993305445791
Bond Position:  [11.38843395]


portfolio before change:  [-3.87634132]
curr_Stock_Price:  96.65375171325475
curr_Factors:  [96.65375171]
mat_Sqrt:  [[0.15]]
grads:  [0.13864882]
Stock Position:  0.13864882304065218
Bond Position:  [-17.27727024]


portfolio before change:  [-3.91750309]
curr_Stock_Price:  96.36466235650178
curr_Factors:  [96.36466236]
mat_Sqrt:  [[0.15]]
grads:  [0.07445839]
Stock Position:  0.07445839110185935
Bond Position:  [-11.09266081]


portfolio before change:  [-3.90638766]
curr_Stock_Price:  96.52325746399141
curr_Factors:  [96.52325746]
mat_Sqrt:  [[0.15]]
grads:  [-0.18832305]
Stock Position:  -0.1883230472586885
Bond Position:  [14.27116631]


portfolio before change:  [-3.9225935]
curr_Stock_Price:  96.6140472457926
curr_Factors:  [96.61404725]
mat_Sqrt:  [[0.15]]
grads:  [0.05392576]
Stock Position:  0.053925758647531644
Bond Position:  [-9.13257929]


portfolio before change:  [-3.9176634]
curr_Stock_Price:  96.71605607304511
curr_Factors:  [96.71605607]
mat_Sqrt:  [[0.15]]
grads:  [-0.01453867]
Stock Position:  -0.014538671982731831
Bond Position:  [-2.51154038]


portfolio before change:  [-3.912256]
curr_Stock_Price:  96.3333271306356
curr_Factors:  [96.33332713]
mat_Sqrt:  [[0.15]]
grads:  [-0.02890045]
Stock Position:  -0.028900450872636266
Bond Position:  [-1.12817941]


portfolio before change:  [-3.93508045]
curr_Stock_Price:  97.12064831285095
curr_Factors:  [97.12064831]
mat_Sqrt:  [[0.15]]
grads:  [0.03471573]
Stock Position:  0.0347157318788388
Bond Position:  [-7.30669484]


portfolio before change:  [-3.94792079]
curr_Stock_Price:  96.76393231633982
curr_Factors:  [96.76393232]
mat_Sqrt:  [[0.15]]
grads:  [-0.11213637]
Stock Position:  -0.11213636867807573
Bond Position:  [6.9028352]


portfolio before change:  [-4.06524706]
curr_Stock_Price:  97.81406181575107
curr_Factors:  [97.81406182]
mat_Sqrt:  [[0.15]]
grads:  [0.21118689]
Stock Position:  0.21118689091992382
Bond Position:  [-24.72229466]


portfolio before change:  [-4.05417296]
curr_Stock_Price:  97.87381594043183
curr_Factors:  [97.87381594]
mat_Sqrt:  [[0.15]]
grads:  [-0.00615598]
Stock Position:  -0.0061559822966328675
Bond Position:  [-3.45166349]


portfolio before change:  [-4.04929087]
curr_Stock_Price:  97.04570562118658
curr_Factors:  [97.04570562]
mat_Sqrt:  [[0.15]]
grads:  [0.04002221]
Stock Position:  0.04002221289093426
Bond Position:  [-7.93327476]


portfolio before change:  [-4.05832707]
curr_Stock_Price:  96.8323151590254
curr_Factors:  [96.83231516]
mat_Sqrt:  [[0.15]]
grads:  [-0.0603187]
Stock Position:  -0.06031869598121953
Bond Position:  [1.78247191]


portfolio before change:  [-4.02051246]
curr_Stock_Price:  96.20724853641046
curr_Factors:  [96.20724854]
mat_Sqrt:  [[0.15]]
grads:  [-0.00837655]
Stock Position:  -0.00837654905603379
Bond Position:  [-3.21462772]


portfolio before change:  [-4.02214757]
curr_Stock_Price:  96.37846305338651
curr_Factors:  [96.37846305]
mat_Sqrt:  [[0.15]]
grads:  [-0.06876029]
Stock Position:  -0.06876028665097306
Bond Position:  [2.60486318]


portfolio before change:  [-4.01706517]
curr_Stock_Price:  96.30691612625904
curr_Factors:  [96.30691613]
mat_Sqrt:  [[0.15]]
grads:  [-0.0890568]
Stock Position:  -0.08905680305656467
Bond Position:  [4.55972089]


portfolio before change:  [-3.96614655]
curr_Stock_Price:  95.73836179629194
curr_Factors:  [95.7383618]
mat_Sqrt:  [[0.15]]
grads:  [0.00548342]
Stock Position:  0.00548341580523294
Bond Position:  [-4.49111979]


portfolio before change:  [-3.9678892]
curr_Stock_Price:  95.47174932133069
curr_Factors:  [95.47174932]
mat_Sqrt:  [[0.15]]
grads:  [-0.01795021]
Stock Position:  -0.017950209395762785
Bond Position:  [-2.25415131]


portfolio before change:  [-3.96763156]
curr_Stock_Price:  95.44954732116162
curr_Factors:  [95.44954732]
mat_Sqrt:  [[0.15]]
grads:  [-0.04650798]
Stock Position:  -0.04650798029098412
Bond Position:  [0.47153411]


portfolio before change:  [-3.94861219]
curr_Stock_Price:  95.0412326219516
curr_Factors:  [95.04123262]
mat_Sqrt:  [[0.15]]
grads:  [-0.02806842]
Stock Position:  -0.028068416875547068
Bond Position:  [-1.28095526]


portfolio before change:  [-3.9492645]
curr_Stock_Price:  95.06162009432806
curr_Factors:  [95.06162009]
mat_Sqrt:  [[0.15]]
grads:  [0.01860601]
Stock Position:  0.018606013282882725
Bond Position:  [-5.71798227]


portfolio before change:  [-3.96926169]
curr_Stock_Price:  94.0060580157813
curr_Factors:  [94.00605802]
mat_Sqrt:  [[0.15]]
grads:  [0.02723829]
Stock Position:  0.02723829406239238
Bond Position:  [-6.52982634]


portfolio before change:  [-3.97844839]
curr_Stock_Price:  93.68377003116038
curr_Factors:  [93.68377003]
mat_Sqrt:  [[0.15]]
grads:  [-0.01616228]
Stock Position:  -0.016162279493439943
Bond Position:  [-2.46430511]


portfolio before change:  [-3.98023815]
curr_Stock_Price:  93.7849770135863
curr_Factors:  [93.78497701]
mat_Sqrt:  [[0.15]]
grads:  [0.13596264]
Stock Position:  0.13596264442029157
Bond Position:  [-16.73149163]


portfolio before change:  [-4.13806549]
curr_Stock_Price:  92.63185449270979
curr_Factors:  [92.63185449]
mat_Sqrt:  [[0.15]]
grads:  [0.0605914]
Stock Position:  0.06059140032492111
Bond Position:  [-9.75075926]


portfolio before change:  [-4.13127923]
curr_Stock_Price:  92.75391310001824
curr_Factors:  [92.7539131]
mat_Sqrt:  [[0.15]]
grads:  [-0.02428541]
Stock Position:  -0.02428540519077796
Bond Position:  [-1.87871286]


portfolio before change:  [-4.10990047]
curr_Stock_Price:  91.86876511178497
curr_Factors:  [91.86876511]
mat_Sqrt:  [[0.15]]
grads:  [0.12114698]
Stock Position:  0.12114698017855037
Bond Position:  [-15.23952394]


portfolio before change:  [-4.08621732]
curr_Stock_Price:  92.07211848476332
curr_Factors:  [92.07211848]
mat_Sqrt:  [[0.15]]
grads:  [0.08402433]
Stock Position:  0.0840243344513248
Bond Position:  [-11.8225158]


portfolio before change:  [-4.07259642]
curr_Stock_Price:  92.24301941981437
curr_Factors:  [92.24301942]
mat_Sqrt:  [[0.15]]
grads:  [-0.07999177]
Stock Position:  -0.07999177306797331
Bond Position:  [3.30608626]


portfolio before change:  [-4.09759596]
curr_Stock_Price:  92.55812911754762
curr_Factors:  [92.55812912]
mat_Sqrt:  [[0.15]]
grads:  [-0.08416381]
Stock Position:  -0.08416380753595183
Bond Position:  [3.6924486]


portfolio before change:  [-4.0839349]
curr_Stock_Price:  92.39855604638883
curr_Factors:  [92.39855605]
mat_Sqrt:  [[0.15]]
grads:  [-0.26919868]
Stock Position:  -0.26919868464725843
Bond Position:  [20.78963485]


portfolio before change:  [-4.08855659]
curr_Stock_Price:  92.42055126665346
curr_Factors:  [92.42055127]
mat_Sqrt:  [[0.15]]
grads:  [-0.08697696]
Stock Position:  -0.08697696059808056
Bond Position:  [3.94990205]


portfolio before change:  [-4.06306601]
curr_Stock_Price:  92.13031688434404
curr_Factors:  [92.13031688]
mat_Sqrt:  [[0.15]]
grads:  [-0.03464372]
Stock Position:  -0.03464372179906461
Bond Position:  [-0.87132894]


portfolio before change:  [-4.06867609]
curr_Stock_Price:  92.29068135237969
curr_Factors:  [92.29068135]
mat_Sqrt:  [[0.15]]
grads:  [-0.01060091]
Stock Position:  -0.010600909606191089
Bond Position:  [-3.09031092]


portfolio before change:  [-4.06264534]
curr_Stock_Price:  91.70357129966347
curr_Factors:  [91.7035713]
mat_Sqrt:  [[0.15]]
grads:  [0.56285849]
Stock Position:  0.5628584939412743
Bond Position:  [-55.67877937]


portfolio before change:  [-4.35229933]
curr_Stock_Price:  91.19514163945907
curr_Factors:  [91.19514164]
mat_Sqrt:  [[0.15]]
grads:  [0.05884752]
Stock Position:  0.058847524413394976
Bond Position:  [-9.71890765]


portfolio before change:  [-4.3480663]
curr_Stock_Price:  91.27739618441112
curr_Factors:  [91.27739618]
mat_Sqrt:  [[0.15]]
grads:  [0.01191913]
Stock Position:  0.011919127122243871
Bond Position:  [-5.43601319]


portfolio before change:  [-4.35280259]
curr_Stock_Price:  90.9085329179218
curr_Factors:  [90.90853292]
mat_Sqrt:  [[0.15]]
grads:  [0.12151672]
Stock Position:  0.12151671899752434
Bond Position:  [-15.39970924]


portfolio before change:  [-4.39057736]
curr_Stock_Price:  90.60559308315239
curr_Factors:  [90.60559308]
mat_Sqrt:  [[0.15]]
grads:  [-0.12617017]
Stock Position:  -0.1261701721429371
Bond Position:  [7.04114592]


portfolio before change:  [-4.36662633]
curr_Stock_Price:  90.41924992287825
curr_Factors:  [90.41924992]
mat_Sqrt:  [[0.15]]
grads:  [0.25987659]
Stock Position:  0.2598765888309356
Bond Position:  [-27.86447256]


portfolio before change:  [-4.27131872]
curr_Stock_Price:  90.79269329558976
curr_Factors:  [90.7926933]
mat_Sqrt:  [[0.15]]
grads:  [-0.35280887]
Stock Position:  -0.35280886984810084
Bond Position:  [27.76114879]


portfolio before change:  [-3.87959196]
curr_Stock_Price:  89.68730261500421
curr_Factors:  [89.68730262]
mat_Sqrt:  [[0.15]]
grads:  [-0.08367232]
Stock Position:  -0.08367231684049507
Bond Position:  [3.62475244]


portfolio before change:  [-3.83468267]
curr_Stock_Price:  89.15328207545707
curr_Factors:  [89.15328208]
mat_Sqrt:  [[0.15]]
grads:  [0.05574181]
Stock Position:  0.0557418098395103
Bond Position:  [-8.80424796]


portfolio before change:  [-3.84004905]
curr_Stock_Price:  89.06688192663717
curr_Factors:  [89.06688193]
mat_Sqrt:  [[0.15]]
grads:  [-0.14802196]
Stock Position:  -0.1480219565300943
Bond Position:  [9.34380507]


portfolio before change:  [-3.93717144]
curr_Stock_Price:  89.72696233200112
curr_Factors:  [89.72696233]
mat_Sqrt:  [[0.15]]
grads:  [0.034298]
Stock Position:  0.03429799632134945
Bond Position:  [-7.01462646]


portfolio before change:  [-3.92349999]
curr_Stock_Price:  90.13835306758199
curr_Factors:  [90.13835307]
mat_Sqrt:  [[0.15]]
grads:  [0.17101025]
Stock Position:  0.1710102529254298
Bond Position:  [-19.33808254]


portfolio before change:  [-3.87184113]
curr_Stock_Price:  90.44750134829374
curr_Factors:  [90.44750135]
mat_Sqrt:  [[0.15]]
grads:  [-0.14080315]
Stock Position:  -0.1408031532097365
Bond Position:  [8.86345226]


portfolio before change:  [-3.78798592]
curr_Stock_Price:  89.85588656857976
curr_Factors:  [89.85588657]
mat_Sqrt:  [[0.15]]
grads:  [-0.4573041]
Stock Position:  -0.4573041041694045
Bond Position:  [37.30347979]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.78798592]
Stock Price:  89.05081409620092
PL:  [-3.78798592]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.36213348e-02]
 [-2.29347097e-03]
 [ 4.38931971e-04]
 [ 2.32218087e-03]
 [ 4.61687183e-03]
 [ 1.19234031e-02]
 [ 8.69514415e-04]
 [ 7.84884738e-03]
 [-8.82446403e-03]
 [-1.60421682e-02]
 [ 1.00028294e-02]
 [-1.03933059e-02]
 [ 2.89118948e-02]
 [ 2.44471337e-02]
 [-1.17561764e-02]
 [-8.20888564e-03]
 [ 1.29418301e-02]
 [ 2.18568168e-02]
 [-1.27684405e-02]
 [-5.64909825e-03]
 [-1.61234117e-02]
 [-8.27369648e-03]
 [-1.25363821e-02]
 [ 8.07251345e-03]
 [ 1.97835520e-02]
 [ 1.27897889e-02]
 [ 6.89262795e-03]
 [ 1.51986451e-03]
 [ 8.91725198e-03]
 [-9.18493045e-03]
 [-5.76491875e-03]
 [ 4.17484760e-02]
 [ 4.96485954e-03]
 [-4.65867237e-03]
 [-6.94858349e-03]
 [-3.81702429e-03]
 [-6.92631829e-03]
 [ 6.62390499e-03]
 [ 1.03323938e-03]
 [-8.71217094e-03]
 [-1.71241191e-02]
 [-2.46525892e-03]
 [ 1.16772881e-02]
 [-1.17545857e-02]
 [-2.32914729e-04]
 [ 2.27053942e-03]
 [-1.36617070e-02]
 [-2.35424353e-03]
 [ 4.39003320e-03]
 [-7.98043287e-03]
 [-3.69041175e-03]
 [ 3.45127849e-03]
 [ 2.31926964e-03]
 [ 1.38016650e-03]
 [-6.88068326e-03]
 [ 1.06147306e-02]
 [-1.97259356e-02]
 [-8.58672191e-03]
 [ 1.89162950e-02]
 [-1.15647802e-03]
 [ 1.28070927e-02]
 [-1.50265649e-02]
 [-1.27384818e-02]
 [-3.06787858e-03]
 [ 8.02600364e-02]
 [-1.58275225e-02]
 [ 1.34019631e-02]
 [ 5.17612744e-03]
 [ 1.25603355e-02]
 [-2.39797893e-02]
 [-7.95408133e-03]
 [-7.05927770e-03]
 [ 4.21996239e-03]
 [ 7.28120222e-03]
 [-6.59243287e-04]
 [-7.50475719e-03]
 [ 7.97008557e-03]
 [-3.82757790e-03]
 [ 2.48873431e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.86671694]
curr_Stock_Price:  99.98716318962263
curr_Factors:  [99.98716319]
mat_Sqrt:  [[0.15]]
grads:  [-0.22414223]
Stock Position:  -0.2241422322934017
Bond Position:  [24.2780629]


portfolio before change:  [1.81972306]
curr_Stock_Price:  100.20359410296678
curr_Factors:  [100.2035941]
mat_Sqrt:  [[0.15]]
grads:  [-0.01528981]
Stock Position:  -0.015289806490577658
Bond Position:  [3.35181662]


portfolio before change:  [1.82244135]
curr_Stock_Price:  100.03951151778111
curr_Factors:  [100.03951152]
mat_Sqrt:  [[0.15]]
grads:  [0.00292621]
Stock Position:  0.0029262131420403825
Bond Position:  [1.52970441]


portfolio before change:  [1.82429793]
curr_Stock_Price:  100.64130514891947
curr_Factors:  [100.64130515]
mat_Sqrt:  [[0.15]]
grads:  [0.01548121]
Stock Position:  0.015481205776892605
Bond Position:  [0.26624918]


portfolio before change:  [1.82855828]
curr_Stock_Price:  100.9154249127411
curr_Factors:  [100.91542491]
mat_Sqrt:  [[0.15]]
grads:  [0.03077915]
Stock Position:  0.030779145530517374
Bond Position:  [-1.27753227]


portfolio before change:  [1.828513]
curr_Stock_Price:  100.91654795187036
curr_Factors:  [100.91654795]
mat_Sqrt:  [[0.15]]
grads:  [0.07948935]
Stock Position:  0.07948935387591251
Bond Position:  [-6.1932782]


portfolio before change:  [1.80984678]
curr_Stock_Price:  100.6865910375436
curr_Factors:  [100.68659104]
mat_Sqrt:  [[0.15]]
grads:  [0.00579676]
Stock Position:  0.005796762765131108
Bond Position:  [1.2261905]


portfolio before change:  [1.81199645]
curr_Stock_Price:  101.04421033814404
curr_Factors:  [101.04421034]
mat_Sqrt:  [[0.15]]
grads:  [0.05232565]
Stock Position:  0.05232564921279636
Bond Position:  [-3.47520745]


portfolio before change:  [1.85007596]
curr_Stock_Price:  101.77610214253998
curr_Factors:  [101.77610214]
mat_Sqrt:  [[0.15]]
grads:  [-0.05882976]
Stock Position:  -0.058829760216192455
Bond Position:  [7.83753964]


portfolio before change:  [1.86955838]
curr_Stock_Price:  101.45326282702466
curr_Factors:  [101.45326283]
mat_Sqrt:  [[0.15]]
grads:  [-0.10694779]
Stock Position:  -0.10694778792104556
Bond Position:  [12.71976042]


portfolio before change:  [1.82938098]
curr_Stock_Price:  101.83636947504847
curr_Factors:  [101.83636948]
mat_Sqrt:  [[0.15]]
grads:  [0.06668553]
Stock Position:  0.06668552925551044
Bond Position:  [-4.96163122]


portfolio before change:  [1.85173673]
curr_Stock_Price:  102.17626126615627
curr_Factors:  [102.17626127]
mat_Sqrt:  [[0.15]]
grads:  [-0.06928871]
Stock Position:  -0.06928870598019689
Bond Position:  [8.93139766]


portfolio before change:  [1.81420449]
curr_Stock_Price:  102.72599689605283
curr_Factors:  [102.7259969]
mat_Sqrt:  [[0.15]]
grads:  [0.19274597]
Stock Position:  0.19274596503991315
Bond Position:  [-17.98581691]


portfolio before change:  [1.95952732]
curr_Stock_Price:  103.48578957583801
curr_Factors:  [103.48578958]
mat_Sqrt:  [[0.15]]
grads:  [0.16298089]
Stock Position:  0.16298089155737477
Bond Position:  [-14.90667893]


portfolio before change:  [1.99315476]
curr_Stock_Price:  103.69783368620536
curr_Factors:  [103.69783369]
mat_Sqrt:  [[0.15]]
grads:  [-0.07837451]
Stock Position:  -0.07837450903130723
Bond Position:  [10.12042156]


portfolio before change:  [2.04018616]
curr_Stock_Price:  103.10581903361486
curr_Factors:  [103.10581903]
mat_Sqrt:  [[0.15]]
grads:  [-0.0547259]
Stock Position:  -0.05472590424055929
Bond Position:  [7.68274534]


portfolio before change:  [2.03062737]
curr_Stock_Price:  103.2892601894033
curr_Factors:  [103.28926019]
mat_Sqrt:  [[0.15]]
grads:  [0.08627887]
Stock Position:  0.08627886711388681
Bond Position:  [-6.88105299]


portfolio before change:  [2.07212073]
curr_Stock_Price:  103.77516652114758
curr_Factors:  [103.77516652]
mat_Sqrt:  [[0.15]]
grads:  [0.14571211]
Stock Position:  0.1457121118590137
Bond Position:  [-13.04917794]


portfolio before change:  [2.11535026]
curr_Stock_Price:  104.07744146158323
curr_Factors:  [104.07744146]
mat_Sqrt:  [[0.15]]
grads:  [-0.08512294]
Stock Position:  -0.08512293634776405
Bond Position:  [10.97472768]


portfolio before change:  [2.03410915]
curr_Stock_Price:  105.03989711453532
curr_Factors:  [105.03989711]
mat_Sqrt:  [[0.15]]
grads:  [-0.03766065]
Stock Position:  -0.037660654987407574
Bond Position:  [5.98998047]


portfolio before change:  [2.02916949]
curr_Stock_Price:  105.18100024979059
curr_Factors:  [105.18100025]
mat_Sqrt:  [[0.15]]
grads:  [-0.10748941]
Stock Position:  -0.10748941101646223
Bond Position:  [13.33501326]


portfolio before change:  [2.02986094]
curr_Stock_Price:  105.18232151359035
curr_Factors:  [105.18232151]
mat_Sqrt:  [[0.15]]
grads:  [-0.05515798]
Stock Position:  -0.05515797656463483
Bond Position:  [7.83150496]


portfolio before change:  [2.01881605]
curr_Stock_Price:  105.39143670458903
curr_Factors:  [105.3914367]
mat_Sqrt:  [[0.15]]
grads:  [-0.08357588]
Stock Position:  -0.08357588090782403
Bond Position:  [10.82699821]


portfolio before change:  [2.03340321]
curr_Stock_Price:  105.22499569615529
curr_Factors:  [105.2249957]
mat_Sqrt:  [[0.15]]
grads:  [0.05381676]
Stock Position:  0.053816756309420094
Bond Position:  [-3.62946474]


portfolio before change:  [2.05671657]
curr_Stock_Price:  105.66240982659747
curr_Factors:  [105.66240983]
mat_Sqrt:  [[0.15]]
grads:  [0.13189035]
Stock Position:  0.131890346538263
Bond Position:  [-11.87913527]


portfolio before change:  [1.97626485]
curr_Stock_Price:  105.05804976448317
curr_Factors:  [105.05804976]
mat_Sqrt:  [[0.15]]
grads:  [0.08526526]
Stock Position:  0.08526525939023032
Bond Position:  [-6.98153702]


portfolio before change:  [1.93911972]
curr_Stock_Price:  104.62752549735846
curr_Factors:  [104.6275255]
mat_Sqrt:  [[0.15]]
grads:  [0.04595085]
Stock Position:  0.04595085297019237
Bond Position:  [-2.86860432]


portfolio before change:  [1.92140778]
curr_Stock_Price:  104.24597332195926
curr_Factors:  [104.24597332]
mat_Sqrt:  [[0.15]]
grads:  [0.01013243]
Stock Position:  0.010132430067268546
Bond Position:  [0.86514275]


portfolio before change:  [1.92415539]
curr_Stock_Price:  104.51180657992089
curr_Factors:  [104.51180658]
mat_Sqrt:  [[0.15]]
grads:  [0.05944835]
Stock Position:  0.05944834655875412
Bond Position:  [-4.2888987]


portfolio before change:  [1.93990987]
curr_Stock_Price:  104.7813269377784
curr_Factors:  [104.78132694]
mat_Sqrt:  [[0.15]]
grads:  [-0.06123287]
Stock Position:  -0.061232869646085125
Bond Position:  [8.3559712]


portfolio before change:  [1.98298191]
curr_Stock_Price:  104.08644226872542
curr_Factors:  [104.08644227]
mat_Sqrt:  [[0.15]]
grads:  [-0.03843279]
Stock Position:  -0.03843279167037844
Bond Position:  [5.98331447]


portfolio before change:  [1.98541656]
curr_Stock_Price:  104.03282467026771
curr_Factors:  [104.03282467]
mat_Sqrt:  [[0.15]]
grads:  [0.27832317]
Stock Position:  0.2783231734614871
Bond Position:  [-26.96932935]


portfolio before change:  [1.90527802]
curr_Stock_Price:  103.75094766506274
curr_Factors:  [103.75094767]
mat_Sqrt:  [[0.15]]
grads:  [0.03309906]
Stock Position:  0.03309906360381748
Bond Position:  [-1.5287812]


portfolio before change:  [1.88155878]
curr_Stock_Price:  103.03722091841468
curr_Factors:  [103.03722092]
mat_Sqrt:  [[0.15]]
grads:  [-0.03105782]
Stock Position:  -0.031057815801695702
Bond Position:  [5.08166981]


portfolio before change:  [1.86344766]
curr_Stock_Price:  103.63058946757236
curr_Factors:  [103.63058947]
mat_Sqrt:  [[0.15]]
grads:  [-0.04632389]
Stock Position:  -0.04632388990739217
Bond Position:  [6.66401968]


portfolio before change:  [1.88487408]
curr_Stock_Price:  103.1770458512657
curr_Factors:  [103.17704585]
mat_Sqrt:  [[0.15]]
grads:  [-0.02544683]
Stock Position:  -0.02544682860219182
Bond Position:  [4.51040268]


portfolio before change:  [1.91257124]
curr_Stock_Price:  102.09969152270196
curr_Factors:  [102.09969152]
mat_Sqrt:  [[0.15]]
grads:  [-0.04617546]
Stock Position:  -0.04617545524085334
Bond Position:  [6.62707098]


portfolio before change:  [1.92573124]
curr_Stock_Price:  101.82366195972152
curr_Factors:  [101.82366196]
mat_Sqrt:  [[0.15]]
grads:  [0.04415937]
Stock Position:  0.044159366578357354
Bond Position:  [-2.57073718]


portfolio before change:  [1.93126876]
curr_Stock_Price:  101.95269918556286
curr_Factors:  [101.95269919]
mat_Sqrt:  [[0.15]]
grads:  [0.00688826]
Stock Position:  0.006888262504006976
Bond Position:  [1.22899181]


portfolio before change:  [1.931897]
curr_Stock_Price:  102.0327509435791
curr_Factors:  [102.03275094]
mat_Sqrt:  [[0.15]]
grads:  [-0.05808114]
Stock Position:  -0.05808113957593209
Bond Position:  [7.85807544]


portfolio before change:  [1.96236579]
curr_Stock_Price:  101.51661689399027
curr_Factors:  [101.51661689]
mat_Sqrt:  [[0.15]]
grads:  [-0.11416079]
Stock Position:  -0.11416079416936487
Bond Position:  [13.5515834]


portfolio before change:  [1.92264073]
curr_Stock_Price:  101.8720109473608
curr_Factors:  [101.87201095]
mat_Sqrt:  [[0.15]]
grads:  [-0.01643506]
Stock Position:  -0.01643505945627296
Bond Position:  [3.59691328]


portfolio before change:  [1.91462006]
curr_Stock_Price:  102.373711509594
curr_Factors:  [102.37371151]
mat_Sqrt:  [[0.15]]
grads:  [0.07784859]
Stock Position:  0.07784858721899024
Bond Position:  [-6.05502875]


portfolio before change:  [1.89694084]
curr_Stock_Price:  102.15147538736066
curr_Factors:  [102.15147539]
mat_Sqrt:  [[0.15]]
grads:  [-0.0783639]
Stock Position:  -0.07836390457765313
Bond Position:  [9.90192931]


portfolio before change:  [1.87135656]
curr_Stock_Price:  102.48585345160704
curr_Factors:  [102.48585345]
mat_Sqrt:  [[0.15]]
grads:  [-0.00155276]
Stock Position:  -0.0015527648619084531
Bond Position:  [2.030493]


portfolio before change:  [1.87181043]
curr_Stock_Price:  102.27529123417204
curr_Factors:  [102.27529123]
mat_Sqrt:  [[0.15]]
grads:  [0.01513693]
Stock Position:  0.015136929440729639
Bond Position:  [0.32367656]


portfolio before change:  [1.86915234]
curr_Stock_Price:  102.09835229981671
curr_Factors:  [102.0983523]
mat_Sqrt:  [[0.15]]
grads:  [-0.09107805]
Stock Position:  -0.0910780467743059
Bond Position:  [11.16807085]


portfolio before change:  [1.88294087]
curr_Stock_Price:  101.95462397732143
curr_Factors:  [101.95462398]
mat_Sqrt:  [[0.15]]
grads:  [-0.01569496]
Stock Position:  -0.015694956846166997
Bond Position:  [3.48311429]


portfolio before change:  [1.87260875]
curr_Stock_Price:  102.62680304387203
curr_Factors:  [102.62680304]
mat_Sqrt:  [[0.15]]
grads:  [0.02926689]
Stock Position:  0.029266888026067476
Bond Position:  [-1.13095841]


portfolio before change:  [1.88708793]
curr_Stock_Price:  103.12394738161234
curr_Factors:  [103.12394738]
mat_Sqrt:  [[0.15]]
grads:  [-0.05320289]
Stock Position:  -0.053202885787097406
Bond Position:  [7.37357952]


portfolio before change:  [1.86935449]
curr_Stock_Price:  103.46592698521592
curr_Factors:  [103.46592699]
mat_Sqrt:  [[0.15]]
grads:  [-0.02460274]
Stock Position:  -0.02460274497381153
Bond Position:  [4.4149003]


portfolio before change:  [1.86453837]
curr_Stock_Price:  103.67289818729876
curr_Factors:  [103.67289819]
mat_Sqrt:  [[0.15]]
grads:  [0.02300852]
Stock Position:  0.023008523272434966
Bond Position:  [-0.52082192]


portfolio before change:  [1.86451826]
curr_Stock_Price:  103.67343907477154
curr_Factors:  [103.67343907]
mat_Sqrt:  [[0.15]]
grads:  [0.0154618]
Stock Position:  0.01546179761980113
Bond Position:  [0.26154053]


portfolio before change:  [1.86539743]
curr_Stock_Price:  103.72924232252896
curr_Factors:  [103.72924232]
mat_Sqrt:  [[0.15]]
grads:  [0.00920111]
Stock Position:  0.009201109987326985
Bond Position:  [0.91097326]


portfolio before change:  [1.86718896]
curr_Stock_Price:  103.9177624134152
curr_Factors:  [103.91776241]
mat_Sqrt:  [[0.15]]
grads:  [-0.04587122]
Stock Position:  -0.04587122175311718
Bond Position:  [6.63402368]


portfolio before change:  [1.85597748]
curr_Stock_Price:  104.17121352446985
curr_Factors:  [104.17121352]
mat_Sqrt:  [[0.15]]
grads:  [0.07076487]
Stock Position:  0.07076487038423707
Bond Position:  [-5.51568494]


portfolio before change:  [1.89155425]
curr_Stock_Price:  104.67883123852646
curr_Factors:  [104.67883124]
mat_Sqrt:  [[0.15]]
grads:  [-0.13150624]
Stock Position:  -0.13150623726202165
Bond Position:  [15.65747346]


portfolio before change:  [1.83234524]
curr_Stock_Price:  105.13651010648762
curr_Factors:  [105.13651011]
mat_Sqrt:  [[0.15]]
grads:  [-0.05724481]
Stock Position:  -0.05724481275372053
Bond Position:  [7.85086508]


portfolio before change:  [1.80736073]
curr_Stock_Price:  105.58153221718418
curr_Factors:  [105.58153222]
mat_Sqrt:  [[0.15]]
grads:  [0.12610863]
Stock Position:  0.12610863307913506
Bond Position:  [-11.50738198]


portfolio before change:  [1.62054537]
curr_Stock_Price:  104.10585109684949
curr_Factors:  [104.1058511]
mat_Sqrt:  [[0.15]]
grads:  [-0.00770985]
Stock Position:  -0.007709853468474016
Bond Position:  [2.42318622]


portfolio before change:  [1.62278004]
curr_Stock_Price:  103.83564942685098
curr_Factors:  [103.83564943]
mat_Sqrt:  [[0.15]]
grads:  [0.08538062]
Stock Position:  0.08538061823464872
Bond Position:  [-7.24277191]


portfolio before change:  [1.6166938]
curr_Stock_Price:  103.769667816334
curr_Factors:  [103.76966782]
mat_Sqrt:  [[0.15]]
grads:  [-0.1001771]
Stock Position:  -0.10017709945510236
Bond Position:  [12.01203813]


portfolio before change:  [1.49454982]
curr_Stock_Price:  104.99644271212863
curr_Factors:  [104.99644271]
mat_Sqrt:  [[0.15]]
grads:  [-0.08492321]
Stock Position:  -0.08492321210587223
Bond Position:  [10.411185]


portfolio before change:  [1.46373377]
curr_Stock_Price:  105.36697481228946
curr_Factors:  [105.36697481]
mat_Sqrt:  [[0.15]]
grads:  [-0.02045252]
Stock Position:  -0.02045252386976834
Bond Position:  [3.61875433]


portfolio before change:  [1.45041012]
curr_Stock_Price:  106.02947639540447
curr_Factors:  [106.0294764]
mat_Sqrt:  [[0.15]]
grads:  [0.53506691]
Stock Position:  0.5350669090188609
Bond Position:  [-55.28245408]


portfolio before change:  [1.15477054]
curr_Stock_Price:  105.48340578446322
curr_Factors:  [105.48340578]
mat_Sqrt:  [[0.15]]
grads:  [-0.10551682]
Stock Position:  -0.10551681645279166
Bond Position:  [12.28504371]


portfolio before change:  [1.1745917]
curr_Stock_Price:  105.30283435450222
curr_Factors:  [105.30283435]
mat_Sqrt:  [[0.15]]
grads:  [0.08934642]
Stock Position:  0.08934642097491442
Bond Position:  [-8.23383967]


portfolio before change:  [1.21327058]
curr_Stock_Price:  105.74150335735912
curr_Factors:  [105.74150336]
mat_Sqrt:  [[0.15]]
grads:  [0.03450752]
Stock Position:  0.03450751626186908
Bond Position:  [-2.43560607]


portfolio before change:  [1.20554473]
curr_Stock_Price:  105.52202596274158
curr_Factors:  [105.52202596]
mat_Sqrt:  [[0.15]]
grads:  [0.08373557]
Stock Position:  0.08373557011785494
Bond Position:  [-7.63040228]


portfolio before change:  [1.17126802]
curr_Stock_Price:  105.11837680643578
curr_Factors:  [105.11837681]
mat_Sqrt:  [[0.15]]
grads:  [-0.15986526]
Stock Position:  -0.1598652618595858
Bond Position:  [17.97604485]


portfolio before change:  [1.15465182]
curr_Stock_Price:  105.22934362029252
curr_Factors:  [105.22934362]
mat_Sqrt:  [[0.15]]
grads:  [-0.05302721]
Stock Position:  -0.05302720889833851
Bond Position:  [6.73467021]


portfolio before change:  [1.21593581]
curr_Stock_Price:  104.08157327493666
curr_Factors:  [104.08157327]
mat_Sqrt:  [[0.15]]
grads:  [-0.04706185]
Stock Position:  -0.04706185132734722
Bond Position:  [6.11420733]


portfolio before change:  [1.25089667]
curr_Stock_Price:  103.34682296252143
curr_Factors:  [103.34682296]
mat_Sqrt:  [[0.15]]
grads:  [0.02813308]
Stock Position:  0.02813308263123716
Bond Position:  [-1.65656804]


portfolio before change:  [1.24883681]
curr_Stock_Price:  103.27728496693929
curr_Factors:  [103.27728497]
mat_Sqrt:  [[0.15]]
grads:  [0.04854135]
Stock Position:  0.04854134814439278
Bond Position:  [-3.76438184]


portfolio before change:  [1.22741591]
curr_Stock_Price:  102.84084017159259
curr_Factors:  [102.84084017]
mat_Sqrt:  [[0.15]]
grads:  [-0.00439496]
Stock Position:  -0.004394955248141845
Bond Position:  [1.6793968]


portfolio before change:  [1.22427252]
curr_Stock_Price:  103.57994910697484
curr_Factors:  [103.57994911]
mat_Sqrt:  [[0.15]]
grads:  [-0.05003171]
Stock Position:  -0.050031714586512226
Bond Position:  [6.40655498]


portfolio before change:  [1.21160839]
curr_Stock_Price:  103.84107459995002
curr_Factors:  [103.8410746]
mat_Sqrt:  [[0.15]]
grads:  [0.0531339]
Stock Position:  0.053133903783312404
Bond Position:  [-4.30587328]


portfolio before change:  [1.23142097]
curr_Stock_Price:  104.21901987944852
curr_Factors:  [104.21901988]
mat_Sqrt:  [[0.15]]
grads:  [-0.02551719]
Stock Position:  -0.025517185968477372
Bond Position:  [3.89079708]


portfolio before change:  [1.24846238]
curr_Stock_Price:  103.56070983212139
curr_Factors:  [103.56070983]
mat_Sqrt:  [[0.15]]
grads:  [0.16591562]
Stock Position:  0.16591562060244536
Bond Position:  [-15.93387707]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.24846238]
Stock Price:  102.77236444879152
PL:  [-1.52390207]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.43401220e-02]
 [ 3.08149622e-03]
 [ 4.54704664e-04]
 [ 2.49714728e-03]
 [ 8.85306645e-03]
 [ 1.17565177e-02]
 [ 1.20551933e-03]
 [ 1.06455304e-02]
 [ 1.60647731e-02]
 [-2.00407477e-02]
 [ 1.01758217e-02]
 [-9.57307700e-03]
 [ 4.90806238e-03]
 [ 4.11100688e-03]
 [ 6.41368510e-03]
 [-5.94513092e-03]
 [ 1.23438614e-02]
 [ 2.28107457e-02]
 [ 1.82271015e-02]
 [-1.49158903e-03]
 [ 3.36056597e-02]
 [-9.86876809e-03]
 [-4.01480081e-03]
 [ 4.47832437e-03]
 [ 1.83214299e-02]
 [ 1.70099925e-02]
 [ 7.84972835e-03]
 [ 4.08294078e-03]
 [ 7.96398244e-03]
 [-1.10887020e-02]
 [-5.71981126e-03]
 [ 3.66869806e-02]
 [ 7.26552085e-03]
 [ 8.99353190e-03]
 [ 3.24898225e-03]
 [-4.30507014e-03]
 [-6.66189034e-03]
 [ 3.41578448e-03]
 [ 2.72083918e-03]
 [-8.37552888e-03]
 [-3.20941080e-02]
 [-2.40699540e-03]
 [ 1.37678622e-02]
 [-1.16141261e-02]
 [-1.73303459e-03]
 [ 2.66066323e-03]
 [-1.35691597e-02]
 [ 2.05178796e-02]
 [ 3.30583776e-02]
 [-1.31694373e-02]
 [-4.69477806e-03]
 [ 3.62414806e-03]
 [ 3.28746313e-03]
 [-2.40378965e-03]
 [-8.97565191e-03]
 [ 1.16077660e-02]
 [-2.33890241e-02]
 [-1.05466707e-02]
 [ 1.61320252e-02]
 [ 2.98444775e-03]
 [ 9.98410704e-03]
 [-1.27792619e-02]
 [-1.25445750e-02]
 [-2.00855909e-03]
 [-1.23069399e-02]
 [-8.55751381e-03]
 [ 1.09042714e-02]
 [ 2.24858263e-03]
 [ 9.41012420e-03]
 [-1.71411780e-02]
 [ 1.95431071e-03]
 [ 1.59042986e-03]
 [-2.36868888e-03]
 [ 7.62059270e-03]
 [-3.46654843e-03]
 [ 2.78249470e-03]
 [ 9.45755440e-03]
 [-1.28243633e-02]
 [-3.48451310e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.60093029]
curr_Stock_Price:  99.82856587432795
curr_Factors:  [99.82856587]
mat_Sqrt:  [[0.15]]
grads:  [-0.22893415]
Stock Position:  -0.22893414670939416
Bond Position:  [22.25323726]


portfolio before change:  [-0.48968471]
curr_Stock_Price:  99.3487129958574
curr_Factors:  [99.348713]
mat_Sqrt:  [[0.15]]
grads:  [0.02054331]
Stock Position:  0.020543308146040433
Bond Position:  [-2.53063593]


portfolio before change:  [-0.47573197]
curr_Stock_Price:  100.03559899897512
curr_Factors:  [100.035599]
mat_Sqrt:  [[0.15]]
grads:  [0.00303136]
Stock Position:  0.003031364429290226
Bond Position:  [-0.77897633]


portfolio before change:  [-0.47307292]
curr_Stock_Price:  100.92883856397845
curr_Factors:  [100.92883856]
mat_Sqrt:  [[0.15]]
grads:  [0.01664765]
Stock Position:  0.01664764855771496
Bond Position:  [-2.15330076]


portfolio before change:  [-0.48012463]
curr_Stock_Price:  100.51333734109805
curr_Factors:  [100.51333734]
mat_Sqrt:  [[0.15]]
grads:  [0.05902044]
Stock Position:  0.05902044297208353
Bond Position:  [-6.41246632]


portfolio before change:  [-0.48919579]
curr_Stock_Price:  100.36643271831645
curr_Factors:  [100.36643272]
mat_Sqrt:  [[0.15]]
grads:  [0.07837678]
Stock Position:  0.07837678463254685
Bond Position:  [-8.35559407]


portfolio before change:  [-0.50637522]
curr_Stock_Price:  100.15390561409076
curr_Factors:  [100.15390561]
mat_Sqrt:  [[0.15]]
grads:  [0.0080368]
Stock Position:  0.008036795527791414
Bond Position:  [-1.31129169]


portfolio before change:  [-0.50526256]
curr_Stock_Price:  100.30255021283031
curr_Factors:  [100.30255021]
mat_Sqrt:  [[0.15]]
grads:  [0.0709702]
Stock Position:  0.07097020259258607
Bond Position:  [-7.62375487]


portfolio before change:  [-0.54585539]
curr_Stock_Price:  99.73729421200773
curr_Factors:  [99.73729421]
mat_Sqrt:  [[0.15]]
grads:  [0.10709849]
Stock Position:  0.10709848742517866
Bond Position:  [-11.22756874]


portfolio before change:  [-0.48477722]
curr_Stock_Price:  100.31414564495718
curr_Factors:  [100.31414564]
mat_Sqrt:  [[0.15]]
grads:  [-0.13360498]
Stock Position:  -0.13360498472279791
Bond Position:  [12.91769268]


portfolio before change:  [-0.576442]
curr_Stock_Price:  101.00627669677023
curr_Factors:  [101.0062767]
mat_Sqrt:  [[0.15]]
grads:  [0.06783881]
Stock Position:  0.06783881134786753
Bond Position:  [-7.42858775]


portfolio before change:  [-0.51506685]
curr_Stock_Price:  101.91784112678938
curr_Factors:  [101.91784113]
mat_Sqrt:  [[0.15]]
grads:  [-0.06382051]
Stock Position:  -0.0638205133584316
Bond Position:  [5.98938209]


portfolio before change:  [-0.44818252]
curr_Stock_Price:  100.87570006982898
curr_Factors:  [100.87570007]
mat_Sqrt:  [[0.15]]
grads:  [0.03272042]
Stock Position:  0.032720415837245616
Bond Position:  [-3.74887738]


portfolio before change:  [-0.43922117]
curr_Stock_Price:  101.15673768599423
curr_Factors:  [101.15673769]
mat_Sqrt:  [[0.15]]
grads:  [0.02740671]
Stock Position:  0.027406712566137754
Bond Position:  [-3.2115948]


portfolio before change:  [-0.46004127]
curr_Stock_Price:  100.40439022385956
curr_Factors:  [100.40439022]
mat_Sqrt:  [[0.15]]
grads:  [0.0427579]
Stock Position:  0.04275790069654226
Bond Position:  [-4.75312222]


portfolio before change:  [-0.4574688]
curr_Stock_Price:  100.47150184999434
curr_Factors:  [100.47150185]
mat_Sqrt:  [[0.15]]
grads:  [-0.03963421]
Stock Position:  -0.03963420614231619
Bond Position:  [3.52463942]


portfolio before change:  [-0.49103908]
curr_Stock_Price:  101.32406292799057
curr_Factors:  [101.32406293]
mat_Sqrt:  [[0.15]]
grads:  [0.08229241]
Stock Position:  0.0822924094507417
Bond Position:  [-8.82924036]


portfolio before change:  [-0.47670386]
curr_Stock_Price:  101.50496738304943
curr_Factors:  [101.50496738]
mat_Sqrt:  [[0.15]]
grads:  [0.15207164]
Stock Position:  0.15207163806854954
Bond Position:  [-15.91273053]


portfolio before change:  [-0.45388977]
curr_Stock_Price:  101.66152955374005
curr_Factors:  [101.66152955]
mat_Sqrt:  [[0.15]]
grads:  [0.12151401]
Stock Position:  0.12151401021941534
Bond Position:  [-12.80718992]


portfolio before change:  [-0.36597528]
curr_Stock_Price:  102.39160974409744
curr_Factors:  [102.39160974]
mat_Sqrt:  [[0.15]]
grads:  [-0.00994393]
Stock Position:  -0.00994392685356139
Bond Position:  [0.6521994]


portfolio before change:  [-0.37217269]
curr_Stock_Price:  103.01894464577327
curr_Factors:  [103.01894465]
mat_Sqrt:  [[0.15]]
grads:  [0.22403773]
Stock Position:  0.22403773115212783
Bond Position:  [-23.45230331]


portfolio before change:  [-0.14643934]
curr_Stock_Price:  104.03305578865591
curr_Factors:  [104.03305579]
mat_Sqrt:  [[0.15]]
grads:  [-0.06579179]
Stock Position:  -0.06579178726245606
Bond Position:  [6.69808133]


portfolio before change:  [-0.15398508]
curr_Stock_Price:  104.15411016163326
curr_Factors:  [104.15411016]
mat_Sqrt:  [[0.15]]
grads:  [-0.02676534]
Stock Position:  -0.026765338716279962
Bond Position:  [2.63373496]


portfolio before change:  [-0.15916804]
curr_Stock_Price:  104.35390490941869
curr_Factors:  [104.35390491]
mat_Sqrt:  [[0.15]]
grads:  [0.0298555]
Stock Position:  0.029855495774955883
Bond Position:  [-3.27470561]


portfolio before change:  [-0.16705929]
curr_Stock_Price:  104.09644585822551
curr_Factors:  [104.09644586]
mat_Sqrt:  [[0.15]]
grads:  [0.12214287]
Stock Position:  0.12214286627107807
Bond Position:  [-12.88169755]


portfolio before change:  [-0.24881475]
curr_Stock_Price:  103.43369460888013
curr_Factors:  [103.43369461]
mat_Sqrt:  [[0.15]]
grads:  [0.11339995]
Stock Position:  0.11339994995221271
Bond Position:  [-11.97819055]


portfolio before change:  [-0.18401771]
curr_Stock_Price:  104.01169927795274
curr_Factors:  [104.01169928]
mat_Sqrt:  [[0.15]]
grads:  [0.05233152]
Stock Position:  0.05233152236505871
Bond Position:  [-5.62710828]


portfolio before change:  [-0.15205725]
curr_Stock_Price:  104.62915068443868
curr_Factors:  [104.62915068]
mat_Sqrt:  [[0.15]]
grads:  [0.02721961]
Stock Position:  0.027219605167679736
Bond Position:  [-3.00002142]


portfolio before change:  [-0.1733002]
curr_Stock_Price:  103.85561079883367
curr_Factors:  [103.8556108]
mat_Sqrt:  [[0.15]]
grads:  [0.05309322]
Stock Position:  0.05309321627724374
Bond Position:  [-5.68732861]


portfolio before change:  [-0.21248293]
curr_Stock_Price:  103.12430723272097
curr_Factors:  [103.12430723]
mat_Sqrt:  [[0.15]]
grads:  [-0.07392468]
Stock Position:  -0.07392467975930715
Bond Position:  [7.41094846]


portfolio before change:  [-0.21289506]
curr_Stock_Price:  103.1361480044851
curr_Factors:  [103.136148]
mat_Sqrt:  [[0.15]]
grads:  [-0.03813208]
Stock Position:  -0.038132075049155924
Bond Position:  [3.71990028]


portfolio before change:  [-0.20034682]
curr_Stock_Price:  102.81317216732333
curr_Factors:  [102.81317217]
mat_Sqrt:  [[0.15]]
grads:  [0.24457987]
Stock Position:  0.2445798707433449
Bond Position:  [-25.34637918]


portfolio before change:  [-0.37501923]
curr_Stock_Price:  102.10547608248108
curr_Factors:  [102.10547608]
mat_Sqrt:  [[0.15]]
grads:  [0.04843681]
Stock Position:  0.04843680564873005
Bond Position:  [-5.32068233]


portfolio before change:  [-0.41813049]
curr_Stock_Price:  101.22229013905722
curr_Factors:  [101.22229014]
mat_Sqrt:  [[0.15]]
grads:  [0.05995688]
Stock Position:  0.059956879343763515
Bond Position:  [-6.48710313]


portfolio before change:  [-0.4352308]
curr_Stock_Price:  100.94384257678522
curr_Factors:  [100.94384258]
mat_Sqrt:  [[0.15]]
grads:  [0.02165988]
Stock Position:  0.021659881655641998
Bond Position:  [-2.62166248]


portfolio before change:  [-0.43546507]
curr_Stock_Price:  100.94059185108269
curr_Factors:  [100.94059185]
mat_Sqrt:  [[0.15]]
grads:  [-0.02870047]
Stock Position:  -0.028700467602903543
Bond Position:  [2.46157712]


portfolio before change:  [-0.44408494]
curr_Stock_Price:  101.24629178511279
curr_Factors:  [101.24629179]
mat_Sqrt:  [[0.15]]
grads:  [-0.0444126]
Stock Position:  -0.044412602239339474
Bond Position:  [4.05252634]


portfolio before change:  [-0.51788231]
curr_Stock_Price:  102.91362618278028
curr_Factors:  [102.91362618]
mat_Sqrt:  [[0.15]]
grads:  [0.0227719]
Stock Position:  0.022771896562176465
Bond Position:  [-2.86142076]


portfolio before change:  [-0.51586945]
curr_Stock_Price:  103.00987241319996
curr_Factors:  [103.00987241]
mat_Sqrt:  [[0.15]]
grads:  [0.01813893]
Stock Position:  0.0181389278658474
Bond Position:  [-2.38435809]


portfolio before change:  [-0.52300755]
curr_Stock_Price:  102.62456432563287
curr_Factors:  [102.62456433]
mat_Sqrt:  [[0.15]]
grads:  [-0.05583686]
Stock Position:  -0.055836859188248086
Bond Position:  [5.2072258]


portfolio before change:  [-0.52450817]
curr_Stock_Price:  102.65726817075789
curr_Factors:  [102.65726817]
mat_Sqrt:  [[0.15]]
grads:  [-0.21396072]
Stock Position:  -0.21396072023670912
Bond Position:  [21.44011487]


portfolio before change:  [-0.50636074]
curr_Stock_Price:  102.57871460056127
curr_Factors:  [102.5787146]
mat_Sqrt:  [[0.15]]
grads:  [-0.01604664]
Stock Position:  -0.016046635997814994
Bond Position:  [1.13968255]


portfolio before change:  [-0.5190664]
curr_Stock_Price:  103.37494944695837
curr_Factors:  [103.37494945]
mat_Sqrt:  [[0.15]]
grads:  [0.09178575]
Stock Position:  0.09178574788388286
Bond Position:  [-10.00741345]


portfolio before change:  [-0.57730815]
curr_Stock_Price:  102.74722383807108
curr_Factors:  [102.74722384]
mat_Sqrt:  [[0.15]]
grads:  [-0.07742751]
Stock Position:  -0.07742750717073454
Bond Position:  [7.37815326]


portfolio before change:  [-0.64509479]
curr_Stock_Price:  103.6286650176753
curr_Factors:  [103.62866502]
mat_Sqrt:  [[0.15]]
grads:  [-0.01155356]
Stock Position:  -0.011553563938150992
Bond Position:  [0.55218562]


portfolio before change:  [-0.6538033]
curr_Stock_Price:  104.38540336171408
curr_Factors:  [104.38540336]
mat_Sqrt:  [[0.15]]
grads:  [0.01773775]
Stock Position:  0.017737754862648964
Bond Position:  [-2.505366]


portfolio before change:  [-0.63787735]
curr_Stock_Price:  105.29208752918015
curr_Factors:  [105.29208753]
mat_Sqrt:  [[0.15]]
grads:  [-0.09046106]
Stock Position:  -0.09046106447928332
Bond Position:  [8.88695697]


portfolio before change:  [-0.70049843]
curr_Stock_Price:  105.99047117565524
curr_Factors:  [105.99047118]
mat_Sqrt:  [[0.15]]
grads:  [0.13678586]
Stock Position:  0.13678586428283449
Bond Position:  [-15.19849663]


portfolio before change:  [-0.68463286]
curr_Stock_Price:  106.11340425226655
curr_Factors:  [106.11340425]
mat_Sqrt:  [[0.15]]
grads:  [0.22038918]
Stock Position:  0.22038918384963038
Bond Position:  [-24.07087941]


portfolio before change:  [-0.7393973]
curr_Stock_Price:  105.87174099747877
curr_Factors:  [105.871741]
mat_Sqrt:  [[0.15]]
grads:  [-0.08779625]
Stock Position:  -0.08779624847389969
Bond Position:  [8.55574438]


portfolio before change:  [-0.76407572]
curr_Stock_Price:  106.15891926373763
curr_Factors:  [106.15891926]
mat_Sqrt:  [[0.15]]
grads:  [-0.03129852]
Stock Position:  -0.03129852038906304
Bond Position:  [2.55854138]


portfolio before change:  [-0.74939132]
curr_Stock_Price:  105.69485610330936
curr_Factors:  [105.6948561]
mat_Sqrt:  [[0.15]]
grads:  [0.02416099]
Stock Position:  0.024160987073077508
Bond Position:  [-3.30308337]


portfolio before change:  [-0.75483117]
curr_Stock_Price:  105.47825068176132
curr_Factors:  [105.47825068]
mat_Sqrt:  [[0.15]]
grads:  [0.02191642]
Stock Position:  0.02191642089047733
Bond Position:  [-3.06653691]


portfolio before change:  [-0.76378015]
curr_Stock_Price:  105.0786726276721
curr_Factors:  [105.07867263]
mat_Sqrt:  [[0.15]]
grads:  [-0.01602526]
Stock Position:  -0.016025264308684447
Bond Position:  [0.92013335]


portfolio before change:  [-0.76163183]
curr_Stock_Price:  104.94820295976122
curr_Factors:  [104.94820296]
mat_Sqrt:  [[0.15]]
grads:  [-0.05983768]
Stock Position:  -0.05983767943165571
Bond Position:  [5.51822509]


portfolio before change:  [-0.76357971]
curr_Stock_Price:  104.98651956867302
curr_Factors:  [104.98651957]
mat_Sqrt:  [[0.15]]
grads:  [0.07738511]
Stock Position:  0.07738510649138193
Bond Position:  [-8.88797271]


portfolio before change:  [-0.76285165]
curr_Stock_Price:  105.00310640164818
curr_Factors:  [105.0031064]
mat_Sqrt:  [[0.15]]
grads:  [-0.15592683]
Stock Position:  -0.155926827298702
Bond Position:  [15.60994958]


portfolio before change:  [-0.53872912]
curr_Stock_Price:  103.57200641614546
curr_Factors:  [103.57200642]
mat_Sqrt:  [[0.15]]
grads:  [-0.07031114]
Stock Position:  -0.07031113789745672
Bond Position:  [6.74353651]


portfolio before change:  [-0.55697273]
curr_Stock_Price:  103.83747065379006
curr_Factors:  [103.83747065]
mat_Sqrt:  [[0.15]]
grads:  [0.10754683]
Stock Position:  0.10754683482088244
Bond Position:  [-11.72436403]


portfolio before change:  [-0.6928481]
curr_Stock_Price:  102.5808779134475
curr_Factors:  [102.58087791]
mat_Sqrt:  [[0.15]]
grads:  [0.01989632]
Stock Position:  0.01989631835695811
Bond Position:  [-2.7338299]


portfolio before change:  [-0.71345782]
curr_Stock_Price:  101.5536097728251
curr_Factors:  [101.55360977]
mat_Sqrt:  [[0.15]]
grads:  [0.06656071]
Stock Position:  0.06656071358770108
Bond Position:  [-7.47293855]


portfolio before change:  [-0.76920109]
curr_Stock_Price:  100.72314693317277
curr_Factors:  [100.72314693]
mat_Sqrt:  [[0.15]]
grads:  [-0.08519508]
Stock Position:  -0.08519507955385175
Bond Position:  [7.81191542]


portfolio before change:  [-0.72950487]
curr_Stock_Price:  100.26293300700284
curr_Factors:  [100.26293301]
mat_Sqrt:  [[0.15]]
grads:  [-0.0836305]
Stock Position:  -0.08363049988669098
Bond Position:  [7.65553434]


portfolio before change:  [-0.66531362]
curr_Stock_Price:  99.50109649083737
curr_Factors:  [99.50109649]
mat_Sqrt:  [[0.15]]
grads:  [-0.01339039]
Stock Position:  -0.013390393950594371
Bond Position:  [0.66704526]


portfolio before change:  [-0.66009611]
curr_Stock_Price:  99.1145649514748
curr_Factors:  [99.11456495]
mat_Sqrt:  [[0.15]]
grads:  [-0.08204627]
Stock Position:  -0.08204626584927759
Bond Position:  [7.47188383]


portfolio before change:  [-0.5910729]
curr_Stock_Price:  98.27898504694585
curr_Factors:  [98.27898505]
mat_Sqrt:  [[0.15]]
grads:  [-0.05705009]
Stock Position:  -0.05705009209546493
Bond Position:  [5.01575225]


portfolio before change:  [-0.60512898]
curr_Stock_Price:  98.53086158162732
curr_Factors:  [98.53086158]
mat_Sqrt:  [[0.15]]
grads:  [0.07269514]
Stock Position:  0.07269514269434345
Bond Position:  [-7.76784402]


portfolio before change:  [-0.61884105]
curr_Stock_Price:  98.34891601140644
curr_Factors:  [98.34891601]
mat_Sqrt:  [[0.15]]
grads:  [0.01499055]
Stock Position:  0.01499055088597655
Bond Position:  [-2.09314548]


portfolio before change:  [-0.62155587]
curr_Stock_Price:  98.17654076147915
curr_Factors:  [98.17654076]
mat_Sqrt:  [[0.15]]
grads:  [0.06273416]
Stock Position:  0.06273416131898464
Bond Position:  [-6.78057882]


portfolio before change:  [-0.62342932]
curr_Stock_Price:  98.15343293726777
curr_Factors:  [98.15343294]
mat_Sqrt:  [[0.15]]
grads:  [-0.11427452]
Stock Position:  -0.11427452009123164
Bond Position:  [10.59300712]


portfolio before change:  [-0.57363096]
curr_Stock_Price:  97.7234483619389
curr_Factors:  [97.72344836]
mat_Sqrt:  [[0.15]]
grads:  [0.01302874]
Stock Position:  0.013028738077241926
Bond Position:  [-1.84684417]


portfolio before change:  [-0.58307039]
curr_Stock_Price:  97.00779927723497
curr_Factors:  [97.00779928]
mat_Sqrt:  [[0.15]]
grads:  [0.01060287]
Stock Position:  0.010602865756761231
Bond Position:  [-1.61163107]


portfolio before change:  [-0.59272183]
curr_Stock_Price:  96.10703303749538
curr_Factors:  [96.10703304]
mat_Sqrt:  [[0.15]]
grads:  [-0.01579126]
Stock Position:  -0.015791259167661425
Bond Position:  [0.92492924]


portfolio before change:  [-0.59418863]
curr_Stock_Price:  96.20358117485229
curr_Factors:  [96.20358117]
mat_Sqrt:  [[0.15]]
grads:  [0.05080395]
Stock Position:  0.050803951365062064
Bond Position:  [-5.48171069]


portfolio before change:  [-0.6049606]
curr_Stock_Price:  95.9982949550497
curr_Factors:  [95.99829496]
mat_Sqrt:  [[0.15]]
grads:  [-0.02311032]
Stock Position:  -0.0231103228453074
Bond Position:  [1.61359099]


portfolio before change:  [-0.61783363]
curr_Stock_Price:  96.55968388321794
curr_Factors:  [96.55968388]
mat_Sqrt:  [[0.15]]
grads:  [0.01854996]
Stock Position:  0.018549964660234966
Bond Position:  [-2.40901235]


portfolio before change:  [-0.6322718]
curr_Stock_Price:  95.78946118541499
curr_Factors:  [95.78946119]
mat_Sqrt:  [[0.15]]
grads:  [0.06305036]
Stock Position:  0.06305036265707177
Bond Position:  [-6.67183207]


portfolio before change:  [-0.65577746]
curr_Stock_Price:  95.4232672633963
curr_Factors:  [95.42326726]
mat_Sqrt:  [[0.15]]
grads:  [-0.08549576]
Stock Position:  -0.08549575538041046
Bond Position:  [7.50250685]


portfolio before change:  [-0.745206]
curr_Stock_Price:  96.47475176462535
curr_Factors:  [96.47475176]
mat_Sqrt:  [[0.15]]
grads:  [-0.23230087]
Stock Position:  -0.23230087350573414
Bond Position:  [21.6659631]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.745206]
Stock Price:  96.53803069095255
PL:  [-0.745206]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.48813590e-02]
 [-1.54867094e-03]
 [ 1.39741342e-03]
 [ 2.28869529e-03]
 [ 1.11456020e-02]
 [ 1.20303241e-02]
 [-4.51656473e-05]
 [ 6.57909469e-03]
 [-7.48435251e-04]
 [-1.99742320e-02]
 [ 8.81536750e-03]
 [-5.28443655e-03]
 [-7.35329201e-03]
 [ 3.85253521e-03]
 [-9.82235672e-04]
 [-6.30501718e-03]
 [ 1.17865369e-02]
 [ 6.61141939e-03]
 [ 2.41464724e-02]
 [ 1.03164751e-02]
 [ 5.60962045e-02]
 [-1.83493687e-02]
 [-6.68469096e-04]
 [ 1.14339876e-02]
 [ 6.52298371e-03]
 [ 2.13401137e-03]
 [ 1.38544810e-02]
 [-2.16908739e-02]
 [ 1.06018443e-03]
 [ 1.15615690e-04]
 [-3.41689412e-03]
 [-2.59375725e-02]
 [ 2.16649028e-02]
 [ 1.14567027e-02]
 [-3.34034601e-02]
 [ 8.49264511e-03]
 [ 7.81916183e-05]
 [-1.44283532e-02]
 [ 9.84133167e-03]
 [-2.06869801e-02]
 [ 5.60837859e-02]
 [ 3.65784847e-03]
 [ 1.13040801e-02]
 [-1.02820461e-02]
 [-2.86011554e-03]
 [-1.49676030e-02]
 [-1.30536795e-02]
 [ 1.81478601e-03]
 [-2.79659420e-03]
 [-1.02437257e-02]
 [-4.15634372e-03]
 [ 2.81964010e-03]
 [ 3.82812011e-03]
 [-1.33924234e-03]
 [ 8.03498910e-03]
 [ 8.84346156e-03]
 [ 1.12704868e-02]
 [ 3.87522988e-03]
 [ 1.35524907e-02]
 [-1.22044590e-03]
 [ 8.72287514e-04]
 [-1.68025521e-02]
 [-1.26960783e-02]
 [-1.06468622e-03]
 [-1.12319640e-02]
 [-5.50153801e-03]
 [ 1.23797804e-02]
 [ 2.10651941e-03]
 [ 1.05678530e-02]
 [-1.78568634e-02]
 [ 7.22166800e-03]
 [ 5.04154879e-06]
 [-2.18750170e-03]
 [ 7.64795605e-03]
 [-2.33710381e-03]
 [ 2.58353507e-03]
 [ 3.18478619e-03]
 [-1.15355215e-02]
 [-3.85371867e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.29367433]
curr_Stock_Price:  100.27168666071675
curr_Factors:  [100.27168666]
mat_Sqrt:  [[0.15]]
grads:  [-0.29920906]
Stock Position:  -0.2992090602988085
Bond Position:  [36.29587147]


portfolio before change:  [6.23399989]
curr_Stock_Price:  100.47870913014398
curr_Factors:  [100.47870913]
mat_Sqrt:  [[0.15]]
grads:  [-0.01032447]
Stock Position:  -0.01032447294944643
Bond Position:  [7.27138961]


portfolio before change:  [6.23058641]
curr_Stock_Price:  100.8533484605727
curr_Factors:  [100.85334846]
mat_Sqrt:  [[0.15]]
grads:  [0.00931609]
Stock Position:  0.009316089442555105
Bond Position:  [5.2910276]


portfolio before change:  [6.22748169]
curr_Stock_Price:  100.4845861446406
curr_Factors:  [100.48458614]
mat_Sqrt:  [[0.15]]
grads:  [0.01525797]
Stock Position:  0.015257968591090536
Bond Position:  [4.69429103]


portfolio before change:  [6.22585231]
curr_Stock_Price:  100.35856763622743
curr_Factors:  [100.35856764]
mat_Sqrt:  [[0.15]]
grads:  [0.07430401]
Stock Position:  0.07430401322152762
Bond Position:  [-1.23119203]


portfolio before change:  [6.29342405]
curr_Stock_Price:  101.26899882326609
curr_Factors:  [101.26899882]
mat_Sqrt:  [[0.15]]
grads:  [0.08020216]
Stock Position:  0.08020216089414202
Bond Position:  [-1.82856849]


portfolio before change:  [6.31417727]
curr_Stock_Price:  101.52918529968606
curr_Factors:  [101.5291853]
mat_Sqrt:  [[0.15]]
grads:  [-0.0003011]
Stock Position:  -0.00030110431527543484
Bond Position:  [6.34474815]


portfolio before change:  [6.31451127]
curr_Stock_Price:  101.73697058514769
curr_Factors:  [101.73697059]
mat_Sqrt:  [[0.15]]
grads:  [0.04386063]
Stock Position:  0.04386063123891576
Bond Position:  [1.85226352]


portfolio before change:  [6.27107173]
curr_Stock_Price:  100.74393173988139
curr_Factors:  [100.74393174]
mat_Sqrt:  [[0.15]]
grads:  [-0.00498957]
Stock Position:  -0.004989568342465287
Bond Position:  [6.77374046]


portfolio before change:  [6.26972762]
curr_Stock_Price:  101.0981672505805
curr_Factors:  [101.09816725]
mat_Sqrt:  [[0.15]]
grads:  [-0.13316155]
Stock Position:  -0.13316154698392066
Bond Position:  [19.73211597]


portfolio before change:  [6.4238097]
curr_Stock_Price:  99.95032246818334
curr_Factors:  [99.95032247]
mat_Sqrt:  [[0.15]]
grads:  [0.05876912]
Stock Position:  0.05876911665255686
Bond Position:  [0.54981754]


portfolio before change:  [6.40270065]
curr_Stock_Price:  99.59055167770626
curr_Factors:  [99.59055168]
mat_Sqrt:  [[0.15]]
grads:  [-0.03522958]
Stock Position:  -0.03522957697362843
Bond Position:  [9.91123366]


portfolio before change:  [6.38199819]
curr_Stock_Price:  100.19577978070951
curr_Factors:  [100.19577978]
mat_Sqrt:  [[0.15]]
grads:  [-0.04902195]
Stock Position:  -0.049021946739259546
Bond Position:  [11.29379037]


portfolio before change:  [6.43409546]
curr_Stock_Price:  99.14744554108356
curr_Factors:  [99.14744554]
mat_Sqrt:  [[0.15]]
grads:  [0.02568357]
Stock Position:  0.02568356807622747
Bond Position:  [3.8876353]


portfolio before change:  [6.43813932]
curr_Stock_Price:  99.29543392894185
curr_Factors:  [99.29543393]
mat_Sqrt:  [[0.15]]
grads:  [-0.00654824]
Stock Position:  -0.006548237811228539
Bond Position:  [7.08834943]


portfolio before change:  [6.43057334]
curr_Stock_Price:  100.51851299668608
curr_Factors:  [100.518513]
mat_Sqrt:  [[0.15]]
grads:  [-0.04203345]
Stock Position:  -0.042033447836666946
Bond Position:  [10.65571301]


portfolio before change:  [6.44210756]
curr_Stock_Price:  100.25995185334118
curr_Factors:  [100.25995185]
mat_Sqrt:  [[0.15]]
grads:  [0.07857691]
Stock Position:  0.07857691294673216
Bond Position:  [-1.43600995]


portfolio before change:  [6.36764572]
curr_Stock_Price:  99.31346410945561
curr_Factors:  [99.31346411]
mat_Sqrt:  [[0.15]]
grads:  [0.04407613]
Stock Position:  0.04407612927389708
Bond Position:  [1.99029264]


portfolio before change:  [6.38778959]
curr_Stock_Price:  99.76766621894603
curr_Factors:  [99.76766622]
mat_Sqrt:  [[0.15]]
grads:  [0.16097648]
Stock Position:  0.1609764825958097
Bond Position:  [-9.67245839]


portfolio before change:  [6.34539387]
curr_Stock_Price:  99.50805576795496
curr_Factors:  [99.50805577]
mat_Sqrt:  [[0.15]]
grads:  [0.0687765]
Stock Position:  0.06877650044237549
Bond Position:  [-0.49842198]


portfolio before change:  [6.33600588]
curr_Stock_Price:  99.37200875195256
curr_Factors:  [99.37200875]
mat_Sqrt:  [[0.15]]
grads:  [0.3739747]
Stock Position:  0.37397469639824094
Bond Position:  [-30.82661093]


portfolio before change:  [6.1041579]
curr_Stock_Price:  98.75720444543472
curr_Factors:  [98.75720445]
mat_Sqrt:  [[0.15]]
grads:  [-0.12232912]
Stock Position:  -0.12232912492697803
Bond Position:  [18.1850403]


portfolio before change:  [6.19450841]
curr_Stock_Price:  98.02791036340295
curr_Factors:  [98.02791036]
mat_Sqrt:  [[0.15]]
grads:  [-0.00445646]
Stock Position:  -0.004456460642762953
Bond Position:  [6.63136593]


portfolio before change:  [6.19312506]
curr_Stock_Price:  98.43132778495986
curr_Factors:  [98.43132778]
mat_Sqrt:  [[0.15]]
grads:  [0.07622658]
Stock Position:  0.07622658432718066
Bond Position:  [-1.30995884]


portfolio before change:  [6.22298078]
curr_Stock_Price:  98.82407256009292
curr_Factors:  [98.82407256]
mat_Sqrt:  [[0.15]]
grads:  [0.04348656]
Stock Position:  0.04348655806534391
Bond Position:  [1.92546201]


portfolio before change:  [6.23516603]
curr_Stock_Price:  99.10151225471942
curr_Factors:  [99.10151225]
mat_Sqrt:  [[0.15]]
grads:  [0.01422674]
Stock Position:  0.014226742492250954
Bond Position:  [4.82527433]


portfolio before change:  [6.22135084]
curr_Stock_Price:  98.1092421981169
curr_Factors:  [98.1092422]
mat_Sqrt:  [[0.15]]
grads:  [0.09236321]
Stock Position:  0.09236320641961787
Bond Position:  [-2.84033335]


portfolio before change:  [6.22226903]
curr_Stock_Price:  98.12110532627491
curr_Factors:  [98.12110533]
mat_Sqrt:  [[0.15]]
grads:  [-0.14460583]
Stock Position:  -0.14460582571845446
Bond Position:  [20.41115249]


portfolio before change:  [6.30396247]
curr_Stock_Price:  97.56498873255879
curr_Factors:  [97.56498873]
mat_Sqrt:  [[0.15]]
grads:  [0.0070679]
Stock Position:  0.007067896218442967
Bond Position:  [5.61438325]


portfolio before change:  [6.30120827]
curr_Stock_Price:  97.12566218046747
curr_Factors:  [97.12566218]
mat_Sqrt:  [[0.15]]
grads:  [0.00077077]
Stock Position:  0.0007707712671283877
Bond Position:  [6.2263466]


portfolio before change:  [6.30152786]
curr_Stock_Price:  97.03541492478496
curr_Factors:  [97.03541492]
mat_Sqrt:  [[0.15]]
grads:  [-0.02277929]
Stock Position:  -0.022779294150616487
Bond Position:  [8.51192612]


portfolio before change:  [6.31002357]
curr_Stock_Price:  96.68581251777128
curr_Factors:  [96.68581252]
mat_Sqrt:  [[0.15]]
grads:  [-0.17291715]
Stock Position:  -0.17291714982187026
Bond Position:  [23.0286587]


portfolio before change:  [6.38935353]
curr_Stock_Price:  96.23536200075304
curr_Factors:  [96.235362]
mat_Sqrt:  [[0.15]]
grads:  [0.14443269]
Stock Position:  0.14443268508033041
Bond Position:  [-7.51017821]


portfolio before change:  [6.32989281]
curr_Stock_Price:  95.8269273448247
curr_Factors:  [95.82692734]
mat_Sqrt:  [[0.15]]
grads:  [0.07637802]
Stock Position:  0.07637801786665495
Bond Position:  [-0.98917796]


portfolio before change:  [6.32371871]
curr_Stock_Price:  95.74690068811765
curr_Factors:  [95.74690069]
mat_Sqrt:  [[0.15]]
grads:  [-0.22268973]
Stock Position:  -0.22268973372760728
Bond Position:  [27.64557053]


portfolio before change:  [6.38446278]
curr_Stock_Price:  95.48188548487134
curr_Factors:  [95.48188548]
mat_Sqrt:  [[0.15]]
grads:  [0.05661763]
Stock Position:  0.0566176340646623
Bond Position:  [0.97850433]


portfolio before change:  [6.37752104]
curr_Stock_Price:  95.35819795144704
curr_Factors:  [95.35819795]
mat_Sqrt:  [[0.15]]
grads:  [0.00052128]
Stock Position:  0.0005212774553688705
Bond Position:  [6.32781296]


portfolio before change:  [6.37758343]
curr_Stock_Price:  94.71917701742707
curr_Factors:  [94.71917702]
mat_Sqrt:  [[0.15]]
grads:  [-0.09618902]
Stock Position:  -0.0961890210176636
Bond Position:  [15.48852834]


portfolio before change:  [6.39297715]
curr_Stock_Price:  94.56920510480907
curr_Factors:  [94.5692051]
mat_Sqrt:  [[0.15]]
grads:  [0.06560888]
Stock Position:  0.06560887782729707
Bond Position:  [0.18839772]


portfolio before change:  [6.40695703]
curr_Stock_Price:  94.78210478602212
curr_Factors:  [94.78210479]
mat_Sqrt:  [[0.15]]
grads:  [-0.1379132]
Stock Position:  -0.13791320076958072
Bond Position:  [19.47866048]


portfolio before change:  [6.4325954]
curr_Stock_Price:  94.60503025441349
curr_Factors:  [94.60503025]
mat_Sqrt:  [[0.15]]
grads:  [0.37389191]
Stock Position:  0.3738919060226297
Bond Position:  [-28.93945968]


portfolio before change:  [6.3548867]
curr_Stock_Price:  94.40203058210868
curr_Factors:  [94.40203058]
mat_Sqrt:  [[0.15]]
grads:  [0.02438566]
Stock Position:  0.024385656486363094
Bond Position:  [4.05283121]


portfolio before change:  [6.35500208]
curr_Stock_Price:  94.39637445864335
curr_Factors:  [94.39637446]
mat_Sqrt:  [[0.15]]
grads:  [0.07536053]
Stock Position:  0.07536053424083913
Bond Position:  [-0.75875913]


portfolio before change:  [6.3278782]
curr_Stock_Price:  94.03708218502624
curr_Factors:  [94.03708219]
mat_Sqrt:  [[0.15]]
grads:  [-0.06854697]
Stock Position:  -0.06854697415724549
Bond Position:  [12.77383564]


portfolio before change:  [6.24550344]
curr_Stock_Price:  95.25045666130076
curr_Factors:  [95.25045666]
mat_Sqrt:  [[0.15]]
grads:  [-0.01906744]
Stock Position:  -0.01906743690036275
Bond Position:  [8.06168551]


portfolio before change:  [6.24577292]
curr_Stock_Price:  95.26274912500585
curr_Factors:  [95.26274913]
mat_Sqrt:  [[0.15]]
grads:  [-0.09978402]
Stock Position:  -0.09978401983265069
Bond Position:  [15.75147297]


portfolio before change:  [6.32766542]
curr_Stock_Price:  94.45191783766909
curr_Factors:  [94.45191784]
mat_Sqrt:  [[0.15]]
grads:  [-0.08702453]
Stock Position:  -0.08702453028399326
Bond Position:  [14.54729921]


portfolio before change:  [6.31772357]
curr_Stock_Price:  94.57660785608152
curr_Factors:  [94.57660786]
mat_Sqrt:  [[0.15]]
grads:  [0.01209857]
Stock Position:  0.012098573372984403
Bond Position:  [5.17348154]


portfolio before change:  [6.32240256]
curr_Stock_Price:  94.93662006270345
curr_Factors:  [94.93662006]
mat_Sqrt:  [[0.15]]
grads:  [-0.01864396]
Stock Position:  -0.018643961351282247
Bond Position:  [8.09239723]


portfolio before change:  [6.32579016]
curr_Stock_Price:  94.78204939131547
curr_Factors:  [94.78204939]
mat_Sqrt:  [[0.15]]
grads:  [-0.0682915]
Stock Position:  -0.06829150433773266
Bond Position:  [12.79859889]


portfolio before change:  [6.2941696]
curr_Stock_Price:  95.25678616563974
curr_Factors:  [95.25678617]
mat_Sqrt:  [[0.15]]
grads:  [-0.02770896]
Stock Position:  -0.027708958159875022
Bond Position:  [8.93363591]


portfolio before change:  [6.29149609]
curr_Stock_Price:  95.3734228342928
curr_Factors:  [95.37342283]
mat_Sqrt:  [[0.15]]
grads:  [0.0187976]
Stock Position:  0.018797600661163476
Bond Position:  [4.49870458]


portfolio before change:  [6.28746141]
curr_Stock_Price:  95.14382626873032
curr_Factors:  [95.14382627]
mat_Sqrt:  [[0.15]]
grads:  [0.0255208]
Stock Position:  0.025520800709517805
Bond Position:  [3.85931478]


portfolio before change:  [6.28963352]
curr_Stock_Price:  95.21948617420644
curr_Factors:  [95.21948617]
mat_Sqrt:  [[0.15]]
grads:  [-0.00892828]
Stock Position:  -0.008928282234839534
Bond Position:  [7.13977997]


portfolio before change:  [6.28227191]
curr_Stock_Price:  96.09399514958757
curr_Factors:  [96.09399515]
mat_Sqrt:  [[0.15]]
grads:  [0.05356659]
Stock Position:  0.05356659397332208
Bond Position:  [1.13484389]


portfolio before change:  [6.30035434]
curr_Stock_Price:  96.43024006913281
curr_Factors:  [96.43024007]
mat_Sqrt:  [[0.15]]
grads:  [0.05895641]
Stock Position:  0.05895641041147679
Bond Position:  [0.61517353]


portfolio before change:  [6.32160292]
curr_Stock_Price:  96.78999971950086
curr_Factors:  [96.78999972]
mat_Sqrt:  [[0.15]]
grads:  [0.07513658]
Stock Position:  0.07513657836681428
Bond Position:  [-0.95086648]


portfolio before change:  [6.3216795]
curr_Stock_Price:  96.79180981375697
curr_Factors:  [96.79180981]
mat_Sqrt:  [[0.15]]
grads:  [0.02583487]
Stock Position:  0.025834865882391596
Bond Position:  [3.82107607]


portfolio before change:  [6.32782367]
curr_Stock_Price:  97.02039025650792
curr_Factors:  [97.02039026]
mat_Sqrt:  [[0.15]]
grads:  [0.09034994]
Stock Position:  0.09034993818159473
Bond Position:  [-2.4379626]


portfolio before change:  [6.32636887]
curr_Stock_Price:  97.00597496672778
curr_Factors:  [97.00597497]
mat_Sqrt:  [[0.15]]
grads:  [-0.00813631]
Stock Position:  -0.008136305982089226
Bond Position:  [7.11563916]


portfolio before change:  [6.32695152]
curr_Stock_Price:  96.98902511223743
curr_Factors:  [96.98902511]
mat_Sqrt:  [[0.15]]
grads:  [0.00581525]
Stock Position:  0.005815250095849277
Bond Position:  [5.76293608]


portfolio before change:  [6.32888391]
curr_Stock_Price:  97.25938275075784
curr_Factors:  [97.25938275]
mat_Sqrt:  [[0.15]]
grads:  [-0.11201701]
Stock Position:  -0.1120170140234378
Bond Position:  [17.22358955]


portfolio before change:  [6.30066762]
curr_Stock_Price:  97.52088587319705
curr_Factors:  [97.52088587]
mat_Sqrt:  [[0.15]]
grads:  [-0.08464052]
Stock Position:  -0.08464052194902756
Bond Position:  [14.5548863]


portfolio before change:  [6.26434071]
curr_Stock_Price:  97.96082429137977
curr_Factors:  [97.96082429]
mat_Sqrt:  [[0.15]]
grads:  [-0.00709791]
Stock Position:  -0.007097908105662066
Bond Position:  [6.95965764]


portfolio before change:  [6.26227021]
curr_Stock_Price:  98.31381398776873
curr_Factors:  [98.31381399]
mat_Sqrt:  [[0.15]]
grads:  [-0.07487976]
Stock Position:  -0.07487976028950306
Bond Position:  [13.62398504]


portfolio before change:  [6.25381287]
curr_Stock_Price:  98.43813160873685
curr_Factors:  [98.43813161]
mat_Sqrt:  [[0.15]]
grads:  [-0.03667692]
Stock Position:  -0.03667692008719312
Bond Position:  [9.86422035]


portfolio before change:  [6.23866003]
curr_Stock_Price:  98.86808505847138
curr_Factors:  [98.86808506]
mat_Sqrt:  [[0.15]]
grads:  [0.08253187]
Stock Position:  0.08253186965476382
Bond Position:  [-1.92110788]


portfolio before change:  [6.09238206]
curr_Stock_Price:  97.09715829403585
curr_Factors:  [97.09715829]
mat_Sqrt:  [[0.15]]
grads:  [0.01404346]
Stock Position:  0.014043462720877175
Bond Position:  [4.72880174]


portfolio before change:  [6.09834207]
curr_Stock_Price:  97.50050945335722
curr_Factors:  [97.50050945]
mat_Sqrt:  [[0.15]]
grads:  [0.07045235]
Stock Position:  0.07045235329025092
Bond Position:  [-0.77079827]


portfolio before change:  [6.06937373]
curr_Stock_Price:  97.09001696700305
curr_Factors:  [97.09001697]
mat_Sqrt:  [[0.15]]
grads:  [-0.11904576]
Stock Position:  -0.11904575616439232
Bond Position:  [17.62752822]


portfolio before change:  [6.08030997]
curr_Stock_Price:  97.0074060379328
curr_Factors:  [97.00740604]
mat_Sqrt:  [[0.15]]
grads:  [0.04814445]
Stock Position:  0.0481444533478116
Bond Position:  [1.40994143]


portfolio before change:  [6.06160022]
curr_Stock_Price:  96.61695888569545
curr_Factors:  [96.61695889]
mat_Sqrt:  [[0.15]]
grads:  [3.36103253e-05]
Stock Position:  3.3610325294765556e-05
Bond Position:  [6.0583529]


portfolio before change:  [6.06196516]
curr_Stock_Price:  96.20855827379047
curr_Factors:  [96.20855827]
mat_Sqrt:  [[0.15]]
grads:  [-0.01458334]
Stock Position:  -0.014583344665441197
Bond Position:  [7.46500772]


portfolio before change:  [6.06576783]
curr_Stock_Price:  95.97979771026135
curr_Factors:  [95.97979771]
mat_Sqrt:  [[0.15]]
grads:  [0.05098637]
Stock Position:  0.05098637366382792
Bond Position:  [1.172106]


portfolio before change:  [6.08858008]
curr_Stock_Price:  96.42577953399525
curr_Factors:  [96.42577953]
mat_Sqrt:  [[0.15]]
grads:  [-0.01558069]
Stock Position:  -0.015580692055750344
Bond Position:  [7.59096046]


portfolio before change:  [6.07800161]
curr_Stock_Price:  97.13517834218926
curr_Factors:  [97.13517834]
mat_Sqrt:  [[0.15]]
grads:  [0.01722357]
Stock Position:  0.01722356713433818
Bond Position:  [4.40498734]


portfolio before change:  [6.07842459]
curr_Stock_Price:  97.14375132948423
curr_Factors:  [97.14375133]
mat_Sqrt:  [[0.15]]
grads:  [0.02123191]
Stock Position:  0.021231907917089964
Bond Position:  [4.0158774]


portfolio before change:  [6.06581655]
curr_Stock_Price:  96.53810435970091
curr_Factors:  [96.53810436]
mat_Sqrt:  [[0.15]]
grads:  [-0.07690348]
Stock Position:  -0.07690347686526987
Bond Position:  [13.48993242]


portfolio before change:  [6.09256402]
curr_Stock_Price:  96.20126223632226
curr_Factors:  [96.20126224]
mat_Sqrt:  [[0.15]]
grads:  [-0.25691458]
Stock Position:  -0.25691457795694117
Bond Position:  [30.80807071]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.09256402]
Stock Price:  95.93679560764289
PL:  [6.09256402]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.32399816e-02]
 [-8.47738576e-04]
 [ 8.92633820e-04]
 [ 2.99003965e-03]
 [ 6.26213105e-03]
 [ 1.19059093e-02]
 [-8.24917871e-05]
 [ 6.83118733e-03]
 [-6.21043745e-03]
 [-4.92095234e-03]
 [ 1.01206623e-02]
 [-1.02253697e-02]
 [ 1.95920335e-02]
 [ 4.02591346e-03]
 [ 5.25166047e-03]
 [-8.17465116e-03]
 [ 1.34800681e-02]
 [ 1.53470598e-02]
 [ 2.21931048e-02]
 [ 3.10114102e-03]
 [ 7.95822570e-02]
 [-1.31436063e-02]
 [-2.70202192e-03]
 [ 1.39421839e-02]
 [ 8.50454117e-03]
 [-4.66454675e-03]
 [ 1.23485328e-02]
 [-5.56244032e-03]
 [ 2.73661233e-03]
 [-2.26895585e-02]
 [-4.69712692e-03]
 [ 1.34334333e-02]
 [ 1.02973072e-02]
 [ 2.89097549e-04]
 [-4.57441849e-03]
 [-4.08855047e-03]
 [-6.19061222e-03]
 [ 3.62004261e-03]
 [ 4.12799974e-03]
 [-7.67477663e-03]
 [-3.61330321e-02]
 [-2.52663734e-03]
 [ 1.10354870e-02]
 [-1.15981546e-02]
 [ 5.30389053e-04]
 [ 1.70247100e-03]
 [-1.36980394e-02]
 [-5.04638871e-03]
 [-1.10591304e-04]
 [ 5.13971695e-03]
 [-2.97992763e-03]
 [ 3.71825599e-03]
 [ 3.77342706e-04]
 [ 2.30597273e-03]
 [ 1.67112297e-03]
 [ 8.55182258e-03]
 [-7.07994227e-03]
 [-1.76906775e-02]
 [ 1.33919511e-02]
 [ 6.44678903e-03]
 [ 9.44636283e-03]
 [-1.28088259e-02]
 [-1.25519064e-02]
 [-2.18724835e-03]
 [-1.23961541e-02]
 [ 4.17790156e-02]
 [ 1.78066724e-02]
 [ 2.29158410e-03]
 [ 6.67495987e-03]
 [-1.45581128e-02]
 [-5.28152747e-03]
 [-7.22500166e-04]
 [ 1.54071217e-03]
 [ 8.75969522e-03]
 [ 1.11930760e-02]
 [-6.54233850e-03]
 [-4.33490539e-03]
 [-8.83845487e-03]
 [-7.49242832e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.7327875]
curr_Stock_Price:  100.23563809441623
curr_Factors:  [100.23563809]
mat_Sqrt:  [[0.15]]
grads:  [-0.28826654]
Stock Position:  -0.2882665437660693
Bond Position:  [34.62736846]


portfolio before change:  [5.6229397]
curr_Stock_Price:  100.62420930168467
curr_Factors:  [100.6242093]
mat_Sqrt:  [[0.15]]
grads:  [-0.00565159]
Stock Position:  -0.005651590507920156
Bond Position:  [6.19162653]


portfolio before change:  [5.62268748]
curr_Stock_Price:  100.7373115943827
curr_Factors:  [100.73731159]
mat_Sqrt:  [[0.15]]
grads:  [0.00595089]
Stock Position:  0.0059508921336902795
Bond Position:  [5.02321061]


portfolio before change:  [5.62722466]
curr_Stock_Price:  101.4469898781471
curr_Factors:  [101.44698988]
mat_Sqrt:  [[0.15]]
grads:  [0.0199336]
Stock Position:  0.019933597694536415
Bond Position:  [3.60502118]


portfolio before change:  [5.6263969]
curr_Stock_Price:  101.39416053476653
curr_Factors:  [101.39416053]
mat_Sqrt:  [[0.15]]
grads:  [0.04174754]
Stock Position:  0.041747540302779586
Bond Position:  [1.3934401]


portfolio before change:  [5.60413744]
curr_Stock_Price:  100.8588821422531
curr_Factors:  [100.85888214]
mat_Sqrt:  [[0.15]]
grads:  [0.07937273]
Stock Position:  0.07937272884489957
Bond Position:  [-2.40130727]


portfolio before change:  [5.66023281]
curr_Stock_Price:  101.56750666375142
curr_Factors:  [101.56750666]
mat_Sqrt:  [[0.15]]
grads:  [-0.00054995]
Stock Position:  -0.0005499452470102491
Bond Position:  [5.71608938]


portfolio before change:  [5.66076126]
curr_Stock_Price:  101.25623251924011
curr_Factors:  [101.25623252]
mat_Sqrt:  [[0.15]]
grads:  [0.04554125]
Stock Position:  0.04554124889849784
Bond Position:  [1.04942598]


portfolio before change:  [5.667749]
curr_Stock_Price:  101.40822966188365
curr_Factors:  [101.40822966]
mat_Sqrt:  [[0.15]]
grads:  [-0.04140292]
Stock Position:  -0.041402916346916174
Bond Position:  [9.86634544]


portfolio before change:  [5.64794085]
curr_Stock_Price:  101.90154787104318
curr_Factors:  [101.90154787]
mat_Sqrt:  [[0.15]]
grads:  [-0.03280635]
Stock Position:  -0.03280634892749169
Bond Position:  [8.99095858]


portfolio before change:  [5.66919023]
curr_Stock_Price:  101.27095556488958
curr_Factors:  [101.27095556]
mat_Sqrt:  [[0.15]]
grads:  [0.06747108]
Stock Position:  0.06747108209299975
Bond Position:  [-1.16367072]


portfolio before change:  [5.72623117]
curr_Stock_Price:  102.11744668548374
curr_Factors:  [102.11744669]
mat_Sqrt:  [[0.15]]
grads:  [-0.06816913]
Stock Position:  -0.06816913115617847
Bond Position:  [12.68748879]


portfolio before change:  [5.73624071]
curr_Stock_Price:  101.98224549055686
curr_Factors:  [101.98224549]
mat_Sqrt:  [[0.15]]
grads:  [0.13061356]
Stock Position:  0.13061355643038483
Bond Position:  [-7.58402306]


portfolio before change:  [5.68018582]
curr_Stock_Price:  101.55670869388162
curr_Factors:  [101.55670869]
mat_Sqrt:  [[0.15]]
grads:  [0.02683942]
Stock Position:  0.026839423070429674
Bond Position:  [2.95446235]


portfolio before change:  [5.66020633]
curr_Stock_Price:  100.80542006950694
curr_Factors:  [100.80542007]
mat_Sqrt:  [[0.15]]
grads:  [0.03501107]
Stock Position:  0.03501106977865455
Bond Position:  [2.13090073]


portfolio before change:  [5.65835553]
curr_Stock_Price:  100.7487528646002
curr_Factors:  [100.74875286]
mat_Sqrt:  [[0.15]]
grads:  [-0.05449767]
Stock Position:  -0.05449767437300388
Bond Position:  [11.14892826]


portfolio before change:  [5.63648944]
curr_Stock_Price:  101.16276912599979
curr_Factors:  [101.16276913]
mat_Sqrt:  [[0.15]]
grads:  [0.08986712]
Stock Position:  0.08986712058447865
Bond Position:  [-3.45471733]


portfolio before change:  [5.59823092]
curr_Stock_Price:  100.7394485900505
curr_Factors:  [100.73944859]
mat_Sqrt:  [[0.15]]
grads:  [0.10231373]
Stock Position:  0.10231373228371206
Bond Position:  [-4.70879806]


portfolio before change:  [5.52073]
curr_Stock_Price:  99.98484211249367
curr_Factors:  [99.98484211]
mat_Sqrt:  [[0.15]]
grads:  [0.14795403]
Stock Position:  0.14795403172299876
Bond Position:  [-9.2724305]


portfolio before change:  [5.58271972]
curr_Stock_Price:  100.4077387441717
curr_Factors:  [100.40773874]
mat_Sqrt:  [[0.15]]
grads:  [0.02067427]
Stock Position:  0.02067427346705308
Bond Position:  [3.50686267]


portfolio before change:  [5.58627315]
curr_Stock_Price:  100.56901388426913
curr_Factors:  [100.56901388]
mat_Sqrt:  [[0.15]]
grads:  [0.53054838]
Stock Position:  0.5305483800654078
Bond Position:  [-47.77045425]


portfolio before change:  [5.82823559]
curr_Stock_Price:  101.03070256770513
curr_Factors:  [101.03070257]
mat_Sqrt:  [[0.15]]
grads:  [-0.08762404]
Stock Position:  -0.0876240421486984
Bond Position:  [14.68095413]


portfolio before change:  [5.92792159]
curr_Stock_Price:  99.90351866176114
curr_Factors:  [99.90351866]
mat_Sqrt:  [[0.15]]
grads:  [-0.01801348]
Stock Position:  -0.01801347944642946
Bond Position:  [7.72753157]


portfolio before change:  [5.93928523]
curr_Stock_Price:  99.29948987735611
curr_Factors:  [99.29948988]
mat_Sqrt:  [[0.15]]
grads:  [0.09294789]
Stock Position:  0.09294789251145047
Bond Position:  [-3.29039308]


portfolio before change:  [5.92813641]
curr_Stock_Price:  99.18175546654228
curr_Factors:  [99.18175547]
mat_Sqrt:  [[0.15]]
grads:  [0.05669694]
Stock Position:  0.05669694116420523
Bond Position:  [0.30483426]


portfolio before change:  [5.95992657]
curr_Stock_Price:  99.74212272494897
curr_Factors:  [99.74212272]
mat_Sqrt:  [[0.15]]
grads:  [-0.03109698]
Stock Position:  -0.0310969783248431
Bond Position:  [9.0616052]


portfolio before change:  [5.97283572]
curr_Stock_Price:  99.3452103003461
curr_Factors:  [99.3452103]
mat_Sqrt:  [[0.15]]
grads:  [0.08232355]
Stock Position:  0.08232355225096871
Bond Position:  [-2.20561489]


portfolio before change:  [5.98401753]
curr_Stock_Price:  99.4827124421376
curr_Factors:  [99.48271244]
mat_Sqrt:  [[0.15]]
grads:  [-0.03708294]
Stock Position:  -0.0370829354430319
Bond Position:  [9.67312853]


portfolio before change:  [5.97875099]
curr_Stock_Price:  99.64103670626726
curr_Factors:  [99.64103671]
mat_Sqrt:  [[0.15]]
grads:  [0.01824408]
Stock Position:  0.018244082230179887
Bond Position:  [4.16089172]


portfolio before change:  [5.98508555]
curr_Stock_Price:  99.97399358893814
curr_Factors:  [99.97399359]
mat_Sqrt:  [[0.15]]
grads:  [-0.15126372]
Stock Position:  -0.15126372322959214
Bond Position:  [21.10752404]


portfolio before change:  [5.94143382]
curr_Stock_Price:  100.27129542190849
curr_Factors:  [100.27129542]
mat_Sqrt:  [[0.15]]
grads:  [-0.03131418]
Stock Position:  -0.031314179472038114
Bond Position:  [9.08134717]


portfolio before change:  [5.92448039]
curr_Stock_Price:  100.83081948947748
curr_Factors:  [100.83081949]
mat_Sqrt:  [[0.15]]
grads:  [0.08955622]
Stock Position:  0.08955622218774147
Bond Position:  [-3.10554688]


portfolio before change:  [5.9292199]
curr_Stock_Price:  100.88590901350787
curr_Factors:  [100.88590901]
mat_Sqrt:  [[0.15]]
grads:  [0.06864871]
Stock Position:  0.06864871455761441
Bond Position:  [-0.99646807]


portfolio before change:  [6.01886776]
curr_Stock_Price:  102.19270903114776
curr_Factors:  [102.19270903]
mat_Sqrt:  [[0.15]]
grads:  [0.00192732]
Stock Position:  0.001927316995739443
Bond Position:  [5.82191001]


portfolio before change:  [6.01978161]
curr_Stock_Price:  102.47806796283211
curr_Factors:  [102.47806796]
mat_Sqrt:  [[0.15]]
grads:  [-0.03049612]
Stock Position:  -0.030496123296565328
Bond Position:  [9.14496541]


portfolio before change:  [5.99156916]
curr_Stock_Price:  103.4219265569865
curr_Factors:  [103.42192656]
mat_Sqrt:  [[0.15]]
grads:  [-0.027257]
Stock Position:  -0.027257003162923656
Bond Position:  [8.81054094]


portfolio before change:  [6.01082894]
curr_Stock_Price:  102.73553045391829
curr_Factors:  [102.73553045]
mat_Sqrt:  [[0.15]]
grads:  [-0.04127075]
Stock Position:  -0.04127074811135849
Bond Position:  [10.25080114]


portfolio before change:  [6.01253442]
curr_Stock_Price:  102.70973047799008
curr_Factors:  [102.70973048]
mat_Sqrt:  [[0.15]]
grads:  [0.02413362]
Stock Position:  0.024133617409653713
Bond Position:  [3.53377708]


portfolio before change:  [6.04150518]
curr_Stock_Price:  103.90101019591965
curr_Factors:  [103.9010102]
mat_Sqrt:  [[0.15]]
grads:  [0.02752]
Stock Position:  0.027519998285366182
Bond Position:  [3.18214956]


portfolio before change:  [6.03182713]
curr_Stock_Price:  103.54210971596922
curr_Factors:  [103.54210972]
mat_Sqrt:  [[0.15]]
grads:  [-0.05116518]
Stock Position:  -0.05116517755331404
Bond Position:  [11.32957756]


portfolio before change:  [6.05934653]
curr_Stock_Price:  103.01809547512019
curr_Factors:  [103.01809548]
mat_Sqrt:  [[0.15]]
grads:  [-0.24088688]
Stock Position:  -0.24088688081675544
Bond Position:  [30.87505422]


portfolio before change:  [6.10815846]
curr_Stock_Price:  102.82347224124443
curr_Factors:  [102.82347224]
mat_Sqrt:  [[0.15]]
grads:  [-0.01684425]
Stock Position:  -0.01684424892425294
Bond Position:  [7.84014263]


portfolio before change:  [6.12151739]
curr_Stock_Price:  102.0594781998359
curr_Factors:  [102.0594782]
mat_Sqrt:  [[0.15]]
grads:  [0.07356991]
Stock Position:  0.07356991345852917
Bond Position:  [-1.38698958]


portfolio before change:  [6.14517692]
curr_Stock_Price:  102.38224898827173
curr_Factors:  [102.38224899]
mat_Sqrt:  [[0.15]]
grads:  [-0.07732103]
Stock Position:  -0.07732103060149922
Bond Position:  [14.06147793]


portfolio before change:  [6.17955411]
curr_Stock_Price:  101.94901218919522
curr_Factors:  [101.94901219]
mat_Sqrt:  [[0.15]]
grads:  [0.00353593]
Stock Position:  0.003535927021524412
Bond Position:  [5.81906984]


portfolio before change:  [6.1775782]
curr_Stock_Price:  101.28734229022753
curr_Factors:  [101.28734229]
mat_Sqrt:  [[0.15]]
grads:  [0.01134981]
Stock Position:  0.011349806649215857
Bond Position:  [5.02798645]


portfolio before change:  [6.17824298]
curr_Stock_Price:  101.3182261378074
curr_Factors:  [101.31822614]
mat_Sqrt:  [[0.15]]
grads:  [-0.09132026]
Stock Position:  -0.09132026276039
Bond Position:  [15.43065001]


portfolio before change:  [6.21831155]
curr_Stock_Price:  100.89001752648763
curr_Factors:  [100.89001753]
mat_Sqrt:  [[0.15]]
grads:  [-0.03364259]
Stock Position:  -0.03364259140891266
Bond Position:  [9.61251319]


portfolio before change:  [6.21676175]
curr_Stock_Price:  100.95394245285506
curr_Factors:  [100.95394245]
mat_Sqrt:  [[0.15]]
grads:  [-0.00073728]
Stock Position:  -0.000737275356695991
Bond Position:  [6.2911926]


portfolio before change:  [6.21738167]
curr_Stock_Price:  100.64644745833385
curr_Factors:  [100.64644746]
mat_Sqrt:  [[0.15]]
grads:  [0.03426478]
Stock Position:  0.03426477969115011
Bond Position:  [2.76875332]


portfolio before change:  [6.21330053]
curr_Stock_Price:  100.5222909598084
curr_Factors:  [100.52229096]
mat_Sqrt:  [[0.15]]
grads:  [-0.01986618]
Stock Position:  -0.019866184226757847
Bond Position:  [8.21029488]


portfolio before change:  [6.18965339]
curr_Stock_Price:  101.73844280189333
curr_Factors:  [101.7384428]
mat_Sqrt:  [[0.15]]
grads:  [0.02478837]
Stock Position:  0.02478837323482672
Bond Position:  [3.6677229]


portfolio before change:  [6.19379996]
curr_Stock_Price:  101.89647373203883
curr_Factors:  [101.89647373]
mat_Sqrt:  [[0.15]]
grads:  [0.00251562]
Stock Position:  0.002515618039212467
Bond Position:  [5.93746735]


portfolio before change:  [6.1942682]
curr_Stock_Price:  101.93508699621164
curr_Factors:  [101.935087]
mat_Sqrt:  [[0.15]]
grads:  [0.01537315]
Stock Position:  0.01537315150805412
Bond Position:  [4.62720466]


portfolio before change:  [6.18516412]
curr_Stock_Price:  101.32406802282969
curr_Factors:  [101.32406802]
mat_Sqrt:  [[0.15]]
grads:  [0.01114082]
Stock Position:  0.011140819775818473
Bond Position:  [5.05633094]


portfolio before change:  [6.18045896]
curr_Stock_Price:  100.873365518641
curr_Factors:  [100.87336552]
mat_Sqrt:  [[0.15]]
grads:  [0.05701215]
Stock Position:  0.05701215052542302
Bond Position:  [0.42945146]


portfolio before change:  [6.21407589]
curr_Stock_Price:  101.46253977373517
curr_Factors:  [101.46253977]
mat_Sqrt:  [[0.15]]
grads:  [-0.04719962]
Stock Position:  -0.04719961514460128
Bond Position:  [11.00306872]


portfolio before change:  [6.21994699]
curr_Stock_Price:  101.3527213802408
curr_Factors:  [101.35272138]
mat_Sqrt:  [[0.15]]
grads:  [-0.11793785]
Stock Position:  -0.11793784967070588
Bond Position:  [18.17326901]


portfolio before change:  [6.18862499]
curr_Stock_Price:  101.62793302089834
curr_Factors:  [101.62793302]
mat_Sqrt:  [[0.15]]
grads:  [0.08927967]
Stock Position:  0.0892796742869347
Bond Position:  [-2.88468377]


portfolio before change:  [6.14425504]
curr_Stock_Price:  101.13297551137704
curr_Factors:  [101.13297551]
mat_Sqrt:  [[0.15]]
grads:  [0.04297859]
Stock Position:  0.042978593562726576
Bond Position:  [1.79770199]


portfolio before change:  [6.13578617]
curr_Stock_Price:  100.93331255144436
curr_Factors:  [100.93331255]
mat_Sqrt:  [[0.15]]
grads:  [0.06297575]
Stock Position:  0.06297575220168777
Bond Position:  [-0.22056511]


portfolio before change:  [6.12461464]
curr_Stock_Price:  100.75613737792322
curr_Factors:  [100.75613738]
mat_Sqrt:  [[0.15]]
grads:  [-0.08539217]
Stock Position:  -0.08539217293320923
Bond Position:  [14.72840015]


portfolio before change:  [6.13497668]
curr_Stock_Price:  100.64557125701968
curr_Factors:  [100.64557126]
mat_Sqrt:  [[0.15]]
grads:  [-0.08367938]
Stock Position:  -0.08367937575728036
Bond Position:  [14.55693525]


portfolio before change:  [6.19370501]
curr_Stock_Price:  99.95461853401652
curr_Factors:  [99.95461853]
mat_Sqrt:  [[0.15]]
grads:  [-0.01458166]
Stock Position:  -0.01458165569716216
Bond Position:  [7.65120884]


portfolio before change:  [6.19860366]
curr_Stock_Price:  99.65146818685747
curr_Factors:  [99.65146819]
mat_Sqrt:  [[0.15]]
grads:  [-0.08264103]
Stock Position:  -0.08264102749236342
Bond Position:  [14.43390338]


portfolio before change:  [6.16578864]
curr_Stock_Price:  100.05946367309761
curr_Factors:  [100.05946367]
mat_Sqrt:  [[0.15]]
grads:  [0.27852677]
Stock Position:  0.2785267705839358
Bond Position:  [-21.70345065]


portfolio before change:  [6.15600834]
curr_Stock_Price:  100.02921958678066
curr_Factors:  [100.02921959]
mat_Sqrt:  [[0.15]]
grads:  [0.11871115]
Stock Position:  0.11871114911594999
Bond Position:  [-5.71857526]


portfolio before change:  [6.12803612]
curr_Stock_Price:  99.79659778944531
curr_Factors:  [99.79659779]
mat_Sqrt:  [[0.15]]
grads:  [0.01527723]
Stock Position:  0.015277227313002321
Bond Position:  [4.60342081]


portfolio before change:  [6.12645494]
curr_Stock_Price:  99.67426518750784
curr_Factors:  [99.67426519]
mat_Sqrt:  [[0.15]]
grads:  [0.04449973]
Stock Position:  0.04449973246179723
Bond Position:  [1.6909768]


portfolio before change:  [6.12797688]
curr_Stock_Price:  99.7060913339727
curr_Factors:  [99.70609133]
mat_Sqrt:  [[0.15]]
grads:  [-0.09705409]
Stock Position:  -0.09705408508809382
Bond Position:  [15.80486036]


portfolio before change:  [6.18802455]
curr_Stock_Price:  99.09756637751944
curr_Factors:  [99.09756638]
mat_Sqrt:  [[0.15]]
grads:  [-0.03521018]
Stock Position:  -0.03521018316413701
Bond Position:  [9.67726801]


portfolio before change:  [6.19391356]
curr_Stock_Price:  98.94749168038057
curr_Factors:  [98.94749168]
mat_Sqrt:  [[0.15]]
grads:  [-0.00481667]
Stock Position:  -0.004816667772743659
Bond Position:  [6.67051075]


portfolio before change:  [6.1945157]
curr_Stock_Price:  98.90903675974441
curr_Factors:  [98.90903676]
mat_Sqrt:  [[0.15]]
grads:  [0.01027141]
Stock Position:  0.01027141444039114
Bond Position:  [5.17857999]


portfolio before change:  [6.197598]
curr_Stock_Price:  99.1776102973068
curr_Factors:  [99.1776103]
mat_Sqrt:  [[0.15]]
grads:  [0.05839797]
Stock Position:  0.058397968156341795
Bond Position:  [0.40582707]


portfolio before change:  [6.20069856]
curr_Stock_Price:  99.23026959870151
curr_Factors:  [99.2302696]
mat_Sqrt:  [[0.15]]
grads:  [0.07462051]
Stock Position:  0.07462050639003594
Bond Position:  [-1.2039144]


portfolio before change:  [6.2234758]
curr_Stock_Price:  99.53651902113073
curr_Factors:  [99.53651902]
mat_Sqrt:  [[0.15]]
grads:  [-0.04361559]
Stock Position:  -0.04361558997987727
Bond Position:  [10.56481981]


portfolio before change:  [6.23428134]
curr_Stock_Price:  99.30391381377908
curr_Factors:  [99.30391381]
mat_Sqrt:  [[0.15]]
grads:  [-0.02889937]
Stock Position:  -0.0288993692755546
Bond Position:  [9.10410181]


portfolio before change:  [6.23486086]
curr_Stock_Price:  99.30355070301407
curr_Factors:  [99.3035507]
mat_Sqrt:  [[0.15]]
grads:  [-0.05892303]
Stock Position:  -0.05892303249376833
Bond Position:  [12.0861272]


portfolio before change:  [6.27295835]
curr_Stock_Price:  98.66980727597691
curr_Factors:  [98.66980728]
mat_Sqrt:  [[0.15]]
grads:  [-0.04994952]
Stock Position:  -0.04994952212664466
Bond Position:  [11.20146807]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.27295835]
Stock Price:  98.2890094994228
PL:  [6.27295835]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-2.48933611e-02]
 [ 1.10971699e-02]
 [ 8.60956033e-04]
 [-1.25002449e-03]
 [-1.07933230e-02]
 [ 5.69625576e-03]
 [ 4.53146983e-04]
 [ 1.52506993e-02]
 [ 6.59229549e-03]
 [ 1.26572214e-02]
 [ 8.49324123e-03]
 [-1.08887328e-02]
 [ 1.03489466e-02]
 [ 1.01285109e-02]
 [-4.34646728e-02]
 [ 2.12355945e-02]
 [-6.54615724e-03]
 [-1.75683413e-02]
 [-6.79652595e-02]
 [ 2.22400514e-02]
 [-1.01144024e-01]
 [-4.44942604e-02]
 [ 2.47593621e-03]
 [-4.18728646e-03]
 [-2.05187782e-02]
 [ 1.39384713e-02]
 [ 2.64102755e-02]
 [ 1.83893621e-01]
 [-2.82745499e-03]
 [ 3.77595297e-02]
 [-3.65194132e-03]
 [-1.12732004e-01]
 [ 3.15266105e-02]
 [ 9.11115574e-03]
 [-5.36145993e-02]
 [ 9.48102729e-03]
 [ 5.64387552e-03]
 [-2.73133729e-02]
 [ 1.39659493e-02]
 [-2.57252013e-02]
 [ 7.13646763e-02]
 [ 7.01616115e-03]
 [ 1.66088839e-02]
 [-1.17022244e-02]
 [-7.99908478e-03]
 [-3.05579566e-02]
 [-1.25654984e-02]
 [ 4.57374842e-03]
 [-3.46330537e-03]
 [-2.27815821e-02]
 [-5.06511252e-03]
 [ 2.92407408e-03]
 [ 4.60266964e-03]
 [-3.77406055e-03]
 [ 3.25408204e-02]
 [ 9.11417159e-03]
 [-7.92376307e-03]
 [ 1.74625019e-02]
 [ 1.26155208e-02]
 [-1.49656857e-02]
 [-1.54003463e-02]
 [-4.36685966e-02]
 [-1.30614014e-02]
 [-5.46960384e-03]
 [-1.27313659e-03]
 [ 9.10564065e-02]
 [ 8.78869086e-03]
 [ 1.86953708e-03]
 [ 1.85332934e-02]
 [-1.89774640e-02]
 [ 3.86826399e-02]
 [-5.52683514e-02]
 [-1.13722239e-02]
 [ 8.31268449e-03]
 [-2.26167362e-02]
 [ 5.23083465e-03]
 [ 2.65211908e-02]
 [-2.38663696e-02]
 [-7.38769194e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.40921296]
curr_Stock_Price:  99.00536909856432
curr_Factors:  [99.0053691]
mat_Sqrt:  [[0.15]]
grads:  [-0.16595574]
Stock Position:  -0.16595574060569807
Bond Position:  [3.02129639]


portfolio before change:  [-13.31530516]
curr_Stock_Price:  98.44064646053242
curr_Factors:  [98.44064646]
mat_Sqrt:  [[0.15]]
grads:  [0.07398113]
Stock Position:  0.07398113246182907
Bond Position:  [-20.59805567]


portfolio before change:  [-13.31789052]
curr_Stock_Price:  98.42310231644198
curr_Factors:  [98.42310232]
mat_Sqrt:  [[0.15]]
grads:  [0.00573971]
Stock Position:  0.005739706889878616
Bond Position:  [-13.88281028]


portfolio before change:  [-13.31753137]
curr_Stock_Price:  98.63685005870279
curr_Factors:  [98.63685006]
mat_Sqrt:  [[0.15]]
grads:  [-0.0083335]
Stock Position:  -0.008333496626312768
Bond Position:  [-12.49554151]


portfolio before change:  [-13.32157186]
curr_Stock_Price:  99.02798228233391
curr_Factors:  [99.02798228]
mat_Sqrt:  [[0.15]]
grads:  [-0.07195549]
Stock Position:  -0.07195548633393284
Bond Position:  [-6.19596524]


portfolio before change:  [-13.28873833]
curr_Stock_Price:  98.56629687256813
curr_Factors:  [98.56629687]
mat_Sqrt:  [[0.15]]
grads:  [0.03797504]
Stock Position:  0.03797503840545878
Bond Position:  [-17.03179724]


portfolio before change:  [-13.27441136]
curr_Stock_Price:  98.97160224978572
curr_Factors:  [98.97160225]
mat_Sqrt:  [[0.15]]
grads:  [0.00302098]
Stock Position:  0.003020979889582949
Bond Position:  [-13.57340258]


portfolio before change:  [-13.27516457]
curr_Stock_Price:  99.0031014687188
curr_Factors:  [99.00310147]
mat_Sqrt:  [[0.15]]
grads:  [0.10167133]
Stock Position:  0.10167132887905189
Bond Position:  [-23.34094146]


portfolio before change:  [-13.38226768]
curr_Stock_Price:  97.96402520518359
curr_Factors:  [97.96402521]
mat_Sqrt:  [[0.15]]
grads:  [0.04394864]
Stock Position:  0.04394863656913031
Bond Position:  [-17.68765303]


portfolio before change:  [-13.38149286]
curr_Stock_Price:  98.00681017708285
curr_Factors:  [98.00681018]
mat_Sqrt:  [[0.15]]
grads:  [0.08438148]
Stock Position:  0.08438147623004877
Bond Position:  [-21.65145218]


portfolio before change:  [-13.39551129]
curr_Stock_Price:  97.85671591194408
curr_Factors:  [97.85671591]
mat_Sqrt:  [[0.15]]
grads:  [0.05662161]
Stock Position:  0.056621608196116086
Bond Position:  [-18.93631592]


portfolio before change:  [-13.42406492]
curr_Stock_Price:  97.37333032546226
curr_Factors:  [97.37333033]
mat_Sqrt:  [[0.15]]
grads:  [-0.07259155]
Stock Position:  -0.07259155196965528
Bond Position:  [-6.35558375]


portfolio before change:  [-13.4149385]
curr_Stock_Price:  97.2421352070798
curr_Factors:  [97.24213521]
mat_Sqrt:  [[0.15]]
grads:  [0.06899298]
Stock Position:  0.0689929772532389
Bond Position:  [-20.12396292]


portfolio before change:  [-13.48168162]
curr_Stock_Price:  96.29297578635567
curr_Factors:  [96.29297579]
mat_Sqrt:  [[0.15]]
grads:  [0.06752341]
Stock Position:  0.0675234062799329
Bond Position:  [-19.98371134]


portfolio before change:  [-13.50466204]
curr_Stock_Price:  95.97114062465452
curr_Factors:  [95.97114062]
mat_Sqrt:  [[0.15]]
grads:  [-0.28976449]
Stock Position:  -0.28976448548351724
Bond Position:  [14.30436614]


portfolio before change:  [-13.59517631]
curr_Stock_Price:  96.28659790152462
curr_Factors:  [96.2865979]
mat_Sqrt:  [[0.15]]
grads:  [0.14157063]
Stock Position:  0.14157062988551183
Bond Position:  [-27.22653062]


portfolio before change:  [-13.68105341]
curr_Stock_Price:  95.69201560797113
curr_Factors:  [95.69201561]
mat_Sqrt:  [[0.15]]
grads:  [-0.04364105]
Stock Position:  -0.04364104828728384
Bond Position:  [-9.50495354]


portfolio before change:  [-13.6817005]
curr_Stock_Price:  95.6932302551961
curr_Factors:  [95.69323026]
mat_Sqrt:  [[0.15]]
grads:  [-0.11712228]
Stock Position:  -0.11712227533120304
Bond Position:  [-2.47389164]


portfolio before change:  [-13.61647744]
curr_Stock_Price:  95.13503005421212
curr_Factors:  [95.13503005]
mat_Sqrt:  [[0.15]]
grads:  [-0.45310173]
Stock Position:  -0.45310172971290263
Bond Position:  [29.48936923]


portfolio before change:  [-13.36545784]
curr_Stock_Price:  94.58509513542245
curr_Factors:  [94.58509514]
mat_Sqrt:  [[0.15]]
grads:  [0.14826701]
Stock Position:  0.14826700919571184
Bond Position:  [-27.38930701]


portfolio before change:  [-13.50473488]
curr_Stock_Price:  93.65727474453128
curr_Factors:  [93.65727474]
mat_Sqrt:  [[0.15]]
grads:  [-0.67429349]
Stock Position:  -0.6742934944121091
Bond Position:  [49.64775619]


portfolio before change:  [-13.42721602]
curr_Stock_Price:  93.54691364158073
curr_Factors:  [93.54691364]
mat_Sqrt:  [[0.15]]
grads:  [-0.2966284]
Stock Position:  -0.29662840291549863
Bond Position:  [14.32145557]


portfolio before change:  [-13.35371834]
curr_Stock_Price:  93.30215434571244
curr_Factors:  [93.30215435]
mat_Sqrt:  [[0.15]]
grads:  [0.01650624]
Stock Position:  0.016506241400762428
Bond Position:  [-14.89378622]


portfolio before change:  [-13.36171489]
curr_Stock_Price:  92.87409489637997
curr_Factors:  [92.8740949]
mat_Sqrt:  [[0.15]]
grads:  [-0.02791524]
Stock Position:  -0.027915243086665324
Bond Position:  [-10.76911195]


portfolio before change:  [-13.35029075]
curr_Stock_Price:  92.44073927811502
curr_Factors:  [92.44073928]
mat_Sqrt:  [[0.15]]
grads:  [-0.13679185]
Stock Position:  -0.136791854915491
Bond Position:  [-0.70515055]


portfolio before change:  [-13.32265205]
curr_Stock_Price:  92.23836780178736
curr_Factors:  [92.2383678]
mat_Sqrt:  [[0.15]]
grads:  [0.09292314]
Stock Position:  0.09292314205827779
Bond Position:  [-21.89373101]


portfolio before change:  [-13.29125778]
curr_Stock_Price:  92.59094596310436
curr_Factors:  [92.59094596]
mat_Sqrt:  [[0.15]]
grads:  [0.1760685]
Stock Position:  0.17606850357278475
Bond Position:  [-29.59360708]


portfolio before change:  [-13.34731794]
curr_Stock_Price:  92.28305161291996
curr_Factors:  [92.28305161]
mat_Sqrt:  [[0.15]]
grads:  [1.22595747]
Stock Position:  1.225957471486565
Bond Position:  [-126.48241455]


portfolio before change:  [-13.98684637]
curr_Stock_Price:  91.76784366766604
curr_Factors:  [91.76784367]
mat_Sqrt:  [[0.15]]
grads:  [-0.0188497]
Stock Position:  -0.01884969996014029
Bond Position:  [-12.25705005]


portfolio before change:  [-13.98465991]
curr_Stock_Price:  91.6112076205001
curr_Factors:  [91.61120762]
mat_Sqrt:  [[0.15]]
grads:  [0.2517302]
Stock Position:  0.25173019789796724
Bond Position:  [-37.04596734]


portfolio before change:  [-13.89290857]
curr_Stock_Price:  91.9848886019311
curr_Factors:  [91.9848886]
mat_Sqrt:  [[0.15]]
grads:  [-0.02434628]
Stock Position:  -0.024346275435861698
Bond Position:  [-11.65341914]


portfolio before change:  [-13.87781766]
curr_Stock_Price:  91.33512713807144
curr_Factors:  [91.33512714]
mat_Sqrt:  [[0.15]]
grads:  [-0.75154669]
Stock Position:  -0.7515466944342926
Bond Position:  [54.76479523]


portfolio before change:  [-13.98294136]
curr_Stock_Price:  91.47955809238535
curr_Factors:  [91.47955809]
mat_Sqrt:  [[0.15]]
grads:  [0.2101774]
Stock Position:  0.2101774031549816
Bond Position:  [-33.20987732]


portfolio before change:  [-13.90111792]
curr_Stock_Price:  91.8787404820555
curr_Factors:  [91.87874048]
mat_Sqrt:  [[0.15]]
grads:  [0.06074104]
Stock Position:  0.060741038236029984
Bond Position:  [-19.48192801]


portfolio before change:  [-13.90440083]
curr_Stock_Price:  91.84473966877353
curr_Factors:  [91.84473967]
mat_Sqrt:  [[0.15]]
grads:  [-0.35743066]
Stock Position:  -0.3574306620714016
Bond Position:  [18.92372528]


portfolio before change:  [-13.92532749]
curr_Stock_Price:  91.90659624305397
curr_Factors:  [91.90659624]
mat_Sqrt:  [[0.15]]
grads:  [0.06320685]
Stock Position:  0.06320684862637425
Bond Position:  [-19.73445381]


portfolio before change:  [-13.91985318]
curr_Stock_Price:  92.01272010237322
curr_Factors:  [92.0127201]
mat_Sqrt:  [[0.15]]
grads:  [0.03762584]
Stock Position:  0.037625836799199286
Bond Position:  [-17.38190877]


portfolio before change:  [-13.89363714]
curr_Stock_Price:  92.73835030507838
curr_Factors:  [92.73835031]
mat_Sqrt:  [[0.15]]
grads:  [-0.18208915]
Stock Position:  -0.18208915258190356
Bond Position:  [2.99301048]


portfolio before change:  [-13.85216158]
curr_Stock_Price:  92.51160151395104
curr_Factors:  [92.51160151]
mat_Sqrt:  [[0.15]]
grads:  [0.09310633]
Stock Position:  0.0931063284370815
Bond Position:  [-22.46557713]


portfolio before change:  [-13.87378873]
curr_Stock_Price:  92.29439815413718
curr_Factors:  [92.29439815]
mat_Sqrt:  [[0.15]]
grads:  [-0.17150134]
Stock Position:  -0.17150134192257058
Bond Position:  [1.95482441]


portfolio before change:  [-13.87298301]
curr_Stock_Price:  92.29041252163275
curr_Factors:  [92.29041252]
mat_Sqrt:  [[0.15]]
grads:  [0.47576451]
Stock Position:  0.4757645084642092
Bond Position:  [-57.78148575]


portfolio before change:  [-14.2607396]
curr_Stock_Price:  91.48298546709172
curr_Factors:  [91.48298547]
mat_Sqrt:  [[0.15]]
grads:  [0.04677441]
Stock Position:  0.04677440767057271
Bond Position:  [-18.53980205]


portfolio before change:  [-14.25663912]
curr_Stock_Price:  91.59542407529663
curr_Factors:  [91.59542408]
mat_Sqrt:  [[0.15]]
grads:  [0.11072589]
Stock Position:  0.11072589258798475
Bond Position:  [-24.39862421]


portfolio before change:  [-14.25410035]
curr_Stock_Price:  91.63212490572741
curr_Factors:  [91.63212491]
mat_Sqrt:  [[0.15]]
grads:  [-0.07801483]
Stock Position:  -0.07801482933756444
Bond Position:  [-7.10543576]


portfolio before change:  [-14.29762554]
curr_Stock_Price:  92.1843414854046
curr_Factors:  [92.18434149]
mat_Sqrt:  [[0.15]]
grads:  [-0.05332723]
Stock Position:  -0.053327231863130854
Bond Position:  [-9.38168978]


portfolio before change:  [-14.26304492]
curr_Stock_Price:  91.52488505186359
curr_Factors:  [91.52488505]
mat_Sqrt:  [[0.15]]
grads:  [-0.20371971]
Stock Position:  -0.2037197104472256
Bond Position:  [4.38237816]


portfolio before change:  [-14.15205009]
curr_Stock_Price:  90.98138866700131
curr_Factors:  [90.98138867]
mat_Sqrt:  [[0.15]]
grads:  [-0.08376999]
Stock Position:  -0.08376998959314189
Bond Position:  [-6.53054011]


portfolio before change:  [-14.1272847]
curr_Stock_Price:  90.68088052822662
curr_Factors:  [90.68088053]
mat_Sqrt:  [[0.15]]
grads:  [0.03049166]
Stock Position:  0.030491656125613838
Bond Position:  [-16.89229492]


portfolio before change:  [-14.09315375]
curr_Stock_Price:  91.8348601368574
curr_Factors:  [91.83486014]
mat_Sqrt:  [[0.15]]
grads:  [-0.0230887]
Stock Position:  -0.02308870246702392
Bond Position:  [-11.97280599]


portfolio before change:  [-14.10116348]
curr_Stock_Price:  92.14936072399021
curr_Factors:  [92.14936072]
mat_Sqrt:  [[0.15]]
grads:  [-0.15187721]
Stock Position:  -0.15187721417875163
Bond Position:  [-0.10577529]


portfolio before change:  [-14.01845321]
curr_Stock_Price:  91.60473072639405
curr_Factors:  [91.60473073]
mat_Sqrt:  [[0.15]]
grads:  [-0.03376742]
Stock Position:  -0.03376741677853437
Bond Position:  [-10.92519809]


portfolio before change:  [-14.02523382]
curr_Stock_Price:  91.7853120257905
curr_Factors:  [91.78531203]
mat_Sqrt:  [[0.15]]
grads:  [0.01949383]
Stock Position:  0.01949382718768667
Bond Position:  [-15.81448083]


portfolio before change:  [-14.02743475]
curr_Stock_Price:  91.72311289867301
curr_Factors:  [91.7231129]
mat_Sqrt:  [[0.15]]
grads:  [0.03068446]
Stock Position:  0.03068446427627219
Bond Position:  [-16.84190934]


portfolio before change:  [-14.01299292]
curr_Stock_Price:  92.22807481677495
curr_Factors:  [92.22807482]
mat_Sqrt:  [[0.15]]
grads:  [-0.0251604]
Stock Position:  -0.025160403641413063
Bond Position:  [-11.69249733]


portfolio before change:  [-13.99819863]
curr_Stock_Price:  91.61102990435737
curr_Factors:  [91.6110299]
mat_Sqrt:  [[0.15]]
grads:  [0.2169388]
Stock Position:  0.21693880245313552
Bond Position:  [-33.87218574]


portfolio before change:  [-13.85951355]
curr_Stock_Price:  92.26007078732007
curr_Factors:  [92.26007079]
mat_Sqrt:  [[0.15]]
grads:  [0.06076114]
Stock Position:  0.060761143944497095
Bond Position:  [-19.46534099]


portfolio before change:  [-13.91331131]
curr_Stock_Price:  91.39469643749568
curr_Factors:  [91.39469644]
mat_Sqrt:  [[0.15]]
grads:  [-0.05282509]
Stock Position:  -0.052825087110838616
Bond Position:  [-9.08537851]


portfolio before change:  [-13.88569662]
curr_Stock_Price:  90.86118961165683
curr_Factors:  [90.86118961]
mat_Sqrt:  [[0.15]]
grads:  [0.11641668]
Stock Position:  0.11641667913266213
Bond Position:  [-24.46345457]


portfolio before change:  [-13.87469543]
curr_Stock_Price:  90.96882195267911
curr_Factors:  [90.96882195]
mat_Sqrt:  [[0.15]]
grads:  [0.08410347]
Stock Position:  0.08410347200401527
Bond Position:  [-21.5254892]


portfolio before change:  [-13.88189086]
curr_Stock_Price:  90.89926423027038
curr_Factors:  [90.89926423]
mat_Sqrt:  [[0.15]]
grads:  [-0.09977124]
Stock Position:  -0.0997712377398457
Bond Position:  [-4.81275876]


portfolio before change:  [-13.95410291]
curr_Stock_Price:  91.62002543457783
curr_Factors:  [91.62002543]
mat_Sqrt:  [[0.15]]
grads:  [-0.10266898]
Stock Position:  -0.10266897528524985
Bond Position:  [-4.54756878]


portfolio before change:  [-13.9668214]
curr_Stock_Price:  91.74113562997393
curr_Factors:  [91.74113563]
mat_Sqrt:  [[0.15]]
grads:  [-0.29112398]
Stock Position:  -0.2911239776493624
Bond Position:  [12.74122292]


portfolio before change:  [-14.08802449]
curr_Stock_Price:  92.16019916461079
curr_Factors:  [92.16019916]
mat_Sqrt:  [[0.15]]
grads:  [-0.08707601]
Stock Position:  -0.08707600952295147
Bond Position:  [-6.06308211]


portfolio before change:  [-14.0546506]
curr_Stock_Price:  91.7725740667618
curr_Factors:  [91.77257407]
mat_Sqrt:  [[0.15]]
grads:  [-0.03646403]
Stock Position:  -0.036464025622223124
Bond Position:  [-10.70825311]


portfolio before change:  [-14.07103931]
curr_Stock_Price:  92.20366800851001
curr_Factors:  [92.20366801]
mat_Sqrt:  [[0.15]]
grads:  [-0.00848758]
Stock Position:  -0.008487577234477083
Bond Position:  [-13.28845355]


portfolio before change:  [-14.06460037]
curr_Stock_Price:  91.34718245567905
curr_Factors:  [91.34718246]
mat_Sqrt:  [[0.15]]
grads:  [0.60704271]
Stock Position:  0.6070427098521256
Bond Position:  [-69.51624155]


portfolio before change:  [-14.00767797]
curr_Stock_Price:  91.44810995353971
curr_Factors:  [91.44810995]
mat_Sqrt:  [[0.15]]
grads:  [0.05859127]
Stock Position:  0.0585912723880618
Bond Position:  [-19.36573909]


portfolio before change:  [-14.03450446]
curr_Stock_Price:  91.01091022531622
curr_Factors:  [91.01091023]
mat_Sqrt:  [[0.15]]
grads:  [0.01246358]
Stock Position:  0.012463580530530276
Bond Position:  [-15.16882627]


portfolio before change:  [-14.04090927]
curr_Stock_Price:  90.57309578798746
curr_Factors:  [90.57309579]
mat_Sqrt:  [[0.15]]
grads:  [0.12355529]
Stock Position:  0.12355528931645764
Bond Position:  [-25.23169433]


portfolio before change:  [-14.00507778]
curr_Stock_Price:  90.87586326253854
curr_Factors:  [90.87586326]
mat_Sqrt:  [[0.15]]
grads:  [-0.12651643]
Stock Position:  -0.12651642654872367
Bond Position:  [-2.5077883]


portfolio before change:  [-13.95615445]
curr_Stock_Price:  90.48792890799282
curr_Factors:  [90.48792891]
mat_Sqrt:  [[0.15]]
grads:  [0.25788427]
Stock Position:  0.2578842661377279
Bond Position:  [-37.29156759]


portfolio before change:  [-13.9339646]
curr_Stock_Price:  90.58301283083925
curr_Factors:  [90.58301283]
mat_Sqrt:  [[0.15]]
grads:  [-0.36845568]
Stock Position:  -0.36845567615327657
Bond Position:  [19.44186064]


portfolio before change:  [-13.87705741]
curr_Stock_Price:  90.43186292509853
curr_Factors:  [90.43186293]
mat_Sqrt:  [[0.15]]
grads:  [-0.07581483]
Stock Position:  -0.0758148256851332
Bond Position:  [-7.02098148]


portfolio before change:  [-13.82405268]
curr_Stock_Price:  89.72694079363093
curr_Factors:  [89.72694079]
mat_Sqrt:  [[0.15]]
grads:  [0.0554179]
Stock Position:  0.055417896576124934
Bond Position:  [-18.79653101]


portfolio before change:  [-13.87193273]
curr_Stock_Price:  88.88415840265279
curr_Factors:  [88.8841584]
mat_Sqrt:  [[0.15]]
grads:  [-0.15077824]
Stock Position:  -0.1507782413703473
Bond Position:  [-0.47013564]


portfolio before change:  [-13.96147256]
curr_Stock_Price:  89.47781464269228
curr_Factors:  [89.47781464]
mat_Sqrt:  [[0.15]]
grads:  [0.03487223]
Stock Position:  0.03487223100516016
Bond Position:  [-17.08176358]


portfolio before change:  [-13.96438181]
curr_Stock_Price:  89.42500459564879
curr_Factors:  [89.4250046]
mat_Sqrt:  [[0.15]]
grads:  [0.17680794]
Stock Position:  0.17680793833540387
Bond Position:  [-29.77543251]


portfolio before change:  [-14.09373951]
curr_Stock_Price:  88.70390188713468
curr_Factors:  [88.70390189]
mat_Sqrt:  [[0.15]]
grads:  [-0.15910913]
Stock Position:  -0.15910913073338953
Bond Position:  [0.01986121]


portfolio before change:  [-14.06514607]
curr_Stock_Price:  88.52420003271709
curr_Factors:  [88.52420003]
mat_Sqrt:  [[0.15]]
grads:  [-0.4925128]
Stock Position:  -0.4925127957845791
Bond Position:  [29.53415519]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.06514607]
Stock Price:  88.0405315239166
PL:  [-14.06514607]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.77546433e-02]
 [ 1.41623882e-03]
 [ 1.81832019e-04]
 [ 1.42270363e-03]
 [ 2.14145872e-02]
 [ 1.21398511e-02]
 [ 4.83123367e-04]
 [ 1.01364898e-02]
 [ 9.50687900e-03]
 [-1.83097536e-02]
 [ 5.96878574e-03]
 [-6.14350749e-03]
 [-7.14640884e-03]
 [ 3.91789432e-03]
 [-9.93143675e-04]
 [ 1.31283257e-02]
 [ 2.69325129e-03]
 [ 8.98110430e-03]
 [ 2.17316111e-02]
 [ 9.84991986e-03]
 [ 7.93298923e-02]
 [-1.34203094e-02]
 [-2.84289331e-03]
 [ 1.43857576e-02]
 [ 7.10313947e-03]
 [ 1.42135513e-02]
 [ 1.33975497e-02]
 [-1.95670603e-02]
 [ 1.86442872e-03]
 [-4.01959926e-03]
 [-3.61091962e-03]
 [-2.28349217e-02]
 [ 2.10252014e-02]
 [ 1.14339420e-02]
 [-3.06882901e-02]
 [ 8.50999392e-03]
 [-2.59812283e-04]
 [-8.12754208e-03]
 [ 7.41216884e-03]
 [-1.75658023e-02]
 [ 4.19602100e-02]
 [ 1.29916911e-04]
 [ 7.13550231e-03]
 [-9.22351650e-03]
 [-1.64367131e-03]
 [-8.82163084e-03]
 [-1.34127906e-02]
 [-4.68725718e-05]
 [-2.73256514e-03]
 [-1.04522919e-03]
 [-3.99391823e-03]
 [ 2.86041614e-03]
 [ 3.73564615e-03]
 [ 4.25190478e-05]
 [ 8.40615526e-03]
 [ 8.91634371e-03]
 [ 3.30470886e-03]
 [ 1.21721563e-02]
 [ 1.32032169e-02]
 [-5.03563385e-03]
 [-2.25443310e-03]
 [-2.14540120e-02]
 [-1.27952078e-02]
 [-2.07191069e-03]
 [-8.85662562e-03]
 [ 4.26806277e-03]
 [ 8.73589986e-03]
 [ 1.79855335e-03]
 [ 1.34713210e-02]
 [-1.82501148e-02]
 [ 1.20138473e-02]
 [-2.39590329e-03]
 [-3.30510972e-03]
 [ 7.73608190e-03]
 [-5.85561892e-03]
 [ 3.32635102e-03]
 [ 1.49420349e-02]
 [-1.49291306e-02]
 [-4.94459644e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.85555629]
curr_Stock_Price:  99.29803561632968
curr_Factors:  [99.29803562]
mat_Sqrt:  [[0.15]]
grads:  [-0.25169762]
Stock Position:  -0.2516976218912523
Bond Position:  [16.13752313]


portfolio before change:  [-8.91581095]
curr_Stock_Price:  99.54143596244616
curr_Factors:  [99.54143596]
mat_Sqrt:  [[0.15]]
grads:  [0.00944159]
Stock Position:  0.009441592134186829
Bond Position:  [-9.85564059]


portfolio before change:  [-8.91113462]
curr_Stock_Price:  100.1019700507311
curr_Factors:  [100.10197005]
mat_Sqrt:  [[0.15]]
grads:  [0.00121221]
Stock Position:  0.001212213461105636
Bond Position:  [-9.03247957]


portfolio before change:  [-8.9123246]
curr_Stock_Price:  99.586028514493
curr_Factors:  [99.58602851]
mat_Sqrt:  [[0.15]]
grads:  [0.00948469]
Stock Position:  0.009484690891462736
Bond Position:  [-9.85686729]


portfolio before change:  [-8.90970254]
curr_Stock_Price:  99.92743467595429
curr_Factors:  [99.92743468]
mat_Sqrt:  [[0.15]]
grads:  [0.14276391]
Stock Position:  0.14276391448749257
Bond Position:  [-23.17573428]


portfolio before change:  [-8.91706409]
curr_Stock_Price:  99.88601646471905
curr_Factors:  [99.88601646]
mat_Sqrt:  [[0.15]]
grads:  [0.08093234]
Stock Position:  0.08093234088326419
Bond Position:  [-17.00107323]


portfolio before change:  [-8.97548816]
curr_Stock_Price:  99.17725815276404
curr_Factors:  [99.17725815]
mat_Sqrt:  [[0.15]]
grads:  [0.00322082]
Stock Position:  0.003220822449486889
Bond Position:  [-9.2949205]


portfolio before change:  [-8.97305395]
curr_Stock_Price:  100.11340579365364
curr_Factors:  [100.11340579]
mat_Sqrt:  [[0.15]]
grads:  [0.0675766]
Stock Position:  0.0675765987561088
Bond Position:  [-15.7383774]


portfolio before change:  [-8.96663826]
curr_Stock_Price:  100.22290185540619
curr_Factors:  [100.22290186]
mat_Sqrt:  [[0.15]]
grads:  [0.06337919]
Stock Position:  0.06337919331134513
Bond Position:  [-15.31868493]


portfolio before change:  [-8.98102374]
curr_Stock_Price:  100.01103365517787
curr_Factors:  [100.01103366]
mat_Sqrt:  [[0.15]]
grads:  [-0.12206502]
Stock Position:  -0.12206502424945836
Bond Position:  [3.22682551]


portfolio before change:  [-8.88134678]
curr_Stock_Price:  99.19609689886929
curr_Factors:  [99.1960969]
mat_Sqrt:  [[0.15]]
grads:  [0.0397919]
Stock Position:  0.03979190496041333
Bond Position:  [-12.82854844]


portfolio before change:  [-8.88795572]
curr_Stock_Price:  99.05015950718841
curr_Factors:  [99.05015951]
mat_Sqrt:  [[0.15]]
grads:  [-0.04095672]
Stock Position:  -0.04095671659528214
Bond Position:  [-4.83118641]


portfolio before change:  [-8.89816277]
curr_Stock_Price:  99.29200243826176
curr_Factors:  [99.29200244]
mat_Sqrt:  [[0.15]]
grads:  [-0.04764273]
Stock Position:  -0.047642725620952314
Bond Position:  [-4.16762114]


portfolio before change:  [-8.89467318]
curr_Stock_Price:  99.21329009413233
curr_Factors:  [99.21329009]
mat_Sqrt:  [[0.15]]
grads:  [0.0261193]
Stock Position:  0.02611929545665063
Bond Position:  [-11.48605442]


portfolio before change:  [-8.89911868]
curr_Stock_Price:  99.07057560046994
curr_Factors:  [99.0705756]
mat_Sqrt:  [[0.15]]
grads:  [-0.00662096]
Stock Position:  -0.006620957831243272
Bond Position:  [-8.24317658]


portfolio before change:  [-8.89955188]
curr_Stock_Price:  99.05818733208251
curr_Factors:  [99.05818733]
mat_Sqrt:  [[0.15]]
grads:  [0.08752217]
Stock Position:  0.08752217114047438
Bond Position:  [-17.5693395]


portfolio before change:  [-8.85490552]
curr_Stock_Price:  99.58084891216434
curr_Factors:  [99.58084891]
mat_Sqrt:  [[0.15]]
grads:  [0.01795501]
Stock Position:  0.01795500859176413
Bond Position:  [-10.64288052]


portfolio before change:  [-8.85194388]
curr_Stock_Price:  99.7828450573959
curr_Factors:  [99.78284506]
mat_Sqrt:  [[0.15]]
grads:  [0.05987403]
Stock Position:  0.059874028644932784
Bond Position:  [-14.8263448]


portfolio before change:  [-8.83706659]
curr_Stock_Price:  100.04679861168154
curr_Factors:  [100.04679861]
mat_Sqrt:  [[0.15]]
grads:  [0.14487741]
Stock Position:  0.14487740763451587
Bond Position:  [-23.33158741]


portfolio before change:  [-8.89600363]
curr_Stock_Price:  99.65005784776801
curr_Factors:  [99.65005785]
mat_Sqrt:  [[0.15]]
grads:  [0.06566613]
Stock Position:  0.06566613241699304
Bond Position:  [-15.43963753]


portfolio before change:  [-8.84784899]
curr_Stock_Price:  100.39807889757623
curr_Factors:  [100.3980789]
mat_Sqrt:  [[0.15]]
grads:  [0.52886595]
Stock Position:  0.5288659485267123
Bond Position:  [-61.94497422]


portfolio before change:  [-8.88368292]
curr_Stock_Price:  100.3376434572146
curr_Factors:  [100.33764346]
mat_Sqrt:  [[0.15]]
grads:  [-0.08946873]
Stock Position:  -0.08946872916573019
Bond Position:  [0.09339853]


portfolio before change:  [-8.85278696]
curr_Stock_Price:  99.99238174520171
curr_Factors:  [99.99238175]
mat_Sqrt:  [[0.15]]
grads:  [-0.01895262]
Stock Position:  -0.018952622085885922
Bond Position:  [-6.95766913]


portfolio before change:  [-8.83407436]
curr_Stock_Price:  98.98210109859926
curr_Factors:  [98.9821011]
mat_Sqrt:  [[0.15]]
grads:  [0.09590505]
Stock Position:  0.09590505034142524
Bond Position:  [-18.32695774]


portfolio before change:  [-8.84117635]
curr_Stock_Price:  98.9199925021704
curr_Factors:  [98.9199925]
mat_Sqrt:  [[0.15]]
grads:  [0.04735426]
Stock Position:  0.04735426312710911
Bond Position:  [-13.52545971]


portfolio before change:  [-8.89255698]
curr_Stock_Price:  97.85281817340663
curr_Factors:  [97.85281817]
mat_Sqrt:  [[0.15]]
grads:  [0.09475701]
Stock Position:  0.09475700894170934
Bond Position:  [-18.16479734]


portfolio before change:  [-8.83974119]
curr_Stock_Price:  98.4221810405189
curr_Factors:  [98.42218104]
mat_Sqrt:  [[0.15]]
grads:  [0.089317]
Stock Position:  0.08931699778065494
Bond Position:  [-17.63051491]


portfolio before change:  [-8.88642723]
curr_Stock_Price:  97.91181791748218
curr_Factors:  [97.91181792]
mat_Sqrt:  [[0.15]]
grads:  [-0.13044707]
Stock Position:  -0.13044706870129133
Bond Position:  [3.88588241]


portfolio before change:  [-8.95965362]
curr_Stock_Price:  98.47502924550909
curr_Factors:  [98.47502925]
mat_Sqrt:  [[0.15]]
grads:  [0.01242952]
Stock Position:  0.012429524789746961
Bond Position:  [-10.18365144]


portfolio before change:  [-8.96972594]
curr_Stock_Price:  97.71588341360501
curr_Factors:  [97.71588341]
mat_Sqrt:  [[0.15]]
grads:  [-0.02679733]
Stock Position:  -0.026797328427239284
Bond Position:  [-6.35120132]


portfolio before change:  [-8.97978334]
curr_Stock_Price:  98.07638318783438
curr_Factors:  [98.07638319]
mat_Sqrt:  [[0.15]]
grads:  [-0.0240728]
Stock Position:  -0.024072797441559088
Bond Position:  [-6.61881043]


portfolio before change:  [-8.95803333]
curr_Stock_Price:  97.15568845197039
curr_Factors:  [97.15568845]
mat_Sqrt:  [[0.15]]
grads:  [-0.15223281]
Stock Position:  -0.1522328112275002
Bond Position:  [5.83225025]


portfolio before change:  [-8.86452809]
curr_Stock_Price:  96.54385770121426
curr_Factors:  [96.5438577]
mat_Sqrt:  [[0.15]]
grads:  [0.14016801]
Stock Position:  0.1401680090665907
Bond Position:  [-22.39688841]


portfolio before change:  [-8.96046071]
curr_Stock_Price:  95.86943292473404
curr_Factors:  [95.86943292]
mat_Sqrt:  [[0.15]]
grads:  [0.07622628]
Stock Position:  0.07622627984127939
Bond Position:  [-16.26823094]


portfolio before change:  [-8.93964787]
curr_Stock_Price:  96.1558123083853
curr_Factors:  [96.15581231]
mat_Sqrt:  [[0.15]]
grads:  [-0.2045886]
Stock Position:  -0.20458860048069286
Bond Position:  [10.73273519]


portfolio before change:  [-8.79114724]
curr_Stock_Price:  95.4332411924598
curr_Factors:  [95.43324119]
mat_Sqrt:  [[0.15]]
grads:  [0.05673329]
Stock Position:  0.05673329278009162
Bond Position:  [-14.20538926]


portfolio before change:  [-8.78476601]
curr_Stock_Price:  95.56136877172817
curr_Factors:  [95.56136877]
mat_Sqrt:  [[0.15]]
grads:  [-0.00173208]
Stock Position:  -0.0017320818846558162
Bond Position:  [-8.61924589]


portfolio before change:  [-8.78559131]
curr_Stock_Price:  95.72682263354535
curr_Factors:  [95.72682263]
mat_Sqrt:  [[0.15]]
grads:  [-0.05418361]
Stock Position:  -0.05418361385839461
Bond Position:  [-3.59876612]


portfolio before change:  [-8.79243508]
curr_Stock_Price:  95.84897841646831
curr_Factors:  [95.84897842]
mat_Sqrt:  [[0.15]]
grads:  [0.04941446]
Stock Position:  0.049414458918998504
Bond Position:  [-13.52876049]


portfolio before change:  [-8.76731542]
curr_Stock_Price:  96.37443663564659
curr_Factors:  [96.37443664]
mat_Sqrt:  [[0.15]]
grads:  [-0.11710535]
Stock Position:  -0.11710534845013175
Bond Position:  [2.51864656]


portfolio before change:  [-8.82767686]
curr_Stock_Price:  96.89122648388846
curr_Factors:  [96.89122648]
mat_Sqrt:  [[0.15]]
grads:  [0.27973473]
Stock Position:  0.27973473318723613
Bond Position:  [-35.93151824]


portfolio before change:  [-8.76446667]
curr_Stock_Price:  97.12521949050749
curr_Factors:  [97.12521949]
mat_Sqrt:  [[0.15]]
grads:  [0.00086611]
Stock Position:  0.0008661127376397912
Bond Position:  [-8.84858806]


portfolio before change:  [-8.76568282]
curr_Stock_Price:  96.35963004443221
curr_Factors:  [96.35963004]
mat_Sqrt:  [[0.15]]
grads:  [0.04757002]
Stock Position:  0.04757001538644632
Bond Position:  [-13.3495119]


portfolio before change:  [-8.7851788]
curr_Stock_Price:  95.96733212688486
curr_Factors:  [95.96733213]
mat_Sqrt:  [[0.15]]
grads:  [-0.06149011]
Stock Position:  -0.061490109979573604
Bond Position:  [-2.884137]


portfolio before change:  [-8.78590657]
curr_Stock_Price:  95.97623607694496
curr_Factors:  [95.97623608]
mat_Sqrt:  [[0.15]]
grads:  [-0.01095781]
Stock Position:  -0.010957808741694284
Bond Position:  [-7.73421733]


portfolio before change:  [-8.79471835]
curr_Stock_Price:  96.73627621958052
curr_Factors:  [96.73627622]
mat_Sqrt:  [[0.15]]
grads:  [-0.05881087]
Stock Position:  -0.05881087227644297
Bond Position:  [-3.10557357]


portfolio before change:  [-8.78883472]
curr_Stock_Price:  96.63293249737241
curr_Factors:  [96.6329325]
mat_Sqrt:  [[0.15]]
grads:  [-0.0894186]
Stock Position:  -0.0894186040619741
Bond Position:  [-0.14805279]


portfolio before change:  [-8.79986975]
curr_Stock_Price:  96.75623765923334
curr_Factors:  [96.75623766]
mat_Sqrt:  [[0.15]]
grads:  [-0.00031248]
Stock Position:  -0.00031248381233051417
Bond Position:  [-8.76963499]


portfolio before change:  [-8.80043633]
curr_Stock_Price:  96.81531755531894
curr_Factors:  [96.81531756]
mat_Sqrt:  [[0.15]]
grads:  [-0.0182171]
Stock Position:  -0.018217100918975014
Bond Position:  [-7.03674192]


portfolio before change:  [-8.7984313]
curr_Stock_Price:  96.68111154101443
curr_Factors:  [96.68111154]
mat_Sqrt:  [[0.15]]
grads:  [-0.00696819]
Stock Position:  -0.006968194581876801
Bond Position:  [-8.1247385]


portfolio before change:  [-8.79353883]
curr_Stock_Price:  95.90612157645593
curr_Factors:  [95.90612158]
mat_Sqrt:  [[0.15]]
grads:  [-0.02662612]
Stock Position:  -0.026626121529965387
Bond Position:  [-6.23993078]


portfolio before change:  [-8.79152485]
curr_Stock_Price:  95.81583478450302
curr_Factors:  [95.81583478]
mat_Sqrt:  [[0.15]]
grads:  [0.01906944]
Stock Position:  0.019069440946051418
Bond Position:  [-10.61867925]


portfolio before change:  [-8.79721538]
curr_Stock_Price:  95.55222738843624
curr_Factors:  [95.55222739]
mat_Sqrt:  [[0.15]]
grads:  [0.02490431]
Stock Position:  0.024904307670110707
Bond Position:  [-11.17687745]


portfolio before change:  [-8.77937813]
curr_Stock_Price:  96.29650942923399
curr_Factors:  [96.29650943]
mat_Sqrt:  [[0.15]]
grads:  [0.00028346]
Stock Position:  0.0002834603184181014
Bond Position:  [-8.80667437]


portfolio before change:  [-8.78000564]
curr_Stock_Price:  96.02461379689959
curr_Factors:  [96.0246138]
mat_Sqrt:  [[0.15]]
grads:  [0.05604104]
Stock Position:  0.05604103503996774
Bond Position:  [-14.16132438]


portfolio before change:  [-8.82997737]
curr_Stock_Price:  95.14870884497678
curr_Factors:  [95.14870884]
mat_Sqrt:  [[0.15]]
grads:  [0.05944229]
Stock Position:  0.05944229141695725
Bond Position:  [-14.48583465]


portfolio before change:  [-8.84211349]
curr_Stock_Price:  94.95977381204774
curr_Factors:  [94.95977381]
mat_Sqrt:  [[0.15]]
grads:  [0.02203139]
Stock Position:  0.02203139243031701
Bond Position:  [-10.93420953]


portfolio before change:  [-8.84538721]
curr_Stock_Price:  94.8422003045236
curr_Factors:  [94.8422003]
mat_Sqrt:  [[0.15]]
grads:  [0.08114771]
Stock Position:  0.08114770886132247
Bond Position:  [-16.54161447]


portfolio before change:  [-8.81292275]
curr_Stock_Price:  95.25500735739384
curr_Factors:  [95.25500736]
mat_Sqrt:  [[0.15]]
grads:  [0.08802145]
Stock Position:  0.08802144584593213
Bond Position:  [-17.19740622]


portfolio before change:  [-8.82312689]
curr_Stock_Price:  95.15129084661126
curr_Factors:  [95.15129085]
mat_Sqrt:  [[0.15]]
grads:  [-0.03357089]
Stock Position:  -0.03357089231004809
Bond Position:  [-5.62881316]


portfolio before change:  [-8.85407993]
curr_Stock_Price:  96.06283108870504
curr_Factors:  [96.06283109]
mat_Sqrt:  [[0.15]]
grads:  [-0.01502955]
Stock Position:  -0.015029553972157658
Bond Position:  [-7.41029842]


portfolio before change:  [-8.85523699]
curr_Stock_Price:  96.10900037924225
curr_Factors:  [96.10900038]
mat_Sqrt:  [[0.15]]
grads:  [-0.14302675]
Stock Position:  -0.1430267466480144
Bond Position:  [4.89092066]


portfolio before change:  [-8.87675267]
curr_Stock_Price:  96.26156886308736
curr_Factors:  [96.26156886]
mat_Sqrt:  [[0.15]]
grads:  [-0.08530139]
Stock Position:  -0.08530138534327887
Bond Position:  [-0.66550749]


portfolio before change:  [-8.86894115]
curr_Stock_Price:  96.16950576496181
curr_Factors:  [96.16950576]
mat_Sqrt:  [[0.15]]
grads:  [-0.01381274]
Stock Position:  -0.013812737963965966
Bond Position:  [-7.54057697]


portfolio before change:  [-8.87459106]
curr_Stock_Price:  96.54442115863466
curr_Factors:  [96.54442116]
mat_Sqrt:  [[0.15]]
grads:  [-0.05904417]
Stock Position:  -0.05904417079645304
Bond Position:  [-3.17420577]


portfolio before change:  [-8.84347516]
curr_Stock_Price:  96.01406735229958
curr_Factors:  [96.01406735]
mat_Sqrt:  [[0.15]]
grads:  [0.02845375]
Stock Position:  0.028453751797131995
Bond Position:  [-11.5754356]


portfolio before change:  [-8.84696588]
curr_Stock_Price:  95.91681341215588
curr_Factors:  [95.91681341]
mat_Sqrt:  [[0.15]]
grads:  [0.05823933]
Stock Position:  0.058239332369374446
Bond Position:  [-14.43309706]


portfolio before change:  [-8.83389159]
curr_Stock_Price:  96.15679537027594
curr_Factors:  [96.15679537]
mat_Sqrt:  [[0.15]]
grads:  [0.01199036]
Stock Position:  0.011990355665051347
Bond Position:  [-9.98684577]


portfolio before change:  [-8.83488599]
curr_Stock_Price:  96.12592036719471
curr_Factors:  [96.12592037]
mat_Sqrt:  [[0.15]]
grads:  [0.08980881]
Stock Position:  0.0898088064043529
Bond Position:  [-17.46784016]


portfolio before change:  [-8.79048257]
curr_Stock_Price:  96.63249868268211
curr_Factors:  [96.63249868]
mat_Sqrt:  [[0.15]]
grads:  [-0.12166743]
Stock Position:  -0.12166743175704323
Bond Position:  [2.96654537]


portfolio before change:  [-8.73143431]
curr_Stock_Price:  96.14869752684876
curr_Factors:  [96.14869753]
mat_Sqrt:  [[0.15]]
grads:  [0.08009232]
Stock Position:  0.08009231522285093
Bond Position:  [-16.4322061]


portfolio before change:  [-8.72360361]
curr_Stock_Price:  96.2592917796574
curr_Factors:  [96.25929178]
mat_Sqrt:  [[0.15]]
grads:  [-0.01597269]
Stock Position:  -0.015972688588476034
Bond Position:  [-7.18608392]


portfolio before change:  [-8.7123724]
curr_Stock_Price:  95.52802138133234
curr_Factors:  [95.52802138]
mat_Sqrt:  [[0.15]]
grads:  [-0.02203406]
Stock Position:  -0.02203406480747157
Bond Position:  [-6.60750178]


portfolio before change:  [-8.70685962]
curr_Stock_Price:  95.25908504775714
curr_Factors:  [95.25908505]
mat_Sqrt:  [[0.15]]
grads:  [0.05157388]
Stock Position:  0.05157387936217791
Bond Position:  [-13.61974018]


portfolio before change:  [-8.71453515]
curr_Stock_Price:  95.12676478982978
curr_Factors:  [95.12676479]
mat_Sqrt:  [[0.15]]
grads:  [-0.03903746]
Stock Position:  -0.039037459497750636
Bond Position:  [-5.00102792]


portfolio before change:  [-8.70937484]
curr_Stock_Price:  94.98656926143899
curr_Factors:  [94.98656926]
mat_Sqrt:  [[0.15]]
grads:  [0.02217567]
Stock Position:  0.022175673491575412
Bond Position:  [-10.81576599]


portfolio before change:  [-8.71850437]
curr_Stock_Price:  94.60536230037359
curr_Factors:  [94.6053623]
mat_Sqrt:  [[0.15]]
grads:  [0.09961357]
Stock Position:  0.0996135657850092
Bond Position:  [-18.14248185]


portfolio before change:  [-8.7639139]
curr_Stock_Price:  94.16088888342952
curr_Factors:  [94.16088888]
mat_Sqrt:  [[0.15]]
grads:  [-0.09952754]
Stock Position:  -0.09952753751470404
Bond Position:  [0.60768751]


portfolio before change:  [-8.81598886]
curr_Stock_Price:  94.68449214247602
curr_Factors:  [94.68449214]
mat_Sqrt:  [[0.15]]
grads:  [-0.32963976]
Stock Position:  -0.3296397627465266
Bond Position:  [22.39578467]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.81598886]
Stock Price:  93.88627742716886
PL:  [-8.81598886]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.59840763e-02]
 [ 6.57706507e-03]
 [-1.10743584e-04]
 [ 1.39011405e-03]
 [ 9.65711326e-03]
 [ 1.18177032e-02]
 [ 7.30654102e-04]
 [ 7.91448789e-03]
 [ 1.56018094e-03]
 [-2.02124540e-02]
 [ 1.02495277e-02]
 [-5.00587432e-03]
 [-3.98622206e-03]
 [ 4.26113297e-03]
 [ 3.51912874e-03]
 [-1.00835589e-02]
 [ 8.96319424e-03]
 [ 2.64707115e-02]
 [ 1.52213570e-02]
 [-2.46916353e-03]
 [ 4.38522556e-02]
 [-1.22421413e-02]
 [ 2.68289689e-03]
 [ 5.14169378e-04]
 [ 1.82299244e-02]
 [ 1.57612127e-02]
 [ 7.94642272e-03]
 [ 2.53518777e-04]
 [ 6.55273576e-03]
 [-9.97459163e-03]
 [-5.69304793e-03]
 [ 4.09285882e-02]
 [ 5.04750662e-03]
 [-7.05357958e-03]
 [-4.70511549e-03]
 [-5.49764143e-03]
 [-2.08687086e-03]
 [-1.94268802e-03]
 [ 4.81493070e-03]
 [-6.89023994e-03]
 [-5.24742466e-02]
 [-4.00089093e-03]
 [ 1.55356546e-02]
 [-1.35810866e-02]
 [-3.30135222e-03]
 [ 2.41729226e-03]
 [-1.36048353e-02]
 [ 1.70536374e-03]
 [ 6.60621899e-03]
 [-9.33997341e-03]
 [-4.01844667e-03]
 [ 3.46435778e-03]
 [ 2.89267997e-03]
 [-3.21856533e-03]
 [-9.82356545e-03]
 [ 1.18826361e-02]
 [-2.66513129e-02]
 [-8.48760266e-03]
 [ 1.80625506e-02]
 [-6.10949212e-03]
 [ 1.31305886e-02]
 [-1.42498738e-02]
 [-1.27080641e-02]
 [-2.95572570e-03]
 [ 8.90948970e-02]
 [-1.57631732e-02]
 [ 1.01411896e-02]
 [ 4.83225202e-03]
 [ 1.24689261e-02]
 [-2.22048589e-02]
 [-8.00679575e-03]
 [-6.71716899e-03]
 [ 7.55010778e-03]
 [ 6.24089543e-03]
 [-7.15668236e-04]
 [-2.81431827e-03]
 [ 7.12788415e-03]
 [-2.85666946e-03]
 [ 1.99310525e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.02254816]
curr_Stock_Price:  99.67292689630786
curr_Factors:  [99.6729269]
mat_Sqrt:  [[0.15]]
grads:  [-0.23989384]
Stock Position:  -0.2398938418574681
Bond Position:  [20.8883732]


portfolio before change:  [-2.84641713]
curr_Stock_Price:  98.94416508749586
curr_Factors:  [98.94416509]
mat_Sqrt:  [[0.15]]
grads:  [0.0438471]
Stock Position:  0.043847100482335574
Bond Position:  [-7.18483188]


portfolio before change:  [-2.8191968]
curr_Stock_Price:  99.57520779642948
curr_Factors:  [99.5752078]
mat_Sqrt:  [[0.15]]
grads:  [-0.00073829]
Stock Position:  -0.0007382905616713324
Bond Position:  [-2.74568137]


portfolio before change:  [-2.81936844]
curr_Stock_Price:  99.57524415664386
curr_Factors:  [99.57524416]
mat_Sqrt:  [[0.15]]
grads:  [0.00926743]
Stock Position:  0.009267426968033284
Bond Position:  [-3.74217474]


portfolio before change:  [-2.81141167]
curr_Stock_Price:  100.45905591949776
curr_Factors:  [100.45905592]
mat_Sqrt:  [[0.15]]
grads:  [0.06438076]
Stock Position:  0.06438075506262647
Bond Position:  [-9.27904154]


portfolio before change:  [-2.80496984]
curr_Stock_Price:  100.56812244680144
curr_Factors:  [100.56812245]
mat_Sqrt:  [[0.15]]
grads:  [0.07878469]
Stock Position:  0.07878468787704626
Bond Position:  [-10.72819798]


portfolio before change:  [-2.78624938]
curr_Stock_Price:  100.81424897506854
curr_Factors:  [100.81424898]
mat_Sqrt:  [[0.15]]
grads:  [0.00487103]
Stock Position:  0.004871027347362548
Bond Position:  [-3.27731834]


portfolio before change:  [-2.78540068]
curr_Stock_Price:  101.03053460934498
curr_Factors:  [101.03053461]
mat_Sqrt:  [[0.15]]
grads:  [0.05276325]
Stock Position:  0.05276325257242078
Bond Position:  [-8.1161003]


portfolio before change:  [-2.80802389]
curr_Stock_Price:  100.61138043173278
curr_Factors:  [100.61138043]
mat_Sqrt:  [[0.15]]
grads:  [0.01040121]
Stock Position:  0.010401206268192681
Bond Position:  [-3.85450361]


portfolio before change:  [-2.80991311]
curr_Stock_Price:  100.45290791073211
curr_Factors:  [100.45290791]
mat_Sqrt:  [[0.15]]
grads:  [-0.13474969]
Stock Position:  -0.1347496934116942
Bond Position:  [10.72608543]


portfolio before change:  [-2.83153659]
curr_Stock_Price:  100.61835449227709
curr_Factors:  [100.61835449]
mat_Sqrt:  [[0.15]]
grads:  [0.06833018]
Stock Position:  0.0683301847355554
Bond Position:  [-9.70680734]


portfolio before change:  [-2.86634913]
curr_Stock_Price:  100.1177580781553
curr_Factors:  [100.11775808]
mat_Sqrt:  [[0.15]]
grads:  [-0.0333725]
Stock Position:  -0.03337249545709396
Bond Position:  [0.4748303]


portfolio before change:  [-2.87598035]
curr_Stock_Price:  100.40724491394634
curr_Factors:  [100.40724491]
mat_Sqrt:  [[0.15]]
grads:  [-0.02657481]
Stock Position:  -0.026574813750880888
Bond Position:  [-0.20767651]


portfolio before change:  [-2.87398512]
curr_Stock_Price:  100.33167690114418
curr_Factors:  [100.3316769]
mat_Sqrt:  [[0.15]]
grads:  [0.02840755]
Stock Position:  0.028407553147187445
Bond Position:  [-5.72416256]


portfolio before change:  [-2.85155051]
curr_Stock_Price:  101.13401216029943
curr_Factors:  [101.13401216]
mat_Sqrt:  [[0.15]]
grads:  [0.02346086]
Stock Position:  0.023460858273484514
Bond Position:  [-5.22424124]


portfolio before change:  [-2.83386652]
curr_Stock_Price:  101.90169592299928
curr_Factors:  [101.90169592]
mat_Sqrt:  [[0.15]]
grads:  [-0.06722373]
Stock Position:  -0.06722372605948561
Bond Position:  [4.01634518]


portfolio before change:  [-2.87073145]
curr_Stock_Price:  102.4538218994459
curr_Factors:  [102.4538219]
mat_Sqrt:  [[0.15]]
grads:  [0.05975463]
Stock Position:  0.05975462825540109
Bond Position:  [-8.99282149]


portfolio before change:  [-2.87404368]
curr_Stock_Price:  102.40779760888117
curr_Factors:  [102.40779761]
mat_Sqrt:  [[0.15]]
grads:  [0.17647141]
Stock Position:  0.1764714102143494
Bond Position:  [-20.94609215]


portfolio before change:  [-2.88152996]
curr_Stock_Price:  102.37279418743364
curr_Factors:  [102.37279419]
mat_Sqrt:  [[0.15]]
grads:  [0.10147571]
Stock Position:  0.10147571351785872
Bond Position:  [-13.26988229]


portfolio before change:  [-2.81726068]
curr_Stock_Price:  103.0143138833234
curr_Factors:  [103.01431388]
mat_Sqrt:  [[0.15]]
grads:  [-0.01646109]
Stock Position:  -0.016461090182363254
Bond Position:  [-1.12153277]


portfolio before change:  [-2.809268]
curr_Stock_Price:  102.52450525344565
curr_Factors:  [102.52450525]
mat_Sqrt:  [[0.15]]
grads:  [0.29234837]
Stock Position:  0.2923483708197273
Bond Position:  [-32.78214008]


portfolio before change:  [-2.83959253]
curr_Stock_Price:  102.4277864540078
curr_Factors:  [102.42778645]
mat_Sqrt:  [[0.15]]
grads:  [-0.08161428]
Stock Position:  -0.08161427529830328
Bond Position:  [5.51997703]


portfolio before change:  [-2.90077028]
curr_Stock_Price:  103.1816100091385
curr_Factors:  [103.18161001]
mat_Sqrt:  [[0.15]]
grads:  [0.01788598]
Stock Position:  0.017885979287942128
Bond Position:  [-4.74627442]


portfolio before change:  [-2.89681785]
curr_Stock_Price:  103.41917531977387
curr_Factors:  [103.41917532]
mat_Sqrt:  [[0.15]]
grads:  [0.0034278]
Stock Position:  0.0034277958546684423
Bond Position:  [-3.25131767]


portfolio before change:  [-2.89503545]
curr_Stock_Price:  103.99844148767025
curr_Factors:  [103.99844149]
mat_Sqrt:  [[0.15]]
grads:  [0.12153283]
Stock Position:  0.12153282945836763
Bond Position:  [-15.53426031]


portfolio before change:  [-2.89184302]
curr_Stock_Price:  104.03269856324042
curr_Factors:  [104.03269856]
mat_Sqrt:  [[0.15]]
grads:  [0.10507475]
Stock Position:  0.10507475148726345
Bond Position:  [-13.82305296]


portfolio before change:  [-2.90145081]
curr_Stock_Price:  103.94948331000955
curr_Factors:  [103.94948331]
mat_Sqrt:  [[0.15]]
grads:  [0.05297615]
Stock Position:  0.052976151499086604
Bond Position:  [-8.40829438]


portfolio before change:  [-2.93786148]
curr_Stock_Price:  103.27210047016402
curr_Factors:  [103.27210047]
mat_Sqrt:  [[0.15]]
grads:  [0.00169013]
Stock Position:  0.0016901251798793343
Bond Position:  [-3.11240425]


portfolio before change:  [-2.93871043]
curr_Stock_Price:  102.88489562311885
curr_Factors:  [102.88489562]
mat_Sqrt:  [[0.15]]
grads:  [0.04368491]
Stock Position:  0.043684905096711184
Bond Position:  [-7.43322733]


portfolio before change:  [-2.92007699]
curr_Stock_Price:  103.32207257013407
curr_Factors:  [103.32207257]
mat_Sqrt:  [[0.15]]
grads:  [-0.06649728]
Stock Position:  -0.06649727750140781
Bond Position:  [3.95055954]


portfolio before change:  [-2.86997331]
curr_Stock_Price:  102.57231617087017
curr_Factors:  [102.57231617]
mat_Sqrt:  [[0.15]]
grads:  [-0.03795365]
Stock Position:  -0.037953652837928606
Bond Position:  [1.02302077]


portfolio before change:  [-2.91085331]
curr_Stock_Price:  103.65110394363026
curr_Factors:  [103.65110394]
mat_Sqrt:  [[0.15]]
grads:  [0.27285725]
Stock Position:  0.272857254632387
Bond Position:  [-31.19280897]


portfolio before change:  [-2.90080603]
curr_Stock_Price:  103.69507157915561
curr_Factors:  [103.69507158]
mat_Sqrt:  [[0.15]]
grads:  [0.03365004]
Stock Position:  0.03365004415328815
Bond Position:  [-6.39014977]


portfolio before change:  [-2.88492439]
curr_Stock_Price:  104.17890577063801
curr_Factors:  [104.17890577]
mat_Sqrt:  [[0.15]]
grads:  [-0.04702386]
Stock Position:  -0.047023863867591664
Bond Position:  [2.0139703]


portfolio before change:  [-2.9015933]
curr_Stock_Price:  104.53606035912378
curr_Factors:  [104.53606036]
mat_Sqrt:  [[0.15]]
grads:  [-0.03136744]
Stock Position:  -0.031367436627717134
Bond Position:  [0.37743495]


portfolio before change:  [-2.9100743]
curr_Stock_Price:  104.8071883019677
curr_Factors:  [104.8071883]
mat_Sqrt:  [[0.15]]
grads:  [-0.03665094]
Stock Position:  -0.03665094287324641
Bond Position:  [0.93120797]


portfolio before change:  [-2.92044704]
curr_Stock_Price:  105.09179061650748
curr_Factors:  [105.09179062]
mat_Sqrt:  [[0.15]]
grads:  [-0.01391247]
Stock Position:  -0.013912472423623715
Bond Position:  [-1.4583604]


portfolio before change:  [-2.92011824]
curr_Stock_Price:  105.06160553776846
curr_Factors:  [105.06160554]
mat_Sqrt:  [[0.15]]
grads:  [-0.01295125]
Stock Position:  -0.012951253465715087
Bond Position:  [-1.55943876]


portfolio before change:  [-2.91081866]
curr_Stock_Price:  104.33603527356458
curr_Factors:  [104.33603527]
mat_Sqrt:  [[0.15]]
grads:  [0.03209954]
Stock Position:  0.03209953802296925
Bond Position:  [-6.25995719]


portfolio before change:  [-2.90144883]
curr_Stock_Price:  104.64012337152361
curr_Factors:  [104.64012337]
mat_Sqrt:  [[0.15]]
grads:  [-0.04593493]
Stock Position:  -0.045934932961224806
Bond Position:  [1.90518822]


portfolio before change:  [-2.90003275]
curr_Stock_Price:  104.6118876367904
curr_Factors:  [104.61188764]
mat_Sqrt:  [[0.15]]
grads:  [-0.34982831]
Stock Position:  -0.3498283105597544
Bond Position:  [33.69616717]


portfolio before change:  [-2.81932434]
curr_Stock_Price:  104.38719932722262
curr_Factors:  [104.38719933]
mat_Sqrt:  [[0.15]]
grads:  [-0.02667261]
Stock Position:  -0.02667260618039218
Bond Position:  [-0.03504568]


portfolio before change:  [-2.81560227]
curr_Stock_Price:  104.24757072097293
curr_Factors:  [104.24757072]
mat_Sqrt:  [[0.15]]
grads:  [0.10357103]
Stock Position:  0.10357103069846742
Bond Position:  [-13.61263062]


portfolio before change:  [-2.84460499]
curr_Stock_Price:  103.97575819840816
curr_Factors:  [103.9757582]
mat_Sqrt:  [[0.15]]
grads:  [-0.09054058]
Stock Position:  -0.09054057704463754
Bond Position:  [6.56942015]


portfolio before change:  [-2.8767367]
curr_Stock_Price:  104.33518057456084
curr_Factors:  [104.33518057]
mat_Sqrt:  [[0.15]]
grads:  [-0.02200901]
Stock Position:  -0.022009014790928576
Bond Position:  [-0.58042217]


portfolio before change:  [-2.84932591]
curr_Stock_Price:  103.08809740424692
curr_Factors:  [103.0880974]
mat_Sqrt:  [[0.15]]
grads:  [0.01611528]
Stock Position:  0.01611528176145591
Bond Position:  [-4.51061964]


portfolio before change:  [-2.83555715]
curr_Stock_Price:  103.95998274006139
curr_Factors:  [103.95998274]
mat_Sqrt:  [[0.15]]
grads:  [-0.0906989]
Stock Position:  -0.09069890181126472
Bond Position:  [6.59349912]


portfolio before change:  [-2.72542882]
curr_Stock_Price:  102.75030735193342
curr_Factors:  [102.75030735]
mat_Sqrt:  [[0.15]]
grads:  [0.01136909]
Stock Position:  0.01136909157809093
Bond Position:  [-3.89360647]


portfolio before change:  [-2.72103892]
curr_Stock_Price:  103.15783795157232
curr_Factors:  [103.15783795]
mat_Sqrt:  [[0.15]]
grads:  [0.04404146]
Stock Position:  0.044041459966558096
Bond Position:  [-7.26426071]


portfolio before change:  [-2.70761092]
curr_Stock_Price:  103.47304159420189
curr_Factors:  [103.47304159]
mat_Sqrt:  [[0.15]]
grads:  [-0.06226649]
Stock Position:  -0.062266489376825954
Bond Position:  [3.73529212]


portfolio before change:  [-2.76069631]
curr_Stock_Price:  104.32934241120469
curr_Factors:  [104.32934241]
mat_Sqrt:  [[0.15]]
grads:  [-0.02678964]
Stock Position:  -0.026789644482433546
Bond Position:  [0.03424969]


portfolio before change:  [-2.76001664]
curr_Stock_Price:  104.30405172357456
curr_Factors:  [104.30405172]
mat_Sqrt:  [[0.15]]
grads:  [0.02309572]
Stock Position:  0.023095718562346886
Bond Position:  [-5.16899366]


portfolio before change:  [-2.75494422]
curr_Stock_Price:  104.53766610417593
curr_Factors:  [104.5376661]
mat_Sqrt:  [[0.15]]
grads:  [0.01928453]
Stock Position:  0.019284533100602193
Bond Position:  [-4.7709043]


portfolio before change:  [-2.73920595]
curr_Stock_Price:  105.36923704195279
curr_Factors:  [105.36923704]
mat_Sqrt:  [[0.15]]
grads:  [-0.0214571]
Stock Position:  -0.02145710220635774
Bond Position:  [-0.47828746]


portfolio before change:  [-2.73981357]
curr_Stock_Price:  105.39616192751218
curr_Factors:  [105.39616193]
mat_Sqrt:  [[0.15]]
grads:  [-0.06549044]
Stock Position:  -0.06549043634341395
Bond Position:  [4.16262706]


portfolio before change:  [-2.73915044]
curr_Stock_Price:  105.39000888513134
curr_Factors:  [105.39000889]
mat_Sqrt:  [[0.15]]
grads:  [0.07921757]
Stock Position:  0.07921757398901194
Bond Position:  [-11.08789126]


portfolio before change:  [-2.72782817]
curr_Stock_Price:  105.54168329530044
curr_Factors:  [105.5416833]
mat_Sqrt:  [[0.15]]
grads:  [-0.17767542]
Stock Position:  -0.17767541963884032
Bond Position:  [16.0243347]


portfolio before change:  [-2.64081097]
curr_Stock_Price:  105.05756652632607
curr_Factors:  [105.05756653]
mat_Sqrt:  [[0.15]]
grads:  [-0.05658402]
Stock Position:  -0.05658401775010934
Bond Position:  [3.30376824]


portfolio before change:  [-2.63999234]
curr_Stock_Price:  105.04674830012725
curr_Factors:  [105.0467483]
mat_Sqrt:  [[0.15]]
grads:  [0.120417]
Stock Position:  0.12041700418912556
Bond Position:  [-15.28940707]


portfolio before change:  [-2.55212702]
curr_Stock_Price:  105.78435953714612
curr_Factors:  [105.78435954]
mat_Sqrt:  [[0.15]]
grads:  [-0.04072995]
Stock Position:  -0.04072994748252751
Bond Position:  [1.75646439]


portfolio before change:  [-2.5589779]
curr_Stock_Price:  105.9552572865341
curr_Factors:  [105.95525729]
mat_Sqrt:  [[0.15]]
grads:  [0.08753726]
Stock Position:  0.08753725739861558
Bond Position:  [-11.83401053]


portfolio before change:  [-2.60036367]
curr_Stock_Price:  105.49092780167072
curr_Factors:  [105.4909278]
mat_Sqrt:  [[0.15]]
grads:  [-0.09499916]
Stock Position:  -0.09499915891133545
Bond Position:  [7.42118574]


portfolio before change:  [-2.65500993]
curr_Stock_Price:  106.07103915980318
curr_Factors:  [106.07103916]
mat_Sqrt:  [[0.15]]
grads:  [-0.08472043]
Stock Position:  -0.08472042736245299
Bond Position:  [6.33137384]


portfolio before change:  [-2.63245388]
curr_Stock_Price:  105.80946911830827
curr_Factors:  [105.80946912]
mat_Sqrt:  [[0.15]]
grads:  [-0.01970484]
Stock Position:  -0.01970483800245199
Bond Position:  [-0.54749543]


portfolio before change:  [-2.64275845]
curr_Stock_Price:  106.33067871286791
curr_Factors:  [106.33067871]
mat_Sqrt:  [[0.15]]
grads:  [0.59396598]
Stock Position:  0.5939659801066093
Bond Position:  [-65.79956424]


portfolio before change:  [-3.12312342]
curr_Stock_Price:  105.52886111602712
curr_Factors:  [105.52886112]
mat_Sqrt:  [[0.15]]
grads:  [-0.10508782]
Stock Position:  -0.10508782124520222
Bond Position:  [7.96667467]


portfolio before change:  [-3.16699389]
curr_Stock_Price:  105.95106414728289
curr_Factors:  [105.95106415]
mat_Sqrt:  [[0.15]]
grads:  [0.06760793]
Stock Position:  0.06760793041820613
Bond Position:  [-10.33012606]


portfolio before change:  [-3.21283386]
curr_Stock_Price:  105.28258756497327
curr_Factors:  [105.28258756]
mat_Sqrt:  [[0.15]]
grads:  [0.03221501]
Stock Position:  0.03221501346335725
Bond Position:  [-6.60451383]


portfolio before change:  [-3.20760076]
curr_Stock_Price:  105.45784428981077
curr_Factors:  [105.45784429]
mat_Sqrt:  [[0.15]]
grads:  [0.08312617]
Stock Position:  0.08312617401162173
Bond Position:  [-11.97390787]


portfolio before change:  [-3.29581948]
curr_Stock_Price:  104.40558451890966
curr_Factors:  [104.40558452]
mat_Sqrt:  [[0.15]]
grads:  [-0.14803239]
Stock Position:  -0.14803239258309678
Bond Position:  [12.159589]


portfolio before change:  [-3.3401279]
curr_Stock_Price:  104.7100342424583
curr_Factors:  [104.71003424]
mat_Sqrt:  [[0.15]]
grads:  [-0.05337864]
Stock Position:  -0.0533786383327974
Bond Position:  [2.24915115]


portfolio before change:  [-3.33641899]
curr_Stock_Price:  104.64318483407897
curr_Factors:  [104.64318483]
mat_Sqrt:  [[0.15]]
grads:  [-0.04478113]
Stock Position:  -0.0447811266038209
Bond Position:  [1.34962071]


portfolio before change:  [-3.3435568]
curr_Stock_Price:  104.80446164821588
curr_Factors:  [104.80446165]
mat_Sqrt:  [[0.15]]
grads:  [0.05033405]
Stock Position:  0.050334051885449725
Bond Position:  [-8.61879001]


portfolio before change:  [-3.32308476]
curr_Stock_Price:  105.22188742436802
curr_Factors:  [105.22188742]
mat_Sqrt:  [[0.15]]
grads:  [0.04160597]
Stock Position:  0.041605969527521026
Bond Position:  [-7.7009434]


portfolio before change:  [-3.33020788]
curr_Stock_Price:  105.06225176788617
curr_Factors:  [105.06225177]
mat_Sqrt:  [[0.15]]
grads:  [-0.00477112]
Stock Position:  -0.004771121571629042
Bond Position:  [-2.8289431]


portfolio before change:  [-3.32928369]
curr_Stock_Price:  104.83148866977878
curr_Factors:  [104.83148867]
mat_Sqrt:  [[0.15]]
grads:  [-0.01876212]
Stock Position:  -0.01876212180114547
Bond Position:  [-1.36242253]


portfolio before change:  [-3.34936694]
curr_Stock_Price:  105.89736431910012
curr_Factors:  [105.89736432]
mat_Sqrt:  [[0.15]]
grads:  [0.04751923]
Stock Position:  0.04751922765584847
Bond Position:  [-8.3815279]


portfolio before change:  [-3.32791361]
curr_Stock_Price:  106.35985479509394
curr_Factors:  [106.3598548]
mat_Sqrt:  [[0.15]]
grads:  [-0.01904446]
Stock Position:  -0.019044463039055055
Bond Position:  [-1.30234728]


portfolio before change:  [-3.34613077]
curr_Stock_Price:  107.3121401322283
curr_Factors:  [107.31214013]
mat_Sqrt:  [[0.15]]
grads:  [0.13287368]
Stock Position:  0.1328736836381372
Bond Position:  [-17.60509013]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.34613077]
Stock Price:  107.15964850968736
PL:  [-10.50577928]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.93573388e-02]
 [-1.48873087e-03]
 [ 2.79988528e-04]
 [ 2.15462304e-03]
 [ 7.25947874e-03]
 [ 1.17994049e-02]
 [ 5.71999830e-04]
 [ 7.98251719e-03]
 [-4.17104683e-05]
 [-1.21291929e-02]
 [ 1.00024664e-02]
 [-8.56560918e-03]
 [ 2.09755457e-02]
 [ 1.69136378e-02]
 [-6.41004185e-03]
 [-1.00653820e-02]
 [ 1.08567638e-02]
 [ 2.65694875e-02]
 [ 1.01790857e-02]
 [-1.58969508e-03]
 [ 3.24363992e-02]
 [-1.06711752e-02]
 [-2.89585704e-03]
 [ 4.90933021e-03]
 [ 1.83231804e-02]
 [ 1.71494440e-02]
 [ 8.48887032e-03]
 [ 2.80858762e-03]
 [ 7.25217006e-03]
 [-9.88343894e-03]
 [-5.69695178e-03]
 [ 3.10666695e-02]
 [ 7.57732781e-03]
 [ 3.38940219e-03]
 [-3.91368107e-03]
 [-4.30352077e-03]
 [-6.76909847e-03]
 [ 1.24595453e-02]
 [ 1.43776655e-03]
 [-8.71202401e-03]
 [-2.96367304e-02]
 [-2.45374445e-03]
 [ 9.59323215e-03]
 [-1.18574656e-02]
 [-5.31289153e-04]
 [ 2.33674404e-03]
 [-1.37053493e-02]
 [-4.69110134e-03]
 [-8.75318390e-04]
 [ 3.76546718e-03]
 [-2.99130123e-03]
 [ 3.77017427e-03]
 [ 5.23736438e-04]
 [ 2.96083691e-05]
 [ 1.61657984e-03]
 [ 8.56540457e-03]
 [ 9.93238759e-04]
 [-2.08788721e-02]
 [ 1.33989973e-02]
 [ 4.43178084e-03]
 [ 1.03129959e-02]
 [-1.31577006e-02]
 [-1.25903575e-02]
 [-2.29654008e-03]
 [-2.00394757e-02]
 [ 3.71426986e-02]
 [ 1.88265349e-02]
 [ 2.10783810e-03]
 [ 6.16798189e-03]
 [-1.46117763e-02]
 [-5.99105368e-03]
 [-4.91528666e-03]
 [ 1.63186224e-03]
 [ 8.08169042e-03]
 [ 4.83578272e-03]
 [-1.22115059e-02]
 [ 2.49066783e-03]
 [-7.69640888e-03]
 [ 5.42658198e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.45689517]
curr_Stock_Price:  100.15363565270532
curr_Factors:  [100.15363565]
mat_Sqrt:  [[0.15]]
grads:  [-0.26238226]
Stock Position:  -0.26238225892092165
Bond Position:  [30.73543233]


portfolio before change:  [4.37025801]
curr_Stock_Price:  100.49115154510112
curr_Factors:  [100.49115155]
mat_Sqrt:  [[0.15]]
grads:  [-0.00992487]
Stock Position:  -0.009924872441985077
Bond Position:  [5.36761987]


portfolio before change:  [4.37143519]
curr_Stock_Price:  100.40634528378132
curr_Factors:  [100.40634528]
mat_Sqrt:  [[0.15]]
grads:  [0.00186659]
Stock Position:  0.001866590188229142
Bond Position:  [4.18401769]


portfolio before change:  [4.37122377]
curr_Stock_Price:  100.15297939470192
curr_Factors:  [100.15297939]
mat_Sqrt:  [[0.15]]
grads:  [0.01436415]
Stock Position:  0.014364153600313158
Bond Position:  [2.93261099]


portfolio before change:  [4.37812865]
curr_Stock_Price:  100.62092088533382
curr_Factors:  [100.62092089]
mat_Sqrt:  [[0.15]]
grads:  [0.04839652]
Stock Position:  0.048396524955398895
Bond Position:  [-0.49157426]


portfolio before change:  [4.37262349]
curr_Stock_Price:  100.50780478484383
curr_Factors:  [100.50780478]
mat_Sqrt:  [[0.15]]
grads:  [0.0786627]
Stock Position:  0.07866269966179155
Bond Position:  [-3.53359177]


portfolio before change:  [4.40705307]
curr_Stock_Price:  100.94829859380924
curr_Factors:  [100.94829859]
mat_Sqrt:  [[0.15]]
grads:  [0.00381333]
Stock Position:  0.00381333219867976
Bond Position:  [4.02210367]


portfolio before change:  [4.40756401]
curr_Stock_Price:  101.0163611912841
curr_Factors:  [101.01636119]
mat_Sqrt:  [[0.15]]
grads:  [0.05321678]
Stock Position:  0.05321678126196707
Bond Position:  [-0.96820159]


portfolio before change:  [4.39077281]
curr_Stock_Price:  100.70197397120734
curr_Factors:  [100.70197397]
mat_Sqrt:  [[0.15]]
grads:  [-0.00027807]
Stock Position:  -0.0002780697887330664
Bond Position:  [4.41877499]


portfolio before change:  [4.39080363]
curr_Stock_Price:  101.58437310136257
curr_Factors:  [101.5843731]
mat_Sqrt:  [[0.15]]
grads:  [-0.08086129]
Stock Position:  -0.08086128621884311
Bond Position:  [12.6050467]


portfolio before change:  [4.37107388]
curr_Stock_Price:  101.83811118540406
curr_Factors:  [101.83811119]
mat_Sqrt:  [[0.15]]
grads:  [0.06668311]
Stock Position:  0.06668310942556402
Bond Position:  [-2.41980803]


portfolio before change:  [4.35139301]
curr_Stock_Price:  101.54523902446213
curr_Factors:  [101.54523902]
mat_Sqrt:  [[0.15]]
grads:  [-0.05710406]
Stock Position:  -0.057104061180387085
Bond Position:  [10.15003855]


portfolio before change:  [4.32076781]
curr_Stock_Price:  102.0926537002158
curr_Factors:  [102.0926537]
mat_Sqrt:  [[0.15]]
grads:  [0.13983697]
Stock Position:  0.1398369716006745
Bond Position:  [-9.95555971]


portfolio before change:  [4.42520063]
curr_Stock_Price:  102.84392183534636
curr_Factors:  [102.84392184]
mat_Sqrt:  [[0.15]]
grads:  [0.11275759]
Stock Position:  0.11275758508481995
Bond Position:  [-7.17123164]


portfolio before change:  [4.4151711]
curr_Stock_Price:  102.75894921926862
curr_Factors:  [102.75894922]
mat_Sqrt:  [[0.15]]
grads:  [-0.04273361]
Stock Position:  -0.04273361234468367
Bond Position:  [8.8064322]


portfolio before change:  [4.44505721]
curr_Stock_Price:  102.07247115683407
curr_Factors:  [102.07247116]
mat_Sqrt:  [[0.15]]
grads:  [-0.06710255]
Stock Position:  -0.06710254666148821
Bond Position:  [11.29437997]


portfolio before change:  [4.39180593]
curr_Stock_Price:  102.87657184655421
curr_Factors:  [102.87657185]
mat_Sqrt:  [[0.15]]
grads:  [0.07237843]
Stock Position:  0.07237842539358148
Bond Position:  [-3.05423835]


portfolio before change:  [4.3597436]
curr_Stock_Price:  102.43622745391927
curr_Factors:  [102.43622745]
mat_Sqrt:  [[0.15]]
grads:  [0.17712992]
Stock Position:  0.1771299169084339
Bond Position:  [-13.78477686]


portfolio before change:  [4.40204033]
curr_Stock_Price:  102.67988087111338
curr_Factors:  [102.67988087]
mat_Sqrt:  [[0.15]]
grads:  [0.06786057]
Stock Position:  0.06786057129147825
Bond Position:  [-2.56587504]


portfolio before change:  [4.38655849]
curr_Stock_Price:  102.45410221149798
curr_Factors:  [102.45410221]
mat_Sqrt:  [[0.15]]
grads:  [-0.01059797]
Stock Position:  -0.010597967177390616
Bond Position:  [5.4723637]


portfolio before change:  [4.38037559]
curr_Stock_Price:  103.0697802268457
curr_Factors:  [103.06978023]
mat_Sqrt:  [[0.15]]
grads:  [0.21624266]
Stock Position:  0.2162426610891284
Bond Position:  [-17.90770797]


portfolio before change:  [4.46253848]
curr_Stock_Price:  103.4549131227741
curr_Factors:  [103.45491312]
mat_Sqrt:  [[0.15]]
grads:  [-0.07114117]
Stock Position:  -0.07114116776858023
Bond Position:  [11.82244182]


portfolio before change:  [4.425094]
curr_Stock_Price:  103.99164045501745
curr_Factors:  [103.99164046]
mat_Sqrt:  [[0.15]]
grads:  [-0.01930571]
Stock Position:  -0.019305713627744442
Bond Position:  [6.43272683]


portfolio before change:  [4.41648563]
curr_Stock_Price:  104.45836386059143
curr_Factors:  [104.45836386]
mat_Sqrt:  [[0.15]]
grads:  [0.03272887]
Stock Position:  0.032728868082777175
Bond Position:  [0.99768162]


portfolio before change:  [4.40476418]
curr_Stock_Price:  104.09832064097701
curr_Factors:  [104.09832064]
mat_Sqrt:  [[0.15]]
grads:  [0.12215454]
Stock Position:  0.122154536020986
Bond Position:  [-8.31131788]


portfolio before change:  [4.3148866]
curr_Stock_Price:  103.36680372861477
curr_Factors:  [103.36680373]
mat_Sqrt:  [[0.15]]
grads:  [0.11432963]
Stock Position:  0.11432962637529907
Bond Position:  [-7.50300145]


portfolio before change:  [4.34113111]
curr_Stock_Price:  103.6004567628632
curr_Factors:  [103.60045676]
mat_Sqrt:  [[0.15]]
grads:  [0.05659247]
Stock Position:  0.05659246879314669
Bond Position:  [-1.52187451]


portfolio before change:  [4.29486322]
curr_Stock_Price:  102.78457483813416
curr_Factors:  [102.78457484]
mat_Sqrt:  [[0.15]]
grads:  [0.01872392]
Stock Position:  0.018723917452202456
Bond Position:  [2.37033332]


portfolio before change:  [4.30589091]
curr_Stock_Price:  103.3656252671378
curr_Factors:  [103.36562527]
mat_Sqrt:  [[0.15]]
grads:  [0.0483478]
Stock Position:  0.048347800381970764
Bond Position:  [-0.69160971]


portfolio before change:  [4.31188598]
curr_Stock_Price:  103.49051817005254
curr_Factors:  [103.49051817]
mat_Sqrt:  [[0.15]]
grads:  [-0.06588959]
Stock Position:  -0.06588959294752363
Bond Position:  [11.13083409]


portfolio before change:  [4.36766262]
curr_Stock_Price:  102.65455994960377
curr_Factors:  [102.65455995]
mat_Sqrt:  [[0.15]]
grads:  [-0.03797968]
Stock Position:  -0.03797967853563929
Bond Position:  [8.26644981]


portfolio before change:  [4.38915819]
curr_Stock_Price:  102.10218825528567
curr_Factors:  [102.10218826]
mat_Sqrt:  [[0.15]]
grads:  [0.20711113]
Stock Position:  0.2071111300382489
Bond Position:  [-16.7573414]


portfolio before change:  [4.33744524]
curr_Stock_Price:  101.85755830523362
curr_Factors:  [101.85755831]
mat_Sqrt:  [[0.15]]
grads:  [0.05051552]
Stock Position:  0.05051551870895842
Bond Position:  [-0.80794215]


portfolio before change:  [4.33618618]
curr_Stock_Price:  101.83363364854554
curr_Factors:  [101.83363365]
mat_Sqrt:  [[0.15]]
grads:  [0.02259601]
Stock Position:  0.02259601462470339
Bond Position:  [2.0351519]


portfolio before change:  [4.34394002]
curr_Stock_Price:  102.17115509703193
curr_Factors:  [102.1711551]
mat_Sqrt:  [[0.15]]
grads:  [-0.02609121]
Stock Position:  -0.026091207112780356
Bond Position:  [7.00970878]


portfolio before change:  [4.34108299]
curr_Stock_Price:  102.29744863800242
curr_Factors:  [102.29744864]
mat_Sqrt:  [[0.15]]
grads:  [-0.02869014]
Stock Position:  -0.028690138458850146
Bond Position:  [7.27601095]


portfolio before change:  [4.3686642]
curr_Stock_Price:  101.35195142452976
curr_Factors:  [101.35195142]
mat_Sqrt:  [[0.15]]
grads:  [-0.04512732]
Stock Position:  -0.04512732314648454
Bond Position:  [8.94240646]


portfolio before change:  [4.38230901]
curr_Stock_Price:  101.06197427362565
curr_Factors:  [101.06197427]
mat_Sqrt:  [[0.15]]
grads:  [0.08306364]
Stock Position:  0.0830636355296082
Bond Position:  [-4.01226599]


portfolio before change:  [4.47699084]
curr_Stock_Price:  102.20486437680536
curr_Factors:  [102.20486438]
mat_Sqrt:  [[0.15]]
grads:  [0.00958511]
Stock Position:  0.00958511035874029
Bond Position:  [3.49734594]


portfolio before change:  [4.47608444]
curr_Stock_Price:  102.08749610118767
curr_Factors:  [102.0874961]
mat_Sqrt:  [[0.15]]
grads:  [-0.05808016]
Stock Position:  -0.058080160064790075
Bond Position:  [10.40534256]


portfolio before change:  [4.45639303]
curr_Stock_Price:  102.43773224444959
curr_Factors:  [102.43773224]
mat_Sqrt:  [[0.15]]
grads:  [-0.1975782]
Stock Position:  -0.19757820280135777
Bond Position:  [24.69585606]


portfolio before change:  [4.56297226]
curr_Stock_Price:  101.9061164303315
curr_Factors:  [101.90611643]
mat_Sqrt:  [[0.15]]
grads:  [-0.0163583]
Stock Position:  -0.016358296329266574
Bond Position:  [6.22998271]


portfolio before change:  [4.57270355]
curr_Stock_Price:  101.33503581787583
curr_Factors:  [101.33503582]
mat_Sqrt:  [[0.15]]
grads:  [0.06395488]
Stock Position:  0.0639548810076748
Bond Position:  [-1.9081666]


portfolio before change:  [4.61978508]
curr_Stock_Price:  102.07306848417383
curr_Factors:  [102.07306848]
mat_Sqrt:  [[0.15]]
grads:  [-0.07904977]
Stock Position:  -0.07904977037797807
Bond Position:  [12.68863771]


portfolio before change:  [4.56799033]
curr_Stock_Price:  102.73831788228163
curr_Factors:  [102.73831788]
mat_Sqrt:  [[0.15]]
grads:  [-0.00354193]
Stock Position:  -0.0035419276898375025
Bond Position:  [4.93188203]


portfolio before change:  [4.56863983]
curr_Stock_Price:  102.64197253660933
curr_Factors:  [102.64197254]
mat_Sqrt:  [[0.15]]
grads:  [0.01557829]
Stock Position:  0.015578293589298287
Bond Position:  [2.96965305]


portfolio before change:  [4.54485584]
curr_Stock_Price:  101.10331879769406
curr_Factors:  [101.1033188]
mat_Sqrt:  [[0.15]]
grads:  [-0.091369]
Stock Position:  -0.09136899553164674
Bond Position:  [13.78256453]


portfolio before change:  [4.51723737]
curr_Stock_Price:  101.41502094540252
curr_Factors:  [101.41502095]
mat_Sqrt:  [[0.15]]
grads:  [-0.03127401]
Stock Position:  -0.03127400890042274
Bond Position:  [7.68889164]


portfolio before change:  [4.52051048]
curr_Stock_Price:  101.32572810035961
curr_Factors:  [101.3257281]
mat_Sqrt:  [[0.15]]
grads:  [-0.00583546]
Stock Position:  -0.005835455934288095
Bond Position:  [5.11179231]


portfolio before change:  [4.5234141]
curr_Stock_Price:  100.88289807481644
curr_Factors:  [100.88289807]
mat_Sqrt:  [[0.15]]
grads:  [0.02510311]
Stock Position:  0.025103114513748706
Bond Position:  [1.99093915]


portfolio before change:  [4.53234926]
curr_Stock_Price:  101.23387929883782
curr_Factors:  [101.2338793]
mat_Sqrt:  [[0.15]]
grads:  [-0.01994201]
Stock Position:  -0.019942008174619084
Bond Position:  [6.5511561]


portfolio before change:  [4.53229574]
curr_Stock_Price:  101.25709521974788
curr_Factors:  [101.25709522]
mat_Sqrt:  [[0.15]]
grads:  [0.0251345]
Stock Position:  0.025134495104074502
Bond Position:  [1.98724978]


portfolio before change:  [4.51671167]
curr_Stock_Price:  100.63212599617722
curr_Factors:  [100.632126]
mat_Sqrt:  [[0.15]]
grads:  [0.00349158]
Stock Position:  0.003491576251931118
Bond Position:  [4.16534692]


portfolio before change:  [4.51788541]
curr_Stock_Price:  100.89372864719452
curr_Factors:  [100.89372865]
mat_Sqrt:  [[0.15]]
grads:  [0.00019739]
Stock Position:  0.00019738912717711353
Bond Position:  [4.49797009]


portfolio before change:  [4.51825683]
curr_Stock_Price:  101.35113300338242
curr_Factors:  [101.351133]
mat_Sqrt:  [[0.15]]
grads:  [0.0107772]
Stock Position:  0.010777198953298123
Bond Position:  [3.42597551]


portfolio before change:  [4.51193117]
curr_Stock_Price:  100.74431594757287
curr_Factors:  [100.74431595]
mat_Sqrt:  [[0.15]]
grads:  [0.0571027]
Stock Position:  0.05710269715082309
Bond Position:  [-1.24084099]


portfolio before change:  [4.50180881]
curr_Stock_Price:  100.56840811373829
curr_Factors:  [100.56840811]
mat_Sqrt:  [[0.15]]
grads:  [0.00662159]
Stock Position:  0.006621591725317385
Bond Position:  [3.83588587]


portfolio before change:  [4.50278966]
curr_Stock_Price:  100.68033010227762
curr_Factors:  [100.6803301]
mat_Sqrt:  [[0.15]]
grads:  [-0.13919248]
Stock Position:  -0.1391924807086154
Bond Position:  [18.51673456]


portfolio before change:  [4.38774987]
curr_Stock_Price:  101.51512461793693
curr_Factors:  [101.51512462]
mat_Sqrt:  [[0.15]]
grads:  [0.08932665]
Stock Position:  0.08932664890278408
Bond Position:  [-4.68025602]


portfolio before change:  [4.42214044]
curr_Stock_Price:  101.9033972338386
curr_Factors:  [101.90339723]
mat_Sqrt:  [[0.15]]
grads:  [0.02954521]
Stock Position:  0.02954520561984375
Bond Position:  [1.41138361]


portfolio before change:  [4.42081313]
curr_Stock_Price:  101.85548676860336
curr_Factors:  [101.85548677]
mat_Sqrt:  [[0.15]]
grads:  [0.06875331]
Stock Position:  0.06875330627555465
Bond Position:  [-2.58208835]


portfolio before change:  [4.37183411]
curr_Stock_Price:  101.1454462124897
curr_Factors:  [101.14544621]
mat_Sqrt:  [[0.15]]
grads:  [-0.087718]
Stock Position:  -0.0877180037729834
Bond Position:  [13.24411074]


portfolio before change:  [4.36229363]
curr_Stock_Price:  101.26364613329825
curr_Factors:  [101.26364613]
mat_Sqrt:  [[0.15]]
grads:  [-0.08393572]
Stock Position:  -0.0839357169100647
Bond Position:  [12.86193036]


portfolio before change:  [4.39561771]
curr_Stock_Price:  100.87620451884332
curr_Factors:  [100.87620452]
mat_Sqrt:  [[0.15]]
grads:  [-0.01531027]
Stock Position:  -0.015310267197603393
Bond Position:  [5.94005936]


portfolio before change:  [4.39964233]
curr_Stock_Price:  100.63758355640547
curr_Factors:  [100.63758356]
mat_Sqrt:  [[0.15]]
grads:  [-0.1335965]
Stock Position:  -0.13359650492954672
Bond Position:  [17.84447176]


portfolio before change:  [4.4093947]
curr_Stock_Price:  100.57293327945706
curr_Factors:  [100.57293328]
mat_Sqrt:  [[0.15]]
grads:  [0.24761799]
Stock Position:  0.24761799097305504
Bond Position:  [-20.49427299]


portfolio before change:  [4.34697118]
curr_Stock_Price:  100.32601024819527
curr_Factors:  [100.32601025]
mat_Sqrt:  [[0.15]]
grads:  [0.12551023]
Stock Position:  0.12551023247665952
Bond Position:  [-8.24496969]


portfolio before change:  [4.40948762]
curr_Stock_Price:  100.82821445535859
curr_Factors:  [100.82821446]
mat_Sqrt:  [[0.15]]
grads:  [0.01405225]
Stock Position:  0.014052254011550306
Bond Position:  [2.99262394]


portfolio before change:  [4.40655741]
curr_Stock_Price:  100.6063815014219
curr_Factors:  [100.6063815]
mat_Sqrt:  [[0.15]]
grads:  [0.04111988]
Stock Position:  0.04111987925413294
Bond Position:  [0.26963515]


portfolio before change:  [4.36543058]
curr_Stock_Price:  99.60580253198569
curr_Factors:  [99.60580253]
mat_Sqrt:  [[0.15]]
grads:  [-0.09741184]
Stock Position:  -0.09741184197569819
Bond Position:  [14.06821527]


portfolio before change:  [4.34234272]
curr_Stock_Price:  99.85184187507981
curr_Factors:  [99.85184188]
mat_Sqrt:  [[0.15]]
grads:  [-0.03994036]
Stock Position:  -0.0399403578677877
Bond Position:  [8.33046102]


portfolio before change:  [4.28299864]
curr_Stock_Price:  101.35069561038517
curr_Factors:  [101.35069561]
mat_Sqrt:  [[0.15]]
grads:  [-0.03276858]
Stock Position:  -0.03276857774081863
Bond Position:  [7.60411679]


portfolio before change:  [4.25175143]
curr_Stock_Price:  102.31877172564576
curr_Factors:  [102.31877173]
mat_Sqrt:  [[0.15]]
grads:  [0.01087908]
Stock Position:  0.010879081616001337
Bond Position:  [3.13861716]


portfolio before change:  [4.24986181]
curr_Stock_Price:  102.12704678003658
curr_Factors:  [102.12704678]
mat_Sqrt:  [[0.15]]
grads:  [0.05387794]
Stock Position:  0.05387793613124228
Bond Position:  [-1.25253269]


portfolio before change:  [4.21807968]
curr_Stock_Price:  101.53860833875262
curr_Factors:  [101.53860834]
mat_Sqrt:  [[0.15]]
grads:  [0.03223855]
Stock Position:  0.03223855147851645
Bond Position:  [0.94462202]


portfolio before change:  [4.23448361]
curr_Stock_Price:  102.04560683423975
curr_Factors:  [102.04560683]
mat_Sqrt:  [[0.15]]
grads:  [-0.08141004]
Stock Position:  -0.08141003965925722
Bond Position:  [12.54202051]


portfolio before change:  [4.28956976]
curr_Stock_Price:  101.37858538061609
curr_Factors:  [101.37858538]
mat_Sqrt:  [[0.15]]
grads:  [0.01660445]
Stock Position:  0.0166044522265775
Bond Position:  [2.60623388]


portfolio before change:  [4.28420556]
curr_Stock_Price:  101.04571758410663
curr_Factors:  [101.04571758]
mat_Sqrt:  [[0.15]]
grads:  [-0.05130939]
Stock Position:  -0.051309392525546234
Bond Position:  [9.46879995]


portfolio before change:  [4.3107865]
curr_Stock_Price:  100.53919981676405
curr_Factors:  [100.53919982]
mat_Sqrt:  [[0.15]]
grads:  [0.03617721]
Stock Position:  0.0361772131698284
Bond Position:  [0.67355844]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.3107865]
Stock Price:  101.28039349379885
PL:  [3.03039301]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-5.94558011e-02]
 [-1.16373357e-03]
 [ 4.57112943e-03]
 [ 2.31892933e-03]
 [ 1.32349136e-02]
 [ 9.09938286e-03]
 [ 4.53488337e-04]
 [ 1.48277516e-02]
 [ 1.72933240e-02]
 [-1.97881546e-02]
 [ 5.92437372e-03]
 [-7.74556337e-03]
 [-3.45586098e-03]
 [ 3.54913659e-03]
 [-1.85112959e-03]
 [ 1.34392024e-02]
 [ 3.17904153e-03]
 [ 5.99871316e-03]
 [ 1.68331915e-02]
 [ 1.12782998e-02]
 [ 2.06266799e-02]
 [-1.90375394e-02]
 [-8.37953837e-04]
 [ 9.33814633e-03]
 [ 1.40273389e-03]
 [ 1.54710293e-02]
 [ 1.44966915e-02]
 [ 7.11951351e-03]
 [ 7.63667425e-04]
 [-2.03795423e-03]
 [-3.47092322e-03]
 [-1.97571408e-02]
 [ 1.88938882e-02]
 [ 1.33707383e-02]
 [-2.18661270e-02]
 [ 7.83824801e-03]
 [-2.70897807e-03]
 [ 2.87003726e-03]
 [ 4.46465033e-03]
 [-1.50879916e-02]
 [ 3.44110432e-02]
 [ 4.30936652e-04]
 [ 5.04891169e-03]
 [-8.43967102e-03]
 [ 1.67996849e-03]
 [-3.12520655e-03]
 [-1.37103430e-02]
 [-1.30998485e-03]
 [-6.89558549e-03]
 [ 1.07797756e-02]
 [-3.02246213e-03]
 [ 3.57872974e-03]
 [ 1.57191638e-03]
 [-1.51599649e-03]
 [ 1.44750374e-03]
 [ 9.04932765e-03]
 [ 1.76795222e-02]
 [-2.73743429e-02]
 [ 1.39522745e-02]
 [ 6.21021567e-03]
 [ 6.36449573e-03]
 [-1.35614425e-02]
 [-1.26020604e-02]
 [-1.72645411e-03]
 [-1.12004964e-02]
 [-2.09917034e-02]
 [ 9.89986476e-03]
 [ 2.05665011e-03]
 [ 1.03845718e-02]
 [-1.73333806e-02]
 [-2.13684428e-03]
 [ 1.11450245e-03]
 [ 1.56637278e-03]
 [ 8.73749236e-03]
 [ 9.47980517e-03]
 [-3.79387725e-03]
 [-5.19043054e-03]
 [-9.82346707e-03]
 [-1.64528625e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.32437858]
curr_Stock_Price:  100.53074268158848
curr_Factors:  [100.53074268]
mat_Sqrt:  [[0.15]]
grads:  [-0.39637201]
Stock Position:  -0.39637200726240746
Bond Position:  [50.17195085]


portfolio before change:  [10.3164667]
curr_Stock_Price:  100.55861477704141
curr_Factors:  [100.55861478]
mat_Sqrt:  [[0.15]]
grads:  [-0.00775822]
Stock Position:  -0.007758223780033246
Bond Position:  [11.09662294]


portfolio before change:  [10.31265886]
curr_Stock_Price:  101.13882541348669
curr_Factors:  [101.13882541]
mat_Sqrt:  [[0.15]]
grads:  [0.0304742]
Stock Position:  0.030474196218024715
Bond Position:  [7.23053445]


portfolio before change:  [10.29754883]
curr_Stock_Price:  100.62816554682243
curr_Factors:  [100.62816555]
mat_Sqrt:  [[0.15]]
grads:  [0.01545953]
Stock Position:  0.01545952888989471
Bond Position:  [8.7418848]


portfolio before change:  [10.29251035]
curr_Stock_Price:  100.26690838732286
curr_Factors:  [100.26690839]
mat_Sqrt:  [[0.15]]
grads:  [0.08823276]
Stock Position:  0.08823275724297425
Bond Position:  [1.44568457]


portfolio before change:  [10.19550817]
curr_Stock_Price:  99.16649459083514
curr_Factors:  [99.16649459]
mat_Sqrt:  [[0.15]]
grads:  [0.06066255]
Stock Position:  0.06066255243003308
Bond Position:  [4.17981549]


portfolio before change:  [10.18408881]
curr_Stock_Price:  98.97394413957369
curr_Factors:  [98.97394414]
mat_Sqrt:  [[0.15]]
grads:  [0.00302326]
Stock Position:  0.003023255580401787
Bond Position:  [9.88486528]


portfolio before change:  [10.18434847]
curr_Stock_Price:  98.85547515839392
curr_Factors:  [98.85547516]
mat_Sqrt:  [[0.15]]
grads:  [0.09885168]
Stock Position:  0.09885167721156955
Bond Position:  [0.41231895]


portfolio before change:  [10.25525709]
curr_Stock_Price:  99.57253781306234
curr_Factors:  [99.57253781]
mat_Sqrt:  [[0.15]]
grads:  [0.11528883]
Stock Position:  0.11528882668933517
Bond Position:  [-1.22434396]


portfolio before change:  [10.20742068]
curr_Stock_Price:  99.15827492011066
curr_Factors:  [99.15827492]
mat_Sqrt:  [[0.15]]
grads:  [-0.13192103]
Stock Position:  -0.1319210308735128
Bond Position:  [23.28848253]


portfolio before change:  [10.23886755]
curr_Stock_Price:  98.93093220832976
curr_Factors:  [98.93093221]
mat_Sqrt:  [[0.15]]
grads:  [0.03949582]
Stock Position:  0.03949582477996374
Bond Position:  [6.33150878]


portfolio before change:  [10.21725239]
curr_Stock_Price:  98.37363556622198
curr_Factors:  [98.37363557]
mat_Sqrt:  [[0.15]]
grads:  [-0.05163709]
Stock Position:  -0.05163708914053061
Bond Position:  [15.29698058]


portfolio before change:  [10.19761081]
curr_Stock_Price:  98.77252848065757
curr_Factors:  [98.77252848]
mat_Sqrt:  [[0.15]]
grads:  [-0.02303907]
Stock Position:  -0.0230390732221534
Bond Position:  [12.47323832]


portfolio before change:  [10.20091843]
curr_Stock_Price:  98.66280085863518
curr_Factors:  [98.66280086]
mat_Sqrt:  [[0.15]]
grads:  [0.02366091]
Stock Position:  0.023660910613288143
Bond Position:  [7.86646672]


portfolio before change:  [10.20599502]
curr_Stock_Price:  98.85657697453314
curr_Factors:  [98.85657697]
mat_Sqrt:  [[0.15]]
grads:  [-0.01234086]
Stock Position:  -0.01234086392227142
Bond Position:  [11.42597059]


portfolio before change:  [10.20588555]
curr_Stock_Price:  98.92331604097569
curr_Factors:  [98.92331604]
mat_Sqrt:  [[0.15]]
grads:  [0.08959468]
Stock Position:  0.08959468269854172
Bond Position:  [1.34288244]


portfolio before change:  [10.26838039]
curr_Stock_Price:  99.61990773975431
curr_Factors:  [99.61990774]
mat_Sqrt:  [[0.15]]
grads:  [0.02119361]
Stock Position:  0.021193610220047995
Bond Position:  [8.1570749]


portfolio before change:  [10.25953546]
curr_Stock_Price:  99.17851224454414
curr_Factors:  [99.17851224]
mat_Sqrt:  [[0.15]]
grads:  [0.03999142]
Stock Position:  0.03999142109851768
Bond Position:  [6.29324582]


portfolio before change:  [10.24375987]
curr_Stock_Price:  98.7742020650435
curr_Factors:  [98.77420207]
mat_Sqrt:  [[0.15]]
grads:  [0.11222128]
Stock Position:  0.11222127683013071
Bond Position:  [-0.84080721]


portfolio before change:  [10.27751449]
curr_Stock_Price:  99.07545668903973
curr_Factors:  [99.07545669]
mat_Sqrt:  [[0.15]]
grads:  [0.07518867]
Stock Position:  0.07518866520530755
Bond Position:  [2.82816315]


portfolio before change:  [10.22570894]
curr_Stock_Price:  98.38409821557461
curr_Factors:  [98.38409822]
mat_Sqrt:  [[0.15]]
grads:  [0.1375112]
Stock Position:  0.1375111995031568
Bond Position:  [-3.30320642]


portfolio before change:  [10.2514001]
curr_Stock_Price:  98.57242919563036
curr_Factors:  [98.5724292]
mat_Sqrt:  [[0.15]]
grads:  [-0.12691693]
Stock Position:  -0.1269169294516641
Bond Position:  [22.76191014]


portfolio before change:  [10.30494074]
curr_Stock_Price:  98.16178280936221
curr_Factors:  [98.16178281]
mat_Sqrt:  [[0.15]]
grads:  [-0.00558636]
Stock Position:  -0.005586358915247245
Bond Position:  [10.85330769]


portfolio before change:  [10.30612093]
curr_Stock_Price:  98.07194958297121
curr_Factors:  [98.07194958]
mat_Sqrt:  [[0.15]]
grads:  [0.06225431]
Stock Position:  0.062254308895185094
Bond Position:  [4.20071949]


portfolio before change:  [10.30050465]
curr_Stock_Price:  97.97751703006179
curr_Factors:  [97.97751703]
mat_Sqrt:  [[0.15]]
grads:  [0.00935156]
Stock Position:  0.009351559256427333
Bond Position:  [9.3842621]


portfolio before change:  [10.29694328]
curr_Stock_Price:  97.53396389329785
curr_Factors:  [97.53396389]
mat_Sqrt:  [[0.15]]
grads:  [0.1031402]
Stock Position:  0.10314019550080253
Bond Position:  [0.23727117]


portfolio before change:  [10.32490422]
curr_Stock_Price:  97.80491655824677
curr_Factors:  [97.80491656]
mat_Sqrt:  [[0.15]]
grads:  [0.09664461]
Stock Position:  0.09664461025125314
Bond Position:  [0.87258617]


portfolio before change:  [10.23750202]
curr_Stock_Price:  96.89998528527632
curr_Factors:  [96.89998529]
mat_Sqrt:  [[0.15]]
grads:  [0.04746342]
Stock Position:  0.04746342339653637
Bond Position:  [5.638297]


portfolio before change:  [10.24582092]
curr_Stock_Price:  97.06783016375171
curr_Factors:  [97.06783016]
mat_Sqrt:  [[0.15]]
grads:  [0.00509112]
Stock Position:  0.005091116167624945
Bond Position:  [9.75163732]


portfolio before change:  [10.24828976]
curr_Stock_Price:  97.43304225845291
curr_Factors:  [97.43304226]
mat_Sqrt:  [[0.15]]
grads:  [-0.01358636]
Stock Position:  -0.013586361547153897
Bond Position:  [11.57205029]


portfolio before change:  [10.24844723]
curr_Stock_Price:  97.47468677224678
curr_Factors:  [97.47468677]
mat_Sqrt:  [[0.15]]
grads:  [-0.02313949]
Stock Position:  -0.0231394881318739
Bond Position:  [12.50396159]


portfolio before change:  [10.24353181]
curr_Stock_Price:  97.72088682585374
curr_Factors:  [97.72088683]
mat_Sqrt:  [[0.15]]
grads:  [-0.13171427]
Stock Position:  -0.13171427213225206
Bond Position:  [23.11476729]


portfolio before change:  [10.26491884]
curr_Stock_Price:  97.56948098843723
curr_Factors:  [97.56948099]
mat_Sqrt:  [[0.15]]
grads:  [0.12595925]
Stock Position:  0.12595925460477977
Bond Position:  [-2.02486026]


portfolio before change:  [10.32343883]
curr_Stock_Price:  98.03508036500716
curr_Factors:  [98.03508037]
mat_Sqrt:  [[0.15]]
grads:  [0.08913826]
Stock Position:  0.08913825504483183
Bond Position:  [1.58476284]


portfolio before change:  [10.27445591]
curr_Stock_Price:  97.48445288469667
curr_Factors:  [97.48445288]
mat_Sqrt:  [[0.15]]
grads:  [-0.14577418]
Stock Position:  -0.1457741796693504
Bond Position:  [24.48517206]


portfolio before change:  [10.30043326]
curr_Stock_Price:  97.31674844989698
curr_Factors:  [97.31674845]
mat_Sqrt:  [[0.15]]
grads:  [0.05225499]
Stock Position:  0.05225498671174609
Bond Position:  [5.21514786]


portfolio before change:  [10.31832659]
curr_Stock_Price:  97.65293401023904
curr_Factors:  [97.65293401]
mat_Sqrt:  [[0.15]]
grads:  [-0.01805985]
Stock Position:  -0.01805985378443309
Bond Position:  [12.0819243]


portfolio before change:  [10.32210393]
curr_Stock_Price:  97.48559027142524
curr_Factors:  [97.48559027]
mat_Sqrt:  [[0.15]]
grads:  [0.01913358]
Stock Position:  0.019133581736904832
Bond Position:  [8.45685542]


portfolio before change:  [10.32392557]
curr_Stock_Price:  97.55317103322194
curr_Factors:  [97.55317103]
mat_Sqrt:  [[0.15]]
grads:  [0.02976434]
Stock Position:  0.02976433551766421
Bond Position:  [7.42032025]


portfolio before change:  [10.33462042]
curr_Stock_Price:  97.89690671300299
curr_Factors:  [97.89690671]
mat_Sqrt:  [[0.15]]
grads:  [-0.10058661]
Stock Position:  -0.1005866106585014
Bond Position:  [20.18173846]


portfolio before change:  [10.35984998]
curr_Stock_Price:  97.65862286305337
curr_Factors:  [97.65862286]
mat_Sqrt:  [[0.15]]
grads:  [0.22940695]
Stock Position:  0.22940695445523135
Bond Position:  [-12.04371727]


portfolio before change:  [10.18647072]
curr_Stock_Price:  96.9061325826889
curr_Factors:  [96.90613258]
mat_Sqrt:  [[0.15]]
grads:  [0.00287291]
Stock Position:  0.002872911013347991
Bond Position:  [9.90806802]


portfolio before change:  [10.18927348]
curr_Stock_Price:  97.66615873316303
curr_Factors:  [97.66615873]
mat_Sqrt:  [[0.15]]
grads:  [0.03365941]
Stock Position:  0.0336594112923427
Bond Position:  [6.90188807]


portfolio before change:  [10.19019003]
curr_Stock_Price:  97.68057268334854
curr_Factors:  [97.68057268]
mat_Sqrt:  [[0.15]]
grads:  [-0.05626447]
Stock Position:  -0.056264473433704755
Bond Position:  [15.68613601]


portfolio before change:  [10.1693218]
curr_Stock_Price:  98.06889307217385
curr_Factors:  [98.06889307]
mat_Sqrt:  [[0.15]]
grads:  [0.01119979]
Stock Position:  0.011199789932578417
Bond Position:  [9.0709708]


portfolio before change:  [10.18074779]
curr_Stock_Price:  99.03846852416152
curr_Factors:  [99.03846852]
mat_Sqrt:  [[0.15]]
grads:  [-0.02083471]
Stock Position:  -0.020834710354887525
Bond Position:  [12.2441856]


portfolio before change:  [10.19244732]
curr_Stock_Price:  98.5136597915952
curr_Factors:  [98.51365979]
mat_Sqrt:  [[0.15]]
grads:  [-0.09140229]
Stock Position:  -0.09140228694972985
Bond Position:  [19.19682112]


portfolio before change:  [10.18957412]
curr_Stock_Price:  98.55822141258615
curr_Factors:  [98.55822141]
mat_Sqrt:  [[0.15]]
grads:  [-0.00873323]
Stock Position:  -0.00873323230785217
Bond Position:  [11.05030596]


portfolio before change:  [10.19205365]
curr_Stock_Price:  98.3533871780082
curr_Factors:  [98.35338718]
mat_Sqrt:  [[0.15]]
grads:  [-0.04597057]
Stock Position:  -0.04597056991749834
Bond Position:  [14.71341491]


portfolio before change:  [10.15229705]
curr_Stock_Price:  99.23821890771227
curr_Factors:  [99.23821891]
mat_Sqrt:  [[0.15]]
grads:  [0.07186517]
Stock Position:  0.07186517040846895
Bond Position:  [3.02052554]


portfolio before change:  [10.1785304]
curr_Stock_Price:  99.600627573118
curr_Factors:  [99.60062757]
mat_Sqrt:  [[0.15]]
grads:  [-0.02014975]
Stock Position:  -0.020149747530961368
Bond Position:  [12.1854579]


portfolio before change:  [10.17704248]
curr_Stock_Price:  99.71226826191159
curr_Factors:  [99.71226826]
mat_Sqrt:  [[0.15]]
grads:  [0.0238582]
Stock Position:  0.02385819826351073
Bond Position:  [7.79808742]


portfolio before change:  [10.17803501]
curr_Stock_Price:  99.73344056778717
curr_Factors:  [99.73344057]
mat_Sqrt:  [[0.15]]
grads:  [0.01047944]
Stock Position:  0.010479442517563825
Bond Position:  [9.13288415]


portfolio before change:  [10.17658809]
curr_Stock_Price:  99.54089772364517
curr_Factors:  [99.54089772]
mat_Sqrt:  [[0.15]]
grads:  [-0.01010664]
Stock Position:  -0.010106643249810794
Bond Position:  [11.18261243]


portfolio before change:  [10.18415771]
curr_Stock_Price:  98.86107964852825
curr_Factors:  [98.86107965]
mat_Sqrt:  [[0.15]]
grads:  [0.00965002]
Stock Position:  0.00965002493329271
Bond Position:  [9.23014582]


portfolio before change:  [10.18612965]
curr_Stock_Price:  99.0056434960064
curr_Factors:  [99.0056435]
mat_Sqrt:  [[0.15]]
grads:  [0.06032885]
Stock Position:  0.06032885102935949
Bond Position:  [4.21323294]


portfolio before change:  [10.21716937]
curr_Stock_Price:  99.51578718167522
curr_Factors:  [99.51578718]
mat_Sqrt:  [[0.15]]
grads:  [0.11786348]
Stock Position:  0.11786348130276438
Bond Position:  [-1.51210775]


portfolio before change:  [10.24664272]
curr_Stock_Price:  99.76665249779379
curr_Factors:  [99.7666525]
mat_Sqrt:  [[0.15]]
grads:  [-0.18249562]
Stock Position:  -0.1824956191003741
Bond Position:  [28.45361973]


portfolio before change:  [10.35885865]
curr_Stock_Price:  99.1615008811161
curr_Factors:  [99.16150088]
mat_Sqrt:  [[0.15]]
grads:  [0.09301516]
Stock Position:  0.09301516317003998
Bond Position:  [1.13533546]


portfolio before change:  [10.38885682]
curr_Stock_Price:  99.48324643735964
curr_Factors:  [99.48324644]
mat_Sqrt:  [[0.15]]
grads:  [0.04140144]
Stock Position:  0.041401437794873125
Bond Position:  [6.27010738]


portfolio before change:  [10.40344355]
curr_Stock_Price:  99.82610496280834
curr_Factors:  [99.82610496]
mat_Sqrt:  [[0.15]]
grads:  [0.04242997]
Stock Position:  0.042429971563654356
Bond Position:  [6.16782476]


portfolio before change:  [10.3670635]
curr_Stock_Price:  98.95960527965993
curr_Factors:  [98.95960528]
mat_Sqrt:  [[0.15]]
grads:  [-0.09040962]
Stock Position:  -0.09040961649225152
Bond Position:  [19.31396346]


portfolio before change:  [10.39036125]
curr_Stock_Price:  98.7152662668838
curr_Factors:  [98.71526627]
mat_Sqrt:  [[0.15]]
grads:  [-0.08401374]
Stock Position:  -0.08401373594148341
Bond Position:  [18.68379957]


portfolio before change:  [10.35540211]
curr_Stock_Price:  99.14527833497716
curr_Factors:  [99.14527833]
mat_Sqrt:  [[0.15]]
grads:  [-0.01150969]
Stock Position:  -0.011509694033614416
Bond Position:  [11.49653393]


portfolio before change:  [10.36596035]
curr_Stock_Price:  98.29037370525857
curr_Factors:  [98.29037371]
mat_Sqrt:  [[0.15]]
grads:  [-0.07466998]
Stock Position:  -0.07466997607125643
Bond Position:  [17.70530021]


portfolio before change:  [10.43561464]
curr_Stock_Price:  97.37236520778062
curr_Factors:  [97.37236521]
mat_Sqrt:  [[0.15]]
grads:  [-0.13994469]
Stock Position:  -0.13994468920581454
Bond Position:  [24.06236003]


portfolio before change:  [10.43745629]
curr_Stock_Price:  97.36995208171719
curr_Factors:  [97.36995208]
mat_Sqrt:  [[0.15]]
grads:  [0.0659991]
Stock Position:  0.06599909839177799
Bond Position:  [4.01112724]


portfolio before change:  [10.4096529]
curr_Stock_Price:  96.94488424117674
curr_Factors:  [96.94488424]
mat_Sqrt:  [[0.15]]
grads:  [0.013711]
Stock Position:  0.013711000727273437
Bond Position:  [9.08044152]


portfolio before change:  [10.41891237]
curr_Stock_Price:  97.57882239412449
curr_Factors:  [97.57882239]
mat_Sqrt:  [[0.15]]
grads:  [0.06923048]
Stock Position:  0.06923047842472828
Bond Position:  [3.66348381]


portfolio before change:  [10.43346318]
curr_Stock_Price:  97.7856941673872
curr_Factors:  [97.78569417]
mat_Sqrt:  [[0.15]]
grads:  [-0.11555587]
Stock Position:  -0.11555587067715321
Bond Position:  [21.73317421]


portfolio before change:  [10.36273535]
curr_Stock_Price:  98.40951528539954
curr_Factors:  [98.40951529]
mat_Sqrt:  [[0.15]]
grads:  [-0.01424563]
Stock Position:  -0.014245628512843132
Bond Position:  [11.76464075]


portfolio before change:  [10.36367795]
curr_Stock_Price:  98.39496483007794
curr_Factors:  [98.39496483]
mat_Sqrt:  [[0.15]]
grads:  [0.00743002]
Stock Position:  0.007430016352137492
Bond Position:  [9.63260175]


portfolio before change:  [10.36920551]
curr_Stock_Price:  99.05788459013674
curr_Factors:  [99.05788459]
mat_Sqrt:  [[0.15]]
grads:  [0.01044249]
Stock Position:  0.010442485207582933
Bond Position:  [9.33479501]


portfolio before change:  [10.36815738]
curr_Stock_Price:  98.90164135849287
curr_Factors:  [98.90164136]
mat_Sqrt:  [[0.15]]
grads:  [0.05824995]
Stock Position:  0.05824994904435418
Bond Position:  [4.60714181]


portfolio before change:  [10.37243661]
curr_Stock_Price:  98.97016106251913
curr_Factors:  [98.97016106]
mat_Sqrt:  [[0.15]]
grads:  [0.0631987]
Stock Position:  0.06319870111010525
Bond Position:  [4.11765098]


portfolio before change:  [10.36253285]
curr_Stock_Price:  98.8093806151487
curr_Factors:  [98.80938062]
mat_Sqrt:  [[0.15]]
grads:  [-0.02529251]
Stock Position:  -0.025292514982492558
Bond Position:  [12.86167059]


portfolio before change:  [10.35667589]
curr_Stock_Price:  99.07273309822467
curr_Factors:  [99.0727331]
mat_Sqrt:  [[0.15]]
grads:  [-0.03460287]
Stock Position:  -0.03460287029531827
Bond Position:  [13.78487682]


portfolio before change:  [10.37472239]
curr_Stock_Price:  98.57610030543555
curr_Factors:  [98.57610031]
mat_Sqrt:  [[0.15]]
grads:  [-0.06548978]
Stock Position:  -0.06548978044478129
Bond Position:  [16.83044955]


portfolio before change:  [10.42836197]
curr_Stock_Price:  97.77311015863393
curr_Factors:  [97.77311016]
mat_Sqrt:  [[0.15]]
grads:  [-0.10968575]
Stock Position:  -0.10968574979469163
Bond Position:  [21.15267887]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.42836197]
Stock Price:  98.03328999909978
PL:  [10.42836197]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-5.11280824e-02]
 [-1.95334407e-03]
 [ 3.29534600e-04]
 [ 2.19605369e-03]
 [ 1.37138424e-02]
 [ 1.20720498e-02]
 [ 9.63225369e-04]
 [ 9.97987618e-03]
 [ 1.73895990e-02]
 [-1.88560746e-02]
 [ 9.09200793e-03]
 [-5.15108152e-03]
 [-6.19895521e-03]
 [ 4.34394635e-03]
 [ 9.91247540e-04]
 [ 1.06682784e-02]
 [-2.86322465e-04]
 [ 4.94801738e-03]
 [ 7.30357299e-03]
 [ 1.45107405e-02]
 [-2.15162500e-02]
 [-2.84563729e-02]
 [ 9.89487031e-04]
 [ 6.61101301e-04]
 [-6.73400655e-03]
 [ 1.66249124e-02]
 [ 1.83451432e-02]
 [ 1.18242849e-02]
 [ 3.11347873e-04]
 [ 8.90535401e-03]
 [-3.42556488e-03]
 [-2.44142117e-02]
 [ 2.08273788e-02]
 [ 1.00799506e-02]
 [-2.68879254e-02]
 [ 8.11253241e-03]
 [-1.99213019e-03]
 [-4.54257302e-04]
 [ 6.31698110e-03]
 [-1.72537112e-02]
 [ 4.12772502e-02]
 [-2.51147647e-05]
 [ 5.72942332e-03]
 [-8.57058788e-03]
 [ 7.13897548e-04]
 [-6.02645986e-03]
 [-1.34508215e-02]
 [ 2.16888731e-04]
 [-2.72657448e-03]
 [-1.00778381e-03]
 [-3.71878748e-03]
 [ 2.98605618e-03]
 [ 3.41807138e-03]
 [ 1.28371568e-03]
 [ 3.70267704e-03]
 [ 8.90397687e-03]
 [ 1.13618013e-02]
 [ 1.96310112e-03]
 [ 1.36495144e-02]
 [ 1.26809766e-03]
 [ 3.33414076e-03]
 [-1.55895503e-02]
 [-1.27595096e-02]
 [-1.03316393e-03]
 [-9.60381153e-03]
 [-1.60703873e-02]
 [ 9.52589951e-03]
 [ 2.03169596e-03]
 [ 9.85391229e-03]
 [-1.78112546e-02]
 [ 5.59770727e-03]
 [ 1.65755860e-03]
 [-5.48596133e-04]
 [ 8.23373604e-03]
 [ 3.14284096e-04]
 [ 2.76009355e-03]
 [ 2.67203095e-03]
 [-1.11913006e-02]
 [-3.47935660e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.33966335]
curr_Stock_Price:  100.40318372486897
curr_Factors:  [100.40318372]
mat_Sqrt:  [[0.15]]
grads:  [-0.34085388]
Stock Position:  -0.340853882670474
Bond Position:  [42.56247836]


portfolio before change:  [8.34521301]
curr_Stock_Price:  100.39470671850611
curr_Factors:  [100.39470672]
mat_Sqrt:  [[0.15]]
grads:  [-0.01302229]
Stock Position:  -0.013022293785201762
Bond Position:  [9.65258238]


portfolio before change:  [8.34379199]
curr_Stock_Price:  100.55015767085504
curr_Factors:  [100.55015767]
mat_Sqrt:  [[0.15]]
grads:  [0.0021969]
Stock Position:  0.002196897336134701
Bond Position:  [8.12289361]


portfolio before change:  [8.34382141]
curr_Stock_Price:  100.33245496927957
curr_Factors:  [100.33245497]
mat_Sqrt:  [[0.15]]
grads:  [0.01464036]
Stock Position:  0.014640357925578142
Bond Position:  [6.87491836]


portfolio before change:  [8.34298446]
curr_Stock_Price:  100.24593721049447
curr_Factors:  [100.24593721]
mat_Sqrt:  [[0.15]]
grads:  [0.09142562]
Stock Position:  0.0914256160896492
Bond Position:  [-0.82206211]


portfolio before change:  [8.32682459]
curr_Stock_Price:  100.06974488369917
curr_Factors:  [100.06974488]
mat_Sqrt:  [[0.15]]
grads:  [0.08048033]
Stock Position:  0.08048033176815551
Bond Position:  [0.27317832]


portfolio before change:  [8.36955219]
curr_Stock_Price:  100.60044009289477
curr_Factors:  [100.60044009]
mat_Sqrt:  [[0.15]]
grads:  [0.0064215]
Stock Position:  0.006421502458423584
Bond Position:  [7.72354621]


portfolio before change:  [8.36591415]
curr_Stock_Price:  99.95872487894516
curr_Factors:  [99.95872488]
mat_Sqrt:  [[0.15]]
grads:  [0.06653251]
Stock Position:  0.06653250785966254
Bond Position:  [1.7154095]


portfolio before change:  [8.33604916]
curr_Stock_Price:  99.50823525730736
curr_Factors:  [99.50823526]
mat_Sqrt:  [[0.15]]
grads:  [0.11593066]
Stock Position:  0.1159306597128877
Bond Position:  [-3.2000062]


portfolio before change:  [8.35837012]
curr_Stock_Price:  99.70249766955135
curr_Factors:  [99.70249767]
mat_Sqrt:  [[0.15]]
grads:  [-0.12570716]
Stock Position:  -0.1257071642894126
Bond Position:  [20.89168838]


portfolio before change:  [8.3222871]
curr_Stock_Price:  99.99992536062615
curr_Factors:  [99.99992536]
mat_Sqrt:  [[0.15]]
grads:  [0.06061339]
Stock Position:  0.060613386222306345
Bond Position:  [2.260953]


portfolio before change:  [8.33630039]
curr_Stock_Price:  100.22878526937377
curr_Factors:  [100.22878527]
mat_Sqrt:  [[0.15]]
grads:  [-0.03434054]
Stock Position:  -0.034340543485278575
Bond Position:  [11.77821135]


portfolio before change:  [8.33545963]
curr_Stock_Price:  100.27470551591468
curr_Factors:  [100.27470552]
mat_Sqrt:  [[0.15]]
grads:  [-0.04132637]
Stock Position:  -0.04132636806986009
Bond Position:  [12.47944901]


portfolio before change:  [8.34566061]
curr_Stock_Price:  100.04673986097875
curr_Factors:  [100.04673986]
mat_Sqrt:  [[0.15]]
grads:  [0.02895964]
Stock Position:  0.028959642350173447
Bond Position:  [5.4483428]


portfolio before change:  [8.32926366]
curr_Stock_Price:  99.46878095878287
curr_Factors:  [99.46878096]
mat_Sqrt:  [[0.15]]
grads:  [0.00660832]
Stock Position:  0.0066083169338587485
Bond Position:  [7.67194243]


portfolio before change:  [8.32849714]
curr_Stock_Price:  99.28022629005764
curr_Factors:  [99.28022629]
mat_Sqrt:  [[0.15]]
grads:  [0.07112186]
Stock Position:  0.07112185631747962
Bond Position:  [1.26750315]


portfolio before change:  [8.31704394]
curr_Stock_Price:  99.11807607456426
curr_Factors:  [99.11807607]
mat_Sqrt:  [[0.15]]
grads:  [-0.00190882]
Stock Position:  -0.0019088164314143533
Bond Position:  [8.50624215]


portfolio before change:  [8.31811936]
curr_Stock_Price:  98.83320385374324
curr_Factors:  [98.83320385]
mat_Sqrt:  [[0.15]]
grads:  [0.03298678]
Stock Position:  0.032986782557012526
Bond Position:  [5.05792996]


portfolio before change:  [8.29569147]
curr_Stock_Price:  98.14371480260642
curr_Factors:  [98.1437148]
mat_Sqrt:  [[0.15]]
grads:  [0.04869049]
Stock Position:  0.04869048659660589
Bond Position:  [3.51702624]


portfolio before change:  [8.24797028]
curr_Stock_Price:  97.15910747065466
curr_Factors:  [97.15910747]
mat_Sqrt:  [[0.15]]
grads:  [0.09673827]
Stock Position:  0.096738270176548
Bond Position:  [-1.15103371]


portfolio before change:  [8.27085869]
curr_Stock_Price:  97.39645252911338
curr_Factors:  [97.39645253]
mat_Sqrt:  [[0.15]]
grads:  [-0.14344167]
Stock Position:  -0.1434416666516254
Bond Position:  [22.24156816]


portfolio before change:  [8.37073875]
curr_Stock_Price:  96.70983248416916
curr_Factors:  [96.70983248]
mat_Sqrt:  [[0.15]]
grads:  [-0.18970915]
Stock Position:  -0.18970915244178696
Bond Position:  [26.7174791]


portfolio before change:  [8.36118281]
curr_Stock_Price:  96.76900638695437
curr_Factors:  [96.76900639]
mat_Sqrt:  [[0.15]]
grads:  [0.00659658]
Stock Position:  0.0065965802067252145
Bond Position:  [7.7228383]


portfolio before change:  [8.3602562]
curr_Stock_Price:  96.55536438444511
curr_Factors:  [96.55536438]
mat_Sqrt:  [[0.15]]
grads:  [0.00440734]
Stock Position:  0.004407342003506012
Bond Position:  [7.93470369]


portfolio before change:  [8.35895082]
curr_Stock_Price:  96.14665745498287
curr_Factors:  [96.14665745]
mat_Sqrt:  [[0.15]]
grads:  [-0.04489338]
Stock Position:  -0.0448933769823112
Bond Position:  [12.67529896]


portfolio before change:  [8.37623922]
curr_Stock_Price:  95.77920538638357
curr_Factors:  [95.77920539]
mat_Sqrt:  [[0.15]]
grads:  [0.11083275]
Stock Position:  0.1108327494844398
Bond Position:  [-2.23923346]


portfolio before change:  [8.41353479]
curr_Stock_Price:  96.11697136488117
curr_Factors:  [96.11697136]
mat_Sqrt:  [[0.15]]
grads:  [0.12230095]
Stock Position:  0.12230095462511119
Bond Position:  [-3.34166256]


portfolio before change:  [8.49314479]
curr_Stock_Price:  96.7696142749177
curr_Factors:  [96.76961427]
mat_Sqrt:  [[0.15]]
grads:  [0.07882857]
Stock Position:  0.07882856615158226
Bond Position:  [0.86493484]


portfolio before change:  [8.46408403]
curr_Stock_Price:  96.40027076559126
curr_Factors:  [96.40027077]
mat_Sqrt:  [[0.15]]
grads:  [0.00207565]
Stock Position:  0.0020756524834203687
Bond Position:  [8.26399056]


portfolio before change:  [8.46344005]
curr_Stock_Price:  95.84117530819503
curr_Factors:  [95.84117531]
mat_Sqrt:  [[0.15]]
grads:  [0.05936903]
Stock Position:  0.0593690267548896
Bond Position:  [2.77344275]


portfolio before change:  [8.50307092]
curr_Stock_Price:  96.50578982520061
curr_Factors:  [96.50578983]
mat_Sqrt:  [[0.15]]
grads:  [-0.0228371]
Stock Position:  -0.02283709917570896
Bond Position:  [10.70698321]


portfolio before change:  [8.49590041]
curr_Stock_Price:  96.84907822294025
curr_Factors:  [96.84907822]
mat_Sqrt:  [[0.15]]
grads:  [-0.16276141]
Stock Position:  -0.16276141104987749
Bond Position:  [24.25919304]


portfolio before change:  [8.53156737]
curr_Stock_Price:  96.63925754984454
curr_Factors:  [96.63925755]
mat_Sqrt:  [[0.15]]
grads:  [0.13884919]
Stock Position:  0.13884919183328825
Bond Position:  [-4.88671544]


portfolio before change:  [8.56778045]
curr_Stock_Price:  96.90226603304835
curr_Factors:  [96.90226603]
mat_Sqrt:  [[0.15]]
grads:  [0.06719967]
Stock Position:  0.06719967048855341
Bond Position:  [2.05598011]


portfolio before change:  [8.55620889]
curr_Stock_Price:  96.72815705110834
curr_Factors:  [96.72815705]
mat_Sqrt:  [[0.15]]
grads:  [-0.17925284]
Stock Position:  -0.1792528361303923
Bond Position:  [25.89500538]


portfolio before change:  [8.59017789]
curr_Stock_Price:  96.54768287234464
curr_Factors:  [96.54768287]
mat_Sqrt:  [[0.15]]
grads:  [0.05408355]
Stock Position:  0.05408354937287155
Bond Position:  [3.36853651]


portfolio before change:  [8.59336114]
curr_Stock_Price:  96.60264802559504
curr_Factors:  [96.60264803]
mat_Sqrt:  [[0.15]]
grads:  [-0.01328087]
Stock Position:  -0.013280867921095658
Bond Position:  [9.87632815]


portfolio before change:  [8.58931272]
curr_Stock_Price:  96.95395858095036
curr_Factors:  [96.95395858]
mat_Sqrt:  [[0.15]]
grads:  [-0.00302838]
Stock Position:  -0.0030283820130038003
Bond Position:  [8.88292634]


portfolio before change:  [8.59130128]
curr_Stock_Price:  96.48065092730012
curr_Factors:  [96.48065093]
mat_Sqrt:  [[0.15]]
grads:  [0.04211321]
Stock Position:  0.042113207358432055
Bond Position:  [4.52819162]


portfolio before change:  [8.59397949]
curr_Stock_Price:  96.53752595492428
curr_Factors:  [96.53752595]
mat_Sqrt:  [[0.15]]
grads:  [-0.11502474]
Stock Position:  -0.11502474122212131
Bond Position:  [19.69818343]


portfolio before change:  [8.52570072]
curr_Stock_Price:  97.14183024976995
curr_Factors:  [97.14183025]
mat_Sqrt:  [[0.15]]
grads:  [0.27518167]
Stock Position:  0.2751816681572659
Bond Position:  [-18.20595018]


portfolio before change:  [8.5495836]
curr_Stock_Price:  97.23275488582821
curr_Factors:  [97.23275489]
mat_Sqrt:  [[0.15]]
grads:  [-0.00016743]
Stock Position:  -0.00016743176497196975
Bond Position:  [8.56586345]


portfolio before change:  [8.55011879]
curr_Stock_Price:  97.23394428479581
curr_Factors:  [97.23394428]
mat_Sqrt:  [[0.15]]
grads:  [0.03819616]
Stock Position:  0.03819615548722492
Bond Position:  [4.83615593]


portfolio before change:  [8.56020819]
curr_Stock_Price:  97.49017776416326
curr_Factors:  [97.49017776]
mat_Sqrt:  [[0.15]]
grads:  [-0.05713725]
Stock Position:  -0.05713725253537121
Bond Position:  [14.1305291]


portfolio before change:  [8.56417549]
curr_Stock_Price:  97.43620049792133
curr_Factors:  [97.4362005]
mat_Sqrt:  [[0.15]]
grads:  [0.00475932]
Stock Position:  0.004759316987295899
Bond Position:  [8.10044572]


portfolio before change:  [8.56454586]
curr_Stock_Price:  97.40764074888956
curr_Factors:  [97.40764075]
mat_Sqrt:  [[0.15]]
grads:  [-0.0401764]
Stock Position:  -0.04017639905693923
Bond Position:  [12.4780341]


portfolio before change:  [8.58736101]
curr_Stock_Price:  96.85917815357917
curr_Factors:  [96.85917815]
mat_Sqrt:  [[0.15]]
grads:  [-0.08967214]
Stock Position:  -0.08967214350816656
Bond Position:  [17.27293113]


portfolio before change:  [8.62536331]
curr_Stock_Price:  96.4474259339195
curr_Factors:  [96.44742593]
mat_Sqrt:  [[0.15]]
grads:  [0.00144592]
Stock Position:  0.0014459248756143578
Bond Position:  [8.48590757]


portfolio before change:  [8.62632787]
curr_Stock_Price:  96.74770497828365
curr_Factors:  [96.74770498]
mat_Sqrt:  [[0.15]]
grads:  [-0.01817716]
Stock Position:  -0.018177163211798245
Bond Position:  [10.3849267]


portfolio before change:  [8.62808992]
curr_Stock_Price:  96.68647618592993
curr_Factors:  [96.68647619]
mat_Sqrt:  [[0.15]]
grads:  [-0.00671856]
Stock Position:  -0.006718558701618935
Bond Position:  [9.27768368]


portfolio before change:  [8.62801573]
curr_Stock_Price:  96.78382703009157
curr_Factors:  [96.78382703]
mat_Sqrt:  [[0.15]]
grads:  [-0.02479192]
Stock Position:  -0.02479191651602105
Bond Position:  [11.02747229]


portfolio before change:  [8.61890777]
curr_Stock_Price:  97.17900417606495
curr_Factors:  [97.17900418]
mat_Sqrt:  [[0.15]]
grads:  [0.01990704]
Stock Position:  0.019907041186227183
Bond Position:  [6.68436133]


portfolio before change:  [8.61486155]
curr_Stock_Price:  96.95476167568646
curr_Factors:  [96.95476168]
mat_Sqrt:  [[0.15]]
grads:  [0.02278714]
Stock Position:  0.022787142501116606
Bond Position:  [6.40553958]


portfolio before change:  [8.61855027]
curr_Stock_Price:  97.09906930490118
curr_Factors:  [97.0990693]
mat_Sqrt:  [[0.15]]
grads:  [0.0085581]
Stock Position:  0.008558104544552272
Bond Position:  [7.78756628]


portfolio before change:  [8.62268305]
curr_Stock_Price:  97.52510334214833
curr_Factors:  [97.52510334]
mat_Sqrt:  [[0.15]]
grads:  [0.02468451]
Stock Position:  0.024684513598227497
Bond Position:  [6.21532331]


portfolio before change:  [8.6153841]
curr_Stock_Price:  97.21367622689127
curr_Factors:  [97.21367623]
mat_Sqrt:  [[0.15]]
grads:  [0.05935985]
Stock Position:  0.05935984578556877
Bond Position:  [2.84479527]


portfolio before change:  [8.60970656]
curr_Stock_Price:  97.11503483175137
curr_Factors:  [97.11503483]
mat_Sqrt:  [[0.15]]
grads:  [0.07574534]
Stock Position:  0.07574534190363853
Bond Position:  [1.25369505]


portfolio before change:  [8.62697674]
curr_Stock_Price:  97.34200355480883
curr_Factors:  [97.34200355]
mat_Sqrt:  [[0.15]]
grads:  [0.01308734]
Stock Position:  0.013087340782585746
Bond Position:  [7.35302877]


portfolio before change:  [8.62964529]
curr_Stock_Price:  97.51079029884345
curr_Factors:  [97.5107903]
mat_Sqrt:  [[0.15]]
grads:  [0.09099676]
Stock Position:  0.09099676258470855
Bond Position:  [-0.24352094]


portfolio before change:  [8.66973736]
curr_Stock_Price:  97.95154544261145
curr_Factors:  [97.95154544]
mat_Sqrt:  [[0.15]]
grads:  [0.00845398]
Stock Position:  0.00845398442927252
Bond Position:  [7.84165652]


portfolio before change:  [8.66876322]
curr_Stock_Price:  97.77834220249075
curr_Factors:  [97.7783422]
mat_Sqrt:  [[0.15]]
grads:  [0.02222761]
Stock Position:  0.022227605035936213
Bond Position:  [6.49538485]


portfolio before change:  [8.67188587]
curr_Stock_Price:  97.90056292215912
curr_Factors:  [97.90056292]
mat_Sqrt:  [[0.15]]
grads:  [-0.10393034]
Stock Position:  -0.10393033549866386
Bond Position:  [18.84672422]


portfolio before change:  [8.79627248]
curr_Stock_Price:  96.71507023248195
curr_Factors:  [96.71507023]
mat_Sqrt:  [[0.15]]
grads:  [-0.0850634]
Stock Position:  -0.08506339724983637
Bond Position:  [17.02318492]


portfolio before change:  [8.70917248]
curr_Stock_Price:  97.75152060577261
curr_Factors:  [97.75152061]
mat_Sqrt:  [[0.15]]
grads:  [-0.00688776]
Stock Position:  -0.0068877595619663305
Bond Position:  [9.38246145]


portfolio before change:  [8.71423952]
curr_Stock_Price:  97.10100096204172
curr_Factors:  [97.10100096]
mat_Sqrt:  [[0.15]]
grads:  [-0.06402541]
Stock Position:  -0.06402541020341417
Bond Position:  [14.93117094]


portfolio before change:  [8.71474189]
curr_Stock_Price:  97.1077304092036
curr_Factors:  [97.10773041]
mat_Sqrt:  [[0.15]]
grads:  [-0.10713592]
Stock Position:  -0.10713591509513454
Bond Position:  [19.11846745]


portfolio before change:  [8.73823891]
curr_Stock_Price:  96.89956424795734
curr_Factors:  [96.89956425]
mat_Sqrt:  [[0.15]]
grads:  [0.063506]
Stock Position:  0.06350599671131422
Bond Position:  [2.5845355]


portfolio before change:  [8.7364396]
curr_Stock_Price:  96.86868766347834
curr_Factors:  [96.86868766]
mat_Sqrt:  [[0.15]]
grads:  [0.01354464]
Stock Position:  0.013544639711382997
Bond Position:  [7.42438812]


portfolio before change:  [8.7515144]
curr_Stock_Price:  97.94739953486987
curr_Factors:  [97.94739953]
mat_Sqrt:  [[0.15]]
grads:  [0.06569275]
Stock Position:  0.06569274860742023
Bond Position:  [2.3170805]


portfolio before change:  [8.69882122]
curr_Stock_Price:  97.14307936479635
curr_Factors:  [97.14307936]
mat_Sqrt:  [[0.15]]
grads:  [-0.1187417]
Stock Position:  -0.11874169751154821
Bond Position:  [20.23375536]


portfolio before change:  [8.68998247]
curr_Stock_Price:  97.22816657350648
curr_Factors:  [97.22816657]
mat_Sqrt:  [[0.15]]
grads:  [0.03731805]
Stock Position:  0.03731804846881976
Bond Position:  [5.06161703]


portfolio before change:  [8.6868345]
curr_Stock_Price:  97.13533393705441
curr_Factors:  [97.13533394]
mat_Sqrt:  [[0.15]]
grads:  [0.01105039]
Stock Position:  0.011050390653443716
Bond Position:  [7.61345111]


portfolio before change:  [8.68941746]
curr_Stock_Price:  97.32601610708498
curr_Factors:  [97.32601611]
mat_Sqrt:  [[0.15]]
grads:  [-0.00365731]
Stock Position:  -0.003657307551893201
Bond Position:  [9.04536864]


portfolio before change:  [8.6893343]
curr_Stock_Price:  97.50333781990952
curr_Factors:  [97.50333782]
mat_Sqrt:  [[0.15]]
grads:  [0.05489157]
Stock Position:  0.05489157362521843
Bond Position:  [3.33722265]


portfolio before change:  [8.68537553]
curr_Stock_Price:  97.42741822247453
curr_Factors:  [97.42741822]
mat_Sqrt:  [[0.15]]
grads:  [0.00209523]
Stock Position:  0.0020952273054071985
Bond Position:  [8.48124295]


portfolio before change:  [8.68422329]
curr_Stock_Price:  96.62447961887038
curr_Factors:  [96.62447962]
mat_Sqrt:  [[0.15]]
grads:  [0.01840062]
Stock Position:  0.018400623685498916
Bond Position:  [6.9062726]


portfolio before change:  [8.69582426]
curr_Stock_Price:  97.2314869458199
curr_Factors:  [97.23148695]
mat_Sqrt:  [[0.15]]
grads:  [0.01781354]
Stock Position:  0.017813539672745227
Bond Position:  [6.96378731]


portfolio before change:  [8.68950519]
curr_Stock_Price:  96.85231952552934
curr_Factors:  [96.85231953]
mat_Sqrt:  [[0.15]]
grads:  [-0.07460867]
Stock Position:  -0.07460867072466094
Bond Position:  [15.91552801]


portfolio before change:  [8.71838479]
curr_Stock_Price:  96.47857144738923
curr_Factors:  [96.47857145]
mat_Sqrt:  [[0.15]]
grads:  [-0.23195711]
Stock Position:  -0.2319571069884911
Bond Position:  [31.09727511]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.71838479]
Stock Price:  96.88536582082169
PL:  [8.71838479]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.61364056e-02]
 [ 1.09504096e-03]
 [-1.99248740e-04]
 [-2.30240972e-04]
 [-1.75101254e-02]
 [ 4.21655174e-03]
 [ 4.27133199e-04]
 [ 1.58933065e-02]
 [ 1.75629554e-02]
 [-1.29542250e-02]
 [ 5.91151336e-03]
 [-5.32001027e-03]
 [-9.78746859e-03]
 [ 4.35461622e-03]
 [ 4.60025246e-03]
 [ 1.04029796e-02]
 [-2.49815698e-03]
 [ 6.49304367e-04]
 [-1.38823822e-02]
 [ 1.43748062e-02]
 [-3.40613684e-02]
 [-3.01338749e-02]
 [ 1.30305880e-03]
 [-1.34577571e-03]
 [-8.22351457e-03]
 [ 1.64911173e-02]
 [ 1.97535211e-02]
 [ 8.50389685e-02]
 [-1.18834488e-03]
 [ 2.35505995e-02]
 [-3.59571429e-03]
 [-9.05601097e-02]
 [ 2.87877406e-02]
 [ 1.00470486e-02]
 [-4.53849841e-02]
 [ 9.06670816e-03]
 [ 2.07195820e-03]
 [-2.05599683e-02]
 [ 1.16754491e-02]
 [-2.37499413e-02]
 [ 6.25495818e-02]
 [ 4.00501988e-03]
 [ 1.07503330e-02]
 [-1.00086938e-02]
 [-4.70788022e-03]
 [-1.98150961e-02]
 [-1.29450304e-02]
 [ 2.18030094e-03]
 [-2.96032754e-03]
 [-1.48288586e-02]
 [-4.45310954e-03]
 [ 2.81492778e-03]
 [ 4.08245334e-03]
 [-3.01154241e-03]
 [ 2.17666613e-02]
 [ 8.99063788e-03]
 [ 1.68165572e-03]
 [ 1.30315837e-02]
 [ 1.31046329e-02]
 [-6.71398144e-03]
 [-5.84768034e-03]
 [-2.30646822e-02]
 [-1.27747904e-02]
 [-2.18839902e-03]
 [-7.89461928e-03]
 [-1.14571706e-02]
 [ 9.69523624e-03]
 [ 2.07511829e-03]
 [ 1.21656463e-02]
 [-1.84834549e-02]
 [ 1.16836621e-02]
 [-6.41737447e-03]
 [-5.04464348e-03]
 [ 7.85571274e-03]
 [-9.40921258e-03]
 [ 3.86394137e-03]
 [ 2.15648474e-02]
 [-1.59345245e-02]
 [-5.50460868e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.21898818]
curr_Stock_Price:  99.66030156658616
curr_Factors:  [99.66030157]
mat_Sqrt:  [[0.15]]
grads:  [-0.24090937]
Stock Position:  -0.2409093703475059
Bond Position:  [20.79011231]


portfolio before change:  [-3.19800819]
curr_Stock_Price:  99.57860871657186
curr_Factors:  [99.57860872]
mat_Sqrt:  [[0.15]]
grads:  [0.00730027]
Stock Position:  0.007300273084429966
Bond Position:  [-3.92495923]


portfolio before change:  [-3.19874533]
curr_Stock_Price:  99.51123758890769
curr_Factors:  [99.51123759]
mat_Sqrt:  [[0.15]]
grads:  [-0.00132832]
Stock Position:  -0.0013283249301628635
Bond Position:  [-3.06656208]


portfolio before change:  [-3.1982976]
curr_Stock_Price:  99.02988030196985
curr_Factors:  [99.0298803]
mat_Sqrt:  [[0.15]]
grads:  [-0.00153494]
Stock Position:  -0.0015349398142885738
Bond Position:  [-3.04629269]


portfolio before change:  [-3.19773813]
curr_Stock_Price:  98.54134890979195
curr_Factors:  [98.54134891]
mat_Sqrt:  [[0.15]]
grads:  [-0.11673417]
Stock Position:  -0.11673416910588019
Bond Position:  [8.30540435]


portfolio before change:  [-3.16966716]
curr_Stock_Price:  98.3053266092633
curr_Factors:  [98.30532661]
mat_Sqrt:  [[0.15]]
grads:  [0.02811034]
Stock Position:  0.02811034494107794
Bond Position:  [-5.9330638]


portfolio before change:  [-3.15558992]
curr_Stock_Price:  98.81930369976209
curr_Factors:  [98.8193037]
mat_Sqrt:  [[0.15]]
grads:  [0.00284755]
Stock Position:  0.0028475546614594683
Bond Position:  [-3.43698329]


portfolio before change:  [-3.15485787]
curr_Stock_Price:  99.15182397484394
curr_Factors:  [99.15182397]
mat_Sqrt:  [[0.15]]
grads:  [0.10595538]
Stock Position:  0.10595537670461105
Bond Position:  [-13.66052673]


portfolio before change:  [-3.13265803]
curr_Stock_Price:  99.3694027861273
curr_Factors:  [99.36940279]
mat_Sqrt:  [[0.15]]
grads:  [0.11708637]
Stock Position:  0.11708636922918887
Bond Position:  [-14.76746062]


portfolio before change:  [-3.20180719]
curr_Stock_Price:  98.78670336745381
curr_Factors:  [98.78670337]
mat_Sqrt:  [[0.15]]
grads:  [-0.0863615]
Stock Position:  -0.08636149993658017
Bond Position:  [5.32956069]


portfolio before change:  [-3.23513368]
curr_Stock_Price:  99.1764557515188
curr_Factors:  [99.17645575]
mat_Sqrt:  [[0.15]]
grads:  [0.03941009]
Stock Position:  0.03941008905473967
Bond Position:  [-7.14368663]


portfolio before change:  [-3.22027467]
curr_Stock_Price:  99.56482085432663
curr_Factors:  [99.56482085]
mat_Sqrt:  [[0.15]]
grads:  [-0.03546674]
Stock Position:  -0.03546673510651663
Bond Position:  [0.31096446]


portfolio before change:  [-3.23331945]
curr_Stock_Price:  99.93317215174068
curr_Factors:  [99.93317215]
mat_Sqrt:  [[0.15]]
grads:  [-0.06524979]
Stock Position:  -0.06524979057646163
Bond Position:  [3.2872991]


portfolio before change:  [-3.21634401]
curr_Stock_Price:  99.67616020857757
curr_Factors:  [99.67616021]
mat_Sqrt:  [[0.15]]
grads:  [0.02903077]
Stock Position:  0.029030774811743747
Bond Position:  [-6.11002017]


portfolio before change:  [-3.21158634]
curr_Stock_Price:  99.85319865667161
curr_Factors:  [99.85319866]
mat_Sqrt:  [[0.15]]
grads:  [0.03066835]
Stock Position:  0.030668349702430618
Bond Position:  [-6.27391915]


portfolio before change:  [-3.22897465]
curr_Stock_Price:  99.29900585030623
curr_Factors:  [99.29900585]
mat_Sqrt:  [[0.15]]
grads:  [0.0693532]
Stock Position:  0.06935319742700122
Bond Position:  [-10.11567821]


portfolio before change:  [-3.29748573]
curr_Stock_Price:  98.32026465395676
curr_Factors:  [98.32026465]
mat_Sqrt:  [[0.15]]
grads:  [-0.01665438]
Stock Position:  -0.016654379876660505
Bond Position:  [-1.66002269]


portfolio before change:  [-3.292199]
curr_Stock_Price:  97.99659722625522
curr_Factors:  [97.99659723]
mat_Sqrt:  [[0.15]]
grads:  [0.0043287]
Stock Position:  0.004328695777193354
Bond Position:  [-3.71639646]


portfolio before change:  [-3.29616948]
curr_Stock_Price:  97.13301316091875
curr_Factors:  [97.13301316]
mat_Sqrt:  [[0.15]]
grads:  [-0.09254921]
Stock Position:  -0.09254921473254434
Bond Position:  [5.69341461]


portfolio before change:  [-3.33719164]
curr_Stock_Price:  97.58010516644586
curr_Factors:  [97.58010517]
mat_Sqrt:  [[0.15]]
grads:  [0.09583204]
Stock Position:  0.09583204164096872
Bond Position:  [-12.68849234]


portfolio before change:  [-3.38376995]
curr_Stock_Price:  97.10233953283506
curr_Factors:  [97.10233953]
mat_Sqrt:  [[0.15]]
grads:  [-0.22707579]
Stock Position:  -0.22707578937519957
Bond Position:  [18.66582044]


portfolio before change:  [-3.21835114]
curr_Stock_Price:  96.37900321404251
curr_Factors:  [96.37900321]
mat_Sqrt:  [[0.15]]
grads:  [-0.2008925]
Stock Position:  -0.2008924990140811
Bond Position:  [16.14346767]


portfolio before change:  [-3.21191288]
curr_Stock_Price:  96.35197752584433
curr_Factors:  [96.35197753]
mat_Sqrt:  [[0.15]]
grads:  [0.00868706]
Stock Position:  0.008687058633536863
Bond Position:  [-4.04892816]


portfolio before change:  [-3.21355377]
curr_Stock_Price:  96.19222057113565
curr_Factors:  [96.19222057]
mat_Sqrt:  [[0.15]]
grads:  [-0.00897184]
Stock Position:  -0.00897183809629313
Bond Position:  [-2.35053274]


portfolio before change:  [-3.2096992]
curr_Stock_Price:  95.74621594151851
curr_Factors:  [95.74621594]
mat_Sqrt:  [[0.15]]
grads:  [-0.05482343]
Stock Position:  -0.054823430435281796
Bond Position:  [2.03943681]


portfolio before change:  [-3.20171236]
curr_Stock_Price:  95.60285806890879
curr_Factors:  [95.60285807]
mat_Sqrt:  [[0.15]]
grads:  [0.10994078]
Stock Position:  0.10994078221647759
Bond Position:  [-13.71236536]


portfolio before change:  [-3.21374167]
curr_Stock_Price:  95.50123735435989
curr_Factors:  [95.50123735]
mat_Sqrt:  [[0.15]]
grads:  [0.13169014]
Stock Position:  0.13169014068507748
Bond Position:  [-15.79031305]


portfolio before change:  [-3.2990938]
curr_Stock_Price:  94.8606032123367
curr_Factors:  [94.86060321]
mat_Sqrt:  [[0.15]]
grads:  [0.56692646]
Stock Position:  0.5669264565565758
Bond Position:  [-57.07807944]


portfolio before change:  [-3.6845803]
curr_Stock_Price:  94.18693732172648
curr_Factors:  [94.18693732]
mat_Sqrt:  [[0.15]]
grads:  [-0.0079223]
Stock Position:  -0.00792229921855756
Bond Position:  [-2.9384032]


portfolio before change:  [-3.68086043]
curr_Stock_Price:  93.69420997095142
curr_Factors:  [93.69420997]
mat_Sqrt:  [[0.15]]
grads:  [0.157004]
Stock Position:  0.15700399637349405
Bond Position:  [-18.39122583]


portfolio before change:  [-3.74994911]
curr_Stock_Price:  93.26148727722752
curr_Factors:  [93.26148728]
mat_Sqrt:  [[0.15]]
grads:  [-0.02397143]
Stock Position:  -0.023971428618013768
Bond Position:  [-1.51433802]


portfolio before change:  [-3.73663146]
curr_Stock_Price:  92.7019755562794
curr_Factors:  [92.70197556]
mat_Sqrt:  [[0.15]]
grads:  [-0.60373406]
Stock Position:  -0.603734064526636
Bond Position:  [52.23070903]


portfolio before change:  [-3.79277512]
curr_Stock_Price:  92.80037680513901
curr_Factors:  [92.80037681]
mat_Sqrt:  [[0.15]]
grads:  [0.19191827]
Stock Position:  0.1919182706148603
Bond Position:  [-21.60286295]


portfolio before change:  [-3.7246843]
curr_Stock_Price:  93.16220294878904
curr_Factors:  [93.16220295]
mat_Sqrt:  [[0.15]]
grads:  [0.06698032]
Stock Position:  0.06698032428660038
Bond Position:  [-9.96471886]


portfolio before change:  [-3.69620865]
curr_Stock_Price:  93.59663595460995
curr_Factors:  [93.59663595]
mat_Sqrt:  [[0.15]]
grads:  [-0.30256656]
Stock Position:  -0.30256656080571503
Bond Position:  [24.6230036]


portfolio before change:  [-3.6491618]
curr_Stock_Price:  93.44622982267614
curr_Factors:  [93.44622982]
mat_Sqrt:  [[0.15]]
grads:  [0.06044472]
Stock Position:  0.060444721074433994
Bond Position:  [-9.29749309]


portfolio before change:  [-3.6066135]
curr_Stock_Price:  94.15976447133835
curr_Factors:  [94.15976447]
mat_Sqrt:  [[0.15]]
grads:  [0.01381305]
Stock Position:  0.013813054650855817
Bond Position:  [-4.90724748]


portfolio before change:  [-3.61221699]
curr_Stock_Price:  93.77630321899908
curr_Factors:  [93.77630322]
mat_Sqrt:  [[0.15]]
grads:  [-0.13706646]
Stock Position:  -0.13706645513611976
Bond Position:  [9.24136847]


portfolio before change:  [-3.59490843]
curr_Stock_Price:  93.6542386669599
curr_Factors:  [93.65423867]
mat_Sqrt:  [[0.15]]
grads:  [0.07783633]
Stock Position:  0.07783632753925858
Bond Position:  [-10.88461043]


portfolio before change:  [-3.62551857]
curr_Stock_Price:  93.2697160489327
curr_Factors:  [93.26971605]
mat_Sqrt:  [[0.15]]
grads:  [-0.15833294]
Stock Position:  -0.15833294228108744
Bond Position:  [11.14215]


portfolio before change:  [-3.68117778]
curr_Stock_Price:  93.6256471473664
curr_Factors:  [93.62564715]
mat_Sqrt:  [[0.15]]
grads:  [0.41699721]
Stock Position:  0.4169972121339507
Bond Position:  [-42.72281162]


portfolio before change:  [-3.47244028]
curr_Stock_Price:  94.13262358430394
curr_Factors:  [94.13262358]
mat_Sqrt:  [[0.15]]
grads:  [0.02670013]
Stock Position:  0.02670013256244924
Bond Position:  [-5.98579381]


portfolio before change:  [-3.45829336]
curr_Stock_Price:  94.67648009709075
curr_Factors:  [94.6764801]
mat_Sqrt:  [[0.15]]
grads:  [0.07166889]
Stock Position:  0.07166888644896846
Bond Position:  [-10.24365126]


portfolio before change:  [-3.47158301]
curr_Stock_Price:  94.49998229304789
curr_Factors:  [94.49998229]
mat_Sqrt:  [[0.15]]
grads:  [-0.06672463]
Stock Position:  -0.0667246252850107
Bond Position:  [2.8338929]


portfolio before change:  [-3.44792041]
curr_Stock_Price:  94.14800613915722
curr_Factors:  [94.14800614]
mat_Sqrt:  [[0.15]]
grads:  [-0.03138587]
Stock Position:  -0.03138586810025887
Bond Position:  [-0.49300351]


portfolio before change:  [-3.44646142]
curr_Stock_Price:  94.10053877192604
curr_Factors:  [94.10053877]
mat_Sqrt:  [[0.15]]
grads:  [-0.13210064]
Stock Position:  -0.13210064058799345
Bond Position:  [8.98428003]


portfolio before change:  [-3.39345845]
curr_Stock_Price:  93.70355784718562
curr_Factors:  [93.70355785]
mat_Sqrt:  [[0.15]]
grads:  [-0.0863002]
Stock Position:  -0.08630020298375381
Bond Position:  [4.69317761]


portfolio before change:  [-3.43157778]
curr_Stock_Price:  94.14866298601169
curr_Factors:  [94.14866299]
mat_Sqrt:  [[0.15]]
grads:  [0.01453534]
Stock Position:  0.014535339582970482
Bond Position:  [-4.80006057]


portfolio before change:  [-3.43181499]
curr_Stock_Price:  94.15298347719067
curr_Factors:  [94.15298348]
mat_Sqrt:  [[0.15]]
grads:  [-0.01973552]
Stock Position:  -0.019735516904383712
Bond Position:  [-1.5736572]


portfolio before change:  [-3.42857097]
curr_Stock_Price:  93.98362498457477
curr_Factors:  [93.98362498]
mat_Sqrt:  [[0.15]]
grads:  [-0.09885906]
Stock Position:  -0.09885905737752279
Bond Position:  [5.8625616]


portfolio before change:  [-3.43678232]
curr_Stock_Price:  94.07039265624198
curr_Factors:  [94.07039266]
mat_Sqrt:  [[0.15]]
grads:  [-0.0296874]
Stock Position:  -0.02968739692674929
Bond Position:  [-0.64407723]


portfolio before change:  [-3.41620734]
curr_Stock_Price:  93.37598237604712
curr_Factors:  [93.37598238]
mat_Sqrt:  [[0.15]]
grads:  [0.01876619]
Stock Position:  0.018766185194253774
Bond Position:  [-5.16851832]


portfolio before change:  [-3.40443353]
curr_Stock_Price:  94.02059133639457
curr_Factors:  [94.02059134]
mat_Sqrt:  [[0.15]]
grads:  [0.02721636]
Stock Position:  0.027216355603937606
Bond Position:  [-5.96333138]


portfolio before change:  [-3.43120958]
curr_Stock_Price:  93.05046400473641
curr_Factors:  [93.050464]
mat_Sqrt:  [[0.15]]
grads:  [-0.02007695]
Stock Position:  -0.020076949400373897
Bond Position:  [-1.56304013]


portfolio before change:  [-3.44112305]
curr_Stock_Price:  93.5393713177587
curr_Factors:  [93.53937132]
mat_Sqrt:  [[0.15]]
grads:  [0.14511108]
Stock Position:  0.14511107565611703
Bond Position:  [-17.01472183]


portfolio before change:  [-3.36607417]
curr_Stock_Price:  94.06388210593211
curr_Factors:  [94.06388211]
mat_Sqrt:  [[0.15]]
grads:  [0.05993759]
Stock Position:  0.059937585897669135
Bond Position:  [-9.00403619]


portfolio before change:  [-3.34382668]
curr_Stock_Price:  94.44444901154195
curr_Factors:  [94.44444901]
mat_Sqrt:  [[0.15]]
grads:  [0.01121104]
Stock Position:  0.01121103810604207
Bond Position:  [-4.402647]


portfolio before change:  [-3.3426802]
curr_Stock_Price:  94.5712577423461
curr_Factors:  [94.57125774]
mat_Sqrt:  [[0.15]]
grads:  [0.08687722]
Stock Position:  0.08687722460048962
Bond Position:  [-11.5587686]


portfolio before change:  [-3.32729013]
curr_Stock_Price:  94.75672078409205
curr_Factors:  [94.75672078]
mat_Sqrt:  [[0.15]]
grads:  [0.08736422]
Stock Position:  0.0873642193216019
Bond Position:  [-11.60563707]


portfolio before change:  [-3.35190734]
curr_Stock_Price:  94.48324690991087
curr_Factors:  [94.48324691]
mat_Sqrt:  [[0.15]]
grads:  [-0.04475988]
Stock Position:  -0.044759876237121014
Bond Position:  [0.8771511]


portfolio before change:  [-3.36819913]
curr_Stock_Price:  94.84845374482806
curr_Factors:  [94.84845374]
mat_Sqrt:  [[0.15]]
grads:  [-0.03898454]
Stock Position:  -0.03898453556678154
Bond Position:  [0.32942379]


portfolio before change:  [-3.40760535]
curr_Stock_Price:  95.85979864163409
curr_Factors:  [95.85979864]
mat_Sqrt:  [[0.15]]
grads:  [-0.15376455]
Stock Position:  -0.15376454819929627
Bond Position:  [11.33223328]


portfolio before change:  [-3.5085582]
curr_Stock_Price:  96.52094673383627
curr_Factors:  [96.52094673]
mat_Sqrt:  [[0.15]]
grads:  [-0.08516527]
Stock Position:  -0.08516526922741552
Bond Position:  [4.71167422]


portfolio before change:  [-3.46556995]
curr_Stock_Price:  96.01964194615185
curr_Factors:  [96.01964195]
mat_Sqrt:  [[0.15]]
grads:  [-0.01458933]
Stock Position:  -0.014589326776385173
Bond Position:  [-2.06470802]


portfolio before change:  [-3.46290047]
curr_Stock_Price:  95.82782132592561
curr_Factors:  [95.82782133]
mat_Sqrt:  [[0.15]]
grads:  [-0.0526308]
Stock Position:  -0.052630795205277386
Bond Position:  [1.58059397]


portfolio before change:  [-3.51710833]
curr_Stock_Price:  96.85966309693659
curr_Factors:  [96.8596631]
mat_Sqrt:  [[0.15]]
grads:  [-0.07638114]
Stock Position:  -0.07638113735548795
Bond Position:  [3.8811429]


portfolio before change:  [-3.53861577]
curr_Stock_Price:  97.14441947021126
curr_Factors:  [97.14441947]
mat_Sqrt:  [[0.15]]
grads:  [0.06463491]
Stock Position:  0.06463490828659582
Bond Position:  [-9.81753641]


portfolio before change:  [-3.54848144]
curr_Stock_Price:  97.00127615085117
curr_Factors:  [97.00127615]
mat_Sqrt:  [[0.15]]
grads:  [0.01383412]
Stock Position:  0.013834121944325643
Bond Position:  [-4.89040892]


portfolio before change:  [-3.54974294]
curr_Stock_Price:  96.93218325220307
curr_Factors:  [96.93218325]
mat_Sqrt:  [[0.15]]
grads:  [0.08110431]
Stock Position:  0.08110430837862526
Bond Position:  [-11.41136062]


portfolio before change:  [-3.59677956]
curr_Stock_Price:  96.36102503426962
curr_Factors:  [96.36102503]
mat_Sqrt:  [[0.15]]
grads:  [-0.12322303]
Stock Position:  -0.12322303262039937
Bond Position:  [8.27711817]


portfolio before change:  [-3.57788157]
curr_Stock_Price:  96.2118592998291
curr_Factors:  [96.2118593]
mat_Sqrt:  [[0.15]]
grads:  [0.07789108]
Stock Position:  0.07789108068106063
Bond Position:  [-11.07192727]


portfolio before change:  [-3.62154168]
curr_Stock_Price:  95.66021597467702
curr_Factors:  [95.66021597]
mat_Sqrt:  [[0.15]]
grads:  [-0.0427825]
Stock Position:  -0.04278249649265675
Bond Position:  [0.47104117]


portfolio before change:  [-3.56884301]
curr_Stock_Price:  94.42912287570815
curr_Factors:  [94.42912288]
mat_Sqrt:  [[0.15]]
grads:  [-0.03363096]
Stock Position:  -0.03363095651861954
Bond Position:  [-0.39310128]


portfolio before change:  [-3.56387657]
curr_Stock_Price:  94.2807176696329
curr_Factors:  [94.28071767]
mat_Sqrt:  [[0.15]]
grads:  [0.05237142]
Stock Position:  0.05237141829777886
Bond Position:  [-8.50149147]


portfolio before change:  [-3.58791013]
curr_Stock_Price:  93.83195754138431
curr_Factors:  [93.83195754]
mat_Sqrt:  [[0.15]]
grads:  [-0.06272808]
Stock Position:  -0.06272808388460394
Bond Position:  [2.29798877]


portfolio before change:  [-3.56265153]
curr_Stock_Price:  93.43157909202141
curr_Factors:  [93.43157909]
mat_Sqrt:  [[0.15]]
grads:  [0.02575961]
Stock Position:  0.02575960915134902
Bond Position:  [-5.96941249]


portfolio before change:  [-3.57905664]
curr_Stock_Price:  92.80920879331788
curr_Factors:  [92.80920879]
mat_Sqrt:  [[0.15]]
grads:  [0.14376565]
Stock Position:  0.14376564912526285
Bond Position:  [-16.92183279]


portfolio before change:  [-3.47248068]
curr_Stock_Price:  93.55788281336883
curr_Factors:  [93.55788281]
mat_Sqrt:  [[0.15]]
grads:  [-0.10623016]
Stock Position:  -0.10623016323693046
Bond Position:  [6.46618848]


portfolio before change:  [-3.44175126]
curr_Stock_Price:  93.27241513062411
curr_Factors:  [93.27241513]
mat_Sqrt:  [[0.15]]
grads:  [-0.36697391]
Stock Position:  -0.36697391211897085
Bond Position:  [30.78679182]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.44175126]
Stock Price:  93.08882290227136
PL:  [-3.44175126]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.71567638e-02]
 [-2.24431170e-03]
 [-2.22692442e-04]
 [ 2.28865738e-03]
 [ 1.12624154e-02]
 [ 1.18245076e-02]
 [ 6.47983465e-04]
 [ 1.33240978e-02]
 [ 1.73112053e-02]
 [-1.94992144e-02]
 [ 6.46656028e-03]
 [-6.29000069e-03]
 [-6.14317873e-03]
 [ 3.54972457e-03]
 [-1.85779107e-02]
 [ 1.55821046e-02]
 [-4.38361830e-03]
 [-4.70500286e-03]
 [ 9.61880538e-03]
 [ 1.36920378e-02]
 [ 1.34955326e-02]
 [-1.86594411e-02]
 [-1.38833410e-03]
 [ 1.22290539e-02]
 [ 1.27044848e-02]
 [ 5.74403075e-03]
 [ 1.45686067e-02]
 [-1.15617353e-02]
 [ 1.05891718e-03]
 [ 4.73992628e-04]
 [-3.42077653e-03]
 [-2.32925001e-02]
 [ 1.92691122e-02]
 [ 9.77240585e-03]
 [-2.36333483e-02]
 [ 7.16695210e-03]
 [-2.80463994e-03]
 [ 2.32188501e-03]
 [ 4.48536739e-03]
 [-1.60917863e-02]
 [ 4.57842858e-02]
 [ 1.80540553e-03]
 [ 8.56774340e-03]
 [-9.30117059e-03]
 [-2.93722156e-03]
 [-1.75724455e-02]
 [-1.30252794e-02]
 [ 2.36110366e-03]
 [-2.84796396e-03]
 [-9.17169587e-03]
 [-4.28667917e-03]
 [ 2.81614768e-03]
 [ 3.90517073e-03]
 [-1.39823732e-03]
 [ 1.46081596e-02]
 [ 8.88213855e-03]
 [ 3.59720755e-03]
 [ 9.99523987e-03]
 [ 1.33650606e-02]
 [-2.69187541e-03]
 [ 2.07927020e-05]
 [-1.90973529e-02]
 [-1.27218460e-02]
 [-1.20362268e-03]
 [-1.01376190e-02]
 [-1.33742771e-02]
 [ 9.60872897e-03]
 [ 2.06242218e-03]
 [ 1.12633728e-02]
 [-1.70996632e-02]
 [-2.86901028e-03]
 [ 7.73719847e-04]
 [ 1.56619496e-03]
 [ 8.74990934e-03]
 [ 6.82583931e-03]
 [-7.13894534e-03]
 [-6.14865530e-03]
 [-9.03463752e-03]
 [-7.53835806e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.51388219]
curr_Stock_Price:  100.09302758625864
curr_Factors:  [100.09302759]
mat_Sqrt:  [[0.15]]
grads:  [-0.24771176]
Stock Position:  -0.24771175883312901
Bond Position:  [28.3081021]


portfolio before change:  [3.45940365]
curr_Stock_Price:  100.32009733190053
curr_Factors:  [100.32009733]
mat_Sqrt:  [[0.15]]
grads:  [-0.01496208]
Stock Position:  -0.0149620779873665
Bond Position:  [4.96040077]


portfolio before change:  [3.47206944]
curr_Stock_Price:  99.49429282997951
curr_Factors:  [99.49429283]
mat_Sqrt:  [[0.15]]
grads:  [-0.00148462]
Stock Position:  -0.0014846162807893976
Bond Position:  [3.61978028]


portfolio before change:  [3.47081991]
curr_Stock_Price:  100.4883358533447
curr_Factors:  [100.48833585]
mat_Sqrt:  [[0.15]]
grads:  [0.01525772]
Stock Position:  0.015257715871908098
Bond Position:  [1.93759743]


portfolio before change:  [3.46888036]
curr_Stock_Price:  100.35327948628733
curr_Factors:  [100.35327949]
mat_Sqrt:  [[0.15]]
grads:  [0.07508277]
Stock Position:  0.07508276906240818
Bond Position:  [-4.06592175]


portfolio before change:  [3.46383795]
curr_Stock_Price:  100.28950613809539
curr_Factors:  [100.28950614]
mat_Sqrt:  [[0.15]]
grads:  [0.07883005]
Stock Position:  0.07883005069184697
Bond Position:  [-4.4419889]


portfolio before change:  [3.3967088]
curr_Stock_Price:  99.44145997287508
curr_Factors:  [99.44145997]
mat_Sqrt:  [[0.15]]
grads:  [0.00431989]
Stock Position:  0.004319889769953034
Bond Position:  [2.96713265]


portfolio before change:  [3.39676807]
curr_Stock_Price:  99.41225103683995
curr_Factors:  [99.41225104]
mat_Sqrt:  [[0.15]]
grads:  [0.08882732]
Stock Position:  0.08882731874412515
Bond Position:  [-5.43375564]


portfolio before change:  [3.40982871]
curr_Stock_Price:  99.5631084685214
curr_Factors:  [99.56310847]
mat_Sqrt:  [[0.15]]
grads:  [0.11540804]
Stock Position:  0.11540803503281738
Bond Position:  [-8.080554]


portfolio before change:  [3.35490005]
curr_Stock_Price:  99.09153291323551
curr_Factors:  [99.09153291]
mat_Sqrt:  [[0.15]]
grads:  [-0.12999476]
Stock Position:  -0.12999476245291353
Bond Position:  [16.23628033]


portfolio before change:  [3.32013091]
curr_Stock_Price:  99.36680504978816
curr_Factors:  [99.36680505]
mat_Sqrt:  [[0.15]]
grads:  [0.0431104]
Stock Position:  0.04311040189370563
Bond Position:  [-0.96361199]


portfolio before change:  [3.30297682]
curr_Stock_Price:  98.9702912748102
curr_Factors:  [98.97029127]
mat_Sqrt:  [[0.15]]
grads:  [-0.04193334]
Stock Position:  -0.0419333379031034
Bond Position:  [7.45313149]


portfolio before change:  [3.29587375]
curr_Stock_Price:  99.15078982204165
curr_Factors:  [99.15078982]
mat_Sqrt:  [[0.15]]
grads:  [-0.04095452]
Stock Position:  -0.04095452484987173
Bond Position:  [7.35654723]


portfolio before change:  [3.31428657]
curr_Stock_Price:  98.71242487891637
curr_Factors:  [98.71242488]
mat_Sqrt:  [[0.15]]
grads:  [0.02366483]
Stock Position:  0.02366483045573156
Bond Position:  [0.97827378]


portfolio before change:  [3.29475424]
curr_Stock_Price:  97.8844670656453
curr_Factors:  [97.88446707]
mat_Sqrt:  [[0.15]]
grads:  [-0.12385274]
Stock Position:  -0.12385273822764081
Bond Position:  [15.41801351]


portfolio before change:  [3.29226366]
curr_Stock_Price:  97.91235689918163
curr_Factors:  [97.9123569]
mat_Sqrt:  [[0.15]]
grads:  [0.1038807]
Stock Position:  0.10388069733435232
Bond Position:  [-6.87894025]


portfolio before change:  [3.19548348]
curr_Stock_Price:  96.98484838221061
curr_Factors:  [96.98484838]
mat_Sqrt:  [[0.15]]
grads:  [-0.02922412]
Stock Position:  -0.02922412202902175
Bond Position:  [6.02978053]


portfolio before change:  [3.18607695]
curr_Stock_Price:  97.31961982452793
curr_Factors:  [97.31961982]
mat_Sqrt:  [[0.15]]
grads:  [-0.03136669]
Stock Position:  -0.031366685762645535
Bond Position:  [6.23867089]


portfolio before change:  [3.15590524]
curr_Stock_Price:  98.29395435724733
curr_Factors:  [98.29395436]
mat_Sqrt:  [[0.15]]
grads:  [0.06412537]
Stock Position:  0.06412536917295728
Bond Position:  [-3.14723087]


portfolio before change:  [3.16425187]
curr_Stock_Price:  98.42718311372411
curr_Factors:  [98.42718311]
mat_Sqrt:  [[0.15]]
grads:  [0.09128025]
Stock Position:  0.09128025219157906
Bond Position:  [-5.82020622]


portfolio before change:  [3.1447284]
curr_Stock_Price:  98.21728338650303
curr_Factors:  [98.21728339]
mat_Sqrt:  [[0.15]]
grads:  [0.08997022]
Stock Position:  0.08997021766123918
Bond Position:  [-5.69190197]


portfolio before change:  [3.18493922]
curr_Stock_Price:  98.66817237680422
curr_Factors:  [98.66817238]
mat_Sqrt:  [[0.15]]
grads:  [-0.12439627]
Stock Position:  -0.12439627420492329
Bond Position:  [15.45889225]


portfolio before change:  [3.12109248]
curr_Stock_Price:  99.18919245792601
curr_Factors:  [99.18919246]
mat_Sqrt:  [[0.15]]
grads:  [-0.00925556]
Stock Position:  -0.009255560682254992
Bond Position:  [4.03914407]


portfolio before change:  [3.1149025]
curr_Stock_Price:  99.88525374178556
curr_Factors:  [99.88525374]
mat_Sqrt:  [[0.15]]
grads:  [0.08152703]
Stock Position:  0.08152702605522795
Bond Position:  [-5.02844519]


portfolio before change:  [3.11939217]
curr_Stock_Price:  99.9441784665232
curr_Factors:  [99.94417847]
mat_Sqrt:  [[0.15]]
grads:  [0.08469657]
Stock Position:  0.0846965654947175
Bond Position:  [-5.34553649]


portfolio before change:  [3.01445604]
curr_Stock_Price:  98.70915770959427
curr_Factors:  [98.70915771]
mat_Sqrt:  [[0.15]]
grads:  [0.03829354]
Stock Position:  0.03829353835667518
Bond Position:  [-0.76546687]


portfolio before change:  [2.97848896]
curr_Stock_Price:  97.77116043312728
curr_Factors:  [97.77116043]
mat_Sqrt:  [[0.15]]
grads:  [0.09712404]
Stock Position:  0.09712404498568727
Bond Position:  [-6.51744162]


portfolio before change:  [2.95322135]
curr_Stock_Price:  97.51519639110792
curr_Factors:  [97.51519639]
mat_Sqrt:  [[0.15]]
grads:  [-0.07707824]
Stock Position:  -0.0770782356204288
Bond Position:  [10.46952063]


portfolio before change:  [2.95450355]
curr_Stock_Price:  97.507051012982
curr_Factors:  [97.50705101]
mat_Sqrt:  [[0.15]]
grads:  [0.00705945]
Stock Position:  0.0070594478554253616
Bond Position:  [2.2661576]


portfolio before change:  [2.95159169]
curr_Stock_Price:  97.07451086651568
curr_Factors:  [97.07451087]
mat_Sqrt:  [[0.15]]
grads:  [0.00315995]
Stock Position:  0.0031599508549662314
Bond Position:  [2.64484101]


portfolio before change:  [2.95088409]
curr_Stock_Price:  96.7982706896257
curr_Factors:  [96.79827069]
mat_Sqrt:  [[0.15]]
grads:  [-0.02280518]
Stock Position:  -0.02280517685231374
Bond Position:  [5.15838577]


portfolio before change:  [2.94508145]
curr_Stock_Price:  97.0668521873347
curr_Factors:  [97.06685219]
mat_Sqrt:  [[0.15]]
grads:  [-0.15528333]
Stock Position:  -0.15528333398084238
Bond Position:  [18.01794588]


portfolio before change:  [2.89591465]
curr_Stock_Price:  97.39073088210726
curr_Factors:  [97.39073088]
mat_Sqrt:  [[0.15]]
grads:  [0.12846075]
Stock Position:  0.1284607478767781
Bond Position:  [-9.61497148]


portfolio before change:  [2.88634787]
curr_Stock_Price:  97.32093659605403
curr_Factors:  [97.3209366]
mat_Sqrt:  [[0.15]]
grads:  [0.06514937]
Stock Position:  0.06514937231227083
Bond Position:  [-3.45405007]


portfolio before change:  [2.87944558]
curr_Stock_Price:  97.2183047766545
curr_Factors:  [97.21830478]
mat_Sqrt:  [[0.15]]
grads:  [-0.15755566]
Stock Position:  -0.1575556554902922
Bond Position:  [18.19673932]


portfolio before change:  [2.75766565]
curr_Stock_Price:  97.99845615209549
curr_Factors:  [97.99845615]
mat_Sqrt:  [[0.15]]
grads:  [0.04777968]
Stock Position:  0.047779680652097124
Bond Position:  [-1.92466929]


portfolio before change:  [2.72804745]
curr_Stock_Price:  97.38108273246965
curr_Factors:  [97.38108273]
mat_Sqrt:  [[0.15]]
grads:  [-0.0186976]
Stock Position:  -0.018697599599323784
Bond Position:  [4.54883995]


portfolio before change:  [2.7280168]
curr_Stock_Price:  97.39792803075687
curr_Factors:  [97.39792803]
mat_Sqrt:  [[0.15]]
grads:  [0.01547923]
Stock Position:  0.015479233369913263
Bond Position:  [1.22037154]


portfolio before change:  [2.73030894]
curr_Stock_Price:  97.5410788825086
curr_Factors:  [97.54107888]
mat_Sqrt:  [[0.15]]
grads:  [0.02990245]
Stock Position:  0.02990244928951573
Bond Position:  [-0.18640823]


portfolio before change:  [2.71844496]
curr_Stock_Price:  97.14471259302066
curr_Factors:  [97.14471259]
mat_Sqrt:  [[0.15]]
grads:  [-0.10727858]
Stock Position:  -0.10727857541819287
Bond Position:  [13.13999134]


portfolio before change:  [2.83583864]
curr_Stock_Price:  96.05807991381212
curr_Factors:  [96.05807991]
mat_Sqrt:  [[0.15]]
grads:  [0.30522857]
Stock Position:  0.30522857221911137
Bond Position:  [-26.48383194]


portfolio before change:  [2.76747778]
curr_Stock_Price:  95.83953688595993
curr_Factors:  [95.83953689]
mat_Sqrt:  [[0.15]]
grads:  [0.01203604]
Stock Position:  0.012036036852881231
Bond Position:  [1.61394958]


portfolio before change:  [2.76611386]
curr_Stock_Price:  95.71783608102764
curr_Factors:  [95.71783608]
mat_Sqrt:  [[0.15]]
grads:  [0.05711829]
Stock Position:  0.057118289316035964
Bond Position:  [-2.7011252]


portfolio before change:  [2.80464674]
curr_Stock_Price:  96.39540724677965
curr_Factors:  [96.39540725]
mat_Sqrt:  [[0.15]]
grads:  [-0.0620078]
Stock Position:  -0.062007803915875355
Bond Position:  [8.78191425]


portfolio before change:  [2.87904414]
curr_Stock_Price:  95.20445211321885
curr_Factors:  [95.20445211]
mat_Sqrt:  [[0.15]]
grads:  [-0.01958148]
Stock Position:  -0.019581477076358614
Bond Position:  [4.74328793]


portfolio before change:  [2.89042816]
curr_Stock_Price:  94.63822529309311
curr_Factors:  [94.63822529]
mat_Sqrt:  [[0.15]]
grads:  [-0.11714964]
Stock Position:  -0.11714963680131261
Bond Position:  [13.97726188]


portfolio before change:  [2.93604399]
curr_Stock_Price:  94.25630159150907
curr_Factors:  [94.25630159]
mat_Sqrt:  [[0.15]]
grads:  [-0.0868352]
Stock Position:  -0.08683519602071642
Bond Position:  [11.12080841]


portfolio before change:  [2.96446749]
curr_Stock_Price:  93.93697916859324
curr_Factors:  [93.93697917]
mat_Sqrt:  [[0.15]]
grads:  [0.01574069]
Stock Position:  0.01574069104191415
Bond Position:  [1.48583452]


portfolio before change:  [2.9761373]
curr_Stock_Price:  94.67245784009486
curr_Factors:  [94.67245784]
mat_Sqrt:  [[0.15]]
grads:  [-0.01898643]
Stock Position:  -0.018986426382963075
Bond Position:  [4.77362895]


portfolio before change:  [2.97126323]
curr_Stock_Price:  94.94488563146287
curr_Factors:  [94.94488563]
mat_Sqrt:  [[0.15]]
grads:  [-0.06114464]
Stock Position:  -0.06114463916224603
Bond Position:  [8.776634]


portfolio before change:  [2.98460001]
curr_Stock_Price:  94.73573853168719
curr_Factors:  [94.73573853]
mat_Sqrt:  [[0.15]]
grads:  [-0.02857786]
Stock Position:  -0.028577861125235252
Bond Position:  [5.69194479]


portfolio before change:  [2.96781499]
curr_Stock_Price:  95.33553073830262
curr_Factors:  [95.33553074]
mat_Sqrt:  [[0.15]]
grads:  [0.01877432]
Stock Position:  0.01877431784033534
Bond Position:  [1.17795543]


portfolio before change:  [2.95790086]
curr_Stock_Price:  94.80354061414478
curr_Factors:  [94.80354061]
mat_Sqrt:  [[0.15]]
grads:  [0.02603447]
Stock Position:  0.026034471528082494
Bond Position:  [0.48974078]


portfolio before change:  [2.96702427]
curr_Stock_Price:  95.15280074522082
curr_Factors:  [95.15280075]
mat_Sqrt:  [[0.15]]
grads:  [-0.00932158]
Stock Position:  -0.009321582148281236
Bond Position:  [3.85399892]


portfolio before change:  [2.96994525]
curr_Stock_Price:  94.8652854559905
curr_Factors:  [94.86528546]
mat_Sqrt:  [[0.15]]
grads:  [0.09738773]
Stock Position:  0.0973877304463325
Bond Position:  [-6.2687696]


portfolio before change:  [3.04579629]
curr_Stock_Price:  95.64816488876781
curr_Factors:  [95.64816489]
mat_Sqrt:  [[0.15]]
grads:  [0.05921426]
Stock Position:  0.05921425701022258
Bond Position:  [-2.61793873]


portfolio before change:  [3.01036929]
curr_Stock_Price:  95.05264312266169
curr_Factors:  [95.05264312]
mat_Sqrt:  [[0.15]]
grads:  [0.02398138]
Stock Position:  0.02398138367022737
Bond Position:  [0.73087538]


portfolio before change:  [3.02127979]
curr_Stock_Price:  95.50569527555996
curr_Factors:  [95.50569528]
mat_Sqrt:  [[0.15]]
grads:  [0.06663493]
Stock Position:  0.06663493244369992
Bond Position:  [-3.34273577]


portfolio before change:  [3.05887559]
curr_Stock_Price:  96.07303625436491
curr_Factors:  [96.07303625]
mat_Sqrt:  [[0.15]]
grads:  [0.0891004]
Stock Position:  0.08910040385436391
Bond Position:  [-5.50127074]


portfolio before change:  [3.07475541]
curr_Stock_Price:  96.25511920525739
curr_Factors:  [96.25511921]
mat_Sqrt:  [[0.15]]
grads:  [-0.01794584]
Stock Position:  -0.017945836055814676
Bond Position:  [4.802134]


portfolio before change:  [3.06625495]
curr_Stock_Price:  96.74551720438048
curr_Factors:  [96.7455172]
mat_Sqrt:  [[0.15]]
grads:  [0.00013862]
Stock Position:  0.00013861801357043074
Bond Position:  [3.05284428]


portfolio before change:  [3.06642547]
curr_Stock_Price:  96.59915779887977
curr_Factors:  [96.5991578]
mat_Sqrt:  [[0.15]]
grads:  [-0.12731569]
Stock Position:  -0.1273156862564968
Bond Position:  [15.36501354]


portfolio before change:  [2.99171176]
curr_Stock_Price:  97.19353906626911
curr_Factors:  [97.19353907]
mat_Sqrt:  [[0.15]]
grads:  [-0.08481231]
Stock Position:  -0.08481230674998479
Bond Position:  [11.23492001]


portfolio before change:  [2.98425543]
curr_Stock_Price:  97.28973420026443
curr_Factors:  [97.2897342]
mat_Sqrt:  [[0.15]]
grads:  [-0.00802415]
Stock Position:  -0.008024151197957938
Bond Position:  [3.76492297]


portfolio before change:  [2.98281449]
curr_Stock_Price:  97.49863490165332
curr_Factors:  [97.4986349]
mat_Sqrt:  [[0.15]]
grads:  [-0.06758413]
Stock Position:  -0.06758412691827433
Bond Position:  [9.57217461]


portfolio before change:  [3.01962995]
curr_Stock_Price:  96.96275200327219
curr_Factors:  [96.962752]
mat_Sqrt:  [[0.15]]
grads:  [-0.08916185]
Stock Position:  -0.08916184744905452
Bond Position:  [11.66500805]


portfolio before change:  [3.01531418]
curr_Stock_Price:  97.01933286249253
curr_Factors:  [97.01933286]
mat_Sqrt:  [[0.15]]
grads:  [0.06405819]
Stock Position:  0.06405819312378871
Bond Position:  [-3.19956898]


portfolio before change:  [3.01147417]
curr_Stock_Price:  96.96250903205804
curr_Factors:  [96.96250903]
mat_Sqrt:  [[0.15]]
grads:  [0.01374948]
Stock Position:  0.013749481170942102
Bond Position:  [1.67828998]


portfolio before change:  [3.01563055]
curr_Stock_Price:  97.25717334860688
curr_Factors:  [97.25717335]
mat_Sqrt:  [[0.15]]
grads:  [0.07508915]
Stock Position:  0.07508915231177442
Bond Position:  [-4.28732815]


portfolio before change:  [3.08862627]
curr_Stock_Price:  98.23286276843501
curr_Factors:  [98.23286277]
mat_Sqrt:  [[0.15]]
grads:  [-0.11399775]
Stock Position:  -0.1139977544384317
Bond Position:  [14.28695204]


portfolio before change:  [3.05234196]
curr_Stock_Price:  98.55898567136808
curr_Factors:  [98.55898567]
mat_Sqrt:  [[0.15]]
grads:  [-0.01912674]
Stock Position:  -0.019126735199097872
Bond Position:  [4.93745358]


portfolio before change:  [3.05383631]
curr_Stock_Price:  98.49699122018441
curr_Factors:  [98.49699122]
mat_Sqrt:  [[0.15]]
grads:  [0.00515813]
Stock Position:  0.005158132316472585
Bond Position:  [2.5457758]


portfolio before change:  [3.05688327]
curr_Stock_Price:  99.05685311168169
curr_Factors:  [99.05685311]
mat_Sqrt:  [[0.15]]
grads:  [0.0104413]
Stock Position:  0.01044129972970139
Bond Position:  [2.02260097]


portfolio before change:  [3.05689161]
curr_Stock_Price:  99.04554431650061
curr_Factors:  [99.04554432]
mat_Sqrt:  [[0.15]]
grads:  [0.05833273]
Stock Position:  0.05833272891994983
Bond Position:  [-2.72070528]


portfolio before change:  [3.02869735]
curr_Stock_Price:  98.56512438598622
curr_Factors:  [98.56512439]
mat_Sqrt:  [[0.15]]
grads:  [0.0455056]
Stock Position:  0.045505595411736564
Bond Position:  [-1.45656732]


portfolio before change:  [3.07834145]
curr_Stock_Price:  99.6580699038303
curr_Factors:  [99.6580699]
mat_Sqrt:  [[0.15]]
grads:  [-0.04759297]
Stock Position:  -0.04759296894034936
Bond Position:  [7.82136487]


portfolio before change:  [3.12659683]
curr_Stock_Price:  98.6544232087103
curr_Factors:  [98.65442321]
mat_Sqrt:  [[0.15]]
grads:  [-0.04099104]
Stock Position:  -0.0409910353451303
Bond Position:  [7.17054377]


portfolio before change:  [3.11371064]
curr_Stock_Price:  98.9797224901909
curr_Factors:  [98.97972249]
mat_Sqrt:  [[0.15]]
grads:  [-0.06023092]
Stock Position:  -0.06023091677005043
Bond Position:  [9.07535007]


portfolio before change:  [3.13347123]
curr_Stock_Price:  98.66105952963805
curr_Factors:  [98.66105953]
mat_Sqrt:  [[0.15]]
grads:  [-0.05025572]
Stock Position:  -0.050255720418235277
Bond Position:  [8.09175386]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.13347123]
Stock Price:  98.30583788781526
PL:  [3.13347123]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-7.00244519e-02]
 [-9.69343380e-04]
 [ 4.43275403e-03]
 [ 2.29452352e-03]
 [ 1.11683280e-02]
 [ 1.20808588e-02]
 [-4.98772686e-04]
 [ 6.02042568e-03]
 [-1.09758089e-02]
 [-1.08461505e-03]
 [ 1.00964077e-02]
 [-8.39817467e-03]
 [ 1.30917379e-02]
 [ 4.02054755e-03]
 [-2.20500320e-03]
 [-9.34310534e-03]
 [ 7.89312961e-03]
 [ 2.54496144e-02]
 [ 1.42869443e-02]
 [-1.71891231e-03]
 [ 3.51999901e-02]
 [-1.08497263e-02]
 [-6.88499781e-03]
 [ 7.88025613e-03]
 [ 1.94699856e-02]
 [ 1.22740867e-02]
 [ 5.22846891e-03]
 [ 5.58171464e-03]
 [ 1.03552093e-02]
 [-8.39729930e-03]
 [-5.84386366e-03]
 [ 4.41894095e-02]
 [ 2.70457161e-03]
 [-9.97103070e-03]
 [-1.95994010e-03]
 [-6.27098928e-03]
 [ 7.61145319e-04]
 [-1.15478434e-02]
 [ 9.89924941e-03]
 [-2.07564241e-03]
 [-7.26477365e-02]
 [-6.33824790e-03]
 [ 2.22058165e-02]
 [-1.88471070e-02]
 [-1.20209392e-02]
 [ 3.26954084e-03]
 [-1.35645803e-02]
 [ 1.45586677e-02]
 [ 2.69867660e-02]
 [-1.34920283e-02]
 [-4.74289741e-03]
 [ 3.89824733e-03]
 [ 3.58916114e-03]
 [-9.61792520e-03]
 [-1.48095462e-02]
 [ 1.36734639e-02]
 [-3.59286236e-02]
 [-1.12780103e-02]
 [ 2.22336479e-02]
 [-1.15991365e-02]
 [ 1.33314899e-02]
 [-1.33712506e-02]
 [-1.26691577e-02]
 [-2.63402397e-03]
 [ 1.30467343e-01]
 [-1.25404337e-02]
 [ 7.69882988e-04]
 [ 6.95648800e-03]
 [ 1.56766262e-02]
 [-3.16799360e-02]
 [-7.90972470e-03]
 [-5.02063713e-03]
 [ 1.44586168e-02]
 [ 4.12502870e-03]
 [-2.99765527e-03]
 [ 8.97630484e-03]
 [-2.72843183e-03]
 [-2.62682520e-04]
 [ 3.17443866e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.84316709]
curr_Stock_Price:  100.69262688068822
curr_Factors:  [100.69262688]
mat_Sqrt:  [[0.15]]
grads:  [-0.46682968]
Stock Position:  -0.4668296792771392
Bond Position:  [59.8494738]


portfolio before change:  [12.89063126]
curr_Stock_Price:  100.59896646704978
curr_Factors:  [100.59896647]
mat_Sqrt:  [[0.15]]
grads:  [-0.00646229]
Stock Position:  -0.006462289199823879
Bond Position:  [13.54073087]


portfolio before change:  [12.88806801]
curr_Stock_Price:  101.12657696934326
curr_Factors:  [101.12657697]
mat_Sqrt:  [[0.15]]
grads:  [0.02955169]
Stock Position:  0.02955169355171527
Bond Position:  [9.8996064]


portfolio before change:  [12.87104332]
curr_Stock_Price:  100.52954048168777
curr_Factors:  [100.52954048]
mat_Sqrt:  [[0.15]]
grads:  [0.01529682]
Stock Position:  0.015296823476420687
Bond Position:  [11.33326068]


portfolio before change:  [12.86911845]
curr_Stock_Price:  100.35739935307896
curr_Factors:  [100.35739935]
mat_Sqrt:  [[0.15]]
grads:  [0.07445552]
Stock Position:  0.07445551989845269
Bond Position:  [5.39695611]


portfolio before change:  [12.94973225]
curr_Stock_Price:  101.43557970995403
curr_Factors:  [101.43557971]
mat_Sqrt:  [[0.15]]
grads:  [0.08053906]
Stock Position:  0.08053905898341017
Bond Position:  [4.78020612]


portfolio before change:  [12.9950771]
curr_Stock_Price:  101.99488683179835
curr_Factors:  [101.99488683]
mat_Sqrt:  [[0.15]]
grads:  [-0.00332515]
Stock Position:  -0.003325151240211391
Bond Position:  [13.33422552]


portfolio before change:  [12.99722758]
curr_Stock_Price:  101.59879241041374
curr_Factors:  [101.59879241]
mat_Sqrt:  [[0.15]]
grads:  [0.04013617]
Stock Position:  0.04013617122517059
Bond Position:  [8.91944106]


portfolio before change:  [13.0170532]
curr_Stock_Price:  102.07886133439162
curr_Factors:  [102.07886133]
mat_Sqrt:  [[0.15]]
grads:  [-0.07317206]
Stock Position:  -0.07317205936554294
Bond Position:  [20.4863737]


portfolio before change:  [13.02196212]
curr_Stock_Price:  102.02927291343512
curr_Factors:  [102.02927291]
mat_Sqrt:  [[0.15]]
grads:  [-0.00723077]
Stock Position:  -0.00723076702208896
Bond Position:  [13.75971202]


portfolio before change:  [13.0274638]
curr_Stock_Price:  101.38733994079989
curr_Factors:  [101.38733994]
mat_Sqrt:  [[0.15]]
grads:  [0.06730938]
Stock Position:  0.06730938448511797
Bond Position:  [6.20314435]


portfolio before change:  [13.03431153]
curr_Stock_Price:  101.48331501242026
curr_Factors:  [101.48331501]
mat_Sqrt:  [[0.15]]
grads:  [-0.05598783]
Stock Position:  -0.055987831124372424
Bond Position:  [18.71614223]


portfolio before change:  [13.03659053]
curr_Stock_Price:  101.4635034387143
curr_Factors:  [101.46350344]
mat_Sqrt:  [[0.15]]
grads:  [0.08727825]
Stock Position:  0.08727825260459247
Bond Position:  [4.18103325]


portfolio before change:  [13.03993473]
curr_Stock_Price:  101.4988258133809
curr_Factors:  [101.49882581]
mat_Sqrt:  [[0.15]]
grads:  [0.02680365]
Stock Position:  0.02680365032934683
Bond Position:  [10.31939569]


portfolio before change:  [13.05591024]
curr_Stock_Price:  102.07078266168075
curr_Factors:  [102.07078266]
mat_Sqrt:  [[0.15]]
grads:  [-0.01470002]
Stock Position:  -0.014700021304822689
Bond Position:  [14.55635292]


portfolio before change:  [13.04950806]
curr_Stock_Price:  102.56819592893862
curr_Factors:  [102.56819593]
mat_Sqrt:  [[0.15]]
grads:  [-0.06228737]
Stock Position:  -0.06228736896000917
Bond Position:  [19.43821112]


portfolio before change:  [13.08392404]
curr_Stock_Price:  102.03516554637737
curr_Factors:  [102.03516555]
mat_Sqrt:  [[0.15]]
grads:  [0.05262086]
Stock Position:  0.05262086404260541
Bond Position:  [7.71474547]


portfolio before change:  [13.08854952]
curr_Stock_Price:  102.11390403033054
curr_Factors:  [102.11390403]
mat_Sqrt:  [[0.15]]
grads:  [0.1696641]
Stock Position:  0.16966409597944387
Bond Position:  [-4.2365137]


portfolio before change:  [13.14186434]
curr_Stock_Price:  102.42970221523112
curr_Factors:  [102.42970222]
mat_Sqrt:  [[0.15]]
grads:  [0.0952463]
Stock Position:  0.09524629508358547
Bond Position:  [3.3858147]


portfolio before change:  [13.15223969]
curr_Stock_Price:  102.53641215877089
curr_Factors:  [102.53641216]
mat_Sqrt:  [[0.15]]
grads:  [-0.01145942]
Stock Position:  -0.011459415393600328
Bond Position:  [14.32724703]


portfolio before change:  [13.14839995]
curr_Stock_Price:  102.9496284311001
curr_Factors:  [102.94962843]
mat_Sqrt:  [[0.15]]
grads:  [0.2346666]
Stock Position:  0.2346666005086065
Bond Position:  [-11.01043938]


portfolio before change:  [13.23609584]
curr_Stock_Price:  103.32626516055407
curr_Factors:  [103.32626516]
mat_Sqrt:  [[0.15]]
grads:  [-0.07233151]
Stock Position:  -0.0723315087377989
Bond Position:  [20.70984049]


portfolio before change:  [13.14736679]
curr_Stock_Price:  104.57086038621267
curr_Factors:  [104.57086039]
mat_Sqrt:  [[0.15]]
grads:  [-0.04589999]
Stock Position:  -0.04589998538784265
Bond Position:  [17.94716776]


portfolio before change:  [13.12060247]
curr_Stock_Price:  105.17840004556805
curr_Factors:  [105.17840005]
mat_Sqrt:  [[0.15]]
grads:  [0.05253504]
Stock Position:  0.052535040855080074
Bond Position:  [7.59505092]


portfolio before change:  [13.12886147]
curr_Stock_Price:  105.32657353995045
curr_Factors:  [105.32657354]
mat_Sqrt:  [[0.15]]
grads:  [0.1297999]
Stock Position:  0.12979990407393252
Bond Position:  [-0.54251767]


portfolio before change:  [13.11505507]
curr_Stock_Price:  105.22046793211604
curr_Factors:  [105.22046793]
mat_Sqrt:  [[0.15]]
grads:  [0.08182724]
Stock Position:  0.08182724479319409
Bond Position:  [4.50515408]


portfolio before change:  [13.15443582]
curr_Stock_Price:  105.69829378422571
curr_Factors:  [105.69829378]
mat_Sqrt:  [[0.15]]
grads:  [0.03485646]
Stock Position:  0.03485645941936165
Bond Position:  [9.47016753]


portfolio before change:  [13.1255713]
curr_Stock_Price:  104.85321589236055
curr_Factors:  [104.85321589]
mat_Sqrt:  [[0.15]]
grads:  [0.03721143]
Stock Position:  0.037211430929242686
Bond Position:  [9.2238331]


portfolio before change:  [13.15243894]
curr_Stock_Price:  105.55974967799283
curr_Factors:  [105.55974968]
mat_Sqrt:  [[0.15]]
grads:  [0.06903473]
Stock Position:  0.06903472887854353
Bond Position:  [5.86515024]


portfolio before change:  [13.19954757]
curr_Stock_Price:  106.23682990022938
curr_Factors:  [106.2368299]
mat_Sqrt:  [[0.15]]
grads:  [-0.055982]
Stock Position:  -0.055981995364761394
Bond Position:  [19.14689729]


portfolio before change:  [13.22802037]
curr_Stock_Price:  105.74960037129526
curr_Factors:  [105.74960037]
mat_Sqrt:  [[0.15]]
grads:  [-0.03895909]
Stock Position:  -0.03895909105361577
Bond Position:  [17.34792868]


portfolio before change:  [13.25171393]
curr_Stock_Price:  105.16926659389574
curr_Factors:  [105.16926659]
mat_Sqrt:  [[0.15]]
grads:  [0.29459606]
Stock Position:  0.2945960632342116
Bond Position:  [-17.73073798]


portfolio before change:  [13.2917623]
curr_Stock_Price:  105.30897169809006
curr_Factors:  [105.3089717]
mat_Sqrt:  [[0.15]]
grads:  [0.01803048]
Stock Position:  0.01803047739694928
Bond Position:  [11.39299126]


portfolio before change:  [13.29717534]
curr_Stock_Price:  105.56969441421772
curr_Factors:  [105.56969441]
mat_Sqrt:  [[0.15]]
grads:  [-0.06647354]
Stock Position:  -0.06647353799583545
Bond Position:  [20.31476643]


portfolio before change:  [13.29350423]
curr_Stock_Price:  105.64402196873019
curr_Factors:  [105.64402197]
mat_Sqrt:  [[0.15]]
grads:  [-0.01306627]
Stock Position:  -0.013066267363887723
Bond Position:  [14.67387727]


portfolio before change:  [13.29539478]
curr_Stock_Price:  105.56952506764807
curr_Factors:  [105.56952507]
mat_Sqrt:  [[0.15]]
grads:  [-0.0418066]
Stock Position:  -0.041806595212942686
Bond Position:  [17.70889718]


portfolio before change:  [13.24745315]
curr_Stock_Price:  106.74274829626832
curr_Factors:  [106.7427483]
mat_Sqrt:  [[0.15]]
grads:  [0.0050743]
Stock Position:  0.005074302125488688
Bond Position:  [12.70580819]


portfolio before change:  [13.25303114]
curr_Stock_Price:  107.68550881971215
curr_Factors:  [107.68550882]
mat_Sqrt:  [[0.15]]
grads:  [-0.07698562]
Stock Position:  -0.07698562242200793
Bond Position:  [21.54326706]


portfolio before change:  [13.25970665]
curr_Stock_Price:  107.61628793362019
curr_Factors:  [107.61628793]
mat_Sqrt:  [[0.15]]
grads:  [0.065995]
Stock Position:  0.06599499604178871
Bond Position:  [6.15757015]


portfolio before change:  [13.31285442]
curr_Stock_Price:  108.41578657492555
curr_Factors:  [108.41578657]
mat_Sqrt:  [[0.15]]
grads:  [-0.01383762]
Stock Position:  -0.013837616084302617
Bond Position:  [14.81307045]


portfolio before change:  [13.31865272]
curr_Stock_Price:  108.06366954799707
curr_Factors:  [108.06366955]
mat_Sqrt:  [[0.15]]
grads:  [-0.48431824]
Stock Position:  -0.48431824357233727
Bond Position:  [65.65585935]


portfolio before change:  [13.09360226]
curr_Stock_Price:  108.53681728476958
curr_Factors:  [108.53681728]
mat_Sqrt:  [[0.15]]
grads:  [-0.04225499]
Stock Position:  -0.04225498597915443
Bond Position:  [17.67982395]


portfolio before change:  [13.13943666]
curr_Stock_Price:  107.47825870318484
curr_Factors:  [107.4782587]
mat_Sqrt:  [[0.15]]
grads:  [0.14803878]
Stock Position:  0.14803877673971355
Bond Position:  [-2.77151328]


portfolio before change:  [13.10766868]
curr_Stock_Price:  107.26483651830782
curr_Factors:  [107.26483652]
mat_Sqrt:  [[0.15]]
grads:  [-0.12564738]
Stock Position:  -0.12564738009551024
Bond Position:  [26.58521436]


portfolio before change:  [13.04063868]
curr_Stock_Price:  107.81153815682204
curr_Factors:  [107.81153816]
mat_Sqrt:  [[0.15]]
grads:  [-0.08013959]
Stock Position:  -0.08013959434678697
Bond Position:  [21.68061161]


portfolio before change:  [13.14246285]
curr_Stock_Price:  106.55786203763138
curr_Factors:  [106.55786204]
mat_Sqrt:  [[0.15]]
grads:  [0.02179694]
Stock Position:  0.021796938911725038
Bond Position:  [10.81982764]


portfolio before change:  [13.11948042]
curr_Stock_Price:  105.47244827253989
curr_Factors:  [105.47244827]
mat_Sqrt:  [[0.15]]
grads:  [-0.09043054]
Stock Position:  -0.09043053532391594
Bond Position:  [22.65741038]


portfolio before change:  [13.16535658]
curr_Stock_Price:  104.9807998159211
curr_Factors:  [104.98079982]
mat_Sqrt:  [[0.15]]
grads:  [0.09705778]
Stock Position:  0.09705778451979677
Bond Position:  [2.97615274]


portfolio before change:  [13.21402243]
curr_Stock_Price:  105.48029430929282
curr_Factors:  [105.48029431]
mat_Sqrt:  [[0.15]]
grads:  [0.17991177]
Stock Position:  0.17991177322722335
Bond Position:  [-5.76312436]


portfolio before change:  [13.32965533]
curr_Stock_Price:  106.12501647979909
curr_Factors:  [106.12501648]
mat_Sqrt:  [[0.15]]
grads:  [-0.08994686]
Stock Position:  -0.08994685562431756
Bond Position:  [22.87526686]


portfolio before change:  [13.31622039]
curr_Stock_Price:  106.29027728100645
curr_Factors:  [106.29027728]
mat_Sqrt:  [[0.15]]
grads:  [-0.03161932]
Stock Position:  -0.03161931606819311
Bond Position:  [16.67704626]


portfolio before change:  [13.27394402]
curr_Stock_Price:  107.66028528693839
curr_Factors:  [107.66028529]
mat_Sqrt:  [[0.15]]
grads:  [0.02598832]
Stock Position:  0.02598831551359272
Bond Position:  [10.47603456]


portfolio before change:  [13.28781105]
curr_Stock_Price:  108.16867750346714
curr_Factors:  [108.1686775]
mat_Sqrt:  [[0.15]]
grads:  [0.02392774]
Stock Position:  0.02392774093366195
Bond Position:  [10.69957896]


portfolio before change:  [13.28882898]
curr_Stock_Price:  108.1832706888862
curr_Factors:  [108.18327069]
mat_Sqrt:  [[0.15]]
grads:  [-0.0641195]
Stock Position:  -0.06411950130433958
Bond Position:  [20.22548634]


portfolio before change:  [13.29660323]
curr_Stock_Price:  108.0817396221753
curr_Factors:  [108.08173962]
mat_Sqrt:  [[0.15]]
grads:  [-0.09873031]
Stock Position:  -0.09873030775676407
Bond Position:  [23.96754665]


portfolio before change:  [13.31462531]
curr_Stock_Price:  107.91437397517082
curr_Factors:  [107.91437398]
mat_Sqrt:  [[0.15]]
grads:  [0.09115643]
Stock Position:  0.091156426107017
Bond Position:  [3.47753665]


portfolio before change:  [13.2381725]
curr_Stock_Price:  107.07329050805069
curr_Factors:  [107.07329051]
mat_Sqrt:  [[0.15]]
grads:  [-0.23952416]
Stock Position:  -0.2395241570947551
Bond Position:  [38.88481216]


portfolio before change:  [13.15701309]
curr_Stock_Price:  107.42227319656484
curr_Factors:  [107.4222732]
mat_Sqrt:  [[0.15]]
grads:  [-0.07518674]
Stock Position:  -0.07518673555562583
Bond Position:  [21.23374314]


portfolio before change:  [13.14050272]
curr_Stock_Price:  107.65951613183834
curr_Factors:  [107.65951613]
mat_Sqrt:  [[0.15]]
grads:  [0.14822432]
Stock Position:  0.14822431925516769
Bond Position:  [-2.81725577]


portfolio before change:  [13.13253489]
curr_Stock_Price:  107.60694886538886
curr_Factors:  [107.60694887]
mat_Sqrt:  [[0.15]]
grads:  [-0.07732758]
Stock Position:  -0.07732757661608503
Bond Position:  [21.45351947]


portfolio before change:  [13.08846976]
curr_Stock_Price:  108.1941393091583
curr_Factors:  [108.19413931]
mat_Sqrt:  [[0.15]]
grads:  [0.0888766]
Stock Position:  0.08887659953938978
Bond Position:  [3.47254257]


portfolio before change:  [13.02335181]
curr_Stock_Price:  107.45901896647753
curr_Factors:  [107.45901897]
mat_Sqrt:  [[0.15]]
grads:  [-0.08914167]
Stock Position:  -0.08914167054180547
Bond Position:  [22.60242827]


portfolio before change:  [13.02596733]
curr_Stock_Price:  107.44552557820306
curr_Factors:  [107.44552558]
mat_Sqrt:  [[0.15]]
grads:  [-0.08446105]
Stock Position:  -0.0844610510390977
Bond Position:  [22.10092935]


portfolio before change:  [13.05832868]
curr_Stock_Price:  107.07872930269617
curr_Factors:  [107.0787293]
mat_Sqrt:  [[0.15]]
grads:  [-0.01756016]
Stock Position:  -0.017560159779691237
Bond Position:  [14.93864827]


portfolio before change:  [13.04762984]
curr_Stock_Price:  107.74116803913218
curr_Factors:  [107.74116804]
mat_Sqrt:  [[0.15]]
grads:  [0.86978229]
Stock Position:  0.8697822878819624
Bond Position:  [-80.66372979]


portfolio before change:  [13.09841615]
curr_Stock_Price:  107.80535416105316
curr_Factors:  [107.80535416]
mat_Sqrt:  [[0.15]]
grads:  [-0.08360289]
Stock Position:  -0.08360289147290643
Bond Position:  [22.11125548]


portfolio before change:  [13.0724843]
curr_Stock_Price:  108.1320635835208
curr_Factors:  [108.13206358]
mat_Sqrt:  [[0.15]]
grads:  [0.00513255]
Stock Position:  0.005132553251771406
Bond Position:  [12.51749072]


portfolio before change:  [13.0734769]
curr_Stock_Price:  108.17302426787806
curr_Factors:  [108.17302427]
mat_Sqrt:  [[0.15]]
grads:  [0.04637659]
Stock Position:  0.04637658663499712
Bond Position:  [8.05678127]


portfolio before change:  [13.05251069]
curr_Stock_Price:  107.71008010591945
curr_Factors:  [107.71008011]
mat_Sqrt:  [[0.15]]
grads:  [0.10451084]
Stock Position:  0.10451084153399784
Bond Position:  [1.79563958]


portfolio before change:  [13.10494]
curr_Stock_Price:  108.21067001074067
curr_Factors:  [108.21067001]
mat_Sqrt:  [[0.15]]
grads:  [-0.21119957]
Stock Position:  -0.2111995732592105
Bond Position:  [35.95898732]


portfolio before change:  [13.10484727]
curr_Stock_Price:  108.22175069326518
curr_Factors:  [108.22175069]
mat_Sqrt:  [[0.15]]
grads:  [-0.0527315]
Stock Position:  -0.052731497971330414
Bond Position:  [18.81154229]


portfolio before change:  [13.14786599]
curr_Stock_Price:  107.42824080811519
curr_Factors:  [107.42824081]
mat_Sqrt:  [[0.15]]
grads:  [-0.03347091]
Stock Position:  -0.03347091421059661
Bond Position:  [16.74358742]


portfolio before change:  [13.15287298]
curr_Stock_Price:  107.30991471975857
curr_Factors:  [107.30991472]
mat_Sqrt:  [[0.15]]
grads:  [0.09639078]
Stock Position:  0.09639077835557722
Bond Position:  [2.80918677]


portfolio before change:  [13.20312501]
curr_Stock_Price:  107.82942966988882
curr_Factors:  [107.82942967]
mat_Sqrt:  [[0.15]]
grads:  [0.02750019]
Stock Position:  0.027500191332538566
Bond Position:  [10.23779506]


portfolio before change:  [13.23177145]
curr_Stock_Price:  108.84784271950245
curr_Factors:  [108.84784272]
mat_Sqrt:  [[0.15]]
grads:  [-0.01998437]
Stock Position:  -0.019984368467066867
Bond Position:  [15.40702684]


portfolio before change:  [13.21654656]
curr_Stock_Price:  109.6578685958511
curr_Factors:  [109.6578686]
mat_Sqrt:  [[0.15]]
grads:  [0.05984203]
Stock Position:  0.059842032274827324
Bond Position:  [6.65439685]


portfolio before change:  [13.25653153]
curr_Stock_Price:  110.31909373799245
curr_Factors:  [110.31909374]
mat_Sqrt:  [[0.15]]
grads:  [-0.01818955]
Stock Position:  -0.018189545500392583
Bond Position:  [15.2631857]


portfolio before change:  [13.25301281]
curr_Stock_Price:  110.56498730207893
curr_Factors:  [110.5649873]
mat_Sqrt:  [[0.15]]
grads:  [-0.00175122]
Stock Position:  -0.0017512167996108832
Bond Position:  [13.44663608]


portfolio before change:  [13.25404861]
curr_Stock_Price:  110.45343154117914
curr_Factors:  [110.45343154]
mat_Sqrt:  [[0.15]]
grads:  [0.21162924]
Stock Position:  0.21162924408437755
Bond Position:  [-10.12112761]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.25404861]
Stock Price:  111.63662587880602
PL:  [1.61742274]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-2.07097829e-02]
 [ 1.76974380e-02]
 [ 3.24377626e-03]
 [-1.44790529e-03]
 [-1.03786959e-02]
 [ 8.82104168e-03]
 [ 4.97111848e-04]
 [ 1.29806830e-02]
 [ 1.78765724e-02]
 [-1.43649825e-02]
 [ 6.11675664e-03]
 [-5.61661101e-03]
 [-7.81573656e-03]
 [ 4.25906528e-03]
 [ 5.80510924e-03]
 [-6.07408618e-03]
 [ 1.46305278e-02]
 [ 2.31774039e-02]
 [ 1.91728333e-02]
 [ 9.00007590e-03]
 [ 5.79061072e-02]
 [-1.38054227e-02]
 [ 5.61509685e-03]
 [ 1.17853278e-03]
 [ 1.68378148e-02]
 [ 1.71894425e-02]
 [ 1.13408218e-02]
 [ 6.84840398e-03]
 [ 5.44291891e-03]
 [-1.20224036e-02]
 [-5.68296839e-03]
 [ 4.03000054e-02]
 [ 5.82907084e-03]
 [-5.03524822e-03]
 [-6.28037065e-03]
 [-3.99830307e-03]
 [-4.49786076e-03]
 [ 3.13964303e-03]
 [ 2.15218062e-03]
 [-8.36973284e-03]
 [-4.36374930e-02]
 [-3.91862491e-03]
 [ 1.30778166e-02]
 [-1.22765498e-02]
 [-6.59876827e-04]
 [ 2.46436837e-03]
 [-1.36251859e-02]
 [ 4.94968476e-03]
 [ 6.03678369e-03]
 [-9.16508242e-03]
 [-3.26963987e-03]
 [ 3.73419369e-03]
 [ 1.67385648e-04]
 [ 3.16563651e-03]
 [-2.73650122e-03]
 [ 8.51153672e-03]
 [-7.39870588e-03]
 [-1.28355484e-02]
 [ 1.48349624e-02]
 [ 3.04205846e-03]
 [ 1.12465881e-02]
 [-1.52152255e-02]
 [-1.27410201e-02]
 [-2.86321883e-03]
 [-1.98521843e-02]
 [ 2.92322792e-03]
 [ 2.93365995e-02]
 [ 1.73429133e-03]
 [ 6.36581447e-03]
 [-1.39482789e-02]
 [-8.16871007e-03]
 [-5.92265485e-03]
 [ 2.18420197e-03]
 [ 8.56049789e-03]
 [ 6.75455908e-03]
 [-9.20568326e-03]
 [ 8.53454399e-04]
 [-7.13661856e-03]
 [ 1.18632630e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.06012625]
curr_Stock_Price:  98.9635344719868
curr_Factors:  [98.96353447]
mat_Sqrt:  [[0.15]]
grads:  [-0.13806522]
Stock Position:  -0.1380652193384407
Bond Position:  [-0.39670416]


portfolio before change:  [-13.88788291]
curr_Stock_Price:  97.71580431141678
curr_Factors:  [97.71580431]
mat_Sqrt:  [[0.15]]
grads:  [0.11798292]
Stock Position:  0.11798292002271493
Bond Position:  [-25.41667884]


portfolio before change:  [-13.85532915]
curr_Stock_Price:  98.00518814485135
curr_Factors:  [98.00518814]
mat_Sqrt:  [[0.15]]
grads:  [0.02162518]
Stock Position:  0.02162517507880258
Bond Position:  [-15.97470851]


portfolio before change:  [-13.84435691]
curr_Stock_Price:  98.55874162310434
curr_Factors:  [98.55874162]
mat_Sqrt:  [[0.15]]
grads:  [-0.0096527]
Stock Position:  -0.009652701930145655
Bond Position:  [-12.89299876]


portfolio before change:  [-13.84998216]
curr_Stock_Price:  99.05802207784903
curr_Factors:  [99.05802208]
mat_Sqrt:  [[0.15]]
grads:  [-0.06919131]
Stock Position:  -0.0691913058444613
Bond Position:  [-6.99602825]


portfolio before change:  [-13.85452817]
curr_Stock_Price:  99.11740452195862
curr_Factors:  [99.11740452]
mat_Sqrt:  [[0.15]]
grads:  [0.05880694]
Stock Position:  0.058806944532490545
Bond Position:  [-19.68331988]


portfolio before change:  [-13.84659494]
curr_Stock_Price:  99.27322748993649
curr_Factors:  [99.27322749]
mat_Sqrt:  [[0.15]]
grads:  [0.00331408]
Stock Position:  0.003314078989829728
Bond Position:  [-14.17559426]


portfolio before change:  [-13.84662868]
curr_Stock_Price:  99.53039291838179
curr_Factors:  [99.53039292]
mat_Sqrt:  [[0.15]]
grads:  [0.08653789]
Stock Position:  0.0865378864412518
Bond Position:  [-22.45977852]


portfolio before change:  [-13.88369907]
curr_Stock_Price:  99.11824263938858
curr_Factors:  [99.11824264]
mat_Sqrt:  [[0.15]]
grads:  [0.11917715]
Stock Position:  0.1191771493560129
Bond Position:  [-25.69632868]


portfolio before change:  [-13.91755731]
curr_Stock_Price:  98.84761887067411
curr_Factors:  [98.84761887]
mat_Sqrt:  [[0.15]]
grads:  [-0.09576655]
Stock Position:  -0.09576655030875862
Bond Position:  [-4.45126185]


portfolio before change:  [-13.95606779]
curr_Stock_Price:  99.24684243907093
curr_Factors:  [99.24684244]
mat_Sqrt:  [[0.15]]
grads:  [0.04077838]
Stock Position:  0.04077837759590829
Bond Position:  [-18.00319301]


portfolio before change:  [-13.95058945]
curr_Stock_Price:  99.40878050245264
curr_Factors:  [99.4087805]
mat_Sqrt:  [[0.15]]
grads:  [-0.03744407]
Stock Position:  -0.037444073394902515
Bond Position:  [-10.22831978]


portfolio before change:  [-13.95038382]
curr_Stock_Price:  99.38621563703693
curr_Factors:  [99.38621564]
mat_Sqrt:  [[0.15]]
grads:  [-0.05210491]
Stock Position:  -0.052104910414071115
Bond Position:  [-8.77187396]


portfolio before change:  [-13.99687345]
curr_Stock_Price:  100.26792464873131
curr_Factors:  [100.26792465]
mat_Sqrt:  [[0.15]]
grads:  [0.02839377]
Stock Position:  0.02839376854772659
Bond Position:  [-16.8438577]


portfolio before change:  [-13.99926869]
curr_Stock_Price:  100.22064443110811
curr_Factors:  [100.22064443]
mat_Sqrt:  [[0.15]]
grads:  [0.03870073]
Stock Position:  0.038700728297218004
Bond Position:  [-17.87788062]


portfolio before change:  [-13.99002948]
curr_Stock_Price:  100.48825205719177
curr_Factors:  [100.48825206]
mat_Sqrt:  [[0.15]]
grads:  [-0.04049391]
Stock Position:  -0.04049390786953366
Bond Position:  [-9.92086746]


portfolio before change:  [-14.00107893]
curr_Stock_Price:  100.74580633963038
curr_Factors:  [100.74580634]
mat_Sqrt:  [[0.15]]
grads:  [0.09753685]
Stock Position:  0.09753685222007104
Bond Position:  [-23.82750776]


portfolio before change:  [-13.92252515]
curr_Stock_Price:  101.56645049230383
curr_Factors:  [101.56645049]
mat_Sqrt:  [[0.15]]
grads:  [0.15451603]
Stock Position:  0.15451602606258505
Bond Position:  [-29.61616946]


portfolio before change:  [-13.99581454]
curr_Stock_Price:  101.10411447936214
curr_Factors:  [101.10411448]
mat_Sqrt:  [[0.15]]
grads:  [0.12781889]
Stock Position:  0.1278188887250933
Bond Position:  [-26.9188301]


portfolio before change:  [-14.16435444]
curr_Stock_Price:  99.79869379959571
curr_Factors:  [99.7986938]
mat_Sqrt:  [[0.15]]
grads:  [0.06000051]
Stock Position:  0.0600005059930379
Bond Position:  [-20.15232657]


portfolio before change:  [-14.18295137]
curr_Stock_Price:  99.50974011216596
curr_Factors:  [99.50974011]
mat_Sqrt:  [[0.15]]
grads:  [0.38604071]
Stock Position:  0.3860407148152747
Bond Position:  [-52.59776258]


portfolio before change:  [-13.93742823]
curr_Stock_Price:  100.15425917794721
curr_Factors:  [100.15425918]
mat_Sqrt:  [[0.15]]
grads:  [-0.09203615]
Stock Position:  -0.09203615144839872
Bond Position:  [-4.71961567]


portfolio before change:  [-14.03125083]
curr_Stock_Price:  101.17046435370175
curr_Factors:  [101.17046435]
mat_Sqrt:  [[0.15]]
grads:  [0.03743398]
Stock Position:  0.0374339789992557
Bond Position:  [-17.81846387]


portfolio before change:  [-14.03178391]
curr_Stock_Price:  101.18597468676151
curr_Factors:  [101.18597469]
mat_Sqrt:  [[0.15]]
grads:  [0.00785689]
Stock Position:  0.007856885221254294
Bond Position:  [-14.8267905]


portfolio before change:  [-14.02797502]
curr_Stock_Price:  101.7887059470326
curr_Factors:  [101.78870595]
mat_Sqrt:  [[0.15]]
grads:  [0.1122521]
Stock Position:  0.11225209865287476
Bond Position:  [-25.45397088]


portfolio before change:  [-14.02373676]
curr_Stock_Price:  101.84063531666276
curr_Factors:  [101.84063532]
mat_Sqrt:  [[0.15]]
grads:  [0.11459628]
Stock Position:  0.11459628345688304
Bond Position:  [-25.69429507]


portfolio before change:  [-14.03396115]
curr_Stock_Price:  101.76542827011703
curr_Factors:  [101.76542827]
mat_Sqrt:  [[0.15]]
grads:  [0.07560548]
Stock Position:  0.07560547891420386
Bond Position:  [-21.7279851]


portfolio before change:  [-14.02875421]
curr_Stock_Price:  101.85226041121379
curr_Factors:  [101.85226041]
mat_Sqrt:  [[0.15]]
grads:  [0.04565603]
Stock Position:  0.04565602656054114
Bond Position:  [-18.67892372]


portfolio before change:  [-14.01714405]
curr_Stock_Price:  102.13212781989299
curr_Factors:  [102.13212782]
mat_Sqrt:  [[0.15]]
grads:  [0.03628613]
Stock Position:  0.03628612604322072
Bond Position:  [-17.72312331]


portfolio before change:  [-13.9872206]
curr_Stock_Price:  102.98730805895998
curr_Factors:  [102.98730806]
mat_Sqrt:  [[0.15]]
grads:  [-0.08014936]
Stock Position:  -0.08014935762740287
Bond Position:  [-5.73285401]


portfolio before change:  [-13.93729796]
curr_Stock_Price:  102.35996734322522
curr_Factors:  [102.35996734]
mat_Sqrt:  [[0.15]]
grads:  [-0.03788646]
Stock Position:  -0.03788645594495249
Bond Position:  [-10.05924156]


portfolio before change:  [-13.97851933]
curr_Stock_Price:  103.43139651121272
curr_Factors:  [103.43139651]
mat_Sqrt:  [[0.15]]
grads:  [0.2686667]
Stock Position:  0.26866670249828456
Bond Position:  [-41.76709157]


portfolio before change:  [-14.05225273]
curr_Stock_Price:  103.16667120370958
curr_Factors:  [103.1666712]
mat_Sqrt:  [[0.15]]
grads:  [0.03886047]
Stock Position:  0.03886047227252916
Bond Position:  [-18.0613583]


portfolio before change:  [-14.05143592]
curr_Stock_Price:  103.21673974872006
curr_Factors:  [103.21673975]
mat_Sqrt:  [[0.15]]
grads:  [-0.03356832]
Stock Position:  -0.033568321452889696
Bond Position:  [-10.58662322]


portfolio before change:  [-14.05390169]
curr_Stock_Price:  103.27048359151276
curr_Factors:  [103.27048359]
mat_Sqrt:  [[0.15]]
grads:  [-0.04186914]
Stock Position:  -0.041869137646938705
Bond Position:  [-9.7300556]


portfolio before change:  [-14.05744284]
curr_Stock_Price:  103.34053533825444
curr_Factors:  [103.34053534]
mat_Sqrt:  [[0.15]]
grads:  [-0.02665535]
Stock Position:  -0.02665535382847731
Bond Position:  [-11.30286431]


portfolio before change:  [-14.06757559]
curr_Stock_Price:  103.69417135279916
curr_Factors:  [103.69417135]
mat_Sqrt:  [[0.15]]
grads:  [-0.02998574]
Stock Position:  -0.029985738377582352
Bond Position:  [-10.9582293]


portfolio before change:  [-14.05312089]
curr_Stock_Price:  103.18927766477628
curr_Factors:  [103.18927766]
mat_Sqrt:  [[0.15]]
grads:  [0.02093095]
Stock Position:  0.0209309535660589
Bond Position:  [-16.21297087]


portfolio before change:  [-14.06541764]
curr_Stock_Price:  102.65019998854376
curr_Factors:  [102.65019999]
mat_Sqrt:  [[0.15]]
grads:  [0.01434787]
Stock Position:  0.014347870766848875
Bond Position:  [-15.53822945]


portfolio before change:  [-14.06664774]
curr_Stock_Price:  102.63215349924447
curr_Factors:  [102.6321535]
mat_Sqrt:  [[0.15]]
grads:  [-0.05579822]
Stock Position:  -0.05579821891675945
Bond Position:  [-8.33995637]


portfolio before change:  [-14.12611266]
curr_Stock_Price:  103.68852510947667
curr_Factors:  [103.68852511]
mat_Sqrt:  [[0.15]]
grads:  [-0.29091662]
Stock Position:  -0.2909166201797663
Bond Position:  [16.03860262]


portfolio before change:  [-14.29196677]
curr_Stock_Price:  104.26207967878027
curr_Factors:  [104.26207968]
mat_Sqrt:  [[0.15]]
grads:  [-0.02612417]
Stock Position:  -0.02612416604148895
Bond Position:  [-11.56820689]


portfolio before change:  [-14.26122043]
curr_Stock_Price:  103.05747198690445
curr_Factors:  [103.05747199]
mat_Sqrt:  [[0.15]]
grads:  [0.08718544]
Stock Position:  0.08718544426790469
Bond Position:  [-23.24633192]


portfolio before change:  [-14.25365039]
curr_Stock_Price:  103.16096389312506
curr_Factors:  [103.16096389]
mat_Sqrt:  [[0.15]]
grads:  [-0.08184367]
Stock Position:  -0.08184366550273815
Bond Position:  [-5.81057897]


portfolio before change:  [-14.22832744]
curr_Stock_Price:  102.84712014976502
curr_Factors:  [102.84712015]
mat_Sqrt:  [[0.15]]
grads:  [-0.00439918]
Stock Position:  -0.00439917884990798
Bond Position:  [-13.77588456]


portfolio before change:  [-14.23139558]
curr_Stock_Price:  103.34883338735543
curr_Factors:  [103.34883339]
mat_Sqrt:  [[0.15]]
grads:  [0.01642912]
Stock Position:  0.016429122457507172
Bond Position:  [-15.92932622]


portfolio before change:  [-14.2324867]
curr_Stock_Price:  103.3430205930046
curr_Factors:  [103.34302059]
mat_Sqrt:  [[0.15]]
grads:  [-0.09083457]
Stock Position:  -0.09083457242949773
Bond Position:  [-4.84536761]


portfolio before change:  [-14.23301602]
curr_Stock_Price:  103.34551386763813
curr_Factors:  [103.34551387]
mat_Sqrt:  [[0.15]]
grads:  [0.0329979]
Stock Position:  0.03299789841577696
Bond Position:  [-17.64320079]


portfolio before change:  [-14.2448141]
curr_Stock_Price:  103.02139179797621
curr_Factors:  [103.0213918]
mat_Sqrt:  [[0.15]]
grads:  [0.04024522]
Stock Position:  0.04024522457209203
Bond Position:  [-18.39093315]


portfolio before change:  [-14.22959413]
curr_Stock_Price:  103.42813419388885
curr_Factors:  [103.42813419]
mat_Sqrt:  [[0.15]]
grads:  [-0.06110055]
Stock Position:  -0.061100549467186786
Bond Position:  [-7.9100783]


portfolio before change:  [-14.16472841]
curr_Stock_Price:  102.35842014270871
curr_Factors:  [102.35842014]
mat_Sqrt:  [[0.15]]
grads:  [-0.0217976]
Stock Position:  -0.02179759915782045
Bond Position:  [-11.9335606]


portfolio before change:  [-14.14843394]
curr_Stock_Price:  101.5766669930362
curr_Factors:  [101.57666699]
mat_Sqrt:  [[0.15]]
grads:  [0.02489462]
Stock Position:  0.02489462459516962
Bond Position:  [-16.67714693]


portfolio before change:  [-14.14852034]
curr_Stock_Price:  101.61506683808344
curr_Factors:  [101.61506684]
mat_Sqrt:  [[0.15]]
grads:  [0.0011159]
Stock Position:  0.0011159043217805575
Bond Position:  [-14.26191303]


portfolio before change:  [-14.1485604]
curr_Stock_Price:  102.37797820371814
curr_Factors:  [102.3779782]
mat_Sqrt:  [[0.15]]
grads:  [0.02110424]
Stock Position:  0.02110424342551089
Bond Position:  [-16.30917018]


portfolio before change:  [-14.14448893]
curr_Stock_Price:  102.61920130652969
curr_Factors:  [102.61920131]
mat_Sqrt:  [[0.15]]
grads:  [-0.01824334]
Stock Position:  -0.018243341468209887
Bond Position:  [-12.2723718]


portfolio before change:  [-14.13142553]
curr_Stock_Price:  101.86109231692181
curr_Factors:  [101.86109232]
mat_Sqrt:  [[0.15]]
grads:  [0.05674358]
Stock Position:  0.05674357811800375
Bond Position:  [-19.91138838]


portfolio before change:  [-14.09871935]
curr_Stock_Price:  102.4594100052144
curr_Factors:  [102.45941001]
mat_Sqrt:  [[0.15]]
grads:  [-0.04932471]
Stock Position:  -0.049324705895604566
Bond Position:  [-9.04493908]


portfolio before change:  [-14.10221909]
curr_Stock_Price:  102.51890187482407
curr_Factors:  [102.51890187]
mat_Sqrt:  [[0.15]]
grads:  [-0.08557032]
Stock Position:  -0.08557032253795142
Bond Position:  [-5.32964359]


portfolio before change:  [-14.14585857]
curr_Stock_Price:  103.02499283053608
curr_Factors:  [103.02499283]
mat_Sqrt:  [[0.15]]
grads:  [0.09889975]
Stock Position:  0.09889974932741184
Bond Position:  [-24.33500454]


portfolio before change:  [-14.19475379]
curr_Stock_Price:  102.54598017419445
curr_Factors:  [102.54598017]
mat_Sqrt:  [[0.15]]
grads:  [0.02028039]
Stock Position:  0.02028038975478743
Bond Position:  [-16.27442624]


portfolio before change:  [-14.19530341]
curr_Stock_Price:  102.56903486873183
curr_Factors:  [102.56903487]
mat_Sqrt:  [[0.15]]
grads:  [0.07497725]
Stock Position:  0.07497725388530495
Bond Position:  [-21.88564798]


portfolio before change:  [-14.12833712]
curr_Stock_Price:  103.48043384089954
curr_Factors:  [103.48043384]
mat_Sqrt:  [[0.15]]
grads:  [-0.10143484]
Stock Position:  -0.10143483697741308
Bond Position:  [-3.63181618]


portfolio before change:  [-14.08902447]
curr_Stock_Price:  103.09063047917688
curr_Factors:  [103.09063048]
mat_Sqrt:  [[0.15]]
grads:  [-0.08494013]
Stock Position:  -0.08494013379903965
Bond Position:  [-5.33249253]


portfolio before change:  [-13.98204036]
curr_Stock_Price:  101.82718286830936
curr_Factors:  [101.82718287]
mat_Sqrt:  [[0.15]]
grads:  [-0.01908813]
Stock Position:  -0.01908812554826079
Bond Position:  [-12.0383503]


portfolio before change:  [-13.97119684]
curr_Stock_Price:  101.21968814157368
curr_Factors:  [101.21968814]
mat_Sqrt:  [[0.15]]
grads:  [-0.1323479]
Stock Position:  -0.1323478953287408
Bond Position:  [-0.57498415]


portfolio before change:  [-14.06284747]
curr_Stock_Price:  101.91191442490273
curr_Factors:  [101.91191442]
mat_Sqrt:  [[0.15]]
grads:  [0.01948819]
Stock Position:  0.019488186100540237
Bond Position:  [-16.04892582]


portfolio before change:  [-14.05840504]
curr_Stock_Price:  102.19134127064702
curr_Factors:  [102.19134127]
mat_Sqrt:  [[0.15]]
grads:  [0.19557733]
Stock Position:  0.19557732976264092
Bond Position:  [-34.04471469]


portfolio before change:  [-14.16063651]
curr_Stock_Price:  101.67950477050107
curr_Factors:  [101.67950477]
mat_Sqrt:  [[0.15]]
grads:  [0.01156194]
Stock Position:  0.011561942217237938
Bond Position:  [-15.33624907]


portfolio before change:  [-14.16111284]
curr_Stock_Price:  101.72121237237128
curr_Factors:  [101.72121237]
mat_Sqrt:  [[0.15]]
grads:  [0.04243876]
Stock Position:  0.042438763108202486
Bond Position:  [-18.47803527]


portfolio before change:  [-14.18923723]
curr_Stock_Price:  101.08572078658676
curr_Factors:  [101.08572079]
mat_Sqrt:  [[0.15]]
grads:  [-0.09298853]
Stock Position:  -0.09298852625573423
Bond Position:  [-4.78942503]


portfolio before change:  [-14.24638128]
curr_Stock_Price:  101.69702954432105
curr_Factors:  [101.69702954]
mat_Sqrt:  [[0.15]]
grads:  [-0.05445807]
Stock Position:  -0.054458067122594156
Bond Position:  [-8.70815762]


portfolio before change:  [-14.23937278]
curr_Stock_Price:  101.55833979638001
curr_Factors:  [101.5583398]
mat_Sqrt:  [[0.15]]
grads:  [-0.03948437]
Stock Position:  -0.03948436568636328
Bond Position:  [-10.22940615]


portfolio before change:  [-14.2318205]
curr_Stock_Price:  101.35087458998909
curr_Factors:  [101.35087459]
mat_Sqrt:  [[0.15]]
grads:  [0.01456135]
Stock Position:  0.014561346474267767
Bond Position:  [-15.7076257]


portfolio before change:  [-14.2388168]
curr_Stock_Price:  100.9378265156536
curr_Factors:  [100.93782652]
mat_Sqrt:  [[0.15]]
grads:  [0.05706999]
Stock Position:  0.057069985931135284
Bond Position:  [-19.99933714]


portfolio before change:  [-14.22779364]
curr_Stock_Price:  101.1528810511223
curr_Factors:  [101.15288105]
mat_Sqrt:  [[0.15]]
grads:  [0.04503039]
Stock Position:  0.045030393880535285
Bond Position:  [-18.78274771]


portfolio before change:  [-14.24944466]
curr_Stock_Price:  100.69814218840575
curr_Factors:  [100.69814219]
mat_Sqrt:  [[0.15]]
grads:  [-0.06137122]
Stock Position:  -0.061371221737709696
Bond Position:  [-8.06947665]


portfolio before change:  [-14.26632383]
curr_Stock_Price:  100.96495797143074
curr_Factors:  [100.96495797]
mat_Sqrt:  [[0.15]]
grads:  [0.0056897]
Stock Position:  0.005689695991801073
Bond Position:  [-14.84078375]


portfolio before change:  [-14.26584357]
curr_Stock_Price:  101.21239529842367
curr_Factors:  [101.2123953]
mat_Sqrt:  [[0.15]]
grads:  [-0.04757746]
Stock Position:  -0.04757745704493944
Bond Position:  [-9.45041518]


portfolio before change:  [-14.26864731]
curr_Stock_Price:  101.25891047510092
curr_Factors:  [101.25891048]
mat_Sqrt:  [[0.15]]
grads:  [0.07908842]
Stock Position:  0.07908841968589177
Bond Position:  [-22.27705452]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.26864731]
Stock Price:  101.87097621330537
PL:  [-16.13962352]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.48822654e-02]
 [-1.09722876e-03]
 [ 7.47993101e-03]
 [ 2.72976904e-03]
 [ 5.01411188e-03]
 [ 1.19807590e-02]
 [-8.65688035e-04]
 [ 7.12915390e-03]
 [-1.00129415e-02]
 [ 3.61916877e-03]
 [ 9.97908289e-03]
 [-1.12088122e-02]
 [ 3.49482641e-02]
 [ 2.99287627e-02]
 [-1.45713890e-02]
 [-6.41027291e-03]
 [ 1.62163384e-02]
 [ 2.39852157e-02]
 [-5.95486122e-03]
 [-2.21841548e-03]
 [ 1.32309401e-02]
 [-1.04637275e-02]
 [ 3.33661663e-04]
 [-3.67932502e-03]
 [ 1.66760157e-02]
 [ 1.20045148e-02]
 [ 1.16758181e-02]
 [ 6.53501593e-04]
 [ 3.02702308e-03]
 [-2.50119476e-02]
 [-4.03580915e-03]
 [-1.67857021e-02]
 [ 1.42825201e-02]
 [ 9.63959390e-03]
 [ 2.11224047e-03]
 [-4.10488496e-04]
 [-4.65763048e-03]
 [ 1.33809366e-02]
 [-2.11603753e-03]
 [-1.39205520e-02]
 [-1.19508858e-03]
 [-1.77640330e-03]
 [ 4.86741239e-03]
 [-1.19504581e-02]
 [ 2.41003207e-03]
 [ 1.10870049e-03]
 [-1.36787152e-02]
 [-7.05645489e-05]
 [ 4.43247303e-03]
 [-4.84290522e-03]
 [-3.15035894e-03]
 [ 3.72180198e-03]
 [ 2.89402268e-04]
 [ 2.30784309e-03]
 [ 8.83619279e-04]
 [ 8.67096279e-03]
 [-3.90532678e-03]
 [-8.03637763e-03]
 [ 1.82286128e-02]
 [-3.49744494e-03]
 [ 1.30128761e-02]
 [-1.44753300e-02]
 [-1.27153679e-02]
 [-2.90501269e-03]
 [ 6.54675137e-02]
 [-1.63369902e-02]
 [ 1.30884495e-02]
 [ 5.39066334e-03]
 [ 1.20193847e-02]
 [-2.32915477e-02]
 [-7.86608253e-03]
 [-7.13761373e-03]
 [ 5.44156847e-03]
 [ 7.30643070e-03]
 [-7.68364549e-04]
 [-5.35349675e-03]
 [ 8.87126936e-03]
 [-3.89037262e-03]
 [ 2.40088122e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.29398405]
curr_Stock_Price:  100.27170656682947
curr_Factors:  [100.27170657]
mat_Sqrt:  [[0.15]]
grads:  [-0.2992151]
Stock Position:  -0.2992151027850914
Bond Position:  [36.29679304]


portfolio before change:  [6.2062747]
curr_Stock_Price:  100.57241990492244
curr_Factors:  [100.5724199]
mat_Sqrt:  [[0.15]]
grads:  [-0.00731486]
Stock Position:  -0.007314858394307358
Bond Position:  [6.94194771]


portfolio before change:  [6.20068201]
curr_Stock_Price:  101.39630104587451
curr_Factors:  [101.39630105]
mat_Sqrt:  [[0.15]]
grads:  [0.04986621]
Stock Position:  0.049866206713891775
Bond Position:  [1.1444331]


portfolio before change:  [6.18963738]
curr_Stock_Price:  101.1733813388203
curr_Factors:  [101.17338134]
mat_Sqrt:  [[0.15]]
grads:  [0.01819846]
Stock Position:  0.018198460256797132
Bond Position:  [4.34843762]


portfolio before change:  [6.18652798]
curr_Stock_Price:  100.9875863250428
curr_Factors:  [100.98758633]
mat_Sqrt:  [[0.15]]
grads:  [0.03342741]
Stock Position:  0.0334274125315601
Bond Position:  [2.81077427]


portfolio before change:  [6.19064902]
curr_Stock_Price:  101.10561398247074
curr_Factors:  [101.10561398]
mat_Sqrt:  [[0.15]]
grads:  [0.07987173]
Stock Position:  0.07987172658217667
Bond Position:  [-1.88483094]


portfolio before change:  [6.29507489]
curr_Stock_Price:  102.41450868490179
curr_Factors:  [102.41450868]
mat_Sqrt:  [[0.15]]
grads:  [-0.00577125]
Stock Position:  -0.005771253569439093
Bond Position:  [6.88613499]


portfolio before change:  [6.29863036]
curr_Stock_Price:  101.87301926072175
curr_Factors:  [101.87301926]
mat_Sqrt:  [[0.15]]
grads:  [0.04752769]
Stock Position:  0.047527692647662455
Bond Position:  [1.45684081]


portfolio before change:  [6.3020644]
curr_Stock_Price:  101.94335680943291
curr_Factors:  [101.94335681]
mat_Sqrt:  [[0.15]]
grads:  [-0.06675294]
Stock Position:  -0.0667529431657588
Bond Position:  [13.1070835]


portfolio before change:  [6.28784603]
curr_Stock_Price:  102.16862912234735
curr_Factors:  [102.16862912]
mat_Sqrt:  [[0.15]]
grads:  [0.02412779]
Stock Position:  0.02412779180794189
Bond Position:  [3.82274262]


portfolio before change:  [6.28281753]
curr_Stock_Price:  101.95031554913942
curr_Factors:  [101.95031555]
mat_Sqrt:  [[0.15]]
grads:  [0.06652722]
Stock Position:  0.06652721928079161
Bond Position:  [-0.49965347]


portfolio before change:  [6.31681844]
curr_Stock_Price:  102.46186768758055
curr_Factors:  [102.46186769]
mat_Sqrt:  [[0.15]]
grads:  [-0.07472541]
Stock Position:  -0.07472541496202131
Bond Position:  [13.97332403]


portfolio before change:  [6.26195796]
curr_Stock_Price:  103.20771631535732
curr_Factors:  [103.20771632]
mat_Sqrt:  [[0.15]]
grads:  [0.23298843]
Stock Position:  0.23298842720428717
Bond Position:  [-17.78424554]


portfolio before change:  [6.43086858]
curr_Stock_Price:  103.93746147520353
curr_Factors:  [103.93746148]
mat_Sqrt:  [[0.15]]
grads:  [0.19952508]
Stock Position:  0.1995250847806502
Bond Position:  [-14.30726223]


portfolio before change:  [6.5575245]
curr_Stock_Price:  104.57673022378277
curr_Factors:  [104.57673022]
mat_Sqrt:  [[0.15]]
grads:  [-0.09714259]
Stock Position:  -0.097142593139775
Bond Position:  [16.71637926]


portfolio before change:  [6.6186388]
curr_Stock_Price:  103.9583661658278
curr_Factors:  [103.95836617]
mat_Sqrt:  [[0.15]]
grads:  [-0.04273515]
Stock Position:  -0.042735152716258315
Bond Position:  [11.06131545]


portfolio before change:  [6.62022743]
curr_Stock_Price:  103.93736977636624
curr_Factors:  [103.93736978]
mat_Sqrt:  [[0.15]]
grads:  [0.10810892]
Stock Position:  0.10810892288855202
Bond Position:  [-4.61632966]


portfolio before change:  [6.55745679]
curr_Stock_Price:  103.35941460046186
curr_Factors:  [103.3594146]
mat_Sqrt:  [[0.15]]
grads:  [0.15990144]
Stock Position:  0.1599014377530597
Bond Position:  [-9.96986221]


portfolio before change:  [6.6052939]
curr_Stock_Price:  103.66247778503283
curr_Factors:  [103.66247779]
mat_Sqrt:  [[0.15]]
grads:  [-0.03969907]
Stock Position:  -0.03969907478895152
Bond Position:  [10.72059836]


portfolio before change:  [6.63803635]
curr_Stock_Price:  102.85459015322316
curr_Factors:  [102.85459015]
mat_Sqrt:  [[0.15]]
grads:  [-0.01478944]
Stock Position:  -0.01478943654947953
Bond Position:  [8.15919778]


portfolio before change:  [6.62301474]
curr_Stock_Price:  103.90477008967635
curr_Factors:  [103.90477009]
mat_Sqrt:  [[0.15]]
grads:  [0.08820627]
Stock Position:  0.08820626718250023
Bond Position:  [-2.54203717]


portfolio before change:  [6.59635969]
curr_Stock_Price:  103.6043813130637
curr_Factors:  [103.60438131]
mat_Sqrt:  [[0.15]]
grads:  [-0.06975818]
Stock Position:  -0.06975818348008928
Bond Position:  [13.82361313]


portfolio before change:  [6.60292044]
curr_Stock_Price:  103.52271701655015
curr_Factors:  [103.52271702]
mat_Sqrt:  [[0.15]]
grads:  [0.00222441]
Stock Position:  0.0022244110893826037
Bond Position:  [6.37264336]


portfolio before change:  [6.60091071]
curr_Stock_Price:  102.44016693412814
curr_Factors:  [102.44016693]
mat_Sqrt:  [[0.15]]
grads:  [-0.02452883]
Stock Position:  -0.024528833448992968
Bond Position:  [9.1136485]


portfolio before change:  [6.62028124]
curr_Stock_Price:  101.67368475595211
curr_Factors:  [101.67368476]
mat_Sqrt:  [[0.15]]
grads:  [0.11117344]
Stock Position:  0.11117343801039344
Bond Position:  [-4.68313184]


portfolio before change:  [6.59792155]
curr_Stock_Price:  101.47519320303479
curr_Factors:  [101.4751932]
mat_Sqrt:  [[0.15]]
grads:  [0.0800301]
Stock Position:  0.0800300983455686
Bond Position:  [-1.52314814]


portfolio before change:  [6.6038037]
curr_Stock_Price:  101.54988195461773
curr_Factors:  [101.54988195]
mat_Sqrt:  [[0.15]]
grads:  [0.07783879]
Stock Position:  0.07783878716764245
Bond Position:  [-1.30071595]


portfolio before change:  [6.53734488]
curr_Stock_Price:  100.69712555804699
curr_Factors:  [100.69712556]
mat_Sqrt:  [[0.15]]
grads:  [0.00435668]
Stock Position:  0.004356677285567203
Bond Position:  [6.09864]


portfolio before change:  [6.53519047]
curr_Stock_Price:  100.11512466882441
curr_Factors:  [100.11512467]
mat_Sqrt:  [[0.15]]
grads:  [0.02018015]
Stock Position:  0.020180153878685356
Bond Position:  [4.51485184]


portfolio before change:  [6.53841406]
curr_Stock_Price:  100.2608820372801
curr_Factors:  [100.26088204]
mat_Sqrt:  [[0.15]]
grads:  [-0.16674632]
Stock Position:  -0.16674631703991788
Bond Position:  [23.25654688]


portfolio before change:  [6.6863512]
curr_Stock_Price:  99.38240048857924
curr_Factors:  [99.38240049]
mat_Sqrt:  [[0.15]]
grads:  [-0.02690539]
Stock Position:  -0.026905394313818196
Bond Position:  [9.36027387]


portfolio before change:  [6.69110589]
curr_Stock_Price:  99.22742587878358
curr_Factors:  [99.22742588]
mat_Sqrt:  [[0.15]]
grads:  [-0.11190468]
Stock Position:  -0.11190468066310504
Bond Position:  [17.7951193]


portfolio before change:  [6.60662564]
curr_Stock_Price:  99.9922954216487
curr_Factors:  [99.99229542]
mat_Sqrt:  [[0.15]]
grads:  [0.0952168]
Stock Position:  0.09521680056728142
Bond Position:  [-2.91432081]


portfolio before change:  [6.71672586]
curr_Stock_Price:  101.15051926814033
curr_Factors:  [101.15051927]
mat_Sqrt:  [[0.15]]
grads:  [0.06426396]
Stock Position:  0.06426395934779872
Bond Position:  [0.216393]


portfolio before change:  [6.65764083]
curr_Stock_Price:  100.23089720613862
curr_Factors:  [100.23089721]
mat_Sqrt:  [[0.15]]
grads:  [0.0140816]
Stock Position:  0.014081603107306042
Bond Position:  [5.24622911]


portfolio before change:  [6.65752374]
curr_Stock_Price:  100.19929640408628
curr_Factors:  [100.1992964]
mat_Sqrt:  [[0.15]]
grads:  [-0.00273659]
Stock Position:  -0.002736589974795956
Bond Position:  [6.93172813]


portfolio before change:  [6.65757781]
curr_Stock_Price:  100.33785443375885
curr_Factors:  [100.33785443]
mat_Sqrt:  [[0.15]]
grads:  [-0.03105087]
Stock Position:  -0.03105086989105334
Bond Position:  [9.77315547]


portfolio before change:  [6.63943837]
curr_Stock_Price:  100.94171113695695
curr_Factors:  [100.94171114]
mat_Sqrt:  [[0.15]]
grads:  [0.08920624]
Stock Position:  0.08920624423825288
Bond Position:  [-2.36519257]


portfolio before change:  [6.61266362]
curr_Stock_Price:  100.64322390588245
curr_Factors:  [100.64322391]
mat_Sqrt:  [[0.15]]
grads:  [-0.01410692]
Stock Position:  -0.01410691686563996
Bond Position:  [8.03242921]


portfolio before change:  [6.62188662]
curr_Stock_Price:  100.02501954764267
curr_Factors:  [100.02501955]
mat_Sqrt:  [[0.15]]
grads:  [-0.09280368]
Stock Position:  -0.09280368000854639
Bond Position:  [15.90457652]


portfolio before change:  [6.61642933]
curr_Stock_Price:  100.09453568690905
curr_Factors:  [100.09453569]
mat_Sqrt:  [[0.15]]
grads:  [-0.00796726]
Stock Position:  -0.007967257230440117
Bond Position:  [7.41390824]


portfolio before change:  [6.62825001]
curr_Stock_Price:  98.66903926053251
curr_Factors:  [98.66903926]
mat_Sqrt:  [[0.15]]
grads:  [-0.01184269]
Stock Position:  -0.011842688649250852
Bond Position:  [7.79675672]


portfolio before change:  [6.61837975]
curr_Stock_Price:  99.54363582675839
curr_Factors:  [99.54363583]
mat_Sqrt:  [[0.15]]
grads:  [0.03244942]
Stock Position:  0.03244941592760969
Bond Position:  [3.38824691]


portfolio before change:  [6.6410993]
curr_Stock_Price:  100.23726237583745
curr_Factors:  [100.23726238]
mat_Sqrt:  [[0.15]]
grads:  [-0.07966972]
Stock Position:  -0.07966972035112137
Bond Position:  [14.62697396]


portfolio before change:  [6.63405985]
curr_Stock_Price:  100.33709536339339
curr_Factors:  [100.33709536]
mat_Sqrt:  [[0.15]]
grads:  [0.01606688]
Stock Position:  0.01606688044309964
Bond Position:  [5.02195573]


portfolio before change:  [6.64381354]
curr_Stock_Price:  100.92462766631924
curr_Factors:  [100.92462767]
mat_Sqrt:  [[0.15]]
grads:  [0.00739134]
Stock Position:  0.007391336610927854
Bond Position:  [5.89784564]


portfolio before change:  [6.65036053]
curr_Stock_Price:  101.76052004995606
curr_Factors:  [101.76052005]
mat_Sqrt:  [[0.15]]
grads:  [-0.09119143]
Stock Position:  -0.09119143487697107
Bond Position:  [15.93004836]


portfolio before change:  [6.59283817]
curr_Stock_Price:  102.4022252544364
curr_Factors:  [102.40222525]
mat_Sqrt:  [[0.15]]
grads:  [-0.00047043]
Stock Position:  -0.00047043032579491853
Bond Position:  [6.64101128]


portfolio before change:  [6.59314281]
curr_Stock_Price:  102.63697232977579
curr_Factors:  [102.63697233]
mat_Sqrt:  [[0.15]]
grads:  [0.02954982]
Stock Position:  0.029549820172315763
Bond Position:  [3.56023874]


portfolio before change:  [6.58847247]
curr_Stock_Price:  102.47139207581934
curr_Factors:  [102.47139208]
mat_Sqrt:  [[0.15]]
grads:  [-0.03228603]
Stock Position:  -0.03228603477109706
Bond Position:  [9.8968674]


portfolio before change:  [6.60623242]
curr_Stock_Price:  101.94046975338559
curr_Factors:  [101.94046975]
mat_Sqrt:  [[0.15]]
grads:  [-0.02100239]
Stock Position:  -0.02100239293229456
Bond Position:  [8.74722622]


portfolio before change:  [6.61177814]
curr_Stock_Price:  101.70244915639628
curr_Factors:  [101.70244916]
mat_Sqrt:  [[0.15]]
grads:  [0.02481201]
Stock Position:  0.024812013195737913
Bond Position:  [4.08833563]


portfolio before change:  [6.61470714]
curr_Stock_Price:  101.81019828255333
curr_Factors:  [101.81019828]
mat_Sqrt:  [[0.15]]
grads:  [0.00192935]
Stock Position:  0.0019293484525725185
Bond Position:  [6.41827979]


portfolio before change:  [6.61535071]
curr_Stock_Price:  101.93584382166846
curr_Factors:  [101.93584382]
mat_Sqrt:  [[0.15]]
grads:  [0.01538562]
Stock Position:  0.015385620607693298
Bond Position:  [5.04700449]


portfolio before change:  [6.6140697]
curr_Stock_Price:  101.8320806531151
curr_Factors:  [101.83208065]
mat_Sqrt:  [[0.15]]
grads:  [0.0058908]
Stock Position:  0.005890795196312294
Bond Position:  [6.01419776]


portfolio before change:  [6.6175739]
curr_Stock_Price:  102.36313104618809
curr_Factors:  [102.36313105]
mat_Sqrt:  [[0.15]]
grads:  [0.05780642]
Stock Position:  0.05780641862718732
Bond Position:  [0.7003279]


portfolio before change:  [6.66216076]
curr_Stock_Price:  103.13368710168997
curr_Factors:  [103.1336871]
mat_Sqrt:  [[0.15]]
grads:  [-0.02603551]
Stock Position:  -0.02603551186952208
Bond Position:  [9.3472991]


portfolio before change:  [6.63593268]
curr_Stock_Price:  104.16352312319495
curr_Factors:  [104.16352312]
mat_Sqrt:  [[0.15]]
grads:  [-0.05357585]
Stock Position:  -0.053575850844686586
Bond Position:  [12.21658206]


portfolio before change:  [6.58380368]
curr_Stock_Price:  105.15076933809762
curr_Factors:  [105.15076934]
mat_Sqrt:  [[0.15]]
grads:  [0.12152409]
Stock Position:  0.12152408524747013
Bond Position:  [-6.19454737]


portfolio before change:  [6.55399648]
curr_Stock_Price:  104.90867715047287
curr_Factors:  [104.90867715]
mat_Sqrt:  [[0.15]]
grads:  [-0.0233163]
Stock Position:  -0.023316299573167647
Bond Position:  [9.00007862]


portfolio before change:  [6.56074318]
curr_Stock_Price:  104.64344741348397
curr_Factors:  [104.64344741]
mat_Sqrt:  [[0.15]]
grads:  [0.08675251]
Stock Position:  0.0867525075878148
Bond Position:  [-2.51733829]


portfolio before change:  [6.59029554]
curr_Stock_Price:  104.98591240015527
curr_Factors:  [104.9859124]
mat_Sqrt:  [[0.15]]
grads:  [-0.0965022]
Stock Position:  -0.09650219997656004
Bond Position:  [16.72166705]


portfolio before change:  [6.51152379]
curr_Stock_Price:  105.81301151246737
curr_Factors:  [105.81301151]
mat_Sqrt:  [[0.15]]
grads:  [-0.08476912]
Stock Position:  -0.08476911919497605
Bond Position:  [15.48119957]


portfolio before change:  [6.49583057]
curr_Stock_Price:  106.00955510963249
curr_Factors:  [106.00955511]
mat_Sqrt:  [[0.15]]
grads:  [-0.01936675]
Stock Position:  -0.01936675123856324
Bond Position:  [8.54889125]


portfolio before change:  [6.50547848]
curr_Stock_Price:  105.53897584589376
curr_Factors:  [105.53897585]
mat_Sqrt:  [[0.15]]
grads:  [0.43645009]
Stock Position:  0.4364500915970343
Bond Position:  [-39.55701719]


portfolio before change:  [6.32168284]
curr_Stock_Price:  105.1235257061603
curr_Factors:  [105.12352571]
mat_Sqrt:  [[0.15]]
grads:  [-0.10891327]
Stock Position:  -0.1089132679489561
Bond Position:  [17.77102956]


portfolio before change:  [6.29647641]
curr_Stock_Price:  105.36515972155655
curr_Factors:  [105.36515972]
mat_Sqrt:  [[0.15]]
grads:  [0.08725633]
Stock Position:  0.08725632974763121
Bond Position:  [-2.89730071]


portfolio before change:  [6.35411578]
curr_Stock_Price:  106.02781027622217
curr_Factors:  [106.02781028]
mat_Sqrt:  [[0.15]]
grads:  [0.03593776]
Stock Position:  0.035937755585982376
Bond Position:  [2.54371425]


portfolio before change:  [6.32244813]
curr_Stock_Price:  105.14220590835842
curr_Factors:  [105.14220591]
mat_Sqrt:  [[0.15]]
grads:  [0.08012923]
Stock Position:  0.08012923124196038
Bond Position:  [-2.102516]


portfolio before change:  [6.29826038]
curr_Stock_Price:  104.84198665153214
curr_Factors:  [104.84198665]
mat_Sqrt:  [[0.15]]
grads:  [-0.15527698]
Stock Position:  -0.15527698470014253
Bond Position:  [22.57780794]


portfolio before change:  [6.43481477]
curr_Stock_Price:  103.97165014878716
curr_Factors:  [103.97165015]
mat_Sqrt:  [[0.15]]
grads:  [-0.05244055]
Stock Position:  -0.05244055022966069
Bond Position:  [11.88714531]


portfolio before change:  [6.43653705]
curr_Stock_Price:  103.95297549970486
curr_Factors:  [103.9529755]
mat_Sqrt:  [[0.15]]
grads:  [-0.04758409]
Stock Position:  -0.047584091513802086
Bond Position:  [11.38304495]


portfolio before change:  [6.44339058]
curr_Stock_Price:  103.82389731065689
curr_Factors:  [103.82389731]
mat_Sqrt:  [[0.15]]
grads:  [0.03627712]
Stock Position:  0.0362771231651876
Bond Position:  [2.67695827]


portfolio before change:  [6.42241328]
curr_Stock_Price:  103.24103363337238
curr_Factors:  [103.24103363]
mat_Sqrt:  [[0.15]]
grads:  [0.04870954]
Stock Position:  0.048709538031864175
Bond Position:  [1.39359022]


portfolio before change:  [6.45505096]
curr_Stock_Price:  103.90929241134101
curr_Factors:  [103.90929241]
mat_Sqrt:  [[0.15]]
grads:  [-0.00512243]
Stock Position:  -0.005122430326705615
Bond Position:  [6.98731907]


portfolio before change:  [6.4551067]
curr_Stock_Price:  103.98366643694722
curr_Factors:  [103.98366644]
mat_Sqrt:  [[0.15]]
grads:  [-0.03568998]
Stock Position:  -0.0356899783018276
Bond Position:  [10.1662815]


portfolio before change:  [6.44705438]
curr_Stock_Price:  104.22708862249654
curr_Factors:  [104.22708862]
mat_Sqrt:  [[0.15]]
grads:  [0.0591418]
Stock Position:  0.05914179575126111
Bond Position:  [0.28287719]


portfolio before change:  [6.42741163]
curr_Stock_Price:  103.89465984697053
curr_Factors:  [103.89465985]
mat_Sqrt:  [[0.15]]
grads:  [-0.02593582]
Stock Position:  -0.025935817475356965
Bond Position:  [9.12200456]


portfolio before change:  [6.44539163]
curr_Stock_Price:  103.22339282258463
curr_Factors:  [103.22339282]
mat_Sqrt:  [[0.15]]
grads:  [0.16005875]
Stock Position:  0.16005874767354442
Bond Position:  [-10.07641536]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.44539163]
Stock Price:  103.48326753030133
PL:  [2.9621241]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.50561922e-02]
 [-4.70226100e-04]
 [-7.14500815e-04]
 [-2.93129566e-04]
 [-5.50493845e-03]
 [ 1.21626210e-02]
 [ 4.91361647e-04]
 [ 1.61240672e-02]
 [ 1.53914428e-02]
 [ 1.41061982e-02]
 [ 8.94406260e-03]
 [-1.06785844e-02]
 [ 4.46365839e-03]
 [ 4.74943228e-03]
 [-1.45667964e-02]
 [ 1.31502758e-02]
 [ 1.65737068e-04]
 [ 3.98762427e-03]
 [ 1.20383112e-02]
 [ 1.40086322e-02]
 [ 4.94718007e-02]
 [-1.41225371e-02]
 [-2.11651395e-03]
 [ 1.40100104e-02]
 [ 1.39142320e-02]
 [-3.70914300e-03]
 [ 1.27193014e-02]
 [ 1.02593292e-03]
 [ 4.71081048e-03]
 [-1.69438247e-02]
 [-5.46405056e-03]
 [ 1.74027436e-02]
 [ 9.64887068e-03]
 [ 1.13038256e-02]
 [ 3.93980917e-03]
 [ 4.30336947e-03]
 [-2.92758647e-03]
 [ 1.15284317e-02]
 [ 2.55280793e-03]
 [-1.37272025e-02]
 [ 2.21292962e-02]
 [-1.91475172e-03]
 [ 4.11783125e-03]
 [-7.87168710e-03]
 [ 2.09100087e-03]
 [-5.64311314e-03]
 [-1.35681233e-02]
 [-8.26354724e-04]
 [-5.10689571e-03]
 [ 2.42320622e-03]
 [-3.39559513e-03]
 [ 2.98507133e-03]
 [ 3.29828763e-03]
 [ 1.07540975e-03]
 [ 6.14222291e-03]
 [ 8.86045819e-03]
 [ 7.48930335e-03]
 [ 7.84846666e-03]
 [ 1.33795779e-02]
 [-5.43333347e-03]
 [-6.32688360e-03]
 [-2.82220632e-02]
 [-1.28910265e-02]
 [-3.48983318e-03]
 [-5.73795846e-03]
 [ 5.99811782e-02]
 [ 8.61316518e-03]
 [ 1.66803845e-03]
 [ 1.62976422e-02]
 [-1.97017954e-02]
 [ 2.53958073e-02]
 [-2.02284178e-02]
 [-5.14589412e-03]
 [ 7.80364249e-03]
 [-7.49108099e-03]
 [ 3.29837880e-03]
 [ 1.58012026e-02]
 [-1.40184388e-02]
 [-4.89348358e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.82597205]
curr_Stock_Price:  99.74983163266906
curr_Factors:  [99.74983163]
mat_Sqrt:  [[0.15]]
grads:  [-0.23370795]
Stock Position:  -0.23370794790339952
Bond Position:  [21.48635641]


portfolio before change:  [-1.83061237]
curr_Stock_Price:  99.77543310594629
curr_Factors:  [99.77543311]
mat_Sqrt:  [[0.15]]
grads:  [-0.00313484]
Stock Position:  -0.0031348406682309583
Bond Position:  [-1.51783229]


portfolio before change:  [-1.82871156]
curr_Stock_Price:  99.13882106590253
curr_Factors:  [99.13882107]
mat_Sqrt:  [[0.15]]
grads:  [-0.00476334]
Stock Position:  -0.0047633387667581715
Bond Position:  [-1.35647977]


portfolio before change:  [-1.82817658]
curr_Stock_Price:  99.00871011022325
curr_Factors:  [99.00871011]
mat_Sqrt:  [[0.15]]
grads:  [-0.0019542]
Stock Position:  -0.00195419710509985
Bond Position:  [-1.63469405]


portfolio before change:  [-1.82872826]
curr_Stock_Price:  99.23872821799917
curr_Factors:  [99.23872822]
mat_Sqrt:  [[0.15]]
grads:  [-0.03669959]
Stock Position:  -0.036699589665363255
Bond Position:  [1.81329235]


portfolio before change:  [-1.85095138]
curr_Stock_Price:  99.84735780469885
curr_Factors:  [99.8473578]
mat_Sqrt:  [[0.15]]
grads:  [0.08108414]
Stock Position:  0.08108414007605605
Bond Position:  [-9.94698852]


portfolio before change:  [-1.9013247]
curr_Stock_Price:  99.2337776705417
curr_Factors:  [99.23377767]
mat_Sqrt:  [[0.15]]
grads:  [0.00327574]
Stock Position:  0.0032757443114593975
Bond Position:  [-2.22638918]


portfolio before change:  [-1.90156142]
curr_Stock_Price:  99.20399272572712
curr_Factors:  [99.20399273]
mat_Sqrt:  [[0.15]]
grads:  [0.10749378]
Stock Position:  0.10749378152013614
Bond Position:  [-12.56537374]


portfolio before change:  [-1.9394124]
curr_Stock_Price:  98.85917638756486
curr_Factors:  [98.85917639]
mat_Sqrt:  [[0.15]]
grads:  [0.10260962]
Stock Position:  0.10260961886377186
Bond Position:  [-12.08331481]


portfolio before change:  [-2.0321798]
curr_Stock_Price:  97.96245560231891
curr_Factors:  [97.9624556]
mat_Sqrt:  [[0.15]]
grads:  [0.09404132]
Stock Position:  0.09404132143140037
Bond Position:  [-11.24469858]


portfolio before change:  [-2.05896889]
curr_Stock_Price:  97.68506408598721
curr_Factors:  [97.68506409]
mat_Sqrt:  [[0.15]]
grads:  [0.05962708]
Stock Position:  0.05962708403055549
Bond Position:  [-7.88364441]


portfolio before change:  [-2.07385751]
curr_Stock_Price:  97.4436321260975
curr_Factors:  [97.44363213]
mat_Sqrt:  [[0.15]]
grads:  [-0.07119056]
Stock Position:  -0.07119056288560312
Bond Position:  [4.86320951]


portfolio before change:  [-2.10053481]
curr_Stock_Price:  97.8226326557673
curr_Factors:  [97.82263266]
mat_Sqrt:  [[0.15]]
grads:  [0.02975772]
Stock Position:  0.029757722593171575
Bond Position:  [-5.01151358]


portfolio before change:  [-2.09452218]
curr_Stock_Price:  98.03521144339948
curr_Factors:  [98.03521144]
mat_Sqrt:  [[0.15]]
grads:  [0.03166288]
Stock Position:  0.03166288187515699
Bond Position:  [-5.1985995]


portfolio before change:  [-2.09122944]
curr_Stock_Price:  98.14946707858418
curr_Factors:  [98.14946708]
mat_Sqrt:  [[0.15]]
grads:  [-0.09711198]
Stock Position:  -0.09711197567927035
Bond Position:  [7.44025922]


portfolio before change:  [-2.17847424]
curr_Stock_Price:  99.05264954026306
curr_Factors:  [99.05264954]
mat_Sqrt:  [[0.15]]
grads:  [0.08766851]
Stock Position:  0.08766850538300201
Bond Position:  [-10.86227198]


portfolio before change:  [-2.16266864]
curr_Stock_Price:  99.2406819371646
curr_Factors:  [99.24068194]
mat_Sqrt:  [[0.15]]
grads:  [0.00110491]
Stock Position:  0.0011049137850385926
Bond Position:  [-2.27232104]


portfolio before change:  [-2.1637114]
curr_Stock_Price:  98.42547431444527
curr_Factors:  [98.42547431]
mat_Sqrt:  [[0.15]]
grads:  [0.02658416]
Stock Position:  0.026584161802913772
Bond Position:  [-4.78027013]


portfolio before change:  [-2.16333265]
curr_Stock_Price:  98.45096040200401
curr_Factors:  [98.4509604]
mat_Sqrt:  [[0.15]]
grads:  [0.08025541]
Stock Position:  0.08025540809904953
Bond Position:  [-10.06455465]


portfolio before change:  [-2.19739295]
curr_Stock_Price:  98.03439973740403
curr_Factors:  [98.03439974]
mat_Sqrt:  [[0.15]]
grads:  [0.09339088]
Stock Position:  0.0933908811295326
Bond Position:  [-11.35291192]


portfolio before change:  [-2.1102918]
curr_Stock_Price:  98.97464918083043
curr_Factors:  [98.97464918]
mat_Sqrt:  [[0.15]]
grads:  [0.329812]
Stock Position:  0.32981200498517116
Bond Position:  [-34.75331929]


portfolio before change:  [-1.76586274]
curr_Stock_Price:  100.02555456766726
curr_Factors:  [100.02555457]
mat_Sqrt:  [[0.15]]
grads:  [-0.09415025]
Stock Position:  -0.0941502472692449
Bond Position:  [7.65156796]


portfolio before change:  [-1.72391983]
curr_Stock_Price:  99.58514493710346
curr_Factors:  [99.58514494]
mat_Sqrt:  [[0.15]]
grads:  [-0.01411009]
Stock Position:  -0.014110093007251917
Bond Position:  [-0.31876417]


portfolio before change:  [-1.71890559]
curr_Stock_Price:  99.22836746315177
curr_Factors:  [99.22836746]
mat_Sqrt:  [[0.15]]
grads:  [0.09340007]
Stock Position:  0.0934000695543794
Bond Position:  [-10.98684201]


portfolio before change:  [-1.61457668]
curr_Stock_Price:  100.35273071610207
curr_Factors:  [100.35273072]
mat_Sqrt:  [[0.15]]
grads:  [0.09276155]
Stock Position:  0.09276154675726589
Bond Position:  [-10.9234512]


portfolio before change:  [-1.58543889]
curr_Stock_Price:  100.67420583545233
curr_Factors:  [100.67420584]
mat_Sqrt:  [[0.15]]
grads:  [-0.02472762]
Stock Position:  -0.024727619991837906
Bond Position:  [0.90399462]


portfolio before change:  [-1.58962301]
curr_Stock_Price:  100.84569925031816
curr_Factors:  [100.84569925]
mat_Sqrt:  [[0.15]]
grads:  [0.08479534]
Stock Position:  0.08479534245795574
Bond Position:  [-10.14086861]


portfolio before change:  [-1.54578327]
curr_Stock_Price:  101.37018050601935
curr_Factors:  [101.37018051]
mat_Sqrt:  [[0.15]]
grads:  [0.00683955]
Stock Position:  0.006839552780380486
Bond Position:  [-2.23910997]


portfolio before change:  [-1.54463767]
curr_Stock_Price:  101.5581376315345
curr_Factors:  [101.55813763]
mat_Sqrt:  [[0.15]]
grads:  [0.0314054]
Stock Position:  0.03140540321201528
Bond Position:  [-4.73411193]


portfolio before change:  [-1.52043473]
curr_Stock_Price:  102.33822103418835
curr_Factors:  [102.33822103]
mat_Sqrt:  [[0.15]]
grads:  [-0.11295883]
Stock Position:  -0.11295883156769859
Bond Position:  [10.03957114]


portfolio before change:  [-1.44501463]
curr_Stock_Price:  101.67609831495858
curr_Factors:  [101.67609831]
mat_Sqrt:  [[0.15]]
grads:  [-0.036427]
Stock Position:  -0.036427003703431673
Bond Position:  [2.25874098]


portfolio before change:  [-1.43070483]
curr_Stock_Price:  101.28713891424135
curr_Factors:  [101.28713891]
mat_Sqrt:  [[0.15]]
grads:  [0.11601829]
Stock Position:  0.11601829075073386
Bond Position:  [-13.18186556]


portfolio before change:  [-1.45959358]
curr_Stock_Price:  101.04523858230722
curr_Factors:  [101.04523858]
mat_Sqrt:  [[0.15]]
grads:  [0.0643258]
Stock Position:  0.06432580453218242
Bond Position:  [-7.95940985]


portfolio before change:  [-1.46533175]
curr_Stock_Price:  100.96376752956158
curr_Factors:  [100.96376753]
mat_Sqrt:  [[0.15]]
grads:  [0.07535884]
Stock Position:  0.07535883737832337
Bond Position:  [-9.07384389]


portfolio before change:  [-1.49809356]
curr_Stock_Price:  100.5365492761014
curr_Factors:  [100.53654928]
mat_Sqrt:  [[0.15]]
grads:  [0.02626539]
Stock Position:  0.026265394488756897
Bond Position:  [-4.13872568]


portfolio before change:  [-1.53172701]
curr_Stock_Price:  99.26587433323712
curr_Factors:  [99.26587433]
mat_Sqrt:  [[0.15]]
grads:  [0.02868913]
Stock Position:  0.02868912980513187
Bond Position:  [-4.37957857]


portfolio before change:  [-1.51406212]
curr_Stock_Price:  99.89115029839913
curr_Factors:  [99.8911503]
mat_Sqrt:  [[0.15]]
grads:  [-0.01951724]
Stock Position:  -0.01951724311787114
Bond Position:  [0.43553774]


portfolio before change:  [-1.50945653]
curr_Stock_Price:  99.65656972014307
curr_Factors:  [99.65656972]
mat_Sqrt:  [[0.15]]
grads:  [0.07685621]
Stock Position:  0.07685621165040446
Bond Position:  [-9.16868295]


portfolio before change:  [-1.58592458]
curr_Stock_Price:  98.66907647263305
curr_Factors:  [98.66907647]
mat_Sqrt:  [[0.15]]
grads:  [0.01701872]
Stock Position:  0.017018719545766246
Bond Position:  [-3.26514592]


portfolio before change:  [-1.57577684]
curr_Stock_Price:  99.27733717805744
curr_Factors:  [99.27733718]
mat_Sqrt:  [[0.15]]
grads:  [-0.09151468]
Stock Position:  -0.09151468350137074
Bond Position:  [7.50955725]


portfolio before change:  [-1.48688749]
curr_Stock_Price:  98.31115350399574
curr_Factors:  [98.3111535]
mat_Sqrt:  [[0.15]]
grads:  [0.14752864]
Stock Position:  0.14752864131525892
Bond Position:  [-15.99059839]


portfolio before change:  [-1.4122595]
curr_Stock_Price:  98.82378231421744
curr_Factors:  [98.82378231]
mat_Sqrt:  [[0.15]]
grads:  [-0.01276501]
Stock Position:  -0.012765011446426139
Bond Position:  [-0.15077279]


portfolio before change:  [-1.41631363]
curr_Stock_Price:  99.14064105431797
curr_Factors:  [99.14064105]
mat_Sqrt:  [[0.15]]
grads:  [0.02745221]
Stock Position:  0.02745220830072184
Bond Position:  [-4.13794316]


portfolio before change:  [-1.43397801]
curr_Stock_Price:  98.50660263941192
curr_Factors:  [98.50660264]
mat_Sqrt:  [[0.15]]
grads:  [-0.05247791]
Stock Position:  -0.05247791397041894
Bond Position:  [3.735443]


portfolio before change:  [-1.44439169]
curr_Stock_Price:  98.70949078152226
curr_Factors:  [98.70949078]
mat_Sqrt:  [[0.15]]
grads:  [0.01394001]
Stock Position:  0.013940005767899033
Bond Position:  [-2.82040256]


portfolio before change:  [-1.46139988]
curr_Stock_Price:  97.50203729842703
curr_Factors:  [97.5020373]
mat_Sqrt:  [[0.15]]
grads:  [-0.03762075]
Stock Position:  -0.03762075424173963
Bond Position:  [2.20670031]


portfolio before change:  [-1.46258151]
curr_Stock_Price:  97.5371124335795
curr_Factors:  [97.53711243]
mat_Sqrt:  [[0.15]]
grads:  [-0.09045416]
Stock Position:  -0.09045415537631554
Bond Position:  [7.36005562]


portfolio before change:  [-1.47317746]
curr_Stock_Price:  97.65933973908659
curr_Factors:  [97.65933974]
mat_Sqrt:  [[0.15]]
grads:  [-0.00550903]
Stock Position:  -0.005509031494447293
Bond Position:  [-0.93516908]


portfolio before change:  [-1.47363003]
curr_Stock_Price:  97.73088169327808
curr_Factors:  [97.73088169]
mat_Sqrt:  [[0.15]]
grads:  [-0.03404597]
Stock Position:  -0.034045971405250466
Bond Position:  [1.85371277]


portfolio before change:  [-1.45687033]
curr_Stock_Price:  97.242017796167
curr_Factors:  [97.2420178]
mat_Sqrt:  [[0.15]]
grads:  [0.01615471]
Stock Position:  0.016154708100618462
Bond Position:  [-3.02778674]


portfolio before change:  [-1.45031842]
curr_Stock_Price:  97.659304566352
curr_Factors:  [97.65930457]
mat_Sqrt:  [[0.15]]
grads:  [-0.0226373]
Stock Position:  -0.022637300840883775
Bond Position:  [0.76042463]


portfolio before change:  [-1.4391563]
curr_Stock_Price:  97.16831877556918
curr_Factors:  [97.16831878]
mat_Sqrt:  [[0.15]]
grads:  [0.01990048]
Stock Position:  0.019900475535562612
Bond Position:  [-3.37285205]


portfolio before change:  [-1.43308941]
curr_Stock_Price:  97.48377347614581
curr_Factors:  [97.48377348]
mat_Sqrt:  [[0.15]]
grads:  [0.02198858]
Stock Position:  0.021988584228352172
Bond Position:  [-3.57661958]


portfolio before change:  [-1.44473372]
curr_Stock_Price:  96.96437832939135
curr_Factors:  [96.96437833]
mat_Sqrt:  [[0.15]]
grads:  [0.0071694]
Stock Position:  0.007169398310156601
Bond Position:  [-2.13990997]


portfolio before change:  [-1.44804661]
curr_Stock_Price:  96.52094610265478
curr_Factors:  [96.5209461]
mat_Sqrt:  [[0.15]]
grads:  [0.04094815]
Stock Position:  0.04094815271570582
Bond Position:  [-5.40040106]


portfolio before change:  [-1.4711599]
curr_Stock_Price:  95.96473663564007
curr_Factors:  [95.96473664]
mat_Sqrt:  [[0.15]]
grads:  [0.05906972]
Stock Position:  0.05906972126701876
Bond Position:  [-7.13977014]


portfolio before change:  [-1.47900168]
curr_Stock_Price:  95.83953667148512
curr_Factors:  [95.83953667]
mat_Sqrt:  [[0.15]]
grads:  [0.04992869]
Stock Position:  0.0499286890004203
Bond Position:  [-6.2641441]


portfolio before change:  [-1.46339273]
curr_Stock_Price:  96.16000298531024
curr_Factors:  [96.16000299]
mat_Sqrt:  [[0.15]]
grads:  [0.05232311]
Stock Position:  0.05232311108188883
Bond Position:  [-6.49478325]


portfolio before change:  [-1.46450973]
curr_Stock_Price:  96.14641317642965
curr_Factors:  [96.14641318]
mat_Sqrt:  [[0.15]]
grads:  [0.08919719]
Stock Position:  0.08919718603160603
Bond Position:  [-10.04049923]


portfolio before change:  [-1.56801922]
curr_Stock_Price:  94.99299180214891
curr_Factors:  [94.9929918]
mat_Sqrt:  [[0.15]]
grads:  [-0.03622222]
Stock Position:  -0.036222223108601334
Bond Position:  [1.87283812]


portfolio before change:  [-1.55680042]
curr_Stock_Price:  94.68650174297993
curr_Factors:  [94.68650174]
mat_Sqrt:  [[0.15]]
grads:  [-0.04217922]
Stock Position:  -0.04217922397483362
Bond Position:  [2.43700275]


portfolio before change:  [-1.56265237]
curr_Stock_Price:  94.82885308216511
curr_Factors:  [94.82885308]
mat_Sqrt:  [[0.15]]
grads:  [-0.18814709]
Stock Position:  -0.1881470877374504
Bond Position:  [16.27912017]


portfolio before change:  [-1.57702469]
curr_Stock_Price:  94.91064974216935
curr_Factors:  [94.91064974]
mat_Sqrt:  [[0.15]]
grads:  [-0.08594018]
Stock Position:  -0.08594017653850544
Bond Position:  [6.5796133]


portfolio before change:  [-1.5280297]
curr_Stock_Price:  94.34532909774562
curr_Factors:  [94.3453291]
mat_Sqrt:  [[0.15]]
grads:  [-0.02326555]
Stock Position:  -0.02326555454695185
Bond Position:  [0.6669667]


portfolio before change:  [-1.50667417]
curr_Stock_Price:  93.42921771797793
curr_Factors:  [93.42921772]
mat_Sqrt:  [[0.15]]
grads:  [-0.03825306]
Stock Position:  -0.0382530564010314
Bond Position:  [2.06727896]


portfolio before change:  [-1.49082214]
curr_Stock_Price:  93.01819618185661
curr_Factors:  [93.01819618]
mat_Sqrt:  [[0.15]]
grads:  [0.39987452]
Stock Position:  0.39987452119060707
Bond Position:  [-38.6864288]


portfolio before change:  [-1.65915207]
curr_Stock_Price:  92.60328614419797
curr_Factors:  [92.60328614]
mat_Sqrt:  [[0.15]]
grads:  [0.0574211]
Stock Position:  0.05742110117690187
Bond Position:  [-6.97653473]


portfolio before change:  [-1.65062156]
curr_Stock_Price:  92.759440525184
curr_Factors:  [92.75944053]
mat_Sqrt:  [[0.15]]
grads:  [0.01112026]
Stock Position:  0.011120256348491791
Bond Position:  [-2.68213031]


portfolio before change:  [-1.64783016]
curr_Stock_Price:  93.02553483076268
curr_Factors:  [93.02553483]
mat_Sqrt:  [[0.15]]
grads:  [0.10865095]
Stock Position:  0.1086509480988556
Bond Position:  [-11.75514271]


portfolio before change:  [-1.61251977]
curr_Stock_Price:  93.35728627125415
curr_Factors:  [93.35728627]
mat_Sqrt:  [[0.15]]
grads:  [-0.1313453]
Stock Position:  -0.13134530291704094
Bond Position:  [10.64952128]


portfolio before change:  [-1.62411333]
curr_Stock_Price:  93.45062177867761
curr_Factors:  [93.45062178]
mat_Sqrt:  [[0.15]]
grads:  [0.16930538]
Stock Position:  0.16930538185259467
Bond Position:  [-17.44580654]


portfolio before change:  [-1.53086103]
curr_Stock_Price:  94.00785566731038
curr_Factors:  [94.00785567]
mat_Sqrt:  [[0.15]]
grads:  [-0.13485612]
Stock Position:  -0.13485611853016005
Bond Position:  [11.14667349]


portfolio before change:  [-1.57834913]
curr_Stock_Price:  94.36516080781153
curr_Factors:  [94.36516081]
mat_Sqrt:  [[0.15]]
grads:  [-0.03430596]
Stock Position:  -0.03430596078081638
Bond Position:  [1.65893838]


portfolio before change:  [-1.58995746]
curr_Stock_Price:  94.70655972023322
curr_Factors:  [94.70655972]
mat_Sqrt:  [[0.15]]
grads:  [0.05202428]
Stock Position:  0.05202428324057668
Bond Position:  [-6.51699835]


portfolio before change:  [-1.59950551]
curr_Stock_Price:  94.5308586886905
curr_Factors:  [94.53085869]
mat_Sqrt:  [[0.15]]
grads:  [-0.04994054]
Stock Position:  -0.049940539959243246
Bond Position:  [3.12141662]


portfolio before change:  [-1.62610954]
curr_Stock_Price:  95.06747945169752
curr_Factors:  [95.06747945]
mat_Sqrt:  [[0.15]]
grads:  [0.02198919]
Stock Position:  0.021989191980753303
Bond Position:  [-3.7165666]


portfolio before change:  [-1.64058228]
curr_Stock_Price:  94.4198680626386
curr_Factors:  [94.41986806]
mat_Sqrt:  [[0.15]]
grads:  [0.10534135]
Stock Position:  0.10534135049880772
Bond Position:  [-11.5868987]


portfolio before change:  [-1.61104957]
curr_Stock_Price:  94.70709542500931
curr_Factors:  [94.70709543]
mat_Sqrt:  [[0.15]]
grads:  [-0.09345626]
Stock Position:  -0.09345625863873384
Bond Position:  [7.23992123]


portfolio before change:  [-1.62052944]
curr_Stock_Price:  94.81337379223703
curr_Factors:  [94.81337379]
mat_Sqrt:  [[0.15]]
grads:  [-0.32623224]
Stock Position:  -0.32623223842373145
Bond Position:  [29.31064972]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.62052944]
Stock Price:  93.96461270639563
PL:  [-1.62052944]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-9.78179683e-02]
 [-1.27293299e-03]
 [ 9.45492582e-05]
 [ 2.15186079e-03]
 [ 1.01914889e-02]
 [ 1.21066588e-02]
 [ 1.10905125e-03]
 [ 1.39193009e-02]
 [ 1.73705085e-02]
 [-1.90091980e-02]
 [ 5.91008860e-03]
 [-8.58385936e-03]
 [ 1.59449434e-03]
 [ 3.55103736e-03]
 [ 2.28646702e-03]
 [-1.19461781e-03]
 [ 1.50240242e-02]
 [ 7.64273890e-03]
 [ 2.27799579e-02]
 [ 8.44986289e-03]
 [ 5.13102650e-02]
 [-1.50661999e-02]
 [-1.41942726e-03]
 [ 1.32014884e-02]
 [ 8.40937410e-03]
 [ 5.18798088e-03]
 [ 1.27147849e-02]
 [-8.62355402e-03]
 [ 2.56910000e-03]
 [-2.24831148e-02]
 [-4.42198202e-03]
 [-4.91619070e-03]
 [ 1.48368453e-02]
 [ 1.91882234e-02]
 [ 2.87668589e-03]
 [-2.62920006e-03]
 [-7.04492104e-03]
 [ 8.78035409e-03]
 [-1.39459633e-03]
 [-1.17936593e-02]
 [-2.21561866e-03]
 [-2.73263060e-03]
 [ 8.82379388e-03]
 [-1.16911961e-02]
 [ 2.20458756e-03]
 [ 1.85615469e-03]
 [-1.36510875e-02]
 [-6.21471168e-04]
 [ 4.26995805e-03]
 [-2.69995716e-03]
 [-3.29566089e-03]
 [ 3.61089208e-03]
 [-6.62168417e-05]
 [ 2.62015802e-03]
 [-2.72847789e-03]
 [ 8.50945964e-03]
 [-9.27624159e-03]
 [-1.76013102e-02]
 [ 1.38539354e-02]
 [ 8.64710978e-03]
 [ 8.06867589e-03]
 [-1.35913631e-02]
 [-1.26494508e-02]
 [-3.12239269e-03]
 [-1.65242724e-02]
 [-1.88578134e-04]
 [ 2.93633320e-02]
 [ 1.83049542e-03]
 [ 6.74565591e-03]
 [-1.35397912e-02]
 [-7.86047373e-03]
 [-7.79868119e-03]
 [ 2.31583127e-03]
 [ 8.51274791e-03]
 [ 3.37041476e-03]
 [-1.29190852e-02]
 [ 4.11582178e-03]
 [-4.53244969e-03]
 [ 1.90252353e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.30591934]
curr_Stock_Price:  101.17226289045402
curr_Factors:  [101.17226289]
mat_Sqrt:  [[0.15]]
grads:  [-0.65211979]
Stock Position:  -0.6521197885435572
Bond Position:  [86.28235403]


portfolio before change:  [20.7262663]
curr_Stock_Price:  100.53594706354883
curr_Factors:  [100.53594706]
mat_Sqrt:  [[0.15]]
grads:  [-0.00848622]
Stock Position:  -0.00848621990022641
Bond Position:  [21.57943646]


portfolio before change:  [20.7293948]
curr_Stock_Price:  100.32622608058125
curr_Factors:  [100.32622608]
mat_Sqrt:  [[0.15]]
grads:  [0.00063033]
Stock Position:  0.0006303283881942413
Bond Position:  [20.66615633]


portfolio before change:  [20.73067054]
curr_Stock_Price:  100.30094581380827
curr_Factors:  [100.30094581]
mat_Sqrt:  [[0.15]]
grads:  [0.01434574]
Stock Position:  0.01434573862317194
Bond Position:  [19.29177938]


portfolio before change:  [20.72240352]
curr_Stock_Price:  99.64062497203363
curr_Factors:  [99.64062497]
mat_Sqrt:  [[0.15]]
grads:  [0.06794326]
Stock Position:  0.06794325917863091
Bond Position:  [13.95249471]


portfolio before change:  [20.75003933]
curr_Stock_Price:  100.03453828675529
curr_Factors:  [100.03453829]
mat_Sqrt:  [[0.15]]
grads:  [0.08071106]
Stock Position:  0.08071105849399955
Bond Position:  [12.67614586]


portfolio before change:  [20.72338502]
curr_Stock_Price:  99.69447840956464
curr_Factors:  [99.69447841]
mat_Sqrt:  [[0.15]]
grads:  [0.00739368]
Stock Position:  0.007393675023207334
Bond Position:  [19.98627645]


portfolio before change:  [20.7222573]
curr_Stock_Price:  99.3729998881842
curr_Factors:  [99.37299989]
mat_Sqrt:  [[0.15]]
grads:  [0.09279534]
Stock Position:  0.09279533903416608
Bond Position:  [11.50090608]


portfolio before change:  [20.73771538]
curr_Stock_Price:  99.53183602196623
curr_Factors:  [99.53183602]
mat_Sqrt:  [[0.15]]
grads:  [0.11580339]
Stock Position:  0.11580338982490337
Bond Position:  [9.21159137]


portfolio before change:  [20.74332998]
curr_Stock_Price:  99.57534820291458
curr_Factors:  [99.5753482]
mat_Sqrt:  [[0.15]]
grads:  [-0.12672799]
Stock Position:  -0.1267279867362343
Bond Position:  [33.36231339]


portfolio before change:  [20.82616795]
curr_Stock_Price:  98.93813492998466
curr_Factors:  [98.93813493]
mat_Sqrt:  [[0.15]]
grads:  [0.03940059]
Stock Position:  0.03940059067928726
Bond Position:  [16.92794699]


portfolio before change:  [20.79515946]
curr_Stock_Price:  98.1242761269035
curr_Factors:  [98.12427613]
mat_Sqrt:  [[0.15]]
grads:  [-0.05722573]
Stock Position:  -0.057225729047661995
Bond Position:  [26.4103927]


portfolio before change:  [20.79498719]
curr_Stock_Price:  98.15613185228786
curr_Factors:  [98.15613185]
mat_Sqrt:  [[0.15]]
grads:  [0.01062996]
Stock Position:  0.010629962296280403
Bond Position:  [19.75159121]


portfolio before change:  [20.80331285]
curr_Stock_Price:  98.82322217503179
curr_Factors:  [98.82322218]
mat_Sqrt:  [[0.15]]
grads:  [0.02367358]
Stock Position:  0.02367358242587622
Bond Position:  [18.46381315]


portfolio before change:  [20.82249832]
curr_Stock_Price:  99.5848916270738
curr_Factors:  [99.58489163]
mat_Sqrt:  [[0.15]]
grads:  [0.01524311]
Stock Position:  0.01524311345272842
Bond Position:  [19.30451452]


portfolio before change:  [20.83237047]
curr_Stock_Price:  100.15338295482896
curr_Factors:  [100.15338295]
mat_Sqrt:  [[0.15]]
grads:  [-0.00796412]
Stock Position:  -0.007964118759717169
Bond Position:  [21.6300039]


portfolio before change:  [20.82745352]
curr_Stock_Price:  100.94052193791178
curr_Factors:  [100.94052194]
mat_Sqrt:  [[0.15]]
grads:  [0.10016016]
Stock Position:  0.10016016144575172
Bond Position:  [10.71723454]


portfolio before change:  [20.68454666]
curr_Stock_Price:  99.50705071884157
curr_Factors:  [99.50705072]
mat_Sqrt:  [[0.15]]
grads:  [0.05095159]
Stock Position:  0.050951592667684106
Bond Position:  [15.61450394]


portfolio before change:  [20.68428566]
curr_Stock_Price:  99.48277401910572
curr_Factors:  [99.48277402]
mat_Sqrt:  [[0.15]]
grads:  [0.15186639]
Stock Position:  0.15186638616107337
Bond Position:  [5.57619628]


portfolio before change:  [20.74094051]
curr_Stock_Price:  99.85353635222145
curr_Factors:  [99.85353635]
mat_Sqrt:  [[0.15]]
grads:  [0.05633242]
Stock Position:  0.05633241925080176
Bond Position:  [15.11594924]


portfolio before change:  [20.69582498]
curr_Stock_Price:  99.03588439444432
curr_Factors:  [99.03588439]
mat_Sqrt:  [[0.15]]
grads:  [0.34206843]
Stock Position:  0.34206843334798565
Bond Position:  [-13.18122484]


portfolio before change:  [20.93613265]
curr_Stock_Price:  99.74080627191285
curr_Factors:  [99.74080627]
mat_Sqrt:  [[0.15]]
grads:  [-0.10044133]
Stock Position:  -0.10044133233340763
Bond Position:  [30.95423212]


portfolio before change:  [20.88103636]
curr_Stock_Price:  100.30861020625389
curr_Factors:  [100.30861021]
mat_Sqrt:  [[0.15]]
grads:  [-0.00946285]
Stock Position:  -0.00946284838013941
Bond Position:  [21.83024153]


portfolio before change:  [20.88916176]
curr_Stock_Price:  99.59413567050065
curr_Factors:  [99.59413567]
mat_Sqrt:  [[0.15]]
grads:  [0.08800992]
Stock Position:  0.08800992277099268
Bond Position:  [12.12388957]


portfolio before change:  [20.85179058]
curr_Stock_Price:  99.1609010530945
curr_Factors:  [99.16090105]
mat_Sqrt:  [[0.15]]
grads:  [0.05606249]
Stock Position:  0.0560624940084054
Bond Position:  [15.29258316]


portfolio before change:  [20.83057602]
curr_Stock_Price:  98.76544279649545
curr_Factors:  [98.7654428]
mat_Sqrt:  [[0.15]]
grads:  [0.03458654]
Stock Position:  0.034586539199874734
Bond Position:  [17.41462116]


portfolio before change:  [20.83596509]
curr_Stock_Price:  98.88978657320405
curr_Factors:  [98.88978657]
mat_Sqrt:  [[0.15]]
grads:  [0.08476523]
Stock Position:  0.08476523296181972
Bond Position:  [12.4535493]


portfolio before change:  [20.86287682]
curr_Stock_Price:  99.1980893022413
curr_Factors:  [99.1980893]
mat_Sqrt:  [[0.15]]
grads:  [-0.05749036]
Stock Position:  -0.05749036016351801
Bond Position:  [26.5658107]


portfolio before change:  [20.85197971]
curr_Stock_Price:  99.41651762357588
curr_Factors:  [99.41651762]
mat_Sqrt:  [[0.15]]
grads:  [0.01712733]
Stock Position:  0.017127333332747765
Bond Position:  [19.14923987]


portfolio before change:  [20.86237185]
curr_Stock_Price:  99.9533950963614
curr_Factors:  [99.9533951]
mat_Sqrt:  [[0.15]]
grads:  [-0.14988743]
Stock Position:  -0.14988743228894483
Bond Position:  [35.84412959]


portfolio before change:  [20.87182377]
curr_Stock_Price:  99.9052817363355
curr_Factors:  [99.90528174]
mat_Sqrt:  [[0.15]]
grads:  [-0.02947988]
Stock Position:  -0.029479880153454145
Bond Position:  [23.8170195]


portfolio before change:  [20.88182662]
curr_Stock_Price:  99.6164663258689
curr_Factors:  [99.61646633]
mat_Sqrt:  [[0.15]]
grads:  [-0.0327746]
Stock Position:  -0.03277460466635245
Bond Position:  [24.14671692]


portfolio before change:  [20.875372]
curr_Stock_Price:  99.8594545682306
curr_Factors:  [99.85945457]
mat_Sqrt:  [[0.15]]
grads:  [0.0989123]
Stock Position:  0.09891230188648767
Bond Position:  [10.99804348]


portfolio before change:  [20.85031996]
curr_Stock_Price:  99.59922977484246
curr_Factors:  [99.59922977]
mat_Sqrt:  [[0.15]]
grads:  [0.12792149]
Stock Position:  0.12792148964541314
Bond Position:  [8.10943812]


portfolio before change:  [20.94299162]
curr_Stock_Price:  100.31970917670283
curr_Factors:  [100.31970918]
mat_Sqrt:  [[0.15]]
grads:  [0.01917791]
Stock Position:  0.019177905954652227
Bond Position:  [19.01906967]


portfolio before change:  [20.94909928]
curr_Stock_Price:  100.57619910723594
curr_Factors:  [100.57619911]
mat_Sqrt:  [[0.15]]
grads:  [-0.017528]
Stock Position:  -0.01752800041457501
Bond Position:  [22.71199894]


portfolio before change:  [20.92686361]
curr_Stock_Price:  101.92576632320103
curr_Factors:  [101.92576632]
mat_Sqrt:  [[0.15]]
grads:  [-0.04696614]
Stock Position:  -0.046966140234561735
Bond Position:  [25.71392345]


portfolio before change:  [20.94648565]
curr_Stock_Price:  101.54219486539384
curr_Factors:  [101.54219487]
mat_Sqrt:  [[0.15]]
grads:  [0.05853569]
Stock Position:  0.05853569396101288
Bond Position:  [15.00264281]


portfolio before change:  [20.91410176]
curr_Stock_Price:  100.97294243808206
curr_Factors:  [100.97294244]
mat_Sqrt:  [[0.15]]
grads:  [-0.00929731]
Stock Position:  -0.009297308863296855
Bond Position:  [21.8528784]


portfolio before change:  [20.91650052]
curr_Stock_Price:  100.86184475232997
curr_Factors:  [100.86184475]
mat_Sqrt:  [[0.15]]
grads:  [-0.0786244]
Stock Position:  -0.07862439561507592
Bond Position:  [28.8467021]


portfolio before change:  [20.93624707]
curr_Stock_Price:  100.63362586051868
curr_Factors:  [100.63362586]
mat_Sqrt:  [[0.15]]
grads:  [-0.01477079]
Stock Position:  -0.014770791082584825
Bond Position:  [22.42268533]


portfolio before change:  [20.93105427]
curr_Stock_Price:  101.08006471896978
curr_Factors:  [101.08006472]
mat_Sqrt:  [[0.15]]
grads:  [-0.01821754]
Stock Position:  -0.018217537334227506
Bond Position:  [22.77248413]


portfolio before change:  [20.933561]
curr_Stock_Price:  101.02059428772387
curr_Factors:  [101.02059429]
mat_Sqrt:  [[0.15]]
grads:  [0.05882529]
Stock Position:  0.05882529256297474
Bond Position:  [14.99099499]


portfolio before change:  [20.88005048]
curr_Stock_Price:  100.0950147161733
curr_Factors:  [100.09501472]
mat_Sqrt:  [[0.15]]
grads:  [-0.07794131]
Stock Position:  -0.07794130727284518
Bond Position:  [28.68158678]


portfolio before change:  [20.84857002]
curr_Stock_Price:  100.52191434971685
curr_Factors:  [100.52191435]
mat_Sqrt:  [[0.15]]
grads:  [0.01469725]
Stock Position:  0.014697250386968745
Bond Position:  [19.37117428]


portfolio before change:  [20.86337353]
curr_Stock_Price:  101.4467654055391
curr_Factors:  [101.44676541]
mat_Sqrt:  [[0.15]]
grads:  [0.01237436]
Stock Position:  0.012374364608079174
Bond Position:  [19.60803426]


portfolio before change:  [20.87542718]
curr_Stock_Price:  102.32180926403421
curr_Factors:  [102.32180926]
mat_Sqrt:  [[0.15]]
grads:  [-0.09100725]
Stock Position:  -0.09100725001098289
Bond Position:  [30.18745365]


portfolio before change:  [20.87982227]
curr_Stock_Price:  102.29424750952276
curr_Factors:  [102.29424751]
mat_Sqrt:  [[0.15]]
grads:  [-0.00414314]
Stock Position:  -0.00414314111796168
Bond Position:  [21.30364177]


portfolio before change:  [20.87989517]
curr_Stock_Price:  102.59803104259366
curr_Factors:  [102.59803104]
mat_Sqrt:  [[0.15]]
grads:  [0.02846639]
Stock Position:  0.028466386973132127
Bond Position:  [17.95929992]


portfolio before change:  [20.86694692]
curr_Stock_Price:  102.10373766319088
curr_Factors:  [102.10373766]
mat_Sqrt:  [[0.15]]
grads:  [-0.01799971]
Stock Position:  -0.017999714419249514
Bond Position:  [22.70478504]


portfolio before change:  [20.86254901]
curr_Stock_Price:  102.42690965166823
curr_Factors:  [102.42690965]
mat_Sqrt:  [[0.15]]
grads:  [-0.02197107]
Stock Position:  -0.021971072631864326
Bond Position:  [23.11297808]


portfolio before change:  [20.86570651]
curr_Stock_Price:  102.34894823679751
curr_Factors:  [102.34894824]
mat_Sqrt:  [[0.15]]
grads:  [0.02407261]
Stock Position:  0.024072613868030335
Bond Position:  [18.4018998]


portfolio before change:  [20.83824505]
curr_Stock_Price:  101.16039382540117
curr_Factors:  [101.16039383]
mat_Sqrt:  [[0.15]]
grads:  [-0.00044145]
Stock Position:  -0.0004414456113621448
Bond Position:  [20.88290186]


portfolio before change:  [20.83915217]
curr_Stock_Price:  102.06221909755583
curr_Factors:  [102.0622191]
mat_Sqrt:  [[0.15]]
grads:  [0.01746772]
Stock Position:  0.01746772010997722
Bond Position:  [19.05635789]


portfolio before change:  [20.85003054]
curr_Stock_Price:  102.6168028523813
curr_Factors:  [102.61680285]
mat_Sqrt:  [[0.15]]
grads:  [-0.01818985]
Stock Position:  -0.018189852628670435
Bond Position:  [22.71661506]


portfolio before change:  [20.86426796]
curr_Stock_Price:  101.91214713515762
curr_Factors:  [101.91214714]
mat_Sqrt:  [[0.15]]
grads:  [0.05672973]
Stock Position:  0.05672973094648564
Bond Position:  [15.08281927]


portfolio before change:  [20.85544797]
curr_Stock_Price:  101.74005589868246
curr_Factors:  [101.7400559]
mat_Sqrt:  [[0.15]]
grads:  [-0.06184161]
Stock Position:  -0.061841610579033146
Bond Position:  [27.14721689]


portfolio before change:  [20.87998452]
curr_Stock_Price:  101.37072871914103
curr_Factors:  [101.37072872]
mat_Sqrt:  [[0.15]]
grads:  [-0.11734207]
Stock Position:  -0.11734206809284989
Bond Position:  [32.77503547]


portfolio before change:  [21.01184804]
curr_Stock_Price:  100.26443307917313
curr_Factors:  [100.26443308]
mat_Sqrt:  [[0.15]]
grads:  [0.09235957]
Stock Position:  0.09235956913322886
Bond Position:  [11.7514682]


portfolio before change:  [21.00677877]
curr_Stock_Price:  100.20159440689851
curr_Factors:  [100.20159441]
mat_Sqrt:  [[0.15]]
grads:  [0.0576474]
Stock Position:  0.05764739854984476
Bond Position:  [15.23041753]


portfolio before change:  [21.02303357]
curr_Stock_Price:  100.46705066635239
curr_Factors:  [100.46705067]
mat_Sqrt:  [[0.15]]
grads:  [0.05379117]
Stock Position:  0.05379117257480127
Bond Position:  [15.61879311]


portfolio before change:  [21.08657367]
curr_Stock_Price:  101.63013922087566
curr_Factors:  [101.63013922]
mat_Sqrt:  [[0.15]]
grads:  [-0.09060909]
Stock Position:  -0.09060908725306982
Bond Position:  [30.29518782]


portfolio before change:  [21.07208371]
curr_Stock_Price:  101.81095410578853
curr_Factors:  [101.81095411]
mat_Sqrt:  [[0.15]]
grads:  [-0.08432967]
Stock Position:  -0.08432967210622651
Bond Position:  [29.65776808]


portfolio before change:  [20.9932388]
curr_Stock_Price:  102.76789580814997
curr_Factors:  [102.76789581]
mat_Sqrt:  [[0.15]]
grads:  [-0.02081595]
Stock Position:  -0.020815951250867215
Bond Position:  [23.13245031]


portfolio before change:  [21.00646739]
curr_Stock_Price:  102.20185055573333
curr_Factors:  [102.20185056]
mat_Sqrt:  [[0.15]]
grads:  [-0.11016182]
Stock Position:  -0.11016181608679713
Bond Position:  [32.26520885]


portfolio before change:  [21.0207275]
curr_Stock_Price:  102.09070975955643
curr_Factors:  [102.09070976]
mat_Sqrt:  [[0.15]]
grads:  [-0.00125719]
Stock Position:  -0.0012571875577323342
Bond Position:  [21.14907467]


portfolio before change:  [21.0219173]
curr_Stock_Price:  102.19575052943593
curr_Factors:  [102.19575053]
mat_Sqrt:  [[0.15]]
grads:  [0.19575555]
Stock Position:  0.19575554699840284
Bond Position:  [1.01653226]


portfolio before change:  [20.96370564]
curr_Stock_Price:  101.89805679738204
curr_Factors:  [101.8980568]
mat_Sqrt:  [[0.15]]
grads:  [0.0122033]
Stock Position:  0.012203302767670636
Bond Position:  [19.7202128]


portfolio before change:  [20.9674961]
curr_Stock_Price:  102.10766507252487
curr_Factors:  [102.10766507]
mat_Sqrt:  [[0.15]]
grads:  [0.04497104]
Stock Position:  0.044971039399028585
Bond Position:  [16.37560827]


portfolio before change:  [20.94826753]
curr_Stock_Price:  101.65732904126648
curr_Factors:  [101.65732904]
mat_Sqrt:  [[0.15]]
grads:  [-0.09026527]
Stock Position:  -0.09026527450407017
Bond Position:  [30.12439424]


portfolio before change:  [20.90093618]
curr_Stock_Price:  102.2025463055548
curr_Factors:  [102.20254631]
mat_Sqrt:  [[0.15]]
grads:  [-0.05240316]
Stock Position:  -0.05240315822563367
Bond Position:  [26.25667238]


portfolio before change:  [20.90797617]
curr_Stock_Price:  102.0995201418675
curr_Factors:  [102.09952014]
mat_Sqrt:  [[0.15]]
grads:  [-0.05199121]
Stock Position:  -0.051991207929190895
Bond Position:  [26.21625355]


portfolio before change:  [20.96769223]
curr_Stock_Price:  100.98245631191334
curr_Factors:  [100.98245631]
mat_Sqrt:  [[0.15]]
grads:  [0.01543888]
Stock Position:  0.015438875163940314
Bond Position:  [19.4086367]


portfolio before change:  [20.97127641]
curr_Stock_Price:  101.13603636976698
curr_Factors:  [101.13603637]
mat_Sqrt:  [[0.15]]
grads:  [0.05675165]
Stock Position:  0.056751652740713913
Bond Position:  [15.2316392]


portfolio before change:  [21.01179293]
curr_Stock_Price:  101.83318795708705
curr_Factors:  [101.83318796]
mat_Sqrt:  [[0.15]]
grads:  [0.02246943]
Stock Position:  0.022469431757351416
Bond Position:  [18.72365906]


portfolio before change:  [21.02589415]
curr_Stock_Price:  102.40867894357154
curr_Factors:  [102.40867894]
mat_Sqrt:  [[0.15]]
grads:  [-0.08612723]
Stock Position:  -0.08612723488017657
Bond Position:  [29.84607049]


portfolio before change:  [21.07272493]
curr_Stock_Price:  101.88659854438497
curr_Factors:  [101.88659854]
mat_Sqrt:  [[0.15]]
grads:  [0.02743881]
Stock Position:  0.027438811848015006
Bond Position:  [18.27707772]


portfolio before change:  [21.08994489]
curr_Stock_Price:  102.4725427737997
curr_Factors:  [102.47254277]
mat_Sqrt:  [[0.15]]
grads:  [-0.03021633]
Stock Position:  -0.03021633129042185
Bond Position:  [24.18628919]


portfolio before change:  [21.08989955]
curr_Stock_Price:  102.52407233147274
curr_Factors:  [102.52407233]
mat_Sqrt:  [[0.15]]
grads:  [0.1268349]
Stock Position:  0.12683490228085936
Bond Position:  [8.08626885]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.08989955]
Stock Price:  103.22118316586857
PL:  [17.86871638]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.66877778e-02]
 [-8.53433525e-04]
 [ 8.18524823e-04]
 [ 1.43083156e-03]
 [ 1.97868497e-02]
 [ 1.18737906e-02]
 [ 1.22826152e-03]
 [ 9.31455219e-03]
 [ 5.64959037e-03]
 [-2.00794750e-02]
 [ 1.01804412e-02]
 [-1.03568217e-02]
 [ 2.85798997e-02]
 [ 7.63702782e-03]
 [ 5.26985043e-04]
 [-1.01086399e-02]
 [ 8.50842855e-03]
 [ 2.55372572e-02]
 [ 1.82153746e-02]
 [-2.52610598e-03]
 [ 4.08569900e-02]
 [-1.24393712e-02]
 [ 6.32771035e-03]
 [-3.30450160e-03]
 [ 1.58373655e-02]
 [ 1.82092591e-02]
 [ 1.11917774e-02]
 [ 5.94928557e-03]
 [ 5.79505650e-03]
 [-1.45844274e-02]
 [-5.51397855e-03]
 [ 1.45602751e-02]
 [ 7.47807197e-03]
 [ 1.88749204e-03]
 [-3.42027373e-03]
 [-4.32431417e-03]
 [-5.80591817e-03]
 [ 3.97309923e-03]
 [ 1.41528648e-03]
 [-9.04519411e-03]
 [-7.81053038e-03]
 [-2.80903860e-03]
 [ 9.54356006e-03]
 [-1.20839610e-02]
 [ 4.75119718e-04]
 [ 2.30433744e-03]
 [-1.36398235e-02]
 [ 2.70556298e-03]
 [ 5.01957493e-03]
 [-7.91858247e-03]
 [-3.34714616e-03]
 [ 3.70084736e-03]
 [ 8.25986410e-04]
 [ 2.02649888e-03]
 [-2.79537493e-03]
 [ 9.31174596e-03]
 [-1.01798923e-02]
 [-9.85022280e-03]
 [ 1.55416400e-02]
 [ 1.50409686e-04]
 [ 1.22461330e-02]
 [-1.51332750e-02]
 [-1.27609011e-02]
 [-3.34185356e-03]
 [ 1.60750868e-02]
 [-1.89308757e-02]
 [ 2.90861244e-02]
 [ 2.19795647e-03]
 [ 6.39262375e-03]
 [-1.37672314e-02]
 [-6.63091772e-03]
 [-3.64347122e-03]
 [ 2.20510807e-03]
 [ 8.56186352e-03]
 [ 3.91255967e-03]
 [-1.13200018e-02]
 [ 7.25790218e-04]
 [-5.70796765e-03]
 [ 1.26116739e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.93002405]
curr_Stock_Price:  99.61460282232139
curr_Factors:  [99.61460282]
mat_Sqrt:  [[0.15]]
grads:  [-0.24458519]
Stock Position:  -0.24458518537830043
Bond Position:  [20.43423205]


portfolio before change:  [-3.98081817]
curr_Stock_Price:  99.82749919921093
curr_Factors:  [99.8274992]
mat_Sqrt:  [[0.15]]
grads:  [-0.00568956]
Stock Position:  -0.0056895568355971645
Bond Position:  [-3.41284394]


portfolio before change:  [-3.98123323]
curr_Stock_Price:  99.86295917674259
curr_Factors:  [99.86295918]
mat_Sqrt:  [[0.15]]
grads:  [0.00545683]
Stock Position:  0.005456832153428801
Bond Position:  [-4.52616864]


portfolio before change:  [-3.98301262]
curr_Stock_Price:  99.58871816171963
curr_Factors:  [99.58871816]
mat_Sqrt:  [[0.15]]
grads:  [0.00953888]
Stock Position:  0.00953887708569633
Bond Position:  [-4.93297716]


portfolio before change:  [-3.97935791]
curr_Stock_Price:  100.00417850751542
curr_Factors:  [100.00417851]
mat_Sqrt:  [[0.15]]
grads:  [0.13191233]
Stock Position:  0.13191233144818443
Bond Position:  [-17.17114225]


portfolio before change:  [-3.94922978]
curr_Stock_Price:  100.2407095276958
curr_Factors:  [100.24070953]
mat_Sqrt:  [[0.15]]
grads:  [0.0791586]
Stock Position:  0.07915860417309001
Bond Position:  [-11.88414443]


portfolio before change:  [-3.94235035]
curr_Stock_Price:  100.33699989298562
curr_Factors:  [100.33699989]
mat_Sqrt:  [[0.15]]
grads:  [0.00818841]
Stock Position:  0.00818841011186992
Bond Position:  [-4.76395086]


portfolio before change:  [-3.93935767]
curr_Stock_Price:  100.73884123987857
curr_Factors:  [100.73884124]
mat_Sqrt:  [[0.15]]
grads:  [0.06209701]
Stock Position:  0.06209701462154445
Bond Position:  [-10.19493897]


portfolio before change:  [-3.95966466]
curr_Stock_Price:  100.42208218169509
curr_Factors:  [100.42208218]
mat_Sqrt:  [[0.15]]
grads:  [0.03766394]
Stock Position:  0.037663935799691364
Bond Position:  [-7.74195552]


portfolio before change:  [-3.96394881]
curr_Stock_Price:  100.32118306642896
curr_Factors:  [100.32118307]
mat_Sqrt:  [[0.15]]
grads:  [-0.13386317]
Stock Position:  -0.1338631668761007
Bond Position:  [9.46536246]


portfolio before change:  [-4.05209875]
curr_Stock_Price:  100.9841103061584
curr_Factors:  [100.98411031]
mat_Sqrt:  [[0.15]]
grads:  [0.06786961]
Stock Position:  0.0678696080274843
Bond Position:  [-10.90585073]


portfolio before change:  [-3.97273677]
curr_Stock_Price:  102.16348378838457
curr_Factors:  [102.16348379]
mat_Sqrt:  [[0.15]]
grads:  [-0.06904548]
Stock Position:  -0.06904547815702647
Bond Position:  [3.08118982]


portfolio before change:  [-4.00955387]
curr_Stock_Price:  102.69950274543369
curr_Factors:  [102.69950275]
mat_Sqrt:  [[0.15]]
grads:  [0.19053266]
Stock Position:  0.19053266449370093
Bond Position:  [-23.57716377]


portfolio before change:  [-4.13567742]
curr_Stock_Price:  102.04528455605487
curr_Factors:  [102.04528456]
mat_Sqrt:  [[0.15]]
grads:  [0.05091352]
Stock Position:  0.05091351879118869
Bond Position:  [-9.33116194]


portfolio before change:  [-4.15772576]
curr_Stock_Price:  101.62368500202889
curr_Factors:  [101.623685]
mat_Sqrt:  [[0.15]]
grads:  [0.00351323]
Stock Position:  0.003513233622140753
Bond Position:  [-4.5147535]


portfolio before change:  [-4.15785908]
curr_Stock_Price:  101.66605591878964
curr_Factors:  [101.66605592]
mat_Sqrt:  [[0.15]]
grads:  [-0.06739093]
Stock Position:  -0.06739093246999976
Bond Position:  [2.69351123]


portfolio before change:  [-4.17484275]
curr_Stock_Price:  101.92057116687099
curr_Factors:  [101.92057117]
mat_Sqrt:  [[0.15]]
grads:  [0.05672286]
Stock Position:  0.056722856974941935
Bond Position:  [-9.95606873]


portfolio before change:  [-4.16306777]
curr_Stock_Price:  102.139129494521
curr_Factors:  [102.13912949]
mat_Sqrt:  [[0.15]]
grads:  [0.17024838]
Stock Position:  0.1702483811561145
Bond Position:  [-21.55208922]


portfolio before change:  [-4.15567738]
curr_Stock_Price:  102.19045117702039
curr_Factors:  [102.19045118]
mat_Sqrt:  [[0.15]]
grads:  [0.12143583]
Stock Position:  0.12143583082278304
Bond Position:  [-16.56525973]


portfolio before change:  [-4.05226161]
curr_Stock_Price:  103.05058559322623
curr_Factors:  [103.05058559]
mat_Sqrt:  [[0.15]]
grads:  [-0.01684071]
Stock Position:  -0.016840706508577923
Bond Position:  [-2.31681694]


portfolio before change:  [-4.04606492]
curr_Stock_Price:  102.67402835293612
curr_Factors:  [102.67402835]
mat_Sqrt:  [[0.15]]
grads:  [0.27237993]
Stock Position:  0.272379933624641
Bond Position:  [-32.01240995]


portfolio before change:  [-4.14083725]
curr_Stock_Price:  102.33343243915914
curr_Factors:  [102.33343244]
mat_Sqrt:  [[0.15]]
grads:  [-0.08292914]
Stock Position:  -0.0829291412415375
Bond Position:  [4.34558642]


portfolio before change:  [-4.1670162]
curr_Stock_Price:  102.65238611692777
curr_Factors:  [102.65238612]
mat_Sqrt:  [[0.15]]
grads:  [0.04218474]
Stock Position:  0.042184735690102684
Bond Position:  [-8.49737998]


portfolio before change:  [-4.20797499]
curr_Stock_Price:  101.69403753325278
curr_Factors:  [101.69403753]
mat_Sqrt:  [[0.15]]
grads:  [-0.02203001]
Stock Position:  -0.02203001069886921
Bond Position:  [-1.96765425]


portfolio before change:  [-4.20138762]
curr_Stock_Price:  101.38943742934445
curr_Factors:  [101.38943743]
mat_Sqrt:  [[0.15]]
grads:  [0.10558244]
Stock Position:  0.1055824369967603
Bond Position:  [-14.90633151]


portfolio before change:  [-4.11157587]
curr_Stock_Price:  102.24889311750871
curr_Factors:  [102.24889312]
mat_Sqrt:  [[0.15]]
grads:  [0.12139506]
Stock Position:  0.12139506094439083
Bond Position:  [-16.52408648]


portfolio before change:  [-4.15965717]
curr_Stock_Price:  101.86132781772606
curr_Factors:  [101.86132782]
mat_Sqrt:  [[0.15]]
grads:  [0.07461185]
Stock Position:  0.0746118490733032
Bond Position:  [-11.75971919]


portfolio before change:  [-4.1362195]
curr_Stock_Price:  102.18530693121834
curr_Factors:  [102.18530693]
mat_Sqrt:  [[0.15]]
grads:  [0.0396619]
Stock Position:  0.039661903829193046
Bond Position:  [-8.18908332]


portfolio before change:  [-4.12918833]
curr_Stock_Price:  102.37548961406554
curr_Factors:  [102.37548961]
mat_Sqrt:  [[0.15]]
grads:  [0.03863371]
Stock Position:  0.03863370998492475
Bond Position:  [-8.0843333]


portfolio before change:  [-4.11911798]
curr_Stock_Price:  102.64923057498488
curr_Factors:  [102.64923057]
mat_Sqrt:  [[0.15]]
grads:  [-0.09722952]
Stock Position:  -0.09722951603577668
Bond Position:  [5.86141703]


portfolio before change:  [-4.03326266]
curr_Stock_Price:  101.76998133615383
curr_Factors:  [101.76998134]
mat_Sqrt:  [[0.15]]
grads:  [-0.03675986]
Stock Position:  -0.0367598570220174
Bond Position:  [-0.29221269]


portfolio before change:  [-4.00628169]
curr_Stock_Price:  101.03550543110023
curr_Factors:  [101.03550543]
mat_Sqrt:  [[0.15]]
grads:  [0.0970685]
Stock Position:  0.09706850046132871
Bond Position:  [-13.8136467]


portfolio before change:  [-3.91484613]
curr_Stock_Price:  101.98636943122952
curr_Factors:  [101.98636943]
mat_Sqrt:  [[0.15]]
grads:  [0.04985381]
Stock Position:  0.04985381312358035
Bond Position:  [-8.99925553]


portfolio before change:  [-3.91587857]
curr_Stock_Price:  101.9769424038396
curr_Factors:  [101.9769424]
mat_Sqrt:  [[0.15]]
grads:  [0.01258328]
Stock Position:  0.012583280286116156
Bond Position:  [-5.19908302]


portfolio before change:  [-3.91652848]
curr_Stock_Price:  101.95111802438304
curr_Factors:  [101.95111802]
mat_Sqrt:  [[0.15]]
grads:  [-0.02280182]
Stock Position:  -0.022801824897130864
Bond Position:  [-1.59185694]


portfolio before change:  [-3.92401898]
curr_Stock_Price:  102.27525908420778
curr_Factors:  [102.27525908]
mat_Sqrt:  [[0.15]]
grads:  [-0.02882876]
Stock Position:  -0.028828761141712664
Bond Position:  [-0.97554997]


portfolio before change:  [-3.94348029]
curr_Stock_Price:  102.9482097430674
curr_Factors:  [102.94820974]
mat_Sqrt:  [[0.15]]
grads:  [-0.03870612]
Stock Position:  -0.03870612116324932
Bond Position:  [0.04124559]


portfolio before change:  [-3.9206059]
curr_Stock_Price:  102.35730029726838
curr_Factors:  [102.3573003]
mat_Sqrt:  [[0.15]]
grads:  [0.02648733]
Stock Position:  0.026487328219122613
Bond Position:  [-6.63177731]


portfolio before change:  [-3.92542919]
curr_Stock_Price:  102.19085124740535
curr_Factors:  [102.19085125]
mat_Sqrt:  [[0.15]]
grads:  [0.00943524]
Stock Position:  0.009435243211041314
Bond Position:  [-4.88962472]


portfolio before change:  [-3.93163736]
curr_Stock_Price:  101.56526461091194
curr_Factors:  [101.56526461]
mat_Sqrt:  [[0.15]]
grads:  [-0.06030129]
Stock Position:  -0.06030129405454462
Bond Position:  [2.19287953]


portfolio before change:  [-3.89464213]
curr_Stock_Price:  100.954031123348
curr_Factors:  [100.95403112]
mat_Sqrt:  [[0.15]]
grads:  [-0.0520702]
Stock Position:  -0.0520702025380157
Bond Position:  [1.36205472]


portfolio before change:  [-3.88933517]
curr_Stock_Price:  100.85374671761312
curr_Factors:  [100.85374672]
mat_Sqrt:  [[0.15]]
grads:  [-0.01872692]
Stock Position:  -0.01872692397733428
Bond Position:  [-2.00065472]


portfolio before change:  [-3.89809314]
curr_Stock_Price:  101.31473663318717
curr_Factors:  [101.31473663]
mat_Sqrt:  [[0.15]]
grads:  [0.06362373]
Stock Position:  0.0636237337092708
Bond Position:  [-10.34411496]


portfolio before change:  [-3.86388759]
curr_Stock_Price:  101.86252082695552
curr_Factors:  [101.86252083]
mat_Sqrt:  [[0.15]]
grads:  [-0.08055974]
Stock Position:  -0.0805597402039107
Bond Position:  [4.34213062]


portfolio before change:  [-3.87677409]
curr_Stock_Price:  102.0258516985265
curr_Factors:  [102.0258517]
mat_Sqrt:  [[0.15]]
grads:  [0.00316746]
Stock Position:  0.0031674647846268887
Bond Position:  [-4.19993738]


portfolio before change:  [-3.87565358]
curr_Stock_Price:  102.46248515818814
curr_Factors:  [102.46248516]
mat_Sqrt:  [[0.15]]
grads:  [0.01536225]
Stock Position:  0.0153622495929747
Bond Position:  [-5.44970785]


portfolio before change:  [-3.87221663]
curr_Stock_Price:  102.70838393466022
curr_Factors:  [102.70838393]
mat_Sqrt:  [[0.15]]
grads:  [-0.09093216]
Stock Position:  -0.09093215665517283
Bond Position:  [5.46727822]


portfolio before change:  [-3.89351337]
curr_Stock_Price:  102.9463464903992
curr_Factors:  [102.94634649]
mat_Sqrt:  [[0.15]]
grads:  [0.01803709]
Stock Position:  0.018037086544147377
Bond Position:  [-5.75036553]


portfolio before change:  [-3.89691554]
curr_Stock_Price:  102.77765169191863
curr_Factors:  [102.77765169]
mat_Sqrt:  [[0.15]]
grads:  [0.03346383]
Stock Position:  0.03346383284150725
Bond Position:  [-7.33624969]


portfolio before change:  [-3.88631715]
curr_Stock_Price:  103.10806582836165
curr_Factors:  [103.10806583]
mat_Sqrt:  [[0.15]]
grads:  [-0.05279055]
Stock Position:  -0.05279054981055542
Bond Position:  [1.55681434]


portfolio before change:  [-3.85741507]
curr_Stock_Price:  102.56242317316998
curr_Factors:  [102.56242317]
mat_Sqrt:  [[0.15]]
grads:  [-0.02231431]
Stock Position:  -0.022314307701175765
Bond Position:  [-1.5688056]


portfolio before change:  [-3.84306965]
curr_Stock_Price:  101.91514917087962
curr_Factors:  [101.91514917]
mat_Sqrt:  [[0.15]]
grads:  [0.02467232]
Stock Position:  0.024672315758627474
Bond Position:  [-6.35755239]


portfolio before change:  [-3.83385635]
curr_Stock_Price:  102.30468113604897
curr_Factors:  [102.30468114]
mat_Sqrt:  [[0.15]]
grads:  [0.00550658]
Stock Position:  0.005506576064122481
Bond Position:  [-4.39720486]


portfolio before change:  [-3.8367995]
curr_Stock_Price:  101.82011318426459
curr_Factors:  [101.82011318]
mat_Sqrt:  [[0.15]]
grads:  [0.01350999]
Stock Position:  0.013509992548955307
Bond Position:  [-5.21238847]


portfolio before change:  [-3.82609184]
curr_Stock_Price:  102.6368007275222
curr_Factors:  [102.63680073]
mat_Sqrt:  [[0.15]]
grads:  [-0.01863583]
Stock Position:  -0.018635832859419707
Bond Position:  [-1.91336957]


portfolio before change:  [-3.83461231]
curr_Stock_Price:  103.08759291977464
curr_Factors:  [103.08759292]
mat_Sqrt:  [[0.15]]
grads:  [0.06207831]
Stock Position:  0.062078306422838625
Bond Position:  [-10.2341155]


portfolio before change:  [-3.79118808]
curr_Stock_Price:  103.79740424217457
curr_Factors:  [103.79740424]
mat_Sqrt:  [[0.15]]
grads:  [-0.06786595]
Stock Position:  -0.06786594879788115
Bond Position:  [3.25312124]


portfolio before change:  [-3.7868253]
curr_Stock_Price:  103.73611496881166
curr_Factors:  [103.73611497]
mat_Sqrt:  [[0.15]]
grads:  [-0.06566815]
Stock Position:  -0.06566815198691187
Bond Position:  [3.02533366]


portfolio before change:  [-3.7690069]
curr_Stock_Price:  103.46765439372145
curr_Factors:  [103.46765439]
mat_Sqrt:  [[0.15]]
grads:  [0.10361093]
Stock Position:  0.10361093315542946
Bond Position:  [-14.48938713]


portfolio before change:  [-3.75022599]
curr_Stock_Price:  103.65765873124568
curr_Factors:  [103.65765873]
mat_Sqrt:  [[0.15]]
grads:  [0.00100273]
Stock Position:  0.0010027312399594457
Bond Position:  [-3.85416676]


portfolio before change:  [-3.75075673]
curr_Stock_Price:  103.36859890599673
curr_Factors:  [103.36859891]
mat_Sqrt:  [[0.15]]
grads:  [0.08164089]
Stock Position:  0.08164088634991461
Bond Position:  [-12.18986077]


portfolio before change:  [-3.73213115]
curr_Stock_Price:  103.60607143969705
curr_Factors:  [103.60607144]
mat_Sqrt:  [[0.15]]
grads:  [-0.1008885]
Stock Position:  -0.1008885003239018
Bond Position:  [6.72053002]


portfolio before change:  [-3.79207703]
curr_Stock_Price:  104.20441441163045
curr_Factors:  [104.20441441]
mat_Sqrt:  [[0.15]]
grads:  [-0.08507267]
Stock Position:  -0.08507267403276104
Bond Position:  [5.07287115]


portfolio before change:  [-3.75269199]
curr_Stock_Price:  103.7451837509275
curr_Factors:  [103.74518375]
mat_Sqrt:  [[0.15]]
grads:  [-0.02227902]
Stock Position:  -0.02227902374075111
Bond Position:  [-1.44135058]


portfolio before change:  [-3.75608716]
curr_Stock_Price:  103.89353316271803
curr_Factors:  [103.89353316]
mat_Sqrt:  [[0.15]]
grads:  [0.10716725]
Stock Position:  0.10716724556968099
Bond Position:  [-14.89007094]


portfolio before change:  [-3.82763873]
curr_Stock_Price:  103.23455457679408
curr_Factors:  [103.23455458]
mat_Sqrt:  [[0.15]]
grads:  [-0.12620584]
Stock Position:  -0.1262058377136184
Bond Position:  [9.20116471]


portfolio before change:  [-3.75435602]
curr_Stock_Price:  102.65845108555592
curr_Factors:  [102.65845109]
mat_Sqrt:  [[0.15]]
grads:  [0.1939075]
Stock Position:  0.19390749586551728
Bond Position:  [-23.6605992]


portfolio before change:  [-3.82595618]
curr_Stock_Price:  102.29682850051897
curr_Factors:  [102.2968285]
mat_Sqrt:  [[0.15]]
grads:  [0.01465304]
Stock Position:  0.01465304313631478
Bond Position:  [-5.32491602]


portfolio before change:  [-3.8337865]
curr_Stock_Price:  101.78515987092204
curr_Factors:  [101.78515987]
mat_Sqrt:  [[0.15]]
grads:  [0.04261749]
Stock Position:  0.042617491685472436
Bond Position:  [-8.17161471]


portfolio before change:  [-3.86100368]
curr_Stock_Price:  101.15850552286348
curr_Factors:  [101.15850552]
mat_Sqrt:  [[0.15]]
grads:  [-0.09178154]
Stock Position:  -0.091781542478115
Bond Position:  [5.42347999]


portfolio before change:  [-3.79044173]
curr_Stock_Price:  100.39339557913503
curr_Factors:  [100.39339558]
mat_Sqrt:  [[0.15]]
grads:  [-0.04420612]
Stock Position:  -0.04420611815185618
Bond Position:  [0.64756057]


portfolio before change:  [-3.82113099]
curr_Stock_Price:  101.08854212540237
curr_Factors:  [101.08854213]
mat_Sqrt:  [[0.15]]
grads:  [-0.02428981]
Stock Position:  -0.024289808128778387
Bond Position:  [-1.3657097]


portfolio before change:  [-3.82632367]
curr_Stock_Price:  101.29880802085381
curr_Factors:  [101.29880802]
mat_Sqrt:  [[0.15]]
grads:  [0.01470072]
Stock Position:  0.014700720468670386
Bond Position:  [-5.31548913]


portfolio before change:  [-3.83205183]
curr_Stock_Price:  100.93175545044983
curr_Factors:  [100.93175545]
mat_Sqrt:  [[0.15]]
grads:  [0.05707909]
Stock Position:  0.05707909015223892
Bond Position:  [-9.5931446]


portfolio before change:  [-3.78741931]
curr_Stock_Price:  101.72420178823191
curr_Factors:  [101.72420179]
mat_Sqrt:  [[0.15]]
grads:  [0.02608373]
Stock Position:  0.026083731135960558
Bond Position:  [-6.44076604]


portfolio before change:  [-3.7917316]
curr_Stock_Price:  101.57431007717896
curr_Factors:  [101.57431008]
mat_Sqrt:  [[0.15]]
grads:  [-0.07546668]
Stock Position:  -0.07546667883420691
Bond Position:  [3.87374423]


portfolio before change:  [-3.7427998]
curr_Stock_Price:  100.92912887003487
curr_Factors:  [100.92912887]
mat_Sqrt:  [[0.15]]
grads:  [0.0048386]
Stock Position:  0.004838601453572983
Bond Position:  [-4.23115563]


portfolio before change:  [-3.73928601]
curr_Stock_Price:  101.70998460408134
curr_Factors:  [101.7099846]
mat_Sqrt:  [[0.15]]
grads:  [-0.03805312]
Stock Position:  -0.038053117639359424
Bond Position:  [0.131096]


portfolio before change:  [-3.72710009]
curr_Stock_Price:  101.38996544182744
curr_Factors:  [101.38996544]
mat_Sqrt:  [[0.15]]
grads:  [0.08407783]
Stock Position:  0.08407782615565507
Bond Position:  [-12.25174798]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.72710009]
Stock Price:  102.11187984368296
PL:  [-5.83897993]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.38191363e-02]
 [-2.37451876e-03]
 [ 4.40934346e-03]
 [ 2.77007374e-03]
 [ 6.27452888e-03]
 [ 1.19684963e-02]
 [ 4.13211871e-05]
 [ 6.32679832e-03]
 [-7.00076055e-03]
 [-1.99856466e-02]
 [ 1.02204518e-02]
 [-7.62421590e-03]
 [ 7.65985141e-03]
 [ 4.19726238e-03]
 [ 6.55545418e-03]
 [-1.29902576e-03]
 [ 5.56329901e-03]
 [ 6.57580815e-03]
 [ 1.91102938e-02]
 [ 1.35208309e-02]
 [ 3.63430533e-02]
 [-1.87326326e-02]
 [-1.18928446e-03]
 [ 1.09161264e-02]
 [ 1.91707818e-04]
 [ 1.29631329e-02]
 [ 1.36693145e-02]
 [-1.82785158e-02]
 [ 1.88081140e-03]
 [-7.46776576e-03]
 [-3.71757821e-03]
 [-1.13491218e-02]
 [ 1.57887112e-02]
 [ 1.90802752e-02]
 [-4.58315330e-03]
 [ 4.85645537e-03]
 [-2.31530330e-03]
 [ 5.16093260e-03]
 [ 3.30371440e-03]
 [-1.44779084e-02]
 [ 2.55981308e-02]
 [-8.54109451e-04]
 [ 5.34599163e-03]
 [-8.44470763e-03]
 [ 1.63065490e-03]
 [-5.04959055e-03]
 [-1.35631215e-02]
 [-9.27080976e-04]
 [-8.09328599e-03]
 [ 9.13442862e-03]
 [-3.13981597e-03]
 [ 3.43161440e-03]
 [ 1.87646220e-03]
 [ 5.24107205e-04]
 [ 1.41981249e-03]
 [ 9.01484549e-03]
 [ 1.26730813e-02]
 [-2.14028487e-02]
 [ 1.40610994e-02]
 [ 8.29827573e-03]
 [ 5.33828785e-03]
 [-1.24792901e-02]
 [-1.25596901e-02]
 [-2.17307478e-03]
 [-1.69183932e-02]
 [ 3.20097160e-02]
 [ 2.57387941e-02]
 [ 1.82645307e-03]
 [ 6.63816917e-03]
 [-1.55323236e-02]
 [-7.72821313e-03]
 [-7.70208600e-03]
 [ 3.73707582e-03]
 [ 7.01609629e-03]
 [-8.22375898e-04]
 [-1.27630643e-02]
 [ 7.87281656e-03]
 [-3.81931046e-03]
 [ 2.48309942e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.93069461]
curr_Stock_Price:  100.2483577147518
curr_Factors:  [100.24835771]
mat_Sqrt:  [[0.15]]
grads:  [-0.29212758]
Stock Position:  -0.2921275754268497
Bond Position:  [35.21600429]


portfolio before change:  [5.98595106]
curr_Stock_Price:  100.06674055069365
curr_Factors:  [100.06674055]
mat_Sqrt:  [[0.15]]
grads:  [-0.01583013]
Stock Position:  -0.01583012506207329
Bond Position:  [7.57002008]


portfolio before change:  [5.96967966]
curr_Stock_Price:  101.12450475810839
curr_Factors:  [101.12450476]
mat_Sqrt:  [[0.15]]
grads:  [0.02939562]
Stock Position:  0.029395623085382138
Bond Position:  [2.99706183]


portfolio before change:  [5.97254924]
curr_Stock_Price:  101.21575151067138
curr_Factors:  [101.21575151]
mat_Sqrt:  [[0.15]]
grads:  [0.01846716]
Stock Position:  0.01846715827186324
Bond Position:  [4.10338193]


portfolio before change:  [5.97507745]
curr_Stock_Price:  101.33876667958589
curr_Factors:  [101.33876668]
mat_Sqrt:  [[0.15]]
grads:  [0.04183019]
Stock Position:  0.04183019251712266
Bond Position:  [1.73605733]


portfolio before change:  [5.96374226]
curr_Stock_Price:  101.06519166265926
curr_Factors:  [101.06519166]
mat_Sqrt:  [[0.15]]
grads:  [0.07978998]
Stock Position:  0.07978997529258373
Bond Position:  [-2.10024689]


portfolio before change:  [5.99354825]
curr_Stock_Price:  101.44039247276523
curr_Factors:  [101.44039247]
mat_Sqrt:  [[0.15]]
grads:  [0.00027547]
Stock Position:  0.0002754745806293114
Bond Position:  [5.965604]


portfolio before change:  [5.99389933]
curr_Stock_Price:  101.36131835728891
curr_Factors:  [101.36131836]
mat_Sqrt:  [[0.15]]
grads:  [0.04217866]
Stock Position:  0.042178655470768045
Bond Position:  [1.71861521]


portfolio before change:  [6.00067661]
curr_Stock_Price:  101.51945198874269
curr_Factors:  [101.51945199]
mat_Sqrt:  [[0.15]]
grads:  [-0.04667174]
Stock Position:  -0.046671737003171336
Bond Position:  [10.73876578]


portfolio before change:  [6.02135372]
curr_Stock_Price:  101.09080047773757
curr_Factors:  [101.09080048]
mat_Sqrt:  [[0.15]]
grads:  [-0.13323764]
Stock Position:  -0.13323764419464826
Bond Position:  [19.49045382]


portfolio before change:  [6.1026058]
curr_Stock_Price:  100.49011520274748
curr_Factors:  [100.4901152]
mat_Sqrt:  [[0.15]]
grads:  [0.06813635]
Stock Position:  0.06813634547734283
Bond Position:  [-0.74442341]


portfolio before change:  [6.15072886]
curr_Stock_Price:  101.19707394495038
curr_Factors:  [101.19707394]
mat_Sqrt:  [[0.15]]
grads:  [-0.05082811]
Stock Position:  -0.05082810596703718
Bond Position:  [11.29438445]


portfolio before change:  [6.16157016]
curr_Stock_Price:  100.99766876810229
curr_Factors:  [100.99766877]
mat_Sqrt:  [[0.15]]
grads:  [0.05106568]
Stock Position:  0.05106567603530743
Bond Position:  [1.00405593]


portfolio before change:  [6.15335448]
curr_Stock_Price:  100.83555524775115
curr_Factors:  [100.83555525]
mat_Sqrt:  [[0.15]]
grads:  [0.02798175]
Stock Position:  0.027981749193463197
Bond Position:  [3.33179927]


portfolio before change:  [6.13840285]
curr_Stock_Price:  100.29377792087199
curr_Factors:  [100.29377792]
mat_Sqrt:  [[0.15]]
grads:  [0.04370303]
Stock Position:  0.0437030278937334
Bond Position:  [1.75526108]


portfolio before change:  [6.13261171]
curr_Stock_Price:  100.15875647814367
curr_Factors:  [100.15875648]
mat_Sqrt:  [[0.15]]
grads:  [-0.00866017]
Stock Position:  -0.008660171727499638
Bond Position:  [7.00000374]


portfolio before change:  [6.13609493]
curr_Stock_Price:  99.8070655192066
curr_Factors:  [99.80706552]
mat_Sqrt:  [[0.15]]
grads:  [0.03708866]
Stock Position:  0.0370886600471762
Bond Position:  [2.43438461]


portfolio before change:  [6.11764163]
curr_Stock_Price:  99.30541761162733
curr_Factors:  [99.30541761]
mat_Sqrt:  [[0.15]]
grads:  [0.04383872]
Stock Position:  0.04383872100510201
Bond Position:  [1.76421914]


portfolio before change:  [6.10150128]
curr_Stock_Price:  98.93472653586898
curr_Factors:  [98.93472654]
mat_Sqrt:  [[0.15]]
grads:  [0.12740196]
Stock Position:  0.1274019588252552
Bond Position:  [-6.50297668]


portfolio before change:  [6.0622083]
curr_Stock_Price:  98.6294994362357
curr_Factors:  [98.62949944]
mat_Sqrt:  [[0.15]]
grads:  [0.09013887]
Stock Position:  0.09013887233892914
Bond Position:  [-2.82814356]


portfolio before change:  [6.06881567]
curr_Stock_Price:  98.70476254256752
curr_Factors:  [98.70476254]
mat_Sqrt:  [[0.15]]
grads:  [0.24228702]
Stock Position:  0.24228702226652754
Bond Position:  [-17.84606733]


portfolio before change:  [6.05434444]
curr_Stock_Price:  98.64963860874977
curr_Factors:  [98.64963861]
mat_Sqrt:  [[0.15]]
grads:  [-0.12488422]
Stock Position:  -0.12488421746224512
Bond Position:  [18.37412736]


portfolio before change:  [6.03334101]
curr_Stock_Price:  98.82701770778453
curr_Factors:  [98.82701771]
mat_Sqrt:  [[0.15]]
grads:  [-0.00792856]
Stock Position:  -0.0079285630692768
Bond Position:  [6.81689725]


portfolio before change:  [6.03760838]
curr_Stock_Price:  98.34252906266524
curr_Factors:  [98.34252906]
mat_Sqrt:  [[0.15]]
grads:  [0.07277418]
Stock Position:  0.07277417625389238
Bond Position:  [-1.11918817]


portfolio before change:  [5.99604382]
curr_Stock_Price:  97.77234592908546
curr_Factors:  [97.77234593]
mat_Sqrt:  [[0.15]]
grads:  [0.00127805]
Stock Position:  0.0012780521201899778
Bond Position:  [5.87108566]


portfolio before change:  [5.99667414]
curr_Stock_Price:  97.97841787911287
curr_Factors:  [97.97841788]
mat_Sqrt:  [[0.15]]
grads:  [0.08642089]
Stock Position:  0.0864208858402244
Bond Position:  [-2.47070752]


portfolio before change:  [6.01878514]
curr_Stock_Price:  98.23605728934571
curr_Factors:  [98.23605729]
mat_Sqrt:  [[0.15]]
grads:  [0.09112876]
Stock Position:  0.09112876321823417
Bond Position:  [-2.93334526]


portfolio before change:  [6.02935607]
curr_Stock_Price:  98.35406899740944
curr_Factors:  [98.354069]
mat_Sqrt:  [[0.15]]
grads:  [-0.12185677]
Stock Position:  -0.12185677186874751
Bond Position:  [18.01446541]


portfolio before change:  [6.01309008]
curr_Stock_Price:  98.49679334762692
curr_Factors:  [98.49679335]
mat_Sqrt:  [[0.15]]
grads:  [0.01253874]
Stock Position:  0.012538742690666033
Bond Position:  [4.77806413]


portfolio before change:  [6.00976813]
curr_Stock_Price:  98.20804188759566
curr_Factors:  [98.20804189]
mat_Sqrt:  [[0.15]]
grads:  [-0.04978511]
Stock Position:  -0.049785105068679794
Bond Position:  [10.89906582]


portfolio before change:  [5.99010094]
curr_Stock_Price:  98.61676662526314
curr_Factors:  [98.61676663]
mat_Sqrt:  [[0.15]]
grads:  [-0.02478385]
Stock Position:  -0.024783854738115372
Bond Position:  [8.43420456]


portfolio before change:  [5.97117164]
curr_Stock_Price:  99.40181213165307
curr_Factors:  [99.40181213]
mat_Sqrt:  [[0.15]]
grads:  [-0.07566081]
Stock Position:  -0.07566081186591342
Bond Position:  [13.49199345]


portfolio before change:  [5.95857149]
curr_Stock_Price:  99.57949235462895
curr_Factors:  [99.57949235]
mat_Sqrt:  [[0.15]]
grads:  [0.10525807]
Stock Position:  0.10525807447169191
Bond Position:  [-4.52297413]


portfolio before change:  [5.96879216]
curr_Stock_Price:  99.67927911364994
curr_Factors:  [99.67927911]
mat_Sqrt:  [[0.15]]
grads:  [0.12720183]
Stock Position:  0.12720183487852418
Bond Position:  [-6.71059505]


portfolio before change:  [5.95388585]
curr_Stock_Price:  99.56539018733257
curr_Factors:  [99.56539019]
mat_Sqrt:  [[0.15]]
grads:  [-0.03055436]
Stock Position:  -0.030554355334924354
Bond Position:  [8.99604216]


portfolio before change:  [5.96854876]
curr_Stock_Price:  99.10389664619707
curr_Factors:  [99.10389665]
mat_Sqrt:  [[0.15]]
grads:  [0.03237637]
Stock Position:  0.03237636914471544
Bond Position:  [2.75992442]


portfolio before change:  [5.96030942]
curr_Stock_Price:  98.84408243725562
curr_Factors:  [98.84408244]
mat_Sqrt:  [[0.15]]
grads:  [-0.01543536]
Stock Position:  -0.015435355328613967
Bond Position:  [7.48600295]


portfolio before change:  [5.97609111]
curr_Stock_Price:  97.85195749307024
curr_Factors:  [97.85195749]
mat_Sqrt:  [[0.15]]
grads:  [0.03440622]
Stock Position:  0.03440621734295537
Bond Position:  [2.60937539]


portfolio before change:  [5.98928829]
curr_Stock_Price:  98.23078688860471
curr_Factors:  [98.23078689]
mat_Sqrt:  [[0.15]]
grads:  [0.02202476]
Stock Position:  0.022024762643339402
Bond Position:  [3.82577852]


portfolio before change:  [5.99313976]
curr_Stock_Price:  98.39480009677783
curr_Factors:  [98.3948001]
mat_Sqrt:  [[0.15]]
grads:  [-0.09651939]
Stock Position:  -0.09651938906456599
Bond Position:  [15.49014575]


portfolio before change:  [6.01928973]
curr_Stock_Price:  98.13390119128972
curr_Factors:  [98.13390119]
mat_Sqrt:  [[0.15]]
grads:  [0.17065421]
Stock Position:  0.17065420515693985
Bond Position:  [-10.72767318]


portfolio before change:  [5.96416265]
curr_Stock_Price:  97.8147963804613
curr_Factors:  [97.81479638]
mat_Sqrt:  [[0.15]]
grads:  [-0.00569406]
Stock Position:  -0.005694063003991187
Bond Position:  [6.52112626]


portfolio before change:  [5.96637722]
curr_Stock_Price:  97.49745067733866
curr_Factors:  [97.49745068]
mat_Sqrt:  [[0.15]]
grads:  [0.03563994]
Stock Position:  0.03563994418715702
Bond Position:  [2.49157352]


portfolio before change:  [5.97279835]
curr_Stock_Price:  97.67324783656387
curr_Factors:  [97.67324784]
mat_Sqrt:  [[0.15]]
grads:  [-0.05629805]
Stock Position:  -0.05629805086961528
Bond Position:  [11.47161182]


portfolio before change:  [5.95269621]
curr_Stock_Price:  98.04304985530217
curr_Factors:  [98.04304986]
mat_Sqrt:  [[0.15]]
grads:  [0.01087103]
Stock Position:  0.010871032679948708
Bond Position:  [4.88686701]


portfolio before change:  [5.94945171]
curr_Stock_Price:  97.71649946403545
curr_Factors:  [97.71649946]
mat_Sqrt:  [[0.15]]
grads:  [-0.03366394]
Stock Position:  -0.03366393697075496
Bond Position:  [9.23897379]


portfolio before change:  [5.95704118]
curr_Stock_Price:  97.50820484578558
curr_Factors:  [97.50820485]
mat_Sqrt:  [[0.15]]
grads:  [-0.09042081]
Stock Position:  -0.09042080984799328
Bond Position:  [14.77381203]


portfolio before change:  [5.92075935]
curr_Stock_Price:  97.91967232118657
curr_Factors:  [97.91967232]
mat_Sqrt:  [[0.15]]
grads:  [-0.00618054]
Stock Position:  -0.006180539840483952
Bond Position:  [6.52595579]


portfolio before change:  [5.91591042]
curr_Stock_Price:  98.77021470389828
curr_Factors:  [98.7702147]
mat_Sqrt:  [[0.15]]
grads:  [-0.05395524]
Stock Position:  -0.0539552399598002
Bond Position:  [11.24508106]


portfolio before change:  [5.92335015]
curr_Stock_Price:  98.64535396931588
curr_Factors:  [98.64535397]
mat_Sqrt:  [[0.15]]
grads:  [0.06089619]
Stock Position:  0.060896190822261914
Bond Position:  [-0.08377614]


portfolio before change:  [5.93005012]
curr_Stock_Price:  98.75546264696098
curr_Factors:  [98.75546265]
mat_Sqrt:  [[0.15]]
grads:  [-0.02093211]
Stock Position:  -0.020932106462748904
Bond Position:  [7.99720998]


portfolio before change:  [5.92083006]
curr_Stock_Price:  99.21981629408944
curr_Factors:  [99.21981629]
mat_Sqrt:  [[0.15]]
grads:  [0.02287743]
Stock Position:  0.022877429350160516
Bond Position:  [3.65093572]


portfolio before change:  [5.9271541]
curr_Stock_Price:  99.4862732129297
curr_Factors:  [99.48627321]
mat_Sqrt:  [[0.15]]
grads:  [0.01250975]
Stock Position:  0.012509748013666536
Bond Position:  [4.68260589]


portfolio before change:  [5.91852942]
curr_Stock_Price:  98.77344099856026
curr_Factors:  [98.773441]
mat_Sqrt:  [[0.15]]
grads:  [0.00349405]
Stock Position:  0.003494048034864577
Bond Position:  [5.57341027]


portfolio before change:  [5.91989806]
curr_Stock_Price:  99.06544987819865
curr_Factors:  [99.06544988]
mat_Sqrt:  [[0.15]]
grads:  [0.00946542]
Stock Position:  0.009465416589909176
Bond Position:  [4.98220231]


portfolio before change:  [5.92322434]
curr_Stock_Price:  99.38396510323312
curr_Factors:  [99.3839651]
mat_Sqrt:  [[0.15]]
grads:  [0.06009897]
Stock Position:  0.060098969932149936
Bond Position:  [-0.04964959]


portfolio before change:  [5.95165148]
curr_Stock_Price:  99.8570221856165
curr_Factors:  [99.85702219]
mat_Sqrt:  [[0.15]]
grads:  [0.08448721]
Stock Position:  0.08448720854012423
Bond Position:  [-2.48498958]


portfolio before change:  [5.99308108]
curr_Stock_Price:  100.34922596695016
curr_Factors:  [100.34922597]
mat_Sqrt:  [[0.15]]
grads:  [-0.14268566]
Stock Position:  -0.14268565806886413
Bond Position:  [20.31147643]


portfolio before change:  [6.05124684]
curr_Stock_Price:  99.95047354333916
curr_Factors:  [99.95047354]
mat_Sqrt:  [[0.15]]
grads:  [0.09374066]
Stock Position:  0.09374066293754298
Bond Position:  [-3.31817681]


portfolio before change:  [6.05438995]
curr_Stock_Price:  99.98621573995267
curr_Factors:  [99.98621574]
mat_Sqrt:  [[0.15]]
grads:  [0.05532184]
Stock Position:  0.05532183818439878
Bond Position:  [0.5229687]


portfolio before change:  [6.01631819]
curr_Stock_Price:  99.29743803139624
curr_Factors:  [99.29743803]
mat_Sqrt:  [[0.15]]
grads:  [0.03558859]
Stock Position:  0.03558858566105088
Bond Position:  [2.48246281]


portfolio before change:  [6.03139275]
curr_Stock_Price:  99.71665674183168
curr_Factors:  [99.71665674]
mat_Sqrt:  [[0.15]]
grads:  [-0.08319527]
Stock Position:  -0.08319526746434255
Bond Position:  [14.32734667]


portfolio before change:  [6.07822429]
curr_Stock_Price:  99.16450921415213
curr_Factors:  [99.16450921]
mat_Sqrt:  [[0.15]]
grads:  [-0.08373127]
Stock Position:  -0.08373126752308918
Bond Position:  [14.38139434]


portfolio before change:  [6.0193441]
curr_Stock_Price:  99.87844870166238
curr_Factors:  [99.8784487]
mat_Sqrt:  [[0.15]]
grads:  [-0.01448717]
Stock Position:  -0.014487165210324693
Bond Position:  [7.46629969]


portfolio before change:  [6.01610173]
curr_Stock_Price:  100.13447011927515
curr_Factors:  [100.13447012]
mat_Sqrt:  [[0.15]]
grads:  [-0.11278929]
Stock Position:  -0.11278928773096288
Bond Position:  [17.3101973]


portfolio before change:  [5.9392612]
curr_Stock_Price:  100.82533765695966
curr_Factors:  [100.82533766]
mat_Sqrt:  [[0.15]]
grads:  [0.21339811]
Stock Position:  0.21339810635743722
Bond Position:  [-15.57667493]


portfolio before change:  [6.10315547]
curr_Stock_Price:  101.59792112456245
curr_Factors:  [101.59792112]
mat_Sqrt:  [[0.15]]
grads:  [0.17159196]
Stock Position:  0.1715919609867068
Bond Position:  [-11.33023104]


portfolio before change:  [6.06249302]
curr_Stock_Price:  101.36507631650751
curr_Factors:  [101.36507632]
mat_Sqrt:  [[0.15]]
grads:  [0.01217635]
Stock Position:  0.01217635376937681
Bond Position:  [4.82823599]


portfolio before change:  [6.07090243]
curr_Stock_Price:  102.03092751063934
curr_Factors:  [102.03092751]
mat_Sqrt:  [[0.15]]
grads:  [0.04425446]
Stock Position:  0.04425446113589216
Bond Position:  [1.55557871]


portfolio before change:  [6.09534164]
curr_Stock_Price:  102.58097342488239
curr_Factors:  [102.58097342]
mat_Sqrt:  [[0.15]]
grads:  [-0.10354882]
Stock Position:  -0.1035488236819895
Bond Position:  [16.71748077]


portfolio before change:  [6.00264335]
curr_Stock_Price:  103.48627743120042
curr_Factors:  [103.48627743]
mat_Sqrt:  [[0.15]]
grads:  [-0.05152142]
Stock Position:  -0.051521420876219165
Bond Position:  [11.33440341]


portfolio before change:  [6.02873972]
curr_Stock_Price:  102.99351260284813
curr_Factors:  [102.9935126]
mat_Sqrt:  [[0.15]]
grads:  [-0.05134724]
Stock Position:  -0.051347240004033054
Bond Position:  [11.31717233]


portfolio before change:  [6.02096714]
curr_Stock_Price:  103.15866111681494
curr_Factors:  [103.15866112]
mat_Sqrt:  [[0.15]]
grads:  [0.02491384]
Stock Position:  0.02491383880910562
Bond Position:  [3.45088889]


portfolio before change:  [6.03729901]
curr_Stock_Price:  103.80553766416485
curr_Factors:  [103.80553766]
mat_Sqrt:  [[0.15]]
grads:  [0.04677398]
Stock Position:  0.046773975263884625
Bond Position:  [1.18190136]


portfolio before change:  [6.00746566]
curr_Stock_Price:  103.16613884392893
curr_Factors:  [103.16613884]
mat_Sqrt:  [[0.15]]
grads:  [-0.00548251]
Stock Position:  -0.005482505986332947
Bond Position:  [6.57307463]


portfolio before change:  [6.0097811]
curr_Stock_Price:  102.81874069960797
curr_Factors:  [102.8187407]
mat_Sqrt:  [[0.15]]
grads:  [-0.0850871]
Stock Position:  -0.08508709520994903
Bond Position:  [14.75832908]


portfolio before change:  [5.92809432]
curr_Stock_Price:  103.7896188713845
curr_Factors:  [103.78961887]
mat_Sqrt:  [[0.15]]
grads:  [0.05248544]
Stock Position:  0.05248544375319448
Bond Position:  [0.48065012]


portfolio before change:  [5.95290303]
curr_Stock_Price:  104.26172449774457
curr_Factors:  [104.2617245]
mat_Sqrt:  [[0.15]]
grads:  [-0.02546207]
Stock Position:  -0.025462069749097906
Bond Position:  [8.60762234]


portfolio before change:  [5.95923122]
curr_Stock_Price:  104.0343199642818
curr_Factors:  [104.03431996]
mat_Sqrt:  [[0.15]]
grads:  [0.16553996]
Stock Position:  0.16553996124378484
Bond Position:  [-11.26260608]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.95923122]
Stock Price:  103.95163712086895
PL:  [2.0075941]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-6.52148534e-02]
 [ 2.26561357e-03]
 [ 1.14501249e-02]
 [ 3.33330110e-03]
 [ 6.25389508e-03]
 [ 1.21844778e-02]
 [-6.44022290e-05]
 [ 5.83144114e-03]
 [-3.27110288e-03]
 [-1.16189661e-02]
 [ 1.00642309e-02]
 [-1.04659499e-02]
 [ 3.10594429e-02]
 [ 1.02504314e-02]
 [-4.56889061e-03]
 [-8.52199544e-03]
 [ 1.26839022e-02]
 [ 2.42708920e-02]
 [-9.70647778e-04]
 [-7.61512616e-04]
 [ 3.92993463e-02]
 [-1.03785734e-02]
 [ 7.56854856e-04]
 [ 4.98556669e-03]
 [ 1.85339202e-02]
 [ 1.46088200e-02]
 [ 6.53395557e-03]
 [ 4.66777333e-03]
 [ 8.92611797e-03]
 [-9.45304598e-03]
 [-5.76714449e-03]
 [ 4.19306646e-02]
 [ 5.41568688e-03]
 [-5.09890176e-03]
 [-5.02932449e-03]
 [-3.84825323e-03]
 [-4.33803451e-03]
 [ 2.99334421e-03]
 [ 3.58769285e-03]
 [-7.12360154e-03]
 [-4.76686359e-02]
 [-3.52471591e-03]
 [ 1.32106471e-02]
 [-1.19180478e-02]
 [-3.27017689e-04]
 [ 2.20589499e-03]
 [-1.36329261e-02]
 [ 4.41361897e-03]
 [ 1.08580782e-02]
 [-1.00118384e-02]
 [-3.79963868e-03]
 [ 3.45457817e-03]
 [ 2.53314429e-03]
 [-8.32023859e-04]
 [-8.64424938e-03]
 [ 1.14559077e-02]
 [-1.32602998e-02]
 [-9.96908181e-03]
 [ 1.68761997e-02]
 [-2.24660728e-04]
 [ 1.29728983e-02]
 [-1.48102381e-02]
 [-1.27487974e-02]
 [-3.36683308e-03]
 [ 2.15694437e-02]
 [-1.82818872e-02]
 [ 2.12867925e-02]
 [ 3.34035710e-03]
 [ 9.12918883e-03]
 [-2.07726816e-02]
 [-7.85085328e-03]
 [-7.36289253e-03]
 [ 5.20281885e-03]
 [ 7.69234000e-03]
 [-9.08291183e-04]
 [-1.09788411e-02]
 [ 6.24622101e-03]
 [-3.87103750e-03]
 [ 2.44523573e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.69691279]
curr_Stock_Price:  100.61895636098714
curr_Factors:  [100.61895636]
mat_Sqrt:  [[0.15]]
grads:  [-0.43476569]
Stock Position:  -0.4347656894429273
Bond Position:  [55.44258273]


portfolio before change:  [11.41642191]
curr_Stock_Price:  101.27208093680547
curr_Factors:  [101.27208094]
mat_Sqrt:  [[0.15]]
grads:  [0.01510409]
Stock Position:  0.015104090433396477
Bond Position:  [9.88679924]


portfolio before change:  [11.42422405]
curr_Stock_Price:  101.74772693699194
curr_Factors:  [101.74772694]
mat_Sqrt:  [[0.15]]
grads:  [0.07633417]
Stock Position:  0.07633416605384259
Bond Position:  [3.65739617]


portfolio before change:  [11.4290415]
curr_Stock_Price:  101.80784222804269
curr_Factors:  [101.80784223]
mat_Sqrt:  [[0.15]]
grads:  [0.02222201]
Stock Position:  0.02222200734483682
Bond Position:  [9.16666688]


portfolio before change:  [11.42123933]
curr_Stock_Price:  101.43095904992106
curr_Factors:  [101.43095905]
mat_Sqrt:  [[0.15]]
grads:  [0.04169263]
Stock Position:  0.04169263387403965
Bond Position:  [7.19231549]


portfolio before change:  [11.43612229]
curr_Stock_Price:  101.77714561546395
curr_Factors:  [101.77714562]
mat_Sqrt:  [[0.15]]
grads:  [0.08122985]
Stock Position:  0.08122985192618606
Bond Position:  [3.16877983]


portfolio before change:  [11.41778282]
curr_Stock_Price:  101.54893478503139
curr_Factors:  [101.54893479]
mat_Sqrt:  [[0.15]]
grads:  [-0.00042935]
Stock Position:  -0.00042934819318733383
Bond Position:  [11.46138267]


portfolio before change:  [11.41853542]
curr_Stock_Price:  101.4645224777524
curr_Factors:  [101.46452248]
mat_Sqrt:  [[0.15]]
grads:  [0.03887627]
Stock Position:  0.03887627425910011
Bond Position:  [7.47397281]


portfolio before change:  [11.40073281]
curr_Stock_Price:  100.99457652338042
curr_Factors:  [100.99457652]
mat_Sqrt:  [[0.15]]
grads:  [-0.02180735]
Stock Position:  -0.02180735255842309
Bond Position:  [13.60315714]


portfolio before change:  [11.38833789]
curr_Stock_Price:  101.60194720371426
curr_Factors:  [101.6019472]
mat_Sqrt:  [[0.15]]
grads:  [-0.07745977]
Stock Position:  -0.07745977392032354
Bond Position:  [19.25840175]


portfolio before change:  [11.39420534]
curr_Stock_Price:  101.54173826950885
curr_Factors:  [101.54173827]
mat_Sqrt:  [[0.15]]
grads:  [0.06709487]
Stock Position:  0.06709487252663637
Bond Position:  [4.58127536]


portfolio before change:  [11.43877191]
curr_Stock_Price:  102.20170264062138
curr_Factors:  [102.20170264]
mat_Sqrt:  [[0.15]]
grads:  [-0.069773]
Stock Position:  -0.06977299953485379
Bond Position:  [18.56969126]


portfolio before change:  [11.39139324]
curr_Stock_Price:  102.89737733497623
curr_Factors:  [102.89737733]
mat_Sqrt:  [[0.15]]
grads:  [0.20706295]
Stock Position:  0.2070629523829737
Bond Position:  [-9.9148415]


portfolio before change:  [11.25975421]
curr_Stock_Price:  102.26462614275238
curr_Factors:  [102.26462614]
mat_Sqrt:  [[0.15]]
grads:  [0.06833621]
Stock Position:  0.06833620913140073
Bond Position:  [4.27137733]


portfolio before change:  [11.27321099]
curr_Stock_Price:  102.45763957232276
curr_Factors:  [102.45763957]
mat_Sqrt:  [[0.15]]
grads:  [-0.03045927]
Stock Position:  -0.030459270725334508
Bond Position:  [14.39399597]


portfolio before change:  [11.25888818]
curr_Stock_Price:  102.95740416709546
curr_Factors:  [102.95740417]
mat_Sqrt:  [[0.15]]
grads:  [-0.0568133]
Stock Position:  -0.05681330295402069
Bond Position:  [17.10823837]


portfolio before change:  [11.24400399]
curr_Stock_Price:  103.2382096246401
curr_Factors:  [103.23820962]
mat_Sqrt:  [[0.15]]
grads:  [0.08455935]
Stock Position:  0.08455934822614627
Bond Position:  [2.51424827]


portfolio before change:  [11.2496915]
curr_Stock_Price:  103.30361186051096
curr_Factors:  [103.30361186]
mat_Sqrt:  [[0.15]]
grads:  [0.16180595]
Stock Position:  0.1618059467247523
Bond Position:  [-5.46544721]


portfolio before change:  [11.25830022]
curr_Stock_Price:  103.35892696936668
curr_Factors:  [103.35892697]
mat_Sqrt:  [[0.15]]
grads:  [-0.00647099]
Stock Position:  -0.006470985184801256
Bond Position:  [11.9271343]


portfolio before change:  [11.26831452]
curr_Stock_Price:  101.92655914779432
curr_Factors:  [101.92655915]
mat_Sqrt:  [[0.15]]
grads:  [-0.00507675]
Stock Position:  -0.005076750772105681
Bond Position:  [11.78577025]


portfolio before change:  [11.26486168]
curr_Stock_Price:  102.75178563766369
curr_Factors:  [102.75178564]
mat_Sqrt:  [[0.15]]
grads:  [0.26199564]
Stock Position:  0.2619956420881886
Bond Position:  [-15.65565837]


portfolio before change:  [11.50333411]
curr_Stock_Price:  103.66573571381663
curr_Factors:  [103.66573571]
mat_Sqrt:  [[0.15]]
grads:  [-0.06919049]
Stock Position:  -0.06919048963093855
Bond Position:  [18.67601712]


portfolio before change:  [11.5186485]
curr_Stock_Price:  103.46126971595791
curr_Factors:  [103.46126972]
mat_Sqrt:  [[0.15]]
grads:  [0.0050457]
Stock Position:  0.005045699036954378
Bond Position:  [10.99661407]


portfolio before change:  [11.52446007]
curr_Stock_Price:  104.47684059906254
curr_Factors:  [104.4768406]
mat_Sqrt:  [[0.15]]
grads:  [0.03323711]
Stock Position:  0.0332371112545273
Bond Position:  [8.0519517]


portfolio before change:  [11.51988427]
curr_Stock_Price:  104.32402751700374
curr_Factors:  [104.32402752]
mat_Sqrt:  [[0.15]]
grads:  [0.12355947]
Stock Position:  0.12355946829572143
Bond Position:  [-1.3703371]


portfolio before change:  [11.5397073]
curr_Stock_Price:  104.48515382581049
curr_Factors:  [104.48515383]
mat_Sqrt:  [[0.15]]
grads:  [0.09739213]
Stock Position:  0.09739213305495253
Bond Position:  [1.3636753]


portfolio before change:  [11.5761346]
curr_Stock_Price:  104.858305727651
curr_Factors:  [104.85830573]
mat_Sqrt:  [[0.15]]
grads:  [0.0435597]
Stock Position:  0.04355970380186243
Bond Position:  [7.00853786]


portfolio before change:  [11.57039922]
curr_Stock_Price:  104.71658257150304
curr_Factors:  [104.71658257]
mat_Sqrt:  [[0.15]]
grads:  [0.03111849]
Stock Position:  0.031118488843791977
Bond Position:  [8.31177742]


portfolio before change:  [11.56473632]
curr_Stock_Price:  104.51790959813881
curr_Factors:  [104.5179096]
mat_Sqrt:  [[0.15]]
grads:  [0.05950745]
Stock Position:  0.05950745311963621
Bond Position:  [5.34514172]


portfolio before change:  [11.55126189]
curr_Stock_Price:  104.28586284505508
curr_Factors:  [104.28586285]
mat_Sqrt:  [[0.15]]
grads:  [-0.06302031]
Stock Position:  -0.06302030651767981
Bond Position:  [18.12338894]


portfolio before change:  [11.56200714]
curr_Stock_Price:  104.13333270533596
curr_Factors:  [104.13333271]
mat_Sqrt:  [[0.15]]
grads:  [-0.03844763]
Stock Position:  -0.038447629951735895
Bond Position:  [15.56568698]


portfolio before change:  [11.56358308]
curr_Stock_Price:  104.1176474422614
curr_Factors:  [104.11764744]
mat_Sqrt:  [[0.15]]
grads:  [0.27953776]
Stock Position:  0.27953776400955904
Bond Position:  [-17.54123128]


portfolio before change:  [11.37477841]
curr_Stock_Price:  103.44615206279484
curr_Factors:  [103.44615206]
mat_Sqrt:  [[0.15]]
grads:  [0.03610458]
Stock Position:  0.03610457921371316
Bond Position:  [7.63989862]


portfolio before change:  [11.36806866]
curr_Stock_Price:  103.24708426062718
curr_Factors:  [103.24708426]
mat_Sqrt:  [[0.15]]
grads:  [-0.03399268]
Stock Position:  -0.03399267843257765
Bond Position:  [14.87771359]


portfolio before change:  [11.38795667]
curr_Stock_Price:  102.68937202469132
curr_Factors:  [102.68937202]
mat_Sqrt:  [[0.15]]
grads:  [-0.03352883]
Stock Position:  -0.03352882992278143
Bond Position:  [14.83101116]


portfolio before change:  [11.38573486]
curr_Stock_Price:  102.7832846402354
curr_Factors:  [102.78328464]
mat_Sqrt:  [[0.15]]
grads:  [-0.02565502]
Stock Position:  -0.025655021543748904
Bond Position:  [14.02264224]


portfolio before change:  [11.36086557]
curr_Stock_Price:  103.78682053325753
curr_Factors:  [103.78682053]
mat_Sqrt:  [[0.15]]
grads:  [-0.02892023]
Stock Position:  -0.028920230083161528
Bond Position:  [14.3624043]


portfolio before change:  [11.37482084]
curr_Stock_Price:  103.3353169094506
curr_Factors:  [103.33531691]
mat_Sqrt:  [[0.15]]
grads:  [0.01995563]
Stock Position:  0.019955628047419623
Bond Position:  [9.31269969]


portfolio before change:  [11.37986345]
curr_Stock_Price:  103.55884036864691
curr_Factors:  [103.55884037]
mat_Sqrt:  [[0.15]]
grads:  [0.02391795]
Stock Position:  0.023917952330941676
Bond Position:  [8.90294804]


portfolio before change:  [11.39773908]
curr_Stock_Price:  104.2829481449464
curr_Factors:  [104.28294814]
mat_Sqrt:  [[0.15]]
grads:  [-0.04749068]
Stock Position:  -0.04749067691639643
Bond Position:  [16.35020687]


portfolio before change:  [11.40988763]
curr_Stock_Price:  104.04865725532795
curr_Factors:  [104.04865726]
mat_Sqrt:  [[0.15]]
grads:  [-0.31779091]
Stock Position:  -0.3177909056675734
Bond Position:  [44.47560465]


portfolio before change:  [11.52125567]
curr_Stock_Price:  103.7069601553116
curr_Factors:  [103.70696016]
mat_Sqrt:  [[0.15]]
grads:  [-0.02349811]
Stock Position:  -0.02349810609763875
Bond Position:  [13.95817282]


portfolio before change:  [11.53595379]
curr_Stock_Price:  103.11858487889684
curr_Factors:  [103.11858488]
mat_Sqrt:  [[0.15]]
grads:  [0.08807098]
Stock Position:  0.08807098070242173
Bond Position:  [2.45419889]


portfolio before change:  [11.52011912]
curr_Stock_Price:  102.9370488140202
curr_Factors:  [102.93704881]
mat_Sqrt:  [[0.15]]
grads:  [-0.07945365]
Stock Position:  -0.07945365170018004
Bond Position:  [19.69884355]


portfolio before change:  [11.55087307]
curr_Stock_Price:  102.56547706588418
curr_Factors:  [102.56547707]
mat_Sqrt:  [[0.15]]
grads:  [-0.00218012]
Stock Position:  -0.0021801179243665886
Bond Position:  [11.77447791]


portfolio before change:  [11.55302221]
curr_Stock_Price:  101.91725122816216
curr_Factors:  [101.91725123]
mat_Sqrt:  [[0.15]]
grads:  [0.01470597]
Stock Position:  0.014705966581822737
Bond Position:  [10.05423052]


portfolio before change:  [11.57029798]
curr_Stock_Price:  103.04926540856977
curr_Factors:  [103.04926541]
mat_Sqrt:  [[0.15]]
grads:  [-0.09088617]
Stock Position:  -0.09088617415842998
Bond Position:  [20.93605146]


portfolio before change:  [11.55325217]
curr_Stock_Price:  103.25121422693327
curr_Factors:  [103.25121423]
mat_Sqrt:  [[0.15]]
grads:  [0.02942413]
Stock Position:  0.02942412646848974
Bond Position:  [8.51517538]


portfolio before change:  [11.56982063]
curr_Stock_Price:  103.7962174089129
curr_Factors:  [103.79621741]
mat_Sqrt:  [[0.15]]
grads:  [0.07238719]
Stock Position:  0.07238718824962237
Bond Position:  [4.0563043]


portfolio before change:  [11.5591684]
curr_Stock_Price:  103.64555882908421
curr_Factors:  [103.64555883]
mat_Sqrt:  [[0.15]]
grads:  [-0.06674559]
Stock Position:  -0.06674558920999388
Bond Position:  [18.47705229]


portfolio before change:  [11.5531239]
curr_Stock_Price:  103.75342143246546
curr_Factors:  [103.75342143]
mat_Sqrt:  [[0.15]]
grads:  [-0.02533092]
Stock Position:  -0.025330924534307058
Bond Position:  [14.18129399]


portfolio before change:  [11.55201657]
curr_Stock_Price:  103.83212720608253
curr_Factors:  [103.83212721]
mat_Sqrt:  [[0.15]]
grads:  [0.02303052]
Stock Position:  0.02303052112186029
Bond Position:  [9.16070857]


portfolio before change:  [11.55431246]
curr_Stock_Price:  103.90695544996035
curr_Factors:  [103.90695545]
mat_Sqrt:  [[0.15]]
grads:  [0.01688763]
Stock Position:  0.016887628572835312
Bond Position:  [9.7995704]


portfolio before change:  [11.5652466]
curr_Stock_Price:  104.51815123003865
curr_Factors:  [104.51815123]
mat_Sqrt:  [[0.15]]
grads:  [-0.00554683]
Stock Position:  -0.005546825723354741
Bond Position:  [12.14499057]


portfolio before change:  [11.56453406]
curr_Stock_Price:  104.78346232561385
curr_Factors:  [104.78346233]
mat_Sqrt:  [[0.15]]
grads:  [-0.05762833]
Stock Position:  -0.05762832918932564
Bond Position:  [17.60302992]


portfolio before change:  [11.56572108]
curr_Stock_Price:  104.78195607541123
curr_Factors:  [104.78195608]
mat_Sqrt:  [[0.15]]
grads:  [0.07637272]
Stock Position:  0.07637271810679191
Bond Position:  [3.56323829]


portfolio before change:  [11.51461331]
curr_Stock_Price:  104.10985116234035
curr_Factors:  [104.10985116]
mat_Sqrt:  [[0.15]]
grads:  [-0.088402]
Stock Position:  -0.08840199869063935
Bond Position:  [20.71813224]


portfolio before change:  [11.55142318]
curr_Stock_Price:  103.70810744645657
curr_Factors:  [103.70810745]
mat_Sqrt:  [[0.15]]
grads:  [-0.06646055]
Stock Position:  -0.06646054537269933
Bond Position:  [18.44392056]


portfolio before change:  [11.51299786]
curr_Stock_Price:  104.30362020799565
curr_Factors:  [104.30362021]
mat_Sqrt:  [[0.15]]
grads:  [0.112508]
Stock Position:  0.11250799798446919
Bond Position:  [-0.22199363]


portfolio before change:  [11.45477995]
curr_Stock_Price:  103.78628775981218
curr_Factors:  [103.78628776]
mat_Sqrt:  [[0.15]]
grads:  [-0.00149774]
Stock Position:  -0.0014977381864649468
Bond Position:  [11.61022464]


portfolio before change:  [11.45488908]
curr_Stock_Price:  104.19792681840025
curr_Factors:  [104.19792682]
mat_Sqrt:  [[0.15]]
grads:  [0.08648599]
Stock Position:  0.08648598862810691
Bond Position:  [2.44322837]


portfolio before change:  [11.45831103]
curr_Stock_Price:  104.23572766088861
curr_Factors:  [104.23572766]
mat_Sqrt:  [[0.15]]
grads:  [-0.09873492]
Stock Position:  -0.09873492093168149
Bond Position:  [21.75001736]


portfolio before change:  [11.4205432]
curr_Stock_Price:  104.63201351808058
curr_Factors:  [104.63201352]
mat_Sqrt:  [[0.15]]
grads:  [-0.08499198]
Stock Position:  -0.08499198274136933
Bond Position:  [20.31342549]


portfolio before change:  [11.48500419]
curr_Stock_Price:  103.88851563516488
curr_Factors:  [103.88851564]
mat_Sqrt:  [[0.15]]
grads:  [-0.02244555]
Stock Position:  -0.022445553893483614
Bond Position:  [13.81683946]


portfolio before change:  [11.48196359]
curr_Stock_Price:  104.06245542616128
curr_Factors:  [104.06245543]
mat_Sqrt:  [[0.15]]
grads:  [0.14379629]
Stock Position:  0.14379629158711588
Bond Position:  [-3.48183159]


portfolio before change:  [11.42602564]
curr_Stock_Price:  103.67496053421432
curr_Factors:  [103.67496053]
mat_Sqrt:  [[0.15]]
grads:  [-0.12187925]
Stock Position:  -0.12187924771533035
Bond Position:  [24.06185184]


portfolio before change:  [11.40225411]
curr_Stock_Price:  103.88234154105781
curr_Factors:  [103.88234154]
mat_Sqrt:  [[0.15]]
grads:  [0.14191195]
Stock Position:  0.14191194975330623
Bond Position:  [-3.33989152]


portfolio before change:  [11.3361808]
curr_Stock_Price:  103.41821879226845
curr_Factors:  [103.41821879]
mat_Sqrt:  [[0.15]]
grads:  [0.02226905]
Stock Position:  0.022269047348883974
Bond Position:  [9.03315559]


portfolio before change:  [11.33987494]
curr_Stock_Price:  103.55875246474116
curr_Factors:  [103.55875246]
mat_Sqrt:  [[0.15]]
grads:  [0.06086126]
Stock Position:  0.06086125887036735
Bond Position:  [5.0371589]


portfolio before change:  [11.3591449]
curr_Stock_Price:  103.87020066407234
curr_Factors:  [103.87020066]
mat_Sqrt:  [[0.15]]
grads:  [-0.13848454]
Stock Position:  -0.13848454422190914
Bond Position:  [25.7435623]


portfolio before change:  [11.35412958]
curr_Stock_Price:  103.9180351909819
curr_Factors:  [103.91803519]
mat_Sqrt:  [[0.15]]
grads:  [-0.05233902]
Stock Position:  -0.05233902189954078
Bond Position:  [16.7930979]


portfolio before change:  [11.37270654]
curr_Stock_Price:  103.58315393734168
curr_Factors:  [103.58315394]
mat_Sqrt:  [[0.15]]
grads:  [-0.04908595]
Stock Position:  -0.049085950168319514
Bond Position:  [16.45718407]


portfolio before change:  [11.36653672]
curr_Stock_Price:  103.72980334488162
curr_Factors:  [103.72980334]
mat_Sqrt:  [[0.15]]
grads:  [0.03468546]
Stock Position:  0.03468545899256356
Bond Position:  [7.76862088]


portfolio before change:  [11.33083525]
curr_Stock_Price:  102.68651252365912
curr_Factors:  [102.68651252]
mat_Sqrt:  [[0.15]]
grads:  [0.05128227]
Stock Position:  0.05128226664255198
Bond Position:  [6.06483814]


portfolio before change:  [11.3645964]
curr_Stock_Price:  103.33746037277712
curr_Factors:  [103.33746037]
mat_Sqrt:  [[0.15]]
grads:  [-0.00605527]
Stock Position:  -0.006055274555686984
Bond Position:  [11.99033309]


portfolio before change:  [11.36686175]
curr_Stock_Price:  103.08711168399444
curr_Factors:  [103.08711168]
mat_Sqrt:  [[0.15]]
grads:  [-0.07319227]
Stock Position:  -0.07319227422327829
Bond Position:  [18.9120419]


portfolio before change:  [11.3796059]
curr_Stock_Price:  102.92914271147164
curr_Factors:  [102.92914271]
mat_Sqrt:  [[0.15]]
grads:  [0.04164147]
Stock Position:  0.041641473370723985
Bond Position:  [7.09348474]


portfolio before change:  [11.4244137]
curr_Stock_Price:  103.99453354858554
curr_Factors:  [103.99453355]
mat_Sqrt:  [[0.15]]
grads:  [-0.02580692]
Stock Position:  -0.025806916642892114
Bond Position:  [14.10819196]


portfolio before change:  [11.41486148]
curr_Stock_Price:  104.39884387598188
curr_Factors:  [104.39884388]
mat_Sqrt:  [[0.15]]
grads:  [0.16301572]
Stock Position:  0.16301571537337994
Bond Position:  [-5.60379073]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.41486148]
Stock Price:  103.92888638524622
PL:  [7.4859751]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.69152016e-02]
 [-1.44539880e-03]
 [ 5.98829657e-04]
 [ 6.96193443e-04]
 [ 1.90954708e-02]
 [ 1.17618741e-02]
 [ 1.06590228e-03]
 [ 7.88003618e-03]
 [-3.96529912e-03]
 [-2.00375800e-02]
 [ 1.02332484e-02]
 [-4.95695178e-03]
 [-9.81844684e-03]
 [ 4.36671955e-03]
 [-1.01291230e-03]
 [ 1.13102437e-02]
 [ 3.49387540e-03]
 [ 9.78823430e-03]
 [ 2.28304581e-02]
 [ 1.20749096e-02]
 [ 6.62610232e-03]
 [-2.27588502e-02]
 [ 1.89702013e-04]
 [ 4.95407132e-04]
 [-2.59153424e-03]
 [ 1.58511848e-02]
 [ 1.64227372e-02]
 [ 1.15441615e-02]
 [ 1.26278498e-04]
 [ 4.18751116e-03]
 [-3.41472749e-03]
 [-2.39265197e-02]
 [ 2.03253705e-02]
 [ 1.11032251e-02]
 [-3.05300713e-02]
 [ 8.03855600e-03]
 [-2.52572446e-03]
 [ 8.56034907e-03]
 [ 2.30475737e-03]
 [-1.37258907e-02]
 [ 2.51511173e-03]
 [-1.99715068e-03]
 [ 3.90708652e-03]
 [-7.90304385e-03]
 [ 1.60890766e-03]
 [-3.33787231e-03]
 [-1.37121754e-02]
 [-1.05438496e-03]
 [-8.58509009e-03]
 [ 1.00498535e-02]
 [-3.16201874e-03]
 [ 3.09367425e-03]
 [ 3.02311150e-03]
 [ 1.37531919e-03]
 [ 3.20268312e-03]
 [ 8.89994083e-03]
 [ 9.06115710e-03]
 [ 8.80151508e-03]
 [ 1.31452477e-02]
 [-6.28446982e-03]
 [-4.79838089e-03]
 [-2.60348217e-02]
 [-1.28894163e-02]
 [-3.63618701e-03]
 [-6.59508868e-03]
 [ 2.01789939e-02]
 [ 8.21925405e-03]
 [ 1.75610097e-03]
 [ 1.38948545e-02]
 [-1.91797469e-02]
 [ 1.80763417e-02]
 [-1.01924808e-02]
 [-4.23314578e-03]
 [ 7.85133523e-03]
 [-9.20714058e-03]
 [ 3.82820358e-03]
 [ 1.73492925e-02]
 [-1.37988102e-02]
 [-5.18156138e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.22330405]
curr_Stock_Price:  99.59575352345223
curr_Factors:  [99.59575352]
mat_Sqrt:  [[0.15]]
grads:  [-0.24610134]
Stock Position:  -0.24610134380274135
Bond Position:  [20.28734473]


portfolio before change:  [-4.29253894]
curr_Stock_Price:  99.88223260469131
curr_Factors:  [99.8822326]
mat_Sqrt:  [[0.15]]
grads:  [-0.00963599]
Stock Position:  -0.009635992006487844
Bond Position:  [-3.33007454]


portfolio before change:  [-4.29367354]
curr_Stock_Price:  99.97837917141277
curr_Factors:  [99.97837917]
mat_Sqrt:  [[0.15]]
grads:  [0.0039922]
Stock Position:  0.003992197716597449
Bond Position:  [-4.692807]


portfolio before change:  [-4.29650842]
curr_Stock_Price:  99.34174598516464
curr_Factors:  [99.34174599]
mat_Sqrt:  [[0.15]]
grads:  [0.00464129]
Stock Position:  0.004641289621810788
Bond Position:  [-4.75758223]


portfolio before change:  [-4.29453164]
curr_Stock_Price:  99.8317251597494
curr_Factors:  [99.83172516]
mat_Sqrt:  [[0.15]]
grads:  [0.12730314]
Stock Position:  0.12730313851652664
Bond Position:  [-17.00342358]


portfolio before change:  [-4.22527667]
curr_Stock_Price:  100.38408953681079
curr_Factors:  [100.38408954]
mat_Sqrt:  [[0.15]]
grads:  [0.07841249]
Stock Position:  0.07841249430207474
Bond Position:  [-12.09664352]


portfolio before change:  [-4.21646978]
curr_Stock_Price:  100.5060465071626
curr_Factors:  [100.50604651]
mat_Sqrt:  [[0.15]]
grads:  [0.00710602]
Stock Position:  0.00710601520566529
Bond Position:  [-4.93066728]


portfolio before change:  [-4.21299993]
curr_Stock_Price:  101.0377123746344
curr_Factors:  [101.03771237]
mat_Sqrt:  [[0.15]]
grads:  [0.05253357]
Stock Position:  0.05253357456027112
Bond Position:  [-9.52087213]


portfolio before change:  [-4.21072885]
curr_Stock_Price:  101.09227089846846
curr_Factors:  [101.0922709]
mat_Sqrt:  [[0.15]]
grads:  [-0.02643533]
Stock Position:  -0.026435327498349228
Bond Position:  [-1.53832156]


portfolio before change:  [-4.19024497]
curr_Stock_Price:  100.31376618220088
curr_Factors:  [100.31376618]
mat_Sqrt:  [[0.15]]
grads:  [-0.13358387]
Stock Position:  -0.13358386689639298
Bond Position:  [9.21005582]


portfolio before change:  [-4.22076612]
curr_Stock_Price:  100.54655471383573
curr_Factors:  [100.54655471]
mat_Sqrt:  [[0.15]]
grads:  [0.06822166]
Stock Position:  0.0682216562506897
Bond Position:  [-11.08021861]


portfolio before change:  [-4.26828415]
curr_Stock_Price:  99.86018182619058
curr_Factors:  [99.86018183]
mat_Sqrt:  [[0.15]]
grads:  [-0.03304635]
Stock Position:  -0.03304634516945713
Bond Position:  [-0.96827011]


portfolio before change:  [-4.27111275]
curr_Stock_Price:  99.94394554831824
curr_Factors:  [99.94394555]
mat_Sqrt:  [[0.15]]
grads:  [-0.06545631]
Stock Position:  -0.06545631229139708
Bond Position:  [2.27084936]


portfolio before change:  [-4.25430608]
curr_Stock_Price:  99.68935219613712
curr_Factors:  [99.6893522]
mat_Sqrt:  [[0.15]]
grads:  [0.02911146]
Stock Position:  0.029111463659864414
Bond Position:  [-7.15640903]


portfolio before change:  [-4.27197263]
curr_Stock_Price:  99.0978579724614
curr_Factors:  [99.09785797]
mat_Sqrt:  [[0.15]]
grads:  [-0.00675275]
Stock Position:  -0.0067527486622605964
Bond Position:  [-3.6027897]


portfolio before change:  [-4.27312244]
curr_Stock_Price:  99.23478385143875
curr_Factors:  [99.23478385]
mat_Sqrt:  [[0.15]]
grads:  [0.07540162]
Stock Position:  0.07540162495979254
Bond Position:  [-11.75558639]


portfolio before change:  [-4.24290954]
curr_Stock_Price:  99.64522121990883
curr_Factors:  [99.64522122]
mat_Sqrt:  [[0.15]]
grads:  [0.0232925]
Stock Position:  0.023292502662661023
Bond Position:  [-6.56389612]


portfolio before change:  [-4.23650379]
curr_Stock_Price:  99.9378479380731
curr_Factors:  [99.93784794]
mat_Sqrt:  [[0.15]]
grads:  [0.0652549]
Stock Position:  0.06525489531108651
Bond Position:  [-10.75793759]


portfolio before change:  [-4.26665512]
curr_Stock_Price:  99.48609731306944
curr_Factors:  [99.48609731]
mat_Sqrt:  [[0.15]]
grads:  [0.15220305]
Stock Position:  0.1522030541794583
Bond Position:  [-19.40874298]


portfolio before change:  [-4.3597733]
curr_Stock_Price:  98.88226513868261
curr_Factors:  [98.88226514]
mat_Sqrt:  [[0.15]]
grads:  [0.0804994]
Stock Position:  0.08049939722077919
Bond Position:  [-12.31973604]


portfolio before change:  [-4.42703835]
curr_Stock_Price:  98.05623359246515
curr_Factors:  [98.05623359]
mat_Sqrt:  [[0.15]]
grads:  [0.04417402]
Stock Position:  0.044174015488570216
Bond Position:  [-8.75857594]


portfolio before change:  [-4.43771551]
curr_Stock_Price:  97.82691944246469
curr_Factors:  [97.82691944]
mat_Sqrt:  [[0.15]]
grads:  [-0.15172567]
Stock Position:  -0.1517256680603539
Bond Position:  [10.4051392]


portfolio before change:  [-4.3647132]
curr_Stock_Price:  97.35005898387911
curr_Factors:  [97.35005898]
mat_Sqrt:  [[0.15]]
grads:  [0.00126468]
Stock Position:  0.0012646800836704254
Bond Position:  [-4.48782988]


portfolio before change:  [-4.36603665]
curr_Stock_Price:  96.52538207280024
curr_Factors:  [96.52538207]
mat_Sqrt:  [[0.15]]
grads:  [0.00330271]
Stock Position:  0.003302714215277384
Bond Position:  [-4.6848324]


portfolio before change:  [-4.36413672]
curr_Stock_Price:  97.18930179321953
curr_Factors:  [97.18930179]
mat_Sqrt:  [[0.15]]
grads:  [-0.01727689]
Stock Position:  -0.017276894906144338
Bond Position:  [-2.68500737]


portfolio before change:  [-4.367993]
curr_Stock_Price:  97.40279288630536
curr_Factors:  [97.40279289]
mat_Sqrt:  [[0.15]]
grads:  [0.10567457]
Stock Position:  0.10567456512471762
Bond Position:  [-14.66099078]


portfolio before change:  [-4.41597232]
curr_Stock_Price:  96.95743522651067
curr_Factors:  [96.95743523]
mat_Sqrt:  [[0.15]]
grads:  [0.10948491]
Stock Position:  0.10948491484384834
Bond Position:  [-15.03134886]


portfolio before change:  [-4.43667569]
curr_Stock_Price:  96.77691825667945
curr_Factors:  [96.77691826]
mat_Sqrt:  [[0.15]]
grads:  [0.07696108]
Stock Position:  0.07696107666482893
Bond Position:  [-11.88473152]


portfolio before change:  [-4.48742656]
curr_Stock_Price:  96.12713466229623
curr_Factors:  [96.12713466]
mat_Sqrt:  [[0.15]]
grads:  [0.00084186]
Stock Position:  0.0008418566555121853
Bond Position:  [-4.56835183]


portfolio before change:  [-4.48737057]
curr_Stock_Price:  96.53280216429353
curr_Factors:  [96.53280216]
mat_Sqrt:  [[0.15]]
grads:  [0.02791674]
Stock Position:  0.027916741097924608
Bond Position:  [-7.18225182]


portfolio before change:  [-4.47009361]
curr_Stock_Price:  97.16775696158504
curr_Factors:  [97.16775696]
mat_Sqrt:  [[0.15]]
grads:  [-0.02276485]
Stock Position:  -0.022764849905500394
Bond Position:  [-2.25808421]


portfolio before change:  [-4.46513551]
curr_Stock_Price:  96.94376086090563
curr_Factors:  [96.94376086]
mat_Sqrt:  [[0.15]]
grads:  [-0.15951013]
Stock Position:  -0.15951013137660283
Bond Position:  [10.99837652]


portfolio before change:  [-4.45449305]
curr_Stock_Price:  96.88135079508265
curr_Factors:  [96.8813508]
mat_Sqrt:  [[0.15]]
grads:  [0.13550247]
Stock Position:  0.13550247013016004
Bond Position:  [-17.58215539]


portfolio before change:  [-4.5201196]
curr_Stock_Price:  96.40514080145489
curr_Factors:  [96.4051408]
mat_Sqrt:  [[0.15]]
grads:  [0.0740215]
Stock Position:  0.07402150051290682
Bond Position:  [-11.65617278]


portfolio before change:  [-4.53754001]
curr_Stock_Price:  96.17964046678047
curr_Factors:  [96.17964047]
mat_Sqrt:  [[0.15]]
grads:  [-0.20353381]
Stock Position:  -0.20353380856781633
Bond Position:  [15.03826853]


portfolio before change:  [-4.65372661]
curr_Stock_Price:  96.75510520092617
curr_Factors:  [96.7551052]
mat_Sqrt:  [[0.15]]
grads:  [0.05359037]
Stock Position:  0.0535903733210516
Bond Position:  [-9.83886882]


portfolio before change:  [-4.57831838]
curr_Stock_Price:  98.17370291530413
curr_Factors:  [98.17370292]
mat_Sqrt:  [[0.15]]
grads:  [-0.01683816]
Stock Position:  -0.016838163040672115
Bond Position:  [-2.92525356]


portfolio before change:  [-4.5822376]
curr_Stock_Price:  98.39560291544271
curr_Factors:  [98.39560292]
mat_Sqrt:  [[0.15]]
grads:  [0.05706899]
Stock Position:  0.057068993771238016
Bond Position:  [-10.19757565]


portfolio before change:  [-4.55900553]
curr_Stock_Price:  98.81385879015093
curr_Factors:  [98.81385879]
mat_Sqrt:  [[0.15]]
grads:  [0.01536505]
Stock Position:  0.015365049124034073
Bond Position:  [-6.07728532]


portfolio before change:  [-4.55447698]
curr_Stock_Price:  99.13331047123206
curr_Factors:  [99.13331047]
mat_Sqrt:  [[0.15]]
grads:  [-0.09150594]
Stock Position:  -0.09150593806510575
Bond Position:  [4.51680959]


portfolio before change:  [-4.55801649]
curr_Stock_Price:  99.17507629038259
curr_Factors:  [99.17507629]
mat_Sqrt:  [[0.15]]
grads:  [0.01676741]
Stock Position:  0.016767411523377653
Bond Position:  [-6.22092581]


portfolio before change:  [-4.56275026]
curr_Stock_Price:  98.91594576612952
curr_Factors:  [98.91594577]
mat_Sqrt:  [[0.15]]
grads:  [-0.01331434]
Stock Position:  -0.013314337899153204
Bond Position:  [-3.24574993]


portfolio before change:  [-4.55393229]
curr_Stock_Price:  98.23841799187291
curr_Factors:  [98.23841799]
mat_Sqrt:  [[0.15]]
grads:  [0.02604724]
Stock Position:  0.0260472434586308
Bond Position:  [-7.11277228]


portfolio before change:  [-4.54857921]
curr_Stock_Price:  98.46099991230744
curr_Factors:  [98.46099991]
mat_Sqrt:  [[0.15]]
grads:  [-0.05268696]
Stock Position:  -0.05268695897732395
Bond Position:  [0.63903145]


portfolio before change:  [-4.52591829]
curr_Stock_Price:  98.0316530253182
curr_Factors:  [98.03165303]
mat_Sqrt:  [[0.15]]
grads:  [0.01072605]
Stock Position:  0.010726051096083756
Bond Position:  [-5.57741081]


portfolio before change:  [-4.51771903]
curr_Stock_Price:  98.82857774187454
curr_Factors:  [98.82857774]
mat_Sqrt:  [[0.15]]
grads:  [-0.02225248]
Stock Position:  -0.0222524820928624
Bond Position:  [-2.31853787]


portfolio before change:  [-4.51403632]
curr_Stock_Price:  98.65656887635127
curr_Factors:  [98.65656888]
mat_Sqrt:  [[0.15]]
grads:  [-0.0914145]
Stock Position:  -0.091414502785422
Bond Position:  [4.50460487]


portfolio before change:  [-4.47646932]
curr_Stock_Price:  98.24869652794315
curr_Factors:  [98.24869653]
mat_Sqrt:  [[0.15]]
grads:  [-0.00702923]
Stock Position:  -0.007029233073973686
Bond Position:  [-3.78585634]


portfolio before change:  [-4.48163118]
curr_Stock_Price:  98.94937526252609
curr_Factors:  [98.94937526]
mat_Sqrt:  [[0.15]]
grads:  [-0.05723393]
Stock Position:  -0.05723393390837919
Bond Position:  [1.18163082]


portfolio before change:  [-4.48229389]
curr_Stock_Price:  98.96224457425336
curr_Factors:  [98.96224457]
mat_Sqrt:  [[0.15]]
grads:  [0.06699902]
Stock Position:  0.06699902320213817
Bond Position:  [-11.11266761]


portfolio before change:  [-4.51460854]
curr_Stock_Price:  98.49029615378882
curr_Factors:  [98.49029615]
mat_Sqrt:  [[0.15]]
grads:  [-0.02108012]
Stock Position:  -0.02108012494357904
Bond Position:  [-2.43842079]


portfolio before change:  [-4.50245774]
curr_Stock_Price:  97.90665615637714
curr_Factors:  [97.90665616]
mat_Sqrt:  [[0.15]]
grads:  [0.02062449]
Stock Position:  0.02062449498477119
Bond Position:  [-6.52173308]


portfolio before change:  [-4.49678083]
curr_Stock_Price:  98.20167075309887
curr_Factors:  [98.20167075]
mat_Sqrt:  [[0.15]]
grads:  [0.02015408]
Stock Position:  0.02015407663854854
Bond Position:  [-6.47594483]


portfolio before change:  [-4.4924651]
curr_Stock_Price:  98.43589089294679
curr_Factors:  [98.43589089]
mat_Sqrt:  [[0.15]]
grads:  [0.00916879]
Stock Position:  0.009168794620943095
Bond Position:  [-5.39500357]


portfolio before change:  [-4.49926613]
curr_Stock_Price:  97.73090906898139
curr_Factors:  [97.73090907]
mat_Sqrt:  [[0.15]]
grads:  [0.02135122]
Stock Position:  0.021351220825064327
Bond Position:  [-6.58594035]


portfolio before change:  [-4.51175179]
curr_Stock_Price:  97.16541319590884
curr_Factors:  [97.1654132]
mat_Sqrt:  [[0.15]]
grads:  [0.05933294]
Stock Position:  0.05933293889335764
Bond Position:  [-10.27686132]


portfolio before change:  [-4.57802017]
curr_Stock_Price:  96.05934874853389
curr_Factors:  [96.05934875]
mat_Sqrt:  [[0.15]]
grads:  [0.06040771]
Stock Position:  0.060407714019145554
Bond Position:  [-10.38074584]


portfolio before change:  [-4.59013571]
curr_Stock_Price:  95.86952659556442
curr_Factors:  [95.8695266]
mat_Sqrt:  [[0.15]]
grads:  [0.05867677]
Stock Position:  0.058676767225498395
Bond Position:  [-10.21544961]


portfolio before change:  [-4.64402458]
curr_Stock_Price:  94.96200592532391
curr_Factors:  [94.96200593]
mat_Sqrt:  [[0.15]]
grads:  [0.08763498]
Stock Position:  0.08763498487519579
Bond Position:  [-12.96601853]


portfolio before change:  [-4.67180882]
curr_Stock_Price:  94.65420829431376
curr_Factors:  [94.65420829]
mat_Sqrt:  [[0.15]]
grads:  [-0.04189647]
Stock Position:  -0.041896465498476865
Bond Position:  [-0.70613205]


portfolio before change:  [-4.69484857]
curr_Stock_Price:  95.20307601035522
curr_Factors:  [95.20307601]
mat_Sqrt:  [[0.15]]
grads:  [-0.03198921]
Stock Position:  -0.03198920591362285
Bond Position:  [-1.64937777]


portfolio before change:  [-4.69696699]
curr_Stock_Price:  95.26607633087987
curr_Factors:  [95.26607633]
mat_Sqrt:  [[0.15]]
grads:  [-0.17356548]
Stock Position:  -0.17356547816761198
Bond Position:  [11.8379351]


portfolio before change:  [-4.63855444]
curr_Stock_Price:  94.93379446888946
curr_Factors:  [94.93379447]
mat_Sqrt:  [[0.15]]
grads:  [-0.08592944]
Stock Position:  -0.08592944222335534
Bond Position:  [3.51905357]


portfolio before change:  [-4.57158866]
curr_Stock_Price:  94.15704289059272
curr_Factors:  [94.15704289]
mat_Sqrt:  [[0.15]]
grads:  [-0.02424125]
Stock Position:  -0.02424124676652107
Bond Position:  [-2.28910455]


portfolio before change:  [-4.58876742]
curr_Stock_Price:  94.85979921201914
curr_Factors:  [94.85979921]
mat_Sqrt:  [[0.15]]
grads:  [-0.04396726]
Stock Position:  -0.04396725788127975
Bond Position:  [-0.41804217]


portfolio before change:  [-4.60192599]
curr_Stock_Price:  95.15848604947269
curr_Factors:  [95.15848605]
mat_Sqrt:  [[0.15]]
grads:  [0.13452663]
Stock Position:  0.1345266259947404
Bond Position:  [-17.40327605]


portfolio before change:  [-4.59800628]
curr_Stock_Price:  95.19570880463377
curr_Factors:  [95.1957088]
mat_Sqrt:  [[0.15]]
grads:  [0.05479503]
Stock Position:  0.054795026999704725
Bond Position:  [-9.81425771]


portfolio before change:  [-4.58377568]
curr_Stock_Price:  95.46660937475015
curr_Factors:  [95.46660937]
mat_Sqrt:  [[0.15]]
grads:  [0.01170734]
Stock Position:  0.011707339820283567
Bond Position:  [-5.70143572]


portfolio before change:  [-4.58185252]
curr_Stock_Price:  95.66131740230044
curr_Factors:  [95.6613174]
mat_Sqrt:  [[0.15]]
grads:  [0.09263236]
Stock Position:  0.0926323632792498
Bond Position:  [-13.44318643]


portfolio before change:  [-4.60325045]
curr_Stock_Price:  95.43938950656846
curr_Factors:  [95.43938951]
mat_Sqrt:  [[0.15]]
grads:  [-0.12786498]
Stock Position:  -0.12786497952738074
Bond Position:  [7.60010513]


portfolio before change:  [-4.54518524]
curr_Stock_Price:  94.98899104094647
curr_Factors:  [94.98899104]
mat_Sqrt:  [[0.15]]
grads:  [0.12050894]
Stock Position:  0.12050894469113965
Bond Position:  [-15.99220831]


portfolio before change:  [-4.5249413]
curr_Stock_Price:  95.16527246112918
curr_Factors:  [95.16527246]
mat_Sqrt:  [[0.15]]
grads:  [-0.06794987]
Stock Position:  -0.06794987180826188
Bond Position:  [1.94152677]


portfolio before change:  [-4.50963246]
curr_Stock_Price:  94.94176231679356
curr_Factors:  [94.94176232]
mat_Sqrt:  [[0.15]]
grads:  [-0.02822097]
Stock Position:  -0.02822097183422501
Bond Position:  [-1.83028366]


portfolio before change:  [-4.49210185]
curr_Stock_Price:  94.31651795172131
curr_Factors:  [94.31651795]
mat_Sqrt:  [[0.15]]
grads:  [0.05234223]
Stock Position:  0.05234223486473581
Bond Position:  [-9.42883919]


portfolio before change:  [-4.51420029]
curr_Stock_Price:  93.90558562539503
curr_Factors:  [93.90558563]
mat_Sqrt:  [[0.15]]
grads:  [-0.06138094]
Stock Position:  -0.061380937207200344
Bond Position:  [1.24981256]


portfolio before change:  [-4.4913723]
curr_Stock_Price:  93.5349513245766
curr_Factors:  [93.53495132]
mat_Sqrt:  [[0.15]]
grads:  [0.02552136]
Stock Position:  0.025521357207528916
Bond Position:  [-6.8785112]


portfolio before change:  [-4.47980008]
curr_Stock_Price:  94.00522950935223
curr_Factors:  [94.00522951]
mat_Sqrt:  [[0.15]]
grads:  [0.11566195]
Stock Position:  0.11566194980395177
Bond Position:  [-15.35262821]


portfolio before change:  [-4.38434468]
curr_Stock_Price:  94.83882228498365
curr_Factors:  [94.83882228]
mat_Sqrt:  [[0.15]]
grads:  [-0.09199207]
Stock Position:  -0.0919920680048266
Bond Position:  [4.34007471]


portfolio before change:  [-4.31491012]
curr_Stock_Price:  94.08698244626557
curr_Factors:  [94.08698245]
mat_Sqrt:  [[0.15]]
grads:  [-0.34543743]
Stock Position:  -0.34543742538289285
Bond Position:  [28.18625486]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.31491012]
Stock Price:  94.56225182881815
PL:  [-4.31491012]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-1.03964098e-01]
 [ 8.83213613e-04]
 [ 4.60384555e-04]
 [ 2.38651129e-03]
 [ 4.98688885e-03]
 [ 1.20398938e-02]
 [ 9.84757327e-04]
 [ 1.00117372e-02]
 [ 1.34022231e-02]
 [-2.01048434e-02]
 [ 8.14681126e-03]
 [-4.92454533e-03]
 [-8.75939259e-03]
 [ 3.83505619e-03]
 [-1.38295616e-02]
 [ 1.55353353e-02]
 [-3.54549226e-03]
 [-3.60541434e-03]
 [-5.76811190e-05]
 [ 1.38996017e-02]
 [ 1.42866736e-03]
 [-2.06245578e-02]
 [-5.40484636e-04]
 [ 9.50959011e-03]
 [ 6.82161776e-03]
 [ 9.46390175e-03]
 [ 1.37576139e-02]
 [-1.62794720e-02]
 [ 1.29848085e-03]
 [-8.94221007e-03]
 [-4.06844307e-03]
 [-7.38584524e-03]
 [ 1.57952672e-02]
 [ 1.96854956e-02]
 [-8.49850683e-03]
 [ 3.36233661e-03]
 [-3.36343960e-03]
 [ 1.05882721e-02]
 [-2.21399317e-03]
 [-1.04375131e-02]
 [-1.17859636e-02]
 [-2.93002069e-03]
 [ 8.91754968e-03]
 [-1.46502107e-02]
 [ 1.57598921e-03]
 [ 2.21524054e-03]
 [-1.36950819e-02]
 [-4.78429155e-03]
 [-9.46162994e-04]
 [ 2.82287049e-03]
 [-2.97962033e-03]
 [ 3.79368971e-03]
 [ 1.12371456e-04]
 [-2.83555248e-04]
 [ 2.28048383e-03]
 [ 8.81810531e-03]
 [ 4.92885989e-03]
 [-1.84538130e-02]
 [ 1.34914416e-02]
 [ 3.55011655e-03]
 [ 1.15502824e-02]
 [-1.48812612e-02]
 [-1.27421349e-02]
 [-3.14797811e-03]
 [-1.67596221e-02]
 [ 4.98143688e-03]
 [ 2.79247022e-02]
 [ 2.23452777e-03]
 [ 7.40945292e-03]
 [-1.55190729e-02]
 [-7.81904445e-03]
 [-7.87468522e-03]
 [ 1.69183591e-03]
 [ 8.10107856e-03]
 [ 3.09502269e-03]
 [-1.10375966e-02]
 [ 6.02190523e-04]
 [-8.53909722e-03]
 [ 5.45813280e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.0081274]
curr_Stock_Price:  101.28166492473471
curr_Factors:  [101.28166492]
mat_Sqrt:  [[0.15]]
grads:  [-0.69309399]
Stock Position:  -0.6930939865076926
Bond Position:  [92.2058403]


portfolio before change:  [22.22043191]
curr_Stock_Price:  100.983665707667
curr_Factors:  [100.98366571]
mat_Sqrt:  [[0.15]]
grads:  [0.00588809]
Stock Position:  0.0058880907505208125
Bond Position:  [21.62583092]


portfolio before change:  [22.21970804]
curr_Stock_Price:  100.63117113063394
curr_Factors:  [100.63117113]
mat_Sqrt:  [[0.15]]
grads:  [0.00306923]
Stock Position:  0.0030692303661723997
Bond Position:  [21.9108478]


portfolio before change:  [22.22163415]
curr_Stock_Price:  100.81253288154743
curr_Factors:  [100.81253288]
mat_Sqrt:  [[0.15]]
grads:  [0.01591008]
Stock Position:  0.01591007529225903
Bond Position:  [20.61769917]


portfolio before change:  [22.22563227]
curr_Stock_Price:  100.98283158267421
curr_Factors:  [100.98283158]
mat_Sqrt:  [[0.15]]
grads:  [0.03324593]
Stock Position:  0.033245925692442675
Bond Position:  [18.86836455]


portfolio before change:  [22.23737421]
curr_Stock_Price:  101.30054385550594
curr_Factors:  [101.30054386]
mat_Sqrt:  [[0.15]]
grads:  [0.08026596]
Stock Position:  0.08026595849600865
Bond Position:  [14.10638897]


portfolio before change:  [22.18047254]
curr_Stock_Price:  100.58064519750344
curr_Factors:  [100.5806452]
mat_Sqrt:  [[0.15]]
grads:  [0.00656505]
Stock Position:  0.006565048845824604
Bond Position:  [21.52015569]


portfolio before change:  [22.17833491]
curr_Stock_Price:  100.05015741676253
curr_Factors:  [100.05015742]
mat_Sqrt:  [[0.15]]
grads:  [0.06674491]
Stock Position:  0.06674491440328992
Bond Position:  [15.50049572]


portfolio before change:  [22.17493586]
curr_Stock_Price:  99.98471632498514
curr_Factors:  [99.98471632]
mat_Sqrt:  [[0.15]]
grads:  [0.08934815]
Stock Position:  0.08934815421342342
Bond Position:  [13.24148601]


portfolio before change:  [22.2080714]
curr_Stock_Price:  100.34631216879772
curr_Factors:  [100.34631217]
mat_Sqrt:  [[0.15]]
grads:  [-0.13403229]
Stock Position:  -0.1340322892325042
Bond Position:  [35.65771734]


portfolio before change:  [22.28138756]
curr_Stock_Price:  99.81593640033908
curr_Factors:  [99.8159364]
mat_Sqrt:  [[0.15]]
grads:  [0.05431208]
Stock Position:  0.05431207503993458
Bond Position:  [16.86017693]


portfolio before change:  [22.28631197]
curr_Stock_Price:  99.88720267456173
curr_Factors:  [99.88720267]
mat_Sqrt:  [[0.15]]
grads:  [-0.0328303]
Stock Position:  -0.03283030217889766
Bond Position:  [25.56563902]


portfolio before change:  [22.28106675]
curr_Stock_Price:  100.09564191046134
curr_Factors:  [100.09564191]
mat_Sqrt:  [[0.15]]
grads:  [-0.05839595]
Stock Position:  -0.05839595057936454
Bond Position:  [28.12624691]


portfolio before change:  [22.33922381]
curr_Stock_Price:  99.12983669350086
curr_Factors:  [99.12983669]
mat_Sqrt:  [[0.15]]
grads:  [0.02556704]
Stock Position:  0.025567041246380356
Bond Position:  [19.80476718]


portfolio before change:  [22.31666452]
curr_Stock_Price:  98.19906320646226
curr_Factors:  [98.19906321]
mat_Sqrt:  [[0.15]]
grads:  [-0.09219708]
Stock Position:  -0.09219707722642889
Bond Position:  [31.37033113]


portfolio before change:  [22.34302602]
curr_Stock_Price:  97.93440415303859
curr_Factors:  [97.93440415]
mat_Sqrt:  [[0.15]]
grads:  [0.1035689]
Stock Position:  0.10356890172506883
Bond Position:  [12.20006734]


portfolio before change:  [22.29977503]
curr_Stock_Price:  97.50943568031268
curr_Factors:  [97.50943568]
mat_Sqrt:  [[0.15]]
grads:  [-0.02363662]
Stock Position:  -0.023636615087935672
Bond Position:  [24.60456803]


portfolio before change:  [22.30251332]
curr_Stock_Price:  97.45864744248946
curr_Factors:  [97.45864744]
mat_Sqrt:  [[0.15]]
grads:  [-0.0240361]
Stock Position:  -0.024036095620271633
Bond Position:  [24.64503869]


portfolio before change:  [22.29906902]
curr_Stock_Price:  97.66602990784897
curr_Factors:  [97.66602991]
mat_Sqrt:  [[0.15]]
grads:  [-0.00038454]
Stock Position:  -0.0003845407934862516
Bond Position:  [22.33662559]


portfolio before change:  [22.30027143]
curr_Stock_Price:  98.1696685684251
curr_Factors:  [98.16966857]
mat_Sqrt:  [[0.15]]
grads:  [0.09266401]
Stock Position:  0.09266401149510257
Bond Position:  [13.20347614]


portfolio before change:  [22.27929415]
curr_Stock_Price:  97.93438275603125
curr_Factors:  [97.93438276]
mat_Sqrt:  [[0.15]]
grads:  [0.00952445]
Stock Position:  0.009524449038815774
Bond Position:  [21.34652311]


portfolio before change:  [22.28356315]
curr_Stock_Price:  98.24251572866136
curr_Factors:  [98.24251573]
mat_Sqrt:  [[0.15]]
grads:  [-0.13749705]
Stock Position:  -0.13749705205642224
Bond Position:  [35.79161945]


portfolio before change:  [22.32920768]
curr_Stock_Price:  97.92681811921685
curr_Factors:  [97.92681812]
mat_Sqrt:  [[0.15]]
grads:  [-0.00360323]
Stock Position:  -0.0036032309041944197
Bond Position:  [22.68206062]


portfolio before change:  [22.32999649]
curr_Stock_Price:  98.10134739890704
curr_Factors:  [98.1013474]
mat_Sqrt:  [[0.15]]
grads:  [0.06339727]
Stock Position:  0.06339726742489302
Bond Position:  [16.11063913]


portfolio before change:  [22.37995245]
curr_Stock_Price:  98.8734471640869
curr_Factors:  [98.87344716]
mat_Sqrt:  [[0.15]]
grads:  [0.04547745]
Stock Position:  0.04547745173827682
Bond Position:  [17.88344003]


portfolio before change:  [22.3564748]
curr_Stock_Price:  98.3326208690763
curr_Factors:  [98.33262087]
mat_Sqrt:  [[0.15]]
grads:  [0.06309268]
Stock Position:  0.06309267836253367
Bond Position:  [16.15240638]


portfolio before change:  [22.34757645]
curr_Stock_Price:  98.17558358215078
curr_Factors:  [98.17558358]
mat_Sqrt:  [[0.15]]
grads:  [0.09171743]
Stock Position:  0.09171742625499024
Bond Position:  [13.3431646]


portfolio before change:  [22.3731664]
curr_Stock_Price:  98.44549929259018
curr_Factors:  [98.44549929]
mat_Sqrt:  [[0.15]]
grads:  [-0.10852981]
Stock Position:  -0.10852981313793092
Bond Position:  [33.05743804]


portfolio before change:  [22.44144853]
curr_Stock_Price:  97.83538141903188
curr_Factors:  [97.83538142]
mat_Sqrt:  [[0.15]]
grads:  [0.00865654]
Stock Position:  0.008656539026595373
Bond Position:  [21.59453273]


portfolio before change:  [22.44784594]
curr_Stock_Price:  98.41849003862743
curr_Factors:  [98.41849004]
mat_Sqrt:  [[0.15]]
grads:  [-0.05961473]
Stock Position:  -0.05961473382889645
Bond Position:  [28.31503802]


portfolio before change:  [22.38893019]
curr_Stock_Price:  99.43645125483192
curr_Factors:  [99.43645125]
mat_Sqrt:  [[0.15]]
grads:  [-0.02712295]
Stock Position:  -0.02712295382288932
Bond Position:  [25.08594047]


portfolio before change:  [22.38785071]
curr_Stock_Price:  99.53405883556852
curr_Factors:  [99.53405884]
mat_Sqrt:  [[0.15]]
grads:  [-0.04923897]
Stock Position:  -0.04923896827559273
Bond Position:  [27.28880507]


portfolio before change:  [22.39860915]
curr_Stock_Price:  99.35020359613686
curr_Factors:  [99.3502036]
mat_Sqrt:  [[0.15]]
grads:  [0.10530178]
Stock Position:  0.10530178111972174
Bond Position:  [11.93685576]


portfolio before change:  [22.35121783]
curr_Stock_Price:  98.89306603936156
curr_Factors:  [98.89306604]
mat_Sqrt:  [[0.15]]
grads:  [0.13123664]
Stock Position:  0.13123663716348763
Bond Position:  [9.37282441]


portfolio before change:  [22.40259443]
curr_Stock_Price:  99.28008281644011
curr_Factors:  [99.28008282]
mat_Sqrt:  [[0.15]]
grads:  [-0.05665671]
Stock Position:  -0.05665671219185019
Bond Position:  [28.02747751]


portfolio before change:  [22.39292868]
curr_Stock_Price:  99.48160394739868
curr_Factors:  [99.48160395]
mat_Sqrt:  [[0.15]]
grads:  [0.02241558]
Stock Position:  0.022415577409335953
Bond Position:  [20.16299109]


portfolio before change:  [22.40550861]
curr_Stock_Price:  99.98659684368937
curr_Factors:  [99.98659684]
mat_Sqrt:  [[0.15]]
grads:  [-0.02242293]
Stock Position:  -0.022422930633797487
Bond Position:  [24.64750114]


portfolio before change:  [22.37745933]
curr_Stock_Price:  101.30621923497077
curr_Factors:  [101.30621923]
mat_Sqrt:  [[0.15]]
grads:  [0.07058848]
Stock Position:  0.07058848089652896
Bond Position:  [15.22640721]


portfolio before change:  [22.32377382]
curr_Stock_Price:  100.5321950489501
curr_Factors:  [100.53219505]
mat_Sqrt:  [[0.15]]
grads:  [-0.01475995]
Stock Position:  -0.014759954468804386
Bond Position:  [23.80762444]


portfolio before change:  [22.31522488]
curr_Stock_Price:  101.21220834665046
curr_Factors:  [101.21220835]
mat_Sqrt:  [[0.15]]
grads:  [-0.06958342]
Stock Position:  -0.0695834209725164
Bond Position:  [29.35791658]


portfolio before change:  [22.31845478]
curr_Stock_Price:  101.1921608451617
curr_Factors:  [101.19216085]
mat_Sqrt:  [[0.15]]
grads:  [-0.07857309]
Stock Position:  -0.07857309050002756
Bond Position:  [30.26943559]


portfolio before change:  [22.38565121]
curr_Stock_Price:  100.361029748311
curr_Factors:  [100.36102975]
mat_Sqrt:  [[0.15]]
grads:  [-0.01953347]
Stock Position:  -0.019533471238106725
Bond Position:  [24.3460505]


portfolio before change:  [22.37354089]
curr_Stock_Price:  101.05890888316408
curr_Factors:  [101.05890888]
mat_Sqrt:  [[0.15]]
grads:  [0.05945033]
Stock Position:  0.0594503312019182
Bond Position:  [16.36555528]


portfolio before change:  [22.37196857]
curr_Stock_Price:  101.01525571796161
curr_Factors:  [101.01525572]
mat_Sqrt:  [[0.15]]
grads:  [-0.09766807]
Stock Position:  -0.09766807109372888
Bond Position:  [32.23793375]


portfolio before change:  [22.37046002]
curr_Stock_Price:  101.05133185318253
curr_Factors:  [101.05133185]
mat_Sqrt:  [[0.15]]
grads:  [0.01050659]
Stock Position:  0.0105065947643095
Bond Position:  [21.30875462]


portfolio before change:  [22.38143356]
curr_Stock_Price:  101.96901253338348
curr_Factors:  [101.96901253]
mat_Sqrt:  [[0.15]]
grads:  [0.01476827]
Stock Position:  0.01476827023422049
Bond Position:  [20.87552762]


portfolio before change:  [22.37441143]
curr_Stock_Price:  101.40517629806979
curr_Factors:  [101.4051763]
mat_Sqrt:  [[0.15]]
grads:  [-0.09130055]
Stock Position:  -0.09130054578716532
Bond Position:  [31.63275937]


portfolio before change:  [22.3917344]
curr_Stock_Price:  101.23709555355885
curr_Factors:  [101.23709555]
mat_Sqrt:  [[0.15]]
grads:  [-0.03189528]
Stock Position:  -0.03189527700866541
Bond Position:  [25.62071961]


portfolio before change:  [22.38007117]
curr_Stock_Price:  101.65297454280535
curr_Factors:  [101.65297454]
mat_Sqrt:  [[0.15]]
grads:  [-0.00630775]
Stock Position:  -0.006307753290389125
Bond Position:  [23.02127306]


portfolio before change:  [22.38534326]
curr_Stock_Price:  101.04527559229052
curr_Factors:  [101.04527559]
mat_Sqrt:  [[0.15]]
grads:  [0.01881914]
Stock Position:  0.018819136578013623
Bond Position:  [20.48375842]


portfolio before change:  [22.37739667]
curr_Stock_Price:  100.55498375325986
curr_Factors:  [100.55498375]
mat_Sqrt:  [[0.15]]
grads:  [-0.01986414]
Stock Position:  -0.01986413556220893
Bond Position:  [24.3748345]


portfolio before change:  [22.36776165]
curr_Stock_Price:  101.11672462618445
curr_Factors:  [101.11672463]
mat_Sqrt:  [[0.15]]
grads:  [0.02529126]
Stock Position:  0.025291264706094392
Bond Position:  [19.8103918]


portfolio before change:  [22.37889543]
curr_Stock_Price:  101.50798977429226
curr_Factors:  [101.50798977]
mat_Sqrt:  [[0.15]]
grads:  [0.00074914]
Stock Position:  0.0007491430373301733
Bond Position:  [22.30285142]


portfolio before change:  [22.37976885]
curr_Stock_Price:  100.81313565995512
curr_Factors:  [100.81313566]
mat_Sqrt:  [[0.15]]
grads:  [-0.00189037]
Stock Position:  -0.0018903683195696896
Bond Position:  [22.57034281]


portfolio before change:  [22.38190094]
curr_Stock_Price:  100.43152095415462
curr_Factors:  [100.43152095]
mat_Sqrt:  [[0.15]]
grads:  [0.01520323]
Stock Position:  0.015203225562418574
Bond Position:  [20.85501787]


portfolio before change:  [22.3772148]
curr_Stock_Price:  100.03755080145748
curr_Factors:  [100.0375508]
mat_Sqrt:  [[0.15]]
grads:  [0.05878737]
Stock Position:  0.058787368746650595
Bond Position:  [16.49627041]


portfolio before change:  [22.3956908]
curr_Stock_Price:  100.33429740786893
curr_Factors:  [100.33429741]
mat_Sqrt:  [[0.15]]
grads:  [0.03285907]
Stock Position:  0.032859065922129976
Bond Position:  [19.09879951]


portfolio before change:  [22.42529622]
curr_Stock_Price:  101.19895091848136
curr_Factors:  [101.19895092]
mat_Sqrt:  [[0.15]]
grads:  [-0.12302542]
Stock Position:  -0.12302542029078804
Bond Position:  [34.87533969]


portfolio before change:  [22.33485922]
curr_Stock_Price:  101.95177727740713
curr_Factors:  [101.95177728]
mat_Sqrt:  [[0.15]]
grads:  [0.08994294]
Stock Position:  0.08994294407833213
Bond Position:  [13.16501621]


portfolio before change:  [22.36149914]
curr_Stock_Price:  102.23881575724211
curr_Factors:  [102.23881576]
mat_Sqrt:  [[0.15]]
grads:  [0.02366744]
Stock Position:  0.023667443640806255
Bond Position:  [19.94176773]


portfolio before change:  [22.37605454]
curr_Stock_Price:  102.80114959281327
curr_Factors:  [102.80114959]
mat_Sqrt:  [[0.15]]
grads:  [0.07700188]
Stock Position:  0.07700188247288633
Bond Position:  [14.46017251]


portfolio before change:  [22.36668162]
curr_Stock_Price:  102.66768904280846
curr_Factors:  [102.66768904]
mat_Sqrt:  [[0.15]]
grads:  [-0.09920841]
Stock Position:  -0.09920840795777672
Bond Position:  [32.5521796]


portfolio before change:  [22.32397348]
curr_Stock_Price:  103.11868620404218
curr_Factors:  [103.1186862]
mat_Sqrt:  [[0.15]]
grads:  [-0.08494757]
Stock Position:  -0.08494756623351964
Bond Position:  [31.08365491]


portfolio before change:  [22.34603654]
curr_Stock_Price:  102.88183104509412
curr_Factors:  [102.88183105]
mat_Sqrt:  [[0.15]]
grads:  [-0.02098652]
Stock Position:  -0.020986520745797845
Bond Position:  [24.50516822]


portfolio before change:  [22.3651879]
curr_Stock_Price:  102.0422571574344
curr_Factors:  [102.04225716]
mat_Sqrt:  [[0.15]]
grads:  [-0.11173081]
Stock Position:  -0.1117308140499862
Bond Position:  [33.76645236]


portfolio before change:  [22.39220962]
curr_Stock_Price:  101.81929942351051
curr_Factors:  [101.81929942]
mat_Sqrt:  [[0.15]]
grads:  [0.03320958]
Stock Position:  0.033209579172721826
Bond Position:  [19.01083353]


portfolio before change:  [22.42822889]
curr_Stock_Price:  102.86812507400842
curr_Factors:  [102.86812507]
mat_Sqrt:  [[0.15]]
grads:  [0.18616468]
Stock Position:  0.1861646812752369
Bond Position:  [3.27781717]


portfolio before change:  [22.34185826]
curr_Stock_Price:  102.40307712138825
curr_Factors:  [102.40307712]
mat_Sqrt:  [[0.15]]
grads:  [0.01489685]
Stock Position:  0.014896851816326395
Bond Position:  [20.81637479]


portfolio before change:  [22.34581826]
curr_Stock_Price:  102.58156691716691
curr_Factors:  [102.58156692]
mat_Sqrt:  [[0.15]]
grads:  [0.04939635]
Stock Position:  0.04939635279688305
Bond Position:  [17.27866299]


portfolio before change:  [22.34673324]
curr_Stock_Price:  102.5782272611188
curr_Factors:  [102.57822726]
mat_Sqrt:  [[0.15]]
grads:  [-0.10346049]
Stock Position:  -0.1034604860941762
Bond Position:  [32.95952649]


portfolio before change:  [22.35447597]
curr_Stock_Price:  102.52330097609189
curr_Factors:  [102.52330098]
mat_Sqrt:  [[0.15]]
grads:  [-0.05212696]
Stock Position:  -0.05212696297445682
Bond Position:  [27.69870429]


portfolio before change:  [22.34953285]
curr_Stock_Price:  102.65134118141339
curr_Factors:  [102.65134118]
mat_Sqrt:  [[0.15]]
grads:  [-0.0524979]
Stock Position:  -0.05249790143685599
Bond Position:  [27.73851284]


portfolio before change:  [22.38249173]
curr_Stock_Price:  102.05655235954865
curr_Factors:  [102.05655236]
mat_Sqrt:  [[0.15]]
grads:  [0.01127891]
Stock Position:  0.011278906096738853
Bond Position:  [21.23140546]


portfolio before change:  [22.38417285]
curr_Stock_Price:  102.08794935077071
curr_Factors:  [102.08794935]
mat_Sqrt:  [[0.15]]
grads:  [0.05400719]
Stock Position:  0.054007190422991444
Bond Position:  [16.87068953]


portfolio before change:  [22.37445827]
curr_Stock_Price:  101.88854940596812
curr_Factors:  [101.88854941]
mat_Sqrt:  [[0.15]]
grads:  [0.02063348]
Stock Position:  0.020633484568899785
Bond Position:  [20.27214246]


portfolio before change:  [22.36685127]
curr_Stock_Price:  101.45846929949644
curr_Factors:  [101.4584693]
mat_Sqrt:  [[0.15]]
grads:  [-0.07358398]
Stock Position:  -0.07358397739623801
Bond Position:  [29.83256898]


portfolio before change:  [22.4106266]
curr_Stock_Price:  100.88890604229498
curr_Factors:  [100.88890604]
mat_Sqrt:  [[0.15]]
grads:  [0.0040146]
Stock Position:  0.004014603484604913
Bond Position:  [22.00559764]


portfolio before change:  [22.4093762]
curr_Stock_Price:  100.2348466679222
curr_Factors:  [100.23484667]
mat_Sqrt:  [[0.15]]
grads:  [-0.05692731]
Stock Position:  -0.0569273148208301
Bond Position:  [28.11547687]


portfolio before change:  [22.39361515]
curr_Stock_Price:  100.54257803466334
curr_Factors:  [100.54257803]
mat_Sqrt:  [[0.15]]
grads:  [0.03638755]
Stock Position:  0.03638755201883989
Bond Position:  [18.73511686]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.39361515]
Stock Price:  100.96299404193037
PL:  [21.43062111]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.63937586e-02]
 [ 8.23168789e-03]
 [-1.07740604e-04]
 [ 6.38793988e-05]
 [-1.02754390e-02]
 [ 1.03247380e-02]
 [ 7.31379102e-04]
 [ 1.52615146e-02]
 [ 2.22672128e-03]
 [-1.96324082e-02]
 [ 1.02325406e-02]
 [-6.91384032e-03]
 [ 5.94081454e-03]
 [ 4.26780769e-03]
 [ 6.18560415e-03]
 [-6.83429256e-03]
 [ 1.33289252e-02]
 [ 1.93442152e-02]
 [ 2.03264115e-02]
 [ 6.53074731e-03]
 [ 6.05632554e-02]
 [-1.46780547e-02]
 [-2.52607006e-03]
 [ 8.42113243e-03]
 [ 2.67727145e-03]
 [ 1.45562597e-02]
 [ 1.47756463e-02]
 [-1.89038454e-02]
 [ 1.44541858e-03]
 [-1.72054812e-02]
 [-4.28160962e-03]
 [-8.02298730e-03]
 [ 1.53392222e-02]
 [ 1.47278400e-02]
 [ 3.66230107e-03]
 [-4.70837225e-03]
 [-6.97916782e-03]
 [ 5.28196726e-03]
 [ 1.46430926e-03]
 [-8.71232257e-03]
 [-3.27299732e-02]
 [-2.97292495e-03]
 [ 1.27093821e-02]
 [-1.24440719e-02]
 [-2.80983963e-04]
 [ 2.23111963e-03]
 [-1.36548759e-02]
 [ 2.25511206e-03]
 [-1.86501466e-04]
 [-9.27734715e-04]
 [-3.02597086e-03]
 [ 3.80303623e-03]
 [ 1.15275784e-03]
 [-2.25725354e-03]
 [ 2.21455704e-03]
 [ 8.83638104e-03]
 [ 5.92336082e-03]
 [-2.12011465e-02]
 [ 1.34987267e-02]
 [ 6.75627983e-03]
 [ 9.89773401e-03]
 [-1.34248214e-02]
 [-1.25542894e-02]
 [-2.36818850e-03]
 [-2.01076574e-02]
 [ 2.15002231e-02]
 [ 2.91874328e-02]
 [ 2.51467540e-03]
 [ 8.88922842e-03]
 [-1.89997050e-02]
 [-7.77476969e-03]
 [-7.99842742e-03]
 [ 2.53669161e-03]
 [ 7.39221947e-03]
 [-7.32673905e-04]
 [-1.09751543e-02]
 [ 6.14675314e-03]
 [-3.94499435e-03]
 [ 2.43632253e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.55086421]
curr_Stock_Price:  99.63897167569719
curr_Factors:  [99.63897168]
mat_Sqrt:  [[0.15]]
grads:  [-0.24262506]
Stock Position:  -0.24262505717427052
Bond Position:  [20.62404699]


portfolio before change:  [-3.33518252]
curr_Stock_Price:  98.75533399687676
curr_Factors:  [98.755334]
mat_Sqrt:  [[0.15]]
grads:  [0.05487792]
Stock Position:  0.05487791924612918
Bond Position:  [-8.75466977]


portfolio before change:  [-3.29061762]
curr_Stock_Price:  99.57737830566462
curr_Factors:  [99.57737831]
mat_Sqrt:  [[0.15]]
grads:  [-0.00071827]
Stock Position:  -0.0007182706946820088
Bond Position:  [-3.21909411]


portfolio before change:  [-3.29049669]
curr_Stock_Price:  99.12889006337457
curr_Factors:  [99.12889006]
mat_Sqrt:  [[0.15]]
grads:  [0.00042586]
Stock Position:  0.00042586265870125234
Bond Position:  [-3.33271198]


portfolio before change:  [-3.29073198]
curr_Stock_Price:  99.06550305571369
curr_Factors:  [99.06550306]
mat_Sqrt:  [[0.15]]
grads:  [-0.06850293]
Stock Position:  -0.06850292655621865
Bond Position:  [3.4955449]


portfolio before change:  [-3.31397332]
curr_Stock_Price:  99.40796746523063
curr_Factors:  [99.40796747]
mat_Sqrt:  [[0.15]]
grads:  [0.06883159]
Stock Position:  0.06883158664074822
Bond Position:  [-10.15638144]


portfolio before change:  [-3.30767917]
curr_Stock_Price:  99.50863268715996
curr_Factors:  [99.50863269]
mat_Sqrt:  [[0.15]]
grads:  [0.00487586]
Stock Position:  0.004875860680012173
Bond Position:  [-3.7928694]


portfolio before change:  [-3.30901793]
curr_Stock_Price:  99.28268290060997
curr_Factors:  [99.2826829]
mat_Sqrt:  [[0.15]]
grads:  [0.10174343]
Stock Position:  0.10174343079207064
Bond Position:  [-13.4103787]


portfolio before change:  [-3.17791364]
curr_Stock_Price:  100.57949847270652
curr_Factors:  [100.57949847]
mat_Sqrt:  [[0.15]]
grads:  [0.01484481]
Stock Position:  0.014844808534751926
Bond Position:  [-4.67099703]


portfolio before change:  [-3.16810767]
curr_Stock_Price:  101.25973011468831
curr_Factors:  [101.25973011]
mat_Sqrt:  [[0.15]]
grads:  [-0.13088272]
Stock Position:  -0.13088272105555523
Bond Position:  [10.08504134]


portfolio before change:  [-3.11191371]
curr_Stock_Price:  100.83520019766098
curr_Factors:  [100.8352002]
mat_Sqrt:  [[0.15]]
grads:  [0.06821694]
Stock Position:  0.06821693718860651
Bond Position:  [-9.99058223]


portfolio before change:  [-3.1097696]
curr_Stock_Price:  100.87578448192497
curr_Factors:  [100.87578448]
mat_Sqrt:  [[0.15]]
grads:  [-0.04609227]
Stock Position:  -0.046092268823872844
Bond Position:  [1.53982417]


portfolio before change:  [-3.11179164]
curr_Stock_Price:  100.92174184225996
curr_Factors:  [100.92174184]
mat_Sqrt:  [[0.15]]
grads:  [0.03960543]
Stock Position:  0.03960543026510865
Bond Position:  [-7.10884065]


portfolio before change:  [-3.12745497]
curr_Stock_Price:  100.5374759351857
curr_Factors:  [100.53747594]
mat_Sqrt:  [[0.15]]
grads:  [0.02845205]
Stock Position:  0.028452051296606884
Bond Position:  [-5.9879524]


portfolio before change:  [-3.13578858]
curr_Stock_Price:  100.25772993560568
curr_Factors:  [100.25772994]
mat_Sqrt:  [[0.15]]
grads:  [0.04123736]
Stock Position:  0.041237361032559205
Bond Position:  [-7.27015279]


portfolio before change:  [-3.12257001]
curr_Stock_Price:  100.58929754683639
curr_Factors:  [100.58929755]
mat_Sqrt:  [[0.15]]
grads:  [-0.04556195]
Stock Position:  -0.04556195038829587
Bond Position:  [1.46047458]


portfolio before change:  [-3.11778416]
curr_Stock_Price:  100.48626063301946
curr_Factors:  [100.48626063]
mat_Sqrt:  [[0.15]]
grads:  [0.0888595]
Stock Position:  0.08885950125958725
Bond Position:  [-12.04694316]


portfolio before change:  [-3.06723482]
curr_Stock_Price:  101.06360239253956
curr_Factors:  [101.06360239]
mat_Sqrt:  [[0.15]]
grads:  [0.12896143]
Stock Position:  0.12896143473486865
Bond Position:  [-16.10054198]


portfolio before change:  [-3.09369431]
curr_Stock_Price:  100.8662319672345
curr_Factors:  [100.86623197]
mat_Sqrt:  [[0.15]]
grads:  [0.13550941]
Stock Position:  0.13550941003747705
Bond Position:  [-16.76201789]


portfolio before change:  [-3.2056665]
curr_Stock_Price:  100.04765756176523
curr_Factors:  [100.04765756]
mat_Sqrt:  [[0.15]]
grads:  [0.04353832]
Stock Position:  0.04353831543027385
Bond Position:  [-7.56157297]


portfolio before change:  [-3.22029056]
curr_Stock_Price:  99.72262325756301
curr_Factors:  [99.72262326]
mat_Sqrt:  [[0.15]]
grads:  [0.40375504]
Stock Position:  0.4037550360409951
Bond Position:  [-43.48380191]


portfolio before change:  [-3.17462091]
curr_Stock_Price:  99.84246689058031
curr_Factors:  [99.84246689]
mat_Sqrt:  [[0.15]]
grads:  [-0.0978537]
Stock Position:  -0.09785369832959195
Bond Position:  [6.59533372]


portfolio before change:  [-3.17082068]
curr_Stock_Price:  99.80784370805272
curr_Factors:  [99.80784371]
mat_Sqrt:  [[0.15]]
grads:  [-0.01684047]
Stock Position:  -0.016840467077786407
Bond Position:  [-1.49000998]


portfolio before change:  [-3.13903251]
curr_Stock_Price:  97.91470733105278
curr_Factors:  [97.91470733]
mat_Sqrt:  [[0.15]]
grads:  [0.05614088]
Stock Position:  0.05614088286880259
Bond Position:  [-8.63605063]


portfolio before change:  [-3.12421578]
curr_Stock_Price:  98.18824245557744
curr_Factors:  [98.18824246]
mat_Sqrt:  [[0.15]]
grads:  [0.01784848]
Stock Position:  0.01784847634433608
Bond Position:  [-4.8767263]


portfolio before change:  [-3.13111495]
curr_Stock_Price:  97.81877869174734
curr_Factors:  [97.81877869]
mat_Sqrt:  [[0.15]]
grads:  [0.09704173]
Stock Position:  0.09704173122910954
Bond Position:  [-12.62361858]


portfolio before change:  [-3.14561067]
curr_Stock_Price:  97.67753307293621
curr_Factors:  [97.67753307]
mat_Sqrt:  [[0.15]]
grads:  [0.09850431]
Stock Position:  0.09850430869583521
Bond Position:  [-12.76726854]


portfolio before change:  [-3.12976836]
curr_Stock_Price:  97.84646258593874
curr_Factors:  [97.84646259]
mat_Sqrt:  [[0.15]]
grads:  [-0.12602564]
Stock Position:  -0.12602563568514674
Bond Position:  [9.20139428]


portfolio before change:  [-3.15024492]
curr_Stock_Price:  98.01350525908826
curr_Factors:  [98.01350526]
mat_Sqrt:  [[0.15]]
grads:  [0.00963612]
Stock Position:  0.009636123838887761
Bond Position:  [-4.09471519]


portfolio before change:  [-3.13746854]
curr_Stock_Price:  99.36594810925999
curr_Factors:  [99.36594811]
mat_Sqrt:  [[0.15]]
grads:  [-0.11470321]
Stock Position:  -0.1147032079410292
Bond Position:  [8.26012447]


portfolio before change:  [-3.17761013]
curr_Stock_Price:  99.72040956127195
curr_Factors:  [99.72040956]
mat_Sqrt:  [[0.15]]
grads:  [-0.02854406]
Stock Position:  -0.028544064100807558
Bond Position:  [-0.33118437]


portfolio before change:  [-3.17170477]
curr_Stock_Price:  99.51279866440288
curr_Factors:  [99.51279866]
mat_Sqrt:  [[0.15]]
grads:  [-0.05348658]
Stock Position:  -0.05348658202029057
Bond Position:  [2.1508947]


portfolio before change:  [-3.18367243]
curr_Stock_Price:  99.73906283196843
curr_Factors:  [99.73906283]
mat_Sqrt:  [[0.15]]
grads:  [0.10226148]
Stock Position:  0.10226148106390587
Bond Position:  [-13.38313672]


portfolio before change:  [-3.11245547]
curr_Stock_Price:  100.44366277684445
curr_Factors:  [100.44366278]
mat_Sqrt:  [[0.15]]
grads:  [0.0981856]
Stock Position:  0.09818560029390772
Bond Position:  [-12.9745768]


portfolio before change:  [-3.0702125]
curr_Stock_Price:  100.88215787697119
curr_Factors:  [100.88215788]
mat_Sqrt:  [[0.15]]
grads:  [0.02441534]
Stock Position:  0.024415340473580353
Bond Position:  [-5.53328473]


portfolio before change:  [-3.05809115]
curr_Stock_Price:  101.39278752785297
curr_Factors:  [101.39278753]
mat_Sqrt:  [[0.15]]
grads:  [-0.03138915]
Stock Position:  -0.031389148357845044
Bond Position:  [0.1245421]


portfolio before change:  [-3.06330021]
curr_Stock_Price:  101.55898656137607
curr_Factors:  [101.55898656]
mat_Sqrt:  [[0.15]]
grads:  [-0.04652779]
Stock Position:  -0.04652778543874878
Bond Position:  [1.66201453]


portfolio before change:  [-3.08517209]
curr_Stock_Price:  102.03130132419012
curr_Factors:  [102.03130132]
mat_Sqrt:  [[0.15]]
grads:  [0.03521312]
Stock Position:  0.03521311509625081
Bond Position:  [-6.67801205]


portfolio before change:  [-3.07889516]
curr_Stock_Price:  102.22140998010657
curr_Factors:  [102.22140998]
mat_Sqrt:  [[0.15]]
grads:  [0.00976206]
Stock Position:  0.009762061723629955
Bond Position:  [-4.07678687]


portfolio before change:  [-3.0815432]
curr_Stock_Price:  101.97625337741047
curr_Factors:  [101.97625338]
mat_Sqrt:  [[0.15]]
grads:  [-0.05808215]
Stock Position:  -0.05808215044151325
Bond Position:  [2.84145689]


portfolio before change:  [-3.12421986]
curr_Stock_Price:  102.71407476044168
curr_Factors:  [102.71407476]
mat_Sqrt:  [[0.15]]
grads:  [-0.21819982]
Stock Position:  -0.21819982115101969
Bond Position:  [19.28797289]


portfolio before change:  [-3.23176384]
curr_Stock_Price:  103.21246893566682
curr_Factors:  [103.21246894]
mat_Sqrt:  [[0.15]]
grads:  [-0.0198195]
Stock Position:  -0.019819499671846944
Bond Position:  [-1.18614435]


portfolio before change:  [-3.22522952]
curr_Stock_Price:  102.8790368303423
curr_Factors:  [102.87903683]
mat_Sqrt:  [[0.15]]
grads:  [0.08472921]
Stock Position:  0.08472921420295541
Bond Position:  [-11.94208947]


portfolio before change:  [-3.19322309]
curr_Stock_Price:  103.2655957189987
curr_Factors:  [103.26559572]
mat_Sqrt:  [[0.15]]
grads:  [-0.08296048]
Stock Position:  -0.08296047956021273
Bond Position:  [5.37374025]


portfolio before change:  [-3.13157368]
curr_Stock_Price:  102.52652641358864
curr_Factors:  [102.52652641]
mat_Sqrt:  [[0.15]]
grads:  [-0.00187323]
Stock Position:  -0.0018732264170645409
Bond Position:  [-2.93951828]


portfolio before change:  [-3.1308778]
curr_Stock_Price:  102.05696056600841
curr_Factors:  [102.05696057]
mat_Sqrt:  [[0.15]]
grads:  [0.01487413]
Stock Position:  0.014874130850182592
Bond Position:  [-4.64888639]


portfolio before change:  [-3.12841468]
curr_Stock_Price:  102.24209334052347
curr_Factors:  [102.24209334]
mat_Sqrt:  [[0.15]]
grads:  [-0.09103251]
Stock Position:  -0.09103250601224304
Bond Position:  [6.1789393]


portfolio before change:  [-3.18410129]
curr_Stock_Price:  102.85805807012851
curr_Factors:  [102.85805807]
mat_Sqrt:  [[0.15]]
grads:  [0.01503408]
Stock Position:  0.015034080376433636
Bond Position:  [-4.73047761]


portfolio before change:  [-3.19907814]
curr_Stock_Price:  101.88153147998251
curr_Factors:  [101.88153148]
mat_Sqrt:  [[0.15]]
grads:  [-0.00124334]
Stock Position:  -0.0012433431096013565
Bond Position:  [-3.07240444]


portfolio before change:  [-3.19909119]
curr_Stock_Price:  101.73758134798966
curr_Factors:  [101.73758135]
mat_Sqrt:  [[0.15]]
grads:  [-0.0061849]
Stock Position:  -0.00618489809672007
Bond Position:  [-2.56985462]


portfolio before change:  [-3.19715421]
curr_Stock_Price:  101.3984332850177
curr_Factors:  [101.39843329]
mat_Sqrt:  [[0.15]]
grads:  [-0.02017314]
Stock Position:  -0.02017313905298033
Bond Position:  [-1.15162952]


portfolio before change:  [-3.18626533]
curr_Stock_Price:  100.85509356776892
curr_Factors:  [100.85509357]
mat_Sqrt:  [[0.15]]
grads:  [0.02535357]
Stock Position:  0.025353574844137236
Bond Position:  [-5.74330249]


portfolio before change:  [-3.20467827]
curr_Stock_Price:  100.14300569308514
curr_Factors:  [100.14300569]
mat_Sqrt:  [[0.15]]
grads:  [0.00768505]
Stock Position:  0.007685052260390024
Bond Position:  [-3.9742825]


portfolio before change:  [-3.20625999]
curr_Stock_Price:  99.96951002994113
curr_Factors:  [99.96951003]
mat_Sqrt:  [[0.15]]
grads:  [-0.01504836]
Stock Position:  -0.015048356944123478
Bond Position:  [-1.70188312]


portfolio before change:  [-3.20856822]
curr_Stock_Price:  100.1158289498371
curr_Factors:  [100.11582895]
mat_Sqrt:  [[0.15]]
grads:  [0.01476371]
Stock Position:  0.014763713584339137
Bond Position:  [-4.68664964]


portfolio before change:  [-3.21046992]
curr_Stock_Price:  100.00686104185195
curr_Factors:  [100.00686104]
mat_Sqrt:  [[0.15]]
grads:  [0.05890921]
Stock Position:  0.058909206964857325
Bond Position:  [-9.10179479]


portfolio before change:  [-3.19556652]
curr_Stock_Price:  100.2695071126281
curr_Factors:  [100.26950711]
mat_Sqrt:  [[0.15]]
grads:  [0.03948907]
Stock Position:  0.03948907212419974
Bond Position:  [-7.15511632]


portfolio before change:  [-3.19151383]
curr_Stock_Price:  100.38346034157368
curr_Factors:  [100.38346034]
mat_Sqrt:  [[0.15]]
grads:  [-0.14134098]
Stock Position:  -0.14134097650603733
Bond Position:  [10.99678248]


portfolio before change:  [-3.26103668]
curr_Stock_Price:  100.88020361390465
curr_Factors:  [100.88020361]
mat_Sqrt:  [[0.15]]
grads:  [0.08999151]
Stock Position:  0.08999151139119635
Bond Position:  [-12.33939868]


portfolio before change:  [-3.24651295]
curr_Stock_Price:  101.05016376431759
curr_Factors:  [101.05016376]
mat_Sqrt:  [[0.15]]
grads:  [0.04504187]
Stock Position:  0.04504186552738315
Bond Position:  [-7.79800084]


portfolio before change:  [-3.230988]
curr_Stock_Price:  101.40566291048863
curr_Factors:  [101.40566291]
mat_Sqrt:  [[0.15]]
grads:  [0.06598489]
Stock Position:  0.06598489341085335
Bond Position:  [-9.92222985]


portfolio before change:  [-3.22910976]
curr_Stock_Price:  101.44352610870827
curr_Factors:  [101.44352611]
mat_Sqrt:  [[0.15]]
grads:  [-0.08949881]
Stock Position:  -0.08949880953382304
Bond Position:  [5.84996507]


portfolio before change:  [-3.18152186]
curr_Stock_Price:  100.915896071443
curr_Factors:  [100.91589607]
mat_Sqrt:  [[0.15]]
grads:  [-0.08369526]
Stock Position:  -0.08369526239998638
Bond Position:  [5.26466054]


portfolio before change:  [-3.20355599]
curr_Stock_Price:  101.18309380941095
curr_Factors:  [101.18309381]
mat_Sqrt:  [[0.15]]
grads:  [-0.01578792]
Stock Position:  -0.015787923301737013
Bond Position:  [-1.60608507]


portfolio before change:  [-3.20108335]
curr_Stock_Price:  101.02011914335996
curr_Factors:  [101.02011914]
mat_Sqrt:  [[0.15]]
grads:  [-0.13405105]
Stock Position:  -0.13405104927129938
Bond Position:  [10.34076962]


portfolio before change:  [-3.22369817]
curr_Stock_Price:  101.19364362384808
curr_Factors:  [101.19364362]
mat_Sqrt:  [[0.15]]
grads:  [0.14333482]
Stock Position:  0.14333482075209056
Bond Position:  [-17.72827094]


portfolio before change:  [-3.08532794]
curr_Stock_Price:  102.16673779728693
curr_Factors:  [102.1667378]
mat_Sqrt:  [[0.15]]
grads:  [0.19458289]
Stock Position:  0.19458288529424217
Bond Position:  [-22.96522656]


portfolio before change:  [-2.98770076]
curr_Stock_Price:  102.67583985965207
curr_Factors:  [102.67583986]
mat_Sqrt:  [[0.15]]
grads:  [0.0167645]
Stock Position:  0.016764502652056455
Bond Position:  [-4.70901015]


portfolio before change:  [-2.97473105]
curr_Stock_Price:  103.46703735830198
curr_Factors:  [103.46703736]
mat_Sqrt:  [[0.15]]
grads:  [0.05926152]
Stock Position:  0.059261522800494945
Bond Position:  [-9.10634525]


portfolio before change:  [-2.98403337]
curr_Stock_Price:  103.31967104752654
curr_Factors:  [103.31967105]
mat_Sqrt:  [[0.15]]
grads:  [-0.1266647]
Stock Position:  -0.12666470024872573
Bond Position:  [10.10292179]


portfolio before change:  [-2.92594869]
curr_Stock_Price:  102.86608589571229
curr_Factors:  [102.8660859]
mat_Sqrt:  [[0.15]]
grads:  [-0.0518318]
Stock Position:  -0.05183179792879848
Bond Position:  [2.40578549]


portfolio before change:  [-2.90195264]
curr_Stock_Price:  102.40602694436467
curr_Factors:  [102.40602694]
mat_Sqrt:  [[0.15]]
grads:  [-0.05332285]
Stock Position:  -0.05332284944189611
Bond Position:  [2.55862852]


portfolio before change:  [-2.91698396]
curr_Stock_Price:  102.69091875003555
curr_Factors:  [102.69091875]
mat_Sqrt:  [[0.15]]
grads:  [0.01691128]
Stock Position:  0.01691127740272635
Bond Position:  [-4.65361858]


portfolio before change:  [-2.91005636]
curr_Stock_Price:  103.11776196977121
curr_Factors:  [103.11776197]
mat_Sqrt:  [[0.15]]
grads:  [0.04928146]
Stock Position:  0.04928146312232245
Bond Position:  [-7.99185054]


portfolio before change:  [-2.91698688]
curr_Stock_Price:  102.98726633547324
curr_Factors:  [102.98726634]
mat_Sqrt:  [[0.15]]
grads:  [-0.00488449]
Stock Position:  -0.004884492698372303
Bond Position:  [-2.41394633]


portfolio before change:  [-2.91762801]
curr_Stock_Price:  103.08763470553815
curr_Factors:  [103.08763471]
mat_Sqrt:  [[0.15]]
grads:  [-0.0731677]
Stock Position:  -0.07316769518140857
Bond Position:  [4.62505663]


portfolio before change:  [-2.90189243]
curr_Stock_Price:  102.87652377616321
curr_Factors:  [102.87652378]
mat_Sqrt:  [[0.15]]
grads:  [0.04097835]
Stock Position:  0.0409783542715272
Bond Position:  [-7.11760307]


portfolio before change:  [-2.87217752]
curr_Stock_Price:  103.61251664382289
curr_Factors:  [103.61251664]
mat_Sqrt:  [[0.15]]
grads:  [-0.02629996]
Stock Position:  -0.02629996232201755
Bond Position:  [-0.14717224]


portfolio before change:  [-2.86320331]
curr_Stock_Price:  103.27094179600907
curr_Factors:  [103.2709418]
mat_Sqrt:  [[0.15]]
grads:  [0.1624215]
Stock Position:  0.16242150218176038
Bond Position:  [-19.63662481]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.86320331]
Stock Price:  103.29257249752924
PL:  [-6.15577581]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-5.41315106e-02]
 [ 8.88990255e-04]
 [ 5.86999623e-03]
 [ 2.31818770e-03]
 [ 1.24460713e-03]
 [ 1.21145359e-02]
 [ 1.00156094e-03]
 [ 7.25939155e-03]
 [-8.57489125e-03]
 [-1.97989708e-02]
 [ 1.00633771e-02]
 [-9.52942981e-03]
 [ 2.47625597e-02]
 [ 2.21123955e-02]
 [-7.80164883e-03]
 [-7.95527102e-03]
 [ 8.46290023e-03]
 [ 2.67613078e-02]
 [ 1.82833715e-02]
 [-1.87415293e-03]
 [ 4.39898322e-02]
 [-1.30106836e-02]
 [ 8.80963902e-03]
 [-3.88532618e-03]
 [ 1.77217648e-02]
 [ 1.83198178e-02]
 [ 9.52359455e-03]
 [-9.28977852e-04]
 [ 7.84488230e-03]
 [-1.15965239e-02]
 [-5.66436986e-03]
 [ 3.72827060e-02]
 [ 3.92877965e-03]
 [-7.50162043e-03]
 [-5.68467432e-03]
 [-4.03699796e-03]
 [-3.26719806e-03]
 [-4.19551158e-05]
 [ 5.63194862e-03]
 [-7.27465117e-03]
 [-3.99177724e-02]
 [-3.23910985e-03]
 [ 1.44467739e-02]
 [-1.39413984e-02]
 [-1.16912994e-03]
 [ 2.55974809e-03]
 [-1.36235434e-02]
 [ 9.40730544e-03]
 [ 1.70990169e-02]
 [-1.22728524e-02]
 [-4.32454031e-03]
 [ 3.57929832e-03]
 [ 2.96531890e-03]
 [-3.28226715e-03]
 [-9.03368545e-03]
 [ 1.23689138e-02]
 [-2.89545332e-02]
 [-8.97325075e-03]
 [ 1.87870245e-02]
 [-6.06440343e-03]
 [ 1.31528963e-02]
 [-1.38979609e-02]
 [-1.26912518e-02]
 [-2.69965578e-03]
 [ 8.55472420e-02]
 [-1.35584792e-02]
 [ 3.92588795e-03]
 [ 6.18909125e-03]
 [ 1.38860379e-02]
 [-2.86051481e-02]
 [-7.81703880e-03]
 [-5.69227113e-03]
 [ 1.10105480e-02]
 [ 5.52339841e-03]
 [-1.48861628e-03]
 [ 3.06418665e-03]
 [ 5.50581500e-03]
 [-3.22763157e-03]
 [ 2.27438833e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.05545959]
curr_Stock_Price:  100.44918842113056
curr_Factors:  [100.44918842]
mat_Sqrt:  [[0.15]]
grads:  [-0.36087674]
Stock Position:  -0.3608767373923214
Bond Position:  [45.30523498]


portfolio before change:  [8.8649759]
curr_Stock_Price:  100.98487090997595
curr_Factors:  [100.98487091]
mat_Sqrt:  [[0.15]]
grads:  [0.0059266]
Stock Position:  0.005926601699232734
Bond Position:  [8.2664788]


portfolio before change:  [8.86708639]
curr_Stock_Price:  101.25379597506588
curr_Factors:  [101.25379598]
mat_Sqrt:  [[0.15]]
grads:  [0.03913331]
Stock Position:  0.03913330821314162
Bond Position:  [4.90469038]


portfolio before change:  [8.84279267]
curr_Stock_Price:  100.6251685807755
curr_Factors:  [100.62516858]
mat_Sqrt:  [[0.15]]
grads:  [0.01545458]
Stock Position:  0.015454584684289696
Bond Position:  [7.28767248]


portfolio before change:  [8.82522737]
curr_Stock_Price:  99.45912001380671
curr_Factors:  [99.45912001]
mat_Sqrt:  [[0.15]]
grads:  [0.00829738]
Stock Position:  0.008297380870951934
Bond Position:  [7.99997717]


portfolio before change:  [8.82962613]
curr_Stock_Price:  99.92899670080088
curr_Factors:  [99.9289967]
mat_Sqrt:  [[0.15]]
grads:  [0.08076357]
Stock Position:  0.08076357235533776
Bond Position:  [0.75900337]


portfolio before change:  [8.88105539]
curr_Stock_Price:  100.56519719310876
curr_Factors:  [100.56519719]
mat_Sqrt:  [[0.15]]
grads:  [0.00667707]
Stock Position:  0.0066770729398939275
Bond Position:  [8.20957423]


portfolio before change:  [8.88558692]
curr_Stock_Price:  101.1670192386356
curr_Factors:  [101.16701924]
mat_Sqrt:  [[0.15]]
grads:  [0.04839594]
Stock Position:  0.04839594365658298
Bond Position:  [3.98951355]


portfolio before change:  [8.91361363]
curr_Stock_Price:  101.74097971472312
curr_Factors:  [101.74097971]
mat_Sqrt:  [[0.15]]
grads:  [-0.05716594]
Stock Position:  -0.05716594164302164
Bond Position:  [14.72973254]


portfolio before change:  [8.94481517]
curr_Stock_Price:  101.21127781666992
curr_Factors:  [101.21127782]
mat_Sqrt:  [[0.15]]
grads:  [-0.13199314]
Stock Position:  -0.1319931386772246
Bond Position:  [22.3040094]


portfolio before change:  [8.90204996]
curr_Stock_Price:  101.54583506064644
curr_Factors:  [101.54583506]
mat_Sqrt:  [[0.15]]
grads:  [0.06708918]
Stock Position:  0.06708918068594245
Bond Position:  [2.08942308]


portfolio before change:  [8.92605514]
curr_Stock_Price:  101.90169864129923
curr_Factors:  [101.90169864]
mat_Sqrt:  [[0.15]]
grads:  [-0.06352953]
Stock Position:  -0.063529532091412
Bond Position:  [15.39982238]


portfolio before change:  [8.89568683]
curr_Stock_Price:  102.39486817289637
curr_Factors:  [102.39486817]
mat_Sqrt:  [[0.15]]
grads:  [0.16508373]
Stock Position:  0.16508373142599583
Bond Position:  [-8.00804008]


portfolio before change:  [9.04355352]
curr_Stock_Price:  103.29360728599842
curr_Factors:  [103.29360729]
mat_Sqrt:  [[0.15]]
grads:  [0.14741597]
Stock Position:  0.1474159696865938
Bond Position:  [-6.18357376]


portfolio before change:  [8.99826002]
curr_Stock_Price:  102.98897941775752
curr_Factors:  [102.98897942]
mat_Sqrt:  [[0.15]]
grads:  [-0.05201099]
Stock Position:  -0.05201099219181104
Bond Position:  [14.35481903]


portfolio before change:  [8.98682783]
curr_Stock_Price:  103.22603302639305
curr_Factors:  [103.22603303]
mat_Sqrt:  [[0.15]]
grads:  [-0.05303514]
Stock Position:  -0.05303514010250413
Bond Position:  [14.46143496]


portfolio before change:  [9.03908965]
curr_Stock_Price:  102.25765722379563
curr_Factors:  [102.25765722]
mat_Sqrt:  [[0.15]]
grads:  [0.05641933]
Stock Position:  0.05641933484798109
Bond Position:  [3.26978065]


portfolio before change:  [9.05248374]
curr_Stock_Price:  102.49143742548824
curr_Factors:  [102.49143743]
mat_Sqrt:  [[0.15]]
grads:  [0.17840872]
Stock Position:  0.1784087186679812
Bond Position:  [-9.23288229]


portfolio before change:  [8.94149864]
curr_Stock_Price:  101.87258861711463
curr_Factors:  [101.87258862]
mat_Sqrt:  [[0.15]]
grads:  [0.12188914]
Stock Position:  0.12188914339476539
Bond Position:  [-3.47566392]


portfolio before change:  [9.03424749]
curr_Stock_Price:  102.63529871741405
curr_Factors:  [102.63529872]
mat_Sqrt:  [[0.15]]
grads:  [-0.01249435]
Stock Position:  -0.012494352875309818
Bond Position:  [10.31660913]


portfolio before change:  [9.0363624]
curr_Stock_Price:  102.51763745459816
curr_Factors:  [102.51763745]
mat_Sqrt:  [[0.15]]
grads:  [0.29326555]
Stock Position:  0.2932655482352722
Bond Position:  [-21.02852875]


portfolio before change:  [8.75014675]
curr_Stock_Price:  101.54615845237925
curr_Factors:  [101.54615845]
mat_Sqrt:  [[0.15]]
grads:  [-0.08673789]
Stock Position:  -0.08673789085171751
Bond Position:  [17.55804636]


portfolio before change:  [8.69393554]
curr_Stock_Price:  102.20686877691391
curr_Factors:  [102.20686878]
mat_Sqrt:  [[0.15]]
grads:  [0.05873093]
Stock Position:  0.0587309268031562
Bond Position:  [2.69123142]


portfolio before change:  [8.70123536]
curr_Stock_Price:  102.3282972035231
curr_Factors:  [102.3282972]
mat_Sqrt:  [[0.15]]
grads:  [-0.02590217]
Stock Position:  -0.025902174503814632
Bond Position:  [11.35176077]


portfolio before change:  [8.68892852]
curr_Stock_Price:  102.8308165031499
curr_Factors:  [102.8308165]
mat_Sqrt:  [[0.15]]
grads:  [0.1181451]
Stock Position:  0.11814509889007459
Bond Position:  [-3.46002846]


portfolio before change:  [8.63493858]
curr_Stock_Price:  102.37566702538506
curr_Factors:  [102.37566703]
mat_Sqrt:  [[0.15]]
grads:  [0.12213212]
Stock Position:  0.12213211871119248
Bond Position:  [-3.86841854]


portfolio before change:  [8.70297086]
curr_Stock_Price:  102.93468511775473
curr_Factors:  [102.93468512]
mat_Sqrt:  [[0.15]]
grads:  [0.06349063]
Stock Position:  0.06349063036218963
Bond Position:  [2.16758282]


portfolio before change:  [8.73885438]
curr_Stock_Price:  103.49772938758117
curr_Factors:  [103.49772939]
mat_Sqrt:  [[0.15]]
grads:  [-0.00619319]
Stock Position:  -0.006193185680950022
Bond Position:  [9.37983503]


portfolio before change:  [8.73773195]
curr_Stock_Price:  103.77362663124367
curr_Factors:  [103.77362663]
mat_Sqrt:  [[0.15]]
grads:  [0.05229922]
Stock Position:  0.052299215338693986
Bond Position:  [3.31045271]


portfolio before change:  [8.70008309]
curr_Stock_Price:  103.04979607845053
curr_Factors:  [103.04979608]
mat_Sqrt:  [[0.15]]
grads:  [-0.07731016]
Stock Position:  -0.0773101595412704
Bond Position:  [16.66687927]


portfolio before change:  [8.7673083]
curr_Stock_Price:  102.19371851723793
curr_Factors:  [102.19371852]
mat_Sqrt:  [[0.15]]
grads:  [-0.03776247]
Stock Position:  -0.03776246575383922
Bond Position:  [12.62639509]


portfolio before change:  [8.74147989]
curr_Stock_Price:  102.89858721039172
curr_Factors:  [102.89858721]
mat_Sqrt:  [[0.15]]
grads:  [0.24855137]
Stock Position:  0.2485513730513042
Bond Position:  [-16.83410525]


portfolio before change:  [9.12638673]
curr_Stock_Price:  104.45142114018196
curr_Factors:  [104.45142114]
mat_Sqrt:  [[0.15]]
grads:  [0.02619186]
Stock Position:  0.026191864326256652
Bond Position:  [6.39060928]


portfolio before change:  [9.12524272]
curr_Stock_Price:  104.39249294153068
curr_Factors:  [104.39249294]
mat_Sqrt:  [[0.15]]
grads:  [-0.0500108]
Stock Position:  -0.05001080289029143
Bond Position:  [14.34599511]


portfolio before change:  [9.19609001]
curr_Stock_Price:  102.99378235054866
curr_Factors:  [102.99378235]
mat_Sqrt:  [[0.15]]
grads:  [-0.03789783]
Stock Position:  -0.03789782881562455
Bond Position:  [13.09933074]


portfolio before change:  [9.18244501]
curr_Stock_Price:  103.37543300498903
curr_Factors:  [103.375433]
mat_Sqrt:  [[0.15]]
grads:  [-0.02691332]
Stock Position:  -0.026913319715850415
Bond Position:  [11.96462109]


portfolio before change:  [9.15541458]
curr_Stock_Price:  104.40757039925883
curr_Factors:  [104.4075704]
mat_Sqrt:  [[0.15]]
grads:  [-0.02178132]
Stock Position:  -0.021781320405679008
Bond Position:  [11.42954932]


portfolio before change:  [9.15319284]
curr_Stock_Price:  104.54236986414814
curr_Factors:  [104.54236986]
mat_Sqrt:  [[0.15]]
grads:  [-0.0002797]
Stock Position:  -0.00027970077218629485
Bond Position:  [9.18243342]


portfolio before change:  [9.15367975]
curr_Stock_Price:  104.85344285086593
curr_Factors:  [104.85344285]
mat_Sqrt:  [[0.15]]
grads:  [0.03754632]
Stock Position:  0.03754632415680747
Bond Position:  [5.2168184]


portfolio before change:  [9.12444109]
curr_Stock_Price:  104.0660228020803
curr_Factors:  [104.0660228]
mat_Sqrt:  [[0.15]]
grads:  [-0.04849767]
Stock Position:  -0.04849767448647464
Bond Position:  [14.17140118]


portfolio before change:  [9.15975087]
curr_Stock_Price:  103.35621464201164
curr_Factors:  [103.35621464]
mat_Sqrt:  [[0.15]]
grads:  [-0.26611848]
Stock Position:  -0.26611848295119045
Bond Position:  [36.66474992]


portfolio before change:  [9.13862342]
curr_Stock_Price:  103.44421704325066
curr_Factors:  [103.44421704]
mat_Sqrt:  [[0.15]]
grads:  [-0.02159407]
Stock Position:  -0.021594065649347714
Bond Position:  [11.37240464]


portfolio before change:  [9.13389072]
curr_Stock_Price:  103.69630021836045
curr_Factors:  [103.69630022]
mat_Sqrt:  [[0.15]]
grads:  [0.09631183]
Stock Position:  0.09631182629050608
Bond Position:  [-0.85328933]


portfolio before change:  [9.18242703]
curr_Stock_Price:  104.20080363215992
curr_Factors:  [104.20080363]
mat_Sqrt:  [[0.15]]
grads:  [-0.09294266]
Stock Position:  -0.09294265597125376
Bond Position:  [18.86712648]


portfolio before change:  [9.2693726]
curr_Stock_Price:  103.2780159865409
curr_Factors:  [103.27801599]
mat_Sqrt:  [[0.15]]
grads:  [-0.0077942]
Stock Position:  -0.007794199601677465
Bond Position:  [10.07434207]


portfolio before change:  [9.26533285]
curr_Stock_Price:  103.8771040565434
curr_Factors:  [103.87710406]
mat_Sqrt:  [[0.15]]
grads:  [0.01706499]
Stock Position:  0.017064987260457787
Bond Position:  [7.4926714]


portfolio before change:  [9.25753676]
curr_Stock_Price:  103.39281431013099
curr_Factors:  [103.39281431]
mat_Sqrt:  [[0.15]]
grads:  [-0.09082362]
Stock Position:  -0.09082362273927949
Bond Position:  [18.64804672]


portfolio before change:  [9.1937463]
curr_Stock_Price:  104.1080027161368
curr_Factors:  [104.10800272]
mat_Sqrt:  [[0.15]]
grads:  [0.06271537]
Stock Position:  0.06271536957171968
Bond Position:  [2.66457443]


portfolio before change:  [9.215315]
curr_Stock_Price:  104.44926125020382
curr_Factors:  [104.44926125]
mat_Sqrt:  [[0.15]]
grads:  [0.11399345]
Stock Position:  0.1139934458321461
Bond Position:  [-2.69121621]


portfolio before change:  [9.29338224]
curr_Stock_Price:  105.13557654954758
curr_Factors:  [105.13557655]
mat_Sqrt:  [[0.15]]
grads:  [-0.08181902]
Stock Position:  -0.08181901580269954
Bond Position:  [17.89547164]


portfolio before change:  [9.29346542]
curr_Stock_Price:  105.14823032825247
curr_Factors:  [105.14823033]
mat_Sqrt:  [[0.15]]
grads:  [-0.02883027]
Stock Position:  -0.02883026873461961
Bond Position:  [12.32491716]


portfolio before change:  [9.28854223]
curr_Stock_Price:  105.34571455953392
curr_Factors:  [105.34571456]
mat_Sqrt:  [[0.15]]
grads:  [0.02386199]
Stock Position:  0.023861988803958793
Bond Position:  [6.77478397]


portfolio before change:  [9.27383132]
curr_Stock_Price:  104.71146960221326
curr_Factors:  [104.7114696]
mat_Sqrt:  [[0.15]]
grads:  [0.01976879]
Stock Position:  0.019768792686059664
Bond Position:  [7.20381198]


portfolio before change:  [9.28773393]
curr_Stock_Price:  105.3919543166813
curr_Factors:  [105.39195432]
mat_Sqrt:  [[0.15]]
grads:  [-0.02188178]
Stock Position:  -0.02188178103052751
Bond Position:  [11.5938976]


portfolio before change:  [9.29753738]
curr_Stock_Price:  104.97705150554235
curr_Factors:  [104.97705151]
mat_Sqrt:  [[0.15]]
grads:  [-0.06022457]
Stock Position:  -0.060224569660299994
Bond Position:  [15.61973514]


portfolio before change:  [9.23122317]
curr_Stock_Price:  106.09437753394417
curr_Factors:  [106.09437753]
mat_Sqrt:  [[0.15]]
grads:  [0.08245943]
Stock Position:  0.08245942516286504
Bond Position:  [0.48274179]


portfolio before change:  [9.21703308]
curr_Stock_Price:  105.92192589258285
curr_Factors:  [105.92192589]
mat_Sqrt:  [[0.15]]
grads:  [-0.19303022]
Stock Position:  -0.19303022103511033
Bond Position:  [29.66316585]


portfolio before change:  [9.3110715]
curr_Stock_Price:  105.4443612033439
curr_Factors:  [105.4443612]
mat_Sqrt:  [[0.15]]
grads:  [-0.05982167]
Stock Position:  -0.05982167164766176
Bond Position:  [15.61892945]


portfolio before change:  [9.30868596]
curr_Stock_Price:  105.50055740349764
curr_Factors:  [105.5005574]
mat_Sqrt:  [[0.15]]
grads:  [0.12524683]
Stock Position:  0.12524682969604575
Bond Position:  [-3.90492438]


portfolio before change:  [9.34211231]
curr_Stock_Price:  105.76938986648871
curr_Factors:  [105.76938987]
mat_Sqrt:  [[0.15]]
grads:  [-0.04042936]
Stock Position:  -0.0404293562047878
Bond Position:  [13.61830065]


portfolio before change:  [9.32539819]
curr_Stock_Price:  106.20385864144437
curr_Factors:  [106.20385864]
mat_Sqrt:  [[0.15]]
grads:  [0.08768598]
Stock Position:  0.08768597549430816
Bond Position:  [0.01280924]


portfolio before change:  [9.33200562]
curr_Stock_Price:  106.27920279486705
curr_Factors:  [106.27920279]
mat_Sqrt:  [[0.15]]
grads:  [-0.09265307]
Stock Position:  -0.0926530726693945
Bond Position:  [19.17910032]


portfolio before change:  [9.29746041]
curr_Stock_Price:  106.66498537900976
curr_Factors:  [106.66498538]
mat_Sqrt:  [[0.15]]
grads:  [-0.08460835]
Stock Position:  -0.08460834507153597
Bond Position:  [18.3222083]


portfolio before change:  [9.28550851]
curr_Stock_Price:  106.81978185287791
curr_Factors:  [106.81978185]
mat_Sqrt:  [[0.15]]
grads:  [-0.01799771]
Stock Position:  -0.01799770518078057
Bond Position:  [11.20801945]


portfolio before change:  [9.29718856]
curr_Stock_Price:  106.20973035289678
curr_Factors:  [106.20973035]
mat_Sqrt:  [[0.15]]
grads:  [0.57031495]
Stock Position:  0.5703149467683575
Bond Position:  [-51.27580816]


portfolio before change:  [9.79386039]
curr_Stock_Price:  107.08622267750201
curr_Factors:  [107.08622268]
mat_Sqrt:  [[0.15]]
grads:  [-0.09038986]
Stock Position:  -0.09038986121784007
Bond Position:  [19.4733692]


portfolio before change:  [9.78600051]
curr_Stock_Price:  107.18664324306341
curr_Factors:  [107.18664324]
mat_Sqrt:  [[0.15]]
grads:  [0.02617259]
Stock Position:  0.026172586339877207
Bond Position:  [6.98064884]


portfolio before change:  [9.78440463]
curr_Stock_Price:  107.10899734845256
curr_Factors:  [107.10899735]
mat_Sqrt:  [[0.15]]
grads:  [0.04126061]
Stock Position:  0.04126060833000006
Bond Position:  [5.36502224]


portfolio before change:  [9.75766678]
curr_Stock_Price:  106.45284687659004
curr_Factors:  [106.45284688]
mat_Sqrt:  [[0.15]]
grads:  [0.09257359]
Stock Position:  0.09257358593447362
Bond Position:  [-0.09705499]


portfolio before change:  [9.80607879]
curr_Stock_Price:  106.97586943880749
curr_Factors:  [106.97586944]
mat_Sqrt:  [[0.15]]
grads:  [-0.19070099]
Stock Position:  -0.19070098761804039
Bond Position:  [30.20648274]


portfolio before change:  [9.75676144]
curr_Stock_Price:  107.24438042947426
curr_Factors:  [107.24438043]
mat_Sqrt:  [[0.15]]
grads:  [-0.05211359]
Stock Position:  -0.0521135919888015
Bond Position:  [15.34565133]


portfolio before change:  [9.80559762]
curr_Stock_Price:  106.32567485484736
curr_Factors:  [106.32567485]
mat_Sqrt:  [[0.15]]
grads:  [-0.03794847]
Stock Position:  -0.037948474168188556
Bond Position:  [13.84049475]


portfolio before change:  [9.81384758]
curr_Stock_Price:  106.13107152139618
curr_Factors:  [106.13107152]
mat_Sqrt:  [[0.15]]
grads:  [0.07340365]
Stock Position:  0.07340365357942913
Bond Position:  [2.02343917]


portfolio before change:  [9.81214201]
curr_Stock_Price:  106.10611314363722
curr_Factors:  [106.10611314]
mat_Sqrt:  [[0.15]]
grads:  [0.03682266]
Stock Position:  0.03682265608677593
Bond Position:  [5.9050331]


portfolio before change:  [9.82972888]
curr_Stock_Price:  106.57370009968852
curr_Factors:  [106.5737001]
mat_Sqrt:  [[0.15]]
grads:  [-0.00992411]
Stock Position:  -0.00992410851746569
Bond Position:  [10.88737785]


portfolio before change:  [9.8281622]
curr_Stock_Price:  106.8001350902877
curr_Factors:  [106.80013509]
mat_Sqrt:  [[0.15]]
grads:  [0.02042791]
Stock Position:  0.02042791101269376
Bond Position:  [7.64645854]


portfolio before change:  [9.82810075]
curr_Stock_Price:  106.77373163401184
curr_Factors:  [106.77373163]
mat_Sqrt:  [[0.15]]
grads:  [0.03670543]
Stock Position:  0.036705433349413424
Bond Position:  [5.90892466]


portfolio before change:  [9.79108107]
curr_Stock_Price:  105.7551085394786
curr_Factors:  [105.75510854]
mat_Sqrt:  [[0.15]]
grads:  [-0.02151754]
Stock Position:  -0.02151754379342617
Bond Position:  [12.06667125]


portfolio before change:  [9.79825924]
curr_Stock_Price:  105.456562512174
curr_Factors:  [105.45656251]
mat_Sqrt:  [[0.15]]
grads:  [0.15162589]
Stock Position:  0.15162588854617523
Bond Position:  [-6.19168576]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.79825924]
Stock Price:  104.37516702933723
PL:  [5.42309221]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.47759584e-02]
 [ 2.75662306e-03]
 [-5.33202188e-04]
 [ 2.13777860e-03]
 [ 7.97626730e-03]
 [ 1.20022764e-02]
 [ 5.60833610e-04]
 [-1.28510771e-02]
 [ 3.44450325e-03]
 [ 2.96623381e-02]
 [ 7.04826471e-03]
 [-8.18297377e-03]
 [ 4.32668464e-03]
 [ 5.76022254e-03]
 [-8.27120563e-03]
 [ 1.40097700e-02]
 [-4.72967127e-04]
 [ 8.50632110e-03]
 [ 2.21873425e-02]
 [ 5.51019659e-03]
 [ 3.80251454e-02]
 [-1.80288331e-02]
 [-9.50701634e-04]
 [ 1.14863032e-02]
 [ 3.31164706e-05]
 [ 1.63609786e-02]
 [ 1.40659511e-02]
 [-4.90111744e-03]
 [ 6.95172752e-04]
 [ 3.44740323e-03]
 [-3.42953239e-03]
 [-4.54038509e-02]
 [ 2.19704768e-02]
 [ 1.15405963e-02]
 [-3.43252447e-02]
 [ 8.35408680e-03]
 [-4.19193557e-04]
 [-8.26431896e-03]
 [ 7.96753088e-03]
 [-2.00912988e-02]
 [ 5.65499821e-02]
 [ 2.88321637e-03]
 [ 9.94113833e-03]
 [-9.45856463e-03]
 [-2.96059593e-03]
 [-1.65742904e-02]
 [-1.31073476e-02]
 [ 4.12656709e-04]
 [-3.03185969e-03]
 [ 1.79179501e-03]
 [-3.76799766e-03]
 [ 2.88792048e-03]
 [ 3.56288589e-03]
 [ 1.61549345e-03]
 [ 3.73741634e-03]
 [ 8.96964035e-03]
 [ 1.37818688e-02]
 [-9.89765928e-03]
 [ 1.38997323e-02]
 [ 4.47164849e-03]
 [ 5.24685598e-03]
 [-1.42465157e-02]
 [-1.26197920e-02]
 [-1.39705513e-03]
 [-1.11502539e-02]
 [-1.72251701e-02]
 [ 9.53612920e-03]
 [ 2.07847785e-03]
 [ 1.12258094e-02]
 [-1.81925812e-02]
 [ 5.33045366e-03]
 [-1.37488360e-03]
 [-2.35538763e-03]
 [ 7.68866496e-03]
 [-6.56418234e-04]
 [ 2.78892552e-03]
 [ 4.51014033e-03]
 [-1.17424379e-02]
 [-3.12971309e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.46458953]
curr_Stock_Price:  99.77305792530699
curr_Factors:  [99.77305793]
mat_Sqrt:  [[0.15]]
grads:  [-0.23183972]
Stock Position:  -0.23183972248579138
Bond Position:  [21.66676853]


portfolio before change:  [-1.37357204]
curr_Stock_Price:  99.38631109866596
curr_Factors:  [99.3863111]
mat_Sqrt:  [[0.15]]
grads:  [0.01837749]
Stock Position:  0.018377487085098503
Bond Position:  [-3.20004269]


portfolio before change:  [-1.37591211]
curr_Stock_Price:  99.26986101199255
curr_Factors:  [99.26986101]
mat_Sqrt:  [[0.15]]
grads:  [-0.00355468]
Stock Position:  -0.0035546812551805573
Bond Position:  [-1.02303939]


portfolio before change:  [-1.3780773]
curr_Stock_Price:  99.86098256847555
curr_Factors:  [99.86098257]
mat_Sqrt:  [[0.15]]
grads:  [0.01425186]
Stock Position:  0.014251857337233085
Bond Position:  [-2.80128177]


portfolio before change:  [-1.38202764]
curr_Stock_Price:  99.59608640056776
curr_Factors:  [99.5960864]
mat_Sqrt:  [[0.15]]
grads:  [0.05317512]
Stock Position:  0.0531751153468819
Bond Position:  [-6.67806103]


portfolio before change:  [-1.37274197]
curr_Stock_Price:  99.77856031658652
curr_Factors:  [99.77856032]
mat_Sqrt:  [[0.15]]
grads:  [0.08001518]
Stock Position:  0.08001517619945585
Bond Position:  [-9.35654105]


portfolio before change:  [-1.40625672]
curr_Stock_Price:  99.36701400195362
curr_Factors:  [99.367014]
mat_Sqrt:  [[0.15]]
grads:  [0.00373889]
Stock Position:  0.003738890734321933
Bond Position:  [-1.77777913]


portfolio before change:  [-1.41415616]
curr_Stock_Price:  97.2839570994721
curr_Factors:  [97.2839571]
mat_Sqrt:  [[0.15]]
grads:  [-0.08567385]
Stock Position:  -0.08567384709132375
Bond Position:  [6.92053471]


portfolio before change:  [-1.44455233]
curr_Stock_Price:  97.64379532003589
curr_Factors:  [97.64379532]
mat_Sqrt:  [[0.15]]
grads:  [0.02296335]
Stock Position:  0.022963354984747487
Bond Position:  [-3.68678147]


portfolio before change:  [-1.44837074]
curr_Stock_Price:  97.48754742905712
curr_Factors:  [97.48754743]
mat_Sqrt:  [[0.15]]
grads:  [0.19774892]
Stock Position:  0.19774892080859924
Bond Position:  [-20.72642804]


portfolio before change:  [-1.27087913]
curr_Stock_Price:  98.39165880144103
curr_Factors:  [98.3916588]
mat_Sqrt:  [[0.15]]
grads:  [0.04698843]
Stock Position:  0.04698843139880606
Bond Position:  [-5.89414884]


portfolio before change:  [-1.27820272]
curr_Stock_Price:  98.24363953453395
curr_Factors:  [98.24363953]
mat_Sqrt:  [[0.15]]
grads:  [-0.05455316]
Stock Position:  -0.054553158446365414
Bond Position:  [4.08129811]


portfolio before change:  [-1.25584893]
curr_Stock_Price:  97.83855389127838
curr_Factors:  [97.83855389]
mat_Sqrt:  [[0.15]]
grads:  [0.02884456]
Stock Position:  0.0288445642417765
Bond Position:  [-4.07795939]


portfolio before change:  [-1.26122233]
curr_Stock_Price:  97.66110211463399
curr_Factors:  [97.66110211]
mat_Sqrt:  [[0.15]]
grads:  [0.03840148]
Stock Position:  0.038401483595900295
Bond Position:  [-5.01155354]


portfolio before change:  [-1.22806557]
curr_Stock_Price:  98.53268289766187
curr_Factors:  [98.5326829]
mat_Sqrt:  [[0.15]]
grads:  [-0.05514137]
Stock Position:  -0.05514137084627384
Bond Position:  [4.20516164]


portfolio before change:  [-1.23446816]
curr_Stock_Price:  98.65356170948475
curr_Factors:  [98.65356171]
mat_Sqrt:  [[0.15]]
grads:  [0.09339847]
Stock Position:  0.09339846644379267
Bond Position:  [-10.44855953]


portfolio before change:  [-1.19646422]
curr_Stock_Price:  99.06745502108927
curr_Factors:  [99.06745502]
mat_Sqrt:  [[0.15]]
grads:  [-0.00315311]
Stock Position:  -0.003153114177138794
Bond Position:  [-0.88409322]


portfolio before change:  [-1.19843873]
curr_Stock_Price:  99.67614239800768
curr_Factors:  [99.6761424]
mat_Sqrt:  [[0.15]]
grads:  [0.05670881]
Stock Position:  0.056708807314007084
Bond Position:  [-6.85095389]


portfolio before change:  [-1.21204418]
curr_Stock_Price:  99.44377545987918
curr_Factors:  [99.44377546]
mat_Sqrt:  [[0.15]]
grads:  [0.14791562]
Stock Position:  0.14791561689477864
Bond Position:  [-15.92133158]


portfolio before change:  [-1.11384482]
curr_Stock_Price:  100.11439077819405
curr_Factors:  [100.11439078]
mat_Sqrt:  [[0.15]]
grads:  [0.03673464]
Stock Position:  0.03673464390681217
Bond Position:  [-4.79151132]


portfolio before change:  [-1.16484271]
curr_Stock_Price:  98.7342656151107
curr_Factors:  [98.73426562]
mat_Sqrt:  [[0.15]]
grads:  [0.25350097]
Stock Position:  0.25350096921591203
Bond Position:  [-26.19407473]


portfolio before change:  [-1.13643852]
curr_Stock_Price:  98.85277152844081
curr_Factors:  [98.85277153]
mat_Sqrt:  [[0.15]]
grads:  [-0.12019222]
Stock Position:  -0.12019222097386015
Bond Position:  [10.74489564]


portfolio before change:  [-1.06559167]
curr_Stock_Price:  98.2689128076505
curr_Factors:  [98.26891281]
mat_Sqrt:  [[0.15]]
grads:  [-0.00633801]
Stock Position:  -0.0063380108941142425
Bond Position:  [-0.44276223]


portfolio before change:  [-1.06670559]
curr_Stock_Price:  98.44029844222808
curr_Factors:  [98.44029844]
mat_Sqrt:  [[0.15]]
grads:  [0.07657535]
Stock Position:  0.07657535476863861
Bond Position:  [-8.60480636]


portfolio before change:  [-1.12093612]
curr_Stock_Price:  97.73912361016609
curr_Factors:  [97.73912361]
mat_Sqrt:  [[0.15]]
grads:  [0.00022078]
Stock Position:  0.00022077647033623995
Bond Position:  [-1.14251461]


portfolio before change:  [-1.12112061]
curr_Stock_Price:  97.22689070715859
curr_Factors:  [97.22689071]
mat_Sqrt:  [[0.15]]
grads:  [0.10907319]
Stock Position:  0.10907319070388724
Bond Position:  [-11.72596781]


portfolio before change:  [-1.0367485]
curr_Stock_Price:  98.00714666231771
curr_Factors:  [98.00714666]
mat_Sqrt:  [[0.15]]
grads:  [0.09377301]
Stock Position:  0.09377300744398491
Bond Position:  [-10.2271734]


portfolio before change:  [-1.10408826]
curr_Stock_Price:  97.29584884445705
curr_Factors:  [97.29584884]
mat_Sqrt:  [[0.15]]
grads:  [-0.03267412]
Stock Position:  -0.03267411628276852
Bond Position:  [2.07496762]


portfolio before change:  [-1.09320528]
curr_Stock_Price:  96.96674175701041
curr_Factors:  [96.96674176]
mat_Sqrt:  [[0.15]]
grads:  [0.00463449]
Stock Position:  0.00463448501201168
Bond Position:  [-1.5425962]


portfolio before change:  [-1.09480995]
curr_Stock_Price:  96.64130059048239
curr_Factors:  [96.64130059]
mat_Sqrt:  [[0.15]]
grads:  [0.02298269]
Stock Position:  0.022982688199699605
Bond Position:  [-3.31588683]


portfolio before change:  [-1.10370129]
curr_Stock_Price:  96.26344706829171
curr_Factors:  [96.26344707]
mat_Sqrt:  [[0.15]]
grads:  [-0.02286355]
Stock Position:  -0.022863549261165832
Bond Position:  [1.09722277]


portfolio before change:  [-1.08585201]
curr_Stock_Price:  95.48575936307286
curr_Factors:  [95.48575936]
mat_Sqrt:  [[0.15]]
grads:  [-0.30269234]
Stock Position:  -0.3026923395664038
Bond Position:  [27.81695589]


portfolio before change:  [-1.26640675]
curr_Stock_Price:  96.08799908862504
curr_Factors:  [96.08799909]
mat_Sqrt:  [[0.15]]
grads:  [0.14646985]
Stock Position:  0.1464698450009632
Bond Position:  [-15.34040108]


portfolio before change:  [-1.32855229]
curr_Stock_Price:  95.67025619006333
curr_Factors:  [95.67025619]
mat_Sqrt:  [[0.15]]
grads:  [0.07693731]
Stock Position:  0.07693730847526388
Bond Position:  [-8.6891643]


portfolio before change:  [-1.33511405]
curr_Stock_Price:  95.59202790723735
curr_Factors:  [95.59202791]
mat_Sqrt:  [[0.15]]
grads:  [-0.22883496]
Stock Position:  -0.22883496499992162
Bond Position:  [20.53968431]


portfolio before change:  [-1.39752901]
curr_Stock_Price:  95.87038889180009
curr_Factors:  [95.87038889]
mat_Sqrt:  [[0.15]]
grads:  [0.05569391]
Stock Position:  0.05569391202539115
Bond Position:  [-6.73692601]


portfolio before change:  [-1.409825]
curr_Stock_Price:  95.65717128826623
curr_Factors:  [95.65717129]
mat_Sqrt:  [[0.15]]
grads:  [-0.00279462]
Stock Position:  -0.0027946237159098717
Bond Position:  [-1.1424992]


portfolio before change:  [-1.41002993]
curr_Stock_Price:  95.70494884202215
curr_Factors:  [95.70494884]
mat_Sqrt:  [[0.15]]
grads:  [-0.05509546]
Stock Position:  -0.055095459753768374
Bond Position:  [3.86287823]


portfolio before change:  [-1.40007587]
curr_Stock_Price:  95.52866170507252
curr_Factors:  [95.52866171]
mat_Sqrt:  [[0.15]]
grads:  [0.05311687]
Stock Position:  0.05311687250966472
Bond Position:  [-6.47425962]


portfolio before change:  [-1.42451215]
curr_Stock_Price:  95.07623248455681
curr_Factors:  [95.07623248]
mat_Sqrt:  [[0.15]]
grads:  [-0.13394199]
Stock Position:  -0.13394199189439998
Bond Position:  [11.31018781]


portfolio before change:  [-1.35123311]
curr_Stock_Price:  94.53441486851256
curr_Factors:  [94.53441487]
mat_Sqrt:  [[0.15]]
grads:  [0.37699988]
Stock Position:  0.3769998806277932
Bond Position:  [-36.99069623]


portfolio before change:  [-1.1768322]
curr_Stock_Price:  95.0031495152782
curr_Factors:  [95.00314952]
mat_Sqrt:  [[0.15]]
grads:  [0.01922144]
Stock Position:  0.01922144248657804
Bond Position:  [-3.00292977]


portfolio before change:  [-1.17543122]
curr_Stock_Price:  95.08580043758394
curr_Factors:  [95.08580044]
mat_Sqrt:  [[0.15]]
grads:  [0.06627426]
Stock Position:  0.06627425555354921
Bond Position:  [-7.47717186]


portfolio before change:  [-1.15298216]
curr_Stock_Price:  95.43158162116903
curr_Factors:  [95.43158162]
mat_Sqrt:  [[0.15]]
grads:  [-0.0630571]
Stock Position:  -0.06305709754942239
Bond Position:  [4.86465639]


portfolio before change:  [-1.13747659]
curr_Stock_Price:  95.19050602673788
curr_Factors:  [95.19050603]
mat_Sqrt:  [[0.15]]
grads:  [-0.01973731]
Stock Position:  -0.019737306207347267
Bond Position:  [0.74132758]


portfolio before change:  [-1.1312531]
curr_Stock_Price:  94.87753790191714
curr_Factors:  [94.8775379]
mat_Sqrt:  [[0.15]]
grads:  [-0.11049527]
Stock Position:  -0.11049526928441382
Bond Position:  [9.35226599]


portfolio before change:  [-1.1218854]
curr_Stock_Price:  94.79804879606964
curr_Factors:  [94.7980488]
mat_Sqrt:  [[0.15]]
grads:  [-0.08738232]
Stock Position:  -0.08738231746178401
Bond Position:  [7.1617878]


portfolio before change:  [-1.24553569]
curr_Stock_Price:  96.21822079159065
curr_Factors:  [96.21822079]
mat_Sqrt:  [[0.15]]
grads:  [0.00275104]
Stock Position:  0.0027510447287647176
Bond Position:  [-1.51023632]


portfolio before change:  [-1.24345539]
curr_Stock_Price:  97.00872108034332
curr_Factors:  [97.00872108]
mat_Sqrt:  [[0.15]]
grads:  [-0.0202124]
Stock Position:  -0.02021239791579037
Bond Position:  [0.71732349]


portfolio before change:  [-1.24574742]
curr_Stock_Price:  97.12433663109356
curr_Factors:  [97.12433663]
mat_Sqrt:  [[0.15]]
grads:  [0.0119453]
Stock Position:  0.011945300046039647
Bond Position:  [-2.40592676]


portfolio before change:  [-1.25156326]
curr_Stock_Price:  96.65005222077475
curr_Factors:  [96.65005222]
mat_Sqrt:  [[0.15]]
grads:  [-0.02511998]
Stock Position:  -0.025119984410981955
Bond Position:  [1.17628454]


portfolio before change:  [-1.23803044]
curr_Stock_Price:  96.11425140449883
curr_Factors:  [96.1142514]
mat_Sqrt:  [[0.15]]
grads:  [0.0192528]
Stock Position:  0.019252803214987436
Bond Position:  [-3.0884992]


portfolio before change:  [-1.23435457]
curr_Stock_Price:  96.31520421766132
curr_Factors:  [96.31520422]
mat_Sqrt:  [[0.15]]
grads:  [0.02375257]
Stock Position:  0.02375257257010689
Bond Position:  [-3.52208845]


portfolio before change:  [-1.2108603]
curr_Stock_Price:  97.31359737719752
curr_Factors:  [97.31359738]
mat_Sqrt:  [[0.15]]
grads:  [0.01076996]
Stock Position:  0.010769956306135763
Bond Position:  [-2.25892349]


portfolio before change:  [-1.20887758]
curr_Stock_Price:  97.51080407593952
curr_Factors:  [97.51080408]
mat_Sqrt:  [[0.15]]
grads:  [0.02491611]
Stock Position:  0.024916108906330836
Bond Position:  [-3.63846739]


portfolio before change:  [-1.19741067]
curr_Stock_Price:  97.98015190652852
curr_Factors:  [97.98015191]
mat_Sqrt:  [[0.15]]
grads:  [0.0597976]
Stock Position:  0.059797602353694225
Bond Position:  [-7.05638883]


portfolio before change:  [-1.19542794]
curr_Stock_Price:  98.02068470955666
curr_Factors:  [98.02068471]
mat_Sqrt:  [[0.15]]
grads:  [0.09187913]
Stock Position:  0.09187912556297201
Bond Position:  [-10.20148274]


portfolio before change:  [-1.18866024]
curr_Stock_Price:  98.10128315386588
curr_Factors:  [98.10128315]
mat_Sqrt:  [[0.15]]
grads:  [-0.0659844]
Stock Position:  -0.06598439516947974
Bond Position:  [5.28449359]


portfolio before change:  [-1.23782102]
curr_Stock_Price:  98.85132527950888
curr_Factors:  [98.85132528]
mat_Sqrt:  [[0.15]]
grads:  [0.09266488]
Stock Position:  0.09266488217693511
Bond Position:  [-10.39786743]


portfolio before change:  [-1.226539]
curr_Stock_Price:  98.98008943857025
curr_Factors:  [98.98008944]
mat_Sqrt:  [[0.15]]
grads:  [0.02981099]
Stock Position:  0.02981098991064371
Bond Position:  [-4.17723344]


portfolio before change:  [-1.22343791]
curr_Stock_Price:  99.0928724328063
curr_Factors:  [99.09287243]
mat_Sqrt:  [[0.15]]
grads:  [0.03497904]
Stock Position:  0.03497903989045087
Bond Position:  [-4.68961145]


portfolio before change:  [-1.24076374]
curr_Stock_Price:  98.60593162640772
curr_Factors:  [98.60593163]
mat_Sqrt:  [[0.15]]
grads:  [-0.09497677]
Stock Position:  -0.09497677114191247
Bond Position:  [8.12450926]


portfolio before change:  [-1.22924588]
curr_Stock_Price:  98.49000790199737
curr_Factors:  [98.4900079]
mat_Sqrt:  [[0.15]]
grads:  [-0.08413195]
Stock Position:  -0.08413194684978315
Bond Position:  [7.05691023]


portfolio before change:  [-1.2508368]
curr_Stock_Price:  98.75188212084554
curr_Factors:  [98.75188212]
mat_Sqrt:  [[0.15]]
grads:  [-0.0093137]
Stock Position:  -0.009313700866563343
Bond Position:  [-0.33109131]


portfolio before change:  [-1.24621057]
curr_Stock_Price:  98.25294801781263
curr_Factors:  [98.25294802]
mat_Sqrt:  [[0.15]]
grads:  [-0.07433503]
Stock Position:  -0.07433502624376134
Bond Position:  [6.0574249]


portfolio before change:  [-1.20684548]
curr_Stock_Price:  97.72847809635489
curr_Factors:  [97.7284781]
mat_Sqrt:  [[0.15]]
grads:  [-0.11483447]
Stock Position:  -0.11483446737301585
Bond Position:  [10.01575225]


portfolio before change:  [-1.11273021]
curr_Stock_Price:  96.91435604175506
curr_Factors:  [96.91435604]
mat_Sqrt:  [[0.15]]
grads:  [0.06357419]
Stock Position:  0.06357419467370086
Bond Position:  [-7.27398234]


portfolio before change:  [-1.10700681]
curr_Stock_Price:  97.01153443025294
curr_Factors:  [97.01153443]
mat_Sqrt:  [[0.15]]
grads:  [0.01385652]
Stock Position:  0.013856518984115494
Bond Position:  [-2.45124898]


portfolio before change:  [-1.10357694]
curr_Stock_Price:  97.270118736861
curr_Factors:  [97.27011874]
mat_Sqrt:  [[0.15]]
grads:  [0.07483873]
Stock Position:  0.0748387293229966
Bond Position:  [-8.38314902]


portfolio before change:  [-1.14681017]
curr_Stock_Price:  96.69943469530737
curr_Factors:  [96.6994347]
mat_Sqrt:  [[0.15]]
grads:  [-0.12128387]
Stock Position:  -0.12128387438549575
Bond Position:  [10.58127192]


portfolio before change:  [-1.21468175]
curr_Stock_Price:  97.26449691571094
curr_Factors:  [97.26449692]
mat_Sqrt:  [[0.15]]
grads:  [0.03553636]
Stock Position:  0.035536357764566234
Bond Position:  [-4.67110771]


portfolio before change:  [-1.24528993]
curr_Stock_Price:  96.41139238198308
curr_Factors:  [96.41139238]
mat_Sqrt:  [[0.15]]
grads:  [-0.00916589]
Stock Position:  -0.009165890689845321
Bond Position:  [-0.36159365]


portfolio before change:  [-1.24259113]
curr_Stock_Price:  96.11448616855657
curr_Factors:  [96.11448617]
mat_Sqrt:  [[0.15]]
grads:  [-0.01570258]
Stock Position:  -0.015702584219202474
Bond Position:  [0.26665469]


portfolio before change:  [-1.24629436]
curr_Stock_Price:  96.35138343713712
curr_Factors:  [96.35138344]
mat_Sqrt:  [[0.15]]
grads:  [0.05125777]
Stock Position:  0.05125776639578662
Bond Position:  [-6.18505106]


portfolio before change:  [-1.20834471]
curr_Stock_Price:  97.09929406016886
curr_Factors:  [97.09929406]
mat_Sqrt:  [[0.15]]
grads:  [-0.00437612]
Stock Position:  -0.004376121558469342
Bond Position:  [-0.78342639]


portfolio before change:  [-1.20595087]
curr_Stock_Price:  96.54108260248225
curr_Factors:  [96.5410826]
mat_Sqrt:  [[0.15]]
grads:  [0.01859284]
Stock Position:  0.01859283682409646
Bond Position:  [-3.00092347]


portfolio before change:  [-1.20025334]
curr_Stock_Price:  96.85760747913027
curr_Factors:  [96.85760748]
mat_Sqrt:  [[0.15]]
grads:  [0.0300676]
Stock Position:  0.030067602179174927
Bond Position:  [-4.11252935]


portfolio before change:  [-1.21579623]
curr_Stock_Price:  96.34922490035879
curr_Factors:  [96.3492249]
mat_Sqrt:  [[0.15]]
grads:  [-0.07828292]
Stock Position:  -0.07828291933104187
Bond Position:  [6.32670237]


portfolio before change:  [-1.24580161]
curr_Stock_Price:  96.73757036116675
curr_Factors:  [96.73757036]
mat_Sqrt:  [[0.15]]
grads:  [-0.20864754]
Stock Position:  -0.2086475391360857
Bond Position:  [18.93825439]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.24580161]
Stock Price:  96.26049885914745
PL:  [-1.24580161]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.42040634e-02]
 [-1.65522186e-03]
 [-5.09507869e-04]
 [-7.55639940e-05]
 [-3.55388250e-03]
 [ 7.93262333e-03]
 [ 7.48796173e-04]
 [ 1.58688580e-02]
 [ 1.76085427e-02]
 [-1.89449482e-02]
 [ 6.00666010e-03]
 [-5.61034783e-03]
 [-8.24062012e-03]
 [ 4.24317983e-03]
 [ 1.42730506e-05]
 [-4.64472330e-04]
 [ 1.46546103e-02]
 [ 1.61023364e-02]
 [ 1.88158120e-02]
 [-1.51307580e-04]
 [ 6.52592442e-02]
 [-1.29654809e-02]
 [ 7.54593370e-03]
 [ 4.81568853e-03]
 [ 1.45559780e-02]
 [-3.72943108e-03]
 [ 1.33346890e-02]
 [ 4.48585345e-04]
 [ 4.88719134e-03]
 [-2.27425982e-02]
 [-5.68572799e-03]
 [ 3.34281250e-02]
 [ 7.44529420e-03]
 [-4.07838345e-03]
 [-6.50792461e-03]
 [-5.22708257e-03]
 [-2.26254288e-03]
 [ 1.84764242e-03]
 [ 3.24395435e-03]
 [-7.63620231e-03]
 [-4.11958686e-02]
 [-2.74405547e-03]
 [ 1.24587798e-02]
 [-1.15807620e-02]
 [-8.18473917e-05]
 [ 2.27935272e-03]
 [-1.36662543e-02]
 [ 2.50695733e-03]
 [ 2.98443332e-03]
 [-4.05123178e-03]
 [-3.75157296e-03]
 [ 3.44845458e-03]
 [ 2.11227618e-03]
 [ 3.76187933e-03]
 [-4.75591063e-03]
 [ 8.50973671e-03]
 [-9.85808740e-03]
 [-1.31195995e-02]
 [ 1.36912682e-02]
 [ 4.43560377e-03]
 [ 1.05960600e-02]
 [-1.42542845e-02]
 [-1.26878894e-02]
 [-3.10262030e-03]
 [-1.17717766e-03]
 [-1.72516742e-02]
 [ 1.71701743e-02]
 [ 4.49448985e-03]
 [ 1.08134483e-02]
 [-2.38436930e-02]
 [-7.97739368e-03]
 [-6.40530398e-03]
 [ 1.09820220e-02]
 [ 5.25915918e-03]
 [-1.58567492e-03]
 [ 1.43244567e-03]
 [ 6.44581239e-03]
 [-2.77131660e-03]
 [ 2.10214939e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.46414439]
curr_Stock_Price:  99.89701892623259
curr_Factors:  [99.89701893]
mat_Sqrt:  [[0.15]]
grads:  [-0.22802709]
Stock Position:  -0.22802708933867674
Bond Position:  [23.24337084]


portfolio before change:  [0.46357738]
curr_Stock_Price:  99.90587647630595
curr_Factors:  [99.90587648]
mat_Sqrt:  [[0.15]]
grads:  [-0.01103481]
Stock Position:  -0.011034812423310031
Bond Position:  [1.56601999]


portfolio before change:  [0.47050459]
curr_Stock_Price:  99.28698691258984
curr_Factors:  [99.28698691]
mat_Sqrt:  [[0.15]]
grads:  [-0.00339672]
Stock Position:  -0.003396719129759183
Bond Position:  [0.8077546]


portfolio before change:  [0.47125153]
curr_Stock_Price:  99.08194922412967
curr_Factors:  [99.08194922]
mat_Sqrt:  [[0.15]]
grads:  [-0.00050376]
Stock Position:  -0.0005037599600160245
Bond Position:  [0.52116505]


portfolio before change:  [0.47117114]
curr_Stock_Price:  99.30619342925401
curr_Factors:  [99.30619343]
mat_Sqrt:  [[0.15]]
grads:  [-0.02369255]
Stock Position:  -0.023692550004737595
Bond Position:  [2.82398809]


portfolio before change:  [0.47953286]
curr_Stock_Price:  98.96071726030694
curr_Factors:  [98.96071726]
mat_Sqrt:  [[0.15]]
grads:  [0.05288416]
Stock Position:  0.05288415552812886
Bond Position:  [-4.75392111]


portfolio before change:  [0.50894425]
curr_Stock_Price:  99.52248338994855
curr_Factors:  [99.52248339]
mat_Sqrt:  [[0.15]]
grads:  [0.00499197]
Stock Position:  0.004991974486855156
Bond Position:  [0.01213056]


portfolio before change:  [0.50706644]
curr_Stock_Price:  99.14616569712399
curr_Factors:  [99.1461657]
mat_Sqrt:  [[0.15]]
grads:  [0.10579239]
Stock Position:  0.10579238636109115
Bond Position:  [-9.98184302]


portfolio before change:  [0.52619701]
curr_Stock_Price:  99.33289421340217
curr_Factors:  [99.33289421]
mat_Sqrt:  [[0.15]]
grads:  [0.11739028]
Stock Position:  0.11739028447730218
Bond Position:  [-11.13451969]


portfolio before change:  [0.56022575]
curr_Stock_Price:  99.62869950967703
curr_Factors:  [99.62869951]
mat_Sqrt:  [[0.15]]
grads:  [-0.12629965]
Stock Position:  -0.12629965453043768
Bond Position:  [13.14329608]


portfolio before change:  [0.65441515]
curr_Stock_Price:  98.88944245480329
curr_Factors:  [98.88944245]
mat_Sqrt:  [[0.15]]
grads:  [0.0400444]
Stock Position:  0.04004440065915165
Bond Position:  [-3.30555331]


portfolio before change:  [0.67516072]
curr_Stock_Price:  99.41266615165075
curr_Factors:  [99.41266615]
mat_Sqrt:  [[0.15]]
grads:  [-0.03740232]
Stock Position:  -0.037402318870105464
Bond Position:  [4.39342496]


portfolio before change:  [0.67418776]
curr_Stock_Price:  99.44602137621084
curr_Factors:  [99.44602138]
mat_Sqrt:  [[0.15]]
grads:  [-0.05493747]
Stock Position:  -0.05493746745865255
Bond Position:  [6.13750032]


portfolio before change:  [0.66899911]
curr_Stock_Price:  99.54745042195154
curr_Factors:  [99.54745042]
mat_Sqrt:  [[0.15]]
grads:  [0.02828787]
Stock Position:  0.028287865517507664
Bond Position:  [-2.14698578]


portfolio before change:  [0.66416203]
curr_Stock_Price:  99.3811995389382
curr_Factors:  [99.38119954]
mat_Sqrt:  [[0.15]]
grads:  [9.51536705e-05]
Stock Position:  9.515367053794059e-05
Bond Position:  [0.65470555]


portfolio before change:  [0.66427221]
curr_Stock_Price:  100.10905929050655
curr_Factors:  [100.10905929]
mat_Sqrt:  [[0.15]]
grads:  [-0.00309648]
Stock Position:  -0.003096482198353135
Bond Position:  [0.97425813]


portfolio before change:  [0.66232453]
curr_Stock_Price:  100.75772316515635
curr_Factors:  [100.75772317]
mat_Sqrt:  [[0.15]]
grads:  [0.0976974]
Stock Position:  0.0976974018556356
Bond Position:  [-9.18144324]


portfolio before change:  [0.66577898]
curr_Stock_Price:  100.79895571994419
curr_Factors:  [100.79895572]
mat_Sqrt:  [[0.15]]
grads:  [0.10734891]
Stock Position:  0.10734890926016252
Bond Position:  [-10.15487897]


portfolio before change:  [0.70575122]
curr_Stock_Price:  101.1772263050271
curr_Factors:  [101.17722631]
mat_Sqrt:  [[0.15]]
grads:  [0.12543875]
Stock Position:  0.1254387467383882
Bond Position:  [-11.98579325]


portfolio before change:  [0.75024019]
curr_Stock_Price:  101.53786529211415
curr_Factors:  [101.53786529]
mat_Sqrt:  [[0.15]]
grads:  [-0.00100872]
Stock Position:  -0.0010087172023942777
Bond Position:  [0.85266318]


portfolio before change:  [0.7503918]
curr_Stock_Price:  101.44039906262817
curr_Factors:  [101.44039906]
mat_Sqrt:  [[0.15]]
grads:  [0.43506163]
Stock Position:  0.43506162811372173
Bond Position:  [-43.38243338]


portfolio before change:  [0.85094007]
curr_Stock_Price:  101.67774419004674
curr_Factors:  [101.67774419]
mat_Sqrt:  [[0.15]]
grads:  [-0.08643654]
Stock Position:  -0.08643653939166197
Bond Position:  [9.63961241]


portfolio before change:  [0.85746238]
curr_Stock_Price:  101.60925676243954
curr_Factors:  [101.60925676]
mat_Sqrt:  [[0.15]]
grads:  [0.05030622]
Stock Position:  0.05030622464685287
Bond Position:  [-4.25411572]


portfolio before change:  [0.81592399]
curr_Stock_Price:  100.7888315219743
curr_Factors:  [100.78883152]
mat_Sqrt:  [[0.15]]
grads:  [0.03210459]
Stock Position:  0.03210459019608703
Bond Position:  [-2.41986014]


portfolio before change:  [0.81020293]
curr_Stock_Price:  100.61534195908479
curr_Factors:  [100.61534196]
mat_Sqrt:  [[0.15]]
grads:  [0.09703985]
Stock Position:  0.0970398533882404
Bond Position:  [-8.9534951]


portfolio before change:  [0.71553381]
curr_Stock_Price:  99.64553923381095
curr_Factors:  [99.64553923]
mat_Sqrt:  [[0.15]]
grads:  [-0.02486287]
Stock Position:  -0.024862873846633743
Bond Position:  [3.19300828]


portfolio before change:  [0.69948836]
curr_Stock_Price:  100.29892358289584
curr_Factors:  [100.29892358]
mat_Sqrt:  [[0.15]]
grads:  [0.08889793]
Stock Position:  0.08889792679173887
Bond Position:  [-8.216878]


portfolio before change:  [0.74142479]
curr_Stock_Price:  100.77643748699649
curr_Factors:  [100.77643749]
mat_Sqrt:  [[0.15]]
grads:  [0.00299057]
Stock Position:  0.0029905689693878147
Bond Position:  [0.4400459]


portfolio before change:  [0.74420358]
curr_Stock_Price:  101.69642436226765
curr_Factors:  [101.69642436]
mat_Sqrt:  [[0.15]]
grads:  [0.03258128]
Stock Position:  0.032581275583409335
Bond Position:  [-2.56919565]


portfolio before change:  [0.7432039]
curr_Stock_Price:  101.67067035574031
curr_Factors:  [101.67067036]
mat_Sqrt:  [[0.15]]
grads:  [-0.15161732]
Stock Position:  -0.15161732121696683
Bond Position:  [16.15823859]


portfolio before change:  [0.63088983]
curr_Stock_Price:  102.41810465802114
curr_Factors:  [102.41810466]
mat_Sqrt:  [[0.15]]
grads:  [-0.03790485]
Stock Position:  -0.037904853253586564
Bond Position:  [4.51303306]


portfolio before change:  [0.63390814]
curr_Stock_Price:  102.3459177615609
curr_Factors:  [102.34591776]
mat_Sqrt:  [[0.15]]
grads:  [0.22285417]
Stock Position:  0.2228541666492334
Bond Position:  [-22.17430607]


portfolio before change:  [0.55648865]
curr_Stock_Price:  102.00473701201113
curr_Factors:  [102.00473701]
mat_Sqrt:  [[0.15]]
grads:  [0.04963529]
Stock Position:  0.04963529468662518
Bond Position:  [-4.50654653]


portfolio before change:  [0.60028857]
curr_Stock_Price:  102.89284659730144
curr_Factors:  [102.8928466]
mat_Sqrt:  [[0.15]]
grads:  [-0.02718922]
Stock Position:  -0.027189223017176606
Bond Position:  [3.39786512]


portfolio before change:  [0.57560664]
curr_Stock_Price:  103.80844080719066
curr_Factors:  [103.80844081]
mat_Sqrt:  [[0.15]]
grads:  [-0.04338616]
Stock Position:  -0.04338616404944529
Bond Position:  [5.07945669]


portfolio before change:  [0.54416367]
curr_Stock_Price:  104.54048170880299
curr_Factors:  [104.54048171]
mat_Sqrt:  [[0.15]]
grads:  [-0.03484722]
Stock Position:  -0.03484721710142766
Bond Position:  [4.18710853]


portfolio before change:  [0.52876245]
curr_Stock_Price:  104.9899558466783
curr_Factors:  [104.98995585]
mat_Sqrt:  [[0.15]]
grads:  [-0.01508362]
Stock Position:  -0.015083619231146678
Bond Position:  [2.11239097]


portfolio before change:  [0.54564004]
curr_Stock_Price:  103.87977411564155
curr_Factors:  [103.87977412]
mat_Sqrt:  [[0.15]]
grads:  [0.01231762]
Stock Position:  0.012317616102565297
Bond Position:  [-0.73391114]


portfolio before change:  [0.53895966]
curr_Stock_Price:  103.3411549273115
curr_Factors:  [103.34115493]
mat_Sqrt:  [[0.15]]
grads:  [0.02162636]
Stock Position:  0.021626362305167346
Bond Position:  [-1.69593359]


portfolio before change:  [0.54429189]
curr_Stock_Price:  103.5926178572061
curr_Factors:  [103.59261786]
mat_Sqrt:  [[0.15]]
grads:  [-0.05090802]
Stock Position:  -0.050908015391838264
Bond Position:  [5.81798648]


portfolio before change:  [0.55087757]
curr_Stock_Price:  103.4703965317091
curr_Factors:  [103.47039653]
mat_Sqrt:  [[0.15]]
grads:  [-0.27463912]
Stock Position:  -0.2746391238787404
Bond Position:  [28.96789662]


portfolio before change:  [0.67824979]
curr_Stock_Price:  103.01320868726842
curr_Factors:  [103.01320869]
mat_Sqrt:  [[0.15]]
grads:  [-0.0182937]
Stock Position:  -0.018293703145770605
Bond Position:  [2.56274285]


portfolio before change:  [0.68310907]
curr_Stock_Price:  102.75633901911768
curr_Factors:  [102.75633902]
mat_Sqrt:  [[0.15]]
grads:  [0.08305853]
Stock Position:  0.08305853229543574
Bond Position:  [-7.85168164]


portfolio before change:  [0.65402502]
curr_Stock_Price:  102.41208417919175
curr_Factors:  [102.41208418]
mat_Sqrt:  [[0.15]]
grads:  [-0.07720508]
Stock Position:  -0.07720507980716829
Bond Position:  [8.56075815]


portfolio before change:  [0.65873331]
curr_Stock_Price:  102.35803040013218
curr_Factors:  [102.3580304]
mat_Sqrt:  [[0.15]]
grads:  [-0.00054565]
Stock Position:  -0.0005456492778761786
Bond Position:  [0.7145849]


portfolio before change:  [0.65879648]
curr_Stock_Price:  102.3241046646006
curr_Factors:  [102.32410466]
mat_Sqrt:  [[0.15]]
grads:  [0.01519568]
Stock Position:  0.015195684817719442
Bond Position:  [-0.89608836]


portfolio before change:  [0.65386865]
curr_Stock_Price:  102.0034984131309
curr_Factors:  [102.00349841]
mat_Sqrt:  [[0.15]]
grads:  [-0.09110836]
Stock Position:  -0.09110836183241706
Bond Position:  [9.94724029]


portfolio before change:  [0.57213557]
curr_Stock_Price:  102.90741976493187
curr_Factors:  [102.90741976]
mat_Sqrt:  [[0.15]]
grads:  [0.01671305]
Stock Position:  0.0167130488469174
Bond Position:  [-1.14776116]


portfolio before change:  [0.56220694]
curr_Stock_Price:  102.31764698040394
curr_Factors:  [102.31764698]
mat_Sqrt:  [[0.15]]
grads:  [0.01989622]
Stock Position:  0.019896222144476762
Bond Position:  [-1.4735277]


portfolio before change:  [0.56293358]
curr_Stock_Price:  102.35879784405216
curr_Factors:  [102.35879784]
mat_Sqrt:  [[0.15]]
grads:  [-0.02700821]
Stock Position:  -0.027008211834819013
Bond Position:  [3.32746168]


portfolio before change:  [0.52889216]
curr_Stock_Price:  103.62690842855905
curr_Factors:  [103.62690843]
mat_Sqrt:  [[0.15]]
grads:  [-0.02501049]
Stock Position:  -0.025010486402500018
Bond Position:  [3.12065154]


portfolio before change:  [0.53134516]
curr_Stock_Price:  103.53662791776487
curr_Factors:  [103.53662792]
mat_Sqrt:  [[0.15]]
grads:  [0.0229897]
Stock Position:  0.02298969722619514
Bond Position:  [-1.84893056]


portfolio before change:  [0.52963535]
curr_Stock_Price:  103.46728152952333
curr_Factors:  [103.46728153]
mat_Sqrt:  [[0.15]]
grads:  [0.01408184]
Stock Position:  0.014081841184804534
Bond Position:  [-0.92737448]


portfolio before change:  [0.52364178]
curr_Stock_Price:  103.04577346721976
curr_Factors:  [103.04577347]
mat_Sqrt:  [[0.15]]
grads:  [0.0250792]
Stock Position:  0.02507919555788795
Bond Position:  [-2.06066333]


portfolio before change:  [0.52795451]
curr_Stock_Price:  103.22287376248116
curr_Factors:  [103.22287376]
mat_Sqrt:  [[0.15]]
grads:  [-0.03170607]
Stock Position:  -0.03170607084848269
Bond Position:  [3.80074626]


portfolio before change:  [0.56996599]
curr_Stock_Price:  101.90533668555256
curr_Factors:  [101.90533669]
mat_Sqrt:  [[0.15]]
grads:  [0.05673158]
Stock Position:  0.05673157808779485
Bond Position:  [-5.21128457]


portfolio before change:  [0.58097369]
curr_Stock_Price:  102.10510916942617
curr_Factors:  [102.10510917]
mat_Sqrt:  [[0.15]]
grads:  [-0.06572058]
Stock Position:  -0.06572058265934588
Bond Position:  [7.29138095]


portfolio before change:  [0.56115747]
curr_Stock_Price:  102.4135657022513
curr_Factors:  [102.4135657]
mat_Sqrt:  [[0.15]]
grads:  [-0.087464]
Stock Position:  -0.08746399659435236
Bond Position:  [9.51865723]


portfolio before change:  [0.58401385]
curr_Stock_Price:  102.15904438659996
curr_Factors:  [102.15904439]
mat_Sqrt:  [[0.15]]
grads:  [0.09127512]
Stock Position:  0.09127512151820712
Bond Position:  [-8.74056534]


portfolio before change:  [0.55998421]
curr_Stock_Price:  101.90176354999309
curr_Factors:  [101.90176355]
mat_Sqrt:  [[0.15]]
grads:  [0.02957069]
Stock Position:  0.029570691794658203
Bond Position:  [-2.45332143]


portfolio before change:  [0.56485997]
curr_Stock_Price:  102.07183370351048
curr_Factors:  [102.0718337]
mat_Sqrt:  [[0.15]]
grads:  [0.0706404]
Stock Position:  0.07064039978494725
Bond Position:  [-6.64553517]


portfolio before change:  [0.57609564]
curr_Stock_Price:  102.23676806227091
curr_Factors:  [102.23676806]
mat_Sqrt:  [[0.15]]
grads:  [-0.09502856]
Stock Position:  -0.09502856356717822
Bond Position:  [10.29150885]


portfolio before change:  [0.57443482]
curr_Stock_Price:  102.26101404341038
curr_Factors:  [102.26101404]
mat_Sqrt:  [[0.15]]
grads:  [-0.08458593]
Stock Position:  -0.08458592930063433
Bond Position:  [9.22427772]


portfolio before change:  [0.53958399]
curr_Stock_Price:  102.67984678651258
curr_Factors:  [102.67984679]
mat_Sqrt:  [[0.15]]
grads:  [-0.02068414]
Stock Position:  -0.02068413533901556
Bond Position:  [2.66342784]


portfolio before change:  [0.52561759]
curr_Stock_Price:  103.36311775283451
curr_Factors:  [103.36311775]
mat_Sqrt:  [[0.15]]
grads:  [-0.00784785]
Stock Position:  -0.007847851084563246
Bond Position:  [1.33679595]


portfolio before change:  [0.51695637]
curr_Stock_Price:  104.47740717222455
curr_Factors:  [104.47740717]
mat_Sqrt:  [[0.15]]
grads:  [-0.11501116]
Stock Position:  -0.11501116109056644
Bond Position:  [12.53302428]


portfolio before change:  [0.50896198]
curr_Stock_Price:  104.55372783795853
curr_Factors:  [104.55372784]
mat_Sqrt:  [[0.15]]
grads:  [0.11446783]
Stock Position:  0.11446782871829889
Bond Position:  [-11.45907623]


portfolio before change:  [0.54007953]
curr_Stock_Price:  104.83183015463258
curr_Factors:  [104.83183015]
mat_Sqrt:  [[0.15]]
grads:  [0.02996327]
Stock Position:  0.029963265666046457
Bond Position:  [-2.60102444]


portfolio before change:  [0.52384607]
curr_Stock_Price:  104.29547681832531
curr_Factors:  [104.29547682]
mat_Sqrt:  [[0.15]]
grads:  [0.07208966]
Stock Position:  0.0720896556600541
Bond Position:  [-6.99477894]


portfolio before change:  [0.57879142]
curr_Stock_Price:  105.06372207123691
curr_Factors:  [105.06372207]
mat_Sqrt:  [[0.15]]
grads:  [-0.15895795]
Stock Position:  -0.15895795359002815
Bond Position:  [17.27950567]


portfolio before change:  [0.59005061]
curr_Stock_Price:  104.99968504639642
curr_Factors:  [104.99968505]
mat_Sqrt:  [[0.15]]
grads:  [-0.05318262]
Stock Position:  -0.053182624506428494
Bond Position:  [6.17420944]


portfolio before change:  [0.58216859]
curr_Stock_Price:  105.15514781107268
curr_Factors:  [105.15514781]
mat_Sqrt:  [[0.15]]
grads:  [-0.04270203]
Stock Position:  -0.042702026556551656
Bond Position:  [5.07250651]


portfolio before change:  [0.54122817]
curr_Stock_Price:  106.12131889781567
curr_Factors:  [106.1213189]
mat_Sqrt:  [[0.15]]
grads:  [0.07321348]
Stock Position:  0.0732134800470615
Bond Position:  [-7.22828289]


portfolio before change:  [0.5635045]
curr_Stock_Price:  106.4317550886413
curr_Factors:  [106.43175509]
mat_Sqrt:  [[0.15]]
grads:  [0.03506106]
Stock Position:  0.03506106121516813
Bond Position:  [-3.16810578]


portfolio before change:  [0.57341157]
curr_Stock_Price:  106.71996881814692
curr_Factors:  [106.71996882]
mat_Sqrt:  [[0.15]]
grads:  [-0.01057117]
Stock Position:  -0.010571166145850476
Bond Position:  [1.70156609]


portfolio before change:  [0.57872792]
curr_Stock_Price:  106.2271193842216
curr_Factors:  [106.22711938]
mat_Sqrt:  [[0.15]]
grads:  [0.00954964]
Stock Position:  0.009549637821873612
Bond Position:  [-0.4357026]


portfolio before change:  [0.58005563]
curr_Stock_Price:  106.36900352755255
curr_Factors:  [106.36900353]
mat_Sqrt:  [[0.15]]
grads:  [0.04297208]
Stock Position:  0.04297208262031851
Bond Position:  [-3.99084198]


portfolio before change:  [0.58782021]
curr_Stock_Price:  106.55549715624743
curr_Factors:  [106.55549716]
mat_Sqrt:  [[0.15]]
grads:  [-0.01847544]
Stock Position:  -0.018475443993635998
Bond Position:  [2.55648033]


portfolio before change:  [0.58729092]
curr_Stock_Price:  106.59279411057173
curr_Factors:  [106.59279411]
mat_Sqrt:  [[0.15]]
grads:  [0.14014329]
Stock Position:  0.1401432927625947
Bond Position:  [-14.35097423]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.58729092]
Stock Price:  107.45953127363505
PL:  [-6.87224036]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-5.02910079e-02]
 [ 9.71650169e-04]
 [ 1.18301793e-02]
 [ 3.43984046e-03]
 [-6.08717458e-03]
 [ 1.22203434e-02]
 [-9.15790853e-04]
 [ 1.64165823e-02]
 [-1.59761722e-02]
 [ 2.92780580e-02]
 [ 9.87720567e-03]
 [-1.53852458e-02]
 [ 3.48478729e-02]
 [ 1.38712012e-02]
 [-8.11873785e-03]
 [-9.26374955e-03]
 [ 1.13808358e-02]
 [ 1.80108685e-02]
 [-1.59007282e-02]
 [-3.30701650e-03]
 [ 2.74574134e-02]
 [-1.09558673e-02]
 [-1.11009488e-03]
 [ 2.44967924e-03]
 [ 1.80141684e-02]
 [ 1.66895201e-02]
 [ 7.27950373e-03]
 [-1.72182943e-03]
 [ 7.50883445e-03]
 [-9.86039064e-03]
 [-5.71057073e-03]
 [ 4.16970504e-02]
 [ 4.33765002e-03]
 [-7.42080944e-03]
 [-6.31583758e-03]
 [-4.29574318e-03]
 [-4.14129790e-03]
 [-1.72791413e-03]
 [ 6.40997473e-03]
 [-6.82392262e-03]
 [-5.78400170e-02]
 [-4.37488077e-03]
 [ 1.82562025e-02]
 [-1.65624790e-02]
 [-5.95893086e-03]
 [ 2.84317282e-03]
 [-1.35818632e-02]
 [ 1.43668137e-02]
 [ 2.41459859e-02]
 [-1.34675062e-02]
 [-4.86146794e-03]
 [ 3.76437267e-03]
 [ 3.46213282e-03]
 [-6.23336447e-03]
 [-1.09457939e-02]
 [ 1.30318802e-02]
 [-3.05345565e-02]
 [-1.01206259e-02]
 [ 2.04052787e-02]
 [-5.98487696e-03]
 [ 1.30495145e-02]
 [-1.46830343e-02]
 [-1.27617379e-02]
 [-3.35340420e-03]
 [-2.55521968e-03]
 [-1.84806735e-02]
 [ 2.76130903e-02]
 [ 2.81956511e-03]
 [ 7.88955207e-03]
 [-1.87867174e-02]
 [-7.77053537e-03]
 [-7.36518594e-03]
 [ 3.68037558e-03]
 [ 7.36281332e-03]
 [-6.21580233e-04]
 [-1.01662161e-02]
 [ 6.61433987e-03]
 [-4.23622582e-03]
 [ 1.56762496e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.1401664]
curr_Stock_Price:  100.39036192395672
curr_Factors:  [100.39036192]
mat_Sqrt:  [[0.15]]
grads:  [-0.33527339]
Stock Position:  -0.33527338594295464
Bond Position:  [41.79838295]


portfolio before change:  [7.93767383]
curr_Stock_Price:  101.00211655442348
curr_Factors:  [101.00211655]
mat_Sqrt:  [[0.15]]
grads:  [0.00647767]
Stock Position:  0.006477667793190918
Bond Position:  [7.28341567]


portfolio before change:  [7.94317679]
curr_Stock_Price:  101.78136785160676
curr_Factors:  [101.78136785]
mat_Sqrt:  [[0.15]]
grads:  [0.07886786]
Stock Position:  0.07886786201276222
Bond Position:  [-0.08410209]


portfolio before change:  [7.95409264]
curr_Stock_Price:  101.91984134211717
curr_Factors:  [101.91984134]
mat_Sqrt:  [[0.15]]
grads:  [0.02293227]
Stock Position:  0.02293226973760583
Bond Position:  [5.61683935]


portfolio before change:  [7.96604222]
curr_Stock_Price:  102.4256140122674
curr_Factors:  [102.42561401]
mat_Sqrt:  [[0.15]]
grads:  [-0.04058116]
Stock Position:  -0.04058116388394076
Bond Position:  [12.12259285]


portfolio before change:  [7.95266743]
curr_Stock_Price:  102.77386617714627
curr_Factors:  [102.77386618]
mat_Sqrt:  [[0.15]]
grads:  [0.08146896]
Stock Position:  0.08146895577021869
Bond Position:  [-0.42021213]


portfolio before change:  [7.93717184]
curr_Stock_Price:  102.5839862611116
curr_Factors:  [102.58398626]
mat_Sqrt:  [[0.15]]
grads:  [-0.00610527]
Stock Position:  -0.006105272353232436
Bond Position:  [8.56347502]


portfolio before change:  [7.93800185]
curr_Stock_Price:  102.53570542945245
curr_Factors:  [102.53570543]
mat_Sqrt:  [[0.15]]
grads:  [0.10944388]
Stock Position:  0.10944388178195287
Bond Position:  [-3.28390378]


portfolio before change:  [7.9648137]
curr_Stock_Price:  102.78256346219804
curr_Factors:  [102.78256346]
mat_Sqrt:  [[0.15]]
grads:  [-0.10650781]
Stock Position:  -0.10650781497814242
Bond Position:  [18.91195995]


portfolio before change:  [7.95041935]
curr_Stock_Price:  102.92880978901249
curr_Factors:  [102.92880979]
mat_Sqrt:  [[0.15]]
grads:  [0.19518705]
Stock Position:  0.19518705312929693
Bond Position:  [-12.13995171]


portfolio before change:  [7.85408865]
curr_Stock_Price:  102.43916700469589
curr_Factors:  [102.439167]
mat_Sqrt:  [[0.15]]
grads:  [0.06584804]
Stock Position:  0.0658480378154554
Bond Position:  [1.10867051]


portfolio before change:  [7.94398981]
curr_Stock_Price:  103.80339694121294
curr_Factors:  [103.80339694]
mat_Sqrt:  [[0.15]]
grads:  [-0.10256831]
Stock Position:  -0.10256830525661273
Bond Position:  [18.59092831]


portfolio before change:  [8.00707146]
curr_Stock_Price:  103.1997048169452
curr_Factors:  [103.19970482]
mat_Sqrt:  [[0.15]]
grads:  [0.23231915]
Stock Position:  0.23231915291554242
Bond Position:  [-15.96819655]


portfolio before change:  [7.8616352]
curr_Stock_Price:  102.5779815784209
curr_Factors:  [102.57798158]
mat_Sqrt:  [[0.15]]
grads:  [0.09247467]
Stock Position:  0.0924746749787223
Bond Position:  [-1.62423031]


portfolio before change:  [7.90449959]
curr_Stock_Price:  103.04260515534898
curr_Factors:  [103.04260516]
mat_Sqrt:  [[0.15]]
grads:  [-0.05412492]
Stock Position:  -0.054124918981762034
Bond Position:  [13.48167225]


portfolio before change:  [7.92898369]
curr_Stock_Price:  102.60581078481243
curr_Factors:  [102.60581078]
mat_Sqrt:  [[0.15]]
grads:  [-0.06175833]
Stock Position:  -0.06175833030236374
Bond Position:  [14.26574724]


portfolio before change:  [7.90674754]
curr_Stock_Price:  102.98029920826633
curr_Factors:  [102.98029921]
mat_Sqrt:  [[0.15]]
grads:  [0.07587224]
Stock Position:  0.07587223899715018
Bond Position:  [0.09340167]


portfolio before change:  [8.02406079]
curr_Stock_Price:  104.52641685975523
curr_Factors:  [104.52641686]
mat_Sqrt:  [[0.15]]
grads:  [0.12007246]
Stock Position:  0.12007245668932874
Bond Position:  [-4.52668287]


portfolio before change:  [7.99277379]
curr_Stock_Price:  104.26820546393537
curr_Factors:  [104.26820546]
mat_Sqrt:  [[0.15]]
grads:  [-0.10600485]
Stock Position:  -0.10600485474911041
Bond Position:  [19.04570976]


portfolio before change:  [8.07030766]
curr_Stock_Price:  103.5480169554155
curr_Factors:  [103.54801696]
mat_Sqrt:  [[0.15]]
grads:  [-0.02204678]
Stock Position:  -0.022046776659782538
Bond Position:  [10.35320766]


portfolio before change:  [8.07672587]
curr_Stock_Price:  103.28625006417307
curr_Factors:  [103.28625006]
mat_Sqrt:  [[0.15]]
grads:  [0.18304942]
Stock Position:  0.18304942294969342
Bond Position:  [-10.8297626]


portfolio before change:  [8.0693749]
curr_Stock_Price:  103.24978950129623
curr_Factors:  [103.2497895]
mat_Sqrt:  [[0.15]]
grads:  [-0.07303912]
Stock Position:  -0.07303911505189593
Bond Position:  [15.61064816]


portfolio before change:  [8.03510486]
curr_Stock_Price:  103.73234927017928
curr_Factors:  [103.73234927]
mat_Sqrt:  [[0.15]]
grads:  [-0.00740063]
Stock Position:  -0.0074006325640551115
Bond Position:  [8.80278986]


portfolio before change:  [8.03469377]
curr_Stock_Price:  103.86224071474437
curr_Factors:  [103.86224071]
mat_Sqrt:  [[0.15]]
grads:  [0.01633119]
Stock Position:  0.016331194928893903
Bond Position:  [6.33849927]


portfolio before change:  [8.03185539]
curr_Stock_Price:  103.66418101381414
curr_Factors:  [103.66418101]
mat_Sqrt:  [[0.15]]
grads:  [0.12009446]
Stock Position:  0.12009445577793562
Bond Position:  [-4.41763801]


portfolio before change:  [8.02236023]
curr_Stock_Price:  103.5874160654755
curr_Factors:  [103.58741607]
mat_Sqrt:  [[0.15]]
grads:  [0.11126347]
Stock Position:  0.11126346717081903
Bond Position:  [-3.50313483]


portfolio before change:  [8.11017097]
curr_Stock_Price:  104.37859837168696
curr_Factors:  [104.37859837]
mat_Sqrt:  [[0.15]]
grads:  [0.04853002]
Stock Position:  0.04853002488959676
Bond Position:  [3.04467499]


portfolio before change:  [8.08040586]
curr_Stock_Price:  103.7613432899061
curr_Factors:  [103.76134329]
mat_Sqrt:  [[0.15]]
grads:  [-0.01147886]
Stock Position:  -0.011478862841647133
Bond Position:  [9.27146809]


portfolio before change:  [8.08349967]
curr_Stock_Price:  103.54230361592735
curr_Factors:  [103.54230362]
mat_Sqrt:  [[0.15]]
grads:  [0.0500589]
Stock Position:  0.05005889630309879
Bond Position:  [2.90028623]


portfolio before change:  [8.08322074]
curr_Stock_Price:  103.53311027299296
curr_Factors:  [103.53311027]
mat_Sqrt:  [[0.15]]
grads:  [-0.06573594]
Stock Position:  -0.06573593762445876
Bond Position:  [14.88906682]


portfolio before change:  [8.12304305]
curr_Stock_Price:  102.94147475606492
curr_Factors:  [102.94147476]
mat_Sqrt:  [[0.15]]
grads:  [-0.03807047]
Stock Position:  -0.03807047151884931
Bond Position:  [12.04207353]


portfolio before change:  [8.083159]
curr_Stock_Price:  104.00888209263253
curr_Factors:  [104.00888209]
mat_Sqrt:  [[0.15]]
grads:  [0.27798034]
Stock Position:  0.27798033594499666
Bond Position:  [-20.82926498]


portfolio before change:  [8.12803237]
curr_Stock_Price:  104.17499182932107
curr_Factors:  [104.17499183]
mat_Sqrt:  [[0.15]]
grads:  [0.02891767]
Stock Position:  0.028917666807142927
Bond Position:  [5.11553467]


portfolio before change:  [8.13352771]
curr_Stock_Price:  104.35396924051108
curr_Factors:  [104.35396924]
mat_Sqrt:  [[0.15]]
grads:  [-0.04947206]
Stock Position:  -0.04947206292106313
Bond Position:  [13.29613384]


portfolio before change:  [8.15751175]
curr_Stock_Price:  103.88596774772994
curr_Factors:  [103.88596775]
mat_Sqrt:  [[0.15]]
grads:  [-0.04210558]
Stock Position:  -0.04210558388401892
Bond Position:  [12.53169108]


portfolio before change:  [8.16939255]
curr_Stock_Price:  103.62240292285907
curr_Factors:  [103.62240292]
mat_Sqrt:  [[0.15]]
grads:  [-0.02863829]
Stock Position:  -0.028638287854058475
Bond Position:  [11.13696076]


portfolio before change:  [8.16211392]
curr_Stock_Price:  103.9008661718599
curr_Factors:  [103.90086617]
mat_Sqrt:  [[0.15]]
grads:  [-0.02760865]
Stock Position:  -0.027608652654497978
Bond Position:  [11.03067685]


portfolio before change:  [8.13237674]
curr_Stock_Price:  105.00293434654422
curr_Factors:  [105.00293435]
mat_Sqrt:  [[0.15]]
grads:  [-0.01151943]
Stock Position:  -0.01151942755512925
Bond Position:  [9.34195044]


portfolio before change:  [8.1290069]
curr_Stock_Price:  105.34615738199072
curr_Factors:  [105.34615738]
mat_Sqrt:  [[0.15]]
grads:  [0.04273316]
Stock Position:  0.04273316484837266
Bond Position:  [3.62723219]


portfolio before change:  [8.10340009]
curr_Stock_Price:  104.74162638279023
curr_Factors:  [104.74162638]
mat_Sqrt:  [[0.15]]
grads:  [-0.04549282]
Stock Position:  -0.04549281748271541
Bond Position:  [12.86839178]


portfolio before change:  [8.06833919]
curr_Stock_Price:  105.52999696196977
curr_Factors:  [105.52999696]
mat_Sqrt:  [[0.15]]
grads:  [-0.38560011]
Stock Position:  -0.38560011330335164
Bond Position:  [48.76071797]


portfolio before change:  [8.25906115]
curr_Stock_Price:  105.04328985055027
curr_Factors:  [105.04328985]
mat_Sqrt:  [[0.15]]
grads:  [-0.02916587]
Stock Position:  -0.029165871800471418
Bond Position:  [11.32274027]


portfolio before change:  [8.24454495]
curr_Stock_Price:  105.56526606735676
curr_Factors:  [105.56526607]
mat_Sqrt:  [[0.15]]
grads:  [0.12170802]
Stock Position:  0.12170801648767086
Bond Position:  [-4.60359419]


portfolio before change:  [8.27743794]
curr_Stock_Price:  105.83789171726869
curr_Factors:  [105.83789172]
mat_Sqrt:  [[0.15]]
grads:  [-0.11041653]
Stock Position:  -0.11041652657905299
Bond Position:  [19.96369033]


portfolio before change:  [8.32761986]
curr_Stock_Price:  105.39471398449666
curr_Factors:  [105.39471398]
mat_Sqrt:  [[0.15]]
grads:  [-0.03972621]
Stock Position:  -0.03972620576479322
Bond Position:  [12.51455195]


portfolio before change:  [8.34262884]
curr_Stock_Price:  105.03659261182271
curr_Factors:  [105.03659261]
mat_Sqrt:  [[0.15]]
grads:  [0.01895449]
Stock Position:  0.01895448549429362
Bond Position:  [6.35171427]


portfolio before change:  [8.33838504]
curr_Stock_Price:  104.7917534102
curr_Factors:  [104.79175341]
mat_Sqrt:  [[0.15]]
grads:  [-0.09054575]
Stock Position:  -0.09054575462731335
Bond Position:  [17.82683343]


portfolio before change:  [8.32532517]
curr_Stock_Price:  104.94829392409727
curr_Factors:  [104.94829392]
mat_Sqrt:  [[0.15]]
grads:  [0.09577876]
Stock Position:  0.09577875778431964
Bond Position:  [-1.72649205]


portfolio before change:  [8.34780012]
curr_Stock_Price:  105.18407540965765
curr_Factors:  [105.18407541]
mat_Sqrt:  [[0.15]]
grads:  [0.16097324]
Stock Position:  0.16097323945798325
Bond Position:  [-8.58402124]


portfolio before change:  [8.49563071]
curr_Stock_Price:  106.10576346777756
curr_Factors:  [106.10576347]
mat_Sqrt:  [[0.15]]
grads:  [-0.08978337]
Stock Position:  -0.08978337487623556
Bond Position:  [18.02216425]


portfolio before change:  [8.45112993]
curr_Stock_Price:  106.61395557151748
curr_Factors:  [106.61395557]
mat_Sqrt:  [[0.15]]
grads:  [-0.03240979]
Stock Position:  -0.03240978625937784
Bond Position:  [11.90646544]


portfolio before change:  [8.44782388]
curr_Stock_Price:  106.73892491831513
curr_Factors:  [106.73892492]
mat_Sqrt:  [[0.15]]
grads:  [0.02509582]
Stock Position:  0.025095817779709866
Bond Position:  [5.76912327]


portfolio before change:  [8.44646426]
curr_Stock_Price:  106.67037941897539
curr_Factors:  [106.67037942]
mat_Sqrt:  [[0.15]]
grads:  [0.02308089]
Stock Position:  0.02308088549103421
Bond Position:  [5.98441744]


portfolio before change:  [8.44162183]
curr_Stock_Price:  106.44437141718132
curr_Factors:  [106.44437142]
mat_Sqrt:  [[0.15]]
grads:  [-0.04155576]
Stock Position:  -0.04155576314842562
Bond Position:  [12.86499892]


portfolio before change:  [8.46086622]
curr_Stock_Price:  106.00062306660658
curr_Factors:  [106.00062307]
mat_Sqrt:  [[0.15]]
grads:  [-0.07297196]
Stock Position:  -0.07297195906301054
Bond Position:  [16.19593935]


portfolio before change:  [8.38754427]
curr_Stock_Price:  107.01929146448141
curr_Factors:  [107.01929146]
mat_Sqrt:  [[0.15]]
grads:  [0.0868792]
Stock Position:  0.08687920156732887
Bond Position:  [-0.91020633]


portfolio before change:  [8.31481147]
curr_Stock_Price:  106.18277466806411
curr_Factors:  [106.18277467]
mat_Sqrt:  [[0.15]]
grads:  [-0.20356371]
Stock Position:  -0.20356370984094363
Bond Position:  [29.929771]


portfolio before change:  [8.2809742]
curr_Stock_Price:  106.35818871917186
curr_Factors:  [106.35818872]
mat_Sqrt:  [[0.15]]
grads:  [-0.06747084]
Stock Position:  -0.06747083900725825
Bond Position:  [15.45705043]


portfolio before change:  [8.27141213]
curr_Stock_Price:  106.51422895757452
curr_Factors:  [106.51422896]
mat_Sqrt:  [[0.15]]
grads:  [0.13603519]
Stock Position:  0.13603519134670203
Bond Position:  [-6.21827139]


portfolio before change:  [8.16610739]
curr_Stock_Price:  105.74298668048705
curr_Factors:  [105.74298668]
mat_Sqrt:  [[0.15]]
grads:  [-0.03989918]
Stock Position:  -0.03989917971672252
Bond Position:  [12.38516581]


portfolio before change:  [8.19446116]
curr_Stock_Price:  105.0517524539861
curr_Factors:  [105.05175245]
mat_Sqrt:  [[0.15]]
grads:  [0.08699676]
Stock Position:  0.08699676348942496
Bond Position:  [-0.9447013]


portfolio before change:  [8.14819885]
curr_Stock_Price:  104.52066067879456
curr_Factors:  [104.52066068]
mat_Sqrt:  [[0.15]]
grads:  [-0.0978869]
Stock Position:  -0.09788689525669049
Bond Position:  [18.37940181]


portfolio before change:  [8.18319778]
curr_Stock_Price:  104.17485154385363
curr_Factors:  [104.17485154]
mat_Sqrt:  [[0.15]]
grads:  [-0.08507825]
Stock Position:  -0.085078252776828
Bond Position:  [17.04621213]


portfolio before change:  [8.21644246]
curr_Stock_Price:  103.79662024157793
curr_Factors:  [103.79662024]
mat_Sqrt:  [[0.15]]
grads:  [-0.02235603]
Stock Position:  -0.022356027979883508
Bond Position:  [10.53692261]


portfolio before change:  [8.2277396]
curr_Stock_Price:  103.32075028731988
curr_Factors:  [103.32075029]
mat_Sqrt:  [[0.15]]
grads:  [-0.0170348]
Stock Position:  -0.017034797863189045
Bond Position:  [9.9877877]


portfolio before change:  [8.2246279]
curr_Stock_Price:  103.54006339235225
curr_Factors:  [103.54006339]
mat_Sqrt:  [[0.15]]
grads:  [-0.12320449]
Stock Position:  -0.12320449006263381
Bond Position:  [20.98122861]


portfolio before change:  [8.30319461]
curr_Stock_Price:  102.91301368859521
curr_Factors:  [102.91301369]
mat_Sqrt:  [[0.15]]
grads:  [0.18408727]
Stock Position:  0.18408726855280932
Bond Position:  [-10.64178098]


portfolio before change:  [8.30926068]
curr_Stock_Price:  102.9495789748378
curr_Factors:  [102.94957897]
mat_Sqrt:  [[0.15]]
grads:  [0.0187971]
Stock Position:  0.01879710071291913
Bond Position:  [6.37410708]


portfolio before change:  [8.30918432]
curr_Stock_Price:  102.92432210840248
curr_Factors:  [102.92432211]
mat_Sqrt:  [[0.15]]
grads:  [0.05259701]
Stock Position:  0.05259701377153
Bond Position:  [2.89567233]


portfolio before change:  [8.32691643]
curr_Stock_Price:  103.25801257192849
curr_Factors:  [103.25801257]
mat_Sqrt:  [[0.15]]
grads:  [-0.12524478]
Stock Position:  -0.12524478289783816
Bond Position:  [21.25944379]


portfolio before change:  [8.28099517]
curr_Stock_Price:  103.63527393960788
curr_Factors:  [103.63527394]
mat_Sqrt:  [[0.15]]
grads:  [-0.05180357]
Stock Position:  -0.05180356912945947
Bond Position:  [13.64967224]


portfolio before change:  [8.28474333]
curr_Stock_Price:  103.5793890357773
curr_Factors:  [103.57938904]
mat_Sqrt:  [[0.15]]
grads:  [-0.04910124]
Stock Position:  -0.049101239568866445
Bond Position:  [13.37061973]


portfolio before change:  [8.30732212]
curr_Stock_Price:  103.13656727102634
curr_Factors:  [103.13656727]
mat_Sqrt:  [[0.15]]
grads:  [0.02453584]
Stock Position:  0.024535837220659093
Bond Position:  [5.7767801]


portfolio before change:  [8.30825852]
curr_Stock_Price:  103.1600162776449
curr_Factors:  [103.16001628]
mat_Sqrt:  [[0.15]]
grads:  [0.04908542]
Stock Position:  0.049085422133283006
Bond Position:  [3.24460558]


portfolio before change:  [8.28910796]
curr_Stock_Price:  102.76573721460755
curr_Factors:  [102.76573721]
mat_Sqrt:  [[0.15]]
grads:  [-0.00414387]
Stock Position:  -0.0041438682218014325
Bond Position:  [8.71495564]


portfolio before change:  [8.28784323]
curr_Stock_Price:  103.20239158062226
curr_Factors:  [103.20239158]
mat_Sqrt:  [[0.15]]
grads:  [-0.06777477]
Stock Position:  -0.06777477385444947
Bond Position:  [15.28236198]


portfolio before change:  [8.29411956]
curr_Stock_Price:  103.12387920076898
curr_Factors:  [103.1238792]
mat_Sqrt:  [[0.15]]
grads:  [0.0440956]
Stock Position:  0.04409559914515619
Bond Position:  [3.74681032]


portfolio before change:  [8.27515057]
curr_Stock_Price:  102.68838956040655
curr_Factors:  [102.68838956]
mat_Sqrt:  [[0.15]]
grads:  [-0.02824151]
Stock Position:  -0.0282415054508709
Bond Position:  [11.17522528]


portfolio before change:  [8.29495864]
curr_Stock_Price:  102.0117402457123
curr_Factors:  [102.01174025]
mat_Sqrt:  [[0.15]]
grads:  [0.10450833]
Stock Position:  0.10450833055492123
Bond Position:  [-2.36611803]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.29495864]
Stock Price:  101.15032874893492
PL:  [7.14462989]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-5.14077486e-02]
 [-2.28343463e-03]
 [ 1.17048606e-04]
 [ 2.13477577e-03]
 [ 1.55312140e-02]
 [ 1.14005456e-02]
 [ 1.22258728e-03]
 [ 1.29787512e-02]
 [ 1.74294112e-02]
 [-1.31927711e-02]
 [ 5.81294340e-03]
 [-4.90541838e-03]
 [-8.17298677e-03]
 [ 3.54998788e-03]
 [-1.00995351e-03]
 [ 4.15109549e-03]
 [ 1.32195990e-02]
 [ 1.59414257e-02]
 [ 2.33189065e-02]
 [ 2.50186080e-03]
 [ 7.26327618e-02]
 [-1.37456396e-02]
 [-2.36996818e-03]
 [ 1.25165326e-02]
 [ 6.73774833e-03]
 [ 3.35590164e-03]
 [ 1.36583136e-02]
 [-9.91262595e-03]
 [ 2.36079389e-03]
 [-1.83265827e-02]
 [-3.81633446e-03]
 [-1.59524987e-02]
 [ 1.75276653e-02]
 [ 1.02154877e-02]
 [-2.20094197e-02]
 [ 7.61651171e-03]
 [-2.62029047e-03]
 [ 3.56512901e-03]
 [ 4.58803220e-03]
 [-1.52600519e-02]
 [ 3.56569079e-02]
 [-7.78928967e-04]
 [ 5.77545297e-03]
 [-8.65756250e-03]
 [-9.89557216e-05]
 [-7.99087191e-03]
 [-1.35152822e-02]
 [-8.81940350e-04]
 [-2.72705763e-03]
 [ 4.29963615e-03]
 [-3.73065862e-03]
 [ 2.95176019e-03]
 [ 3.38692506e-03]
 [ 9.14369284e-04]
 [ 5.96107455e-03]
 [ 8.88948571e-03]
 [ 1.09730367e-02]
 [ 7.75819067e-03]
 [ 1.35116804e-02]
 [-1.32687790e-03]
 [ 2.92673754e-04]
 [-1.88006270e-02]
 [-1.27406813e-02]
 [-1.60709981e-03]
 [-8.22052429e-03]
 [-8.06584337e-03]
 [ 9.78566066e-03]
 [ 2.09981424e-03]
 [ 1.11130005e-02]
 [-1.72468952e-02]
 [-3.58480483e-03]
 [-1.18511877e-03]
 [ 6.81287163e-04]
 [ 8.16998766e-03]
 [-3.58324721e-04]
 [ 1.92564222e-03]
 [-1.69459388e-03]
 [-1.05771662e-02]
 [-8.40449866e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.40631519]
curr_Stock_Price:  100.40746748220228
curr_Factors:  [100.40746748]
mat_Sqrt:  [[0.15]]
grads:  [-0.34271832]
Stock Position:  -0.3427183238627598
Bond Position:  [42.81779414]


portfolio before change:  [8.44741352]
curr_Stock_Price:  100.29535751725614
curr_Factors:  [100.29535752]
mat_Sqrt:  [[0.15]]
grads:  [-0.0152229]
Stock Position:  -0.015222897532319273
Bond Position:  [9.97419947]


portfolio before change:  [8.45061951]
curr_Stock_Price:  100.1257060743335
curr_Factors:  [100.12570607]
mat_Sqrt:  [[0.15]]
grads:  [0.00078032]
Stock Position:  0.0007803240385601071
Bond Position:  [8.37248902]


portfolio before change:  [8.45124616]
curr_Stock_Price:  100.25815614480591
curr_Factors:  [100.25815614]
mat_Sqrt:  [[0.15]]
grads:  [0.01423184]
Stock Position:  0.01423183844600098
Bond Position:  [7.02438828]


portfolio before change:  [8.45037876]
curr_Stock_Price:  100.16635874406813
curr_Factors:  [100.16635874]
mat_Sqrt:  [[0.15]]
grads:  [0.10354143]
Stock Position:  0.10354142688145374
Bond Position:  [-1.92098895]


portfolio before change:  [8.39634161]
curr_Stock_Price:  99.64562915142098
curr_Factors:  [99.64562915]
mat_Sqrt:  [[0.15]]
grads:  [0.07600364]
Stock Position:  0.07600363743033764
Bond Position:  [0.82291134]


portfolio before change:  [8.4404785]
curr_Stock_Price:  100.22567319190183
curr_Factors:  [100.22567319]
mat_Sqrt:  [[0.15]]
grads:  [0.00815058]
Stock Position:  0.008150581857937909
Bond Position:  [7.62358094]


portfolio before change:  [8.43521496]
curr_Stock_Price:  99.52142556973446
curr_Factors:  [99.52142557]
mat_Sqrt:  [[0.15]]
grads:  [0.08652501]
Stock Position:  0.08652500825107166
Bond Position:  [-0.17587721]


portfolio before change:  [8.39584171]
curr_Stock_Price:  99.06650213502155
curr_Factors:  [99.06650214]
mat_Sqrt:  [[0.15]]
grads:  [0.11619607]
Stock Position:  0.11619607469397919
Bond Position:  [-3.11529697]


portfolio before change:  [8.36423007]
curr_Stock_Price:  98.79612352412184
curr_Factors:  [98.79612352]
mat_Sqrt:  [[0.15]]
grads:  [-0.08795181]
Stock Position:  -0.0879518070837373
Bond Position:  [17.05352766]


portfolio before change:  [8.34849775]
curr_Stock_Price:  98.98711667346879
curr_Factors:  [98.98711667]
mat_Sqrt:  [[0.15]]
grads:  [0.03875296]
Stock Position:  0.038752956005371104
Bond Position:  [4.51245437]


portfolio before change:  [8.38437411]
curr_Stock_Price:  99.90560975540953
curr_Factors:  [99.90560976]
mat_Sqrt:  [[0.15]]
grads:  [-0.03270279]
Stock Position:  -0.0327027892013422
Bond Position:  [11.65156621]


portfolio before change:  [8.40044351]
curr_Stock_Price:  99.4365014450945
curr_Factors:  [99.43650145]
mat_Sqrt:  [[0.15]]
grads:  [-0.05448658]
Stock Position:  -0.054486578491808255
Bond Position:  [13.81839825]


portfolio before change:  [8.43954878]
curr_Stock_Price:  98.73464785648375
curr_Factors:  [98.73464786]
mat_Sqrt:  [[0.15]]
grads:  [0.02366659]
Stock Position:  0.02366658586712731
Bond Position:  [6.10283676]


portfolio before change:  [8.44382022]
curr_Stock_Price:  98.89901447004291
curr_Factors:  [98.89901447]
mat_Sqrt:  [[0.15]]
grads:  [-0.00673302]
Stock Position:  -0.006733023427164936
Bond Position:  [9.1097096]


portfolio before change:  [8.43927092]
curr_Stock_Price:  99.65924816440562
curr_Factors:  [99.65924816]
mat_Sqrt:  [[0.15]]
grads:  [0.02767397]
Stock Position:  0.027673969915008118
Bond Position:  [5.68130389]


portfolio before change:  [8.46206882]
curr_Stock_Price:  100.47021962006222
curr_Factors:  [100.47021962]
mat_Sqrt:  [[0.15]]
grads:  [0.08813066]
Stock Position:  0.08813066019299261
Bond Position:  [-0.39243797]


portfolio before change:  [8.4898987]
curr_Stock_Price:  100.78627779954007
curr_Factors:  [100.7862778]
mat_Sqrt:  [[0.15]]
grads:  [0.10627617]
Stock Position:  0.10627617103464118
Bond Position:  [-2.22128099]


portfolio before change:  [8.45472522]
curr_Stock_Price:  100.45662110647339
curr_Factors:  [100.45662111]
mat_Sqrt:  [[0.15]]
grads:  [0.15545938]
Stock Position:  0.15545937659827969
Bond Position:  [-7.16219847]


portfolio before change:  [8.4754762]
curr_Stock_Price:  100.59298233263452
curr_Factors:  [100.59298233]
mat_Sqrt:  [[0.15]]
grads:  [0.01667907]
Stock Position:  0.016679072029055372
Bond Position:  [6.7976786]


portfolio before change:  [8.46730639]
curr_Stock_Price:  100.07768539235083
curr_Factors:  [100.07768539]
mat_Sqrt:  [[0.15]]
grads:  [0.48421841]
Stock Position:  0.48421841184939995
Bond Position:  [-39.99215149]


portfolio before change:  [8.51363417]
curr_Stock_Price:  100.17852288111105
curr_Factors:  [100.17852288]
mat_Sqrt:  [[0.15]]
grads:  [-0.0916376]
Stock Position:  -0.09163759701165115
Bond Position:  [17.69375328]


portfolio before change:  [8.55648654]
curr_Stock_Price:  99.7229623074176
curr_Factors:  [99.72296231]
mat_Sqrt:  [[0.15]]
grads:  [-0.01579979]
Stock Position:  -0.01579978789317809
Bond Position:  [10.1320882]


portfolio before change:  [8.57459451]
curr_Stock_Price:  98.61695398205536
curr_Factors:  [98.61695398]
mat_Sqrt:  [[0.15]]
grads:  [0.08344355]
Stock Position:  0.08344355057293816
Bond Position:  [0.34564573]


portfolio before change:  [8.59486175]
curr_Stock_Price:  98.85958062759623
curr_Factors:  [98.85958063]
mat_Sqrt:  [[0.15]]
grads:  [0.04491832]
Stock Position:  0.04491832219532163
Bond Position:  [4.15425525]


portfolio before change:  [8.59975228]
curr_Stock_Price:  98.96267624179045
curr_Factors:  [98.96267624]
mat_Sqrt:  [[0.15]]
grads:  [0.02237268]
Stock Position:  0.02237267760914069
Bond Position:  [6.38569223]


portfolio before change:  [8.62174483]
curr_Stock_Price:  99.92784592455077
curr_Factors:  [99.92784592]
mat_Sqrt:  [[0.15]]
grads:  [0.09105542]
Stock Position:  0.09105542369303533
Bond Position:  [-0.47722752]


portfolio before change:  [8.54221811]
curr_Stock_Price:  99.05478546503964
curr_Factors:  [99.05478547]
mat_Sqrt:  [[0.15]]
grads:  [-0.06608417]
Stock Position:  -0.06608417299765343
Bond Position:  [15.08817169]


portfolio before change:  [8.53770679]
curr_Stock_Price:  99.13732208281232
curr_Factors:  [99.13732208]
mat_Sqrt:  [[0.15]]
grads:  [0.01573863]
Stock Position:  0.015738625929447542
Bond Position:  [6.97742156]


portfolio before change:  [8.54389065]
curr_Stock_Price:  99.50252339258508
curr_Factors:  [99.50252339]
mat_Sqrt:  [[0.15]]
grads:  [-0.12217722]
Stock Position:  -0.12217721771952626
Bond Position:  [20.70083212]


portfolio before change:  [8.60625848]
curr_Stock_Price:  99.00264307057368
curr_Factors:  [99.00264307]
mat_Sqrt:  [[0.15]]
grads:  [-0.02544223]
Stock Position:  -0.025442229735951675
Bond Position:  [11.12510647]


portfolio before change:  [8.62553342]
curr_Stock_Price:  98.27237690332409
curr_Factors:  [98.2723769]
mat_Sqrt:  [[0.15]]
grads:  [-0.10634999]
Stock Position:  -0.10634999130610927
Bond Position:  [19.07679985]


portfolio before change:  [8.65290627]
curr_Stock_Price:  98.02620376164703
curr_Factors:  [98.02620376]
mat_Sqrt:  [[0.15]]
grads:  [0.1168511]
Stock Position:  0.11685110194515139
Bond Position:  [-2.80156366]


portfolio before change:  [8.60506005]
curr_Stock_Price:  97.61823911164514
curr_Factors:  [97.61823911]
mat_Sqrt:  [[0.15]]
grads:  [0.06810325]
Stock Position:  0.06810325101435756
Bond Position:  [1.95694061]


portfolio before change:  [8.5946014]
curr_Stock_Price:  97.46287262828032
curr_Factors:  [97.46287263]
mat_Sqrt:  [[0.15]]
grads:  [-0.14672946]
Stock Position:  -0.14672946457086328
Bond Position:  [22.89527652]


portfolio before change:  [8.55360692]
curr_Stock_Price:  97.75201346497538
curr_Factors:  [97.75201346]
mat_Sqrt:  [[0.15]]
grads:  [0.05077674]
Stock Position:  0.050776744759859105
Bond Position:  [3.59007788]


portfolio before change:  [8.56159773]
curr_Stock_Price:  97.90496583580347
curr_Factors:  [97.90496584]
mat_Sqrt:  [[0.15]]
grads:  [-0.0174686]
Stock Position:  -0.017468603144407284
Bond Position:  [10.27186072]


portfolio before change:  [8.56762382]
curr_Stock_Price:  97.5967515407454
curr_Factors:  [97.59675154]
mat_Sqrt:  [[0.15]]
grads:  [0.02376753]
Stock Position:  0.02376752675035334
Bond Position:  [6.24799041]


portfolio before change:  [8.56526689]
curr_Stock_Price:  97.48115542180865
curr_Factors:  [97.48115542]
mat_Sqrt:  [[0.15]]
grads:  [0.03058688]
Stock Position:  0.030586881312888343
Bond Position:  [5.58362236]


portfolio before change:  [8.57403742]
curr_Stock_Price:  97.75648703744744
curr_Factors:  [97.75648704]
mat_Sqrt:  [[0.15]]
grads:  [-0.10173368]
Stock Position:  -0.10173367939900742
Bond Position:  [18.51916453]


portfolio before change:  [8.59235964]
curr_Stock_Price:  97.58776474761348
curr_Factors:  [97.58776475]
mat_Sqrt:  [[0.15]]
grads:  [0.23771272]
Stock Position:  0.2377127191487046
Bond Position:  [-14.60549327]


portfolio before change:  [8.63134971]
curr_Stock_Price:  97.75562679591935
curr_Factors:  [97.7556268]
mat_Sqrt:  [[0.15]]
grads:  [-0.00519286]
Stock Position:  -0.00519285977993417
Bond Position:  [9.13898097]


portfolio before change:  [8.63479421]
curr_Stock_Price:  97.20231125690721
curr_Factors:  [97.20231126]
mat_Sqrt:  [[0.15]]
grads:  [0.03850302]
Stock Position:  0.038503019782105595
Bond Position:  [4.89221169]


portfolio before change:  [8.6413135]
curr_Stock_Price:  97.36368889431778
curr_Factors:  [97.36368889]
mat_Sqrt:  [[0.15]]
grads:  [-0.05771708]
Stock Position:  -0.05771708335578894
Bond Position:  [14.26086165]


portfolio before change:  [8.66909023]
curr_Stock_Price:  96.897875356485
curr_Factors:  [96.89787536]
mat_Sqrt:  [[0.15]]
grads:  [-0.0006597]
Stock Position:  -0.0006597048104073442
Bond Position:  [8.73301423]


portfolio before change:  [8.66961127]
curr_Stock_Price:  96.93545476573263
curr_Factors:  [96.93545477]
mat_Sqrt:  [[0.15]]
grads:  [-0.05327248]
Stock Position:  -0.05327247940157198
Bond Position:  [13.83360329]


portfolio before change:  [8.654693]
curr_Stock_Price:  97.23172212449273
curr_Factors:  [97.23172212]
mat_Sqrt:  [[0.15]]
grads:  [-0.09010188]
Stock Position:  -0.09010188104358315
Bond Position:  [17.41545406]


portfolio before change:  [8.60430794]
curr_Stock_Price:  97.80300386959712
curr_Factors:  [97.80300387]
mat_Sqrt:  [[0.15]]
grads:  [-0.0058796]
Stock Position:  -0.005879602330743408
Bond Position:  [9.17935071]


portfolio before change:  [8.61105435]
curr_Stock_Price:  96.75315800119995
curr_Factors:  [96.753158]
mat_Sqrt:  [[0.15]]
grads:  [-0.01818038]
Stock Position:  -0.018180384228390408
Bond Position:  [10.37006394]


portfolio before change:  [8.5964567]
curr_Stock_Price:  97.59174307605373
curr_Factors:  [97.59174308]
mat_Sqrt:  [[0.15]]
grads:  [0.02866424]
Stock Position:  0.028664241033319583
Bond Position:  [5.79906345]


portfolio before change:  [8.57273583]
curr_Stock_Price:  96.75155608281004
curr_Factors:  [96.75155608]
mat_Sqrt:  [[0.15]]
grads:  [-0.02487106]
Stock Position:  -0.024871057437971262
Bond Position:  [10.97904934]


portfolio before change:  [8.57204559]
curr_Stock_Price:  96.80689956891186
curr_Factors:  [96.80689957]
mat_Sqrt:  [[0.15]]
grads:  [0.0196784]
Stock Position:  0.01967840128993021
Bond Position:  [6.66704057]


portfolio before change:  [8.57807883]
curr_Stock_Price:  97.09231597098274
curr_Factors:  [97.09231597]
mat_Sqrt:  [[0.15]]
grads:  [0.0225795]
Stock Position:  0.0225795004024569
Bond Position:  [6.38578284]


portfolio before change:  [8.57323801]
curr_Stock_Price:  96.86024928963637
curr_Factors:  [96.86024929]
mat_Sqrt:  [[0.15]]
grads:  [0.0060958]
Stock Position:  0.0060957952261934435
Bond Position:  [7.98279776]


portfolio before change:  [8.57212315]
curr_Stock_Price:  96.59550974808441
curr_Factors:  [96.59550975]
mat_Sqrt:  [[0.15]]
grads:  [0.0397405]
Stock Position:  0.03974049700915245
Bond Position:  [4.73336958]


portfolio before change:  [8.59011967]
curr_Stock_Price:  97.04091635795156
curr_Factors:  [97.04091636]
mat_Sqrt:  [[0.15]]
grads:  [0.05926324]
Stock Position:  0.05926323808208885
Bond Position:  [2.83916074]


portfolio before change:  [8.547971]
curr_Stock_Price:  96.32671090851431
curr_Factors:  [96.32671091]
mat_Sqrt:  [[0.15]]
grads:  [0.07315358]
Stock Position:  0.073153577672821
Bond Position:  [1.50132747]


portfolio before change:  [8.53788237]
curr_Stock_Price:  96.18751789926064
curr_Factors:  [96.1875179]
mat_Sqrt:  [[0.15]]
grads:  [0.05172127]
Stock Position:  0.051721271110609826
Bond Position:  [3.56294168]


portfolio before change:  [8.57051356]
curr_Stock_Price:  96.81411703202225
curr_Factors:  [96.81411703]
mat_Sqrt:  [[0.15]]
grads:  [0.09007787]
Stock Position:  0.09007786937289135
Bond Position:  [-0.15029583]


portfolio before change:  [8.58289409]
curr_Stock_Price:  96.95166378133527
curr_Factors:  [96.95166378]
mat_Sqrt:  [[0.15]]
grads:  [-0.00884585]
Stock Position:  -0.008845852653748393
Bond Position:  [9.44051422]


portfolio before change:  [8.5846199]
curr_Stock_Price:  96.8232689243499
curr_Factors:  [96.82326892]
mat_Sqrt:  [[0.15]]
grads:  [0.00195116]
Stock Position:  0.001951158361501009
Bond Position:  [8.39570237]


portfolio before change:  [8.58483985]
curr_Stock_Price:  96.66705767467988
curr_Factors:  [96.66705767]
mat_Sqrt:  [[0.15]]
grads:  [-0.12533751]
Stock Position:  -0.1253375136069688
Bond Position:  [20.70084851]


portfolio before change:  [8.55013647]
curr_Stock_Price:  96.95426000548464
curr_Factors:  [96.95426001]
mat_Sqrt:  [[0.15]]
grads:  [-0.08493788]
Stock Position:  -0.08493787542809667
Bond Position:  [16.78522533]


portfolio before change:  [8.56704932]
curr_Stock_Price:  96.76749132809908
curr_Factors:  [96.76749133]
mat_Sqrt:  [[0.15]]
grads:  [-0.010714]
Stock Position:  -0.01071399870849878
Bond Position:  [9.60381609]


portfolio before change:  [8.57511619]
curr_Stock_Price:  96.07058841008865
curr_Factors:  [96.07058841]
mat_Sqrt:  [[0.15]]
grads:  [-0.0548035]
Stock Position:  -0.054803495254656734
Bond Position:  [13.84012023]


portfolio before change:  [8.54273127]
curr_Stock_Price:  96.67730066032374
curr_Factors:  [96.67730066]
mat_Sqrt:  [[0.15]]
grads:  [-0.05377229]
Stock Position:  -0.053772289156857125
Bond Position:  [13.74129104]


portfolio before change:  [8.51170022]
curr_Stock_Price:  97.27035544983023
curr_Factors:  [97.27035545]
mat_Sqrt:  [[0.15]]
grads:  [0.06523774]
Stock Position:  0.06523773772703485
Bond Position:  [2.16600228]


portfolio before change:  [8.49920093]
curr_Stock_Price:  97.07668430752958
curr_Factors:  [97.07668431]
mat_Sqrt:  [[0.15]]
grads:  [0.01399876]
Stock Position:  0.013998761589968186
Bond Position:  [7.14024757]


portfolio before change:  [8.50289928]
curr_Stock_Price:  97.30899576397131
curr_Factors:  [97.30899576]
mat_Sqrt:  [[0.15]]
grads:  [0.07408667]
Stock Position:  0.07408666989205054
Bond Position:  [1.29359983]


portfolio before change:  [8.55055636]
curr_Stock_Price:  97.95116565953842
curr_Factors:  [97.95116566]
mat_Sqrt:  [[0.15]]
grads:  [-0.1149793]
Stock Position:  -0.1149793010826822
Bond Position:  [19.81291293]


portfolio before change:  [8.46381442]
curr_Stock_Price:  98.71634938062515
curr_Factors:  [98.71634938]
mat_Sqrt:  [[0.15]]
grads:  [-0.0238987]
Stock Position:  -0.023898698848444956
Bond Position:  [10.82300672]


portfolio before change:  [8.44884672]
curr_Stock_Price:  99.37095243240249
curr_Factors:  [99.37095243]
mat_Sqrt:  [[0.15]]
grads:  [-0.00790079]
Stock Position:  -0.007900791781878672
Bond Position:  [9.23395592]


portfolio before change:  [8.45941414]
curr_Stock_Price:  98.10648596270856
curr_Factors:  [98.10648596]
mat_Sqrt:  [[0.15]]
grads:  [0.00454191]
Stock Position:  0.004541914420907739
Bond Position:  [8.01382288]


portfolio before change:  [8.45638964]
curr_Stock_Price:  97.33029813507204
curr_Factors:  [97.33029814]
mat_Sqrt:  [[0.15]]
grads:  [0.05446658]
Stock Position:  0.0544665844269342
Bond Position:  [3.15514074]


portfolio before change:  [8.45070895]
curr_Stock_Price:  97.2223806165058
curr_Factors:  [97.22238062]
mat_Sqrt:  [[0.15]]
grads:  [-0.00238883]
Stock Position:  -0.0023888314749803685
Bond Position:  [8.68295683]


portfolio before change:  [8.45072121]
curr_Stock_Price:  97.44442816095632
curr_Factors:  [97.44442816]
mat_Sqrt:  [[0.15]]
grads:  [0.01283761]
Stock Position:  0.012837614790669078
Bond Position:  [7.19976718]


portfolio before change:  [8.45665935]
curr_Stock_Price:  97.87193213451805
curr_Factors:  [97.87193213]
mat_Sqrt:  [[0.15]]
grads:  [-0.01129729]
Stock Position:  -0.011297292564872973
Bond Position:  [9.5623472]


portfolio before change:  [8.45659198]
curr_Stock_Price:  97.93079880623917
curr_Factors:  [97.93079881]
mat_Sqrt:  [[0.15]]
grads:  [-0.07051444]
Stock Position:  -0.07051444119735073
Bond Position:  [15.36212753]


portfolio before change:  [8.41769059]
curr_Stock_Price:  98.49609500799329
curr_Factors:  [98.49609501]
mat_Sqrt:  [[0.15]]
grads:  [-0.05602999]
Stock Position:  -0.05602999104109298
Bond Position:  [13.93642592]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.41769059]
Stock Price:  98.09944375097842
PL:  [8.41769059]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-6.52220998e-02]
 [-2.13173616e-03]
 [ 3.42955443e-04]
 [ 2.71021925e-03]
 [ 5.61115348e-03]
 [ 1.22201035e-02]
 [ 2.70437778e-05]
 [ 5.71674254e-03]
 [-9.90327022e-03]
 [-2.00604782e-02]
 [ 1.02727153e-02]
 [-5.57300834e-03]
 [-7.78083870e-03]
 [ 4.20194601e-03]
 [ 5.34414207e-03]
 [-1.39322562e-03]
 [ 5.76380120e-03]
 [ 7.37950553e-03]
 [ 1.71581583e-02]
 [ 1.35791658e-02]
 [ 3.25475934e-02]
 [-1.88180519e-02]
 [-1.71799393e-03]
 [ 1.20670788e-02]
 [ 1.17143073e-02]
 [-5.23250755e-03]
 [ 1.27813730e-02]
 [-9.24828116e-03]
 [ 1.62565489e-03]
 [-8.14463504e-03]
 [-3.72832087e-03]
 [-1.60325929e-02]
 [ 1.54712084e-02]
 [ 1.95926443e-02]
 [-1.56175070e-02]
 [ 7.07070643e-03]
 [-2.58145437e-03]
 [ 5.31521600e-03]
 [ 4.80384012e-03]
 [-1.52045792e-02]
 [ 4.11313632e-02]
 [-1.69641420e-04]
 [ 5.35114710e-03]
 [-8.96974591e-03]
 [ 5.07428008e-04]
 [-6.02095538e-03]
 [-1.34543176e-02]
 [ 2.52865579e-04]
 [-2.77403814e-03]
 [ 2.39328666e-04]
 [-3.88482595e-03]
 [ 2.87218997e-03]
 [ 3.77215277e-03]
 [-1.63433468e-03]
 [ 1.34316814e-02]
 [ 8.94578595e-03]
 [ 3.62058346e-03]
 [ 1.22010657e-02]
 [ 1.30909575e-02]
 [-5.05740252e-03]
 [-5.17089304e-03]
 [-2.68505914e-02]
 [-1.29216161e-02]
 [-3.34879854e-03]
 [-7.08336242e-03]
 [ 1.14914220e-02]
 [ 9.09343695e-03]
 [ 1.81059635e-03]
 [ 1.34012308e-02]
 [-1.89681570e-02]
 [ 1.14593780e-02]
 [ 1.51430428e-03]
 [-4.31165772e-05]
 [ 7.67672802e-03]
 [-1.00880897e-03]
 [ 2.70817704e-03]
 [ 7.17229539e-03]
 [-1.23256068e-02]
 [-3.36054109e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.6986398]
curr_Stock_Price:  100.6190673566093
curr_Factors:  [100.61906736]
mat_Sqrt:  [[0.15]]
grads:  [-0.434814]
Stock Position:  -0.4348139986243353
Bond Position:  [55.44921881]


portfolio before change:  [11.81576213]
curr_Stock_Price:  100.3576759273529
curr_Factors:  [100.35767593]
mat_Sqrt:  [[0.15]]
grads:  [-0.01421157]
Stock Position:  -0.014211574402147749
Bond Position:  [13.24200271]


portfolio before change:  [11.8145251]
curr_Stock_Price:  100.50295784243502
curr_Factors:  [100.50295784]
mat_Sqrt:  [[0.15]]
grads:  [0.00228637]
Stock Position:  0.0022863696201818008
Bond Position:  [11.58473819]


portfolio before change:  [11.81673502]
curr_Stock_Price:  101.15282969309027
curr_Factors:  [101.15282969]
mat_Sqrt:  [[0.15]]
grads:  [0.01806813]
Stock Position:  0.018068128323440468
Bond Position:  [9.98909271]


portfolio before change:  [11.82665227]
curr_Stock_Price:  101.66715607903066
curr_Factors:  [101.66715608]
mat_Sqrt:  [[0.15]]
grads:  [0.03740769]
Stock Position:  0.037407689859698424
Bond Position:  [8.02351883]


portfolio before change:  [11.8356612]
curr_Stock_Price:  101.89458106776763
curr_Factors:  [101.89458107]
mat_Sqrt:  [[0.15]]
grads:  [0.08146736]
Stock Position:  0.08146735684214669
Bond Position:  [3.534579]


portfolio before change:  [11.80007473]
curr_Stock_Price:  101.45505055963788
curr_Factors:  [101.45505056]
mat_Sqrt:  [[0.15]]
grads:  [0.00018029]
Stock Position:  0.0001802918520440819
Bond Position:  [11.78178321]


portfolio before change:  [11.80082349]
curr_Stock_Price:  101.52368106227216
curr_Factors:  [101.52368106]
mat_Sqrt:  [[0.15]]
grads:  [0.03811162]
Stock Position:  0.03811161696202321
Bond Position:  [7.93159184]


portfolio before change:  [11.81672553]
curr_Stock_Price:  101.92792275132965
curr_Factors:  [101.92792275]
mat_Sqrt:  [[0.15]]
grads:  [-0.0660218]
Stock Position:  -0.06602180143872585
Bond Position:  [18.54619061]


portfolio before change:  [11.87634155]
curr_Stock_Price:  101.04250546631481
curr_Factors:  [101.04250547]
mat_Sqrt:  [[0.15]]
grads:  [-0.13373652]
Stock Position:  -0.13373652148320986
Bond Position:  [25.38941475]


portfolio before change:  [11.92097584]
curr_Stock_Price:  100.72062329798565
curr_Factors:  [100.7206233]
mat_Sqrt:  [[0.15]]
grads:  [0.06848477]
Stock Position:  0.06848476847903634
Bond Position:  [5.02314727]


portfolio before change:  [11.89830233]
curr_Stock_Price:  100.38496521575709
curr_Factors:  [100.38496522]
mat_Sqrt:  [[0.15]]
grads:  [-0.03715339]
Stock Position:  -0.037153388925827105
Bond Position:  [15.62794398]


portfolio before change:  [11.90743925]
curr_Stock_Price:  100.16533130832917
curr_Factors:  [100.16533131]
mat_Sqrt:  [[0.15]]
grads:  [-0.05187226]
Stock Position:  -0.0518722579782673
Bond Position:  [17.10324115]


portfolio before change:  [11.87464686]
curr_Stock_Price:  100.81811521736142
curr_Factors:  [100.81811522]
mat_Sqrt:  [[0.15]]
grads:  [0.02801297]
Stock Position:  0.028012973367208885
Bond Position:  [9.05043168]


portfolio before change:  [11.87216015]
curr_Stock_Price:  100.70915207463447
curr_Factors:  [100.70915207]
mat_Sqrt:  [[0.15]]
grads:  [0.03562761]
Stock Position:  0.035627613805657966
Bond Position:  [8.28413337]


portfolio before change:  [11.85324137]
curr_Stock_Price:  100.16360462602131
curr_Factors:  [100.16360463]
mat_Sqrt:  [[0.15]]
grads:  [-0.00928817]
Stock Position:  -0.00928817081131009
Bond Position:  [12.78357804]


portfolio before change:  [11.85722675]
curr_Stock_Price:  99.82054656509078
curr_Factors:  [99.82054657]
mat_Sqrt:  [[0.15]]
grads:  [0.03842534]
Stock Position:  0.03842534131949081
Bond Position:  [8.02158818]


portfolio before change:  [11.8440216]
curr_Stock_Price:  99.46384139582716
curr_Factors:  [99.4638414]
mat_Sqrt:  [[0.15]]
grads:  [0.0491967]
Stock Position:  0.049196703503339045
Bond Position:  [6.95072848]


portfolio before change:  [11.81165507]
curr_Stock_Price:  98.79711061542997
curr_Factors:  [98.79711062]
mat_Sqrt:  [[0.15]]
grads:  [0.11438772]
Stock Position:  0.11438772171294509
Bond Position:  [0.51047868]


portfolio before change:  [11.78539008]
curr_Stock_Price:  98.56721796500024
curr_Factors:  [98.56721797]
mat_Sqrt:  [[0.15]]
grads:  [0.09052777]
Stock Position:  0.09052777225672291
Bond Position:  [2.86231942]


portfolio before change:  [11.79170184]
curr_Stock_Price:  98.63496351599744
curr_Factors:  [98.63496352]
mat_Sqrt:  [[0.15]]
grads:  [0.21698396]
Stock Position:  0.21698395584502064
Bond Position:  [-9.61050273]


portfolio before change:  [11.78959203]
curr_Stock_Price:  98.6280084832319
curr_Factors:  [98.62800848]
mat_Sqrt:  [[0.15]]
grads:  [-0.12545368]
Stock Position:  -0.1254536793153592
Bond Position:  [24.16283858]


portfolio before change:  [11.69821151]
curr_Stock_Price:  99.36844710839699
curr_Factors:  [99.36844711]
mat_Sqrt:  [[0.15]]
grads:  [-0.01145329]
Stock Position:  -0.011453292836691996
Bond Position:  [12.83630743]


portfolio before change:  [11.69253929]
curr_Stock_Price:  99.93374427727822
curr_Factors:  [99.93374428]
mat_Sqrt:  [[0.15]]
grads:  [0.08044719]
Stock Position:  0.08044719225479278
Bond Position:  [3.65315015]


portfolio before change:  [11.67715672]
curr_Stock_Price:  99.73969285099471
curr_Factors:  [99.73969285]
mat_Sqrt:  [[0.15]]
grads:  [0.07809538]
Stock Position:  0.07809538175555061
Bond Position:  [3.88794733]


portfolio before change:  [11.68146816]
curr_Stock_Price:  99.79178854354082
curr_Factors:  [99.79178854]
mat_Sqrt:  [[0.15]]
grads:  [-0.03488338]
Stock Position:  -0.034883383651770794
Bond Position:  [15.1625434]


portfolio before change:  [11.69046374]
curr_Stock_Price:  99.56108007781981
curr_Factors:  [99.56108008]
mat_Sqrt:  [[0.15]]
grads:  [0.08520915]
Stock Position:  0.0852091535575863
Bond Position:  [3.20694838]


portfolio before change:  [11.65453335]
curr_Stock_Price:  99.13705482535742
curr_Factors:  [99.13705483]
mat_Sqrt:  [[0.15]]
grads:  [-0.06165521]
Stock Position:  -0.06165520773296032
Bond Position:  [17.76684906]


portfolio before change:  [11.71259124]
curr_Stock_Price:  98.2134113966504
curr_Factors:  [98.2134114]
mat_Sqrt:  [[0.15]]
grads:  [0.0108377]
Stock Position:  0.010837699278242532
Bond Position:  [10.64818382]


portfolio before change:  [11.71424561]
curr_Stock_Price:  98.30465176748795
curr_Factors:  [98.30465177]
mat_Sqrt:  [[0.15]]
grads:  [-0.05429757]
Stock Position:  -0.0542975669233198
Bond Position:  [17.05194901]


portfolio before change:  [11.69540903]
curr_Stock_Price:  98.67119409872615
curr_Factors:  [98.6711941]
mat_Sqrt:  [[0.15]]
grads:  [-0.02485547]
Stock Position:  -0.024855472499612924
Bond Position:  [14.14792818]


portfolio before change:  [11.70649466]
curr_Stock_Price:  98.26076709796129
curr_Factors:  [98.2607671]
mat_Sqrt:  [[0.15]]
grads:  [-0.10688395]
Stock Position:  -0.10688395261491429
Bond Position:  [22.20899383]


portfolio before change:  [11.63136509]
curr_Stock_Price:  98.97666199939925
curr_Factors:  [98.976662]
mat_Sqrt:  [[0.15]]
grads:  [0.10314139]
Stock Position:  0.10314138953655644
Bond Position:  [1.42277464]


portfolio before change:  [11.66473446]
curr_Stock_Price:  99.29933023557408
curr_Factors:  [99.29933024]
mat_Sqrt:  [[0.15]]
grads:  [0.13061763]
Stock Position:  0.1306176285047404
Bond Position:  [-1.30550856]


portfolio before change:  [11.56888246]
curr_Stock_Price:  98.5661182803099
curr_Factors:  [98.56611828]
mat_Sqrt:  [[0.15]]
grads:  [-0.10411671]
Stock Position:  -0.10411671365057883
Bond Position:  [21.83126277]


portfolio before change:  [11.62385681]
curr_Stock_Price:  98.05121676608113
curr_Factors:  [98.05121677]
mat_Sqrt:  [[0.15]]
grads:  [0.04713804]
Stock Position:  0.04713804285660112
Bond Position:  [7.00191435]


portfolio before change:  [11.62260281]
curr_Stock_Price:  98.015330012451
curr_Factors:  [98.01533001]
mat_Sqrt:  [[0.15]]
grads:  [-0.0172097]
Stock Position:  -0.017209695802318077
Bond Position:  [13.30941683]


portfolio before change:  [11.62582165]
curr_Stock_Price:  97.87663098143595
curr_Factors:  [97.87663098]
mat_Sqrt:  [[0.15]]
grads:  [0.03543477]
Stock Position:  0.0354347733236119
Bond Position:  [8.15758541]


portfolio before change:  [11.60785446]
curr_Stock_Price:  97.3551925092882
curr_Factors:  [97.35519251]
mat_Sqrt:  [[0.15]]
grads:  [0.0320256]
Stock Position:  0.032025600807377735
Bond Position:  [8.48999593]


portfolio before change:  [11.62268665]
curr_Stock_Price:  97.80175874841392
curr_Factors:  [97.80175875]
mat_Sqrt:  [[0.15]]
grads:  [-0.10136386]
Stock Position:  -0.10136386110770726
Bond Position:  [21.53625054]


portfolio before change:  [11.68549945]
curr_Stock_Price:  97.1953617227202
curr_Factors:  [97.19536172]
mat_Sqrt:  [[0.15]]
grads:  [0.27420909]
Stock Position:  0.2742090878904242
Bond Position:  [-14.96635203]


portfolio before change:  [11.72230669]
curr_Stock_Price:  97.33300363166803
curr_Factors:  [97.33300363]
mat_Sqrt:  [[0.15]]
grads:  [-0.00113094]
Stock Position:  -0.00113094280101226
Bond Position:  [11.83238475]


portfolio before change:  [11.72286426]
curr_Stock_Price:  97.4939076719403
curr_Factors:  [97.49390767]
mat_Sqrt:  [[0.15]]
grads:  [0.03567431]
Stock Position:  0.0356743140191299
Bond Position:  [8.24483598]


portfolio before change:  [11.70314445]
curr_Stock_Price:  96.9266890820091
curr_Factors:  [96.92668908]
mat_Sqrt:  [[0.15]]
grads:  [-0.05979831]
Stock Position:  -0.05979830606016334
Bond Position:  [17.49919627]


portfolio before change:  [11.6829319]
curr_Stock_Price:  97.28299143595875
curr_Factors:  [97.28299144]
mat_Sqrt:  [[0.15]]
grads:  [0.00338285]
Stock Position:  0.0033828533835874868
Bond Position:  [11.35383781]


portfolio before change:  [11.6840678]
curr_Stock_Price:  97.40899619047377
curr_Factors:  [97.40899619]
mat_Sqrt:  [[0.15]]
grads:  [-0.0401397]
Stock Position:  -0.040139702511631424
Bond Position:  [15.59403592]


portfolio before change:  [11.70630095]
curr_Stock_Price:  96.87938358531052
curr_Factors:  [96.87938359]
mat_Sqrt:  [[0.15]]
grads:  [-0.08969545]
Stock Position:  -0.08969545091108325
Bond Position:  [20.39594094]


portfolio before change:  [11.75009849]
curr_Stock_Price:  96.40530424220523
curr_Factors:  [96.40530424]
mat_Sqrt:  [[0.15]]
grads:  [0.00168577]
Stock Position:  0.001685770524564445
Bond Position:  [11.58758127]


portfolio before change:  [11.7516887]
curr_Stock_Price:  96.91899320946402
curr_Factors:  [96.91899321]
mat_Sqrt:  [[0.15]]
grads:  [-0.01849359]
Stock Position:  -0.018493587621198012
Bond Position:  [13.54406859]


portfolio before change:  [11.75353108]
curr_Stock_Price:  96.86514482847775
curr_Factors:  [96.86514483]
mat_Sqrt:  [[0.15]]
grads:  [0.00159552]
Stock Position:  0.0015955244407648943
Bond Position:  [11.59898037]


portfolio before change:  [11.75337725]
curr_Stock_Price:  96.31436198118803
curr_Factors:  [96.31436198]
mat_Sqrt:  [[0.15]]
grads:  [-0.02589884]
Stock Position:  -0.02589883965493591
Bond Position:  [14.24780747]


portfolio before change:  [11.76387063]
curr_Stock_Price:  95.94357845420058
curr_Factors:  [95.94357845]
mat_Sqrt:  [[0.15]]
grads:  [0.01914793]
Stock Position:  0.019147933119571393
Bond Position:  [9.92674941]


portfolio before change:  [11.75391034]
curr_Stock_Price:  95.39099990785301
curr_Factors:  [95.39099991]
mat_Sqrt:  [[0.15]]
grads:  [0.02514769]
Stock Position:  0.025147685111417125
Bond Position:  [9.35504751]


portfolio before change:  [11.74071339]
curr_Stock_Price:  94.8429710892695
curr_Factors:  [94.84297109]
mat_Sqrt:  [[0.15]]
grads:  [-0.01089556]
Stock Position:  -0.010895564536761163
Bond Position:  [12.7740811]


portfolio before change:  [11.73887255]
curr_Stock_Price:  95.08520218563089
curr_Factors:  [95.08520219]
mat_Sqrt:  [[0.15]]
grads:  [0.08954454]
Stock Position:  0.08954454252937455
Bond Position:  [3.22451162]


portfolio before change:  [11.70626476]
curr_Stock_Price:  94.71879989477952
curr_Factors:  [94.71879989]
mat_Sqrt:  [[0.15]]
grads:  [0.05963857]
Stock Position:  0.05963857301896569
Bond Position:  [6.0573707]


portfolio before change:  [11.72699593]
curr_Stock_Price:  95.06006505118961
curr_Factors:  [95.06006505]
mat_Sqrt:  [[0.15]]
grads:  [0.02413722]
Stock Position:  0.02413722304834876
Bond Position:  [9.43250993]


portfolio before change:  [11.72211415]
curr_Stock_Price:  94.83338912558459
curr_Factors:  [94.83338913]
mat_Sqrt:  [[0.15]]
grads:  [0.08134044]
Stock Position:  0.0813404377824138
Bond Position:  [4.00832476]


portfolio before change:  [11.71050606]
curr_Stock_Price:  94.6875991511272
curr_Factors:  [94.68759915]
mat_Sqrt:  [[0.15]]
grads:  [0.08727305]
Stock Position:  0.08727304975568627
Bond Position:  [3.4468305]


portfolio before change:  [11.75043308]
curr_Stock_Price:  95.1426261157567
curr_Factors:  [95.14262612]
mat_Sqrt:  [[0.15]]
grads:  [-0.03371602]
Stock Position:  -0.03371601679803174
Bond Position:  [14.95826346]


portfolio before change:  [11.75357454]
curr_Stock_Price:  95.07718143996424
curr_Factors:  [95.07718144]
mat_Sqrt:  [[0.15]]
grads:  [-0.03447262]
Stock Position:  -0.03447262025907733
Bond Position:  [15.03113411]


portfolio before change:  [11.75362376]
curr_Stock_Price:  95.10300632567068
curr_Factors:  [95.10300633]
mat_Sqrt:  [[0.15]]
grads:  [-0.17900394]
Stock Position:  -0.17900394274034848
Bond Position:  [28.77743686]


portfolio before change:  [11.86856367]
curr_Stock_Price:  94.47094613323867
curr_Factors:  [94.47094613]
mat_Sqrt:  [[0.15]]
grads:  [-0.08614411]
Stock Position:  -0.0861441070997938
Bond Position:  [20.00667897]


portfolio before change:  [11.86500505]
curr_Stock_Price:  94.52677209051015
curr_Factors:  [94.52677209]
mat_Sqrt:  [[0.15]]
grads:  [-0.02232532]
Stock Position:  -0.022325323613350035
Bond Position:  [13.97534583]


portfolio before change:  [11.85032353]
curr_Stock_Price:  95.22351498243202
curr_Factors:  [95.22351498]
mat_Sqrt:  [[0.15]]
grads:  [-0.04722242]
Stock Position:  -0.04722241611271977
Bond Position:  [16.34700798]


portfolio before change:  [11.83235572]
curr_Stock_Price:  95.62564438511593
curr_Factors:  [95.62564439]
mat_Sqrt:  [[0.15]]
grads:  [0.07660948]
Stock Position:  0.07660947983536975
Bond Position:  [4.50652485]


portfolio before change:  [11.88232581]
curr_Stock_Price:  96.27423793907076
curr_Factors:  [96.27423794]
mat_Sqrt:  [[0.15]]
grads:  [0.06062291]
Stock Position:  0.06062291297745719
Bond Position:  [6.04590106]


portfolio before change:  [11.87781325]
curr_Stock_Price:  96.19356821295762
curr_Factors:  [96.19356821]
mat_Sqrt:  [[0.15]]
grads:  [0.01207064]
Stock Position:  0.0120706423085003
Bond Position:  [10.7166951]


portfolio before change:  [11.87859459]
curr_Stock_Price:  96.20280701739524
curr_Factors:  [96.20280702]
mat_Sqrt:  [[0.15]]
grads:  [0.08934154]
Stock Position:  0.0893415389821337
Bond Position:  [3.28368775]


portfolio before change:  [11.83600803]
curr_Stock_Price:  95.72383841401732
curr_Factors:  [95.72383841]
mat_Sqrt:  [[0.15]]
grads:  [-0.12645438]
Stock Position:  -0.12645438008512075
Bond Position:  [23.94070668]


portfolio before change:  [11.77036663]
curr_Stock_Price:  96.254763050037
curr_Factors:  [96.25476305]
mat_Sqrt:  [[0.15]]
grads:  [0.07639585]
Stock Position:  0.07639585322822466
Bond Position:  [4.41690188]


portfolio before change:  [11.81712261]
curr_Stock_Price:  96.86317194167279
curr_Factors:  [96.86317194]
mat_Sqrt:  [[0.15]]
grads:  [0.01009536]
Stock Position:  0.01009536188686034
Bond Position:  [10.83925383]


portfolio before change:  [11.82592659]
curr_Stock_Price:  97.66814656428875
curr_Factors:  [97.66814656]
mat_Sqrt:  [[0.15]]
grads:  [-0.00028744]
Stock Position:  -0.000287443847930011
Bond Position:  [11.8540007]


portfolio before change:  [11.82705284]
curr_Stock_Price:  96.32752399250047
curr_Factors:  [96.32752399]
mat_Sqrt:  [[0.15]]
grads:  [0.05117819]
Stock Position:  0.05117818681150583
Bond Position:  [6.89718483]


portfolio before change:  [11.85953496]
curr_Stock_Price:  96.9537874993454
curr_Factors:  [96.9537875]
mat_Sqrt:  [[0.15]]
grads:  [-0.00672539]
Stock Position:  -0.006725393111858917
Bond Position:  [12.5115873]


portfolio before change:  [11.86152174]
curr_Stock_Price:  96.77464911560287
curr_Factors:  [96.77464912]
mat_Sqrt:  [[0.15]]
grads:  [0.01805451]
Stock Position:  0.018054513578223106
Bond Position:  [10.11430252]


portfolio before change:  [11.85327468]
curr_Stock_Price:  96.28284841823313
curr_Factors:  [96.28284842]
mat_Sqrt:  [[0.15]]
grads:  [0.0478153]
Stock Position:  0.047815302610858076
Bond Position:  [7.24948114]


portfolio before change:  [11.83144788]
curr_Stock_Price:  95.8168908901945
curr_Factors:  [95.81689089]
mat_Sqrt:  [[0.15]]
grads:  [-0.08217071]
Stock Position:  -0.08217071180012672
Bond Position:  [19.70479001]


portfolio before change:  [11.77107664]
curr_Stock_Price:  96.56658420213579
curr_Factors:  [96.5665842]
mat_Sqrt:  [[0.15]]
grads:  [-0.22403607]
Stock Position:  -0.2240360726925544
Bond Position:  [33.40547492]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.77107664]
Stock Price:  96.46672216118664
PL:  [11.77107664]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-5.97847754e-02]
 [ 7.75580748e-04]
 [ 1.55353840e-02]
 [ 3.73866538e-03]
 [-2.74158862e-03]
 [ 1.23092252e-02]
 [-8.76722664e-04]
 [ 1.59698631e-02]
 [-1.29101090e-02]
 [-6.83991716e-03]
 [ 9.95896625e-03]
 [-9.29020279e-03]
 [ 1.81886268e-02]
 [ 5.02885885e-03]
 [-3.13644269e-03]
 [-9.33799424e-03]
 [ 1.21383044e-02]
 [ 1.95408172e-02]
 [ 1.97494033e-02]
 [ 7.65457013e-04]
 [ 6.94330214e-02]
 [-1.30753726e-02]
 [ 6.39444773e-03]
 [ 3.14747251e-03]
 [ 1.37272153e-02]
 [ 3.26064666e-03]
 [ 1.30614126e-02]
 [ 3.83586690e-03]
 [ 4.45868115e-03]
 [-2.05975609e-02]
 [-5.69043736e-03]
 [ 3.97177816e-02]
 [ 4.54914727e-03]
 [-6.72735525e-03]
 [-5.76327938e-03]
 [-4.77100969e-03]
 [-4.48162710e-03]
 [ 1.54651374e-03]
 [ 3.25606398e-03]
 [-8.71214969e-03]
 [-2.51112965e-02]
 [-2.61847322e-03]
 [ 6.75274308e-03]
 [-1.13646747e-02]
 [ 2.69912627e-03]
 [-3.99551020e-04]
 [-1.37055849e-02]
 [-5.09322665e-03]
 [-1.53577844e-03]
 [ 3.41251623e-03]
 [-2.98172951e-03]
 [ 3.65993097e-03]
 [ 7.16685036e-04]
 [-2.32730042e-03]
 [ 2.32293281e-03]
 [ 9.00891653e-03]
 [ 1.18102197e-02]
 [-2.78769026e-02]
 [ 1.40703392e-02]
 [ 8.55482515e-03]
 [ 5.26992418e-03]
 [-1.24981481e-02]
 [-1.25414573e-02]
 [-2.21174918e-03]
 [-1.64320950e-02]
 [ 4.22208182e-02]
 [ 2.02901007e-02]
 [ 1.70904051e-03]
 [ 6.15650499e-03]
 [-1.40625690e-02]
 [-7.55314384e-03]
 [-1.22378292e-03]
 [ 2.02147409e-03]
 [ 8.81888279e-03]
 [ 1.26631331e-02]
 [-8.45623663e-03]
 [-2.62859330e-03]
 [-8.61615195e-03]
 [-1.35777872e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.40278185]
curr_Stock_Price:  100.53578171133088
curr_Factors:  [100.53578171]
mat_Sqrt:  [[0.15]]
grads:  [-0.39856517]
Stock Position:  -0.3985651694538795
Bond Position:  [50.47284272]


portfolio before change:  [10.23637565]
curr_Stock_Price:  100.96120986397773
curr_Factors:  [100.96120986]
mat_Sqrt:  [[0.15]]
grads:  [0.00517054]
Stock Position:  0.005170538321208144
Bond Position:  [9.71435185]


portfolio before change:  [10.24291926]
curr_Stock_Price:  102.10933794345952
curr_Factors:  [102.10933794]
mat_Sqrt:  [[0.15]]
grads:  [0.10356923]
Stock Position:  0.10356922658290445
Bond Position:  [-0.3324659]


portfolio before change:  [10.26341084]
curr_Stock_Price:  102.30739257413275
curr_Factors:  [102.30739257]
mat_Sqrt:  [[0.15]]
grads:  [0.02492444]
Stock Position:  0.02492443588105281
Bond Position:  [7.7134568]


portfolio before change:  [10.2614063]
curr_Stock_Price:  102.20762500441475
curr_Factors:  [102.207625]
mat_Sqrt:  [[0.15]]
grads:  [-0.01827726]
Stock Position:  -0.0182772574898658
Bond Position:  [12.12948138]


portfolio before change:  [10.26227491]
curr_Stock_Price:  102.2015795453404
curr_Factors:  [102.20157955]
mat_Sqrt:  [[0.15]]
grads:  [0.0820615]
Stock Position:  0.08206150126805623
Bond Position:  [1.87545986]


portfolio before change:  [10.28220383]
curr_Stock_Price:  102.44300461186035
curr_Factors:  [102.44300461]
mat_Sqrt:  [[0.15]]
grads:  [-0.00584482]
Stock Position:  -0.005844817762067496
Bond Position:  [10.88096453]


portfolio before change:  [10.28251334]
curr_Stock_Price:  102.50640760547076
curr_Factors:  [102.50640761]
mat_Sqrt:  [[0.15]]
grads:  [0.10646575]
Stock Position:  0.10646575406993672
Bond Position:  [-0.63090865]


portfolio before change:  [10.26593638]
curr_Stock_Price:  102.35107577524342
curr_Factors:  [102.35107578]
mat_Sqrt:  [[0.15]]
grads:  [-0.08606739]
Stock Position:  -0.08606739350748004
Bond Position:  [19.0750267]


portfolio before change:  [10.31188074]
curr_Stock_Price:  101.8311096503068
curr_Factors:  [101.83110965]
mat_Sqrt:  [[0.15]]
grads:  [-0.04559945]
Stock Position:  -0.04559944772365768
Bond Position:  [14.9553231]


portfolio before change:  [10.30297811]
curr_Stock_Price:  102.04684399480091
curr_Factors:  [102.04684399]
mat_Sqrt:  [[0.15]]
grads:  [0.06639311]
Stock Position:  0.06639310833476535
Bond Position:  [3.52777094]


portfolio before change:  [10.28768777]
curr_Stock_Price:  101.81322286956005
curr_Factors:  [101.81322287]
mat_Sqrt:  [[0.15]]
grads:  [-0.06193469]
Stock Position:  -0.061934685239796845
Bond Position:  [16.59345768]


portfolio before change:  [10.28519296]
curr_Stock_Price:  101.87024965494278
curr_Factors:  [101.87024965]
mat_Sqrt:  [[0.15]]
grads:  [0.12125751]
Stock Position:  0.1212575122340058
Bond Position:  [-2.06734009]


portfolio before change:  [10.26951562]
curr_Stock_Price:  101.74202562478489
curr_Factors:  [101.74202562]
mat_Sqrt:  [[0.15]]
grads:  [0.03352573]
Stock Position:  0.033525725694814275
Bond Position:  [6.85854037]


portfolio before change:  [10.28607652]
curr_Stock_Price:  102.22321538860794
curr_Factors:  [102.22321539]
mat_Sqrt:  [[0.15]]
grads:  [-0.02090962]
Stock Position:  -0.02090961792158695
Bond Position:  [12.4235249]


portfolio before change:  [10.27958895]
curr_Stock_Price:  102.57061860593124
curr_Factors:  [102.57061861]
mat_Sqrt:  [[0.15]]
grads:  [-0.06225329]
Stock Position:  -0.0622532949285048
Bond Position:  [16.66494792]


portfolio before change:  [10.35641616]
curr_Stock_Price:  101.35324341979208
curr_Factors:  [101.35324342]
mat_Sqrt:  [[0.15]]
grads:  [0.08092203]
Stock Position:  0.08092202947699953
Bond Position:  [2.15470601]


portfolio before change:  [10.33464474]
curr_Stock_Price:  101.08253723220328
curr_Factors:  [101.08253723]
mat_Sqrt:  [[0.15]]
grads:  [0.13027211]
Stock Position:  0.13027211497627164
Bond Position:  [-2.83359117]


portfolio before change:  [10.32189711]
curr_Stock_Price:  100.98604284943845
curr_Factors:  [100.98604285]
mat_Sqrt:  [[0.15]]
grads:  [0.13166269]
Stock Position:  0.13166268883901674
Bond Position:  [-2.97419683]


portfolio before change:  [10.34062042]
curr_Stock_Price:  101.1296614484742
curr_Factors:  [101.12966145]
mat_Sqrt:  [[0.15]]
grads:  [0.00510305]
Stock Position:  0.005103046750501098
Bond Position:  [9.82455103]


portfolio before change:  [10.34164067]
curr_Stock_Price:  101.20925914289568
curr_Factors:  [101.20925914]
mat_Sqrt:  [[0.15]]
grads:  [0.46288681]
Stock Position:  0.46288680937077065
Bond Position:  [-36.50679038]


portfolio before change:  [10.40672741]
curr_Stock_Price:  101.35479901625409
curr_Factors:  [101.35479902]
mat_Sqrt:  [[0.15]]
grads:  [-0.08716915]
Stock Position:  -0.08716915037368593
Bond Position:  [19.24173913]


portfolio before change:  [10.41437028]
curr_Stock_Price:  101.28091710426004
curr_Factors:  [101.2809171]
mat_Sqrt:  [[0.15]]
grads:  [0.04262965]
Stock Position:  0.04262965155765782
Bond Position:  [6.09680007]


portfolio before change:  [10.40153904]
curr_Stock_Price:  100.97098500547966
curr_Factors:  [100.97098501]
mat_Sqrt:  [[0.15]]
grads:  [0.02098315]
Stock Position:  0.020983150071232512
Bond Position:  [8.28284971]


portfolio before change:  [10.38743875]
curr_Stock_Price:  100.2743312723928
curr_Factors:  [100.27433127]
mat_Sqrt:  [[0.15]]
grads:  [0.09151477]
Stock Position:  0.09151476862655224
Bond Position:  [1.21085652]


portfolio before change:  [10.46021981]
curr_Stock_Price:  101.06879734903166
curr_Factors:  [101.06879735]
mat_Sqrt:  [[0.15]]
grads:  [0.02173764]
Stock Position:  0.021737644404307595
Bond Position:  [8.26322223]


portfolio before change:  [10.44956972]
curr_Stock_Price:  100.55510085907699
curr_Factors:  [100.55510086]
mat_Sqrt:  [[0.15]]
grads:  [0.08707608]
Stock Position:  0.08707608384900652
Bond Position:  [1.69362533]


portfolio before change:  [10.53990152]
curr_Stock_Price:  101.5912745100122
curr_Factors:  [101.59127451]
mat_Sqrt:  [[0.15]]
grads:  [0.02557245]
Stock Position:  0.025572445990063333
Bond Position:  [7.94196414]


portfolio before change:  [10.53450091]
curr_Stock_Price:  101.36067479880221
curr_Factors:  [101.3606748]
mat_Sqrt:  [[0.15]]
grads:  [0.02972454]
Stock Position:  0.029724540991228583
Bond Position:  [7.52160138]


portfolio before change:  [10.55111868]
curr_Stock_Price:  101.90391805751509
curr_Factors:  [101.90391806]
mat_Sqrt:  [[0.15]]
grads:  [-0.13731707]
Stock Position:  -0.13731707240817617
Bond Position:  [24.54426638]


portfolio before change:  [10.46842241]
curr_Stock_Price:  102.51731842917421
curr_Factors:  [102.51731843]
mat_Sqrt:  [[0.15]]
grads:  [-0.03793625]
Stock Position:  -0.037936249033991176
Bond Position:  [14.35754493]


portfolio before change:  [10.44067431]
curr_Stock_Price:  103.27241335177172
curr_Factors:  [103.27241335]
mat_Sqrt:  [[0.15]]
grads:  [0.26478521]
Stock Position:  0.26478521090191165
Bond Position:  [-16.90433344]


portfolio before change:  [10.64074577]
curr_Stock_Price:  104.03200265266729
curr_Factors:  [104.03200265]
mat_Sqrt:  [[0.15]]
grads:  [0.03032765]
Stock Position:  0.03032764844494011
Bond Position:  [7.48569977]


portfolio before change:  [10.64095245]
curr_Stock_Price:  104.02339019165731
curr_Factors:  [104.02339019]
mat_Sqrt:  [[0.15]]
grads:  [-0.04484903]
Stock Position:  -0.04484903496961159
Bond Position:  [15.30630111]


portfolio before change:  [10.63807041]
curr_Stock_Price:  104.1089820130425
curr_Factors:  [104.10898201]
mat_Sqrt:  [[0.15]]
grads:  [-0.03842186]
Stock Position:  -0.03842186255076496
Bond Position:  [14.63813141]


portfolio before change:  [10.63967997]
curr_Stock_Price:  104.09090249596424
curr_Factors:  [104.0909025]
mat_Sqrt:  [[0.15]]
grads:  [-0.03180673]
Stock Position:  -0.03180673128872752
Bond Position:  [13.95047133]


portfolio before change:  [10.65287131]
curr_Stock_Price:  103.70358179257178
curr_Factors:  [103.70358179]
mat_Sqrt:  [[0.15]]
grads:  [-0.02987751]
Stock Position:  -0.02987751398118428
Bond Position:  [13.75127652]


portfolio before change:  [10.64444822]
curr_Stock_Price:  104.01426911233354
curr_Factors:  [104.01426911]
mat_Sqrt:  [[0.15]]
grads:  [0.01031009]
Stock Position:  0.01031009161336535
Bond Position:  [9.57205158]


portfolio before change:  [10.63818569]
curr_Stock_Price:  103.34882381524041
curr_Factors:  [103.34882382]
mat_Sqrt:  [[0.15]]
grads:  [0.02170709]
Stock Position:  0.021707093230390682
Bond Position:  [8.39478314]


portfolio before change:  [10.61031413]
curr_Stock_Price:  102.04066853205865
curr_Factors:  [102.04066853]
mat_Sqrt:  [[0.15]]
grads:  [-0.058081]
Stock Position:  -0.058080997912880045
Bond Position:  [16.53693799]


portfolio before change:  [10.61606234]
curr_Stock_Price:  101.95949547426804
curr_Factors:  [101.95949547]
mat_Sqrt:  [[0.15]]
grads:  [-0.16740864]
Stock Position:  -0.16740864338354372
Bond Position:  [27.68496316]


portfolio before change:  [10.70841105]
curr_Stock_Price:  101.41819517526389
curr_Factors:  [101.41819518]
mat_Sqrt:  [[0.15]]
grads:  [-0.01745649]
Stock Position:  -0.017456488115732707
Bond Position:  [12.47881657]


portfolio before change:  [10.72756832]
curr_Stock_Price:  100.36544489265151
curr_Factors:  [100.36544489]
mat_Sqrt:  [[0.15]]
grads:  [0.04501829]
Stock Position:  0.045018287195301245
Bond Position:  [6.2092879]


portfolio before change:  [10.71016679]
curr_Stock_Price:  99.97028045218603
curr_Factors:  [99.97028045]
mat_Sqrt:  [[0.15]]
grads:  [-0.0757645]
Stock Position:  -0.07576449818962382
Bond Position:  [18.28436492]


portfolio before change:  [10.70282296]
curr_Stock_Price:  100.08229379684539
curr_Factors:  [100.0822938]
mat_Sqrt:  [[0.15]]
grads:  [0.01799418]
Stock Position:  0.017994175109961555
Bond Position:  [8.90192464]


portfolio before change:  [10.70656902]
curr_Stock_Price:  100.25955484752183
curr_Factors:  [100.25955485]
mat_Sqrt:  [[0.15]]
grads:  [-0.00266367]
Stock Position:  -0.002663673466601047
Bond Position:  [10.97362773]


portfolio before change:  [10.70739079]
curr_Stock_Price:  100.20853542499918
curr_Factors:  [100.20853542]
mat_Sqrt:  [[0.15]]
grads:  [-0.09137057]
Stock Position:  -0.09137056602965421
Bond Position:  [19.86350139]


portfolio before change:  [10.65497894]
curr_Stock_Price:  100.79574156659513
curr_Factors:  [100.79574157]
mat_Sqrt:  [[0.15]]
grads:  [-0.03395484]
Stock Position:  -0.03395484434106466
Bond Position:  [14.07748266]


portfolio before change:  [10.67198637]
curr_Stock_Price:  100.32077075107905
curr_Factors:  [100.32077075]
mat_Sqrt:  [[0.15]]
grads:  [-0.01023852]
Stock Position:  -0.010238522928982573
Bond Position:  [11.69912288]


portfolio before change:  [10.66633972]
curr_Stock_Price:  100.94369958110117
curr_Factors:  [100.94369958]
mat_Sqrt:  [[0.15]]
grads:  [0.02275011]
Stock Position:  0.022750108199227684
Bond Position:  [8.36985963]


portfolio before change:  [10.65291465]
curr_Stock_Price:  100.33059461402864
curr_Factors:  [100.33059461]
mat_Sqrt:  [[0.15]]
grads:  [-0.0198782]
Stock Position:  -0.019878196706154566
Bond Position:  [12.64730594]


portfolio before change:  [10.66099773]
curr_Stock_Price:  99.96373002331566
curr_Factors:  [99.96373002]
mat_Sqrt:  [[0.15]]
grads:  [0.02439954]
Stock Position:  0.02439953980110637
Bond Position:  [8.22192872]


portfolio before change:  [10.6741594]
curr_Stock_Price:  100.48209123307598
curr_Factors:  [100.48209123]
mat_Sqrt:  [[0.15]]
grads:  [0.0047779]
Stock Position:  0.004777900241188016
Bond Position:  [10.19406599]


portfolio before change:  [10.67193028]
curr_Stock_Price:  99.88219059503513
curr_Factors:  [99.8821906]
mat_Sqrt:  [[0.15]]
grads:  [-0.01551534]
Stock Position:  -0.01551533612664631
Bond Position:  [12.22163604]


portfolio before change:  [10.67401202]
curr_Stock_Price:  99.79725100633895
curr_Factors:  [99.79725101]
mat_Sqrt:  [[0.15]]
grads:  [0.01548622]
Stock Position:  0.015486218715757116
Bond Position:  [9.12852997]


portfolio before change:  [10.67374905]
curr_Stock_Price:  99.74342754202918
curr_Factors:  [99.74342754]
mat_Sqrt:  [[0.15]]
grads:  [0.06005944]
Stock Position:  0.06005944351875736
Bond Position:  [4.6832143]


portfolio before change:  [10.68386046]
curr_Stock_Price:  99.90691058323328
curr_Factors:  [99.90691058]
mat_Sqrt:  [[0.15]]
grads:  [0.0787348]
Stock Position:  0.07873479810699284
Bond Position:  [2.81771003]


portfolio before change:  [10.6698895]
curr_Stock_Price:  99.72723049575671
curr_Factors:  [99.7272305]
mat_Sqrt:  [[0.15]]
grads:  [-0.18584602]
Stock Position:  -0.18584601726071417
Bond Position:  [29.2037981]


portfolio before change:  [10.60473125]
curr_Stock_Price:  100.08765546614731
curr_Factors:  [100.08765547]
mat_Sqrt:  [[0.15]]
grads:  [0.09380226]
Stock Position:  0.09380226117657671
Bond Position:  [1.21628285]


portfolio before change:  [10.6272332]
curr_Stock_Price:  100.32673215789424
curr_Factors:  [100.32673216]
mat_Sqrt:  [[0.15]]
grads:  [0.05703217]
Stock Position:  0.05703216768594353
Bond Position:  [4.90538219]


portfolio before change:  [10.55980077]
curr_Stock_Price:  99.13899847399021
curr_Factors:  [99.13899847]
mat_Sqrt:  [[0.15]]
grads:  [0.03513283]
Stock Position:  0.03513282784279501
Bond Position:  [7.07676741]


portfolio before change:  [10.57956609]
curr_Stock_Price:  99.68899707487591
curr_Factors:  [99.68899707]
mat_Sqrt:  [[0.15]]
grads:  [-0.08332099]
Stock Position:  -0.0833209870846637
Bond Position:  [18.88575173]


portfolio before change:  [10.55569739]
curr_Stock_Price:  99.98963072129915
curr_Factors:  [99.98963072]
mat_Sqrt:  [[0.15]]
grads:  [-0.08360972]
Stock Position:  -0.08360971530405203
Bond Position:  [18.91580195]


portfolio before change:  [10.5487982]
curr_Stock_Price:  100.08628779577656
curr_Factors:  [100.0862878]
mat_Sqrt:  [[0.15]]
grads:  [-0.01474499]
Stock Position:  -0.014744994544848886
Bond Position:  [12.02456996]


portfolio before change:  [10.54956267]
curr_Stock_Price:  100.08541230545221
curr_Factors:  [100.08541231]
mat_Sqrt:  [[0.15]]
grads:  [-0.1095473]
Stock Position:  -0.10954730013004663
Bond Position:  [21.51364937]


portfolio before change:  [10.52569249]
curr_Stock_Price:  100.3155852002434
curr_Factors:  [100.3155852]
mat_Sqrt:  [[0.15]]
grads:  [0.28147212]
Stock Position:  0.2814721211847545
Bond Position:  [-17.71034806]


portfolio before change:  [10.6339145]
curr_Stock_Price:  100.70400357076208
curr_Factors:  [100.70400357]
mat_Sqrt:  [[0.15]]
grads:  [0.13526734]
Stock Position:  0.13526733819917056
Bond Position:  [-2.98804801]


portfolio before change:  [10.75763024]
curr_Stock_Price:  101.619985910811
curr_Factors:  [101.61998591]
mat_Sqrt:  [[0.15]]
grads:  [0.0113936]
Stock Position:  0.011393603368183933
Bond Position:  [9.59981242]


portfolio before change:  [10.75354671]
curr_Stock_Price:  101.20891890965406
curr_Factors:  [101.20891891]
mat_Sqrt:  [[0.15]]
grads:  [0.04104337]
Stock Position:  0.04104336660717126
Bond Position:  [6.59959195]


portfolio before change:  [10.74701692]
curr_Stock_Price:  101.0397738819782
curr_Factors:  [101.03977388]
mat_Sqrt:  [[0.15]]
grads:  [-0.09375046]
Stock Position:  -0.09375046030030501
Bond Position:  [20.21954223]


portfolio before change:  [10.76745012]
curr_Stock_Price:  100.83530085145635
curr_Factors:  [100.83530085]
mat_Sqrt:  [[0.15]]
grads:  [-0.05035429]
Stock Position:  -0.05035429226494114
Bond Position:  [15.84494033]


portfolio before change:  [10.7981818]
curr_Stock_Price:  100.24465920116953
curr_Factors:  [100.2446592]
mat_Sqrt:  [[0.15]]
grads:  [-0.00815855]
Stock Position:  -0.008158552811380127
Bond Position:  [11.61603315]


portfolio before change:  [10.80162942]
curr_Stock_Price:  99.9110708721374
curr_Factors:  [99.91107087]
mat_Sqrt:  [[0.15]]
grads:  [0.01347649]
Stock Position:  0.013476493921852645
Bond Position:  [9.45517848]


portfolio before change:  [10.80310052]
curr_Stock_Price:  99.97637949525016
curr_Factors:  [99.9763795]
mat_Sqrt:  [[0.15]]
grads:  [0.05879255]
Stock Position:  0.05879255192582699
Bond Position:  [4.92523404]


portfolio before change:  [10.79384647]
curr_Stock_Price:  99.81374176823286
curr_Factors:  [99.81374177]
mat_Sqrt:  [[0.15]]
grads:  [0.08442089]
Stock Position:  0.0844208873842847
Bond Position:  [2.36748182]


portfolio before change:  [10.81671068]
curr_Stock_Price:  100.08282493398357
curr_Factors:  [100.08282493]
mat_Sqrt:  [[0.15]]
grads:  [-0.05637491]
Stock Position:  -0.056374910835814744
Bond Position:  [16.45887101]


portfolio before change:  [10.83096645]
curr_Stock_Price:  99.84819822460213
curr_Factors:  [99.84819822]
mat_Sqrt:  [[0.15]]
grads:  [-0.01752396]
Stock Position:  -0.01752395530559938
Bond Position:  [12.58070182]


portfolio before change:  [10.82914186]
curr_Stock_Price:  99.99718899398819
curr_Factors:  [99.99718899]
mat_Sqrt:  [[0.15]]
grads:  [-0.05744101]
Stock Position:  -0.05744101297001336
Bond Position:  [16.57308169]


portfolio before change:  [10.84891802]
curr_Stock_Price:  99.67093588204891
curr_Factors:  [99.67093588]
mat_Sqrt:  [[0.15]]
grads:  [-0.00905186]
Stock Position:  -0.009051858136971055
Bond Position:  [11.7511252]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.84891802]
Stock Price:  100.23219499721213
PL:  [10.61672303]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.36194880e-02]
 [-9.39576777e-04]
 [-7.03805877e-04]
 [ 2.14854645e-03]
 [-2.99972852e-03]
 [ 8.77043382e-03]
 [ 5.40565107e-04]
 [ 1.29915075e-02]
 [ 1.77652913e-02]
 [-8.83135030e-03]
 [ 5.71968979e-03]
 [-5.59607578e-03]
 [-8.59306277e-03]
 [ 4.18228078e-03]
 [ 6.65661252e-03]
 [ 6.10878425e-03]
 [-7.89747619e-04]
 [ 6.87145311e-03]
 [ 1.94902240e-02]
 [ 1.23396755e-02]
 [ 3.34207627e-02]
 [-2.39769965e-02]
 [-1.13264738e-03]
 [ 1.01439915e-02]
 [ 3.15826878e-03]
 [ 1.02904990e-02]
 [ 1.39816800e-02]
 [-2.10447354e-02]
 [ 1.86072668e-03]
 [-7.82568279e-03]
 [-3.66777779e-03]
 [-1.90682705e-02]
 [ 1.58207214e-02]
 [ 1.03417706e-02]
 [-1.63059789e-02]
 [ 6.34339041e-03]
 [-2.27925161e-03]
 [ 1.09192393e-02]
 [ 2.95570143e-03]
 [-1.43357852e-02]
 [ 1.55873715e-03]
 [-1.88872960e-03]
 [ 3.62561519e-03]
 [-1.00980006e-02]
 [ 2.82498033e-03]
 [-5.87058532e-04]
 [-1.36938561e-02]
 [-1.83037460e-03]
 [-6.99000723e-03]
 [ 6.36501421e-03]
 [-3.17437568e-03]
 [ 3.40080074e-03]
 [ 2.11841094e-03]
 [-1.49579846e-03]
 [ 1.43105138e-03]
 [ 8.99729580e-03]
 [ 1.56386852e-02]
 [-1.34388365e-02]
 [ 1.38335841e-02]
 [ 2.44981195e-03]
 [ 5.15144570e-03]
 [-1.41963011e-02]
 [-1.26153744e-02]
 [-1.09268518e-03]
 [-1.03533214e-02]
 [-9.49798238e-03]
 [ 1.04339753e-02]
 [ 2.17002223e-03]
 [ 1.30229647e-02]
 [-1.89732894e-02]
 [ 1.62264167e-02]
 [-1.16446820e-02]
 [-3.86417276e-03]
 [ 7.74993768e-03]
 [-3.58843264e-03]
 [ 3.13637279e-03]
 [ 1.23784490e-02]
 [-1.41813245e-02]
 [-4.72811701e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.87016876]
curr_Stock_Price:  99.98738504031161
curr_Factors:  [99.98738504]
mat_Sqrt:  [[0.15]]
grads:  [-0.22412992]
Stock Position:  -0.22412991979651045
Bond Position:  [24.28033335]


portfolio before change:  [1.90589527]
curr_Stock_Price:  99.83475509866588
curr_Factors:  [99.8347551]
mat_Sqrt:  [[0.15]]
grads:  [-0.00626385]
Stock Position:  -0.006263845181177149
Bond Position:  [2.53124472]


portfolio before change:  [1.91036428]
curr_Stock_Price:  99.1465512077644
curr_Factors:  [99.14655121]
mat_Sqrt:  [[0.15]]
grads:  [-0.00469204]
Stock Position:  -0.004692039179833105
Bond Position:  [2.37556378]


portfolio before change:  [1.90568201]
curr_Stock_Price:  100.17611374630727
curr_Factors:  [100.17611375]
mat_Sqrt:  [[0.15]]
grads:  [0.01432364]
Stock Position:  0.01432364303034065
Bond Position:  [0.47079511]


portfolio before change:  [1.89365331]
curr_Stock_Price:  99.33428048839473
curr_Factors:  [99.33428049]
mat_Sqrt:  [[0.15]]
grads:  [-0.01999819]
Stock Position:  -0.019998190156477018
Bond Position:  [3.88015914]


portfolio before change:  [1.89841145]
curr_Stock_Price:  99.10847898917147
curr_Factors:  [99.10847899]
mat_Sqrt:  [[0.15]]
grads:  [0.05846956]
Stock Position:  0.05846955879422069
Bond Position:  [-3.89641759]


portfolio before change:  [1.91227201]
curr_Stock_Price:  99.34970004997832
curr_Factors:  [99.34970005]
mat_Sqrt:  [[0.15]]
grads:  [0.00360377]
Stock Position:  0.0036037673787383266
Bond Position:  [1.5542388]


portfolio before change:  [1.91320141]
curr_Stock_Price:  99.58064206479054
curr_Factors:  [99.58064206]
mat_Sqrt:  [[0.15]]
grads:  [0.08661005]
Stock Position:  0.0866100502534624
Bond Position:  [-6.711483]


portfolio before change:  [1.88045213]
curr_Stock_Price:  99.20736208199163
curr_Factors:  [99.20736208]
mat_Sqrt:  [[0.15]]
grads:  [0.11843528]
Stock Position:  0.11843527544835876
Bond Position:  [-9.86919912]


portfolio before change:  [1.81073179]
curr_Stock_Price:  98.62389152517602
curr_Factors:  [98.62389153]
mat_Sqrt:  [[0.15]]
grads:  [-0.05887567]
Stock Position:  -0.05887566869823959
Bond Position:  [7.61727936]


portfolio before change:  [1.783639]
curr_Stock_Price:  99.09214762739988
curr_Factors:  [99.09214763]
mat_Sqrt:  [[0.15]]
grads:  [0.03813127]
Stock Position:  0.03813126527681041
Bond Position:  [-1.99486997]


portfolio before change:  [1.79607372]
curr_Stock_Price:  99.42152047320029
curr_Factors:  [99.42152047]
mat_Sqrt:  [[0.15]]
grads:  [-0.03730717]
Stock Position:  -0.03730717183807805
Bond Position:  [5.50520946]


portfolio before change:  [1.79342564]
curr_Stock_Price:  99.50172389534943
curr_Factors:  [99.5017239]
mat_Sqrt:  [[0.15]]
grads:  [-0.05728709]
Stock Position:  -0.05728708514906259
Bond Position:  [7.49358937]


portfolio before change:  [1.7963804]
curr_Stock_Price:  99.45832144318769
curr_Factors:  [99.45832144]
mat_Sqrt:  [[0.15]]
grads:  [0.02788187]
Stock Position:  0.027881871873441315
Bond Position:  [-0.97670377]


portfolio before change:  [1.82076751]
curr_Stock_Price:  100.33516906476017
curr_Factors:  [100.33516906]
mat_Sqrt:  [[0.15]]
grads:  [0.04437742]
Stock Position:  0.04437741679425289
Bond Position:  [-2.63184811]


portfolio before change:  [1.7864111]
curr_Stock_Price:  99.56468902090604
curr_Factors:  [99.56468902]
mat_Sqrt:  [[0.15]]
grads:  [0.04072523]
Stock Position:  0.04072522834217919
Bond Position:  [-2.26838359]


portfolio before change:  [1.76252041]
curr_Stock_Price:  98.98153902390234
curr_Factors:  [98.98153902]
mat_Sqrt:  [[0.15]]
grads:  [-0.00526498]
Stock Position:  -0.005264984126155761
Bond Position:  [2.28365664]


portfolio before change:  [1.76060621]
curr_Stock_Price:  99.37221973652227
curr_Factors:  [99.37221974]
mat_Sqrt:  [[0.15]]
grads:  [0.04580969]
Stock Position:  0.045809687400869124
Bond Position:  [-2.79160411]


portfolio before change:  [1.7424908]
curr_Stock_Price:  98.9805791753637
curr_Factors:  [98.98057918]
mat_Sqrt:  [[0.15]]
grads:  [0.12993483]
Stock Position:  0.12993482634095124
Bond Position:  [-11.11853357]


portfolio before change:  [1.7206783]
curr_Stock_Price:  98.81805485086583
curr_Factors:  [98.81805485]
mat_Sqrt:  [[0.15]]
grads:  [0.0822645]
Stock Position:  0.08226450356523862
Bond Position:  [-6.40853993]


portfolio before change:  [1.7067413]
curr_Stock_Price:  98.65350699319869
curr_Factors:  [98.65350699]
mat_Sqrt:  [[0.15]]
grads:  [0.22280508]
Stock Position:  0.22280508489738685
Bond Position:  [-20.2737617]


portfolio before change:  [1.46845658]
curr_Stock_Price:  97.58971808217225
curr_Factors:  [97.58971808]
mat_Sqrt:  [[0.15]]
grads:  [-0.15984664]
Stock Position:  -0.15984664311067942
Bond Position:  [17.06784541]


portfolio before change:  [1.29292297]
curr_Stock_Price:  98.69452940357807
curr_Factors:  [98.6945294]
mat_Sqrt:  [[0.15]]
grads:  [-0.00755098]
Stock Position:  -0.007550982509800456
Bond Position:  [2.03816363]


portfolio before change:  [1.29670805]
curr_Stock_Price:  98.21012950648344
curr_Factors:  [98.21012951]
mat_Sqrt:  [[0.15]]
grads:  [0.06762661]
Stock Position:  0.06762661010822876
Bond Position:  [-5.34491008]


portfolio before change:  [1.30027189]
curr_Stock_Price:  98.26776805739756
curr_Factors:  [98.26776806]
mat_Sqrt:  [[0.15]]
grads:  [0.02105513]
Stock Position:  0.021055125202100473
Bond Position:  [-0.76876827]


portfolio before change:  [1.29982762]
curr_Stock_Price:  98.24895014325197
curr_Factors:  [98.24895014]
mat_Sqrt:  [[0.15]]
grads:  [0.06860333]
Stock Position:  0.06860332651386782
Bond Position:  [-5.44037718]


portfolio before change:  [1.28565362]
curr_Stock_Price:  98.04729864203871
curr_Factors:  [98.04729864]
mat_Sqrt:  [[0.15]]
grads:  [0.0932112]
Stock Position:  0.09321119990595478
Bond Position:  [-7.85345273]


portfolio before change:  [1.30203895]
curr_Stock_Price:  98.2283518090952
curr_Factors:  [98.22835181]
mat_Sqrt:  [[0.15]]
grads:  [-0.14029824]
Stock Position:  -0.14029823632006166
Bond Position:  [15.08330347]


portfolio before change:  [1.26906328]
curr_Stock_Price:  98.47011115895324
curr_Factors:  [98.47011116]
mat_Sqrt:  [[0.15]]
grads:  [0.01240484]
Stock Position:  0.01240484455771809
Bond Position:  [0.04755685]


portfolio before change:  [1.26644903]
curr_Stock_Price:  98.25912755816483
curr_Factors:  [98.25912756]
mat_Sqrt:  [[0.15]]
grads:  [-0.05217122]
Stock Position:  -0.052171218580249826
Bond Position:  [6.39274745]


portfolio before change:  [1.26135359]
curr_Stock_Price:  98.36445387597063
curr_Factors:  [98.36445388]
mat_Sqrt:  [[0.15]]
grads:  [-0.02445185]
Stock Position:  -0.024451851924979062
Bond Position:  [3.66654665]


portfolio before change:  [1.25404655]
curr_Stock_Price:  98.67265984204354
curr_Factors:  [98.67265984]
mat_Sqrt:  [[0.15]]
grads:  [-0.1271218]
Stock Position:  -0.12712180317948432
Bond Position:  [13.79749299]


portfolio before change:  [1.26156052]
curr_Stock_Price:  98.6203352392949
curr_Factors:  [98.62033524]
mat_Sqrt:  [[0.15]]
grads:  [0.10547148]
Stock Position:  0.10547147622584212
Bond Position:  [-9.14007183]


portfolio before change:  [1.16794687]
curr_Stock_Price:  97.73817848210001
curr_Factors:  [97.73817848]
mat_Sqrt:  [[0.15]]
grads:  [0.06894514]
Stock Position:  0.06894513730153581
Bond Position:  [-5.57062527]


portfolio before change:  [1.21524877]
curr_Stock_Price:  98.4293088224623
curr_Factors:  [98.42930882]
mat_Sqrt:  [[0.15]]
grads:  [-0.10870653]
Stock Position:  -0.10870652591571112
Bond Position:  [11.91515698]


portfolio before change:  [1.19233774]
curr_Stock_Price:  98.64691992687379
curr_Factors:  [98.64691993]
mat_Sqrt:  [[0.15]]
grads:  [0.04228927]
Stock Position:  0.042289269407562995
Bond Position:  [-2.97936843]


portfolio before change:  [1.20666213]
curr_Stock_Price:  98.99004731251733
curr_Factors:  [98.99004731]
mat_Sqrt:  [[0.15]]
grads:  [-0.01519501]
Stock Position:  -0.015195010716556595
Bond Position:  [2.71081696]


portfolio before change:  [1.20923825]
curr_Stock_Price:  98.83166074435485
curr_Factors:  [98.83166074]
mat_Sqrt:  [[0.15]]
grads:  [0.07279493]
Stock Position:  0.07279492863825471
Bond Position:  [-5.98520544]


portfolio before change:  [1.17991031]
curr_Stock_Price:  98.43391532608157
curr_Factors:  [98.43391533]
mat_Sqrt:  [[0.15]]
grads:  [0.01970468]
Stock Position:  0.01970467622238049
Bond Position:  [-0.75969812]


portfolio before change:  [1.18137758]
curr_Stock_Price:  98.51078787788543
curr_Factors:  [98.51078788]
mat_Sqrt:  [[0.15]]
grads:  [-0.0955719]
Stock Position:  -0.09557190106145799
Bond Position:  [10.59624085]


portfolio before change:  [1.11129331]
curr_Stock_Price:  99.25103213940648
curr_Factors:  [99.25103214]
mat_Sqrt:  [[0.15]]
grads:  [0.01039158]
Stock Position:  0.010391581000230693
Bond Position:  [0.07991817]


portfolio before change:  [1.10655605]
curr_Stock_Price:  98.79467651043592
curr_Factors:  [98.79467651]
mat_Sqrt:  [[0.15]]
grads:  [-0.01259153]
Stock Position:  -0.012591530661870446
Bond Position:  [2.35053225]


portfolio before change:  [1.10570825]
curr_Stock_Price:  98.87367551054353
curr_Factors:  [98.87367551]
mat_Sqrt:  [[0.15]]
grads:  [0.02417077]
Stock Position:  0.0241707679176169
Bond Position:  [-1.28414442]


portfolio before change:  [1.12179078]
curr_Stock_Price:  99.54236731815126
curr_Factors:  [99.54236732]
mat_Sqrt:  [[0.15]]
grads:  [-0.06732]
Stock Position:  -0.06732000399545034
Bond Position:  [7.82298335]


portfolio before change:  [1.09173608]
curr_Stock_Price:  99.99607578792991
curr_Factors:  [99.99607579]
mat_Sqrt:  [[0.15]]
grads:  [0.0188332]
Stock Position:  0.018833202178009992
Bond Position:  [-0.79151024]


portfolio before change:  [1.09543157]
curr_Stock_Price:  100.19492510606173
curr_Factors:  [100.19492511]
mat_Sqrt:  [[0.15]]
grads:  [-0.00391372]
Stock Position:  -0.0039137235471237925
Bond Position:  [1.48756681]


portfolio before change:  [1.09924204]
curr_Stock_Price:  99.24506487591182
curr_Factors:  [99.24506488]
mat_Sqrt:  [[0.15]]
grads:  [-0.09129237]
Stock Position:  -0.09129237412230769
Bond Position:  [10.15955963]


portfolio before change:  [1.13554023]
curr_Stock_Price:  98.85441669055749
curr_Factors:  [98.85441669]
mat_Sqrt:  [[0.15]]
grads:  [-0.0122025]
Stock Position:  -0.012202497323612333
Bond Position:  [2.34181099]


portfolio before change:  [1.14139943]
curr_Stock_Price:  98.38624813086938
curr_Factors:  [98.38624813]
mat_Sqrt:  [[0.15]]
grads:  [-0.04660005]
Stock Position:  -0.0466000481778704
Bond Position:  [5.72620333]


portfolio before change:  [1.16040616]
curr_Stock_Price:  97.98605894263898
curr_Factors:  [97.98605894]
mat_Sqrt:  [[0.15]]
grads:  [0.04243343]
Stock Position:  0.0424334280661915
Bond Position:  [-2.99747822]


portfolio before change:  [1.17535308]
curr_Stock_Price:  98.3427179432928
curr_Factors:  [98.34271794]
mat_Sqrt:  [[0.15]]
grads:  [-0.0211625]
Stock Position:  -0.021162504516729227
Bond Position:  [3.25653129]


portfolio before change:  [1.15907515]
curr_Stock_Price:  99.12152288696824
curr_Factors:  [99.12152289]
mat_Sqrt:  [[0.15]]
grads:  [0.022672]
Stock Position:  0.02267200491478525
Bond Position:  [-1.0882085]


portfolio before change:  [1.16262044]
curr_Stock_Price:  99.28089557284068
curr_Factors:  [99.28089557]
mat_Sqrt:  [[0.15]]
grads:  [0.01412274]
Stock Position:  0.014122739583484855
Bond Position:  [-0.2394978]


portfolio before change:  [1.16619591]
curr_Stock_Price:  99.53512673498197
curr_Factors:  [99.53512673]
mat_Sqrt:  [[0.15]]
grads:  [-0.00997199]
Stock Position:  -0.009971989730243514
Bond Position:  [2.15875917]


portfolio before change:  [1.16920053]
curr_Stock_Price:  99.24735102523245
curr_Factors:  [99.24735103]
mat_Sqrt:  [[0.15]]
grads:  [0.00954034]
Stock Position:  0.009540342539011981
Bond Position:  [0.22234681]


portfolio before change:  [1.17409802]
curr_Stock_Price:  99.75923955426659
curr_Factors:  [99.75923955]
mat_Sqrt:  [[0.15]]
grads:  [0.05998197]
Stock Position:  0.05998197200796491
Bond Position:  [-4.8096579]


portfolio before change:  [1.11119496]
curr_Stock_Price:  98.71555190608933
curr_Factors:  [98.71555191]
mat_Sqrt:  [[0.15]]
grads:  [0.1042579]
Stock Position:  0.1042579016171283
Bond Position:  [-9.18068134]


portfolio before change:  [1.06996441]
curr_Stock_Price:  98.32558877661724
curr_Factors:  [98.32558878]
mat_Sqrt:  [[0.15]]
grads:  [-0.08959224]
Stock Position:  -0.0895922435318132
Bond Position:  [9.87917451]


portfolio before change:  [1.05846549]
curr_Stock_Price:  98.46082806051898
curr_Factors:  [98.46082806]
mat_Sqrt:  [[0.15]]
grads:  [0.09222389]
Stock Position:  0.0922238940625776
Bond Position:  [-8.02197548]


portfolio before change:  [1.04640192]
curr_Stock_Price:  98.33545731181319
curr_Factors:  [98.33545731]
mat_Sqrt:  [[0.15]]
grads:  [0.01633208]
Stock Position:  0.01633207964577714
Bond Position:  [-0.5596206]


portfolio before change:  [1.05562131]
curr_Stock_Price:  98.90209465556113
curr_Factors:  [98.90209466]
mat_Sqrt:  [[0.15]]
grads:  [0.03434297]
Stock Position:  0.03434297134950866
Bond Position:  [-2.34097049]


portfolio before change:  [1.04603321]
curr_Stock_Price:  98.6271684234253
curr_Factors:  [98.62716842]
mat_Sqrt:  [[0.15]]
grads:  [-0.09464201]
Stock Position:  -0.09464200755060537
Bond Position:  [10.38030643]


portfolio before change:  [1.05435184]
curr_Stock_Price:  98.54612795901501
curr_Factors:  [98.54612796]
mat_Sqrt:  [[0.15]]
grads:  [-0.0841025]
Stock Position:  -0.0841024962102154
Bond Position:  [9.34232719]


portfolio before change:  [1.08852581]
curr_Stock_Price:  98.14673360772643
curr_Factors:  [98.14673361]
mat_Sqrt:  [[0.15]]
grads:  [-0.00728457]
Stock Position:  -0.00728456784830564
Bond Position:  [1.80348235]


portfolio before change:  [1.09218919]
curr_Stock_Price:  97.65931192138855
curr_Factors:  [97.65931192]
mat_Sqrt:  [[0.15]]
grads:  [-0.06902214]
Stock Position:  -0.06902214299000169
Bond Position:  [7.83284418]


portfolio before change:  [1.05342088]
curr_Stock_Price:  98.22808414105553
curr_Factors:  [98.22808414]
mat_Sqrt:  [[0.15]]
grads:  [-0.06331988]
Stock Position:  -0.06331988252271016
Bond Position:  [7.27321163]


portfolio before change:  [1.07871825]
curr_Stock_Price:  97.83574634967377
curr_Factors:  [97.83574635]
mat_Sqrt:  [[0.15]]
grads:  [0.06955984]
Stock Position:  0.0695598356051354
Bond Position:  [-5.72672018]


portfolio before change:  [1.04047215]
curr_Stock_Price:  97.29106181158966
curr_Factors:  [97.29106181]
mat_Sqrt:  [[0.15]]
grads:  [0.01446681]
Stock Position:  0.014466814886280885
Bond Position:  [-0.36701963]


portfolio before change:  [1.0300948]
curr_Stock_Price:  96.57532634966438
curr_Factors:  [96.57532635]
mat_Sqrt:  [[0.15]]
grads:  [0.08681976]
Stock Position:  0.08681976460777353
Bond Position:  [-7.3545523]


portfolio before change:  [0.95511011]
curr_Stock_Price:  95.71693870420778
curr_Factors:  [95.7169387]
mat_Sqrt:  [[0.15]]
grads:  [-0.1264886]
Stock Position:  -0.12648859616595007
Bond Position:  [13.06221132]


portfolio before change:  [1.00324235]
curr_Stock_Price:  95.34286684131739
curr_Factors:  [95.34286684]
mat_Sqrt:  [[0.15]]
grads:  [0.10817611]
Stock Position:  0.10817611110328784
Bond Position:  [-9.3105782]


portfolio before change:  [0.96386164]
curr_Stock_Price:  94.98420369985713
curr_Factors:  [94.9842037]
mat_Sqrt:  [[0.15]]
grads:  [-0.07763121]
Stock Position:  -0.07763121301286321
Bond Position:  [8.33760059]


portfolio before change:  [0.94958265]
curr_Stock_Price:  95.17485000323727
curr_Factors:  [95.17485]
mat_Sqrt:  [[0.15]]
grads:  [-0.02576115]
Stock Position:  -0.02576115170975017
Bond Position:  [3.4013964]


portfolio before change:  [0.95054439]
curr_Stock_Price:  95.1457694573075
curr_Factors:  [95.14576946]
mat_Sqrt:  [[0.15]]
grads:  [0.05166625]
Stock Position:  0.05166625120266945
Bond Position:  [-3.96528083]


portfolio before change:  [0.99199536]
curr_Stock_Price:  95.95284945878733
curr_Factors:  [95.95284946]
mat_Sqrt:  [[0.15]]
grads:  [-0.02392288]
Stock Position:  -0.023922884237604653
Bond Position:  [3.28746426]


portfolio before change:  [1.00217104]
curr_Stock_Price:  95.53608487912211
curr_Factors:  [95.53608488]
mat_Sqrt:  [[0.15]]
grads:  [0.02090915]
Stock Position:  0.020909151904140135
Bond Position:  [-0.99540747]


portfolio before change:  [0.99422096]
curr_Stock_Price:  95.15884026919446
curr_Factors:  [95.15884027]
mat_Sqrt:  [[0.15]]
grads:  [0.08252299]
Stock Position:  0.08252299365755705
Bond Position:  [-6.85857141]


portfolio before change:  [0.94845094]
curr_Stock_Price:  94.6094013249504
curr_Factors:  [94.60940132]
mat_Sqrt:  [[0.15]]
grads:  [-0.09454216]
Stock Position:  -0.0945421631104729
Bond Position:  [9.89302839]


portfolio before change:  [0.89036369]
curr_Stock_Price:  95.23034741431431
curr_Factors:  [95.23034741]
mat_Sqrt:  [[0.15]]
grads:  [-0.3152078]
Stock Position:  -0.31520780040771595
Bond Position:  [30.90771203]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.89036369]
Stock Price:  95.35576057175636
PL:  [0.89036369]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.63885451e-02]
 [-8.84493512e-04]
 [ 2.70870555e-04]
 [ 2.13611012e-03]
 [ 1.10468337e-02]
 [ 1.01427011e-02]
 [ 4.76606147e-04]
 [-1.19931252e-03]
 [ 4.00628392e-03]
 [ 2.27138422e-02]
 [ 8.54221839e-03]
 [-1.06754396e-02]
 [ 9.94252131e-03]
 [ 8.51942981e-03]
 [-4.12051063e-02]
 [ 2.20608629e-02]
 [-4.63228994e-03]
 [-9.51844282e-03]
 [-2.01406108e-02]
 [ 1.62733825e-02]
 [-7.14150852e-02]
 [-3.19914654e-02]
 [ 1.79724576e-03]
 [-3.49498983e-03]
 [-1.16849496e-02]
 [ 1.55996925e-02]
 [ 2.18786974e-02]
 [ 9.48203560e-02]
 [-1.13072260e-03]
 [ 1.62025851e-02]
 [-3.42885865e-03]
 [-2.38290815e-02]
 [ 2.09270562e-02]
 [ 1.09946330e-02]
 [-3.08764056e-02]
 [ 8.10844388e-03]
 [-5.00324251e-04]
 [-6.20148998e-03]
 [ 7.27266861e-03]
 [-1.85578057e-02]
 [ 4.32420092e-02]
 [ 1.73223492e-03]
 [ 8.66987733e-03]
 [-9.39686706e-03]
 [-2.69822715e-03]
 [-1.75719992e-02]
 [-1.30244235e-02]
 [ 2.32741324e-03]
 [-2.84993051e-03]
 [-8.80560806e-03]
 [-4.14461737e-03]
 [ 2.78832395e-03]
 [ 3.75729476e-03]
 [-1.21579003e-03]
 [ 1.48570771e-02]
 [ 8.99841260e-03]
 [-1.26344954e-03]
 [ 1.48166705e-02]
 [ 1.29253303e-02]
 [-8.62886365e-03]
 [-6.74794424e-03]
 [-3.07183399e-02]
 [-1.29622762e-02]
 [-3.67049162e-03]
 [-5.95288694e-03]
 [ 3.76528282e-02]
 [ 8.26220670e-03]
 [ 1.73374820e-03]
 [ 1.50980219e-02]
 [-1.96260210e-02]
 [ 2.10679427e-02]
 [-8.93279175e-03]
 [-2.66082062e-03]
 [ 7.67427177e-03]
 [-7.12307356e-04]
 [ 2.31520595e-03]
 [ 2.05127169e-03]
 [-1.08716759e-02]
 [-2.99877645e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.18698578]
curr_Stock_Price:  100.0720177386766
curr_Factors:  [100.07201774]
mat_Sqrt:  [[0.15]]
grads:  [-0.2425903]
Stock Position:  -0.24259030092771333
Bond Position:  [27.46348668]


portfolio before change:  [3.05659686]
curr_Stock_Price:  100.61657967899357
curr_Factors:  [100.61657968]
mat_Sqrt:  [[0.15]]
grads:  [-0.00589662]
Stock Position:  -0.005896623414282116
Bond Position:  [3.64989494]


portfolio before change:  [3.05808788]
curr_Stock_Price:  100.4024058554415
curr_Factors:  [100.40240586]
mat_Sqrt:  [[0.15]]
grads:  [0.0018058]
Stock Position:  0.0018058037028923872
Bond Position:  [2.87678085]


portfolio before change:  [3.0572781]
curr_Stock_Price:  99.85440021357554
curr_Factors:  [99.85440021]
mat_Sqrt:  [[0.15]]
grads:  [0.01424073]
Stock Position:  0.014240734102595997
Bond Position:  [1.63527814]


portfolio before change:  [3.05458089]
curr_Stock_Price:  99.6578222757599
curr_Factors:  [99.65782228]
mat_Sqrt:  [[0.15]]
grads:  [0.07364556]
Stock Position:  0.07364555825533402
Bond Position:  [-4.28477506]


portfolio before change:  [3.03295076]
curr_Stock_Price:  99.36775283944979
curr_Factors:  [99.36775284]
mat_Sqrt:  [[0.15]]
grads:  [0.06761801]
Stock Position:  0.06761800719002665
Bond Position:  [-3.68609867]


portfolio before change:  [3.01681616]
curr_Stock_Price:  99.1325461299146
curr_Factors:  [99.13254613]
mat_Sqrt:  [[0.15]]
grads:  [0.00317737]
Stock Position:  0.0031773743160985034
Bond Position:  [2.70183496]


portfolio before change:  [3.01320167]
curr_Stock_Price:  97.94182738183036
curr_Factors:  [97.94182738]
mat_Sqrt:  [[0.15]]
grads:  [-0.00799542]
Stock Position:  -0.007995416818494297
Bond Position:  [3.79628741]


portfolio before change:  [3.01536489]
curr_Stock_Price:  97.7009461563239
curr_Factors:  [97.70094616]
mat_Sqrt:  [[0.15]]
grads:  [0.02670856]
Stock Position:  0.026708559439145546
Bond Position:  [0.40591337]


portfolio before change:  [3.01533741]
curr_Stock_Price:  97.6989673293176
curr_Factors:  [97.69896733]
mat_Sqrt:  [[0.15]]
grads:  [0.15142561]
Stock Position:  0.1514256147790429
Bond Position:  [-11.77878878]


portfolio before change:  [3.03574278]
curr_Stock_Price:  97.83858413986853
curr_Factors:  [97.83858414]
mat_Sqrt:  [[0.15]]
grads:  [0.05694812]
Stock Position:  0.056948122613789155
Bond Position:  [-2.53598091]


portfolio before change:  [3.01315241]
curr_Stock_Price:  97.44468418447937
curr_Factors:  [97.44468418]
mat_Sqrt:  [[0.15]]
grads:  [-0.0711696]
Stock Position:  -0.07116959724467427
Bond Position:  [9.94825134]


portfolio before change:  [3.02533682]
curr_Stock_Price:  97.2822184158619
curr_Factors:  [97.28221842]
mat_Sqrt:  [[0.15]]
grads:  [0.06628348]
Stock Position:  0.06628347539292304
Bond Position:  [-3.42286671]


portfolio before change:  [2.98603168]
curr_Stock_Price:  96.69246054733485
curr_Factors:  [96.69246055]
mat_Sqrt:  [[0.15]]
grads:  [0.0567962]
Stock Position:  0.05679619872373934
Bond Position:  [-2.50573252]


portfolio before change:  [2.95760682]
curr_Stock_Price:  96.19474679852347
curr_Factors:  [96.1947468]
mat_Sqrt:  [[0.15]]
grads:  [-0.27470071]
Stock Position:  -0.27470070860509455
Bond Position:  [29.38237193]


portfolio before change:  [2.9975485]
curr_Stock_Price:  96.0560313665673
curr_Factors:  [96.05603137]
mat_Sqrt:  [[0.15]]
grads:  [0.14707242]
Stock Position:  0.14707241932391285
Bond Position:  [-11.12964442]


portfolio before change:  [3.11159193]
curr_Stock_Price:  96.83618477177959
curr_Factors:  [96.83618477]
mat_Sqrt:  [[0.15]]
grads:  [-0.03088193]
Stock Position:  -0.030881932962946845
Bond Position:  [6.10208049]


portfolio before change:  [3.11583842]
curr_Stock_Price:  96.71102753935233
curr_Factors:  [96.71102754]
mat_Sqrt:  [[0.15]]
grads:  [-0.06345629]
Stock Position:  -0.06345628545403455
Bond Position:  [9.25276099]


portfolio before change:  [3.10431004]
curr_Stock_Price:  96.90181549589772
curr_Factors:  [96.9018155]
mat_Sqrt:  [[0.15]]
grads:  [-0.13427074]
Stock Position:  -0.13427073845369325
Bond Position:  [16.11538836]


portfolio before change:  [3.21235113]
curr_Stock_Price:  96.10466600238446
curr_Factors:  [96.104666]
mat_Sqrt:  [[0.15]]
grads:  [0.10848922]
Stock Position:  0.10848921656002898
Bond Position:  [-7.21396879]


portfolio before change:  [3.20098754]
curr_Stock_Price:  96.00407811188656
curr_Factors:  [96.00407811]
mat_Sqrt:  [[0.15]]
grads:  [-0.47610057]
Stock Position:  -0.4761005678026042
Bond Position:  [48.90858364]


portfolio before change:  [3.19995968]
curr_Stock_Price:  96.01265769381313
curr_Factors:  [96.01265769]
mat_Sqrt:  [[0.15]]
grads:  [-0.21327644]
Stock Position:  -0.2132764362526583
Bond Position:  [23.67719715]


portfolio before change:  [3.35138125]
curr_Stock_Price:  95.3096185033732
curr_Factors:  [95.3096185]
mat_Sqrt:  [[0.15]]
grads:  [0.01198164]
Stock Position:  0.011981638421454869
Bond Position:  [2.20941586]


portfolio before change:  [3.34713561]
curr_Stock_Price:  94.94374785495773
curr_Factors:  [94.94374785]
mat_Sqrt:  [[0.15]]
grads:  [-0.02329993]
Stock Position:  -0.023299932204178146
Bond Position:  [5.5593185]


portfolio before change:  [3.35046801]
curr_Stock_Price:  94.81563869543542
curr_Factors:  [94.8156387]
mat_Sqrt:  [[0.15]]
grads:  [-0.07789966]
Stock Position:  -0.07789966375529675
Bond Position:  [10.73657438]


portfolio before change:  [3.38134189]
curr_Stock_Price:  94.42792426670837
curr_Factors:  [94.42792427]
mat_Sqrt:  [[0.15]]
grads:  [0.10399795]
Stock Position:  0.10399795014739902
Bond Position:  [-6.43896867]


portfolio before change:  [3.39593588]
curr_Stock_Price:  94.57212358503705
curr_Factors:  [94.57212359]
mat_Sqrt:  [[0.15]]
grads:  [0.14585798]
Stock Position:  0.145857982483622
Bond Position:  [-10.39816327]


portfolio before change:  [3.4001632]
curr_Stock_Price:  94.60556178960849
curr_Factors:  [94.60556179]
mat_Sqrt:  [[0.15]]
grads:  [0.63213571]
Stock Position:  0.6321357069583116
Bond Position:  [-56.40339048]


portfolio before change:  [3.18576868]
curr_Stock_Price:  94.27197962455398
curr_Factors:  [94.27197962]
mat_Sqrt:  [[0.15]]
grads:  [-0.00753815]
Stock Position:  -0.007538150667126655
Bond Position:  [3.89640507]


portfolio before change:  [3.18224739]
curr_Stock_Price:  94.7714150094426
curr_Factors:  [94.77141501]
mat_Sqrt:  [[0.15]]
grads:  [0.10801723]
Stock Position:  0.10801723381070365
Bond Position:  [-7.0546987]


portfolio before change:  [3.34741692]
curr_Stock_Price:  96.30460048823858
curr_Factors:  [96.30460049]
mat_Sqrt:  [[0.15]]
grads:  [-0.02285906]
Stock Position:  -0.022859057641575777
Bond Position:  [5.54884933]


portfolio before change:  [3.3327207]
curr_Stock_Price:  96.96267794803556
curr_Factors:  [96.96267795]
mat_Sqrt:  [[0.15]]
grads:  [-0.15886054]
Stock Position:  -0.15886054300237828
Bond Position:  [18.73626437]


portfolio before change:  [3.39290682]
curr_Stock_Price:  96.59118817540217
curr_Factors:  [96.59118818]
mat_Sqrt:  [[0.15]]
grads:  [0.13951371]
Stock Position:  0.13951370776616323
Bond Position:  [-10.08288798]


portfolio before change:  [3.37368065]
curr_Stock_Price:  96.45789679652215
curr_Factors:  [96.4578968]
mat_Sqrt:  [[0.15]]
grads:  [0.07329755]
Stock Position:  0.07329755328946602
Bond Position:  [-3.69644719]


portfolio before change:  [3.34923099]
curr_Stock_Price:  96.12748161848076
curr_Factors:  [96.12748162]
mat_Sqrt:  [[0.15]]
grads:  [-0.2058427]
Stock Position:  -0.20584270422223824
Bond Position:  [23.13637175]


portfolio before change:  [3.26182195]
curr_Stock_Price:  96.55914667984682
curr_Factors:  [96.55914668]
mat_Sqrt:  [[0.15]]
grads:  [0.05405629]
Stock Position:  0.05405629254203073
Bond Position:  [-1.95780753]


portfolio before change:  [3.21557829]
curr_Stock_Price:  95.70593815019963
curr_Factors:  [95.70593815]
mat_Sqrt:  [[0.15]]
grads:  [-0.0033355]
Stock Position:  -0.0033354950067245328
Bond Position:  [3.53480497]


portfolio before change:  [3.21470217]
curr_Stock_Price:  96.03484297171566
curr_Factors:  [96.03484297]
mat_Sqrt:  [[0.15]]
grads:  [-0.04134327]
Stock Position:  -0.04134326650689003
Bond Position:  [7.18509627]


portfolio before change:  [3.21950903]
curr_Stock_Price:  95.92943810008005
curr_Factors:  [95.9294381]
mat_Sqrt:  [[0.15]]
grads:  [0.04848446]
Stock Position:  0.04848445740641193
Bond Position:  [-1.43157772]


portfolio before change:  [3.21586117]
curr_Stock_Price:  95.85604580296888
curr_Factors:  [95.8560458]
mat_Sqrt:  [[0.15]]
grads:  [-0.1237187]
Stock Position:  -0.12371870435952287
Bond Position:  [15.07504696]


portfolio before change:  [3.14692211]
curr_Stock_Price:  96.42088586532293
curr_Factors:  [96.42088587]
mat_Sqrt:  [[0.15]]
grads:  [0.28828006]
Stock Position:  0.2882800613670955
Bond Position:  [-24.64929679]


portfolio before change:  [2.99415893]
curr_Stock_Price:  95.89631769694117
curr_Factors:  [95.8963177]
mat_Sqrt:  [[0.15]]
grads:  [0.01154823]
Stock Position:  0.011548232788147553
Bond Position:  [1.88672593]


portfolio before change:  [2.99168719]
curr_Stock_Price:  95.6720693867592
curr_Factors:  [95.67206939]
mat_Sqrt:  [[0.15]]
grads:  [0.05779918]
Stock Position:  0.05779918218609153
Bond Position:  [-2.53808018]


portfolio before change:  [2.98366741]
curr_Stock_Price:  95.53606148624695
curr_Factors:  [95.53606149]
mat_Sqrt:  [[0.15]]
grads:  [-0.06264578]
Stock Position:  -0.06264578037537873
Bond Position:  [8.96859853]


portfolio before change:  [2.996069]
curr_Stock_Price:  95.34704576701063
curr_Factors:  [95.34704577]
mat_Sqrt:  [[0.15]]
grads:  [-0.01798818]
Stock Position:  -0.017988180979622514
Bond Position:  [4.71118891]


portfolio before change:  [3.00911192]
curr_Stock_Price:  94.6383323013797
curr_Factors:  [94.6383323]
mat_Sqrt:  [[0.15]]
grads:  [-0.11714666]
Stock Position:  -0.11714666131051078
Bond Position:  [14.09567658]


portfolio before change:  [3.05543713]
curr_Stock_Price:  94.2504065911525
curr_Factors:  [94.25040659]
mat_Sqrt:  [[0.15]]
grads:  [-0.08682949]
Stock Position:  -0.08682949033127886
Bond Position:  [11.2391519]


portfolio before change:  [3.07992938]
curr_Stock_Price:  93.97642390469096
curr_Factors:  [93.9764239]
mat_Sqrt:  [[0.15]]
grads:  [0.01551609]
Stock Position:  0.01551608827925207
Bond Position:  [1.62178289]


portfolio before change:  [3.09067356]
curr_Stock_Price:  94.66234512567665
curr_Factors:  [94.66234513]
mat_Sqrt:  [[0.15]]
grads:  [-0.01899954]
Stock Position:  -0.018999536702180807
Bond Position:  [4.88921426]


portfolio before change:  [3.0840122]
curr_Stock_Price:  95.02903529728063
curr_Factors:  [95.0290353]
mat_Sqrt:  [[0.15]]
grads:  [-0.05870405]
Stock Position:  -0.05870405376048829
Bond Position:  [8.6626018]


portfolio before change:  [3.06843175]
curr_Stock_Price:  95.30366510403022
curr_Factors:  [95.3036651]
mat_Sqrt:  [[0.15]]
grads:  [-0.02763078]
Stock Position:  -0.027630782488542588
Bond Position:  [5.70174659]


portfolio before change:  [3.07624888]
curr_Stock_Price:  95.03364889278255
curr_Factors:  [95.03364889]
mat_Sqrt:  [[0.15]]
grads:  [0.01858883]
Stock Position:  0.018588826361523165
Bond Position:  [1.30968488]


portfolio before change:  [3.08419325]
curr_Stock_Price:  95.45661866974919
curr_Factors:  [95.45661867]
mat_Sqrt:  [[0.15]]
grads:  [0.02504863]
Stock Position:  0.025048631734696125
Bond Position:  [0.69313556]


portfolio before change:  [3.08179214]
curr_Stock_Price:  95.35903141498342
curr_Factors:  [95.35903141]
mat_Sqrt:  [[0.15]]
grads:  [-0.00810527]
Stock Position:  -0.008105266893202881
Bond Position:  [3.85470254]


portfolio before change:  [3.08641214]
curr_Stock_Price:  94.81875579499129
curr_Factors:  [94.81875579]
mat_Sqrt:  [[0.15]]
grads:  [0.09904718]
Stock Position:  0.09904718070973885
Bond Position:  [-6.3051183]


portfolio before change:  [3.00000566]
curr_Stock_Price:  93.95035750290197
curr_Factors:  [93.9503575]
mat_Sqrt:  [[0.15]]
grads:  [0.05998942]
Stock Position:  0.05998941731671706
Bond Position:  [-2.63602154]


portfolio before change:  [2.97338622]
curr_Stock_Price:  93.50936824762512
curr_Factors:  [93.50936825]
mat_Sqrt:  [[0.15]]
grads:  [-0.008423]
Stock Position:  -0.008422996928685016
Bond Position:  [3.76101534]


portfolio before change:  [2.96988111]
curr_Stock_Price:  93.95341143019081
curr_Factors:  [93.95341143]
mat_Sqrt:  [[0.15]]
grads:  [0.0987778]
Stock Position:  0.09877780327351283
Bond Position:  [-6.31063048]


portfolio before change:  [2.95931609]
curr_Stock_Price:  93.8504470750281
curr_Factors:  [93.85044708]
mat_Sqrt:  [[0.15]]
grads:  [0.08616887]
Stock Position:  0.0861688687907755
Bond Position:  [-5.12767077]


portfolio before change:  [2.94784591]
curr_Stock_Price:  93.72105351004934
curr_Factors:  [93.72105351]
mat_Sqrt:  [[0.15]]
grads:  [-0.05752576]
Stock Position:  -0.05752575768871237
Bond Position:  [8.33922052]


portfolio before change:  [2.90101502]
curr_Stock_Price:  94.54419967638754
curr_Factors:  [94.54419968]
mat_Sqrt:  [[0.15]]
grads:  [-0.04498629]
Stock Position:  -0.0449862949427541
Bond Position:  [7.15420827]


portfolio before change:  [2.91110476]
curr_Stock_Price:  94.3298545693365
curr_Factors:  [94.32985457]
mat_Sqrt:  [[0.15]]
grads:  [-0.20478893]
Stock Position:  -0.2047889326333603
Bond Position:  [22.22881499]


portfolio before change:  [3.00329126]
curr_Stock_Price:  93.88648513889872
curr_Factors:  [93.88648514]
mat_Sqrt:  [[0.15]]
grads:  [-0.08641517]
Stock Position:  -0.08641517482861404
Bond Position:  [11.11650828]


portfolio before change:  [2.98441956]
curr_Stock_Price:  94.112909552602
curr_Factors:  [94.11290955]
mat_Sqrt:  [[0.15]]
grads:  [-0.02446994]
Stock Position:  -0.024469944105281305
Bond Position:  [5.28735719]


portfolio before change:  [2.97817953]
curr_Stock_Price:  94.38142225864195
curr_Factors:  [94.38142226]
mat_Sqrt:  [[0.15]]
grads:  [-0.03968591]
Stock Position:  -0.039685912929562354
Bond Position:  [6.72379244]


portfolio before change:  [2.98505112]
curr_Stock_Price:  94.21886247987763
curr_Factors:  [94.21886248]
mat_Sqrt:  [[0.15]]
grads:  [0.25101885]
Stock Position:  0.25101885456664985
Bond Position:  [-20.66565982]


portfolio before change:  [3.15800791]
curr_Stock_Price:  94.91302720056893
curr_Factors:  [94.9130272]
mat_Sqrt:  [[0.15]]
grads:  [0.05508138]
Stock Position:  0.05508137801496646
Bond Position:  [-2.06993242]


portfolio before change:  [3.15052107]
curr_Stock_Price:  94.77945279704777
curr_Factors:  [94.7794528]
mat_Sqrt:  [[0.15]]
grads:  [0.01155832]
Stock Position:  0.011558321309906305
Bond Position:  [2.0550297]


portfolio before change:  [3.14558729]
curr_Stock_Price:  94.34148059467248
curr_Factors:  [94.34148059]
mat_Sqrt:  [[0.15]]
grads:  [0.10065348]
Stock Position:  0.10065347931489145
Bond Position:  [-6.35021098]


portfolio before change:  [3.1497615]
curr_Stock_Price:  94.3868949341805
curr_Factors:  [94.38689493]
mat_Sqrt:  [[0.15]]
grads:  [-0.13084014]
Stock Position:  -0.13084013978720843
Bond Position:  [15.49935603]


portfolio before change:  [3.15173846]
curr_Stock_Price:  94.37918921957984
curr_Factors:  [94.37918922]
mat_Sqrt:  [[0.15]]
grads:  [0.14045295]
Stock Position:  0.14045295158773508
Bond Position:  [-10.10409724]


portfolio before change:  [3.28357492]
curr_Stock_Price:  95.32233770405482
curr_Factors:  [95.3223377]
mat_Sqrt:  [[0.15]]
grads:  [-0.05955194]
Stock Position:  -0.05955194497944835
Bond Position:  [8.96020553]


portfolio before change:  [3.24764783]
curr_Stock_Price:  95.9350317824217
curr_Factors:  [95.93503178]
mat_Sqrt:  [[0.15]]
grads:  [-0.0177388]
Stock Position:  -0.017738804123625992
Bond Position:  [4.94942056]


portfolio before change:  [3.24108192]
curr_Stock_Price:  96.3226144510319
curr_Factors:  [96.32261445]
mat_Sqrt:  [[0.15]]
grads:  [0.05116181]
Stock Position:  0.0511618117753292
Bond Position:  [-1.68695755]


portfolio before change:  [3.27953214]
curr_Stock_Price:  97.07621673945376
curr_Factors:  [97.07621674]
mat_Sqrt:  [[0.15]]
grads:  [-0.00474872]
Stock Position:  -0.004748715706648163
Bond Position:  [3.7405195]


portfolio before change:  [3.27859012]
curr_Stock_Price:  97.323823150689
curr_Factors:  [97.32382315]
mat_Sqrt:  [[0.15]]
grads:  [0.01543471]
Stock Position:  0.015434706315006059
Bond Position:  [1.77642549]


portfolio before change:  [3.2787488]
curr_Stock_Price:  97.32691059710106
curr_Factors:  [97.3269106]
mat_Sqrt:  [[0.15]]
grads:  [0.01367514]
Stock Position:  0.013675144631371053
Bond Position:  [1.94778922]


portfolio before change:  [3.27766987]
curr_Stock_Price:  97.2391110618588
curr_Factors:  [97.23911106]
mat_Sqrt:  [[0.15]]
grads:  [-0.07247784]
Stock Position:  -0.07247783955183665
Bond Position:  [10.32535056]


portfolio before change:  [3.30763608]
curr_Stock_Price:  96.83456185755988
curr_Factors:  [96.83456186]
mat_Sqrt:  [[0.15]]
grads:  [-0.19991843]
Stock Position:  -0.19991842968420465
Bond Position:  [22.66664962]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.30763608]
Stock Price:  96.59885901031821
PL:  [3.30763608]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.54061598e-02]
 [-2.30210502e-03]
 [ 4.28450147e-04]
 [ 2.29783740e-03]
 [ 1.74424016e-02]
 [ 1.18375056e-02]
 [ 9.94728552e-04]
 [ 1.35086638e-02]
 [ 1.73573100e-02]
 [-1.86164276e-02]
 [ 6.39816349e-03]
 [-6.28916279e-03]
 [-1.43475192e-03]
 [ 4.63289408e-03]
 [-1.84218942e-02]
 [ 1.54814220e-02]
 [-2.20093289e-03]
 [ 4.50432737e-03]
 [ 9.80086013e-03]
 [ 1.20296370e-02]
 [-7.91702083e-05]
 [-2.09667319e-02]
 [ 6.94199484e-04]
 [ 1.79463284e-03]
 [-3.75183451e-03]
 [ 1.70237908e-02]
 [ 1.64083659e-02]
 [-8.02630463e-03]
 [ 6.87324945e-04]
 [ 6.30684960e-03]
 [-3.42660988e-03]
 [-3.54496844e-02]
 [ 2.11900194e-02]
 [ 9.58472897e-03]
 [-2.39730595e-02]
 [ 7.73487407e-03]
 [-2.54748974e-03]
 [ 1.18024430e-03]
 [ 4.53827201e-03]
 [-1.66424116e-02]
 [ 3.35239683e-02]
 [-6.10674326e-04]
 [ 4.62529789e-03]
 [-8.48163103e-03]
 [ 4.78834398e-04]
 [-7.92025515e-03]
 [-1.34041503e-02]
 [-7.11399648e-05]
 [-4.77065283e-03]
 [ 6.20646446e-03]
 [-3.17913148e-03]
 [ 3.21090589e-03]
 [ 2.90879665e-03]
 [ 1.58842666e-03]
 [ 1.41968741e-03]
 [ 9.02615643e-03]
 [ 1.55361600e-02]
 [-2.75280876e-02]
 [ 1.39930243e-02]
 [ 6.69828496e-03]
 [ 9.66933211e-03]
 [-1.29238026e-02]
 [-1.25540688e-02]
 [-2.41370767e-03]
 [-1.99191221e-02]
 [ 3.67191917e-02]
 [ 1.39547615e-02]
 [ 2.00163749e-03]
 [ 7.40078343e-03]
 [-1.46748359e-02]
 [-5.65444942e-03]
 [-5.49904807e-04]
 [ 2.21143505e-03]
 [ 8.33438140e-03]
 [ 2.84713117e-03]
 [-1.30238434e-02]
 [ 3.10650359e-03]
 [-6.04653478e-03]
 [ 7.76344986e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.27728153]
curr_Stock_Price:  99.7208256744788
curr_Factors:  [99.72082567]
mat_Sqrt:  [[0.15]]
grads:  [-0.23604107]
Stock Position:  -0.23604106534051233
Bond Position:  [21.2609284]


portfolio before change:  [-2.37116307]
curr_Stock_Price:  100.12418935072668
curr_Factors:  [100.12418935]
mat_Sqrt:  [[0.15]]
grads:  [-0.01534737]
Stock Position:  -0.015347366773722296
Bond Position:  [-0.83452041]


portfolio before change:  [-2.36995688]
curr_Stock_Price:  100.04219832046178
curr_Factors:  [100.04219832]
mat_Sqrt:  [[0.15]]
grads:  [0.00285633]
Stock Position:  0.002856334312523864
Bond Position:  [-2.65571085]


portfolio before change:  [-2.36869261]
curr_Stock_Price:  100.54293203240017
curr_Factors:  [100.54293203]
mat_Sqrt:  [[0.15]]
grads:  [0.01531892]
Stock Position:  0.015318916012357105
Bond Position:  [-3.90890134]


portfolio before change:  [-2.3759876]
curr_Stock_Price:  100.08267229536814
curr_Factors:  [100.0826723]
mat_Sqrt:  [[0.15]]
grads:  [0.11628268]
Stock Position:  0.11628267742095587
Bond Position:  [-14.0138687]


portfolio before change:  [-2.35432993]
curr_Stock_Price:  100.27645494967399
curr_Factors:  [100.27645495]
mat_Sqrt:  [[0.15]]
grads:  [0.0789167]
Stock Position:  0.07891670422031477
Bond Position:  [-10.26781727]


portfolio before change:  [-2.40498963]
curr_Stock_Price:  99.64264821429938
curr_Factors:  [99.64264821]
mat_Sqrt:  [[0.15]]
grads:  [0.00663152]
Stock Position:  0.006631523682687622
Bond Position:  [-3.06577221]


portfolio before change:  [-2.40678984]
curr_Stock_Price:  99.40007968146995
curr_Factors:  [99.40007968]
mat_Sqrt:  [[0.15]]
grads:  [0.09005776]
Stock Position:  0.09005775878777902
Bond Position:  [-11.35853824]


portfolio before change:  [-2.43820159]
curr_Stock_Price:  99.05916716122411
curr_Factors:  [99.05916716]
mat_Sqrt:  [[0.15]]
grads:  [0.1157154]
Stock Position:  0.11571539972361329
Bond Position:  [-13.90087272]


portfolio before change:  [-2.34160023]
curr_Stock_Price:  99.90149405600873
curr_Factors:  [99.90149406]
mat_Sqrt:  [[0.15]]
grads:  [-0.12410952]
Stock Position:  -0.12410951717766787
Bond Position:  [10.05712596]


portfolio before change:  [-2.27170051]
curr_Stock_Price:  99.34334886855717
curr_Factors:  [99.34334887]
mat_Sqrt:  [[0.15]]
grads:  [0.04265442]
Stock Position:  0.04265442328306067
Bond Position:  [-6.50913376]


portfolio before change:  [-2.28800042]
curr_Stock_Price:  98.97074809612606
curr_Factors:  [98.9707481]
mat_Sqrt:  [[0.15]]
grads:  [-0.04192775]
Stock Position:  -0.04192775193459429
Bond Position:  [1.86162056]


portfolio before change:  [-2.26849206]
curr_Stock_Price:  98.50823831222966
curr_Factors:  [98.50823831]
mat_Sqrt:  [[0.15]]
grads:  [-0.00956501]
Stock Position:  -0.009565012789180758
Bond Position:  [-1.32625951]


portfolio before change:  [-2.26448669]
curr_Stock_Price:  98.0808194553181
curr_Factors:  [98.08081946]
mat_Sqrt:  [[0.15]]
grads:  [0.03088596]
Stock Position:  0.030885960564785184
Bond Position:  [-5.29380701]


portfolio before change:  [-2.27056599]
curr_Stock_Price:  97.89470172898437
curr_Factors:  [97.89470173]
mat_Sqrt:  [[0.15]]
grads:  [-0.12281263]
Stock Position:  -0.1228126279978916
Bond Position:  [9.7521396]


portfolio before change:  [-2.27795369]
curr_Stock_Price:  97.9598190602481
curr_Factors:  [97.95981906]
mat_Sqrt:  [[0.15]]
grads:  [0.10320948]
Stock Position:  0.10320948025110112
Bond Position:  [-12.3883357]


portfolio before change:  [-2.21777749]
curr_Stock_Price:  98.55037043477843
curr_Factors:  [98.55037043]
mat_Sqrt:  [[0.15]]
grads:  [-0.01467289]
Stock Position:  -0.014672885952053663
Bond Position:  [-0.77175914]


portfolio before change:  [-2.21906465]
curr_Stock_Price:  98.6348070510884
curr_Factors:  [98.63480705]
mat_Sqrt:  [[0.15]]
grads:  [0.03002885]
Stock Position:  0.030028849165209665
Bond Position:  [-5.1809544]


portfolio before change:  [-2.22926913]
curr_Stock_Price:  98.3057682148952
curr_Factors:  [98.30576821]
mat_Sqrt:  [[0.15]]
grads:  [0.06533907]
Stock Position:  0.065339067562866
Bond Position:  [-8.65247636]


portfolio before change:  [-2.19142477]
curr_Stock_Price:  98.89324452692965
curr_Factors:  [98.89324453]
mat_Sqrt:  [[0.15]]
grads:  [0.08019758]
Stock Position:  0.08019757973152436
Bond Position:  [-10.12242364]


portfolio before change:  [-2.27179085]
curr_Stock_Price:  97.89903238232802
curr_Factors:  [97.89903238]
mat_Sqrt:  [[0.15]]
grads:  [-0.0005278]
Stock Position:  -0.0005278013888508164
Bond Position:  [-2.22011961]


portfolio before change:  [-2.27207574]
curr_Stock_Price:  98.1758864945705
curr_Factors:  [98.17588649]
mat_Sqrt:  [[0.15]]
grads:  [-0.13977821]
Stock Position:  -0.13977821244693195
Bond Position:  [11.45077418]


portfolio before change:  [-2.10747938]
curr_Stock_Price:  97.00345295208076
curr_Factors:  [97.00345295]
mat_Sqrt:  [[0.15]]
grads:  [0.004628]
Stock Position:  0.004627996556903919
Bond Position:  [-2.55641102]


portfolio before change:  [-2.10876365]
curr_Stock_Price:  96.76047658795083
curr_Factors:  [96.76047659]
mat_Sqrt:  [[0.15]]
grads:  [0.01196422]
Stock Position:  0.01196421895085284
Bond Position:  [-3.26642718]


portfolio before change:  [-2.10674532]
curr_Stock_Price:  96.94623767628393
curr_Factors:  [96.94623768]
mat_Sqrt:  [[0.15]]
grads:  [-0.02501223]
Stock Position:  -0.025012230082862175
Bond Position:  [0.31809628]


portfolio before change:  [-2.10150618]
curr_Stock_Price:  96.73756913677596
curr_Factors:  [96.73756914]
mat_Sqrt:  [[0.15]]
grads:  [0.11349194]
Stock Position:  0.11349193894490836
Bond Position:  [-13.08044047]


portfolio before change:  [-2.07665763]
curr_Stock_Price:  96.96371826574779
curr_Factors:  [96.96371827]
mat_Sqrt:  [[0.15]]
grads:  [0.10938911]
Stock Position:  0.10938910622614746
Bond Position:  [-12.6834321]


portfolio before change:  [-2.02986071]
curr_Stock_Price:  97.39876754560318
curr_Factors:  [97.39876755]
mat_Sqrt:  [[0.15]]
grads:  [-0.0535087]
Stock Position:  -0.05350869755594463
Bond Position:  [3.18182048]


portfolio before change:  [-2.00592495]
curr_Stock_Price:  96.95515950918131
curr_Factors:  [96.95515951]
mat_Sqrt:  [[0.15]]
grads:  [0.00458217]
Stock Position:  0.004582166300289019
Bond Position:  [-2.45018962]


portfolio before change:  [-2.00943705]
curr_Stock_Price:  96.22211115054564
curr_Factors:  [96.22211115]
mat_Sqrt:  [[0.15]]
grads:  [0.04204566]
Stock Position:  0.042045663983560265
Bond Position:  [-6.0551596]


portfolio before change:  [-2.00057186]
curr_Stock_Price:  96.44195887425875
curr_Factors:  [96.44195887]
mat_Sqrt:  [[0.15]]
grads:  [-0.02284407]
Stock Position:  -0.022844065895609077
Bond Position:  [0.2025546]


portfolio before change:  [-1.99273403]
curr_Stock_Price:  96.09941178520594
curr_Factors:  [96.09941179]
mat_Sqrt:  [[0.15]]
grads:  [-0.23633123]
Stock Position:  -0.23633122947080365
Bond Position:  [20.71855811]


portfolio before change:  [-2.07769112]
curr_Stock_Price:  96.46437428009092
curr_Factors:  [96.46437428]
mat_Sqrt:  [[0.15]]
grads:  [0.1412668]
Stock Position:  0.14126679598338684
Bond Position:  [-15.7049042]


portfolio before change:  [-1.9828261]
curr_Stock_Price:  97.14285363213715
curr_Factors:  [97.14285363]
mat_Sqrt:  [[0.15]]
grads:  [0.06389819]
Stock Position:  0.06389819310891955
Bond Position:  [-8.19007892]


portfolio before change:  [-1.98178592]
curr_Stock_Price:  97.16714340010209
curr_Factors:  [97.1671434]
mat_Sqrt:  [[0.15]]
grads:  [-0.1598204]
Stock Position:  -0.1598203964469439
Bond Position:  [13.54750546]


portfolio before change:  [-2.05117306]
curr_Stock_Price:  97.60659845557271
curr_Factors:  [97.60659846]
mat_Sqrt:  [[0.15]]
grads:  [0.05156583]
Stock Position:  0.05156582714827635
Bond Position:  [-7.08433804]


portfolio before change:  [-2.08643228]
curr_Stock_Price:  96.93141418502947
curr_Factors:  [96.93141419]
mat_Sqrt:  [[0.15]]
grads:  [-0.01698326]
Stock Position:  -0.016983264956817783
Bond Position:  [-0.44022039]


portfolio before change:  [-2.09128201]
curr_Stock_Price:  97.21535324203755
curr_Factors:  [97.21535324]
mat_Sqrt:  [[0.15]]
grads:  [0.0078683]
Stock Position:  0.007868295343192422
Bond Position:  [-2.85620112]


portfolio before change:  [-2.08914059]
curr_Stock_Price:  97.51019948038638
curr_Factors:  [97.51019948]
mat_Sqrt:  [[0.15]]
grads:  [0.03025515]
Stock Position:  0.030255146737696855
Bond Position:  [-5.03932598]


portfolio before change:  [-2.10921903]
curr_Stock_Price:  96.85697253205139
curr_Factors:  [96.85697253]
mat_Sqrt:  [[0.15]]
grads:  [-0.11094941]
Stock Position:  -0.11094941084317585
Bond Position:  [8.63700501]


portfolio before change:  [-2.20321946]
curr_Stock_Price:  97.70907493304149
curr_Factors:  [97.70907493]
mat_Sqrt:  [[0.15]]
grads:  [0.22349312]
Stock Position:  0.22349312201672472
Bond Position:  [-24.04052567]


portfolio before change:  [-2.2204013]
curr_Stock_Price:  97.63891948861023
curr_Factors:  [97.63891949]
mat_Sqrt:  [[0.15]]
grads:  [-0.00407116]
Stock Position:  -0.004071162170284705
Bond Position:  [-1.82289743]


portfolio before change:  [-2.22149047]
curr_Stock_Price:  97.87846524561306
curr_Factors:  [97.87846525]
mat_Sqrt:  [[0.15]]
grads:  [0.03083532]
Stock Position:  0.030835319273974968
Bond Position:  [-5.23960419]


portfolio before change:  [-2.2298017]
curr_Stock_Price:  97.61954942291476
curr_Factors:  [97.61954942]
mat_Sqrt:  [[0.15]]
grads:  [-0.05654421]
Stock Position:  -0.0565442068774859
Bond Position:  [3.29001829]


portfolio before change:  [-2.20936593]
curr_Stock_Price:  97.26177377764441
curr_Factors:  [97.26177378]
mat_Sqrt:  [[0.15]]
grads:  [0.00319223]
Stock Position:  0.003192229317024427
Bond Position:  [-2.51984782]


portfolio before change:  [-2.21051106]
curr_Stock_Price:  96.95238548203467
curr_Factors:  [96.95238548]
mat_Sqrt:  [[0.15]]
grads:  [-0.0528017]
Stock Position:  -0.05280170099523666
Bond Position:  [2.9087398]


portfolio before change:  [-2.19072095]
curr_Stock_Price:  96.58102796681273
curr_Factors:  [96.58102797]
mat_Sqrt:  [[0.15]]
grads:  [-0.089361]
Stock Position:  -0.08936100231860869
Bond Position:  [6.43985651]


portfolio before change:  [-2.20851431]
curr_Stock_Price:  96.78464992216026
curr_Factors:  [96.78464992]
mat_Sqrt:  [[0.15]]
grads:  [-0.00047427]
Stock Position:  -0.00047426643222326395
Bond Position:  [-2.1626126]


portfolio before change:  [-2.20904275]
curr_Stock_Price:  97.61386137986344
curr_Factors:  [97.61386138]
mat_Sqrt:  [[0.15]]
grads:  [-0.03180435]
Stock Position:  -0.03180435219148259
Bond Position:  [0.89550288]


portfolio before change:  [-2.21962383]
curr_Stock_Price:  97.94831411736978
curr_Factors:  [97.94831412]
mat_Sqrt:  [[0.15]]
grads:  [0.04137643]
Stock Position:  0.04137642971792969
Bond Position:  [-6.27237536]


portfolio before change:  [-2.20604696]
curr_Stock_Price:  98.28591960906239
curr_Factors:  [98.28591961]
mat_Sqrt:  [[0.15]]
grads:  [-0.02119421]
Stock Position:  -0.021194209891891427
Bond Position:  [-0.12295455]


portfolio before change:  [-2.20871112]
curr_Stock_Price:  98.41125969455312
curr_Factors:  [98.41125969]
mat_Sqrt:  [[0.15]]
grads:  [0.02140604]
Stock Position:  0.021406039255440722
Bond Position:  [-4.31530641]


portfolio before change:  [-2.20826828]
curr_Stock_Price:  98.4445472483441
curr_Factors:  [98.44454725]
mat_Sqrt:  [[0.15]]
grads:  [0.01939198]
Stock Position:  0.01939197765367852
Bond Position:  [-4.11730275]


portfolio before change:  [-2.21033227]
curr_Stock_Price:  98.35138263018594
curr_Factors:  [98.35138263]
mat_Sqrt:  [[0.15]]
grads:  [0.01058951]
Stock Position:  0.010589511034957963
Bond Position:  [-3.25182532]


portfolio before change:  [-2.20305872]
curr_Stock_Price:  99.05743909051097
curr_Factors:  [99.05743909]
mat_Sqrt:  [[0.15]]
grads:  [0.00946458]
Stock Position:  0.009464582747147942
Bond Position:  [-3.14059605]


portfolio before change:  [-2.20089253]
curr_Stock_Price:  99.30705203354795
curr_Factors:  [99.30705203]
mat_Sqrt:  [[0.15]]
grads:  [0.06017438]
Stock Position:  0.06017437618404244
Bond Position:  [-8.17663244]


portfolio before change:  [-2.17929983]
curr_Stock_Price:  99.6743804359927
curr_Factors:  [99.67438044]
mat_Sqrt:  [[0.15]]
grads:  [0.1035744]
Stock Position:  0.10357440029556081
Bond Position:  [-12.50301401]


portfolio before change:  [-2.22047997]
curr_Stock_Price:  99.28433542589363
curr_Factors:  [99.28433543]
mat_Sqrt:  [[0.15]]
grads:  [-0.18352058]
Stock Position:  -0.1835205841177566
Bond Position:  [16.00023926]


portfolio before change:  [-2.37735321]
curr_Stock_Price:  100.14458379844065
curr_Factors:  [100.1445838]
mat_Sqrt:  [[0.15]]
grads:  [0.09328683]
Stock Position:  0.09328682871708611
Bond Position:  [-11.71952385]


portfolio before change:  [-2.2921594]
curr_Stock_Price:  101.06568169438671
curr_Factors:  [101.06568169]
mat_Sqrt:  [[0.15]]
grads:  [0.04465523]
Stock Position:  0.044655233060395885
Bond Position:  [-6.80527097]


portfolio before change:  [-2.29308805]
curr_Stock_Price:  101.05441071081138
curr_Factors:  [101.05441071]
mat_Sqrt:  [[0.15]]
grads:  [0.06446221]
Stock Position:  0.0644622140662601
Bond Position:  [-8.80727911]


portfolio before change:  [-2.30459523]
curr_Stock_Price:  100.88443967850985
curr_Factors:  [100.88443968]
mat_Sqrt:  [[0.15]]
grads:  [-0.08615868]
Stock Position:  -0.08615868378789004
Bond Position:  [6.3874753]


portfolio before change:  [-2.30475057]
curr_Stock_Price:  100.89087619469201
curr_Factors:  [100.89087619]
mat_Sqrt:  [[0.15]]
grads:  [-0.08369379]
Stock Position:  -0.08369379201391272
Bond Position:  [6.13918944]


portfolio before change:  [-2.33369678]
curr_Stock_Price:  101.24131942165587
curr_Factors:  [101.24131942]
mat_Sqrt:  [[0.15]]
grads:  [-0.01609138]
Stock Position:  -0.01609138444241347
Bond Position:  [-0.70458379]


portfolio before change:  [-2.33250441]
curr_Stock_Price:  101.16448323102891
curr_Factors:  [101.16448323]
mat_Sqrt:  [[0.15]]
grads:  [-0.13279415]
Stock Position:  -0.13279414744032975
Bond Position:  [11.10154689]


portfolio before change:  [-2.25609264]
curr_Stock_Price:  100.59429317524989
curr_Factors:  [100.59429318]
mat_Sqrt:  [[0.15]]
grads:  [0.24479461]
Stock Position:  0.2447946113716913
Bond Position:  [-26.88103355]


portfolio before change:  [-2.54958758]
curr_Stock_Price:  99.4022129317187
curr_Factors:  [99.40221293]
mat_Sqrt:  [[0.15]]
grads:  [0.09303174]
Stock Position:  0.09303174302810796
Bond Position:  [-11.79714871]


portfolio before change:  [-2.58766909]
curr_Stock_Price:  99.0007998313311
curr_Factors:  [99.00079983]
mat_Sqrt:  [[0.15]]
grads:  [0.01334425]
Stock Position:  0.013344249919396431
Bond Position:  [-3.9087605]


portfolio before change:  [-2.58592482]
curr_Stock_Price:  99.14982086396026
curr_Factors:  [99.14982086]
mat_Sqrt:  [[0.15]]
grads:  [0.04933856]
Stock Position:  0.049338556195681386
Bond Position:  [-7.47783383]


portfolio before change:  [-2.5697092]
curr_Stock_Price:  99.48795387853345
curr_Factors:  [99.48795388]
mat_Sqrt:  [[0.15]]
grads:  [-0.09783224]
Stock Position:  -0.09783223953387134
Bond Position:  [7.16342013]


portfolio before change:  [-2.57592633]
curr_Stock_Price:  99.55607922288362
curr_Factors:  [99.55607922]
mat_Sqrt:  [[0.15]]
grads:  [-0.03769633]
Stock Position:  -0.03769632946870503
Bond Position:  [1.17697243]


portfolio before change:  [-2.59247398]
curr_Stock_Price:  99.99700320236258
curr_Factors:  [99.9970032]
mat_Sqrt:  [[0.15]]
grads:  [-0.00366603]
Stock Position:  -0.0036660320477356913
Bond Position:  [-2.22588176]


portfolio before change:  [-2.5948328]
curr_Stock_Price:  100.60248055255533
curr_Factors:  [100.60248055]
mat_Sqrt:  [[0.15]]
grads:  [0.0147429]
Stock Position:  0.014742900330860521
Bond Position:  [-4.07800515]


portfolio before change:  [-2.58121093]
curr_Stock_Price:  101.54373080325954
curr_Factors:  [101.5437308]
mat_Sqrt:  [[0.15]]
grads:  [0.05556254]
Stock Position:  0.05556254263491495
Bond Position:  [-8.2232388]


portfolio before change:  [-2.55976155]
curr_Stock_Price:  101.93902133945546
curr_Factors:  [101.93902134]
mat_Sqrt:  [[0.15]]
grads:  [0.01898087]
Stock Position:  0.01898087449918857
Bond Position:  [-4.49465332]


portfolio before change:  [-2.54915723]
curr_Stock_Price:  102.51250627755532
curr_Factors:  [102.51250628]
mat_Sqrt:  [[0.15]]
grads:  [-0.08682562]
Stock Position:  -0.08682562270122816
Bond Position:  [6.35155496]


portfolio before change:  [-2.46722517]
curr_Stock_Price:  101.57343934558459
curr_Factors:  [101.57343935]
mat_Sqrt:  [[0.15]]
grads:  [0.02071002]
Stock Position:  0.02071002396102105
Bond Position:  [-4.57081354]


portfolio before change:  [-2.46786513]
curr_Stock_Price:  101.55633277309502
curr_Factors:  [101.55633277]
mat_Sqrt:  [[0.15]]
grads:  [-0.04031023]
Stock Position:  -0.04031023189780736
Bond Position:  [1.62589419]


portfolio before change:  [-2.43421386]
curr_Stock_Price:  100.72404654611985
curr_Factors:  [100.72404655]
mat_Sqrt:  [[0.15]]
grads:  [0.05175633]
Stock Position:  0.05175633241137692
Bond Position:  [-7.6473211]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.43421386]
Stock Price:  100.95305257710842
PL:  [-3.38726644]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.01834191e-02]
 [ 2.00759509e-04]
 [ 1.41124314e-03]
 [ 2.33968026e-03]
 [ 1.98724292e-02]
 [ 1.19184393e-02]
 [ 1.19290431e-03]
 [ 9.39945646e-03]
 [-1.74575314e-03]
 [-2.00854839e-02]
 [ 1.02660308e-02]
 [-5.02206364e-03]
 [-9.22702978e-03]
 [ 4.22150488e-03]
 [ 5.99385958e-03]
 [-5.02096522e-05]
 [ 1.45965519e-02]
 [ 2.10290644e-02]
 [ 1.89642050e-02]
 [ 1.08470089e-04]
 [ 5.14223901e-02]
 [-1.24428579e-02]
 [ 2.24987803e-03]
 [-3.53668994e-03]
 [ 1.72310019e-02]
 [ 1.83142955e-02]
 [ 1.00614627e-02]
 [ 5.56979440e-03]
 [ 6.24037983e-03]
 [-1.82656976e-02]
 [-5.37404361e-03]
 [ 2.56383788e-02]
 [ 7.40175005e-03]
 [ 7.86080855e-03]
 [-3.37388521e-04]
 [-4.75893918e-03]
 [-4.90136515e-03]
 [ 1.03106225e-02]
 [-3.95967216e-04]
 [-8.90250515e-03]
 [-1.70879712e-02]
 [-2.83646694e-03]
 [ 8.64376601e-03]
 [-1.48628103e-02]
 [ 2.93211497e-03]
 [-1.88873915e-03]
 [-1.36934492e-02]
 [-5.04600510e-03]
 [-5.33752419e-05]
 [ 3.85444047e-03]
 [-2.97926136e-03]
 [ 3.77753362e-03]
 [ 3.88132655e-06]
 [ 8.45214571e-04]
 [ 2.45897653e-03]
 [ 8.52895544e-03]
 [-5.88970786e-03]
 [-1.84097508e-02]
 [ 1.37047541e-02]
 [ 8.28860401e-03]
 [ 7.79438289e-03]
 [-1.24950057e-02]
 [-1.26293761e-02]
 [-1.11249502e-03]
 [-1.17184142e-02]
 [ 2.67102708e-03]
 [ 1.49477424e-02]
 [ 2.22330406e-03]
 [ 6.06706989e-03]
 [-1.43511784e-02]
 [-5.60477054e-03]
 [ 2.06729035e-03]
 [ 1.07187457e-04]
 [ 8.72064037e-03]
 [ 8.06100768e-03]
 [-1.68060686e-03]
 [-6.29234609e-03]
 [-9.34675280e-03]
 [-3.65557543e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.79210623]
curr_Stock_Price:  100.17517988897681
curr_Factors:  [100.17517989]
mat_Sqrt:  [[0.15]]
grads:  [-0.26788946]
Stock Position:  -0.2678894605783312
Bond Position:  [31.62798114]


portfolio before change:  [4.61548714]
curr_Stock_Price:  100.84185747802648
curr_Factors:  [100.84185748]
mat_Sqrt:  [[0.15]]
grads:  [0.0013384]
Stock Position:  0.0013383967263785866
Bond Position:  [4.48052073]


portfolio before change:  [4.61578682]
curr_Stock_Price:  100.85652758599676
curr_Factors:  [100.85652759]
mat_Sqrt:  [[0.15]]
grads:  [0.00940829]
Stock Position:  0.00940828759192833
Bond Position:  [3.6668996]


portfolio before change:  [4.61465645]
curr_Stock_Price:  100.71202102763218
curr_Factors:  [100.71202103]
mat_Sqrt:  [[0.15]]
grads:  [0.01559787]
Stock Position:  0.015597868374472856
Bond Position:  [3.0437636]


portfolio before change:  [4.6037625]
curr_Stock_Price:  100.00139904863524
curr_Factors:  [100.00139905]
mat_Sqrt:  [[0.15]]
grads:  [0.13248286]
Stock Position:  0.1324828610072169
Bond Position:  [-8.64470895]


portfolio before change:  [4.72229601]
curr_Stock_Price:  100.90018561716919
curr_Factors:  [100.90018562]
mat_Sqrt:  [[0.15]]
grads:  [0.07945626]
Stock Position:  0.07945626220851644
Bond Position:  [-3.2948556]


portfolio before change:  [4.66021304]
curr_Stock_Price:  100.12142974064479
curr_Factors:  [100.12142974]
mat_Sqrt:  [[0.15]]
grads:  [0.0079527]
Stock Position:  0.007952695429023207
Bond Position:  [3.86397781]


portfolio before change:  [4.66520439]
curr_Stock_Price:  100.71869225520612
curr_Factors:  [100.71869226]
mat_Sqrt:  [[0.15]]
grads:  [0.06266304]
Stock Position:  0.06266304303807846
Bond Position:  [-1.64613535]


portfolio before change:  [4.67250478]
curr_Stock_Price:  100.83683634697479
curr_Factors:  [100.83683635]
mat_Sqrt:  [[0.15]]
grads:  [-0.01163835]
Stock Position:  -0.011638354267163161
Bond Position:  [5.8460796]


portfolio before change:  [4.67880225]
curr_Stock_Price:  100.32713524824929
curr_Factors:  [100.32713525]
mat_Sqrt:  [[0.15]]
grads:  [-0.13390323]
Stock Position:  -0.1339032258881752
Bond Position:  [18.1129293]


portfolio before change:  [4.63119276]
curr_Stock_Price:  100.69114126418908
curr_Factors:  [100.69114126]
mat_Sqrt:  [[0.15]]
grads:  [0.06844021]
Stock Position:  0.06844020510393747
Bond Position:  [-2.2601296]


portfolio before change:  [4.59265623]
curr_Stock_Price:  100.13013662845106
curr_Factors:  [100.13013663]
mat_Sqrt:  [[0.15]]
grads:  [-0.03348042]
Stock Position:  -0.0334804242543018
Bond Position:  [7.94505568]


portfolio before change:  [4.59568813]
curr_Stock_Price:  100.05441113030729
curr_Factors:  [100.05441113]
mat_Sqrt:  [[0.15]]
grads:  [-0.06151353]
Stock Position:  -0.061513531852901975
Bond Position:  [10.75038834]


portfolio before change:  [4.55386193]
curr_Stock_Price:  100.74528546314563
curr_Factors:  [100.74528546]
mat_Sqrt:  [[0.15]]
grads:  [0.02814337]
Stock Position:  0.02814336585212269
Bond Position:  [1.71855051]


portfolio before change:  [4.54774213]
curr_Stock_Price:  100.52401776509802
curr_Factors:  [100.52401777]
mat_Sqrt:  [[0.15]]
grads:  [0.03995906]
Stock Position:  0.039959063877195146
Bond Position:  [0.53089648]


portfolio before change:  [4.52919113]
curr_Stock_Price:  100.05893737252987
curr_Factors:  [100.05893737]
mat_Sqrt:  [[0.15]]
grads:  [-0.00033473]
Stock Position:  -0.0003347310143878013
Bond Position:  [4.56268396]


portfolio before change:  [4.52925202]
curr_Stock_Price:  100.72899388136337
curr_Factors:  [100.72899388]
mat_Sqrt:  [[0.15]]
grads:  [0.09731035]
Stock Position:  0.09731034608872986
Bond Position:  [-5.27272124]


portfolio before change:  [4.57850324]
curr_Stock_Price:  101.2385057028041
curr_Factors:  [101.2385057]
mat_Sqrt:  [[0.15]]
grads:  [0.14019376]
Stock Position:  0.1401937626384336
Bond Position:  [-9.6145038]


portfolio before change:  [4.56505107]
curr_Stock_Price:  101.14683798047034
curr_Factors:  [101.14683798]
mat_Sqrt:  [[0.15]]
grads:  [0.12642803]
Stock Position:  0.12642803303407749
Bond Position:  [-8.22274471]


portfolio before change:  [4.5930532]
curr_Stock_Price:  101.37238979130403
curr_Factors:  [101.37238979]
mat_Sqrt:  [[0.15]]
grads:  [0.00072313]
Stock Position:  0.0007231339252300288
Bond Position:  [4.51974739]


portfolio before change:  [4.59389556]
curr_Stock_Price:  102.14660555065197
curr_Factors:  [102.14660555]
mat_Sqrt:  [[0.15]]
grads:  [0.34281593]
Stock Position:  0.3428159340724436
Bond Position:  [-30.42358844]


portfolio before change:  [4.65546942]
curr_Stock_Price:  102.33176439177096
curr_Factors:  [102.33176439]
mat_Sqrt:  [[0.15]]
grads:  [-0.08295239]
Stock Position:  -0.08295238623758701
Bond Position:  [13.14413347]


portfolio before change:  [4.58057869]
curr_Stock_Price:  103.244483989171
curr_Factors:  [103.24448399]
mat_Sqrt:  [[0.15]]
grads:  [0.01499919]
Stock Position:  0.014999186859766256
Bond Position:  [3.03199538]


portfolio before change:  [4.56986591]
curr_Stock_Price:  102.51762546556743
curr_Factors:  [102.51762547]
mat_Sqrt:  [[0.15]]
grads:  [-0.02357793]
Stock Position:  -0.02357793296236039
Bond Position:  [6.98701961]


portfolio before change:  [4.57655976]
curr_Stock_Price:  102.2522439484265
curr_Factors:  [102.25224395]
mat_Sqrt:  [[0.15]]
grads:  [0.11487335]
Stock Position:  0.11487334602066145
Bond Position:  [-7.16949764]


portfolio before change:  [4.5895732]
curr_Stock_Price:  102.3694299349273
curr_Factors:  [102.36942993]
mat_Sqrt:  [[0.15]]
grads:  [0.1220953]
Stock Position:  0.12209530328191358
Bond Position:  [-7.9092534]


portfolio before change:  [4.61583912]
curr_Stock_Price:  102.58860513780603
curr_Factors:  [102.58860514]
mat_Sqrt:  [[0.15]]
grads:  [0.06707642]
Stock Position:  0.06707641782405772
Bond Position:  [-2.26543703]


portfolio before change:  [4.5935027]
curr_Stock_Price:  102.25771659368147
curr_Factors:  [102.25771659]
mat_Sqrt:  [[0.15]]
grads:  [0.03713196]
Stock Position:  0.03713196269815845
Bond Position:  [0.79647299]


portfolio before change:  [4.609043]
curr_Stock_Price:  102.67489120702848
curr_Factors:  [102.67489121]
mat_Sqrt:  [[0.15]]
grads:  [0.04160253]
Stock Position:  0.04160253217382285
Bond Position:  [0.33750753]


portfolio before change:  [4.58802193]
curr_Stock_Price:  102.16910089020227
curr_Factors:  [102.16910089]
mat_Sqrt:  [[0.15]]
grads:  [-0.12177132]
Stock Position:  -0.1217713170676305
Bond Position:  [17.02928791]


portfolio before change:  [4.6697292]
curr_Stock_Price:  101.50685210608196
curr_Factors:  [101.50685211]
mat_Sqrt:  [[0.15]]
grads:  [-0.03582696]
Stock Position:  -0.035826957373803266
Bond Position:  [8.30641087]


portfolio before change:  [4.66051991]
curr_Stock_Price:  101.77839223798637
curr_Factors:  [101.77839224]
mat_Sqrt:  [[0.15]]
grads:  [0.17092253]
Stock Position:  0.17092252515208273
Bond Position:  [-12.73569989]


portfolio before change:  [4.70258196]
curr_Stock_Price:  102.02913771981312
curr_Factors:  [102.02913772]
mat_Sqrt:  [[0.15]]
grads:  [0.049345]
Stock Position:  0.049345000358107516
Bond Position:  [-0.33204588]


portfolio before change:  [4.66895659]
curr_Stock_Price:  101.34812410123949
curr_Factors:  [101.3481241]
mat_Sqrt:  [[0.15]]
grads:  [0.05240539]
Stock Position:  0.052405390342448836
Bond Position:  [-0.64223142]


portfolio before change:  [4.67611577]
curr_Stock_Price:  101.48550168105115
curr_Factors:  [101.48550168]
mat_Sqrt:  [[0.15]]
grads:  [-0.00224926]
Stock Position:  -0.0022492568058819196
Bond Position:  [4.90438273]


portfolio before change:  [4.67642208]
curr_Stock_Price:  101.48560481321458
curr_Factors:  [101.48560481]
mat_Sqrt:  [[0.15]]
grads:  [-0.03172626]
Stock Position:  -0.03172626117181789
Bond Position:  [7.89618088]


portfolio before change:  [4.71058407]
curr_Stock_Price:  100.42438714470202
curr_Factors:  [100.42438714]
mat_Sqrt:  [[0.15]]
grads:  [-0.03267577]
Stock Position:  -0.03267576769486058
Bond Position:  [7.99202802]


portfolio before change:  [4.68108489]
curr_Stock_Price:  101.34245901392141
curr_Factors:  [101.34245901]
mat_Sqrt:  [[0.15]]
grads:  [0.06873748]
Stock Position:  0.06873748325961526
Bond Position:  [-2.28494069]


portfolio before change:  [4.67365393]
curr_Stock_Price:  101.23643035089222
curr_Factors:  [101.23643035]
mat_Sqrt:  [[0.15]]
grads:  [-0.00263978]
Stock Position:  -0.00263978143742314
Bond Position:  [4.94089598]


portfolio before change:  [4.67300357]
curr_Stock_Price:  101.5997841187758
curr_Factors:  [101.59978412]
mat_Sqrt:  [[0.15]]
grads:  [-0.05935003]
Stock Position:  -0.05935003430482304
Bond Position:  [10.70295424]


portfolio before change:  [4.67872746]
curr_Stock_Price:  101.51461253774403
curr_Factors:  [101.51461254]
mat_Sqrt:  [[0.15]]
grads:  [-0.11391981]
Stock Position:  -0.11391980789474203
Bond Position:  [16.24325262]


portfolio before change:  [4.76428346]
curr_Stock_Price:  100.77250486849218
curr_Factors:  [100.77250487]
mat_Sqrt:  [[0.15]]
grads:  [-0.01890978]
Stock Position:  -0.01890977957236175
Bond Position:  [6.66986931]


portfolio before change:  [4.76139972]
curr_Stock_Price:  100.94705053940189
curr_Factors:  [100.94705054]
mat_Sqrt:  [[0.15]]
grads:  [0.05762511]
Stock Position:  0.05762510675394417
Bond Position:  [-1.05568484]


portfolio before change:  [4.74936845]
curr_Stock_Price:  100.73941043166553
curr_Factors:  [100.73941043]
mat_Sqrt:  [[0.15]]
grads:  [-0.0990854]
Stock Position:  -0.09908540227062348
Bond Position:  [14.73117346]


portfolio before change:  [4.83121507]
curr_Stock_Price:  99.9226817638949
curr_Factors:  [99.92268176]
mat_Sqrt:  [[0.15]]
grads:  [0.01954743]
Stock Position:  0.01954743315565572
Bond Position:  [2.87798313]


portfolio before change:  [4.82766236]
curr_Stock_Price:  99.7317313834306
curr_Factors:  [99.73173138]
mat_Sqrt:  [[0.15]]
grads:  [-0.01259159]
Stock Position:  -0.012591594303209634
Bond Position:  [6.08344386]


portfolio before change:  [4.82827144]
curr_Stock_Price:  99.71355587550778
curr_Factors:  [99.71355588]
mat_Sqrt:  [[0.15]]
grads:  [-0.09128966]
Stock Position:  -0.09128966102627442
Bond Position:  [13.93108816]


portfolio before change:  [4.72167289]
curr_Stock_Price:  100.89078966824927
curr_Factors:  [100.89078967]
mat_Sqrt:  [[0.15]]
grads:  [-0.03364003]
Stock Position:  -0.03364003398569063
Bond Position:  [8.11564248]


portfolio before change:  [4.72094848]
curr_Stock_Price:  100.92740247533865
curr_Factors:  [100.92740248]
mat_Sqrt:  [[0.15]]
grads:  [-0.00035583]
Stock Position:  -0.00035583494606046713
Bond Position:  [4.75686198]


portfolio before change:  [4.72126708]
curr_Stock_Price:  100.86757098621283
curr_Factors:  [100.86757099]
mat_Sqrt:  [[0.15]]
grads:  [0.02569627]
Stock Position:  0.025696269823070085
Bond Position:  [2.12934676]


portfolio before change:  [4.7143492]
curr_Stock_Price:  100.59317420954484
curr_Factors:  [100.59317421]
mat_Sqrt:  [[0.15]]
grads:  [-0.01986174]
Stock Position:  -0.019861742391554537
Bond Position:  [6.71230491]


portfolio before change:  [4.70275639]
curr_Stock_Price:  101.19797181016145
curr_Factors:  [101.19797181]
mat_Sqrt:  [[0.15]]
grads:  [0.02518356]
Stock Position:  0.025183557479916345
Bond Position:  [2.15423145]


portfolio before change:  [4.70538063]
curr_Stock_Price:  101.29682963713789
curr_Factors:  [101.29682964]
mat_Sqrt:  [[0.15]]
grads:  [2.58755103e-05]
Stock Position:  2.5875510322534666e-05
Bond Position:  [4.70275952]


portfolio before change:  [4.70567305]
curr_Stock_Price:  101.23846893107564
curr_Factors:  [101.23846893]
mat_Sqrt:  [[0.15]]
grads:  [0.00563476]
Stock Position:  0.0056347638081412086
Bond Position:  [4.13521819]


portfolio before change:  [4.70341483]
curr_Stock_Price:  100.79183384595926
curr_Factors:  [100.79183385]
mat_Sqrt:  [[0.15]]
grads:  [0.01639318]
Stock Position:  0.016393176839693817
Bond Position:  [3.05111647]


portfolio before change:  [4.71365123]
curr_Stock_Price:  101.4046317367262
curr_Factors:  [101.40463174]
mat_Sqrt:  [[0.15]]
grads:  [0.0568597]
Stock Position:  0.05685970295886532
Bond Position:  [-1.05218601]


portfolio before change:  [4.70890424]
curr_Stock_Price:  101.32230227585853
curr_Factors:  [101.32230228]
mat_Sqrt:  [[0.15]]
grads:  [-0.03926472]
Stock Position:  -0.03926471907957081
Bond Position:  [8.68729598]


portfolio before change:  [4.71394196]
curr_Stock_Price:  101.20782937268214
curr_Factors:  [101.20782937]
mat_Sqrt:  [[0.15]]
grads:  [-0.12273167]
Stock Position:  -0.12273167230936892
Bond Position:  [17.13534811]


portfolio before change:  [4.81086094]
curr_Stock_Price:  100.4268737990646
curr_Factors:  [100.4268738]
mat_Sqrt:  [[0.15]]
grads:  [0.09136503]
Stock Position:  0.0913650272979248
Bond Position:  [-4.36464313]


portfolio before change:  [4.81495489]
curr_Stock_Price:  100.47466842494293
curr_Factors:  [100.47466842]
mat_Sqrt:  [[0.15]]
grads:  [0.05525736]
Stock Position:  0.05525736008864967
Bond Position:  [-0.73701004]


portfolio before change:  [4.80986854]
curr_Stock_Price:  100.38345361694532
curr_Factors:  [100.38345362]
mat_Sqrt:  [[0.15]]
grads:  [0.05196255]
Stock Position:  0.05196255261486529
Bond Position:  [-0.40631195]


portfolio before change:  [4.77399691]
curr_Stock_Price:  99.6936061227982
curr_Factors:  [99.69360612]
mat_Sqrt:  [[0.15]]
grads:  [-0.08330004]
Stock Position:  -0.08330003788973095
Bond Position:  [13.07847808]


portfolio before change:  [4.88521621]
curr_Stock_Price:  98.36825416816455
curr_Factors:  [98.36825417]
mat_Sqrt:  [[0.15]]
grads:  [-0.08419584]
Stock Position:  -0.08419584067886476
Bond Position:  [13.16741406]


portfolio before change:  [4.89361563]
curr_Stock_Price:  98.27826827331407
curr_Factors:  [98.27826827]
mat_Sqrt:  [[0.15]]
grads:  [-0.00741663]
Stock Position:  -0.007416633455934907
Bond Position:  [5.62250953]


portfolio before change:  [4.89101595]
curr_Stock_Price:  98.67617140649642
curr_Factors:  [98.67617141]
mat_Sqrt:  [[0.15]]
grads:  [-0.07812276]
Stock Position:  -0.07812276163903481
Bond Position:  [12.59987097]


portfolio before change:  [4.87715043]
curr_Stock_Price:  98.8637356451304
curr_Factors:  [98.86373565]
mat_Sqrt:  [[0.15]]
grads:  [0.01780685]
Stock Position:  0.01780684722313846
Bond Position:  [3.11669899]


portfolio before change:  [4.89018613]
curr_Stock_Price:  99.58485705434201
curr_Factors:  [99.58485705]
mat_Sqrt:  [[0.15]]
grads:  [0.09965162]
Stock Position:  0.09965161573764696
Bond Position:  [-5.03360578]


portfolio before change:  [4.90009691]
curr_Stock_Price:  99.68746842026214
curr_Factors:  [99.68746842]
mat_Sqrt:  [[0.15]]
grads:  [0.01482203]
Stock Position:  0.014822027035873455
Bond Position:  [3.42252655]


portfolio before change:  [4.90662542]
curr_Stock_Price:  100.11349651720668
curr_Factors:  [100.11349652]
mat_Sqrt:  [[0.15]]
grads:  [0.04044713]
Stock Position:  0.04044713261967227
Bond Position:  [0.85732155]


portfolio before change:  [4.91456193]
curr_Stock_Price:  100.30839111249112
curr_Factors:  [100.30839111]
mat_Sqrt:  [[0.15]]
grads:  [-0.09567452]
Stock Position:  -0.09567452253953715
Bond Position:  [14.51151936]


portfolio before change:  [5.00660892]
curr_Stock_Price:  99.35578656554077
curr_Factors:  [99.35578657]
mat_Sqrt:  [[0.15]]
grads:  [-0.03736514]
Stock Position:  -0.03736513693253296
Bond Position:  [8.71905149]


portfolio before change:  [5.0555888]
curr_Stock_Price:  98.05952673873603
curr_Factors:  [98.05952674]
mat_Sqrt:  [[0.15]]
grads:  [0.01378194]
Stock Position:  0.013781935685308756
Bond Position:  [3.70413871]


portfolio before change:  [5.0516798]
curr_Stock_Price:  97.75909609440158
curr_Factors:  [97.75909609]
mat_Sqrt:  [[0.15]]
grads:  [0.00071458]
Stock Position:  0.0007145830446574698
Bond Position:  [4.98182281]


portfolio before change:  [5.05267659]
curr_Stock_Price:  98.71828427348491
curr_Factors:  [98.71828427]
mat_Sqrt:  [[0.15]]
grads:  [0.0581376]
Stock Position:  0.058137602473115405
Bond Position:  [-0.68656777]


portfolio before change:  [5.05495423]
curr_Stock_Price:  98.75819896803434
curr_Factors:  [98.75819897]
mat_Sqrt:  [[0.15]]
grads:  [0.05374005]
Stock Position:  0.053740051180288705
Bond Position:  [-0.25231644]


portfolio before change:  [5.0322048]
curr_Stock_Price:  98.33516885615185
curr_Factors:  [98.33516886]
mat_Sqrt:  [[0.15]]
grads:  [-0.01120405]
Stock Position:  -0.011204045746847408
Bond Position:  [6.13395653]


portfolio before change:  [5.02773105]
curr_Stock_Price:  98.76868504067225
curr_Factors:  [98.76868504]
mat_Sqrt:  [[0.15]]
grads:  [-0.04194897]
Stock Position:  -0.04194897395456718
Bond Position:  [9.17097604]


portfolio before change:  [5.02492538]
curr_Stock_Price:  98.84923205806619
curr_Factors:  [98.84923206]
mat_Sqrt:  [[0.15]]
grads:  [-0.06231169]
Stock Position:  -0.06231168532767024
Bond Position:  [11.18438763]


portfolio before change:  [4.99126954]
curr_Stock_Price:  99.40057154950632
curr_Factors:  [99.40057155]
mat_Sqrt:  [[0.15]]
grads:  [-0.0243705]
Stock Position:  -0.024370502863572514
Bond Position:  [7.41371145]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.99126954]
Stock Price:  99.64988000955574
PL:  [4.99126954]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.37568398e-02]
 [ 5.45332577e-03]
 [ 7.89465665e-04]
 [ 2.60886742e-03]
 [ 5.30175450e-03]
 [ 1.19907049e-02]
 [ 1.06112922e-03]
 [ 6.96744442e-03]
 [ 2.71520038e-03]
 [-2.03033797e-02]
 [ 1.01852487e-02]
 [-5.13157151e-03]
 [-6.43067981e-03]
 [ 4.26386606e-03]
 [ 5.28372715e-03]
 [-8.74011929e-03]
 [ 1.48952015e-02]
 [ 1.40249025e-02]
 [ 2.29316854e-02]
 [ 8.10299975e-03]
 [ 5.32499124e-02]
 [-1.73444679e-02]
 [-1.20733271e-03]
 [ 1.43132659e-02]
 [ 6.73139983e-03]
 [-7.14061076e-04]
 [ 1.27349113e-02]
 [-1.73665571e-02]
 [ 1.51370804e-03]
 [-6.91101514e-03]
 [-3.68241539e-03]
 [-1.81687881e-02]
 [ 1.71635269e-02]
 [ 1.71508373e-02]
 [-1.71033502e-02]
 [ 6.41326749e-03]
 [-2.25084293e-03]
 [ 1.06489309e-02]
 [ 1.20628831e-03]
 [-1.37272275e-02]
 [-2.52937197e-03]
 [-2.92443134e-03]
 [ 8.89647752e-03]
 [-1.10741677e-02]
 [ 2.96417659e-03]
 [-2.06955385e-04]
 [-1.37074386e-02]
 [-5.12056741e-03]
 [-2.61099753e-04]
 [ 7.77599898e-03]
 [-3.02583345e-03]
 [ 3.45985868e-03]
 [ 1.36467794e-03]
 [-2.35834362e-03]
 [ 1.58695421e-03]
 [ 9.00142990e-03]
 [ 1.48825030e-02]
 [-1.57765697e-02]
 [ 1.38906191e-02]
 [ 4.76104588e-03]
 [ 5.48135204e-03]
 [-1.25662052e-02]
 [-1.25414575e-02]
 [-2.18929047e-03]
 [-1.23974362e-02]
 [ 4.12661465e-02]
 [ 1.84611779e-02]
 [ 2.31034098e-03]
 [ 6.13775272e-03]
 [-1.44219078e-02]
 [-5.88594384e-03]
 [-4.58778493e-03]
 [ 1.82599456e-03]
 [ 8.16860868e-03]
 [ 6.29934756e-04]
 [-1.26370402e-02]
 [ 3.08035485e-03]
 [-8.39165950e-03]
 [ 5.27811941e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.61345749]
curr_Stock_Price:  99.9708860374247
curr_Factors:  [99.97088604]
mat_Sqrt:  [[0.15]]
grads:  [-0.2250456]
Stock Position:  -0.22504559836719337
Bond Position:  [24.11146536]


portfolio before change:  [1.81675586]
curr_Stock_Price:  99.07421727759456
curr_Factors:  [99.07421728]
mat_Sqrt:  [[0.15]]
grads:  [0.03635551]
Stock Position:  0.03635550512786922
Bond Position:  [-1.78513735]


portfolio before change:  [1.84587442]
curr_Stock_Price:  99.87822582073218
curr_Factors:  [99.87822582]
mat_Sqrt:  [[0.15]]
grads:  [0.0052631]
Stock Position:  0.0052631044324583445
Bond Position:  [1.32020489]


portfolio before change:  [1.85210455]
curr_Stock_Price:  101.04628395465902
curr_Factors:  [101.04628395]
mat_Sqrt:  [[0.15]]
grads:  [0.01739245]
Stock Position:  0.01739244948666697
Bond Position:  [0.09466216]


portfolio before change:  [1.84781318]
curr_Stock_Price:  100.79920610963619
curr_Factors:  [100.79920611]
mat_Sqrt:  [[0.15]]
grads:  [0.03534503]
Stock Position:  0.03534502998119411
Bond Position:  [-1.71493779]


portfolio before change:  [1.82484794]
curr_Stock_Price:  100.15249427248914
curr_Factors:  [100.15249427]
mat_Sqrt:  [[0.15]]
grads:  [0.07993803]
Stock Position:  0.07993803296058966
Bond Position:  [-6.18114545]


portfolio before change:  [1.85307465]
curr_Stock_Price:  100.51043451134686
curr_Factors:  [100.51043451]
mat_Sqrt:  [[0.15]]
grads:  [0.00707419]
Stock Position:  0.00707419477236197
Bond Position:  [1.14204425]


portfolio before change:  [1.85822112]
curr_Stock_Price:  101.22784433117994
curr_Factors:  [101.22784433]
mat_Sqrt:  [[0.15]]
grads:  [0.04644963]
Stock Position:  0.046449629479259
Bond Position:  [-2.84377474]


portfolio before change:  [1.82684266]
curr_Stock_Price:  100.55613353943794
curr_Factors:  [100.55613354]
mat_Sqrt:  [[0.15]]
grads:  [0.01810134]
Stock Position:  0.018101335849925092
Bond Position:  [0.00664232]


portfolio before change:  [1.82696146]
curr_Stock_Price:  100.56267370851512
curr_Factors:  [100.56267371]
mat_Sqrt:  [[0.15]]
grads:  [-0.13535586]
Stock Position:  -0.13535586480089515
Bond Position:  [15.43870913]


portfolio before change:  [1.85876343]
curr_Stock_Price:  100.3348518736431
curr_Factors:  [100.33485187]
mat_Sqrt:  [[0.15]]
grads:  [0.06790166]
Stock Position:  0.06790165820909931
Bond Position:  [-4.95413938]


portfolio before change:  [1.85023876]
curr_Stock_Price:  100.21386767475546
curr_Factors:  [100.21386767]
mat_Sqrt:  [[0.15]]
grads:  [-0.03421048]
Stock Position:  -0.034210476716075175
Bond Position:  [5.27860295]


portfolio before change:  [1.84887116]
curr_Stock_Price:  100.26348776887826
curr_Factors:  [100.26348777]
mat_Sqrt:  [[0.15]]
grads:  [-0.0428712]
Stock Position:  -0.042871198750882904
Bond Position:  [6.14728707]


portfolio before change:  [1.84271935]
curr_Stock_Price:  100.41594514704855
curr_Factors:  [100.41594515]
mat_Sqrt:  [[0.15]]
grads:  [0.02842577]
Stock Position:  0.02842577374290127
Bond Position:  [-1.01168159]


portfolio before change:  [1.8304259]
curr_Stock_Price:  99.9856941173471
curr_Factors:  [99.98569412]
mat_Sqrt:  [[0.15]]
grads:  [0.03522485]
Stock Position:  0.03522484763386055
Bond Position:  [-1.69155494]


portfolio before change:  [1.85939372]
curr_Stock_Price:  100.81106458998043
curr_Factors:  [100.81106459]
mat_Sqrt:  [[0.15]]
grads:  [-0.05826746]
Stock Position:  -0.05826746192375376
Bond Position:  [7.73339859]


portfolio before change:  [1.85604824]
curr_Stock_Price:  100.87677599201561
curr_Factors:  [100.87677599]
mat_Sqrt:  [[0.15]]
grads:  [0.09930134]
Stock Position:  0.0993013431001993
Bond Position:  [-8.16115111]


portfolio before change:  [1.83155705]
curr_Stock_Price:  100.63527775450976
curr_Factors:  [100.63527775]
mat_Sqrt:  [[0.15]]
grads:  [0.09349935]
Stock Position:  0.09349934997911392
Bond Position:  [-7.57777601]


portfolio before change:  [1.81930079]
curr_Stock_Price:  100.50925937131503
curr_Factors:  [100.50925937]
mat_Sqrt:  [[0.15]]
grads:  [0.1528779]
Stock Position:  0.1528779023908254
Bond Position:  [-13.54634396]


portfolio before change:  [1.7234941]
curr_Stock_Price:  99.88810998000258
curr_Factors:  [99.88810998]
mat_Sqrt:  [[0.15]]
grads:  [0.05402]
Stock Position:  0.054019998336326376
Bond Position:  [-3.67246144]


portfolio before change:  [1.68368408]
curr_Stock_Price:  99.15540945099939
curr_Factors:  [99.15540945]
mat_Sqrt:  [[0.15]]
grads:  [0.35499942]
Stock Position:  0.354999416183416
Bond Position:  [-33.51642839]


portfolio before change:  [1.64658781]
curr_Stock_Price:  99.05681372542196
curr_Factors:  [99.05681373]
mat_Sqrt:  [[0.15]]
grads:  [-0.11562979]
Stock Position:  -0.11562978625662494
Bond Position:  [13.10050601]


portfolio before change:  [1.66909607]
curr_Stock_Price:  98.86923706841534
curr_Factors:  [98.86923707]
mat_Sqrt:  [[0.15]]
grads:  [-0.00804888]
Stock Position:  -0.008048884707501057
Bond Position:  [2.46488316]


portfolio before change:  [1.66873595]
curr_Stock_Price:  98.93311934672394
curr_Factors:  [98.93311935]
mat_Sqrt:  [[0.15]]
grads:  [0.09542177]
Stock Position:  0.09542177237901221
Bond Position:  [-7.77163765]


portfolio before change:  [1.66113285]
curr_Stock_Price:  98.85853099945072
curr_Factors:  [98.858531]
mat_Sqrt:  [[0.15]]
grads:  [0.044876]
Stock Position:  0.044875998857718764
Bond Position:  [-2.77524247]


portfolio before change:  [1.68476382]
curr_Stock_Price:  99.3889800401313
curr_Factors:  [99.38898004]
mat_Sqrt:  [[0.15]]
grads:  [-0.00476041]
Stock Position:  -0.00476040717558549
Bond Position:  [2.15789584]


portfolio before change:  [1.68734068]
curr_Stock_Price:  98.87600264864083
curr_Factors:  [98.87600265]
mat_Sqrt:  [[0.15]]
grads:  [0.08489941]
Stock Position:  0.08489940841208014
Bond Position:  [-6.70717345]


portfolio before change:  [1.59027284]
curr_Stock_Price:  97.73761276895667
curr_Factors:  [97.73761277]
mat_Sqrt:  [[0.15]]
grads:  [-0.11577705]
Stock Position:  -0.11577704702714776
Bond Position:  [12.90604503]


portfolio before change:  [1.54955307]
curr_Stock_Price:  98.09628850930834
curr_Factors:  [98.09628851]
mat_Sqrt:  [[0.15]]
grads:  [0.01009139]
Stock Position:  0.01009138695584113
Bond Position:  [0.55962547]


portfolio before change:  [1.54991388]
curr_Stock_Price:  98.12857660222316
curr_Factors:  [98.1285766]
mat_Sqrt:  [[0.15]]
grads:  [-0.04607343]
Stock Position:  -0.04607343428085582
Bond Position:  [6.07103441]


portfolio before change:  [1.5360088]
curr_Stock_Price:  98.43861493918627
curr_Factors:  [98.43861494]
mat_Sqrt:  [[0.15]]
grads:  [-0.02454944]
Stock Position:  -0.02454943590233181
Bond Position:  [3.95262127]


portfolio before change:  [1.54822354]
curr_Stock_Price:  97.9511215518832
curr_Factors:  [97.95112155]
mat_Sqrt:  [[0.15]]
grads:  [-0.12112525]
Stock Position:  -0.12112525433209925
Bond Position:  [13.41257805]


portfolio before change:  [1.52597903]
curr_Stock_Price:  98.1416913660057
curr_Factors:  [98.14169137]
mat_Sqrt:  [[0.15]]
grads:  [0.11442351]
Stock Position:  0.11442351259456807
Bond Position:  [-9.70373802]


portfolio before change:  [1.55608839]
curr_Stock_Price:  98.41013144553467
curr_Factors:  [98.41013145]
mat_Sqrt:  [[0.15]]
grads:  [0.11433892]
Stock Position:  0.11433891516191223
Bond Position:  [-9.69601928]


portfolio before change:  [1.53955816]
curr_Stock_Price:  98.27085943262192
curr_Factors:  [98.27085943]
mat_Sqrt:  [[0.15]]
grads:  [-0.11402233]
Stock Position:  -0.11402233495650262
Bond Position:  [12.74463101]


portfolio before change:  [1.50417738]
curr_Stock_Price:  98.58814235307769
curr_Factors:  [98.58814235]
mat_Sqrt:  [[0.15]]
grads:  [0.04275512]
Stock Position:  0.04275511657099594
Bond Position:  [-2.71097014]


portfolio before change:  [1.52610913]
curr_Stock_Price:  99.10506740590988
curr_Factors:  [99.10506741]
mat_Sqrt:  [[0.15]]
grads:  [-0.01500562]
Stock Position:  -0.015005619538194799
Bond Position:  [3.01324207]


portfolio before change:  [1.53145228]
curr_Stock_Price:  98.76154155253545
curr_Factors:  [98.76154155]
mat_Sqrt:  [[0.15]]
grads:  [0.07099287]
Stock Position:  0.07099287297016775
Bond Position:  [-5.47991329]


portfolio before change:  [1.56014891]
curr_Stock_Price:  99.17058441044176
curr_Factors:  [99.17058441]
mat_Sqrt:  [[0.15]]
grads:  [0.00804192]
Stock Position:  0.008041922074680978
Bond Position:  [0.76262679]


portfolio before change:  [1.56094274]
curr_Stock_Price:  99.2633691376129
curr_Factors:  [99.26336914]
mat_Sqrt:  [[0.15]]
grads:  [-0.09151485]
Stock Position:  -0.09151484993853128
Bond Position:  [10.64501507]


portfolio before change:  [1.52851806]
curr_Stock_Price:  99.62494999323216
curr_Factors:  [99.62494999]
mat_Sqrt:  [[0.15]]
grads:  [-0.01686248]
Stock Position:  -0.016862479776997726
Bond Position:  [3.20844176]


portfolio before change:  [1.51752317]
curr_Stock_Price:  100.2888747816782
curr_Factors:  [100.28887478]
mat_Sqrt:  [[0.15]]
grads:  [-0.01949621]
Stock Position:  -0.01949620890285975
Bond Position:  [3.47277602]


portfolio before change:  [1.50289537]
curr_Stock_Price:  101.0502974533042
curr_Factors:  [101.05029745]
mat_Sqrt:  [[0.15]]
grads:  [0.05930985]
Stock Position:  0.059309850104906844
Bond Position:  [-4.49038262]


portfolio before change:  [1.43273838]
curr_Stock_Price:  99.87214016897009
curr_Factors:  [99.87214017]
mat_Sqrt:  [[0.15]]
grads:  [-0.07382778]
Stock Position:  -0.07382778490387487
Bond Position:  [8.80607726]


portfolio before change:  [1.43117898]
curr_Stock_Price:  99.90071752194244
curr_Factors:  [99.90071752]
mat_Sqrt:  [[0.15]]
grads:  [0.01976118]
Stock Position:  0.019761177288222614
Bond Position:  [-0.54297681]


portfolio before change:  [1.4395479]
curr_Stock_Price:  100.32593835389038
curr_Factors:  [100.32593835]
mat_Sqrt:  [[0.15]]
grads:  [-0.0013797]
Stock Position:  -0.001379702563937961
Bond Position:  [1.57796786]


portfolio before change:  [1.43898698]
curr_Stock_Price:  100.80397211936602
curr_Factors:  [100.80397212]
mat_Sqrt:  [[0.15]]
grads:  [-0.09138292]
Stock Position:  -0.09138292388335653
Bond Position:  [10.6507487]


portfolio before change:  [1.44543378]
curr_Stock_Price:  100.7407097535161
curr_Factors:  [100.74070975]
mat_Sqrt:  [[0.15]]
grads:  [-0.03413712]
Stock Position:  -0.03413711609958245
Bond Position:  [4.88443108]


portfolio before change:  [1.45238871]
curr_Stock_Price:  100.54591743673058
curr_Factors:  [100.54591744]
mat_Sqrt:  [[0.15]]
grads:  [-0.00174067]
Stock Position:  -0.001740665017909542
Bond Position:  [1.62740547]


portfolio before change:  [1.45294133]
curr_Stock_Price:  100.28687965425244
curr_Factors:  [100.28687965]
mat_Sqrt:  [[0.15]]
grads:  [0.05183999]
Stock Position:  0.05183999319397301
Bond Position:  [-3.74592983]


portfolio before change:  [1.41552427]
curr_Stock_Price:  99.56961637343079
curr_Factors:  [99.56961637]
mat_Sqrt:  [[0.15]]
grads:  [-0.02017222]
Stock Position:  -0.020172223007303078
Bond Position:  [3.42406478]


portfolio before change:  [1.42097707]
curr_Stock_Price:  99.30991354581599
curr_Factors:  [99.30991355]
mat_Sqrt:  [[0.15]]
grads:  [0.02306572]
Stock Position:  0.023065724553336924
Bond Position:  [-0.86967804]


portfolio before change:  [1.43499795]
curr_Stock_Price:  99.9201364958186
curr_Factors:  [99.9201365]
mat_Sqrt:  [[0.15]]
grads:  [0.00909785]
Stock Position:  0.009097852945038539
Bond Position:  [0.52593924]


portfolio before change:  [1.43400875]
curr_Stock_Price:  99.80779507464915
curr_Factors:  [99.80779507]
mat_Sqrt:  [[0.15]]
grads:  [-0.01572229]
Stock Position:  -0.01572229077551004
Bond Position:  [3.00321593]


portfolio before change:  [1.45286764]
curr_Stock_Price:  98.62023374696987
curr_Factors:  [98.62023375]
mat_Sqrt:  [[0.15]]
grads:  [0.01057969]
Stock Position:  0.010579694766027135
Bond Position:  [0.40949567]


portfolio before change:  [1.4499983]
curr_Stock_Price:  98.34660264672297
curr_Factors:  [98.34660265]
mat_Sqrt:  [[0.15]]
grads:  [0.06000953]
Stock Position:  0.06000953269075484
Bond Position:  [-4.45173536]


portfolio before change:  [1.4548789]
curr_Stock_Price:  98.43256956648054
curr_Factors:  [98.43256957]
mat_Sqrt:  [[0.15]]
grads:  [0.09921669]
Stock Position:  0.09921668650900678
Bond Position:  [-8.3112745]


portfolio before change:  [1.45843685]
curr_Stock_Price:  98.47366571528829
curr_Factors:  [98.47366572]
mat_Sqrt:  [[0.15]]
grads:  [-0.10517713]
Stock Position:  -0.10517713111164742
Bond Position:  [11.8156145]


portfolio before change:  [1.42511258]
curr_Stock_Price:  98.79752674042261
curr_Factors:  [98.79752674]
mat_Sqrt:  [[0.15]]
grads:  [0.09260413]
Stock Position:  0.09260412754117045
Bond Position:  [-7.72394619]


portfolio before change:  [1.44954375]
curr_Stock_Price:  99.06656374059843
curr_Factors:  [99.06656374]
mat_Sqrt:  [[0.15]]
grads:  [0.03174031]
Stock Position:  0.03174030588752634
Bond Position:  [-1.69485929]


portfolio before change:  [1.46133777]
curr_Stock_Price:  99.44147976567182
curr_Factors:  [99.44147977]
mat_Sqrt:  [[0.15]]
grads:  [0.03654235]
Stock Position:  0.036542346908750176
Bond Position:  [-2.17248728]


portfolio before change:  [1.46659911]
curr_Stock_Price:  99.58917501125235
curr_Factors:  [99.58917501]
mat_Sqrt:  [[0.15]]
grads:  [-0.0837747]
Stock Position:  -0.08377470158377447
Bond Position:  [9.80965253]


portfolio before change:  [1.43366243]
curr_Stock_Price:  99.98965164899963
curr_Factors:  [99.98965165]
mat_Sqrt:  [[0.15]]
grads:  [-0.08360972]
Stock Position:  -0.08360971689559936
Bond Position:  [9.79376889]


portfolio before change:  [1.41212193]
curr_Stock_Price:  100.25460440895132
curr_Factors:  [100.25460441]
mat_Sqrt:  [[0.15]]
grads:  [-0.01459527]
Stock Position:  -0.014595269792251776
Bond Position:  [2.87536493]


portfolio before change:  [1.42395881]
curr_Stock_Price:  99.45590952923375
curr_Factors:  [99.45590953]
mat_Sqrt:  [[0.15]]
grads:  [-0.08264957]
Stock Position:  -0.08264957486172106
Bond Position:  [9.64394745]


portfolio before change:  [1.37696609]
curr_Stock_Price:  100.03178051986994
curr_Factors:  [100.03178052]
mat_Sqrt:  [[0.15]]
grads:  [0.27510764]
Stock Position:  0.27510764344204913
Bond Position:  [-26.14254132]


portfolio before change:  [1.42702679]
curr_Stock_Price:  100.21968755074857
curr_Factors:  [100.21968755]
mat_Sqrt:  [[0.15]]
grads:  [0.12307452]
Stock Position:  0.12307451944030606
Bond Position:  [-10.9074631]


portfolio before change:  [1.42719628]
curr_Stock_Price:  100.22660395149899
curr_Factors:  [100.22660395]
mat_Sqrt:  [[0.15]]
grads:  [0.01540227]
Stock Position:  0.015402273195686383
Bond Position:  [-0.11652125]


portfolio before change:  [1.4320725]
curr_Stock_Price:  100.5436675435443
curr_Factors:  [100.54366754]
mat_Sqrt:  [[0.15]]
grads:  [0.04091835]
Stock Position:  0.04091835146752497
Bond Position:  [-2.68200863]


portfolio before change:  [1.40804823]
curr_Stock_Price:  99.96063721395512
curr_Factors:  [99.96063721]
mat_Sqrt:  [[0.15]]
grads:  [-0.09614605]
Stock Position:  -0.09614605208769084
Bond Position:  [11.01886886]


portfolio before change:  [1.42807688]
curr_Stock_Price:  99.759485456984
curr_Factors:  [99.75948546]
mat_Sqrt:  [[0.15]]
grads:  [-0.03923963]
Stock Position:  -0.03923962563028026
Bond Position:  [5.34260174]


portfolio before change:  [1.36862124]
curr_Stock_Price:  101.2831891804172
curr_Factors:  [101.28318918]
mat_Sqrt:  [[0.15]]
grads:  [-0.03058523]
Stock Position:  -0.030585232869140624
Bond Position:  [4.46639116]


portfolio before change:  [1.35273619]
curr_Stock_Price:  101.81168603193032
curr_Factors:  [101.81168603]
mat_Sqrt:  [[0.15]]
grads:  [0.0121733]
Stock Position:  0.01217329707519684
Bond Position:  [0.1133523]


portfolio before change:  [1.35438161]
curr_Stock_Price:  101.94627016395614
curr_Factors:  [101.94627016]
mat_Sqrt:  [[0.15]]
grads:  [0.05445739]
Stock Position:  0.054457391226313434
Bond Position:  [-4.19734631]


portfolio before change:  [1.38069822]
curr_Stock_Price:  102.43433897790958
curr_Factors:  [102.43433898]
mat_Sqrt:  [[0.15]]
grads:  [0.00419957]
Stock Position:  0.004199565039460285
Bond Position:  [0.95051856]


portfolio before change:  [1.3800421]
curr_Stock_Price:  102.26395640371481
curr_Factors:  [102.2639564]
mat_Sqrt:  [[0.15]]
grads:  [-0.08424693]
Stock Position:  -0.08424693491819939
Bond Position:  [9.99546698]


portfolio before change:  [1.43952429]
curr_Stock_Price:  101.56532622542933
curr_Factors:  [101.56532623]
mat_Sqrt:  [[0.15]]
grads:  [0.0205357]
Stock Position:  0.020535699001589237
Bond Position:  [-0.64619068]


portfolio before change:  [1.42132088]
curr_Stock_Price:  100.68086556471185
curr_Factors:  [100.68086556]
mat_Sqrt:  [[0.15]]
grads:  [-0.0559444]
Stock Position:  -0.055944396692874064
Bond Position:  [7.05385116]


portfolio before change:  [1.43057647]
curr_Stock_Price:  100.52330359671095
curr_Factors:  [100.5233036]
mat_Sqrt:  [[0.15]]
grads:  [0.03518746]
Stock Position:  0.035187462736527564
Bond Position:  [-2.10658353]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.43057647]
Stock Price:  100.46282209605508
PL:  [0.96775437]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.65132353e-02]
 [-1.29014898e-03]
 [-5.04398622e-04]
 [-1.46040196e-03]
 [-2.70145798e-02]
 [ 8.60637865e-04]
 [ 1.59269983e-03]
 [-1.06591247e-02]
 [-3.64424840e-03]
 [ 5.46960424e-02]
 [ 9.97614242e-03]
 [-1.14732737e-02]
 [ 1.17481521e-02]
 [ 5.95127613e-03]
 [-3.58423996e-02]
 [ 1.93995221e-02]
 [-4.87282911e-03]
 [-1.64276398e-02]
 [-4.38605655e-02]
 [ 1.81990650e-02]
 [-7.22360985e-02]
 [-2.74573536e-02]
 [ 8.70546024e-04]
 [ 3.76700665e-03]
 [-5.82521639e-03]
 [ 1.66455219e-02]
 [ 1.90898372e-02]
 [ 6.23037759e-02]
 [-6.88223232e-04]
 [ 2.24286714e-02]
 [-3.53519692e-03]
 [-6.79525117e-02]
 [ 2.51766454e-02]
 [ 1.08721390e-02]
 [-3.80336919e-02]
 [ 8.42775945e-03]
 [-7.03666830e-04]
 [-5.91060433e-03]
 [ 7.62617316e-03]
 [-1.91631887e-02]
 [ 5.04687391e-02]
 [ 2.59148236e-03]
 [ 1.21433432e-02]
 [-9.93963917e-03]
 [-3.91204810e-03]
 [-1.70276665e-02]
 [-1.31880357e-02]
 [ 8.51603475e-04]
 [-2.68128575e-03]
 [-5.94968173e-03]
 [-3.89246670e-03]
 [ 2.88346299e-03]
 [ 3.54230618e-03]
 [ 1.26368740e-03]
 [ 4.63944939e-03]
 [ 8.86097839e-03]
 [ 1.27276608e-02]
 [-6.20975717e-03]
 [ 1.37179963e-02]
 [ 1.36522512e-03]
 [ 5.21180595e-03]
 [-1.33181568e-02]
 [-1.25507036e-02]
 [-2.09287790e-03]
 [-1.23993295e-02]
 [ 5.82107587e-03]
 [ 1.44617540e-02]
 [ 2.12879990e-03]
 [ 8.21307939e-03]
 [-1.67704098e-02]
 [-2.88601510e-03]
 [ 1.76664906e-03]
 [ 1.80994019e-04]
 [ 8.15557555e-03]
 [-2.08308571e-04]
 [ 2.80479158e-03]
 [ 7.91494494e-03]
 [-1.24702746e-02]
 [-4.77438197e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.70493845]
curr_Stock_Price:  99.6290692227707
curr_Factors:  [99.62906922]
mat_Sqrt:  [[0.15]]
grads:  [-0.24342157]
Stock Position:  -0.2434215688923645
Bond Position:  [20.54692589]


portfolio before change:  [-3.76168713]
curr_Stock_Price:  99.86747418916504
curr_Factors:  [99.86747419]
mat_Sqrt:  [[0.15]]
grads:  [-0.00860099]
Stock Position:  -0.008600993175572346
Bond Position:  [-2.90272767]


portfolio before change:  [-3.75690755]
curr_Stock_Price:  99.2906798008236
curr_Factors:  [99.2906798]
mat_Sqrt:  [[0.15]]
grads:  [-0.00336266]
Stock Position:  -0.0033626574772910025
Bond Position:  [-3.42302701]


portfolio before change:  [-3.75464366]
curr_Stock_Price:  98.55380887926933
curr_Factors:  [98.55380888]
mat_Sqrt:  [[0.15]]
grads:  [-0.00973601]
Stock Position:  -0.009736013057551384
Bond Position:  [-2.79512249]


portfolio before change:  [-3.74758587]
curr_Stock_Price:  97.81094940607944
curr_Factors:  [97.81094941]
mat_Sqrt:  [[0.15]]
grads:  [-0.1800972]
Stock Position:  -0.1800971986716717
Bond Position:  [13.86789212]


portfolio before change:  [-3.72916076]
curr_Stock_Price:  97.71345572402345
curr_Factors:  [97.71345572]
mat_Sqrt:  [[0.15]]
grads:  [0.00573759]
Stock Position:  0.0057375857636712164
Bond Position:  [-4.28980009]


portfolio before change:  [-3.72841393]
curr_Stock_Price:  97.89035020658305
curr_Factors:  [97.89035021]
mat_Sqrt:  [[0.15]]
grads:  [0.010618]
Stock Position:  0.010617998888102291
Bond Position:  [-4.76781356]


portfolio before change:  [-3.73383653]
curr_Stock_Price:  97.40771692203045
curr_Factors:  [97.40771692]
mat_Sqrt:  [[0.15]]
grads:  [-0.07106083]
Stock Position:  -0.07106083141790787
Bond Position:  [3.18803682]


portfolio before change:  [-3.69916768]
curr_Stock_Price:  96.92264539812695
curr_Factors:  [96.9226454]
mat_Sqrt:  [[0.15]]
grads:  [-0.02429499]
Stock Position:  -0.024294989341345403
Bond Position:  [-1.34443305]


portfolio before change:  [-3.69517941]
curr_Stock_Price:  96.75502621383016
curr_Factors:  [96.75502621]
mat_Sqrt:  [[0.15]]
grads:  [0.36464028]
Stock Position:  0.36464028255858394
Bond Position:  [-38.97595951]


portfolio before change:  [-3.61817019]
curr_Stock_Price:  96.97289926748545
curr_Factors:  [96.97289927]
mat_Sqrt:  [[0.15]]
grads:  [0.06650762]
Stock Position:  0.06650761614411554
Bond Position:  [-10.06760655]


portfolio before change:  [-3.60517321]
curr_Stock_Price:  97.17778145363471
curr_Factors:  [97.17778145]
mat_Sqrt:  [[0.15]]
grads:  [-0.07648849]
Stock Position:  -0.07648849105732555
Bond Position:  [3.82780866]


portfolio before change:  [-3.59336696]
curr_Stock_Price:  97.02655609194899
curr_Factors:  [97.02655609]
mat_Sqrt:  [[0.15]]
grads:  [0.07832101]
Stock Position:  0.07832101416096462
Bond Position:  [-11.19258524]


portfolio before change:  [-3.54990646]
curr_Stock_Price:  97.59039018547706
curr_Factors:  [97.59039019]
mat_Sqrt:  [[0.15]]
grads:  [0.03967517]
Stock Position:  0.03967517417471158
Bond Position:  [-7.42182219]


portfolio before change:  [-3.58615349]
curr_Stock_Price:  96.68848749681432
curr_Factors:  [96.6884875]
mat_Sqrt:  [[0.15]]
grads:  [-0.23894933]
Stock Position:  -0.23894933035989702
Bond Position:  [19.51749585]


portfolio before change:  [-3.61147588]
curr_Stock_Price:  96.7995665822376
curr_Factors:  [96.79956658]
mat_Sqrt:  [[0.15]]
grads:  [0.12933015]
Stock Position:  0.1293301472400166
Bond Position:  [-16.13057808]


portfolio before change:  [-3.62634614]
curr_Stock_Price:  96.69238300707093
curr_Factors:  [96.69238301]
mat_Sqrt:  [[0.15]]
grads:  [-0.03248553]
Stock Position:  -0.03248552739443247
Bond Position:  [-0.48524308]


portfolio before change:  [-3.59860372]
curr_Stock_Price:  95.83745603094935
curr_Factors:  [95.83745603]
mat_Sqrt:  [[0.15]]
grads:  [-0.1095176]
Stock Position:  -0.10951759889701702
Bond Position:  [6.89728435]


portfolio before change:  [-3.61876997]
curr_Stock_Price:  96.02552948491717
curr_Factors:  [96.02552948]
mat_Sqrt:  [[0.15]]
grads:  [-0.29240377]
Stock Position:  -0.29240376972938753
Bond Position:  [24.45945684]


portfolio before change:  [-3.49697854]
curr_Stock_Price:  95.61423975335148
curr_Factors:  [95.61423975]
mat_Sqrt:  [[0.15]]
grads:  [0.1213271]
Stock Position:  0.12132709997913632
Bond Position:  [-15.09757697]


portfolio before change:  [-3.45848752]
curr_Stock_Price:  95.93926729436753
curr_Factors:  [95.93926729]
mat_Sqrt:  [[0.15]]
grads:  [-0.48157399]
Stock Position:  -0.4815739899813549
Bond Position:  [42.74336822]


portfolio before change:  [-3.92178081]
curr_Stock_Price:  96.9068544943688
curr_Factors:  [96.90685449]
mat_Sqrt:  [[0.15]]
grads:  [-0.18304902]
Stock Position:  -0.18304902402694262
Bond Position:  [13.81692433]


portfolio before change:  [-3.91674784]
curr_Stock_Price:  96.88407706823834
curr_Factors:  [96.88407707]
mat_Sqrt:  [[0.15]]
grads:  [0.00580364]
Stock Position:  0.0058036401612939405
Bond Position:  [-4.47902816]


portfolio before change:  [-3.91570363]
curr_Stock_Price:  97.11223663048602
curr_Factors:  [97.11223663]
mat_Sqrt:  [[0.15]]
grads:  [0.02511338]
Stock Position:  0.025113377690041367
Bond Position:  [-6.3545199]


portfolio before change:  [-3.93421404]
curr_Stock_Price:  96.3909779305128
curr_Factors:  [96.39097793]
mat_Sqrt:  [[0.15]]
grads:  [-0.03883478]
Stock Position:  -0.038834775913010836
Bond Position:  [-0.19089201]


portfolio before change:  [-3.91152283]
curr_Stock_Price:  95.80636946133797
curr_Factors:  [95.80636946]
mat_Sqrt:  [[0.15]]
grads:  [0.11097015]
Stock Position:  0.11097014576622484
Bond Position:  [-14.54316962]


portfolio before change:  [-3.91409344]
curr_Stock_Price:  95.79139582126777
curr_Factors:  [95.79139582]
mat_Sqrt:  [[0.15]]
grads:  [0.12726558]
Stock Position:  0.12726558107634922
Bond Position:  [-16.10504109]


portfolio before change:  [-3.95811474]
curr_Stock_Price:  95.4534041645845
curr_Factors:  [95.45340416]
mat_Sqrt:  [[0.15]]
grads:  [0.41535851]
Stock Position:  0.41535850606444086
Bond Position:  [-43.60549809]


portfolio before change:  [-4.1802983]
curr_Stock_Price:  94.92504582595141
curr_Factors:  [94.92504583]
mat_Sqrt:  [[0.15]]
grads:  [-0.00458815]
Stock Position:  -0.004588154877805106
Bond Position:  [-3.74476748]


portfolio before change:  [-4.17563971]
curr_Stock_Price:  93.8586824998555
curr_Factors:  [93.8586825]
mat_Sqrt:  [[0.15]]
grads:  [0.14952448]
Stock Position:  0.14952447628805932
Bond Position:  [-18.20981006]


portfolio before change:  [-4.13262996]
curr_Stock_Price:  94.15393780736304
curr_Factors:  [94.15393781]
mat_Sqrt:  [[0.15]]
grads:  [-0.02356798]
Stock Position:  -0.023567979445011357
Bond Position:  [-1.91361189]


portfolio before change:  [-4.13137665]
curr_Stock_Price:  94.09568413725276
curr_Factors:  [94.09568414]
mat_Sqrt:  [[0.15]]
grads:  [-0.45301674]
Stock Position:  -0.4530167443510507
Bond Position:  [38.49554384]


portfolio before change:  [-4.33108023]
curr_Stock_Price:  94.54182577481065
curr_Factors:  [94.54182577]
mat_Sqrt:  [[0.15]]
grads:  [0.1678443]
Stock Position:  0.16784430252063065
Bond Position:  [-20.19938704]


portfolio before change:  [-4.37244502]
curr_Stock_Price:  94.30290029402386
curr_Factors:  [94.30290029]
mat_Sqrt:  [[0.15]]
grads:  [0.07248093]
Stock Position:  0.07248092687457629
Bond Position:  [-11.20760664]


portfolio before change:  [-4.32820359]
curr_Stock_Price:  94.92295195924083
curr_Factors:  [94.92295196]
mat_Sqrt:  [[0.15]]
grads:  [-0.25355795]
Stock Position:  -0.25355794601430354
Bond Position:  [19.74026514]


portfolio before change:  [-4.51482233]
curr_Stock_Price:  95.6638182876338
curr_Factors:  [95.66381829]
mat_Sqrt:  [[0.15]]
grads:  [0.05618506]
Stock Position:  0.056185062981421105
Bond Position:  [-9.88969999]


portfolio before change:  [-4.50620661]
curr_Stock_Price:  95.8281653741273
curr_Factors:  [95.82816537]
mat_Sqrt:  [[0.15]]
grads:  [-0.00469111]
Stock Position:  -0.004691112197527589
Bond Position:  [-4.05666593]


portfolio before change:  [-4.50764793]
curr_Stock_Price:  96.08136232293538
curr_Factors:  [96.08136232]
mat_Sqrt:  [[0.15]]
grads:  [-0.03940403]
Stock Position:  -0.03940402888454337
Bond Position:  [-0.72165516]


portfolio before change:  [-4.49367248]
curr_Stock_Price:  95.72554693279632
curr_Factors:  [95.72554693]
mat_Sqrt:  [[0.15]]
grads:  [0.05084115]
Stock Position:  0.050841154393836276
Bond Position:  [-9.36046979]


portfolio before change:  [-4.50370665]
curr_Stock_Price:  95.53969100928748
curr_Factors:  [95.53969101]
mat_Sqrt:  [[0.15]]
grads:  [-0.12775459]
Stock Position:  -0.12775459140144868
Bond Position:  [7.70192753]


portfolio before change:  [-4.49232229]
curr_Stock_Price:  95.45434786125956
curr_Factors:  [95.45434786]
mat_Sqrt:  [[0.15]]
grads:  [0.33645826]
Stock Position:  0.33645826080725666
Bond Position:  [-36.60872616]


portfolio before change:  [-4.57024995]
curr_Stock_Price:  95.22953677871946
curr_Factors:  [95.22953678]
mat_Sqrt:  [[0.15]]
grads:  [0.01727655]
Stock Position:  0.017276549037502885
Bond Position:  [-6.21548771]


portfolio before change:  [-4.59236702]
curr_Stock_Price:  93.97184440663118
curr_Factors:  [93.97184441]
mat_Sqrt:  [[0.15]]
grads:  [0.08095562]
Stock Position:  0.08095562128649962
Bond Position:  [-12.19991606]


portfolio before change:  [-4.54090698]
curr_Stock_Price:  94.61692072043627
curr_Factors:  [94.61692072]
mat_Sqrt:  [[0.15]]
grads:  [-0.06626426]
Stock Position:  -0.06626426114255485
Bond Position:  [1.72881336]


portfolio before change:  [-4.5411906]
curr_Stock_Price:  94.62283149848128
curr_Factors:  [94.6228315]
mat_Sqrt:  [[0.15]]
grads:  [-0.02608032]
Stock Position:  -0.026080320682650728
Bond Position:  [-2.07339681]


portfolio before change:  [-4.54512811]
curr_Stock_Price:  94.76883874745482
curr_Factors:  [94.76883875]
mat_Sqrt:  [[0.15]]
grads:  [-0.11351778]
Stock Position:  -0.11351777664883055
Bond Position:  [6.21281976]


portfolio before change:  [-4.60307962]
curr_Stock_Price:  95.28276550401652
curr_Factors:  [95.2827655]
mat_Sqrt:  [[0.15]]
grads:  [-0.08792024]
Stock Position:  -0.08792023827746279
Bond Position:  [3.77420383]


portfolio before change:  [-4.6399053]
curr_Stock_Price:  95.70430193227206
curr_Factors:  [95.70430193]
mat_Sqrt:  [[0.15]]
grads:  [0.00567736]
Stock Position:  0.005677356500787551
Bond Position:  [-5.18325275]


portfolio before change:  [-4.63720744]
curr_Stock_Price:  96.23656103369954
curr_Factors:  [96.23656103]
mat_Sqrt:  [[0.15]]
grads:  [-0.01787524]
Stock Position:  -0.017875238361732444
Bond Position:  [-2.91695598]


portfolio before change:  [-4.62753949]
curr_Stock_Price:  95.68550415571484
curr_Factors:  [95.68550416]
mat_Sqrt:  [[0.15]]
grads:  [-0.03966454]
Stock Position:  -0.039664544844636225
Bond Position:  [-0.83221752]


portfolio before change:  [-4.651453]
curr_Stock_Price:  96.28708685269821
curr_Factors:  [96.28708685]
mat_Sqrt:  [[0.15]]
grads:  [-0.02594978]
Stock Position:  -0.025949777976531713
Bond Position:  [-2.15282448]


portfolio before change:  [-4.64584751]
curr_Stock_Price:  96.06588853405492
curr_Factors:  [96.06588853]
mat_Sqrt:  [[0.15]]
grads:  [0.01922309]
Stock Position:  0.019223086620593403
Bond Position:  [-6.49253041]


portfolio before change:  [-4.63971354]
curr_Stock_Price:  96.40609225040389
curr_Factors:  [96.40609225]
mat_Sqrt:  [[0.15]]
grads:  [0.02361537]
Stock Position:  0.023615374514451348
Bond Position:  [-6.91637952]


portfolio before change:  [-4.62408674]
curr_Stock_Price:  97.08611898412408
curr_Factors:  [97.08611898]
mat_Sqrt:  [[0.15]]
grads:  [0.00842458]
Stock Position:  0.008424582672485513
Bond Position:  [-5.44199678]


portfolio before change:  [-4.62397706]
curr_Stock_Price:  97.13951242231684
curr_Factors:  [97.13951242]
mat_Sqrt:  [[0.15]]
grads:  [0.03092966]
Stock Position:  0.030929662585330905
Bond Position:  [-7.62846941]


portfolio before change:  [-4.637997]
curr_Stock_Price:  96.70164321638471
curr_Factors:  [96.70164322]
mat_Sqrt:  [[0.15]]
grads:  [0.05907319]
Stock Position:  0.059073189253823835
Bond Position:  [-10.35047147]


portfolio before change:  [-4.58402897]
curr_Stock_Price:  97.62617367680618
curr_Factors:  [97.62617368]
mat_Sqrt:  [[0.15]]
grads:  [0.08485107]
Stock Position:  0.08485107221741092
Bond Position:  [-12.86771448]


portfolio before change:  [-4.56434084]
curr_Stock_Price:  97.86768366982966
curr_Factors:  [97.86768367]
mat_Sqrt:  [[0.15]]
grads:  [-0.04139838]
Stock Position:  -0.041398381100812356
Bond Position:  [-0.51277718]


portfolio before change:  [-4.56392762]
curr_Stock_Price:  97.85692795003386
curr_Factors:  [97.85692795]
mat_Sqrt:  [[0.15]]
grads:  [0.09145331]
Stock Position:  0.09145330879249476
Bond Position:  [-13.51326747]


portfolio before change:  [-4.55323338]
curr_Stock_Price:  97.98309992388513
curr_Factors:  [97.98309992]
mat_Sqrt:  [[0.15]]
grads:  [0.0091015]
Stock Position:  0.009101500768109684
Bond Position:  [-5.44502664]


portfolio before change:  [-4.54411098]
curr_Stock_Price:  99.022788090254
curr_Factors:  [99.02278809]
mat_Sqrt:  [[0.15]]
grads:  [0.03474537]
Stock Position:  0.0347453730234087
Bond Position:  [-7.98469469]


portfolio before change:  [-4.54287544]
curr_Stock_Price:  99.07271142184575
curr_Factors:  [99.07271142]
mat_Sqrt:  [[0.15]]
grads:  [-0.08878771]
Stock Position:  -0.08878771194746884
Bond Position:  [4.25356392]


portfolio before change:  [-4.67014565]
curr_Stock_Price:  100.50912718143682
curr_Factors:  [100.50912718]
mat_Sqrt:  [[0.15]]
grads:  [-0.08367136]
Stock Position:  -0.08367135711392067
Bond Position:  [3.73958942]


portfolio before change:  [-4.59820439]
curr_Stock_Price:  99.65211308178509
curr_Factors:  [99.65211308]
mat_Sqrt:  [[0.15]]
grads:  [-0.01395252]
Stock Position:  -0.013952519319727446
Bond Position:  [-3.20780635]


portfolio before change:  [-4.59461111]
curr_Stock_Price:  99.38020727273775
curr_Factors:  [99.38020727]
mat_Sqrt:  [[0.15]]
grads:  [-0.0826622]
Stock Position:  -0.0826621968397953
Bond Position:  [3.62037515]


portfolio before change:  [-4.5646025]
curr_Stock_Price:  99.01991765033154
curr_Factors:  [99.01991765]
mat_Sqrt:  [[0.15]]
grads:  [0.03880717]
Stock Position:  0.038807172481528894
Bond Position:  [-8.40728552]


portfolio before change:  [-4.5460185]
curr_Stock_Price:  99.51233862311489
curr_Factors:  [99.51233862]
mat_Sqrt:  [[0.15]]
grads:  [0.09641169]
Stock Position:  0.096411693076105
Bond Position:  [-14.14017155]


portfolio before change:  [-4.54457998]
curr_Stock_Price:  99.53642606119449
curr_Factors:  [99.53642606]
mat_Sqrt:  [[0.15]]
grads:  [0.014192]
Stock Position:  0.014191999352030029
Bond Position:  [-5.95720088]


portfolio before change:  [-4.55648769]
curr_Stock_Price:  98.72361784563412
curr_Factors:  [98.72361785]
mat_Sqrt:  [[0.15]]
grads:  [0.05475386]
Stock Position:  0.05475386257071366
Bond Position:  [-9.9619871]


portfolio before change:  [-4.56783185]
curr_Stock_Price:  98.52780489226703
curr_Factors:  [98.52780489]
mat_Sqrt:  [[0.15]]
grads:  [-0.11180273]
Stock Position:  -0.11180273209757596
Bond Position:  [6.44784592]


portfolio before change:  [-4.57133291]
curr_Stock_Price:  98.5627240918494
curr_Factors:  [98.56272409]
mat_Sqrt:  [[0.15]]
grads:  [-0.0192401]
Stock Position:  -0.019240100642293617
Bond Position:  [-2.67497618]


portfolio before change:  [-4.56451586]
curr_Stock_Price:  98.19971964121152
curr_Factors:  [98.19971964]
mat_Sqrt:  [[0.15]]
grads:  [0.01177766]
Stock Position:  0.011777660399558115
Bond Position:  [-5.72107881]


portfolio before change:  [-4.56953695]
curr_Stock_Price:  97.8037567195766
curr_Factors:  [97.80375672]
mat_Sqrt:  [[0.15]]
grads:  [0.00120663]
Stock Position:  0.0012066267903439467
Bond Position:  [-4.68754959]


portfolio before change:  [-4.57044843]
curr_Stock_Price:  97.29117763743821
curr_Factors:  [97.29117764]
mat_Sqrt:  [[0.15]]
grads:  [0.0543705]
Stock Position:  0.05437050364094862
Bond Position:  [-9.86021876]


portfolio before change:  [-4.57143734]
curr_Stock_Price:  97.28432416945519
curr_Factors:  [97.28432417]
mat_Sqrt:  [[0.15]]
grads:  [-0.00138872]
Stock Position:  -0.0013887238094821275
Bond Position:  [-4.43633628]


portfolio before change:  [-4.57061873]
curr_Stock_Price:  96.495189738033
curr_Factors:  [96.49518974]
mat_Sqrt:  [[0.15]]
grads:  [0.01869861]
Stock Position:  0.01869861053036391
Bond Position:  [-6.3749447]


portfolio before change:  [-4.57798576]
curr_Stock_Price:  96.12251044036269
curr_Factors:  [96.12251044]
mat_Sqrt:  [[0.15]]
grads:  [0.0527663]
Stock Position:  0.052766299633200967
Bond Position:  [-9.65001495]


portfolio before change:  [-4.60168348]
curr_Stock_Price:  95.68483372419517
curr_Factors:  [95.68483372]
mat_Sqrt:  [[0.15]]
grads:  [-0.08313516]
Stock Position:  -0.08313516427856694
Bond Position:  [3.35309089]


portfolio before change:  [-4.55399177]
curr_Stock_Price:  95.11368981129023
curr_Factors:  [95.11368981]
mat_Sqrt:  [[0.15]]
grads:  [-0.31829213]
Stock Position:  -0.3182921310357033
Bond Position:  [25.71994725]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.55399177]
Stock Price:  95.38655421328349
PL:  [-4.55399177]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-3.44627721e-02]
 [ 7.30211942e-04]
 [ 8.62413357e-05]
 [ 2.34256405e-03]
 [ 5.82554796e-03]
 [ 1.16931526e-02]
 [ 8.16448926e-04]
 [ 1.48575242e-02]
 [ 1.78592467e-02]
 [-1.28108914e-02]
 [ 8.91513977e-03]
 [-8.73918383e-03]
 [ 1.48867346e-03]
 [ 3.88009603e-03]
 [-1.26463996e-02]
 [ 1.50047604e-02]
 [-2.75011390e-03]
 [ 3.48107721e-03]
 [ 2.10090869e-02]
 [ 1.04461577e-02]
 [ 5.70971641e-02]
 [-1.35919403e-02]
 [-2.71458766e-03]
 [ 1.35126362e-02]
 [ 1.34478190e-02]
 [-7.46255862e-03]
 [ 1.38705183e-02]
 [-3.65936625e-03]
 [ 2.94738765e-03]
 [-2.02585493e-02]
 [-4.61478577e-03]
 [ 5.91823981e-03]
 [ 9.50873415e-03]
 [ 7.33025570e-03]
 [ 1.34043423e-03]
 [-3.93085528e-03]
 [-4.59467629e-03]
 [ 1.40696484e-02]
 [-2.11164141e-03]
 [-1.03874390e-02]
 [-1.46285881e-02]
 [-2.88844399e-03]
 [ 8.82309800e-03]
 [-1.36090857e-02]
 [-3.93882750e-04]
 [ 2.32824374e-03]
 [-1.36385538e-02]
 [ 2.15190256e-03]
 [ 6.57592853e-03]
 [-1.10568107e-02]
 [-4.05903118e-03]
 [ 3.47562746e-03]
 [ 3.08259733e-03]
 [-2.95203814e-03]
 [-8.71695252e-03]
 [ 1.18936657e-02]
 [-2.21297325e-02]
 [-7.68495506e-03]
 [ 1.65032123e-02]
 [-6.01022538e-04]
 [ 1.22373185e-02]
 [-1.53400161e-02]
 [-1.27478457e-02]
 [-3.24755893e-03]
 [ 1.22209932e-02]
 [-1.72850451e-02]
 [ 1.78151647e-02]
 [ 4.50784054e-03]
 [ 1.23881401e-02]
 [-2.64212423e-02]
 [-7.92477869e-03]
 [-5.98296425e-03]
 [ 8.08315116e-03]
 [ 6.13965284e-03]
 [-1.01381276e-03]
 [-8.02111438e-04]
 [ 7.35049153e-03]
 [-3.15778035e-03]
 [ 2.19199322e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.06071233]
curr_Stock_Price:  99.79901537913948
curr_Factors:  [99.79901538]
mat_Sqrt:  [[0.15]]
grads:  [-0.22975181]
Stock Position:  -0.22975181393394958
Bond Position:  [21.86829248]


portfolio before change:  [-1.32419108]
curr_Stock_Price:  100.95176169070626
curr_Factors:  [100.95176169]
mat_Sqrt:  [[0.15]]
grads:  [0.00486808]
Stock Position:  0.004868079614329364
Bond Position:  [-1.81563229]


portfolio before change:  [-1.32743532]
curr_Stock_Price:  100.30864102966585
curr_Factors:  [100.30864103]
mat_Sqrt:  [[0.15]]
grads:  [0.00057494]
Stock Position:  0.0005749422378175899
Bond Position:  [-1.385107]


portfolio before change:  [-1.32728327]
curr_Stock_Price:  100.72367457858908
curr_Factors:  [100.72367458]
mat_Sqrt:  [[0.15]]
grads:  [0.01561709]
Stock Position:  0.015617093668005436
Bond Position:  [-2.90029433]


portfolio before change:  [-1.32747631]
curr_Stock_Price:  100.72292162153045
curr_Factors:  [100.72292162]
mat_Sqrt:  [[0.15]]
grads:  [0.03883699]
Stock Position:  0.03883698638326983
Bond Position:  [-5.23925104]


portfolio before change:  [-1.36713209]
curr_Stock_Price:  99.71027032916395
curr_Factors:  [99.71027033]
mat_Sqrt:  [[0.15]]
grads:  [0.07795435]
Stock Position:  0.07795435072074194
Bond Position:  [-9.13998148]


portfolio before change:  [-1.37814823]
curr_Stock_Price:  99.57628337571589
curr_Factors:  [99.57628338]
mat_Sqrt:  [[0.15]]
grads:  [0.00544299]
Stock Position:  0.005442992839562307
Bond Position:  [-1.92014122]


portfolio before change:  [-1.38197308]
curr_Stock_Price:  98.89562121113103
curr_Factors:  [98.89562121]
mat_Sqrt:  [[0.15]]
grads:  [0.09905016]
Stock Position:  0.09905016100726048
Bond Position:  [-11.17760028]


portfolio before change:  [-1.35924666]
curr_Stock_Price:  99.13211792198146
curr_Factors:  [99.13211792]
mat_Sqrt:  [[0.15]]
grads:  [0.11906164]
Stock Position:  0.11906164470499306
Bond Position:  [-13.16207967]


portfolio before change:  [-1.40186886]
curr_Stock_Price:  98.78104313970503
curr_Factors:  [98.78104314]
mat_Sqrt:  [[0.15]]
grads:  [-0.08540594]
Stock Position:  -0.08540594251215179
Bond Position:  [7.03461923]


portfolio before change:  [-1.30886508]
curr_Stock_Price:  97.69722982134358
curr_Factors:  [97.69722982]
mat_Sqrt:  [[0.15]]
grads:  [0.05943427]
Stock Position:  0.059434265150683244
Bond Position:  [-7.11542815]


portfolio before change:  [-1.28670604]
curr_Stock_Price:  98.0775453896605
curr_Factors:  [98.07754539]
mat_Sqrt:  [[0.15]]
grads:  [-0.05826123]
Stock Position:  -0.05826122553804812
Bond Position:  [4.42741196]


portfolio before change:  [-1.29172448]
curr_Stock_Price:  98.16843201306773
curr_Factors:  [98.16843201]
mat_Sqrt:  [[0.15]]
grads:  [0.00992449]
Stock Position:  0.009924489751022114
Bond Position:  [-2.26599608]


portfolio before change:  [-1.28932269]
curr_Stock_Price:  98.42470878805537
curr_Factors:  [98.42470879]
mat_Sqrt:  [[0.15]]
grads:  [0.02586731]
Stock Position:  0.02586730689568026
Bond Position:  [-3.83530484]


portfolio before change:  [-1.29334034]
curr_Stock_Price:  98.27865827926064
curr_Factors:  [98.27865828]
mat_Sqrt:  [[0.15]]
grads:  [-0.08430933]
Stock Position:  -0.08430933040247299
Bond Position:  [6.99246753]


portfolio before change:  [-1.2849665]
curr_Stock_Price:  98.18451926519283
curr_Factors:  [98.18451927]
mat_Sqrt:  [[0.15]]
grads:  [0.10003174]
Stock Position:  0.10003173585893424
Bond Position:  [-11.1065344]


portfolio before change:  [-1.2915941]
curr_Stock_Price:  98.1252039414473
curr_Factors:  [98.12520394]
mat_Sqrt:  [[0.15]]
grads:  [-0.01833409]
Stock Position:  -0.018334092639142395
Bond Position:  [0.50744248]


portfolio before change:  [-1.2957688]
curr_Stock_Price:  98.35463536990238
curr_Factors:  [98.35463537]
mat_Sqrt:  [[0.15]]
grads:  [0.02320718]
Stock Position:  0.023207181396790694
Bond Position:  [-3.57830266]


portfolio before change:  [-1.27448835]
curr_Stock_Price:  99.28124912138138
curr_Factors:  [99.28124912]
mat_Sqrt:  [[0.15]]
grads:  [0.14006058]
Stock Position:  0.14006057935380964
Bond Position:  [-15.17987762]


portfolio before change:  [-1.27248755]
curr_Stock_Price:  99.30230843751109
curr_Factors:  [99.30230844]
mat_Sqrt:  [[0.15]]
grads:  [0.06964105]
Stock Position:  0.06964105158780041
Bond Position:  [-8.18800473]


portfolio before change:  [-1.26284063]
curr_Stock_Price:  99.4481805425228
curr_Factors:  [99.44818054]
mat_Sqrt:  [[0.15]]
grads:  [0.38064776]
Stock Position:  0.380647760734898
Bond Position:  [-39.11756786]


portfolio before change:  [-0.96103488]
curr_Stock_Price:  100.24747768703097
curr_Factors:  [100.24747769]
mat_Sqrt:  [[0.15]]
grads:  [-0.09061294]
Stock Position:  -0.09061293528741757
Bond Position:  [8.12268333]


portfolio before change:  [-0.92997919]
curr_Stock_Price:  99.91035136737268
curr_Factors:  [99.91035137]
mat_Sqrt:  [[0.15]]
grads:  [-0.01809725]
Stock Position:  -0.0180972510907626
Bond Position:  [0.87812352]


portfolio before change:  [-0.92251594]
curr_Stock_Price:  99.50098724837875
curr_Factors:  [99.50098725]
mat_Sqrt:  [[0.15]]
grads:  [0.09008424]
Stock Position:  0.09008424126722119
Bond Position:  [-9.88598688]


portfolio before change:  [-0.86401893]
curr_Stock_Price:  100.15720529175992
curr_Factors:  [100.15720529]
mat_Sqrt:  [[0.15]]
grads:  [0.08965213]
Stock Position:  0.08965212644081175
Bond Position:  [-9.84332536]


portfolio before change:  [-0.84215514]
curr_Stock_Price:  100.40794135462136
curr_Factors:  [100.40794135]
mat_Sqrt:  [[0.15]]
grads:  [-0.04975039]
Stock Position:  -0.04975039080090955
Bond Position:  [4.15317918]


portfolio before change:  [-0.82715739]
curr_Stock_Price:  100.11169919539599
curr_Factors:  [100.1116992]
mat_Sqrt:  [[0.15]]
grads:  [0.09247012]
Stock Position:  0.09247012226319509
Bond Position:  [-10.08449846]


portfolio before change:  [-0.86870648]
curr_Stock_Price:  99.66919100942332
curr_Factors:  [99.66919101]
mat_Sqrt:  [[0.15]]
grads:  [-0.02439578]
Stock Position:  -0.02439577501481547
Bond Position:  [1.56280068]


portfolio before change:  [-0.87594302]
curr_Stock_Price:  99.96982571564757
curr_Factors:  [99.96982572]
mat_Sqrt:  [[0.15]]
grads:  [0.01964925]
Stock Position:  0.019649251008340068
Bond Position:  [-2.84027522]


portfolio before change:  [-0.8808514]
curr_Stock_Price:  99.72906037139786
curr_Factors:  [99.72906037]
mat_Sqrt:  [[0.15]]
grads:  [-0.135057]
Stock Position:  -0.13505699550201275
Bond Position:  [12.58825586]


portfolio before change:  [-0.9382067]
curr_Stock_Price:  100.15956075118916
curr_Factors:  [100.15956075]
mat_Sqrt:  [[0.15]]
grads:  [-0.03076524]
Stock Position:  -0.03076523845599346
Bond Position:  [2.14322607]


portfolio before change:  [-0.93904799]
curr_Stock_Price:  100.19126032184316
curr_Factors:  [100.19126032]
mat_Sqrt:  [[0.15]]
grads:  [0.03945493]
Stock Position:  0.039454932089783776
Bond Position:  [-4.89208736]


portfolio before change:  [-0.90421816]
curr_Stock_Price:  101.08178488625614
curr_Factors:  [101.08178489]
mat_Sqrt:  [[0.15]]
grads:  [0.06339156]
Stock Position:  0.06339156103121443
Bond Position:  [-7.3119503]


portfolio before change:  [-0.88405528]
curr_Stock_Price:  101.40706308915753
curr_Factors:  [101.40706309]
mat_Sqrt:  [[0.15]]
grads:  [0.04886837]
Stock Position:  0.04886837131123479
Bond Position:  [-5.8396533]


portfolio before change:  [-0.89297065]
curr_Stock_Price:  101.2320956535191
curr_Factors:  [101.23209565]
mat_Sqrt:  [[0.15]]
grads:  [0.00893623]
Stock Position:  0.008936228218798976
Bond Position:  [-1.79760376]


portfolio before change:  [-0.89678413]
curr_Stock_Price:  100.8179239732702
curr_Factors:  [100.81792397]
mat_Sqrt:  [[0.15]]
grads:  [-0.0262057]
Stock Position:  -0.026205701867317237
Bond Position:  [1.74522033]


portfolio before change:  [-0.88329562]
curr_Stock_Price:  100.30736982187744
curr_Factors:  [100.30736982]
mat_Sqrt:  [[0.15]]
grads:  [-0.03063118]
Stock Position:  -0.030631175264179487
Bond Position:  [2.189237]


portfolio before change:  [-0.89951324]
curr_Stock_Price:  100.84128502107374
curr_Factors:  [100.84128502]
mat_Sqrt:  [[0.15]]
grads:  [0.09379766]
Stock Position:  0.09379765600674313
Bond Position:  [-10.3581894]


portfolio before change:  [-0.91827094]
curr_Stock_Price:  100.64820673868441
curr_Factors:  [100.64820674]
mat_Sqrt:  [[0.15]]
grads:  [-0.01407761]
Stock Position:  -0.014077609374958128
Bond Position:  [0.4986152]


portfolio before change:  [-0.92636018]
curr_Stock_Price:  101.22503830924704
curr_Factors:  [101.22503831]
mat_Sqrt:  [[0.15]]
grads:  [-0.06924959]
Stock Position:  -0.06924959325648258
Bond Position:  [6.08343255]


portfolio before change:  [-0.9358487]
curr_Stock_Price:  101.36754807267667
curr_Factors:  [101.36754807]
mat_Sqrt:  [[0.15]]
grads:  [-0.09752392]
Stock Position:  -0.09752392045900275
Bond Position:  [8.94991199]


portfolio before change:  [-0.86224414]
curr_Stock_Price:  100.61855051631345
curr_Factors:  [100.61855052]
mat_Sqrt:  [[0.15]]
grads:  [-0.01925629]
Stock Position:  -0.01925629328394408
Bond Position:  [1.07529618]


portfolio before change:  [-0.86991332]
curr_Stock_Price:  101.02030990684328
curr_Factors:  [101.02030991]
mat_Sqrt:  [[0.15]]
grads:  [0.05882065]
Stock Position:  0.058820653363826074
Bond Position:  [-6.81199396]


portfolio before change:  [-0.85056219]
curr_Stock_Price:  101.3565335970539
curr_Factors:  [101.3565336]
mat_Sqrt:  [[0.15]]
grads:  [-0.09072724]
Stock Position:  -0.09072723778108696
Bond Position:  [8.34523613]


portfolio before change:  [-0.96485775]
curr_Stock_Price:  102.62205379720153
curr_Factors:  [102.6220538]
mat_Sqrt:  [[0.15]]
grads:  [-0.00262588]
Stock Position:  -0.002625884999599597
Bond Position:  [-0.69538404]


portfolio before change:  [-0.96482989]
curr_Stock_Price:  102.59489271116645
curr_Factors:  [102.59489271]
mat_Sqrt:  [[0.15]]
grads:  [0.01552162]
Stock Position:  0.015521624904712423
Bond Position:  [-2.55726933]


portfolio before change:  [-0.96225418]
curr_Stock_Price:  102.77113326606634
curr_Factors:  [102.77113327]
mat_Sqrt:  [[0.15]]
grads:  [-0.09092369]
Stock Position:  -0.09092369221475045
Bond Position:  [8.38207671]


portfolio before change:  [-0.96779451]
curr_Stock_Price:  102.83782899950741
curr_Factors:  [102.837829]
mat_Sqrt:  [[0.15]]
grads:  [0.01434602]
Stock Position:  0.01434601705333854
Bond Position:  [-2.44310776]


portfolio before change:  [-0.96346048]
curr_Stock_Price:  103.15057985273226
curr_Factors:  [103.15057985]
mat_Sqrt:  [[0.15]]
grads:  [0.04383952]
Stock Position:  0.04383952351773261
Bond Position:  [-5.48553275]


portfolio before change:  [-0.91791106]
curr_Stock_Price:  104.19740418616863
curr_Factors:  [104.19740419]
mat_Sqrt:  [[0.15]]
grads:  [-0.07371207]
Stock Position:  -0.07371207150714022
Bond Position:  [6.76269545]


portfolio before change:  [-0.93508787]
curr_Stock_Price:  104.43616422830851
curr_Factors:  [104.43616423]
mat_Sqrt:  [[0.15]]
grads:  [-0.02706021]
Stock Position:  -0.027060207843132025
Bond Position:  [1.89097644]


portfolio before change:  [-0.93774347]
curr_Stock_Price:  104.53866853379728
curr_Factors:  [104.53866853]
mat_Sqrt:  [[0.15]]
grads:  [0.02317085]
Stock Position:  0.023170849725563703
Bond Position:  [-3.35999325]


portfolio before change:  [-0.92746209]
curr_Stock_Price:  104.99145235598374
curr_Factors:  [104.99145236]
mat_Sqrt:  [[0.15]]
grads:  [0.02055065]
Stock Position:  0.0205506488704229
Bond Position:  [-3.08510456]


portfolio before change:  [-0.92184451]
curr_Stock_Price:  105.27418840503299
curr_Factors:  [105.27418841]
mat_Sqrt:  [[0.15]]
grads:  [-0.01968025]
Stock Position:  -0.01968025424160868
Bond Position:  [1.14997829]


portfolio before change:  [-0.91282628]
curr_Stock_Price:  104.81960315422607
curr_Factors:  [104.81960315]
mat_Sqrt:  [[0.15]]
grads:  [-0.05811302]
Stock Position:  -0.058113016824927685
Bond Position:  [5.17855708]


portfolio before change:  [-0.9465915]
curr_Stock_Price:  105.40619958656607
curr_Factors:  [105.40619959]
mat_Sqrt:  [[0.15]]
grads:  [0.0792911]
Stock Position:  0.07929110489288671
Bond Position:  [-9.30436552]


portfolio before change:  [-0.98807398]
curr_Stock_Price:  104.89036690257474
curr_Factors:  [104.8903669]
mat_Sqrt:  [[0.15]]
grads:  [-0.14753155]
Stock Position:  -0.14753155011763466
Bond Position:  [14.48656444]


portfolio before change:  [-0.9175234]
curr_Stock_Price:  104.41829741662576
curr_Factors:  [104.41829742]
mat_Sqrt:  [[0.15]]
grads:  [-0.05123303]
Stock Position:  -0.051233033758904166
Bond Position:  [4.43214276]


portfolio before change:  [-0.8994011]
curr_Stock_Price:  104.0699815896898
curr_Factors:  [104.06998159]
mat_Sqrt:  [[0.15]]
grads:  [0.11002142]
Stock Position:  0.11002141552123873
Bond Position:  [-12.34932779]


portfolio before change:  [-0.91718468]
curr_Stock_Price:  103.91535966798648
curr_Factors:  [103.91535967]
mat_Sqrt:  [[0.15]]
grads:  [-0.00400682]
Stock Position:  -0.004006816920844303
Bond Position:  [-0.50081486]


portfolio before change:  [-0.91499543]
curr_Stock_Price:  103.36116615665404
curr_Factors:  [103.36116616]
mat_Sqrt:  [[0.15]]
grads:  [0.08158212]
Stock Position:  0.0815821235836775
Bond Position:  [-9.34741887]


portfolio before change:  [-0.93038508]
curr_Stock_Price:  103.17968753690788
curr_Factors:  [103.17968754]
mat_Sqrt:  [[0.15]]
grads:  [-0.10226677]
Stock Position:  -0.1022667737223936
Bond Position:  [9.62146868]


portfolio before change:  [-0.95204417]
curr_Stock_Price:  103.3973579850449
curr_Factors:  [103.39735799]
mat_Sqrt:  [[0.15]]
grads:  [-0.08498564]
Stock Position:  -0.08498563789452866
Bond Position:  [7.83524625]


portfolio before change:  [-0.94542864]
curr_Stock_Price:  103.32527742340704
curr_Factors:  [103.32527742]
mat_Sqrt:  [[0.15]]
grads:  [-0.02165039]
Stock Position:  -0.021650392843722648
Bond Position:  [1.29160421]


portfolio before change:  [-0.95508545]
curr_Stock_Price:  103.7750402739171
curr_Factors:  [103.77504027]
mat_Sqrt:  [[0.15]]
grads:  [0.08147329]
Stock Position:  0.08147328795771513
Bond Position:  [-9.40997919]


portfolio before change:  [-0.90037]
curr_Stock_Price:  104.45383443602964
curr_Factors:  [104.45383444]
mat_Sqrt:  [[0.15]]
grads:  [-0.11523363]
Stock Position:  -0.115233634241888
Bond Position:  [11.13622495]


portfolio before change:  [-0.89677662]
curr_Stock_Price:  104.428691187756
curr_Factors:  [104.42869119]
mat_Sqrt:  [[0.15]]
grads:  [0.11876776]
Stock Position:  0.11876776452295337
Bond Position:  [-13.29953883]


portfolio before change:  [-0.84761186]
curr_Stock_Price:  104.84964719979084
curr_Factors:  [104.8496472]
mat_Sqrt:  [[0.15]]
grads:  [0.03005227]
Stock Position:  0.030052270286423783
Bond Position:  [-3.9985818]


portfolio before change:  [-0.83128872]
curr_Stock_Price:  105.4011216802308
curr_Factors:  [105.40112168]
mat_Sqrt:  [[0.15]]
grads:  [0.0825876]
Stock Position:  0.08258760068009341
Bond Position:  [-9.53611447]


portfolio before change:  [-0.7742621]
curr_Stock_Price:  106.0988371588694
curr_Factors:  [106.09883716]
mat_Sqrt:  [[0.15]]
grads:  [-0.17614162]
Stock Position:  -0.17614161527159258
Bond Position:  [17.91415845]


portfolio before change:  [-0.67083546]
curr_Stock_Price:  105.51801487976435
curr_Factors:  [105.51801488]
mat_Sqrt:  [[0.15]]
grads:  [-0.05283186]
Stock Position:  -0.052831857953813344
Bond Position:  [4.90387732]


portfolio before change:  [-0.68798741]
curr_Stock_Price:  105.84846800751204
curr_Factors:  [105.84846801]
mat_Sqrt:  [[0.15]]
grads:  [-0.03988643]
Stock Position:  -0.0398864283239327
Bond Position:  [3.53392992]


portfolio before change:  [-0.65447136]
curr_Stock_Price:  105.01371872269321
curr_Factors:  [105.01371872]
mat_Sqrt:  [[0.15]]
grads:  [0.05388767]
Stock Position:  0.05388767442684041
Bond Position:  [-6.31341645]


portfolio before change:  [-0.63692473]
curr_Stock_Price:  105.34665630134893
curr_Factors:  [105.3466563]
mat_Sqrt:  [[0.15]]
grads:  [0.04093102]
Stock Position:  0.04093101896541488
Bond Position:  [-4.94887072]


portfolio before change:  [-0.61629749]
curr_Stock_Price:  105.85816463832285
curr_Factors:  [105.85816464]
mat_Sqrt:  [[0.15]]
grads:  [-0.00675875]
Stock Position:  -0.006758751744421471
Bond Position:  [0.09917157]


portfolio before change:  [-0.61382167]
curr_Stock_Price:  105.49276810416164
curr_Factors:  [105.4927681]
mat_Sqrt:  [[0.15]]
grads:  [-0.00534741]
Stock Position:  -0.005347409588132305
Bond Position:  [-0.04970863]


portfolio before change:  [-0.61484786]
curr_Stock_Price:  105.6840920659826
curr_Factors:  [105.68409207]
mat_Sqrt:  [[0.15]]
grads:  [0.04900328]
Stock Position:  0.049003276839920736
Bond Position:  [-5.79371468]


portfolio before change:  [-0.60614983]
curr_Stock_Price:  105.86898072229192
curr_Factors:  [105.86898072]
mat_Sqrt:  [[0.15]]
grads:  [-0.02105187]
Stock Position:  -0.02105186897335258
Bond Position:  [1.62259008]


portfolio before change:  [-0.60880891]
curr_Stock_Price:  106.00010929919033
curr_Factors:  [106.0001093]
mat_Sqrt:  [[0.15]]
grads:  [0.14613288]
Stock Position:  0.14613288161556923
Bond Position:  [-16.09891034]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.60880891]
Stock Price:  106.12998054436324
PL:  [-6.73878946]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 2.33387989e+00]
 [-4.06528347e-02]
 [-2.09699250e-03]
 [ 7.57118543e-04]
 [ 2.05615271e-03]
 [ 2.14216017e-02]
 [ 1.21184312e-02]
 [ 1.22729029e-03]
 [ 1.00792879e-02]
 [ 1.55497553e-02]
 [-1.86184015e-02]
 [ 8.42395052e-03]
 [-4.95182075e-03]
 [-1.86083140e-03]
 [ 4.25930469e-03]
 [-2.61638599e-03]
 [ 1.33332315e-02]
 [ 3.87305756e-03]
 [ 7.55933757e-03]
 [ 1.79364779e-02]
 [ 9.72401496e-03]
 [ 5.25812076e-02]
 [-2.16722262e-02]
 [-1.29541663e-03]
 [ 9.33319453e-03]
 [-3.18616194e-03]
 [ 1.61996726e-02]
 [ 1.29330081e-02]
 [-2.00152279e-02]
 [ 1.81533581e-03]
 [-6.86448485e-03]
 [-3.71168706e-03]
 [-2.05059951e-02]
 [ 1.55534357e-02]
 [ 1.97345724e-02]
 [-7.85898668e-03]
 [ 3.23989507e-03]
 [-2.98896640e-03]
 [ 1.16632695e-02]
 [-9.54686627e-04]
 [-1.37268919e-02]
 [-2.57135412e-03]
 [-2.89717394e-03]
 [ 5.30660342e-03]
 [-1.11789156e-02]
 [ 2.32754602e-03]
 [ 1.13961018e-03]
 [-1.36549195e-02]
 [-3.71173997e-03]
 [ 4.52241628e-03]
 [-1.15077891e-03]
 [-3.17337486e-03]
 [ 3.65853955e-03]
 [ 1.21993825e-03]
 [ 1.80234761e-03]
 [-7.53713577e-03]
 [ 1.10130336e-02]
 [-1.22145859e-02]
 [-1.17794378e-02]
 [ 1.47930408e-02]
 [ 1.24438655e-03]
 [ 1.25532565e-02]
 [-1.53622394e-02]
 [-1.27462381e-02]
 [-3.36886753e-03]
 [-1.85255405e-03]
 [-1.67064505e-02]
 [ 2.96862725e-02]
 [ 1.92762535e-03]
 [ 7.40971602e-03]
 [-1.82826331e-02]
 [-7.92343290e-03]
 [-6.79575812e-03]
 [ 7.55422975e-03]
 [ 6.57086389e-03]
 [-6.95486174e-04]
 [-2.12982306e-03]
 [ 8.33966847e-03]
 [-3.72015146e-03]
 [ 2.46685422e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.33387989]
mat_Sqrt:  [[0.15]]
grads:  [15.55919927]
init_Out:  [2.16356024]
Stock Position:  15.559199270681882
Bond position:  [-1553.75636683]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.92520992]
curr_Stock_Price:  100.18373455065199
curr_Factors:  [100.18373455]
mat_Sqrt:  [[0.15]]
grads:  [-0.2710189]
Stock Position:  -0.27101889812853575
Bond Position:  [32.07689527]


portfolio before change:  [4.87811877]
curr_Stock_Price:  100.36488804864814
curr_Factors:  [100.36488805]
mat_Sqrt:  [[0.15]]
grads:  [-0.01397995]
Stock Position:  -0.013979949967552452
Bond Position:  [6.28121488]


portfolio before change:  [4.88507729]
curr_Stock_Price:  99.89521984324847
curr_Factors:  [99.89521984]
mat_Sqrt:  [[0.15]]
grads:  [0.00504746]
Stock Position:  0.005047456955876879
Bond Position:  [4.38086047]


portfolio before change:  [4.88491947]
curr_Stock_Price:  99.809704500934
curr_Factors:  [99.8097045]
mat_Sqrt:  [[0.15]]
grads:  [0.01370768]
Stock Position:  0.013707684724929455
Bond Position:  [3.51675951]


portfolio before change:  [4.88698196]
curr_Stock_Price:  99.94413176072223
curr_Factors:  [99.94413176]
mat_Sqrt:  [[0.15]]
grads:  [0.14281068]
Stock Position:  0.1428106781854829
Bond Position:  [-9.38610728]


portfolio before change:  [4.89759606]
curr_Stock_Price:  100.02256254372799
curr_Factors:  [100.02256254]
mat_Sqrt:  [[0.15]]
grads:  [0.08078954]
Stock Position:  0.08078954162551756
Bond Position:  [-3.18318092]


portfolio before change:  [4.9212609]
curr_Stock_Price:  100.31794468139242
curr_Factors:  [100.31794468]
mat_Sqrt:  [[0.15]]
grads:  [0.00818194]
Stock Position:  0.008181935246668342
Bond Position:  [4.10046597]


portfolio before change:  [4.91966976]
curr_Stock_Price:  100.09215124613982
curr_Factors:  [100.09215125]
mat_Sqrt:  [[0.15]]
grads:  [0.06719525]
Stock Position:  0.06719525251126851
Bond Position:  [-1.80604762]


portfolio before change:  [4.89964034]
curr_Stock_Price:  99.7957532298698
curr_Factors:  [99.79575323]
mat_Sqrt:  [[0.15]]
grads:  [0.10366504]
Stock Position:  0.1036650356282394
Bond Position:  [-5.44568998]


portfolio before change:  [4.91009168]
curr_Stock_Price:  99.89985498135091
curr_Factors:  [99.89985498]
mat_Sqrt:  [[0.15]]
grads:  [-0.12412268]
Stock Position:  -0.12412267652663694
Bond Position:  [17.30992907]


portfolio before change:  [4.91467521]
curr_Stock_Price:  99.8716439883321
curr_Factors:  [99.87164399]
mat_Sqrt:  [[0.15]]
grads:  [0.05615967]
Stock Position:  0.05615967012033713
Bond Position:  [-0.69408337]


portfolio before change:  [4.9142256]
curr_Stock_Price:  99.86441060077144
curr_Factors:  [99.8644106]
mat_Sqrt:  [[0.15]]
grads:  [-0.03301214]
Stock Position:  -0.03301213834789283
Bond Position:  [8.21096334]


portfolio before change:  [4.89163438]
curr_Stock_Price:  100.56428717464877
curr_Factors:  [100.56428717]
mat_Sqrt:  [[0.15]]
grads:  [-0.01240554]
Stock Position:  -0.01240554265109773
Bond Position:  [6.13918894]


portfolio before change:  [4.9043934]
curr_Stock_Price:  99.56672484733399
curr_Factors:  [99.56672485]
mat_Sqrt:  [[0.15]]
grads:  [0.02839536]
Stock Position:  0.028395364607066473
Bond Position:  [2.07715994]


portfolio before change:  [4.88326205]
curr_Stock_Price:  98.81796964114534
curr_Factors:  [98.81796964]
mat_Sqrt:  [[0.15]]
grads:  [-0.01744257]
Stock Position:  -0.01744257327102925
Bond Position:  [6.60690172]


portfolio before change:  [4.88090824]
curr_Stock_Price:  98.97658992769621
curr_Factors:  [98.97658993]
mat_Sqrt:  [[0.15]]
grads:  [0.08888821]
Stock Position:  0.08888821030726295
Bond Position:  [-3.9169437]


portfolio before change:  [4.94280682]
curr_Stock_Price:  99.67570847410015
curr_Factors:  [99.67570847]
mat_Sqrt:  [[0.15]]
grads:  [0.02582038]
Stock Position:  0.025820383737392583
Bond Position:  [2.36914178]


portfolio before change:  [4.9382269]
curr_Stock_Price:  99.49259739153949
curr_Factors:  [99.49259739]
mat_Sqrt:  [[0.15]]
grads:  [0.05039558]
Stock Position:  0.05039558377224176
Bond Position:  [-0.07576063]


portfolio before change:  [4.90593779]
curr_Stock_Price:  98.85197830844614
curr_Factors:  [98.85197831]
mat_Sqrt:  [[0.15]]
grads:  [0.11957652]
Stock Position:  0.1195765193785049
Bond Position:  [-6.91443771]


portfolio before change:  [5.0039314]
curr_Stock_Price:  99.67509787852781
curr_Factors:  [99.67509788]
mat_Sqrt:  [[0.15]]
grads:  [0.06482677]
Stock Position:  0.06482676639008188
Bond Position:  [-1.45768288]


portfolio before change:  [4.96685169]
curr_Stock_Price:  99.10452184105554
curr_Factors:  [99.10452184]
mat_Sqrt:  [[0.15]]
grads:  [0.35054138]
Stock Position:  0.3505413839834131
Bond Position:  [-29.77338455]


portfolio before change:  [4.59130966]
curr_Stock_Price:  98.03851035829051
curr_Factors:  [98.03851036]
mat_Sqrt:  [[0.15]]
grads:  [-0.14448151]
Stock Position:  -0.1444815083043615
Bond Position:  [18.75606151]


portfolio before change:  [4.44268684]
curr_Stock_Price:  99.07528738478388
curr_Factors:  [99.07528738]
mat_Sqrt:  [[0.15]]
grads:  [-0.00863611]
Stock Position:  -0.008636110834370868
Bond Position:  [5.298312]


portfolio before change:  [4.45169026]
curr_Stock_Price:  98.07110048762468
curr_Factors:  [98.07110049]
mat_Sqrt:  [[0.15]]
grads:  [0.0622213]
Stock Position:  0.062221296892831235
Bond Position:  [-1.6504208]


portfolio before change:  [4.38896986]
curr_Stock_Price:  97.06473691870447
curr_Factors:  [97.06473692]
mat_Sqrt:  [[0.15]]
grads:  [-0.02124108]
Stock Position:  -0.021241079614967857
Bond Position:  [6.45072967]


portfolio before change:  [4.38474649]
curr_Stock_Price:  97.28254863946565
curr_Factors:  [97.28254864]
mat_Sqrt:  [[0.15]]
grads:  [0.10799782]
Stock Position:  0.10799781759969963
Bond Position:  [-6.12155645]


portfolio before change:  [4.5418013]
curr_Stock_Price:  98.74033195574233
curr_Factors:  [98.74033196]
mat_Sqrt:  [[0.15]]
grads:  [0.08622005]
Stock Position:  0.0862200537931051
Bond Position:  [-3.97159544]


portfolio before change:  [4.5014442]
curr_Stock_Price:  98.27514013931776
curr_Factors:  [98.27514014]
mat_Sqrt:  [[0.15]]
grads:  [-0.13343485]
Stock Position:  -0.133434852401716
Bond Position:  [17.61477302]


portfolio before change:  [4.48431556]
curr_Stock_Price:  98.41175813377022
curr_Factors:  [98.41175813]
mat_Sqrt:  [[0.15]]
grads:  [0.01210224]
Stock Position:  0.012102238745699214
Bond Position:  [3.29331296]


portfolio before change:  [4.48101389]
curr_Stock_Price:  98.12193531115626
curr_Factors:  [98.12193531]
mat_Sqrt:  [[0.15]]
grads:  [-0.04576323]
Stock Position:  -0.04576323233630996
Bond Position:  [8.97139081]


portfolio before change:  [4.46029545]
curr_Stock_Price:  98.58691923851207
curr_Factors:  [98.58691924]
mat_Sqrt:  [[0.15]]
grads:  [-0.02474458]
Stock Position:  -0.024744580399446763
Bond Position:  [6.8997874]


portfolio before change:  [4.452614]
curr_Stock_Price:  98.9147771430818
curr_Factors:  [98.91477714]
mat_Sqrt:  [[0.15]]
grads:  [-0.13670663]
Stock Position:  -0.1367066342943348
Bond Position:  [17.97492026]


portfolio before change:  [4.43703134]
curr_Stock_Price:  99.03698132920405
curr_Factors:  [99.03698133]
mat_Sqrt:  [[0.15]]
grads:  [0.10368957]
Stock Position:  0.1036895714271597
Bond Position:  [-5.83207081]


portfolio before change:  [4.43081935]
curr_Stock_Price:  98.98058724377087
curr_Factors:  [98.98058724]
mat_Sqrt:  [[0.15]]
grads:  [0.13156382]
Stock Position:  0.13156381611528467
Bond Position:  [-8.59144443]


portfolio before change:  [4.47556758]
curr_Stock_Price:  99.3247944859308
curr_Factors:  [99.32479449]
mat_Sqrt:  [[0.15]]
grads:  [-0.05239324]
Stock Position:  -0.05239324451186137
Bond Position:  [9.67951583]


portfolio before change:  [4.46655905]
curr_Stock_Price:  99.50828232039683
curr_Factors:  [99.50828232]
mat_Sqrt:  [[0.15]]
grads:  [0.0215993]
Stock Position:  0.02159930049201773
Bond Position:  [2.31724976]


portfolio before change:  [4.47529248]
curr_Stock_Price:  99.90591544437514
curr_Factors:  [99.90591544]
mat_Sqrt:  [[0.15]]
grads:  [-0.01992644]
Stock Position:  -0.019926442667308357
Bond Position:  [6.46606198]


portfolio before change:  [4.4793739]
curr_Stock_Price:  99.72137275933429
curr_Factors:  [99.72137276]
mat_Sqrt:  [[0.15]]
grads:  [0.07775513]
Stock Position:  0.07775512987930401
Bond Position:  [-3.27447439]


portfolio before change:  [4.488731]
curr_Stock_Price:  99.84434547412896
curr_Factors:  [99.84434547]
mat_Sqrt:  [[0.15]]
grads:  [-0.00636458]
Stock Position:  -0.006364577510814593
Bond Position:  [5.12419807]


portfolio before change:  [4.49155386]
curr_Stock_Price:  99.4511395892663
curr_Factors:  [99.45113959]
mat_Sqrt:  [[0.15]]
grads:  [-0.09151261]
Stock Position:  -0.09151261254661282
Bond Position:  [13.59258746]


portfolio before change:  [4.47585317]
curr_Stock_Price:  99.63199172376747
curr_Factors:  [99.63199172]
mat_Sqrt:  [[0.15]]
grads:  [-0.01714236]
Stock Position:  -0.017142360798385325
Bond Position:  [6.18378072]


portfolio before change:  [4.47209229]
curr_Stock_Price:  99.87392935776921
curr_Factors:  [99.87392936]
mat_Sqrt:  [[0.15]]
grads:  [-0.01931449]
Stock Position:  -0.019314492944623497
Bond Position:  [6.40110659]


portfolio before change:  [4.47230593]
curr_Stock_Price:  99.883582431689
curr_Factors:  [99.88358243]
mat_Sqrt:  [[0.15]]
grads:  [0.03537736]
Stock Position:  0.03537735610029977
Bond Position:  [0.93868886]


portfolio before change:  [4.47321167]
curr_Stock_Price:  99.9075265253093
curr_Factors:  [99.90752653]
mat_Sqrt:  [[0.15]]
grads:  [-0.0745261]
Stock Position:  -0.0745261039244709
Bond Position:  [11.91893038]


portfolio before change:  [4.43564054]
curr_Stock_Price:  100.42165636051895
curr_Factors:  [100.42165636]
mat_Sqrt:  [[0.15]]
grads:  [0.01551697]
Stock Position:  0.015516973468427366
Bond Position:  [2.87740036]


portfolio before change:  [4.4438877]
curr_Stock_Price:  100.94155924107162
curr_Factors:  [100.94155924]
mat_Sqrt:  [[0.15]]
grads:  [0.0075974]
Stock Position:  0.007597401211632698
Bond Position:  [3.67699417]


portfolio before change:  [4.45399123]
curr_Stock_Price:  102.24117556947255
curr_Factors:  [102.24117557]
mat_Sqrt:  [[0.15]]
grads:  [-0.0910328]
Stock Position:  -0.09103279678509993
Bond Position:  [13.76129138]


portfolio before change:  [4.50515797]
curr_Stock_Price:  101.68855455767292
curr_Factors:  [101.68855456]
mat_Sqrt:  [[0.15]]
grads:  [-0.02474493]
Stock Position:  -0.02474493311479671
Bond Position:  [7.02143445]


portfolio before change:  [4.48159499]
curr_Stock_Price:  102.65852422552305
curr_Factors:  [102.65852423]
mat_Sqrt:  [[0.15]]
grads:  [0.03014944]
Stock Position:  0.030149441834761197
Bond Position:  [1.38649778]


portfolio before change:  [4.4553051]
curr_Stock_Price:  101.78366418682707
curr_Factors:  [101.78366419]
mat_Sqrt:  [[0.15]]
grads:  [-0.00767186]
Stock Position:  -0.007671859413187222
Bond Position:  [5.23617507]


portfolio before change:  [4.45369533]
curr_Stock_Price:  102.03615093710337
curr_Factors:  [102.03615094]
mat_Sqrt:  [[0.15]]
grads:  [-0.02115583]
Stock Position:  -0.021155832403723537
Bond Position:  [6.61235504]


portfolio before change:  [4.45081397]
curr_Stock_Price:  102.19188330842702
curr_Factors:  [102.19188331]
mat_Sqrt:  [[0.15]]
grads:  [0.02439026]
Stock Position:  0.024390263635112434
Bond Position:  [1.95832699]


portfolio before change:  [4.46231743]
curr_Stock_Price:  102.65850629864549
curr_Factors:  [102.6585063]
mat_Sqrt:  [[0.15]]
grads:  [0.00813292]
Stock Position:  0.00813292168020416
Bond Position:  [3.62740384]


portfolio before change:  [4.47002788]
curr_Stock_Price:  103.57868455493826
curr_Factors:  [103.57868455]
mat_Sqrt:  [[0.15]]
grads:  [0.01201565]
Stock Position:  0.012015650748668349
Bond Position:  [3.22546259]


portfolio before change:  [4.47809289]
curr_Stock_Price:  104.23311470165146
curr_Factors:  [104.2331147]
mat_Sqrt:  [[0.15]]
grads:  [-0.05024757]
Stock Position:  -0.050247571778380885
Bond Position:  [9.7155538]


portfolio before change:  [4.46727938]
curr_Stock_Price:  104.46040425888751
curr_Factors:  [104.46040426]
mat_Sqrt:  [[0.15]]
grads:  [0.07342022]
Stock Position:  0.0734202242627057
Bond Position:  [-3.20222693]


portfolio before change:  [4.43302944]
curr_Stock_Price:  103.99663836612562
curr_Factors:  [103.99663837]
mat_Sqrt:  [[0.15]]
grads:  [-0.08143057]
Stock Position:  -0.08143057257466119
Bond Position:  [12.90153525]


portfolio before change:  [4.49206819]
curr_Stock_Price:  103.28152147149201
curr_Factors:  [103.28152147]
mat_Sqrt:  [[0.15]]
grads:  [-0.07852959]
Stock Position:  -0.07852958528084998
Bond Position:  [12.60272324]


portfolio before change:  [4.51506313]
curr_Stock_Price:  102.99873320264555
curr_Factors:  [102.9987332]
mat_Sqrt:  [[0.15]]
grads:  [0.09862027]
Stock Position:  0.09862027185627721
Bond Position:  [-5.64269994]


portfolio before change:  [4.54269397]
curr_Stock_Price:  103.28248336166419
curr_Factors:  [103.28248336]
mat_Sqrt:  [[0.15]]
grads:  [0.00829591]
Stock Position:  0.00829591032745448
Bond Position:  [3.68587175]


portfolio before change:  [4.54578724]
curr_Stock_Price:  103.62758062023688
curr_Factors:  [103.62758062]
mat_Sqrt:  [[0.15]]
grads:  [0.08368838]
Stock Position:  0.08368837661656386
Bond Position:  [-4.12663676]


portfolio before change:  [4.51276533]
curr_Stock_Price:  103.23608076056539
curr_Factors:  [103.23608076]
mat_Sqrt:  [[0.15]]
grads:  [-0.10241493]
Stock Position:  -0.10241492954148063
Bond Position:  [15.08568126]


portfolio before change:  [4.50522512]
curr_Stock_Price:  103.31891133138267
curr_Factors:  [103.31891133]
mat_Sqrt:  [[0.15]]
grads:  [-0.08497492]
Stock Position:  -0.08497492064718208
Bond Position:  [13.28474141]


portfolio before change:  [4.45081206]
curr_Stock_Price:  103.96902526852335
curr_Factors:  [103.96902527]
mat_Sqrt:  [[0.15]]
grads:  [-0.02245912]
Stock Position:  -0.022459116848796385
Bond Position:  [6.78586455]


portfolio before change:  [4.46531069]
curr_Stock_Price:  103.34235351971328
curr_Factors:  [103.34235352]
mat_Sqrt:  [[0.15]]
grads:  [-0.01235036]
Stock Position:  -0.012350360315799211
Bond Position:  [5.74162599]


portfolio before change:  [4.46933189]
curr_Stock_Price:  103.04581674902181
curr_Factors:  [103.04581675]
mat_Sqrt:  [[0.15]]
grads:  [-0.11137634]
Stock Position:  -0.11137633649841958
Bond Position:  [15.94619745]


portfolio before change:  [4.54114132]
curr_Stock_Price:  102.4100195098563
curr_Factors:  [102.41001951]
mat_Sqrt:  [[0.15]]
grads:  [0.19790848]
Stock Position:  0.197908483495904
Bond Position:  [-15.72667033]


portfolio before change:  [4.45558599]
curr_Stock_Price:  101.98268873520497
curr_Factors:  [101.98268874]
mat_Sqrt:  [[0.15]]
grads:  [0.01285084]
Stock Position:  0.012850835678239967
Bond Position:  [3.14502321]


portfolio before change:  [4.46348106]
curr_Stock_Price:  102.58175475283748
curr_Factors:  [102.58175475]
mat_Sqrt:  [[0.15]]
grads:  [0.04939811]
Stock Position:  0.049398106813498606
Bond Position:  [-0.60386342]


portfolio before change:  [4.49156141]
curr_Stock_Price:  103.15096865408684
curr_Factors:  [103.15096865]
mat_Sqrt:  [[0.15]]
grads:  [-0.12188422]
Stock Position:  -0.12188422096621311
Bond Position:  [17.06403686]


portfolio before change:  [4.36799098]
curr_Stock_Price:  104.1735535711988
curr_Factors:  [104.17355357]
mat_Sqrt:  [[0.15]]
grads:  [-0.05282289]
Stock Position:  -0.052822886021053124
Bond Position:  [9.87073872]


portfolio before change:  [4.35061549]
curr_Stock_Price:  104.51417156857464
curr_Factors:  [104.51417157]
mat_Sqrt:  [[0.15]]
grads:  [-0.04530505]
Stock Position:  -0.04530505411120324
Bond Position:  [9.08563569]


portfolio before change:  [4.33795844]
curr_Stock_Price:  104.80607980923352
curr_Factors:  [104.80607981]
mat_Sqrt:  [[0.15]]
grads:  [0.05036153]
Stock Position:  0.05036153164202332
Bond Position:  [-0.94023626]


portfolio before change:  [4.33836112]
curr_Stock_Price:  104.815242389936
curr_Factors:  [104.81524239]
mat_Sqrt:  [[0.15]]
grads:  [0.04380576]
Stock Position:  0.04380575926041694
Bond Position:  [-0.25315016]


portfolio before change:  [4.34155408]
curr_Stock_Price:  104.88849267073945
curr_Factors:  [104.88849267]
mat_Sqrt:  [[0.15]]
grads:  [-0.00463657]
Stock Position:  -0.0046365744952347274
Bond Position:  [4.82787739]


portfolio before change:  [4.34107714]
curr_Stock_Price:  105.05643701980637
curr_Factors:  [105.05643702]
mat_Sqrt:  [[0.15]]
grads:  [-0.01419882]
Stock Position:  -0.01419882038647486
Bond Position:  [5.83275462]


portfolio before change:  [4.3459859]
curr_Stock_Price:  104.73639662824166
curr_Factors:  [104.73639663]
mat_Sqrt:  [[0.15]]
grads:  [0.05559779]
Stock Position:  0.0555977898183791
Bond Position:  [-1.47712627]


portfolio before change:  [4.34797983]
curr_Stock_Price:  104.77392062832985
curr_Factors:  [104.77392063]
mat_Sqrt:  [[0.15]]
grads:  [-0.02480101]
Stock Position:  -0.024801009764836915
Bond Position:  [6.94647885]


portfolio before change:  [4.36287804]
curr_Stock_Price:  104.19071681652832
curr_Factors:  [104.19071682]
mat_Sqrt:  [[0.15]]
grads:  [0.16445695]
Stock Position:  0.16445694831718038
Bond Position:  [-12.77200929]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.36287804]
Stock Price:  104.67102142416171
PL:  [-0.30814339]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  1.0994966185948456
FINAL STD P&L:  8.59281441457505
