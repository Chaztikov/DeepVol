WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-18 18:43:50.677292: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-18 18:43:50.704830: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:04:00.0
2019-12-18 18:43:50.705380: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 18:43:50.707439: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 18:43:50.709458: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 18:43:50.710081: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 18:43:50.712536: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 18:43:50.714500: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 18:43:50.719530: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 18:43:50.721548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 18:43:50.722036: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-18 18:43:50.728377: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399810000 Hz
2019-12-18 18:43:50.728560: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55fa1b35fc30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-18 18:43:50.728576: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-18 18:43:50.729721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:04:00.0
2019-12-18 18:43:50.729744: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 18:43:50.729756: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 18:43:50.729767: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 18:43:50.729778: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 18:43:50.729788: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 18:43:50.729799: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 18:43:50.729810: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 18:43:50.731716: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 18:43:50.731746: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 18:43:50.823514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-18 18:43:50.823548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-18 18:43:50.823558: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-18 18:43:50.826583: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:04:00.0, compute capability: 6.0)
2019-12-18 18:43:50.828707: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55fa1b998f40 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-18 18:43:50.828724: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-18 18:43:58.252451: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 3.0426e+02,   Y0: 2.2870e+00,  elapsed time   7
INFO   step:     1,    loss: 8.9452e+00,   Y0: 2.2820e+00,  elapsed time  10
INFO   step:     2,    loss: 8.9428e+00,   Y0: 2.2770e+00,  elapsed time  10
INFO   step:     3,    loss: 8.9480e+00,   Y0: 2.2723e+00,  elapsed time  10
INFO   step:     4,    loss: 8.9507e+00,   Y0: 2.2675e+00,  elapsed time  10
INFO   step:     5,    loss: 8.9526e+00,   Y0: 2.2627e+00,  elapsed time  10
INFO   step:     6,    loss: 8.9503e+00,   Y0: 2.2580e+00,  elapsed time  10
INFO   step:     7,    loss: 8.9514e+00,   Y0: 2.2532e+00,  elapsed time  10
INFO   step:     8,    loss: 8.9374e+00,   Y0: 2.2484e+00,  elapsed time  10
INFO   step:     9,    loss: 8.9392e+00,   Y0: 2.2438e+00,  elapsed time  10
INFO   step:    10,    loss: 8.9359e+00,   Y0: 2.2391e+00,  elapsed time  10
INFO   step:    11,    loss: 8.9412e+00,   Y0: 2.2343e+00,  elapsed time  10
INFO   step:    12,    loss: 8.9473e+00,   Y0: 2.2299e+00,  elapsed time  10
INFO   step:    13,    loss: 8.9563e+00,   Y0: 2.2253e+00,  elapsed time  10
INFO   step:    14,    loss: 8.9590e+00,   Y0: 2.2207e+00,  elapsed time  10
INFO   step:    15,    loss: 8.9623e+00,   Y0: 2.2160e+00,  elapsed time  10
INFO   step:    16,    loss: 8.9520e+00,   Y0: 2.2114e+00,  elapsed time  10
INFO   step:    17,    loss: 8.9505e+00,   Y0: 2.2069e+00,  elapsed time  10
INFO   step:    18,    loss: 8.9438e+00,   Y0: 2.2027e+00,  elapsed time  10
INFO   step:    19,    loss: 8.9360e+00,   Y0: 2.1990e+00,  elapsed time  10
INFO   step:    20,    loss: 8.9274e+00,   Y0: 2.1951e+00,  elapsed time  10
INFO   step:    21,    loss: 8.9233e+00,   Y0: 2.1914e+00,  elapsed time  11
INFO   step:    22,    loss: 8.9171e+00,   Y0: 2.1878e+00,  elapsed time  11
INFO   step:    23,    loss: 8.9160e+00,   Y0: 2.1841e+00,  elapsed time  11
INFO   step:    24,    loss: 8.9137e+00,   Y0: 2.1807e+00,  elapsed time  11
INFO   step:    25,    loss: 8.9111e+00,   Y0: 2.1773e+00,  elapsed time  11
INFO   step:    26,    loss: 8.9082e+00,   Y0: 2.1740e+00,  elapsed time  11
INFO   step:    27,    loss: 8.9062e+00,   Y0: 2.1711e+00,  elapsed time  11
INFO   step:    28,    loss: 8.9048e+00,   Y0: 2.1682e+00,  elapsed time  11
INFO   step:    29,    loss: 8.9034e+00,   Y0: 2.1655e+00,  elapsed time  11
INFO   step:    30,    loss: 8.9024e+00,   Y0: 2.1630e+00,  elapsed time  11
INFO   step:    31,    loss: 8.9010e+00,   Y0: 2.1608e+00,  elapsed time  11
INFO   step:    32,    loss: 8.8999e+00,   Y0: 2.1584e+00,  elapsed time  11
INFO   step:    33,    loss: 8.8988e+00,   Y0: 2.1557e+00,  elapsed time  11
INFO   step:    34,    loss: 8.8980e+00,   Y0: 2.1529e+00,  elapsed time  11
INFO   step:    35,    loss: 8.8973e+00,   Y0: 2.1503e+00,  elapsed time  11
INFO   step:    36,    loss: 8.8966e+00,   Y0: 2.1480e+00,  elapsed time  11
INFO   step:    37,    loss: 8.8959e+00,   Y0: 2.1460e+00,  elapsed time  11
INFO   step:    38,    loss: 8.8953e+00,   Y0: 2.1441e+00,  elapsed time  11
INFO   step:    39,    loss: 8.8948e+00,   Y0: 2.1425e+00,  elapsed time  11
INFO   step:    40,    loss: 8.8943e+00,   Y0: 2.1413e+00,  elapsed time  11
INFO   step:    41,    loss: 8.8938e+00,   Y0: 2.1401e+00,  elapsed time  11
INFO   step:    42,    loss: 8.8933e+00,   Y0: 2.1391e+00,  elapsed time  12
INFO   step:    43,    loss: 8.8928e+00,   Y0: 2.1379e+00,  elapsed time  12
INFO   step:    44,    loss: 8.8923e+00,   Y0: 2.1364e+00,  elapsed time  12
INFO   step:    45,    loss: 8.8918e+00,   Y0: 2.1352e+00,  elapsed time  12
INFO   step:    46,    loss: 8.8913e+00,   Y0: 2.1344e+00,  elapsed time  12
INFO   step:    47,    loss: 8.8908e+00,   Y0: 2.1337e+00,  elapsed time  12
INFO   step:    48,    loss: 8.8903e+00,   Y0: 2.1331e+00,  elapsed time  12
INFO   step:    49,    loss: 8.8899e+00,   Y0: 2.1332e+00,  elapsed time  12
INFO   step:    50,    loss: 8.8894e+00,   Y0: 2.1334e+00,  elapsed time  12
INFO   step:    51,    loss: 8.8889e+00,   Y0: 2.1337e+00,  elapsed time  12
INFO   step:    52,    loss: 8.8885e+00,   Y0: 2.1338e+00,  elapsed time  12
INFO   step:    53,    loss: 8.8880e+00,   Y0: 2.1337e+00,  elapsed time  12
INFO   step:    54,    loss: 8.8876e+00,   Y0: 2.1339e+00,  elapsed time  12
INFO   step:    55,    loss: 8.8871e+00,   Y0: 2.1336e+00,  elapsed time  12
INFO   step:    56,    loss: 8.8867e+00,   Y0: 2.1336e+00,  elapsed time  12
INFO   step:    57,    loss: 8.8862e+00,   Y0: 2.1335e+00,  elapsed time  12
INFO   step:    58,    loss: 8.8858e+00,   Y0: 2.1335e+00,  elapsed time  12
INFO   step:    59,    loss: 8.8854e+00,   Y0: 2.1336e+00,  elapsed time  12
INFO   step:    60,    loss: 8.8850e+00,   Y0: 2.1337e+00,  elapsed time  12
INFO   step:    61,    loss: 8.8845e+00,   Y0: 2.1340e+00,  elapsed time  12
INFO   step:    62,    loss: 8.8841e+00,   Y0: 2.1340e+00,  elapsed time  12
INFO   step:    63,    loss: 8.8837e+00,   Y0: 2.1338e+00,  elapsed time  12
INFO   step:    64,    loss: 8.8833e+00,   Y0: 2.1334e+00,  elapsed time  13
INFO   step:    65,    loss: 8.8829e+00,   Y0: 2.1328e+00,  elapsed time  13
INFO   step:    66,    loss: 8.8825e+00,   Y0: 2.1325e+00,  elapsed time  13
INFO   step:    67,    loss: 8.8821e+00,   Y0: 2.1323e+00,  elapsed time  13
INFO   step:    68,    loss: 8.8817e+00,   Y0: 2.1325e+00,  elapsed time  13
INFO   step:    69,    loss: 8.8813e+00,   Y0: 2.1324e+00,  elapsed time  13
INFO   step:    70,    loss: 8.8809e+00,   Y0: 2.1332e+00,  elapsed time  13
INFO   step:    71,    loss: 8.8806e+00,   Y0: 2.1337e+00,  elapsed time  13
INFO   step:    72,    loss: 8.8802e+00,   Y0: 2.1339e+00,  elapsed time  13
INFO   step:    73,    loss: 8.8798e+00,   Y0: 2.1341e+00,  elapsed time  13
INFO   step:    74,    loss: 8.8794e+00,   Y0: 2.1342e+00,  elapsed time  13
INFO   step:    75,    loss: 8.8790e+00,   Y0: 2.1340e+00,  elapsed time  13
INFO   step:    76,    loss: 8.8786e+00,   Y0: 2.1338e+00,  elapsed time  13
INFO   step:    77,    loss: 8.8783e+00,   Y0: 2.1334e+00,  elapsed time  13
INFO   step:    78,    loss: 8.8779e+00,   Y0: 2.1329e+00,  elapsed time  13
INFO   step:    79,    loss: 8.8775e+00,   Y0: 2.1325e+00,  elapsed time  13
INFO   step:    80,    loss: 8.8771e+00,   Y0: 2.1323e+00,  elapsed time  13
INFO   step:    81,    loss: 8.8767e+00,   Y0: 2.1321e+00,  elapsed time  13
INFO   step:    82,    loss: 8.8764e+00,   Y0: 2.1320e+00,  elapsed time  13
INFO   step:    83,    loss: 8.8760e+00,   Y0: 2.1318e+00,  elapsed time  13
INFO   step:    84,    loss: 8.8756e+00,   Y0: 2.1315e+00,  elapsed time  13
INFO   step:    85,    loss: 8.8752e+00,   Y0: 2.1310e+00,  elapsed time  14
INFO   step:    86,    loss: 8.8749e+00,   Y0: 2.1302e+00,  elapsed time  14
INFO   step:    87,    loss: 8.8745e+00,   Y0: 2.1297e+00,  elapsed time  14
INFO   step:    88,    loss: 8.8741e+00,   Y0: 2.1293e+00,  elapsed time  14
INFO   step:    89,    loss: 8.8738e+00,   Y0: 2.1296e+00,  elapsed time  14
INFO   step:    90,    loss: 8.8734e+00,   Y0: 2.1301e+00,  elapsed time  14
INFO   step:    91,    loss: 8.8731e+00,   Y0: 2.1302e+00,  elapsed time  14
INFO   step:    92,    loss: 8.8727e+00,   Y0: 2.1310e+00,  elapsed time  14
INFO   step:    93,    loss: 8.8724e+00,   Y0: 2.1317e+00,  elapsed time  14
INFO   step:    94,    loss: 8.8721e+00,   Y0: 2.1325e+00,  elapsed time  14
INFO   step:    95,    loss: 8.8718e+00,   Y0: 2.1334e+00,  elapsed time  14
INFO   step:    96,    loss: 8.8715e+00,   Y0: 2.1344e+00,  elapsed time  14
INFO   step:    97,    loss: 8.8712e+00,   Y0: 2.1356e+00,  elapsed time  14
INFO   step:    98,    loss: 8.8709e+00,   Y0: 2.1374e+00,  elapsed time  14
INFO   step:    99,    loss: 8.8705e+00,   Y0: 2.1382e+00,  elapsed time  14
INFO   step:   100,    loss: 8.8702e+00,   Y0: 2.1389e+00,  elapsed time  14
INFO   step:   101,    loss: 8.8699e+00,   Y0: 2.1398e+00,  elapsed time  14
INFO   step:   102,    loss: 8.8696e+00,   Y0: 2.1409e+00,  elapsed time  14
INFO   step:   103,    loss: 8.8693e+00,   Y0: 2.1422e+00,  elapsed time  14
INFO   step:   104,    loss: 8.8691e+00,   Y0: 2.1435e+00,  elapsed time  14
INFO   step:   105,    loss: 8.8688e+00,   Y0: 2.1450e+00,  elapsed time  14
INFO   step:   106,    loss: 8.8685e+00,   Y0: 2.1463e+00,  elapsed time  15
INFO   step:   107,    loss: 8.8683e+00,   Y0: 2.1475e+00,  elapsed time  15
INFO   step:   108,    loss: 8.8680e+00,   Y0: 2.1493e+00,  elapsed time  15
INFO   step:   109,    loss: 8.8678e+00,   Y0: 2.1509e+00,  elapsed time  15
INFO   step:   110,    loss: 8.8676e+00,   Y0: 2.1526e+00,  elapsed time  15
INFO   step:   111,    loss: 8.8673e+00,   Y0: 2.1537e+00,  elapsed time  15
INFO   step:   112,    loss: 8.8671e+00,   Y0: 2.1546e+00,  elapsed time  15
INFO   step:   113,    loss: 8.8668e+00,   Y0: 2.1557e+00,  elapsed time  15
INFO   step:   114,    loss: 8.8665e+00,   Y0: 2.1560e+00,  elapsed time  15
INFO   step:   115,    loss: 8.8662e+00,   Y0: 2.1560e+00,  elapsed time  15
INFO   step:   116,    loss: 8.8658e+00,   Y0: 2.1560e+00,  elapsed time  15
INFO   step:   117,    loss: 8.8655e+00,   Y0: 2.1562e+00,  elapsed time  15
INFO   step:   118,    loss: 8.8652e+00,   Y0: 2.1563e+00,  elapsed time  15
INFO   step:   119,    loss: 8.8649e+00,   Y0: 2.1564e+00,  elapsed time  15
INFO   step:   120,    loss: 8.8646e+00,   Y0: 2.1568e+00,  elapsed time  15
INFO   step:   121,    loss: 8.8643e+00,   Y0: 2.1570e+00,  elapsed time  15
INFO   step:   122,    loss: 8.8640e+00,   Y0: 2.1574e+00,  elapsed time  15
INFO   step:   123,    loss: 8.8637e+00,   Y0: 2.1579e+00,  elapsed time  15
INFO   step:   124,    loss: 8.8635e+00,   Y0: 2.1586e+00,  elapsed time  15
INFO   step:   125,    loss: 8.8632e+00,   Y0: 2.1595e+00,  elapsed time  15
INFO   step:   126,    loss: 8.8630e+00,   Y0: 2.1608e+00,  elapsed time  15
INFO   step:   127,    loss: 8.8627e+00,   Y0: 2.1609e+00,  elapsed time  15
INFO   step:   128,    loss: 8.8624e+00,   Y0: 2.1615e+00,  elapsed time  15
INFO   step:   129,    loss: 8.8622e+00,   Y0: 2.1625e+00,  elapsed time  16
INFO   step:   130,    loss: 8.8620e+00,   Y0: 2.1637e+00,  elapsed time  16
INFO   step:   131,    loss: 8.8618e+00,   Y0: 2.1647e+00,  elapsed time  16
INFO   step:   132,    loss: 8.8615e+00,   Y0: 2.1654e+00,  elapsed time  16
INFO   step:   133,    loss: 8.8612e+00,   Y0: 2.1659e+00,  elapsed time  16
INFO   step:   134,    loss: 8.8609e+00,   Y0: 2.1662e+00,  elapsed time  16
INFO   step:   135,    loss: 8.8606e+00,   Y0: 2.1664e+00,  elapsed time  16
INFO   step:   136,    loss: 8.8603e+00,   Y0: 2.1661e+00,  elapsed time  16
INFO   step:   137,    loss: 8.8599e+00,   Y0: 2.1654e+00,  elapsed time  16
INFO   step:   138,    loss: 8.8596e+00,   Y0: 2.1651e+00,  elapsed time  16
INFO   step:   139,    loss: 8.8593e+00,   Y0: 2.1651e+00,  elapsed time  16
INFO   step:   140,    loss: 8.8590e+00,   Y0: 2.1653e+00,  elapsed time  16
INFO   step:   141,    loss: 8.8587e+00,   Y0: 2.1653e+00,  elapsed time  16
INFO   step:   142,    loss: 8.8584e+00,   Y0: 2.1652e+00,  elapsed time  16
INFO   step:   143,    loss: 8.8581e+00,   Y0: 2.1655e+00,  elapsed time  16
INFO   step:   144,    loss: 8.8578e+00,   Y0: 2.1661e+00,  elapsed time  16
INFO   step:   145,    loss: 8.8575e+00,   Y0: 2.1662e+00,  elapsed time  16
INFO   step:   146,    loss: 8.8572e+00,   Y0: 2.1658e+00,  elapsed time  16
INFO   step:   147,    loss: 8.8568e+00,   Y0: 2.1648e+00,  elapsed time  16
INFO   step:   148,    loss: 8.8564e+00,   Y0: 2.1639e+00,  elapsed time  16
INFO   step:   149,    loss: 8.8560e+00,   Y0: 2.1630e+00,  elapsed time  16
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 1) dtype=float64>]
num_iterations:  150
total time intervals:  10
# of dimensions:  1
Loss out:  9.744149232226723
Output_Z_Vals:  [[[ 3.30443445e+00]
  [ 3.30443445e+00]
  [ 3.30443445e+00]
  ...
  [ 3.30443445e+00]
  [ 3.30443445e+00]
  [ 3.30443445e+00]]

 [[-1.33532399e-02]
  [-1.31457675e-02]
  [-1.30220373e-02]
  ...
  [-1.56034772e-02]
  [-1.30075246e-02]
  [-1.31490730e-02]]

 [[-1.02747010e-02]
  [-1.29211962e-02]
  [-1.34592235e-02]
  ...
  [-7.70362137e-03]
  [-1.32603181e-02]
  [-1.29846172e-02]]

 ...

 [[-1.54744961e-02]
  [-1.54797937e-02]
  [-1.36179911e-02]
  ...
  [-1.04240699e-02]
  [-1.48440467e-02]
  [-1.32871059e-02]]

 [[ 4.38335670e-03]
  [ 4.37986068e-03]
  [ 3.88545176e-03]
  ...
  [ 2.47812813e-03]
  [ 3.69265916e-03]
  [ 4.46464114e-03]]

 [[ 3.08700785e-05]
  [-1.62907181e-03]
  [-7.49897848e-03]
  ...
  [ 3.16987439e-04]
  [-3.73660157e-03]
  [ 3.52812610e-04]]]
Z_Vals dimensionality:  (10, 200, 1)
X_test:  [[[100.         100.18377126 101.10309997 ...  98.46956396  99.17869086
   101.43422289]]

 [[100.          99.80288749  99.62206832 ...  98.45480801  98.6120893
    98.01294524]]

 [[100.          99.23950922  99.2582332  ...  97.55391039  96.77294486
    94.01760254]]

 ...

 [[100.         102.00305118 102.16026747 ... 102.25507376 100.75928835
    99.02199531]]

 [[100.          99.33754809  99.40084326 ...  97.2773537   97.95703843
    99.98570116]]

 [[100.          99.80677003  99.58531893 ...  98.81264793 100.05809732
    96.78614109]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.33532399e-02]
 [-1.02747010e-02]
 [ 1.39409810e-02]
 [ 1.01005063e-02]
 [-2.54921927e-02]
 [ 1.29113584e-02]
 [-1.54744961e-02]
 [ 4.38335670e-03]
 [ 3.08700785e-05]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.11000443]
curr_Stock_Price:  100.183771258419
curr_Factors:  [100.18377126]
mat_Sqrt:  [[0.15]]
grads:  [-0.0890216]
Stock Position:  -0.08902159920889238
Bond Position:  [14.02852396]


portfolio before change:  [5.03518033]
curr_Stock_Price:  101.10309997068994
curr_Factors:  [101.10309997]
mat_Sqrt:  [[0.15]]
grads:  [-0.06849801]
Stock Position:  -0.06849800648000108
Bond Position:  [11.96054113]


portfolio before change:  [5.07966039]
curr_Stock_Price:  100.54106481296192
curr_Factors:  [100.54106481]
mat_Sqrt:  [[0.15]]
grads:  [0.09293987]
Stock Position:  0.09293987314766429
Bond Position:  [-4.26461342]


portfolio before change:  [4.92488239]
curr_Stock_Price:  98.89865716483348
curr_Factors:  [98.89865716]
mat_Sqrt:  [[0.15]]
grads:  [0.06733671]
Stock Position:  0.06733670893874703
Bond Position:  [-1.7346277]


portfolio before change:  [4.86294402]
curr_Stock_Price:  97.99170996360832
curr_Factors:  [97.99170996]
mat_Sqrt:  [[0.15]]
grads:  [-0.16994795]
Stock Position:  -0.16994795146740696
Bond Position:  [21.51643439]


portfolio before change:  [4.92117843]
curr_Stock_Price:  97.71236854727357
curr_Factors:  [97.71236855]
mat_Sqrt:  [[0.15]]
grads:  [0.08607572]
Stock Position:  0.08607572279943963
Bond Position:  [-3.48948432]


portfolio before change:  [5.04028366]
curr_Stock_Price:  99.11636965103342
curr_Factors:  [99.11636965]
mat_Sqrt:  [[0.15]]
grads:  [-0.10316331]
Stock Position:  -0.10316330725070079
Bond Position:  [15.26545616]


portfolio before change:  [5.11464491]
curr_Stock_Price:  98.46956395928642
curr_Factors:  [98.46956396]
mat_Sqrt:  [[0.15]]
grads:  [0.02922238]
Stock Position:  0.02922237800536886
Bond Position:  [2.23713009]


portfolio before change:  [5.13648613]
curr_Stock_Price:  99.17869086321191
curr_Factors:  [99.17869086]
mat_Sqrt:  [[0.15]]
grads:  [0.0002058]
Stock Position:  0.00020580052307426987
Bond Position:  [5.1160751]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.139509]
Stock Price:  101.43422289218249
PL:  [3.7052861]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.31457675e-02]
 [-1.29211962e-02]
 [ 8.06926371e-04]
 [ 1.21113296e-02]
 [ 1.35875244e-02]
 [ 1.18459448e-02]
 [-1.54797937e-02]
 [ 4.37986068e-03]
 [-1.62907181e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.28069845]
curr_Stock_Price:  99.80288749368238
curr_Factors:  [99.80288749]
mat_Sqrt:  [[0.15]]
grads:  [-0.08763845]
Stock Position:  -0.08763844983559113
Bond Position:  [5.46587189]


portfolio before change:  [-3.26211812]
curr_Stock_Price:  99.62206831798166
curr_Factors:  [99.62206832]
mat_Sqrt:  [[0.15]]
grads:  [-0.08614131]
Stock Position:  -0.08614130812009206
Bond Position:  [5.31945716]


portfolio before change:  [-3.18534547]
curr_Stock_Price:  98.7617115523366
curr_Factors:  [98.76171155]
mat_Sqrt:  [[0.15]]
grads:  [0.00537951]
Stock Position:  0.005379509142645622
Bond Position:  [-3.716635]


portfolio before change:  [-3.17982304]
curr_Stock_Price:  100.13381053536229
curr_Factors:  [100.13381054]
mat_Sqrt:  [[0.15]]
grads:  [0.0807422]
Stock Position:  0.08074219726405647
Bond Position:  [-11.26484692]


portfolio before change:  [-3.14697921]
curr_Stock_Price:  100.6103600642204
curr_Factors:  [100.61036006]
mat_Sqrt:  [[0.15]]
grads:  [0.0905835]
Stock Position:  0.09058349590466741
Bond Position:  [-12.26061735]


portfolio before change:  [-3.28831018]
curr_Stock_Price:  99.11782408905867
curr_Factors:  [99.11782409]
mat_Sqrt:  [[0.15]]
grads:  [0.07897297]
Stock Position:  0.07897296565024373
Bond Position:  [-11.1159387]


portfolio before change:  [-3.29323627]
curr_Stock_Price:  99.12584287048
curr_Factors:  [99.12584287]
mat_Sqrt:  [[0.15]]
grads:  [-0.10319862]
Stock Position:  -0.10319862459162471
Bond Position:  [6.93641437]


portfolio before change:  [-3.22051732]
curr_Stock_Price:  98.45480801241794
curr_Factors:  [98.45480801]
mat_Sqrt:  [[0.15]]
grads:  [0.02919907]
Stock Position:  0.029199071197944217
Bond Position:  [-6.09530627]


portfolio before change:  [-3.21897327]
curr_Stock_Price:  98.61208929965252
curr_Factors:  [98.6120893]
mat_Sqrt:  [[0.15]]
grads:  [-0.01086048]
Stock Position:  -0.01086047870686117
Bond Position:  [-2.14799877]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.21354055]
Stock Price:  98.01294524271331
PL:  [-3.21354055]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 3.30443445]
 [-0.01302204]
 [-0.01345922]
 [-0.00368234]
 [ 0.01003625]
 [-0.04090941]
 [ 0.01333816]
 [-0.01361799]
 [ 0.00388545]
 [-0.00749898]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.69167552]
curr_Stock_Price:  99.23950922461643
curr_Factors:  [99.23950922]
mat_Sqrt:  [[0.15]]
grads:  [-0.08681358]
Stock Position:  -0.08681358230075895
Bond Position:  [-7.07633822]


portfolio before change:  [-15.69684007]
curr_Stock_Price:  99.25823319885743
curr_Factors:  [99.2582332]
mat_Sqrt:  [[0.15]]
grads:  [-0.08972816]
Stock Position:  -0.08972815634020036
Bond Position:  [-6.7905818]


portfolio before change:  [-15.60671068]
curr_Stock_Price:  98.21591237015222
curr_Factors:  [98.21591237]
mat_Sqrt:  [[0.15]]
grads:  [-0.02454891]
Stock Position:  -0.024548908463459876
Bond Position:  [-13.19561724]


portfolio before change:  [-15.62919767]
curr_Stock_Price:  98.86309115260933
curr_Factors:  [98.86309115]
mat_Sqrt:  [[0.15]]
grads:  [0.06690836]
Stock Position:  0.06690836103706072
Bond Position:  [-22.24396507]


portfolio before change:  [-15.91071848]
curr_Stock_Price:  94.82180188217569
curr_Factors:  [94.82180188]
mat_Sqrt:  [[0.15]]
grads:  [-0.27272941]
Stock Position:  -0.27272941180574367
Bond Position:  [9.94997578]


portfolio before change:  [-16.35762397]
curr_Stock_Price:  96.47868855271386
curr_Factors:  [96.47868855]
mat_Sqrt:  [[0.15]]
grads:  [0.0889211]
Stock Position:  0.08892109674437948
Bond Position:  [-24.93661477]


portfolio before change:  [-16.3747877]
curr_Stock_Price:  96.4259192219883
curr_Factors:  [96.42591922]
mat_Sqrt:  [[0.15]]
grads:  [-0.09078661]
Stock Position:  -0.09078660741261255
Bond Position:  [-7.62060563]


portfolio before change:  [-16.48100545]
curr_Stock_Price:  97.55391038935615
curr_Factors:  [97.55391039]
mat_Sqrt:  [[0.15]]
grads:  [0.02590301]
Stock Position:  0.02590301174323604
Bond Position:  [-19.00794554]


portfolio before change:  [-16.51074116]
curr_Stock_Price:  96.77294485879165
curr_Factors:  [96.77294486]
mat_Sqrt:  [[0.15]]
grads:  [-0.04999319]
Stock Position:  -0.049993189884244664
Bond Position:  [-11.67275295]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.37883064]
Stock Price:  94.01760253832308
PL:  [-16.37883064]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.45563736e-02]
 [-1.38091053e-02]
 [ 1.53733257e-02]
 [ 4.76323503e-03]
 [ 9.00709806e-03]
 [ 1.31226054e-02]
 [-1.40861256e-02]
 [ 8.63783737e-04]
 [-1.26171907e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [28.75830044]
curr_Stock_Price:  101.25725129158776
curr_Factors:  [101.25725129]
mat_Sqrt:  [[0.15]]
grads:  [-0.09704249]
Stock Position:  -0.0970424908705105
Bond Position:  [38.58455632]


portfolio before change:  [29.00075636]
curr_Stock_Price:  98.9576522648359
curr_Factors:  [98.95765226]
mat_Sqrt:  [[0.15]]
grads:  [-0.0920607]
Stock Position:  -0.0920607017221674
Bond Position:  [38.11086726]


portfolio before change:  [28.86408336]
curr_Stock_Price:  100.64928821516686
curr_Factors:  [100.64928822]
mat_Sqrt:  [[0.15]]
grads:  [0.10248884]
Stock Position:  0.10248883769498264
Bond Position:  [18.5486548]


portfolio before change:  [29.02843954]
curr_Stock_Price:  102.16242404719331
curr_Factors:  [102.16242405]
mat_Sqrt:  [[0.15]]
grads:  [0.0317549]
Stock Position:  0.03175490022597494
Bond Position:  [25.78428196]


portfolio before change:  [29.02604135]
curr_Stock_Price:  101.68081150752774
curr_Factors:  [101.68081151]
mat_Sqrt:  [[0.15]]
grads:  [0.06004732]
Stock Position:  0.06004732041268661
Bond Position:  [22.92038108]


portfolio before change:  [28.92445545]
curr_Stock_Price:  99.7981470977281
curr_Factors:  [99.7981471]
mat_Sqrt:  [[0.15]]
grads:  [0.08748404]
Stock Position:  0.08748403613603349
Bond Position:  [20.19371074]


portfolio before change:  [28.69202564]
curr_Stock_Price:  97.02587919299658
curr_Factors:  [97.02587919]
mat_Sqrt:  [[0.15]]
grads:  [-0.0939075]
Stock Position:  -0.09390750403389266
Bond Position:  [37.80348379]


portfolio before change:  [28.99827443]
curr_Stock_Price:  93.96603510427713
curr_Factors:  [93.9660351]
mat_Sqrt:  [[0.15]]
grads:  [0.00575856]
Stock Position:  0.005758558243890818
Bond Position:  [28.45716555]


portfolio before change:  [29.01943292]
curr_Stock_Price:  95.1688261490374
curr_Factors:  [95.16882615]
mat_Sqrt:  [[0.15]]
grads:  [-0.0841146]
Stock Position:  -0.08411460435112665
Bond Position:  [37.02452107]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [29.00984599]
Stock Price:  95.5029395325303
PL:  [29.00984599]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 3.30443445]
 [-0.01324359]
 [-0.01465803]
 [ 0.00441326]
 [ 0.00859652]
 [-0.03238774]
 [ 0.01323125]
 [-0.0139847 ]
 [ 0.0036913 ]
 [-0.00660538]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-39.40635935]
curr_Stock_Price:  98.16301561265517
curr_Factors:  [98.16301561]
mat_Sqrt:  [[0.15]]
grads:  [-0.08829062]
Stock Position:  -0.08829062448894738
Bond Position:  [-30.7394854]


portfolio before change:  [-39.42949421]
curr_Stock_Price:  98.25092164082042
curr_Factors:  [98.25092164]
mat_Sqrt:  [[0.15]]
grads:  [-0.09772019]
Stock Position:  -0.09772019397493913
Bond Position:  [-29.82839509]


portfolio before change:  [-39.56837094]
curr_Stock_Price:  99.51942916767283
curr_Factors:  [99.51942917]
mat_Sqrt:  [[0.15]]
grads:  [0.02942173]
Stock Position:  0.02942172696208718
Bond Position:  [-42.49640441]


portfolio before change:  [-39.63781429]
curr_Stock_Price:  97.88152954851458
curr_Factors:  [97.88152955]
mat_Sqrt:  [[0.15]]
grads:  [0.05731011]
Stock Position:  0.05731010777034166
Bond Position:  [-45.2474153]


portfolio before change:  [-39.71651642]
curr_Stock_Price:  96.90311984646289
curr_Factors:  [96.90311985]
mat_Sqrt:  [[0.15]]
grads:  [-0.21591829]
Stock Position:  -0.21591828891197193
Bond Position:  [-18.79336059]


portfolio before change:  [-39.66130447]
curr_Stock_Price:  96.60388176287583
curr_Factors:  [96.60388176]
mat_Sqrt:  [[0.15]]
grads:  [0.0882083]
Stock Position:  0.08820830316288586
Bond Position:  [-48.18256896]


portfolio before change:  [-39.7929202]
curr_Stock_Price:  95.38496685131668
curr_Factors:  [95.38496685]
mat_Sqrt:  [[0.15]]
grads:  [-0.09323133]
Stock Position:  -0.09323132982403755
Bond Position:  [-30.90005289]


portfolio before change:  [-39.9846223]
curr_Stock_Price:  97.2754065989185
curr_Factors:  [97.2754066]
mat_Sqrt:  [[0.15]]
grads:  [0.02460868]
Stock Position:  0.02460867869235132
Bond Position:  [-42.37844153]


portfolio before change:  [-40.01125372]
curr_Stock_Price:  97.05447213485972
curr_Factors:  [97.05447213]
mat_Sqrt:  [[0.15]]
grads:  [-0.04403584]
Stock Position:  -0.04403584098045316
Bond Position:  [-35.73737842]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-40.00354982]
Stock Price:  96.4736483141901
PL:  [-40.00354982]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.42157663e-02]
 [-1.35990252e-02]
 [ 1.76644668e-02]
 [ 5.29871712e-03]
 [ 3.97693038e-02]
 [ 1.63889601e-03]
 [-8.18516039e-03]
 [ 1.81169334e-03]
 [-1.11124805e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.44521901]
curr_Stock_Price:  101.01607168078901
curr_Factors:  [101.01607168]
mat_Sqrt:  [[0.15]]
grads:  [-0.09477178]
Stock Position:  -0.09477177550731686
Bond Position:  [33.01869148]


portfolio before change:  [23.51450272]
curr_Stock_Price:  100.45925778870847
curr_Factors:  [100.45925779]
mat_Sqrt:  [[0.15]]
grads:  [-0.09066017]
Stock Position:  -0.09066016790856275
Bond Position:  [32.6221559]


portfolio before change:  [23.38140096]
curr_Stock_Price:  102.10735660436863
curr_Factors:  [102.1073566]
mat_Sqrt:  [[0.15]]
grads:  [0.11776311]
Stock Position:  0.11776311168349762
Bond Position:  [11.35692093]


portfolio before change:  [23.67288885]
curr_Stock_Price:  104.53433055375353
curr_Factors:  [104.53433055]
mat_Sqrt:  [[0.15]]
grads:  [0.03532478]
Stock Position:  0.03532478081330312
Bond Position:  [19.98023654]


portfolio before change:  [23.68142832]
curr_Stock_Price:  104.49319380046506
curr_Factors:  [104.4931938]
mat_Sqrt:  [[0.15]]
grads:  [0.26512869]
Stock Position:  0.26512869174830395
Bond Position:  [-4.02271545]


portfolio before change:  [23.77179285]
curr_Stock_Price:  104.84161476038317
curr_Factors:  [104.84161476]
mat_Sqrt:  [[0.15]]
grads:  [0.01092597]
Stock Position:  0.0109259733978374
Bond Position:  [22.62629616]


portfolio before change:  [23.75611738]
curr_Stock_Price:  102.37122188637777
curr_Factors:  [102.37122189]
mat_Sqrt:  [[0.15]]
grads:  [-0.05456774]
Stock Position:  -0.05456773596615468
Bond Position:  [29.34228319]


portfolio before change:  [23.74390407]
curr_Stock_Price:  102.86396945554691
curr_Factors:  [102.86396946]
mat_Sqrt:  [[0.15]]
grads:  [0.01207796]
Stock Position:  0.01207795560190938
Bond Position:  [22.50151762]


portfolio before change:  [23.73837158]
curr_Stock_Price:  101.47415952252244
curr_Factors:  [101.47415952]
mat_Sqrt:  [[0.15]]
grads:  [-0.00074083]
Stock Position:  -0.0007408320353075587
Bond Position:  [23.81354689]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.75137317]
Stock Price:  100.00035974794994
PL:  [23.75101342]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.36369943e-02]
 [-1.38294433e-02]
 [ 1.68521029e-02]
 [ 8.18361800e-03]
 [ 1.15977794e-02]
 [ 1.19174012e-02]
 [-1.52469392e-02]
 [ 4.41071700e-03]
 [-1.35973951e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.22828605]
curr_Stock_Price:  100.59768240245275
curr_Factors:  [100.5976824]
mat_Sqrt:  [[0.15]]
grads:  [-0.0909133]
Stock Position:  -0.09091329548059296
Bond Position:  [23.37395287]


portfolio before change:  [14.39069588]
curr_Stock_Price:  98.93983976966918
curr_Factors:  [98.93983977]
mat_Sqrt:  [[0.15]]
grads:  [-0.09219629]
Stock Position:  -0.09219628880793074
Bond Position:  [23.51258193]


portfolio before change:  [14.23374896]
curr_Stock_Price:  100.76969820850641
curr_Factors:  [100.76969821]
mat_Sqrt:  [[0.15]]
grads:  [0.11234735]
Stock Position:  0.1123473525600687
Bond Position:  [2.91254015]


portfolio before change:  [14.25277474]
curr_Stock_Price:  100.92608062080663
curr_Factors:  [100.92608062]
mat_Sqrt:  [[0.15]]
grads:  [0.05455745]
Stock Position:  0.054557453330347346
Bond Position:  [8.74650481]


portfolio before change:  [14.19738853]
curr_Stock_Price:  99.83071136987306
curr_Factors:  [99.83071137]
mat_Sqrt:  [[0.15]]
grads:  [0.07731853]
Stock Position:  0.07731852923955815
Bond Position:  [6.47862476]


portfolio before change:  [14.11326008]
curr_Stock_Price:  98.70072907243416
curr_Factors:  [98.70072907]
mat_Sqrt:  [[0.15]]
grads:  [0.07944934]
Stock Position:  0.07944934116953227
Bond Position:  [6.27155219]


portfolio before change:  [14.10589533]
curr_Stock_Price:  98.56855288293713
curr_Factors:  [98.56855288]
mat_Sqrt:  [[0.15]]
grads:  [-0.10164626]
Stock Position:  -0.10164626120028032
Bond Position:  [24.12502021]


portfolio before change:  [14.11628441]
curr_Stock_Price:  98.58504586110207
curr_Factors:  [98.58504586]
mat_Sqrt:  [[0.15]]
grads:  [0.02940478]
Stock Position:  0.02940478002068105
Bond Position:  [11.21741282]


portfolio before change:  [14.12515127]
curr_Stock_Price:  98.69580169129361
curr_Factors:  [98.69580169]
mat_Sqrt:  [[0.15]]
grads:  [-0.00906493]
Stock Position:  -0.009064930050059448
Bond Position:  [15.01982181]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.12531277]
Stock Price:  99.50665055956787
PL:  [14.12531277]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.31385736e-02]
 [-7.76177541e-03]
 [-3.10450244e-03]
 [ 5.17440844e-03]
 [ 6.01682524e-02]
 [-2.87775024e-03]
 [-6.03211162e-03]
 [-9.77059718e-04]
 [ 2.67450923e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.46683796]
curr_Stock_Price:  99.79443796113814
curr_Factors:  [99.79443796]
mat_Sqrt:  [[0.15]]
grads:  [-0.08759049]
Stock Position:  -0.08759049073265499
Bond Position:  [5.27420583]


portfolio before change:  [-3.66449572]
curr_Stock_Price:  102.08116470354832
curr_Factors:  [102.0811647]
mat_Sqrt:  [[0.15]]
grads:  [-0.05174517]
Stock Position:  -0.05174516941735045
Bond Position:  [1.61771144]


portfolio before change:  [-3.71687052]
curr_Stock_Price:  103.10896814150342
curr_Factors:  [103.10896814]
mat_Sqrt:  [[0.15]]
grads:  [-0.02069668]
Stock Position:  -0.02069668293418557
Bond Position:  [-1.5828569]


portfolio before change:  [-3.73721896]
curr_Stock_Price:  104.05389308612605
curr_Factors:  [104.05389309]
mat_Sqrt:  [[0.15]]
grads:  [0.03449606]
Stock Position:  0.034496056282912045
Bond Position:  [-7.32666791]


portfolio before change:  [-3.68319867]
curr_Stock_Price:  105.72609997872955
curr_Factors:  [105.72609998]
mat_Sqrt:  [[0.15]]
grads:  [0.40112168]
Stock Position:  0.4011216827566655
Bond Position:  [-46.0922298]


portfolio before change:  [-3.13225282]
curr_Stock_Price:  107.15708152106936
curr_Factors:  [107.15708152]
mat_Sqrt:  [[0.15]]
grads:  [-0.019185]
Stock Position:  -0.01918500160417581
Bond Position:  [-1.07644404]


portfolio before change:  [-3.11870377]
curr_Stock_Price:  106.42278890255743
curr_Factors:  [106.4227889]
mat_Sqrt:  [[0.15]]
grads:  [-0.04021408]
Stock Position:  -0.04021407748050973
Bond Position:  [1.1609905]


portfolio before change:  [-3.10399464]
curr_Stock_Price:  106.07145692925212
curr_Factors:  [106.07145693]
mat_Sqrt:  [[0.15]]
grads:  [-0.00651373]
Stock Position:  -0.0065137314519537306
Bond Position:  [-2.41307366]


portfolio before change:  [-3.10122448]
curr_Stock_Price:  105.46089975620103
curr_Factors:  [105.46089976]
mat_Sqrt:  [[0.15]]
grads:  [0.01783006]
Stock Position:  0.017830061551889986
Bond Position:  [-4.98159881]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.10662496]
Stock Price:  105.29774501827501
PL:  [-8.40436998]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.31172127e-02]
 [-1.33980106e-02]
 [ 4.61719245e-03]
 [ 8.58192438e-03]
 [ 1.43347173e-02]
 [ 1.26776087e-02]
 [-1.48377964e-02]
 [ 4.20997273e-03]
 [ 3.56283556e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.01954748]
curr_Stock_Price:  99.76934851600589
curr_Factors:  [99.76934852]
mat_Sqrt:  [[0.15]]
grads:  [-0.08744808]
Stock Position:  -0.08744808435982805
Bond Position:  [4.70509093]


portfolio before change:  [-3.97633621]
curr_Stock_Price:  99.30212122632209
curr_Factors:  [99.30212123]
mat_Sqrt:  [[0.15]]
grads:  [-0.08932007]
Stock Position:  -0.08932007079001779
Bond Position:  [4.89333629]


portfolio before change:  [-4.00642992]
curr_Stock_Price:  99.66644012339354
curr_Factors:  [99.66644012]
mat_Sqrt:  [[0.15]]
grads:  [0.03078128]
Stock Position:  0.030781282980094315
Bond Position:  [-7.07429082]


portfolio before change:  [-4.06527505]
curr_Stock_Price:  97.86966322283654
curr_Factors:  [97.86966322]
mat_Sqrt:  [[0.15]]
grads:  [0.05721283]
Stock Position:  0.05721282920443547
Bond Position:  [-9.66467537]


portfolio before change:  [-3.92047137]
curr_Stock_Price:  100.48511207946402
curr_Factors:  [100.48511208]
mat_Sqrt:  [[0.15]]
grads:  [0.09556478]
Stock Position:  0.09556478179764459
Bond Position:  [-13.52330918]


portfolio before change:  [-3.92755485]
curr_Stock_Price:  100.48176208127161
curr_Factors:  [100.48176208]
mat_Sqrt:  [[0.15]]
grads:  [0.08451739]
Stock Position:  0.0845173915933992
Bond Position:  [-12.42001129]


portfolio before change:  [-4.00049317]
curr_Stock_Price:  99.69225877935641
curr_Factors:  [99.69225878]
mat_Sqrt:  [[0.15]]
grads:  [-0.09891864]
Stock Position:  -0.09891864241671715
Bond Position:  [5.86092973]


portfolio before change:  [-4.06866952]
curr_Stock_Price:  100.411107571824
curr_Factors:  [100.41110757]
mat_Sqrt:  [[0.15]]
grads:  [0.02806648]
Stock Position:  0.028066484833660678
Bond Position:  [-6.88685635]


portfolio before change:  [-4.0808786]
curr_Stock_Price:  100.098821011315
curr_Factors:  [100.09882101]
mat_Sqrt:  [[0.15]]
grads:  [0.00237522]
Stock Position:  0.002375223708582112
Bond Position:  [-4.31863569]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.08123225]
Stock Price:  100.85925564574957
PL:  [-4.9404879]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.31728576e-02]
 [-1.43945460e-02]
 [-2.54033888e-02]
 [ 9.97594918e-03]
 [ 1.45588656e-02]
 [ 1.21987262e-02]
 [-1.37922393e-02]
 [ 4.53239454e-03]
 [-1.06461276e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.56065058]
curr_Stock_Price:  99.83557302084547
curr_Factors:  [99.83557302]
mat_Sqrt:  [[0.15]]
grads:  [-0.08781905]
Stock Position:  -0.08781905057232693
Bond Position:  [6.20681466]


portfolio before change:  [-2.30547402]
curr_Stock_Price:  96.96521211389118
curr_Factors:  [96.96521211]
mat_Sqrt:  [[0.15]]
grads:  [-0.09596364]
Stock Position:  -0.09596363967885739
Bond Position:  [6.99966065]


portfolio before change:  [-2.16857241]
curr_Stock_Price:  95.57509279036351
curr_Factors:  [95.57509279]
mat_Sqrt:  [[0.15]]
grads:  [-0.16935593]
Stock Position:  -0.16935592501116317
Bond Position:  [14.01763584]


portfolio before change:  [-2.71275056]
curr_Stock_Price:  98.82971006734245
curr_Factors:  [98.82971007]
mat_Sqrt:  [[0.15]]
grads:  [0.06650633]
Stock Position:  0.06650632783356386
Bond Position:  [-9.28555165]


portfolio before change:  [-2.63982751]
curr_Stock_Price:  99.99601987073011
curr_Factors:  [99.99601987]
mat_Sqrt:  [[0.15]]
grads:  [0.0970591]
Stock Position:  0.09705910373772847
Bond Position:  [-12.34535158]


portfolio before change:  [-2.7092883]
curr_Stock_Price:  99.34397826050892
curr_Factors:  [99.34397826]
mat_Sqrt:  [[0.15]]
grads:  [0.08132484]
Stock Position:  0.08132484143586005
Bond Position:  [-10.78842158]


portfolio before change:  [-2.63172605]
curr_Stock_Price:  100.36405785017067
curr_Factors:  [100.36405785]
mat_Sqrt:  [[0.15]]
grads:  [-0.09194826]
Stock Position:  -0.09194826219937455
Bond Position:  [6.59657465]


portfolio before change:  [-2.5909906]
curr_Stock_Price:  99.95691214707747
curr_Factors:  [99.95691215]
mat_Sqrt:  [[0.15]]
grads:  [0.03021596]
Stock Position:  0.030215963606488427
Bond Position:  [-5.61128502]


portfolio before change:  [-2.54654501]
curr_Stock_Price:  101.52071923694099
curr_Factors:  [101.52071924]
mat_Sqrt:  [[0.15]]
grads:  [-0.00070974]
Stock Position:  -0.000709741840673175
Bond Position:  [-2.4744915]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.5454086]
Stock Price:  98.17588923003333
PL:  [-2.5454086]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 3.30443445]
 [-0.01303573]
 [-0.01479903]
 [-0.01612588]
 [ 0.00731191]
 [-0.03112612]
 [ 0.01328271]
 [-0.0151443 ]
 [ 0.00418269]
 [-0.00841192]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.2015]
curr_Stock_Price:  99.0801858426779
curr_Factors:  [99.08018584]
mat_Sqrt:  [[0.15]]
grads:  [-0.08690484]
Stock Position:  -0.08690483671290916
Bond Position:  [-10.59095262]


portfolio before change:  [-19.09953502]
curr_Stock_Price:  97.84594183102489
curr_Factors:  [97.84594183]
mat_Sqrt:  [[0.15]]
grads:  [-0.09866017]
Stock Position:  -0.09866016922181041
Bond Position:  [-9.44603784]


portfolio before change:  [-18.99150051]
curr_Stock_Price:  96.70304177721556
curr_Factors:  [96.70304178]
mat_Sqrt:  [[0.15]]
grads:  [-0.10750584]
Stock Position:  -0.10750583541999248
Bond Position:  [-8.59535921]


portfolio before change:  [-19.08131117]
curr_Stock_Price:  97.49845818493174
curr_Factors:  [97.49845818]
mat_Sqrt:  [[0.15]]
grads:  [0.04874607]
Stock Position:  0.04874607082562088
Bond Position:  [-23.83397792]


portfolio before change:  [-19.1090413]
curr_Stock_Price:  97.1741210080907
curr_Factors:  [97.17412101]
mat_Sqrt:  [[0.15]]
grads:  [-0.20750744]
Stock Position:  -0.2075074424860565
Bond Position:  [1.05531203]


portfolio before change:  [-18.97745505]
curr_Stock_Price:  96.54253662028474
curr_Factors:  [96.54253662]
mat_Sqrt:  [[0.15]]
grads:  [0.08855141]
Stock Position:  0.08855141440171198
Bond Position:  [-27.52643322]


portfolio before change:  [-18.84022135]
curr_Stock_Price:  98.24776473967597
curr_Factors:  [98.24776474]
mat_Sqrt:  [[0.15]]
grads:  [-0.10096202]
Stock Position:  -0.10096201843281614
Bond Position:  [-8.92092871]


portfolio before change:  [-18.82213244]
curr_Stock_Price:  98.0244085760446
curr_Factors:  [98.02440858]
mat_Sqrt:  [[0.15]]
grads:  [0.02788458]
Stock Position:  0.02788457636516801
Bond Position:  [-21.55550154]


portfolio before change:  [-18.8758089]
curr_Stock_Price:  96.48606639950877
curr_Factors:  [96.4860664]
mat_Sqrt:  [[0.15]]
grads:  [-0.05607947]
Stock Position:  -0.05607946929185382
Bond Position:  [-13.46492151]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.94056856]
Stock Price:  97.5207678766804
PL:  [-18.94056856]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 3.30443445]
 [-0.01299929]
 [-0.01456742]
 [-0.01030994]
 [ 0.01048222]
 [-0.02896229]
 [ 0.01197144]
 [-0.01363205]
 [ 0.00369068]
 [-0.0113111 ]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-27.78000569]
curr_Stock_Price:  98.69077704237787
curr_Factors:  [98.69077704]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-19.22727445]


portfolio before change:  [-27.66076221]
curr_Stock_Price:  97.20385478444655
curr_Factors:  [97.20385478]
mat_Sqrt:  [[0.15]]
grads:  [-0.09711616]
Stock Position:  -0.09711616283552077
Bond Position:  [-18.22069682]


portfolio before change:  [-27.68990813]
curr_Stock_Price:  97.41013654180074
curr_Factors:  [97.41013654]
mat_Sqrt:  [[0.15]]
grads:  [-0.06873292]
Stock Position:  -0.06873291656565984
Bond Position:  [-20.99462534]


portfolio before change:  [-27.81724102]
curr_Stock_Price:  99.10994742040464
curr_Factors:  [99.10994742]
mat_Sqrt:  [[0.15]]
grads:  [0.06988143]
Stock Position:  0.06988143442133157
Bond Position:  [-34.74318631]


portfolio before change:  [-27.93872441]
curr_Stock_Price:  97.620174805818
curr_Factors:  [97.62017481]
mat_Sqrt:  [[0.15]]
grads:  [-0.19308192]
Stock Position:  -0.19308191636280708
Bond Position:  [-9.09003398]


portfolio before change:  [-28.13530407]
curr_Stock_Price:  98.61474497606905
curr_Factors:  [98.61474498]
mat_Sqrt:  [[0.15]]
grads:  [0.07980957]
Stock Position:  0.07980956970949978
Bond Position:  [-36.00570444]


portfolio before change:  [-28.31949277]
curr_Stock_Price:  96.53252166744554
curr_Factors:  [96.53252167]
mat_Sqrt:  [[0.15]]
grads:  [-0.09088036]
Stock Position:  -0.09088035897816779
Bond Position:  [-19.54658255]


portfolio before change:  [-28.3967017]
curr_Stock_Price:  97.27452131086464
curr_Factors:  [97.27452131]
mat_Sqrt:  [[0.15]]
grads:  [0.02460456]
Stock Position:  0.024604564358446386
Bond Position:  [-30.79009892]


portfolio before change:  [-28.45384421]
curr_Stock_Price:  95.57794157570943
curr_Factors:  [95.57794158]
mat_Sqrt:  [[0.15]]
grads:  [-0.0754073]
Stock Position:  -0.07540730419272507
Bond Position:  [-21.24656929]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-28.51554148]
Stock Price:  96.25521456668251
PL:  [-28.51554148]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.53095010e-02]
 [-6.84981968e-03]
 [-1.89133897e-02]
 [ 5.21658543e-03]
 [ 1.35679882e-02]
 [ 9.22694894e-03]
 [-1.29616145e-02]
 [ 2.11285344e-03]
 [-6.21234816e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [40.50621916]
curr_Stock_Price:  101.79053099068254
curr_Factors:  [101.79053099]
mat_Sqrt:  [[0.15]]
grads:  [-0.10206334]
Stock Position:  -0.10206333986186351
Bond Position:  [50.89530072]


portfolio before change:  [40.37540381]
curr_Stock_Price:  103.32163272570202
curr_Factors:  [103.32163273]
mat_Sqrt:  [[0.15]]
grads:  [-0.04566546]
Stock Position:  -0.04566546450655789
Bond Position:  [45.09363416]


portfolio before change:  [40.38388193]
curr_Stock_Price:  103.62983799798091
curr_Factors:  [103.629838]
mat_Sqrt:  [[0.15]]
grads:  [-0.12608926]
Stock Position:  -0.12608926435892173
Bond Position:  [53.45049197]


portfolio before change:  [40.66060353]
curr_Stock_Price:  101.64719759536776
curr_Factors:  [101.6471976]
mat_Sqrt:  [[0.15]]
grads:  [0.03477724]
Stock Position:  0.034777236221539026
Bond Position:  [37.12559493]


portfolio before change:  [40.72307364]
curr_Stock_Price:  102.90959435039544
curr_Factors:  [102.90959435]
mat_Sqrt:  [[0.15]]
grads:  [0.09045325]
Stock Position:  0.09045325450026086
Bond Position:  [31.41456591]


portfolio before change:  [40.64230972]
curr_Stock_Price:  101.84301987041685
curr_Factors:  [101.84301987]
mat_Sqrt:  [[0.15]]
grads:  [0.06151299]
Stock Position:  0.06151299293864757
Bond Position:  [34.37764075]


portfolio before change:  [40.58321593]
curr_Stock_Price:  100.602844493124
curr_Factors:  [100.60284449]
mat_Sqrt:  [[0.15]]
grads:  [-0.08641076]
Stock Position:  -0.08641076326700639
Bond Position:  [49.27638451]


portfolio before change:  [40.44042059]
curr_Stock_Price:  102.54056260327847
curr_Factors:  [102.5405626]
mat_Sqrt:  [[0.15]]
grads:  [0.01408569]
Stock Position:  0.01408568958019521
Bond Position:  [38.99606605]


portfolio before change:  [40.40900059]
curr_Stock_Price:  98.92533967953088
curr_Factors:  [98.92533968]
mat_Sqrt:  [[0.15]]
grads:  [-0.00414157]
Stock Position:  -0.004141565439579213
Bond Position:  [40.81870635]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [40.43298783]
Stock Price:  98.06267414558641
PL:  [40.43298783]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.29992865e-02]
 [-1.47698334e-02]
 [-2.13124834e-02]
 [ 9.31427198e-03]
 [-3.41887505e-02]
 [ 1.22885291e-02]
 [-1.40629812e-02]
 [ 2.00956798e-03]
 [-1.61359955e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-25.76118054]
curr_Stock_Price:  98.78241867619138
curr_Factors:  [98.78241868]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-17.20050747]


portfolio before change:  [-25.70582787]
curr_Stock_Price:  98.04443492881421
curr_Factors:  [98.04443493]
mat_Sqrt:  [[0.15]]
grads:  [-0.09846556]
Stock Position:  -0.09846555583221275
Bond Position:  [-16.05182809]


portfolio before change:  [-25.5196842]
curr_Stock_Price:  96.07246017327107
curr_Factors:  [96.07246017]
mat_Sqrt:  [[0.15]]
grads:  [-0.14208322]
Stock Position:  -0.1420832224766175
Bond Position:  [-11.86939947]


portfolio before change:  [-25.86533946]
curr_Stock_Price:  98.46344674051493
curr_Factors:  [98.46344674]
mat_Sqrt:  [[0.15]]
grads:  [0.06209515]
Stock Position:  0.062095146548394486
Bond Position:  [-31.97944161]


portfolio before change:  [-26.005536]
curr_Stock_Price:  96.4632448774836
curr_Factors:  [96.46324488]
mat_Sqrt:  [[0.15]]
grads:  [-0.227925]
Stock Position:  -0.22792500357516618
Bond Position:  [-4.01915057]


portfolio before change:  [-26.42252703]
curr_Stock_Price:  98.28393562510048
curr_Factors:  [98.28393563]
mat_Sqrt:  [[0.15]]
grads:  [0.08192353]
Stock Position:  0.08192352739123383
Bond Position:  [-34.47429372]


portfolio before change:  [-26.54489302]
curr_Stock_Price:  97.00073234475873
curr_Factors:  [97.00073234]
mat_Sqrt:  [[0.15]]
grads:  [-0.09375321]
Stock Position:  -0.09375320790305885
Bond Position:  [-17.4507632]


portfolio before change:  [-26.38758909]
curr_Stock_Price:  95.22979028705296
curr_Factors:  [95.22979029]
mat_Sqrt:  [[0.15]]
grads:  [0.01339712]
Stock Position:  0.013397119877493827
Bond Position:  [-27.663394]


portfolio before change:  [-26.4192067]
curr_Stock_Price:  93.90245624099003
curr_Factors:  [93.90245624]
mat_Sqrt:  [[0.15]]
grads:  [-0.1075733]
Stock Position:  -0.10757330360788483
Bond Position:  [-16.31780926]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-26.48668241]
Stock Price:  94.45384555973364
PL:  [-26.48668241]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.38972247e-02]
 [-1.28788473e-02]
 [ 5.23583256e-07]
 [ 1.12442142e-02]
 [-1.26873449e-02]
 [ 1.16351049e-02]
 [-1.44124462e-02]
 [ 3.66301571e-03]
 [-1.45779091e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.46370894]
curr_Stock_Price:  100.78994326994373
curr_Factors:  [100.78994327]
mat_Sqrt:  [[0.15]]
grads:  [-0.09264816]
Stock Position:  -0.09264816452541266
Bond Position:  [27.80171219]


portfolio before change:  [18.56852777]
curr_Stock_Price:  99.80865567711578
curr_Factors:  [99.80865568]
mat_Sqrt:  [[0.15]]
grads:  [-0.08585898]
Stock Position:  -0.08585898213344571
Bond Position:  [27.13799735]


portfolio before change:  [18.68040746]
curr_Stock_Price:  98.66367006590917
curr_Factors:  [98.66367007]
mat_Sqrt:  [[0.15]]
grads:  [3.49055504e-06]
Stock Position:  3.4905550387367055e-06
Bond Position:  [18.68006307]


portfolio before change:  [18.68975285]
curr_Stock_Price:  99.53174268458577
curr_Factors:  [99.53174268]
mat_Sqrt:  [[0.15]]
grads:  [0.07496143]
Stock Position:  0.0749614280741087
Bond Position:  [11.22871128]


portfolio before change:  [18.65557946]
curr_Stock_Price:  99.00094763087453
curr_Factors:  [99.00094763]
mat_Sqrt:  [[0.15]]
grads:  [-0.0845823]
Stock Position:  -0.0845822990036171
Bond Position:  [27.02930721]


portfolio before change:  [18.50857947]
curr_Stock_Price:  100.89872088354389
curr_Factors:  [100.89872088]
mat_Sqrt:  [[0.15]]
grads:  [0.07756737]
Stock Position:  0.07756736586270649
Bond Position:  [10.68213147]


portfolio before change:  [18.43784748]
curr_Stock_Price:  99.91796836358225
curr_Factors:  [99.91796836]
mat_Sqrt:  [[0.15]]
grads:  [-0.09608297]
Stock Position:  -0.09608297492624539
Bond Position:  [28.03826313]


portfolio before change:  [18.70967395]
curr_Stock_Price:  97.23483083213061
curr_Factors:  [97.23483083]
mat_Sqrt:  [[0.15]]
grads:  [0.0244201]
Stock Position:  0.024420104756118683
Bond Position:  [16.3351892]


portfolio before change:  [18.76324273]
curr_Stock_Price:  99.09391958891062
curr_Factors:  [99.09391959]
mat_Sqrt:  [[0.15]]
grads:  [-0.00097186]
Stock Position:  -0.000971860607300665
Bond Position:  [18.85954821]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.77289434]
Stock Price:  98.86808452889169
PL:  [18.77289434]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.63989656e-02]
 [-6.83644839e-03]
 [-4.96958542e-02]
 [ 5.53344995e-03]
 [ 3.82169857e-02]
 [ 6.67822630e-03]
 [-5.97933400e-03]
 [-1.49783614e-03]
 [ 4.00181075e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [58.84754151]
curr_Stock_Price:  102.62310866673772
curr_Factors:  [102.62310867]
mat_Sqrt:  [[0.15]]
grads:  [-0.10932644]
Stock Position:  -0.10932643720821858
Bond Position:  [70.06696036]


portfolio before change:  [58.80422818]
curr_Stock_Price:  103.33982072715418
curr_Factors:  [103.33982073]
mat_Sqrt:  [[0.15]]
grads:  [-0.04557632]
Stock Position:  -0.04557632260223495
Bond Position:  [63.51407718]


portfolio before change:  [58.77765467]
curr_Stock_Price:  104.61983803158441
curr_Factors:  [104.61983803]
mat_Sqrt:  [[0.15]]
grads:  [-0.33130569]
Stock Position:  -0.33130569445018987
Bond Position:  [93.43880277]


portfolio before change:  [58.55215005]
curr_Stock_Price:  105.44154352311627
curr_Factors:  [105.44154352]
mat_Sqrt:  [[0.15]]
grads:  [0.03688967]
Stock Position:  0.03688966634505085
Bond Position:  [54.66244669]


portfolio before change:  [58.54104275]
curr_Stock_Price:  104.39937217255407
curr_Factors:  [104.39937217]
mat_Sqrt:  [[0.15]]
grads:  [0.2547799]
Stock Position:  0.25477990444735127
Bond Position:  [31.94218069]


portfolio before change:  [58.16222855]
curr_Stock_Price:  102.84984145541735
curr_Factors:  [102.84984146]
mat_Sqrt:  [[0.15]]
grads:  [0.04452151]
Stock Position:  0.04452150864771218
Bond Position:  [53.58319844]


portfolio before change:  [58.29579786]
curr_Stock_Price:  105.24803086018308
curr_Factors:  [105.24803086]
mat_Sqrt:  [[0.15]]
grads:  [-0.03986223]
Stock Position:  -0.03986222669208966
Bond Position:  [62.49121872]


portfolio before change:  [58.25913489]
curr_Stock_Price:  106.95180884731508
curr_Factors:  [106.95180885]
mat_Sqrt:  [[0.15]]
grads:  [-0.00998557]
Stock Position:  -0.009985574262007453
Bond Position:  [59.32711012]


portfolio before change:  [58.33109182]
curr_Stock_Price:  102.71710496470062
curr_Factors:  [102.71710496]
mat_Sqrt:  [[0.15]]
grads:  [0.00266787]
Stock Position:  0.0026678738309109584
Bond Position:  [58.05705554]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [58.35791997]
Stock Price:  101.88961736171257
PL:  [56.46830261]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.32302190e-02]
 [-1.40626110e-02]
 [ 4.28669602e-03]
 [ 1.19032180e-02]
 [ 9.86173337e-04]
 [ 1.22756361e-02]
 [-1.51470355e-02]
 [ 3.44448215e-03]
 [ 2.79424445e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.54737382]
curr_Stock_Price:  99.92696279346973
curr_Factors:  [99.92696279]
mat_Sqrt:  [[0.15]]
grads:  [-0.08820146]
Stock Position:  -0.08820146001493254
Bond Position:  [8.26633019]


portfolio before change:  [-0.43816204]
curr_Stock_Price:  98.7356266689548
curr_Factors:  [98.73562667]
mat_Sqrt:  [[0.15]]
grads:  [-0.09375074]
Stock Position:  -0.09375074027255816
Bond Position:  [8.81837605]


portfolio before change:  [-0.49868033]
curr_Stock_Price:  99.42819275703769
curr_Factors:  [99.42819276]
mat_Sqrt:  [[0.15]]
grads:  [0.02857797]
Stock Position:  0.028577973443634754
Bond Position:  [-3.34013658]


portfolio before change:  [-0.48542256]
curr_Stock_Price:  99.95056226792859
curr_Factors:  [99.95056227]
mat_Sqrt:  [[0.15]]
grads:  [0.07935479]
Stock Position:  0.07935478659539681
Bond Position:  [-8.41697809]


portfolio before change:  [-0.53248904]
curr_Stock_Price:  99.4104947778291
curr_Factors:  [99.41049478]
mat_Sqrt:  [[0.15]]
grads:  [0.00657449]
Stock Position:  0.006574488913970815
Bond Position:  [-1.18606223]


portfolio before change:  [-0.54043491]
curr_Stock_Price:  98.29212758486246
curr_Factors:  [98.29212758]
mat_Sqrt:  [[0.15]]
grads:  [0.08183757]
Stock Position:  0.08183757376193236
Bond Position:  [-8.58442415]


portfolio before change:  [-0.54765976]
curr_Stock_Price:  98.25630587936618
curr_Factors:  [98.25630588]
mat_Sqrt:  [[0.15]]
grads:  [-0.10098024]
Stock Position:  -0.10098023672791742
Bond Position:  [9.37428527]


portfolio before change:  [-0.40816721]
curr_Stock_Price:  96.92134930660193
curr_Factors:  [96.92134931]
mat_Sqrt:  [[0.15]]
grads:  [0.02296321]
Stock Position:  0.022963214353672382
Bond Position:  [-2.63379293]


portfolio before change:  [-0.34287646]
curr_Stock_Price:  99.82198739644235
curr_Factors:  [99.8219874]
mat_Sqrt:  [[0.15]]
grads:  [0.00186283]
Stock Position:  0.0018628296313824002
Bond Position:  [-0.52882782]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.34095778]
Stock Price:  100.99394719093591
PL:  [-1.33490497]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.31008028e-02]
 [-1.32902552e-02]
 [ 3.37077853e-03]
 [ 8.77945135e-03]
 [-3.60902166e-02]
 [ 1.38851908e-02]
 [-1.39606895e-02]
 [ 2.87303991e-03]
 [-1.26665794e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.44414845]
curr_Stock_Price:  99.75007437156201
curr_Factors:  [99.75007437]
mat_Sqrt:  [[0.15]]
grads:  [-0.08733869]
Stock Position:  -0.08733868532827803
Bond Position:  [4.2678919]


portfolio before change:  [-4.40963794]
curr_Stock_Price:  99.37937911921638
curr_Factors:  [99.37937912]
mat_Sqrt:  [[0.15]]
grads:  [-0.0886017]
Stock Position:  -0.08860170107624854
Bond Position:  [4.3955441]


portfolio before change:  [-4.39717922]
curr_Stock_Price:  99.26357545690944
curr_Factors:  [99.26357546]
mat_Sqrt:  [[0.15]]
grads:  [0.02247186]
Stock Position:  0.022471856837271917
Bond Position:  [-6.62781607]


portfolio before change:  [-4.42820803]
curr_Stock_Price:  98.0302960247761
curr_Factors:  [98.03029602]
mat_Sqrt:  [[0.15]]
grads:  [0.05852968]
Stock Position:  0.05852967563475966
Bond Position:  [-10.16588946]


portfolio before change:  [-4.55219306]
curr_Stock_Price:  95.99883401007739
curr_Factors:  [95.99883401]
mat_Sqrt:  [[0.15]]
grads:  [-0.24060144]
Stock Position:  -0.2406014438472091
Bond Position:  [18.54526501]


portfolio before change:  [-4.50682937]
curr_Stock_Price:  95.84884015933797
curr_Factors:  [95.84884016]
mat_Sqrt:  [[0.15]]
grads:  [0.09256794]
Stock Position:  0.09256793898169603
Bond Position:  [-13.37935896]


portfolio before change:  [-4.41718061]
curr_Stock_Price:  96.88959053978067
curr_Factors:  [96.88959054]
mat_Sqrt:  [[0.15]]
grads:  [-0.09307126]
Stock Position:  -0.09307126357668434
Bond Position:  [4.60045601]


portfolio before change:  [-4.34903891]
curr_Stock_Price:  96.18216603682339
curr_Factors:  [96.18216604]
mat_Sqrt:  [[0.15]]
grads:  [0.0191536]
Stock Position:  0.01915359942521077
Bond Position:  [-6.19127359]


portfolio before change:  [-4.37184074]
curr_Stock_Price:  95.1533558319544
curr_Factors:  [95.15335583]
mat_Sqrt:  [[0.15]]
grads:  [-0.08444386]
Stock Position:  -0.08444386275989188
Bond Position:  [3.66327618]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.35111539]
Stock Price:  94.92961841185468
PL:  [-4.35111539]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.29992865e-02]
 [-1.40333012e-02]
 [-1.30308228e-02]
 [ 5.76889012e-03]
 [-3.56361019e-02]
 [ 1.33570032e-02]
 [-1.45349954e-02]
 [ 2.30721455e-03]
 [-4.43684824e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-22.73054968]
curr_Stock_Price:  98.91998976018373
curr_Factors:  [98.91998976]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-14.15795444]


portfolio before change:  [-22.52831207]
curr_Stock_Price:  96.50464528839365
curr_Factors:  [96.50464529]
mat_Sqrt:  [[0.15]]
grads:  [-0.09355534]
Stock Position:  -0.09355534109607244
Bond Position:  [-13.49978706]


portfolio before change:  [-22.5888289]
curr_Stock_Price:  97.07933455720887
curr_Factors:  [97.07933456]
mat_Sqrt:  [[0.15]]
grads:  [-0.08687215]
Stock Position:  -0.0868721521360964
Bond Position:  [-14.15533818]


portfolio before change:  [-22.59550515]
curr_Stock_Price:  97.07469343323315
curr_Factors:  [97.07469343]
mat_Sqrt:  [[0.15]]
grads:  [0.03845927]
Stock Position:  0.03845926745948547
Bond Position:  [-26.32892675]


portfolio before change:  [-22.64578407]
curr_Stock_Price:  96.10974622189288
curr_Factors:  [96.10974622]
mat_Sqrt:  [[0.15]]
grads:  [-0.23757401]
Stock Position:  -0.23757401247728513
Bond Position:  [0.18739398]


portfolio before change:  [-22.72818825]
curr_Stock_Price:  96.4569975802917
curr_Factors:  [96.45699758]
mat_Sqrt:  [[0.15]]
grads:  [0.08904669]
Stock Position:  0.08904668816483793
Bond Position:  [-31.31736443]


portfolio before change:  [-22.9273669]
curr_Stock_Price:  94.39610052909751
curr_Factors:  [94.39610053]
mat_Sqrt:  [[0.15]]
grads:  [-0.09689997]
Stock Position:  -0.09689996912356674
Bond Position:  [-13.78038768]


portfolio before change:  [-23.04685487]
curr_Stock_Price:  95.55808280841904
curr_Factors:  [95.55808281]
mat_Sqrt:  [[0.15]]
grads:  [0.01538143]
Stock Position:  0.015381430361426033
Bond Position:  [-24.51667486]


portfolio before change:  [-23.02559123]
curr_Stock_Price:  97.73766166045657
curr_Factors:  [97.73766166]
mat_Sqrt:  [[0.15]]
grads:  [-0.02957899]
Stock Position:  -0.02957898824405198
Bond Position:  [-20.13461008]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-22.99677039]
Stock Price:  96.4228546769576
PL:  [-22.99677039]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.37791861e-02]
 [-1.38890648e-02]
 [-2.14097067e-02]
 [ 7.06480962e-03]
 [-4.02320126e-02]
 [ 1.51000482e-02]
 [-1.42523716e-02]
 [ 5.59055356e-04]
 [-1.24681087e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.60514613]
curr_Stock_Price:  100.7055765119682
curr_Factors:  [100.70557651]
mat_Sqrt:  [[0.15]]
grads:  [-0.09186124]
Stock Position:  -0.09186124086838997
Bond Position:  [25.85608535]


portfolio before change:  [16.78507696]
curr_Stock_Price:  98.88762202500453
curr_Factors:  [98.88762203]
mat_Sqrt:  [[0.15]]
grads:  [-0.09259377]
Stock Position:  -0.09259376550942308
Bond Position:  [25.94145425]


portfolio before change:  [17.05981185]
curr_Stock_Price:  96.06063987157297
curr_Factors:  [96.06063987]
mat_Sqrt:  [[0.15]]
grads:  [-0.14273138]
Stock Position:  -0.1427313783130459
Bond Position:  [30.77067938]


portfolio before change:  [17.35038403]
curr_Stock_Price:  94.13266166420928
curr_Factors:  [94.13266166]
mat_Sqrt:  [[0.15]]
grads:  [0.04709873]
Stock Position:  0.04709873076876754
Bond Position:  [12.91685514]


portfolio before change:  [17.39709403]
curr_Stock_Price:  94.98724870670128
curr_Factors:  [94.98724871]
mat_Sqrt:  [[0.15]]
grads:  [-0.26821342]
Stock Position:  -0.2682134175935251
Bond Position:  [42.87394864]


portfolio before change:  [17.62351365]
curr_Stock_Price:  94.22301667893065
curr_Factors:  [94.22301668]
mat_Sqrt:  [[0.15]]
grads:  [0.10066699]
Stock Position:  0.10066698769262057
Bond Position:  [8.13836639]


portfolio before change:  [17.68075026]
curr_Stock_Price:  94.75115814108212
curr_Factors:  [94.75115814]
mat_Sqrt:  [[0.15]]
grads:  [-0.09501581]
Stock Position:  -0.09501581041566522
Bond Position:  [26.68360834]


portfolio before change:  [17.80062965]
curr_Stock_Price:  93.62993162611762
curr_Factors:  [93.62993163]
mat_Sqrt:  [[0.15]]
grads:  [0.00372704]
Stock Position:  0.003727035708370495
Bond Position:  [17.45166755]


portfolio before change:  [17.81526722]
curr_Stock_Price:  95.21552393119939
curr_Factors:  [95.21552393]
mat_Sqrt:  [[0.15]]
grads:  [-0.08312072]
Stock Position:  -0.08312072443483093
Bond Position:  [25.72965055]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.75703066]
Stock Price:  96.07096165877275
PL:  [17.75703066]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.52612599e-02]
 [-1.41637746e-02]
 [ 2.19964034e-02]
 [ 6.13092402e-03]
 [ 3.23765946e-02]
 [ 2.10038960e-03]
 [-5.94110553e-03]
 [-4.53920202e-04]
 [ 1.38325643e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [39.75371396]
curr_Stock_Price:  101.75637211094089
curr_Factors:  [101.75637211]
mat_Sqrt:  [[0.15]]
grads:  [-0.10174173]
Stock Position:  -0.10174173268801506
Bond Position:  [50.10658357]


portfolio before change:  [40.09512383]
curr_Stock_Price:  98.64702556066662
curr_Factors:  [98.64702556]
mat_Sqrt:  [[0.15]]
grads:  [-0.09442516]
Stock Position:  -0.09442516381377222
Bond Position:  [49.40988537]


portfolio before change:  [39.88343175]
curr_Stock_Price:  101.15062929886004
curr_Factors:  [101.1506293]
mat_Sqrt:  [[0.15]]
grads:  [0.14664269]
Stock Position:  0.14664268928605947
Bond Position:  [25.05043145]


portfolio before change:  [39.93095052]
curr_Stock_Price:  101.38923933296378
curr_Factors:  [101.38923933]
mat_Sqrt:  [[0.15]]
grads:  [0.04087283]
Stock Position:  0.040872826783404176
Bond Position:  [35.7868857]


portfolio before change:  [40.05745331]
curr_Stock_Price:  104.04638073566964
curr_Factors:  [104.04638074]
mat_Sqrt:  [[0.15]]
grads:  [0.21584396]
Stock Position:  0.21584396418803212
Bond Position:  [17.59967004]


portfolio before change:  [40.19418609]
curr_Stock_Price:  104.6390808602169
curr_Factors:  [104.63908086]
mat_Sqrt:  [[0.15]]
grads:  [0.0140026]
Stock Position:  0.014002597315191535
Bond Position:  [38.72896718]


portfolio before change:  [40.2101673]
curr_Stock_Price:  104.39711708571134
curr_Factors:  [104.39711709]
mat_Sqrt:  [[0.15]]
grads:  [-0.03960737]
Stock Position:  -0.03960737022665079
Bond Position:  [44.34506256]


portfolio before change:  [40.20010372]
curr_Stock_Price:  105.21114872641017
curr_Factors:  [105.21114873]
mat_Sqrt:  [[0.15]]
grads:  [-0.00302613]
Stock Position:  -0.0030261346819915646
Bond Position:  [40.51848683]


portfolio before change:  [40.22398376]
curr_Stock_Price:  104.01631329521598
curr_Factors:  [104.0163133]
mat_Sqrt:  [[0.15]]
grads:  [0.00922171]
Stock Position:  0.009221709556909515
Bond Position:  [39.26477553]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [40.23884947]
Stock Price:  103.49888303555247
PL:  [36.73996643]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.52139952e-02]
 [-1.11809444e-02]
 [ 1.85143056e-02]
 [ 5.23337582e-03]
 [ 5.59180403e-02]
 [ 3.79053976e-03]
 [-6.00387214e-03]
 [-4.28954761e-04]
 [ 2.89247661e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [39.01643884]
curr_Stock_Price:  101.72290457828514
curr_Factors:  [101.72290458]
mat_Sqrt:  [[0.15]]
grads:  [-0.10142663]
Stock Position:  -0.10142663457371802
Bond Position:  [49.33385072]


portfolio before change:  [39.1217788]
curr_Stock_Price:  100.9275822695704
curr_Factors:  [100.92758227]
mat_Sqrt:  [[0.15]]
grads:  [-0.07453963]
Stock Position:  -0.07453962931031961
Bond Position:  [46.64488337]


portfolio before change:  [39.06607657]
curr_Stock_Price:  101.98783043268158
curr_Factors:  [101.98783043]
mat_Sqrt:  [[0.15]]
grads:  [0.1234287]
Stock Position:  0.12342870368900655
Bond Position:  [26.47785087]


portfolio before change:  [39.36245983]
curr_Stock_Price:  104.28179461830325
curr_Factors:  [104.28179462]
mat_Sqrt:  [[0.15]]
grads:  [0.03488917]
Stock Position:  0.03488917214700487
Bond Position:  [35.72415435]


portfolio before change:  [39.42175461]
curr_Stock_Price:  105.46921846761255
curr_Factors:  [105.46921847]
mat_Sqrt:  [[0.15]]
grads:  [0.37278694]
Stock Position:  0.3727869354357252
Bond Position:  [0.10420788]


portfolio before change:  [38.8587243]
curr_Stock_Price:  103.9587512944876
curr_Factors:  [103.95875129]
mat_Sqrt:  [[0.15]]
grads:  [0.02527027]
Stock Position:  0.025270265072451625
Bond Position:  [36.2316591]


portfolio before change:  [38.92322735]
curr_Stock_Price:  105.79421639176643
curr_Factors:  [105.79421639]
mat_Sqrt:  [[0.15]]
grads:  [-0.04002581]
Stock Position:  -0.04002581425904323
Bond Position:  [43.157727]


portfolio before change:  [38.96926961]
curr_Stock_Price:  105.18316079719753
curr_Factors:  [105.1831608]
mat_Sqrt:  [[0.15]]
grads:  [-0.0028597]
Stock Position:  -0.0028596984095803695
Bond Position:  [39.27006172]


portfolio before change:  [38.98398521]
curr_Stock_Price:  106.90513684412967
curr_Factors:  [106.90513684]
mat_Sqrt:  [[0.15]]
grads:  [0.01928318]
Stock Position:  0.019283177420877547
Bond Position:  [36.92251449]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [38.96904362]
Stock Price:  105.17266999385139
PL:  [33.79637363]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 3.30443445]
 [-0.01299929]
 [-0.01450041]
 [-0.01011439]
 [ 0.00963848]
 [-0.02876993]
 [ 0.01208093]
 [-0.01556015]
 [ 0.00418431]
 [-0.00950259]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.27590673]
curr_Stock_Price:  99.48535017905432
curr_Factors:  [99.48535018]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-1.65431626]


portfolio before change:  [-10.17853222]
curr_Stock_Price:  98.35218948680202
curr_Factors:  [98.35218949]
mat_Sqrt:  [[0.15]]
grads:  [-0.09666943]
Stock Position:  -0.09666942907021565
Bond Position:  [-0.67088222]


portfolio before change:  [-10.09009833]
curr_Stock_Price:  97.43391145964772
curr_Factors:  [97.43391146]
mat_Sqrt:  [[0.15]]
grads:  [-0.06742924]
Stock Position:  -0.06742923987815067
Bond Position:  [-3.52020375]


portfolio before change:  [-10.17338062]
curr_Stock_Price:  98.64290832483391
curr_Factors:  [98.64290832]
mat_Sqrt:  [[0.15]]
grads:  [0.06425654]
Stock Position:  0.0642565357025085
Bond Position:  [-16.51183218]


portfolio before change:  [-10.24480797]
curr_Stock_Price:  97.65982746872633
curr_Factors:  [97.65982747]
mat_Sqrt:  [[0.15]]
grads:  [-0.19179954]
Stock Position:  -0.19179953623835724
Bond Position:  [8.48630165]


portfolio before change:  [-10.39029748]
curr_Stock_Price:  98.44050568535526
curr_Factors:  [98.44050569]
mat_Sqrt:  [[0.15]]
grads:  [0.08053954]
Stock Position:  0.08053954150605522
Bond Position:  [-18.31865067]


portfolio before change:  [-10.33268923]
curr_Stock_Price:  99.26953770627294
curr_Factors:  [99.26953771]
mat_Sqrt:  [[0.15]]
grads:  [-0.10373434]
Stock Position:  -0.10373433682053934
Bond Position:  [-0.03502957]


portfolio before change:  [-10.20381191]
curr_Stock_Price:  98.02699023531736
curr_Factors:  [98.02699024]
mat_Sqrt:  [[0.15]]
grads:  [0.02789542]
Stock Position:  0.027895417261381405
Bond Position:  [-12.93831571]


portfolio before change:  [-10.26279748]
curr_Stock_Price:  96.14443051892415
curr_Factors:  [96.14443052]
mat_Sqrt:  [[0.15]]
grads:  [-0.06335059]
Stock Position:  -0.06335058634878873
Bond Position:  [-4.17199143]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.15736351]
Stock Price:  94.4472009650851
PL:  [-10.15736351]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.29992865e-02]
 [-1.28869958e-02]
 [ 1.85555164e-02]
 [ 1.00728978e-02]
 [ 1.10020389e-02]
 [ 1.36011652e-02]
 [-9.79096174e-03]
 [ 3.39167922e-03]
 [ 3.83462880e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-24.18323074]
curr_Stock_Price:  98.85404741453672
curr_Factors:  [98.85404741]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-15.61635018]


portfolio before change:  [-24.25931645]
curr_Stock_Price:  99.6418858103466
curr_Factors:  [99.64188581]
mat_Sqrt:  [[0.15]]
grads:  [-0.08591331]
Stock Position:  -0.08591330507310836
Bond Position:  [-15.69875272]


portfolio before change:  [-24.37634992]
curr_Stock_Price:  100.91272661387497
curr_Factors:  [100.91272661]
mat_Sqrt:  [[0.15]]
grads:  [0.12370344]
Stock Position:  0.12370344240509618
Bond Position:  [-36.85960159]


portfolio before change:  [-24.43877923]
curr_Stock_Price:  100.55707848537878
curr_Factors:  [100.55707849]
mat_Sqrt:  [[0.15]]
grads:  [0.06715265]
Stock Position:  0.06715265198766639
Bond Position:  [-31.19145373]


portfolio before change:  [-24.42169748]
curr_Stock_Price:  101.04375130637825
curr_Factors:  [101.04375131]
mat_Sqrt:  [[0.15]]
grads:  [0.07334693]
Stock Position:  0.07334692571233682
Bond Position:  [-31.83294601]


portfolio before change:  [-24.50765281]
curr_Stock_Price:  100.0889072744969
curr_Factors:  [100.08890727]
mat_Sqrt:  [[0.15]]
grads:  [0.09067443]
Stock Position:  0.09067443470046142
Bond Position:  [-33.5831579]


portfolio before change:  [-24.3687643]
curr_Stock_Price:  101.80586625605997
curr_Factors:  [101.80586626]
mat_Sqrt:  [[0.15]]
grads:  [-0.06527308]
Stock Position:  -0.0652730782791368
Bond Position:  [-17.72358203]


portfolio before change:  [-24.35974042]
curr_Stock_Price:  101.53181921112393
curr_Factors:  [101.53181921]
mat_Sqrt:  [[0.15]]
grads:  [0.02261119]
Stock Position:  0.022611194797694974
Bond Position:  [-26.65549616]


portfolio before change:  [-24.39672779]
curr_Stock_Price:  100.4855986906898
curr_Factors:  [100.48559869]
mat_Sqrt:  [[0.15]]
grads:  [0.00255642]
Stock Position:  0.002556419197021484
Bond Position:  [-24.65361111]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-24.41093636]
Stock Price:  99.75071108674464
PL:  [-24.41093636]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30087537e-02]
 [-1.35457433e-02]
 [ 2.52194270e-03]
 [ 1.19211731e-02]
 [ 1.32158797e-02]
 [ 1.18512725e-02]
 [-1.36504708e-02]
 [ 1.63377051e-03]
 [-1.41442857e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.21598354]
curr_Stock_Price:  98.98874128935296
curr_Factors:  [98.98874129]
mat_Sqrt:  [[0.15]]
grads:  [-0.08672502]
Stock Position:  -0.08672502436815088
Bond Position:  [-12.63118254]


portfolio before change:  [-21.32260587]
curr_Stock_Price:  100.14532974203946
curr_Factors:  [100.14532974]
mat_Sqrt:  [[0.15]]
grads:  [-0.09030496]
Stock Position:  -0.09030495559487178
Bond Position:  [-12.27898632]


portfolio before change:  [-21.23397279]
curr_Stock_Price:  99.09584009632442
curr_Factors:  [99.0958401]
mat_Sqrt:  [[0.15]]
grads:  [0.01681295]
Stock Position:  0.016812951358514915
Bond Position:  [-22.90006633]


portfolio before change:  [-21.22705042]
curr_Stock_Price:  100.18876339230519
curr_Factors:  [100.18876339]
mat_Sqrt:  [[0.15]]
grads:  [0.07947449]
Stock Position:  0.0794744870205703
Bond Position:  [-29.18950099]


portfolio before change:  [-21.20319163]
curr_Stock_Price:  100.67265689905513
curr_Factors:  [100.6726569]
mat_Sqrt:  [[0.15]]
grads:  [0.08810586]
Stock Position:  0.08810586446698028
Bond Position:  [-30.07304309]


portfolio before change:  [-21.35453569]
curr_Stock_Price:  99.12561141162227
curr_Factors:  [99.12561141]
mat_Sqrt:  [[0.15]]
grads:  [0.07900848]
Stock Position:  0.07900848319215674
Bond Position:  [-29.18629989]


portfolio before change:  [-21.57242759]
curr_Stock_Price:  96.55253203945651
curr_Factors:  [96.55253204]
mat_Sqrt:  [[0.15]]
grads:  [-0.09100314]
Stock Position:  -0.09100313869786197
Bond Position:  [-12.78584412]


portfolio before change:  [-21.42072857]
curr_Stock_Price:  94.81530038017856
curr_Factors:  [94.81530038]
mat_Sqrt:  [[0.15]]
grads:  [0.0108918]
Stock Position:  0.01089180338635813
Bond Position:  [-22.45343818]


portfolio before change:  [-21.43402451]
curr_Stock_Price:  94.62557875981693
curr_Factors:  [94.62557876]
mat_Sqrt:  [[0.15]]
grads:  [-0.09429524]
Stock Position:  -0.0942952376819175
Bond Position:  [-12.51128307]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.45930649]
Stock Price:  94.82733629259884
PL:  [-21.45930649]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.46567464e-02]
 [-1.31675959e-02]
 [ 9.24861119e-03]
 [ 1.09627749e-02]
 [-3.55456495e-02]
 [ 1.49843992e-02]
 [-1.40819277e-02]
 [-4.60590720e-04]
 [-1.74287344e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [30.32400019]
curr_Stock_Price:  101.32832395696161
curr_Factors:  [101.32832396]
mat_Sqrt:  [[0.15]]
grads:  [-0.09771164]
Stock Position:  -0.09771164276371191
Bond Position:  [40.22495719]


portfolio before change:  [30.47586625]
curr_Stock_Price:  99.97998366957682
curr_Factors:  [99.97998367]
mat_Sqrt:  [[0.15]]
grads:  [-0.08778397]
Stock Position:  -0.0877839724882503
Bond Position:  [39.25250638]


portfolio before change:  [30.47736645]
curr_Stock_Price:  100.18652429712296
curr_Factors:  [100.1865243]
mat_Sqrt:  [[0.15]]
grads:  [0.06165741]
Stock Position:  0.06165740791964583
Bond Position:  [24.30012505]


portfolio before change:  [30.43954197]
curr_Stock_Price:  99.37595539263687
curr_Factors:  [99.37595539]
mat_Sqrt:  [[0.15]]
grads:  [0.07308517]
Stock Position:  0.07308516600696517
Bond Position:  [23.17663378]


portfolio before change:  [30.21403634]
curr_Stock_Price:  96.13183816586836
curr_Factors:  [96.13183817]
mat_Sqrt:  [[0.15]]
grads:  [-0.236971]
Stock Position:  -0.23697099642414565
Bond Position:  [52.99449382]


portfolio before change:  [30.65323259]
curr_Stock_Price:  94.39030699470305
curr_Factors:  [94.39030699]
mat_Sqrt:  [[0.15]]
grads:  [0.09989599]
Stock Position:  0.0998959944224534
Bond Position:  [21.22401901]


portfolio before change:  [30.74021151]
curr_Stock_Price:  95.1547445898915
curr_Factors:  [95.15474459]
mat_Sqrt:  [[0.15]]
grads:  [-0.09387952]
Stock Position:  -0.09387951775620063
Bond Position:  [39.67329304]


portfolio before change:  [31.00878152]
curr_Stock_Price:  92.50530190756402
curr_Factors:  [92.50530191]
mat_Sqrt:  [[0.15]]
grads:  [-0.0030706]
Stock Position:  -0.00307060479766822
Bond Position:  [31.29282874]


portfolio before change:  [31.02158292]
curr_Stock_Price:  93.43310645607852
curr_Factors:  [93.43310646]
mat_Sqrt:  [[0.15]]
grads:  [-0.11619156]
Stock Position:  -0.11619156292651817
Bond Position:  [41.87772159]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [31.02100017]
Stock Price:  93.61837678999119
PL:  [31.02100017]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.42115177e-02]
 [-1.42578311e-02]
 [ 1.03250882e-03]
 [ 9.26214059e-03]
 [-1.56167535e-02]
 [ 1.19233568e-02]
 [-1.53031243e-02]
 [ 4.38372885e-03]
 [ 3.01902957e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.3789456]
curr_Stock_Price:  101.01306329582711
curr_Factors:  [101.0130633]
mat_Sqrt:  [[0.15]]
grads:  [-0.09474345]
Stock Position:  -0.09474345144655245
Bond Position:  [32.94927186]


portfolio before change:  [23.62739559]
curr_Stock_Price:  98.56464892822952
curr_Factors:  [98.56464893]
mat_Sqrt:  [[0.15]]
grads:  [-0.09505221]
Stock Position:  -0.09505220721351043
Bond Position:  [32.99618302]


portfolio before change:  [23.62138283]
curr_Stock_Price:  98.80151848205362
curr_Factors:  [98.80151848]
mat_Sqrt:  [[0.15]]
grads:  [0.00688339]
Stock Position:  0.006883392142709629
Bond Position:  [22.94129323]


portfolio before change:  [23.63024967]
curr_Stock_Price:  98.42282838265531
curr_Factors:  [98.42282838]
mat_Sqrt:  [[0.15]]
grads:  [0.0617476]
Stock Position:  0.06174760390357272
Bond Position:  [17.55287585]


portfolio before change:  [23.66425081]
curr_Stock_Price:  98.83130591514599
curr_Factors:  [98.83130592]
mat_Sqrt:  [[0.15]]
grads:  [-0.10411169]
Stock Position:  -0.10411168984704822
Bond Position:  [33.95374508]


portfolio before change:  [23.69581318]
curr_Stock_Price:  98.69125195282716
curr_Factors:  [98.69125195]
mat_Sqrt:  [[0.15]]
grads:  [0.07948905]
Stock Position:  0.07948904536023103
Bond Position:  [15.85093978]


portfolio before change:  [23.70794611]
curr_Stock_Price:  98.74415834565676
curr_Factors:  [98.74415835]
mat_Sqrt:  [[0.15]]
grads:  [-0.10202083]
Stock Position:  -0.10202082855982046
Bond Position:  [33.78190696]


portfolio before change:  [23.75269539]
curr_Stock_Price:  98.47113472653353
curr_Factors:  [98.47113473]
mat_Sqrt:  [[0.15]]
grads:  [0.02922486]
Stock Position:  0.029224859009811626
Bond Position:  [20.87489036]


portfolio before change:  [23.8040856]
curr_Stock_Price:  99.87234444337871
curr_Factors:  [99.87234444]
mat_Sqrt:  [[0.15]]
grads:  [0.00201269]
Stock Position:  0.002012686380750553
Bond Position:  [23.60307389]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.81660431]
Stock Price:  100.22720435494196
PL:  [23.58939995]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.38240431e-02]
 [-1.47979382e-02]
 [ 4.28139961e-03]
 [ 6.01444653e-03]
 [-3.69264368e-02]
 [ 1.57469017e-02]
 [-1.50835712e-02]
 [ 5.72187165e-04]
 [-1.91167778e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.31143721]
curr_Stock_Price:  100.73763756901994
curr_Factors:  [100.73763757]
mat_Sqrt:  [[0.15]]
grads:  [-0.09216029]
Stock Position:  -0.09216028761225653
Bond Position:  [26.59544686]


portfolio before change:  [17.58294994]
curr_Stock_Price:  97.93587022979641
curr_Factors:  [97.93587023]
mat_Sqrt:  [[0.15]]
grads:  [-0.09865292]
Stock Position:  -0.0986529215834097
Bond Position:  [27.24460966]


portfolio before change:  [17.44973033]
curr_Stock_Price:  99.42437469672583
curr_Factors:  [99.4243747]
mat_Sqrt:  [[0.15]]
grads:  [0.02854266]
Stock Position:  0.028542664055646247
Bond Position:  [14.61189381]


portfolio before change:  [17.37415138]
curr_Stock_Price:  96.52041554289261
curr_Factors:  [96.52041554]
mat_Sqrt:  [[0.15]]
grads:  [0.04009631]
Stock Position:  0.04009631020335975
Bond Position:  [13.50403886]


portfolio before change:  [17.35180244]
curr_Stock_Price:  95.79459699181501
curr_Factors:  [95.79459699]
mat_Sqrt:  [[0.15]]
grads:  [-0.24617625]
Stock Position:  -0.24617624526777682
Bond Position:  [40.93415664]


portfolio before change:  [17.9895066]
curr_Stock_Price:  93.28732029869803
curr_Factors:  [93.2873203]
mat_Sqrt:  [[0.15]]
grads:  [0.10497934]
Stock Position:  0.10497934497850622
Bond Position:  [8.19626482]


portfolio before change:  [18.04408508]
curr_Stock_Price:  93.76817032351339
curr_Factors:  [93.76817032]
mat_Sqrt:  [[0.15]]
grads:  [-0.10055714]
Stock Position:  -0.10055714138777892
Bond Position:  [27.47314424]


portfolio before change:  [18.07026951]
curr_Stock_Price:  93.64441549767177
curr_Factors:  [93.6444155]
mat_Sqrt:  [[0.15]]
grads:  [0.00381458]
Stock Position:  0.003814581102500175
Bond Position:  [17.7130553]


portfolio before change:  [18.07598435]
curr_Stock_Price:  92.82023497635073
curr_Factors:  [92.82023498]
mat_Sqrt:  [[0.15]]
grads:  [-0.12744519]
Stock Position:  -0.12744518551480702
Bond Position:  [29.90547642]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.15433258]
Stock Price:  92.32283093139579
PL:  [18.15433258]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.37068071e-02]
 [-1.45052139e-02]
 [ 4.58315398e-03]
 [ 8.88058867e-03]
 [-2.54306217e-02]
 [ 1.32448252e-02]
 [-1.39786426e-02]
 [ 1.82054621e-03]
 [-1.24493679e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-49.99095025]
curr_Stock_Price:  97.6825434892216
curr_Factors:  [97.68254349]
mat_Sqrt:  [[0.15]]
grads:  [-0.09137871]
Stock Position:  -0.09137871398829356
Bond Position:  [-41.06484505]


portfolio before change:  [-50.07229509]
curr_Stock_Price:  98.34798595342247
curr_Factors:  [98.34798595]
mat_Sqrt:  [[0.15]]
grads:  [-0.09670143]
Stock Position:  -0.09670142598224338
Bond Position:  [-40.5619046]


portfolio before change:  [-50.21770469]
curr_Stock_Price:  99.64190256605612
curr_Factors:  [99.64190257]
mat_Sqrt:  [[0.15]]
grads:  [0.03055436]
Stock Position:  0.03055435986690294
Bond Position:  [-53.26219924]


portfolio before change:  [-50.29107106]
curr_Stock_Price:  98.11254288422246
curr_Factors:  [98.11254288]
mat_Sqrt:  [[0.15]]
grads:  [0.05920392]
Stock Position:  0.05920392449277346
Bond Position:  [-56.09971864]


portfolio before change:  [-50.32593987]
curr_Stock_Price:  97.99748391733662
curr_Factors:  [97.99748392]
mat_Sqrt:  [[0.15]]
grads:  [-0.16953748]
Stock Position:  -0.1695374780688223
Bond Position:  [-33.71169359]


portfolio before change:  [-50.11841441]
curr_Stock_Price:  96.673968166195
curr_Factors:  [96.67396817]
mat_Sqrt:  [[0.15]]
grads:  [0.08829883]
Stock Position:  0.08829883477121403
Bond Position:  [-58.65461315]


portfolio before change:  [-50.12698746]
curr_Stock_Price:  96.90909685608197
curr_Factors:  [96.90909686]
mat_Sqrt:  [[0.15]]
grads:  [-0.09319095]
Stock Position:  -0.09319095050936253
Bond Position:  [-41.09593661]


portfolio before change:  [-49.9716156]
curr_Stock_Price:  95.02130667003054
curr_Factors:  [95.02130667]
mat_Sqrt:  [[0.15]]
grads:  [0.01213697]
Stock Position:  0.012136974732352437
Bond Position:  [-51.1248868]


portfolio before change:  [-49.99475598]
curr_Stock_Price:  95.22139420979796
curr_Factors:  [95.22139421]
mat_Sqrt:  [[0.15]]
grads:  [-0.08299579]
Stock Position:  -0.08299578591030024
Bond Position:  [-42.09178153]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-50.02985844]
Stock Price:  95.39069559110034
PL:  [-50.02985844]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.52532025e-02]
 [-6.32173328e-03]
 [-3.56802895e-02]
 [ 5.12030577e-03]
 [ 4.45702563e-02]
 [ 1.76814548e-03]
 [-6.00038978e-03]
 [ 7.85049618e-04]
 [ 2.00675036e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [39.62802716]
curr_Stock_Price:  101.75066674123572
curr_Factors:  [101.75066674]
mat_Sqrt:  [[0.15]]
grads:  [-0.10168802]
Stock Position:  -0.10168801641158799
Bond Position:  [49.97485063]


portfolio before change:  [39.4222627]
curr_Stock_Price:  104.01994231677354
curr_Factors:  [104.01994232]
mat_Sqrt:  [[0.15]]
grads:  [-0.04214489]
Stock Position:  -0.042144888546992366
Bond Position:  [43.80617158]


portfolio before change:  [39.43732988]
curr_Stock_Price:  104.1822723722982
curr_Factors:  [104.18227237]
mat_Sqrt:  [[0.15]]
grads:  [-0.2378686]
Stock Position:  -0.23786859666815005
Bond Position:  [64.21902081]


portfolio before change:  [39.54972316]
curr_Stock_Price:  103.84479304179979
curr_Factors:  [103.84479304]
mat_Sqrt:  [[0.15]]
grads:  [0.03413537]
Stock Position:  0.03413537180737613
Bond Position:  [36.00494254]


portfolio before change:  [39.59976853]
curr_Stock_Price:  104.78336189494813
curr_Factors:  [104.78336189]
mat_Sqrt:  [[0.15]]
grads:  [0.29713504]
Stock Position:  0.29713504207700187
Bond Position:  [8.46495988]


portfolio before change:  [39.60445658]
curr_Stock_Price:  104.78489154476206
curr_Factors:  [104.78489154]
mat_Sqrt:  [[0.15]]
grads:  [0.01178764]
Stock Position:  0.011787636564871903
Bond Position:  [38.36929036]


portfolio before change:  [39.63462988]
curr_Stock_Price:  105.71670372419426
curr_Factors:  [105.71670372]
mat_Sqrt:  [[0.15]]
grads:  [-0.0400026]
Stock Position:  -0.040002598505488866
Bond Position:  [43.86357274]


portfolio before change:  [39.72623601]
curr_Stock_Price:  103.97509554948523
curr_Factors:  [103.97509555]
mat_Sqrt:  [[0.15]]
grads:  [0.00523366]
Stock Position:  0.005233664119436325
Bond Position:  [39.18206528]


portfolio before change:  [39.74925761]
curr_Stock_Price:  104.62964061982025
curr_Factors:  [104.62964062]
mat_Sqrt:  [[0.15]]
grads:  [0.01337834]
Stock Position:  0.013378335711836905
Bond Position:  [38.34948715]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [39.75794292]
Stock Price:  103.84522111880224
PL:  [35.9127218]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30247413e-02]
 [-1.32233558e-02]
 [-8.36810206e-03]
 [ 6.44210958e-03]
 [-3.18315002e-02]
 [ 1.29414546e-02]
 [-7.55115488e-03]
 [ 2.24664930e-03]
 [ 1.58198368e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.09406492]
curr_Stock_Price:  99.22124334259927
curr_Factors:  [99.22124334]
mat_Sqrt:  [[0.15]]
grads:  [-0.08683161]
Stock Position:  -0.08683160840285356
Bond Position:  [-7.47852477]


portfolio before change:  [-16.11570119]
curr_Stock_Price:  99.4273442455219
curr_Factors:  [99.42734425]
mat_Sqrt:  [[0.15]]
grads:  [-0.08815571]
Stock Position:  -0.08815570529815786
Bond Position:  [-7.35061353]


portfolio before change:  [-15.96236137]
curr_Stock_Price:  97.64622257040155
curr_Factors:  [97.64622257]
mat_Sqrt:  [[0.15]]
grads:  [-0.05578735]
Stock Position:  -0.055787347049315435
Bond Position:  [-10.51493767]


portfolio before change:  [-15.94727458]
curr_Stock_Price:  97.28152372286738
curr_Factors:  [97.28152372]
mat_Sqrt:  [[0.15]]
grads:  [0.0429474]
Stock Position:  0.04294739717390831
Bond Position:  [-20.12526281]


portfolio before change:  [-15.96819731]
curr_Stock_Price:  97.02871249537884
curr_Factors:  [97.0287125]
mat_Sqrt:  [[0.15]]
grads:  [-0.21221]
Stock Position:  -0.2122100014808579
Bond Position:  [4.62226591]


portfolio before change:  [-16.67940127]
curr_Stock_Price:  100.39102183745487
curr_Factors:  [100.39102184]
mat_Sqrt:  [[0.15]]
grads:  [0.08627636]
Stock Position:  0.08627636432577306
Bond Position:  [-25.34077364]


portfolio before change:  [-16.50010082]
curr_Stock_Price:  102.61612722633801
curr_Factors:  [102.61612723]
mat_Sqrt:  [[0.15]]
grads:  [-0.05034103]
Stock Position:  -0.05034103254907903
Bond Position:  [-11.33429902]


portfolio before change:  [-16.49681989]
curr_Stock_Price:  102.4383498611348
curr_Factors:  [102.43834986]
mat_Sqrt:  [[0.15]]
grads:  [0.01497766]
Stock Position:  0.014977662033200032
Bond Position:  [-18.03110687]


portfolio before change:  [-16.47930645]
curr_Stock_Price:  104.2097377516995
curr_Factors:  [104.20973775]
mat_Sqrt:  [[0.15]]
grads:  [0.01054656]
Stock Position:  0.010546557845421236
Bond Position:  [-17.57836048]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.48998716]
Stock Price:  104.03059530532819
PL:  [-20.52058247]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30250567e-02]
 [-1.34031058e-02]
 [ 8.21607609e-04]
 [ 6.91981670e-03]
 [-3.49136485e-02]
 [ 1.31977945e-02]
 [-1.55483495e-02]
 [ 4.52068242e-03]
 [ 3.60838190e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.14100757]
curr_Stock_Price:  99.21911244919647
curr_Factors:  [99.21911245]
mat_Sqrt:  [[0.15]]
grads:  [-0.08683371]
Stock Position:  -0.08683371132358818
Bond Position:  [-7.5254438]


portfolio before change:  [-16.21978241]
curr_Stock_Price:  100.08296107330351
curr_Factors:  [100.08296107]
mat_Sqrt:  [[0.15]]
grads:  [-0.08935404]
Stock Position:  -0.08935403878188672
Bond Position:  [-7.27696563]


portfolio before change:  [-16.10552231]
curr_Stock_Price:  98.76349647967605
curr_Factors:  [98.76349648]
mat_Sqrt:  [[0.15]]
grads:  [0.00547738]
Stock Position:  0.005477384061763879
Bond Position:  [-16.64648792]


portfolio before change:  [-16.12130597]
curr_Stock_Price:  97.401836397332
curr_Factors:  [97.4018364]
mat_Sqrt:  [[0.15]]
grads:  [0.04613211]
Stock Position:  0.04613211135564592
Bond Position:  [-20.61465834]


portfolio before change:  [-16.18308268]
curr_Stock_Price:  96.28619701181466
curr_Factors:  [96.28619701]
mat_Sqrt:  [[0.15]]
grads:  [-0.23275766]
Stock Position:  -0.23275765683967622
Bond Position:  [6.22826692]


portfolio before change:  [-16.43744465]
curr_Stock_Price:  97.39239857660598
curr_Factors:  [97.39239858]
mat_Sqrt:  [[0.15]]
grads:  [0.0879853]
Stock Position:  0.08798529641509925
Bond Position:  [-25.00654371]


portfolio before change:  [-16.28664714]
curr_Stock_Price:  99.24843495641105
curr_Factors:  [99.24843496]
mat_Sqrt:  [[0.15]]
grads:  [-0.10365566]
Stock Position:  -0.10365566314307315
Bond Position:  [-5.9989848]


portfolio before change:  [-16.2689941]
curr_Stock_Price:  99.04918603909181
curr_Factors:  [99.04918604]
mat_Sqrt:  [[0.15]]
grads:  [0.03013788]
Stock Position:  0.030137882805806825
Bond Position:  [-19.25412686]


portfolio before change:  [-16.2451566]
curr_Stock_Price:  100.15964821143358
curr_Factors:  [100.15964821]
mat_Sqrt:  [[0.15]]
grads:  [0.00240559]
Stock Position:  0.00240558793030947
Bond Position:  [-16.48609944]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.25479745]
Stock Price:  99.57943763291478
PL:  [-16.25479745]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.33302904e-02]
 [-1.26626774e-02]
 [ 2.24091647e-02]
 [ 4.78413005e-03]
 [ 8.02721572e-03]
 [-1.65647320e-03]
 [-5.93548922e-03]
 [ 2.53239946e-03]
 [ 1.18544985e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.89919844]
curr_Stock_Price:  100.12880847990911
curr_Factors:  [100.12880848]
mat_Sqrt:  [[0.15]]
grads:  [-0.0888686]
Stock Position:  -0.08886860278842289
Bond Position:  [12.79750575]


portfolio before change:  [3.86011606]
curr_Stock_Price:  100.64060598651429
curr_Factors:  [100.64060599]
mat_Sqrt:  [[0.15]]
grads:  [-0.08441785]
Stock Position:  -0.08441784929846116
Bond Position:  [12.35597957]


portfolio before change:  [3.7988095]
curr_Stock_Price:  101.44003524576992
curr_Factors:  [101.44003525]
mat_Sqrt:  [[0.15]]
grads:  [0.14939443]
Stock Position:  0.14939443142726624
Bond Position:  [-11.35576689]


portfolio before change:  [3.94221171]
curr_Stock_Price:  102.43794065741223
curr_Factors:  [102.43794066]
mat_Sqrt:  [[0.15]]
grads:  [0.0318942]
Stock Position:  0.03189420034353015
Bond Position:  [0.67503551]


portfolio before change:  [3.93995135]
curr_Stock_Price:  102.35648515163014
curr_Factors:  [102.35648515]
mat_Sqrt:  [[0.15]]
grads:  [0.05351477]
Stock Position:  0.05351477149360312
Bond Position:  [-1.53763256]


portfolio before change:  [4.15595522]
curr_Stock_Price:  106.40719628131494
curr_Factors:  [106.40719628]
mat_Sqrt:  [[0.15]]
grads:  [-0.01104315]
Stock Position:  -0.011043154655344679
Bond Position:  [5.33102635]


portfolio before change:  [4.18219954]
curr_Stock_Price:  104.27210553761097
curr_Factors:  [104.27210554]
mat_Sqrt:  [[0.15]]
grads:  [-0.03956993]
Stock Position:  -0.03956992812353339
Bond Position:  [8.30823926]


portfolio before change:  [4.26794801]
curr_Stock_Price:  102.21010263496704
curr_Factors:  [102.21010263]
mat_Sqrt:  [[0.15]]
grads:  [0.01688266]
Stock Position:  0.016882663070515697
Bond Position:  [2.54236928]


portfolio before change:  [4.24981001]
curr_Stock_Price:  101.06043238170332
curr_Factors:  [101.06043238]
mat_Sqrt:  [[0.15]]
grads:  [0.0007903]
Stock Position:  0.0007902998989638607
Bond Position:  [4.16994196]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.25214357]
Stock Price:  101.37431720115055
PL:  [2.87782637]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30266112e-02]
 [-1.36789388e-02]
 [-7.26583483e-03]
 [ 4.88030530e-03]
 [ 9.11097672e-03]
 [ 8.14975796e-03]
 [-8.64883516e-03]
 [ 4.61453825e-04]
 [ 1.13660857e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.37234848]
curr_Stock_Price:  99.20861106480406
curr_Factors:  [99.20861106]
mat_Sqrt:  [[0.15]]
grads:  [-0.08684407]
Stock Position:  -0.0868440748541866
Bond Position:  [-7.75666843]


portfolio before change:  [-16.10216891]
curr_Stock_Price:  96.05285322446582
curr_Factors:  [96.05285322]
mat_Sqrt:  [[0.15]]
grads:  [-0.09119293]
Stock Position:  -0.0911929256396502
Bond Position:  [-7.34282821]


portfolio before change:  [-16.26336623]
curr_Stock_Price:  97.78023490204446
curr_Factors:  [97.7802349]
mat_Sqrt:  [[0.15]]
grads:  [-0.0484389]
Stock Position:  -0.0484388988348549
Bond Position:  [-11.52699932]


portfolio before change:  [-16.46450908]
curr_Stock_Price:  101.8137268644348
curr_Factors:  [101.81372686]
mat_Sqrt:  [[0.15]]
grads:  [0.03253537]
Stock Position:  0.032535368640208555
Bond Position:  [-19.77705622]


portfolio before change:  [-16.47989559]
curr_Stock_Price:  101.64481820143226
curr_Factors:  [101.6448182]
mat_Sqrt:  [[0.15]]
grads:  [0.06073984]
Stock Position:  0.060739844768390616
Bond Position:  [-22.65378607]


portfolio before change:  [-16.4496432]
curr_Stock_Price:  102.32941185185852
curr_Factors:  [102.32941185]
mat_Sqrt:  [[0.15]]
grads:  [0.05433172]
Stock Position:  0.05433171975530915
Bond Position:  [-22.00937613]


portfolio before change:  [-16.46748604]
curr_Stock_Price:  102.2036031685574
curr_Factors:  [102.20360317]
mat_Sqrt:  [[0.15]]
grads:  [-0.0576589]
Stock Position:  -0.057658901040736774
Bond Position:  [-10.5745386]


portfolio before change:  [-16.59194007]
curr_Stock_Price:  104.27033414594064
curr_Factors:  [104.27033415]
mat_Sqrt:  [[0.15]]
grads:  [0.00307636]
Stock Position:  0.003076358834251542
Bond Position:  [-16.91271303]


portfolio before change:  [-16.60191853]
curr_Stock_Price:  103.77624691789181
curr_Factors:  [103.77624692]
mat_Sqrt:  [[0.15]]
grads:  [0.00757739]
Stock Position:  0.00757739045213177
Bond Position:  [-17.38827167]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.60980663]
Stock Price:  103.88290807432043
PL:  [-20.4927147]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.31638547e-02]
 [-1.27028725e-02]
 [-2.14509389e-02]
 [ 6.25316755e-03]
 [-4.12593265e-02]
 [ 1.49812774e-02]
 [-1.59879452e-02]
 [-1.23911956e-03]
 [-3.36937785e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-37.02081664]
curr_Stock_Price:  98.27130385752152
curr_Factors:  [98.27130386]
mat_Sqrt:  [[0.15]]
grads:  [-0.08775903]
Stock Position:  -0.08775903140706676
Bond Position:  [-28.39662219]


portfolio before change:  [-36.7319882]
curr_Stock_Price:  94.81832248279332
curr_Factors:  [94.81832248]
mat_Sqrt:  [[0.15]]
grads:  [-0.08468582]
Stock Position:  -0.08468581656536384
Bond Position:  [-28.70222113]


portfolio before change:  [-36.85112503]
curr_Stock_Price:  96.05562692130675
curr_Factors:  [96.05562692]
mat_Sqrt:  [[0.15]]
grads:  [-0.14300626]
Stock Position:  -0.14300625902724123
Bond Position:  [-23.11456917]


portfolio before change:  [-36.85209413]
curr_Stock_Price:  95.98156671961186
curr_Factors:  [95.98156672]
mat_Sqrt:  [[0.15]]
grads:  [0.04168778]
Stock Position:  0.041687783671036746
Bond Position:  [-40.85335292]


portfolio before change:  [-36.92443669]
curr_Stock_Price:  94.73633929097046
curr_Factors:  [94.73633929]
mat_Sqrt:  [[0.15]]
grads:  [-0.27506218]
Stock Position:  -0.27506217683976963
Bond Position:  [-10.86605298]


portfolio before change:  [-36.83593278]
curr_Stock_Price:  94.39482271718705
curr_Factors:  [94.39482272]
mat_Sqrt:  [[0.15]]
grads:  [0.09987518]
Stock Position:  0.09987518274767715
Bond Position:  [-46.26363295]


portfolio before change:  [-37.02504784]
curr_Stock_Price:  92.73297386712437
curr_Factors:  [92.73297387]
mat_Sqrt:  [[0.15]]
grads:  [-0.1065863]
Stock Position:  -0.10658630153113409
Bond Position:  [-27.14098313]


portfolio before change:  [-36.92283076]
curr_Stock_Price:  91.64661506056385
curr_Factors:  [91.64661506]
mat_Sqrt:  [[0.15]]
grads:  [-0.0082608]
Stock Position:  -0.008260797086627173
Bond Position:  [-36.16575667]


portfolio before change:  [-36.90689362]
curr_Stock_Price:  87.52781891261225
curr_Factors:  [87.52781891]
mat_Sqrt:  [[0.15]]
grads:  [-0.22462519]
Stock Position:  -0.22462518969441636
Bond Position:  [-17.24594069]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-37.32300711]
Stock Price:  89.34190025996125
PL:  [-37.32300711]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.29992865e-02]
 [-1.32991598e-02]
 [-9.75245380e-03]
 [ 6.40880671e-03]
 [-4.28909382e-02]
 [ 1.49835269e-02]
 [-1.47468012e-02]
 [ 1.63849485e-03]
 [-1.34843993e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.47253209]
curr_Stock_Price:  99.4310311096513
curr_Factors:  [99.43103111]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-2.85564902]


portfolio before change:  [-11.46893073]
curr_Stock_Price:  99.37299473164903
curr_Factors:  [99.37299473]
mat_Sqrt:  [[0.15]]
grads:  [-0.08866107]
Stock Position:  -0.08866106524601207
Bond Position:  [-2.65841516]


portfolio before change:  [-11.30224046]
curr_Stock_Price:  97.47791474085064
curr_Factors:  [97.47791474]
mat_Sqrt:  [[0.15]]
grads:  [-0.06501636]
Stock Position:  -0.06501635869608532
Bond Position:  [-4.96458139]


portfolio before change:  [-11.18459513]
curr_Stock_Price:  95.63025296749693
curr_Factors:  [95.63025297]
mat_Sqrt:  [[0.15]]
grads:  [0.04272538]
Stock Position:  0.04272537805960171
Bond Position:  [-15.27043384]


portfolio before change:  [-11.2474512]
curr_Stock_Price:  94.33783720118949
curr_Factors:  [94.3378372]
mat_Sqrt:  [[0.15]]
grads:  [-0.28593959]
Stock Position:  -0.28593958797273195
Bond Position:  [15.72747109]


portfolio before change:  [-11.25494949]
curr_Stock_Price:  94.3915687699135
curr_Factors:  [94.39156877]
mat_Sqrt:  [[0.15]]
grads:  [0.09989018]
Stock Position:  0.09989017926100077
Bond Position:  [-20.68374021]


portfolio before change:  [-11.28905911]
curr_Stock_Price:  94.15365583066468
curr_Factors:  [94.15365583]
mat_Sqrt:  [[0.15]]
grads:  [-0.09831201]
Stock Position:  -0.09831200826235773
Bond Position:  [-2.03262412]


portfolio before change:  [-11.35563556]
curr_Stock_Price:  94.82051114513347
curr_Factors:  [94.82051115]
mat_Sqrt:  [[0.15]]
grads:  [0.0109233]
Stock Position:  0.01092329900339593
Bond Position:  [-12.39138835]


portfolio before change:  [-11.36134508]
curr_Stock_Price:  94.8651611970205
curr_Factors:  [94.8651612]
mat_Sqrt:  [[0.15]]
grads:  [-0.089896]
Stock Position:  -0.08989599507355045
Bond Position:  [-2.83334701]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.26073495]
Stock Price:  93.7302145956279
PL:  [-11.26073495]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.33162724e-02]
 [-1.35598120e-02]
 [ 4.32574253e-03]
 [ 1.01528096e-02]
 [-1.05624788e-02]
 [ 1.32980463e-02]
 [-1.37512984e-02]
 [ 1.78627206e-03]
 [-1.34957737e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.2440471]
curr_Stock_Price:  100.09906883673374
curr_Factors:  [100.09906884]
mat_Sqrt:  [[0.15]]
grads:  [-0.08877515]
Stock Position:  -0.08877514951763077
Bond Position:  [12.1303569]


portfolio before change:  [3.33206039]
curr_Stock_Price:  99.1759884784085
curr_Factors:  [99.17598848]
mat_Sqrt:  [[0.15]]
grads:  [-0.09039875]
Stock Position:  -0.09039874641282727
Bond Position:  [12.29744542]


portfolio before change:  [3.31286718]
curr_Stock_Price:  99.45634050422807
curr_Factors:  [99.4563405]
mat_Sqrt:  [[0.15]]
grads:  [0.02883828]
Stock Position:  0.028838283560649047
Bond Position:  [0.44471703]


portfolio before change:  [3.29784188]
curr_Stock_Price:  98.9276090140642
curr_Factors:  [98.92760901]
mat_Sqrt:  [[0.15]]
grads:  [0.0676854]
Stock Position:  0.06768539756286858
Bond Position:  [-3.39811266]


portfolio before change:  [3.3054141]
curr_Stock_Price:  99.06459129721699
curr_Factors:  [99.0645913]
mat_Sqrt:  [[0.15]]
grads:  [-0.07041653]
Stock Position:  -0.07041652532354661
Bond Position:  [10.2811984]


portfolio before change:  [3.44980976]
curr_Stock_Price:  97.08701895965325
curr_Factors:  [97.08701896]
mat_Sqrt:  [[0.15]]
grads:  [0.08865364]
Stock Position:  0.08865364216992473
Bond Position:  [-5.15730808]


portfolio before change:  [3.35437066]
curr_Stock_Price:  96.03957416859849
curr_Factors:  [96.03957417]
mat_Sqrt:  [[0.15]]
grads:  [-0.09167532]
Stock Position:  -0.09167532249186093
Bond Position:  [12.1588296]


portfolio before change:  [3.45726721]
curr_Stock_Price:  94.9835036237295
curr_Factors:  [94.98350362]
mat_Sqrt:  [[0.15]]
grads:  [0.01190848]
Stock Position:  0.011908480398130122
Bond Position:  [2.32615802]


portfolio before change:  [3.45697212]
curr_Stock_Price:  94.86103150591187
curr_Factors:  [94.86103151]
mat_Sqrt:  [[0.15]]
grads:  [-0.08997182]
Stock Position:  -0.08997182497701332
Bond Position:  [11.99179224]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.61380303]
Stock Price:  93.18457870744291
PL:  [3.61380303]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.33157070e-02]
 [-1.28883508e-02]
 [ 4.34143322e-03]
 [ 5.95955285e-03]
 [ 8.16124452e-03]
 [ 1.16471445e-02]
 [-1.54370195e-02]
 [ 4.60263978e-03]
 [ 3.36153615e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.21872219]
curr_Stock_Price:  100.09791924924107
curr_Factors:  [100.09791925]
mat_Sqrt:  [[0.15]]
grads:  [-0.08877138]
Stock Position:  -0.0887713799573007
Bond Position:  [12.10455261]


portfolio before change:  [3.24857694]
curr_Stock_Price:  99.82980398259919
curr_Factors:  [99.82980398]
mat_Sqrt:  [[0.15]]
grads:  [-0.08592234]
Stock Position:  -0.0859223389648191
Bond Position:  [11.8261872]


portfolio before change:  [3.28560849]
curr_Stock_Price:  99.46765156145213
curr_Factors:  [99.46765156]
mat_Sqrt:  [[0.15]]
grads:  [0.02894289]
Stock Position:  0.028942888117796616
Bond Position:  [0.40672738]


portfolio before change:  [3.34261538]
curr_Stock_Price:  101.43025710257135
curr_Factors:  [101.4302571]
mat_Sqrt:  [[0.15]]
grads:  [0.03973035]
Stock Position:  0.03973035230370352
Bond Position:  [-0.68724447]


portfolio before change:  [3.36605312]
curr_Stock_Price:  102.02882835424082
curr_Factors:  [102.02882835]
mat_Sqrt:  [[0.15]]
grads:  [0.0544083]
Stock Position:  0.05440829678529095
Bond Position:  [-2.18516165]


portfolio before change:  [3.30321105]
curr_Stock_Price:  100.8939055240776
curr_Factors:  [100.89390552]
mat_Sqrt:  [[0.15]]
grads:  [0.07764763]
Stock Position:  0.07764763008068408
Bond Position:  [-4.53096161]


portfolio before change:  [3.15771992]
curr_Stock_Price:  99.04935363713142
curr_Factors:  [99.04935364]
mat_Sqrt:  [[0.15]]
grads:  [-0.10291346]
Stock Position:  -0.10291346321154428
Bond Position:  [13.35123193]


portfolio before change:  [3.12881419]
curr_Stock_Price:  99.39511026748508
curr_Factors:  [99.39511027]
mat_Sqrt:  [[0.15]]
grads:  [0.03068427]
Stock Position:  0.030684265186181517
Bond Position:  [0.07894827]


portfolio before change:  [3.14585164]
curr_Stock_Price:  99.9490738089877
curr_Factors:  [99.94907381]
mat_Sqrt:  [[0.15]]
grads:  [0.00224102]
Stock Position:  0.002241024101303847
Bond Position:  [2.92186336]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.15128926]
Stock Price:  101.72340626335898
PL:  [1.42788299]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.33501014e-02]
 [-1.32568473e-02]
 [ 2.40202186e-03]
 [ 4.89189201e-03]
 [ 1.14432606e-02]
 [ 1.17137143e-02]
 [-8.59852581e-03]
 [ 2.03441600e-03]
 [ 3.76219274e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.94442163]
curr_Stock_Price:  100.17625486783317
curr_Factors:  [100.17625487]
mat_Sqrt:  [[0.15]]
grads:  [-0.08900068]
Stock Position:  -0.08900067630641796
Bond Position:  [13.86017606]


portfolio before change:  [5.02014414]
curr_Stock_Price:  99.4033317163816
curr_Factors:  [99.40333172]
mat_Sqrt:  [[0.15]]
grads:  [-0.08837898]
Stock Position:  -0.08837898182097265
Bond Position:  [13.80530938]


portfolio before change:  [5.05631864]
curr_Stock_Price:  99.07214297395488
curr_Factors:  [99.07214297]
mat_Sqrt:  [[0.15]]
grads:  [0.01601348]
Stock Position:  0.0160134790520203
Bond Position:  [3.46982895]


portfolio before change:  [5.10158526]
curr_Stock_Price:  101.790557070204
curr_Factors:  [101.79055707]
mat_Sqrt:  [[0.15]]
grads:  [0.03261261]
Stock Position:  0.03261261337748781
Bond Position:  [1.78192917]


portfolio before change:  [5.07570914]
curr_Stock_Price:  100.96979164873517
curr_Factors:  [100.96979165]
mat_Sqrt:  [[0.15]]
grads:  [0.0762884]
Stock Position:  0.07628840377271122
Bond Position:  [-2.6271151]


portfolio before change:  [5.06657483]
curr_Stock_Price:  100.86728035645962
curr_Factors:  [100.86728036]
mat_Sqrt:  [[0.15]]
grads:  [0.07809143]
Stock Position:  0.078091428362482
Bond Position:  [-2.81029517]


portfolio before change:  [5.17094492]
curr_Stock_Price:  102.22179002884766
curr_Factors:  [102.22179003]
mat_Sqrt:  [[0.15]]
grads:  [-0.05732351]
Stock Position:  -0.057323505399506175
Bond Position:  [11.03065626]


portfolio before change:  [5.15417302]
curr_Stock_Price:  102.61061157136655
curr_Factors:  [102.61061157]
mat_Sqrt:  [[0.15]]
grads:  [0.01356277]
Stock Position:  0.013562773311898913
Bond Position:  [3.76248855]


portfolio before change:  [5.12581811]
curr_Stock_Price:  100.3812282321615
curr_Factors:  [100.38122823]
mat_Sqrt:  [[0.15]]
grads:  [0.00250813]
Stock Position:  0.002508128492364689
Bond Position:  [4.87404909]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.13142722]
Stock Price:  101.64570693382795
PL:  [3.48572029]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.32578210e-02]
 [-1.29796261e-02]
 [ 2.24306318e-02]
 [ 9.79429175e-03]
 [-1.77876236e-02]
 [ 1.17514005e-02]
 [-1.55228069e-02]
 [ 4.44165390e-03]
 [-2.56674112e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.62609928]
curr_Stock_Price:  99.9802308995972
curr_Factors:  [99.9802309]
mat_Sqrt:  [[0.15]]
grads:  [-0.08838547]
Stock Position:  -0.08838547341520009
Bond Position:  [9.46289932]


portfolio before change:  [0.63811819]
curr_Stock_Price:  99.89779336318881
curr_Factors:  [99.89779336]
mat_Sqrt:  [[0.15]]
grads:  [-0.08653084]
Stock Position:  -0.08653084097538039
Bond Position:  [9.28235826]


portfolio before change:  [0.51306655]
curr_Stock_Price:  101.39661129823381
curr_Factors:  [101.3966113]
mat_Sqrt:  [[0.15]]
grads:  [0.14953755]
Stock Position:  0.14953754521401155
Bond Position:  [-14.64953379]


portfolio before change:  [0.10685521]
curr_Stock_Price:  98.72915582138498
curr_Factors:  [98.72915582]
mat_Sqrt:  [[0.15]]
grads:  [0.06529528]
Stock Position:  0.06529527836335346
Bond Position:  [-6.3396925]


portfolio before change:  [0.09875949]
curr_Stock_Price:  98.65372804698404
curr_Factors:  [98.65372805]
mat_Sqrt:  [[0.15]]
grads:  [-0.11858416]
Stock Position:  -0.11858415761103493
Bond Position:  [11.79752873]


portfolio before change:  [0.06601293]
curr_Stock_Price:  98.97962998243001
curr_Factors:  [98.97962998]
mat_Sqrt:  [[0.15]]
grads:  [0.07834267]
Stock Position:  0.07834267007250063
Bond Position:  [-7.68831557]


portfolio before change:  [0.08951973]
curr_Stock_Price:  99.32876188181899
curr_Factors:  [99.32876188]
mat_Sqrt:  [[0.15]]
grads:  [-0.10348538]
Stock Position:  -0.1034853795305604
Bond Position:  [10.36859435]


portfolio before change:  [0.15815615]
curr_Stock_Price:  98.71562380053913
curr_Factors:  [98.7156238]
mat_Sqrt:  [[0.15]]
grads:  [0.02961103]
Stock Position:  0.029611026011907023
Bond Position:  [-2.76491475]


portfolio before change:  [0.14507771]
curr_Stock_Price:  98.32064805276782
curr_Factors:  [98.32064805]
mat_Sqrt:  [[0.15]]
grads:  [-0.01711161]
Stock Position:  -0.017111607471931377
Bond Position:  [1.82750205]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.16110778]
Stock Price:  97.4372657458924
PL:  [0.16110778]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.31928245e-02]
 [-1.30965964e-02]
 [-1.44986277e-02]
 [ 5.85776138e-03]
 [-3.41488469e-02]
 [ 1.27889021e-02]
 [-1.54213024e-02]
 [ 4.25100989e-03]
 [ 1.39979224e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-37.849646]
curr_Stock_Price:  98.23368035299028
curr_Factors:  [98.23368035]
mat_Sqrt:  [[0.15]]
grads:  [-0.08795216]
Stock Position:  -0.08795216325620445
Bond Position:  [-29.20978131]


portfolio before change:  [-37.97723324]
curr_Stock_Price:  99.51822749326858
curr_Factors:  [99.51822749]
mat_Sqrt:  [[0.15]]
grads:  [-0.08731064]
Stock Position:  -0.08731064248031056
Bond Position:  [-29.28823286]


portfolio before change:  [-37.76335878]
curr_Stock_Price:  96.90088060075958
curr_Factors:  [96.9008806]
mat_Sqrt:  [[0.15]]
grads:  [-0.09665752]
Stock Position:  -0.0966575177181795
Bond Position:  [-28.3971602]


portfolio before change:  [-37.77497143]
curr_Stock_Price:  96.87409035256039
curr_Factors:  [96.87409035]
mat_Sqrt:  [[0.15]]
grads:  [0.03905174]
Stock Position:  0.039051742503749654
Bond Position:  [-41.55807346]


portfolio before change:  [-37.8114193]
curr_Stock_Price:  96.47299087199004
curr_Factors:  [96.47299087]
mat_Sqrt:  [[0.15]]
grads:  [-0.22765898]
Stock Position:  -0.22765897940147978
Bond Position:  [-15.84847666]


portfolio before change:  [-38.13264305]
curr_Stock_Price:  97.84916120859553
curr_Factors:  [97.84916121]
mat_Sqrt:  [[0.15]]
grads:  [0.08525935]
Stock Position:  0.08525934726166208
Bond Position:  [-46.47519867]


portfolio before change:  [-38.05595509]
curr_Stock_Price:  99.0212482428471
curr_Factors:  [99.02124824]
mat_Sqrt:  [[0.15]]
grads:  [-0.10280868]
Stock Position:  -0.10280868280427713
Bond Position:  [-27.87571098]


portfolio before change:  [-37.97856438]
curr_Stock_Price:  98.13287921070732
curr_Factors:  [98.13287921]
mat_Sqrt:  [[0.15]]
grads:  [0.02834007]
Stock Position:  0.028340065943127168
Bond Position:  [-40.75965664]


portfolio before change:  [-37.91690408]
curr_Stock_Price:  101.02790510253914
curr_Factors:  [101.0279051]
mat_Sqrt:  [[0.15]]
grads:  [0.00093319]
Stock Position:  0.0009331948242272242
Bond Position:  [-38.01118279]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-37.93647018]
Stock Price:  100.43236313390929
PL:  [-38.36883331]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30112491e-02]
 [-1.01055114e-02]
 [ 2.16477731e-02]
 [ 1.08606503e-02]
 [-1.47397444e-02]
 [ 1.20933429e-02]
 [-1.51431039e-02]
 [ 2.61886606e-03]
 [-4.06297651e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.08619142]
curr_Stock_Price:  99.31238784229157
curr_Factors:  [99.31238784]
mat_Sqrt:  [[0.15]]
grads:  [-0.08674166]
Stock Position:  -0.08674166037541826
Bond Position:  [-5.47167]


portfolio before change:  [-14.24709963]
curr_Stock_Price:  101.13586794641427
curr_Factors:  [101.13586795]
mat_Sqrt:  [[0.15]]
grads:  [-0.06737008]
Stock Position:  -0.06737007608337074
Bond Position:  [-7.43356851]


portfolio before change:  [-14.27852354]
curr_Stock_Price:  101.54712169671645
curr_Factors:  [101.5471217]
mat_Sqrt:  [[0.15]]
grads:  [0.14431849]
Stock Position:  0.14431848754135945
Bond Position:  [-28.93365056]


portfolio before change:  [-14.45719667]
curr_Stock_Price:  100.40934170548061
curr_Factors:  [100.40934171]
mat_Sqrt:  [[0.15]]
grads:  [0.07240434]
Stock Position:  0.07240433529986776
Bond Position:  [-21.72726831]


portfolio before change:  [-14.57712539]
curr_Stock_Price:  98.90304553876037
curr_Factors:  [98.90304554]
mat_Sqrt:  [[0.15]]
grads:  [-0.09826496]
Stock Position:  -0.09826496243159824
Bond Position:  [-4.85842134]


portfolio before change:  [-14.61822399]
curr_Stock_Price:  99.29656091304811
curr_Factors:  [99.29656091]
mat_Sqrt:  [[0.15]]
grads:  [0.08062229]
Stock Position:  0.08062228595877496
Bond Position:  [-22.62373971]


portfolio before change:  [-14.71439713]
curr_Stock_Price:  98.24401765562608
curr_Factors:  [98.24401766]
mat_Sqrt:  [[0.15]]
grads:  [-0.10095403]
Stock Position:  -0.10095402588317205
Bond Position:  [-4.79626803]


portfolio before change:  [-14.4803418]
curr_Stock_Price:  95.9018222262904
curr_Factors:  [95.90182223]
mat_Sqrt:  [[0.15]]
grads:  [0.01745911]
Stock Position:  0.017459107086392617
Bond Position:  [-16.15470199]


portfolio before change:  [-14.45431259]
curr_Stock_Price:  97.85544905202605
curr_Factors:  [97.85544905]
mat_Sqrt:  [[0.15]]
grads:  [-0.02708651]
Stock Position:  -0.027086510080489644
Bond Position:  [-11.80374999]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.50298816]
Stock Price:  99.43454563462348
PL:  [-14.50298816]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.55733196e-02]
 [-8.05286220e-03]
 [ 2.03045678e-02]
 [ 4.93144928e-03]
 [ 4.50250571e-02]
 [ 2.09723034e-03]
 [-5.99447715e-03]
 [-5.94241582e-04]
 [ 3.03989906e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [44.67009927]
curr_Stock_Price:  101.9795442779121
curr_Factors:  [101.97954428]
mat_Sqrt:  [[0.15]]
grads:  [-0.10382213]
Stock Position:  -0.10382213061400877
Bond Position:  [55.25783284]


portfolio before change:  [44.72829245]
curr_Stock_Price:  101.68522021165859
curr_Factors:  [101.68522021]
mat_Sqrt:  [[0.15]]
grads:  [-0.05368575]
Stock Position:  -0.05368574799636439
Bond Position:  [50.18733956]


portfolio before change:  [44.75066422]
curr_Stock_Price:  101.73603774256874
curr_Factors:  [101.73603774]
mat_Sqrt:  [[0.15]]
grads:  [0.13536379]
Stock Position:  0.13536378562138676
Bond Position:  [30.97928901]


portfolio before change:  [44.95280391]
curr_Stock_Price:  103.11488638265017
curr_Factors:  [103.11488638]
mat_Sqrt:  [[0.15]]
grads:  [0.03287633]
Stock Position:  0.03287632855181958
Bond Position:  [41.56276502]


portfolio before change:  [45.02934754]
curr_Stock_Price:  104.8108499171669
curr_Factors:  [104.81084992]
mat_Sqrt:  [[0.15]]
grads:  [0.30016705]
Stock Position:  0.3001670476134625
Bond Position:  [13.56858416]


portfolio before change:  [44.9849903]
curr_Stock_Price:  104.64046735175175
curr_Factors:  [104.64046735]
mat_Sqrt:  [[0.15]]
grads:  [0.01398154]
Stock Position:  0.013981535591628935
Bond Position:  [43.52195588]


portfolio before change:  [45.01996408]
curr_Stock_Price:  105.5850967683021
curr_Factors:  [105.58509677]
mat_Sqrt:  [[0.15]]
grads:  [-0.03996318]
Stock Position:  -0.03996318101735774
Bond Position:  [49.23948042]


portfolio before change:  [45.05101521]
curr_Stock_Price:  105.4243180302227
curr_Factors:  [105.42431803]
mat_Sqrt:  [[0.15]]
grads:  [-0.00396161]
Stock Position:  -0.003961610547116917
Bond Position:  [45.4686653]


portfolio before change:  [45.06401905]
curr_Stock_Price:  107.88194798365451
curr_Factors:  [107.88194798]
mat_Sqrt:  [[0.15]]
grads:  [0.02026599]
Stock Position:  0.020265993732486838
Bond Position:  [42.87768417]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [45.00118674]
Stock Price:  103.7234290454163
PL:  [41.27775769]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30523281e-02]
 [-1.34944450e-02]
 [-9.41128352e-03]
 [ 8.37719691e-03]
 [-1.95762619e-02]
 [ 1.19098015e-02]
 [-1.41991387e-02]
 [ 4.06521922e-03]
 [ 1.04063759e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.76081855]
curr_Stock_Price:  99.69030604605555
curr_Factors:  [99.69030605]
mat_Sqrt:  [[0.15]]
grads:  [-0.08701552]
Stock Position:  -0.08701552071997692
Bond Position:  [2.91378535]


portfolio before change:  [-5.42237871]
curr_Stock_Price:  95.81763395689656
curr_Factors:  [95.81763396]
mat_Sqrt:  [[0.15]]
grads:  [-0.08996297]
Stock Position:  -0.08996296682071278
Bond Position:  [3.19765991]


portfolio before change:  [-5.57387485]
curr_Stock_Price:  97.51939381597526
curr_Factors:  [97.51939382]
mat_Sqrt:  [[0.15]]
grads:  [-0.06274189]
Stock Position:  -0.06274189013188448
Bond Position:  [0.54467625]


portfolio before change:  [-5.78469992]
curr_Stock_Price:  100.88393196561539
curr_Factors:  [100.88393197]
mat_Sqrt:  [[0.15]]
grads:  [0.05584798]
Stock Position:  0.05584797938453734
Bond Position:  [-11.41886368]


portfolio before change:  [-5.92313435]
curr_Stock_Price:  98.50741687297905
curr_Factors:  [98.50741687]
mat_Sqrt:  [[0.15]]
grads:  [-0.13050841]
Stock Position:  -0.13050841242508127
Bond Position:  [6.93291224]


portfolio before change:  [-5.94647416]
curr_Stock_Price:  98.712822283655
curr_Factors:  [98.71282228]
mat_Sqrt:  [[0.15]]
grads:  [0.07939868]
Stock Position:  0.07939867691874915
Bond Position:  [-13.78414164]


portfolio before change:  [-5.84869378]
curr_Stock_Price:  100.03115876137224
curr_Factors:  [100.03115876]
mat_Sqrt:  [[0.15]]
grads:  [-0.09466092]
Stock Position:  -0.09466092485093466
Bond Position:  [3.62034822]


portfolio before change:  [-5.89795398]
curr_Stock_Price:  100.57067203476683
curr_Factors:  [100.57067203]
mat_Sqrt:  [[0.15]]
grads:  [0.02710146]
Stock Position:  0.027101461482168986
Bond Position:  [-8.62356618]


portfolio before change:  [-5.81792263]
curr_Stock_Price:  103.68283680327032
curr_Factors:  [103.6828368]
mat_Sqrt:  [[0.15]]
grads:  [0.00693758]
Stock Position:  0.006937583921273089
Bond Position:  [-6.53723101]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.83054291]
Stock Price:  102.33498331293025
PL:  [-8.16552622]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 3.30443445]
 [-0.0136786 ]
 [-0.01357056]
 [ 0.00442534]
 [ 0.00477702]
 [ 0.02037655]
 [ 0.01228959]
 [-0.01506885]
 [ 0.0043519 ]
 [-0.01369233]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.03382756]
curr_Stock_Price:  100.63424878862419
curr_Factors:  [100.63424879]
mat_Sqrt:  [[0.15]]
grads:  [-0.09119067]
Stock Position:  -0.09119067388847085
Bond Position:  [24.21073252]


portfolio before change:  [15.06139071]
curr_Stock_Price:  100.4647713845858
curr_Factors:  [100.46477138]
mat_Sqrt:  [[0.15]]
grads:  [-0.09047038]
Stock Position:  -0.09047038040270376
Bond Position:  [24.15047679]


portfolio before change:  [15.15820664]
curr_Stock_Price:  99.5281369624265
curr_Factors:  [99.52813696]
mat_Sqrt:  [[0.15]]
grads:  [0.02950226]
Stock Position:  0.029502256570937253
Bond Position:  [12.22190201]


portfolio before change:  [15.24897257]
curr_Stock_Price:  102.39752609407236
curr_Factors:  [102.39752609]
mat_Sqrt:  [[0.15]]
grads:  [0.03184683]
Stock Position:  0.031846829652067705
Bond Position:  [11.987936]


portfolio before change:  [15.28438099]
curr_Stock_Price:  103.32110151607695
curr_Factors:  [103.32110152]
mat_Sqrt:  [[0.15]]
grads:  [0.13584364]
Stock Position:  0.1358436428923253
Bond Position:  [1.24886617]


portfolio before change:  [14.75029269]
curr_Stock_Price:  99.38486365821703
curr_Factors:  [99.38486366]
mat_Sqrt:  [[0.15]]
grads:  [0.08193062]
Stock Position:  0.08193061678245409
Bond Position:  [6.60762951]


portfolio before change:  [14.64780589]
curr_Stock_Price:  98.09363155696954
curr_Factors:  [98.09363156]
mat_Sqrt:  [[0.15]]
grads:  [-0.10045902]
Stock Position:  -0.1004590232100299
Bond Position:  [24.50219629]


portfolio before change:  [14.63538048]
curr_Stock_Price:  98.33929954751774
curr_Factors:  [98.33929955]
mat_Sqrt:  [[0.15]]
grads:  [0.0290127]
Stock Position:  0.02901269864033653
Bond Position:  [11.78229202]


portfolio before change:  [14.53828875]
curr_Stock_Price:  94.78966957610722
curr_Factors:  [94.78966958]
mat_Sqrt:  [[0.15]]
grads:  [-0.09128218]
Stock Position:  -0.09128218163702634
Bond Position:  [23.19089659]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.66642494]
Stock Price:  93.51299286951966
PL:  [14.66642494]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30808346e-02]
 [-1.14840163e-02]
 [-1.92459896e-03]
 [ 5.99609957e-03]
 [-2.22467458e-02]
 [ 1.26087211e-02]
 [-1.54505445e-02]
 [ 2.80858877e-03]
 [-1.13479444e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.9608195]
curr_Stock_Price:  99.7266208403134
curr_Factors:  [99.72662084]
mat_Sqrt:  [[0.15]]
grads:  [-0.08720556]
Stock Position:  -0.08720556431673347
Bond Position:  [3.73589675]


portfolio before change:  [-5.05856283]
curr_Stock_Price:  100.86888448561287
curr_Factors:  [100.86888449]
mat_Sqrt:  [[0.15]]
grads:  [-0.07656011]
Stock Position:  -0.0765601085519285
Bond Position:  [2.66396992]


portfolio before change:  [-4.87047985]
curr_Stock_Price:  98.42961596991431
curr_Factors:  [98.42961597]
mat_Sqrt:  [[0.15]]
grads:  [-0.01283066]
Stock Position:  -0.012830659725874018
Bond Position:  [-3.60756294]


portfolio before change:  [-4.85606094]
curr_Stock_Price:  97.16521144213235
curr_Factors:  [97.16521144]
mat_Sqrt:  [[0.15]]
grads:  [0.039974]
Stock Position:  0.0399739971626957
Bond Position:  [-8.74014282]


portfolio before change:  [-4.81551096]
curr_Stock_Price:  98.28897044144293
curr_Factors:  [98.28897044]
mat_Sqrt:  [[0.15]]
grads:  [-0.14831164]
Stock Position:  -0.1483116385325227
Bond Position:  [9.76188729]


portfolio before change:  [-4.77525144]
curr_Stock_Price:  98.05043648079416
curr_Factors:  [98.05043648]
mat_Sqrt:  [[0.15]]
grads:  [0.08405814]
Stock Position:  0.08405814094697775
Bond Position:  [-13.01718884]


portfolio before change:  [-4.69576154]
curr_Stock_Price:  99.0735392809942
curr_Factors:  [99.07353928]
mat_Sqrt:  [[0.15]]
grads:  [-0.10300363]
Stock Position:  -0.10300363030147466
Bond Position:  [5.50917267]


portfolio before change:  [-4.99251025]
curr_Stock_Price:  101.98124251378671
curr_Factors:  [101.98124251]
mat_Sqrt:  [[0.15]]
grads:  [0.01872393]
Stock Position:  0.018723925124425677
Bond Position:  [-6.9019994]


portfolio before change:  [-5.00589686]
curr_Stock_Price:  101.45065129130846
curr_Factors:  [101.45065129]
mat_Sqrt:  [[0.15]]
grads:  [-0.00075653]
Stock Position:  -0.0007565296290982232
Bond Position:  [-4.92914644]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.00768059]
Stock Price:  100.5498784116049
PL:  [-5.557559]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.34809814e-02]
 [-1.31893096e-02]
 [ 3.79114158e-03]
 [ 9.07999050e-03]
 [-3.29375769e-02]
 [ 1.41781142e-02]
 [-1.40822978e-02]
 [ 2.46133339e-03]
 [-2.20822662e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.10609261]
curr_Stock_Price:  100.36516787460255
curr_Factors:  [100.36516787]
mat_Sqrt:  [[0.15]]
grads:  [-0.08987321]
Stock Position:  -0.08987320958258317
Bond Position:  [18.12623238]


portfolio before change:  [9.14892245]
curr_Stock_Price:  99.9894780457745
curr_Factors:  [99.98947805]
mat_Sqrt:  [[0.15]]
grads:  [-0.08792873]
Stock Position:  -0.08792873045949064
Bond Position:  [17.94087031]


portfolio before change:  [9.21578873]
curr_Stock_Price:  99.33106286592937
curr_Factors:  [99.33106287]
mat_Sqrt:  [[0.15]]
grads:  [0.02527428]
Stock Position:  0.025274277221397058
Bond Position:  [6.70526792]


portfolio before change:  [9.19244341]
curr_Stock_Price:  98.27470035952268
curr_Factors:  [98.27470036]
mat_Sqrt:  [[0.15]]
grads:  [0.06053327]
Stock Position:  0.06053326999332587
Bond Position:  [3.24355444]


portfolio before change:  [9.1029103]
curr_Stock_Price:  96.76882941742467
curr_Factors:  [96.76882942]
mat_Sqrt:  [[0.15]]
grads:  [-0.21958385]
Stock Position:  -0.21958384612065185
Bond Position:  [30.35178205]


portfolio before change:  [9.39416449]
curr_Stock_Price:  95.51156704988749
curr_Factors:  [95.51156705]
mat_Sqrt:  [[0.15]]
grads:  [0.09452076]
Stock Position:  0.09452076101631735
Bond Position:  [0.36633849]


portfolio before change:  [9.53708853]
curr_Stock_Price:  97.02172024031307
curr_Factors:  [97.02172024]
mat_Sqrt:  [[0.15]]
grads:  [-0.09388199]
Stock Position:  -0.09388198551557511
Bond Position:  [18.64568027]


portfolio before change:  [9.66786417]
curr_Stock_Price:  95.72806984927806
curr_Factors:  [95.72806985]
mat_Sqrt:  [[0.15]]
grads:  [0.01640889]
Stock Position:  0.016408889244453828
Bond Position:  [8.09707288]


portfolio before change:  [9.71628352]
curr_Stock_Price:  98.4320795694189
curr_Factors:  [98.43207957]
mat_Sqrt:  [[0.15]]
grads:  [-0.01472151]
Stock Position:  -0.014721510783426262
Bond Position:  [11.16535244]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.76669271]
Stock Price:  95.38720714370895
PL:  [9.76669271]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.32923177e-02]
 [-1.35227750e-02]
 [ 5.72630065e-04]
 [ 6.08667263e-03]
 [ 9.70590350e-03]
 [ 5.44626820e-03]
 [-5.94315904e-03]
 [-2.54169240e-05]
 [ 2.68309303e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-40.59276385]
curr_Stock_Price:  98.10916050412804
curr_Factors:  [98.1091605]
mat_Sqrt:  [[0.15]]
grads:  [-0.08861545]
Stock Position:  -0.08861545144809031
Bond Position:  [-31.8987763]


portfolio before change:  [-40.70612916]
curr_Stock_Price:  99.20842623342155
curr_Factors:  [99.20842623]
mat_Sqrt:  [[0.15]]
grads:  [-0.09015183]
Stock Position:  -0.09015183318535616
Bond Position:  [-31.76230766]


portfolio before change:  [-40.67917412]
curr_Stock_Price:  98.73322608766942
curr_Factors:  [98.73322609]
mat_Sqrt:  [[0.15]]
grads:  [0.00381753]
Stock Position:  0.0038175337676518706
Bond Position:  [-41.05609154]


portfolio before change:  [-40.68952744]
curr_Stock_Price:  101.39983092256267
curr_Factors:  [101.39983092]
mat_Sqrt:  [[0.15]]
grads:  [0.04057782]
Stock Position:  0.04057781754882205
Bond Position:  [-44.80411128]


portfolio before change:  [-40.7103587]
curr_Stock_Price:  101.43867977679191
curr_Factors:  [101.43867978]
mat_Sqrt:  [[0.15]]
grads:  [0.06470602]
Stock Position:  0.06470602334979701
Bond Position:  [-47.27405228]


portfolio before change:  [-40.61307527]
curr_Stock_Price:  103.30753775995285
curr_Factors:  [103.30753776]
mat_Sqrt:  [[0.15]]
grads:  [0.03630845]
Stock Position:  0.03630845466316812
Bond Position:  [-44.36401232]


portfolio before change:  [-40.59404228]
curr_Stock_Price:  104.44282523472188
curr_Factors:  [104.44282523]
mat_Sqrt:  [[0.15]]
grads:  [-0.03962106]
Stock Position:  -0.03962106023573061
Bond Position:  [-36.45590681]


portfolio before change:  [-40.62368339]
curr_Stock_Price:  104.73076788765789
curr_Factors:  [104.73076789]
mat_Sqrt:  [[0.15]]
grads:  [-0.00016945]
Stock Position:  -0.0001694461598699369
Bond Position:  [-40.60593716]


portfolio before change:  [-40.64412479]
curr_Stock_Price:  105.51777543136633
curr_Factors:  [105.51777543]
mat_Sqrt:  [[0.15]]
grads:  [0.01788729]
Stock Position:  0.01788728688340438
Bond Position:  [-42.53155151]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-40.65764713]
Stock Price:  105.95097439877051
PL:  [-46.60862153]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.49097199e-02]
 [-7.04929253e-03]
 [ 1.36067346e-02]
 [ 7.41273237e-03]
 [ 1.48684081e-02]
 [ 1.36115197e-02]
 [-1.49882561e-02]
 [ 4.34592506e-03]
 [ 3.14894527e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [34.27009432]
curr_Stock_Price:  101.5074511654938
curr_Factors:  [101.50745117]
mat_Sqrt:  [[0.15]]
grads:  [-0.09939813]
Stock Position:  -0.09939813235971443
Bond Position:  [44.35974538]


portfolio before change:  [34.13892304]
curr_Stock_Price:  103.05030410252533
curr_Factors:  [103.0503041]
mat_Sqrt:  [[0.15]]
grads:  [-0.04699528]
Stock Position:  -0.046995283521079435
Bond Position:  [38.98180129]


portfolio before change:  [34.27752807]
curr_Stock_Price:  100.5158102195265
curr_Factors:  [100.51581022]
mat_Sqrt:  [[0.15]]
grads:  [0.09071156]
Stock Position:  0.0907115638129144
Bond Position:  [25.15958174]


portfolio before change:  [34.34255301]
curr_Stock_Price:  101.09392841506912
curr_Factors:  [101.09392842]
mat_Sqrt:  [[0.15]]
grads:  [0.04941822]
Stock Position:  0.049418215775761214
Bond Position:  [29.34667144]


portfolio before change:  [34.3220752]
curr_Stock_Price:  100.38255488397321
curr_Factors:  [100.38255488]
mat_Sqrt:  [[0.15]]
grads:  [0.09912272]
Stock Position:  0.09912272050307867
Bond Position:  [24.37188327]


portfolio before change:  [34.30578064]
curr_Stock_Price:  100.09519839962903
curr_Factors:  [100.0951984]
mat_Sqrt:  [[0.15]]
grads:  [0.09074346]
Stock Position:  0.09074346477470742
Bond Position:  [25.22279553]


portfolio before change:  [34.27458604]
curr_Stock_Price:  99.6124181892816
curr_Factors:  [99.61241819]
mat_Sqrt:  [[0.15]]
grads:  [-0.09992171]
Stock Position:  -0.0999217073351687
Bond Position:  [44.22802894]


portfolio before change:  [34.42555671]
curr_Stock_Price:  98.32289733037454
curr_Factors:  [98.32289733]
mat_Sqrt:  [[0.15]]
grads:  [0.02897283]
Stock Position:  0.028972833700462802
Bond Position:  [31.57686375]


portfolio before change:  [34.48708419]
curr_Stock_Price:  99.90144855419992
curr_Factors:  [99.90144855]
mat_Sqrt:  [[0.15]]
grads:  [0.0020993]
Stock Position:  0.002099296849518261
Bond Position:  [34.27736139]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [34.50841989]
Stock Price:  101.89865786653756
PL:  [32.60976202]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.41016166e-02]
 [-1.38206735e-02]
 [ 2.25251566e-02]
 [ 1.05755315e-02]
 [ 9.78188822e-03]
 [ 9.74950007e-03]
 [-6.82812681e-03]
 [ 1.36726486e-03]
 [ 2.70368525e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.66461406]
curr_Stock_Price:  100.93524370635825
curr_Factors:  [100.93524371]
mat_Sqrt:  [[0.15]]
grads:  [-0.09401078]
Stock Position:  -0.09401077700206223
Bond Position:  [31.15361474]


portfolio before change:  [21.72897826]
curr_Stock_Price:  100.41632980088973
curr_Factors:  [100.4163298]
mat_Sqrt:  [[0.15]]
grads:  [-0.09213782]
Stock Position:  -0.0921378234932187
Bond Position:  [30.98112033]


portfolio before change:  [21.67235532]
curr_Stock_Price:  101.1990416774124
curr_Factors:  [101.19904168]
mat_Sqrt:  [[0.15]]
grads:  [0.15016771]
Stock Position:  0.15016771044058583
Bond Position:  [6.47552693]


portfolio before change:  [21.56512726]
curr_Stock_Price:  100.46341991515075
curr_Factors:  [100.46341992]
mat_Sqrt:  [[0.15]]
grads:  [0.07050354]
Stock Position:  0.07050354365858727
Bond Position:  [14.48210015]


portfolio before change:  [21.63927316]
curr_Stock_Price:  101.4123515449722
curr_Factors:  [101.41235154]
mat_Sqrt:  [[0.15]]
grads:  [0.06521259]
Stock Position:  0.06521258814630118
Bond Position:  [15.02591125]


portfolio before change:  [21.66155761]
curr_Stock_Price:  101.63883567522015
curr_Factors:  [101.63883568]
mat_Sqrt:  [[0.15]]
grads:  [0.06499667]
Stock Position:  0.06499666712166967
Bond Position:  [15.05537204]


portfolio before change:  [21.75114786]
curr_Stock_Price:  102.90137237577943
curr_Factors:  [102.90137238]
mat_Sqrt:  [[0.15]]
grads:  [-0.04552085]
Stock Position:  -0.04552084540905661
Bond Position:  [26.43530532]


portfolio before change:  [21.74592017]
curr_Stock_Price:  103.3066514884456
curr_Factors:  [103.30665149]
mat_Sqrt:  [[0.15]]
grads:  [0.0091151]
Stock Position:  0.009115099089780036
Bond Position:  [20.8042698]


portfolio before change:  [21.77772321]
curr_Stock_Price:  105.65421804883478
curr_Factors:  [105.65421805]
mat_Sqrt:  [[0.15]]
grads:  [0.01802457]
Stock Position:  0.018024568313376555
Bond Position:  [19.87335154]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.80041882]
Stock Price:  106.36194389889569
PL:  [15.43847492]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.39768288e-02]
 [-1.32134460e-02]
 [ 2.13707778e-02]
 [ 4.80893996e-03]
 [ 9.70999411e-03]
 [ 1.09606606e-02]
 [-6.19970056e-03]
 [ 1.43628945e-03]
 [ 3.60801539e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.71710232]
curr_Stock_Price:  100.84683924128363
curr_Factors:  [100.84683924]
mat_Sqrt:  [[0.15]]
grads:  [-0.09317886]
Stock Position:  -0.09317885891398917
Bond Position:  [29.11389573]


portfolio before change:  [19.76081895]
curr_Stock_Price:  100.53393526714498
curr_Factors:  [100.53393527]
mat_Sqrt:  [[0.15]]
grads:  [-0.08808964]
Stock Position:  -0.08808963994611353
Bond Position:  [28.61681711]


portfolio before change:  [19.68244789]
curr_Stock_Price:  101.58607989150997
curr_Factors:  [101.58607989]
mat_Sqrt:  [[0.15]]
grads:  [0.14247185]
Stock Position:  0.14247185233288712
Bond Position:  [5.20929092]


portfolio before change:  [19.74620763]
curr_Stock_Price:  102.01531863880379
curr_Factors:  [102.01531864]
mat_Sqrt:  [[0.15]]
grads:  [0.0320596]
Stock Position:  0.032059599732889056
Bond Position:  [16.47563735]


portfolio before change:  [19.73262655]
curr_Stock_Price:  101.33468153736337
curr_Factors:  [101.33468154]
mat_Sqrt:  [[0.15]]
grads:  [0.06473329]
Stock Position:  0.06473329405163013
Bond Position:  [13.17289882]


portfolio before change:  [19.72826821]
curr_Stock_Price:  101.16558085439209
curr_Factors:  [101.16558085]
mat_Sqrt:  [[0.15]]
grads:  [0.07307107]
Stock Position:  0.07307107072436346
Bond Position:  [12.33599089]


portfolio before change:  [19.87938991]
curr_Stock_Price:  103.14929572193745
curr_Factors:  [103.14929572]
mat_Sqrt:  [[0.15]]
grads:  [-0.04133134]
Stock Position:  -0.04133133709593584
Bond Position:  [24.14268822]


portfolio before change:  [19.8879768]
curr_Stock_Price:  103.2336741474942
curr_Factors:  [103.23367415]
mat_Sqrt:  [[0.15]]
grads:  [0.00957526]
Stock Position:  0.00957526302539847
Bond Position:  [18.89948722]


portfolio before change:  [19.89189135]
curr_Stock_Price:  102.65535491852825
curr_Factors:  [102.65535492]
mat_Sqrt:  [[0.15]]
grads:  [0.00240534]
Stock Position:  0.002405343596262407
Bond Position:  [19.64496995]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.89856829]
Stock Price:  101.34660142323877
PL:  [18.55196687]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 3.30443445]
 [-0.01369297]
 [-0.01480535]
 [-0.01903043]
 [ 0.00625847]
 [-0.03146146]
 [ 0.01420168]
 [-0.01426208]
 [ 0.00412819]
 [-0.01036151]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-49.67716597]
curr_Stock_Price:  97.69678727072346
curr_Factors:  [97.69678727]
mat_Sqrt:  [[0.15]]
grads:  [-0.09128645]
Stock Position:  -0.0912864548741943
Bond Position:  [-40.75877261]


portfolio before change:  [-49.71276788]
curr_Stock_Price:  97.86348699918496
curr_Factors:  [97.863487]
mat_Sqrt:  [[0.15]]
grads:  [-0.09870236]
Stock Position:  -0.09870235953203729
Bond Position:  [-40.0534108]


portfolio before change:  [-49.58340597]
curr_Stock_Price:  96.34990998703573
curr_Factors:  [96.34990999]
mat_Sqrt:  [[0.15]]
grads:  [-0.12686951]
Stock Position:  -0.12686950621956403
Bond Position:  [-37.35954047]


portfolio before change:  [-49.55384173]
curr_Stock_Price:  95.96960835579667
curr_Factors:  [95.96960836]
mat_Sqrt:  [[0.15]]
grads:  [0.0417231]
Stock Position:  0.04172310233168229
Bond Position:  [-53.55799152]


portfolio before change:  [-49.53325564]
curr_Stock_Price:  97.10499322902801
curr_Factors:  [97.10499323]
mat_Sqrt:  [[0.15]]
grads:  [-0.20974306]
Stock Position:  -0.20974305753471595
Bond Position:  [-29.16615746]


portfolio before change:  [-49.20794029]
curr_Stock_Price:  95.48442908410938
curr_Factors:  [95.48442908]
mat_Sqrt:  [[0.15]]
grads:  [0.09467789]
Stock Position:  0.09467789070161192
Bond Position:  [-58.24820463]


portfolio before change:  [-49.07303006]
curr_Stock_Price:  97.2170576034863
curr_Factors:  [97.2170576]
mat_Sqrt:  [[0.15]]
grads:  [-0.09508054]
Stock Position:  -0.09508053728078383
Bond Position:  [-39.82957999]


portfolio before change:  [-49.16148751]
curr_Stock_Price:  97.93789578743332
curr_Factors:  [97.93789579]
mat_Sqrt:  [[0.15]]
grads:  [0.02752129]
Stock Position:  0.02752129211136831
Bond Position:  [-51.85686495]


portfolio before change:  [-49.24418534]
curr_Stock_Price:  95.87538681284592
curr_Factors:  [95.87538681]
mat_Sqrt:  [[0.15]]
grads:  [-0.06907671]
Stock Position:  -0.06907670702726897
Bond Position:  [-42.62142933]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-49.40243915]
Stock Price:  97.85778834027165
PL:  [-49.40243915]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.47875537e-02]
 [-7.79565572e-03]
 [-2.66316177e-01]
 [ 6.37715240e-03]
 [ 1.84448106e-01]
 [-1.18594375e-02]
 [-6.33501020e-03]
 [-5.89075260e-03]
 [ 1.61027293e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [32.36444348]
curr_Stock_Price:  101.4209469147946
curr_Factors:  [101.42094691]
mat_Sqrt:  [[0.15]]
grads:  [-0.09858369]
Stock Position:  -0.09858369149386453
Bond Position:  [42.36289482]


portfolio before change:  [31.97826374]
curr_Stock_Price:  105.55313631011576
curr_Factors:  [105.55313631]
mat_Sqrt:  [[0.15]]
grads:  [-0.05197104]
Stock Position:  -0.051971038136368976
Bond Position:  [37.46396981]


portfolio before change:  [31.79757319]
curr_Stock_Price:  109.39041229581974
curr_Factors:  [109.3904123]
mat_Sqrt:  [[0.15]]
grads:  [-1.77544118]
Stock Position:  -1.7754411817968345
Bond Position:  [226.01381607]


portfolio before change:  [29.81820056]
curr_Stock_Price:  110.56894066023264
curr_Factors:  [110.56894066]
mat_Sqrt:  [[0.15]]
grads:  [0.04251435]
Stock Position:  0.04251434930526303
Bond Position:  [25.117434]


portfolio before change:  [29.94917968]
curr_Stock_Price:  113.35428863405524
curr_Factors:  [113.35428863]
mat_Sqrt:  [[0.15]]
grads:  [1.22965404]
Stock Position:  1.2296540429726155
Bond Position:  [-109.43737963]


portfolio before change:  [29.05545968]
curr_Stock_Price:  112.67199296538709
curr_Factors:  [112.67199297]
mat_Sqrt:  [[0.15]]
grads:  [-0.07906292]
Stock Position:  -0.07906291696452664
Bond Position:  [37.9636361]


portfolio before change:  [29.03547561]
curr_Stock_Price:  113.16489957198023
curr_Factors:  [113.16489957]
mat_Sqrt:  [[0.15]]
grads:  [-0.0422334]
Stock Position:  -0.04223340134898641
Bond Position:  [33.81481423]


portfolio before change:  [29.00115979]
curr_Stock_Price:  114.3778601600991
curr_Factors:  [114.37786016]
mat_Sqrt:  [[0.15]]
grads:  [-0.03927168]
Stock Position:  -0.039271683973800486
Bond Position:  [33.49297097]


portfolio before change:  [29.03550897]
curr_Stock_Price:  113.92973815916316
curr_Factors:  [113.92973816]
mat_Sqrt:  [[0.15]]
grads:  [0.01073515]
Stock Position:  0.010735152886627651
Bond Position:  [27.81245581]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [29.03467447]
Stock Price:  112.55628704129812
PL:  [16.47838742]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 3.30443445]
 [-0.01500171]
 [-0.01428251]
 [ 0.00876062]
 [ 0.01033981]
 [-0.02538316]
 [ 0.01329242]
 [-0.01495505]
 [ 0.00350189]
 [-0.00613227]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [35.70497616]
curr_Stock_Price:  101.5725855417578
curr_Factors:  [101.57258554]
mat_Sqrt:  [[0.15]]
grads:  [-0.10001138]
Stock Position:  -0.10001137503128549
Bond Position:  [45.86339011]


portfolio before change:  [36.03090334]
curr_Stock_Price:  98.54303262713132
curr_Factors:  [98.54303263]
mat_Sqrt:  [[0.15]]
grads:  [-0.09521675]
Stock Position:  -0.09521674852248782
Bond Position:  [45.4138505]


portfolio before change:  [35.90063873]
curr_Stock_Price:  100.14965349694762
curr_Factors:  [100.1496535]
mat_Sqrt:  [[0.15]]
grads:  [0.05840416]
Stock Position:  0.05840415625196306
Bond Position:  [30.05148272]


portfolio before change:  [35.85034131]
curr_Stock_Price:  99.03112141899182
curr_Factors:  [99.03112142]
mat_Sqrt:  [[0.15]]
grads:  [0.06893207]
Stock Position:  0.06893207433871332
Bond Position:  [29.02392068]


portfolio before change:  [35.79391295]
curr_Stock_Price:  98.00193513847292
curr_Factors:  [98.00193514]
mat_Sqrt:  [[0.15]]
grads:  [-0.16922104]
Stock Position:  -0.1692210384238851
Bond Position:  [52.37790218]


portfolio before change:  [35.96159364]
curr_Stock_Price:  97.16583820509008
curr_Factors:  [97.16583821]
mat_Sqrt:  [[0.15]]
grads:  [0.08861615]
Stock Position:  0.08861614898132328
Bond Position:  [27.35113125]


portfolio before change:  [36.04653309]
curr_Stock_Price:  97.9699857509368
curr_Factors:  [97.96998575]
mat_Sqrt:  [[0.15]]
grads:  [-0.09970036]
Stock Position:  -0.09970035678455051
Bond Position:  [45.81417562]


portfolio before change:  [36.16578561]
curr_Stock_Price:  97.00369327398509
curr_Factors:  [97.00369327]
mat_Sqrt:  [[0.15]]
grads:  [0.0233459]
Stock Position:  0.023345904005247792
Bond Position:  [33.90114669]


portfolio before change:  [36.1874056]
curr_Stock_Price:  97.20352202345983
curr_Factors:  [97.20352202]
mat_Sqrt:  [[0.15]]
grads:  [-0.04088182]
Stock Position:  -0.040881822645663396
Bond Position:  [40.16126275]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [36.08822492]
Stock Price:  100.12086594028568
PL:  [35.96735898]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.49995390e-02]
 [-6.87914241e-03]
 [-1.44243717e-01]
 [ 5.77766577e-03]
 [ 7.21835704e-02]
 [ 5.46512496e-03]
 [-8.89948913e-03]
 [ 3.64519049e-03]
 [ 3.83595490e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [35.67117007]
curr_Stock_Price:  101.5710509635517
curr_Factors:  [101.57105096]
mat_Sqrt:  [[0.15]]
grads:  [-0.09999693]
Stock Position:  -0.09999692691812583
Bond Position:  [45.82796303]


portfolio before change:  [35.52302543]
curr_Stock_Price:  103.28174710816324
curr_Factors:  [103.28174711]
mat_Sqrt:  [[0.15]]
grads:  [-0.04586095]
Stock Position:  -0.045860949420711
Bond Position:  [40.25962441]


portfolio before change:  [35.38326187]
curr_Stock_Price:  106.7683387816743
curr_Factors:  [106.76833878]
mat_Sqrt:  [[0.15]]
grads:  [-0.96162478]
Stock Position:  -0.9616247832730561
Bond Position:  [138.05434251]


portfolio before change:  [35.7171593]
curr_Stock_Price:  106.49291639129125
curr_Factors:  [106.49291639]
mat_Sqrt:  [[0.15]]
grads:  [0.03851777]
Stock Position:  0.038517771815716056
Bond Position:  [31.61528944]


portfolio before change:  [35.73140652]
curr_Stock_Price:  106.45230210027657
curr_Factors:  [106.4523021]
mat_Sqrt:  [[0.15]]
grads:  [0.4812238]
Stock Position:  0.48122380271263304
Bond Position:  [-15.4959751]


portfolio before change:  [34.20675213]
curr_Stock_Price:  103.3001212174665
curr_Factors:  [103.30012122]
mat_Sqrt:  [[0.15]]
grads:  [0.03643417]
Stock Position:  0.03643416642702209
Bond Position:  [30.44309832]


portfolio before change:  [34.1787254]
curr_Stock_Price:  102.11299159979637
curr_Factors:  [102.1129916]
mat_Sqrt:  [[0.15]]
grads:  [-0.05932993]
Stock Position:  -0.05932992752482741
Bond Position:  [40.23708179]


portfolio before change:  [34.25258163]
curr_Stock_Price:  101.20733297343415
curr_Factors:  [101.20733297]
mat_Sqrt:  [[0.15]]
grads:  [0.02430127]
Stock Position:  0.024301269947175193
Bond Position:  [31.79311492]


portfolio before change:  [34.25098954]
curr_Stock_Price:  100.4875094248297
curr_Factors:  [100.48750942]
mat_Sqrt:  [[0.15]]
grads:  [0.0025573]
Stock Position:  0.0025573032661280427
Bond Position:  [33.9940125]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [34.26396333]
Stock Price:  98.91262186237549
PL:  [34.26396333]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.49318312e-02]
 [-8.07322520e-03]
 [ 1.19681613e-02]
 [ 7.84213060e-03]
 [ 1.06965351e-02]
 [ 8.56730319e-03]
 [-6.40096491e-03]
 [ 2.21677678e-03]
 [ 5.57992034e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [34.6150066]
curr_Stock_Price:  101.52310795746419
curr_Factors:  [101.52310796]
mat_Sqrt:  [[0.15]]
grads:  [-0.09954554]
Stock Position:  -0.09954554166163572
Bond Position:  [44.72117937]


portfolio before change:  [34.62867573]
curr_Stock_Price:  101.61047556370393
curr_Factors:  [101.61047556]
mat_Sqrt:  [[0.15]]
grads:  [-0.0538215]
Stock Position:  -0.053821501300350544
Bond Position:  [40.09750407]


portfolio before change:  [34.71430942]
curr_Stock_Price:  100.39200484459704
curr_Factors:  [100.39200484]
mat_Sqrt:  [[0.15]]
grads:  [0.07978774]
Stock Position:  0.07978774223752076
Bond Position:  [26.70425801]


portfolio before change:  [34.77621007]
curr_Stock_Price:  101.00043394226516
curr_Factors:  [101.00043394]
mat_Sqrt:  [[0.15]]
grads:  [0.05228087]
Stock Position:  0.05228087064645231
Bond Position:  [29.49581944]


portfolio before change:  [34.79590364]
curr_Stock_Price:  101.09496128983164
curr_Factors:  [101.09496129]
mat_Sqrt:  [[0.15]]
grads:  [0.07131023]
Stock Position:  0.07131023371563903
Bond Position:  [27.58679832]


portfolio before change:  [34.88314572]
curr_Stock_Price:  102.12490089312882
curr_Factors:  [102.12490089]
mat_Sqrt:  [[0.15]]
grads:  [0.05711535]
Stock Position:  0.0571153546008923
Bond Position:  [29.05024579]


portfolio before change:  [34.95164809]
curr_Stock_Price:  103.06989399225995
curr_Factors:  [103.06989399]
mat_Sqrt:  [[0.15]]
grads:  [-0.0426731]
Stock Position:  -0.04267309942576517
Bond Position:  [39.34995992]


portfolio before change:  [34.99730409]
curr_Stock_Price:  102.46117083682253
curr_Factors:  [102.46117084]
mat_Sqrt:  [[0.15]]
grads:  [0.01477851]
Stock Position:  0.014778511895582765
Bond Position:  [33.48308046]


portfolio before change:  [35.02148923]
curr_Stock_Price:  102.96456431064655
curr_Factors:  [102.96456431]
mat_Sqrt:  [[0.15]]
grads:  [0.00371995]
Stock Position:  0.0037199468929421465
Bond Position:  [34.63846651]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [35.04366194]
Stock Price:  104.26811939283854
PL:  [30.77554255]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.31473708e-02]
 [-1.32873398e-02]
 [-7.44001950e-03]
 [ 9.19613336e-03]
 [ 1.47976792e-02]
 [ 1.18328524e-02]
 [-1.52341982e-02]
 [ 4.62573507e-03]
 [-1.17636633e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.23921274]
curr_Stock_Price:  99.8047706774452
curr_Factors:  [99.80477068]
mat_Sqrt:  [[0.15]]
grads:  [-0.08764914]
Stock Position:  -0.08764913868772059
Bond Position:  [5.50858945]


portfolio before change:  [-3.19935576]
curr_Stock_Price:  99.38146933791346
curr_Factors:  [99.38146934]
mat_Sqrt:  [[0.15]]
grads:  [-0.08858227]
Stock Position:  -0.0885822655240884
Bond Position:  [5.60407995]


portfolio before change:  [-3.05283612]
curr_Stock_Price:  97.75905773755186
curr_Factors:  [97.75905774]
mat_Sqrt:  [[0.15]]
grads:  [-0.04960013]
Stock Position:  -0.049600130004369254
Bond Position:  [1.79602585]


portfolio before change:  [-3.08219854]
curr_Stock_Price:  98.3691500142822
curr_Factors:  [98.36915001]
mat_Sqrt:  [[0.15]]
grads:  [0.06130756]
Stock Position:  0.06130755575074061
Bond Position:  [-9.11297069]


portfolio before change:  [-2.98258861]
curr_Stock_Price:  100.06824822029395
curr_Factors:  [100.06824822]
mat_Sqrt:  [[0.15]]
grads:  [0.09865119]
Stock Position:  0.09865119458354969
Bond Position:  [-12.85444083]


portfolio before change:  [-3.08466581]
curr_Stock_Price:  99.09868699263583
curr_Factors:  [99.09868699]
mat_Sqrt:  [[0.15]]
grads:  [0.07888568]
Stock Position:  0.07888568242565204
Bond Position:  [-10.90213336]


portfolio before change:  [-3.13507958]
curr_Stock_Price:  98.52873130009934
curr_Factors:  [98.5287313]
mat_Sqrt:  [[0.15]]
grads:  [-0.10156132]
Stock Position:  -0.10156132155828229
Bond Position:  [6.87162858]


portfolio before change:  [-3.23053291]
curr_Stock_Price:  99.50242872424056
curr_Factors:  [99.50242872]
mat_Sqrt:  [[0.15]]
grads:  [0.03083823]
Stock Position:  0.03083823382575898
Bond Position:  [-6.29901207]


portfolio before change:  [-3.24586442]
curr_Stock_Price:  99.10742473055272
curr_Factors:  [99.10742473]
mat_Sqrt:  [[0.15]]
grads:  [-0.00078424]
Stock Position:  -0.000784244218338832
Bond Position:  [-3.16814]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.24641411]
Stock Price:  97.7879628244993
PL:  [-3.24641411]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.36929655e-02]
 [-1.37152904e-02]
 [ 8.96216977e-04]
 [ 5.99696608e-03]
 [-3.35955850e-02]
 [ 1.47077485e-02]
 [-1.41111304e-02]
 [ 5.05080224e-04]
 [-1.82777959e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-49.67710379]
curr_Stock_Price:  97.69679009320393
curr_Factors:  [97.69679009]
mat_Sqrt:  [[0.15]]
grads:  [-0.09128644]
Stock Position:  -0.09128643659256404
Bond Position:  [-40.75871196]


portfolio before change:  [-49.55164988]
curr_Stock_Price:  96.09919936842898
curr_Factors:  [96.09919937]
mat_Sqrt:  [[0.15]]
grads:  [-0.09143527]
Stock Position:  -0.09143526908829865
Bond Position:  [-40.76479373]


portfolio before change:  [-49.8166621]
curr_Stock_Price:  98.77458634618444
curr_Factors:  [98.77458635]
mat_Sqrt:  [[0.15]]
grads:  [0.00597478]
Stock Position:  0.00597477984597479
Bond Position:  [-50.40681851]


portfolio before change:  [-49.85510424]
curr_Stock_Price:  96.55987298932914
curr_Factors:  [96.55987299]
mat_Sqrt:  [[0.15]]
grads:  [0.03997977]
Stock Position:  0.03997977384586398
Bond Position:  [-53.71554612]


portfolio before change:  [-49.88003988]
curr_Stock_Price:  96.60811864154242
curr_Factors:  [96.60811864]
mat_Sqrt:  [[0.15]]
grads:  [-0.22397057]
Stock Position:  -0.22397056636026014
Bond Position:  [-28.24266483]


portfolio before change:  [-49.48706985]
curr_Stock_Price:  94.79049190280949
curr_Factors:  [94.7904919]
mat_Sqrt:  [[0.15]]
grads:  [0.09805166]
Stock Position:  0.09805165651473918
Bond Position:  [-58.7814346]


portfolio before change:  [-49.48753241]
curr_Stock_Price:  95.08559662555405
curr_Factors:  [95.08559663]
mat_Sqrt:  [[0.15]]
grads:  [-0.0940742]
Stock Position:  -0.09407420299532429
Bond Position:  [-40.54243069]


portfolio before change:  [-49.3652677]
curr_Stock_Price:  93.57039916732624
curr_Factors:  [93.57039917]
mat_Sqrt:  [[0.15]]
grads:  [0.0033672]
Stock Position:  0.0033672014921585537
Bond Position:  [-49.68033809]


portfolio before change:  [-49.39161436]
curr_Stock_Price:  93.12484096161269
curr_Factors:  [93.12484096]
mat_Sqrt:  [[0.15]]
grads:  [-0.12185197]
Stock Position:  -0.12185197240299026
Bond Position:  [-38.04416881]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-49.22535647]
Stock Price:  91.60426864324667
PL:  [-49.22535647]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.29992865e-02]
 [-1.43510762e-02]
 [-9.91870989e-03]
 [ 5.87606239e-03]
 [ 4.33970583e-03]
 [ 1.02320241e-02]
 [-5.94309760e-03]
 [-3.56609082e-04]
 [ 2.88773714e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-25.82424195]
curr_Stock_Price:  98.77955609551579
curr_Factors:  [98.7795561]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-17.26381695]


portfolio before change:  [-25.67083857]
curr_Stock_Price:  96.90979062104086
curr_Factors:  [96.90979062]
mat_Sqrt:  [[0.15]]
grads:  [-0.09567384]
Stock Position:  -0.09567384133625403
Bond Position:  [-16.39910663]


portfolio before change:  [-25.73146091]
curr_Stock_Price:  97.45770152533649
curr_Factors:  [97.45770153]
mat_Sqrt:  [[0.15]]
grads:  [-0.06612473]
Stock Position:  -0.0661247325720746
Bond Position:  [-19.28709646]


portfolio before change:  [-25.69978415]
curr_Stock_Price:  96.83278070182995
curr_Factors:  [96.8327807]
mat_Sqrt:  [[0.15]]
grads:  [0.03917375]
Stock Position:  0.03917374928980187
Bond Position:  [-29.49308722]


portfolio before change:  [-25.60959731]
curr_Stock_Price:  99.51154057193904
curr_Factors:  [99.51154057]
mat_Sqrt:  [[0.15]]
grads:  [0.02893137]
Stock Position:  0.0289313721680286
Bond Position:  [-28.48860273]


portfolio before change:  [-25.56775444]
curr_Stock_Price:  101.45029185686295
curr_Factors:  [101.45029186]
mat_Sqrt:  [[0.15]]
grads:  [0.06821349]
Stock Position:  0.06821349412312588
Bond Position:  [-32.48803333]


portfolio before change:  [-25.37996464]
curr_Stock_Price:  104.4414577271872
curr_Factors:  [104.44145773]
mat_Sqrt:  [[0.15]]
grads:  [-0.03962065]
Stock Position:  -0.0396206506547046
Bond Position:  [-21.24192613]


portfolio before change:  [-25.41676161]
curr_Stock_Price:  105.10205645116572
curr_Factors:  [105.10205645]
mat_Sqrt:  [[0.15]]
grads:  [-0.00237739]
Stock Position:  -0.002377393880105263
Bond Position:  [-25.16689263]


portfolio before change:  [-25.43356018]
curr_Stock_Price:  106.87373342952533
curr_Factors:  [106.87373343]
mat_Sqrt:  [[0.15]]
grads:  [0.01925158]
Stock Position:  0.01925158094652884
Bond Position:  [-27.49104851]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-25.46847588]
Stock Price:  105.77425287571171
PL:  [-31.24272875]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30250606e-02]
 [-1.45640813e-02]
 [-1.05950592e-02]
 [ 8.91899709e-03]
 [-3.35360557e-02]
 [ 1.36056235e-02]
 [-1.37421402e-02]
 [ 3.12726996e-03]
 [-3.14407511e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.99804547]
curr_Stock_Price:  99.04402781815767
curr_Factors:  [99.04402782]
mat_Sqrt:  [[0.15]]
grads:  [-0.08683374]
Stock Position:  -0.08683373724405714
Bond Position:  [-11.39768239]


portfolio before change:  [-19.84315184]
curr_Stock_Price:  97.19458647612572
curr_Factors:  [97.19458648]
mat_Sqrt:  [[0.15]]
grads:  [-0.09709388]
Stock Position:  -0.09709387562802513
Bond Position:  [-10.40615275]


portfolio before change:  [-19.86591907]
curr_Stock_Price:  97.37547179035411
curr_Factors:  [97.37547179]
mat_Sqrt:  [[0.15]]
grads:  [-0.07063373]
Stock Position:  -0.07063372769065011
Bond Position:  [-12.98792651]


portfolio before change:  [-19.92668294]
curr_Stock_Price:  98.14377736183314
curr_Factors:  [98.14377736]
mat_Sqrt:  [[0.15]]
grads:  [0.05945998]
Stock Position:  0.05945998060241
Bond Position:  [-25.76231004]


portfolio before change:  [-20.03001305]
curr_Stock_Price:  96.62265797707481
curr_Factors:  [96.62265798]
mat_Sqrt:  [[0.15]]
grads:  [-0.2235737]
Stock Position:  -0.22357370437574012
Bond Position:  [1.57227252]


portfolio before change:  [-19.92818865]
curr_Stock_Price:  96.17073514438422
curr_Factors:  [96.17073514]
mat_Sqrt:  [[0.15]]
grads:  [0.09070416]
Stock Position:  0.09070415677665598
Bond Position:  [-28.65127409]


portfolio before change:  [-19.95200726]
curr_Stock_Price:  96.06611608452734
curr_Factors:  [96.06611608]
mat_Sqrt:  [[0.15]]
grads:  [-0.09161427]
Stock Position:  -0.09161426774116302
Bond Position:  [-11.15098038]


portfolio before change:  [-19.99424812]
curr_Stock_Price:  96.46631548291731
curr_Factors:  [96.46631548]
mat_Sqrt:  [[0.15]]
grads:  [0.02084847]
Stock Position:  0.020848466413115108
Bond Position:  [-22.00542285]


portfolio before change:  [-19.97033472]
curr_Stock_Price:  98.14120425972865
curr_Factors:  [98.14120426]
mat_Sqrt:  [[0.15]]
grads:  [-0.0209605]
Stock Position:  -0.02096050075100904
Bond Position:  [-17.91324593]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.9850621]
Stock Price:  98.41641349131713
PL:  [-19.9850621]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.31708955e-02]
 [-1.45808940e-02]
 [-1.72382929e-02]
 [ 6.62918587e-03]
 [-3.63872967e-02]
 [ 1.30405293e-02]
 [-1.36430703e-02]
 [ 2.47449124e-03]
 [-1.56888994e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.63051586]
curr_Stock_Price:  99.83240158794815
curr_Factors:  [99.83240159]
mat_Sqrt:  [[0.15]]
grads:  [-0.08780597]
Stock Position:  -0.08780597028450912
Bond Position:  [6.13536503]


portfolio before change:  [-2.39992424]
curr_Stock_Price:  97.2411977489066
curr_Factors:  [97.24119775]
mat_Sqrt:  [[0.15]]
grads:  [-0.09720596]
Stock Position:  -0.09720596027952264
Bond Position:  [7.05249977]


portfolio before change:  [-2.33093838]
curr_Stock_Price:  96.56779537900012
curr_Factors:  [96.56779538]
mat_Sqrt:  [[0.15]]
grads:  [-0.11492195]
Stock Position:  -0.11492195258842451
Bond Position:  [8.76682122]


portfolio before change:  [-2.16164209]
curr_Stock_Price:  95.13280598763512
curr_Factors:  [95.13280599]
mat_Sqrt:  [[0.15]]
grads:  [0.04419457]
Stock Position:  0.044194572452949485
Bond Position:  [-6.36599578]


portfolio before change:  [-2.12975883]
curr_Stock_Price:  95.92627566918853
curr_Factors:  [95.92627567]
mat_Sqrt:  [[0.15]]
grads:  [-0.24258198]
Stock Position:  -0.242581977764629
Bond Position:  [21.14022684]


portfolio before change:  [-2.51745706]
curr_Stock_Price:  97.5680752287769
curr_Factors:  [97.56807523]
mat_Sqrt:  [[0.15]]
grads:  [0.08693686]
Stock Position:  0.08693686209117442
Bond Position:  [-10.99971936]


portfolio before change:  [-2.62857261]
curr_Stock_Price:  96.3532359519259
curr_Factors:  [96.35323595]
mat_Sqrt:  [[0.15]]
grads:  [-0.0909538]
Stock Position:  -0.0909538017834134
Bond Position:  [6.13512051]


portfolio before change:  [-2.56996303]
curr_Stock_Price:  95.74258244899349
curr_Factors:  [95.74258245]
mat_Sqrt:  [[0.15]]
grads:  [0.01649661]
Stock Position:  0.016496608281258558
Bond Position:  [-4.14939091]


portfolio before change:  [-2.59971626]
curr_Stock_Price:  94.06478173759393
curr_Factors:  [94.06478174]
mat_Sqrt:  [[0.15]]
grads:  [-0.10459266]
Stock Position:  -0.10459266258336145
Bond Position:  [7.23876971]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.32097694]
Stock Price:  91.43439618143921
PL:  [-2.32097694]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.33492274e-02]
 [-1.47093173e-02]
 [-1.75975010e-02]
 [ 5.80183946e-03]
 [-4.26319672e-02]
 [ 1.46963046e-02]
 [-1.40961006e-02]
 [-8.37703048e-04]
 [-1.16380548e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.89830648]
curr_Stock_Price:  100.17416153751206
curr_Factors:  [100.17416154]
mat_Sqrt:  [[0.15]]
grads:  [-0.08899485]
Stock Position:  -0.08899484923481296
Bond Position:  [13.81329088]


portfolio before change:  [5.1345479]
curr_Stock_Price:  97.59723659358065
curr_Factors:  [97.59723659]
mat_Sqrt:  [[0.15]]
grads:  [-0.09806212]
Stock Position:  -0.09806211561371514
Bond Position:  [14.7051394]


portfolio before change:  [5.24713407]
curr_Stock_Price:  96.52412329146313
curr_Factors:  [96.52412329]
mat_Sqrt:  [[0.15]]
grads:  [-0.11731667]
Stock Position:  -0.11731667305741825
Bond Position:  [16.57102308]


portfolio before change:  [5.19955594]
curr_Stock_Price:  97.00031911735087
curr_Factors:  [97.00031912]
mat_Sqrt:  [[0.15]]
grads:  [0.03867893]
Stock Position:  0.03867892971963966
Bond Position:  [1.44768741]


portfolio before change:  [5.09974448]
curr_Stock_Price:  94.40108785174036
curr_Factors:  [94.40108785]
mat_Sqrt:  [[0.15]]
grads:  [-0.28421311]
Stock Position:  -0.28421311439050534
Bond Position:  [31.92977166]


portfolio before change:  [5.00033478]
curr_Stock_Price:  94.80704581833025
curr_Factors:  [94.80704582]
mat_Sqrt:  [[0.15]]
grads:  [0.09797536]
Stock Position:  0.09797536424759562
Bond Position:  [-4.28842007]


portfolio before change:  [5.02896795]
curr_Stock_Price:  95.12118519401113
curr_Factors:  [95.12118519]
mat_Sqrt:  [[0.15]]
grads:  [-0.093974]
Stock Position:  -0.09397400382060493
Bond Position:  [13.96788658]


portfolio before change:  [5.32086623]
curr_Stock_Price:  92.08936176701951
curr_Factors:  [92.08936177]
mat_Sqrt:  [[0.15]]
grads:  [-0.00558469]
Stock Position:  -0.005584686989173104
Bond Position:  [5.83515649]


portfolio before change:  [5.30487387]
curr_Stock_Price:  95.4755263467514
curr_Factors:  [95.47552635]
mat_Sqrt:  [[0.15]]
grads:  [-0.07758703]
Stock Position:  -0.07758703167595157
Bond Position:  [12.71253656]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.14681065]
Stock Price:  97.59470878928421
PL:  [5.14681065]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.29992865e-02]
 [-1.00500003e-02]
 [ 1.04434817e-02]
 [ 1.08911411e-02]
 [ 9.52378558e-03]
 [ 4.81821834e-03]
 [-7.87996291e-03]
 [ 1.38994882e-03]
 [-4.41982871e-05]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-26.50990251]
curr_Stock_Price:  98.74843153037159
curr_Factors:  [98.74843153]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-17.95217483]


portfolio before change:  [-26.72671236]
curr_Stock_Price:  101.14661912640088
curr_Factors:  [101.14661913]
mat_Sqrt:  [[0.15]]
grads:  [-0.067]
Stock Position:  -0.06700000187407074
Bond Position:  [-19.94988869]


portfolio before change:  [-26.67841225]
curr_Stock_Price:  100.27680490817124
curr_Factors:  [100.27680491]
mat_Sqrt:  [[0.15]]
grads:  [0.06962321]
Stock Position:  0.06962321140249833
Bond Position:  [-33.66000543]


portfolio before change:  [-26.7607272]
curr_Stock_Price:  99.33630335827357
curr_Factors:  [99.33630336]
mat_Sqrt:  [[0.15]]
grads:  [0.07260761]
Stock Position:  0.07260760710578532
Bond Position:  [-33.97329848]


portfolio before change:  [-26.62048783]
curr_Stock_Price:  101.50178250083188
curr_Factors:  [101.5017825]
mat_Sqrt:  [[0.15]]
grads:  [0.0634919]
Stock Position:  0.06349190389122301
Bond Position:  [-33.06502925]


portfolio before change:  [-26.50669001]
curr_Stock_Price:  103.55455566388714
curr_Factors:  [103.55455566]
mat_Sqrt:  [[0.15]]
grads:  [0.03212146]
Stock Position:  0.03212145560474695
Bond Position:  [-29.83301307]


portfolio before change:  [-26.55592071]
curr_Stock_Price:  102.4864076504973
curr_Factors:  [102.48640765]
mat_Sqrt:  [[0.15]]
grads:  [-0.05253309]
Stock Position:  -0.05253308605989603
Bond Position:  [-21.17199344]


portfolio before change:  [-26.60818999]
curr_Stock_Price:  103.27982450634583
curr_Factors:  [103.27982451]
mat_Sqrt:  [[0.15]]
grads:  [0.00926633]
Stock Position:  0.00926632547818141
Bond Position:  [-27.56521446]


portfolio before change:  [-26.63251635]
curr_Stock_Price:  102.14234008755693
curr_Factors:  [102.14234009]
mat_Sqrt:  [[0.15]]
grads:  [-0.00029466]
Stock Position:  -0.00029465524755824664
Bond Position:  [-26.60241957]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-26.64593355]
Stock Price:  102.5247022832441
PL:  [-29.17063583]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.34588366e-02]
 [-1.32328171e-02]
 [ 1.93328756e-02]
 [ 9.98658308e-03]
 [ 9.15245551e-03]
 [ 1.32600641e-02]
 [-1.53204711e-02]
 [ 2.88518227e-03]
 [-7.30137342e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.37903726]
curr_Stock_Price:  100.33216425334895
curr_Factors:  [100.33216425]
mat_Sqrt:  [[0.15]]
grads:  [-0.08972558]
Stock Position:  -0.08972557751259368
Bond Position:  [17.38139864]


portfolio before change:  [8.41677093]
curr_Stock_Price:  100.00850182995075
curr_Factors:  [100.00850183]
mat_Sqrt:  [[0.15]]
grads:  [-0.08821878]
Stock Position:  -0.0882187805212676
Bond Position:  [17.239399]


portfolio before change:  [8.33989192]
curr_Stock_Price:  100.97769296977818
curr_Factors:  [100.97769297]
mat_Sqrt:  [[0.15]]
grads:  [0.12888584]
Stock Position:  0.12888583765025452
Bond Position:  [-4.67470262]


portfolio before change:  [8.06146807]
curr_Stock_Price:  98.83559633551938
curr_Factors:  [98.83559634]
mat_Sqrt:  [[0.15]]
grads:  [0.06657722]
Stock Position:  0.06657722053321379
Bond Position:  [1.48126878]


portfolio before change:  [8.11957874]
curr_Stock_Price:  99.69730023251378
curr_Factors:  [99.69730023]
mat_Sqrt:  [[0.15]]
grads:  [0.06101637]
Stock Position:  0.06101637008074879
Bond Position:  [2.03641137]


portfolio before change:  [8.13184637]
curr_Stock_Price:  99.88166332684655
curr_Factors:  [99.88166333]
mat_Sqrt:  [[0.15]]
grads:  [0.08840043]
Stock Position:  0.08840042730227551
Bond Position:  [-0.69773535]


portfolio before change:  [8.03573432]
curr_Stock_Price:  98.79837563676307
curr_Factors:  [98.79837564]
mat_Sqrt:  [[0.15]]
grads:  [-0.10213647]
Stock Position:  -0.10213647432195445
Bond Position:  [18.12665207]


portfolio before change:  [8.31064247]
curr_Stock_Price:  96.19555858359988
curr_Factors:  [96.19555858]
mat_Sqrt:  [[0.15]]
grads:  [0.01923455]
Stock Position:  0.01923454848510569
Bond Position:  [6.46036433]


portfolio before change:  [8.32617667]
curr_Stock_Price:  96.83519986196765
curr_Factors:  [96.83519986]
mat_Sqrt:  [[0.15]]
grads:  [-0.04867582]
Stock Position:  -0.04867582277116809
Bond Position:  [13.03970969]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.32171654]
Stock Price:  97.06080697689434
PL:  [8.32171654]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.36339692e-02]
 [-8.25134006e-03]
 [-1.39978239e-02]
 [ 4.79161970e-03]
 [ 8.13845217e-03]
 [ 4.82945715e-03]
 [-5.99096703e-03]
 [-1.64997706e-03]
 [ 3.02369834e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.12896547]
curr_Stock_Price:  100.59317388923628
curr_Factors:  [100.59317389]
mat_Sqrt:  [[0.15]]
grads:  [-0.09089313]
Stock Position:  -0.09089312796219831
Bond Position:  [23.2721937]


portfolio before change:  [14.05478734]
curr_Stock_Price:  101.53732820673399
curr_Factors:  [101.53732821]
mat_Sqrt:  [[0.15]]
grads:  [-0.05500893]
Stock Position:  -0.05500893374544338
Bond Position:  [19.6402475]


portfolio before change:  [13.9584123]
curr_Stock_Price:  103.46788035863256
curr_Factors:  [103.46788036]
mat_Sqrt:  [[0.15]]
grads:  [-0.09331883]
Stock Position:  -0.09331882567810704
Bond Position:  [23.61391339]


portfolio before change:  [14.0623597]
curr_Stock_Price:  102.48053953867604
curr_Factors:  [102.48053954]
mat_Sqrt:  [[0.15]]
grads:  [0.03194413]
Stock Position:  0.03194413131628426
Bond Position:  [10.78870789]


portfolio before change:  [14.05375195]
curr_Stock_Price:  102.04216639908154
curr_Factors:  [102.0421664]
mat_Sqrt:  [[0.15]]
grads:  [0.05425635]
Stock Position:  0.054256347777718573
Bond Position:  [8.51731668]


portfolio before change:  [14.13982856]
curr_Stock_Price:  103.55013533379548
curr_Factors:  [103.55013533]
mat_Sqrt:  [[0.15]]
grads:  [0.03219638]
Stock Position:  0.03219638101556493
Bond Position:  [10.80588895]


portfolio before change:  [14.20823573]
curr_Stock_Price:  105.50696613007071
curr_Factors:  [105.50696613]
mat_Sqrt:  [[0.15]]
grads:  [-0.03993978]
Stock Position:  -0.03993978017593352
Bond Position:  [18.42216076]


portfolio before change:  [14.14947037]
curr_Stock_Price:  107.20899705620249
curr_Factors:  [107.20899706]
mat_Sqrt:  [[0.15]]
grads:  [-0.01099985]
Stock Position:  -0.010999847094877438
Bond Position:  [15.32875295]


portfolio before change:  [14.14608748]
curr_Stock_Price:  108.21348247975372
curr_Factors:  [108.21348248]
mat_Sqrt:  [[0.15]]
grads:  [0.02015799]
Stock Position:  0.02015798890581275
Bond Position:  [11.9647213]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.17204221]
Stock Price:  109.20420022601589
PL:  [4.96784199]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.64507559e-02]
 [-6.78103477e-03]
 [ 5.47222859e-03]
 [ 6.13682132e-03]
 [ 9.27060878e-02]
 [-7.75895273e-03]
 [-6.17083814e-03]
 [-3.68406286e-03]
 [ 2.42637022e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [59.73685022]
curr_Stock_Price:  102.66347754308738
curr_Factors:  [102.66347754]
mat_Sqrt:  [[0.15]]
grads:  [-0.10967171]
Stock Position:  -0.10967170595855734
Bond Position:  [70.99612894]


portfolio before change:  [59.6899349]
curr_Stock_Price:  103.41501369920205
curr_Factors:  [103.4150137]
mat_Sqrt:  [[0.15]]
grads:  [-0.0452069]
Stock Position:  -0.04520689845339444
Bond Position:  [64.36500693]


portfolio before change:  [59.74873563]
curr_Stock_Price:  102.82638274519243
curr_Factors:  [102.82638275]
mat_Sqrt:  [[0.15]]
grads:  [0.03648152]
Stock Position:  0.03648152390534509
Bond Position:  [55.99747249]


portfolio before change:  [60.00123701]
curr_Stock_Price:  108.9800631279311
curr_Factors:  [108.98006313]
mat_Sqrt:  [[0.15]]
grads:  [0.04091214]
Stock Position:  0.04091214211827503
Bond Position:  [55.54262918]


portfolio before change:  [59.98038574]
curr_Stock_Price:  107.79143000963464
curr_Factors:  [107.79143001]
mat_Sqrt:  [[0.15]]
grads:  [0.61804059]
Stock Position:  0.6180405850797716
Bond Position:  [-6.63909273]


portfolio before change:  [61.43736815]
curr_Stock_Price:  110.15422432521228
curr_Factors:  [110.15422433]
mat_Sqrt:  [[0.15]]
grads:  [-0.05172635]
Stock Position:  -0.05172635153541789
Bond Position:  [67.13524428]


portfolio before change:  [61.50423378]
curr_Stock_Price:  109.51065254944163
curr_Factors:  [109.51065255]
mat_Sqrt:  [[0.15]]
grads:  [-0.04113892]
Stock Position:  -0.041138920911667536
Bond Position:  [66.00938386]


portfolio before change:  [61.49047646]
curr_Stock_Price:  110.64753853713947
curr_Factors:  [110.64753854]
mat_Sqrt:  [[0.15]]
grads:  [-0.02456042]
Stock Position:  -0.024560419035164736
Bond Position:  [64.20802637]


portfolio before change:  [61.52303815]
curr_Stock_Price:  110.62923091762704
curr_Factors:  [110.62923092]
mat_Sqrt:  [[0.15]]
grads:  [0.0161758]
Stock Position:  0.016175801496722937
Bond Position:  [59.73352167]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [61.58737956]
Stock Price:  112.76001775622218
PL:  [48.8273618]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.57719394e-02]
 [-1.37530825e-02]
 [ 1.57895436e-03]
 [ 6.51652063e-03]
 [ 9.46432860e-03]
 [ 1.34165031e-02]
 [-9.31576773e-03]
 [ 4.60223594e-03]
 [-5.24291716e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [48.08066654]
curr_Stock_Price:  102.1343620232457
curr_Factors:  [102.13436202]
mat_Sqrt:  [[0.15]]
grads:  [-0.10514626]
Stock Position:  -0.10514626282414472
Bond Position:  [58.81971302]


portfolio before change:  [48.43894382]
curr_Stock_Price:  99.006718134997
curr_Factors:  [99.00671813]
mat_Sqrt:  [[0.15]]
grads:  [-0.09168722]
Stock Position:  -0.09168721680142339
Bond Position:  [57.51659425]


portfolio before change:  [48.47662301]
curr_Stock_Price:  98.90949959867669
curr_Factors:  [98.9094996]
mat_Sqrt:  [[0.15]]
grads:  [0.01052636]
Stock Position:  0.010526362416415474
Bond Position:  [47.43546577]


portfolio before change:  [48.5254778]
curr_Stock_Price:  101.29694660523954
curr_Factors:  [101.29694661]
mat_Sqrt:  [[0.15]]
grads:  [0.04344347]
Stock Position:  0.043443470850493895
Bond Position:  [44.12478685]


portfolio before change:  [48.55733949]
curr_Stock_Price:  101.52238397664827
curr_Factors:  [101.52238398]
mat_Sqrt:  [[0.15]]
grads:  [0.06309552]
Stock Position:  0.06309552397189978
Bond Position:  [42.15173148]


portfolio before change:  [48.48089561]
curr_Stock_Price:  99.97671147224261
curr_Factors:  [99.97671147]
mat_Sqrt:  [[0.15]]
grads:  [0.08944335]
Stock Position:  0.08944335370984974
Bond Position:  [39.53864325]


portfolio before change:  [48.67828606]
curr_Stock_Price:  101.96250662270677
curr_Factors:  [101.96250662]
mat_Sqrt:  [[0.15]]
grads:  [-0.06210512]
Stock Position:  -0.06210511821640112
Bond Position:  [55.01067958]


portfolio before change:  [48.83675537]
curr_Stock_Price:  99.8538705502038
curr_Factors:  [99.85387055]
mat_Sqrt:  [[0.15]]
grads:  [0.03068157]
Stock Position:  0.030681572908249993
Bond Position:  [45.77308156]


portfolio before change:  [48.78692742]
curr_Stock_Price:  97.48371157495448
curr_Factors:  [97.48371157]
mat_Sqrt:  [[0.15]]
grads:  [-0.03495278]
Stock Position:  -0.03495278109500767
Bond Position:  [52.19425425]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [48.94031438]
Stock Price:  93.84213286650329
PL:  [48.94031438]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.35771535e-02]
 [-1.21871698e-02]
 [ 4.46209710e-03]
 [ 1.13005360e-02]
 [-6.76133098e-04]
 [ 1.28860809e-02]
 [-7.32164614e-03]
 [ 1.26974453e-04]
 [ 2.74783766e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.26359955]
curr_Stock_Price:  100.50849831369042
curr_Factors:  [100.50849831]
mat_Sqrt:  [[0.15]]
grads:  [-0.09051436]
Stock Position:  -0.09051435648135632
Bond Position:  [21.36106159]


portfolio before change:  [12.25398924]
curr_Stock_Price:  100.73270044030255
curr_Factors:  [100.73270044]
mat_Sqrt:  [[0.15]]
grads:  [-0.0812478]
Stock Position:  -0.08124779892175397
Bond Position:  [20.43829943]


portfolio before change:  [12.35992613]
curr_Stock_Price:  99.5546354136835
curr_Factors:  [99.55463541]
mat_Sqrt:  [[0.15]]
grads:  [0.02974731]
Stock Position:  0.02974731401375011
Bond Position:  [9.39844313]


portfolio before change:  [12.36487294]
curr_Stock_Price:  99.56291891073467
curr_Factors:  [99.56291891]
mat_Sqrt:  [[0.15]]
grads:  [0.07533691]
Stock Position:  0.07533690652160001
Bond Position:  [4.86411063]


portfolio before change:  [12.35207148]
curr_Stock_Price:  99.36070562712082
curr_Factors:  [99.36070563]
mat_Sqrt:  [[0.15]]
grads:  [-0.00450755]
Stock Position:  -0.004507553985022608
Bond Position:  [12.79994523]


portfolio before change:  [12.35374939]
curr_Stock_Price:  100.40865016716951
curr_Factors:  [100.40865017]
mat_Sqrt:  [[0.15]]
grads:  [0.08590721]
Stock Position:  0.08590720575507585
Bond Position:  [3.72792282]


portfolio before change:  [12.55303043]
curr_Stock_Price:  102.70667178339414
curr_Factors:  [102.70667178]
mat_Sqrt:  [[0.15]]
grads:  [-0.04881097]
Stock Position:  -0.04881097424528083
Bond Position:  [17.56624314]


portfolio before change:  [12.47056544]
curr_Stock_Price:  104.57613477028647
curr_Factors:  [104.57613477]
mat_Sqrt:  [[0.15]]
grads:  [0.0008465]
Stock Position:  0.0008464963539380067
Bond Position:  [12.38204212]


portfolio before change:  [12.47791825]
curr_Stock_Price:  105.94676894348673
curr_Factors:  [105.94676894]
mat_Sqrt:  [[0.15]]
grads:  [0.01831892]
Stock Position:  0.01831891773222073
Bond Position:  [10.5370881]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.49568208]
Stock Price:  106.62879465179034
PL:  [5.86688743]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.62524363e-02]
 [-1.46893791e-02]
 [-6.40255324e-05]
 [ 1.00829520e-02]
 [ 5.17086850e-03]
 [ 8.33060346e-03]
 [-1.17097406e-02]
 [ 4.39766278e-03]
 [ 3.72949850e-06]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [56.33143758]
curr_Stock_Price:  102.5088937850587
curr_Factors:  [102.50889379]
mat_Sqrt:  [[0.15]]
grads:  [-0.10834958]
Stock Position:  -0.10834957500561924
Bond Position:  [67.43823266]


portfolio before change:  [56.90333027]
curr_Stock_Price:  97.5419601949633
curr_Factors:  [97.54196019]
mat_Sqrt:  [[0.15]]
grads:  [-0.09792919]
Stock Position:  -0.09792919420853946
Bond Position:  [66.45553584]


portfolio before change:  [56.82748673]
curr_Stock_Price:  98.65582226164082
curr_Factors:  [98.65582226]
mat_Sqrt:  [[0.15]]
grads:  [-0.00042684]
Stock Position:  -0.00042683688241544154
Bond Position:  [56.86959668]


portfolio before change:  [56.85582914]
curr_Stock_Price:  98.88894018608819
curr_Factors:  [98.88894019]
mat_Sqrt:  [[0.15]]
grads:  [0.06721968]
Stock Position:  0.06721968014648193
Bond Position:  [50.20854621]


portfolio before change:  [56.92453941]
curr_Stock_Price:  99.5375556458746
curr_Factors:  [99.53755565]
mat_Sqrt:  [[0.15]]
grads:  [0.03447246]
Stock Position:  0.03447245663559917
Bond Position:  [53.49323534]


portfolio before change:  [57.0444814]
curr_Stock_Price:  102.24083489648227
curr_Factors:  [102.2408349]
mat_Sqrt:  [[0.15]]
grads:  [0.05553736]
Stock Position:  0.055537356367804186
Bond Position:  [51.36629571]


portfolio before change:  [57.00350979]
curr_Stock_Price:  101.04054063141255
curr_Factors:  [101.04054063]
mat_Sqrt:  [[0.15]]
grads:  [-0.07806494]
Stock Position:  -0.07806493763463256
Bond Position:  [64.8912333]


portfolio before change:  [57.10572925]
curr_Stock_Price:  100.14685224006746
curr_Factors:  [100.14685224]
mat_Sqrt:  [[0.15]]
grads:  [0.02931775]
Stock Position:  0.029317751847868924
Bond Position:  [54.16964869]


portfolio before change:  [57.19423445]
curr_Stock_Price:  102.24161031894259
curr_Factors:  [102.24161032]
mat_Sqrt:  [[0.15]]
grads:  [2.48633233e-05]
Stock Position:  2.4863323334319357e-05
Bond Position:  [57.19169238]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [57.22279339]
Stock Price:  100.46999127877349
PL:  [56.75280212]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.29992865e-02]
 [-1.38158776e-02]
 [-2.68863859e-02]
 [ 6.49984932e-03]
 [-4.05477801e-02]
 [ 1.61754059e-02]
 [-1.46538860e-02]
 [-7.46002794e-04]
 [-2.27924374e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-28.64160315]
curr_Stock_Price:  98.65166607784059
curr_Factors:  [98.65166608]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-20.09226134]


portfolio before change:  [-28.44156394]
curr_Stock_Price:  96.22744242512275
curr_Factors:  [96.22744243]
mat_Sqrt:  [[0.15]]
grads:  [-0.09210585]
Stock Position:  -0.09210585054269206
Bond Position:  [-19.57845351]


portfolio before change:  [-28.37466361]
curr_Stock_Price:  95.3947917650156
curr_Factors:  [95.39479177]
mat_Sqrt:  [[0.15]]
grads:  [-0.17924257]
Stock Position:  -0.17924257299005003
Bond Position:  [-11.27585569]


portfolio before change:  [-28.3856725]
curr_Stock_Price:  95.42474863962474
curr_Factors:  [95.42474864]
mat_Sqrt:  [[0.15]]
grads:  [0.04333233]
Stock Position:  0.04333232878709918
Bond Position:  [-32.52064908]


portfolio before change:  [-28.42423668]
curr_Stock_Price:  94.91012618187426
curr_Factors:  [94.91012618]
mat_Sqrt:  [[0.15]]
grads:  [-0.27031853]
Stock Position:  -0.27031853430851305
Bond Position:  [-2.76827048]


portfolio before change:  [-27.81939072]
curr_Stock_Price:  92.66747404874894
curr_Factors:  [92.66747405]
mat_Sqrt:  [[0.15]]
grads:  [0.10783604]
Stock Position:  0.10783603925302333
Bond Position:  [-37.81228409]


portfolio before change:  [-27.66656863]
curr_Stock_Price:  94.26001175763825
curr_Factors:  [94.26001176]
mat_Sqrt:  [[0.15]]
grads:  [-0.09769257]
Stock Position:  -0.09769257326336683
Bond Position:  [-18.45806553]


portfolio before change:  [-27.47362439]
curr_Stock_Price:  92.19050355892571
curr_Factors:  [92.19050356]
mat_Sqrt:  [[0.15]]
grads:  [-0.00497335]
Stock Position:  -0.004973351960254304
Bond Position:  [-27.01512857]


portfolio before change:  [-27.48363023]
curr_Stock_Price:  91.48572727411397
curr_Factors:  [91.48572727]
mat_Sqrt:  [[0.15]]
grads:  [-0.15194958]
Stock Position:  -0.15194958247060478
Bond Position:  [-13.58241217]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-27.57554356]
Stock Price:  92.04591584861679
PL:  [-27.57554356]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.29992865e-02]
 [-1.32316127e-02]
 [ 1.14778878e-02]
 [ 6.31241966e-03]
 [ 4.23954633e-02]
 [ 4.49128987e-03]
 [-6.35942177e-03]
 [ 1.24219996e-03]
 [ 2.87517893e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.35081444]
curr_Stock_Price:  99.48194985228886
curr_Factors:  [99.48194985]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-1.72951866]


portfolio before change:  [-10.39726578]
curr_Stock_Price:  100.00797519685885
curr_Factors:  [100.0079752]
mat_Sqrt:  [[0.15]]
grads:  [-0.08821075]
Stock Position:  -0.08821075110086263
Bond Position:  [-1.57548717]


portfolio before change:  [-10.42866163]
curr_Stock_Price:  100.35496134014434
curr_Factors:  [100.35496134]
mat_Sqrt:  [[0.15]]
grads:  [0.07651925]
Stock Position:  0.07651925221114622
Bond Position:  [-18.10774822]


portfolio before change:  [-10.36189966]
curr_Stock_Price:  101.34579826651958
curr_Factors:  [101.34579827]
mat_Sqrt:  [[0.15]]
grads:  [0.0420828]
Stock Position:  0.042082797736440566
Bond Position:  [-14.62681439]


portfolio before change:  [-10.23008413]
curr_Stock_Price:  104.65191807606509
curr_Factors:  [104.65191808]
mat_Sqrt:  [[0.15]]
grads:  [0.28263642]
Stock Position:  0.28263642215392804
Bond Position:  [-39.80852782]


portfolio before change:  [-10.52380542]
curr_Stock_Price:  103.68313970116071
curr_Factors:  [103.6831397]
mat_Sqrt:  [[0.15]]
grads:  [0.02994193]
Stock Position:  0.029941932442994115
Bond Position:  [-13.62827899]


portfolio before change:  [-10.5484923]
curr_Stock_Price:  103.08628336887001
curr_Factors:  [103.08628337]
mat_Sqrt:  [[0.15]]
grads:  [-0.04239615]
Stock Position:  -0.04239614515494407
Bond Position:  [-6.17803126]


portfolio before change:  [-10.56822043]
curr_Stock_Price:  103.47873282166343
curr_Factors:  [103.47873282]
mat_Sqrt:  [[0.15]]
grads:  [0.00828133]
Stock Position:  0.008281333075732063
Bond Position:  [-11.42516228]


portfolio before change:  [-10.5465084]
curr_Stock_Price:  106.79052356488742
curr_Factors:  [106.79052356]
mat_Sqrt:  [[0.15]]
grads:  [0.01916786]
Stock Position:  0.019167859530030043
Bond Position:  [-12.59345415]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.51376654]
Stock Price:  108.82727460477734
PL:  [-19.34104115]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.47025929e-02]
 [-8.03063797e-03]
 [ 1.63983028e-02]
 [ 4.90925459e-03]
 [ 1.90560047e-02]
 [ 1.18385578e-02]
 [-1.40890867e-02]
 [ 2.43180173e-03]
 [ 3.92096358e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [31.03915273]
curr_Stock_Price:  101.36078726696769
curr_Factors:  [101.36078727]
mat_Sqrt:  [[0.15]]
grads:  [-0.09801729]
Stock Position:  -0.09801728608292436
Bond Position:  [40.97426201]


portfolio before change:  [31.02488188]
curr_Stock_Price:  101.71545024400622
curr_Factors:  [101.71545024]
mat_Sqrt:  [[0.15]]
grads:  [-0.05353759]
Stock Position:  -0.05353758643731214
Bond Position:  [36.47048159]


portfolio before change:  [31.01260596]
curr_Stock_Price:  102.28543712431417
curr_Factors:  [102.28543712]
mat_Sqrt:  [[0.15]]
grads:  [0.10932202]
Stock Position:  0.1093220183572456
Bond Position:  [19.83055552]


portfolio before change:  [31.10382317]
curr_Stock_Price:  103.02910669340851
curr_Factors:  [103.02910669]
mat_Sqrt:  [[0.15]]
grads:  [0.03272836]
Stock Position:  0.032728363962307154
Bond Position:  [27.73184907]


portfolio before change:  [31.12463692]
curr_Stock_Price:  103.24128838280176
curr_Factors:  [103.24128838]
mat_Sqrt:  [[0.15]]
grads:  [0.12704003]
Stock Position:  0.1270400316304201
Bond Position:  [18.00886038]


portfolio before change:  [30.60842685]
curr_Stock_Price:  99.10702655988233
curr_Factors:  [99.10702656]
mat_Sqrt:  [[0.15]]
grads:  [0.07892372]
Stock Position:  0.07892371872462285
Bond Position:  [22.78653176]


portfolio before change:  [30.70711122]
curr_Stock_Price:  100.213009101983
curr_Factors:  [100.2130091]
mat_Sqrt:  [[0.15]]
grads:  [-0.09392724]
Stock Position:  -0.09392724468209197
Bond Position:  [40.11984305]


portfolio before change:  [30.531765]
curr_Stock_Price:  102.29346143433784
curr_Factors:  [102.29346143]
mat_Sqrt:  [[0.15]]
grads:  [0.01621201]
Stock Position:  0.01621201152428131
Bond Position:  [28.87338223]


portfolio before change:  [30.51891293]
curr_Stock_Price:  100.6099953122252
curr_Factors:  [100.60999531]
mat_Sqrt:  [[0.15]]
grads:  [0.00261398]
Stock Position:  0.002613975718239917
Bond Position:  [30.25592085]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [30.53986606]
Stock Price:  102.83701992417643
PL:  [27.70284614]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.29992865e-02]
 [-7.25590509e-03]
 [-4.42187494e-03]
 [ 5.51422568e-03]
 [ 5.08023558e-02]
 [ 6.66258989e-03]
 [-9.91172804e-03]
 [ 3.68458766e-03]
 [ 2.75422859e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.94402167]
curr_Stock_Price:  99.50041561902489
curr_Factors:  [99.50041562]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-1.32112561]


portfolio before change:  [-10.22796703]
curr_Stock_Price:  102.76926384680698
curr_Factors:  [102.76926385]
mat_Sqrt:  [[0.15]]
grads:  [-0.0483727]
Stock Position:  -0.0483727005864984
Bond Position:  [-5.2567402]


portfolio before change:  [-10.24912807]
curr_Stock_Price:  103.15237281724343
curr_Factors:  [103.15237282]
mat_Sqrt:  [[0.15]]
grads:  [-0.02947917]
Stock Position:  -0.02947916624600378
Bond Position:  [-7.20828212]


portfolio before change:  [-10.31802567]
curr_Stock_Price:  105.36724412172813
curr_Factors:  [105.36724412]
mat_Sqrt:  [[0.15]]
grads:  [0.0367615]
Stock Position:  0.03676150453280129
Bond Position:  [-14.19148409]


portfolio before change:  [-10.33274076]
curr_Stock_Price:  105.16002806802932
curr_Factors:  [105.16002807]
mat_Sqrt:  [[0.15]]
grads:  [0.33868237]
Stock Position:  0.3386823717862996
Bond Position:  [-45.94858849]


portfolio before change:  [-11.13641654]
curr_Stock_Price:  102.85493100913544
curr_Factors:  [102.85493101]
mat_Sqrt:  [[0.15]]
grads:  [0.04441727]
Stock Position:  0.044417265947758376
Bond Position:  [-15.70495136]


portfolio before change:  [-11.19262748]
curr_Stock_Price:  101.76624409369876
curr_Factors:  [101.76624409]
mat_Sqrt:  [[0.15]]
grads:  [-0.06607819]
Stock Position:  -0.06607818692968094
Bond Position:  [-4.46809858]


portfolio before change:  [-11.1499662]
curr_Stock_Price:  101.08680831835288
curr_Factors:  [101.08680832]
mat_Sqrt:  [[0.15]]
grads:  [0.02456392]
Stock Position:  0.024563917746451436
Bond Position:  [-13.63305424]


portfolio before change:  [-11.19229526]
curr_Stock_Price:  99.64115817138824
curr_Factors:  [99.64115817]
mat_Sqrt:  [[0.15]]
grads:  [0.00183615]
Stock Position:  0.0018361523914884191
Bond Position:  [-11.37525161]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.19933372]
Stock Price:  98.90624706609462
PL:  [-11.19933372]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.39836519e-02]
 [-6.87491752e-03]
 [-3.46379320e-02]
 [ 5.05874022e-03]
 [ 9.80350704e-03]
 [ 9.87995990e-03]
 [-5.93974844e-03]
 [ 3.28739703e-03]
 [-6.99478848e-05]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.82358807]
curr_Stock_Price:  100.85167300705102
curr_Factors:  [100.85167301]
mat_Sqrt:  [[0.15]]
grads:  [-0.09322435]
Stock Position:  -0.09322434614934555
Bond Position:  [29.22541935]


portfolio before change:  [19.61112662]
curr_Stock_Price:  103.28749392709315
curr_Factors:  [103.28749393]
mat_Sqrt:  [[0.15]]
grads:  [-0.04583278]
Stock Position:  -0.045832783468307534
Bond Position:  [24.34507997]


portfolio before change:  [19.58386608]
curr_Stock_Price:  104.14792886691933
curr_Factors:  [104.14792887]
mat_Sqrt:  [[0.15]]
grads:  [-0.23091955]
Stock Position:  -0.23091954664722536
Bond Position:  [43.6336586]


portfolio before change:  [19.73063407]
curr_Stock_Price:  103.60684990054733
curr_Factors:  [103.6068499]
mat_Sqrt:  [[0.15]]
grads:  [0.03372493]
Stock Position:  0.033724934796774166
Bond Position:  [16.23649981]


portfolio before change:  [19.66227173]
curr_Stock_Price:  101.33901392271831
curr_Factors:  [101.33901392]
mat_Sqrt:  [[0.15]]
grads:  [0.06535671]
Stock Position:  0.06535671361312888
Bond Position:  [13.03908682]


portfolio before change:  [19.68505661]
curr_Stock_Price:  101.5878591592322
curr_Factors:  [101.58785916]
mat_Sqrt:  [[0.15]]
grads:  [0.0658664]
Stock Position:  0.06586639933829185
Bond Position:  [12.99383011]


portfolio before change:  [19.87460123]
curr_Stock_Price:  104.36691004185435
curr_Factors:  [104.36691004]
mat_Sqrt:  [[0.15]]
grads:  [-0.03959832]
Stock Position:  -0.03959832294047484
Bond Position:  [24.00735583]


portfolio before change:  [19.99579416]
curr_Stock_Price:  101.60956458406207
curr_Factors:  [101.60956458]
mat_Sqrt:  [[0.15]]
grads:  [0.02191598]
Stock Position:  0.02191598022251263
Bond Position:  [17.76892095]


portfolio before change:  [20.01072301]
curr_Stock_Price:  101.88526141056403
curr_Factors:  [101.88526141]
mat_Sqrt:  [[0.15]]
grads:  [-0.00046632]
Stock Position:  -0.0004663192322681339
Bond Position:  [20.05823407]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.0200797]
Stock Price:  103.33261935005967
PL:  [16.68746035]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.31024877e-02]
 [-1.45404999e-02]
 [-8.76448537e-03]
 [ 6.18699895e-03]
 [-3.84319163e-02]
 [ 1.31797778e-02]
 [-1.51907197e-02]
 [ 2.29373680e-03]
 [-7.20531598e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-35.26509903]
curr_Stock_Price:  98.35100210701584
curr_Factors:  [98.35100211]
mat_Sqrt:  [[0.15]]
grads:  [-0.08734992]
Stock Position:  -0.08734991826118473
Bond Position:  [-26.67414703]


portfolio before change:  [-35.27549176]
curr_Stock_Price:  98.31725654660904
curr_Factors:  [98.31725655]
mat_Sqrt:  [[0.15]]
grads:  [-0.09693667]
Stock Position:  -0.0969366658368699
Bond Position:  [-25.74494472]


portfolio before change:  [-35.21864811]
curr_Stock_Price:  97.59803076098103
curr_Factors:  [97.59803076]
mat_Sqrt:  [[0.15]]
grads:  [-0.0584299]
Stock Position:  -0.058429902488403
Bond Position:  [-29.51600469]


portfolio before change:  [-35.14768693]
curr_Stock_Price:  96.13092462317582
curr_Factors:  [96.13092462]
mat_Sqrt:  [[0.15]]
grads:  [0.04124666]
Stock Position:  0.04124665968516129
Bond Position:  [-39.11276646]


portfolio before change:  [-35.19628682]
curr_Stock_Price:  95.42690121400146
curr_Factors:  [95.42690121]
mat_Sqrt:  [[0.15]]
grads:  [-0.25621278]
Stock Position:  -0.2562127751874329
Bond Position:  [-10.74669563]


portfolio before change:  [-35.71040356]
curr_Stock_Price:  97.41252449782262
curr_Factors:  [97.4125245]
mat_Sqrt:  [[0.15]]
grads:  [0.08786519]
Stock Position:  0.08786518536822203
Bond Position:  [-44.26957308]


portfolio before change:  [-35.64640829]
curr_Stock_Price:  98.3928399252059
curr_Factors:  [98.39283993]
mat_Sqrt:  [[0.15]]
grads:  [-0.10127146]
Stock Position:  -0.10127146455332482
Bond Position:  [-25.68202128]


portfolio before change:  [-35.37066706]
curr_Stock_Price:  95.54321737073192
curr_Factors:  [95.54321737]
mat_Sqrt:  [[0.15]]
grads:  [0.01529158]
Stock Position:  0.015291578653174978
Bond Position:  [-36.83167368]


portfolio before change:  [-35.36886828]
curr_Stock_Price:  96.8654625259318
curr_Factors:  [96.86546253]
mat_Sqrt:  [[0.15]]
grads:  [-0.04803544]
Stock Position:  -0.04803543989065076
Bond Position:  [-30.71589318]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-35.4236366]
Stock Price:  97.68582613970207
PL:  [-35.4236366]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.52496124e-02]
 [-6.75566712e-03]
 [-4.22032493e-02]
 [ 4.94203420e-03]
 [ 8.17890993e-03]
 [ 1.19166498e-02]
 [-1.53292761e-02]
 [ 4.19794070e-03]
 [ 4.64483735e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [39.57202694]
curr_Stock_Price:  101.74812469259136
curr_Factors:  [101.74812469]
mat_Sqrt:  [[0.15]]
grads:  [-0.10166408]
Stock Position:  -0.10166408292528871
Bond Position:  [49.91615673]


portfolio before change:  [39.30441425]
curr_Stock_Price:  104.62600446743566
curr_Factors:  [104.62600447]
mat_Sqrt:  [[0.15]]
grads:  [-0.04503778]
Stock Position:  -0.045037780815625574
Bond Position:  [44.01653731]


portfolio before change:  [39.33673331]
curr_Stock_Price:  104.39719028955894
curr_Factors:  [104.39719029]
mat_Sqrt:  [[0.15]]
grads:  [-0.281355]
Stock Position:  -0.28135499507046424
Bond Position:  [68.70940427]


portfolio before change:  [39.72036915]
curr_Stock_Price:  103.15579574805989
curr_Factors:  [103.15579575]
mat_Sqrt:  [[0.15]]
grads:  [0.03294689]
Stock Position:  0.032946894644021306
Bond Position:  [36.32170602]


portfolio before change:  [39.70106387]
curr_Stock_Price:  102.01849058320815
curr_Factors:  [102.01849058]
mat_Sqrt:  [[0.15]]
grads:  [0.05452607]
Stock Position:  0.05452606622359152
Bond Position:  [34.1383969]


portfolio before change:  [39.65094072]
curr_Stock_Price:  100.78611446787069
curr_Factors:  [100.78611447]
mat_Sqrt:  [[0.15]]
grads:  [0.07944433]
Stock Position:  0.0794443318413711
Bond Position:  [31.6440552]


portfolio before change:  [39.5110384]
curr_Stock_Price:  98.82589534563189
curr_Factors:  [98.82589535]
mat_Sqrt:  [[0.15]]
grads:  [-0.10219517]
Stock Position:  -0.10219517400319825
Bond Position:  [49.61056798]


portfolio before change:  [39.37211763]
curr_Stock_Price:  100.42804787727165
curr_Factors:  [100.42804788]
mat_Sqrt:  [[0.15]]
grads:  [0.02798627]
Stock Position:  0.027986271332285477
Bond Position:  [36.56151104]


portfolio before change:  [39.45728703]
curr_Stock_Price:  102.81793632940615
curr_Factors:  [102.81793633]
mat_Sqrt:  [[0.15]]
grads:  [0.00309656]
Stock Position:  0.0030965582364605284
Bond Position:  [39.1389053]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [39.47758004]
Stock Price:  103.05002274302898
PL:  [36.4275573]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.55300171e-02]
 [-8.02462085e-03]
 [ 1.21660604e-02]
 [ 8.90353183e-03]
 [-3.29229623e-02]
 [ 1.34233936e-02]
 [-1.40579723e-02]
 [ 3.09151501e-03]
 [-8.02201088e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [43.94601644]
curr_Stock_Price:  101.94667558992205
curr_Factors:  [101.94667559]
mat_Sqrt:  [[0.15]]
grads:  [-0.10353345]
Stock Position:  -0.10353344730253235
Bond Position:  [54.5009072]


portfolio before change:  [43.99636588]
curr_Stock_Price:  101.72363489096684
curr_Factors:  [101.72363489]
mat_Sqrt:  [[0.15]]
grads:  [-0.05349747]
Stock Position:  -0.0534974723534092
Bond Position:  [49.43832323]


portfolio before change:  [44.09153014]
curr_Stock_Price:  100.4069574641175
curr_Factors:  [100.40695746]
mat_Sqrt:  [[0.15]]
grads:  [0.08110707]
Stock Position:  0.08110706902619398
Bond Position:  [35.94781611]


portfolio before change:  [43.92492858]
curr_Stock_Price:  98.1312007065411
curr_Factors:  [98.13120071]
mat_Sqrt:  [[0.15]]
grads:  [0.05935688]
Stock Position:  0.05935687884842957
Bond Position:  [38.10016679]


portfolio before change:  [43.86332919]
curr_Stock_Price:  96.77239886250757
curr_Factors:  [96.77239886]
mat_Sqrt:  [[0.15]]
grads:  [-0.21948642]
Stock Position:  -0.21948641546048994
Bond Position:  [65.10355613]


portfolio before change:  [43.98189343]
curr_Stock_Price:  96.38055537033638
curr_Factors:  [96.38055537]
mat_Sqrt:  [[0.15]]
grads:  [0.08948929]
Stock Position:  0.08948929099261485
Bond Position:  [35.35686586]


portfolio before change:  [43.89495542]
curr_Stock_Price:  95.21146733431578
curr_Factors:  [95.21146733]
mat_Sqrt:  [[0.15]]
grads:  [-0.09371982]
Stock Position:  -0.09371981557020262
Bond Position:  [52.81815658]


portfolio before change:  [43.80781379]
curr_Stock_Price:  96.42313551741596
curr_Factors:  [96.42313552]
mat_Sqrt:  [[0.15]]
grads:  [0.0206101]
Stock Position:  0.020610100062684395
Bond Position:  [41.82052331]


portfolio before change:  [43.83254347]
curr_Stock_Price:  96.60819993143618
curr_Factors:  [96.60819993]
mat_Sqrt:  [[0.15]]
grads:  [-0.05348007]
Stock Position:  -0.053480072513912076
Bond Position:  [48.99915701]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [43.80733263]
Stock Price:  97.53782738923913
PL:  [43.80733263]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30204760e-02]
 [-1.42179745e-02]
 [-1.57088757e-02]
 [ 6.86172045e-03]
 [-4.66283575e-02]
 [ 1.58059353e-02]
 [-1.68870872e-02]
 [ 8.52815235e-04]
 [-1.29746578e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.34045858]
curr_Stock_Price:  99.02848447284934
curr_Factors:  [99.02848447]
mat_Sqrt:  [[0.15]]
grads:  [-0.08680317]
Stock Position:  -0.0868031735279729
Bond Position:  [-11.74447186]


portfolio before change:  [-20.14769268]
curr_Stock_Price:  96.74009344757228
curr_Factors:  [96.74009345]
mat_Sqrt:  [[0.15]]
grads:  [-0.0947865]
Stock Position:  -0.09478649678657766
Bond Position:  [-10.97803812]


portfolio before change:  [-20.15447659]
curr_Stock_Price:  96.75374009308537
curr_Factors:  [96.75374009]
mat_Sqrt:  [[0.15]]
grads:  [-0.10472584]
Stock Position:  -0.10472583790661144
Bond Position:  [-10.02186009]


portfolio before change:  [-19.93476611]
curr_Stock_Price:  94.60792139959905
curr_Factors:  [94.6079214]
mat_Sqrt:  [[0.15]]
grads:  [0.0457448]
Stock Position:  0.04574480298025406
Bond Position:  [-24.26258684]


portfolio before change:  [-20.0010122]
curr_Stock_Price:  93.42501619811596
curr_Factors:  [93.4250162]
mat_Sqrt:  [[0.15]]
grads:  [-0.31085572]
Stock Position:  -0.3108557166351715
Bond Position:  [9.04068816]


portfolio before change:  [-19.9271419]
curr_Stock_Price:  93.2019261242783
curr_Factors:  [93.20192612]
mat_Sqrt:  [[0.15]]
grads:  [0.1053729]
Stock Position:  0.10537290233109463
Bond Position:  [-29.74809936]


portfolio before change:  [-20.09988512]
curr_Stock_Price:  91.7037663559897
curr_Factors:  [91.70376636]
mat_Sqrt:  [[0.15]]
grads:  [-0.11258058]
Stock Position:  -0.11258058103921921
Bond Position:  [-9.77582182]


portfolio before change:  [-20.3580998]
curr_Stock_Price:  93.95393727668332
curr_Factors:  [93.95393728]
mat_Sqrt:  [[0.15]]
grads:  [0.00568543]
Stock Position:  0.005685434902465624
Bond Position:  [-20.89226879]


portfolio before change:  [-20.36231564]
curr_Stock_Price:  95.05023109332573
curr_Factors:  [95.05023109]
mat_Sqrt:  [[0.15]]
grads:  [-0.08649772]
Stock Position:  -0.08649771854353835
Bond Position:  [-12.1406875]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.50705831]
Stock Price:  96.65340411237847
PL:  [-20.50705831]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.29992865e-02]
 [-1.45060266e-02]
 [-4.79777521e-03]
 [ 4.85560307e-03]
 [ 5.66103755e-02]
 [ 9.41549392e-04]
 [-6.05588917e-03]
 [-2.57008207e-03]
 [ 2.70075488e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-24.73945339]
curr_Stock_Price:  98.8287984958819
curr_Factors:  [98.8287985]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-16.17476095]


portfolio before change:  [-24.70581297]
curr_Stock_Price:  98.3472741717711
curr_Factors:  [98.34727417]
mat_Sqrt:  [[0.15]]
grads:  [-0.09670684]
Stock Position:  -0.096706843999141
Bond Position:  [-15.19495847]


portfolio before change:  [-24.68759399]
curr_Stock_Price:  98.08029863785411
curr_Factors:  [98.08029864]
mat_Sqrt:  [[0.15]]
grads:  [-0.03198517]
Stock Position:  -0.03198516807289542
Bond Position:  [-21.55047915]


portfolio before change:  [-24.81943036]
curr_Stock_Price:  101.86512922928566
curr_Factors:  [101.86512923]
mat_Sqrt:  [[0.15]]
grads:  [0.03237069]
Stock Position:  0.03237068713290309
Bond Position:  [-28.11687459]


portfolio before change:  [-24.71547094]
curr_Stock_Price:  105.51106299537906
curr_Factors:  [105.511063]
mat_Sqrt:  [[0.15]]
grads:  [0.3774025]
Stock Position:  0.3774025035856977
Bond Position:  [-64.53561027]


portfolio before change:  [-24.88489731]
curr_Stock_Price:  105.14765656460384
curr_Factors:  [105.14765656]
mat_Sqrt:  [[0.15]]
grads:  [0.006277]
Stock Position:  0.006276995948617746
Bond Position:  [-25.54490872]


portfolio before change:  [-24.88634682]
curr_Stock_Price:  106.95204475994048
curr_Factors:  [106.95204476]
mat_Sqrt:  [[0.15]]
grads:  [-0.04037259]
Stock Position:  -0.04037259445505162
Bond Position:  [-20.56841529]


portfolio before change:  [-24.969803]
curr_Stock_Price:  108.76439812563962
curr_Factors:  [108.76439813]
mat_Sqrt:  [[0.15]]
grads:  [-0.01713388]
Stock Position:  -0.01713388043867605
Bond Position:  [-23.10624681]


portfolio before change:  [-24.99429768]
curr_Stock_Price:  109.51954883154303
curr_Factors:  [109.51954883]
mat_Sqrt:  [[0.15]]
grads:  [0.01800503]
Stock Position:  0.018005032538340085
Bond Position:  [-26.96620072]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-24.95755607]
Stock Price:  112.30921766587124
PL:  [-37.26677374]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.36946838e-02]
 [-7.70360622e-03]
 [ 2.16909889e-02]
 [ 5.09692798e-03]
 [ 3.39514754e-02]
 [ 5.63497002e-03]
 [-5.99861170e-03]
 [-2.61923954e-03]
 [ 2.41666780e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.3015356]
curr_Stock_Price:  100.64640100608413
curr_Factors:  [100.64640101]
mat_Sqrt:  [[0.15]]
grads:  [-0.09129789]
Stock Position:  -0.09129789167518211
Bond Position:  [24.49033981]


portfolio before change:  [15.17556913]
curr_Stock_Price:  102.16028808801491
curr_Factors:  [102.16028809]
mat_Sqrt:  [[0.15]]
grads:  [-0.05135737]
Stock Position:  -0.05135737479426586
Bond Position:  [20.42225333]


portfolio before change:  [15.23857183]
curr_Stock_Price:  101.13241198968004
curr_Factors:  [101.13241199]
mat_Sqrt:  [[0.15]]
grads:  [0.14460659]
Stock Position:  0.1446065926479899
Bond Position:  [0.61415832]


portfolio before change:  [15.61804164]
curr_Stock_Price:  103.75444081297809
curr_Factors:  [103.75444081]
mat_Sqrt:  [[0.15]]
grads:  [0.03397952]
Stock Position:  0.03397951987357545
Bond Position:  [12.09251555]


portfolio before change:  [15.63724374]
curr_Stock_Price:  104.14156604476145
curr_Factors:  [104.14156604]
mat_Sqrt:  [[0.15]]
grads:  [0.22634317]
Stock Position:  0.22634316932760729
Bond Position:  [-7.93448838]


portfolio before change:  [15.42770011]
curr_Stock_Price:  103.23331956216724
curr_Factors:  [103.23331956]
mat_Sqrt:  [[0.15]]
grads:  [0.03756647]
Stock Position:  0.037566466812476655
Bond Position:  [11.54958904]


portfolio before change:  [15.52528153]
curr_Stock_Price:  105.67712624636941
curr_Factors:  [105.67712625]
mat_Sqrt:  [[0.15]]
grads:  [-0.03999074]
Stock Position:  -0.039990744688554646
Bond Position:  [19.75138851]


portfolio before change:  [15.40837421]
curr_Stock_Price:  108.8474968917564
curr_Factors:  [108.84749689]
mat_Sqrt:  [[0.15]]
grads:  [-0.0174616]
Stock Position:  -0.017461596943572973
Bond Position:  [17.30902533]


portfolio before change:  [15.38523379]
curr_Stock_Price:  110.66847001905306
curr_Factors:  [110.66847002]
mat_Sqrt:  [[0.15]]
grads:  [0.01611112]
Stock Position:  0.016111118662536634
Bond Position:  [13.60224094]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.400523]
Stock Price:  111.1952108474915
PL:  [4.20531215]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.59105858e-02]
 [-1.36297345e-02]
 [ 1.67547589e-02]
 [ 1.08246634e-02]
 [ 1.48275374e-02]
 [ 8.00893018e-03]
 [-1.13639257e-02]
 [ 4.33528967e-03]
 [ 2.73286506e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [50.46140884]
curr_Stock_Price:  102.24243236018782
curr_Factors:  [102.24243236]
mat_Sqrt:  [[0.15]]
grads:  [-0.10607057]
Stock Position:  -0.10607057168678165
Bond Position:  [61.30632209]


portfolio before change:  [50.82382484]
curr_Stock_Price:  99.1147488540617
curr_Factors:  [99.11474885]
mat_Sqrt:  [[0.15]]
grads:  [-0.0908649]
Stock Position:  -0.09086489683817256
Bond Position:  [59.82987627]


portfolio before change:  [50.70413041]
curr_Stock_Price:  100.76133463133655
curr_Factors:  [100.76133463]
mat_Sqrt:  [[0.15]]
grads:  [0.11169839]
Stock Position:  0.11169839262834219
Bond Position:  [39.4492513]


portfolio before change:  [50.560576]
curr_Stock_Price:  99.2995054447837
curr_Factors:  [99.29950544]
mat_Sqrt:  [[0.15]]
grads:  [0.07216442]
Stock Position:  0.07216442250216754
Bond Position:  [43.39468454]


portfolio before change:  [50.64732975]
curr_Stock_Price:  100.20093276013291
curr_Factors:  [100.20093276]
mat_Sqrt:  [[0.15]]
grads:  [0.09885025]
Stock Position:  0.09885024922312453
Bond Position:  [40.74244257]


portfolio before change:  [50.8849251]
curr_Stock_Price:  102.3983883915955
curr_Factors:  [102.39838839]
mat_Sqrt:  [[0.15]]
grads:  [0.05339287]
Stock Position:  0.05339286786819147
Bond Position:  [45.41758148]


portfolio before change:  [50.8454126]
curr_Stock_Price:  101.23293361525685
curr_Factors:  [101.23293362]
mat_Sqrt:  [[0.15]]
grads:  [-0.0757595]
Stock Position:  -0.07575950450431505
Bond Position:  [58.51476949]


portfolio before change:  [50.95030529]
curr_Stock_Price:  100.23466949352643
curr_Factors:  [100.23466949]
mat_Sqrt:  [[0.15]]
grads:  [0.02890193]
Stock Position:  0.028901931164890954
Bond Position:  [48.05332978]


portfolio before change:  [50.95937347]
curr_Stock_Price:  99.71690151500015
curr_Factors:  [99.71690152]
mat_Sqrt:  [[0.15]]
grads:  [0.00182191]
Stock Position:  0.0018219100419739052
Bond Position:  [50.77769825]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [50.9791359]
Stock Price:  96.62521805846822
PL:  [50.9791359]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.44159669e-02]
 [-1.47950447e-02]
 [-2.10816629e-02]
 [ 8.88641602e-03]
 [-1.92133255e-02]
 [ 1.29959347e-02]
 [-1.44570032e-02]
 [ 1.92301713e-03]
 [-8.79188449e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-66.07053163]
curr_Stock_Price:  96.95263425834611
curr_Factors:  [96.95263426]
mat_Sqrt:  [[0.15]]
grads:  [-0.09610645]
Stock Position:  -0.0961064458061844
Bond Position:  [-56.75275854]


portfolio before change:  [-66.19448464]
curr_Stock_Price:  97.94704764489855
curr_Factors:  [97.94704764]
mat_Sqrt:  [[0.15]]
grads:  [-0.09863363]
Stock Position:  -0.0986336311068921
Bond Position:  [-56.53361167]


portfolio before change:  [-66.04062909]
curr_Stock_Price:  96.10052305157276
curr_Factors:  [96.10052305]
mat_Sqrt:  [[0.15]]
grads:  [-0.14054442]
Stock Position:  -0.1405444192529094
Bond Position:  [-52.53423688]


portfolio before change:  [-66.35034696]
curr_Stock_Price:  98.11728179822583
curr_Factors:  [98.1172818]
mat_Sqrt:  [[0.15]]
grads:  [0.05924277]
Stock Position:  0.059242773481981044
Bond Position:  [-72.16308686]


portfolio before change:  [-66.36156602]
curr_Stock_Price:  98.53710518314216
curr_Factors:  [98.53710518]
mat_Sqrt:  [[0.15]]
grads:  [-0.12808884]
Stock Position:  -0.1280888366285586
Bond Position:  [-53.74006286]


portfolio before change:  [-66.27070165]
curr_Stock_Price:  97.61789064155718
curr_Factors:  [97.61789064]
mat_Sqrt:  [[0.15]]
grads:  [0.08663956]
Stock Position:  0.08663956482387161
Bond Position:  [-74.72827322]


portfolio before change:  [-66.32445399]
curr_Stock_Price:  97.42884473230406
curr_Factors:  [97.42884473]
mat_Sqrt:  [[0.15]]
grads:  [-0.09638002]
Stock Position:  -0.0963800215830669
Bond Position:  [-56.93425983]


portfolio before change:  [-66.13178267]
curr_Stock_Price:  95.13432808225937
curr_Factors:  [95.13432808]
mat_Sqrt:  [[0.15]]
grads:  [0.01282011]
Stock Position:  0.012820114184513204
Bond Position:  [-67.35141562]


portfolio before change:  [-66.14966319]
curr_Stock_Price:  96.36704812656772
curr_Factors:  [96.36704813]
mat_Sqrt:  [[0.15]]
grads:  [-0.05861256]
Stock Position:  -0.05861256327773073
Bond Position:  [-60.50134348]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-66.06044704]
Stock Price:  94.32867313324634
PL:  [-66.06044704]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.67480698e-02]
 [-9.90676599e-03]
 [ 4.40043297e-03]
 [ 1.15733708e-02]
 [ 9.69239177e-03]
 [ 1.10470864e-02]
 [-1.55404794e-02]
 [ 4.53761438e-03]
 [-3.26867699e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [64.84212696]
curr_Stock_Price:  102.89522416225827
curr_Factors:  [102.89522416]
mat_Sqrt:  [[0.15]]
grads:  [-0.1116538]
Stock Position:  -0.11165379891807599
Bond Position:  [76.33076963]


portfolio before change:  [65.07244289]
curr_Stock_Price:  101.17436018749954
curr_Factors:  [101.17436019]
mat_Sqrt:  [[0.15]]
grads:  [-0.06604511]
Stock Position:  -0.06604510657290247
Bond Position:  [71.75451429]


portfolio before change:  [65.21823987]
curr_Stock_Price:  99.51018314136302
curr_Factors:  [99.51018314]
mat_Sqrt:  [[0.15]]
grads:  [0.02933622]
Stock Position:  0.029336219792566662
Bond Position:  [62.29898726]


portfolio before change:  [65.2716058]
curr_Stock_Price:  100.26722188318561
curr_Factors:  [100.26722188]
mat_Sqrt:  [[0.15]]
grads:  [0.07715581]
Stock Position:  0.07715580512771118
Bond Position:  [57.53540757]


portfolio before change:  [65.37723241]
curr_Stock_Price:  101.26328050935014
curr_Factors:  [101.26328051]
mat_Sqrt:  [[0.15]]
grads:  [0.06461595]
Stock Position:  0.06461594513817821
Bond Position:  [58.83400983]


portfolio before change:  [65.3981617]
curr_Stock_Price:  101.13181043543948
curr_Factors:  [101.13181044]
mat_Sqrt:  [[0.15]]
grads:  [0.07364724]
Stock Position:  0.07364724233520581
Bond Position:  [57.95008275]


portfolio before change:  [65.28740212]
curr_Stock_Price:  99.2343617044058
curr_Factors:  [99.2343617]
mat_Sqrt:  [[0.15]]
grads:  [-0.1036032]
Stock Position:  -0.10360319630835226
Bond Position:  [75.56839918]


portfolio before change:  [65.2511351]
curr_Stock_Price:  99.94921098253214
curr_Factors:  [99.94921098]
mat_Sqrt:  [[0.15]]
grads:  [0.03025076]
Stock Position:  0.030250762502812795
Bond Position:  [62.22759526]


portfolio before change:  [65.22639154]
curr_Stock_Price:  98.10247618475775
curr_Factors:  [98.10247618]
mat_Sqrt:  [[0.15]]
grads:  [-0.02179118]
Stock Position:  -0.021791179956695234
Bond Position:  [67.36416025]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [65.222286]
Stock Price:  99.83694138561316
PL:  [65.222286]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.38153386e-02]
 [-6.95077310e-03]
 [ 2.16739295e-02]
 [ 8.58881494e-03]
 [-1.42623006e-02]
 [ 1.19345227e-02]
 [-1.47756289e-02]
 [ 4.18444896e-03]
 [ 1.99057980e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.1743802]
curr_Stock_Price:  100.73141606523536
curr_Factors:  [100.73141607]
mat_Sqrt:  [[0.15]]
grads:  [-0.09210226]
Stock Position:  -0.09210225707241089
Bond Position:  [26.45197097]


portfolio before change:  [16.96169214]
curr_Stock_Price:  103.18431301731113
curr_Factors:  [103.18431302]
mat_Sqrt:  [[0.15]]
grads:  [-0.04633849]
Stock Position:  -0.04633848734192549
Bond Position:  [21.74309713]


portfolio before change:  [17.06769555]
curr_Stock_Price:  101.13139443223437
curr_Factors:  [101.13139443]
mat_Sqrt:  [[0.15]]
grads:  [0.14449286]
Stock Position:  0.14449286315733492
Bond Position:  [2.45493082]


portfolio before change:  [17.02650906]
curr_Stock_Price:  100.83785558468838
curr_Factors:  [100.83785558]
mat_Sqrt:  [[0.15]]
grads:  [0.05725877]
Stock Position:  0.057258766272026036
Bond Position:  [11.25265785]


portfolio before change:  [16.9235882]
curr_Stock_Price:  98.94210058995886
curr_Factors:  [98.94210059]
mat_Sqrt:  [[0.15]]
grads:  [-0.095082]
Stock Position:  -0.09508200401824622
Bond Position:  [26.33120141]


portfolio before change:  [16.96229772]
curr_Stock_Price:  98.67348379000747
curr_Factors:  [98.67348379]
mat_Sqrt:  [[0.15]]
grads:  [0.07956348]
Stock Position:  0.07956348469984151
Bond Position:  [9.1114915]


portfolio before change:  [17.05053659]
curr_Stock_Price:  99.72524759627805
curr_Factors:  [99.7252476]
mat_Sqrt:  [[0.15]]
grads:  [-0.09850419]
Stock Position:  -0.09850419251192169
Bond Position:  [26.87389158]


portfolio before change:  [16.99303067]
curr_Stock_Price:  100.44548322448013
curr_Factors:  [100.44548322]
mat_Sqrt:  [[0.15]]
grads:  [0.02789633]
Stock Position:  0.027896326376377335
Bond Position:  [14.19097069]


portfolio before change:  [17.05630937]
curr_Stock_Price:  102.45942017949055
curr_Factors:  [102.45942018]
mat_Sqrt:  [[0.15]]
grads:  [0.00132705]
Stock Position:  0.0013270531991241199
Bond Position:  [16.92034027]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.06162213]
Stock Price:  100.08609775473799
PL:  [16.97552438]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.33542206e-02]
 [-1.28479693e-02]
 [ 2.21392666e-04]
 [ 9.27764012e-03]
 [ 9.12760128e-03]
 [ 9.06455494e-03]
 [-1.02000914e-02]
 [ 1.36500224e-03]
 [ 7.92440504e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.16174421]
curr_Stock_Price:  100.18611991057192
curr_Factors:  [100.18611991]
mat_Sqrt:  [[0.15]]
grads:  [-0.08902814]
Stock Position:  -0.08902813700377961
Bond Position:  [14.08112782]


portfolio before change:  [5.20850889]
curr_Stock_Price:  99.73994238761969
curr_Factors:  [99.73994239]
mat_Sqrt:  [[0.15]]
grads:  [-0.08565313]
Stock Position:  -0.08565312846355667
Bond Position:  [13.75154699]


portfolio before change:  [5.30527243]
curr_Stock_Price:  98.69052306479165
curr_Factors:  [98.69052306]
mat_Sqrt:  [[0.15]]
grads:  [0.00147595]
Stock Position:  0.0014759511060331392
Bond Position:  [5.15961004]


portfolio before change:  [5.31081704]
curr_Stock_Price:  100.69882987196077
curr_Factors:  [100.69882987]
mat_Sqrt:  [[0.15]]
grads:  [0.06185093]
Stock Position:  0.06185093413487585
Bond Position:  [-0.91749965]


portfolio before change:  [5.36851216]
curr_Stock_Price:  101.63905789457516
curr_Factors:  [101.63905789]
mat_Sqrt:  [[0.15]]
grads:  [0.06085068]
Stock Position:  0.06085067517625357
Bond Position:  [-0.81629314]


portfolio before change:  [5.38437639]
curr_Stock_Price:  101.90647449845635
curr_Factors:  [101.9064745]
mat_Sqrt:  [[0.15]]
grads:  [0.06043037]
Stock Position:  0.06043036629714131
Bond Position:  [-0.77386919]


portfolio before change:  [5.36979793]
curr_Stock_Price:  101.67163507489771
curr_Factors:  [101.67163507]
mat_Sqrt:  [[0.15]]
grads:  [-0.06800061]
Stock Position:  -0.06800060950626377
Bond Position:  [12.28353108]


portfolio before change:  [5.26457716]
curr_Stock_Price:  103.30932735943497
curr_Factors:  [103.30932736]
mat_Sqrt:  [[0.15]]
grads:  [0.00910001]
Stock Position:  0.009100014936667143
Bond Position:  [4.32446073]


portfolio before change:  [5.26694804]
curr_Stock_Price:  103.33219698483447
curr_Factors:  [103.33219698]
mat_Sqrt:  [[0.15]]
grads:  [0.00528294]
Stock Position:  0.00528293669135577
Bond Position:  [4.72105059]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.27907352]
Stock Price:  105.18047950780856
PL:  [0.09859401]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.31284506e-02]
 [-1.37642596e-02]
 [-1.66823546e-02]
 [ 8.76428166e-03]
 [ 5.02940298e-03]
 [ 1.33785216e-02]
 [-9.14929620e-03]
 [ 2.21012042e-03]
 [ 3.94460946e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-36.00789997]
curr_Stock_Price:  98.31728373774446
curr_Factors:  [98.31728374]
mat_Sqrt:  [[0.15]]
grads:  [-0.087523]
Stock Position:  -0.08752300397152528
Bond Position:  [-27.40287595]


portfolio before change:  [-35.83293575]
curr_Stock_Price:  96.1616324260331
curr_Factors:  [96.16163243]
mat_Sqrt:  [[0.15]]
grads:  [-0.09176173]
Stock Position:  -0.09176173082158653
Bond Position:  [-27.00897792]


portfolio before change:  [-35.88991604]
curr_Stock_Price:  96.63538568852448
curr_Factors:  [96.63538569]
mat_Sqrt:  [[0.15]]
grads:  [-0.1112157]
Stock Position:  -0.11121569747555365
Bond Position:  [-25.14254422]


portfolio before change:  [-36.05625439]
curr_Stock_Price:  98.01795973965277
curr_Factors:  [98.01795974]
mat_Sqrt:  [[0.15]]
grads:  [0.05842854]
Stock Position:  0.05842854440357909
Bond Position:  [-41.7833011]


portfolio before change:  [-35.9886222]
curr_Stock_Price:  99.5331278293717
curr_Factors:  [99.53312783]
mat_Sqrt:  [[0.15]]
grads:  [0.03352935]
Stock Position:  0.033529353213703046
Bond Position:  [-39.3259036]


portfolio before change:  [-35.99419074]
curr_Stock_Price:  99.95363493958551
curr_Factors:  [99.95363494]
mat_Sqrt:  [[0.15]]
grads:  [0.08919014]
Stock Position:  0.08919014387389712
Bond Position:  [-44.90906982]


portfolio before change:  [-35.83211191]
curr_Stock_Price:  102.02268618753337
curr_Factors:  [102.02268619]
mat_Sqrt:  [[0.15]]
grads:  [-0.06099531]
Stock Position:  -0.0609953079791288
Bond Position:  [-29.60920674]


portfolio before change:  [-35.87397589]
curr_Stock_Price:  102.46625593747078
curr_Factors:  [102.46625594]
mat_Sqrt:  [[0.15]]
grads:  [0.01473414]
Stock Position:  0.014734136120078973
Bond Position:  [-37.38372765]


portfolio before change:  [-35.91952082]
curr_Stock_Price:  100.64406579770043
curr_Factors:  [100.6440658]
mat_Sqrt:  [[0.15]]
grads:  [0.00262974]
Stock Position:  0.0026297396400890597
Bond Position:  [-36.18418851]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-35.93335209]
Stock Price:  102.26603384443692
PL:  [-38.19938593]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30402205e-02]
 [-7.83521517e-03]
 [ 2.00342592e-02]
 [ 6.25571125e-03]
 [ 8.20748272e-03]
 [ 1.28894741e-02]
 [-7.86556932e-03]
 [ 3.38542389e-03]
 [ 4.98553758e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.86577521]
curr_Stock_Price:  99.09542558136768
curr_Factors:  [99.09542558]
mat_Sqrt:  [[0.15]]
grads:  [-0.0869348]
Stock Position:  -0.08693480343096585
Bond Position:  [-10.25093387]


portfolio before change:  [-19.12178227]
curr_Stock_Price:  101.98126986789767
curr_Factors:  [101.98126987]
mat_Sqrt:  [[0.15]]
grads:  [-0.05223477]
Stock Position:  -0.05223476778830572
Bond Position:  [-13.79481432]


portfolio before change:  [-19.07917965]
curr_Stock_Price:  101.03359167600226
curr_Factors:  [101.03359168]
mat_Sqrt:  [[0.15]]
grads:  [0.13356173]
Stock Position:  0.13356172831242158
Bond Position:  [-32.57340077]


portfolio before change:  [-19.60297953]
curr_Stock_Price:  97.23378227420656
curr_Factors:  [97.23378227]
mat_Sqrt:  [[0.15]]
grads:  [0.04170474]
Stock Position:  0.0417047416409515
Bond Position:  [-23.6580893]


portfolio before change:  [-19.51396568]
curr_Stock_Price:  99.65187315072427
curr_Factors:  [99.65187315]
mat_Sqrt:  [[0.15]]
grads:  [0.05471655]
Stock Position:  0.05471655143696054
Bond Position:  [-24.96657252]


portfolio before change:  [-19.52619877]
curr_Stock_Price:  99.65650270930074
curr_Factors:  [99.65650271]
mat_Sqrt:  [[0.15]]
grads:  [0.08592983]
Stock Position:  0.08592982723947865
Bond Position:  [-28.08966483]


portfolio before change:  [-19.29658592]
curr_Stock_Price:  102.49208613342923
curr_Factors:  [102.49208613]
mat_Sqrt:  [[0.15]]
grads:  [-0.05243713]
Stock Position:  -0.05243712877383222
Bond Position:  [-13.9221952]


portfolio before change:  [-19.25343966]
curr_Stock_Price:  101.53648273999087
curr_Factors:  [101.53648274]
mat_Sqrt:  [[0.15]]
grads:  [0.02256949]
Stock Position:  0.022569492595781813
Bond Position:  [-21.54506656]


portfolio before change:  [-19.23408737]
curr_Stock_Price:  102.8713606635643
curr_Factors:  [102.87136066]
mat_Sqrt:  [[0.15]]
grads:  [0.00332369]
Stock Position:  0.003323691718163939
Bond Position:  [-19.57600006]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.24717286]
Stock Price:  101.87998116302532
PL:  [-21.12715402]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.32700115e-02]
 [-1.28397726e-02]
 [ 7.05541479e-03]
 [ 1.20395438e-02]
 [-2.35578894e-02]
 [ 1.32858274e-02]
 [-1.41988415e-02]
 [ 2.98835272e-03]
 [-1.46885977e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.17209283]
curr_Stock_Price:  100.00501548359375
curr_Factors:  [100.00501548]
mat_Sqrt:  [[0.15]]
grads:  [-0.08846674]
Stock Position:  -0.08846674342311885
Bond Position:  [10.01921088]


portfolio before change:  [1.20216749]
curr_Stock_Price:  99.72170225818846
curr_Factors:  [99.72170226]
mat_Sqrt:  [[0.15]]
grads:  [-0.08559848]
Stock Position:  -0.08559848404745891
Bond Position:  [9.73819403]


portfolio before change:  [1.18143434]
curr_Stock_Price:  100.02081336269069
curr_Factors:  [100.02081336]
mat_Sqrt:  [[0.15]]
grads:  [0.0470361]
Stock Position:  0.04703609861169978
Bond Position:  [-3.5231545]


portfolio before change:  [1.18070665]
curr_Stock_Price:  100.04280333945458
curr_Factors:  [100.04280334]
mat_Sqrt:  [[0.15]]
grads:  [0.08026363]
Stock Position:  0.08026362541367264
Bond Position:  [-6.84909144]


portfolio before change:  [1.02721235]
curr_Stock_Price:  98.17310340898011
curr_Factors:  [98.17310341]
mat_Sqrt:  [[0.15]]
grads:  [-0.1570526]
Stock Position:  -0.15705259630761237
Bond Position:  [16.44555313]


portfolio before change:  [1.23764539]
curr_Stock_Price:  96.88558441814686
curr_Factors:  [96.88558442]
mat_Sqrt:  [[0.15]]
grads:  [0.08857218]
Stock Position:  0.08857218250672756
Bond Position:  [-7.34372228]


portfolio before change:  [1.05614847]
curr_Stock_Price:  94.87790966022372
curr_Factors:  [94.87790966]
mat_Sqrt:  [[0.15]]
grads:  [-0.09465894]
Stock Position:  -0.09465894307980316
Bond Position:  [10.03719112]


portfolio before change:  [0.92566955]
curr_Stock_Price:  96.30935154667748
curr_Factors:  [96.30935155]
mat_Sqrt:  [[0.15]]
grads:  [0.01992235]
Stock Position:  0.01992235145025706
Bond Position:  [-0.9930392]


portfolio before change:  [0.88769111]
curr_Stock_Price:  94.42795746851876
curr_Factors:  [94.42795747]
mat_Sqrt:  [[0.15]]
grads:  [-0.09792398]
Stock Position:  -0.09792398449302352
Bond Position:  [10.13445295]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.8270304]
Stock Price:  95.09918428559855
PL:  [0.8270304]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30190380e-02]
 [-1.34089132e-02]
 [ 6.58123696e-03]
 [ 1.01523519e-02]
 [ 1.20420524e-02]
 [ 1.03458811e-02]
 [-5.97037185e-03]
 [ 4.32721420e-03]
 [-5.58949277e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.24532407]
curr_Stock_Price:  99.259770699844
curr_Factors:  [99.2597707]
mat_Sqrt:  [[0.15]]
grads:  [-0.08679359]
Stock Position:  -0.08679358680200917
Bond Position:  [-6.63021255]


portfolio before change:  [-15.25163731]
curr_Stock_Price:  99.29430432826395
curr_Factors:  [99.29430433]
mat_Sqrt:  [[0.15]]
grads:  [-0.08939275]
Stock Position:  -0.08939275492118223
Bond Position:  [-6.37544589]


portfolio before change:  [-15.31656776]
curr_Stock_Price:  99.98498599587197
curr_Factors:  [99.984986]
mat_Sqrt:  [[0.15]]
grads:  [0.04387491]
Stock Position:  0.04387491305843231
Bond Position:  [-19.70340033]


portfolio before change:  [-15.37282537]
curr_Stock_Price:  98.92735561904819
curr_Factors:  [98.92735562]
mat_Sqrt:  [[0.15]]
grads:  [0.06768235]
Stock Position:  0.06768234573848271
Bond Position:  [-22.06846085]


portfolio before change:  [-15.25241893]
curr_Stock_Price:  100.86941934459874
curr_Factors:  [100.86941934]
mat_Sqrt:  [[0.15]]
grads:  [0.08028035]
Stock Position:  0.0802803493805644
Bond Position:  [-23.35025115]


portfolio before change:  [-15.22103592]
curr_Stock_Price:  101.40580280716645
curr_Factors:  [101.40580281]
mat_Sqrt:  [[0.15]]
grads:  [0.06897254]
Stock Position:  0.06897254089315406
Bond Position:  [-22.2152518]


portfolio before change:  [-15.09996014]
curr_Stock_Price:  103.32230726931586
curr_Factors:  [103.32230727]
mat_Sqrt:  [[0.15]]
grads:  [-0.03980248]
Stock Position:  -0.03980247901342711
Bond Position:  [-10.98747618]


portfolio before change:  [-14.98301216]
curr_Stock_Price:  100.24603923473384
curr_Factors:  [100.24603923]
mat_Sqrt:  [[0.15]]
grads:  [0.02884809]
Stock Position:  0.02884809466502413
Bond Position:  [-17.87491939]


portfolio before change:  [-15.02949304]
curr_Stock_Price:  98.94469893012854
curr_Factors:  [98.94469893]
mat_Sqrt:  [[0.15]]
grads:  [-0.00372633]
Stock Position:  -0.0037263285107820452
Bond Position:  [-14.66079259]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.04156555]
Stock Price:  100.21680427855125
PL:  [-15.25836983]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.42330916e-02]
 [-1.39841269e-02]
 [-1.87707224e-02]
 [ 7.42230540e-03]
 [-2.37266669e-02]
 [ 1.28563534e-02]
 [-1.42637103e-02]
 [ 4.48383574e-03]
 [-3.75968138e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.71547324]
curr_Stock_Price:  101.02833947869263
curr_Factors:  [101.02833948]
mat_Sqrt:  [[0.15]]
grads:  [-0.09488728]
Stock Position:  -0.09488727729903165
Bond Position:  [33.3017773]


portfolio before change:  [23.9431552]
curr_Stock_Price:  98.80436468255289
curr_Factors:  [98.80436468]
mat_Sqrt:  [[0.15]]
grads:  [-0.09322751]
Stock Position:  -0.09322751279332511
Bond Position:  [33.15444037]


portfolio before change:  [24.18561567]
curr_Stock_Price:  96.381484429774
curr_Factors:  [96.38148443]
mat_Sqrt:  [[0.15]]
grads:  [-0.12513815]
Stock Position:  -0.1251381494517338
Bond Position:  [36.24661627]


portfolio before change:  [24.0605912]
curr_Stock_Price:  97.52543854228004
curr_Factors:  [97.52543854]
mat_Sqrt:  [[0.15]]
grads:  [0.04948204]
Stock Position:  0.04948203599501965
Bond Position:  [19.23483394]


portfolio before change:  [24.10147563]
curr_Stock_Price:  98.15727593874429
curr_Factors:  [98.15727594]
mat_Sqrt:  [[0.15]]
grads:  [-0.15817778]
Stock Position:  -0.15817777946709102
Bond Position:  [39.62777557]


portfolio before change:  [24.18194976]
curr_Stock_Price:  97.77381317550571
curr_Factors:  [97.77381318]
mat_Sqrt:  [[0.15]]
grads:  [0.08570902]
Stock Position:  0.0857090226348854
Bond Position:  [15.80185179]


portfolio before change:  [24.14228544]
curr_Stock_Price:  97.21882825823998
curr_Factors:  [97.21882826]
mat_Sqrt:  [[0.15]]
grads:  [-0.0950914]
Stock Position:  -0.09509140167122133
Bond Position:  [33.38696009]


portfolio before change:  [23.9997206]
curr_Stock_Price:  98.89366418010745
curr_Factors:  [98.89366418]
mat_Sqrt:  [[0.15]]
grads:  [0.02989224]
Stock Position:  0.029892238249752227
Bond Position:  [21.04356763]


portfolio before change:  [24.01347063]
curr_Stock_Price:  99.00157212653072
curr_Factors:  [99.00157213]
mat_Sqrt:  [[0.15]]
grads:  [-0.00250645]
Stock Position:  -0.0025064542555373478
Bond Position:  [24.26161354]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [24.0250139]
Stock Price:  99.23719253960395
PL:  [24.0250139]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.29992865e-02]
 [-1.28923004e-02]
 [ 2.07470051e-02]
 [ 1.09513111e-02]
 [-1.23643516e-03]
 [ 1.27232501e-02]
 [-1.18239495e-02]
 [ 4.65783548e-04]
 [ 6.73128137e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-28.82525785]
curr_Stock_Price:  98.64332933929985
curr_Factors:  [98.64332934]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-20.27663852]


portfolio before change:  [-29.00463244]
curr_Stock_Price:  100.59613348837063
curr_Factors:  [100.59613349]
mat_Sqrt:  [[0.15]]
grads:  [-0.08594867]
Stock Position:  -0.0859486695997309
Bond Position:  [-20.3585286]


portfolio before change:  [-29.10743919]
curr_Stock_Price:  101.67381084284243
curr_Factors:  [101.67381084]
mat_Sqrt:  [[0.15]]
grads:  [0.13831337]
Stock Position:  0.1383133674630948
Bond Position:  [-43.17028635]


portfolio before change:  [-29.30630109]
curr_Stock_Price:  100.39214614865317
curr_Factors:  [100.39214615]
mat_Sqrt:  [[0.15]]
grads:  [0.07300874]
Stock Position:  0.07300874086144443
Bond Position:  [-36.63580527]


portfolio before change:  [-29.40115298]
curr_Stock_Price:  99.34392354468255
curr_Factors:  [99.34392354]
mat_Sqrt:  [[0.15]]
grads:  [-0.0082429]
Stock Position:  -0.0082429010409518
Bond Position:  [-28.58227085]


portfolio before change:  [-29.42467631]
curr_Stock_Price:  100.46350740182113
curr_Factors:  [100.4635074]
mat_Sqrt:  [[0.15]]
grads:  [0.08482167]
Stock Position:  0.08482166743838657
Bond Position:  [-37.94615853]


portfolio before change:  [-29.40837591]
curr_Stock_Price:  100.87941798759226
curr_Factors:  [100.87941799]
mat_Sqrt:  [[0.15]]
grads:  [-0.07882633]
Stock Position:  -0.07882632989387298
Bond Position:  [-21.45642162]


portfolio before change:  [-29.68608889]
curr_Stock_Price:  104.26638384299183
curr_Factors:  [104.26638384]
mat_Sqrt:  [[0.15]]
grads:  [0.00310522]
Stock Position:  0.0031052236558969165
Bond Position:  [-30.00985933]


portfolio before change:  [-29.70457939]
curr_Stock_Price:  103.14510630139901
curr_Factors:  [103.1451063]
mat_Sqrt:  [[0.15]]
grads:  [0.00448752]
Stock Position:  0.004487520913272904
Bond Position:  [-30.16744521]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-29.70629086]
Stock Price:  106.12582215283966
PL:  [-35.83211301]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.32360958e-02]
 [-7.53878036e-03]
 [-1.44735337e-02]
 [ 5.46592983e-03]
 [ 5.84400469e-02]
 [-1.16394887e-03]
 [-5.94774025e-03]
 [-4.40779381e-04]
 [ 1.80138029e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.34693762]
curr_Stock_Price:  99.93606130350045
curr_Factors:  [99.9360613]
mat_Sqrt:  [[0.15]]
grads:  [-0.08824064]
Stock Position:  -0.0882406388912455
Bond Position:  [8.47148427]


portfolio before change:  [-0.55875164]
curr_Stock_Price:  102.38448888997578
curr_Factors:  [102.38448889]
mat_Sqrt:  [[0.15]]
grads:  [-0.05025854]
Stock Position:  -0.05025853573324849
Bond Position:  [4.58694286]


portfolio before change:  [-0.61169499]
curr_Stock_Price:  103.48355400668487
curr_Factors:  [103.48355401]
mat_Sqrt:  [[0.15]]
grads:  [-0.09649022]
Stock Position:  -0.0964902248443936
Bond Position:  [9.3734564]


portfolio before change:  [-0.77075416]
curr_Stock_Price:  105.18058671745153
curr_Factors:  [105.18058672]
mat_Sqrt:  [[0.15]]
grads:  [0.03643953]
Stock Position:  0.03643953220523284
Bond Position:  [-4.60348554]


portfolio before change:  [-0.75698442]
curr_Stock_Price:  105.62164776766278
curr_Factors:  [105.62164777]
mat_Sqrt:  [[0.15]]
grads:  [0.38960031]
Stock Position:  0.3896003124765651
Bond Position:  [-41.9072114]


portfolio before change:  [-0.58971565]
curr_Stock_Price:  106.10477782125166
curr_Factors:  [106.10477782]
mat_Sqrt:  [[0.15]]
grads:  [-0.00775966]
Stock Position:  -0.00775965914722838
Bond Position:  [0.23362126]


portfolio before change:  [-0.57749389]
curr_Stock_Price:  104.5447968833242
curr_Factors:  [104.54479688]
mat_Sqrt:  [[0.15]]
grads:  [-0.0396516]
Stock Position:  -0.03965160167802175
Bond Position:  [3.56787476]


portfolio before change:  [-0.60154728]
curr_Stock_Price:  105.19641698636521
curr_Factors:  [105.19641699]
mat_Sqrt:  [[0.15]]
grads:  [-0.00293853]
Stock Position:  -0.002938529204623494
Bond Position:  [-0.29242454]


portfolio before change:  [-0.59943105]
curr_Stock_Price:  104.42647812839844
curr_Factors:  [104.42647813]
mat_Sqrt:  [[0.15]]
grads:  [0.0120092]
Stock Position:  0.012009201905987955
Bond Position:  [-1.85350971]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.60490947]
Stock Price:  104.04748249172636
PL:  [-4.65239196]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.45229390e-02]
 [-1.13501197e-02]
 [ 1.09602949e-02]
 [ 7.94809098e-03]
 [ 1.48153242e-02]
 [ 1.09740189e-02]
 [-7.80296001e-03]
 [ 1.58788132e-03]
 [ 1.97405168e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [28.2367594]
curr_Stock_Price:  101.23357669407096
curr_Factors:  [101.23357669]
mat_Sqrt:  [[0.15]]
grads:  [-0.09681959]
Stock Position:  -0.09681959361928452
Bond Position:  [38.03815315]


portfolio before change:  [28.2885818]
curr_Stock_Price:  100.89481706454598
curr_Factors:  [100.89481706]
mat_Sqrt:  [[0.15]]
grads:  [-0.07566746]
Stock Position:  -0.07566746433466681
Bond Position:  [35.92303677]


portfolio before change:  [28.3503565]
curr_Stock_Price:  100.31585366617898
curr_Factors:  [100.31585367]
mat_Sqrt:  [[0.15]]
grads:  [0.07306863]
Stock Position:  0.07306863261672436
Bond Position:  [21.02041425]


portfolio before change:  [28.4092049]
curr_Stock_Price:  100.97736279425716
curr_Factors:  [100.97736279]
mat_Sqrt:  [[0.15]]
grads:  [0.05298727]
Stock Position:  0.05298727319878325
Bond Position:  [23.0586898]


portfolio before change:  [28.37672044]
curr_Stock_Price:  100.14665961639412
curr_Factors:  [100.14665962]
mat_Sqrt:  [[0.15]]
grads:  [0.09876883]
Stock Position:  0.09876882812403744
Bond Position:  [18.48535223]


portfolio before change:  [28.48608754]
curr_Stock_Price:  101.16036117447325
curr_Factors:  [101.16036117]
mat_Sqrt:  [[0.15]]
grads:  [0.07316013]
Stock Position:  0.07316012592356426
Bond Position:  [21.08518278]


portfolio before change:  [28.59586901]
curr_Stock_Price:  102.51678641917783
curr_Factors:  [102.51678642]
mat_Sqrt:  [[0.15]]
grads:  [-0.05201973]
Stock Position:  -0.052019733421261
Bond Position:  [33.92876491]


portfolio before change:  [28.58331137]
curr_Stock_Price:  103.08438367785689
curr_Factors:  [103.08438368]
mat_Sqrt:  [[0.15]]
grads:  [0.01058588]
Stock Position:  0.010585875436447909
Bond Position:  [27.49207293]


portfolio before change:  [28.61307632]
curr_Stock_Price:  104.59729342911241
curr_Factors:  [104.59729343]
mat_Sqrt:  [[0.15]]
grads:  [0.01316034]
Stock Position:  0.013160344526493608
Bond Position:  [27.2365399]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [28.59066847]
Stock Price:  101.85955926994743
PL:  [26.7311092]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.33279193e-02]
 [-7.80476451e-03]
 [-1.15760395e-02]
 [ 4.79974028e-03]
 [ 1.48572430e-02]
 [ 1.32192398e-02]
 [-1.52670575e-02]
 [ 4.27009593e-03]
 [-5.43449514e-05]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.77409764]
curr_Stock_Price:  100.12312971081352
curr_Factors:  [100.12312971]
mat_Sqrt:  [[0.15]]
grads:  [-0.0888528]
Stock Position:  -0.08885279515700671
Bond Position:  [12.67031757]


portfolio before change:  [3.61165317]
curr_Stock_Price:  102.02268971568861
curr_Factors:  [102.02268972]
mat_Sqrt:  [[0.15]]
grads:  [-0.05203176]
Stock Position:  -0.052031763400024945
Bond Position:  [8.92007362]


portfolio before change:  [3.54507026]
curr_Stock_Price:  103.38808761720038
curr_Factors:  [103.38808762]
mat_Sqrt:  [[0.15]]
grads:  [-0.0771736]
Stock Position:  -0.07717359689607446
Bond Position:  [11.52390085]


portfolio before change:  [3.65449006]
curr_Stock_Price:  102.04492862993617
curr_Factors:  [102.04492863]
mat_Sqrt:  [[0.15]]
grads:  [0.03199827]
Stock Position:  0.031998268543257456
Bond Position:  [0.38922903]


portfolio before change:  [3.59990403]
curr_Stock_Price:  100.33293924651811
curr_Factors:  [100.33293925]
mat_Sqrt:  [[0.15]]
grads:  [0.09904829]
Stock Position:  0.09904828664030287
Bond Position:  [-6.3379017]


portfolio before change:  [3.54957941]
curr_Stock_Price:  99.85685959828355
curr_Factors:  [99.8568596]
mat_Sqrt:  [[0.15]]
grads:  [0.08812827]
Stock Position:  0.0881282656160387
Bond Position:  [-5.25063244]


portfolio before change:  [3.43895865]
curr_Stock_Price:  98.63143229268458
curr_Factors:  [98.63143229]
mat_Sqrt:  [[0.15]]
grads:  [-0.10178038]
Stock Position:  -0.10178038330624319
Bond Position:  [13.47770364]


portfolio before change:  [3.49335806]
curr_Stock_Price:  98.16318030030303
curr_Factors:  [98.1631803]
mat_Sqrt:  [[0.15]]
grads:  [0.02846731]
Stock Position:  0.0284673061916476
Bond Position:  [0.69891675]


portfolio before change:  [3.58365345]
curr_Stock_Price:  101.32279948870455
curr_Factors:  [101.32279949]
mat_Sqrt:  [[0.15]]
grads:  [-0.0003623]
Stock Position:  -0.0003622996762186274
Bond Position:  [3.62036267]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.5849999]
Stock Price:  102.60400636786456
PL:  [0.98099353]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.29992865e-02]
 [-1.30951320e-02]
 [ 3.24657505e-03]
 [ 9.62902273e-03]
 [ 1.21007655e-02]
 [ 9.53496461e-03]
 [-7.51826947e-03]
 [ 3.29611555e-03]
 [ 8.52343844e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.17840415]
curr_Stock_Price:  99.44438262009456
curr_Factors:  [99.44438262]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-2.56036401]


portfolio before change:  [-11.22335497]
curr_Stock_Price:  99.94829862176037
curr_Factors:  [99.94829862]
mat_Sqrt:  [[0.15]]
grads:  [-0.08730088]
Stock Position:  -0.0873008798505596
Bond Position:  [-2.49778056]


portfolio before change:  [-11.16268458]
curr_Stock_Price:  99.2390320602069
curr_Factors:  [99.23903206]
mat_Sqrt:  [[0.15]]
grads:  [0.02164383]
Stock Position:  0.02164383368471169
Bond Position:  [-13.31059769]


portfolio before change:  [-11.13910153]
curr_Stock_Price:  100.63619737824601
curr_Factors:  [100.63619738]
mat_Sqrt:  [[0.15]]
grads:  [0.06419348]
Stock Position:  0.06419348483648898
Bond Position:  [-17.59928974]


portfolio before change:  [-11.13356382]
curr_Stock_Price:  100.85957758419556
curr_Factors:  [100.85957758]
mat_Sqrt:  [[0.15]]
grads:  [0.08067177]
Stock Position:  0.08067176982819606
Bond Position:  [-19.27008445]


portfolio before change:  [-11.07357454]
curr_Stock_Price:  101.72266431423736
curr_Factors:  [101.72266431]
mat_Sqrt:  [[0.15]]
grads:  [0.06356643]
Stock Position:  0.06356643073505391
Bond Position:  [-17.53972123]


portfolio before change:  [-11.02472765]
curr_Stock_Price:  102.62910100444775
curr_Factors:  [102.629101]
mat_Sqrt:  [[0.15]]
grads:  [-0.0501218]
Stock Position:  -0.050121796434023286
Bond Position:  [-5.88077274]


portfolio before change:  [-10.97624199]
curr_Stock_Price:  101.60306468148751
curr_Factors:  [101.60306468]
mat_Sqrt:  [[0.15]]
grads:  [0.0219741]
Stock Position:  0.021974103643062588
Bond Position:  [-13.20887826]


portfolio before change:  [-10.94278785]
curr_Stock_Price:  103.42612988666977
curr_Factors:  [103.42612989]
mat_Sqrt:  [[0.15]]
grads:  [0.00568229]
Stock Position:  0.005682292291693276
Bond Position:  [-11.53048535]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.95499102]
Stock Price:  102.29340249030349
PL:  [-13.24839351]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.41116572e-02]
 [-8.03598021e-03]
 [ 6.58752529e-03]
 [ 4.78100783e-03]
 [ 5.46484509e-02]
 [-1.53482161e-03]
 [-5.99216276e-03]
 [-1.98846507e-03]
 [ 2.98850574e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.82123682]
curr_Stock_Price:  100.94235336895304
curr_Factors:  [100.94235337]
mat_Sqrt:  [[0.15]]
grads:  [-0.09407771]
Stock Position:  -0.09407771475035544
Bond Position:  [31.31766274]


portfolio before change:  [21.76485201]
curr_Stock_Price:  101.70818357210158
curr_Factors:  [101.70818357]
mat_Sqrt:  [[0.15]]
grads:  [-0.0535732]
Stock Position:  -0.053573201398822226
Bond Position:  [27.21368501]


portfolio before change:  [21.87075401]
curr_Stock_Price:  99.98546112187928
curr_Factors:  [99.98546112]
mat_Sqrt:  [[0.15]]
grads:  [0.04391684]
Stock Position:  0.04391683524260888
Bond Position:  [17.47970899]


portfolio before change:  [21.97258918]
curr_Stock_Price:  102.10522071242298
curr_Factors:  [102.10522071]
mat_Sqrt:  [[0.15]]
grads:  [0.03187339]
Stock Position:  0.0318733855222613
Bond Position:  [18.71815012]


portfolio before change:  [22.08672683]
curr_Stock_Price:  105.39248487700726
curr_Factors:  [105.39248488]
mat_Sqrt:  [[0.15]]
grads:  [0.36432301]
Stock Position:  0.36432300632157977
Bond Position:  [-16.3101801]


portfolio before change:  [22.42103888]
curr_Stock_Price:  106.3325000977792
curr_Factors:  [106.3325001]
mat_Sqrt:  [[0.15]]
grads:  [-0.01023214]
Stock Position:  -0.010232144034294384
Bond Position:  [23.50904833]


portfolio before change:  [22.44097099]
curr_Stock_Price:  105.53358148172056
curr_Factors:  [105.53358148]
mat_Sqrt:  [[0.15]]
grads:  [-0.03994775]
Stock Position:  -0.039947751717412036
Bond Position:  [26.6568003]


portfolio before change:  [22.36451551]
curr_Stock_Price:  107.78119763106768
curr_Factors:  [107.78119763]
mat_Sqrt:  [[0.15]]
grads:  [-0.01325643]
Stock Position:  -0.01325643382001966
Bond Position:  [23.79330982]


portfolio before change:  [22.37959374]
curr_Stock_Price:  107.54141934085642
curr_Factors:  [107.54141934]
mat_Sqrt:  [[0.15]]
grads:  [0.01992337]
Stock Position:  0.019923371611208728
Bond Position:  [20.23700608]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.38640803]
Stock Price:  107.37544620876035
PL:  [15.01096182]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-2.01526094e-02]
 [-6.28331339e-03]
 [-1.64107009e-02]
 [ 5.78072379e-03]
 [ 9.27792929e-02]
 [-8.30967613e-03]
 [-6.22269114e-03]
 [-4.32494610e-03]
 [ 2.96058000e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [123.3026104]
curr_Stock_Price:  105.54895285737508
curr_Factors:  [105.54895286]
mat_Sqrt:  [[0.15]]
grads:  [-0.13435073]
Stock Position:  -0.13435072965165828
Bond Position:  [137.48318923]


portfolio before change:  [123.56999453]
curr_Stock_Price:  104.0705437019599
curr_Factors:  [104.0705437]
mat_Sqrt:  [[0.15]]
grads:  [-0.04188876]
Stock Position:  -0.04188875594189214
Bond Position:  [127.92938013]


portfolio before change:  [123.6558899]
curr_Stock_Price:  103.54737962323802
curr_Factors:  [103.54737962]
mat_Sqrt:  [[0.15]]
grads:  [-0.10940467]
Stock Position:  -0.10940467248598242
Bond Position:  [134.98445706]


portfolio before change:  [123.39850139]
curr_Stock_Price:  106.5170665263619
curr_Factors:  [106.51706653]
mat_Sqrt:  [[0.15]]
grads:  [0.03853816]
Stock Position:  0.038538158624158776
Bond Position:  [119.29352978]


portfolio before change:  [123.50745985]
curr_Stock_Price:  107.79623466889146
curr_Factors:  [107.79623467]
mat_Sqrt:  [[0.15]]
grads:  [0.61852862]
Stock Position:  0.6185286190106717
Bond Position:  [56.83240368]


portfolio before change:  [125.20352498]
curr_Stock_Price:  110.49237802409111
curr_Factors:  [110.49237802]
mat_Sqrt:  [[0.15]]
grads:  [-0.05539784]
Stock Position:  -0.05539784087204513
Bond Position:  [131.32456416]


portfolio before change:  [125.25965022]
curr_Stock_Price:  110.66482992102196
curr_Factors:  [110.66482992]
mat_Sqrt:  [[0.15]]
grads:  [-0.04148461]
Stock Position:  -0.04148460760077187
Bond Position:  [129.85053726]


portfolio before change:  [125.28036513]
curr_Stock_Price:  111.73092627880924
curr_Factors:  [111.73092628]
mat_Sqrt:  [[0.15]]
grads:  [-0.02883297]
Stock Position:  -0.028832973980796733
Bond Position:  [128.50190002]


portfolio before change:  [125.43869041]
curr_Stock_Price:  108.46874925901898
curr_Factors:  [108.46874926]
mat_Sqrt:  [[0.15]]
grads:  [0.0197372]
Stock Position:  0.01973719999484327
Bond Position:  [123.29782102]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [125.47291854]
Stock Price:  107.0786736770741
PL:  [118.39424486]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.39981671e-02]
 [-6.69289229e-03]
 [-5.22629825e-02]
 [ 5.00824237e-03]
 [ 9.94067577e-03]
 [ 1.24456423e-02]
 [-1.30858154e-02]
 [ 4.53303044e-03]
 [-9.03243320e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.05012128]
curr_Stock_Price:  100.86195615280904
curr_Factors:  [100.86195615]
mat_Sqrt:  [[0.15]]
grads:  [-0.09332111]
Stock Position:  -0.09332111374086938
Bond Position:  [29.46267136]


portfolio before change:  [19.81576856]
curr_Stock_Price:  103.53110282287231
curr_Factors:  [103.53110282]
mat_Sqrt:  [[0.15]]
grads:  [-0.04461928]
Stock Position:  -0.04461928193736491
Bond Position:  [24.43525202]


portfolio before change:  [19.77620731]
curr_Stock_Price:  104.69163077554242
curr_Factors:  [104.69163078]
mat_Sqrt:  [[0.15]]
grads:  [-0.34841988]
Stock Position:  -0.348419883019041
Bond Position:  [56.25285306]


portfolio before change:  [20.25030037]
curr_Stock_Price:  103.4116820261788
curr_Factors:  [103.41168203]
mat_Sqrt:  [[0.15]]
grads:  [0.03338828]
Stock Position:  0.03338828244151096
Bond Position:  [16.79756192]


portfolio before change:  [20.19011005]
curr_Stock_Price:  101.35733264795145
curr_Factors:  [101.35733265]
mat_Sqrt:  [[0.15]]
grads:  [0.06627117]
Stock Position:  0.06627117182043653
Bond Position:  [13.47304084]


portfolio before change:  [20.14497161]
curr_Stock_Price:  100.57453912683482
curr_Factors:  [100.57453913]
mat_Sqrt:  [[0.15]]
grads:  [0.08297095]
Stock Position:  0.08297094899435094
Bond Position:  [11.80020666]


portfolio before change:  [20.15031195]
curr_Stock_Price:  100.56777484608477
curr_Factors:  [100.56777485]
mat_Sqrt:  [[0.15]]
grads:  [-0.08723877]
Stock Position:  -0.08723876908686917
Bond Position:  [28.92372084]


portfolio before change:  [20.29271051]
curr_Stock_Price:  99.10130434280966
curr_Factors:  [99.10130434]
mat_Sqrt:  [[0.15]]
grads:  [0.0302202]
Stock Position:  0.030220202922494537
Bond Position:  [17.29784898]


portfolio before change:  [20.29339504]
curr_Stock_Price:  98.83768733912581
curr_Factors:  [98.83768734]
mat_Sqrt:  [[0.15]]
grads:  [-0.00602162]
Stock Position:  -0.006021622131241302
Bond Position:  [20.88855824]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.30621558]
Stock Price:  98.44349924344779
PL:  [20.30621558]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30601160e-02]
 [-1.40525648e-02]
 [-1.07637193e-03]
 [ 5.81164597e-03]
 [-2.78736088e-02]
 [ 1.22449139e-02]
 [-1.52082856e-02]
 [ 4.40413428e-03]
 [ 2.73321050e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-34.05283645]
curr_Stock_Price:  98.40603100533234
curr_Factors:  [98.40603101]
mat_Sqrt:  [[0.15]]
grads:  [-0.08706744]
Stock Position:  -0.08706743971432174
Bond Position:  [-25.48487527]


portfolio before change:  [-33.90217167]
curr_Stock_Price:  96.52920538083151
curr_Factors:  [96.52920538]
mat_Sqrt:  [[0.15]]
grads:  [-0.09368377]
Stock Position:  -0.09368376553425743
Bond Position:  [-24.85895222]


portfolio before change:  [-34.10230314]
curr_Stock_Price:  98.53274239692051
curr_Factors:  [98.5327424]
mat_Sqrt:  [[0.15]]
grads:  [-0.00717581]
Stock Position:  -0.007175812898667598
Bond Position:  [-33.39525062]


portfolio before change:  [-34.10784972]
curr_Stock_Price:  96.97818352975546
curr_Factors:  [96.97818353]
mat_Sqrt:  [[0.15]]
grads:  [0.03874431]
Stock Position:  0.03874430649848284
Bond Position:  [-37.86520219]


portfolio before change:  [-34.09617115]
curr_Stock_Price:  97.76838755419617
curr_Factors:  [97.76838755]
mat_Sqrt:  [[0.15]]
grads:  [-0.18582406]
Stock Position:  -0.1858240586696713
Bond Position:  [-15.92845256]


portfolio before change:  [-34.40078186]
curr_Stock_Price:  99.36476045721756
curr_Factors:  [99.36476046]
mat_Sqrt:  [[0.15]]
grads:  [0.08163276]
Stock Position:  0.08163275925297502
Bond Position:  [-42.51220143]


portfolio before change:  [-34.41135752]
curr_Stock_Price:  99.49566079284442
curr_Factors:  [99.49566079]
mat_Sqrt:  [[0.15]]
grads:  [-0.10138857]
Stock Position:  -0.10138857084690057
Bond Position:  [-24.32363467]


portfolio before change:  [-34.48862195]
curr_Stock_Price:  100.13774079109353
curr_Factors:  [100.13774079]
mat_Sqrt:  [[0.15]]
grads:  [0.0293609]
Stock Position:  0.02936089518002777
Bond Position:  [-37.42875566]


portfolio before change:  [-34.51701326]
curr_Stock_Price:  99.8083143854941
curr_Factors:  [99.80831439]
mat_Sqrt:  [[0.15]]
grads:  [0.00182214]
Stock Position:  0.0018221403316828018
Bond Position:  [-34.69887802]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-34.53184288]
Stock Price:  101.19358812264959
PL:  [-35.725431]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.39764440e-02]
 [-1.40157878e-02]
 [ 3.74764390e-04]
 [ 8.62313292e-03]
 [-1.47518398e-02]
 [ 1.19239323e-02]
 [-1.37005088e-02]
 [ 2.11615193e-03]
 [-1.52843392e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.7110487]
curr_Stock_Price:  100.84656444582964
curr_Factors:  [100.84656445]
mat_Sqrt:  [[0.15]]
grads:  [-0.09317629]
Stock Position:  -0.09317629365899849
Bond Position:  [29.1075578]


portfolio before change:  [19.91847443]
curr_Stock_Price:  98.77663545178534
curr_Factors:  [98.77663545]
mat_Sqrt:  [[0.15]]
grads:  [-0.09343859]
Stock Position:  -0.09343858516443572
Bond Position:  [29.14802349]


portfolio before change:  [19.93935598]
curr_Stock_Price:  98.70916981558884
curr_Factors:  [98.70916982]
mat_Sqrt:  [[0.15]]
grads:  [0.00249843]
Stock Position:  0.0024984292684619483
Bond Position:  [19.6927381]


portfolio before change:  [19.94719109]
curr_Stock_Price:  97.90317481286478
curr_Factors:  [97.90317481]
mat_Sqrt:  [[0.15]]
grads:  [0.05748755]
Stock Position:  0.057487552780008576
Bond Position:  [14.31897716]


portfolio before change:  [20.01177561]
curr_Stock_Price:  98.90205613008703
curr_Factors:  [98.90205613]
mat_Sqrt:  [[0.15]]
grads:  [-0.0983456]
Stock Position:  -0.09834559852256133
Bond Position:  [29.73835751]


portfolio before change:  [20.04747023]
curr_Stock_Price:  98.690336145039
curr_Factors:  [98.69033615]
mat_Sqrt:  [[0.15]]
grads:  [0.07949288]
Stock Position:  0.07949288211744937
Bond Position:  [12.20229098]


portfolio before change:  [19.85455723]
curr_Stock_Price:  96.18677021166262
curr_Factors:  [96.18677021]
mat_Sqrt:  [[0.15]]
grads:  [-0.09133673]
Stock Position:  -0.09133672531835242
Bond Position:  [28.63994184]


portfolio before change:  [19.94555084]
curr_Stock_Price:  95.34734821074773
curr_Factors:  [95.34734821]
mat_Sqrt:  [[0.15]]
grads:  [0.01410768]
Stock Position:  0.01410767953168926
Bond Position:  [18.60042101]


portfolio before change:  [19.93883151]
curr_Stock_Price:  94.2116638612229
curr_Factors:  [94.21166386]
mat_Sqrt:  [[0.15]]
grads:  [-0.10189559]
Stock Position:  -0.10189559470051444
Bond Position:  [29.53858502]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.71739899]
Stock Price:  96.52977686996209
PL:  [19.71739899]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 3.30443445]
 [-0.01299929]
 [-0.01440938]
 [-0.00848499]
 [ 0.00611247]
 [-0.03641308]
 [ 0.01351827]
 [-0.01494527]
 [ 0.0044639 ]
 [-0.00357204]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-25.63396703]
curr_Stock_Price:  98.78819334863253
curr_Factors:  [98.78819335]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-17.07279351]


portfolio before change:  [-25.48616102]
curr_Stock_Price:  96.98411882866182
curr_Factors:  [96.98411883]
mat_Sqrt:  [[0.15]]
grads:  [-0.0960625]
Stock Position:  -0.09606250267086283
Bond Position:  [-16.16962385]


portfolio before change:  [-25.55648603]
curr_Stock_Price:  97.63201132625275
curr_Factors:  [97.63201133]
mat_Sqrt:  [[0.15]]
grads:  [-0.05656661]
Stock Position:  -0.05656660810992312
Bond Position:  [-20.03377431]


portfolio before change:  [-25.49111025]
curr_Stock_Price:  96.29915485724727
curr_Factors:  [96.29915486]
mat_Sqrt:  [[0.15]]
grads:  [0.0407498]
Stock Position:  0.04074979685013509
Bond Position:  [-29.41528125]


portfolio before change:  [-25.5212729]
curr_Stock_Price:  95.91997925075383
curr_Factors:  [95.91997925]
mat_Sqrt:  [[0.15]]
grads:  [-0.24275384]
Stock Position:  -0.2427538431920273
Bond Position:  [-2.2363293]


portfolio before change:  [-25.60768043]
curr_Stock_Price:  96.27131903348993
curr_Factors:  [96.27131903]
mat_Sqrt:  [[0.15]]
grads:  [0.09012177]
Stock Position:  0.09012177285849092
Bond Position:  [-34.28382237]


portfolio before change:  [-25.47269789]
curr_Stock_Price:  97.95935432635633
curr_Factors:  [97.95935433]
mat_Sqrt:  [[0.15]]
grads:  [-0.09963512]
Stock Position:  -0.09963512444757947
Bond Position:  [-15.71250543]


portfolio before change:  [-25.68921618]
curr_Stock_Price:  100.05359643131887
curr_Factors:  [100.05359643]
mat_Sqrt:  [[0.15]]
grads:  [0.02975932]
Stock Position:  0.029759324460973086
Bond Position:  [-28.66674362]


portfolio before change:  [-25.76442319]
curr_Stock_Price:  98.00818520500853
curr_Factors:  [98.00818521]
mat_Sqrt:  [[0.15]]
grads:  [-0.02381363]
Stock Position:  -0.023813628948035823
Bond Position:  [-23.43049264]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-25.77067187]
Stock Price:  97.77850609421819
PL:  [-25.77067187]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.47490811e-02]
 [-1.46557288e-02]
 [-5.01819696e-03]
 [ 9.97827218e-03]
 [-7.24990601e-03]
 [ 1.18148050e-02]
 [-1.53199322e-02]
 [ 3.29646002e-03]
 [-5.05219750e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-73.6236061]
curr_Stock_Price:  96.60977341832462
curr_Factors:  [96.60977342]
mat_Sqrt:  [[0.15]]
grads:  [-0.09832721]
Stock Position:  -0.09832720701033315
Bond Position:  [-64.12423691]


portfolio before change:  [-73.73816244]
curr_Stock_Price:  97.44866848288355
curr_Factors:  [97.44866848]
mat_Sqrt:  [[0.15]]
grads:  [-0.09770486]
Stock Position:  -0.09770485858300908
Bond Position:  [-64.21695407]


portfolio before change:  [-73.82937393]
curr_Stock_Price:  98.05350002526833
curr_Factors:  [98.05350003]
mat_Sqrt:  [[0.15]]
grads:  [-0.03345465]
Stock Position:  -0.03345464639919353
Bond Position:  [-70.54902876]


portfolio before change:  [-73.89066811]
curr_Stock_Price:  98.8309959388967
curr_Factors:  [98.83099594]
mat_Sqrt:  [[0.15]]
grads:  [0.06652181]
Stock Position:  0.066521814539766
Bond Position:  [-80.4650853]


portfolio before change:  [-73.90877139]
curr_Stock_Price:  99.16380897599444
curr_Factors:  [99.16380898]
mat_Sqrt:  [[0.15]]
grads:  [-0.04833271]
Stock Position:  -0.04833270672232666
Bond Position:  [-69.11591609]


portfolio before change:  [-73.92787887]
curr_Stock_Price:  98.84396095625706
curr_Factors:  [98.84396096]
mat_Sqrt:  [[0.15]]
grads:  [0.07876537]
Stock Position:  0.07876536646556019
Bond Position:  [-81.71335968]


portfolio before change:  [-73.97246897]
curr_Stock_Price:  98.79669131143082
curr_Factors:  [98.79669131]
mat_Sqrt:  [[0.15]]
grads:  [-0.10213288]
Stock Position:  -0.10213288164731577
Bond Position:  [-63.88207819]


portfolio before change:  [-73.79119759]
curr_Stock_Price:  96.70901484637562
curr_Factors:  [96.70901485]
mat_Sqrt:  [[0.15]]
grads:  [0.0219764]
Stock Position:  0.021976400101411157
Bond Position:  [-75.91651359]


portfolio before change:  [-73.81081982]
curr_Stock_Price:  97.54379734850612
curr_Factors:  [97.54379735]
mat_Sqrt:  [[0.15]]
grads:  [-0.03368132]
Stock Position:  -0.03368131666640739
Bond Position:  [-70.52541629]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-73.85198985]
Stock Price:  97.7189243098159
PL:  [-73.85198985]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30595823e-02]
 [-1.02844930e-02]
 [ 1.21735444e-02]
 [ 1.20138378e-02]
 [ 9.39498272e-03]
 [ 1.31073728e-02]
 [-1.55641220e-02]
 [ 4.35495905e-03]
 [-1.50166482e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.5493486]
curr_Stock_Price:  99.69990541683973
curr_Factors:  [99.69990542]
mat_Sqrt:  [[0.15]]
grads:  [-0.08706388]
Stock Position:  -0.087063881897165
Bond Position:  [3.13091219]


portfolio before change:  [-5.6697852]
curr_Stock_Price:  101.10120348730636
curr_Factors:  [101.10120349]
mat_Sqrt:  [[0.15]]
grads:  [-0.06856329]
Stock Position:  -0.06856328671803118
Bond Position:  [1.2620456]


portfolio before change:  [-5.62159301]
curr_Stock_Price:  100.40752293857965
curr_Factors:  [100.40752294]
mat_Sqrt:  [[0.15]]
grads:  [0.08115696]
Stock Position:  0.08115696299996934
Bond Position:  [-13.77036263]


portfolio before change:  [-5.6597052]
curr_Stock_Price:  100.02277108273516
curr_Factors:  [100.02277108]
mat_Sqrt:  [[0.15]]
grads:  [0.08009225]
Stock Position:  0.08009225191117272
Bond Position:  [-13.67075418]


portfolio before change:  [-5.69156194]
curr_Stock_Price:  99.71038569478318
curr_Factors:  [99.71038569]
mat_Sqrt:  [[0.15]]
grads:  [0.06263322]
Stock Position:  0.06263321815853543
Bond Position:  [-11.93674428]


portfolio before change:  [-5.65821004]
curr_Stock_Price:  100.33819568259888
curr_Factors:  [100.33819568]
mat_Sqrt:  [[0.15]]
grads:  [0.08738249]
Stock Position:  0.08738248537094286
Bond Position:  [-14.42601096]


portfolio before change:  [-5.75818626]
curr_Stock_Price:  99.27663962738586
curr_Factors:  [99.27663963]
mat_Sqrt:  [[0.15]]
grads:  [-0.10376081]
Stock Position:  -0.1037608136661963
Bond Position:  [4.54283865]


portfolio before change:  [-5.65973464]
curr_Stock_Price:  98.34970364722172
curr_Factors:  [98.34970365]
mat_Sqrt:  [[0.15]]
grads:  [0.02903306]
Stock Position:  0.029033060353573985
Bond Position:  [-8.51512752]


portfolio before change:  [-5.64244753]
curr_Stock_Price:  99.09181414610318
curr_Factors:  [99.09181415]
mat_Sqrt:  [[0.15]]
grads:  [-0.00100111]
Stock Position:  -0.0010011098804418978
Bond Position:  [-5.54324573]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.64942059]
Stock Price:  103.28790128796463
PL:  [-8.93732188]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.79341029e-02]
 [-7.13171511e-03]
 [ 1.65352623e-02]
 [ 4.93548245e-03]
 [ 1.25329439e-02]
 [ 4.96210760e-03]
 [-5.98894433e-03]
 [-9.78924820e-04]
 [ 2.95506242e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [85.2078963]
curr_Stock_Price:  103.81969866760572
curr_Factors:  [103.81969867]
mat_Sqrt:  [[0.15]]
grads:  [-0.11956069]
Stock Position:  -0.11956068625416447
Bond Position:  [97.62065072]


portfolio before change:  [85.36211255]
curr_Stock_Price:  102.93819057086888
curr_Factors:  [102.93819057]
mat_Sqrt:  [[0.15]]
grads:  [-0.04754477]
Stock Position:  -0.04754476740684244
Bond Position:  [90.25628487]


portfolio before change:  [85.43920283]
curr_Stock_Price:  102.26617435276533
curr_Factors:  [102.26617435]
mat_Sqrt:  [[0.15]]
grads:  [0.11023508]
Stock Position:  0.11023508202314028
Bond Position:  [74.16588271]


portfolio before change:  [85.57157119]
curr_Stock_Price:  103.13047406393893
curr_Factors:  [103.13047406]
mat_Sqrt:  [[0.15]]
grads:  [0.03290322]
Stock Position:  0.03290321632541414
Bond Position:  [82.17824689]


portfolio before change:  [85.60334458]
curr_Stock_Price:  102.84703659396737
curr_Factors:  [102.84703659]
mat_Sqrt:  [[0.15]]
grads:  [0.08355296]
Stock Position:  0.08355295944342124
Bond Position:  [77.01017031]


portfolio before change:  [85.6962461]
curr_Stock_Price:  103.49796266916249
curr_Factors:  [103.49796267]
mat_Sqrt:  [[0.15]]
grads:  [0.03308072]
Stock Position:  0.033080717309470965
Bond Position:  [82.27245925]


portfolio before change:  [85.80236252]
curr_Stock_Price:  105.46194373227732
curr_Factors:  [105.46194373]
mat_Sqrt:  [[0.15]]
grads:  [-0.0399263]
Stock Position:  -0.039926295555621265
Bond Position:  [90.01306725]


portfolio before change:  [85.82291882]
curr_Stock_Price:  106.07460980989585
curr_Factors:  [106.07460981]
mat_Sqrt:  [[0.15]]
grads:  [-0.00652617]
Stock Position:  -0.006526165463590555
Bond Position:  [86.51517927]


portfolio before change:  [85.85806073]
curr_Stock_Price:  107.31982619066211
curr_Factors:  [107.31982619]
mat_Sqrt:  [[0.15]]
grads:  [0.01970042]
Stock Position:  0.019700416165944236
Bond Position:  [83.74381549]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [85.91200538]
Stock Price:  107.93211101495845
PL:  [77.97989436]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.29992865e-02]
 [-1.36422660e-02]
 [-2.61954026e-03]
 [ 6.57222146e-03]
 [ 1.25282087e-02]
 [ 1.10232055e-02]
 [-1.50083402e-02]
 [ 4.42186137e-03]
 [-2.23770615e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.92125897]
curr_Stock_Price:  99.54684244552965
curr_Factors:  [99.54684245]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-0.29433947]


portfolio before change:  [-8.97576094]
curr_Stock_Price:  100.17404720160178
curr_Factors:  [100.1740472]
mat_Sqrt:  [[0.15]]
grads:  [-0.09094844]
Stock Position:  -0.09094843992657176
Bond Position:  [0.13491238]


portfolio before change:  [-8.80935592]
curr_Stock_Price:  98.34512583783099
curr_Factors:  [98.34512584]
mat_Sqrt:  [[0.15]]
grads:  [-0.0174636]
Stock Position:  -0.017463601729312897
Bond Position:  [-7.09189581]


portfolio before change:  [-8.86421935]
curr_Stock_Price:  101.28361458533436
curr_Factors:  [101.28361459]
mat_Sqrt:  [[0.15]]
grads:  [0.04381481]
Stock Position:  0.04381480972752838
Bond Position:  [-13.30194165]


portfolio before change:  [-8.93225479]
curr_Stock_Price:  99.88265442838453
curr_Factors:  [99.88265443]
mat_Sqrt:  [[0.15]]
grads:  [0.08352139]
Stock Position:  0.08352139122724994
Bond Position:  [-17.27459305]


portfolio before change:  [-8.83578363]
curr_Stock_Price:  101.14114177108195
curr_Factors:  [101.14114177]
mat_Sqrt:  [[0.15]]
grads:  [0.07348804]
Stock Position:  0.0734880364131242
Bond Position:  [-16.26844754]


portfolio before change:  [-8.95704598]
curr_Stock_Price:  99.6017606821498
curr_Factors:  [99.60176068]
mat_Sqrt:  [[0.15]]
grads:  [-0.1000556]
Stock Position:  -0.10005560127949026
Bond Position:  [1.00866807]


portfolio before change:  [-8.85951992]
curr_Stock_Price:  98.63208381068496
curr_Factors:  [98.63208381]
mat_Sqrt:  [[0.15]]
grads:  [0.02947908]
Stock Position:  0.029479075790539135
Bond Position:  [-11.76710259]


portfolio before change:  [-8.87157099]
curr_Stock_Price:  98.42291690173441
curr_Factors:  [98.4229169]
mat_Sqrt:  [[0.15]]
grads:  [-0.01491804]
Stock Position:  -0.014918041014268801
Bond Position:  [-7.40329388]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.90104606]
Stock Price:  100.15052278001589
PL:  [-9.05156884]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.31088472e-02]
 [-1.47258647e-02]
 [-9.50728854e-03]
 [ 9.64487590e-03]
 [ 1.37309438e-02]
 [ 1.27072872e-02]
 [-1.54753922e-02]
 [ 4.48636168e-03]
 [ 1.08063321e-06]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.23600176]
curr_Stock_Price:  99.75952288844033
curr_Factors:  [99.75952289]
mat_Sqrt:  [[0.15]]
grads:  [-0.08739231]
Stock Position:  -0.08739231461382596
Bond Position:  [4.48221385]


portfolio before change:  [-4.09692272]
curr_Stock_Price:  98.19374019454419
curr_Factors:  [98.19374019]
mat_Sqrt:  [[0.15]]
grads:  [-0.09817243]
Stock Position:  -0.09817243114893376
Bond Position:  [5.54299548]


portfolio before change:  [-4.02680242]
curr_Stock_Price:  97.50772164057574
curr_Factors:  [97.50772164]
mat_Sqrt:  [[0.15]]
grads:  [-0.06338192]
Stock Position:  -0.06338192359314855
Bond Position:  [2.15342455]


portfolio before change:  [-4.09790013]
curr_Stock_Price:  98.64644849806056
curr_Factors:  [98.6464485]
mat_Sqrt:  [[0.15]]
grads:  [0.06429917]
Stock Position:  0.06429917263812236
Bond Position:  [-10.44078516]


portfolio before change:  [-4.01931744]
curr_Stock_Price:  99.94979949819317
curr_Factors:  [99.9497995]
mat_Sqrt:  [[0.15]]
grads:  [0.09153963]
Stock Position:  0.09153962529186546
Bond Position:  [-13.16868463]


portfolio before change:  [-3.97829437]
curr_Stock_Price:  100.4698918995331
curr_Factors:  [100.4698919]
mat_Sqrt:  [[0.15]]
grads:  [0.08471525]
Stock Position:  0.08471524823549693
Bond Position:  [-12.4896262]


portfolio before change:  [-4.09906896]
curr_Stock_Price:  99.11797212721744
curr_Factors:  [99.11797213]
mat_Sqrt:  [[0.15]]
grads:  [-0.10316928]
Stock Position:  -0.10316928148132358
Bond Position:  [6.12686101]


portfolio before change:  [-4.07396301]
curr_Stock_Price:  98.90432563301601
curr_Factors:  [98.90432563]
mat_Sqrt:  [[0.15]]
grads:  [0.02990908]
Stock Position:  0.029909077862419718
Bond Position:  [-7.03210018]


portfolio before change:  [-4.00766128]
curr_Stock_Price:  101.23868903895837
curr_Factors:  [101.23868904]
mat_Sqrt:  [[0.15]]
grads:  [7.20422141e-06]
Stock Position:  7.204221407555722e-06
Bond Position:  [-4.00839063]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.00966171]
Stock Price:  101.83060423665076
PL:  [-5.84026595]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30260255e-02]
 [-1.45915149e-02]
 [-1.47083016e-02]
 [ 6.37985437e-03]
 [-3.67011329e-02]
 [ 1.35697525e-02]
 [-1.38049339e-02]
 [ 2.35930963e-03]
 [-4.78281057e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.92597698]
curr_Stock_Price:  99.04729926288019
curr_Factors:  [99.04729926]
mat_Sqrt:  [[0.15]]
grads:  [-0.08684017]
Stock Position:  -0.086840170061813
Bond Position:  [-11.32469266]


portfolio before change:  [-19.77735558]
curr_Stock_Price:  97.27064273453763
curr_Factors:  [97.27064273]
mat_Sqrt:  [[0.15]]
grads:  [-0.09727677]
Stock Position:  -0.09727676570395921
Bond Position:  [-10.31518206]


portfolio before change:  [-19.74406543]
curr_Stock_Price:  96.87538869800007
curr_Factors:  [96.8753887]
mat_Sqrt:  [[0.15]]
grads:  [-0.09805534]
Stock Position:  -0.09805534376164714
Bond Position:  [-10.24491589]


portfolio before change:  [-19.63350508]
curr_Stock_Price:  95.69560511881838
curr_Factors:  [95.69560512]
mat_Sqrt:  [[0.15]]
grads:  [0.04253236]
Stock Position:  0.04253236248567794
Bond Position:  [-23.70366525]


portfolio before change:  [-19.63880906]
curr_Stock_Price:  95.84962482629602
curr_Factors:  [95.84962483]
mat_Sqrt:  [[0.15]]
grads:  [-0.24467422]
Stock Position:  -0.24467421957015692
Bond Position:  [3.81312309]


portfolio before change:  [-19.72557497]
curr_Stock_Price:  96.21203715321292
curr_Factors:  [96.21203715]
mat_Sqrt:  [[0.15]]
grads:  [0.09046502]
Stock Position:  0.09046501683144588
Bond Position:  [-28.42939853]


portfolio before change:  [-19.69380787]
curr_Stock_Price:  96.72035911518411
curr_Factors:  [96.72035912]
mat_Sqrt:  [[0.15]]
grads:  [-0.09203289]
Stock Position:  -0.0920328927326021
Bond Position:  [-10.79235344]


portfolio before change:  [-19.59752585]
curr_Stock_Price:  95.61554163394912
curr_Factors:  [95.61554163]
mat_Sqrt:  [[0.15]]
grads:  [0.01572873]
Stock Position:  0.015728730840338306
Bond Position:  [-21.10143697]


portfolio before change:  [-19.5764153]
curr_Stock_Price:  97.62866705705854
curr_Factors:  [97.62866706]
mat_Sqrt:  [[0.15]]
grads:  [-0.0318854]
Stock Position:  -0.03188540377202904
Bond Position:  [-16.46348583]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.61529099]
Stock Price:  98.58966749954237
PL:  [-19.61529099]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.49548514e-02]
 [-6.76109991e-03]
 [-2.61027679e-02]
 [ 5.34583770e-03]
 [ 1.11121006e-02]
 [ 9.34438967e-03]
 [-7.10258164e-03]
 [ 1.32532017e-03]
 [ 2.54915881e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [34.97409376]
curr_Stock_Price:  101.53940819737635
curr_Factors:  [101.5394082]
mat_Sqrt:  [[0.15]]
grads:  [-0.09969901]
Stock Position:  -0.09969900905081366
Bond Position:  [45.09747214]


portfolio before change:  [34.80703449]
curr_Stock_Price:  103.44126915195515
curr_Factors:  [103.44126915]
mat_Sqrt:  [[0.15]]
grads:  [-0.045074]
Stock Position:  -0.0450739993739135
Bond Position:  [39.46954619]


portfolio before change:  [34.80759774]
curr_Stock_Price:  103.86671301507378
curr_Factors:  [103.86671302]
mat_Sqrt:  [[0.15]]
grads:  [-0.17401845]
Stock Position:  -0.17401845284234962
Bond Position:  [52.88232244]


portfolio before change:  [34.68617635]
curr_Stock_Price:  104.71644566996248
curr_Factors:  [104.71644567]
mat_Sqrt:  [[0.15]]
grads:  [0.03563892]
Stock Position:  0.035638917978546805
Bond Position:  [30.95419553]


portfolio before change:  [34.57010896]
curr_Stock_Price:  101.02530224410175
curr_Factors:  [101.02530224]
mat_Sqrt:  [[0.15]]
grads:  [0.07408067]
Stock Position:  0.07408067048144741
Bond Position:  [27.08608683]


portfolio before change:  [34.64083294]
curr_Stock_Price:  101.79713050219902
curr_Factors:  [101.7971305]
mat_Sqrt:  [[0.15]]
grads:  [0.06229593]
Stock Position:  0.06229593114393637
Bond Position:  [28.29928591]


portfolio before change:  [34.71703072]
curr_Stock_Price:  102.79309593305771
curr_Factors:  [102.79309593]
mat_Sqrt:  [[0.15]]
grads:  [-0.04735054]
Stock Position:  -0.047350544241084674
Bond Position:  [39.58433975]


portfolio before change:  [34.71016185]
curr_Stock_Price:  103.35625700396726
curr_Factors:  [103.356257]
mat_Sqrt:  [[0.15]]
grads:  [0.00883547]
Stock Position:  0.00883546782416704
Bond Position:  [33.79696097]


portfolio before change:  [34.71968901]
curr_Stock_Price:  102.5214905468782
curr_Factors:  [102.52149055]
mat_Sqrt:  [[0.15]]
grads:  [0.00169944]
Stock Position:  0.001699439207825176
Bond Position:  [34.54545997]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [34.73627067]
Stock Price:  102.11230627461197
PL:  [32.6239644]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.50384489e-02]
 [-1.45264486e-02]
 [-4.57867996e-03]
 [ 9.18032493e-03]
 [-1.80214900e-02]
 [ 1.33011646e-02]
 [-1.52134476e-02]
 [ 2.84224672e-03]
 [-3.24169804e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-80.18477138]
curr_Stock_Price:  96.31193885474217
curr_Factors:  [96.31193885]
mat_Sqrt:  [[0.15]]
grads:  [-0.10025633]
Stock Position:  -0.10025632625304702
Bond Position:  [-70.52889021]


portfolio before change:  [-80.30239937]
curr_Stock_Price:  97.13338061699315
curr_Factors:  [97.13338062]
mat_Sqrt:  [[0.15]]
grads:  [-0.09684299]
Stock Position:  -0.09684299082893635
Bond Position:  [-70.89571228]


portfolio before change:  [-80.4321381]
curr_Stock_Price:  98.1069359760452
curr_Factors:  [98.10693598]
mat_Sqrt:  [[0.15]]
grads:  [-0.03052453]
Stock Position:  -0.030524533086035723
Bond Position:  [-77.43746969]


portfolio before change:  [-80.47847807]
curr_Stock_Price:  98.35629429012437
curr_Factors:  [98.35629429]
mat_Sqrt:  [[0.15]]
grads:  [0.06120217]
Stock Position:  0.06120216622716837
Bond Position:  [-86.49809634]


portfolio before change:  [-80.50470516]
curr_Stock_Price:  98.63459770558502
curr_Factors:  [98.63459771]
mat_Sqrt:  [[0.15]]
grads:  [-0.12014327]
Stock Position:  -0.12014326659278464
Bond Position:  [-68.65442239]


portfolio before change:  [-80.34785932]
curr_Stock_Price:  97.0433172726166
curr_Factors:  [97.04331727]
mat_Sqrt:  [[0.15]]
grads:  [0.08867443]
Stock Position:  0.08867443043788152
Bond Position:  [-88.95312021]


portfolio before change:  [-80.2663798]
curr_Stock_Price:  98.46387565358712
curr_Factors:  [98.46387565]
mat_Sqrt:  [[0.15]]
grads:  [-0.10142298]
Stock Position:  -0.10142298412908678
Bond Position:  [-70.2798797]


portfolio before change:  [-80.06666603]
curr_Stock_Price:  96.14820235430922
curr_Factors:  [96.14820235]
mat_Sqrt:  [[0.15]]
grads:  [0.01894831]
Stock Position:  0.018948311497830068
Bond Position:  [-81.88851212]


portfolio before change:  [-80.07043144]
curr_Stock_Price:  98.11086163520105
curr_Factors:  [98.11086164]
mat_Sqrt:  [[0.15]]
grads:  [-0.02161132]
Stock Position:  -0.02161132027302166
Bond Position:  [-77.95012619]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-80.12595681]
Stock Price:  98.8762272570913
PL:  [-80.12595681]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.40784484e-02]
 [-1.28271155e-02]
 [ 4.42256837e-03]
 [ 1.14016210e-02]
 [ 1.00782392e-02]
 [ 5.15784387e-03]
 [-1.11031643e-02]
 [ 2.80820387e-03]
 [ 1.42445560e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.30304616]
curr_Stock_Price:  100.91883085717595
curr_Factors:  [100.91883086]
mat_Sqrt:  [[0.15]]
grads:  [-0.09385632]
Stock Position:  -0.09385632235209788
Bond Position:  [30.77491648]


portfolio before change:  [21.4334391]
curr_Stock_Price:  99.69353633941935
curr_Factors:  [99.69353634]
mat_Sqrt:  [[0.15]]
grads:  [-0.0855141]
Stock Position:  -0.08551410360537935
Bond Position:  [29.9586425]


portfolio before change:  [21.46273691]
curr_Stock_Price:  99.5261400524519
curr_Factors:  [99.52614005]
mat_Sqrt:  [[0.15]]
grads:  [0.02948379]
Stock Position:  0.0294837891651577
Bond Position:  [18.52832918]


portfolio before change:  [21.47496646]
curr_Stock_Price:  99.62663820069403
curr_Factors:  [99.6266382]
mat_Sqrt:  [[0.15]]
grads:  [0.07601081]
Stock Position:  0.07601080698439759
Bond Position:  [13.90226529]


portfolio before change:  [21.49108717]
curr_Stock_Price:  99.74725053639413
curr_Factors:  [99.74725054]
mat_Sqrt:  [[0.15]]
grads:  [0.06718826]
Stock Position:  0.06718826153945583
Bond Position:  [14.78924282]


portfolio before change:  [21.74531499]
curr_Stock_Price:  103.4209777574663
curr_Factors:  [103.42097776]
mat_Sqrt:  [[0.15]]
grads:  [0.03438563]
Stock Position:  0.034385625770156164
Bond Position:  [18.18911995]


portfolio before change:  [21.68355122]
curr_Stock_Price:  101.3602155135816
curr_Factors:  [101.36021551]
mat_Sqrt:  [[0.15]]
grads:  [-0.0740211]
Stock Position:  -0.074021095181587
Bond Position:  [29.18634538]


portfolio before change:  [21.65215534]
curr_Stock_Price:  101.98156145026807
curr_Factors:  [101.98156145]
mat_Sqrt:  [[0.15]]
grads:  [0.01872136]
Stock Position:  0.018721359165630766
Bond Position:  [19.7429219]


portfolio before change:  [21.70087331]
curr_Stock_Price:  104.05641311845123
curr_Factors:  [104.05641312]
mat_Sqrt:  [[0.15]]
grads:  [0.00949637]
Stock Position:  0.009496370699294024
Bond Position:  [20.71271504]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.73143188]
Stock Price:  106.18350159964909
PL:  [15.54793028]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.49813066e-02]
 [-6.72261734e-03]
 [-9.31525654e-02]
 [ 5.72582798e-03]
 [ 7.73986610e-02]
 [-9.80096642e-05]
 [-5.93010510e-03]
 [ 1.22648794e-03]
 [ 7.31209113e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [35.38676466]
curr_Stock_Price:  101.55814079289289
curr_Factors:  [101.55814079]
mat_Sqrt:  [[0.15]]
grads:  [-0.09987538]
Stock Position:  -0.09987537716207746
Bond Position:  [45.52992227]


portfolio before change:  [35.21639508]
curr_Stock_Price:  103.49195307891262
curr_Factors:  [103.49195308]
mat_Sqrt:  [[0.15]]
grads:  [-0.04481745]
Stock Position:  -0.044817448961301194
Bond Position:  [39.8546404]


portfolio before change:  [35.13664316]
curr_Stock_Price:  105.71618107534039
curr_Factors:  [105.71618108]
mat_Sqrt:  [[0.15]]
grads:  [-0.6210171]
Stock Position:  -0.6210171027363384
Bond Position:  [100.78819964]


portfolio before change:  [34.89586773]
curr_Stock_Price:  106.18506047595224
curr_Factors:  [106.18506048]
mat_Sqrt:  [[0.15]]
grads:  [0.03817219]
Stock Position:  0.03817218650447882
Bond Position:  [30.8425518]


portfolio before change:  [34.93426104]
curr_Stock_Price:  106.78675984374215
curr_Factors:  [106.78675984]
mat_Sqrt:  [[0.15]]
grads:  [0.51599107]
Stock Position:  0.5159910735305461
Bond Position:  [-20.16675381]


portfolio before change:  [34.31382167]
curr_Stock_Price:  105.60388381418804
curr_Factors:  [105.60388381]
mat_Sqrt:  [[0.15]]
grads:  [-0.0006534]
Stock Position:  -0.0006533977616059288
Bond Position:  [34.38282301]


portfolio before change:  [34.33196587]
curr_Stock_Price:  104.15226233419371
curr_Factors:  [104.15226233]
mat_Sqrt:  [[0.15]]
grads:  [-0.03953403]
Stock Position:  -0.03953403398696379
Bond Position:  [38.44952495]


portfolio before change:  [34.37628032]
curr_Stock_Price:  103.51774875506203
curr_Factors:  [103.51774876]
mat_Sqrt:  [[0.15]]
grads:  [0.00817659]
Stock Position:  0.008176586272055753
Bond Position:  [33.52985852]


portfolio before change:  [34.39074718]
curr_Stock_Price:  103.23618160061925
curr_Factors:  [103.2361816]
mat_Sqrt:  [[0.15]]
grads:  [0.00487473]
Stock Position:  0.004874727420102512
Bond Position:  [33.88749894]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [34.40890804]
Stock Price:  103.48498890620141
PL:  [30.92391913]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.33636687e-02]
 [-1.47531982e-02]
 [-1.38222340e-02]
 [ 6.16383607e-03]
 [-3.42685583e-02]
 [ 1.36977308e-02]
 [-1.39580255e-02]
 [ 1.80723615e-03]
 [-1.02712071e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-42.21058509]
curr_Stock_Price:  98.03572186011779
curr_Factors:  [98.03572186]
mat_Sqrt:  [[0.15]]
grads:  [-0.08909112]
Stock Position:  -0.0890911245856031
Bond Position:  [-33.47647238]


portfolio before change:  [-42.19910071]
curr_Stock_Price:  97.7188912731165
curr_Factors:  [97.71889127]
mat_Sqrt:  [[0.15]]
grads:  [-0.09835465]
Stock Position:  -0.09835465476884402
Bond Position:  [-32.5879929]


portfolio before change:  [-42.14303184]
curr_Stock_Price:  96.98311573720554
curr_Factors:  [96.98311574]
mat_Sqrt:  [[0.15]]
grads:  [-0.09214823]
Stock Position:  -0.0921482264151041
Bond Position:  [-33.20620973]


portfolio before change:  [-42.08592907]
curr_Stock_Price:  96.1832086303404
curr_Factors:  [96.18320863]
mat_Sqrt:  [[0.15]]
grads:  [0.04109224]
Stock Position:  0.04109224047407409
Bond Position:  [-46.03831261]


portfolio before change:  [-42.09824764]
curr_Stock_Price:  96.44375276370474
curr_Factors:  [96.44375276]
mat_Sqrt:  [[0.15]]
grads:  [-0.22845706]
Stock Position:  -0.2284570553281184
Bond Position:  [-20.06499188]


portfolio before change:  [-42.02168135]
curr_Stock_Price:  96.06468240725208
curr_Factors:  [96.06468241]
mat_Sqrt:  [[0.15]]
grads:  [0.09131821]
Stock Position:  0.09131820549889477
Bond Position:  [-50.79413576]


portfolio before change:  [-41.97201996]
curr_Stock_Price:  96.88669601572023
curr_Factors:  [96.88669602]
mat_Sqrt:  [[0.15]]
grads:  [-0.0930535]
Stock Position:  -0.0930535033445111
Bond Position:  [-32.95637347]


portfolio before change:  [-41.81355518]
curr_Stock_Price:  95.00662619948184
curr_Factors:  [95.0066262]
mat_Sqrt:  [[0.15]]
grads:  [0.01204824]
Stock Position:  0.012048241027735523
Bond Position:  [-42.95821791]


portfolio before change:  [-41.82423184]
curr_Stock_Price:  95.90367165094635
curr_Factors:  [95.90367165]
mat_Sqrt:  [[0.15]]
grads:  [-0.06847471]
Stock Position:  -0.06847471414404857
Bond Position:  [-35.25725534]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-41.95704238]
Stock Price:  97.5857159123415
PL:  [-41.95704238]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.36904165e-02]
 [-7.90932911e-03]
 [-2.23440474e-02]
 [ 5.82642849e-03]
 [ 6.83354395e-02]
 [-2.51132084e-03]
 [-6.08783899e-03]
 [-2.67296889e-03]
 [ 2.76559723e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.23739493]
curr_Stock_Price:  100.64348943387267
curr_Factors:  [100.64348943]
mat_Sqrt:  [[0.15]]
grads:  [-0.09126944]
Stock Position:  -0.09126944358647539
Bond Position:  [24.42307021]


portfolio before change:  [15.13671209]
curr_Stock_Price:  101.88045799057187
curr_Factors:  [101.88045799]
mat_Sqrt:  [[0.15]]
grads:  [-0.05272886]
Stock Position:  -0.05272886070702472
Bond Position:  [20.50875257]


portfolio before change:  [15.04876611]
curr_Stock_Price:  103.74287101358489
curr_Factors:  [103.74287101]
mat_Sqrt:  [[0.15]]
grads:  [-0.14896032]
Stock Position:  -0.14896031583670966
Bond Position:  [30.50233694]


portfolio before change:  [14.59700971]
curr_Stock_Price:  106.87801058859051
curr_Factors:  [106.87801059]
mat_Sqrt:  [[0.15]]
grads:  [0.03884286]
Stock Position:  0.03884285660757207
Bond Position:  [10.44556247]


portfolio before change:  [14.576664]
curr_Stock_Price:  106.21972225512614
curr_Factors:  [106.21972226]
mat_Sqrt:  [[0.15]]
grads:  [0.4555696]
Stock Position:  0.45556959694428256
Bond Position:  [-33.81381205]


portfolio before change:  [14.88428483]
curr_Stock_Price:  106.932087529024
curr_Factors:  [106.93208753]
mat_Sqrt:  [[0.15]]
grads:  [-0.01674214]
Stock Position:  -0.016742138949298442
Bond Position:  [16.6745567]


portfolio before change:  [14.88038373]
curr_Stock_Price:  107.66320433611475
curr_Factors:  [107.66320434]
mat_Sqrt:  [[0.15]]
grads:  [-0.04058559]
Stock Position:  -0.040585593258672316
Bond Position:  [19.24995875]


portfolio before change:  [14.83825962]
curr_Stock_Price:  108.9383242247342
curr_Factors:  [108.93832422]
mat_Sqrt:  [[0.15]]
grads:  [-0.01781979]
Stock Position:  -0.01781979258838871
Bond Position:  [16.77951796]


portfolio before change:  [14.84096722]
curr_Stock_Price:  109.25730970379134
curr_Factors:  [109.2573097]
mat_Sqrt:  [[0.15]]
grads:  [0.01843731]
Stock Position:  0.018437314863905086
Bond Position:  [12.8265558]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.83652829]
Stock Price:  108.66862221722255
PL:  [6.16790607]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30810383e-02]
 [-1.44781506e-02]
 [-1.78120476e-03]
 [ 9.04449877e-03]
 [-2.12455429e-02]
 [ 7.61284567e-03]
 [-8.29571448e-03]
 [ 1.80474354e-03]
 [ 1.56534929e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.9555513]
curr_Stock_Price:  99.72685998247587
curr_Factors:  [99.72685998]
mat_Sqrt:  [[0.15]]
grads:  [-0.08720692]
Stock Position:  -0.0872069216750875
Bond Position:  [3.74132117]


portfolio before change:  [-4.83549984]
curr_Stock_Price:  98.37168854977263
curr_Factors:  [98.37168855]
mat_Sqrt:  [[0.15]]
grads:  [-0.096521]
Stock Position:  -0.0965210039844229
Bond Position:  [4.6594343]


portfolio before change:  [-4.84044347]
curr_Stock_Price:  98.44704966542336
curr_Factors:  [98.44704967]
mat_Sqrt:  [[0.15]]
grads:  [-0.0118747]
Stock Position:  -0.011874698382135507
Bond Position:  [-3.67141445]


portfolio before change:  [-4.83989031]
curr_Stock_Price:  98.24583779254556
curr_Factors:  [98.24583779]
mat_Sqrt:  [[0.15]]
grads:  [0.06029666]
Stock Position:  0.06029665849284219
Bond Position:  [-10.76378604]


portfolio before change:  [-4.83773458]
curr_Stock_Price:  98.37086915395274
curr_Factors:  [98.37086915]
mat_Sqrt:  [[0.15]]
grads:  [-0.14163695]
Stock Position:  -0.1416369527229756
Bond Position:  [9.09521557]


portfolio before change:  [-5.42448604]
curr_Stock_Price:  102.54562859303368
curr_Factors:  [102.54562859]
mat_Sqrt:  [[0.15]]
grads:  [0.0507523]
Stock Position:  0.05075230448798491
Bond Position:  [-10.628913]


portfolio before change:  [-5.4406817]
curr_Stock_Price:  102.33125651422422
curr_Factors:  [102.33125651]
mat_Sqrt:  [[0.15]]
grads:  [-0.05530476]
Stock Position:  -0.055304763215856666
Bond Position:  [0.21872421]


portfolio before change:  [-5.47041239]
curr_Stock_Price:  102.87081374804542
curr_Factors:  [102.87081375]
mat_Sqrt:  [[0.15]]
grads:  [0.01203162]
Stock Position:  0.012031623595849883
Bond Position:  [-6.7081153]


portfolio before change:  [-5.45785266]
curr_Stock_Price:  104.19354722856268
curr_Factors:  [104.19354723]
mat_Sqrt:  [[0.15]]
grads:  [0.01043566]
Stock Position:  0.01043566190569423
Bond Position:  [-6.54518129]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.45392195]
Stock Price:  104.88388349843359
PL:  [-10.33780545]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.34375276e-02]
 [-7.95138003e-03]
 [-3.26773463e-02]
 [ 5.62132874e-03]
 [ 6.75269435e-02]
 [-4.53931870e-03]
 [-6.10417620e-03]
 [-2.27470402e-03]
 [ 2.66101983e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.7175427]
curr_Stock_Price:  100.30213666889756
curr_Factors:  [100.30213667]
mat_Sqrt:  [[0.15]]
grads:  [-0.08958352]
Stock Position:  -0.08958351739957678
Bond Position:  [16.7029609]


portfolio before change:  [7.58962876]
curr_Stock_Price:  101.8232591327795
curr_Factors:  [101.82325913]
mat_Sqrt:  [[0.15]]
grads:  [-0.0530092]
Stock Position:  -0.053009200200184556
Bond Position:  [12.98719829]


portfolio before change:  [7.47631935]
curr_Stock_Price:  104.08333165661888
curr_Factors:  [104.08333166]
mat_Sqrt:  [[0.15]]
grads:  [-0.21784898]
Stock Position:  -0.21784897506060702
Bond Position:  [30.15076647]


portfolio before change:  [7.1215231]
curr_Stock_Price:  105.78118402916195
curr_Factors:  [105.78118403]
mat_Sqrt:  [[0.15]]
grads:  [0.03747552]
Stock Position:  0.03747552493818771
Bond Position:  [3.1573177]


portfolio before change:  [7.13770536]
curr_Stock_Price:  106.17085700531038
curr_Factors:  [106.17085701]
mat_Sqrt:  [[0.15]]
grads:  [0.45017962]
Stock Position:  0.45017962356595886
Bond Position:  [-40.65825108]


portfolio before change:  [8.02063689]
curr_Stock_Price:  108.17731330934691
curr_Factors:  [108.17731331]
mat_Sqrt:  [[0.15]]
grads:  [-0.03026212]
Stock Position:  -0.03026212465197484
Bond Position:  [11.29431223]


portfolio before change:  [8.03083884]
curr_Stock_Price:  108.02684851506201
curr_Factors:  [108.02684852]
mat_Sqrt:  [[0.15]]
grads:  [-0.04069451]
Stock Position:  -0.040694508019373465
Bond Position:  [12.4269383]


portfolio before change:  [8.02735943]
curr_Stock_Price:  108.26507324240411
curr_Factors:  [108.26507324]
mat_Sqrt:  [[0.15]]
grads:  [-0.01516469]
Stock Position:  -0.015164693491759917
Bond Position:  [9.66916608]


portfolio before change:  [8.01073454]
curr_Stock_Price:  109.68024757715419
curr_Factors:  [109.68024758]
mat_Sqrt:  [[0.15]]
grads:  [0.01774013]
Stock Position:  0.01774013222363986
Bond Position:  [6.06499244]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.00792373]
Stock Price:  109.35082180753089
PL:  [-1.34289807]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30486772e-02]
 [-1.35288116e-02]
 [ 4.10800887e-03]
 [ 1.09697563e-02]
 [ 3.75694119e-03]
 [ 9.48406031e-03]
 [-1.28545536e-02]
 [ 4.11970128e-03]
 [ 2.72869549e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.86724692]
curr_Stock_Price:  99.68547488467924
curr_Factors:  [99.68547488]
mat_Sqrt:  [[0.15]]
grads:  [-0.08699118]
Stock Position:  -0.08699118155685914
Bond Position:  [2.80451032]


portfolio before change:  [-5.82388537]
curr_Stock_Price:  99.20313922423118
curr_Factors:  [99.20313922]
mat_Sqrt:  [[0.15]]
grads:  [-0.09019208]
Stock Position:  -0.09019207741626317
Bond Position:  [3.12345185]


portfolio before change:  [-5.83737447]
curr_Stock_Price:  99.37001890719347
curr_Factors:  [99.37001891]
mat_Sqrt:  [[0.15]]
grads:  [0.02738673]
Stock Position:  0.027386725801018925
Bond Position:  [-8.55879393]


portfolio before change:  [-5.84138652]
curr_Stock_Price:  99.37981986440766
curr_Factors:  [99.37981986]
mat_Sqrt:  [[0.15]]
grads:  [0.07313171]
Stock Position:  0.07313170871081746
Bond Position:  [-13.10920256]


portfolio before change:  [-5.83963028]
curr_Stock_Price:  99.49348439721491
curr_Factors:  [99.4934844]
mat_Sqrt:  [[0.15]]
grads:  [0.02504627]
Stock Position:  0.02504627461671375
Bond Position:  [-8.33157142]


portfolio before change:  [-5.78746627]
curr_Stock_Price:  101.74255490885022
curr_Factors:  [101.74255491]
mat_Sqrt:  [[0.15]]
grads:  [0.06322707]
Stock Position:  0.063227068764011
Bond Position:  [-12.22034979]


portfolio before change:  [-5.86402652]
curr_Stock_Price:  100.62833995390498
curr_Factors:  [100.62833995]
mat_Sqrt:  [[0.15]]
grads:  [-0.08569702]
Stock Position:  -0.08569702424940615
Bond Position:  [2.75952277]


portfolio before change:  [-5.85248402]
curr_Stock_Price:  100.50975474660221
curr_Factors:  [100.50975475]
mat_Sqrt:  [[0.15]]
grads:  [0.02746468]
Stock Position:  0.0274646752201141
Bond Position:  [-8.61295179]


portfolio before change:  [-5.87816101]
curr_Stock_Price:  99.73168453688706
curr_Factors:  [99.73168454]
mat_Sqrt:  [[0.15]]
grads:  [0.00181913]
Stock Position:  0.001819130326231828
Bond Position:  [-6.05958595]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.88006447]
Stock Price:  100.3512618444877
PL:  [-6.23132632]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.66908882e-02]
 [-6.91906883e-03]
 [-4.60521100e-03]
 [ 4.80983015e-03]
 [ 2.61675715e-02]
 [ 5.42590658e-03]
 [-6.41454134e-03]
 [ 6.63035631e-05]
 [ 1.07832314e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [63.86024171]
curr_Stock_Price:  102.8506529083365
curr_Factors:  [102.85065291]
mat_Sqrt:  [[0.15]]
grads:  [-0.11127259]
Stock Position:  -0.11127258788288875
Bond Position:  [75.30470003]


portfolio before change:  [63.85597762]
curr_Stock_Price:  103.22743806890284
curr_Factors:  [103.22743807]
mat_Sqrt:  [[0.15]]
grads:  [-0.04612713]
Stock Position:  -0.046127125514568094
Bond Position:  [68.61756261]


portfolio before change:  [63.89347889]
curr_Stock_Price:  103.15841335815634
curr_Factors:  [103.15841336]
mat_Sqrt:  [[0.15]]
grads:  [-0.03070141]
Stock Position:  -0.030701406681106977
Bond Position:  [67.06058729]


portfolio before change:  [63.94464933]
curr_Stock_Price:  102.58411517692517
curr_Factors:  [102.58411518]
mat_Sqrt:  [[0.15]]
grads:  [0.03206553]
Stock Position:  0.03206553432542381
Bond Position:  [60.65523486]


portfolio before change:  [64.00983958]
curr_Stock_Price:  103.67110928615442
curr_Factors:  [103.67110929]
mat_Sqrt:  [[0.15]]
grads:  [0.17445048]
Stock Position:  0.17445047637904246
Bond Position:  [45.92436518]


portfolio before change:  [63.97077935]
curr_Stock_Price:  103.31554617561682
curr_Factors:  [103.31554618]
mat_Sqrt:  [[0.15]]
grads:  [0.03617271]
Stock Position:  0.03617271053972435
Bond Position:  [60.233576]


portfolio before change:  [63.99182402]
curr_Stock_Price:  103.06453789475228
curr_Factors:  [103.06453789]
mat_Sqrt:  [[0.15]]
grads:  [-0.04276361]
Stock Position:  -0.04276360891340325
Bond Position:  [68.39923561]


portfolio before change:  [63.95895563]
curr_Stock_Price:  104.63308077937451
curr_Factors:  [104.63308078]
mat_Sqrt:  [[0.15]]
grads:  [0.00044202]
Stock Position:  0.00044202375381281457
Bond Position:  [63.91270532]


portfolio before change:  [63.99051616]
curr_Stock_Price:  103.71951676417477
curr_Factors:  [103.71951676]
mat_Sqrt:  [[0.15]]
grads:  [0.00718882]
Stock Position:  0.007188820938092977
Bond Position:  [63.24489512]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [64.04279917]
Stock Price:  106.59240186234923
PL:  [57.45039731]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.35826539e-02]
 [-1.38871556e-02]
 [ 2.05778670e-03]
 [ 9.49291703e-03]
 [ 2.24412560e-02]
 [ 2.21006780e-03]
 [-9.14068751e-03]
 [ 2.03533895e-03]
 [ 1.66535322e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.44418798]
curr_Stock_Price:  100.51669586332541
curr_Factors:  [100.51669586]
mat_Sqrt:  [[0.15]]
grads:  [-0.09055103]
Stock Position:  -0.09055102582779419
Bond Position:  [21.54607791]


portfolio before change:  [12.60232661]
curr_Stock_Price:  98.88929420638645
curr_Factors:  [98.88929421]
mat_Sqrt:  [[0.15]]
grads:  [-0.09258104]
Stock Position:  -0.0925810370175238
Bond Position:  [21.75760001]


portfolio before change:  [12.60257744]
curr_Stock_Price:  99.00411991631375
curr_Factors:  [99.00411992]
mat_Sqrt:  [[0.15]]
grads:  [0.01371858]
Stock Position:  0.013718578011329557
Bond Position:  [11.2443817]


portfolio before change:  [12.60214036]
curr_Stock_Price:  98.5623335269209
curr_Factors:  [98.56233353]
mat_Sqrt:  [[0.15]]
grads:  [0.06328611]
Stock Position:  0.06328611356472906
Bond Position:  [6.36451333]


portfolio before change:  [12.91438484]
curr_Stock_Price:  103.44589192757553
curr_Factors:  [103.44589193]
mat_Sqrt:  [[0.15]]
grads:  [0.14960837]
Stock Position:  0.1496083734193029
Bond Position:  [-2.56198679]


portfolio before change:  [13.08441333]
curr_Stock_Price:  104.59094681124272
curr_Factors:  [104.59094681]
mat_Sqrt:  [[0.15]]
grads:  [0.01473379]
Stock Position:  0.01473378535922503
Bond Position:  [11.54339277]


portfolio before change:  [13.05239212]
curr_Stock_Price:  102.02579823221026
curr_Factors:  [102.02579823]
mat_Sqrt:  [[0.15]]
grads:  [-0.06093792]
Stock Position:  -0.06093791675253512
Bond Position:  [19.26963172]


portfolio before change:  [13.02646059]
curr_Stock_Price:  102.60948660238051
curr_Factors:  [102.6094866]
mat_Sqrt:  [[0.15]]
grads:  [0.01356893]
Stock Position:  0.01356892632574518
Bond Position:  [11.63416003]


portfolio before change:  [13.05510785]
curr_Stock_Price:  104.29191325982526
curr_Factors:  [104.29191326]
mat_Sqrt:  [[0.15]]
grads:  [0.01110235]
Stock Position:  0.011102354833214765
Bond Position:  [11.89722202]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.04466389]
Stock Price:  102.81528405350586
PL:  [10.22937983]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.34888300e-02]
 [-1.11203846e-02]
 [ 1.32283923e-02]
 [ 6.49020870e-03]
 [-5.63520456e-03]
 [ 1.19084889e-02]
 [-1.02705963e-02]
 [ 1.60405294e-03]
 [-6.87289554e-05]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.3637771]
curr_Stock_Price:  100.37686508751705
curr_Factors:  [100.37686509]
mat_Sqrt:  [[0.15]]
grads:  [-0.08992553]
Stock Position:  -0.08992553365158154
Bond Position:  [18.39022026]


portfolio before change:  [9.32239624]
curr_Stock_Price:  100.93931126061385
curr_Factors:  [100.93931126]
mat_Sqrt:  [[0.15]]
grads:  [-0.0741359]
Stock Position:  -0.0741358971533194
Bond Position:  [16.80562264]


portfolio before change:  [9.36431705]
curr_Stock_Price:  100.48722387888508
curr_Factors:  [100.48722388]
mat_Sqrt:  [[0.15]]
grads:  [0.08818928]
Stock Position:  0.08818928168390072
Bond Position:  [0.50242096]


portfolio before change:  [9.08294638]
curr_Stock_Price:  97.29384315674079
curr_Factors:  [97.29384316]
mat_Sqrt:  [[0.15]]
grads:  [0.04326806]
Stock Position:  0.04326805800626939
Bond Position:  [4.87323073]


portfolio before change:  [9.16838598]
curr_Stock_Price:  99.21217226931121
curr_Factors:  [99.21217227]
mat_Sqrt:  [[0.15]]
grads:  [-0.03756803]
Stock Position:  -0.03756803040934056
Bond Position:  [12.89559188]


portfolio before change:  [9.19351651]
curr_Stock_Price:  98.71491107038578
curr_Factors:  [98.71491107]
mat_Sqrt:  [[0.15]]
grads:  [0.07938993]
Stock Position:  0.0793899259912386
Bond Position:  [1.35654702]


portfolio before change:  [9.42709261]
curr_Stock_Price:  101.64850317363042
curr_Factors:  [101.64850317]
mat_Sqrt:  [[0.15]]
grads:  [-0.06847064]
Stock Position:  -0.06847064174842292
Bond Position:  [16.38703086]


portfolio before change:  [9.33806299]
curr_Stock_Price:  103.06845756610953
curr_Factors:  [103.06845757]
mat_Sqrt:  [[0.15]]
grads:  [0.01069369]
Stock Position:  0.010693686244671171
Bond Position:  [8.23588124]


portfolio before change:  [9.32965937]
curr_Stock_Price:  101.89743095073784
curr_Factors:  [101.89743095]
mat_Sqrt:  [[0.15]]
grads:  [-0.00045819]
Stock Position:  -0.00045819303610611665
Bond Position:  [9.37634806]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.33597826]
Stock Price:  98.34096063612316
PL:  [9.33597826]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.42320647e-02]
 [-1.26733806e-02]
 [ 1.68092840e-02]
 [ 8.41906243e-03]
 [-1.01583988e-04]
 [ 1.31690895e-02]
 [-1.18573167e-02]
 [ 3.59546812e-03]
 [ 3.71540789e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.6994549]
curr_Stock_Price:  101.02761234949878
curr_Factors:  [101.02761235]
mat_Sqrt:  [[0.15]]
grads:  [-0.09488043]
Stock Position:  -0.09488043134955013
Bond Position:  [33.28499834]


portfolio before change:  [23.75301757]
curr_Stock_Price:  100.63853303072207
curr_Factors:  [100.63853303]
mat_Sqrt:  [[0.15]]
grads:  [-0.0844892]
Stock Position:  -0.08448920402200538
Bond Position:  [32.25588712]


portfolio before change:  [23.75837833]
curr_Stock_Price:  100.76601930800649
curr_Factors:  [100.76601931]
mat_Sqrt:  [[0.15]]
grads:  [0.11206189]
Stock Position:  0.11206189348331583
Bond Position:  [12.46634741]


portfolio before change:  [23.77680508]
curr_Stock_Price:  100.87481643035613
curr_Factors:  [100.87481643]
mat_Sqrt:  [[0.15]]
grads:  [0.05612708]
Stock Position:  0.05612708285050977
Bond Position:  [18.1149959]


portfolio before change:  [23.7018481]
curr_Stock_Price:  99.37791443508887
curr_Factors:  [99.37791444]
mat_Sqrt:  [[0.15]]
grads:  [-0.00067723]
Stock Position:  -0.0006772265857904469
Bond Position:  [23.76914946]


portfolio before change:  [23.71309862]
curr_Stock_Price:  100.31854573153227
curr_Factors:  [100.31854573]
mat_Sqrt:  [[0.15]]
grads:  [0.08779393]
Stock Position:  0.08779392989037917
Bond Position:  [14.90573925]


portfolio before change:  [23.76860088]
curr_Stock_Price:  100.8658218499975
curr_Factors:  [100.86582185]
mat_Sqrt:  [[0.15]]
grads:  [-0.07904878]
Stock Position:  -0.07904877824707077
Bond Position:  [31.74192086]


portfolio before change:  [23.74411489]
curr_Stock_Price:  101.37640430737477
curr_Factors:  [101.37640431]
mat_Sqrt:  [[0.15]]
grads:  [0.02396979]
Stock Position:  0.023969787483087833
Bond Position:  [21.31414402]


portfolio before change:  [23.72930465]
curr_Stock_Price:  100.3138176576543
curr_Factors:  [100.31381766]
mat_Sqrt:  [[0.15]]
grads:  [0.00247694]
Stock Position:  0.002476938592558039
Bond Position:  [23.48083348]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.74508627]
Stock Price:  101.94416384627044
PL:  [21.80092242]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30953007e-02]
 [-8.02144959e-03]
 [ 4.98147700e-03]
 [ 8.63388091e-03]
 [-3.21592104e-02]
 [ 1.32329470e-02]
 [-1.54635879e-02]
 [ 3.93573949e-03]
 [ 3.73634610e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.5865135]
curr_Stock_Price:  99.74361191699923
curr_Factors:  [99.74361192]
mat_Sqrt:  [[0.15]]
grads:  [-0.087302]
Stock Position:  -0.08730200477559974
Bond Position:  [4.12130378]


portfolio before change:  [-4.7576889]
curr_Stock_Price:  101.72794853691462
curr_Factors:  [101.72794854]
mat_Sqrt:  [[0.15]]
grads:  [-0.05347633]
Stock Position:  -0.05347633057951065
Bond Position:  [0.6823485]


portfolio before change:  [-4.65736009]
curr_Stock_Price:  99.85819515437008
curr_Factors:  [99.85819515]
mat_Sqrt:  [[0.15]]
grads:  [0.03320985]
Stock Position:  0.03320984663644912
Bond Position:  [-7.97363544]


portfolio before change:  [-4.72598356]
curr_Stock_Price:  97.91191529178214
curr_Factors:  [97.91191529]
mat_Sqrt:  [[0.15]]
grads:  [0.05755921]
Stock Position:  0.05755920606827032
Bond Position:  [-10.36171567]


portfolio before change:  [-4.78601843]
curr_Stock_Price:  96.95893635795767
curr_Factors:  [96.95893636]
mat_Sqrt:  [[0.15]]
grads:  [-0.21439474]
Stock Position:  -0.21439473568827352
Bond Position:  [16.00146711]


portfolio before change:  [-4.70377663]
curr_Stock_Price:  96.61266357283107
curr_Factors:  [96.61266357]
mat_Sqrt:  [[0.15]]
grads:  [0.08821965]
Stock Position:  0.0882196467522503
Bond Position:  [-13.22691168]


portfolio before change:  [-4.49123649]
curr_Stock_Price:  99.09686360075929
curr_Factors:  [99.0968636]
mat_Sqrt:  [[0.15]]
grads:  [-0.10309059]
Stock Position:  -0.10309058626798738
Bond Position:  [5.72471727]


portfolio before change:  [-4.65801897]
curr_Stock_Price:  100.7424605218181
curr_Factors:  [100.74246052]
mat_Sqrt:  [[0.15]]
grads:  [0.02623826]
Stock Position:  0.026238263298296757
Bond Position:  [-7.30132617]


portfolio before change:  [-4.6721258]
curr_Stock_Price:  100.34398675826559
curr_Factors:  [100.34398676]
mat_Sqrt:  [[0.15]]
grads:  [0.0024909]
Stock Position:  0.002490897399944009
Bond Position:  [-4.92207238]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.68115997]
Stock Price:  97.7053732335591
PL:  [-4.68115997]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30123622e-02]
 [-1.46058109e-02]
 [-1.91377367e-02]
 [ 7.31496472e-03]
 [-4.29487707e-02]
 [ 1.55422141e-02]
 [-1.57623544e-02]
 [ 1.06446737e-04]
 [-1.80978105e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.92588408]
curr_Stock_Price:  99.63741958934797
curr_Factors:  [99.63741959]
mat_Sqrt:  [[0.15]]
grads:  [-0.08674908]
Stock Position:  -0.08674908124584996
Bond Position:  [1.71757053]


portfolio before change:  [-6.72314758]
curr_Stock_Price:  97.31027684012008
curr_Factors:  [97.31027684]
mat_Sqrt:  [[0.15]]
grads:  [-0.09737207]
Stock Position:  -0.09737207258245859
Bond Position:  [2.75215576]


portfolio before change:  [-6.62698786]
curr_Stock_Price:  96.33686326817639
curr_Factors:  [96.33686327]
mat_Sqrt:  [[0.15]]
grads:  [-0.12758491]
Stock Position:  -0.12758491156123003
Bond Position:  [5.66414232]


portfolio before change:  [-6.25444922]
curr_Stock_Price:  93.43913925643801
curr_Factors:  [93.43913926]
mat_Sqrt:  [[0.15]]
grads:  [0.04876643]
Stock Position:  0.04876643145095363
Bond Position:  [-10.8111426]


portfolio before change:  [-6.21671867]
curr_Stock_Price:  94.32371229319736
curr_Factors:  [94.32371229]
mat_Sqrt:  [[0.15]]
grads:  [-0.28632514]
Stock Position:  -0.2863251378490957
Bond Position:  [20.79053125]


portfolio before change:  [-5.99435312]
curr_Stock_Price:  93.5834081560461
curr_Factors:  [93.58340816]
mat_Sqrt:  [[0.15]]
grads:  [0.10361476]
Stock Position:  0.10361476063697032
Bond Position:  [-15.69097556]


portfolio before change:  [-6.06356233]
curr_Stock_Price:  92.99119762323579
curr_Factors:  [92.99119762]
mat_Sqrt:  [[0.15]]
grads:  [-0.10508236]
Stock Position:  -0.10508236247801456
Bond Position:  [3.70817241]


portfolio before change:  [-6.07636933]
curr_Stock_Price:  93.13072203173718
curr_Factors:  [93.13072203]
mat_Sqrt:  [[0.15]]
grads:  [0.00070964]
Stock Position:  0.000709644914067105
Bond Position:  [-6.14245907]


portfolio before change:  [-6.07939913]
curr_Stock_Price:  93.19018756496898
curr_Factors:  [93.19018756]
mat_Sqrt:  [[0.15]]
grads:  [-0.12065207]
Stock Position:  -0.12065206991784784
Bond Position:  [5.1641899]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.16695023]
Stock Price:  93.93724344054493
PL:  [-6.16695023]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30289021e-02]
 [-1.41399248e-02]
 [ 2.88084310e-03]
 [ 1.04929321e-02]
 [ 1.03118159e-02]
 [ 1.18532249e-02]
 [-1.52571498e-02]
 [ 4.60619809e-03]
 [-1.16528660e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.71112891]
curr_Stock_Price:  99.0570519786904
curr_Factors:  [99.05705198]
mat_Sqrt:  [[0.15]]
grads:  [-0.08685935]
Stock Position:  -0.08685934735158948
Bond Position:  [-11.10709802]


portfolio before change:  [-19.50679106]
curr_Stock_Price:  96.64058449738812
curr_Factors:  [96.6405845]
mat_Sqrt:  [[0.15]]
grads:  [-0.09426617]
Stock Position:  -0.09426616564148484
Bond Position:  [-10.39685371]


portfolio before change:  [-19.75012377]
curr_Stock_Price:  99.16676109881583
curr_Factors:  [99.1667611]
mat_Sqrt:  [[0.15]]
grads:  [0.01920562]
Stock Position:  0.019205620669015846
Bond Position:  [-21.65468296]


portfolio before change:  [-19.76193103]
curr_Stock_Price:  99.11587963222458
curr_Factors:  [99.11587963]
mat_Sqrt:  [[0.15]]
grads:  [0.06995288]
Stock Position:  0.06995288045439861
Bond Position:  [-26.69537231]


portfolio before change:  [-19.73023425]
curr_Stock_Price:  99.75985307491491
curr_Factors:  [99.75985307]
mat_Sqrt:  [[0.15]]
grads:  [0.06874544]
Stock Position:  0.0687454392503409
Bond Position:  [-26.58826917]


portfolio before change:  [-19.67123703]
curr_Stock_Price:  100.81148180514894
curr_Factors:  [100.81148181]
mat_Sqrt:  [[0.15]]
grads:  [0.0790215]
Stock Position:  0.07902149954752753
Bond Position:  [-27.6375115]


portfolio before change:  [-19.85977702]
curr_Stock_Price:  98.60046610814125
curr_Factors:  [98.60046611]
mat_Sqrt:  [[0.15]]
grads:  [-0.10171433]
Stock Position:  -0.10171433227457358
Bond Position:  [-9.83069645]


portfolio before change:  [-19.94704793]
curr_Stock_Price:  99.41012913492263
curr_Factors:  [99.41012913]
mat_Sqrt:  [[0.15]]
grads:  [0.03070799]
Stock Position:  0.030707987272891563
Bond Position:  [-22.99973291]


portfolio before change:  [-20.07951687]
curr_Stock_Price:  95.47088694785886
curr_Factors:  [95.47088695]
mat_Sqrt:  [[0.15]]
grads:  [-0.07768577]
Stock Position:  -0.07768577309726783
Bond Position:  [-12.66278721]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.14317459]
Stock Price:  96.20879224215132
PL:  [-20.14317459]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.35777301e-02]
 [-7.54138877e-03]
 [ 1.71526958e-02]
 [ 5.23621622e-03]
 [ 4.27184519e-02]
 [-6.74961652e-04]
 [-5.96395643e-03]
 [ 2.10187239e-03]
 [-4.68753481e-05]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.28253104]
curr_Stock_Price:  100.50935768115453
curr_Factors:  [100.50935768]
mat_Sqrt:  [[0.15]]
grads:  [-0.0905182]
Stock Position:  -0.0905182006109635
Bond Position:  [21.38045724]


portfolio before change:  [12.1238116]
curr_Stock_Price:  102.38094085292863
curr_Factors:  [102.38094085]
mat_Sqrt:  [[0.15]]
grads:  [-0.05027593]
Stock Position:  -0.0502759251523015
Bond Position:  [17.27110812]


portfolio before change:  [12.14258523]
curr_Stock_Price:  102.17933498749485
curr_Factors:  [102.17933499]
mat_Sqrt:  [[0.15]]
grads:  [0.11435131]
Stock Position:  0.11435130532968074
Bond Position:  [0.4582449]


portfolio before change:  [12.38448874]
curr_Stock_Price:  104.29277240512884
curr_Factors:  [104.29277241]
mat_Sqrt:  [[0.15]]
grads:  [0.03490811]
Stock Position:  0.034908108141478184
Bond Position:  [8.74382536]


portfolio before change:  [12.4020803]
curr_Stock_Price:  104.6714394073963
curr_Factors:  [104.67143941]
mat_Sqrt:  [[0.15]]
grads:  [0.28478968]
Stock Position:  0.28478967946011996
Bond Position:  [-17.40726538]


portfolio before change:  [12.73103511]
curr_Stock_Price:  105.85708849452536
curr_Factors:  [105.85708849]
mat_Sqrt:  [[0.15]]
grads:  [-0.00449974]
Stock Position:  -0.004499744347892173
Bond Position:  [13.20736495]


portfolio before change:  [12.74192124]
curr_Stock_Price:  104.90574693358342
curr_Factors:  [104.90574693]
mat_Sqrt:  [[0.15]]
grads:  [-0.03975971]
Stock Position:  -0.03975970952251645
Bond Position:  [16.91294326]


portfolio before change:  [12.84408532]
curr_Stock_Price:  102.54895152573064
curr_Factors:  [102.54895153]
mat_Sqrt:  [[0.15]]
grads:  [0.01401248]
Stock Position:  0.014012482584855886
Bond Position:  [11.40711993]


portfolio before change:  [12.84371816]
curr_Stock_Price:  102.11561286304786
curr_Factors:  [102.11561286]
mat_Sqrt:  [[0.15]]
grads:  [-0.0003125]
Stock Position:  -0.0003125023203420698
Bond Position:  [12.87562953]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.85001422]
Stock Price:  102.57435863918933
PL:  [10.27565559]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30041783e-02]
 [-1.47380905e-02]
 [-4.70563833e-03]
 [ 9.49889388e-03]
 [ 1.48372618e-02]
 [ 8.68985082e-03]
 [-1.13871959e-02]
 [ 4.29816443e-03]
 [ 2.05138252e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.55770901]
curr_Stock_Price:  98.97322915832653
curr_Factors:  [98.97322916]
mat_Sqrt:  [[0.15]]
grads:  [-0.08669452]
Stock Position:  -0.08669452203038835
Bond Position:  [-12.97727221]


portfolio before change:  [-21.49316538]
curr_Stock_Price:  98.15387068832287
curr_Factors:  [98.15387069]
mat_Sqrt:  [[0.15]]
grads:  [-0.09825394]
Stock Position:  -0.09825393683605274
Bond Position:  [-11.84916117]


portfolio before change:  [-21.49296333]
curr_Stock_Price:  98.09150052953967
curr_Factors:  [98.09150053]
mat_Sqrt:  [[0.15]]
grads:  [-0.03137092]
Stock Position:  -0.03137092220502525
Bond Position:  [-18.41574249]


portfolio before change:  [-21.51704775]
curr_Stock_Price:  98.56564193461372
curr_Factors:  [98.56564193]
mat_Sqrt:  [[0.15]]
grads:  [0.06332596]
Stock Position:  0.06332595917587633
Bond Position:  [-27.75881157]


portfolio before change:  [-21.42463773]
curr_Stock_Price:  100.24414623111768
curr_Factors:  [100.24414623]
mat_Sqrt:  [[0.15]]
grads:  [0.09891508]
Stock Position:  0.09891507849337726
Bond Position:  [-31.34029533]


portfolio before change:  [-21.26021399]
curr_Stock_Price:  102.06487785283933
curr_Factors:  [102.06487785]
mat_Sqrt:  [[0.15]]
grads:  [0.05793234]
Stock Position:  0.057932338822791675
Bond Position:  [-27.17307107]


portfolio before change:  [-21.32265843]
curr_Stock_Price:  101.22157502999625
curr_Factors:  [101.22157503]
mat_Sqrt:  [[0.15]]
grads:  [-0.07591464]
Stock Position:  -0.07591463945099594
Bond Position:  [-13.63845905]


portfolio before change:  [-21.25852684]
curr_Stock_Price:  100.28693941890528
curr_Factors:  [100.28693942]
mat_Sqrt:  [[0.15]]
grads:  [0.02865443]
Stock Position:  0.02865442950417923
Bond Position:  [-24.13219187]


portfolio before change:  [-21.25219739]
curr_Stock_Price:  100.92902377917915
curr_Factors:  [100.92902378]
mat_Sqrt:  [[0.15]]
grads:  [0.00136759]
Stock Position:  0.00136758834482073
Bond Position:  [-21.39022674]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.26499807]
Stock Price:  99.39135456648333
PL:  [-21.26499807]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30559150e-02]
 [-9.57171468e-03]
 [ 2.33404615e-03]
 [ 9.39247654e-03]
 [-1.54490578e-02]
 [ 1.19620022e-02]
 [-1.36324027e-02]
 [ 4.17112211e-03]
 [-7.51966729e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.65625577]
curr_Stock_Price:  99.69505252133693
curr_Factors:  [99.69505252]
mat_Sqrt:  [[0.15]]
grads:  [-0.08703943]
Stock Position:  -0.08703943323854321
Bond Position:  [3.0211451]


portfolio before change:  [-5.78915103]
curr_Stock_Price:  101.23925162088298
curr_Factors:  [101.23925162]
mat_Sqrt:  [[0.15]]
grads:  [-0.06381143]
Stock Position:  -0.06381143120613979
Bond Position:  [0.67107051]


portfolio before change:  [-5.64967197]
curr_Stock_Price:  99.05871054086784
curr_Factors:  [99.05871054]
mat_Sqrt:  [[0.15]]
grads:  [0.01556031]
Stock Position:  0.015560307646036558
Bond Position:  [-7.19105598]


portfolio before change:  [-5.66185729]
curr_Stock_Price:  98.50673591893215
curr_Factors:  [98.50673592]
mat_Sqrt:  [[0.15]]
grads:  [0.06261651]
Stock Position:  0.0626165102768858
Bond Position:  [-11.83000533]


portfolio before change:  [-5.64659139]
curr_Stock_Price:  98.84502347203444
curr_Factors:  [98.84502347]
mat_Sqrt:  [[0.15]]
grads:  [-0.10299372]
Stock Position:  -0.10299371888634444
Bond Position:  [4.53382518]


portfolio before change:  [-5.6221527]
curr_Stock_Price:  98.62975592629711
curr_Factors:  [98.62975593]
mat_Sqrt:  [[0.15]]
grads:  [0.07974668]
Stock Position:  0.07974668165330377
Bond Position:  [-13.48754845]


portfolio before change:  [-5.80797761]
curr_Stock_Price:  96.38415211441077
curr_Factors:  [96.38415211]
mat_Sqrt:  [[0.15]]
grads:  [-0.09088268]
Stock Position:  -0.09088268489049159
Bond Position:  [2.95167291]


portfolio before change:  [-5.95390375]
curr_Stock_Price:  98.00604896359565
curr_Factors:  [98.00604896]
mat_Sqrt:  [[0.15]]
grads:  [0.02780748]
Stock Position:  0.02780748073323155
Bond Position:  [-8.67920507]


portfolio before change:  [-5.93381119]
curr_Stock_Price:  98.88470630151613
curr_Factors:  [98.8847063]
mat_Sqrt:  [[0.15]]
grads:  [-0.00501311]
Stock Position:  -0.005013111525952267
Bond Position:  [-5.43809113]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.93683393]
Stock Price:  98.94515118166723
PL:  [-5.93683393]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.29992865e-02]
 [-1.43236644e-02]
 [ 4.45241687e-03]
 [ 1.03365609e-02]
 [-3.92259495e-03]
 [ 1.19474136e-02]
 [-1.52770587e-02]
 [ 4.07019851e-03]
 [ 3.66748923e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.08493819]
curr_Stock_Price:  99.40323182443501
curr_Factors:  [99.40323182]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-3.47046426]


portfolio before change:  [-12.00900389]
curr_Stock_Price:  98.50699072345941
curr_Factors:  [98.50699072]
mat_Sqrt:  [[0.15]]
grads:  [-0.0954911]
Stock Position:  -0.09549109620025524
Bond Position:  [-2.60246337]


portfolio before change:  [-12.10967983]
curr_Stock_Price:  99.54765715762588
curr_Factors:  [99.54765716]
mat_Sqrt:  [[0.15]]
grads:  [0.02968278]
Stock Position:  0.029682779163460578
Bond Position:  [-15.06453095]


portfolio before change:  [-12.1325996]
curr_Stock_Price:  99.02932230767843
curr_Factors:  [99.02932231]
mat_Sqrt:  [[0.15]]
grads:  [0.06891041]
Stock Position:  0.0689104063048856
Bond Position:  [-18.95675043]


portfolio before change:  [-12.12594526]
curr_Stock_Price:  99.26346809318704
curr_Factors:  [99.26346809]
mat_Sqrt:  [[0.15]]
grads:  [-0.02615063]
Stock Position:  -0.02615063299153934
Bond Position:  [-9.53014274]


portfolio before change:  [-12.12985984]
curr_Stock_Price:  99.2308998399373
curr_Factors:  [99.23089984]
mat_Sqrt:  [[0.15]]
grads:  [0.07964942]
Stock Position:  0.07964942372552951
Bond Position:  [-20.03354383]


portfolio before change:  [-12.18513663]
curr_Stock_Price:  98.66269099039293
curr_Factors:  [98.66269099]
mat_Sqrt:  [[0.15]]
grads:  [-0.10184706]
Stock Position:  -0.10184705827000529
Bond Position:  [-2.13663179]


portfolio before change:  [-12.37985463]
curr_Stock_Price:  100.5640657224934
curr_Factors:  [100.56406572]
mat_Sqrt:  [[0.15]]
grads:  [0.02713466]
Stock Position:  0.027134656702957085
Bond Position:  [-15.10862603]


portfolio before change:  [-12.39607472]
curr_Stock_Price:  100.2447734127411
curr_Factors:  [100.24477341]
mat_Sqrt:  [[0.15]]
grads:  [0.00244499]
Stock Position:  0.002444992817035283
Bond Position:  [-12.64117247]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.40254797]
Stock Price:  100.18298043787189
PL:  [-12.58552841]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.69527602e-02]
 [-6.70310199e-03]
 [-1.02250533e-02]
 [ 5.01900481e-03]
 [ 2.03085542e-02]
 [ 4.72179093e-03]
 [-5.94397324e-03]
 [-9.77217482e-04]
 [ 2.74466148e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [68.35693271]
curr_Stock_Price:  103.05477366205105
curr_Factors:  [103.05477366]
mat_Sqrt:  [[0.15]]
grads:  [-0.1130184]
Stock Position:  -0.11301840109162821
Bond Position:  [80.00401846]


portfolio before change:  [68.3446305]
curr_Stock_Price:  103.51765601051517
curr_Factors:  [103.51765601]
mat_Sqrt:  [[0.15]]
grads:  [-0.04468735]
Stock Position:  -0.0446873466171488
Bond Position:  [72.97055988]


portfolio before change:  [68.3889041]
curr_Stock_Price:  103.34357544052703
curr_Factors:  [103.34357544]
mat_Sqrt:  [[0.15]]
grads:  [-0.06816702]
Stock Position:  -0.06816702232452336
Bond Position:  [75.43352792]


portfolio before change:  [68.41915223]
curr_Stock_Price:  103.45327753061575
curr_Factors:  [103.45327753]
mat_Sqrt:  [[0.15]]
grads:  [0.03346003]
Stock Position:  0.033460032080545384
Bond Position:  [64.95760225]


portfolio before change:  [68.44707904]
curr_Stock_Price:  103.3169920856654
curr_Factors:  [103.31699209]
mat_Sqrt:  [[0.15]]
grads:  [0.13539036]
Stock Position:  0.13539036125349604
Bond Position:  [54.45895416]


portfolio before change:  [68.51161393]
curr_Stock_Price:  103.59248146928599
curr_Factors:  [103.59248147]
mat_Sqrt:  [[0.15]]
grads:  [0.03147861]
Stock Position:  0.031478606204093575
Bond Position:  [65.250667]


portfolio before change:  [68.57158555]
curr_Stock_Price:  104.4609482245427
curr_Factors:  [104.46094822]
mat_Sqrt:  [[0.15]]
grads:  [-0.03962649]
Stock Position:  -0.03962648823709504
Bond Position:  [72.71100608]


portfolio before change:  [68.54412077]
curr_Stock_Price:  106.07172362270045
curr_Factors:  [106.07172362]
mat_Sqrt:  [[0.15]]
grads:  [-0.00651478]
Stock Position:  -0.006514783210588088
Bond Position:  [69.23515505]


portfolio before change:  [68.57969816]
curr_Stock_Price:  105.92572378328443
curr_Factors:  [105.92572378]
mat_Sqrt:  [[0.15]]
grads:  [0.01829774]
Stock Position:  0.018297743192035688
Bond Position:  [66.64149647]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [68.58398736]
Stock Price:  104.3386496202085
PL:  [64.24533774]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.31197685e-02]
 [-7.60243086e-03]
 [ 1.10331852e-02]
 [ 1.00010092e-02]
 [-1.18131645e-02]
 [ 1.26490549e-02]
 [-1.52502336e-02]
 [ 4.58743453e-03]
 [ 2.88511801e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.95341479]
curr_Stock_Price:  99.77235051308693
curr_Factors:  [99.77235051]
mat_Sqrt:  [[0.15]]
grads:  [-0.08746512]
Stock Position:  -0.08746512353758969
Bond Position:  [4.77318617]


portfolio before change:  [-4.17192595]
curr_Stock_Price:  102.29790967152584
curr_Factors:  [102.29790967]
mat_Sqrt:  [[0.15]]
grads:  [-0.05068287]
Stock Position:  -0.05068287242728811
Bond Position:  [1.01282596]


portfolio before change:  [-4.07124224]
curr_Stock_Price:  100.32136102694167
curr_Factors:  [100.32136103]
mat_Sqrt:  [[0.15]]
grads:  [0.07355457]
Stock Position:  0.07355456811312187
Bond Position:  [-11.45033663]


portfolio before change:  [-4.18566626]
curr_Stock_Price:  98.84358175920515
curr_Factors:  [98.84358176]
mat_Sqrt:  [[0.15]]
grads:  [0.06667339]
Stock Position:  0.06667339492179347
Bond Position:  [-10.77590342]


portfolio before change:  [-4.17881771]
curr_Stock_Price:  99.0271309477522
curr_Factors:  [99.02713095]
mat_Sqrt:  [[0.15]]
grads:  [-0.07875443]
Stock Position:  -0.07875443014567284
Bond Position:  [3.62000756]


portfolio before change:  [-4.21791807]
curr_Stock_Price:  99.54660415517088
curr_Factors:  [99.54660416]
mat_Sqrt:  [[0.15]]
grads:  [0.08432703]
Stock Position:  0.08432703240007848
Bond Position:  [-12.61238778]


portfolio before change:  [-4.23039882]
curr_Stock_Price:  99.47340132164969
curr_Factors:  [99.47340132]
mat_Sqrt:  [[0.15]]
grads:  [-0.10166822]
Stock Position:  -0.10166822427428394
Bond Position:  [5.88288526]


portfolio before change:  [-4.26835845]
curr_Stock_Price:  99.875708030711
curr_Factors:  [99.87570803]
mat_Sqrt:  [[0.15]]
grads:  [0.0305829]
Stock Position:  0.03058289689429374
Bond Position:  [-7.32284693]


portfolio before change:  [-4.27304112]
curr_Stock_Price:  99.8423451672795
curr_Factors:  [99.84234517]
mat_Sqrt:  [[0.15]]
grads:  [0.00192341]
Stock Position:  0.0019234120036150267
Bond Position:  [-4.46507909]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.27395765]
Stock Price:  100.52683980765886
PL:  [-4.80079746]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.29992865e-02]
 [-1.31704794e-02]
 [-3.37254753e-02]
 [ 4.86188571e-03]
 [ 2.11702424e-02]
 [ 1.35728622e-03]
 [-6.13380537e-03]
 [-3.20840869e-03]
 [ 1.73662398e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-23.36041031]
curr_Stock_Price:  98.89139815241992
curr_Factors:  [98.89139815]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-14.79029286]


portfolio before change:  [-23.46225547]
curr_Stock_Price:  99.98124448307414
curr_Factors:  [99.98124448]
mat_Sqrt:  [[0.15]]
grads:  [-0.0878032]
Stock Position:  -0.08780319574212041
Bond Position:  [-14.68358269]


portfolio before change:  [-23.83280763]
curr_Stock_Price:  104.11786532206179
curr_Factors:  [104.11786532]
mat_Sqrt:  [[0.15]]
grads:  [-0.2248365]
Stock Position:  -0.22483650198662156
Bond Position:  [-0.42331099]


portfolio before change:  [-23.54706476]
curr_Stock_Price:  102.84603189876093
curr_Factors:  [102.8460319]
mat_Sqrt:  [[0.15]]
grads:  [0.03241257]
Stock Position:  0.03241257141188435
Bond Position:  [-26.88056911]


portfolio before change:  [-23.54355532]
curr_Stock_Price:  103.36907225547732
curr_Factors:  [103.36907226]
mat_Sqrt:  [[0.15]]
grads:  [0.14113495]
Stock Position:  0.14113494927633913
Bond Position:  [-38.13254409]


portfolio before change:  [-23.33735642]
curr_Stock_Price:  104.96520375723449
curr_Factors:  [104.96520376]
mat_Sqrt:  [[0.15]]
grads:  [0.00904857]
Stock Position:  0.009048574782976333
Bond Position:  [-24.28714191]


portfolio before change:  [-23.31583193]
curr_Stock_Price:  108.68635341029348
curr_Factors:  [108.68635341]
mat_Sqrt:  [[0.15]]
grads:  [-0.04089204]
Stock Position:  -0.040892035773161035
Bond Position:  [-18.87142567]


portfolio before change:  [-23.37258661]
curr_Stock_Price:  109.84346400817628
curr_Factors:  [109.84346401]
mat_Sqrt:  [[0.15]]
grads:  [-0.02138939]
Stock Position:  -0.021389391273595574
Bond Position:  [-21.02310177]


portfolio before change:  [-23.45957381]
curr_Stock_Price:  113.41874205474002
curr_Factors:  [113.41874205]
mat_Sqrt:  [[0.15]]
grads:  [0.01157749]
Stock Position:  0.011577493182175515
Bond Position:  [-24.77267852]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-23.4664557]
Stock Price:  113.894453026081
PL:  [-37.36090873]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.64753602e-02]
 [-6.92573877e-03]
 [-7.28702238e-02]
 [ 5.61472431e-03]
 [ 5.95183393e-02]
 [ 6.09023834e-04]
 [-5.95980121e-03]
 [-1.79915027e-03]
 [ 2.59040298e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [60.15933897]
curr_Stock_Price:  102.68265580608148
curr_Factors:  [102.68265581]
mat_Sqrt:  [[0.15]]
grads:  [-0.10983573]
Stock Position:  -0.10983573467316127
Bond Position:  [71.43756391]


portfolio before change:  [60.13622662]
curr_Stock_Price:  103.21836542505876
curr_Factors:  [103.21836543]
mat_Sqrt:  [[0.15]]
grads:  [-0.04617159]
Stock Position:  -0.046171591793704315
Bond Position:  [64.90198286]


portfolio before change:  [60.07405377]
curr_Stock_Price:  105.26793637305204
curr_Factors:  [105.26793637]
mat_Sqrt:  [[0.15]]
grads:  [-0.48580149]
Stock Position:  -0.4858014918739739
Bond Position:  [111.21337431]


portfolio before change:  [59.89273812]
curr_Stock_Price:  105.75565872231672
curr_Factors:  [105.75565872]
mat_Sqrt:  [[0.15]]
grads:  [0.0374315]
Stock Position:  0.03743149538313896
Bond Position:  [55.93414567]


portfolio before change:  [59.91813543]
curr_Stock_Price:  105.68681943246905
curr_Factors:  [105.68681943]
mat_Sqrt:  [[0.15]]
grads:  [0.39678893]
Stock Position:  0.3967889289197686
Bond Position:  [17.98277555]


portfolio before change:  [59.77110028]
curr_Stock_Price:  105.29359076616096
curr_Factors:  [105.29359077]
mat_Sqrt:  [[0.15]]
grads:  [0.00406016]
Stock Position:  0.004060158893181733
Bond Position:  [59.34359157]


portfolio before change:  [59.79882927]
curr_Stock_Price:  104.81325750517138
curr_Factors:  [104.81325751]
mat_Sqrt:  [[0.15]]
grads:  [-0.03973201]
Stock Position:  -0.039732008091980554
Bond Position:  [63.96327046]


portfolio before change:  [59.72561208]
curr_Stock_Price:  107.46116845936496
curr_Factors:  [107.46116846]
mat_Sqrt:  [[0.15]]
grads:  [-0.01199434]
Stock Position:  -0.011994335156989224
Bond Position:  [61.01453735]


portfolio before change:  [59.72608511]
curr_Stock_Price:  109.96584027639321
curr_Factors:  [109.96584028]
mat_Sqrt:  [[0.15]]
grads:  [0.01726935]
Stock Position:  0.01726935321651834
Bond Position:  [57.82704617]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [59.80194209]
Stock Price:  112.68373173476283
PL:  [47.11821035]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 3.30443445]
 [-0.01299969]
 [-0.013101  ]
 [ 0.00446161]
 [ 0.00503968]
 [ 0.00802703]
 [ 0.00625295]
 [-0.0076392 ]
 [ 0.00430552]
 [-0.00358421]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.3653173]
curr_Stock_Price:  99.39050442251457
curr_Factors:  [99.39050442]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666457]
Stock Position:  -0.08666456924732188
Bond Position:  [-3.75168204]


portfolio before change:  [-12.37798913]
curr_Stock_Price:  99.5150711532133
curr_Factors:  [99.51507115]
mat_Sqrt:  [[0.15]]
grads:  [-0.08733999]
Stock Position:  -0.08733999118524058
Bond Position:  [-3.68634369]


portfolio before change:  [-12.38325745]
curr_Stock_Price:  99.55428217719565
curr_Factors:  [99.55428218]
mat_Sqrt:  [[0.15]]
grads:  [0.02974405]
Stock Position:  0.029744047285835153
Bond Position:  [-15.34440473]


portfolio before change:  [-12.2725825]
curr_Stock_Price:  103.53319838307769
curr_Factors:  [103.53319838]
mat_Sqrt:  [[0.15]]
grads:  [0.03359789]
Stock Position:  0.0335978905436916
Bond Position:  [-15.75107957]


portfolio before change:  [-12.31999618]
curr_Stock_Price:  102.35645283362238
curr_Factors:  [102.35645283]
mat_Sqrt:  [[0.15]]
grads:  [0.05351356]
Stock Position:  0.05351355811166601
Bond Position:  [-17.79745416]


portfolio before change:  [-12.2949797]
curr_Stock_Price:  102.9902628481332
curr_Factors:  [102.99026285]
mat_Sqrt:  [[0.15]]
grads:  [0.04168632]
Stock Position:  0.041686322971057635
Bond Position:  [-16.58826506]


portfolio before change:  [-12.32032023]
curr_Stock_Price:  102.58139206194019
curr_Factors:  [102.58139206]
mat_Sqrt:  [[0.15]]
grads:  [-0.050928]
Stock Position:  -0.05092800131284184
Bond Position:  [-7.09605496]


portfolio before change:  [-12.20648958]
curr_Stock_Price:  100.27657820612679
curr_Factors:  [100.27657821]
mat_Sqrt:  [[0.15]]
grads:  [0.02870349]
Stock Position:  0.0287034905531683
Bond Position:  [-15.08477739]


portfolio before change:  [-12.27925317]
curr_Stock_Price:  98.00440460264974
curr_Factors:  [98.0044046]
mat_Sqrt:  [[0.15]]
grads:  [-0.02389472]
Stock Position:  -0.02389471915886525
Bond Position:  [-9.93746544]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.29317848]
Stock Price:  98.3791879425047
PL:  [-12.29317848]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 3.30443445]
 [-0.01674689]
 [-0.00652221]
 [ 0.01471682]
 [ 0.00705027]
 [ 0.01082354]
 [ 0.00992483]
 [-0.01525286]
 [ 0.00464441]
 [-0.00588008]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [64.82189212]
curr_Stock_Price:  102.89430563134336
curr_Factors:  [102.89430563]
mat_Sqrt:  [[0.15]]
grads:  [-0.11164594]
Stock Position:  -0.11164594286534875
Bond Position:  [76.30962389]


portfolio before change:  [64.76386316]
curr_Stock_Price:  103.75589823711321
curr_Factors:  [103.75589824]
mat_Sqrt:  [[0.15]]
grads:  [-0.04348142]
Stock Position:  -0.04348141911301646
Bond Position:  [69.27531685]


portfolio before change:  [64.93574613]
curr_Stock_Price:  100.59968444616845
curr_Factors:  [100.59968445]
mat_Sqrt:  [[0.15]]
grads:  [0.09811211]
Stock Position:  0.0981121075060529
Bond Position:  [55.06569908]


portfolio before change:  [65.01952025]
curr_Stock_Price:  101.17284902183457
curr_Factors:  [101.17284902]
mat_Sqrt:  [[0.15]]
grads:  [0.04700179]
Stock Position:  0.04700178994245247
Bond Position:  [60.26421525]


portfolio before change:  [65.04499838]
curr_Stock_Price:  101.07367171428183
curr_Factors:  [101.07367171]
mat_Sqrt:  [[0.15]]
grads:  [0.07215695]
Stock Position:  0.07215694963334461
Bond Position:  [57.75183054]


portfolio before change:  [65.10971847]
curr_Stock_Price:  101.57032454007398
curr_Factors:  [101.57032454]
mat_Sqrt:  [[0.15]]
grads:  [0.06616557]
Stock Position:  0.06616556500100008
Bond Position:  [58.38926056]


portfolio before change:  [65.00008412]
curr_Stock_Price:  99.4720082587199
curr_Factors:  [99.47200826]
mat_Sqrt:  [[0.15]]
grads:  [-0.10168573]
Stock Position:  -0.10168572580518148
Bond Position:  [75.11496747]


portfolio before change:  [65.02230817]
curr_Stock_Price:  99.62289294528217
curr_Factors:  [99.62289295]
mat_Sqrt:  [[0.15]]
grads:  [0.03096276]
Stock Position:  0.03096275903529054
Bond Position:  [61.93770854]


portfolio before change:  [64.98083445]
curr_Stock_Price:  97.28297496799098
curr_Factors:  [97.28297497]
mat_Sqrt:  [[0.15]]
grads:  [-0.03920053]
Stock Position:  -0.03920053293684238
Bond Position:  [68.79437892]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [64.988806]
Stock Price:  97.95730883641106
PL:  [64.988806]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.36260850e-02]
 [-6.64829581e-03]
 [ 1.02709725e-02]
 [ 5.39710161e-03]
 [ 2.69534554e-02]
 [ 3.78123130e-04]
 [-5.90511524e-03]
 [ 2.55179804e-03]
 [ 1.45490566e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.87011264]
curr_Stock_Price:  100.58142364117771
curr_Factors:  [100.58142364]
mat_Sqrt:  [[0.15]]
grads:  [-0.09084057]
Stock Position:  -0.0908405666559572
Bond Position:  [23.00698616]


portfolio before change:  [13.60833284]
curr_Stock_Price:  103.5898391610156
curr_Factors:  [103.58983916]
mat_Sqrt:  [[0.15]]
grads:  [-0.04432197]
Stock Position:  -0.044321972066354735
Bond Position:  [18.1996388]


portfolio before change:  [13.65828052]
curr_Stock_Price:  102.66827414331833
curr_Factors:  [102.66827414]
mat_Sqrt:  [[0.15]]
grads:  [0.06847315]
Stock Position:  0.06847315000876172
Bond Position:  [6.62826038]


portfolio before change:  [13.588009]
curr_Stock_Price:  101.59359775302923
curr_Factors:  [101.59359775]
mat_Sqrt:  [[0.15]]
grads:  [0.03598068]
Stock Position:  0.03598067737840711
Bond Position:  [9.93260253]


portfolio before change:  [13.66943584]
curr_Stock_Price:  103.71860786883646
curr_Factors:  [103.71860787]
mat_Sqrt:  [[0.15]]
grads:  [0.1796897]
Stock Position:  0.17968970255980607
Bond Position:  [-4.96772995]


portfolio before change:  [13.96816833]
curr_Stock_Price:  105.39492526213122
curr_Factors:  [105.39492526]
mat_Sqrt:  [[0.15]]
grads:  [0.00252082]
Stock Position:  0.00252082086779834
Bond Position:  [13.7024866]


portfolio before change:  [13.97048658]
curr_Stock_Price:  103.5960220401398
curr_Factors:  [103.59602204]
mat_Sqrt:  [[0.15]]
grads:  [-0.03936743]
Stock Position:  -0.03936743492660048
Bond Position:  [18.04879623]


portfolio before change:  [14.03470613]
curr_Stock_Price:  102.1940282915542
curr_Factors:  [102.19402829]
mat_Sqrt:  [[0.15]]
grads:  [0.01701199]
Stock Position:  0.017011986949288963
Bond Position:  [12.29618265]


portfolio before change:  [14.04435796]
curr_Stock_Price:  102.39989504540833
curr_Factors:  [102.39989505]
mat_Sqrt:  [[0.15]]
grads:  [0.00096994]
Stock Position:  0.0009699371060317766
Bond Position:  [13.9450365]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.05280923]
Stock Price:  103.92268931248415
PL:  [10.13011992]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.78643694e-02]
 [-7.98337682e-03]
 [-8.08157305e-03]
 [ 5.81186572e-03]
 [ 8.73829591e-02]
 [-2.77319105e-03]
 [-6.03450631e-03]
 [-1.16879529e-03]
 [ 2.86741199e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [84.01047829]
curr_Stock_Price:  103.76534361705833
curr_Factors:  [103.76534362]
mat_Sqrt:  [[0.15]]
grads:  [-0.1190958]
Stock Position:  -0.11909579592096475
Bond Position:  [96.36849448]


portfolio before change:  [83.8258253]
curr_Stock_Price:  105.72048642085365
curr_Factors:  [105.72048642]
mat_Sqrt:  [[0.15]]
grads:  [-0.05322251]
Stock Position:  -0.05322251211988201
Bond Position:  [89.45253517]


portfolio before change:  [84.00082667]
curr_Stock_Price:  103.27295223586859
curr_Factors:  [103.27295224]
mat_Sqrt:  [[0.15]]
grads:  [-0.05387715]
Stock Position:  -0.05387715364642903
Bond Position:  [89.56487939]


portfolio before change:  [83.85758626]
curr_Stock_Price:  106.76300386494749
curr_Factors:  [106.76300386]
mat_Sqrt:  [[0.15]]
grads:  [0.03874577]
Stock Position:  0.03874577143443849
Bond Position:  [79.72097131]


portfolio before change:  [83.92376718]
curr_Stock_Price:  107.44205785886211
curr_Factors:  [107.44205786]
mat_Sqrt:  [[0.15]]
grads:  [0.58255306]
Stock Position:  0.5825530603720328
Bond Position:  [21.33306756]


portfolio before change:  [83.73102197]
curr_Stock_Price:  107.09288037003641
curr_Factors:  [107.09288037]
mat_Sqrt:  [[0.15]]
grads:  [-0.01848794]
Stock Position:  -0.018487940350082853
Bond Position:  [85.71094875]


portfolio before change:  [83.78529132]
curr_Stock_Price:  106.47609144172334
curr_Factors:  [106.47609144]
mat_Sqrt:  [[0.15]]
grads:  [-0.04023004]
Stock Position:  -0.040230042078966397
Bond Position:  [88.06882895]


portfolio before change:  [83.83257579]
curr_Stock_Price:  106.3955783219905
curr_Factors:  [106.39557832]
mat_Sqrt:  [[0.15]]
grads:  [-0.00779197]
Stock Position:  -0.007791968602205317
Bond Position:  [84.66160679]


portfolio before change:  [83.87224077]
curr_Stock_Price:  106.73906034374983
curr_Factors:  [106.73906034]
mat_Sqrt:  [[0.15]]
grads:  [0.01911608]
Stock Position:  0.019116079926854643
Bond Position:  [81.83180836]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [83.87159473]
Stock Price:  104.56433736369438
PL:  [79.30725737]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 3.30443445]
 [-0.01318463]
 [-0.01415006]
 [-0.0074252 ]
 [ 0.00934162]
 [-0.01433133]
 [ 0.0128354 ]
 [-0.01492654]
 [ 0.00452098]
 [-0.00597747]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.94320968]
curr_Stock_Price:  99.86360085298355
curr_Factors:  [99.86360085]
mat_Sqrt:  [[0.15]]
grads:  [-0.08789756]
Stock Position:  -0.08789756129625471
Bond Position:  [6.8345573]


portfolio before change:  [-1.83391316]
curr_Stock_Price:  98.65903515197043
curr_Factors:  [98.65903515]
mat_Sqrt:  [[0.15]]
grads:  [-0.09433375]
Stock Position:  -0.0943337479020291
Bond Position:  [7.47296339]


portfolio before change:  [-1.74544747]
curr_Stock_Price:  97.7608595440759
curr_Factors:  [97.76085954]
mat_Sqrt:  [[0.15]]
grads:  [-0.04950133]
Stock Position:  -0.049501329530023515
Bond Position:  [3.09384505]


portfolio before change:  [-1.77942843]
curr_Stock_Price:  98.47858301403458
curr_Factors:  [98.47858301]
mat_Sqrt:  [[0.15]]
grads:  [0.06227744]
Stock Position:  0.062277443932780355
Bond Position:  [-7.91242286]


portfolio before change:  [-1.75487062]
curr_Stock_Price:  98.93645366436424
curr_Factors:  [98.93645366]
mat_Sqrt:  [[0.15]]
grads:  [-0.09554222]
Stock Position:  -0.0955422243682249
Bond Position:  [7.69773824]


portfolio before change:  [-1.64217545]
curr_Stock_Price:  97.79721566768158
curr_Factors:  [97.79721567]
mat_Sqrt:  [[0.15]]
grads:  [0.08556936]
Stock Position:  0.08556935708593862
Bond Position:  [-10.01062032]


portfolio before change:  [-1.48905388]
curr_Stock_Price:  99.64516849263228
curr_Factors:  [99.64516849]
mat_Sqrt:  [[0.15]]
grads:  [-0.09951025]
Stock Position:  -0.09951025395877304
Bond Position:  [8.42666214]


portfolio before change:  [-1.42565984]
curr_Stock_Price:  99.05045940114933
curr_Factors:  [99.0504594]
mat_Sqrt:  [[0.15]]
grads:  [0.03013989]
Stock Position:  0.0301398940629983
Bond Position:  [-4.4110302]


portfolio before change:  [-1.48206245]
curr_Stock_Price:  97.25229309287005
curr_Factors:  [97.25229309]
mat_Sqrt:  [[0.15]]
grads:  [-0.03984979]
Stock Position:  -0.039849786670515405
Bond Position:  [2.39342068]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.47277669]
Stock Price:  97.04931201990071
PL:  [-1.47277669]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30775315e-02]
 [-1.38355915e-02]
 [ 1.98247393e-03]
 [ 9.39199994e-03]
 [ 8.79350719e-03]
 [ 7.61180712e-03]
 [-1.10320447e-02]
 [ 3.19318497e-03]
 [ 3.70278879e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.04628807]
curr_Stock_Price:  99.72274111869723
curr_Factors:  [99.72274112]
mat_Sqrt:  [[0.15]]
grads:  [-0.08718354]
Stock Position:  -0.08718354322061027
Bond Position:  [3.64789384]


portfolio before change:  [-5.08859627]
curr_Stock_Price:  100.22894448832362
curr_Factors:  [100.22894449]
mat_Sqrt:  [[0.15]]
grads:  [-0.09223728]
Stock Position:  -0.09223727636279956
Bond Position:  [4.15624858]


portfolio before change:  [-4.97217044]
curr_Stock_Price:  98.98923763369235
curr_Factors:  [98.98923763]
mat_Sqrt:  [[0.15]]
grads:  [0.01321649]
Stock Position:  0.013216492879315247
Bond Position:  [-6.280461]


portfolio before change:  [-4.98169193]
curr_Stock_Price:  98.506472099217
curr_Factors:  [98.5064721]
mat_Sqrt:  [[0.15]]
grads:  [0.06261333]
Stock Position:  0.06261333290010569
Bond Position:  [-11.14951046]


portfolio before change:  [-4.73768638]
curr_Stock_Price:  102.49255120469064
curr_Factors:  [102.4925512]
mat_Sqrt:  [[0.15]]
grads:  [0.05862338]
Stock Position:  0.058623381290839674
Bond Position:  [-10.74614629]


portfolio before change:  [-4.7399294]
curr_Stock_Price:  102.54596663632714
curr_Factors:  [102.54596664]
mat_Sqrt:  [[0.15]]
grads:  [0.05074538]
Stock Position:  0.050745380787487276
Bond Position:  [-9.94366353]


portfolio before change:  [-4.8034139]
curr_Stock_Price:  101.3929271962898
curr_Factors:  [101.3929272]
mat_Sqrt:  [[0.15]]
grads:  [-0.07354696]
Stock Position:  -0.07354696493760206
Bond Position:  [2.65372816]


portfolio before change:  [-4.8231855]
curr_Stock_Price:  101.6798023905612
curr_Factors:  [101.67980239]
mat_Sqrt:  [[0.15]]
grads:  [0.0212879]
Stock Position:  0.021287899798409494
Bond Position:  [-6.98773495]


portfolio before change:  [-4.85614626]
curr_Stock_Price:  100.29563526490621
curr_Factors:  [100.29563526]
mat_Sqrt:  [[0.15]]
grads:  [0.00246853]
Stock Position:  0.002468525861881904
Bond Position:  [-5.10372863]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.85851773]
Stock Price:  100.36896995453536
PL:  [-5.22748769]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.35882444e-02]
 [-1.29965880e-02]
 [ 1.84276471e-02]
 [ 5.08508355e-03]
 [ 4.03521680e-02]
 [ 6.71681669e-03]
 [-5.90665841e-03]
 [ 1.21917726e-03]
 [-4.13210526e-05]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.62773608]
curr_Stock_Price:  100.52502776230443
curr_Factors:  [100.52502776]
mat_Sqrt:  [[0.15]]
grads:  [-0.0905883]
Stock Position:  -0.09058829614682268
Bond Position:  [21.73412706]


portfolio before change:  [12.63399422]
curr_Stock_Price:  100.57593547383375
curr_Factors:  [100.57593547]
mat_Sqrt:  [[0.15]]
grads:  [-0.08664392]
Stock Position:  -0.08664392019254744
Bond Position:  [21.34828754]


portfolio before change:  [12.52128289]
curr_Stock_Price:  102.00001856739945
curr_Factors:  [102.00001857]
mat_Sqrt:  [[0.15]]
grads:  [0.12285098]
Stock Position:  0.12285098085521132
Bond Position:  [-0.00951944]


portfolio before change:  [12.73118684]
curr_Stock_Price:  103.7086635895881
curr_Factors:  [103.70866359]
mat_Sqrt:  [[0.15]]
grads:  [0.03390056]
Stock Position:  0.03390055703134789
Bond Position:  [9.21540538]


portfolio before change:  [12.76358596]
curr_Stock_Price:  104.52842193659757
curr_Factors:  [104.52842194]
mat_Sqrt:  [[0.15]]
grads:  [0.26901445]
Stock Position:  0.2690144534427191
Bond Position:  [-15.35607033]


portfolio before change:  [12.30096452]
curr_Stock_Price:  102.83728051981278
curr_Factors:  [102.83728052]
mat_Sqrt:  [[0.15]]
grads:  [0.04477878]
Stock Position:  0.0447787779317971
Bond Position:  [7.69603678]


portfolio before change:  [12.34032712]
curr_Stock_Price:  103.63037085967031
curr_Factors:  [103.63037086]
mat_Sqrt:  [[0.15]]
grads:  [-0.03937772]
Stock Position:  -0.039377722712508015
Bond Position:  [16.42105513]


portfolio before change:  [12.35225965]
curr_Stock_Price:  103.53590257503333
curr_Factors:  [103.53590258]
mat_Sqrt:  [[0.15]]
grads:  [0.00812785]
Stock Position:  0.008127848373180424
Bond Position:  [11.51073553]


portfolio before change:  [12.34692327]
curr_Stock_Price:  102.17106580441838
curr_Factors:  [102.1710658]
mat_Sqrt:  [[0.15]]
grads:  [-0.00027547]
Stock Position:  -0.000275473683852669
Bond Position:  [12.37506871]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.35256172]
Stock Price:  104.16989201559723
PL:  [8.18266971]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.36595994e-02]
 [-1.31449360e-02]
 [ 2.25154102e-02]
 [ 4.82042916e-03]
 [ 4.66769041e-02]
 [-2.20889325e-03]
 [-6.11699385e-03]
 [-2.88882906e-03]
 [ 2.67170755e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.70644875]
curr_Stock_Price:  100.61938790335716
curr_Factors:  [100.6193879]
mat_Sqrt:  [[0.15]]
grads:  [-0.091064]
Stock Position:  -0.09106399578179264
Bond Position:  [23.86925226]


portfolio before change:  [14.82181854]
curr_Stock_Price:  99.48356925461393
curr_Factors:  [99.48356925]
mat_Sqrt:  [[0.15]]
grads:  [-0.08763291]
Stock Position:  -0.08763290636881955
Bond Position:  [23.53985285]


portfolio before change:  [14.68147439]
curr_Stock_Price:  101.21941289946878
curr_Factors:  [101.2194129]
mat_Sqrt:  [[0.15]]
grads:  [0.15010273]
Stock Position:  0.150102734683131
Bond Position:  [-0.51183629]


portfolio before change:  [14.79513538]
curr_Stock_Price:  101.97833961209989
curr_Factors:  [101.97833961]
mat_Sqrt:  [[0.15]]
grads:  [0.03213619]
Stock Position:  0.032136194409632675
Bond Position:  [11.51793963]


portfolio before change:  [14.89513028]
curr_Stock_Price:  104.91068703928363
curr_Factors:  [104.91068704]
mat_Sqrt:  [[0.15]]
grads:  [0.31117936]
Stock Position:  0.3111793607072553
Bond Position:  [-17.75091025]


portfolio before change:  [15.45748602]
curr_Stock_Price:  106.74639175560213
curr_Factors:  [106.74639176]
mat_Sqrt:  [[0.15]]
grads:  [-0.01472596]
Stock Position:  -0.014725955023954357
Bond Position:  [17.02942859]


portfolio before change:  [15.44294555]
curr_Stock_Price:  108.31215188640753
curr_Factors:  [108.31215189]
mat_Sqrt:  [[0.15]]
grads:  [-0.04077996]
Stock Position:  -0.04077995899099983
Bond Position:  [19.85991067]


portfolio before change:  [15.41246198]
curr_Stock_Price:  109.30322729691703
curr_Factors:  [109.3032273]
mat_Sqrt:  [[0.15]]
grads:  [-0.01925886]
Stock Position:  -0.019258860399261488
Bond Position:  [17.51751757]


portfolio before change:  [15.49557929]
curr_Stock_Price:  105.44233599396176
curr_Factors:  [105.44233599]
mat_Sqrt:  [[0.15]]
grads:  [0.01781138]
Stock Position:  0.01781138366463491
Bond Position:  [13.61750539]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.49341788]
Stock Price:  104.93862083039072
PL:  [10.55479705]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.42245250e-02]
 [-7.38032784e-03]
 [ 1.35875386e-02]
 [ 6.38431155e-03]
 [ 9.41369512e-03]
 [ 1.17658211e-02]
 [-1.50727479e-02]
 [ 4.63630058e-03]
 [ 4.05510704e-05]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.58184397]
curr_Stock_Price:  101.02227357258494
curr_Factors:  [101.02227357]
mat_Sqrt:  [[0.15]]
grads:  [-0.09483017]
Stock Position:  -0.09483016655843123
Bond Position:  [33.161803]


portfolio before change:  [23.44881102]
curr_Stock_Price:  102.60002049582933
curr_Factors:  [102.6000205]
mat_Sqrt:  [[0.15]]
grads:  [-0.04920219]
Stock Position:  -0.0492021855983502
Bond Position:  [28.49695627]


portfolio before change:  [23.56568212]
curr_Stock_Price:  100.514359834418
curr_Factors:  [100.51435983]
mat_Sqrt:  [[0.15]]
grads:  [0.09058359]
Stock Position:  0.09058359078953175
Bond Position:  [14.46073048]


portfolio before change:  [23.64667027]
curr_Stock_Price:  101.3285909083661
curr_Factors:  [101.32859091]
mat_Sqrt:  [[0.15]]
grads:  [0.04256208]
Stock Position:  0.042562077027867684
Bond Position:  [19.33391498]


portfolio before change:  [23.65554825]
curr_Stock_Price:  101.30999695182564
curr_Factors:  [101.30999695]
mat_Sqrt:  [[0.15]]
grads:  [0.06275797]
Stock Position:  0.06275796749226319
Bond Position:  [17.29753875]


portfolio before change:  [23.51927292]
curr_Stock_Price:  99.00070832352269
curr_Factors:  [99.00070832]
mat_Sqrt:  [[0.15]]
grads:  [0.07843881]
Stock Position:  0.07843880720526968
Bond Position:  [15.75377545]


portfolio before change:  [23.57161676]
curr_Stock_Price:  99.56758312382955
curr_Factors:  [99.56758312]
mat_Sqrt:  [[0.15]]
grads:  [-0.10048499]
Stock Position:  -0.10048498575319288
Bond Position:  [33.57666393]


portfolio before change:  [23.58810932]
curr_Stock_Price:  99.57056835830676
curr_Factors:  [99.57056836]
mat_Sqrt:  [[0.15]]
grads:  [0.03090867]
Stock Position:  0.030908670525852423
Bond Position:  [20.51051543]


portfolio before change:  [23.64807517]
curr_Stock_Price:  101.17879113715036
curr_Factors:  [101.17879114]
mat_Sqrt:  [[0.15]]
grads:  [0.00027034]
Stock Position:  0.00027034046957266633
Bond Position:  [23.62072245]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.66098477]
Stock Price:  105.23399184211557
PL:  [18.42699292]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.40338057e-02]
 [-7.38927798e-03]
 [ 1.13268384e-02]
 [ 5.72211670e-03]
 [ 6.80806171e-02]
 [-4.31140657e-03]
 [-6.08831385e-03]
 [-2.12774682e-03]
 [ 2.71534148e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.60632223]
curr_Stock_Price:  100.88720408700462
curr_Factors:  [100.88720409]
mat_Sqrt:  [[0.15]]
grads:  [-0.0935587]
Stock Position:  -0.09355870463382643
Bond Position:  [30.04519836]


portfolio before change:  [20.46223871]
curr_Stock_Price:  102.5878462553222
curr_Factors:  [102.58784626]
mat_Sqrt:  [[0.15]]
grads:  [-0.04926185]
Stock Position:  -0.04926185323062669
Bond Position:  [25.51590614]


portfolio before change:  [20.47275158]
curr_Stock_Price:  102.63348556307982
curr_Factors:  [102.63348556]
mat_Sqrt:  [[0.15]]
grads:  [0.07551226]
Stock Position:  0.07551225628424002
Bond Position:  [12.72266551]


portfolio before change:  [20.74621882]
curr_Stock_Price:  106.17071685537853
curr_Factors:  [106.17071686]
mat_Sqrt:  [[0.15]]
grads:  [0.03814744]
Stock Position:  0.03814744465767249
Bond Position:  [16.69607727]


portfolio before change:  [20.75585085]
curr_Stock_Price:  106.20432086316427
curr_Factors:  [106.20432086]
mat_Sqrt:  [[0.15]]
grads:  [0.45387078]
Stock Position:  0.4538707804442833
Bond Position:  [-27.44718715]


portfolio before change:  [21.57409187]
curr_Stock_Price:  108.03737132161926
curr_Factors:  [108.03737132]
mat_Sqrt:  [[0.15]]
grads:  [-0.02874271]
Stock Position:  -0.02874271049979492
Bond Position:  [24.67937875]


portfolio before change:  [21.59688541]
curr_Stock_Price:  107.67377411461928
curr_Factors:  [107.67377411]
mat_Sqrt:  [[0.15]]
grads:  [-0.04058876]
Stock Position:  -0.04058875900409911
Bond Position:  [25.96723028]


portfolio before change:  [21.59595545]
curr_Stock_Price:  108.01664790335157
curr_Factors:  [108.0166479]
mat_Sqrt:  [[0.15]]
grads:  [-0.01418498]
Stock Position:  -0.014184978778213992
Bond Position:  [23.12816931]


portfolio before change:  [21.58704061]
curr_Stock_Price:  109.46055688229757
curr_Factors:  [109.46055688]
mat_Sqrt:  [[0.15]]
grads:  [0.01810228]
Stock Position:  0.018102276520304824
Bond Position:  [19.60555534]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.59618799]
Stock Price:  109.4242162923384
PL:  [12.1719717]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.36195351e-02]
 [-1.40108595e-02]
 [ 1.31039790e-02]
 [ 4.94894219e-03]
 [ 4.86572046e-02]
 [-1.47188524e-03]
 [-6.22610049e-03]
 [-4.04287134e-03]
 [ 2.33566228e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.65506887]
curr_Stock_Price:  100.57166204166677
curr_Factors:  [100.57166204]
mat_Sqrt:  [[0.15]]
grads:  [-0.0907969]
Stock Position:  -0.09079690098875269
Bond Position:  [22.78666411]


portfolio before change:  [13.6839132]
curr_Stock_Price:  100.37949531822156
curr_Factors:  [100.37949532]
mat_Sqrt:  [[0.15]]
grads:  [-0.09340573]
Stock Position:  -0.09340573009187839
Bond Position:  [23.05993324]


portfolio before change:  [13.49253109]
curr_Stock_Price:  102.55189905405737
curr_Factors:  [102.55189905]
mat_Sqrt:  [[0.15]]
grads:  [0.08735986]
Stock Position:  0.0873598602773826
Bond Position:  [4.53361152]


portfolio before change:  [13.54988717]
curr_Stock_Price:  103.18249428082501
curr_Factors:  [103.18249428]
mat_Sqrt:  [[0.15]]
grads:  [0.03299295]
Stock Position:  0.03299294794027475
Bond Position:  [10.14559251]


portfolio before change:  [13.6159283]
curr_Stock_Price:  105.0303757886347
curr_Factors:  [105.03037579]
mat_Sqrt:  [[0.15]]
grads:  [0.32438136]
Stock Position:  0.3243813636668119
Bond Position:  [-20.45396823]


portfolio before change:  [14.01554821]
curr_Stock_Price:  106.29385608012218
curr_Factors:  [106.29385608]
mat_Sqrt:  [[0.15]]
grads:  [-0.00981257]
Stock Position:  -0.009812568263801169
Bond Position:  [15.05856393]


portfolio before change:  [13.97944425]
curr_Stock_Price:  110.74071731219676
curr_Factors:  [110.74071731]
mat_Sqrt:  [[0.15]]
grads:  [-0.04150734]
Stock Position:  -0.04150733656916612
Bond Position:  [18.57599647]


portfolio before change:  [13.96742583]
curr_Stock_Price:  111.25409006733658
curr_Factors:  [111.25409007]
mat_Sqrt:  [[0.15]]
grads:  [-0.02695248]
Stock Position:  -0.02695247558190965
Bond Position:  [16.96599898]


portfolio before change:  [13.98286504]
curr_Stock_Price:  110.99607716837463
curr_Factors:  [110.99607717]
mat_Sqrt:  [[0.15]]
grads:  [0.01557108]
Stock Position:  0.015571081858743967
Bond Position:  [12.25453604]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.01253047]
Stock Price:  112.50763730721805
PL:  [1.50489316]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30418548e-02]
 [-1.38648005e-02]
 [ 1.82110721e-02]
 [ 4.81932712e-03]
 [ 1.70316019e-02]
 [ 8.53536137e-03]
 [-6.34239374e-03]
 [ 1.89982655e-03]
 [ 6.03773979e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.74371179]
curr_Stock_Price:  99.10096647295957
curr_Factors:  [99.10096647]
mat_Sqrt:  [[0.15]]
grads:  [-0.0869457]
Stock Position:  -0.08694569878419324
Bond Position:  [-10.12730901]


portfolio before change:  [-18.84853686]
curr_Stock_Price:  100.24835098670596
curr_Factors:  [100.24835099]
mat_Sqrt:  [[0.15]]
grads:  [-0.092432]
Stock Position:  -0.09243200361519494
Bond Position:  [-9.58238092]


portfolio before change:  [-19.0180549]
curr_Stock_Price:  102.03047891181896
curr_Factors:  [102.03047891]
mat_Sqrt:  [[0.15]]
grads:  [0.12140715]
Stock Position:  0.12140714741361122
Bond Position:  [-31.4052843]


portfolio before change:  [-18.95998815]
curr_Stock_Price:  102.63813110519192
curr_Factors:  [102.63813111]
mat_Sqrt:  [[0.15]]
grads:  [0.03212885]
Stock Position:  0.0321288474398193
Bond Position:  [-22.25763301]


portfolio before change:  [-18.95567211]
curr_Stock_Price:  103.11893410060057
curr_Factors:  [103.1189341]
mat_Sqrt:  [[0.15]]
grads:  [0.11354401]
Stock Position:  0.11354401296122717
Bond Position:  [-30.6642097]


portfolio before change:  [-19.08209818]
curr_Stock_Price:  102.14054579294717
curr_Factors:  [102.14054579]
mat_Sqrt:  [[0.15]]
grads:  [0.05690241]
Stock Position:  0.05690240910124526
Bond Position:  [-24.8941413]


portfolio before change:  [-19.04035136]
curr_Stock_Price:  103.09300117816642
curr_Factors:  [103.09300118]
mat_Sqrt:  [[0.15]]
grads:  [-0.04228262]
Stock Position:  -0.04228262491439645
Bond Position:  [-14.68130866]


portfolio before change:  [-19.03433985]
curr_Stock_Price:  102.77717423539144
curr_Factors:  [102.77717424]
mat_Sqrt:  [[0.15]]
grads:  [0.01266551]
Stock Position:  0.012665510366268912
Bond Position:  [-20.33606522]


portfolio before change:  [-19.04122779]
curr_Stock_Price:  103.03635381324754
curr_Factors:  [103.03635381]
mat_Sqrt:  [[0.15]]
grads:  [0.00402516]
Stock Position:  0.0040251598625085025
Bond Position:  [-19.45596558]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.05089972]
Stock Price:  103.05088370694885
PL:  [-22.10178342]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30104012e-02]
 [-1.43007736e-02]
 [-2.18421302e-02]
 [ 1.02174391e-02]
 [ 1.26844358e-02]
 [ 1.27317285e-02]
 [-1.38964618e-02]
 [ 2.67296951e-03]
 [-1.63161749e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.96002287]
curr_Stock_Price:  99.31811508032754
curr_Factors:  [99.31811508]
mat_Sqrt:  [[0.15]]
grads:  [-0.08673601]
Stock Position:  -0.08673600831999272
Bond Position:  [-5.34556601]


portfolio before change:  [-13.74824522]
curr_Stock_Price:  96.84565756874235
curr_Factors:  [96.84565757]
mat_Sqrt:  [[0.15]]
grads:  [-0.09533849]
Stock Position:  -0.0953384903504479
Bond Position:  [-4.51512643]


portfolio before change:  [-13.67064867]
curr_Stock_Price:  96.00806634663223
curr_Factors:  [96.00806635]
mat_Sqrt:  [[0.15]]
grads:  [-0.1456142]
Stock Position:  -0.1456142012648034
Bond Position:  [0.30948923]


portfolio before change:  [-14.10083009]
curr_Stock_Price:  98.96338387484815
curr_Factors:  [98.96338387]
mat_Sqrt:  [[0.15]]
grads:  [0.06811626]
Stock Position:  0.06811626078288167
Bond Position:  [-20.84184575]


portfolio before change:  [-14.04804225]
curr_Stock_Price:  99.89137611425505
curr_Factors:  [99.89137611]
mat_Sqrt:  [[0.15]]
grads:  [0.08456291]
Stock Position:  0.08456290505614618
Bond Position:  [-22.49514721]


portfolio before change:  [-14.22658748]
curr_Stock_Price:  97.91302832617882
curr_Factors:  [97.91302833]
mat_Sqrt:  [[0.15]]
grads:  [0.08487819]
Stock Position:  0.08487818973493903
Bond Position:  [-22.53726807]


portfolio before change:  [-14.4325831]
curr_Stock_Price:  95.61886808151765
curr_Factors:  [95.61886808]
mat_Sqrt:  [[0.15]]
grads:  [-0.09264308]
Stock Position:  -0.09264307875077989
Bond Position:  [-5.57415677]


portfolio before change:  [-14.467113]
curr_Stock_Price:  95.96149620861019
curr_Factors:  [95.96149621]
mat_Sqrt:  [[0.15]]
grads:  [0.0178198]
Stock Position:  0.017819796718439043
Bond Position:  [-16.17712735]


portfolio before change:  [-14.51306097]
curr_Stock_Price:  93.83703920780036
curr_Factors:  [93.83703921]
mat_Sqrt:  [[0.15]]
grads:  [-0.1087745]
Stock Position:  -0.10877449933441646
Bond Position:  [-4.30598402]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.44225211]
Stock Price:  93.166271705612
PL:  [-14.44225211]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.29992865e-02]
 [-1.34193631e-02]
 [-1.47540729e-02]
 [ 6.70530637e-03]
 [-1.89282763e-02]
 [ 8.62939603e-03]
 [-1.10067976e-02]
 [ 2.79157643e-03]
 [-9.81549800e-05]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-22.61625058]
curr_Stock_Price:  98.92517820192526
curr_Factors:  [98.9251782]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-14.04320569]


portfolio before change:  [-22.34567249]
curr_Stock_Price:  95.72190874075521
curr_Factors:  [95.72190874]
mat_Sqrt:  [[0.15]]
grads:  [-0.08946242]
Stock Position:  -0.08946242077699632
Bond Position:  [-13.78215881]


portfolio before change:  [-22.45526056]
curr_Stock_Price:  96.86982386856563
curr_Factors:  [96.86982387]
mat_Sqrt:  [[0.15]]
grads:  [-0.09836049]
Stock Position:  -0.09836048628412945
Bond Position:  [-12.92709758]


portfolio before change:  [-22.50881582]
curr_Stock_Price:  97.34857397604152
curr_Factors:  [97.34857398]
mat_Sqrt:  [[0.15]]
grads:  [0.04470204]
Stock Position:  0.04470204244810928
Bond Position:  [-26.8604959]


portfolio before change:  [-22.46807733]
curr_Stock_Price:  98.56042229463597
curr_Factors:  [98.56042229]
mat_Sqrt:  [[0.15]]
grads:  [-0.12618851]
Stock Position:  -0.12618850891353162
Bond Position:  [-10.0308846]


portfolio before change:  [-22.91905253]
curr_Stock_Price:  102.09448822197614
curr_Factors:  [102.09448822]
mat_Sqrt:  [[0.15]]
grads:  [0.05752931]
Stock Position:  0.057529306849191
Bond Position:  [-28.79247767]


portfolio before change:  [-22.97317261]
curr_Stock_Price:  101.40405329947811
curr_Factors:  [101.4040533]
mat_Sqrt:  [[0.15]]
grads:  [-0.07337865]
Stock Position:  -0.07337865037326445
Bond Position:  [-15.53228004]


portfolio before change:  [-23.02432848]
curr_Stock_Price:  101.99533953504876
curr_Factors:  [101.99533954]
mat_Sqrt:  [[0.15]]
grads:  [0.01861051]
Stock Position:  0.018610509514099618
Bond Position:  [-24.92251372]


portfolio before change:  [-23.04408244]
curr_Stock_Price:  101.60364758526906
curr_Factors:  [101.60364759]
mat_Sqrt:  [[0.15]]
grads:  [-0.00065437]
Stock Position:  -0.0006543665334484267
Bond Position:  [-22.97759642]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-23.05472528]
Stock Price:  100.30646199393126
PL:  [-23.36118727]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30020771e-02]
 [-1.45031053e-02]
 [-1.06798432e-03]
 [ 4.75340480e-03]
 [ 9.31554170e-03]
 [ 5.14964651e-03]
 [-8.59486472e-03]
 [ 4.37789754e-03]
 [ 3.52741124e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.71464819]
curr_Stock_Price:  98.96610513213096
curr_Factors:  [98.96610513]
mat_Sqrt:  [[0.15]]
grads:  [-0.08668051]
Stock Position:  -0.08668051367441997
Bond Position:  [-13.13621536]


portfolio before change:  [-21.66779913]
curr_Stock_Price:  98.34983272142306
curr_Factors:  [98.34983272]
mat_Sqrt:  [[0.15]]
grads:  [-0.09668737]
Stock Position:  -0.09668736855295366
Bond Position:  [-12.15861261]


portfolio before change:  [-21.69166361]
curr_Stock_Price:  98.53376215359738
curr_Factors:  [98.53376215]
mat_Sqrt:  [[0.15]]
grads:  [-0.0071199]
Stock Position:  -0.007119895439136881
Bond Position:  [-20.99011353]


portfolio before change:  [-21.72871439]
curr_Stock_Price:  102.26318457638469
curr_Factors:  [102.26318458]
mat_Sqrt:  [[0.15]]
grads:  [0.03168937]
Stock Position:  0.031689365360508835
Bond Position:  [-24.96936981]


portfolio before change:  [-21.76304399]
curr_Stock_Price:  101.57393770848283
curr_Factors:  [101.57393771]
mat_Sqrt:  [[0.15]]
grads:  [0.06210361]
Stock Position:  0.06210361134158615
Bond Position:  [-28.07115234]


portfolio before change:  [-21.662175]
curr_Stock_Price:  103.4242018541114
curr_Factors:  [103.42420185]
mat_Sqrt:  [[0.15]]
grads:  [0.03433098]
Stock Position:  0.03433097673701999
Bond Position:  [-25.21282886]


portfolio before change:  [-21.7160191]
curr_Stock_Price:  102.22311351579825
curr_Factors:  [102.22311352]
mat_Sqrt:  [[0.15]]
grads:  [-0.0572991]
Stock Position:  -0.05729909812153925
Bond Position:  [-15.85872689]


portfolio before change:  [-21.60657707]
curr_Stock_Price:  100.17468039752363
curr_Factors:  [100.1746804]
mat_Sqrt:  [[0.15]]
grads:  [0.02918598]
Stock Position:  0.02918598362484148
Bond Position:  [-24.53027366]


portfolio before change:  [-21.60336648]
curr_Stock_Price:  100.70503076185095
curr_Factors:  [100.70503076]
mat_Sqrt:  [[0.15]]
grads:  [0.00235161]
Stock Position:  0.0023516074909979497
Bond Position:  [-21.84018518]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.61345337]
Stock Price:  101.06050386270583
PL:  [-22.67395723]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.31478163e-02]
 [-1.46722905e-02]
 [-1.28073327e-02]
 [ 6.75138584e-03]
 [-4.50391518e-02]
 [ 1.47817536e-02]
 [-1.47917628e-02]
 [ 4.39099968e-03]
 [ 1.18199664e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-36.56195531]
curr_Stock_Price:  98.29213320044924
curr_Factors:  [98.2921332]
mat_Sqrt:  [[0.15]]
grads:  [-0.08765211]
Stock Position:  -0.08765210863190055
Bond Position:  [-27.94644258]


portfolio before change:  [-36.50602514]
curr_Stock_Price:  97.49458379000447
curr_Factors:  [97.49458379]
mat_Sqrt:  [[0.15]]
grads:  [-0.09781527]
Stock Position:  -0.09781526966792484
Bond Position:  [-26.96956614]


portfolio before change:  [-36.48155338]
curr_Stock_Price:  97.10650622033211
curr_Factors:  [97.10650622]
mat_Sqrt:  [[0.15]]
grads:  [-0.08538222]
Stock Position:  -0.08538221791202887
Bond Position:  [-28.19038451]


portfolio before change:  [-36.3035819]
curr_Stock_Price:  94.85697224620225
curr_Factors:  [94.85697225]
mat_Sqrt:  [[0.15]]
grads:  [0.04500924]
Stock Position:  0.04500923894569186
Bond Position:  [-40.57302203]


portfolio before change:  [-36.37085463]
curr_Stock_Price:  93.81316113458828
curr_Factors:  [93.81316113]
mat_Sqrt:  [[0.15]]
grads:  [-0.30026101]
Stock Position:  -0.3002610117102672
Bond Position:  [-8.20241995]


portfolio before change:  [-36.63626795]
curr_Stock_Price:  94.68344090824093
curr_Factors:  [94.68344091]
mat_Sqrt:  [[0.15]]
grads:  [0.09854502]
Stock Position:  0.09854502396399023
Bond Position:  [-45.9668499]


portfolio before change:  [-36.35286819]
curr_Stock_Price:  97.7925672538088
curr_Factors:  [97.79256725]
mat_Sqrt:  [[0.15]]
grads:  [-0.09861175]
Stock Position:  -0.098611751668463
Bond Position:  [-26.70937183]


portfolio before change:  [-36.4361672]
curr_Stock_Price:  98.50182332836918
curr_Factors:  [98.50182333]
mat_Sqrt:  [[0.15]]
grads:  [0.02927333]
Stock Position:  0.02927333121830428
Bond Position:  [-39.3196437]


portfolio before change:  [-36.38091759]
curr_Stock_Price:  101.06095641941795
curr_Factors:  [101.06095642]
mat_Sqrt:  [[0.15]]
grads:  [0.000788]
Stock Position:  0.0007879977595906732
Bond Position:  [-36.46055339]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-36.40006598]
Stock Price:  99.90162064847888
PL:  [-36.40006598]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.55052486e-02]
 [-7.65902743e-03]
 [-9.08244240e-02]
 [ 5.38084048e-03]
 [ 5.22856319e-02]
 [ 2.00880477e-03]
 [-5.93779016e-03]
 [-9.22279456e-04]
 [ 2.77571780e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [43.55965574]
curr_Stock_Price:  101.92913730746398
curr_Factors:  [101.92913731]
mat_Sqrt:  [[0.15]]
grads:  [-0.10336832]
Stock Position:  -0.10336832369490372
Bond Position:  [54.0958998]


portfolio before change:  [43.2246942]
curr_Stock_Price:  105.4313345527139
curr_Factors:  [105.43133455]
mat_Sqrt:  [[0.15]]
grads:  [-0.05106018]
Stock Position:  -0.05106018286497152
Bond Position:  [48.60803742]


portfolio before change:  [43.23690806]
curr_Stock_Price:  105.66823594541101
curr_Factors:  [105.66823595]
mat_Sqrt:  [[0.15]]
grads:  [-0.60549616]
Stock Position:  -0.6054961600107677
Bond Position:  [107.21861916]


portfolio before change:  [43.78492378]
curr_Stock_Price:  104.85172705289291
curr_Factors:  [104.85172705]
mat_Sqrt:  [[0.15]]
grads:  [0.03587227]
Stock Position:  0.0358722698881997
Bond Position:  [40.02365433]


portfolio before change:  [43.81921597]
curr_Stock_Price:  105.24967682082811
curr_Factors:  [105.24967682]
mat_Sqrt:  [[0.15]]
grads:  [0.34857088]
Stock Position:  0.3485708793209424
Bond Position:  [7.13224357]


portfolio before change:  [43.62395729]
curr_Stock_Price:  104.67927433994657
curr_Factors:  [104.67927434]
mat_Sqrt:  [[0.15]]
grads:  [0.01339203]
Stock Position:  0.01339203177057658
Bond Position:  [42.22208912]


portfolio before change:  [43.64030668]
curr_Stock_Price:  104.32332140703686
curr_Factors:  [104.32332141]
mat_Sqrt:  [[0.15]]
grads:  [-0.03958527]
Stock Position:  -0.03958526774529982
Bond Position:  [47.76997329]


portfolio before change:  [43.59866297]
curr_Stock_Price:  105.97885306563316
curr_Factors:  [105.97885307]
mat_Sqrt:  [[0.15]]
grads:  [-0.00614853]
Stock Position:  -0.006148529705365608
Bond Position:  [44.2502771]


portfolio before change:  [43.61985508]
curr_Stock_Price:  106.13150086870063
curr_Factors:  [106.13150087]
mat_Sqrt:  [[0.15]]
grads:  [0.01850479]
Stock Position:  0.01850478533961069
Bond Position:  [41.65591444]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [43.67698229]
Stock Price:  108.09283367534867
PL:  [35.58414862]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.29992865e-02]
 [-1.46798821e-02]
 [-2.75604133e-02]
 [ 5.79785393e-03]
 [-3.01518558e-02]
 [ 1.27307698e-02]
 [-1.47768568e-02]
 [ 1.62759492e-03]
 [-1.47894279e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-22.38955362]
curr_Stock_Price:  98.9354687808081
curr_Factors:  [98.93546878]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-13.81561693]


portfolio before change:  [-22.2734173]
curr_Stock_Price:  97.51563090291125
curr_Factors:  [97.5156309]
mat_Sqrt:  [[0.15]]
grads:  [-0.09786588]
Stock Position:  -0.09786588099377894
Bond Position:  [-12.72996417]


portfolio before change:  [-22.06420622]
curr_Stock_Price:  95.31284433136717
curr_Factors:  [95.31284433]
mat_Sqrt:  [[0.15]]
grads:  [-0.18373609]
Stock Position:  -0.18373608836353095
Bond Position:  [-4.55179704]


portfolio before change:  [-22.39720201]
curr_Stock_Price:  97.11281362551375
curr_Factors:  [97.11281363]
mat_Sqrt:  [[0.15]]
grads:  [0.03865236]
Stock Position:  0.03865235954772575
Bond Position:  [-26.1508414]


portfolio before change:  [-22.40014828]
curr_Stock_Price:  97.37495603227678
curr_Factors:  [97.37495603]
mat_Sqrt:  [[0.15]]
grads:  [-0.20101237]
Stock Position:  -0.20101237193039412
Bond Position:  [-2.8265774]


portfolio before change:  [-22.84548082]
curr_Stock_Price:  99.58337186635802
curr_Factors:  [99.58337187]
mat_Sqrt:  [[0.15]]
grads:  [0.0848718]
Stock Position:  0.08487179836143374
Bond Position:  [-31.29730068]


portfolio before change:  [-23.01449674]
curr_Stock_Price:  97.77637169149355
curr_Factors:  [97.77637169]
mat_Sqrt:  [[0.15]]
grads:  [-0.09851238]
Stock Position:  -0.09851237887318127
Bond Position:  [-13.38231377]


portfolio before change:  [-22.72881638]
curr_Stock_Price:  94.8084889505693
curr_Factors:  [94.80848895]
mat_Sqrt:  [[0.15]]
grads:  [0.01085063]
Stock Position:  0.010850632813455774
Bond Position:  [-23.75754848]


portfolio before change:  [-22.74522435]
curr_Stock_Price:  94.39134942221634
curr_Factors:  [94.39134942]
mat_Sqrt:  [[0.15]]
grads:  [-0.09859619]
Stock Position:  -0.09859618600738493
Bond Position:  [-13.43859731]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-22.42276826]
Stock Price:  91.05271037549238
PL:  [-22.42276826]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.39915987e-02]
 [-9.80139889e-03]
 [-9.77799589e-04]
 [ 5.49145253e-03]
 [ 6.01958411e-02]
 [ 2.17976091e-03]
 [-6.03693585e-03]
 [-5.07459761e-05]
 [ 2.90331183e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.94761154]
curr_Stock_Price:  100.85730287214321
curr_Factors:  [100.85730287]
mat_Sqrt:  [[0.15]]
grads:  [-0.09327732]
Stock Position:  -0.09327732492630696
Bond Position:  [29.35531095]


portfolio before change:  [19.93081509]
curr_Stock_Price:  101.19476727707281
curr_Factors:  [101.19476728]
mat_Sqrt:  [[0.15]]
grads:  [-0.06534266]
Stock Position:  -0.06534265925573823
Bond Position:  [26.54315028]


portfolio before change:  [19.82358959]
curr_Stock_Price:  103.03889771883392
curr_Factors:  [103.03889772]
mat_Sqrt:  [[0.15]]
grads:  [-0.00651866]
Stock Position:  -0.006518663924592999
Bond Position:  [20.49526554]


portfolio before change:  [19.81923582]
curr_Stock_Price:  105.27922875853216
curr_Factors:  [105.27922876]
mat_Sqrt:  [[0.15]]
grads:  [0.03660968]
Stock Position:  0.03660968354579135
Bond Position:  [15.96499657]


portfolio before change:  [19.84364118]
curr_Stock_Price:  105.72776742894398
curr_Factors:  [105.72776743]
mat_Sqrt:  [[0.15]]
grads:  [0.40130561]
Stock Position:  0.40130560716714697
Bond Position:  [-22.58550473]


portfolio before change:  [19.38147074]
curr_Stock_Price:  104.60424747912695
curr_Factors:  [104.60424748]
mat_Sqrt:  [[0.15]]
grads:  [0.01453174]
Stock Position:  0.014531739415825657
Bond Position:  [17.86138908]


portfolio before change:  [19.41839067]
curr_Stock_Price:  106.5301696588934
curr_Factors:  [106.53016966]
mat_Sqrt:  [[0.15]]
grads:  [-0.04024624]
Stock Position:  -0.04024623900008659
Bond Position:  [23.70582934]


portfolio before change:  [19.50152289]
curr_Stock_Price:  104.75916344938562
curr_Factors:  [104.75916345]
mat_Sqrt:  [[0.15]]
grads:  [-0.00033831]
Stock Position:  -0.0003383065071674383
Bond Position:  [19.5369636]


portfolio before change:  [19.51054353]
curr_Stock_Price:  106.97693022834603
curr_Factors:  [106.97693023]
mat_Sqrt:  [[0.15]]
grads:  [0.01935541]
Stock Position:  0.01935541217150483
Bond Position:  [17.43996095]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.49442094]
Stock Price:  105.69332264374661
PL:  [13.80109829]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.32383802e-02]
 [-1.47231887e-02]
 [-2.52517540e-02]
 [ 6.60424064e-03]
 [-3.31593387e-02]
 [ 1.41541034e-02]
 [-1.37267549e-02]
 [ 2.15227973e-03]
 [-1.24231339e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-39.24301888]
curr_Stock_Price:  98.17043021558408
curr_Factors:  [98.17043022]
mat_Sqrt:  [[0.15]]
grads:  [-0.08825587]
Stock Position:  -0.08825586818804766
Bond Position:  [-30.57890234]


portfolio before change:  [-39.2111185]
curr_Stock_Price:  97.6356934200718
curr_Factors:  [97.63569342]
mat_Sqrt:  [[0.15]]
grads:  [-0.09815459]
Stock Position:  -0.0981545915264674
Bond Position:  [-29.62772689]


portfolio before change:  [-39.02548819]
curr_Stock_Price:  95.59352836675069
curr_Factors:  [95.59352837]
mat_Sqrt:  [[0.15]]
grads:  [-0.16834503]
Stock Position:  -0.1683450264115782
Bond Position:  [-22.93279313]


portfolio before change:  [-38.96887617]
curr_Stock_Price:  95.18911317504329
curr_Factors:  [95.18911318]
mat_Sqrt:  [[0.15]]
grads:  [0.04402827]
Stock Position:  0.04402827090244407
Bond Position:  [-43.15988823]


portfolio before change:  [-38.92329402]
curr_Stock_Price:  96.71466668706391
curr_Factors:  [96.71466669]
mat_Sqrt:  [[0.15]]
grads:  [-0.22106226]
Stock Position:  -0.22106225815744
Bond Position:  [-17.54333141]


portfolio before change:  [-38.67221948]
curr_Stock_Price:  95.53921318527092
curr_Factors:  [95.53921319]
mat_Sqrt:  [[0.15]]
grads:  [0.09436069]
Stock Position:  0.09436068901283971
Bond Position:  [-47.68736546]


portfolio before change:  [-38.64214276]
curr_Stock_Price:  96.11070497799513
curr_Factors:  [96.11070498]
mat_Sqrt:  [[0.15]]
grads:  [-0.0915117]
Stock Position:  -0.09151169926864301
Bond Position:  [-29.84688883]


portfolio before change:  [-38.59086038]
curr_Stock_Price:  95.38719576489282
curr_Factors:  [95.38719576]
mat_Sqrt:  [[0.15]]
grads:  [0.01434853]
Stock Position:  0.014348531559387473
Bond Position:  [-39.95952657]


portfolio before change:  [-38.61310624]
curr_Stock_Price:  95.22961163743975
curr_Factors:  [95.22961164]
mat_Sqrt:  [[0.15]]
grads:  [-0.08282089]
Stock Position:  -0.08282089245886275
Bond Position:  [-30.72610482]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-38.57413351]
Stock Price:  94.5735015836081
PL:  [-38.57413351]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.50170755e-02]
 [-1.36274577e-02]
 [-8.98298812e-03]
 [ 8.56167902e-03]
 [ 1.44315607e-02]
 [ 9.96092333e-03]
 [-7.73453774e-03]
 [ 1.77570963e-03]
 [ 2.85526050e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [35.94471853]
curr_Stock_Price:  101.58346829803189
curr_Factors:  [101.5834683]
mat_Sqrt:  [[0.15]]
grads:  [-0.10011384]
Stock Position:  -0.10011383660249207
Bond Position:  [46.11462927]


portfolio before change:  [36.08088193]
curr_Stock_Price:  100.45375109119418
curr_Factors:  [100.45375109]
mat_Sqrt:  [[0.15]]
grads:  [-0.09084972]
Stock Position:  -0.09084971796083553
Bond Position:  [45.20707688]


portfolio before change:  [36.36534596]
curr_Stock_Price:  97.57146545831152
curr_Factors:  [97.57146546]
mat_Sqrt:  [[0.15]]
grads:  [-0.05988659]
Stock Position:  -0.05988658747086112
Bond Position:  [42.20856806]


portfolio before change:  [36.36958344]
curr_Stock_Price:  97.85319929507504
curr_Factors:  [97.8531993]
mat_Sqrt:  [[0.15]]
grads:  [0.05707786]
Stock Position:  0.05707786010572044
Bond Position:  [30.78433222]


portfolio before change:  [36.53427684]
curr_Stock_Price:  100.46887873207612
curr_Factors:  [100.46887873]
mat_Sqrt:  [[0.15]]
grads:  [0.0962104]
Stock Position:  0.09621040451561982
Bond Position:  [26.86812538]


portfolio before change:  [36.6523281]
curr_Stock_Price:  101.55622311298286
curr_Factors:  [101.55622311]
mat_Sqrt:  [[0.15]]
grads:  [0.06640616]
Stock Position:  0.0664061555004448
Bond Position:  [29.90836976]


portfolio before change:  [36.73286589]
curr_Stock_Price:  102.5437800075406
curr_Factors:  [102.54378001]
mat_Sqrt:  [[0.15]]
grads:  [-0.05156358]
Stock Position:  -0.05156358491972072
Bond Position:  [42.02039079]


portfolio before change:  [36.73554394]
curr_Stock_Price:  102.89940687716874
curr_Factors:  [102.89940688]
mat_Sqrt:  [[0.15]]
grads:  [0.01183806]
Stock Position:  0.011838064213037397
Bond Position:  [35.51741415]


portfolio before change:  [36.74923595]
curr_Stock_Price:  102.55550515180546
curr_Factors:  [102.55550515]
mat_Sqrt:  [[0.15]]
grads:  [0.00190351]
Stock Position:  0.0019035070021609837
Bond Position:  [36.55402083]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [36.76237717]
Stock Price:  99.85503572251936
PL:  [36.76237717]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 3.30443445]
 [-0.01410742]
 [-0.01447648]
 [-0.00827992]
 [ 0.00576817]
 [-0.02321418]
 [ 0.01362346]
 [-0.01415171]
 [ 0.00357757]
 [-0.00383004]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-59.07452845]
curr_Stock_Price:  97.27020765655678
curr_Factors:  [97.27020766]
mat_Sqrt:  [[0.15]]
grads:  [-0.09404948]
Stock Position:  -0.09404947516418355
Bond Position:  [-49.92631647]


portfolio before change:  [-59.08063735]
curr_Stock_Price:  97.06966959492566
curr_Factors:  [97.06966959]
mat_Sqrt:  [[0.15]]
grads:  [-0.09650985]
Stock Position:  -0.0965098466343078
Bond Position:  [-49.71245842]


portfolio before change:  [-59.16217755]
curr_Stock_Price:  97.65694389441374
curr_Factors:  [97.65694389]
mat_Sqrt:  [[0.15]]
grads:  [-0.05519945]
Stock Position:  -0.055199452686698236
Bond Position:  [-53.77156769]


portfolio before change:  [-59.15850323]
curr_Stock_Price:  97.10319151626152
curr_Factors:  [97.10319152]
mat_Sqrt:  [[0.15]]
grads:  [0.03845447]
Stock Position:  0.03845447001745769
Bond Position:  [-62.89255499]


portfolio before change:  [-59.14757501]
curr_Stock_Price:  98.20533528994324
curr_Factors:  [98.20533529]
mat_Sqrt:  [[0.15]]
grads:  [-0.15476121]
Stock Position:  -0.15476121498655374
Bond Position:  [-43.949198]


portfolio before change:  [-58.85149942]
curr_Stock_Price:  96.15019708599505
curr_Factors:  [96.15019709]
mat_Sqrt:  [[0.15]]
grads:  [0.09082307]
Stock Position:  0.09082307278818179
Bond Position:  [-67.58415577]


portfolio before change:  [-58.79929544]
curr_Stock_Price:  97.0971426451853
curr_Factors:  [97.09714265]
mat_Sqrt:  [[0.15]]
grads:  [-0.09434476]
Stock Position:  -0.09434476260556632
Bond Position:  [-49.63868857]


portfolio before change:  [-58.82554778]
curr_Stock_Price:  97.1122657427962
curr_Factors:  [97.11226574]
mat_Sqrt:  [[0.15]]
grads:  [0.02385049]
Stock Position:  0.02385048936323344
Bond Position:  [-61.14172284]


portfolio before change:  [-58.83667067]
curr_Stock_Price:  97.92799772536536
curr_Factors:  [97.92799773]
mat_Sqrt:  [[0.15]]
grads:  [-0.02553357]
Stock Position:  -0.025533571701349067
Bond Position:  [-56.33621912]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-58.84568449]
Stock Price:  97.1775608693757
PL:  [-58.84568449]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.33188606e-02]
 [-1.45844941e-02]
 [-1.08922190e-02]
 [ 6.64642042e-03]
 [-3.99158475e-02]
 [ 1.51571552e-02]
 [-1.63097944e-02]
 [-1.70525844e-03]
 [-2.26324738e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.35996637]
curr_Stock_Price:  100.10433082361061
curr_Factors:  [100.10433082]
mat_Sqrt:  [[0.15]]
grads:  [-0.0887924]
Stock Position:  -0.08879240386070203
Bond Position:  [12.24847054]


portfolio before change:  [3.61943038]
curr_Stock_Price:  97.25117859885921
curr_Factors:  [97.2511786]
mat_Sqrt:  [[0.15]]
grads:  [-0.09722996]
Stock Position:  -0.09722996091331447
Bond Position:  [13.07515867]


portfolio before change:  [3.61739733]
curr_Stock_Price:  97.33934345388352
curr_Factors:  [97.33934345]
mat_Sqrt:  [[0.15]]
grads:  [-0.07261479]
Stock Position:  -0.07261479321181516
Bond Position:  [10.68567362]


portfolio before change:  [3.78579365]
curr_Stock_Price:  95.09390360691515
curr_Factors:  [95.09390361]
mat_Sqrt:  [[0.15]]
grads:  [0.04430947]
Stock Position:  0.044309469440880794
Bond Position:  [-0.42776676]


portfolio before change:  [3.78427545]
curr_Stock_Price:  95.06446835075315
curr_Factors:  [95.06446835]
mat_Sqrt:  [[0.15]]
grads:  [-0.26610565]
Stock Position:  -0.266105649937012
Bond Position:  [29.08146759]


portfolio before change:  [4.04471713]
curr_Stock_Price:  94.14040939470705
curr_Factors:  [94.14040939]
mat_Sqrt:  [[0.15]]
grads:  [0.1010477]
Stock Position:  0.10104770106451616
Bond Position:  [-5.46795481]


portfolio before change:  [3.86253773]
curr_Stock_Price:  92.36456750832477
curr_Factors:  [92.36456751]
mat_Sqrt:  [[0.15]]
grads:  [-0.10873196]
Stock Position:  -0.10873196279313375
Bond Position:  [13.90551845]


portfolio before change:  [4.00345929]
curr_Stock_Price:  91.13248211632018
curr_Factors:  [91.13248212]
mat_Sqrt:  [[0.15]]
grads:  [-0.01136839]
Stock Position:  -0.011368389629864022
Bond Position:  [5.03948886]


portfolio before change:  [4.00130359]
curr_Stock_Price:  91.54380462350605
curr_Factors:  [91.54380462]
mat_Sqrt:  [[0.15]]
grads:  [-0.15088316]
Stock Position:  -0.15088315893385149
Bond Position:  [17.81372201]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.81178805]
Stock Price:  92.8588925920704
PL:  [3.81178805]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30133362e-02]
 [-1.44554254e-02]
 [-1.09390367e-03]
 [ 9.40938616e-03]
 [-1.01582729e-02]
 [ 9.71902750e-03]
 [-6.07810830e-03]
 [ 3.75877073e-03]
 [ 3.18732031e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.39680017]
curr_Stock_Price:  99.29828820924718
curr_Factors:  [99.29828821]
mat_Sqrt:  [[0.15]]
grads:  [-0.08675557]
Stock Position:  -0.08675557491973175
Bond Position:  [-5.78212009]


portfolio before change:  [-14.20401839]
curr_Stock_Price:  97.04283003530351
curr_Factors:  [97.04283004]
mat_Sqrt:  [[0.15]]
grads:  [-0.0963695]
Stock Position:  -0.09636950288868357
Bond Position:  [-4.8520491]


portfolio before change:  [-14.34982172]
curr_Stock_Price:  98.53061090950976
curr_Factors:  [98.53061091]
mat_Sqrt:  [[0.15]]
grads:  [-0.00729269]
Stock Position:  -0.007292691134168616
Bond Position:  [-13.63126841]


portfolio before change:  [-14.35653321]
curr_Stock_Price:  98.51609603154287
curr_Factors:  [98.51609603]
mat_Sqrt:  [[0.15]]
grads:  [0.06272924]
Stock Position:  0.0627292410652317
Bond Position:  [-20.53637314]


portfolio before change:  [-14.33163782]
curr_Stock_Price:  99.07669801115375
curr_Factors:  [99.07669801]
mat_Sqrt:  [[0.15]]
grads:  [-0.06772182]
Stock Position:  -0.06772181932224951
Bond Position:  [-7.62198358]


portfolio before change:  [-14.50976876]
curr_Stock_Price:  101.65074267780066
curr_Factors:  [101.65074268]
mat_Sqrt:  [[0.15]]
grads:  [0.06479352]
Stock Position:  0.06479351664057108
Bond Position:  [-21.09607784]


portfolio before change:  [-14.42011477]
curr_Stock_Price:  103.19726565004811
curr_Factors:  [103.19726565]
mat_Sqrt:  [[0.15]]
grads:  [-0.04052072]
Stock Position:  -0.04052072197753841
Bond Position:  [-10.23848706]


portfolio before change:  [-14.33527888]
curr_Stock_Price:  100.97725555602393
curr_Factors:  [100.97725556]
mat_Sqrt:  [[0.15]]
grads:  [0.02505847]
Stock Position:  0.025058471505566185
Bond Position:  [-16.86561456]


portfolio before change:  [-14.34924207]
curr_Stock_Price:  100.75664086329209
curr_Factors:  [100.75664086]
mat_Sqrt:  [[0.15]]
grads:  [0.00212488]
Stock Position:  0.002124880209228076
Bond Position:  [-14.56333786]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.35599406]
Stock Price:  101.00677026717953
PL:  [-15.36276433]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.29992865e-02]
 [-1.39253205e-02]
 [ 2.00342685e-02]
 [ 7.76994401e-03]
 [ 1.02690532e-02]
 [ 8.21631003e-03]
 [-1.38125751e-02]
 [ 3.57969308e-03]
 [-1.98721480e-05]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.34121993]
curr_Stock_Price:  99.52777892787623
curr_Factors:  [99.52777893]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-0.71595251]


portfolio before change:  [-9.28334896]
curr_Stock_Price:  98.85586856673861
curr_Factors:  [98.85586857]
mat_Sqrt:  [[0.15]]
grads:  [-0.09283547]
Stock Position:  -0.09283546993257635
Bond Position:  [-0.10601795]


portfolio before change:  [-9.55431312]
curr_Stock_Price:  101.77405418674329
curr_Factors:  [101.77405419]
mat_Sqrt:  [[0.15]]
grads:  [0.13356179]
Stock Position:  0.13356178979776923
Bond Position:  [-23.14743795]


portfolio before change:  [-9.66711659]
curr_Stock_Price:  101.0161513953085
curr_Factors:  [101.0161514]
mat_Sqrt:  [[0.15]]
grads:  [0.05179963]
Stock Position:  0.051799626759407365
Bond Position:  [-14.89971552]


portfolio before change:  [-9.58913677]
curr_Stock_Price:  102.66542082309536
curr_Factors:  [102.66542082]
mat_Sqrt:  [[0.15]]
grads:  [0.06846035]
Stock Position:  0.0684603544835833
Bond Position:  [-16.61764787]


portfolio before change:  [-9.62268255]
curr_Stock_Price:  102.29681507798843
curr_Factors:  [102.29681508]
mat_Sqrt:  [[0.15]]
grads:  [0.0547754]
Stock Position:  0.05477540021215121
Bond Position:  [-15.22603153]


portfolio before change:  [-9.73648624]
curr_Stock_Price:  100.35819346958984
curr_Factors:  [100.35819347]
mat_Sqrt:  [[0.15]]
grads:  [-0.09208383]
Stock Position:  -0.09208383390182617
Bond Position:  [-0.49511902]


portfolio before change:  [-9.83189845]
curr_Stock_Price:  101.39164946040648
curr_Factors:  [101.39164946]
mat_Sqrt:  [[0.15]]
grads:  [0.02386462]
Stock Position:  0.02386462056460188
Bond Position:  [-12.25157169]


portfolio before change:  [-9.8409173]
curr_Stock_Price:  101.27048568778504
curr_Factors:  [101.27048569]
mat_Sqrt:  [[0.15]]
grads:  [-0.00013248]
Stock Position:  -0.00013248098665355248
Bond Position:  [-9.82750088]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.84604574]
Stock Price:  102.88173945305914
PL:  [-12.72778519]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 3.30443445]
 [-0.01301036]
 [-0.01295321]
 [ 0.00428366]
 [ 0.01120124]
 [-0.02134871]
 [ 0.01245573]
 [-0.01455101]
 [ 0.00349846]
 [-0.00441116]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.98417777]
curr_Stock_Price:  99.63477343183649
curr_Factors:  [99.63477343]
mat_Sqrt:  [[0.15]]
grads:  [-0.08673575]
Stock Position:  -0.08673575002913195
Bond Position:  [1.65771903]


portfolio before change:  [-6.98063751]
curr_Stock_Price:  99.60351534266283
curr_Factors:  [99.60351534]
mat_Sqrt:  [[0.15]]
grads:  [-0.08635476]
Stock Position:  -0.08635476271996823
Bond Position:  [1.62060043]


portfolio before change:  [-6.96449836]
curr_Stock_Price:  99.42600748087398
curr_Factors:  [99.42600748]
mat_Sqrt:  [[0.15]]
grads:  [0.02855776]
Stock Position:  0.028557764029004534
Bond Position:  [-9.80388282]


portfolio before change:  [-6.94316452]
curr_Stock_Price:  100.34474199564517
curr_Factors:  [100.344742]
mat_Sqrt:  [[0.15]]
grads:  [0.07467495]
Stock Position:  0.07467494649859907
Bond Position:  [-14.43640276]


portfolio before change:  [-7.09841355]
curr_Stock_Price:  98.36243024932824
curr_Factors:  [98.36243025]
mat_Sqrt:  [[0.15]]
grads:  [-0.14232472]
Stock Position:  -0.14232471734367588
Bond Position:  [6.90099153]


portfolio before change:  [-7.25111919]
curr_Stock_Price:  99.45961844763752
curr_Factors:  [99.45961845]
mat_Sqrt:  [[0.15]]
grads:  [0.08303822]
Stock Position:  0.08303821536310275
Bond Position:  [-15.51006841]


portfolio before change:  [-7.22692108]
curr_Stock_Price:  99.84444228922247
curr_Factors:  [99.84444229]
mat_Sqrt:  [[0.15]]
grads:  [-0.09700671]
Stock Position:  -0.09700670840207085
Bond Position:  [2.45865962]


portfolio before change:  [-6.94964323]
curr_Stock_Price:  96.99878123855763
curr_Factors:  [96.99878124]
mat_Sqrt:  [[0.15]]
grads:  [0.02332308]
Stock Position:  0.023323075555441376
Bond Position:  [-9.21195313]


portfolio before change:  [-6.93682866]
curr_Stock_Price:  97.74575373398716
curr_Factors:  [97.74575373]
mat_Sqrt:  [[0.15]]
grads:  [-0.02940775]
Stock Position:  -0.029407753307067956
Bond Position:  [-4.06234565]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.92609375]
Stock Price:  97.31163029106713
PL:  [-6.92609375]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.31288742e-02]
 [-1.46670103e-02]
 [ 4.55505476e-04]
 [ 8.59563230e-03]
 [-2.88445599e-02]
 [ 1.22375679e-02]
 [-1.53825644e-02]
 [ 3.38095022e-03]
 [ 3.62723312e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-36.02001924]
curr_Stock_Price:  98.31673360115921
curr_Factors:  [98.3167336]
mat_Sqrt:  [[0.15]]
grads:  [-0.08752583]
Stock Position:  -0.08752582797469327
Bond Position:  [-27.41476572]


portfolio before change:  [-36.02752613]
curr_Stock_Price:  98.2458525641188
curr_Factors:  [98.24585256]
mat_Sqrt:  [[0.15]]
grads:  [-0.09778007]
Stock Position:  -0.09778006839825416
Bond Position:  [-26.42103994]


portfolio before change:  [-36.08700299]
curr_Stock_Price:  98.71898622024806
curr_Factors:  [98.71898622]
mat_Sqrt:  [[0.15]]
grads:  [0.0030367]
Stock Position:  0.0030367031750946905
Bond Position:  [-36.38678325]


portfolio before change:  [-36.10774622]
curr_Stock_Price:  97.8808107688175
curr_Factors:  [97.88081077]
mat_Sqrt:  [[0.15]]
grads:  [0.05730422]
Stock Position:  0.057304215309606076
Bond Position:  [-41.71672928]


portfolio before change:  [-36.14215465]
curr_Stock_Price:  97.64444328138146
curr_Factors:  [97.64444328]
mat_Sqrt:  [[0.15]]
grads:  [-0.19229707]
Stock Position:  -0.19229706590307288
Bond Position:  [-17.36541471]


portfolio before change:  [-36.48101587]
curr_Stock_Price:  99.3614551178194
curr_Factors:  [99.36145512]
mat_Sqrt:  [[0.15]]
grads:  [0.08158379]
Stock Position:  0.0815837859463236
Bond Position:  [-44.58729956]


portfolio before change:  [-36.53672191]
curr_Stock_Price:  98.95197648992492
curr_Factors:  [98.95197649]
mat_Sqrt:  [[0.15]]
grads:  [-0.10255043]
Stock Position:  -0.1025504290893541
Bond Position:  [-26.38915426]


portfolio before change:  [-36.81530404]
curr_Stock_Price:  101.53981799015882
curr_Factors:  [101.53981799]
mat_Sqrt:  [[0.15]]
grads:  [0.02253967]
Stock Position:  0.02253966812596448
Bond Position:  [-39.10397784]


portfolio before change:  [-36.85391403]
curr_Stock_Price:  100.69450366939742
curr_Factors:  [100.69450367]
mat_Sqrt:  [[0.15]]
grads:  [0.00241816]
Stock Position:  0.002418155410508411
Bond Position:  [-37.09740899]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-36.87366386]
Stock Price:  100.1997072574209
PL:  [-37.07337112]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.50234420e-02]
 [-1.17336559e-02]
 [ 2.15800755e-02]
 [ 4.78658422e-03]
 [ 8.06931493e-03]
 [ 1.19979868e-02]
 [-1.52347872e-02]
 [ 4.58295697e-03]
 [-1.04852653e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [36.04402858]
curr_Stock_Price:  101.58797633347602
curr_Factors:  [101.58797633]
mat_Sqrt:  [[0.15]]
grads:  [-0.10015628]
Stock Position:  -0.10015627993054504
Bond Position:  [46.21870237]


portfolio before change:  [36.14400775]
curr_Stock_Price:  100.82053526222158
curr_Factors:  [100.82053526]
mat_Sqrt:  [[0.15]]
grads:  [-0.07822437]
Stock Position:  -0.07822437244101602
Bond Position:  [44.03063085]


portfolio before change:  [36.14214972]
curr_Stock_Price:  101.12579624789552
curr_Factors:  [101.12579625]
mat_Sqrt:  [[0.15]]
grads:  [0.14386717]
Stock Position:  0.1438671700761559
Bond Position:  [21.59346759]


portfolio before change:  [36.29127404]
curr_Stock_Price:  102.08727260508063
curr_Factors:  [102.08727261]
mat_Sqrt:  [[0.15]]
grads:  [0.03191056]
Stock Position:  0.031910561446091154
Bond Position:  [33.03361185]


portfolio before change:  [36.22988509]
curr_Stock_Price:  99.64576488726155
curr_Factors:  [99.64576489]
mat_Sqrt:  [[0.15]]
grads:  [0.05379543]
Stock Position:  0.05379543284920567
Bond Position:  [30.86939804]


portfolio before change:  [36.18758659]
curr_Stock_Price:  98.57249415505228
curr_Factors:  [98.57249416]
mat_Sqrt:  [[0.15]]
grads:  [0.07998658]
Stock Position:  0.0799865786240633
Bond Position:  [28.30311003]


portfolio before change:  [36.19838847]
curr_Stock_Price:  98.53057207706848
curr_Factors:  [98.53057208]
mat_Sqrt:  [[0.15]]
grads:  [-0.10156525]
Stock Position:  -0.10156524794507106
Bond Position:  [46.20567046]


portfolio before change:  [36.14212777]
curr_Stock_Price:  99.31203341253195
curr_Factors:  [99.31203341]
mat_Sqrt:  [[0.15]]
grads:  [0.03055305]
Stock Position:  0.030553046479778207
Bond Position:  [33.1078426]


portfolio before change:  [36.2266586]
curr_Stock_Price:  101.53677939459408
curr_Factors:  [101.53677939]
mat_Sqrt:  [[0.15]]
grads:  [-0.00069902]
Stock Position:  -0.0006990176892576055
Bond Position:  [36.29763461]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [36.24565612]
Stock Price:  100.3291312625042
PL:  [35.91652486]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30296452e-02]
 [-1.39013533e-02]
 [ 1.37940271e-02]
 [ 1.05446695e-02]
 [ 1.48247490e-02]
 [ 1.18748237e-02]
 [-1.53706046e-02]
 [ 4.37511657e-03]
 [-1.20163792e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.65562717]
curr_Stock_Price:  99.05957139968287
curr_Factors:  [99.0595714]
mat_Sqrt:  [[0.15]]
grads:  [-0.0868643]
Stock Position:  -0.08686430142462737
Bond Position:  [-11.0508867]


portfolio before change:  [-19.76652605]
curr_Stock_Price:  100.27263659529152
curr_Factors:  [100.2726366]
mat_Sqrt:  [[0.15]]
grads:  [-0.09267569]
Stock Position:  -0.09267568847474257
Bond Position:  [-10.47369042]


portfolio before change:  [-19.79561196]
curr_Stock_Price:  100.52996144880477
curr_Factors:  [100.52996145]
mat_Sqrt:  [[0.15]]
grads:  [0.09196018]
Stock Position:  0.0919601808765636
Bond Position:  [-29.0403654]


portfolio before change:  [-19.93754139]
curr_Stock_Price:  99.14451824138655
curr_Factors:  [99.14451824]
mat_Sqrt:  [[0.15]]
grads:  [0.0702978]
Stock Position:  0.07029779649571449
Bond Position:  [-26.90718255]


portfolio before change:  [-19.87760578]
curr_Stock_Price:  100.18854183934091
curr_Factors:  [100.18854184]
mat_Sqrt:  [[0.15]]
grads:  [0.09883166]
Stock Position:  0.09883166024301344
Bond Position:  [-29.77940571]


portfolio before change:  [-19.99271501]
curr_Stock_Price:  99.17453676901086
curr_Factors:  [99.17453677]
mat_Sqrt:  [[0.15]]
grads:  [0.07916549]
Stock Position:  0.07916549117668703
Bond Position:  [-27.84391593]


portfolio before change:  [-19.98803732]
curr_Stock_Price:  99.40952715619098
curr_Factors:  [99.40952716]
mat_Sqrt:  [[0.15]]
grads:  [-0.1024707]
Stock Position:  -0.10247069748380015
Bond Position:  [-9.80147374]


portfolio before change:  [-19.89305669]
curr_Stock_Price:  98.43478414137275
curr_Factors:  [98.43478414]
mat_Sqrt:  [[0.15]]
grads:  [0.02916744]
Stock Position:  0.02916744377948671
Bond Position:  [-22.76414772]


portfolio before change:  [-19.8953951]
curr_Stock_Price:  98.74494196283703
curr_Factors:  [98.74494196]
mat_Sqrt:  [[0.15]]
grads:  [-0.00801092]
Stock Position:  -0.00801091944499942
Bond Position:  [-19.10435732]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.92672158]
Stock Price:  101.46272213947627
PL:  [-21.38944372]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.32745347e-02]
 [-1.48050041e-02]
 [ 3.08201877e-03]
 [ 7.11958180e-03]
 [-2.98285379e-02]
 [ 1.32745394e-02]
 [-1.36149546e-02]
 [ 4.39901031e-03]
 [ 3.65901447e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-40.18954873]
curr_Stock_Price:  98.12746386866041
curr_Factors:  [98.12746387]
mat_Sqrt:  [[0.15]]
grads:  [-0.0884969]
Stock Position:  -0.08849689780441287
Bond Position:  [-31.50557259]


portfolio before change:  [-40.18593454]
curr_Stock_Price:  97.90857576731078
curr_Factors:  [97.90857577]
mat_Sqrt:  [[0.15]]
grads:  [-0.09870003]
Stock Position:  -0.09870002757194386
Bond Position:  [-30.52235541]


portfolio before change:  [-40.32930614]
curr_Stock_Price:  99.20651469215125
curr_Factors:  [99.20651469]
mat_Sqrt:  [[0.15]]
grads:  [0.02054679]
Stock Position:  0.02054679182303706
Bond Position:  [-42.36768174]


portfolio before change:  [-40.38655648]
curr_Stock_Price:  97.45143760954684
curr_Factors:  [97.45143761]
mat_Sqrt:  [[0.15]]
grads:  [0.04746388]
Stock Position:  0.047463878662613375
Bond Position:  [-45.01197969]


portfolio before change:  [-40.40953479]
curr_Stock_Price:  97.44160508740556
curr_Factors:  [97.44160509]
mat_Sqrt:  [[0.15]]
grads:  [-0.19885692]
Stock Position:  -0.1988569196267737
Bond Position:  [-21.03259736]


portfolio before change:  [-40.29790004]
curr_Stock_Price:  96.82732587943386
curr_Factors:  [96.82732588]
mat_Sqrt:  [[0.15]]
grads:  [0.08849693]
Stock Position:  0.08849692912006837
Bond Position:  [-48.86682104]


portfolio before change:  [-40.35007298]
curr_Stock_Price:  96.51394302364125
curr_Factors:  [96.51394302]
mat_Sqrt:  [[0.15]]
grads:  [-0.09076636]
Stock Position:  -0.09076636406206422
Bond Position:  [-31.58985329]


portfolio before change:  [-40.54937344]
curr_Stock_Price:  98.5356344427511
curr_Factors:  [98.53563444]
mat_Sqrt:  [[0.15]]
grads:  [0.02932674]
Stock Position:  0.029326735390787124
Bond Position:  [-43.43910192]


portfolio before change:  [-40.52133306]
curr_Stock_Price:  100.23256244451373
curr_Factors:  [100.23256244]
mat_Sqrt:  [[0.15]]
grads:  [0.00243934]
Stock Position:  0.002439342978292045
Bond Position:  [-40.76583466]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-40.53861011]
Stock Price:  101.50789160889165
PL:  [-42.04650172]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.29992865e-02]
 [-1.47892532e-02]
 [-1.35923401e-02]
 [ 6.10510459e-03]
 [-3.34357058e-02]
 [ 1.48664741e-02]
 [-1.39987164e-02]
 [ 2.02429401e-03]
 [-5.21325576e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-28.14598226]
curr_Stock_Price:  98.67416406776401
curr_Factors:  [98.67416407]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-19.59469073]


portfolio before change:  [-28.09470751]
curr_Stock_Price:  97.9694190660171
curr_Factors:  [97.96941907]
mat_Sqrt:  [[0.15]]
grads:  [-0.09859502]
Stock Position:  -0.09859502152052403
Bond Position:  [-18.43541053]


portfolio before change:  [-28.00943867]
curr_Stock_Price:  97.01106595587218
curr_Factors:  [97.01106596]
mat_Sqrt:  [[0.15]]
grads:  [-0.0906156]
Stock Position:  -0.09061560078329241
Bond Position:  [-19.21872265]


portfolio before change:  [-28.03562783]
curr_Stock_Price:  97.1940079267902
curr_Factors:  [97.19400793]
mat_Sqrt:  [[0.15]]
grads:  [0.0407007]
Stock Position:  0.04070069723979024
Bond Position:  [-31.99149172]


portfolio before change:  [-28.07388437]
curr_Stock_Price:  96.64716725580155
curr_Factors:  [96.64716726]
mat_Sqrt:  [[0.15]]
grads:  [-0.22290471]
Stock Position:  -0.2229047053714195
Bond Position:  [-6.53077603]


portfolio before change:  [-27.61210949]
curr_Stock_Price:  94.56088967066115
curr_Factors:  [94.56088967]
mat_Sqrt:  [[0.15]]
grads:  [0.09910983]
Stock Position:  0.09910982760482528
Bond Position:  [-36.98402296]


portfolio before change:  [-27.55222144]
curr_Stock_Price:  95.3517767610897
curr_Factors:  [95.35177676]
mat_Sqrt:  [[0.15]]
grads:  [-0.09332478]
Stock Position:  -0.09332477611293825
Bond Position:  [-18.65353822]


portfolio before change:  [-27.55168198]
curr_Stock_Price:  95.24603252310132
curr_Factors:  [95.24603252]
mat_Sqrt:  [[0.15]]
grads:  [0.01349529]
Stock Position:  0.013495293418393168
Bond Position:  [-28.83705514]


portfolio before change:  [-27.53577987]
curr_Stock_Price:  97.49305632851308
curr_Factors:  [97.49305633]
mat_Sqrt:  [[0.15]]
grads:  [-0.03475504]
Stock Position:  -0.03475503841747381
Bond Position:  [-24.14740495]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-27.54548022]
Stock Price:  97.42468139179611
PL:  [-27.54548022]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.29992865e-02]
 [-1.31470103e-02]
 [ 1.22559054e-02]
 [ 1.15848056e-02]
 [ 9.73295295e-03]
 [ 3.30963640e-03]
 [-5.93305205e-03]
 [ 1.10147431e-03]
 [ 5.65816804e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-29.82338439]
curr_Stock_Price:  98.59802083573511
curr_Factors:  [98.59802084]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-21.27869158]


portfolio before change:  [-30.00291151]
curr_Stock_Price:  100.54680226785068
curr_Factors:  [100.54680227]
mat_Sqrt:  [[0.15]]
grads:  [-0.08764674]
Stock Position:  -0.08764673552835082
Bond Position:  [-21.19031253]


portfolio before change:  [-30.00184736]
curr_Stock_Price:  100.41374586849216
curr_Factors:  [100.41374587]
mat_Sqrt:  [[0.15]]
grads:  [0.08170604]
Stock Position:  0.08170603589829256
Bond Position:  [-38.20625648]


portfolio before change:  [-30.07559586]
curr_Stock_Price:  99.7449997049342
curr_Factors:  [99.7449997]
mat_Sqrt:  [[0.15]]
grads:  [0.07723204]
Stock Position:  0.07723203763593192
Bond Position:  [-37.77910543]


portfolio before change:  [-29.96440763]
curr_Stock_Price:  101.42930731030991
curr_Factors:  [101.42930731]
mat_Sqrt:  [[0.15]]
grads:  [0.06488635]
Stock Position:  0.0648863530281711
Bond Position:  [-36.54578547]


portfolio before change:  [-29.80628584]
curr_Stock_Price:  104.14789509883367
curr_Factors:  [104.1478951]
mat_Sqrt:  [[0.15]]
grads:  [0.02206424]
Stock Position:  0.022064242682617495
Bond Position:  [-32.10423028]


portfolio before change:  [-29.82079831]
curr_Stock_Price:  104.21785744718619
curr_Factors:  [104.21785745]
mat_Sqrt:  [[0.15]]
grads:  [-0.03955368]
Stock Position:  -0.03955368032381816
Bond Position:  [-25.69859849]


portfolio before change:  [-29.81262971]
curr_Stock_Price:  103.68639963943518
curr_Factors:  [103.68639964]
mat_Sqrt:  [[0.15]]
grads:  [0.00734316]
Stock Position:  0.007343162064622133
Bond Position:  [-30.57401574]


portfolio before change:  [-29.83313099]
curr_Stock_Price:  102.97683413387635
curr_Factors:  [102.97683413]
mat_Sqrt:  [[0.15]]
grads:  [0.00377211]
Stock Position:  0.003772112029185461
Bond Position:  [-30.22157115]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-29.85071533]
Stock Price:  102.32208882509934
PL:  [-32.17280415]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.33451449e-02]
 [-6.58819307e-03]
 [-2.20065413e-01]
 [ 5.96194614e-03]
 [ 7.28990120e-02]
 [-5.75466794e-04]
 [-5.93532810e-03]
 [-1.88669761e-04]
 [-1.07189549e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.6829182]
curr_Stock_Price:  100.16438429961214
curr_Factors:  [100.1643843]
mat_Sqrt:  [[0.15]]
grads:  [-0.08896763]
Stock Position:  -0.08896763295424417
Bond Position:  [13.59430638]


portfolio before change:  [4.30606016]
curr_Stock_Price:  104.47670425121837
curr_Factors:  [104.47670425]
mat_Sqrt:  [[0.15]]
grads:  [-0.04392129]
Stock Position:  -0.043921287163455676
Bond Position:  [8.89481148]


portfolio before change:  [4.13909044]
curr_Stock_Price:  108.37955516918561
curr_Factors:  [108.37955517]
mat_Sqrt:  [[0.15]]
grads:  [-1.46710275]
Stock Position:  -1.467102751664991
Bond Position:  [163.14303405]


portfolio before change:  [5.03584478]
curr_Stock_Price:  107.823927809993
curr_Factors:  [107.82392781]
mat_Sqrt:  [[0.15]]
grads:  [0.03974631]
Stock Position:  0.039746307572897654
Bond Position:  [0.75024178]


portfolio before change:  [4.98342161]
curr_Stock_Price:  106.49554316758629
curr_Factors:  [106.49554317]
mat_Sqrt:  [[0.15]]
grads:  [0.48599341]
Stock Position:  0.48599341307026916
Bond Position:  [-46.77271089]


portfolio before change:  [4.62852377]
curr_Stock_Price:  105.81342357200198
curr_Factors:  [105.81342357]
mat_Sqrt:  [[0.15]]
grads:  [-0.00383645]
Stock Position:  -0.00383644529092173
Bond Position:  [5.03447119]


portfolio before change:  [4.63696858]
curr_Stock_Price:  104.268519233691
curr_Factors:  [104.26851923]
mat_Sqrt:  [[0.15]]
grads:  [-0.03956885]
Stock Position:  -0.03956885399267727
Bond Position:  [8.76275439]


portfolio before change:  [4.61581862]
curr_Stock_Price:  104.91378523841804
curr_Factors:  [104.91378524]
mat_Sqrt:  [[0.15]]
grads:  [-0.0012578]
Stock Position:  -0.001257798406857092
Bond Position:  [4.74777901]


portfolio before change:  [4.62247004]
curr_Stock_Price:  101.51344831128908
curr_Factors:  [101.51344831]
mat_Sqrt:  [[0.15]]
grads:  [-0.0007146]
Stock Position:  -0.0007145969927399749
Bond Position:  [4.69501124]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.6233777]
Stock Price:  103.52916891021995
PL:  [1.09420879]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.43150263e-02]
 [-1.30710446e-02]
 [ 1.28907317e-02]
 [ 5.20529574e-03]
 [ 8.08561448e-03]
 [ 6.50182657e-03]
 [-1.34099770e-02]
 [ 3.88313906e-03]
 [ 3.37836680e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [24.99355956]
curr_Stock_Price:  101.0863563501569
curr_Factors:  [101.08635635]
mat_Sqrt:  [[0.15]]
grads:  [-0.09543351]
Stock Position:  -0.09543350838764664
Bond Position:  [34.6405852]


portfolio before change:  [25.12049816]
curr_Stock_Price:  99.93776635732178
curr_Factors:  [99.93776636]
mat_Sqrt:  [[0.15]]
grads:  [-0.0871403]
Stock Position:  -0.08714029750149811
Bond Position:  [33.82910485]


portfolio before change:  [25.09176022]
curr_Stock_Price:  100.46171132048644
curr_Factors:  [100.46171132]
mat_Sqrt:  [[0.15]]
grads:  [0.08593821]
Stock Position:  0.08593821111416772
Bond Position:  [16.45826046]


portfolio before change:  [25.20215806]
curr_Stock_Price:  101.65054979230753
curr_Factors:  [101.65054979]
mat_Sqrt:  [[0.15]]
grads:  [0.03470197]
Stock Position:  0.034701971601584294
Bond Position:  [21.67468356]


portfolio before change:  [25.2378553]
curr_Stock_Price:  102.36685468997446
curr_Factors:  [102.36685469]
mat_Sqrt:  [[0.15]]
grads:  [0.0539041]
Stock Position:  0.0539040965602679
Bond Position:  [19.71986248]


portfolio before change:  [25.27684768]
curr_Stock_Price:  102.90725848122584
curr_Factors:  [102.90725848]
mat_Sqrt:  [[0.15]]
grads:  [0.04334551]
Stock Position:  0.043345510490483755
Bond Position:  [20.81628002]


portfolio before change:  [25.18180032]
curr_Stock_Price:  100.4742938128611
curr_Factors:  [100.47429381]
mat_Sqrt:  [[0.15]]
grads:  [-0.08939985]
Stock Position:  -0.08939984691025513
Bond Position:  [34.16418681]


portfolio before change:  [25.16867358]
curr_Stock_Price:  100.81224865856765
curr_Factors:  [100.81224866]
mat_Sqrt:  [[0.15]]
grads:  [0.02588759]
Stock Position:  0.02588759373986438
Bond Position:  [22.55888704]


portfolio before change:  [25.15770793]
curr_Stock_Price:  99.95284426108681
curr_Factors:  [99.95284426]
mat_Sqrt:  [[0.15]]
grads:  [0.00225224]
Stock Position:  0.0022522445308086826
Bond Position:  [24.93258968]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [25.17308353]
Stock Price:  101.24319947192187
PL:  [23.92988406]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.61821177e-02]
 [-1.26133189e-02]
 [ 2.81870355e-03]
 [ 8.50921393e-03]
 [-3.42143710e-02]
 [ 1.23664729e-02]
 [-1.55550272e-02]
 [ 3.15054300e-03]
 [ 4.10449742e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [55.12397483]
curr_Stock_Price:  102.45408276826285
curr_Factors:  [102.45408277]
mat_Sqrt:  [[0.15]]
grads:  [-0.10788078]
Stock Position:  -0.10788078486367979
Bond Position:  [66.1768017]


portfolio before change:  [55.35167951]
curr_Stock_Price:  100.65016554511767
curr_Factors:  [100.65016555]
mat_Sqrt:  [[0.15]]
grads:  [-0.08408879]
Stock Position:  -0.08408879275808093
Bond Position:  [63.81523043]


portfolio before change:  [55.50936534]
curr_Stock_Price:  99.15448192792466
curr_Factors:  [99.15448193]
mat_Sqrt:  [[0.15]]
grads:  [0.01879136]
Stock Position:  0.018791356990873177
Bond Position:  [53.64611807]


portfolio before change:  [55.51094049]
curr_Stock_Price:  97.81053365636824
curr_Factors:  [97.81053366]
mat_Sqrt:  [[0.15]]
grads:  [0.05672809]
Stock Position:  0.05672809285177132
Bond Position:  [49.96233546]


portfolio before change:  [55.45914381]
curr_Stock_Price:  96.4569873684053
curr_Factors:  [96.45698737]
mat_Sqrt:  [[0.15]]
grads:  [-0.22809581]
Stock Position:  -0.22809580694272238
Bond Position:  [77.46057818]


portfolio before change:  [55.09246071]
curr_Stock_Price:  98.23441186580558
curr_Factors:  [98.23441187]
mat_Sqrt:  [[0.15]]
grads:  [0.08244315]
Stock Position:  0.082443152361538
Bond Position:  [46.99370612]


portfolio before change:  [55.20054716]
curr_Stock_Price:  99.26037610135447
curr_Factors:  [99.2603761]
mat_Sqrt:  [[0.15]]
grads:  [-0.10370018]
Stock Position:  -0.10370018121735275
Bond Position:  [65.49386615]


portfolio before change:  [54.97911062]
curr_Stock_Price:  101.7115932073582
curr_Factors:  [101.71159321]
mat_Sqrt:  [[0.15]]
grads:  [0.02100362]
Stock Position:  0.021003619996808838
Bond Position:  [52.84279897]


portfolio before change:  [55.02699622]
curr_Stock_Price:  102.73320700103449
curr_Factors:  [102.733207]
mat_Sqrt:  [[0.15]]
grads:  [0.00273633]
Stock Position:  0.002736331615788396
Bond Position:  [54.74588409]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [55.06182415]
Stock Price:  105.45515320042807
PL:  [49.60667095]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.29992865e-02]
 [-7.91571951e-03]
 [-3.27368371e-02]
 [ 5.84247320e-03]
 [ 4.56088457e-02]
 [ 1.10094295e-02]
 [-5.90130050e-03]
 [ 6.27725445e-04]
 [ 2.69537498e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-25.29555917]
curr_Stock_Price:  98.80355488184492
curr_Factors:  [98.80355488]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-16.73305439]


portfolio before change:  [-25.56982479]
curr_Stock_Price:  101.87176558107063
curr_Factors:  [101.87176558]
mat_Sqrt:  [[0.15]]
grads:  [-0.05277146]
Stock Position:  -0.0527714634051898
Bond Position:  [-20.19390264]


portfolio before change:  [-25.69673528]
curr_Stock_Price:  104.08529175689085
curr_Factors:  [104.08529176]
mat_Sqrt:  [[0.15]]
grads:  [-0.21824558]
Stock Position:  -0.21824558090167248
Bond Position:  [-2.98058032]


portfolio before change:  [-26.33537838]
curr_Stock_Price:  107.00472057084582
curr_Factors:  [107.00472057]
mat_Sqrt:  [[0.15]]
grads:  [0.03894982]
Stock Position:  0.038949821315158985
Bond Position:  [-30.50319313]


portfolio before change:  [-26.43471036]
curr_Stock_Price:  104.84613392090215
curr_Factors:  [104.84613392]
mat_Sqrt:  [[0.15]]
grads:  [0.30405897]
Stock Position:  0.3040589716603201
Bond Position:  [-58.31411802]


portfolio before change:  [-27.5887741]
curr_Stock_Price:  101.14652464233197
curr_Factors:  [101.14652464]
mat_Sqrt:  [[0.15]]
grads:  [0.0733962]
Stock Position:  0.073396196936586
Bond Position:  [-35.01254434]


portfolio before change:  [-27.43273309]
curr_Stock_Price:  103.51111121052485
curr_Factors:  [103.51111121]
mat_Sqrt:  [[0.15]]
grads:  [-0.039342]
Stock Position:  -0.039342003355785186
Bond Position:  [-23.3603986]


portfolio before change:  [-27.46831734]
curr_Stock_Price:  104.11863316319763
curr_Factors:  [104.11863316]
mat_Sqrt:  [[0.15]]
grads:  [0.00418484]
Stock Position:  0.004184836302198915
Bond Position:  [-27.90403677]


portfolio before change:  [-27.4760771]
curr_Stock_Price:  105.59915479829432
curr_Factors:  [105.5991548]
mat_Sqrt:  [[0.15]]
grads:  [0.01796917]
Stock Position:  0.01796916654878579
Bond Position:  [-29.3736059]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-27.48069081]
Stock Price:  106.15993588602234
PL:  [-33.6406267]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.31103997e-02]
 [-1.46118208e-02]
 [ 1.72595314e-03]
 [ 6.27990583e-03]
 [-4.16397888e-02]
 [ 1.45484340e-02]
 [-1.47355664e-02]
 [ 2.18955577e-03]
 [-1.16693212e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.19582989]
curr_Stock_Price:  99.76134643218363
curr_Factors:  [99.76134643]
mat_Sqrt:  [[0.15]]
grads:  [-0.08740266]
Stock Position:  -0.08740266495233708
Bond Position:  [4.52357765]


portfolio before change:  [-4.06383189]
curr_Stock_Price:  98.27700217392018
curr_Factors:  [98.27700217]
mat_Sqrt:  [[0.15]]
grads:  [-0.09741214]
Stock Position:  -0.09741213849047657
Bond Position:  [5.50954106]


portfolio before change:  [-4.12551897]
curr_Stock_Price:  98.93854749169614
curr_Factors:  [98.93854749]
mat_Sqrt:  [[0.15]]
grads:  [0.01150635]
Stock Position:  0.01150635423436466
Bond Position:  [-5.26394095]


portfolio before change:  [-4.16287013]
curr_Stock_Price:  95.92121220685304
curr_Factors:  [95.92121221]
mat_Sqrt:  [[0.15]]
grads:  [0.04186604]
Stock Position:  0.041866038872793374
Bond Position:  [-8.17871133]


portfolio before change:  [-4.22045678]
curr_Stock_Price:  94.6434158129262
curr_Factors:  [94.64341581]
mat_Sqrt:  [[0.15]]
grads:  [-0.27759859]
Stock Position:  -0.27759859233296863
Bond Position:  [22.05242222]


portfolio before change:  [-4.31422964]
curr_Stock_Price:  95.02094592601478
curr_Factors:  [95.02094593]
mat_Sqrt:  [[0.15]]
grads:  [0.09698956]
Stock Position:  0.09698955976303043
Bond Position:  [-13.53026935]


portfolio before change:  [-4.40386727]
curr_Stock_Price:  94.16651580265209
curr_Factors:  [94.1665158]
mat_Sqrt:  [[0.15]]
grads:  [-0.09823711]
Stock Position:  -0.09823710959933328
Bond Position:  [4.84677907]


portfolio before change:  [-4.52539827]
curr_Stock_Price:  95.4283097779009
curr_Factors:  [95.42830978]
mat_Sqrt:  [[0.15]]
grads:  [0.01459704]
Stock Position:  0.014597038490672318
Bond Position:  [-5.91836898]


portfolio before change:  [-4.52781193]
curr_Stock_Price:  95.46573258730795
curr_Factors:  [95.46573259]
mat_Sqrt:  [[0.15]]
grads:  [-0.07779547]
Stock Position:  -0.07779547456906605
Bond Position:  [2.89899004]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.52773467]
Stock Price:  95.48337626933034
PL:  [-4.52773467]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.54972220e-02]
 [-1.23750172e-02]
 [ 2.62917260e-03]
 [ 1.19980149e-02]
 [-1.91853897e-02]
 [ 1.24105532e-02]
 [-1.52911309e-02]
 [ 4.62640171e-03]
 [-7.75953681e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [43.43445073]
curr_Stock_Price:  101.92345380797877
curr_Factors:  [101.92345381]
mat_Sqrt:  [[0.15]]
grads:  [-0.10331481]
Stock Position:  -0.10331481332744355
Bond Position:  [53.96465334]


portfolio before change:  [43.58822102]
curr_Stock_Price:  100.69631890234683
curr_Factors:  [100.6963189]
mat_Sqrt:  [[0.15]]
grads:  [-0.08250011]
Stock Position:  -0.08250011438004272
Bond Position:  [51.89567885]


portfolio before change:  [43.74446691]
curr_Stock_Price:  99.11702940607975
curr_Factors:  [99.11702941]
mat_Sqrt:  [[0.15]]
grads:  [0.01752782]
Stock Position:  0.017527817327427805
Bond Position:  [42.00716173]


portfolio before change:  [43.78114924]
curr_Stock_Price:  100.01123633990551
curr_Factors:  [100.01123634]
mat_Sqrt:  [[0.15]]
grads:  [0.07998677]
Stock Position:  0.07998676627320143
Bond Position:  [35.78157385]


portfolio before change:  [43.6813163]
curr_Stock_Price:  98.53939034054558
curr_Factors:  [98.53939034]
mat_Sqrt:  [[0.15]]
grads:  [-0.1279026]
Stock Position:  -0.1279025979536663
Bond Position:  [56.28476032]


portfolio before change:  [43.5943662]
curr_Stock_Price:  99.43929006242173
curr_Factors:  [99.43929006]
mat_Sqrt:  [[0.15]]
grads:  [0.08273702]
Stock Position:  0.08273702140902377
Bond Position:  [35.36705553]


portfolio before change:  [43.55143963]
curr_Stock_Price:  98.7066733736744
curr_Factors:  [98.70667337]
mat_Sqrt:  [[0.15]]
grads:  [-0.10194087]
Stock Position:  -0.10194087292085331
Bond Position:  [53.61368408]


portfolio before change:  [43.4966949]
curr_Stock_Price:  99.50672805570409
curr_Factors:  [99.50672806]
mat_Sqrt:  [[0.15]]
grads:  [0.03084268]
Stock Position:  0.030842678092668392
Bond Position:  [40.42764092]


portfolio before change:  [43.43006476]
curr_Stock_Price:  96.69085658122282
curr_Factors:  [96.69085658]
mat_Sqrt:  [[0.15]]
grads:  [-0.05173025]
Stock Position:  -0.0517302454094456
Bond Position:  [48.4319065]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [43.63295898]
Stock Price:  93.2369349575062
PL:  [43.63295898]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.32711623e-02]
 [-1.39432893e-02]
 [ 1.12922593e-02]
 [ 9.34498936e-03]
 [ 1.27825430e-02]
 [ 5.38122413e-03]
 [-8.07523033e-03]
 [-1.41453148e-04]
 [ 3.24765251e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.22363454]
curr_Stock_Price:  100.00735514481072
curr_Factors:  [100.00735514]
mat_Sqrt:  [[0.15]]
grads:  [-0.08847442]
Stock Position:  -0.08847441530034941
Bond Position:  [10.07172682]


portfolio before change:  [1.20273595]
curr_Stock_Price:  100.30049887386784
curr_Factors:  [100.30049887]
mat_Sqrt:  [[0.15]]
grads:  [-0.09295526]
Stock Position:  -0.09295526209208115
Bond Position:  [10.52619511]


portfolio before change:  [1.20424153]
curr_Stock_Price:  100.34093583575297
curr_Factors:  [100.34093584]
mat_Sqrt:  [[0.15]]
grads:  [0.07528173]
Stock Position:  0.07528172833495424
Bond Position:  [-6.34959754]


portfolio before change:  [1.22710509]
curr_Stock_Price:  100.68682514973892
curr_Factors:  [100.68682515]
mat_Sqrt:  [[0.15]]
grads:  [0.06229993]
Stock Position:  0.0622999290382486
Bond Position:  [-5.04567698]


portfolio before change:  [1.36010247]
curr_Stock_Price:  102.86212228339633
curr_Factors:  [102.86212228]
mat_Sqrt:  [[0.15]]
grads:  [0.08521695]
Stock Position:  0.08521695307329859
Bond Position:  [-7.40549417]


portfolio before change:  [1.39653581]
curr_Stock_Price:  103.33312020252751
curr_Factors:  [103.3331202]
mat_Sqrt:  [[0.15]]
grads:  [0.03587483]
Stock Position:  0.03587482754033128
Bond Position:  [-2.31052206]


portfolio before change:  [1.36229798]
curr_Stock_Price:  102.4109616742305
curr_Factors:  [102.41096167]
mat_Sqrt:  [[0.15]]
grads:  [-0.05383487]
Stock Position:  -0.05383486886229517
Bond Position:  [6.87557867]


portfolio before change:  [1.23384709]
curr_Stock_Price:  104.86085225665356
curr_Factors:  [104.86085226]
mat_Sqrt:  [[0.15]]
grads:  [-0.00094302]
Stock Position:  -0.000943020986006853
Bond Position:  [1.33273307]


portfolio before change:  [1.2366465]
curr_Stock_Price:  102.59910850146251
curr_Factors:  [102.5991085]
mat_Sqrt:  [[0.15]]
grads:  [0.0021651]
Stock Position:  0.0021651016733086914
Bond Position:  [1.01450899]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.23843062]
Stock Price:  103.18879948117117
PL:  [-1.95036886]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.52198276e-02]
 [-7.15606511e-03]
 [ 5.26576752e-03]
 [ 5.29065854e-03]
 [ 9.84654753e-03]
 [ 3.79710689e-03]
 [-6.00259469e-03]
 [-1.83485866e-03]
 [ 1.93119273e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [39.1074175]
curr_Stock_Price:  101.72703442216908
curr_Factors:  [101.72703442]
mat_Sqrt:  [[0.15]]
grads:  [-0.10146552]
Stock Position:  -0.10146551721360536
Bond Position:  [49.42920366]


portfolio before change:  [39.01260839]
curr_Stock_Price:  102.905069019073
curr_Factors:  [102.90506902]
mat_Sqrt:  [[0.15]]
grads:  [-0.0477071]
Stock Position:  -0.04770710070162341
Bond Position:  [43.92191088]


portfolio before change:  [39.03800421]
curr_Stock_Price:  102.8331852066748
curr_Factors:  [102.83318521]
mat_Sqrt:  [[0.15]]
grads:  [0.03510512]
Stock Position:  0.0351051167918368
Bond Position:  [35.42803323]


portfolio before change:  [39.1143482]
curr_Stock_Price:  104.5031851570394
curr_Factors:  [104.50318516]
mat_Sqrt:  [[0.15]]
grads:  [0.03527106]
Stock Position:  0.035271056955350835
Bond Position:  [35.4284104]


portfolio before change:  [39.06579265]
curr_Stock_Price:  102.62418907277166
curr_Factors:  [102.62418907]
mat_Sqrt:  [[0.15]]
grads:  [0.06564365]
Stock Position:  0.06564365021907852
Bond Position:  [32.32916628]


portfolio before change:  [39.16939726]
curr_Stock_Price:  103.9561683801616
curr_Factors:  [103.95616838]
mat_Sqrt:  [[0.15]]
grads:  [0.02531405]
Stock Position:  0.025314045946949814
Bond Position:  [36.53784604]


portfolio before change:  [39.2334794]
curr_Stock_Price:  105.76578207545654
curr_Factors:  [105.76578208]
mat_Sqrt:  [[0.15]]
grads:  [-0.0400173]
Stock Position:  -0.040017297920996696
Bond Position:  [43.46594021]


portfolio before change:  [39.18495743]
curr_Stock_Price:  107.52153207200908
curr_Factors:  [107.52153207]
mat_Sqrt:  [[0.15]]
grads:  [-0.01223239]
Stock Position:  -0.012232391064232037
Bond Position:  [40.50020286]


portfolio before change:  [39.24150166]
curr_Stock_Price:  104.55489518250846
curr_Factors:  [104.55489518]
mat_Sqrt:  [[0.15]]
grads:  [0.01287462]
Stock Position:  0.01287461819813472
Bond Position:  [37.8953973]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [39.2513098]
Stock Price:  103.84463778382772
PL:  [35.40667202]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.55964804e-02]
 [-1.48029947e-02]
 [-8.36386678e-03]
 [ 6.94442907e-03]
 [-4.07232576e-02]
 [ 1.36810752e-02]
 [-1.37126012e-02]
 [ 2.17926186e-03]
 [-1.47720695e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-92.83555164]
curr_Stock_Price:  95.73767506781319
curr_Factors:  [95.73767507]
mat_Sqrt:  [[0.15]]
grads:  [-0.10397654]
Stock Position:  -0.10397653620532075
Bond Position:  [-82.8810798]


portfolio before change:  [-93.09735704]
curr_Stock_Price:  97.85694641551255
curr_Factors:  [97.85694642]
mat_Sqrt:  [[0.15]]
grads:  [-0.09868663]
Stock Position:  -0.09868663159761755
Bond Position:  [-83.44018462]


portfolio before change:  [-93.11834275]
curr_Stock_Price:  97.64673749002598
curr_Factors:  [97.64673749]
mat_Sqrt:  [[0.15]]
grads:  [-0.05575911]
Stock Position:  -0.05575911188507072
Bond Position:  [-87.67364739]


portfolio before change:  [-92.98233904]
curr_Stock_Price:  94.42122881373741
curr_Factors:  [94.42122881]
mat_Sqrt:  [[0.15]]
grads:  [0.04629619]
Stock Position:  0.04629619380486763
Bond Position:  [-97.35368254]


portfolio before change:  [-93.01037814]
curr_Stock_Price:  94.86726786454518
curr_Factors:  [94.86726786]
mat_Sqrt:  [[0.15]]
grads:  [-0.27148838]
Stock Position:  -0.2714883839780884
Bond Position:  [-67.25501689]


portfolio before change:  [-93.37430462]
curr_Stock_Price:  96.08385974712932
curr_Factors:  [96.08385975]
mat_Sqrt:  [[0.15]]
grads:  [0.09120717]
Stock Position:  0.09120716809084656
Bond Position:  [-102.13784137]


portfolio before change:  [-93.41919656]
curr_Stock_Price:  96.15172449813346
curr_Factors:  [96.1517245]
mat_Sqrt:  [[0.15]]
grads:  [-0.09141734]
Stock Position:  -0.09141734147689544
Bond Position:  [-84.62926153]


portfolio before change:  [-93.39435119]
curr_Stock_Price:  95.41695599625191
curr_Factors:  [95.416956]
mat_Sqrt:  [[0.15]]
grads:  [0.01452841]
Stock Position:  0.014528412413341655
Bond Position:  [-94.78060807]


portfolio before change:  [-93.45656221]
curr_Stock_Price:  94.3976516748558
curr_Factors:  [94.39765167]
mat_Sqrt:  [[0.15]]
grads:  [-0.09848046]
Stock Position:  -0.09848046325798882
Bond Position:  [-84.16023775]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-93.51373013]
Stock Price:  94.55075082089917
PL:  [-93.51373013]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.35111338e-02]
 [-1.40660599e-02]
 [-4.90595944e-03]
 [ 1.02814069e-02]
 [-3.03530764e-02]
 [ 1.18625124e-02]
 [-1.51224092e-02]
 [ 4.65235382e-03]
 [ 1.39442274e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-45.55422803]
curr_Stock_Price:  97.88394204733073
curr_Factors:  [97.88394205]
mat_Sqrt:  [[0.15]]
grads:  [-0.09007423]
Stock Position:  -0.09007422525055311
Bond Position:  [-36.73740779]


portfolio before change:  [-45.45212424]
curr_Stock_Price:  96.5464108745483
curr_Factors:  [96.54641087]
mat_Sqrt:  [[0.15]]
grads:  [-0.09377373]
Stock Position:  -0.09377373286112586
Bond Position:  [-36.3986069]


portfolio before change:  [-45.61293308]
curr_Stock_Price:  98.06714572887981
curr_Factors:  [98.06714573]
mat_Sqrt:  [[0.15]]
grads:  [-0.0327064]
Stock Position:  -0.03270639625602065
Bond Position:  [-42.40551015]


portfolio before change:  [-45.66461195]
curr_Stock_Price:  98.99879245638948
curr_Factors:  [98.99879246]
mat_Sqrt:  [[0.15]]
grads:  [0.06854271]
Stock Position:  0.06854271262992427
Bond Position:  [-52.45025773]


portfolio before change:  [-45.80498892]
curr_Stock_Price:  97.33347621271278
curr_Factors:  [97.33347621]
mat_Sqrt:  [[0.15]]
grads:  [-0.20235384]
Stock Position:  -0.2023538429003916
Bond Position:  [-26.10918597]


portfolio before change:  [-46.1116554]
curr_Stock_Price:  98.784442569042
curr_Factors:  [98.78444257]
mat_Sqrt:  [[0.15]]
grads:  [0.07908342]
Stock Position:  0.07908341578810842
Bond Position:  [-53.92386655]


portfolio before change:  [-46.1864779]
curr_Stock_Price:  98.17933689228859
curr_Factors:  [98.17933689]
mat_Sqrt:  [[0.15]]
grads:  [-0.10081606]
Stock Position:  -0.10081606148069203
Bond Position:  [-36.28842383]


portfolio before change:  [-46.35532276]
curr_Stock_Price:  99.67409982637551
curr_Factors:  [99.67409983]
mat_Sqrt:  [[0.15]]
grads:  [0.03101569]
Stock Position:  0.031015692159686074
Bond Position:  [-49.44678396]


portfolio before change:  [-46.29571836]
curr_Stock_Price:  102.39317406839123
curr_Factors:  [102.39317407]
mat_Sqrt:  [[0.15]]
grads:  [0.00092962]
Stock Position:  0.0009296151631901322
Bond Position:  [-46.39090461]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-46.31898353]
Stock Price:  102.32441889542157
PL:  [-48.64340243]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.32116980e-02]
 [-1.43360570e-02]
 [-1.76487109e-02]
 [ 8.81027714e-03]
 [-2.55405727e-02]
 [ 1.22318826e-02]
 [-1.52260226e-02]
 [ 4.34130993e-03]
 [ 2.82850296e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.01521007]
curr_Stock_Price:  99.90572604697783
curr_Factors:  [99.90572605]
mat_Sqrt:  [[0.15]]
grads:  [-0.08807799]
Stock Position:  -0.08807798639660004
Bond Position:  [7.78428511]


portfolio before change:  [-0.88716319]
curr_Stock_Price:  98.49613708607725
curr_Factors:  [98.49613709]
mat_Sqrt:  [[0.15]]
grads:  [-0.09557371]
Stock Position:  -0.09557371309636148
Bond Position:  [8.52647835]


portfolio before change:  [-0.69383116]
curr_Stock_Price:  96.51789724270934
curr_Factors:  [96.51789724]
mat_Sqrt:  [[0.15]]
grads:  [-0.11765807]
Stock Position:  -0.11765807295910723
Bond Position:  [10.66227863]


portfolio before change:  [-0.86939408]
curr_Stock_Price:  98.05536416392874
curr_Factors:  [98.05536416]
mat_Sqrt:  [[0.15]]
grads:  [0.05873518]
Stock Position:  0.058735180918608534
Bond Position:  [-6.62869364]


portfolio before change:  [-0.87671448]
curr_Stock_Price:  97.98717302555018
curr_Factors:  [97.98717303]
mat_Sqrt:  [[0.15]]
grads:  [-0.17027048]
Stock Position:  -0.17027048477327003
Bond Position:  [15.80760897]


portfolio before change:  [-1.1023728]
curr_Stock_Price:  99.35889699722445
curr_Factors:  [99.358897]
mat_Sqrt:  [[0.15]]
grads:  [0.08154588]
Stock Position:  0.08154588374952712
Bond Position:  [-9.20468187]


portfolio before change:  [-1.09659128]
curr_Stock_Price:  99.4862487504415
curr_Factors:  [99.48624875]
mat_Sqrt:  [[0.15]]
grads:  [-0.10150682]
Stock Position:  -0.1015068175875184
Bond Position:  [9.00194122]


portfolio before change:  [-0.9727161]
curr_Stock_Price:  98.31023820060467
curr_Factors:  [98.3102382]
mat_Sqrt:  [[0.15]]
grads:  [0.02894207]
Stock Position:  0.028942066186368604
Bond Position:  [-3.81801752]


portfolio before change:  [-0.94599105]
curr_Stock_Price:  99.29961237218775
curr_Factors:  [99.29961237]
mat_Sqrt:  [[0.15]]
grads:  [0.00188567]
Stock Position:  0.001885668640203227
Bond Position:  [-1.13323722]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.95181468]
Stock Price:  96.51181294709775
PL:  [-0.95181468]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.36249183e-02]
 [-1.38137351e-02]
 [ 2.64284063e-03]
 [ 9.07696645e-03]
 [-3.03720007e-02]
 [ 1.32905543e-02]
 [-1.43995930e-02]
 [ 1.62347559e-03]
 [-1.22157656e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-48.13419309]
curr_Stock_Price:  97.76682828235141
curr_Factors:  [97.76682828]
mat_Sqrt:  [[0.15]]
grads:  [-0.09083279]
Stock Position:  -0.09083278871239839
Bond Position:  [-39.25375944]


portfolio before change:  [-48.26162243]
curr_Stock_Price:  98.95359739011927
curr_Factors:  [98.95359739]
mat_Sqrt:  [[0.15]]
grads:  [-0.09209157]
Stock Position:  -0.09209156705803523
Bond Position:  [-39.14883058]


portfolio before change:  [-48.29650118]
curr_Stock_Price:  99.11973029685572
curr_Factors:  [99.1197303]
mat_Sqrt:  [[0.15]]
grads:  [0.01761894]
Stock Position:  0.017618937563233843
Bond Position:  [-50.04288552]


portfolio before change:  [-48.33646074]
curr_Stock_Price:  98.27224114501031
curr_Factors:  [98.27224115]
mat_Sqrt:  [[0.15]]
grads:  [0.06051311]
Stock Position:  0.06051310967854011
Bond Position:  [-54.28321964]


portfolio before change:  [-48.42065278]
curr_Stock_Price:  97.3295751526797
curr_Factors:  [97.32957515]
mat_Sqrt:  [[0.15]]
grads:  [-0.20248]
Stock Position:  -0.20248000446140146
Bond Position:  [-28.71335997]


portfolio before change:  [-48.35005356]
curr_Stock_Price:  96.90998068639527
curr_Factors:  [96.90998069]
mat_Sqrt:  [[0.15]]
grads:  [0.0886037]
Stock Position:  0.08860369551491644
Bond Position:  [-56.93663598]


portfolio before change:  [-48.58753547]
curr_Stock_Price:  94.55108958354101
curr_Factors:  [94.55108958]
mat_Sqrt:  [[0.15]]
grads:  [-0.09599729]
Stock Position:  -0.09599728652265573
Bond Position:  [-39.51088743]


portfolio before change:  [-48.63156933]
curr_Stock_Price:  94.80394549228056
curr_Factors:  [94.80394549]
mat_Sqrt:  [[0.15]]
grads:  [0.01082317]
Stock Position:  0.010823170622486163
Bond Position:  [-49.65764861]


portfolio before change:  [-48.65109429]
curr_Stock_Price:  95.29456674508786
curr_Factors:  [95.29456675]
mat_Sqrt:  [[0.15]]
grads:  [-0.08143844]
Stock Position:  -0.0814384375763514
Bond Position:  [-40.89045366]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-48.68489987]
Stock Price:  95.45855861374935
PL:  [-48.68489987]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.41780210e-02]
 [-1.43583914e-02]
 [ 4.53122302e-03]
 [ 1.14090078e-02]
 [-1.47299833e-02]
 [ 1.21477471e-02]
 [-1.44411794e-02]
 [ 4.42021050e-03]
 [ 3.83182558e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-60.67531563]
curr_Stock_Price:  97.19754224854478
curr_Factors:  [97.19754225]
mat_Sqrt:  [[0.15]]
grads:  [-0.09452014]
Stock Position:  -0.0945201399358926
Bond Position:  [-51.48819034]


portfolio before change:  [-60.67474938]
curr_Stock_Price:  96.91911704525076
curr_Factors:  [96.91911705]
mat_Sqrt:  [[0.15]]
grads:  [-0.09572261]
Stock Position:  -0.09572260910015637
Bond Position:  [-51.39739862]


portfolio before change:  [-60.95750318]
curr_Stock_Price:  99.60446671983928
curr_Factors:  [99.60446672]
mat_Sqrt:  [[0.15]]
grads:  [0.03020815]
Stock Position:  0.030208153492257604
Bond Position:  [-63.9663702]


portfolio before change:  [-60.98868042]
curr_Stock_Price:  99.63141104299442
curr_Factors:  [99.63141104]
mat_Sqrt:  [[0.15]]
grads:  [0.07606005]
Stock Position:  0.07606005222971264
Bond Position:  [-68.56665075]


portfolio before change:  [-61.07831111]
curr_Stock_Price:  98.9038439996182
curr_Factors:  [98.903844]
mat_Sqrt:  [[0.15]]
grads:  [-0.09819989]
Stock Position:  -0.09819988844943177
Bond Position:  [-51.36596466]


portfolio before change:  [-61.14496913]
curr_Stock_Price:  99.32104014751249
curr_Factors:  [99.32104015]
mat_Sqrt:  [[0.15]]
grads:  [0.08098498]
Stock Position:  0.08098498065109233
Bond Position:  [-69.18848164]


portfolio before change:  [-61.33420379]
curr_Stock_Price:  97.41165188762717
curr_Factors:  [97.41165189]
mat_Sqrt:  [[0.15]]
grads:  [-0.09627453]
Stock Position:  -0.09627452965872785
Bond Position:  [-51.95594282]


portfolio before change:  [-61.62046208]
curr_Stock_Price:  100.11510651952254
curr_Factors:  [100.11510652]
mat_Sqrt:  [[0.15]]
grads:  [0.02946807]
Stock Position:  0.029468069999242022
Bond Position:  [-64.57066105]


portfolio before change:  [-61.64195682]
curr_Stock_Price:  100.48155963626307
curr_Factors:  [100.48155964]
mat_Sqrt:  [[0.15]]
grads:  [0.00255455]
Stock Position:  0.002554550384838769
Bond Position:  [-61.89864202]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-61.67292593]
Stock Price:  100.47683983529542
PL:  [-62.14976577]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.35232500e-02]
 [-1.37987122e-02]
 [ 4.62772533e-03]
 [ 9.22398994e-03]
 [ 7.85930913e-03]
 [ 1.30806843e-02]
 [-1.12637482e-02]
 [ 3.88030671e-03]
 [-5.13609844e-05]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-45.82895154]
curr_Stock_Price:  97.87147137289503
curr_Factors:  [97.87147137]
mat_Sqrt:  [[0.15]]
grads:  [-0.090155]
Stock Position:  -0.09015499968362817
Bond Position:  [-37.00534907]


portfolio before change:  [-45.69726838]
curr_Stock_Price:  96.20555753493235
curr_Factors:  [96.20555753]
mat_Sqrt:  [[0.15]]
grads:  [-0.09199141]
Stock Position:  -0.09199141470599699
Bond Position:  [-36.84718304]


portfolio before change:  [-46.03476655]
curr_Stock_Price:  99.67403303782511
curr_Factors:  [99.67403304]
mat_Sqrt:  [[0.15]]
grads:  [0.0308515]
Stock Position:  0.030851502185588117
Bond Position:  [-49.10986019]


portfolio before change:  [-46.09888632]
curr_Stock_Price:  98.39180352848291
curr_Factors:  [98.39180353]
mat_Sqrt:  [[0.15]]
grads:  [0.06149327]
Stock Position:  0.06149326625911322
Bond Position:  [-52.14931969]


portfolio before change:  [-46.04842823]
curr_Stock_Price:  99.63648073529458
curr_Factors:  [99.63648074]
mat_Sqrt:  [[0.15]]
grads:  [0.05239539]
Stock Position:  0.05239539419656656
Bond Position:  [-51.26892092]


portfolio before change:  [-46.03685725]
curr_Stock_Price:  100.34669301297376
curr_Factors:  [100.34669301]
mat_Sqrt:  [[0.15]]
grads:  [0.08720456]
Stock Position:  0.08720456228091925
Bond Position:  [-54.78754669]


portfolio before change:  [-45.9827095]
curr_Stock_Price:  101.28183189118923
curr_Factors:  [101.28183189]
mat_Sqrt:  [[0.15]]
grads:  [-0.07509165]
Stock Position:  -0.07509165448113826
Bond Position:  [-38.37728917]


portfolio before change:  [-45.96692334]
curr_Stock_Price:  100.81600650615798
curr_Factors:  [100.81600651]
mat_Sqrt:  [[0.15]]
grads:  [0.02586871]
Stock Position:  0.025868711408045076
Bond Position:  [-48.57490352]


portfolio before change:  [-45.95875622]
curr_Stock_Price:  102.07082919454405
curr_Factors:  [102.07082919]
mat_Sqrt:  [[0.15]]
grads:  [-0.00034241]
Stock Position:  -0.0003424065624022584
Bond Position:  [-45.9238065]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-45.98175094]
Stock Price:  102.14990107271453
PL:  [-48.13165201]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.29992865e-02]
 [-1.34436652e-02]
 [ 7.64548217e-03]
 [ 1.14278791e-02]
 [-2.68352614e-02]
 [ 1.18026565e-02]
 [-1.43543573e-02]
 [ 3.59625688e-03]
 [-3.03813281e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-26.20473309]
curr_Stock_Price:  98.76228425277048
curr_Factors:  [98.76228425]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-17.6458049]


portfolio before change:  [-26.25750479]
curr_Stock_Price:  99.26938808203734
curr_Factors:  [99.26938808]
mat_Sqrt:  [[0.15]]
grads:  [-0.08962443]
Stock Position:  -0.08962443450755793
Bond Position:  [-17.36054202]


portfolio before change:  [-26.33752908]
curr_Stock_Price:  100.06539697446297
curr_Factors:  [100.06539697]
mat_Sqrt:  [[0.15]]
grads:  [0.05096988]
Stock Position:  0.05096988113499047
Bond Position:  [-31.43785047]


portfolio before change:  [-26.37475065]
curr_Stock_Price:  99.64360435677813
curr_Factors:  [99.64360436]
mat_Sqrt:  [[0.15]]
grads:  [0.07618586]
Stock Position:  0.07618586043595378
Bond Position:  [-33.96618439]


portfolio before change:  [-26.52718453]
curr_Stock_Price:  97.86576081201218
curr_Factors:  [97.86576081]
mat_Sqrt:  [[0.15]]
grads:  [-0.17890174]
Stock Position:  -0.178901742705993
Bond Position:  [-9.01882937]


portfolio before change:  [-26.70940823]
curr_Stock_Price:  98.85911704572649
curr_Factors:  [98.85911705]
mat_Sqrt:  [[0.15]]
grads:  [0.07868438]
Stock Position:  0.07868437663680646
Bond Position:  [-34.48807623]


portfolio before change:  [-26.64091612]
curr_Stock_Price:  99.94879292838677
curr_Factors:  [99.94879293]
mat_Sqrt:  [[0.15]]
grads:  [-0.09569572]
Stock Position:  -0.09569571526855754
Bond Position:  [-17.07624489]


portfolio before change:  [-26.38057762]
curr_Stock_Price:  97.13906676749143
curr_Factors:  [97.13906677]
mat_Sqrt:  [[0.15]]
grads:  [0.02397505]
Stock Position:  0.023975045844156394
Bond Position:  [-28.7094912]


portfolio before change:  [-26.3701202]
curr_Stock_Price:  98.17413266673483
curr_Factors:  [98.17413267]
mat_Sqrt:  [[0.15]]
grads:  [-0.02025422]
Stock Position:  -0.02025421873216454
Bond Position:  [-24.38167985]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-26.34013845]
Stock Price:  96.0918189762363
PL:  [-26.34013845]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.35017921e-02]
 [-1.38537419e-02]
 [ 4.38804834e-03]
 [ 4.96374770e-03]
 [ 3.81144372e-02]
 [-9.87327672e-04]
 [-6.07676017e-03]
 [-1.07038243e-03]
 [ 2.97044164e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.78934539]
curr_Stock_Price:  100.39618314159785
curr_Factors:  [100.39618314]
mat_Sqrt:  [[0.15]]
grads:  [-0.09001195]
Stock Position:  -0.09001194732995355
Bond Position:  [18.82620134]


portfolio before change:  [9.93176471]
curr_Stock_Price:  98.91855857465649
curr_Factors:  [98.91855857]
mat_Sqrt:  [[0.15]]
grads:  [-0.09235828]
Stock Position:  -0.09235827932000262
Bond Position:  [19.06771257]


portfolio before change:  [9.88748408]
curr_Stock_Price:  99.5012553405996
curr_Factors:  [99.50125534]
mat_Sqrt:  [[0.15]]
grads:  [0.02925366]
Stock Position:  0.02925365557008434
Bond Position:  [6.97670863]


portfolio before change:  [9.95594615]
curr_Stock_Price:  101.72227154928487
curr_Factors:  [101.72227155]
mat_Sqrt:  [[0.15]]
grads:  [0.03309165]
Stock Position:  0.03309165130167931
Bond Position:  [6.58978821]


portfolio before change:  [10.04762645]
curr_Stock_Price:  104.39317417727281
curr_Factors:  [104.39317418]
mat_Sqrt:  [[0.15]]
grads:  [0.25409625]
Stock Position:  0.25409624827674115
Bond Position:  [-16.47828746]


portfolio before change:  [10.44674096]
curr_Stock_Price:  105.99632934794043
curr_Factors:  [105.99632935]
mat_Sqrt:  [[0.15]]
grads:  [-0.00658218]
Stock Position:  -0.006582184482140282
Bond Position:  [11.14442835]


portfolio before change:  [10.44296605]
curr_Stock_Price:  107.41660478266478
curr_Factors:  [107.41660478]
mat_Sqrt:  [[0.15]]
grads:  [-0.04051173]
Stock Position:  -0.04051173443483317
Bond Position:  [14.79459901]


portfolio before change:  [10.49846841]
curr_Stock_Price:  106.22921527898974
curr_Factors:  [106.22921528]
mat_Sqrt:  [[0.15]]
grads:  [-0.00713588]
Stock Position:  -0.007135882867796246
Bond Position:  [11.25650764]


portfolio before change:  [10.48840161]
curr_Stock_Price:  108.42886625437517
curr_Factors:  [108.42886625]
mat_Sqrt:  [[0.15]]
grads:  [0.01980294]
Stock Position:  0.019802944257134553
Bond Position:  [8.34119082]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.46377504]
Stock Price:  106.97462734333723
PL:  [3.4891477]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.31290707e-02]
 [-1.39057454e-02]
 [ 4.79040042e-03]
 [ 9.40826387e-03]
 [-1.42291418e-02]
 [ 1.25729792e-02]
 [-1.51680236e-02]
 [ 4.36689671e-03]
 [ 2.84238515e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.71272314]
curr_Stock_Price:  99.7832763606511
curr_Factors:  [99.78327636]
mat_Sqrt:  [[0.15]]
grads:  [-0.08752714]
Stock Position:  -0.08752713807451823
Bond Position:  [5.02102146]


portfolio before change:  [-3.40900858]
curr_Stock_Price:  96.34201882122845
curr_Factors:  [96.34201882]
mat_Sqrt:  [[0.15]]
grads:  [-0.09270497]
Stock Position:  -0.09270496918755726
Bond Position:  [5.5223753]


portfolio before change:  [-3.72564288]
curr_Stock_Price:  99.78731605251355
curr_Factors:  [99.78731605]
mat_Sqrt:  [[0.15]]
grads:  [0.031936]
Stock Position:  0.03193600279937902
Bond Position:  [-6.91245088]


portfolio before change:  [-3.76971749]
curr_Stock_Price:  98.51547480117488
curr_Factors:  [98.5154748]
mat_Sqrt:  [[0.15]]
grads:  [0.06272176]
Stock Position:  0.06272175912649446
Bond Position:  [-9.94878137]


portfolio before change:  [-3.74776428]
curr_Stock_Price:  98.94481299448978
curr_Factors:  [98.94481299]
mat_Sqrt:  [[0.15]]
grads:  [-0.09486095]
Stock Position:  -0.09486094501161017
Bond Position:  [5.63823418]


portfolio before change:  [-3.66389051]
curr_Stock_Price:  98.0903628397146
curr_Factors:  [98.09036284]
mat_Sqrt:  [[0.15]]
grads:  [0.08381986]
Stock Position:  0.0838198613315352
Bond Position:  [-11.88581112]


portfolio before change:  [-3.55025223]
curr_Stock_Price:  99.51702561207149
curr_Factors:  [99.51702561]
mat_Sqrt:  [[0.15]]
grads:  [-0.10112016]
Stock Position:  -0.10112015724129403
Bond Position:  [6.51292505]


portfolio before change:  [-3.43405024]
curr_Stock_Price:  98.40008992460227
curr_Factors:  [98.40008992]
mat_Sqrt:  [[0.15]]
grads:  [0.02911264]
Stock Position:  0.02911264475938816
Bond Position:  [-6.2987371]


portfolio before change:  [-3.41016891]
curr_Stock_Price:  99.3286033201443
curr_Factors:  [99.32860332]
mat_Sqrt:  [[0.15]]
grads:  [0.00189492]
Stock Position:  0.0018949234361981232
Bond Position:  [-3.59838901]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.41206171]
Stock Price:  99.2794426660571
PL:  [-3.41206171]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 3.30443445]
 [-0.0133477 ]
 [-0.01468238]
 [-0.01164966]
 [ 0.00936384]
 [-0.01605224]
 [ 0.01194355]
 [-0.01545594]
 [ 0.00365352]
 [-0.00595963]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.81761516]
curr_Stock_Price:  100.17049867254688
curr_Factors:  [100.17049867]
mat_Sqrt:  [[0.15]]
grads:  [-0.08898465]
Stock Position:  -0.08898465314859744
Bond Position:  [13.73125224]


portfolio before change:  [5.06010863]
curr_Stock_Price:  97.52255752827986
curr_Factors:  [97.52255753]
mat_Sqrt:  [[0.15]]
grads:  [-0.09788254]
Stock Position:  -0.09788253723043971
Bond Position:  [14.605864]


portfolio before change:  [5.09436079]
curr_Stock_Price:  97.24725411333964
curr_Factors:  [97.24725411]
mat_Sqrt:  [[0.15]]
grads:  [-0.07766443]
Stock Position:  -0.07766443112046456
Bond Position:  [12.64701346]


portfolio before change:  [5.00409985]
curr_Stock_Price:  98.4908868043974
curr_Factors:  [98.4908868]
mat_Sqrt:  [[0.15]]
grads:  [0.06242563]
Stock Position:  0.06242562761869628
Bond Position:  [-1.14425557]


portfolio before change:  [5.02255466]
curr_Stock_Price:  98.7956827327159
curr_Factors:  [98.79568273]
mat_Sqrt:  [[0.15]]
grads:  [-0.10701495]
Stock Position:  -0.10701495343899414
Bond Position:  [15.59517004]


portfolio before change:  [5.04496851]
curr_Stock_Price:  98.65911942887894
curr_Factors:  [98.65911943]
mat_Sqrt:  [[0.15]]
grads:  [0.07962366]
Stock Position:  0.0796236638847795
Bond Position:  [-2.81063206]


portfolio before change:  [5.07732925]
curr_Stock_Price:  99.08319454090817
curr_Factors:  [99.08319454]
mat_Sqrt:  [[0.15]]
grads:  [-0.10303963]
Stock Position:  -0.10303962631191375
Bond Position:  [15.28682459]


portfolio before change:  [5.2768323]
curr_Stock_Price:  97.22121456143662
curr_Factors:  [97.22121456]
mat_Sqrt:  [[0.15]]
grads:  [0.02435682]
Stock Position:  0.024356823789057794
Bond Position:  [2.90883231]


portfolio before change:  [5.27918096]
curr_Stock_Price:  97.25791426362429
curr_Factors:  [97.25791426]
mat_Sqrt:  [[0.15]]
grads:  [-0.03973084]
Stock Position:  -0.03973083807022881
Bond Position:  [9.14331941]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.22336032]
Stock Price:  98.77797899559614
PL:  [5.22336032]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30395882e-02]
 [-1.36495020e-02]
 [ 1.60852244e-02]
 [ 4.77800872e-03]
 [ 8.85208448e-03]
 [ 8.00793109e-03]
 [-7.99878679e-03]
 [ 2.55059259e-03]
 [ 5.05116813e-05]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.30355206]
curr_Stock_Price:  99.12094688436386
curr_Factors:  [99.12094688]
mat_Sqrt:  [[0.15]]
grads:  [-0.08693059]
Stock Position:  -0.08693058824922353
Bond Position:  [-9.68690984]


portfolio before change:  [-18.30635292]
curr_Stock_Price:  99.09743609757237
curr_Factors:  [99.0974361]
mat_Sqrt:  [[0.15]]
grads:  [-0.09099668]
Stock Position:  -0.09099667995878222
Bond Position:  [-9.28881524]


portfolio before change:  [-18.45717316]
curr_Stock_Price:  100.70380972921731
curr_Factors:  [100.70380973]
mat_Sqrt:  [[0.15]]
grads:  [0.10723483]
Stock Position:  0.10723482927576258
Bond Position:  [-29.256129]


portfolio before change:  [-18.32048968]
curr_Stock_Price:  102.11487360201839
curr_Factors:  [102.1148736]
mat_Sqrt:  [[0.15]]
grads:  [0.03185339]
Stock Position:  0.03185339148715264
Bond Position:  [-21.57319473]


portfolio before change:  [-18.34339444]
curr_Stock_Price:  101.7345227484426
curr_Factors:  [101.73452275]
mat_Sqrt:  [[0.15]]
grads:  [0.0590139]
Stock Position:  0.05901389651964506
Bond Position:  [-24.34714504]


portfolio before change:  [-18.31636488]
curr_Stock_Price:  102.39887773715188
curr_Factors:  [102.39887774]
mat_Sqrt:  [[0.15]]
grads:  [0.05338621]
Stock Position:  0.053386207299238424
Bond Position:  [-23.7830526]


portfolio before change:  [-18.32608912]
curr_Stock_Price:  102.43952989317592
curr_Factors:  [102.43952989]
mat_Sqrt:  [[0.15]]
grads:  [-0.05332525]
Stock Position:  -0.05332524523748803
Bond Position:  [-12.86347607]


portfolio before change:  [-18.3194843]
curr_Stock_Price:  102.19502716888154
curr_Factors:  [102.19502717]
mat_Sqrt:  [[0.15]]
grads:  [0.01700395]
Stock Position:  0.017003950621641124
Bond Position:  [-20.05720349]


portfolio before change:  [-18.32782726]
curr_Stock_Price:  102.29430654318205
curr_Factors:  [102.29430654]
mat_Sqrt:  [[0.15]]
grads:  [0.00033674]
Stock Position:  0.00033674454186269354
Bond Position:  [-18.36227431]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.33680686]
Stock Price:  102.89961521652246
PL:  [-21.23642208]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.31821524e-02]
 [-1.47862642e-02]
 [ 2.04888482e-04]
 [ 1.11664368e-02]
 [-1.75114021e-02]
 [ 1.26267439e-02]
 [-1.40062187e-02]
 [-1.35252544e-05]
 [-2.38971705e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.07332632]
curr_Stock_Price:  99.85769439733991
curr_Factors:  [99.8576944]
mat_Sqrt:  [[0.15]]
grads:  [-0.08788102]
Stock Position:  -0.08788101630960907
Bond Position:  [6.70226935]


portfolio before change:  [-1.90504547]
curr_Stock_Price:  97.98096511370844
curr_Factors:  [97.98096511]
mat_Sqrt:  [[0.15]]
grads:  [-0.09857509]
Stock Position:  -0.09857509484160733
Bond Position:  [7.75343746]


portfolio before change:  [-1.97091473]
curr_Stock_Price:  98.68851650581281
curr_Factors:  [98.68851651]
mat_Sqrt:  [[0.15]]
grads:  [0.00136592]
Stock Position:  0.0013659232111033759
Bond Position:  [-2.10571566]


portfolio before change:  [-1.97087487]
curr_Stock_Price:  99.48868995122267
curr_Factors:  [99.48868995]
mat_Sqrt:  [[0.15]]
grads:  [0.07444291]
Stock Position:  0.07444291202902238
Bond Position:  [-9.37710267]


portfolio before change:  [-2.03603955]
curr_Stock_Price:  98.6763230582785
curr_Factors:  [98.67632306]
mat_Sqrt:  [[0.15]]
grads:  [-0.11674268]
Stock Position:  -0.1167426805397605
Bond Position:  [9.48369891]


portfolio before change:  [-1.9558785]
curr_Stock_Price:  98.0303037787924
curr_Factors:  [98.03030378]
mat_Sqrt:  [[0.15]]
grads:  [0.08417829]
Stock Position:  0.08417829246142872
Bond Position:  [-10.20790208]


portfolio before change:  [-2.18795292]
curr_Stock_Price:  95.33401243592704
curr_Factors:  [95.33401244]
mat_Sqrt:  [[0.15]]
grads:  [-0.09337479]
Stock Position:  -0.09337479135091818
Bond Position:  [6.7138406]


portfolio before change:  [-1.96650762]
curr_Stock_Price:  92.99839762010959
curr_Factors:  [92.99839762]
mat_Sqrt:  [[0.15]]
grads:  [-9.01683628e-05]
Stock Position:  -9.016836276349964e-05
Bond Position:  [-1.9581221]


portfolio before change:  [-1.96731436]
curr_Stock_Price:  91.08463601238338
curr_Factors:  [91.08463601]
mat_Sqrt:  [[0.15]]
grads:  [-0.15931447]
Stock Position:  -0.1593144702689103
Bond Position:  [12.54378617]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.15807655]
Stock Price:  92.32140786212001
PL:  [-2.15807655]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.51726532e-02]
 [-1.31241873e-02]
 [-8.62837422e-03]
 [ 6.60284267e-03]
 [-4.15687738e-02]
 [ 1.46669574e-02]
 [-1.50103641e-02]
 [ 2.26297834e-03]
 [-1.58471657e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [38.37155217]
curr_Stock_Price:  101.69363088494873
curr_Factors:  [101.69363088]
mat_Sqrt:  [[0.15]]
grads:  [-0.10115102]
Stock Position:  -0.10115102161880749
Bond Position:  [48.65796683]


portfolio before change:  [38.51144301]
curr_Stock_Price:  100.5512225358318
curr_Factors:  [100.55122254]
mat_Sqrt:  [[0.15]]
grads:  [-0.08749458]
Stock Position:  -0.08749458225958927
Bond Position:  [47.30913022]


portfolio before change:  [38.79204389]
curr_Stock_Price:  97.61457899274079
curr_Factors:  [97.61457899]
mat_Sqrt:  [[0.15]]
grads:  [-0.05752249]
Stock Position:  -0.057522494769750465
Bond Position:  [44.407078]


portfolio before change:  [38.95359031]
curr_Stock_Price:  95.19226871167741
curr_Factors:  [95.19226871]
mat_Sqrt:  [[0.15]]
grads:  [0.04401895]
Stock Position:  0.04401895112180702
Bond Position:  [34.76332649]


portfolio before change:  [38.94757988]
curr_Stock_Price:  94.66076041023513
curr_Factors:  [94.66076041]
mat_Sqrt:  [[0.15]]
grads:  [-0.27712516]
Stock Position:  -0.2771251586403903
Bond Position:  [65.18045813]


portfolio before change:  [38.92787442]
curr_Stock_Price:  94.84949766155762
curr_Factors:  [94.84949766]
mat_Sqrt:  [[0.15]]
grads:  [0.09777972]
Stock Position:  0.09777971583074993
Bond Position:  [29.65351749]


portfolio before change:  [38.84516665]
curr_Stock_Price:  93.85196722812087
curr_Factors:  [93.85196723]
mat_Sqrt:  [[0.15]]
grads:  [-0.10006909]
Stock Position:  -0.10006909397003728
Bond Position:  [48.23684797]


portfolio before change:  [38.70344411]
curr_Stock_Price:  95.50929199784481
curr_Factors:  [95.509292]
mat_Sqrt:  [[0.15]]
grads:  [0.01508652]
Stock Position:  0.015086522282073163
Bond Position:  [37.26254105]


portfolio before change:  [38.69942052]
curr_Stock_Price:  94.00732059499552
curr_Factors:  [94.00732059]
mat_Sqrt:  [[0.15]]
grads:  [-0.10564777]
Stock Position:  -0.10564777125407598
Bond Position:  [48.63108442]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [38.72273048]
Stock Price:  94.01689632701449
PL:  [38.72273048]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.32846260e-02]
 [-1.30885343e-02]
 [ 4.64307478e-03]
 [ 9.06528043e-03]
 [-1.01044867e-02]
 [ 1.34755188e-02]
 [-1.45887241e-02]
 [ 3.23913234e-03]
 [-7.03959541e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.82665192]
curr_Stock_Price:  100.03472824228683
curr_Factors:  [100.03472824]
mat_Sqrt:  [[0.15]]
grads:  [-0.08856417]
Stock Position:  -0.08856417318569278
Bond Position:  [10.68614492]


portfolio before change:  [1.78564189]
curr_Stock_Price:  100.55812766835656
curr_Factors:  [100.55812767]
mat_Sqrt:  [[0.15]]
grads:  [-0.0872569]
Stock Position:  -0.08725689565566366
Bond Position:  [10.56003194]


portfolio before change:  [1.86710108]
curr_Stock_Price:  99.68509810561669
curr_Factors:  [99.68509811]
mat_Sqrt:  [[0.15]]
grads:  [0.03095383]
Stock Position:  0.03095383183464022
Bond Position:  [-1.21853469]


portfolio before change:  [1.82246416]
curr_Stock_Price:  98.26273784403986
curr_Factors:  [98.26273784]
mat_Sqrt:  [[0.15]]
grads:  [0.0604352]
Stock Position:  0.06043520287614293
Bond Position:  [-4.11606434]


portfolio before change:  [1.86969482]
curr_Stock_Price:  99.0783090077939
curr_Factors:  [99.07830901]
mat_Sqrt:  [[0.15]]
grads:  [-0.06736324]
Stock Position:  -0.06736324453994676
Bond Position:  [8.54393118]


portfolio before change:  [2.05974024]
curr_Stock_Price:  96.32053826491646
curr_Factors:  [96.32053826]
mat_Sqrt:  [[0.15]]
grads:  [0.08983679]
Stock Position:  0.08983679194253978
Bond Position:  [-6.59338792]


portfolio before change:  [2.1688666]
curr_Stock_Price:  97.57196190278172
curr_Factors:  [97.5719619]
mat_Sqrt:  [[0.15]]
grads:  [-0.09725816]
Stock Position:  -0.09725816048348576
Bond Position:  [11.65853613]


portfolio before change:  [2.26662402]
curr_Stock_Price:  96.6267795784189
curr_Factors:  [96.62677958]
mat_Sqrt:  [[0.15]]
grads:  [0.02159422]
Stock Position:  0.021594215625223314
Bond Position:  [0.18004451]


portfolio before change:  [2.27299567]
curr_Stock_Price:  96.91767239520213
curr_Factors:  [96.9176724]
mat_Sqrt:  [[0.15]]
grads:  [-0.04693064]
Stock Position:  -0.04693063607977776
Bond Position:  [6.82140368]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.24929043]
Stock Price:  97.49547814965194
PL:  [2.24929043]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.33933628e-02]
 [-1.36112701e-02]
 [-2.18606727e-02]
 [ 7.97654761e-03]
 [ 2.31358938e-04]
 [ 1.25255335e-02]
 [-1.49197294e-02]
 [ 4.40765149e-03]
 [-2.21755327e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-42.88387223]
curr_Stock_Price:  98.00515896874458
curr_Factors:  [98.00515897]
mat_Sqrt:  [[0.15]]
grads:  [-0.08928909]
Stock Position:  -0.08928908502764124
Bond Position:  [-34.13308125]


portfolio before change:  [-43.00146124]
curr_Stock_Price:  99.1309203855514
curr_Factors:  [99.13092039]
mat_Sqrt:  [[0.15]]
grads:  [-0.0907418]
Stock Position:  -0.09074180061799125
Bond Position:  [-34.00614303]


portfolio before change:  [-42.7348906]
curr_Stock_Price:  96.00581197112835
curr_Factors:  [96.00581197]
mat_Sqrt:  [[0.15]]
grads:  [-0.14573782]
Stock Position:  -0.14573781796069277
Bond Position:  [-28.74321305]


portfolio before change:  [-42.99047395]
curr_Stock_Price:  97.66089470676191
curr_Factors:  [97.66089471]
mat_Sqrt:  [[0.15]]
grads:  [0.05317698]
Stock Position:  0.05317698405490165
Bond Position:  [-48.18378579]


portfolio before change:  [-42.92273564]
curr_Stock_Price:  99.3878866912157
curr_Factors:  [99.38788669]
mat_Sqrt:  [[0.15]]
grads:  [0.00154239]
Stock Position:  0.0015423929221780829
Bond Position:  [-43.07603081]


portfolio before change:  [-42.94411996]
curr_Stock_Price:  99.49102558654903
curr_Factors:  [99.49102559]
mat_Sqrt:  [[0.15]]
grads:  [0.08350356]
Stock Position:  0.083503556818149
Bond Position:  [-51.25197447]


portfolio before change:  [-43.09996948]
curr_Stock_Price:  97.93160539973276
curr_Factors:  [97.9316054]
mat_Sqrt:  [[0.15]]
grads:  [-0.09946486]
Stock Position:  -0.09946486247389931
Bond Position:  [-33.35921582]


portfolio before change:  [-43.18036067]
curr_Stock_Price:  98.57210699126475
curr_Factors:  [98.57210699]
mat_Sqrt:  [[0.15]]
grads:  [0.02938434]
Stock Position:  0.029384343260486716
Bond Position:  [-46.07683729]


portfolio before change:  [-43.20760464]
curr_Stock_Price:  98.4291807104904
curr_Factors:  [98.42918071]
mat_Sqrt:  [[0.15]]
grads:  [-0.01478369]
Stock Position:  -0.014783688462898573
Bond Position:  [-41.7524583]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-43.19968719]
Stock Price:  96.4811622381759
PL:  [-43.19968719]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.29992865e-02]
 [-1.35594248e-02]
 [ 1.10653139e-02]
 [ 1.15200471e-02]
 [-1.44133271e-02]
 [ 1.18125041e-02]
 [-1.53339836e-02]
 [ 3.16198787e-03]
 [-1.10270615e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-27.76121214]
curr_Stock_Price:  98.69163014819048
curr_Factors:  [98.69163015]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-19.20840697]


portfolio before change:  [-27.81282355]
curr_Stock_Price:  99.17632757224105
curr_Factors:  [99.17632757]
mat_Sqrt:  [[0.15]]
grads:  [-0.09039617]
Stock Position:  -0.09039616526155493
Bond Position:  [-18.84766385]


portfolio before change:  [-27.92597581]
curr_Stock_Price:  100.32378856935073
curr_Factors:  [100.32378857]
mat_Sqrt:  [[0.15]]
grads:  [0.07376876]
Stock Position:  0.0737687594611002
Bond Position:  [-35.32673724]


portfolio before change:  [-27.98942681]
curr_Stock_Price:  99.70315711390427
curr_Factors:  [99.70315711]
mat_Sqrt:  [[0.15]]
grads:  [0.07680031]
Stock Position:  0.07680031403598775
Bond Position:  [-35.64666059]


portfolio before change:  [-28.06665277]
curr_Stock_Price:  98.92974657687138
curr_Factors:  [98.92974658]
mat_Sqrt:  [[0.15]]
grads:  [-0.09608885]
Stock Position:  -0.0960888471458
Bond Position:  [-18.56060747]


portfolio before change:  [-28.06796818]
curr_Stock_Price:  98.84683149973382
curr_Factors:  [98.8468315]
mat_Sqrt:  [[0.15]]
grads:  [0.07875003]
Stock Position:  0.07875002709816697
Bond Position:  [-35.85215884]


portfolio before change:  [-28.08638879]
curr_Stock_Price:  98.8406086341656
curr_Factors:  [98.84060863]
mat_Sqrt:  [[0.15]]
grads:  [-0.10222656]
Stock Position:  -0.10222655752368136
Bond Position:  [-17.98225363]


portfolio before change:  [-27.85775745]
curr_Stock_Price:  96.51611755151669
curr_Factors:  [96.51611755]
mat_Sqrt:  [[0.15]]
grads:  [0.02107992]
Stock Position:  0.021079919145910227
Bond Position:  [-29.8923094]


portfolio before change:  [-27.89060854]
curr_Stock_Price:  95.66691117527117
curr_Factors:  [95.66691118]
mat_Sqrt:  [[0.15]]
grads:  [-0.07351374]
Stock Position:  -0.07351374321249371
Bond Position:  [-20.8577758]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-27.94991889]
Stock Price:  96.33180530130369
PL:  [-27.94991889]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.29992865e-02]
 [-1.46431740e-02]
 [-8.12312185e-03]
 [ 6.72532935e-03]
 [-4.00738182e-02]
 [ 1.33123392e-02]
 [-1.40833917e-02]
 [ 1.51231222e-03]
 [-7.13009798e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.4197651]
curr_Stock_Price:  99.5696070311651
curr_Factors:  [99.56960703]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [0.20912723]


portfolio before change:  [-8.23283951]
curr_Stock_Price:  97.41386177934429
curr_Factors:  [97.41386178]
mat_Sqrt:  [[0.15]]
grads:  [-0.09762116]
Stock Position:  -0.09762116000532148
Bond Position:  [1.27681468]


portfolio before change:  [-8.25779186]
curr_Stock_Price:  97.67600697062102
curr_Factors:  [97.67600697]
mat_Sqrt:  [[0.15]]
grads:  [-0.05415415]
Stock Position:  -0.05415414568696063
Bond Position:  [-2.96823115]


portfolio before change:  [-8.24181373]
curr_Stock_Price:  97.35354563743445
curr_Factors:  [97.35354564]
mat_Sqrt:  [[0.15]]
grads:  [0.04483553]
Stock Position:  0.044835529026536376
Bond Position:  [-12.60671145]


portfolio before change:  [-8.35248052]
curr_Stock_Price:  95.02588584782212
curr_Factors:  [95.02588585]
mat_Sqrt:  [[0.15]]
grads:  [-0.26715879]
Stock Position:  -0.26715878807024024
Bond Position:  [17.03451998]


portfolio before change:  [-8.7400342]
curr_Stock_Price:  96.50842391818934
curr_Factors:  [96.50842392]
mat_Sqrt:  [[0.15]]
grads:  [0.08874893]
Stock Position:  0.08874892803219651
Bond Position:  [-17.30505337]


portfolio before change:  [-8.86913415]
curr_Stock_Price:  95.15127787620763
curr_Factors:  [95.15127788]
mat_Sqrt:  [[0.15]]
grads:  [-0.09388928]
Stock Position:  -0.09388927824573899
Bond Position:  [0.06455066]


portfolio before change:  [-8.82497942]
curr_Stock_Price:  94.68133663988588
curr_Factors:  [94.68133664]
mat_Sqrt:  [[0.15]]
grads:  [0.01008208]
Stock Position:  0.010082081455369969
Bond Position:  [-9.77956437]


portfolio before change:  [-8.80761097]
curr_Stock_Price:  96.8891597789179
curr_Factors:  [96.88915978]
mat_Sqrt:  [[0.15]]
grads:  [-0.04753399]
Stock Position:  -0.047533986510817444
Bond Position:  [-4.20208296]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.95693501]
Stock Price:  99.98636423362979
PL:  [-8.95693501]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.36973366e-02]
 [-1.40857246e-02]
 [-3.72097907e-03]
 [ 9.16476277e-03]
 [-3.45357457e-02]
 [ 1.38622649e-02]
 [-1.38541909e-02]
 [ 2.42374140e-03]
 [-1.50668901e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.34018447]
curr_Stock_Price:  100.64815541533969
curr_Factors:  [100.64815542]
mat_Sqrt:  [[0.15]]
grads:  [-0.09131558]
Stock Position:  -0.09131557723896061
Bond Position:  [24.53092888]


portfolio before change:  [15.52894519]
curr_Stock_Price:  98.71538337162852
curr_Factors:  [98.71538337]
mat_Sqrt:  [[0.15]]
grads:  [-0.09390483]
Stock Position:  -0.09390483040226885
Bond Position:  [24.79879653]


portfolio before change:  [15.58869161]
curr_Stock_Price:  98.21121422409006
curr_Factors:  [98.21121422]
mat_Sqrt:  [[0.15]]
grads:  [-0.02480653]
Stock Position:  -0.024806527166295635
Bond Position:  [18.02497076]


portfolio before change:  [15.59442135]
curr_Stock_Price:  98.34363883243928
curr_Factors:  [98.34363883]
mat_Sqrt:  [[0.15]]
grads:  [0.06109842]
Stock Position:  0.06109841846160931
Bond Position:  [9.58578055]


portfolio before change:  [15.47914828]
curr_Stock_Price:  96.37849535798597
curr_Factors:  [96.37849536]
mat_Sqrt:  [[0.15]]
grads:  [-0.2302383]
Stock Position:  -0.23023830478621693
Bond Position:  [37.66916967]


portfolio before change:  [15.61385688]
curr_Stock_Price:  95.87523719409162
curr_Factors:  [95.87523719]
mat_Sqrt:  [[0.15]]
grads:  [0.0924151]
Stock Position:  0.0924150993106073
Bond Position:  [6.75353732]


portfolio before change:  [15.60486366]
curr_Stock_Price:  95.74137559803657
curr_Factors:  [95.7413756]
mat_Sqrt:  [[0.15]]
grads:  [-0.09236127]
Stock Position:  -0.09236127294973139
Bond Position:  [24.44765899]


portfolio before change:  [15.62214901]
curr_Stock_Price:  95.6866073593216
curr_Factors:  [95.68660736]
mat_Sqrt:  [[0.15]]
grads:  [0.01615828]
Stock Position:  0.016158276001215176
Bond Position:  [14.0760184]


portfolio before change:  [15.60663191]
curr_Stock_Price:  94.29061228021978
curr_Factors:  [94.29061228]
mat_Sqrt:  [[0.15]]
grads:  [-0.10044593]
Stock Position:  -0.10044593397926903
Bond Position:  [25.07774053]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.63754827]
Stock Price:  94.10768442432581
PL:  [15.63754827]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.31890292e-02]
 [-1.28649014e-02]
 [-6.61313927e-03]
 [ 5.83943004e-03]
 [-3.72339891e-02]
 [ 1.36659851e-02]
 [-1.40434987e-02]
 [ 2.19005160e-03]
 [-1.16723393e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.71278415]
curr_Stock_Price:  99.87406068502234
curr_Factors:  [99.87406069]
mat_Sqrt:  [[0.15]]
grads:  [-0.08792686]
Stock Position:  -0.087926861064481
Bond Position:  [7.0688285]


portfolio before change:  [-1.68996014]
curr_Stock_Price:  99.65468840381878
curr_Factors:  [99.6546884]
mat_Sqrt:  [[0.15]]
grads:  [-0.08576601]
Stock Position:  -0.08576600942806901
Bond Position:  [6.85702481]


portfolio before change:  [-1.53257224]
curr_Stock_Price:  97.85958884635112
curr_Factors:  [97.85958885]
mat_Sqrt:  [[0.15]]
grads:  [-0.0440876]
Stock Position:  -0.044087595165991485
Bond Position:  [2.78182169]


portfolio before change:  [-1.48955699]
curr_Stock_Price:  96.91546844688182
curr_Factors:  [96.91546845]
mat_Sqrt:  [[0.15]]
grads:  [0.03892953]
Stock Position:  0.03892953357165128
Bond Position:  [-5.26243097]


portfolio before change:  [-1.5387481]
curr_Stock_Price:  95.71948092652491
curr_Factors:  [95.71948093]
mat_Sqrt:  [[0.15]]
grads:  [-0.24822659]
Stock Position:  -0.24822659417636095
Bond Position:  [22.22137265]


portfolio before change:  [-1.62239603]
curr_Stock_Price:  96.10123454857282
curr_Factors:  [96.10123455]
mat_Sqrt:  [[0.15]]
grads:  [0.09110657]
Stock Position:  0.0911065674376807
Bond Position:  [-10.37784964]


portfolio before change:  [-1.70552753]
curr_Stock_Price:  95.24573888561486
curr_Factors:  [95.24573889]
mat_Sqrt:  [[0.15]]
grads:  [-0.09362332]
Stock Position:  -0.09362332444101706
Bond Position:  [7.21169518]


portfolio before change:  [-1.71906487]
curr_Stock_Price:  95.42885665836968
curr_Factors:  [95.42885666]
mat_Sqrt:  [[0.15]]
grads:  [0.01460034]
Stock Position:  0.014600344020274858
Bond Position:  [-3.11235901]


portfolio before change:  [-1.72009684]
curr_Stock_Price:  95.46478721899486
curr_Factors:  [95.46478722]
mat_Sqrt:  [[0.15]]
grads:  [-0.0778156]
Stock Position:  -0.07781559506593735
Bond Position:  [5.70855238]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.52605291]
Stock Price:  93.00783828649222
PL:  [-1.52605291]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.34325129e-02]
 [-1.28434797e-02]
 [-6.81222718e-03]
 [ 6.04147546e-03]
 [-4.58545793e-02]
 [ 1.53094244e-02]
 [-1.56604907e-02]
 [-5.47053905e-04]
 [-2.31416332e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.56414768]
curr_Stock_Price:  100.29517352513683
curr_Factors:  [100.29517353]
mat_Sqrt:  [[0.15]]
grads:  [-0.08955009]
Stock Position:  -0.08955008587906736
Bond Position:  [16.54558908]


portfolio before change:  [7.62303821]
curr_Stock_Price:  99.72995169031226
curr_Factors:  [99.72995169]
mat_Sqrt:  [[0.15]]
grads:  [-0.0856232]
Stock Position:  -0.08562319798401531
Bond Position:  [16.16223561]


portfolio before change:  [7.79334029]
curr_Stock_Price:  97.83538397715802
curr_Factors:  [97.83538398]
mat_Sqrt:  [[0.15]]
grads:  [-0.04541485]
Stock Position:  -0.0454148478570144
Bond Position:  [12.23651937]


portfolio before change:  [7.86194996]
curr_Stock_Price:  96.45940497169082
curr_Factors:  [96.45940497]
mat_Sqrt:  [[0.15]]
grads:  [0.0402765]
Stock Position:  0.04027650305359987
Bond Position:  [3.97690244]


portfolio before change:  [7.74933605]
curr_Stock_Price:  93.61400248135111
curr_Factors:  [93.61400248]
mat_Sqrt:  [[0.15]]
grads:  [-0.3056972]
Stock Position:  -0.305697195377808
Bond Position:  [36.36687405]


portfolio before change:  [7.67393663]
curr_Stock_Price:  93.92014660543008
curr_Factors:  [93.92014661]
mat_Sqrt:  [[0.15]]
grads:  [0.10206283]
Stock Position:  0.10206282933070873
Bond Position:  [-1.91181926]


portfolio before change:  [7.59006972]
curr_Stock_Price:  93.10779642847935
curr_Factors:  [93.10779643]
mat_Sqrt:  [[0.15]]
grads:  [-0.10440327]
Stock Position:  -0.10440327121471034
Bond Position:  [17.31082825]


portfolio before change:  [7.67158617]
curr_Stock_Price:  92.40993639807326
curr_Factors:  [92.4099364]
mat_Sqrt:  [[0.15]]
grads:  [-0.00364703]
Stock Position:  -0.0036470260316963724
Bond Position:  [8.00860762]


portfolio before change:  [7.67942447]
curr_Stock_Price:  91.35894609067735
curr_Factors:  [91.35894609]
mat_Sqrt:  [[0.15]]
grads:  [-0.15427755]
Stock Position:  -0.15427755438133245
Bond Position:  [21.77405924]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.78266533]
Stock Price:  90.76034240591896
PL:  [7.78266533]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30395744e-02]
 [-1.19440516e-02]
 [-3.15342379e-02]
 [ 4.88380698e-03]
 [ 1.36659175e-02]
 [ 1.17991430e-02]
 [-5.93919153e-03]
 [ 2.86997858e-04]
 [ 1.09918719e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.30148605]
curr_Stock_Price:  99.12104066798967
curr_Factors:  [99.12104067]
mat_Sqrt:  [[0.15]]
grads:  [-0.0869305]
Stock Position:  -0.08693049569671435
Bond Position:  [-9.68484485]


portfolio before change:  [-18.45052529]
curr_Stock_Price:  100.77978663058781
curr_Factors:  [100.77978663]
mat_Sqrt:  [[0.15]]
grads:  [-0.07962701]
Stock Position:  -0.07962701081659035
Bond Position:  [-10.42573213]


portfolio before change:  [-18.71579188]
curr_Stock_Price:  104.0456686196785
curr_Factors:  [104.04566862]
mat_Sqrt:  [[0.15]]
grads:  [-0.21022825]
Stock Position:  -0.21022825245959795
Bond Position:  [3.15754721]


portfolio before change:  [-18.47982634]
curr_Stock_Price:  102.93075486087884
curr_Factors:  [102.93075486]
mat_Sqrt:  [[0.15]]
grads:  [0.03255871]
Stock Position:  0.03255871321331635
Bond Position:  [-21.83111927]


portfolio before change:  [-18.49124088]
curr_Stock_Price:  102.91551316603649
curr_Factors:  [102.91551317]
mat_Sqrt:  [[0.15]]
grads:  [0.09110612]
Stock Position:  0.09110611637770506
Bond Position:  [-27.8674736]


portfolio before change:  [-18.69489755]
curr_Stock_Price:  100.83311235037093
curr_Factors:  [100.83311235]
mat_Sqrt:  [[0.15]]
grads:  [0.07866095]
Stock Position:  0.07866095350546665
Bond Position:  [-26.62652631]


portfolio before change:  [-18.43121733]
curr_Stock_Price:  104.35451404338573
curr_Factors:  [104.35451404]
mat_Sqrt:  [[0.15]]
grads:  [-0.03959461]
Stock Position:  -0.03959461022545014
Bond Position:  [-14.29934102]


portfolio before change:  [-18.44133792]
curr_Stock_Price:  104.42950226868794
curr_Factors:  [104.42950227]
mat_Sqrt:  [[0.15]]
grads:  [0.00191332]
Stock Position:  0.0019133190536870077
Bond Position:  [-18.64114487]


portfolio before change:  [-18.45198039]
curr_Stock_Price:  103.739824080739
curr_Factors:  [103.73982408]
mat_Sqrt:  [[0.15]]
grads:  [0.00732791]
Stock Position:  0.007327914587797392
Bond Position:  [-19.21217696]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.45650676]
Stock Price:  104.43335374807921
PL:  [-22.88986051]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.49005408e-02]
 [-1.36838611e-02]
 [ 5.28188479e-04]
 [ 7.50869177e-03]
 [-2.67383487e-02]
 [ 1.32550119e-02]
 [-1.48524862e-02]
 [ 3.36372289e-03]
 [-1.07708456e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [34.12691157]
curr_Stock_Price:  101.50095159271186
curr_Factors:  [101.50095159]
mat_Sqrt:  [[0.15]]
grads:  [-0.09933694]
Stock Position:  -0.09933693863060404
Bond Position:  [44.20970537]


portfolio before change:  [34.3907691]
curr_Stock_Price:  99.06734372221511
curr_Factors:  [99.06734372]
mat_Sqrt:  [[0.15]]
grads:  [-0.09122574]
Stock Position:  -0.09122574037059995
Bond Position:  [43.42826088]


portfolio before change:  [34.4434617]
curr_Stock_Price:  98.72782293274044
curr_Factors:  [98.72782293]
mat_Sqrt:  [[0.15]]
grads:  [0.00352126]
Stock Position:  0.003521256524329312
Bond Position:  [34.09581571]


portfolio before change:  [34.45635431]
curr_Stock_Price:  97.54655127171611
curr_Factors:  [97.54655127]
mat_Sqrt:  [[0.15]]
grads:  [0.05005795]
Stock Position:  0.05005794510160805
Bond Position:  [29.5733744]


portfolio before change:  [34.4875786]
curr_Stock_Price:  97.87484901217651
curr_Factors:  [97.87484901]
mat_Sqrt:  [[0.15]]
grads:  [-0.17825566]
Stock Position:  -0.1782556577901784
Bond Position:  [51.9343242]


portfolio before change:  [34.71824436]
curr_Stock_Price:  96.72654270750967
curr_Factors:  [96.72654271]
mat_Sqrt:  [[0.15]]
grads:  [0.08836675]
Stock Position:  0.08836674605723953
Bond Position:  [26.17083452]


portfolio before change:  [34.83136436]
curr_Stock_Price:  97.85854445262498
curr_Factors:  [97.85854445]
mat_Sqrt:  [[0.15]]
grads:  [-0.09901657]
Stock Position:  -0.09901657482579487
Bond Position:  [44.52098224]


portfolio before change:  [34.95789907]
curr_Stock_Price:  96.80550194541689
curr_Factors:  [96.80550195]
mat_Sqrt:  [[0.15]]
grads:  [0.02242482]
Stock Position:  0.022424819281189064
Bond Position:  [32.78705319]


portfolio before change:  [34.95056373]
curr_Stock_Price:  95.74716710141776
curr_Factors:  [95.7471671]
mat_Sqrt:  [[0.15]]
grads:  [-0.07180564]
Stock Position:  -0.07180563739958574
Bond Position:  [41.8257501]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [34.94234647]
Stock Price:  96.15292024716545
PL:  [34.94234647]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 3.30443445]
 [-0.01299929]
 [-0.01331516]
 [ 0.0100816 ]
 [ 0.01031086]
 [ 0.00826981]
 [ 0.00561742]
 [-0.01272653]
 [ 0.00356475]
 [-0.00554112]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-24.04107687]
curr_Stock_Price:  98.8605002830418
curr_Factors:  [98.86050028]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666191]
Stock Position:  -0.08666190999558891
Bond Position:  [-15.47363709]


portfolio before change:  [-24.15142384]
curr_Stock_Price:  100.04450620596614
curr_Factors:  [100.04450621]
mat_Sqrt:  [[0.15]]
grads:  [-0.08876773]
Stock Position:  -0.08876772869008348
Bond Position:  [-15.27070025]


portfolio before change:  [-24.17725459]
curr_Stock_Price:  100.24946243641317
curr_Factors:  [100.24946244]
mat_Sqrt:  [[0.15]]
grads:  [0.06721068]
Stock Position:  0.06721068058075017
Bond Position:  [-30.91508919]


portfolio before change:  [-24.17496174]
curr_Stock_Price:  100.51362077878427
curr_Factors:  [100.51362078]
mat_Sqrt:  [[0.15]]
grads:  [0.06873904]
Stock Position:  0.06873903661292735
Bond Position:  [-31.0841712]


portfolio before change:  [-24.09072086]
curr_Stock_Price:  101.9652974821165
curr_Factors:  [101.96529748]
mat_Sqrt:  [[0.15]]
grads:  [0.05513205]
Stock Position:  0.055132050010352554
Bond Position:  [-29.71227674]


portfolio before change:  [-24.03529146]
curr_Stock_Price:  103.24022285125818
curr_Factors:  [103.24022285]
mat_Sqrt:  [[0.15]]
grads:  [0.03744945]
Stock Position:  0.03744945478839484
Bond Position:  [-27.90158152]


portfolio before change:  [-24.14591761]
curr_Stock_Price:  100.65882681952904
curr_Factors:  [100.65882682]
mat_Sqrt:  [[0.15]]
grads:  [-0.08484355]
Stock Position:  -0.08484355210755576
Bond Position:  [-15.60566519]


portfolio before change:  [-23.85125881]
curr_Stock_Price:  97.09387012564616
curr_Factors:  [97.09387013]
mat_Sqrt:  [[0.15]]
grads:  [0.023765]
Stock Position:  0.023764996612017066
Bond Position:  [-26.1586943]


portfolio before change:  [-23.85730954]
curr_Stock_Price:  97.3897626240663
curr_Factors:  [97.38976262]
mat_Sqrt:  [[0.15]]
grads:  [-0.03694082]
Stock Position:  -0.03694081823088661
Bond Position:  [-20.25965202]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-23.95605983]
Stock Price:  99.78867883608213
PL:  [-23.95605983]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30542955e-02]
 [-1.31177568e-02]
 [ 1.56250312e-02]
 [ 9.82422221e-03]
 [ 1.47608942e-02]
 [ 1.33382036e-02]
 [-1.16677487e-02]
 [ 4.00080703e-03]
 [-5.24976076e-05]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.70346487]
curr_Stock_Price:  99.69290953292777
curr_Factors:  [99.69290953]
mat_Sqrt:  [[0.15]]
grads:  [-0.08702864]
Stock Position:  -0.08702863696402716
Bond Position:  [2.97267316]


portfolio before change:  [-5.68545547]
curr_Stock_Price:  99.50305603841291
curr_Factors:  [99.50305604]
mat_Sqrt:  [[0.15]]
grads:  [-0.08745171]
Stock Position:  -0.08745171173904732
Bond Position:  [3.0162571]


portfolio before change:  [-5.93502853]
curr_Stock_Price:  102.37414409696004
curr_Factors:  [102.3741441]
mat_Sqrt:  [[0.15]]
grads:  [0.10416687]
Stock Position:  0.10416687463564533
Bond Position:  [-16.59902316]


portfolio before change:  [-6.12799092]
curr_Stock_Price:  100.60140387848861
curr_Factors:  [100.60140388]
mat_Sqrt:  [[0.15]]
grads:  [0.06549481]
Stock Position:  0.0654948147442445
Bond Position:  [-12.71686123]


portfolio before change:  [-6.14664626]
curr_Stock_Price:  100.41367429154413
curr_Factors:  [100.41367429]
mat_Sqrt:  [[0.15]]
grads:  [0.09840596]
Stock Position:  0.09840596160491519
Bond Position:  [-16.02795044]


portfolio before change:  [-6.16975142]
curr_Stock_Price:  100.26033823003235
curr_Factors:  [100.26033823]
mat_Sqrt:  [[0.15]]
grads:  [0.08892136]
Stock Position:  0.08892135757762952
Bond Position:  [-15.08503681]


portfolio before change:  [-6.10551757]
curr_Stock_Price:  101.06754868756
curr_Factors:  [101.06754869]
mat_Sqrt:  [[0.15]]
grads:  [-0.07778499]
Stock Position:  -0.0777849913833468
Bond Position:  [1.75602083]


portfolio before change:  [-6.07263727]
curr_Stock_Price:  100.65613153510776
curr_Factors:  [100.65613154]
mat_Sqrt:  [[0.15]]
grads:  [0.02667205]
Stock Position:  0.02667204687613139
Bond Position:  [-8.75734232]


portfolio before change:  [-6.03958682]
curr_Stock_Price:  102.05948138275613
curr_Factors:  [102.05948138]
mat_Sqrt:  [[0.15]]
grads:  [-0.00034998]
Stock Position:  -0.0003499840503993756
Bond Position:  [-6.00386763]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.04211448]
Stock Price:  100.7022029827196
PL:  [-6.74431746]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.34604584e-02]
 [-1.34663772e-02]
 [-1.15878657e-02]
 [ 8.83306375e-03]
 [-3.06247777e-02]
 [ 1.26031766e-02]
 [-1.40806581e-02]
 [ 4.32442876e-03]
 [ 2.73503373e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.43228188]
curr_Stock_Price:  100.33458121550058
curr_Factors:  [100.33458122]
mat_Sqrt:  [[0.15]]
grads:  [-0.08973639]
Stock Position:  -0.08973638908756575
Bond Position:  [17.4359449]


portfolio before change:  [8.53804988]
curr_Stock_Price:  99.25310411874958
curr_Factors:  [99.25310412]
mat_Sqrt:  [[0.15]]
grads:  [-0.08977585]
Stock Position:  -0.08977584824158334
Bond Position:  [17.44858149]


portfolio before change:  [8.72617871]
curr_Stock_Price:  97.25476755248462
curr_Factors:  [97.25476755]
mat_Sqrt:  [[0.15]]
grads:  [-0.07725244]
Stock Position:  -0.07725243830015867
Bond Position:  [16.23934664]


portfolio before change:  [8.67102085]
curr_Stock_Price:  98.07389468220396
curr_Factors:  [98.07389468]
mat_Sqrt:  [[0.15]]
grads:  [0.05888709]
Stock Position:  0.05888709165258144
Bond Position:  [2.89573442]


portfolio before change:  [8.62556979]
curr_Stock_Price:  97.27746744523563
curr_Factors:  [97.27746745]
mat_Sqrt:  [[0.15]]
grads:  [-0.20416518]
Stock Position:  -0.20416518481136553
Bond Position:  [28.48624191]


portfolio before change:  [8.18075234]
curr_Stock_Price:  99.52596117282967
curr_Factors:  [99.52596117]
mat_Sqrt:  [[0.15]]
grads:  [0.08402118]
Stock Position:  0.0840211772419177
Bond Position:  [-0.18153608]


portfolio before change:  [8.23953778]
curr_Stock_Price:  100.22669200292621
curr_Factors:  [100.226692]
mat_Sqrt:  [[0.15]]
grads:  [-0.09387105]
Stock Position:  -0.09387105383696279
Bond Position:  [17.64792298]


portfolio before change:  [8.24617966]
curr_Stock_Price:  100.24996095848047
curr_Factors:  [100.24996096]
mat_Sqrt:  [[0.15]]
grads:  [0.02882953]
Stock Position:  0.02882952503567985
Bond Position:  [5.35602091]


portfolio before change:  [8.23326883]
curr_Stock_Price:  99.70921259430551
curr_Factors:  [99.70921259]
mat_Sqrt:  [[0.15]]
grads:  [0.00182336]
Stock Position:  0.0018233558230907616
Bond Position:  [8.05146345]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.24332702]
Stock Price:  103.01709847295001
PL:  [5.22622854]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30291518e-02]
 [-1.43313326e-02]
 [ 2.08538986e-02]
 [ 1.10619572e-02]
 [ 8.51147087e-03]
 [ 1.35883587e-02]
 [-1.07660797e-02]
 [ 3.66962569e-03]
 [-4.67643236e-05]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.69248193]
curr_Stock_Price:  99.05789843108761
curr_Factors:  [99.05789843]
mat_Sqrt:  [[0.15]]
grads:  [-0.08686101]
Stock Position:  -0.08686101177647577
Bond Position:  [-11.08821265]


portfolio before change:  [-19.64959167]
curr_Stock_Price:  98.50027476315714
curr_Factors:  [98.50027476]
mat_Sqrt:  [[0.15]]
grads:  [-0.09554222]
Stock Position:  -0.09554221747647007
Bond Position:  [-10.238657]


portfolio before change:  [-19.90142202]
curr_Stock_Price:  101.08248137827523
curr_Factors:  [101.08248138]
mat_Sqrt:  [[0.15]]
grads:  [0.13902599]
Stock Position:  0.1390259907592296
Bond Position:  [-33.95451415]


portfolio before change:  [-20.1480223]
curr_Stock_Price:  99.43085655644609
curr_Factors:  [99.43085656]
mat_Sqrt:  [[0.15]]
grads:  [0.07374638]
Stock Position:  0.07374638150027431
Bond Position:  [-27.48068818]


portfolio before change:  [-19.98317545]
curr_Stock_Price:  101.8525432397122
curr_Factors:  [101.85254324]
mat_Sqrt:  [[0.15]]
grads:  [0.05674314]
Stock Position:  0.05674313916105292
Bond Position:  [-25.76260849]


portfolio before change:  [-20.09657573]
curr_Stock_Price:  100.08112638187325
curr_Factors:  [100.08112638]
mat_Sqrt:  [[0.15]]
grads:  [0.09058906]
Stock Position:  0.09058905798576677
Bond Position:  [-29.16283069]


portfolio before change:  [-19.98390003]
curr_Stock_Price:  101.48594021689132
curr_Factors:  [101.48594022]
mat_Sqrt:  [[0.15]]
grads:  [-0.07177386]
Stock Position:  -0.07177386486723002
Bond Position:  [-12.69986187]


portfolio before change:  [-19.96373383]
curr_Stock_Price:  101.11647823152389
curr_Factors:  [101.11647823]
mat_Sqrt:  [[0.15]]
grads:  [0.02446417]
Stock Position:  0.024464171252551094
Bond Position:  [-22.43746467]


portfolio before change:  [-19.95048525]
curr_Stock_Price:  102.11672130849054
curr_Factors:  [102.11672131]
mat_Sqrt:  [[0.15]]
grads:  [-0.00031176]
Stock Position:  -0.0003117621571991902
Bond Position:  [-19.91864913]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.96110061]
Stock Price:  104.21298791222014
PL:  [-24.17408852]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.56034772e-02]
 [-7.70362137e-03]
 [ 1.64591000e-02]
 [ 1.20171353e-02]
 [ 1.31036389e-02]
 [ 1.29228982e-02]
 [-1.04240699e-02]
 [ 2.47812813e-03]
 [ 3.16987439e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [45.18794612]
curr_Stock_Price:  102.00305118318008
curr_Factors:  [102.00305118]
mat_Sqrt:  [[0.15]]
grads:  [-0.10402318]
Stock Position:  -0.10402318153590967
Bond Position:  [55.79862803]


portfolio before change:  [45.19949827]
curr_Stock_Price:  102.1602674733851
curr_Factors:  [102.16026747]
mat_Sqrt:  [[0.15]]
grads:  [-0.05135748]
Stock Position:  -0.05135747582941041
Bond Position:  [50.44619174]


portfolio before change:  [45.29787794]
curr_Stock_Price:  100.73593227865811
curr_Factors:  [100.73593228]
mat_Sqrt:  [[0.15]]
grads:  [0.10972733]
Stock Position:  0.10972733302967044
Bond Position:  [34.24439275]


portfolio before change:  [45.2370331]
curr_Stock_Price:  100.02534077692448
curr_Factors:  [100.02534078]
mat_Sqrt:  [[0.15]]
grads:  [0.08011424]
Stock Position:  0.08011423533020266
Bond Position:  [37.22357941]


portfolio before change:  [45.30901608]
curr_Stock_Price:  100.69147123236445
curr_Factors:  [100.69147123]
mat_Sqrt:  [[0.15]]
grads:  [0.08735759]
Stock Position:  0.08735759236278777
Bond Position:  [36.51285158]


portfolio before change:  [45.23863873]
curr_Stock_Price:  99.67681028806001
curr_Factors:  [99.67681029]
mat_Sqrt:  [[0.15]]
grads:  [0.08615265]
Stock Position:  0.08615265441904815
Bond Position:  [36.65121694]


portfolio before change:  [45.42249745]
curr_Stock_Price:  101.59815007703376
curr_Factors:  [101.59815008]
mat_Sqrt:  [[0.15]]
grads:  [-0.0694938]
Stock Position:  -0.06949379927531596
Bond Position:  [52.48293889]


portfolio before change:  [45.40309336]
curr_Stock_Price:  102.25507375946555
curr_Factors:  [102.25507376]
mat_Sqrt:  [[0.15]]
grads:  [0.01652085]
Stock Position:  0.016520854186408983
Bond Position:  [43.71375219]


portfolio before change:  [45.40024404]
curr_Stock_Price:  100.75928834946691
curr_Factors:  [100.75928835]
mat_Sqrt:  [[0.15]]
grads:  [0.00211325]
Stock Position:  0.0021132495918261543
Bond Position:  [45.18731452]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [45.41917202]
Stock Price:  99.02199531198777
PL:  [45.41917202]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.30075246e-02]
 [-1.32603181e-02]
 [-1.25059293e-03]
 [ 8.76040707e-03]
 [-3.02496632e-02]
 [ 1.32893518e-02]
 [-1.48440467e-02]
 [ 3.69265916e-03]
 [-3.73660157e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.53192212]
curr_Stock_Price:  99.33754809177233
curr_Factors:  [99.33754809]
mat_Sqrt:  [[0.15]]
grads:  [-0.08671683]
Stock Position:  -0.08671683040961431
Bond Position:  [-4.91768481]


portfolio before change:  [-13.53987033]
curr_Stock_Price:  99.4008432566618
curr_Factors:  [99.40084326]
mat_Sqrt:  [[0.15]]
grads:  [-0.08840212]
Stock Position:  -0.08840212035128535
Bond Position:  [-4.75262502]


portfolio before change:  [-13.46363279]
curr_Stock_Price:  98.51156081714166
curr_Factors:  [98.51156082]
mat_Sqrt:  [[0.15]]
grads:  [-0.00833729]
Stock Position:  -0.008337286176515885
Bond Position:  [-12.64231371]


portfolio before change:  [-13.46581396]
curr_Stock_Price:  98.01480884675532
curr_Factors:  [98.01480885]
mat_Sqrt:  [[0.15]]
grads:  [0.05840271]
Stock Position:  0.05840271380102303
Bond Position:  [-19.19014479]


portfolio before change:  [-13.51395809]
curr_Stock_Price:  97.35479391542785
curr_Factors:  [97.35479392]
mat_Sqrt:  [[0.15]]
grads:  [-0.20166442]
Stock Position:  -0.2016644214024229
Bond Position:  [6.11904009]


portfolio before change:  [-13.48147043]
curr_Stock_Price:  97.20887139724549
curr_Factors:  [97.2088714]
mat_Sqrt:  [[0.15]]
grads:  [0.08859568]
Stock Position:  0.08859567870682751
Bond Position:  [-22.09375637]


portfolio before change:  [-13.43577424]
curr_Stock_Price:  97.8493746993921
curr_Factors:  [97.8493747]
mat_Sqrt:  [[0.15]]
grads:  [-0.09896031]
Stock Position:  -0.09896031101765657
Bond Position:  [-3.75256969]


portfolio before change:  [-13.38104362]
curr_Stock_Price:  97.27735370312139
curr_Factors:  [97.2773537]
mat_Sqrt:  [[0.15]]
grads:  [0.02461773]
Stock Position:  0.02461772776604391
Bond Position:  [-15.77579103]


portfolio before change:  [-13.3722012]
curr_Stock_Price:  97.9570384275856
curr_Factors:  [97.95703843]
mat_Sqrt:  [[0.15]]
grads:  [-0.02491068]
Stock Position:  -0.024910677135300922
Bond Position:  [-10.93202504]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.42820394]
Stock Price:  99.98570115810206
PL:  [-13.42820394]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 3.30443445e+00]
 [-1.31490730e-02]
 [-1.29846172e-02]
 [ 4.99448433e-03]
 [ 5.99386194e-03]
 [-3.16003172e-02]
 [ 1.26866384e-02]
 [-1.32871059e-02]
 [ 4.46464114e-03]
 [ 3.52812610e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30443445]
mat_Sqrt:  [[0.15]]
grads:  [22.02956299]
init_Out:  [2.16227608]
Stock Position:  22.02956298591829
Bond position:  [-2200.79402252]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.19516779]
curr_Stock_Price:  99.80677003412343
curr_Factors:  [99.80677003]
mat_Sqrt:  [[0.15]]
grads:  [-0.08766049]
Stock Position:  -0.08766048693121631
Bond Position:  [5.55394227]


portfolio before change:  [-3.17297761]
curr_Stock_Price:  99.5853189340851
curr_Factors:  [99.58531893]
mat_Sqrt:  [[0.15]]
grads:  [-0.08656411]
Stock Position:  -0.08656411496915774
Bond Position:  [5.44753739]


portfolio before change:  [-3.19429212]
curr_Stock_Price:  99.86302017346912
curr_Factors:  [99.86302017]
mat_Sqrt:  [[0.15]]
grads:  [0.03329656]
Stock Position:  0.03329656219409709
Bond Position:  [-6.51938738]


portfolio before change:  [-3.30730277]
curr_Stock_Price:  96.56687975682475
curr_Factors:  [96.56687976]
mat_Sqrt:  [[0.15]]
grads:  [0.03995908]
Stock Position:  0.0399590795730333
Bond Position:  [-7.16602641]


portfolio before change:  [-3.29052797]
curr_Stock_Price:  97.07636879665382
curr_Factors:  [97.0763688]
mat_Sqrt:  [[0.15]]
grads:  [-0.21066878]
Stock Position:  -0.21066878106645426
Bond Position:  [17.16043231]


portfolio before change:  [-3.80590965]
curr_Stock_Price:  99.56351491699031
curr_Factors:  [99.56351492]
mat_Sqrt:  [[0.15]]
grads:  [0.08457759]
Stock Position:  0.0845775894002934
Bond Position:  [-12.22675173]


portfolio before change:  [-3.73199621]
curr_Stock_Price:  100.50972712479421
curr_Factors:  [100.50972712]
mat_Sqrt:  [[0.15]]
grads:  [-0.08858071]
Stock Position:  -0.08858070593601579
Bond Position:  [5.17122638]


portfolio before change:  [-3.57908147]
curr_Stock_Price:  98.81264793473852
curr_Factors:  [98.81264793]
mat_Sqrt:  [[0.15]]
grads:  [0.02976427]
Stock Position:  0.02976427424677014
Bond Position:  [-6.52016823]


portfolio before change:  [-3.54527248]
curr_Stock_Price:  100.05809732409266
curr_Factors:  [100.05809732]
mat_Sqrt:  [[0.15]]
grads:  [0.00235208]
Stock Position:  0.0023520840658774024
Bond Position:  [-3.78061753]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.55485917]
Stock Price:  96.78614109024409
PL:  [-3.55485917]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  -0.7564512819830219
FINAL STD P&L:  31.27119845288745
