WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-18 19:04:58.826326: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-18 19:04:58.855177: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-18 19:04:58.855879: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 19:04:58.858006: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 19:04:58.859844: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 19:04:58.860795: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 19:04:58.863162: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 19:04:58.864995: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 19:04:58.870837: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 19:04:58.873031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 19:04:58.873463: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-18 19:04:58.880104: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2400070000 Hz
2019-12-18 19:04:58.880308: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x557a64213f60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-18 19:04:58.880326: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-18 19:04:58.881465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-18 19:04:58.881490: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 19:04:58.881502: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 19:04:58.881513: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 19:04:58.881524: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 19:04:58.881535: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 19:04:58.881545: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 19:04:58.881556: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 19:04:58.883555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 19:04:58.883584: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 19:04:58.976795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-18 19:04:58.976829: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-18 19:04:58.976840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-18 19:04:58.979883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2019-12-18 19:04:58.982040: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x557a6484d270 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-18 19:04:58.982058: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-18 19:05:14.362977: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 1.3014e+02,   Y0: 2.3763e+00,  elapsed time  15
INFO   step:     1,    loss: 9.2729e+00,   Y0: 2.3713e+00,  elapsed time  21
INFO   step:     2,    loss: 9.2737e+00,   Y0: 2.3664e+00,  elapsed time  21
INFO   step:     3,    loss: 9.2720e+00,   Y0: 2.3615e+00,  elapsed time  21
INFO   step:     4,    loss: 9.2730e+00,   Y0: 2.3566e+00,  elapsed time  21
INFO   step:     5,    loss: 9.2727e+00,   Y0: 2.3518e+00,  elapsed time  22
INFO   step:     6,    loss: 9.2761e+00,   Y0: 2.3468e+00,  elapsed time  22
INFO   step:     7,    loss: 9.2671e+00,   Y0: 2.3419e+00,  elapsed time  22
INFO   step:     8,    loss: 9.2652e+00,   Y0: 2.3371e+00,  elapsed time  22
INFO   step:     9,    loss: 9.2547e+00,   Y0: 2.3323e+00,  elapsed time  22
INFO   step:    10,    loss: 9.2496e+00,   Y0: 2.3276e+00,  elapsed time  22
INFO   step:    11,    loss: 9.2468e+00,   Y0: 2.3229e+00,  elapsed time  22
INFO   step:    12,    loss: 9.2448e+00,   Y0: 2.3180e+00,  elapsed time  22
INFO   step:    13,    loss: 9.2429e+00,   Y0: 2.3133e+00,  elapsed time  22
INFO   step:    14,    loss: 9.2411e+00,   Y0: 2.3087e+00,  elapsed time  22
INFO   step:    15,    loss: 9.2392e+00,   Y0: 2.3043e+00,  elapsed time  22
INFO   step:    16,    loss: 9.2374e+00,   Y0: 2.2999e+00,  elapsed time  22
INFO   step:    17,    loss: 9.2356e+00,   Y0: 2.2958e+00,  elapsed time  22
INFO   step:    18,    loss: 9.2339e+00,   Y0: 2.2917e+00,  elapsed time  22
INFO   step:    19,    loss: 9.2323e+00,   Y0: 2.2876e+00,  elapsed time  23
INFO   step:    20,    loss: 9.2305e+00,   Y0: 2.2834e+00,  elapsed time  23
INFO   step:    21,    loss: 9.2286e+00,   Y0: 2.2792e+00,  elapsed time  23
INFO   step:    22,    loss: 9.2267e+00,   Y0: 2.2751e+00,  elapsed time  23
INFO   step:    23,    loss: 9.2249e+00,   Y0: 2.2710e+00,  elapsed time  23
INFO   step:    24,    loss: 9.2232e+00,   Y0: 2.2668e+00,  elapsed time  23
INFO   step:    25,    loss: 9.2215e+00,   Y0: 2.2628e+00,  elapsed time  23
INFO   step:    26,    loss: 9.2200e+00,   Y0: 2.2589e+00,  elapsed time  23
INFO   step:    27,    loss: 9.2186e+00,   Y0: 2.2551e+00,  elapsed time  23
INFO   step:    28,    loss: 9.2171e+00,   Y0: 2.2512e+00,  elapsed time  23
INFO   step:    29,    loss: 9.2157e+00,   Y0: 2.2474e+00,  elapsed time  23
INFO   step:    30,    loss: 9.2144e+00,   Y0: 2.2438e+00,  elapsed time  23
INFO   step:    31,    loss: 9.2132e+00,   Y0: 2.2403e+00,  elapsed time  23
INFO   step:    32,    loss: 9.2121e+00,   Y0: 2.2367e+00,  elapsed time  23
INFO   step:    33,    loss: 9.2110e+00,   Y0: 2.2334e+00,  elapsed time  24
INFO   step:    34,    loss: 9.2100e+00,   Y0: 2.2303e+00,  elapsed time  24
INFO   step:    35,    loss: 9.2091e+00,   Y0: 2.2272e+00,  elapsed time  24
INFO   step:    36,    loss: 9.2082e+00,   Y0: 2.2242e+00,  elapsed time  24
INFO   step:    37,    loss: 9.2073e+00,   Y0: 2.2213e+00,  elapsed time  24
INFO   step:    38,    loss: 9.2065e+00,   Y0: 2.2186e+00,  elapsed time  24
INFO   step:    39,    loss: 9.2058e+00,   Y0: 2.2159e+00,  elapsed time  24
INFO   step:    40,    loss: 9.2050e+00,   Y0: 2.2133e+00,  elapsed time  24
INFO   step:    41,    loss: 9.2042e+00,   Y0: 2.2105e+00,  elapsed time  24
INFO   step:    42,    loss: 9.2035e+00,   Y0: 2.2077e+00,  elapsed time  24
INFO   step:    43,    loss: 9.2028e+00,   Y0: 2.2051e+00,  elapsed time  24
INFO   step:    44,    loss: 9.2021e+00,   Y0: 2.2027e+00,  elapsed time  24
INFO   step:    45,    loss: 9.2014e+00,   Y0: 2.2002e+00,  elapsed time  24
INFO   step:    46,    loss: 9.2008e+00,   Y0: 2.1975e+00,  elapsed time  24
INFO   step:    47,    loss: 9.2002e+00,   Y0: 2.1949e+00,  elapsed time  25
INFO   step:    48,    loss: 9.1996e+00,   Y0: 2.1924e+00,  elapsed time  25
INFO   step:    49,    loss: 9.1990e+00,   Y0: 2.1896e+00,  elapsed time  25
INFO   step:    50,    loss: 9.1984e+00,   Y0: 2.1866e+00,  elapsed time  25
INFO   step:    51,    loss: 9.1978e+00,   Y0: 2.1838e+00,  elapsed time  25
INFO   step:    52,    loss: 9.1973e+00,   Y0: 2.1811e+00,  elapsed time  25
INFO   step:    53,    loss: 9.1968e+00,   Y0: 2.1788e+00,  elapsed time  25
INFO   step:    54,    loss: 9.1964e+00,   Y0: 2.1764e+00,  elapsed time  25
INFO   step:    55,    loss: 9.1960e+00,   Y0: 2.1743e+00,  elapsed time  25
INFO   step:    56,    loss: 9.1956e+00,   Y0: 2.1722e+00,  elapsed time  25
INFO   step:    57,    loss: 9.1953e+00,   Y0: 2.1705e+00,  elapsed time  25
INFO   step:    58,    loss: 9.1950e+00,   Y0: 2.1686e+00,  elapsed time  25
INFO   step:    59,    loss: 9.1947e+00,   Y0: 2.1668e+00,  elapsed time  25
INFO   step:    60,    loss: 9.1943e+00,   Y0: 2.1648e+00,  elapsed time  25
INFO   step:    61,    loss: 9.1939e+00,   Y0: 2.1630e+00,  elapsed time  25
INFO   step:    62,    loss: 9.1936e+00,   Y0: 2.1613e+00,  elapsed time  26
INFO   step:    63,    loss: 9.1933e+00,   Y0: 2.1601e+00,  elapsed time  26
INFO   step:    64,    loss: 9.1930e+00,   Y0: 2.1587e+00,  elapsed time  26
INFO   step:    65,    loss: 9.1927e+00,   Y0: 2.1570e+00,  elapsed time  26
INFO   step:    66,    loss: 9.1924e+00,   Y0: 2.1553e+00,  elapsed time  26
INFO   step:    67,    loss: 9.1920e+00,   Y0: 2.1536e+00,  elapsed time  26
INFO   step:    68,    loss: 9.1917e+00,   Y0: 2.1519e+00,  elapsed time  26
INFO   step:    69,    loss: 9.1914e+00,   Y0: 2.1501e+00,  elapsed time  26
INFO   step:    70,    loss: 9.1911e+00,   Y0: 2.1484e+00,  elapsed time  26
INFO   step:    71,    loss: 9.1908e+00,   Y0: 2.1469e+00,  elapsed time  26
INFO   step:    72,    loss: 9.1905e+00,   Y0: 2.1457e+00,  elapsed time  26
INFO   step:    73,    loss: 9.1903e+00,   Y0: 2.1449e+00,  elapsed time  26
INFO   step:    74,    loss: 9.1900e+00,   Y0: 2.1440e+00,  elapsed time  26
INFO   step:    75,    loss: 9.1898e+00,   Y0: 2.1435e+00,  elapsed time  26
INFO   step:    76,    loss: 9.1896e+00,   Y0: 2.1433e+00,  elapsed time  26
INFO   step:    77,    loss: 9.1893e+00,   Y0: 2.1433e+00,  elapsed time  27
INFO   step:    78,    loss: 9.1891e+00,   Y0: 2.1434e+00,  elapsed time  27
INFO   step:    79,    loss: 9.1889e+00,   Y0: 2.1434e+00,  elapsed time  27
INFO   step:    80,    loss: 9.1887e+00,   Y0: 2.1434e+00,  elapsed time  27
INFO   step:    81,    loss: 9.1885e+00,   Y0: 2.1432e+00,  elapsed time  27
INFO   step:    82,    loss: 9.1883e+00,   Y0: 2.1431e+00,  elapsed time  27
INFO   step:    83,    loss: 9.1881e+00,   Y0: 2.1430e+00,  elapsed time  27
INFO   step:    84,    loss: 9.1879e+00,   Y0: 2.1431e+00,  elapsed time  27
INFO   step:    85,    loss: 9.1877e+00,   Y0: 2.1434e+00,  elapsed time  27
INFO   step:    86,    loss: 9.1876e+00,   Y0: 2.1440e+00,  elapsed time  27
INFO   step:    87,    loss: 9.1874e+00,   Y0: 2.1448e+00,  elapsed time  27
INFO   step:    88,    loss: 9.1873e+00,   Y0: 2.1457e+00,  elapsed time  27
INFO   step:    89,    loss: 9.1871e+00,   Y0: 2.1465e+00,  elapsed time  27
INFO   step:    90,    loss: 9.1870e+00,   Y0: 2.1474e+00,  elapsed time  27
INFO   step:    91,    loss: 9.1868e+00,   Y0: 2.1483e+00,  elapsed time  28
INFO   step:    92,    loss: 9.1867e+00,   Y0: 2.1491e+00,  elapsed time  28
INFO   step:    93,    loss: 9.1865e+00,   Y0: 2.1497e+00,  elapsed time  28
INFO   step:    94,    loss: 9.1864e+00,   Y0: 2.1501e+00,  elapsed time  28
INFO   step:    95,    loss: 9.1862e+00,   Y0: 2.1505e+00,  elapsed time  28
INFO   step:    96,    loss: 9.1860e+00,   Y0: 2.1504e+00,  elapsed time  28
INFO   step:    97,    loss: 9.1858e+00,   Y0: 2.1503e+00,  elapsed time  28
INFO   step:    98,    loss: 9.1856e+00,   Y0: 2.1501e+00,  elapsed time  28
INFO   step:    99,    loss: 9.1854e+00,   Y0: 2.1498e+00,  elapsed time  28
INFO   step:   100,    loss: 9.1852e+00,   Y0: 2.1496e+00,  elapsed time  28
INFO   step:   101,    loss: 9.1850e+00,   Y0: 2.1493e+00,  elapsed time  28
INFO   step:   102,    loss: 9.1849e+00,   Y0: 2.1490e+00,  elapsed time  28
INFO   step:   103,    loss: 9.1847e+00,   Y0: 2.1487e+00,  elapsed time  28
INFO   step:   104,    loss: 9.1845e+00,   Y0: 2.1485e+00,  elapsed time  29
INFO   step:   105,    loss: 9.1843e+00,   Y0: 2.1485e+00,  elapsed time  29
INFO   step:   106,    loss: 9.1841e+00,   Y0: 2.1488e+00,  elapsed time  29
INFO   step:   107,    loss: 9.1840e+00,   Y0: 2.1492e+00,  elapsed time  29
INFO   step:   108,    loss: 9.1838e+00,   Y0: 2.1494e+00,  elapsed time  29
INFO   step:   109,    loss: 9.1837e+00,   Y0: 2.1499e+00,  elapsed time  29
INFO   step:   110,    loss: 9.1835e+00,   Y0: 2.1504e+00,  elapsed time  29
INFO   step:   111,    loss: 9.1834e+00,   Y0: 2.1509e+00,  elapsed time  29
INFO   step:   112,    loss: 9.1832e+00,   Y0: 2.1512e+00,  elapsed time  29
INFO   step:   113,    loss: 9.1830e+00,   Y0: 2.1508e+00,  elapsed time  29
INFO   step:   114,    loss: 9.1828e+00,   Y0: 2.1503e+00,  elapsed time  29
INFO   step:   115,    loss: 9.1827e+00,   Y0: 2.1498e+00,  elapsed time  29
INFO   step:   116,    loss: 9.1825e+00,   Y0: 2.1492e+00,  elapsed time  29
INFO   step:   117,    loss: 9.1823e+00,   Y0: 2.1491e+00,  elapsed time  29
INFO   step:   118,    loss: 9.1821e+00,   Y0: 2.1489e+00,  elapsed time  30
INFO   step:   119,    loss: 9.1819e+00,   Y0: 2.1479e+00,  elapsed time  30
INFO   step:   120,    loss: 9.1817e+00,   Y0: 2.1471e+00,  elapsed time  30
INFO   step:   121,    loss: 9.1815e+00,   Y0: 2.1465e+00,  elapsed time  30
INFO   step:   122,    loss: 9.1813e+00,   Y0: 2.1463e+00,  elapsed time  30
INFO   step:   123,    loss: 9.1812e+00,   Y0: 2.1462e+00,  elapsed time  30
INFO   step:   124,    loss: 9.1810e+00,   Y0: 2.1461e+00,  elapsed time  30
INFO   step:   125,    loss: 9.1808e+00,   Y0: 2.1459e+00,  elapsed time  30
INFO   step:   126,    loss: 9.1807e+00,   Y0: 2.1460e+00,  elapsed time  30
INFO   step:   127,    loss: 9.1805e+00,   Y0: 2.1459e+00,  elapsed time  30
INFO   step:   128,    loss: 9.1803e+00,   Y0: 2.1456e+00,  elapsed time  30
INFO   step:   129,    loss: 9.1801e+00,   Y0: 2.1453e+00,  elapsed time  30
INFO   step:   130,    loss: 9.1800e+00,   Y0: 2.1454e+00,  elapsed time  30
INFO   step:   131,    loss: 9.1798e+00,   Y0: 2.1453e+00,  elapsed time  30
INFO   step:   132,    loss: 9.1797e+00,   Y0: 2.1455e+00,  elapsed time  31
INFO   step:   133,    loss: 9.1795e+00,   Y0: 2.1458e+00,  elapsed time  31
INFO   step:   134,    loss: 9.1794e+00,   Y0: 2.1464e+00,  elapsed time  31
INFO   step:   135,    loss: 9.1792e+00,   Y0: 2.1467e+00,  elapsed time  31
INFO   step:   136,    loss: 9.1791e+00,   Y0: 2.1469e+00,  elapsed time  31
INFO   step:   137,    loss: 9.1789e+00,   Y0: 2.1469e+00,  elapsed time  31
INFO   step:   138,    loss: 9.1787e+00,   Y0: 2.1464e+00,  elapsed time  31
INFO   step:   139,    loss: 9.1786e+00,   Y0: 2.1464e+00,  elapsed time  31
INFO   step:   140,    loss: 9.1784e+00,   Y0: 2.1461e+00,  elapsed time  31
INFO   step:   141,    loss: 9.1782e+00,   Y0: 2.1461e+00,  elapsed time  31
INFO   step:   142,    loss: 9.1781e+00,   Y0: 2.1462e+00,  elapsed time  31
INFO   step:   143,    loss: 9.1779e+00,   Y0: 2.1467e+00,  elapsed time  31
INFO   step:   144,    loss: 9.1778e+00,   Y0: 2.1470e+00,  elapsed time  31
INFO   step:   145,    loss: 9.1777e+00,   Y0: 2.1475e+00,  elapsed time  31
INFO   step:   146,    loss: 9.1775e+00,   Y0: 2.1478e+00,  elapsed time  32
INFO   step:   147,    loss: 9.1774e+00,   Y0: 2.1481e+00,  elapsed time  32
INFO   step:   148,    loss: 9.1772e+00,   Y0: 2.1483e+00,  elapsed time  32
INFO   step:   149,    loss: 9.1771e+00,   Y0: 2.1482e+00,  elapsed time  32
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_10:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_11:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_12:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_13:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_14:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_15:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_16:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_17:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_18:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_19:0' shape=(?, 1) dtype=float64>]
num_iterations:  150
total time intervals:  20
# of dimensions:  1
Loss out:  10.759174246768566
Output_Z_Vals:  [[[ 3.30601096e+00]
  [ 3.30601096e+00]
  [ 3.30601096e+00]
  ...
  [ 3.30601096e+00]
  [ 3.30601096e+00]
  [ 3.30601096e+00]]

 [[ 2.61983460e-04]
  [ 1.12355909e-03]
  [ 2.61475306e-03]
  ...
  [ 2.30596078e-04]
  [ 2.31078120e-03]
  [-8.12675385e-03]]

 [[-9.58259761e-04]
  [-5.62875546e-03]
  [-9.78879179e-03]
  ...
  [-8.05403557e-03]
  [-1.05490060e-02]
  [ 9.71778725e-03]]

 ...

 [[ 1.08271779e-02]
  [ 6.18025113e-03]
  [ 9.21532910e-03]
  ...
  [ 1.13556351e-02]
  [ 6.50856516e-03]
  [ 1.15637588e-02]]

 [[ 4.26429595e-04]
  [ 1.66900904e-03]
  [ 2.68201813e-03]
  ...
  [ 1.22432847e-04]
  [ 6.08610816e-03]
  [ 1.59314263e-02]]

 [[-9.33874399e-03]
  [-4.29834286e-03]
  [-6.60134859e-03]
  ...
  [-1.07618106e-02]
  [-4.27261291e-03]
  [-1.72794118e-02]]]
Z_Vals dimensionality:  (20, 200, 1)
X_test:  [[[100.          97.84365258  97.45121434 ...  94.98678063  94.69959147
    94.46953415]]

 [[100.          98.95104017  99.10308562 ...  97.15691336  97.81676015
    96.77671713]]

 [[100.          99.77230075 100.01410999 ...  97.55584268  96.61700102
    95.78884962]]

 ...

 [[100.          98.75597668  99.43174567 ...  92.93015267  92.10290254
    91.50622872]]

 [[100.          99.85118566  99.93604262 ...  98.8944375   98.82988553
    98.84003662]]

 [[100.         100.43242936 100.94087818 ... 109.35328463 108.87827071
   108.02770012]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.61983460e-04]
 [-9.58259761e-04]
 [-1.31506268e-02]
 [ 1.04263522e-02]
 [-6.10967672e-03]
 [-1.16835176e-02]
 [ 1.37041640e-02]
 [-4.17499294e-02]
 [ 1.56580679e-04]
 [ 1.00592048e-02]
 [-6.97690545e-03]
 [ 1.15158769e-02]
 [ 6.94149224e-03]
 [-1.73447889e-03]
 [ 7.47171192e-03]
 [ 2.19134618e-02]
 [ 1.08271779e-02]
 [ 4.26429595e-04]
 [-9.33874399e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-45.92861678]
curr_Stock_Price:  97.84365258284814
curr_Factors:  [97.84365258]
mat_Sqrt:  [[0.15]]
grads:  [0.00174656]
Stock Position:  0.0017465564014590082
Bond Position:  [-46.09950624]


portfolio before change:  [-45.94082851]
curr_Stock_Price:  97.4512143382118
curr_Factors:  [97.45121434]
mat_Sqrt:  [[0.15]]
grads:  [-0.0063884]
Stock Position:  -0.006388398404364586
Bond Position:  [-45.31827133]


portfolio before change:  [-45.94893704]
curr_Stock_Price:  96.94679013227892
curr_Factors:  [96.94679013]
mat_Sqrt:  [[0.15]]
grads:  [-0.08767085]
Stock Position:  -0.0876708451170417
Bond Position:  [-37.44953001]


portfolio before change:  [-45.95336909]
curr_Stock_Price:  96.89054002829094
curr_Factors:  [96.89054003]
mat_Sqrt:  [[0.15]]
grads:  [0.06950901]
Stock Position:  0.0695090145700032
Bond Position:  [-52.68813505]


portfolio before change:  [-45.99391991]
curr_Stock_Price:  96.49667545326041
curr_Factors:  [96.49667545]
mat_Sqrt:  [[0.15]]
grads:  [-0.04073118]
Stock Position:  -0.04073117812201005
Bond Position:  [-42.06349664]


portfolio before change:  [-45.96260625]
curr_Stock_Price:  95.46967713014249
curr_Factors:  [95.46967713]
mat_Sqrt:  [[0.15]]
grads:  [-0.07789012]
Stock Position:  -0.07789011748314249
Bond Position:  [-38.52646188]


portfolio before change:  [-45.93302446]
curr_Stock_Price:  94.96621652979536
curr_Factors:  [94.96621653]
mat_Sqrt:  [[0.15]]
grads:  [0.09136109]
Stock Position:  0.09136109346823888
Bond Position:  [-54.60924185]


portfolio before change:  [-45.8544679]
curr_Stock_Price:  95.97551462210419
curr_Factors:  [95.97551462]
mat_Sqrt:  [[0.15]]
grads:  [-0.27833286]
Stock Position:  -0.27833286243411004
Bond Position:  [-19.1413282]


portfolio before change:  [-46.27827831]
curr_Stock_Price:  97.4809943212427
curr_Factors:  [97.48099432]
mat_Sqrt:  [[0.15]]
grads:  [0.00104387]
Stock Position:  0.0010438711948565927
Bond Position:  [-46.38003591]


portfolio before change:  [-46.28963445]
curr_Stock_Price:  97.71121303557662
curr_Factors:  [97.71121304]
mat_Sqrt:  [[0.15]]
grads:  [0.06706137]
Stock Position:  0.06706136508448131
Bond Position:  [-52.84228178]


portfolio before change:  [-46.3376556]
curr_Stock_Price:  97.19215218053739
curr_Factors:  [97.19215218]
mat_Sqrt:  [[0.15]]
grads:  [-0.0465127]
Stock Position:  -0.046512703033048344
Bond Position:  [-41.81698589]


portfolio before change:  [-46.29530207]
curr_Stock_Price:  96.05678318832419
curr_Factors:  [96.05678319]
mat_Sqrt:  [[0.15]]
grads:  [0.07677251]
Stock Position:  0.07677251248479636
Bond Position:  [-53.66982266]


portfolio before change:  [-46.4063026]
curr_Stock_Price:  94.7857372157917
curr_Factors:  [94.78573722]
mat_Sqrt:  [[0.15]]
grads:  [0.04627661]
Stock Position:  0.04627661490538354
Bond Position:  [-50.79266566]


portfolio before change:  [-46.42833693]
curr_Stock_Price:  94.58402455239373
curr_Factors:  [94.58402455]
mat_Sqrt:  [[0.15]]
grads:  [-0.01156319]
Stock Position:  -0.011563192631790549
Bond Position:  [-45.33464364]


portfolio before change:  [-46.44458775]
curr_Stock_Price:  95.00914423608594
curr_Factors:  [95.00914424]
mat_Sqrt:  [[0.15]]
grads:  [0.04981141]
Stock Position:  0.04981141281193418
Bond Position:  [-51.17712745]


portfolio before change:  [-46.48328361]
curr_Stock_Price:  94.48918346659515
curr_Factors:  [94.48918347]
mat_Sqrt:  [[0.15]]
grads:  [0.14608975]
Stock Position:  0.1460897450866907
Bond Position:  [-60.28718434]


portfolio before change:  [-46.49680239]
curr_Stock_Price:  94.49982697242434
curr_Factors:  [94.49982697]
mat_Sqrt:  [[0.15]]
grads:  [0.07218119]
Stock Position:  0.0721811860989421
Bond Position:  [-53.31791198]


portfolio before change:  [-46.47498464]
curr_Stock_Price:  94.98678062853178
curr_Factors:  [94.98678063]
mat_Sqrt:  [[0.15]]
grads:  [0.00284286]
Stock Position:  0.002842863963627753
Bond Position:  [-46.74501913]


portfolio before change:  [-46.48748879]
curr_Stock_Price:  94.69959146886504
curr_Factors:  [94.69959147]
mat_Sqrt:  [[0.15]]
grads:  [-0.06225829]
Stock Position:  -0.062258293266424285
Bond Position:  [-40.59165385]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-46.483315]
Stock Price:  94.46953415268938
PL:  [-46.483315]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 1.12355909e-03]
 [-5.62875546e-03]
 [-4.56506205e-03]
 [-2.19092067e-02]
 [ 1.12400813e-03]
 [-1.07606294e-02]
 [ 1.34063678e-02]
 [-3.74381105e-03]
 [-1.49227019e-03]
 [ 1.04766749e-02]
 [-4.10781574e-03]
 [-4.65416515e-03]
 [ 4.88157311e-03]
 [-1.01645519e-03]
 [ 7.11123136e-03]
 [ 1.78792541e-02]
 [ 6.18025113e-03]
 [ 1.66900904e-03]
 [-4.29834286e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.5217135]
curr_Stock_Price:  98.95104016861993
curr_Factors:  [98.95104017]
mat_Sqrt:  [[0.15]]
grads:  [0.00749039]
Stock Position:  0.007490393919639798
Bond Position:  [-22.26289577]


portfolio before change:  [-21.52614104]
curr_Stock_Price:  99.10308561559394
curr_Factors:  [99.10308562]
mat_Sqrt:  [[0.15]]
grads:  [-0.03752504]
Stock Position:  -0.03752503638195333
Bond Position:  [-17.80729415]


portfolio before change:  [-21.55633459]
curr_Stock_Price:  99.78905875466263
curr_Factors:  [99.78905875]
mat_Sqrt:  [[0.15]]
grads:  [-0.03043375]
Stock Position:  -0.030433746970025054
Bond Position:  [-18.51937962]


portfolio before change:  [-21.56216553]
curr_Stock_Price:  99.82850572814664
curr_Factors:  [99.82850573]
mat_Sqrt:  [[0.15]]
grads:  [-0.14606138]
Stock Position:  -0.14606137778456968
Bond Position:  [-6.98107644]


portfolio before change:  [-21.35081202]
curr_Stock_Price:  98.36953693702411
curr_Factors:  [98.36953694]
mat_Sqrt:  [[0.15]]
grads:  [0.00749339]
Stock Position:  0.007493387541448095
Bond Position:  [-22.08793309]


portfolio before change:  [-21.35711992]
curr_Stock_Price:  98.26474796824458
curr_Factors:  [98.26474797]
mat_Sqrt:  [[0.15]]
grads:  [-0.07173753]
Stock Position:  -0.07173752906420004
Bond Position:  [-14.30784971]


portfolio before change:  [-21.49073356]
curr_Stock_Price:  100.07741466477802
curr_Factors:  [100.07741466]
mat_Sqrt:  [[0.15]]
grads:  [0.08937579]
Stock Position:  0.08937578530406386
Bond Position:  [-30.43523109]


portfolio before change:  [-21.51237992]
curr_Stock_Price:  99.92036323910604
curr_Factors:  [99.92036324]
mat_Sqrt:  [[0.15]]
grads:  [-0.02495874]
Stock Position:  -0.02495874035789842
Bond Position:  [-19.01849351]


portfolio before change:  [-21.49619816]
curr_Stock_Price:  99.08149991967797
curr_Factors:  [99.08149992]
mat_Sqrt:  [[0.15]]
grads:  [-0.00994847]
Stock Position:  -0.009948467952496192
Bond Position:  [-20.51048903]


portfolio before change:  [-21.49392431]
curr_Stock_Price:  98.33745465776532
curr_Factors:  [98.33745466]
mat_Sqrt:  [[0.15]]
grads:  [0.0698445]
Stock Position:  0.06984449923009162
Bond Position:  [-28.36225459]


portfolio before change:  [-21.47633662]
curr_Stock_Price:  98.69079876861609
curr_Factors:  [98.69079877]
mat_Sqrt:  [[0.15]]
grads:  [-0.02738544]
Stock Position:  -0.027385438261133405
Bond Position:  [-18.77364585]


portfolio before change:  [-21.52180826]
curr_Stock_Price:  100.17982500251483
curr_Factors:  [100.179825]
mat_Sqrt:  [[0.15]]
grads:  [-0.03102777]
Stock Position:  -0.031027767667913108
Bond Position:  [-18.41345192]


portfolio before change:  [-21.4907443]
curr_Stock_Price:  99.03027737252398
curr_Factors:  [99.03027737]
mat_Sqrt:  [[0.15]]
grads:  [0.03254382]
Stock Position:  0.032543820719883015
Bond Position:  [-24.71356789]


portfolio before change:  [-21.53278183]
curr_Stock_Price:  97.92842865195485
curr_Factors:  [97.92842865]
mat_Sqrt:  [[0.15]]
grads:  [-0.00677637]
Stock Position:  -0.006776367929294809
Bond Position:  [-20.86918277]


portfolio before change:  [-21.54503527]
curr_Stock_Price:  98.96666759638444
curr_Factors:  [98.9666676]
mat_Sqrt:  [[0.15]]
grads:  [0.04740821]
Stock Position:  0.047408209073944385
Bond Position:  [-26.23686773]


portfolio before change:  [-21.59374412]
curr_Stock_Price:  98.07760592201805
curr_Factors:  [98.07760592]
mat_Sqrt:  [[0.15]]
grads:  [0.11919503]
Stock Position:  0.11919502715480408
Bond Position:  [-33.28410703]


portfolio before change:  [-21.59356043]
curr_Stock_Price:  98.14896596480837
curr_Factors:  [98.14896596]
mat_Sqrt:  [[0.15]]
grads:  [0.04120167]
Stock Position:  0.04120167422163468
Bond Position:  [-25.63746215]


portfolio before change:  [-21.64084482]
curr_Stock_Price:  97.15691336208269
curr_Factors:  [97.15691336]
mat_Sqrt:  [[0.15]]
grads:  [0.01112673]
Stock Position:  0.011126726911767314
Bond Position:  [-22.72188327]


portfolio before change:  [-21.63918407]
curr_Stock_Price:  97.81676014753107
curr_Factors:  [97.81676015]
mat_Sqrt:  [[0.15]]
grads:  [-0.02865562]
Stock Position:  -0.02865561908609734
Bond Position:  [-18.83618425]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.61409063]
Stock Price:  96.77671712553604
PL:  [-21.61409063]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.61475306e-03]
 [-9.78879179e-03]
 [-5.30666501e-03]
 [-1.00193787e-02]
 [ 6.52391238e-03]
 [-1.01268638e-02]
 [ 1.03548102e-02]
 [-4.61251129e-03]
 [-7.21930442e-04]
 [ 1.04161900e-02]
 [-3.97251259e-03]
 [ 1.48877076e-03]
 [ 5.45036740e-03]
 [-1.18006359e-03]
 [ 7.99169632e-03]
 [ 2.11840424e-02]
 [ 9.21532910e-03]
 [ 2.68201813e-03]
 [-6.60134859e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.42107024]
curr_Stock_Price:  99.77230075239646
curr_Factors:  [99.77230075]
mat_Sqrt:  [[0.15]]
grads:  [0.01743169]
Stock Position:  0.017431687034882272
Bond Position:  [-5.16026976]


portfolio before change:  [-3.41814533]
curr_Stock_Price:  100.01410999467284
curr_Factors:  [100.01410999]
mat_Sqrt:  [[0.15]]
grads:  [-0.06525861]
Stock Position:  -0.06525861193733784
Bond Position:  [3.10863666]


portfolio before change:  [-3.43978477]
curr_Stock_Price:  100.35761561293857
curr_Factors:  [100.35761561]
mat_Sqrt:  [[0.15]]
grads:  [-0.03537777]
Stock Position:  -0.035377766761840866
Bond Position:  [0.11064355]


portfolio before change:  [-3.43929295]
curr_Stock_Price:  100.34449559303545
curr_Factors:  [100.34449559]
mat_Sqrt:  [[0.15]]
grads:  [-0.06679586]
Stock Position:  -0.06679585774710677
Bond Position:  [3.2633037]


portfolio before change:  [-3.44488614]
curr_Stock_Price:  100.44044646600182
curr_Factors:  [100.44044647]
mat_Sqrt:  [[0.15]]
grads:  [0.04349275]
Stock Position:  0.043492749201068444
Bond Position:  [-7.81331729]


portfolio before change:  [-3.48301]
curr_Stock_Price:  99.6088070474592
curr_Factors:  [99.60880705]
mat_Sqrt:  [[0.15]]
grads:  [-0.06751243]
Stock Position:  -0.06751242509539607
Bond Position:  [3.24182212]


portfolio before change:  [-3.54963954]
curr_Stock_Price:  100.60773566282124
curr_Factors:  [100.60773566]
mat_Sqrt:  [[0.15]]
grads:  [0.06903207]
Stock Position:  0.06903206819516655
Bond Position:  [-10.49479961]


portfolio before change:  [-3.60173814]
curr_Stock_Price:  99.89104592828193
curr_Factors:  [99.89104593]
mat_Sqrt:  [[0.15]]
grads:  [-0.03075008]
Stock Position:  -0.03075007523688673
Bond Position:  [-0.53008096]


portfolio before change:  [-3.58840734]
curr_Stock_Price:  99.45321498850657
curr_Factors:  [99.45321499]
mat_Sqrt:  [[0.15]]
grads:  [-0.00481287]
Stock Position:  -0.004812869612302085
Bond Position:  [-3.10975199]


portfolio before change:  [-3.58552678]
curr_Stock_Price:  98.69314940773766
curr_Factors:  [98.69314941]
mat_Sqrt:  [[0.15]]
grads:  [0.06944127]
Stock Position:  0.06944126667284707
Bond Position:  [-10.43890409]


portfolio before change:  [-3.58201249]
curr_Stock_Price:  98.78134405984584
curr_Factors:  [98.78134406]
mat_Sqrt:  [[0.15]]
grads:  [-0.02648342]
Stock Position:  -0.026483417296297013
Bond Position:  [-0.96594493]


portfolio before change:  [-3.5642031]
curr_Stock_Price:  98.09975135214972
curr_Factors:  [98.09975135]
mat_Sqrt:  [[0.15]]
grads:  [0.00992514]
Stock Position:  0.009925138375674372
Bond Position:  [-4.5378567]


portfolio before change:  [-3.56696428]
curr_Stock_Price:  97.93586667218801
curr_Factors:  [97.93586667]
mat_Sqrt:  [[0.15]]
grads:  [0.03633578]
Stock Position:  0.036335782669681536
Bond Position:  [-7.12554065]


portfolio before change:  [-3.60089835]
curr_Stock_Price:  97.05099635443143
curr_Factors:  [97.05099635]
mat_Sqrt:  [[0.15]]
grads:  [-0.00786709]
Stock Position:  -0.007867090603384532
Bond Position:  [-2.83738936]


portfolio before change:  [-3.59226499]
curr_Stock_Price:  95.86341682475818
curr_Factors:  [95.86341682]
mat_Sqrt:  [[0.15]]
grads:  [0.05327798]
Stock Position:  0.05327797545368509
Bond Position:  [-8.69967375]


portfolio before change:  [-3.59006658]
curr_Stock_Price:  95.94550687856137
curr_Factors:  [95.94550688]
mat_Sqrt:  [[0.15]]
grads:  [0.14122695]
Stock Position:  0.14122694964724725
Bond Position:  [-17.14015785]


portfolio before change:  [-3.67399431]
curr_Stock_Price:  95.3815766469823
curr_Factors:  [95.38157665]
mat_Sqrt:  [[0.15]]
grads:  [0.06143553]
Stock Position:  0.061435527356879654
Bond Position:  [-9.53381177]


portfolio before change:  [-3.54280088]
curr_Stock_Price:  97.55584267971524
curr_Factors:  [97.55584268]
mat_Sqrt:  [[0.15]]
grads:  [0.01788012]
Stock Position:  0.017880120892007016
Bond Position:  [-5.28711114]


portfolio before change:  [-3.56090942]
curr_Stock_Price:  96.61700102102357
curr_Factors:  [96.61700102]
mat_Sqrt:  [[0.15]]
grads:  [-0.04400899]
Stock Position:  -0.04400899059549414
Bond Position:  [0.69110727]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.52429052]
Stock Price:  95.78884961891195
PL:  [-3.52429052]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.79987871e-02]
 [ 1.14211852e-02]
 [-5.10903280e-03]
 [-1.91759491e-02]
 [ 6.55774995e-03]
 [-1.02140960e-02]
 [ 1.42582626e-03]
 [ 6.54520832e-03]
 [-1.19811082e-02]
 [ 2.34961772e-03]
 [-3.28237700e-03]
 [-6.58709271e-03]
 [ 5.23538778e-03]
 [-3.36933566e-04]
 [ 1.58508387e-04]
 [ 1.89555485e-02]
 [ 3.74681665e-03]
 [ 8.77199418e-03]
 [-5.21552826e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [27.6786513]
curr_Stock_Price:  101.18335422182834
curr_Factors:  [101.18335422]
mat_Sqrt:  [[0.15]]
grads:  [-0.11999191]
Stock Position:  -0.11999191392649489
Bond Position:  [39.81983563]


portfolio before change:  [27.70823534]
curr_Stock_Price:  101.01977787752627
curr_Factors:  [101.01977788]
mat_Sqrt:  [[0.15]]
grads:  [0.07614123]
Stock Position:  0.07614123433842643
Bond Position:  [20.01646476]


portfolio before change:  [27.65066451]
curr_Stock_Price:  100.19794234322625
curr_Factors:  [100.19794234]
mat_Sqrt:  [[0.15]]
grads:  [-0.03406022]
Stock Position:  -0.03406021865259319
Bond Position:  [31.06342833]


portfolio before change:  [27.66736797]
curr_Stock_Price:  99.9355649573324
curr_Factors:  [99.93556496]
mat_Sqrt:  [[0.15]]
grads:  [-0.12783966]
Stock Position:  -0.12783966079086023
Bond Position:  [40.44309669]


portfolio before change:  [27.65240613]
curr_Stock_Price:  100.13170029530114
curr_Factors:  [100.1317003]
mat_Sqrt:  [[0.15]]
grads:  [0.04371833]
Stock Position:  0.04371833300279774
Bond Position:  [23.27481511]


portfolio before change:  [27.6303001]
curr_Stock_Price:  99.49294164073397
curr_Factors:  [99.49294164]
mat_Sqrt:  [[0.15]]
grads:  [-0.06809397]
Stock Position:  -0.06809397351943829
Bond Position:  [34.40516983]


portfolio before change:  [27.48115703]
curr_Stock_Price:  101.80952610479207
curr_Factors:  [101.8095261]
mat_Sqrt:  [[0.15]]
grads:  [0.00950551]
Stock Position:  0.009505508405206163
Bond Position:  [26.51340572]


portfolio before change:  [27.49535732]
curr_Stock_Price:  102.60602337334856
curr_Factors:  [102.60602337]
mat_Sqrt:  [[0.15]]
grads:  [0.04363472]
Stock Position:  0.0436347221003309
Bond Position:  [23.018172]


portfolio before change:  [27.49582225]
curr_Stock_Price:  102.48478211697571
curr_Factors:  [102.48478212]
mat_Sqrt:  [[0.15]]
grads:  [-0.07987405]
Stock Position:  -0.07987405444195082
Bond Position:  [35.68169732]


portfolio before change:  [27.52364888]
curr_Stock_Price:  102.2480958357283
curr_Factors:  [102.24809584]
mat_Sqrt:  [[0.15]]
grads:  [0.01566412]
Stock Position:  0.015664118134963833
Bond Position:  [25.92202263]


portfolio before change:  [27.55112347]
curr_Stock_Price:  103.5883100698994
curr_Factors:  [103.58831007]
mat_Sqrt:  [[0.15]]
grads:  [-0.02188251]
Stock Position:  -0.021882513312842432
Bond Position:  [29.81789605]


portfolio before change:  [27.60068544]
curr_Stock_Price:  101.66409940703863
curr_Factors:  [101.66409941]
mat_Sqrt:  [[0.15]]
grads:  [-0.04391395]
Stock Position:  -0.04391395138036076
Bond Position:  [32.06515776]


portfolio before change:  [27.64641433]
curr_Stock_Price:  100.80533832779581
curr_Factors:  [100.80533833]
mat_Sqrt:  [[0.15]]
grads:  [0.03490259]
Stock Position:  0.03490258517725421
Bond Position:  [24.12804742]


portfolio before change:  [27.63770997]
curr_Stock_Price:  100.38310253925764
curr_Factors:  [100.38310254]
mat_Sqrt:  [[0.15]]
grads:  [-0.00224622]
Stock Position:  -0.0022462237735943074
Bond Position:  [27.86319289]


portfolio before change:  [27.64076073]
curr_Stock_Price:  102.12643196038798
curr_Factors:  [102.12643196]
mat_Sqrt:  [[0.15]]
grads:  [0.00105672]
Stock Position:  0.0010567225770128734
Bond Position:  [27.53284143]


portfolio before change:  [27.64580538]
curr_Stock_Price:  100.38574212784056
curr_Factors:  [100.38574213]
mat_Sqrt:  [[0.15]]
grads:  [0.12637032]
Stock Position:  0.1263703230668417
Bond Position:  [14.96002672]


portfolio before change:  [27.66146823]
curr_Stock_Price:  100.48008690410099
curr_Factors:  [100.4800869]
mat_Sqrt:  [[0.15]]
grads:  [0.02497878]
Stock Position:  0.024978777680649072
Bond Position:  [25.15159848]


portfolio before change:  [27.65642886]
curr_Stock_Price:  100.02657936593792
curr_Factors:  [100.02657937]
mat_Sqrt:  [[0.15]]
grads:  [0.05847996]
Stock Position:  0.05847996119956889
Bond Position:  [21.80687838]


portfolio before change:  [27.73506653]
curr_Stock_Price:  101.27803832628868
curr_Factors:  [101.27803833]
mat_Sqrt:  [[0.15]]
grads:  [-0.03477019]
Stock Position:  -0.03477018838278199
Bond Position:  [31.256523]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [27.76292051]
Stock Price:  100.70171499008191
PL:  [27.06120552]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 1.26799802e-03]
 [-3.17231069e-03]
 [-4.25655181e-03]
 [ 3.28881282e-03]
 [ 6.61221559e-03]
 [-9.54768639e-03]
 [ 8.79254764e-03]
 [ 9.79464998e-03]
 [-1.49398846e-02]
 [ 8.49348109e-03]
 [-3.26426793e-03]
 [ 3.10098125e-03]
 [ 4.86811473e-03]
 [ 5.02293133e-05]
 [ 1.56748923e-03]
 [ 1.67703911e-02]
 [ 5.80159948e-03]
 [ 1.25856278e-03]
 [-4.12571579e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-33.57716889]
curr_Stock_Price:  98.40406124679552
curr_Factors:  [98.40406125]
mat_Sqrt:  [[0.15]]
grads:  [0.00845332]
Stock Position:  0.00845332011558882
Bond Position:  [-34.40900992]


portfolio before change:  [-33.58332598]
curr_Stock_Price:  98.69344370224916
curr_Factors:  [98.6934437]
mat_Sqrt:  [[0.15]]
grads:  [-0.02114874]
Stock Position:  -0.021148737906219038
Bond Position:  [-31.4960842]


portfolio before change:  [-33.61079892]
curr_Stock_Price:  99.62011536022973
curr_Factors:  [99.62011536]
mat_Sqrt:  [[0.15]]
grads:  [-0.02837701]
Stock Position:  -0.02837701203429581
Bond Position:  [-30.78387771]


portfolio before change:  [-33.65313473]
curr_Stock_Price:  100.8407822911762
curr_Factors:  [100.84078229]
mat_Sqrt:  [[0.15]]
grads:  [0.02192542]
Stock Position:  0.021925418782392632
Bond Position:  [-35.86411111]


portfolio before change:  [-33.67365917]
curr_Stock_Price:  100.31366405477175
curr_Factors:  [100.31366405]
mat_Sqrt:  [[0.15]]
grads:  [0.04408144]
Stock Position:  0.04408143726870787
Bond Position:  [-38.09562966]


portfolio before change:  [-33.66031496]
curr_Stock_Price:  100.83246067903973
curr_Factors:  [100.83246068]
mat_Sqrt:  [[0.15]]
grads:  [-0.06365124]
Stock Position:  -0.06365124262003137
Bond Position:  [-27.24220355]


portfolio before change:  [-33.66534488]
curr_Stock_Price:  100.80447238756761
curr_Factors:  [100.80447239]
mat_Sqrt:  [[0.15]]
grads:  [0.05861698]
Stock Position:  0.05861698425743414
Bond Position:  [-39.57419905]


portfolio before change:  [-33.69943675]
curr_Stock_Price:  100.39167239960753
curr_Factors:  [100.3916724]
mat_Sqrt:  [[0.15]]
grads:  [0.06529767]
Stock Position:  0.06529766652102376
Bond Position:  [-40.2547787]


portfolio before change:  [-33.6937578]
curr_Stock_Price:  100.63278226071188
curr_Factors:  [100.63278226]
mat_Sqrt:  [[0.15]]
grads:  [-0.09959923]
Stock Position:  -0.09959923053071816
Bond Position:  [-23.67081012]


portfolio before change:  [-33.57672023]
curr_Stock_Price:  99.39827461891228
curr_Factors:  [99.39827462]
mat_Sqrt:  [[0.15]]
grads:  [0.05662321]
Stock Position:  0.056623207239062626
Bond Position:  [-39.20496933]


portfolio before change:  [-33.5960951]
curr_Stock_Price:  99.22922007330388
curr_Factors:  [99.22922007]
mat_Sqrt:  [[0.15]]
grads:  [-0.02176179]
Stock Position:  -0.021761786174677226
Bond Position:  [-31.43669004]


portfolio before change:  [-33.57090204]
curr_Stock_Price:  97.71035488902064
curr_Factors:  [97.71035489]
mat_Sqrt:  [[0.15]]
grads:  [0.02067321]
Stock Position:  0.020673208317946307
Bond Position:  [-35.59088856]


portfolio before change:  [-33.54597622]
curr_Stock_Price:  99.3465138869009
curr_Factors:  [99.34651389]
mat_Sqrt:  [[0.15]]
grads:  [0.0324541]
Stock Position:  0.032454098188220294
Bond Position:  [-36.77017774]


portfolio before change:  [-33.49429467]
curr_Stock_Price:  101.22224755837395
curr_Factors:  [101.22224756]
mat_Sqrt:  [[0.15]]
grads:  [0.00033486]
Stock Position:  0.0003348620889067671
Bond Position:  [-33.52819016]


portfolio before change:  [-33.50278428]
curr_Stock_Price:  100.90414366225193
curr_Factors:  [100.90414366]
mat_Sqrt:  [[0.15]]
grads:  [0.01044993]
Stock Position:  0.010449928167469697
Bond Position:  [-34.55722534]


portfolio before change:  [-33.53032444]
curr_Stock_Price:  99.09554085954284
curr_Factors:  [99.09554086]
mat_Sqrt:  [[0.15]]
grads:  [0.11180261]
Stock Position:  0.11180260715329077
Bond Position:  [-44.60946427]


portfolio before change:  [-33.59781794]
curr_Stock_Price:  98.59161929786816
curr_Factors:  [98.5916193]
mat_Sqrt:  [[0.15]]
grads:  [0.03867733]
Stock Position:  0.038677329879058545
Bond Position:  [-37.41107853]


portfolio before change:  [-33.66892678]
curr_Stock_Price:  96.9949502761166
curr_Factors:  [96.99495028]
mat_Sqrt:  [[0.15]]
grads:  [0.00839042]
Stock Position:  0.008390418514117865
Bond Position:  [-34.482755]


portfolio before change:  [-33.66501285]
curr_Stock_Price:  98.48899908199684
curr_Factors:  [98.48899908]
mat_Sqrt:  [[0.15]]
grads:  [-0.02750477]
Stock Position:  -0.02750477192140537
Bond Position:  [-30.95609539]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-33.72060968]
Stock Price:  100.22894599849614
PL:  [-33.94955568]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.50737181e-02]
 [ 4.06657375e-02]
 [-2.49881994e-02]
 [ 3.03049624e-02]
 [ 5.68706835e-03]
 [-1.41501821e-02]
 [-6.38562334e-03]
 [ 1.73791709e-03]
 [-1.46997066e-02]
 [ 2.12856853e-03]
 [-3.13828359e-03]
 [-6.48290661e-03]
 [ 6.82179751e-03]
 [ 1.60322594e-04]
 [ 8.05618249e-03]
 [ 2.07621496e-02]
 [ 1.00430497e-02]
 [ 5.19298405e-04]
 [-8.96222907e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.7311384]
curr_Stock_Price:  100.82276045798018
curr_Factors:  [100.82276046]
mat_Sqrt:  [[0.15]]
grads:  [-0.10049145]
Stock Position:  -0.10049145425106237
Bond Position:  [29.86296422]


portfolio before change:  [19.58605244]
curr_Stock_Price:  102.34082624416777
curr_Factors:  [102.34082624]
mat_Sqrt:  [[0.15]]
grads:  [0.27110492]
Stock Position:  0.27110491695921707
Bond Position:  [-8.15904876]


portfolio before change:  [19.37607429]
curr_Stock_Price:  101.57382382970698
curr_Factors:  [101.57382383]
mat_Sqrt:  [[0.15]]
grads:  [-0.166588]
Stock Position:  -0.16658799582807157
Bond Position:  [36.29705404]


portfolio before change:  [19.36256374]
curr_Stock_Price:  101.70940351462563
curr_Factors:  [101.70940351]
mat_Sqrt:  [[0.15]]
grads:  [0.20203308]
Stock Position:  0.2020330828319281
Bond Position:  [-1.1861006]


portfolio before change:  [19.51291136]
curr_Stock_Price:  102.45504463688066
curr_Factors:  [102.45504464]
mat_Sqrt:  [[0.15]]
grads:  [0.03791379]
Stock Position:  0.03791378899804855
Bond Position:  [15.62845241]


portfolio before change:  [19.55731821]
curr_Stock_Price:  103.52323794711587
curr_Factors:  [103.52323795]
mat_Sqrt:  [[0.15]]
grads:  [-0.09433455]
Stock Position:  -0.09433454739094023
Bond Position:  [29.32313601]


portfolio before change:  [19.52367165]
curr_Stock_Price:  103.95763096722186
curr_Factors:  [103.95763097]
mat_Sqrt:  [[0.15]]
grads:  [-0.04257082]
Stock Position:  -0.04257082229158622
Bond Position:  [23.94923348]


portfolio before change:  [19.54072751]
curr_Stock_Price:  103.69764524651099
curr_Factors:  [103.69764525]
mat_Sqrt:  [[0.15]]
grads:  [0.01158611]
Stock Position:  0.011586113947773178
Bond Position:  [18.33927477]


portfolio before change:  [19.5280016]
curr_Stock_Price:  102.20350310518687
curr_Factors:  [102.20350311]
mat_Sqrt:  [[0.15]]
grads:  [-0.09799804]
Stock Position:  -0.09799804380278039
Bond Position:  [29.54374497]


portfolio before change:  [19.46604198]
curr_Stock_Price:  102.91113436061377
curr_Factors:  [102.91113436]
mat_Sqrt:  [[0.15]]
grads:  [0.01419046]
Stock Position:  0.014190456856177699
Bond Position:  [18.00568597]


portfolio before change:  [19.46769503]
curr_Stock_Price:  102.71037014595298
curr_Factors:  [102.71037015]
mat_Sqrt:  [[0.15]]
grads:  [-0.02092189]
Stock Position:  -0.020921890583539167
Bond Position:  [21.61659015]


portfolio before change:  [19.50386461]
curr_Stock_Price:  101.23991209361104
curr_Factors:  [101.23991209]
mat_Sqrt:  [[0.15]]
grads:  [-0.04321938]
Stock Position:  -0.043219377392672786
Bond Position:  [23.87939058]


portfolio before change:  [19.48534085]
curr_Stock_Price:  101.80665688213516
curr_Factors:  [101.80665688]
mat_Sqrt:  [[0.15]]
grads:  [0.04547865]
Stock Position:  0.045478650087714845
Bond Position:  [14.85531153]


portfolio before change:  [19.47267289]
curr_Stock_Price:  101.44643832373453
curr_Factors:  [101.44643832]
mat_Sqrt:  [[0.15]]
grads:  [0.00106882]
Stock Position:  0.0010688172914953271
Bond Position:  [19.36424518]


portfolio before change:  [19.47355811]
curr_Stock_Price:  97.744729201155
curr_Factors:  [97.7447292]
mat_Sqrt:  [[0.15]]
grads:  [0.05370788]
Stock Position:  0.05370788325735637
Bond Position:  [14.2238956]


portfolio before change:  [19.39808933]
curr_Stock_Price:  96.273340159382
curr_Factors:  [96.27334016]
mat_Sqrt:  [[0.15]]
grads:  [0.13841433]
Stock Position:  0.1384143309510152
Bond Position:  [6.07247937]


portfolio before change:  [19.21350103]
curr_Stock_Price:  94.9287783937513
curr_Factors:  [94.92877839]
mat_Sqrt:  [[0.15]]
grads:  [0.06695366]
Stock Position:  0.06695366436176303
Bond Position:  [12.85767146]


portfolio before change:  [19.26266529]
curr_Stock_Price:  95.6150656119224
curr_Factors:  [95.61506561]
mat_Sqrt:  [[0.15]]
grads:  [0.00346199]
Stock Position:  0.0034619893664408763
Bond Position:  [18.93164695]


portfolio before change:  [19.26660793]
curr_Stock_Price:  95.38662333257224
curr_Factors:  [95.38662333]
mat_Sqrt:  [[0.15]]
grads:  [-0.05974819]
Stock Position:  -0.059748193831839935
Bond Position:  [24.96578639]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.31244948]
Stock Price:  94.7238530617593
PL:  [19.31244948]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.11488145e-02]
 [-7.65866773e-03]
 [-2.59094217e-02]
 [ 4.23003662e-02]
 [ 5.69768900e-03]
 [-9.93020466e-03]
 [ 1.47320822e-02]
 [ 7.66433210e-03]
 [-8.77473278e-04]
 [ 1.01561695e-02]
 [-4.25272386e-03]
 [-8.55545607e-04]
 [ 5.99245057e-03]
 [ 1.18197472e-04]
 [ 5.24167958e-05]
 [ 2.26875852e-02]
 [ 1.27981405e-03]
 [ 1.42937972e-02]
 [-1.56300281e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.21450081]
curr_Stock_Price:  100.5724601261874
curr_Factors:  [100.57246013]
mat_Sqrt:  [[0.15]]
grads:  [-0.07432543]
Stock Position:  -0.07432543031023231
Bond Position:  [21.68959218]


portfolio before change:  [14.2349713]
curr_Stock_Price:  100.3700070194774
curr_Factors:  [100.37000702]
mat_Sqrt:  [[0.15]]
grads:  [-0.05105778]
Stock Position:  -0.05105778487364601
Bond Position:  [19.35964152]


portfolio before change:  [14.17537874]
curr_Stock_Price:  101.63197072524984
curr_Factors:  [101.63197073]
mat_Sqrt:  [[0.15]]
grads:  [-0.17272948]
Stock Position:  -0.17272947831194624
Bond Position:  [31.73021602]


portfolio before change:  [14.05026143]
curr_Stock_Price:  102.40225530307893
curr_Factors:  [102.4022553]
mat_Sqrt:  [[0.15]]
grads:  [0.28200244]
Stock Position:  0.28200244105128225
Bond Position:  [-14.82742453]


portfolio before change:  [14.0145482]
curr_Stock_Price:  102.28876014596432
curr_Factors:  [102.28876015]
mat_Sqrt:  [[0.15]]
grads:  [0.03798459]
Stock Position:  0.037984593337228686
Bond Position:  [10.12915124]


portfolio before change:  [13.99898799]
curr_Stock_Price:  101.81244042086294
curr_Factors:  [101.81244042]
mat_Sqrt:  [[0.15]]
grads:  [-0.06620136]
Stock Position:  -0.06620136436792548
Bond Position:  [20.73911046]


portfolio before change:  [14.14244766]
curr_Stock_Price:  99.72374872792395
curr_Factors:  [99.72374873]
mat_Sqrt:  [[0.15]]
grads:  [0.09821388]
Stock Position:  0.0982138811585946
Bond Position:  [4.34819125]


portfolio before change:  [14.20091646]
curr_Stock_Price:  100.30800036559312
curr_Factors:  [100.30800037]
mat_Sqrt:  [[0.15]]
grads:  [0.05109555]
Stock Position:  0.05109554735226441
Bond Position:  [9.07562428]


portfolio before change:  [14.084753]
curr_Stock_Price:  97.99013396189932
curr_Factors:  [97.99013396]
mat_Sqrt:  [[0.15]]
grads:  [-0.00584982]
Stock Position:  -0.0058498218513439405
Bond Position:  [14.65797783]


portfolio before change:  [14.0891987]
curr_Stock_Price:  97.85666865073605
curr_Factors:  [97.85666865]
mat_Sqrt:  [[0.15]]
grads:  [0.0677078]
Stock Position:  0.0677077968687601
Bond Position:  [7.46353926]


portfolio before change:  [14.14076221]
curr_Stock_Price:  98.59066660845814
curr_Factors:  [98.59066661]
mat_Sqrt:  [[0.15]]
grads:  [-0.02835149]
Stock Position:  -0.028351492431567822
Bond Position:  [16.93595474]


portfolio before change:  [14.14267494]
curr_Stock_Price:  98.67255955586828
curr_Factors:  [98.67255956]
mat_Sqrt:  [[0.15]]
grads:  [-0.00570364]
Stock Position:  -0.0057036373814581265
Bond Position:  [14.70546744]


portfolio before change:  [14.13165839]
curr_Stock_Price:  101.24870105745228
curr_Factors:  [101.24870106]
mat_Sqrt:  [[0.15]]
grads:  [0.03994967]
Stock Position:  0.03994967043758457
Bond Position:  [10.08680615]


portfolio before change:  [14.19371598]
curr_Stock_Price:  102.73896560006942
curr_Factors:  [102.7389656]
mat_Sqrt:  [[0.15]]
grads:  [0.00078798]
Stock Position:  0.0007879831490593496
Bond Position:  [14.11275941]


portfolio before change:  [14.19701659]
curr_Stock_Price:  102.44958723883207
curr_Factors:  [102.44958724]
mat_Sqrt:  [[0.15]]
grads:  [0.00034945]
Stock Position:  0.00034944530500480644
Bond Position:  [14.16121606]


portfolio before change:  [14.20095482]
curr_Stock_Price:  103.58707143100597
curr_Factors:  [103.58707143]
mat_Sqrt:  [[0.15]]
grads:  [0.15125057]
Stock Position:  0.15125056809654924
Bond Position:  [-1.46664858]


portfolio before change:  [14.08194024]
curr_Stock_Price:  102.80262566325496
curr_Factors:  [102.80262566]
mat_Sqrt:  [[0.15]]
grads:  [0.00853209]
Stock Position:  0.008532093640835377
Bond Position:  [13.20481862]


portfolio before change:  [14.1115964]
curr_Stock_Price:  105.89149658159958
curr_Factors:  [105.89149658]
mat_Sqrt:  [[0.15]]
grads:  [0.09529198]
Stock Position:  0.09529198116733727
Bond Position:  [4.0209859]


portfolio before change:  [14.000351]
curr_Stock_Price:  104.7135300168545
curr_Factors:  [104.71353002]
mat_Sqrt:  [[0.15]]
grads:  [-0.10420019]
Stock Position:  -0.10420018752413485
Bond Position:  [24.91152047]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.82199397]
Stock Price:  106.48498261514207
PL:  [7.33701135]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.31774733e-03]
 [ 2.08114238e-03]
 [-5.13086093e-03]
 [-7.05121842e-03]
 [ 6.47003164e-03]
 [-1.03239796e-02]
 [ 1.37287026e-02]
 [-2.06593504e-02]
 [-1.15806888e-03]
 [ 9.64383183e-03]
 [-1.10056986e-02]
 [ 7.28559969e-03]
 [ 6.01900700e-03]
 [-1.45451922e-03]
 [ 8.24599399e-03]
 [ 1.92025088e-02]
 [ 6.29901206e-03]
 [ 3.99778871e-03]
 [-5.10854307e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.72228533]
curr_Stock_Price:  99.84937785242279
curr_Factors:  [99.84937785]
mat_Sqrt:  [[0.15]]
grads:  [0.01545165]
Stock Position:  0.015451648866444413
Bond Position:  [-3.26512285]


portfolio before change:  [-1.70963192]
curr_Stock_Price:  100.72111586957882
curr_Factors:  [100.72111587]
mat_Sqrt:  [[0.15]]
grads:  [0.01387428]
Stock Position:  0.013874282515919963
Bond Position:  [-3.10706514]


portfolio before change:  [-1.71707569]
curr_Stock_Price:  100.24059309746313
curr_Factors:  [100.2405931]
mat_Sqrt:  [[0.15]]
grads:  [-0.03420574]
Stock Position:  -0.034205739531537986
Bond Position:  [1.71172793]


portfolio before change:  [-1.72631397]
curr_Stock_Price:  100.52318481660255
curr_Factors:  [100.52318482]
mat_Sqrt:  [[0.15]]
grads:  [-0.04700812]
Stock Position:  -0.04700812277730974
Bond Position:  [2.99909225]


portfolio before change:  [-1.70084703]
curr_Stock_Price:  99.99738064347561
curr_Factors:  [99.99738064]
mat_Sqrt:  [[0.15]]
grads:  [0.04313354]
Stock Position:  0.043133544285229725
Bond Position:  [-6.01408848]


portfolio before change:  [-1.7304044]
curr_Stock_Price:  99.34698987009246
curr_Factors:  [99.34698987]
mat_Sqrt:  [[0.15]]
grads:  [-0.06882653]
Stock Position:  -0.0688265305837228
Bond Position:  [5.10730424]


portfolio before change:  [-1.68648126]
curr_Stock_Price:  98.72737190753297
curr_Factors:  [98.72737191]
mat_Sqrt:  [[0.15]]
grads:  [0.09152468]
Stock Position:  0.09152468429997343
Bond Position:  [-10.72247281]


portfolio before change:  [-1.64221488]
curr_Stock_Price:  99.24031919712287
curr_Factors:  [99.2403192]
mat_Sqrt:  [[0.15]]
grads:  [-0.137729]
Stock Position:  -0.13772900254485365
Bond Position:  [12.0260553]


portfolio before change:  [-1.47999461]
curr_Stock_Price:  98.0843290095041
curr_Factors:  [98.08432901]
mat_Sqrt:  [[0.15]]
grads:  [-0.00772046]
Stock Position:  -0.007720459189968016
Bond Position:  [-0.72273855]


portfolio before change:  [-1.47435]
curr_Stock_Price:  97.3297986045519
curr_Factors:  [97.3297986]
mat_Sqrt:  [[0.15]]
grads:  [0.06429221]
Stock Position:  0.06429221218814547
Bond Position:  [-7.73189806]


portfolio before change:  [-1.58745098]
curr_Stock_Price:  95.60069694781588
curr_Factors:  [95.60069695]
mat_Sqrt:  [[0.15]]
grads:  [-0.07337132]
Stock Position:  -0.07337132391698263
Bond Position:  [5.42689872]


portfolio before change:  [-1.67757545]
curr_Stock_Price:  96.84752416360871
curr_Factors:  [96.84752416]
mat_Sqrt:  [[0.15]]
grads:  [0.04857066]
Stock Position:  0.04857066460624412
Bond Position:  [-6.38152407]


portfolio before change:  [-1.68254284]
curr_Stock_Price:  96.77810343348112
curr_Factors:  [96.77810343]
mat_Sqrt:  [[0.15]]
grads:  [0.04012671]
Stock Position:  0.04012671336563273
Bond Position:  [-5.56593006]


portfolio before change:  [-1.72322177]
curr_Stock_Price:  95.79902335516243
curr_Factors:  [95.79902336]
mat_Sqrt:  [[0.15]]
grads:  [-0.00969679]
Stock Position:  -0.0096967948100739
Bond Position:  [-0.79427829]


portfolio before change:  [-1.733596]
curr_Stock_Price:  96.84840548887408
curr_Factors:  [96.84840549]
mat_Sqrt:  [[0.15]]
grads:  [0.05497329]
Stock Position:  0.05497329325951118
Bond Position:  [-7.0576718]


portfolio before change:  [-1.71371714]
curr_Stock_Price:  97.24211485882778
curr_Factors:  [97.24211486]
mat_Sqrt:  [[0.15]]
grads:  [0.12801673]
Stock Position:  0.12801672509952675
Bond Position:  [-14.16233423]


portfolio before change:  [-1.62224266]
curr_Stock_Price:  97.98432649648863
curr_Factors:  [97.9843265]
mat_Sqrt:  [[0.15]]
grads:  [0.04199341]
Stock Position:  0.041993413706315985
Bond Position:  [-5.73693902]


portfolio before change:  [-1.61994309]
curr_Stock_Price:  98.0732448806421
curr_Factors:  [98.07324488]
mat_Sqrt:  [[0.15]]
grads:  [0.02665192]
Stock Position:  0.02665192470828982
Bond Position:  [-4.23378383]


portfolio before change:  [-1.57908173]
curr_Stock_Price:  99.64611232180948
curr_Factors:  [99.64611232]
mat_Sqrt:  [[0.15]]
grads:  [-0.03405695]
Stock Position:  -0.03405695379514248
Bond Position:  [1.81456132]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.5610196]
Stock Price:  99.12908336632444
PL:  [-1.5610196]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.55530487e-03]
 [-9.79428043e-03]
 [-9.39219170e-03]
 [-8.27720871e-03]
 [ 2.26101887e-03]
 [-9.85452870e-03]
 [ 1.13168406e-02]
 [-2.47392961e-02]
 [ 2.31660544e-03]
 [ 8.27456322e-03]
 [-7.29877409e-03]
 [ 3.43640978e-03]
 [ 5.43449670e-03]
 [-1.15997399e-03]
 [ 8.29694272e-03]
 [ 1.89935539e-02]
 [ 6.77726773e-03]
 [ 5.24344165e-03]
 [-4.41501511e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.62850415]
curr_Stock_Price:  99.26379817685796
curr_Factors:  [99.26379818]
mat_Sqrt:  [[0.15]]
grads:  [0.01703537]
Stock Position:  0.017035365791381367
Bond Position:  [-16.31949926]


portfolio before change:  [-14.61965467]
curr_Stock_Price:  100.02279948948883
curr_Factors:  [100.02279949]
mat_Sqrt:  [[0.15]]
grads:  [-0.0652952]
Stock Position:  -0.06529520286374835
Bond Position:  [-8.08864569]


portfolio before change:  [-14.49316093]
curr_Stock_Price:  98.05456679457713
curr_Factors:  [98.05456679]
mat_Sqrt:  [[0.15]]
grads:  [-0.06261461]
Stock Position:  -0.06261461136584455
Bond Position:  [-8.35351234]


portfolio before change:  [-14.48959476]
curr_Stock_Price:  97.96425537129312
curr_Factors:  [97.96425537]
mat_Sqrt:  [[0.15]]
grads:  [-0.05518139]
Stock Position:  -0.055181391421299485
Bond Position:  [-9.08379084]


portfolio before change:  [-14.5276953]
curr_Stock_Price:  98.61355605993607
curr_Factors:  [98.61355606]
mat_Sqrt:  [[0.15]]
grads:  [0.01507346]
Stock Position:  0.015073459126574186
Bond Position:  [-16.01414271]


portfolio before change:  [-14.50779038]
curr_Stock_Price:  100.19971865127536
curr_Factors:  [100.19971865]
mat_Sqrt:  [[0.15]]
grads:  [-0.06569686]
Stock Position:  -0.06569685801894742
Bond Position:  [-7.92498369]


portfolio before change:  [-14.52643014]
curr_Stock_Price:  100.45328115171222
curr_Factors:  [100.45328115]
mat_Sqrt:  [[0.15]]
grads:  [0.0754456]
Stock Position:  0.07544560386394789
Bond Position:  [-22.10518859]


portfolio before change:  [-14.6437571]
curr_Stock_Price:  98.97141910413929
curr_Factors:  [98.9714191]
mat_Sqrt:  [[0.15]]
grads:  [-0.16492864]
Stock Position:  -0.16492864041395494
Bond Position:  [1.67946449]


portfolio before change:  [-14.20702689]
curr_Stock_Price:  96.32597020509027
curr_Factors:  [96.32597021]
mat_Sqrt:  [[0.15]]
grads:  [0.01544404]
Stock Position:  0.015444036275531106
Bond Position:  [-15.69468867]


portfolio before change:  [-14.2088178]
curr_Stock_Price:  96.46409826190974
curr_Factors:  [96.46409826]
mat_Sqrt:  [[0.15]]
grads:  [0.05516375]
Stock Position:  0.05516375483328895
Bond Position:  [-19.53013967]


portfolio before change:  [-14.18104047]
curr_Stock_Price:  97.05616240374405
curr_Factors:  [97.0561624]
mat_Sqrt:  [[0.15]]
grads:  [-0.04865849]
Stock Position:  -0.048658493956023334
Bond Position:  [-9.45843377]


portfolio before change:  [-14.21144204]
curr_Stock_Price:  97.63235507458977
curr_Factors:  [97.63235507]
mat_Sqrt:  [[0.15]]
grads:  [0.0229094]
Stock Position:  0.0229093985203202
Bond Position:  [-16.44814057]


portfolio before change:  [-14.20799146]
curr_Stock_Price:  97.96248687123203
curr_Factors:  [97.96248687]
mat_Sqrt:  [[0.15]]
grads:  [0.03622998]
Stock Position:  0.03622997802732072
Bond Position:  [-17.75717021]


portfolio before change:  [-14.24203186]
curr_Stock_Price:  97.14546891300462
curr_Factors:  [97.14546891]
mat_Sqrt:  [[0.15]]
grads:  [-0.00773316]
Stock Position:  -0.007733159926757709
Bond Position:  [-13.49079041]


portfolio before change:  [-14.23960275]
curr_Stock_Price:  96.3951641922103
curr_Factors:  [96.39516419]
mat_Sqrt:  [[0.15]]
grads:  [0.05531295]
Stock Position:  0.05531295143449109
Bond Position:  [-19.57150378]


portfolio before change:  [-14.19071185]
curr_Stock_Price:  97.36752937540962
curr_Factors:  [97.36752938]
mat_Sqrt:  [[0.15]]
grads:  [0.12662369]
Stock Position:  0.12662369294856263
Bond Position:  [-26.51974799]


portfolio before change:  [-14.20300168]
curr_Stock_Price:  97.32283735481357
curr_Factors:  [97.32283735]
mat_Sqrt:  [[0.15]]
grads:  [0.04518178]
Stock Position:  0.04518178484147181
Bond Position:  [-18.60022118]


portfolio before change:  [-14.15161618]
curr_Stock_Price:  98.56307463192007
curr_Factors:  [98.56307463]
mat_Sqrt:  [[0.15]]
grads:  [0.03495628]
Stock Position:  0.03495627763506934
Bond Position:  [-17.59701439]


portfolio before change:  [-14.12902556]
curr_Stock_Price:  99.33519428150424
curr_Factors:  [99.33519428]
mat_Sqrt:  [[0.15]]
grads:  [-0.02943343]
Stock Position:  -0.029433434091269424
Bond Position:  [-11.20524967]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.2037141]
Stock Price:  101.77754866090596
PL:  [-15.98126276]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.42462122e-02]
 [-1.04492884e-02]
 [-8.37107785e-03]
 [-1.71862537e-02]
 [-3.54022115e-03]
 [-1.05904271e-02]
 [ 1.44472440e-02]
 [-1.48341092e-02]
 [-1.98604613e-03]
 [ 8.80115113e-03]
 [-4.16702899e-03]
 [-1.24139057e-03]
 [ 4.96799952e-03]
 [-9.24078637e-04]
 [ 3.40814557e-03]
 [ 1.83661344e-02]
 [ 4.51009348e-03]
 [ 7.16425258e-03]
 [-5.37890858e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.54357826]
curr_Stock_Price:  100.72350669689239
curr_Factors:  [100.7235067]
mat_Sqrt:  [[0.15]]
grads:  [-0.09497475]
Stock Position:  -0.09497474775960038
Bond Position:  [27.1097679]


portfolio before change:  [17.64780635]
curr_Stock_Price:  99.69744658727919
curr_Factors:  [99.69744659]
mat_Sqrt:  [[0.15]]
grads:  [-0.06966192]
Stock Position:  -0.06966192282134744
Bond Position:  [24.59292218]


portfolio before change:  [17.7508269]
curr_Stock_Price:  98.30685119079335
curr_Factors:  [98.30685119]
mat_Sqrt:  [[0.15]]
grads:  [-0.05580719]
Stock Position:  -0.05580718565611899
Bond Position:  [23.23705559]


portfolio before change:  [17.71694786]
curr_Stock_Price:  99.01803252928269
curr_Factors:  [99.01803253]
mat_Sqrt:  [[0.15]]
grads:  [-0.11457502]
Stock Position:  -0.11457502483560025
Bond Position:  [29.06194139]


portfolio before change:  [17.92521114]
curr_Stock_Price:  97.26375068720813
curr_Factors:  [97.26375069]
mat_Sqrt:  [[0.15]]
grads:  [-0.02360147]
Stock Position:  -0.02360147435673831
Bond Position:  [20.22077905]


portfolio before change:  [17.89213617]
curr_Stock_Price:  98.8793614413183
curr_Factors:  [98.87936144]
mat_Sqrt:  [[0.15]]
grads:  [-0.07060285]
Stock Position:  -0.07060284719493233
Bond Position:  [24.87330061]


portfolio before change:  [17.85732802]
curr_Stock_Price:  99.46046044690787
curr_Factors:  [99.46046045]
mat_Sqrt:  [[0.15]]
grads:  [0.09631496]
Stock Position:  0.09631496024445704
Bond Position:  [8.27779773]


portfolio before change:  [17.86764442]
curr_Stock_Price:  99.54608255554088
curr_Factors:  [99.54608256]
mat_Sqrt:  [[0.15]]
grads:  [-0.09889406]
Stock Position:  -0.09889406103814911
Bond Position:  [27.71216079]


portfolio before change:  [17.94051801]
curr_Stock_Price:  98.87926114935283
curr_Factors:  [98.87926115]
mat_Sqrt:  [[0.15]]
grads:  [-0.01324031]
Stock Position:  -0.013240307551367424
Bond Position:  [19.24970983]


portfolio before change:  [17.93966897]
curr_Stock_Price:  99.30689976016566
curr_Factors:  [99.30689976]
mat_Sqrt:  [[0.15]]
grads:  [0.05867434]
Stock Position:  0.058674340840987216
Bond Position:  [12.11290208]


portfolio before change:  [17.9041475]
curr_Stock_Price:  98.64988215022883
curr_Factors:  [98.64988215]
mat_Sqrt:  [[0.15]]
grads:  [-0.02778019]
Stock Position:  -0.02778019325064657
Bond Position:  [20.64466029]


portfolio before change:  [17.90601334]
curr_Stock_Price:  98.76852659556981
curr_Factors:  [98.7685266]
mat_Sqrt:  [[0.15]]
grads:  [-0.00827594]
Stock Position:  -0.008275937137741177
Bond Position:  [18.72341546]


portfolio before change:  [17.91088989]
curr_Stock_Price:  98.74495083114344
curr_Factors:  [98.74495083]
mat_Sqrt:  [[0.15]]
grads:  [0.03312]
Stock Position:  0.03311999679458227
Bond Position:  [14.64045744]


portfolio before change:  [17.90304207]
curr_Stock_Price:  98.39747510923594
curr_Factors:  [98.39747511]
mat_Sqrt:  [[0.15]]
grads:  [-0.00616052]
Stock Position:  -0.00616052424625059
Bond Position:  [18.5092221]


portfolio before change:  [17.896345]
curr_Stock_Price:  100.23578432897774
curr_Factors:  [100.23578433]
mat_Sqrt:  [[0.15]]
grads:  [0.02272097]
Stock Position:  0.022720970478550824
Bond Position:  [15.61889071]


portfolio before change:  [17.90036455]
curr_Stock_Price:  100.24081633325751
curr_Factors:  [100.24081633]
mat_Sqrt:  [[0.15]]
grads:  [0.1224409]
Stock Position:  0.1224408958354824
Bond Position:  [5.6267892]


portfolio before change:  [17.86170086]
curr_Stock_Price:  99.91355179019885
curr_Factors:  [99.91355179]
mat_Sqrt:  [[0.15]]
grads:  [0.03006729]
Stock Position:  0.030067289896204465
Bond Position:  [14.85757113]


portfolio before change:  [17.84674484]
curr_Stock_Price:  99.29258209751977
curr_Factors:  [99.2925821]
mat_Sqrt:  [[0.15]]
grads:  [0.04776168]
Stock Position:  0.04776168383505328
Bond Position:  [13.10436393]


portfolio before change:  [17.9205916]
curr_Stock_Price:  100.77013168161399
curr_Factors:  [100.77013168]
mat_Sqrt:  [[0.15]]
grads:  [-0.03585939]
Stock Position:  -0.03585939050805783
Bond Position:  [21.5341471]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.87111251]
Stock Price:  102.30008779006796
PL:  [15.57102472]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.55999907e-02]
 [ 4.03994515e-02]
 [-5.24918103e-02]
 [ 7.45014262e-02]
 [ 5.69085332e-03]
 [-1.23478242e-02]
 [ 3.83124402e-03]
 [ 9.21421720e-03]
 [-1.47089856e-02]
 [ 2.18264354e-03]
 [-3.02435840e-03]
 [-6.41801962e-03]
 [ 5.89552242e-03]
 [ 2.32737398e-04]
 [ 3.33869999e-04]
 [ 1.87303661e-02]
 [ 3.43305621e-03]
 [ 9.75179458e-03]
 [-5.24767435e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.12237053]
curr_Stock_Price:  100.88588330336586
curr_Factors:  [100.8858833]
mat_Sqrt:  [[0.15]]
grads:  [-0.10399994]
Stock Position:  -0.10399993803124533
Bond Position:  [31.61449614]


portfolio before change:  [20.98004544]
curr_Stock_Price:  102.33040047447733
curr_Factors:  [102.33040047]
mat_Sqrt:  [[0.15]]
grads:  [0.26932968]
Stock Position:  0.2693296764054331
Bond Position:  [-6.58056821]


portfolio before change:  [21.26064803]
curr_Stock_Price:  103.3783649713406
curr_Factors:  [103.37836497]
mat_Sqrt:  [[0.15]]
grads:  [-0.3499454]
Stock Position:  -0.3499454017189236
Bond Position:  [57.43743149]


portfolio before change:  [20.96660279]
curr_Stock_Price:  104.25966359280615
curr_Factors:  [104.25966359]
mat_Sqrt:  [[0.15]]
grads:  [0.49667617]
Stock Position:  0.4966761748390394
Bond Position:  [-30.81668812]


portfolio before change:  [20.03315326]
curr_Stock_Price:  102.39578439454985
curr_Factors:  [102.39578439]
mat_Sqrt:  [[0.15]]
grads:  [0.03793902]
Stock Position:  0.03793902215283506
Bond Position:  [16.14835733]


portfolio before change:  [20.05305826]
curr_Stock_Price:  102.81401878056211
curr_Factors:  [102.81401878]
mat_Sqrt:  [[0.15]]
grads:  [-0.08231883]
Stock Position:  -0.08231882821584938
Bond Position:  [28.51658781]


portfolio before change:  [20.1732285]
curr_Stock_Price:  101.4408189340654
curr_Factors:  [101.44081893]
mat_Sqrt:  [[0.15]]
grads:  [0.02554163]
Stock Position:  0.025541626806226014
Bond Position:  [17.58226496]


portfolio before change:  [20.19190585]
curr_Stock_Price:  101.99995472828597
curr_Factors:  [101.99995473]
mat_Sqrt:  [[0.15]]
grads:  [0.06142811]
Stock Position:  0.061428114662987955
Bond Position:  [13.92624094]


portfolio before change:  [20.10960963]
curr_Stock_Price:  100.60355474324483
curr_Factors:  [100.60355474]
mat_Sqrt:  [[0.15]]
grads:  [-0.0980599]
Stock Position:  -0.09805990407133999
Bond Position:  [29.97478456]


portfolio before change:  [20.00729603]
curr_Stock_Price:  101.72336241274314
curr_Factors:  [101.72336241]
mat_Sqrt:  [[0.15]]
grads:  [0.01455096]
Stock Position:  0.014550956931870316
Bond Position:  [18.52712376]


portfolio before change:  [20.00591046]
curr_Stock_Price:  101.30978620981992
curr_Factors:  [101.30978621]
mat_Sqrt:  [[0.15]]
grads:  [-0.02016239]
Stock Position:  -0.02016238931784753
Bond Position:  [22.04855781]


portfolio before change:  [20.01356839]
curr_Stock_Price:  101.20339514088913
curr_Factors:  [101.20339514]
mat_Sqrt:  [[0.15]]
grads:  [-0.0427868]
Stock Position:  -0.04278679745099656
Bond Position:  [24.34373755]


portfolio before change:  [20.02050671]
curr_Stock_Price:  101.1834911702107
curr_Factors:  [101.18349117]
mat_Sqrt:  [[0.15]]
grads:  [0.03930348]
Stock Position:  0.03930348282989902
Bond Position:  [16.0436431]


portfolio before change:  [20.04274964]
curr_Stock_Price:  101.64735638475823
curr_Factors:  [101.64735638]
mat_Sqrt:  [[0.15]]
grads:  [0.00155158]
Stock Position:  0.0015515826562246277
Bond Position:  [19.88503536]


portfolio before change:  [20.04778973]
curr_Stock_Price:  101.69132162666632
curr_Factors:  [101.69132163]
mat_Sqrt:  [[0.15]]
grads:  [0.0022258]
Stock Position:  0.002225799991985277
Bond Position:  [19.82144519]


portfolio before change:  [20.04971652]
curr_Stock_Price:  100.33037402921197
curr_Factors:  [100.33037403]
mat_Sqrt:  [[0.15]]
grads:  [0.12486911]
Stock Position:  0.12486910711611522
Bond Position:  [7.5215523]


portfolio before change:  [20.09023523]
curr_Stock_Price:  100.63980272431971
curr_Factors:  [100.63980272]
mat_Sqrt:  [[0.15]]
grads:  [0.02288704]
Stock Position:  0.02288704141857972
Bond Position:  [17.78688789]


portfolio before change:  [20.09678051]
curr_Stock_Price:  100.73147062042192
curr_Factors:  [100.73147062]
mat_Sqrt:  [[0.15]]
grads:  [0.06501196]
Stock Position:  0.06501196387733303
Bond Position:  [13.54802978]


portfolio before change:  [20.06979704]
curr_Stock_Price:  100.26431199204053
curr_Factors:  [100.26431199]
mat_Sqrt:  [[0.15]]
grads:  [-0.0349845]
Stock Position:  -0.03498449568717899
Bond Position:  [23.57749343]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.0630326]
Stock Price:  100.62617374393255
PL:  [19.43685886]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.12179308e-02]
 [-4.54571150e-03]
 [-4.58582554e-03]
 [-2.27749440e-02]
 [ 6.53730834e-03]
 [-1.07438988e-02]
 [ 1.47005471e-02]
 [-1.84048621e-02]
 [-1.54093057e-02]
 [ 2.22696053e-03]
 [-3.06269440e-03]
 [-5.66030269e-03]
 [ 4.82786279e-03]
 [-3.49078363e-05]
 [ 5.56665698e-03]
 [ 1.70833049e-02]
 [ 5.75207872e-03]
 [ 4.14256213e-03]
 [-5.30378807e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.28596846]
curr_Stock_Price:  100.57570274936923
curr_Factors:  [100.57570275]
mat_Sqrt:  [[0.15]]
grads:  [-0.07478621]
Stock Position:  -0.07478620509840296
Bond Position:  [21.80764359]


portfolio before change:  [14.41378561]
curr_Stock_Price:  98.93951113492537
curr_Factors:  [98.93951113]
mat_Sqrt:  [[0.15]]
grads:  [-0.03030474]
Stock Position:  -0.030304743363860707
Bond Position:  [17.41212211]


portfolio before change:  [14.40935643]
curr_Stock_Price:  99.22932573840721
curr_Factors:  [99.22932574]
mat_Sqrt:  [[0.15]]
grads:  [-0.03057217]
Stock Position:  -0.030572170287913442
Bond Position:  [17.44301227]


portfolio before change:  [14.40397721]
curr_Stock_Price:  99.54793311870404
curr_Factors:  [99.54793312]
mat_Sqrt:  [[0.15]]
grads:  [-0.15183296]
Stock Position:  -0.1518329600495808
Bond Position:  [29.51863456]


portfolio before change:  [14.27876511]
curr_Stock_Price:  100.42121305171744
curr_Factors:  [100.42121305]
mat_Sqrt:  [[0.15]]
grads:  [0.04358206]
Stock Position:  0.04358205560705419
Bond Position:  [9.90220222]


portfolio before change:  [14.19027998]
curr_Stock_Price:  98.33409284716755
curr_Factors:  [98.33409285]
mat_Sqrt:  [[0.15]]
grads:  [-0.07162599]
Stock Position:  -0.07162599170001822
Bond Position:  [21.2335569]


portfolio before change:  [14.09273313]
curr_Stock_Price:  99.77010660916844
curr_Factors:  [99.77010661]
mat_Sqrt:  [[0.15]]
grads:  [0.09800365]
Stock Position:  0.09800364739857381
Bond Position:  [4.31489878]


portfolio before change:  [14.05620418]
curr_Stock_Price:  99.38636774486048
curr_Factors:  [99.38636774]
mat_Sqrt:  [[0.15]]
grads:  [-0.12269908]
Stock Position:  -0.1226990808551085
Bond Position:  [26.25082015]


portfolio before change:  [13.90207748]
curr_Stock_Price:  100.6959963127897
curr_Factors:  [100.69599631]
mat_Sqrt:  [[0.15]]
grads:  [-0.1027287]
Stock Position:  -0.10272870445720275
Bond Position:  [24.24644673]


portfolio before change:  [13.77068437]
curr_Stock_Price:  102.03403991106127
curr_Factors:  [102.03403991]
mat_Sqrt:  [[0.15]]
grads:  [0.0148464]
Stock Position:  0.014846403534212608
Bond Position:  [12.25584583]


portfolio before change:  [13.77343765]
curr_Stock_Price:  102.01308794428546
curr_Factors:  [102.01308794]
mat_Sqrt:  [[0.15]]
grads:  [-0.02041796]
Stock Position:  -0.020417962681953446
Bond Position:  [15.85633707]


portfolio before change:  [13.80192883]
curr_Stock_Price:  100.81186140633879
curr_Factors:  [100.81186141]
mat_Sqrt:  [[0.15]]
grads:  [-0.03773535]
Stock Position:  -0.03773535125930276
Bond Position:  [17.60609983]


portfolio before change:  [13.82808772]
curr_Stock_Price:  100.23529818891846
curr_Factors:  [100.23529819]
mat_Sqrt:  [[0.15]]
grads:  [0.03218575]
Stock Position:  0.032185751962302445
Bond Position:  [10.60193927]


portfolio before change:  [13.85547458]
curr_Stock_Price:  101.00383839705248
curr_Factors:  [101.0038384]
mat_Sqrt:  [[0.15]]
grads:  [-0.00023272]
Stock Position:  -0.00023271890878018547
Bond Position:  [13.87898008]


portfolio before change:  [13.85929694]
curr_Stock_Price:  99.49049376422168
curr_Factors:  [99.49049376]
mat_Sqrt:  [[0.15]]
grads:  [0.03711105]
Stock Position:  0.03711104654618182
Bond Position:  [10.1671006]


portfolio before change:  [13.8337972]
curr_Stock_Price:  98.7348741496332
curr_Factors:  [98.73487415]
mat_Sqrt:  [[0.15]]
grads:  [0.1138887]
Stock Position:  0.11388869939084982
Bond Position:  [2.5890108]


portfolio before change:  [13.82310084]
curr_Stock_Price:  98.63527085358668
curr_Factors:  [98.63527085]
mat_Sqrt:  [[0.15]]
grads:  [0.03834719]
Stock Position:  0.038347191485427305
Bond Position:  [10.04071522]


portfolio before change:  [13.8062423]
curr_Stock_Price:  98.13017432613636
curr_Factors:  [98.13017433]
mat_Sqrt:  [[0.15]]
grads:  [0.02761708]
Stock Position:  0.027617080879544724
Bond Position:  [11.09617334]


portfolio before change:  [13.78589555]
curr_Stock_Price:  97.2929698456457
curr_Factors:  [97.29296985]
mat_Sqrt:  [[0.15]]
grads:  [-0.03535859]
Stock Position:  -0.03535858714042269
Bond Position:  [17.2260375]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.74593987]
Stock Price:  98.54479388967512
PL:  [13.74593987]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-8.75849802e-03]
 [ 4.26095939e-02]
 [-5.31514774e-02]
 [ 6.35624492e-02]
 [ 5.44597643e-03]
 [-1.54254556e-02]
 [-3.38259807e-03]
 [-3.32592092e-03]
 [-3.01997431e-03]
 [ 2.37460173e-04]
 [-3.63527787e-03]
 [ 1.21345398e-02]
 [ 1.08468799e-02]
 [-2.42895903e-03]
 [ 9.65893774e-03]
 [ 2.15475073e-02]
 [ 5.55223342e-03]
 [ 1.45566896e-02]
 [-1.60179635e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.74286226]
curr_Stock_Price:  100.46031718833763
curr_Factors:  [100.46031719]
mat_Sqrt:  [[0.15]]
grads:  [-0.05838999]
Stock Position:  -0.058389986832880006
Bond Position:  [17.60873886]


portfolio before change:  [11.63301822]
curr_Stock_Price:  102.41693310657433
curr_Factors:  [102.41693311]
mat_Sqrt:  [[0.15]]
grads:  [0.28406396]
Stock Position:  0.2840639590805158
Bond Position:  [-17.45994127]


portfolio before change:  [11.91446592]
curr_Stock_Price:  103.42309113147451
curr_Factors:  [103.42309113]
mat_Sqrt:  [[0.15]]
grads:  [-0.35434318]
Stock Position:  -0.35434318288266514
Bond Position:  [48.56173322]


portfolio before change:  [11.85375672]
curr_Stock_Price:  103.62868602269175
curr_Factors:  [103.62868602]
mat_Sqrt:  [[0.15]]
grads:  [0.42374966]
Stock Position:  0.42374966123298813
Bond Position:  [-32.05886387]


portfolio before change:  [11.7855947]
curr_Stock_Price:  103.486747711772
curr_Factors:  [103.48674771]
mat_Sqrt:  [[0.15]]
grads:  [0.03630651]
Stock Position:  0.03630650953334048
Bond Position:  [8.0283521]


portfolio before change:  [11.80714598]
curr_Stock_Price:  104.02505193986505
curr_Factors:  [104.02505194]
mat_Sqrt:  [[0.15]]
grads:  [-0.10283637]
Stock Position:  -0.10283637066272894
Bond Position:  [22.50470478]


portfolio before change:  [11.90731238]
curr_Stock_Price:  103.105732125398
curr_Factors:  [103.10573213]
mat_Sqrt:  [[0.15]]
grads:  [-0.02255065]
Stock Position:  -0.02255065380878137
Bond Position:  [14.23241405]


portfolio before change:  [11.87501518]
curr_Stock_Price:  104.69574115052954
curr_Factors:  [104.69574115]
mat_Sqrt:  [[0.15]]
grads:  [-0.02217281]
Stock Position:  -0.0221728061618925
Bond Position:  [14.19641355]


portfolio before change:  [11.90932414]
curr_Stock_Price:  103.30848270060413
curr_Factors:  [103.3084827]
mat_Sqrt:  [[0.15]]
grads:  [-0.02013316]
Stock Position:  -0.020133162077251
Bond Position:  [13.98925057]


portfolio before change:  [11.8935773]
curr_Stock_Price:  104.26434809728448
curr_Factors:  [104.2643481]
mat_Sqrt:  [[0.15]]
grads:  [0.00158307]
Stock Position:  0.0015830678231149842
Bond Position:  [11.72851976]


portfolio before change:  [11.89884345]
curr_Stock_Price:  105.73848313287579
curr_Factors:  [105.73848313]
mat_Sqrt:  [[0.15]]
grads:  [-0.02423519]
Stock Position:  -0.0242351858134232
Bond Position:  [14.46143524]


portfolio before change:  [11.90991284]
curr_Stock_Price:  105.43093095670554
curr_Factors:  [105.43093096]
mat_Sqrt:  [[0.15]]
grads:  [0.08089693]
Stock Position:  0.08089693217287244
Bond Position:  [3.38087397]


portfolio before change:  [11.84189044]
curr_Stock_Price:  104.57962886027809
curr_Factors:  [104.57962886]
mat_Sqrt:  [[0.15]]
grads:  [0.07231253]
Stock Position:  0.07231253279103972
Bond Position:  [4.2794726]


portfolio before change:  [11.88306671]
curr_Stock_Price:  105.13425290152517
curr_Factors:  [105.1342529]
mat_Sqrt:  [[0.15]]
grads:  [-0.01619306]
Stock Position:  -0.016193060194258455
Bond Position:  [13.585512]


portfolio before change:  [11.88954708]
curr_Stock_Price:  104.94382799251737
curr_Factors:  [104.94382799]
mat_Sqrt:  [[0.15]]
grads:  [0.06439292]
Stock Position:  0.06439291827999181
Bond Position:  [5.13190774]


portfolio before change:  [11.89566933]
curr_Stock_Price:  105.01897787368694
curr_Factors:  [105.01897787]
mat_Sqrt:  [[0.15]]
grads:  [0.14365005]
Stock Position:  0.14365004872254905
Bond Position:  [-3.19031195]


portfolio before change:  [11.8663443]
curr_Stock_Price:  104.82038860611878
curr_Factors:  [104.82038861]
mat_Sqrt:  [[0.15]]
grads:  [0.03701489]
Stock Position:  0.03701488947211312
Bond Position:  [7.9864292]


portfolio before change:  [11.92828875]
curr_Stock_Price:  106.4399421519898
curr_Factors:  [106.43994215]
mat_Sqrt:  [[0.15]]
grads:  [0.0970446]
Stock Position:  0.09704459726412963
Bond Position:  [1.59886743]


portfolio before change:  [11.78798267]
curr_Stock_Price:  104.99003303507564
curr_Factors:  [104.99003304]
mat_Sqrt:  [[0.15]]
grads:  [-0.10678642]
Stock Position:  -0.10678642345437311
Bond Position:  [22.9994928]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.6461897]
Stock Price:  106.37170275092829
PL:  [5.27448694]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.46688986e-02]
 [ 2.25176384e-02]
 [-2.19779267e-02]
 [-2.05661873e-02]
 [ 3.96693967e-03]
 [-1.04442836e-02]
 [ 1.30099782e-02]
 [-3.53014236e-02]
 [ 1.51099119e-03]
 [ 7.43390525e-03]
 [-1.39667920e-02]
 [ 2.83988567e-02]
 [ 7.88233327e-03]
 [-1.70546231e-03]
 [ 7.96929785e-03]
 [ 2.13139431e-02]
 [ 9.46971993e-03]
 [ 5.29633795e-04]
 [-8.77281971e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.66097451]
curr_Stock_Price:  100.77420508836286
curr_Factors:  [100.77420509]
mat_Sqrt:  [[0.15]]
grads:  [-0.09779266]
Stock Position:  -0.09779265755230204
Bond Position:  [28.51595184]


portfolio before change:  [18.59382603]
curr_Stock_Price:  101.5337545685166
curr_Factors:  [101.53375457]
mat_Sqrt:  [[0.15]]
grads:  [0.15011759]
Stock Position:  0.15011758934737018
Bond Position:  [3.35182355]


portfolio before change:  [18.57243029]
curr_Stock_Price:  101.38564537038194
curr_Factors:  [101.38564537]
mat_Sqrt:  [[0.15]]
grads:  [-0.14651951]
Stock Position:  -0.14651951135555305
Bond Position:  [33.42740551]


portfolio before change:  [18.880734]
curr_Stock_Price:  99.33850632499097
curr_Factors:  [99.33850632]
mat_Sqrt:  [[0.15]]
grads:  [-0.13710792]
Stock Position:  -0.13710791526192728
Bond Position:  [32.50082951]


portfolio before change:  [18.93964297]
curr_Stock_Price:  98.96812112194014
curr_Factors:  [98.96812112]
mat_Sqrt:  [[0.15]]
grads:  [0.02644626]
Stock Position:  0.02644626446767247
Bond Position:  [16.32230586]


portfolio before change:  [18.9495178]
curr_Stock_Price:  99.18719722878295
curr_Factors:  [99.18719723]
mat_Sqrt:  [[0.15]]
grads:  [-0.06962856]
Stock Position:  -0.06962855736077003
Bond Position:  [25.85577925]


portfolio before change:  [19.06035428]
curr_Stock_Price:  97.68821845143752
curr_Factors:  [97.68821845]
mat_Sqrt:  [[0.15]]
grads:  [0.08673319]
Stock Position:  0.08673318772086941
Bond Position:  [10.58754369]


portfolio before change:  [19.11122262]
curr_Stock_Price:  98.24418931361222
curr_Factors:  [98.24418931]
mat_Sqrt:  [[0.15]]
grads:  [-0.23534282]
Stock Position:  -0.23534282396452721
Bond Position:  [42.23228757]


portfolio before change:  [19.47183922]
curr_Stock_Price:  96.75675410386583
curr_Factors:  [96.7567541]
mat_Sqrt:  [[0.15]]
grads:  [0.01007327]
Stock Position:  0.010073274600762806
Bond Position:  [18.49718186]


portfolio before change:  [19.4681622]
curr_Stock_Price:  95.93260437053794
curr_Factors:  [95.93260437]
mat_Sqrt:  [[0.15]]
grads:  [0.04955937]
Stock Position:  0.04955936832358052
Bond Position:  [14.71380293]


portfolio before change:  [19.39849079]
curr_Stock_Price:  94.45255475485357
curr_Factors:  [94.45255475]
mat_Sqrt:  [[0.15]]
grads:  [-0.09311195]
Stock Position:  -0.09311194697499044
Bond Position:  [28.19315206]


portfolio before change:  [19.56727904]
curr_Stock_Price:  92.71551582622307
curr_Factors:  [92.71551583]
mat_Sqrt:  [[0.15]]
grads:  [0.18932571]
Stock Position:  0.18932571131467635
Bond Position:  [2.01384805]


portfolio before change:  [19.64343331]
curr_Stock_Price:  93.11509575809339
curr_Factors:  [93.11509576]
mat_Sqrt:  [[0.15]]
grads:  [0.05254889]
Stock Position:  0.05254888849514676
Bond Position:  [14.75033853]


portfolio before change:  [19.73092938]
curr_Stock_Price:  94.70995382466792
curr_Factors:  [94.70995382]
mat_Sqrt:  [[0.15]]
grads:  [-0.01136975]
Stock Position:  -0.011369748721453094
Bond Position:  [20.80775776]


portfolio before change:  [19.72343577]
curr_Stock_Price:  95.82661880731261
curr_Factors:  [95.82661881]
mat_Sqrt:  [[0.15]]
grads:  [0.05312865]
Stock Position:  0.0531286523520676
Bond Position:  [14.63229665]


portfolio before change:  [19.71963157]
curr_Stock_Price:  95.68615356763237
curr_Factors:  [95.68615357]
mat_Sqrt:  [[0.15]]
grads:  [0.14209295]
Stock Position:  0.1420929537828859
Bond Position:  [6.12330337]


portfolio before change:  [19.65811033]
curr_Stock_Price:  95.24241407478047
curr_Factors:  [95.24241407]
mat_Sqrt:  [[0.15]]
grads:  [0.06313147]
Stock Position:  0.06313146618588816
Bond Position:  [13.64531709]


portfolio before change:  [19.6894624]
curr_Stock_Price:  95.68498758358406
curr_Factors:  [95.68498758]
mat_Sqrt:  [[0.15]]
grads:  [0.00353089]
Stock Position:  0.003530891966399309
Bond Position:  [19.35160905]


portfolio before change:  [19.69372767]
curr_Stock_Price:  95.52263649231134
curr_Factors:  [95.52263649]
mat_Sqrt:  [[0.15]]
grads:  [-0.05848546]
Stock Position:  -0.058485464705594625
Bond Position:  [25.28041345]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.74564387]
Stock Price:  94.7430357078553
PL:  [19.74564387]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.26626397e-02]
 [ 6.43775631e-02]
 [-5.08709116e-02]
 [ 6.06830493e-02]
 [ 5.68394837e-03]
 [-1.07562972e-02]
 [-1.29816701e-03]
 [ 9.99611607e-03]
 [-1.47976641e-02]
 [ 1.28387636e-03]
 [-3.50386867e-03]
 [ 1.89310487e-02]
 [ 1.21954733e-02]
 [-2.95084828e-03]
 [ 6.42269635e-03]
 [ 2.25285592e-02]
 [ 2.95717327e-03]
 [ 1.31355438e-02]
 [-9.06262487e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [47.12189219]
curr_Stock_Price:  102.06553101201567
curr_Factors:  [102.06553101]
mat_Sqrt:  [[0.15]]
grads:  [-0.15108426]
Stock Position:  -0.15108426457600868
Bond Position:  [62.54238789]


portfolio before change:  [46.95567372]
curr_Stock_Price:  103.26920383413442
curr_Factors:  [103.26920383]
mat_Sqrt:  [[0.15]]
grads:  [0.42918375]
Stock Position:  0.42918375390534613
Bond Position:  [2.63420916]


portfolio before change:  [46.9560158]
curr_Stock_Price:  103.26846625983876
curr_Factors:  [103.26846626]
mat_Sqrt:  [[0.15]]
grads:  [-0.33913941]
Stock Position:  -0.3391394107303123
Bond Position:  [81.9784226]


portfolio before change:  [46.91067536]
curr_Stock_Price:  103.46259766398242
curr_Factors:  [103.46259766]
mat_Sqrt:  [[0.15]]
grads:  [0.40455366]
Stock Position:  0.40455366200115084
Bond Position:  [5.05450259]


portfolio before change:  [46.52409178]
curr_Stock_Price:  102.5038932988562
curr_Factors:  [102.5038933]
mat_Sqrt:  [[0.15]]
grads:  [0.03789299]
Stock Position:  0.03789298911940712
Bond Position:  [42.63991287]


portfolio before change:  [46.52206543]
curr_Stock_Price:  102.16906450401706
curr_Factors:  [102.1690645]
mat_Sqrt:  [[0.15]]
grads:  [-0.07170865]
Stock Position:  -0.07170864782702499
Bond Position:  [53.84847089]


portfolio before change:  [46.51723106]
curr_Stock_Price:  102.42423830684078
curr_Factors:  [102.42423831]
mat_Sqrt:  [[0.15]]
grads:  [-0.00865445]
Stock Position:  -0.008654446712622211
Bond Position:  [47.40365617]


portfolio before change:  [46.534292]
curr_Stock_Price:  101.82240403101241
curr_Factors:  [101.82240403]
mat_Sqrt:  [[0.15]]
grads:  [0.06664077]
Stock Position:  0.06664077379343371
Bond Position:  [39.74876821]


portfolio before change:  [46.56872956]
curr_Stock_Price:  102.19003373647267
curr_Factors:  [102.19003374]
mat_Sqrt:  [[0.15]]
grads:  [-0.09865109]
Stock Position:  -0.0986510937642706
Bond Position:  [56.64988816]


portfolio before change:  [46.45212842]
curr_Stock_Price:  103.51556775902982
curr_Factors:  [103.51556776]
mat_Sqrt:  [[0.15]]
grads:  [0.00855918]
Stock Position:  0.008559175712701077
Bond Position:  [45.56612049]


portfolio before change:  [46.47569474]
curr_Stock_Price:  104.93782621010556
curr_Factors:  [104.93782621]
mat_Sqrt:  [[0.15]]
grads:  [-0.02335912]
Stock Position:  -0.023359124459555416
Bond Position:  [48.92695048]


portfolio before change:  [46.45101897]
curr_Stock_Price:  106.51789565299828
curr_Factors:  [106.51789565]
mat_Sqrt:  [[0.15]]
grads:  [0.12620699]
Stock Position:  0.12620699131637367
Bond Position:  [33.00771583]


portfolio before change:  [46.3313017]
curr_Stock_Price:  105.50392464340604
curr_Factors:  [105.50392464]
mat_Sqrt:  [[0.15]]
grads:  [0.08130316]
Stock Position:  0.08130315509847823
Bond Position:  [37.75349975]


portfolio before change:  [46.34511432]
curr_Stock_Price:  105.55771180264009
curr_Factors:  [105.5577118]
mat_Sqrt:  [[0.15]]
grads:  [-0.01967232]
Stock Position:  -0.019672321846291238
Bond Position:  [48.4216796]


portfolio before change:  [46.38335858]
curr_Stock_Price:  104.22907719095922
curr_Factors:  [104.22907719]
mat_Sqrt:  [[0.15]]
grads:  [0.04281798]
Stock Position:  0.04281797564867942
Bond Position:  [41.92048049]


portfolio before change:  [46.37490275]
curr_Stock_Price:  103.78680373228251
curr_Factors:  [103.78680373]
mat_Sqrt:  [[0.15]]
grads:  [0.15019039]
Stock Position:  0.1501903946241653
Bond Position:  [30.78712174]


portfolio before change:  [46.36035431]
curr_Stock_Price:  103.63868386872696
curr_Factors:  [103.63868387]
mat_Sqrt:  [[0.15]]
grads:  [0.01971449]
Stock Position:  0.0197144884984117
Bond Position:  [44.31717067]


portfolio before change:  [46.37754921]
curr_Stock_Price:  103.94882216132724
curr_Factors:  [103.94882216]
mat_Sqrt:  [[0.15]]
grads:  [0.08757029]
Stock Position:  0.08757029209993253
Bond Position:  [37.27472049]


portfolio before change:  [46.26604111]
curr_Stock_Price:  102.5690397626402
curr_Factors:  [102.56903976]
mat_Sqrt:  [[0.15]]
grads:  [-0.0604175]
Stock Position:  -0.06041749916249683
Bond Position:  [52.46300598]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [46.1794197]
Stock Price:  104.21986613709426
PL:  [41.95955356]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.68756226e-03]
 [-5.96911624e-03]
 [-5.36567416e-03]
 [-3.82651894e-03]
 [ 2.10765218e-03]
 [-9.77521269e-03]
 [-3.48757716e-04]
 [ 1.06372106e-02]
 [-6.54897796e-03]
 [ 6.79233741e-04]
 [-3.72894393e-03]
 [ 2.00308072e-02]
 [ 1.32904598e-02]
 [-4.65472539e-03]
 [ 2.25791816e-02]
 [ 1.82055802e-02]
 [ 1.21853571e-02]
 [ 1.54886827e-02]
 [-1.88641832e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.82162322]
curr_Stock_Price:  99.34577979867713
curr_Factors:  [99.3457798]
mat_Sqrt:  [[0.15]]
grads:  [0.01791708]
Stock Position:  0.01791708175909369
Bond Position:  [-14.60160968]


portfolio before change:  [-12.80521631]
curr_Stock_Price:  100.46525718259844
curr_Factors:  [100.46525718]
mat_Sqrt:  [[0.15]]
grads:  [-0.03979411]
Stock Position:  -0.03979410824010497
Bond Position:  [-8.80729099]


portfolio before change:  [-12.80445812]
curr_Stock_Price:  100.39086717134727
curr_Factors:  [100.39086717]
mat_Sqrt:  [[0.15]]
grads:  [-0.03577116]
Stock Position:  -0.035771161088375615
Bond Position:  [-9.21336024]


portfolio before change:  [-12.81491855]
curr_Stock_Price:  100.61889432154965
curr_Factors:  [100.61889432]
mat_Sqrt:  [[0.15]]
grads:  [-0.02551013]
Stock Position:  -0.025510126273368152
Bond Position:  [-10.24811785]


portfolio before change:  [-12.76551155]
curr_Stock_Price:  98.58168972196779
curr_Factors:  [98.58168972]
mat_Sqrt:  [[0.15]]
grads:  [0.01405101]
Stock Position:  0.014051014542723004
Bond Position:  [-14.15068431]


portfolio before change:  [-12.74156076]
curr_Stock_Price:  100.53805414270711
curr_Factors:  [100.53805414]
mat_Sqrt:  [[0.15]]
grads:  [-0.06516808]
Stock Position:  -0.06516808458438401
Bond Position:  [-6.18968834]


portfolio before change:  [-12.84657962]
curr_Stock_Price:  102.12581366687985
curr_Factors:  [102.12581367]
mat_Sqrt:  [[0.15]]
grads:  [-0.00232505]
Stock Position:  -0.002325051439470676
Bond Position:  [-12.60913185]


portfolio before change:  [-12.84868838]
curr_Stock_Price:  101.67682665653302
curr_Factors:  [101.67682666]
mat_Sqrt:  [[0.15]]
grads:  [0.07091474]
Stock Position:  0.07091473746645015
Bond Position:  [-20.05907385]


portfolio before change:  [-12.76099887]
curr_Stock_Price:  102.98409937897611
curr_Factors:  [102.98409938]
mat_Sqrt:  [[0.15]]
grads:  [-0.04365985]
Stock Position:  -0.04365985307086048
Bond Position:  [-8.26472823]


portfolio before change:  [-12.8051591]
curr_Stock_Price:  103.94822974379905
curr_Factors:  [103.94822974]
mat_Sqrt:  [[0.15]]
grads:  [0.00452822]
Stock Position:  0.004528224936792679
Bond Position:  [-13.27586007]


portfolio before change:  [-12.79867395]
curr_Stock_Price:  106.11343524802844
curr_Factors:  [106.11343525]
mat_Sqrt:  [[0.15]]
grads:  [-0.02485963]
Stock Position:  -0.02485962617455155
Bond Position:  [-10.16073361]


portfolio before change:  [-12.8156416]
curr_Stock_Price:  106.69377987159976
curr_Factors:  [106.69377987]
mat_Sqrt:  [[0.15]]
grads:  [0.13353871]
Stock Position:  0.13353871457695618
Bond Position:  [-27.06339182]


portfolio before change:  [-12.88108198]
curr_Stock_Price:  106.2544040005854
curr_Factors:  [106.254404]
mat_Sqrt:  [[0.15]]
grads:  [0.08860307]
Stock Position:  0.08860306555257012
Bond Position:  [-22.2955479]


portfolio before change:  [-12.82589019]
curr_Stock_Price:  106.9402310530333
curr_Factors:  [106.94023105]
mat_Sqrt:  [[0.15]]
grads:  [-0.0310315]
Stock Position:  -0.03103150262729657
Bond Position:  [-9.50737412]


portfolio before change:  [-12.85846899]
curr_Stock_Price:  107.91348936880806
curr_Factors:  [107.91348937]
mat_Sqrt:  [[0.15]]
grads:  [0.15052788]
Stock Position:  0.1505278773887355
Bond Position:  [-29.10245749]


portfolio before change:  [-12.66962924]
curr_Stock_Price:  109.21634624927663
curr_Factors:  [109.21634625]
mat_Sqrt:  [[0.15]]
grads:  [0.12137053]
Stock Position:  0.12137053470712654
Bond Position:  [-25.92527558]


portfolio before change:  [-12.70755647]
curr_Stock_Price:  108.95726276004025
curr_Factors:  [108.95726276]
mat_Sqrt:  [[0.15]]
grads:  [0.08123571]
Stock Position:  0.08123571407634331
Bond Position:  [-21.55877751]


portfolio before change:  [-12.75726784]
curr_Stock_Price:  108.41167754478398
curr_Factors:  [108.41167754]
mat_Sqrt:  [[0.15]]
grads:  [0.10325788]
Stock Position:  0.10325788452227314
Bond Position:  [-23.95162832]


portfolio before change:  [-12.62126088]
curr_Stock_Price:  109.78683271499706
curr_Factors:  [109.78683271]
mat_Sqrt:  [[0.15]]
grads:  [-0.12576122]
Stock Position:  -0.12576122125823527
Bond Position:  [1.18566528]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.51919573]
Stock Price:  108.97761111917073
PL:  [-21.49680685]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.57859482e-03]
 [-9.80684704e-03]
 [-4.40691377e-03]
 [-1.96855135e-02]
 [ 5.84918995e-03]
 [-1.00440164e-02]
 [ 1.47330323e-02]
 [-2.75938923e-02]
 [-1.49254816e-03]
 [ 1.02327448e-02]
 [-4.33081812e-03]
 [-3.74499405e-04]
 [ 5.23592558e-03]
 [-9.75758801e-04]
 [ 8.03713656e-03]
 [ 1.82599602e-02]
 [ 5.11667019e-03]
 [ 5.54635441e-03]
 [-5.23930802e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.21425585]
curr_Stock_Price:  99.7816843143294
curr_Factors:  [99.78168431]
mat_Sqrt:  [[0.15]]
grads:  [0.01719063]
Stock Position:  0.017190632158962348
Bond Position:  [-4.92956608]


portfolio before change:  [-3.21100146]
curr_Stock_Price:  100.04269468280383
curr_Factors:  [100.04269468]
mat_Sqrt:  [[0.15]]
grads:  [-0.06537898]
Stock Position:  -0.06537898029498658
Bond Position:  [3.3296879]


portfolio before change:  [-3.18792442]
curr_Stock_Price:  99.70245512391207
curr_Factors:  [99.70245512]
mat_Sqrt:  [[0.15]]
grads:  [-0.02937943]
Stock Position:  -0.029379425115515258
Bond Position:  [-0.25872361]


portfolio before change:  [-3.17484325]
curr_Stock_Price:  99.25500383733652
curr_Factors:  [99.25500384]
mat_Sqrt:  [[0.15]]
grads:  [-0.13123676]
Stock Position:  -0.13123675690251854
Bond Position:  [9.85106156]


portfolio before change:  [-3.18734558]
curr_Stock_Price:  99.36903745693651
curr_Factors:  [99.36903746]
mat_Sqrt:  [[0.15]]
grads:  [0.0389946]
Stock Position:  0.03899459968763981
Bond Position:  [-7.06220142]


portfolio before change:  [-3.17547062]
curr_Stock_Price:  99.71884819488533
curr_Factors:  [99.71884819]
mat_Sqrt:  [[0.15]]
grads:  [-0.06696011]
Stock Position:  -0.06696010963149547
Bond Position:  [3.50171439]


portfolio before change:  [-3.17420468]
curr_Stock_Price:  99.71301785041138
curr_Factors:  [99.71301785]
mat_Sqrt:  [[0.15]]
grads:  [0.09822022]
Stock Position:  0.0982202154592206
Bond Position:  [-12.96803878]


portfolio before change:  [-3.26876624]
curr_Stock_Price:  98.78327905081638
curr_Factors:  [98.78327905]
mat_Sqrt:  [[0.15]]
grads:  [-0.18395928]
Stock Position:  -0.18395928210052653
Bond Position:  [14.90333486]


portfolio before change:  [-3.3198795]
curr_Stock_Price:  99.08138607304669
curr_Factors:  [99.08138607]
mat_Sqrt:  [[0.15]]
grads:  [-0.00995032]
Stock Position:  -0.009950321033626254
Bond Position:  [-2.3339879]


portfolio before change:  [-3.30941972]
curr_Stock_Price:  97.97153818723682
curr_Factors:  [97.97153819]
mat_Sqrt:  [[0.15]]
grads:  [0.0682183]
Stock Position:  0.06821829843556503
Bond Position:  [-9.99287135]


portfolio before change:  [-3.27336366]
curr_Stock_Price:  98.53670313338418
curr_Factors:  [98.53670313]
mat_Sqrt:  [[0.15]]
grads:  [-0.02887212]
Stock Position:  -0.028872120769796915
Bond Position:  [-0.42840007]


portfolio before change:  [-3.27397298]
curr_Stock_Price:  98.55409703578995
curr_Factors:  [98.55409704]
mat_Sqrt:  [[0.15]]
grads:  [-0.00249666]
Stock Position:  -0.00249666269778828
Bond Position:  [-3.02791664]


portfolio before change:  [-3.27408455]
curr_Stock_Price:  98.29555372061087
curr_Factors:  [98.29555372]
mat_Sqrt:  [[0.15]]
grads:  [0.03490617]
Stock Position:  0.0349061705372829
Bond Position:  [-6.70520591]


portfolio before change:  [-3.27832096]
curr_Stock_Price:  98.22221721417615
curr_Factors:  [98.22221721]
mat_Sqrt:  [[0.15]]
grads:  [-0.00650506]
Stock Position:  -0.006505058675318547
Bond Position:  [-2.63937967]


portfolio before change:  [-3.276317]
curr_Stock_Price:  97.81270655492125
curr_Factors:  [97.81270655]
mat_Sqrt:  [[0.15]]
grads:  [0.05358091]
Stock Position:  0.05358091040365633
Bond Position:  [-8.51721086]


portfolio before change:  [-3.27799437]
curr_Stock_Price:  97.82114607983466
curr_Factors:  [97.82114608]
mat_Sqrt:  [[0.15]]
grads:  [0.12173307]
Stock Position:  0.1217330676899176
Bond Position:  [-15.18606257]


portfolio before change:  [-3.11450278]
curr_Stock_Price:  99.19537072607686
curr_Factors:  [99.19537073]
mat_Sqrt:  [[0.15]]
grads:  [0.03411113]
Stock Position:  0.03411113462254471
Bond Position:  [-6.49816942]


portfolio before change:  [-3.13363272]
curr_Stock_Price:  98.68218941787731
curr_Factors:  [98.68218942]
mat_Sqrt:  [[0.15]]
grads:  [0.0369757]
Stock Position:  0.03697569605301097
Bond Position:  [-6.78247536]


portfolio before change:  [-3.07802081]
curr_Stock_Price:  100.23206541807743
curr_Factors:  [100.23206542]
mat_Sqrt:  [[0.15]]
grads:  [-0.03492872]
Stock Position:  -0.03492872015860008
Bond Position:  [0.42295696]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.06073117]
Stock Price:  99.74009545367798
PL:  [-3.06073117]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.67763596e-04]
 [-8.49576050e-03]
 [-2.15773015e-02]
 [ 4.62977253e-02]
 [-1.90725018e-02]
 [-1.25303572e-02]
 [ 1.40794217e-02]
 [-6.16458991e-02]
 [ 4.24244793e-03]
 [ 5.90674609e-03]
 [-1.60207086e-02]
 [ 1.89338127e-02]
 [ 7.15318060e-03]
 [-1.66729706e-03]
 [ 7.38889424e-03]
 [ 2.24096814e-02]
 [ 1.48301486e-02]
 [-4.98224210e-04]
 [-1.13161582e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-25.64198231]
curr_Stock_Price:  98.76409574237913
curr_Factors:  [98.76409574]
mat_Sqrt:  [[0.15]]
grads:  [0.00178509]
Stock Position:  0.0017850906402772557
Bond Position:  [-25.81828517]


portfolio before change:  [-25.6521056]
curr_Stock_Price:  96.70934663973938
curr_Factors:  [96.70934664]
mat_Sqrt:  [[0.15]]
grads:  [-0.0566384]
Stock Position:  -0.056638403342063326
Bond Position:  [-20.17464262]


portfolio before change:  [-25.52992478]
curr_Stock_Price:  94.46307725142753
curr_Factors:  [94.46307725]
mat_Sqrt:  [[0.15]]
grads:  [-0.14384868]
Stock Position:  -0.14384867647193708
Bond Position:  [-11.94153614]


portfolio before change:  [-25.32747581]
curr_Stock_Price:  93.03494640907884
curr_Factors:  [93.03494641]
mat_Sqrt:  [[0.15]]
grads:  [0.3086515]
Stock Position:  0.30865150186271995
Bond Position:  [-54.04285174]


portfolio before change:  [-25.4669619]
curr_Stock_Price:  92.62680425027936
curr_Factors:  [92.62680425]
mat_Sqrt:  [[0.15]]
grads:  [-0.12715001]
Stock Position:  -0.127150012133459
Bond Position:  [-13.68946261]


portfolio before change:  [-25.52563767]
curr_Stock_Price:  93.06135378856028
curr_Factors:  [93.06135379]
mat_Sqrt:  [[0.15]]
grads:  [-0.08353571]
Stock Position:  -0.08353571438252638
Bond Position:  [-17.751691]


portfolio before change:  [-25.63781448]
curr_Stock_Price:  94.35108152237987
curr_Factors:  [94.35108152]
mat_Sqrt:  [[0.15]]
grads:  [0.09386281]
Stock Position:  0.09386281137008667
Bond Position:  [-34.49387224]


portfolio before change:  [-25.68519085]
curr_Stock_Price:  93.93822548530841
curr_Factors:  [93.93822549]
mat_Sqrt:  [[0.15]]
grads:  [-0.41097266]
Stock Position:  -0.4109726606874274
Bond Position:  [12.92085162]


portfolio before change:  [-26.21881449]
curr_Stock_Price:  95.24452711666567
curr_Factors:  [95.24452712]
mat_Sqrt:  [[0.15]]
grads:  [0.02828299]
Stock Position:  0.02828298622945107
Bond Position:  [-28.91261414]


portfolio before change:  [-26.23389058]
curr_Stock_Price:  94.96708000171694
curr_Factors:  [94.96708]
mat_Sqrt:  [[0.15]]
grads:  [0.03937831]
Stock Position:  0.03937830728927735
Bond Position:  [-29.97353344]


portfolio before change:  [-26.29300657]
curr_Stock_Price:  93.65616372644976
curr_Factors:  [93.65616373]
mat_Sqrt:  [[0.15]]
grads:  [-0.10680472]
Stock Position:  -0.10680472404987207
Bond Position:  [-16.29008584]


portfolio before change:  [-26.39704908]
curr_Stock_Price:  94.59216618956398
curr_Factors:  [94.59216619]
mat_Sqrt:  [[0.15]]
grads:  [0.12622542]
Stock Position:  0.12622541819170305
Bond Position:  [-38.33698482]


portfolio before change:  [-26.43477162]
curr_Stock_Price:  94.3692546986578
curr_Factors:  [94.3692547]
mat_Sqrt:  [[0.15]]
grads:  [0.04768787]
Stock Position:  0.04768787067063953
Bond Position:  [-30.93504043]


portfolio before change:  [-26.41836042]
curr_Stock_Price:  94.87558741336433
curr_Factors:  [94.87558741]
mat_Sqrt:  [[0.15]]
grads:  [-0.01111531]
Stock Position:  -0.011115313763622984
Bond Position:  [-25.3637885]


portfolio before change:  [-26.42467434]
curr_Stock_Price:  94.87308462027377
curr_Factors:  [94.87308462]
mat_Sqrt:  [[0.15]]
grads:  [0.04925929]
Stock Position:  0.04925929491949596
Bond Position:  [-31.09805559]


portfolio before change:  [-26.5001631]
curr_Stock_Price:  93.49845524818966
curr_Factors:  [93.49845525]
mat_Sqrt:  [[0.15]]
grads:  [0.14939788]
Stock Position:  0.14939787611212388
Bond Position:  [-40.46863373]


portfolio before change:  [-26.68545605]
curr_Stock_Price:  92.32591832569594
curr_Factors:  [92.32591833]
mat_Sqrt:  [[0.15]]
grads:  [0.09886766]
Stock Position:  0.09886765760002292
Bond Position:  [-35.81350333]


portfolio before change:  [-26.77646906]
curr_Stock_Price:  91.49593492737752
curr_Factors:  [91.49593493]
mat_Sqrt:  [[0.15]]
grads:  [-0.00332149]
Stock Position:  -0.0033214947366180573
Bond Position:  [-26.47256579]


portfolio before change:  [-26.78174429]
curr_Stock_Price:  91.09137696036716
curr_Factors:  [91.09137696]
mat_Sqrt:  [[0.15]]
grads:  [-0.07544105]
Stock Position:  -0.07544105475985585
Bond Position:  [-19.90971473]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-26.92161172]
Stock Price:  92.87938728512142
PL:  [-26.92161172]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-8.19427178e-03]
 [-8.69301408e-03]
 [-4.57366921e-03]
 [-1.52568502e-02]
 [ 6.09876901e-03]
 [-1.07378883e-02]
 [ 1.38159694e-02]
 [-2.52909360e-02]
 [-3.48519361e-04]
 [ 1.00392485e-02]
 [-3.01653851e-03]
 [-4.68870538e-03]
 [ 6.91642315e-03]
 [ 1.49285595e-04]
 [ 2.08204785e-03]
 [ 2.20071841e-02]
 [ 5.01839475e-03]
 [ 1.36311208e-02]
 [-1.58065398e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.19161216]
curr_Stock_Price:  100.43530592353085
curr_Factors:  [100.43530592]
mat_Sqrt:  [[0.15]]
grads:  [-0.05462848]
Stock Position:  -0.05462847854809207
Bond Position:  [16.67824012]


portfolio before change:  [11.20253493]
curr_Stock_Price:  100.31169470452329
curr_Factors:  [100.3116947]
mat_Sqrt:  [[0.15]]
grads:  [-0.05795343]
Stock Position:  -0.05795342723135631
Bond Position:  [17.01594143]


portfolio before change:  [11.23680484]
curr_Stock_Price:  99.79377212681065
curr_Factors:  [99.79377213]
mat_Sqrt:  [[0.15]]
grads:  [-0.03049113]
Stock Position:  -0.030491128066187236
Bond Position:  [14.27962953]


portfolio before change:  [11.27109273]
curr_Stock_Price:  98.7863467581248
curr_Factors:  [98.78634676]
mat_Sqrt:  [[0.15]]
grads:  [-0.10171233]
Stock Position:  -0.10171233490915829
Bond Position:  [21.31888272]


portfolio before change:  [11.2036957]
curr_Stock_Price:  99.50137717279377
curr_Factors:  [99.50137717]
mat_Sqrt:  [[0.15]]
grads:  [0.04065846]
Stock Position:  0.040658460077436155
Bond Position:  [7.15812293]


portfolio before change:  [11.15903836]
curr_Stock_Price:  98.35900493340692
curr_Factors:  [98.35900493]
mat_Sqrt:  [[0.15]]
grads:  [-0.07158592]
Stock Position:  -0.07158592200087724
Bond Position:  [18.20015842]


portfolio before change:  [11.12466406]
curr_Stock_Price:  98.90275587344048
curr_Factors:  [98.90275587]
mat_Sqrt:  [[0.15]]
grads:  [0.09210646]
Stock Position:  0.0921064628584018
Bond Position:  [2.01508105]


portfolio before change:  [11.12814347]
curr_Stock_Price:  98.93506174757988
curr_Factors:  [98.93506175]
mat_Sqrt:  [[0.15]]
grads:  [-0.16860624]
Stock Position:  -0.16860624022926654
Bond Position:  [27.80921226]


portfolio before change:  [10.99018674]
curr_Stock_Price:  99.79451925326893
curr_Factors:  [99.79451925]
mat_Sqrt:  [[0.15]]
grads:  [-0.00232346]
Stock Position:  -0.002323462405447137
Bond Position:  [11.22205556]


portfolio before change:  [10.9951912]
curr_Stock_Price:  98.84826188098498
curr_Factors:  [98.84826188]
mat_Sqrt:  [[0.15]]
grads:  [0.06692832]
Stock Position:  0.06692832365508077
Bond Position:  [4.37944274]


portfolio before change:  [11.06083732]
curr_Stock_Price:  99.81274322335234
curr_Factors:  [99.81274322]
mat_Sqrt:  [[0.15]]
grads:  [-0.02011026]
Stock Position:  -0.020110256729612194
Bond Position:  [13.06809721]


portfolio before change:  [11.05550086]
curr_Stock_Price:  100.24057935456331
curr_Factors:  [100.24057935]
mat_Sqrt:  [[0.15]]
grads:  [-0.03125804]
Stock Position:  -0.0312580358710178
Bond Position:  [14.18882448]


portfolio before change:  [11.00810609]
curr_Stock_Price:  101.87031772500464
curr_Factors:  [101.87031773]
mat_Sqrt:  [[0.15]]
grads:  [0.04610949]
Stock Position:  0.046109487672277225
Bond Position:  [6.31091793]


portfolio before change:  [11.04023377]
curr_Stock_Price:  102.53286588592388
curr_Factors:  [102.53286589]
mat_Sqrt:  [[0.15]]
grads:  [0.00099524]
Stock Position:  0.0009952373022086521
Bond Position:  [10.93818924]


portfolio before change:  [11.04376782]
curr_Stock_Price:  103.33585288197845
curr_Factors:  [103.33585288]
mat_Sqrt:  [[0.15]]
grads:  [0.01388032]
Stock Position:  0.013880319018777487
Bond Position:  [9.60943322]


portfolio before change:  [11.06151911]
curr_Stock_Price:  104.44163642589544
curr_Factors:  [104.44163643]
mat_Sqrt:  [[0.15]]
grads:  [0.14671456]
Stock Position:  0.14671456098994046
Bond Position:  [-4.26158973]


portfolio before change:  [11.08024376]
curr_Stock_Price:  104.57652542606264
curr_Factors:  [104.57652543]
mat_Sqrt:  [[0.15]]
grads:  [0.03345596]
Stock Position:  0.03345596499901966
Bond Position:  [7.58153518]


portfolio before change:  [11.08791582]
curr_Stock_Price:  104.74918349410653
curr_Factors:  [104.74918349]
mat_Sqrt:  [[0.15]]
grads:  [0.09087414]
Stock Position:  0.09087413872767318
Bond Position:  [1.56892399]


portfolio before change:  [11.09144117]
curr_Stock_Price:  104.78366049204044
curr_Factors:  [104.78366049]
mat_Sqrt:  [[0.15]]
grads:  [-0.10537693]
Stock Position:  -0.10537693222986998
Bond Position:  [22.13322186]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.23509736]
Stock Price:  103.47291633396283
PL:  [7.76218103]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.77526851e-03]
 [-7.58729733e-03]
 [-5.13128864e-03]
 [ 4.14753560e-02]
 [ 6.15436555e-03]
 [-1.06575458e-02]
 [ 1.36169295e-02]
 [-3.11418063e-02]
 [-2.45519714e-03]
 [ 1.04874519e-02]
 [-4.34205270e-03]
 [-1.04512668e-03]
 [ 5.96569369e-03]
 [-1.07113322e-04]
 [ 5.77568883e-03]
 [ 1.72269591e-02]
 [ 6.27066818e-03]
 [ 5.35929205e-04]
 [-7.30657275e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.51540814]
curr_Stock_Price:  99.49578905999859
curr_Factors:  [99.49578906]
mat_Sqrt:  [[0.15]]
grads:  [0.01850179]
Stock Position:  0.018501790087745267
Bond Position:  [-11.35625834]


portfolio before change:  [-9.52051116]
curr_Stock_Price:  99.37344391653785
curr_Factors:  [99.37344392]
mat_Sqrt:  [[0.15]]
grads:  [-0.05058198]
Stock Position:  -0.05058198222703074
Bond Position:  [-4.49400539]


portfolio before change:  [-9.5655392]
curr_Stock_Price:  100.24142881690616
curr_Factors:  [100.24142882]
mat_Sqrt:  [[0.15]]
grads:  [-0.03420859]
Stock Position:  -0.034208590937804456
Bond Position:  [-6.13642117]


portfolio before change:  [-9.63936442]
curr_Stock_Price:  102.3546674088763
curr_Factors:  [102.35466741]
mat_Sqrt:  [[0.15]]
grads:  [0.27650237]
Stock Position:  0.2765023735711929
Bond Position:  [-37.9406729]


portfolio before change:  [-10.41856741]
curr_Stock_Price:  99.57090597690572
curr_Factors:  [99.57090598]
mat_Sqrt:  [[0.15]]
grads:  [0.0410291]
Stock Position:  0.04102910364803796
Bond Position:  [-14.50387243]


portfolio before change:  [-10.45825424]
curr_Stock_Price:  98.69200779150526
curr_Factors:  [98.69200779]
mat_Sqrt:  [[0.15]]
grads:  [-0.07105031]
Stock Position:  -0.07105030550497762
Bond Position:  [-3.44615693]


portfolio before change:  [-10.44566809]
curr_Stock_Price:  98.502736367691
curr_Factors:  [98.50273637]
mat_Sqrt:  [[0.15]]
grads:  [0.09077953]
Stock Position:  0.09077952986202446
Bond Position:  [-19.38770019]


portfolio before change:  [-10.44679959]
curr_Stock_Price:  98.5436710750918
curr_Factors:  [98.54367108]
mat_Sqrt:  [[0.15]]
grads:  [-0.20761204]
Stock Position:  -0.2076120420997525
Bond Position:  [10.0120532]


portfolio before change:  [-10.44846966]
curr_Stock_Price:  98.56377299496603
curr_Factors:  [98.56377299]
mat_Sqrt:  [[0.15]]
grads:  [-0.01636798]
Stock Position:  -0.01636798093403412
Bond Position:  [-8.83517971]


portfolio before change:  [-10.45195602]
curr_Stock_Price:  98.64180830347664
curr_Factors:  [98.6418083]
mat_Sqrt:  [[0.15]]
grads:  [0.06991635]
Stock Position:  0.0699163457624964
Bond Position:  [-17.34863079]


portfolio before change:  [-10.46418506]
curr_Stock_Price:  98.5289399823278
curr_Factors:  [98.52893998]
mat_Sqrt:  [[0.15]]
grads:  [-0.02894702]
Stock Position:  -0.02894701802999687
Bond Position:  [-7.61206605]


portfolio before change:  [-10.47161059]
curr_Stock_Price:  98.7197120029464
curr_Factors:  [98.719712]
mat_Sqrt:  [[0.15]]
grads:  [-0.00696751]
Stock Position:  -0.006967511191720994
Bond Position:  [-9.78377989]


portfolio before change:  [-10.49155218]
curr_Stock_Price:  101.2306999577455
curr_Factors:  [101.23069996]
mat_Sqrt:  [[0.15]]
grads:  [0.03977129]
Stock Position:  0.03977129123701723
Bond Position:  [-14.51762783]


portfolio before change:  [-10.51071854]
curr_Stock_Price:  100.84005392140122
curr_Factors:  [100.84005392]
mat_Sqrt:  [[0.15]]
grads:  [-0.00071409]
Stock Position:  -0.0007140888115940465
Bond Position:  [-10.43870978]


portfolio before change:  [-10.5123133]
curr_Stock_Price:  99.41831927300815
curr_Factors:  [99.41831927]
mat_Sqrt:  [[0.15]]
grads:  [0.03850459]
Stock Position:  0.038504592188404414
Bond Position:  [-14.34037514]


portfolio before change:  [-10.54689764]
curr_Stock_Price:  98.61325149780251
curr_Factors:  [98.6132515]
mat_Sqrt:  [[0.15]]
grads:  [0.11484639]
Stock Position:  0.11484639417038511
Bond Position:  [-21.872274]


portfolio before change:  [-10.62009382]
curr_Stock_Price:  98.02352972532825
curr_Factors:  [98.02352973]
mat_Sqrt:  [[0.15]]
grads:  [0.04180445]
Stock Position:  0.041804454530175165
Bond Position:  [-14.71791401]


portfolio before change:  [-10.71975477]
curr_Stock_Price:  95.72757789528183
curr_Factors:  [95.7275779]
mat_Sqrt:  [[0.15]]
grads:  [0.00357286]
Stock Position:  0.0035728613665647036
Bond Position:  [-11.06177613]


portfolio before change:  [-10.72064998]
curr_Stock_Price:  96.25113084223705
curr_Factors:  [96.25113084]
mat_Sqrt:  [[0.15]]
grads:  [-0.04871049]
Stock Position:  -0.04871048502228156
Bond Position:  [-6.03221071]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.72931915]
Stock Price:  96.3981408287252
PL:  [-10.72931915]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.66089847e-02]
 [-6.42903972e-03]
 [-2.13253711e-02]
 [ 2.78135705e-02]
 [ 6.34112257e-03]
 [-9.56838789e-03]
 [ 7.00684648e-03]
 [ 9.29103945e-03]
 [ 1.29677575e-03]
 [ 6.48114288e-04]
 [-3.20184892e-03]
 [-2.10465490e-03]
 [ 9.87413548e-03]
 [-2.30209294e-03]
 [ 3.61613011e-03]
 [ 2.22523678e-02]
 [ 5.81964127e-03]
 [ 1.32936954e-02]
 [-1.61666518e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.78970486]
curr_Stock_Price:  101.00690533143633
curr_Factors:  [101.00690533]
mat_Sqrt:  [[0.15]]
grads:  [-0.11072656]
Stock Position:  -0.11072656481645768
Bond Position:  [34.97385251]


portfolio before change:  [23.86129525]
curr_Stock_Price:  100.43932853432756
curr_Factors:  [100.43932853]
mat_Sqrt:  [[0.15]]
grads:  [-0.04286026]
Stock Position:  -0.04286026477043014
Bond Position:  [28.16615146]


portfolio before change:  [23.82913889]
curr_Stock_Price:  101.35390014195224
curr_Factors:  [101.35390014]
mat_Sqrt:  [[0.15]]
grads:  [-0.14216914]
Stock Position:  -0.14216914078149315
Bond Position:  [38.23853578]


portfolio before change:  [23.80322164]
curr_Stock_Price:  101.6034484813239
curr_Factors:  [101.60344848]
mat_Sqrt:  [[0.15]]
grads:  [0.1854238]
Stock Position:  0.1854238035458751
Bond Position:  [4.96352377]


portfolio before change:  [23.47457911]
curr_Stock_Price:  99.82436964676226
curr_Factors:  [99.82436965]
mat_Sqrt:  [[0.15]]
grads:  [0.04227415]
Stock Position:  0.0422741504938715
Bond Position:  [19.25458869]


portfolio before change:  [23.52111834]
curr_Stock_Price:  100.8113789557201
curr_Factors:  [100.81137896]
mat_Sqrt:  [[0.15]]
grads:  [-0.06378925]
Stock Position:  -0.06378925256698041
Bond Position:  [29.95180086]


portfolio before change:  [23.5150463]
curr_Stock_Price:  101.023968547385
curr_Factors:  [101.02396855]
mat_Sqrt:  [[0.15]]
grads:  [0.04671231]
Stock Position:  0.04671230985272979
Bond Position:  [18.79598338]


portfolio before change:  [23.56452158]
curr_Stock_Price:  101.98251021727444
curr_Factors:  [101.98251022]
mat_Sqrt:  [[0.15]]
grads:  [0.06194026]
Stock Position:  0.06194026297328377
Bond Position:  [17.24769808]


portfolio before change:  [23.67554255]
curr_Stock_Price:  103.7052750710579
curr_Factors:  [103.70527507]
mat_Sqrt:  [[0.15]]
grads:  [0.00864517]
Stock Position:  0.008645171659012296
Bond Position:  [22.77899264]


portfolio before change:  [23.6835309]
curr_Stock_Price:  103.97049778105026
curr_Factors:  [103.97049778]
mat_Sqrt:  [[0.15]]
grads:  [0.00432076]
Stock Position:  0.0043207619167088
Bond Position:  [23.23429914]


portfolio before change:  [23.6855689]
curr_Stock_Price:  103.09766435378921
curr_Factors:  [103.09766435]
mat_Sqrt:  [[0.15]]
grads:  [-0.02134566]
Stock Position:  -0.021345659464333002
Bond Position:  [25.88625654]


portfolio before change:  [23.69084604]
curr_Stock_Price:  103.1536585704966
curr_Factors:  [103.15365857]
mat_Sqrt:  [[0.15]]
grads:  [-0.01403103]
Stock Position:  -0.014031032697477894
Bond Position:  [25.1381984]


portfolio before change:  [23.6866003]
curr_Stock_Price:  103.90421449621718
curr_Factors:  [103.9042145]
mat_Sqrt:  [[0.15]]
grads:  [0.06582757]
Stock Position:  0.06582756986191779
Bond Position:  [16.84683836]


portfolio before change:  [23.76500677]
curr_Stock_Price:  105.03131424835793
curr_Factors:  [105.03131425]
mat_Sqrt:  [[0.15]]
grads:  [-0.01534729]
Stock Position:  -0.015347286241854195
Bond Position:  [25.37695242]


portfolio before change:  [23.79252762]
curr_Stock_Price:  103.6515383294389
curr_Factors:  [103.65153833]
mat_Sqrt:  [[0.15]]
grads:  [0.02410753]
Stock Position:  0.024107534052917653
Bond Position:  [21.29374463]


portfolio before change:  [23.80947527]
curr_Stock_Price:  104.13369246186384
curr_Factors:  [104.13369246]
mat_Sqrt:  [[0.15]]
grads:  [0.14834912]
Stock Position:  0.1483491189435638
Bond Position:  [8.36133374]


portfolio before change:  [23.93490718]
curr_Stock_Price:  104.96511848782329
curr_Factors:  [104.96511849]
mat_Sqrt:  [[0.15]]
grads:  [0.03879761]
Stock Position:  0.03879760845079891
Bond Position:  [19.86251162]


portfolio before change:  [23.91035311]
curr_Stock_Price:  104.20423844394836
curr_Factors:  [104.20423844]
mat_Sqrt:  [[0.15]]
grads:  [0.08862464]
Stock Position:  0.08862463616860146
Bond Position:  [14.67529039]


portfolio before change:  [23.99652577]
curr_Stock_Price:  105.13516895926486
curr_Factors:  [105.13516896]
mat_Sqrt:  [[0.15]]
grads:  [-0.10777768]
Stock Position:  -0.10777767843672714
Bond Position:  [35.3277502]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.78301463]
Stock Price:  107.19815811348337
PL:  [16.58485651]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.75723487e-03]
 [-4.87845565e-03]
 [-6.63257955e-03]
 [-1.69869171e-02]
 [ 5.16103163e-03]
 [-1.03759942e-02]
 [ 1.47275087e-02]
 [-4.30417646e-03]
 [-9.77254049e-03]
 [ 2.62313109e-03]
 [-2.91611102e-03]
 [-4.09070279e-03]
 [ 4.85554802e-03]
 [-3.54580386e-04]
 [ 2.58157588e-03]
 [ 1.80108460e-02]
 [ 4.33830755e-03]
 [ 9.80067511e-03]
 [-4.18701839e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.33568496]
curr_Stock_Price:  99.45857154175846
curr_Factors:  [99.45857154]
mat_Sqrt:  [[0.15]]
grads:  [0.01838157]
Stock Position:  0.018381565801276978
Bond Position:  [-12.16388924]


portfolio before change:  [-10.34734369]
curr_Stock_Price:  98.98976620602996
curr_Factors:  [98.98976621]
mat_Sqrt:  [[0.15]]
grads:  [-0.03252304]
Stock Position:  -0.032523037669531546
Bond Position:  [-7.1278958]


portfolio before change:  [-10.34075704]
curr_Stock_Price:  98.73244556419674
curr_Factors:  [98.73244556]
mat_Sqrt:  [[0.15]]
grads:  [-0.0442172]
Stock Position:  -0.044217197023799296
Bond Position:  [-5.97508504]


portfolio before change:  [-10.35404313]
curr_Stock_Price:  98.99913211207415
curr_Factors:  [98.99913211]
mat_Sqrt:  [[0.15]]
grads:  [-0.11324611]
Stock Position:  -0.11324611421739897
Bond Position:  [0.85722389]


portfolio before change:  [-10.37842728]
curr_Stock_Price:  99.2163447269126
curr_Factors:  [99.21634473]
mat_Sqrt:  [[0.15]]
grads:  [0.03440688]
Stock Position:  0.03440687755247291
Bond Position:  [-13.7921519]


portfolio before change:  [-10.37975776]
curr_Stock_Price:  99.27790190592077
curr_Factors:  [99.27790191]
mat_Sqrt:  [[0.15]]
grads:  [-0.06917329]
Stock Position:  -0.06917329497026328
Bond Position:  [-3.51237817]


portfolio before change:  [-10.41234361]
curr_Stock_Price:  99.73628174932955
curr_Factors:  [99.73628175]
mat_Sqrt:  [[0.15]]
grads:  [0.09818339]
Stock Position:  0.0981833913382881
Bond Position:  [-20.20478999]


portfolio before change:  [-10.40117848]
curr_Stock_Price:  99.90145175943043
curr_Factors:  [99.90145176]
mat_Sqrt:  [[0.15]]
grads:  [-0.02869451]
Stock Position:  -0.02869450973032321
Bond Position:  [-7.5345553]


portfolio before change:  [-10.41189319]
curr_Stock_Price:  100.20920528579227
curr_Factors:  [100.20920529]
mat_Sqrt:  [[0.15]]
grads:  [-0.06515027]
Stock Position:  -0.06515026992500376
Bond Position:  [-3.88323642]


portfolio before change:  [-10.44429347]
curr_Stock_Price:  100.69161833207345
curr_Factors:  [100.69161833]
mat_Sqrt:  [[0.15]]
grads:  [0.01748754]
Stock Position:  0.01748754063062753
Bond Position:  [-12.20514223]


portfolio before change:  [-10.45263917]
curr_Stock_Price:  100.38888663003728
curr_Factors:  [100.38888663]
mat_Sqrt:  [[0.15]]
grads:  [-0.01944074]
Stock Position:  -0.019440740156908772
Bond Position:  [-8.50100491]


portfolio before change:  [-10.43437857]
curr_Stock_Price:  99.34025832975571
curr_Factors:  [99.34025833]
mat_Sqrt:  [[0.15]]
grads:  [-0.02727135]
Stock Position:  -0.027271351902272083
Bond Position:  [-7.72523543]


portfolio before change:  [-10.43918797]
curr_Stock_Price:  99.44578463275334
curr_Factors:  [99.44578463]
mat_Sqrt:  [[0.15]]
grads:  [0.03237032]
Stock Position:  0.0323703201547097
Bond Position:  [-13.65827985]


portfolio before change:  [-10.41339747]
curr_Stock_Price:  100.34801538363556
curr_Factors:  [100.34801538]
mat_Sqrt:  [[0.15]]
grads:  [-0.00236387]
Stock Position:  -0.0023638692386184976
Bond Position:  [-10.17618788]


portfolio before change:  [-10.41641455]
curr_Stock_Price:  100.54799114236262
curr_Factors:  [100.54799114]
mat_Sqrt:  [[0.15]]
grads:  [0.01721051]
Stock Position:  0.017210505840735916
Bond Position:  [-12.14689634]


portfolio before change:  [-10.42628116]
curr_Stock_Price:  100.15116924115061
curr_Factors:  [100.15116924]
mat_Sqrt:  [[0.15]]
grads:  [0.12007231]
Stock Position:  0.12007230655525529
Bond Position:  [-22.45166305]


portfolio before change:  [-10.44386353]
curr_Stock_Price:  100.05148965734958
curr_Factors:  [100.05148966]
mat_Sqrt:  [[0.15]]
grads:  [0.02892205]
Stock Position:  0.028922050304758147
Bond Position:  [-13.33755775]


portfolio before change:  [-10.42654378]
curr_Stock_Price:  100.76563534157725
curr_Factors:  [100.76563534]
mat_Sqrt:  [[0.15]]
grads:  [0.06533783]
Stock Position:  0.06533783406883907
Bond Position:  [-17.01035214]


portfolio before change:  [-10.56756181]
curr_Stock_Price:  98.67243913270399
curr_Factors:  [98.67243913]
mat_Sqrt:  [[0.15]]
grads:  [-0.02791346]
Stock Position:  -0.027913455900020097
Bond Position:  [-7.81327303]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.58092597]
Stock Price:  99.08122422063596
PL:  [-10.58092597]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.38215374e-03]
 [-8.24158638e-04]
 [-6.34650131e-03]
 [-1.51176103e-02]
 [ 6.42674705e-03]
 [-9.67362000e-03]
 [ 6.23434105e-03]
 [-4.40310886e-03]
 [-7.94762507e-04]
 [ 1.02853776e-02]
 [-4.55113607e-03]
 [ 8.65308863e-03]
 [ 5.94010391e-03]
 [-1.08373035e-03]
 [ 8.29330469e-03]
 [ 2.13905861e-02]
 [ 7.98110972e-03]
 [ 3.42777164e-03]
 [-4.13775348e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.09067092]
curr_Stock_Price:  99.83266349783551
curr_Factors:  [99.8326635]
mat_Sqrt:  [[0.15]]
grads:  [0.01588102]
Stock Position:  0.015881024907218762
Bond Position:  [-3.67611594]


portfolio before change:  [-2.12117603]
curr_Stock_Price:  97.96968807188804
curr_Factors:  [97.96968807]
mat_Sqrt:  [[0.15]]
grads:  [-0.00549439]
Stock Position:  -0.005494390919947529
Bond Position:  [-1.58289226]


portfolio before change:  [-2.12623411]
curr_Stock_Price:  98.81824611992417
curr_Factors:  [98.81824612]
mat_Sqrt:  [[0.15]]
grads:  [-0.04231001]
Stock Position:  -0.04231000874145069
Bond Position:  [2.05476675]


portfolio before change:  [-2.1231633]
curr_Stock_Price:  98.75780997658013
curr_Factors:  [98.75780998]
mat_Sqrt:  [[0.15]]
grads:  [-0.10078407]
Stock Position:  -0.10078406896631248
Bond Position:  [7.83005063]


portfolio before change:  [-2.30269199]
curr_Stock_Price:  100.55855540318215
curr_Factors:  [100.5585554]
mat_Sqrt:  [[0.15]]
grads:  [0.04284498]
Stock Position:  0.04284498034653116
Bond Position:  [-6.61112132]


portfolio before change:  [-2.25940662]
curr_Stock_Price:  101.60741478315533
curr_Factors:  [101.60741478]
mat_Sqrt:  [[0.15]]
grads:  [-0.0644908]
Stock Position:  -0.06449080000765438
Bond Position:  [4.29333685]


portfolio before change:  [-2.22724587]
curr_Stock_Price:  101.12537267149577
curr_Factors:  [101.12537267]
mat_Sqrt:  [[0.15]]
grads:  [0.04156227]
Stock Position:  0.04156227367727226
Bond Position:  [-6.43024629]


portfolio before change:  [-2.27986134]
curr_Stock_Price:  99.89811294158865
curr_Factors:  [99.89811294]
mat_Sqrt:  [[0.15]]
grads:  [-0.02935406]
Stock Position:  -0.02935405904362061
Bond Position:  [0.65255377]


portfolio before change:  [-2.26483028]
curr_Stock_Price:  99.39161066608182
curr_Factors:  [99.39161067]
mat_Sqrt:  [[0.15]]
grads:  [-0.00529842]
Stock Position:  -0.005298416716337639
Bond Position:  [-1.73821211]


portfolio before change:  [-2.25815908]
curr_Stock_Price:  98.0504919674919
curr_Factors:  [98.05049197]
mat_Sqrt:  [[0.15]]
grads:  [0.06856918]
Stock Position:  0.06856918370726717
Bond Position:  [-8.98140128]


portfolio before change:  [-2.23750463]
curr_Stock_Price:  98.38446244816939
curr_Factors:  [98.38446245]
mat_Sqrt:  [[0.15]]
grads:  [-0.03034091]
Stock Position:  -0.030340907108067784
Bond Position:  [0.74756921]


portfolio before change:  [-2.18292997]
curr_Stock_Price:  96.5919074531819
curr_Factors:  [96.59190745]
mat_Sqrt:  [[0.15]]
grads:  [0.05768726]
Stock Position:  0.057687257533629695
Bond Position:  [-7.75505221]


portfolio before change:  [-2.16396352]
curr_Stock_Price:  96.95430048615991
curr_Factors:  [96.95430049]
mat_Sqrt:  [[0.15]]
grads:  [0.03960069]
Stock Position:  0.03960069272716398
Bond Position:  [-6.00342098]


portfolio before change:  [-2.14321786]
curr_Stock_Price:  97.51607600074045
curr_Factors:  [97.516076]
mat_Sqrt:  [[0.15]]
grads:  [-0.00722487]
Stock Position:  -0.007224869013853128
Bond Position:  [-1.43867698]


portfolio before change:  [-2.13593581]
curr_Stock_Price:  96.45837308166126
curr_Factors:  [96.45837308]
mat_Sqrt:  [[0.15]]
grads:  [0.0552887]
Stock Position:  0.0552886979199069
Bond Position:  [-7.46899366]


portfolio before change:  [-2.18895868]
curr_Stock_Price:  95.53313173511778
curr_Factors:  [95.53313174]
mat_Sqrt:  [[0.15]]
grads:  [0.14260391]
Stock Position:  0.14260390750592095
Bond Position:  [-15.81235656]


portfolio before change:  [-2.11824268]
curr_Stock_Price:  96.05674700395957
curr_Factors:  [96.056747]
mat_Sqrt:  [[0.15]]
grads:  [0.0532074]
Stock Position:  0.05320739815176074
Bond Position:  [-7.22917226]


portfolio before change:  [-2.02468395]
curr_Stock_Price:  97.84909631454052
curr_Factors:  [97.84909631]
mat_Sqrt:  [[0.15]]
grads:  [0.02285181]
Stock Position:  0.02285181090123214
Bond Position:  [-4.260713]


portfolio before change:  [-2.01455322]
curr_Stock_Price:  98.3390375639279
curr_Factors:  [98.33903756]
mat_Sqrt:  [[0.15]]
grads:  [-0.02758502]
Stock Position:  -0.027585023187701337
Bond Position:  [0.69813141]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.04826313]
Stock Price:  99.56740199569981
PL:  [-2.04826313]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.72380372e-03]
 [-4.87362947e-03]
 [-4.85646961e-03]
 [-1.35186608e-02]
 [ 6.42471976e-03]
 [-9.51736682e-03]
 [-2.13918479e-03]
 [ 9.82993105e-04]
 [ 2.11873433e-02]
 [-2.75349705e-03]
 [-3.70989246e-03]
 [ 2.78999909e-02]
 [ 1.59824482e-02]
 [-6.78277264e-03]
 [ 3.10783624e-02]
 [ 1.68285592e-02]
 [ 1.55538258e-02]
 [ 1.73174139e-02]
 [-2.31605182e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.29143779]
curr_Stock_Price:  99.73281052252946
curr_Factors:  [99.73281052]
mat_Sqrt:  [[0.15]]
grads:  [0.01815869]
Stock Position:  0.018158691475491998
Bond Position:  [-6.10245513]


portfolio before change:  [-4.27854186]
curr_Stock_Price:  100.52701634989532
curr_Factors:  [100.52701635]
mat_Sqrt:  [[0.15]]
grads:  [-0.03249086]
Stock Position:  -0.03249086311384803
Bond Position:  [-1.01233233]


portfolio before change:  [-4.25999323]
curr_Stock_Price:  99.94833835686923
curr_Factors:  [99.94833836]
mat_Sqrt:  [[0.15]]
grads:  [-0.03237646]
Stock Position:  -0.032376464056578125
Bond Position:  [-1.02401944]


portfolio before change:  [-4.26482632]
curr_Stock_Price:  100.08970833945298
curr_Factors:  [100.08970834]
mat_Sqrt:  [[0.15]]
grads:  [-0.09012441]
Stock Position:  -0.09012440504391915
Bond Position:  [4.75569909]


portfolio before change:  [-4.24913578]
curr_Stock_Price:  99.92880332730903
curr_Factors:  [99.92880333]
mat_Sqrt:  [[0.15]]
grads:  [0.04283147]
Stock Position:  0.042831465057344545
Bond Position:  [-8.52923283]


portfolio before change:  [-4.18594405]
curr_Stock_Price:  101.45395083434991
curr_Factors:  [101.45395083]
mat_Sqrt:  [[0.15]]
grads:  [-0.06344911]
Stock Position:  -0.0634491121176382
Bond Position:  [2.25121905]


portfolio before change:  [-4.26665493]
curr_Stock_Price:  102.73487894844337
curr_Factors:  [102.73487895]
mat_Sqrt:  [[0.15]]
grads:  [-0.01426123]
Stock Position:  -0.014261231909331092
Bond Position:  [-2.801529]


portfolio before change:  [-4.28353037]
curr_Stock_Price:  103.86907058745469
curr_Factors:  [103.86907059]
mat_Sqrt:  [[0.15]]
grads:  [0.00655329]
Stock Position:  0.00655328736707436
Bond Position:  [-4.96421424]


portfolio before change:  [-4.2742212]
curr_Stock_Price:  105.47900779181998
curr_Factors:  [105.47900779]
mat_Sqrt:  [[0.15]]
grads:  [0.14124896]
Stock Position:  0.14124895551625696
Bond Position:  [-19.17302088]


portfolio before change:  [-4.14827939]
curr_Stock_Price:  106.40457681299364
curr_Factors:  [106.40457681]
mat_Sqrt:  [[0.15]]
grads:  [-0.01835665]
Stock Position:  -0.018356647025673696
Bond Position:  [-2.19504814]


portfolio before change:  [-4.14304424]
curr_Stock_Price:  106.08948748836137
curr_Factors:  [106.08948749]
mat_Sqrt:  [[0.15]]
grads:  [-0.02473262]
Stock Position:  -0.02473261638627556
Bond Position:  [-1.51917365]


portfolio before change:  [-4.18949624]
curr_Stock_Price:  107.95229730600263
curr_Factors:  [107.95229731]
mat_Sqrt:  [[0.15]]
grads:  [0.18599994]
Stock Position:  0.1859999394726762
Bond Position:  [-24.26861701]


portfolio before change:  [-4.16819697]
curr_Stock_Price:  108.09943277458753
curr_Factors:  [108.09943277]
mat_Sqrt:  [[0.15]]
grads:  [0.10654965]
Stock Position:  0.10654965489789117
Bond Position:  [-15.68615422]


portfolio before change:  [-4.1116534]
curr_Stock_Price:  108.66692029271466
curr_Factors:  [108.66692029]
mat_Sqrt:  [[0.15]]
grads:  [-0.04521848]
Stock Position:  -0.045218484270104733
Bond Position:  [0.80210003]


portfolio before change:  [-4.16351863]
curr_Stock_Price:  109.81834733329407
curr_Factors:  [109.81834733]
mat_Sqrt:  [[0.15]]
grads:  [0.20718908]
Stock Position:  0.2071890828032464
Bond Position:  [-26.91668129]


portfolio before change:  [-3.93664309]
curr_Stock_Price:  110.94584669885973
curr_Factors:  [110.9458467]
mat_Sqrt:  [[0.15]]
grads:  [0.11219039]
Stock Position:  0.11219039466265096
Bond Position:  [-16.38370141]


portfolio before change:  [-3.86650829]
curr_Stock_Price:  111.60750079368928
curr_Factors:  [111.60750079]
mat_Sqrt:  [[0.15]]
grads:  [0.10369217]
Stock Position:  0.10369217194483704
Bond Position:  [-15.43933245]


portfolio before change:  [-3.79846434]
curr_Stock_Price:  112.3009404721424
curr_Factors:  [112.30094047]
mat_Sqrt:  [[0.15]]
grads:  [0.11544943]
Stock Position:  0.11544942568739981
Bond Position:  [-16.76354342]


portfolio before change:  [-3.80854191]
curr_Stock_Price:  112.24995568927528
curr_Factors:  [112.24995569]
mat_Sqrt:  [[0.15]]
grads:  [-0.15440345]
Stock Position:  -0.15440345481241388
Bond Position:  [13.52323905]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.08364768]
Stock Price:  114.05358759620648
PL:  [-18.13723527]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-8.71043551e-03]
 [ 1.31822588e-02]
 [-5.23381537e-03]
 [-1.38103333e-02]
 [-3.57457342e-03]
 [-1.06494256e-02]
 [ 1.41850870e-02]
 [-2.23948193e-02]
 [ 1.07292269e-03]
 [ 1.03911883e-02]
 [-4.51033392e-03]
 [ 3.15212544e-03]
 [ 5.08045201e-03]
 [-8.72981277e-04]
 [ 8.13064434e-03]
 [ 1.95384065e-02]
 [ 7.16118370e-03]
 [ 1.26321380e-03]
 [-9.36362135e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.69316459]
curr_Stock_Price:  100.45806231062451
curr_Factors:  [100.45806231]
mat_Sqrt:  [[0.15]]
grads:  [-0.05806957]
Stock Position:  -0.05806957007695545
Bond Position:  [17.52672108]


portfolio before change:  [11.66019144]
curr_Stock_Price:  101.1013490613425
curr_Factors:  [101.10134906]
mat_Sqrt:  [[0.15]]
grads:  [0.08788173]
Stock Position:  0.08788172560635261
Bond Position:  [2.77523042]


portfolio before change:  [11.48040403]
curr_Stock_Price:  99.04766497519326
curr_Factors:  [99.04766498]
mat_Sqrt:  [[0.15]]
grads:  [-0.0348921]
Stock Position:  -0.03489210248143646
Bond Position:  [14.93638531]


portfolio before change:  [11.50308572]
curr_Stock_Price:  98.50464439012507
curr_Factors:  [98.50464439]
mat_Sqrt:  [[0.15]]
grads:  [-0.09206889]
Stock Position:  -0.0920688889858102
Bond Position:  [20.57229889]


portfolio before change:  [11.62342135]
curr_Stock_Price:  97.2534952954621
curr_Factors:  [97.2534953]
mat_Sqrt:  [[0.15]]
grads:  [-0.02383049]
Stock Position:  -0.023830489471334
Bond Position:  [13.94101974]


portfolio before change:  [11.59202627]
curr_Stock_Price:  98.71719851308862
curr_Factors:  [98.71719851]
mat_Sqrt:  [[0.15]]
grads:  [-0.07099617]
Stock Position:  -0.07099617067653757
Bond Position:  [18.60056935]


portfolio before change:  [11.55834657]
curr_Stock_Price:  99.25709287839456
curr_Factors:  [99.25709288]
mat_Sqrt:  [[0.15]]
grads:  [0.09456725]
Stock Position:  0.09456724651931771
Bond Position:  [2.17187659]


portfolio before change:  [11.54648668]
curr_Stock_Price:  99.12593832098293
curr_Factors:  [99.12593832]
mat_Sqrt:  [[0.15]]
grads:  [-0.1492988]
Stock Position:  -0.14929879553241923
Bond Position:  [26.34586987]


portfolio before change:  [11.8718175]
curr_Stock_Price:  96.99100127098743
curr_Factors:  [96.99100127]
mat_Sqrt:  [[0.15]]
grads:  [0.00715282]
Stock Position:  0.007152817937513297
Bond Position:  [11.17805852]


portfolio before change:  [11.88332604]
curr_Stock_Price:  98.20921735844423
curr_Factors:  [98.20921736]
mat_Sqrt:  [[0.15]]
grads:  [0.06927459]
Stock Position:  0.06927458884113681
Bond Position:  [5.07992289]


portfolio before change:  [11.89868937]
curr_Stock_Price:  98.41265691197289
curr_Factors:  [98.41265691]
mat_Sqrt:  [[0.15]]
grads:  [-0.03006889]
Stock Position:  -0.030068892809189507
Bond Position:  [14.857849]


portfolio before change:  [11.92387935]
curr_Stock_Price:  97.69846193044441
curr_Factors:  [97.69846193]
mat_Sqrt:  [[0.15]]
grads:  [0.02101417]
Stock Position:  0.021014169609193587
Bond Position:  [9.8708273]


portfolio before change:  [11.9443748]
curr_Stock_Price:  98.55633227730333
curr_Factors:  [98.55633228]
mat_Sqrt:  [[0.15]]
grads:  [0.03386968]
Stock Position:  0.03386968009329348
Bond Position:  [8.60630335]


portfolio before change:  [11.94735839]
curr_Stock_Price:  98.58088950072
curr_Factors:  [98.5808895]
mat_Sqrt:  [[0.15]]
grads:  [-0.00581988]
Stock Position:  -0.005819875177359699
Bond Position:  [12.52108686]


portfolio before change:  [11.95690211]
curr_Stock_Price:  97.47896533691525
curr_Factors:  [97.47896534]
mat_Sqrt:  [[0.15]]
grads:  [0.0542043]
Stock Position:  0.0542042955826862
Bond Position:  [6.67312346]


portfolio before change:  [11.9348044]
curr_Stock_Price:  97.04050933675158
curr_Factors:  [97.04050934]
mat_Sqrt:  [[0.15]]
grads:  [0.13025604]
Stock Position:  0.13025604301676935
Bond Position:  [-0.70530836]


portfolio before change:  [11.90223635]
curr_Stock_Price:  96.79183215421381
curr_Factors:  [96.79183215]
mat_Sqrt:  [[0.15]]
grads:  [0.04774122]
Stock Position:  0.047741224668288465
Bond Position:  [7.28127574]


portfolio before change:  [11.91384162]
curr_Stock_Price:  96.99678558183092
curr_Factors:  [96.99678558]
mat_Sqrt:  [[0.15]]
grads:  [0.00842143]
Stock Position:  0.008421425347609635
Bond Position:  [11.09699043]


portfolio before change:  [11.89688829]
curr_Stock_Price:  94.65419740728753
curr_Factors:  [94.65419741]
mat_Sqrt:  [[0.15]]
grads:  [-0.06242414]
Stock Position:  -0.06242414235482678
Bond Position:  [17.80559538]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.02509121]
Stock Price:  92.67177585670564
PL:  [12.02509121]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 1.91471794e-03]
 [-1.43930837e-03]
 [-1.33036226e-02]
 [ 9.67559521e-03]
 [-6.80083207e-03]
 [-1.13584929e-02]
 [ 1.32357767e-02]
 [-5.02330458e-02]
 [ 3.99727564e-03]
 [ 5.56737342e-03]
 [-1.24781475e-02]
 [ 8.41209264e-03]
 [ 5.00300028e-03]
 [-7.73146661e-04]
 [ 3.80934945e-03]
 [ 1.99044381e-02]
 [ 3.34232120e-03]
 [ 9.94127574e-03]
 [-5.24938631e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.71264091]
curr_Stock_Price:  99.12386503113301
curr_Factors:  [99.12386503]
mat_Sqrt:  [[0.15]]
grads:  [0.01276479]
Stock Position:  0.012764786286819964
Bond Position:  [-18.97793586]


portfolio before change:  [-17.72580864]
curr_Stock_Price:  98.46402928849037
curr_Factors:  [98.46402929]
mat_Sqrt:  [[0.15]]
grads:  [-0.00959539]
Stock Position:  -0.009595389148210325
Bond Position:  [-16.78100797]


portfolio before change:  [-17.71501322]
curr_Stock_Price:  96.90169552275209
curr_Factors:  [96.90169552]
mat_Sqrt:  [[0.15]]
grads:  [-0.08869082]
Stock Position:  -0.08869081702625277
Bond Position:  [-9.12072267]


portfolio before change:  [-17.72012676]
curr_Stock_Price:  96.93363873461612
curr_Factors:  [96.93363873]
mat_Sqrt:  [[0.15]]
grads:  [0.06450397]
Stock Position:  0.06450396809804121
Bond Position:  [-23.9727311]


portfolio before change:  [-17.76761597]
curr_Stock_Price:  96.29034063254123
curr_Factors:  [96.29034063]
mat_Sqrt:  [[0.15]]
grads:  [-0.04533888]
Stock Position:  -0.04533888046848003
Bond Position:  [-13.40191972]


portfolio before change:  [-17.77566728]
curr_Stock_Price:  96.39401357193107
curr_Factors:  [96.39401357]
mat_Sqrt:  [[0.15]]
grads:  [-0.07572329]
Stock Position:  -0.07572328595365162
Bond Position:  [-10.47639583]


portfolio before change:  [-17.72830928]
curr_Stock_Price:  95.73401283383437
curr_Factors:  [95.73401283]
mat_Sqrt:  [[0.15]]
grads:  [0.08823851]
Stock Position:  0.08823851105034422
Bond Position:  [-26.17573603]


portfolio before change:  [-17.79019234]
curr_Stock_Price:  95.10686830222575
curr_Factors:  [95.1068683]
mat_Sqrt:  [[0.15]]
grads:  [-0.33488697]
Stock Position:  -0.33488697178521304
Bond Position:  [14.05985879]


portfolio before change:  [-17.88085786]
curr_Stock_Price:  95.38810030251486
curr_Factors:  [95.3881003]
mat_Sqrt:  [[0.15]]
grads:  [0.0266485]
Stock Position:  0.026648504279818908
Bond Position:  [-20.42280806]


portfolio before change:  [-17.90290156]
curr_Stock_Price:  94.75251652135096
curr_Factors:  [94.75251652]
mat_Sqrt:  [[0.15]]
grads:  [0.03711582]
Stock Position:  0.03711582281982126
Bond Position:  [-21.41971918]


portfolio before change:  [-17.89796683]
curr_Stock_Price:  95.02976571677058
curr_Factors:  [95.02976572]
mat_Sqrt:  [[0.15]]
grads:  [-0.08318765]
Stock Position:  -0.08318765005950547
Bond Position:  [-9.99266393]


portfolio before change:  [-18.03416364]
curr_Stock_Price:  96.63695542404405
curr_Factors:  [96.63695542]
mat_Sqrt:  [[0.15]]
grads:  [0.05608062]
Stock Position:  0.05608061760829374
Bond Position:  [-23.45362379]


portfolio before change:  [-17.92510244]
curr_Stock_Price:  98.68624343249478
curr_Factors:  [98.68624343]
mat_Sqrt:  [[0.15]]
grads:  [0.03335334]
Stock Position:  0.03335333521957618
Bond Position:  [-21.2166178]


portfolio before change:  [-17.92157464]
curr_Stock_Price:  98.9510632784404
curr_Factors:  [98.95106328]
mat_Sqrt:  [[0.15]]
grads:  [-0.00515431]
Stock Position:  -0.005154311076232452
Bond Position:  [-17.41155007]


portfolio before change:  [-17.93183591]
curr_Stock_Price:  100.09725670207185
curr_Factors:  [100.0972567]
mat_Sqrt:  [[0.15]]
grads:  [0.02539566]
Stock Position:  0.0253956629849515
Bond Position:  [-20.4738721]


portfolio before change:  [-17.92363174]
curr_Stock_Price:  100.62188450742218
curr_Factors:  [100.62188451]
mat_Sqrt:  [[0.15]]
grads:  [0.13269625]
Stock Position:  0.13269625430045695
Bond Position:  [-31.27577892]


portfolio before change:  [-17.92294507]
curr_Stock_Price:  100.68599024759574
curr_Factors:  [100.68599025]
mat_Sqrt:  [[0.15]]
grads:  [0.02228214]
Stock Position:  0.022282141308125062
Bond Position:  [-20.16644454]


portfolio before change:  [-17.92402294]
curr_Stock_Price:  100.86390722069946
curr_Factors:  [100.86390722]
mat_Sqrt:  [[0.15]]
grads:  [0.06627517]
Stock Position:  0.06627517162015749
Bond Position:  [-24.6087957]


portfolio before change:  [-17.91621027]
curr_Stock_Price:  101.07462924997155
curr_Factors:  [101.07462925]
mat_Sqrt:  [[0.15]]
grads:  [-0.03499591]
Stock Position:  -0.034995908765398646
Bond Position:  [-14.37901177]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.00461137]
Stock Price:  103.49793812721751
PL:  [-21.5025495]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.96232796e-02]
 [ 2.58201537e-03]
 [-1.90780800e-02]
 [ 1.60850739e-02]
 [ 5.24717337e-03]
 [-1.05741054e-02]
 [ 1.39585739e-02]
 [-4.42167035e-02]
 [-1.16710881e-03]
 [ 1.01688547e-02]
 [-3.28871551e-03]
 [-4.23541002e-03]
 [ 4.95418286e-03]
 [-7.96802826e-04]
 [ 5.92361933e-03]
 [ 1.72643739e-02]
 [ 5.93625482e-03]
 [ 1.63217513e-03]
 [-7.69390415e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [34.36780877]
curr_Stock_Price:  101.48685400873143
curr_Factors:  [101.48685401]
mat_Sqrt:  [[0.15]]
grads:  [-0.13082186]
Stock Position:  -0.1308218641472511
Bond Position:  [47.6445082]


portfolio before change:  [34.47818172]
curr_Stock_Price:  100.7342249719282
curr_Factors:  [100.73422497]
mat_Sqrt:  [[0.15]]
grads:  [0.01721344]
Stock Position:  0.017213435768379873
Bond Position:  [32.74419961]


portfolio before change:  [34.49515367]
curr_Stock_Price:  101.24457494254075
curr_Factors:  [101.24457494]
mat_Sqrt:  [[0.15]]
grads:  [-0.1271872]
Stock Position:  -0.12718720006003512
Bond Position:  [47.37216768]


portfolio before change:  [34.50774313]
curr_Stock_Price:  101.23871795169782
curr_Factors:  [101.23871795]
mat_Sqrt:  [[0.15]]
grads:  [0.10723383]
Stock Position:  0.10723382575723603
Bond Position:  [23.65152809]


portfolio before change:  [34.29885055]
curr_Stock_Price:  99.23556089260333
curr_Factors:  [99.23556089]
mat_Sqrt:  [[0.15]]
grads:  [0.03498116]
Stock Position:  0.0349811557862351
Bond Position:  [30.82747594]


portfolio before change:  [34.29566743]
curr_Stock_Price:  98.92422321738964
curr_Factors:  [98.92422322]
mat_Sqrt:  [[0.15]]
grads:  [-0.07049404]
Stock Position:  -0.07049403570424204
Bond Position:  [41.26923516]


portfolio before change:  [34.29721137]
curr_Stock_Price:  99.04869702044293
curr_Factors:  [99.04869702]
mat_Sqrt:  [[0.15]]
grads:  [0.09305716]
Stock Position:  0.09305715935644962
Bond Position:  [25.08002099]


portfolio before change:  [34.13087651]
curr_Stock_Price:  97.19386232964006
curr_Factors:  [97.19386233]
mat_Sqrt:  [[0.15]]
grads:  [-0.29477802]
Stock Position:  -0.29477802314821705
Bond Position:  [62.78149111]


portfolio before change:  [33.88318928]
curr_Stock_Price:  98.08736368628516
curr_Factors:  [98.08736369]
mat_Sqrt:  [[0.15]]
grads:  [-0.00778073]
Stock Position:  -0.007780725412467694
Bond Position:  [34.64638013]


portfolio before change:  [33.89349888]
curr_Stock_Price:  97.8756974958192
curr_Factors:  [97.8756975]
mat_Sqrt:  [[0.15]]
grads:  [0.06779236]
Stock Position:  0.0677923645925044
Bond Position:  [27.25827391]


portfolio before change:  [33.99066818]
curr_Stock_Price:  99.20850069190035
curr_Factors:  [99.20850069]
mat_Sqrt:  [[0.15]]
grads:  [-0.02192477]
Stock Position:  -0.021924770047762995
Bond Position:  [36.16579174]


portfolio before change:  [33.99555588]
curr_Stock_Price:  99.39800691924897
curr_Factors:  [99.39800692]
mat_Sqrt:  [[0.15]]
grads:  [-0.02823607]
Stock Position:  -0.028236066772759742
Bond Position:  [36.80216464]


portfolio before change:  [34.02254294]
curr_Stock_Price:  98.76812575522963
curr_Factors:  [98.76812576]
mat_Sqrt:  [[0.15]]
grads:  [0.03302789]
Stock Position:  0.0330278857419706
Bond Position:  [30.76044056]


portfolio before change:  [34.03337904]
curr_Stock_Price:  98.86334929435168
curr_Factors:  [98.86334929]
mat_Sqrt:  [[0.15]]
grads:  [-0.00531202]
Stock Position:  -0.005312018840774303
Bond Position:  [34.55854301]


portfolio before change:  [34.03934829]
curr_Stock_Price:  99.36625798845013
curr_Factors:  [99.36625799]
mat_Sqrt:  [[0.15]]
grads:  [0.0394908]
Stock Position:  0.03949079551067967
Bond Position:  [30.11529572]


portfolio before change:  [34.0158903]
curr_Stock_Price:  98.58157482250049
curr_Factors:  [98.58157482]
mat_Sqrt:  [[0.15]]
grads:  [0.11509583]
Stock Position:  0.11509582621378463
Bond Position:  [22.66956249]


portfolio before change:  [34.00617446]
curr_Stock_Price:  98.44791285534914
curr_Factors:  [98.44791286]
mat_Sqrt:  [[0.15]]
grads:  [0.03957503]
Stock Position:  0.03957503210554745
Bond Position:  [30.11009515]


portfolio before change:  [33.96203637]
curr_Stock_Price:  97.14237861177187
curr_Factors:  [97.14237861]
mat_Sqrt:  [[0.15]]
grads:  [0.01088117]
Stock Position:  0.010881167504844542
Bond Position:  [32.90501387]


portfolio before change:  [33.95869114]
curr_Stock_Price:  96.07884349588105
curr_Factors:  [96.0788435]
mat_Sqrt:  [[0.15]]
grads:  [-0.05129269]
Stock Position:  -0.051292694334614024
Bond Position:  [38.8868339]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [34.01140772]
Stock Price:  95.24064128818469
PL:  [34.01140772]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.78009215e-03]
 [-3.42957735e-03]
 [-8.91445010e-03]
 [-9.72625731e-03]
 [ 8.66829275e-04]
 [-1.06659836e-02]
 [ 1.36510574e-02]
 [-4.03471396e-02]
 [-1.44597837e-03]
 [ 4.53335412e-03]
 [-3.05390613e-03]
 [-2.19850175e-03]
 [ 7.10141950e-03]
 [ 1.43067640e-04]
 [ 5.24962231e-05]
 [ 2.29680835e-02]
 [ 1.97018025e-03]
 [ 9.06681986e-03]
 [-5.27430569e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.04559564]
curr_Stock_Price:  99.60784914699288
curr_Factors:  [99.60784915]
mat_Sqrt:  [[0.15]]
grads:  [0.01853395]
Stock Position:  0.01853394767211273
Bond Position:  [-8.8917223]


portfolio before change:  [-7.06387297]
curr_Stock_Price:  98.74164796645235
curr_Factors:  [98.74164797]
mat_Sqrt:  [[0.15]]
grads:  [-0.02286385]
Stock Position:  -0.022863849008472492
Bond Position:  [-4.80625884]


portfolio before change:  [-7.05258486]
curr_Stock_Price:  98.19537832814912
curr_Factors:  [98.19537833]
mat_Sqrt:  [[0.15]]
grads:  [-0.05942967]
Stock Position:  -0.05942966730615752
Bond Position:  [-1.2168662]


portfolio before change:  [-7.04409725]
curr_Stock_Price:  98.04744090606334
curr_Factors:  [98.04744091]
mat_Sqrt:  [[0.15]]
grads:  [-0.06484172]
Stock Position:  -0.06484171542682768
Bond Position:  [-0.68653298]


portfolio before change:  [-7.06154939]
curr_Stock_Price:  98.31394363430893
curr_Factors:  [98.31394363]
mat_Sqrt:  [[0.15]]
grads:  [0.00577886]
Stock Position:  0.0057788618366606415
Bond Position:  [-7.62969209]


portfolio before change:  [-7.06147438]
curr_Stock_Price:  98.65703485519644
curr_Factors:  [98.65703486]
mat_Sqrt:  [[0.15]]
grads:  [-0.07110656]
Stock Position:  -0.07110655751946192
Bond Position:  [-0.04631225]


portfolio before change:  [-7.05539142]
curr_Stock_Price:  98.57132487737705
curr_Factors:  [98.57132488]
mat_Sqrt:  [[0.15]]
grads:  [0.09100705]
Stock Position:  0.09100704965885086
Bond Position:  [-16.02607687]


portfolio before change:  [-7.11692859]
curr_Stock_Price:  97.93917432577855
curr_Factors:  [97.93917433]
mat_Sqrt:  [[0.15]]
grads:  [-0.26898093]
Stock Position:  -0.26898093090961894
Bond Position:  [19.22684169]


portfolio before change:  [-7.42448497]
curr_Stock_Price:  99.10045993730007
curr_Factors:  [99.10045994]
mat_Sqrt:  [[0.15]]
grads:  [-0.00963986]
Stock Position:  -0.009639855826822197
Bond Position:  [-6.46917082]


portfolio before change:  [-7.43651687]
curr_Stock_Price:  100.18080926710951
curr_Factors:  [100.18080927]
mat_Sqrt:  [[0.15]]
grads:  [0.03022236]
Stock Position:  0.030222360778531535
Bond Position:  [-10.46421743]


portfolio before change:  [-7.38863013]
curr_Stock_Price:  101.85186079726027
curr_Factors:  [101.8518608]
mat_Sqrt:  [[0.15]]
grads:  [-0.02035937]
Stock Position:  -0.020359374223641535
Bond Position:  [-5.31498998]


portfolio before change:  [-7.41615726]
curr_Stock_Price:  103.13864965754141
curr_Factors:  [103.13864966]
mat_Sqrt:  [[0.15]]
grads:  [-0.01465668]
Stock Position:  -0.014656678347238645
Bond Position:  [-5.90448725]


portfolio before change:  [-7.40086819]
curr_Stock_Price:  101.99477684643247
curr_Factors:  [101.99477685]
mat_Sqrt:  [[0.15]]
grads:  [0.0473428]
Stock Position:  0.047342796689238735
Bond Position:  [-12.22958618]


portfolio before change:  [-7.43169842]
curr_Stock_Price:  101.40815235341195
curr_Factors:  [101.40815235]
mat_Sqrt:  [[0.15]]
grads:  [0.00095378]
Stock Position:  0.00095378426800644
Bond Position:  [-7.52841992]


portfolio before change:  [-7.43258623]
curr_Stock_Price:  102.45086938061542
curr_Factors:  [102.45086938]
mat_Sqrt:  [[0.15]]
grads:  [0.00034997]
Stock Position:  0.0003499748207014727
Bond Position:  [-7.46844145]


portfolio before change:  [-7.43441108]
curr_Stock_Price:  102.57229078544411
curr_Factors:  [102.57229079]
mat_Sqrt:  [[0.15]]
grads:  [0.15312056]
Stock Position:  0.1531205566398025
Bond Position:  [-23.14033734]


portfolio before change:  [-7.62207798]
curr_Stock_Price:  101.384461402563
curr_Factors:  [101.3844614]
mat_Sqrt:  [[0.15]]
grads:  [0.01313454]
Stock Position:  0.013134535010553672
Bond Position:  [-8.95371574]


portfolio before change:  [-7.63918169]
curr_Stock_Price:  100.25271208209982
curr_Factors:  [100.25271208]
mat_Sqrt:  [[0.15]]
grads:  [0.06044547]
Stock Position:  0.06044546570927105
Bond Position:  [-13.69900356]


portfolio before change:  [-7.59436808]
curr_Stock_Price:  101.05076680306864
curr_Factors:  [101.0507668]
mat_Sqrt:  [[0.15]]
grads:  [-0.03516204]
Stock Position:  -0.0351620379200368
Bond Position:  [-4.04121719]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.61811811]
Stock Price:  101.69747551275516
PL:  [-9.31559362]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-3.26582089e-04]
 [-8.11978085e-03]
 [-5.64973590e-03]
 [-2.00848419e-02]
 [ 6.14753456e-03]
 [-9.63446887e-03]
 [-1.82896616e-03]
 [ 7.53540183e-03]
 [ 9.21338937e-03]
 [-4.71532184e-04]
 [-4.21213872e-03]
 [ 2.04590191e-02]
 [ 1.65403928e-02]
 [-6.80582130e-03]
 [ 2.93003205e-02]
 [ 1.80609811e-02]
 [ 1.32337623e-02]
 [ 1.55248580e-02]
 [-1.99037979e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.55295294]
curr_Stock_Price:  100.04335353747007
curr_Factors:  [100.04335354]
mat_Sqrt:  [[0.15]]
grads:  [-0.00217721]
Stock Position:  -0.0021772139293542436
Bond Position:  [2.77076872]


portfolio before change:  [2.55496096]
curr_Stock_Price:  99.43925783344953
curr_Factors:  [99.43925783]
mat_Sqrt:  [[0.15]]
grads:  [-0.05413187]
Stock Position:  -0.05413187231078122
Bond Position:  [7.93779417]


portfolio before change:  [2.58207471]
curr_Stock_Price:  98.97503875516828
curr_Factors:  [98.97503876]
mat_Sqrt:  [[0.15]]
grads:  [-0.03766491]
Stock Position:  -0.037664906023692935
Bond Position:  [6.30996024]


portfolio before change:  [2.57168143]
curr_Stock_Price:  99.29286679631194
curr_Factors:  [99.2928668]
mat_Sqrt:  [[0.15]]
grads:  [-0.13389895]
Stock Position:  -0.13389894618986742
Bond Position:  [15.86689166]


portfolio before change:  [2.53966873]
curr_Stock_Price:  99.561576323056
curr_Factors:  [99.56157632]
mat_Sqrt:  [[0.15]]
grads:  [0.04098356]
Stock Position:  0.0409835637016895
Bond Position:  [-1.54071948]


portfolio before change:  [2.58787906]
curr_Stock_Price:  100.74730926480355
curr_Factors:  [100.74730926]
mat_Sqrt:  [[0.15]]
grads:  [-0.06422979]
Stock Position:  -0.06422979244901567
Bond Position:  [9.05885783]


portfolio before change:  [2.47008994]
curr_Stock_Price:  102.6164437452834
curr_Factors:  [102.61644375]
mat_Sqrt:  [[0.15]]
grads:  [-0.01219311]
Stock Position:  -0.012193107708519628
Bond Position:  [3.72130329]


portfolio before change:  [2.47388905]
curr_Stock_Price:  102.38117389959767
curr_Factors:  [102.3811739]
mat_Sqrt:  [[0.15]]
grads:  [0.05023601]
Stock Position:  0.050236012212514745
Bond Position:  [-2.66933285]


portfolio before change:  [2.57574935]
curr_Stock_Price:  104.42209447983177
curr_Factors:  [104.42209448]
mat_Sqrt:  [[0.15]]
grads:  [0.0614226]
Stock Position:  0.061422595815940756
Bond Position:  [-3.83812676]


portfolio before change:  [2.5962621]
curr_Stock_Price:  104.77167925819496
curr_Factors:  [104.77167926]
mat_Sqrt:  [[0.15]]
grads:  [-0.00314355]
Stock Position:  -0.0031435478923964983
Bond Position:  [2.92561689]


portfolio before change:  [2.5908664]
curr_Stock_Price:  106.7208127270199
curr_Factors:  [106.72081273]
mat_Sqrt:  [[0.15]]
grads:  [-0.02808092]
Stock Position:  -0.028080924787983932
Bond Position:  [5.58768552]


portfolio before change:  [2.59109952]
curr_Stock_Price:  106.76226373790979
curr_Factors:  [106.76226374]
mat_Sqrt:  [[0.15]]
grads:  [0.13639346]
Stock Position:  0.1363934604978371
Bond Position:  [-11.97057509]


portfolio before change:  [2.82264484]
curr_Stock_Price:  108.48183551960031
curr_Factors:  [108.48183552]
mat_Sqrt:  [[0.15]]
grads:  [0.11026929]
Stock Position:  0.11026928525052873
Bond Position:  [-9.13956962]


portfolio before change:  [2.84283104]
curr_Stock_Price:  108.68562188675493
curr_Factors:  [108.68562189]
mat_Sqrt:  [[0.15]]
grads:  [-0.04537214]
Stock Position:  -0.04537214201305189
Bond Position:  [7.77413051]


portfolio before change:  [2.81160785]
curr_Stock_Price:  109.41662037164318
curr_Factors:  [109.41662037]
mat_Sqrt:  [[0.15]]
grads:  [0.19533547]
Stock Position:  0.19533546991676864
Bond Position:  [-18.56133911]


portfolio before change:  [2.80332165]
curr_Stock_Price:  109.39795871014611
curr_Factors:  [109.39795871]
mat_Sqrt:  [[0.15]]
grads:  [0.12040654]
Stock Position:  0.12040654084114885
Bond Position:  [-10.36890813]


portfolio before change:  [2.84698526]
curr_Stock_Price:  109.78212522576645
curr_Factors:  [109.78212523]
mat_Sqrt:  [[0.15]]
grads:  [0.08822508]
Stock Position:  0.08822508219109262
Bond Position:  [-6.83855176]


portfolio before change:  [2.73115525]
curr_Stock_Price:  108.48861366335619
curr_Factors:  [108.48861366]
mat_Sqrt:  [[0.15]]
grads:  [0.10349905]
Stock Position:  0.10349905357517006
Bond Position:  [-8.49731359]


portfolio before change:  [2.92508254]
curr_Stock_Price:  110.38285207207694
curr_Factors:  [110.38285207]
mat_Sqrt:  [[0.15]]
grads:  [-0.13269199]
Stock Position:  -0.13269198590399794
Bond Position:  [17.57200239]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.82195753]
Stock Price:  111.19313880456214
PL:  [-8.37118128]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 4.41452557e-05]
 [-1.81848444e-03]
 [-6.52627308e-03]
 [-1.30983984e-02]
 [ 2.02646901e-03]
 [-1.07532644e-02]
 [ 1.31082686e-02]
 [-4.49660608e-02]
 [ 9.72181309e-05]
 [ 8.58788268e-03]
 [-7.36155020e-03]
 [ 1.07177454e-02]
 [ 6.44462736e-03]
 [-1.40237458e-03]
 [ 8.21652219e-03]
 [ 1.67677856e-02]
 [ 4.92136086e-03]
 [ 9.37166413e-03]
 [-5.31497855e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-26.71860363]
curr_Stock_Price:  98.71524738699395
curr_Factors:  [98.71524739]
mat_Sqrt:  [[0.15]]
grads:  [0.0002943]
Stock Position:  0.0002943017048983333
Bond Position:  [-26.7476557]


portfolio before change:  [-26.72535144]
curr_Stock_Price:  98.51116288070108
curr_Factors:  [98.51116288]
mat_Sqrt:  [[0.15]]
grads:  [-0.01212323]
Stock Position:  -0.012123229582017215
Bond Position:  [-25.531078]


portfolio before change:  [-26.7348042]
curr_Stock_Price:  98.7643289891287
curr_Factors:  [98.76432899]
mat_Sqrt:  [[0.15]]
grads:  [-0.04350849]
Stock Position:  -0.04350848722680711
Bond Position:  [-22.43771765]


portfolio before change:  [-26.72545277]
curr_Stock_Price:  98.42045207436836
curr_Factors:  [98.42045207]
mat_Sqrt:  [[0.15]]
grads:  [-0.08732266]
Stock Position:  -0.08732265616209078
Bond Position:  [-18.13111747]


portfolio before change:  [-26.74257508]
curr_Stock_Price:  98.5646182191645
curr_Factors:  [98.56461822]
mat_Sqrt:  [[0.15]]
grads:  [0.01350979]
Stock Position:  0.01350979341080788
Bond Position:  [-28.07416271]


portfolio before change:  [-26.75323329]
curr_Stock_Price:  98.29527403084668
curr_Factors:  [98.29527403]
mat_Sqrt:  [[0.15]]
grads:  [-0.07168843]
Stock Position:  -0.07168842959767315
Bond Position:  [-19.70659945]


portfolio before change:  [-26.72255284]
curr_Stock_Price:  97.7985731030709
curr_Factors:  [97.7985731]
mat_Sqrt:  [[0.15]]
grads:  [0.08738846]
Stock Position:  0.08738845747833929
Bond Position:  [-35.26901929]


portfolio before change:  [-26.77069128]
curr_Stock_Price:  97.34862714612127
curr_Factors:  [97.34862715]
mat_Sqrt:  [[0.15]]
grads:  [-0.29977374]
Stock Position:  -0.299773738951514
Bond Position:  [2.41187066]


portfolio before change:  [-26.81928409]
curr_Stock_Price:  97.51273709389818
curr_Factors:  [97.51273709]
mat_Sqrt:  [[0.15]]
grads:  [0.00064812]
Stock Position:  0.0006481208724478695
Bond Position:  [-26.88248413]


portfolio before change:  [-26.82655681]
curr_Stock_Price:  96.66218997215184
curr_Factors:  [96.66218997]
mat_Sqrt:  [[0.15]]
grads:  [0.05725255]
Stock Position:  0.0572525511987574
Bond Position:  [-32.36071379]


portfolio before change:  [-26.81361058]
curr_Stock_Price:  97.02963944455117
curr_Factors:  [97.02963944]
mat_Sqrt:  [[0.15]]
grads:  [-0.049077]
Stock Position:  -0.04907700133524371
Bond Position:  [-22.05168684]


portfolio before change:  [-26.77870112]
curr_Stock_Price:  96.20597323435857
curr_Factors:  [96.20597323]
mat_Sqrt:  [[0.15]]
grads:  [0.07145164]
Stock Position:  0.07145163609826295
Bond Position:  [-33.65277531]


portfolio before change:  [-26.81874615]
curr_Stock_Price:  95.76328519994856
curr_Factors:  [95.7632852]
mat_Sqrt:  [[0.15]]
grads:  [0.04296418]
Stock Position:  0.04296418239813329
Bond Position:  [-30.93313741]


portfolio before change:  [-26.81522203]
curr_Stock_Price:  96.0253262086882
curr_Factors:  [96.02532621]
mat_Sqrt:  [[0.15]]
grads:  [-0.00934916]
Stock Position:  -0.009349163889034093
Bond Position:  [-25.91746552]


portfolio before change:  [-26.83116024]
curr_Stock_Price:  97.03697146293811
curr_Factors:  [97.03697146]
mat_Sqrt:  [[0.15]]
grads:  [0.05477681]
Stock Position:  0.05477681458149211
Bond Position:  [-32.14653643]


portfolio before change:  [-26.71781956]
curr_Stock_Price:  99.25284176944977
curr_Factors:  [99.25284177]
mat_Sqrt:  [[0.15]]
grads:  [0.11178524]
Stock Position:  0.11178523765074912
Bond Position:  [-37.81282207]


portfolio before change:  [-26.70881269]
curr_Stock_Price:  99.41799108694065
curr_Factors:  [99.41799109]
mat_Sqrt:  [[0.15]]
grads:  [0.03280907]
Stock Position:  0.032809072398936705
Bond Position:  [-29.97062476]


portfolio before change:  [-26.68192927]
curr_Stock_Price:  100.4657809646411
curr_Factors:  [100.46578096]
mat_Sqrt:  [[0.15]]
grads:  [0.06247776]
Stock Position:  0.06247776087251917
Bond Position:  [-32.95880631]


portfolio before change:  [-26.68654983]
curr_Stock_Price:  100.52372441770721
curr_Factors:  [100.52372442]
mat_Sqrt:  [[0.15]]
grads:  [-0.03543319]
Stock Position:  -0.03543319033542155
Bond Position:  [-23.12467357]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-26.68612103]
Stock Price:  100.3484455199194
PL:  [-27.03456655]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.20812279e-03]
 [ 9.49594827e-03]
 [-3.99021791e-03]
 [-2.25304435e-02]
 [ 5.71537285e-03]
 [-9.97488812e-03]
 [ 1.45337591e-02]
 [-4.58000734e-02]
 [-2.46479448e-03]
 [ 9.44768584e-03]
 [-9.22016090e-03]
 [ 4.57156926e-03]
 [ 5.80369985e-03]
 [-1.11467577e-03]
 [ 7.92138607e-03]
 [ 1.75657545e-02]
 [ 2.92086128e-03]
 [ 1.11575499e-02]
 [-5.22527778e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.3535637]
curr_Stock_Price:  100.17042257023098
curr_Factors:  [100.17042257]
mat_Sqrt:  [[0.15]]
grads:  [-0.01472082]
Stock Position:  -0.014720818568096488
Bond Position:  [6.82815432]


portfolio before change:  [5.34407415]
curr_Stock_Price:  100.93103260020399
curr_Factors:  [100.9310326]
mat_Sqrt:  [[0.15]]
grads:  [0.06330632]
Stock Position:  0.063306321766733
Bond Position:  [-1.04549827]


portfolio before change:  [5.25159035]
curr_Stock_Price:  99.47426816989308
curr_Factors:  [99.47426817]
mat_Sqrt:  [[0.15]]
grads:  [-0.02660145]
Stock Position:  -0.02660145275510505
Bond Position:  [7.89775039]


portfolio before change:  [5.25222213]
curr_Stock_Price:  99.52475041056235
curr_Factors:  [99.52475041]
mat_Sqrt:  [[0.15]]
grads:  [-0.15020296]
Stock Position:  -0.15020295650689275
Bond Position:  [20.20113389]


portfolio before change:  [4.95902673]
curr_Stock_Price:  101.51037258718695
curr_Factors:  [101.51037259]
mat_Sqrt:  [[0.15]]
grads:  [0.03810249]
Stock Position:  0.03810248566475011
Bond Position:  [1.09122921]


portfolio before change:  [4.89453657]
curr_Stock_Price:  99.81066721587285
curr_Factors:  [99.81066722]
mat_Sqrt:  [[0.15]]
grads:  [-0.06649925]
Stock Position:  -0.06649925415735872
Bond Position:  [11.53187149]


portfolio before change:  [4.91633223]
curr_Stock_Price:  99.52626801619394
curr_Factors:  [99.52626802]
mat_Sqrt:  [[0.15]]
grads:  [0.09689173]
Stock Position:  0.09689172714050584
Bond Position:  [-4.72693977]


portfolio before change:  [4.72084443]
curr_Stock_Price:  97.52087580776656
curr_Factors:  [97.52087581]
mat_Sqrt:  [[0.15]]
grads:  [-0.30533382]
Stock Position:  -0.30533382283002997
Bond Position:  [34.49726625]


portfolio before change:  [4.41361087]
curr_Stock_Price:  98.5553467149546
curr_Factors:  [98.55534671]
mat_Sqrt:  [[0.15]]
grads:  [-0.01643196]
Stock Position:  -0.016431963174267886
Bond Position:  [6.0330687]


portfolio before change:  [4.43729522]
curr_Stock_Price:  97.20578812834684
curr_Factors:  [97.20578813]
mat_Sqrt:  [[0.15]]
grads:  [0.06298457]
Stock Position:  0.062984572248743
Bond Position:  [-1.68516976]


portfolio before change:  [4.37938395]
curr_Stock_Price:  96.29302604170518
curr_Factors:  [96.29302604]
mat_Sqrt:  [[0.15]]
grads:  [-0.06146774]
Stock Position:  -0.06146773936244374
Bond Position:  [10.29829858]


portfolio before change:  [4.31449902]
curr_Stock_Price:  97.39050952803622
curr_Factors:  [97.39050953]
mat_Sqrt:  [[0.15]]
grads:  [0.03047713]
Stock Position:  0.030477128414566047
Bond Position:  [1.34631595]


portfolio before change:  [4.31082461]
curr_Stock_Price:  97.25890187509125
curr_Factors:  [97.25890188]
mat_Sqrt:  [[0.15]]
grads:  [0.03869133]
Stock Position:  0.03869133235678237
Bond Position:  [0.54774812]


portfolio before change:  [4.31481463]
curr_Stock_Price:  97.3584864984207
curr_Factors:  [97.3584865]
mat_Sqrt:  [[0.15]]
grads:  [-0.00743117]
Stock Position:  -0.007431171817415985
Bond Position:  [5.03830227]


portfolio before change:  [4.30962895]
curr_Stock_Price:  98.22583487845203
curr_Factors:  [98.22583488]
mat_Sqrt:  [[0.15]]
grads:  [0.05280924]
Stock Position:  0.052809240438929594
Bond Position:  [-0.87760278]


portfolio before change:  [4.31472111]
curr_Stock_Price:  98.32641552074048
curr_Factors:  [98.32641552]
mat_Sqrt:  [[0.15]]
grads:  [0.11710503]
Stock Position:  0.11710503031817796
Bond Position:  [-7.19979676]


portfolio before change:  [4.61436259]
curr_Stock_Price:  100.90052913815605
curr_Factors:  [100.90052914]
mat_Sqrt:  [[0.15]]
grads:  [0.01947241]
Stock Position:  0.019472408519008746
Bond Position:  [2.64958626]


portfolio before change:  [4.63090273]
curr_Stock_Price:  101.71592181099703
curr_Factors:  [101.71592181]
mat_Sqrt:  [[0.15]]
grads:  [0.07438367]
Stock Position:  0.07438366577442142
Bond Position:  [-2.93510041]


portfolio before change:  [4.58418439]
curr_Stock_Price:  101.09771525036656
curr_Factors:  [101.09771525]
mat_Sqrt:  [[0.15]]
grads:  [-0.03483519]
Stock Position:  -0.034835185192279815
Bond Position:  [8.10594202]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.60872816]
Stock Price:  100.45132758053792
PL:  [4.15740058]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.64245027e-03]
 [-1.06798520e-02]
 [-7.04730161e-03]
 [-1.53305658e-02]
 [ 6.23018192e-03]
 [-1.02586561e-02]
 [ 1.35041217e-02]
 [-3.87613676e-02]
 [ 1.29270264e-04]
 [ 1.03325598e-02]
 [-4.68866407e-03]
 [-1.30169856e-03]
 [ 4.88926814e-03]
 [-1.01190224e-03]
 [ 8.04784137e-03]
 [ 2.04762605e-02]
 [ 6.55151782e-03]
 [ 3.08887406e-03]
 [-5.62036670e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.5794901]
curr_Stock_Price:  99.76511294259612
curr_Factors:  [99.76511294]
mat_Sqrt:  [[0.15]]
grads:  [0.01761634]
Stock Position:  0.01761633510476649
Bond Position:  [-5.33698576]


portfolio before change:  [-3.57937301]
curr_Stock_Price:  99.84750818385317
curr_Factors:  [99.84750818]
mat_Sqrt:  [[0.15]]
grads:  [-0.07119901]
Stock Position:  -0.07119901345987983
Bond Position:  [3.52967107]


portfolio before change:  [-3.48660349]
curr_Stock_Price:  98.55694275877438
curr_Factors:  [98.55694276]
mat_Sqrt:  [[0.15]]
grads:  [-0.04698201]
Stock Position:  -0.04698201076182699
Bond Position:  [1.14379985]


portfolio before change:  [-3.49780516]
curr_Stock_Price:  98.80145452771268
curr_Factors:  [98.80145453]
mat_Sqrt:  [[0.15]]
grads:  [-0.10220377]
Stock Position:  -0.10220377182746669
Bond Position:  [6.60007615]


portfolio before change:  [-3.58537885]
curr_Stock_Price:  99.67445469938768
curr_Factors:  [99.6744547]
mat_Sqrt:  [[0.15]]
grads:  [0.04153455]
Stock Position:  0.04153454611591933
Bond Position:  [-7.72531208]


portfolio before change:  [-3.59730776]
curr_Stock_Price:  99.43375510516695
curr_Factors:  [99.43375511]
mat_Sqrt:  [[0.15]]
grads:  [-0.06839104]
Stock Position:  -0.06839104093115639
Bond Position:  [3.20307025]


portfolio before change:  [-3.5173283]
curr_Stock_Price:  98.27602156723499
curr_Factors:  [98.27602157]
mat_Sqrt:  [[0.15]]
grads:  [0.09002748]
Stock Position:  0.09002747816162412
Bond Position:  [-12.36487068]


portfolio before change:  [-3.54211534]
curr_Stock_Price:  98.03503470358073
curr_Factors:  [98.0350347]
mat_Sqrt:  [[0.15]]
grads:  [-0.25840912]
Stock Position:  -0.2584091171662723
Bond Position:  [21.79103143]


portfolio before change:  [-3.39727152]
curr_Stock_Price:  97.49559794443736
curr_Factors:  [97.49559794]
mat_Sqrt:  [[0.15]]
grads:  [0.0008618]
Stock Position:  0.0008618017628524155
Bond Position:  [-3.4812934]


portfolio before change:  [-3.39760275]
curr_Stock_Price:  98.12126941395637
curr_Factors:  [98.12126941]
mat_Sqrt:  [[0.15]]
grads:  [0.06888373]
Stock Position:  0.06888373183216802
Bond Position:  [-10.15656196]


portfolio before change:  [-3.39062849]
curr_Stock_Price:  98.25938218855589
curr_Factors:  [98.25938219]
mat_Sqrt:  [[0.15]]
grads:  [-0.03125776]
Stock Position:  -0.031257760460285076
Bond Position:  [-0.31926025]


portfolio before change:  [-3.40709188]
curr_Stock_Price:  98.78352634852956
curr_Factors:  [98.78352635]
mat_Sqrt:  [[0.15]]
grads:  [-0.00867799]
Stock Position:  -0.008677990394803914
Bond Position:  [-2.54984939]


portfolio before change:  [-3.40854066]
curr_Stock_Price:  98.87700836884704
curr_Factors:  [98.87700837]
mat_Sqrt:  [[0.15]]
grads:  [0.03259512]
Stock Position:  0.032595120908993525
Bond Position:  [-6.6314487]


portfolio before change:  [-3.44013168]
curr_Stock_Price:  97.95868223571624
curr_Factors:  [97.95868224]
mat_Sqrt:  [[0.15]]
grads:  [-0.00674601]
Stock Position:  -0.006746014928411307
Bond Position:  [-2.77930095]


portfolio before change:  [-3.4395841]
curr_Stock_Price:  97.77449972313237
curr_Factors:  [97.77449972]
mat_Sqrt:  [[0.15]]
grads:  [0.05365228]
Stock Position:  0.053652275795132945
Bond Position:  [-8.68540852]


portfolio before change:  [-3.51218059]
curr_Stock_Price:  96.46188310651206
curr_Factors:  [96.46188311]
mat_Sqrt:  [[0.15]]
grads:  [0.1365084]
Stock Position:  0.13650840317074142
Bond Position:  [-16.68003822]


portfolio before change:  [-3.35620009]
curr_Stock_Price:  97.63507852240687
curr_Factors:  [97.63507852]
mat_Sqrt:  [[0.15]]
grads:  [0.04367679]
Stock Position:  0.04367678549493561
Bond Position:  [-7.62058647]


portfolio before change:  [-3.35457846]
curr_Stock_Price:  97.71583117427086
curr_Factors:  [97.71583117]
mat_Sqrt:  [[0.15]]
grads:  [0.02059249]
Stock Position:  0.020592493751245573
Bond Position:  [-5.3667911]


portfolio before change:  [-3.36802426]
curr_Stock_Price:  97.12804706924273
curr_Factors:  [97.12804707]
mat_Sqrt:  [[0.15]]
grads:  [-0.03746911]
Stock Position:  -0.037469111328596254
Bond Position:  [0.27127735]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.39327881]
Stock Price:  97.80386719554286
PL:  [-3.39327881]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.69073728e-03]
 [-5.18081633e-03]
 [-4.15122111e-03]
 [ 7.96049635e-03]
 [ 6.52045136e-03]
 [-9.84384042e-03]
 [ 6.77629415e-03]
 [-2.14797192e-02]
 [-7.09715317e-03]
 [ 8.12797515e-03]
 [-3.07252603e-03]
 [-6.39357210e-03]
 [ 5.23215762e-03]
 [-1.83868770e-04]
 [ 1.30456852e-03]
 [ 2.24861403e-02]
 [ 4.76414163e-03]
 [ 5.35263987e-03]
 [-4.12575490e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.70833766]
curr_Stock_Price:  99.35091977994139
curr_Factors:  [99.35091978]
mat_Sqrt:  [[0.15]]
grads:  [0.01793825]
Stock Position:  0.0179382485502895
Bond Position:  [-14.49051915]


portfolio before change:  [-12.71762003]
curr_Stock_Price:  99.0354323957088
curr_Factors:  [99.0354324]
mat_Sqrt:  [[0.15]]
grads:  [-0.03453878]
Stock Position:  -0.03453877551050413
Bond Position:  [-9.29705746]


portfolio before change:  [-12.73233921]
curr_Stock_Price:  99.39429355546194
curr_Factors:  [99.39429356]
mat_Sqrt:  [[0.15]]
grads:  [-0.02767481]
Stock Position:  -0.027674807373287008
Bond Position:  [-9.98162128]


portfolio before change:  [-12.7788868]
curr_Stock_Price:  100.98606140569187
curr_Factors:  [100.98606141]
mat_Sqrt:  [[0.15]]
grads:  [0.05306998]
Stock Position:  0.05306997569343302
Bond Position:  [-18.13821462]


portfolio before change:  [-12.83179387]
curr_Stock_Price:  100.07458640078359
curr_Factors:  [100.0745864]
mat_Sqrt:  [[0.15]]
grads:  [0.04346968]
Stock Position:  0.043469675708974385
Bond Position:  [-17.18200369]


portfolio before change:  [-12.82845012]
curr_Stock_Price:  100.25033618558517
curr_Factors:  [100.25033619]
mat_Sqrt:  [[0.15]]
grads:  [-0.0656256]
Stock Position:  -0.06562560280754977
Bond Position:  [-6.24946138]


portfolio before change:  [-12.88276886]
curr_Stock_Price:  101.05423235641949
curr_Factors:  [101.05423236]
mat_Sqrt:  [[0.15]]
grads:  [0.04517529]
Stock Position:  0.04517529434471581
Bond Position:  [-17.44792355]


portfolio before change:  [-12.97151801]
curr_Stock_Price:  99.18625052154451
curr_Factors:  [99.18625052]
mat_Sqrt:  [[0.15]]
grads:  [-0.14319813]
Stock Position:  -0.14319812819474284
Bond Position:  [1.23176741]


portfolio before change:  [-13.10320564]
curr_Stock_Price:  100.10801959504994
curr_Factors:  [100.1080196]
mat_Sqrt:  [[0.15]]
grads:  [-0.04731435]
Stock Position:  -0.04731435447191337
Bond Position:  [-8.36665931]


portfolio before change:  [-13.07526335]
curr_Stock_Price:  99.47323936137926
curr_Factors:  [99.47323936]
mat_Sqrt:  [[0.15]]
grads:  [0.0541865]
Stock Position:  0.05418650099975455
Bond Position:  [-18.46537013]


portfolio before change:  [-13.06802992]
curr_Stock_Price:  99.69193497269832
curr_Factors:  [99.69193497]
mat_Sqrt:  [[0.15]]
grads:  [-0.02048351]
Stock Position:  -0.020483506850243822
Bond Position:  [-11.02598948]


portfolio before change:  [-13.10146494]
curr_Stock_Price:  101.18963662231474
curr_Factors:  [101.18963662]
mat_Sqrt:  [[0.15]]
grads:  [-0.04262381]
Stock Position:  -0.04262381399485249
Bond Position:  [-8.78837669]


portfolio before change:  [-13.08718971]
curr_Stock_Price:  100.80317205767035
curr_Factors:  [100.80317206]
mat_Sqrt:  [[0.15]]
grads:  [0.03488105]
Stock Position:  0.03488105082220963
Bond Position:  [-16.60331028]


portfolio before change:  [-13.09537788]
curr_Stock_Price:  100.68744113429634
curr_Factors:  [100.68744113]
mat_Sqrt:  [[0.15]]
grads:  [-0.00122579]
Stock Position:  -0.0012257917977516104
Bond Position:  [-12.97195604]


portfolio before change:  [-13.0989879]
curr_Stock_Price:  100.98653282461261
curr_Factors:  [100.98653282]
mat_Sqrt:  [[0.15]]
grads:  [0.00869712]
Stock Position:  0.008697123497878566
Bond Position:  [-13.97728024]


portfolio before change:  [-13.09499649]
curr_Stock_Price:  101.84729637825237
curr_Factors:  [101.84729638]
mat_Sqrt:  [[0.15]]
grads:  [0.1499076]
Stock Position:  0.14990760173181902
Bond Position:  [-28.36268043]


portfolio before change:  [-13.43562472]
curr_Stock_Price:  99.62234799140924
curr_Factors:  [99.62234799]
mat_Sqrt:  [[0.15]]
grads:  [0.03176094]
Stock Position:  0.031760944231163164
Bond Position:  [-16.59972456]


portfolio before change:  [-13.47205487]
curr_Stock_Price:  98.60601479450914
curr_Factors:  [98.60601479]
mat_Sqrt:  [[0.15]]
grads:  [0.03568427]
Stock Position:  0.03568426580635219
Bond Position:  [-16.99073811]


portfolio before change:  [-13.48049609]
curr_Stock_Price:  98.48851179200793
curr_Factors:  [98.48851179]
mat_Sqrt:  [[0.15]]
grads:  [-0.02750503]
Stock Position:  -0.027505032692563165
Bond Position:  [-10.77156636]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.45947247]
Stock Price:  97.62623856202244
PL:  [-13.45947247]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.26318005e-03]
 [-7.79582203e-03]
 [-9.33502285e-03]
 [-7.17054678e-03]
 [ 1.09444427e-04]
 [-1.03358149e-02]
 [ 1.33263737e-02]
 [-2.72012845e-02]
 [-2.09192650e-03]
 [ 8.52286066e-03]
 [-3.04261959e-03]
 [-6.33628413e-03]
 [ 7.33165376e-03]
 [ 2.22355948e-04]
 [ 9.71331647e-04]
 [ 2.28130079e-02]
 [ 6.72721403e-03]
 [ 1.35504700e-02]
 [-1.61291677e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.94704786]
curr_Stock_Price:  100.10660627342224
curr_Factors:  [100.10660627]
mat_Sqrt:  [[0.15]]
grads:  [-0.0084212]
Stock Position:  -0.008421200326856327
Bond Position:  [4.79006565]


portfolio before change:  [3.95420028]
curr_Stock_Price:  99.3994913974218
curr_Factors:  [99.3994914]
mat_Sqrt:  [[0.15]]
grads:  [-0.05197215]
Stock Position:  -0.05197214689143792
Bond Position:  [9.12020525]


portfolio before change:  [4.0255035]
curr_Stock_Price:  98.07141697749223
curr_Factors:  [98.07141698]
mat_Sqrt:  [[0.15]]
grads:  [-0.06223349]
Stock Position:  -0.062233485696526994
Bond Position:  [10.12882962]


portfolio before change:  [4.03865877]
curr_Stock_Price:  97.90072522814033
curr_Factors:  [97.90072523]
mat_Sqrt:  [[0.15]]
grads:  [-0.04780365]
Stock Position:  -0.04780364517409059
Bond Position:  [8.7186703]


portfolio before change:  [4.029266]
curr_Stock_Price:  98.14281352284888
curr_Factors:  [98.14281352]
mat_Sqrt:  [[0.15]]
grads:  [0.00072963]
Stock Position:  0.0007296295163971313
Bond Position:  [3.95765811]


portfolio before change:  [4.03112267]
curr_Stock_Price:  99.33126968661713
curr_Factors:  [99.33126969]
mat_Sqrt:  [[0.15]]
grads:  [-0.06890543]
Stock Position:  -0.0689054328910129
Bond Position:  [10.87558681]


portfolio before change:  [4.12257979]
curr_Stock_Price:  98.04344841962514
curr_Factors:  [98.04344842]
mat_Sqrt:  [[0.15]]
grads:  [0.08884249]
Stock Position:  0.08884249124052278
Bond Position:  [-4.58784442]


portfolio before change:  [4.18945996]
curr_Stock_Price:  98.80915495603269
curr_Factors:  [98.80915496]
mat_Sqrt:  [[0.15]]
grads:  [-0.1813419]
Stock Position:  -0.18134189642538528
Bond Position:  [22.10769951]


portfolio before change:  [4.26957947]
curr_Stock_Price:  98.39782203306545
curr_Factors:  [98.39782203]
mat_Sqrt:  [[0.15]]
grads:  [-0.01394618]
Stock Position:  -0.013946176679199528
Bond Position:  [5.64185288]


portfolio before change:  [4.25715931]
curr_Stock_Price:  99.38954918432442
curr_Factors:  [99.38954918]
mat_Sqrt:  [[0.15]]
grads:  [0.05681907]
Stock Position:  0.0568190710939573
Bond Position:  [-1.39006255]


portfolio before change:  [4.38495306]
curr_Stock_Price:  101.64480095573555
curr_Factors:  [101.64480096]
mat_Sqrt:  [[0.15]]
grads:  [-0.02028413]
Stock Position:  -0.020284130586840438
Bond Position:  [6.44672948]


portfolio before change:  [4.39645153]
curr_Stock_Price:  101.15739622712448
curr_Factors:  [101.15739623]
mat_Sqrt:  [[0.15]]
grads:  [-0.04224189]
Stock Position:  -0.042241894167718314
Bond Position:  [8.66953155]


portfolio before change:  [4.35670364]
curr_Stock_Price:  102.14967045974342
curr_Factors:  [102.14967046]
mat_Sqrt:  [[0.15]]
grads:  [0.04887769]
Stock Position:  0.04887769174373184
Bond Position:  [-0.63613647]


portfolio before change:  [4.32889984]
curr_Stock_Price:  101.58408037320397
curr_Factors:  [101.58408037]
mat_Sqrt:  [[0.15]]
grads:  [0.00148237]
Stock Position:  0.0014823729876491016
Bond Position:  [4.17831435]


portfolio before change:  [4.33220252]
curr_Stock_Price:  103.10728825243704
curr_Factors:  [103.10728825]
mat_Sqrt:  [[0.15]]
grads:  [0.00647554]
Stock Position:  0.006475544315593206
Bond Position:  [3.6645267]


portfolio before change:  [4.33520554]
curr_Stock_Price:  103.42954402191447
curr_Factors:  [103.42954402]
mat_Sqrt:  [[0.15]]
grads:  [0.15208672]
Stock Position:  0.15208671918089958
Bond Position:  [-11.39505447]


portfolio before change:  [4.64060313]
curr_Stock_Price:  105.45632657942316
curr_Factors:  [105.45632658]
mat_Sqrt:  [[0.15]]
grads:  [0.04484809]
Stock Position:  0.04484809351349728
Bond Position:  [-0.08891206]


portfolio before change:  [4.60302534]
curr_Stock_Price:  104.61893170476736
curr_Factors:  [104.6189317]
mat_Sqrt:  [[0.15]]
grads:  [0.09033647]
Stock Position:  0.09033646665714586
Bond Position:  [-4.8478793]


portfolio before change:  [4.80214903]
curr_Stock_Price:  106.8365944352863
curr_Factors:  [106.83659444]
mat_Sqrt:  [[0.15]]
grads:  [-0.10752778]
Stock Position:  -0.1075277843473342
Bond Position:  [16.29005132]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.71180214]
Stock Price:  107.71469226287515
PL:  [-3.00289012]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.77824649e-03]
 [-9.61693820e-03]
 [-3.86305548e-02]
 [ 9.55922161e-03]
 [ 5.71321272e-03]
 [-1.05730559e-02]
 [ 1.28701200e-02]
 [-4.48852940e-02]
 [ 2.48322086e-03]
 [ 5.23956761e-03]
 [-1.03311836e-02]
 [ 8.05139772e-03]
 [ 6.45652402e-03]
 [-1.31704429e-03]
 [ 8.25421313e-03]
 [ 2.01716455e-02]
 [ 7.00353504e-03]
 [ 5.20989557e-04]
 [-8.32108394e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.99061485]
curr_Stock_Price:  99.56497182917822
curr_Factors:  [99.56497183]
mat_Sqrt:  [[0.15]]
grads:  [0.01852164]
Stock Position:  0.018521643282547184
Bond Position:  [-9.83472175]


portfolio before change:  [-7.9805547]
curr_Stock_Price:  100.24089130575848
curr_Factors:  [100.24089131]
mat_Sqrt:  [[0.15]]
grads:  [-0.06411292]
Stock Position:  -0.06411292130141338
Bond Position:  [-1.55381833]


portfolio before change:  [-8.12184195]
curr_Stock_Price:  102.43855660159848
curr_Factors:  [102.4385566]
mat_Sqrt:  [[0.15]]
grads:  [-0.25753703]
Stock Position:  -0.257537031905725
Bond Position:  [18.25987987]


portfolio before change:  [-7.75600904]
curr_Stock_Price:  101.03577825579687
curr_Factors:  [101.03577826]
mat_Sqrt:  [[0.15]]
grads:  [0.06372814]
Stock Position:  0.06372814409358349
Bond Position:  [-14.19483167]


portfolio before change:  [-7.69988275]
curr_Stock_Price:  101.97218451590143
curr_Factors:  [101.97218452]
mat_Sqrt:  [[0.15]]
grads:  [0.03808808]
Stock Position:  0.03808808477579611
Bond Position:  [-11.58380796]


portfolio before change:  [-7.81876021]
curr_Stock_Price:  98.9271076528049
curr_Factors:  [98.92710765]
mat_Sqrt:  [[0.15]]
grads:  [-0.07048704]
Stock Position:  -0.07048703955418242
Bond Position:  [-0.84568126]


portfolio before change:  [-7.72057784]
curr_Stock_Price:  97.53119404758395
curr_Factors:  [97.53119405]
mat_Sqrt:  [[0.15]]
grads:  [0.0858008]
Stock Position:  0.08580079981055401
Bond Position:  [-16.0888323]


portfolio before change:  [-7.71313349]
curr_Stock_Price:  97.66484158932785
curr_Factors:  [97.66484159]
mat_Sqrt:  [[0.15]]
grads:  [-0.29923529]
Stock Position:  -0.299235293138863
Bond Position:  [21.51163401]


portfolio before change:  [-7.28045733]
curr_Stock_Price:  96.23687640140506
curr_Factors:  [96.2368764]
mat_Sqrt:  [[0.15]]
grads:  [0.01655481]
Stock Position:  0.016554805706914182
Bond Position:  [-8.87364012]


portfolio before change:  [-7.31068029]
curr_Stock_Price:  94.5452660178686
curr_Factors:  [94.54526602]
mat_Sqrt:  [[0.15]]
grads:  [0.03493045]
Stock Position:  0.03493045071168887
Bond Position:  [-10.61318905]


portfolio before change:  [-7.2673316]
curr_Stock_Price:  95.86223515939402
curr_Factors:  [95.86223516]
mat_Sqrt:  [[0.15]]
grads:  [-0.06887456]
Stock Position:  -0.06887455750453274
Bond Position:  [-0.66486257]


portfolio before change:  [-7.32550005]
curr_Stock_Price:  96.70437801615837
curr_Factors:  [96.70437802]
mat_Sqrt:  [[0.15]]
grads:  [0.05367598]
Stock Position:  0.05367598480713905
Bond Position:  [-12.51620278]


portfolio before change:  [-7.38039991]
curr_Stock_Price:  95.7398793302146
curr_Factors:  [95.73987933]
mat_Sqrt:  [[0.15]]
grads:  [0.04304349]
Stock Position:  0.04304349345500609
Bond Position:  [-11.50137878]


portfolio before change:  [-7.35456745]
curr_Stock_Price:  96.40683640216868
curr_Factors:  [96.4068364]
mat_Sqrt:  [[0.15]]
grads:  [-0.0087803]
Stock Position:  -0.008780295237253195
Bond Position:  [-6.50808697]


portfolio before change:  [-7.35961005]
curr_Stock_Price:  96.79581789157383
curr_Factors:  [96.79581789]
mat_Sqrt:  [[0.15]]
grads:  [0.05502809]
Stock Position:  0.05502808756505351
Bond Position:  [-12.68609879]


portfolio before change:  [-7.37023157]
curr_Stock_Price:  96.66043976398674
curr_Factors:  [96.66043976]
mat_Sqrt:  [[0.15]]
grads:  [0.13447764]
Stock Position:  0.1344776367277261
Bond Position:  [-20.36889907]


portfolio before change:  [-7.32833246]
curr_Stock_Price:  97.00988053895401
curr_Factors:  [97.00988054]
mat_Sqrt:  [[0.15]]
grads:  [0.04669023]
Stock Position:  0.04669023360558931
Bond Position:  [-11.85774645]


portfolio before change:  [-7.39588731]
curr_Stock_Price:  95.62650675403806
curr_Factors:  [95.62650675]
mat_Sqrt:  [[0.15]]
grads:  [0.00347326]
Stock Position:  0.003473263711536295
Bond Position:  [-7.72802339]


portfolio before change:  [-7.39721742]
curr_Stock_Price:  95.7998701334542
curr_Factors:  [95.79987013]
mat_Sqrt:  [[0.15]]
grads:  [-0.05547389]
Stock Position:  -0.055473892951852094
Bond Position:  [-2.08282568]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.3348811]
Stock Price:  94.66677676071185
PL:  [-7.3348811]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.24995845e-02]
 [ 3.98480292e-02]
 [-1.42463982e-02]
 [ 1.06470821e-02]
 [ 4.68674953e-03]
 [-9.90594213e-03]
 [ 1.10205518e-02]
 [ 9.44270138e-03]
 [-1.97220629e-02]
 [ 2.35275923e-03]
 [-3.14176940e-03]
 [-3.08240281e-03]
 [ 7.57837309e-03]
 [ 1.42812099e-04]
 [ 1.65896539e-03]
 [ 2.16061062e-02]
 [ 1.71817164e-03]
 [ 1.05743651e-02]
 [-5.74888379e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [46.46014862]
curr_Stock_Price:  102.03550644859503
curr_Factors:  [102.03550645]
mat_Sqrt:  [[0.15]]
grads:  [-0.14999723]
Stock Position:  -0.1499972296956333
Bond Position:  [61.76519192]


portfolio before change:  [46.43459694]
curr_Stock_Price:  102.30881090512484
curr_Factors:  [102.30881091]
mat_Sqrt:  [[0.15]]
grads:  [0.26565353]
Stock Position:  0.26565352776689183
Bond Position:  [19.2559004]


portfolio before change:  [46.09425176]
curr_Stock_Price:  101.00952547442976
curr_Factors:  [101.00952547]
mat_Sqrt:  [[0.15]]
grads:  [-0.09497599]
Stock Position:  -0.09497598785272862
Bond Position:  [55.68773122]


portfolio before change:  [46.102469]
curr_Stock_Price:  101.06960833312812
curr_Factors:  [101.06960833]
mat_Sqrt:  [[0.15]]
grads:  [0.07098055]
Stock Position:  0.07098054766350108
Bond Position:  [38.92849285]


portfolio before change:  [45.97365856]
curr_Stock_Price:  99.11775264508016
curr_Factors:  [99.11775265]
mat_Sqrt:  [[0.15]]
grads:  [0.031245]
Stock Position:  0.03124499688935028
Bond Position:  [42.87672468]


portfolio before change:  [46.01057746]
curr_Stock_Price:  99.95623510255722
curr_Factors:  [99.9562351]
mat_Sqrt:  [[0.15]]
grads:  [-0.06603961]
Stock Position:  -0.06603961417987722
Bond Position:  [52.61164866]


portfolio before change:  [45.98776583]
curr_Stock_Price:  100.50085048176192
curr_Factors:  [100.50085048]
mat_Sqrt:  [[0.15]]
grads:  [0.07347035]
Stock Position:  0.07347034530514551
Bond Position:  [38.60393364]


portfolio before change:  [46.10374584]
curr_Stock_Price:  101.94807138765638
curr_Factors:  [101.94807139]
mat_Sqrt:  [[0.15]]
grads:  [0.06295134]
Stock Position:  0.06295134252637521
Bond Position:  [39.68597787]


portfolio before change:  [46.08749104]
curr_Stock_Price:  101.53223391874393
curr_Factors:  [101.53223392]
mat_Sqrt:  [[0.15]]
grads:  [-0.13148042]
Stock Position:  -0.13148041930051793
Bond Position:  [59.43699173]


portfolio before change:  [46.13805116]
curr_Stock_Price:  101.26071812379236
curr_Factors:  [101.26071812]
mat_Sqrt:  [[0.15]]
grads:  [0.01568506]
Stock Position:  0.015685061554236587
Bond Position:  [44.54977056]


portfolio before change:  [46.172261]
curr_Stock_Price:  102.73160867950752
curr_Factors:  [102.73160868]
mat_Sqrt:  [[0.15]]
grads:  [-0.02094513]
Stock Position:  -0.020945129324041876
Bond Position:  [48.32398783]


portfolio before change:  [46.17877883]
curr_Stock_Price:  102.99728748729586
curr_Factors:  [102.99728749]
mat_Sqrt:  [[0.15]]
grads:  [-0.02054935]
Stock Position:  -0.020549352061780952
Bond Position:  [48.29530636]


portfolio before change:  [46.20486128]
curr_Stock_Price:  102.31565465635744
curr_Factors:  [102.31565466]
mat_Sqrt:  [[0.15]]
grads:  [0.05052249]
Stock Position:  0.05052248727184325
Bond Position:  [41.03561992]


portfolio before change:  [46.16924355]
curr_Stock_Price:  101.40758534939215
curr_Factors:  [101.40758535]
mat_Sqrt:  [[0.15]]
grads:  [0.00095208]
Stock Position:  0.000952080662581857
Bond Position:  [46.07269535]


portfolio before change:  [46.18025656]
curr_Stock_Price:  100.87547857683083
curr_Factors:  [100.87547858]
mat_Sqrt:  [[0.15]]
grads:  [0.01105977]
Stock Position:  0.01105976924535798
Bond Position:  [45.06459704]


portfolio before change:  [46.19373641]
curr_Stock_Price:  101.0755091029657
curr_Factors:  [101.0755091]
mat_Sqrt:  [[0.15]]
grads:  [0.14404071]
Stock Position:  0.14404070772927177
Bond Position:  [31.63474854]


portfolio before change:  [46.4864915]
curr_Stock_Price:  103.05304327354312
curr_Factors:  [103.05304327]
mat_Sqrt:  [[0.15]]
grads:  [0.01145448]
Stock Position:  0.011454477569178664
Bond Position:  [45.30607273]


portfolio before change:  [46.47781462]
curr_Stock_Price:  101.3065803371351
curr_Factors:  [101.30658034]
mat_Sqrt:  [[0.15]]
grads:  [0.07049577]
Stock Position:  0.07049576764427591
Bond Position:  [39.33612947]


portfolio before change:  [46.49873681]
curr_Stock_Price:  101.46385127024344
curr_Factors:  [101.46385127]
mat_Sqrt:  [[0.15]]
grads:  [-0.03832589]
Stock Position:  -0.03832589196506954
Bond Position:  [50.38742942]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [46.51482898]
Stock Price:  101.37269260037102
PL:  [45.14213638]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.96022131e-02]
 [ 6.98610128e-02]
 [-7.97871015e-02]
 [ 1.18308405e-01]
 [-1.72024301e-03]
 [-2.90077481e-02]
 [-2.78576725e-02]
 [-6.95779650e-03]
 [ 7.30573377e-02]
 [-1.13856448e-02]
 [-9.29927957e-03]
 [ 5.29677869e-02]
 [ 2.28772717e-02]
 [-9.34878768e-03]
 [ 3.45813637e-02]
 [ 1.61757730e-02]
 [ 1.50550604e-02]
 [ 1.74896338e-02]
 [-2.32416558e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [34.27924238]
curr_Stock_Price:  101.482835583375
curr_Factors:  [101.48283558]
mat_Sqrt:  [[0.15]]
grads:  [-0.13068142]
Stock Position:  -0.1306814204536852
Bond Position:  [47.54116349]


portfolio before change:  [34.02962791]
curr_Stock_Price:  103.48389467639802
curr_Factors:  [103.48389468]
mat_Sqrt:  [[0.15]]
grads:  [0.46574009]
Stock Position:  0.46574008509515286
Bond Position:  [-14.16697]


portfolio before change:  [34.80970228]
curr_Stock_Price:  105.16641368889562
curr_Factors:  [105.16641369]
mat_Sqrt:  [[0.15]]
grads:  [-0.53191401]
Stock Position:  -0.5319140099504311
Bond Position:  [90.74919109]


portfolio before change:  [33.97063531]
curr_Stock_Price:  106.78651973181202
curr_Factors:  [106.78651973]
mat_Sqrt:  [[0.15]]
grads:  [0.7887227]
Stock Position:  0.7887227028453137
Bond Position:  [-50.25431716]


portfolio before change:  [34.97693943]
curr_Stock_Price:  108.0783162843127
curr_Factors:  [108.07831628]
mat_Sqrt:  [[0.15]]
grads:  [-0.01146829]
Stock Position:  -0.011468286748286649
Bond Position:  [36.21641255]


portfolio before change:  [34.96822122]
curr_Stock_Price:  109.62810714431764
curr_Factors:  [109.62810714]
mat_Sqrt:  [[0.15]]
grads:  [-0.19338499]
Stock Position:  -0.19338498752959218
Bond Position:  [56.16865135]


portfolio before change:  [34.90090435]
curr_Stock_Price:  110.04882640123635
curr_Factors:  [110.0488264]
mat_Sqrt:  [[0.15]]
grads:  [-0.18571782]
Stock Position:  -0.1857178168215734
Bond Position:  [55.33893213]


portfolio before change:  [34.79397614]
curr_Stock_Price:  110.6990853231783
curr_Factors:  [110.69908532]
mat_Sqrt:  [[0.15]]
grads:  [-0.04638531]
Stock Position:  -0.046385309969096795
Bond Position:  [39.92878753]


portfolio before change:  [34.82185878]
curr_Stock_Price:  110.3132047024008
curr_Factors:  [110.3132047]
mat_Sqrt:  [[0.15]]
grads:  [0.48704892]
Stock Position:  0.48704891790254995
Bond Position:  [-18.9060682]


portfolio before change:  [35.80240971]
curr_Stock_Price:  112.336159686473
curr_Factors:  [112.33615969]
mat_Sqrt:  [[0.15]]
grads:  [-0.0759043]
Stock Position:  -0.07590429867064204
Bond Position:  [44.32920712]


portfolio before change:  [35.83344073]
curr_Stock_Price:  112.0733637769139
curr_Factors:  [112.07336378]
mat_Sqrt:  [[0.15]]
grads:  [-0.0619952]
Stock Position:  -0.06199519711587832
Bond Position:  [42.78145101]


portfolio before change:  [35.8510795]
curr_Stock_Price:  111.96138634609804
curr_Factors:  [111.96138635]
mat_Sqrt:  [[0.15]]
grads:  [0.35311858]
Stock Position:  0.3531185792388406
Bond Position:  [-3.68456618]


portfolio before change:  [36.15535904]
curr_Stock_Price:  112.82568750891504
curr_Factors:  [112.82568751]
mat_Sqrt:  [[0.15]]
grads:  [0.15251514]
Stock Position:  0.15251514468806732
Bond Position:  [18.94773298]


portfolio before change:  [35.84336644]
curr_Stock_Price:  110.74897489424238
curr_Factors:  [110.74897489]
mat_Sqrt:  [[0.15]]
grads:  [-0.06232525]
Stock Position:  -0.06232525121599066
Bond Position:  [42.74582412]


portfolio before change:  [35.86225001]
curr_Stock_Price:  110.61747469601309
curr_Factors:  [110.6174747]
mat_Sqrt:  [[0.15]]
grads:  [0.23054242]
Stock Position:  0.23054242475924247
Bond Position:  [10.36022918]


portfolio before change:  [36.12956153]
curr_Stock_Price:  111.76572816125672
curr_Factors:  [111.76572816]
mat_Sqrt:  [[0.15]]
grads:  [0.10783849]
Stock Position:  0.1078384867770598
Bond Position:  [24.07691453]


portfolio before change:  [36.07620077]
curr_Stock_Price:  111.21508298517132
curr_Factors:  [111.21508299]
mat_Sqrt:  [[0.15]]
grads:  [0.10036707]
Stock Position:  0.10036706911560288
Bond Position:  [24.91386885]


portfolio before change:  [36.22817575]
curr_Stock_Price:  112.66721004946609
curr_Factors:  [112.66721005]
mat_Sqrt:  [[0.15]]
grads:  [0.11659756]
Stock Position:  0.11659755856318564
Bond Position:  [23.09145413]


portfolio before change:  [36.19072225]
curr_Stock_Price:  112.29647248919221
curr_Factors:  [112.29647249]
mat_Sqrt:  [[0.15]]
grads:  [-0.15494437]
Stock Position:  -0.15494437179517395
Bond Position:  [53.59042863]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [36.53204352]
Stock Price:  110.18008719773711
PL:  [26.35195632]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 6.37704693e-04]
 [-6.45678155e-03]
 [-9.68536735e-03]
 [-5.72365140e-03]
 [-5.65832056e-03]
 [-1.13595043e-02]
 [ 1.26872274e-02]
 [-4.13654452e-02]
 [ 4.68142484e-03]
 [ 6.17854843e-03]
 [-1.20568936e-02]
 [ 2.10619285e-02]
 [ 7.24628709e-03]
 [-1.79774870e-03]
 [ 6.67780437e-03]
 [ 2.22009507e-02]
 [ 1.15663254e-02]
 [ 4.69710834e-04]
 [-9.68161728e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-23.860883]
curr_Stock_Price:  98.84490760309656
curr_Factors:  [98.8449076]
mat_Sqrt:  [[0.15]]
grads:  [0.00425136]
Stock Position:  0.00425136461930756
Bond Position:  [-24.28110874]


portfolio before change:  [-23.86532475]
curr_Stock_Price:  99.22814419548722
curr_Factors:  [99.2281442]
mat_Sqrt:  [[0.15]]
grads:  [-0.04304521]
Stock Position:  -0.043045210357535585
Bond Position:  [-19.59402841]


portfolio before change:  [-23.81598737]
curr_Stock_Price:  97.9681549952099
curr_Factors:  [97.968155]
mat_Sqrt:  [[0.15]]
grads:  [-0.06456912]
Stock Position:  -0.06456911566034204
Bond Position:  [-17.49027024]


portfolio before change:  [-23.81064337]
curr_Stock_Price:  97.81766330334412
curr_Factors:  [97.8176633]
mat_Sqrt:  [[0.15]]
grads:  [-0.03815768]
Stock Position:  -0.038157675976795424
Bond Position:  [-20.07814867]


portfolio before change:  [-23.77039931]
curr_Stock_Price:  96.63142155822835
curr_Factors:  [96.63142156]
mat_Sqrt:  [[0.15]]
grads:  [-0.03772214]
Stock Position:  -0.037722137079521434
Bond Position:  [-20.12525558]


portfolio before change:  [-23.76636721]
curr_Stock_Price:  96.39113709932987
curr_Factors:  [96.3911371]
mat_Sqrt:  [[0.15]]
grads:  [-0.07573003]
Stock Position:  -0.07573002898707992
Bond Position:  [-16.4666636]


portfolio before change:  [-23.84127047]
curr_Stock_Price:  97.32585323823483
curr_Factors:  [97.32585324]
mat_Sqrt:  [[0.15]]
grads:  [0.08458152]
Stock Position:  0.08458151616143401
Bond Position:  [-32.0732387]


portfolio before change:  [-23.91026133]
curr_Stock_Price:  96.60499180554207
curr_Factors:  [96.60499181]
mat_Sqrt:  [[0.15]]
grads:  [-0.27576963]
Stock Position:  -0.2757696344832763
Bond Position:  [2.73046195]


portfolio before change:  [-23.46351295]
curr_Stock_Price:  94.98746171633219
curr_Factors:  [94.98746172]
mat_Sqrt:  [[0.15]]
grads:  [0.0312095]
Stock Position:  0.031209498963948354
Bond Position:  [-26.42802404]


portfolio before change:  [-23.46539375]
curr_Stock_Price:  95.1389231140394
curr_Factors:  [95.13892311]
mat_Sqrt:  [[0.15]]
grads:  [0.04119032]
Stock Position:  0.041190322885544035
Bond Position:  [-27.38419671]


portfolio before change:  [-23.47000893]
curr_Stock_Price:  95.19310382212805
curr_Factors:  [95.19310382]
mat_Sqrt:  [[0.15]]
grads:  [-0.08037929]
Stock Position:  -0.08037929061706416
Bond Position:  [-15.81845478]


portfolio before change:  [-23.39174545]
curr_Stock_Price:  94.170221047317
curr_Factors:  [94.17022105]
mat_Sqrt:  [[0.15]]
grads:  [0.14041286]
Stock Position:  0.140412856980354
Bond Position:  [-36.61445523]


portfolio before change:  [-23.39867425]
curr_Stock_Price:  94.18607398954629
curr_Factors:  [94.18607399]
mat_Sqrt:  [[0.15]]
grads:  [0.04830858]
Stock Position:  0.048308580595263384
Bond Position:  [-27.9486698]


portfolio before change:  [-23.39970268]
curr_Stock_Price:  94.3094395096669
curr_Factors:  [94.30943951]
mat_Sqrt:  [[0.15]]
grads:  [-0.01198499]
Stock Position:  -0.011984991340113153
Bond Position:  [-22.26940486]


portfolio before change:  [-23.39299889]
curr_Stock_Price:  93.28550585778763
curr_Factors:  [93.28550586]
mat_Sqrt:  [[0.15]]
grads:  [0.0445187]
Stock Position:  0.04451869580566043
Bond Position:  [-27.54594795]


portfolio before change:  [-23.37185321]
curr_Stock_Price:  93.91519697704034
curr_Factors:  [93.91519698]
mat_Sqrt:  [[0.15]]
grads:  [0.14800634]
Stock Position:  0.14800633783029077
Bond Position:  [-37.27189758]


portfolio before change:  [-23.35448903]
curr_Stock_Price:  94.09548195834788
curr_Factors:  [94.09548196]
mat_Sqrt:  [[0.15]]
grads:  [0.07710884]
Stock Position:  0.0771088358170987
Bond Position:  [-30.6100821]


portfolio before change:  [-23.27083724]
curr_Stock_Price:  95.27959101819494
curr_Factors:  [95.27959102]
mat_Sqrt:  [[0.15]]
grads:  [0.00313141]
Stock Position:  0.003131405557395747
Bond Position:  [-23.56919628]


portfolio before change:  [-23.28050564]
curr_Stock_Price:  94.07394593320444
curr_Factors:  [94.07394593]
mat_Sqrt:  [[0.15]]
grads:  [-0.06454412]
Stock Position:  -0.06454411520317982
Bond Position:  [-17.20858603]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-23.32256176]
Stock Price:  94.65887051314914
PL:  [-23.32256176]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.74641275e-03]
 [ 1.93203768e-03]
 [-5.14310253e-03]
 [-8.47266632e-03]
 [ 5.13461390e-03]
 [-1.05189765e-02]
 [ 1.32229914e-02]
 [-3.98610871e-03]
 [-6.01118764e-04]
 [ 2.34469775e-03]
 [-3.02914052e-03]
 [-6.58440457e-03]
 [ 5.41713320e-03]
 [ 2.11025709e-04]
 [ 6.40736971e-04]
 [ 1.99718328e-02]
 [ 4.04553314e-03]
 [ 1.09722021e-02]
 [-5.44964357e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.72182128]
curr_Stock_Price:  99.44105180310453
curr_Factors:  [99.4410518]
mat_Sqrt:  [[0.15]]
grads:  [0.01830942]
Stock Position:  0.01830941833014415
Bond Position:  [-12.5425291]


portfolio before change:  [-10.70159153]
curr_Stock_Price:  100.71721342566471
curr_Factors:  [100.71721343]
mat_Sqrt:  [[0.15]]
grads:  [0.01288025]
Stock Position:  0.012880251197752096
Bond Position:  [-11.99885454]


portfolio before change:  [-10.71042252]
curr_Stock_Price:  100.26451239827246
curr_Factors:  [100.2645124]
mat_Sqrt:  [[0.15]]
grads:  [-0.03428735]
Stock Position:  -0.034287350226115294
Bond Position:  [-7.27261807]


portfolio before change:  [-10.71890451]
curr_Stock_Price:  100.4588584951634
curr_Factors:  [100.4588585]
mat_Sqrt:  [[0.15]]
grads:  [-0.05648444]
Stock Position:  -0.056484442143677656
Bond Position:  [-5.04454193]


portfolio before change:  [-10.64967292]
curr_Stock_Price:  99.21085310274343
curr_Factors:  [99.2108531]
mat_Sqrt:  [[0.15]]
grads:  [0.03423076]
Stock Position:  0.03423075934960208
Bond Position:  [-14.04573576]


portfolio before change:  [-10.65811206]
curr_Stock_Price:  99.06691053002123
curr_Factors:  [99.06691053]
mat_Sqrt:  [[0.15]]
grads:  [-0.07012651]
Stock Position:  -0.07012650967550123
Bond Position:  [-3.7108954]


portfolio before change:  [-10.73216749]
curr_Stock_Price:  100.1097057900371
curr_Factors:  [100.10970579]
mat_Sqrt:  [[0.15]]
grads:  [0.08815328]
Stock Position:  0.08815327623933461
Bond Position:  [-19.55716604]


portfolio before change:  [-10.7544694]
curr_Stock_Price:  99.91218606183348
curr_Factors:  [99.91218606]
mat_Sqrt:  [[0.15]]
grads:  [-0.02657406]
Stock Position:  -0.026574058087217696
Bond Position:  [-8.09939717]


portfolio before change:  [-10.74788783]
curr_Stock_Price:  99.58831094207271
curr_Factors:  [99.58831094]
mat_Sqrt:  [[0.15]]
grads:  [-0.00400746]
Stock Position:  -0.004007458429542475
Bond Position:  [-10.34879181]


portfolio before change:  [-10.75666498]
curr_Stock_Price:  101.13283880291574
curr_Factors:  [101.1328388]
mat_Sqrt:  [[0.15]]
grads:  [0.01563132]
Stock Position:  0.015631318321718296
Bond Position:  [-12.33750458]


portfolio before change:  [-10.75561246]
curr_Stock_Price:  101.39751763858894
curr_Factors:  [101.39751764]
mat_Sqrt:  [[0.15]]
grads:  [-0.02019427]
Stock Position:  -0.020194270109959257
Bond Position:  [-8.7079636]


portfolio before change:  [-10.76592902]
curr_Stock_Price:  101.80056732457098
curr_Factors:  [101.80056732]
mat_Sqrt:  [[0.15]]
grads:  [-0.04389603]
Stock Position:  -0.043896030496269015
Bond Position:  [-6.29728821]


portfolio before change:  [-10.72916724]
curr_Stock_Price:  100.92722408967401
curr_Factors:  [100.92722409]
mat_Sqrt:  [[0.15]]
grads:  [0.03611422]
Stock Position:  0.03611422136256175
Bond Position:  [-14.37407535]


portfolio before change:  [-10.68801222]
curr_Stock_Price:  102.16631995607949
curr_Factors:  [102.16631996]
mat_Sqrt:  [[0.15]]
grads:  [0.00140684]
Stock Position:  0.0014068380617315345
Bond Position:  [-10.83174369]


portfolio before change:  [-10.6920462]
curr_Stock_Price:  101.22399435096101
curr_Factors:  [101.22399435]
mat_Sqrt:  [[0.15]]
grads:  [0.00427158]
Stock Position:  0.004271579805065473
Bond Position:  [-11.12443257]


portfolio before change:  [-10.69732796]
curr_Stock_Price:  100.6386592692376
curr_Factors:  [100.63865927]
mat_Sqrt:  [[0.15]]
grads:  [0.13314555]
Stock Position:  0.13314555175737333
Bond Position:  [-24.09691778]


portfolio before change:  [-10.75023115]
curr_Stock_Price:  100.28657686961226
curr_Factors:  [100.28657687]
mat_Sqrt:  [[0.15]]
grads:  [0.02697022]
Stock Position:  0.026970220916010097
Bond Position:  [-13.45498228]


portfolio before change:  [-10.71855431]
curr_Stock_Price:  101.5858249230413
curr_Factors:  [101.58582492]
mat_Sqrt:  [[0.15]]
grads:  [0.07314801]
Stock Position:  0.07314801417369578
Bond Position:  [-18.14935567]


portfolio before change:  [-10.73964008]
curr_Stock_Price:  101.35960053615446
curr_Factors:  [101.35960054]
mat_Sqrt:  [[0.15]]
grads:  [-0.03633096]
Stock Position:  -0.036330957162536655
Bond Position:  [-7.05714877]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.8080648]
Stock Price:  103.19440532532587
PL:  [-14.00247012]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.70562454e-02]
 [ 2.48684973e-02]
 [-1.55288242e-02]
 [-1.47430779e-03]
 [ 6.12316407e-03]
 [-1.05538832e-02]
 [ 1.29013395e-02]
 [-4.46044480e-02]
 [ 4.72816803e-04]
 [ 9.63175177e-03]
 [-3.03431224e-03]
 [-5.74837867e-03]
 [ 5.06943961e-03]
 [-9.35100044e-04]
 [ 8.29193341e-03]
 [ 2.15207334e-02]
 [ 1.21436334e-02]
 [ 2.45935766e-04]
 [-9.32390849e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [24.9720644]
curr_Stock_Price:  101.06055123059636
curr_Factors:  [101.06055123]
mat_Sqrt:  [[0.15]]
grads:  [-0.1137083]
Stock Position:  -0.1137083025047118
Bond Position:  [36.46348813]


portfolio before change:  [24.91418626]
curr_Stock_Price:  101.64973559618264
curr_Factors:  [101.6497356]
mat_Sqrt:  [[0.15]]
grads:  [0.16578998]
Stock Position:  0.16578998228207953
Bond Position:  [8.06167839]


portfolio before change:  [24.82040462]
curr_Stock_Price:  101.07191235434291
curr_Factors:  [101.07191235]
mat_Sqrt:  [[0.15]]
grads:  [-0.10352549]
Stock Position:  -0.1035254946607396
Bond Position:  [35.28392435]


portfolio before change:  [24.86848903]
curr_Stock_Price:  100.69265968439841
curr_Factors:  [100.69265968]
mat_Sqrt:  [[0.15]]
grads:  [-0.00982872]
Stock Position:  -0.009828718568884755
Bond Position:  [25.85816884]


portfolio before change:  [24.88639863]
curr_Stock_Price:  99.52829151900882
curr_Factors:  [99.52829152]
mat_Sqrt:  [[0.15]]
grads:  [0.04082109]
Stock Position:  0.04082109377355021
Bond Position:  [20.8235449]


portfolio before change:  [24.86921537]
curr_Stock_Price:  98.97980563236874
curr_Factors:  [98.97980563]
mat_Sqrt:  [[0.15]]
grads:  [-0.07035922]
Stock Position:  -0.07035922148243272
Bond Position:  [31.83335744]


portfolio before change:  [24.97663169]
curr_Stock_Price:  97.56624550809276
curr_Factors:  [97.56624551]
mat_Sqrt:  [[0.15]]
grads:  [0.08600893]
Stock Position:  0.08600893024897814
Bond Position:  [16.58506329]


portfolio before change:  [24.95563787]
curr_Stock_Price:  97.2739432192617
curr_Factors:  [97.27394322]
mat_Sqrt:  [[0.15]]
grads:  [-0.29736299]
Stock Position:  -0.29736298641648845
Bond Position:  [53.88130813]


portfolio before change:  [24.95782465]
curr_Stock_Price:  97.31189424611368
curr_Factors:  [97.31189425]
mat_Sqrt:  [[0.15]]
grads:  [0.00315211]
Stock Position:  0.003152112021138221
Bond Position:  [24.65108666]


portfolio before change:  [24.96402056]
curr_Stock_Price:  97.32216116237781
curr_Factors:  [97.32216116]
mat_Sqrt:  [[0.15]]
grads:  [0.06421168]
Stock Position:  0.06421167847254869
Bond Position:  [18.71480123]


portfolio before change:  [25.12616167]
curr_Stock_Price:  99.77439158713825
curr_Factors:  [99.77439159]
mat_Sqrt:  [[0.15]]
grads:  [-0.02022875]
Stock Position:  -0.020228748246258074
Bond Position:  [27.14447272]


portfolio before change:  [25.11103987]
curr_Stock_Price:  100.85744283054846
curr_Factors:  [100.85744283]
mat_Sqrt:  [[0.15]]
grads:  [-0.03832252]
Stock Position:  -0.038322524453333236
Bond Position:  [28.97615169]


portfolio before change:  [25.20576131]
curr_Stock_Price:  98.57480357837224
curr_Factors:  [98.57480358]
mat_Sqrt:  [[0.15]]
grads:  [0.03379626]
Stock Position:  0.03379626406059224
Bond Position:  [21.87430122]


portfolio before change:  [25.20401559]
curr_Stock_Price:  98.36131918143353
curr_Factors:  [98.36131918]
mat_Sqrt:  [[0.15]]
grads:  [-0.006234]
Stock Position:  -0.006234000294005732
Bond Position:  [25.81720009]


portfolio before change:  [25.22218514]
curr_Stock_Price:  96.48219831802815
curr_Factors:  [96.48219832]
mat_Sqrt:  [[0.15]]
grads:  [0.05527956]
Stock Position:  0.05527955607731616
Bond Position:  [19.88869205]


portfolio before change:  [25.16032979]
curr_Stock_Price:  95.27328591173395
curr_Factors:  [95.27328591]
mat_Sqrt:  [[0.15]]
grads:  [0.14347156]
Stock Position:  0.1434715561851407
Bond Position:  [11.4913232]


portfolio before change:  [24.94891158]
curr_Stock_Price:  93.77966999573601
curr_Factors:  [93.77967]
mat_Sqrt:  [[0.15]]
grads:  [0.08095756]
Stock Position:  0.08095755578242164
Bond Position:  [17.35673872]


portfolio before change:  [24.95211924]
curr_Stock_Price:  93.7656864709935
curr_Factors:  [93.76568647]
mat_Sqrt:  [[0.15]]
grads:  [0.00163957]
Stock Position:  0.0016395717759350287
Bond Position:  [24.79838367]


portfolio before change:  [24.9598952]
curr_Stock_Price:  94.72666201119122
curr_Factors:  [94.72666201]
mat_Sqrt:  [[0.15]]
grads:  [-0.06215939]
Stock Position:  -0.06215938991626474
Bond Position:  [30.84804672]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [25.00477335]
Stock Price:  94.12876076697667
PL:  [25.00477335]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.06277849e-03]
 [-1.19106916e-03]
 [-1.06394892e-02]
 [ 4.48878503e-03]
 [-6.60539924e-03]
 [-1.15195219e-02]
 [ 1.29659874e-02]
 [-3.95288776e-02]
 [ 2.87767572e-03]
 [ 6.30679748e-03]
 [-1.04303668e-02]
 [ 1.73353279e-02]
 [ 6.32672582e-03]
 [-1.66491835e-03]
 [ 7.63402797e-03]
 [ 1.96939631e-02]
 [ 1.16872085e-02]
 [ 2.84926226e-04]
 [-1.07862355e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.99979622]
curr_Stock_Price:  99.15620814911709
curr_Factors:  [99.15620815]
mat_Sqrt:  [[0.15]]
grads:  [0.01375186]
Stock Position:  0.013751856620018653
Bond Position:  [-18.36337818]


portfolio before change:  [-17.01433073]
curr_Stock_Price:  98.43317184036071
curr_Factors:  [98.43317184]
mat_Sqrt:  [[0.15]]
grads:  [-0.00794046]
Stock Position:  -0.007940461072337406
Bond Position:  [-16.23272596]


portfolio before change:  [-17.01246394]
curr_Stock_Price:  97.6869331951743
curr_Factors:  [97.6869332]
mat_Sqrt:  [[0.15]]
grads:  [-0.07092993]
Stock Position:  -0.07092992772421639
Bond Position:  [-10.08353683]


portfolio before change:  [-16.98267406]
curr_Stock_Price:  97.23139795318235
curr_Factors:  [97.23139795]
mat_Sqrt:  [[0.15]]
grads:  [0.02992523]
Stock Position:  0.02992523352686136
Bond Position:  [-19.89234635]


portfolio before change:  [-17.01406318]
curr_Stock_Price:  96.3486843878456
curr_Factors:  [96.34868439]
mat_Sqrt:  [[0.15]]
grads:  [-0.04403599]
Stock Position:  -0.044035994909557695
Bond Position:  [-12.771253]


portfolio before change:  [-16.99908624]
curr_Stock_Price:  95.93606387862393
curr_Factors:  [95.93606388]
mat_Sqrt:  [[0.15]]
grads:  [-0.07679681]
Stock Position:  -0.07679681263670493
Bond Position:  [-9.63150231]


portfolio before change:  [-17.01994074]
curr_Stock_Price:  96.17626047130973
curr_Factors:  [96.17626047]
mat_Sqrt:  [[0.15]]
grads:  [0.08643992]
Stock Position:  0.0864399159153175
Bond Position:  [-25.33340861]


portfolio before change:  [-17.0220026]
curr_Stock_Price:  96.22568541508517
curr_Factors:  [96.22568542]
mat_Sqrt:  [[0.15]]
grads:  [-0.26352585]
Stock Position:  -0.2635258508367029
Bond Position:  [8.33595302]


portfolio before change:  [-16.96728307]
curr_Stock_Price:  96.02595063550152
curr_Factors:  [96.02595064]
mat_Sqrt:  [[0.15]]
grads:  [0.0191845]
Stock Position:  0.019184504780987596
Bond Position:  [-18.80949338]


portfolio before change:  [-16.98744767]
curr_Stock_Price:  95.22000672483094
curr_Factors:  [95.22000672]
mat_Sqrt:  [[0.15]]
grads:  [0.04204532]
Stock Position:  0.04204531652113589
Bond Position:  [-20.99100299]


portfolio before change:  [-16.96731034]
curr_Stock_Price:  95.82377760775279
curr_Factors:  [95.82377761]
mat_Sqrt:  [[0.15]]
grads:  [-0.06953578]
Stock Position:  -0.06953577876731415
Bond Position:  [-10.30412934]


portfolio before change:  [-16.90628391]
curr_Stock_Price:  94.90910048645783
curr_Factors:  [94.90910049]
mat_Sqrt:  [[0.15]]
grads:  [0.11556885]
Stock Position:  0.11556885294897834
Bond Position:  [-27.87481979]


portfolio before change:  [-16.7877286]
curr_Stock_Price:  95.99524848960385
curr_Factors:  [95.99524849]
mat_Sqrt:  [[0.15]]
grads:  [0.04217817]
Stock Position:  0.04217817214227307
Bond Position:  [-20.83663272]


portfolio before change:  [-16.83972825]
curr_Stock_Price:  94.88591080455595
curr_Factors:  [94.8859108]
mat_Sqrt:  [[0.15]]
grads:  [-0.01109946]
Stock Position:  -0.011099455678175616
Bond Position:  [-15.78654629]


portfolio before change:  [-16.84800305]
curr_Stock_Price:  95.27581022820434
curr_Factors:  [95.27581023]
mat_Sqrt:  [[0.15]]
grads:  [0.05089352]
Stock Position:  0.050893519832996205
Bond Position:  [-21.69692439]


portfolio before change:  [-16.76836788]
curr_Stock_Price:  96.94714435254238
curr_Factors:  [96.94714435]
mat_Sqrt:  [[0.15]]
grads:  [0.13129309]
Stock Position:  0.13129308743812043
Bond Position:  [-29.49685778]


portfolio before change:  [-17.15882876]
curr_Stock_Price:  94.02935375750442
curr_Factors:  [94.02935376]
mat_Sqrt:  [[0.15]]
grads:  [0.07791472]
Stock Position:  0.07791472336091501
Bond Position:  [-24.48509984]


portfolio before change:  [-17.16494186]
curr_Stock_Price:  94.02946846571905
curr_Factors:  [94.02946847]
mat_Sqrt:  [[0.15]]
grads:  [0.00189951]
Stock Position:  0.0018995081711324405
Bond Position:  [-17.3435516]


portfolio before change:  [-17.17302247]
curr_Stock_Price:  92.05833406604094
curr_Factors:  [92.05833407]
mat_Sqrt:  [[0.15]]
grads:  [-0.07190824]
Stock Position:  -0.07190823683330091
Bond Position:  [-10.55326999]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.11483078]
Stock Price:  91.21239011428248
PL:  [-17.11483078]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.38721922e-03]
 [ 1.08775212e-02]
 [-6.81553590e-02]
 [ 1.02937015e-01]
 [ 4.26704656e-03]
 [-1.87114144e-02]
 [-1.08983171e-02]
 [-9.55811895e-03]
 [ 4.27607410e-02]
 [-4.72308818e-03]
 [-6.40514014e-03]
 [ 4.58379190e-02]
 [ 2.04942682e-02]
 [-1.24610295e-02]
 [ 4.43055777e-02]
 [ 1.53228468e-02]
 [ 1.73294695e-02]
 [ 1.80073473e-02]
 [-3.04977907e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.119644]
curr_Stock_Price:  99.8313489343206
curr_Factors:  [99.83134893]
mat_Sqrt:  [[0.15]]
grads:  [0.01591479]
Stock Position:  0.01591479480688232
Bond Position:  [-3.70843943]


portfolio before change:  [-2.10205839]
curr_Stock_Price:  100.99459590521334
curr_Factors:  [100.99459591]
mat_Sqrt:  [[0.15]]
grads:  [0.07251681]
Stock Position:  0.07251680825782521
Bond Position:  [-9.42586413]


portfolio before change:  [-1.85588138]
curr_Stock_Price:  104.42185336446276
curr_Factors:  [104.42185336]
mat_Sqrt:  [[0.15]]
grads:  [-0.45436906]
Stock Position:  -0.4543690599903735
Bond Position:  [45.59017798]


portfolio before change:  [-2.51604904]
curr_Stock_Price:  105.89987352765155
curr_Factors:  [105.89987353]
mat_Sqrt:  [[0.15]]
grads:  [0.68624677]
Stock Position:  0.6862467678295279
Bond Position:  [-75.18949496]


portfolio before change:  [-2.9562993]
curr_Stock_Price:  105.28573505995344
curr_Factors:  [105.28573506]
mat_Sqrt:  [[0.15]]
grads:  [0.02844698]
Stock Position:  0.02844697707221651
Bond Position:  [-5.95136019]


portfolio before change:  [-2.95679453]
curr_Stock_Price:  105.32063489470721
curr_Factors:  [105.32063489]
mat_Sqrt:  [[0.15]]
grads:  [-0.12474276]
Stock Position:  -0.12474276287690998
Bond Position:  [10.18119245]


portfolio before change:  [-2.94391497]
curr_Stock_Price:  105.23779287871889
curr_Factors:  [105.23779288]
mat_Sqrt:  [[0.15]]
grads:  [-0.07265545]
Stock Position:  -0.07265544724373427
Bond Position:  [4.70218393]


portfolio before change:  [-3.08092669]
curr_Stock_Price:  107.13974805302789
curr_Factors:  [107.13974805]
mat_Sqrt:  [[0.15]]
grads:  [-0.06372079]
Stock Position:  -0.0637207929937637
Bond Position:  [3.74610302]


portfolio before change:  [-3.09435796]
curr_Stock_Price:  107.36523039305554
curr_Factors:  [107.36523039]
mat_Sqrt:  [[0.15]]
grads:  [0.28507161]
Stock Position:  0.2850716066453421
Bond Position:  [-33.70113668]


portfolio before change:  [-2.97486702]
curr_Stock_Price:  107.81395018950401
curr_Factors:  [107.81395019]
mat_Sqrt:  [[0.15]]
grads:  [-0.03148725]
Stock Position:  -0.0314872545335631
Bond Position:  [0.41989827]


portfolio before change:  [-3.02112134]
curr_Stock_Price:  109.28627006256274
curr_Factors:  [109.28627006]
mat_Sqrt:  [[0.15]]
grads:  [-0.04270093]
Stock Position:  -0.04270093424152728
Bond Position:  [1.64550449]


portfolio before change:  [-3.08624891]
curr_Stock_Price:  110.82110758508662
curr_Factors:  [110.82110759]
mat_Sqrt:  [[0.15]]
grads:  [0.30558613]
Stock Position:  0.3055861264575123
Bond Position:  [-36.95164191]


portfolio before change:  [-2.92953498]
curr_Stock_Price:  111.36417213642672
curr_Factors:  [111.36417214]
mat_Sqrt:  [[0.15]]
grads:  [0.13662845]
Stock Position:  0.13662845444987012
Bond Position:  [-18.1450497]


portfolio before change:  [-2.66946541]
curr_Stock_Price:  113.30085807983214
curr_Factors:  [113.30085808]
mat_Sqrt:  [[0.15]]
grads:  [-0.08307353]
Stock Position:  -0.08307352994707623
Bond Position:  [6.74283682]


portfolio before change:  [-2.62914758]
curr_Stock_Price:  112.83582542782783
curr_Factors:  [112.83582543]
mat_Sqrt:  [[0.15]]
grads:  [0.29537052]
Stock Position:  0.2953705180460669
Bond Position:  [-35.95752379]


portfolio before change:  [-2.63779705]
curr_Stock_Price:  112.83698002972042
curr_Factors:  [112.83698003]
mat_Sqrt:  [[0.15]]
grads:  [0.10215231]
Stock Position:  0.10215231180221458
Bond Position:  [-14.16435542]


portfolio before change:  [-2.62422208]
curr_Stock_Price:  113.00453869017039
curr_Factors:  [113.00453869]
mat_Sqrt:  [[0.15]]
grads:  [0.1155298]
Stock Position:  0.11552979643920039
Bond Position:  [-15.67961343]


portfolio before change:  [-2.53990994]
curr_Stock_Price:  113.76825972186056
curr_Factors:  [113.76825972]
mat_Sqrt:  [[0.15]]
grads:  [0.12004898]
Stock Position:  0.12004898179081597
Bond Position:  [-16.19767368]


portfolio before change:  [-2.23413268]
curr_Stock_Price:  116.3490994842433
curr_Factors:  [116.34909948]
mat_Sqrt:  [[0.15]]
grads:  [-0.2033186]
Stock Position:  -0.20331860479496533
Bond Position:  [21.4218039]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.22660345]
Stock Price:  116.33841130307715
PL:  [-18.56501475]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.71488568e-02]
 [-9.85869212e-03]
 [-6.90834649e-03]
 [-2.02500271e-03]
 [ 6.36458960e-03]
 [-9.83049661e-03]
 [ 1.44013490e-02]
 [ 1.48366489e-02]
 [-1.87983416e-02]
 [ 2.68360642e-03]
 [-2.92795523e-03]
 [-6.58151708e-03]
 [ 7.80064571e-03]
 [ 4.05463604e-05]
 [ 5.29624204e-03]
 [ 2.09137090e-02]
 [ 4.72514072e-03]
 [ 8.60815259e-03]
 [-4.89549565e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.21688817]
curr_Stock_Price:  101.07165935030886
curr_Factors:  [101.07165935]
mat_Sqrt:  [[0.15]]
grads:  [-0.11432571]
Stock Position:  -0.1143257122174955
Bond Position:  [36.77197761]


portfolio before change:  [25.39226725]
curr_Stock_Price:  99.61804985739109
curr_Factors:  [99.61804986]
mat_Sqrt:  [[0.15]]
grads:  [-0.06572461]
Stock Position:  -0.06572461412925538
Bond Position:  [31.93962514]


portfolio before change:  [25.46504828]
curr_Stock_Price:  98.63219212731433
curr_Factors:  [98.63219213]
mat_Sqrt:  [[0.15]]
grads:  [-0.04605564]
Stock Position:  -0.04605564323515247
Bond Position:  [30.00761733]


portfolio before change:  [25.51984369]
curr_Stock_Price:  97.60533497398863
curr_Factors:  [97.60533497]
mat_Sqrt:  [[0.15]]
grads:  [-0.01350002]
Stock Position:  -0.013500018094433897
Bond Position:  [26.83751748]


portfolio before change:  [25.49620113]
curr_Stock_Price:  99.85368579618483
curr_Factors:  [99.8536858]
mat_Sqrt:  [[0.15]]
grads:  [0.0424306]
Stock Position:  0.04243059731191536
Bond Position:  [21.2593496]


portfolio before change:  [25.52346568]
curr_Stock_Price:  100.37097871944698
curr_Factors:  [100.37097872]
mat_Sqrt:  [[0.15]]
grads:  [-0.06553664]
Stock Position:  -0.0655366440604027
Bond Position:  [32.10144278]


portfolio before change:  [25.56221381]
curr_Stock_Price:  99.90220634784345
curr_Factors:  [99.90220635]
mat_Sqrt:  [[0.15]]
grads:  [0.09600899]
Stock Position:  0.09600899346729536
Bond Position:  [15.97070353]


portfolio before change:  [25.64620714]
curr_Stock_Price:  100.73546325884553
curr_Factors:  [100.73546326]
mat_Sqrt:  [[0.15]]
grads:  [0.09891099]
Stock Position:  0.09891099299844168
Bond Position:  [15.68236244]


portfolio before change:  [25.7111975]
curr_Stock_Price:  101.3528797438586
curr_Factors:  [101.35287974]
mat_Sqrt:  [[0.15]]
grads:  [-0.12532228]
Stock Position:  -0.12532227759360726
Bond Position:  [38.41297123]


portfolio before change:  [25.8061989]
curr_Stock_Price:  100.67146095566132
curr_Factors:  [100.67146096]
mat_Sqrt:  [[0.15]]
grads:  [0.01789071]
Stock Position:  0.01789070945183027
Bond Position:  [24.00511504]


portfolio before change:  [25.80895886]
curr_Stock_Price:  100.49024580967779
curr_Factors:  [100.49024581]
mat_Sqrt:  [[0.15]]
grads:  [-0.0195197]
Stock Position:  -0.01951970154907308
Bond Position:  [27.77049847]


portfolio before change:  [25.7874639]
curr_Stock_Price:  101.94715601642493
curr_Factors:  [101.94715602]
mat_Sqrt:  [[0.15]]
grads:  [-0.04387678]
Stock Position:  -0.04387678055823695
Bond Position:  [30.26057689]


portfolio before change:  [25.77230024]
curr_Stock_Price:  102.46519195660166
curr_Factors:  [102.46519196]
mat_Sqrt:  [[0.15]]
grads:  [0.0520043]
Stock Position:  0.052004304744500116
Bond Position:  [20.44366917]


portfolio before change:  [25.71177214]
curr_Stock_Price:  101.20299539140612
curr_Factors:  [101.20299539]
mat_Sqrt:  [[0.15]]
grads:  [0.00027031]
Stock Position:  0.00027030906965361257
Bond Position:  [25.68441605]


portfolio before change:  [25.71775638]
curr_Stock_Price:  99.583862604867
curr_Factors:  [99.5838626]
mat_Sqrt:  [[0.15]]
grads:  [0.03530828]
Stock Position:  0.035308280238960134
Bond Position:  [22.20162145]


portfolio before change:  [25.76882808]
curr_Stock_Price:  100.87309564297514
curr_Factors:  [100.87309564]
mat_Sqrt:  [[0.15]]
grads:  [0.13942473]
Stock Position:  0.13942472684718862
Bond Position:  [11.70462428]


portfolio before change:  [25.60443748]
curr_Stock_Price:  99.67304221046756
curr_Factors:  [99.67304221]
mat_Sqrt:  [[0.15]]
grads:  [0.03150094]
Stock Position:  0.03150093814486792
Bond Position:  [22.46464315]


portfolio before change:  [25.61759806]
curr_Stock_Price:  99.9125180683246
curr_Factors:  [99.91251807]
mat_Sqrt:  [[0.15]]
grads:  [0.05738768]
Stock Position:  0.05738768394102558
Bond Position:  [19.88385005]


portfolio before change:  [25.60192217]
curr_Stock_Price:  99.55272883104942
curr_Factors:  [99.55272883]
mat_Sqrt:  [[0.15]]
grads:  [-0.03263664]
Stock Position:  -0.03263663767662466
Bond Position:  [28.85098851]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [25.62625762]
Stock Price:  99.02810984800206
PL:  [25.62625762]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-9.00800666e-03]
 [ 1.23840661e-03]
 [-4.29438435e-02]
 [ 2.00194677e-02]
 [ 8.51566317e-04]
 [-1.01742339e-02]
 [ 1.02211674e-02]
 [ 1.50606950e-02]
 [-9.79570299e-03]
 [ 2.37179463e-03]
 [-3.01772025e-03]
 [-4.69740318e-03]
 [ 4.79064947e-03]
 [-3.07468941e-04]
 [ 2.63160033e-03]
 [ 1.70534905e-02]
 [ 1.73627650e-03]
 [ 9.98751499e-03]
 [-4.94330079e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.00085955]
curr_Stock_Price:  100.47202301539735
curr_Factors:  [100.47202302]
mat_Sqrt:  [[0.15]]
grads:  [-0.06005338]
Stock Position:  -0.06005337776094466
Bond Position:  [18.0345439]


portfolio before change:  [11.99173445]
curr_Stock_Price:  100.6990593609089
curr_Factors:  [100.69905936]
mat_Sqrt:  [[0.15]]
grads:  [0.00825604]
Stock Position:  0.008256044081265434
Bond Position:  [11.16035857]


portfolio before change:  [12.0113007]
curr_Stock_Price:  102.73100231948165
curr_Factors:  [102.73100232]
mat_Sqrt:  [[0.15]]
grads:  [-0.28629229]
Stock Position:  -0.28629228980564253
Bond Position:  [41.42239458]


portfolio before change:  [12.41385894]
curr_Stock_Price:  101.3610689720189
curr_Factors:  [101.36106897]
mat_Sqrt:  [[0.15]]
grads:  [0.13346312]
Stock Position:  0.1334631177529736
Bond Position:  [-1.11410534]


portfolio before change:  [12.0064612]
curr_Stock_Price:  98.3106443029265
curr_Factors:  [98.3106443]
mat_Sqrt:  [[0.15]]
grads:  [0.00567711]
Stock Position:  0.005677108780312318
Bond Position:  [11.44834097]


portfolio before change:  [12.01633625]
curr_Stock_Price:  99.54588810064666
curr_Factors:  [99.5458881]
mat_Sqrt:  [[0.15]]
grads:  [-0.06782823]
Stock Position:  -0.06782822612173699
Bond Position:  [18.76835726]


portfolio before change:  [11.94755034]
curr_Stock_Price:  100.6291920904539
curr_Factors:  [100.62919209]
mat_Sqrt:  [[0.15]]
grads:  [0.06814112]
Stock Position:  0.06814111614100828
Bond Position:  [5.09056488]


portfolio before change:  [11.96288223]
curr_Stock_Price:  100.83551520646843
curr_Factors:  [100.83551521]
mat_Sqrt:  [[0.15]]
grads:  [0.10040463]
Stock Position:  0.10040463357722089
Bond Position:  [1.83852927]


portfolio before change:  [11.90054546]
curr_Stock_Price:  100.21008131355912
curr_Factors:  [100.21008131]
mat_Sqrt:  [[0.15]]
grads:  [-0.06530469]
Stock Position:  -0.0653046865927138
Bond Position:  [18.44473341]


portfolio before change:  [11.82739722]
curr_Stock_Price:  101.40080738894169
curr_Factors:  [101.40080739]
mat_Sqrt:  [[0.15]]
grads:  [0.01581196]
Stock Position:  0.015811964184713593
Bond Position:  [10.22405129]


portfolio before change:  [11.82658873]
curr_Stock_Price:  101.18800456751364
curr_Factors:  [101.18800457]
mat_Sqrt:  [[0.15]]
grads:  [-0.02011813]
Stock Position:  -0.02011813499216438
Bond Position:  [13.86230266]


portfolio before change:  [11.84880535]
curr_Stock_Price:  100.25597924767676
curr_Factors:  [100.25597925]
mat_Sqrt:  [[0.15]]
grads:  [-0.03131602]
Stock Position:  -0.03131602119397887
Bond Position:  [14.98842372]


portfolio before change:  [11.85639023]
curr_Stock_Price:  100.13344435256163
curr_Factors:  [100.13344435]
mat_Sqrt:  [[0.15]]
grads:  [0.03193766]
Stock Position:  0.03193766312950614
Bond Position:  [8.65836201]


portfolio before change:  [11.86839964]
curr_Stock_Price:  100.44168702711144
curr_Factors:  [100.44168703]
mat_Sqrt:  [[0.15]]
grads:  [-0.00204979]
Stock Position:  -0.0020497929374501452
Bond Position:  [12.0742843]


portfolio before change:  [11.87124313]
curr_Stock_Price:  100.52728377326146
curr_Factors:  [100.52728377]
mat_Sqrt:  [[0.15]]
grads:  [0.017544]
Stock Position:  0.017544002172626503
Bond Position:  [10.10759225]


portfolio before change:  [11.86224924]
curr_Stock_Price:  99.87058632405821
curr_Factors:  [99.87058632]
mat_Sqrt:  [[0.15]]
grads:  [0.11368994]
Stock Position:  0.11368993677050568
Bond Position:  [0.5079686]


portfolio before change:  [12.04802519]
curr_Stock_Price:  101.50352717606019
curr_Factors:  [101.50352718]
mat_Sqrt:  [[0.15]]
grads:  [0.01157518]
Stock Position:  0.011575176672385787
Bond Position:  [10.87310393]


portfolio before change:  [12.04371419]
curr_Stock_Price:  100.89622583718236
curr_Factors:  [100.89622584]
mat_Sqrt:  [[0.15]]
grads:  [0.06658343]
Stock Position:  0.06658343328266618
Bond Position:  [5.32569707]


portfolio before change:  [11.95698633]
curr_Stock_Price:  99.57368290216768
curr_Factors:  [99.5736829]
mat_Sqrt:  [[0.15]]
grads:  [-0.03295534]
Stock Position:  -0.03295533860240501
Bond Position:  [15.23847077]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.91788562]
Stock Price:  100.87577258113775
PL:  [11.04211304]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.73471796e-03]
 [-5.52569330e-03]
 [-8.17864332e-03]
 [-8.05003177e-03]
 [-5.13416070e-03]
 [-1.10960853e-02]
 [ 1.25362597e-02]
 [-4.70547492e-02]
 [ 3.70391599e-03]
 [ 4.87183816e-03]
 [-1.46984432e-02]
 [ 1.13546929e-02]
 [ 6.86190460e-03]
 [-2.08378914e-03]
 [ 7.04743687e-03]
 [ 2.16243421e-02]
 [ 1.14369206e-02]
 [ 2.98915004e-04]
 [-1.04896737e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.44585912]
curr_Stock_Price:  99.72580413354717
curr_Factors:  [99.72580413]
mat_Sqrt:  [[0.15]]
grads:  [0.01823145]
Stock Position:  0.018231453066678584
Bond Position:  [-6.26400544]


portfolio before change:  [-4.45906216]
curr_Stock_Price:  99.08751991461004
curr_Factors:  [99.08751991]
mat_Sqrt:  [[0.15]]
grads:  [-0.03683796]
Stock Position:  -0.03683795535515525
Bond Position:  [-0.80888053]


portfolio before change:  [-4.43122243]
curr_Stock_Price:  98.32629484890137
curr_Factors:  [98.32629485]
mat_Sqrt:  [[0.15]]
grads:  [-0.05452429]
Stock Position:  -0.054524288772864506
Bond Position:  [0.92994886]


portfolio before change:  [-4.41053889]
curr_Stock_Price:  97.9512138244751
curr_Factors:  [97.95121382]
mat_Sqrt:  [[0.15]]
grads:  [-0.05366688]
Stock Position:  -0.05366687849374144
Bond Position:  [0.846197]


portfolio before change:  [-4.34789601]
curr_Stock_Price:  96.78790219713558
curr_Factors:  [96.7879022]
mat_Sqrt:  [[0.15]]
grads:  [-0.03422774]
Stock Position:  -0.03422773800254133
Bond Position:  [-1.03506505]


portfolio before change:  [-4.36021568]
curr_Stock_Price:  97.1402734873765
curr_Factors:  [97.14027349]
mat_Sqrt:  [[0.15]]
grads:  [-0.0739739]
Stock Position:  -0.07397390181073775
Bond Position:  [2.82562937]


portfolio before change:  [-4.34030638]
curr_Stock_Price:  96.88068452834496
curr_Factors:  [96.88068453]
mat_Sqrt:  [[0.15]]
grads:  [0.08357506]
Stock Position:  0.08357506469935198
Bond Position:  [-12.43711586]


portfolio before change:  [-4.46446349]
curr_Stock_Price:  95.43231657891744
curr_Factors:  [95.43231658]
mat_Sqrt:  [[0.15]]
grads:  [-0.31369833]
Stock Position:  -0.3136983280219779
Bond Position:  [25.47249466]


portfolio before change:  [-4.49811479]
curr_Stock_Price:  95.55989206323405
curr_Factors:  [95.55989206]
mat_Sqrt:  [[0.15]]
grads:  [0.02469277]
Stock Position:  0.024692773268277946
Bond Position:  [-6.85775354]


portfolio before change:  [-4.53062424]
curr_Stock_Price:  94.31277437354403
curr_Factors:  [94.31277437]
mat_Sqrt:  [[0.15]]
grads:  [0.03247892]
Stock Position:  0.03247892105871428
Bond Position:  [-7.59380139]


portfolio before change:  [-4.53719703]
curr_Stock_Price:  94.16886240957804
curr_Factors:  [94.16886241]
mat_Sqrt:  [[0.15]]
grads:  [-0.09798962]
Stock Position:  -0.09798962126207249
Bond Position:  [4.69037413]


portfolio before change:  [-4.72397328]
curr_Stock_Price:  96.08691236891663
curr_Factors:  [96.08691237]
mat_Sqrt:  [[0.15]]
grads:  [0.07569795]
Stock Position:  0.07569795255388201
Bond Position:  [-11.99755581]


portfolio before change:  [-4.8136163]
curr_Stock_Price:  94.94232049910154
curr_Factors:  [94.9423205]
mat_Sqrt:  [[0.15]]
grads:  [0.04574603]
Stock Position:  0.04574603066181323
Bond Position:  [-9.15685061]


portfolio before change:  [-4.9016462]
curr_Stock_Price:  93.0680507588289
curr_Factors:  [93.06805076]
mat_Sqrt:  [[0.15]]
grads:  [-0.01389193]
Stock Position:  -0.01389192758991672
Bond Position:  [-3.60875158]


portfolio before change:  [-4.91718382]
curr_Stock_Price:  94.12156302653536
curr_Factors:  [94.12156303]
mat_Sqrt:  [[0.15]]
grads:  [0.04698291]
Stock Position:  0.04698291248744674
Bond Position:  [-9.33928898]


portfolio before change:  [-4.87512652]
curr_Stock_Price:  95.06642587995982
curr_Factors:  [95.06642588]
mat_Sqrt:  [[0.15]]
grads:  [0.14416228]
Stock Position:  0.14416228051934352
Bond Position:  [-18.58011928]


portfolio before change:  [-5.00954039]
curr_Stock_Price:  94.1662718595247
curr_Factors:  [94.16627186]
mat_Sqrt:  [[0.15]]
grads:  [0.07624614]
Stock Position:  0.07624613731844399
Bond Position:  [-12.18935489]


portfolio before change:  [-5.01580304]
curr_Stock_Price:  94.12410669242452
curr_Factors:  [94.12410669]
mat_Sqrt:  [[0.15]]
grads:  [0.00199277]
Stock Position:  0.001992766695177242
Bond Position:  [-5.20337043]


portfolio before change:  [-5.02014228]
curr_Stock_Price:  92.59947444321794
curr_Factors:  [92.59947444]
mat_Sqrt:  [[0.15]]
grads:  [-0.06993116]
Stock Position:  -0.06993115800110054
Bond Position:  [1.45544619]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.96803737]
Stock Price:  91.85958959174839
PL:  [-4.96803737]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.56729131e-03]
 [-9.81511471e-03]
 [-4.69679705e-03]
 [ 1.92419819e-03]
 [-4.49851676e-03]
 [-1.14122248e-02]
 [ 1.34943345e-02]
 [-4.28716451e-02]
 [-8.19923379e-04]
 [ 1.03654510e-02]
 [-5.44427899e-03]
 [ 6.89694295e-03]
 [ 6.18095169e-03]
 [-1.40669586e-03]
 [ 7.82140429e-03]
 [ 1.93416927e-02]
 [ 7.99573955e-03]
 [ 1.55107832e-03]
 [-4.22255339e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.57079486]
curr_Stock_Price:  99.26641655709754
curr_Factors:  [99.26641656]
mat_Sqrt:  [[0.15]]
grads:  [0.01711528]
Stock Position:  0.01711527538626975
Bond Position:  [-16.26976692]


portfolio before change:  [-14.55890997]
curr_Stock_Price:  100.19849880959254
curr_Factors:  [100.19849881]
mat_Sqrt:  [[0.15]]
grads:  [-0.0654341]
Stock Position:  -0.06543409805905694
Bond Position:  [-8.00251157]


portfolio before change:  [-14.49473761]
curr_Stock_Price:  99.18720300316612
curr_Factors:  [99.187203]
mat_Sqrt:  [[0.15]]
grads:  [-0.03131198]
Stock Position:  -0.0313119803498337
Bond Position:  [-11.38898986]


portfolio before change:  [-14.440955]
curr_Stock_Price:  97.37862319299771
curr_Factors:  [97.37862319]
mat_Sqrt:  [[0.15]]
grads:  [0.01282799]
Stock Position:  0.012827987925976513
Bond Position:  [-15.69012681]


portfolio before change:  [-14.45002151]
curr_Stock_Price:  96.97766485795296
curr_Factors:  [96.97766486]
mat_Sqrt:  [[0.15]]
grads:  [-0.02999011]
Stock Position:  -0.029990111728541418
Bond Position:  [-11.54165051]


portfolio before change:  [-14.43082079]
curr_Stock_Price:  96.24120565124284
curr_Factors:  [96.24120565]
mat_Sqrt:  [[0.15]]
grads:  [-0.0760815]
Stock Position:  -0.07608149861901238
Bond Position:  [-7.10864564]


portfolio before change:  [-14.36176405]
curr_Stock_Price:  95.3101760668912
curr_Factors:  [95.31017607]
mat_Sqrt:  [[0.15]]
grads:  [0.08996223]
Stock Position:  0.08996223025757656
Bond Position:  [-22.93608006]


portfolio before change:  [-14.14471711]
curr_Stock_Price:  97.78656724085613
curr_Factors:  [97.78656724]
mat_Sqrt:  [[0.15]]
grads:  [-0.28581097]
Stock Position:  -0.2858109676224332
Bond Position:  [13.80375629]


portfolio before change:  [-14.5939221]
curr_Stock_Price:  99.37032857807152
curr_Factors:  [99.37032858]
mat_Sqrt:  [[0.15]]
grads:  [-0.00546616]
Stock Position:  -0.005466155858568327
Bond Position:  [-14.0507484]


portfolio before change:  [-14.59087738]
curr_Stock_Price:  98.17060919338655
curr_Factors:  [98.17060919]
mat_Sqrt:  [[0.15]]
grads:  [0.06910301]
Stock Position:  0.06910300698093431
Bond Position:  [-21.37476167]


portfolio before change:  [-14.62242049]
curr_Stock_Price:  97.79148303500455
curr_Factors:  [97.79148304]
mat_Sqrt:  [[0.15]]
grads:  [-0.03629519]
Stock Position:  -0.036295193290927986
Bond Position:  [-11.07305971]


portfolio before change:  [-14.59356476]
curr_Stock_Price:  96.92017349485045
curr_Factors:  [96.92017349]
mat_Sqrt:  [[0.15]]
grads:  [0.04597962]
Stock Position:  0.04597961968483953
Bond Position:  [-19.04991747]


portfolio before change:  [-14.62673298]
curr_Stock_Price:  96.30239650327813
curr_Factors:  [96.3023965]
mat_Sqrt:  [[0.15]]
grads:  [0.04120634]
Stock Position:  0.04120634458415222
Bond Position:  [-18.59500272]


portfolio before change:  [-14.64357215]
curr_Stock_Price:  96.00657228208965
curr_Factors:  [96.00657228]
mat_Sqrt:  [[0.15]]
grads:  [-0.00937797]
Stock Position:  -0.009377972384706985
Bond Position:  [-13.74322516]


portfolio before change:  [-14.64304221]
curr_Stock_Price:  95.58364725986132
curr_Factors:  [95.58364726]
mat_Sqrt:  [[0.15]]
grads:  [0.0521427]
Stock Position:  0.052142695292726464
Bond Position:  [-19.6270312]


portfolio before change:  [-14.56582851]
curr_Stock_Price:  97.15857678024754
curr_Factors:  [97.15857678]
mat_Sqrt:  [[0.15]]
grads:  [0.12894462]
Stock Position:  0.12894461791818684
Bond Position:  [-27.09390407]


portfolio before change:  [-14.71570981]
curr_Stock_Price:  96.04874386950549
curr_Factors:  [96.04874387]
mat_Sqrt:  [[0.15]]
grads:  [0.05330493]
Stock Position:  0.053304930313316096
Bond Position:  [-19.83558141]


portfolio before change:  [-14.66407901]
curr_Stock_Price:  97.11037761717806
curr_Factors:  [97.11037762]
mat_Sqrt:  [[0.15]]
grads:  [0.01034052]
Stock Position:  0.0103405221490348
Bond Position:  [-15.66825102]


portfolio before change:  [-14.66028393]
curr_Stock_Price:  97.85624294636102
curr_Factors:  [97.85624295]
mat_Sqrt:  [[0.15]]
grads:  [-0.02815036]
Stock Position:  -0.028150355933458118
Bond Position:  [-11.90559586]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.67646054]
Stock Price:  98.32514782488774
PL:  [-14.67646054]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-3.25434164e-03]
 [-6.46540791e-03]
 [-4.07665433e-03]
 [-2.17013997e-02]
 [ 6.63287599e-03]
 [-1.35096703e-02]
 [-1.56426739e-03]
 [ 1.50549889e-02]
 [-1.32761154e-02]
 [ 4.28485586e-03]
 [-2.98014967e-03]
 [-4.77339018e-03]
 [ 4.78443364e-03]
 [ 2.01650568e-04]
 [ 2.39652816e-03]
 [ 2.25840726e-02]
 [ 3.22177198e-03]
 [ 1.30919146e-02]
 [-1.06604860e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.82370011]
curr_Stock_Price:  100.23712545287628
curr_Factors:  [100.23712545]
mat_Sqrt:  [[0.15]]
grads:  [-0.02169561]
Stock Position:  -0.021695610965165823
Bond Position:  [8.99840579]


portfolio before change:  [6.84781219]
curr_Stock_Price:  99.22944705275711
curr_Factors:  [99.22944705]
mat_Sqrt:  [[0.15]]
grads:  [-0.04310272]
Stock Position:  -0.04310271939690981
Bond Position:  [11.1248712]


portfolio before change:  [6.8380011]
curr_Stock_Price:  99.52160164721825
curr_Factors:  [99.52160165]
mat_Sqrt:  [[0.15]]
grads:  [-0.0271777]
Stock Position:  -0.027177695565728122
Bond Position:  [9.54276889]


portfolio before change:  [6.84243787]
curr_Stock_Price:  99.44614330546545
curr_Factors:  [99.44614331]
mat_Sqrt:  [[0.15]]
grads:  [-0.144676]
Stock Position:  -0.14467599826694166
Bond Position:  [21.22990793]


portfolio before change:  [6.73120834]
curr_Stock_Price:  100.25165131069173
curr_Factors:  [100.25165131]
mat_Sqrt:  [[0.15]]
grads:  [0.04421917]
Stock Position:  0.04421917326384954
Bond Position:  [2.2981632]


portfolio before change:  [6.86530488]
curr_Stock_Price:  103.2711996190195
curr_Factors:  [103.27119962]
mat_Sqrt:  [[0.15]]
grads:  [-0.09006447]
Stock Position:  -0.09006446852874439
Bond Position:  [16.16637059]


portfolio before change:  [6.93694981]
curr_Stock_Price:  102.52059479104791
curr_Factors:  [102.52059479]
mat_Sqrt:  [[0.15]]
grads:  [-0.01042845]
Stock Position:  -0.010428449233718379
Bond Position:  [8.00608062]


portfolio before change:  [6.95683692]
curr_Stock_Price:  100.80554132273544
curr_Factors:  [100.80554132]
mat_Sqrt:  [[0.15]]
grads:  [0.10036659]
Stock Position:  0.10036659234759363
Bond Position:  [-3.16067175]


portfolio before change:  [6.91364954]
curr_Stock_Price:  100.38311869815028
curr_Factors:  [100.3831187]
mat_Sqrt:  [[0.15]]
grads:  [-0.08850744]
Stock Position:  -0.08850743629443955
Bond Position:  [15.79830202]


portfolio before change:  [6.92962478]
curr_Stock_Price:  100.24725249183655
curr_Factors:  [100.24725249]
mat_Sqrt:  [[0.15]]
grads:  [0.02856571]
Stock Position:  0.028565705751134943
Bond Position:  [4.06599126]


portfolio before change:  [6.94575511]
curr_Stock_Price:  100.77633817661749
curr_Factors:  [100.77633818]
mat_Sqrt:  [[0.15]]
grads:  [-0.01986766]
Stock Position:  -0.019867664456197604
Bond Position:  [8.94794558]


portfolio before change:  [6.95640584]
curr_Stock_Price:  100.35286298563776
curr_Factors:  [100.35286299]
mat_Sqrt:  [[0.15]]
grads:  [-0.0318226]
Stock Position:  -0.03182260119914166
Bond Position:  [10.14989497]


portfolio before change:  [6.96993229]
curr_Stock_Price:  100.00755301864737
curr_Factors:  [100.00755302]
mat_Sqrt:  [[0.15]]
grads:  [0.03189622]
Stock Position:  0.03189622428432531
Bond Position:  [3.78006895]


portfolio before change:  [7.04146567]
curr_Stock_Price:  102.22061253114408
curr_Factors:  [102.22061253]
mat_Sqrt:  [[0.15]]
grads:  [0.00134434]
Stock Position:  0.0013443371167514149
Bond Position:  [6.9040467]


portfolio before change:  [7.04477815]
curr_Stock_Price:  103.40056705003936
curr_Factors:  [103.40056705]
mat_Sqrt:  [[0.15]]
grads:  [0.01597685]
Stock Position:  0.015976854408161177
Bond Position:  [5.39276234]


portfolio before change:  [7.0511834]
curr_Stock_Price:  103.71708036596524
curr_Factors:  [103.71708037]
mat_Sqrt:  [[0.15]]
grads:  [0.15056048]
Stock Position:  0.1505604843037137
Bond Position:  [-8.56451045]


portfolio before change:  [7.05536465]
curr_Stock_Price:  103.75907445386822
curr_Factors:  [103.75907445]
mat_Sqrt:  [[0.15]]
grads:  [0.02147848]
Stock Position:  0.02147847985033362
Bond Position:  [4.82677746]


portfolio before change:  [7.05913358]
curr_Stock_Price:  103.87836064522646
curr_Factors:  [103.87836065]
mat_Sqrt:  [[0.15]]
grads:  [0.08727943]
Stock Position:  0.08727943091908728
Bond Position:  [-2.00731062]


portfolio before change:  [6.9944437]
curr_Stock_Price:  103.1429296830817
curr_Factors:  [103.14292968]
mat_Sqrt:  [[0.15]]
grads:  [-0.07106991]
Stock Position:  -0.07106990670629153
Bond Position:  [14.32480209]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.00339046]
Stock Price:  103.06743906090318
PL:  [3.9359514]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.78210507e-03]
 [-2.92410319e-03]
 [-1.58483511e-02]
 [-1.08087970e-02]
 [ 5.76625419e-03]
 [-9.88621855e-03]
 [ 2.59789221e-03]
 [ 1.50702170e-02]
 [-1.92796965e-02]
 [ 2.37427540e-03]
 [-3.04031554e-03]
 [ 3.68129409e-04]
 [ 5.13674216e-03]
 [-1.01607196e-03]
 [ 8.15298454e-03]
 [ 2.08652676e-02]
 [ 6.93759561e-03]
 [ 2.35297026e-03]
 [-7.78423766e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.01493518]
curr_Stock_Price:  99.65461217089144
curr_Factors:  [99.65461217]
mat_Sqrt:  [[0.15]]
grads:  [0.01854737]
Stock Position:  0.018547367132392287
Bond Position:  [-7.86326585]


portfolio before change:  [-6.03556017]
curr_Stock_Price:  98.64859714494816
curr_Factors:  [98.64859714]
mat_Sqrt:  [[0.15]]
grads:  [-0.01949402]
Stock Position:  -0.01949402127981966
Bond Position:  [-4.11250232]


portfolio before change:  [-6.0841316]
curr_Stock_Price:  101.08745655502301
curr_Factors:  [101.08745656]
mat_Sqrt:  [[0.15]]
grads:  [-0.10565567]
Stock Position:  -0.10565567411072346
Bond Position:  [4.59633177]


portfolio before change:  [-5.99631292]
curr_Stock_Price:  100.26715555308175
curr_Factors:  [100.26715555]
mat_Sqrt:  [[0.15]]
grads:  [-0.07205865]
Stock Position:  -0.07205864668017947
Bond Position:  [1.22880262]


portfolio before change:  [-6.05389173]
curr_Stock_Price:  101.07047420938616
curr_Factors:  [101.07047421]
mat_Sqrt:  [[0.15]]
grads:  [0.03844169]
Stock Position:  0.038441694598834064
Bond Position:  [-9.93921204]


portfolio before change:  [-6.02893561]
curr_Stock_Price:  101.7843146542541
curr_Factors:  [101.78431465]
mat_Sqrt:  [[0.15]]
grads:  [-0.06590812]
Stock Position:  -0.06590812367608866
Bond Position:  [0.67947759]


portfolio before change:  [-6.01695231]
curr_Stock_Price:  101.6050740300986
curr_Factors:  [101.60507403]
mat_Sqrt:  [[0.15]]
grads:  [0.01731928]
Stock Position:  0.017319281405243955
Bond Position:  [-7.77667918]


portfolio before change:  [-6.03135865]
curr_Stock_Price:  100.88553312124591
curr_Factors:  [100.88553312]
mat_Sqrt:  [[0.15]]
grads:  [0.10046811]
Stock Position:  0.10046811360531988
Bond Position:  [-16.16713785]


portfolio before change:  [-5.97905754]
curr_Stock_Price:  101.44634192307944
curr_Factors:  [101.44634192]
mat_Sqrt:  [[0.15]]
grads:  [-0.12853131]
Stock Position:  -0.12853130991329856
Bond Position:  [7.05997367]


portfolio before change:  [-5.9718303]
curr_Stock_Price:  101.40384621575497
curr_Factors:  [101.40384622]
mat_Sqrt:  [[0.15]]
grads:  [0.0158285]
Stock Position:  0.01582850264484981
Bond Position:  [-7.57690134]


portfolio before change:  [-5.97057987]
curr_Stock_Price:  101.60253147723256
curr_Factors:  [101.60253148]
mat_Sqrt:  [[0.15]]
grads:  [-0.02026877]
Stock Position:  -0.020268770248182633
Bond Position:  [-3.9112215]


portfolio before change:  [-5.90609941]
curr_Stock_Price:  98.37301207927973
curr_Factors:  [98.37301208]
mat_Sqrt:  [[0.15]]
grads:  [0.0024542]
Stock Position:  0.0024541960605568964
Bond Position:  [-6.14752607]


portfolio before change:  [-5.90741829]
curr_Stock_Price:  98.46191582878483
curr_Factors:  [98.46191583]
mat_Sqrt:  [[0.15]]
grads:  [0.03424495]
Stock Position:  0.03424494770688129
Bond Position:  [-9.27924145]


portfolio before change:  [-5.9279272]
curr_Stock_Price:  97.93077762433467
curr_Factors:  [97.93077762]
mat_Sqrt:  [[0.15]]
grads:  [-0.00677381]
Stock Position:  -0.006773813036882088
Bond Position:  [-5.26456242]


portfolio before change:  [-5.9256429]
curr_Stock_Price:  97.39923028818974
curr_Factors:  [97.39923029]
mat_Sqrt:  [[0.15]]
grads:  [0.05435323]
Stock Position:  0.05435323028101829
Bond Position:  [-11.21960569]


portfolio before change:  [-5.99334026]
curr_Stock_Price:  96.20533420387147
curr_Factors:  [96.2053342]
mat_Sqrt:  [[0.15]]
grads:  [0.13910178]
Stock Position:  0.13910178408466184
Bond Position:  [-19.37567388]


portfolio before change:  [-5.87358449]
curr_Stock_Price:  97.10108326411141
curr_Factors:  [97.10108326]
mat_Sqrt:  [[0.15]]
grads:  [0.04625064]
Stock Position:  0.04625063737033889
Bond Position:  [-10.36457148]


portfolio before change:  [-5.86112594]
curr_Stock_Price:  97.42648457461085
curr_Factors:  [97.42648457]
mat_Sqrt:  [[0.15]]
grads:  [0.01568647]
Stock Position:  0.015686468367544892
Bond Position:  [-7.38940341]


portfolio before change:  [-5.88474355]
curr_Stock_Price:  96.03866260480861
curr_Factors:  [96.0386626]
mat_Sqrt:  [[0.15]]
grads:  [-0.05189492]
Stock Position:  -0.051894917732324866
Bond Position:  [-0.90082505]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.87250267]
Stock Price:  95.79844433258783
PL:  [-5.87250267]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.11555349e-04]
 [-5.04680250e-03]
 [-7.24691051e-03]
 [-1.49502061e-02]
 [-5.73390495e-03]
 [-1.17222160e-02]
 [ 1.36118254e-02]
 [-5.58973848e-02]
 [ 6.97702620e-03]
 [ 4.27467899e-03]
 [-1.72056784e-02]
 [ 2.71284232e-02]
 [ 7.37122010e-03]
 [-2.09549662e-03]
 [ 6.55436538e-03]
 [ 2.25098735e-02]
 [ 1.16608493e-02]
 [ 3.89675051e-04]
 [-9.85571168e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-25.91259964]
curr_Stock_Price:  98.75181732002861
curr_Factors:  [98.75181732]
mat_Sqrt:  [[0.15]]
grads:  [0.00141037]
Stock Position:  0.001410368993258702
Bond Position:  [-26.05187614]


portfolio before change:  [-25.91874196]
curr_Stock_Price:  99.01519199650629
curr_Factors:  [99.015192]
mat_Sqrt:  [[0.15]]
grads:  [-0.03364535]
Stock Position:  -0.03364535000520494
Bond Position:  [-22.58734117]


portfolio before change:  [-25.90533463]
curr_Stock_Price:  98.44884711941079
curr_Factors:  [98.44884712]
mat_Sqrt:  [[0.15]]
grads:  [-0.04831274]
Stock Position:  -0.04831273674696691
Bond Position:  [-21.1490014]


portfolio before change:  [-25.92389182]
curr_Stock_Price:  98.72350099689493
curr_Factors:  [98.723501]
mat_Sqrt:  [[0.15]]
grads:  [-0.09966804]
Stock Position:  -0.09966804061091668
Bond Position:  [-16.08431392]


portfolio before change:  [-25.71715097]
curr_Stock_Price:  96.6088568913857
curr_Factors:  [96.60885689]
mat_Sqrt:  [[0.15]]
grads:  [-0.03822603]
Stock Position:  -0.03822603297065538
Bond Position:  [-22.02417762]


portfolio before change:  [-25.67490444]
curr_Stock_Price:  95.35962284678058
curr_Factors:  [95.35962285]
mat_Sqrt:  [[0.15]]
grads:  [-0.07814811]
Stock Position:  -0.07814810697740356
Bond Position:  [-18.22273043]


portfolio before change:  [-25.66054559]
curr_Stock_Price:  95.11758109698734
curr_Factors:  [95.1175811]
mat_Sqrt:  [[0.15]]
grads:  [0.0907455]
Stock Position:  0.09074550267453553
Bond Position:  [-34.2920383]


portfolio before change:  [-25.72272527]
curr_Stock_Price:  94.52685653993129
curr_Factors:  [94.52685654]
mat_Sqrt:  [[0.15]]
grads:  [-0.37264923]
Stock Position:  -0.3726492323037603
Bond Position:  [9.50263525]


portfolio before change:  [-25.39103855]
curr_Stock_Price:  93.64315483172402
curr_Factors:  [93.64315483]
mat_Sqrt:  [[0.15]]
grads:  [0.04651351]
Stock Position:  0.04651350802846903
Bond Position:  [-29.74671018]


portfolio before change:  [-25.38489076]
curr_Stock_Price:  93.93522909377174
curr_Factors:  [93.93522909]
mat_Sqrt:  [[0.15]]
grads:  [0.02849786]
Stock Position:  0.02849785992685651
Bond Position:  [-28.06184376]


portfolio before change:  [-25.41295358]
curr_Stock_Price:  93.19670040846489
curr_Factors:  [93.19670041]
mat_Sqrt:  [[0.15]]
grads:  [-0.11470452]
Stock Position:  -0.11470452272020852
Bond Position:  [-14.72287054]


portfolio before change:  [-25.39033375]
curr_Stock_Price:  92.96740684127474
curr_Factors:  [92.96740684]
mat_Sqrt:  [[0.15]]
grads:  [0.18085615]
Stock Position:  0.18085615449402928
Bond Position:  [-42.20406145]


portfolio before change:  [-25.22493657]
curr_Stock_Price:  93.94027676164025
curr_Factors:  [93.94027676]
mat_Sqrt:  [[0.15]]
grads:  [0.04914147]
Stock Position:  0.049141467308860536
Bond Position:  [-29.84129961]


portfolio before change:  [-25.27775714]
curr_Stock_Price:  93.01724140383276
curr_Factors:  [93.0172414]
mat_Sqrt:  [[0.15]]
grads:  [-0.01396998]
Stock Position:  -0.013969977435950779
Bond Position:  [-23.97830838]


portfolio before change:  [-25.28359967]
curr_Stock_Price:  93.00630407949713
curr_Factors:  [93.00630408]
mat_Sqrt:  [[0.15]]
grads:  [0.04369577]
Stock Position:  0.04369576921000862
Bond Position:  [-29.34758167]


portfolio before change:  [-25.27817341]
curr_Stock_Price:  93.29841658148827
curr_Factors:  [93.29841658]
mat_Sqrt:  [[0.15]]
grads:  [0.15006582]
Stock Position:  0.15006582329209445
Bond Position:  [-39.2790771]


portfolio before change:  [-25.17614183]
curr_Stock_Price:  94.04377334572342
curr_Factors:  [94.04377335]
mat_Sqrt:  [[0.15]]
grads:  [0.077739]
Stock Position:  0.07773899551130736
Bond Position:  [-32.4870103]


portfolio before change:  [-25.13028637]
curr_Stock_Price:  94.73812526458183
curr_Factors:  [94.73812526]
mat_Sqrt:  [[0.15]]
grads:  [0.00259783]
Stock Position:  0.002597833672538692
Bond Position:  [-25.37640027]


portfolio before change:  [-25.13918195]
curr_Stock_Price:  93.75627353312484
curr_Factors:  [93.75627353]
mat_Sqrt:  [[0.15]]
grads:  [-0.06570474]
Stock Position:  -0.06570474450430157
Bond Position:  [-18.97894996]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-25.05368818]
Stock Price:  92.38287029659618
PL:  [-25.05368818]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.19217404e-02]
 [ 1.33236803e-02]
 [-3.75261891e-02]
 [ 5.09053990e-02]
 [ 5.54370339e-03]
 [-1.56241891e-02]
 [-3.50027843e-03]
 [-4.59914070e-03]
 [ 5.03388338e-03]
 [ 6.89527107e-04]
 [-3.41665766e-03]
 [ 2.57057711e-03]
 [ 1.11644647e-02]
 [-1.19302714e-03]
 [ 1.80919928e-03]
 [ 2.14187949e-02]
 [ 2.71693349e-03]
 [ 1.01732284e-02]
 [-1.00741709e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.01372274]
curr_Stock_Price:  100.60872234431777
curr_Factors:  [100.60872234]
mat_Sqrt:  [[0.15]]
grads:  [-0.07947827]
Stock Position:  -0.07947826952115175
Bond Position:  [23.00992989]


portfolio before change:  [14.9798022]
curr_Stock_Price:  101.1078995634692
curr_Factors:  [101.10789956]
mat_Sqrt:  [[0.15]]
grads:  [0.08882454]
Stock Position:  0.08882453542498019
Bond Position:  [5.99894]


portfolio before change:  [15.09298238]
curr_Stock_Price:  102.36521274793448
curr_Factors:  [102.36521275]
mat_Sqrt:  [[0.15]]
grads:  [-0.25017459]
Stock Position:  -0.2501745937685287
Bond Position:  [40.7021579]


portfolio before change:  [14.96971744]
curr_Stock_Price:  102.89860726617268
curr_Factors:  [102.89860727]
mat_Sqrt:  [[0.15]]
grads:  [0.33936933]
Stock Position:  0.3393693268240736
Bond Position:  [-19.95091364]


portfolio before change:  [15.1045571]
curr_Stock_Price:  103.31063041134891
curr_Factors:  [103.31063041]
mat_Sqrt:  [[0.15]]
grads:  [0.03695802]
Stock Position:  0.036958022573681956
Bond Position:  [11.28640049]


portfolio before change:  [15.13667281]
curr_Stock_Price:  104.1032526259558
curr_Factors:  [104.10325263]
mat_Sqrt:  [[0.15]]
grads:  [-0.10416126]
Stock Position:  -0.10416126080625362
Bond Position:  [25.98019885]


portfolio before change:  [15.24359438]
curr_Stock_Price:  103.1391157154746
curr_Factors:  [103.13911572]
mat_Sqrt:  [[0.15]]
grads:  [-0.02333519]
Stock Position:  -0.0233351895600724
Bond Position:  [17.6503652]


portfolio before change:  [15.20327925]
curr_Stock_Price:  105.05588962050324
curr_Factors:  [105.05588962]
mat_Sqrt:  [[0.15]]
grads:  [-0.03066094]
Stock Position:  -0.030660938011597364
Bond Position:  [18.42439136]


portfolio before change:  [15.23876463]
curr_Stock_Price:  104.04878715187256
curr_Factors:  [104.04878715]
mat_Sqrt:  [[0.15]]
grads:  [0.03355922]
Stock Position:  0.0335592225335734
Bond Position:  [11.74696822]


portfolio before change:  [15.23807992]
curr_Stock_Price:  103.94086415562137
curr_Factors:  [103.94086416]
mat_Sqrt:  [[0.15]]
grads:  [0.00459685]
Stock Position:  0.004596847382084881
Bond Position:  [14.76027963]


portfolio before change:  [15.24391074]
curr_Stock_Price:  104.40646238559015
curr_Factors:  [104.40646239]
mat_Sqrt:  [[0.15]]
grads:  [-0.02277772]
Stock Position:  -0.022777717744316247
Bond Position:  [17.62205167]


portfolio before change:  [15.2598217]
curr_Stock_Price:  103.90136776146097
curr_Factors:  [103.90136776]
mat_Sqrt:  [[0.15]]
grads:  [0.01713718]
Stock Position:  0.017137180750744937
Bond Position:  [13.47924518]


portfolio before change:  [15.27854559]
curr_Stock_Price:  104.79729438420671
curr_Factors:  [104.79729438]
mat_Sqrt:  [[0.15]]
grads:  [0.07442976]
Stock Position:  0.07442976468878827
Bond Position:  [7.47850763]


portfolio before change:  [15.23085477]
curr_Stock_Price:  104.131422581657
curr_Factors:  [104.13142258]
mat_Sqrt:  [[0.15]]
grads:  [-0.00795351]
Stock Position:  -0.007953514240148939
Bond Position:  [16.05906552]


portfolio before change:  [15.24164418]
curr_Stock_Price:  103.27970574707363
curr_Factors:  [103.27970575]
mat_Sqrt:  [[0.15]]
grads:  [0.01206133]
Stock Position:  0.012061328543157408
Bond Position:  [13.99595372]


portfolio before change:  [15.21763302]
curr_Stock_Price:  100.99881333041121
curr_Factors:  [100.99881333]
mat_Sqrt:  [[0.15]]
grads:  [0.14279197]
Stock Position:  0.14279196614846457
Bond Position:  [0.79581388]


portfolio before change:  [15.21862059]
curr_Stock_Price:  101.00433602175063
curr_Factors:  [101.00433602]
mat_Sqrt:  [[0.15]]
grads:  [0.01811289]
Stock Position:  0.018112889954286417
Bond Position:  [13.38914017]


portfolio before change:  [15.22236122]
curr_Stock_Price:  101.02602896277821
curr_Factors:  [101.02602896]
mat_Sqrt:  [[0.15]]
grads:  [0.06782152]
Stock Position:  0.06782152239815147
Bond Position:  [8.37062213]


portfolio before change:  [15.34718266]
curr_Stock_Price:  102.8356098332997
curr_Factors:  [102.83560983]
mat_Sqrt:  [[0.15]]
grads:  [-0.06716114]
Stock Position:  -0.06716113938161064
Bond Position:  [22.25373939]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.26756953]
Stock Price:  104.1038620581584
PL:  [11.16370747]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.76432940e-02]
 [ 4.57561138e-02]
 [-5.90788867e-02]
 [ 5.61037360e-02]
 [ 4.99754537e-03]
 [-1.79550353e-02]
 [-1.40094673e-02]
 [-5.46405602e-03]
 [ 3.46819956e-02]
 [-1.00096761e-03]
 [-3.16629157e-03]
 [-4.15659382e-03]
 [ 8.62965804e-03]
 [ 1.27308339e-04]
 [ 7.17546371e-03]
 [ 2.11383501e-02]
 [ 6.62217268e-03]
 [ 1.29100141e-02]
 [-1.09342864e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [63.47658379]
curr_Stock_Price:  102.8075744507339
curr_Factors:  [102.80757445]
mat_Sqrt:  [[0.15]]
grads:  [-0.18428863]
Stock Position:  -0.18428862641261665
Bond Position:  [82.42285047]


portfolio before change:  [63.54647955]
curr_Stock_Price:  102.54012727275287
curr_Factors:  [102.54012727]
mat_Sqrt:  [[0.15]]
grads:  [0.30504076]
Stock Position:  0.30504075851914914
Bond Position:  [32.26756135]


portfolio before change:  [63.94647868]
curr_Stock_Price:  103.824975999252
curr_Factors:  [103.824976]
mat_Sqrt:  [[0.15]]
grads:  [-0.39385924]
Stock Position:  -0.39385924453904575
Bond Position:  [104.83890529]


portfolio before change:  [64.21945253]
curr_Stock_Price:  103.19845560032162
curr_Factors:  [103.1984556]
mat_Sqrt:  [[0.15]]
grads:  [0.37402491]
Stock Position:  0.3740249067618832
Bond Position:  [25.6206598]


portfolio before change:  [64.56834104]
curr_Stock_Price:  104.11412335188605
curr_Factors:  [104.11412335]
mat_Sqrt:  [[0.15]]
grads:  [0.03331697]
Stock Position:  0.03331696913952148
Bond Position:  [61.09957401]


portfolio before change:  [64.61381322]
curr_Stock_Price:  105.0204293981243
curr_Factors:  [105.0204294]
mat_Sqrt:  [[0.15]]
grads:  [-0.11970024]
Stock Position:  -0.11970023528412074
Bond Position:  [77.18478333]


portfolio before change:  [64.50144932]
curr_Stock_Price:  106.12036462212775
curr_Factors:  [106.12036462]
mat_Sqrt:  [[0.15]]
grads:  [-0.09339645]
Stock Position:  -0.09339644856189495
Bond Position:  [74.4127145]


portfolio before change:  [64.59662322]
curr_Stock_Price:  105.30054331900965
curr_Factors:  [105.30054332]
mat_Sqrt:  [[0.15]]
grads:  [-0.03642704]
Stock Position:  -0.03642704011552044
Bond Position:  [68.43241034]


portfolio before change:  [64.56425317]
curr_Stock_Price:  106.6588830462929
curr_Factors:  [106.65888305]
mat_Sqrt:  [[0.15]]
grads:  [0.2312133]
Stock Position:  0.23121330383269798
Bond Position:  [39.90330044]


portfolio before change:  [64.22547791]
curr_Stock_Price:  105.15052549625574
curr_Factors:  [105.1505255]
mat_Sqrt:  [[0.15]]
grads:  [-0.00667312]
Stock Position:  -0.006673117373929774
Bond Position:  [64.92715971]


portfolio before change:  [64.25685641]
curr_Stock_Price:  102.8810186316343
curr_Factors:  [102.88101863]
mat_Sqrt:  [[0.15]]
grads:  [-0.02110861]
Stock Position:  -0.02110861043713667
Bond Position:  [66.42853176]


portfolio before change:  [64.27463771]
curr_Stock_Price:  102.82549227222016
curr_Factors:  [102.82549227]
mat_Sqrt:  [[0.15]]
grads:  [-0.02771063]
Stock Position:  -0.027710625451983075
Bond Position:  [67.12399641]


portfolio before change:  [64.28612299]
curr_Stock_Price:  103.01667572633423
curr_Factors:  [103.01667573]
mat_Sqrt:  [[0.15]]
grads:  [0.05753105]
Stock Position:  0.05753105362704338
Bond Position:  [58.35946509]


portfolio before change:  [64.2812628]
curr_Stock_Price:  102.6785648143904
curr_Factors:  [102.67856481]
mat_Sqrt:  [[0.15]]
grads:  [0.00084872]
Stock Position:  0.0008487222613737678
Bond Position:  [64.19411722]


portfolio before change:  [64.29876076]
curr_Stock_Price:  104.38398264161759
curr_Factors:  [104.38398264]
mat_Sqrt:  [[0.15]]
grads:  [0.04783642]
Stock Position:  0.04783642476183354
Bond Position:  [59.30540423]


portfolio before change:  [64.36854754]
curr_Stock_Price:  105.53286801049971
curr_Factors:  [105.53286801]
mat_Sqrt:  [[0.15]]
grads:  [0.14092233]
Stock Position:  0.1409223342402816
Bond Position:  [49.49660944]


portfolio before change:  [64.36212515]
curr_Stock_Price:  105.39947476567173
curr_Factors:  [105.39947477]
mat_Sqrt:  [[0.15]]
grads:  [0.04414782]
Stock Position:  0.04414781789554083
Bond Position:  [59.70896833]


portfolio before change:  [64.29693104]
curr_Stock_Price:  103.58458966089205
curr_Factors:  [103.58458966]
mat_Sqrt:  [[0.15]]
grads:  [0.08606676]
Stock Position:  0.08606676079601805
Bond Position:  [55.38174094]


portfolio before change:  [64.28803087]
curr_Stock_Price:  103.32029091784493
curr_Factors:  [103.32029092]
mat_Sqrt:  [[0.15]]
grads:  [-0.07289524]
Stock Position:  -0.07289524235944701
Bond Position:  [71.81958852]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [64.208079]
Stock Price:  104.66343771606064
PL:  [59.54464128]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.67838197e-02]
 [ 4.69842528e-02]
 [-2.75177660e-02]
 [ 4.91814136e-03]
 [ 5.76385702e-03]
 [-9.60373675e-03]
 [ 9.00657360e-03]
 [-1.47667486e-02]
 [-2.43006226e-03]
 [ 9.16074567e-03]
 [-9.78927650e-03]
 [ 3.10476461e-03]
 [ 6.02565026e-03]
 [-1.63077611e-03]
 [ 7.48352491e-03]
 [ 2.08144243e-02]
 [ 7.40838294e-03]
 [ 3.43238727e-04]
 [-9.29918864e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [24.25189117]
curr_Stock_Price:  101.0278756022597
curr_Factors:  [101.0278756]
mat_Sqrt:  [[0.15]]
grads:  [-0.11189213]
Stock Position:  -0.11189213101678193
Bond Position:  [35.55611546]


portfolio before change:  [24.08619194]
curr_Stock_Price:  102.58821200516363
curr_Factors:  [102.58821201]
mat_Sqrt:  [[0.15]]
grads:  [0.31322835]
Stock Position:  0.3132283522918835
Bond Position:  [-8.04734467]


portfolio before change:  [23.81645614]
curr_Stock_Price:  101.73348826316722
curr_Factors:  [101.73348826]
mat_Sqrt:  [[0.15]]
grads:  [-0.18345177]
Stock Position:  -0.18345177354550932
Bond Position:  [42.47964499]


portfolio before change:  [23.98155064]
curr_Stock_Price:  100.89145083639845
curr_Factors:  [100.89145084]
mat_Sqrt:  [[0.15]]
grads:  [0.03278761]
Stock Position:  0.0327876090947084
Bond Position:  [20.67356119]


portfolio before change:  [23.99282637]
curr_Stock_Price:  101.07770070068455
curr_Factors:  [101.0777007]
mat_Sqrt:  [[0.15]]
grads:  [0.03842571]
Stock Position:  0.03842571343907749
Bond Position:  [20.1088436]


portfolio before change:  [23.98624279]
curr_Stock_Price:  100.77552246312639
curr_Factors:  [100.77552246]
mat_Sqrt:  [[0.15]]
grads:  [-0.06402491]
Stock Position:  -0.06402491165201422
Bond Position:  [30.43838671]


portfolio before change:  [23.9935938]
curr_Stock_Price:  100.77957620939925
curr_Factors:  [100.77957621]
mat_Sqrt:  [[0.15]]
grads:  [0.06004382]
Stock Position:  0.06004382401813688
Bond Position:  [17.94240266]


portfolio before change:  [23.92415278]
curr_Stock_Price:  99.54835587080974
curr_Factors:  [99.54835587]
mat_Sqrt:  [[0.15]]
grads:  [-0.09844499]
Stock Position:  -0.09844499085956154
Bond Position:  [33.72418977]


portfolio before change:  [24.02733966]
curr_Stock_Price:  98.58584094928295
curr_Factors:  [98.58584095]
mat_Sqrt:  [[0.15]]
grads:  [-0.01620042]
Stock Position:  -0.016200415038686418
Bond Position:  [25.6244712]


portfolio before change:  [24.05904298]
curr_Stock_Price:  97.0243743425574
curr_Factors:  [97.02437434]
mat_Sqrt:  [[0.15]]
grads:  [0.06107164]
Stock Position:  0.061071637800654985
Bond Position:  [18.13360553]


portfolio before change:  [24.00543561]
curr_Stock_Price:  96.07235565718507
curr_Factors:  [96.07235566]
mat_Sqrt:  [[0.15]]
grads:  [-0.06526184]
Stock Position:  -0.06526184335720892
Bond Position:  [30.27529464]


portfolio before change:  [23.90616395]
curr_Stock_Price:  97.70947511397506
curr_Factors:  [97.70947511]
mat_Sqrt:  [[0.15]]
grads:  [0.02069843]
Stock Position:  0.02069843074125002
Bond Position:  [21.88373114]


portfolio before change:  [23.89205057]
curr_Stock_Price:  96.76326850973578
curr_Factors:  [96.76326851]
mat_Sqrt:  [[0.15]]
grads:  [0.040171]
Stock Position:  0.04017100171178544
Bond Position:  [20.00497315]


portfolio before change:  [23.8275894]
curr_Stock_Price:  95.03408492196974
curr_Factors:  [95.03408492]
mat_Sqrt:  [[0.15]]
grads:  [-0.01087184]
Stock Position:  -0.010871840762551257
Bond Position:  [24.86078484]


portfolio before change:  [23.83386553]
curr_Stock_Price:  95.02855157611921
curr_Factors:  [95.02855158]
mat_Sqrt:  [[0.15]]
grads:  [0.04989017]
Stock Position:  0.049890166082058006
Bond Position:  [19.09287531]


portfolio before change:  [23.8990221]
curr_Stock_Price:  96.23886523095322
curr_Factors:  [96.23886523]
mat_Sqrt:  [[0.15]]
grads:  [0.13876283]
Stock Position:  0.13876282833485018
Bond Position:  [10.54464496]


portfolio before change:  [23.93094567]
curr_Stock_Price:  96.44992378578924
curr_Factors:  [96.44992379]
mat_Sqrt:  [[0.15]]
grads:  [0.04938922]
Stock Position:  0.04938921963006904
Bond Position:  [19.1673592]


portfolio before change:  [23.83567782]
curr_Stock_Price:  94.4239697897189
curr_Factors:  [94.42396979]
mat_Sqrt:  [[0.15]]
grads:  [0.00228826]
Stock Position:  0.002288258177242248
Bond Position:  [23.6196114]


portfolio before change:  [23.84237932]
curr_Stock_Price:  94.77176865972464
curr_Factors:  [94.77176866]
mat_Sqrt:  [[0.15]]
grads:  [-0.06199459]
Stock Position:  -0.061994590903350424
Bond Position:  [29.71771634]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.95868844]
Stock Price:  93.01550632251137
PL:  [23.95868844]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 1.42205987e-03]
 [-8.61057207e-04]
 [-1.38453375e-02]
 [ 1.74859340e-02]
 [-1.07175873e-02]
 [-1.13826980e-02]
 [ 1.44933040e-02]
 [-4.90469430e-02]
 [ 3.44990978e-03]
 [ 5.06636481e-03]
 [-1.86838631e-02]
 [ 2.16931990e-02]
 [ 7.85417971e-03]
 [-1.61873758e-03]
 [ 8.20479815e-03]
 [ 2.16193001e-02]
 [ 1.19049574e-02]
 [ 1.36762726e-04]
 [-9.33006344e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.08456702]
curr_Stock_Price:  99.01624623541242
curr_Factors:  [99.01624624]
mat_Sqrt:  [[0.15]]
grads:  [0.0094804]
Stock Position:  0.00948039915374317
Bond Position:  [-21.02328056]


portfolio before change:  [-20.10109777]
curr_Stock_Price:  97.82702752817521
curr_Factors:  [97.82702753]
mat_Sqrt:  [[0.15]]
grads:  [-0.00574038]
Stock Position:  -0.005740381382966693
Bond Position:  [-19.53953332]


portfolio before change:  [-20.09975495]
curr_Stock_Price:  96.74202821917201
curr_Factors:  [96.74202822]
mat_Sqrt:  [[0.15]]
grads:  [-0.09230225]
Stock Position:  -0.09230225010395207
Bond Position:  [-11.17024807]


portfolio before change:  [-20.06259613]
curr_Stock_Price:  96.30919224131287
curr_Factors:  [96.30919224]
mat_Sqrt:  [[0.15]]
grads:  [0.11657289]
Stock Position:  0.11657289339698984
Bond Position:  [-31.28963733]


portfolio before change:  [-20.20892495]
curr_Stock_Price:  95.12104782470344
curr_Factors:  [95.12104782]
mat_Sqrt:  [[0.15]]
grads:  [-0.07145058]
Stock Position:  -0.07145058180713829
Bond Position:  [-13.41247074]


portfolio before change:  [-20.2983142]
curr_Stock_Price:  96.32517677825847
curr_Factors:  [96.32517678]
mat_Sqrt:  [[0.15]]
grads:  [-0.07588465]
Stock Position:  -0.0758846533174983
Bond Position:  [-12.98871156]


portfolio before change:  [-20.10027432]
curr_Stock_Price:  93.67263169761938
curr_Factors:  [93.6726317]
mat_Sqrt:  [[0.15]]
grads:  [0.09662203]
Stock Position:  0.09662202691081843
Bond Position:  [-29.15111386]


portfolio before change:  [-19.95724908]
curr_Stock_Price:  95.22832175804125
curr_Factors:  [95.22832176]
mat_Sqrt:  [[0.15]]
grads:  [-0.32697962]
Stock Position:  -0.326979620008001
Bond Position:  [11.18047138]


portfolio before change:  [-20.11150737]
curr_Stock_Price:  95.70863840125944
curr_Factors:  [95.7086384]
mat_Sqrt:  [[0.15]]
grads:  [0.0229994]
Stock Position:  0.022999398539993242
Bond Position:  [-22.31274849]


portfolio before change:  [-20.14636167]
curr_Stock_Price:  94.43576104601478
curr_Factors:  [94.43576105]
mat_Sqrt:  [[0.15]]
grads:  [0.03377577]
Stock Position:  0.0337757654049214
Bond Position:  [-23.33600178]


portfolio before change:  [-20.21340538]
curr_Stock_Price:  92.62354516292785
curr_Factors:  [92.62354516]
mat_Sqrt:  [[0.15]]
grads:  [-0.12455909]
Stock Position:  -0.12455908753388756
Bond Position:  [-8.67630111]


portfolio before change:  [-20.39263706]
curr_Stock_Price:  94.04505797552144
curr_Factors:  [94.04505798]
mat_Sqrt:  [[0.15]]
grads:  [0.14462133]
Stock Position:  0.1446213268545244
Bond Position:  [-33.99355813]


portfolio before change:  [-20.5308425]
curr_Stock_Price:  93.14819172837028
curr_Factors:  [93.14819173]
mat_Sqrt:  [[0.15]]
grads:  [0.0523612]
Stock Position:  0.052361198081520684
Bond Position:  [-25.40819342]


portfolio before change:  [-20.43571205]
curr_Stock_Price:  95.08633105066647
curr_Factors:  [95.08633105]
mat_Sqrt:  [[0.15]]
grads:  [-0.01079158]
Stock Position:  -0.010791583843309456
Bond Position:  [-19.40957993]


portfolio before change:  [-20.45285302]
curr_Stock_Price:  96.22499347619731
curr_Factors:  [96.22499348]
mat_Sqrt:  [[0.15]]
grads:  [0.05469865]
Stock Position:  0.05469865434590264
Bond Position:  [-25.71623068]


portfolio before change:  [-20.52210434]
curr_Stock_Price:  95.07649241843505
curr_Factors:  [95.07649242]
mat_Sqrt:  [[0.15]]
grads:  [0.14412867]
Stock Position:  0.14412866743794547
Bond Position:  [-34.2253525]


portfolio before change:  [-20.69875275]
curr_Stock_Price:  93.91023585845238
curr_Factors:  [93.91023586]
mat_Sqrt:  [[0.15]]
grads:  [0.07936638]
Stock Position:  0.07936638286271915
Bond Position:  [-28.15206849]


portfolio before change:  [-20.77588306]
curr_Stock_Price:  93.02709854402332
curr_Factors:  [93.02709854]
mat_Sqrt:  [[0.15]]
grads:  [0.00091175]
Stock Position:  0.0009117515034679641
Bond Position:  [-20.86070066]


portfolio before change:  [-20.77955955]
curr_Stock_Price:  94.71543099494544
curr_Factors:  [94.71543099]
mat_Sqrt:  [[0.15]]
grads:  [-0.06220042]
Stock Position:  -0.062200422900348176
Bond Position:  [-14.88821969]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.78669905]
Stock Price:  94.77036597697345
PL:  [-20.78669905]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-3.03032090e-03]
 [-1.01341293e-02]
 [-4.00777605e-03]
 [-5.34057265e-03]
 [ 6.19425933e-03]
 [-1.02445212e-02]
 [ 1.36598961e-02]
 [-3.36108665e-02]
 [ 5.22086272e-04]
 [ 1.03574522e-02]
 [-6.17338135e-03]
 [ 3.18464417e-03]
 [ 4.82539133e-03]
 [-3.86346338e-04]
 [ 7.69197421e-03]
 [ 1.77482247e-02]
 [ 6.05141467e-03]
 [ 8.60252215e-03]
 [-5.26917219e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.55886101]
curr_Stock_Price:  100.22510919976075
curr_Factors:  [100.2251092]
mat_Sqrt:  [[0.15]]
grads:  [-0.02020214]
Stock Position:  -0.02020213934365859
Bond Position:  [8.58362264]


portfolio before change:  [6.56616805]
curr_Stock_Price:  99.96964818284577
curr_Factors:  [99.96964818]
mat_Sqrt:  [[0.15]]
grads:  [-0.06756086]
Stock Position:  -0.0675608618869852
Bond Position:  [13.32020364]


portfolio before change:  [6.60469134]
curr_Stock_Price:  99.44874265087557
curr_Factors:  [99.44874265]
mat_Sqrt:  [[0.15]]
grads:  [-0.02671851]
Stock Position:  -0.026718506971166445
Bond Position:  [9.26181326]


portfolio before change:  [6.65117467]
curr_Stock_Price:  97.79567190103808
curr_Factors:  [97.7956719]
mat_Sqrt:  [[0.15]]
grads:  [-0.03560382]
Stock Position:  -0.035603817638336054
Bond Position:  [10.13307393]


portfolio before change:  [6.58856322]
curr_Stock_Price:  99.62539223133625
curr_Factors:  [99.62539223]
mat_Sqrt:  [[0.15]]
grads:  [0.04129506]
Stock Position:  0.04129506218663582
Bond Position:  [2.47452645]


portfolio before change:  [6.58204356]
curr_Stock_Price:  99.4525297238226
curr_Factors:  [99.45252972]
mat_Sqrt:  [[0.15]]
grads:  [-0.06829681]
Stock Position:  -0.06829680788783686
Bond Position:  [13.37433388]


portfolio before change:  [6.64435786]
curr_Stock_Price:  98.58908821689785
curr_Factors:  [98.58908822]
mat_Sqrt:  [[0.15]]
grads:  [0.09106597]
Stock Position:  0.09106597368879774
Bond Position:  [-2.33375345]


portfolio before change:  [6.6219509]
curr_Stock_Price:  98.34944383642056
curr_Factors:  [98.34944384]
mat_Sqrt:  [[0.15]]
grads:  [-0.22407244]
Stock Position:  -0.22407244306057067
Bond Position:  [28.65935106]


portfolio before change:  [6.86750626]
curr_Stock_Price:  97.28554851806321
curr_Factors:  [97.28554852]
mat_Sqrt:  [[0.15]]
grads:  [0.00348058]
Stock Position:  0.003480575148264251
Bond Position:  [6.5288966]


portfolio before change:  [6.87217744]
curr_Stock_Price:  98.15861020917391
curr_Factors:  [98.15861021]
mat_Sqrt:  [[0.15]]
grads:  [0.06904968]
Stock Position:  0.06904968126528166
Bond Position:  [0.0943567]


portfolio before change:  [6.82779237]
curr_Stock_Price:  97.5154693886941
curr_Factors:  [97.51546939]
mat_Sqrt:  [[0.15]]
grads:  [-0.04115588]
Stock Position:  -0.041155875664629166
Bond Position:  [10.8411269]


portfolio before change:  [6.82328298]
curr_Stock_Price:  97.69090009771043
curr_Factors:  [97.6909001]
mat_Sqrt:  [[0.15]]
grads:  [0.02123096]
Stock Position:  0.021230961102803616
Bond Position:  [4.74921128]


portfolio before change:  [6.86678602]
curr_Stock_Price:  99.68400758427536
curr_Factors:  [99.68400758]
mat_Sqrt:  [[0.15]]
grads:  [0.03216928]
Stock Position:  0.03216927552424763
Bond Position:  [3.66002372]


portfolio before change:  [6.88702998]
curr_Stock_Price:  100.28485517045951
curr_Factors:  [100.28485517]
mat_Sqrt:  [[0.15]]
grads:  [-0.00257564]
Stock Position:  -0.002575642251231923
Bond Position:  [7.14532789]


portfolio before change:  [6.89270431]
curr_Stock_Price:  98.7754149492334
curr_Factors:  [98.77541495]
mat_Sqrt:  [[0.15]]
grads:  [0.05127983]
Stock Position:  0.05127982804013473
Bond Position:  [1.82751802]


portfolio before change:  [6.86221464]
curr_Stock_Price:  98.17192994549174
curr_Factors:  [98.17192995]
mat_Sqrt:  [[0.15]]
grads:  [0.1183215]
Stock Position:  0.11832149802959713
Bond Position:  [-4.75363518]


portfolio before change:  [6.87721353]
curr_Stock_Price:  98.30873901231539
curr_Factors:  [98.30873901]
mat_Sqrt:  [[0.15]]
grads:  [0.04034276]
Stock Position:  0.040342764443239726
Bond Position:  [2.91116723]


portfolio before change:  [6.94248416]
curr_Stock_Price:  99.9085983338485
curr_Factors:  [99.90859833]
mat_Sqrt:  [[0.15]]
grads:  [0.05735015]
Stock Position:  0.05735014766082045
Bond Position:  [1.2127113]


portfolio before change:  [6.96793963]
curr_Stock_Price:  100.3471716838734
curr_Factors:  [100.34717168]
mat_Sqrt:  [[0.15]]
grads:  [-0.03512781]
Stock Position:  -0.03512781457479543
Bond Position:  [10.49291647]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.89309415]
Stock Price:  102.55251905770992
PL:  [4.34057509]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-9.57839265e-03]
 [ 1.88492285e-02]
 [-7.03871243e-03]
 [-9.91218549e-03]
 [ 2.13385765e-03]
 [-1.09221498e-02]
 [ 1.25383586e-02]
 [-4.42562708e-02]
 [ 4.67988968e-03]
 [ 7.69146966e-03]
 [-4.95246985e-03]
 [-2.35661802e-03]
 [ 5.83259851e-03]
 [-1.06644403e-03]
 [ 8.24634868e-03]
 [ 2.09351075e-02]
 [ 9.11886884e-03]
 [ 4.97840073e-04]
 [-8.22491623e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.59065088]
curr_Stock_Price:  100.49878296919165
curr_Factors:  [100.49878297]
mat_Sqrt:  [[0.15]]
grads:  [-0.06385595]
Stock Position:  -0.06385595097083213
Bond Position:  [19.00809624]


portfolio before change:  [12.54016462]
curr_Stock_Price:  101.36383746743391
curr_Factors:  [101.36383747]
mat_Sqrt:  [[0.15]]
grads:  [0.12566152]
Stock Position:  0.1256615235137936
Bond Position:  [-0.19736962]


portfolio before change:  [12.18798111]
curr_Stock_Price:  98.56159412010204
curr_Factors:  [98.56159412]
mat_Sqrt:  [[0.15]]
grads:  [-0.04692475]
Stock Position:  -0.046924749549242556
Bond Position:  [16.81295923]


portfolio before change:  [12.21581053]
curr_Stock_Price:  98.05811448531665
curr_Factors:  [98.05811449]
mat_Sqrt:  [[0.15]]
grads:  [-0.06608124]
Stock Position:  -0.06608123662687897
Bond Position:  [18.69561199]


portfolio before change:  [12.18552671]
curr_Stock_Price:  98.58713466127777
curr_Factors:  [98.58713466]
mat_Sqrt:  [[0.15]]
grads:  [0.01422572]
Stock Position:  0.014225717664004872
Bond Position:  [10.78305397]


portfolio before change:  [12.17467698]
curr_Stock_Price:  97.63492774424705
curr_Factors:  [97.63492774]
mat_Sqrt:  [[0.15]]
grads:  [-0.07281433]
Stock Position:  -0.0728143322086673
Bond Position:  [19.28389905]


portfolio before change:  [12.21417387]
curr_Stock_Price:  97.15871226204537
curr_Factors:  [97.15871226]
mat_Sqrt:  [[0.15]]
grads:  [0.08358906]
Stock Position:  0.08358905752638848
Bond Position:  [4.09276868]


portfolio before change:  [12.09484235]
curr_Stock_Price:  95.71887258962732
curr_Factors:  [95.71887259]
mat_Sqrt:  [[0.15]]
grads:  [-0.29504181]
Stock Position:  -0.295041805114966
Bond Position:  [40.3359113]


portfolio before change:  [12.32045913]
curr_Stock_Price:  94.98836070945265
curr_Factors:  [94.98836071]
mat_Sqrt:  [[0.15]]
grads:  [0.03119926]
Stock Position:  0.031199264545734795
Bond Position:  [9.35689214]


portfolio before change:  [12.35733889]
curr_Stock_Price:  96.09544575939094
curr_Factors:  [96.09544576]
mat_Sqrt:  [[0.15]]
grads:  [0.05127646]
Stock Position:  0.051276464413912856
Bond Position:  [7.42990418]


portfolio before change:  [12.4564821]
curr_Stock_Price:  97.992719735973
curr_Factors:  [97.99271974]
mat_Sqrt:  [[0.15]]
grads:  [-0.03301647]
Stock Position:  -0.03301646566010395
Bond Position:  [15.69185536]


portfolio before change:  [12.42563309]
curr_Stock_Price:  99.04590504414824
curr_Factors:  [99.04590504]
mat_Sqrt:  [[0.15]]
grads:  [-0.01571079]
Stock Position:  -0.015710786830881555
Bond Position:  [13.9817222]


portfolio before change:  [12.45821805]
curr_Stock_Price:  97.19436881781806
curr_Factors:  [97.19436882]
mat_Sqrt:  [[0.15]]
grads:  [0.03888399]
Stock Position:  0.038883990062874116
Bond Position:  [8.67891318]


portfolio before change:  [12.47701722]
curr_Stock_Price:  97.6220297981925
curr_Factors:  [97.6220298]
mat_Sqrt:  [[0.15]]
grads:  [-0.00710963]
Stock Position:  -0.007109626895413058
Bond Position:  [13.17107343]


portfolio before change:  [12.48972815]
curr_Stock_Price:  96.29738207621757
curr_Factors:  [96.29738208]
mat_Sqrt:  [[0.15]]
grads:  [0.05497566]
Stock Position:  0.05497565787820599
Bond Position:  [7.19571622]


portfolio before change:  [12.48393478]
curr_Stock_Price:  96.15927504385432
curr_Factors:  [96.15927504]
mat_Sqrt:  [[0.15]]
grads:  [0.13956738]
Stock Position:  0.13956738321710901
Bond Position:  [-0.93676361]


portfolio before change:  [12.3825239]
curr_Stock_Price:  95.43434450260459
curr_Factors:  [95.4343445]
mat_Sqrt:  [[0.15]]
grads:  [0.06079246]
Stock Position:  0.060792458937997826
Bond Position:  [6.58083543]


portfolio before change:  [12.38633043]
curr_Stock_Price:  95.46989364770226
curr_Factors:  [95.46989365]
mat_Sqrt:  [[0.15]]
grads:  [0.00331893]
Stock Position:  0.0033189338212645295
Bond Position:  [12.06947217]


portfolio before change:  [12.39058532]
curr_Stock_Price:  95.84264611512855
curr_Factors:  [95.84264612]
mat_Sqrt:  [[0.15]]
grads:  [-0.05483277]
Stock Position:  -0.05483277483981497
Bond Position:  [17.64590355]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.33255343]
Stock Price:  96.98145259175564
PL:  [12.33255343]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 1.80483618e-04]
 [-2.63366293e-03]
 [-1.22909220e-02]
 [-1.37949074e-02]
 [ 1.56224041e-03]
 [-1.08383932e-02]
 [ 1.39427516e-02]
 [ 5.91394942e-03]
 [-1.28361373e-02]
 [ 1.04080042e-02]
 [-5.60108941e-03]
 [ 2.19415088e-03]
 [ 5.60404493e-03]
 [-1.26729864e-03]
 [ 7.82674563e-03]
 [ 1.79294179e-02]
 [ 6.18900355e-03]
 [ 9.37504971e-03]
 [-5.41512869e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-46.58747633]
curr_Stock_Price:  97.81375887317945
curr_Factors:  [97.81375887]
mat_Sqrt:  [[0.15]]
grads:  [0.00120322]
Stock Position:  0.0012032241177223346
Bond Position:  [-46.7051682]


portfolio before change:  [-46.59819302]
curr_Stock_Price:  98.61249388280346
curr_Factors:  [98.61249388]
mat_Sqrt:  [[0.15]]
grads:  [-0.01755775]
Stock Position:  -0.01755775286569673
Bond Position:  [-44.86677922]


portfolio before change:  [-46.58461411]
curr_Stock_Price:  97.20018307729616
curr_Factors:  [97.20018308]
mat_Sqrt:  [[0.15]]
grads:  [-0.08193948]
Stock Position:  -0.08193947969173661
Bond Position:  [-38.62008169]


portfolio before change:  [-46.70100774]
curr_Stock_Price:  98.50282013755177
curr_Factors:  [98.50282014]
mat_Sqrt:  [[0.15]]
grads:  [-0.09196605]
Stock Position:  -0.09196604910826853
Bond Position:  [-37.64209255]


portfolio before change:  [-46.70687394]
curr_Stock_Price:  98.46426781765759
curr_Factors:  [98.46426782]
mat_Sqrt:  [[0.15]]
grads:  [0.01041494]
Stock Position:  0.010414936036514675
Bond Position:  [-47.73237299]


portfolio before change:  [-46.7242434]
curr_Stock_Price:  97.94243300279626
curr_Factors:  [97.942433]
mat_Sqrt:  [[0.15]]
grads:  [-0.07225595]
Stock Position:  -0.07225595468179173
Bond Position:  [-39.6473194]


portfolio before change:  [-46.81303882]
curr_Stock_Price:  99.03414027069346
curr_Factors:  [99.03414027]
mat_Sqrt:  [[0.15]]
grads:  [0.09295168]
Stock Position:  0.09295167760097776
Bond Position:  [-56.0184283]


portfolio before change:  [-46.71437309]
curr_Stock_Price:  100.24629795786426
curr_Factors:  [100.24629796]
mat_Sqrt:  [[0.15]]
grads:  [0.03942633]
Stock Position:  0.03942632948507255
Bond Position:  [-50.66671666]


portfolio before change:  [-46.72345792]
curr_Stock_Price:  100.33718716778523
curr_Factors:  [100.33718717]
mat_Sqrt:  [[0.15]]
grads:  [-0.08557425]
Stock Position:  -0.08557424871439868
Bond Position:  [-38.13717851]


portfolio before change:  [-46.55305262]
curr_Stock_Price:  98.23444257050193
curr_Factors:  [98.23444257]
mat_Sqrt:  [[0.15]]
grads:  [0.06938669]
Stock Position:  0.06938669437120797
Bond Position:  [-53.36921586]


portfolio before change:  [-46.6012511]
curr_Stock_Price:  97.73211988300606
curr_Factors:  [97.73211988]
mat_Sqrt:  [[0.15]]
grads:  [-0.0373406]
Stock Position:  -0.03734059604699975
Bond Position:  [-42.95187549]


portfolio before change:  [-46.61929533]
curr_Stock_Price:  97.92774923349339
curr_Factors:  [97.92774923]
mat_Sqrt:  [[0.15]]
grads:  [0.01462767]
Stock Position:  0.014627672545350334
Bond Position:  [-48.05175038]


portfolio before change:  [-46.63496155]
curr_Stock_Price:  97.67810063594368
curr_Factors:  [97.67810064]
mat_Sqrt:  [[0.15]]
grads:  [0.0373603]
Stock Position:  0.03736029954998379
Bond Position:  [-50.28424465]


portfolio before change:  [-46.68628923]
curr_Stock_Price:  96.64076829660975
curr_Factors:  [96.6407683]
mat_Sqrt:  [[0.15]]
grads:  [-0.00844866]
Stock Position:  -0.008448657591567764
Bond Position:  [-45.86980447]


portfolio before change:  [-46.71344076]
curr_Stock_Price:  98.49699800717792
curr_Factors:  [98.49699801]
mat_Sqrt:  [[0.15]]
grads:  [0.0521783]
Stock Position:  0.05217830422849897
Bond Position:  [-51.85284709]


portfolio before change:  [-46.75010689]
curr_Stock_Price:  98.04276145351078
curr_Factors:  [98.04276145]
mat_Sqrt:  [[0.15]]
grads:  [0.11952945]
Stock Position:  0.11952945238619307
Bond Position:  [-58.46910447]


portfolio before change:  [-46.75351556]
curr_Stock_Price:  98.13654942991454
curr_Factors:  [98.13654943]
mat_Sqrt:  [[0.15]]
grads:  [0.04126002]
Stock Position:  0.04126002364922566
Bond Position:  [-50.80263191]


portfolio before change:  [-46.67001603]
curr_Stock_Price:  100.46814729358677
curr_Factors:  [100.46814729]
mat_Sqrt:  [[0.15]]
grads:  [0.06250033]
Stock Position:  0.06250033140845848
Bond Position:  [-52.94930853]


portfolio before change:  [-46.65565558]
curr_Stock_Price:  100.90973584750216
curr_Factors:  [100.90973585]
mat_Sqrt:  [[0.15]]
grads:  [-0.03610086]
Stock Position:  -0.036100857900938005
Bond Position:  [-43.01272754]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-46.65438992]
Stock Price:  100.57677461528563
PL:  [-47.23116453]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.51012538e-03]
 [-7.23541268e-03]
 [-1.76582315e-02]
 [-1.05324221e-02]
 [-1.24164139e-02]
 [-1.15990144e-02]
 [ 1.39016544e-02]
 [-4.30382663e-02]
 [ 3.07839324e-03]
 [ 6.98196809e-03]
 [-9.61240373e-03]
 [ 1.17069702e-02]
 [ 6.33799488e-03]
 [-1.05068612e-03]
 [ 5.28275016e-03]
 [ 2.20271070e-02]
 [ 8.95876536e-04]
 [ 9.42013808e-03]
 [-5.50531025e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.82263089]
curr_Stock_Price:  99.79945308291475
curr_Factors:  [99.79945308]
mat_Sqrt:  [[0.15]]
grads:  [0.01673417]
Stock Position:  0.01673416921480499
Bond Position:  [-4.49269183]


portfolio before change:  [-2.83161867]
curr_Stock_Price:  99.3294888898209
curr_Factors:  [99.32948889]
mat_Sqrt:  [[0.15]]
grads:  [-0.04823608]
Stock Position:  -0.04823608454743475
Bond Position:  [1.95964696]


portfolio before change:  [-2.92017318]
curr_Stock_Price:  101.17550279461518
curr_Factors:  [101.17550279]
mat_Sqrt:  [[0.15]]
grads:  [-0.11772154]
Stock Position:  -0.11772154318224745
Bond Position:  [8.99036314]


portfolio before change:  [-2.55787407]
curr_Stock_Price:  98.11700370366765
curr_Factors:  [98.1170037]
mat_Sqrt:  [[0.15]]
grads:  [-0.07021615]
Stock Position:  -0.07021614704211959
Bond Position:  [4.33152389]


portfolio before change:  [-2.31081568]
curr_Stock_Price:  94.6138867538722
curr_Factors:  [94.61388675]
mat_Sqrt:  [[0.15]]
grads:  [-0.08277609]
Stock Position:  -0.08277609268291945
Bond Position:  [5.52095218]


portfolio before change:  [-2.40016687]
curr_Stock_Price:  95.70999552688716
curr_Factors:  [95.70999553]
mat_Sqrt:  [[0.15]]
grads:  [-0.07732676]
Stock Position:  -0.07732676256642469
Bond Position:  [5.00077723]


portfolio before change:  [-2.31636928]
curr_Stock_Price:  94.64248361590579
curr_Factors:  [94.64248362]
mat_Sqrt:  [[0.15]]
grads:  [0.0926777]
Stock Position:  0.09267769619175746
Bond Position:  [-11.08761663]


portfolio before change:  [-2.20782551]
curr_Stock_Price:  95.8435926871468
curr_Factors:  [95.84359269]
mat_Sqrt:  [[0.15]]
grads:  [-0.28692178]
Stock Position:  -0.2869217752800578
Bond Position:  [25.29178825]


portfolio before change:  [-2.22302918]
curr_Stock_Price:  95.91862150759346
curr_Factors:  [95.91862151]
mat_Sqrt:  [[0.15]]
grads:  [0.02052262]
Stock Position:  0.020522621568530953
Bond Position:  [-4.19153075]


portfolio before change:  [-2.22965417]
curr_Stock_Price:  95.6468736141408
curr_Factors:  [95.64687361]
mat_Sqrt:  [[0.15]]
grads:  [0.04654645]
Stock Position:  0.04654645392784223
Bond Position:  [-6.68167696]


portfolio before change:  [-2.20832791]
curr_Stock_Price:  96.14093677433719
curr_Factors:  [96.14093677]
mat_Sqrt:  [[0.15]]
grads:  [-0.06408269]
Stock Position:  -0.0640826915144361
Bond Position:  [3.95264208]


portfolio before change:  [-2.19965781]
curr_Stock_Price:  96.02106323260732
curr_Factors:  [96.02106323]
mat_Sqrt:  [[0.15]]
grads:  [0.07804647]
Stock Position:  0.07804646791248106
Bond Position:  [-9.69376264]


portfolio before change:  [-2.20582668]
curr_Stock_Price:  95.97307737378962
curr_Factors:  [95.97307737]
mat_Sqrt:  [[0.15]]
grads:  [0.0422533]
Stock Position:  0.04225329922138875
Bond Position:  [-6.26100583]


portfolio before change:  [-2.13363738]
curr_Stock_Price:  97.71861547660181
curr_Factors:  [97.71861548]
mat_Sqrt:  [[0.15]]
grads:  [-0.00700457]
Stock Position:  -0.007004574141679589
Bond Position:  [-1.44916009]


portfolio before change:  [-2.14709761]
curr_Stock_Price:  99.58852107690093
curr_Factors:  [99.58852108]
mat_Sqrt:  [[0.15]]
grads:  [0.03521833]
Stock Position:  0.03521833442440453
Bond Position:  [-5.65443945]


portfolio before change:  [-2.0829863]
curr_Stock_Price:  101.44906034051455
curr_Factors:  [101.44906034]
mat_Sqrt:  [[0.15]]
grads:  [0.14684738]
Stock Position:  0.14684737985766438
Bond Position:  [-16.980515]


portfolio before change:  [-1.95495383]
curr_Stock_Price:  102.34984675153164
curr_Factors:  [102.34984675]
mat_Sqrt:  [[0.15]]
grads:  [0.00597251]
Stock Position:  0.005972510241709847
Bond Position:  [-2.56623934]


portfolio before change:  [-1.96664573]
curr_Stock_Price:  100.49966151308791
curr_Factors:  [100.49966151]
mat_Sqrt:  [[0.15]]
grads:  [0.06280092]
Stock Position:  0.06280092056583257
Bond Position:  [-8.27811698]


portfolio before change:  [-1.99778891]
curr_Stock_Price:  100.03671613985016
curr_Factors:  [100.03671614]
mat_Sqrt:  [[0.15]]
grads:  [-0.03670207]
Stock Position:  -0.036702068326773626
Bond Position:  [1.67376548]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.96478632]
Stock Price:  99.14891604606674
PL:  [-1.96478632]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.32076123e-02]
 [-6.72733467e-03]
 [-2.43783127e-02]
 [-1.64784926e-02]
 [ 5.71485124e-03]
 [-1.31201671e-02]
 [-3.97573875e-03]
 [-3.07038327e-03]
 [ 5.11526157e-03]
 [-8.86341404e-04]
 [-3.50713315e-03]
 [ 5.23779216e-03]
 [ 1.19068929e-02]
 [-4.71632286e-03]
 [ 2.10870742e-02]
 [ 2.09023384e-02]
 [ 6.94554050e-03]
 [ 1.32097062e-02]
 [-9.77642580e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.34334187]
curr_Stock_Price:  100.6690496911598
curr_Factors:  [100.66904969]
mat_Sqrt:  [[0.15]]
grads:  [-0.08805075]
Stock Position:  -0.08805074893156063
Bond Position:  [25.20732709]


portfolio before change:  [16.47318202]
curr_Stock_Price:  99.26602325602951
curr_Factors:  [99.26602326]
mat_Sqrt:  [[0.15]]
grads:  [-0.0448489]
Stock Position:  -0.04484889782123862
Bond Position:  [20.92515376]


portfolio before change:  [16.37663814]
curr_Stock_Price:  101.53532822229745
curr_Factors:  [101.53532822]
mat_Sqrt:  [[0.15]]
grads:  [-0.16252208]
Stock Position:  -0.16252208488984496
Bond Position:  [32.87837137]


portfolio before change:  [16.63187836]
curr_Stock_Price:  100.01541417312448
curr_Factors:  [100.01541417]
mat_Sqrt:  [[0.15]]
grads:  [-0.10985662]
Stock Position:  -0.10985661702383687
Bond Position:  [27.61923341]


portfolio before change:  [16.46230247]
curr_Stock_Price:  101.62188599096945
curr_Factors:  [101.62188599]
mat_Sqrt:  [[0.15]]
grads:  [0.03809901]
Stock Position:  0.038099008292155546
Bond Position:  [12.59060939]


portfolio before change:  [16.52244838]
curr_Stock_Price:  103.11793199089018
curr_Factors:  [103.11793199]
mat_Sqrt:  [[0.15]]
grads:  [-0.08746778]
Stock Position:  -0.08746778069925024
Bond Position:  [25.54194505]


portfolio before change:  [16.51518424]
curr_Stock_Price:  103.27399439767147
curr_Factors:  [103.2739944]
mat_Sqrt:  [[0.15]]
grads:  [-0.02650492]
Stock Position:  -0.026504924990794366
Bond Position:  [19.25245371]


portfolio before change:  [16.4842305]
curr_Stock_Price:  104.6234586620382
curr_Factors:  [104.62345866]
mat_Sqrt:  [[0.15]]
grads:  [-0.02046922]
Stock Position:  -0.020469221824066474
Bond Position:  [18.62579129]


portfolio before change:  [16.5004975]
curr_Stock_Price:  104.05626737299298
curr_Factors:  [104.05626737]
mat_Sqrt:  [[0.15]]
grads:  [0.03410174]
Stock Position:  0.03410174380125378
Bond Position:  [12.95199733]


portfolio before change:  [16.5382549]
curr_Stock_Price:  105.06850282889756
curr_Factors:  [105.06850283]
mat_Sqrt:  [[0.15]]
grads:  [-0.00590894]
Stock Position:  -0.0059089426919182435
Bond Position:  [17.15909866]


portfolio before change:  [16.54319984]
curr_Stock_Price:  104.95771620437216
curr_Factors:  [104.9577162]
mat_Sqrt:  [[0.15]]
grads:  [-0.02338089]
Stock Position:  -0.023380887657761883
Bond Position:  [18.99720441]


portfolio before change:  [16.56267457]
curr_Stock_Price:  104.32793508431496
curr_Factors:  [104.32793508]
mat_Sqrt:  [[0.15]]
grads:  [0.03491861]
Stock Position:  0.034918614400908494
Bond Position:  [12.91968764]


portfolio before change:  [16.60006239]
curr_Stock_Price:  105.30613811273331
curr_Factors:  [105.30613811]
mat_Sqrt:  [[0.15]]
grads:  [0.07937929]
Stock Position:  0.0793792861084462
Bond Position:  [8.24093633]


portfolio before change:  [16.73580339]
curr_Stock_Price:  106.99021099791467
curr_Factors:  [106.990211]
mat_Sqrt:  [[0.15]]
grads:  [-0.03144215]
Stock Position:  -0.03144215240969249
Bond Position:  [20.09980591]


portfolio before change:  [16.7222913]
curr_Stock_Price:  107.57979102124823
curr_Factors:  [107.57979102]
mat_Sqrt:  [[0.15]]
grads:  [0.14058049]
Stock Position:  0.1405804945215484
Bond Position:  [1.59867108]


portfolio before change:  [16.47660503]
curr_Stock_Price:  105.8292922045972
curr_Factors:  [105.8292922]
mat_Sqrt:  [[0.15]]
grads:  [0.13934892]
Stock Position:  0.13934892290347514
Bond Position:  [1.72940715]


portfolio before change:  [16.44153131]
curr_Stock_Price:  105.57449201680255
curr_Factors:  [105.57449202]
mat_Sqrt:  [[0.15]]
grads:  [0.0463036]
Stock Position:  0.04630360335956388
Bond Position:  [11.5530519]


portfolio before change:  [16.37469147]
curr_Stock_Price:  104.068595015072
curr_Factors:  [104.06859502]
mat_Sqrt:  [[0.15]]
grads:  [0.08806471]
Stock Position:  0.08806470771289747
Bond Position:  [7.20992107]


portfolio before change:  [16.26100179]
curr_Stock_Price:  102.75714584800444
curr_Factors:  [102.75714585]
mat_Sqrt:  [[0.15]]
grads:  [-0.06517617]
Stock Position:  -0.06517617203069932
Bond Position:  [22.95831921]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.14099946]
Stock Price:  104.68641876955279
PL:  [11.4545807]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-6.28862989e-04]
 [ 4.60620619e-03]
 [-4.96310019e-03]
 [-1.57677585e-02]
 [ 5.48348013e-03]
 [-9.84559828e-03]
 [ 1.36193848e-02]
 [ 1.50672079e-02]
 [ 5.06703174e-04]
 [ 7.56091177e-04]
 [-3.31663400e-03]
 [-6.28025466e-03]
 [ 4.88401123e-03]
 [ 7.82088047e-06]
 [ 7.74256174e-03]
 [ 1.67669982e-02]
 [ 5.60127904e-03]
 [ 7.80399096e-03]
 [-5.06847486e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.00288801]
curr_Stock_Price:  100.06376794655678
curr_Factors:  [100.06376795]
mat_Sqrt:  [[0.15]]
grads:  [-0.00419242]
Stock Position:  -0.004192419923714023
Bond Position:  [3.42239734]


portfolio before change:  [3.00071077]
curr_Stock_Price:  100.78720312274575
curr_Factors:  [100.78720312]
mat_Sqrt:  [[0.15]]
grads:  [0.03070804]
Stock Position:  0.030708041264399712
Bond Position:  [-0.09426682]


portfolio before change:  [2.97757963]
curr_Stock_Price:  100.0347107626578
curr_Factors:  [100.03471076]
mat_Sqrt:  [[0.15]]
grads:  [-0.03308733]
Stock Position:  -0.03308733460337394
Bond Position:  [6.28746158]


portfolio before change:  [3.01724101]
curr_Stock_Price:  98.8835356444116
curr_Factors:  [98.88353564]
mat_Sqrt:  [[0.15]]
grads:  [-0.10511839]
Stock Position:  -0.10511839028367115
Bond Position:  [13.4117191]


portfolio before change:  [2.97799818]
curr_Stock_Price:  99.28875669936525
curr_Factors:  [99.2887567]
mat_Sqrt:  [[0.15]]
grads:  [0.03655653]
Stock Position:  0.03655653418532618
Bond Position:  [-0.65165465]


portfolio before change:  [3.01268293]
curr_Stock_Price:  100.24201134086113
curr_Factors:  [100.24201134]
mat_Sqrt:  [[0.15]]
grads:  [-0.06563732]
Stock Position:  -0.0656373218408601
Bond Position:  [9.59230009]


portfolio before change:  [3.02834708]
curr_Stock_Price:  100.03990406357742
curr_Factors:  [100.03990406]
mat_Sqrt:  [[0.15]]
grads:  [0.0907959]
Stock Position:  0.09079589840397129
Bond Position:  [-6.05486588]


portfolio before change:  [3.10217764]
curr_Stock_Price:  100.86972642549044
curr_Factors:  [100.86972643]
mat_Sqrt:  [[0.15]]
grads:  [0.10044805]
Stock Position:  0.10044805260327366
Bond Position:  [-7.02998994]


portfolio before change:  [3.37795044]
curr_Stock_Price:  103.63265220307896
curr_Factors:  [103.6326522]
mat_Sqrt:  [[0.15]]
grads:  [0.00337802]
Stock Position:  0.0033780211611530884
Bond Position:  [3.02787715]


portfolio before change:  [3.37958775]
curr_Stock_Price:  103.89323313897351
curr_Factors:  [103.89323314]
mat_Sqrt:  [[0.15]]
grads:  [0.00504061]
Stock Position:  0.005040607847003916
Bond Position:  [2.85590271]


portfolio before change:  [3.37981691]
curr_Stock_Price:  103.79703295052576
curr_Factors:  [103.79703295]
mat_Sqrt:  [[0.15]]
grads:  [-0.02211089]
Stock Position:  -0.022110893339523575
Bond Position:  [5.67486204]


portfolio before change:  [3.41289128]
curr_Stock_Price:  102.36536419889376
curr_Factors:  [102.3653642]
mat_Sqrt:  [[0.15]]
grads:  [-0.04186836]
Stock Position:  -0.04186836437687588
Bond Position:  [7.69876165]


portfolio before change:  [3.49680818]
curr_Stock_Price:  100.40703668600446
curr_Factors:  [100.40703669]
mat_Sqrt:  [[0.15]]
grads:  [0.03256007]
Stock Position:  0.032560074859683215
Bond Position:  [0.22754755]


portfolio before change:  [3.52033941]
curr_Stock_Price:  101.12799141394268
curr_Factors:  [101.12799141]
mat_Sqrt:  [[0.15]]
grads:  [5.21392031e-05]
Stock Position:  5.2139203114581235e-05
Bond Position:  [3.51506668]


portfolio before change:  [3.52109203]
curr_Stock_Price:  98.70631124881764
curr_Factors:  [98.70631125]
mat_Sqrt:  [[0.15]]
grads:  [0.05161708]
Stock Position:  0.051617078282055466
Bond Position:  [-1.57383937]


portfolio before change:  [3.55136292]
curr_Stock_Price:  99.30038601897047
curr_Factors:  [99.30038602]
mat_Sqrt:  [[0.15]]
grads:  [0.11177999]
Stock Position:  0.11177998771313986
Bond Position:  [-7.54843301]


portfolio before change:  [3.48998758]
curr_Stock_Price:  98.76819774788623
curr_Factors:  [98.76819775]
mat_Sqrt:  [[0.15]]
grads:  [0.03734186]
Stock Position:  0.03734186027484209
Bond Position:  [-0.19820066]


portfolio before change:  [3.51779418]
curr_Stock_Price:  99.51417434836917
curr_Factors:  [99.51417435]
mat_Sqrt:  [[0.15]]
grads:  [0.05202661]
Stock Position:  0.052026606415288175
Bond Position:  [-1.65959061]


portfolio before change:  [3.52332978]
curr_Stock_Price:  99.6285495224505
curr_Factors:  [99.62854952]
mat_Sqrt:  [[0.15]]
grads:  [-0.03378983]
Stock Position:  -0.033789832414127176
Bond Position:  [6.88976177]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.48866079]
Stock Price:  100.70554930112293
PL:  [2.78311149]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 1.63200427e-03]
 [-7.89529540e-04]
 [-1.23518433e-02]
 [-5.62991661e-03]
 [ 4.50984931e-03]
 [-1.07319619e-02]
 [ 1.27102890e-02]
 [-4.08177969e-02]
 [ 6.60387393e-04]
 [ 9.74908481e-03]
 [-8.00064881e-03]
 [ 6.94384694e-03]
 [ 6.33506407e-03]
 [-1.01080012e-03]
 [ 8.00361520e-03]
 [ 2.09671842e-02]
 [ 7.46207857e-03]
 [ 4.96392382e-04]
 [-9.03131670e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.07377958]
curr_Stock_Price:  99.06210758258067
curr_Factors:  [99.06210758]
mat_Sqrt:  [[0.15]]
grads:  [0.01088003]
Stock Position:  0.010880028442812259
Bond Position:  [-20.15157813]


portfolio before change:  [-19.08795584]
curr_Stock_Price:  98.22224447169552
curr_Factors:  [98.22224447]
mat_Sqrt:  [[0.15]]
grads:  [-0.00526353]
Stock Position:  -0.005263530267532517
Bond Position:  [-18.57096008]


portfolio before change:  [-19.087125]
curr_Stock_Price:  97.18222687185522
curr_Factors:  [97.18222687]
mat_Sqrt:  [[0.15]]
grads:  [-0.08234562]
Stock Position:  -0.08234562191888907
Bond Position:  [-11.08459409]


portfolio before change:  [-19.1417788]
curr_Stock_Price:  97.81228227007092
curr_Factors:  [97.81228227]
mat_Sqrt:  [[0.15]]
grads:  [-0.03753278]
Stock Position:  -0.03753277736855842
Bond Position:  [-15.47061218]


portfolio before change:  [-19.19326465]
curr_Stock_Price:  99.08097925283201
curr_Factors:  [99.08097925]
mat_Sqrt:  [[0.15]]
grads:  [0.03006566]
Stock Position:  0.030065662041096695
Bond Position:  [-22.17219989]


portfolio before change:  [-19.21977651]
curr_Stock_Price:  98.38356855334783
curr_Factors:  [98.38356855]
mat_Sqrt:  [[0.15]]
grads:  [-0.07154641]
Stock Position:  -0.07154641279031222
Bond Position:  [-12.1807851]


portfolio before change:  [-19.14899884]
curr_Stock_Price:  97.35174537590125
curr_Factors:  [97.35174538]
mat_Sqrt:  [[0.15]]
grads:  [0.08473526]
Stock Position:  0.08473525988240949
Bond Position:  [-27.39812429]


portfolio before change:  [-19.22870964]
curr_Stock_Price:  96.49188598711645
curr_Factors:  [96.49188599]
mat_Sqrt:  [[0.15]]
grads:  [-0.27211865]
Stock Position:  -0.272118646245764
Bond Position:  [7.02853175]


portfolio before change:  [-19.42279857]
curr_Stock_Price:  97.21159513904216
curr_Factors:  [97.21159514]
mat_Sqrt:  [[0.15]]
grads:  [0.00440258]
Stock Position:  0.004402582620908289
Bond Position:  [-19.85078064]


portfolio before change:  [-19.42694851]
curr_Stock_Price:  97.39634328686863
curr_Factors:  [97.39634329]
mat_Sqrt:  [[0.15]]
grads:  [0.0649939]
Stock Position:  0.06499389874733859
Bond Position:  [-25.75711659]


portfolio before change:  [-19.47436468]
curr_Stock_Price:  96.76588287828395
curr_Factors:  [96.76588288]
mat_Sqrt:  [[0.15]]
grads:  [-0.05333766]
Stock Position:  -0.053337658760475824
Bond Position:  [-14.31309904]


portfolio before change:  [-19.48570526]
curr_Stock_Price:  96.91140600715491
curr_Factors:  [96.91140601]
mat_Sqrt:  [[0.15]]
grads:  [0.04629231]
Stock Position:  0.04629231292067088
Bond Position:  [-23.97195839]


portfolio before change:  [-19.53486947]
curr_Stock_Price:  95.97884354548154
curr_Factors:  [95.97884355]
mat_Sqrt:  [[0.15]]
grads:  [0.04223376]
Stock Position:  0.04223376048276472
Bond Position:  [-23.58841696]


portfolio before change:  [-19.45663431]
curr_Stock_Price:  97.9709229379649
curr_Factors:  [97.97092294]
mat_Sqrt:  [[0.15]]
grads:  [-0.00673867]
Stock Position:  -0.006738667489924867
Bond Position:  [-18.79644084]


portfolio before change:  [-19.46107407]
curr_Stock_Price:  97.93234857036128
curr_Factors:  [97.93234857]
mat_Sqrt:  [[0.15]]
grads:  [0.05335743]
Stock Position:  0.05335743468297611
Bond Position:  [-24.68649296]


portfolio before change:  [-19.56298187]
curr_Stock_Price:  96.13812053871806
curr_Factors:  [96.13812054]
mat_Sqrt:  [[0.15]]
grads:  [0.13978123]
Stock Position:  0.1397812281772673
Bond Position:  [-33.00128643]


portfolio before change:  [-19.53803025]
curr_Stock_Price:  96.37565582475392
curr_Factors:  [96.37565582]
mat_Sqrt:  [[0.15]]
grads:  [0.04974719]
Stock Position:  0.049747190469367035
Bond Position:  [-24.33244835]


portfolio before change:  [-19.58966047]
curr_Stock_Price:  95.46009959131953
curr_Factors:  [95.46009959]
mat_Sqrt:  [[0.15]]
grads:  [0.00330928]
Stock Position:  0.0033092825495273834
Bond Position:  [-19.90556491]


portfolio before change:  [-19.59529782]
curr_Stock_Price:  95.26055820973211
curr_Factors:  [95.26055821]
mat_Sqrt:  [[0.15]]
grads:  [-0.06020878]
Stock Position:  -0.06020877799143665
Bond Position:  [-13.85977602]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.65173972]
Stock Price:  96.14043860328256
PL:  [-19.65173972]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.82616896e-02]
 [ 2.98507169e-02]
 [-5.76452200e-02]
 [ 9.19248048e-02]
 [ 4.96542531e-03]
 [-1.03268844e-02]
 [-4.61203832e-03]
 [ 9.64455443e-03]
 [-1.71128837e-02]
 [ 2.35670399e-03]
 [-3.04947574e-03]
 [-6.13757763e-03]
 [ 8.63808292e-03]
 [-4.93095039e-05]
 [ 1.42696454e-03]
 [ 2.29773453e-02]
 [ 3.27078534e-03]
 [ 1.32356966e-02]
 [-1.45661143e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [28.64351649]
curr_Stock_Price:  101.22713198920064
curr_Factors:  [101.22713199]
mat_Sqrt:  [[0.15]]
grads:  [-0.1217446]
Stock Position:  -0.12174459718621342
Bond Position:  [40.9673729]


portfolio before change:  [28.57146732]
curr_Stock_Price:  101.90307399839881
curr_Factors:  [101.903074]
mat_Sqrt:  [[0.15]]
grads:  [0.19900478]
Stock Position:  0.19900477923889426
Bond Position:  [8.29226858]


portfolio before change:  [28.93666424]
curr_Stock_Price:  103.72777182427843
curr_Factors:  [103.72777182]
mat_Sqrt:  [[0.15]]
grads:  [-0.38430147]
Stock Position:  -0.38430146697763584
Bond Position:  [68.79939912]


portfolio before change:  [28.36323335]
curr_Stock_Price:  105.2646717438211
curr_Factors:  [105.26467174]
mat_Sqrt:  [[0.15]]
grads:  [0.61283203]
Stock Position:  0.6128320321477159
Bond Position:  [-36.14632935]


portfolio before change:  [27.70122378]
curr_Stock_Price:  104.19917285515533
curr_Factors:  [104.19917286]
mat_Sqrt:  [[0.15]]
grads:  [0.03310284]
Stock Position:  0.033102835387719194
Bond Position:  [24.25193572]


portfolio before change:  [27.63415972]
curr_Stock_Price:  101.99006280705514
curr_Factors:  [101.99006281]
mat_Sqrt:  [[0.15]]
grads:  [-0.0688459]
Stock Position:  -0.06884589621211765
Bond Position:  [34.655757]


portfolio before change:  [27.54200425]
curr_Stock_Price:  103.45449999380986
curr_Factors:  [103.45449999]
mat_Sqrt:  [[0.15]]
grads:  [-0.03074692]
Stock Position:  -0.03074692212632607
Bond Position:  [30.72291171]


portfolio before change:  [27.5974133]
curr_Stock_Price:  101.90223534409901
curr_Factors:  [101.90223534]
mat_Sqrt:  [[0.15]]
grads:  [0.06429703]
Stock Position:  0.0642970295589895
Bond Position:  [21.04540226]


portfolio before change:  [27.54631174]
curr_Stock_Price:  101.02562310046083
curr_Factors:  [101.0256231]
mat_Sqrt:  [[0.15]]
grads:  [-0.11408589]
Stock Position:  -0.11408589134355342
Bond Position:  [39.07191]


portfolio before change:  [27.50623865]
curr_Stock_Price:  101.4625070004931
curr_Factors:  [101.462507]
mat_Sqrt:  [[0.15]]
grads:  [0.01571136]
Stock Position:  0.01571135995812135
Bond Position:  [25.91212468]


portfolio before change:  [27.51755777]
curr_Stock_Price:  101.77058196242064
curr_Factors:  [101.77058196]
mat_Sqrt:  [[0.15]]
grads:  [-0.02032984]
Stock Position:  -0.02032983824465471
Bond Position:  [29.58653724]


portfolio before change:  [27.53942447]
curr_Stock_Price:  101.0588625974977
curr_Factors:  [101.0588626]
mat_Sqrt:  [[0.15]]
grads:  [-0.04091718]
Stock Position:  -0.04091718422869313
Bond Position:  [31.67446857]


portfolio before change:  [27.46699003]
curr_Stock_Price:  103.02268419576842
curr_Factors:  [103.0226842]
mat_Sqrt:  [[0.15]]
grads:  [0.05758722]
Stock Position:  0.057587219471172194
Bond Position:  [21.5342001]


portfolio before change:  [27.48244932]
curr_Stock_Price:  103.19763750484441
curr_Factors:  [103.1976375]
mat_Sqrt:  [[0.15]]
grads:  [-0.00032873]
Stock Position:  -0.00032873002569005155
Bond Position:  [27.51637349]


portfolio before change:  [27.48932816]
curr_Stock_Price:  103.20104898413169
curr_Factors:  [103.20104898]
mat_Sqrt:  [[0.15]]
grads:  [0.0095131]
Stock Position:  0.009513096957038746
Bond Position:  [26.50756657]


portfolio before change:  [27.49553821]
curr_Stock_Price:  103.1571448728291
curr_Factors:  [103.15714487]
mat_Sqrt:  [[0.15]]
grads:  [0.1531823]
Stock Position:  0.15318230202379093
Bond Position:  [11.69368929]


portfolio before change:  [27.59408304]
curr_Stock_Price:  103.78137519782611
curr_Factors:  [103.7813752]
mat_Sqrt:  [[0.15]]
grads:  [0.02180524]
Stock Position:  0.021805235629757266
Bond Position:  [25.3311057]


portfolio before change:  [27.60759477]
curr_Stock_Price:  104.11056976624354
curr_Factors:  [104.11056977]
mat_Sqrt:  [[0.15]]
grads:  [0.08823798]
Stock Position:  0.08823797712813361
Bond Position:  [18.4210887]


portfolio before change:  [27.63906071]
curr_Stock_Price:  104.41497484920416
curr_Factors:  [104.41497485]
mat_Sqrt:  [[0.15]]
grads:  [-0.09710743]
Stock Position:  -0.09710742874583529
Bond Position:  [37.77853044]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [27.73849234]
Stock Price:  103.48831226242979
PL:  [24.25018008]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-6.86946875e-05]
 [-1.04951963e-02]
 [-4.62456443e-03]
 [-1.59125949e-02]
 [ 3.00535604e-03]
 [-1.04383562e-02]
 [ 1.38258736e-02]
 [-2.98051538e-02]
 [-1.72476798e-03]
 [ 9.61893262e-03]
 [-2.97881880e-03]
 [-5.85593063e-03]
 [ 4.77987947e-03]
 [-4.28092964e-04]
 [ 3.88300000e-03]
 [ 1.97760416e-02]
 [ 2.72473833e-03]
 [ 1.18877018e-02]
 [-6.99551619e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.16909612]
curr_Stock_Price:  100.02593722391515
curr_Factors:  [100.02593722]
mat_Sqrt:  [[0.15]]
grads:  [-0.00045796]
Stock Position:  -0.00045796458314907584
Bond Position:  [2.21490445]


portfolio before change:  [2.16978667]
curr_Stock_Price:  99.72732560375404
curr_Factors:  [99.7273256]
mat_Sqrt:  [[0.15]]
grads:  [-0.06996798]
Stock Position:  -0.06996797551944314
Bond Position:  [9.14750574]


portfolio before change:  [2.16547464]
curr_Stock_Price:  99.82164287324856
curr_Factors:  [99.82164287]
mat_Sqrt:  [[0.15]]
grads:  [-0.03083043]
Stock Position:  -0.03083042951136123
Bond Position:  [5.24301876]


portfolio before change:  [2.19528442]
curr_Stock_Price:  98.89726853897743
curr_Factors:  [98.89726854]
mat_Sqrt:  [[0.15]]
grads:  [-0.10608397]
Stock Position:  -0.10608396629217069
Bond Position:  [12.68669892]


portfolio before change:  [2.21214535]
curr_Stock_Price:  98.76823052493823
curr_Factors:  [98.76823052]
mat_Sqrt:  [[0.15]]
grads:  [0.02003571]
Stock Position:  0.020035706929445694
Bond Position:  [0.23325403]


portfolio before change:  [2.22075571]
curr_Stock_Price:  99.19507019635621
curr_Factors:  [99.1950702]
mat_Sqrt:  [[0.15]]
grads:  [-0.06958904]
Stock Position:  -0.06958904158108938
Bond Position:  [9.12364557]


portfolio before change:  [2.24199362]
curr_Stock_Price:  98.9226607087136
curr_Factors:  [98.92266071]
mat_Sqrt:  [[0.15]]
grads:  [0.09217249]
Stock Position:  0.09217249059537887
Bond Position:  [-6.87595439]


portfolio before change:  [2.21399411]
curr_Stock_Price:  98.63753975580029
curr_Factors:  [98.63753976]
mat_Sqrt:  [[0.15]]
grads:  [-0.19870103]
Stock Position:  -0.19870102504212214
Bond Position:  [21.81337436]


portfolio before change:  [2.1501542]
curr_Stock_Price:  98.98627440988612
curr_Factors:  [98.98627441]
mat_Sqrt:  [[0.15]]
grads:  [-0.01149845]
Stock Position:  -0.011498453167751934
Bond Position:  [3.28834324]


portfolio before change:  [2.15063758]
curr_Stock_Price:  99.01574009685095
curr_Factors:  [99.0157401]
mat_Sqrt:  [[0.15]]
grads:  [0.06412622]
Stock Position:  0.06412621745154046
Bond Position:  [-4.1988673]


portfolio before change:  [2.20591579]
curr_Stock_Price:  99.89413372186227
curr_Factors:  [99.89413372]
mat_Sqrt:  [[0.15]]
grads:  [-0.01985879]
Stock Position:  -0.019858792005782222
Bond Position:  [4.18969261]


portfolio before change:  [2.18672784]
curr_Stock_Price:  100.91310354092309
curr_Factors:  [100.91310354]
mat_Sqrt:  [[0.15]]
grads:  [-0.03903954]
Stock Position:  -0.03903953752739467
Bond Position:  [6.12632873]


portfolio before change:  [2.22220741]
curr_Stock_Price:  100.04352870873123
curr_Factors:  [100.04352871]
mat_Sqrt:  [[0.15]]
grads:  [0.03186586]
Stock Position:  0.0318658631487911
Bond Position:  [-0.96576599]


portfolio before change:  [2.22701099]
curr_Stock_Price:  100.20185039238405
curr_Factors:  [100.20185039]
mat_Sqrt:  [[0.15]]
grads:  [-0.00285395]
Stock Position:  -0.0028539530901353733
Bond Position:  [2.51298237]


portfolio before change:  [2.2280104]
curr_Stock_Price:  100.07182664643878
curr_Factors:  [100.07182665]
mat_Sqrt:  [[0.15]]
grads:  [0.02588667]
Stock Position:  0.025886666698494622
Bond Position:  [-0.36251562]


portfolio before change:  [2.24133163]
curr_Stock_Price:  100.58992615864148
curr_Factors:  [100.58992616]
mat_Sqrt:  [[0.15]]
grads:  [0.13184028]
Stock Position:  0.1318402776259492
Bond Position:  [-11.02047216]


portfolio before change:  [2.29268828]
curr_Stock_Price:  101.00036306706038
curr_Factors:  [101.00036307]
mat_Sqrt:  [[0.15]]
grads:  [0.01816492]
Stock Position:  0.01816492220370152
Bond Position:  [0.45802454]


portfolio before change:  [2.31502177]
curr_Stock_Price:  102.22354269804117
curr_Factors:  [102.2235427]
mat_Sqrt:  [[0.15]]
grads:  [0.07925135]
Stock Position:  0.07925134549123447
Bond Position:  [-5.78633153]


portfolio before change:  [2.28778791]
curr_Stock_Price:  101.89815900496617
curr_Factors:  [101.898159]
mat_Sqrt:  [[0.15]]
grads:  [-0.04663677]
Stock Position:  -0.04663677459413454
Bond Position:  [7.03998938]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.26804268]
Stock Price:  102.35928521819486
PL:  [-0.09124253]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.48367827e-03]
 [-7.53727908e-03]
 [-4.22178516e-03]
 [ 7.19667693e-05]
 [ 5.72651794e-03]
 [-9.36162859e-03]
 [-1.49311159e-03]
 [ 2.90103016e-03]
 [-9.41492954e-03]
 [ 2.35185764e-03]
 [-3.01070876e-03]
 [-6.58764329e-03]
 [ 8.15726389e-03]
 [ 2.57242461e-04]
 [ 2.24649366e-04]
 [ 2.28120918e-02]
 [ 9.86292374e-04]
 [ 1.24804249e-02]
 [-6.40649901e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.27525213]
curr_Stock_Price:  100.12149752472122
curr_Factors:  [100.12149752]
mat_Sqrt:  [[0.15]]
grads:  [-0.00989119]
Stock Position:  -0.009891188449154993
Bond Position:  [5.26557273]


portfolio before change:  [4.28402962]
curr_Stock_Price:  99.36719597801294
curr_Factors:  [99.36719598]
mat_Sqrt:  [[0.15]]
grads:  [-0.05024853]
Stock Position:  -0.050248527203053776
Bond Position:  [9.27708487]


portfolio before change:  [4.27459702]
curr_Stock_Price:  99.60107678851422
curr_Factors:  [99.60107679]
mat_Sqrt:  [[0.15]]
grads:  [-0.02814523]
Stock Position:  -0.028145234427925884
Bond Position:  [7.07789267]


portfolio before change:  [4.24429047]
curr_Stock_Price:  100.74074543257386
curr_Factors:  [100.74074543]
mat_Sqrt:  [[0.15]]
grads:  [0.00047978]
Stock Position:  0.000479778462178157
Bond Position:  [4.19595723]


portfolio before change:  [4.24555526]
curr_Stock_Price:  101.1902626198211
curr_Factors:  [101.19026262]
mat_Sqrt:  [[0.15]]
grads:  [0.03817679]
Stock Position:  0.03817678627125131
Bond Position:  [0.38243623]


portfolio before change:  [4.24566432]
curr_Stock_Price:  101.19061466164177
curr_Factors:  [101.19061466]
mat_Sqrt:  [[0.15]]
grads:  [-0.06241086]
Stock Position:  -0.06241085728086258
Bond Position:  [10.56105733]


portfolio before change:  [4.16690779]
curr_Stock_Price:  102.49482886551043
curr_Factors:  [102.49482887]
mat_Sqrt:  [[0.15]]
grads:  [-0.00995408]
Stock Position:  -0.009954077246840764
Bond Position:  [5.18714923]


portfolio before change:  [4.15886084]
curr_Stock_Price:  103.43352984129224
curr_Factors:  [103.43352984]
mat_Sqrt:  [[0.15]]
grads:  [0.0193402]
Stock Position:  0.019340201088210836
Bond Position:  [2.15843557]


portfolio before change:  [4.14561353]
curr_Stock_Price:  102.72066329726431
curr_Factors:  [102.7206633]
mat_Sqrt:  [[0.15]]
grads:  [-0.0627662]
Stock Position:  -0.06276619694790142
Bond Position:  [10.59299891]


portfolio before change:  [4.254002]
curr_Stock_Price:  101.03600036692465
curr_Factors:  [101.03600037]
mat_Sqrt:  [[0.15]]
grads:  [0.01567905]
Stock Position:  0.015679050948625893
Bond Position:  [2.6698534]


portfolio before change:  [4.25503602]
curr_Stock_Price:  101.05937372946995
curr_Factors:  [101.05937373]
mat_Sqrt:  [[0.15]]
grads:  [-0.02007139]
Stock Position:  -0.020071391731916965
Bond Position:  [6.28343829]


portfolio before change:  [4.24503041]
curr_Stock_Price:  101.63614798506208
curr_Factors:  [101.63614799]
mat_Sqrt:  [[0.15]]
grads:  [-0.04391762]
Stock Position:  -0.04391762194412743
Bond Position:  [8.70864833]


portfolio before change:  [4.20026147]
curr_Stock_Price:  102.70511228503545
curr_Factors:  [102.70511229]
mat_Sqrt:  [[0.15]]
grads:  [0.05438176]
Stock Position:  0.054381759293553183
Bond Position:  [-1.38502322]


portfolio before change:  [4.1549339]
curr_Stock_Price:  101.87797318879325
curr_Factors:  [101.87797319]
mat_Sqrt:  [[0.15]]
grads:  [0.00171495]
Stock Position:  0.0017149497421034873
Bond Position:  [3.98021829]


portfolio before change:  [4.15607373]
curr_Stock_Price:  101.96232179203494
curr_Factors:  [101.96232179]
mat_Sqrt:  [[0.15]]
grads:  [0.00149766]
Stock Position:  0.0014976624410418331
Bond Position:  [4.00336859]


portfolio before change:  [4.15762512]
curr_Stock_Price:  102.32984578169156
curr_Factors:  [102.32984578]
mat_Sqrt:  [[0.15]]
grads:  [0.15208061]
Stock Position:  0.15208061190805158
Bond Position:  [-11.40476044]


portfolio before change:  [4.18699209]
curr_Stock_Price:  102.54169732733322
curr_Factors:  [102.54169733]
mat_Sqrt:  [[0.15]]
grads:  [0.00657528]
Stock Position:  0.006575282494956261
Bond Position:  [3.51275146]


portfolio before change:  [4.18995687]
curr_Stock_Price:  102.85901995084096
curr_Factors:  [102.85901995]
mat_Sqrt:  [[0.15]]
grads:  [0.08320283]
Stock Position:  0.08320283294281267
Bond Position:  [-4.36820498]


portfolio before change:  [4.09184473]
curr_Stock_Price:  101.69295439363201
curr_Factors:  [101.69295439]
mat_Sqrt:  [[0.15]]
grads:  [-0.04270999]
Stock Position:  -0.04270999341251476
Bond Position:  [8.43515014]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.01035801]
Stock Price:  103.6502426692506
PL:  [0.36011534]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.08626208e-02]
 [ 3.65416741e-02]
 [-1.88768707e-02]
 [-1.97626854e-02]
 [-7.56808996e-04]
 [-1.15369975e-02]
 [ 1.27341707e-02]
 [-5.06714573e-02]
 [ 5.06844928e-03]
 [ 5.61515329e-03]
 [-1.72813912e-02]
 [ 2.81175112e-02]
 [ 8.92439165e-03]
 [-2.67508555e-03]
 [ 4.91351599e-03]
 [ 2.44005596e-02]
 [ 2.27313370e-02]
 [-2.87400669e-03]
 [-1.36330298e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [39.57815193]
curr_Stock_Price:  101.7232571797239
curr_Factors:  [101.72325718]
mat_Sqrt:  [[0.15]]
grads:  [-0.13908414]
Stock Position:  -0.1390841389340075
Bond Position:  [53.72624356]


portfolio before change:  [39.52814867]
curr_Stock_Price:  102.17935879093474
curr_Factors:  [102.17935879]
mat_Sqrt:  [[0.15]]
grads:  [0.24361116]
Stock Position:  0.24361116066050278
Bond Position:  [14.63611648]


portfolio before change:  [39.30169983]
curr_Stock_Price:  101.23478660449872
curr_Factors:  [101.2347866]
mat_Sqrt:  [[0.15]]
grads:  [-0.1258458]
Stock Position:  -0.12584580483645566
Bond Position:  [52.04167303]


portfolio before change:  [39.56293839]
curr_Stock_Price:  99.26232100869132
curr_Factors:  [99.26232101]
mat_Sqrt:  [[0.15]]
grads:  [-0.13175124]
Stock Position:  -0.13175123584768214
Bond Position:  [52.64087186]


portfolio before change:  [39.74958117]
curr_Stock_Price:  97.94559016155715
curr_Factors:  [97.94559016]
mat_Sqrt:  [[0.15]]
grads:  [-0.00504539]
Stock Position:  -0.00504539330522422
Bond Position:  [40.2437552]


portfolio before change:  [39.77003297]
curr_Stock_Price:  95.8863651616639
curr_Factors:  [95.88636516]
mat_Sqrt:  [[0.15]]
grads:  [-0.07691332]
Stock Position:  -0.07691331647882958
Bond Position:  [47.14497132]


portfolio before change:  [39.73029668]
curr_Stock_Price:  96.55626218546051
curr_Factors:  [96.55626219]
mat_Sqrt:  [[0.15]]
grads:  [0.08489447]
Stock Position:  0.08489447129005073
Bond Position:  [31.53320386]


portfolio before change:  [39.61132436]
curr_Stock_Price:  95.0619762401136
curr_Factors:  [95.06197624]
mat_Sqrt:  [[0.15]]
grads:  [-0.33780972]
Stock Position:  -0.33780971552059474
Bond Position:  [71.72418351]


portfolio before change:  [39.73099123]
curr_Stock_Price:  94.7608197489774
curr_Factors:  [94.76081975]
mat_Sqrt:  [[0.15]]
grads:  [0.03378966]
Stock Position:  0.033789661843802526
Bond Position:  [36.52905518]


portfolio before change:  [39.7408648]
curr_Stock_Price:  94.78272465454953
curr_Factors:  [94.78272465]
mat_Sqrt:  [[0.15]]
grads:  [0.03743436]
Stock Position:  0.0374343552750949
Bond Position:  [36.19273461]


portfolio before change:  [39.68944335]
curr_Stock_Price:  93.16734331993534
curr_Factors:  [93.16734332]
mat_Sqrt:  [[0.15]]
grads:  [-0.11520927]
Stock Position:  -0.11520927485134252
Bond Position:  [50.42318542]


portfolio before change:  [39.74767874]
curr_Stock_Price:  92.77129867970918
curr_Factors:  [92.77129868]
mat_Sqrt:  [[0.15]]
grads:  [0.18745007]
Stock Position:  0.18745007455517687
Bond Position:  [22.35769189]


portfolio before change:  [39.58808851]
curr_Stock_Price:  91.89010217352316
curr_Factors:  [91.89010217]
mat_Sqrt:  [[0.15]]
grads:  [0.05949594]
Stock Position:  0.059495944304472546
Bond Position:  [34.12100011]


portfolio before change:  [39.51402622]
curr_Stock_Price:  90.50187961457198
curr_Factors:  [90.50187961]
mat_Sqrt:  [[0.15]]
grads:  [-0.0178339]
Stock Position:  -0.017833903683126952
Bond Position:  [41.12802802]


portfolio before change:  [39.5458341]
curr_Stock_Price:  89.29493159232061
curr_Factors:  [89.29493159]
mat_Sqrt:  [[0.15]]
grads:  [0.03275677]
Stock Position:  0.032756773245268926
Bond Position:  [36.62082028]


portfolio before change:  [39.56247971]
curr_Stock_Price:  89.52356386440762
curr_Factors:  [89.52356386]
mat_Sqrt:  [[0.15]]
grads:  [0.1626704]
Stock Position:  0.16267039754144139
Bond Position:  [24.99964598]


portfolio before change:  [39.3580011]
curr_Stock_Price:  88.22812655110762
curr_Factors:  [88.22812655]
mat_Sqrt:  [[0.15]]
grads:  [0.15154225]
Stock Position:  0.15154224668904176
Bond Position:  [25.98771258]


portfolio before change:  [39.31281644]
curr_Stock_Price:  87.88708370164261
curr_Factors:  [87.8870837]
mat_Sqrt:  [[0.15]]
grads:  [-0.01916004]
Stock Position:  -0.0191600446217141
Bond Position:  [40.99673688]


portfolio before change:  [39.34267402]
curr_Stock_Price:  86.86374997191585
curr_Factors:  [86.86374997]
mat_Sqrt:  [[0.15]]
grads:  [-0.09088687]
Stock Position:  -0.09088686546226604
Bond Position:  [47.23744798]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [39.29429921]
Stock Price:  87.525954080191
PL:  [39.29429921]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-9.16684409e-03]
 [-9.76227979e-03]
 [-4.47961043e-03]
 [-1.73513441e-03]
 [ 5.71526551e-03]
 [-1.02064424e-02]
 [ 4.09003418e-03]
 [ 1.00318990e-02]
 [-1.42317751e-02]
 [ 2.53155306e-03]
 [-3.40888988e-03]
 [-3.79045367e-03]
 [ 1.19132803e-02]
 [-2.79429065e-03]
 [ 1.63882665e-02]
 [ 2.07950378e-02]
 [ 9.40060238e-03]
 [ 1.47731093e-02]
 [-1.63194828e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.16510085]
curr_Stock_Price:  100.47947495560938
curr_Factors:  [100.47947496]
mat_Sqrt:  [[0.15]]
grads:  [-0.06111229]
Stock Position:  -0.0611122939470406
Bond Position:  [18.30563206]


portfolio before change:  [12.18530401]
curr_Stock_Price:  100.22377889013708
curr_Factors:  [100.22377889]
mat_Sqrt:  [[0.15]]
grads:  [-0.06508187]
Stock Position:  -0.06508186528915381
Bond Position:  [18.70805448]


portfolio before change:  [12.22131946]
curr_Stock_Price:  99.74226456860994
curr_Factors:  [99.74226457]
mat_Sqrt:  [[0.15]]
grads:  [-0.02986407]
Stock Position:  -0.02986406954897735
Bond Position:  [15.20002938]


portfolio before change:  [12.1969795]
curr_Stock_Price:  100.68454854839237
curr_Factors:  [100.68454855]
mat_Sqrt:  [[0.15]]
grads:  [-0.01156756]
Stock Position:  -0.011567562708976464
Bond Position:  [13.36165433]


portfolio before change:  [12.19050212]
curr_Stock_Price:  101.53331984360499
curr_Factors:  [101.53331984]
mat_Sqrt:  [[0.15]]
grads:  [0.03810177]
Stock Position:  0.03810177009013862
Bond Position:  [8.32190291]


portfolio before change:  [12.20807261]
curr_Stock_Price:  101.93985626367692
curr_Factors:  [101.93985626]
mat_Sqrt:  [[0.15]]
grads:  [-0.06804295]
Stock Position:  -0.06804294928158935
Bond Position:  [19.14436108]


portfolio before change:  [12.24912673]
curr_Stock_Price:  101.40684844148097
curr_Factors:  [101.40684844]
mat_Sqrt:  [[0.15]]
grads:  [0.02726689]
Stock Position:  0.027266894562760383
Bond Position:  [9.48407688]


portfolio before change:  [12.2626074]
curr_Stock_Price:  101.81427857667853
curr_Factors:  [101.81427858]
mat_Sqrt:  [[0.15]]
grads:  [0.06687933]
Stock Position:  0.06687932663705995
Bond Position:  [5.453337]


portfolio before change:  [12.2943051]
curr_Stock_Price:  102.26784470060028
curr_Factors:  [102.2678447]
mat_Sqrt:  [[0.15]]
grads:  [-0.0948785]
Stock Position:  -0.09487850068992339
Bond Position:  [21.99732487]


portfolio before change:  [12.27162614]
curr_Stock_Price:  102.56484530288765
curr_Factors:  [102.5648453]
mat_Sqrt:  [[0.15]]
grads:  [0.01687702]
Stock Position:  0.016877020405451734
Bond Position:  [10.54063716]


portfolio before change:  [12.30454389]
curr_Stock_Price:  104.35913444116248
curr_Factors:  [104.35913444]
mat_Sqrt:  [[0.15]]
grads:  [-0.02272593]
Stock Position:  -0.02272593253907801
Bond Position:  [14.67620254]


portfolio before change:  [12.34173609]
curr_Stock_Price:  102.88404901365526
curr_Factors:  [102.88404901]
mat_Sqrt:  [[0.15]]
grads:  [-0.02526969]
Stock Position:  -0.02526969114498687
Bond Position:  [14.94158423]


portfolio before change:  [12.28415588]
curr_Stock_Price:  105.31051587699692
curr_Factors:  [105.31051588]
mat_Sqrt:  [[0.15]]
grads:  [0.07942187]
Stock Position:  0.07942186860829493
Bond Position:  [3.92019793]


portfolio before change:  [12.29467984]
curr_Stock_Price:  105.43068155776452
curr_Factors:  [105.43068156]
mat_Sqrt:  [[0.15]]
grads:  [-0.0186286]
Stock Position:  -0.0186286043604141
Bond Position:  [14.25870629]


portfolio before change:  [12.27778596]
curr_Stock_Price:  106.52893882912103
curr_Factors:  [106.52893883]
mat_Sqrt:  [[0.15]]
grads:  [0.10925511]
Stock Position:  0.10925510987894967
Bond Position:  [0.63895504]


portfolio before change:  [12.21622969]
curr_Stock_Price:  105.96405884299372
curr_Factors:  [105.96405884]
mat_Sqrt:  [[0.15]]
grads:  [0.13863359]
Stock Position:  0.13863358535377918
Bond Position:  [-2.4739477]


portfolio before change:  [12.36330707]
curr_Stock_Price:  107.0294279632317
curr_Factors:  [107.02942796]
mat_Sqrt:  [[0.15]]
grads:  [0.06267068]
Stock Position:  0.06267068252129905
Bond Position:  [5.65569977]


portfolio before change:  [12.35607315]
curr_Stock_Price:  106.89143638211942
curr_Factors:  [106.89143638]
mat_Sqrt:  [[0.15]]
grads:  [0.0984874]
Stock Position:  0.09848739505128479
Bond Position:  [1.82861402]


portfolio before change:  [12.42021074]
curr_Stock_Price:  107.53802050494278
curr_Factors:  [107.5380205]
mat_Sqrt:  [[0.15]]
grads:  [-0.10879655]
Stock Position:  -0.1087965517413631
Bond Position:  [24.11997655]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.42041434]
Stock Price:  107.59158056687724
PL:  [4.82883377]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.76709205e-03]
 [-8.84124391e-04]
 [-6.91016810e-03]
 [-1.46211486e-02]
 [ 5.95631433e-03]
 [-9.72585234e-03]
 [-7.00535957e-04]
 [-1.34612577e-03]
 [ 1.08964334e-02]
 [ 4.53923862e-04]
 [-3.29292333e-03]
 [ 2.51916776e-04]
 [ 9.20263032e-03]
 [ 2.58754627e-04]
 [ 2.10740162e-03]
 [ 1.80305426e-02]
 [ 4.77368911e-03]
 [ 8.50975681e-03]
 [-4.87230279e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.98397787]
curr_Stock_Price:  99.47452916089333
curr_Factors:  [99.47452916]
mat_Sqrt:  [[0.15]]
grads:  [0.01844728]
Stock Position:  0.018447280358361493
Bond Position:  [-11.8190124]


portfolio before change:  [-10.01897013]
curr_Stock_Price:  97.73784312466687
curr_Factors:  [97.73784312]
mat_Sqrt:  [[0.15]]
grads:  [-0.00589416]
Stock Position:  -0.005894162604754706
Bond Position:  [-9.44288739]


portfolio before change:  [-10.02659677]
curr_Stock_Price:  98.63120565467996
curr_Factors:  [98.63120565]
mat_Sqrt:  [[0.15]]
grads:  [-0.04606779]
Stock Position:  -0.04606778733990968
Bond Position:  [-5.48287536]


portfolio before change:  [-10.02911272]
curr_Stock_Price:  98.65606168543863
curr_Factors:  [98.65606169]
mat_Sqrt:  [[0.15]]
grads:  [-0.09747432]
Stock Position:  -0.09747432384801606
Bond Position:  [-0.41267981]


portfolio before change:  [-10.2500069]
curr_Stock_Price:  100.9211812851535
curr_Factors:  [100.92118129]
mat_Sqrt:  [[0.15]]
grads:  [0.03970876]
Stock Position:  0.03970876218875977
Bond Position:  [-14.25746209]


portfolio before change:  [-10.26490113]
curr_Stock_Price:  100.63586848917464
curr_Factors:  [100.63586849]
mat_Sqrt:  [[0.15]]
grads:  [-0.06483902]
Stock Position:  -0.06483901559250972
Bond Position:  [-3.73977049]


portfolio before change:  [-10.3677608]
curr_Stock_Price:  102.2078326512718
curr_Factors:  [102.20783265]
mat_Sqrt:  [[0.15]]
grads:  [-0.00467024]
Stock Position:  -0.004670239715887792
Bond Position:  [-9.89042572]


portfolio before change:  [-10.3796109]
curr_Stock_Price:  104.21569083564964
curr_Factors:  [104.21569084]
mat_Sqrt:  [[0.15]]
grads:  [-0.00897417]
Stock Position:  -0.008974171804456364
Bond Position:  [-9.44436138]


portfolio before change:  [-10.38516972]
curr_Stock_Price:  104.57198381201418
curr_Factors:  [104.57198381]
mat_Sqrt:  [[0.15]]
grads:  [0.07264289]
Stock Position:  0.07264288904537153
Bond Position:  [-17.98158073]


portfolio before change:  [-10.42326518]
curr_Stock_Price:  104.10945393909675
curr_Factors:  [104.10945394]
mat_Sqrt:  [[0.15]]
grads:  [0.00302616]
Stock Position:  0.0030261590793609697
Bond Position:  [-10.73831695]


portfolio before change:  [-10.42733271]
curr_Stock_Price:  103.65256735004054
curr_Factors:  [103.65256735]
mat_Sqrt:  [[0.15]]
grads:  [-0.02195282]
Stock Position:  -0.02195282222822848
Bond Position:  [-8.15186632]


portfolio before change:  [-10.42669219]
curr_Stock_Price:  103.53054474388928
curr_Factors:  [103.53054474]
mat_Sqrt:  [[0.15]]
grads:  [0.00167945]
Stock Position:  0.0016794451727168702
Bond Position:  [-10.60056606]


portfolio before change:  [-10.4295194]
curr_Stock_Price:  103.42530917378664
curr_Factors:  [103.42530917]
mat_Sqrt:  [[0.15]]
grads:  [0.06135087]
Stock Position:  0.06135086876745545
Bond Position:  [-16.77475197]


portfolio before change:  [-10.52925188]
curr_Stock_Price:  101.86806514082863
curr_Factors:  [101.86806514]
mat_Sqrt:  [[0.15]]
grads:  [0.00172503]
Stock Position:  0.0017250308457811736
Bond Position:  [-10.70497744]


portfolio before change:  [-10.53388311]
curr_Stock_Price:  100.73495603386152
curr_Factors:  [100.73495603]
mat_Sqrt:  [[0.15]]
grads:  [0.01404934]
Stock Position:  0.014049344117124888
Bond Position:  [-11.94914317]


portfolio before change:  [-10.54499149]
curr_Stock_Price:  100.15694195591578
curr_Factors:  [100.15694196]
mat_Sqrt:  [[0.15]]
grads:  [0.12020362]
Stock Position:  0.12020361747280889
Bond Position:  [-22.58421823]


portfolio before change:  [-10.61639011]
curr_Stock_Price:  99.6099379833784
curr_Factors:  [99.60993798]
mat_Sqrt:  [[0.15]]
grads:  [0.03182459]
Stock Position:  0.03182459404526289
Bond Position:  [-13.78643594]


portfolio before change:  [-10.61306358]
curr_Stock_Price:  99.82277851853853
curr_Factors:  [99.82277852]
mat_Sqrt:  [[0.15]]
grads:  [0.05673171]
Stock Position:  0.056731712076557944
Bond Position:  [-16.27618071]


portfolio before change:  [-10.63303025]
curr_Stock_Price:  99.54256287862088
curr_Factors:  [99.54256288]
mat_Sqrt:  [[0.15]]
grads:  [-0.03248202]
Stock Position:  -0.03248201863232897
Bond Position:  [-7.39968687]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.58608662]
Stock Price:  98.04038457518816
PL:  [-10.58608662]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.08601947e-03]
 [-9.91117256e-04]
 [-1.38784315e-02]
 [ 1.45403982e-02]
 [-1.73626292e-03]
 [-1.06936140e-02]
 [ 1.35217030e-02]
 [-5.64484623e-03]
 [-6.94257651e-04]
 [ 8.85117997e-03]
 [-4.51653324e-03]
 [ 1.94138122e-03]
 [ 5.27821605e-03]
 [-1.19009812e-03]
 [ 7.78868843e-03]
 [ 2.16526351e-02]
 [ 1.24502089e-02]
 [ 2.25073994e-04]
 [-1.05029589e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.88790141]
curr_Stock_Price:  99.16128502926773
curr_Factors:  [99.16128503]
mat_Sqrt:  [[0.15]]
grads:  [0.0139068]
Stock Position:  0.013906796467945196
Bond Position:  [-18.26691722]


portfolio before change:  [-16.91801699]
curr_Stock_Price:  97.32417775706102
curr_Factors:  [97.32417776]
mat_Sqrt:  [[0.15]]
grads:  [-0.00660745]
Stock Position:  -0.006607448371540919
Bond Position:  [-16.27495251]


portfolio before change:  [-16.91817526]
curr_Stock_Price:  96.73227396976043
curr_Factors:  [96.73227397]
mat_Sqrt:  [[0.15]]
grads:  [-0.09252288]
Stock Position:  -0.09252287648257276
Bond Position:  [-7.96822703]


portfolio before change:  [-16.90543542]
curr_Stock_Price:  96.57304687810768
curr_Factors:  [96.57304688]
mat_Sqrt:  [[0.15]]
grads:  [0.09693599]
Stock Position:  0.09693598782398913
Bond Position:  [-26.26683912]


portfolio before change:  [-16.80057047]
curr_Stock_Price:  97.72259399108258
curr_Factors:  [97.72259399]
mat_Sqrt:  [[0.15]]
grads:  [-0.01157509]
Stock Position:  -0.011575086163059413
Bond Position:  [-15.66942302]


portfolio before change:  [-16.81397894]
curr_Stock_Price:  98.54251272461131
curr_Factors:  [98.54251272]
mat_Sqrt:  [[0.15]]
grads:  [-0.07129076]
Stock Position:  -0.07129075996936655
Bond Position:  [-9.78880832]


portfolio before change:  [-16.79994707]
curr_Stock_Price:  98.31135545002621
curr_Factors:  [98.31135545]
mat_Sqrt:  [[0.15]]
grads:  [0.09014469]
Stock Position:  0.09014468668343857
Bond Position:  [-25.66219341]


portfolio before change:  [-16.66710334]
curr_Stock_Price:  99.85620619494954
curr_Factors:  [99.85620619]
mat_Sqrt:  [[0.15]]
grads:  [-0.03763231]
Stock Position:  -0.0376323081958748
Bond Position:  [-12.90928381]


portfolio before change:  [-16.65604642]
curr_Stock_Price:  99.47662175986298
curr_Factors:  [99.47662176]
mat_Sqrt:  [[0.15]]
grads:  [-0.00462838]
Stock Position:  -0.004628384342444457
Bond Position:  [-16.19563038]


portfolio before change:  [-16.65924153]
curr_Stock_Price:  99.292041706102
curr_Factors:  [99.29204171]
mat_Sqrt:  [[0.15]]
grads:  [0.05900787]
Stock Position:  0.05900786643399205
Bond Position:  [-22.51825306]


portfolio before change:  [-16.71701519]
curr_Stock_Price:  98.40837315566186
curr_Factors:  [98.40837316]
mat_Sqrt:  [[0.15]]
grads:  [-0.03011022]
Stock Position:  -0.030110221595494157
Bond Position:  [-13.75391727]


portfolio before change:  [-16.70783829]
curr_Stock_Price:  97.9893853854622
curr_Factors:  [97.98938539]
mat_Sqrt:  [[0.15]]
grads:  [0.01294254]
Stock Position:  0.012942541495890789
Bond Position:  [-17.97606997]


portfolio before change:  [-16.70928834]
curr_Stock_Price:  98.22461916911286
curr_Factors:  [98.22461917]
mat_Sqrt:  [[0.15]]
grads:  [0.03518811]
Stock Position:  0.03518810700364282
Bond Position:  [-20.16562675]


portfolio before change:  [-16.7572884]
curr_Stock_Price:  97.00380839123687
curr_Factors:  [97.00380839]
mat_Sqrt:  [[0.15]]
grads:  [-0.00793399]
Stock Position:  -0.007933987445544207
Bond Position:  [-15.9876614]


portfolio before change:  [-16.74959184]
curr_Stock_Price:  95.52989898055263
curr_Factors:  [95.52989898]
mat_Sqrt:  [[0.15]]
grads:  [0.05192459]
Stock Position:  0.051924589526978454
Bond Position:  [-21.70994263]


portfolio before change:  [-16.78201879]
curr_Stock_Price:  95.0099374511499
curr_Factors:  [95.00993745]
mat_Sqrt:  [[0.15]]
grads:  [0.1443509]
Stock Position:  0.1443509004864066
Bond Position:  [-30.49678881]


portfolio before change:  [-16.99144322]
curr_Stock_Price:  93.61196015600372
curr_Factors:  [93.61196016]
mat_Sqrt:  [[0.15]]
grads:  [0.08300139]
Stock Position:  0.08300139289112547
Bond Position:  [-24.7613663]


portfolio before change:  [-16.99658933]
curr_Stock_Price:  93.62455040968297
curr_Factors:  [93.62455041]
mat_Sqrt:  [[0.15]]
grads:  [0.00150049]
Stock Position:  0.0015004932954360932
Bond Position:  [-17.13707234]


portfolio before change:  [-17.00244862]
curr_Stock_Price:  92.57523276908636
curr_Factors:  [92.57523277]
mat_Sqrt:  [[0.15]]
grads:  [-0.07001973]
Stock Position:  -0.07001972596387693
Bond Position:  [-10.5203562]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.14031891]
Stock Price:  94.50668665709163
PL:  [-17.14031891]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-4.00925351e-03]
 [-9.86699099e-03]
 [-2.66687833e-02]
 [ 2.97817177e-02]
 [ 5.71628464e-03]
 [-1.01440180e-02]
 [ 8.42453030e-03]
 [-2.06877077e-02]
 [-1.65302015e-02]
 [ 6.13257636e-03]
 [-2.93428728e-03]
 [-5.60265437e-03]
 [ 5.32501198e-03]
 [ 2.27374368e-04]
 [ 1.57826532e-03]
 [ 1.94206344e-02]
 [ 2.45679052e-03]
 [ 1.22157562e-02]
 [-5.61582854e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.71616289]
curr_Stock_Price:  100.27761818534424
curr_Factors:  [100.27761819]
mat_Sqrt:  [[0.15]]
grads:  [-0.02672836]
Stock Position:  -0.02672835671683306
Bond Position:  [10.39641884]


portfolio before change:  [7.7224964]
curr_Stock_Price:  100.13791328400646
curr_Factors:  [100.13791328]
mat_Sqrt:  [[0.15]]
grads:  [-0.06577994]
Stock Position:  -0.0657799399483536
Bond Position:  [14.30956233]


portfolio before change:  [7.62464238]
curr_Stock_Price:  101.67990108389584
curr_Factors:  [101.67990108]
mat_Sqrt:  [[0.15]]
grads:  [-0.17779189]
Stock Position:  -0.17779188887268468
Bond Position:  [25.70250405]


portfolio before change:  [7.63016285]
curr_Stock_Price:  101.68499666832388
curr_Factors:  [101.68499667]
mat_Sqrt:  [[0.15]]
grads:  [0.19854478]
Stock Position:  0.19854478491705363
Bond Position:  [-12.55886294]


portfolio before change:  [7.55364965]
curr_Stock_Price:  101.31544231530799
curr_Factors:  [101.31544232]
mat_Sqrt:  [[0.15]]
grads:  [0.03810856]
Stock Position:  0.03810856426303776
Bond Position:  [3.69266361]


portfolio before change:  [7.5773768]
curr_Stock_Price:  101.91383450246694
curr_Factors:  [101.9138345]
mat_Sqrt:  [[0.15]]
grads:  [-0.06762679]
Stock Position:  -0.06762678652899601
Bond Position:  [14.46948193]


portfolio before change:  [7.65312219]
curr_Stock_Price:  100.84728133027834
curr_Factors:  [100.84728133]
mat_Sqrt:  [[0.15]]
grads:  [0.05616354]
Stock Position:  0.05616353533205262
Bond Position:  [1.98918234]


portfolio before change:  [7.56326191]
curr_Stock_Price:  99.23845023162141
curr_Factors:  [99.23845023]
mat_Sqrt:  [[0.15]]
grads:  [-0.13791805]
Stock Position:  -0.13791805114006234
Bond Position:  [21.25003556]


portfolio before change:  [7.33769523]
curr_Stock_Price:  100.91248671282493
curr_Factors:  [100.91248671]
mat_Sqrt:  [[0.15]]
grads:  [-0.11020134]
Stock Position:  -0.11020134331050482
Bond Position:  [18.45838682]


portfolio before change:  [7.459962]
curr_Stock_Price:  99.84488083412599
curr_Factors:  [99.84488083]
mat_Sqrt:  [[0.15]]
grads:  [0.04088384]
Stock Position:  0.04088384238883149
Bond Position:  [3.37791963]


portfolio before change:  [7.48861058]
curr_Stock_Price:  100.52495354343853
curr_Factors:  [100.52495354]
mat_Sqrt:  [[0.15]]
grads:  [-0.01956192]
Stock Position:  -0.019561915202195943
Bond Position:  [9.45507119]


portfolio before change:  [7.48594579]
curr_Stock_Price:  100.78202702598055
curr_Factors:  [100.78202703]
mat_Sqrt:  [[0.15]]
grads:  [-0.03735103]
Stock Position:  -0.037351029165146994
Bond Position:  [11.25025822]


portfolio before change:  [7.485643]
curr_Stock_Price:  100.86544390946709
curr_Factors:  [100.86544391]
mat_Sqrt:  [[0.15]]
grads:  [0.03550008]
Stock Position:  0.035500079885164855
Bond Position:  [3.90491168]


portfolio before change:  [7.5125263]
curr_Stock_Price:  101.59521544120378
curr_Factors:  [101.59521544]
mat_Sqrt:  [[0.15]]
grads:  [0.00151583]
Stock Position:  0.0015158291212661536
Bond Position:  [7.35852531]


portfolio before change:  [7.51331349]
curr_Stock_Price:  100.90076685170742
curr_Factors:  [100.90076685]
mat_Sqrt:  [[0.15]]
grads:  [0.01052177]
Stock Position:  0.010521768797003452
Bond Position:  [6.45165895]


portfolio before change:  [7.51072524]
curr_Stock_Price:  100.50146401774612
curr_Factors:  [100.50146402]
mat_Sqrt:  [[0.15]]
grads:  [0.1294709]
Stock Position:  0.12947089585021976
Bond Position:  [-5.50128934]


portfolio before change:  [7.59160189]
curr_Stock_Price:  101.13675854103462
curr_Factors:  [101.13675854]
mat_Sqrt:  [[0.15]]
grads:  [0.0163786]
Stock Position:  0.016378603487725997
Bond Position:  [5.93512303]


portfolio before change:  [7.61445715]
curr_Stock_Price:  102.44158838466046
curr_Factors:  [102.44158838]
mat_Sqrt:  [[0.15]]
grads:  [0.08143837]
Stock Position:  0.08143837469927814
Bond Position:  [-0.72821931]


portfolio before change:  [7.53087472]
curr_Stock_Price:  101.41749684485838
curr_Factors:  [101.41749684]
mat_Sqrt:  [[0.15]]
grads:  [-0.03743886]
Stock Position:  -0.03743885690234112
Bond Position:  [11.32782987]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.5475947]
Stock Price:  101.0465542166851
PL:  [6.50104049]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-4.49893848e-04]
 [ 1.36265390e-02]
 [-5.48947981e-03]
 [ 7.68002455e-03]
 [ 6.61124090e-03]
 [-9.94263659e-03]
 [ 1.44188091e-02]
 [-2.79381818e-02]
 [-9.95697329e-04]
 [ 1.03318917e-02]
 [-5.02925612e-03]
 [ 4.50532894e-03]
 [ 6.00574883e-03]
 [-9.94342834e-04]
 [ 8.13906653e-03]
 [ 1.85339634e-02]
 [ 8.64571027e-03]
 [ 6.30621274e-04]
 [-8.82116350e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.73649839]
curr_Stock_Price:  100.05168134345138
curr_Factors:  [100.05168134]
mat_Sqrt:  [[0.15]]
grads:  [-0.00299929]
Stock Position:  -0.0029992923183059265
Bond Position:  [3.03658263]


portfolio before change:  [2.73404765]
curr_Stock_Price:  101.12192767468667
curr_Factors:  [101.12192767]
mat_Sqrt:  [[0.15]]
grads:  [0.09084359]
Stock Position:  0.09084359300817212
Bond Position:  [-6.45223159]


portfolio before change:  [2.67235987]
curr_Stock_Price:  100.46063144921393
curr_Factors:  [100.46063145]
mat_Sqrt:  [[0.15]]
grads:  [-0.03659653]
Stock Position:  -0.036596532061074806
Bond Position:  [6.34887059]


portfolio before change:  [2.65503757]
curr_Stock_Price:  100.97733934753343
curr_Factors:  [100.97733935]
mat_Sqrt:  [[0.15]]
grads:  [0.05120016]
Stock Position:  0.051200163658835535
Bond Position:  [-2.51501873]


portfolio before change:  [2.61530561]
curr_Stock_Price:  100.21360892172844
curr_Factors:  [100.21360892]
mat_Sqrt:  [[0.15]]
grads:  [0.04407494]
Stock Position:  0.04407493935157226
Bond Position:  [-1.80160313]


portfolio before change:  [2.59898359]
curr_Stock_Price:  99.85350500004685
curr_Factors:  [99.853505]
mat_Sqrt:  [[0.15]]
grads:  [-0.06628424]
Stock Position:  -0.06628424394352557
Bond Position:  [9.21769768]


portfolio before change:  [2.62877463]
curr_Stock_Price:  99.4388314278292
curr_Factors:  [99.43883143]
mat_Sqrt:  [[0.15]]
grads:  [0.09612539]
Stock Position:  0.09612539387186612
Bond Position:  [-6.92982221]


portfolio before change:  [2.56184551]
curr_Stock_Price:  98.76058769805374
curr_Factors:  [98.7605877]
mat_Sqrt:  [[0.15]]
grads:  [-0.18625455]
Stock Position:  -0.18625454563523136
Bond Position:  [20.9564539]


portfolio before change:  [2.70319383]
curr_Stock_Price:  98.02982139869958
curr_Factors:  [98.0298214]
mat_Sqrt:  [[0.15]]
grads:  [-0.00663798]
Stock Position:  -0.006637982195657678
Bond Position:  [3.35391404]


portfolio before change:  [2.70343203]
curr_Stock_Price:  98.12026730340749
curr_Factors:  [98.1202673]
mat_Sqrt:  [[0.15]]
grads:  [0.06887928]
Stock Position:  0.06887927826666347
Bond Position:  [-4.05502116]


portfolio before change:  [2.69059361]
curr_Stock_Price:  97.94859674561026
curr_Factors:  [97.94859675]
mat_Sqrt:  [[0.15]]
grads:  [-0.03352837]
Stock Position:  -0.03352837413536705
Bond Position:  [5.9746508]


portfolio before change:  [2.71032924]
curr_Stock_Price:  97.40452673390047
curr_Factors:  [97.40452673]
mat_Sqrt:  [[0.15]]
grads:  [0.03003553]
Stock Position:  0.03003552625681911
Bond Position:  [-0.21526698]


portfolio before change:  [2.69234971]
curr_Stock_Price:  96.80771001855994
curr_Factors:  [96.80771002]
mat_Sqrt:  [[0.15]]
grads:  [0.04003833]
Stock Position:  0.04003832553763406
Bond Position:  [-1.1836689]


portfolio before change:  [2.74594521]
curr_Stock_Price:  98.15370661794599
curr_Factors:  [98.15370662]
mat_Sqrt:  [[0.15]]
grads:  [-0.00662895]
Stock Position:  -0.006628952228683688
Bond Position:  [3.39660144]


portfolio before change:  [2.75146656]
curr_Stock_Price:  97.44890545727019
curr_Factors:  [97.44890546]
mat_Sqrt:  [[0.15]]
grads:  [0.05426044]
Stock Position:  0.05426044352739051
Bond Position:  [-2.53615428]


portfolio before change:  [2.76138446]
curr_Stock_Price:  97.64337527491124
curr_Factors:  [97.64337527]
mat_Sqrt:  [[0.15]]
grads:  [0.12355976]
Stock Position:  0.12355975571712903
Bond Position:  [-9.30340714]


portfolio before change:  [2.51809295]
curr_Stock_Price:  95.6931823117314
curr_Factors:  [95.69318231]
mat_Sqrt:  [[0.15]]
grads:  [0.05763807]
Stock Position:  0.05763806847245617
Bond Position:  [-2.99747725]


portfolio before change:  [2.55625007]
curr_Stock_Price:  96.36819776275486
curr_Factors:  [96.36819776]
mat_Sqrt:  [[0.15]]
grads:  [0.00420414]
Stock Position:  0.004204141826840644
Bond Position:  [2.1511045]


portfolio before change:  [2.55309895]
curr_Stock_Price:  95.49073796217003
curr_Factors:  [95.49073796]
mat_Sqrt:  [[0.15]]
grads:  [-0.05880776]
Stock Position:  -0.058807756657468784
Bond Position:  [8.16869503]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.55091352]
Stock Price:  95.56263078543512
PL:  [2.55091352]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.18100212e-02]
 [ 6.07587023e-02]
 [-2.75442568e-02]
 [ 4.90938614e-02]
 [ 5.71374660e-03]
 [-1.13541909e-02]
 [-1.21225978e-03]
 [ 6.81476396e-03]
 [-1.91662995e-02]
 [ 2.32094314e-03]
 [-3.54351988e-03]
 [ 1.94021990e-02]
 [ 1.25168776e-02]
 [-4.28040306e-03]
 [ 2.29080440e-02]
 [ 1.94418151e-02]
 [ 9.35129477e-03]
 [ 1.56472553e-02]
 [-1.70023985e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [43.56113985]
curr_Stock_Price:  101.90397291098809
curr_Factors:  [101.90397291]
mat_Sqrt:  [[0.15]]
grads:  [-0.14540014]
Stock Position:  -0.1454001414805295
Bond Position:  [58.37799192]


portfolio before change:  [43.39783278]
curr_Stock_Price:  103.1275163351629
curr_Factors:  [103.12751634]
mat_Sqrt:  [[0.15]]
grads:  [0.40505802]
Stock Position:  0.40505801531655733
Bond Position:  [1.62520569]


portfolio before change:  [42.83425418]
curr_Stock_Price:  101.73516033916448
curr_Factors:  [101.73516034]
mat_Sqrt:  [[0.15]]
grads:  [-0.18362838]
Stock Position:  -0.1836283784244643
Bond Position:  [61.5157167]


portfolio before change:  [42.65518092]
curr_Stock_Price:  102.79411490004566
curr_Factors:  [102.7941149]
mat_Sqrt:  [[0.15]]
grads:  [0.32729241]
Stock Position:  0.3272924094802303
Bond Position:  [9.01144737]


portfolio before change:  [42.35106587]
curr_Stock_Price:  101.8580461707338
curr_Factors:  [101.85804617]
mat_Sqrt:  [[0.15]]
grads:  [0.03809164]
Stock Position:  0.03809164400311778
Bond Position:  [38.47112544]


portfolio before change:  [42.38202577]
curr_Stock_Price:  102.41829790363576
curr_Factors:  [102.4182979]
mat_Sqrt:  [[0.15]]
grads:  [-0.07569461]
Stock Position:  -0.0756946062249449
Bond Position:  [50.1345385]


portfolio before change:  [42.39646598]
curr_Stock_Price:  102.39313080476138
curr_Factors:  [102.3931308]
mat_Sqrt:  [[0.15]]
grads:  [-0.00808173]
Stock Position:  -0.008081731886340303
Bond Position:  [43.22397981]


portfolio before change:  [42.40604747]
curr_Stock_Price:  102.54481367584472
curr_Factors:  [102.54481368]
mat_Sqrt:  [[0.15]]
grads:  [0.04543176]
Stock Position:  0.04543175975472858
Bond Position:  [37.74725613]


portfolio before change:  [42.36457965]
curr_Stock_Price:  101.42432422501989
curr_Factors:  [101.42432423]
mat_Sqrt:  [[0.15]]
grads:  [-0.12777533]
Stock Position:  -0.12777533027247223
Bond Position:  [55.32410618]


portfolio before change:  [42.2060239]
curr_Stock_Price:  102.77347753517796
curr_Factors:  [102.77347754]
mat_Sqrt:  [[0.15]]
grads:  [0.01547295]
Stock Position:  0.015472954294901293
Bond Position:  [40.61581458]


portfolio before change:  [42.25340609]
curr_Stock_Price:  105.17941519712119
curr_Factors:  [105.1794152]
mat_Sqrt:  [[0.15]]
grads:  [-0.02362347]
Stock Position:  -0.02362346586350177
Bond Position:  [44.73810841]


portfolio before change:  [42.23119241]
curr_Stock_Price:  106.59324665295857
curr_Factors:  [106.59324665]
mat_Sqrt:  [[0.15]]
grads:  [0.12934799]
Stock Position:  0.12934799329773286
Bond Position:  [28.44356986]


portfolio before change:  [42.12589579]
curr_Stock_Price:  105.72420800460549
curr_Factors:  [105.724208]
mat_Sqrt:  [[0.15]]
grads:  [0.08344585]
Stock Position:  0.08344585069150028
Bond Position:  [33.30364931]


portfolio before change:  [42.21035034]
curr_Stock_Price:  106.63650737389949
curr_Factors:  [106.63650737]
mat_Sqrt:  [[0.15]]
grads:  [-0.02853602]
Stock Position:  -0.02853602042857003
Bond Position:  [45.25333189]


portfolio before change:  [42.18312635]
curr_Stock_Price:  107.98703691129809
curr_Factors:  [107.98703691]
mat_Sqrt:  [[0.15]]
grads:  [0.15272029]
Stock Position:  0.15272029329201675
Bond Position:  [25.6913144]


portfolio before change:  [42.14016519]
curr_Stock_Price:  107.66366932713085
curr_Factors:  [107.66366933]
mat_Sqrt:  [[0.15]]
grads:  [0.1296121]
Stock Position:  0.12961210041042515
Bond Position:  [28.18565087]


portfolio before change:  [42.0606987]
curr_Stock_Price:  106.99618703872558
curr_Factors:  [106.99618704]
mat_Sqrt:  [[0.15]]
grads:  [0.06234197]
Stock Position:  0.06234196516189727
Bond Position:  [35.39034613]


portfolio before change:  [42.17881638]
curr_Stock_Price:  108.74892273123088
curr_Factors:  [108.74892273]
mat_Sqrt:  [[0.15]]
grads:  [0.10431504]
Stock Position:  0.10431503562007785
Bond Position:  [30.83466863]


portfolio before change:  [42.18345227]
curr_Stock_Price:  108.71945677826884
curr_Factors:  [108.71945678]
mat_Sqrt:  [[0.15]]
grads:  [-0.11334932]
Stock Position:  -0.1133493233590494
Bond Position:  [54.50672913]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [42.16939855]
Stock Price:  108.96367614978824
PL:  [33.2057224]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.64021364e-02]
 [-9.99675347e-03]
 [-1.13833703e-02]
 [-1.01645740e-02]
 [ 5.71293841e-03]
 [-9.62317953e-03]
 [ 5.61686050e-03]
 [-2.53649591e-02]
 [ 2.26441675e-04]
 [ 9.39668417e-03]
 [-7.29543119e-03]
 [ 6.48960096e-03]
 [ 5.58284112e-03]
 [-1.08363753e-03]
 [ 7.53833297e-03]
 [ 2.10562004e-02]
 [ 7.40451792e-03]
 [ 6.09124748e-04]
 [-7.26696192e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.24288927]
curr_Stock_Price:  100.98209526881243
curr_Factors:  [100.98209527]
mat_Sqrt:  [[0.15]]
grads:  [-0.10934758]
Stock Position:  -0.10934757592947937
Bond Position:  [34.2850366]


portfolio before change:  [23.36095346]
curr_Stock_Price:  99.98077580394688
curr_Factors:  [99.9807758]
mat_Sqrt:  [[0.15]]
grads:  [-0.06664502]
Stock Position:  -0.0666450231474119
Bond Position:  [30.02417458]


portfolio before change:  [23.30933487]
curr_Stock_Price:  100.86794738792908
curr_Factors:  [100.86794739]
mat_Sqrt:  [[0.15]]
grads:  [-0.07588914]
Stock Position:  -0.07588913558584794
Bond Position:  [30.96411621]


portfolio before change:  [23.3578062]
curr_Stock_Price:  100.33125214478956
curr_Factors:  [100.33125214]
mat_Sqrt:  [[0.15]]
grads:  [-0.06776383]
Stock Position:  -0.0677638269068801
Bond Position:  [30.15663581]


portfolio before change:  [23.2501765]
curr_Stock_Price:  102.03082868401695
curr_Factors:  [102.03082868]
mat_Sqrt:  [[0.15]]
grads:  [0.03808626]
Stock Position:  0.03808625604834166
Bond Position:  [19.36420423]


portfolio before change:  [23.2371531]
curr_Stock_Price:  101.56176045657324
curr_Factors:  [101.56176046]
mat_Sqrt:  [[0.15]]
grads:  [-0.06415453]
Stock Position:  -0.06415453020770882
Bond Position:  [29.75280013]


portfolio before change:  [23.26738847]
curr_Stock_Price:  101.20642721494637
curr_Factors:  [101.20642721]
mat_Sqrt:  [[0.15]]
grads:  [0.03744574]
Stock Position:  0.037445736656551175
Bond Position:  [19.47763925]


portfolio before change:  [23.18702285]
curr_Stock_Price:  98.9301830496777
curr_Factors:  [98.93018305]
mat_Sqrt:  [[0.15]]
grads:  [-0.16909973]
Stock Position:  -0.16909972766075101
Bond Position:  [39.91608986]


portfolio before change:  [23.44837752]
curr_Stock_Price:  97.44363774266836
curr_Factors:  [97.44363774]
mat_Sqrt:  [[0.15]]
grads:  [0.00150961]
Stock Position:  0.0015096111658209565
Bond Position:  [23.30127552]


portfolio before change:  [23.45379583]
curr_Stock_Price:  97.17354306222398
curr_Factors:  [97.17354306]
mat_Sqrt:  [[0.15]]
grads:  [0.06264456]
Stock Position:  0.06264456116579893
Bond Position:  [17.36640187]


portfolio before change:  [23.45087319]
curr_Stock_Price:  97.05757478267827
curr_Factors:  [97.05757478]
mat_Sqrt:  [[0.15]]
grads:  [-0.04863621]
Stock Position:  -0.04863620794329287
Bond Position:  [28.17138558]


portfolio before change:  [23.46089634]
curr_Stock_Price:  96.9963155517397
curr_Factors:  [96.99631555]
mat_Sqrt:  [[0.15]]
grads:  [0.04326401]
Stock Position:  0.0432640063896281
Bond Position:  [19.26444712]


portfolio before change:  [23.49674851]
curr_Stock_Price:  97.71366615682598
curr_Factors:  [97.71366616]
mat_Sqrt:  [[0.15]]
grads:  [0.03721894]
Stock Position:  0.03721894083169977
Bond Position:  [19.85994935]


portfolio before change:  [23.4943812]
curr_Stock_Price:  97.51664493435604
curr_Factors:  [97.51664493]
mat_Sqrt:  [[0.15]]
grads:  [-0.00722425]
Stock Position:  -0.007224250205309327
Bond Position:  [24.19886584]


portfolio before change:  [23.51775579]
curr_Stock_Price:  95.11859470966947
curr_Factors:  [95.11859471]
mat_Sqrt:  [[0.15]]
grads:  [0.05025555]
Stock Position:  0.05025555315762439
Bond Position:  [18.73751819]


portfolio before change:  [23.57072729]
curr_Stock_Price:  96.07941469681617
curr_Factors:  [96.0794147]
mat_Sqrt:  [[0.15]]
grads:  [0.14037467]
Stock Position:  0.14037466907043394
Bond Position:  [10.08361125]


portfolio before change:  [23.62600902]
curr_Stock_Price:  96.45526961645201
curr_Factors:  [96.45526962]
mat_Sqrt:  [[0.15]]
grads:  [0.04936345]
Stock Position:  0.049363452779028275
Bond Position:  [18.86464387]


portfolio before change:  [23.61924866]
curr_Stock_Price:  96.22276740493152
curr_Factors:  [96.2227674]
mat_Sqrt:  [[0.15]]
grads:  [0.00406083]
Stock Position:  0.004060831655104853
Bond Position:  [23.2285042]


portfolio before change:  [23.62524932]
curr_Stock_Price:  96.27024736191561
curr_Factors:  [96.27024736]
mat_Sqrt:  [[0.15]]
grads:  [-0.04844641]
Stock Position:  -0.04844641276874719
Bond Position:  [28.28919746]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.60967071]
Stock Price:  96.73781119698498
PL:  [23.60967071]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.88620164e-03]
 [ 2.51848112e-02]
 [-2.85399901e-02]
 [ 3.61983326e-02]
 [ 5.71474835e-03]
 [-1.40687816e-02]
 [-7.66201673e-03]
 [ 1.98603892e-04]
 [-1.09851042e-03]
 [-9.65548494e-04]
 [-4.23313350e-03]
 [ 1.41168147e-02]
 [ 1.19800308e-02]
 [-3.44990380e-03]
 [ 1.54987270e-02]
 [ 2.03282712e-02]
 [ 7.38412010e-03]
 [ 1.50488350e-02]
 [-1.73601099e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.36286153]
curr_Stock_Price:  100.21621633070028
curr_Factors:  [100.21621633]
mat_Sqrt:  [[0.15]]
grads:  [-0.01924134]
Stock Position:  -0.019241344252183892
Bond Position:  [8.29115625]


portfolio before change:  [6.33704226]
curr_Stock_Price:  101.6658196828573
curr_Factors:  [101.66581968]
mat_Sqrt:  [[0.15]]
grads:  [0.16789874]
Stock Position:  0.1678987414297711
Bond Position:  [-10.73252091]


portfolio before change:  [6.35655344]
curr_Stock_Price:  101.79801031399364
curr_Factors:  [101.79801031]
mat_Sqrt:  [[0.15]]
grads:  [-0.1902666]
Stock Position:  -0.19026660073919993
Bond Position:  [25.72531482]


portfolio before change:  [6.31911409]
curr_Stock_Price:  102.02858931079172
curr_Factors:  [102.02858931]
mat_Sqrt:  [[0.15]]
grads:  [0.24132222]
Stock Position:  0.24132221718999755
Bond Position:  [-18.3026513]


portfolio before change:  [6.22169987]
curr_Stock_Price:  101.64388380559959
curr_Factors:  [101.64388381]
mat_Sqrt:  [[0.15]]
grads:  [0.03809832]
Stock Position:  0.03809832232441409
Bond Position:  [2.34923842]


portfolio before change:  [6.29266717]
curr_Stock_Price:  103.49120724342988
curr_Factors:  [103.49120724]
mat_Sqrt:  [[0.15]]
grads:  [-0.09379188]
Stock Position:  -0.093791877425686
Bond Position:  [15.9993018]


portfolio before change:  [6.21895987]
curr_Stock_Price:  104.31971851066209
curr_Factors:  [104.31971851]
mat_Sqrt:  [[0.15]]
grads:  [-0.05108011]
Stock Position:  -0.05108011150446788
Bond Position:  [11.54762273]


portfolio before change:  [6.23880693]
curr_Stock_Price:  103.98769509403257
curr_Factors:  [103.98769509]
mat_Sqrt:  [[0.15]]
grads:  [0.00132403]
Stock Position:  0.0013240259467101057
Bond Position:  [6.10112453]


portfolio before change:  [6.23966696]
curr_Stock_Price:  103.48510219484785
curr_Factors:  [103.48510219]
mat_Sqrt:  [[0.15]]
grads:  [-0.0073234]
Stock Position:  -0.007323402797192601
Bond Position:  [6.99753004]


portfolio before change:  [6.2294056]
curr_Stock_Price:  105.12518076687297
curr_Factors:  [105.12518077]
mat_Sqrt:  [[0.15]]
grads:  [-0.00643699]
Stock Position:  -0.006436989957685589
Bond Position:  [6.90609534]


portfolio before change:  [6.2206914]
curr_Stock_Price:  106.74720323280471
curr_Factors:  [106.74720323]
mat_Sqrt:  [[0.15]]
grads:  [-0.02822089]
Stock Position:  -0.028220889970482107
Bond Position:  [9.23319248]


portfolio before change:  [6.25119964]
curr_Stock_Price:  105.74795590149925
curr_Factors:  [105.7479559]
mat_Sqrt:  [[0.15]]
grads:  [0.0941121]
Stock Position:  0.0941120982657185
Bond Position:  [-3.70096238]


portfolio before change:  [6.21341145]
curr_Stock_Price:  105.35626519385377
curr_Factors:  [105.35626519]
mat_Sqrt:  [[0.15]]
grads:  [0.07986687]
Stock Position:  0.07986687207600654
Bond Position:  [-2.20106391]


portfolio before change:  [6.26129065]
curr_Stock_Price:  105.96264350709943
curr_Factors:  [105.96264351]
mat_Sqrt:  [[0.15]]
grads:  [-0.02299936]
Stock Position:  -0.022999358655077785
Bond Position:  [8.69836349]


portfolio before change:  [6.25501654]
curr_Stock_Price:  106.33000016822957
curr_Factors:  [106.33000017]
mat_Sqrt:  [[0.15]]
grads:  [0.10332485]
Stock Position:  0.1033248466893245
Bond Position:  [-4.73151442]


portfolio before change:  [6.27659646]
curr_Stock_Price:  106.55030481032418
curr_Factors:  [106.55030481]
mat_Sqrt:  [[0.15]]
grads:  [0.13552181]
Stock Position:  0.13552180814556852
Bond Position:  [-8.1632935]


portfolio before change:  [6.17448077]
curr_Stock_Price:  105.81186565215143
curr_Factors:  [105.81186565]
mat_Sqrt:  [[0.15]]
grads:  [0.04922747]
Stock Position:  0.04922746731766562
Bond Position:  [0.96563061]


portfolio before change:  [6.25665462]
curr_Stock_Price:  107.47622934549777
curr_Factors:  [107.47622935]
mat_Sqrt:  [[0.15]]
grads:  [0.10032557]
Stock Position:  0.10032556664033776
Bond Position:  [-4.52595899]


portfolio before change:  [6.40082513]
curr_Stock_Price:  108.92453558397233
curr_Factors:  [108.92453558]
mat_Sqrt:  [[0.15]]
grads:  [-0.11573407]
Stock Position:  -0.11573406626929439
Bond Position:  [19.00710455]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.36793237]
Stock Price:  109.24980832738758
PL:  [-2.88187596]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.23260460e-03]
 [-6.43794958e-03]
 [-4.03900049e-03]
 [-2.13141279e-02]
 [ 5.72832556e-03]
 [-1.18151609e-02]
 [-1.46254097e-03]
 [ 7.28340218e-03]
 [-9.73166807e-03]
 [ 1.73455184e-03]
 [-3.13552964e-03]
 [-5.09556355e-03]
 [ 1.15487153e-02]
 [-2.02768403e-03]
 [ 8.76023976e-03]
 [ 2.09228165e-02]
 [ 8.29673366e-03]
 [ 1.44722321e-02]
 [-1.58612388e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.18216023]
curr_Stock_Price:  99.19330584812295
curr_Factors:  [99.19330585]
mat_Sqrt:  [[0.15]]
grads:  [0.01488403]
Stock Position:  0.01488403064655328
Bond Position:  [-17.65855643]


portfolio before change:  [-16.18609922]
curr_Stock_Price:  99.22529996126647
curr_Factors:  [99.22529996]
mat_Sqrt:  [[0.15]]
grads:  [-0.04291966]
Stock Position:  -0.042919663851737226
Bond Position:  [-11.9273827]


portfolio before change:  [-16.20091362]
curr_Stock_Price:  99.50098201272567
curr_Factors:  [99.50098201]
mat_Sqrt:  [[0.15]]
grads:  [-0.02692667]
Stock Position:  -0.026926669932170844
Bond Position:  [-13.52168351]


portfolio before change:  [-16.21374121]
curr_Stock_Price:  99.85181442770615
curr_Factors:  [99.85181443]
mat_Sqrt:  [[0.15]]
grads:  [-0.14209419]
Stock Position:  -0.14209418569758353
Bond Position:  [-2.02537895]


portfolio before change:  [-16.40365902]
curr_Stock_Price:  101.18481339153652
curr_Factors:  [101.18481339]
mat_Sqrt:  [[0.15]]
grads:  [0.03818884]
Stock Position:  0.03818883706937311
Bond Position:  [-20.26778937]


portfolio before change:  [-16.35451354]
curr_Stock_Price:  102.60441833310279
curr_Factors:  [102.60441833]
mat_Sqrt:  [[0.15]]
grads:  [-0.07876774]
Stock Position:  -0.07876773958991365
Bond Position:  [-8.27259543]


portfolio before change:  [-16.34707789]
curr_Stock_Price:  102.48375906892501
curr_Factors:  [102.48375907]
mat_Sqrt:  [[0.15]]
grads:  [-0.00975027]
Stock Position:  -0.009750273141573337
Bond Position:  [-15.34783324]


portfolio before change:  [-16.35047303]
curr_Stock_Price:  102.43839704549114
curr_Factors:  [102.43839705]
mat_Sqrt:  [[0.15]]
grads:  [0.04855601]
Stock Position:  0.04855601456398551
Bond Position:  [-21.32447333]


portfolio before change:  [-16.34351277]
curr_Stock_Price:  102.69154893338853
curr_Factors:  [102.69154893]
mat_Sqrt:  [[0.15]]
grads:  [-0.06487779]
Stock Position:  -0.06487778714601568
Bond Position:  [-9.68111232]


portfolio before change:  [-16.37847154]
curr_Stock_Price:  103.19307949118074
curr_Factors:  [103.19307949]
mat_Sqrt:  [[0.15]]
grads:  [0.01156368]
Stock Position:  0.01156367894910392
Bond Position:  [-17.57176319]


portfolio before change:  [-16.38864096]
curr_Stock_Price:  102.69359074168496
curr_Factors:  [102.69359074]
mat_Sqrt:  [[0.15]]
grads:  [-0.02090353]
Stock Position:  -0.02090353092511111
Bond Position:  [-14.24198231]


portfolio before change:  [-16.39179959]
curr_Stock_Price:  102.67434473736887
curr_Factors:  [102.67434474]
mat_Sqrt:  [[0.15]]
grads:  [-0.03397042]
Stock Position:  -0.03397042367116683
Bond Position:  [-12.9039086]


portfolio before change:  [-16.47608981]
curr_Stock_Price:  105.06065114460853
curr_Factors:  [105.06065114]
mat_Sqrt:  [[0.15]]
grads:  [0.07699144]
Stock Position:  0.07699143510653107
Bond Position:  [-24.56486012]


portfolio before change:  [-16.50163296]
curr_Stock_Price:  104.80865993511257
curr_Factors:  [104.80865994]
mat_Sqrt:  [[0.15]]
grads:  [-0.01351789]
Stock Position:  -0.013517893562435622
Bond Position:  [-15.08484065]


portfolio before change:  [-16.50407232]
curr_Stock_Price:  104.71009992360683
curr_Factors:  [104.71009992]
mat_Sqrt:  [[0.15]]
grads:  [0.0584016]
Stock Position:  0.05840159840567429
Bond Position:  [-22.61930952]


portfolio before change:  [-16.44586732]
curr_Stock_Price:  105.8035722918174
curr_Factors:  [105.80357229]
mat_Sqrt:  [[0.15]]
grads:  [0.13948544]
Stock Position:  0.13948544348160352
Bond Position:  [-31.20392552]


portfolio before change:  [-16.37836214]
curr_Stock_Price:  106.34346470038561
curr_Factors:  [106.3434647]
mat_Sqrt:  [[0.15]]
grads:  [0.05531156]
Stock Position:  0.055311557762003236
Bond Position:  [-22.26038483]


portfolio before change:  [-16.38833724]
curr_Stock_Price:  106.263747021523
curr_Factors:  [106.26374702]
mat_Sqrt:  [[0.15]]
grads:  [0.09648155]
Stock Position:  0.0964815470026191
Bond Position:  [-26.64082795]


portfolio before change:  [-16.43500263]
curr_Stock_Price:  105.84911494004659
curr_Factors:  [105.84911494]
mat_Sqrt:  [[0.15]]
grads:  [-0.10574159]
Stock Position:  -0.10574159213117473
Bond Position:  [-5.24234869]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.34796215]
Stock Price:  105.01357592453404
PL:  [-21.36153808]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.12081349e-03]
 [-9.05179188e-04]
 [-1.11089427e-02]
 [-1.31980341e-02]
 [ 6.19486790e-03]
 [-9.86146772e-03]
 [ 8.28692959e-03]
 [ 1.50575888e-02]
 [-1.53209765e-02]
 [ 2.34314043e-03]
 [-2.92352510e-03]
 [ 2.26683425e-03]
 [ 5.51802992e-03]
 [-9.19152816e-04]
 [ 5.12569991e-03]
 [ 1.69012748e-02]
 [ 4.89294376e-03]
 [ 5.34999897e-03]
 [-4.13846866e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.72038394]
curr_Stock_Price:  99.16888561540873
curr_Factors:  [99.16888562]
mat_Sqrt:  [[0.15]]
grads:  [0.01413876]
Stock Position:  0.014138756574524694
Bond Position:  [-18.12250867]


portfolio before change:  [-16.74629924]
curr_Stock_Price:  97.65643918762512
curr_Factors:  [97.65643919]
mat_Sqrt:  [[0.15]]
grads:  [-0.00603453]
Stock Position:  -0.006034527919811851
Bond Position:  [-16.15698874]


portfolio before change:  [-16.74968802]
curr_Stock_Price:  97.54856451493661
curr_Factors:  [97.54856451]
mat_Sqrt:  [[0.15]]
grads:  [-0.07405962]
Stock Position:  -0.07405961813373284
Bond Position:  [-9.52527859]


portfolio before change:  [-16.81751393]
curr_Stock_Price:  98.43223483690926
curr_Factors:  [98.43223484]
mat_Sqrt:  [[0.15]]
grads:  [-0.08798689]
Stock Position:  -0.08798689414892932
Bond Position:  [-8.1567673]


portfolio before change:  [-16.92460872]
curr_Stock_Price:  99.62622341435726
curr_Factors:  [99.62622341]
mat_Sqrt:  [[0.15]]
grads:  [0.04129912]
Stock Position:  0.041299119360759556
Bond Position:  [-21.03908401]


portfolio before change:  [-16.90754146]
curr_Stock_Price:  100.16685689466586
curr_Factors:  [100.16685689]
mat_Sqrt:  [[0.15]]
grads:  [-0.06574312]
Stock Position:  -0.06574311810344259
Bond Position:  [-10.32225996]


portfolio before change:  [-16.95590787]
curr_Stock_Price:  100.86328748058476
curr_Factors:  [100.86328748]
mat_Sqrt:  [[0.15]]
grads:  [0.0552462]
Stock Position:  0.055246197276446536
Bond Position:  [-22.52822095]


portfolio before change:  [-16.96397639]
curr_Stock_Price:  100.81919829838951
curr_Factors:  [100.8191983]
mat_Sqrt:  [[0.15]]
grads:  [0.10038393]
Stock Position:  0.10038392504133174
Bond Position:  [-27.08460323]


portfolio before change:  [-16.98433823]
curr_Stock_Price:  100.68381960826075
curr_Factors:  [100.68381961]
mat_Sqrt:  [[0.15]]
grads:  [-0.10213984]
Stock Position:  -0.10213984338221174
Bond Position:  [-6.70050866]


portfolio before change:  [-17.03018642]
curr_Stock_Price:  101.1162938463051
curr_Factors:  [101.11629385]
mat_Sqrt:  [[0.15]]
grads:  [0.01562094]
Stock Position:  0.015620936202346357
Bond Position:  [-18.60971759]


portfolio before change:  [-17.0474902]
curr_Stock_Price:  100.30643364866329
curr_Factors:  [100.30643365]
mat_Sqrt:  [[0.15]]
grads:  [-0.01949017]
Stock Position:  -0.019490167310132454
Bond Position:  [-15.09250103]


portfolio before change:  [-17.00455741]
curr_Stock_Price:  97.91002589205603
curr_Factors:  [97.91002589]
mat_Sqrt:  [[0.15]]
grads:  [0.01511223]
Stock Position:  0.015112228313390505
Bond Position:  [-18.48419608]


portfolio before change:  [-17.01050364]
curr_Stock_Price:  97.82237514104628
curr_Factors:  [97.82237514]
mat_Sqrt:  [[0.15]]
grads:  [0.03678687]
Stock Position:  0.03678686610611953
Bond Position:  [-20.60908225]


portfolio before change:  [-16.99390598]
curr_Stock_Price:  98.41363435484622
curr_Factors:  [98.41363435]
mat_Sqrt:  [[0.15]]
grads:  [-0.00612769]
Stock Position:  -0.0061276854401594435
Bond Position:  [-16.39085818]


portfolio before change:  [-17.00553582]
curr_Stock_Price:  99.64274737039868
curr_Factors:  [99.64274737]
mat_Sqrt:  [[0.15]]
grads:  [0.03417133]
Stock Position:  0.03417133272439861
Bond Position:  [-20.4104613]


portfolio before change:  [-17.00528102]
curr_Stock_Price:  99.79954702597155
curr_Factors:  [99.79954703]
mat_Sqrt:  [[0.15]]
grads:  [0.11267517]
Stock Position:  0.1126751656580235
Bond Position:  [-28.25021152]


portfolio before change:  [-17.05117444]
curr_Stock_Price:  99.45492823547545
curr_Factors:  [99.45492824]
mat_Sqrt:  [[0.15]]
grads:  [0.03261963]
Stock Position:  0.032619625089009736
Bond Position:  [-20.29535691]


portfolio before change:  [-17.08397402]
curr_Stock_Price:  98.60497631056043
curr_Factors:  [98.60497631]
mat_Sqrt:  [[0.15]]
grads:  [0.03566666]
Stock Position:  0.035666659817339796
Bond Position:  [-20.60088417]


portfolio before change:  [-17.09892781]
curr_Stock_Price:  98.33012809800617
curr_Factors:  [98.3301281]
mat_Sqrt:  [[0.15]]
grads:  [-0.02758979]
Stock Position:  -0.027589791050359927
Bond Position:  [-14.38602012]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.10377697]
Stock Price:  98.37551493547485
PL:  [-17.10377697]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.37328860e-03]
 [ 6.83452537e-02]
 [-5.39659276e-02]
 [ 7.89528905e-02]
 [ 1.94289014e-03]
 [-1.66967169e-02]
 [-1.22878870e-02]
 [-9.69026396e-03]
 [ 5.31718297e-02]
 [-4.10426821e-03]
 [-4.42659917e-03]
 [ 1.60008800e-02]
 [ 1.37076226e-02]
 [-4.23303837e-03]
 [ 2.11490614e-02]
 [ 1.97711295e-02]
 [ 9.26036299e-03]
 [ 1.49721193e-02]
 [-1.60955231e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.03996497]
curr_Stock_Price:  99.83496412340712
curr_Factors:  [99.83496412]
mat_Sqrt:  [[0.15]]
grads:  [0.01582192]
Stock Position:  0.01582192400122221
Bond Position:  [-3.61954618]


portfolio before change:  [-1.98407583]
curr_Stock_Price:  103.42454889732169
curr_Factors:  [103.4245489]
mat_Sqrt:  [[0.15]]
grads:  [0.45563502]
Stock Position:  0.45563502457297106
Bond Position:  [-49.10792271]


portfolio before change:  [-1.97185811]
curr_Stock_Price:  103.47831174792157
curr_Factors:  [103.47831175]
mat_Sqrt:  [[0.15]]
grads:  [-0.35977285]
Stock Position:  -0.35977285057901853
Bond Position:  [35.25682908]


portfolio before change:  [-2.33652996]
curr_Stock_Price:  104.5164311220522
curr_Factors:  [104.51643112]
mat_Sqrt:  [[0.15]]
grads:  [0.5263526]
Stock Position:  0.5263526032923667
Bond Position:  [-57.34902557]


portfolio before change:  [-1.37536239]
curr_Stock_Price:  106.36976406938093
curr_Factors:  [106.36976407]
mat_Sqrt:  [[0.15]]
grads:  [0.0129526]
Stock Position:  0.012952600929117979
Bond Position:  [-2.7531275]


portfolio before change:  [-1.39994153]
curr_Stock_Price:  104.52528716583622
curr_Factors:  [104.52528717]
mat_Sqrt:  [[0.15]]
grads:  [-0.11131145]
Stock Position:  -0.11131144618270507
Bond Position:  [10.23491934]


portfolio before change:  [-1.52057077]
curr_Stock_Price:  105.63198635123621
curr_Factors:  [105.63198635]
mat_Sqrt:  [[0.15]]
grads:  [-0.08191925]
Stock Position:  -0.08191924635598909
Bond Position:  [7.13272194]


portfolio before change:  [-1.64774215]
curr_Stock_Price:  107.2061559046055
curr_Factors:  [107.2061559]
mat_Sqrt:  [[0.15]]
grads:  [-0.06460176]
Stock Position:  -0.06460175971157875
Bond Position:  [5.27796417]


portfolio before change:  [-1.71550407]
curr_Stock_Price:  108.27550104806144
curr_Factors:  [108.27550105]
mat_Sqrt:  [[0.15]]
grads:  [0.35447886]
Stock Position:  0.35447886470820256
Bond Position:  [-40.09688076]


portfolio before change:  [-2.04610523]
curr_Stock_Price:  107.37114336919356
curr_Factors:  [107.37114337]
mat_Sqrt:  [[0.15]]
grads:  [-0.02736179]
Stock Position:  -0.027361788098466008
Bond Position:  [0.89176124]


portfolio before change:  [-2.03546417]
curr_Stock_Price:  106.99039023879509
curr_Factors:  [106.99039024]
mat_Sqrt:  [[0.15]]
grads:  [-0.02951066]
Stock Position:  -0.029510661146229973
Bond Position:  [1.12189298]


portfolio before change:  [-2.00741071]
curr_Stock_Price:  106.04927419728646
curr_Factors:  [106.0492742]
mat_Sqrt:  [[0.15]]
grads:  [0.10667253]
Stock Position:  0.10667253362272922
Bond Position:  [-13.31995548]


portfolio before change:  [-1.95836022]
curr_Stock_Price:  106.54031808456548
curr_Factors:  [106.54031808]
mat_Sqrt:  [[0.15]]
grads:  [0.09138415]
Stock Position:  0.09138415098903409
Bond Position:  [-11.69445673]


portfolio before change:  [-1.95600605]
curr_Stock_Price:  106.59807584324005
curr_Factors:  [106.59807584]
mat_Sqrt:  [[0.15]]
grads:  [-0.02822026]
Stock Position:  -0.028220255780571815
Bond Position:  [1.05221891]


portfolio before change:  [-1.98383844]
curr_Stock_Price:  107.59365399140735
curr_Factors:  [107.59365399]
mat_Sqrt:  [[0.15]]
grads:  [0.14099374]
Stock Position:  0.14099374281258062
Bond Position:  [-17.15387042]


portfolio before change:  [-2.03657211]
curr_Stock_Price:  107.25005951463845
curr_Factors:  [107.25005951]
mat_Sqrt:  [[0.15]]
grads:  [0.13180753]
Stock Position:  0.13180752973417265
Bond Position:  [-16.17293752]


portfolio before change:  [-2.08215823]
curr_Stock_Price:  106.93488500318469
curr_Factors:  [106.934885]
mat_Sqrt:  [[0.15]]
grads:  [0.06173575]
Stock Position:  0.06173575328456946
Bond Position:  [-8.6838639]


portfolio before change:  [-2.06098169]
curr_Stock_Price:  107.31307389150899
curr_Factors:  [107.31307389]
mat_Sqrt:  [[0.15]]
grads:  [0.09981413]
Stock Position:  0.099814128748179
Bond Position:  [-12.77234266]


portfolio before change:  [-2.12411155]
curr_Stock_Price:  106.7125940385767
curr_Factors:  [106.71259404]
mat_Sqrt:  [[0.15]]
grads:  [-0.10730349]
Stock Position:  -0.10730348749411256
Bond Position:  [9.32652195]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.03910884]
Stock Price:  105.9421550920542
PL:  [-7.98126393]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-5.54109243e-03]
 [ 3.19152457e-02]
 [-1.64321640e-02]
 [-1.94415490e-02]
 [ 4.48319736e-03]
 [-9.74934227e-03]
 [ 1.46302610e-02]
 [ 9.72005569e-03]
 [-5.76177205e-04]
 [ 7.33828983e-03]
 [-2.94887448e-03]
 [-4.44546803e-03]
 [ 4.83462195e-03]
 [-4.03340145e-04]
 [ 2.25813814e-04]
 [ 2.29661739e-02]
 [ 8.90136769e-04]
 [ 1.25428694e-02]
 [-9.14924719e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.00146062]
curr_Stock_Price:  100.33593458606408
curr_Factors:  [100.33593459]
mat_Sqrt:  [[0.15]]
grads:  [-0.03694062]
Stock Position:  -0.03694061623198983
Bond Position:  [12.70793188]


portfolio before change:  [8.94323206]
curr_Stock_Price:  101.9982224863233
curr_Factors:  [101.99822249]
mat_Sqrt:  [[0.15]]
grads:  [0.2127683]
Stock Position:  0.2127683046166334
Bond Position:  [-12.75875681]


portfolio before change:  [8.7523027]
curr_Stock_Price:  101.1158576218246
curr_Factors:  [101.11585762]
mat_Sqrt:  [[0.15]]
grads:  [-0.10954776]
Stock Position:  -0.10954776030437592
Bond Position:  [19.82931843]


portfolio before change:  [8.88769873]
curr_Stock_Price:  99.92516164841695
curr_Factors:  [99.92516165]
mat_Sqrt:  [[0.15]]
grads:  [-0.12961033]
Stock Position:  -0.12961032691929497
Bond Position:  [21.8390316]


portfolio before change:  [9.00329201]
curr_Stock_Price:  99.07543894015242
curr_Factors:  [99.07543894]
mat_Sqrt:  [[0.15]]
grads:  [0.02988798]
Stock Position:  0.02988798238159818
Bond Position:  [6.04212703]


portfolio before change:  [9.05004957]
curr_Stock_Price:  100.58931995076384
curr_Factors:  [100.58931995]
mat_Sqrt:  [[0.15]]
grads:  [-0.06499562]
Stock Position:  -0.06499561512173266
Bond Position:  [15.5879143]


portfolio before change:  [9.11758191]
curr_Stock_Price:  99.61025584411567
curr_Factors:  [99.61025584]
mat_Sqrt:  [[0.15]]
grads:  [0.09753507]
Stock Position:  0.09753507337268627
Bond Position:  [-0.5979117]


portfolio before change:  [9.19336523]
curr_Stock_Price:  100.38877386662121
curr_Factors:  [100.38877387]
mat_Sqrt:  [[0.15]]
grads:  [0.06480037]
Stock Position:  0.06480037126380307
Bond Position:  [2.68813541]


portfolio before change:  [9.14499593]
curr_Stock_Price:  99.6319661329089
curr_Factors:  [99.63196613]
mat_Sqrt:  [[0.15]]
grads:  [-0.00384118]
Stock Position:  -0.00384118136608161
Bond Position:  [9.52770038]


portfolio before change:  [9.14742289]
curr_Stock_Price:  99.62031763790348
curr_Factors:  [99.62031764]
mat_Sqrt:  [[0.15]]
grads:  [0.04892193]
Stock Position:  0.04892193220116396
Bond Position:  [4.27380447]


portfolio before change:  [9.19665964]
curr_Stock_Price:  100.60491009174115
curr_Factors:  [100.60491009]
mat_Sqrt:  [[0.15]]
grads:  [-0.01965916]
Stock Position:  -0.01965916321090248
Bond Position:  [11.17446799]


portfolio before change:  [9.21502704]
curr_Stock_Price:  99.81273832785737
curr_Factors:  [99.81273833]
mat_Sqrt:  [[0.15]]
grads:  [-0.02963645]
Stock Position:  -0.029636453529798823
Bond Position:  [12.17312262]


portfolio before change:  [9.22404684]
curr_Stock_Price:  99.61109023412861
curr_Factors:  [99.61109023]
mat_Sqrt:  [[0.15]]
grads:  [0.03223081]
Stock Position:  0.03223081301096268
Bond Position:  [6.01350042]


portfolio before change:  [9.24617735]
curr_Stock_Price:  100.25106639796994
curr_Factors:  [100.2510664]
mat_Sqrt:  [[0.15]]
grads:  [-0.00268893]
Stock Position:  -0.0026889343030285333
Bond Position:  [9.51574588]


portfolio before change:  [9.2439629]
curr_Stock_Price:  101.9594325435797
curr_Factors:  [101.95943254]
mat_Sqrt:  [[0.15]]
grads:  [0.00150543]
Stock Position:  0.0015054254263204467
Bond Position:  [9.09047058]


portfolio before change:  [9.24714379]
curr_Stock_Price:  102.56257432282106
curr_Factors:  [102.56257432]
mat_Sqrt:  [[0.15]]
grads:  [0.15310783]
Stock Position:  0.15310782606649792
Bond Position:  [-6.455989]


portfolio before change:  [9.21109463]
curr_Stock_Price:  102.33766771679221
curr_Factors:  [102.33766772]
mat_Sqrt:  [[0.15]]
grads:  [0.00593425]
Stock Position:  0.0059342451274062655
Bond Position:  [8.60379782]


portfolio before change:  [9.21698484]
curr_Stock_Price:  102.96773858086023
curr_Factors:  [102.96773858]
mat_Sqrt:  [[0.15]]
grads:  [0.08361913]
Stock Position:  0.083619129613735
Bond Position:  [0.60691216]


portfolio before change:  [9.18570654]
curr_Stock_Price:  102.59186711366031
curr_Factors:  [102.59186711]
mat_Sqrt:  [[0.15]]
grads:  [-0.06099498]
Stock Position:  -0.06099498125586955
Bond Position:  [15.44329556]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.34220643]
Stock Price:  100.08938944673429
PL:  [9.25281698]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.77992096e-02]
 [-4.78907880e-03]
 [-7.18349556e-03]
 [-1.52480401e-02]
 [ 5.91011455e-03]
 [-1.07466594e-02]
 [ 1.29983027e-02]
 [-4.57009312e-02]
 [-1.85445763e-03]
 [ 9.29796655e-03]
 [-3.11703413e-03]
 [-5.60227220e-03]
 [ 4.80940459e-03]
 [ 9.06262883e-05]
 [ 5.04379320e-03]
 [ 1.67675074e-02]
 [ 3.67180639e-03]
 [ 9.49029920e-03]
 [-6.09911256e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [26.97507454]
curr_Stock_Price:  101.15143160700622
curr_Factors:  [101.15143161]
mat_Sqrt:  [[0.15]]
grads:  [-0.1186614]
Stock Position:  -0.11866139757038623
Bond Position:  [38.97784478]


portfolio before change:  [27.24292824]
curr_Stock_Price:  98.97626742568981
curr_Factors:  [98.97626743]
mat_Sqrt:  [[0.15]]
grads:  [-0.03192719]
Stock Position:  -0.031927191978660986
Bond Position:  [30.40296253]


portfolio before change:  [27.26627255]
curr_Stock_Price:  98.4831886751066
curr_Factors:  [98.48318868]
mat_Sqrt:  [[0.15]]
grads:  [-0.04788997]
Stock Position:  -0.047889970381888455
Bond Position:  [31.98262954]


portfolio before change:  [27.25983744]
curr_Stock_Price:  98.78454114073958
curr_Factors:  [98.78454114]
mat_Sqrt:  [[0.15]]
grads:  [-0.1016536]
Stock Position:  -0.10165360042566922
Bond Position:  [37.30164172]


portfolio before change:  [27.04887597]
curr_Stock_Price:  100.95158732294524
curr_Factors:  [100.95158732]
mat_Sqrt:  [[0.15]]
grads:  [0.03940076]
Stock Position:  0.03940076364065842
Bond Position:  [23.07130634]


portfolio before change:  [26.9510624]
curr_Stock_Price:  98.32265054954439
curr_Factors:  [98.32265055]
mat_Sqrt:  [[0.15]]
grads:  [-0.0716444]
Stock Position:  -0.07164439599658477
Bond Position:  [33.99532932]


portfolio before change:  [27.00595495]
curr_Stock_Price:  97.67510998576007
curr_Factors:  [97.67510999]
mat_Sqrt:  [[0.15]]
grads:  [0.08665535]
Stock Position:  0.08665535157170705
Bond Position:  [18.54188396]


portfolio before change:  [26.99951295]
curr_Stock_Price:  97.54726964564931
curr_Factors:  [97.54726965]
mat_Sqrt:  [[0.15]]
grads:  [-0.30467287]
Stock Position:  -0.3046728747655844
Bond Position:  [56.71952002]


portfolio before change:  [26.77884214]
curr_Stock_Price:  98.31810449164753
curr_Factors:  [98.31810449]
mat_Sqrt:  [[0.15]]
grads:  [-0.01236305]
Stock Position:  -0.012363050885311165
Bond Position:  [27.99435387]


portfolio before change:  [26.77563557]
curr_Stock_Price:  99.14363157274283
curr_Factors:  [99.14363157]
mat_Sqrt:  [[0.15]]
grads:  [0.06198644]
Stock Position:  0.061986443653953206
Bond Position:  [20.63007443]


portfolio before change:  [26.80882803]
curr_Stock_Price:  99.5958966662609
curr_Factors:  [99.59589667]
mat_Sqrt:  [[0.15]]
grads:  [-0.02078023]
Stock Position:  -0.02078022755656112
Bond Position:  [28.87845343]


portfolio before change:  [26.7914046]
curr_Stock_Price:  100.78182923903164
curr_Factors:  [100.78182924]
mat_Sqrt:  [[0.15]]
grads:  [-0.03734848]
Stock Position:  -0.0373484813027986
Bond Position:  [30.55545287]


portfolio before change:  [26.83532975]
curr_Stock_Price:  99.81029494088334
curr_Factors:  [99.81029494]
mat_Sqrt:  [[0.15]]
grads:  [0.0320627]
Stock Position:  0.03206269723370478
Bond Position:  [23.63514248]


portfolio before change:  [26.88908554]
curr_Stock_Price:  101.302566993664
curr_Factors:  [101.30256699]
mat_Sqrt:  [[0.15]]
grads:  [0.00060418]
Stock Position:  0.000604175255644993
Bond Position:  [26.82788104]


portfolio before change:  [26.89480761]
curr_Stock_Price:  99.6710281083934
curr_Factors:  [99.67102811]
mat_Sqrt:  [[0.15]]
grads:  [0.03362529]
Stock Position:  0.03362528801346641
Bond Position:  [23.54334059]


portfolio before change:  [26.88719741]
curr_Stock_Price:  99.26964043165313
curr_Factors:  [99.26964043]
mat_Sqrt:  [[0.15]]
grads:  [0.11178338]
Stock Position:  0.11178338270657867
Bond Position:  [15.7905012]


portfolio before change:  [27.03072156]
curr_Stock_Price:  100.5182699398396
curr_Factors:  [100.51826994]
mat_Sqrt:  [[0.15]]
grads:  [0.02447871]
Stock Position:  0.024478709244466833
Bond Position:  [24.57016405]


portfolio before change:  [27.03760976]
curr_Stock_Price:  100.54870015977889
curr_Factors:  [100.54870016]
mat_Sqrt:  [[0.15]]
grads:  [0.06326866]
Stock Position:  0.06326866134193124
Bond Position:  [20.6760281]


portfolio before change:  [27.10839948]
curr_Stock_Price:  101.58586563523612
curr_Factors:  [101.58586564]
mat_Sqrt:  [[0.15]]
grads:  [-0.04066075]
Stock Position:  -0.04066075037407659
Bond Position:  [31.23895701]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [27.08823]
Stock Price:  102.27400352836707
PL:  [24.81422647]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.22073450e-03]
 [-5.34774290e-03]
 [-4.52528076e-03]
 [-6.37327932e-03]
 [-6.05722624e-03]
 [-1.14607258e-02]
 [ 1.31549511e-02]
 [-4.41725720e-02]
 [ 4.76355816e-04]
 [ 9.93841408e-03]
 [-9.64042395e-03]
 [ 2.44036480e-02]
 [ 8.45502022e-03]
 [-2.44996476e-03]
 [ 5.58849780e-03]
 [ 2.43094255e-02]
 [ 1.96555007e-02]
 [-2.75485365e-03]
 [-1.28144514e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.21012417]
curr_Stock_Price:  99.87261557749216
curr_Factors:  [99.87261558]
mat_Sqrt:  [[0.15]]
grads:  [0.0148049]
Stock Position:  0.014804896636129324
Bond Position:  [-2.68872792]


portfolio before change:  [-1.2228176]
curr_Stock_Price:  99.06064367873702
curr_Factors:  [99.06064368]
mat_Sqrt:  [[0.15]]
grads:  [-0.03565162]
Stock Position:  -0.03565161933603149
Bond Position:  [2.30885476]


portfolio before change:  [-1.22907343]
curr_Stock_Price:  99.25230741977859
curr_Factors:  [99.25230742]
mat_Sqrt:  [[0.15]]
grads:  [-0.03016854]
Stock Position:  -0.030168538400736813
Bond Position:  [1.76522362]


portfolio before change:  [-1.18647604]
curr_Stock_Price:  97.85495649438788
curr_Factors:  [97.85495649]
mat_Sqrt:  [[0.15]]
grads:  [-0.04248853]
Stock Position:  -0.042488528806893175
Bond Position:  [2.9712371]


portfolio before change:  [-1.12868707]
curr_Stock_Price:  96.51233381435718
curr_Factors:  [96.51233381]
mat_Sqrt:  [[0.15]]
grads:  [-0.04038151]
Stock Position:  -0.040381508265434206
Bond Position:  [2.76862653]


portfolio before change:  [-1.11147636]
curr_Stock_Price:  96.103273712116
curr_Factors:  [96.10327371]
mat_Sqrt:  [[0.15]]
grads:  [-0.07640484]
Stock Position:  -0.07640483897552319
Bond Position:  [6.23127879]


portfolio before change:  [-1.09182806]
curr_Stock_Price:  95.86650477991064
curr_Factors:  [95.86650478]
mat_Sqrt:  [[0.15]]
grads:  [0.08769967]
Stock Position:  0.08769967409690471
Bond Position:  [-9.49928928]


portfolio before change:  [-1.10639884]
curr_Stock_Price:  95.7274431020252
curr_Factors:  [95.7274431]
mat_Sqrt:  [[0.15]]
grads:  [-0.29448381]
Stock Position:  -0.2944838131172423
Bond Position:  [27.08378362]


portfolio before change:  [-1.56566498]
curr_Stock_Price:  97.31000183932656
curr_Factors:  [97.31000184]
mat_Sqrt:  [[0.15]]
grads:  [0.00317571]
Stock Position:  0.0031757054420487037
Bond Position:  [-1.87469288]


portfolio before change:  [-1.56543501]
curr_Stock_Price:  97.53001646253134
curr_Factors:  [97.53001646]
mat_Sqrt:  [[0.15]]
grads:  [0.06625609]
Stock Position:  0.06625609384149465
Bond Position:  [-8.02739293]


portfolio before change:  [-1.66019695]
curr_Stock_Price:  96.13007213916252
curr_Factors:  [96.13007214]
mat_Sqrt:  [[0.15]]
grads:  [-0.06426949]
Stock Position:  -0.064269493000315
Bond Position:  [4.51803405]


portfolio before change:  [-1.49052573]
curr_Stock_Price:  93.50765264127473
curr_Factors:  [93.50765264]
mat_Sqrt:  [[0.15]]
grads:  [0.16269099]
Stock Position:  0.16269098691440273
Bond Position:  [-16.70337802]


portfolio before change:  [-1.66809491]
curr_Stock_Price:  92.44187259053905
curr_Factors:  [92.44187259]
mat_Sqrt:  [[0.15]]
grads:  [0.0563668]
Stock Position:  0.0563668014834601
Bond Position:  [-6.87874759]


portfolio before change:  [-1.72409546]
curr_Stock_Price:  91.47888278153238
curr_Factors:  [91.47888278]
mat_Sqrt:  [[0.15]]
grads:  [-0.0163331]
Stock Position:  -0.016333098432562212
Bond Position:  [-0.22996187]


portfolio before change:  [-1.71341825]
curr_Stock_Price:  90.82164630907504
curr_Factors:  [90.82164631]
mat_Sqrt:  [[0.15]]
grads:  [0.03725665]
Stock Position:  0.03725665197843019
Bond Position:  [-5.09712872]


portfolio before change:  [-1.7562759]
curr_Stock_Price:  89.70551788558268
curr_Factors:  [89.70551789]
mat_Sqrt:  [[0.15]]
grads:  [0.16206284]
Stock Position:  0.1620628366266828
Bond Position:  [-16.29420659]


portfolio before change:  [-1.74176857]
curr_Stock_Price:  89.82017336885762
curr_Factors:  [89.82017337]
mat_Sqrt:  [[0.15]]
grads:  [0.13103667]
Stock Position:  0.1310366716395769
Bond Position:  [-13.51150513]


portfolio before change:  [-1.97473548]
curr_Stock_Price:  88.0680790573333
curr_Factors:  [88.06807906]
mat_Sqrt:  [[0.15]]
grads:  [-0.01836569]
Stock Position:  -0.018365691019760443
Bond Position:  [-0.35730435]


portfolio before change:  [-1.98013878]
curr_Stock_Price:  88.35742103708387
curr_Factors:  [88.35742104]
mat_Sqrt:  [[0.15]]
grads:  [-0.08542968]
Stock Position:  -0.08542967621939393
Bond Position:  [5.56820709]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.12693555]
Stock Price:  90.09205243775345
PL:  [-2.12693555]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 7.52413763e-04]
 [-6.99556775e-03]
 [-4.23998974e-03]
 [-1.87363681e-02]
 [ 4.36251144e-03]
 [-1.07461763e-02]
 [ 1.37300208e-02]
 [ 8.64414992e-03]
 [-7.70887319e-03]
 [ 2.40815835e-03]
 [-3.14722027e-03]
 [-6.21309192e-03]
 [ 5.98390728e-03]
 [ 2.61513926e-04]
 [ 7.02545504e-05]
 [ 2.18713820e-02]
 [ 1.76691178e-03]
 [ 1.28668345e-02]
 [-1.15936500e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-23.30861063]
curr_Stock_Price:  98.86996525009033
curr_Factors:  [98.86996525]
mat_Sqrt:  [[0.15]]
grads:  [0.00501609]
Stock Position:  0.005016091754753427
Bond Position:  [-23.80455144]


portfolio before change:  [-23.31240778]
curr_Stock_Price:  99.2995290998115
curr_Factors:  [99.2995291]
mat_Sqrt:  [[0.15]]
grads:  [-0.04663712]
Stock Position:  -0.046637118351445364
Bond Position:  [-18.68136389]


portfolio before change:  [-23.33160694]
curr_Stock_Price:  99.61104580354544
curr_Factors:  [99.6110458]
mat_Sqrt:  [[0.15]]
grads:  [-0.0282666]
Stock Position:  -0.028266598282122975
Bond Position:  [-20.51594153]


portfolio before change:  [-23.32412863]
curr_Stock_Price:  99.16500909660381
curr_Factors:  [99.1650091]
mat_Sqrt:  [[0.15]]
grads:  [-0.12490912]
Stock Position:  -0.12490912057458203
Bond Position:  [-10.93751455]


portfolio before change:  [-23.31254153]
curr_Stock_Price:  99.05035117909964
curr_Factors:  [99.05035118]
mat_Sqrt:  [[0.15]]
grads:  [0.02908341]
Stock Position:  0.02908340958954922
Bond Position:  [-26.19326346]


portfolio before change:  [-23.34019644]
curr_Stock_Price:  98.32465303220425
curr_Factors:  [98.32465303]
mat_Sqrt:  [[0.15]]
grads:  [-0.07164118]
Stock Position:  -0.07164117511508394
Bond Position:  [-16.29610275]


portfolio before change:  [-23.37331202]
curr_Stock_Price:  98.73002111313532
curr_Factors:  [98.73002111]
mat_Sqrt:  [[0.15]]
grads:  [0.09153347]
Stock Position:  0.09153347216725834
Bond Position:  [-32.41041366]


portfolio before change:  [-23.23341096]
curr_Stock_Price:  100.3469670683182
curr_Factors:  [100.34696707]
mat_Sqrt:  [[0.15]]
grads:  [0.05762767]
Stock Position:  0.057627666100929474
Bond Position:  [-29.01617247]


portfolio before change:  [-23.25310263]
curr_Stock_Price:  100.13115542739584
curr_Factors:  [100.13115543]
mat_Sqrt:  [[0.15]]
grads:  [-0.05139249]
Stock Position:  -0.051392487917769764
Bond Position:  [-18.10711344]


portfolio before change:  [-23.29655964]
curr_Stock_Price:  100.88865252770509
curr_Factors:  [100.88865253]
mat_Sqrt:  [[0.15]]
grads:  [0.01605439]
Stock Position:  0.016054388997200658
Bond Position:  [-24.91626531]


portfolio before change:  [-23.27266876]
curr_Stock_Price:  102.76482004766005
curr_Factors:  [102.76482005]
mat_Sqrt:  [[0.15]]
grads:  [-0.02098147]
Stock Position:  -0.020981468479203166
Bond Position:  [-21.11651193]


portfolio before change:  [-23.24290217]
curr_Stock_Price:  101.09447088462754
curr_Factors:  [101.09447088]
mat_Sqrt:  [[0.15]]
grads:  [-0.04142061]
Stock Position:  -0.041420612815617895
Bond Position:  [-19.05550723]


portfolio before change:  [-23.25381688]
curr_Stock_Price:  101.24295343344286
curr_Factors:  [101.24295343]
mat_Sqrt:  [[0.15]]
grads:  [0.03989272]
Stock Position:  0.03989271521858888
Bond Position:  [-27.29267319]


portfolio before change:  [-23.23642474]
curr_Stock_Price:  101.8499855932848
curr_Factors:  [101.84998559]
mat_Sqrt:  [[0.15]]
grads:  [0.00174343]
Stock Position:  0.0017434261738908388
Bond Position:  [-23.41399267]


portfolio before change:  [-23.2407316]
curr_Stock_Price:  102.7375299853962
curr_Factors:  [102.73752999]
mat_Sqrt:  [[0.15]]
grads:  [0.00046836]
Stock Position:  0.0004683636696041551
Bond Position:  [-23.28885013]


portfolio before change:  [-23.24721416]
curr_Stock_Price:  101.32917488028076
curr_Factors:  [101.32917488]
mat_Sqrt:  [[0.15]]
grads:  [0.14580921]
Stock Position:  0.14580921329409813
Bond Position:  [-38.02194144]


portfolio before change:  [-23.23357249]
curr_Stock_Price:  101.48793267246062
curr_Factors:  [101.48793267]
mat_Sqrt:  [[0.15]]
grads:  [0.01177941]
Stock Position:  0.011779411848484956
Bond Position:  [-24.42904064]


portfolio before change:  [-23.21580457]
curr_Stock_Price:  103.51485418275792
curr_Factors:  [103.51485418]
mat_Sqrt:  [[0.15]]
grads:  [0.0857789]
Stock Position:  0.08577889665911971
Bond Position:  [-32.09519455]


portfolio before change:  [-23.21816894]
curr_Stock_Price:  103.58084283990134
curr_Factors:  [103.58084284]
mat_Sqrt:  [[0.15]]
grads:  [-0.077291]
Stock Position:  -0.07729100025188243
Bond Position:  [-15.21230199]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-23.29335074]
Stock Price:  104.50434305484485
PL:  [-27.7976938]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.39631965e-04]
 [-8.78950402e-04]
 [-8.48071789e-03]
 [-1.81577865e-02]
 [ 3.44522118e-03]
 [-1.05318790e-02]
 [ 1.43431018e-02]
 [-3.26762679e-02]
 [ 1.90354864e-03]
 [ 7.85650178e-03]
 [-4.49687309e-03]
 [-4.36465812e-03]
 [ 5.68989097e-03]
 [-1.14978012e-03]
 [ 8.25775620e-03]
 [ 1.80580550e-02]
 [ 7.08846106e-03]
 [ 5.06087800e-04]
 [-9.46135001e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-49.98376708]
curr_Stock_Price:  97.65966270735319
curr_Factors:  [97.65966271]
mat_Sqrt:  [[0.15]]
grads:  [-0.00159755]
Stock Position:  -0.0015975464330488544
Bond Position:  [-49.82775123]


portfolio before change:  [-49.99638243]
curr_Stock_Price:  97.75784726031645
curr_Factors:  [97.75784726]
mat_Sqrt:  [[0.15]]
grads:  [-0.00585967]
Stock Position:  -0.005859669349207854
Bond Position:  [-49.42355377]


portfolio before change:  [-50.01189193]
curr_Stock_Price:  98.29577311925225
curr_Factors:  [98.29577312]
mat_Sqrt:  [[0.15]]
grads:  [-0.05653812]
Stock Position:  -0.05653811927846378
Bond Position:  [-44.45443378]


portfolio before change:  [-50.06905026]
curr_Stock_Price:  99.11014995688853
curr_Factors:  [99.11014996]
mat_Sqrt:  [[0.15]]
grads:  [-0.12105191]
Stock Position:  -0.12105190978031233
Bond Position:  [-38.07157733]


portfolio before change:  [-50.04824804]
curr_Stock_Price:  98.85966813035505
curr_Factors:  [98.85966813]
mat_Sqrt:  [[0.15]]
grads:  [0.02296814]
Stock Position:  0.0229681411683434
Bond Position:  [-52.31887085]


portfolio before change:  [-50.05718093]
curr_Stock_Price:  99.04028641744524
curr_Factors:  [99.04028642]
mat_Sqrt:  [[0.15]]
grads:  [-0.07021253]
Stock Position:  -0.07021252634553424
Bond Position:  [-43.10331221]


portfolio before change:  [-50.09223184]
curr_Stock_Price:  99.3860044985139
curr_Factors:  [99.3860045]
mat_Sqrt:  [[0.15]]
grads:  [0.09562068]
Stock Position:  0.09562067891964851
Bond Position:  [-59.59558907]


portfolio before change:  [-50.19921924]
curr_Stock_Price:  98.42296351186371
curr_Factors:  [98.42296351]
mat_Sqrt:  [[0.15]]
grads:  [-0.21784179]
Stock Position:  -0.21784178589537426
Bond Position:  [-28.75858509]


portfolio before change:  [-49.79771232]
curr_Stock_Price:  96.54684293795543
curr_Factors:  [96.54684294]
mat_Sqrt:  [[0.15]]
grads:  [0.01269032]
Stock Position:  0.012690324235584197
Bond Position:  [-51.02292306]


portfolio before change:  [-49.81487393]
curr_Stock_Price:  96.1997849398307
curr_Factors:  [96.19978494]
mat_Sqrt:  [[0.15]]
grads:  [0.05237668]
Stock Position:  0.05237667855519185
Bond Position:  [-54.85349914]


portfolio before change:  [-49.71219895]
curr_Stock_Price:  98.42195840670261
curr_Factors:  [98.42195841]
mat_Sqrt:  [[0.15]]
grads:  [-0.02997915]
Stock Position:  -0.029979153930484115
Bond Position:  [-46.76159191]


portfolio before change:  [-49.76132397]
curr_Stock_Price:  99.67059817826218
curr_Factors:  [99.67059818]
mat_Sqrt:  [[0.15]]
grads:  [-0.02909772]
Stock Position:  -0.029097720817939966
Bond Position:  [-46.86113674]


portfolio before change:  [-49.71026088]
curr_Stock_Price:  97.51304639126575
curr_Factors:  [97.51304639]
mat_Sqrt:  [[0.15]]
grads:  [0.03793261]
Stock Position:  0.037932606494862756
Bond Position:  [-53.4091849]


portfolio before change:  [-49.73573964]
curr_Stock_Price:  97.19340618921235
curr_Factors:  [97.19340619]
mat_Sqrt:  [[0.15]]
grads:  [-0.0076652]
Stock Position:  -0.007665200807886393
Bond Position:  [-48.99073266]


portfolio before change:  [-49.74476749]
curr_Stock_Price:  96.77314871782743
curr_Factors:  [96.77314872]
mat_Sqrt:  [[0.15]]
grads:  [0.05505171]
Stock Position:  0.05505170799451637
Bond Position:  [-55.07229462]


portfolio before change:  [-49.6935563]
curr_Stock_Price:  97.9535114861624
curr_Factors:  [97.95351149]
mat_Sqrt:  [[0.15]]
grads:  [0.12038703]
Stock Position:  0.12038703337900222
Bond Position:  [-61.48588896]


portfolio before change:  [-49.83667172]
curr_Stock_Price:  96.89241692425844
curr_Factors:  [96.89241692]
mat_Sqrt:  [[0.15]]
grads:  [0.04725641]
Stock Position:  0.0472564070692656
Bond Position:  [-54.41545922]


portfolio before change:  [-49.9148638]
curr_Stock_Price:  95.5256919593687
curr_Factors:  [95.52569196]
mat_Sqrt:  [[0.15]]
grads:  [0.00337392]
Stock Position:  0.003373918665881305
Bond Position:  [-50.23715971]


portfolio before change:  [-49.93096667]
curr_Stock_Price:  94.4758706084588
curr_Factors:  [94.47587061]
mat_Sqrt:  [[0.15]]
grads:  [-0.06307567]
Stock Position:  -0.06307566671716965
Bond Position:  [-43.97183814]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-49.8514735]
Stock Price:  93.04128410258754
PL:  [-49.8514735]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.73780259e-03]
 [-4.13583142e-03]
 [-4.59272154e-03]
 [-1.67520054e-02]
 [ 1.00405344e-03]
 [-1.12499986e-02]
 [ 1.32189635e-02]
 [-5.02902299e-02]
 [ 5.71240670e-03]
 [ 4.64867747e-03]
 [-1.60457611e-02]
 [ 3.00983713e-02]
 [ 8.74674582e-03]
 [-2.50990906e-03]
 [ 5.83753081e-03]
 [ 2.38799657e-02]
 [ 2.12662465e-02]
 [-2.60610305e-03]
 [-1.28301772e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.02903404]
curr_Stock_Price:  99.42711297630932
curr_Factors:  [99.42711298]
mat_Sqrt:  [[0.15]]
grads:  [0.01825202]
Stock Position:  0.018252017296732558
Bond Position:  [-12.84377943]


portfolio before change:  [-11.04234119]
curr_Stock_Price:  98.87397936484035
curr_Factors:  [98.87397936]
mat_Sqrt:  [[0.15]]
grads:  [-0.02757221]
Stock Position:  -0.027572209447194098
Bond Position:  [-8.31616712]


portfolio before change:  [-11.07006888]
curr_Stock_Price:  99.80420537990085
curr_Factors:  [99.80420538]
mat_Sqrt:  [[0.15]]
grads:  [-0.03061814]
Stock Position:  -0.030618143604118915
Bond Position:  [-8.01424939]


portfolio before change:  [-11.04674087]
curr_Stock_Price:  98.97685858121777
curr_Factors:  [98.97685858]
mat_Sqrt:  [[0.15]]
grads:  [-0.11168004]
Stock Position:  -0.1116800360015983
Bond Position:  [0.00699826]


portfolio before change:  [-10.97601754]
curr_Stock_Price:  98.34360682227423
curr_Factors:  [98.34360682]
mat_Sqrt:  [[0.15]]
grads:  [0.00669369]
Stock Position:  0.006693689626493769
Bond Position:  [-11.63429912]


portfolio before change:  [-10.98991114]
curr_Stock_Price:  96.70256005991955
curr_Factors:  [96.70256006]
mat_Sqrt:  [[0.15]]
grads:  [-0.07499999]
Stock Position:  -0.07499999059466582
Bond Position:  [-3.73722004]


portfolio before change:  [-10.92027158]
curr_Stock_Price:  95.7615735445058
curr_Factors:  [95.76157354]
mat_Sqrt:  [[0.15]]
grads:  [0.08812642]
Stock Position:  0.08812642326076454
Bond Position:  [-19.35939654]


portfolio before change:  [-10.98332489]
curr_Stock_Price:  95.10101281843612
curr_Factors:  [95.10101282]
mat_Sqrt:  [[0.15]]
grads:  [-0.3352682]
Stock Position:  -0.33526819906145205
Bond Position:  [20.90102041]


portfolio before change:  [-10.73761268]
curr_Stock_Price:  94.3837175175739
curr_Factors:  [94.38371752]
mat_Sqrt:  [[0.15]]
grads:  [0.03808271]
Stock Position:  0.0380827113206207
Bond Position:  [-14.33200054]


portfolio before change:  [-10.74927093]
curr_Stock_Price:  94.17168424500535
curr_Factors:  [94.17168425]
mat_Sqrt:  [[0.15]]
grads:  [0.03099118]
Stock Position:  0.030991183145124453
Bond Position:  [-13.66776284]


portfolio before change:  [-10.76896593]
curr_Stock_Price:  93.64644979048468
curr_Factors:  [93.64644979]
mat_Sqrt:  [[0.15]]
grads:  [-0.10697174]
Stock Position:  -0.10697174094853815
Bond Position:  [-0.75144216]


portfolio before change:  [-10.63352439]
curr_Stock_Price:  92.37855018181746
curr_Factors:  [92.37855018]
mat_Sqrt:  [[0.15]]
grads:  [0.20065581]
Stock Position:  0.20065580846527764
Bond Position:  [-29.16981706]


portfolio before change:  [-10.69692435]
curr_Stock_Price:  92.09893404673804
curr_Factors:  [92.09893405]
mat_Sqrt:  [[0.15]]
grads:  [0.05831164]
Stock Position:  0.05831163877319176
Bond Position:  [-16.06736413]


portfolio before change:  [-10.75226783]
curr_Stock_Price:  91.21873016371727
curr_Factors:  [91.21873016]
mat_Sqrt:  [[0.15]]
grads:  [-0.01673273]
Stock Position:  -0.01673272703968309
Bond Position:  [-9.22592972]


portfolio before change:  [-10.75735548]
curr_Stock_Price:  91.3849242632924
curr_Factors:  [91.38492426]
mat_Sqrt:  [[0.15]]
grads:  [0.03891687]
Stock Position:  0.038916872096324676
Bond Position:  [-14.31377089]


portfolio before change:  [-10.79292278]
curr_Stock_Price:  90.56295666376882
curr_Factors:  [90.56295666]
mat_Sqrt:  [[0.15]]
grads:  [0.15919977]
Stock Position:  0.15919977108375097
Bond Position:  [-25.21052475]


portfolio before change:  [-11.05020498]
curr_Stock_Price:  88.98645452391732
curr_Factors:  [88.98645452]
mat_Sqrt:  [[0.15]]
grads:  [0.14177498]
Stock Position:  0.1417749766658309
Bond Position:  [-23.66625749]


portfolio before change:  [-11.15429024]
curr_Stock_Price:  88.29403357873481
curr_Factors:  [88.29403358]
mat_Sqrt:  [[0.15]]
grads:  [-0.01737402]
Stock Position:  -0.017374020337006617
Bond Position:  [-9.62026791]


portfolio before change:  [-11.15729836]
curr_Stock_Price:  88.32872597370194
curr_Factors:  [88.32872597]
mat_Sqrt:  [[0.15]]
grads:  [-0.08553451]
Stock Position:  -0.08553451482466858
Bond Position:  [-3.60214364]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.19885028]
Stock Price:  88.80398755881988
PL:  [-11.19885028]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 1.49007347e-03]
 [-3.20891837e-03]
 [-1.22748066e-02]
 [-5.67832475e-03]
 [ 6.03927299e-03]
 [-9.83509011e-03]
 [ 8.60887090e-03]
 [ 1.45689702e-02]
 [-6.82853704e-04]
 [ 4.29715056e-03]
 [-4.88353627e-03]
 [ 4.27473295e-03]
 [ 5.84456517e-03]
 [-1.69645160e-03]
 [ 7.60964757e-03]
 [ 2.07185187e-02]
 [ 7.93718104e-03]
 [ 4.78750074e-04]
 [-1.03199085e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-36.00051389]
curr_Stock_Price:  98.29410947901395
curr_Factors:  [98.29410948]
mat_Sqrt:  [[0.15]]
grads:  [0.00993382]
Stock Position:  0.009933823115127484
Bond Position:  [-36.97695018]


portfolio before change:  [-36.00572423]
curr_Stock_Price:  98.7003029141797
curr_Factors:  [98.70030291]
mat_Sqrt:  [[0.15]]
grads:  [-0.02139279]
Stock Position:  -0.021392789147935222
Bond Position:  [-33.89424946]


portfolio before change:  [-35.98220871]
curr_Stock_Price:  97.20493297240911
curr_Factors:  [97.20493297]
mat_Sqrt:  [[0.15]]
grads:  [-0.08183204]
Stock Position:  -0.08183204424351515
Bond Position:  [-28.02773034]


portfolio before change:  [-36.03914456]
curr_Stock_Price:  97.81506123658895
curr_Factors:  [97.81506124]
mat_Sqrt:  [[0.15]]
grads:  [-0.0378555]
Stock Position:  -0.037855498344490784
Bond Position:  [-32.33630668]


portfolio before change:  [-36.10905412]
curr_Stock_Price:  99.44823143051595
curr_Factors:  [99.44823143]
mat_Sqrt:  [[0.15]]
grads:  [0.04026182]
Stock Position:  0.040261819923675245
Bond Position:  [-40.11302091]


portfolio before change:  [-36.08385661]
curr_Stock_Price:  100.32318013206655
curr_Factors:  [100.32318013]
mat_Sqrt:  [[0.15]]
grads:  [-0.06556727]
Stock Position:  -0.06556726738201502
Bond Position:  [-29.50593983]


portfolio before change:  [-36.12419193]
curr_Stock_Price:  100.82583824738852
curr_Factors:  [100.82583825]
mat_Sqrt:  [[0.15]]
grads:  [0.05739247]
Stock Position:  0.05739247268349321
Bond Position:  [-41.9108361]


portfolio before change:  [-36.1413209]
curr_Stock_Price:  100.70997030128224
curr_Factors:  [100.7099703]
mat_Sqrt:  [[0.15]]
grads:  [0.09712647]
Stock Position:  0.09712646829234285
Bond Position:  [-45.92292464]


portfolio before change:  [-36.27165698]
curr_Stock_Price:  99.48626768211786
curr_Factors:  [99.48626768]
mat_Sqrt:  [[0.15]]
grads:  [-0.00455236]
Stock Position:  -0.004552358027532467
Bond Position:  [-35.81875987]


portfolio before change:  [-36.2840621]
curr_Stock_Price:  100.24396514869676
curr_Factors:  [100.24396515]
mat_Sqrt:  [[0.15]]
grads:  [0.02864767]
Stock Position:  0.028647670369223353
Bond Position:  [-39.15581817]


portfolio before change:  [-36.35637041]
curr_Stock_Price:  98.06165395617339
curr_Factors:  [98.06165396]
mat_Sqrt:  [[0.15]]
grads:  [-0.03255691]
Stock Position:  -0.03255690845360346
Bond Position:  [-33.16378612]


portfolio before change:  [-36.34485703]
curr_Stock_Price:  97.45332346741284
curr_Factors:  [97.45332347]
mat_Sqrt:  [[0.15]]
grads:  [0.02849822]
Stock Position:  0.028498219676694206
Bond Position:  [-39.12210325]


portfolio before change:  [-36.36278007]
curr_Stock_Price:  97.16764628538508
curr_Factors:  [97.16764629]
mat_Sqrt:  [[0.15]]
grads:  [0.03896377]
Stock Position:  0.03896376780806443
Bond Position:  [-40.14879768]


portfolio before change:  [-36.46705578]
curr_Stock_Price:  94.74905944508293
curr_Factors:  [94.74905945]
mat_Sqrt:  [[0.15]]
grads:  [-0.01130968]
Stock Position:  -0.011309677349701019
Bond Position:  [-35.39547449]


portfolio before change:  [-36.48141014]
curr_Stock_Price:  95.23575611785289
curr_Factors:  [95.23575612]
mat_Sqrt:  [[0.15]]
grads:  [0.05073098]
Stock Position:  0.05073098379422578
Bond Position:  [-41.31281374]


portfolio before change:  [-36.43764222]
curr_Stock_Price:  96.3021146064899
curr_Factors:  [96.30211461]
mat_Sqrt:  [[0.15]]
grads:  [0.13812346]
Stock Position:  0.1381234581342922
Bond Position:  [-49.73922331]


portfolio before change:  [-36.48065037]
curr_Stock_Price:  96.08077785600429
curr_Factors:  [96.08077786]
mat_Sqrt:  [[0.15]]
grads:  [0.05291454]
Stock Position:  0.052914540277463444
Bond Position:  [-41.56472056]


portfolio before change:  [-36.5302014]
curr_Stock_Price:  95.3407441511993
curr_Factors:  [95.34074415]
mat_Sqrt:  [[0.15]]
grads:  [0.00319167]
Stock Position:  0.0031916671569970126
Bond Position:  [-36.83449732]


portfolio before change:  [-36.5471717]
curr_Stock_Price:  92.90924739345894
curr_Factors:  [92.90924739]
mat_Sqrt:  [[0.15]]
grads:  [-0.06879939]
Stock Position:  -0.06879938966789136
Bond Position:  [-30.15507219]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-36.55330628]
Stock Price:  92.88882379488979
PL:  [-36.55330628]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-9.52200340e-03]
 [ 1.51583395e-02]
 [-5.51954004e-02]
 [ 4.86044397e-02]
 [ 5.50016826e-03]
 [-1.78924358e-02]
 [-1.07344809e-02]
 [-1.28804352e-04]
 [ 2.63563788e-03]
 [ 2.50639445e-03]
 [-3.23946969e-03]
 [ 8.78049349e-03]
 [ 1.05960999e-02]
 [-1.37729013e-03]
 [ 1.37987667e-02]
 [ 2.06434786e-02]
 [ 8.86140845e-03]
 [ 1.44838993e-02]
 [-1.61398345e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.5323432]
curr_Stock_Price:  100.49613743859463
curr_Factors:  [100.49613744]
mat_Sqrt:  [[0.15]]
grads:  [-0.06348002]
Stock Position:  -0.06348002267695409
Bond Position:  [18.91184028]


portfolio before change:  [12.49284257]
curr_Stock_Price:  101.19287915277584
curr_Factors:  [101.19287915]
mat_Sqrt:  [[0.15]]
grads:  [0.1010556]
Stock Position:  0.10105559643856356
Bond Position:  [2.26673581]


portfolio before change:  [12.73278903]
curr_Stock_Price:  103.56167135877561
curr_Factors:  [103.56167136]
mat_Sqrt:  [[0.15]]
grads:  [-0.36796934]
Stock Position:  -0.3679693361555419
Bond Position:  [50.84030849]


portfolio before change:  [13.03832594]
curr_Stock_Price:  102.76588427879943
curr_Factors:  [102.76588428]
mat_Sqrt:  [[0.15]]
grads:  [0.3240296]
Stock Position:  0.3240295981190498
Bond Position:  [-20.26086224]


portfolio before change:  [13.2351961]
curr_Stock_Price:  103.38908664422134
curr_Factors:  [103.38908664]
mat_Sqrt:  [[0.15]]
grads:  [0.03666779]
Stock Position:  0.03666778840196997
Bond Position:  [9.44414695]


portfolio before change:  [13.29647194]
curr_Stock_Price:  104.99579680181466
curr_Factors:  [104.9957968]
mat_Sqrt:  [[0.15]]
grads:  [-0.11928291]
Stock Position:  -0.11928290538982547
Bond Position:  [25.82067564]


portfolio before change:  [13.27960585]
curr_Stock_Price:  105.1913157948404
curr_Factors:  [105.19131579]
mat_Sqrt:  [[0.15]]
grads:  [-0.07156321]
Stock Position:  -0.07156320600081317
Bond Position:  [20.80743365]


portfolio before change:  [13.36748508]
curr_Stock_Price:  104.03601920348308
curr_Factors:  [104.0360192]
mat_Sqrt:  [[0.15]]
grads:  [-0.0008587]
Stock Position:  -0.0008586956766891418
Bond Position:  [13.45682036]


portfolio before change:  [13.37102804]
curr_Stock_Price:  103.8283422560947
curr_Factors:  [103.82834226]
mat_Sqrt:  [[0.15]]
grads:  [0.01757092]
Stock Position:  0.017570919195240946
Bond Position:  [11.54666863]


portfolio before change:  [13.35094464]
curr_Stock_Price:  102.52104415683905
curr_Factors:  [102.52104416]
mat_Sqrt:  [[0.15]]
grads:  [0.0167093]
Stock Position:  0.016709296336430306
Bond Position:  [11.63789013]


portfolio before change:  [13.36731946]
curr_Stock_Price:  103.32688214913779
curr_Factors:  [103.32688215]
mat_Sqrt:  [[0.15]]
grads:  [-0.02159646]
Stock Position:  -0.02159646457999836
Bond Position:  [15.59881481]


portfolio before change:  [13.33736424]
curr_Stock_Price:  104.89451880391555
curr_Factors:  [104.8945188]
mat_Sqrt:  [[0.15]]
grads:  [0.05853662]
Stock Position:  0.05853662327682236
Bond Position:  [7.19719331]


portfolio before change:  [13.31066996]
curr_Stock_Price:  104.40774986105673
curr_Factors:  [104.40774986]
mat_Sqrt:  [[0.15]]
grads:  [0.07064067]
Stock Position:  0.0706406662816522
Bond Position:  [5.93523694]


portfolio before change:  [13.30319551]
curr_Stock_Price:  104.28093285810348
curr_Factors:  [104.28093286]
mat_Sqrt:  [[0.15]]
grads:  [-0.00918193]
Stock Position:  -0.00918193421208824
Bond Position:  [14.26069618]


portfolio before change:  [13.29146924]
curr_Stock_Price:  105.94636596936603
curr_Factors:  [105.94636597]
mat_Sqrt:  [[0.15]]
grads:  [0.09199178]
Stock Position:  0.09199177784516877
Bond Position:  [3.54527467]


portfolio before change:  [13.31149428]
curr_Stock_Price:  106.15441300108907
curr_Factors:  [106.154413]
mat_Sqrt:  [[0.15]]
grads:  [0.13762319]
Stock Position:  0.13762319080326893
Bond Position:  [-1.29781475]


portfolio before change:  [13.38376582]
curr_Stock_Price:  106.68191153007236
curr_Factors:  [106.68191153]
mat_Sqrt:  [[0.15]]
grads:  [0.05907606]
Stock Position:  0.05907605634265445
Bond Position:  [7.0814192]


portfolio before change:  [13.3622708]
curr_Stock_Price:  106.28808717267793
curr_Factors:  [106.28808717]
mat_Sqrt:  [[0.15]]
grads:  [0.09655933]
Stock Position:  0.09655932854196517
Bond Position:  [3.09916447]


portfolio before change:  [13.29319902]
curr_Stock_Price:  105.56473217163499
curr_Factors:  [105.56473217]
mat_Sqrt:  [[0.15]]
grads:  [-0.1075989]
Stock Position:  -0.10759889694099148
Bond Position:  [24.65184776]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.07873976]
Stock Price:  107.61515271908206
PL:  [5.46358704]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.01353219e-02]
 [ 3.49623818e-02]
 [-5.29083885e-03]
 [-2.11264285e-02]
 [ 6.30607236e-03]
 [-9.74375166e-03]
 [ 1.01979759e-02]
 [-5.61780214e-03]
 [-1.70010422e-03]
 [ 9.86827601e-03]
 [-8.01263043e-03]
 [ 6.73964088e-03]
 [ 6.11786616e-03]
 [-1.47814719e-03]
 [ 7.76567214e-03]
 [ 2.17848058e-02]
 [ 1.27373228e-02]
 [ 1.43769297e-04]
 [-9.94973682e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [36.52049777]
curr_Stock_Price:  101.58452559980037
curr_Factors:  [101.5845256]
mat_Sqrt:  [[0.15]]
grads:  [-0.13423548]
Stock Position:  -0.13423547962830987
Bond Position:  [50.15674529]


portfolio before change:  [36.46149103]
curr_Stock_Price:  102.11752552734704
curr_Factors:  [102.11752553]
mat_Sqrt:  [[0.15]]
grads:  [0.23308255]
Stock Position:  0.23308254547400437
Bond Position:  [12.65967824]


portfolio before change:  [36.05237342]
curr_Stock_Price:  100.34869759402707
curr_Factors:  [100.34869759]
mat_Sqrt:  [[0.15]]
grads:  [-0.03527226]
Stock Position:  -0.03527225898381164
Bond Position:  [39.59189867]


portfolio before change:  [36.07953951]
curr_Stock_Price:  99.85916644319404
curr_Factors:  [99.85916644]
mat_Sqrt:  [[0.15]]
grads:  [-0.14084286]
Stock Position:  -0.1408428564420609
Bond Position:  [50.14398975]


portfolio before change:  [36.10349405]
curr_Stock_Price:  99.77810459552067
curr_Factors:  [99.7781046]
mat_Sqrt:  [[0.15]]
grads:  [0.04204048]
Stock Position:  0.04204048243305966
Bond Position:  [31.9087744]


portfolio before change:  [36.14604188]
curr_Stock_Price:  100.60039852107099
curr_Factors:  [100.60039852]
mat_Sqrt:  [[0.15]]
grads:  [-0.06495834]
Stock Position:  -0.06495834437266533
Bond Position:  [42.68087721]


portfolio before change:  [36.15460118]
curr_Stock_Price:  100.63291550505924
curr_Factors:  [100.63291551]
mat_Sqrt:  [[0.15]]
grads:  [0.06798651]
Stock Position:  0.06798650587932252
Bond Position:  [29.31292088]


portfolio before change:  [36.10918663]
curr_Stock_Price:  99.85711889172727
curr_Factors:  [99.85711889]
mat_Sqrt:  [[0.15]]
grads:  [-0.03745201]
Stock Position:  -0.03745201428302129
Bond Position:  [39.84903687]


portfolio before change:  [36.15138668]
curr_Stock_Price:  98.99637609284457
curr_Factors:  [98.99637609]
mat_Sqrt:  [[0.15]]
grads:  [-0.01133403]
Stock Position:  -0.011334028117478953
Bond Position:  [37.27341439]


portfolio before change:  [36.17798692]
curr_Stock_Price:  97.47170020173694
curr_Factors:  [97.4717002]
mat_Sqrt:  [[0.15]]
grads:  [0.06578851]
Stock Position:  0.06578850670795142
Bond Position:  [29.76546932]


portfolio before change:  [36.13868891]
curr_Stock_Price:  96.76123709334296
curr_Factors:  [96.76123709]
mat_Sqrt:  [[0.15]]
grads:  [-0.05341754]
Stock Position:  -0.053417536226778375
Bond Position:  [41.3074358]


portfolio before change:  [36.1389564]
curr_Stock_Price:  96.94957705234488
curr_Factors:  [96.94957705]
mat_Sqrt:  [[0.15]]
grads:  [0.04493094]
Stock Position:  0.04493093916686268
Bond Position:  [31.78292085]


portfolio before change:  [36.12860941]
curr_Stock_Price:  96.54242514682691
curr_Factors:  [96.54242515]
mat_Sqrt:  [[0.15]]
grads:  [0.04078577]
Stock Position:  0.04078577441846445
Bond Position:  [32.19105184]


portfolio before change:  [36.10215566]
curr_Stock_Price:  95.69648019909155
curr_Factors:  [95.6964802]
mat_Sqrt:  [[0.15]]
grads:  [-0.00985431]
Stock Position:  -0.009854314572798385
Bond Position:  [37.04517888]


portfolio before change:  [36.11343228]
curr_Stock_Price:  95.4920859568823
curr_Factors:  [95.49208596]
mat_Sqrt:  [[0.15]]
grads:  [0.05177115]
Stock Position:  0.05177114761983384
Bond Position:  [31.1696974]


portfolio before change:  [36.08260262]
curr_Stock_Price:  94.74605166898792
curr_Factors:  [94.74605167]
mat_Sqrt:  [[0.15]]
grads:  [0.14523204]
Stock Position:  0.14523203895296374
Bond Position:  [22.32244036]


portfolio before change:  [35.90066686]
curr_Stock_Price:  93.45489666873883
curr_Factors:  [93.45489667]
mat_Sqrt:  [[0.15]]
grads:  [0.08491549]
Stock Position:  0.08491548561345408
Bond Position:  [27.96489892]


portfolio before change:  [35.87535739]
curr_Stock_Price:  93.07450007401421
curr_Factors:  [93.07450007]
mat_Sqrt:  [[0.15]]
grads:  [0.00095846]
Stock Position:  0.0009584619806009623
Bond Position:  [35.78614903]


portfolio before change:  [35.88479406]
curr_Stock_Price:  93.58470457144827
curr_Factors:  [93.58470457]
mat_Sqrt:  [[0.15]]
grads:  [-0.06633158]
Stock Position:  -0.0663315788280734
Bond Position:  [42.09241527]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [35.94032822]
Stock Price:  92.90614784483424
PL:  [35.94032822]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.74175118e-02]
 [-1.05305414e-02]
 [-5.11864193e-03]
 [-1.88006976e-02]
 [ 6.55764049e-03]
 [-1.00212221e-02]
 [ 9.82176676e-03]
 [ 1.18886706e-02]
 [-1.64773259e-02]
 [ 1.95627278e-03]
 [-3.26066373e-03]
 [-8.39359817e-05]
 [ 9.57009729e-03]
 [-2.07606585e-03]
 [ 4.22772393e-03]
 [ 2.25193982e-02]
 [ 9.17465052e-04]
 [ 1.05507174e-02]
 [-8.09569822e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.92709312]
curr_Stock_Price:  101.10388269845554
curr_Factors:  [101.1038827]
mat_Sqrt:  [[0.15]]
grads:  [-0.11611675]
Stock Position:  -0.11611674514107523
Bond Position:  [37.6669469]


portfolio before change:  [26.09368118]
curr_Stock_Price:  99.75032986406003
curr_Factors:  [99.75032986]
mat_Sqrt:  [[0.15]]
grads:  [-0.07020361]
Stock Position:  -0.07020360964549541
Bond Position:  [33.0965144]


portfolio before change:  [26.06921422]
curr_Stock_Price:  100.21671795834628
curr_Factors:  [100.21671796]
mat_Sqrt:  [[0.15]]
grads:  [-0.03412428]
Stock Position:  -0.034124279513037085
Bond Position:  [29.48903751]


portfolio before change:  [26.08579052]
curr_Stock_Price:  99.94702359589171
curr_Factors:  [99.9470236]
mat_Sqrt:  [[0.15]]
grads:  [-0.12533798]
Stock Position:  -0.12533798376997846
Bond Position:  [38.61294894]


portfolio before change:  [26.0396699]
curr_Stock_Price:  100.39202091411845
curr_Factors:  [100.39202091]
mat_Sqrt:  [[0.15]]
grads:  [0.0437176]
Stock Position:  0.04371760329783157
Bond Position:  [21.65077136]


portfolio before change:  [26.01697738]
curr_Stock_Price:  99.74912457106171
curr_Factors:  [99.74912457]
mat_Sqrt:  [[0.15]]
grads:  [-0.06680815]
Stock Position:  -0.06680814728700687
Bond Position:  [32.68103159]


portfolio before change:  [25.96230931]
curr_Stock_Price:  100.68971873753883
curr_Factors:  [100.68971874]
mat_Sqrt:  [[0.15]]
grads:  [0.06547845]
Stock Position:  0.0654784450625096
Bond Position:  [19.36930309]


portfolio before change:  [26.01865358]
curr_Stock_Price:  101.47625762516326
curr_Factors:  [101.47625763]
mat_Sqrt:  [[0.15]]
grads:  [0.0792578]
Stock Position:  0.07925780386284041
Bond Position:  [17.97586826]


portfolio before change:  [25.97765116]
curr_Stock_Price:  100.90222014074172
curr_Factors:  [100.90222014]
mat_Sqrt:  [[0.15]]
grads:  [-0.10984884]
Stock Position:  -0.10984883963573339
Bond Position:  [37.06164296]


portfolio before change:  [25.75269767]
curr_Stock_Price:  103.03442341989822
curr_Factors:  [103.03442342]
mat_Sqrt:  [[0.15]]
grads:  [0.01304182]
Stock Position:  0.013041818550344796
Bond Position:  [24.40894142]


portfolio before change:  [25.76429898]
curr_Stock_Price:  103.45601434623843
curr_Factors:  [103.45601435]
mat_Sqrt:  [[0.15]]
grads:  [-0.02173776]
Stock Position:  -0.021737758215515175
Bond Position:  [28.01320081]


portfolio before change:  [25.77085063]
curr_Stock_Price:  103.47683186016934
curr_Factors:  [103.47683186]
mat_Sqrt:  [[0.15]]
grads:  [-0.00055957]
Stock Position:  -0.0005595732116141922
Bond Position:  [25.8287535]


portfolio before change:  [25.77719081]
curr_Stock_Price:  103.6873799630492
curr_Factors:  [103.68737996]
mat_Sqrt:  [[0.15]]
grads:  [0.06380065]
Stock Position:  0.0638006485760489
Bond Position:  [19.16186872]


portfolio before change:  [25.85602488]
curr_Stock_Price:  104.84791674979003
curr_Factors:  [104.84791675]
mat_Sqrt:  [[0.15]]
grads:  [-0.01384044]
Stock Position:  -0.013840438984266755
Bond Position:  [27.30716607]


portfolio before change:  [25.87766904]
curr_Stock_Price:  103.7773929038575
curr_Factors:  [103.7773929]
mat_Sqrt:  [[0.15]]
grads:  [0.02818483]
Stock Position:  0.028184826199146036
Bond Position:  [22.95272126]


portfolio before change:  [25.88399748]
curr_Stock_Price:  103.79830971733348
curr_Factors:  [103.79830972]
mat_Sqrt:  [[0.15]]
grads:  [0.15012932]
Stock Position:  0.15012932117712263
Bond Position:  [10.3008277]


portfolio before change:  [25.67599337]
curr_Stock_Price:  102.39565475626661
curr_Factors:  [102.39565476]
mat_Sqrt:  [[0.15]]
grads:  [0.00611643]
Stock Position:  0.0061164336785588065
Bond Position:  [25.04969714]


portfolio before change:  [25.6754938]
curr_Stock_Price:  101.28998184308873
curr_Factors:  [101.28998184]
mat_Sqrt:  [[0.15]]
grads:  [0.07033812]
Stock Position:  0.07033811625030088
Bond Position:  [18.55094728]


portfolio before change:  [25.75226587]
curr_Stock_Price:  102.31551051329082
curr_Factors:  [102.31551051]
mat_Sqrt:  [[0.15]]
grads:  [-0.05397132]
Stock Position:  -0.05397132145067529
Bond Position:  [31.27436918]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [25.72536179]
Stock Price:  102.95888277274906
PL:  [22.76647902]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 3.34649659e-04]
 [-8.01025455e-04]
 [-1.23944275e-02]
 [ 1.33612037e-02]
 [-2.72140307e-06]
 [-1.15041718e-02]
 [ 1.26176124e-02]
 [-3.49000879e-02]
 [-2.46993728e-03]
 [ 8.40343888e-03]
 [-7.89336700e-03]
 [ 6.06347804e-03]
 [ 4.87727139e-03]
 [-5.81359382e-04]
 [ 7.73515612e-03]
 [ 1.80987390e-02]
 [ 6.70298774e-03]
 [ 1.71147613e-03]
 [-5.50682806e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-25.31995612]
curr_Stock_Price:  98.77870668253533
curr_Factors:  [98.77870668]
mat_Sqrt:  [[0.15]]
grads:  [0.002231]
Stock Position:  0.0022309977286241274
Bond Position:  [-25.54033119]


portfolio before change:  [-25.32794738]
curr_Stock_Price:  98.0591276497452
curr_Factors:  [98.05912765]
mat_Sqrt:  [[0.15]]
grads:  [-0.00534017]
Stock Position:  -0.0053401696994424
Bond Position:  [-24.804295]


portfolio before change:  [-25.3293994]
curr_Stock_Price:  97.169675420171
curr_Factors:  [97.16967542]
mat_Sqrt:  [[0.15]]
grads:  [-0.08262952]
Stock Position:  -0.0826295167850833
Bond Position:  [-17.30031608]


portfolio before change:  [-25.29315402]
curr_Stock_Price:  96.67867652973908
curr_Factors:  [96.67867653]
mat_Sqrt:  [[0.15]]
grads:  [0.08907469]
Stock Position:  0.08907469146781297
Bond Position:  [-33.90477731]


portfolio before change:  [-25.17348845]
curr_Stock_Price:  98.11727628221506
curr_Factors:  [98.11727628]
mat_Sqrt:  [[0.15]]
grads:  [-1.81426871e-05]
Stock Position:  -1.8142687136964153e-05
Bond Position:  [-25.17170834]


portfolio before change:  [-25.17974338]
curr_Stock_Price:  95.97971793384471
curr_Factors:  [95.97971793]
mat_Sqrt:  [[0.15]]
grads:  [-0.07669448]
Stock Position:  -0.0766944787039872
Bond Position:  [-17.81862895]


portfolio before change:  [-25.28144533]
curr_Stock_Price:  97.24769360251582
curr_Factors:  [97.2476936]
mat_Sqrt:  [[0.15]]
grads:  [0.08411742]
Stock Position:  0.08411741569277686
Bond Position:  [-33.46167]


portfolio before change:  [-25.20394839]
curr_Stock_Price:  98.26845016934338
curr_Factors:  [98.26845017]
mat_Sqrt:  [[0.15]]
grads:  [-0.23266725]
Stock Position:  -0.232667252952558
Bond Position:  [-2.34009803]


portfolio before change:  [-25.26415886]
curr_Stock_Price:  98.52471904433914
curr_Factors:  [98.52471904]
mat_Sqrt:  [[0.15]]
grads:  [-0.01646625]
Stock Position:  -0.01646624852463661
Bond Position:  [-23.64182635]


portfolio before change:  [-25.23748103]
curr_Stock_Price:  96.54557803601965
curr_Factors:  [96.54557804]
mat_Sqrt:  [[0.15]]
grads:  [0.05602293]
Stock Position:  0.056022925849643114
Bond Position:  [-30.64624679]


portfolio before change:  [-25.230471]
curr_Stock_Price:  96.80748061100662
curr_Factors:  [96.80748061]
mat_Sqrt:  [[0.15]]
grads:  [-0.05262245]
Stock Position:  -0.052622446684149816
Bond Position:  [-20.13622451]


portfolio before change:  [-25.24963416]
curr_Stock_Price:  97.07596821702812
curr_Factors:  [97.07596822]
mat_Sqrt:  [[0.15]]
grads:  [0.04042319]
Stock Position:  0.04042318693066781
Bond Position:  [-29.17375417]


portfolio before change:  [-25.17317199]
curr_Stock_Price:  99.1479601782881
curr_Factors:  [99.14796018]
mat_Sqrt:  [[0.15]]
grads:  [0.03251514]
Stock Position:  0.03251514257178375
Bond Position:  [-28.39698205]


portfolio before change:  [-25.16355201]
curr_Stock_Price:  99.66218558417032
curr_Factors:  [99.66218558]
mat_Sqrt:  [[0.15]]
grads:  [-0.00387573]
Stock Position:  -0.003875729213629104
Bond Position:  [-24.77728837]


portfolio before change:  [-25.16611376]
curr_Stock_Price:  98.724724436826
curr_Factors:  [98.72472444]
mat_Sqrt:  [[0.15]]
grads:  [0.05156771]
Stock Position:  0.051567707497932734
Bond Position:  [-30.25712147]


portfolio before change:  [-25.21482407]
curr_Stock_Price:  97.92683981992
curr_Factors:  [97.92683982]
mat_Sqrt:  [[0.15]]
grads:  [0.12065826]
Stock Position:  0.12065825966755878
Bond Position:  [-37.03050614]


portfolio before change:  [-25.28456446]
curr_Stock_Price:  97.42557614197177
curr_Factors:  [97.42557614]
mat_Sqrt:  [[0.15]]
grads:  [0.04468658]
Stock Position:  0.04468658490121777
Bond Position:  [-29.63818074]


portfolio before change:  [-25.30323171]
curr_Stock_Price:  97.17367098119219
curr_Factors:  [97.17367098]
mat_Sqrt:  [[0.15]]
grads:  [0.01140984]
Stock Position:  0.011409840891847482
Bond Position:  [-26.41196783]


portfolio before change:  [-25.30968121]
curr_Stock_Price:  97.1871954308645
curr_Factors:  [97.18719543]
mat_Sqrt:  [[0.15]]
grads:  [-0.03671219]
Stock Position:  -0.036712187084315076
Bond Position:  [-21.74172671]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-25.32821364]
Stock Price:  97.543924870921
PL:  [-25.32821364]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-6.81464600e-03]
 [ 3.20441350e-02]
 [-4.07764469e-02]
 [ 6.02937239e-02]
 [ 5.64857484e-03]
 [-1.00576902e-02]
 [ 4.36961667e-03]
 [ 4.66621616e-03]
 [ 4.81172130e-04]
 [-8.76761795e-04]
 [-3.56703356e-03]
 [ 4.85183431e-03]
 [ 1.12244671e-02]
 [-1.92741061e-03]
 [ 5.97115249e-03]
 [ 2.16871753e-02]
 [ 3.36380269e-03]
 [ 1.39077005e-02]
 [-1.59374858e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.01830555]
curr_Stock_Price:  100.38207077302334
curr_Factors:  [100.38207077]
mat_Sqrt:  [[0.15]]
grads:  [-0.04543097]
Stock Position:  -0.045430973308094744
Bond Position:  [14.57876073]


portfolio before change:  [9.94829809]
curr_Stock_Price:  102.00326882523937
curr_Factors:  [102.00326883]
mat_Sqrt:  [[0.15]]
grads:  [0.21362757]
Stock Position:  0.21362756640333616
Bond Position:  [-11.84241199]


portfolio before change:  [10.06940809]
curr_Stock_Price:  102.58405044434092
curr_Factors:  [102.58405044]
mat_Sqrt:  [[0.15]]
grads:  [-0.27184298]
Stock Position:  -0.27184297901000243
Bond Position:  [37.95616196]


portfolio before change:  [9.84617617]
curr_Stock_Price:  103.44014075664755
curr_Factors:  [103.44014076]
mat_Sqrt:  [[0.15]]
grads:  [0.40195816]
Stock Position:  0.40195815934642176
Bond Position:  [-31.73243241]


portfolio before change:  [9.68452756]
curr_Stock_Price:  103.05772654142582
curr_Factors:  [103.05772654]
mat_Sqrt:  [[0.15]]
grads:  [0.03765717]
Stock Position:  0.037657165582647666
Bond Position:  [5.80366568]


portfolio before change:  [9.64141802]
curr_Stock_Price:  101.87440229298628
curr_Factors:  [101.87440229]
mat_Sqrt:  [[0.15]]
grads:  [-0.06705127]
Stock Position:  -0.06705126824454048
Bond Position:  [16.47222589]


portfolio before change:  [9.67934744]
curr_Stock_Price:  101.3701486128361
curr_Factors:  [101.37014861]
mat_Sqrt:  [[0.15]]
grads:  [0.02913078]
Stock Position:  0.02913077778064342
Bond Position:  [6.72635617]


portfolio before change:  [9.72946059]
curr_Stock_Price:  103.03269794715403
curr_Factors:  [103.03269795]
mat_Sqrt:  [[0.15]]
grads:  [0.03110811]
Stock Position:  0.031108107747197165
Bond Position:  [6.52430832]


portfolio before change:  [9.74968231]
curr_Stock_Price:  103.63030540903218
curr_Factors:  [103.63030541]
mat_Sqrt:  [[0.15]]
grads:  [0.00320781]
Stock Position:  0.0032078142032663493
Bond Position:  [9.41725555]


portfolio before change:  [9.7566284]
curr_Stock_Price:  105.0616479819208
curr_Factors:  [105.06164798]
mat_Sqrt:  [[0.15]]
grads:  [-0.00584508]
Stock Position:  -0.0058450786324158385
Bond Position:  [10.37072199]


portfolio before change:  [9.75769565]
curr_Stock_Price:  105.3226806144663
curr_Factors:  [105.32268061]
mat_Sqrt:  [[0.15]]
grads:  [-0.02378022]
Stock Position:  -0.023780223760564007
Bond Position:  [12.26229256]


portfolio before change:  [9.78588474]
curr_Stock_Price:  104.26620890024367
curr_Factors:  [104.2662089]
mat_Sqrt:  [[0.15]]
grads:  [0.03234556]
Stock Position:  0.03234556206488329
Bond Position:  [6.41333561]


portfolio before change:  [9.80599672]
curr_Stock_Price:  104.83841871352337
curr_Factors:  [104.83841871]
mat_Sqrt:  [[0.15]]
grads:  [0.07482978]
Stock Position:  0.0748297809165822
Bond Position:  [1.96096082]


portfolio before change:  [9.79817192]
curr_Stock_Price:  104.72729846852509
curr_Factors:  [104.72729847]
mat_Sqrt:  [[0.15]]
grads:  [-0.0128494]
Stock Position:  -0.012849404058718358
Bond Position:  [11.14385529]


portfolio before change:  [9.80855404]
curr_Stock_Price:  104.13615790668166
curr_Factors:  [104.13615791]
mat_Sqrt:  [[0.15]]
grads:  [0.03980768]
Stock Position:  0.03980768325550845
Bond Position:  [5.66313485]


portfolio before change:  [9.83812999]
curr_Stock_Price:  104.8435587741175
curr_Factors:  [104.84355877]
mat_Sqrt:  [[0.15]]
grads:  [0.14458117]
Stock Position:  0.144581168399859
Bond Position:  [-5.32027424]


portfolio before change:  [9.68934701]
curr_Stock_Price:  103.82369744893163
curr_Factors:  [103.82369745]
mat_Sqrt:  [[0.15]]
grads:  [0.02242535]
Stock Position:  0.022425351271328508
Bond Position:  [7.36106412]


portfolio before change:  [9.72195878]
curr_Stock_Price:  105.19586213278903
curr_Factors:  [105.19586213]
mat_Sqrt:  [[0.15]]
grads:  [0.092718]
Stock Position:  0.09271800305951226
Bond Position:  [-0.03159149]


portfolio before change:  [9.69558335]
curr_Stock_Price:  104.91147796825506
curr_Factors:  [104.91147797]
mat_Sqrt:  [[0.15]]
grads:  [-0.10624991]
Stock Position:  -0.10624990500237629
Bond Position:  [20.84241792]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.66238189]
Stock Price:  105.27300973726729
PL:  [4.38937215]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.88875570e-02]
 [ 2.21126855e-03]
 [-3.46165559e-02]
 [ 2.20094864e-02]
 [ 5.71595854e-03]
 [-9.51234079e-03]
 [ 1.44260452e-02]
 [-3.01600169e-02]
 [ 1.72382461e-03]
 [ 9.64878773e-03]
 [-7.61530290e-03]
 [-8.95513238e-05]
 [ 4.87785411e-03]
 [-9.90458732e-04]
 [ 7.79664822e-03]
 [ 1.68678794e-02]
 [ 5.67997461e-03]
 [ 3.37628137e-03]
 [-5.99232870e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [31.27474007]
curr_Stock_Price:  101.34651560376476
curr_Factors:  [101.3465156]
mat_Sqrt:  [[0.15]]
grads:  [-0.12591705]
Stock Position:  -0.12591704641531573
Bond Position:  [44.03599398]


portfolio before change:  [31.3640701]
curr_Stock_Price:  100.7245215978592
curr_Factors:  [100.7245216]
mat_Sqrt:  [[0.15]]
grads:  [0.01474179]
Stock Position:  0.01474179032547978
Bond Position:  [29.87921032]


portfolio before change:  [31.39302017]
curr_Stock_Price:  102.18155879138766
curr_Factors:  [102.18155879]
mat_Sqrt:  [[0.15]]
grads:  [-0.23077704]
Stock Position:  -0.23077703957932666
Bond Position:  [54.97417781]


portfolio before change:  [31.58183396]
curr_Stock_Price:  101.4229541912111
curr_Factors:  [101.42295419]
mat_Sqrt:  [[0.15]]
grads:  [0.14672991]
Stock Position:  0.14672990931836255
Bond Position:  [16.70005309]


portfolio before change:  [31.58046374]
curr_Stock_Price:  101.3851585347872
curr_Factors:  [101.38515853]
mat_Sqrt:  [[0.15]]
grads:  [0.03810639]
Stock Position:  0.03810639027082884
Bond Position:  [27.71704132]


portfolio before change:  [31.56770418]
curr_Stock_Price:  100.86845548609857
curr_Factors:  [100.86845549]
mat_Sqrt:  [[0.15]]
grads:  [-0.06341561]
Stock Position:  -0.0634156052702135
Bond Position:  [37.96433833]


portfolio before change:  [31.6387475]
curr_Stock_Price:  99.89785755368106
curr_Factors:  [99.89785755]
mat_Sqrt:  [[0.15]]
grads:  [0.09617363]
Stock Position:  0.09617363437842785
Bond Position:  [22.03120748]


portfolio before change:  [31.52074847]
curr_Stock_Price:  98.61364357509555
curr_Factors:  [98.61364358]
mat_Sqrt:  [[0.15]]
grads:  [-0.20106678]
Stock Position:  -0.20106677944083695
Bond Position:  [51.34867619]


portfolio before change:  [31.929829]
curr_Stock_Price:  96.6429462743463
curr_Factors:  [96.64294627]
mat_Sqrt:  [[0.15]]
grads:  [0.01149216]
Stock Position:  0.011492164050459722
Bond Position:  [30.81919241]


portfolio before change:  [31.94546419]
curr_Stock_Price:  97.33293189943454
curr_Factors:  [97.3329319]
mat_Sqrt:  [[0.15]]
grads:  [0.06432525]
Stock Position:  0.06432525150591804
Bond Position:  [25.68449887]


portfolio before change:  [31.9254804]
curr_Stock_Price:  96.92242871006883
curr_Factors:  [96.92242871]
mat_Sqrt:  [[0.15]]
grads:  [-0.05076869]
Stock Position:  -0.050768686006859
Bond Position:  [36.84610475]


portfolio before change:  [31.85538296]
curr_Stock_Price:  98.48461439537714
curr_Factors:  [98.4846144]
mat_Sqrt:  [[0.15]]
grads:  [-0.00059701]
Stock Position:  -0.000597008825539147
Bond Position:  [31.91417914]


portfolio before change:  [31.862976]
curr_Stock_Price:  99.13201850124099
curr_Factors:  [99.1320185]
mat_Sqrt:  [[0.15]]
grads:  [0.03251903]
Stock Position:  0.03251902740247209
Bond Position:  [28.63929917]


portfolio before change:  [31.83889192]
curr_Stock_Price:  98.17120267896024
curr_Factors:  [98.17120268]
mat_Sqrt:  [[0.15]]
grads:  [-0.00660306]
Stock Position:  -0.006603058215184387
Bond Position:  [32.48712209]


portfolio before change:  [31.84436934]
curr_Stock_Price:  98.57183166240391
curr_Factors:  [98.57183166]
mat_Sqrt:  [[0.15]]
grads:  [0.05197765]
Stock Position:  0.051977654768144615
Bond Position:  [26.7208367]


portfolio before change:  [31.91037225]
curr_Stock_Price:  99.71312721453123
curr_Factors:  [99.71312721]
mat_Sqrt:  [[0.15]]
grads:  [0.11245253]
Stock Position:  0.11245252952467161
Bond Position:  [20.69737887]


portfolio before change:  [31.80148686]
curr_Stock_Price:  98.69882918269663
curr_Factors:  [98.69882918]
mat_Sqrt:  [[0.15]]
grads:  [0.0378665]
Stock Position:  0.03786649739952708
Bond Position:  [28.0641079]


portfolio before change:  [31.77556065]
curr_Stock_Price:  97.828848730417
curr_Factors:  [97.82884873]
mat_Sqrt:  [[0.15]]
grads:  [0.02250854]
Stock Position:  0.02250854248187283
Bond Position:  [29.57357586]


portfolio before change:  [31.76281936]
curr_Stock_Price:  96.93427212410072
curr_Factors:  [96.93427212]
mat_Sqrt:  [[0.15]]
grads:  [-0.03994886]
Stock Position:  -0.0399488580179496
Bond Position:  [35.63523283]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [31.77080871]
Stock Price:  96.9573157019676
PL:  [31.77080871]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-8.03145498e-04]
 [-8.12619484e-04]
 [-1.45706283e-02]
 [-5.84287106e-03]
 [ 7.03752478e-04]
 [-1.11314364e-02]
 [ 1.27302840e-02]
 [-4.06763204e-02]
 [ 1.94620619e-03]
 [ 1.01665101e-02]
 [-3.47700831e-03]
 [ 4.34402190e-03]
 [ 6.02653518e-03]
 [-1.45787451e-03]
 [ 8.24778583e-03]
 [ 2.13301081e-02]
 [ 9.40429319e-03]
 [ 4.35046870e-04]
 [-9.72986462e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.26230173]
curr_Stock_Price:  100.07553804005553
curr_Factors:  [100.07553804]
mat_Sqrt:  [[0.15]]
grads:  [-0.0053543]
Stock Position:  -0.0053543033204916934
Bond Position:  [3.79813651]


portfolio before change:  [3.27428787]
curr_Stock_Price:  98.0143017792413
curr_Factors:  [98.01430178]
mat_Sqrt:  [[0.15]]
grads:  [-0.00541746]
Stock Position:  -0.005417463226815281
Bond Position:  [3.80527674]


portfolio before change:  [3.28328992]
curr_Stock_Price:  96.52825303374547
curr_Factors:  [96.52825303]
mat_Sqrt:  [[0.15]]
grads:  [-0.09713752]
Stock Position:  -0.09713752168761265
Bond Position:  [12.65980519]


portfolio before change:  [3.16054033]
curr_Stock_Price:  97.82450734654604
curr_Factors:  [97.82450735]
mat_Sqrt:  [[0.15]]
grads:  [-0.03895247]
Stock Position:  -0.03895247371442164
Bond Position:  [6.97104688]


portfolio before change:  [3.1446139]
curr_Stock_Price:  98.27812199975031
curr_Factors:  [98.278122]
mat_Sqrt:  [[0.15]]
grads:  [0.00469168]
Stock Position:  0.004691683184617204
Bond Position:  [2.68352409]


portfolio before change:  [3.13947476]
curr_Stock_Price:  97.03973849375255
curr_Factors:  [97.03973849]
mat_Sqrt:  [[0.15]]
grads:  [-0.07420958]
Stock Position:  -0.07420957616495884
Bond Position:  [10.34075263]


portfolio before change:  [3.17746604]
curr_Stock_Price:  96.5626334130688
curr_Factors:  [96.56263341]
mat_Sqrt:  [[0.15]]
grads:  [0.08486856]
Stock Position:  0.08486855988203096
Bond Position:  [-5.0176656]


portfolio before change:  [3.13571352]
curr_Stock_Price:  96.08544904110728
curr_Factors:  [96.08544904]
mat_Sqrt:  [[0.15]]
grads:  [-0.27117547]
Stock Position:  -0.27117546935999787
Bond Position:  [29.19173026]


portfolio before change:  [3.02407921]
curr_Stock_Price:  96.52403278046204
curr_Factors:  [96.52403278]
mat_Sqrt:  [[0.15]]
grads:  [0.01297471]
Stock Position:  0.012974707937038824
Bond Position:  [1.77170807]


portfolio before change:  [3.04201401]
curr_Stock_Price:  97.87218039106862
curr_Factors:  [97.87218039]
mat_Sqrt:  [[0.15]]
grads:  [0.06777673]
Stock Position:  0.06777673392539708
Bond Position:  [-3.59144272]


portfolio before change:  [3.1240018]
curr_Stock_Price:  99.09510385488775
curr_Factors:  [99.09510385]
mat_Sqrt:  [[0.15]]
grads:  [-0.02318006]
Stock Position:  -0.023180055431841325
Bond Position:  [5.4210318]


portfolio before change:  [3.16375366]
curr_Stock_Price:  97.4386611381925
curr_Factors:  [97.43866114]
mat_Sqrt:  [[0.15]]
grads:  [0.02896015]
Stock Position:  0.028960145989541594
Bond Position:  [0.34191581]


portfolio before change:  [3.14422245]
curr_Stock_Price:  96.76129240480032
curr_Factors:  [96.7612924]
mat_Sqrt:  [[0.15]]
grads:  [0.0401769]
Stock Position:  0.04017690119741288
Bond Position:  [-0.74334643]


portfolio before change:  [3.10479056]
curr_Stock_Price:  95.78446170529573
curr_Factors:  [95.78446171]
mat_Sqrt:  [[0.15]]
grads:  [-0.00971916]
Stock Position:  -0.009719163417787653
Bond Position:  [4.0357354]


portfolio before change:  [3.0955704]
curr_Stock_Price:  96.83694093355577
curr_Factors:  [96.83694093]
mat_Sqrt:  [[0.15]]
grads:  [0.05498524]
Stock Position:  0.054985238896491546
Bond Position:  [-2.22903193]


portfolio before change:  [3.02996214]
curr_Stock_Price:  95.65387917876264
curr_Factors:  [95.65387918]
mat_Sqrt:  [[0.15]]
grads:  [0.14220072]
Stock Position:  0.14220072088304853
Bond Position:  [-10.57208843]


portfolio before change:  [2.97389769]
curr_Stock_Price:  95.27820527794512
curr_Factors:  [95.27820528]
mat_Sqrt:  [[0.15]]
grads:  [0.06269529]
Stock Position:  0.06269528790732176
Bond Position:  [-2.99959682]


portfolio before change:  [2.95853178]
curr_Stock_Price:  95.04507904421995
curr_Factors:  [95.04507904]
mat_Sqrt:  [[0.15]]
grads:  [0.00290031]
Stock Position:  0.0029003124639906167
Bond Position:  [2.68287135]


portfolio before change:  [2.95613066]
curr_Stock_Price:  93.98590836702566
curr_Factors:  [93.98590837]
mat_Sqrt:  [[0.15]]
grads:  [-0.06486576]
Stock Position:  -0.06486576410588879
Bond Position:  [9.05259842]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.87445878]
Stock Price:  95.27989307762694
PL:  [2.87445878]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 4.24437379e-04]
 [-6.88839855e-03]
 [-1.55697789e-02]
 [ 3.37414261e-02]
 [-8.76343154e-03]
 [-1.10473818e-02]
 [ 1.31555685e-02]
 [-4.36460825e-02]
 [ 4.54796141e-03]
 [ 4.27390318e-03]
 [-1.35789681e-02]
 [ 2.38503262e-02]
 [ 8.03411486e-03]
 [-2.08433648e-03]
 [ 6.83290325e-03]
 [ 2.21607150e-02]
 [ 1.20224095e-02]
 [ 1.59557372e-04]
 [-1.14726586e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-24.8876688]
curr_Stock_Price:  98.79832037978696
curr_Factors:  [98.79832038]
mat_Sqrt:  [[0.15]]
grads:  [0.00282958]
Stock Position:  0.0028295825246533435
Bond Position:  [-25.1672268]


portfolio before change:  [-24.89964444]
curr_Stock_Price:  96.78988150054313
curr_Factors:  [96.7898815]
mat_Sqrt:  [[0.15]]
grads:  [-0.04592266]
Stock Position:  -0.045922657022725855
Bond Position:  [-20.45479591]


portfolio before change:  [-24.87922016]
curr_Stock_Price:  96.23375924270721
curr_Factors:  [96.23375924]
mat_Sqrt:  [[0.15]]
grads:  [-0.10379853]
Stock Position:  -0.10379852612800407
Bond Position:  [-14.89029779]


portfolio before change:  [-24.69904452]
curr_Stock_Price:  94.46207049078045
curr_Factors:  [94.46207049]
mat_Sqrt:  [[0.15]]
grads:  [0.22494284]
Stock Position:  0.2249428407397138
Bond Position:  [-45.947611]


portfolio before change:  [-24.43107212]
curr_Stock_Price:  95.70443384877728
curr_Factors:  [95.70443385]
mat_Sqrt:  [[0.15]]
grads:  [-0.05842288]
Stock Position:  -0.058422876921197825
Bond Position:  [-18.83974376]


portfolio before change:  [-24.52776053]
curr_Stock_Price:  97.27878095112831
curr_Factors:  [97.27878095]
mat_Sqrt:  [[0.15]]
grads:  [-0.07364921]
Stock Position:  -0.07364921230812925
Bond Position:  [-17.36325494]


portfolio before change:  [-24.57429534]
curr_Stock_Price:  97.85167853008176
curr_Factors:  [97.85167853]
mat_Sqrt:  [[0.15]]
grads:  [0.08770379]
Stock Position:  0.08770378972544159
Bond Position:  [-33.15625838]


portfolio before change:  [-24.76416074]
curr_Stock_Price:  95.78135408087124
curr_Factors:  [95.78135408]
mat_Sqrt:  [[0.15]]
grads:  [-0.29097388]
Stock Position:  -0.29097388356005494
Bond Position:  [3.10571183]


portfolio before change:  [-24.55512373]
curr_Stock_Price:  95.06561806473599
curr_Factors:  [95.06561806]
mat_Sqrt:  [[0.15]]
grads:  [0.03031974]
Stock Position:  0.03031974270507884
Bond Position:  [-27.43748881]


portfolio before change:  [-24.59627193]
curr_Stock_Price:  93.93473860270655
curr_Factors:  [93.9347386]
mat_Sqrt:  [[0.15]]
grads:  [0.02849269]
Stock Position:  0.028492687898441015
Bond Position:  [-27.27272512]


portfolio before change:  [-24.58405238]
curr_Stock_Price:  94.60293063089993
curr_Factors:  [94.60293063]
mat_Sqrt:  [[0.15]]
grads:  [-0.09052645]
Stock Position:  -0.09052645407677196
Bond Position:  [-16.01998453]


portfolio before change:  [-24.49883773]
curr_Stock_Price:  93.61736070652792
curr_Factors:  [93.61736071]
mat_Sqrt:  [[0.15]]
grads:  [0.15900217]
Stock Position:  0.1590021745438843
Bond Position:  [-39.38420165]


portfolio before change:  [-24.61691653]
curr_Stock_Price:  92.93666864558467
curr_Factors:  [92.93666865]
mat_Sqrt:  [[0.15]]
grads:  [0.05356077]
Stock Position:  0.053560765719736204
Bond Position:  [-29.59467566]


portfolio before change:  [-24.61740642]
curr_Stock_Price:  93.06567534363931
curr_Factors:  [93.06567534]
mat_Sqrt:  [[0.15]]
grads:  [-0.01389558]
Stock Position:  -0.013895576539796686
Bond Position:  [-23.32420521]


portfolio before change:  [-24.63116761]
curr_Stock_Price:  93.63631789328309
curr_Factors:  [93.63631789]
mat_Sqrt:  [[0.15]]
grads:  [0.04555269]
Stock Position:  0.045552688339130544
Bond Position:  [-28.89655362]


portfolio before change:  [-24.62202959]
curr_Stock_Price:  93.99552965815724
curr_Factors:  [93.99552966]
mat_Sqrt:  [[0.15]]
grads:  [0.1477381]
Stock Position:  0.14773809975064192
Bond Position:  [-38.50875053]


portfolio before change:  [-24.65375148]
curr_Stock_Price:  93.8459846061208
curr_Factors:  [93.84598461]
mat_Sqrt:  [[0.15]]
grads:  [0.0801494]
Stock Position:  0.0801493965129952
Bond Position:  [-32.17545051]


portfolio before change:  [-24.71506953]
curr_Stock_Price:  93.18131107545366
curr_Factors:  [93.18131108]
mat_Sqrt:  [[0.15]]
grads:  [0.00106372]
Stock Position:  0.001063715816104309
Bond Position:  [-24.81418797]


portfolio before change:  [-24.72380072]
curr_Stock_Price:  90.80580862467318
curr_Factors:  [90.80580862]
mat_Sqrt:  [[0.15]]
grads:  [-0.07648439]
Stock Position:  -0.07648439052901894
Bond Position:  [-17.77857379]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-24.8744046]
Stock Price:  92.71676959466349
PL:  [-24.8744046]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.41843713e-02]
 [ 1.39860607e-02]
 [-3.45958237e-02]
 [ 7.71445631e-02]
 [ 5.49847826e-03]
 [-1.20135312e-02]
 [ 9.39697019e-03]
 [ 1.15484601e-02]
 [-1.29427667e-02]
 [ 8.87828863e-03]
 [-3.79109546e-03]
 [-1.80562999e-03]
 [ 5.02755263e-03]
 [-1.31004066e-03]
 [ 8.20753690e-03]
 [ 1.89434391e-02]
 [ 6.36462564e-03]
 [ 3.98501381e-03]
 [-4.16284342e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.38009834]
curr_Stock_Price:  100.7160893022004
curr_Factors:  [100.7160893]
mat_Sqrt:  [[0.15]]
grads:  [-0.09456248]
Stock Position:  -0.09456247532781904
Bond Position:  [26.90406105]


portfolio before change:  [17.34687339]
curr_Stock_Price:  101.1385803668127
curr_Factors:  [101.13858037]
mat_Sqrt:  [[0.15]]
grads:  [0.0932404]
Stock Position:  0.09324040493790463
Bond Position:  [7.9166712]


portfolio before change:  [17.44597852]
curr_Stock_Price:  102.18025018494757
curr_Factors:  [102.18025018]
mat_Sqrt:  [[0.15]]
grads:  [-0.23063882]
Stock Position:  -0.23063882440111022
Bond Position:  [41.0127113]


portfolio before change:  [16.94147625]
curr_Stock_Price:  104.41212392650428
curr_Factors:  [104.41212393]
mat_Sqrt:  [[0.15]]
grads:  [0.51429709]
Stock Position:  0.5142970874141145
Bond Position:  [-36.75737498]


portfolio before change:  [16.40770701]
curr_Stock_Price:  103.39213225241743
curr_Factors:  [103.39213225]
mat_Sqrt:  [[0.15]]
grads:  [0.03665652]
Stock Position:  0.03665652174360786
Bond Position:  [12.61771106]


portfolio before change:  [16.3848483]
curr_Stock_Price:  102.68247606356789
curr_Factors:  [102.68247606]
mat_Sqrt:  [[0.15]]
grads:  [-0.08009021]
Stock Position:  -0.08009020775341692
Bond Position:  [24.60870914]


portfolio before change:  [16.54688432]
curr_Stock_Price:  100.73613237165311
curr_Factors:  [100.73613237]
mat_Sqrt:  [[0.15]]
grads:  [0.06264647]
Stock Position:  0.06264646792380994
Bond Position:  [10.23612143]


portfolio before change:  [16.5991212]
curr_Stock_Price:  101.52911449190681
curr_Factors:  [101.52911449]
mat_Sqrt:  [[0.15]]
grads:  [0.07698973]
Stock Position:  0.07698973423320284
Bond Position:  [8.78242166]


portfolio before change:  [16.51040793]
curr_Stock_Price:  100.3483187468803
curr_Factors:  [100.34831875]
mat_Sqrt:  [[0.15]]
grads:  [-0.08628511]
Stock Position:  -0.086285111367753
Bond Position:  [25.16897379]


portfolio before change:  [16.60853662]
curr_Stock_Price:  99.28399071052934
curr_Factors:  [99.28399071]
mat_Sqrt:  [[0.15]]
grads:  [0.05918859]
Stock Position:  0.059188590845220226
Bond Position:  [10.73205712]


portfolio before change:  [16.58839691]
curr_Stock_Price:  98.89839168346725
curr_Factors:  [98.89839168]
mat_Sqrt:  [[0.15]]
grads:  [-0.02527397]
Stock Position:  -0.025273969713277163
Bond Position:  [19.08795186]


portfolio before change:  [16.59290482]
curr_Stock_Price:  98.90886375599158
curr_Factors:  [98.90886376]
mat_Sqrt:  [[0.15]]
grads:  [-0.01203753]
Stock Position:  -0.012037533251084953
Bond Position:  [17.78352356]


portfolio before change:  [16.60052679]
curr_Stock_Price:  98.64506134110721
curr_Factors:  [98.64506134]
mat_Sqrt:  [[0.15]]
grads:  [0.03351702]
Stock Position:  0.03351701755883024
Bond Position:  [13.29423853]


portfolio before change:  [16.52993602]
curr_Stock_Price:  96.43977137436978
curr_Factors:  [96.43977137]
mat_Sqrt:  [[0.15]]
grads:  [-0.0087336]
Stock Position:  -0.008733604397307741
Bond Position:  [17.37220283]


portfolio before change:  [16.52856181]
curr_Stock_Price:  97.09446100446623
curr_Factors:  [97.094461]
mat_Sqrt:  [[0.15]]
grads:  [0.05471691]
Stock Position:  0.05471691263377629
Bond Position:  [11.21585267]


portfolio before change:  [16.54795341]
curr_Stock_Price:  97.39760824501042
curr_Factors:  [97.39760825]
mat_Sqrt:  [[0.15]]
grads:  [0.12628959]
Stock Position:  0.12628959420496755
Bond Position:  [4.24764899]


portfolio before change:  [16.61165083]
curr_Stock_Price:  97.89357446080506
curr_Factors:  [97.89357446]
mat_Sqrt:  [[0.15]]
grads:  [0.04243084]
Stock Position:  0.042430837622750156
Bond Position:  [12.45794446]


portfolio before change:  [16.62217612]
curr_Stock_Price:  98.06822139135419
curr_Factors:  [98.06822139]
mat_Sqrt:  [[0.15]]
grads:  [0.02656676]
Stock Position:  0.026566758734067154
Bond Position:  [14.01682134]


portfolio before change:  [16.6245717]
curr_Stock_Price:  98.02647539630176
curr_Factors:  [98.0264754]
mat_Sqrt:  [[0.15]]
grads:  [-0.02775229]
Stock Position:  -0.027752289497559448
Bond Position:  [19.34503083]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.62678905]
Stock Price:  98.12086449264233
PL:  [16.62678905]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.66625826e-03]
 [-1.88715912e-03]
 [-6.68115739e-03]
 [-2.24588043e-02]
 [ 6.22448807e-03]
 [-1.06632475e-02]
 [ 1.32158500e-02]
 [-4.53003791e-02]
 [ 2.65825674e-03]
 [ 8.36789447e-03]
 [-7.33199982e-03]
 [ 7.83240788e-03]
 [ 5.94443623e-03]
 [-1.02701741e-03]
 [ 8.12877537e-03]
 [ 1.67647676e-02]
 [ 4.73472225e-03]
 [ 7.05032208e-03]
 [-5.38784830e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.58175626]
curr_Stock_Price:  99.31129111783176
curr_Factors:  [99.31129112]
mat_Sqrt:  [[0.15]]
grads:  [0.01777506]
Stock Position:  0.017775055033990076
Bond Position:  [-15.34701993]


portfolio before change:  [-13.59966408]
curr_Stock_Price:  98.5196995077213
curr_Factors:  [98.51969951]
mat_Sqrt:  [[0.15]]
grads:  [-0.01258106]
Stock Position:  -0.012581060821646717
Bond Position:  [-12.36018175]


portfolio before change:  [-13.60524779]
curr_Stock_Price:  98.71787610464631
curr_Factors:  [98.7178761]
mat_Sqrt:  [[0.15]]
grads:  [-0.04454105]
Stock Position:  -0.044541049268101145
Bond Position:  [-9.20825]


portfolio before change:  [-13.64318662]
curr_Stock_Price:  99.51795782665846
curr_Factors:  [99.51795783]
mat_Sqrt:  [[0.15]]
grads:  [-0.14972536]
Stock Position:  -0.1497253619239134
Bond Position:  [1.25717564]


portfolio before change:  [-13.66513949]
curr_Stock_Price:  99.66667814273919
curr_Factors:  [99.66667814]
mat_Sqrt:  [[0.15]]
grads:  [0.04149659]
Stock Position:  0.04149658715428444
Bond Position:  [-17.80096648]


portfolio before change:  [-13.71101644]
curr_Stock_Price:  98.66837542943375
curr_Factors:  [98.66837543]
mat_Sqrt:  [[0.15]]
grads:  [-0.07108832]
Stock Position:  -0.07108831683927928
Bond Position:  [-6.6968477]


portfolio before change:  [-13.65944454]
curr_Stock_Price:  97.91935898183715
curr_Factors:  [97.91935898]
mat_Sqrt:  [[0.15]]
grads:  [0.08810567]
Stock Position:  0.08810566633463582
Bond Position:  [-22.28669491]


portfolio before change:  [-13.69060796]
curr_Stock_Price:  97.62890038345567
curr_Factors:  [97.62890038]
mat_Sqrt:  [[0.15]]
grads:  [-0.30200253]
Stock Position:  -0.3020025276242914
Bond Position:  [15.79356672]


portfolio before change:  [-13.23799795]
curr_Stock_Price:  96.1432799427459
curr_Factors:  [96.14327994]
mat_Sqrt:  [[0.15]]
grads:  [0.01772171]
Stock Position:  0.017721711606808143
Bond Position:  [-14.94182143]


portfolio before change:  [-13.23500271]
curr_Stock_Price:  96.52310559462676
curr_Factors:  [96.52310559]
mat_Sqrt:  [[0.15]]
grads:  [0.05578596]
Stock Position:  0.05578596311229604
Bond Position:  [-18.61963712]


portfolio before change:  [-13.21070423]
curr_Stock_Price:  97.04212450409483
curr_Factors:  [97.0421245]
mat_Sqrt:  [[0.15]]
grads:  [-0.04888]
Stock Position:  -0.04887999882466303
Bond Position:  [-8.4672853]


portfolio before change:  [-13.19831315]
curr_Stock_Price:  96.74531250571209
curr_Factors:  [96.74531251]
mat_Sqrt:  [[0.15]]
grads:  [0.05221605]
Stock Position:  0.05221605256198729
Bond Position:  [-18.24997147]


portfolio before change:  [-13.19246884]
curr_Stock_Price:  96.94462605991251
curr_Factors:  [96.94462606]
mat_Sqrt:  [[0.15]]
grads:  [0.03962957]
Stock Position:  0.039629574866757854
Bond Position:  [-17.03434316]


portfolio before change:  [-13.16030588]
curr_Stock_Price:  97.86368914394025
curr_Factors:  [97.86368914]
mat_Sqrt:  [[0.15]]
grads:  [-0.00684678]
Stock Position:  -0.0068467827537728385
Bond Position:  [-12.49025446]


portfolio before change:  [-13.16084039]
curr_Stock_Price:  97.48563590771887
curr_Factors:  [97.48563591]
mat_Sqrt:  [[0.15]]
grads:  [0.05419184]
Stock Position:  0.05419183582419578
Bond Position:  [-18.44376596]


portfolio before change:  [-13.05543571]
curr_Stock_Price:  99.51576088347687
curr_Factors:  [99.51576088]
mat_Sqrt:  [[0.15]]
grads:  [0.11176512]
Stock Position:  0.1117651174506632
Bond Position:  [-24.17782641]


portfolio before change:  [-13.04529431]
curr_Stock_Price:  99.66058793367017
curr_Factors:  [99.66058793]
mat_Sqrt:  [[0.15]]
grads:  [0.03156482]
Stock Position:  0.03156481500948635
Bond Position:  [-16.19106233]


portfolio before change:  [-13.06220426]
curr_Stock_Price:  99.25311891165535
curr_Factors:  [99.25311891]
mat_Sqrt:  [[0.15]]
grads:  [0.04700215]
Stock Position:  0.04700214720037403
Bond Position:  [-17.72731397]


portfolio before change:  [-12.99371425]
curr_Stock_Price:  100.80458829231546
curr_Factors:  [100.80458829]
mat_Sqrt:  [[0.15]]
grads:  [-0.03591899]
Stock Position:  -0.03591898864326141
Bond Position:  [-9.37291539]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.04940887]
Stock Price:  102.28990561488256
PL:  [-15.33931448]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.04362303e-02]
 [-8.68437391e-03]
 [-7.22550503e-03]
 [-1.37219444e-02]
 [ 6.49200444e-03]
 [-9.86270406e-03]
 [ 7.68181916e-03]
 [ 4.10958960e-03]
 [-9.81342139e-03]
 [ 5.64555840e-03]
 [-4.36127664e-03]
 [-3.14945021e-03]
 [ 4.88201555e-03]
 [-6.56362840e-04]
 [ 5.49135324e-03]
 [ 1.68495351e-02]
 [ 5.44711004e-03]
 [ 5.30193583e-03]
 [-5.06054067e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [37.7855534]
curr_Stock_Price:  101.64192357795486
curr_Factors:  [101.64192358]
mat_Sqrt:  [[0.15]]
grads:  [-0.13624154]
Stock Position:  -0.1362415350704838
Bond Position:  [51.6334051]


portfolio before change:  [37.97962943]
curr_Stock_Price:  100.31218180303793
curr_Factors:  [100.3121818]
mat_Sqrt:  [[0.15]]
grads:  [-0.05789583]
Stock Position:  -0.05789582606850564
Bond Position:  [43.78728606]


portfolio before change:  [38.0977858]
curr_Stock_Price:  98.4604389858305
curr_Factors:  [98.46043899]
mat_Sqrt:  [[0.15]]
grads:  [-0.04817003]
Stock Position:  -0.04817003350794818
Bond Position:  [42.84062844]


portfolio before change:  [38.10687143]
curr_Stock_Price:  98.49419165071134
curr_Factors:  [98.49419165]
mat_Sqrt:  [[0.15]]
grads:  [-0.09147963]
Stock Position:  -0.0914796293312038
Bond Position:  [47.11708357]


portfolio before change:  [37.93641862]
curr_Stock_Price:  100.48625868085425
curr_Factors:  [100.48625868]
mat_Sqrt:  [[0.15]]
grads:  [0.04328003]
Stock Position:  0.04328002959766197
Bond Position:  [33.58737037]


portfolio before change:  [37.93073938]
curr_Stock_Price:  100.16100180260275
curr_Factors:  [100.1610018]
mat_Sqrt:  [[0.15]]
grads:  [-0.06575136]
Stock Position:  -0.06575136042161153
Bond Position:  [44.51646151]


portfolio before change:  [37.89095431]
curr_Stock_Price:  100.9353672102764
curr_Factors:  [100.93536721]
mat_Sqrt:  [[0.15]]
grads:  [0.05121213]
Stock Position:  0.051212127737894665
Bond Position:  [32.72183939]


portfolio before change:  [38.01301761]
curr_Stock_Price:  103.15909464327598
curr_Factors:  [103.15909464]
mat_Sqrt:  [[0.15]]
grads:  [0.02739726]
Stock Position:  0.02739726401515003
Bond Position:  [35.18674066]


portfolio before change:  [38.00880004]
curr_Stock_Price:  102.68403423039724
curr_Factors:  [102.68403423]
mat_Sqrt:  [[0.15]]
grads:  [-0.06542281]
Stock Position:  -0.06542280929541912
Bond Position:  [44.72667803]


portfolio before change:  [38.19979421]
curr_Stock_Price:  99.93558755028275
curr_Factors:  [99.93558755]
mat_Sqrt:  [[0.15]]
grads:  [0.03763706]
Stock Position:  0.03763705599055055
Bond Position:  [34.4385129]


portfolio before change:  [38.15496287]
curr_Stock_Price:  98.51565616025147
curr_Factors:  [98.51565616]
mat_Sqrt:  [[0.15]]
grads:  [-0.02907518]
Stock Position:  -0.02907517757130608
Bond Position:  [41.01932307]


portfolio before change:  [38.14531781]
curr_Stock_Price:  99.20012911207904
curr_Factors:  [99.20012911]
mat_Sqrt:  [[0.15]]
grads:  [-0.02099633]
Stock Position:  -0.020996334728843186
Bond Position:  [40.22815693]


portfolio before change:  [38.15919651]
curr_Stock_Price:  99.01817341918067
curr_Factors:  [99.01817342]
mat_Sqrt:  [[0.15]]
grads:  [0.03254677]
Stock Position:  0.032546770334861384
Bond Position:  [34.93647476]


portfolio before change:  [38.17984088]
curr_Stock_Price:  99.38408250836568
curr_Factors:  [99.38408251]
mat_Sqrt:  [[0.15]]
grads:  [-0.00437575]
Stock Position:  -0.004375752269850109
Bond Position:  [38.61472101]


portfolio before change:  [38.18891637]
curr_Stock_Price:  99.51649463234567
curr_Factors:  [99.51649463]
mat_Sqrt:  [[0.15]]
grads:  [0.03660902]
Stock Position:  0.03660902158058837
Bond Position:  [34.54571487]


portfolio before change:  [38.20346696]
curr_Stock_Price:  99.67801442786383
curr_Factors:  [99.67801443]
mat_Sqrt:  [[0.15]]
grads:  [0.11233023]
Stock Position:  0.11233023433187812
Bond Position:  [27.00661224]


portfolio before change:  [38.12328486]
curr_Stock_Price:  98.90409462908963
curr_Factors:  [98.90409463]
mat_Sqrt:  [[0.15]]
grads:  [0.03631407]
Stock Position:  0.03631406693915243
Bond Position:  [34.53167495]


portfolio before change:  [38.12037032]
curr_Stock_Price:  98.58607637677218
curr_Factors:  [98.58607638]
mat_Sqrt:  [[0.15]]
grads:  [0.03534624]
Stock Position:  0.03534623885462599
Bond Position:  [34.63572332]


portfolio before change:  [38.08780298]
curr_Stock_Price:  97.4196904562827
curr_Factors:  [97.41969046]
mat_Sqrt:  [[0.15]]
grads:  [-0.03373694]
Stock Position:  -0.03373693778596361
Bond Position:  [41.37444502]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [38.12234882]
Stock Price:  96.70234799990465
PL:  [38.12234882]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.53150132e-03]
 [-9.81452681e-03]
 [-5.00601380e-03]
 [-7.32144468e-03]
 [ 6.46397758e-03]
 [-9.35914836e-03]
 [ 9.22080093e-03]
 [-2.39962413e-02]
 [-1.36636721e-02]
 [ 6.13781864e-03]
 [-3.43400532e-03]
 [-4.43796157e-03]
 [ 4.78917279e-03]
 [-2.62280679e-04]
 [ 2.30530923e-04]
 [ 2.29993998e-02]
 [ 1.96456460e-03]
 [ 7.83472393e-03]
 [-5.38772386e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.7431075]
curr_Stock_Price:  99.25859840501928
curr_Factors:  [99.25859841]
mat_Sqrt:  [[0.15]]
grads:  [0.01687668]
Stock Position:  0.01687667544730681
Bond Position:  [-16.41826265]


portfolio before change:  [-14.74122287]
curr_Stock_Price:  99.6135088525238
curr_Factors:  [99.61350885]
mat_Sqrt:  [[0.15]]
grads:  [-0.06543018]
Stock Position:  -0.06543017875198118
Bond Position:  [-8.22349318]


portfolio before change:  [-14.77312615]
curr_Stock_Price:  100.06967673671
curr_Factors:  [100.06967674]
mat_Sqrt:  [[0.15]]
grads:  [-0.03337343]
Stock Position:  -0.03337342535885325
Bond Position:  [-11.43345826]


portfolio before change:  [-14.7908664]
curr_Stock_Price:  100.51558629487705
curr_Factors:  [100.51558629]
mat_Sqrt:  [[0.15]]
grads:  [-0.04880963]
Stock Position:  -0.048809631179031886
Bond Position:  [-9.88473771]


portfolio before change:  [-14.79387052]
curr_Stock_Price:  100.52649859260704
curr_Factors:  [100.52649859]
mat_Sqrt:  [[0.15]]
grads:  [0.04309318]
Stock Position:  0.04309318383836559
Bond Position:  [-19.1258774]


portfolio before change:  [-14.76563253]
curr_Stock_Price:  101.29274645811921
curr_Factors:  [101.29274646]
mat_Sqrt:  [[0.15]]
grads:  [-0.06239432]
Stock Position:  -0.06239432237951906
Bond Position:  [-8.44554025]


portfolio before change:  [-14.73421561]
curr_Stock_Price:  100.75538077493712
curr_Factors:  [100.75538077]
mat_Sqrt:  [[0.15]]
grads:  [0.06147201]
Stock Position:  0.061472006171416814
Bond Position:  [-20.927851]


portfolio before change:  [-14.84610145]
curr_Stock_Price:  99.02039217973466
curr_Factors:  [99.02039218]
mat_Sqrt:  [[0.15]]
grads:  [-0.15997494]
Stock Position:  -0.15997494215840544
Bond Position:  [0.99468006]


portfolio before change:  [-15.07032727]
curr_Stock_Price:  100.42357768264871
curr_Factors:  [100.42357768]
mat_Sqrt:  [[0.15]]
grads:  [-0.09109115]
Stock Position:  -0.09109114708937112
Bond Position:  [-5.92262839]


portfolio before change:  [-15.01900502]
curr_Stock_Price:  99.84390446241756
curr_Factors:  [99.84390446]
mat_Sqrt:  [[0.15]]
grads:  [0.04091879]
Stock Position:  0.04091879096283963
Bond Position:  [-19.10449687]


portfolio before change:  [-15.05345301]
curr_Stock_Price:  99.118778633853
curr_Factors:  [99.11877863]
mat_Sqrt:  [[0.15]]
grads:  [-0.02289337]
Stock Position:  -0.02289336881515027
Bond Position:  [-12.78429025]


portfolio before change:  [-15.07223429]
curr_Stock_Price:  99.79953487694176
curr_Factors:  [99.79953488]
mat_Sqrt:  [[0.15]]
grads:  [-0.02958641]
Stock Position:  -0.029586410449515613
Bond Position:  [-12.11952428]


portfolio before change:  [-15.08031143]
curr_Stock_Price:  99.9701160947729
curr_Factors:  [99.97011609]
mat_Sqrt:  [[0.15]]
grads:  [0.03192782]
Stock Position:  0.031927818605854315
Bond Position:  [-18.27213916]


portfolio before change:  [-15.06695516]
curr_Stock_Price:  100.5315348068807
curr_Factors:  [100.53153481]
mat_Sqrt:  [[0.15]]
grads:  [-0.00174854]
Stock Position:  -0.001748537858634494
Bond Position:  [-14.89117197]


portfolio before change:  [-15.07315469]
curr_Stock_Price:  101.94772837017342
curr_Factors:  [101.94772837]
mat_Sqrt:  [[0.15]]
grads:  [0.00153687]
Stock Position:  0.0015368728173149593
Bond Position:  [-15.22983538]


portfolio before change:  [-15.07566352]
curr_Stock_Price:  102.79301943596062
curr_Factors:  [102.79301944]
mat_Sqrt:  [[0.15]]
grads:  [0.15332933]
Stock Position:  0.1533293322683004
Bond Position:  [-30.83684855]


portfolio before change:  [-15.29890865]
curr_Stock_Price:  101.38731998007044
curr_Factors:  [101.38731998]
mat_Sqrt:  [[0.15]]
grads:  [0.0130971]
Stock Position:  0.013097097327661346
Bond Position:  [-16.62678825]


portfolio before change:  [-15.32745922]
curr_Stock_Price:  99.52481961814955
curr_Factors:  [99.52481962]
mat_Sqrt:  [[0.15]]
grads:  [0.05223149]
Stock Position:  0.052231492873568965
Bond Position:  [-20.52578913]


portfolio before change:  [-15.316623]
curr_Stock_Price:  99.83054146678425
curr_Factors:  [99.83054147]
mat_Sqrt:  [[0.15]]
grads:  [-0.03591816]
Stock Position:  -0.03591815907016002
Bond Position:  [-11.73089373]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.34813395]
Stock Price:  100.62617974540228
PL:  [-15.9743137]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.76374876e-03]
 [-6.86787585e-03]
 [-3.97494399e-03]
 [-1.54697015e-02]
 [ 6.16198053e-03]
 [-1.01320673e-02]
 [ 1.04712279e-02]
 [ 9.20423756e-03]
 [-1.47107613e-02]
 [ 1.52776747e-03]
 [-3.40657557e-03]
 [ 9.66642190e-03]
 [ 9.82474332e-03]
 [-2.63509933e-03]
 [ 1.00125897e-02]
 [ 2.01934222e-02]
 [ 1.06374305e-02]
 [ 1.61383754e-02]
 [-2.06543174e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.97765326]
curr_Stock_Price:  99.70167562289559
curr_Factors:  [99.70167562]
mat_Sqrt:  [[0.15]]
grads:  [0.01842499]
Stock Position:  0.018424991705804986
Bond Position:  [-6.8146558]


portfolio before change:  [-4.96622171]
curr_Stock_Price:  100.414588706476
curr_Factors:  [100.41458871]
mat_Sqrt:  [[0.15]]
grads:  [-0.04578584]
Stock Position:  -0.04578583898215242
Bond Position:  [-0.36865552]


portfolio before change:  [-4.92287757]
curr_Stock_Price:  99.46590401393385
curr_Factors:  [99.46590401]
mat_Sqrt:  [[0.15]]
grads:  [-0.02649963]
Stock Position:  -0.02649962662673236
Bond Position:  [-2.28706825]


portfolio before change:  [-4.90659739]
curr_Stock_Price:  98.82996996697752
curr_Factors:  [98.82996997]
mat_Sqrt:  [[0.15]]
grads:  [-0.10313134]
Stock Position:  -0.10313134353254731
Bond Position:  [5.28587019]


portfolio before change:  [-4.98276209]
curr_Stock_Price:  99.5813063935306
curr_Factors:  [99.58130639]
mat_Sqrt:  [[0.15]]
grads:  [0.04107987]
Stock Position:  0.04107987020623268
Bond Position:  [-9.07354923]


portfolio before change:  [-4.98418497]
curr_Stock_Price:  99.60189547371564
curr_Factors:  [99.60189547]
mat_Sqrt:  [[0.15]]
grads:  [-0.06754712]
Stock Position:  -0.06754711547392944
Bond Position:  [1.74363577]


portfolio before change:  [-5.05042809]
curr_Stock_Price:  100.58904473263959
curr_Factors:  [100.58904473]
mat_Sqrt:  [[0.15]]
grads:  [0.06980819]
Stock Position:  0.06980818633209873
Bond Position:  [-12.07236686]


portfolio before change:  [-4.95479529]
curr_Stock_Price:  102.00222086825036
curr_Factors:  [102.00222087]
mat_Sqrt:  [[0.15]]
grads:  [0.06136158]
Stock Position:  0.06136158372079741
Bond Position:  [-11.21381311]


portfolio before change:  [-4.94534137]
curr_Stock_Price:  102.20198306100913
curr_Factors:  [102.20198306]
mat_Sqrt:  [[0.15]]
grads:  [-0.09807174]
Stock Position:  -0.09807174174756059
Bond Position:  [5.07778512]


portfolio before change:  [-5.0557818]
curr_Stock_Price:  103.34104745307746
curr_Factors:  [103.34104745]
mat_Sqrt:  [[0.15]]
grads:  [0.01018512]
Stock Position:  0.01018511648738141
Bond Position:  [-6.1083224]


portfolio before change:  [-5.04708335]
curr_Stock_Price:  104.34503370475787
curr_Factors:  [104.3450337]
mat_Sqrt:  [[0.15]]
grads:  [-0.0227105]
Stock Position:  -0.02271050382064211
Bond Position:  [-2.67735506]


portfolio before change:  [-5.06344963]
curr_Stock_Price:  105.03620520811775
curr_Factors:  [105.03620521]
mat_Sqrt:  [[0.15]]
grads:  [0.06444281]
Stock Position:  0.06444281266469092
Bond Position:  [-11.83227812]


portfolio before change:  [-5.14162677]
curr_Stock_Price:  103.86898890441121
curr_Factors:  [103.8689889]
mat_Sqrt:  [[0.15]]
grads:  [0.06549829]
Stock Position:  0.06549828881615592
Bond Position:  [-11.9448678]


portfolio before change:  [-5.05078539]
curr_Stock_Price:  105.3015143351391
curr_Factors:  [105.30151434]
mat_Sqrt:  [[0.15]]
grads:  [-0.01756733]
Stock Position:  -0.017567328843009912
Bond Position:  [-3.20091906]


portfolio before change:  [-5.04683673]
curr_Stock_Price:  105.03118352885818
curr_Factors:  [105.03118353]
mat_Sqrt:  [[0.15]]
grads:  [0.0667506]
Stock Position:  0.06675059775662782
Bond Position:  [-12.05773102]


portfolio before change:  [-4.93714396]
curr_Stock_Price:  106.71967148270228
curr_Factors:  [106.71967148]
mat_Sqrt:  [[0.15]]
grads:  [0.13462281]
Stock Position:  0.1346228145826164
Bond Position:  [-19.30404651]


portfolio before change:  [-4.78802006]
curr_Stock_Price:  107.86324074338997
curr_Factors:  [107.86324074]
mat_Sqrt:  [[0.15]]
grads:  [0.0709162]
Stock Position:  0.07091620334845608
Bond Position:  [-12.43727158]


portfolio before change:  [-4.65424916]
curr_Stock_Price:  109.79341474183808
curr_Factors:  [109.79341474]
mat_Sqrt:  [[0.15]]
grads:  [0.10758917]
Stock Position:  0.10758916945515197
Bond Position:  [-16.46683146]


portfolio before change:  [-4.54865597]
curr_Stock_Price:  110.81313087289696
curr_Factors:  [110.81313087]
mat_Sqrt:  [[0.15]]
grads:  [-0.13769545]
Stock Position:  -0.13769544940752468
Bond Position:  [10.70980789]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.38200699]
Stock Price:  109.62230583213088
PL:  [-14.00431283]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.10963466e-03]
 [-9.78494496e-03]
 [-4.15867196e-03]
 [-1.19619286e-02]
 [ 6.17065587e-03]
 [-1.00524332e-02]
 [ 1.46455764e-02]
 [-1.91193537e-02]
 [-1.67513568e-02]
 [ 5.76938432e-03]
 [-3.14103856e-03]
 [-4.25429748e-03]
 [ 4.99421245e-03]
 [-7.14275065e-04]
 [ 2.96497739e-03]
 [ 1.97154969e-02]
 [ 4.22817169e-03]
 [ 8.93867975e-03]
 [-5.27971485e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.77420494]
curr_Stock_Price:  99.16644365435103
curr_Factors:  [99.16644365]
mat_Sqrt:  [[0.15]]
grads:  [0.01406423]
Stock Position:  0.014064231066004662
Bond Position:  [-18.16890472]


portfolio before change:  [-16.76691161]
curr_Stock_Price:  100.0080197683224
curr_Factors:  [100.00801977]
mat_Sqrt:  [[0.15]]
grads:  [-0.06523297]
Stock Position:  -0.06523296637002761
Bond Position:  [-10.24309182]


portfolio before change:  [-16.72925303]
curr_Stock_Price:  99.39146534778449
curr_Factors:  [99.39146535]
mat_Sqrt:  [[0.15]]
grads:  [-0.02772448]
Stock Position:  -0.027724479752941577
Bond Position:  [-13.97367636]


portfolio before change:  [-16.70209996]
curr_Stock_Price:  98.2860549224613
curr_Factors:  [98.28605492]
mat_Sqrt:  [[0.15]]
grads:  [-0.07974619]
Stock Position:  -0.07974619068466213
Bond Position:  [-8.86416148]


portfolio before change:  [-16.80855253]
curr_Stock_Price:  99.59315502272563
curr_Factors:  [99.59315502]
mat_Sqrt:  [[0.15]]
grads:  [0.04113771]
Stock Position:  0.04113770578583038
Bond Position:  [-20.90558644]


portfolio before change:  [-16.80906875]
curr_Stock_Price:  99.70766878341615
curr_Factors:  [99.70766878]
mat_Sqrt:  [[0.15]]
grads:  [-0.06701622]
Stock Position:  -0.06701622102233569
Bond Position:  [-10.12703758]


portfolio before change:  [-16.80598298]
curr_Stock_Price:  99.62384065347823
curr_Factors:  [99.62384065]
mat_Sqrt:  [[0.15]]
grads:  [0.09763718]
Stock Position:  0.09763717625724931
Bond Position:  [-26.53297347]


portfolio before change:  [-16.84015305]
curr_Stock_Price:  99.34181693432647
curr_Factors:  [99.34181693]
mat_Sqrt:  [[0.15]]
grads:  [-0.12746236]
Stock Position:  -0.12746235791175095
Bond Position:  [-4.17781082]


portfolio before change:  [-17.04687222]
curr_Stock_Price:  100.95542729970283
curr_Factors:  [100.9554273]
mat_Sqrt:  [[0.15]]
grads:  [-0.11167571]
Stock Position:  -0.11167571221851104
Bond Position:  [-5.77260297]


portfolio before change:  [-16.9318487]
curr_Stock_Price:  99.91252506962152
curr_Factors:  [99.91252507]
mat_Sqrt:  [[0.15]]
grads:  [0.03846256]
Stock Position:  0.03846256210182979
Bond Position:  [-20.7747404]


portfolio before change:  [-16.95121358]
curr_Stock_Price:  99.5441006147159
curr_Factors:  [99.54410061]
mat_Sqrt:  [[0.15]]
grads:  [-0.02094026]
Stock Position:  -0.02094025704447066
Bond Position:  [-14.86673453]


portfolio before change:  [-16.95293043]
curr_Stock_Price:  99.44857665102383
curr_Factors:  [99.44857665]
mat_Sqrt:  [[0.15]]
grads:  [-0.02836198]
Stock Position:  -0.028361983222154292
Bond Position:  [-14.13237157]


portfolio before change:  [-16.93526074]
curr_Stock_Price:  98.70098341658732
curr_Factors:  [98.70098342]
mat_Sqrt:  [[0.15]]
grads:  [0.03329475]
Stock Position:  0.03329474967922265
Bond Position:  [-20.22148528]


portfolio before change:  [-16.92472254]
curr_Stock_Price:  99.16935150715148
curr_Factors:  [99.16935151]
mat_Sqrt:  [[0.15]]
grads:  [-0.00476183]
Stock Position:  -0.004761833765647585
Bond Position:  [-16.45249458]


portfolio before change:  [-16.9346453]
curr_Stock_Price:  100.38928401698361
curr_Factors:  [100.38928402]
mat_Sqrt:  [[0.15]]
grads:  [0.01976652]
Stock Position:  0.019766515921022392
Bond Position:  [-18.91899168]


portfolio before change:  [-16.93570752]
curr_Stock_Price:  100.57485634325377
curr_Factors:  [100.57485634]
mat_Sqrt:  [[0.15]]
grads:  [0.13143665]
Stock Position:  0.13143664568146068
Bond Position:  [-30.15492928]


portfolio before change:  [-17.00041314]
curr_Stock_Price:  100.13992475037207
curr_Factors:  [100.13992475]
mat_Sqrt:  [[0.15]]
grads:  [0.02818781]
Stock Position:  0.028187811245573985
Bond Position:  [-19.82313844]


portfolio before change:  [-17.00529356]
curr_Stock_Price:  100.14262055330919
curr_Factors:  [100.14262055]
mat_Sqrt:  [[0.15]]
grads:  [0.0595912]
Stock Position:  0.05959119833847724
Bond Position:  [-22.97291232]


portfolio before change:  [-16.99642658]
curr_Stock_Price:  100.38780655908954
curr_Factors:  [100.38780656]
mat_Sqrt:  [[0.15]]
grads:  [-0.0351981]
Stock Position:  -0.03519809899156813
Bond Position:  [-13.46296662]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.0208483]
Stock Price:  100.98600813622663
PL:  [-18.00685643]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.54577428e-03]
 [-1.06728792e-02]
 [-4.23843420e-03]
 [-1.85658165e-02]
 [ 2.50181572e-03]
 [-1.07125704e-02]
 [ 1.26939167e-02]
 [-4.34215342e-02]
 [ 1.81044821e-03]
 [ 8.72407685e-03]
 [-4.88548150e-03]
 [-4.40667752e-03]
 [ 4.79445771e-03]
 [-6.25789370e-04]
 [ 6.03807604e-03]
 [ 1.67681654e-02]
 [ 4.81286695e-03]
 [ 7.75070192e-03]
 [-5.48717123e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.36767997]
curr_Stock_Price:  100.12569115169056
curr_Factors:  [100.12569115]
mat_Sqrt:  [[0.15]]
grads:  [-0.01030516]
Stock Position:  -0.010305161842692872
Bond Position:  [5.39949142]


portfolio before change:  [4.37182706]
curr_Stock_Price:  99.85426908852712
curr_Factors:  [99.85426909]
mat_Sqrt:  [[0.15]]
grads:  [-0.07115253]
Stock Position:  -0.07115252771161142
Bond Position:  [11.47671071]


portfolio before change:  [4.39206316]
curr_Stock_Price:  99.61019397030513
curr_Factors:  [99.61019397]
mat_Sqrt:  [[0.15]]
grads:  [-0.02825623]
Stock Position:  -0.02825622797323566
Bond Position:  [7.20667151]


portfolio before change:  [4.40690123]
curr_Stock_Price:  99.14883797946848
curr_Factors:  [99.14883798]
mat_Sqrt:  [[0.15]]
grads:  [-0.12377211]
Stock Position:  -0.12377211026247315
Bond Position:  [16.67876214]


portfolio before change:  [4.47113179]
curr_Stock_Price:  98.66358852689537
curr_Factors:  [98.66358853]
mat_Sqrt:  [[0.15]]
grads:  [0.01667877]
Stock Position:  0.016678771444235824
Bond Position:  [2.82554435]


portfolio before change:  [4.46850842]
curr_Stock_Price:  98.46394251517465
curr_Factors:  [98.46394252]
mat_Sqrt:  [[0.15]]
grads:  [-0.07141714]
Stock Position:  -0.07141713576235792
Bond Position:  [11.50052117]


portfolio before change:  [4.55212662]
curr_Stock_Price:  97.3333635654411
curr_Factors:  [97.33336357]
mat_Sqrt:  [[0.15]]
grads:  [0.08462611]
Stock Position:  0.08462611138432811
Bond Position:  [-3.68481745]


portfolio before change:  [4.52550201]
curr_Stock_Price:  97.02963598814202
curr_Factors:  [97.02963599]
mat_Sqrt:  [[0.15]]
grads:  [-0.28947689]
Stock Position:  -0.28947689497068263
Bond Position:  [32.61333976]


portfolio before change:  [4.65900268]
curr_Stock_Price:  96.59662627250474
curr_Factors:  [96.59662627]
mat_Sqrt:  [[0.15]]
grads:  [0.01206965]
Stock Position:  0.01206965473981243
Bond Position:  [3.49311475]


portfolio before change:  [4.66170668]
curr_Stock_Price:  96.74829677529152
curr_Factors:  [96.74829678]
mat_Sqrt:  [[0.15]]
grads:  [0.05816051]
Stock Position:  0.05816051235079403
Bond Position:  [-0.96522383]


portfolio before change:  [4.73773773]
curr_Stock_Price:  98.05970870732534
curr_Factors:  [98.05970871]
mat_Sqrt:  [[0.15]]
grads:  [-0.03256988]
Stock Position:  -0.03256987665900218
Bond Position:  [7.93153035]


portfolio before change:  [4.68484716]
curr_Stock_Price:  99.74450797357451
curr_Factors:  [99.74450797]
mat_Sqrt:  [[0.15]]
grads:  [-0.02937785]
Stock Position:  -0.029377850145050934
Bond Position:  [7.61512636]


portfolio before change:  [4.68134977]
curr_Stock_Price:  99.9283678348148
curr_Factors:  [99.92836783]
mat_Sqrt:  [[0.15]]
grads:  [0.03196305]
Stock Position:  0.03196305141378536
Bond Position:  [1.48733421]


portfolio before change:  [4.66794804]
curr_Stock_Price:  99.4974449645161
curr_Factors:  [99.49744496]
mat_Sqrt:  [[0.15]]
grads:  [-0.00417193]
Stock Position:  -0.004171929131177331
Bond Position:  [5.08304433]


portfolio before change:  [4.66994385]
curr_Stock_Price:  99.32369143004054
curr_Factors:  [99.32369143]
mat_Sqrt:  [[0.15]]
grads:  [0.04025384]
Stock Position:  0.04025384025877464
Bond Position:  [0.67178384]


portfolio before change:  [4.66633703]
curr_Stock_Price:  99.22991700855108
curr_Factors:  [99.22991701]
mat_Sqrt:  [[0.15]]
grads:  [0.11178777]
Stock Position:  0.11178776905182575
Bond Position:  [-6.42635401]


portfolio before change:  [4.70151924]
curr_Stock_Price:  99.55901378132857
curr_Factors:  [99.55901378]
mat_Sqrt:  [[0.15]]
grads:  [0.03208578]
Stock Position:  0.03208577969361971
Bond Position:  [1.50709065]


portfolio before change:  [4.6998651]
curr_Stock_Price:  99.49571611866578
curr_Factors:  [99.49571612]
mat_Sqrt:  [[0.15]]
grads:  [0.05167135]
Stock Position:  0.051671346155277284
Bond Position:  [-0.44121249]


portfolio before change:  [4.72606559]
curr_Stock_Price:  100.00491138452512
curr_Factors:  [100.00491138]
mat_Sqrt:  [[0.15]]
grads:  [-0.03658114]
Stock Position:  -0.036581141533327595
Bond Position:  [8.38435941]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.7136484]
Stock Price:  100.40166052404673
PL:  [4.31198788]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.71008393e-03]
 [-3.31724048e-03]
 [-6.55220713e-03]
 [-1.64758961e-02]
 [ 6.30539269e-03]
 [-1.01842701e-02]
 [ 1.38290768e-02]
 [-3.05415157e-02]
 [ 1.30482621e-03]
 [ 7.90433430e-03]
 [-9.23133354e-03]
 [ 1.18885504e-02]
 [ 6.61787925e-03]
 [-1.55895228e-03]
 [ 6.91938127e-03]
 [ 2.23251031e-02]
 [ 1.01961067e-02]
 [ 5.13039392e-04]
 [-7.45715055e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.01804364]
curr_Stock_Price:  99.38223973133007
curr_Factors:  [99.38223973]
mat_Sqrt:  [[0.15]]
grads:  [0.01806723]
Stock Position:  0.01806722623273773
Bond Position:  [-13.81360505]


portfolio before change:  [-12.03345148]
curr_Stock_Price:  98.72059931551085
curr_Factors:  [98.72059932]
mat_Sqrt:  [[0.15]]
grads:  [-0.02211494]
Stock Position:  -0.0221149365312477
Bond Position:  [-9.85025169]


portfolio before change:  [-12.03670942]
curr_Stock_Price:  98.75655085354498
curr_Factors:  [98.75655085]
mat_Sqrt:  [[0.15]]
grads:  [-0.04368138]
Stock Position:  -0.043681380851073384
Bond Position:  [-7.72288691]


portfolio before change:  [-12.04712016]
curr_Stock_Price:  98.95067883664196
curr_Factors:  [98.95067884]
mat_Sqrt:  [[0.15]]
grads:  [-0.10983931]
Stock Position:  -0.10983930729361792
Bond Position:  [-1.17844614]


portfolio before change:  [-12.23447499]
curr_Stock_Price:  100.65371379197457
curr_Factors:  [100.65371379]
mat_Sqrt:  [[0.15]]
grads:  [0.04203595]
Stock Position:  0.04203595124412693
Bond Position:  [-16.46554959]


portfolio before change:  [-12.28572076]
curr_Stock_Price:  99.53255758172395
curr_Factors:  [99.53255758]
mat_Sqrt:  [[0.15]]
grads:  [-0.06789513]
Stock Position:  -0.06789513429122672
Bond Position:  [-5.52794439]


portfolio before change:  [-12.24613097]
curr_Stock_Price:  98.92909833491554
curr_Factors:  [98.92909833]
mat_Sqrt:  [[0.15]]
grads:  [0.09219385]
Stock Position:  0.09219384530059431
Bond Position:  [-21.36678496]


portfolio before change:  [-12.28304176]
curr_Stock_Price:  98.58668473761556
curr_Factors:  [98.58668474]
mat_Sqrt:  [[0.15]]
grads:  [-0.2036101]
Stock Position:  -0.20361010466997062
Bond Position:  [7.79020344]


portfolio before change:  [-11.93094799]
curr_Stock_Price:  96.86699613737598
curr_Factors:  [96.86699614]
mat_Sqrt:  [[0.15]]
grads:  [0.00869884]
Stock Position:  0.008698841409996529
Bond Position:  [-12.77357863]


portfolio before change:  [-11.93968268]
curr_Stock_Price:  96.23002636043475
curr_Factors:  [96.23002636]
mat_Sqrt:  [[0.15]]
grads:  [0.05269556]
Stock Position:  0.05269556201259167
Bond Position:  [-17.010578]


portfolio before change:  [-11.94084434]
curr_Stock_Price:  96.28869393353607
curr_Factors:  [96.28869393]
mat_Sqrt:  [[0.15]]
grads:  [-0.06154222]
Stock Position:  -0.06154222361616844
Bond Position:  [-6.015024]


portfolio before change:  [-11.92378884]
curr_Stock_Price:  95.98712151016456
curr_Factors:  [95.98712151]
mat_Sqrt:  [[0.15]]
grads:  [0.079257]
Stock Position:  0.07925700249078872
Bond Position:  [-19.53144037]


portfolio before change:  [-11.97342856]
curr_Stock_Price:  95.42242384304174
curr_Factors:  [95.42242384]
mat_Sqrt:  [[0.15]]
grads:  [0.04411919]
Stock Position:  0.04411919499841753
Bond Position:  [-16.18338908]


portfolio before change:  [-11.98085577]
curr_Stock_Price:  95.34579363033839
curr_Factors:  [95.34579363]
mat_Sqrt:  [[0.15]]
grads:  [-0.01039302]
Stock Position:  -0.010393015225453084
Bond Position:  [-10.98992549]


portfolio before change:  [-11.96786988]
curr_Stock_Price:  93.83191912142824
curr_Factors:  [93.83191912]
mat_Sqrt:  [[0.15]]
grads:  [0.04612921]
Stock Position:  0.046129208495156636
Bond Position:  [-16.29626204]


portfolio before change:  [-11.97953727]
curr_Stock_Price:  93.66732018430504
curr_Factors:  [93.66732018]
mat_Sqrt:  [[0.15]]
grads:  [0.14883402]
Stock Position:  0.14883402083487118
Bond Position:  [-25.92042116]


portfolio before change:  [-11.81073197]
curr_Stock_Price:  94.84504969345537
curr_Factors:  [94.84504969]
mat_Sqrt:  [[0.15]]
grads:  [0.06797404]
Stock Position:  0.06797404471035529
Bond Position:  [-18.25773362]


portfolio before change:  [-11.76583417]
curr_Stock_Price:  95.57272153774132
curr_Factors:  [95.57272154]
mat_Sqrt:  [[0.15]]
grads:  [0.00342026]
Stock Position:  0.003420262613968277
Bond Position:  [-12.09271798]


portfolio before change:  [-11.76676648]
curr_Stock_Price:  96.18415292765509
curr_Factors:  [96.18415293]
mat_Sqrt:  [[0.15]]
grads:  [-0.04971434]
Stock Position:  -0.049714337008002825
Bond Position:  [-6.98503508]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.74836157]
Stock Price:  95.77880943839861
PL:  [-11.74836157]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.96475457e-02]
 [ 2.61000416e-02]
 [-2.35209496e-02]
 [ 3.60911720e-02]
 [ 5.70603924e-03]
 [-1.91808621e-02]
 [-9.45945796e-03]
 [-2.43976966e-03]
 [ 1.80568950e-02]
 [-9.83734963e-04]
 [-3.51985372e-03]
 [ 1.61436365e-02]
 [ 1.04150885e-02]
 [-1.30248635e-03]
 [ 1.05494446e-02]
 [ 2.15512468e-02]
 [ 5.98405922e-03]
 [ 1.40064639e-02]
 [-1.09884746e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [34.46982627]
curr_Stock_Price:  101.49148273642008
curr_Factors:  [101.49148274]
mat_Sqrt:  [[0.15]]
grads:  [-0.13098364]
Stock Position:  -0.13098363786592082
Bond Position:  [47.76354989]


portfolio before change:  [34.45283763]
curr_Stock_Price:  101.71235777768109
curr_Factors:  [101.71235778]
mat_Sqrt:  [[0.15]]
grads:  [0.17400028]
Stock Position:  0.1740002773864479
Bond Position:  [16.75485916]


portfolio before change:  [34.41680745]
curr_Stock_Price:  101.48121207880907
curr_Factors:  [101.48121208]
mat_Sqrt:  [[0.15]]
grads:  [-0.15680633]
Stock Position:  -0.1568063309493122
Bond Position:  [50.32970398]


portfolio before change:  [34.34462258]
curr_Stock_Price:  102.02180808378074
curr_Factors:  [102.02180808]
mat_Sqrt:  [[0.15]]
grads:  [0.24060781]
Stock Position:  0.24060781346692614
Bond Position:  [9.79737841]


portfolio before change:  [34.37984657]
curr_Stock_Price:  102.15802285804136
curr_Factors:  [102.15802286]
mat_Sqrt:  [[0.15]]
grads:  [0.03804026]
Stock Position:  0.038040261591234685
Bond Position:  [30.49372865]


portfolio before change:  [34.51520818]
curr_Stock_Price:  105.51597115940403
curr_Factors:  [105.51597116]
mat_Sqrt:  [[0.15]]
grads:  [-0.12787241]
Stock Position:  -0.12787241373281247
Bond Position:  [48.0077901]


portfolio before change:  [34.61497739]
curr_Stock_Price:  104.82961701727324
curr_Factors:  [104.82961702]
mat_Sqrt:  [[0.15]]
grads:  [-0.06306305]
Stock Position:  -0.0630630530349795
Bond Position:  [41.22585309]


portfolio before change:  [34.64953519]
curr_Stock_Price:  104.44508055803227
curr_Factors:  [104.44508056]
mat_Sqrt:  [[0.15]]
grads:  [-0.01626513]
Stock Position:  -0.016265131033362072
Bond Position:  [36.34834811]


portfolio before change:  [34.64625828]
curr_Stock_Price:  105.20530392652358
curr_Factors:  [105.20530393]
mat_Sqrt:  [[0.15]]
grads:  [0.1203793]
Stock Position:  0.12037930020334431
Bond Position:  [21.98171741]


portfolio before change:  [34.6436758]
curr_Stock_Price:  105.13819439434602
curr_Factors:  [105.13819439]
mat_Sqrt:  [[0.15]]
grads:  [-0.00655823]
Stock Position:  -0.006558233084205829
Bond Position:  [35.33319658]


portfolio before change:  [34.65318552]
curr_Stock_Price:  105.035220744107
curr_Factors:  [105.03522074]
mat_Sqrt:  [[0.15]]
grads:  [-0.02346569]
Stock Position:  -0.023465691435859578
Bond Position:  [37.1179096]


portfolio before change:  [34.63813495]
curr_Stock_Price:  106.07210522086059
curr_Factors:  [106.07210522]
mat_Sqrt:  [[0.15]]
grads:  [0.10762424]
Stock Position:  0.10762424349148403
Bond Position:  [23.22220487]


portfolio before change:  [34.45146425]
curr_Stock_Price:  104.28368868648106
curr_Factors:  [104.28368869]
mat_Sqrt:  [[0.15]]
grads:  [0.06943392]
Stock Position:  0.06943392360902796
Bond Position:  [27.21063858]


portfolio before change:  [34.45386209]
curr_Stock_Price:  104.2202373621619
curr_Factors:  [104.22023736]
mat_Sqrt:  [[0.15]]
grads:  [-0.00868324]
Stock Position:  -0.008683242341579148
Bond Position:  [35.35883166]


portfolio before change:  [34.45454418]
curr_Stock_Price:  105.1598310958918
curr_Factors:  [105.1598311]
mat_Sqrt:  [[0.15]]
grads:  [0.07032963]
Stock Position:  0.07032963096658451
Bond Position:  [27.05869207]


portfolio before change:  [34.45107322]
curr_Stock_Price:  105.0142811150152
curr_Factors:  [105.01428112]
mat_Sqrt:  [[0.15]]
grads:  [0.14367498]
Stock Position:  0.14367497898629789
Bond Position:  [19.36314859]


portfolio before change:  [34.46163658]
curr_Stock_Price:  105.05410686756863
curr_Factors:  [105.05410687]
mat_Sqrt:  [[0.15]]
grads:  [0.03989373]
Stock Position:  0.039893728143472036
Bond Position:  [30.2706366]


portfolio before change:  [34.48122353]
curr_Stock_Price:  105.35536593903103
curr_Factors:  [105.35536594]
mat_Sqrt:  [[0.15]]
grads:  [0.09337643]
Stock Position:  0.09337642581281363
Bond Position:  [24.64351602]


portfolio before change:  [34.30063483]
curr_Stock_Price:  103.3553927251748
curr_Factors:  [103.35539273]
mat_Sqrt:  [[0.15]]
grads:  [-0.0732565]
Stock Position:  -0.07325649706369465
Bond Position:  [41.87208885]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [34.38181146]
Stock Price:  102.39019101908046
PL:  [31.99162044]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.36747215e-02]
 [ 7.15682554e-02]
 [-7.15913985e-02]
 [ 6.94864843e-02]
 [ 5.45286150e-03]
 [-1.47068047e-02]
 [-3.03638713e-03]
 [ 1.47829868e-02]
 [-1.98616160e-02]
 [ 1.83029751e-03]
 [-3.37522270e-03]
 [ 3.40903539e-03]
 [ 1.19446447e-02]
 [-4.23219064e-03]
 [ 1.59609940e-02]
 [ 2.01189953e-02]
 [ 5.87772097e-03]
 [ 1.51065642e-02]
 [-1.62210217e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.82634281]
curr_Stock_Price:  100.69096436154332
curr_Factors:  [100.69096436]
mat_Sqrt:  [[0.15]]
grads:  [-0.09116481]
Stock Position:  -0.09116481030642039
Bond Position:  [26.00581547]


portfolio before change:  [16.5721344]
curr_Stock_Price:  103.55073751983676
curr_Factors:  [103.55073752]
mat_Sqrt:  [[0.15]]
grads:  [0.4771217]
Stock Position:  0.477121702944574
Bond Position:  [-32.83416983]


portfolio before change:  [17.08449344]
curr_Stock_Price:  104.64179793921973
curr_Factors:  [104.64179794]
mat_Sqrt:  [[0.15]]
grads:  [-0.47727599]
Stock Position:  -0.4772759897364711
Bond Position:  [67.02751111]


portfolio before change:  [17.42169749]
curr_Stock_Price:  103.97039377763512
curr_Factors:  [103.97039378]
mat_Sqrt:  [[0.15]]
grads:  [0.46324323]
Stock Position:  0.4632432287074271
Bond Position:  [-30.74188341]


portfolio before change:  [17.18421745]
curr_Stock_Price:  103.47433987109586
curr_Factors:  [103.47433987]
mat_Sqrt:  [[0.15]]
grads:  [0.03635241]
Stock Position:  0.03635241002116058
Bond Position:  [13.42267582]


portfolio before change:  [17.19731331]
curr_Stock_Price:  103.74226628202081
curr_Factors:  [103.74226628]
mat_Sqrt:  [[0.15]]
grads:  [-0.09804536]
Stock Position:  -0.09804536498826197
Bond Position:  [27.36876167]


portfolio before change:  [17.27619493]
curr_Stock_Price:  103.00751893163843
curr_Factors:  [103.00751893]
mat_Sqrt:  [[0.15]]
grads:  [-0.02024258]
Stock Position:  -0.02024258084310906
Bond Position:  [19.36133296]


portfolio before change:  [17.32714796]
curr_Stock_Price:  100.72954370226017
curr_Factors:  [100.7295437]
mat_Sqrt:  [[0.15]]
grads:  [0.09855325]
Stock Position:  0.09855324553542603
Bond Position:  [7.39992451]


portfolio before change:  [17.41077633]
curr_Stock_Price:  101.55933022813136
curr_Factors:  [101.55933023]
mat_Sqrt:  [[0.15]]
grads:  [-0.13241077]
Stock Position:  -0.1324107735175231
Bond Position:  [30.8583258]


portfolio before change:  [17.21123765]
curr_Stock_Price:  103.12456710037206
curr_Factors:  [103.1245671]
mat_Sqrt:  [[0.15]]
grads:  [0.01220198]
Stock Position:  0.012201983409887256
Bond Position:  [15.95291339]


portfolio before change:  [17.22778756]
curr_Stock_Price:  104.15400526411985
curr_Factors:  [104.15400526]
mat_Sqrt:  [[0.15]]
grads:  [-0.02250148]
Stock Position:  -0.022501484664530207
Bond Position:  [19.57140732]


portfolio before change:  [17.23534842]
curr_Stock_Price:  104.03546227503112
curr_Factors:  [104.03546228]
mat_Sqrt:  [[0.15]]
grads:  [0.0227269]
Stock Position:  0.02272690262617052
Bond Position:  [14.8709446]


portfolio before change:  [17.26853319]
curr_Stock_Price:  105.33201232108036
curr_Factors:  [105.33201232]
mat_Sqrt:  [[0.15]]
grads:  [0.07963096]
Stock Position:  0.07963096445535485
Bond Position:  [8.88084346]


portfolio before change:  [17.37151676]
curr_Stock_Price:  106.59738799831248
curr_Factors:  [106.597388]
mat_Sqrt:  [[0.15]]
grads:  [-0.0282146]
Stock Position:  -0.02821460424633145
Bond Position:  [20.37911988]


portfolio before change:  [17.38123953]
curr_Stock_Price:  106.43338262473203
curr_Factors:  [106.43338262]
mat_Sqrt:  [[0.15]]
grads:  [0.10640663]
Stock Position:  0.10640662663849217
Bond Position:  [6.05602232]


portfolio before change:  [17.42316345]
curr_Stock_Price:  106.81314960984308
curr_Factors:  [106.81314961]
mat_Sqrt:  [[0.15]]
grads:  [0.13412664]
Stock Position:  0.13412663529659485
Bond Position:  [3.09667508]


portfolio before change:  [17.18028374]
curr_Stock_Price:  104.99655312418952
curr_Factors:  [104.99655312]
mat_Sqrt:  [[0.15]]
grads:  [0.03918481]
Stock Position:  0.039184806465322235
Bond Position:  [13.06601412]


portfolio before change:  [17.28552723]
curr_Stock_Price:  107.599005282547
curr_Factors:  [107.59900528]
mat_Sqrt:  [[0.15]]
grads:  [0.10071043]
Stock Position:  0.10071042822428813
Bond Position:  [6.44918533]


portfolio before change:  [17.24445126]
curr_Stock_Price:  107.17513192971226
curr_Factors:  [107.17513193]
mat_Sqrt:  [[0.15]]
grads:  [-0.10814014]
Stock Position:  -0.10814014444223945
Bond Position:  [28.83438551]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.17040291]
Stock Price:  107.92654435547117
PL:  [9.24385856]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.28760963e-02]
 [-6.05251838e-03]
 [-1.05798923e-02]
 [-9.29242958e-03]
 [ 6.04677504e-03]
 [-9.63033380e-03]
 [-1.28673803e-03]
 [ 7.95397297e-03]
 [-1.28842335e-02]
 [ 2.35792717e-03]
 [-3.23905266e-03]
 [-4.52094175e-03]
 [ 4.85296559e-03]
 [-2.34693425e-04]
 [ 6.45425704e-03]
 [ 1.69457842e-02]
 [ 4.38743559e-03]
 [ 9.20617586e-03]
 [-5.13710980e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.00054721]
curr_Stock_Price:  100.6534964459878
curr_Factors:  [100.65349645]
mat_Sqrt:  [[0.15]]
grads:  [-0.08584064]
Stock Position:  -0.08584064222238943
Bond Position:  [24.64070799]


portfolio before change:  [16.02327035]
curr_Stock_Price:  100.46055530313922
curr_Factors:  [100.4605553]
mat_Sqrt:  [[0.15]]
grads:  [-0.04035012]
Stock Position:  -0.0403501225088813
Bond Position:  [20.07686607]


portfolio before change:  [16.01356529]
curr_Stock_Price:  100.82548379516719
curr_Factors:  [100.8254838]
mat_Sqrt:  [[0.15]]
grads:  [-0.07053262]
Stock Position:  -0.07053261539692778
Bond Position:  [23.12505036]


portfolio before change:  [16.04948149]
curr_Stock_Price:  100.39824573432603
curr_Factors:  [100.39824573]
mat_Sqrt:  [[0.15]]
grads:  [-0.06194953]
Stock Position:  -0.06194953052667611
Bond Position:  [22.26910568]


portfolio before change:  [16.11348726]
curr_Stock_Price:  99.4549327536407
curr_Factors:  [99.45493275]
mat_Sqrt:  [[0.15]]
grads:  [0.04031183]
Stock Position:  0.04031183359778513
Bond Position:  [12.10427656]


portfolio before change:  [16.1687648]
curr_Stock_Price:  100.75110540622467
curr_Factors:  [100.75110541]
mat_Sqrt:  [[0.15]]
grads:  [-0.06420223]
Stock Position:  -0.0642022253341147
Bond Position:  [22.63720997]


portfolio before change:  [16.06727166]
curr_Stock_Price:  102.4200998081754
curr_Factors:  [102.42009981]
mat_Sqrt:  [[0.15]]
grads:  [-0.00857825]
Stock Position:  -0.008578253531370915
Bond Position:  [16.94585724]


portfolio before change:  [16.07265791]
curr_Stock_Price:  102.28612631624227
curr_Factors:  [102.28612632]
mat_Sqrt:  [[0.15]]
grads:  [0.05302649]
Stock Position:  0.05302648648725663
Bond Position:  [10.64878402]


portfolio before change:  [16.08145249]
curr_Stock_Price:  102.4017675248946
curr_Factors:  [102.40176752]
mat_Sqrt:  [[0.15]]
grads:  [-0.08589489]
Stock Position:  -0.08589489005720724
Bond Position:  [24.87724105]


portfolio before change:  [16.20634943]
curr_Stock_Price:  101.02011544917397
curr_Factors:  [101.02011545]
mat_Sqrt:  [[0.15]]
grads:  [0.01571951]
Stock Position:  0.01571951448078142
Bond Position:  [14.61836226]


portfolio before change:  [16.18347769]
curr_Stock_Price:  99.33260862119053
curr_Factors:  [99.33260862]
mat_Sqrt:  [[0.15]]
grads:  [-0.02159368]
Stock Position:  -0.021593684369745264
Bond Position:  [18.32843468]


portfolio before change:  [16.17482595]
curr_Stock_Price:  99.9454924141453
curr_Factors:  [99.94549241]
mat_Sqrt:  [[0.15]]
grads:  [-0.03013961]
Stock Position:  -0.030139611639030662
Bond Position:  [19.18714427]


portfolio before change:  [16.19406949]
curr_Stock_Price:  99.46618458003437
curr_Factors:  [99.46618458]
mat_Sqrt:  [[0.15]]
grads:  [0.0323531]
Stock Position:  0.03235310393000793
Bond Position:  [12.97602968]


portfolio before change:  [16.23355591]
curr_Stock_Price:  100.5863865193243
curr_Factors:  [100.58638652]
mat_Sqrt:  [[0.15]]
grads:  [-0.00156462]
Stock Position:  -0.0015646228303744145
Bond Position:  [16.39093567]


portfolio before change:  [16.23984989]
curr_Stock_Price:  99.18302510931386
curr_Factors:  [99.18302511]
mat_Sqrt:  [[0.15]]
grads:  [0.04302838]
Stock Position:  0.04302838028196113
Bond Position:  [11.97216496]


portfolio before change:  [16.27106968]
curr_Stock_Price:  99.83901962969168
curr_Factors:  [99.83901963]
mat_Sqrt:  [[0.15]]
grads:  [0.11297189]
Stock Position:  0.11297189477986266
Bond Position:  [4.99206646]


portfolio before change:  [16.29186448]
curr_Stock_Price:  100.0120416192917
curr_Factors:  [100.01204162]
mat_Sqrt:  [[0.15]]
grads:  [0.02924957]
Stock Position:  0.02924957062910384
Bond Position:  [13.3665552]


portfolio before change:  [16.30509501]
curr_Stock_Price:  100.35011403587963
curr_Factors:  [100.35011404]
mat_Sqrt:  [[0.15]]
grads:  [0.06137451]
Stock Position:  0.06137450573236915
Bond Position:  [10.14615636]


portfolio before change:  [16.36210566]
curr_Stock_Price:  101.23767801396711
curr_Factors:  [101.23767801]
mat_Sqrt:  [[0.15]]
grads:  [-0.0342474]
Stock Position:  -0.03424739868348188
Bond Position:  [19.82923279]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.38494614]
Stock Price:  100.71552005504961
PL:  [15.66942609]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.82553853e-02]
 [ 6.38949477e-02]
 [-5.64346634e-02]
 [ 8.95257752e-02]
 [ 2.37478868e-03]
 [-2.04916955e-02]
 [-1.08947389e-02]
 [-1.01376874e-02]
 [ 5.73481551e-02]
 [-5.94066184e-03]
 [-4.66245730e-03]
 [ 2.91877625e-02]
 [ 1.85897736e-02]
 [-1.06546424e-02]
 [ 4.49464095e-02]
 [ 1.58980979e-02]
 [ 1.60093573e-02]
 [ 1.69424321e-02]
 [-2.03333599e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [28.61701241]
curr_Stock_Price:  101.2259294485658
curr_Factors:  [101.22592945]
mat_Sqrt:  [[0.15]]
grads:  [-0.12170257]
Stock Position:  -0.12170256847261543
Bond Position:  [40.93646802]


portfolio before change:  [28.3808757]
curr_Stock_Price:  103.2503082265658
curr_Factors:  [103.25030823]
mat_Sqrt:  [[0.15]]
grads:  [0.42596632]
Stock Position:  0.42596631770253496
Bond Position:  [-15.60027789]


portfolio before change:  [28.54539649]
curr_Stock_Price:  103.64569475294921
curr_Factors:  [103.64569475]
mat_Sqrt:  [[0.15]]
grads:  [-0.37623109]
Stock Position:  -0.3762310894360378
Bond Position:  [67.54012914]


portfolio before change:  [28.00523695]
curr_Stock_Price:  105.12629190310662
curr_Factors:  [105.1262919]
mat_Sqrt:  [[0.15]]
grads:  [0.5968385]
Stock Position:  0.5968385011338677
Bond Position:  [-34.73818153]


portfolio before change:  [28.61847304]
curr_Stock_Price:  106.16831870300267
curr_Factors:  [106.1683187]
mat_Sqrt:  [[0.15]]
grads:  [0.01583192]
Stock Position:  0.01583192450053925
Bond Position:  [26.93762423]


portfolio before change:  [28.62351566]
curr_Stock_Price:  106.06140645130506
curr_Factors:  [106.06140645]
mat_Sqrt:  [[0.15]]
grads:  [-0.1366113]
Stock Position:  -0.13661130321033438
Bond Position:  [43.11270261]


portfolio before change:  [28.74694877]
curr_Stock_Price:  105.2367778240646
curr_Factors:  [105.23677782]
mat_Sqrt:  [[0.15]]
grads:  [-0.07263159]
Stock Position:  -0.07263159280914602
Bond Position:  [36.39046357]


portfolio before change:  [28.59667745]
curr_Stock_Price:  107.43100304949476
curr_Factors:  [107.43100305]
mat_Sqrt:  [[0.15]]
grads:  [-0.06758458]
Stock Position:  -0.06758458247331067
Bond Position:  [35.85735694]


portfolio before change:  [28.52187934]
curr_Stock_Price:  108.67039175374153
curr_Factors:  [108.67039175]
mat_Sqrt:  [[0.15]]
grads:  [0.38232103]
Stock Position:  0.3823210342190597
Bond Position:  [-13.02509722]


portfolio before change:  [28.52428611]
curr_Stock_Price:  108.68520507735181
curr_Factors:  [108.68520508]
mat_Sqrt:  [[0.15]]
grads:  [-0.03960441]
Stock Position:  -0.03960441224515935
Bond Position:  [32.82869978]


portfolio before change:  [28.58787476]
curr_Stock_Price:  107.28686469989388
curr_Factors:  [107.2868647]
mat_Sqrt:  [[0.15]]
grads:  [-0.03108305]
Stock Position:  -0.03108304867044557
Bond Position:  [31.9226776]


portfolio before change:  [28.5687711]
curr_Stock_Price:  108.15825043367235
curr_Factors:  [108.15825043]
mat_Sqrt:  [[0.15]]
grads:  [0.19458508]
Stock Position:  0.1945850834311976
Bond Position:  [7.52278892]


portfolio before change:  [28.92396946]
curr_Stock_Price:  109.97399820810993
curr_Factors:  [109.97399821]
mat_Sqrt:  [[0.15]]
grads:  [0.12393182]
Stock Position:  0.12393182391700999
Bond Position:  [15.29469128]


portfolio before change:  [29.15515177]
curr_Stock_Price:  111.80854033334722
curr_Factors:  [111.80854033]
mat_Sqrt:  [[0.15]]
grads:  [-0.07103095]
Stock Position:  -0.07103094943225348
Bond Position:  [37.09701854]


portfolio before change:  [29.08107408]
curr_Stock_Price:  112.98201613033034
curr_Factors:  [112.98201613]
mat_Sqrt:  [[0.15]]
grads:  [0.29964273]
Stock Position:  0.2996427299932493
Bond Position:  [-4.77316567]


portfolio before change:  [28.81992987]
curr_Stock_Price:  112.1144804271608
curr_Factors:  [112.11448043]
mat_Sqrt:  [[0.15]]
grads:  [0.10598732]
Stock Position:  0.10598731949774556
Bond Position:  [16.93721662]


portfolio before change:  [28.8084174]
curr_Stock_Price:  111.96590310426306
curr_Factors:  [111.9659031]
mat_Sqrt:  [[0.15]]
grads:  [0.10672905]
Stock Position:  0.1067290487404995
Bond Position:  [16.85840307]


portfolio before change:  [28.76327493]
curr_Stock_Price:  111.50344617376419
curr_Factors:  [111.50344617]
mat_Sqrt:  [[0.15]]
grads:  [0.11294955]
Stock Position:  0.11294954724019086
Bond Position:  [16.16901117]


portfolio before change:  [28.66856333]
curr_Stock_Price:  110.62912335652464
curr_Factors:  [110.62912336]
mat_Sqrt:  [[0.15]]
grads:  [-0.13555573]
Stock Position:  -0.1355557323431725
Bond Position:  [43.66497516]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [28.57777694]
Stock Price:  111.37939772900671
PL:  [17.19837921]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.77973397e-03]
 [-5.32784847e-03]
 [-4.89202128e-03]
 [ 6.40403010e-03]
 [ 5.71415572e-03]
 [-1.03468989e-02]
 [ 1.43600898e-02]
 [-1.24549512e-02]
 [-1.01593113e-02]
 [ 4.60215003e-03]
 [-3.07759052e-03]
 [-4.38360224e-03]
 [ 4.87692823e-03]
 [-5.46258585e-04]
 [ 3.66026190e-04]
 [ 2.18601789e-02]
 [ 2.14708730e-03]
 [ 1.03513008e-02]
 [-6.60882247e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.22898997]
curr_Stock_Price:  99.59952819755146
curr_Factors:  [99.5995282]
mat_Sqrt:  [[0.15]]
grads:  [0.01853156]
Stock Position:  0.01853155983143827
Bond Position:  [-9.07472459]


portfolio before change:  [-7.24130099]
curr_Stock_Price:  99.05763897956882
curr_Factors:  [99.05763898]
mat_Sqrt:  [[0.15]]
grads:  [-0.03551899]
Stock Position:  -0.03551898979420469
Bond Position:  [-3.72287372]


portfolio before change:  [-7.27487934]
curr_Stock_Price:  99.97679572717313
curr_Factors:  [99.97679573]
mat_Sqrt:  [[0.15]]
grads:  [-0.03261348]
Stock Position:  -0.03261347518133462
Bond Position:  [-4.0142886]


portfolio before change:  [-7.30722012]
curr_Stock_Price:  100.93765871816811
curr_Factors:  [100.93765872]
mat_Sqrt:  [[0.15]]
grads:  [0.04269353]
Stock Position:  0.04269353403313847
Bond Position:  [-11.61660549]


portfolio before change:  [-7.27456421]
curr_Stock_Price:  101.77058173388188
curr_Factors:  [101.77058173]
mat_Sqrt:  [[0.15]]
grads:  [0.03809437]
Stock Position:  0.03809437144596672
Bond Position:  [-11.15145055]


portfolio before change:  [-7.2686736]
curr_Stock_Price:  101.99840588351184
curr_Factors:  [101.99840588]
mat_Sqrt:  [[0.15]]
grads:  [-0.06897933]
Stock Position:  -0.06897932598404194
Bond Position:  [-0.23289231]


portfolio before change:  [-7.08930594]
curr_Stock_Price:  99.39725130492751
curr_Factors:  [99.3972513]
mat_Sqrt:  [[0.15]]
grads:  [0.09573393]
Stock Position:  0.09573393203817802
Bond Position:  [-16.60499564]


portfolio before change:  [-7.07152275]
curr_Stock_Price:  99.62637551682087
curr_Factors:  [99.62637552]
mat_Sqrt:  [[0.15]]
grads:  [-0.08303301]
Stock Position:  -0.0830330078198646
Bond Position:  [1.20075487]


portfolio before change:  [-7.12083124]
curr_Stock_Price:  100.22383332610559
curr_Factors:  [100.22383333]
mat_Sqrt:  [[0.15]]
grads:  [-0.06772874]
Stock Position:  -0.06772874212160748
Bond Position:  [-0.33279708]


portfolio before change:  [-7.11675464]
curr_Stock_Price:  100.162414680704
curr_Factors:  [100.16241468]
mat_Sqrt:  [[0.15]]
grads:  [0.030681]
Stock Position:  0.030681000228539344
Bond Position:  [-10.18983771]


portfolio before change:  [-7.13407249]
curr_Stock_Price:  99.68100694926957
curr_Factors:  [99.68100695]
mat_Sqrt:  [[0.15]]
grads:  [-0.02051727]
Stock Position:  -0.0205172701573107
Bond Position:  [-5.08889034]


portfolio before change:  [-7.13581498]
curr_Stock_Price:  99.70391982873791
curr_Factors:  [99.70391983]
mat_Sqrt:  [[0.15]]
grads:  [-0.02922401]
Stock Position:  -0.029224014923972114
Bond Position:  [-4.22206614]


portfolio before change:  [-7.12089761]
curr_Stock_Price:  99.15734802785951
curr_Factors:  [99.15734803]
mat_Sqrt:  [[0.15]]
grads:  [0.03251285]
Stock Position:  0.03251285484471456
Bond Position:  [-10.34478607]


portfolio before change:  [-7.1028389]
curr_Stock_Price:  99.79233477577979
curr_Factors:  [99.79233478]
mat_Sqrt:  [[0.15]]
grads:  [-0.00364172]
Stock Position:  -0.0036417239033139466
Bond Position:  [-6.73942277]


portfolio before change:  [-7.11114619]
curr_Stock_Price:  101.61076597352195
curr_Factors:  [101.61076597]
mat_Sqrt:  [[0.15]]
grads:  [0.00244017]
Stock Position:  0.0024401745981
Bond Position:  [-7.3590942]


portfolio before change:  [-7.11369181]
curr_Stock_Price:  101.32159838056684
curr_Factors:  [101.32159838]
mat_Sqrt:  [[0.15]]
grads:  [0.14573453]
Stock Position:  0.14573452624389713
Bond Position:  [-21.87974695]


portfolio before change:  [-7.12312485]
curr_Stock_Price:  101.29440908622593
curr_Factors:  [101.29440909]
mat_Sqrt:  [[0.15]]
grads:  [0.01431392]
Stock Position:  0.014313915333101952
Bond Position:  [-8.57304445]


portfolio before change:  [-7.1273284]
curr_Stock_Price:  101.1504915016228
curr_Factors:  [101.1504915]
mat_Sqrt:  [[0.15]]
grads:  [0.06900867]
Stock Position:  0.06900867189028999
Bond Position:  [-14.10758948]


portfolio before change:  [-7.08855693]
curr_Stock_Price:  101.76344080331869
curr_Factors:  [101.7634408]
mat_Sqrt:  [[0.15]]
grads:  [-0.04405882]
Stock Position:  -0.044058816449765476
Bond Position:  [-2.60498017]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.99775868]
Stock Price:  99.68781597286633
PL:  [-6.99775868]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 3.30601096]
 [-0.0089642 ]
 [ 0.04627306]
 [-0.02044274]
 [-0.01179691]
 [ 0.00571658]
 [-0.01080546]
 [-0.00985502]
 [-0.00658546]
 [ 0.04248158]
 [-0.00414669]
 [-0.00559023]
 [ 0.02600467]
 [ 0.01618134]
 [-0.0048248 ]
 [ 0.0209515 ]
 [ 0.019069  ]
 [ 0.00953818]
 [ 0.01528195]
 [-0.01737324]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.95555845]
curr_Stock_Price:  100.46996761846295
curr_Factors:  [100.46996762]
mat_Sqrt:  [[0.15]]
grads:  [-0.05976131]
Stock Position:  -0.05976130710273286
Bond Position:  [17.95977504]


portfolio before change:  [11.83512395]
curr_Stock_Price:  102.56036701921096
curr_Factors:  [102.56036702]
mat_Sqrt:  [[0.15]]
grads:  [0.30848707]
Stock Position:  0.3084870670198683
Bond Position:  [-19.80342286]


portfolio before change:  [11.4447473]
curr_Stock_Price:  101.31096237183385
curr_Factors:  [101.31096237]
mat_Sqrt:  [[0.15]]
grads:  [-0.13628494]
Stock Position:  -0.13628494271839028
Bond Position:  [25.25190601]


portfolio before change:  [11.6067146]
curr_Stock_Price:  100.16884405867064
curr_Factors:  [100.16884406]
mat_Sqrt:  [[0.15]]
grads:  [-0.07864605]
Stock Position:  -0.07864605076656592
Bond Position:  [19.48459859]


portfolio before change:  [11.52633807]
curr_Stock_Price:  101.25279276317879
curr_Factors:  [101.25279276]
mat_Sqrt:  [[0.15]]
grads:  [0.03811052]
Stock Position:  0.03811051789218229
Bond Position:  [7.6675417]


portfolio before change:  [11.56395578]
curr_Stock_Price:  102.18955740739715
curr_Factors:  [102.18955741]
mat_Sqrt:  [[0.15]]
grads:  [-0.07203639]
Stock Position:  -0.07203638825206668
Bond Position:  [18.92532242]


portfolio before change:  [11.37042384]
curr_Stock_Price:  104.94183122932212
curr_Factors:  [104.94183123]
mat_Sqrt:  [[0.15]]
grads:  [-0.06570016]
Stock Position:  -0.06570015889906793
Bond Position:  [18.26511883]


portfolio before change:  [11.32873495]
curr_Stock_Price:  105.64587420721577
curr_Factors:  [105.64587421]
mat_Sqrt:  [[0.15]]
grads:  [-0.04390306]
Stock Position:  -0.04390305898322817
Bond Position:  [15.966912]


portfolio before change:  [11.25831377]
curr_Stock_Price:  107.34082235277722
curr_Factors:  [107.34082235]
mat_Sqrt:  [[0.15]]
grads:  [0.28321052]
Stock Position:  0.2832105171538936
Bond Position:  [-19.14173604]


portfolio before change:  [11.27071256]
curr_Stock_Price:  107.40150094460024
curr_Factors:  [107.40150094]
mat_Sqrt:  [[0.15]]
grads:  [-0.02764462]
Stock Position:  -0.02764461833649925
Bond Position:  [14.23978606]


portfolio before change:  [11.24520233]
curr_Stock_Price:  108.45308412076959
curr_Factors:  [108.45308412]
mat_Sqrt:  [[0.15]]
grads:  [-0.03726823]
Stock Position:  -0.03726823191046755
Bond Position:  [15.28705702]


portfolio before change:  [11.27898469]
curr_Stock_Price:  107.6491791508046
curr_Factors:  [107.64917915]
mat_Sqrt:  [[0.15]]
grads:  [0.17336448]
Stock Position:  0.17336447708246758
Bond Position:  [-7.38355896]


portfolio before change:  [11.37882867]
curr_Stock_Price:  108.23574740816485
curr_Factors:  [108.23574741]
mat_Sqrt:  [[0.15]]
grads:  [0.10787559]
Stock Position:  0.10787558692943539
Bond Position:  [-0.29716611]


portfolio before change:  [11.25388637]
curr_Stock_Price:  107.07822877071638
curr_Factors:  [107.07822877]
mat_Sqrt:  [[0.15]]
grads:  [-0.03216533]
Stock Position:  -0.03216533206372753
Bond Position:  [14.69809315]


portfolio before change:  [11.24240371]
curr_Stock_Price:  107.54947021990586
curr_Factors:  [107.54947022]
mat_Sqrt:  [[0.15]]
grads:  [0.13967665]
Stock Position:  0.13967664641442476
Bond Position:  [-3.77974561]


portfolio before change:  [11.32281293]
curr_Stock_Price:  108.13191740614901
curr_Factors:  [108.13191741]
mat_Sqrt:  [[0.15]]
grads:  [0.12712665]
Stock Position:  0.1271266526951731
Bond Position:  [-2.42363578]


portfolio before change:  [11.19384224]
curr_Stock_Price:  107.12217866856564
curr_Factors:  [107.12217867]
mat_Sqrt:  [[0.15]]
grads:  [0.06358789]
Stock Position:  0.06358788826671738
Bond Position:  [4.38216911]


portfolio before change:  [11.2489773]
curr_Stock_Price:  107.97201643036233
curr_Factors:  [107.97201643]
mat_Sqrt:  [[0.15]]
grads:  [0.10187969]
Stock Position:  0.10187969367344367
Bond Position:  [0.24882134]


portfolio before change:  [11.34684856]
curr_Stock_Price:  108.9320609396927
curr_Factors:  [108.93206094]
mat_Sqrt:  [[0.15]]
grads:  [-0.11582157]
Stock Position:  -0.11582157428183457
Bond Position:  [23.96353134]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.37735835]
Stock Price:  108.72037183173282
PL:  [2.65698652]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.04890849e-03]
 [-3.71103036e-03]
 [-6.17410789e-03]
 [-9.69339187e-03]
 [ 3.53271596e-03]
 [-1.09901939e-02]
 [ 1.30802408e-02]
 [-4.38923138e-02]
 [ 3.22594771e-03]
 [ 6.52999874e-03]
 [-1.12437451e-02]
 [ 2.12087016e-03]
 [ 5.84678551e-03]
 [-9.93837650e-04]
 [ 3.29936356e-03]
 [ 1.90782074e-02]
 [ 5.78571887e-03]
 [ 6.91998962e-03]
 [-5.44550237e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.11657852]
curr_Stock_Price:  100.15967010209592
curr_Factors:  [100.1596701]
mat_Sqrt:  [[0.15]]
grads:  [-0.01365939]
Stock Position:  -0.013659389939527773
Bond Position:  [6.48469851]


portfolio before change:  [5.13684887]
curr_Stock_Price:  98.79438404545893
curr_Factors:  [98.79438405]
mat_Sqrt:  [[0.15]]
grads:  [-0.0247402]
Stock Position:  -0.02474020239937188
Bond Position:  [7.58104193]


portfolio before change:  [5.13687485]
curr_Stock_Price:  98.86995033692965
curr_Factors:  [98.86995034]
mat_Sqrt:  [[0.15]]
grads:  [-0.04116072]
Stock Position:  -0.041160719252766396
Bond Position:  [9.20643311]


portfolio before change:  [5.17310948]
curr_Stock_Price:  98.04555419957883
curr_Factors:  [98.0455542]
mat_Sqrt:  [[0.15]]
grads:  [-0.06462261]
Stock Position:  -0.0646226124782869
Bond Position:  [11.50906933]


portfolio before change:  [5.12220157]
curr_Stock_Price:  98.87785623542484
curr_Factors:  [98.87785624]
mat_Sqrt:  [[0.15]]
grads:  [0.02355144]
Stock Position:  0.023551439711697097
Bond Position:  [2.7934857]


portfolio before change:  [5.08906983]
curr_Stock_Price:  97.44141754268301
curr_Factors:  [97.44141754]
mat_Sqrt:  [[0.15]]
grads:  [-0.07326796]
Stock Position:  -0.07326795925080333
Bond Position:  [12.22840364]


portfolio before change:  [5.06826485]
curr_Stock_Price:  97.76710513218949
curr_Factors:  [97.76710513]
mat_Sqrt:  [[0.15]]
grads:  [0.08720161]
Stock Position:  0.08720160527643984
Bond Position:  [-3.45718366]


portfolio before change:  [4.89204112]
curr_Stock_Price:  95.75614071851733
curr_Factors:  [95.75614072]
mat_Sqrt:  [[0.15]]
grads:  [-0.29261543]
Stock Position:  -0.2926154253694659
Bond Position:  [32.91176497]


portfolio before change:  [4.87581347]
curr_Stock_Price:  95.8397201057284
curr_Factors:  [95.83972011]
mat_Sqrt:  [[0.15]]
grads:  [0.02150632]
Stock Position:  0.021506318095784578
Bond Position:  [2.81465397]


portfolio before change:  [4.86622435]
curr_Stock_Price:  95.36112250789257
curr_Factors:  [95.36112251]
mat_Sqrt:  [[0.15]]
grads:  [0.04353332]
Stock Position:  0.043533324951216285
Bond Position:  [0.71483762]


portfolio before change:  [4.8728144]
curr_Stock_Price:  95.50839615317317
curr_Factors:  [95.50839615]
mat_Sqrt:  [[0.15]]
grads:  [-0.0749583]
Stock Position:  -0.07495830086649723
Bond Position:  [12.03196149]


portfolio before change:  [4.69313274]
curr_Stock_Price:  97.94561823736096
curr_Factors:  [97.94561824]
mat_Sqrt:  [[0.15]]
grads:  [0.01413913]
Stock Position:  0.014139134369648133
Bond Position:  [3.30826648]


portfolio before change:  [4.68288995]
curr_Stock_Price:  97.16268809645302
curr_Factors:  [97.1626881]
mat_Sqrt:  [[0.15]]
grads:  [0.03897857]
Stock Position:  0.03897857004038328
Bond Position:  [0.89562731]


portfolio before change:  [4.72196108]
curr_Stock_Price:  98.1593174664328
curr_Factors:  [98.15931747]
mat_Sqrt:  [[0.15]]
grads:  [-0.00662558]
Stock Position:  -0.006625584336607229
Bond Position:  [5.37232391]


portfolio before change:  [4.70929766]
curr_Stock_Price:  100.2733445681139
curr_Factors:  [100.27334457]
mat_Sqrt:  [[0.15]]
grads:  [0.02199576]
Stock Position:  0.021995757086825017
Bond Position:  [2.50370953]


portfolio before change:  [4.7130666]
curr_Stock_Price:  100.41623271040093
curr_Factors:  [100.41623271]
mat_Sqrt:  [[0.15]]
grads:  [0.12718805]
Stock Position:  0.12718804915104073
Bond Position:  [-8.05867814]


portfolio before change:  [4.48076309]
curr_Stock_Price:  98.60561774284582
curr_Factors:  [98.60561774]
mat_Sqrt:  [[0.15]]
grads:  [0.03857146]
Stock Position:  0.03857145910166724
Bond Position:  [0.67740054]


portfolio before change:  [4.50416624]
curr_Stock_Price:  99.20797442058164
curr_Factors:  [99.20797442]
mat_Sqrt:  [[0.15]]
grads:  [0.04613326]
Stock Position:  0.04613326411165824
Bond Position:  [-0.07262145]


portfolio before change:  [4.53754281]
curr_Stock_Price:  99.93184966995335
curr_Factors:  [99.93184967]
mat_Sqrt:  [[0.15]]
grads:  [-0.03630335]
Stock Position:  -0.03630334914736089
Bond Position:  [8.16540364]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.50812851]
Stock Price:  100.7983236357045
PL:  [3.70980487]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.73713787e-02]
 [-1.06345677e-02]
 [-4.31191792e-03]
 [-8.14691052e-03]
 [ 3.04612327e-03]
 [-1.07091685e-02]
 [ 1.32325455e-02]
 [-2.50004921e-02]
 [-1.73215057e-03]
 [ 1.02424945e-02]
 [-6.25760669e-03]
 [ 8.81383943e-03]
 [ 5.51765394e-03]
 [-1.05332784e-03]
 [ 8.13318877e-03]
 [ 1.87600843e-02]
 [ 6.97876612e-03]
 [ 5.75009154e-04]
 [-9.07347136e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.80513764]
curr_Stock_Price:  101.09834934651775
curr_Factors:  [101.09834935]
mat_Sqrt:  [[0.15]]
grads:  [-0.11580919]
Stock Position:  -0.11580919126885722
Bond Position:  [37.51325571]


portfolio before change:  [25.95498231]
curr_Stock_Price:  99.8854474934871
curr_Factors:  [99.88544749]
mat_Sqrt:  [[0.15]]
grads:  [-0.07089712]
Stock Position:  -0.07089711792126425
Bond Position:  [33.03657266]


portfolio before change:  [26.00238843]
curr_Stock_Price:  99.33329601131486
curr_Factors:  [99.33329601]
mat_Sqrt:  [[0.15]]
grads:  [-0.02874612]
Stock Position:  -0.028746119496162407
Bond Position:  [28.85783523]


portfolio before change:  [26.04917342]
curr_Stock_Price:  97.95677534300998
curr_Factors:  [97.95677534]
mat_Sqrt:  [[0.15]]
grads:  [-0.05431274]
Stock Position:  -0.054312736829065685
Bond Position:  [31.36947398]


portfolio before change:  [26.01248414]
curr_Stock_Price:  98.77670507179532
curr_Factors:  [98.77670507]
mat_Sqrt:  [[0.15]]
grads:  [0.02030749]
Stock Position:  0.02030748844919986
Bond Position:  [24.00657734]


portfolio before change:  [26.01242145]
curr_Stock_Price:  98.47804260562317
curr_Factors:  [98.47804261]
mat_Sqrt:  [[0.15]]
grads:  [-0.07139446]
Stock Position:  -0.07139445655449453
Bond Position:  [33.04320778]


portfolio before change:  [26.05923192]
curr_Stock_Price:  97.93810379939094
curr_Factors:  [97.9381038]
mat_Sqrt:  [[0.15]]
grads:  [0.08821697]
Stock Position:  0.08821697031566869
Bond Position:  [17.41942913]


portfolio before change:  [26.15322463]
curr_Stock_Price:  98.95420425865227
curr_Factors:  [98.95420426]
mat_Sqrt:  [[0.15]]
grads:  [-0.16666995]
Stock Position:  -0.16666994722431744
Bond Position:  [42.64591663]


portfolio before change:  [26.15904627]
curr_Stock_Price:  98.98325067546621
curr_Factors:  [98.98325068]
mat_Sqrt:  [[0.15]]
grads:  [-0.01154767]
Stock Position:  -0.011547670479961508
Bond Position:  [27.30207224]


portfolio before change:  [26.17738668]
curr_Stock_Price:  97.9861636610922
curr_Factors:  [97.98616366]
mat_Sqrt:  [[0.15]]
grads:  [0.0682833]
Stock Position:  0.06828329675927947
Bond Position:  [19.48656839]


portfolio before change:  [26.14794117]
curr_Stock_Price:  97.48358450561842
curr_Factors:  [97.48358451]
mat_Sqrt:  [[0.15]]
grads:  [-0.04171738]
Stock Position:  -0.04171737793535083
Bond Position:  [30.21470071]


portfolio before change:  [26.19394775]
curr_Stock_Price:  96.56185924615563
curr_Factors:  [96.56185925]
mat_Sqrt:  [[0.15]]
grads:  [0.05875893]
Stock Position:  0.05875892953503686
Bond Position:  [20.52007627]


portfolio before change:  [26.27318203]
curr_Stock_Price:  97.8230057764324
curr_Factors:  [97.82300578]
mat_Sqrt:  [[0.15]]
grads:  [0.03678436]
Stock Position:  0.03678435958273166
Bond Position:  [22.67482541]


portfolio before change:  [26.2744159]
curr_Stock_Price:  97.70242345805293
curr_Factors:  [97.70242346]
mat_Sqrt:  [[0.15]]
grads:  [-0.00702219]
Stock Position:  -0.007022185615399884
Bond Position:  [26.96050045]


portfolio before change:  [26.2827898]
curr_Stock_Price:  97.46988393443156
curr_Factors:  [97.46988393]
mat_Sqrt:  [[0.15]]
grads:  [0.05422126]
Stock Position:  0.05422125846113124
Bond Position:  [20.99785003]


portfolio before change:  [26.29008806]
curr_Stock_Price:  97.50765764281098
curr_Factors:  [97.50765764]
mat_Sqrt:  [[0.15]]
grads:  [0.12506723]
Stock Position:  0.12506722893570954
Bond Position:  [14.09507552]


portfolio before change:  [26.2356413]
curr_Stock_Price:  97.0441391445309
curr_Factors:  [97.04413914]
mat_Sqrt:  [[0.15]]
grads:  [0.04652511]
Stock Position:  0.04652510746478011
Bond Position:  [21.72065229]


portfolio before change:  [26.19211964]
curr_Stock_Price:  95.99196531173428
curr_Factors:  [95.99196531]
mat_Sqrt:  [[0.15]]
grads:  [0.00383339]
Stock Position:  0.003833394357225124
Bond Position:  [25.82414458]


portfolio before change:  [26.19547784]
curr_Stock_Price:  95.18363802441932
curr_Factors:  [95.18363802]
mat_Sqrt:  [[0.15]]
grads:  [-0.06048981]
Stock Position:  -0.060489809081639666
Bond Position:  [31.95311793]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [26.0900743]
Stock Price:  97.05821533090491
PL:  [26.0900743]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.06261462e-02]
 [-9.81486841e-03]
 [-4.37404498e-03]
 [-1.45351378e-02]
 [ 6.60648361e-03]
 [-1.00157249e-02]
 [ 1.41483356e-02]
 [-2.95399976e-02]
 [-8.36639769e-03]
 [ 1.05801402e-02]
 [-3.06612797e-03]
 [-2.84694148e-03]
 [ 4.88108203e-03]
 [-7.76527603e-05]
 [ 1.70846554e-03]
 [ 2.26328054e-02]
 [ 2.58801219e-03]
 [ 1.25319054e-02]
 [-1.10092437e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.67405056]
curr_Stock_Price:  100.54793887128817
curr_Factors:  [100.54793887]
mat_Sqrt:  [[0.15]]
grads:  [-0.07084097]
Stock Position:  -0.07084097485603524
Bond Position:  [20.79696457]


portfolio before change:  [13.71414281]
curr_Stock_Price:  100.05539392910461
curr_Factors:  [100.05539393]
mat_Sqrt:  [[0.15]]
grads:  [-0.06543246]
Stock Position:  -0.06543245603744258
Bond Position:  [20.26101298]


portfolio before change:  [13.76800038]
curr_Stock_Price:  99.30971372966809
curr_Factors:  [99.30971373]
mat_Sqrt:  [[0.15]]
grads:  [-0.0291603]
Stock Position:  -0.029160299846642316
Bond Position:  [16.66390141]


portfolio before change:  [13.7917416]
curr_Stock_Price:  98.6384340543194
curr_Factors:  [98.63843405]
mat_Sqrt:  [[0.15]]
grads:  [-0.09690092]
Stock Position:  -0.09690091897418933
Bond Position:  [23.3498965]


portfolio before change:  [13.6456498]
curr_Stock_Price:  100.20632426317027
curr_Factors:  [100.20632426]
mat_Sqrt:  [[0.15]]
grads:  [0.04404322]
Stock Position:  0.04404322406584712
Bond Position:  [9.23224021]


portfolio before change:  [13.62814318]
curr_Stock_Price:  99.75642616155456
curr_Factors:  [99.75642616]
mat_Sqrt:  [[0.15]]
grads:  [-0.0667715]
Stock Position:  -0.06677149934726262
Bond Position:  [20.28902933]


portfolio before change:  [13.6205072]
curr_Stock_Price:  99.94676000654069
curr_Factors:  [99.94676001]
mat_Sqrt:  [[0.15]]
grads:  [0.09432224]
Stock Position:  0.09432223739462167
Bond Position:  [4.19330518]


portfolio before change:  [13.49971544]
curr_Stock_Price:  98.65501560513749
curr_Factors:  [98.65501561]
mat_Sqrt:  [[0.15]]
grads:  [-0.19693332]
Stock Position:  -0.19693331731040395
Bond Position:  [32.92817493]


portfolio before change:  [13.21235002]
curr_Stock_Price:  100.15602362897243
curr_Factors:  [100.15602363]
mat_Sqrt:  [[0.15]]
grads:  [-0.05577598]
Stock Position:  -0.05577598461119191
Bond Position:  [18.79865085]


portfolio before change:  [13.30536384]
curr_Stock_Price:  98.57266174892445
curr_Factors:  [98.57266175]
mat_Sqrt:  [[0.15]]
grads:  [0.07053427]
Stock Position:  0.07053426814581837
Bond Position:  [6.35261328]


portfolio before change:  [13.38687307]
curr_Stock_Price:  99.70574050766032
curr_Factors:  [99.70574051]
mat_Sqrt:  [[0.15]]
grads:  [-0.02044085]
Stock Position:  -0.02044085316092989
Bond Position:  [15.42494347]


portfolio before change:  [13.40198549]
curr_Stock_Price:  99.15509304791087
curr_Factors:  [99.15509305]
mat_Sqrt:  [[0.15]]
grads:  [-0.01897961]
Stock Position:  -0.0189796098747089
Bond Position:  [15.28391047]


portfolio before change:  [13.38254046]
curr_Stock_Price:  100.3809606114391
curr_Factors:  [100.38096061]
mat_Sqrt:  [[0.15]]
grads:  [0.03254055]
Stock Position:  0.032540546849544445
Bond Position:  [10.11608911]


portfolio before change:  [13.40196305]
curr_Stock_Price:  100.90010536665731
curr_Factors:  [100.90010537]
mat_Sqrt:  [[0.15]]
grads:  [-0.00051769]
Stock Position:  -0.0005176850687793192
Bond Position:  [13.45419753]


portfolio before change:  [13.4053478]
curr_Stock_Price:  100.8599671464059
curr_Factors:  [100.85996715]
mat_Sqrt:  [[0.15]]
grads:  [0.01138977]
Stock Position:  0.011389770266145242
Bond Position:  [12.25657595]


portfolio before change:  [13.42213082]
curr_Stock_Price:  102.06442424881277
curr_Factors:  [102.06442425]
mat_Sqrt:  [[0.15]]
grads:  [0.15088537]
Stock Position:  0.1508853691249786
Bond Position:  [-1.97789751]


portfolio before change:  [13.27158645]
curr_Stock_Price:  101.06996179745984
curr_Factors:  [101.0699618]
mat_Sqrt:  [[0.15]]
grads:  [0.01725341]
Stock Position:  0.017253414577398807
Bond Position:  [11.52778449]


portfolio before change:  [13.30688254]
curr_Stock_Price:  102.94864976163004
curr_Factors:  [102.94864976]
mat_Sqrt:  [[0.15]]
grads:  [0.08354604]
Stock Position:  0.08354603623593987
Bond Position:  [4.70593091]


portfolio before change:  [13.34316493]
curr_Stock_Price:  103.36884644349553
curr_Factors:  [103.36884644]
mat_Sqrt:  [[0.15]]
grads:  [-0.07339496]
Stock Position:  -0.07339495771295154
Bond Position:  [20.92991705]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.2752431]
Stock Price:  104.3655765428139
PL:  [8.90966656]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.68725765e-03]
 [-1.08977611e-03]
 [-1.02975469e-02]
 [-1.53876404e-02]
 [ 6.13144855e-03]
 [-9.94858102e-03]
 [ 1.39398611e-02]
 [-2.83373838e-02]
 [ 2.15899260e-03]
 [ 6.22946347e-03]
 [-1.24889870e-02]
 [ 1.29489920e-02]
 [ 6.40429406e-03]
 [-1.54114076e-03]
 [ 7.49282309e-03]
 [ 2.15062191e-02]
 [ 1.11676228e-02]
 [ 3.99394493e-04]
 [-7.26688835e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.83249201]
curr_Stock_Price:  99.34528666116236
curr_Factors:  [99.34528666]
mat_Sqrt:  [[0.15]]
grads:  [0.01791505]
Stock Position:  0.01791505098538608
Bond Position:  [-14.61226788]


portfolio before change:  [-12.85271169]
curr_Stock_Price:  98.42058057759574
curr_Factors:  [98.42058058]
mat_Sqrt:  [[0.15]]
grads:  [-0.00726517]
Stock Position:  -0.0072651740501279306
Bond Position:  [-12.13766904]


portfolio before change:  [-12.85114863]
curr_Stock_Price:  97.78771867371843
curr_Factors:  [97.78771867]
mat_Sqrt:  [[0.15]]
grads:  [-0.06865031]
Stock Position:  -0.06865031253184364
Bond Position:  [-6.13799118]


portfolio before change:  [-12.92307962]
curr_Stock_Price:  98.81315180000419
curr_Factors:  [98.8131518]
mat_Sqrt:  [[0.15]]
grads:  [-0.10258427]
Stock Position:  -0.10258426951868312
Bond Position:  [-2.78640463]


portfolio before change:  [-12.99829912]
curr_Stock_Price:  99.53960632293429
curr_Factors:  [99.53960632]
mat_Sqrt:  [[0.15]]
grads:  [0.04087632]
Stock Position:  0.040876323642954765
Bond Position:  [-17.06711228]


portfolio before change:  [-12.99005815]
curr_Stock_Price:  99.84560937101242
curr_Factors:  [99.84560937]
mat_Sqrt:  [[0.15]]
grads:  [-0.06632387]
Stock Position:  -0.0663238734649814
Bond Position:  [-6.36791059]


portfolio before change:  [-12.93765417]
curr_Stock_Price:  99.03148089815781
curr_Factors:  [99.0314809]
mat_Sqrt:  [[0.15]]
grads:  [0.09293241]
Stock Position:  0.09293240713962223
Bond Position:  [-22.14088808]


portfolio before change:  [-12.97080994]
curr_Stock_Price:  98.73427718753803
curr_Factors:  [98.73427719]
mat_Sqrt:  [[0.15]]
grads:  [-0.18891589]
Stock Position:  -0.18891589227233474
Bond Position:  [5.68166413]


portfolio before change:  [-12.5303437]
curr_Stock_Price:  96.41025008959161
curr_Factors:  [96.41025009]
mat_Sqrt:  [[0.15]]
grads:  [0.01439328]
Stock Position:  0.014393283972763283
Bond Position:  [-13.91800381]


portfolio before change:  [-12.55165888]
curr_Stock_Price:  95.17111341472453
curr_Factors:  [95.17111341]
mat_Sqrt:  [[0.15]]
grads:  [0.04152976]
Stock Position:  0.04152975648926386
Bond Position:  [-16.50409204]


portfolio before change:  [-12.5618301]
curr_Stock_Price:  95.02556280057804
curr_Factors:  [95.0255628]
mat_Sqrt:  [[0.15]]
grads:  [-0.08325991]
Stock Position:  -0.08325991304645072
Bond Position:  [-4.65001]


portfolio before change:  [-12.62654808]
curr_Stock_Price:  95.78889936539146
curr_Factors:  [95.78889937]
mat_Sqrt:  [[0.15]]
grads:  [0.08632661]
Stock Position:  0.08632661308108282
Bond Position:  [-20.89567934]


portfolio before change:  [-12.62713356]
curr_Stock_Price:  95.84263824382407
curr_Factors:  [95.84263824]
mat_Sqrt:  [[0.15]]
grads:  [0.04269529]
Stock Position:  0.04269529370280324
Bond Position:  [-16.71916315]


portfolio before change:  [-12.64922644]
curr_Stock_Price:  95.42309396151859
curr_Factors:  [95.42309396]
mat_Sqrt:  [[0.15]]
grads:  [-0.01027427]
Stock Position:  -0.01027427175887193
Bond Position:  [-11.66882364]


portfolio before change:  [-12.64824732]
curr_Stock_Price:  95.04382738153714
curr_Factors:  [95.04382738]
mat_Sqrt:  [[0.15]]
grads:  [0.04995215]
Stock Position:  0.04995215394996646
Bond Position:  [-17.39589122]


portfolio before change:  [-12.63968735]
curr_Stock_Price:  95.30226455132161
curr_Factors:  [95.30226455]
mat_Sqrt:  [[0.15]]
grads:  [0.14337479]
Stock Position:  0.14337479388957486
Bond Position:  [-26.30362988]


portfolio before change:  [-12.7880152]
curr_Stock_Price:  94.31358919477441
curr_Factors:  [94.31358919]
mat_Sqrt:  [[0.15]]
grads:  [0.07445082]
Stock Position:  0.07445081846882035
Bond Position:  [-19.80973911]


portfolio before change:  [-12.75646569]
curr_Stock_Price:  94.80388016961217
curr_Factors:  [94.80388017]
mat_Sqrt:  [[0.15]]
grads:  [0.00266263]
Stock Position:  0.002662629956295346
Bond Position:  [-13.00889334]


portfolio before change:  [-12.75581383]
curr_Stock_Price:  96.27028568841921
curr_Factors:  [96.27028569]
mat_Sqrt:  [[0.15]]
grads:  [-0.04844592]
Stock Position:  -0.04844592230275655
Bond Position:  [-8.09191105]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.78041321]
Stock Price:  96.73629293644076
PL:  [-12.78041321]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.63457385e-02]
 [ 9.76474555e-03]
 [-3.33816502e-02]
 [-1.84187085e-02]
 [ 2.69990400e-03]
 [-9.49794889e-03]
 [ 6.84480624e-03]
 [ 1.04772801e-02]
 [-2.41770186e-03]
 [ 9.19835479e-03]
 [-4.33029575e-03]
 [ 4.29696929e-03]
 [ 6.20918553e-03]
 [-1.53957853e-03]
 [ 7.55265442e-03]
 [ 2.17071508e-02]
 [ 1.07452185e-02]
 [ 4.81599550e-04]
 [-9.11290638e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.09379808]
curr_Stock_Price:  100.97533071813464
curr_Factors:  [100.97533072]
mat_Sqrt:  [[0.15]]
grads:  [-0.10897159]
Stock Position:  -0.1089715897680794
Bond Position:  [34.0972404]


portfolio before change:  [23.10584078]
curr_Stock_Price:  100.94305324070037
curr_Factors:  [100.94305324]
mat_Sqrt:  [[0.15]]
grads:  [0.0650983]
Stock Position:  0.06509830365448774
Bond Position:  [16.53461925]


portfolio before change:  [23.18552539]
curr_Stock_Price:  102.10361242535053
curr_Factors:  [102.10361243]
mat_Sqrt:  [[0.15]]
grads:  [-0.22254433]
Stock Position:  -0.22254433451004604
Bond Position:  [45.90810587]


portfolio before change:  [23.67443689]
curr_Stock_Price:  99.95827344322396
curr_Factors:  [99.95827344]
mat_Sqrt:  [[0.15]]
grads:  [-0.12279139]
Stock Position:  -0.12279139008067352
Bond Position:  [35.94845223]


portfolio before change:  [23.83734737]
curr_Stock_Price:  98.70474706113487
curr_Factors:  [98.70474706]
mat_Sqrt:  [[0.15]]
grads:  [0.01799936]
Stock Position:  0.01799935997418629
Bond Position:  [22.0607251]


portfolio before change:  [23.88322593]
curr_Stock_Price:  100.94719813416353
curr_Factors:  [100.94719813]
mat_Sqrt:  [[0.15]]
grads:  [-0.06331966]
Stock Position:  -0.06331965928218926
Bond Position:  [30.27516812]


portfolio before change:  [23.88458775]
curr_Stock_Price:  101.04523901056363
curr_Factors:  [101.04523901]
mat_Sqrt:  [[0.15]]
grads:  [0.04563204]
Stock Position:  0.045632041611182776
Bond Position:  [19.2736872]


portfolio before change:  [23.9198846]
curr_Stock_Price:  101.71314308753436
curr_Factors:  [101.71314309]
mat_Sqrt:  [[0.15]]
grads:  [0.06984853]
Stock Position:  0.06984853396203608
Bond Position:  [16.81537067]


portfolio before change:  [23.70640951]
curr_Stock_Price:  98.59669314383376
curr_Factors:  [98.59669314]
mat_Sqrt:  [[0.15]]
grads:  [-0.01611801]
Stock Position:  -0.016118012398628298
Bond Position:  [25.29559223]


portfolio before change:  [23.7032789]
curr_Stock_Price:  99.18332266746945
curr_Factors:  [99.18332267]
mat_Sqrt:  [[0.15]]
grads:  [0.06132237]
Stock Position:  0.061322365271079794
Bond Position:  [17.62112295]


portfolio before change:  [23.66805462]
curr_Stock_Price:  98.53706409290699
curr_Factors:  [98.53706409]
mat_Sqrt:  [[0.15]]
grads:  [-0.02886864]
Stock Position:  -0.02886863830770075
Bond Position:  [26.51268549]


portfolio before change:  [23.70610558]
curr_Stock_Price:  97.44861800456559
curr_Factors:  [97.448618]
mat_Sqrt:  [[0.15]]
grads:  [0.02864646]
Stock Position:  0.028646461955980248
Bond Position:  [20.91454745]


portfolio before change:  [23.67632554]
curr_Stock_Price:  96.22650104753816
curr_Factors:  [96.22650105]
mat_Sqrt:  [[0.15]]
grads:  [0.04139457]
Stock Position:  0.04139457020896538
Bond Position:  [19.69307089]


portfolio before change:  [23.64827339]
curr_Stock_Price:  95.42987390122401
curr_Factors:  [95.4298739]
mat_Sqrt:  [[0.15]]
grads:  [-0.01026386]
Stock Position:  -0.010263856880545505
Bond Position:  [24.62775195]


portfolio before change:  [23.65738453]
curr_Stock_Price:  95.14212314429675
curr_Factors:  [95.14212314]
mat_Sqrt:  [[0.15]]
grads:  [0.05035103]
Stock Position:  0.05035102946528001
Bond Position:  [18.86688068]


portfolio before change:  [23.64996577]
curr_Stock_Price:  94.90109406395824
curr_Factors:  [94.90109406]
mat_Sqrt:  [[0.15]]
grads:  [0.14471434]
Stock Position:  0.1447143383893478
Bond Position:  [9.91641673]


portfolio before change:  [23.60086439]
curr_Stock_Price:  94.54466223645744
curr_Factors:  [94.54466224]
mat_Sqrt:  [[0.15]]
grads:  [0.07163479]
Stock Position:  0.07163479015368539
Bond Position:  [16.82817735]


portfolio before change:  [23.66348007]
curr_Stock_Price:  95.36002170225629
curr_Factors:  [95.3600217]
mat_Sqrt:  [[0.15]]
grads:  [0.00321066]
Stock Position:  0.0032106636663502275
Bond Position:  [23.35731111]


portfolio before change:  [23.66852278]
curr_Stock_Price:  95.1116804198081
curr_Factors:  [95.11168042]
mat_Sqrt:  [[0.15]]
grads:  [-0.06075271]
Stock Position:  -0.06075270917723921
Bond Position:  [29.44681504]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.77276721]
Stock Price:  93.51698931773353
PL:  [23.77276721]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 1.50839240e-03]
 [-7.97656080e-04]
 [-5.79907082e-03]
 [-1.38619722e-02]
 [-6.31057296e-04]
 [-1.11109175e-02]
 [ 1.27258500e-02]
 [-1.25738772e-02]
 [-1.54614928e-02]
 [ 2.15662015e-03]
 [-3.07037171e-03]
 [-6.87965332e-03]
 [ 7.83627239e-03]
 [ 7.90476438e-05]
 [ 1.27499108e-04]
 [ 1.98977542e-02]
 [ 4.09208114e-03]
 [ 9.04154574e-03]
 [-5.26928781e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.66891488]
curr_Stock_Price:  99.03510516300562
curr_Factors:  [99.03510516]
mat_Sqrt:  [[0.15]]
grads:  [0.01005595]
Stock Position:  0.010055949351233037
Bond Position:  [-20.66480688]


portfolio before change:  [-19.68104132]
curr_Stock_Price:  98.34301793750393
curr_Factors:  [98.34301794]
mat_Sqrt:  [[0.15]]
grads:  [-0.00531771]
Stock Position:  -0.005317707200758786
Bond Position:  [-19.15808195]


portfolio before change:  [-19.68904843]
curr_Stock_Price:  98.94797488682956
curr_Factors:  [98.94797489]
mat_Sqrt:  [[0.15]]
grads:  [-0.03866047]
Stock Position:  -0.03866047210902033
Bond Position:  [-15.863673]


portfolio before change:  [-19.67611156]
curr_Stock_Price:  98.51075111540848
curr_Factors:  [98.51075112]
mat_Sqrt:  [[0.15]]
grads:  [-0.09241315]
Stock Position:  -0.09241314771922257
Bond Position:  [-10.57242297]


portfolio before change:  [-19.62917252]
curr_Stock_Price:  97.97422055117761
curr_Factors:  [97.97422055]
mat_Sqrt:  [[0.15]]
grads:  [-0.00420705]
Stock Position:  -0.004207048636686208
Bond Position:  [-19.21699021]


portfolio before change:  [-19.63029146]
curr_Stock_Price:  97.09809224485487
curr_Factors:  [97.09809224]
mat_Sqrt:  [[0.15]]
grads:  [-0.07407278]
Stock Position:  -0.0740727831726714
Bond Position:  [-12.43796552]


portfolio before change:  [-19.65348425]
curr_Stock_Price:  97.36921631089774
curr_Factors:  [97.36921631]
mat_Sqrt:  [[0.15]]
grads:  [0.084839]
Stock Position:  0.08483899973540583
Bond Position:  [-27.91419117]


portfolio before change:  [-19.46930905]
curr_Stock_Price:  99.62236194270719
curr_Factors:  [99.62236194]
mat_Sqrt:  [[0.15]]
grads:  [-0.08382585]
Stock Position:  -0.08382584833287984
Bond Position:  [-11.11838005]


portfolio before change:  [-19.56284046]
curr_Stock_Price:  100.70498107061637
curr_Factors:  [100.70498107]
mat_Sqrt:  [[0.15]]
grads:  [-0.10307662]
Stock Position:  -0.10307661844407306
Bond Position:  [-9.18251155]


portfolio before change:  [-19.67412766]
curr_Stock_Price:  101.76236232592257
curr_Factors:  [101.76236233]
mat_Sqrt:  [[0.15]]
grads:  [0.01437747]
Stock Position:  0.014377467653321077
Bond Position:  [-21.13721273]


portfolio before change:  [-19.67378282]
curr_Stock_Price:  102.15393365277147
curr_Factors:  [102.15393365]
mat_Sqrt:  [[0.15]]
grads:  [-0.02046914]
Stock Position:  -0.020469144713467995
Bond Position:  [-17.58277917]


portfolio before change:  [-19.66387457]
curr_Stock_Price:  101.45510199032215
curr_Factors:  [101.45510199]
mat_Sqrt:  [[0.15]]
grads:  [-0.04586436]
Stock Position:  -0.0458643554711284
Bond Position:  [-15.01070171]


portfolio before change:  [-19.71505414]
curr_Stock_Price:  102.48916034529609
curr_Factors:  [102.48916035]
mat_Sqrt:  [[0.15]]
grads:  [0.05224182]
Stock Position:  0.052241815901253714
Bond Position:  [-25.06927399]


portfolio before change:  [-19.78451471]
curr_Stock_Price:  101.27954571080768
curr_Factors:  [101.27954571]
mat_Sqrt:  [[0.15]]
grads:  [0.00052698]
Stock Position:  0.0005269842922620699
Bond Position:  [-19.83788744]


portfolio before change:  [-19.78898796]
curr_Stock_Price:  102.20337273003463
curr_Factors:  [102.20337273]
mat_Sqrt:  [[0.15]]
grads:  [0.00084999]
Stock Position:  0.0008499940552720263
Bond Position:  [-19.87586021]


portfolio before change:  [-19.79530321]
curr_Stock_Price:  100.62022085552698
curr_Factors:  [100.62022086]
mat_Sqrt:  [[0.15]]
grads:  [0.13265169]
Stock Position:  0.1326516948262937
Bond Position:  [-33.14274604]


portfolio before change:  [-19.85280641]
curr_Stock_Price:  100.24920051350352
curr_Factors:  [100.24920051]
mat_Sqrt:  [[0.15]]
grads:  [0.02728054]
Stock Position:  0.02728054094403377
Bond Position:  [-22.58765883]


portfolio before change:  [-19.85884015]
curr_Stock_Price:  100.23504690280785
curr_Factors:  [100.2350469]
mat_Sqrt:  [[0.15]]
grads:  [0.06027697]
Stock Position:  0.06027697156782363
Bond Position:  [-25.90070522]


portfolio before change:  [-19.85853073]
curr_Stock_Price:  100.34761732880473
curr_Factors:  [100.34761733]
mat_Sqrt:  [[0.15]]
grads:  [-0.03512859]
Stock Position:  -0.03512858538789425
Bond Position:  [-16.33346089]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.91493639]
Stock Price:  101.83705342771907
PL:  [-21.75198982]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.19268297e-02]
 [ 1.30107890e-02]
 [-3.77902253e-02]
 [ 3.19618539e-02]
 [ 5.71632821e-03]
 [-1.19558229e-02]
 [-3.45026069e-03]
 [ 7.30305204e-04]
 [ 5.04899829e-03]
 [ 1.98970723e-03]
 [-3.29177402e-03]
 [ 9.93710953e-03]
 [ 1.43419931e-02]
 [-3.63670929e-03]
 [ 9.12323586e-03]
 [ 2.23403704e-02]
 [ 3.76751532e-03]
 [ 1.42278785e-02]
 [-1.52972568e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [44.05221697]
curr_Stock_Price:  101.92625401326532
curr_Factors:  [101.92625401]
mat_Sqrt:  [[0.15]]
grads:  [-0.14617886]
Stock Position:  -0.1461788644933951
Bond Position:  [58.95168104]


portfolio before change:  [44.1887014]
curr_Stock_Price:  101.09340674760189
curr_Factors:  [101.09340675]
mat_Sqrt:  [[0.15]]
grads:  [0.08673859]
Stock Position:  0.08673859318192942
Bond Position:  [35.42000152]


portfolio before change:  [44.30931773]
curr_Stock_Price:  102.38187852497892
curr_Factors:  [102.38187852]
mat_Sqrt:  [[0.15]]
grads:  [-0.25193484]
Stock Position:  -0.2519348352542179
Bond Position:  [70.10287943]


portfolio before change:  [44.47679449]
curr_Stock_Price:  101.7866895293692
curr_Factors:  [101.78668953]
mat_Sqrt:  [[0.15]]
grads:  [0.21307903]
Stock Position:  0.2130790262834356
Bond Position:  [22.78818579]


portfolio before change:  [44.38009439]
curr_Stock_Price:  101.30612673533913
curr_Factors:  [101.30612674]
mat_Sqrt:  [[0.15]]
grads:  [0.03810885]
Stock Position:  0.038108854754955214
Bond Position:  [40.51943392]


portfolio before change:  [44.44181124]
curr_Stock_Price:  102.65976812912358
curr_Factors:  [102.65976813]
mat_Sqrt:  [[0.15]]
grads:  [-0.07970549]
Stock Position:  -0.07970548582795753
Bond Position:  [52.62435794]


portfolio before change:  [44.41789329]
curr_Stock_Price:  103.12492667110891
curr_Factors:  [103.12492667]
mat_Sqrt:  [[0.15]]
grads:  [-0.02300174]
Stock Position:  -0.023001737928417493
Bond Position:  [46.78994583]


portfolio before change:  [44.41155217]
curr_Stock_Price:  103.90921816835426
curr_Factors:  [103.90921817]
mat_Sqrt:  [[0.15]]
grads:  [0.0048687]
Stock Position:  0.004868701359535139
Bond Position:  [43.90564922]


portfolio before change:  [44.42321624]
curr_Stock_Price:  104.05017650240067
curr_Factors:  [104.0501765]
mat_Sqrt:  [[0.15]]
grads:  [0.03365999]
Stock Position:  0.03365998856677231
Bond Position:  [40.92088849]


portfolio before change:  [44.3984522]
curr_Stock_Price:  103.01049884709174
curr_Factors:  [103.01049885]
mat_Sqrt:  [[0.15]]
grads:  [0.01326471]
Stock Position:  0.01326471489601976
Bond Position:  [43.0320473]


portfolio before change:  [44.41763553]
curr_Stock_Price:  103.64556471761894
curr_Factors:  [103.64556472]
mat_Sqrt:  [[0.15]]
grads:  [-0.02194516]
Stock Position:  -0.02194516010046134
Bond Position:  [46.69215404]


portfolio before change:  [44.39784217]
curr_Stock_Price:  105.07949624230761
curr_Factors:  [105.07949624]
mat_Sqrt:  [[0.15]]
grads:  [0.0662474]
Stock Position:  0.06624739686711822
Bond Position:  [37.43659908]


portfolio before change:  [44.5327814]
curr_Stock_Price:  106.9751014452763
curr_Factors:  [106.97510145]
mat_Sqrt:  [[0.15]]
grads:  [0.09561329]
Stock Position:  0.095613287433302
Bond Position:  [34.30454027]


portfolio before change:  [44.45904659]
curr_Stock_Price:  106.11421675754998
curr_Factors:  [106.11421676]
mat_Sqrt:  [[0.15]]
grads:  [-0.02424473]
Stock Position:  -0.024244728622217732
Bond Position:  [47.03175698]


portfolio before change:  [44.5030374]
curr_Stock_Price:  104.78479773449331
curr_Factors:  [104.78479773]
mat_Sqrt:  [[0.15]]
grads:  [0.06082157]
Stock Position:  0.06082157240403637
Bond Position:  [38.12986124]


portfolio before change:  [44.46624727]
curr_Stock_Price:  104.02316363059342
curr_Factors:  [104.02316363]
mat_Sqrt:  [[0.15]]
grads:  [0.1489358]
Stock Position:  0.1489358028905146
Bond Position:  [28.97347388]


portfolio before change:  [44.47114138]
curr_Stock_Price:  104.00738391117592
curr_Factors:  [104.00738391]
mat_Sqrt:  [[0.15]]
grads:  [0.02511677]
Stock Position:  0.025116768797739393
Bond Position:  [41.85881197]


portfolio before change:  [44.52547617]
curr_Stock_Price:  105.7539771130634
curr_Factors:  [105.75397711]
mat_Sqrt:  [[0.15]]
grads:  [0.09485252]
Stock Position:  0.09485252309311609
Bond Position:  [34.49444462]


portfolio before change:  [44.42655429]
curr_Stock_Price:  104.62014782671594
curr_Factors:  [104.62014783]
mat_Sqrt:  [[0.15]]
grads:  [-0.10198171]
Stock Position:  -0.10198171194370938
Bond Position:  [55.09589607]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [44.50039655]
Stock Price:  104.03115440312915
PL:  [40.46924214]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 1.14055808e-03]
 [-3.27873870e-03]
 [-9.01206248e-03]
 [-2.14854476e-02]
 [ 7.71483431e-04]
 [-1.03174609e-02]
 [ 1.36704192e-02]
 [ 9.24502158e-03]
 [-1.07425192e-03]
 [ 2.86271723e-03]
 [-3.01123240e-03]
 [-5.09140417e-03]
 [ 4.79497161e-03]
 [-3.83109401e-04]
 [ 3.99358685e-03]
 [ 1.68299149e-02]
 [ 3.54832509e-03]
 [ 1.24966805e-02]
 [-7.37991949e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.43987101]
curr_Stock_Price:  98.95475351803579
curr_Factors:  [98.95475352]
mat_Sqrt:  [[0.15]]
grads:  [0.00760372]
Stock Position:  0.007603720564492075
Bond Position:  [-22.1922953]


portfolio before change:  [-21.44725507]
curr_Stock_Price:  98.71338520592342
curr_Factors:  [98.71338521]
mat_Sqrt:  [[0.15]]
grads:  [-0.02185826]
Stock Position:  -0.021858258006001226
Bond Position:  [-19.28955243]


portfolio before change:  [-21.44012646]
curr_Stock_Price:  98.16660765193609
curr_Factors:  [98.16660765]
mat_Sqrt:  [[0.15]]
grads:  [-0.06008042]
Stock Position:  -0.06008041651663309
Bond Position:  [-15.54223578]


portfolio before change:  [-21.51965734]
curr_Stock_Price:  99.42566745399934
curr_Factors:  [99.42566745]
mat_Sqrt:  [[0.15]]
grads:  [-0.14323632]
Stock Position:  -0.14323631700859635
Bond Position:  [-7.27829092]


portfolio before change:  [-21.35928574]
curr_Stock_Price:  98.29333311247412
curr_Factors:  [98.29333311]
mat_Sqrt:  [[0.15]]
grads:  [0.00514322]
Stock Position:  0.005143222870292239
Bond Position:  [-21.86483026]


portfolio before change:  [-21.35928891]
curr_Stock_Price:  99.35564821506603
curr_Factors:  [99.35564822]
mat_Sqrt:  [[0.15]]
grads:  [-0.06878307]
Stock Position:  -0.0687830728596574
Bond Position:  [-14.52530212]


portfolio before change:  [-21.40936777]
curr_Stock_Price:  100.03091730959852
curr_Factors:  [100.03091731]
mat_Sqrt:  [[0.15]]
grads:  [0.09113613]
Stock Position:  0.09113612774294753
Bond Position:  [-30.52579823]


portfolio before change:  [-21.38606875]
curr_Stock_Price:  100.37031532143688
curr_Factors:  [100.37031532]
mat_Sqrt:  [[0.15]]
grads:  [0.06163348]
Stock Position:  0.06163347717678836
Bond Position:  [-27.57224029]


portfolio before change:  [-21.42336439]
curr_Stock_Price:  99.87704904098861
curr_Factors:  [99.87704904]
mat_Sqrt:  [[0.15]]
grads:  [-0.00716168]
Stock Position:  -0.007161679457542636
Bond Position:  [-20.70807698]


portfolio before change:  [-21.43387743]
curr_Stock_Price:  100.62203760155596
curr_Factors:  [100.6220376]
mat_Sqrt:  [[0.15]]
grads:  [0.01908478]
Stock Position:  0.0190847815124894
Bond Position:  [-23.35422703]


portfolio before change:  [-21.45494341]
curr_Stock_Price:  99.82419258304459
curr_Factors:  [99.82419258]
mat_Sqrt:  [[0.15]]
grads:  [-0.02007488]
Stock Position:  -0.0200748826979285
Bond Position:  [-19.45098445]


portfolio before change:  [-21.47372368]
curr_Stock_Price:  100.51744282381357
curr_Factors:  [100.51744282]
mat_Sqrt:  [[0.15]]
grads:  [-0.03394269]
Stock Position:  -0.033942694437347376
Bond Position:  [-18.06189083]


portfolio before change:  [-21.45810714]
curr_Stock_Price:  99.9243083172332
curr_Factors:  [99.92430832]
mat_Sqrt:  [[0.15]]
grads:  [0.03196648]
Stock Position:  0.03196647738179912
Bond Position:  [-24.65233528]


portfolio before change:  [-21.45253984]
curr_Stock_Price:  100.29129116881182
curr_Factors:  [100.29129117]
mat_Sqrt:  [[0.15]]
grads:  [-0.00255406]
Stock Position:  -0.0025540626730179124
Bond Position:  [-21.1963896]


portfolio before change:  [-21.45718155]
curr_Stock_Price:  100.03364323479732
curr_Factors:  [100.03364323]
mat_Sqrt:  [[0.15]]
grads:  [0.02662391]
Stock Position:  0.026623912309838446
Bond Position:  [-24.1204685]


portfolio before change:  [-21.47368052]
curr_Stock_Price:  99.64045935498856
curr_Factors:  [99.64045935]
mat_Sqrt:  [[0.15]]
grads:  [0.11219943]
Stock Position:  0.11219943284006932
Bond Position:  [-32.65328354]


portfolio before change:  [-21.37630253]
curr_Stock_Price:  100.58112654556354
curr_Factors:  [100.58112655]
mat_Sqrt:  [[0.15]]
grads:  [0.0236555]
Stock Position:  0.023655500614768656
Bond Position:  [-23.75559943]


portfolio before change:  [-21.3331013]
curr_Stock_Price:  102.6584816862342
curr_Factors:  [102.65848169]
mat_Sqrt:  [[0.15]]
grads:  [0.0833112]
Stock Position:  0.0833112035050592
Bond Position:  [-29.88570296]


portfolio before change:  [-21.39276]
curr_Stock_Price:  102.03207925906446
curr_Factors:  [102.03207926]
mat_Sqrt:  [[0.15]]
grads:  [-0.04919946]
Stock Position:  -0.0491994632696565
Bond Position:  [-16.37283646]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.3461513]
Stock Price:  101.00153097484926
PL:  [-22.34768227]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-4.24885136e-03]
 [ 4.37269590e-02]
 [-1.30097062e-02]
 [ 3.40770026e-02]
 [ 5.71307920e-03]
 [-1.44800372e-02]
 [-5.35035739e-03]
 [ 2.09189746e-03]
 [ 2.33679631e-03]
 [ 2.15238652e-03]
 [-3.57227569e-03]
 [ 8.15473378e-04]
 [ 8.98284919e-03]
 [ 1.02369454e-04]
 [ 2.26589151e-03]
 [ 2.29860227e-02]
 [ 3.39977855e-03]
 [ 1.27049731e-02]
 [-1.10452513e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.99941737]
curr_Stock_Price:  100.29046997931526
curr_Factors:  [100.29046998]
mat_Sqrt:  [[0.15]]
grads:  [-0.02832568]
Stock Position:  -0.02832567573105762
Bond Position:  [10.8402127]


portfolio before change:  [7.94065508]
curr_Stock_Price:  102.46068076127922
curr_Factors:  [102.46068076]
mat_Sqrt:  [[0.15]]
grads:  [0.29151306]
Stock Position:  0.2915130600170418
Bond Position:  [-21.92797151]


portfolio before change:  [7.49460366]
curr_Stock_Price:  100.9493634452373
curr_Factors:  [100.94936345]
mat_Sqrt:  [[0.15]]
grads:  [-0.08673137]
Stock Position:  -0.08673137490076349
Bond Position:  [16.25008075]


portfolio before change:  [7.41670676]
curr_Stock_Price:  101.89434943252871
curr_Factors:  [101.89434943]
mat_Sqrt:  [[0.15]]
grads:  [0.22718002]
Stock Position:  0.22718001716327324
Bond Position:  [-15.7316533]


portfolio before change:  [7.43694068]
curr_Stock_Price:  102.0007290830172
curr_Factors:  [102.00072908]
mat_Sqrt:  [[0.15]]
grads:  [0.03808719]
Stock Position:  0.03808719465772918
Bond Position:  [3.55201906]


portfolio before change:  [7.50076047]
curr_Stock_Price:  103.6530343439831
curr_Factors:  [103.65303434]
mat_Sqrt:  [[0.15]]
grads:  [-0.09653358]
Stock Position:  -0.09653358138246872
Bond Position:  [17.5067591]


portfolio before change:  [7.50408432]
curr_Stock_Price:  103.66394650468102
curr_Factors:  [103.6639465]
mat_Sqrt:  [[0.15]]
grads:  [-0.03566905]
Stock Position:  -0.035669049296729344
Bond Position:  [11.20167873]


portfolio before change:  [7.50855018]
curr_Stock_Price:  103.61726469640632
curr_Factors:  [103.6172647]
mat_Sqrt:  [[0.15]]
grads:  [0.01394598]
Stock Position:  0.013945983071619653
Bond Position:  [6.06350556]


portfolio before change:  [7.51262685]
curr_Stock_Price:  103.80087296687587
curr_Factors:  [103.80087297]
mat_Sqrt:  [[0.15]]
grads:  [0.01557864]
Stock Position:  0.015578642046027158
Bond Position:  [5.8955502]


portfolio before change:  [7.49997449]
curr_Stock_Price:  102.89409100411079
curr_Factors:  [102.894091]
mat_Sqrt:  [[0.15]]
grads:  [0.01434924]
Stock Position:  0.014349243469141676
Bond Position:  [6.02352212]


portfolio before change:  [7.53678729]
curr_Stock_Price:  105.35462012215551
curr_Factors:  [105.35462012]
mat_Sqrt:  [[0.15]]
grads:  [-0.02381517]
Stock Position:  -0.023815171273727682
Bond Position:  [10.04582561]


portfolio before change:  [7.58059327]
curr_Stock_Price:  103.62067427100051
curr_Factors:  [103.62067427]
mat_Sqrt:  [[0.15]]
grads:  [0.00543649]
Stock Position:  0.005436489185198269
Bond Position:  [7.0172606]


portfolio before change:  [7.58043357]
curr_Stock_Price:  103.2685652546392
curr_Factors:  [103.26856525]
mat_Sqrt:  [[0.15]]
grads:  [0.05988566]
Stock Position:  0.05988566125872193
Bond Position:  [1.39612725]


portfolio before change:  [7.55535116]
curr_Stock_Price:  102.8438979588167
curr_Factors:  [102.84389796]
mat_Sqrt:  [[0.15]]
grads:  [0.00068246]
Stock Position:  0.0006824630262377872
Bond Position:  [7.48516401]


portfolio before change:  [7.55758425]
curr_Stock_Price:  103.37368446985938
curr_Factors:  [103.37368447]
mat_Sqrt:  [[0.15]]
grads:  [0.01510594]
Stock Position:  0.015105943409935835
Bond Position:  [5.99602722]


portfolio before change:  [7.55364824]
curr_Stock_Price:  103.0138786485438
curr_Factors:  [103.01387865]
mat_Sqrt:  [[0.15]]
grads:  [0.15324015]
Stock Position:  0.1532401515060127
Bond Position:  [-8.23221413]


portfolio before change:  [7.67819503]
curr_Stock_Price:  103.84006621522295
curr_Factors:  [103.84006622]
mat_Sqrt:  [[0.15]]
grads:  [0.02266519]
Stock Position:  0.022665190309785296
Bond Position:  [5.32464017]


portfolio before change:  [7.66615168]
curr_Stock_Price:  103.24996822824986
curr_Factors:  [103.24996823]
mat_Sqrt:  [[0.15]]
grads:  [0.08469982]
Stock Position:  0.08469982077607813
Bond Position:  [-1.07910213]


portfolio before change:  [7.67792645]
curr_Stock_Price:  103.3921713378105
curr_Factors:  [103.39217134]
mat_Sqrt:  [[0.15]]
grads:  [-0.07363501]
Stock Position:  -0.07363500882251922
Bond Position:  [15.29120989]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.76674156]
Stock Price:  102.23793998286642
PL:  [5.52880158]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.33616291e-02]
 [ 6.11444441e-03]
 [-2.40125235e-02]
 [ 4.65006006e-02]
 [ 5.49169666e-03]
 [-1.02237594e-02]
 [ 7.30463147e-03]
 [ 1.49939576e-02]
 [-2.18356287e-03]
 [ 1.03706289e-02]
 [-3.21699607e-03]
 [-4.98362633e-03]
 [ 4.84843260e-03]
 [-1.25415506e-04]
 [ 1.09024130e-03]
 [ 1.68144559e-02]
 [ 4.24735509e-03]
 [ 9.40411889e-03]
 [-4.91371748e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.50259848]
curr_Stock_Price:  100.67627546593208
curr_Factors:  [100.67627547]
mat_Sqrt:  [[0.15]]
grads:  [-0.08907753]
Stock Position:  -0.08907752714578741
Bond Position:  [25.47059214]


portfolio before change:  [16.49556948]
curr_Stock_Price:  100.82667749981007
curr_Factors:  [100.8266775]
mat_Sqrt:  [[0.15]]
grads:  [0.04076296]
Stock Position:  0.0407629627266204
Bond Position:  [12.38557538]


portfolio before change:  [16.52661181]
curr_Stock_Price:  101.51223986673556
curr_Factors:  [101.51223987]
mat_Sqrt:  [[0.15]]
grads:  [-0.16008349]
Stock Position:  -0.16008348984635884
Bond Position:  [32.77704543]


portfolio before change:  [16.3535459]
curr_Stock_Price:  102.6445314959382
curr_Factors:  [102.6445315]
mat_Sqrt:  [[0.15]]
grads:  [0.310004]
Stock Position:  0.31000400388301635
Bond Position:  [-15.46666984]


portfolio before change:  [16.58522665]
curr_Stock_Price:  103.40435361552711
curr_Factors:  [103.40435362]
mat_Sqrt:  [[0.15]]
grads:  [0.03661131]
Stock Position:  0.03661131109469616
Bond Position:  [12.79945769]


portfolio before change:  [16.53507403]
curr_Stock_Price:  101.94707489242523
curr_Factors:  [101.94707489]
mat_Sqrt:  [[0.15]]
grads:  [-0.0681584]
Stock Position:  -0.06815839590280812
Bond Position:  [23.48362312]


portfolio before change:  [16.60652738]
curr_Stock_Price:  100.98487933833142
curr_Factors:  [100.98487934]
mat_Sqrt:  [[0.15]]
grads:  [0.04869754]
Stock Position:  0.0486975431207174
Bond Position:  [11.68881186]


portfolio before change:  [16.60900242]
curr_Stock_Price:  100.97568933568374
curr_Factors:  [100.97568934]
mat_Sqrt:  [[0.15]]
grads:  [0.09995972]
Stock Position:  0.09995971719132474
Bond Position:  [6.51550107]


portfolio before change:  [16.35602357]
curr_Stock_Price:  98.42858406883875
curr_Factors:  [98.42858407]
mat_Sqrt:  [[0.15]]
grads:  [-0.01455709]
Stock Position:  -0.014557085789528357
Bond Position:  [17.78885691]


portfolio before change:  [16.36411364]
curr_Stock_Price:  98.17837646721667
curr_Factors:  [98.17837647]
mat_Sqrt:  [[0.15]]
grads:  [0.06913753]
Stock Position:  0.06913752618925412
Bond Position:  [9.57630356]


portfolio before change:  [16.44959923]
curr_Stock_Price:  99.38020167425938
curr_Factors:  [99.38020167]
mat_Sqrt:  [[0.15]]
grads:  [-0.02144664]
Stock Position:  -0.021446640498958253
Bond Position:  [18.58097069]


portfolio before change:  [16.4310513]
curr_Stock_Price:  100.46166521747598
curr_Factors:  [100.46166522]
mat_Sqrt:  [[0.15]]
grads:  [-0.03322418]
Stock Position:  -0.03322417552670603
Bond Position:  [19.7688073]


portfolio before change:  [16.46787843]
curr_Stock_Price:  99.50199298075424
curr_Factors:  [99.50199298]
mat_Sqrt:  [[0.15]]
grads:  [0.03232288]
Stock Position:  0.03232288397578355
Bond Position:  [13.25168706]


portfolio before change:  [16.51326552]
curr_Stock_Price:  100.80366370430846
curr_Factors:  [100.8036637]
mat_Sqrt:  [[0.15]]
grads:  [-0.0008361]
Stock Position:  -0.000836103376078014
Bond Position:  [16.59754781]


portfolio before change:  [16.51720301]
curr_Stock_Price:  101.0577156758554
curr_Factors:  [101.05771568]
mat_Sqrt:  [[0.15]]
grads:  [0.00726828]
Stock Position:  0.007268275317887565
Bond Position:  [15.78268771]


portfolio before change:  [16.50592373]
curr_Stock_Price:  98.96293468087939
curr_Factors:  [98.96293468]
mat_Sqrt:  [[0.15]]
grads:  [0.11209637]
Stock Position:  0.1120963727103599
Bond Position:  [5.41253772]


portfolio before change:  [16.63748667]
curr_Stock_Price:  100.1245211733846
curr_Factors:  [100.12452117]
mat_Sqrt:  [[0.15]]
grads:  [0.0283157]
Stock Position:  0.02831570061040421
Bond Position:  [13.80239071]


portfolio before change:  [16.65124302]
curr_Stock_Price:  100.48846500544188
curr_Factors:  [100.48846501]
mat_Sqrt:  [[0.15]]
grads:  [0.06269413]
Stock Position:  0.06269412595526859
Bond Position:  [10.35120654]


portfolio before change:  [16.59566673]
curr_Stock_Price:  99.56071587028627
curr_Factors:  [99.56071587]
mat_Sqrt:  [[0.15]]
grads:  [-0.03275812]
Stock Position:  -0.03275811654269602
Bond Position:  [19.85708826]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.55282577]
Stock Price:  101.02007488197711
PL:  [15.53275089]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.77832510e-03]
 [-7.97497522e-04]
 [-1.10545956e-02]
 [-1.51923884e-02]
 [-3.65162845e-03]
 [-1.09807792e-02]
 [ 1.27766408e-02]
 [-4.22838000e-02]
 [-2.44398819e-04]
 [ 9.76261085e-03]
 [-3.70719809e-03]
 [-2.84505451e-03]
 [ 4.84634526e-03]
 [-4.29536211e-04]
 [ 2.21345256e-04]
 [ 1.72891280e-02]
 [ 4.98691674e-03]
 [ 6.84636516e-03]
 [-5.44618873e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.95036679]
curr_Stock_Price:  99.56679796024655
curr_Factors:  [99.56679796]
mat_Sqrt:  [[0.15]]
grads:  [0.01852217]
Stock Position:  0.01852216732251062
Bond Position:  [-9.79455968]


portfolio before change:  [-7.97552644]
curr_Stock_Price:  98.34066150859302
curr_Factors:  [98.34066151]
mat_Sqrt:  [[0.15]]
grads:  [-0.00531665]
Stock Position:  -0.00531665014662107
Bond Position:  [-7.45268355]


portfolio before change:  [-7.97326371]
curr_Stock_Price:  97.56458299475442
curr_Factors:  [97.56458299]
mat_Sqrt:  [[0.15]]
grads:  [-0.0736973]
Stock Position:  -0.07369730433139932
Bond Position:  [-0.78301694]


portfolio before change:  [-8.06252655]
curr_Stock_Price:  98.7731354966465
curr_Factors:  [98.7731355]
mat_Sqrt:  [[0.15]]
grads:  [-0.10128259]
Stock Position:  -0.10128258903634108
Bond Position:  [1.94147234]


portfolio before change:  [-7.90579815]
curr_Stock_Price:  97.23049158888335
curr_Factors:  [97.23049159]
mat_Sqrt:  [[0.15]]
grads:  [-0.02434419]
Stock Position:  -0.024344189642788353
Bond Position:  [-5.53880063]


portfolio before change:  [-7.91296965]
curr_Stock_Price:  97.468191899899
curr_Factors:  [97.4681919]
mat_Sqrt:  [[0.15]]
grads:  [-0.07320519]
Stock Position:  -0.07320519474345016
Bond Position:  [-0.77779168]


portfolio before change:  [-7.8413097]
curr_Stock_Price:  96.48664381700763
curr_Factors:  [96.48664382]
mat_Sqrt:  [[0.15]]
grads:  [0.08517761]
Stock Position:  0.0851776051006067
Bond Position:  [-16.05981094]


portfolio before change:  [-7.8190891]
curr_Stock_Price:  96.79465967078285
curr_Factors:  [96.79465967]
mat_Sqrt:  [[0.15]]
grads:  [-0.281892]
Stock Position:  -0.2818919998457964
Bond Position:  [19.46655109]


portfolio before change:  [-8.06813588]
curr_Stock_Price:  97.69540898848736
curr_Factors:  [97.69540899]
mat_Sqrt:  [[0.15]]
grads:  [-0.00162933]
Stock Position:  -0.001629325460401158
Bond Position:  [-7.90895827]


portfolio before change:  [-8.07217134]
curr_Stock_Price:  98.95849036587056
curr_Factors:  [98.95849037]
mat_Sqrt:  [[0.15]]
grads:  [0.06508407]
Stock Position:  0.06508407233136253
Bond Position:  [-14.51279288]


portfolio before change:  [-8.0761885]
curr_Stock_Price:  98.95252100692977
curr_Factors:  [98.95252101]
mat_Sqrt:  [[0.15]]
grads:  [-0.02471465]
Stock Position:  -0.024714653962929305
Bond Position:  [-5.63061119]


portfolio before change:  [-8.08259589]
curr_Stock_Price:  99.15481212409878
curr_Factors:  [99.15481212]
mat_Sqrt:  [[0.15]]
grads:  [-0.01896703]
Stock Position:  -0.01896703004464558
Bond Position:  [-6.20192358]


portfolio before change:  [-8.0910443]
curr_Stock_Price:  99.51848191530325
curr_Factors:  [99.51848192]
mat_Sqrt:  [[0.15]]
grads:  [0.03230897]
Stock Position:  0.032308968390690064
Bond Position:  [-11.30638378]


portfolio before change:  [-8.07188503]
curr_Stock_Price:  100.1989807852705
curr_Factors:  [100.19898079]
mat_Sqrt:  [[0.15]]
grads:  [-0.00286357]
Stock Position:  -0.002863574738209253
Bond Position:  [-7.78495776]


portfolio before change:  [-8.07890445]
curr_Stock_Price:  101.97052000893045
curr_Factors:  [101.97052001]
mat_Sqrt:  [[0.15]]
grads:  [0.00147564]
Stock Position:  0.001475635039087063
Bond Position:  [-8.22937572]


portfolio before change:  [-8.08395887]
curr_Stock_Price:  99.93964724124474
curr_Factors:  [99.93964724]
mat_Sqrt:  [[0.15]]
grads:  [0.11526085]
Stock Position:  0.11526085318881804
Bond Position:  [-19.60308788]


portfolio before change:  [-8.15880828]
curr_Stock_Price:  99.33278015342275
curr_Factors:  [99.33278015]
mat_Sqrt:  [[0.15]]
grads:  [0.03324611]
Stock Position:  0.033246111606663256
Bond Position:  [-11.46123697]


portfolio before change:  [-8.16667109]
curr_Stock_Price:  99.18247242039214
curr_Factors:  [99.18247242]
mat_Sqrt:  [[0.15]]
grads:  [0.04564243]
Stock Position:  0.04564243441868661
Bond Position:  [-12.69360059]


portfolio before change:  [-8.12901887]
curr_Stock_Price:  100.07694741606329
curr_Factors:  [100.07694742]
mat_Sqrt:  [[0.15]]
grads:  [-0.03630792]
Stock Position:  -0.03630792486902665
Bond Position:  [-4.49543259]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.13266385]
Stock Price:  100.14638055982867
PL:  [-8.2790444]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 1.58320222e-03]
 [-5.94615487e-03]
 [-8.87681399e-03]
 [-1.26051785e-02]
 [-4.66277986e-03]
 [-1.08530236e-02]
 [ 1.37701599e-02]
 [ 1.48489677e-02]
 [-1.27841985e-02]
 [ 2.35348696e-03]
 [-3.06584100e-03]
 [-6.54353717e-03]
 [ 8.32145910e-03]
 [ 2.38402765e-04]
 [ 8.66710090e-05]
 [ 2.29929782e-02]
 [ 2.40795691e-03]
 [ 9.29898967e-03]
 [-5.25595367e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.30873938]
curr_Stock_Price:  99.05144700991303
curr_Factors:  [99.05144701]
mat_Sqrt:  [[0.15]]
grads:  [0.01055468]
Stock Position:  0.010554681485838505
Bond Position:  [-20.35419586]


portfolio before change:  [-19.31277757]
curr_Stock_Price:  99.15102313874186
curr_Factors:  [99.15102314]
mat_Sqrt:  [[0.15]]
grads:  [-0.03964103]
Stock Position:  -0.03964103248522626
Bond Position:  [-15.38232864]


portfolio before change:  [-19.27918063]
curr_Stock_Price:  98.20647135008943
curr_Factors:  [98.20647135]
mat_Sqrt:  [[0.15]]
grads:  [-0.05917876]
Stock Position:  -0.05917875991642642
Bond Position:  [-13.46744344]


portfolio before change:  [-19.29175928]
curr_Stock_Price:  98.36212465805593
curr_Factors:  [98.36212466]
mat_Sqrt:  [[0.15]]
grads:  [-0.08403452]
Stock Position:  -0.08403452356546975
Bond Position:  [-11.025945]


portfolio before change:  [-19.17405277]
curr_Stock_Price:  96.92862639255955
curr_Factors:  [96.92862639]
mat_Sqrt:  [[0.15]]
grads:  [-0.0310852]
Stock Position:  -0.031085199078669138
Bond Position:  [-16.16100712]


portfolio before change:  [-19.2077229]
curr_Stock_Price:  97.88179312861308
curr_Factors:  [97.88179313]
mat_Sqrt:  [[0.15]]
grads:  [-0.07235349]
Stock Position:  -0.07235349053210624
Bond Position:  [-12.12563351]


portfolio before change:  [-19.27796365]
curr_Stock_Price:  98.81069037504155
curr_Factors:  [98.81069038]
mat_Sqrt:  [[0.15]]
grads:  [0.09180107]
Stock Position:  0.09180106588176049
Bond Position:  [-28.34889034]


portfolio before change:  [-19.08257165]
curr_Stock_Price:  101.01633044341158
curr_Factors:  [101.01633044]
mat_Sqrt:  [[0.15]]
grads:  [0.09899312]
Stock Position:  0.09899311806216377
Bond Position:  [-29.08249317]


portfolio before change:  [-19.15761045]
curr_Stock_Price:  100.33176501089264
curr_Factors:  [100.33176501]
mat_Sqrt:  [[0.15]]
grads:  [-0.08522799]
Stock Position:  -0.08522798976922547
Bond Position:  [-10.6065358]


portfolio before change:  [-19.24074899]
curr_Stock_Price:  101.27613293890762
curr_Factors:  [101.27613294]
mat_Sqrt:  [[0.15]]
grads:  [0.01568991]
Stock Position:  0.015689913041119503
Bond Position:  [-20.82976271]


portfolio before change:  [-19.2334886]
curr_Stock_Price:  102.07081463598374
curr_Factors:  [102.07081464]
mat_Sqrt:  [[0.15]]
grads:  [-0.02043894]
Stock Position:  -0.0204389400293323
Bond Position:  [-17.14726934]


portfolio before change:  [-19.23872456]
curr_Stock_Price:  102.11722660623666
curr_Factors:  [102.11722661]
mat_Sqrt:  [[0.15]]
grads:  [-0.04362358]
Stock Position:  -0.043623581118476196
Bond Position:  [-14.78400544]


portfolio before change:  [-19.27288557]
curr_Stock_Price:  102.81557711426541
curr_Factors:  [102.81557711]
mat_Sqrt:  [[0.15]]
grads:  [0.05547639]
Stock Position:  0.05547639396864537
Bond Position:  [-24.97672304]


portfolio before change:  [-19.32429731]
curr_Stock_Price:  102.00141510536064
curr_Factors:  [102.00141511]
mat_Sqrt:  [[0.15]]
grads:  [0.00158935]
Stock Position:  0.0015893517672518587
Bond Position:  [-19.48641344]


portfolio before change:  [-19.32868753]
curr_Stock_Price:  102.30467613211835
curr_Factors:  [102.30467613]
mat_Sqrt:  [[0.15]]
grads:  [0.00057781]
Stock Position:  0.0005778067265477886
Bond Position:  [-19.38779986]


portfolio before change:  [-19.33319166]
curr_Stock_Price:  102.89904150383045
curr_Factors:  [102.8990415]
mat_Sqrt:  [[0.15]]
grads:  [0.15328652]
Stock Position:  0.15328652160751166
Bond Position:  [-35.10622781]


portfolio before change:  [-19.60829312]
curr_Stock_Price:  101.16161667849097
curr_Factors:  [101.16161668]
mat_Sqrt:  [[0.15]]
grads:  [0.01605305]
Stock Position:  0.0160530460854991
Bond Position:  [-21.23224522]


portfolio before change:  [-19.62558755]
curr_Stock_Price:  100.41498563253285
curr_Factors:  [100.41498563]
mat_Sqrt:  [[0.15]]
grads:  [0.06199326]
Stock Position:  0.06199326446681262
Bond Position:  [-25.85064031]


portfolio before change:  [-19.67571039]
curr_Stock_Price:  99.71072571349661
curr_Factors:  [99.71072571]
mat_Sqrt:  [[0.15]]
grads:  [-0.03503969]
Stock Position:  -0.03503969111775054
Bond Position:  [-16.18187736]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.61117639]
Stock Price:  97.75351741895147
PL:  [-19.61117639]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-4.10119006e-03]
 [-4.46360438e-03]
 [-4.83245851e-03]
 [-2.27502641e-02]
 [ 1.55923867e-03]
 [-1.06384521e-02]
 [ 1.37008559e-02]
 [-3.36710908e-02]
 [ 2.04761903e-03]
 [ 9.96201988e-03]
 [-8.99665296e-03]
 [ 2.78756196e-03]
 [ 5.21205355e-03]
 [-9.94456102e-04]
 [ 7.93110373e-03]
 [ 1.80968212e-02]
 [ 5.91485855e-03]
 [ 4.15384956e-03]
 [-5.91945796e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.82485101]
curr_Stock_Price:  100.28254957175002
curr_Factors:  [100.28254957]
mat_Sqrt:  [[0.15]]
grads:  [-0.02734127]
Stock Position:  -0.027341267045944223
Bond Position:  [10.56670298]


portfolio before change:  [7.86455244]
curr_Stock_Price:  98.92711031722293
curr_Factors:  [98.92711032]
mat_Sqrt:  [[0.15]]
grads:  [-0.02975736]
Stock Position:  -0.029757362518696262
Bond Position:  [10.80836233]


portfolio before change:  [7.83725544]
curr_Stock_Price:  99.9352451390408
curr_Factors:  [99.93524514]
mat_Sqrt:  [[0.15]]
grads:  [-0.03221639]
Stock Position:  -0.03221639005713271
Bond Position:  [11.05680827]


portfolio before change:  [7.84452006]
curr_Stock_Price:  99.79556226782981
curr_Factors:  [99.79556227]
mat_Sqrt:  [[0.15]]
grads:  [-0.15166843]
Stock Position:  -0.15166842740796393
Bond Position:  [22.98035605]


portfolio before change:  [8.05227962]
curr_Stock_Price:  98.46361894414215
curr_Factors:  [98.46361894]
mat_Sqrt:  [[0.15]]
grads:  [0.01039492]
Stock Position:  0.010394924447581673
Bond Position:  [7.02875774]


portfolio before change:  [8.0569865]
curr_Stock_Price:  98.7473602436741
curr_Factors:  [98.74736024]
mat_Sqrt:  [[0.15]]
grads:  [-0.07092301]
Stock Position:  -0.07092301390134469
Bond Position:  [15.0604469]


portfolio before change:  [8.06613891]
curr_Stock_Price:  98.67140707110254
curr_Factors:  [98.67140707]
mat_Sqrt:  [[0.15]]
grads:  [0.09133904]
Stock Position:  0.09133903938259046
Bond Position:  [-0.94641263]


portfolio before change:  [8.03606174]
curr_Stock_Price:  98.3447063212156
curr_Factors:  [98.34470632]
mat_Sqrt:  [[0.15]]
grads:  [-0.22447394]
Stock Position:  -0.22447393875378724
Bond Position:  [30.11188533]


portfolio before change:  [8.46445723]
curr_Stock_Price:  96.46980457198721
curr_Factors:  [96.46980457]
mat_Sqrt:  [[0.15]]
grads:  [0.01365079]
Stock Position:  0.01365079352100752
Bond Position:  [7.14756785]


portfolio before change:  [8.48120047]
curr_Stock_Price:  97.56542722851651
curr_Factors:  [97.56542723]
mat_Sqrt:  [[0.15]]
grads:  [0.06641347]
Stock Position:  0.06641346586603562
Bond Position:  [2.0015423]


portfolio before change:  [8.40295197]
curr_Stock_Price:  96.37968960248242
curr_Factors:  [96.3796896]
mat_Sqrt:  [[0.15]]
grads:  [-0.05997769]
Stock Position:  -0.05997768639108272
Bond Position:  [14.18358277]


portfolio before change:  [8.3223168]
curr_Stock_Price:  97.78323672357898
curr_Factors:  [97.78323672]
mat_Sqrt:  [[0.15]]
grads:  [0.01858375]
Stock Position:  0.018583746367816928
Bond Position:  [6.50513793]


portfolio before change:  [8.33420817]
curr_Stock_Price:  98.335594705693
curr_Factors:  [98.33559471]
mat_Sqrt:  [[0.15]]
grads:  [0.03474702]
Stock Position:  0.034747023639117754
Bond Position:  [4.91733894]


portfolio before change:  [8.32907388]
curr_Stock_Price:  98.15244860802365
curr_Factors:  [98.15244861]
mat_Sqrt:  [[0.15]]
grads:  [-0.00662971]
Stock Position:  -0.006629707344716405
Bond Position:  [8.97979589]


portfolio before change:  [8.33106252]
curr_Stock_Price:  98.19115129966977
curr_Factors:  [98.1911513]
mat_Sqrt:  [[0.15]]
grads:  [0.05287402]
Stock Position:  0.05287402485212781
Bond Position:  [3.13930114]


portfolio before change:  [8.31793871]
curr_Stock_Price:  97.9280970858132
curr_Factors:  [97.92809709]
mat_Sqrt:  [[0.15]]
grads:  [0.12064547]
Stock Position:  0.12064547443101442
Bond Position:  [-3.49664303]


portfolio before change:  [8.3828975]
curr_Stock_Price:  98.47377083401943
curr_Factors:  [98.47377083]
mat_Sqrt:  [[0.15]]
grads:  [0.03943239]
Stock Position:  0.03943239031324083
Bond Position:  [4.49984134]


portfolio before change:  [8.3706488]
curr_Stock_Price:  98.1346128972
curr_Factors:  [98.1346129]
mat_Sqrt:  [[0.15]]
grads:  [0.02769233]
Stock Position:  0.02769233041370815
Bond Position:  [5.65307267]


portfolio before change:  [8.33987327]
curr_Stock_Price:  96.97223439825044
curr_Factors:  [96.9722344]
mat_Sqrt:  [[0.15]]
grads:  [-0.03946305]
Stock Position:  -0.03946305308803931
Bond Position:  [12.16669371]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.40177766]
Stock Price:  95.48065351804013
PL:  [8.40177766]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.91047660e-02]
 [ 4.16881637e-02]
 [-2.83336787e-02]
 [ 4.50590502e-02]
 [ 4.62654926e-03]
 [-1.36349071e-02]
 [-1.16935938e-02]
 [-7.78583678e-03]
 [ 2.64197394e-02]
 [-1.09372506e-03]
 [-3.57702512e-03]
 [ 1.20752283e-02]
 [ 1.18576049e-02]
 [-3.20066582e-03]
 [ 1.19929616e-02]
 [ 1.99487290e-02]
 [ 1.05528099e-02]
 [ 1.52407791e-02]
 [-1.73945087e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [32.18791374]
curr_Stock_Price:  101.3879480281886
curr_Factors:  [101.38794803]
mat_Sqrt:  [[0.15]]
grads:  [-0.12736511]
Stock Position:  -0.1273651068378312
Bond Position:  [45.10120057]


portfolio before change:  [32.07272851]
curr_Stock_Price:  102.38085679826065
curr_Factors:  [102.3808568]
mat_Sqrt:  [[0.15]]
grads:  [0.27792109]
Stock Position:  0.277921091220316
Bond Position:  [3.61892907]


portfolio before change:  [31.90802888]
curr_Stock_Price:  101.78498808786595
curr_Factors:  [101.78498809]
mat_Sqrt:  [[0.15]]
grads:  [-0.18889119]
Stock Position:  -0.1888911915635677
Bond Position:  [51.13431656]


portfolio before change:  [31.77416035]
curr_Stock_Price:  102.56138057942512
curr_Factors:  [102.56138058]
mat_Sqrt:  [[0.15]]
grads:  [0.30039367]
Stock Position:  0.30039366790332833
Bond Position:  [0.96537105]


portfolio before change:  [32.53592652]
curr_Stock_Price:  105.0964699714104
curr_Factors:  [105.09646997]
mat_Sqrt:  [[0.15]]
grads:  [0.03084366]
Stock Position:  0.030843661722979976
Bond Position:  [29.29436656]


portfolio before change:  [32.48847299]
curr_Stock_Price:  103.32047972582664
curr_Factors:  [103.32047973]
mat_Sqrt:  [[0.15]]
grads:  [-0.09089938]
Stock Position:  -0.09089938099619842
Bond Position:  [41.88024064]


portfolio before change:  [32.30415449]
curr_Stock_Price:  105.46339715438066
curr_Factors:  [105.46339715]
mat_Sqrt:  [[0.15]]
grads:  [-0.07795729]
Stock Position:  -0.07795729223687926
Bond Position:  [40.52579536]


portfolio before change:  [32.25303521]
curr_Stock_Price:  106.24910940469186
curr_Factors:  [106.2491094]
mat_Sqrt:  [[0.15]]
grads:  [-0.05190558]
Stock Position:  -0.051905578555338124
Bond Position:  [37.7679567]


portfolio before change:  [32.27870502]
curr_Stock_Price:  105.9364908377403
curr_Factors:  [105.93649084]
mat_Sqrt:  [[0.15]]
grads:  [0.1761316]
Stock Position:  0.1761315958089593
Bond Position:  [13.61994184]


portfolio before change:  [32.15536769]
curr_Stock_Price:  105.21689962363358
curr_Factors:  [105.21689962]
mat_Sqrt:  [[0.15]]
grads:  [-0.0072915]
Stock Position:  -0.007291500429692516
Bond Position:  [32.92255675]


portfolio before change:  [32.16238417]
curr_Stock_Price:  105.38355766371116
curr_Factors:  [105.38355766]
mat_Sqrt:  [[0.15]]
grads:  [-0.02384683]
Stock Position:  -0.0238468341009785
Bond Position:  [34.67544838]


portfolio before change:  [32.17015061]
curr_Stock_Price:  105.42144527241116
curr_Factors:  [105.42144527]
mat_Sqrt:  [[0.15]]
grads:  [0.08050152]
Stock Position:  0.08050152198350756
Bond Position:  [23.68356382]


portfolio before change:  [32.16407043]
curr_Stock_Price:  105.27235721236639
curr_Factors:  [105.27235721]
mat_Sqrt:  [[0.15]]
grads:  [0.0790507]
Stock Position:  0.07905069939199881
Bond Position:  [23.84221696]


portfolio before change:  [32.20861286]
curr_Stock_Price:  105.76041278447737
curr_Factors:  [105.76041278]
mat_Sqrt:  [[0.15]]
grads:  [-0.02133777]
Stock Position:  -0.021337772144015457
Bond Position:  [34.46530445]


portfolio before change:  [32.2227062]
curr_Stock_Price:  105.50378162498312
curr_Factors:  [105.50378162]
mat_Sqrt:  [[0.15]]
grads:  [0.07995308]
Stock Position:  0.07995307756029266
Bond Position:  [23.78735417]


portfolio before change:  [32.35043973]
curr_Stock_Price:  107.02699934232389
curr_Factors:  [107.02699934]
mat_Sqrt:  [[0.15]]
grads:  [0.13299153]
Stock Position:  0.13299152689398053
Bond Position:  [18.11675567]


portfolio before change:  [32.4585957]
curr_Stock_Price:  107.80619344464083
curr_Factors:  [107.80619344]
mat_Sqrt:  [[0.15]]
grads:  [0.07035207]
Stock Position:  0.07035206628895956
Bond Position:  [24.87420723]


portfolio before change:  [32.47032035]
curr_Stock_Price:  107.88444733326901
curr_Factors:  [107.88444733]
mat_Sqrt:  [[0.15]]
grads:  [0.10160519]
Stock Position:  0.10160519378183276
Bond Position:  [21.50870017]


portfolio before change:  [32.58338033]
curr_Stock_Price:  108.94425666404139
curr_Factors:  [108.94425666]
mat_Sqrt:  [[0.15]]
grads:  [-0.11596339]
Stock Position:  -0.11596339131200557
Bond Position:  [45.2169258]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [32.45054742]
Stock Price:  110.18722271146079
PL:  [22.2633247]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.09850166e-03]
 [-8.76465011e-03]
 [-5.04942873e-03]
 [-1.16258347e-02]
 [ 6.14262929e-03]
 [-9.35552934e-03]
 [-9.19318672e-04]
 [ 3.64922922e-03]
 [-5.35450364e-03]
 [ 1.06360864e-03]
 [-3.44859249e-03]
 [ 4.19563737e-03]
 [ 1.04243806e-02]
 [-8.01870551e-04]
 [ 3.07134224e-03]
 [ 2.14234920e-02]
 [ 7.37729442e-03]
 [ 1.42428663e-02]
 [-1.62249774e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.1903963]
curr_Stock_Price:  100.16301935515237
curr_Factors:  [100.16301936]
mat_Sqrt:  [[0.15]]
grads:  [-0.01399001]
Stock Position:  -0.013990011061467978
Bond Position:  [6.59167805]


portfolio before change:  [5.19002096]
curr_Stock_Price:  100.30765615161826
curr_Factors:  [100.30765615]
mat_Sqrt:  [[0.15]]
grads:  [-0.058431]
Stock Position:  -0.05843100073358637
Bond Position:  [11.05109769]


portfolio before change:  [5.20404727]
curr_Stock_Price:  100.11489568131805
curr_Factors:  [100.11489568]
mat_Sqrt:  [[0.15]]
grads:  [-0.03366286]
Stock Position:  -0.03366285819584367
Bond Position:  [8.5742008]


portfolio before change:  [5.20380206]
curr_Stock_Price:  100.18586485718018
curr_Factors:  [100.18586486]
mat_Sqrt:  [[0.15]]
grads:  [-0.07750556]
Stock Position:  -0.07750556482108517
Bond Position:  [12.9687641]


portfolio before change:  [5.16089182]
curr_Stock_Price:  100.78134251361857
curr_Factors:  [100.78134251]
mat_Sqrt:  [[0.15]]
grads:  [0.04095086]
Stock Position:  0.040950861937519525
Bond Position:  [1.03380898]


portfolio before change:  [5.17835635]
curr_Stock_Price:  101.20150561154274
curr_Factors:  [101.20150561]
mat_Sqrt:  [[0.15]]
grads:  [-0.0623702]
Stock Position:  -0.06237019563323794
Bond Position:  [11.49031405]


portfolio before change:  [5.11352335]
curr_Stock_Price:  102.28705513629065
curr_Factors:  [102.28705514]
mat_Sqrt:  [[0.15]]
grads:  [-0.00612879]
Stock Position:  -0.00612879114921765
Bond Position:  [5.74041935]


portfolio before change:  [5.1089734]
curr_Stock_Price:  103.26363157254976
curr_Factors:  [103.26363157]
mat_Sqrt:  [[0.15]]
grads:  [0.02432819]
Stock Position:  0.024328194801594566
Bond Position:  [2.59675566]


portfolio before change:  [5.10549328]
curr_Stock_Price:  103.09389454651196
curr_Factors:  [103.09389455]
mat_Sqrt:  [[0.15]]
grads:  [-0.03569669]
Stock Position:  -0.03569669095067529
Bond Position:  [8.78560417]


portfolio before change:  [5.08701124]
curr_Stock_Price:  103.67318395134991
curr_Factors:  [103.67318395]
mat_Sqrt:  [[0.15]]
grads:  [0.00709072]
Stock Position:  0.0070907242769520495
Bond Position:  [4.35189327]


portfolio before change:  [5.09467849]
curr_Stock_Price:  104.60103659802276
curr_Factors:  [104.6010366]
mat_Sqrt:  [[0.15]]
grads:  [-0.02299062]
Stock Position:  -0.022990616606642554
Bond Position:  [7.49952082]


portfolio before change:  [5.10666426]
curr_Stock_Price:  104.16126341633688
curr_Factors:  [104.16126342]
mat_Sqrt:  [[0.15]]
grads:  [0.02797092]
Stock Position:  0.02797091576875423
Bond Position:  [2.19317834]


portfolio before change:  [5.11081511]
curr_Stock_Price:  104.29005726808262
curr_Factors:  [104.29005727]
mat_Sqrt:  [[0.15]]
grads:  [0.06949587]
Stock Position:  0.06949587078314576
Bond Position:  [-2.13691323]


portfolio before change:  [5.07719956]
curr_Stock_Price:  103.81403965323584
curr_Factors:  [103.81403965]
mat_Sqrt:  [[0.15]]
grads:  [-0.0053458]
Stock Position:  -0.0053458036714059375
Bond Position:  [5.63216903]


portfolio before change:  [5.08007578]
curr_Stock_Price:  103.5394311719861
curr_Factors:  [103.53943117]
mat_Sqrt:  [[0.15]]
grads:  [0.02047561]
Stock Position:  0.02047561495319543
Bond Position:  [2.96004225]


portfolio before change:  [5.11429979]
curr_Stock_Price:  105.17473772589899
curr_Factors:  [105.17473773]
mat_Sqrt:  [[0.15]]
grads:  [0.14282328]
Stock Position:  0.14282327978070905
Bond Position:  [-9.9071012]


portfolio before change:  [5.20229177]
curr_Stock_Price:  105.808171371566
curr_Factors:  [105.80817137]
mat_Sqrt:  [[0.15]]
grads:  [0.04918196]
Stock Position:  0.04918196279548486
Bond Position:  [-0.00156177]


portfolio before change:  [5.2011638]
curr_Stock_Price:  105.78524470442615
curr_Factors:  [105.7852447]
mat_Sqrt:  [[0.15]]
grads:  [0.09495244]
Stock Position:  0.09495244200374066
Bond Position:  [-4.84340351]


portfolio before change:  [5.1721747]
curr_Stock_Price:  105.49269716632978
curr_Factors:  [105.49269717]
mat_Sqrt:  [[0.15]]
grads:  [-0.10816652]
Stock Position:  -0.10816651575131724
Bond Position:  [16.58295219]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.31763449]
Stock Price:  104.18625283072251
PL:  [1.13138166]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.87158361e-02]
 [ 4.25815564e-02]
 [-4.14582272e-02]
 [ 4.33685881e-02]
 [ 5.71503035e-03]
 [-1.19879864e-02]
 [ 1.65567952e-03]
 [ 1.12546977e-02]
 [-1.99228219e-02]
 [ 2.42132452e-03]
 [-3.00305501e-03]
 [-6.60652505e-03]
 [ 4.90622371e-03]
 [-6.32224149e-04]
 [ 7.04223323e-03]
 [ 1.83720384e-02]
 [ 7.00700585e-03]
 [ 2.66251645e-03]
 [-5.39294076e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [30.55280454]
curr_Stock_Price:  101.3137600166672
curr_Factors:  [101.31376002]
mat_Sqrt:  [[0.15]]
grads:  [-0.12477224]
Stock Position:  -0.12477224086865044
Bond Position:  [43.19394941]


portfolio before change:  [30.42609597]
curr_Stock_Price:  102.41583536904825
curr_Factors:  [102.41583537]
mat_Sqrt:  [[0.15]]
grads:  [0.28387704]
Stock Position:  0.28387704260033614
Bond Position:  [1.35259151]


portfolio before change:  [30.4873089]
curr_Stock_Price:  102.6302759037444
curr_Factors:  [102.6302759]
mat_Sqrt:  [[0.15]]
grads:  [-0.27638818]
Stock Position:  -0.27638818150539257
Bond Position:  [58.85310423]


portfolio before change:  [30.54801608]
curr_Stock_Price:  102.46387204150149
curr_Factors:  [102.46387204]
mat_Sqrt:  [[0.15]]
grads:  [0.28912392]
Stock Position:  0.28912392068187875
Bond Position:  [0.92325967]


portfolio before change:  [30.29373786]
curr_Stock_Price:  101.58359530851223
curr_Factors:  [101.58359531]
mat_Sqrt:  [[0.15]]
grads:  [0.0381002]
Stock Position:  0.03810020232771798
Bond Position:  [26.42338233]


portfolio before change:  [30.34182914]
curr_Stock_Price:  102.67242432439161
curr_Factors:  [102.67242432]
mat_Sqrt:  [[0.15]]
grads:  [-0.07991991]
Stock Position:  -0.07991990937336839
Bond Position:  [38.54739999]


portfolio before change:  [30.42370404]
curr_Stock_Price:  101.76855891057215
curr_Factors:  [101.76855891]
mat_Sqrt:  [[0.15]]
grads:  [0.01103786]
Stock Position:  0.01103786345479493
Bond Position:  [29.30039658]


portfolio before change:  [30.42889087]
curr_Stock_Price:  101.57475495502213
curr_Factors:  [101.57475496]
mat_Sqrt:  [[0.15]]
grads:  [0.07503132]
Stock Position:  0.07503131795444976
Bond Position:  [22.80760313]


portfolio before change:  [30.43432782]
curr_Stock_Price:  101.57121426193923
curr_Factors:  [101.57121426]
mat_Sqrt:  [[0.15]]
grads:  [-0.13281881]
Stock Position:  -0.13281881288591518
Bond Position:  [43.92489592]


portfolio before change:  [30.54054412]
curr_Stock_Price:  100.85419458110505
curr_Factors:  [100.85419458]
mat_Sqrt:  [[0.15]]
grads:  [0.01614216]
Stock Position:  0.01614216346680441
Bond Position:  [28.91253922]


portfolio before change:  [30.5493519]
curr_Stock_Price:  100.95199687944023
curr_Factors:  [100.95199688]
mat_Sqrt:  [[0.15]]
grads:  [-0.02002037]
Stock Position:  -0.020020366725287262
Bond Position:  [32.5704479]


portfolio before change:  [30.55033855]
curr_Stock_Price:  101.30948179981006
curr_Factors:  [101.3094818]
mat_Sqrt:  [[0.15]]
grads:  [-0.0440435]
Stock Position:  -0.04404350036041286
Bond Position:  [35.01236275]


portfolio before change:  [30.59515698]
curr_Stock_Price:  100.49064933659794
curr_Factors:  [100.49064934]
mat_Sqrt:  [[0.15]]
grads:  [0.03270816]
Stock Position:  0.032708158074710246
Bond Position:  [27.30829294]


portfolio before change:  [30.56871863]
curr_Stock_Price:  99.47358564088525
curr_Factors:  [99.47358564]
mat_Sqrt:  [[0.15]]
grads:  [-0.00421483]
Stock Position:  -0.004214827656793239
Bond Position:  [30.98798265]


portfolio before change:  [30.57850739]
curr_Stock_Price:  98.98939034838328
curr_Factors:  [98.98939035]
mat_Sqrt:  [[0.15]]
grads:  [0.04694822]
Stock Position:  0.04694822151867051
Bond Position:  [25.93113157]


portfolio before change:  [30.5266944]
curr_Stock_Price:  97.74766957556709
curr_Factors:  [97.74766958]
mat_Sqrt:  [[0.15]]
grads:  [0.12248026]
Stock Position:  0.12248025608705358
Bond Position:  [18.5545348]


portfolio before change:  [30.44038105]
curr_Stock_Price:  97.00507996561768
curr_Factors:  [97.00507997]
mat_Sqrt:  [[0.15]]
grads:  [0.04671337]
Stock Position:  0.04671337232169725
Bond Position:  [25.90894663]


portfolio before change:  [30.47222885]
curr_Stock_Price:  97.54817400489392
curr_Factors:  [97.548174]
mat_Sqrt:  [[0.15]]
grads:  [0.01775011]
Stock Position:  0.017750109633950992
Bond Position:  [28.74073807]


portfolio before change:  [30.47406064]
curr_Stock_Price:  97.2465254327093
curr_Factors:  [97.24652543]
mat_Sqrt:  [[0.15]]
grads:  [-0.03595294]
Stock Position:  -0.03595293838192914
Bond Position:  [33.97035898]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [30.47245251]
Stock Price:  97.52749776180195
PL:  [30.47245251]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.78212495e-03]
 [-7.93085579e-04]
 [-9.01855257e-03]
 [-3.84848328e-03]
 [-1.04315944e-03]
 [-1.06780769e-02]
 [ 1.47327678e-02]
 [-3.10466178e-02]
 [-4.78649392e-04]
 [ 2.44055621e-03]
 [-2.93809730e-03]
 [ 2.12677427e-03]
 [ 5.72059118e-03]
 [-1.25231870e-03]
 [ 7.86561066e-03]
 [ 1.86398287e-02]
 [ 4.27731004e-03]
 [ 5.66435412e-03]
 [-4.15931876e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.31427343]
curr_Stock_Price:  99.68640252567268
curr_Factors:  [99.68640253]
mat_Sqrt:  [[0.15]]
grads:  [0.0185475]
Stock Position:  0.01854749965892471
Bond Position:  [-7.16320695]


portfolio before change:  [-5.34224072]
curr_Stock_Price:  98.27509293632667
curr_Factors:  [98.27509294]
mat_Sqrt:  [[0.15]]
grads:  [-0.00528724]
Stock Position:  -0.005287237194548897
Bond Position:  [-4.822637]


portfolio before change:  [-5.34286283]
curr_Stock_Price:  98.16469473453189
curr_Factors:  [98.16469473]
mat_Sqrt:  [[0.15]]
grads:  [-0.06012368]
Stock Position:  -0.06012368381703398
Bond Position:  [0.55916024]


portfolio before change:  [-5.31538604]
curr_Stock_Price:  97.71001552524396
curr_Factors:  [97.71001553]
mat_Sqrt:  [[0.15]]
grads:  [-0.02565656]
Stock Position:  -0.025656555225520076
Bond Position:  [-2.80848363]


portfolio before change:  [-5.32045961]
curr_Stock_Price:  97.88039561657547
curr_Factors:  [97.88039562]
mat_Sqrt:  [[0.15]]
grads:  [-0.0069544]
Stock Position:  -0.006954396288686901
Bond Position:  [-4.63976055]


portfolio before change:  [-5.32667217]
curr_Stock_Price:  98.60691076871278
curr_Factors:  [98.60691077]
mat_Sqrt:  [[0.15]]
grads:  [-0.07118718]
Stock Position:  -0.07118717931266773
Bond Position:  [1.69287567]


portfolio before change:  [-5.4052022]
curr_Stock_Price:  99.71600519601584
curr_Factors:  [99.7160052]
mat_Sqrt:  [[0.15]]
grads:  [0.09821845]
Stock Position:  0.09821845206707393
Bond Position:  [-15.19915388]


portfolio before change:  [-5.52342832]
curr_Stock_Price:  98.55099140176577
curr_Factors:  [98.5509914]
mat_Sqrt:  [[0.15]]
grads:  [-0.20697745]
Stock Position:  -0.20697745170954154
Bond Position:  [14.87440475]


portfolio before change:  [-5.76099069]
curr_Stock_Price:  99.71672920485004
curr_Factors:  [99.7167292]
mat_Sqrt:  [[0.15]]
grads:  [-0.003191]
Stock Position:  -0.0031909959451149076
Bond Position:  [-5.44279501]


portfolio before change:  [-5.7658206]
curr_Stock_Price:  100.80386221939618
curr_Factors:  [100.80386222]
mat_Sqrt:  [[0.15]]
grads:  [0.01627037]
Stock Position:  0.0162703747152626
Bond Position:  [-7.40593721]


portfolio before change:  [-5.77847763]
curr_Stock_Price:  100.13975199177679
curr_Factors:  [100.13975199]
mat_Sqrt:  [[0.15]]
grads:  [-0.01958732]
Stock Position:  -0.019587315307318297
Bond Position:  [-3.81700874]


portfolio before change:  [-5.73642662]
curr_Stock_Price:  97.94417855832431
curr_Factors:  [97.94417856]
mat_Sqrt:  [[0.15]]
grads:  [0.0141785]
Stock Position:  0.014178495163085607
Bond Position:  [-7.12512768]


portfolio before change:  [-5.74529295]
curr_Stock_Price:  97.4444903309471
curr_Factors:  [97.44449033]
mat_Sqrt:  [[0.15]]
grads:  [0.03813727]
Stock Position:  0.0381372745189383
Bond Position:  [-9.46156023]


portfolio before change:  [-5.77562386]
curr_Stock_Price:  96.71121237926955
curr_Factors:  [96.71121238]
mat_Sqrt:  [[0.15]]
grads:  [-0.00834879]
Stock Position:  -0.008348791304494828
Bond Position:  [-4.96820213]


portfolio before change:  [-5.79096844]
curr_Stock_Price:  98.40036473378562
curr_Factors:  [98.40036473]
mat_Sqrt:  [[0.15]]
grads:  [0.0524374]
Stock Position:  0.05243740441677502
Bond Position:  [-10.95082816]


portfolio before change:  [-5.69366915]
curr_Stock_Price:  100.3081126078339
curr_Factors:  [100.30811261]
mat_Sqrt:  [[0.15]]
grads:  [0.12426552]
Stock Position:  0.12426552487857533
Bond Position:  [-18.15850941]


portfolio before change:  [-5.72401235]
curr_Stock_Price:  100.10046843601323
curr_Factors:  [100.10046844]
mat_Sqrt:  [[0.15]]
grads:  [0.0285154]
Stock Position:  0.028515400284535357
Bond Position:  [-8.57841728]


portfolio before change:  [-5.76527687]
curr_Stock_Price:  98.72859059876673
curr_Factors:  [98.7285906]
mat_Sqrt:  [[0.15]]
grads:  [0.03776236]
Stock Position:  0.037762360769312435
Bond Position:  [-9.49350153]


portfolio before change:  [-5.79250596]
curr_Stock_Price:  98.07038452905574
curr_Factors:  [98.07038453]
mat_Sqrt:  [[0.15]]
grads:  [-0.02772879]
Stock Position:  -0.027728791712588956
Bond Position:  [-3.07313269]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.80983496]
Stock Price:  98.6676200288728
PL:  [-5.80983496]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.78180757e-03]
 [-6.07100977e-03]
 [-5.26595079e-03]
 [-6.07803363e-03]
 [ 6.16864637e-03]
 [-9.78968380e-03]
 [ 1.38131487e-02]
 [-4.53146726e-02]
 [-1.96358533e-03]
 [ 7.97180692e-03]
 [-2.93690157e-03]
 [-6.50371767e-03]
 [ 1.03249966e-02]
 [-4.20229723e-03]
 [ 1.74165548e-02]
 [ 1.95044366e-02]
 [ 1.10564767e-02]
 [ 1.51357039e-02]
 [-1.61341166e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.16726431]
curr_Stock_Price:  99.6477007083694
curr_Factors:  [99.64770071]
mat_Sqrt:  [[0.15]]
grads:  [0.01854538]
Stock Position:  0.0185453837684202
Bond Position:  [-8.01526917]


portfolio before change:  [-6.17812975]
curr_Stock_Price:  99.16988024524511
curr_Factors:  [99.16988025]
mat_Sqrt:  [[0.15]]
grads:  [-0.0404734]
Stock Position:  -0.04047339847453207
Bond Position:  [-2.16438767]


portfolio before change:  [-6.22581404]
curr_Stock_Price:  100.33467321436666
curr_Factors:  [100.33467321]
mat_Sqrt:  [[0.15]]
grads:  [-0.03510634]
Stock Position:  -0.03510633859825352
Bond Position:  [-2.70343103]


portfolio before change:  [-6.23406862]
curr_Stock_Price:  100.55054990604407
curr_Factors:  [100.55054991]
mat_Sqrt:  [[0.15]]
grads:  [-0.04052022]
Stock Position:  -0.04052022416706272
Bond Position:  [-2.1597378]


portfolio before change:  [-6.19570356]
curr_Stock_Price:  99.59041048320614
curr_Factors:  [99.59041048]
mat_Sqrt:  [[0.15]]
grads:  [0.04112431]
Stock Position:  0.041124309127767676
Bond Position:  [-10.29129039]


portfolio before change:  [-6.16048481]
curr_Stock_Price:  100.50937764479015
curr_Factors:  [100.50937764]
mat_Sqrt:  [[0.15]]
grads:  [-0.06526456]
Stock Position:  -0.06526455863549006
Bond Position:  [0.39921536]


portfolio before change:  [-6.05515956]
curr_Stock_Price:  98.89708693019307
curr_Factors:  [98.89708693]
mat_Sqrt:  [[0.15]]
grads:  [0.09208766]
Stock Position:  0.09208765800578472
Bond Position:  [-15.16236068]


portfolio before change:  [-6.19491445]
curr_Stock_Price:  97.42062596040748
curr_Factors:  [97.42062596]
mat_Sqrt:  [[0.15]]
grads:  [-0.30209782]
Stock Position:  -0.30209781765703875
Bond Position:  [23.23564404]


portfolio before change:  [-6.63253444]
curr_Stock_Price:  98.88846055513318
curr_Factors:  [98.88846056]
mat_Sqrt:  [[0.15]]
grads:  [-0.01309057]
Stock Position:  -0.01309056886285985
Bond Position:  [-5.33802824]


portfolio before change:  [-6.64190496]
curr_Stock_Price:  99.50232557329807
curr_Factors:  [99.50232557]
mat_Sqrt:  [[0.15]]
grads:  [0.05314538]
Stock Position:  0.053145379446282275
Bond Position:  [-11.92999381]


portfolio before change:  [-6.6153314]
curr_Stock_Price:  100.05846864344599
curr_Factors:  [100.05846864]
mat_Sqrt:  [[0.15]]
grads:  [-0.01957934]
Stock Position:  -0.01957934381466225
Bond Position:  [-4.65625224]


portfolio before change:  [-6.66070582]
curr_Stock_Price:  102.31647133423533
curr_Factors:  [102.31647133]
mat_Sqrt:  [[0.15]]
grads:  [-0.04335812]
Stock Position:  -0.043358117773219775
Bond Position:  [-2.2244562]


portfolio before change:  [-6.74387961]
curr_Stock_Price:  104.2219417063075
curr_Factors:  [104.22194171]
mat_Sqrt:  [[0.15]]
grads:  [0.06883331]
Stock Position:  0.06883331091826518
Bond Position:  [-13.91782093]


portfolio before change:  [-6.58551924]
curr_Stock_Price:  106.5731326083579
curr_Factors:  [106.57313261]
mat_Sqrt:  [[0.15]]
grads:  [-0.02801531]
Stock Position:  -0.028015314898765555
Bond Position:  [-3.59983938]


portfolio before change:  [-6.59162386]
curr_Stock_Price:  106.75890760137133
curr_Factors:  [106.7589076]
mat_Sqrt:  [[0.15]]
grads:  [0.11611037]
Stock Position:  0.11611036535683446
Bond Position:  [-18.98743963]


portfolio before change:  [-6.50045129]
curr_Stock_Price:  107.58501839649479
curr_Factors:  [107.5850184]
mat_Sqrt:  [[0.15]]
grads:  [0.13002958]
Stock Position:  0.1300295773518397
Bond Position:  [-20.48968576]


portfolio before change:  [-6.43285772]
curr_Stock_Price:  108.1442498956529
curr_Factors:  [108.1442499]
mat_Sqrt:  [[0.15]]
grads:  [0.07370984]
Stock Position:  0.07370984464458918
Bond Position:  [-14.40415357]


portfolio before change:  [-6.47208109]
curr_Stock_Price:  107.66097820429071
curr_Factors:  [107.6609782]
mat_Sqrt:  [[0.15]]
grads:  [0.10090469]
Stock Position:  0.1009046926493664
Bond Position:  [-17.335579]


portfolio before change:  [-6.73448605]
curr_Stock_Price:  105.10341105640366
curr_Factors:  [105.10341106]
mat_Sqrt:  [[0.15]]
grads:  [-0.10756078]
Stock Position:  -0.10756077707604665
Bond Position:  [4.57051852]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.67217145]
Stock Price:  104.53469233040731
PL:  [-11.20686378]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-9.30805633e-03]
 [ 4.40548909e-02]
 [-1.29111371e-02]
 [ 9.48960827e-03]
 [ 5.75904739e-03]
 [-1.01066617e-02]
 [ 6.30609110e-03]
 [ 1.19030719e-02]
 [-1.87521304e-02]
 [ 2.34920077e-03]
 [-3.05342064e-03]
 [-6.58052381e-03]
 [ 6.58265930e-03]
 [-2.47012706e-04]
 [ 1.13615990e-03]
 [ 1.83776752e-02]
 [ 1.17255302e-03]
 [ 9.76736323e-03]
 [-4.12162828e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.31111733]
curr_Stock_Price:  100.48610000079121
curr_Factors:  [100.4861]
mat_Sqrt:  [[0.15]]
grads:  [-0.06205371]
Stock Position:  -0.06205370885068395
Bond Position:  [18.54665253]


portfolio before change:  [12.19242779]
curr_Stock_Price:  102.47352012071408
curr_Factors:  [102.47352012]
mat_Sqrt:  [[0.15]]
grads:  [0.29369927]
Stock Position:  0.2936992728560111
Bond Position:  [-17.90397056]


portfolio before change:  [11.7388992]
curr_Stock_Price:  100.94456830032672
curr_Factors:  [100.9445683]
mat_Sqrt:  [[0.15]]
grads:  [-0.08607425]
Stock Position:  -0.08607424756701255
Bond Position:  [20.42762696]


portfolio before change:  [11.73634225]
curr_Stock_Price:  101.0336134335455
curr_Factors:  [101.03361343]
mat_Sqrt:  [[0.15]]
grads:  [0.06326406]
Stock Position:  0.06326405515667759
Bond Position:  [5.34454616]


portfolio before change:  [11.63116753]
curr_Stock_Price:  99.35001878653814
curr_Factors:  [99.35001879]
mat_Sqrt:  [[0.15]]
grads:  [0.03839365]
Stock Position:  0.038393649256869
Bond Position:  [7.81675775]


portfolio before change:  [11.64408801]
curr_Stock_Price:  99.63564020501397
curr_Factors:  [99.63564021]
mat_Sqrt:  [[0.15]]
grads:  [-0.06737774]
Stock Position:  -0.06737774485796279
Bond Position:  [18.35731275]


portfolio before change:  [11.54893769]
curr_Stock_Price:  101.11595429061157
curr_Factors:  [101.11595429]
mat_Sqrt:  [[0.15]]
grads:  [0.04204061]
Stock Position:  0.0420406073021931
Bond Position:  [7.29796156]


portfolio before change:  [11.56581571]
curr_Stock_Price:  101.47402015327583
curr_Factors:  [101.47402015]
mat_Sqrt:  [[0.15]]
grads:  [0.07935381]
Stock Position:  0.07935381299746568
Bond Position:  [3.51346529]


portfolio before change:  [11.58972875]
curr_Stock_Price:  101.7642967966555
curr_Factors:  [101.7642968]
mat_Sqrt:  [[0.15]]
grads:  [-0.1250142]
Stock Position:  -0.12501420259026713
Bond Position:  [24.31171116]


portfolio before change:  [11.66818502]
curr_Stock_Price:  101.18534192856987
curr_Factors:  [101.18534193]
mat_Sqrt:  [[0.15]]
grads:  [0.01566134]
Stock Position:  0.01566133849173667
Bond Position:  [10.08348713]


portfolio before change:  [11.68100529]
curr_Stock_Price:  101.84295403193242
curr_Factors:  [101.84295403]
mat_Sqrt:  [[0.15]]
grads:  [-0.02035614]
Stock Position:  -0.020356137587264025
Bond Position:  [13.75413447]


portfolio before change:  [11.68129664]
curr_Stock_Price:  101.99758133207914
curr_Factors:  [101.99758133]
mat_Sqrt:  [[0.15]]
grads:  [-0.04387016]
Stock Position:  -0.043870158736394375
Bond Position:  [16.15594672]


portfolio before change:  [11.70077002]
curr_Stock_Price:  101.64577299935547
curr_Factors:  [101.645773]
mat_Sqrt:  [[0.15]]
grads:  [0.0438844]
Stock Position:  0.043884395355400764
Bond Position:  [7.24010673]


portfolio before change:  [11.65501481]
curr_Stock_Price:  100.56189210303339
curr_Factors:  [100.5618921]
mat_Sqrt:  [[0.15]]
grads:  [-0.00164675]
Stock Position:  -0.0016467513741092825
Bond Position:  [11.82061525]


portfolio before change:  [11.65718181]
curr_Stock_Price:  101.04072966793214
curr_Factors:  [101.04072967]
mat_Sqrt:  [[0.15]]
grads:  [0.0075744]
Stock Position:  0.00757439932141416
Bond Position:  [10.89185897]


portfolio before change:  [11.65386774]
curr_Stock_Price:  100.24365400602342
curr_Factors:  [100.24365401]
mat_Sqrt:  [[0.15]]
grads:  [0.12251783]
Stock Position:  0.12251783471770195
Bond Position:  [-0.62776769]


portfolio before change:  [11.84435308]
curr_Stock_Price:  101.79969111619353
curr_Factors:  [101.79969112]
mat_Sqrt:  [[0.15]]
grads:  [0.00781702]
Stock Position:  0.007817020163060708
Bond Position:  [11.04858284]


portfolio before change:  [11.83885033]
curr_Stock_Price:  100.74235222403823
curr_Factors:  [100.74235222]
mat_Sqrt:  [[0.15]]
grads:  [0.06511575]
Stock Position:  0.06511575486799322
Bond Position:  [5.27893602]


portfolio before change:  [11.69675718]
curr_Stock_Price:  98.539919832059
curr_Factors:  [98.53991983]
mat_Sqrt:  [[0.15]]
grads:  [-0.02747752]
Stock Position:  -0.027477521899361004
Bond Position:  [14.40438999]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.70876675]
Stock Price:  98.23392366178432
PL:  [11.70876675]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.86323494e-02]
 [ 2.52889540e-02]
 [-3.83221106e-02]
 [ 4.30604011e-02]
 [ 5.71381265e-03]
 [-1.20475933e-02]
 [-3.62103569e-03]
 [ 3.46102246e-03]
 [-5.69538361e-04]
 [ 2.34115112e-03]
 [-3.05889514e-03]
 [-6.62553530e-03]
 [ 8.42234521e-03]
 [ 2.33884619e-04]
 [ 7.79043690e-05]
 [ 2.25229283e-02]
 [ 2.40467825e-03]
 [ 1.32560006e-02]
 [-1.63005520e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [30.20181605]
curr_Stock_Price:  101.29783500173748
curr_Factors:  [101.297835]
mat_Sqrt:  [[0.15]]
grads:  [-0.12421566]
Stock Position:  -0.12421566267733365
Bond Position:  [42.78459375]


portfolio before change:  [30.16614629]
curr_Stock_Price:  101.67111518996263
curr_Factors:  [101.67111519]
mat_Sqrt:  [[0.15]]
grads:  [0.16859303]
Stock Position:  0.1685930269851721
Bond Position:  [13.02510522]


portfolio before change:  [30.29526248]
curr_Stock_Price:  102.41764374337217
curr_Factors:  [102.41764374]
mat_Sqrt:  [[0.15]]
grads:  [-0.25548074]
Stock Position:  -0.2554807370279108
Bond Position:  [56.46099759]


portfolio before change:  [30.30211066]
curr_Stock_Price:  102.44609532329858
curr_Factors:  [102.44609532]
mat_Sqrt:  [[0.15]]
grads:  [0.28706934]
Stock Position:  0.28706934038727294
Bond Position:  [0.89297765]


portfolio before change:  [30.12946929]
curr_Stock_Price:  101.8439249630716
curr_Factors:  [101.84392496]
mat_Sqrt:  [[0.15]]
grads:  [0.03809208]
Stock Position:  0.03809208435108369
Bond Position:  [26.25002191]


portfolio before change:  [30.16848533]
curr_Stock_Price:  102.69587936733159
curr_Factors:  [102.69587937]
mat_Sqrt:  [[0.15]]
grads:  [-0.08031729]
Stock Position:  -0.08031728894585781
Bond Position:  [38.41673995]


portfolio before change:  [30.13973979]
curr_Stock_Price:  103.17337215885199
curr_Factors:  [103.17337216]
mat_Sqrt:  [[0.15]]
grads:  [-0.02414024]
Stock Position:  -0.02414023792305493
Bond Position:  [32.63036954]


portfolio before change:  [30.14468783]
curr_Stock_Price:  103.30636886558587
curr_Factors:  [103.30636887]
mat_Sqrt:  [[0.15]]
grads:  [0.02307348]
Stock Position:  0.02307348308163928
Bond Position:  [27.76105008]


portfolio before change:  [30.15687486]
curr_Stock_Price:  103.53372490272717
curr_Factors:  [103.5337249]
mat_Sqrt:  [[0.15]]
grads:  [-0.00379692]
Stock Position:  -0.003796922404157039
Bond Position:  [30.54998438]


portfolio before change:  [30.16745128]
curr_Stock_Price:  102.75994914700021
curr_Factors:  [102.75994915]
mat_Sqrt:  [[0.15]]
grads:  [0.01560767]
Stock Position:  0.015607674154470237
Bond Position:  [28.56360747]


portfolio before change:  [30.16184845]
curr_Stock_Price:  101.94338782023425
curr_Factors:  [101.94338782]
mat_Sqrt:  [[0.15]]
grads:  [-0.02039263]
Stock Position:  -0.020392634299682494
Bond Position:  [32.24074267]


portfolio before change:  [30.17703659]
curr_Stock_Price:  101.59390142843074
curr_Factors:  [101.59390143]
mat_Sqrt:  [[0.15]]
grads:  [-0.04417024]
Stock Position:  -0.04417023535474214
Bond Position:  [34.66446313]


portfolio before change:  [30.12910889]
curr_Stock_Price:  102.87519182725822
curr_Factors:  [102.87519183]
mat_Sqrt:  [[0.15]]
grads:  [0.05614897]
Stock Position:  0.05614896805690977
Bond Position:  [24.35277303]


portfolio before change:  [30.06832696]
curr_Stock_Price:  101.684237010887
curr_Factors:  [101.68423701]
mat_Sqrt:  [[0.15]]
grads:  [0.00155923]
Stock Position:  0.0015592307965610558
Bond Position:  [29.90977777]


portfolio before change:  [30.07764021]
curr_Stock_Price:  102.86101580545478
curr_Factors:  [102.86101581]
mat_Sqrt:  [[0.15]]
grads:  [0.00051936]
Stock Position:  0.0005193624599809585
Bond Position:  [30.02421806]


portfolio before change:  [30.08563169]
curr_Stock_Price:  103.79387594302503
curr_Factors:  [103.79387594]
mat_Sqrt:  [[0.15]]
grads:  [0.15015286]
Stock Position:  0.15015285552722185
Bond Position:  [14.50068483]


portfolio before change:  [30.02820915]
curr_Stock_Price:  103.38730244413053
curr_Factors:  [103.38730244]
mat_Sqrt:  [[0.15]]
grads:  [0.01603119]
Stock Position:  0.016031188359105848
Bond Position:  [28.37078783]


portfolio before change:  [30.04742325]
curr_Stock_Price:  104.14336099762376
curr_Factors:  [104.143361]
mat_Sqrt:  [[0.15]]
grads:  [0.08837334]
Stock Position:  0.08837333748948296
Bond Position:  [20.84392686]


portfolio before change:  [30.15183476]
curr_Stock_Price:  105.26587017981332
curr_Factors:  [105.26587018]
mat_Sqrt:  [[0.15]]
grads:  [-0.10867035]
Stock Position:  -0.10867034671849288
Bond Position:  [41.59111337]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [30.14883934]
Stock Price:  105.3891282456755
PL:  [24.7597111]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.93450498e-03]
 [-9.85188964e-03]
 [-2.97828217e-02]
 [ 3.45269630e-02]
 [ 5.74593472e-03]
 [-9.34727384e-03]
 [ 1.19761546e-02]
 [ 6.19863743e-03]
 [-1.37812159e-02]
 [ 2.86340390e-03]
 [-3.15403771e-03]
 [-1.04406887e-04]
 [ 8.47043508e-03]
 [ 1.25563798e-04]
 [ 8.22653740e-03]
 [ 2.29674117e-02]
 [ 9.07773103e-04]
 [ 1.26540325e-02]
 [-1.03619183e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.9462927]
curr_Stock_Price:  100.15194391089284
curr_Factors:  [100.15194391]
mat_Sqrt:  [[0.15]]
grads:  [-0.0128967]
Stock Position:  -0.012896699882720294
Bond Position:  [6.23792227]


portfolio before change:  [4.94834166]
curr_Stock_Price:  100.11400515302938
curr_Factors:  [100.11400515]
mat_Sqrt:  [[0.15]]
grads:  [-0.06567926]
Stock Position:  -0.06567926428426862
Bond Position:  [11.52375587]


portfolio before change:  [4.83546642]
curr_Stock_Price:  101.87645695002007
curr_Factors:  [101.87645695]
mat_Sqrt:  [[0.15]]
grads:  [-0.19855214]
Stock Position:  -0.19855214438821744
Bond Position:  [25.06325542]


portfolio before change:  [4.83252687]
curr_Stock_Price:  101.92282337954767
curr_Factors:  [101.92282338]
mat_Sqrt:  [[0.15]]
grads:  [0.23017975]
Stock Position:  0.23017975360152626
Bond Position:  [-18.6280435]


portfolio before change:  [4.64577537]
curr_Stock_Price:  101.13172903298532
curr_Factors:  [101.13172903]
mat_Sqrt:  [[0.15]]
grads:  [0.03830623]
Stock Position:  0.03830623146999624
Bond Position:  [0.77179995]


portfolio before change:  [4.65167287]
curr_Stock_Price:  101.28064783993281
curr_Factors:  [101.28064784]
mat_Sqrt:  [[0.15]]
grads:  [-0.06231516]
Stock Position:  -0.06231515890637497
Bond Position:  [10.96299253]


portfolio before change:  [4.71318404]
curr_Stock_Price:  100.33753737143836
curr_Factors:  [100.33753737]
mat_Sqrt:  [[0.15]]
grads:  [0.07984103]
Stock Position:  0.0798410308689594
Bond Position:  [-3.29786838]


portfolio before change:  [4.70584191]
curr_Stock_Price:  100.25590574470192
curr_Factors:  [100.25590574]
mat_Sqrt:  [[0.15]]
grads:  [0.04132425]
Stock Position:  0.04132424950088815
Bond Position:  [0.56284185]


portfolio before change:  [4.71351666]
curr_Stock_Price:  100.43822039345632
curr_Factors:  [100.43822039]
mat_Sqrt:  [[0.15]]
grads:  [-0.09187477]
Stock Position:  -0.09187477278221212
Bond Position:  [13.94125533]


portfolio before change:  [4.70013061]
curr_Stock_Price:  100.62185941742183
curr_Factors:  [100.62185942]
mat_Sqrt:  [[0.15]]
grads:  [0.01908936]
Stock Position:  0.01908935930404828
Bond Position:  [2.77932378]


portfolio before change:  [4.7425262]
curr_Stock_Price:  102.80635767756783
curr_Factors:  [102.80635768]
mat_Sqrt:  [[0.15]]
grads:  [-0.02102692]
Stock Position:  -0.02102691804849881
Bond Position:  [6.90422706]


portfolio before change:  [4.73022331]
curr_Stock_Price:  103.47355795115328
curr_Factors:  [103.47355795]
mat_Sqrt:  [[0.15]]
grads:  [-0.00069605]
Stock Position:  -0.0006960459155155632
Bond Position:  [4.80224566]


portfolio before change:  [4.73182107]
curr_Stock_Price:  102.90312079090845
curr_Factors:  [102.90312079]
mat_Sqrt:  [[0.15]]
grads:  [0.05646957]
Stock Position:  0.05646956719143184
Bond Position:  [-1.07907362]


portfolio before change:  [4.71952379]
curr_Stock_Price:  102.6901303038858
curr_Factors:  [102.6901303]
mat_Sqrt:  [[0.15]]
grads:  [0.00083709]
Stock Position:  0.0008370919893907972
Bond Position:  [4.6335627]


portfolio before change:  [4.72228129]
curr_Stock_Price:  104.60027395630125
curr_Factors:  [104.60027396]
mat_Sqrt:  [[0.15]]
grads:  [0.05484358]
Stock Position:  0.05484358268780589
Bond Position:  [-1.01437248]


portfolio before change:  [4.61061834]
curr_Stock_Price:  102.56887275101906
curr_Factors:  [102.56887275]
mat_Sqrt:  [[0.15]]
grads:  [0.15311608]
Stock Position:  0.1531160783085936
Bond Position:  [-11.09432521]


portfolio before change:  [4.57817312]
curr_Stock_Price:  102.37508970908446
curr_Factors:  [102.37508971]
mat_Sqrt:  [[0.15]]
grads:  [0.00605182]
Stock Position:  0.006051820685992589
Bond Position:  [3.95861743]


portfolio before change:  [4.58392077]
curr_Stock_Price:  103.16127833464262
curr_Factors:  [103.16127833]
mat_Sqrt:  [[0.15]]
grads:  [0.08436022]
Stock Position:  0.08436021653854683
Bond Position:  [-4.11878701]


portfolio before change:  [4.56502737]
curr_Stock_Price:  102.94952477273303
curr_Factors:  [102.94952477]
mat_Sqrt:  [[0.15]]
grads:  [-0.06907946]
Stock Position:  -0.06907945553004662
Bond Position:  [11.67672448]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.59237653]
Stock Price:  102.59587953136979
PL:  [1.996497]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 1.23134215e-03]
 [-4.00881241e-03]
 [-4.06364461e-03]
 [-2.21660512e-02]
 [ 4.68466419e-03]
 [-1.04670222e-02]
 [ 7.16317884e-03]
 [-3.89460553e-03]
 [-6.55187157e-04]
 [ 4.91480011e-03]
 [-3.80187701e-03]
 [-4.24568500e-03]
 [ 5.04312906e-03]
 [-8.53203815e-04]
 [ 7.87760899e-03]
 [ 1.97934438e-02]
 [ 7.02090395e-03]
 [ 6.36195215e-04]
 [-4.81800113e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-38.09214491]
curr_Stock_Price:  98.19920820451024
curr_Factors:  [98.1992082]
mat_Sqrt:  [[0.15]]
grads:  [0.00820895]
Stock Position:  0.008208947655474001
Bond Position:  [-38.89825707]


portfolio before change:  [-38.0965269]
curr_Stock_Price:  98.85017970944347
curr_Factors:  [98.85017971]
mat_Sqrt:  [[0.15]]
grads:  [-0.02672542]
Stock Position:  -0.02672541603844209
Bond Position:  [-35.45471472]


portfolio before change:  [-38.12314532]
curr_Stock_Price:  99.51447738601748
curr_Factors:  [99.51447739]
mat_Sqrt:  [[0.15]]
grads:  [-0.02709096]
Stock Position:  -0.02709096404862987
Bond Position:  [-35.42720219]


portfolio before change:  [-38.14023801]
curr_Stock_Price:  99.8184453612904
curr_Factors:  [99.81844536]
mat_Sqrt:  [[0.15]]
grads:  [-0.14777367]
Stock Position:  -0.14777367441795253
Bond Position:  [-23.38969956]


portfolio before change:  [-38.04247817]
curr_Stock_Price:  99.11731915084009
curr_Factors:  [99.11731915]
mat_Sqrt:  [[0.15]]
grads:  [0.03123109]
Stock Position:  0.031231094585739447
Bond Position:  [-41.13802054]


portfolio before change:  [-38.05152484]
curr_Stock_Price:  99.15699491856333
curr_Factors:  [99.15699492]
mat_Sqrt:  [[0.15]]
grads:  [-0.06978015]
Stock Position:  -0.06978014795547027
Bond Position:  [-31.13233507]


portfolio before change:  [-38.18815462]
curr_Stock_Price:  101.00344733701958
curr_Factors:  [101.00344734]
mat_Sqrt:  [[0.15]]
grads:  [0.04775453]
Stock Position:  0.047754525607491105
Bond Position:  [-43.01152633]


portfolio before change:  [-38.25087404]
curr_Stock_Price:  99.91527415510393
curr_Factors:  [99.91527416]
mat_Sqrt:  [[0.15]]
grads:  [-0.02596404]
Stock Position:  -0.025964036848433493
Bond Position:  [-35.65667018]


portfolio before change:  [-38.24925818]
curr_Stock_Price:  99.50966917273097
curr_Factors:  [99.50966917]
mat_Sqrt:  [[0.15]]
grads:  [-0.00436791]
Stock Position:  -0.0043679143789363386
Bond Position:  [-37.81460847]


portfolio before change:  [-38.26116788]
curr_Stock_Price:  100.07169071398391
curr_Factors:  [100.07169071]
mat_Sqrt:  [[0.15]]
grads:  [0.03276533]
Stock Position:  0.03276533403443508
Bond Position:  [-41.54005025]


portfolio before change:  [-38.31022564]
curr_Stock_Price:  98.89143558569445
curr_Factors:  [98.89143559]
mat_Sqrt:  [[0.15]]
grads:  [-0.02534585]
Stock Position:  -0.025345846743995686
Bond Position:  [-35.80373847]


portfolio before change:  [-38.33271445]
curr_Stock_Price:  99.42551739200233
curr_Factors:  [99.42551739]
mat_Sqrt:  [[0.15]]
grads:  [-0.02830457]
Stock Position:  -0.028304566662490094
Bond Position:  [-35.51851826]


portfolio before change:  [-38.31876522]
curr_Stock_Price:  98.61893472328718
curr_Factors:  [98.61893472]
mat_Sqrt:  [[0.15]]
grads:  [0.03362086]
Stock Position:  0.03362086041327242
Bond Position:  [-41.63441865]


portfolio before change:  [-38.32798874]
curr_Stock_Price:  98.65422175877477
curr_Factors:  [98.65422176]
mat_Sqrt:  [[0.15]]
grads:  [-0.00568803]
Stock Position:  -0.005688025431771506
Bond Position:  [-37.76684102]


portfolio before change:  [-38.335818]
curr_Stock_Price:  98.37053230861547
curr_Factors:  [98.37053231]
mat_Sqrt:  [[0.15]]
grads:  [0.05251739]
Stock Position:  0.05251739329334905
Bond Position:  [-43.50198193]


portfolio before change:  [-38.4245832]
curr_Stock_Price:  96.887436117071
curr_Factors:  [96.88743612]
mat_Sqrt:  [[0.15]]
grads:  [0.13195629]
Stock Position:  0.13195629209700616
Bond Position:  [-51.20949002]


portfolio before change:  [-38.42439991]
curr_Stock_Price:  96.98585709704146
curr_Factors:  [96.9858571]
mat_Sqrt:  [[0.15]]
grads:  [0.04680603]
Stock Position:  0.04680602635853929
Bond Position:  [-42.96392249]


portfolio before change:  [-38.46228738]
curr_Stock_Price:  96.40590712577294
curr_Factors:  [96.40590713]
mat_Sqrt:  [[0.15]]
grads:  [0.0042413]
Stock Position:  0.004241301436230712
Bond Position:  [-38.87117389]


portfolio before change:  [-38.46717073]
curr_Stock_Price:  97.54604230254675
curr_Factors:  [97.5460423]
mat_Sqrt:  [[0.15]]
grads:  [-0.03212001]
Stock Position:  -0.03212000752577267
Bond Position:  [-35.33399112]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-38.39604927]
Stock Price:  95.05675058625687
PL:  [-38.39604927]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 3.29559817e-04]
 [-9.46152326e-04]
 [-4.64317969e-03]
 [-1.11069701e-02]
 [ 6.36303906e-03]
 [-9.91511757e-03]
 [ 1.38345588e-02]
 [-1.54525593e-02]
 [-1.82098305e-02]
 [ 5.20779339e-03]
 [-2.94472447e-03]
 [-4.63365489e-03]
 [ 6.35724206e-03]
 [-2.77651662e-05]
 [ 3.78854752e-04]
 [ 2.29992436e-02]
 [ 3.75135684e-03]
 [ 1.35239718e-02]
 [-9.95596263e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-45.38231723]
curr_Stock_Price:  97.86843923173072
curr_Factors:  [97.86843923]
mat_Sqrt:  [[0.15]]
grads:  [0.00219707]
Stock Position:  0.0021970654447598407
Bond Position:  [-45.5973406]


portfolio before change:  [-45.39453181]
curr_Stock_Price:  97.49802518358885
curr_Factors:  [97.49802518]
mat_Sqrt:  [[0.15]]
grads:  [-0.00630768]
Stock Position:  -0.0063076821724694435
Bond Position:  [-44.77954526]


portfolio before change:  [-45.42044904]
curr_Stock_Price:  99.83183678359639
curr_Factors:  [99.83183678]
mat_Sqrt:  [[0.15]]
grads:  [-0.03095453]
Stock Position:  -0.030954531265173144
Bond Position:  [-42.33020133]


portfolio before change:  [-45.44358969]
curr_Stock_Price:  100.23748899487761
curr_Factors:  [100.23748899]
mat_Sqrt:  [[0.15]]
grads:  [-0.07404647]
Stock Position:  -0.07404646720832454
Bond Position:  [-38.02135775]


portfolio before change:  [-45.42453352]
curr_Stock_Price:  99.85174879167043
curr_Factors:  [99.85174879]
mat_Sqrt:  [[0.15]]
grads:  [0.04242026]
Stock Position:  0.042420260408918796
Bond Position:  [-49.6602707]


portfolio before change:  [-45.43436109]
curr_Stock_Price:  99.91278208044095
curr_Factors:  [99.91278208]
mat_Sqrt:  [[0.15]]
grads:  [-0.06610078]
Stock Position:  -0.0661007837788903
Bond Position:  [-38.83004788]


portfolio before change:  [-45.37941128]
curr_Stock_Price:  98.93460100671656
curr_Factors:  [98.93460101]
mat_Sqrt:  [[0.15]]
grads:  [0.09223039]
Stock Position:  0.09223039184122105
Bond Position:  [-54.5041883]


portfolio before change:  [-45.33856686]
curr_Stock_Price:  99.52521080336308
curr_Factors:  [99.5252108]
mat_Sqrt:  [[0.15]]
grads:  [-0.10301706]
Stock Position:  -0.10301706219259125
Bond Position:  [-35.08577203]


portfolio before change:  [-45.52384891]
curr_Stock_Price:  101.23861158156596
curr_Factors:  [101.23861158]
mat_Sqrt:  [[0.15]]
grads:  [-0.12139887]
Stock Position:  -0.12139886997604717
Bond Position:  [-33.23359587]


portfolio before change:  [-45.38387076]
curr_Stock_Price:  100.01712094305927
curr_Factors:  [100.01712094]
mat_Sqrt:  [[0.15]]
grads:  [0.03471862]
Stock Position:  0.034718622583535454
Bond Position:  [-48.85632744]


portfolio before change:  [-45.3764689]
curr_Stock_Price:  100.58216269797245
curr_Factors:  [100.5821627]
mat_Sqrt:  [[0.15]]
grads:  [-0.0196315]
Stock Position:  -0.019631496449464797
Bond Position:  [-43.40189053]


portfolio before change:  [-45.37871401]
curr_Stock_Price:  100.14374858937741
curr_Factors:  [100.14374859]
mat_Sqrt:  [[0.15]]
grads:  [-0.03089103]
Stock Position:  -0.03089103259384004
Bond Position:  [-42.2851702]


portfolio before change:  [-45.43100099]
curr_Stock_Price:  101.49412010343549
curr_Factors:  [101.4941201]
mat_Sqrt:  [[0.15]]
grads:  [0.04238161]
Stock Position:  0.042381613704359805
Bond Position:  [-49.73248558]


portfolio before change:  [-45.46333502]
curr_Stock_Price:  101.0245922157436
curr_Factors:  [101.02459222]
mat_Sqrt:  [[0.15]]
grads:  [-0.0001851]
Stock Position:  -0.00018510110814161317
Bond Position:  [-45.44463525]


portfolio before change:  [-45.47479993]
curr_Stock_Price:  101.5774427019807
curr_Factors:  [101.5774427]
mat_Sqrt:  [[0.15]]
grads:  [0.0025257]
Stock Position:  0.0025256983440892673
Bond Position:  [-45.73135391]


portfolio before change:  [-45.48332106]
curr_Stock_Price:  102.73084127001313
curr_Factors:  [102.73084127]
mat_Sqrt:  [[0.15]]
grads:  [0.15332829]
Stock Position:  0.15332829052862598
Bond Position:  [-61.23486534]


portfolio before change:  [-45.30402886]
curr_Stock_Price:  104.00003191292326
curr_Factors:  [104.00003191]
mat_Sqrt:  [[0.15]]
grads:  [0.02500905]
Stock Position:  0.02500904557900256
Bond Position:  [-47.9049704]


portfolio before change:  [-45.30159876]
curr_Stock_Price:  104.57613695121783
curr_Factors:  [104.57613695]
mat_Sqrt:  [[0.15]]
grads:  [0.09015981]
Stock Position:  0.09015981231815048
Bond Position:  [-54.73016364]


portfolio before change:  [-45.47501719]
curr_Stock_Price:  102.80445871580919
curr_Factors:  [102.80445872]
mat_Sqrt:  [[0.15]]
grads:  [-0.06637308]
Stock Position:  -0.06637308418749387
Bond Position:  [-38.6515682]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-45.56402534]
Stock Price:  103.9998838637638
PL:  [-49.56390921]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.51983998e-03]
 [-4.27936987e-03]
 [-1.11808653e-02]
 [ 1.09718388e-02]
 [-8.69774066e-03]
 [-1.22736307e-02]
 [ 1.49053809e-02]
 [-8.58078879e-02]
 [ 8.36631943e-03]
 [ 1.77626130e-03]
 [-2.38938987e-02]
 [ 5.04635404e-02]
 [ 1.51841286e-02]
 [-3.72216040e-03]
 [ 3.21437244e-03]
 [ 2.49868873e-02]
 [ 2.18342073e-02]
 [-9.26855588e-04]
 [-1.20322022e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.79925158]
curr_Stock_Price:  99.2560510416221
curr_Factors:  [99.25605104]
mat_Sqrt:  [[0.15]]
grads:  [0.01679893]
Stock Position:  0.01679893319504479
Bond Position:  [-16.46664735]


portfolio before change:  [-14.80936204]
curr_Stock_Price:  98.89928497871563
curr_Factors:  [98.89928498]
mat_Sqrt:  [[0.15]]
grads:  [-0.02852913]
Stock Position:  -0.028529132439473866
Bond Position:  [-11.98785124]


portfolio before change:  [-14.77321972]
curr_Stock_Price:  97.5273657714267
curr_Factors:  [97.52736577]
mat_Sqrt:  [[0.15]]
grads:  [-0.0745391]
Stock Position:  -0.07453910167106767
Bond Position:  [-7.50361748]


portfolio before change:  [-14.72529326]
curr_Stock_Price:  96.85922527898157
curr_Factors:  [96.85922528]
mat_Sqrt:  [[0.15]]
grads:  [0.07314559]
Stock Position:  0.07314559183450145
Bond Position:  [-21.81011862]


portfolio before change:  [-14.81377991]
curr_Stock_Price:  95.72404494779315
curr_Factors:  [95.72404495]
mat_Sqrt:  [[0.15]]
grads:  [-0.05798494]
Stock Position:  -0.0579849377181231
Bond Position:  [-9.26322713]


portfolio before change:  [-14.70403501]
curr_Stock_Price:  93.7914569709905
curr_Factors:  [93.79145697]
mat_Sqrt:  [[0.15]]
grads:  [-0.0818242]
Stock Position:  -0.08182420488885085
Bond Position:  [-7.02962362]


portfolio before change:  [-14.6407984]
curr_Stock_Price:  92.99714142979805
curr_Factors:  [92.99714143]
mat_Sqrt:  [[0.15]]
grads:  [0.09936921]
Stock Position:  0.09936920610751648
Bond Position:  [-23.88185052]


portfolio before change:  [-14.79910588]
curr_Stock_Price:  91.46410847204525
curr_Factors:  [91.46410847]
mat_Sqrt:  [[0.15]]
grads:  [-0.57205259]
Stock Position:  -0.5720525857541553
Bond Position:  [37.52317388]


portfolio before change:  [-15.57084719]
curr_Stock_Price:  92.82958306645473
curr_Factors:  [92.82958307]
mat_Sqrt:  [[0.15]]
grads:  [0.05577546]
Stock Position:  0.0557754628788662
Bond Position:  [-20.74846015]


portfolio before change:  [-15.60246931]
curr_Stock_Price:  92.35564051509184
curr_Factors:  [92.35564052]
mat_Sqrt:  [[0.15]]
grads:  [0.01184174]
Stock Position:  0.011841742020411758
Bond Position:  [-16.69612098]


portfolio before change:  [-15.62739354]
curr_Stock_Price:  90.6033922071264
curr_Factors:  [90.60339221]
mat_Sqrt:  [[0.15]]
grads:  [-0.15929266]
Stock Position:  -0.15929265822264072
Bond Position:  [-1.19493835]


portfolio before change:  [-15.24530431]
curr_Stock_Price:  88.20285471191632
curr_Factors:  [88.20285471]
mat_Sqrt:  [[0.15]]
grads:  [0.3364236]
Stock Position:  0.3364236023974934
Bond Position:  [-44.91882644]


portfolio before change:  [-16.10345497]
curr_Stock_Price:  85.68543459997629
curr_Factors:  [85.6854346]
mat_Sqrt:  [[0.15]]
grads:  [0.10122752]
Stock Position:  0.10122752366801512
Bond Position:  [-24.77717932]


portfolio before change:  [-16.08209205]
curr_Stock_Price:  85.95767270581408
curr_Factors:  [85.95767271]
mat_Sqrt:  [[0.15]]
grads:  [-0.0248144]
Stock Position:  -0.024814402640499264
Bond Position:  [-13.94910375]


portfolio before change:  [-16.07302449]
curr_Stock_Price:  85.45170585783556
curr_Factors:  [85.45170586]
mat_Sqrt:  [[0.15]]
grads:  [0.02142915]
Stock Position:  0.02142914958410985
Bond Position:  [-17.90418188]


portfolio before change:  [-16.03945535]
curr_Stock_Price:  87.22712615511975
curr_Factors:  [87.22712616]
mat_Sqrt:  [[0.15]]
grads:  [0.16657925]
Stock Position:  0.16657924843119798
Bond Position:  [-30.56968447]


portfolio before change:  [-15.80300133]
curr_Stock_Price:  88.69247910153759
curr_Factors:  [88.6924791]
mat_Sqrt:  [[0.15]]
grads:  [0.14556138]
Stock Position:  0.14556138232871535
Bond Position:  [-28.71320119]


portfolio before change:  [-15.49688033]
curr_Stock_Price:  90.84483707489551
curr_Factors:  [90.84483707]
mat_Sqrt:  [[0.15]]
grads:  [-0.00617904]
Stock Position:  -0.0061790372540475895
Bond Position:  [-14.9355467]


portfolio before change:  [-15.49406469]
curr_Stock_Price:  89.78480172309996
curr_Factors:  [89.78480172]
mat_Sqrt:  [[0.15]]
grads:  [-0.08021468]
Stock Position:  -0.08021468162864445
Bond Position:  [-8.2920054]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.52632584]
Stock Price:  90.16114051208268
PL:  [-15.52632584]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 1.43560055e-04]
 [-8.78808698e-04]
 [-1.37608042e-02]
 [ 1.11250838e-02]
 [ 5.99749978e-03]
 [-9.37436060e-03]
 [ 2.07455941e-04]
 [ 6.28625384e-04]
 [ 2.83931802e-02]
 [-2.18255426e-03]
 [-4.03816865e-03]
 [ 3.48502659e-02]
 [ 1.65849137e-02]
 [-4.66073558e-03]
 [ 2.18936720e-02]
 [ 2.00859849e-02]
 [ 7.79801920e-03]
 [ 1.46685771e-02]
 [-1.58758094e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-28.61662496]
curr_Stock_Price:  98.62913055219633
curr_Factors:  [98.62913055]
mat_Sqrt:  [[0.15]]
grads:  [0.00095707]
Stock Position:  0.0009570670347353386
Bond Position:  [-28.71101965]


portfolio before change:  [-28.62463696]
curr_Stock_Price:  97.75839513068985
curr_Factors:  [97.75839513]
mat_Sqrt:  [[0.15]]
grads:  [-0.00585872]
Stock Position:  -0.005858724652914681
Bond Position:  [-28.05189745]


portfolio before change:  [-28.62584218]
curr_Stock_Price:  96.76694392536864
curr_Factors:  [96.76694393]
mat_Sqrt:  [[0.15]]
grads:  [-0.09173869]
Stock Position:  -0.09173869448865021
Bond Position:  [-19.74856907]


portfolio before change:  [-28.63843865]
curr_Stock_Price:  96.85042794036131
curr_Factors:  [96.85042794]
mat_Sqrt:  [[0.15]]
grads:  [0.07416723]
Stock Position:  0.07416722548382042
Bond Position:  [-35.82156618]


portfolio before change:  [-28.4574908]
curr_Stock_Price:  99.41091686311005
curr_Factors:  [99.41091686]
mat_Sqrt:  [[0.15]]
grads:  [0.03998333]
Stock Position:  0.039983331843181036
Bond Position:  [-32.43227048]


portfolio before change:  [-28.39535064]
curr_Stock_Price:  101.1678801165407
curr_Factors:  [101.16788012]
mat_Sqrt:  [[0.15]]
grads:  [-0.06249574]
Stock Position:  -0.06249573730236794
Bond Position:  [-22.07278938]


portfolio before change:  [-28.45454077]
curr_Stock_Price:  102.02667862232154
curr_Factors:  [102.02667862]
mat_Sqrt:  [[0.15]]
grads:  [0.00138304]
Stock Position:  0.0013830396078348163
Bond Position:  [-28.59564771]


portfolio before change:  [-28.45906619]
curr_Stock_Price:  103.92422569134872
curr_Factors:  [103.92422569]
mat_Sqrt:  [[0.15]]
grads:  [0.00419084]
Stock Position:  0.004190835893908562
Bond Position:  [-28.89459557]


portfolio before change:  [-28.45713457]
curr_Stock_Price:  106.1090343016427
curr_Factors:  [106.1090343]
mat_Sqrt:  [[0.15]]
grads:  [0.18928787]
Stock Position:  0.18928786824317864
Bond Position:  [-48.54228748]


portfolio before change:  [-28.49066214]
curr_Stock_Price:  105.9960292893559
curr_Factors:  [105.99602929]
mat_Sqrt:  [[0.15]]
grads:  [-0.01455036]
Stock Position:  -0.014550361714332142
Bond Position:  [-26.94838157]


portfolio before change:  [-28.50476405]
curr_Stock_Price:  106.50213177217525
curr_Factors:  [106.50213177]
mat_Sqrt:  [[0.15]]
grads:  [-0.02692112]
Stock Position:  -0.026921124365691697
Bond Position:  [-25.63760692]


portfolio before change:  [-28.58013869]
curr_Stock_Price:  109.06385380078416
curr_Factors:  [109.0638538]
mat_Sqrt:  [[0.15]]
grads:  [0.23233511]
Stock Position:  0.23233510628321755
Bond Position:  [-53.91950076]


portfolio before change:  [-28.72175414]
curr_Stock_Price:  108.51234914150199
curr_Factors:  [108.51234914]
mat_Sqrt:  [[0.15]]
grads:  [0.11056609]
Stock Position:  0.11056609115915404
Bond Position:  [-40.71954043]


portfolio before change:  [-28.90521906]
curr_Stock_Price:  106.94510769211362
curr_Factors:  [106.94510769]
mat_Sqrt:  [[0.15]]
grads:  [-0.03107157]
Stock Position:  -0.03107157051416424
Bond Position:  [-25.58226661]


portfolio before change:  [-28.93694102]
curr_Stock_Price:  107.76018041421298
curr_Factors:  [107.76018041]
mat_Sqrt:  [[0.15]]
grads:  [0.14595781]
Stock Position:  0.14595781319909487
Bond Position:  [-44.6653813]


portfolio before change:  [-29.08028386]
curr_Stock_Price:  106.85460981722979
curr_Factors:  [106.85460982]
mat_Sqrt:  [[0.15]]
grads:  [0.13390657]
Stock Position:  0.13390656567465592
Bond Position:  [-43.38881769]


portfolio before change:  [-29.19960445]
curr_Stock_Price:  106.04455224105685
curr_Factors:  [106.04455224]
mat_Sqrt:  [[0.15]]
grads:  [0.05198679]
Stock Position:  0.05198679466723986
Bond Position:  [-34.71252082]


portfolio before change:  [-29.17559388]
curr_Stock_Price:  106.67336171998664
curr_Factors:  [106.67336172]
mat_Sqrt:  [[0.15]]
grads:  [0.09779051]
Stock Position:  0.09779051429630944
Bond Position:  [-39.60723678]


portfolio before change:  [-29.26084897]
curr_Stock_Price:  105.90281620750538
curr_Factors:  [105.90281621]
mat_Sqrt:  [[0.15]]
grads:  [-0.10583873]
Stock Position:  -0.10583872912125404
Bond Position:  [-18.05222949]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-29.17374005]
Stock Price:  105.03713558254914
PL:  [-34.21087563]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 1.57124152e-03]
 [-6.68982847e-03]
 [-1.38316597e-02]
 [ 1.41131407e-02]
 [-6.52787412e-03]
 [-1.08847165e-02]
 [ 1.27091788e-02]
 [-4.42772428e-02]
 [-2.35651369e-03]
 [ 1.05973747e-02]
 [-1.21116595e-02]
 [ 2.50561184e-02]
 [ 9.46900860e-03]
 [-2.39063776e-03]
 [ 6.16564713e-03]
 [ 2.34715481e-02]
 [ 1.37008531e-02]
 [ 3.19072560e-04]
 [-9.76275043e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.36632476]
curr_Stock_Price:  99.04883425208712
curr_Factors:  [99.04883425]
mat_Sqrt:  [[0.15]]
grads:  [0.01047494]
Stock Position:  0.010474943479779909
Bond Position:  [-20.4038557]


portfolio before change:  [-19.36920039]
curr_Stock_Price:  99.26133823752512
curr_Factors:  [99.26133824]
mat_Sqrt:  [[0.15]]
grads:  [-0.04459886]
Stock Position:  -0.04459885647536254
Bond Position:  [-14.94225821]


portfolio before change:  [-19.26075787]
curr_Stock_Price:  96.74605967079593
curr_Factors:  [96.74605967]
mat_Sqrt:  [[0.15]]
grads:  [-0.09221106]
Stock Position:  -0.09221106476156017
Bond Position:  [-10.3397007]


portfolio before change:  [-19.2509186]
curr_Stock_Price:  96.61131966560306
curr_Factors:  [96.61131967]
mat_Sqrt:  [[0.15]]
grads:  [0.0940876]
Stock Position:  0.09408760462636032
Bond Position:  [-28.34084625]


portfolio before change:  [-19.28053786]
curr_Stock_Price:  96.37182843367731
curr_Factors:  [96.37182843]
mat_Sqrt:  [[0.15]]
grads:  [-0.04351916]
Stock Position:  -0.043519160795403806
Bond Position:  [-15.08651676]


portfolio before change:  [-19.34430566]
curr_Stock_Price:  97.75043266372722
curr_Factors:  [97.75043266]
mat_Sqrt:  [[0.15]]
grads:  [-0.07256478]
Stock Position:  -0.07256477650215377
Bond Position:  [-12.25106736]


portfolio before change:  [-19.3183477]
curr_Stock_Price:  97.35049890122735
curr_Factors:  [97.3504989]
mat_Sqrt:  [[0.15]]
grads:  [0.08472786]
Stock Position:  0.08472785849837008
Bond Position:  [-27.566647]


portfolio before change:  [-19.33745234]
curr_Stock_Price:  97.20636552298086
curr_Factors:  [97.20636552]
mat_Sqrt:  [[0.15]]
grads:  [-0.29518162]
Stock Position:  -0.2951816187585401
Bond Position:  [9.35607999]


portfolio before change:  [-19.76154589]
curr_Stock_Price:  98.65101125972457
curr_Factors:  [98.65101126]
mat_Sqrt:  [[0.15]]
grads:  [-0.01571009]
Stock Position:  -0.015710091240946543
Bond Position:  [-18.21172951]


portfolio before change:  [-19.76401787]
curr_Stock_Price:  98.51851494280866
curr_Factors:  [98.51851494]
mat_Sqrt:  [[0.15]]
grads:  [0.07064916]
Stock Position:  0.07064916478387104
Bond Position:  [-26.72426866]


portfolio before change:  [-20.00713753]
curr_Stock_Price:  95.17186875041854
curr_Factors:  [95.17186875]
mat_Sqrt:  [[0.15]]
grads:  [-0.0807444]
Stock Position:  -0.08074439656717787
Bond Position:  [-12.32254241]


portfolio before change:  [-19.86539681]
curr_Stock_Price:  93.3782862376028
curr_Factors:  [93.37828624]
mat_Sqrt:  [[0.15]]
grads:  [0.16704079]
Stock Position:  0.16704078917454845
Bond Position:  [-35.46337943]


portfolio before change:  [-20.22431321]
curr_Stock_Price:  91.28269357555536
curr_Factors:  [91.28269358]
mat_Sqrt:  [[0.15]]
grads:  [0.06312672]
Stock Position:  0.063126724010716
Bond Position:  [-25.98669062]


portfolio before change:  [-20.20217245]
curr_Stock_Price:  91.73635644580193
curr_Factors:  [91.73635645]
mat_Sqrt:  [[0.15]]
grads:  [-0.01593759]
Stock Position:  -0.01593758505012345
Bond Position:  [-18.74011647]


portfolio before change:  [-20.21308521]
curr_Stock_Price:  92.12707761240652
curr_Factors:  [92.12707761]
mat_Sqrt:  [[0.15]]
grads:  [0.04110431]
Stock Position:  0.04110431421355437
Bond Position:  [-23.99990556]


portfolio before change:  [-20.2498605]
curr_Stock_Price:  91.37838338550745
curr_Factors:  [91.37838339]
mat_Sqrt:  [[0.15]]
grads:  [0.15647699]
Stock Position:  0.15647698759274234
Bond Position:  [-34.54847467]


portfolio before change:  [-20.01604992]
curr_Stock_Price:  92.92780474608378
curr_Factors:  [92.92780475]
mat_Sqrt:  [[0.15]]
grads:  [0.09133902]
Stock Position:  0.09133902064836998
Bond Position:  [-28.50398459]


portfolio before change:  [-19.90145169]
curr_Stock_Price:  94.26047851854071
curr_Factors:  [94.26047852]
mat_Sqrt:  [[0.15]]
grads:  [0.00212715]
Stock Position:  0.0021271503968550596
Bond Position:  [-20.1019579]


portfolio before change:  [-19.9071895]
curr_Stock_Price:  93.92590117100458
curr_Factors:  [93.92590117]
mat_Sqrt:  [[0.15]]
grads:  [-0.065085]
Stock Position:  -0.06508500288761082
Bond Position:  [-13.79402195]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.86224173]
Stock Price:  93.18230885788053
PL:  [-19.86224173]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.72834151e-03]
 [-1.88774197e-03]
 [-5.81796437e-03]
 [-3.45880482e-03]
 [-1.03010257e-02]
 [-1.14203377e-02]
 [ 1.31998443e-02]
 [-4.41045627e-02]
 [ 1.40291428e-03]
 [ 9.02952315e-03]
 [-9.10675942e-03]
 [ 9.56217776e-03]
 [ 6.14541332e-03]
 [-1.45669682e-03]
 [ 8.07129007e-03]
 [ 2.13239466e-02]
 [ 9.40481217e-03]
 [ 3.43636014e-04]
 [-8.98857532e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.36660824]
curr_Stock_Price:  99.4117965936064
curr_Factors:  [99.41179659]
mat_Sqrt:  [[0.15]]
grads:  [0.01818894]
Stock Position:  0.018188943394733308
Bond Position:  [-13.17480378]


portfolio before change:  [-11.38612733]
curr_Stock_Price:  98.51977195811297
curr_Factors:  [98.51977196]
mat_Sqrt:  [[0.15]]
grads:  [-0.01258495]
Stock Position:  -0.012584946437424744
Bond Position:  [-10.14626128]


portfolio before change:  [-11.39400412]
curr_Stock_Price:  98.94408101219106
curr_Factors:  [98.94408101]
mat_Sqrt:  [[0.15]]
grads:  [-0.03878643]
Stock Position:  -0.03878642913841518
Bond Position:  [-7.55631654]


portfolio before change:  [-11.34716078]
curr_Stock_Price:  97.68764525294927
curr_Factors:  [97.68764525]
mat_Sqrt:  [[0.15]]
grads:  [-0.0230587]
Stock Position:  -0.02305869877060074
Bond Position:  [-9.0946108]


portfolio before change:  [-11.29311987]
curr_Stock_Price:  95.24540649756439
curr_Factors:  [95.2454065]
mat_Sqrt:  [[0.15]]
grads:  [-0.0686735]
Stock Position:  -0.06867350449780164
Bond Position:  [-4.75228402]


portfolio before change:  [-11.36110865]
curr_Stock_Price:  96.21813328348227
curr_Factors:  [96.21813328]
mat_Sqrt:  [[0.15]]
grads:  [-0.07613558]
Stock Position:  -0.0761355849145033
Bond Position:  [-4.03548479]


portfolio before change:  [-11.32974335]
curr_Stock_Price:  95.79291435542427
curr_Factors:  [95.79291436]
mat_Sqrt:  [[0.15]]
grads:  [0.08799896]
Stock Position:  0.08799896202577052
Bond Position:  [-19.75942039]


portfolio before change:  [-11.33983241]
curr_Stock_Price:  95.73440705223872
curr_Factors:  [95.73440705]
mat_Sqrt:  [[0.15]]
grads:  [-0.29403042]
Stock Position:  -0.29403041799787366
Bond Position:  [16.80899531]


portfolio before change:  [-11.65322327]
curr_Stock_Price:  96.81454577107478
curr_Factors:  [96.81454577]
mat_Sqrt:  [[0.15]]
grads:  [0.00935276]
Stock Position:  0.009352761897644304
Bond Position:  [-12.55870667]


portfolio before change:  [-11.6551768]
curr_Stock_Price:  96.94141079715727
curr_Factors:  [96.9414108]
mat_Sqrt:  [[0.15]]
grads:  [0.06019682]
Stock Position:  0.06019682102065755
Bond Position:  [-17.49074156]


portfolio before change:  [-11.69593385]
curr_Stock_Price:  96.3369966310215
curr_Factors:  [96.33699663]
mat_Sqrt:  [[0.15]]
grads:  [-0.06071173]
Stock Position:  -0.06071172949306265
Bond Position:  [-5.84714817]


portfolio before change:  [-11.70255511]
curr_Stock_Price:  96.42197673826608
curr_Factors:  [96.42197674]
mat_Sqrt:  [[0.15]]
grads:  [0.06374785]
Stock Position:  0.06374785173797688
Bond Position:  [-17.84924898]


portfolio before change:  [-11.70602118]
curr_Stock_Price:  96.43761334357181
curr_Factors:  [96.43761334]
mat_Sqrt:  [[0.15]]
grads:  [0.04096942]
Stock Position:  0.04096942215653984
Bond Position:  [-15.65701447]


portfolio before change:  [-11.73648577]
curr_Stock_Price:  95.78957276486426
curr_Factors:  [95.78957276]
mat_Sqrt:  [[0.15]]
grads:  [-0.00971131]
Stock Position:  -0.009711312158655849
Bond Position:  [-10.80624332]


portfolio before change:  [-11.74117467]
curr_Stock_Price:  95.99417991151128
curr_Factors:  [95.99417991]
mat_Sqrt:  [[0.15]]
grads:  [0.0538086]
Stock Position:  0.05380860049944818
Bond Position:  [-16.90648715]


portfolio before change:  [-11.76305098]
curr_Stock_Price:  95.66618099848874
curr_Factors:  [95.666181]
mat_Sqrt:  [[0.15]]
grads:  [0.14215964]
Stock Position:  0.14215964399561448
Bond Position:  [-25.36292122]


portfolio before change:  [-11.82458736]
curr_Stock_Price:  95.27792136902055
curr_Factors:  [95.27792137]
mat_Sqrt:  [[0.15]]
grads:  [0.06269875]
Stock Position:  0.06269874783308675
Bond Position:  [-17.79839372]


portfolio before change:  [-11.88241069]
curr_Stock_Price:  94.42665755659645
curr_Factors:  [94.42665756]
mat_Sqrt:  [[0.15]]
grads:  [0.00229091]
Stock Position:  0.0022909067599629724
Bond Position:  [-12.09873335]


portfolio before change:  [-11.88334669]
curr_Stock_Price:  95.33854897994078
curr_Factors:  [95.33854898]
mat_Sqrt:  [[0.15]]
grads:  [-0.05992384]
Stock Position:  -0.0599238354748738
Bond Position:  [-6.17029517]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.95340494]
Stock Price:  96.48192515311635
PL:  [-11.95340494]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.01149287e-02]
 [-8.84323400e-03]
 [-4.17690646e-03]
 [-1.62911330e-02]
 [ 1.44814038e-04]
 [-1.07908039e-02]
 [ 1.39034811e-02]
 [-2.62271777e-02]
 [-4.16297334e-04]
 [ 7.73690452e-03]
 [-6.93690637e-03]
 [ 2.69751387e-03]
 [ 5.20844449e-03]
 [-6.07462515e-04]
 [ 7.78174473e-03]
 [ 1.74420113e-02]
 [ 3.76906625e-03]
 [ 7.90674605e-03]
 [-6.35748399e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.14544064]
curr_Stock_Price:  100.52395483501044
curr_Factors:  [100.52395484]
mat_Sqrt:  [[0.15]]
grads:  [-0.06743286]
Stock Position:  -0.06743285784224354
Bond Position:  [19.9240582]


portfolio before change:  [13.21855056]
curr_Stock_Price:  99.5136421084899
curr_Factors:  [99.51364211]
mat_Sqrt:  [[0.15]]
grads:  [-0.05895489]
Stock Position:  -0.058954893365564996
Bond Position:  [19.08536672]


portfolio before change:  [13.21961667]
curr_Stock_Price:  99.57650074567468
curr_Factors:  [99.57650075]
mat_Sqrt:  [[0.15]]
grads:  [-0.02784604]
Stock Position:  -0.027846043056403248
Bond Position:  [15.9924282]


portfolio before change:  [13.24152977]
curr_Stock_Price:  98.93316023038875
curr_Factors:  [98.93316023]
mat_Sqrt:  [[0.15]]
grads:  [-0.10860755]
Stock Position:  -0.10860755343288855
Bond Position:  [23.98641825]


portfolio before change:  [13.33249015]
curr_Stock_Price:  98.15086626266248
curr_Factors:  [98.15086626]
mat_Sqrt:  [[0.15]]
grads:  [0.00096543]
Stock Position:  0.0009654269183656644
Bond Position:  [13.23773266]


portfolio before change:  [13.3357892]
curr_Stock_Price:  98.13968092859109
curr_Factors:  [98.13968093]
mat_Sqrt:  [[0.15]]
grads:  [-0.07193869]
Stock Position:  -0.07193869241130847
Bond Position:  [20.39582952]


portfolio before change:  [13.27914167]
curr_Stock_Price:  98.99801072773994
curr_Factors:  [98.99801073]
mat_Sqrt:  [[0.15]]
grads:  [0.09268987]
Stock Position:  0.09268987412968703
Bond Position:  [4.10302852]


portfolio before change:  [13.26861334]
curr_Stock_Price:  98.87335615580297
curr_Factors:  [98.87335616]
mat_Sqrt:  [[0.15]]
grads:  [-0.17484785]
Stock Position:  -0.17484785112723436
Bond Position:  [30.5564072]


portfolio before change:  [13.12227428]
curr_Stock_Price:  99.75400245818687
curr_Factors:  [99.75400246]
mat_Sqrt:  [[0.15]]
grads:  [-0.00277532]
Stock Position:  -0.0027753155584911817
Bond Position:  [13.39912312]


portfolio before change:  [13.12620155]
curr_Stock_Price:  99.54607596229384
curr_Factors:  [99.54607596]
mat_Sqrt:  [[0.15]]
grads:  [0.05157936]
Stock Position:  0.051579363456181804
Bond Position:  [7.99167831]


portfolio before change:  [13.0076575]
curr_Stock_Price:  97.20905182827411
curr_Factors:  [97.20905183]
mat_Sqrt:  [[0.15]]
grads:  [-0.04624604]
Stock Position:  -0.04624604246804098
Bond Position:  [17.50319144]


portfolio before change:  [12.98447325]
curr_Stock_Price:  97.805007612511
curr_Factors:  [97.80500761]
mat_Sqrt:  [[0.15]]
grads:  [0.01798343]
Stock Position:  0.017983425783858316
Bond Position:  [11.22560415]


portfolio before change:  [12.99693064]
curr_Stock_Price:  98.34164823426282
curr_Factors:  [98.34164823]
mat_Sqrt:  [[0.15]]
grads:  [0.03472296]
Stock Position:  0.03472296328463712
Bond Position:  [9.58221719]


portfolio before change:  [13.04181873]
curr_Stock_Price:  99.56539856016938
curr_Factors:  [99.56539856]
mat_Sqrt:  [[0.15]]
grads:  [-0.00404975]
Stock Position:  -0.004049750099243039
Bond Position:  [13.44503371]


portfolio before change:  [13.04905404]
curr_Stock_Price:  98.60888740199748
curr_Factors:  [98.6088874]
mat_Sqrt:  [[0.15]]
grads:  [0.0518783]
Stock Position:  0.05187829821352991
Bond Position:  [7.93339277]


portfolio before change:  [13.04181852]
curr_Stock_Price:  98.4311808957729
curr_Factors:  [98.4311809]
mat_Sqrt:  [[0.15]]
grads:  [0.11628008]
Stock Position:  0.11628007500570635
Bond Position:  [1.59623342]


portfolio before change:  [13.27908471]
curr_Stock_Price:  100.46822021628012
curr_Factors:  [100.46822022]
mat_Sqrt:  [[0.15]]
grads:  [0.02512711]
Stock Position:  0.02512710834255625
Bond Position:  [10.75460886]


portfolio before change:  [13.25869562]
curr_Stock_Price:  99.54976660096118
curr_Factors:  [99.5497666]
mat_Sqrt:  [[0.15]]
grads:  [0.05271164]
Stock Position:  0.05271164030604543
Bond Position:  [8.01126413]


portfolio before change:  [13.37276952]
curr_Stock_Price:  101.67587830705534
curr_Factors:  [101.67587831]
mat_Sqrt:  [[0.15]]
grads:  [-0.04238323]
Stock Position:  -0.04238322660650113
Bond Position:  [17.68212131]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.47554374]
Stock Price:  99.35531080383257
PL:  [13.47554374]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.80213236e-04]
 [-8.24644852e-04]
 [-9.25411735e-03]
 [-7.49004003e-03]
 [-7.79673780e-04]
 [-1.08616874e-02]
 [ 1.37149144e-02]
 [-2.36149150e-02]
 [-1.70419041e-03]
 [ 9.02731176e-03]
 [-3.07924401e-03]
 [-5.39097065e-03]
 [ 4.92735757e-03]
 [ 8.71779393e-05]
 [ 2.56696531e-03]
 [ 1.68564601e-02]
 [ 4.92023524e-03]
 [ 7.09125256e-03]
 [-4.55176948e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-29.2194809]
curr_Stock_Price:  98.60177783251528
curr_Factors:  [98.60177783]
mat_Sqrt:  [[0.15]]
grads:  [0.00186809]
Stock Position:  0.0018680882369093734
Bond Position:  [-29.40367772]


portfolio before change:  [-29.22801705]
curr_Stock_Price:  97.96780822715665
curr_Factors:  [97.96780823]
mat_Sqrt:  [[0.15]]
grads:  [-0.00549763]
Stock Position:  -0.005497632347912427
Bond Position:  [-28.68942606]


portfolio before change:  [-29.235891]
curr_Stock_Price:  98.09526340042088
curr_Factors:  [98.0952634]
mat_Sqrt:  [[0.15]]
grads:  [-0.06169412]
Stock Position:  -0.061694115652577375
Bond Position:  [-23.18399048]


portfolio before change:  [-29.23081741]
curr_Stock_Price:  97.91906637769273
curr_Factors:  [97.91906638]
mat_Sqrt:  [[0.15]]
grads:  [-0.0499336]
Stock Position:  -0.049933600193305776
Bond Position:  [-24.3413659]


portfolio before change:  [-29.237968]
curr_Stock_Price:  97.94038444521308
curr_Factors:  [97.94038445]
mat_Sqrt:  [[0.15]]
grads:  [-0.00519783]
Stock Position:  -0.0051978252001733585
Bond Position:  [-28.728891]


portfolio before change:  [-29.24465992]
curr_Stock_Price:  97.84588329930432
curr_Factors:  [97.8458833]
mat_Sqrt:  [[0.15]]
grads:  [-0.07241125]
Stock Position:  -0.07241124948664662
Bond Position:  [-22.15951725]


portfolio before change:  [-29.3120236]
curr_Stock_Price:  98.69966104308033
curr_Factors:  [98.69966104]
mat_Sqrt:  [[0.15]]
grads:  [0.09143276]
Stock Position:  0.0914327626314751
Bond Position:  [-38.33640628]


portfolio before change:  [-29.28998565]
curr_Stock_Price:  99.0455245425201
curr_Factors:  [99.04552454]
mat_Sqrt:  [[0.15]]
grads:  [-0.15743277]
Stock Position:  -0.15743276688812302
Bond Position:  [-13.69697467]


portfolio before change:  [-29.17094899]
curr_Stock_Price:  98.26766026619573
curr_Factors:  [98.26766027]
mat_Sqrt:  [[0.15]]
grads:  [-0.01136127]
Stock Position:  -0.011361269432383648
Bond Position:  [-28.05450363]


portfolio before change:  [-29.18900747]
curr_Stock_Price:  99.23973236382828
curr_Factors:  [99.23973236]
mat_Sqrt:  [[0.15]]
grads:  [0.06018208]
Stock Position:  0.06018207836825896
Bond Position:  [-35.16146082]


portfolio before change:  [-29.17145683]
curr_Stock_Price:  99.6774390987837
curr_Factors:  [99.6774391]
mat_Sqrt:  [[0.15]]
grads:  [-0.02052829]
Stock Position:  -0.020528293416210954
Bond Position:  [-27.12524912]


portfolio before change:  [-29.19866539]
curr_Stock_Price:  100.67247564022465
curr_Factors:  [100.67247564]
mat_Sqrt:  [[0.15]]
grads:  [-0.0359398]
Stock Position:  -0.035939804347140704
Bond Position:  [-25.58051632]


portfolio before change:  [-29.20158538]
curr_Stock_Price:  100.57575999391871
curr_Factors:  [100.57575999]
mat_Sqrt:  [[0.15]]
grads:  [0.03284905]
Stock Position:  0.03284905047856793
Bond Position:  [-32.5054036]


portfolio before change:  [-29.18606305]
curr_Stock_Price:  101.29571080093473
curr_Factors:  [101.2957108]
mat_Sqrt:  [[0.15]]
grads:  [0.00058119]
Stock Position:  0.0005811862621464533
Bond Position:  [-29.24493472]


portfolio before change:  [-29.19380624]
curr_Stock_Price:  100.55403911199427
curr_Factors:  [100.55403911]
mat_Sqrt:  [[0.15]]
grads:  [0.0171131]
Stock Position:  0.01711310207699906
Bond Position:  [-30.91459778]


portfolio before change:  [-29.21630053]
curr_Stock_Price:  99.69126939597739
curr_Factors:  [99.6912694]
mat_Sqrt:  [[0.15]]
grads:  [0.1123764]
Stock Position:  0.1123764003880295
Bond Position:  [-40.41924653]


portfolio before change:  [-29.25695222]
curr_Stock_Price:  99.41945418608915
curr_Factors:  [99.41945419]
mat_Sqrt:  [[0.15]]
grads:  [0.03280157]
Stock Position:  0.032801568295105304
Bond Position:  [-32.51806623]


portfolio before change:  [-29.27007376]
curr_Stock_Price:  99.2672963907471
curr_Factors:  [99.26729639]
mat_Sqrt:  [[0.15]]
grads:  [0.04727502]
Stock Position:  0.04727501707952129
Bond Position:  [-33.9629369]


portfolio before change:  [-29.27219433]
curr_Stock_Price:  99.4020658934057
curr_Factors:  [99.40206589]
mat_Sqrt:  [[0.15]]
grads:  [-0.03034513]
Stock Position:  -0.030345129862374445
Bond Position:  [-26.25582573]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-29.30472466]
Stock Price:  100.25774047403314
PL:  [-29.56246514]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.79496069e-02]
 [ 2.20267696e-02]
 [-3.00354612e-02]
 [ 8.61445583e-03]
 [ 6.46634367e-03]
 [-9.89648198e-03]
 [ 1.38208560e-02]
 [ 1.50194343e-02]
 [-1.97091225e-02]
 [ 2.17003866e-03]
 [-2.93709915e-03]
 [-4.45358442e-03]
 [ 4.82474590e-03]
 [-1.14301016e-03]
 [ 8.08785096e-03]
 [ 1.91343233e-02]
 [ 5.30147646e-03]
 [ 4.22689970e-03]
 [-4.16584263e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [27.50527495]
curr_Stock_Price:  101.17548780730425
curr_Factors:  [101.17548781]
mat_Sqrt:  [[0.15]]
grads:  [-0.11966405]
Stock Position:  -0.11966404626131319
Bond Position:  [39.6123432]


portfolio before change:  [27.47502837]
curr_Stock_Price:  101.51101801381333
curr_Factors:  [101.51101801]
mat_Sqrt:  [[0.15]]
grads:  [0.14684513]
Stock Position:  0.14684513074780253
Bond Position:  [12.56862966]


portfolio before change:  [27.5341755]
curr_Stock_Price:  101.89240337702466
curr_Factors:  [101.89240338]
mat_Sqrt:  [[0.15]]
grads:  [-0.20023641]
Stock Position:  -0.2002364080314383
Bond Position:  [47.93674436]


portfolio before change:  [27.7235717]
curr_Stock_Price:  101.00639811138097
curr_Factors:  [101.00639811]
mat_Sqrt:  [[0.15]]
grads:  [0.05742971]
Stock Position:  0.057429705513021304
Bond Position:  [21.922804]


portfolio before change:  [27.67078119]
curr_Stock_Price:  99.9917333996426
curr_Factors:  [99.9917334]
mat_Sqrt:  [[0.15]]
grads:  [0.04310896]
Stock Position:  0.04310895782722437
Bond Position:  [23.36024177]


portfolio before change:  [27.67702302]
curr_Stock_Price:  100.00103644363249
curr_Factors:  [100.00103644]
mat_Sqrt:  [[0.15]]
grads:  [-0.06597655]
Stock Position:  -0.06597654652806949
Bond Position:  [34.27474606]


portfolio before change:  [27.68536911]
curr_Stock_Price:  100.00442657648522
curr_Factors:  [100.00442658]
mat_Sqrt:  [[0.15]]
grads:  [0.09213904]
Stock Position:  0.09213903987755143
Bond Position:  [18.47105726]


portfolio before change:  [27.77801354]
curr_Stock_Price:  100.95978798522317
curr_Factors:  [100.95978799]
mat_Sqrt:  [[0.15]]
grads:  [0.10012956]
Stock Position:  0.10012956225237701
Bond Position:  [17.66895416]


portfolio before change:  [27.85303417]
curr_Stock_Price:  101.66490280091638
curr_Factors:  [101.6649028]
mat_Sqrt:  [[0.15]]
grads:  [-0.13139415]
Stock Position:  -0.13139414981400557
Bond Position:  [41.21120764]


portfolio before change:  [27.85317493]
curr_Stock_Price:  101.74225270093449
curr_Factors:  [101.7422527]
mat_Sqrt:  [[0.15]]
grads:  [0.01446692]
Stock Position:  0.01446692437377649
Bond Position:  [26.38127746]


portfolio before change:  [27.8356062]
curr_Stock_Price:  100.07189959767634
curr_Factors:  [100.0718996]
mat_Sqrt:  [[0.15]]
grads:  [-0.01958066]
Stock Position:  -0.019580660994074867
Bond Position:  [29.79508014]


portfolio before change:  [27.84785091]
curr_Stock_Price:  99.82701460550632
curr_Factors:  [99.82701461]
mat_Sqrt:  [[0.15]]
grads:  [-0.02969056]
Stock Position:  -0.029690562786015152
Bond Position:  [30.81177116]


portfolio before change:  [27.8596494]
curr_Stock_Price:  99.68910616920833
curr_Factors:  [99.68910617]
mat_Sqrt:  [[0.15]]
grads:  [0.03216497]
Stock Position:  0.032164972651173594
Bond Position:  [24.65315203]


portfolio before change:  [27.78656334]
curr_Stock_Price:  97.22524233823256
curr_Factors:  [97.22524234]
mat_Sqrt:  [[0.15]]
grads:  [-0.00762007]
Stock Position:  -0.007620067733860839
Bond Position:  [28.52742628]


portfolio before change:  [27.79059886]
curr_Stock_Price:  97.63170039159965
curr_Factors:  [97.63170039]
mat_Sqrt:  [[0.15]]
grads:  [0.05391901]
Stock Position:  0.053919006369752186
Bond Position:  [22.52639458]


portfolio before change:  [27.77743172]
curr_Stock_Price:  97.28303972298968
curr_Factors:  [97.28303972]
mat_Sqrt:  [[0.15]]
grads:  [0.12756216]
Stock Position:  0.12756215530086892
Bond Position:  [15.3677975]


portfolio before change:  [28.00443496]
curr_Stock_Price:  99.03246771003494
curr_Factors:  [99.03246771]
mat_Sqrt:  [[0.15]]
grads:  [0.03534318]
Stock Position:  0.035343176393989297
Bond Position:  [24.50431298]


portfolio before change:  [27.97984401]
curr_Stock_Price:  98.16333849968778
curr_Factors:  [98.1633385]
mat_Sqrt:  [[0.15]]
grads:  [0.02817933]
Stock Position:  0.02817933133692803
Bond Position:  [25.21366677]


portfolio before change:  [27.9993967]
curr_Stock_Price:  98.6334874970677
curr_Factors:  [98.6334875]
mat_Sqrt:  [[0.15]]
grads:  [-0.02777228]
Stock Position:  -0.02777228418981121
Bond Position:  [30.73867395]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [27.99727358]
Stock Price:  98.98667224727764
PL:  [27.99727358]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-7.81680179e-03]
 [ 2.73492252e-02]
 [-3.63628039e-02]
 [ 3.45805772e-02]
 [ 5.68379287e-03]
 [-1.31641019e-02]
 [-6.23604210e-03]
 [ 3.33468796e-03]
 [-6.77450342e-03]
 [ 1.22090404e-03]
 [-3.32158128e-03]
 [-2.45016869e-03]
 [ 6.85258806e-03]
 [-9.13035337e-04]
 [ 1.82703730e-02]
 [ 2.14633704e-02]
 [ 6.63075657e-03]
 [ 1.24897791e-02]
 [-9.82735892e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.83716535]
curr_Stock_Price:  100.41922399813237
curr_Factors:  [100.419224]
mat_Sqrt:  [[0.15]]
grads:  [-0.05211201]
Stock Position:  -0.05211201191936456
Bond Position:  [16.07021315]


portfolio before change:  [10.77048549]
curr_Stock_Price:  101.77587689424013
curr_Factors:  [101.77587689]
mat_Sqrt:  [[0.15]]
grads:  [0.18232817]
Stock Position:  0.18232816822703352
Bond Position:  [-7.78612371]


portfolio before change:  [10.86260252]
curr_Stock_Price:  102.29178070839131
curr_Factors:  [102.29178071]
mat_Sqrt:  [[0.15]]
grads:  [-0.24241869]
Stock Position:  -0.2424186924362373
Bond Position:  [35.66004224]


portfolio before change:  [10.96013833]
curr_Stock_Price:  101.92621613525245
curr_Factors:  [101.92621614]
mat_Sqrt:  [[0.15]]
grads:  [0.23053718]
Stock Position:  0.23053718114421845
Bond Position:  [-12.53764423]


portfolio before change:  [11.09074086]
curr_Stock_Price:  102.50632793563828
curr_Factors:  [102.50632794]
mat_Sqrt:  [[0.15]]
grads:  [0.03789195]
Stock Position:  0.037891952445165585
Bond Position:  [7.20657596]


portfolio before change:  [11.11637269]
curr_Stock_Price:  103.13522010766191
curr_Factors:  [103.13522011]
mat_Sqrt:  [[0.15]]
grads:  [-0.08776068]
Stock Position:  -0.08776067909510804
Bond Position:  [20.16758964]


portfolio before change:  [11.05296385]
curr_Stock_Price:  103.9151977280778
curr_Factors:  [103.91519773]
mat_Sqrt:  [[0.15]]
grads:  [-0.04157361]
Stock Position:  -0.04157361399028545
Bond Position:  [15.37309417]


portfolio before change:  [11.08092617]
curr_Stock_Price:  103.33505643638551
curr_Factors:  [103.33505644]
mat_Sqrt:  [[0.15]]
grads:  [0.02223125]
Stock Position:  0.022231253058580674
Bond Position:  [8.78365838]


portfolio before change:  [11.07485929]
curr_Stock_Price:  102.96336925082063
curr_Factors:  [102.96336925]
mat_Sqrt:  [[0.15]]
grads:  [-0.04516336]
Stock Position:  -0.04516335613915629
Bond Position:  [15.7250306]


portfolio before change:  [11.0518168]
curr_Stock_Price:  103.56062863620978
curr_Factors:  [103.56062864]
mat_Sqrt:  [[0.15]]
grads:  [0.00813936]
Stock Position:  0.008139360281196144
Bond Position:  [10.20889953]


portfolio before change:  [11.05653887]
curr_Stock_Price:  103.82717599896485
curr_Factors:  [103.827176]
mat_Sqrt:  [[0.15]]
grads:  [-0.02214388]
Stock Position:  -0.02214387520613118
Bond Position:  [13.3556749]


portfolio before change:  [11.07601612]
curr_Stock_Price:  103.09840059945246
curr_Factors:  [103.0984006]
mat_Sqrt:  [[0.15]]
grads:  [-0.01633446]
Stock Position:  -0.016334457955629527
Bond Position:  [12.76007261]


portfolio before change:  [11.0999681]
curr_Stock_Price:  101.8273716920374
curr_Factors:  [101.82737169]
mat_Sqrt:  [[0.15]]
grads:  [0.04568392]
Stock Position:  0.04568392039288794
Bond Position:  [6.44809456]


portfolio before change:  [11.19645974]
curr_Stock_Price:  103.90423832780849
curr_Factors:  [103.90423833]
mat_Sqrt:  [[0.15]]
grads:  [-0.0060869]
Stock Position:  -0.0060869022495171074
Bond Position:  [11.82891468]


portfolio before change:  [11.18087895]
curr_Stock_Price:  106.94985748292927
curr_Factors:  [106.94985748]
mat_Sqrt:  [[0.15]]
grads:  [0.12180249]
Stock Position:  0.1218024869816205
Bond Position:  [-1.84587968]


portfolio before change:  [10.95810279]
curr_Stock_Price:  105.12465151349345
curr_Factors:  [105.12465151]
mat_Sqrt:  [[0.15]]
grads:  [0.14308914]
Stock Position:  0.14308913599617953
Bond Position:  [-4.08409276]


portfolio before change:  [10.99707064]
curr_Stock_Price:  105.40412064467016
curr_Factors:  [105.40412064]
mat_Sqrt:  [[0.15]]
grads:  [0.04420504]
Stock Position:  0.04420504378811828
Bond Position:  [6.33767687]


portfolio before change:  [10.88360639]
curr_Stock_Price:  102.80150202687894
curr_Factors:  [102.80150203]
mat_Sqrt:  [[0.15]]
grads:  [0.08326519]
Stock Position:  0.08326519378902451
Bond Position:  [2.3238194]


portfolio before change:  [10.8816117]
curr_Stock_Price:  102.77056811939941
curr_Factors:  [102.77056812]
mat_Sqrt:  [[0.15]]
grads:  [-0.06551573]
Stock Position:  -0.06551572616364107
Bond Position:  [17.6147001]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.81965917]
Stock Price:  103.78340513329297
PL:  [7.03625404]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.05640469e-03]
 [-4.13589050e-03]
 [-1.01953676e-02]
 [-1.42416589e-02]
 [-4.77843626e-03]
 [-1.11458603e-02]
 [ 1.26137182e-02]
 [-4.31649533e-02]
 [ 5.93445901e-03]
 [ 4.05338308e-03]
 [-1.32109227e-02]
 [ 1.79999462e-02]
 [ 7.11920313e-03]
 [-2.27853763e-03]
 [ 7.05946000e-03]
 [ 2.23274311e-02]
 [ 1.41795747e-02]
 [-4.58142368e-04]
 [-1.01458051e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.03048319]
curr_Stock_Price:  99.15481582288837
curr_Factors:  [99.15481582]
mat_Sqrt:  [[0.15]]
grads:  [0.01370936]
Stock Position:  0.013709364615531855
Bond Position:  [-18.38983272]


portfolio before change:  [-17.03893116]
curr_Stock_Price:  98.87399043604461
curr_Factors:  [98.87399044]
mat_Sqrt:  [[0.15]]
grads:  [-0.0275726]
Stock Position:  -0.027572603361418268
Bond Position:  [-14.31271784]


portfolio before change:  [-17.01338885]
curr_Stock_Price:  97.81783542699104
curr_Factors:  [97.81783543]
mat_Sqrt:  [[0.15]]
grads:  [-0.06796912]
Stock Position:  -0.06796911709281292
Bond Position:  [-10.36479694]


portfolio before change:  [-17.06766756]
curr_Stock_Price:  98.57828645370482
curr_Factors:  [98.57828645]
mat_Sqrt:  [[0.15]]
grads:  [-0.09494439]
Stock Position:  -0.09494439247847977
Bond Position:  [-7.70821204]


portfolio before change:  [-16.90969068]
curr_Stock_Price:  96.89409878288433
curr_Factors:  [96.89409878]
mat_Sqrt:  [[0.15]]
grads:  [-0.03185624]
Stock Position:  -0.031856241734310516
Bond Position:  [-13.82300884]


portfolio before change:  [-16.91647965]
curr_Stock_Price:  96.99871856878437
curr_Factors:  [96.99871857]
mat_Sqrt:  [[0.15]]
grads:  [-0.07430574]
Stock Position:  -0.07430573516371738
Bond Position:  [-9.70891856]


portfolio before change:  [-16.90070179]
curr_Stock_Price:  96.75371200961152
curr_Factors:  [96.75371201]
mat_Sqrt:  [[0.15]]
grads:  [0.08409145]
Stock Position:  0.08409145446636059
Bond Position:  [-25.03686216]


portfolio before change:  [-16.98458591]
curr_Stock_Price:  95.83062031239099
curr_Factors:  [95.83062031]
mat_Sqrt:  [[0.15]]
grads:  [-0.28776636]
Stock Position:  -0.28776635504019077
Bond Position:  [10.59224239]


portfolio before change:  [-16.52814814]
curr_Stock_Price:  94.25368341726771
curr_Factors:  [94.25368342]
mat_Sqrt:  [[0.15]]
grads:  [0.03956306]
Stock Position:  0.03956306009556777
Bond Position:  [-20.25711228]


portfolio before change:  [-16.55134739]
curr_Stock_Price:  93.79531794428779
curr_Factors:  [93.79531794]
mat_Sqrt:  [[0.15]]
grads:  [0.02702255]
Stock Position:  0.027022553866984374
Bond Position:  [-19.08593642]


portfolio before change:  [-16.53043941]
curr_Stock_Price:  94.74563753348458
curr_Factors:  [94.74563753]
mat_Sqrt:  [[0.15]]
grads:  [-0.08807282]
Stock Position:  -0.08807281794270483
Bond Position:  [-8.18592413]


portfolio before change:  [-16.535277]
curr_Stock_Price:  94.77732549793458
curr_Factors:  [94.7773255]
mat_Sqrt:  [[0.15]]
grads:  [0.11999964]
Stock Position:  0.11999964121115148
Bond Position:  [-27.90852205]


portfolio before change:  [-16.58320157]
curr_Stock_Price:  94.4361030790573
curr_Factors:  [94.43610308]
mat_Sqrt:  [[0.15]]
grads:  [0.04746135]
Stock Position:  0.0474613541702926
Bond Position:  [-21.0652669]


portfolio before change:  [-16.69351203]
curr_Stock_Price:  92.22286050216533
curr_Factors:  [92.2228605]
mat_Sqrt:  [[0.15]]
grads:  [-0.01519025]
Stock Position:  -0.015190250888983675
Bond Position:  [-15.29262364]


portfolio before change:  [-16.72659053]
curr_Stock_Price:  94.148757663471
curr_Factors:  [94.14875766]
mat_Sqrt:  [[0.15]]
grads:  [0.04706307]
Stock Position:  0.04706306666887947
Bond Position:  [-21.15751978]


portfolio before change:  [-16.75475724]
curr_Stock_Price:  93.662672221365
curr_Factors:  [93.66267222]
mat_Sqrt:  [[0.15]]
grads:  [0.14884954]
Stock Position:  0.14884954080303342
Bond Position:  [-30.69640299]


portfolio before change:  [-16.91057619]
curr_Stock_Price:  92.66741290821028
curr_Factors:  [92.66741291]
mat_Sqrt:  [[0.15]]
grads:  [0.0945305]
Stock Position:  0.09453049809077833
Bond Position:  [-25.67047289]


portfolio before change:  [-17.02197952]
curr_Stock_Price:  91.55681988159743
curr_Factors:  [91.55681988]
mat_Sqrt:  [[0.15]]
grads:  [-0.00305428]
Stock Position:  -0.0030542824509500444
Bond Position:  [-16.74233914]


portfolio before change:  [-17.03126664]
curr_Stock_Price:  93.22693622005823
curr_Factors:  [93.22693622]
mat_Sqrt:  [[0.15]]
grads:  [-0.0676387]
Stock Position:  -0.067638700351798
Bond Position:  [-10.72551783]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.96500555]
Stock Price:  92.2076558696768
PL:  [-16.96500555]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.87801101e-02]
 [ 3.35859297e-02]
 [-4.83584860e-03]
 [-9.97971094e-03]
 [ 6.48829954e-03]
 [-9.72020313e-03]
 [ 1.40333234e-02]
 [ 1.37708911e-02]
 [-1.54834583e-02]
 [ 3.11530242e-03]
 [-3.07543832e-03]
 [-6.58234847e-03]
 [ 9.41058477e-03]
 [ 8.30665351e-05]
 [ 7.47815585e-05]
 [ 2.29765176e-02]
 [ 1.79318938e-03]
 [ 1.34521678e-02]
 [-1.41426942e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [30.82302003]
curr_Stock_Price:  101.32602020708701
curr_Factors:  [101.32602021]
mat_Sqrt:  [[0.15]]
grads:  [-0.12520073]
Stock Position:  -0.1252007336919966
Bond Position:  [43.50911211]


portfolio before change:  [30.74154889]
curr_Stock_Price:  102.0636339674905
curr_Factors:  [102.06363397]
mat_Sqrt:  [[0.15]]
grads:  [0.2239062]
Stock Position:  0.22390619826850885
Bond Position:  [7.88886862]


portfolio before change:  [30.26737582]
curr_Stock_Price:  99.9370937533734
curr_Factors:  [99.93709375]
mat_Sqrt:  [[0.15]]
grads:  [-0.03223899]
Stock Position:  -0.032238990696145116
Bond Position:  [33.48924685]


portfolio before change:  [30.26252039]
curr_Stock_Price:  100.34742859857711
curr_Factors:  [100.3474286]
mat_Sqrt:  [[0.15]]
grads:  [-0.06653141]
Stock Position:  -0.06653140626376422
Bond Position:  [36.93877593]


portfolio before change:  [30.26216578]
curr_Stock_Price:  100.49157802907817
curr_Factors:  [100.49157803]
mat_Sqrt:  [[0.15]]
grads:  [0.04325533]
Stock Position:  0.04325533029752523
Bond Position:  [25.91536938]


portfolio before change:  [30.27537099]
curr_Stock_Price:  100.64706316987888
curr_Factors:  [100.64706317]
mat_Sqrt:  [[0.15]]
grads:  [-0.06480135]
Stock Position:  -0.064801354222509
Bond Position:  [36.79743698]


portfolio before change:  [30.32863969]
curr_Stock_Price:  99.96701275116081
curr_Factors:  [99.96701275]
mat_Sqrt:  [[0.15]]
grads:  [0.09355549]
Stock Position:  0.0935554891414994
Bond Position:  [20.97617691]


portfolio before change:  [30.44772395]
curr_Stock_Price:  101.18382603819062
curr_Factors:  [101.18382604]
mat_Sqrt:  [[0.15]]
grads:  [0.09180594]
Stock Position:  0.09180594078471409
Bond Position:  [21.15844761]


portfolio before change:  [30.53747181]
curr_Stock_Price:  102.10378380748091
curr_Factors:  [102.10378381]
mat_Sqrt:  [[0.15]]
grads:  [-0.10322306]
Stock Position:  -0.10322305518640473
Bond Position:  [41.07693632]


portfolio before change:  [30.7074583]
curr_Stock_Price:  100.55649409860042
curr_Factors:  [100.5564941]
mat_Sqrt:  [[0.15]]
grads:  [0.02076868]
Stock Position:  0.020768682809562598
Bond Position:  [28.61903237]


portfolio before change:  [30.74972113]
curr_Stock_Price:  102.24688432627839
curr_Factors:  [102.24688433]
mat_Sqrt:  [[0.15]]
grads:  [-0.02050292]
Stock Position:  -0.02050292213098301
Bond Position:  [32.84608104]


portfolio before change:  [30.76494435]
curr_Stock_Price:  101.90494916628451
curr_Factors:  [101.90494917]
mat_Sqrt:  [[0.15]]
grads:  [-0.04388232]
Stock Position:  -0.043882323136177036
Bond Position:  [35.23677026]


portfolio before change:  [30.70052956]
curr_Stock_Price:  103.57361852256368
curr_Factors:  [103.57361852]
mat_Sqrt:  [[0.15]]
grads:  [0.06273723]
Stock Position:  0.06273723177678588
Bond Position:  [24.20260744]


portfolio before change:  [30.66882876]
curr_Stock_Price:  102.9718672818905
curr_Factors:  [102.97186728]
mat_Sqrt:  [[0.15]]
grads:  [0.00055378]
Stock Position:  0.00055377690072465
Bond Position:  [30.61180531]


portfolio before change:  [30.67612953]
curr_Stock_Price:  102.33417644690742
curr_Factors:  [102.33417645]
mat_Sqrt:  [[0.15]]
grads:  [0.00049854]
Stock Position:  0.0004985437233931932
Bond Position:  [30.62511146]


portfolio before change:  [30.68420386]
curr_Stock_Price:  103.17081058832319
curr_Factors:  [103.17081059]
mat_Sqrt:  [[0.15]]
grads:  [0.15317678]
Stock Position:  0.1531767839432422
Bond Position:  [14.8808309]


portfolio before change:  [30.67644969]
curr_Stock_Price:  103.09589815912409
curr_Factors:  [103.09589816]
mat_Sqrt:  [[0.15]]
grads:  [0.0119546]
Stock Position:  0.011954595866485
Bond Position:  [29.44397989]


portfolio before change:  [30.70012095]
curr_Stock_Price:  104.46017274824901
curr_Factors:  [104.46017275]
mat_Sqrt:  [[0.15]]
grads:  [0.08968112]
Stock Position:  0.08968111860166779
Bond Position:  [21.33201581]


portfolio before change:  [30.69074531]
curr_Stock_Price:  104.29615481521009
curr_Factors:  [104.29615482]
mat_Sqrt:  [[0.15]]
grads:  [-0.09428463]
Stock Position:  -0.09428462770111792
Bond Position:  [40.52426944]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [30.57650296]
Stock Price:  105.61529546131804
PL:  [24.9612075]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.26075445e-02]
 [ 3.74425291e-02]
 [-4.37109401e-02]
 [ 7.96187218e-02]
 [ 5.43444526e-03]
 [-1.58194769e-02]
 [-9.48393372e-03]
 [ 1.11371680e-03]
 [ 1.89233484e-02]
 [ 1.30315084e-03]
 [-3.40958096e-03]
 [ 5.18153083e-03]
 [ 1.18537928e-02]
 [-3.51454997e-03]
 [ 1.40749061e-02]
 [ 2.21568888e-02]
 [ 2.80746223e-03]
 [ 1.37827752e-02]
 [-1.58309015e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.72285888]
curr_Stock_Price:  100.64089719853087
curr_Factors:  [100.6408972]
mat_Sqrt:  [[0.15]]
grads:  [-0.0840503]
Stock Position:  -0.08405029679755191
Bond Position:  [24.18175616]


portfolio before change:  [15.5966324]
curr_Stock_Price:  102.21462952835132
curr_Factors:  [102.21462953]
mat_Sqrt:  [[0.15]]
grads:  [0.24961686]
Stock Position:  0.24961686050645115
Bond Position:  [-9.91786252]


portfolio before change:  [15.73603056]
curr_Stock_Price:  102.78301231517855
curr_Factors:  [102.78301232]
mat_Sqrt:  [[0.15]]
grads:  [-0.29140627]
Stock Position:  -0.29140626736860137
Bond Position:  [45.68764452]


portfolio before change:  [15.23113298]
curr_Stock_Price:  104.55483732786588
curr_Factors:  [104.55483733]
mat_Sqrt:  [[0.15]]
grads:  [0.53079148]
Stock Position:  0.5307914784972656
Bond Position:  [-40.26568371]


portfolio before change:  [14.66516268]
curr_Stock_Price:  103.50752845814465
curr_Factors:  [103.50752846]
mat_Sqrt:  [[0.15]]
grads:  [0.03622964]
Stock Position:  0.036229635045613946
Bond Position:  [10.9151227]


portfolio before change:  [14.69225873]
curr_Stock_Price:  104.1800974109103
curr_Factors:  [104.18009741]
mat_Sqrt:  [[0.15]]
grads:  [-0.10546318]
Stock Position:  -0.10546317902790897
Bond Position:  [25.67942299]


portfolio before change:  [14.62944672]
curr_Stock_Price:  104.83656030777762
curr_Factors:  [104.83656031]
mat_Sqrt:  [[0.15]]
grads:  [-0.06322622]
Stock Position:  -0.06322622480948878
Bond Position:  [21.25786665]


portfolio before change:  [14.6978094]
curr_Stock_Price:  103.83938633428575
curr_Factors:  [103.83938633]
mat_Sqrt:  [[0.15]]
grads:  [0.00742478]
Stock Position:  0.007424778697087467
Bond Position:  [13.92682494]


portfolio before change:  [14.71199565]
curr_Stock_Price:  105.28106037164378
curr_Factors:  [105.28106037]
mat_Sqrt:  [[0.15]]
grads:  [0.12615566]
Stock Position:  0.12615565595805245
Bond Position:  [1.43019442]


portfolio before change:  [14.48788641]
curr_Stock_Price:  103.50177558652364
curr_Factors:  [103.50177559]
mat_Sqrt:  [[0.15]]
grads:  [0.00868767]
Stock Position:  0.008687672253701578
Bond Position:  [13.5886969]


portfolio before change:  [14.49876904]
curr_Stock_Price:  104.36334511255154
curr_Factors:  [104.36334511]
mat_Sqrt:  [[0.15]]
grads:  [-0.02273054]
Stock Position:  -0.02273053976393658
Bond Position:  [16.8710042]


portfolio before change:  [14.50399673]
curr_Stock_Price:  104.31893721751288
curr_Factors:  [104.31893722]
mat_Sqrt:  [[0.15]]
grads:  [0.03454354]
Stock Position:  0.03454353885488743
Bond Position:  [10.90045147]


portfolio before change:  [14.53956643]
curr_Stock_Price:  105.26974450887873
curr_Factors:  [105.26974451]
mat_Sqrt:  [[0.15]]
grads:  [0.07902529]
Stock Position:  0.07902528563301847
Bond Position:  [6.22059481]


portfolio before change:  [14.60002348]
curr_Stock_Price:  106.01509715719973
curr_Factors:  [106.01509716]
mat_Sqrt:  [[0.15]]
grads:  [-0.02343033]
Stock Position:  -0.02343033311994945
Bond Position:  [17.08399253]


portfolio before change:  [14.60437757]
curr_Stock_Price:  106.01157358148018
curr_Factors:  [106.01157358]
mat_Sqrt:  [[0.15]]
grads:  [0.09383271]
Stock Position:  0.09383270746643074
Bond Position:  [4.6570246]


portfolio before change:  [14.44058764]
curr_Stock_Price:  104.25361154089512
curr_Factors:  [104.25361154]
mat_Sqrt:  [[0.15]]
grads:  [0.14771259]
Stock Position:  0.1477125918239686
Bond Position:  [-0.95898353]


portfolio before change:  [14.33945349]
curr_Stock_Price:  103.57056637370755
curr_Factors:  [103.57056637]
mat_Sqrt:  [[0.15]]
grads:  [0.01871641]
Stock Position:  0.018716414836855457
Bond Position:  [12.4009838]


portfolio before change:  [14.36919769]
curr_Stock_Price:  104.99410672482783
curr_Factors:  [104.99410672]
mat_Sqrt:  [[0.15]]
grads:  [0.09188517]
Stock Position:  0.091885168067464
Bond Position:  [4.72179655]


portfolio before change:  [14.3532264]
curr_Stock_Price:  104.80744014108824
curr_Factors:  [104.80744014]
mat_Sqrt:  [[0.15]]
grads:  [-0.10553934]
Stock Position:  -0.10553934340221699
Bond Position:  [25.41453482]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.37202491]
Stock Price:  104.68953074785755
PL:  [9.68249416]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.72758240e-03]
 [-9.79807552e-03]
 [-4.81971586e-03]
 [-1.76797240e-02]
 [-2.00052012e-03]
 [-1.07477287e-02]
 [ 1.43797297e-02]
 [ 1.40283003e-02]
 [-1.97193312e-02]
 [ 2.32221416e-03]
 [-2.91686924e-03]
 [ 2.48965349e-03]
 [ 4.87158402e-03]
 [-9.77807126e-04]
 [ 7.53029779e-03]
 [ 1.79903586e-02]
 [ 8.70939732e-04]
 [ 1.26386816e-02]
 [-1.01598957e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.39369339]
curr_Stock_Price:  99.41056768886874
curr_Factors:  [99.41056769]
mat_Sqrt:  [[0.15]]
grads:  [0.01818388]
Stock Position:  0.01818388268173777
Bond Position:  [-13.20136349]


portfolio before change:  [-11.38575213]
curr_Stock_Price:  100.02880780183952
curr_Factors:  [100.0288078]
mat_Sqrt:  [[0.15]]
grads:  [-0.0653205]
Stock Position:  -0.06532050349626131
Bond Position:  [-4.85182004]


portfolio before change:  [-11.32894349]
curr_Stock_Price:  99.14054529266166
curr_Factors:  [99.14054529]
mat_Sqrt:  [[0.15]]
grads:  [-0.03213144]
Stock Position:  -0.03213143909342707
Bond Position:  [-8.14341509]


portfolio before change:  [-11.32854649]
curr_Stock_Price:  99.06482170440604
curr_Factors:  [99.0648217]
mat_Sqrt:  [[0.15]]
grads:  [-0.11786483]
Stock Position:  -0.11786482690463451
Bond Position:  [0.34771158]


portfolio before change:  [-11.16316683]
curr_Stock_Price:  97.66242950387625
curr_Factors:  [97.6624295]
mat_Sqrt:  [[0.15]]
grads:  [-0.0133368]
Stock Position:  -0.013336800821972089
Bond Position:  [-9.86066246]


portfolio before change:  [-11.17437843]
curr_Stock_Price:  98.31821847840018
curr_Factors:  [98.31821848]
mat_Sqrt:  [[0.15]]
grads:  [-0.07165152]
Stock Position:  -0.07165152473544725
Bond Position:  [-4.12972817]


portfolio before change:  [-11.25365699]
curr_Stock_Price:  99.41025381523637
curr_Factors:  [99.41025382]
mat_Sqrt:  [[0.15]]
grads:  [0.09586486]
Stock Position:  0.09586486474805474
Bond Position:  [-20.78360753]


portfolio before change:  [-11.09266415]
curr_Stock_Price:  101.14383361167097
curr_Factors:  [101.14383361]
mat_Sqrt:  [[0.15]]
grads:  [0.093522]
Stock Position:  0.09352200179235619
Bond Position:  [-20.55183794]


portfolio before change:  [-11.06152838]
curr_Stock_Price:  101.53170351812106
curr_Factors:  [101.53170352]
mat_Sqrt:  [[0.15]]
grads:  [-0.13146221]
Stock Position:  -0.13146220794748376
Bond Position:  [2.28605354]


portfolio before change:  [-11.05865511]
curr_Stock_Price:  101.51419512550075
curr_Factors:  [101.51419513]
mat_Sqrt:  [[0.15]]
grads:  [0.01548143]
Stock Position:  0.015481427766326827
Bond Position:  [-12.63023979]


portfolio before change:  [-11.07938417]
curr_Stock_Price:  100.37921521379641
curr_Factors:  [100.37921521]
mat_Sqrt:  [[0.15]]
grads:  [-0.01944579]
Stock Position:  -0.01944579491925769
Bond Position:  [-9.12743054]


portfolio before change:  [-11.03259442]
curr_Stock_Price:  97.85569294264364
curr_Factors:  [97.85569294]
mat_Sqrt:  [[0.15]]
grads:  [0.01659769]
Stock Position:  0.016597689964368847
Bond Position:  [-12.65677287]


portfolio before change:  [-11.01172792]
curr_Stock_Price:  99.30355025401852
curr_Factors:  [99.30355025]
mat_Sqrt:  [[0.15]]
grads:  [0.03247723]
Stock Position:  0.03247722679296133
Bond Position:  [-14.23683184]


portfolio before change:  [-11.05063713]
curr_Stock_Price:  98.2151087242386
curr_Factors:  [98.21510872]
mat_Sqrt:  [[0.15]]
grads:  [-0.00651871]
Stock Position:  -0.0065187141705626535
Bond Position:  [-10.41040091]


portfolio before change:  [-11.05723962]
curr_Stock_Price:  98.82865889717475
curr_Factors:  [98.8286589]
mat_Sqrt:  [[0.15]]
grads:  [0.05020199]
Stock Position:  0.05020198529256851
Bond Position:  [-16.0186345]


portfolio before change:  [-10.99515357]
curr_Stock_Price:  100.14516476065549
curr_Factors:  [100.14516476]
mat_Sqrt:  [[0.15]]
grads:  [0.11993572]
Stock Position:  0.1199357237038032
Bond Position:  [-23.00613638]


portfolio before change:  [-10.74283181]
curr_Stock_Price:  102.29693411621875
curr_Factors:  [102.29693412]
mat_Sqrt:  [[0.15]]
grads:  [0.00580626]
Stock Position:  0.005806264879768631
Bond Position:  [-11.3367949]


portfolio before change:  [-10.74080293]
curr_Stock_Price:  103.13455182061116
curr_Factors:  [103.13455182]
mat_Sqrt:  [[0.15]]
grads:  [0.08425788]
Stock Position:  0.08425787751151276
Bond Position:  [-19.43070136]


portfolio before change:  [-10.76894597]
curr_Stock_Price:  102.85820066111408
curr_Factors:  [102.85820066]
mat_Sqrt:  [[0.15]]
grads:  [-0.06773264]
Stock Position:  -0.06773263795478184
Bond Position:  [-3.80208871]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.88459623]
Stock Price:  104.55161790282177
PL:  [-15.43621414]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 1.52996608e-03]
 [-9.79583713e-03]
 [-5.70899118e-03]
 [-2.34048427e-02]
 [ 5.83667914e-03]
 [-1.02883354e-02]
 [ 1.34080596e-02]
 [-4.84001869e-02]
 [ 5.00344005e-03]
 [ 5.24564206e-03]
 [-1.81223944e-02]
 [ 2.99842693e-02]
 [ 8.57732761e-03]
 [-2.25281439e-03]
 [ 6.10791024e-03]
 [ 2.32940060e-02]
 [ 1.54562495e-02]
 [ 4.84167888e-05]
 [-1.08793867e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.20150359]
curr_Stock_Price:  99.91837860982425
curr_Factors:  [99.91837861]
mat_Sqrt:  [[0.15]]
grads:  [0.01019977]
Stock Position:  0.010199773871422877
Bond Position:  [-1.22064846]


portfolio before change:  [-0.19875941]
curr_Stock_Price:  100.21734404343452
curr_Factors:  [100.21734404]
mat_Sqrt:  [[0.15]]
grads:  [-0.06530558]
Stock Position:  -0.06530558088689023
Bond Position:  [6.34599245]


portfolio before change:  [-0.11536754]
curr_Stock_Price:  98.96469185810616
curr_Factors:  [98.96469186]
mat_Sqrt:  [[0.15]]
grads:  [-0.03805994]
Stock Position:  -0.0380599412164283
Bond Position:  [3.65122282]


portfolio before change:  [-0.1414362]
curr_Stock_Price:  99.67361525922823
curr_Factors:  [99.67361526]
mat_Sqrt:  [[0.15]]
grads:  [-0.15603228]
Stock Position:  -0.15603228450364415
Bond Position:  [15.41086569]


portfolio before change:  [-0.34452909]
curr_Stock_Price:  100.99991828041856
curr_Factors:  [100.99991828]
mat_Sqrt:  [[0.15]]
grads:  [0.03891119]
Stock Position:  0.03891119427183515
Bond Position:  [-4.27455654]


portfolio before change:  [-0.40807307]
curr_Stock_Price:  99.39433388242303
curr_Factors:  [99.39433388]
mat_Sqrt:  [[0.15]]
grads:  [-0.0685889]
Stock Position:  -0.06858890283496798
Bond Position:  [6.40927524]


portfolio before change:  [-0.13604282]
curr_Stock_Price:  95.45160088272878
curr_Factors:  [95.45160088]
mat_Sqrt:  [[0.15]]
grads:  [0.08938706]
Stock Position:  0.08938706384811958
Bond Position:  [-8.66818117]


portfolio before change:  [-0.15224866]
curr_Stock_Price:  95.29454769393385
curr_Factors:  [95.29454769]
mat_Sqrt:  [[0.15]]
grads:  [-0.32266791]
Stock Position:  -0.3226679125447459
Bond Position:  [30.59624412]


portfolio before change:  [0.01533443]
curr_Stock_Price:  94.79888923160225
curr_Factors:  [94.79888923]
mat_Sqrt:  [[0.15]]
grads:  [0.03335627]
Stock Position:  0.03335626697404258
Bond Position:  [-3.14680262]


portfolio before change:  [0.00621582]
curr_Stock_Price:  94.54910650651955
curr_Factors:  [94.54910651]
mat_Sqrt:  [[0.15]]
grads:  [0.03497095]
Stock Position:  0.0349709470995784
Bond Position:  [-3.30025599]


portfolio before change:  [-0.05433469]
curr_Stock_Price:  92.84125052591853
curr_Factors:  [92.84125053]
mat_Sqrt:  [[0.15]]
grads:  [-0.12081596]
Stock Position:  -0.1208159627407666
Bond Position:  [11.16237037]


portfolio before change:  [0.00162459]
curr_Stock_Price:  92.40117338255521
curr_Factors:  [92.40117338]
mat_Sqrt:  [[0.15]]
grads:  [0.19989513]
Stock Position:  0.1998951283589467
Bond Position:  [-18.46891982]


portfolio before change:  [-0.0235983]
curr_Stock_Price:  92.29809392353663
curr_Factors:  [92.29809392]
mat_Sqrt:  [[0.15]]
grads:  [0.05718218]
Stock Position:  0.05718218405887725
Bond Position:  [-5.30140489]


portfolio before change:  [-0.02284221]
curr_Stock_Price:  92.33449697415422
curr_Factors:  [92.33449697]
mat_Sqrt:  [[0.15]]
grads:  [-0.01501876]
Stock Position:  -0.015018762598073896
Bond Position:  [1.36390768]


portfolio before change:  [-0.01742466]
curr_Stock_Price:  91.99648480866838
curr_Factors:  [91.99648481]
mat_Sqrt:  [[0.15]]
grads:  [0.0407194]
Stock Position:  0.040719401581353905
Bond Position:  [-3.76346647]


portfolio before change:  [-0.02910048]
curr_Stock_Price:  91.73285544017482
curr_Factors:  [91.73285544]
mat_Sqrt:  [[0.15]]
grads:  [0.15529337]
Stock Position:  0.1552933733785621
Bond Position:  [-14.27460505]


portfolio before change:  [0.00839225]
curr_Stock_Price:  91.99726995280108
curr_Factors:  [91.99726995]
mat_Sqrt:  [[0.15]]
grads:  [0.10304166]
Stock Position:  0.10304166353945474
Bond Position:  [-9.47115949]


portfolio before change:  [0.05055281]
curr_Stock_Price:  92.42941213972858
curr_Factors:  [92.42941214]
mat_Sqrt:  [[0.15]]
grads:  [0.00032278]
Stock Position:  0.0003227785921341639
Bond Position:  [0.02071858]


portfolio before change:  [0.05038335]
curr_Stock_Price:  91.88835982406633
curr_Factors:  [91.88835982]
mat_Sqrt:  [[0.15]]
grads:  [-0.07252924]
Stock Position:  -0.07252924478244062
Bond Position:  [6.71497669]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.05882816]
Stock Price:  91.79507537297829
PL:  [0.05882816]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.78119767e-03]
 [-9.82939614e-03]
 [-5.86430470e-03]
 [ 1.39472243e-02]
 [ 6.26427048e-03]
 [-9.74513823e-03]
 [ 4.74696213e-03]
 [ 1.47333847e-02]
 [-1.88663118e-02]
 [ 2.51853667e-03]
 [-3.02531764e-03]
 [-2.02598674e-03]
 [ 5.06428547e-03]
 [-4.66618857e-04]
 [ 2.63691337e-04]
 [ 2.20347541e-02]
 [ 9.71035746e-04]
 [ 9.59980957e-03]
 [-5.44019828e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.47954538]
curr_Stock_Price:  99.63353192315027
curr_Factors:  [99.63353192]
mat_Sqrt:  [[0.15]]
grads:  [0.01854132]
Stock Position:  0.01854131778990601
Bond Position:  [-8.32688235]


portfolio before change:  [-6.47141098]
curr_Stock_Price:  100.18453767342206
curr_Factors:  [100.18453767]
mat_Sqrt:  [[0.15]]
grads:  [-0.06552931]
Stock Position:  -0.0655293075829066
Bond Position:  [0.0936124]


portfolio before change:  [-6.49778307]
curr_Stock_Price:  100.58734201995745
curr_Factors:  [100.58734202]
mat_Sqrt:  [[0.15]]
grads:  [-0.03909536]
Stock Position:  -0.039095364691128016
Bond Position:  [-2.56528425]


portfolio before change:  [-6.52129109]
curr_Stock_Price:  101.17223551707539
curr_Factors:  [101.17223552]
mat_Sqrt:  [[0.15]]
grads:  [0.0929815]
Stock Position:  0.09298149516184812
Bond Position:  [-15.92843682]


portfolio before change:  [-6.5704884]
curr_Stock_Price:  100.68595921603634
curr_Factors:  [100.68595922]
mat_Sqrt:  [[0.15]]
grads:  [0.0417618]
Stock Position:  0.04176180319668312
Bond Position:  [-10.77531561]


portfolio before change:  [-6.57687048]
curr_Stock_Price:  100.59765083074679
curr_Factors:  [100.59765083]
mat_Sqrt:  [[0.15]]
grads:  [-0.06496759]
Stock Position:  -0.06496758820772244
Bond Position:  [-0.04128373]


portfolio before change:  [-6.62385009]
curr_Stock_Price:  101.32061577438431
curr_Factors:  [101.32061577]
mat_Sqrt:  [[0.15]]
grads:  [0.03164641]
Stock Position:  0.031646414221831294
Bond Position:  [-9.83028427]


portfolio before change:  [-6.63536922]
curr_Stock_Price:  101.03428802172647
curr_Factors:  [101.03428802]
mat_Sqrt:  [[0.15]]
grads:  [0.09822256]
Stock Position:  0.09822256466944294
Bond Position:  [-16.55921611]


portfolio before change:  [-6.60692036]
curr_Stock_Price:  101.36607715255424
curr_Factors:  [101.36607715]
mat_Sqrt:  [[0.15]]
grads:  [-0.12577541]
Stock Position:  -0.1257754118067568
Bond Position:  [6.14243974]


portfolio before change:  [-6.75330985]
curr_Stock_Price:  102.54218376760862
curr_Factors:  [102.54218377]
mat_Sqrt:  [[0.15]]
grads:  [0.01679024]
Stock Position:  0.01679024448175665
Bond Position:  [-8.47501819]


portfolio before change:  [-6.77582565]
curr_Stock_Price:  101.32738413727166
curr_Factors:  [101.32738414]
mat_Sqrt:  [[0.15]]
grads:  [-0.02016878]
Stock Position:  -0.020168784242386644
Bond Position:  [-4.7321755]


portfolio before change:  [-6.72933562]
curr_Stock_Price:  98.96367070468638
curr_Factors:  [98.9636707]
mat_Sqrt:  [[0.15]]
grads:  [-0.01350658]
Stock Position:  -0.01350657826079582
Bond Position:  [-5.39267506]


portfolio before change:  [-6.72554846]
curr_Stock_Price:  98.58344870812192
curr_Factors:  [98.58344871]
mat_Sqrt:  [[0.15]]
grads:  [0.0337619]
Stock Position:  0.03376190312813567
Bond Position:  [-10.0539133]


portfolio before change:  [-6.67727828]
curr_Stock_Price:  100.08762853807522
curr_Factors:  [100.08762854]
mat_Sqrt:  [[0.15]]
grads:  [-0.00311079]
Stock Position:  -0.0031107923806087123
Bond Position:  [-6.36592644]


portfolio before change:  [-6.6878105]
curr_Stock_Price:  102.96166910638193
curr_Factors:  [102.96166911]
mat_Sqrt:  [[0.15]]
grads:  [0.00175794]
Stock Position:  0.0017579422475407468
Bond Position:  [-6.86881117]


portfolio before change:  [-6.6921762]
curr_Stock_Price:  101.45520167794376
curr_Factors:  [101.45520168]
mat_Sqrt:  [[0.15]]
grads:  [0.14689836]
Stock Position:  0.14689836066189396
Bond Position:  [-21.59577901]


portfolio before change:  [-6.63002559]
curr_Stock_Price:  101.91504498366437
curr_Factors:  [101.91504498]
mat_Sqrt:  [[0.15]]
grads:  [0.00647357]
Stock Position:  0.006473571641631145
Bond Position:  [-7.28977994]


portfolio before change:  [-6.6401979]
curr_Stock_Price:  100.62524170269141
curr_Factors:  [100.6252417]
mat_Sqrt:  [[0.15]]
grads:  [0.06399873]
Stock Position:  0.06399873044255881
Bond Position:  [-13.08008562]


portfolio before change:  [-6.68843974]
curr_Stock_Price:  99.92254953520538
curr_Factors:  [99.92254954]
mat_Sqrt:  [[0.15]]
grads:  [-0.03626799]
Stock Position:  -0.036267988539734945
Bond Position:  [-3.06444986]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.68072974]
Stock Price:  99.68883907234645
PL:  [-6.68072974]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.72433398e-03]
 [-1.05568441e-02]
 [-1.30461656e-02]
 [-2.16655571e-02]
 [ 5.72646959e-03]
 [-1.00941480e-02]
 [ 1.14736500e-03]
 [ 1.26898739e-02]
 [-6.28471610e-03]
 [ 2.56396818e-03]
 [-3.10360050e-03]
 [-4.25268488e-03]
 [ 4.82304705e-03]
 [-6.29048735e-04]
 [ 5.07780579e-03]
 [ 2.08413482e-02]
 [ 2.62779227e-03]
 [ 1.12799404e-02]
 [-6.73590923e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.63346016]
curr_Stock_Price:  100.13775010395567
curr_Factors:  [100.1377501]
mat_Sqrt:  [[0.15]]
grads:  [-0.01149556]
Stock Position:  -0.011495559898650962
Bond Position:  [5.78459967]


portfolio before change:  [4.63916331]
curr_Stock_Price:  99.76744887176817
curr_Factors:  [99.76744887]
mat_Sqrt:  [[0.15]]
grads:  [-0.07037896]
Stock Position:  -0.07037896074857486
Bond Position:  [11.66069268]


portfolio before change:  [4.5587721]
curr_Stock_Price:  100.95113710481449
curr_Factors:  [100.9511371]
mat_Sqrt:  [[0.15]]
grads:  [-0.08697444]
Stock Position:  -0.08697443745897192
Bond Position:  [13.33894046]


portfolio before change:  [4.69329882]
curr_Stock_Price:  99.44274483045471
curr_Factors:  [99.44274483]
mat_Sqrt:  [[0.15]]
grads:  [-0.14443705]
Stock Position:  -0.14443704748201167
Bond Position:  [19.05651528]


portfolio before change:  [4.44563619]
curr_Stock_Price:  101.19040837166132
curr_Factors:  [101.19040837]
mat_Sqrt:  [[0.15]]
grads:  [0.03817646]
Stock Position:  0.03817646394560985
Bond Position:  [0.58254421]


portfolio before change:  [4.47253622]
curr_Stock_Price:  101.89121664985089
curr_Factors:  [101.89121665]
mat_Sqrt:  [[0.15]]
grads:  [-0.06729432]
Stock Position:  -0.06729431986737765
Bond Position:  [11.32923635]


portfolio before change:  [4.47752633]
curr_Stock_Price:  101.85915679762914
curr_Factors:  [101.8591568]
mat_Sqrt:  [[0.15]]
grads:  [0.0076491]
Stock Position:  0.00764910002206891
Bond Position:  [3.69839545]


portfolio before change:  [4.47457006]
curr_Stock_Price:  101.35177850801132
curr_Factors:  [101.35177851]
mat_Sqrt:  [[0.15]]
grads:  [0.08459916]
Stock Position:  0.08459915915932792
Bond Position:  [-4.09970518]


portfolio before change:  [4.36572456]
curr_Stock_Price:  100.07729245283008
curr_Factors:  [100.07729245]
mat_Sqrt:  [[0.15]]
grads:  [-0.04189811]
Stock Position:  -0.04189810730565932
Bond Position:  [8.55877369]


portfolio before change:  [4.3412992]
curr_Stock_Price:  100.71133826241777
curr_Factors:  [100.71133826]
mat_Sqrt:  [[0.15]]
grads:  [0.01709312]
Stock Position:  0.0170931211928706
Bond Position:  [2.61982809]


portfolio before change:  [4.32338333]
curr_Stock_Price:  99.62488338023405
curr_Factors:  [99.62488338]
mat_Sqrt:  [[0.15]]
grads:  [-0.02069067]
Stock Position:  -0.02069066997726817
Bond Position:  [6.38468891]


portfolio before change:  [4.32871694]
curr_Stock_Price:  99.44425904206047
curr_Factors:  [99.44425904]
mat_Sqrt:  [[0.15]]
grads:  [-0.02835123]
Stock Position:  -0.028351232562195072
Bond Position:  [7.14808426]


portfolio before change:  [4.32318199]
curr_Stock_Price:  99.7025262381829
curr_Factors:  [99.70252624]
mat_Sqrt:  [[0.15]]
grads:  [0.03215365]
Stock Position:  0.03215364698842553
Bond Position:  [1.11738216]


portfolio before change:  [4.31647868]
curr_Stock_Price:  99.48535966264743
curr_Factors:  [99.48535966]
mat_Sqrt:  [[0.15]]
grads:  [-0.00419366]
Stock Position:  -0.004193658231289748
Bond Position:  [4.73368627]


portfolio before change:  [4.31693286]
curr_Stock_Price:  99.65928424672927
curr_Factors:  [99.65928425]
mat_Sqrt:  [[0.15]]
grads:  [0.03385204]
Stock Position:  0.03385203858655283
Bond Position:  [0.94326293]


portfolio before change:  [4.357649]
curr_Stock_Price:  100.85508478257564
curr_Factors:  [100.85508478]
mat_Sqrt:  [[0.15]]
grads:  [0.13894232]
Stock Position:  0.13894232156099626
Bond Position:  [-9.65539063]


portfolio before change:  [4.38227684]
curr_Stock_Price:  101.04971224243877
curr_Factors:  [101.04971224]
mat_Sqrt:  [[0.15]]
grads:  [0.01751862]
Stock Position:  0.017518615159722695
Bond Position:  [2.61202582]


portfolio before change:  [4.39610596]
curr_Stock_Price:  101.80182857426094
curr_Factors:  [101.80182857]
mat_Sqrt:  [[0.15]]
grads:  [0.0751996]
Stock Position:  0.07519960250594646
Bond Position:  [-3.25935108]


portfolio before change:  [4.39573375]
curr_Stock_Price:  101.80771589382535
curr_Factors:  [101.80771589]
mat_Sqrt:  [[0.15]]
grads:  [-0.04490606]
Stock Position:  -0.044906061504765525
Bond Position:  [8.9675173]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.41059442]
Stock Price:  101.52671779160649
PL:  [2.88387663]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.75214495e-03]
 [-1.05811548e-02]
 [-4.17390504e-03]
 [-1.63314271e-02]
 [-2.80286299e-03]
 [-1.04512748e-02]
 [ 1.37377960e-02]
 [-3.25080876e-02]
 [-1.58181644e-03]
 [ 2.35656246e-03]
 [-3.05164191e-03]
 [-6.53398036e-03]
 [ 6.48049045e-03]
 [ 2.46334229e-04]
 [ 4.71437596e-04]
 [ 2.28981538e-02]
 [ 6.34900203e-03]
 [ 1.49121899e-02]
 [-1.63547535e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.51729484]
curr_Stock_Price:  99.45033155643364
curr_Factors:  [99.45033156]
mat_Sqrt:  [[0.15]]
grads:  [0.01834763]
Stock Position:  0.01834763298326479
Bond Position:  [-12.34197302]


portfolio before change:  [-10.51427206]
curr_Stock_Price:  99.78327138708427
curr_Factors:  [99.78327139]
mat_Sqrt:  [[0.15]]
grads:  [-0.07054103]
Stock Position:  -0.07054103179623562
Bond Position:  [-3.47545714]


portfolio before change:  [-10.50043928]
curr_Stock_Price:  99.57485713948554
curr_Factors:  [99.57485714]
mat_Sqrt:  [[0.15]]
grads:  [-0.02782603]
Stock Position:  -0.02782603361903447
Bond Position:  [-7.72966596]


portfolio before change:  [-10.48462237]
curr_Stock_Price:  98.93698077552426
curr_Factors:  [98.93698078]
mat_Sqrt:  [[0.15]]
grads:  [-0.10887618]
Stock Position:  -0.1088761804659263
Bond Position:  [0.28725821]


portfolio before change:  [-10.32574918]
curr_Stock_Price:  97.47843064572166
curr_Factors:  [97.47843065]
mat_Sqrt:  [[0.15]]
grads:  [-0.01868575]
Stock Position:  -0.018685753260857994
Bond Position:  [-8.50429127]


portfolio before change:  [-10.35963159]
curr_Stock_Price:  99.17791120822824
curr_Factors:  [99.17791121]
mat_Sqrt:  [[0.15]]
grads:  [-0.06967517]
Stock Position:  -0.06967516549663948
Bond Position:  [-3.44939421]


portfolio before change:  [-10.33037598]
curr_Stock_Price:  98.74564723833883
curr_Factors:  [98.74564724]
mat_Sqrt:  [[0.15]]
grads:  [0.09158531]
Stock Position:  0.09158530669242541
Bond Position:  [-19.37402637]


portfolio before change:  [-10.36356153]
curr_Stock_Price:  98.43619331720613
curr_Factors:  [98.43619332]
mat_Sqrt:  [[0.15]]
grads:  [-0.21672058]
Stock Position:  -0.2167205842448725
Bond Position:  [10.9695878]


portfolio before change:  [-10.49272157]
curr_Stock_Price:  99.04482392830697
curr_Factors:  [99.04482393]
mat_Sqrt:  [[0.15]]
grads:  [-0.01054544]
Stock Position:  -0.010545442907045136
Bond Position:  [-9.44825003]


portfolio before change:  [-10.51930106]
curr_Stock_Price:  101.34127913160094
curr_Factors:  [101.34127913]
mat_Sqrt:  [[0.15]]
grads:  [0.01571042]
Stock Position:  0.015710416426788287
Bond Position:  [-12.11141476]


portfolio before change:  [-10.51496044]
curr_Stock_Price:  101.81032197945166
curr_Factors:  [101.81032198]
mat_Sqrt:  [[0.15]]
grads:  [-0.02034428]
Stock Position:  -0.02034427940034155
Bond Position:  [-8.4437028]


portfolio before change:  [-10.5235788]
curr_Stock_Price:  102.13017469736788
curr_Factors:  [102.1301747]
mat_Sqrt:  [[0.15]]
grads:  [-0.04355987]
Stock Position:  -0.04355986907042032
Bond Position:  [-6.07480176]


portfolio before change:  [-10.5010031]
curr_Stock_Price:  101.57703734098425
curr_Factors:  [101.57703734]
mat_Sqrt:  [[0.15]]
grads:  [0.04320327]
Stock Position:  0.04320326964694744
Bond Position:  [-14.88946323]


portfolio before change:  [-10.48863664]
curr_Stock_Price:  101.94944637691103
curr_Factors:  [101.94944638]
mat_Sqrt:  [[0.15]]
grads:  [0.00164223]
Stock Position:  0.0016422281906774568
Bond Position:  [-10.6560609]


portfolio before change:  [-10.49230685]
curr_Stock_Price:  101.33695095610548
curr_Factors:  [101.33695096]
mat_Sqrt:  [[0.15]]
grads:  [0.00314292]
Stock Position:  0.003142917303559211
Bond Position:  [-10.8108005]


portfolio before change:  [-10.49148886]
curr_Stock_Price:  102.45725482155456
curr_Factors:  [102.45725482]
mat_Sqrt:  [[0.15]]
grads:  [0.15265436]
Stock Position:  0.15265435863365762
Bond Position:  [-26.13203539]


portfolio before change:  [-10.07144977]
curr_Stock_Price:  105.25162586568271
curr_Factors:  [105.25162587]
mat_Sqrt:  [[0.15]]
grads:  [0.04232668]
Stock Position:  0.042326680222489976
Bond Position:  [-14.52640168]


portfolio before change:  [-9.99322232]
curr_Stock_Price:  107.18561876643903
curr_Factors:  [107.18561877]
mat_Sqrt:  [[0.15]]
grads:  [0.0994146]
Stock Position:  0.09941459947154765
Bond Position:  [-20.64903768]


portfolio before change:  [-9.95042805]
curr_Stock_Price:  107.66801448432558
curr_Factors:  [107.66801448]
mat_Sqrt:  [[0.15]]
grads:  [-0.10903169]
Stock Position:  -0.10903169002548992
Bond Position:  [1.78879753]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.81557287]
Stock Price:  106.43527265915985
PL:  [-16.25084553]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 6.25624039e-04]
 [-6.89248236e-03]
 [-1.48984620e-02]
 [ 1.39723975e-02]
 [-3.82216411e-03]
 [-1.11404983e-02]
 [ 1.36773912e-02]
 [-5.04674000e-02]
 [ 8.48523714e-03]
 [ 2.11713288e-03]
 [-1.85720240e-02]
 [ 1.43415639e-02]
 [ 6.88099566e-03]
 [-1.69209080e-03]
 [ 7.85297412e-03]
 [ 2.07896598e-02]
 [ 7.73805191e-03]
 [ 5.08123121e-03]
 [-4.14656997e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-30.74328703]
curr_Stock_Price:  98.53263985234558
curr_Factors:  [98.53263985]
mat_Sqrt:  [[0.15]]
grads:  [0.00417083]
Stock Position:  0.004170826924124507
Bond Position:  [-31.15424962]


portfolio before change:  [-30.75834617]
curr_Stock_Price:  96.78967688642172
curr_Factors:  [96.78967689]
mat_Sqrt:  [[0.15]]
grads:  [-0.04594988]
Stock Position:  -0.04594988241303005
Bond Position:  [-26.31087189]


portfolio before change:  [-30.74847231]
curr_Stock_Price:  96.43162597309573
curr_Factors:  [96.43162597]
mat_Sqrt:  [[0.15]]
grads:  [-0.09932308]
Stock Position:  -0.09932307975245377
Bond Position:  [-21.17058623]


portfolio before change:  [-30.77286556]
curr_Stock_Price:  96.62392713501603
curr_Factors:  [96.62392714]
mat_Sqrt:  [[0.15]]
grads:  [0.09314932]
Stock Position:  0.09314931644850652
Bond Position:  [-39.77331833]


portfolio before change:  [-30.7310514]
curr_Stock_Price:  97.17958053618291
curr_Factors:  [97.17958054]
mat_Sqrt:  [[0.15]]
grads:  [-0.02548109]
Stock Position:  -0.025481094098233112
Bond Position:  [-28.25480936]


portfolio before change:  [-30.73389598]
curr_Stock_Price:  97.01396751233253
curr_Factors:  [97.01396751]
mat_Sqrt:  [[0.15]]
grads:  [-0.07426999]
Stock Position:  -0.0742699885565538
Bond Position:  [-23.52866973]


portfolio before change:  [-30.59095192]
curr_Stock_Price:  95.01010335451372
curr_Factors:  [95.01010335]
mat_Sqrt:  [[0.15]]
grads:  [0.09118261]
Stock Position:  0.09118260833289515
Bond Position:  [-39.25422096]


portfolio before change:  [-30.59413155]
curr_Stock_Price:  95.08287111529957
curr_Factors:  [95.08287112]
mat_Sqrt:  [[0.15]]
grads:  [-0.33644933]
Stock Position:  -0.33644933324635606
Bond Position:  [1.39643704]


portfolio before change:  [-29.81223535]
curr_Stock_Price:  92.75994471600414
curr_Factors:  [92.75994472]
mat_Sqrt:  [[0.15]]
grads:  [0.05656825]
Stock Position:  0.056568247591000494
Bond Position:  [-35.05950287]


portfolio before change:  [-29.83168102]
curr_Stock_Price:  92.57115166003584
curr_Factors:  [92.57115166]
mat_Sqrt:  [[0.15]]
grads:  [0.01411422]
Stock Position:  0.014114219226685196
Bond Position:  [-31.13825055]


portfolio before change:  [-29.838115]
curr_Stock_Price:  92.66690995020494
curr_Factors:  [92.66690995]
mat_Sqrt:  [[0.15]]
grads:  [-0.12381349]
Stock Position:  -0.12381349354311284
Bond Position:  [-18.36470114]


portfolio before change:  [-30.19540051]
curr_Stock_Price:  95.51549899258653
curr_Factors:  [95.51549899]
mat_Sqrt:  [[0.15]]
grads:  [0.09561043]
Stock Position:  0.09561042617729865
Bond Position:  [-39.32767808]


portfolio before change:  [-30.26362666]
curr_Stock_Price:  94.90476012737564
curr_Factors:  [94.90476013]
mat_Sqrt:  [[0.15]]
grads:  [0.0458733]
Stock Position:  0.0458733044103204
Bond Position:  [-34.61722161]


portfolio before change:  [-30.27855638]
curr_Stock_Price:  94.76798492115317
curr_Factors:  [94.76798492]
mat_Sqrt:  [[0.15]]
grads:  [-0.01128061]
Stock Position:  -0.011280605331496593
Bond Position:  [-29.20951614]


portfolio before change:  [-30.29564591]
curr_Stock_Price:  95.63551274022774
curr_Factors:  [95.63551274]
mat_Sqrt:  [[0.15]]
grads:  [0.05235316]
Stock Position:  0.05235316082681799
Bond Position:  [-35.30246729]


portfolio before change:  [-30.27203019]
curr_Stock_Price:  96.25519727462306
curr_Factors:  [96.25519727]
mat_Sqrt:  [[0.15]]
grads:  [0.13859773]
Stock Position:  0.1385977322853145
Bond Position:  [-43.61278225]


portfolio before change:  [-30.29201114]
curr_Stock_Price:  96.18970993554584
curr_Factors:  [96.18970994]
mat_Sqrt:  [[0.15]]
grads:  [0.05158701]
Stock Position:  0.051587012764166065
Bond Position:  [-35.25415094]


portfolio before change:  [-30.18168153]
curr_Stock_Price:  98.49928840829376
curr_Factors:  [98.49928841]
mat_Sqrt:  [[0.15]]
grads:  [0.03387487]
Stock Position:  0.03387487473645502
Bond Position:  [-33.51833258]


portfolio before change:  [-30.19921121]
curr_Stock_Price:  98.22920462810224
curr_Factors:  [98.22920463]
mat_Sqrt:  [[0.15]]
grads:  [-0.0276438]
Stock Position:  -0.027643799814495367
Bond Position:  [-27.48378274]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-30.22281742]
Stock Price:  98.83456282936527
PL:  [-30.22281742]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.78043730e-03]
 [-6.93607837e-03]
 [-8.82661671e-03]
 [-1.94170574e-02]
 [ 2.94983179e-03]
 [-1.07368033e-02]
 [ 1.41520253e-02]
 [-1.24516193e-02]
 [-6.16310138e-04]
 [ 1.00817169e-02]
 [-5.49081205e-03]
 [-4.22243799e-03]
 [ 4.82819194e-03]
 [-1.11264342e-04]
 [ 3.46323424e-04]
 [ 1.77928484e-02]
 [ 5.06960401e-03]
 [ 8.58491028e-03]
 [-4.14364198e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.86887352]
curr_Stock_Price:  99.61586736519992
curr_Factors:  [99.61586737]
mat_Sqrt:  [[0.15]]
grads:  [0.01853625]
Stock Position:  0.018536248638811453
Bond Position:  [-8.71537801]


portfolio before change:  [-6.85631861]
curr_Stock_Price:  100.41074372085214
curr_Factors:  [100.41074372]
mat_Sqrt:  [[0.15]]
grads:  [-0.04624052]
Stock Position:  -0.04624052245259172
Bond Position:  [-2.21327336]


portfolio before change:  [-6.87216237]
curr_Stock_Price:  100.74141399756188
curr_Factors:  [100.741414]
mat_Sqrt:  [[0.15]]
grads:  [-0.05884411]
Stock Position:  -0.05884411137917173
Bond Position:  [-0.94412338]


portfolio before change:  [-6.78343412]
curr_Stock_Price:  99.22954973602513
curr_Factors:  [99.22954974]
mat_Sqrt:  [[0.15]]
grads:  [-0.12944705]
Stock Position:  -0.129447049028022
Bond Position:  [6.06153827]


portfolio before change:  [-6.72070803]
curr_Stock_Price:  98.75668834081517
curr_Factors:  [98.75668834]
mat_Sqrt:  [[0.15]]
grads:  [0.01966555]
Stock Position:  0.019665545268279273
Bond Position:  [-8.66281216]


portfolio before change:  [-6.73060623]
curr_Stock_Price:  98.36350189013075
curr_Factors:  [98.36350189]
mat_Sqrt:  [[0.15]]
grads:  [-0.07157869]
Stock Position:  -0.07157868889718444
Bond Position:  [0.31012427]


portfolio before change:  [-6.84380973]
curr_Stock_Price:  99.94611027512985
curr_Factors:  [99.94611028]
mat_Sqrt:  [[0.15]]
grads:  [0.09434684]
Stock Position:  0.09434683556309685
Bond Position:  [-16.27340896]


portfolio before change:  [-6.87803394]
curr_Stock_Price:  99.62648796329482
curr_Factors:  [99.62648796]
mat_Sqrt:  [[0.15]]
grads:  [-0.0830108]
Stock Position:  -0.08301079516910174
Bond Position:  [1.39204005]


portfolio before change:  [-6.87230957]
curr_Stock_Price:  99.56172149329467
curr_Factors:  [99.56172149]
mat_Sqrt:  [[0.15]]
grads:  [-0.00410873]
Stock Position:  -0.0041087342544139606
Bond Position:  [-6.46323691]


portfolio before change:  [-6.87092464]
curr_Stock_Price:  98.83134003283295
curr_Factors:  [98.83134003]
mat_Sqrt:  [[0.15]]
grads:  [0.06721145]
Stock Position:  0.06721144594317607
Bond Position:  [-13.51352191]


portfolio before change:  [-6.94537772]
curr_Stock_Price:  97.77386718554897
curr_Factors:  [97.77386719]
mat_Sqrt:  [[0.15]]
grads:  [-0.03660541]
Stock Position:  -0.03660541363724444
Bond Position:  [-3.36632487]


portfolio before change:  [-7.00440035]
curr_Stock_Price:  99.36327533415096
curr_Factors:  [99.36327533]
mat_Sqrt:  [[0.15]]
grads:  [-0.02814959]
Stock Position:  -0.028149586624973758
Bond Position:  [-4.20736522]


portfolio before change:  [-7.01385804]
curr_Stock_Price:  99.66188411658291
curr_Factors:  [99.66188412]
mat_Sqrt:  [[0.15]]
grads:  [0.03218795]
Stock Position:  0.032187946287741936
Bond Position:  [-10.22176941]


portfolio before change:  [-6.97875659]
curr_Stock_Price:  100.8318004511522
curr_Factors:  [100.83180045]
mat_Sqrt:  [[0.15]]
grads:  [-0.00074176]
Stock Position:  -0.0007417622815090097
Bond Position:  [-6.90396337]


portfolio before change:  [-6.98109744]
curr_Stock_Price:  101.66042196778322
curr_Factors:  [101.66042197]
mat_Sqrt:  [[0.15]]
grads:  [0.00230882]
Stock Position:  0.002308822826726133
Bond Position:  [-7.21581334]


portfolio before change:  [-6.98653373]
curr_Stock_Price:  100.08727824560313
curr_Factors:  [100.08727825]
mat_Sqrt:  [[0.15]]
grads:  [0.11861899]
Stock Position:  0.11861898942631031
Bond Position:  [-18.85878553]


portfolio before change:  [-7.09212493]
curr_Stock_Price:  99.23685861912432
curr_Factors:  [99.23685862]
mat_Sqrt:  [[0.15]]
grads:  [0.03379736]
Stock Position:  0.033797360092854396
Bond Position:  [-10.44606878]


portfolio before change:  [-7.07244813]
curr_Stock_Price:  99.89633750926738
curr_Factors:  [99.89633751]
mat_Sqrt:  [[0.15]]
grads:  [0.05723274]
Stock Position:  0.057232735180503584
Bond Position:  [-12.78978876]


portfolio before change:  [-7.16897293]
curr_Stock_Price:  98.26568060554516
curr_Factors:  [98.26568061]
mat_Sqrt:  [[0.15]]
grads:  [-0.02762428]
Stock Position:  -0.027624279850861647
Bond Position:  [-4.45445427]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.16110249]
Stock Price:  97.94045239577993
PL:  [-7.16110249]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.57109598e-02]
 [-2.34459311e-03]
 [-4.63702344e-03]
 [-1.40183300e-02]
 [ 6.48537714e-03]
 [-9.54310573e-03]
 [-9.17373770e-04]
 [ 9.58073478e-03]
 [-1.68077348e-02]
 [ 2.40908976e-03]
 [-2.93789178e-03]
 [-4.70247464e-03]
 [ 4.88176364e-03]
 [-1.92318992e-04]
 [ 4.67843057e-03]
 [ 2.11573550e-02]
 [ 4.83661527e-03]
 [ 8.87419086e-03]
 [-6.44484475e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.41572372]
curr_Stock_Price:  100.89919329549527
curr_Factors:  [100.8991933]
mat_Sqrt:  [[0.15]]
grads:  [-0.10473973]
Stock Position:  -0.10473973186048476
Bond Position:  [31.98387817]


portfolio before change:  [21.66699258]
curr_Stock_Price:  98.57656097369185
curr_Factors:  [98.57656097]
mat_Sqrt:  [[0.15]]
grads:  [-0.01563062]
Stock Position:  -0.015630620722860523
Bond Position:  [23.20780542]


portfolio before change:  [21.6628959]
curr_Stock_Price:  99.20989196267871
curr_Factors:  [99.20989196]
mat_Sqrt:  [[0.15]]
grads:  [-0.03091349]
Stock Position:  -0.03091348959547396
Bond Position:  [24.72981986]


portfolio before change:  [21.69001919]
curr_Stock_Price:  98.53251589825747
curr_Factors:  [98.5325159]
mat_Sqrt:  [[0.15]]
grads:  [-0.09345553]
Stock Position:  -0.09345553334626089
Bond Position:  [30.89842801]


portfolio before change:  [21.55864903]
curr_Stock_Price:  100.02087861023422
curr_Factors:  [100.02087861]
mat_Sqrt:  [[0.15]]
grads:  [0.04323585]
Stock Position:  0.043235847601680186
Bond Position:  [17.23416156]


portfolio before change:  [21.62605204]
curr_Stock_Price:  101.48017549891757
curr_Factors:  [101.4801755]
mat_Sqrt:  [[0.15]]
grads:  [-0.0636207]
Stock Position:  -0.06362070489767543
Bond Position:  [28.08229234]


portfolio before change:  [21.58178405]
curr_Stock_Price:  102.28635087604385
curr_Factors:  [102.28635088]
mat_Sqrt:  [[0.15]]
grads:  [-0.00611583]
Stock Position:  -0.006115825135942932
Bond Position:  [22.20734949]


portfolio before change:  [21.58959713]
curr_Stock_Price:  101.91672727386778
curr_Factors:  [101.91672727]
mat_Sqrt:  [[0.15]]
grads:  [0.06387157]
Stock Position:  0.06387156522014567
Bond Position:  [15.08001624]


portfolio before change:  [21.53266705]
curr_Stock_Price:  100.9663739165975
curr_Factors:  [100.96637392]
mat_Sqrt:  [[0.15]]
grads:  [-0.11205157]
Stock Position:  -0.1120515652929753
Bond Position:  [32.84610729]


portfolio before change:  [21.54986155]
curr_Stock_Price:  100.88621487668847
curr_Factors:  [100.88621488]
mat_Sqrt:  [[0.15]]
grads:  [0.0160606]
Stock Position:  0.016060598407399887
Bond Position:  [19.92956857]


portfolio before change:  [21.54068675]
curr_Stock_Price:  100.00469011584121
curr_Factors:  [100.00469012]
mat_Sqrt:  [[0.15]]
grads:  [-0.01958595]
Stock Position:  -0.019585945209520974
Bond Position:  [23.49937313]


portfolio before change:  [21.54133537]
curr_Stock_Price:  100.27156331900896
curr_Factors:  [100.27156332]
mat_Sqrt:  [[0.15]]
grads:  [-0.03134983]
Stock Position:  -0.03134983090756086
Bond Position:  [24.68483192]


portfolio before change:  [21.54391143]
curr_Stock_Price:  100.38626607341499
curr_Factors:  [100.38626607]
mat_Sqrt:  [[0.15]]
grads:  [0.03254509]
Stock Position:  0.03254509092599537
Bond Position:  [18.27683128]


portfolio before change:  [21.55773617]
curr_Stock_Price:  100.67063956418166
curr_Factors:  [100.67063956]
mat_Sqrt:  [[0.15]]
grads:  [-0.00128213]
Stock Position:  -0.0012821266158419796
Bond Position:  [21.68680868]


portfolio before change:  [21.56427844]
curr_Stock_Price:  99.79718047570275
curr_Factors:  [99.79718048]
mat_Sqrt:  [[0.15]]
grads:  [0.03118954]
Stock Position:  0.03118953711638137
Bond Position:  [18.45165057]


portfolio before change:  [21.60434069]
curr_Stock_Price:  100.93374000127214
curr_Factors:  [100.93374]
mat_Sqrt:  [[0.15]]
grads:  [0.14104903]
Stock Position:  0.14104903342506897
Bond Position:  [7.36773423]


portfolio before change:  [21.40792507]
curr_Stock_Price:  99.52814521389409
curr_Factors:  [99.52814521]
mat_Sqrt:  [[0.15]]
grads:  [0.0322441]
Stock Position:  0.03224410179734808
Bond Position:  [18.19872942]


portfolio before change:  [21.43084092]
curr_Stock_Price:  100.09772544086407
curr_Factors:  [100.09772544]
mat_Sqrt:  [[0.15]]
grads:  [0.05916127]
Stock Position:  0.05916127240067322
Bond Position:  [15.50893212]


portfolio before change:  [21.52988476]
curr_Stock_Price:  101.70631346624658
curr_Factors:  [101.70631347]
mat_Sqrt:  [[0.15]]
grads:  [-0.04296563]
Stock Position:  -0.042965631697667574
Bond Position:  [25.89976076]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.45977951]
Stock Price:  103.48869139384584
PL:  [17.97108812]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.34064261e-02]
 [ 2.18387810e-02]
 [-1.77405527e-02]
 [-1.97004131e-02]
 [ 2.54889029e-03]
 [-1.06456712e-02]
 [ 1.32343056e-02]
 [-4.33255311e-02]
 [ 3.23691715e-03]
 [ 7.83850673e-03]
 [-1.02005686e-02]
 [ 1.00959764e-02]
 [ 6.18704438e-03]
 [-1.27745897e-03]
 [ 8.22765795e-03]
 [ 1.91678276e-02]
 [ 7.60498815e-03]
 [ 7.29129913e-04]
 [-7.98577939e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [49.56422151]
curr_Stock_Price:  102.17634413444165
curr_Factors:  [102.17634413]
mat_Sqrt:  [[0.15]]
grads:  [-0.15604284]
Stock Position:  -0.15604284088204262
Bond Position:  [65.50810852]


portfolio before change:  [49.68577869]
curr_Stock_Price:  101.50231056604788
curr_Factors:  [101.50231057]
mat_Sqrt:  [[0.15]]
grads:  [0.14559187]
Stock Position:  0.14559187304485505
Bond Position:  [34.90786718]


portfolio before change:  [49.64750925]
curr_Stock_Price:  101.17950752042417
curr_Factors:  [101.17950752]
mat_Sqrt:  [[0.15]]
grads:  [-0.11827035]
Stock Position:  -0.11827035137101682
Bond Position:  [61.61404516]


portfolio before change:  [49.89035933]
curr_Stock_Price:  99.25641656490798
curr_Factors:  [99.25641656]
mat_Sqrt:  [[0.15]]
grads:  [-0.13133609]
Stock Position:  -0.131336087443724
Bond Position:  [62.92630874]


portfolio before change:  [49.98266798]
curr_Stock_Price:  98.67336962342189
curr_Factors:  [98.67336962]
mat_Sqrt:  [[0.15]]
grads:  [0.0169926]
Stock Position:  0.016992601956472057
Bond Position:  [48.30595069]


portfolio before change:  [49.99566609]
curr_Stock_Price:  98.72751776009527
curr_Factors:  [98.72751776]
mat_Sqrt:  [[0.15]]
grads:  [-0.07097114]
Stock Position:  -0.07097114151478949
Bond Position:  [57.00247073]


portfolio before change:  [50.06580386]
curr_Stock_Price:  97.94007993517795
curr_Factors:  [97.94007994]
mat_Sqrt:  [[0.15]]
grads:  [0.0882287]
Stock Position:  0.0882287043205223
Bond Position:  [41.4246775]


portfolio before change:  [49.88859571]
curr_Stock_Price:  95.81417761065717
curr_Factors:  [95.81417761]
mat_Sqrt:  [[0.15]]
grads:  [-0.28883687]
Stock Position:  -0.28883687399664343
Bond Position:  [77.56326326]


portfolio before change:  [49.90244631]
curr_Stock_Price:  95.83336713668623
curr_Factors:  [95.83336714]
mat_Sqrt:  [[0.15]]
grads:  [0.02157945]
Stock Position:  0.02157944769436885
Bond Position:  [47.83441518]


portfolio before change:  [49.92206799]
curr_Stock_Price:  96.188407826744
curr_Factors:  [96.18840783]
mat_Sqrt:  [[0.15]]
grads:  [0.05225671]
Stock Position:  0.05225671153367441
Bond Position:  [44.89557811]


portfolio before change:  [49.91889512]
curr_Stock_Price:  95.91288015605407
curr_Factors:  [95.91288016]
mat_Sqrt:  [[0.15]]
grads:  [-0.06800379]
Stock Position:  -0.06800379097842765
Bond Position:  [56.44133457]


portfolio before change:  [49.90517213]
curr_Stock_Price:  96.32219687376134
curr_Factors:  [96.32219687]
mat_Sqrt:  [[0.15]]
grads:  [0.06730651]
Stock Position:  0.06730650956406596
Bond Position:  [43.42206126]


portfolio before change:  [49.91313603]
curr_Stock_Price:  96.2792149293514
curr_Factors:  [96.27921493]
mat_Sqrt:  [[0.15]]
grads:  [0.04124696]
Stock Position:  0.041246962563086326
Bond Position:  [45.94191086]


portfolio before change:  [49.93756516]
curr_Stock_Price:  96.59298874804861
curr_Factors:  [96.59298875]
mat_Sqrt:  [[0.15]]
grads:  [-0.00851639]
Stock Position:  -0.008516393105079454
Bond Position:  [50.76018903]


portfolio before change:  [49.94708245]
curr_Stock_Price:  96.96572283772961
curr_Factors:  [96.96572284]
mat_Sqrt:  [[0.15]]
grads:  [0.05485105]
Stock Position:  0.05485105297874867
Bond Position:  [44.62841045]


portfolio before change:  [49.9745431]
curr_Stock_Price:  97.26293046641548
curr_Factors:  [97.26293047]
mat_Sqrt:  [[0.15]]
grads:  [0.12778552]
Stock Position:  0.1277855173302683
Bond Position:  [37.54574921]


portfolio before change:  [49.85609037]
curr_Stock_Price:  96.26250145874116
curr_Factors:  [96.26250146]
mat_Sqrt:  [[0.15]]
grads:  [0.05069992]
Stock Position:  0.05069992100769435
Bond Position:  [44.97558915]


portfolio before change:  [49.89064059]
curr_Stock_Price:  96.72216530758499
curr_Factors:  [96.72216531]
mat_Sqrt:  [[0.15]]
grads:  [0.00486087]
Stock Position:  0.004860866085125265
Bond Position:  [49.4204871]


portfolio before change:  [49.89923908]
curr_Stock_Price:  95.94901562483727
curr_Factors:  [95.94901562]
mat_Sqrt:  [[0.15]]
grads:  [-0.05323853]
Stock Position:  -0.05323852927084219
Bond Position:  [55.00742356]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [49.92689348]
Stock Price:  95.68791098128001
PL:  [49.92689348]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.70245783e-03]
 [-1.49364804e-03]
 [-9.31765205e-03]
 [-2.24989051e-02]
 [ 5.12482259e-03]
 [-1.00405598e-02]
 [ 5.73832577e-03]
 [-1.44236406e-02]
 [-5.55114696e-03]
 [ 7.96027438e-03]
 [-2.98463679e-03]
 [-6.35068636e-03]
 [ 5.15721648e-03]
 [ 1.70627079e-04]
 [ 2.88271844e-04]
 [ 1.73886325e-02]
 [ 4.68781554e-03]
 [ 8.24754174e-03]
 [-4.34781867e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.29014537]
curr_Stock_Price:  99.36989395853222
curr_Factors:  [99.36989396]
mat_Sqrt:  [[0.15]]
grads:  [0.01801639]
Stock Position:  0.01801638550365263
Bond Position:  [-14.08043169]


portfolio before change:  [-12.30986463]
curr_Stock_Price:  98.4707839963925
curr_Factors:  [98.470784]
mat_Sqrt:  [[0.15]]
grads:  [-0.00995765]
Stock Position:  -0.009957653574763107
Bond Position:  [-11.32932668]


portfolio before change:  [-12.30877154]
curr_Stock_Price:  98.07653691883739
curr_Factors:  [98.07653692]
mat_Sqrt:  [[0.15]]
grads:  [-0.06211768]
Stock Position:  -0.06211768036184072
Bond Position:  [-6.21648457]


portfolio before change:  [-12.40009977]
curr_Stock_Price:  99.52176004719874
curr_Factors:  [99.52176005]
mat_Sqrt:  [[0.15]]
grads:  [-0.1499927]
Stock Position:  -0.14999270053305133
Bond Position:  [2.52743778]


portfolio before change:  [-12.35252876]
curr_Stock_Price:  99.20881771956411
curr_Factors:  [99.20881772]
mat_Sqrt:  [[0.15]]
grads:  [0.03416548]
Stock Position:  0.03416548393805669
Bond Position:  [-15.74204603]


portfolio before change:  [-12.33888247]
curr_Stock_Price:  99.72343943476199
curr_Factors:  [99.72343943]
mat_Sqrt:  [[0.15]]
grads:  [-0.06693707]
Stock Position:  -0.06693706540811477
Bond Position:  [-5.66368808]


portfolio before change:  [-12.43849815]
curr_Stock_Price:  101.19048288796017
curr_Factors:  [101.19048289]
mat_Sqrt:  [[0.15]]
grads:  [0.03825551]
Stock Position:  0.03825550511017472
Bond Position:  [-16.30959119]


portfolio before change:  [-12.50495348]
curr_Stock_Price:  99.55993524428115
curr_Factors:  [99.55993524]
mat_Sqrt:  [[0.15]]
grads:  [-0.0961576]
Stock Position:  -0.09615760407077625
Bond Position:  [-2.93150865]


portfolio before change:  [-12.55276646]
curr_Stock_Price:  100.04954817090035
curr_Factors:  [100.04954817]
mat_Sqrt:  [[0.15]]
grads:  [-0.03700765]
Stock Position:  -0.03700764638005895
Bond Position:  [-8.85016816]


portfolio before change:  [-12.53480734]
curr_Stock_Price:  99.50447349960129
curr_Factors:  [99.5044735]
mat_Sqrt:  [[0.15]]
grads:  [0.0530685]
Stock Position:  0.05306849585704759
Bond Position:  [-17.81536008]


portfolio before change:  [-12.47046057]
curr_Stock_Price:  100.80093334971791
curr_Factors:  [100.80093335]
mat_Sqrt:  [[0.15]]
grads:  [-0.01989758]
Stock Position:  -0.019897578599048747
Bond Position:  [-10.46476607]


portfolio before change:  [-12.48033111]
curr_Stock_Price:  101.16550148483347
curr_Factors:  [101.16550148]
mat_Sqrt:  [[0.15]]
grads:  [-0.04233791]
Stock Position:  -0.04233790907711473
Bond Position:  [-8.1971953]


portfolio before change:  [-12.46491255]
curr_Stock_Price:  100.7529135257794
curr_Factors:  [100.75291353]
mat_Sqrt:  [[0.15]]
grads:  [0.03438144]
Stock Position:  0.03438144319847129
Bond Position:  [-15.92894313]


portfolio before change:  [-12.41225668]
curr_Stock_Price:  102.40027329029326
curr_Factors:  [102.40027329]
mat_Sqrt:  [[0.15]]
grads:  [0.00113751]
Stock Position:  0.0011375138594405382
Bond Position:  [-12.52873841]


portfolio before change:  [-12.416067]
curr_Stock_Price:  101.8044605746431
curr_Factors:  [101.80446057]
mat_Sqrt:  [[0.15]]
grads:  [0.00192181]
Stock Position:  0.0019218122937339373
Bond Position:  [-12.61171606]


portfolio before change:  [-12.4227481]
curr_Stock_Price:  99.96881013819946
curr_Factors:  [99.96881014]
mat_Sqrt:  [[0.15]]
grads:  [0.11592422]
Stock Position:  0.1159242164266385
Bond Position:  [-24.01155408]


portfolio before change:  [-12.45741422]
curr_Stock_Price:  99.7215582830273
curr_Factors:  [99.72155828]
mat_Sqrt:  [[0.15]]
grads:  [0.0312521]
Stock Position:  0.03125210357589725
Bond Position:  [-15.57392268]


portfolio before change:  [-12.46298789]
curr_Stock_Price:  99.6678112352703
curr_Factors:  [99.66781124]
mat_Sqrt:  [[0.15]]
grads:  [0.05498361]
Stock Position:  0.05498361157043219
Bond Position:  [-17.94308411]


portfolio before change:  [-12.50174551]
curr_Stock_Price:  99.04451123081799
curr_Factors:  [99.04451123]
mat_Sqrt:  [[0.15]]
grads:  [-0.02898546]
Stock Position:  -0.02898545781904061
Bond Position:  [-9.63089501]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.53335452]
Stock Price:  100.05194682178198
PL:  [-12.58530134]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 8.84418441e-04]
 [-6.19322353e-03]
 [-5.40342117e-03]
 [-7.65618250e-03]
 [-1.93727563e-03]
 [-9.93152265e-03]
 [ 1.18659295e-02]
 [ 8.68328329e-03]
 [-2.37347458e-03]
 [ 9.31284956e-03]
 [-7.00215697e-03]
 [ 3.87861795e-03]
 [ 5.53971952e-03]
 [-1.04806387e-03]
 [ 8.05872132e-03]
 [ 1.88936584e-02]
 [ 7.73491706e-03]
 [ 5.24479906e-04]
 [-6.15907595e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-22.67306772]
curr_Stock_Price:  98.89880103967509
curr_Factors:  [98.89880104]
mat_Sqrt:  [[0.15]]
grads:  [0.00589612]
Stock Position:  0.005896122939364028
Bond Position:  [-23.25618721]


portfolio before change:  [-22.67717534]
curr_Stock_Price:  99.18833845430244
curr_Factors:  [99.18833845]
mat_Sqrt:  [[0.15]]
grads:  [-0.04128816]
Stock Position:  -0.04128815684905663
Bond Position:  [-18.58187167]


portfolio before change:  [-22.67479046]
curr_Stock_Price:  99.01804915372223
curr_Factors:  [99.01804915]
mat_Sqrt:  [[0.15]]
grads:  [-0.03602281]
Stock Position:  -0.036022807819721434
Bond Position:  [-19.1078823]


portfolio before change:  [-22.64032316]
curr_Stock_Price:  97.92860411857497
curr_Factors:  [97.92860412]
mat_Sqrt:  [[0.15]]
grads:  [-0.05104122]
Stock Position:  -0.0510412166491906
Bond Position:  [-17.64192806]


portfolio before change:  [-22.63188326]
curr_Stock_Price:  97.67682862840587
curr_Factors:  [97.67682863]
mat_Sqrt:  [[0.15]]
grads:  [-0.01291517]
Stock Position:  -0.012915170888148631
Bond Position:  [-21.37037033]


portfolio before change:  [-22.66552933]
curr_Stock_Price:  99.86826698759806
curr_Factors:  [99.86826699]
mat_Sqrt:  [[0.15]]
grads:  [-0.06621015]
Stock Position:  -0.06621015098654406
Bond Position:  [-16.05323629]


portfolio before change:  [-22.70199143]
curr_Stock_Price:  100.35834735849954
curr_Factors:  [100.35834736]
mat_Sqrt:  [[0.15]]
grads:  [0.0791062]
Stock Position:  0.07910619671565466
Bond Position:  [-30.6409586]


portfolio before change:  [-22.71043259]
curr_Stock_Price:  100.34848768566
curr_Factors:  [100.34848769]
mat_Sqrt:  [[0.15]]
grads:  [0.05788856]
Stock Position:  0.057888555245785143
Bond Position:  [-28.51946156]


portfolio before change:  [-22.81672435]
curr_Stock_Price:  98.63552386379803
curr_Factors:  [98.63552386]
mat_Sqrt:  [[0.15]]
grads:  [-0.01582316]
Stock Position:  -0.015823163847450094
Bond Position:  [-21.25599829]


portfolio before change:  [-22.79806717]
curr_Stock_Price:  97.12053983369701
curr_Factors:  [97.12053983]
mat_Sqrt:  [[0.15]]
grads:  [0.06208566]
Stock Position:  0.06208566371890437
Bond Position:  [-28.82786035]


portfolio before change:  [-22.80149132]
curr_Stock_Price:  97.18148339292158
curr_Factors:  [97.18148339]
mat_Sqrt:  [[0.15]]
grads:  [-0.04668105]
Stock Position:  -0.04668104647889397
Bond Position:  [-18.26495797]


portfolio before change:  [-22.82266083]
curr_Stock_Price:  97.53714590709943
curr_Factors:  [97.53714591]
mat_Sqrt:  [[0.15]]
grads:  [0.02585745]
Stock Position:  0.025857452993823783
Bond Position:  [-25.34472299]


portfolio before change:  [-22.8225632]
curr_Stock_Price:  97.78599479184473
curr_Factors:  [97.78599479]
mat_Sqrt:  [[0.15]]
grads:  [0.03693146]
Stock Position:  0.03693146344101784
Bond Position:  [-26.43394309]


portfolio before change:  [-22.83106734]
curr_Stock_Price:  97.7346881879817
curr_Factors:  [97.73468819]
mat_Sqrt:  [[0.15]]
grads:  [-0.00698709]
Stock Position:  -0.0069870924340576
Bond Position:  [-22.14818604]


portfolio before change:  [-22.83661192]
curr_Stock_Price:  97.73566777864605
curr_Factors:  [97.73566778]
mat_Sqrt:  [[0.15]]
grads:  [0.05372481]
Stock Position:  0.05372480881580779
Bond Position:  [-28.08744199]


portfolio before change:  [-22.86019163]
curr_Stock_Price:  97.42748662034668
curr_Factors:  [97.42748662]
mat_Sqrt:  [[0.15]]
grads:  [0.12595772]
Stock Position:  0.12595772243608175
Bond Position:  [-35.13193595]


portfolio before change:  [-23.02466724]
curr_Stock_Price:  96.19142483661463
curr_Factors:  [96.19142484]
mat_Sqrt:  [[0.15]]
grads:  [0.05156611]
Stock Position:  0.05156611370154837
Bond Position:  [-27.98488519]


portfolio before change:  [-23.05957733]
curr_Stock_Price:  95.6501200004352
curr_Factors:  [95.65012]
mat_Sqrt:  [[0.15]]
grads:  [0.00349653]
Stock Position:  0.0034965327074121142
Bond Position:  [-23.3940211]


portfolio before change:  [-23.06124022]
curr_Stock_Price:  96.84740454477932
curr_Factors:  [96.84740454]
mat_Sqrt:  [[0.15]]
grads:  [-0.04106051]
Stock Position:  -0.04106050633799684
Bond Position:  [-19.08463675]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-23.10080645]
Stock Price:  97.69479964825486
PL:  [-23.10080645]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 3.30601096]
 [-0.01961083]
 [ 0.07191502]
 [-0.07432047]
 [ 0.08170658]
 [ 0.00355621]
 [-0.02244317]
 [-0.01999138]
 [-0.00964905]
 [ 0.05094399]
 [-0.00426772]
 [-0.00600378]
 [ 0.03063735]
 [ 0.01683622]
 [-0.00873441]
 [ 0.02793171]
 [ 0.01703064]
 [ 0.0136337 ]
 [ 0.01600287]
 [-0.01869778]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [34.31545995]
curr_Stock_Price:  101.48447884337644
curr_Factors:  [101.48447884]
mat_Sqrt:  [[0.15]]
grads:  [-0.13073885]
Stock Position:  -0.130738852279244
Bond Position:  [47.58342424]


portfolio before change:  [34.055442]
curr_Stock_Price:  103.56431425019457
curr_Factors:  [103.56431425]
mat_Sqrt:  [[0.15]]
grads:  [0.47943347]
Stock Position:  0.4794334710954756
Bond Position:  [-15.59675666]


portfolio before change:  [34.65187656]
curr_Stock_Price:  104.81648846815438
curr_Factors:  [104.81648847]
mat_Sqrt:  [[0.15]]
grads:  [-0.49546977]
Stock Position:  -0.4954697718656127
Bond Position:  [86.58527819]


portfolio before change:  [34.74349594]
curr_Stock_Price:  104.67526824328681
curr_Factors:  [104.67526824]
mat_Sqrt:  [[0.15]]
grads:  [0.54471053]
Stock Position:  0.5447105260324119
Bond Position:  [-22.27422449]


portfolio before change:  [35.2510525]
curr_Stock_Price:  105.61728385855598
curr_Factors:  [105.61728386]
mat_Sqrt:  [[0.15]]
grads:  [0.02370804]
Stock Position:  0.02370804319621884
Bond Position:  [32.74707338]


portfolio before change:  [35.2891355]
curr_Stock_Price:  106.87825699336751
curr_Factors:  [106.87825699]
mat_Sqrt:  [[0.15]]
grads:  [-0.14962116]
Stock Position:  -0.14962116026487016
Bond Position:  [51.28038432]


portfolio before change:  [35.1614543]
curr_Stock_Price:  107.8173146652443
curr_Factors:  [107.81731467]
mat_Sqrt:  [[0.15]]
grads:  [-0.13327586]
Stock Position:  -0.13327586158863647
Bond Position:  [49.53089981]


portfolio before change:  [35.1558359]
curr_Stock_Price:  107.95239292234602
curr_Factors:  [107.95239292]
mat_Sqrt:  [[0.15]]
grads:  [-0.06432699]
Stock Position:  -0.06432699167226696
Bond Position:  [42.10008858]


portfolio before change:  [35.15810769]
curr_Stock_Price:  108.08071460653355
curr_Factors:  [108.08071461]
mat_Sqrt:  [[0.15]]
grads:  [0.33962659]
Stock Position:  0.33962658671821905
Bond Position:  [-1.5489765]


portfolio before change:  [34.95645331]
curr_Stock_Price:  107.4881017074686
curr_Factors:  [107.48810171]
mat_Sqrt:  [[0.15]]
grads:  [-0.02845145]
Stock Position:  -0.02845144543147663
Bond Position:  [38.01464517]


portfolio before change:  [34.92579469]
curr_Stock_Price:  108.89975106552455
curr_Factors:  [108.89975107]
mat_Sqrt:  [[0.15]]
grads:  [-0.04002517]
Stock Position:  -0.04002517235509172
Bond Position:  [39.284526]


portfolio before change:  [34.9560166]
curr_Stock_Price:  108.39008307484352
curr_Factors:  [108.39008307]
mat_Sqrt:  [[0.15]]
grads:  [0.20424901]
Stock Position:  0.20424901338098003
Bond Position:  [12.81744907]


portfolio before change:  [35.02129651]
curr_Stock_Price:  108.69400204896618
curr_Factors:  [108.69400205]
mat_Sqrt:  [[0.15]]
grads:  [0.11224146]
Stock Position:  0.11224146058541891
Bond Position:  [22.82132297]


portfolio before change:  [35.20170329]
curr_Stock_Price:  110.25047444136368
curr_Factors:  [110.25047444]
mat_Sqrt:  [[0.15]]
grads:  [-0.05822943]
Stock Position:  -0.05822942632092908
Bond Position:  [41.62152517]


portfolio before change:  [35.27848763]
curr_Stock_Price:  109.11054122515415
curr_Factors:  [109.11054123]
mat_Sqrt:  [[0.15]]
grads:  [0.1862114]
Stock Position:  0.18621140178741677
Bond Position:  [14.9608608]


portfolio before change:  [35.57672011]
curr_Stock_Price:  110.69203297393136
curr_Factors:  [110.69203297]
mat_Sqrt:  [[0.15]]
grads:  [0.11353763]
Stock Position:  0.1135376308201286
Bond Position:  [23.00900893]


portfolio before change:  [35.51489003]
curr_Stock_Price:  110.09678494440752
curr_Factors:  [110.09678494]
mat_Sqrt:  [[0.15]]
grads:  [0.09089131]
Stock Position:  0.09089131164854468
Bond Position:  [25.50804884]


portfolio before change:  [35.46749977]
curr_Stock_Price:  109.50522053530983
curr_Factors:  [109.50522054]
mat_Sqrt:  [[0.15]]
grads:  [0.10668578]
Stock Position:  0.10668577680773679
Bond Position:  [23.78485026]


portfolio before change:  [35.49331313]
curr_Stock_Price:  109.69143467625614
curr_Factors:  [109.69143468]
mat_Sqrt:  [[0.15]]
grads:  [-0.12465189]
Stock Position:  -0.12465189259914605
Bond Position:  [49.16655806]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [35.66180382]
Stock Price:  108.43836489616429
PL:  [27.22343893]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 5.85310775e-04]
 [-5.66458793e-03]
 [-7.12346993e-03]
 [ 4.38750731e-03]
 [-5.69416921e-03]
 [-1.19986933e-02]
 [ 1.49050902e-02]
 [-7.96135134e-02]
 [ 8.49240733e-03]
 [ 9.06039972e-04]
 [-2.10748250e-02]
 [ 3.68458353e-02]
 [ 1.04893059e-02]
 [-2.90604924e-03]
 [ 5.13746705e-03]
 [ 2.45221609e-02]
 [ 2.14849120e-02]
 [-7.98719443e-04]
 [-1.09160406e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-24.11313605]
curr_Stock_Price:  98.83346240278243
curr_Factors:  [98.8334624]
mat_Sqrt:  [[0.15]]
grads:  [0.00390207]
Stock Position:  0.0039020718364306726
Bond Position:  [-24.49879132]


portfolio before change:  [-24.1181883]
curr_Stock_Price:  99.10849747120334
curr_Factors:  [99.10849747]
mat_Sqrt:  [[0.15]]
grads:  [-0.03776392]
Stock Position:  -0.03776391950792612
Bond Position:  [-20.37546298]


portfolio before change:  [-24.10089625]
curr_Stock_Price:  98.51569478353429
curr_Factors:  [98.51569478]
mat_Sqrt:  [[0.15]]
grads:  [-0.0474898]
Stock Position:  -0.04748979953859514
Bond Position:  [-19.42240566]


portfolio before change:  [-24.04503757]
curr_Stock_Price:  97.23721200330027
curr_Factors:  [97.237212]
mat_Sqrt:  [[0.15]]
grads:  [0.02925005]
Stock Position:  0.02925004873567647
Bond Position:  [-26.88923076]


portfolio before change:  [-24.06979316]
curr_Stock_Price:  96.62071944335003
curr_Factors:  [96.62071944]
mat_Sqrt:  [[0.15]]
grads:  [-0.03796113]
Stock Position:  -0.03796112805382833
Bond Position:  [-20.40196165]


portfolio before change:  [-23.99717384]
curr_Stock_Price:  94.57335027335482
curr_Factors:  [94.57335027]
mat_Sqrt:  [[0.15]]
grads:  [-0.07999129]
Stock Position:  -0.0799912888815771
Bond Position:  [-16.43212966]


portfolio before change:  [-23.87523753]
curr_Stock_Price:  92.99761803005961
curr_Factors:  [92.99761803]
mat_Sqrt:  [[0.15]]
grads:  [0.09936727]
Stock Position:  0.09936726780227957
Bond Position:  [-33.11615675]


portfolio before change:  [-23.97287101]
curr_Stock_Price:  92.09839431133385
curr_Factors:  [92.09839431]
mat_Sqrt:  [[0.15]]
grads:  [-0.53075676]
Stock Position:  -0.5307567558011733
Bond Position:  [24.90897397]


portfolio before change:  [-24.31553676]
curr_Stock_Price:  92.75574584595668
curr_Factors:  [92.75574585]
mat_Sqrt:  [[0.15]]
grads:  [0.05661605]
Stock Position:  0.05661604883787558
Bond Position:  [-29.5670006]


portfolio before change:  [-24.37673111]
curr_Stock_Price:  91.80545561874459
curr_Factors:  [91.80545562]
mat_Sqrt:  [[0.15]]
grads:  [0.00604027]
Stock Position:  0.006040266479506538
Bond Position:  [-24.93126053]


portfolio before change:  [-24.38362302]
curr_Stock_Price:  91.69646730135184
curr_Factors:  [91.6964673]
mat_Sqrt:  [[0.15]]
grads:  [-0.14049883]
Stock Position:  -0.14049883325787102
Bond Position:  [-11.50037635]


portfolio before change:  [-24.29004735]
curr_Stock_Price:  91.0099767109556
curr_Factors:  [91.00997671]
mat_Sqrt:  [[0.15]]
grads:  [0.2456389]
Stock Position:  0.24563890182160367
Bond Position:  [-46.64563808]


portfolio before change:  [-24.47001459]
curr_Stock_Price:  90.3248068552551
curr_Factors:  [90.32480686]
mat_Sqrt:  [[0.15]]
grads:  [0.06992871]
Stock Position:  0.06992870631865238
Bond Position:  [-30.78631148]


portfolio before change:  [-24.53542345]
curr_Stock_Price:  89.4995188077013
curr_Factors:  [89.49951881]
mat_Sqrt:  [[0.15]]
grads:  [-0.01937366]
Stock Position:  -0.019373661600792746
Bond Position:  [-22.80149006]


portfolio before change:  [-24.54697459]
curr_Stock_Price:  89.8014776563804
curr_Factors:  [89.80147766]
mat_Sqrt:  [[0.15]]
grads:  [0.03424978]
Stock Position:  0.034249780312021263
Bond Position:  [-27.62265547]


portfolio before change:  [-24.57171487]
curr_Stock_Price:  89.28078067033147
curr_Factors:  [89.28078067]
mat_Sqrt:  [[0.15]]
grads:  [0.16348107]
Stock Position:  0.16348107255993405
Bond Position:  [-39.16743266]


portfolio before change:  [-24.64812763]
curr_Stock_Price:  88.87327371131498
curr_Factors:  [88.87327371]
mat_Sqrt:  [[0.15]]
grads:  [0.14323275]
Stock Position:  0.143232746387865
Bond Position:  [-37.3776907]


portfolio before change:  [-24.34720184]
curr_Stock_Price:  91.03947790931433
curr_Factors:  [91.03947791]
mat_Sqrt:  [[0.15]]
grads:  [-0.0053248]
Stock Position:  -0.005324796285720799
Bond Position:  [-23.86243517]


portfolio before change:  [-24.35733218]
curr_Stock_Price:  91.82147704277997
curr_Factors:  [91.82147704]
mat_Sqrt:  [[0.15]]
grads:  [-0.0727736]
Stock Position:  -0.07277360380035344
Bond Position:  [-17.67515239]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-24.40343419]
Stock Price:  92.39424874537607
PL:  [-24.40343419]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.10456201e-02]
 [ 1.88104476e-02]
 [-5.68335368e-03]
 [ 2.01176238e-03]
 [ 6.19383981e-03]
 [-1.07748537e-02]
 [ 1.43898062e-02]
 [-2.32404642e-02]
 [-6.20080753e-04]
 [ 2.35651909e-03]
 [-2.97310613e-03]
 [-6.67756118e-03]
 [ 6.33531820e-03]
 [-4.06911467e-04]
 [ 6.07217465e-04]
 [ 1.79593726e-02]
 [ 6.20515859e-03]
 [ 8.43595623e-03]
 [-4.29536343e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [40.34750351]
curr_Stock_Price:  101.75816412322389
curr_Factors:  [101.75816412]
mat_Sqrt:  [[0.15]]
grads:  [-0.14030413]
Stock Position:  -0.14030413424097413
Bond Position:  [54.62459463]


portfolio before change:  [40.41673906]
curr_Stock_Price:  101.36204117479215
curr_Factors:  [101.36204117]
mat_Sqrt:  [[0.15]]
grads:  [0.12540298]
Stock Position:  0.1254029841977201
Bond Position:  [27.70563661]


portfolio before change:  [40.32405324]
curr_Stock_Price:  100.56769730656657
curr_Factors:  [100.56769731]
mat_Sqrt:  [[0.15]]
grads:  [-0.03788902]
Stock Position:  -0.037889024521295264
Bond Position:  [44.13446519]


portfolio before change:  [40.32624602]
curr_Stock_Price:  100.801068822596
curr_Factors:  [100.80106882]
mat_Sqrt:  [[0.15]]
grads:  [0.01341175]
Stock Position:  0.013411749171624895
Bond Position:  [38.97432736]


portfolio before change:  [40.32021525]
curr_Stock_Price:  99.62481925849008
curr_Factors:  [99.62481926]
mat_Sqrt:  [[0.15]]
grads:  [0.04129227]
Stock Position:  0.041292265389123894
Bond Position:  [36.20648078]


portfolio before change:  [40.27067312]
curr_Stock_Price:  98.20579116081984
curr_Factors:  [98.20579116]
mat_Sqrt:  [[0.15]]
grads:  [-0.07183236]
Stock Position:  -0.07183235779564873
Bond Position:  [47.32502665]


portfolio before change:  [40.19550726]
curr_Stock_Price:  99.41692491951046
curr_Factors:  [99.41692492]
mat_Sqrt:  [[0.15]]
grads:  [0.09593204]
Stock Position:  0.0959320414500708
Bond Position:  [30.6582387]


portfolio before change:  [40.16991111]
curr_Stock_Price:  99.07020375713732
curr_Factors:  [99.07020376]
mat_Sqrt:  [[0.15]]
grads:  [-0.15493643]
Stock Position:  -0.15493642821812187
Bond Position:  [55.51949462]


portfolio before change:  [40.10866125]
curr_Stock_Price:  99.55512178974544
curr_Factors:  [99.55512179]
mat_Sqrt:  [[0.15]]
grads:  [-0.00413387]
Stock Position:  -0.004133871684920071
Bond Position:  [40.52020935]


portfolio before change:  [40.11272124]
curr_Stock_Price:  101.02380061690504
curr_Factors:  [101.02380062]
mat_Sqrt:  [[0.15]]
grads:  [0.01571013]
Stock Position:  0.01571012728058785
Bond Position:  [38.52562447]


portfolio before change:  [40.11785965]
curr_Stock_Price:  100.737730580106
curr_Factors:  [100.73773058]
mat_Sqrt:  [[0.15]]
grads:  [-0.01982071]
Stock Position:  -0.0198207075532123
Bond Position:  [42.11455275]


portfolio before change:  [40.11197071]
curr_Stock_Price:  101.56610137411845
curr_Factors:  [101.56610137]
mat_Sqrt:  [[0.15]]
grads:  [-0.04451707]
Stock Position:  -0.04451707454763322
Bond Position:  [44.63339642]


portfolio before change:  [40.12699146]
curr_Stock_Price:  101.47937049364064
curr_Factors:  [101.47937049]
mat_Sqrt:  [[0.15]]
grads:  [0.04223545]
Stock Position:  0.04223545465592716
Bond Position:  [35.84096411]


portfolio before change:  [40.08377493]
curr_Stock_Price:  100.2439655421979
curr_Factors:  [100.24396554]
mat_Sqrt:  [[0.15]]
grads:  [-0.00271274]
Stock Position:  -0.0027127431146736843
Bond Position:  [40.35571106]


portfolio before change:  [40.09117292]
curr_Stock_Price:  101.23639373979147
curr_Factors:  [101.23639374]
mat_Sqrt:  [[0.15]]
grads:  [0.00404812]
Stock Position:  0.004048116436438237
Bond Position:  [39.68135621]


portfolio before change:  [40.09664031]
curr_Stock_Price:  100.13608337318357
curr_Factors:  [100.13608337]
mat_Sqrt:  [[0.15]]
grads:  [0.11972915]
Stock Position:  0.11972915099579623
Bond Position:  [28.10743207]


portfolio before change:  [39.86158224]
curr_Stock_Price:  98.11413791256163
curr_Factors:  [98.11413791]
mat_Sqrt:  [[0.15]]
grads:  [0.04136772]
Stock Position:  0.041367723961851316
Bond Position:  [35.80282366]


portfolio before change:  [39.9381233]
curr_Stock_Price:  99.74800197641692
curr_Factors:  [99.74800198]
mat_Sqrt:  [[0.15]]
grads:  [0.05623971]
Stock Position:  0.05623970822891571
Bond Position:  [34.32832477]


portfolio before change:  [39.89742539]
curr_Stock_Price:  98.87173386869563
curr_Factors:  [98.87173387]
mat_Sqrt:  [[0.15]]
grads:  [-0.02863576]
Stock Position:  -0.028635756215681485
Bond Position:  [42.72869226]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [39.94763185]
Stock Price:  97.49153791005045
PL:  [39.94763185]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.12788190e-02]
 [ 2.45858291e-02]
 [-3.76866392e-02]
 [ 4.74746121e-02]
 [ 5.71466736e-03]
 [-1.02711327e-02]
 [ 3.69014420e-03]
 [ 4.88451977e-03]
 [-1.67295677e-02]
 [ 1.75986330e-03]
 [-3.21324740e-03]
 [ 3.86973576e-03]
 [ 1.00445649e-02]
 [-1.13237665e-03]
 [ 2.30202827e-03]
 [ 2.27586981e-02]
 [ 6.60034552e-03]
 [ 1.43604206e-02]
 [-1.59664651e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [41.32790009]
curr_Stock_Price:  101.80264657929968
curr_Factors:  [101.80264658]
mat_Sqrt:  [[0.15]]
grads:  [-0.14185879]
Stock Position:  -0.14185879306278618
Bond Position:  [55.76950067]


portfolio before change:  [41.36557495]
curr_Stock_Price:  101.6353623391642
curr_Factors:  [101.63536234]
mat_Sqrt:  [[0.15]]
grads:  [0.16390553]
Stock Position:  0.16390552730289412
Bond Position:  [24.7069773]


portfolio before change:  [41.49303894]
curr_Stock_Price:  102.37534024833312
curr_Factors:  [102.37534025]
mat_Sqrt:  [[0.15]]
grads:  [-0.25124426]
Stock Position:  -0.2512442616454313
Bond Position:  [67.21425571]


portfolio before change:  [41.42809631]
curr_Stock_Price:  102.70071402814145
curr_Factors:  [102.70071403]
mat_Sqrt:  [[0.15]]
grads:  [0.31649741]
Stock Position:  0.31649741409789883
Bond Position:  [8.92358589]


portfolio before change:  [41.10132372]
curr_Stock_Price:  101.66119917269985
curr_Factors:  [101.66119917]
mat_Sqrt:  [[0.15]]
grads:  [0.03809778]
Stock Position:  0.03809778237153868
Bond Position:  [37.22825748]


portfolio before change:  [41.12227552]
curr_Stock_Price:  101.9668225551777
curr_Factors:  [101.96682256]
mat_Sqrt:  [[0.15]]
grads:  [-0.06847422]
Stock Position:  -0.0684742177882693
Bond Position:  [48.10437394]


portfolio before change:  [41.16905255]
curr_Stock_Price:  101.4593406206622
curr_Factors:  [101.45934062]
mat_Sqrt:  [[0.15]]
grads:  [0.02460096]
Stock Position:  0.024600961356566465
Bond Position:  [38.67305523]


portfolio before change:  [41.21620861]
curr_Stock_Price:  102.98312637210444
curr_Factors:  [102.98312637]
mat_Sqrt:  [[0.15]]
grads:  [0.03256347]
Stock Position:  0.03256346515925316
Bond Position:  [37.86272117]


portfolio before change:  [41.19282661]
curr_Stock_Price:  101.9743618450472
curr_Factors:  [101.97436185]
mat_Sqrt:  [[0.15]]
grads:  [-0.11153045]
Stock Position:  -0.11153045125977297
Bond Position:  [52.5660732]


portfolio before change:  [41.07206568]
curr_Stock_Price:  103.17496745819301
curr_Factors:  [103.17496746]
mat_Sqrt:  [[0.15]]
grads:  [0.01173242]
Stock Position:  0.011732422023363364
Bond Position:  [39.86157342]


portfolio before change:  [41.08194018]
curr_Stock_Price:  103.16711363819303
curr_Factors:  [103.16711364]
mat_Sqrt:  [[0.15]]
grads:  [-0.02142165]
Stock Position:  -0.021421649357618935
Bond Position:  [43.29194991]


portfolio before change:  [41.07258472]
curr_Stock_Price:  104.10914201963301
curr_Factors:  [104.10914202]
mat_Sqrt:  [[0.15]]
grads:  [0.02579824]
Stock Position:  0.02579823842665762
Bond Position:  [38.38675225]


portfolio before change:  [41.08003154]
curr_Stock_Price:  104.02576169623052
curr_Factors:  [104.0257617]
mat_Sqrt:  [[0.15]]
grads:  [0.06696377]
Stock Position:  0.06696376622024383
Bond Position:  [34.11407475]


portfolio before change:  [41.09234118]
curr_Stock_Price:  104.08221101465865
curr_Factors:  [104.08221101]
mat_Sqrt:  [[0.15]]
grads:  [-0.00754918]
Stock Position:  -0.007549177674208121
Bond Position:  [41.87807629]


portfolio before change:  [41.10810467]
curr_Stock_Price:  103.38112073918376
curr_Factors:  [103.38112074]
mat_Sqrt:  [[0.15]]
grads:  [0.01534686]
Stock Position:  0.015346855134071268
Bond Position:  [39.52152958]


portfolio before change:  [41.10063942]
curr_Stock_Price:  102.25080003722374
curr_Factors:  [102.25080004]
mat_Sqrt:  [[0.15]]
grads:  [0.15172465]
Stock Position:  0.15172465414312186
Bond Position:  [25.58667214]


portfolio before change:  [41.58297606]
curr_Stock_Price:  105.3876611902948
curr_Factors:  [105.38766119]
mat_Sqrt:  [[0.15]]
grads:  [0.0440023]
Stock Position:  0.044002303473898545
Bond Position:  [36.94567621]


portfolio before change:  [41.62049941]
curr_Stock_Price:  106.03048615480762
curr_Factors:  [106.03048615]
mat_Sqrt:  [[0.15]]
grads:  [0.09573614]
Stock Position:  0.0957361371172475
Bond Position:  [31.46955025]


portfolio before change:  [41.6481326]
curr_Stock_Price:  106.23693718857986
curr_Factors:  [106.23693719]
mat_Sqrt:  [[0.15]]
grads:  [-0.1064431]
Stock Position:  -0.10644310045101617
Bond Position:  [52.95632158]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [41.57854546]
Stock Price:  107.01507953891712
PL:  [34.56346592]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-3.76960771e-03]
 [ 1.84926165e-03]
 [-4.74921597e-03]
 [-2.01093617e-02]
 [ 1.06379592e-03]
 [-1.03184338e-02]
 [ 1.46517996e-02]
 [-2.18620030e-02]
 [-1.10572599e-02]
 [ 4.84837116e-03]
 [-3.12578781e-03]
 [-2.92687611e-03]
 [ 4.84962498e-03]
 [-6.69545007e-04]
 [ 7.76924197e-03]
 [ 1.89139926e-02]
 [ 1.05074618e-02]
 [ 2.43092435e-04]
 [-9.12559221e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.43285173]
curr_Stock_Price:  100.26476381962527
curr_Factors:  [100.26476382]
mat_Sqrt:  [[0.15]]
grads:  [-0.02513072]
Stock Position:  -0.025130718066151567
Bond Position:  [9.95257724]


portfolio before change:  [7.42402425]
curr_Stock_Price:  100.71504696942196
curr_Factors:  [100.71504697]
mat_Sqrt:  [[0.15]]
grads:  [0.01232841]
Stock Position:  0.012328411017053847
Bond Position:  [6.18236775]


portfolio before change:  [7.41539671]
curr_Stock_Price:  99.88985310317567
curr_Factors:  [99.8898531]
mat_Sqrt:  [[0.15]]
grads:  [-0.03166144]
Stock Position:  -0.03166143979058114
Bond Position:  [10.57805327]


portfolio before change:  [7.41775182]
curr_Stock_Price:  99.89900402864704
curr_Factors:  [99.89900403]
mat_Sqrt:  [[0.15]]
grads:  [-0.13406241]
Stock Position:  -0.13406241151117435
Bond Position:  [20.81045321]


portfolio before change:  [7.62974406]
curr_Stock_Price:  98.3565211088569
curr_Factors:  [98.35652111]
mat_Sqrt:  [[0.15]]
grads:  [0.00709197]
Stock Position:  0.007091972786938663
Bond Position:  [6.93220229]


portfolio before change:  [7.63855395]
curr_Stock_Price:  99.35435598222769
curr_Factors:  [99.35435598]
mat_Sqrt:  [[0.15]]
grads:  [-0.06878956]
Stock Position:  -0.06878955879874714
Bond Position:  [14.47309626]


portfolio before change:  [7.60936644]
curr_Stock_Price:  99.83126315222489
curr_Factors:  [99.83126315]
mat_Sqrt:  [[0.15]]
grads:  [0.09767866]
Stock Position:  0.09767866399758937
Bond Position:  [-2.14201797]


portfolio before change:  [7.54336584]
curr_Stock_Price:  99.16105505096039
curr_Factors:  [99.16105505]
mat_Sqrt:  [[0.15]]
grads:  [-0.14574669]
Stock Position:  -0.14574668691119874
Bond Position:  [21.99576108]


portfolio before change:  [7.38901931]
curr_Stock_Price:  100.25779459296672
curr_Factors:  [100.25779459]
mat_Sqrt:  [[0.15]]
grads:  [-0.07371507]
Stock Position:  -0.07371506568149916
Bond Position:  [14.77952922]


portfolio before change:  [7.40495538]
curr_Stock_Price:  100.09173995213114
curr_Factors:  [100.09173995]
mat_Sqrt:  [[0.15]]
grads:  [0.03232247]
Stock Position:  0.032322474400324014
Bond Position:  [4.16974268]


portfolio before change:  [7.38936054]
curr_Stock_Price:  99.57700824298094
curr_Factors:  [99.57700824]
mat_Sqrt:  [[0.15]]
grads:  [-0.02083859]
Stock Position:  -0.020838585377567716
Bond Position:  [9.46440453]


portfolio before change:  [7.40027107]
curr_Stock_Price:  99.1669933366982
curr_Factors:  [99.16699334]
mat_Sqrt:  [[0.15]]
grads:  [-0.01951251]
Stock Position:  -0.019512507422753296
Bond Position:  [9.33526777]


portfolio before change:  [7.39625229]
curr_Stock_Price:  99.49257371519529
curr_Factors:  [99.49257372]
mat_Sqrt:  [[0.15]]
grads:  [0.03233083]
Stock Position:  0.03233083322144364
Bond Position:  [4.17957448]


portfolio before change:  [7.39220945]
curr_Stock_Price:  99.33520474683725
curr_Factors:  [99.33520475]
mat_Sqrt:  [[0.15]]
grads:  [-0.00446363]
Stock Position:  -0.004463633382383573
Bond Position:  [7.83560538]


portfolio before change:  [7.39727185]
curr_Stock_Price:  98.63997402711834
curr_Factors:  [98.63997403]
mat_Sqrt:  [[0.15]]
grads:  [0.05179495]
Stock Position:  0.051794946484472935
Bond Position:  [2.28821967]


portfolio before change:  [7.33441112]
curr_Stock_Price:  97.41528204873268
curr_Factors:  [97.41528205]
mat_Sqrt:  [[0.15]]
grads:  [0.12609328]
Stock Position:  0.1260932837818527
Bond Position:  [-4.94900169]


portfolio before change:  [6.98760791]
curr_Stock_Price:  94.67472525872671
curr_Factors:  [94.67472526]
mat_Sqrt:  [[0.15]]
grads:  [0.07004975]
Stock Position:  0.0700497452224609
Bond Position:  [0.35566752]


portfolio before change:  [6.92267143]
curr_Stock_Price:  93.7464504955715
curr_Factors:  [93.7464505]
mat_Sqrt:  [[0.15]]
grads:  [0.00162062]
Stock Position:  0.0016206162360980422
Bond Position:  [6.77074441]


portfolio before change:  [6.92653932]
curr_Stock_Price:  95.08853240885713
curr_Factors:  [95.08853241]
mat_Sqrt:  [[0.15]]
grads:  [-0.06083728]
Stock Position:  -0.060837281396184585
Bond Position:  [12.71146713]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.95659968]
Stock Price:  94.64666365803858
PL:  [6.95659968]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.64599682e-03]
 [-1.03614178e-02]
 [-1.01252905e-02]
 [-1.28016762e-02]
 [-4.60320529e-04]
 [-1.06424232e-02]
 [ 7.11559956e-03]
 [ 1.50627337e-02]
 [-1.73084961e-02]
 [ 3.98290033e-03]
 [-3.05566625e-03]
 [-5.49361337e-03]
 [ 5.38316665e-03]
 [-2.63449732e-04]
 [ 4.21153620e-03]
 [ 1.67655017e-02]
 [ 5.14131519e-03]
 [ 4.05354277e-03]
 [-5.14155547e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.19186338]
curr_Stock_Price:  99.2836093985083
curr_Factors:  [99.2836094]
mat_Sqrt:  [[0.15]]
grads:  [0.01763998]
Stock Position:  0.017639978777832487
Bond Position:  [-15.94322414]


portfolio before change:  [-14.18903836]
curr_Stock_Price:  99.6697392933545
curr_Factors:  [99.66973929]
mat_Sqrt:  [[0.15]]
grads:  [-0.06907612]
Stock Position:  -0.06907611870231332
Bond Position:  [-7.30423962]


portfolio before change:  [-14.06436907]
curr_Stock_Price:  97.83849023029113
curr_Factors:  [97.83849023]
mat_Sqrt:  [[0.15]]
grads:  [-0.06750194]
Stock Position:  -0.0675019366608849
Bond Position:  [-7.4600815]


portfolio before change:  [-14.10314924]
curr_Stock_Price:  98.38536216637685
curr_Factors:  [98.38536217]
mat_Sqrt:  [[0.15]]
grads:  [-0.08534451]
Stock Position:  -0.08534450801883262
Bond Position:  [-5.70649891]


portfolio before change:  [-14.0728049]
curr_Stock_Price:  98.01309286959432
curr_Factors:  [98.01309287]
mat_Sqrt:  [[0.15]]
grads:  [-0.0030688]
Stock Position:  -0.0030688035296388277
Bond Position:  [-13.77202198]


portfolio before change:  [-14.07846816]
curr_Stock_Price:  98.73644514457489
curr_Factors:  [98.73644514]
mat_Sqrt:  [[0.15]]
grads:  [-0.07094949]
Stock Position:  -0.07094948829241936
Bond Position:  [-7.07316791]


portfolio before change:  [-14.24152244]
curr_Stock_Price:  101.00969290573077
curr_Factors:  [101.00969291]
mat_Sqrt:  [[0.15]]
grads:  [0.04743733]
Stock Position:  0.0474373303742499
Bond Position:  [-19.03315262]


portfolio before change:  [-14.25403585]
curr_Stock_Price:  100.84622411760172
curr_Factors:  [100.84622412]
mat_Sqrt:  [[0.15]]
grads:  [0.10041822]
Stock Position:  0.10041822474715834
Bond Position:  [-24.38083465]


portfolio before change:  [-14.2383029]
curr_Stock_Price:  101.06360415665401
curr_Factors:  [101.06360416]
mat_Sqrt:  [[0.15]]
grads:  [-0.11538997]
Stock Position:  -0.11538997431996176
Bond Position:  [-2.57657621]


portfolio before change:  [-14.15406452]
curr_Stock_Price:  100.32798907338784
curr_Factors:  [100.32798907]
mat_Sqrt:  [[0.15]]
grads:  [0.02655267]
Stock Position:  0.026552668842236903
Bond Position:  [-16.81804039]


portfolio before change:  [-14.11694929]
curr_Stock_Price:  101.88415137023196
curr_Factors:  [101.88415137]
mat_Sqrt:  [[0.15]]
grads:  [-0.02037111]
Stock Position:  -0.0203711083200597
Bond Position:  [-12.04145621]


portfolio before change:  [-14.09635897]
curr_Stock_Price:  100.72559569868599
curr_Factors:  [100.7255957]
mat_Sqrt:  [[0.15]]
grads:  [-0.03662409]
Stock Position:  -0.03662408911740944
Bond Position:  [-10.40737578]


portfolio before change:  [-14.10551132]
curr_Stock_Price:  100.90444475907867
curr_Factors:  [100.90444476]
mat_Sqrt:  [[0.15]]
grads:  [0.03588778]
Stock Position:  0.03588777767626819
Bond Position:  [-17.7267476]


portfolio before change:  [-14.12340989]
curr_Stock_Price:  100.52921038041762
curr_Factors:  [100.52921038]
mat_Sqrt:  [[0.15]]
grads:  [-0.00175633]
Stock Position:  -0.0017563315434549124
Bond Position:  [-13.94684727]


portfolio before change:  [-14.12589449]
curr_Stock_Price:  99.95838970853204
curr_Factors:  [99.95838971]
mat_Sqrt:  [[0.15]]
grads:  [0.02807691]
Stock Position:  0.0280769079849804
Bond Position:  [-16.932417]


portfolio before change:  [-14.14606619]
curr_Stock_Price:  99.39073213788929
curr_Factors:  [99.39073214]
mat_Sqrt:  [[0.15]]
grads:  [0.11177001]
Stock Position:  0.1117700115016664
Bond Position:  [-25.25496947]


portfolio before change:  [-14.17664437]
curr_Stock_Price:  99.17364665490211
curr_Factors:  [99.17364665]
mat_Sqrt:  [[0.15]]
grads:  [0.03427543]
Stock Position:  0.03427543460779617
Bond Position:  [-17.57586421]


portfolio before change:  [-14.21800417]
curr_Stock_Price:  98.09516912314442
curr_Factors:  [98.09516912]
mat_Sqrt:  [[0.15]]
grads:  [0.02702362]
Stock Position:  0.027023618438441043
Bond Position:  [-16.8688906]


portfolio before change:  [-14.13891574]
curr_Stock_Price:  101.17788657487732
curr_Factors:  [101.17788657]
mat_Sqrt:  [[0.15]]
grads:  [-0.03427704]
Stock Position:  -0.034277036465061445
Bond Position:  [-10.67083764]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.17179199]
Stock Price:  102.05918211839315
PL:  [-16.2309741]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.21660467e-02]
 [-8.46071168e-03]
 [-9.11500691e-03]
 [-1.55295701e-02]
 [ 5.67035814e-03]
 [-1.05443203e-02]
 [ 1.27005889e-02]
 [-4.08279877e-02]
 [-5.78592077e-04]
 [ 9.66297423e-03]
 [-7.12634474e-03]
 [ 4.55674242e-03]
 [ 5.46781506e-03]
 [-1.33536396e-03]
 [ 8.19145280e-03]
 [ 2.22939747e-02]
 [ 1.65392896e-02]
 [-1.65687427e-03]
 [-1.16093905e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [45.05791501]
curr_Stock_Price:  101.97188444471301
curr_Factors:  [101.97188444]
mat_Sqrt:  [[0.15]]
grads:  [-0.14777364]
Stock Position:  -0.1477736449765683
Bond Position:  [60.12667206]


portfolio before change:  [45.44202397]
curr_Stock_Price:  99.47431178584033
curr_Factors:  [99.47431179]
mat_Sqrt:  [[0.15]]
grads:  [-0.05640474]
Stock Position:  -0.05640474450510448
Bond Position:  [51.05284711]


portfolio before change:  [45.53026095]
curr_Stock_Price:  98.13626538397955
curr_Factors:  [98.13626538]
mat_Sqrt:  [[0.15]]
grads:  [-0.06076671]
Stock Position:  -0.060766712756964866
Bond Position:  [51.4936792]


portfolio before change:  [45.50023623]
curr_Stock_Price:  98.84223984248827
curr_Factors:  [98.84223984]
mat_Sqrt:  [[0.15]]
grads:  [-0.10353047]
Stock Position:  -0.10353046729293916
Bond Position:  [55.73341951]


portfolio before change:  [45.46358783]
curr_Stock_Price:  99.33082543491975
curr_Factors:  [99.33082543]
mat_Sqrt:  [[0.15]]
grads:  [0.03780239]
Stock Position:  0.03780238759565696
Bond Position:  [41.70864547]


portfolio before change:  [45.46174053]
curr_Stock_Price:  99.00609025939164
curr_Factors:  [99.00609026]
mat_Sqrt:  [[0.15]]
grads:  [-0.07029547]
Stock Position:  -0.07029546855735784
Bond Position:  [52.42142003]


portfolio before change:  [45.64318968]
curr_Stock_Price:  96.61131065692199
curr_Factors:  [96.61131066]
mat_Sqrt:  [[0.15]]
grads:  [0.08467059]
Stock Position:  0.08467059239376865
Bond Position:  [37.46305277]


portfolio before change:  [45.76252646]
curr_Stock_Price:  97.91010692387503
curr_Factors:  [97.91010692]
mat_Sqrt:  [[0.15]]
grads:  [-0.27218658]
Stock Position:  -0.2721865844441914
Bond Position:  [72.41234405]


portfolio before change:  [45.79042935]
curr_Stock_Price:  97.87411123286117
curr_Factors:  [97.87411123]
mat_Sqrt:  [[0.15]]
grads:  [-0.00385728]
Stock Position:  -0.0038572805163026775
Bond Position:  [46.16795726]


portfolio before change:  [45.80402567]
curr_Stock_Price:  97.3419011093134
curr_Factors:  [97.34190111]
mat_Sqrt:  [[0.15]]
grads:  [0.06441983]
Stock Position:  0.06441982816928869
Bond Position:  [39.53327713]


portfolio before change:  [45.80019607]
curr_Stock_Price:  97.12901395458043
curr_Factors:  [97.12901395]
mat_Sqrt:  [[0.15]]
grads:  [-0.04750896]
Stock Position:  -0.047508964923801335
Bond Position:  [50.41469499]


portfolio before change:  [45.80022887]
curr_Stock_Price:  97.39364705709053
curr_Factors:  [97.39364706]
mat_Sqrt:  [[0.15]]
grads:  [0.03037828]
Stock Position:  0.03037828278057951
Bond Position:  [42.84157712]


portfolio before change:  [45.82652328]
curr_Stock_Price:  97.90660139831175
curr_Factors:  [97.9066014]
mat_Sqrt:  [[0.15]]
grads:  [0.0364521]
Stock Position:  0.0364521004263952
Bond Position:  [42.25762201]


portfolio before change:  [45.7792791]
curr_Stock_Price:  96.32068704551007
curr_Factors:  [96.32068705]
mat_Sqrt:  [[0.15]]
grads:  [-0.00890243]
Stock Position:  -0.00890242638096851
Bond Position:  [46.63676692]


portfolio before change:  [45.79199863]
curr_Stock_Price:  96.20174344558274
curr_Factors:  [96.20174345]
mat_Sqrt:  [[0.15]]
grads:  [0.05460969]
Stock Position:  0.05460968535624686
Bond Position:  [40.53845169]


portfolio before change:  [45.66712443]
curr_Stock_Price:  93.72946976830069
curr_Factors:  [93.72946977]
mat_Sqrt:  [[0.15]]
grads:  [0.1486265]
Stock Position:  0.14862649775920403
Bond Position:  [31.7364416]


portfolio before change:  [45.33376083]
curr_Stock_Price:  91.43311815968053
curr_Factors:  [91.43311816]
mat_Sqrt:  [[0.15]]
grads:  [0.11026193]
Stock Position:  0.11026193053893144
Bond Position:  [35.25216871]


portfolio before change:  [45.15543942]
curr_Stock_Price:  89.735927139575
curr_Factors:  [89.73592714]
mat_Sqrt:  [[0.15]]
grads:  [-0.01104583]
Stock Position:  -0.011045828437736943
Bond Position:  [46.14664707]


portfolio before change:  [45.15791569]
curr_Stock_Price:  90.5563120555142
curr_Factors:  [90.55631206]
mat_Sqrt:  [[0.15]]
grads:  [-0.07739594]
Stock Position:  -0.07739593660171142
Bond Position:  [52.16660628]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [45.27131324]
Stock Price:  89.25967724036462
PL:  [45.27131324]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.17007000e-02]
 [ 5.54380003e-02]
 [-5.41184489e-02]
 [ 6.90747220e-02]
 [ 4.68659004e-03]
 [-1.94997272e-02]
 [-1.41333802e-03]
 [ 1.54902059e-03]
 [ 1.03939959e-02]
 [ 5.76670447e-04]
 [-3.28074304e-03]
 [ 4.29081965e-03]
 [ 9.97890831e-03]
 [-8.56568633e-04]
 [ 5.34020600e-03]
 [ 2.28853653e-02]
 [ 2.06532434e-03]
 [ 1.25054629e-02]
 [-9.06379341e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [43.10154009]
curr_Stock_Price:  101.88311999670387
curr_Factors:  [101.88312]
mat_Sqrt:  [[0.15]]
grads:  [-0.14467133]
Stock Position:  -0.14467133354111997
Bond Position:  [57.84110693]


portfolio before change:  [42.96611147]
curr_Stock_Price:  102.91919747566732
curr_Factors:  [102.91919748]
mat_Sqrt:  [[0.15]]
grads:  [0.36958667]
Stock Position:  0.3695866689819404
Bond Position:  [4.9285481]


portfolio before change:  [43.17780687]
curr_Stock_Price:  103.48865285748532
curr_Factors:  [103.48865286]
mat_Sqrt:  [[0.15]]
grads:  [-0.36078966]
Stock Position:  -0.3607896590131773
Bond Position:  [80.51544265]


portfolio before change:  [43.03270026]
curr_Stock_Price:  103.94664267560769
curr_Factors:  [103.94664268]
mat_Sqrt:  [[0.15]]
grads:  [0.46049815]
Stock Position:  0.46049814687377566
Bond Position:  [-4.83453606]


portfolio before change:  [43.48777495]
curr_Stock_Price:  104.93749024635727
curr_Factors:  [104.93749025]
mat_Sqrt:  [[0.15]]
grads:  [0.03124393]
Stock Position:  0.031243933607912038
Bond Position:  [40.20911497]


portfolio before change:  [43.52004792]
curr_Stock_Price:  105.64865033823506
curr_Factors:  [105.64865034]
mat_Sqrt:  [[0.15]]
grads:  [-0.12999818]
Stock Position:  -0.12999818134812682
Bond Position:  [57.25418033]


portfolio before change:  [43.9481095]
curr_Stock_Price:  102.46594239458017
curr_Factors:  [102.46594239]
mat_Sqrt:  [[0.15]]
grads:  [-0.00942225]
Stock Position:  -0.009422253439885734
Bond Position:  [44.91356958]


portfolio before change:  [43.94732972]
curr_Stock_Price:  103.74053916453924
curr_Factors:  [103.74053916]
mat_Sqrt:  [[0.15]]
grads:  [0.0103268]
Stock Position:  0.010326803920361928
Bond Position:  [42.87602152]


portfolio before change:  [43.96617415]
curr_Stock_Price:  104.5272374942533
curr_Factors:  [104.52723749]
mat_Sqrt:  [[0.15]]
grads:  [0.06929331]
Stock Position:  0.06929330573010528
Bond Position:  [36.72313632]


portfolio before change:  [43.94032021]
curr_Stock_Price:  104.02162059841484
curr_Factors:  [104.0216206]
mat_Sqrt:  [[0.15]]
grads:  [0.00384447]
Stock Position:  0.0038444696433482623
Bond Position:  [43.54041225]


portfolio before change:  [43.94950255]
curr_Stock_Price:  103.5783546290107
curr_Factors:  [103.57835463]
mat_Sqrt:  [[0.15]]
grads:  [-0.02187162]
Stock Position:  -0.02187162028640968
Bond Position:  [46.214929]


portfolio before change:  [43.94797563]
curr_Stock_Price:  104.17648590501652
curr_Factors:  [104.17648591]
mat_Sqrt:  [[0.15]]
grads:  [0.02860546]
Stock Position:  0.028605464309970168
Bond Position:  [40.96795888]


portfolio before change:  [43.95256791]
curr_Stock_Price:  103.97893657897463
curr_Factors:  [103.97893658]
mat_Sqrt:  [[0.15]]
grads:  [0.06652606]
Stock Position:  0.06652605537459294
Bond Position:  [37.03525942]


portfolio before change:  [43.95381049]
curr_Stock_Price:  103.85842146410178
curr_Factors:  [103.85842146]
mat_Sqrt:  [[0.15]]
grads:  [-0.00571046]
Stock Position:  -0.005710457554432241
Bond Position:  [44.54688959]


portfolio before change:  [43.96410403]
curr_Stock_Price:  104.00632091439462
curr_Factors:  [104.00632091]
mat_Sqrt:  [[0.15]]
grads:  [0.03560137]
Stock Position:  0.03560137330302978
Bond Position:  [40.26133617]


portfolio before change:  [43.95040116]
curr_Stock_Price:  103.33866513782932
curr_Factors:  [103.33866514]
mat_Sqrt:  [[0.15]]
grads:  [0.1525691]
Stock Position:  0.15256910175743382
Bond Position:  [28.18411384]


portfolio before change:  [43.94131138]
curr_Stock_Price:  103.2328987527451
curr_Factors:  [103.23289875]
mat_Sqrt:  [[0.15]]
grads:  [0.01376883]
Stock Position:  0.013768828923032722
Bond Position:  [42.51991526]


portfolio before change:  [43.94554268]
curr_Stock_Price:  102.7680801947104
curr_Factors:  [102.76808019]
mat_Sqrt:  [[0.15]]
grads:  [0.08336975]
Stock Position:  0.08336975283906047
Bond Position:  [35.37779324]


portfolio before change:  [43.93781996]
curr_Stock_Price:  102.56934770385845
curr_Factors:  [102.5693477]
mat_Sqrt:  [[0.15]]
grads:  [-0.06042529]
Stock Position:  -0.06042528940233657
Bond Position:  [50.13560248]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [43.94903453]
Stock Price:  102.59120763673855
PL:  [41.3578269]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.53885059e-03]
 [-4.46007489e-03]
 [-1.24186992e-02]
 [ 3.30687315e-03]
 [-4.10218010e-03]
 [-1.16558999e-02]
 [ 1.25029401e-02]
 [-4.21977272e-02]
 [ 1.46588614e-03]
 [ 7.24792770e-03]
 [-6.13254914e-03]
 [ 9.35680415e-04]
 [ 5.85635814e-03]
 [-9.19225674e-04]
 [ 8.05799185e-03]
 [ 1.68145694e-02]
 [ 5.52151065e-03]
 [ 6.53004428e-03]
 [-5.12770403e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.98693056]
curr_Stock_Price:  99.79199849479502
curr_Factors:  [99.79199849]
mat_Sqrt:  [[0.15]]
grads:  [0.01692567]
Stock Position:  0.01692567056867023
Bond Position:  [-4.67597705]


portfolio before change:  [-3.00274754]
curr_Stock_Price:  98.92657725162152
curr_Factors:  [98.92657725]
mat_Sqrt:  [[0.15]]
grads:  [-0.02973383]
Stock Position:  -0.02973383262684419
Bond Position:  [-0.06128125]


portfolio before change:  [-2.95031072]
curr_Stock_Price:  97.16252147216146
curr_Factors:  [97.16252147]
mat_Sqrt:  [[0.15]]
grads:  [-0.08279133]
Stock Position:  -0.08279132827621917
Bond Position:  [5.09390349]


portfolio before change:  [-2.96035685]
curr_Stock_Price:  97.29924796960944
curr_Factors:  [97.29924797]
mat_Sqrt:  [[0.15]]
grads:  [0.02204582]
Stock Position:  0.02204582102712192
Bond Position:  [-5.10539866]


portfolio before change:  [-2.96611445]
curr_Stock_Price:  97.0959856575338
curr_Factors:  [97.09598566]
mat_Sqrt:  [[0.15]]
grads:  [-0.02734787]
Stock Position:  -0.027347867322267273
Bond Position:  [-0.31074631]


portfolio before change:  [-2.92386403]
curr_Stock_Price:  95.54821911078139
curr_Factors:  [95.54821911]
mat_Sqrt:  [[0.15]]
grads:  [-0.077706]
Stock Position:  -0.07770599919856234
Bond Position:  [4.50080581]


portfolio before change:  [-3.03052343]
curr_Stock_Price:  96.93530307569524
curr_Factors:  [96.93530308]
mat_Sqrt:  [[0.15]]
grads:  [0.08335293]
Stock Position:  0.08335293427914829
Bond Position:  [-11.11036538]


portfolio before change:  [-3.04650614]
curr_Stock_Price:  96.77688306264733
curr_Factors:  [96.77688306]
mat_Sqrt:  [[0.15]]
grads:  [-0.28131818]
Stock Position:  -0.28131818155678934
Bond Position:  [24.17859062]


portfolio before change:  [-3.04158318]
curr_Stock_Price:  96.78087300278493
curr_Factors:  [96.780873]
mat_Sqrt:  [[0.15]]
grads:  [0.00977257]
Stock Position:  0.009772574276724325
Bond Position:  [-3.98738145]


portfolio before change:  [-3.052019]
curr_Stock_Price:  95.81502274427451
curr_Factors:  [95.81502274]
mat_Sqrt:  [[0.15]]
grads:  [0.04831952]
Stock Position:  0.048319517987164315
Bond Position:  [-7.68175471]


portfolio before change:  [-2.971028]
curr_Stock_Price:  97.53092709048767
curr_Factors:  [97.53092709]
mat_Sqrt:  [[0.15]]
grads:  [-0.04088366]
Stock Position:  -0.040883660940284096
Bond Position:  [1.01639335]


portfolio before change:  [-2.99954336]
curr_Stock_Price:  98.23461864864262
curr_Factors:  [98.23461865]
mat_Sqrt:  [[0.15]]
grads:  [0.00623787]
Stock Position:  0.006237869433383739
Bond Position:  [-3.61231809]


portfolio before change:  [-3.00726646]
curr_Stock_Price:  97.14131163028858
curr_Factors:  [97.14131163]
mat_Sqrt:  [[0.15]]
grads:  [0.03904239]
Stock Position:  0.039042387579945353
Bond Position:  [-6.7998952]


portfolio before change:  [-2.95930146]
curr_Stock_Price:  98.41339534238506
curr_Factors:  [98.41339534]
mat_Sqrt:  [[0.15]]
grads:  [-0.00612817]
Stock Position:  -0.006128171161093143
Bond Position:  [-2.35620733]


portfolio before change:  [-2.95575331]
curr_Stock_Price:  97.73827136980698
curr_Factors:  [97.73827137]
mat_Sqrt:  [[0.15]]
grads:  [0.05371995]
Stock Position:  0.05371994564621888
Bond Position:  [-8.20624794]


portfolio before change:  [-2.8571976]
curr_Stock_Price:  99.61108645237987
curr_Factors:  [99.61108645]
mat_Sqrt:  [[0.15]]
grads:  [0.11209713]
Stock Position:  0.11209712923137355
Bond Position:  [-14.02331444]


portfolio before change:  [-2.94730725]
curr_Stock_Price:  98.83851198486353
curr_Factors:  [98.83851198]
mat_Sqrt:  [[0.15]]
grads:  [0.03681007]
Stock Position:  0.03681007099807991
Bond Position:  [-6.5855599]


portfolio before change:  [-2.94046931]
curr_Stock_Price:  99.06900708688852
curr_Factors:  [99.06900709]
mat_Sqrt:  [[0.15]]
grads:  [0.04353363]
Stock Position:  0.04353362854568314
Bond Position:  [-7.25330266]


portfolio before change:  [-2.91679375]
curr_Stock_Price:  99.65451100470366
curr_Factors:  [99.654511]
mat_Sqrt:  [[0.15]]
grads:  [-0.03418469]
Stock Position:  -0.03418469355504889
Bond Position:  [0.48986517]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.87676627]
Stock Price:  98.48717563431364
PL:  [-2.87676627]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.76240711e-02]
 [ 5.27100020e-02]
 [-2.39482243e-02]
 [ 5.99928282e-02]
 [ 5.08559525e-03]
 [-1.96195439e-02]
 [-7.97322319e-03]
 [-6.01393712e-03]
 [ 9.24749084e-03]
 [-2.08096745e-05]
 [-3.44601460e-03]
 [-1.19062184e-03]
 [ 1.12624812e-02]
 [-1.68597640e-03]
 [ 2.23649674e-03]
 [ 2.29155927e-02]
 [ 2.67777257e-03]
 [ 1.22725684e-02]
 [-5.97401148e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [63.41346282]
curr_Stock_Price:  102.80471053258333
curr_Factors:  [102.80471053]
mat_Sqrt:  [[0.15]]
grads:  [-0.18416047]
Stock Position:  -0.18416047411103975
Bond Position:  [82.34602706]


portfolio before change:  [63.43263774]
curr_Stock_Price:  102.81238947985189
curr_Factors:  [102.81238948]
mat_Sqrt:  [[0.15]]
grads:  [0.35140001]
Stock Position:  0.3514000131023445
Bond Position:  [27.30436273]


portfolio before change:  [62.98116593]
curr_Stock_Price:  101.50818135096493
curr_Factors:  [101.50818135]
mat_Sqrt:  [[0.15]]
grads:  [-0.15965483]
Stock Position:  -0.15965482889579372
Bond Position:  [79.18743726]


portfolio before change:  [62.69528961]
curr_Stock_Price:  103.42278461383215
curr_Factors:  [103.42278461]
mat_Sqrt:  [[0.15]]
grads:  [0.39995219]
Stock Position:  0.3999521879060327
Bond Position:  [21.33112063]


portfolio before change:  [62.93571106]
curr_Stock_Price:  104.01057486263501
curr_Factors:  [104.01057486]
mat_Sqrt:  [[0.15]]
grads:  [0.03390397]
Stock Position:  0.033903968301719614
Bond Position:  [59.40933982]


portfolio before change:  [63.00779281]
curr_Stock_Price:  105.69850583197068
curr_Factors:  [105.69850583]
mat_Sqrt:  [[0.15]]
grads:  [-0.13079696]
Stock Position:  -0.13079695923447218
Bond Position:  [76.83283596]


portfolio before change:  [63.19579744]
curr_Stock_Price:  104.40800162664002
curr_Factors:  [104.40800163]
mat_Sqrt:  [[0.15]]
grads:  [-0.05315482]
Stock Position:  -0.053154821281371986
Bond Position:  [68.74558611]


portfolio before change:  [63.1572753]
curr_Stock_Price:  105.45608507279884
curr_Factors:  [105.45608507]
mat_Sqrt:  [[0.15]]
grads:  [-0.04009291]
Stock Position:  -0.04009291412129859
Bond Position:  [67.38531706]


portfolio before change:  [63.21545767]
curr_Stock_Price:  104.42513150433814
curr_Factors:  [104.4251315]
mat_Sqrt:  [[0.15]]
grads:  [0.06164994]
Stock Position:  0.06164993891641525
Bond Position:  [56.77765469]


portfolio before change:  [63.23113505]
curr_Stock_Price:  104.44915734161705
curr_Factors:  [104.44915734]
mat_Sqrt:  [[0.15]]
grads:  [-0.00013873]
Stock Position:  -0.0001387311633034456
Bond Position:  [63.2456254]


portfolio before change:  [63.24692954]
curr_Stock_Price:  104.58532988767104
curr_Factors:  [104.58532989]
mat_Sqrt:  [[0.15]]
grads:  [-0.02297343]
Stock Position:  -0.02297343066651739
Bond Position:  [65.64961336]


portfolio before change:  [63.29287611]
curr_Stock_Price:  103.29983974898649
curr_Factors:  [103.29983975]
mat_Sqrt:  [[0.15]]
grads:  [-0.00793748]
Stock Position:  -0.007937478908993136
Bond Position:  [64.11281641]


portfolio before change:  [63.29648708]
curr_Stock_Price:  104.86447273660829
curr_Factors:  [104.86447274]
mat_Sqrt:  [[0.15]]
grads:  [0.07508321]
Stock Position:  0.07508320832090634
Bond Position:  [55.42292603]


portfolio before change:  [63.28533635]
curr_Stock_Price:  104.53139969519052
curr_Factors:  [104.5313997]
mat_Sqrt:  [[0.15]]
grads:  [-0.01123984]
Stock Position:  -0.011239842687003865
Bond Position:  [64.46025284]


portfolio before change:  [63.31453395]
curr_Stock_Price:  103.36763557542434
curr_Factors:  [103.36763558]
mat_Sqrt:  [[0.15]]
grads:  [0.01490998]
Stock Position:  0.014909978266139663
Bond Position:  [61.77332475]


portfolio before change:  [63.32898121]
curr_Stock_Price:  103.30070030373481
curr_Factors:  [103.3007003]
mat_Sqrt:  [[0.15]]
grads:  [0.15277062]
Stock Position:  0.15277061803563818
Bond Position:  [47.54766938]


portfolio before change:  [63.37308255]
curr_Stock_Price:  103.51155847342669
curr_Factors:  [103.51155847]
mat_Sqrt:  [[0.15]]
grads:  [0.01785182]
Stock Position:  0.017851817113799573
Bond Position:  [61.52521314]


portfolio before change:  [63.37003896]
curr_Stock_Price:  102.47934936845981
curr_Factors:  [102.47934937]
mat_Sqrt:  [[0.15]]
grads:  [0.08181712]
Stock Position:  0.08181712273036312
Bond Position:  [54.98547346]


portfolio before change:  [63.30711892]
curr_Stock_Price:  101.54228232665356
curr_Factors:  [101.54228233]
mat_Sqrt:  [[0.15]]
grads:  [-0.03982674]
Stock Position:  -0.03982674320990001
Bond Position:  [67.35121733]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [63.36101551]
Stock Price:  100.61183516653249
PL:  [62.74918034]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.44081917e-02]
 [ 5.08686201e-02]
 [-2.43026888e-02]
 [-1.23796341e-02]
 [ 5.71632456e-03]
 [-9.80588327e-03]
 [ 6.42510600e-03]
 [ 7.67968872e-03]
 [-1.30009660e-02]
 [ 1.55024605e-03]
 [-3.28289315e-03]
 [-2.89271603e-03]
 [ 6.32603591e-03]
 [ 2.32844323e-04]
 [ 3.28723919e-04]
 [ 2.28581040e-02]
 [ 8.90909271e-04]
 [ 1.03038598e-02]
 [-5.18423479e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.97178051]
curr_Stock_Price:  100.74293504679115
curr_Factors:  [100.74293505]
mat_Sqrt:  [[0.15]]
grads:  [-0.09605461]
Stock Position:  -0.09605461116054526
Bond Position:  [27.64860396]


portfolio before change:  [17.78683791]
curr_Stock_Price:  102.74029475136955
curr_Factors:  [102.74029475]
mat_Sqrt:  [[0.15]]
grads:  [0.33912413]
Stock Position:  0.33912413424485915
Bond Position:  [-17.0548756]


portfolio before change:  [17.37232168]
curr_Stock_Price:  101.53055489489168
curr_Factors:  [101.53055489]
mat_Sqrt:  [[0.15]]
grads:  [-0.16201793]
Stock Position:  -0.16201792544369195
Bond Position:  [33.82209155]


portfolio before change:  [17.61027262]
curr_Stock_Price:  100.11407977571403
curr_Factors:  [100.11407978]
mat_Sqrt:  [[0.15]]
grads:  [-0.08253089]
Stock Position:  -0.08253089414842683
Bond Position:  [25.87277714]


portfolio before change:  [17.51829647]
curr_Stock_Price:  101.30690770580635
curr_Factors:  [101.30690771]
mat_Sqrt:  [[0.15]]
grads:  [0.03810883]
Stock Position:  0.038108830401602095
Bond Position:  [13.6576087]


portfolio before change:  [17.49009501]
curr_Stock_Price:  100.47727613955975
curr_Factors:  [100.47727614]
mat_Sqrt:  [[0.15]]
grads:  [-0.06537256]
Stock Position:  -0.06537255516509238
Bond Position:  [24.05855129]


portfolio before change:  [17.45537967]
curr_Stock_Price:  101.10033161396326
curr_Factors:  [101.10033161]
mat_Sqrt:  [[0.15]]
grads:  [0.04283404]
Stock Position:  0.04283404002104745
Bond Position:  [13.12484402]


portfolio before change:  [17.51212152]
curr_Stock_Price:  102.34840976776157
curr_Factors:  [102.34840977]
mat_Sqrt:  [[0.15]]
grads:  [0.05119792]
Stock Position:  0.051197924801929334
Bond Position:  [12.27209533]


portfolio before change:  [17.51737238]
curr_Stock_Price:  102.3910375649411
curr_Factors:  [102.39103756]
mat_Sqrt:  [[0.15]]
grads:  [-0.08667311]
Stock Position:  -0.0866731065540759
Bond Position:  [26.39192169]


portfolio before change:  [17.44302501]
curr_Stock_Price:  103.32496254053336
curr_Factors:  [103.32496254]
mat_Sqrt:  [[0.15]]
grads:  [0.01033497]
Stock Position:  0.010334973634490482
Bond Position:  [16.37516425]


portfolio before change:  [17.4498735]
curr_Stock_Price:  103.59145490390426
curr_Factors:  [103.5914549]
mat_Sqrt:  [[0.15]]
grads:  [-0.02188595]
Stock Position:  -0.0218859543216661
Bond Position:  [19.71707135]


portfolio before change:  [17.46714336]
curr_Stock_Price:  103.02762406755521
curr_Factors:  [103.02762407]
mat_Sqrt:  [[0.15]]
grads:  [-0.01928477]
Stock Position:  -0.019284773506055328
Bond Position:  [19.45400776]


portfolio before change:  [17.50198562]
curr_Stock_Price:  101.47312568916107
curr_Factors:  [101.47312569]
mat_Sqrt:  [[0.15]]
grads:  [0.04217357]
Stock Position:  0.0421735727015516
Bond Position:  [13.22250138]


portfolio before change:  [17.52910748]
curr_Stock_Price:  102.03783526613432
curr_Factors:  [102.03783527]
mat_Sqrt:  [[0.15]]
grads:  [0.0015523]
Stock Position:  0.0015522954855273132
Bond Position:  [17.37071461]


portfolio before change:  [17.53293263]
curr_Stock_Price:  101.70409016983002
curr_Factors:  [101.70409017]
mat_Sqrt:  [[0.15]]
grads:  [0.00219149]
Stock Position:  0.0021914927961366217
Bond Position:  [17.31004885]


portfolio before change:  [17.5387813]
curr_Stock_Price:  102.39796378176659
curr_Factors:  [102.39796378]
mat_Sqrt:  [[0.15]]
grads:  [0.15238736]
Stock Position:  0.1523873599970405
Bond Position:  [1.93462593]


portfolio before change:  [17.53032645]
curr_Stock_Price:  102.33930686495944
curr_Factors:  [102.33930686]
mat_Sqrt:  [[0.15]]
grads:  [0.0059394]
Stock Position:  0.00593939514079578
Bond Position:  [16.92249287]


portfolio before change:  [17.52729981]
curr_Stock_Price:  101.11733295341809
curr_Factors:  [101.11733295]
mat_Sqrt:  [[0.15]]
grads:  [0.0686924]
Stock Position:  0.06869239878493079
Bond Position:  [10.58130766]


portfolio before change:  [17.53129765]
curr_Stock_Price:  101.13701744768329
curr_Factors:  [101.13701745]
mat_Sqrt:  [[0.15]]
grads:  [-0.03456157]
Stock Position:  -0.03456156527215155
Bond Position:  [21.02675128]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.6040448]
Stock Price:  99.18427584770654
PL:  [17.6040448]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.48806685e-03]
 [ 1.01609023e-02]
 [-1.28207082e-02]
 [-1.18077201e-02]
 [ 6.32382788e-03]
 [-1.02150397e-02]
 [ 1.32283963e-02]
 [-3.78288666e-02]
 [-2.33493330e-03]
 [ 1.03332009e-02]
 [-4.74168530e-03]
 [-4.58622118e-03]
 [ 4.84127637e-03]
 [-5.13977694e-04]
 [ 3.93821424e-03]
 [ 2.29673521e-02]
 [ 1.01750319e-03]
 [ 1.26146290e-02]
 [-1.02489152e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.69646264]
curr_Stock_Price:  99.80517757634468
curr_Factors:  [99.80517758]
mat_Sqrt:  [[0.15]]
grads:  [0.01658711]
Stock Position:  0.016587112365463223
Bond Position:  [-4.35194234]


portfolio before change:  [-2.67837232]
curr_Stock_Price:  100.9614028292627
curr_Factors:  [100.96140283]
mat_Sqrt:  [[0.15]]
grads:  [0.06773935]
Stock Position:  0.0677393488644182
Bond Position:  [-9.51743201]


portfolio before change:  [-2.68219033]
curr_Stock_Price:  100.94016915575797
curr_Factors:  [100.94016916]
mat_Sqrt:  [[0.15]]
grads:  [-0.08547139]
Stock Position:  -0.0854713881758677
Bond Position:  [5.94530605]


portfolio before change:  [-2.61468565]
curr_Stock_Price:  100.16776827260875
curr_Factors:  [100.16776827]
mat_Sqrt:  [[0.15]]
grads:  [-0.07871813]
Stock Position:  -0.07871813427564854
Bond Position:  [5.27033419]


portfolio before change:  [-2.6504827]
curr_Stock_Price:  100.63925808248675
curr_Factors:  [100.63925808]
mat_Sqrt:  [[0.15]]
grads:  [0.04215885]
Stock Position:  0.04215885254394882
Bond Position:  [-6.89331834]


portfolio before change:  [-2.70058647]
curr_Stock_Price:  99.49168827726473
curr_Factors:  [99.49168828]
mat_Sqrt:  [[0.15]]
grads:  [-0.06810026]
Stock Position:  -0.06810026436647283
Bond Position:  [4.07482381]


portfolio before change:  [-2.59345087]
curr_Stock_Price:  97.93344528113484
curr_Factors:  [97.93344528]
mat_Sqrt:  [[0.15]]
grads:  [0.08818931]
Stock Position:  0.08818930871660897
Bond Position:  [-11.23013371]


portfolio before change:  [-2.58232843]
curr_Stock_Price:  98.0914046531144
curr_Factors:  [98.09140465]
mat_Sqrt:  [[0.15]]
grads:  [-0.25219244]
Stock Position:  -0.25219244432547205
Bond Position:  [22.15558268]


portfolio before change:  [-2.67463799]
curr_Stock_Price:  98.47939863822393
curr_Factors:  [98.47939864]
mat_Sqrt:  [[0.15]]
grads:  [-0.01556622]
Stock Position:  -0.015566221972959956
Bond Position:  [-1.14168582]


portfolio before change:  [-2.67884202]
curr_Stock_Price:  98.73113425159977
curr_Factors:  [98.73113425]
mat_Sqrt:  [[0.15]]
grads:  [0.06888801]
Stock Position:  0.06888800572602503
Bond Position:  [-9.48023297]


portfolio before change:  [-2.71755962]
curr_Stock_Price:  98.20350624260828
curr_Factors:  [98.20350624]
mat_Sqrt:  [[0.15]]
grads:  [-0.03161124]
Stock Position:  -0.03161123531332241
Bond Position:  [0.38677452]


portfolio before change:  [-2.77615894]
curr_Stock_Price:  100.0603153215969
curr_Factors:  [100.06031532]
mat_Sqrt:  [[0.15]]
grads:  [-0.03057481]
Stock Position:  -0.030574807862554395
Bond Position:  [0.28316597]


portfolio before change:  [-2.76074596]
curr_Stock_Price:  99.55852362702288
curr_Factors:  [99.55852363]
mat_Sqrt:  [[0.15]]
grads:  [0.03227518]
Stock Position:  0.032275175798144796
Bond Position:  [-5.97401481]


portfolio before change:  [-2.75083023]
curr_Stock_Price:  99.91202812681117
curr_Factors:  [99.91202813]
mat_Sqrt:  [[0.15]]
grads:  [-0.00342652]
Stock Position:  -0.0034265179584718006
Bond Position:  [-2.40847987]


portfolio before change:  [-2.75191465]
curr_Stock_Price:  100.05276228192895
curr_Factors:  [100.05276228]
mat_Sqrt:  [[0.15]]
grads:  [0.02625476]
Stock Position:  0.026254761597921186
Bond Position:  [-5.37877607]


portfolio before change:  [-2.68720761]
curr_Stock_Price:  102.56856900334708
curr_Factors:  [102.568569]
mat_Sqrt:  [[0.15]]
grads:  [0.15311568]
Stock Position:  0.15311568033639375
Bond Position:  [-18.39206383]


portfolio before change:  [-2.68578055]
curr_Stock_Price:  102.607922588073
curr_Factors:  [102.60792259]
mat_Sqrt:  [[0.15]]
grads:  [0.00678335]
Stock Position:  0.006783354581637098
Bond Position:  [-3.38180647]


portfolio before change:  [-2.68333786]
curr_Stock_Price:  103.09267520727124
curr_Factors:  [103.09267521]
mat_Sqrt:  [[0.15]]
grads:  [0.08409753]
Stock Position:  0.0840975269375603
Bond Position:  [-11.35317689]


portfolio before change:  [-2.70392238]
curr_Stock_Price:  102.8816597373657
curr_Factors:  [102.88165974]
mat_Sqrt:  [[0.15]]
grads:  [-0.0683261]
Stock Position:  -0.06832610131592466
Bond Position:  [4.32558032]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.61967815]
Stock Price:  101.66451568485449
PL:  [-4.28419383]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.40503908e-03]
 [-8.87500420e-03]
 [-5.48962285e-03]
 [-2.03828968e-02]
 [ 6.51921888e-03]
 [-9.84433433e-03]
 [ 1.06511873e-02]
 [ 1.19308360e-02]
 [-7.29959128e-03]
 [ 2.51300384e-03]
 [-3.07303919e-03]
 [-5.99401134e-03]
 [ 4.84845488e-03]
 [-7.91285101e-04]
 [ 1.54871049e-03]
 [ 2.20586925e-02]
 [ 2.33661530e-03]
 [ 9.62259513e-03]
 [-4.87280203e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.64666706]
curr_Stock_Price:  100.18372122629562
curr_Factors:  [100.18372123]
mat_Sqrt:  [[0.15]]
grads:  [-0.01603359]
Stock Position:  -0.016033593838961174
Bond Position:  [7.25297215]


portfolio before change:  [5.64659315]
curr_Stock_Price:  100.3014348290437
curr_Factors:  [100.30143483]
mat_Sqrt:  [[0.15]]
grads:  [-0.05916669]
Stock Position:  -0.059166694651756085
Bond Position:  [11.58109752]


portfolio before change:  [5.64006488]
curr_Stock_Price:  100.460712052029
curr_Factors:  [100.46071205]
mat_Sqrt:  [[0.15]]
grads:  [-0.03659749]
Stock Position:  -0.036597485661196506
Bond Position:  [9.31667435]


portfolio before change:  [5.68410028]
curr_Stock_Price:  99.32112734854591
curr_Factors:  [99.32112735]
mat_Sqrt:  [[0.15]]
grads:  [-0.13588598]
Stock Position:  -0.13588597893763965
Bond Position:  [19.1804489]


portfolio before change:  [5.58676792]
curr_Stock_Price:  100.0726991624251
curr_Factors:  [100.07269916]
mat_Sqrt:  [[0.15]]
grads:  [0.04346146]
Stock Position:  0.043461459221778236
Bond Position:  [1.23746238]


portfolio before change:  [5.59469603]
curr_Stock_Price:  100.24799712972363
curr_Factors:  [100.24799713]
mat_Sqrt:  [[0.15]]
grads:  [-0.0656289]
Stock Position:  -0.06562889553846125
Bond Position:  [12.17386136]


portfolio before change:  [5.57725348]
curr_Stock_Price:  100.56015215154704
curr_Factors:  [100.56015215]
mat_Sqrt:  [[0.15]]
grads:  [0.07100792]
Stock Position:  0.07100791561206432
Bond Position:  [-1.56331331]


portfolio before change:  [5.64144817]
curr_Stock_Price:  101.46970659231386
curr_Factors:  [101.46970659]
mat_Sqrt:  [[0.15]]
grads:  [0.07953891]
Stock Position:  0.07953890638676664
Bond Position:  [-2.42934132]


portfolio before change:  [5.75580606]
curr_Stock_Price:  102.91510357558649
curr_Factors:  [102.91510358]
mat_Sqrt:  [[0.15]]
grads:  [-0.04866394]
Stock Position:  -0.0486639418694382
Bond Position:  [10.76406067]


portfolio before change:  [5.77711392]
curr_Stock_Price:  102.53255110294597
curr_Factors:  [102.5325511]
mat_Sqrt:  [[0.15]]
grads:  [0.01675336]
Stock Position:  0.016753358923763624
Bond Position:  [4.05934929]


portfolio before change:  [5.77260563]
curr_Stock_Price:  102.20287058152448
curr_Factors:  [102.20287058]
mat_Sqrt:  [[0.15]]
grads:  [-0.02048693]
Stock Position:  -0.020486927942056112
Bond Position:  [7.86642847]


portfolio before change:  [5.76996041]
curr_Stock_Price:  102.42799315820655
curr_Factors:  [102.42799316]
mat_Sqrt:  [[0.15]]
grads:  [-0.03996008]
Stock Position:  -0.03996007560104916
Bond Position:  [9.86299076]


portfolio before change:  [5.88935669]
curr_Stock_Price:  99.50181695133107
curr_Factors:  [99.50181695]
mat_Sqrt:  [[0.15]]
grads:  [0.03232303]
Stock Position:  0.03232303253313333
Bond Position:  [2.67315622]


portfolio before change:  [5.87004915]
curr_Stock_Price:  98.88380830289854
curr_Factors:  [98.8838083]
mat_Sqrt:  [[0.15]]
grads:  [-0.00527523]
Stock Position:  -0.005275234004967441
Bond Position:  [6.39168437]


portfolio before change:  [5.86095848]
curr_Stock_Price:  100.91002819089594
curr_Factors:  [100.91002819]
mat_Sqrt:  [[0.15]]
grads:  [0.01032474]
Stock Position:  0.010324736588989756
Bond Position:  [4.81908902]


portfolio before change:  [5.86799067]
curr_Stock_Price:  101.47442638470746
curr_Factors:  [101.47442638]
mat_Sqrt:  [[0.15]]
grads:  [0.14705795]
Stock Position:  0.14705794984310905
Bond Position:  [-9.05463044]


portfolio before change:  [5.82506607]
curr_Stock_Price:  101.19793223366756
curr_Factors:  [101.19793223]
mat_Sqrt:  [[0.15]]
grads:  [0.01557744]
Stock Position:  0.015577435319226684
Bond Position:  [4.24866182]


portfolio before change:  [5.8174554]
curr_Stock_Price:  100.64116751974312
curr_Factors:  [100.64116752]
mat_Sqrt:  [[0.15]]
grads:  [0.06415063]
Stock Position:  0.06415063418645109
Bond Position:  [-0.63873932]


portfolio before change:  [5.74683355]
curr_Stock_Price:  99.54278170264834
curr_Factors:  [99.5427817]
mat_Sqrt:  [[0.15]]
grads:  [-0.03248535]
Stock Position:  -0.03248534683617694
Bond Position:  [8.98051533]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.73188766]
Stock Price:  100.07198336699699
PL:  [5.65990429]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 9.81648344e-04]
 [-8.59879157e-03]
 [-4.37866670e-03]
 [-1.95033421e-02]
 [ 5.71538415e-03]
 [-9.37417470e-03]
 [ 2.28265942e-03]
 [ 1.50744652e-02]
 [-1.60739594e-02]
 [ 1.50500202e-03]
 [-3.11666497e-03]
 [-4.55466956e-03]
 [ 8.12881100e-03]
 [ 2.40221335e-04]
 [ 1.08274322e-04]
 [ 2.26504064e-02]
 [ 1.80434233e-03]
 [ 1.19301820e-02]
 [-7.50802328e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-22.20494964]
curr_Stock_Price:  98.9200404463877
curr_Factors:  [98.92004045]
mat_Sqrt:  [[0.15]]
grads:  [0.00654432]
Stock Position:  0.006544322295748903
Bond Position:  [-22.85231427]


portfolio before change:  [-22.20152124]
curr_Stock_Price:  100.3170065936919
curr_Factors:  [100.31700659]
mat_Sqrt:  [[0.15]]
grads:  [-0.05732528]
Stock Position:  -0.05732527710595913
Bond Position:  [-16.45082104]


portfolio before change:  [-22.16951839]
curr_Stock_Price:  99.68698673840284
curr_Factors:  [99.68698674]
mat_Sqrt:  [[0.15]]
grads:  [-0.02919111]
Stock Position:  -0.029191111337501265
Bond Position:  [-19.25954447]


portfolio before change:  [-22.18121582]
curr_Stock_Price:  99.9227412713674
curr_Factors:  [99.92274127]
mat_Sqrt:  [[0.15]]
grads:  [-0.13002228]
Stock Position:  -0.13002228043278827
Bond Position:  [-9.18903313]


portfolio before change:  [-22.38962676]
curr_Stock_Price:  101.5079572348967
curr_Factors:  [101.50795723]
mat_Sqrt:  [[0.15]]
grads:  [0.03810256]
Stock Position:  0.03810256098376626
Bond Position:  [-26.25733989]


portfolio before change:  [-22.40913708]
curr_Stock_Price:  101.16821205025549
curr_Factors:  [101.16821205]
mat_Sqrt:  [[0.15]]
grads:  [-0.0624945]
Stock Position:  -0.06249449801912196
Bond Position:  [-16.08668045]


portfolio before change:  [-22.443694]
curr_Stock_Price:  101.65681106007162
curr_Factors:  [101.65681106]
mat_Sqrt:  [[0.15]]
grads:  [0.01521773]
Stock Position:  0.015217729473343926
Bond Position:  [-23.99067985]


portfolio before change:  [-22.46108993]
curr_Stock_Price:  100.9078481019799
curr_Factors:  [100.9078481]
mat_Sqrt:  [[0.15]]
grads:  [0.10049643]
Stock Position:  0.10049643457012399
Bond Position:  [-32.60196889]


portfolio before change:  [-22.35521761]
curr_Stock_Price:  102.04245387072993
curr_Factors:  [102.04245387]
mat_Sqrt:  [[0.15]]
grads:  [-0.10715973]
Stock Position:  -0.10715972919570112
Bond Position:  [-11.42037589]


portfolio before change:  [-22.49897565]
curr_Stock_Price:  103.35733764466966
curr_Factors:  [103.35733764]
mat_Sqrt:  [[0.15]]
grads:  [0.01003335]
Stock Position:  0.010033346831738444
Bond Position:  [-23.53599567]


portfolio before change:  [-22.51267322]
curr_Stock_Price:  102.57865110637321
curr_Factors:  [102.57865111]
mat_Sqrt:  [[0.15]]
grads:  [-0.02077777]
Stock Position:  -0.02077776648136423
Bond Position:  [-20.38131796]


portfolio before change:  [-22.52157519]
curr_Stock_Price:  102.76182807592632
curr_Factors:  [102.76182808]
mat_Sqrt:  [[0.15]]
grads:  [-0.03036446]
Stock Position:  -0.03036446371300107
Bond Position:  [-19.40126739]


portfolio before change:  [-22.52412273]
curr_Stock_Price:  102.68597016511362
curr_Factors:  [102.68597017]
mat_Sqrt:  [[0.15]]
grads:  [0.05419207]
Stock Position:  0.054192073324115846
Bond Position:  [-28.08888836]


portfolio before change:  [-22.56888902]
curr_Stock_Price:  101.98949942793145
curr_Factors:  [101.98949943]
mat_Sqrt:  [[0.15]]
grads:  [0.00160148]
Stock Position:  0.001601475566004438
Bond Position:  [-22.73222272]


portfolio before change:  [-22.57415389]
curr_Stock_Price:  102.25107360907516
curr_Factors:  [102.25107361]
mat_Sqrt:  [[0.15]]
grads:  [0.00072183]
Stock Position:  0.0007218288152428521
Bond Position:  [-22.64796166]


portfolio before change:  [-22.57881852]
curr_Stock_Price:  103.63376699040187
curr_Factors:  [103.63376699]
mat_Sqrt:  [[0.15]]
grads:  [0.15100271]
Stock Position:  0.15100270937248064
Bond Position:  [-38.22779811]


portfolio before change:  [-22.66863423]
curr_Stock_Price:  103.10226943066807
curr_Factors:  [103.10226943]
mat_Sqrt:  [[0.15]]
grads:  [0.01202895]
Stock Position:  0.012028948870420124
Bond Position:  [-23.90884616]


portfolio before change:  [-22.68484271]
curr_Stock_Price:  102.25177771049802
curr_Factors:  [102.25177771]
mat_Sqrt:  [[0.15]]
grads:  [0.07953455]
Stock Position:  0.07953454667668346
Bond Position:  [-30.8173915]


portfolio before change:  [-22.70647206]
curr_Stock_Price:  102.07670866618926
curr_Factors:  [102.07670867]
mat_Sqrt:  [[0.15]]
grads:  [-0.05005349]
Stock Position:  -0.05005348850283796
Bond Position:  [-17.5971767]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-22.70376383]
Stock Price:  101.93469908501025
PL:  [-24.63846291]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.93498696e-03]
 [ 3.10812551e-02]
 [-5.50988704e-03]
 [-1.06000906e-02]
 [ 5.71302173e-03]
 [-1.02181741e-02]
 [-3.94185282e-03]
 [ 4.75174960e-03]
 [-1.26920723e-02]
 [ 2.18160152e-03]
 [-3.31593038e-03]
 [-6.57945109e-03]
 [ 7.58684133e-03]
 [ 5.02182393e-05]
 [ 2.04263524e-04]
 [ 1.94027811e-02]
 [ 4.60623905e-03]
 [ 8.87720056e-03]
 [-5.28329440e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.43547685]
curr_Stock_Price:  100.21951102591319
curr_Factors:  [100.21951103]
mat_Sqrt:  [[0.15]]
grads:  [-0.01956658]
Stock Position:  -0.019566579703009998
Bond Position:  [8.3964299]


portfolio before change:  [6.40341183]
curr_Stock_Price:  101.9655696564502
curr_Factors:  [101.96556966]
mat_Sqrt:  [[0.15]]
grads:  [0.20720837]
Stock Position:  0.2072083671244704
Bond Position:  [-14.72470736]


portfolio before change:  [6.09027718]
curr_Stock_Price:  100.47213089177399
curr_Factors:  [100.47213089]
mat_Sqrt:  [[0.15]]
grads:  [-0.03673258]
Stock Position:  -0.036732580284915474
Bond Position:  [9.7808778]


portfolio before change:  [6.09948922]
curr_Stock_Price:  100.28792067697931
curr_Factors:  [100.28792068]
mat_Sqrt:  [[0.15]]
grads:  [-0.07066727]
Stock Position:  -0.07066727059708168
Bond Position:  [13.18656285]


portfolio before change:  [5.9808785]
curr_Stock_Price:  102.01301602263284
curr_Factors:  [102.01301602]
mat_Sqrt:  [[0.15]]
grads:  [0.03808681]
Stock Position:  0.03808681150856826
Bond Position:  [2.09552799]


portfolio before change:  [5.97880228]
curr_Stock_Price:  101.94474664008908
curr_Factors:  [101.94474664]
mat_Sqrt:  [[0.15]]
grads:  [-0.06812116]
Stock Position:  -0.06812116045617063
Bond Position:  [12.92339673]


portfolio before change:  [5.89213847]
curr_Stock_Price:  103.26438162897274
curr_Factors:  [103.26438163]
mat_Sqrt:  [[0.15]]
grads:  [-0.02627902]
Stock Position:  -0.02627901876873316
Bond Position:  [8.60582509]


portfolio before change:  [5.90088902]
curr_Stock_Price:  103.0132753312368
curr_Factors:  [103.01327533]
mat_Sqrt:  [[0.15]]
grads:  [0.03167833]
Stock Position:  0.03167833066241323
Bond Position:  [2.63760042]


portfolio before change:  [5.81629807]
curr_Stock_Price:  100.32214749241851
curr_Factors:  [100.32214749]
mat_Sqrt:  [[0.15]]
grads:  [-0.08461382]
Stock Position:  -0.08461381502880407
Bond Position:  [14.3049377]


portfolio before change:  [5.70118047]
curr_Stock_Price:  101.72492402733285
curr_Factors:  [101.72492403]
mat_Sqrt:  [[0.15]]
grads:  [0.01454401]
Stock Position:  0.014544010162853338
Bond Position:  [4.22169214]


portfolio before change:  [5.73231045]
curr_Stock_Price:  103.79274589665992
curr_Factors:  [103.7927459]
mat_Sqrt:  [[0.15]]
grads:  [-0.0221062]
Stock Position:  -0.02210620253862372
Bond Position:  [8.02677391]


portfolio before change:  [5.7727978]
curr_Stock_Price:  102.0520398399595
curr_Factors:  [102.05203984]
mat_Sqrt:  [[0.15]]
grads:  [-0.04386301]
Stock Position:  -0.04386300727819702
Bond Position:  [10.24910716]


portfolio before change:  [5.76354756]
curr_Stock_Price:  102.32135179192625
curr_Factors:  [102.32135179]
mat_Sqrt:  [[0.15]]
grads:  [0.05057894]
Stock Position:  0.05057894218320088
Bond Position:  [0.58824182]


portfolio before change:  [5.708102]
curr_Stock_Price:  101.22222554047411
curr_Factors:  [101.22222554]
mat_Sqrt:  [[0.15]]
grads:  [0.00033479]
Stock Position:  0.0003347882623129112
Bond Position:  [5.67421398]


portfolio before change:  [5.70978544]
curr_Stock_Price:  102.01290350347927
curr_Factors:  [102.0129035]
mat_Sqrt:  [[0.15]]
grads:  [0.00136176]
Stock Position:  0.0013617568284253075
Bond Position:  [5.57086867]


portfolio before change:  [5.70911406]
curr_Stock_Price:  100.4970202617052
curr_Factors:  [100.49702026]
mat_Sqrt:  [[0.15]]
grads:  [0.12935187]
Stock Position:  0.12935187369596782
Bond Position:  [-7.29036381]


portfolio before change:  [5.62069959]
curr_Stock_Price:  99.8275931475954
curr_Factors:  [99.82759315]
mat_Sqrt:  [[0.15]]
grads:  [0.03070826]
Stock Position:  0.030708260300286543
Bond Position:  [2.55516788]


portfolio before change:  [5.6296981]
curr_Stock_Price:  100.09982070129834
curr_Factors:  [100.0998207]
mat_Sqrt:  [[0.15]]
grads:  [0.05918134]
Stock Position:  0.05918133709720902
Bond Position:  [-0.29434313]


portfolio before change:  [5.6474844]
curr_Stock_Price:  100.40160333598782
curr_Factors:  [100.40160334]
mat_Sqrt:  [[0.15]]
grads:  [-0.03522196]
Stock Position:  -0.03522196269023745
Bond Position:  [9.18382593]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.632033]
Stock Price:  100.90548337804616
PL:  [4.72654963]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.45557736e-02]
 [-9.47825501e-03]
 [-1.02846171e-02]
 [-7.85496486e-03]
 [ 5.92039313e-04]
 [-1.10221829e-02]
 [ 1.28430215e-02]
 [-3.46938684e-02]
 [-3.05056573e-04]
 [ 8.71607161e-03]
 [-4.22404608e-03]
 [-1.11769450e-03]
 [ 5.28131039e-03]
 [-1.10197295e-03]
 [ 7.85237733e-03]
 [ 2.13171977e-02]
 [ 1.05634395e-02]
 [ 4.76485710e-04]
 [-9.64166625e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.36192194]
curr_Stock_Price:  100.76063650498894
curr_Factors:  [100.7606365]
mat_Sqrt:  [[0.15]]
grads:  [-0.09703849]
Stock Position:  -0.09703849074634464
Bond Position:  [28.13958203]


portfolio before change:  [18.41780852]
curr_Stock_Price:  100.25721976404435
curr_Factors:  [100.25721976]
mat_Sqrt:  [[0.15]]
grads:  [-0.06318837]
Stock Position:  -0.06318836676538728
Bond Position:  [24.75289849]


portfolio before change:  [18.57980045]
curr_Stock_Price:  97.79152964306006
curr_Factors:  [97.79152964]
mat_Sqrt:  [[0.15]]
grads:  [-0.06856411]
Stock Position:  -0.06856411416543234
Bond Position:  [25.28479005]


portfolio before change:  [18.57594162]
curr_Stock_Price:  97.94001561802584
curr_Factors:  [97.94001562]
mat_Sqrt:  [[0.15]]
grads:  [-0.05236643]
Stock Position:  -0.052366432414032014
Bond Position:  [23.70471083]


portfolio before change:  [18.56549502]
curr_Stock_Price:  98.25268781945934
curr_Factors:  [98.25268782]
mat_Sqrt:  [[0.15]]
grads:  [0.00394693]
Stock Position:  0.003946928756604377
Bond Position:  [18.17769866]


portfolio before change:  [18.56647892]
curr_Stock_Price:  97.35044413631323
curr_Factors:  [97.35044414]
mat_Sqrt:  [[0.15]]
grads:  [-0.07348122]
Stock Position:  -0.07348121931105346
Bond Position:  [25.71990825]


portfolio before change:  [18.64437855]
curr_Stock_Price:  96.37783028488285
curr_Factors:  [96.37783028]
mat_Sqrt:  [[0.15]]
grads:  [0.08562014]
Stock Position:  0.08562014333692604
Bond Position:  [10.39249491]


portfolio before change:  [18.80991949]
curr_Stock_Price:  98.28091620249855
curr_Factors:  [98.2809162]
mat_Sqrt:  [[0.15]]
grads:  [-0.23129246]
Stock Position:  -0.2312924557354322
Bond Position:  [41.54155395]


portfolio before change:  [18.94822752]
curr_Stock_Price:  97.72784434275225
curr_Factors:  [97.72784434]
mat_Sqrt:  [[0.15]]
grads:  [-0.00203371]
Stock Position:  -0.0020337104852096873
Bond Position:  [19.14697766]


portfolio before change:  [18.94975214]
curr_Stock_Price:  99.33216750768263
curr_Factors:  [99.33216751]
mat_Sqrt:  [[0.15]]
grads:  [0.05810714]
Stock Position:  0.05810714405745317
Bond Position:  [13.17784357]


portfolio before change:  [18.91111199]
curr_Stock_Price:  98.61048308508398
curr_Factors:  [98.61048309]
mat_Sqrt:  [[0.15]]
grads:  [-0.02816031]
Stock Position:  -0.02816030720339027
Bond Position:  [21.68801349]


portfolio before change:  [18.91295048]
curr_Stock_Price:  98.7377610108732
curr_Factors:  [98.73776101]
mat_Sqrt:  [[0.15]]
grads:  [-0.0074513]
Stock Position:  -0.007451296654267629
Bond Position:  [19.64867483]


portfolio before change:  [18.92172551]
curr_Stock_Price:  98.21942897393855
curr_Factors:  [98.21942897]
mat_Sqrt:  [[0.15]]
grads:  [0.03520874]
Stock Position:  0.0352087359532347
Bond Position:  [15.46354357]


portfolio before change:  [18.89738241]
curr_Stock_Price:  97.4182223082635
curr_Factors:  [97.41822231]
mat_Sqrt:  [[0.15]]
grads:  [-0.00734649]
Stock Position:  -0.007346486300775728
Bond Position:  [19.61306404]


portfolio before change:  [18.91539014]
curr_Stock_Price:  95.63453227235792
curr_Factors:  [95.63453227]
mat_Sqrt:  [[0.15]]
grads:  [0.05234918]
Stock Position:  0.05234918217488183
Bond Position:  [13.90900059]


portfolio before change:  [18.92122999]
curr_Stock_Price:  95.67965550035655
curr_Factors:  [95.6796555]
mat_Sqrt:  [[0.15]]
grads:  [0.14211465]
Stock Position:  0.14211465141656698
Bond Position:  [5.3237491]


portfolio before change:  [18.77539392]
curr_Stock_Price:  94.64410308933219
curr_Factors:  [94.64410309]
mat_Sqrt:  [[0.15]]
grads:  [0.07042293]
Stock Position:  0.07042292980279
Bond Position:  [12.1102789]


portfolio before change:  [18.82640256]
curr_Stock_Price:  95.32542505928625
curr_Factors:  [95.32542506]
mat_Sqrt:  [[0.15]]
grads:  [0.00317657]
Stock Position:  0.003176571397585174
Bond Position:  [18.52359454]


portfolio before change:  [18.8272902]
curr_Stock_Price:  94.14684512223984
curr_Factors:  [94.14684512]
mat_Sqrt:  [[0.15]]
grads:  [-0.06427777]
Stock Position:  -0.06427777498979875
Bond Position:  [24.87883992]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.86801884]
Stock Price:  93.60998528603476
PL:  [18.86801884]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.84903542e-02]
 [ 2.65616342e-02]
 [-2.07142295e-02]
 [ 3.62902152e-02]
 [ 6.49665469e-03]
 [-9.84080156e-03]
 [ 1.25927416e-02]
 [ 1.36009578e-02]
 [-1.51154242e-02]
 [ 3.61013262e-03]
 [-2.92836363e-03]
 [-5.26123684e-03]
 [ 4.97660472e-03]
 [-7.19258473e-04]
 [ 7.82053134e-03]
 [ 1.84944500e-02]
 [ 3.41219218e-03]
 [ 7.29202887e-03]
 [-4.68903238e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [29.60485059]
curr_Stock_Price:  101.27074954453718
curr_Factors:  [101.27074954]
mat_Sqrt:  [[0.15]]
grads:  [-0.12326903]
Stock Position:  -0.12326902778587112
Bond Position:  [42.08839743]


portfolio before change:  [29.55804411]
curr_Stock_Price:  101.73582907115026
curr_Factors:  [101.73582907]
mat_Sqrt:  [[0.15]]
grads:  [0.17707756]
Stock Position:  0.17707756152526175
Bond Position:  [11.54291158]


portfolio before change:  [29.48803454]
curr_Stock_Price:  101.32416959981836
curr_Factors:  [101.3241696]
mat_Sqrt:  [[0.15]]
grads:  [-0.13809486]
Stock Position:  -0.1380948631011007
Bond Position:  [43.48038187]


portfolio before change:  [29.40082631]
curr_Stock_Price:  102.03440373421283
curr_Factors:  [102.03440373]
mat_Sqrt:  [[0.15]]
grads:  [0.24193477]
Stock Position:  0.24193476794708652
Bond Position:  [4.71515652]


portfolio before change:  [29.02583982]
curr_Stock_Price:  100.47958202094185
curr_Factors:  [100.47958202]
mat_Sqrt:  [[0.15]]
grads:  [0.04331103]
Stock Position:  0.04331103129564189
Bond Position:  [24.67396549]


portfolio before change:  [29.02270351]
curr_Stock_Price:  100.2647276315755
curr_Factors:  [100.26472763]
mat_Sqrt:  [[0.15]]
grads:  [-0.06560534]
Stock Position:  -0.06560534371076955
Bond Position:  [35.60060543]


portfolio before change:  [29.0344651]
curr_Stock_Price:  100.2211286329387
curr_Factors:  [100.22112863]
mat_Sqrt:  [[0.15]]
grads:  [0.08395161]
Stock Position:  0.08395161087754359
Bond Position:  [20.62073991]


portfolio before change:  [29.07474647]
curr_Stock_Price:  100.63953074721276
curr_Factors:  [100.63953075]
mat_Sqrt:  [[0.15]]
grads:  [0.09067305]
Stock Position:  0.09067305183172786
Bond Position:  [19.94945308]


portfolio before change:  [29.08118089]
curr_Stock_Price:  100.65548298588428
curr_Factors:  [100.65548299]
mat_Sqrt:  [[0.15]]
grads:  [-0.10076949]
Stock Position:  -0.10076949446108095
Bond Position:  [39.22418303]


portfolio before change:  [29.11394584]
curr_Stock_Price:  100.42765934599986
curr_Factors:  [100.42765935]
mat_Sqrt:  [[0.15]]
grads:  [0.02406755]
Stock Position:  0.024067550775150118
Bond Position:  [26.69689804]


portfolio before change:  [29.1164299]
curr_Stock_Price:  100.25352451450522
curr_Factors:  [100.25352451]
mat_Sqrt:  [[0.15]]
grads:  [-0.01952242]
Stock Position:  -0.019522424170470874
Bond Position:  [31.07362173]


portfolio before change:  [29.11733107]
curr_Stock_Price:  100.60533529163895
curr_Factors:  [100.60533529]
mat_Sqrt:  [[0.15]]
grads:  [-0.03507491]
Stock Position:  -0.035074912264216
Bond Position:  [32.64605438]


portfolio before change:  [29.19125269]
curr_Stock_Price:  98.73051717060704
curr_Factors:  [98.73051717]
mat_Sqrt:  [[0.15]]
grads:  [0.03317736]
Stock Position:  0.03317736482133849
Bond Position:  [25.9156343]


portfolio before change:  [29.21167873]
curr_Stock_Price:  99.15087367839303
curr_Factors:  [99.15087368]
mat_Sqrt:  [[0.15]]
grads:  [-0.00479506]
Stock Position:  -0.004795056484890774
Bond Position:  [29.68711277]


portfolio before change:  [29.22216271]
curr_Stock_Price:  98.51244910954074
curr_Factors:  [98.51244911]
mat_Sqrt:  [[0.15]]
grads:  [0.05213688]
Stock Position:  0.05213687560468503
Bond Position:  [24.08603141]


portfolio before change:  [29.31994158]
curr_Stock_Price:  100.27236672197697
curr_Factors:  [100.27236672]
mat_Sqrt:  [[0.15]]
grads:  [0.12329633]
Stock Position:  0.1232963333160967
Bond Position:  [16.95672643]


portfolio before change:  [29.37079428]
curr_Stock_Price:  100.65042329764388
curr_Factors:  [100.6504233]
mat_Sqrt:  [[0.15]]
grads:  [0.02274795]
Stock Position:  0.02274794788159799
Bond Position:  [27.0812037]


portfolio before change:  [29.34768413]
curr_Stock_Price:  99.33684118524465
curr_Factors:  [99.33684119]
mat_Sqrt:  [[0.15]]
grads:  [0.04861353]
Stock Position:  0.048613525819124925
Bond Position:  [24.51857004]


portfolio before change:  [29.27002368]
curr_Stock_Price:  97.61322903816858
curr_Factors:  [97.61322904]
mat_Sqrt:  [[0.15]]
grads:  [-0.03126022]
Stock Position:  -0.03126021584783117
Bond Position:  [32.32143429]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [29.32744981]
Stock Price:  96.0347125822289
PL:  [29.32744981]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 1.18074255e-03]
 [-7.82103032e-04]
 [-1.41040818e-02]
 [ 9.55004555e-03]
 [-8.05306470e-03]
 [-1.11324890e-02]
 [ 1.28975921e-02]
 [-4.81995413e-02]
 [ 4.69574228e-03]
 [ 6.29702056e-03]
 [-1.56982986e-02]
 [ 2.62351403e-02]
 [ 7.12955106e-03]
 [-1.72135191e-03]
 [ 7.25454434e-03]
 [ 2.21283272e-02]
 [ 1.39723867e-02]
 [-9.52509606e-05]
 [-1.11644544e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.24640097]
curr_Stock_Price:  98.96353162152272
curr_Factors:  [98.96353162]
mat_Sqrt:  [[0.15]]
grads:  [0.00787162]
Stock Position:  0.007871616984929341
Bond Position:  [-22.02540398]


portfolio before change:  [-21.25784378]
curr_Stock_Price:  98.20945842849599
curr_Factors:  [98.20945843]
mat_Sqrt:  [[0.15]]
grads:  [-0.00521402]
Stock Position:  -0.0052140202165397165
Bond Position:  [-20.74577768]


portfolio before change:  [-21.25498202]
curr_Stock_Price:  96.6657648728405
curr_Factors:  [96.66576487]
mat_Sqrt:  [[0.15]]
grads:  [-0.09402721]
Stock Position:  -0.0940272117296699
Bond Position:  [-12.16576968]


portfolio before change:  [-21.28388897]
curr_Stock_Price:  96.94084616458919
curr_Factors:  [96.94084616]
mat_Sqrt:  [[0.15]]
grads:  [0.06366697]
Stock Position:  0.0636669703077482
Bond Position:  [-27.45581895]


portfolio before change:  [-21.35597055]
curr_Stock_Price:  95.91650399257327
curr_Factors:  [95.91650399]
mat_Sqrt:  [[0.15]]
grads:  [-0.0536871]
Stock Position:  -0.05368709797812288
Bond Position:  [-16.2064918]


portfolio before change:  [-21.42016517]
curr_Stock_Price:  97.03674506673825
curr_Factors:  [97.03674507]
mat_Sqrt:  [[0.15]]
grads:  [-0.07421659]
Stock Position:  -0.0742165933631808
Bond Position:  [-14.21842852]


portfolio before change:  [-21.36817885]
curr_Stock_Price:  96.28837635871233
curr_Factors:  [96.28837636]
mat_Sqrt:  [[0.15]]
grads:  [0.08598395]
Stock Position:  0.08598394719428008
Bond Position:  [-29.64743351]


portfolio before change:  [-21.45927836]
curr_Stock_Price:  95.31509321354349
curr_Factors:  [95.31509321]
mat_Sqrt:  [[0.15]]
grads:  [-0.32133028]
Stock Position:  -0.32133027542352716
Bond Position:  [9.1683468]


portfolio before change:  [-21.34901393]
curr_Stock_Price:  94.97907740661915
curr_Factors:  [94.97907741]
mat_Sqrt:  [[0.15]]
grads:  [0.03130495]
Stock Position:  0.03130494856204017
Bond Position:  [-24.32232906]


portfolio before change:  [-21.3477465]
curr_Stock_Price:  95.2138254070842
curr_Factors:  [95.21382541]
mat_Sqrt:  [[0.15]]
grads:  [0.04198014]
Stock Position:  0.041980137044279116
Bond Position:  [-25.34483594]


portfolio before change:  [-21.41422633]
curr_Stock_Price:  93.78117582956462
curr_Factors:  [93.78117583]
mat_Sqrt:  [[0.15]]
grads:  [-0.10465532]
Stock Position:  -0.104655324071014
Bond Position:  [-11.59952698]


portfolio before change:  [-21.3504971]
curr_Stock_Price:  93.14451955315045
curr_Factors:  [93.14451955]
mat_Sqrt:  [[0.15]]
grads:  [0.17490094]
Stock Position:  0.17490093542207302
Bond Position:  [-37.6415607]


portfolio before change:  [-21.13757029]
curr_Stock_Price:  94.41574421236251
curr_Factors:  [94.41574421]
mat_Sqrt:  [[0.15]]
grads:  [0.04753034]
Stock Position:  0.047530340422572426
Bond Position:  [-25.62518275]


portfolio before change:  [-21.13327116]
curr_Stock_Price:  94.64099445061584
curr_Factors:  [94.64099445]
mat_Sqrt:  [[0.15]]
grads:  [-0.01147568]
Stock Position:  -0.011475679381816276
Bond Position:  [-20.04720145]


portfolio before change:  [-21.13769852]
curr_Stock_Price:  94.59001122362774
curr_Factors:  [94.59001122]
mat_Sqrt:  [[0.15]]
grads:  [0.04836363]
Stock Position:  0.0483636289084982
Bond Position:  [-25.71241472]


portfolio before change:  [-21.16975134]
curr_Stock_Price:  94.06019344300533
curr_Factors:  [94.06019344]
mat_Sqrt:  [[0.15]]
grads:  [0.14752218]
Stock Position:  0.147522181531191
Bond Position:  [-35.04571627]


portfolio before change:  [-21.36747932]
curr_Stock_Price:  92.77926433304705
curr_Factors:  [92.77926433]
mat_Sqrt:  [[0.15]]
grads:  [0.09314924]
Stock Position:  0.09314924483552126
Bond Position:  [-30.00979773]


portfolio before change:  [-21.4375051]
curr_Stock_Price:  92.10805767737214
curr_Factors:  [92.10805768]
mat_Sqrt:  [[0.15]]
grads:  [-0.00063501]
Stock Position:  -0.0006350064041382604
Bond Position:  [-21.3790159]


portfolio before change:  [-21.44238071]
curr_Stock_Price:  91.36819302198126
curr_Factors:  [91.36819302]
mat_Sqrt:  [[0.15]]
grads:  [-0.0744297]
Stock Position:  -0.07442969578737374
Bond Position:  [-14.64187389]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.60069324]
Stock Price:  93.44601437410596
PL:  [-21.60069324]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.32814668e-03]
 [-7.90263333e-04]
 [-1.02565161e-02]
 [ 6.26303822e-03]
 [-8.42810392e-03]
 [-1.15344895e-02]
 [ 1.40314296e-02]
 [-5.69599587e-02]
 [ 6.82542520e-03]
 [ 5.05386514e-03]
 [-1.32755571e-02]
 [ 1.63911069e-02]
 [ 6.84570903e-03]
 [-1.89155532e-03]
 [ 7.12068954e-03]
 [ 2.32701098e-02]
 [ 1.20255415e-02]
 [ 3.36730330e-04]
 [-9.27522588e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.78176655]
curr_Stock_Price:  99.84667907611525
curr_Factors:  [99.84667908]
mat_Sqrt:  [[0.15]]
grads:  [0.01552098]
Stock Position:  0.015520977890177192
Bond Position:  [-3.33148465]


portfolio before change:  [-1.80764308]
curr_Stock_Price:  98.23314982065993
curr_Factors:  [98.23314982]
mat_Sqrt:  [[0.15]]
grads:  [-0.00526842]
Stock Position:  -0.005268422222555095
Bond Position:  [-1.29010937]


portfolio before change:  [-1.80568264]
curr_Stock_Price:  97.799812260708
curr_Factors:  [97.79981226]
mat_Sqrt:  [[0.15]]
grads:  [-0.06837677]
Stock Position:  -0.06837677387300549
Bond Position:  [4.881553]


portfolio before change:  [-1.75863128]
curr_Stock_Price:  97.12954339812474
curr_Factors:  [97.1295434]
mat_Sqrt:  [[0.15]]
grads:  [0.04175359]
Stock Position:  0.04175358813217542
Bond Position:  [-5.81413823]


portfolio before change:  [-1.81540859]
curr_Stock_Price:  95.80454124717097
curr_Factors:  [95.80454125]
mat_Sqrt:  [[0.15]]
grads:  [-0.05618736]
Stock Position:  -0.05618735946045177
Bond Position:  [3.56759561]


portfolio before change:  [-1.8195148]
curr_Stock_Price:  95.89349758126443
curr_Factors:  [95.89349758]
mat_Sqrt:  [[0.15]]
grads:  [-0.0768966]
Stock Position:  -0.07689659664504042
Bond Position:  [5.5543688]


portfolio before change:  [-1.70556897]
curr_Stock_Price:  94.42975182874665
curr_Factors:  [94.42975183]
mat_Sqrt:  [[0.15]]
grads:  [0.09354286]
Stock Position:  0.09354286386033853
Bond Position:  [-10.53879839]


portfolio before change:  [-1.70929843]
curr_Stock_Price:  94.41805208423871
curr_Factors:  [94.41805208]
mat_Sqrt:  [[0.15]]
grads:  [-0.37973306]
Stock Position:  -0.3797330579578952
Bond Position:  [34.14435722]


portfolio before change:  [-1.440219]
curr_Stock_Price:  93.73193255964044
curr_Factors:  [93.73193256]
mat_Sqrt:  [[0.15]]
grads:  [0.04550283]
Stock Position:  0.045502834670832555
Bond Position:  [-5.70528764]


portfolio before change:  [-1.40997891]
curr_Stock_Price:  94.42785831179536
curr_Factors:  [94.42785831]
mat_Sqrt:  [[0.15]]
grads:  [0.03369243]
Stock Position:  0.033692434292808666
Bond Position:  [-4.59148332]


portfolio before change:  [-1.40126455]
curr_Stock_Price:  94.72057602334398
curr_Factors:  [94.72057602]
mat_Sqrt:  [[0.15]]
grads:  [-0.08850371]
Stock Position:  -0.08850371389616993
Bond Position:  [6.98185821]


portfolio before change:  [-1.43277297]
curr_Stock_Price:  95.09631279311398
curr_Factors:  [95.09631279]
mat_Sqrt:  [[0.15]]
grads:  [0.10927405]
Stock Position:  0.10927404617143885
Bond Position:  [-11.82433184]


portfolio before change:  [-1.44907491]
curr_Stock_Price:  94.97418417798156
curr_Factors:  [94.97418418]
mat_Sqrt:  [[0.15]]
grads:  [0.04563806]
Stock Position:  0.04563806022206674
Bond Position:  [-5.78351245]


portfolio before change:  [-1.49943842]
curr_Stock_Price:  93.90232757611012
curr_Factors:  [93.90232758]
mat_Sqrt:  [[0.15]]
grads:  [-0.01261037]
Stock Position:  -0.012610368767855243
Bond Position:  [-0.31529545]


portfolio before change:  [-1.50437128]
curr_Stock_Price:  94.28725034550982
curr_Factors:  [94.28725035]
mat_Sqrt:  [[0.15]]
grads:  [0.04747126]
Stock Position:  0.04747126360820665
Bond Position:  [-5.98030619]


portfolio before change:  [-1.62486204]
curr_Stock_Price:  91.78056541430044
curr_Factors:  [91.78056541]
mat_Sqrt:  [[0.15]]
grads:  [0.15513407]
Stock Position:  0.15513406546475142
Bond Position:  [-15.86315428]


portfolio before change:  [-1.30867725]
curr_Stock_Price:  93.84427126415777
curr_Factors:  [93.84427126]
mat_Sqrt:  [[0.15]]
grads:  [0.08017028]
Stock Position:  0.08017027657518798
Bond Position:  [-8.83219843]


portfolio before change:  [-1.26794098]
curr_Stock_Price:  94.3799385637786
curr_Factors:  [94.37993856]
mat_Sqrt:  [[0.15]]
grads:  [0.00224487]
Stock Position:  0.0022448688694960118
Bond Position:  [-1.47981156]


portfolio before change:  [-1.26733321]
curr_Stock_Price:  94.81549382223683
curr_Factors:  [94.81549382]
mat_Sqrt:  [[0.15]]
grads:  [-0.06183484]
Stock Position:  -0.0618348392069637
Bond Position:  [4.5955676]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.29378254]
Stock Price:  95.26181771639705
PL:  [-1.29378254]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.88977547e-02]
 [-9.84075304e-03]
 [-2.38108680e-02]
 [ 2.17534411e-03]
 [ 6.54964792e-03]
 [-9.49042013e-03]
 [ 6.75812334e-03]
 [-9.39674961e-03]
 [-6.02792751e-04]
 [ 8.03916871e-03]
 [-2.98583465e-03]
 [-5.08080362e-03]
 [ 5.30926018e-03]
 [ 2.63313681e-04]
 [ 4.94425552e-04]
 [ 2.29529452e-02]
 [ 3.36635095e-03]
 [ 1.28092197e-02]
 [-1.60229626e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [31.31761244]
curr_Stock_Price:  101.34846080463184
curr_Factors:  [101.3484608]
mat_Sqrt:  [[0.15]]
grads:  [-0.12598503]
Stock Position:  -0.12598503105364295
Bond Position:  [44.08600143]


portfolio before change:  [31.48637953]
curr_Stock_Price:  100.09637392101159
curr_Factors:  [100.09637392]
mat_Sqrt:  [[0.15]]
grads:  [-0.06560502]
Stock Position:  -0.06560502025433207
Bond Position:  [38.05320416]


portfolio before change:  [31.40384115]
curr_Stock_Price:  101.49951151704552
curr_Factors:  [101.49951152]
mat_Sqrt:  [[0.15]]
grads:  [-0.15873912]
Stock Position:  -0.15873911993735124
Bond Position:  [47.51578428]


portfolio before change:  [31.52578424]
curr_Stock_Price:  100.80615585593297
curr_Factors:  [100.80615586]
mat_Sqrt:  [[0.15]]
grads:  [0.01450229]
Stock Position:  0.014502294084430089
Bond Position:  [30.06386373]


portfolio before change:  [31.52334008]
curr_Stock_Price:  100.1192939644242
curr_Factors:  [100.11929396]
mat_Sqrt:  [[0.15]]
grads:  [0.04366432]
Stock Position:  0.04366431944465752
Bond Position:  [27.15169924]


portfolio before change:  [31.58720692]
curr_Stock_Price:  101.42649560530269
curr_Factors:  [101.42649561]
mat_Sqrt:  [[0.15]]
grads:  [-0.06326947]
Stock Position:  -0.0632694675289871
Bond Position:  [38.00440729]


portfolio before change:  [31.6201112]
curr_Stock_Price:  101.05661757591896
curr_Factors:  [101.05661758]
mat_Sqrt:  [[0.15]]
grads:  [0.04505416]
Stock Position:  0.04505415561573017
Bond Position:  [27.06709062]


portfolio before change:  [31.56709049]
curr_Stock_Price:  99.72958516560468
curr_Factors:  [99.72958517]
mat_Sqrt:  [[0.15]]
grads:  [-0.062645]
Stock Position:  -0.06264499739025871
Bond Position:  [37.81465009]


portfolio before change:  [31.58557901]
curr_Stock_Price:  99.58538096466296
curr_Factors:  [99.58538096]
mat_Sqrt:  [[0.15]]
grads:  [-0.00401862]
Stock Position:  -0.004018618340434303
Bond Position:  [31.98577464]


portfolio before change:  [31.59396064]
curr_Stock_Price:  99.48977949246095
curr_Factors:  [99.48977949]
mat_Sqrt:  [[0.15]]
grads:  [0.05359446]
Stock Position:  0.05359445804089582
Bond Position:  [26.26185982]


portfolio before change:  [31.62138672]
curr_Stock_Price:  99.87899512787199
curr_Factors:  [99.87899513]
mat_Sqrt:  [[0.15]]
grads:  [-0.01990556]
Stock Position:  -0.019905564324746158
Bond Position:  [33.60953448]


portfolio before change:  [31.6171907]
curr_Stock_Price:  100.511956786758
curr_Factors:  [100.51195679]
mat_Sqrt:  [[0.15]]
grads:  [-0.03387202]
Stock Position:  -0.03387202411590972
Bond Position:  [35.02173412]


portfolio before change:  [31.61433172]
curr_Stock_Price:  100.8548801171486
curr_Factors:  [100.85488012]
mat_Sqrt:  [[0.15]]
grads:  [0.03539507]
Stock Position:  0.03539506784085442
Bond Position:  [28.04456639]


portfolio before change:  [31.65614817]
curr_Stock_Price:  101.8381931921305
curr_Factors:  [101.83819319]
mat_Sqrt:  [[0.15]]
grads:  [0.00175542]
Stock Position:  0.0017554245432033183
Bond Position:  [31.47737891]


portfolio before change:  [31.66303378]
curr_Stock_Price:  101.27723780100601
curr_Factors:  [101.2772378]
mat_Sqrt:  [[0.15]]
grads:  [0.00329617]
Stock Position:  0.003296170344835002
Bond Position:  [31.32920675]


portfolio before change:  [31.67502325]
curr_Stock_Price:  102.53815287631868
curr_Factors:  [102.53815288]
mat_Sqrt:  [[0.15]]
grads:  [0.15301963]
Stock Position:  0.15301963480997796
Bond Position:  [15.98467255]


portfolio before change:  [31.8759109]
curr_Stock_Price:  103.82485688760515
curr_Factors:  [103.82485689]
mat_Sqrt:  [[0.15]]
grads:  [0.02244234]
Stock Position:  0.022442339641231265
Bond Position:  [29.5458382]


portfolio before change:  [31.87425287]
curr_Stock_Price:  103.42180580257447
curr_Factors:  [103.4218058]
mat_Sqrt:  [[0.15]]
grads:  [0.0853948]
Stock Position:  0.08539479817197972
Bond Position:  [23.04256864]


portfolio before change:  [32.01434938]
curr_Stock_Price:  104.9949127210727
curr_Factors:  [104.99491272]
mat_Sqrt:  [[0.15]]
grads:  [-0.10681975]
Stock Position:  -0.10681975092366701
Bond Position:  [43.22987981]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [32.14899059]
Stock Price:  103.83564787869823
PL:  [28.31334271]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.74162640e-03]
 [ 3.09828037e-02]
 [-5.47490960e-02]
 [ 6.23297647e-02]
 [ 5.38729509e-03]
 [-1.55443813e-02]
 [-9.55167195e-03]
 [-7.42634655e-03]
 [ 5.36674285e-02]
 [-3.96394487e-03]
 [-4.49385144e-03]
 [ 2.42204516e-02]
 [ 1.23938908e-02]
 [-3.90238528e-03]
 [ 7.70520852e-03]
 [ 2.17427256e-02]
 [ 6.60971363e-03]
 [ 1.36597509e-02]
 [-1.28866075e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.57240976]
curr_Stock_Price:  99.72006229035219
curr_Factors:  [99.72006229]
mat_Sqrt:  [[0.15]]
grads:  [0.01827751]
Stock Position:  0.018277509308362434
Bond Position:  [-6.39504413]


portfolio before change:  [-4.53305656]
curr_Stock_Price:  101.96063891680004
curr_Factors:  [101.96063892]
mat_Sqrt:  [[0.15]]
grads:  [0.20655202]
Stock Position:  0.20655202458269709
Bond Position:  [-25.59323296]


portfolio before change:  [-4.21500943]
curr_Stock_Price:  103.53141142580083
curr_Factors:  [103.53141143]
mat_Sqrt:  [[0.15]]
grads:  [-0.36499397]
Stock Position:  -0.36499397312741155
Bond Position:  [33.57333177]


portfolio before change:  [-4.21616745]
curr_Stock_Price:  103.55758282510544
curr_Factors:  [103.55758283]
mat_Sqrt:  [[0.15]]
grads:  [0.41553176]
Stock Position:  0.4155317648261927
Bond Position:  [-47.2476326]


portfolio before change:  [-4.21347185]
curr_Stock_Price:  103.5924994800258
curr_Factors:  [103.59249948]
mat_Sqrt:  [[0.15]]
grads:  [0.0359153]
Stock Position:  0.03591530062943949
Bond Position:  [-7.93402762]


portfolio before change:  [-4.19823964]
curr_Stock_Price:  104.07184861780469
curr_Factors:  [104.07184862]
mat_Sqrt:  [[0.15]]
grads:  [-0.10362921]
Stock Position:  -0.10362920842990633
Bond Position:  [6.58664365]


portfolio before change:  [-4.27783058]
curr_Stock_Price:  104.85577630350187
curr_Factors:  [104.8557763]
mat_Sqrt:  [[0.15]]
grads:  [-0.06367781]
Stock Position:  -0.06367781301817892
Bond Position:  [2.39915594]


portfolio before change:  [-4.35445125]
curr_Stock_Price:  106.06845200183793
curr_Factors:  [106.068452]
mat_Sqrt:  [[0.15]]
grads:  [-0.04950898]
Stock Position:  -0.04950897701710797
Bond Position:  [0.8968893]


portfolio before change:  [-4.46564105]
curr_Stock_Price:  108.3188326424957
curr_Factors:  [108.31883264]
mat_Sqrt:  [[0.15]]
grads:  [0.35778286]
Stock Position:  0.35778285692264467
Bond Position:  [-43.22026245]


portfolio before change:  [-4.85143966]
curr_Stock_Price:  107.27073268865674
curr_Factors:  [107.27073269]
mat_Sqrt:  [[0.15]]
grads:  [-0.0264263]
Stock Position:  -0.02642629913741182
Bond Position:  [-2.01667119]


portfolio before change:  [-4.84676946]
curr_Stock_Price:  107.07492656848038
curr_Factors:  [107.07492657]
mat_Sqrt:  [[0.15]]
grads:  [-0.02995901]
Stock Position:  -0.029959009613236137
Bond Position:  [-1.6389107]


portfolio before change:  [-4.85583447]
curr_Stock_Price:  107.36382910010076
curr_Factors:  [107.3638291]
mat_Sqrt:  [[0.15]]
grads:  [0.16146968]
Stock Position:  0.16146967707830057
Bond Position:  [-22.19183728]


portfolio before change:  [-5.13974288]
curr_Stock_Price:  105.63991560968024
curr_Factors:  [105.63991561]
mat_Sqrt:  [[0.15]]
grads:  [0.08262594]
Stock Position:  0.08262593881913669
Bond Position:  [-13.86834008]


portfolio before change:  [-5.08620927]
curr_Stock_Price:  106.3297852173765
curr_Factors:  [106.32978522]
mat_Sqrt:  [[0.15]]
grads:  [-0.0260159]
Stock Position:  -0.026015901866391893
Bond Position:  [-2.31994401]


portfolio before change:  [-5.03900356]
curr_Stock_Price:  104.49299421913229
curr_Factors:  [104.49299422]
mat_Sqrt:  [[0.15]]
grads:  [0.05136806]
Stock Position:  0.05136805681336575
Bond Position:  [-10.40660562]


portfolio before change:  [-5.02718165]
curr_Stock_Price:  104.77378908330645
curr_Factors:  [104.77378908]
mat_Sqrt:  [[0.15]]
grads:  [0.1449515]
Stock Position:  0.14495150396852544
Bond Position:  [-20.21429995]


portfolio before change:  [-4.94251922]
curr_Stock_Price:  105.39273151574552
curr_Factors:  [105.39273152]
mat_Sqrt:  [[0.15]]
grads:  [0.04406476]
Stock Position:  0.044064757511051565
Bond Position:  [-9.58662437]


portfolio before change:  [-4.9712365]
curr_Stock_Price:  104.79542128255659
curr_Factors:  [104.79542128]
mat_Sqrt:  [[0.15]]
grads:  [0.09106501]
Stock Position:  0.0910650057213527
Bond Position:  [-14.51443214]


portfolio before change:  [-5.0524301]
curr_Stock_Price:  103.94367215180765
curr_Factors:  [103.94367215]
mat_Sqrt:  [[0.15]]
grads:  [-0.08591072]
Stock Position:  -0.08591071635762354
Bond Position:  [3.87744523]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.03180988]
Stock Price:  103.71493766390002
PL:  [-8.74674754]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.77644616e-03]
 [-4.80571211e-03]
 [-5.50820016e-03]
 [ 4.98022616e-03]
 [ 6.40564957e-03]
 [-9.54450646e-03]
 [ 1.35373572e-02]
 [-1.83343796e-02]
 [-1.56938084e-03]
 [ 2.37271196e-03]
 [-3.17380741e-03]
 [-6.64561418e-03]
 [ 7.08519037e-03]
 [ 1.92071524e-04]
 [ 3.36539501e-03]
 [ 2.10538072e-02]
 [ 5.52990205e-03]
 [ 1.30482529e-02]
 [-1.19000656e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.91242605]
curr_Stock_Price:  99.52314750356321
curr_Factors:  [99.5231475]
mat_Sqrt:  [[0.15]]
grads:  [0.01850964]
Stock Position:  0.018509641067346747
Bond Position:  [-10.75456378]


portfolio before change:  [-8.8964629]
curr_Stock_Price:  100.53084525936681
curr_Factors:  [100.53084526]
mat_Sqrt:  [[0.15]]
grads:  [-0.03203808]
Stock Position:  -0.032038080706630376
Bond Position:  [-5.67564757]


portfolio before change:  [-8.89597044]
curr_Stock_Price:  100.47118033521261
curr_Factors:  [100.47118034]
mat_Sqrt:  [[0.15]]
grads:  [-0.03672133]
Stock Position:  -0.03672133438919836
Bond Position:  [-5.20653463]


portfolio before change:  [-8.91277603]
curr_Stock_Price:  100.89338153739133
curr_Factors:  [100.89338154]
mat_Sqrt:  [[0.15]]
grads:  [0.03320151]
Stock Position:  0.03320150772804855
Bond Position:  [-12.26258841]


portfolio before change:  [-8.94865848]
curr_Stock_Price:  99.90497991412416
curr_Factors:  [99.90497991]
mat_Sqrt:  [[0.15]]
grads:  [0.04270433]
Stock Position:  0.04270433044856646
Bond Position:  [-13.21503376]


portfolio before change:  [-8.91221692]
curr_Stock_Price:  100.83569901447294
curr_Factors:  [100.83569901]
mat_Sqrt:  [[0.15]]
grads:  [-0.06363004]
Stock Position:  -0.06363004309594292
Bond Position:  [-2.49603704]


portfolio before change:  [-8.86312364]
curr_Stock_Price:  100.0543484704269
curr_Factors:  [100.05434847]
mat_Sqrt:  [[0.15]]
grads:  [0.09024905]
Stock Position:  0.09024904789422737
Bond Position:  [-17.89293332]


portfolio before change:  [-8.9275152]
curr_Stock_Price:  99.39043267677795
curr_Factors:  [99.39043268]
mat_Sqrt:  [[0.15]]
grads:  [-0.1222292]
Stock Position:  -0.12222919751641428
Bond Position:  [3.22089763]


portfolio before change:  [-8.88508894]
curr_Stock_Price:  99.04991724869424
curr_Factors:  [99.04991725]
mat_Sqrt:  [[0.15]]
grads:  [-0.01046254]
Stock Position:  -0.010462538952904363
Bond Position:  [-7.84877533]


portfolio before change:  [-8.92093312]
curr_Stock_Price:  102.28830291814825
curr_Factors:  [102.28830292]
mat_Sqrt:  [[0.15]]
grads:  [0.01581808]
Stock Position:  0.015818079756412445
Bond Position:  [-10.53893765]


portfolio before change:  [-8.9134682]
curr_Stock_Price:  102.92681158358467
curr_Factors:  [102.92681158]
mat_Sqrt:  [[0.15]]
grads:  [-0.02115872]
Stock Position:  -0.021158716087062775
Bond Position:  [-6.73566902]


portfolio before change:  [-8.90158141]
curr_Stock_Price:  102.28542491170731
curr_Factors:  [102.28542491]
mat_Sqrt:  [[0.15]]
grads:  [-0.04430409]
Stock Position:  -0.04430409452726266
Bond Position:  [-4.36991828]


portfolio before change:  [-8.8893134]
curr_Stock_Price:  101.9838584469121
curr_Factors:  [101.98385845]
mat_Sqrt:  [[0.15]]
grads:  [0.0472346]
Stock Position:  0.047234602445017926
Bond Position:  [-13.70648041]


portfolio before change:  [-8.8789372]
curr_Stock_Price:  102.27608592301785
curr_Factors:  [102.27608592]
mat_Sqrt:  [[0.15]]
grads:  [0.00128048]
Stock Position:  0.001280476829976796
Bond Position:  [-9.00989936]


portfolio before change:  [-8.87949479]
curr_Stock_Price:  103.59994173339062
curr_Factors:  [103.59994173]
mat_Sqrt:  [[0.15]]
grads:  [0.02243597]
Stock Position:  0.02243596671568214
Bond Position:  [-11.20385963]


portfolio before change:  [-8.8365467]
curr_Stock_Price:  105.63905160549118
curr_Factors:  [105.63905161]
mat_Sqrt:  [[0.15]]
grads:  [0.14035871]
Stock Position:  0.14035871468604422
Bond Position:  [-23.66390821]


portfolio before change:  [-8.95893222]
curr_Stock_Price:  104.80925772236553
curr_Factors:  [104.80925772]
mat_Sqrt:  [[0.15]]
grads:  [0.03686601]
Stock Position:  0.03686601369601298
Bond Position:  [-12.82283175]


portfolio before change:  [-8.99905637]
curr_Stock_Price:  103.8078464797134
curr_Factors:  [103.80784648]
mat_Sqrt:  [[0.15]]
grads:  [0.08698835]
Stock Position:  0.08698835240442535
Bond Position:  [-18.0291299]


portfolio before change:  [-9.01583109]
curr_Stock_Price:  103.66682906744951
curr_Factors:  [103.66682907]
mat_Sqrt:  [[0.15]]
grads:  [-0.07933377]
Stock Position:  -0.07933377035382022
Bond Position:  [-0.79155068]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.04206668]
Stock Price:  103.99503331582045
PL:  [-13.0371]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.77758836e-03]
 [-4.89834172e-03]
 [-4.14264744e-03]
 [ 2.18514582e-02]
 [ 5.71442304e-03]
 [-1.11439941e-02]
 [-3.67483719e-03]
 [-4.55063577e-03]
 [ 2.33487350e-02]
 [ 3.27740303e-04]
 [-3.36527569e-03]
 [ 3.48178909e-03]
 [ 9.22885361e-03]
 [ 2.31603944e-04]
 [ 3.00573056e-04]
 [ 2.19018043e-02]
 [ 2.54944489e-03]
 [ 1.41515777e-02]
 [-1.60507364e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.32759454]
curr_Stock_Price:  99.54968242035162
curr_Factors:  [99.54968242]
mat_Sqrt:  [[0.15]]
grads:  [0.01851726]
Stock Position:  0.0185172557216638
Bond Position:  [-10.17098147]


portfolio before change:  [-8.31206586]
curr_Stock_Price:  100.52562317166496
curr_Factors:  [100.52562317]
mat_Sqrt:  [[0.15]]
grads:  [-0.03265561]
Stock Position:  -0.03265561148346195
Bond Position:  [-5.02934017]


portfolio before change:  [-8.28171654]
curr_Stock_Price:  99.55774015285414
curr_Factors:  [99.55774015]
mat_Sqrt:  [[0.15]]
grads:  [-0.02761765]
Stock Position:  -0.02761764959480325
Bond Position:  [-5.53216576]


portfolio before change:  [-8.33447686]
curr_Stock_Price:  101.41803986183619
curr_Factors:  [101.41803986]
mat_Sqrt:  [[0.15]]
grads:  [0.14567639]
Stock Position:  0.1456763882296182
Bond Position:  [-23.10869061]


portfolio before change:  [-8.29722317]
curr_Stock_Price:  101.71343149964869
curr_Factors:  [101.7134315]
mat_Sqrt:  [[0.15]]
grads:  [0.03809615]
Stock Position:  0.0380961535874094
Bond Position:  [-12.17211368]


portfolio before change:  [-8.2767519]
curr_Stock_Price:  102.3306768714125
curr_Factors:  [102.33067687]
mat_Sqrt:  [[0.15]]
grads:  [-0.07429329]
Stock Position:  -0.0742932940823548
Bond Position:  [-0.67426883]


portfolio before change:  [-8.340661]
curr_Stock_Price:  103.18863458149762
curr_Factors:  [103.18863458]
mat_Sqrt:  [[0.15]]
grads:  [-0.02449891]
Stock Position:  -0.02449891463186148
Bond Position:  [-5.81265145]


portfolio before change:  [-8.38752393]
curr_Stock_Price:  105.04216930440273
curr_Factors:  [105.0421693]
mat_Sqrt:  [[0.15]]
grads:  [-0.03033757]
Stock Position:  -0.030337571784082442
Bond Position:  [-5.20079958]


portfolio before change:  [-8.40781]
curr_Stock_Price:  105.66798432361531
curr_Factors:  [105.66798432]
mat_Sqrt:  [[0.15]]
grads:  [0.15565823]
Stock Position:  0.1556582335018865
Bond Position:  [-24.85590178]


portfolio before change:  [-8.64256803]
curr_Stock_Price:  104.19974666326186
curr_Factors:  [104.19974666]
mat_Sqrt:  [[0.15]]
grads:  [0.00218494]
Stock Position:  0.0021849353542713395
Bond Position:  [-8.87023774]


portfolio before change:  [-8.64501823]
curr_Stock_Price:  104.09339958490872
curr_Factors:  [104.09339958]
mat_Sqrt:  [[0.15]]
grads:  [-0.02243517]
Stock Position:  -0.022435171251291887
Bond Position:  [-6.30966499]


portfolio before change:  [-8.64555706]
curr_Stock_Price:  104.04709776314164
curr_Factors:  [104.04709776]
mat_Sqrt:  [[0.15]]
grads:  [0.02321193]
Stock Position:  0.023211927260594033
Bond Position:  [-11.06069072]


portfolio before change:  [-8.66232138]
curr_Stock_Price:  103.44401115272773
curr_Factors:  [103.44401115]
mat_Sqrt:  [[0.15]]
grads:  [0.06152569]
Stock Position:  0.06152569073261822
Bond Position:  [-15.02678561]


portfolio before change:  [-8.75209445]
curr_Stock_Price:  102.04596250654357
curr_Factors:  [102.04596251]
mat_Sqrt:  [[0.15]]
grads:  [0.00154403]
Stock Position:  0.0015440262933037192
Bond Position:  [-8.9096561]


portfolio before change:  [-8.75474216]
curr_Stock_Price:  101.77393858930645
curr_Factors:  [101.77393859]
mat_Sqrt:  [[0.15]]
grads:  [0.00200382]
Stock Position:  0.0020038203752520125
Bond Position:  [-8.95867885]


portfolio before change:  [-8.75783475]
curr_Stock_Price:  101.34843080797044
curr_Factors:  [101.34843081]
mat_Sqrt:  [[0.15]]
grads:  [0.14601203]
Stock Position:  0.14601202850993455
Bond Position:  [-23.55592471]


portfolio before change:  [-8.45640719]
curr_Stock_Price:  103.45317026329387
curr_Factors:  [103.45317026]
mat_Sqrt:  [[0.15]]
grads:  [0.0169963]
Stock Position:  0.016996299237483574
Bond Position:  [-10.21472823]


portfolio before change:  [-8.42256143]
curr_Stock_Price:  105.59479870300784
curr_Factors:  [105.5947987]
mat_Sqrt:  [[0.15]]
grads:  [0.09434385]
Stock Position:  0.09434385156983856
Bond Position:  [-18.38478145]


portfolio before change:  [-8.33727406]
curr_Stock_Price:  106.54752789484782
curr_Factors:  [106.54752789]
mat_Sqrt:  [[0.15]]
grads:  [-0.10700491]
Stock Position:  -0.10700490928312065
Bond Position:  [3.0638345]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.33660386]
Stock Price:  106.54842373859356
PL:  [-14.8850276]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.26582381e-02]
 [ 3.22511129e-02]
 [-3.62672668e-02]
 [-9.57338132e-03]
 [ 5.70242478e-03]
 [-1.14755573e-02]
 [-2.55715088e-03]
 [ 4.12407914e-03]
 [-5.99741289e-03]
 [ 3.20648128e-03]
 [-3.06339216e-03]
 [-2.20722135e-03]
 [ 7.87963551e-03]
 [-7.99789878e-04]
 [ 2.41182180e-03]
 [ 2.26551801e-02]
 [ 6.03048637e-03]
 [ 1.45734681e-02]
 [-1.62398706e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [47.10743886]
curr_Stock_Price:  102.0648752365879
curr_Factors:  [102.06487524]
mat_Sqrt:  [[0.15]]
grads:  [-0.15105492]
Stock Position:  -0.15105492046560806
Bond Position:  [62.52484047]


portfolio before change:  [47.13115387]
curr_Stock_Price:  102.0113725301597
curr_Factors:  [102.01137253]
mat_Sqrt:  [[0.15]]
grads:  [0.21500742]
Stock Position:  0.21500741902214668
Bond Position:  [25.19795195]


portfolio before change:  [47.19644744]
curr_Stock_Price:  102.28575047762536
curr_Factors:  [102.28575048]
mat_Sqrt:  [[0.15]]
grads:  [-0.24178178]
Stock Position:  -0.24178177869772846
Bond Position:  [71.92727812]


portfolio before change:  [47.67581839]
curr_Stock_Price:  100.377472346072
curr_Factors:  [100.37747235]
mat_Sqrt:  [[0.15]]
grads:  [-0.06382254]
Stock Position:  -0.06382254210467093
Bond Position:  [54.08216384]


portfolio before change:  [47.57208961]
curr_Stock_Price:  102.21461338433751
curr_Factors:  [102.21461338]
mat_Sqrt:  [[0.15]]
grads:  [0.03801617]
Stock Position:  0.03801616520800511
Bond Position:  [43.68628198]


portfolio before change:  [47.59267915]
curr_Stock_Price:  102.4688897703173
curr_Factors:  [102.46888977]
mat_Sqrt:  [[0.15]]
grads:  [-0.07650372]
Stock Position:  -0.0765037155825761
Bond Position:  [55.43192995]


portfolio before change:  [47.5757324]
curr_Stock_Price:  102.87156909130002
curr_Factors:  [102.87156909]
mat_Sqrt:  [[0.15]]
grads:  [-0.01704767]
Stock Position:  -0.017047672509910208
Bond Position:  [49.32945323]


portfolio before change:  [47.58322076]
curr_Stock_Price:  103.15580441281605
curr_Factors:  [103.15580441]
mat_Sqrt:  [[0.15]]
grads:  [0.02749386]
Stock Position:  0.027493860931475853
Bond Position:  [44.74706942]


portfolio before change:  [47.50946999]
curr_Stock_Price:  100.06642637258705
curr_Factors:  [100.06642637]
mat_Sqrt:  [[0.15]]
grads:  [-0.03998275]
Stock Position:  -0.03998275260383158
Bond Position:  [51.51040116]


portfolio before change:  [47.50370094]
curr_Stock_Price:  100.53283403430275
curr_Factors:  [100.53283403]
mat_Sqrt:  [[0.15]]
grads:  [0.02137654]
Stock Position:  0.021376541882745174
Bond Position:  [45.35465661]


portfolio before change:  [47.54695737]
curr_Stock_Price:  102.02588877605781
curr_Factors:  [102.02588878]
mat_Sqrt:  [[0.15]]
grads:  [-0.02042261]
Stock Position:  -0.020422614386163867
Bond Position:  [49.63059276]


portfolio before change:  [47.53666956]
curr_Stock_Price:  103.1372551341832
curr_Factors:  [103.13725513]
mat_Sqrt:  [[0.15]]
grads:  [-0.01471481]
Stock Position:  -0.01471480897103216
Bond Position:  [49.05431457]


portfolio before change:  [47.55804199]
curr_Stock_Price:  102.51833354965233
curr_Factors:  [102.51833355]
mat_Sqrt:  [[0.15]]
grads:  [0.0525309]
Stock Position:  0.052530903399007484
Bond Position:  [42.17266131]


portfolio before change:  [47.6365624]
curr_Stock_Price:  103.81235140322678
curr_Factors:  [103.8123514]
mat_Sqrt:  [[0.15]]
grads:  [-0.00533193]
Stock Position:  -0.005331932517676286
Bond Position:  [48.19008285]


portfolio before change:  [47.65079025]
curr_Stock_Price:  103.40371419542888
curr_Factors:  [103.4037142]
mat_Sqrt:  [[0.15]]
grads:  [0.01607881]
Stock Position:  0.016078812014700673
Bond Position:  [45.98818137]


portfolio before change:  [47.66589131]
curr_Stock_Price:  103.62777142074803
curr_Factors:  [103.62777142]
mat_Sqrt:  [[0.15]]
grads:  [0.15103453]
Stock Position:  0.1510345336886189
Bond Position:  [32.01451917]


portfolio before change:  [47.89311703]
curr_Stock_Price:  105.07923476229237
curr_Factors:  [105.07923476]
mat_Sqrt:  [[0.15]]
grads:  [0.04020324]
Stock Position:  0.04020324249041163
Bond Position:  [43.66859107]


portfolio before change:  [47.96014764]
curr_Stock_Price:  106.47494546722842
curr_Factors:  [106.47494547]
mat_Sqrt:  [[0.15]]
grads:  [0.09715645]
Stock Position:  0.09715645407734938
Bond Position:  [37.61541949]


portfolio before change:  [48.04432973]
curr_Stock_Price:  107.24460167397804
curr_Factors:  [107.24460167]
mat_Sqrt:  [[0.15]]
grads:  [-0.1082658]
Stock Position:  -0.10826580408080898
Bond Position:  [59.65525277]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [48.14652885]
Stock Price:  106.43840584976051
PL:  [41.708123]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.95576150e-02]
 [ 3.51496082e-02]
 [-2.71197246e-02]
 [ 1.07787746e-02]
 [ 5.69972638e-03]
 [-1.19736013e-02]
 [ 2.20928528e-03]
 [-9.51010760e-04]
 [-2.26058389e-03]
 [ 2.05402821e-03]
 [-3.12982231e-03]
 [-6.12436850e-03]
 [ 5.80613505e-03]
 [-3.83343059e-04]
 [ 2.55867430e-03]
 [ 1.90898609e-02]
 [ 4.76181739e-03]
 [ 1.17839887e-02]
 [-7.17138002e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [34.09174678]
curr_Stock_Price:  101.47432855156026
curr_Factors:  [101.47432855]
mat_Sqrt:  [[0.15]]
grads:  [-0.1303841]
Stock Position:  -0.1303841002689436
Bond Position:  [47.32238581]


portfolio before change:  [34.01876043]
curr_Stock_Price:  102.12485591160329
curr_Factors:  [102.12485591]
mat_Sqrt:  [[0.15]]
grads:  [0.23433072]
Stock Position:  0.23433072146416203
Bond Position:  [10.08776927]


portfolio before change:  [33.92368588]
curr_Stock_Price:  101.70836417287296
curr_Factors:  [101.70836417]
mat_Sqrt:  [[0.15]]
grads:  [-0.18079816]
Stock Position:  -0.18079816394133688
Bond Position:  [52.31237138]


portfolio before change:  [34.05151106]
curr_Stock_Price:  101.0737036804627
curr_Factors:  [101.07370368]
mat_Sqrt:  [[0.15]]
grads:  [0.0718585]
Stock Position:  0.07185849752269148
Bond Position:  [26.78850657]


portfolio before change:  [34.14322896]
curr_Stock_Price:  102.25686145365508
curr_Factors:  [102.25686145]
mat_Sqrt:  [[0.15]]
grads:  [0.03799818]
Stock Position:  0.03799817587771229
Bond Position:  [30.25765476]


portfolio before change:  [34.16636987]
curr_Stock_Price:  102.66676385691424
curr_Factors:  [102.66676386]
mat_Sqrt:  [[0.15]]
grads:  [-0.07982401]
Stock Position:  -0.07982400871132311
Bond Position:  [42.36164252]


portfolio before change:  [34.25653617]
curr_Stock_Price:  101.66988867663558
curr_Factors:  [101.66988868]
mat_Sqrt:  [[0.15]]
grads:  [0.01472857]
Stock Position:  0.014728568520050786
Bond Position:  [32.75908425]


portfolio before change:  [34.30136406]
curr_Stock_Price:  104.1573734860006
curr_Factors:  [104.15737349]
mat_Sqrt:  [[0.15]]
grads:  [-0.00634007]
Stock Position:  -0.006340071734208495
Bond Position:  [34.96172928]


portfolio before change:  [34.31504506]
curr_Stock_Price:  103.37828528869987
curr_Factors:  [103.37828529]
mat_Sqrt:  [[0.15]]
grads:  [-0.01507056]
Stock Position:  -0.015070559251552889
Bond Position:  [35.87301363]


portfolio before change:  [34.33025082]
curr_Stock_Price:  102.96447291051429
curr_Factors:  [102.96447291]
mat_Sqrt:  [[0.15]]
grads:  [0.01369352]
Stock Position:  0.013693521426960401
Bond Position:  [32.9203046]


portfolio before change:  [34.33429641]
curr_Stock_Price:  102.6588168122221
curr_Factors:  [102.65881681]
mat_Sqrt:  [[0.15]]
grads:  [-0.02086548]
Stock Position:  -0.020865482049421447
Bond Position:  [36.47632211]


portfolio before change:  [34.348828]
curr_Stock_Price:  102.39947150176297
curr_Factors:  [102.3994715]
mat_Sqrt:  [[0.15]]
grads:  [-0.04082912]
Stock Position:  -0.04082912336196509
Bond Position:  [38.52970865]


portfolio before change:  [34.41056437]
curr_Stock_Price:  101.12335445127073
curr_Factors:  [101.12335445]
mat_Sqrt:  [[0.15]]
grads:  [0.03870757]
Stock Position:  0.038707567023421555
Bond Position:  [30.49632535]


portfolio before change:  [34.38596428]
curr_Stock_Price:  100.29082658678641
curr_Factors:  [100.29082659]
mat_Sqrt:  [[0.15]]
grads:  [-0.00255562]
Stock Position:  -0.0025556203931423587
Bond Position:  [34.64226956]


portfolio before change:  [34.39394448]
curr_Stock_Price:  100.55747113577208
curr_Factors:  [100.55747114]
mat_Sqrt:  [[0.15]]
grads:  [0.01705783]
Stock Position:  0.01705782864582288
Bond Position:  [32.67865237]


portfolio before change:  [34.39975543]
curr_Stock_Price:  100.41913331612072
curr_Factors:  [100.41913332]
mat_Sqrt:  [[0.15]]
grads:  [0.12726574]
Stock Position:  0.12726573936135518
Bond Position:  [21.61984018]


portfolio before change:  [34.30414207]
curr_Stock_Price:  99.62536909058214
curr_Factors:  [99.62536909]
mat_Sqrt:  [[0.15]]
grads:  [0.03174545]
Stock Position:  0.031745449285450526
Bond Position:  [31.14148997]


portfolio before change:  [34.39222026]
curr_Stock_Price:  102.15460841974338
curr_Factors:  [102.15460842]
mat_Sqrt:  [[0.15]]
grads:  [0.07855992]
Stock Position:  0.07855992488846933
Bond Position:  [26.36696189]


portfolio before change:  [34.3834794]
curr_Stock_Price:  101.95942728407769
curr_Factors:  [101.95942728]
mat_Sqrt:  [[0.15]]
grads:  [-0.0478092]
Stock Position:  -0.04780920012532136
Bond Position:  [39.25807807]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [34.36444514]
Stock Price:  102.56286788792904
PL:  [31.80157725]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.47173882e-02]
 [ 2.84704852e-02]
 [-5.57182525e-02]
 [ 4.76516586e-02]
 [ 5.69237643e-03]
 [-1.63282748e-02]
 [-5.64626774e-03]
 [ 6.78368081e-03]
 [-1.38834493e-02]
 [ 2.43732451e-03]
 [-3.04110055e-03]
 [-6.57928573e-03]
 [ 6.60743109e-03]
 [ 3.16722271e-05]
 [ 1.15605635e-02]
 [ 1.87817991e-02]
 [ 1.05835071e-02]
 [ 1.54730691e-02]
 [-1.64666647e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.7891595]
curr_Stock_Price:  100.7800210851225
curr_Factors:  [100.78002109]
mat_Sqrt:  [[0.15]]
grads:  [-0.09811592]
Stock Position:  -0.09811592134328224
Bond Position:  [28.67728412]


portfolio before change:  [18.69302639]
curr_Stock_Price:  101.83289128255399
curr_Factors:  [101.83289128]
mat_Sqrt:  [[0.15]]
grads:  [0.18980323]
Stock Position:  0.18980323444240224
Bond Position:  [-0.63518575]


portfolio before change:  [19.02772414]
curr_Stock_Price:  103.59712130793375
curr_Factors:  [103.59712131]
mat_Sqrt:  [[0.15]]
grads:  [-0.37145502]
Stock Position:  -0.3714550169784971
Bond Position:  [57.50939459]


portfolio before change:  [19.37128485]
curr_Stock_Price:  102.71092634997825
curr_Factors:  [102.71092635]
mat_Sqrt:  [[0.15]]
grads:  [0.31767772]
Stock Position:  0.3176777239261013
Bond Position:  [-13.25768846]


portfolio before change:  [19.2602808]
curr_Stock_Price:  102.3719374731333
curr_Factors:  [102.37193747]
mat_Sqrt:  [[0.15]]
grads:  [0.03794918]
Stock Position:  0.03794917622976114
Bond Position:  [15.3753501]


portfolio before change:  [19.34034108]
curr_Stock_Price:  104.38030696035455
curr_Factors:  [104.38030696]
mat_Sqrt:  [[0.15]]
grads:  [-0.10885517]
Stock Position:  -0.10885516536406938
Bond Position:  [30.70267666]


portfolio before change:  [19.41685952]
curr_Stock_Price:  103.74789041416037
curr_Factors:  [103.74789041]
mat_Sqrt:  [[0.15]]
grads:  [-0.03764178]
Stock Position:  -0.03764178494135572
Bond Position:  [23.3221153]


portfolio before change:  [19.46771105]
curr_Stock_Price:  102.551871922432
curr_Factors:  [102.55187192]
mat_Sqrt:  [[0.15]]
grads:  [0.04522454]
Stock Position:  0.04522453875203485
Bond Position:  [14.82984994]


portfolio before change:  [19.46047683]
curr_Stock_Price:  102.30992036879016
curr_Factors:  [102.30992037]
mat_Sqrt:  [[0.15]]
grads:  [-0.09255633]
Stock Position:  -0.0925563289051302
Bond Position:  [28.92990747]


portfolio before change:  [19.45929934]
curr_Stock_Price:  102.40079337182121
curr_Factors:  [102.40079337]
mat_Sqrt:  [[0.15]]
grads:  [0.01624883]
Stock Position:  0.01624883005219598
Bond Position:  [17.79540625]


portfolio before change:  [19.45101193]
curr_Stock_Price:  101.61693311740758
curr_Factors:  [101.61693312]
mat_Sqrt:  [[0.15]]
grads:  [-0.020274]
Stock Position:  -0.020274003671403137
Bond Position:  [21.51119401]


portfolio before change:  [19.44739884]
curr_Stock_Price:  102.06043491977813
curr_Factors:  [102.06043492]
mat_Sqrt:  [[0.15]]
grads:  [-0.0438619]
Stock Position:  -0.043861904841411246
Bond Position:  [23.92396393]


portfolio before change:  [19.47083746]
curr_Stock_Price:  101.66243859574598
curr_Factors:  [101.6624386]
mat_Sqrt:  [[0.15]]
grads:  [0.04404954]
Stock Position:  0.044049540585944374
Bond Position:  [14.99265375]


portfolio before change:  [19.53703154]
curr_Stock_Price:  103.0800571671249
curr_Factors:  [103.08005717]
mat_Sqrt:  [[0.15]]
grads:  [0.00021115]
Stock Position:  0.0002111481809217346
Bond Position:  [19.51526637]


portfolio before change:  [19.54240098]
curr_Stock_Price:  105.40075300627434
curr_Factors:  [105.40075301]
mat_Sqrt:  [[0.15]]
grads:  [0.07707042]
Stock Position:  0.07707042344027461
Bond Position:  [11.41912031]


portfolio before change:  [19.78354848]
curr_Stock_Price:  108.49263123343987
curr_Factors:  [108.49263123]
mat_Sqrt:  [[0.15]]
grads:  [0.12521199]
Stock Position:  0.12521199378236003
Bond Position:  [6.19896981]


portfolio before change:  [19.70173938]
curr_Stock_Price:  107.82688805123199
curr_Factors:  [107.82688805]
mat_Sqrt:  [[0.15]]
grads:  [0.07055671]
Stock Position:  0.0705567139193603
Bond Position:  [12.09382849]


portfolio before change:  [19.74368111]
curr_Stock_Price:  108.37847118471534
curr_Factors:  [108.37847118]
mat_Sqrt:  [[0.15]]
grads:  [0.10315379]
Stock Position:  0.10315379366668373
Bond Position:  [8.56403066]


portfolio before change:  [19.71508292]
curr_Stock_Price:  108.08047474824481
curr_Factors:  [108.08047475]
mat_Sqrt:  [[0.15]]
grads:  [-0.10977776]
Stock Position:  -0.10977776456824152
Bond Position:  [31.57991583]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.42408777]
Stock Price:  110.80316743350511
PL:  [8.62092034]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 7.69653027e-04]
 [-7.32950846e-03]
 [-6.46549448e-03]
 [-1.10704176e-02]
 [ 4.96766924e-03]
 [-1.04377103e-02]
 [ 1.36083275e-02]
 [-2.24663182e-02]
 [-7.11808926e-04]
 [ 8.42390800e-03]
 [-9.99304604e-03]
 [ 8.91578711e-03]
 [ 6.63947472e-03]
 [-1.75199418e-03]
 [ 7.36248979e-03]
 [ 2.23101023e-02]
 [ 1.14002689e-02]
 [-3.53795260e-04]
 [-1.11286203e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-23.22561136]
curr_Stock_Price:  98.87373108468378
curr_Factors:  [98.87373108]
mat_Sqrt:  [[0.15]]
grads:  [0.00513102]
Stock Position:  0.005131020179673686
Bond Position:  [-23.73293447]


portfolio before change:  [-23.22914652]
curr_Stock_Price:  99.34124269128918
curr_Factors:  [99.34124269]
mat_Sqrt:  [[0.15]]
grads:  [-0.04886339]
Stock Position:  -0.04886338971934315
Bond Position:  [-18.37499666]


portfolio before change:  [-23.2064416]
curr_Stock_Price:  98.78255770272557
curr_Factors:  [98.7825577]
mat_Sqrt:  [[0.15]]
grads:  [-0.0431033]
Stock Position:  -0.04310329650654347
Bond Position:  [-18.94858773]


portfolio before change:  [-23.18523411]
curr_Stock_Price:  98.18062621791533
curr_Factors:  [98.18062622]
mat_Sqrt:  [[0.15]]
grads:  [-0.07380278]
Stock Position:  -0.07380278393096051
Bond Position:  [-15.93923057]


portfolio before change:  [-23.26269179]
curr_Stock_Price:  99.176149237098
curr_Factors:  [99.17614924]
mat_Sqrt:  [[0.15]]
grads:  [0.03311779]
Stock Position:  0.03311779490377168
Bond Position:  [-26.54718716]


portfolio before change:  [-23.26867438]
curr_Stock_Price:  99.19592819335685
curr_Factors:  [99.19592819]
mat_Sqrt:  [[0.15]]
grads:  [-0.06958474]
Stock Position:  -0.06958473514642823
Bond Position:  [-16.36615199]


portfolio before change:  [-23.22332789]
curr_Stock_Price:  98.48544863599948
curr_Factors:  [98.48544864]
mat_Sqrt:  [[0.15]]
grads:  [0.09072218]
Stock Position:  0.09072218350444858
Bond Position:  [-32.15814284]


portfolio before change:  [-23.17368933]
curr_Stock_Price:  99.12122598766965
curr_Factors:  [99.12122599]
mat_Sqrt:  [[0.15]]
grads:  [-0.14977545]
Stock Position:  -0.14977545494230649
Bond Position:  [-8.32776261]


portfolio before change:  [-22.99803224]
curr_Stock_Price:  97.93452096768051
curr_Factors:  [97.93452097]
mat_Sqrt:  [[0.15]]
grads:  [-0.00474539]
Stock Position:  -0.004745392837889887
Bond Position:  [-22.53329447]


portfolio before change:  [-22.9971366]
curr_Stock_Price:  96.55851934127799
curr_Factors:  [96.55851934]
mat_Sqrt:  [[0.15]]
grads:  [0.05615939]
Stock Position:  0.05615938664022817
Bond Position:  [-28.41980382]


portfolio before change:  [-23.03598226]
curr_Stock_Price:  95.99334551933104
curr_Factors:  [95.99334552]
mat_Sqrt:  [[0.15]]
grads:  [-0.06662031]
Stock Position:  -0.06662030693314763
Bond Position:  [-16.64087611]


portfolio before change:  [-23.07674801]
curr_Stock_Price:  96.54280276244684
curr_Factors:  [96.54280276]
mat_Sqrt:  [[0.15]]
grads:  [0.05943858]
Stock Position:  0.059438580737457954
Bond Position:  [-28.81511518]


portfolio before change:  [-23.15307182]
curr_Stock_Price:  95.37993621342393
curr_Factors:  [95.37993621]
mat_Sqrt:  [[0.15]]
grads:  [0.04426316]
Stock Position:  0.044263164816557385
Bond Position:  [-27.37488966]


portfolio before change:  [-23.19851062]
curr_Stock_Price:  94.50800986549406
curr_Factors:  [94.50800987]
mat_Sqrt:  [[0.15]]
grads:  [-0.01167996]
Stock Position:  -0.011679961179812773
Bond Position:  [-22.09466073]


portfolio before change:  [-23.20779236]
curr_Stock_Price:  94.82970524911589
curr_Factors:  [94.82970525]
mat_Sqrt:  [[0.15]]
grads:  [0.04908327]
Stock Position:  0.04908326526634712
Bond Position:  [-27.86234394]


portfolio before change:  [-23.27034243]
curr_Stock_Price:  93.69727017964064
curr_Factors:  [93.69727018]
mat_Sqrt:  [[0.15]]
grads:  [0.14873402]
Stock Position:  0.148734015094709
Bond Position:  [-37.20631363]


portfolio before change:  [-23.20690655]
curr_Stock_Price:  94.1863218703879
curr_Factors:  [94.18632187]
mat_Sqrt:  [[0.15]]
grads:  [0.07600179]
Stock Position:  0.07600179294188557
Bond Position:  [-30.36523588]


portfolio before change:  [-23.40229902]
curr_Stock_Price:  91.7153247902957
curr_Factors:  [91.71532479]
mat_Sqrt:  [[0.15]]
grads:  [-0.00235864]
Stock Position:  -0.002358635069991897
Bond Position:  [-23.18597604]


portfolio before change:  [-23.4074317]
curr_Stock_Price:  91.43357999723102
curr_Factors:  [91.43358]
mat_Sqrt:  [[0.15]]
grads:  [-0.0741908]
Stock Position:  -0.07419080175891035
Bond Position:  [-16.6239011]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-23.24852324]
Stock Price:  89.23566659853738
PL:  [-23.24852324]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.06696386e-02]
 [-6.05593257e-03]
 [-1.67514827e-02]
 [ 3.03562069e-02]
 [ 5.71431090e-03]
 [-1.04932766e-02]
 [ 5.34696099e-03]
 [ 9.55285270e-03]
 [-1.87457174e-02]
 [ 9.11428582e-03]
 [-4.37460593e-03]
 [-4.67897457e-03]
 [ 4.87772844e-03]
 [-7.68055430e-04]
 [ 6.38633575e-03]
 [ 1.67666400e-02]
 [ 5.39695719e-03]
 [ 9.21379701e-03]
 [-5.26596043e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.71902259]
curr_Stock_Price:  100.54997933804121
curr_Factors:  [100.54997934]
mat_Sqrt:  [[0.15]]
grads:  [-0.07113092]
Stock Position:  -0.07113092394452795
Bond Position:  [20.87123553]


portfolio before change:  [13.73061556]
curr_Stock_Price:  100.46036282453
curr_Factors:  [100.46036282]
mat_Sqrt:  [[0.15]]
grads:  [-0.04037288]
Stock Position:  -0.040372883801272366
Bond Position:  [17.78649011]


portfolio before change:  [13.70797137]
curr_Stock_Price:  101.13139169067958
curr_Factors:  [101.13139169]
mat_Sqrt:  [[0.15]]
grads:  [-0.11167655]
Stock Position:  -0.11167655128761662
Bond Position:  [25.00197642]


portfolio before change:  [13.64940533]
curr_Stock_Price:  101.71179382189786
curr_Factors:  [101.71179382]
mat_Sqrt:  [[0.15]]
grads:  [0.20237471]
Stock Position:  0.20237471254395578
Bond Position:  [-6.9344897]


portfolio before change:  [13.65285446]
curr_Stock_Price:  101.73740457522818
curr_Factors:  [101.73740458]
mat_Sqrt:  [[0.15]]
grads:  [0.03809541]
Stock Position:  0.0380954060242179
Bond Position:  [9.77712673]


portfolio before change:  [13.6675665]
curr_Stock_Price:  102.05942377752294
curr_Factors:  [102.05942378]
mat_Sqrt:  [[0.15]]
grads:  [-0.06995518]
Stock Position:  -0.06995517748480004
Bond Position:  [20.80715161]


portfolio before change:  [13.72996204]
curr_Stock_Price:  101.24185599323819
curr_Factors:  [101.24185599]
mat_Sqrt:  [[0.15]]
grads:  [0.03564641]
Stock Position:  0.035646406585361806
Bond Position:  [10.12105368]


portfolio before change:  [13.75677505]
curr_Stock_Price:  101.92305863470615
curr_Factors:  [101.92305863]
mat_Sqrt:  [[0.15]]
grads:  [0.06368568]
Stock Position:  0.06368568464412366
Bond Position:  [7.26573528]


portfolio before change:  [13.72162875]
curr_Stock_Price:  101.34266196627696
curr_Factors:  [101.34266197]
mat_Sqrt:  [[0.15]]
grads:  [-0.12497145]
Stock Position:  -0.12497144928243153
Bond Position:  [26.38656809]


portfolio before change:  [13.99426044]
curr_Stock_Price:  99.21390195584891
curr_Factors:  [99.21390196]
mat_Sqrt:  [[0.15]]
grads:  [0.06076191]
Stock Position:  0.06076190545072603
Bond Position:  [7.96583471]


portfolio before change:  [13.95326575]
curr_Stock_Price:  98.50644555687099
curr_Factors:  [98.50644556]
mat_Sqrt:  [[0.15]]
grads:  [-0.02916404]
Stock Position:  -0.029164039549255043
Bond Position:  [16.82611162]


portfolio before change:  [13.90739763]
curr_Stock_Price:  100.22346339933209
curr_Factors:  [100.2234634]
mat_Sqrt:  [[0.15]]
grads:  [-0.03119316]
Stock Position:  -0.03119316380634056
Bond Position:  [17.03368454]


portfolio before change:  [13.94559496]
curr_Stock_Price:  99.1354564928835
curr_Factors:  [99.13545649]
mat_Sqrt:  [[0.15]]
grads:  [0.03251819]
Stock Position:  0.03251818959755369
Bond Position:  [10.72188939]


portfolio before change:  [13.9428935]
curr_Stock_Price:  98.96994090198777
curr_Factors:  [98.9699409]
mat_Sqrt:  [[0.15]]
grads:  [-0.00512037]
Stock Position:  -0.005120369534978245
Bond Position:  [14.44965617]


portfolio before change:  [13.94530076]
curr_Stock_Price:  99.20539323089439
curr_Factors:  [99.20539323]
mat_Sqrt:  [[0.15]]
grads:  [0.04257557]
Stock Position:  0.042575571680149436
Bond Position:  [9.72157443]


portfolio before change:  [13.95269639]
curr_Stock_Price:  99.32200770834636
curr_Factors:  [99.32200771]
mat_Sqrt:  [[0.15]]
grads:  [0.1117776]
Stock Position:  0.11177760020000474
Bond Position:  [2.85072072]


portfolio before change:  [13.91163738]
curr_Stock_Price:  98.9483033600878
curr_Factors:  [98.94830336]
mat_Sqrt:  [[0.15]]
grads:  [0.03597971]
Stock Position:  0.03597971460746621
Bond Position:  [10.35150566]


portfolio before change:  [13.96485398]
curr_Stock_Price:  100.35544079146253
curr_Factors:  [100.35544079]
mat_Sqrt:  [[0.15]]
grads:  [0.06142531]
Stock Position:  0.06142531343116503
Bond Position:  [7.80048958]


portfolio before change:  [13.96553602]
curr_Stock_Price:  100.33479251600677
curr_Factors:  [100.33479252]
mat_Sqrt:  [[0.15]]
grads:  [-0.0351064]
Stock Position:  -0.03510640285422268
Bond Position:  [17.48792967]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.98615086]
Stock Price:  99.8721331531025
PL:  [13.98615086]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.56410286e-02]
 [ 1.03641095e-02]
 [-1.43517244e-02]
 [-7.55260081e-03]
 [ 4.44000183e-03]
 [-1.02405892e-02]
 [ 1.44109137e-02]
 [-2.43909418e-02]
 [-1.53799044e-03]
 [ 8.94800371e-03]
 [-5.01723334e-03]
 [ 9.42545655e-03]
 [ 5.22872511e-03]
 [-7.67686411e-04]
 [ 2.06823146e-03]
 [ 2.16369958e-02]
 [ 4.09600791e-03]
 [ 6.24653312e-03]
 [-5.24728222e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.23085649]
curr_Stock_Price:  100.890805517911
curr_Factors:  [100.89080552]
mat_Sqrt:  [[0.15]]
grads:  [-0.10427352]
Stock Position:  -0.10427352376377569
Bond Position:  [31.7510963]


portfolio before change:  [21.23045237]
curr_Stock_Price:  100.97081518290106
curr_Factors:  [100.97081518]
mat_Sqrt:  [[0.15]]
grads:  [0.06909406]
Stock Position:  0.06909406324432386
Bond Position:  [14.25396848]


portfolio before change:  [21.23704499]
curr_Stock_Price:  101.01464933510066
curr_Factors:  [101.01464934]
mat_Sqrt:  [[0.15]]
grads:  [-0.09567816]
Stock Position:  -0.09567816244056064
Bond Position:  [30.90194102]


portfolio before change:  [21.29314277]
curr_Stock_Price:  100.50908639038428
curr_Factors:  [100.50908639]
mat_Sqrt:  [[0.15]]
grads:  [-0.05035067]
Stock Position:  -0.05035067205213227
Bond Position:  [26.35384282]


portfolio before change:  [21.37236928]
curr_Stock_Price:  99.06645960692053
curr_Factors:  [99.06645961]
mat_Sqrt:  [[0.15]]
grads:  [0.02960001]
Stock Position:  0.02960001219589993
Bond Position:  [18.44000087]


portfolio before change:  [21.38856213]
curr_Stock_Price:  99.45775236837386
curr_Factors:  [99.45775237]
mat_Sqrt:  [[0.15]]
grads:  [-0.06827059]
Stock Position:  -0.06827059453569001
Bond Position:  [28.17860202]


portfolio before change:  [21.39730942]
curr_Stock_Price:  99.43282577792439
curr_Factors:  [99.43282578]
mat_Sqrt:  [[0.15]]
grads:  [0.09607276]
Stock Position:  0.09607275767679112
Bond Position:  [11.84452364]


portfolio before change:  [21.35814806]
curr_Stock_Price:  98.99437835474292
curr_Factors:  [98.99437835]
mat_Sqrt:  [[0.15]]
grads:  [-0.16260628]
Stock Position:  -0.1626062786206359
Bond Position:  [37.45525553]


portfolio before change:  [21.35639149]
curr_Stock_Price:  99.06277400458355
curr_Factors:  [99.062774]
mat_Sqrt:  [[0.15]]
grads:  [-0.01025327]
Stock Position:  -0.010253269592329382
Bond Position:  [22.37210881]


portfolio before change:  [21.35992931]
curr_Stock_Price:  99.26328604282448
curr_Factors:  [99.26328604]
mat_Sqrt:  [[0.15]]
grads:  [0.05965336]
Stock Position:  0.05965335807144277
Bond Position:  [15.43854096]


portfolio before change:  [21.2856353]
curr_Stock_Price:  97.95314816684476
curr_Factors:  [97.95314817]
mat_Sqrt:  [[0.15]]
grads:  [-0.03344822]
Stock Position:  -0.03344822225423536
Bond Position:  [24.56199397]


portfolio before change:  [21.34213671]
curr_Stock_Price:  96.44753323521958
curr_Factors:  [96.44753324]
mat_Sqrt:  [[0.15]]
grads:  [0.06283638]
Stock Position:  0.06283637697959414
Bond Position:  [15.28172315]


portfolio before change:  [21.46283944]
curr_Stock_Price:  98.30763119256176
curr_Factors:  [98.30763119]
mat_Sqrt:  [[0.15]]
grads:  [0.03485817]
Stock Position:  0.03485816741761148
Bond Position:  [18.03601557]


portfolio before change:  [21.4904836]
curr_Stock_Price:  98.97130917687998
curr_Factors:  [98.97130918]
mat_Sqrt:  [[0.15]]
grads:  [-0.00511791]
Stock Position:  -0.005117909407590667
Bond Position:  [21.9970098]


portfolio before change:  [21.48689454]
curr_Stock_Price:  100.74723044289131
curr_Factors:  [100.74723044]
mat_Sqrt:  [[0.15]]
grads:  [0.01378821]
Stock Position:  0.013788209753727965
Bond Position:  [20.09777059]


portfolio before change:  [21.49685851]
curr_Stock_Price:  101.10542808096756
curr_Factors:  [101.10542808]
mat_Sqrt:  [[0.15]]
grads:  [0.14424664]
Stock Position:  0.14424663835482449
Bond Position:  [6.91274039]


portfolio before change:  [21.37462415]
curr_Stock_Price:  100.24604746206089
curr_Factors:  [100.24604746]
mat_Sqrt:  [[0.15]]
grads:  [0.02730672]
Stock Position:  0.027306719392494183
Bond Position:  [18.63723346]


portfolio before change:  [21.34409863]
curr_Stock_Price:  98.95752161832387
curr_Factors:  [98.95752162]
mat_Sqrt:  [[0.15]]
grads:  [0.04164355]
Stock Position:  0.04164355413768129
Bond Position:  [17.22315572]


portfolio before change:  [21.37961277]
curr_Stock_Price:  99.70692482383471
curr_Factors:  [99.70692482]
mat_Sqrt:  [[0.15]]
grads:  [-0.03498188]
Stock Position:  -0.034981881489864856
Bond Position:  [24.86754859]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.38171291]
Stock Price:  99.824629312338
PL:  [21.38171291]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 6.85611967e-04]
 [-7.93949369e-04]
 [-7.05245471e-03]
 [-1.44872781e-02]
 [ 6.38795675e-03]
 [-9.83934024e-03]
 [ 1.19336551e-02]
 [ 1.14539042e-02]
 [-1.42618723e-02]
 [ 2.20179637e-03]
 [-3.46385002e-03]
 [ 6.27716330e-03]
 [ 1.00858004e-02]
 [-1.21547148e-03]
 [ 9.49910507e-05]
 [ 1.83585599e-02]
 [ 5.63378548e-03]
 [ 5.85196994e-03]
 [-4.35963233e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-23.63023111]
curr_Stock_Price:  98.8553727175623
curr_Factors:  [98.85537272]
mat_Sqrt:  [[0.15]]
grads:  [0.00457075]
Stock Position:  0.004570746443527026
Bond Position:  [-24.08207395]


portfolio before change:  [-23.63884602]
curr_Stock_Price:  98.28793024585309
curr_Factors:  [98.28793025]
mat_Sqrt:  [[0.15]]
grads:  [-0.005293]
Stock Position:  -0.005292995794390008
Bond Position:  [-23.11860841]


portfolio before change:  [-23.6460355]
curr_Stock_Price:  98.55415216823346
curr_Factors:  [98.55415217]
mat_Sqrt:  [[0.15]]
grads:  [-0.04701636]
Stock Position:  -0.04701636470402637
Bond Position:  [-19.01237754]


portfolio before change:  [-23.65429065]
curr_Stock_Price:  98.6286253552977
curr_Factors:  [98.62862536]
mat_Sqrt:  [[0.15]]
grads:  [-0.09658185]
Stock Position:  -0.09658185421801754
Bond Position:  [-14.12855513]


portfolio before change:  [-23.7789612]
curr_Stock_Price:  99.88287718105708
curr_Factors:  [99.88287718]
mat_Sqrt:  [[0.15]]
grads:  [0.04258638]
Stock Position:  0.042586378318886293
Bond Position:  [-28.03261119]


portfolio before change:  [-23.76910273]
curr_Stock_Price:  100.27895451575135
curr_Factors:  [100.27895452]
mat_Sqrt:  [[0.15]]
grads:  [-0.0655956]
Stock Position:  -0.06559560159325745
Bond Position:  [-17.19124438]


portfolio before change:  [-23.77777017]
curr_Stock_Price:  100.34556107647556
curr_Factors:  [100.34556108]
mat_Sqrt:  [[0.15]]
grads:  [0.0795577]
Stock Position:  0.07955770092358046
Bond Position:  [-31.76103231]


portfolio before change:  [-23.77475357]
curr_Stock_Price:  100.48329567384576
curr_Factors:  [100.48329567]
mat_Sqrt:  [[0.15]]
grads:  [0.07635936]
Stock Position:  0.0763593610721673
Bond Position:  [-31.44759383]


portfolio before change:  [-23.64666544]
curr_Stock_Price:  102.26370627006342
curr_Factors:  [102.26370627]
mat_Sqrt:  [[0.15]]
grads:  [-0.09507915]
Stock Position:  -0.09507914869058705
Bond Position:  [-13.92351931]


portfolio before change:  [-23.70672158]
curr_Stock_Price:  102.85873497152737
curr_Factors:  [102.85873497]
mat_Sqrt:  [[0.15]]
grads:  [0.01467864]
Stock Position:  0.01467864247342724
Bond Position:  [-25.21654817]


portfolio before change:  [-23.68608733]
curr_Stock_Price:  104.69399847457932
curr_Factors:  [104.69399847]
mat_Sqrt:  [[0.15]]
grads:  [-0.02309233]
Stock Position:  -0.023092333465784255
Bond Position:  [-21.2684586]


portfolio before change:  [-23.6867904]
curr_Stock_Price:  104.49416156198714
curr_Factors:  [104.49416156]
mat_Sqrt:  [[0.15]]
grads:  [0.04184776]
Stock Position:  0.04184775530146459
Bond Position:  [-28.05963651]


portfolio before change:  [-23.712177]
curr_Stock_Price:  104.05517010233883
curr_Factors:  [104.0551701]
mat_Sqrt:  [[0.15]]
grads:  [0.06723867]
Stock Position:  0.06723866949996374
Bond Position:  [-30.70870819]


portfolio before change:  [-23.71350352]
curr_Stock_Price:  104.14963383082329
curr_Factors:  [104.14963383]
mat_Sqrt:  [[0.15]]
grads:  [-0.00810314]
Stock Position:  -0.008103143166812168
Bond Position:  [-22.86956413]


portfolio before change:  [-23.70410439]
curr_Stock_Price:  102.28403229736477
curr_Factors:  [102.2840323]
mat_Sqrt:  [[0.15]]
grads:  [0.00063327]
Stock Position:  0.0006332736715923548
Bond Position:  [-23.76887817]


portfolio before change:  [-23.71134245]
curr_Stock_Price:  100.23895390225486
curr_Factors:  [100.2389539]
mat_Sqrt:  [[0.15]]
grads:  [0.1223904]
Stock Position:  0.12239039904766459
Bond Position:  [-35.97962801]


portfolio before change:  [-23.90385186]
curr_Stock_Price:  98.73954397479484
curr_Factors:  [98.73954397]
mat_Sqrt:  [[0.15]]
grads:  [0.03755857]
Stock Position:  0.03755856986202979
Bond Position:  [-27.61236792]


portfolio before change:  [-23.90839627]
curr_Stock_Price:  98.80236701824334
curr_Factors:  [98.80236702]
mat_Sqrt:  [[0.15]]
grads:  [0.03901313]
Stock Position:  0.039013132947624284
Bond Position:  [-27.76298615]


portfolio before change:  [-23.90389734]
curr_Stock_Price:  99.09561557432107
curr_Factors:  [99.09561557]
mat_Sqrt:  [[0.15]]
grads:  [-0.02906422]
Stock Position:  -0.029064215535540516
Bond Position:  [-21.02376101]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-23.90648901]
Stock Price:  99.00392467073326
PL:  [-23.90648901]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 1.22988547e-03]
 [-9.72194597e-04]
 [-1.49267516e-02]
 [ 2.33543844e-02]
 [-1.13542119e-02]
 [-1.24996680e-02]
 [ 1.46122799e-02]
 [-7.85822866e-02]
 [ 9.38239799e-03]
 [ 2.47366154e-03]
 [-2.38855918e-02]
 [ 4.15194692e-02]
 [ 1.01643585e-02]
 [-2.40795416e-03]
 [ 6.16208376e-03]
 [ 2.20036571e-02]
 [ 1.21947879e-02]
 [ 3.31393062e-04]
 [-1.05214695e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-38.10392096]
curr_Stock_Price:  98.19867390283369
curr_Factors:  [98.1986739]
mat_Sqrt:  [[0.15]]
grads:  [0.00819924]
Stock Position:  0.008199236470299125
Bond Position:  [-38.9090751]


portfolio before change:  [-38.12021978]
curr_Stock_Price:  97.39733822893652
curr_Factors:  [97.39733823]
mat_Sqrt:  [[0.15]]
grads:  [-0.0064813]
Stock Position:  -0.006481297314752724
Bond Position:  [-37.48895867]


portfolio before change:  [-38.12328008]
curr_Stock_Price:  96.42328776638925
curr_Factors:  [96.42328777]
mat_Sqrt:  [[0.15]]
grads:  [-0.09951168]
Stock Position:  -0.09951167738536626
Bond Position:  [-28.52803698]


portfolio before change:  [-38.05272952]
curr_Stock_Price:  95.64264106867833
curr_Factors:  [95.64264107]
mat_Sqrt:  [[0.15]]
grads:  [0.1556959]
Stock Position:  0.15569589598967012
Bond Position:  [-52.94389622]


portfolio before change:  [-38.17676793]
curr_Stock_Price:  94.93099240254442
curr_Factors:  [94.9309924]
mat_Sqrt:  [[0.15]]
grads:  [-0.07569475]
Stock Position:  -0.07569474579065381
Bond Position:  [-30.99099059]


portfolio before change:  [-38.04960122]
curr_Stock_Price:  93.1486305880345
curr_Factors:  [93.14863059]
mat_Sqrt:  [[0.15]]
grads:  [-0.08333112]
Stock Position:  -0.0833311199163298
Bond Position:  [-30.28742151]


portfolio before change:  [-38.08458761]
curr_Stock_Price:  93.47760240857083
curr_Factors:  [93.47760241]
mat_Sqrt:  [[0.15]]
grads:  [0.0974152]
Stock Position:  0.09741519956058725
Bond Position:  [-47.1907269]


portfolio before change:  [-38.22045608]
curr_Stock_Price:  92.20398891776601
curr_Factors:  [92.20398892]
mat_Sqrt:  [[0.15]]
grads:  [-0.52388191]
Stock Position:  -0.5238819106744634
Bond Position:  [10.08354581]


portfolio before change:  [-38.23395379]
curr_Stock_Price:  92.23456625448627
curr_Factors:  [92.23456625]
mat_Sqrt:  [[0.15]]
grads:  [0.06254932]
Stock Position:  0.06254931994094756
Bond Position:  [-44.00316319]


portfolio before change:  [-38.20980352]
curr_Stock_Price:  92.7965617655431
curr_Factors:  [92.79656177]
mat_Sqrt:  [[0.15]]
grads:  [0.01649108]
Stock Position:  0.016491076938438903
Bond Position:  [-39.74011876]


portfolio before change:  [-38.2558544]
curr_Stock_Price:  90.60661316704496
curr_Factors:  [90.60661317]
mat_Sqrt:  [[0.15]]
grads:  [-0.15923728]
Stock Position:  -0.15923727853532785
Bond Position:  [-23.8279039]


portfolio before change:  [-38.17263153]
curr_Stock_Price:  90.04656469251913
curr_Factors:  [90.04656469]
mat_Sqrt:  [[0.15]]
grads:  [0.27679646]
Stock Position:  0.2767964616479678
Bond Position:  [-63.09720202]


portfolio before change:  [-38.02694886]
curr_Stock_Price:  90.62987757221032
curr_Factors:  [90.62987757]
mat_Sqrt:  [[0.15]]
grads:  [0.06776239]
Stock Position:  0.06776239001483281
Bond Position:  [-44.16824597]


portfolio before change:  [-37.9681071]
curr_Stock_Price:  91.66120489152556
curr_Factors:  [91.66120489]
mat_Sqrt:  [[0.15]]
grads:  [-0.01605303]
Stock Position:  -0.016053027713013642
Bond Position:  [-36.49666723]


portfolio before change:  [-37.98458169]
curr_Stock_Price:  92.11901777297234
curr_Factors:  [92.11901777]
mat_Sqrt:  [[0.15]]
grads:  [0.04108056]
Stock Position:  0.041080558432815134
Bond Position:  [-41.76888238]


portfolio before change:  [-37.90505525]
curr_Stock_Price:  94.30910384869021
curr_Factors:  [94.30910385]
mat_Sqrt:  [[0.15]]
grads:  [0.14669105]
Stock Position:  0.14669104719959342
Bond Position:  [-51.73935646]


portfolio before change:  [-37.99975987]
curr_Stock_Price:  93.75168630674952
curr_Factors:  [93.75168631]
mat_Sqrt:  [[0.15]]
grads:  [0.08129859]
Stock Position:  0.08129858587391971
Bond Position:  [-45.62163939]


portfolio before change:  [-37.96302623]
curr_Stock_Price:  94.34383036521159
curr_Factors:  [94.34383037]
mat_Sqrt:  [[0.15]]
grads:  [0.00220929]
Stock Position:  0.002209287081655076
Bond Position:  [-38.17145884]


portfolio before change:  [-37.97655225]
curr_Stock_Price:  92.54145626784349
curr_Factors:  [92.54145627]
mat_Sqrt:  [[0.15]]
grads:  [-0.07014313]
Stock Position:  -0.07014312981332071
Bond Position:  [-31.48540487]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-38.03950895]
Stock Price:  93.32676992403337
PL:  [-38.03950895]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 1.70921893e-03]
 [-5.59800194e-03]
 [-5.33259105e-03]
 [-2.02415728e-02]
 [ 5.30033810e-03]
 [-1.04387268e-02]
 [ 1.20531937e-02]
 [ 8.48986566e-03]
 [-7.68152282e-04]
 [ 4.72035065e-03]
 [-3.36701563e-03]
 [-7.81694694e-08]
 [ 4.87626351e-03]
 [-4.68122043e-04]
 [ 4.01959786e-03]
 [ 1.69267860e-02]
 [ 5.23888738e-03]
 [ 2.84574821e-03]
 [-6.67700949e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.70202585]
curr_Stock_Price:  99.07897475603812
curr_Factors:  [99.07897476]
mat_Sqrt:  [[0.15]]
grads:  [0.01139479]
Stock Position:  0.011394792867596416
Bond Position:  [-19.83101024]


portfolio before change:  [-18.70676241]
curr_Stock_Price:  99.09844084500298
curr_Factors:  [99.09844085]
mat_Sqrt:  [[0.15]]
grads:  [-0.03732001]
Stock Position:  -0.037320012930058835
Bond Position:  [-15.00840731]


portfolio before change:  [-18.70797634]
curr_Stock_Price:  99.03041719943926
curr_Factors:  [99.0304172]
mat_Sqrt:  [[0.15]]
grads:  [-0.03555061]
Stock Position:  -0.03555060699523684
Bond Position:  [-15.18738489]


portfolio before change:  [-18.72163221]
curr_Stock_Price:  99.30772748766667
curr_Factors:  [99.30772749]
mat_Sqrt:  [[0.15]]
grads:  [-0.13494382]
Stock Position:  -0.13494381892030302
Bond Position:  [-5.32066821]


portfolio before change:  [-18.71483912]
curr_Stock_Price:  99.24752898347586
curr_Factors:  [99.24752898]
mat_Sqrt:  [[0.15]]
grads:  [0.03533559]
Stock Position:  0.035335587328617836
Bond Position:  [-22.22180885]


portfolio before change:  [-18.72226632]
curr_Stock_Price:  99.19457806426911
curr_Factors:  [99.19457806]
mat_Sqrt:  [[0.15]]
grads:  [-0.06959151]
Stock Position:  -0.06959151167676125
Bond Position:  [-11.81916568]


portfolio before change:  [-18.80374957]
curr_Stock_Price:  100.32299275350408
curr_Factors:  [100.32299275]
mat_Sqrt:  [[0.15]]
grads:  [0.08035462]
Stock Position:  0.08035462474931288
Bond Position:  [-26.865166]


portfolio before change:  [-18.80902198]
curr_Stock_Price:  100.34097199821207
curr_Factors:  [100.340972]
mat_Sqrt:  [[0.15]]
grads:  [0.0565991]
Stock Position:  0.05659910443040226
Bond Position:  [-24.48823113]


portfolio before change:  [-18.86760387]
curr_Stock_Price:  99.41411867650686
curr_Factors:  [99.41411868]
mat_Sqrt:  [[0.15]]
grads:  [-0.00512102]
Stock Position:  -0.005121015215122707
Bond Position:  [-18.35850266]


portfolio before change:  [-18.87586426]
curr_Stock_Price:  100.13081031410321
curr_Factors:  [100.13081031]
mat_Sqrt:  [[0.15]]
grads:  [0.031469]
Stock Position:  0.031469004318225954
Bond Position:  [-22.02688116]


portfolio before change:  [-18.91195151]
curr_Stock_Price:  99.15906552037316
curr_Factors:  [99.15906552]
mat_Sqrt:  [[0.15]]
grads:  [-0.02244677]
Stock Position:  -0.02244677086815522
Bond Position:  [-16.68615069]


portfolio before change:  [-18.90049459]
curr_Stock_Price:  98.46279697869957
curr_Factors:  [98.46279698]
mat_Sqrt:  [[0.15]]
grads:  [-5.21129796e-07]
Stock Position:  -5.211297962604e-07
Bond Position:  [-18.90044328]


portfolio before change:  [-18.90522066]
curr_Stock_Price:  99.17553277205094
curr_Factors:  [99.17553277]
mat_Sqrt:  [[0.15]]
grads:  [0.03250842]
Stock Position:  0.03250842340051439
Bond Position:  [-22.12926087]


portfolio before change:  [-18.88128406]
curr_Stock_Price:  100.08205492025004
curr_Factors:  [100.08205492]
mat_Sqrt:  [[0.15]]
grads:  [-0.00312081]
Stock Position:  -0.0031208136197161582
Bond Position:  [-18.56894662]


portfolio before change:  [-18.88574777]
curr_Stock_Price:  100.02466215559632
curr_Factors:  [100.02466216]
mat_Sqrt:  [[0.15]]
grads:  [0.02679732]
Stock Position:  0.02679731905746596
Bond Position:  [-21.56614055]


portfolio before change:  [-18.89626391]
curr_Stock_Price:  99.83345161995109
curr_Factors:  [99.83345162]
mat_Sqrt:  [[0.15]]
grads:  [0.11284524]
Stock Position:  0.112845240251149
Bond Position:  [-30.16199374]


portfolio before change:  [-18.98796678]
curr_Stock_Price:  99.08763872562072
curr_Factors:  [99.08763873]
mat_Sqrt:  [[0.15]]
grads:  [0.03492592]
Stock Position:  0.03492591588263562
Bond Position:  [-22.44869332]


portfolio before change:  [-19.04483038]
curr_Stock_Price:  97.62022647558683
curr_Factors:  [97.62022648]
mat_Sqrt:  [[0.15]]
grads:  [0.01897165]
Stock Position:  0.018971654761251185
Bond Position:  [-20.89684761]


portfolio before change:  [-19.06983587]
curr_Stock_Price:  96.5775852023705
curr_Factors:  [96.5775852]
mat_Sqrt:  [[0.15]]
grads:  [-0.0445134]
Stock Position:  -0.04451339659979705
Bond Position:  [-14.77083952]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.08568452]
Stock Price:  96.85065970267144
PL:  [-19.08568452]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.44164076e-02]
 [ 3.07760247e-02]
 [-3.22898014e-02]
 [ 1.90501915e-02]
 [ 5.00930361e-03]
 [-1.89104672e-02]
 [-1.17325582e-02]
 [ 5.25912575e-03]
 [-1.86815435e-02]
 [ 2.47187551e-03]
 [-3.20793522e-03]
 [-1.70560225e-03]
 [ 8.34292485e-03]
 [ 1.45352267e-04]
 [ 1.22630709e-02]
 [ 2.23300721e-02]
 [ 3.91640299e-03]
 [ 1.39458457e-02]
 [-1.60578930e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [52.88064018]
curr_Stock_Price:  102.32681635229102
curr_Factors:  [102.32681635]
mat_Sqrt:  [[0.15]]
grads:  [-0.16277605]
Stock Position:  -0.16277605043168614
Bond Position:  [69.5369952]


portfolio before change:  [52.95934301]
curr_Stock_Price:  101.95012451601734
curr_Factors:  [101.95012452]
mat_Sqrt:  [[0.15]]
grads:  [0.2051735]
Stock Position:  0.20517349813717967
Bond Position:  [32.04187933]


portfolio before change:  [52.98470625]
curr_Stock_Price:  102.03469571609465
curr_Factors:  [102.03469572]
mat_Sqrt:  [[0.15]]
grads:  [-0.21526534]
Stock Position:  -0.21526534293551794
Bond Position:  [74.94924002]


portfolio before change:  [53.154943]
curr_Stock_Price:  101.33092660958067
curr_Factors:  [101.33092661]
mat_Sqrt:  [[0.15]]
grads:  [0.12700128]
Stock Position:  0.1270012768646942
Bond Position:  [40.28578594]


portfolio before change:  [53.51660939]
curr_Stock_Price:  104.0993529360904
curr_Factors:  [104.09935294]
mat_Sqrt:  [[0.15]]
grads:  [0.03339536]
Stock Position:  0.03339535738677418
Bond Position:  [50.04017429]


portfolio before change:  [53.57267213]
curr_Stock_Price:  105.40346038550322
curr_Factors:  [105.40346039]
mat_Sqrt:  [[0.15]]
grads:  [-0.12606978]
Stock Position:  -0.12606978153656642
Bond Position:  [66.86086335]


portfolio before change:  [53.58043972]
curr_Stock_Price:  105.47445057495491
curr_Factors:  [105.47445057]
mat_Sqrt:  [[0.15]]
grads:  [-0.07821705]
Stock Position:  -0.0782170547008521
Bond Position:  [61.83034059]


portfolio before change:  [53.79741674]
curr_Stock_Price:  102.89806223614707
curr_Factors:  [102.89806224]
mat_Sqrt:  [[0.15]]
grads:  [0.03506084]
Stock Position:  0.03506083831396717
Bond Position:  [50.18972442]


portfolio before change:  [53.77047201]
curr_Stock_Price:  101.77162801083598
curr_Factors:  [101.77162801]
mat_Sqrt:  [[0.15]]
grads:  [-0.12454362]
Stock Position:  -0.12454362326392558
Bond Position:  [66.44547931]


portfolio before change:  [53.70123521]
curr_Stock_Price:  102.46094667097768
curr_Factors:  [102.46094667]
mat_Sqrt:  [[0.15]]
grads:  [0.01647917]
Stock Position:  0.016479170054907004
Bond Position:  [52.01276385]


portfolio before change:  [53.72534371]
curr_Stock_Price:  103.13474727482794
curr_Factors:  [103.13474727]
mat_Sqrt:  [[0.15]]
grads:  [-0.02138623]
Stock Position:  -0.021386234788278426
Bond Position:  [55.93100763]


portfolio before change:  [53.73755889]
curr_Stock_Price:  103.217479005374
curr_Factors:  [103.21747901]
mat_Sqrt:  [[0.15]]
grads:  [-0.01137068]
Stock Position:  -0.011370681640335278
Bond Position:  [54.91121198]


portfolio before change:  [53.75569409]
curr_Stock_Price:  102.8300185312928
curr_Factors:  [102.83001853]
mat_Sqrt:  [[0.15]]
grads:  [0.0556195]
Stock Position:  0.05561949902702309
Bond Position:  [48.03633998]


portfolio before change:  [53.75262754]
curr_Stock_Price:  102.55894201055908
curr_Factors:  [102.55894201]
mat_Sqrt:  [[0.15]]
grads:  [0.00096902]
Stock Position:  0.0009690151157729334
Bond Position:  [53.65324638]


portfolio before change:  [53.76895997]
curr_Stock_Price:  105.56966974181263
curr_Factors:  [105.56966974]
mat_Sqrt:  [[0.15]]
grads:  [0.08175381]
Stock Position:  0.0817538057096511
Bond Position:  [45.1382377]


portfolio before change:  [53.65487062]
curr_Stock_Price:  104.0360980891048
curr_Factors:  [104.03609809]
mat_Sqrt:  [[0.15]]
grads:  [0.14886715]
Stock Position:  0.1488671471462719
Bond Position:  [38.1673135]


portfolio before change:  [53.67022373]
curr_Stock_Price:  104.07512677674578
curr_Factors:  [104.07512678]
mat_Sqrt:  [[0.15]]
grads:  [0.02610935]
Stock Position:  0.026109353299919764
Bond Position:  [50.95288948]


portfolio before change:  [53.71383369]
curr_Stock_Price:  105.25746710195622
curr_Factors:  [105.2574671]
mat_Sqrt:  [[0.15]]
grads:  [0.0929723]
Stock Position:  0.09297230491206224
Bond Position:  [43.92780436]


portfolio before change:  [53.84720921]
curr_Stock_Price:  106.57390428919308
curr_Factors:  [106.57390429]
mat_Sqrt:  [[0.15]]
grads:  [-0.10705262]
Stock Position:  -0.10705261995508586
Bond Position:  [65.25622488]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [54.02387357]
Stock Price:  105.076058997562
PL:  [48.94781457]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 9.30118389e-04]
 [-9.98912206e-03]
 [-5.13106645e-03]
 [-8.40380440e-03]
 [-5.65551578e-03]
 [-1.08736239e-02]
 [ 1.29399854e-02]
 [-4.47642298e-02]
 [-1.99626862e-03]
 [ 6.26803974e-03]
 [-3.25239266e-03]
 [-4.70794522e-03]
 [ 4.81363058e-03]
 [-6.15572690e-04]
 [ 4.72064800e-04]
 [ 2.24653518e-02]
 [ 1.35904009e-03]
 [ 1.19997326e-02]
 [-1.03641947e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-40.52729254]
curr_Stock_Price:  98.08872092840353
curr_Factors:  [98.08872093]
mat_Sqrt:  [[0.15]]
grads:  [0.00620079]
Stock Position:  0.006200789259736747
Bond Position:  [-41.13552003]


portfolio before change:  [-40.52584164]
curr_Stock_Price:  99.98139395818673
curr_Factors:  [99.98139396]
mat_Sqrt:  [[0.15]]
grads:  [-0.06659415]
Stock Position:  -0.06659414708012562
Bond Position:  [-33.86766599]


portfolio before change:  [-40.47332354]
curr_Stock_Price:  99.06560654136878
curr_Factors:  [99.06560654]
mat_Sqrt:  [[0.15]]
grads:  [-0.03420711]
Stock Position:  -0.03420710967542205
Bond Position:  [-37.08457547]


portfolio before change:  [-40.4451704]
curr_Stock_Price:  97.97152285004987
curr_Factors:  [97.97152285]
mat_Sqrt:  [[0.15]]
grads:  [-0.05602536]
Stock Position:  -0.05602536266807388
Bond Position:  [-34.9562803]


portfolio before change:  [-40.37887781]
curr_Stock_Price:  96.6322588876765
curr_Factors:  [96.63225889]
mat_Sqrt:  [[0.15]]
grads:  [-0.03770344]
Stock Position:  -0.03770343851546163
Bond Position:  [-36.73550938]


portfolio before change:  [-40.43195531]
curr_Stock_Price:  97.7964091662746
curr_Factors:  [97.79640917]
mat_Sqrt:  [[0.15]]
grads:  [-0.07249083]
Stock Position:  -0.0724908258660278
Bond Position:  [-33.34261284]


portfolio before change:  [-40.42675257]
curr_Stock_Price:  97.60963480170142
curr_Factors:  [97.6096348]
mat_Sqrt:  [[0.15]]
grads:  [0.08626657]
Stock Position:  0.08626656951908511
Bond Position:  [-48.84720092]


portfolio before change:  [-40.43357207]
curr_Stock_Price:  97.67215995250923
curr_Factors:  [97.67215995]
mat_Sqrt:  [[0.15]]
grads:  [-0.2984282]
Stock Position:  -0.29842819875603677
Bond Position:  [-11.28544531]


portfolio before change:  [-40.64336867]
curr_Stock_Price:  98.36570998833446
curr_Factors:  [98.36570999]
mat_Sqrt:  [[0.15]]
grads:  [-0.01330846]
Stock Position:  -0.013308457484604526
Bond Position:  [-39.3342728]


portfolio before change:  [-40.67255318]
curr_Stock_Price:  99.81965088498396
curr_Factors:  [99.81965088]
mat_Sqrt:  [[0.15]]
grads:  [0.04178693]
Stock Position:  0.04178693158855623
Bond Position:  [-44.8437101]


portfolio before change:  [-40.70532033]
curr_Stock_Price:  99.30382393706232
curr_Factors:  [99.30382394]
mat_Sqrt:  [[0.15]]
grads:  [-0.02168262]
Stock Position:  -0.0216826177560416
Bond Position:  [-38.55215348]


portfolio before change:  [-40.7363072]
curr_Stock_Price:  100.28837386832744
curr_Factors:  [100.28837387]
mat_Sqrt:  [[0.15]]
grads:  [-0.0313863]
Stock Position:  -0.031386301470708165
Bond Position:  [-37.58862606]


portfolio before change:  [-40.72965262]
curr_Stock_Price:  99.77691168078454
curr_Factors:  [99.77691168]
mat_Sqrt:  [[0.15]]
grads:  [0.03209087]
Stock Position:  0.0320908705274505
Bond Position:  [-43.93158058]


portfolio before change:  [-40.74838955]
curr_Stock_Price:  99.53532708375481
curr_Factors:  [99.53532708]
mat_Sqrt:  [[0.15]]
grads:  [-0.00410382]
Stock Position:  -0.004103817935416335
Bond Position:  [-40.33991469]


portfolio before change:  [-40.76586264]
curr_Stock_Price:  101.33532173914803
curr_Factors:  [101.33532174]
mat_Sqrt:  [[0.15]]
grads:  [0.0031471]
Stock Position:  0.0031470986678367764
Bond Position:  [-41.0847749]


portfolio before change:  [-40.77462074]
curr_Stock_Price:  101.81652047369072
curr_Factors:  [101.81652047]
mat_Sqrt:  [[0.15]]
grads:  [0.14976901]
Stock Position:  0.14976901208002674
Bond Position:  [-56.02358042]


portfolio before change:  [-40.80674532]
curr_Stock_Price:  101.69555464230935
curr_Factors:  [101.69555464]
mat_Sqrt:  [[0.15]]
grads:  [0.00906027]
Stock Position:  0.009060267291983561
Bond Position:  [-41.72813422]


portfolio before change:  [-40.81172029]
curr_Stock_Price:  102.29800542111725
curr_Factors:  [102.29800542]
mat_Sqrt:  [[0.15]]
grads:  [0.07999822]
Stock Position:  0.0799982171803874
Bond Position:  [-48.99537834]


portfolio before change:  [-40.77173231]
curr_Stock_Price:  102.95099934789451
curr_Factors:  [102.95099935]
mat_Sqrt:  [[0.15]]
grads:  [-0.06909463]
Stock Position:  -0.06909463130743156
Bond Position:  [-33.65837097]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-40.79519955]
Stock Price:  103.16883964582983
PL:  [-43.9640392]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.34625029e-02]
 [ 7.45621595e-02]
 [-9.26293243e-02]
 [ 1.04699678e-01]
 [ 3.07284293e-03]
 [-1.93605867e-02]
 [-2.12244672e-02]
 [-9.46583313e-03]
 [ 6.49315043e-02]
 [-6.12664496e-03]
 [-6.35248180e-03]
 [ 4.75749771e-02]
 [ 1.86210600e-02]
 [-9.51997833e-03]
 [ 2.93864644e-02]
 [ 1.71403086e-02]
 [ 1.23692923e-02]
 [ 1.59703515e-02]
 [-2.09470148e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [49.74835759]
curr_Stock_Price:  102.18469873851636
curr_Factors:  [102.18469874]
mat_Sqrt:  [[0.15]]
grads:  [-0.15641669]
Stock Position:  -0.15641668597280664
Bond Position:  [65.73174952]


portfolio before change:  [49.53278634]
curr_Stock_Price:  103.66795639177197
curr_Factors:  [103.66795639]
mat_Sqrt:  [[0.15]]
grads:  [0.49708106]
Stock Position:  0.49708106338575014
Bond Position:  [-1.99859167]


portfolio before change:  [50.68576411]
curr_Stock_Price:  105.98845815503512
curr_Factors:  [105.98845816]
mat_Sqrt:  [[0.15]]
grads:  [-0.61752883]
Stock Position:  -0.6175288283874553
Bond Position:  [116.1366925]


portfolio before change:  [50.70671936]
curr_Stock_Price:  106.0015467050216
curr_Factors:  [106.00154671]
mat_Sqrt:  [[0.15]]
grads:  [0.69799785]
Stock Position:  0.6979978517095807
Bond Position:  [-23.28213252]


portfolio before change:  [50.59004678]
curr_Stock_Price:  105.8427334495666
curr_Factors:  [105.84273345]
mat_Sqrt:  [[0.15]]
grads:  [0.02048562]
Stock Position:  0.020485619502713527
Bond Position:  [48.42179282]


portfolio before change:  [50.59699179]
curr_Stock_Price:  105.59075422660167
curr_Factors:  [105.59075423]
mat_Sqrt:  [[0.15]]
grads:  [-0.12907058]
Stock Position:  -0.12907057778404668
Bond Position:  [64.22565145]


portfolio before change:  [50.28051754]
curr_Stock_Price:  108.16711731698993
curr_Factors:  [108.16711732]
mat_Sqrt:  [[0.15]]
grads:  [-0.14149645]
Stock Position:  -0.14149644797737526
Bond Position:  [65.58578043]


portfolio before change:  [50.30488534]
curr_Stock_Price:  108.11079570818256
curr_Factors:  [108.11079571]
mat_Sqrt:  [[0.15]]
grads:  [-0.06310555]
Stock Position:  -0.0631055542158798
Bond Position:  [57.12727702]


portfolio before change:  [50.23381005]
curr_Stock_Price:  109.46343264451257
curr_Factors:  [109.46343264]
mat_Sqrt:  [[0.15]]
grads:  [0.4328767]
Stock Position:  0.4328766950036319
Bond Position:  [2.8496411]


portfolio before change:  [49.95525462]
curr_Stock_Price:  108.81828836510267
curr_Factors:  [108.81828837]
mat_Sqrt:  [[0.15]]
grads:  [-0.0408443]
Stock Position:  -0.040844299734479575
Bond Position:  [54.39986141]


portfolio before change:  [49.95181314]
curr_Stock_Price:  109.23555940324142
curr_Factors:  [109.2355594]
mat_Sqrt:  [[0.15]]
grads:  [-0.04234988]
Stock Position:  -0.042349878664731035
Bond Position:  [54.57792583]


portfolio before change:  [49.88654645]
curr_Stock_Price:  111.09891504182634
curr_Factors:  [111.09891504]
mat_Sqrt:  [[0.15]]
grads:  [0.31716651]
Stock Position:  0.3171665138779259
Bond Position:  [14.64969087]


portfolio before change:  [49.5406666]
curr_Stock_Price:  109.99683551546816
curr_Factors:  [109.99683552]
mat_Sqrt:  [[0.15]]
grads:  [0.1241404]
Stock Position:  0.1241403998714187
Bond Position:  [35.88561546]


portfolio before change:  [49.66025354]
curr_Stock_Price:  110.88787832042044
curr_Factors:  [110.88787832]
mat_Sqrt:  [[0.15]]
grads:  [-0.06346652]
Stock Position:  -0.06346652221717838
Bond Position:  [56.69792153]


portfolio before change:  [49.76658271]
curr_Stock_Price:  109.43588580163714
curr_Factors:  [109.4358858]
mat_Sqrt:  [[0.15]]
grads:  [0.19590976]
Stock Position:  0.19590976286623135
Bond Position:  [28.32702427]


portfolio before change:  [49.99277322]
curr_Stock_Price:  110.5542980319473
curr_Factors:  [110.55429803]
mat_Sqrt:  [[0.15]]
grads:  [0.11426872]
Stock Position:  0.11426872404229939
Bond Position:  [37.35987465]


portfolio before change:  [49.83615971]
curr_Stock_Price:  109.10197893591148
curr_Factors:  [109.10197894]
mat_Sqrt:  [[0.15]]
grads:  [0.08246195]
Stock Position:  0.08246194834854094
Bond Position:  [40.83939796]


portfolio before change:  [49.87392056]
curr_Stock_Price:  109.4360690206398
curr_Factors:  [109.43606902]
mat_Sqrt:  [[0.15]]
grads:  [0.10646901]
Stock Position:  0.10646900988982028
Bond Position:  [38.22237064]


portfolio before change:  [50.04795787]
curr_Stock_Price:  110.98093661401171
curr_Factors:  [110.98093661]
mat_Sqrt:  [[0.15]]
grads:  [-0.13964677]
Stock Position:  -0.13964676539090518
Bond Position:  [65.54608668]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [49.98694954]
Stock Price:  111.53516999585858
PL:  [38.45177954]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.61121846e-04]
 [-1.06619377e-02]
 [-6.53069057e-03]
 [ 2.42179502e-03]
 [ 5.71602783e-03]
 [-9.68867118e-03]
 [ 2.35284606e-03]
 [ 1.38053709e-02]
 [-1.68352046e-02]
 [ 2.25803703e-03]
 [-2.92195710e-03]
 [-5.33096151e-03]
 [ 6.58775898e-03]
 [-7.14509119e-04]
 [ 5.97048935e-03]
 [ 2.23578527e-02]
 [ 3.51588034e-03]
 [ 1.38329778e-02]
 [-1.40008275e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-29.13525778]
curr_Stock_Price:  98.60559919556111
curr_Factors:  [98.6055992]
mat_Sqrt:  [[0.15]]
grads:  [0.00174081]
Stock Position:  0.0017408123098151588
Bond Position:  [-29.30691162]


portfolio before change:  [-29.14039622]
curr_Stock_Price:  99.86317340710715
curr_Factors:  [99.86317341]
mat_Sqrt:  [[0.15]]
grads:  [-0.07107958]
Stock Position:  -0.0710795845913768
Bond Position:  [-22.04216334]


portfolio before change:  [-29.20165376]
curr_Stock_Price:  100.6474535617437
curr_Factors:  [100.64745356]
mat_Sqrt:  [[0.15]]
grads:  [-0.04353794]
Stock Position:  -0.04353793714115837
Bond Position:  [-24.81967125]


portfolio before change:  [-29.2151027]
curr_Stock_Price:  100.81381993880038
curr_Factors:  [100.81381994]
mat_Sqrt:  [[0.15]]
grads:  [0.0161453]
Stock Position:  0.01614530014095127
Bond Position:  [-30.84277208]


portfolio before change:  [-29.21382909]
curr_Stock_Price:  101.37034554271443
curr_Factors:  [101.37034554]
mat_Sqrt:  [[0.15]]
grads:  [0.03810685]
Stock Position:  0.03810685219101897
Bond Position:  [-33.07673386]


portfolio before change:  [-29.2125881]
curr_Stock_Price:  101.61993863262823
curr_Factors:  [101.61993863]
mat_Sqrt:  [[0.15]]
grads:  [-0.06459114]
Stock Position:  -0.06459114122422853
Bond Position:  [-22.64884029]


portfolio before change:  [-29.21982464]
curr_Stock_Price:  101.64430155907799
curr_Factors:  [101.64430156]
mat_Sqrt:  [[0.15]]
grads:  [0.01568564]
Stock Position:  0.01568564038060614
Bond Position:  [-30.8141806]


portfolio before change:  [-29.23483603]
curr_Stock_Price:  101.17846907829765
curr_Factors:  [101.17846908]
mat_Sqrt:  [[0.15]]
grads:  [0.09203581]
Stock Position:  0.09203580605651307
Bond Position:  [-38.54687799]


portfolio before change:  [-29.26350342]
curr_Stock_Price:  100.97170758891205
curr_Factors:  [100.97170759]
mat_Sqrt:  [[0.15]]
grads:  [-0.1122347]
Stock Position:  -0.11223469741104368
Bond Position:  [-17.93097437]


portfolio before change:  [-29.33966726]
curr_Stock_Price:  101.61037407860107
curr_Factors:  [101.61037408]
mat_Sqrt:  [[0.15]]
grads:  [0.01505358]
Stock Position:  0.015053580219378915
Bond Position:  [-30.86926718]


portfolio before change:  [-29.36675641]
curr_Stock_Price:  100.32357960957366
curr_Factors:  [100.32357961]
mat_Sqrt:  [[0.15]]
grads:  [-0.01947971]
Stock Position:  -0.019479714013641153
Bond Position:  [-27.41248177]


portfolio before change:  [-29.37980181]
curr_Stock_Price:  100.64141947658725
curr_Factors:  [100.64141948]
mat_Sqrt:  [[0.15]]
grads:  [-0.03553974]
Stock Position:  -0.03553974342071098
Bond Position:  [-25.80303159]


portfolio before change:  [-29.42206978]
curr_Stock_Price:  101.64920388327812
curr_Factors:  [101.64920388]
mat_Sqrt:  [[0.15]]
grads:  [0.04391839]
Stock Position:  0.04391839318560721
Bond Position:  [-33.88633948]


portfolio before change:  [-29.33857946]
curr_Stock_Price:  103.74315492811807
curr_Factors:  [103.74315493]
mat_Sqrt:  [[0.15]]
grads:  [-0.00476339]
Stock Position:  -0.004763394126659486
Bond Position:  [-28.84440992]


portfolio before change:  [-29.34766284]
curr_Stock_Price:  104.1360214456851
curr_Factors:  [104.13602145]
mat_Sqrt:  [[0.15]]
grads:  [0.03980326]
Stock Position:  0.03980326234866317
Bond Position:  [-33.49261622]


portfolio before change:  [-29.36140312]
curr_Stock_Price:  104.00120636502852
curr_Factors:  [104.00120637]
mat_Sqrt:  [[0.15]]
grads:  [0.14905235]
Stock Position:  0.14905235144239745
Bond Position:  [-44.86302748]


portfolio before change:  [-29.38876483]
curr_Stock_Price:  103.89289173000921
curr_Factors:  [103.89289173]
mat_Sqrt:  [[0.15]]
grads:  [0.0234392]
Stock Position:  0.02343920225710198
Bond Position:  [-31.82393133]


portfolio before change:  [-29.36900981]
curr_Stock_Price:  105.07518428556824
curr_Factors:  [105.07518429]
mat_Sqrt:  [[0.15]]
grads:  [0.09221985]
Stock Position:  0.09221985168430918
Bond Position:  [-39.05902772]


portfolio before change:  [-29.4542891]
curr_Stock_Price:  104.25634423107951
curr_Factors:  [104.25634423]
mat_Sqrt:  [[0.15]]
grads:  [-0.09333885]
Stock Position:  -0.09333884983271352
Bond Position:  [-19.72312184]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-29.50549881]
Stock Price:  104.75215400801252
PL:  [-34.25765282]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.70225829e-03]
 [-9.60190638e-03]
 [-4.53716265e-03]
 [ 8.01675222e-04]
 [ 5.70092502e-03]
 [-9.66614434e-03]
 [-8.53088895e-04]
 [ 1.12512134e-02]
 [-1.14722069e-02]
 [ 2.46446398e-03]
 [-3.09876765e-03]
 [-4.63039031e-03]
 [ 4.80863533e-03]
 [-3.85193194e-04]
 [ 4.27153130e-03]
 [ 1.90818615e-02]
 [ 3.23293785e-03]
 [ 8.32092130e-03]
 [-4.16801349e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.29726493]
curr_Stock_Price:  99.36957093090133
curr_Factors:  [99.36957093]
mat_Sqrt:  [[0.15]]
grads:  [0.01801506]
Stock Position:  0.0180150552539774
Bond Position:  [-14.08741324]


portfolio before change:  [-12.28505845]
curr_Stock_Price:  100.24266114055337
curr_Factors:  [100.24266114]
mat_Sqrt:  [[0.15]]
grads:  [-0.06401271]
Stock Position:  -0.06401270922021417
Bond Position:  [-5.86825413]


portfolio before change:  [-12.22284177]
curr_Stock_Price:  99.24779727339545
curr_Factors:  [99.24779727]
mat_Sqrt:  [[0.15]]
grads:  [-0.03024775]
Stock Position:  -0.0302477510077977
Bond Position:  [-9.22081911]


portfolio before change:  [-12.27099198]
curr_Stock_Price:  100.76343776543483
curr_Factors:  [100.76343777]
mat_Sqrt:  [[0.15]]
grads:  [0.0053445]
Stock Position:  0.0053445014788966235
Bond Position:  [-12.80952232]


portfolio before change:  [-12.26631345]
curr_Stock_Price:  102.2380947674993
curr_Factors:  [102.23809477]
mat_Sqrt:  [[0.15]]
grads:  [0.03800617]
Stock Position:  0.03800616677815369
Bond Position:  [-16.15199153]


portfolio before change:  [-12.29455809]
curr_Stock_Price:  101.6011944058639
curr_Factors:  [101.60119441]
mat_Sqrt:  [[0.15]]
grads:  [-0.06444096]
Stock Position:  -0.06444096227794334
Bond Position:  [-5.74727936]


portfolio before change:  [-12.33864718]
curr_Stock_Price:  102.26307295113384
curr_Factors:  [102.26307295]
mat_Sqrt:  [[0.15]]
grads:  [-0.00568726]
Stock Position:  -0.005687259297161603
Bond Position:  [-11.75705057]


portfolio before change:  [-12.33767525]
curr_Stock_Price:  101.57529628655648
curr_Factors:  [101.57529629]
mat_Sqrt:  [[0.15]]
grads:  [0.07500809]
Stock Position:  0.07500808960800688
Bond Position:  [-19.95664418]


portfolio before change:  [-12.27093753]
curr_Stock_Price:  102.53155992861642
curr_Factors:  [102.53155993]
mat_Sqrt:  [[0.15]]
grads:  [-0.07648138]
Stock Position:  -0.07648137964503218
Bond Position:  [-4.42918237]


portfolio before change:  [-12.26565749]
curr_Stock_Price:  102.44804320057086
curr_Factors:  [102.4480432]
mat_Sqrt:  [[0.15]]
grads:  [0.01642976]
Stock Position:  0.01642975987375037
Bond Position:  [-13.94885423]


portfolio before change:  [-12.26879087]
curr_Stock_Price:  102.46960536358253
curr_Factors:  [102.46960536]
mat_Sqrt:  [[0.15]]
grads:  [-0.02065845]
Stock Position:  -0.020658451006351296
Bond Position:  [-10.15192755]


portfolio before change:  [-12.22316195]
curr_Stock_Price:  100.13800638083273
curr_Factors:  [100.13800638]
mat_Sqrt:  [[0.15]]
grads:  [-0.03086927]
Stock Position:  -0.03086926875308043
Bond Position:  [-9.13197492]


portfolio before change:  [-12.2155166]
curr_Stock_Price:  99.81637166274297
curr_Factors:  [99.81637166]
mat_Sqrt:  [[0.15]]
grads:  [0.03205757]
Stock Position:  0.032057568876873964
Bond Position:  [-15.41538681]


portfolio before change:  [-12.20427898]
curr_Stock_Price:  100.2871479654518
curr_Factors:  [100.28714797]
mat_Sqrt:  [[0.15]]
grads:  [-0.00256795]
Stock Position:  -0.0025679546251393924
Bond Position:  [-11.94674614]


portfolio before change:  [-12.20636861]
curr_Stock_Price:  99.9376746068393
curr_Factors:  [99.93767461]
mat_Sqrt:  [[0.15]]
grads:  [0.02847688]
Stock Position:  0.028476875330877203
Bond Position:  [-15.05228131]


portfolio before change:  [-12.19647841]
curr_Stock_Price:  100.41714223337245
curr_Factors:  [100.41714223]
mat_Sqrt:  [[0.15]]
grads:  [0.12721241]
Stock Position:  0.1272124099355698
Bond Position:  [-24.97078508]


portfolio before change:  [-12.16143787]
curr_Stock_Price:  100.74167047076119
curr_Factors:  [100.74167047]
mat_Sqrt:  [[0.15]]
grads:  [0.02155292]
Stock Position:  0.021552918982398
Bond Position:  [-14.33271493]


portfolio before change:  [-12.18761849]
curr_Stock_Price:  99.69322841176076
curr_Factors:  [99.69322841]
mat_Sqrt:  [[0.15]]
grads:  [0.05547281]
Stock Position:  0.055472808685964915
Bond Position:  [-17.71788187]


portfolio before change:  [-12.28808082]
curr_Stock_Price:  97.96206841794148
curr_Factors:  [97.96206842]
mat_Sqrt:  [[0.15]]
grads:  [-0.02778676]
Stock Position:  -0.02778675661711304
Bond Position:  [-9.56603266]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.35294391]
Stock Price:  100.21030804602714
PL:  [-12.56325196]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-2.05568993e-02]
 [-9.41457555e-03]
 [-4.19613167e-03]
 [-1.89910445e-02]
 [ 9.66027337e-04]
 [-1.06440673e-02]
 [ 1.25663581e-02]
 [-4.18219165e-02]
 [ 6.77570320e-05]
 [ 9.26467429e-03]
 [-3.05252426e-03]
 [-3.00083374e-03]
 [ 6.77004413e-03]
 [ 1.41971323e-04]
 [ 2.18291515e-03]
 [ 1.69071330e-02]
 [ 6.21887871e-03]
 [ 3.90846082e-03]
 [-4.64853088e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [38.29286088]
curr_Stock_Price:  101.66494108234431
curr_Factors:  [101.66494108]
mat_Sqrt:  [[0.15]]
grads:  [-0.137046]
Stock Position:  -0.1370459952872089
Bond Position:  [52.22563392]


portfolio before change:  [38.49781398]
curr_Stock_Price:  100.26471733840779
curr_Factors:  [100.26471734]
mat_Sqrt:  [[0.15]]
grads:  [-0.06276384]
Stock Position:  -0.06276383701092005
Bond Position:  [44.79081236]


portfolio before change:  [38.55154742]
curr_Stock_Price:  99.58702867005066
curr_Factors:  [99.58702867]
mat_Sqrt:  [[0.15]]
grads:  [-0.02797421]
Stock Position:  -0.02797421113268395
Bond Position:  [41.33741599]


portfolio before change:  [38.55196931]
curr_Stock_Price:  99.94141774569307
curr_Factors:  [99.94141775]
mat_Sqrt:  [[0.15]]
grads:  [-0.12660696]
Stock Position:  -0.12660696301186317
Bond Position:  [51.20524869]


portfolio before change:  [38.76810692]
curr_Stock_Price:  98.33538687405392
curr_Factors:  [98.33538687]
mat_Sqrt:  [[0.15]]
grads:  [0.00644018]
Stock Position:  0.006440182246514288
Bond Position:  [38.13480911]


portfolio before change:  [38.7801956]
curr_Stock_Price:  98.73192634296238
curr_Factors:  [98.73192634]
mat_Sqrt:  [[0.15]]
grads:  [-0.07096045]
Stock Position:  -0.07096044857047007
Bond Position:  [45.78625738]


portfolio before change:  [38.92650961]
curr_Stock_Price:  96.8313462666514
curr_Factors:  [96.83134627]
mat_Sqrt:  [[0.15]]
grads:  [0.08377572]
Stock Position:  0.08377572050829943
Bond Position:  [30.81439381]


portfolio before change:  [38.92314912]
curr_Stock_Price:  96.69926684686867
curr_Factors:  [96.69926685]
mat_Sqrt:  [[0.15]]
grads:  [-0.27881278]
Stock Position:  -0.2788127764875152
Bond Position:  [65.8841402]


portfolio before change:  [38.708424]
curr_Stock_Price:  97.52849074649026
curr_Factors:  [97.52849075]
mat_Sqrt:  [[0.15]]
grads:  [0.00045171]
Stock Position:  0.00045171354659456997
Bond Position:  [38.66436906]


portfolio before change:  [38.71882687]
curr_Stock_Price:  99.15689713563148
curr_Factors:  [99.15689714]
mat_Sqrt:  [[0.15]]
grads:  [0.0617645]
Stock Position:  0.061764495289674724
Bond Position:  [32.59445117]


portfolio before change:  [38.89186375]
curr_Stock_Price:  101.82650929080077
curr_Factors:  [101.82650929]
mat_Sqrt:  [[0.15]]
grads:  [-0.02035016]
Stock Position:  -0.020350161719998365
Bond Position:  [40.96404968]


portfolio before change:  [38.87801504]
curr_Stock_Price:  103.01033281718254
curr_Factors:  [103.01033282]
mat_Sqrt:  [[0.15]]
grads:  [-0.02000556]
Stock Position:  -0.02000555825621567
Bond Position:  [40.93879426]


portfolio before change:  [38.91302778]
curr_Stock_Price:  101.77183900406109
curr_Factors:  [101.771839]
mat_Sqrt:  [[0.15]]
grads:  [0.04513363]
Stock Position:  0.0451336275414556
Bond Position:  [34.31969551]


portfolio before change:  [38.90508449]
curr_Stock_Price:  101.40571980191147
curr_Factors:  [101.4057198]
mat_Sqrt:  [[0.15]]
grads:  [0.00094648]
Stock Position:  0.0009464754874914733
Bond Position:  [38.80910646]


portfolio before change:  [38.91413072]
curr_Stock_Price:  100.71129301848727
curr_Factors:  [100.71129302]
mat_Sqrt:  [[0.15]]
grads:  [0.01455277]
Stock Position:  0.014552767657990778
Bond Position:  [37.44850267]


portfolio before change:  [38.91049928]
curr_Stock_Price:  99.81835353595848
curr_Factors:  [99.81835354]
mat_Sqrt:  [[0.15]]
grads:  [0.11271422]
Stock Position:  0.11271421972571206
Bond Position:  [27.65955144]


portfolio before change:  [38.72318675]
curr_Stock_Price:  98.09516122916028
curr_Factors:  [98.09516123]
mat_Sqrt:  [[0.15]]
grads:  [0.04145919]
Stock Position:  0.04145919138857985
Bond Position:  [34.65624069]


portfolio before change:  [38.72948694]
curr_Stock_Price:  98.03811835823882
curr_Factors:  [98.03811836]
mat_Sqrt:  [[0.15]]
grads:  [0.02605641]
Stock Position:  0.026056405472542957
Bond Position:  [36.17496598]


portfolio before change:  [38.7280105]
curr_Stock_Price:  97.63432844096648
curr_Factors:  [97.63432844]
mat_Sqrt:  [[0.15]]
grads:  [-0.03099021]
Stock Position:  -0.030990205841134787
Bond Position:  [41.75371844]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [38.72321947]
Stock Price:  98.12579869046027
PL:  [38.72321947]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.74478092e-03]
 [-8.01925120e-04]
 [-7.04175675e-03]
 [-1.98519132e-02]
 [ 6.28776547e-03]
 [-1.00691536e-02]
 [ 1.38475320e-02]
 [-2.66328957e-02]
 [-1.85546911e-02]
 [ 2.50545515e-03]
 [-3.16767853e-03]
 [ 2.49276249e-03]
 [ 5.84355161e-03]
 [-9.48279571e-04]
 [ 8.24398000e-03]
 [ 1.78985779e-02]
 [ 6.55588585e-03]
 [ 1.05051218e-03]
 [-6.63764616e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.78004528]
curr_Stock_Price:  99.43841006959214
curr_Factors:  [99.43841007]
mat_Sqrt:  [[0.15]]
grads:  [0.01829854]
Stock Position:  0.018298539492504047
Bond Position:  [-12.59962295]


portfolio before change:  [-10.80849808]
curr_Stock_Price:  98.05564928586001
curr_Factors:  [98.05564929]
mat_Sqrt:  [[0.15]]
grads:  [-0.00534617]
Stock Position:  -0.005346167463928648
Bond Position:  [-10.28427616]


portfolio before change:  [-10.81376553]
curr_Stock_Price:  98.5599455094439
curr_Factors:  [98.55994551]
mat_Sqrt:  [[0.15]]
grads:  [-0.04694504]
Stock Position:  -0.04694504499367568
Bond Position:  [-6.18686445]


portfolio before change:  [-10.84868265]
curr_Stock_Price:  99.27078128667469
curr_Factors:  [99.27078129]
mat_Sqrt:  [[0.15]]
grads:  [-0.13234609]
Stock Position:  -0.13234608796766445
Bond Position:  [2.2894169]


portfolio before change:  [-10.9119434]
curr_Stock_Price:  99.75310134360977
curr_Factors:  [99.75310134]
mat_Sqrt:  [[0.15]]
grads:  [0.04191844]
Stock Position:  0.04191843645269414
Bond Position:  [-15.09343744]


portfolio before change:  [-10.91855265]
curr_Stock_Price:  99.68545999599984
curr_Factors:  [99.68546]
mat_Sqrt:  [[0.15]]
grads:  [-0.06712769]
Stock Position:  -0.06712769074990052
Bond Position:  [-4.22689792]


portfolio before change:  [-10.87000728]
curr_Stock_Price:  98.94653654775853
curr_Factors:  [98.94653655]
mat_Sqrt:  [[0.15]]
grads:  [0.09231688]
Stock Position:  0.09231687967973418
Bond Position:  [-20.00444279]


portfolio before change:  [-10.88423335]
curr_Stock_Price:  98.84661619038827
curr_Factors:  [98.84661619]
mat_Sqrt:  [[0.15]]
grads:  [-0.17755264]
Stock Position:  -0.17755263775576283
Bond Position:  [6.66624408]


portfolio before change:  [-11.31916057]
curr_Stock_Price:  101.30557138596684
curr_Factors:  [101.30557139]
mat_Sqrt:  [[0.15]]
grads:  [-0.12369794]
Stock Position:  -0.1236979408754633
Bond Position:  [1.21213001]


portfolio before change:  [-11.2477646]
curr_Stock_Price:  100.73084157538302
curr_Factors:  [100.73084158]
mat_Sqrt:  [[0.15]]
grads:  [0.01670303]
Stock Position:  0.0167030343315158
Bond Position:  [-12.93027531]


portfolio before change:  [-11.27177989]
curr_Stock_Price:  99.48661764852534
curr_Factors:  [99.48661765]
mat_Sqrt:  [[0.15]]
grads:  [-0.02111786]
Stock Position:  -0.021117856868561616
Bond Position:  [-9.17083574]


portfolio before change:  [-11.23961524]
curr_Stock_Price:  97.8549348361526
curr_Factors:  [97.85493484]
mat_Sqrt:  [[0.15]]
grads:  [0.01661842]
Stock Position:  0.01661841657928686
Bond Position:  [-12.86580931]


portfolio before change:  [-11.25421613]
curr_Stock_Price:  97.16990964610599
curr_Factors:  [97.16990965]
mat_Sqrt:  [[0.15]]
grads:  [0.03895701]
Stock Position:  0.038957010745824146
Bond Position:  [-15.03966534]


portfolio before change:  [-11.21326667]
curr_Stock_Price:  98.31758093802296
curr_Factors:  [98.31758094]
mat_Sqrt:  [[0.15]]
grads:  [-0.00632186]
Stock Position:  -0.006321863807084891
Bond Position:  [-10.59171632]


portfolio before change:  [-11.20670847]
curr_Stock_Price:  96.86129133697217
curr_Factors:  [96.86129134]
mat_Sqrt:  [[0.15]]
grads:  [0.05495987]
Stock Position:  0.0549598666887206
Bond Position:  [-16.53019213]


portfolio before change:  [-11.14473075]
curr_Stock_Price:  98.06418330389724
curr_Factors:  [98.0641833]
mat_Sqrt:  [[0.15]]
grads:  [0.11932385]
Stock Position:  0.11932385282967292
Bond Position:  [-22.84612693]


portfolio before change:  [-11.20236633]
curr_Stock_Price:  97.62903697666742
curr_Factors:  [97.62903698]
mat_Sqrt:  [[0.15]]
grads:  [0.04370591]
Stock Position:  0.043705905685780394
Bond Position:  [-15.46933181]


portfolio before change:  [-11.23753562]
curr_Stock_Price:  96.91285300604352
curr_Factors:  [96.91285301]
mat_Sqrt:  [[0.15]]
grads:  [0.00700341]
Stock Position:  0.007003414505241055
Bond Position:  [-11.9162565]


portfolio before change:  [-11.24271946]
curr_Stock_Price:  96.59809167019458
curr_Factors:  [96.59809167]
mat_Sqrt:  [[0.15]]
grads:  [-0.04425097]
Stock Position:  -0.04425097440863151
Bond Position:  [-6.96815978]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.27892915]
Stock Price:  97.37699962644564
PL:  [-11.27892915]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.83905329e-02]
 [-4.35590071e-03]
 [-3.15172692e-02]
 [ 5.35878069e-03]
 [ 5.70150802e-03]
 [-1.13267682e-02]
 [-4.61143938e-03]
 [ 9.83877995e-04]
 [ 1.25241272e-02]
 [-2.09212906e-03]
 [-3.67485532e-03]
 [ 2.17305454e-02]
 [ 1.43355603e-02]
 [-4.55971577e-03]
 [ 1.24255468e-02]
 [ 2.29796341e-02]
 [ 9.54524402e-04]
 [ 1.28591008e-02]
 [-6.55788414e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [29.18518967]
curr_Stock_Price:  101.25170873089675
curr_Factors:  [101.25170873]
mat_Sqrt:  [[0.15]]
grads:  [-0.12260355]
Stock Position:  -0.1226035526410155
Bond Position:  [41.59900887]


portfolio before change:  [29.28151314]
curr_Stock_Price:  100.5508936622844
curr_Factors:  [100.55089366]
mat_Sqrt:  [[0.15]]
grads:  [-0.02903934]
Stock Position:  -0.02903933806615264
Bond Position:  [32.20144453]


portfolio before change:  [29.24789189]
curr_Stock_Price:  101.98593403308784
curr_Factors:  [101.98593403]
mat_Sqrt:  [[0.15]]
grads:  [-0.21011513]
Stock Position:  -0.21011512779032826
Bond Position:  [50.67667945]


portfolio before change:  [29.48765093]
curr_Stock_Price:  100.90515375317473
curr_Factors:  [100.90515375]
mat_Sqrt:  [[0.15]]
grads:  [0.0357252]
Stock Position:  0.035725204583286985
Bond Position:  [25.88279366]


portfolio before change:  [29.54141593]
curr_Stock_Price:  102.22896685238747
curr_Factors:  [102.22896685]
mat_Sqrt:  [[0.15]]
grads:  [0.03801005]
Stock Position:  0.03801005346652748
Bond Position:  [25.65568743]


portfolio before change:  [29.55459263]
curr_Stock_Price:  102.40686667692273
curr_Factors:  [102.40686668]
mat_Sqrt:  [[0.15]]
grads:  [-0.07551179]
Stock Position:  -0.07551178805456714
Bond Position:  [37.28751824]


portfolio before change:  [29.48481984]
curr_Stock_Price:  103.4543300857552
curr_Factors:  [103.45433009]
mat_Sqrt:  [[0.15]]
grads:  [-0.03074293]
Stock Position:  -0.030742929178203857
Bond Position:  [32.66530899]


portfolio before change:  [29.48024303]
curr_Stock_Price:  103.8688696498863
curr_Factors:  [103.86886965]
mat_Sqrt:  [[0.15]]
grads:  [0.00655919]
Stock Position:  0.006559186634532202
Bond Position:  [28.79894773]


portfolio before change:  [29.49300634]
curr_Stock_Price:  104.7169437425455
curr_Factors:  [104.71694374]
mat_Sqrt:  [[0.15]]
grads:  [0.08349418]
Stock Position:  0.0834941811513356
Bond Position:  [20.74975087]


portfolio before change:  [29.59958812]
curr_Stock_Price:  105.93132405095116
curr_Factors:  [105.93132405]
mat_Sqrt:  [[0.15]]
grads:  [-0.01394753]
Stock Position:  -0.013947527076359293
Bond Position:  [31.07706813]


portfolio before change:  [29.60668471]
curr_Stock_Price:  105.97962268592926
curr_Factors:  [105.97962269]
mat_Sqrt:  [[0.15]]
grads:  [-0.02449904]
Stock Position:  -0.02449903545652398
Bond Position:  [32.20308324]


portfolio before change:  [29.59058054]
curr_Stock_Price:  106.9656187551799
curr_Factors:  [106.96561876]
mat_Sqrt:  [[0.15]]
grads:  [0.1448703]
Stock Position:  0.14487030237785636
Bond Position:  [14.094439]


portfolio before change:  [29.59483962]
curr_Stock_Price:  106.97069250573678
curr_Factors:  [106.97069251]
mat_Sqrt:  [[0.15]]
grads:  [0.0955704]
Stock Position:  0.09557040169163825
Bond Position:  [19.37160757]


portfolio before change:  [29.58940435]
curr_Stock_Price:  106.8631406134048
curr_Factors:  [106.86314061]
mat_Sqrt:  [[0.15]]
grads:  [-0.03039811]
Stock Position:  -0.030398105124890513
Bond Position:  [32.83784133]


portfolio before change:  [29.63572241]
curr_Stock_Price:  105.60952403248228
curr_Factors:  [105.60952403]
mat_Sqrt:  [[0.15]]
grads:  [0.08283698]
Stock Position:  0.08283697853568871
Bond Position:  [20.88734853]


portfolio before change:  [29.4346669]
curr_Stock_Price:  103.11935605067997
curr_Factors:  [103.11935605]
mat_Sqrt:  [[0.15]]
grads:  [0.15319756]
Stock Position:  0.153197560775852
Bond Position:  [13.63703309]


portfolio before change:  [29.25517846]
curr_Stock_Price:  101.92548502493155
curr_Factors:  [101.92548502]
mat_Sqrt:  [[0.15]]
grads:  [0.0063635]
Stock Position:  0.006363496012226185
Bond Position:  [28.60657604]


portfolio before change:  [29.27236546]
curr_Stock_Price:  103.50236424498715
curr_Factors:  [103.50236424]
mat_Sqrt:  [[0.15]]
grads:  [0.08572734]
Stock Position:  0.08572733889752547
Bond Position:  [20.39938321]


portfolio before change:  [29.12687134]
curr_Stock_Price:  101.7456946668447
curr_Factors:  [101.74569467]
mat_Sqrt:  [[0.15]]
grads:  [-0.04371923]
Stock Position:  -0.04371922761548258
Bond Position:  [33.57511452]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [29.20925593]
Stock Price:  100.05330956287584
PL:  [29.15594637]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.43208174e-02]
 [ 2.59434979e-02]
 [-2.92379811e-02]
 [-2.27989973e-02]
 [ 5.71315724e-03]
 [-9.64714308e-03]
 [ 1.20316054e-02]
 [-1.43614385e-02]
 [-1.60581201e-03]
 [ 9.80108458e-03]
 [-3.08481032e-03]
 [-6.52425086e-03]
 [ 4.99111205e-03]
 [-5.09038790e-04]
 [ 3.45299788e-03]
 [ 1.95799661e-02]
 [ 4.65135558e-03]
 [ 9.50190622e-03]
 [-8.79548683e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.74080156]
curr_Stock_Price:  100.7324550931155
curr_Factors:  [100.73245509]
mat_Sqrt:  [[0.15]]
grads:  [-0.09547212]
Stock Position:  -0.09547211607079777
Bond Position:  [27.35794221]


portfolio before change:  [17.65484848]
curr_Stock_Price:  101.70439776664395
curr_Factors:  [101.70439777]
mat_Sqrt:  [[0.15]]
grads:  [0.17295665]
Stock Position:  0.1729566529376481
Bond Position:  [0.06439625]


portfolio before change:  [17.67867539]
curr_Stock_Price:  101.84206700220406
curr_Factors:  [101.842067]
mat_Sqrt:  [[0.15]]
grads:  [-0.19491987]
Stock Position:  -0.19491987373711092
Bond Position:  [37.52971823]


portfolio before change:  [18.13478674]
curr_Stock_Price:  99.55021376646174
curr_Factors:  [99.55021377]
mat_Sqrt:  [[0.15]]
grads:  [-0.15199332]
Stock Position:  -0.1519933150823873
Bond Position:  [33.26575375]


portfolio before change:  [17.77317806]
curr_Stock_Price:  101.98404548808165
curr_Factors:  [101.98404549]
mat_Sqrt:  [[0.15]]
grads:  [0.03808771]
Stock Position:  0.038087714909769206
Bond Position:  [13.88883881]


portfolio before change:  [17.76146659]
curr_Stock_Price:  101.58538375705298
curr_Factors:  [101.58538376]
mat_Sqrt:  [[0.15]]
grads:  [-0.06431429]
Stock Position:  -0.06431428718974894
Bond Position:  [24.29485814]


portfolio before change:  [17.84846871]
curr_Stock_Price:  100.32706852206917
curr_Factors:  [100.32706852]
mat_Sqrt:  [[0.15]]
grads:  [0.0802107]
Stock Position:  0.08021070279809878
Bond Position:  [9.80116404]


portfolio before change:  [17.78955539]
curr_Stock_Price:  99.56203447220027
curr_Factors:  [99.56203447]
mat_Sqrt:  [[0.15]]
grads:  [-0.09574292]
Stock Position:  -0.09574292306746354
Bond Position:  [27.3219156]


portfolio before change:  [17.84684694]
curr_Stock_Price:  99.0349959166655
curr_Factors:  [99.03499592]
mat_Sqrt:  [[0.15]]
grads:  [-0.01070541]
Stock Position:  -0.010705413410463452
Bond Position:  [18.90705751]


portfolio before change:  [17.85255743]
curr_Stock_Price:  98.94316020317885
curr_Factors:  [98.9431602]
mat_Sqrt:  [[0.15]]
grads:  [0.06534056]
Stock Position:  0.06534056386226175
Bond Position:  [11.38755555]


portfolio before change:  [17.90259808]
curr_Stock_Price:  99.66542828300614
curr_Factors:  [99.66542828]
mat_Sqrt:  [[0.15]]
grads:  [-0.0205654]
Stock Position:  -0.02056540212702821
Bond Position:  [19.95225769]


portfolio before change:  [17.87472837]
curr_Stock_Price:  101.26317971576735
curr_Factors:  [101.26317972]
mat_Sqrt:  [[0.15]]
grads:  [-0.04349501]
Stock Position:  -0.043495005721026735
Bond Position:  [22.27917095]


portfolio before change:  [17.90733807]
curr_Stock_Price:  100.64151724272112
curr_Factors:  [100.64151724]
mat_Sqrt:  [[0.15]]
grads:  [0.03327408]
Stock Position:  0.03327408032538162
Bond Position:  [14.55858414]


portfolio before change:  [17.88731443]
curr_Stock_Price:  99.93034093965817
curr_Factors:  [99.93034094]
mat_Sqrt:  [[0.15]]
grads:  [-0.00339359]
Stock Position:  -0.003393591934114586
Bond Position:  [18.22643723]


portfolio before change:  [17.89088762]
curr_Stock_Price:  100.22029772775193
curr_Factors:  [100.22029773]
mat_Sqrt:  [[0.15]]
grads:  [0.02301999]
Stock Position:  0.02301998589643884
Bond Position:  [15.58381778]


portfolio before change:  [17.90216943]
curr_Stock_Price:  100.54112224376847
curr_Factors:  [100.54112224]
mat_Sqrt:  [[0.15]]
grads:  [0.13053311]
Stock Position:  0.1305331070633339
Bond Position:  [4.77822436]


portfolio before change:  [17.80257006]
curr_Stock_Price:  99.7689497071484
curr_Factors:  [99.76894971]
mat_Sqrt:  [[0.15]]
grads:  [0.03100904]
Stock Position:  0.031009037227533086
Bond Position:  [14.70883098]


portfolio before change:  [17.8306786]
curr_Stock_Price:  100.55681281081816
curr_Factors:  [100.55681281]
mat_Sqrt:  [[0.15]]
grads:  [0.06334604]
Stock Position:  0.06334604148900652
Bond Position:  [11.46080257]


portfolio before change:  [17.95655133]
curr_Stock_Price:  102.49864157570109
curr_Factors:  [102.49864158]
mat_Sqrt:  [[0.15]]
grads:  [-0.05863658]
Stock Position:  -0.05863657888280896
Bond Position:  [23.96672101]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.9463734]
Stock Price:  102.77441409873312
PL:  [15.1719593]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-7.59833888e-05]
 [-2.71733821e-03]
 [-5.07379415e-03]
 [-1.37467903e-02]
 [ 5.88748622e-03]
 [-1.05896328e-02]
 [ 1.43675535e-02]
 [-4.48925210e-02]
 [ 2.03406593e-03]
 [ 9.03082708e-03]
 [-3.26296338e-03]
 [-1.53615615e-03]
 [ 5.17182997e-03]
 [-9.66530628e-05]
 [ 4.83165820e-04]
 [ 2.12213634e-02]
 [ 3.11068902e-03]
 [ 9.71695045e-03]
 [-5.40512237e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-48.66080223]
curr_Stock_Price:  97.71968813648459
curr_Factors:  [97.71968814]
mat_Sqrt:  [[0.15]]
grads:  [-0.00050656]
Stock Position:  -0.0005065559252237969
Bond Position:  [-48.61130175]


portfolio before change:  [-48.6734141]
curr_Stock_Price:  98.6228951629028
curr_Factors:  [98.62289516]
mat_Sqrt:  [[0.15]]
grads:  [-0.01811559]
Stock Position:  -0.018115588056380427
Bond Position:  [-46.88680236]


portfolio before change:  [-48.71271683]
curr_Stock_Price:  100.14531639724196
curr_Factors:  [100.1453164]
mat_Sqrt:  [[0.15]]
grads:  [-0.03382529]
Stock Position:  -0.03382529436176541
Bond Position:  [-45.32527202]


portfolio before change:  [-48.72197947]
curr_Stock_Price:  100.08411687549662
curr_Factors:  [100.08411688]
mat_Sqrt:  [[0.15]]
grads:  [-0.09164527]
Stock Position:  -0.09164526888939474
Bond Position:  [-39.54974367]


portfolio before change:  [-48.66707498]
curr_Stock_Price:  99.37711737006643
curr_Factors:  [99.37711737]
mat_Sqrt:  [[0.15]]
grads:  [0.03924991]
Stock Position:  0.039249908138457176
Bond Position:  [-52.56761771]


portfolio before change:  [-48.69966972]
curr_Stock_Price:  98.88154446557688
curr_Factors:  [98.88154447]
mat_Sqrt:  [[0.15]]
grads:  [-0.07059755]
Stock Position:  -0.0705975523059513
Bond Position:  [-41.71887471]


portfolio before change:  [-48.74685723]
curr_Stock_Price:  99.40219261823633
curr_Factors:  [99.40219262]
mat_Sqrt:  [[0.15]]
grads:  [0.09578369]
Stock Position:  0.09578369008693226
Bond Position:  [-58.26796604]


portfolio before change:  [-48.92787778]
curr_Stock_Price:  97.66440471145934
curr_Factors:  [97.66440471]
mat_Sqrt:  [[0.15]]
grads:  [-0.29928347]
Stock Position:  -0.2992834735399868
Bond Position:  [-19.69853549]


portfolio before change:  [-48.57744792]
curr_Stock_Price:  96.47705178495788
curr_Factors:  [96.47705178]
mat_Sqrt:  [[0.15]]
grads:  [0.01356044]
Stock Position:  0.013560439508746575
Bond Position:  [-49.88571914]


portfolio before change:  [-48.58361282]
curr_Stock_Price:  96.94223518351076
curr_Factors:  [96.94223518]
mat_Sqrt:  [[0.15]]
grads:  [0.06020551]
Stock Position:  0.06020551383883155
Bond Position:  [-54.4200699]


portfolio before change:  [-48.45814431]
curr_Stock_Price:  99.25224323543351
curr_Factors:  [99.25224324]
mat_Sqrt:  [[0.15]]
grads:  [-0.02175309]
Stock Position:  -0.021753089191122135
Bond Position:  [-46.29910141]


portfolio before change:  [-48.46079301]
curr_Stock_Price:  98.84184044753746
curr_Factors:  [98.84184045]
mat_Sqrt:  [[0.15]]
grads:  [-0.01024104]
Stock Position:  -0.010241041033152595
Bond Position:  [-47.44854966]


portfolio before change:  [-48.46816308]
curr_Stock_Price:  98.40306242637753
curr_Factors:  [98.40306243]
mat_Sqrt:  [[0.15]]
grads:  [0.03447887]
Stock Position:  0.0344788664384102
Bond Position:  [-51.86098913]


portfolio before change:  [-48.3963712]
curr_Stock_Price:  100.86134373930481
curr_Factors:  [100.86134374]
mat_Sqrt:  [[0.15]]
grads:  [-0.00064435]
Stock Position:  -0.000644353751685899
Bond Position:  [-48.33138081]


portfolio before change:  [-48.40874238]
curr_Stock_Price:  101.30648590333647
curr_Factors:  [101.3064859]
mat_Sqrt:  [[0.15]]
grads:  [0.00322111]
Stock Position:  0.003221105467987971
Bond Position:  [-48.73506126]


portfolio before change:  [-48.42207701]
curr_Stock_Price:  100.94967192028166
curr_Factors:  [100.94967192]
mat_Sqrt:  [[0.15]]
grads:  [0.14147576]
Stock Position:  0.14147575606790197
Bond Position:  [-62.70400817]


portfolio before change:  [-48.4583782]
curr_Stock_Price:  100.80389970697175
curr_Factors:  [100.80389971]
mat_Sqrt:  [[0.15]]
grads:  [0.02073793]
Stock Position:  0.02073792676832524
Bond Position:  [-50.54884209]


portfolio before change:  [-48.47302408]
curr_Stock_Price:  100.70711654842016
curr_Factors:  [100.70711655]
mat_Sqrt:  [[0.15]]
grads:  [0.06477967]
Stock Position:  0.06477966969085097
Bond Position:  [-54.99679782]


portfolio before change:  [-48.47614778]
curr_Stock_Price:  100.87116824453477
curr_Factors:  [100.87116824]
mat_Sqrt:  [[0.15]]
grads:  [-0.03603415]
Stock Position:  -0.03603414915712002
Bond Position:  [-44.84134106]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-48.4137037]
Stock Price:  98.82711226960338
PL:  [-48.4137037]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-1.45957510e-02]
 [ 4.89904061e-02]
 [-4.47138699e-03]
 [-9.04555660e-03]
 [ 6.20810557e-03]
 [-1.03065581e-02]
 [ 4.61472805e-03]
 [ 1.18393862e-02]
 [-1.45474871e-03]
 [ 1.00505837e-02]
 [-6.04359872e-03]
 [ 1.08746954e-02]
 [ 6.39998354e-03]
 [-1.40853354e-03]
 [ 8.12866352e-03]
 [ 2.12606439e-02]
 [ 7.35418541e-03]
 [ 6.13269760e-04]
 [-8.71500516e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.46760448]
curr_Stock_Price:  100.76543152253757
curr_Factors:  [100.76543152]
mat_Sqrt:  [[0.15]]
grads:  [-0.09730501]
Stock Position:  -0.09730500663599219
Bond Position:  [28.27258546]


portfolio before change:  [18.28966493]
curr_Stock_Price:  102.6667579498271
curr_Factors:  [102.66675795]
mat_Sqrt:  [[0.15]]
grads:  [0.32660271]
Stock Position:  0.32660270741788744
Bond Position:  [-15.24157618]


portfolio before change:  [17.32923583]
curr_Stock_Price:  99.73776132920408
curr_Factors:  [99.73776133]
mat_Sqrt:  [[0.15]]
grads:  [-0.02980925]
Stock Position:  -0.02980924663127113
Bond Position:  [20.30234336]


portfolio before change:  [17.31407938]
curr_Stock_Price:  100.41649936154725
curr_Factors:  [100.41649936]
mat_Sqrt:  [[0.15]]
grads:  [-0.06030371]
Stock Position:  -0.06030371065811836
Bond Position:  [23.3695669]


portfolio before change:  [17.30101724]
curr_Stock_Price:  100.73000017600569
curr_Factors:  [100.73000018]
mat_Sqrt:  [[0.15]]
grads:  [0.04138737]
Stock Position:  0.041387370434998356
Bond Position:  [13.13206741]


portfolio before change:  [17.35610067]
curr_Stock_Price:  101.98158972016985
curr_Factors:  [101.98158972]
mat_Sqrt:  [[0.15]]
grads:  [-0.06871039]
Stock Position:  -0.06871038719976863
Bond Position:  [24.36329518]


portfolio before change:  [17.40641536]
curr_Stock_Price:  101.33797368665965
curr_Factors:  [101.33797369]
mat_Sqrt:  [[0.15]]
grads:  [0.03076485]
Stock Position:  0.030764853664681173
Bond Position:  [14.28876743]


portfolio before change:  [17.38455692]
curr_Stock_Price:  100.51134612459826
curr_Factors:  [100.51134612]
mat_Sqrt:  [[0.15]]
grads:  [0.07892924]
Stock Position:  0.07892924163153821
Bond Position:  [9.4512726]


portfolio before change:  [17.27527634]
curr_Stock_Price:  99.09686781910501
curr_Factors:  [99.09686782]
mat_Sqrt:  [[0.15]]
grads:  [-0.00969832]
Stock Position:  -0.009698324719306695
Bond Position:  [18.23634994]


portfolio before change:  [17.29339995]
curr_Stock_Price:  97.69828062106848
curr_Factors:  [97.69828062]
mat_Sqrt:  [[0.15]]
grads:  [0.06700389]
Stock Position:  0.06700389103113293
Bond Position:  [10.747235]


portfolio before change:  [17.28713002]
curr_Stock_Price:  97.56460072834889
curr_Factors:  [97.56460073]
mat_Sqrt:  [[0.15]]
grads:  [-0.04029066]
Stock Position:  -0.040290658165970716
Bond Position:  [21.21807199]


portfolio before change:  [17.34835723]
curr_Stock_Price:  96.17663549993878
curr_Factors:  [96.1766355]
mat_Sqrt:  [[0.15]]
grads:  [0.07249797]
Stock Position:  0.07249796903037245
Bond Position:  [10.37574649]


portfolio before change:  [17.3273522]
curr_Stock_Price:  95.85111889215669
curr_Factors:  [95.85111889]
mat_Sqrt:  [[0.15]]
grads:  [0.04266656]
Stock Position:  0.04266655692908493
Bond Position:  [13.23771498]


portfolio before change:  [17.33695442]
curr_Stock_Price:  95.9985969016266
curr_Factors:  [95.9985969]
mat_Sqrt:  [[0.15]]
grads:  [-0.00939022]
Stock Position:  -0.009390223617127696
Bond Position:  [18.23840271]


portfolio before change:  [17.3406342]
curr_Stock_Price:  96.09235306687522
curr_Factors:  [96.09235307]
mat_Sqrt:  [[0.15]]
grads:  [0.05419109]
Stock Position:  0.05419109014521217
Bond Position:  [12.13328483]


portfolio before change:  [17.32742223]
curr_Stock_Price:  95.79256816287455
curr_Factors:  [95.79256816]
mat_Sqrt:  [[0.15]]
grads:  [0.14173763]
Stock Position:  0.1417376258356855
Bond Position:  [3.75001105]


portfolio before change:  [17.43215683]
curr_Stock_Price:  96.52488595090293
curr_Factors:  [96.52488595]
mat_Sqrt:  [[0.15]]
grads:  [0.0490279]
Stock Position:  0.04902790273396399
Bond Position:  [12.69974411]


portfolio before change:  [17.42189478]
curr_Stock_Price:  96.2508096332069
curr_Factors:  [96.25080963]
mat_Sqrt:  [[0.15]]
grads:  [0.00408847]
Stock Position:  0.004088465064044864
Bond Position:  [17.02837671]


portfolio before change:  [17.42333126]
curr_Stock_Price:  95.5607840802964
curr_Factors:  [95.56078408]
mat_Sqrt:  [[0.15]]
grads:  [-0.05810003]
Stock Position:  -0.05810003438838178
Bond Position:  [22.9754161]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.40706536]
Stock Price:  95.93962164659686
PL:  [17.40706536]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.15797790e-03]
 [-9.02555287e-03]
 [-4.29408424e-03]
 [-1.88713143e-02]
 [ 8.50330864e-04]
 [-1.01359492e-02]
 [ 1.27956895e-02]
 [-2.64914536e-02]
 [-7.02074543e-04]
 [ 9.21441716e-03]
 [-3.26386762e-03]
 [-4.54999769e-03]
 [ 4.90020473e-03]
 [ 2.41516868e-04]
 [ 7.12297346e-05]
 [ 2.17107893e-02]
 [ 1.32732350e-03]
 [ 1.22471900e-02]
 [-7.92158698e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.54145409]
curr_Stock_Price:  99.1770040027538
curr_Factors:  [99.177004]
mat_Sqrt:  [[0.15]]
grads:  [0.01438652]
Stock Position:  0.014386519307410205
Bond Position:  [-17.96826597]


portfolio before change:  [-16.54083398]
curr_Stock_Price:  99.53238783747003
curr_Factors:  [99.53238784]
mat_Sqrt:  [[0.15]]
grads:  [-0.06017035]
Stock Position:  -0.06017035248658573
Bond Position:  [-10.55193512]


portfolio before change:  [-16.54998758]
curr_Stock_Price:  99.64066850962926
curr_Factors:  [99.64066851]
mat_Sqrt:  [[0.15]]
grads:  [-0.02862723]
Stock Position:  -0.028627228271226487
Bond Position:  [-13.69755142]


portfolio before change:  [-16.54016188]
curr_Stock_Price:  99.17780423299529
curr_Factors:  [99.17780423]
mat_Sqrt:  [[0.15]]
grads:  [-0.12580876]
Stock Position:  -0.12580876170019129
Bond Position:  [-4.06272514]


portfolio before change:  [-16.43204777]
curr_Stock_Price:  98.31037724013787
curr_Factors:  [98.31037724]
mat_Sqrt:  [[0.15]]
grads:  [0.00566887]
Stock Position:  0.005668872428205736
Bond Position:  [-16.98935675]


portfolio before change:  [-16.42900342]
curr_Stock_Price:  99.596739347579
curr_Factors:  [99.59673935]
mat_Sqrt:  [[0.15]]
grads:  [-0.06757299]
Stock Position:  -0.0675729949587012
Bond Position:  [-9.69895345]


portfolio before change:  [-16.47117563]
curr_Stock_Price:  100.18495027293729
curr_Factors:  [100.18495027]
mat_Sqrt:  [[0.15]]
grads:  [0.0853046]
Stock Position:  0.08530459686757834
Bond Position:  [-25.01741243]


portfolio before change:  [-16.59080159]
curr_Stock_Price:  98.85593832128326
curr_Factors:  [98.85593832]
mat_Sqrt:  [[0.15]]
grads:  [-0.17660969]
Stock Position:  -0.17660969057527276
Bond Position:  [0.86811508]


portfolio before change:  [-16.42727618]
curr_Stock_Price:  97.93125316660068
curr_Factors:  [97.93125317]
mat_Sqrt:  [[0.15]]
grads:  [-0.0046805]
Stock Position:  -0.004680496955669133
Bond Position:  [-15.96890925]


portfolio before change:  [-16.43709926]
curr_Stock_Price:  99.17692248793526
curr_Factors:  [99.17692249]
mat_Sqrt:  [[0.15]]
grads:  [0.06142945]
Stock Position:  0.061429447751531405
Bond Position:  [-22.52948284]


portfolio before change:  [-16.43908573]
curr_Stock_Price:  99.23628487035086
curr_Factors:  [99.23628487]
mat_Sqrt:  [[0.15]]
grads:  [-0.02175912]
Stock Position:  -0.021759117452483823
Bond Position:  [-14.27979176]


portfolio before change:  [-16.45919992]
curr_Stock_Price:  99.9966002130586
curr_Factors:  [99.99660021]
mat_Sqrt:  [[0.15]]
grads:  [-0.03033332]
Stock Position:  -0.03033331794357669
Bond Position:  [-13.42597125]


portfolio before change:  [-16.47680771]
curr_Stock_Price:  100.46640957411074
curr_Factors:  [100.46640957]
mat_Sqrt:  [[0.15]]
grads:  [0.03266803]
Stock Position:  0.03266803150873985
Bond Position:  [-19.75884754]


portfolio before change:  [-16.43973254]
curr_Stock_Price:  101.75254455948502
curr_Factors:  [101.75254456]
mat_Sqrt:  [[0.15]]
grads:  [0.00161011]
Stock Position:  0.001610112455759295
Bond Position:  [-16.60356558]


portfolio before change:  [-16.44227267]
curr_Stock_Price:  102.75327172080674
curr_Factors:  [102.75327172]
mat_Sqrt:  [[0.15]]
grads:  [0.00047486]
Stock Position:  0.00047486489755069194
Bond Position:  [-16.49106659]


portfolio before change:  [-16.44714451]
curr_Stock_Price:  101.17690285623662
curr_Factors:  [101.17690286]
mat_Sqrt:  [[0.15]]
grads:  [0.1447386]
Stock Position:  0.14473859517171428
Bond Position:  [-31.09134729]


portfolio before change:  [-16.37749335]
curr_Stock_Price:  101.71183250815663
curr_Factors:  [101.71183251]
mat_Sqrt:  [[0.15]]
grads:  [0.00884882]
Stock Position:  0.008848823354145732
Bond Position:  [-17.27752339]


portfolio before change:  [-16.37517091]
curr_Stock_Price:  102.4624812811173
curr_Factors:  [102.46248128]
mat_Sqrt:  [[0.15]]
grads:  [0.08164793]
Stock Position:  0.08164793341837132
Bond Position:  [-24.74102076]


portfolio before change:  [-16.39706037]
curr_Stock_Price:  102.27015035233624
curr_Factors:  [102.27015035]
mat_Sqrt:  [[0.15]]
grads:  [-0.05281058]
Stock Position:  -0.05281057985121566
Bond Position:  [-10.99611442]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.42053892]
Stock Price:  102.66266982000077
PL:  [-19.08320874]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.67714879e-03]
 [-7.91396313e-04]
 [-1.15090489e-02]
 [-1.22419878e-02]
 [ 1.00625796e-03]
 [-1.08517864e-02]
 [ 1.24770147e-02]
 [-3.67134953e-02]
 [ 1.04348613e-03]
 [ 1.01250572e-02]
 [-4.37350650e-03]
 [-5.56947695e-03]
 [ 6.47662780e-03]
 [-1.86199030e-04]
 [ 3.38329365e-04]
 [ 2.28900113e-02]
 [ 8.00825280e-03]
 [ 1.50754922e-02]
 [-1.63170657e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.19317876]
curr_Stock_Price:  99.3289216178049
curr_Factors:  [99.32892162]
mat_Sqrt:  [[0.15]]
grads:  [0.01784766]
Stock Position:  0.01784765862774134
Bond Position:  [-14.96596744]


portfolio before change:  [-13.21617716]
curr_Stock_Price:  98.24998772177995
curr_Factors:  [98.24998772]
mat_Sqrt:  [[0.15]]
grads:  [-0.00527598]
Stock Position:  -0.005275975420093501
Bond Position:  [-12.69781264]


portfolio before change:  [-13.21502913]
curr_Stock_Price:  97.4306355670998
curr_Factors:  [97.43063557]
mat_Sqrt:  [[0.15]]
grads:  [-0.07672699]
Stock Position:  -0.07672699268999
Bond Position:  [-5.73946946]


portfolio before change:  [-13.28463908]
curr_Stock_Price:  98.31917429176696
curr_Factors:  [98.31917429]
mat_Sqrt:  [[0.15]]
grads:  [-0.08161325]
Stock Position:  -0.08161325226013137
Bond Position:  [-5.26049151]


portfolio before change:  [-13.28798728]
curr_Stock_Price:  98.34408336354421
curr_Factors:  [98.34408336]
mat_Sqrt:  [[0.15]]
grads:  [0.00670839]
Stock Position:  0.006708386401408758
Bond Position:  [-13.94771739]


portfolio before change:  [-13.29454146]
curr_Stock_Price:  97.88692110458888
curr_Factors:  [97.8869211]
mat_Sqrt:  [[0.15]]
grads:  [-0.07234524]
Stock Position:  -0.07234524246919502
Bond Position:  [-6.21288842]


portfolio before change:  [-13.23032436]
curr_Stock_Price:  96.97780088715736
curr_Factors:  [96.97780089]
mat_Sqrt:  [[0.15]]
grads:  [0.0831801]
Stock Position:  0.08318009817903635
Bond Position:  [-21.29694736]


portfolio before change:  [-13.13741121]
curr_Stock_Price:  98.15882917104328
curr_Factors:  [98.15882917]
mat_Sqrt:  [[0.15]]
grads:  [-0.24475664]
Stock Position:  -0.24475663547908727
Bond Position:  [10.88761356]


portfolio before change:  [-12.85270794]
curr_Stock_Price:  97.00674180200683
curr_Factors:  [97.0067418]
mat_Sqrt:  [[0.15]]
grads:  [0.00695657]
Stock Position:  0.006956574203752965
Bond Position:  [-13.52754254]


portfolio before change:  [-12.85050234]
curr_Stock_Price:  97.80999745018471
curr_Factors:  [97.80999745]
mat_Sqrt:  [[0.15]]
grads:  [0.06750038]
Stock Position:  0.06750038138044236
Bond Position:  [-19.45271447]


portfolio before change:  [-12.80830433]
curr_Stock_Price:  98.50720526986547
curr_Factors:  [98.50720527]
mat_Sqrt:  [[0.15]]
grads:  [-0.02915671]
Stock Position:  -0.02915670999693642
Bond Position:  [-9.93615832]


portfolio before change:  [-12.87661438]
curr_Stock_Price:  100.7648569142715
curr_Factors:  [100.76485691]
mat_Sqrt:  [[0.15]]
grads:  [-0.03712985]
Stock Position:  -0.03712984631470138
Bond Position:  [-9.13523073]


portfolio before change:  [-12.90895812]
curr_Stock_Price:  101.57443868856187
curr_Factors:  [101.57443869]
mat_Sqrt:  [[0.15]]
grads:  [0.04317752]
Stock Position:  0.04317751869010555
Bond Position:  [-17.29469034]


portfolio before change:  [-12.95178074]
curr_Stock_Price:  100.68280788036327
curr_Factors:  [100.68280788]
mat_Sqrt:  [[0.15]]
grads:  [-0.00124133]
Stock Position:  -0.001241326864754522
Bond Position:  [-12.82680046]


portfolio before change:  [-12.956226]
curr_Stock_Price:  101.68025696885631
curr_Factors:  [101.68025697]
mat_Sqrt:  [[0.15]]
grads:  [0.00225553]
Stock Position:  0.002255529098714234
Bond Position:  [-13.18556878]


portfolio before change:  [-12.95579538]
curr_Stock_Price:  103.33282979599754
curr_Factors:  [103.3328298]
mat_Sqrt:  [[0.15]]
grads:  [0.15260008]
Stock Position:  0.15260007558877117
Bond Position:  [-28.72439301]


portfolio before change:  [-12.52993966]
curr_Stock_Price:  106.17055909893045
curr_Factors:  [106.1705591]
mat_Sqrt:  [[0.15]]
grads:  [0.05338835]
Stock Position:  0.05338835200508401
Bond Position:  [-18.19821085]


portfolio before change:  [-12.46175544]
curr_Stock_Price:  107.53292264423142
curr_Factors:  [107.53292264]
mat_Sqrt:  [[0.15]]
grads:  [0.10050328]
Stock Position:  0.1005032812094496
Bond Position:  [-23.26916701]


portfolio before change:  [-12.46795642]
curr_Stock_Price:  107.52911224447625
curr_Factors:  [107.52911224]
mat_Sqrt:  [[0.15]]
grads:  [-0.10878044]
Stock Position:  -0.10878043812525093
Bond Position:  [-0.77089248]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.68604721]
Stock Price:  109.53221178294615
PL:  [-22.21825899]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-7.80066782e-03]
 [ 3.04253249e-02]
 [-2.46276782e-02]
 [ 3.09642217e-03]
 [ 6.42481378e-03]
 [-1.05625328e-02]
 [ 1.37298042e-02]
 [-2.19176984e-02]
 [-2.26519996e-03]
 [ 1.05543524e-02]
 [-4.48267694e-03]
 [-1.30861496e-03]
 [ 4.81478193e-03]
 [-7.92662411e-04]
 [ 7.82698573e-03]
 [ 1.72882497e-02]
 [ 5.91689304e-03]
 [ 4.19822555e-03]
 [-5.45942779e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.82201544]
curr_Stock_Price:  100.41853661814201
curr_Factors:  [100.41853662]
mat_Sqrt:  [[0.15]]
grads:  [-0.05200445]
Stock Position:  -0.05200445211143523
Bond Position:  [16.04422642]


portfolio before change:  [10.74730499]
curr_Stock_Price:  101.93229195774683
curr_Factors:  [101.93229196]
mat_Sqrt:  [[0.15]]
grads:  [0.2028355]
Stock Position:  0.20283549964585784
Bond Position:  [-9.92818238]


portfolio before change:  [10.66749688]
curr_Stock_Price:  101.55106798905423
curr_Factors:  [101.55106799]
mat_Sqrt:  [[0.15]]
grads:  [-0.16418452]
Stock Position:  -0.1641845210514741
Bond Position:  [27.34061034]


portfolio before change:  [10.7919331]
curr_Stock_Price:  100.83479936394453
curr_Factors:  [100.83479936]
mat_Sqrt:  [[0.15]]
grads:  [0.02064281]
Stock Position:  0.020642814477686965
Bond Position:  [8.71041905]


portfolio before change:  [10.7754111]
curr_Stock_Price:  99.92892078407195
curr_Factors:  [99.92892078]
mat_Sqrt:  [[0.15]]
grads:  [0.04283209]
Stock Position:  0.04283209187011421
Bond Position:  [6.49524638]


portfolio before change:  [10.73536422]
curr_Stock_Price:  98.95603137968295
curr_Factors:  [98.95603138]
mat_Sqrt:  [[0.15]]
grads:  [-0.07041689]
Stock Position:  -0.07041688553636306
Bond Position:  [17.70353976]


portfolio before change:  [10.75573626]
curr_Stock_Price:  98.72958578431604
curr_Factors:  [98.72958578]
mat_Sqrt:  [[0.15]]
grads:  [0.09153203]
Stock Position:  0.09153202810724066
Bond Position:  [1.71881703]


portfolio before change:  [10.79532328]
curr_Stock_Price:  99.15738429568309
curr_Factors:  [99.1573843]
mat_Sqrt:  [[0.15]]
grads:  [-0.14611799]
Stock Position:  -0.14611798917867427
Bond Position:  [25.28400088]


portfolio before change:  [10.86022818]
curr_Stock_Price:  98.75645412150044
curr_Factors:  [98.75645412]
mat_Sqrt:  [[0.15]]
grads:  [-0.01510133]
Stock Position:  -0.015101333088595978
Bond Position:  [12.35158229]


portfolio before change:  [10.86788426]
curr_Stock_Price:  98.45397777137066
curr_Factors:  [98.45397777]
mat_Sqrt:  [[0.15]]
grads:  [0.07036235]
Stock Position:  0.07036234960083904
Bond Position:  [3.94043105]


portfolio before change:  [10.86730676]
curr_Stock_Price:  98.43176800730001
curr_Factors:  [98.43176801]
mat_Sqrt:  [[0.15]]
grads:  [-0.02988451]
Stock Position:  -0.02988451295247601
Bond Position:  [13.8088922]


portfolio before change:  [10.86019588]
curr_Stock_Price:  98.78524659047883
curr_Factors:  [98.78524659]
mat_Sqrt:  [[0.15]]
grads:  [-0.0087241]
Stock Position:  -0.008724099746104524
Bond Position:  [11.72200822]


portfolio before change:  [10.85455471]
curr_Stock_Price:  99.7678165655446
curr_Factors:  [99.76781657]
mat_Sqrt:  [[0.15]]
grads:  [0.03209855]
Stock Position:  0.032098546211387295
Bond Position:  [7.65215284]


portfolio before change:  [10.82792868]
curr_Stock_Price:  98.87870141725597
curr_Factors:  [98.87870142]
mat_Sqrt:  [[0.15]]
grads:  [-0.00528442]
Stock Position:  -0.005284416070140166
Bond Position:  [11.35044488]


portfolio before change:  [10.83278688]
curr_Stock_Price:  98.49640102668546
curr_Factors:  [98.49640103]
mat_Sqrt:  [[0.15]]
grads:  [0.0521799]
Stock Position:  0.052179904896183724
Bond Position:  [5.69325404]


portfolio before change:  [10.83759997]
curr_Stock_Price:  98.56136078639526
curr_Factors:  [98.56136079]
mat_Sqrt:  [[0.15]]
grads:  [0.115255]
Stock Position:  0.11525499785294817
Bond Position:  [-0.52208946]


portfolio before change:  [10.82709087]
curr_Stock_Price:  98.47131209465557
curr_Factors:  [98.47131209]
mat_Sqrt:  [[0.15]]
grads:  [0.03944595]
Stock Position:  0.03944595359265053
Bond Position:  [6.94279606]


portfolio before change:  [10.81623369]
curr_Stock_Price:  98.15206292732772
curr_Factors:  [98.15206293]
mat_Sqrt:  [[0.15]]
grads:  [0.02798817]
Stock Position:  0.02798817036296712
Bond Position:  [8.06913704]


portfolio before change:  [10.87196217]
curr_Stock_Price:  100.07112167325899
curr_Factors:  [100.07112167]
mat_Sqrt:  [[0.15]]
grads:  [-0.03639619]
Stock Position:  -0.03639618526424885
Bond Position:  [14.51416926]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.82290691]
Stock Price:  101.51864304284153
PL:  [9.30426387]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.78157608e-03]
 [-7.85737153e-04]
 [-2.08935569e-02]
 [ 2.26433345e-02]
 [-6.85959693e-03]
 [-1.15022898e-02]
 [ 1.24584363e-02]
 [-4.17300408e-02]
 [ 2.26958258e-04]
 [ 7.14177901e-03]
 [-1.02842846e-02]
 [ 5.14291915e-03]
 [ 5.99532722e-03]
 [-8.79233786e-04]
 [ 7.90332725e-03]
 [ 2.00869711e-02]
 [ 6.72574354e-03]
 [ 5.23312531e-04]
 [-5.49476690e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.28579111]
curr_Stock_Price:  99.64232292246203
curr_Factors:  [99.64232292]
mat_Sqrt:  [[0.15]]
grads:  [0.01854384]
Stock Position:  0.018543840519538633
Bond Position:  [-8.13354245]


portfolio before change:  [-6.31672926]
curr_Stock_Price:  98.08361040843496
curr_Factors:  [98.08361041]
mat_Sqrt:  [[0.15]]
grads:  [-0.00523825]
Stock Position:  -0.0052382476885254724
Bond Position:  [-5.80294302]


portfolio before change:  [-6.30027059]
curr_Stock_Price:  94.66460695496772
curr_Factors:  [94.66460695]
mat_Sqrt:  [[0.15]]
grads:  [-0.13929038]
Stock Position:  -0.1392903791800995
Bond Position:  [6.8855984]


portfolio before change:  [-6.44603669]
curr_Stock_Price:  95.72345759482357
curr_Factors:  [95.72345759]
mat_Sqrt:  [[0.15]]
grads:  [0.15095556]
Stock Position:  0.15095556311534603
Bond Position:  [-20.89602513]


portfolio before change:  [-6.36833548]
curr_Stock_Price:  96.27279720203514
curr_Factors:  [96.2727972]
mat_Sqrt:  [[0.15]]
grads:  [-0.04573065]
Stock Position:  -0.04573064617058653
Bond Position:  [-1.96571825]


portfolio before change:  [-6.35566902]
curr_Stock_Price:  95.98507014867474
curr_Factors:  [95.98507015]
mat_Sqrt:  [[0.15]]
grads:  [-0.07668193]
Stock Position:  -0.07668193203015504
Bond Position:  [1.0046516]


portfolio before change:  [-6.43387765]
curr_Stock_Price:  97.00825534161032
curr_Factors:  [97.00825534]
mat_Sqrt:  [[0.15]]
grads:  [0.08305624]
Stock Position:  0.08305624170366487
Bond Position:  [-14.49101875]


portfolio before change:  [-6.46474028]
curr_Stock_Price:  96.68029175165489
curr_Factors:  [96.68029175]
mat_Sqrt:  [[0.15]]
grads:  [-0.27820027]
Stock Position:  -0.27820027175172324
Bond Position:  [20.43174316]


portfolio before change:  [-6.67191792]
curr_Stock_Price:  97.44336151134542
curr_Factors:  [97.44336151]
mat_Sqrt:  [[0.15]]
grads:  [0.00151306]
Stock Position:  0.001513055056381263
Bond Position:  [-6.81935509]


portfolio before change:  [-6.67618828]
curr_Stock_Price:  95.7479117689883
curr_Factors:  [95.74791177]
mat_Sqrt:  [[0.15]]
grads:  [0.04761186]
Stock Position:  0.04761186009936305
Bond Position:  [-11.23492446]


portfolio before change:  [-6.6726884]
curr_Stock_Price:  95.88041990226759
curr_Factors:  [95.8804199]
mat_Sqrt:  [[0.15]]
grads:  [-0.0685619]
Stock Position:  -0.06856189749022923
Bond Position:  [-0.09894488]


portfolio before change:  [-6.76795833]
curr_Stock_Price:  97.26960539351475
curr_Factors:  [97.26960539]
mat_Sqrt:  [[0.15]]
grads:  [0.03428613]
Stock Position:  0.03428612766893284
Bond Position:  [-10.10295644]


portfolio before change:  [-6.78552308]
curr_Stock_Price:  96.830982329182
curr_Factors:  [96.83098233]
mat_Sqrt:  [[0.15]]
grads:  [0.03996885]
Stock Position:  0.0399688481229671
Bond Position:  [-10.6557459]


portfolio before change:  [-6.71917219]
curr_Stock_Price:  98.55770601009507
curr_Factors:  [98.55770601]
mat_Sqrt:  [[0.15]]
grads:  [-0.00586156]
Stock Position:  -0.005861558570477887
Bond Position:  [-6.14147042]


portfolio before change:  [-6.71914027]
curr_Stock_Price:  98.29028910502136
curr_Factors:  [98.29028911]
mat_Sqrt:  [[0.15]]
grads:  [0.05268885]
Stock Position:  0.052688848328511784
Bond Position:  [-11.8979424]


portfolio before change:  [-6.80531228]
curr_Stock_Price:  96.71126130598684
curr_Factors:  [96.71126131]
mat_Sqrt:  [[0.15]]
grads:  [0.13391314]
Stock Position:  0.1339131403368994
Bond Position:  [-19.75622099]


portfolio before change:  [-6.71881062]
curr_Stock_Price:  97.39410193978956
curr_Factors:  [97.39410194]
mat_Sqrt:  [[0.15]]
grads:  [0.04483829]
Stock Position:  0.044838290245141924
Bond Position:  [-11.08579563]


portfolio before change:  [-6.8001337]
curr_Stock_Price:  95.64222236119858
curr_Factors:  [95.64222236]
mat_Sqrt:  [[0.15]]
grads:  [0.00348875]
Stock Position:  0.003488750205517278
Bond Position:  [-7.13380552]


portfolio before change:  [-6.79650543]
curr_Stock_Price:  97.19347873808684
curr_Factors:  [97.19347874]
mat_Sqrt:  [[0.15]]
grads:  [-0.03663178]
Stock Position:  -0.03663177931915576
Bond Position:  [-3.23613537]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.83125395]
Stock Price:  98.11997988719052
PL:  [-6.83125395]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-4.09236701e-03]
 [ 2.52023937e-02]
 [-4.27989441e-02]
 [ 5.46269557e-02]
 [ 5.65832514e-03]
 [-1.54315983e-02]
 [-3.40924419e-03]
 [-8.34518898e-03]
 [ 1.29511646e-02]
 [-1.68899585e-03]
 [-3.47455651e-03]
 [ 1.27000904e-02]
 [ 1.03002786e-02]
 [-1.05851307e-03]
 [ 8.20420797e-03]
 [ 2.24848315e-02]
 [ 8.82851989e-03]
 [ 1.50886752e-02]
 [-1.65063040e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.81442034]
curr_Stock_Price:  100.2820763123022
curr_Factors:  [100.28207631]
mat_Sqrt:  [[0.15]]
grads:  [-0.02728245]
Stock Position:  -0.02728244675078651
Bond Position:  [10.55036074]


portfolio before change:  [7.77928196]
curr_Stock_Price:  101.66671372774744
curr_Factors:  [101.66671373]
mat_Sqrt:  [[0.15]]
grads:  [0.16801596]
Stock Position:  0.16801595824031415
Bond Position:  [-9.30234837]


portfolio before change:  [7.9541229]
curr_Stock_Price:  102.72117798125089
curr_Factors:  [102.72117798]
mat_Sqrt:  [[0.15]]
grads:  [-0.28532629]
Stock Position:  -0.2853262938540982
Bond Position:  [37.26317592]


portfolio before change:  [7.85156497]
curr_Stock_Price:  103.11327256878971
curr_Factors:  [103.11327257]
mat_Sqrt:  [[0.15]]
grads:  [0.3641797]
Stock Position:  0.36417970496352225
Bond Position:  [-29.70019622]


portfolio before change:  [7.76831539]
curr_Stock_Price:  102.90506877997692
curr_Factors:  [102.90506878]
mat_Sqrt:  [[0.15]]
grads:  [0.03772217]
Stock Position:  0.03772216762739968
Bond Position:  [3.88651314]


portfolio before change:  [7.81162652]
curr_Stock_Price:  104.02746907251509
curr_Factors:  [104.02746907]
mat_Sqrt:  [[0.15]]
grads:  [-0.10287732]
Stock Position:  -0.10287732216051902
Bond Position:  [18.51369397]


portfolio before change:  [7.9103037]
curr_Stock_Price:  103.11329110275425
curr_Factors:  [103.1132911]
mat_Sqrt:  [[0.15]]
grads:  [-0.02272829]
Stock Position:  -0.022728294618699175
Bond Position:  [10.25389296]


portfolio before change:  [7.83520687]
curr_Stock_Price:  106.53020498747662
curr_Factors:  [106.53020499]
mat_Sqrt:  [[0.15]]
grads:  [-0.05563459]
Stock Position:  -0.05563459322868672
Bond Position:  [13.76197149]


portfolio before change:  [7.93741199]
curr_Stock_Price:  104.75497504919167
curr_Factors:  [104.75497505]
mat_Sqrt:  [[0.15]]
grads:  [0.0863411]
Stock Position:  0.0863410976480309
Bond Position:  [-1.10724754]


portfolio before change:  [8.01379571]
curr_Stock_Price:  105.64285544029187
curr_Factors:  [105.64285544]
mat_Sqrt:  [[0.15]]
grads:  [-0.01125997]
Stock Position:  -0.01125997233178775
Bond Position:  [9.20333134]


portfolio before change:  [8.02604641]
curr_Stock_Price:  104.75923151835055
curr_Factors:  [104.75923152]
mat_Sqrt:  [[0.15]]
grads:  [-0.02316371]
Stock Position:  -0.0231637100404667
Bond Position:  [10.45265887]


portfolio before change:  [8.01100573]
curr_Stock_Price:  105.52137938430006
curr_Factors:  [105.52137938]
mat_Sqrt:  [[0.15]]
grads:  [0.08466727]
Stock Position:  0.0846672695331586
Bond Position:  [-0.92320134]


portfolio before change:  [7.89932069]
curr_Stock_Price:  104.20500050609805
curr_Factors:  [104.20500051]
mat_Sqrt:  [[0.15]]
grads:  [0.06866852]
Stock Position:  0.06866852391469093
Bond Position:  [0.74371712]


portfolio before change:  [7.88695939]
curr_Stock_Price:  104.02227839654196
curr_Factors:  [104.0222784]
mat_Sqrt:  [[0.15]]
grads:  [-0.00705675]
Stock Position:  -0.007056753830075196
Bond Position:  [8.621019]


portfolio before change:  [7.88506857]
curr_Stock_Price:  104.59567897688244
curr_Factors:  [104.59567898]
mat_Sqrt:  [[0.15]]
grads:  [0.05469472]
Stock Position:  0.054694719815058176
Bond Position:  [2.16423721]


portfolio before change:  [7.84437237]
curr_Stock_Price:  103.84172454079818
curr_Factors:  [103.84172454]
mat_Sqrt:  [[0.15]]
grads:  [0.14989888]
Stock Position:  0.1498988765076761
Bond Position:  [-7.72138548]


portfolio before change:  [8.26522777]
curr_Stock_Price:  106.66219924385032
curr_Factors:  [106.66219924]
mat_Sqrt:  [[0.15]]
grads:  [0.0588568]
Stock Position:  0.05885679923342726
Bond Position:  [1.98743212]


portfolio before change:  [8.31862285]
curr_Stock_Price:  107.56095971970004
curr_Factors:  [107.56095972]
mat_Sqrt:  [[0.15]]
grads:  [0.10059117]
Stock Position:  0.10059116808316049
Bond Position:  [-2.50105973]


portfolio before change:  [8.38495197]
curr_Stock_Price:  108.22656941734087
curr_Factors:  [108.22656942]
mat_Sqrt:  [[0.15]]
grads:  [-0.11004203]
Stock Position:  -0.1100420264207862
Bond Position:  [20.29442298]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.3734208]
Stock Price:  108.3774699769844
PL:  [-0.00404917]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.30596078e-04]
 [-8.05403557e-03]
 [-7.17552944e-03]
 [ 6.93171571e-04]
 [-1.31095109e-03]
 [-1.14925211e-02]
 [ 1.34033418e-02]
 [-3.94846892e-02]
 [ 2.66976037e-03]
 [ 9.97579631e-03]
 [-9.70565712e-03]
 [ 7.98860816e-03]
 [ 6.27625980e-03]
 [-1.72009868e-03]
 [ 6.74688008e-03]
 [ 2.25811130e-02]
 [ 1.13556351e-02]
 [ 1.22432847e-04]
 [-1.07618106e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-25.82092712]
curr_Stock_Price:  98.75597667608311
curr_Factors:  [98.75597668]
mat_Sqrt:  [[0.15]]
grads:  [0.00153731]
Stock Position:  0.0015373071866835986
Bond Position:  [-25.9727454]


portfolio before change:  [-25.82638226]
curr_Stock_Price:  99.43174566884237
curr_Factors:  [99.43174567]
mat_Sqrt:  [[0.15]]
grads:  [-0.05369357]
Stock Position:  -0.053693570494926735
Bond Position:  [-20.48753681]


portfolio before change:  [-25.780805]
curr_Stock_Price:  98.48750262138944
curr_Factors:  [98.48750262]
mat_Sqrt:  [[0.15]]
grads:  [-0.04783686]
Stock Position:  -0.047836862962839385
Bond Position:  [-21.06947183]


portfolio before change:  [-25.73640832]
curr_Stock_Price:  97.44929273953527
curr_Factors:  [97.44929274]
mat_Sqrt:  [[0.15]]
grads:  [0.00462114]
Stock Position:  0.004621143806241724
Bond Position:  [-26.18673552]


portfolio before change:  [-25.74124539]
curr_Stock_Price:  97.81942642831198
curr_Factors:  [97.81942643]
mat_Sqrt:  [[0.15]]
grads:  [-0.00873967]
Stock Position:  -0.008739673911638199
Bond Position:  [-24.8863355]


portfolio before change:  [-25.73167887]
curr_Stock_Price:  96.01285123197542
curr_Factors:  [96.01285123]
mat_Sqrt:  [[0.15]]
grads:  [-0.07661681]
Stock Position:  -0.07661680755328937
Bond Position:  [-18.37548072]


portfolio before change:  [-25.69386462]
curr_Stock_Price:  95.45933437784905
curr_Factors:  [95.45933438]
mat_Sqrt:  [[0.15]]
grads:  [0.08935561]
Stock Position:  0.08935561217823736
Bond Position:  [-34.22369188]


portfolio before change:  [-25.63475933]
curr_Stock_Price:  96.2165591830734
curr_Factors:  [96.21655918]
mat_Sqrt:  [[0.15]]
grads:  [-0.26323126]
Stock Position:  -0.2632312615203296
Bond Position:  [-0.30755307]


portfolio before change:  [-25.61392762]
curr_Stock_Price:  96.13712864067203
curr_Factors:  [96.13712864]
mat_Sqrt:  [[0.15]]
grads:  [0.0177984]
Stock Position:  0.017798402443030582
Bond Position:  [-27.32501493]


portfolio before change:  [-25.59497048]
curr_Stock_Price:  97.58609308314688
curr_Factors:  [97.58609308]
mat_Sqrt:  [[0.15]]
grads:  [0.06650531]
Stock Position:  0.06650530876441882
Bond Position:  [-32.08496373]


portfolio before change:  [-25.70150801]
curr_Stock_Price:  96.10477845717084
curr_Factors:  [96.10477846]
mat_Sqrt:  [[0.15]]
grads:  [-0.06470438]
Stock Position:  -0.06470438080864367
Bond Position:  [-19.48310782]


portfolio before change:  [-25.74593554]
curr_Stock_Price:  96.71611490170163
curr_Factors:  [96.7161149]
mat_Sqrt:  [[0.15]]
grads:  [0.05325739]
Stock Position:  0.0532573877304667
Bond Position:  [-30.89678317]


portfolio before change:  [-25.78676432]
curr_Stock_Price:  96.09453696036569
curr_Factors:  [96.09453696]
mat_Sqrt:  [[0.15]]
grads:  [0.04184173]
Stock Position:  0.04184173202528966
Bond Position:  [-29.80752618]


portfolio before change:  [-25.8548083]
curr_Stock_Price:  94.64643333226677
curr_Factors:  [94.64643333]
mat_Sqrt:  [[0.15]]
grads:  [-0.01146732]
Stock Position:  -0.011467324544887412
Bond Position:  [-24.76946693]


portfolio before change:  [-25.84718689]
curr_Stock_Price:  93.44174547713514
curr_Factors:  [93.44174548]
mat_Sqrt:  [[0.15]]
grads:  [0.0449792]
Stock Position:  0.044979200530389674
Bond Position:  [-30.0501219]


portfolio before change:  [-25.86754472]
curr_Stock_Price:  93.1561831451375
curr_Factors:  [93.15618315]
mat_Sqrt:  [[0.15]]
grads:  [0.15054075]
Stock Position:  0.15054075358569527
Bond Position:  [-39.89134674]


portfolio before change:  [-25.71876525]
curr_Stock_Price:  94.2107384890348
curr_Factors:  [94.21073849]
mat_Sqrt:  [[0.15]]
grads:  [0.07570423]
Stock Position:  0.07570423382824452
Bond Position:  [-32.85091703]


portfolio before change:  [-25.82392478]
curr_Stock_Price:  92.9301526728271
curr_Factors:  [92.93015267]
mat_Sqrt:  [[0.15]]
grads:  [0.00081622]
Stock Position:  0.0008162189773975569
Bond Position:  [-25.89977613]


portfolio before change:  [-25.83107575]
curr_Stock_Price:  92.1029025393158
curr_Factors:  [92.10290254]
mat_Sqrt:  [[0.15]]
grads:  [-0.0717454]
Stock Position:  -0.07174540406603504
Bond Position:  [-19.22311579]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-25.79307352]
Stock Price:  91.50622872385664
PL:  [-25.79307352]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [ 2.31078120e-03]
 [-1.05490060e-02]
 [-6.79303667e-03]
 [-1.06390243e-02]
 [ 5.71342063e-03]
 [-9.82909075e-03]
 [ 1.47226569e-02]
 [ 1.50343573e-02]
 [-1.55951472e-02]
 [ 2.36770869e-03]
 [-2.91555082e-03]
 [-4.37937171e-03]
 [ 4.91708658e-03]
 [-4.69904183e-04]
 [ 7.76652879e-03]
 [ 1.68207945e-02]
 [ 6.50856516e-03]
 [ 6.08610816e-03]
 [-4.27261291e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.68244114]
curr_Stock_Price:  99.85118565900606
curr_Factors:  [99.85118566]
mat_Sqrt:  [[0.15]]
grads:  [0.01540521]
Stock Position:  0.015405208016505793
Bond Position:  [-3.22066942]


portfolio before change:  [-1.68193917]
curr_Stock_Price:  99.93604262315121
curr_Factors:  [99.93604262]
mat_Sqrt:  [[0.15]]
grads:  [-0.07032671]
Stock Position:  -0.07032670672961792
Bond Position:  [5.34623359]


portfolio before change:  [-1.592573]
curr_Stock_Price:  98.68432128379891
curr_Factors:  [98.68432128]
mat_Sqrt:  [[0.15]]
grads:  [-0.04528691]
Stock Position:  -0.045286911117059334
Bond Position:  [2.87653508]


portfolio before change:  [-1.66430041]
curr_Stock_Price:  100.28404698607523
curr_Factors:  [100.28404699]
mat_Sqrt:  [[0.15]]
grads:  [-0.07092683]
Stock Position:  -0.07092682892689811
Bond Position:  [5.44852903]


portfolio before change:  [-1.77951972]
curr_Stock_Price:  101.92773545565579
curr_Factors:  [101.92773546]
mat_Sqrt:  [[0.15]]
grads:  [0.03808947]
Stock Position:  0.03808947085082126
Bond Position:  [-5.66189323]


portfolio before change:  [-1.8396742]
curr_Stock_Price:  100.3856076856704
curr_Factors:  [100.38560769]
mat_Sqrt:  [[0.15]]
grads:  [-0.06552727]
Stock Position:  -0.065527271659207
Bond Position:  [4.73832078]


portfolio before change:  [-1.79633977]
curr_Stock_Price:  99.74236862394713
curr_Factors:  [99.74236862]
mat_Sqrt:  [[0.15]]
grads:  [0.09815105]
Stock Position:  0.09815104593229045
Bond Position:  [-11.58615758]


portfolio before change:  [-1.68065989]
curr_Stock_Price:  100.95047378843837
curr_Factors:  [100.95047379]
mat_Sqrt:  [[0.15]]
grads:  [0.10022905]
Stock Position:  0.10022904879130322
Bond Position:  [-11.79882985]


portfolio before change:  [-1.70561443]
curr_Stock_Price:  100.73093205117823
curr_Factors:  [100.73093205]
mat_Sqrt:  [[0.15]]
grads:  [-0.10396765]
Stock Position:  -0.1039676476929626
Bond Position:  [8.76714363]


portfolio before change:  [-1.77254736]
curr_Stock_Price:  101.3958023095967
curr_Factors:  [101.39580231]
mat_Sqrt:  [[0.15]]
grads:  [0.01578472]
Stock Position:  0.015784724624741692
Bond Position:  [-3.37305218]


portfolio before change:  [-1.78875793]
curr_Stock_Price:  100.42225376129053
curr_Factors:  [100.42225376]
mat_Sqrt:  [[0.15]]
grads:  [-0.01943701]
Stock Position:  -0.019437005491603064
Bond Position:  [0.16314997]


portfolio before change:  [-1.77461024]
curr_Stock_Price:  99.69647856077658
curr_Factors:  [99.69647856]
mat_Sqrt:  [[0.15]]
grads:  [-0.02919581]
Stock Position:  -0.029195811390488477
Bond Position:  [1.13610935]


portfolio before change:  [-1.79878987]
curr_Stock_Price:  100.53439645534574
curr_Factors:  [100.53439646]
mat_Sqrt:  [[0.15]]
grads:  [0.03278058]
Stock Position:  0.03278057716905459
Bond Position:  [-5.09436541]


portfolio before change:  [-1.81510825]
curr_Stock_Price:  100.07544697629098
curr_Factors:  [100.07544698]
mat_Sqrt:  [[0.15]]
grads:  [-0.00313269]
Stock Position:  -0.003132694553877657
Bond Position:  [-1.50160244]


portfolio before change:  [-1.81100793]
curr_Stock_Price:  98.64672003747671
curr_Factors:  [98.64672004]
mat_Sqrt:  [[0.15]]
grads:  [0.05177686]
Stock Position:  0.051776858588941606
Bond Position:  [-6.9186252]


portfolio before change:  [-1.762189]
curr_Stock_Price:  99.62300187303805
curr_Factors:  [99.62300187]
mat_Sqrt:  [[0.15]]
grads:  [0.11213863]
Stock Position:  0.11213862974457446
Bond Position:  [-12.93377592]


portfolio before change:  [-1.98168379]
curr_Stock_Price:  97.69448757982697
curr_Factors:  [97.69448758]
mat_Sqrt:  [[0.15]]
grads:  [0.04339043]
Stock Position:  0.04339043442443215
Bond Position:  [-6.22069005]


portfolio before change:  [-1.93117281]
curr_Stock_Price:  98.89443749831261
curr_Factors:  [98.8944375]
mat_Sqrt:  [[0.15]]
grads:  [0.04057405]
Stock Position:  0.04057405438744802
Bond Position:  [-5.9437211]


portfolio before change:  [-1.93527806]
curr_Stock_Price:  98.8298855313892
curr_Factors:  [98.82988553]
mat_Sqrt:  [[0.15]]
grads:  [-0.02848409]
Stock Position:  -0.028484086041875856
Bond Position:  [0.8798009]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.93534723]
Stock Price:  98.84003662063127
PL:  [-1.93534723]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 3.30601096e+00]
 [-8.12675385e-03]
 [ 9.71778725e-03]
 [-3.48302208e-02]
 [ 6.37567329e-02]
 [ 4.67634384e-03]
 [-1.70561401e-02]
 [-1.26080392e-02]
 [-8.58907662e-03]
 [ 2.40675838e-02]
 [-5.41602925e-04]
 [-3.56529015e-03]
 [ 1.77712208e-02]
 [ 1.36506158e-02]
 [-4.04121957e-03]
 [ 2.03287190e-02]
 [ 1.98864538e-02]
 [ 1.15637588e-02]
 [ 1.59314263e-02]
 [-1.72794118e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30601096]
mat_Sqrt:  [[0.15]]
grads:  [22.04007305]
init_Out:  [2.14797145]
Stock Position:  22.040073047374506
Bond position:  [-2201.85933328]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.12821238]
curr_Stock_Price:  100.43242935502501
curr_Factors:  [100.43242936]
mat_Sqrt:  [[0.15]]
grads:  [-0.05417836]
Stock Position:  -0.05417835902130378
Bond Position:  [16.5694766]


portfolio before change:  [11.10480834]
curr_Stock_Price:  100.94087817879263
curr_Factors:  [100.94087818]
mat_Sqrt:  [[0.15]]
grads:  [0.06478525]
Stock Position:  0.06478524830650609
Bond Position:  [4.56532849]


portfolio before change:  [11.18720134]
curr_Stock_Price:  102.19504516292973
curr_Factors:  [102.19504516]
mat_Sqrt:  [[0.15]]
grads:  [-0.23220147]
Stock Position:  -0.23220147185250978
Bond Position:  [34.91704124]


portfolio before change:  [10.86043599]
curr_Stock_Price:  103.63989261427977
curr_Factors:  [103.63989261]
mat_Sqrt:  [[0.15]]
grads:  [0.42504489]
Stock Position:  0.42504488580614225
Bond Position:  [-33.19117034]


portfolio before change:  [11.41520609]
curr_Stock_Price:  104.96462078531181
curr_Factors:  [104.96462079]
mat_Sqrt:  [[0.15]]
grads:  [0.03117563]
Stock Position:  0.031175625577042565
Bond Position:  [8.14286837]


portfolio before change:  [11.40795477]
curr_Stock_Price:  104.66671846569396
curr_Factors:  [104.66671847]
mat_Sqrt:  [[0.15]]
grads:  [-0.1137076]
Stock Position:  -0.11370760080147611
Bond Position:  [23.30935621]


portfolio before change:  [11.29369752]
curr_Stock_Price:  105.72280719664163
curr_Factors:  [105.7228072]
mat_Sqrt:  [[0.15]]
grads:  [-0.08405359]
Stock Position:  -0.08405359440002978
Bond Position:  [20.18007948]


portfolio before change:  [11.22057665]
curr_Stock_Price:  106.65276772270256
curr_Factors:  [106.65276772]
mat_Sqrt:  [[0.15]]
grads:  [-0.05726051]
Stock Position:  -0.05726051076725358
Bond Position:  [17.3275686]


portfolio before change:  [11.2776994]
curr_Stock_Price:  105.7308352866077
curr_Factors:  [105.73083529]
mat_Sqrt:  [[0.15]]
grads:  [0.16045056]
Stock Position:  0.16045055871189162
Bond Position:  [-5.68687219]


portfolio before change:  [11.13042542]
curr_Stock_Price:  104.82181953124845
curr_Factors:  [104.82181953]
mat_Sqrt:  [[0.15]]
grads:  [-0.00361069]
Stock Position:  -0.003610686165885074
Bond Position:  [11.50890412]


portfolio before change:  [11.13153291]
curr_Stock_Price:  105.31205822810296
curr_Factors:  [105.31205823]
mat_Sqrt:  [[0.15]]
grads:  [-0.0237686]
Stock Position:  -0.023768600976929573
Bond Position:  [13.6346532]


portfolio before change:  [11.11068979]
curr_Stock_Price:  106.33240453474933
curr_Factors:  [106.33240453]
mat_Sqrt:  [[0.15]]
grads:  [0.11847481]
Stock Position:  0.11847480501159371
Bond Position:  [-1.4870211]


portfolio before change:  [11.13032156]
curr_Stock_Price:  106.50124688888835
curr_Factors:  [106.50124689]
mat_Sqrt:  [[0.15]]
grads:  [0.09100411]
Stock Position:  0.09100410558598732
Bond Position:  [1.43827084]


portfolio before change:  [11.12532903]
curr_Stock_Price:  106.44243481711102
curr_Factors:  [106.44243482]
mat_Sqrt:  [[0.15]]
grads:  [-0.02694146]
Stock Position:  -0.02694146378383239
Bond Position:  [13.99304403]


portfolio before change:  [11.10275497]
curr_Stock_Price:  107.41019072325174
curr_Factors:  [107.41019072]
mat_Sqrt:  [[0.15]]
grads:  [0.13552479]
Stock Position:  0.13552479343433427
Bond Position:  [-3.45398894]


portfolio before change:  [11.06055963]
curr_Stock_Price:  107.10521528952393
curr_Factors:  [107.10521529]
mat_Sqrt:  [[0.15]]
grads:  [0.13257636]
Stock Position:  0.13257635883248567
Bond Position:  [-3.13905982]


portfolio before change:  [11.2424082]
curr_Stock_Price:  108.48278695766818
curr_Factors:  [108.48278696]
mat_Sqrt:  [[0.15]]
grads:  [0.07709173]
Stock Position:  0.07709172559245417
Bond Position:  [2.87928296]


portfolio before change:  [11.31023628]
curr_Stock_Price:  109.35328462846394
curr_Factors:  [109.35328463]
mat_Sqrt:  [[0.15]]
grads:  [0.10620951]
Stock Position:  0.10620950845114335
Bond Position:  [-0.30412233]


portfolio before change:  [11.25970925]
curr_Stock_Price:  108.87827071247806
curr_Factors:  [108.87827071]
mat_Sqrt:  [[0.15]]
grads:  [-0.11519608]
Stock Position:  -0.1151960788165645
Bond Position:  [23.8020591]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.3636429]
Stock Price:  108.02770011572072
PL:  [3.33594279]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  1.1106008848171889
FINAL STD P&L:  22.799513057295687
