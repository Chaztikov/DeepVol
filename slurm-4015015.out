WARNING:tensorflow:From main.py:52: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:52: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:53: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:53: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-11-22 23:35:56.572867: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-11-22 23:35:56.599678: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-11-22 23:35:56.600249: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-11-22 23:35:56.602062: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-11-22 23:35:56.603681: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-11-22 23:35:56.604599: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-11-22 23:35:56.606641: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-11-22 23:35:56.608190: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-11-22 23:35:56.612551: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-11-22 23:35:56.615381: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-11-22 23:35:56.615751: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-11-22 23:35:56.622289: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2400240000 Hz
2019-11-22 23:35:56.622474: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c60d68fa20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-11-22 23:35:56.622492: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-11-22 23:35:56.623953: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-11-22 23:35:56.623976: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-11-22 23:35:56.623988: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-11-22 23:35:56.623998: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-11-22 23:35:56.624009: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-11-22 23:35:56.624019: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-11-22 23:35:56.624029: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-11-22 23:35:56.624039: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-11-22 23:35:56.626766: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-11-22 23:35:56.626796: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-11-22 23:35:56.726451: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-11-22 23:35:56.726483: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-11-22 23:35:56.726493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-11-22 23:35:56.730655: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2019-11-22 23:35:56.732664: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c60de1b520 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-11-22 23:35:56.732679: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
INFO   Begin to solve PricingOptionOneFactor with run 1
INFO   Y0_true: 4.0000e-02
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:279: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:279: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:285: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:285: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:455: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:455: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:457: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:457: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:460: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:460: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:462: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:462: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:298: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:298: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:305: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:305: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:308: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:308: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:310: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:310: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-11-22 23:36:13.248857: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 1.1524e+03,   Y0: 6.9212e+00,  elapsed time  16
INFO   step:     1,    loss: 2.7856e+02,   Y0: 6.9262e+00,  elapsed time  23
INFO   step:     2,    loss: 2.7855e+02,   Y0: 6.9306e+00,  elapsed time  24
INFO   step:     3,    loss: 2.7851e+02,   Y0: 6.9353e+00,  elapsed time  25
INFO   step:     4,    loss: 2.7848e+02,   Y0: 6.9365e+00,  elapsed time  26
INFO   step:     5,    loss: 2.7846e+02,   Y0: 6.9392e+00,  elapsed time  28
INFO   step:     6,    loss: 2.7845e+02,   Y0: 6.9413e+00,  elapsed time  29
INFO   step:     7,    loss: 2.7844e+02,   Y0: 6.9422e+00,  elapsed time  30
INFO   step:     8,    loss: 2.7841e+02,   Y0: 6.9433e+00,  elapsed time  31
INFO   step:     9,    loss: 2.7839e+02,   Y0: 6.9450e+00,  elapsed time  32
INFO   step:    10,    loss: 2.7836e+02,   Y0: 6.9465e+00,  elapsed time  33
INFO   step:    11,    loss: 2.7833e+02,   Y0: 6.9488e+00,  elapsed time  34
INFO   step:    12,    loss: 2.7830e+02,   Y0: 6.9499e+00,  elapsed time  36
INFO   step:    13,    loss: 2.7827e+02,   Y0: 6.9510e+00,  elapsed time  37
INFO   step:    14,    loss: 2.7824e+02,   Y0: 6.9513e+00,  elapsed time  38
INFO   step:    15,    loss: 2.7821e+02,   Y0: 6.9508e+00,  elapsed time  39
INFO   step:    16,    loss: 2.7818e+02,   Y0: 6.9495e+00,  elapsed time  40
INFO   step:    17,    loss: 2.7815e+02,   Y0: 6.9472e+00,  elapsed time  41
INFO   step:    18,    loss: 2.7811e+02,   Y0: 6.9450e+00,  elapsed time  42
INFO   step:    19,    loss: 2.7808e+02,   Y0: 6.9423e+00,  elapsed time  43
INFO   step:    20,    loss: 2.7805e+02,   Y0: 6.9395e+00,  elapsed time  45
INFO   step:    21,    loss: 2.7801e+02,   Y0: 6.9362e+00,  elapsed time  46
INFO   step:    22,    loss: 2.7798e+02,   Y0: 6.9342e+00,  elapsed time  47
INFO   step:    23,    loss: 2.7794e+02,   Y0: 6.9316e+00,  elapsed time  48
INFO   step:    24,    loss: 2.7790e+02,   Y0: 6.9285e+00,  elapsed time  49
INFO   step:    25,    loss: 2.7787e+02,   Y0: 6.9249e+00,  elapsed time  50
INFO   step:    26,    loss: 2.7783e+02,   Y0: 6.9208e+00,  elapsed time  51
INFO   step:    27,    loss: 2.7779e+02,   Y0: 6.9168e+00,  elapsed time  52
INFO   step:    28,    loss: 2.7775e+02,   Y0: 6.9134e+00,  elapsed time  54
INFO   step:    29,    loss: 2.7772e+02,   Y0: 6.9107e+00,  elapsed time  55
INFO   step:    30,    loss: 2.7768e+02,   Y0: 6.9080e+00,  elapsed time  56
INFO   step:    31,    loss: 2.7765e+02,   Y0: 6.9064e+00,  elapsed time  57
INFO   step:    32,    loss: 2.7762e+02,   Y0: 6.9060e+00,  elapsed time  58
INFO   step:    33,    loss: 2.7758e+02,   Y0: 6.9053e+00,  elapsed time  59
INFO   step:    34,    loss: 2.7755e+02,   Y0: 6.9050e+00,  elapsed time  60
INFO   step:    35,    loss: 2.7752e+02,   Y0: 6.9048e+00,  elapsed time  62
INFO   step:    36,    loss: 2.7748e+02,   Y0: 6.9043e+00,  elapsed time  63
INFO   step:    37,    loss: 2.7745e+02,   Y0: 6.9039e+00,  elapsed time  64
INFO   step:    38,    loss: 2.7742e+02,   Y0: 6.9043e+00,  elapsed time  65
INFO   step:    39,    loss: 2.7739e+02,   Y0: 6.9050e+00,  elapsed time  66
INFO   step:    40,    loss: 2.7736e+02,   Y0: 6.9058e+00,  elapsed time  67
INFO   step:    41,    loss: 2.7733e+02,   Y0: 6.9066e+00,  elapsed time  68
INFO   step:    42,    loss: 2.7730e+02,   Y0: 6.9078e+00,  elapsed time  70
INFO   step:    43,    loss: 2.7728e+02,   Y0: 6.9088e+00,  elapsed time  71
INFO   step:    44,    loss: 2.7725e+02,   Y0: 6.9104e+00,  elapsed time  72
INFO   step:    45,    loss: 2.7723e+02,   Y0: 6.9113e+00,  elapsed time  73
INFO   step:    46,    loss: 2.7720e+02,   Y0: 6.9114e+00,  elapsed time  74
INFO   step:    47,    loss: 2.7717e+02,   Y0: 6.9123e+00,  elapsed time  75
INFO   step:    48,    loss: 2.7714e+02,   Y0: 6.9130e+00,  elapsed time  76
INFO   step:    49,    loss: 2.7711e+02,   Y0: 6.9136e+00,  elapsed time  77
INFO   step:    50,    loss: 2.7708e+02,   Y0: 6.9134e+00,  elapsed time  79
INFO   step:    51,    loss: 2.7705e+02,   Y0: 6.9133e+00,  elapsed time  80
INFO   step:    52,    loss: 2.7703e+02,   Y0: 6.9137e+00,  elapsed time  81
INFO   step:    53,    loss: 2.7700e+02,   Y0: 6.9147e+00,  elapsed time  82
INFO   step:    54,    loss: 2.7697e+02,   Y0: 6.9144e+00,  elapsed time  83
INFO   step:    55,    loss: 2.7694e+02,   Y0: 6.9144e+00,  elapsed time  84
INFO   step:    56,    loss: 2.7691e+02,   Y0: 6.9151e+00,  elapsed time  85
INFO   step:    57,    loss: 2.7688e+02,   Y0: 6.9154e+00,  elapsed time  86
INFO   step:    58,    loss: 2.7685e+02,   Y0: 6.9157e+00,  elapsed time  88
INFO   step:    59,    loss: 2.7682e+02,   Y0: 6.9158e+00,  elapsed time  89
INFO   step:    60,    loss: 2.7680e+02,   Y0: 6.9161e+00,  elapsed time  90
INFO   step:    61,    loss: 2.7677e+02,   Y0: 6.9154e+00,  elapsed time  91
INFO   step:    62,    loss: 2.7674e+02,   Y0: 6.9145e+00,  elapsed time  92
INFO   step:    63,    loss: 2.7670e+02,   Y0: 6.9132e+00,  elapsed time  93
INFO   step:    64,    loss: 2.7667e+02,   Y0: 6.9120e+00,  elapsed time  94
INFO   step:    65,    loss: 2.7664e+02,   Y0: 6.9097e+00,  elapsed time  96
INFO   step:    66,    loss: 2.7660e+02,   Y0: 6.9073e+00,  elapsed time  97
INFO   step:    67,    loss: 2.7657e+02,   Y0: 6.9060e+00,  elapsed time  98
INFO   step:    68,    loss: 2.7654e+02,   Y0: 6.9039e+00,  elapsed time  99
INFO   step:    69,    loss: 2.7650e+02,   Y0: 6.9015e+00,  elapsed time 100
INFO   step:    70,    loss: 2.7647e+02,   Y0: 6.8999e+00,  elapsed time 101
INFO   step:    71,    loss: 2.7643e+02,   Y0: 6.8976e+00,  elapsed time 102
INFO   step:    72,    loss: 2.7640e+02,   Y0: 6.8960e+00,  elapsed time 103
INFO   step:    73,    loss: 2.7636e+02,   Y0: 6.8944e+00,  elapsed time 105
INFO   step:    74,    loss: 2.7633e+02,   Y0: 6.8923e+00,  elapsed time 106
INFO   step:    75,    loss: 2.7630e+02,   Y0: 6.8908e+00,  elapsed time 107
INFO   step:    76,    loss: 2.7626e+02,   Y0: 6.8895e+00,  elapsed time 108
INFO   step:    77,    loss: 2.7623e+02,   Y0: 6.8884e+00,  elapsed time 109
INFO   step:    78,    loss: 2.7620e+02,   Y0: 6.8875e+00,  elapsed time 110
INFO   step:    79,    loss: 2.7616e+02,   Y0: 6.8861e+00,  elapsed time 111
INFO   step:    80,    loss: 2.7613e+02,   Y0: 6.8847e+00,  elapsed time 112
INFO   step:    81,    loss: 2.7610e+02,   Y0: 6.8845e+00,  elapsed time 114
INFO   step:    82,    loss: 2.7607e+02,   Y0: 6.8848e+00,  elapsed time 115
INFO   step:    83,    loss: 2.7604e+02,   Y0: 6.8841e+00,  elapsed time 116
INFO   step:    84,    loss: 2.7600e+02,   Y0: 6.8833e+00,  elapsed time 117
INFO   step:    85,    loss: 2.7597e+02,   Y0: 6.8825e+00,  elapsed time 118
INFO   step:    86,    loss: 2.7594e+02,   Y0: 6.8826e+00,  elapsed time 119
INFO   step:    87,    loss: 2.7591e+02,   Y0: 6.8834e+00,  elapsed time 120
INFO   step:    88,    loss: 2.7588e+02,   Y0: 6.8832e+00,  elapsed time 121
INFO   step:    89,    loss: 2.7585e+02,   Y0: 6.8829e+00,  elapsed time 123
INFO   step:    90,    loss: 2.7582e+02,   Y0: 6.8826e+00,  elapsed time 124
INFO   step:    91,    loss: 2.7579e+02,   Y0: 6.8829e+00,  elapsed time 125
INFO   step:    92,    loss: 2.7575e+02,   Y0: 6.8830e+00,  elapsed time 126
INFO   step:    93,    loss: 2.7572e+02,   Y0: 6.8833e+00,  elapsed time 127
INFO   step:    94,    loss: 2.7569e+02,   Y0: 6.8833e+00,  elapsed time 128
INFO   step:    95,    loss: 2.7566e+02,   Y0: 6.8833e+00,  elapsed time 129
INFO   step:    96,    loss: 2.7563e+02,   Y0: 6.8835e+00,  elapsed time 131
INFO   step:    97,    loss: 2.7560e+02,   Y0: 6.8837e+00,  elapsed time 132
INFO   step:    98,    loss: 2.7556e+02,   Y0: 6.8844e+00,  elapsed time 133
INFO   step:    99,    loss: 2.7553e+02,   Y0: 6.8852e+00,  elapsed time 134
INFO   step:   100,    loss: 2.7550e+02,   Y0: 6.8852e+00,  elapsed time 135
INFO   step:   101,    loss: 2.7546e+02,   Y0: 6.8847e+00,  elapsed time 136
INFO   step:   102,    loss: 2.7543e+02,   Y0: 6.8840e+00,  elapsed time 137
INFO   step:   103,    loss: 2.7539e+02,   Y0: 6.8830e+00,  elapsed time 138
INFO   step:   104,    loss: 2.7536e+02,   Y0: 6.8815e+00,  elapsed time 139
INFO   step:   105,    loss: 2.7533e+02,   Y0: 6.8801e+00,  elapsed time 141
INFO   step:   106,    loss: 2.7529e+02,   Y0: 6.8784e+00,  elapsed time 142
INFO   step:   107,    loss: 2.7526e+02,   Y0: 6.8758e+00,  elapsed time 143
INFO   step:   108,    loss: 2.7523e+02,   Y0: 6.8735e+00,  elapsed time 144
INFO   step:   109,    loss: 2.7520e+02,   Y0: 6.8718e+00,  elapsed time 145
INFO   step:   110,    loss: 2.7516e+02,   Y0: 6.8700e+00,  elapsed time 146
INFO   step:   111,    loss: 2.7513e+02,   Y0: 6.8684e+00,  elapsed time 147
INFO   step:   112,    loss: 2.7510e+02,   Y0: 6.8678e+00,  elapsed time 148
INFO   step:   113,    loss: 2.7507e+02,   Y0: 6.8667e+00,  elapsed time 150
INFO   step:   114,    loss: 2.7504e+02,   Y0: 6.8651e+00,  elapsed time 151
INFO   step:   115,    loss: 2.7501e+02,   Y0: 6.8635e+00,  elapsed time 152
INFO   step:   116,    loss: 2.7498e+02,   Y0: 6.8624e+00,  elapsed time 153
INFO   step:   117,    loss: 2.7495e+02,   Y0: 6.8609e+00,  elapsed time 154
INFO   step:   118,    loss: 2.7491e+02,   Y0: 6.8590e+00,  elapsed time 155
INFO   step:   119,    loss: 2.7488e+02,   Y0: 6.8575e+00,  elapsed time 156
INFO   step:   120,    loss: 2.7485e+02,   Y0: 6.8563e+00,  elapsed time 157
INFO   step:   121,    loss: 2.7481e+02,   Y0: 6.8545e+00,  elapsed time 159
INFO   step:   122,    loss: 2.7478e+02,   Y0: 6.8527e+00,  elapsed time 160
INFO   step:   123,    loss: 2.7474e+02,   Y0: 6.8517e+00,  elapsed time 161
INFO   step:   124,    loss: 2.7471e+02,   Y0: 6.8514e+00,  elapsed time 162
INFO   step:   125,    loss: 2.7468e+02,   Y0: 6.8513e+00,  elapsed time 163
INFO   step:   126,    loss: 2.7464e+02,   Y0: 6.8517e+00,  elapsed time 164
INFO   step:   127,    loss: 2.7461e+02,   Y0: 6.8511e+00,  elapsed time 165
INFO   step:   128,    loss: 2.7458e+02,   Y0: 6.8508e+00,  elapsed time 166
INFO   step:   129,    loss: 2.7455e+02,   Y0: 6.8509e+00,  elapsed time 168
INFO   step:   130,    loss: 2.7451e+02,   Y0: 6.8514e+00,  elapsed time 169
INFO   step:   131,    loss: 2.7448e+02,   Y0: 6.8522e+00,  elapsed time 170
INFO   step:   132,    loss: 2.7445e+02,   Y0: 6.8532e+00,  elapsed time 171
INFO   step:   133,    loss: 2.7442e+02,   Y0: 6.8543e+00,  elapsed time 172
INFO   step:   134,    loss: 2.7439e+02,   Y0: 6.8562e+00,  elapsed time 173
INFO   step:   135,    loss: 2.7436e+02,   Y0: 6.8580e+00,  elapsed time 174
INFO   step:   136,    loss: 2.7434e+02,   Y0: 6.8593e+00,  elapsed time 175
INFO   step:   137,    loss: 2.7431e+02,   Y0: 6.8610e+00,  elapsed time 177
INFO   step:   138,    loss: 2.7428e+02,   Y0: 6.8631e+00,  elapsed time 178
INFO   step:   139,    loss: 2.7425e+02,   Y0: 6.8648e+00,  elapsed time 179
INFO   step:   140,    loss: 2.7422e+02,   Y0: 6.8666e+00,  elapsed time 180
INFO   step:   141,    loss: 2.7420e+02,   Y0: 6.8682e+00,  elapsed time 181
INFO   step:   142,    loss: 2.7417e+02,   Y0: 6.8698e+00,  elapsed time 182
INFO   step:   143,    loss: 2.7414e+02,   Y0: 6.8713e+00,  elapsed time 183
INFO   step:   144,    loss: 2.7411e+02,   Y0: 6.8729e+00,  elapsed time 184
INFO   step:   145,    loss: 2.7408e+02,   Y0: 6.8750e+00,  elapsed time 186
INFO   step:   146,    loss: 2.7405e+02,   Y0: 6.8775e+00,  elapsed time 187
INFO   step:   147,    loss: 2.7402e+02,   Y0: 6.8796e+00,  elapsed time 188
INFO   step:   148,    loss: 2.7398e+02,   Y0: 6.8820e+00,  elapsed time 189
INFO   step:   149,    loss: 2.7395e+02,   Y0: 6.8836e+00,  elapsed time 190
INFO   step:   150,    loss: 2.7392e+02,   Y0: 6.8852e+00,  elapsed time 191
INFO   step:   151,    loss: 2.7389e+02,   Y0: 6.8865e+00,  elapsed time 192
INFO   step:   152,    loss: 2.7386e+02,   Y0: 6.8878e+00,  elapsed time 193
INFO   step:   153,    loss: 2.7383e+02,   Y0: 6.8888e+00,  elapsed time 194
INFO   step:   154,    loss: 2.7380e+02,   Y0: 6.8896e+00,  elapsed time 196
INFO   step:   155,    loss: 2.7377e+02,   Y0: 6.8901e+00,  elapsed time 197
INFO   step:   156,    loss: 2.7374e+02,   Y0: 6.8902e+00,  elapsed time 198
INFO   step:   157,    loss: 2.7371e+02,   Y0: 6.8906e+00,  elapsed time 199
INFO   step:   158,    loss: 2.7367e+02,   Y0: 6.8913e+00,  elapsed time 200
INFO   step:   159,    loss: 2.7364e+02,   Y0: 6.8916e+00,  elapsed time 201
INFO   step:   160,    loss: 2.7361e+02,   Y0: 6.8911e+00,  elapsed time 202
INFO   step:   161,    loss: 2.7358e+02,   Y0: 6.8907e+00,  elapsed time 204
INFO   step:   162,    loss: 2.7354e+02,   Y0: 6.8903e+00,  elapsed time 205
INFO   step:   163,    loss: 2.7351e+02,   Y0: 6.8903e+00,  elapsed time 206
INFO   step:   164,    loss: 2.7348e+02,   Y0: 6.8903e+00,  elapsed time 207
INFO   step:   165,    loss: 2.7344e+02,   Y0: 6.8905e+00,  elapsed time 208
INFO   step:   166,    loss: 2.7340e+02,   Y0: 6.8909e+00,  elapsed time 209
INFO   step:   167,    loss: 2.7337e+02,   Y0: 6.8914e+00,  elapsed time 210
INFO   step:   168,    loss: 2.7333e+02,   Y0: 6.8922e+00,  elapsed time 211
INFO   step:   169,    loss: 2.7330e+02,   Y0: 6.8928e+00,  elapsed time 213
INFO   step:   170,    loss: 2.7326e+02,   Y0: 6.8936e+00,  elapsed time 214
INFO   step:   171,    loss: 2.7323e+02,   Y0: 6.8944e+00,  elapsed time 215
INFO   step:   172,    loss: 2.7320e+02,   Y0: 6.8950e+00,  elapsed time 216
INFO   step:   173,    loss: 2.7316e+02,   Y0: 6.8956e+00,  elapsed time 217
INFO   step:   174,    loss: 2.7313e+02,   Y0: 6.8960e+00,  elapsed time 218
INFO   step:   175,    loss: 2.7309e+02,   Y0: 6.8962e+00,  elapsed time 219
INFO   step:   176,    loss: 2.7306e+02,   Y0: 6.8964e+00,  elapsed time 221
INFO   step:   177,    loss: 2.7303e+02,   Y0: 6.8955e+00,  elapsed time 222
INFO   step:   178,    loss: 2.7300e+02,   Y0: 6.8945e+00,  elapsed time 223
INFO   step:   179,    loss: 2.7297e+02,   Y0: 6.8931e+00,  elapsed time 224
INFO   step:   180,    loss: 2.7294e+02,   Y0: 6.8926e+00,  elapsed time 225
INFO   step:   181,    loss: 2.7291e+02,   Y0: 6.8914e+00,  elapsed time 226
INFO   step:   182,    loss: 2.7288e+02,   Y0: 6.8904e+00,  elapsed time 227
INFO   step:   183,    loss: 2.7285e+02,   Y0: 6.8900e+00,  elapsed time 228
INFO   step:   184,    loss: 2.7282e+02,   Y0: 6.8900e+00,  elapsed time 230
INFO   step:   185,    loss: 2.7279e+02,   Y0: 6.8895e+00,  elapsed time 231
INFO   step:   186,    loss: 2.7276e+02,   Y0: 6.8892e+00,  elapsed time 232
INFO   step:   187,    loss: 2.7273e+02,   Y0: 6.8891e+00,  elapsed time 233
INFO   step:   188,    loss: 2.7270e+02,   Y0: 6.8895e+00,  elapsed time 234
INFO   step:   189,    loss: 2.7267e+02,   Y0: 6.8901e+00,  elapsed time 235
INFO   step:   190,    loss: 2.7264e+02,   Y0: 6.8900e+00,  elapsed time 236
INFO   step:   191,    loss: 2.7262e+02,   Y0: 6.8901e+00,  elapsed time 238
INFO   step:   192,    loss: 2.7259e+02,   Y0: 6.8899e+00,  elapsed time 239
INFO   step:   193,    loss: 2.7256e+02,   Y0: 6.8895e+00,  elapsed time 240
INFO   step:   194,    loss: 2.7253e+02,   Y0: 6.8893e+00,  elapsed time 241
INFO   step:   195,    loss: 2.7250e+02,   Y0: 6.8897e+00,  elapsed time 242
INFO   step:   196,    loss: 2.7246e+02,   Y0: 6.8892e+00,  elapsed time 243
INFO   step:   197,    loss: 2.7243e+02,   Y0: 6.8888e+00,  elapsed time 244
INFO   step:   198,    loss: 2.7240e+02,   Y0: 6.8882e+00,  elapsed time 245
INFO   step:   199,    loss: 2.7237e+02,   Y0: 6.8876e+00,  elapsed time 247
INFO   step:   200,    loss: 2.7233e+02,   Y0: 6.8862e+00,  elapsed time 248
INFO   step:   201,    loss: 2.7230e+02,   Y0: 6.8851e+00,  elapsed time 249
INFO   step:   202,    loss: 2.7227e+02,   Y0: 6.8844e+00,  elapsed time 250
INFO   step:   203,    loss: 2.7223e+02,   Y0: 6.8843e+00,  elapsed time 251
INFO   step:   204,    loss: 2.7220e+02,   Y0: 6.8842e+00,  elapsed time 252
INFO   step:   205,    loss: 2.7217e+02,   Y0: 6.8843e+00,  elapsed time 253
INFO   step:   206,    loss: 2.7213e+02,   Y0: 6.8837e+00,  elapsed time 254
INFO   step:   207,    loss: 2.7209e+02,   Y0: 6.8825e+00,  elapsed time 255
INFO   step:   208,    loss: 2.7206e+02,   Y0: 6.8807e+00,  elapsed time 257
INFO   step:   209,    loss: 2.7202e+02,   Y0: 6.8787e+00,  elapsed time 258
INFO   step:   210,    loss: 2.7198e+02,   Y0: 6.8767e+00,  elapsed time 259
INFO   step:   211,    loss: 2.7195e+02,   Y0: 6.8750e+00,  elapsed time 260
INFO   step:   212,    loss: 2.7191e+02,   Y0: 6.8732e+00,  elapsed time 261
INFO   step:   213,    loss: 2.7187e+02,   Y0: 6.8721e+00,  elapsed time 262
INFO   step:   214,    loss: 2.7184e+02,   Y0: 6.8712e+00,  elapsed time 263
INFO   step:   215,    loss: 2.7180e+02,   Y0: 6.8710e+00,  elapsed time 264
INFO   step:   216,    loss: 2.7177e+02,   Y0: 6.8715e+00,  elapsed time 266
INFO   step:   217,    loss: 2.7174e+02,   Y0: 6.8711e+00,  elapsed time 267
INFO   step:   218,    loss: 2.7170e+02,   Y0: 6.8713e+00,  elapsed time 268
INFO   step:   219,    loss: 2.7167e+02,   Y0: 6.8715e+00,  elapsed time 269
INFO   step:   220,    loss: 2.7164e+02,   Y0: 6.8715e+00,  elapsed time 270
INFO   step:   221,    loss: 2.7160e+02,   Y0: 6.8712e+00,  elapsed time 271
INFO   step:   222,    loss: 2.7157e+02,   Y0: 6.8711e+00,  elapsed time 272
INFO   step:   223,    loss: 2.7154e+02,   Y0: 6.8702e+00,  elapsed time 273
INFO   step:   224,    loss: 2.7150e+02,   Y0: 6.8696e+00,  elapsed time 274
INFO   step:   225,    loss: 2.7147e+02,   Y0: 6.8697e+00,  elapsed time 276
INFO   step:   226,    loss: 2.7144e+02,   Y0: 6.8702e+00,  elapsed time 277
INFO   step:   227,    loss: 2.7141e+02,   Y0: 6.8706e+00,  elapsed time 278
INFO   step:   228,    loss: 2.7138e+02,   Y0: 6.8716e+00,  elapsed time 279
INFO   step:   229,    loss: 2.7135e+02,   Y0: 6.8722e+00,  elapsed time 280
INFO   step:   230,    loss: 2.7132e+02,   Y0: 6.8721e+00,  elapsed time 281
INFO   step:   231,    loss: 2.7128e+02,   Y0: 6.8717e+00,  elapsed time 282
INFO   step:   232,    loss: 2.7126e+02,   Y0: 6.8719e+00,  elapsed time 283
INFO   step:   233,    loss: 2.7122e+02,   Y0: 6.8712e+00,  elapsed time 285
INFO   step:   234,    loss: 2.7119e+02,   Y0: 6.8705e+00,  elapsed time 286
INFO   step:   235,    loss: 2.7116e+02,   Y0: 6.8689e+00,  elapsed time 287
INFO   step:   236,    loss: 2.7113e+02,   Y0: 6.8672e+00,  elapsed time 288
INFO   step:   237,    loss: 2.7109e+02,   Y0: 6.8648e+00,  elapsed time 289
INFO   step:   238,    loss: 2.7106e+02,   Y0: 6.8633e+00,  elapsed time 290
INFO   step:   239,    loss: 2.7103e+02,   Y0: 6.8620e+00,  elapsed time 291
INFO   step:   240,    loss: 2.7100e+02,   Y0: 6.8606e+00,  elapsed time 292
INFO   step:   241,    loss: 2.7097e+02,   Y0: 6.8587e+00,  elapsed time 293
INFO   step:   242,    loss: 2.7094e+02,   Y0: 6.8567e+00,  elapsed time 295
INFO   step:   243,    loss: 2.7091e+02,   Y0: 6.8552e+00,  elapsed time 296
INFO   step:   244,    loss: 2.7088e+02,   Y0: 6.8534e+00,  elapsed time 297
INFO   step:   245,    loss: 2.7085e+02,   Y0: 6.8524e+00,  elapsed time 298
INFO   step:   246,    loss: 2.7081e+02,   Y0: 6.8513e+00,  elapsed time 299
INFO   step:   247,    loss: 2.7078e+02,   Y0: 6.8501e+00,  elapsed time 300
INFO   step:   248,    loss: 2.7075e+02,   Y0: 6.8497e+00,  elapsed time 301
INFO   step:   249,    loss: 2.7072e+02,   Y0: 6.8494e+00,  elapsed time 303
INFO   step:   250,    loss: 2.7069e+02,   Y0: 6.8492e+00,  elapsed time 304
INFO   step:   251,    loss: 2.7066e+02,   Y0: 6.8492e+00,  elapsed time 305
INFO   step:   252,    loss: 2.7063e+02,   Y0: 6.8491e+00,  elapsed time 306
INFO   step:   253,    loss: 2.7060e+02,   Y0: 6.8494e+00,  elapsed time 307
INFO   step:   254,    loss: 2.7057e+02,   Y0: 6.8504e+00,  elapsed time 308
INFO   step:   255,    loss: 2.7055e+02,   Y0: 6.8520e+00,  elapsed time 309
INFO   step:   256,    loss: 2.7052e+02,   Y0: 6.8527e+00,  elapsed time 310
INFO   step:   257,    loss: 2.7049e+02,   Y0: 6.8530e+00,  elapsed time 312
INFO   step:   258,    loss: 2.7046e+02,   Y0: 6.8533e+00,  elapsed time 313
INFO   step:   259,    loss: 2.7043e+02,   Y0: 6.8533e+00,  elapsed time 314
INFO   step:   260,    loss: 2.7040e+02,   Y0: 6.8535e+00,  elapsed time 315
INFO   step:   261,    loss: 2.7037e+02,   Y0: 6.8535e+00,  elapsed time 316
INFO   step:   262,    loss: 2.7034e+02,   Y0: 6.8538e+00,  elapsed time 317
INFO   step:   263,    loss: 2.7031e+02,   Y0: 6.8535e+00,  elapsed time 318
INFO   step:   264,    loss: 2.7028e+02,   Y0: 6.8521e+00,  elapsed time 319
INFO   step:   265,    loss: 2.7025e+02,   Y0: 6.8516e+00,  elapsed time 321
INFO   step:   266,    loss: 2.7022e+02,   Y0: 6.8509e+00,  elapsed time 322
INFO   step:   267,    loss: 2.7019e+02,   Y0: 6.8505e+00,  elapsed time 323
INFO   step:   268,    loss: 2.7016e+02,   Y0: 6.8501e+00,  elapsed time 324
INFO   step:   269,    loss: 2.7014e+02,   Y0: 6.8504e+00,  elapsed time 325
INFO   step:   270,    loss: 2.7011e+02,   Y0: 6.8507e+00,  elapsed time 326
INFO   step:   271,    loss: 2.7008e+02,   Y0: 6.8510e+00,  elapsed time 327
INFO   step:   272,    loss: 2.7005e+02,   Y0: 6.8515e+00,  elapsed time 328
INFO   step:   273,    loss: 2.7002e+02,   Y0: 6.8516e+00,  elapsed time 330
INFO   step:   274,    loss: 2.6999e+02,   Y0: 6.8512e+00,  elapsed time 331
INFO   step:   275,    loss: 2.6996e+02,   Y0: 6.8506e+00,  elapsed time 332
INFO   step:   276,    loss: 2.6993e+02,   Y0: 6.8507e+00,  elapsed time 333
INFO   step:   277,    loss: 2.6990e+02,   Y0: 6.8511e+00,  elapsed time 334
INFO   step:   278,    loss: 2.6987e+02,   Y0: 6.8517e+00,  elapsed time 335
INFO   step:   279,    loss: 2.6984e+02,   Y0: 6.8518e+00,  elapsed time 336
INFO   step:   280,    loss: 2.6981e+02,   Y0: 6.8529e+00,  elapsed time 337
INFO   step:   281,    loss: 2.6978e+02,   Y0: 6.8543e+00,  elapsed time 339
INFO   step:   282,    loss: 2.6975e+02,   Y0: 6.8561e+00,  elapsed time 340
INFO   step:   283,    loss: 2.6972e+02,   Y0: 6.8569e+00,  elapsed time 341
INFO   step:   284,    loss: 2.6969e+02,   Y0: 6.8585e+00,  elapsed time 342
INFO   step:   285,    loss: 2.6967e+02,   Y0: 6.8594e+00,  elapsed time 343
INFO   step:   286,    loss: 2.6964e+02,   Y0: 6.8610e+00,  elapsed time 344
INFO   step:   287,    loss: 2.6961e+02,   Y0: 6.8622e+00,  elapsed time 345
INFO   step:   288,    loss: 2.6958e+02,   Y0: 6.8626e+00,  elapsed time 346
INFO   step:   289,    loss: 2.6954e+02,   Y0: 6.8629e+00,  elapsed time 348
INFO   step:   290,    loss: 2.6951e+02,   Y0: 6.8632e+00,  elapsed time 349
INFO   step:   291,    loss: 2.6948e+02,   Y0: 6.8643e+00,  elapsed time 350
INFO   step:   292,    loss: 2.6945e+02,   Y0: 6.8652e+00,  elapsed time 351
INFO   step:   293,    loss: 2.6942e+02,   Y0: 6.8662e+00,  elapsed time 352
INFO   step:   294,    loss: 2.6939e+02,   Y0: 6.8672e+00,  elapsed time 353
INFO   step:   295,    loss: 2.6936e+02,   Y0: 6.8678e+00,  elapsed time 354
INFO   step:   296,    loss: 2.6933e+02,   Y0: 6.8673e+00,  elapsed time 355
INFO   step:   297,    loss: 2.6930e+02,   Y0: 6.8672e+00,  elapsed time 357
INFO   step:   298,    loss: 2.6927e+02,   Y0: 6.8679e+00,  elapsed time 358
INFO   step:   299,    loss: 2.6923e+02,   Y0: 6.8684e+00,  elapsed time 359
Delta:  80 ,  80.05
Other:  -10 ,  -10
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_10:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_11:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_12:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_13:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_14:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_15:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_16:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_17:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_18:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_19:0' shape=(?, 2) dtype=float64>]
num_iterations:  300
total time intervals:  20
# of dimensions:  2
test 1
Loss out:  273.03204190243616
Output_Z_Vals:  [[[ 7.85439900e+01 -8.55761982e+00]
  [ 7.85439900e+01 -8.55761982e+00]
  [ 7.85439900e+01 -8.55761982e+00]
  ...
  [ 7.85439900e+01 -8.55761982e+00]
  [ 7.85439900e+01 -8.55761982e+00]
  [ 7.85439900e+01 -8.55761982e+00]]

 [[ 1.48203933e-01 -8.37250500e-03]
  [ 1.60502554e-01  1.34369789e-03]
  [-2.66278578e-02 -6.60018439e-02]
  ...
  [ 1.54757826e-01 -3.19466722e-03]
  [ 1.51950227e-01 -5.41301187e-03]
  [-4.67417898e-02 -7.55473878e-02]]

 [[-2.56424620e-01  9.64545663e-02]
  [ 1.39243802e-02  3.65407153e-02]
  [-7.61848995e-03 -1.00974681e-01]
  ...
  [-5.44671696e-02  6.71528385e-02]
  [ 1.70758362e-02  3.27121384e-02]
  [ 2.33027724e-02 -6.37970969e-02]]

 ...

 [[-8.93858704e-02  1.53119359e-01]
  [-6.54596944e-02  7.88548993e-02]
  [ 2.93850176e-01 -1.50860231e-01]
  ...
  [-7.00941738e-02  9.23882198e-02]
  [-6.28985641e-02  7.41687512e-02]
  [-2.16357108e-02 -1.15961172e-02]]

 [[ 8.87380282e-02 -1.24807779e-01]
  [ 1.19762669e-01 -7.35681498e-02]
  [-2.36492345e-01  5.99456314e-02]
  ...
  [ 1.09726201e-01 -9.02604363e-02]
  [ 1.19673395e-01 -6.76336501e-02]
  [ 1.14900480e-01 -8.16797477e-02]]

 [[ 4.53130773e-02  5.74914423e-02]
  [ 1.07091225e-01  5.80497739e-02]
  [-1.57354520e-01 -2.18556613e-01]
  ...
  [ 1.19834337e-01  6.64546546e-02]
  [ 1.14781041e-01  6.31633434e-02]
  [ 4.15215994e-02  5.74463138e-02]]]
X_test:  [[[1.00000000e+02 9.57210644e+01 8.95979093e+01 ... 8.67643902e+01
   8.54971318e+01 8.92135372e+01]
  [4.00000000e-02 4.18689516e-02 4.00421116e-02 ... 4.62669144e-02
   4.64278439e-02 5.22164336e-02]]

 [[1.00000000e+02 9.69617907e+01 9.72270660e+01 ... 9.17706830e+01
   9.49645467e+01 9.51505591e+01]
  [4.00000000e-02 4.12337415e-02 4.06533139e-02 ... 4.56231103e-02
   4.06339363e-02 4.50412296e-02]]

 [[1.00000000e+02 1.01926437e+02 1.03369260e+02 ... 1.40896916e+02
   1.39291838e+02 1.40047013e+02]
  [4.00000000e-02 3.93917152e-02 3.89660626e-02 ... 2.55971935e-02
   2.41678637e-02 2.22931517e-02]]

 ...

 [[1.00000000e+02 9.63772586e+01 9.51454213e+01 ... 9.01317784e+01
   9.44225620e+01 9.98014360e+01]
  [4.00000000e-02 4.41555114e-02 4.88161670e-02 ... 5.59765089e-02
   4.87212901e-02 4.72965074e-02]]

 [[1.00000000e+02 9.61068507e+01 9.73437176e+01 ... 9.24413171e+01
   9.46974174e+01 9.71457593e+01]
  [4.00000000e-02 3.75426096e-02 3.52903584e-02 ... 2.65443526e-02
   3.05138999e-02 2.78082430e-02]]

 [[1.00000000e+02 1.01273519e+02 1.00181889e+02 ... 9.09590943e+01
   8.52134106e+01 8.94537824e+01]
  [4.00000000e-02 4.33029349e-02 4.54725221e-02 ... 6.41771832e-02
   6.66205538e-02 6.95066362e-02]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.48203933e-01 -8.37250500e-03]
 [-2.56424620e-01  9.64545663e-02]
 [ 4.04663669e-02  9.87201992e-02]
 [-5.99184516e-01 -3.05403910e-01]
 [ 5.34301752e-01  5.42819888e-02]
 [-9.54200746e-02 -6.04219327e-01]
 [-5.50512659e-01 -4.95195213e-01]
 [ 3.33062434e-02 -1.14501910e-02]
 [-1.06039186e-01 -8.61258404e-02]
 [ 4.69651032e-02  2.51067645e-01]
 [ 5.87474743e-02 -1.10822525e-01]
 [-6.68500805e-03  1.54983537e-02]
 [-1.16837941e-01 -1.40237934e-01]
 [ 5.47140503e-03  1.66180405e-01]
 [-9.22963768e-02  9.46131272e-04]
 [-1.09447579e-01  4.43072926e-02]
 [-8.93858704e-02  1.53119359e-01]
 [ 8.87380282e-02 -1.24807779e-01]
 [ 4.53130773e-02  5.74914423e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.59876514]
curr_Stock_Price:  95.72106435845183
curr_Factors:  [9.57210644e+01 4.18689516e-02]
mat_Sqrt:  [[ 1.95863506e+01 -8.17693160e-03]
 [-8.17693160e-03  1.87570602e-02]]
grads:  [ 0.00738169 -0.44314756]
Stock Position:  0.007381688850668717
Bond Position:  [-10.30534825]


portfolio before change:  [-9.6568541]
curr_Stock_Price:  89.59790928317447
curr_Factors:  [8.95979093e+01 4.00421116e-02]
mat_Sqrt:  [[ 1.79290104e+01 -7.99602996e-03]
 [-7.99602996e-03  1.83435171e-02]]
grads:  [-0.01195946  5.25302413]
Stock Position:  -0.011959459948993436
Bond Position:  [-8.5853115]


portfolio before change:  [-9.66290671]
curr_Stock_Price:  89.20610713384993
curr_Factors:  [8.92061071e+01 4.20083332e-02]
mat_Sqrt:  [[ 1.82836235e+01 -8.18995852e-03]
 [-8.18995852e-03  1.87885048e-02]]
grads:  [4.56775255e-03 5.25627825e+00]
Stock Position:  0.004567752546528567
Bond Position:  [-10.07037814]


portfolio before change:  [-9.67643478]
curr_Stock_Price:  89.00201945022584
curr_Factors:  [8.90020195e+01 4.34624825e-02]
mat_Sqrt:  [[ 1.85548344e+01 -8.33048371e-03]
 [-8.33048371e-03  1.91109358e-02]]
grads:  [ -0.0394751  -15.99779099]
Stock Position:  -0.03947509522886061
Bond Position:  [-6.16307158]


portfolio before change:  [-9.6585021]
curr_Stock_Price:  88.35246208822554
curr_Factors:  [8.83524621e+01 4.70513758e-02]
mat_Sqrt:  [[ 1.91648214e+01 -8.66753957e-03]
 [-8.66753957e-03  1.98843535e-02]]
grads:  [0.02911966 2.7425777 ]
Stock Position:  0.029119663680327028
Bond Position:  [-12.23129608]


portfolio before change:  [-9.86261587]
curr_Stock_Price:  81.86835244763587
curr_Factors:  [8.18683524e+01 4.76608266e-02]
mat_Sqrt:  [[ 1.78729724e+01 -8.72277770e-03]
 [-8.72277770e-03  2.00130311e-02]]
grads:  [-2.00777103e-02 -3.02000460e+01]
Stock Position:  -0.020077710346481446
Bond Position:  [-8.2188868]


portfolio before change:  [-9.88695034]
curr_Stock_Price:  82.56835457912976
curr_Factors:  [8.25683546e+01 4.39903743e-02]
mat_Sqrt:  [[ 1.73177876e+01 -8.38024984e-03]
 [-8.38024984e-03  1.92269383e-02]]
grads:  [ -0.04426143 -25.77457354]
Stock Position:  -0.044261428986271695
Bond Position:  [-6.23235698]


portfolio before change:  [-10.09421094]
curr_Stock_Price:  87.07488075338209
curr_Factors:  [8.70748808e+01 4.63169972e-02]
mat_Sqrt:  [[ 1.87397175e+01 -8.59950123e-03]
 [-8.59950123e-03  1.97286226e-02]]
grads:  [ 0.00151128 -0.57972596]
Stock Position:  0.00151127620679272
Bond Position:  [-10.22580514]


portfolio before change:  [-10.10225433]
curr_Stock_Price:  90.2158461084987
curr_Factors:  [9.02158461e+01 4.43149969e-02]
mat_Sqrt:  [[ 1.89914509e+01 -8.41190440e-03]
 [-8.41190440e-03  1.92974048e-02]]
grads:  [-0.00756182 -4.46637517]
Stock Position:  -0.007561818586121849
Bond Position:  [-9.42005847]


portfolio before change:  [-10.12313448]
curr_Stock_Price:  91.41895863473623
curr_Factors:  [9.14189586e+01 4.39344850e-02]
mat_Sqrt:  [[ 1.91619189e+01 -8.37582391e-03]
 [-8.37582391e-03  1.92143286e-02]]
grads:  [8.16406715e-03 1.30702473e+01]
Stock Position:  0.008164067151988287
Bond Position:  [-10.869485]


portfolio before change:  [-10.11157124]
curr_Stock_Price:  94.50058383598055
curr_Factors:  [9.45005838e+01 4.30907018e-02]
mat_Sqrt:  [[ 1.96167129e+01 -8.29527407e-03]
 [-8.29527407e-03  1.90288057e-02]]
grads:  [ 5.32110683e-04 -5.82370291e+00]
Stock Position:  0.0005321106834096136
Bond Position:  [-10.16185601]


portfolio before change:  [-10.12416525]
curr_Stock_Price:  94.71904510603368
curr_Factors:  [9.47190451e+01 4.42263832e-02]
mat_Sqrt:  [[ 1.99194794e+01 -8.40389540e-03]
 [-8.40389540e-03  1.92779245e-02]]
grads:  [3.57732510e-06 8.03944621e-01]
Stock Position:  3.5773250957209666e-06
Bond Position:  [-10.1245041]


portfolio before change:  [-10.13683471]
curr_Stock_Price:  93.0654371485403
curr_Factors:  [9.30654371e+01 4.50496284e-02]
mat_Sqrt:  [[ 1.97530421e+01 -8.48160557e-03]
 [-8.48160557e-03  1.94565838e-02]]
grads:  [-0.0090115 -7.2116651]
Stock Position:  -0.00901149500998122
Bond Position:  [-9.29817599]


portfolio before change:  [-10.14964194]
curr_Stock_Price:  93.19607492619988
curr_Factors:  [9.31960749e+01 4.00739155e-02]
mat_Sqrt:  [[ 1.86564269e+01 -7.99952046e-03]
 [-7.99952046e-03  1.83506629e-02]]
grads:  [4.17701818e-03 9.05764660e+00]
Stock Position:  0.004177018175626289
Bond Position:  [-10.53892364]


portfolio before change:  [-10.16739286]
curr_Stock_Price:  92.10222593774881
curr_Factors:  [9.21022259e+01 4.21275850e-02]
mat_Sqrt:  [[ 1.89039851e+01 -8.20183972e-03]
 [-8.20183972e-03  1.88150385e-02]]
grads:  [-0.00486148  0.04816669]
Stock Position:  -0.00486147871019314
Bond Position:  [-9.71963985]


portfolio before change:  [-10.15943855]
curr_Stock_Price:  87.96532510261662
curr_Factors:  [8.79653251e+01 4.30465439e-02]
mat_Sqrt:  [[ 1.82507456e+01 -8.29042572e-03]
 [-8.29042572e-03  1.90193133e-02]]
grads:  [-0.00493964  2.32744159]
Stock Position:  -0.004939639127698969
Bond Position:  [-9.72492159]


portfolio before change:  [-10.16597581]
curr_Stock_Price:  86.8262749670049
curr_Factors:  [8.68262750e+01 4.41120489e-02]
mat_Sqrt:  [[ 1.82360065e+01 -8.39228787e-03]
 [-8.39228787e-03  1.92533112e-02]]
grads:  [-1.24191215e-03  7.95234307e+00]
Stock Position:  -0.0012419121535280602
Bond Position:  [-10.0581452]


portfolio before change:  [-10.1784795]
curr_Stock_Price:  86.76439019818216
curr_Factors:  [8.67643902e+01 4.62669144e-02]
mat_Sqrt:  [[ 1.86627974e+01 -8.59481829e-03]
 [-8.59481829e-03  1.97179675e-02]]
grads:  [ 1.84017184e-03 -6.32884515e+00]
Stock Position:  0.0018401718356527584
Bond Position:  [-10.33814088]


portfolio before change:  [-10.19374222]
curr_Stock_Price:  85.49713183058319
curr_Factors:  [8.54971318e+01 4.64278439e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.19374222]
Stock Price:  89.21353724770248
PL:  [-10.19374222]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.60502554e-01  1.34369789e-03]
 [ 1.39243802e-02  3.65407153e-02]
 [ 6.94625850e-02  2.48568249e-02]
 [-1.15189451e-02 -1.68920053e-03]
 [-9.63398530e-02  9.52124121e-03]
 [ 7.36895150e-02  4.09924865e-03]
 [-2.87855372e-01 -3.26485328e-01]
 [ 3.39847198e-02 -8.50539667e-03]
 [-1.99122487e-01 -1.55858534e-01]
 [ 8.27052734e-02  4.04347008e-01]
 [ 5.54712338e-02 -1.01822097e-01]
 [ 1.41559236e-02 -5.55871733e-02]
 [-1.27308533e-01 -1.35431762e-01]
 [ 5.58356407e-03  1.66327898e-01]
 [-7.95453653e-02 -3.44901700e-02]
 [ 1.07799681e-02 -1.73670745e-02]
 [-6.54596944e-02  7.88548993e-02]
 [ 1.19762669e-01 -7.35681498e-02]
 [ 1.07091225e-01  5.80497739e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.95681991]
curr_Stock_Price:  96.9617907417844
curr_Factors:  [9.69617907e+01 4.12337415e-02]
mat_Sqrt:  [[ 1.96891498e+01 -8.11476619e-03]
 [-8.11476619e-03  1.86141877e-02]]
grads:  [0.00818305 0.07575412]
Stock Position:  0.008183049184619571
Bond Position:  [-5.75026301]


portfolio before change:  [-4.96184147]
curr_Stock_Price:  97.22706597377318
curr_Factors:  [9.72270660e+01 4.06533139e-02]
mat_Sqrt:  [[ 1.96035679e+01 -8.05747070e-03]
 [-8.05747070e-03  1.84827029e-02]]
grads:  [1.52316812e-03 1.97768630e+00]
Stock Position:  0.001523168118384956
Bond Position:  [-5.10993464]


portfolio before change:  [-4.96435243]
curr_Stock_Price:  99.77468800547524
curr_Factors:  [9.97746880e+01 3.59805132e-02]
mat_Sqrt:  [[ 1.89257902e+01 -7.58044813e-03]
 [-7.58044813e-03  1.73879826e-02]]
grads:  [0.00424358 1.4313905 ]
Stock Position:  0.0042435832678297805
Bond Position:  [-5.38775462]


portfolio before change:  [-4.9697054]
curr_Stock_Price:  100.10128187096352
curr_Factors:  [1.00101282e+02 3.67933183e-02]
mat_Sqrt:  [[ 1.92010104e+01 -7.66561464e-03]
 [-7.66561464e-03  1.75832743e-02]]
grads:  [-0.00063838 -0.09634691]
Stock Position:  -0.0006383780364176801
Bond Position:  [-4.90580294]


portfolio before change:  [-4.9722284]
curr_Stock_Price:  94.4414808675606
curr_Factors:  [9.44414809e+01 3.69023570e-02]
mat_Sqrt:  [[ 1.81421938e+01 -7.67654403e-03]
 [-7.67654403e-03  1.76094929e-02]]
grads:  [-0.00508242  0.53847239]
Stock Position:  -0.005082419844499586
Bond Position:  [-4.49223714]


portfolio before change:  [-4.98217219]
curr_Stock_Price:  95.2924512900283
curr_Factors:  [9.52924513e+01 4.00968752e-02]
mat_Sqrt:  [[ 1.90815533e+01 -8.00198471e-03]
 [-8.00198471e-03  1.83558436e-02]]
grads:  [0.00395619 0.22504583]
Stock Position:  0.003956194080455463
Bond Position:  [-5.35916763]


portfolio before change:  [-5.01590689]
curr_Stock_Price:  88.45973566460123
curr_Factors:  [8.84597357e+01 4.72032116e-02]
mat_Sqrt:  [[ 1.92190257e+01 -8.68152438e-03]
 [-8.68152438e-03  1.99164066e-02]]
grads:  [ -0.0223869  -16.40254126]
Stock Position:  -0.02238690144477599
Bond Position:  [-3.03556751]


portfolio before change:  [-4.92508305]
curr_Stock_Price:  84.23312697306851
curr_Factors:  [8.42331270e+01 4.61325747e-02]
mat_Sqrt:  [[ 1.80920059e+01 -8.58205915e-03]
 [-8.58205915e-03  1.96894390e-02]]
grads:  [ 0.00167387 -0.43124801]
Stock Position:  0.0016738732001431236
Bond Position:  [-5.06607862]


portfolio before change:  [-4.9296725]
curr_Stock_Price:  85.27687761918429
curr_Factors:  [8.52768776e+01 4.66926046e-02]
mat_Sqrt:  [[ 1.84270279e+01 -8.63410818e-03]
 [-8.63410818e-03  1.98085391e-02]]
grads:  [-0.01449568 -7.87456817]
Stock Position:  -0.014495683309027806
Bond Position:  [-3.69352589]


portfolio before change:  [-4.93053977]
curr_Stock_Price:  85.01800583269646
curr_Factors:  [8.50180058e+01 4.78078303e-02]
mat_Sqrt:  [[ 1.85891864e+01 -8.73658150e-03]
 [-8.73658150e-03  2.00437134e-02]]
grads:  [1.39330275e-02 2.01793314e+01]
Stock Position:  0.013933027540174774
Bond Position:  [-6.11509799]


portfolio before change:  [-4.88718256]
curr_Stock_Price:  88.67879400538584
curr_Factors:  [8.86787940e+01 4.61394792e-02]
mat_Sqrt:  [[ 1.90482937e+01 -8.58316912e-03]
 [-8.58316912e-03  1.96907085e-02]]
grads:  [ 5.82163164e-04 -5.17081957e+00]
Stock Position:  0.0005821631637284332
Bond Position:  [-4.93880809]


portfolio before change:  [-4.8933315]
curr_Stock_Price:  88.72763007222426
curr_Factors:  [8.87276301e+01 4.86452232e-02]
mat_Sqrt:  [[ 1.95694643e+01 -8.81316038e-03]
 [-8.81316038e-03  2.02183193e-02]]
grads:  [-5.14908807e-04 -2.74957134e+00]
Stock Position:  -0.0005149088071225607
Bond Position:  [-4.84764486]


portfolio before change:  [-4.9008809]
curr_Stock_Price:  91.61368742748279
curr_Factors:  [9.16136874e+01 4.90646639e-02]
mat_Sqrt:  [[ 2.02929290e+01 -8.85136209e-03]
 [-8.85136209e-03  2.03051724e-02]]
grads:  [-0.00918453 -6.67381959]
Stock Position:  -0.00918452564690693
Bond Position:  [-4.05945264]


portfolio before change:  [-4.90933419]
curr_Stock_Price:  91.98124023346935
curr_Factors:  [9.19812402e+01 5.02027884e-02]
mat_Sqrt:  [[ 2.06092952e+01 -8.95346928e-03]
 [-8.95346928e-03  2.05393104e-02]]
grads:  [3.78973633e-03 8.09967940e+00]
Stock Position:  0.0037897363299863812
Bond Position:  [-5.25791884]


portfolio before change:  [-4.90429443]
curr_Stock_Price:  95.04643108653907
curr_Factors:  [9.50464311e+01 4.45636488e-02]
mat_Sqrt:  [[ 2.00643986e+01 -8.43590624e-03]
 [-8.43590624e-03  1.93512783e-02]]
grads:  [-0.00471473 -1.78437529]
Stock Position:  -0.004714728303348985
Bond Position:  [-4.45617633]


portfolio before change:  [-4.90986669]
curr_Stock_Price:  95.04612491579898
curr_Factors:  [9.50461249e+01 4.77523001e-02]
mat_Sqrt:  [[ 2.07697622e+01 -8.73249849e-03]
 [-8.73249849e-03  2.00316368e-02]]
grads:  [ 1.54534015e-04 -8.66914932e-01]
Stock Position:  0.00015453401523721544
Bond Position:  [-4.92455455]


portfolio before change:  [-4.91649083]
curr_Stock_Price:  92.0397205666702
curr_Factors:  [9.20397206e+01 4.68808827e-02]
mat_Sqrt:  [[ 1.99284325e+01 -8.65218094e-03]
 [-8.65218094e-03  1.98481383e-02]]
grads:  [-1.56014420e-03  3.97223153e+00]
Stock Position:  -0.0015601442007887785
Bond Position:  [-4.77289559]


portfolio before change:  [-4.92204094]
curr_Stock_Price:  91.77068297135335
curr_Factors:  [9.17706830e+01 4.56231103e-02]
mat_Sqrt:  [[ 1.96018187e+01 -8.53530177e-03]
 [-8.53530177e-03  1.95800849e-02]]
grads:  [ 0.00447457 -3.75534418]
Stock Position:  0.004474568118984076
Bond Position:  [-5.33267511]


portfolio before change:  [-4.91441979]
curr_Stock_Price:  94.96454672381981
curr_Factors:  [9.49645467e+01 4.06339363e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.91441979]
Stock Price:  95.15055914880467
PL:  [-4.91441979]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-2.66278578e-02 -6.60018439e-02]
 [-7.61848995e-03 -1.00974681e-01]
 [-3.62580447e-01 -1.45270261e-01]
 [-2.17400296e-02 -2.26743459e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.51639450e-01  6.92202133e-03]
 [ 5.44239664e-02  8.09876574e-02]
 [ 1.28771496e-01 -1.93071740e-01]
 [ 3.13894498e-02  2.92552280e-02]
 [ 9.43764561e-02 -8.40710927e-02]
 [ 1.61668409e-01 -1.06616558e-01]
 [ 6.54512435e-01 -5.67428701e-02]
 [ 5.33361348e-02  2.54162815e-01]
 [-6.90250097e-02 -1.06452981e-01]
 [ 8.51726926e-02 -1.49278324e-01]
 [ 2.92645764e-01 -2.54378572e-01]
 [ 2.93850176e-01 -1.50860231e-01]
 [-2.36492345e-01  5.99456314e-02]
 [-1.57354520e-01 -2.18556613e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.61747341]
curr_Stock_Price:  101.92643694575962
curr_Factors:  [1.01926437e+02 3.93917152e-02]
mat_Sqrt:  [[ 2.02296913e+01 -7.93180565e-03]
 [-7.93180565e-03  1.81935046e-02]]
grads:  [-2.73914678e-03 -3.62896383e+00]
Stock Position:  -0.0027391467782552454
Bond Position:  [13.89666488]


portfolio before change:  [13.630903]
curr_Stock_Price:  103.36925957125271
curr_Factors:  [1.03369260e+02 3.89660626e-02]
mat_Sqrt:  [[ 2.04049077e+01 -7.88893409e-03]
 [-7.88893409e-03  1.80948983e-02]]
grads:  [-2.53123873e-03 -5.58138809e+00]
Stock Position:  -0.002531238733343362
Bond Position:  [13.89255527]


portfolio before change:  [13.63471292]
curr_Stock_Price:  108.72894235059779
curr_Factors:  [1.08728942e+02 3.84714342e-02]
mat_Sqrt:  [[ 2.13262415e+01 -7.83904617e-03]
 [-7.83904617e-03  1.79795355e-02]]
grads:  [-0.01997475 -8.08846503]
Stock Position:  -0.019974747933795747
Bond Position:  [15.80654613]


portfolio before change:  [13.53581501]
curr_Stock_Price:  114.66986538001844
curr_Factors:  [1.14669865e+02 3.58541608e-02]
mat_Sqrt:  [[ 2.17129613e+01 -7.56802867e-03]
 [-7.56802867e-03  1.73570317e-02]]
grads:  [-0.00145679 -1.30698448]
Stock Position:  -0.0014567946388322902
Bond Position:  [13.70286546]


portfolio before change:  [13.557221]
curr_Stock_Price:  111.74103835785142
curr_Factors:  [1.11741038e+02 3.65244679e-02]
mat_Sqrt:  [[ 2.13552482e+01 -7.63828474e-03]
 [-7.63828474e-03  1.75185983e-02]]
grads:  [ 0.00767837 -6.73862534]
Stock Position:  0.007678367431029832
Bond Position:  [12.69923225]


portfolio before change:  [13.62500632]
curr_Stock_Price:  118.50046320460133
curr_Factors:  [1.18500463e+02 3.59753170e-02]
mat_Sqrt:  [[ 2.24761716e+01 -7.58100034e-03]
 [-7.58100034e-03  1.73862476e-02]]
grads:  [0.00688197 0.40113277]
Stock Position:  0.006881974415910916
Bond Position:  [12.80948916]


portfolio before change:  [13.63098973]
curr_Stock_Price:  117.0418037116775
curr_Factors:  [1.17041804e+02 3.58740906e-02]
mat_Sqrt:  [[ 2.21682510e+01 -7.57025429e-03]
 [-7.57025429e-03  1.73618016e-02]]
grads:  [4.04859734e-03 4.66646884e+00]
Stock Position:  0.004048597337340072
Bond Position:  [13.1571346]


portfolio before change:  [13.66954335]
curr_Stock_Price:  122.49972283993338
curr_Factors:  [1.22499723e+02 3.29284358e-02]
mat_Sqrt:  [[ 2.22290362e+01 -7.25305066e-03]
 [-7.25305066e-03  1.66336290e-02]]
grads:  [ 2.00590837e-03 -1.16064384e+01]
Stock Position:  0.002005908368890027
Bond Position:  [13.42382013]


portfolio before change:  [13.70037249]
curr_Stock_Price:  129.49848523831432
curr_Factors:  [1.29498485e+02 3.01023951e-02]
mat_Sqrt:  [[ 2.24680403e+01 -6.93510813e-03]
 [-6.93510813e-03  1.59037174e-02]]
grads:  [0.00196513 1.84037831]
Stock Position:  0.001965132332404877
Bond Position:  [13.44589083]


portfolio before change:  [13.71527492]
curr_Stock_Price:  128.52376937164425
curr_Factors:  [1.28523769e+02 2.89203447e-02]
mat_Sqrt:  [[ 2.18567289e+01 -6.79754535e-03]
 [-6.79754535e-03  1.55883554e-02]]
grads:  [ 2.64100701e-03 -5.39204670e+00]
Stock Position:  0.0026410070059859196
Bond Position:  [13.37584275]


portfolio before change:  [13.73230411]
curr_Stock_Price:  128.63695812057298
curr_Factors:  [1.28636958e+02 2.93063365e-02]
mat_Sqrt:  [[ 2.20214802e+01 -6.84276176e-03]
 [-6.84276176e-03  1.56920355e-02]]
grads:  [ 5.23090044e-03 -6.79202929e+00]
Stock Position:  0.005230900436817556
Bond Position:  [13.05941699]


portfolio before change:  [13.75728254]
curr_Stock_Price:  130.2894371159629
curr_Factors:  [1.30289437e+02 3.47696041e-02]
mat_Sqrt:  [[ 2.42945612e+01 -7.45340033e-03]
 [-7.45340033e-03  1.70921872e-02]]
grads:  [ 0.02592567 -3.30850785]
Stock Position:  0.02592567100515786
Bond Position:  [10.37944146]


portfolio before change:  [13.72050971]
curr_Stock_Price:  128.3702872080281
curr_Factors:  [1.28370287e+02 3.33292058e-02]
mat_Sqrt:  [[ 2.34356484e+01 -7.29730492e-03]
 [-7.29730492e-03  1.67344375e-02]]
grads:  [7.00599234e-03 1.51910657e+01]
Stock Position:  0.007005992342440098
Bond Position:  [12.82114846]


portfolio before change:  [13.71003059]
curr_Stock_Price:  124.58558827936704
curr_Factors:  [1.24585588e+02 3.76468994e-02]
mat_Sqrt:  [[ 2.41731024e+01 -7.75541789e-03]
 [-7.75541789e-03  1.77854572e-02]]
grads:  [-4.77639972e-03 -5.98747745e+00]
Stock Position:  -0.004776399718291357
Bond Position:  [14.30510116]


portfolio before change:  [13.71095784]
curr_Stock_Price:  128.13749186641445
curr_Factors:  [1.28137492e+02 3.67396359e-02]
mat_Sqrt:  [[ 2.45608630e+01 -7.66155409e-03]
 [-7.66155409e-03  1.75697737e-02]]
grads:  [ 8.17579187e-04 -8.49595806e+00]
Stock Position:  0.0008175791868451539
Bond Position:  [13.60619529]


portfolio before change:  [13.73080282]
curr_Stock_Price:  131.59478072221148
curr_Factors:  [1.31594781e+02 3.47603105e-02]
mat_Sqrt:  [[ 2.45346840e+01 -7.45245613e-03]
 [-7.45245613e-03  1.70898801e-02]]
grads:  [ 7.40755008e-03 -1.48815185e+01]
Stock Position:  0.007407550083899925
Bond Position:  [12.75600789]


portfolio before change:  [13.81814312]
curr_Stock_Price:  141.23161329003514
curr_Factors:  [1.41231613e+02 2.96061336e-02]
mat_Sqrt:  [[ 2.43009219e+01 -6.87810940e-03]
 [-6.87810940e-03  1.57719037e-02]]
grads:  [ 9.38599587e-03 -9.56103182e+00]
Stock Position:  0.009385995867843958
Bond Position:  [12.49254378]


portfolio before change:  [13.83062709]
curr_Stock_Price:  140.89691553877213
curr_Factors:  [1.40896916e+02 2.55971935e-02]
mat_Sqrt:  [[ 2.25422698e+01 -6.39548874e-03]
 [-6.39548874e-03  1.46652535e-02]]
grads:  [-0.00933252  4.08352611]
Stock Position:  -0.009332520671526451
Bond Position:  [15.14555047]


portfolio before change:  [13.86455029]
curr_Stock_Price:  139.2918379386808
curr_Factors:  [1.39291838e+02 2.41678637e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.86455029]
Stock Price:  140.0470126946251
PL:  [-26.1824624]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.40710145e-01 -1.42926567e-02]
 [-1.12811745e-01  7.56135643e-02]
 [ 4.07884632e-02  1.05215684e-01]
 [-4.22316357e-01 -2.20554629e-01]
 [ 5.77847621e-01  6.05299649e-02]
 [-6.31898245e-02 -4.80731112e-01]
 [-5.00156911e-01 -4.80922231e-01]
 [ 3.33575444e-02 -1.12275290e-02]
 [-2.16171243e-01 -1.68637153e-01]
 [ 8.41107139e-02  4.10373688e-01]
 [ 2.10982289e-02 -8.80183828e-02]
 [ 2.80022180e-02 -1.08257766e-01]
 [-1.98566661e-01 -1.02723124e-01]
 [-3.89996701e-03  1.53856712e-01]
 [-1.07123883e-01  1.46510450e-01]
 [-1.92939315e-01  8.86849731e-02]
 [-1.00264216e-01  1.87364887e-01]
 [ 5.03632643e-02 -1.44682270e-01]
 [ 5.36573827e-02  5.75733138e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.44796074]
curr_Stock_Price:  94.95951462581674
curr_Factors:  [9.49595146e+01 4.51794519e-02]
mat_Sqrt:  [[ 2.01840785e+01 -8.49398459e-03]
 [-8.49398459e-03  1.94845258e-02]]
grads:  [ 0.00666387 -0.73063384]
Stock Position:  0.006663873848104641
Bond Position:  [-13.08075896]


portfolio before change:  [-12.47376407]
curr_Stock_Price:  93.54259636006793
curr_Factors:  [9.35425964e+01 4.60114398e-02]
mat_Sqrt:  [[ 2.00651445e+01 -8.57171173e-03]
 [-8.57171173e-03  1.96631675e-02]]
grads:  [-0.00398027  3.8437066 ]
Stock Position:  -0.003980265382601112
Bond Position:  [-12.10143972]


portfolio before change:  [-12.47496375]
curr_Stock_Price:  90.04117662651856
curr_Factors:  [9.00411766e+01 4.89044031e-02]
mat_Sqrt:  [[ 1.99120099e+01 -8.83674032e-03]
 [-8.83674032e-03  2.02720510e-02]]
grads:  [4.35262648e-03 5.19208179e+00]
Stock Position:  0.004352626478936913
Bond Position:  [-12.86687936]


portfolio before change:  [-12.48636612]
curr_Stock_Price:  91.11898185660912
curr_Factors:  [9.11189819e+01 5.15802376e-02]
mat_Sqrt:  [[ 2.06942879e+01 -9.07538391e-03]
 [-9.07538391e-03  2.08192167e-02]]
grads:  [ -0.02505804 -10.60472372]
Stock Position:  -0.02505804014399553
Bond Position:  [-10.20310302]


portfolio before change:  [-12.407967]
curr_Stock_Price:  87.48098889553557
curr_Factors:  [8.74809889e+01 5.17717473e-02]
mat_Sqrt:  [[ 1.99049023e+01 -9.09183607e-03]
 [-9.09183607e-03  2.08579958e-02]]
grads:  [0.03036199 2.91523748]
Stock Position:  0.030361991922633908
Bond Position:  [-15.06406408]


portfolio before change:  [-12.51785188]
curr_Stock_Price:  84.48240357421986
curr_Factors:  [8.44824036e+01 5.33026898e-02]
mat_Sqrt:  [[ 1.95047674e+01 -9.22494132e-03]
 [-9.22494132e-03  2.11642944e-02]]
grads:  [-1.39854884e-02 -2.27203477e+01]
Stock Position:  -0.01398548844633834
Bond Position:  [-11.3363242]


portfolio before change:  [-12.52220914]
curr_Stock_Price:  83.78010364793654
curr_Factors:  [8.37801036e+01 5.60157734e-02]
mat_Sqrt:  [[ 1.98287808e+01 -9.45671438e-03]
 [-9.45671438e-03  2.16962736e-02]]
grads:  [ -0.03580266 -22.18172647]
Stock Position:  -0.0358026632681455
Bond Position:  [-9.5226583]


portfolio before change:  [-12.64552905]
curr_Stock_Price:  86.89185948414126
curr_Factors:  [8.68918595e+01 5.04412570e-02]
mat_Sqrt:  [[ 1.95151546e+01 -8.97418573e-03]
 [-8.97418573e-03  2.05882627e-02]]
grads:  [ 0.00145883 -0.54470051]
Stock Position:  0.0014588304035287982
Bond Position:  [-12.77228954]


portfolio before change:  [-12.66517773]
curr_Stock_Price:  84.3738610718027
curr_Factors:  [8.43738611e+01 5.18513527e-02]
mat_Sqrt:  [[ 1.92126787e+01 -9.09847256e-03]
 [-9.09847256e-03  2.08741784e-02]]
grads:  [-0.01508042 -8.0853176 ]
Stock Position:  -0.01508042097350791
Bond Position:  [-11.39278438]


portfolio before change:  [-12.68533862]
curr_Stock_Price:  84.76582675332618
curr_Factors:  [8.47658268e+01 4.71929629e-02]
mat_Sqrt:  [[ 1.84144765e+01 -8.68019029e-03]
 [-8.68019029e-03  1.99144150e-02]]
grads:  [1.42842116e-02 2.06130924e+01]
Stock Position:  0.01428421161570239
Bond Position:  [-13.89615163]


portfolio before change:  [-12.70942758]
curr_Stock_Price:  84.29622347428628
curr_Factors:  [8.42962235e+01 5.19695297e-02]
mat_Sqrt:  [[ 1.92168616e+01 -9.10882595e-03]
 [-9.10882595e-03  2.08979565e-02]]
grads:  [-8.98692701e-04 -4.21220939e+00]
Stock Position:  -0.0008986927010798221
Bond Position:  [-12.63367118]


portfolio before change:  [-12.72540112]
curr_Stock_Price:  84.48713948346608
curr_Factors:  [8.44871395e+01 5.13023741e-02]
mat_Sqrt:  [[ 1.91363581e+01 -9.05019231e-03]
 [-9.05019231e-03  2.07633755e-02]]
grads:  [-1.00271755e-03 -5.21431793e+00]
Stock Position:  -0.0010027175455888477
Bond Position:  [-12.64068438]


portfolio before change:  [-12.73842554]
curr_Stock_Price:  81.70837851904064
curr_Factors:  [8.17083785e+01 5.84425693e-02]
mat_Sqrt:  [[ 1.97529148e+01 -9.65912349e-03]
 [-9.65912349e-03  2.21613859e-02]]
grads:  [-0.01232177 -4.64060063]
Stock Position:  -0.012321766097684001
Bond Position:  [-11.73163402]


portfolio before change:  [-12.81011139]
curr_Stock_Price:  86.33532348434565
curr_Factors:  [8.63353235e+01 5.99517044e-02]
mat_Sqrt:  [[ 2.11392338e+01 -9.78362774e-03]
 [-9.78362774e-03  2.24454377e-02]]
grads:  [2.98859453e-03 6.85600139e+00]
Stock Position:  0.0029885945295790783
Bond Position:  [-13.06813267]


portfolio before change:  [-12.83077839]
curr_Stock_Price:  84.88928437392403
curr_Factors:  [8.48892844e+01 6.00244610e-02]
mat_Sqrt:  [[ 2.07977790e+01 -9.78938571e-03]
 [-9.78938571e-03  2.24591304e-02]]
grads:  [-2.08062787e-03  6.52251798e+00]
Stock Position:  -0.00208062786825441
Bond Position:  [-12.65415538]


portfolio before change:  [-12.84151917]
curr_Stock_Price:  82.44444363876462
curr_Factors:  [8.24444436e+01 5.73524382e-02]
mat_Sqrt:  [[ 1.97440973e+01 -9.56870920e-03]
 [-9.56870920e-03  2.19536827e-02]]
grads:  [-0.00781589  4.03623329]
Stock Position:  -0.007815894034515797
Bond Position:  [-12.19714214]


portfolio before change:  [-12.87215142]
curr_Stock_Price:  84.41175278689468
curr_Factors:  [8.44117528e+01 5.87441451e-02]
mat_Sqrt:  [[ 2.04590359e+01 -9.68436054e-03]
 [-9.68436054e-03  2.22183395e-02]]
grads:  [-9.09176512e-04  8.43249703e+00]
Stock Position:  -0.000909176512393521
Bond Position:  [-12.79540623]


portfolio before change:  [-12.88715717]
curr_Stock_Price:  83.3135070115831
curr_Factors:  [8.33135070e+01 5.46597476e-02]
mat_Sqrt:  [[ 1.94782160e+01 -9.34149222e-03]
 [-9.34149222e-03  2.14320787e-02]]
grads:  [-6.52078348e-04 -6.75101854e+00]
Stock Position:  -0.0006520783482920731
Bond Position:  [-12.83283024]


portfolio before change:  [-12.90502021]
curr_Stock_Price:  86.09226418853108
curr_Factors:  [8.60922642e+01 5.25646221e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.90502021]
Stock Price:  85.02266031644889
PL:  [-12.90502021]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.46881699e-01 -9.41707739e-03]
 [ 2.70522805e-02 -5.29912898e-02]
 [ 6.70162204e-02  4.31242749e-02]
 [-1.47259496e-02 -4.34988946e-03]
 [-2.09427049e-01 -8.26169001e-03]
 [ 2.23842537e-03 -2.35262682e-01]
 [-2.47781388e-01 -2.96284809e-01]
 [ 3.33594376e-02 -1.12193119e-02]
 [-2.04032686e-01 -1.59536433e-01]
 [ 9.25080693e-02  4.46386726e-01]
 [-8.63138042e-02 -6.15892641e-02]
 [ 2.55270368e-02 -9.88423037e-02]
 [-1.63720272e-01 -1.18718183e-01]
 [-2.45100270e-03  1.48919234e-01]
 [-9.47115212e-02  2.65945018e-01]
 [-1.19956176e-01  4.98928413e-02]
 [-9.31261347e-02  1.64893881e-01]
 [ 8.87232580e-02 -1.24860759e-01]
 [ 8.63186500e-02  5.79026429e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.10198846]
curr_Stock_Price:  95.586559874869
curr_Factors:  [9.55865599e+01 4.25234296e-02]
mat_Sqrt:  [[ 1.97111034e+01 -8.24058188e-03]
 [-8.24058188e-03  1.89030978e-02]]
grads:  [ 0.00724477 -0.49501814]
Stock Position:  0.007244772603704122
Bond Position:  [-10.79449135]


portfolio before change:  [-10.08463548]
curr_Stock_Price:  99.84542685658504
curr_Factors:  [9.98454269e+01 3.83214166e-02]
mat_Sqrt:  [[ 1.95455961e+01 -7.82316091e-03]
 [-7.82316091e-03  1.79447017e-02]]
grads:  [ 2.02138651e-04 -2.95294451e+00]
Stock Position:  0.00020213865077878582
Bond Position:  [-10.1048181]


portfolio before change:  [-10.09742631]
curr_Stock_Price:  99.09394269567314
curr_Factors:  [9.90939427e+01 3.81476781e-02]
mat_Sqrt:  [[ 1.93544631e+01 -7.80535247e-03]
 [-7.80535247e-03  1.79040011e-02]]
grads:  [0.00443472 2.41057232]
Stock Position:  0.004434718067398011
Bond Position:  [-10.53688001]


portfolio before change:  [-10.10513949]
curr_Stock_Price:  100.32652592352655
curr_Factors:  [1.00326526e+02 3.77109707e-02]
mat_Sqrt:  [[ 1.94827203e+01 -7.76063489e-03]
 [-7.76063489e-03  1.78011869e-02]]
grads:  [-0.00085333 -0.24473154]
Stock Position:  -0.0008533316441704009
Bond Position:  [-10.01952769]


portfolio before change:  [-10.11534952]
curr_Stock_Price:  97.60518864198818
curr_Factors:  [9.76051886e+01 4.53956123e-02]
mat_Sqrt:  [[ 2.07960000e+01 -8.51450259e-03]
 [-8.51450259e-03  1.95309848e-02]]
grads:  [-0.01024556 -0.42747081]
Stock Position:  -0.010245564069132195
Bond Position:  [-9.11532931]


portfolio before change:  [-10.04642025]
curr_Stock_Price:  89.76466828133859
curr_Factors:  [8.97646683e+01 4.65397066e-02]
mat_Sqrt:  [[ 1.93649869e+01 -8.62042290e-03]
 [-8.62042290e-03  1.97758786e-02]]
grads:  [-5.18117798e-03 -1.18987050e+01]
Stock Position:  -0.005181177978950804
Bond Position:  [-9.58133353]


portfolio before change:  [-10.05619157]
curr_Stock_Price:  89.33757593855283
curr_Factors:  [8.93375759e+01 4.24268769e-02]
mat_Sqrt:  [[ 1.84015605e+01 -8.23066954e-03]
 [-8.23066954e-03  1.88818656e-02]]
grads:  [ -0.02048774 -15.7004315 ]
Stock Position:  -0.020487743520281335
Bond Position:  [-8.22586623]


portfolio before change:  [-10.01585447]
curr_Stock_Price:  86.86654449559948
curr_Factors:  [8.68665445e+01 4.81818661e-02]
mat_Sqrt:  [[ 1.90675243e+01 -8.77089229e-03]
 [-8.77089229e-03  2.01218814e-02]]
grads:  [ 0.00149337 -0.5569168 ]
Stock Position:  0.001493365363404688
Bond Position:  [-10.14557796]


portfolio before change:  [-10.03130759]
curr_Stock_Price:  85.01621534995706
curr_Factors:  [8.50162153e+01 4.64341746e-02]
mat_Sqrt:  [[ 1.83197939e+01 -8.61015303e-03]
 [-8.61015303e-03  1.97536582e-02]]
grads:  [-0.01493613 -8.08280848]
Stock Position:  -0.014936134365662736
Bond Position:  [-8.76149398]


portfolio before change:  [-10.01605671]
curr_Stock_Price:  83.26143748461863
curr_Factors:  [8.32614375e+01 4.73684269e-02]
mat_Sqrt:  [[ 1.81212577e+01 -8.69614210e-03]
 [-8.69614210e-03  1.99514757e-02]]
grads:  [1.58450538e-02 2.23805259e+01]
Stock Position:  0.01584505379415411
Bond Position:  [-11.33533867]


portfolio before change:  [-10.05542844]
curr_Stock_Price:  81.67143344904828
curr_Factors:  [8.16714334e+01 5.17564912e-02]
mat_Sqrt:  [[ 1.85802922e+01 -9.08981954e-03]
 [-9.08981954e-03  2.08552174e-02]]
grads:  [-0.0060915  -2.95583755]
Stock Position:  -0.006091499157257685
Bond Position:  [-9.55792697]


portfolio before change:  [-10.08912708]
curr_Stock_Price:  85.24095845501773
curr_Factors:  [8.52409585e+01 4.79906710e-02]
mat_Sqrt:  [[ 1.86735413e+01 -8.75329671e-03]
 [-8.75329671e-03  2.00819946e-02]]
grads:  [-9.40353089e-04 -4.92234646e+00]
Stock Position:  -0.0009403530885681311
Bond Position:  [-10.00897048]


portfolio before change:  [-10.10286853]
curr_Stock_Price:  86.54091687104359
curr_Factors:  [8.65409169e+01 4.58444881e-02]
mat_Sqrt:  [[ 1.85295559e+01 -8.55546878e-03]
 [-8.55546878e-03  1.96277568e-02]]
grads:  [-0.01163068 -6.05355416]
Stock Position:  -0.011630676268891551
Bond Position:  [-9.09633915]


portfolio before change:  [-10.07762626]
curr_Stock_Price:  83.39236352133928
curr_Factors:  [8.33923635e+01 4.87817320e-02]
mat_Sqrt:  [[ 1.84185247e+01 -8.82493478e-03]
 [-8.82493478e-03  2.02469219e-02]]
grads:  [3.39173748e-03 7.35663263e+00]
Stock Position:  0.003391737475368544
Bond Position:  [-10.36047127]


portfolio before change:  [-10.10793105]
curr_Stock_Price:  78.27814081785196
curr_Factors:  [7.82781408e+01 5.47922726e-02]
mat_Sqrt:  [[ 1.83231485e+01 -9.35214858e-03]
 [-9.35214858e-03  2.14583327e-02]]
grads:  [1.15698229e-03 1.23940588e+01]
Stock Position:  0.0011569822897699175
Bond Position:  [-10.19849747]


portfolio before change:  [-10.1102933]
curr_Stock_Price:  87.26171716439987
curr_Factors:  [8.72617172e+01 5.14208590e-02]
mat_Sqrt:  [[ 1.97876114e+01 -9.06094944e-03]
 [-9.06094944e-03  2.07872025e-02]]
grads:  [-0.00496411  2.39800723]
Stock Position:  -0.004964113726758959
Bond Position:  [-9.67711622]


portfolio before change:  [-10.11611949]
curr_Stock_Price:  85.99708507513559
curr_Factors:  [8.59970851e+01 4.74274078e-02]
mat_Sqrt:  [[ 1.87283009e+01 -8.70185886e-03]
 [-8.70185886e-03  1.99637604e-02]]
grads:  [-1.13496899e-03  8.25916566e+00]
Stock Position:  -0.001134968993175603
Bond Position:  [-10.01851546]


portfolio before change:  [-10.12951267]
curr_Stock_Price:  86.75676484572583
curr_Factors:  [8.67567648e+01 4.91665634e-02]
mat_Sqrt:  [[ 1.92370392e+01 -8.86005295e-03]
 [-8.86005295e-03  2.03264629e-02]]
grads:  [ 1.78327286e-03 -6.14199131e+00]
Stock Position:  0.0017832728567809533
Bond Position:  [-10.28422366]


portfolio before change:  [-10.13938036]
curr_Stock_Price:  88.43661325488102
curr_Factors:  [8.84366133e+01 5.08796319e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.13938036]
Stock Price:  89.2709546065022
PL:  [-10.13938036]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 4.80087190e-02 -3.00111623e-02]
 [ 2.33027724e-02 -6.37970969e-02]
 [ 6.27340400e-02 -1.67050097e-01]
 [-2.08611727e-02 -2.02855649e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-2.26187563e-01  4.54293800e-02]
 [ 5.27416016e-02  4.13018696e-02]
 [ 5.93562454e-02 -2.36346613e-02]
 [ 5.92953712e-02 -1.12327698e-01]
 [-1.06495581e-02  2.80850261e-02]
 [-1.10481603e-01 -1.40966945e-01]
 [ 3.70488761e-03  1.63857371e-01]
 [-9.58964320e-02  2.95608016e-02]
 [ 4.14366499e-02 -3.15383399e-02]
 [-5.55848545e-02  6.07867199e-02]
 [ 1.13347262e-01 -4.77569521e-02]
 [ 1.34381011e-01  7.55095336e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.04538892]
curr_Stock_Price:  104.44638557194833
curr_Factors:  [1.04446386e+02 3.45758816e-02]
mat_Sqrt:  [[ 1.94213768e+01 -7.43131491e-03]
 [-7.43131491e-03  1.70450689e-02]]
grads:  [ 0.00179855 -1.75991055]
Stock Position:  0.0017985475370087779
Bond Position:  [22.85753713]


portfolio before change:  [23.06837]
curr_Stock_Price:  101.3279224367996
curr_Factors:  [1.01327922e+02 3.37856439e-02]
mat_Sqrt:  [[ 1.86249538e+01 -7.34570383e-03]
 [-7.34570383e-03  1.68492455e-02]]
grads:  [-2.42222877e-04 -3.78645300e+00]
Stock Position:  -0.00024222287656871933
Bond Position:  [23.09291394]


portfolio before change:  [23.09682084]
curr_Stock_Price:  103.11698857737935
curr_Factors:  [1.03116989e+02 3.13402419e-02]
mat_Sqrt:  [[ 1.82549800e+01 -7.07498130e-03]
 [-7.07498130e-03  1.62279715e-02]]
grads:  [-5.53122704e-04 -1.02942016e+01]
Stock Position:  -0.0005531227042241682
Bond Position:  [23.15385719]


portfolio before change:  [23.12576311]
curr_Stock_Price:  103.14979833031757
curr_Factors:  [1.03149798e+02 2.84259275e-02]
mat_Sqrt:  [[ 1.73910447e+01 -6.73800872e-03]
 [-6.73800872e-03  1.54550481e-02]]
grads:  [-0.00170836 -1.31329748]
Stock Position:  -0.0017083609987710315
Bond Position:  [23.3019802]


portfolio before change:  [23.14519947]
curr_Stock_Price:  108.83321684131303
curr_Factors:  [1.08833217e+02 2.64375008e-02]
mat_Sqrt:  [[ 1.76958584e+01 -6.49837221e-03]
 [-6.49837221e-03  1.49045686e-02]]
grads:  [ 0.00926632 -7.92037036]
Stock Position:  0.009266318863737357
Bond Position:  [22.13671618]


portfolio before change:  [23.15943272]
curr_Stock_Price:  107.38119055117237
curr_Factors:  [1.07381191e+02 2.98589025e-02]
mat_Sqrt:  [[ 1.85551772e+01 -6.90599664e-03]
 [-6.90599664e-03  1.58397044e-02]]
grads:  [0.00932201 6.70940164]
Stock Position:  0.00932200602356286
Bond Position:  [22.15842462]


portfolio before change:  [23.20633411]
curr_Stock_Price:  109.43933568293176
curr_Factors:  [1.09439336e+02 3.03561408e-02]
mat_Sqrt:  [[ 1.90676292e+01 -6.96337345e-03]
 [-6.96337345e-03  1.59709999e-02]]
grads:  [4.70687588e-03 5.07297187e+00]
Stock Position:  0.004706875876529584
Bond Position:  [22.69121675]


portfolio before change:  [23.23547187]
curr_Stock_Price:  109.59995086410014
curr_Factors:  [1.09599951e+02 3.26637988e-02]
mat_Sqrt:  [[ 1.98081391e+01 -7.22321076e-03]
 [-7.22321076e-03  1.65669314e-02]]
grads:  [-0.01042062  2.73762888]
Stock Position:  -0.010420620112676948
Bond Position:  [24.37757132]


portfolio before change:  [23.26136208]
curr_Stock_Price:  110.04146083497895
curr_Factors:  [1.10041461e+02 3.53930820e-02]
mat_Sqrt:  [[ 2.07021528e+01 -7.51895678e-03]
 [-7.51895678e-03  1.72451764e-02]]
grads:  [0.00341803 2.39647126]
Stock Position:  0.0034180293269531815
Bond Position:  [22.88523713]


portfolio before change:  [23.25171372]
curr_Stock_Price:  98.84413485575371
curr_Factors:  [9.88441349e+01 3.72532249e-02]
mat_Sqrt:  [[ 1.90779983e+01 -7.71328516e-03]
 [-7.71328516e-03  1.76928653e-02]]
grads:  [ 0.00257161 -1.33470896]
Stock Position:  0.00257161437097384
Bond Position:  [22.99752472]


portfolio before change:  [23.27360542]
curr_Stock_Price:  96.17142290766975
curr_Factors:  [9.61714229e+01 3.48819764e-02]
mat_Sqrt:  [[ 1.79616631e+01 -7.46357342e-03]
 [-7.46357342e-03  1.71205968e-02]]
grads:  [ 5.75056531e-04 -6.56071787e+00]
Stock Position:  0.0005750565308193728
Bond Position:  [23.21830141]


portfolio before change:  [23.30257408]
curr_Stock_Price:  96.04560216653782
curr_Factors:  [9.60456022e+01 3.52977407e-02]
mat_Sqrt:  [[ 1.80447513e+01 -7.50791211e-03]
 [-7.50791211e-03  1.72223303e-02]]
grads:  [8.83432876e-05 1.63077173e+00]
Stock Position:  8.83432876040109e-05
Bond Position:  [23.2940891]


portfolio before change:  [23.33152888]
curr_Stock_Price:  93.99651848947538
curr_Factors:  [9.39965185e+01 3.40464567e-02]
mat_Sqrt:  [[ 1.73439371e+01 -7.37348259e-03]
 [-7.37348259e-03  1.69143821e-02]]
grads:  [-0.009915   -8.33846916]
Stock Position:  -0.009915001359492092
Bond Position:  [24.26350449]


portfolio before change:  [23.39438475]
curr_Stock_Price:  90.7178980168328
curr_Factors:  [9.07178980e+01 3.67758641e-02]
mat_Sqrt:  [[ 1.73970006e+01 -7.66307100e-03]
 [-7.66307100e-03  1.75794193e-02]]
grads:  [4.31951633e-03 9.32286035e+00]
Stock Position:  0.004319516334644825
Bond Position:  [23.00252731]


portfolio before change:  [23.42297265]
curr_Stock_Price:  90.6754773823865
curr_Factors:  [9.06754774e+01 4.11616320e-02]
mat_Sqrt:  [[ 1.83965380e+01 -8.10713667e-03]
 [-8.10713667e-03  1.85981358e-02]]
grads:  [-0.00451316  1.58748238]
Stock Position:  -0.00451315869495111
Bond Position:  [23.83220547]


portfolio before change:  [23.42747728]
curr_Stock_Price:  96.28224918314662
curr_Factors:  [9.62822492e+01 3.87791237e-02]
mat_Sqrt:  [[ 1.89602991e+01 -7.86947462e-03]
 [-7.86947462e-03  1.80516649e-02]]
grads:  [ 1.46056668e-03 -1.74647857e+00]
Stock Position:  0.0014605666772367805
Bond Position:  [23.28685064]


portfolio before change:  [23.45221461]
curr_Stock_Price:  93.27694898114673
curr_Factors:  [9.32769490e+01 4.27025077e-02]
mat_Sqrt:  [[ 1.92752927e+01 -8.25771946e-03]
 [-8.25771946e-03  1.89429445e-02]]
grads:  [-1.50927846e-03  3.20827930e+00]
Stock Position:  -0.0015092784603446773
Bond Position:  [23.5929955]


portfolio before change:  [23.48051282]
curr_Stock_Price:  94.07963001639662
curr_Factors:  [9.4079630e+01 4.2463103e-02]
mat_Sqrt:  [[ 1.93865900e+01 -8.23460812e-03]
 [-8.23460812e-03  1.88897395e-02]]
grads:  [ 0.0047737  -2.52611437]
Stock Position:  0.004773696688683148
Bond Position:  [23.0314052]


portfolio before change:  [23.50459936]
curr_Stock_Price:  93.09072710606394
curr_Factors:  [9.30907271e+01 4.68093480e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.50459936]
Stock Price:  90.26271863049979
PL:  [23.50459936]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-3.03020677e-02 -7.06905091e-02]
 [-1.54228434e-02 -1.10358095e-01]
 [-7.35246020e-01  2.05374470e-02]
 [-2.21833249e-02 -2.38792470e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-1.21923945e-01  4.05326537e-02]
 [ 5.09628509e-02  4.04866900e-02]
 [ 7.87473078e-02 -6.12716889e-02]
 [ 1.18769118e-01 -1.13454149e-01]
 [ 4.67791084e-01 -3.02345955e-02]
 [ 2.35540329e-02  1.89750505e-01]
 [-6.47913508e-02 -1.13756083e-01]
 [ 4.79024765e-02 -1.35716526e-01]
 [ 2.41962419e-01 -1.92123192e-01]
 [ 1.43680592e-01 -1.49541019e-01]
 [-1.20035302e-01  4.60393816e-02]
 [-9.60839343e-02 -9.51766200e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.95106635]
curr_Stock_Price:  100.144600513859
curr_Factors:  [1.00144601e+02 4.34109658e-02]
mat_Sqrt:  [[ 2.08654246e+01 -8.32649834e-03]
 [-8.32649834e-03  1.90991906e-02]]
grads:  [-2.92977471e-03 -3.70250788e+00]
Stock Position:  -0.002929774709735559
Bond Position:  [7.24446746]


portfolio before change:  [6.94910336]
curr_Stock_Price:  103.90742751822306
curr_Factors:  [1.03907428e+02 4.35946705e-02]
mat_Sqrt:  [[ 2.16951801e+01 -8.34437395e-03]
 [-8.34437395e-03  1.91394391e-02]]
grads:  [-2.92909292e-03 -5.76728170e+00]
Stock Position:  -0.0029290929182009
Bond Position:  [7.25345787]


portfolio before change:  [6.92954963]
curr_Stock_Price:  113.68049292465113
curr_Factors:  [1.13680493e+02 4.00115865e-02]
mat_Sqrt:  [[ 2.27393899e+01 -7.99471258e-03]
 [-7.99471258e-03  1.83357693e-02]]
grads:  [-0.03194469  1.10614712]
Stock Position:  -0.031944687015989987
Bond Position:  [10.5610374]


portfolio before change:  [6.944853]
curr_Stock_Price:  113.61494780716201
curr_Factors:  [1.13614948e+02 3.55167445e-02]
mat_Sqrt:  [[ 2.14117430e+01 -7.53227803e-03]
 [-7.53227803e-03  1.72751912e-02]]
grads:  [-0.00152253 -1.38294939]
Stock Position:  -0.0015225329490874259
Bond Position:  [7.1178355]


portfolio before change:  [6.95511418]
curr_Stock_Price:  112.72280095229559
curr_Factors:  [1.12722801e+02 3.94571023e-02]
mat_Sqrt:  [[ 2.23910437e+01 -7.93906924e-03]
 [-7.93906924e-03  1.82083004e-02]]
grads:  [ 0.00732314 -6.48340473]
Stock Position:  0.007323141536342906
Bond Position:  [6.12962916]


portfolio before change:  [6.9313683]
curr_Stock_Price:  108.43328770211453
curr_Factors:  [1.08433288e+02 4.51729803e-02]
mat_Sqrt:  [[ 2.30463402e+01 -8.49439415e-03]
 [-8.49439415e-03  1.94826865e-02]]
grads:  [0.00750539 5.45480804]
Stock Position:  0.007505385063192075
Bond Position:  [6.11753472]


portfolio before change:  [6.94845364]
curr_Stock_Price:  109.69020510674046
curr_Factors:  [1.09690205e+02 4.43857380e-02]
mat_Sqrt:  [[ 2.31094464e+01 -8.42013321e-03]
 [-8.42013321e-03  1.93121396e-02]]
grads:  [3.88365044e-03 4.19530719e+00]
Stock Position:  0.0038836504412893182
Bond Position:  [6.52245523]


portfolio before change:  [6.96787463]
curr_Stock_Price:  112.59026582235752
curr_Factors:  [1.12590266e+02 4.65744173e-02]
mat_Sqrt:  [[ 2.42982240e+01 -8.62542087e-03]
 [-8.62542087e-03  1.97824743e-02]]
grads:  [-0.00429115  2.0470463 ]
Stock Position:  -0.0042911493834443485
Bond Position:  [7.45101628]


portfolio before change:  [6.97592535]
curr_Stock_Price:  112.88596152117562
curr_Factors:  [1.12885962e+02 4.59062127e-02]
mat_Sqrt:  [[ 2.41866456e+01 -8.56334099e-03]
 [-8.56334099e-03  1.96400437e-02]]
grads:  [0.00283736 2.06267296]
Stock Position:  0.002837360082695332
Bond Position:  [6.65562723]


portfolio before change:  [7.00729672]
curr_Stock_Price:  121.00852193714691
curr_Factors:  [1.21008522e+02 4.01692121e-02]
mat_Sqrt:  [[ 2.42528393e+01 -8.01083553e-03]
 [-8.01083553e-03  1.83716803e-02]]
grads:  [ 2.14563476e-03 -3.33418064e+00]
Stock Position:  0.002145634760463007
Bond Position:  [6.74765663]


portfolio before change:  [7.0213256]
curr_Stock_Price:  123.61336405436845
curr_Factors:  [1.23613364e+02 3.69884706e-02]
mat_Sqrt:  [[ 2.37737992e+01 -7.68725474e-03]
 [-7.68725474e-03  1.76292603e-02]]
grads:  [ 2.91527265e-03 -6.43428801e+00]
Stock Position:  0.002915272653375542
Bond Position:  [6.66095894]


portfolio before change:  [7.02956643]
curr_Stock_Price:  123.58229459179348
curr_Factors:  [1.23582295e+02 3.86815516e-02]
mat_Sqrt:  [[ 2.43057023e+01 -7.86121996e-03]
 [-7.86121996e-03  1.80282206e-02]]
grads:  [ 0.01870637 -1.6689135 ]
Stock Position:  0.018706367008444826
Bond Position:  [4.71779067]


portfolio before change:  [7.00061711]
curr_Stock_Price:  121.71927939767815
curr_Factors:  [1.21719279e+02 3.76013547e-02]
mat_Sqrt:  [[ 2.36026679e+01 -7.75059108e-03]
 [-7.75059108e-03  1.77747541e-02]]
grads:  [4.50410936e-03 1.06772456e+01]
Stock Position:  0.0045041093555595125
Bond Position:  [6.45238017]


portfolio before change:  [7.01716107]
curr_Stock_Price:  123.6005481264527
curr_Factors:  [1.23600548e+02 3.44880311e-02]
mat_Sqrt:  [[ 2.29537990e+01 -7.42287682e-03]
 [-7.42287682e-03  1.70229613e-02]]
grads:  [-4.98440024e-03 -6.68468192e+00]
Stock Position:  -0.004984400237593831
Bond Position:  [7.63323567]


portfolio before change:  [7.02868306]
curr_Stock_Price:  123.204415568789
curr_Factors:  [1.23204416e+02 3.37562735e-02]
mat_Sqrt:  [[ 2.26361988e+01 -7.34368883e-03]
 [-7.34368883e-03  1.68414064e-02]]
grads:  [-4.98239936e-04 -8.05872036e+00]
Stock Position:  -0.0004982399357388987
Bond Position:  [7.09006842]


portfolio before change:  [7.03731224]
curr_Stock_Price:  123.683998954267
curr_Factors:  [1.23683999e+02 3.60975425e-02]
mat_Sqrt:  [[ 2.34991587e+01 -7.59411357e-03]
 [-7.59411357e-03  1.74156500e-02]]
grads:  [ 6.73254660e-03 -1.10287049e+01]
Stock Position:  0.006732546596510186
Bond Position:  [6.20460396]


portfolio before change:  [7.03304015]
curr_Stock_Price:  121.89675585134144
curr_Factors:  [1.21896756e+02 3.82304530e-02]
mat_Sqrt:  [[ 2.38339951e+01 -7.81516724e-03]
 [-7.81516724e-03  1.79228260e-02]]
grads:  [ 3.29299087e-03 -8.34217125e+00]
Stock Position:  0.0032929908739496062
Bond Position:  [6.63163524]


portfolio before change:  [7.04046405]
curr_Stock_Price:  121.63230702467236
curr_Factors:  [1.21632307e+02 3.41837682e-02]
mat_Sqrt:  [[ 2.24884171e+01 -7.38997233e-03]
 [-7.38997233e-03  1.69477429e-02]]
grads:  [-0.0044456   2.71461096]
Stock Position:  -0.0044455953329726626
Bond Position:  [7.58119206]


portfolio before change:  [7.07715417]
curr_Stock_Price:  115.51215788927104
curr_Factors:  [1.15512158e+02 3.88871963e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.07715417]
Stock Price:  118.54907112831143
PL:  [-11.47191696]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-3.12060281e-02 -6.81755305e-02]
 [ 2.22353230e-03  5.09937105e-02]
 [ 5.20340920e-02  8.76548150e-02]
 [-8.86486588e-02 -4.58476743e-02]
 [-2.09369270e-01 -8.24188586e-03]
 [ 1.27252440e-01  1.25712419e-01]
 [ 2.60864717e-02  4.43608657e-02]
 [-2.89801935e-01  5.95443756e-02]
 [ 5.29719533e-02  4.14075963e-02]
 [ 6.14715169e-02 -3.90793714e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 1.63293020e-01  1.29920376e-02]
 [ 2.52115011e-02  9.09511693e-02]
 [-5.37006465e-02 -1.32887654e-01]
 [ 3.50509970e-02 -1.31040180e-01]
 [ 2.29218482e-01 -1.76469557e-01]
 [ 1.29171100e-01 -1.49050052e-01]
 [-9.24042636e-02  4.31966837e-02]
 [-9.96112564e-02 -1.02328372e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.06065415]
curr_Stock_Price:  101.77760702222093
curr_Factors:  [1.01777607e+02 4.00103195e-02]
mat_Sqrt:  [[ 2.03581454e+01 -7.99383276e-03]
 [-7.99383276e-03  1.83358074e-02]]
grads:  [-2.99333934e-03 -3.71946854e+00]
Stock Position:  -0.0029933393425306265
Bond Position:  [13.36530906]


portfolio before change:  [13.09234201]
curr_Stock_Price:  96.77624293044263
curr_Factors:  [9.67762429e+01 4.17793568e-02]
mat_Sqrt:  [[ 1.97810616e+01 -8.16826328e-03]
 [-8.16826328e-03  1.87369433e-02]]
grads:  [1.23645293e-03 2.72209876e+00]
Stock Position:  0.0012364529338221096
Bond Position:  [12.97268274]


portfolio before change:  [13.10615721]
curr_Stock_Price:  94.82647866313069
curr_Factors:  [9.48264787e+01 4.28772796e-02]
mat_Sqrt:  [[ 1.96355557e+01 -8.27473346e-03]
 [-8.27473346e-03  1.89816117e-02]]
grads:  [4.59688567e-03 4.61988447e+00]
Stock Position:  0.004596885668017183
Bond Position:  [12.67025073]


portfolio before change:  [13.12165811]
curr_Stock_Price:  94.75103421309743
curr_Factors:  [9.47510342e+01 4.18910504e-02]
mat_Sqrt:  [[ 1.93929798e+01 -8.17900913e-03]
 [-8.17900913e-03  1.87620445e-02]]
grads:  [-0.00560281 -2.44608202]
Stock Position:  -0.005602810242400306
Bond Position:  [13.65253018]


portfolio before change:  [13.12272429]
curr_Stock_Price:  97.60855762459761
curr_Factors:  [9.76085576e+01 3.85576920e-02]
mat_Sqrt:  [[ 1.91665247e+01 -7.84707623e-03]
 [-7.84707623e-03  1.80000087e-02]]
grads:  [-0.01111314 -0.46272708]
Stock Position:  -0.01111314273215817
Bond Position:  [14.20746212]


portfolio before change:  [13.09924663]
curr_Stock_Price:  101.320206708648
curr_Factors:  [1.01320207e+02 4.39619387e-02]
mat_Sqrt:  [[ 2.12439099e+01 -8.37926070e-03]
 [-8.37926070e-03  1.92199734e-02]]
grads:  [0.0085714  6.54445447]
Stock Position:  0.008571403777401329
Bond Position:  [12.23079023]


portfolio before change:  [13.09931604]
curr_Stock_Price:  99.5435272086736
curr_Factors:  [9.95435272e+01 3.94220400e-02]
mat_Sqrt:  [[ 1.97643501e+01 -7.93468746e-03]
 [-7.93468746e-03  1.82005806e-02]]
grads:  [2.29878011e-03 2.43833462e+00]
Stock Position:  0.0022987801069674703
Bond Position:  [12.87048736]


portfolio before change:  [13.12695321]
curr_Stock_Price:  104.56314407295872
curr_Factors:  [1.04563144e+02 3.90370006e-02]
mat_Sqrt:  [[ 2.06593581e+01 -7.89619164e-03]
 [-7.89619164e-03  1.81113269e-02]]
grads:  [-0.01277318  3.28211821]
Stock Position:  -0.012773180052255964
Bond Position:  [14.46255707]


portfolio before change:  [13.07970854]
curr_Stock_Price:  109.67809333697963
curr_Factors:  [1.09678093e+02 4.39809931e-02]
mat_Sqrt:  [[ 2.30012998e+01 -8.38165374e-03]
 [-8.38165374e-03  1.92238865e-02]]
grads:  [0.00308839 2.15531246]
Stock Position:  0.0030883922472796734
Bond Position:  [12.74097956]


portfolio before change:  [13.08532457]
curr_Stock_Price:  106.33649862947553
curr_Factors:  [1.06336499e+02 4.69613638e-02]
mat_Sqrt:  [[ 2.30437246e+01 -8.66076298e-03]
 [-8.66076298e-03  1.98646627e-02]]
grads:  [ 1.92853570e-03 -1.96644008e+00]
Stock Position:  0.0019285356988085313
Bond Position:  [12.88025083]


portfolio before change:  [13.0991324]
curr_Stock_Price:  105.14256512389336
curr_Factors:  [1.05142565e+02 4.85006058e-02]
mat_Sqrt:  [[ 2.31553910e+01 -8.80146847e-03]
 [-8.80146847e-03  2.01876252e-02]]
grads:  [ 4.14697167e-04 -6.06055708e+00]
Stock Position:  0.0004146971673631045
Bond Position:  [13.05553008]


portfolio before change:  [13.11857321]
curr_Stock_Price:  112.6448808897239
curr_Factors:  [1.12644881e+02 4.39066172e-02]
mat_Sqrt:  [[ 2.36035008e+01 -8.37474786e-03]
 [-8.37474786e-03  1.92075446e-02]]
grads:  [0.00715927 0.67952437]
Stock Position:  0.0071592712756139544
Bond Position:  [12.31211795]


portfolio before change:  [13.12975776]
curr_Stock_Price:  112.05610316873877
curr_Factors:  [1.12056103e+02 4.50458875e-02]
mat_Sqrt:  [[ 2.37828043e+01 -8.48266801e-03]
 [-8.48266801e-03  1.94551592e-02]]
grads:  [2.72790885e-03 4.67610203e+00]
Stock Position:  0.002727908848442558
Bond Position:  [12.82407892]


portfolio before change:  [13.17023427]
curr_Stock_Price:  121.0140214743558
curr_Factors:  [1.21014021e+02 3.78126292e-02]
mat_Sqrt:  [[ 2.35317436e+01 -7.77230101e-03]
 [-7.77230101e-03  1.78246355e-02]]
grads:  [-4.7451397e-03 -7.4573494e+00]
Stock Position:  -0.0047451396972006095
Bond Position:  [13.7444627]


portfolio before change:  [13.18506567]
curr_Stock_Price:  121.51135543471712
curr_Factors:  [1.21511355e+02 3.90988730e-02]
mat_Sqrt:  [[ 2.40269675e+01 -7.90341231e-03]
 [-7.90341231e-03  1.81252532e-02]]
grads:  [-9.19445522e-04 -7.23010296e+00]
Stock Position:  -0.0009194455218510605
Bond Position:  [13.29678874]


portfolio before change:  [13.20155403]
curr_Stock_Price:  121.66690239710289
curr_Factors:  [1.21666902e+02 4.03662713e-02]
mat_Sqrt:  [[ 2.44445330e+01 -8.03049387e-03]
 [-8.03049387e-03  1.84166740e-02]]
grads:  [ 6.23009141e-03 -9.57933698e+00]
Stock Position:  0.006230091407820833
Bond Position:  [12.4435581]


portfolio before change:  [13.2086339]
curr_Stock_Price:  120.30507643255908
curr_Factors:  [1.20305076e+02 4.29024868e-02]
mat_Sqrt:  [[ 2.49186874e+01 -8.27885869e-03]
 [-8.27885869e-03  1.89864522e-02]]
grads:  [ 2.57592082e-03 -7.84921401e+00]
Stock Position:  0.0025759208240289863
Bond Position:  [12.89873755]


portfolio before change:  [13.21711543]
curr_Stock_Price:  117.33449963749217
curr_Factors:  [1.17334500e+02 4.66111766e-02]
mat_Sqrt:  [[ 2.53320732e+01 -8.62910788e-03]
 [-8.62910788e-03  1.97901557e-02]]
grads:  [-0.00290462  2.18146941]
Stock Position:  -0.002904623250138651
Bond Position:  [13.55792795]


portfolio before change:  [13.23559661]
curr_Stock_Price:  116.81010447942128
curr_Factors:  [1.16810104e+02 4.79013825e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.23559661]
Stock Price:  111.72430371836072
PL:  [1.51129289]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-4.37302686e-02 -7.41207349e-02]
 [-2.43221612e-02 -1.21058019e-01]
 [-2.58878453e-02 -2.28049403e-01]
 [-2.42915297e-02 -2.96094628e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 4.38322342e-02  6.72976270e-02]
 [-2.39743902e-01  6.72453189e-02]
 [ 8.23854975e-02  7.48779986e-02]
 [ 6.68267528e-02 -5.50253841e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [-6.25144595e-03  4.07583321e-02]
 [-5.01522775e-05 -4.80140804e-02]
 [ 1.23876693e-02 -1.00272884e-01]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.48711867e-01 -7.75816520e-02]
 [ 3.99722810e-02 -1.47451677e-01]
 [-3.49457965e-02  3.75295070e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.53838905]
curr_Stock_Price:  101.37072706861696
curr_Factors:  [1.01370727e+02 4.20333605e-02]
mat_Sqrt:  [[ 2.07830644e+01 -8.19340714e-03]
 [-8.19340714e-03  1.87936607e-02]]
grads:  [-3.65959029e-03 -3.94551761e+00]
Stock Position:  -0.0036595902890208375
Bond Position:  [11.90936438]


portfolio before change:  [11.54181761]
curr_Stock_Price:  104.5042624300289
curr_Factors:  [1.04504262e+02 3.86859027e-02]
mat_Sqrt:  [[ 2.05546620e+01 -7.86059847e-03]
 [-7.86059847e-03  1.80296982e-02]]
grads:  [-3.75165325e-03 -6.71600307e+00]
Stock Position:  -0.003751653253967604
Bond Position:  [11.93388137]


portfolio before change:  [11.55582919]
curr_Stock_Price:  104.74818256086701
curr_Factors:  [1.04748183e+02 4.05494120e-02]
mat_Sqrt:  [[ 2.10930191e+01 -8.04771174e-03]
 [-8.04771174e-03  1.84588314e-02]]
grads:  [-5.94196819e-03 -1.23570782e+01]
Stock Position:  -0.0059419681905157505
Bond Position:  [12.17823956]


portfolio before change:  [11.56522247]
curr_Stock_Price:  105.73086028665807
curr_Factors:  [1.05730860e+02 4.54013075e-02]
mat_Sqrt:  [[ 2.25286888e+01 -8.51565073e-03]
 [-8.51565073e-03  1.95319422e-02]]
grads:  [-0.00165154 -1.51667081]
Stock Position:  -0.001651537249133478
Bond Position:  [11.73984092]


portfolio before change:  [11.57925105]
curr_Stock_Price:  106.12769886541975
curr_Factors:  [1.06127699e+02 4.29449548e-02]
mat_Sqrt:  [[ 2.19930161e+01 -8.28211282e-03]
 [-8.28211282e-03  1.89962142e-02]]
grads:  [ 0.00745589 -6.21429974]
Stock Position:  0.007455887333980483
Bond Position:  [10.78797488]


portfolio before change:  [11.5868685]
curr_Stock_Price:  105.33960405870917
curr_Factors:  [1.05339604e+02 3.73724209e-02]
mat_Sqrt:  [[ 2.03641959e+01 -7.72605648e-03]
 [-7.72605648e-03  1.77209554e-02]]
grads:  [0.00849388 5.99720404]
Stock Position:  0.008493883387179695
Bond Position:  [10.69212619]


portfolio before change:  [11.58901696]
curr_Stock_Price:  104.01805758733153
curr_Factors:  [1.04018058e+02 3.83571628e-02]
mat_Sqrt:  [[ 2.03719192e+01 -7.82709678e-03]
 [-7.82709678e-03  1.79529436e-02]]
grads:  [3.59243567e-03 3.75012292e+00]
Stock Position:  0.0035924356688064154
Bond Position:  [11.21533878]


portfolio before change:  [11.6004173]
curr_Stock_Price:  103.28663255325625
curr_Factors:  [1.03286633e+02 3.96095415e-02]
mat_Sqrt:  [[ 2.05562549e+01 -7.95379999e-03]
 [-7.95379999e-03  1.82436970e-02]]
grads:  [-0.01023835  3.68148435]
Stock Position:  -0.01023834900796565
Bond Position:  [12.65790189]


portfolio before change:  [11.60874881]
curr_Stock_Price:  104.01924635278661
curr_Factors:  [1.04019246e+02 4.24034873e-02]
mat_Sqrt:  [[ 2.14197530e+01 -8.22959111e-03]
 [-8.22959111e-03  1.88761411e-02]]
grads:  [0.00537121 3.9691482 ]
Stock Position:  0.005371208726956188
Bond Position:  [11.05003973]


portfolio before change:  [11.61209206]
curr_Stock_Price:  102.06848716459592
curr_Factors:  [1.02068487e+02 4.61979146e-02]
mat_Sqrt:  [[ 2.19382929e+01 -8.58976630e-03]
 [-8.58976630e-03  1.97026663e-02]]
grads:  [ 1.95296253e-03 -2.79193727e+00]
Stock Position:  0.0019529625327925635
Bond Position:  [11.41275613]


portfolio before change:  [11.63807264]
curr_Stock_Price:  108.06231094134944
curr_Factors:  [1.08062311e+02 4.17423234e-02]
mat_Sqrt:  [[ 2.20781424e+01 -8.16544930e-03]
 [-8.16544930e-03  1.87282853e-02]]
grads:  [ 4.34861663e-04 -6.53281129e+00]
Stock Position:  0.0004348616632958952
Bond Position:  [11.59108049]


portfolio before change:  [11.65171082]
curr_Stock_Price:  106.085285209094
curr_Factors:  [1.06085285e+02 4.37003412e-02]
mat_Sqrt:  [[ 2.21767311e+01 -8.35463212e-03]
 [-8.35463212e-03  1.91625555e-02]]
grads:  [5.19488833e-04 2.12720439e+00]
Stock Position:  0.0005194888330839555
Bond Position:  [11.5966007]


portfolio before change:  [11.66468974]
curr_Stock_Price:  103.14798331432489
curr_Factors:  [1.03147983e+02 4.35854128e-02]
mat_Sqrt:  [[ 2.15343264e+01 -8.34343376e-03]
 [-8.34343376e-03  1.91374304e-02]]
grads:  [-9.74565768e-04 -2.50933436e+00]
Stock Position:  -0.0009745657682850877
Bond Position:  [11.76521423]


portfolio before change:  [11.67649214]
curr_Stock_Price:  106.13732808592889
curr_Factors:  [1.06137328e+02 4.13930867e-02]
mat_Sqrt:  [[ 2.15939468e+01 -8.13109448e-03]
 [-8.13109448e-03  1.86498303e-02]]
grads:  [-1.45111073e-03 -5.37724377e+00]
Stock Position:  -0.0014511107288529932
Bond Position:  [11.83050915]


portfolio before change:  [11.69395546]
curr_Stock_Price:  104.30015368430652
curr_Factors:  [1.04300154e+02 4.45237535e-02]
mat_Sqrt:  [[ 2.20080114e+01 -8.43285019e-03]
 [-8.43285019e-03  1.93423001e-02]]
grads:  [-3.88247652e-03 -4.50542754e+00]
Stock Position:  -0.0038824765219330364
Bond Position:  [12.09889836]


portfolio before change:  [11.69042048]
curr_Stock_Price:  109.10844029210446
curr_Factors:  [1.0910844e+02 4.1477548e-02]
mat_Sqrt:  [[ 2.22210643e+01 -8.13957714e-03]
 [-8.13957714e-03  1.86687644e-02]]
grads:  [ 0.00517098 -4.15343837]
Stock Position:  0.0051709780279456646
Bond Position:  [11.12622314]


portfolio before change:  [11.69195396]
curr_Stock_Price:  106.71372949159125
curr_Factors:  [1.06713729e+02 4.25870947e-02]
mat_Sqrt:  [[ 2.20221276e+01 -8.24757231e-03]
 [-8.24757231e-03  1.89168839e-02]]
grads:  [-1.10430508e-03 -7.79519425e+00]
Stock Position:  -0.001104305076786207
Bond Position:  [11.80979847]


portfolio before change:  [11.70461137]
curr_Stock_Price:  108.6281160575642
curr_Factors:  [1.08628116e+02 4.01461990e-02]
mat_Sqrt:  [[ 2.17652888e+01 -8.00784965e-03]
 [-8.00784965e-03  1.83667181e-02]]
grads:  [-8.53928178e-04  2.04297081e+00]
Stock Position:  -0.0008539281782955673
Bond Position:  [11.79737198]


portfolio before change:  [11.7185099]
curr_Stock_Price:  109.6321909512274
curr_Factors:  [1.09632191e+02 4.22876529e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.7185099]
Stock Price:  109.7890903335264
PL:  [1.92941957]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 2.12405336e-02 -4.95808733e-02]
 [ 3.79619939e-02 -2.52835867e-02]
 [ 5.71737915e-02  7.23783471e-02]
 [-2.63373776e-01 -1.43481546e-01]
 [ 6.03873824e-02  1.79750397e-02]
 [ 6.88330246e-02 -5.18820041e-03]
 [-9.71199966e-02 -1.21572757e-01]
 [ 3.78023923e-02  8.06446416e-03]
 [-3.19827658e-02 -3.04057868e-02]
 [ 4.14824419e-02  2.27561927e-01]
 [ 5.50148815e-02 -1.00568415e-01]
 [ 2.50988335e-02 -9.72134407e-02]
 [-1.44349260e-01 -1.27609792e-01]
 [ 6.06264641e-03  1.66957909e-01]
 [-9.44592858e-02  1.73883282e-02]
 [-8.30629623e-02  3.02832930e-02]
 [-6.75309496e-02  8.43190733e-02]
 [ 8.60736157e-02 -1.26478991e-01]
 [ 8.60960287e-03  5.71146315e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.4152426]
curr_Stock_Price:  99.46681065070187
curr_Factors:  [9.94668107e+01 4.43916001e-02]
mat_Sqrt:  [[ 2.09569732e+01 -8.41996661e-03]
 [-8.41996661e-03  1.93137299e-02]]
grads:  [-1.78789505e-05 -2.56713871e+00]
Stock Position:  -1.787895048063924e-05
Bond Position:  [4.41702096]


portfolio before change:  [4.42077459]
curr_Stock_Price:  99.06081921946478
curr_Factors:  [9.90608192e+01 4.19895149e-02]
mat_Sqrt:  [[ 2.02988909e+01 -8.18896017e-03]
 [-8.18896017e-03  1.87839314e-02]]
grads:  [ 1.32737358e-03 -1.34544341e+00]
Stock Position:  0.001327373575203377
Bond Position:  [4.28928387]


portfolio before change:  [4.42246224]
curr_Stock_Price:  96.29045402790317
curr_Factors:  [9.62904540e+01 4.15760023e-02]
mat_Sqrt:  [[ 1.96338090e+01 -8.14832125e-03]
 [-8.14832125e-03  1.86913050e-02]]
grads:  [0.00451989 3.87427076]
Stock Position:  0.004519886816956767
Bond Position:  [3.98724028]


portfolio before change:  [4.41224618]
curr_Stock_Price:  92.9268260596144
curr_Factors:  [9.29268261e+01 4.74811488e-02]
mat_Sqrt:  [[ 2.02489111e+01 -8.70747902e-03]
 [-8.70747902e-03  1.99747665e-02]]
grads:  [-0.01609874 -7.19015792]
Stock Position:  -0.016098738575235284
Bond Position:  [5.90825086]


portfolio before change:  [4.41393442]
curr_Stock_Price:  93.280996243549
curr_Factors:  [9.32809962e+01 4.46867098e-02]
mat_Sqrt:  [[ 1.97188837e+01 -8.44739190e-03]
 [-8.44739190e-03  1.93780460e-02]]
grads:  [0.00346043 0.92910664]
Stock Position:  0.003460434746407146
Bond Position:  [4.09114162]


portfolio before change:  [4.42494466]
curr_Stock_Price:  94.98399460653008
curr_Factors:  [9.49839946e+01 4.19369603e-02]
mat_Sqrt:  [[ 1.94513105e+01 -8.18350914e-03]
 [-8.18350914e-03  1.87723142e-02]]
grads:  [ 0.00342309 -0.27488287]
Stock Position:  0.003423086489880522
Bond Position:  [4.09980623]


portfolio before change:  [4.42615766]
curr_Stock_Price:  93.84030036710817
curr_Factors:  [9.38403004e+01 4.17414141e-02]
mat_Sqrt:  [[ 1.91722432e+01 -8.16431163e-03]
 [-8.16431163e-03  1.87285386e-02]]
grads:  [-0.00783137 -6.4947243 ]
Stock Position:  -0.007831371024719057
Bond Position:  [5.16105587]


portfolio before change:  [4.41247648]
curr_Stock_Price:  96.41156590978035
curr_Factors:  [9.64115659e+01 4.42497601e-02]
mat_Sqrt:  [[ 2.02807756e+01 -8.40625884e-03]
 [-8.40625884e-03  1.92829566e-02]]
grads:  [0.00203767 0.41910551]
Stock Position:  0.0020376687000388132
Bond Position:  [4.21602165]


portfolio before change:  [4.41375256]
curr_Stock_Price:  94.44988990400664
curr_Factors:  [9.44498899e+01 4.95510074e-02]
mat_Sqrt:  [[ 2.10245961e+01 -8.89538960e-03]
 [-8.89538960e-03  2.04054433e-02]]
grads:  [-0.00215205 -1.49102029]
Stock Position:  -0.0021520495334860197
Bond Position:  [4.6170134]


portfolio before change:  [4.42392769]
curr_Stock_Price:  92.40520566838686
curr_Factors:  [9.24052057e+01 5.04048865e-02]
mat_Sqrt:  [[ 2.07459209e+01 -8.97151386e-03]
 [-8.97151386e-03  2.05805929e-02]]
grads:  [6.78244192e-03 1.10600689e+01]
Stock Position:  0.006782441920570346
Bond Position:  [3.79719475]


portfolio before change:  [4.39916287]
curr_Stock_Price:  88.05363339136663
curr_Factors:  [8.80536334e+01 5.24498446e-02]
mat_Sqrt:  [[ 2.01659803e+01 -9.15124631e-03]
 [-9.15124631e-03  2.09941215e-02]]
grads:  [ 5.54387032e-04 -4.79007144e+00]
Stock Position:  0.0005543870322995879
Bond Position:  [4.35034707]


portfolio before change:  [4.40312117]
curr_Stock_Price:  85.3785532520377
curr_Factors:  [8.53785533e+01 5.22515567e-02]
mat_Sqrt:  [[ 1.95163393e+01 -9.13363406e-03]
 [-9.13363406e-03  2.09545293e-02]]
grads:  [-8.85307635e-04 -4.63964261e+00]
Stock Position:  -0.000885307634998172
Bond Position:  [4.47870746]


portfolio before change:  [4.40529694]
curr_Stock_Price:  89.2485261878849
curr_Factors:  [8.92485262e+01 5.38571493e-02]
mat_Sqrt:  [[ 2.07120312e+01 -9.27333332e-03]
 [-9.27333332e-03  2.12738521e-02]]
grads:  [-0.00965689 -6.00264318]
Stock Position:  -0.009656888298236074
Bond Position:  [5.26715999]


portfolio before change:  [4.38211644]
curr_Stock_Price:  92.33115151481098
curr_Factors:  [9.23311515e+01 5.65677512e-02]
mat_Sqrt:  [[ 2.19600168e+01 -9.50415529e-03]
 [-9.50415529e-03  2.18024894e-02]]
grads:  [3.59097738e-03 7.65931058e+00]
Stock Position:  0.0035909773784049918
Bond Position:  [4.05055736]


portfolio before change:  [4.38339413]
curr_Stock_Price:  91.2760980194268
curr_Factors:  [9.12760980e+01 5.07492161e-02]
mat_Sqrt:  [[ 2.05623001e+01 -9.00199478e-03]
 [-9.00199478e-03  2.06508172e-02]]
grads:  [-0.00422599  0.8401743 ]
Stock Position:  -0.004225988372072469
Bond Position:  [4.76912586]


portfolio before change:  [4.39607424]
curr_Stock_Price:  89.68712511851326
curr_Factors:  [8.96871251e+01 5.57577756e-02]
mat_Sqrt:  [[ 2.11778945e+01 -9.43559058e-03]
 [-9.43559058e-03  2.16459554e-02]]
grads:  [-0.00329947  1.39758952]
Stock Position:  -0.003299472468206519
Bond Position:  [4.69199444]


portfolio before change:  [4.39545878]
curr_Stock_Price:  91.6523257216674
curr_Factors:  [9.16523257e+01 5.78165942e-02]
mat_Sqrt:  [[ 2.20378743e+01 -9.60842333e-03]
 [-9.60842333e-03  2.20418725e-02]]
grads:  [-1.39671801e-03  3.82479543e+00]
Stock Position:  -0.0013967180145317347
Bond Position:  [4.52347123]


portfolio before change:  [4.40833489]
curr_Stock_Price:  86.4843241790527
curr_Factors:  [8.64843242e+01 6.54625277e-02]
mat_Sqrt:  [[ 2.21275706e+01 -1.02234230e-02]
 [-1.02234230e-02  2.34543578e-02]]
grads:  [ 1.39868242e-03 -5.39194861e+00]
Stock Position:  0.0013986824228456728
Bond Position:  [4.28737079]


portfolio before change:  [4.40861609]
curr_Stock_Price:  82.85135843201971
curr_Factors:  [8.28513584e+01 6.78112500e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.40861609]
Stock Price:  82.38206591975363
PL:  [4.40861609]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.50457593e-01 -3.85727196e-03]
 [-1.93718928e-01  8.74242891e-02]
 [ 4.12319296e-02  1.14158753e-01]
 [-5.73135887e-01 -2.92907554e-01]
 [ 6.13850637e-01  6.56956900e-02]
 [-5.30187004e-02 -4.42087305e-01]
 [-4.81413591e-01 -4.72929834e-01]
 [ 3.40372296e-02 -8.27748790e-03]
 [-2.63414500e-01 -2.04037630e-01]
 [ 8.93585154e-02  4.32892082e-01]
 [ 5.50479651e-02 -1.00659302e-01]
 [-1.69654652e-03 -2.47611378e-04]
 [-1.05058673e-01 -1.40192106e-01]
 [-1.63000891e-04  1.58770958e-01]
 [-1.03164783e-01  9.03471011e-02]
 [-9.39443199e-02  3.60669721e-02]
 [-7.91428844e-02  1.20873972e-01]
 [ 7.28515512e-02 -1.33043385e-01]
 [ 1.30536764e-01  7.24294395e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.29231033]
curr_Stock_Price:  98.20854825508985
curr_Factors:  [9.82085483e+01 4.17782549e-02]
mat_Sqrt:  [[ 2.00735601e+01 -8.16826829e-03]
 [-8.16826829e-03  1.87366470e-02]]
grads:  [ 0.00741286 -0.20263614]
Stock Position:  0.007412855803486101
Bond Position:  [-1.02031614]


portfolio before change:  [-0.3446279]
curr_Stock_Price:  91.32302713054601
curr_Factors:  [9.13230271e+01 4.69063052e-02]
mat_Sqrt:  [[ 1.97786147e+01 -8.65445899e-03]
 [-8.65445899e-03  1.98535486e-02]]
grads:  [-0.00786906  4.40002886]
Stock Position:  -0.007869057632490066
Bond Position:  [0.37399826]


portfolio before change:  [-0.34312009]
curr_Stock_Price:  91.19086109093716
curr_Factors:  [9.11908611e+01 4.84338206e-02]
mat_Sqrt:  [[ 2.00689957e+01 -8.79423456e-03]
 [-8.79423456e-03  2.01742322e-02]]
grads:  [4.53499214e-03 5.66061864e+00]
Stock Position:  0.004534992144526561
Bond Position:  [-0.75666993]


portfolio before change:  [-0.35258413]
curr_Stock_Price:  89.312663666684
curr_Factors:  [8.93126637e+01 5.38226762e-02]
mat_Sqrt:  [[ 2.07202811e+01 -9.27037182e-03]
 [-9.27037182e-03  2.12670395e-02]]
grads:  [ -0.03382927 -13.78758732]
Stock Position:  -0.033829268286989095
Bond Position:  [2.66879793]


portfolio before change:  [-0.2629261]
curr_Stock_Price:  86.76102858564792
curr_Factors:  [8.67610286e+01 5.37106315e-02]
mat_Sqrt:  [[ 2.01073471e+01 -9.26043829e-03]
 [-9.26043829e-03  2.12450135e-02]]
grads:  [0.03195924 3.10621816]
Stock Position:  0.031959242296104175
Bond Position:  [-3.03574283]


portfolio before change:  [-0.31323063]
curr_Stock_Price:  85.3058163018757
curr_Factors:  [8.53058163e+01 5.39438031e-02]
mat_Sqrt:  [[ 1.98129606e+01 -9.28035040e-03]
 [-9.28035040e-03  2.12911514e-02]]
grads:  [-1.24042608e-02 -2.07693052e+01]
Stock Position:  -0.012404260760588249
Bond Position:  [0.74492496]


portfolio before change:  [-0.29879547]
curr_Stock_Price:  84.21720461393738
curr_Factors:  [8.42172046e+01 5.28142246e-02]
mat_Sqrt:  [[ 1.93542447e+01 -9.18254407e-03]
 [-9.18254407e-03  2.10671102e-02]]
grads:  [ -0.03553186 -22.46421571]
Stock Position:  -0.03553185638561271
Bond Position:  [2.69359815]


portfolio before change:  [-0.29097478]
curr_Stock_Price:  84.09192035350169
curr_Factors:  [8.40919204e+01 5.63473196e-02]
mat_Sqrt:  [[ 1.99613933e+01 -9.48469773e-03]
 [-9.48469773e-03  2.17603701e-02]]
grads:  [ 0.00152472 -0.37972821]
Stock Position:  0.001524724344755506
Bond Position:  [-0.41919178]


portfolio before change:  [-0.29488817]
curr_Stock_Price:  81.86917720351077
curr_Factors:  [8.18691772e+01 5.91009065e-02]
mat_Sqrt:  [[ 1.99029497e+01 -9.71339602e-03]
 [-9.71339602e-03  2.22858476e-02]]
grads:  [-0.01770694 -9.16319758]
Stock Position:  -0.017706936513656728
Bond Position:  [1.15476415]


portfolio before change:  [-0.32821017]
curr_Stock_Price:  83.83260849801243
curr_Factors:  [8.38326085e+01 5.86322008e-02]
mat_Sqrt:  [[ 2.02992984e+01 -9.67505626e-03]
 [-9.67505626e-03  2.21971911e-02]]
grads:  [1.36999961e-02 1.95080822e+01]
Stock Position:  0.01369999606464834
Bond Position:  [-1.47671657]


portfolio before change:  [-0.27157727]
curr_Stock_Price:  88.10121888636526
curr_Factors:  [8.81012189e+01 5.73947664e-02]
mat_Sqrt:  [[ 2.11065873e+01 -9.57292226e-03]
 [-9.57292226e-03  2.19614850e-02]]
grads:  [ 5.29369931e-04 -4.58321620e+00]
Stock Position:  0.0005293699313794926
Bond Position:  [-0.31821541]


portfolio before change:  [-0.2691921]
curr_Stock_Price:  93.35877890719229
curr_Factors:  [9.33587789e+01 5.42516104e-02]
mat_Sqrt:  [[ 2.17451015e+01 -9.30765175e-03]
 [-9.30765175e-03  2.13514338e-02]]
grads:  [-8.29990881e-05 -1.16331253e-02]
Stock Position:  -8.29990881461895e-05
Bond Position:  [-0.2614434]


portfolio before change:  [-0.2696447]
curr_Stock_Price:  94.87204940897401
curr_Factors:  [9.48720494e+01 5.41656357e-02]
mat_Sqrt:  [[ 2.20800558e+01 -9.30041923e-03]
 [-9.30041923e-03  2.13344454e-02]]
grads:  [-0.00752733 -6.57444385]
Stock Position:  -0.007527325074546745
Bond Position:  [0.44448805]


portfolio before change:  [-0.2215945]
curr_Stock_Price:  88.5624708523376
curr_Factors:  [8.85624709e+01 5.63630051e-02]
mat_Sqrt:  [[ 2.10255203e+01 -9.48653923e-03]
 [-9.48653923e-03  2.17631713e-02]]
grads:  [3.28451533e-03 7.29682794e+00]
Stock Position:  0.003284515334209967
Bond Position:  [-0.51247929]


portfolio before change:  [-0.22502449]
curr_Stock_Price:  87.71333773964511
curr_Factors:  [8.77133377e+01 5.84668575e-02]
mat_Sqrt:  [[ 2.12090135e+01 -9.66187168e-03]
 [-9.66187168e-03  2.21656674e-02]]
grads:  [-3.00795373e-03  4.07468167e+00]
Stock Position:  -0.0030079537306063973
Bond Position:  [0.03881317]


portfolio before change:  [-0.22875305]
curr_Stock_Price:  88.96904472636696
curr_Factors:  [8.89690447e+01 5.65315726e-02]
mat_Sqrt:  [[ 2.11536063e+01 -9.50075945e-03]
 [-9.50075945e-03  2.17956715e-02]]
grads:  [-0.00369857  1.65316462]
Stock Position:  -0.0036985655964074846
Bond Position:  [0.1003048]


portfolio before change:  [-0.22907389]
curr_Stock_Price:  89.08971224788047
curr_Factors:  [8.90897122e+01 4.78252209e-02]
mat_Sqrt:  [[ 1.94830078e+01 -8.73860053e-03]
 [-8.73860053e-03  2.00471711e-02]]
grads:  [-1.35804800e-03  6.02888579e+00]
Stock Position:  -0.0013580479998678238
Bond Position:  [-0.10808578]


portfolio before change:  [-0.22410957]
curr_Stock_Price:  85.33468552922137
curr_Factors:  [8.53346855e+01 5.02472388e-02]
mat_Sqrt:  [[ 1.91285322e+01 -8.95673761e-03]
 [-8.95673761e-03  2.05487041e-02]]
grads:  [ 7.77050642e-04 -6.47420026e+00]
Stock Position:  0.0007770506423906978
Bond Position:  [-0.29041894]


portfolio before change:  [-0.2197791]
curr_Stock_Price:  91.37512087614908
curr_Factors:  [9.13751209e+01 5.05198166e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.2197791]
Stock Price:  91.18611320436098
PL:  [-0.2197791]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 4.46555446e-02 -3.16982096e-02]
 [-2.77651658e-02 -1.25197649e-01]
 [-4.41945668e-01 -1.13041265e-01]
 [-2.42915297e-02 -2.96094628e-02]
 [ 1.83601103e-02 -8.96648124e-02]
 [ 1.28546981e-01  1.09588964e-01]
 [ 2.83184380e-02  4.72457278e-02]
 [-1.01948359e-01  8.85127735e-02]
 [-1.70127170e-02 -1.88030367e-02]
 [ 3.82873500e-02  1.39677530e-01]
 [ 5.80553039e-02 -1.08921007e-01]
 [-6.71409236e-03  1.55975309e-02]
 [-1.17365148e-01 -1.39995938e-01]
 [ 5.43880568e-03  1.52114328e-01]
 [-6.25108870e-02 -8.11353006e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 4.23978124e-02 -1.47735148e-01]
 [-3.50817160e-03  3.62706646e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.57765125]
curr_Stock_Price:  104.32136590017087
curr_Factors:  [1.04321366e+02 3.43789323e-02]
mat_Sqrt:  [[ 1.93428037e+01 -7.41011196e-03]
 [-7.41011196e-03  1.69964574e-02]]
grads:  [ 1.59443881e-03 -1.86429406e+00]
Stock Position:  0.0015944388057175368
Bond Position:  [22.41131721]


portfolio before change:  [22.60633691]
curr_Stock_Price:  104.73154015550257
curr_Factors:  [1.04731540e+02 3.45918776e-02]
mat_Sqrt:  [[ 1.94789044e+01 -7.43305144e-03]
 [-7.43305144e-03  1.70490035e-02]]
grads:  [-4.22830437e-03 -7.34524324e+00]
Stock Position:  -0.004228304371021146
Bond Position:  [23.04917374]


portfolio before change:  [22.61418206]
curr_Stock_Price:  109.69436406802517
curr_Factors:  [1.09694364e+02 3.21298107e-02]
mat_Sqrt:  [[ 1.96624834e+01 -7.16393005e-03]
 [-7.16393005e-03  1.64309529e-02]]
grads:  [-0.02498718 -6.89066986]
Stock Position:  -0.024987176584880172
Bond Position:  [25.3551345]


portfolio before change:  [22.70160236]
curr_Stock_Price:  107.46495780093002
curr_Factors:  [1.07464958e+02 3.00253325e-02]
mat_Sqrt:  [[ 1.86213325e+01 -6.92522111e-03]
 [-6.92522111e-03  1.58837854e-02]]
grads:  [-0.00199809 -1.86500254]
Stock Position:  -0.0019980892677789555
Bond Position:  [22.91632694]


portfolio before change:  [22.74071634]
curr_Stock_Price:  102.23463331041563
curr_Factors:  [1.02234633e+02 3.28800088e-02]
mat_Sqrt:  [[ 1.85380467e+01 -7.24664118e-03]
 [-7.24664118e-03  1.66218615e-02]]
grads:  [-1.11849087e-03 -5.39487817e+00]
Stock Position:  -0.0011184908694313019
Bond Position:  [22.85506484]


portfolio before change:  [22.76830653]
curr_Stock_Price:  103.12556596303337
curr_Factors:  [1.03125566e+02 3.00717589e-02]
mat_Sqrt:  [[ 1.78832204e+01 -6.93032453e-03]
 [-6.93032453e-03  1.58961691e-02]]
grads:  [0.00986147 6.89834809]
Stock Position:  0.009861466134378013
Bond Position:  [21.75133725]


portfolio before change:  [22.77993323]
curr_Stock_Price:  101.54573281403115
curr_Factors:  [1.01545733e+02 2.99168277e-02]
mat_Sqrt:  [[ 1.75638377e+01 -6.91235328e-03]
 [-6.91235328e-03  1.58552089e-02]]
grads:  [2.78552032e-03 2.98103813e+00]
Stock Position:  0.0027855203168164365
Bond Position:  [22.49707553]


portfolio before change:  [22.80710618]
curr_Stock_Price:  101.19894630697154
curr_Factors:  [1.01198946e+02 2.90529385e-02]
mat_Sqrt:  [[ 1.72492807e+01 -6.81179934e-03]
 [-6.81179934e-03  1.56246208e-02]]
grads:  [-3.67381885e-03  5.66335333e+00]
Stock Position:  -0.003673818847501883
Bond Position:  [23.17889277]


portfolio before change:  [22.8574848]
curr_Stock_Price:  95.37751298685119
curr_Factors:  [9.53775130e+01 3.34593017e-02]
mat_Sqrt:  [[ 1.74463424e+01 -7.30972875e-03]
 [-7.30972875e-03  1.67678526e-02]]
grads:  [-0.00144525 -1.1220042 ]
Stock Position:  -0.0014452463865364765
Bond Position:  [22.99532881]


portfolio before change:  [22.88749129]
curr_Stock_Price:  94.51651480910837
curr_Factors:  [9.45165148e+01 3.21848175e-02]
mat_Sqrt:  [[ 1.69563818e+01 -7.16909858e-03]
 [-7.16909858e-03  1.64454310e-02]]
grads:  [5.85004603e-03 8.49594454e+00]
Stock Position:  0.005850046033430111
Bond Position:  [22.33456533]


portfolio before change:  [22.9020472]
curr_Stock_Price:  92.22939508318345
curr_Factors:  [9.22293951e+01 3.58498764e-02]
mat_Sqrt:  [[ 1.74627707e+01 -7.56610602e-03]
 [-7.56610602e-03  1.73566357e-02]]
grads:  [ 6.05656884e-04 -6.27520371e+00]
Stock Position:  0.0006056568837663676
Bond Position:  [22.84618783]


portfolio before change:  [22.93212858]
curr_Stock_Price:  94.71561551111837
curr_Factors:  [9.47156155e+01 3.62886615e-02]
mat_Sqrt:  [[ 1.80429282e+01 -7.61246635e-03]
 [-7.61246635e-03  1.74624446e-02]]
grads:  [4.73377534e-06 8.93206383e-01]
Stock Position:  4.733775335033511e-06
Bond Position:  [22.93168022]


portfolio before change:  [22.96080288]
curr_Stock_Price:  92.97708873154106
curr_Factors:  [9.29770887e+01 3.44568881e-02]
mat_Sqrt:  [[ 1.72589325e+01 -7.41771402e-03]
 [-7.41771402e-03  1.70160630e-02]]
grads:  [-0.01033819 -8.23178801]
Stock Position:  -0.010338194272027298
Bond Position:  [23.92201808]


portfolio before change:  [22.95114153]
curr_Stock_Price:  96.80585828701193
curr_Factors:  [9.68058583e+01 4.02939852e-02]
mat_Sqrt:  [[ 1.94321885e+01 -8.02174938e-03]
 [-8.02174938e-03  1.84008529e-02]]
grads:  [3.69310513e-03 8.26830984e+00]
Stock Position:  0.0036931051330312127
Bond Position:  [22.59362732]


portfolio before change:  [22.9874716]
curr_Stock_Price:  98.99111347874626
curr_Factors:  [9.89911135e+01 3.67053821e-02]
mat_Sqrt:  [[ 1.89653582e+01 -7.65637017e-03]
 [-7.65637017e-03  1.75622839e-02]]
grads:  [-0.00516202 -4.62211084]
Stock Position:  -0.005162015806662804
Bond Position:  [23.4984653]


portfolio before change:  [22.99404772]
curr_Stock_Price:  103.41096327187252
curr_Factors:  [1.03410963e+02 3.86653772e-02]
mat_Sqrt:  [[ 2.03342274e+01 -7.85844009e-03]
 [-7.85844009e-03  1.80249464e-02]]
grads:  [ 0.00534334 -3.38428491]
Stock Position:  0.005343338669609641
Bond Position:  [22.44148792]


portfolio before change:  [23.03910708]
curr_Stock_Price:  106.5906165257286
curr_Factors:  [1.06590617e+02 3.41652148e-02]
mat_Sqrt:  [[ 1.97020321e+01 -7.38718155e-03]
 [-7.38718155e-03  1.69434854e-02]]
grads:  [-1.11748668e-03 -8.71977633e+00]
Stock Position:  -0.0011174866798774972
Bond Position:  [23.15822067]


portfolio before change:  [23.06996231]
curr_Stock_Price:  104.89990198644875
curr_Factors:  [1.04899902e+02 3.53222436e-02]
mat_Sqrt:  [[ 1.97151094e+01 -7.51112209e-03]
 [-7.51112209e-03  1.72280434e-02]]
grads:  [6.24254239e-04 2.10559914e+00]
Stock Position:  0.0006242542390983508
Bond Position:  [23.0044781]


portfolio before change:  [23.099618]
curr_Stock_Price:  106.31297090297723
curr_Factors:  [1.06312971e+02 3.40926355e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.099618]
Stock Price:  108.83884920319079
PL:  [14.2607688]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 4.61998117e-02 -4.03346063e-02]
 [-9.30414985e-03 -1.03001402e-01]
 [ 7.42639257e-02 -8.20510022e-02]
 [-2.31522552e-02 -2.65128524e-02]
 [ 4.09915440e-02 -9.29311897e-02]
 [ 1.26636368e-01  1.06210561e-01]
 [ 2.94863500e-02  4.87552780e-02]
 [ 3.57414706e-02  1.09793891e-01]
 [ 8.22228107e-02  7.46881184e-02]
 [ 6.19798881e-02 -4.32789556e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 2.05336066e-01  7.01800365e-03]
 [ 2.64023527e-02  8.45414214e-02]
 [-1.07451968e-02 -2.00119477e-01]
 [-1.35815980e-02 -1.05788462e-01]
 [ 1.89928800e-01 -1.28209245e-01]
 [ 1.15942031e-01 -1.50113549e-01]
 [-1.17596619e-01  4.57957465e-02]
 [-1.16581804e-01 -1.36430670e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.41721415]
curr_Stock_Price:  99.20005174584881
curr_Factors:  [9.92000517e+01 4.21977308e-02]
mat_Sqrt:  [[ 2.03777585e+01 -8.20924926e-03]
 [-8.20924926e-03  1.88304417e-02]]
grads:  [ 1.40450744e-03 -2.14137708e+00]
Stock Position:  0.0014045074359094992
Bond Position:  [3.27788694]


portfolio before change:  [3.42733774]
curr_Stock_Price:  103.48886331258036
curr_Factors:  [1.03488863e+02 4.20014712e-02]
mat_Sqrt:  [[ 2.12092756e+01 -8.19044997e-03]
 [-8.19044997e-03  1.87864643e-02]]
grads:  [-2.55640182e-03 -5.48385999e+00]
Stock Position:  -0.002556401818190884
Bond Position:  [3.69189686]


portfolio before change:  [3.43714827]
curr_Stock_Price:  101.45758172038983
curr_Factors:  [1.01457582e+02 4.48800569e-02]
mat_Sqrt:  [[ 2.14936995e+01 -8.46631679e-03]
 [-8.46631679e-03  1.94196305e-02]]
grads:  [ 1.79117667e-03 -4.22437685e+00]
Stock Position:  0.0017911766689093524
Bond Position:  [3.25541982]


portfolio before change:  [3.4463722]
curr_Stock_Price:  104.33396502661364
curr_Factors:  [1.04333965e+02 4.68423844e-02]
mat_Sqrt:  [[ 2.25811043e+01 -8.64964176e-03]
 [-8.64964176e-03  1.98395449e-02]]
grads:  [-0.00153744 -1.33703424]
Stock Position:  -0.0015374412983614532
Bond Position:  [3.60677955]


portfolio before change:  [3.45376392]
curr_Stock_Price:  102.46044318301863
curr_Factors:  [1.02460443e+02 4.97808214e-02]
mat_Sqrt:  [[ 2.28605790e+01 -8.91666975e-03]
 [-8.91666975e-03  2.04524134e-02]]
grads:  [ 2.08338134e-05 -4.54376714e+00]
Stock Position:  2.0833813429336023e-05
Bond Position:  [3.45162928]


portfolio before change:  [3.45815751]
curr_Stock_Price:  106.1250508947499
curr_Factors:  [1.06125051e+02 5.13897137e-02]
mat_Sqrt:  [[ 2.40578039e+01 -9.05989484e-03]
 [-9.05989484e-03  2.07801694e-02]]
grads:  [0.00718982 5.11428457]
Stock Position:  0.0071898187184544
Bond Position:  [2.69513763]


portfolio before change:  [3.40710481]
curr_Stock_Price:  98.55549612410688
curr_Factors:  [9.85554961e+01 4.93402736e-02]
mat_Sqrt:  [[ 2.18918059e+01 -8.87681254e-03]
 [-8.87681254e-03  2.03618500e-02]]
grads:  [2.31823442e-03 2.39545309e+00]
Stock Position:  0.0023182344208254454
Bond Position:  [3.17863006]


portfolio before change:  [3.41325959]
curr_Stock_Price:  99.49544071462064
curr_Factors:  [9.94954407e+01 4.72803071e-02]
mat_Sqrt:  [[ 2.16343220e+01 -8.68960887e-03]
 [-8.68960887e-03  1.99322294e-02]]
grads:  [3.86522884e-03 5.51004487e+00]
Stock Position:  0.003865228842018208
Bond Position:  [3.02868694]


portfolio before change:  [3.43461321]
curr_Stock_Price:  104.03990543738918
curr_Factors:  [1.04039905e+02 4.16802442e-02]
mat_Sqrt:  [[ 2.12405151e+01 -8.15910785e-03]
 [-8.15910785e-03  1.87144704e-02]]
grads:  [0.00540498 3.99328523]
Stock Position:  0.005404975118394955
Bond Position:  [2.87228011]


portfolio before change:  [3.4450534]
curr_Stock_Price:  105.3068100988422
curr_Factors:  [1.0530681e+02 4.1072483e-02]
mat_Sqrt:  [[ 2.13418422e+01 -8.09948909e-03]
 [-8.09948909e-03  1.85774892e-02]]
grads:  [ 2.02035454e-03 -2.32876420e+00]
Stock Position:  0.0020203545435030566
Bond Position:  [3.2322963]


portfolio before change:  [3.46206378]
curr_Stock_Price:  111.72523122412255
curr_Factors:  [1.11725231e+02 4.20942585e-02]
mat_Sqrt:  [[ 2.29225361e+01 -8.20002690e-03]
 [-8.20002690e-03  1.88069706e-02]]
grads:  [ 4.18763552e-04 -6.50548530e+00]
Stock Position:  0.00041876355179752423
Bond Position:  [3.41527732]


portfolio before change:  [3.46735345]
curr_Stock_Price:  114.1559688932261
curr_Factors:  [1.14155969e+02 4.00382199e-02]
mat_Sqrt:  [[ 2.28420974e+01 -7.99739978e-03]
 [-7.99739978e-03  1.83418591e-02]]
grads:  [0.00912473 0.38660082]
Stock Position:  0.009124725454475357
Bond Position:  [2.42571157]


portfolio before change:  [3.44556226]
curr_Stock_Price:  111.43531459480103
curr_Factors:  [1.11435315e+02 4.08607636e-02]
mat_Sqrt:  [[ 2.25255838e+01 -8.07897303e-03]
 [-8.07897303e-03  1.85293775e-02]]
grads:  [2.80894195e-03 4.56378606e+00]
Stock Position:  0.0028089419461854864
Bond Position:  [3.13254693]


portfolio before change:  [3.44973908]
curr_Stock_Price:  111.52740831159531
curr_Factors:  [1.11527408e+02 4.14177875e-02]
mat_Sqrt:  [[ 2.26973435e+01 -8.13385940e-03]
 [-8.13385940e-03  1.86552461e-02]]
grads:  [-4.31832253e-03 -1.07291322e+01]
Stock Position:  -0.0043183225317228804
Bond Position:  [3.9313504]


portfolio before change:  [3.442164]
curr_Stock_Price:  114.42027655595668
curr_Factors:  [1.14420277e+02 3.89361743e-02]
mat_Sqrt:  [[ 2.25776952e+01 -7.88658284e-03]
 [-7.88658284e-03  1.80876630e-02]]
grads:  [-2.64493687e-03 -5.84980611e+00]
Stock Position:  -0.002644936874991464
Bond Position:  [3.74479841]


portfolio before change:  [3.44380575]
curr_Stock_Price:  115.57046706519151
curr_Factors:  [1.15570467e+02 3.63459536e-02]
mat_Sqrt:  [[ 2.20330630e+01 -7.61980267e-03]
 [-7.61980267e-03  1.74756443e-02]]
grads:  [ 6.08388803e-03 -7.33380041e+00]
Stock Position:  0.006083888025844388
Bond Position:  [2.74068796]


portfolio before change:  [3.4602172]
curr_Stock_Price:  117.70453946599729
curr_Factors:  [1.17704539e+02 3.12040011e-02]
mat_Sqrt:  [[ 2.07920988e+01 -7.06036370e-03]
 [-7.06036370e-03  1.61923215e-02]]
grads:  [ 2.42857918e-03 -9.26960362e+00]
Stock Position:  0.002428579180564697
Bond Position:  [3.17436241]


portfolio before change:  [3.47282079]
curr_Stock_Price:  121.25935485943073
curr_Factors:  [1.21259355e+02 2.99563485e-02]
mat_Sqrt:  [[ 2.09874496e+01 -6.91793180e-03]
 [-6.91793180e-03  1.58652357e-02]]
grads:  [-0.00465239  2.88451823]
Stock Position:  -0.004652386099733615
Bond Position:  [4.03696613]


portfolio before change:  [3.46744561]
curr_Stock_Price:  123.50004195118196
curr_Factors:  [1.23500042e+02 2.94552563e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.46744561]
Stock Price:  128.70800370446773
PL:  [-25.24055809]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.40358365e-01  1.65462178e-02]
 [-1.57681274e-01 -1.86601060e-01]
 [-6.07699681e-01 -3.75554622e-02]
 [-2.39626943e-02 -2.87156702e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.53683081e-01 -1.19334341e-03]
 [ 5.44239664e-02  8.09876574e-02]
 [ 1.44757662e-01 -2.90943667e-01]
 [ 4.30267611e-02  3.66222426e-02]
 [ 9.20905832e-02 -8.08021568e-02]
 [ 1.63612337e-01 -1.06306721e-01]
 [ 4.32327919e-01 -2.52269657e-02]
 [ 2.65836001e-02  1.97031860e-01]
 [-5.86916945e-02 -1.24278048e-01]
 [ 5.68968903e-02 -1.38989348e-01]
 [ 2.52051412e-01 -2.04515707e-01]
 [ 1.77189368e-01 -1.51095237e-01]
 [-1.42716621e-01  4.83732458e-02]
 [-1.20294044e-01 -1.43866188e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [36.02630386]
curr_Stock_Price:  107.91600075431059
curr_Factors:  [1.07916001e+02 3.63151884e-02]
mat_Sqrt:  [[ 2.05650592e+01 -7.61614894e-03]
 [-7.61614894e-03  1.74684332e-02]]
grads:  [0.00717704 0.9503359 ]
Stock Position:  0.007177040596081956
Bond Position:  [35.25178634]


portfolio before change:  [36.07051582]
curr_Stock_Price:  107.93267461521283
curr_Factors:  [1.07932675e+02 3.92002847e-02]
mat_Sqrt:  [[ 2.13696555e+01 -7.91290489e-03]
 [-7.91290489e-03  1.81490711e-02]]
grads:  [ -0.01118769 -10.2864541 ]
Stock Position:  -0.011187686546073015
Bond Position:  [37.27803275]


portfolio before change:  [36.07223559]
curr_Stock_Price:  111.94663211545988
curr_Factors:  [1.11946632e+02 3.45680418e-02]
mat_Sqrt:  [[ 2.08136570e+01 -7.43090892e-03]
 [-7.43090892e-03  1.70429461e-02]]
grads:  [-0.02998855 -2.2166534 ]
Stock Position:  -0.029988551759813617
Bond Position:  [39.42935297]


portfolio before change:  [36.19845963]
curr_Stock_Price:  109.38210266407013
curr_Factors:  [1.09382103e+02 3.35710284e-02]
mat_Sqrt:  [[ 2.00414233e+01 -7.32282307e-03]
 [-7.32282307e-03  1.67954323e-02]]
grads:  [-0.00182066 -1.71052474]
Stock Position:  -0.0018206573350383116
Bond Position:  [36.39760695]


portfolio before change:  [36.23910323]
curr_Stock_Price:  112.06346985858691
curr_Factors:  [1.12063470e+02 3.09753165e-02]
mat_Sqrt:  [[ 1.97229518e+01 -7.03416896e-03]
 [-7.03416896e-03  1.61329982e-02]]
grads:  [ 0.00831383 -7.31738993]
Stock Position:  0.008313827758236239
Bond Position:  [35.30742685]


portfolio before change:  [36.34170379]
curr_Stock_Price:  119.09256439695989
curr_Factors:  [1.19092564e+02 2.38352623e-02]
mat_Sqrt:  [[ 1.83863105e+01 -6.17071996e-03]
 [-6.17071996e-03  1.41518493e-02]]
grads:  [ 0.00833148 -0.08069138]
Stock Position:  0.008331478843465601
Bond Position:  [35.34948661]


portfolio before change:  [36.42690247]
curr_Stock_Price:  124.01176247354674
curr_Factors:  [1.24011762e+02 2.24448700e-02]
mat_Sqrt:  [[ 1.85789602e+01 -5.98821890e-03]
 [-5.98821890e-03  1.37328051e-02]]
grads:  [4.83080969e-03 5.89949286e+00]
Stock Position:  0.004830809685641683
Bond Position:  [35.82782525]


portfolio before change:  [36.48103051]
curr_Stock_Price:  125.94006303853422
curr_Factors:  [1.25940063e+02 2.36241267e-02]
mat_Sqrt:  [[ 1.93571656e+01 -6.14358559e-03]
 [-6.14358559e-03  1.40889185e-02]]
grads:  [ 9.24299808e-04 -2.06501294e+01]
Stock Position:  0.0009242998081781669
Bond Position:  [36.36462413]


portfolio before change:  [36.52479312]
curr_Stock_Price:  124.07747607724284
curr_Factors:  [1.24077476e+02 2.40377396e-02]
mat_Sqrt:  [[ 1.92371061e+01 -6.19706573e-03]
 [-6.19706573e-03  1.42117477e-02]]
grads:  [0.00306721 2.57823676]
Stock Position:  0.0030672110121673646
Bond Position:  [36.14422132]


portfolio before change:  [36.58028173]
curr_Stock_Price:  127.42908096302568
curr_Factors:  [1.27429081e+02 2.43832038e-02]
mat_Sqrt:  [[ 1.98982056e+01 -6.24155938e-03]
 [-6.24155938e-03  1.43134543e-02]]
grads:  [ 2.85772391e-03 -5.64394299e+00]
Stock Position:  0.0028577239099509097
Bond Position:  [36.2161246]


portfolio before change:  [36.62966522]
curr_Stock_Price:  128.85855165665797
curr_Factors:  [1.28858552e+02 2.24615484e-02]
mat_Sqrt:  [[ 1.93122587e+01 -5.99060978e-03]
 [-5.99060978e-03  1.37378338e-02]]
grads:  [ 6.07238110e-03 -7.73559683e+00]
Stock Position:  0.006072381097305573
Bond Position:  [35.84718699]


portfolio before change:  [36.63475448]
curr_Stock_Price:  122.31289105660477
curr_Factors:  [1.22312891e+02 2.42442487e-02]
mat_Sqrt:  [[ 1.90448069e+01 -6.22356213e-03]
 [-6.22356213e-03  1.42726928e-02]]
grads:  [ 0.02212613 -1.75785065]
Stock Position:  0.022126127572403197
Bond Position:  [33.92844385]


portfolio before change:  [36.68019469]
curr_Stock_Price:  122.44861919060637
curr_Factors:  [1.22448619e+02 2.29900330e-02]
mat_Sqrt:  [[ 1.85662274e+01 -6.06044930e-03]
 [-6.06044930e-03  1.38986073e-02]]
grads:  [6.06018717e-03 1.41790169e+01]
Stock Position:  0.006060187167060663
Bond Position:  [35.93813314]


portfolio before change:  [36.72354571]
curr_Stock_Price:  122.18464494108764
curr_Factors:  [1.22184645e+02 2.36338103e-02]
mat_Sqrt:  [[ 1.87838011e+01 -6.14470723e-03]
 [-6.14470723e-03  1.40918656e-02]]
grads:  [-6.01043386e-03 -8.82175465e+00]
Stock Position:  -0.006010433860519196
Bond Position:  [37.45792844]


portfolio before change:  [36.75721416]
curr_Stock_Price:  124.37803650381458
curr_Factors:  [1.24378037e+02 2.09646030e-02]
mat_Sqrt:  [[ 1.80088921e+01 -5.78739848e-03]
 [-5.78739848e-03  1.32722285e-02]]
grads:  [-2.06030879e-04 -1.04722836e+01]
Stock Position:  -0.00020603087937936908
Bond Position:  [36.78283988]


portfolio before change:  [36.80301935]
curr_Stock_Price:  125.35899357929925
curr_Factors:  [1.25358994e+02 2.17431704e-02]
mat_Sqrt:  [[ 1.84848916e+01 -5.89391681e-03]
 [-5.89391681e-03  1.35164140e-02]]
grads:  [ 8.81226198e-03 -1.51270720e+01]
Stock Position:  0.008812261984982455
Bond Position:  [35.69832306]


portfolio before change:  [36.84673548]
curr_Stock_Price:  125.25292858934141
curr_Factors:  [1.25252929e+02 2.30014903e-02]
mat_Sqrt:  [[ 1.89961616e+01 -6.06206077e-03]
 [-6.06206077e-03  1.39020258e-02]]
grads:  [ 5.86007256e-03 -1.08660216e+01]
Stock Position:  0.005860072555830869
Bond Position:  [36.11274424]


portfolio before change:  [36.89136341]
curr_Stock_Price:  125.16056923431464
curr_Factors:  [1.25160569e+02 2.36917657e-02]
mat_Sqrt:  [[ 1.92648762e+01 -6.15234638e-03]
 [-6.15234638e-03  1.41090854e-02]]
grads:  [-0.00631409  3.42576418]
Stock Position:  -0.006314088507661662
Bond Position:  [37.68163832]


portfolio before change:  [36.93951701]
curr_Stock_Price:  124.99869203763447
curr_Factors:  [1.24998692e+02 2.05265256e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [36.93951701]
Stock Price:  123.76354553970023
PL:  [13.17597147]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 2.19207403e-02 -4.92904447e-02]
 [ 2.33027724e-02 -6.37970969e-02]
 [ 1.63412981e-02 -2.14442662e-01]
 [-2.42915297e-02 -2.96094628e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-2.70877612e-01  4.75294048e-02]
 [ 5.14451304e-02  4.07074516e-02]
 [ 6.13132528e-02 -3.61102037e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 3.49919713e-02  3.07368374e-02]
 [ 2.54797774e-02  8.95071747e-02]
 [ 3.41366525e-03 -1.59104312e-01]
 [-4.00941043e-02 -9.11696730e-02]
 [ 1.69115264e-01 -1.02643558e-01]
 [ 9.16870805e-02 -1.50557292e-01]
 [-1.10182696e-01  4.50424619e-02]
 [-1.23601016e-01 -1.50539271e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.38231901]
curr_Stock_Price:  99.4580106412005
curr_Factors:  [9.94580106e+01 4.33803563e-02]
mat_Sqrt:  [[ 2.07150645e+01 -8.32350972e-03]
 [-8.32350972e-03  1.90924788e-02]]
grads:  [ 2.08677127e-05 -2.58165906e+00]
Stock Position:  2.0867712736460903e-05
Bond Position:  [4.38024355]


portfolio before change:  [4.38781487]
curr_Stock_Price:  100.27875391908218
curr_Factors:  [1.00278754e+02 4.43457108e-02]
mat_Sqrt:  [[ 2.11171208e+01 -8.41567620e-03]
 [-8.41567620e-03  1.93037173e-02]]
grads:  [-2.13622159e-04 -3.30500565e+00]
Stock Position:  -0.00021362215878484826
Bond Position:  [4.40923663]


portfolio before change:  [4.39247788]
curr_Stock_Price:  104.267014560736
curr_Factors:  [1.04267015e+02 4.23090472e-02]
mat_Sqrt:  [[ 2.14468507e+01 -8.22043882e-03]
 [-8.22043882e-03  1.88551016e-02]]
grads:  [-3.59792744e-03 -1.13747591e+01]
Stock Position:  -0.0035979274409448456
Bond Position:  [4.76762303]


portfolio before change:  [4.39506237]
curr_Stock_Price:  105.20610131116723
curr_Factors:  [1.05206101e+02 4.07981192e-02]
mat_Sqrt:  [[ 2.12500995e+01 -8.07238479e-03]
 [-8.07238479e-03  1.85153395e-02]]
grads:  [-0.00175091 -1.59994889]
Stock Position:  -0.0017509062894742748
Bond Position:  [4.57926839]


portfolio before change:  [4.39204047]
curr_Stock_Price:  110.20326267221719
curr_Factors:  [1.10203263e+02 3.43639323e-02]
mat_Sqrt:  [[ 2.04289409e+01 -7.40884238e-03]
 [-7.40884238e-03  1.69925977e-02]]
grads:  [ 0.00802658 -6.94716923]
Stock Position:  0.008026578609749922
Bond Position:  [3.50748532]


portfolio before change:  [4.37305383]
curr_Stock_Price:  107.29122025122321
curr_Factors:  [1.07291220e+02 3.39961668e-02]
mat_Sqrt:  [[ 1.97824069e+01 -7.36892451e-03]
 [-7.36892451e-03  1.69014976e-02]]
grads:  [0.0087437  6.28790392]
Stock Position:  0.008743701326504972
Bond Position:  [3.43493145]


portfolio before change:  [4.37690066]
curr_Stock_Price:  107.23980879762527
curr_Factors:  [1.07239809e+02 3.15953699e-02]
mat_Sqrt:  [[ 1.90619674e+01 -7.10396276e-03]
 [-7.10396276e-03  1.62937845e-02]]
grads:  [4.70825142e-03 4.97251605e+00]
Stock Position:  0.004708251420404783
Bond Position:  [3.87198867]


portfolio before change:  [4.38682128]
curr_Stock_Price:  108.31825803577486
curr_Factors:  [1.08318258e+02 3.07519247e-02]
mat_Sqrt:  [[ 1.89949340e+01 -7.00856004e-03]
 [-7.00856004e-03  1.60748043e-02]]
grads:  [-0.01317168  2.95102132]
Stock Position:  -0.013171680524944086
Bond Position:  [5.81355477]


portfolio before change:  [4.3441949]
curr_Stock_Price:  112.10652682177826
curr_Factors:  [1.12106527e+02 2.67529515e-02]
mat_Sqrt:  [[ 1.83365118e+01 -6.53718698e-03]
 [-6.53718698e-03  1.49931552e-02]]
grads:  [0.00377415 2.71671463]
Stock Position:  0.0037741530567193065
Bond Position:  [3.92108771]


portfolio before change:  [4.3511272]
curr_Stock_Price:  112.64383259503506
curr_Factors:  [1.12643833e+02 2.72038930e-02]
mat_Sqrt:  [[ 1.85790250e+01 -6.59207708e-03]
 [-6.59207708e-03  1.51189765e-02]]
grads:  [ 0.00245308 -2.38733309]
Stock Position:  0.0024530764614752914
Bond Position:  [4.07480326]


portfolio before change:  [4.34516573]
curr_Stock_Price:  108.13596106624911
curr_Factors:  [1.08135961e+02 2.68287060e-02]
mat_Sqrt:  [[ 1.77120968e+01 -6.54623951e-03]
 [-6.54623951e-03  1.50144533e-02]]
grads:  [ 5.42053271e-04 -8.14870538e+00]
Stock Position:  0.0005420532713642347
Bond Position:  [4.28655028]


portfolio before change:  [4.35041538]
curr_Stock_Price:  107.92954159464837
curr_Factors:  [1.07929542e+02 2.36852077e-02]
mat_Sqrt:  [[ 1.66103545e+01 -6.15077617e-03]
 [-6.15077617e-03  1.41074459e-02]]
grads:  [0.0029139  2.18003744]
Stock Position:  0.0029138988956341812
Bond Position:  [4.03591961]


portfolio before change:  [4.36700399]
curr_Stock_Price:  111.89006309704692
curr_Factors:  [1.11890063e+02 2.42993379e-02]
mat_Sqrt:  [[ 1.74416959e+01 -6.23019428e-03]
 [-6.23019428e-03  1.42890888e-02]]
grads:  [3.69894666e-03 6.26563535e+00]
Stock Position:  0.003698946656583767
Bond Position:  [3.95312862]


portfolio before change:  [4.36052039]
curr_Stock_Price:  108.80050550007181
curr_Factors:  [1.08800506e+02 2.44935371e-02]
mat_Sqrt:  [[ 1.70277254e+01 -6.25489506e-03]
 [-6.25489506e-03  1.43461374e-02]]
grads:  [-3.87404349e-03 -1.10920828e+01]
Stock Position:  -0.0038740434912177273
Bond Position:  [4.78201828]


portfolio before change:  [4.36005815]
curr_Stock_Price:  110.46375386106256
curr_Factors:  [1.10463754e+02 2.56982551e-02]
mat_Sqrt:  [[ 1.77080845e+01 -6.40695387e-03]
 [-6.40695387e-03  1.46946757e-02]]
grads:  [-4.50964338e-03 -6.20623198e+00]
Stock Position:  -0.004509643380950523
Bond Position:  [4.85821029]


portfolio before change:  [4.35747591]
curr_Stock_Price:  112.38381595004974
curr_Factors:  [1.12383816e+02 2.81880210e-02]
mat_Sqrt:  [[ 1.88684419e+01 -6.71024264e-03]
 [-6.71024264e-03  1.53900245e-02]]
grads:  [ 6.59199524e-03 -6.66661214e+00]
Stock Position:  0.006591995235888314
Bond Position:  [3.61664233]


portfolio before change:  [4.37319446]
curr_Stock_Price:  114.08207582472498
curr_Factors:  [1.14082076e+02 2.56606965e-02]
mat_Sqrt:  [[ 1.82747569e+01 -6.40243857e-03]
 [-6.40243857e-03  1.46838600e-02]]
grads:  [ 1.42520385e-03 -1.02526289e+01]
Stock Position:  0.0014252038462607512
Bond Position:  [4.21060425]


portfolio before change:  [4.38705841]
curr_Stock_Price:  120.11447554810952
curr_Factors:  [1.20114476e+02 2.63482271e-02]
mat_Sqrt:  [[ 1.94971451e+01 -6.48790393e-03]
 [-6.48790393e-03  1.48791590e-02]]
grads:  [-0.00464455  3.02519305]
Stock Position:  -0.004644553526730668
Bond Position:  [4.94493652]


portfolio before change:  [4.36469103]
curr_Stock_Price:  126.26198091038232
curr_Factors:  [1.26261981e+02 2.25330651e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.36469103]
Stock Price:  129.61917208513728
PL:  [-25.25448106]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-5.12675230e-02 -7.77096064e-02]
 [ 2.33027724e-02 -6.37970969e-02]
 [ 5.75583321e-02  7.12350372e-02]
 [-1.55924337e-01 -8.34496667e-02]
 [-5.28936378e-02 -7.93808139e-02]
 [ 1.27258056e-01  1.29031512e-01]
 [-8.35476960e-02 -1.03321826e-01]
 [ 3.26997220e-02 -1.40826784e-02]
 [ 1.19690856e-02  5.15783039e-03]
 [ 5.77031205e-02 -1.38125454e-02]
 [ 6.30010587e-02 -1.20539388e-01]
 [-1.06919059e-02  3.74495105e-02]
 [-1.98082570e-02 -7.65580783e-02]
 [ 1.08168157e-02  9.18285113e-02]
 [-7.08882509e-02 -5.85433793e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 2.21058058e-02 -1.29421860e-01]
 [ 1.40935172e-02  4.11500093e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.61338176]
curr_Stock_Price:  101.1234856853554
curr_Factors:  [1.01123486e+02 4.02925982e-02]
mat_Sqrt:  [[ 2.02985322e+01 -8.02193534e-03]
 [-8.02193534e-03  1.84003950e-02]]
grads:  [-4.19542131e-03 -4.22508657e+00]
Stock Position:  -0.004195421306699342
Bond Position:  [11.03763738]


portfolio before change:  [10.629652]
curr_Stock_Price:  100.53604279900799
curr_Factors:  [1.00536043e+02 4.31109468e-02]
mat_Sqrt:  [[ 2.08744736e+01 -8.29770522e-03]
 [-8.29770522e-03  1.90330648e-02]]
grads:  [-2.16108937e-04 -3.35200299e+00]
Stock Position:  -0.00021610893715085685
Bond Position:  [10.65137874]


portfolio before change:  [10.64386839]
curr_Stock_Price:  96.39997100081187
curr_Factors:  [9.63999710e+01 4.57410812e-02]
mat_Sqrt:  [[ 2.06172187e+01 -8.54673938e-03]
 [-8.54673938e-03  1.96052049e-02]]
grads:  [0.00429877 3.63534981]
Stock Position:  0.004298771845088687
Bond Position:  [10.22946691]


portfolio before change:  [10.64655209]
curr_Stock_Price:  94.04787397042764
curr_Factors:  [9.40478740e+01 5.41534856e-02]
mat_Sqrt:  [[ 2.18857861e+01 -9.29929740e-03]
 [-9.29929740e-03  2.13320867e-02]]
grads:  [-0.00878827 -3.91576279]
Stock Position:  -0.008788269204974258
Bond Position:  [11.47307013]


portfolio before change:  [10.5958428]
curr_Stock_Price:  101.45087820342589
curr_Factors:  [1.01450878e+02 5.13419451e-02]
mat_Sqrt:  [[ 2.29875103e+01 -9.05532305e-03]
 [-9.05532305e-03  2.07706662e-02]]
grads:  [-3.80711414e-03 -3.82343483e+00]
Stock Position:  -0.003807114140004528
Bond Position:  [10.98207787]


portfolio before change:  [10.6141438]
curr_Stock_Price:  100.25185579260689
curr_Factors:  [1.00251856e+02 5.02135728e-02]
mat_Sqrt:  [[ 2.24648202e+01 -8.95516645e-03]
 [-8.95516645e-03  2.05411957e-02]]
grads:  [0.00817023 6.28515884]
Stock Position:  0.008170227843531613
Bond Position:  [9.79506329]


portfolio before change:  [10.57776017]
curr_Stock_Price:  94.29913128080665
curr_Factors:  [9.42991313e+01 5.12638786e-02]
mat_Sqrt:  [[ 2.13507622e+01 -9.04781657e-03]
 [-9.04781657e-03  2.07551392e-02]]
grads:  [-0.0060238  -4.98075814]
Stock Position:  -0.006023798158319897
Bond Position:  [11.1457991]


portfolio before change:  [10.58877181]
curr_Stock_Price:  94.78542156260109
curr_Factors:  [9.47854216e+01 5.16375292e-02]
mat_Sqrt:  [[ 2.15389354e+01 -9.08077567e-03]
 [-9.08077567e-03  2.08306218e-02]]
grads:  [ 0.00123337 -0.67551889]
Stock Position:  0.0012333704499615694
Bond Position:  [10.47186627]


portfolio before change:  [10.60437402]
curr_Stock_Price:  96.81578718328518
curr_Factors:  [9.68157872e+01 4.61797830e-02]
mat_Sqrt:  [[ 2.08052092e+01 -8.58766242e-03]
 [-8.58766242e-03  1.96989818e-02]]
grads:  [0.00068349 0.2621303 ]
Stock Position:  0.000683490942409947
Bond Position:  [10.53820131]


portfolio before change:  [10.61858576]
curr_Stock_Price:  98.32384849993745
curr_Factors:  [9.83238485e+01 4.87570512e-02]
mat_Sqrt:  [[ 2.17108861e+01 -8.82417347e-03]
 [-8.82417347e-03  2.02411579e-02]]
grads:  [ 0.00238086 -0.68136103]
Stock Position:  0.0023808642496659918
Bond Position:  [10.38449002]


portfolio before change:  [10.63366147]
curr_Stock_Price:  99.20041534617133
curr_Factors:  [9.92004153e+01 4.71330556e-02]
mat_Sqrt:  [[ 2.15365559e+01 -8.67604295e-03]
 [-8.67604295e-03  1.99011767e-02]]
grads:  [ 4.85360394e-04 -6.05668594e+00]
Stock Position:  0.0004853603943593804
Bond Position:  [10.58551352]


portfolio before change:  [10.64742715]
curr_Stock_Price:  100.28313311527538
curr_Factors:  [1.00283133e+02 4.86267613e-02]
mat_Sqrt:  [[ 2.21139097e+01 -8.81253586e-03]
 [-8.81253586e-03  2.02140254e-02]]
grads:  [2.54844856e-04 1.85276091e+00]
Stock Position:  0.0002548448561532006
Bond Position:  [10.6218705]


portfolio before change:  [10.66123848]
curr_Stock_Price:  102.34591850077854
curr_Factors:  [1.02345919e+02 4.81927487e-02]
mat_Sqrt:  [[ 2.24678411e+01 -8.77328156e-03]
 [-8.77328156e-03  2.01235439e-02]]
grads:  [-2.36758016e-03 -3.80543558e+00]
Stock Position:  -0.0023675801577738523
Bond Position:  [10.90355064]


portfolio before change:  [10.68149611]
curr_Stock_Price:  99.54995235042593
curr_Factors:  [9.95499524e+01 5.03222234e-02]
mat_Sqrt:  [[ 2.23316561e+01 -8.96479192e-03]
 [-8.96479192e-03  2.05634321e-02]]
grads:  [2.27744359e-03 4.46661470e+00]
Stock Position:  0.0022774435868532753
Bond Position:  [10.45477671]


portfolio before change:  [10.68887157]
curr_Stock_Price:  97.04662592332151
curr_Factors:  [9.70466259e+01 4.81047206e-02]
mat_Sqrt:  [[ 2.12850293e+01 -8.76483703e-03]
 [-8.76483703e-03  2.01053435e-02]]
grads:  [-0.00453029 -2.9138068 ]
Stock Position:  -0.004530287056721407
Bond Position:  [11.12852064]


portfolio before change:  [10.680565]
curr_Stock_Price:  101.95269827211895
curr_Factors:  [1.01952698e+02 4.50023827e-02]
mat_Sqrt:  [[ 2.16280042e+01 -8.47788407e-03]
 [-8.47788407e-03  1.94460615e-02]]
grads:  [ 0.00502373 -3.13693102]
Stock Position:  0.005023733371382875
Bond Position:  [10.16838183]


portfolio before change:  [10.69530243]
curr_Stock_Price:  102.35459120342946
curr_Factors:  [1.02354591e+02 4.93702974e-02]
mat_Sqrt:  [[ 2.27426028e+01 -8.87981919e-03]
 [-8.87981919e-03  2.03679107e-02]]
grads:  [-1.50924766e-03 -6.35486202e+00]
Stock Position:  -0.001509247655657356
Bond Position:  [10.84978085]


portfolio before change:  [10.70783739]
curr_Stock_Price:  103.04085348099207
curr_Factors:  [1.03040853e+02 4.96766539e-02]
mat_Sqrt:  [[ 2.29660117e+01 -8.90738054e-03]
 [-8.90738054e-03  2.04309841e-02]]
grads:  [1.39507350e-03 2.01470647e+00]
Stock Position:  0.0013950735021559446
Bond Position:  [10.56408783]


portfolio before change:  [10.72643551]
curr_Stock_Price:  106.90068466415386
curr_Factors:  [1.06900685e+02 4.62989209e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.72643551]
Stock Price:  111.83832855718808
PL:  [-1.11189305]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-2.56165034e-02 -6.87109706e-02]
 [-3.90345834e-03 -9.65079845e-02]
 [ 7.33894939e-02 -3.65635447e-02]
 [-2.12359951e-02 -2.13043528e-02]
 [ 6.22207831e-02 -9.59951894e-02]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-1.96404155e-01  4.40290745e-02]
 [ 5.25820756e-02  4.12286806e-02]
 [ 6.21108851e-02 -3.72962919e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 1.90154946e-01  9.13925653e-03]
 [ 3.36301604e-02  4.56378096e-02]
 [ 9.63516125e-03 -1.16703071e-01]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 2.91073687e-02 -1.46179339e-01]
 [-2.71521616e-02  3.70098649e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.72331107]
curr_Stock_Price:  100.08372474728213
curr_Factors:  [1.00083725e+02 3.82661720e-02]
mat_Sqrt:  [[ 1.95781177e+01 -7.81753697e-03]
 [-7.81753697e-03  1.79317549e-02]]
grads:  [-2.83895773e-03 -3.83304169e+00]
Stock Position:  -0.002838957730197069
Bond Position:  [7.00744454]


portfolio before change:  [6.72347877]
curr_Stock_Price:  103.11197993323903
curr_Factors:  [1.03111980e+02 3.60968749e-02]
mat_Sqrt:  [[ 1.95904267e+01 -7.59292147e-03]
 [-7.59292147e-03  1.74159781e-02]]
grads:  [-2.34738350e-03 -5.54237077e+00]
Stock Position:  -0.002347383496786731
Bond Position:  [6.96552213]


portfolio before change:  [6.73783431]
curr_Stock_Price:  100.70794420139705
curr_Factors:  [1.00707944e+02 3.65892472e-02]
mat_Sqrt:  [[ 1.92637323e+01 -7.64436886e-03]
 [-7.64436886e-03  1.75344261e-02]]
grads:  [ 0.00298276 -2.08394294]
Stock Position:  0.002982758718972907
Bond Position:  [6.43744681]


portfolio before change:  [6.75371312]
curr_Stock_Price:  103.33201417629257
curr_Factors:  [1.03332014e+02 2.76925112e-02]
mat_Sqrt:  [[ 1.71955485e+01 -6.65052755e-03]
 [-6.65052755e-03  1.52543632e-02]]
grads:  [-0.00177542 -1.3973812 ]
Stock Position:  -0.001775419805395822
Bond Position:  [6.93717082]


portfolio before change:  [6.76349815]
curr_Stock_Price:  102.70785320024102
curr_Factors:  [1.02707853e+02 3.05973975e-02]
mat_Sqrt:  [[ 1.79657711e+01 -6.99060611e-03]
 [-6.99060611e-03  1.60345066e-02]]
grads:  [ 1.13398769e-03 -5.98629348e+00]
Stock Position:  0.0011339876898837171
Bond Position:  [6.64702871]


portfolio before change:  [6.7756623]
curr_Stock_Price:  106.1031024891453
curr_Factors:  [1.06103102e+02 2.90850607e-02]
mat_Sqrt:  [[ 1.80951855e+01 -6.81584911e-03]
 [-6.81584911e-03  1.56331317e-02]]
grads:  [0.00955896 6.79810772]
Stock Position:  0.009558964984966258
Bond Position:  [5.76142646]


portfolio before change:  [6.82190294]
curr_Stock_Price:  110.18663634676571
curr_Factors:  [1.10186636e+02 2.90414726e-02]
mat_Sqrt:  [[ 1.87775192e+01 -6.81095782e-03]
 [-6.81095782e-03  1.56213181e-02]]
grads:  [4.77960400e-03 5.18651567e+00]
Stock Position:  0.004779604004251183
Bond Position:  [6.29525446]


portfolio before change:  [6.83105533]
curr_Stock_Price:  110.45410597079493
curr_Factors:  [1.10454106e+02 3.13013846e-02]
mat_Sqrt:  [[ 1.95417571e+01 -7.07101115e-03]
 [-7.07101115e-03  1.62177263e-02]]
grads:  [-0.00906956  2.71091907]
Stock Position:  -0.00906956395109775
Bond Position:  [7.83282591]


portfolio before change:  [6.84230409]
curr_Stock_Price:  110.29405354840205
curr_Factors:  [1.10294054e+02 3.13335451e-02]
mat_Sqrt:  [[ 1.95234623e+01 -7.07463425e-03]
 [-7.07463425e-03  1.62260593e-02]]
grads:  [0.00361458 2.54246897]
Stock Position:  0.003614579871844301
Bond Position:  [6.44363743]


portfolio before change:  [6.86024902]
curr_Stock_Price:  113.0289062406615
curr_Factors:  [1.13028906e+02 2.45084195e-02]
mat_Sqrt:  [[ 1.76948608e+01 -6.25699206e-03]
 [-6.25699206e-03  1.43504092e-02]]
grads:  [ 2.59149914e-03 -2.59784068e+00]
Stock Position:  0.0025914991401146345
Bond Position:  [6.5673347]


portfolio before change:  [6.87176397]
curr_Stock_Price:  114.30255065136693
curr_Factors:  [1.14302551e+02 2.16930540e-02]
mat_Sqrt:  [[ 1.68351211e+01 -5.88670431e-03]
 [-5.88670431e-03  1.35010093e-02]]
grads:  [ 5.70112632e-04 -9.06217794e+00]
Stock Position:  0.0005701126321954458
Bond Position:  [6.80659864]


portfolio before change:  [6.87988627]
curr_Stock_Price:  113.61626392927847
curr_Factors:  [1.13616264e+02 2.12386733e-02]
mat_Sqrt:  [[ 1.65578586e+01 -5.82469867e-03]
 [-5.82469867e-03  1.33588779e-02]]
grads:  [0.01172673 0.6892466 ]
Stock Position:  0.01172673380847625
Bond Position:  [5.54753859]


portfolio before change:  [6.8172327]
curr_Stock_Price:  107.6817607723006
curr_Factors:  [1.07681761e+02 2.62642591e-02]
mat_Sqrt:  [[ 1.74511759e+01 -6.47698742e-03]
 [-6.47698742e-03  1.48556799e-02]]
grads:  [3.06779529e-03 3.07341569e+00]
Stock Position:  0.0030677952910333306
Bond Position:  [6.4868871]


portfolio before change:  [6.82298719]
curr_Stock_Price:  106.91274308454089
curr_Factors:  [1.06912743e+02 2.89002038e-02]
mat_Sqrt:  [[ 1.81752291e+01 -6.79419913e-03]
 [-6.79419913e-03  1.55833532e-02]]
grads:  [-2.26973927e-03 -7.48994717e+00]
Stock Position:  -0.00226973927135592
Bond Position:  [7.06565124]


portfolio before change:  [6.83051396]
curr_Stock_Price:  107.49025779972864
curr_Factors:  [1.07490258e+02 2.78091132e-02]
mat_Sqrt:  [[ 1.79251436e+01 -6.66474271e-03]
 [-6.66474271e-03  1.52863448e-02]]
grads:  [-4.76684284e-03 -5.70079781e+00]
Stock Position:  -0.004766842838532927
Bond Position:  [7.34290313]


portfolio before change:  [6.86076027]
curr_Stock_Price:  103.0718316969512
curr_Factors:  [1.03071832e+02 3.06154145e-02]
mat_Sqrt:  [[ 1.80347461e+01 -6.99268600e-03]
 [-6.99268600e-03  1.60392172e-02]]
grads:  [ 0.00602464 -3.80326641]
Stock Position:  0.006024637970132784
Bond Position:  [6.2397898]


portfolio before change:  [6.87409202]
curr_Stock_Price:  103.98925330310708
curr_Factors:  [1.03989253e+02 2.72232903e-02]
mat_Sqrt:  [[ 1.71576868e+01 -6.59398063e-03]
 [-6.59398063e-03  1.51245602e-02]]
grads:  [-2.01830581e-03 -9.66591065e+00]
Stock Position:  -0.002018305811953584
Bond Position:  [7.08397414]


portfolio before change:  [6.87549326]
curr_Stock_Price:  107.68505928917683
curr_Factors:  [1.07685059e+02 2.75564288e-02]
mat_Sqrt:  [[ 1.78758577e+01 -6.63440461e-03]
 [-6.63440461e-03  1.52167330e-02]]
grads:  [-6.16354460e-04  2.43191333e+00]
Stock Position:  -0.0006163544603832556
Bond Position:  [6.94186543]


portfolio before change:  [6.88382163]
curr_Stock_Price:  108.26003358604466
curr_Factors:  [1.08260034e+02 2.55924627e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.88382163]
Stock Price:  105.44062248451998
PL:  [1.44319914]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.69752841e-01  3.87116686e-03]
 [ 3.69689073e-02  8.05914749e-03]
 [ 6.13516647e-02  5.99609412e-02]
 [-1.90880545e-01 -1.02963282e-01]
 [-1.92121217e-01 -2.32995205e-03]
 [ 7.48753786e-02  6.36659688e-03]
 [-1.05034017e-01 -1.32213710e-01]
 [ 3.27703463e-02 -1.37761472e-02]
 [-6.34134130e-02 -5.41844153e-02]
 [ 6.43916967e-02  3.25799290e-01]
 [ 4.76306188e-02 -9.53448598e-02]
 [ 2.72140878e-02 -1.05259759e-01]
 [-2.10263114e-01 -9.73542620e-02]
 [ 7.25785675e-03  1.40564354e-01]
 [-9.05916660e-02  3.05502472e-01]
 [-2.59711924e-01  1.24176072e-01]
 [-1.37994625e-01  3.06141931e-01]
 [-4.35777164e-02 -1.93024673e-01]
 [-4.01067679e-02  7.35749257e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.11847958]
curr_Stock_Price:  97.98772488576594
curr_Factors:  [9.79877249e+01 3.68955139e-02]
mat_Sqrt:  [[ 1.88216815e+01 -7.67610161e-03]
 [-7.67610161e-03  1.76077427e-02]]
grads:  [0.00911029 0.22382758]
Stock Position:  0.009110289364882077
Bond Position:  [-2.01117611]


portfolio before change:  [-1.11995924]
curr_Stock_Price:  98.10143013696498
curr_Factors:  [9.81014301e+01 3.52731956e-02]
mat_Sqrt:  [[ 1.84245846e+01 -7.50545123e-03]
 [-7.50545123e-03  1.72162760e-02]]
grads:  [0.00219758 0.46907016]
Stock Position:  0.0021975795543090664
Bond Position:  [-1.33554494]


portfolio before change:  [-1.12299431]
curr_Stock_Price:  97.4804767979562
curr_Factors:  [9.74804768e+01 3.72665634e-02]
mat_Sqrt:  [[ 1.88181654e+01 -7.71456592e-03]
 [-7.71456592e-03  1.76960760e-02]]
grads:  [0.00465014 3.3904022 ]
Stock Position:  0.004650142248878123
Bond Position:  [-1.57629239]


portfolio before change:  [-1.14261762]
curr_Stock_Price:  93.68452441376914
curr_Factors:  [9.36845244e+01 3.42068101e-02]
mat_Sqrt:  [[ 1.73270291e+01 -7.39080217e-03]
 [-7.39080217e-03  1.69541778e-02]]
grads:  [-0.01360931 -6.07896574]
Stock Position:  -0.013609313895102854
Bond Position:  [0.13236448]


portfolio before change:  [-1.18144291]
curr_Stock_Price:  96.54953645512636
curr_Factors:  [9.65495365e+01 2.99074286e-02]
mat_Sqrt:  [[ 1.66970479e+01 -6.91094481e-03]
 [-6.91094481e-03  1.58528587e-02]]
grads:  [-0.01156922 -0.15201714]
Stock Position:  -0.011569218680303885
Bond Position:  [-0.06444021]


portfolio before change:  [-1.16791635]
curr_Stock_Price:  95.373384147485
curr_Factors:  [9.53733841e+01 3.02879534e-02]
mat_Sqrt:  [[ 1.65982430e+01 -6.95468992e-03]
 [-6.95468992e-03  1.59534267e-02]]
grads:  [0.00467911 0.40111374]
Stock Position:  0.004679109719320315
Bond Position:  [-1.61417888]


portfolio before change:  [-1.17834511]
curr_Stock_Price:  93.57608254997072
curr_Factors:  [9.35760825e+01 2.99030497e-02]
mat_Sqrt:  [[ 1.61816410e+01 -6.91023057e-03]
 [-6.91023057e-03  1.58517889e-02]]
grads:  [-0.0100546  -8.34500071]
Stock Position:  -0.010054598051733388
Bond Position:  [-0.23747521]


portfolio before change:  [-1.13500409]
curr_Stock_Price:  89.23597438357459
curr_Factors:  [8.92359744e+01 3.56167148e-02]
mat_Sqrt:  [[ 1.68409604e+01 -7.54121036e-03]
 [-7.54121036e-03  1.73002108e-02]]
grads:  [ 0.00158961 -0.79560647]
Stock Position:  0.0015896071179496239
Bond Position:  [-1.27685423]


portfolio before change:  [-1.13145158]
curr_Stock_Price:  92.47550319473476
curr_Factors:  [9.24755032e+01 3.71099851e-02]
mat_Sqrt:  [[ 1.78144350e+01 -7.69795077e-03]
 [-7.69795077e-03  1.76590318e-02]]
grads:  [-0.00488648 -3.07049853]
Stock Position:  -0.004886484445686391
Bond Position:  [-0.67957147]


portfolio before change:  [-1.11187162]
curr_Stock_Price:  88.29459240163708
curr_Factors:  [8.82945924e+01 4.03968480e-02]
mat_Sqrt:  [[ 1.77462993e+01 -8.03124944e-03]
 [-8.03124944e-03  1.84246442e-02]]
grads:  [1.16332647e-02 1.76878705e+01]
Stock Position:  0.011633264680126713
Bond Position:  [-2.13902598]


portfolio before change:  [-1.14327559]
curr_Stock_Price:  85.82507770362483
curr_Factors:  [8.58250777e+01 3.91596468e-02]
mat_Sqrt:  [[ 1.69837482e+01 -7.90707389e-03]
 [-7.90707389e-03  1.81404148e-02]]
grads:  [ 3.57563983e-04 -5.25578017e+00]
Stock Position:  0.00035756398253870375
Bond Position:  [-1.17396355]


portfolio before change:  [-1.14514303]
curr_Stock_Price:  84.70902617777855
curr_Factors:  [8.47090262e+01 3.80446324e-02]
mat_Sqrt:  [[ 1.65225219e+01 -7.79358013e-03]
 [-7.79358013e-03  1.78803365e-02]]
grads:  [-1.12995948e-03 -5.88739287e+00]
Stock Position:  -0.0011299594841689754
Bond Position:  [-1.04942526]


portfolio before change:  [-1.1412018]
curr_Stock_Price:  80.05945239235415
curr_Factors:  [8.00594524e+01 4.36677526e-02]
mat_Sqrt:  [[ 1.67298860e+01 -8.34917309e-03]
 [-8.34917309e-03  1.91564306e-02]]
grads:  [-0.01510764 -5.08865144]
Stock Position:  -0.01510764305176276
Bond Position:  [0.06830783]


portfolio before change:  [-1.10669303]
curr_Stock_Price:  77.78091534385865
curr_Factors:  [7.77809153e+01 4.65891047e-02]
mat_Sqrt:  [[ 1.67886268e+01 -8.62364115e-03]
 [-8.62364115e-03  1.97869619e-02]]
grads:  [4.08220266e-03 7.10566676e+00]
Stock Position:  0.004082202664003422
Bond Position:  [-1.42421049]


portfolio before change:  [-1.11539053]
curr_Stock_Price:  76.08670341986121
curr_Factors:  [7.60867034e+01 5.01696885e-02]
mat_Sqrt:  [[ 1.70423473e+01 -8.94865597e-03]
 [-8.94865597e-03  2.05333495e-02]]
grads:  [2.49727086e-03 1.48794438e+01]
Stock Position:  0.0024972708637217003
Bond Position:  [-1.30539964]


portfolio before change:  [-1.1121057]
curr_Stock_Price:  78.0558922093398
curr_Factors:  [7.80558922e+01 4.86241882e-02]
mat_Sqrt:  [[ 1.72120190e+01 -8.81001153e-03]
 [-8.81001153e-03  2.02144893e-02]]
grads:  [-0.01194738  6.13771705]
Stock Position:  -0.011947382008228018
Bond Position:  [-0.17954214]


portfolio before change:  [-1.08860213]
curr_Stock_Price:  76.06983924019974
curr_Factors:  [7.60698392e+01 5.28199775e-02]
mat_Sqrt:  [[ 1.74828224e+01 -9.18197487e-03]
 [-9.18197487e-03  2.10687236e-02]]
grads:  [-2.61728199e-04  1.45305209e+01]
Stock Position:  -0.00026172819949324264
Bond Position:  [-1.06869251]


portfolio before change:  [-1.08963498]
curr_Stock_Price:  74.90886574578033
curr_Factors:  [7.49088657e+01 5.53898101e-02]
mat_Sqrt:  [[ 1.76298289e+01 -9.40251057e-03]
 [-9.40251057e-03  2.15752380e-02]]
grads:  [-7.24497964e-03 -8.94974109e+00]
Stock Position:  -0.0072449796429394754
Bond Position:  [-0.54692177]


portfolio before change:  [-1.09821433]
curr_Stock_Price:  75.99862418084373
curr_Factors:  [7.59986242e+01 5.36249332e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.09821433]
Stock Price:  76.27182428266912
PL:  [-1.09821433]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.44503397e-01 -1.12959321e-02]
 [-1.39568067e-01  7.94782490e-02]
 [ 6.82390180e-02  3.94894746e-02]
 [-2.83925527e-02 -1.21854233e-02]
 [-1.95843672e-01 -3.60585897e-03]
 [ 7.58609572e-02  8.25254735e-03]
 [-1.04226332e-01 -1.31131622e-01]
 [ 3.17081926e-02 -1.83862179e-02]
 [-6.85709381e-02 -5.80650299e-02]
 [ 4.62686352e-02  2.48089070e-01]
 [ 5.81915929e-02 -1.09295418e-01]
 [-1.07043162e-02  3.30301075e-02]
 [-1.04978915e-01 -1.40180710e-01]
 [ 4.40089671e-03  1.64772648e-01]
 [-5.86195269e-02 -8.83568201e-02]
 [ 9.82825315e-02 -5.70906391e-02]
 [ 2.59202427e-02 -1.37725043e-01]
 [ 2.13829773e-02  4.30206404e-02]
 [-7.92969128e-02 -7.45345573e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.01024047]
curr_Stock_Price:  95.3437969416764
curr_Factors:  [9.53437969e+01 4.41375920e-02]
mat_Sqrt:  [[ 2.00307275e+01 -8.39550830e-03]
 [-8.39550830e-03  1.92585399e-02]]
grads:  [ 0.00696952 -0.58350319]
Stock Position:  0.006969521759241547
Bond Position:  [-11.67474114]


portfolio before change:  [-11.04252365]
curr_Stock_Price:  92.80694840824312
curr_Factors:  [9.28069484e+01 4.37863490e-02]
mat_Sqrt:  [[ 1.94200266e+01 -8.36181668e-03]
 [-8.36181668e-03  1.91818537e-02]]
grads:  [-0.00540377  4.14105252]
Stock Position:  -0.005403769406072512
Bond Position:  [-10.5410163]


portfolio before change:  [-11.09156367]
curr_Stock_Price:  99.442226814407
curr_Factors:  [9.94422268e+01 4.18825511e-02]
mat_Sqrt:  [[ 2.03510757e+01 -8.17855228e-03]
 [-8.17855228e-03  1.87599785e-02]]
grads:  [0.00419976 2.10681599]
Stock Position:  0.004199764376470878
Bond Position:  [-11.50919759]


portfolio before change:  [-11.12302177]
curr_Stock_Price:  95.37947245630177
curr_Factors:  [9.53794725e+01 4.86359655e-02]
mat_Sqrt:  [[ 2.10345705e+01 -8.81295605e-03]
 [-8.81295605e-03  2.02161188e-02]]
grads:  [-0.00160264 -0.60345645]
Stock Position:  -0.0016026373262045075
Bond Position:  [-10.97016307]


portfolio before change:  [-11.13895393]
curr_Stock_Price:  96.7589953002846
curr_Factors:  [9.67589953e+01 5.05750991e-02]
mat_Sqrt:  [[ 2.17600397e+01 -8.98704984e-03]
 [-8.98704984e-03  2.06151383e-02]]
grads:  [-0.00907403 -0.17886893]
Stock Position:  -0.009074026443691319
Bond Position:  [-10.26096024]


portfolio before change:  [-11.13965896]
curr_Stock_Price:  95.42230206752629
curr_Factors:  [9.54223021e+01 5.27243111e-02]
mat_Sqrt:  [[ 2.19106524e+01 -9.17589590e-03]
 [-9.17589590e-03  2.10486590e-02]]
grads:  [0.00362714 0.39365119]
Stock Position:  0.003627142549466115
Bond Position:  [-11.48576925]


portfolio before change:  [-11.16066371]
curr_Stock_Price:  93.59205646970737
curr_Factors:  [9.35920565e+01 5.18784513e-02]
mat_Sqrt:  [[ 2.13173125e+01 -9.10182270e-03]
 [-9.10182270e-03  2.08792082e-02]]
grads:  [-0.00757226 -6.28378923]
Stock Position:  -0.007572261641195062
Bond Position:  [-10.45196017]


portfolio before change:  [-11.1755089]
curr_Stock_Price:  93.82607856588635
curr_Factors:  [9.38260786e+01 5.42700798e-02]
mat_Sqrt:  [[ 2.18576645e+01 -9.30928144e-03]
 [-9.30928144e-03  2.13550481e-02]]
grads:  [ 0.00108417 -0.86050497]
Stock Position:  0.001084173908819236
Bond Position:  [-11.27723269]


portfolio before change:  [-11.19137085]
curr_Stock_Price:  92.20586275519244
curr_Factors:  [9.22058628e+01 4.92122384e-02]
mat_Sqrt:  [[ 2.04547914e+01 -8.86472038e-03]
 [-8.86472038e-03  2.03356612e-02]]
grads:  [-0.00459063 -2.85733146]
Stock Position:  -0.004590630169929487
Bond Position:  [-10.76808784]


portfolio before change:  [-11.20182077]
curr_Stock_Price:  91.5483046907409
curr_Factors:  [9.15483047e+01 5.13999852e-02]
mat_Sqrt:  [[ 2.07554313e+01 -9.05955530e-03]
 [-9.05955530e-03  2.07827888e-02]]
grads:  [7.44114040e-03 1.19404804e+01]
Stock Position:  0.007441140397295923
Bond Position:  [-11.88304456]


portfolio before change:  [-11.21017263]
curr_Stock_Price:  92.42333614788329
curr_Factors:  [9.24233361e+01 5.12354689e-02]
mat_Sqrt:  [[ 2.09202542e+01 -9.04513085e-03]
 [-9.04513085e-03  2.07494650e-02]]
grads:  [ 5.04267091e-04 -5.26716505e+00]
Stock Position:  0.0005042670907822861
Bond Position:  [-11.25677868]


portfolio before change:  [-11.22173069]
curr_Stock_Price:  97.42408467136896
curr_Factors:  [9.74240847e+01 4.58130565e-02]
mat_Sqrt:  [[ 2.08526345e+01 -8.55354646e-03]
 [-8.55354646e-03  1.96205863e-02]]
grads:  [1.77231275e-04 1.68351867e+00]
Stock Position:  0.00017723127452766302
Bond Position:  [-11.23899729]


portfolio before change:  [-11.23624097]
curr_Stock_Price:  94.86955090028665
curr_Factors:  [9.48695509e+01 4.35786459e-02]
mat_Sqrt:  [[ 1.98044904e+01 -8.34213970e-03]
 [-8.34213970e-03  1.91362265e-02]]
grads:  [-0.00838795 -7.32906685]
Stock Position:  -0.00838794694521247
Bond Position:  [-10.44048021]


portfolio before change:  [-11.24541186]
curr_Stock_Price:  94.40604442157274
curr_Factors:  [9.44060444e+01 4.92635208e-02]
mat_Sqrt:  [[ 2.09537851e+01 -8.86954329e-03]
 [-8.86954329e-03  2.03461645e-02]]
grads:  [3.63870432e-03 8.10004860e+00]
Stock Position:  0.0036387043205256967
Bond Position:  [-11.58892754]


portfolio before change:  [-11.24009108]
curr_Stock_Price:  99.85193731071244
curr_Factors:  [9.98519373e+01 4.31386046e-02]
mat_Sqrt:  [[ 2.07390810e+01 -8.30031469e-03]
 [-8.30031469e-03  1.90391917e-02]]
grads:  [-0.0046847  -4.64282864]
Stock Position:  -0.004684704483074705
Bond Position:  [-10.77231426]


portfolio before change:  [-11.25187775]
curr_Stock_Price:  99.49179897524333
curr_Factors:  [9.94917990e+01 4.19995152e-02]
mat_Sqrt:  [[ 2.03896320e+01 -8.18996807e-03]
 [-8.18996807e-03  1.87861538e-02]]
grads:  [ 0.00360018 -3.0374048 ]
Stock Position:  0.0036001769512258954
Bond Position:  [-11.61006583]


portfolio before change:  [-11.25472596]
curr_Stock_Price:  102.73426375345068
curr_Factors:  [1.02734264e+02 4.13425683e-02]
mat_Sqrt:  [[ 2.08888248e+01 -8.12589888e-03]
 [-8.12589888e-03  1.86385474e-02]]
grads:  [-1.63388379e-03 -7.38997071e+00]
Stock Position:  -0.0016338837858356178
Bond Position:  [-11.08687011]


portfolio before change:  [-11.26786584]
curr_Stock_Price:  102.28908122874427
curr_Factors:  [1.02289081e+02 4.24818494e-02]
mat_Sqrt:  [[ 2.10829293e+01 -8.23706911e-03]
 [-8.23706911e-03  1.88936282e-02]]
grads:  [1.90417353e-03 2.27782217e+00]
Stock Position:  0.001904173532118837
Bond Position:  [-11.462642]


portfolio before change:  [-11.28152254]
curr_Stock_Price:  102.64648588571156
curr_Factors:  [1.02646486e+02 4.00377798e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.28152254]
Stock Price:  99.35422850998394
PL:  [-11.28152254]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.27474278e-01 -2.43377357e-02]
 [-1.58844477e-01  8.22930088e-02]
 [ 4.10061689e-02  1.09605998e-01]
 [-2.80129203e-01 -1.52114522e-01]
 [ 3.80620821e-01  3.34700712e-02]
 [ 3.69319243e-02 -1.03717886e-01]
 [-1.67459034e-01 -2.16168872e-01]
 [ 3.23328310e-02 -1.56750968e-02]
 [-1.09934246e-01 -8.90390269e-02]
 [ 5.75477614e-02  2.96452322e-01]
 [ 5.51319358e-02 -1.00889984e-01]
 [ 2.38772571e-02 -9.25666266e-02]
 [-1.67963510e-01 -1.16770467e-01]
 [-4.95058506e-03  1.51312356e-01]
 [-9.56656740e-02  2.56516620e-01]
 [-2.32450933e-01  1.09686260e-01]
 [-1.21367287e-01  2.53798313e-01]
 [-3.03068170e-02 -1.86037675e-01]
 [-3.89974302e-02  7.87667934e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.02561834]
curr_Stock_Price:  93.20139967280795
curr_Factors:  [9.32013997e+01 4.34374570e-02]
mat_Sqrt:  [[ 1.94247121e+01 -8.32847113e-03]
 [-8.32847113e-03  1.91052647e-02]]
grads:  [ 0.00601742 -1.27125272]
Stock Position:  0.006017421795011688
Bond Position:  [-19.58645047]


portfolio before change:  [-19.05567223]
curr_Stock_Price:  92.27816077360448
curr_Factors:  [9.22781608e+01 4.40494516e-02]
mat_Sqrt:  [[ 1.93673028e+01 -8.38685380e-03]
 [-8.38685380e-03  1.92394179e-02]]
grads:  [-0.00635063  4.27454446]
Stock Position:  -0.006350626029843734
Bond Position:  [-18.46964814]


portfolio before change:  [-19.06815167]
curr_Stock_Price:  90.60556177092612
curr_Factors:  [9.06055618e+01 4.55511468e-02]
mat_Sqrt:  [[ 1.93376846e+01 -8.52845811e-03]
 [-8.52845811e-03  1.95646843e-02]]
grads:  [4.59215704e-03 5.60423878e+00]
Stock Position:  0.004592157044716413
Bond Position:  [-19.48422664]


portfolio before change:  [-19.08268137]
curr_Stock_Price:  92.74852266724285
curr_Factors:  [9.27485227e+01 4.60604682e-02]
mat_Sqrt:  [[ 1.99054103e+01 -8.57620551e-03]
 [-8.57620551e-03  1.96736723e-02]]
grads:  [-0.01740755 -7.73947084]
Stock Position:  -0.017407553518398854
Bond Position:  [-17.4681565]


portfolio before change:  [-19.07839146]
curr_Stock_Price:  91.24694710027444
curr_Factors:  [9.12469471e+01 4.31220620e-02]
mat_Sqrt:  [[ 1.89482044e+01 -8.29800531e-03]
 [-8.29800531e-03  1.90358537e-02]]
grads:  [0.02086142 1.76735858]
Stock Position:  0.02086141585622634
Bond Position:  [-20.98193197]


portfolio before change:  [-19.07699153]
curr_Stock_Price:  92.57206039659206
curr_Factors:  [9.25720604e+01 4.77889873e-02]
mat_Sqrt:  [[ 2.02368915e+01 -8.73562739e-03]
 [-8.73562739e-03  2.00394283e-02]]
grads:  [-4.09279310e-04 -5.17586927e+00]
Stock Position:  -0.0004092793098101684
Bond Position:  [-19.03910371]


portfolio before change:  [-19.10033974]
curr_Stock_Price:  91.43456885265812
curr_Factors:  [9.14345689e+01 4.49544157e-02]
mat_Sqrt:  [[ 1.93863727e+01 -8.47248915e-03]
 [-8.47248915e-03  1.94360769e-02]]
grads:  [ -0.01350125 -11.12792788]
Stock Position:  -0.013501250879088315
Bond Position:  [-17.86585869]


portfolio before change:  [-19.11840993]
curr_Stock_Price:  91.11785001934739
curr_Factors:  [9.11178500e+01 4.21504733e-02]
mat_Sqrt:  [[ 1.87070217e+01 -8.20397936e-03]
 [-8.20397936e-03  1.88201875e-02]]
grads:  [ 0.00136338 -0.83229307]
Stock Position:  0.0013633766104957177
Bond Position:  [-19.24263787]


portfolio before change:  [-19.14399135]
curr_Stock_Price:  90.00804126778371
curr_Factors:  [9.00080413e+01 4.10337219e-02]
mat_Sqrt:  [[ 1.82327310e+01 -8.09446976e-03]
 [-8.09446976e-03  1.85692428e-02]]
grads:  [-0.00815982 -4.79853041]
Stock Position:  -0.008159820150588519
Bond Position:  [-18.40954192]


portfolio before change:  [-19.16305911]
curr_Stock_Price:  89.5229133528484
curr_Factors:  [8.95229134e+01 4.38968499e-02]
mat_Sqrt:  [[ 1.87564586e+01 -8.37205808e-03]
 [-8.37205808e-03  1.92061746e-02]]
grads:  [9.95971663e-03 1.54396027e+01]
Stock Position:  0.009959716627903174
Bond Position:  [-20.05468196]


portfolio before change:  [-19.20121979]
curr_Stock_Price:  88.2099597032014
curr_Factors:  [8.82099597e+01 4.12215336e-02]
mat_Sqrt:  [[ 1.79093429e+01 -8.11280458e-03]
 [-8.11280458e-03  1.86117634e-02]]
grads:  [ 6.22945057e-04 -5.42049285e+00]
Stock Position:  0.0006229450571031899
Bond Position:  [-19.25616974]


portfolio before change:  [-19.22684238]
curr_Stock_Price:  85.7421074695053
curr_Factors:  [8.57421075e+01 4.49134140e-02]
mat_Sqrt:  [[ 1.81711386e+01 -8.46806143e-03]
 [-8.46806143e-03  1.94274567e-02]]
grads:  [-9.06609854e-04 -4.76512727e+00]
Stock Position:  -0.0009066098540859767
Bond Position:  [-19.14910774]


portfolio before change:  [-19.25098225]
curr_Stock_Price:  85.95003751099328
curr_Factors:  [8.59500375e+01 4.56642033e-02]
mat_Sqrt:  [[ 1.83668199e+01 -8.53856779e-03]
 [-8.53856779e-03  1.95891524e-02]]
grads:  [-0.01191856 -5.96617107]
Stock Position:  -0.011918561207832558
Bond Position:  [-18.22658146]


portfolio before change:  [-19.26122421]
curr_Stock_Price:  84.89659589103648
curr_Factors:  [8.48965959e+01 4.17272136e-02]
mat_Sqrt:  [[ 1.73420295e+01 -8.16208360e-03]
 [-8.16208360e-03  1.87257183e-02]]
grads:  [3.51834802e-03 8.08199028e+00]
Stock Position:  0.0035183480228721097
Bond Position:  [-19.55991998]


portfolio before change:  [-19.30715756]
curr_Stock_Price:  78.79482267839077
curr_Factors:  [7.87948227e+01 4.67705140e-02]
mat_Sqrt:  [[ 1.70405535e+01 -8.64054515e-03]
 [-8.64054515e-03  1.98253908e-02]]
grads:  [9.46924273e-04 1.29392053e+01]
Stock Position:  0.0009469242726315164
Bond Position:  [-19.38177029]


portfolio before change:  [-19.33039463]
curr_Stock_Price:  79.85645779603071
curr_Factors:  [7.98564578e+01 4.55079428e-02]
mat_Sqrt:  [[ 1.70354492e+01 -8.52325307e-03]
 [-8.52325307e-03  1.95559092e-02]]
grads:  [-0.01084125  5.60413   ]
Stock Position:  -0.010841247106743139
Bond Position:  [-18.46465104]


portfolio before change:  [-19.35236742]
curr_Stock_Price:  79.7529219545129
curr_Factors:  [7.97529220e+01 4.34344476e-02]
mat_Sqrt:  [[ 1.66212507e+01 -8.32680293e-03]
 [-8.32680293e-03  1.91052042e-02]]
grads:  [-6.47021200e-04  1.32839682e+01]
Stock Position:  -0.0006470211998180013
Bond Position:  [-19.30076559]


portfolio before change:  [-19.37415665]
curr_Stock_Price:  76.11808957577124
curr_Factors:  [7.61180896e+01 4.52076324e-02]
mat_Sqrt:  [[ 1.61842919e+01 -8.49460535e-03]
 [-8.49460535e-03  1.94914854e-02]]
grads:  [-6.88380946e-03 -9.54756119e+00]
Stock Position:  -0.006883809457235771
Bond Position:  [-18.85017422]


portfolio before change:  [-19.39039664]
curr_Stock_Price:  75.05218810232996
curr_Factors:  [7.50521881e+01 4.91009304e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.39039664]
Stock Price:  72.51626670273224
PL:  [-19.39039664]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.27458504e-01 -2.39630132e-02]
 [-2.37599406e-01  9.38171045e-02]
 [ 4.12614356e-02  1.14753780e-01]
 [-7.41399424e-01 -3.73628923e-01]
 [ 5.67471104e-01  5.90411388e-02]
 [-2.43715260e-02 -3.33715034e-01]
 [-3.07636652e-01 -3.41165297e-01]
 [ 3.28836568e-02 -1.32843454e-02]
 [-2.40239753e-01 -1.86681005e-01]
 [ 7.30578220e-02  3.62983326e-01]
 [ 5.64193990e-02 -1.04426879e-01]
 [ 1.39676179e-02 -5.48708680e-02]
 [-1.65154103e-01 -1.18060031e-01]
 [-4.45540993e-03  1.53126285e-01]
 [-1.00633668e-01  6.90950877e-02]
 [-1.11893791e-01  4.56075079e-02]
 [-9.54246317e-02  1.72129654e-01]
 [ 9.17066241e-02 -1.20188524e-01]
 [ 4.58380843e-02  5.74943044e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.5673862]
curr_Stock_Price:  92.78930690445401
curr_Factors:  [9.27893069e+01 4.80074364e-02]
mat_Sqrt:  [[ 2.03306914e+01 -8.75559070e-03]
 [-8.75559070e-03  2.00851685e-02]]
grads:  [ 0.00575654 -1.19056065]
Stock Position:  0.005756540180683099
Bond Position:  [-21.10153157]


portfolio before change:  [-20.60915292]
curr_Stock_Price:  90.11872487518181
curr_Factors:  [9.01187249e+01 4.66078397e-02]
mat_Sqrt:  [[ 1.94555934e+01 -8.62676522e-03]
 [-8.62676522e-03  1.97903340e-02]]
grads:  [-0.01011235  4.7361438 ]
Stock Position:  -0.010112351813228787
Bond Position:  [-19.69784066]


portfolio before change:  [-20.64540591]
curr_Stock_Price:  91.26735004913964
curr_Factors:  [9.12673500e+01 4.73628138e-02]
mat_Sqrt:  [[ 1.98625108e+01 -8.69646581e-03]
 [-8.69646581e-03  1.99499278e-02]]
grads:  [4.59668548e-03 5.75409374e+00]
Stock Position:  0.00459668547729769
Bond Position:  [-21.06493322]


portfolio before change:  [-20.68999882]
curr_Stock_Price:  87.29812528549736
curr_Factors:  [8.72981253e+01 5.06668876e-02]
mat_Sqrt:  [[ 1.96502005e+01 -8.99427882e-03]
 [-8.99427882e-03  2.06342391e-02]]
grads:  [ -0.04602708 -18.12729326]
Stock Position:  -0.04602708023377708
Bond Position:  [-16.67192101]


portfolio before change:  [-20.72880269]
curr_Stock_Price:  87.68813336807422
curr_Factors:  [8.76881334e+01 5.24660358e-02]
mat_Sqrt:  [[ 2.00853732e+01 -9.15261901e-03]
 [-9.15261901e-03  2.09973790e-02]]
grads:  [0.02954013 2.8247101 ]
Stock Position:  0.02954013316987413
Bond Position:  [-23.31912182]


portfolio before change:  [-20.75990012]
curr_Stock_Price:  87.6227882506558
curr_Factors:  [8.76227883e+01 5.41123072e-02]
mat_Sqrt:  [[ 2.03828566e+01 -9.29509744e-03]
 [-9.29509744e-03  2.13242640e-02]]
grads:  [-8.33393197e-03 -1.56531780e+01]
Stock Position:  -0.008333931966538692
Bond Position:  [-20.02965776]


portfolio before change:  [-20.78832504]
curr_Stock_Price:  88.0274230517318
curr_Factors:  [8.80274231e+01 5.64668660e-02]
mat_Sqrt:  [[ 2.09177412e+01 -9.49521602e-03]
 [-9.49521602e-03  2.17832397e-02]]
grads:  [ -0.02182068 -15.67133691]
Stock Position:  -0.021820682106396722
Bond Position:  [-18.86750663]


portfolio before change:  [-20.83179252]
curr_Stock_Price:  88.9379514641178
curr_Factors:  [8.89379515e+01 5.85276090e-02]
mat_Sqrt:  [[ 2.15162940e+01 -9.66702905e-03]
 [-9.66702905e-03  2.21771197e-02]]
grads:  [ 0.00125943 -0.59846232]
Stock Position:  0.0012594317683980892
Bond Position:  [-20.94380381]


portfolio before change:  [-20.86534127]
curr_Stock_Price:  83.09990815572043
curr_Factors:  [8.30999082e+01 6.17481793e-02]
mat_Sqrt:  [[ 2.06496441e+01 -9.92872076e-03]
 [-9.92872076e-03  2.27794271e-02]]
grads:  [-0.01557773 -8.2019478 ]
Stock Position:  -0.015577731054370984
Bond Position:  [-19.57083325]


portfolio before change:  [-20.94671376]
curr_Stock_Price:  86.7521510404116
curr_Factors:  [8.67521510e+01 5.70934232e-02]
mat_Sqrt:  [[ 2.07287564e+01 -9.54760422e-03]
 [-9.54760422e-03  2.19038235e-02]]
grads:  [1.11595784e-02 1.65765521e+01]
Stock Position:  0.011159578358310775
Bond Position:  [-21.91483119]


portfolio before change:  [-20.93803673]
curr_Stock_Price:  89.98593814834088
curr_Factors:  [8.99859381e+01 5.27021805e-02]
mat_Sqrt:  [[ 2.06580297e+01 -9.17343806e-03]
 [-9.17343806e-03  2.10444729e-02]]
grads:  [ 5.27691974e-04 -4.96196979e+00]
Stock Position:  0.0005276919736244019
Bond Position:  [-20.98552158]


portfolio before change:  [-20.96491481]
curr_Stock_Price:  88.79248209678946
curr_Factors:  [8.87924821e+01 5.34411883e-02]
mat_Sqrt:  [[ 2.05264670e+01 -9.23740433e-03]
 [-9.23740433e-03  2.11915607e-02]]
grads:  [-4.84864427e-04 -2.58949059e+00]
Stock Position:  -0.00048486442670190693
Bond Position:  [-20.92186249]


portfolio before change:  [-20.98990199]
curr_Stock_Price:  86.35573038520855
curr_Factors:  [8.63557304e+01 5.60308027e-02]
mat_Sqrt:  [[ 2.04411129e+01 -9.45829126e-03]
 [-9.45829126e-03  2.16990496e-02]]
grads:  [-0.01059915 -5.44541272]
Stock Position:  -0.010599149065798265
Bond Position:  [-20.07460474]


portfolio before change:  [-21.01112148]
curr_Stock_Price:  85.98877034960881
curr_Factors:  [8.59887703e+01 5.88398575e-02]
mat_Sqrt:  [[ 2.08582322e+01 -9.69243958e-03]
 [-9.69243958e-03  2.22363484e-02]]
grads:  [2.98694094e-03 6.88760731e+00]
Stock Position:  0.002986940944311572
Bond Position:  [-21.26796485]


portfolio before change:  [-21.02946637]
curr_Stock_Price:  88.75303299227963
curr_Factors:  [8.87530330e+01 5.95576811e-02]
mat_Sqrt:  [[ 2.16596807e+01 -9.75170581e-03]
 [-9.75170581e-03  2.23714337e-02]]
grads:  [-0.00325623  3.0871215 ]
Stock Position:  -0.0032562330273378207
Bond Position:  [-20.74046581]


portfolio before change:  [-21.05226369]
curr_Stock_Price:  87.78735772828968
curr_Factors:  [8.77873577e+01 5.56758330e-02]
mat_Sqrt:  [[ 2.07140631e+01 -9.42844634e-03]
 [-9.42844634e-03  2.16301348e-02]]
grads:  [-0.00444297  2.10658038]
Stock Position:  -0.00444297242283203
Bond Position:  [-20.66222688]


portfolio before change:  [-21.06788169]
curr_Stock_Price:  85.48576005774682
curr_Factors:  [8.54857601e+01 5.25320613e-02]
mat_Sqrt:  [[ 1.95932261e+01 -9.15812983e-03]
 [-9.15812983e-03  2.10106942e-02]]
grads:  [-1.04122767e-03  8.19202435e+00]
Stock Position:  -0.0010412276687806477
Bond Position:  [-20.97887155]


portfolio before change:  [-21.09592583]
curr_Stock_Price:  87.21847686318053
curr_Factors:  [8.72184769e+01 5.21227923e-02]
mat_Sqrt:  [[ 1.99123395e+01 -9.12257944e-03]
 [-9.12257944e-03  2.09286040e-02]]
grads:  [ 1.97492830e-03 -5.74192657e+00]
Stock Position:  0.0019749282960185503
Bond Position:  [-21.26817607]


portfolio before change:  [-21.12586084]
curr_Stock_Price:  85.53073458067144
curr_Factors:  [8.55307346e+01 5.34494354e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.12586084]
Stock Price:  89.55842902447787
PL:  [-21.12586084]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.40637021e-01 -1.43506682e-02]
 [-1.66980103e-01  8.33453305e-02]
 [ 5.21280397e-02  8.73763591e-02]
 [-1.60105459e-01 -8.57686802e-02]
 [ 4.32016089e-01  3.96060069e-02]
 [ 2.77699651e-02 -1.41344983e-01]
 [-1.23256933e-01 -1.56723157e-01]
 [ 3.24321390e-02 -1.52440699e-02]
 [ 1.79518431e-02  1.01761774e-02]
 [ 5.56436991e-02  1.79531054e-02]
 [ 5.96032108e-02 -1.13173389e-01]
 [-1.07820551e-02  2.77456068e-02]
 [-8.75302023e-02 -1.37687601e-01]
 [ 1.07292654e-02  6.63718334e-02]
 [-5.39426985e-02 -9.70954535e-02]
 [ 9.13273749e-02 -5.59221882e-02]
 [ 6.78907204e-03 -9.65117309e-02]
 [ 4.42856444e-02  4.91057684e-02]
 [-5.62335968e-02 -5.17897572e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.43334594]
curr_Stock_Price:  94.96342095402788
curr_Factors:  [9.4963421e+01 3.9240948e-02]
mat_Sqrt:  [[ 1.88116140e+01 -7.91609053e-03]
 [-7.91609053e-03  1.81588819e-02]]
grads:  [ 0.00714483 -0.78716901]
Stock Position:  0.007144826599228874
Bond Position:  [-13.11184312]


portfolio before change:  [-12.47056458]
curr_Stock_Price:  92.04962213393442
curr_Factors:  [9.20496221e+01 3.58536696e-02]
mat_Sqrt:  [[ 1.74296544e+01 -7.56649162e-03]
 [-7.56649162e-03  1.73575603e-02]]
grads:  [-0.00749717  4.79840494]
Stock Position:  -0.007497165984584636
Bond Position:  [-11.78045329]


portfolio before change:  [-12.50631877]
curr_Stock_Price:  94.85326953909626
curr_Factors:  [9.48532695e+01 3.35995336e-02]
mat_Sqrt:  [[ 1.73867693e+01 -7.32499184e-03]
 [-7.32499184e-03  1.68029709e-02]]
grads:  [5.18986391e-03 5.20231662e+00]
Stock Position:  0.005189863914144354
Bond Position:  [-12.99859433]


portfolio before change:  [-12.52697616]
curr_Stock_Price:  94.00565830714268
curr_Factors:  [9.40056583e+01 3.54707298e-02]
mat_Sqrt:  [[ 1.77047182e+01 -7.52613149e-03]
 [-7.52613149e-03  1.72645487e-02]]
grads:  [-0.01115698 -4.97277111]
Stock Position:  -0.01115698010073075
Bond Position:  [-11.4781569]


portfolio before change:  [-12.50108939]
curr_Stock_Price:  90.3986402728316
curr_Factors:  [9.03986403e+01 3.89139436e-02]
mat_Sqrt:  [[ 1.78325922e+01 -7.88265431e-03]
 [-7.88265431e-03  1.80832297e-02]]
grads:  [0.02519921 2.20119106]
Stock Position:  0.025199214545563703
Bond Position:  [-14.77906412]


portfolio before change:  [-12.48382807]
curr_Stock_Price:  91.8172045471495
curr_Factors:  [9.18172045e+01 3.73716282e-02]
mat_Sqrt:  [[ 1.77498642e+01 -7.72498537e-03]
 [-7.72498537e-03  1.77211987e-02]]
grads:  [-1.90712707e-03 -7.97687098e+00]
Stock Position:  -0.0019071270682228887
Bond Position:  [-12.30872099]


portfolio before change:  [-12.50137761]
curr_Stock_Price:  92.94666189609386
curr_Factors:  [9.29466619e+01 4.23770741e-02]
mat_Sqrt:  [[ 1.91337124e+01 -8.22616475e-03]
 [-8.22616475e-03  1.88706374e-02]]
grads:  [-0.01001438 -8.30949871]
Stock Position:  -0.010014378546515526
Bond Position:  [-11.57057455]


portfolio before change:  [-12.49353689]
curr_Stock_Price:  90.71856781094672
curr_Factors:  [9.07185678e+01 4.42884642e-02]
mat_Sqrt:  [[ 1.90915616e+01 -8.40943310e-03]
 [-8.40943310e-03  1.92916064e-02]]
grads:  [ 0.00135096 -0.78960294]
Stock Position:  0.0013509647084447593
Bond Position:  [-12.61609448]


portfolio before change:  [-12.5006986]
curr_Stock_Price:  97.09791554438382
curr_Factors:  [9.70979155e+01 4.10807029e-02]
mat_Sqrt:  [[ 1.96801681e+01 -8.09970398e-03]
 [-8.09970398e-03  1.85796078e-02]]
grads:  [0.0011378  0.54820282]
Stock Position:  0.0011378014444863806
Bond Position:  [-12.61117675]


portfolio before change:  [-12.51614]
curr_Stock_Price:  97.39008249583
curr_Factors:  [9.73900825e+01 4.11444643e-02]
mat_Sqrt:  [[ 1.97546984e+01 -8.10601025e-03]
 [-8.10601025e-03  1.85940109e-02]]
grads:  [0.0032135  0.96693253]
Stock Position:  0.0032134970056577044
Bond Position:  [-12.82910274]


portfolio before change:  [-12.53331668]
curr_Stock_Price:  97.03835455494658
curr_Factors:  [9.70383546e+01 3.32988769e-02]
mat_Sqrt:  [[ 1.77075379e+01 -7.29230383e-03]
 [-7.29230383e-03  1.67275543e-02]]
grads:  [ 5.79844157e-04 -6.76543374e+00]
Stock Position:  0.0005798441572992352
Bond Position:  [-12.5895838]


portfolio before change:  [-12.54936932]
curr_Stock_Price:  96.51092987968488
curr_Factors:  [9.65109299e+01 3.40522151e-02]
mat_Sqrt:  [[ 1.78093942e+01 -7.37429329e-03]
 [-7.37429329e-03  1.69157308e-02]]
grads:  [7.37634972e-05 1.64025729e+00]
Stock Position:  7.376349719448357e-05
Bond Position:  [-12.55648831]


portfolio before change:  [-12.56499619]
curr_Stock_Price:  97.57597334502162
curr_Factors:  [9.75759733e+01 2.99810099e-02]
mat_Sqrt:  [[ 1.68953030e+01 -6.91951013e-03]
 [-6.91951013e-03  1.58723180e-02]]
grads:  [-0.00873504 -8.67850829]
Stock Position:  -0.008735044783911995
Bond Position:  [-11.71266569]


portfolio before change:  [-12.60500687]
curr_Stock_Price:  100.47930140120539
curr_Factors:  [1.00479301e+02 3.06191085e-02]
mat_Sqrt:  [[ 1.75821849e+01 -6.99294753e-03]
 [-6.99294753e-03  1.60402547e-02]]
grads:  [2.25636157e-03 4.13881284e+00]
Stock Position:  0.0022563615740568165
Bond Position:  [-12.83172451]


portfolio before change:  [-12.62016307]
curr_Stock_Price:  100.8752872390077
curr_Factors:  [1.00875287e+02 3.19452375e-02]
mat_Sqrt:  [[ 1.80296714e+01 -7.14280203e-03]
 [-7.14280203e-03  1.63839175e-02]]
grads:  [-5.34061171e-03 -5.92859432e+00]
Stock Position:  -0.005340611706105795
Bond Position:  [-12.08142733]


portfolio before change:  [-12.62690504]
curr_Stock_Price:  99.3081894105674
curr_Factors:  [9.93081894e+01 3.43724869e-02]
mat_Sqrt:  [[ 1.84115565e+01 -7.40908894e-03]
 [-7.40908894e-03  1.69950072e-02]]
grads:  [ 0.00363682 -3.28892139]
Stock Position:  0.0036368171044446895
Bond Position:  [-12.98807076]


portfolio before change:  [-12.64090132]
curr_Stock_Price:  99.92657500906468
curr_Factors:  [9.99265750e+01 3.53515238e-02]
mat_Sqrt:  [[ 1.87881940e+01 -7.51390809e-03]
 [-7.51390809e-03  1.72353249e-02]]
grads:  [-1.87843026e-03 -5.60046567e+00]
Stock Position:  -0.0018784302632975872
Bond Position:  [-12.45319622]


portfolio before change:  [-12.65643139]
curr_Stock_Price:  99.90200064414253
curr_Factors:  [9.99020006e+01 3.80716520e-02]
mat_Sqrt:  [[ 1.94928352e+01 -7.79762907e-03]
 [-7.79762907e-03  1.78861259e-02]]
grads:  [0.00337074 2.7469365 ]
Stock Position:  0.0033707377894534626
Bond Position:  [-12.99317484]


portfolio before change:  [-12.66871322]
curr_Stock_Price:  101.07972351484416
curr_Factors:  [1.01079724e+02 4.05234986e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.66871322]
Stock Price:  105.55738195901534
PL:  [-18.22609518]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-4.21002350e-02 -7.33747895e-02]
 [ 2.45804573e-02 -6.01149028e-02]
 [ 7.41882080e-02 -8.62049508e-02]
 [-1.66395487e-02 -8.81096038e-03]
 [ 7.39649275e-02 -9.76902127e-02]
 [ 1.28467279e-01  1.30260906e-01]
 [-1.76374217e-02 -1.46788172e-02]
 [ 3.45767742e-02 -5.93570037e-03]
 [ 2.25893367e-02  1.40663861e-02]
 [ 5.72067356e-02  3.82831587e-03]
 [ 5.92771518e-02 -1.12277645e-01]
 [-1.07631125e-02  2.86878399e-02]
 [-1.10228489e-01 -1.40930780e-01]
 [ 4.13313534e-03  1.64420532e-01]
 [-9.37640066e-02  1.18465552e-02]
 [-8.11076739e-02  2.92440146e-02]
 [-7.08077596e-02  9.46346203e-02]
 [ 1.01158767e-01 -1.04436745e-01]
 [ 8.66111355e-02  5.79160342e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.7139654]
curr_Stock_Price:  101.41765614660365
curr_Factors:  [1.01417656e+02 3.42655604e-02]
mat_Sqrt:  [[ 1.87733793e+01 -7.39769771e-03]
 [-7.39769771e-03  1.69684906e-02]]
grads:  [-3.94718141e-03 -4.32589977e+00]
Stock Position:  -0.0039471814086139605
Bond Position:  [12.11427929]


portfolio before change:  [11.73456512]
curr_Stock_Price:  100.03758374817022
curr_Factors:  [1.00037584e+02 3.59381429e-02]
mat_Sqrt:  [[ 1.89644816e+01 -7.57600176e-03]
 [-7.57600176e-03  1.73777337e-02]]
grads:  [-8.58202418e-05 -3.45934367e+00]
Stock Position:  -8.582024178354897e-05
Bond Position:  [11.74315037]


portfolio before change:  [11.74912551]
curr_Stock_Price:  101.52587404088366
curr_Factors:  [1.01525874e+02 3.43498117e-02]
mat_Sqrt:  [[ 1.88165017e+01 -7.40679389e-03]
 [-7.40679389e-03  1.69893355e-02]]
grads:  [ 1.94573658e-03 -5.07321426e+00]
Stock Position:  0.0019457365808329655
Bond Position:  [11.5515829]


portfolio before change:  [11.76274538]
curr_Stock_Price:  101.10000030909909
curr_Factors:  [1.01100000e+02 3.79218591e-02]
mat_Sqrt:  [[ 1.96877431e+01 -7.78235861e-03]
 [-7.78235861e-03  1.78508679e-02]]
grads:  [-0.00104046 -0.49404083]
Stock Position:  -0.0010404621577491454
Bond Position:  [11.8679361]


portfolio before change:  [11.77578979]
curr_Stock_Price:  102.82979442722726
curr_Factors:  [1.02829794e+02 3.46802650e-02]
mat_Sqrt:  [[ 1.91496190e+01 -7.44242130e-03]
 [-7.44242130e-03  1.70708235e-02]]
grads:  [ 1.63867131e-03 -5.72192765e+00]
Stock Position:  0.001638671310160452
Bond Position:  [11.60728555]


portfolio before change:  [11.78488887]
curr_Stock_Price:  99.52278918305839
curr_Factors:  [9.95227892e+01 3.64998877e-02]
mat_Sqrt:  [[ 1.90137714e+01 -7.63494580e-03]
 [-7.63494580e-03  1.75130374e-02]]
grads:  [0.00974494 7.44218748]
Stock Position:  0.009744935547663107
Bond Position:  [10.81504571]


portfolio before change:  [11.7695607]
curr_Stock_Price:  96.56171985652551
curr_Factors:  [9.65617199e+01 3.25157906e-02]
mat_Sqrt:  [[ 1.74121386e+01 -7.20601395e-03]
 [-7.20601395e-03  1.65297087e-02]]
grads:  [-0.0013807  -0.88862828]
Stock Position:  -0.0013806971145596072
Bond Position:  [11.90288319]


portfolio before change:  [11.78567181]
curr_Stock_Price:  95.67578883545384
curr_Factors:  [9.56757888e+01 3.27890204e-02]
mat_Sqrt:  [[ 1.73247204e+01 -7.23616309e-03]
 [-7.23616309e-03  1.65990406e-02]]
grads:  [ 0.00184678 -0.3567879 ]
Stock Position:  0.001846782978801674
Bond Position:  [11.60897939]


portfolio before change:  [11.80322424]
curr_Stock_Price:  97.31763536023973
curr_Factors:  [9.73176354e+01 2.98735763e-02]
mat_Sqrt:  [[ 1.68203535e+01 -6.90708415e-03]
 [-6.90708415e-03  1.58438616e-02]]
grads:  [0.00170785 0.88855752]
Stock Position:  0.0017078522320339538
Bond Position:  [11.6370201]


portfolio before change:  [11.81870281]
curr_Stock_Price:  97.85819666765957
curr_Factors:  [9.78581967e+01 2.76077081e-02]
mat_Sqrt:  [[ 1.62596933e+01 -6.64000755e-03]
 [-6.64000755e-03  1.52311320e-02]]
grads:  [0.0036216  0.25292692]
Stock Position:  0.003621604122760513
Bond Position:  [11.46429916]


portfolio before change:  [11.82676061]
curr_Stock_Price:  96.12373321888701
curr_Factors:  [9.61237332e+01 2.55477540e-02]
mat_Sqrt:  [[ 1.53640940e+01 -6.38737517e-03]
 [-6.38737517e-03  1.46519275e-02]]
grads:  [ 6.72516135e-04 -7.66270172e+00]
Stock Position:  0.0006725161347927432
Bond Position:  [11.76211585]


portfolio before change:  [11.84180827]
curr_Stock_Price:  96.6230904209952
curr_Factors:  [9.66230904e+01 2.44454018e-02]
mat_Sqrt:  [[ 1.51070434e+01 -6.24808301e-03]
 [-6.24808301e-03  1.43323228e-02]]
grads:  [1.15408375e-04 2.00166863e+00]
Stock Position:  0.00011540837503640463
Bond Position:  [11.83065716]


portfolio before change:  [11.85630559]
curr_Stock_Price:  94.02150837810072
curr_Factors:  [9.40215084e+01 2.37488409e-02]
mat_Sqrt:  [[ 1.44893327e+01 -6.15825999e-03]
 [-6.15825999e-03  1.41267209e-02]]
grads:  [-0.01184984 -9.98135062]
Stock Position:  -0.01184983773492476
Bond Position:  [12.97044521]


portfolio before change:  [11.86393145]
curr_Stock_Price:  94.74703170307178
curr_Factors:  [9.47470317e+01 2.55297604e-02]
mat_Sqrt:  [[ 1.51387126e+01 -6.38503702e-03]
 [-6.38503702e-03  1.46468053e-02]]
grads:  [5.00858564e-03 1.12278759e+01]
Stock Position:  0.005008585637219637
Bond Position:  [11.38938283]


portfolio before change:  [11.86207879]
curr_Stock_Price:  91.53289281970982
curr_Factors:  [9.15328928e+01 2.59468623e-02]
mat_Sqrt:  [[ 1.47441442e+01 -6.43676618e-03]
 [-6.43676618e-03  1.47660646e-02]]
grads:  [-0.0060103   0.79966251]
Stock Position:  -0.00601030244706774
Bond Position:  [12.41221916]


portfolio before change:  [11.88767802]
curr_Stock_Price:  89.85673001720562
curr_Factors:  [8.98567300e+01 2.50615649e-02]
mat_Sqrt:  [[ 1.42250781e+01 -6.32588508e-03]
 [-6.32588508e-03  1.45120235e-02]]
grads:  [-0.00480653  2.01306241]
Stock Position:  -0.004806530544952928
Bond Position:  [12.31957713]


portfolio before change:  [11.89784842]
curr_Stock_Price:  90.9466430386637
curr_Factors:  [9.09466430e+01 2.46312612e-02]
mat_Sqrt:  [[ 1.42734828e+01 -6.27141924e-03]
 [-6.27141924e-03  1.43868660e-02]]
grads:  [-2.07104167e-03  6.57694540e+00]
Stock Position:  -0.002071041670248896
Bond Position:  [12.0862027]


portfolio before change:  [11.91744443]
curr_Stock_Price:  88.78405041832777
curr_Factors:  [8.87840504e+01 2.54000675e-02]
mat_Sqrt:  [[ 1.41498666e+01 -6.36838474e-03]
 [-6.36838474e-03  1.46097348e-02]]
grads:  [ 3.93259520e-03 -7.14672114e+00]
Stock Position:  0.003932595200241184
Bond Position:  [11.5682927]


portfolio before change:  [11.93069899]
curr_Stock_Price:  88.47513254477414
curr_Factors:  [8.84751325e+01 2.05950200e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.93069899]
Stock Price:  91.25166500512843
PL:  [11.93069899]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.34554738e-01 -1.91559296e-02]
 [-1.19305636e-01  7.64299983e-02]
 [ 4.45793955e-02  1.09812506e-01]
 [-5.26485416e-02 -2.57235219e-02]
 [ 3.96910547e-01  3.45690518e-02]
 [ 4.89229357e-02 -6.30788788e-02]
 [-1.92801146e-01 -2.48492069e-01]
 [ 3.26082454e-02 -1.44797146e-02]
 [-7.22672860e-02 -6.08052816e-02]
 [ 4.20136385e-02  2.29816185e-01]
 [ 5.87490720e-02 -1.10826914e-01]
 [-2.46977759e-03  2.21219067e-03]
 [-1.32224969e-01 -1.33175038e-01]
 [ 5.94719023e-03  1.66806079e-01]
 [-9.02493457e-02 -4.75912178e-03]
 [-8.10469470e-02  2.92117369e-02]
 [-6.71267437e-02  8.30466147e-02]
 [ 8.04395883e-02  9.51747961e-03]
 [ 1.24918501e-03 -1.21657279e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.709194]
curr_Stock_Price:  94.35511891942902
curr_Factors:  [9.43551189e+01 3.67643271e-02]
mat_Sqrt:  [[ 1.80916734e+01 -7.66216708e-03]
 [-7.66216708e-03  1.75765317e-02]]
grads:  [ 0.0069771 -1.0868168]
Stock Position:  0.006977097347529099
Bond Position:  [-15.36751885]


portfolio before change:  [-14.73536372]
curr_Stock_Price:  93.35924539210211
curr_Factors:  [9.33592454e+01 3.80284016e-02]
mat_Sqrt:  [[ 1.82058655e+01 -7.79269801e-03]
 [-7.79269801e-03  1.78761817e-02]]
grads:  [-0.00472396  4.27346214]
Stock Position:  -0.004723963057067715
Bond Position:  [-14.29433809]


portfolio before change:  [-14.75014333]
curr_Stock_Price:  92.70312604838061
curr_Factors:  [9.27031260e+01 3.91266981e-02]
mat_Sqrt:  [[ 1.83371120e+01 -7.90437243e-03]
 [-7.90437243e-03  1.81325089e-02]]
grads:  [5.04258991e-03 6.05831025e+00]
Stock Position:  0.005042589907367694
Bond Position:  [-15.21760717]


portfolio before change:  [-14.75695191]
curr_Stock_Price:  95.1275386314809
curr_Factors:  [9.51275386e+01 3.22660852e-02]
mat_Sqrt:  [[ 1.70875327e+01 -7.17818865e-03]
 [-7.17818865e-03  1.64661611e-02]]
grads:  [-0.00373805 -1.56383472]
Stock Position:  -0.0037380494412704943
Bond Position:  [-14.40136047]


portfolio before change:  [-14.75991115]
curr_Stock_Price:  91.10037985780218
curr_Factors:  [9.11003799e+01 3.79841126e-02]
mat_Sqrt:  [[ 1.77550189e+01 -7.78796945e-03]
 [-7.78796945e-03  1.78658517e-02]]
grads:  [0.023208   1.94503993]
Stock Position:  0.023207998897694277
Bond Position:  [-16.87416866]


portfolio before change:  [-14.72486575]
curr_Stock_Price:  93.51986005252475
curr_Factors:  [9.35198601e+01 3.13647608e-02]
mat_Sqrt:  [[ 1.65624583e+01 -7.07710326e-03]
 [-7.07710326e-03  1.62345994e-02]]
grads:  [ 1.29383747e-03 -3.88489550e+00]
Stock Position:  0.0012938374655630184
Bond Position:  [-14.84586525]


portfolio before change:  [-14.7471423]
curr_Stock_Price:  90.65426542663337
curr_Factors:  [9.06542654e+01 3.14893014e-02]
mat_Sqrt:  [[ 1.60868019e+01 -7.09092043e-03]
 [-7.09092043e-03  1.62668947e-02]]
grads:  [ -0.01872215 -15.28409887]
Stock Position:  -0.018722147276414122
Bond Position:  [-13.04989979]


portfolio before change:  [-14.74889482]
curr_Stock_Price:  89.8760394251066
curr_Factors:  [8.98760394e+01 3.06085924e-02]
mat_Sqrt:  [[ 1.57240915e+01 -6.99099480e-03]
 [-6.99099480e-03  1.60378276e-02]]
grads:  [ 0.00167269 -0.90211849]
Stock Position:  0.0016726905807028858
Bond Position:  [-14.89922962]


portfolio before change:  [-14.76397295]
curr_Stock_Price:  92.00287848255537
curr_Factors:  [9.20028785e+01 2.88675405e-02]
mat_Sqrt:  [[ 1.56317020e+01 -6.78941603e-03]
 [-6.78941603e-03  1.55749554e-02]]
grads:  [-0.00631999 -3.90679711]
Stock Position:  -0.006319987235258603
Bond Position:  [-14.18251594]


portfolio before change:  [-14.78357052]
curr_Stock_Price:  92.29691912928475
curr_Factors:  [9.22969191e+01 2.89541854e-02]
mat_Sqrt:  [[ 1.57051771e+01 -6.79961906e-03]
 [-6.79961906e-03  1.55983023e-02]]
grads:  [9.05574357e-03 1.47373577e+01]
Stock Position:  0.009055743570716564
Bond Position:  [-15.61938775]


portfolio before change:  [-14.78268674]
curr_Stock_Price:  94.55186572130566
curr_Factors:  [9.45518657e+01 2.74298470e-02]
mat_Sqrt:  [[ 1.56596394e+01 -6.61836746e-03]
 [-6.61836746e-03  1.51820842e-02]]
grads:  [ 6.66548907e-04 -7.29955789e+00]
Stock Position:  0.0006665489071971605
Bond Position:  [-14.84571018]


portfolio before change:  [-14.80192982]
curr_Stock_Price:  93.54017287735076
curr_Factors:  [9.35401729e+01 3.22700704e-02]
mat_Sqrt:  [[ 1.68034356e+01 -7.17851465e-03]
 [-7.17851465e-03  1.64672290e-02]]
grads:  [-8.96068952e-05  1.34299913e-01]
Stock Position:  -8.960689522918523e-05
Bond Position:  [-14.79354798]


portfolio before change:  [-14.82019771]
curr_Stock_Price:  90.91075890591141
curr_Factors:  [9.09107589e+01 3.58992706e-02]
mat_Sqrt:  [[ 1.72249533e+01 -7.57120750e-03]
 [-7.57120750e-03  1.73686362e-02]]
grads:  [-0.01104874 -7.67237502]
Stock Position:  -0.011048744765728776
Bond Position:  [-13.81574794]


portfolio before change:  [-14.85677138]
curr_Stock_Price:  92.65694755453956
curr_Factors:  [9.26569476e+01 3.69122357e-02]
mat_Sqrt:  [[ 1.78017675e+01 -7.67742807e-03]
 [-7.67742807e-03  1.76119123e-02]]
grads:  [4.4195891e-03 9.4731343e+00]
Stock Position:  0.0044195891031548395
Bond Position:  [-15.26627702]


portfolio before change:  [-14.87624479]
curr_Stock_Price:  92.57127657421545
curr_Factors:  [9.25712766e+01 3.71545699e-02]
mat_Sqrt:  [[ 1.78435939e+01 -7.70258152e-03]
 [-7.70258152e-03  1.76696332e-02]]
grads:  [-0.00517504 -0.27159494]
Stock Position:  -0.0051750408668435775
Bond Position:  [-14.39718465]


portfolio before change:  [-14.88012762]
curr_Stock_Price:  89.84184832944796
curr_Factors:  [8.98418483e+01 3.92838302e-02]
mat_Sqrt:  [[ 1.78067863e+01 -7.91997926e-03]
 [-7.91997926e-03  1.81689909e-02]]
grads:  [-0.00383711  1.6061072 ]
Stock Position:  -0.003837110750420967
Bond Position:  [-14.5353945]


portfolio before change:  [-14.90564112]
curr_Stock_Price:  91.75289396358595
curr_Factors:  [9.17528940e+01 3.84098562e-02]
mat_Sqrt:  [[ 1.79821274e+01 -7.83154941e-03]
 [-7.83154941e-03  1.79656727e-02]]
grads:  [-1.72010522e-03  4.62176647e+00]
Stock Position:  -0.0017201052191128578
Bond Position:  [-14.74781649]


portfolio before change:  [-14.93439515]
curr_Stock_Price:  97.74539344717473
curr_Factors:  [9.77453934e+01 3.07312561e-02]
mat_Sqrt:  [[ 1.71350911e+01 -7.00556365e-03]
 [-7.00556365e-03  1.60696807e-02]]
grads:  [0.00493746 0.59441562]
Stock Position:  0.004937458694384983
Bond Position:  [-15.41700899]


portfolio before change:  [-14.94824196]
curr_Stock_Price:  98.8464656099126
curr_Factors:  [9.88464656e+01 3.20313760e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.94824196]
Stock Price:  95.61538954557813
PL:  [-14.94824196]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-5.33323883e-02 -7.86786192e-02]
 [-1.62466569e-03 -9.37681220e-02]
 [ 6.71225918e-02  4.28072644e-02]
 [ 5.42518309e-03  1.23326517e-02]
 [-1.95666411e-01 -3.89178337e-02]
 [ 1.27100371e-01  1.21283648e-01]
 [ 3.45551412e-02  5.53067944e-02]
 [-7.26772025e-02  9.30828626e-02]
 [-8.37126968e-02 -6.94240084e-02]
 [ 4.08697207e-02  2.24943368e-01]
 [ 6.00390196e-02 -1.14370635e-01]
 [-9.61632683e-03  2.52732808e-02]
 [-1.31675993e-01 -1.33427027e-01]
 [ 4.25782714e-03  1.64584506e-01]
 [-5.66558131e-02 -9.19899746e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 4.83704778e-02 -1.48434103e-01]
 [-2.46674400e-02  3.67961352e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.37145805]
curr_Stock_Price:  101.05882289560049
curr_Factors:  [1.01058823e+02 4.36387941e-02]
mat_Sqrt:  [[ 2.11110859e+01 -8.34838828e-03]
 [-8.34838828e-03  1.91492129e-02]]
grads:  [-0.00415178 -4.11052299]
Stock Position:  -0.004151782187325636
Bond Position:  [10.79103227]


portfolio before change:  [10.37699992]
curr_Stock_Price:  102.97495107907893
curr_Factors:  [1.02974951e+02 4.69114543e-02]
mat_Sqrt:  [[ 2.23033967e+01 -8.65591615e-03]
 [-8.65591615e-03  1.98542101e-02]]
grads:  [-1.90609113e-03 -4.72366418e+00]
Stock Position:  -0.0019060911304548498
Bond Position:  [10.57327957]


portfolio before change:  [10.39756466]
curr_Stock_Price:  99.1242074033328
curr_Factors:  [9.91242074e+01 4.81775019e-02]
mat_Sqrt:  [[ 2.17571412e+01 -8.77163852e-03]
 [-8.77163852e-03  2.01204716e-02]]
grads:  [0.00394352 2.12926697]
Stock Position:  0.003943521397152512
Bond Position:  [10.00666622]


portfolio before change:  [10.4093848]
curr_Stock_Price:  98.9477134634253
curr_Factors:  [9.89477135e+01 4.60510769e-02]
mat_Sqrt:  [[ 2.12336973e+01 -8.57586166e-03]
 [-8.57586166e-03  1.96714353e-02]]
grads:  [5.08793500e-04 6.27153783e-01]
Stock Position:  0.0005087934999495811
Bond Position:  [10.35904085]


portfolio before change:  [10.42245477]
curr_Stock_Price:  99.16995360441743
curr_Factors:  [9.91699536e+01 4.87515412e-02]
mat_Sqrt:  [[ 2.18964772e+01 -8.82374497e-03]
 [-8.82374497e-03  2.02399836e-02]]
grads:  [-0.00971253 -1.92705366]
Stock Position:  -0.009712532248880914
Bond Position:  [11.38564615]


portfolio before change:  [10.44014117]
curr_Stock_Price:  98.81521171098159
curr_Factors:  [9.88152117e+01 5.16735139e-02]
mat_Sqrt:  [[ 2.24624833e+01 -9.08429712e-03]
 [-9.08429712e-03  2.08377226e-02]]
grads:  [0.00801364 5.82388243]
Stock Position:  0.008013639741411805
Bond Position:  [9.64827166]


portfolio before change:  [10.48353028]
curr_Stock_Price:  102.72370157769305
curr_Factors:  [1.02723702e+02 5.31414491e-02]
mat_Sqrt:  [[ 2.36803068e+01 -9.21275123e-03]
 [-9.21275123e-03  2.11314861e-02]]
grads:  [2.47789639e-03 2.61834981e+00]
Stock Position:  0.002477896386390077
Bond Position:  [10.22899159]


portfolio before change:  [10.49163689]
curr_Stock_Price:  100.83192675059732
curr_Factors:  [1.00831927e+02 5.16757210e-02]
mat_Sqrt:  [[ 2.29214087e+01 -9.08465953e-03]
 [-9.08465953e-03  2.08380942e-02]]
grads:  [-1.40052341e-03  4.46634602e+00]
Stock Position:  -0.0014005234143694095
Bond Position:  [10.63285437]


portfolio before change:  [10.51813727]
curr_Stock_Price:  91.40616416508531
curr_Factors:  [9.14061642e+01 6.06810218e-02]
mat_Sqrt:  [[ 2.25165519e+01 -9.84353637e-03]
 [-9.84353637e-03  2.25812978e-02]]
grads:  [-0.00506283 -3.07660991]
Stock Position:  -0.005062827506426647
Bond Position:  [10.98091092]


portfolio before change:  [10.52623273]
curr_Stock_Price:  92.52002057128715
curr_Factors:  [9.25200206e+01 5.86442725e-02]
mat_Sqrt:  [[ 2.24051823e+01 -9.67704472e-03]
 [-9.67704472e-03  2.21990435e-02]]
grads:  [6.20184989e-03 1.01357242e+01]
Stock Position:  0.006201849891224954
Bond Position:  [9.95243745]


portfolio before change:  [10.57425123]
curr_Stock_Price:  98.25543389151339
curr_Factors:  [9.82554339e+01 5.77217083e-02]
mat_Sqrt:  [[ 2.36062026e+01 -9.60118035e-03]
 [-9.60118035e-03  2.20234970e-02]]
grads:  [ 4.31274586e-04 -5.19293072e+00]
Stock Position:  0.0004312745855401623
Bond Position:  [10.53187616]


portfolio before change:  [10.58621712]
curr_Stock_Price:  95.45632206325553
curr_Factors:  [9.54563221e+01 5.52954303e-02]
mat_Sqrt:  [[ 2.24465335e+01 -9.39696892e-03]
 [-9.39696892e-03  2.15557714e-02]]
grads:  [6.24372404e-05 1.17248727e+00]
Stock Position:  6.243724035050989e-05
Bond Position:  [10.58025709]


portfolio before change:  [10.59917359]
curr_Stock_Price:  91.01794289897967
curr_Factors:  [9.10179429e+01 5.76792227e-02]
mat_Sqrt:  [[ 2.18593213e+01 -9.59693496e-03]
 [-9.59693496e-03  2.20157005e-02]]
grads:  [-0.00868622 -6.06432616]
Stock Position:  -0.008686222875676252
Bond Position:  [11.38977573]


portfolio before change:  [10.58262236]
curr_Stock_Price:  94.56348335078745
curr_Factors:  [9.45634834e+01 5.33901195e-02]
mat_Sqrt:  [[ 2.18501222e+01 -9.23357077e-03]
 [-9.23357077e-03  2.11811795e-02]]
grads:  [3.47913913e-03 7.77183493e+00]
Stock Position:  0.0034791391298450896
Bond Position:  [10.25362284]


portfolio before change:  [10.61536529]
curr_Stock_Price:  100.2884299200578
curr_Factors:  [1.00288430e+02 4.99093147e-02]
mat_Sqrt:  [[ 2.24048273e+01 -8.92799727e-03]
 [-8.92799727e-03  2.04788675e-02]]
grads:  [-4.3194580e-03 -4.4938295e+00]
Stock Position:  -0.004319457998670527
Bond Position:  [11.04855695]


portfolio before change:  [10.61629798]
curr_Stock_Price:  103.27182258070079
curr_Factors:  [1.03271823e+02 5.13560561e-02]
mat_Sqrt:  [[ 2.34033292e+01 -9.05671153e-03]
 [-9.05671153e-03  2.07734575e-02]]
grads:  [ 0.00464262 -2.93651153]
Stock Position:  0.0046426183795786145
Bond Position:  [10.13684632]


portfolio before change:  [10.64972052]
curr_Stock_Price:  107.73989619212311
curr_Factors:  [1.07739896e+02 4.25409421e-02]
mat_Sqrt:  [[ 2.22218430e+01 -8.24316945e-03]
 [-8.24316945e-03  1.89066015e-02]]
grads:  [-7.35698699e-04 -7.85123480e+00]
Stock Position:  -0.0007356986990577354
Bond Position:  [10.72898462]


portfolio before change:  [10.66343381]
curr_Stock_Price:  107.34072316322546
curr_Factors:  [1.07340723e+02 4.54413445e-02]
mat_Sqrt:  [[ 2.28817941e+01 -8.51951533e-03]
 [-8.51951533e-03  1.95405042e-02]]
grads:  [-3.76980818e-04  1.88290554e+00]
Stock Position:  -0.00037698081841351134
Bond Position:  [10.7038992]


portfolio before change:  [10.67557354]
curr_Stock_Price:  110.65258025636282
curr_Factors:  [1.1065258e+02 3.9998321e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.67557354]
Stock Price:  113.26349264803575
PL:  [-2.58791911]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-3.02653262e-02 -6.77304908e-02]
 [-1.76937162e-02 -1.13088435e-01]
 [ 5.48301628e-02 -2.02112722e-01]
 [-2.33901172e-02 -2.71593742e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.28370750e-01  1.24782501e-01]
 [ 5.00001483e-03  1.57643221e-02]
 [-8.93516804e-02  9.04790854e-02]
 [ 7.27414040e-02  6.42993602e-02]
 [ 6.49728622e-02 -5.08116218e-02]
 [ 6.24232082e-02 -1.20920434e-01]
 [-1.07039160e-02  3.67085568e-02]
 [ 3.45698684e-02  3.29799677e-02]
 [ 1.22613602e-02 -8.73610680e-04]
 [-5.30931542e-02 -9.78334665e-02]
 [ 9.46766582e-02 -5.64990269e-02]
 [ 1.17085580e-02 -1.07092889e-01]
 [ 5.23911936e-02  4.28751427e-02]
 [ 2.31912685e-02  2.38321136e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.1737706]
curr_Stock_Price:  101.80784145335129
curr_Factors:  [1.01807841e+02 3.94517616e-02]
mat_Sqrt:  [[ 2.02215479e+01 -7.93784043e-03]
 [-7.93784043e-03  1.82073695e-02]]
grads:  [-2.95743554e-03 -3.72123861e+00]
Stock Position:  -0.0029574355442675586
Bond Position:  [13.47486073]


portfolio before change:  [13.18399064]
curr_Stock_Price:  104.05102388638561
curr_Factors:  [1.04051024e+02 3.70788204e-02]
mat_Sqrt:  [[ 2.00359196e+01 -7.69556555e-03]
 [-7.69556555e-03  1.76512457e-02]]
grads:  [-3.34444723e-03 -6.40828272e+00]
Stock Position:  -0.003344447233430353
Bond Position:  [13.5319838]


portfolio before change:  [13.20166457]
curr_Stock_Price:  103.8272586265486
curr_Factors:  [1.03827259e+02 3.76490320e-02]
mat_Sqrt:  [[ 2.01459737e+01 -7.75449768e-03]
 [-7.75449768e-03  1.77864579e-02]]
grads:  [-1.65254105e-03 -1.13640129e+01]
Stock Position:  -0.001652541054215223
Bond Position:  [13.37324338]


portfolio before change:  [13.21736484]
curr_Stock_Price:  104.44856735239192
curr_Factors:  [1.04448567e+02 4.01227274e-02]
mat_Sqrt:  [[ 2.09217341e+01 -8.00523832e-03]
 [-8.00523832e-03  1.83614660e-02]]
grads:  [-0.00168423 -1.47988493]
Stock Position:  -0.0016842269599885373
Bond Position:  [13.39327993]


portfolio before change:  [13.23412727]
curr_Stock_Price:  104.44241461233617
curr_Factors:  [1.04442415e+02 4.05796853e-02]
mat_Sqrt:  [[ 2.10392963e+01 -8.05069469e-03]
 [-8.05069469e-03  1.84657296e-02]]
grads:  [ 0.00779393 -6.39277061]
Stock Position:  0.007793926901297835
Bond Position:  [12.42011072]


portfolio before change:  [13.20656764]
curr_Stock_Price:  98.91317678868806
curr_Factors:  [9.89131768e+01 4.01147289e-02]
mat_Sqrt:  [[ 1.98109839e+01 -8.00404758e-03]
 [-8.00404758e-03  1.83598069e-02]]
grads:  [0.00922733 6.80052668]
Stock Position:  0.009227330139708698
Bond Position:  [12.2938631]


portfolio before change:  [13.20736433]
curr_Stock_Price:  97.33306170363852
curr_Factors:  [9.73330617e+01 3.69655039e-02]
mat_Sqrt:  [[ 1.87136569e+01 -7.68333057e-03]
 [-7.68333057e-03  1.76244566e-02]]
grads:  [6.34539290e-04 8.94733825e-01]
Stock Position:  0.0006345392900788295
Bond Position:  [13.14560268]


portfolio before change:  [13.22615949]
curr_Stock_Price:  101.04107687521189
curr_Factors:  [1.01041077e+02 3.85760605e-02]
mat_Sqrt:  [[ 1.98452635e+01 -7.84919533e-03]
 [-7.84919533e-03  1.80041867e-02]]
grads:  [-2.51518820e-03  5.02435044e+00]
Stock Position:  -0.002515188195243385
Bond Position:  [13.48029682]


portfolio before change:  [13.24012508]
curr_Stock_Price:  102.19221141419142
curr_Factors:  [1.02192211e+02 3.95843693e-02]
mat_Sqrt:  [[ 2.03319779e+01 -7.95119672e-03]
 [-7.95119672e-03  1.82379320e-02]]
grads:  [0.00495727 3.52774517]
Stock Position:  0.0049572747090597
Bond Position:  [12.73353021]


portfolio before change:  [13.26132467]
curr_Stock_Price:  103.2558456740579
curr_Factors:  [1.03255846e+02 3.85962216e-02]
mat_Sqrt:  [[ 2.02855605e+01 -7.85139883e-03]
 [-7.85139883e-03  1.80088243e-02]]
grads:  [ 2.11123018e-03 -2.82056424e+00]
Stock Position:  0.002111230181739597
Bond Position:  [13.04332781]


portfolio before change:  [13.27780229]
curr_Stock_Price:  103.33317726993708
curr_Factors:  [1.03333177e+02 4.45232032e-02]
mat_Sqrt:  [[ 2.18038383e+01 -8.43272878e-03]
 [-8.43272878e-03  1.93422108e-02]]
grads:  [ 4.45174185e-04 -6.25144051e+00]
Stock Position:  0.0004451741845077341
Bond Position:  [13.23180103]


portfolio before change:  [13.29316256]
curr_Stock_Price:  100.66047299992807
curr_Factors:  [1.00660473e+02 4.83991975e-02]
mat_Sqrt:  [[ 2.21451187e+01 -8.79192129e-03]
 [-8.79192129e-03  2.01666580e-02]]
grads:  [2.39356689e-04 1.82036415e+00]
Stock Position:  0.0002393566887393982
Bond Position:  [13.26906881]


portfolio before change:  [13.31110612]
curr_Stock_Price:  106.28744532111736
curr_Factors:  [1.06287445e+02 4.37163241e-02]
mat_Sqrt:  [[ 2.22230548e+01 -8.35617350e-03]
 [-8.35617350e-03  1.91660535e-02]]
grads:  [0.00220297 1.72170949]
Stock Position:  0.002202972189209741
Bond Position:  [13.07695784]


portfolio before change:  [13.31953819]
curr_Stock_Price:  102.69032902610282
curr_Factors:  [1.02690329e+02 4.28471244e-02]
mat_Sqrt:  [[ 2.12564313e+01 -8.27243498e-03]
 [-8.27243498e-03  1.89746690e-02]]
grads:  [ 0.00055901 -0.04579718]
Stock Position:  0.000559007568626541
Bond Position:  [13.26213352]


portfolio before change:  [13.33524787]
curr_Stock_Price:  101.11904165647005
curr_Factors:  [1.01119042e+02 4.13606872e-02]
mat_Sqrt:  [[ 2.05649086e+01 -8.12756359e-03]
 [-8.12756359e-03  1.86426817e-02]]
grads:  [-4.65655641e-03 -5.24985163e+00]
Stock Position:  -0.004656556414387094
Bond Position:  [13.80611439]


portfolio before change:  [13.36061475]
curr_Stock_Price:  99.37989248982787
curr_Factors:  [9.93798925e+01 4.20806376e-02]
mat_Sqrt:  [[ 2.03863578e+01 -8.19786525e-03]
 [-8.19786525e-03  1.88042916e-02]]
grads:  [ 0.0034365  -3.00308335]
Stock Position:  0.0034365032781337526
Bond Position:  [13.01909542]


portfolio before change:  [13.38137844]
curr_Stock_Price:  100.68344152330728
curr_Factors:  [1.00683442e+02 3.86779948e-02]
mat_Sqrt:  [[ 1.98011308e+01 -7.85953363e-03]
 [-7.85953363e-03  1.80279694e-02]]
grads:  [-1.76687228e-03 -5.94114477e+00]
Stock Position:  -0.0017668722767456631
Bond Position:  [13.55927322]


portfolio before change:  [13.40070074]
curr_Stock_Price:  99.34626790081623
curr_Factors:  [9.93462679e+01 4.13060055e-02]
mat_Sqrt:  [[ 2.01910136e+01 -8.12205795e-03]
 [-8.12205795e-03  1.86304114e-02]]
grads:  [0.00352114 2.3028875 ]
Stock Position:  0.0035211396861221517
Bond Position:  [13.05088866]


portfolio before change:  [13.41239898]
curr_Stock_Price:  98.03260964896647
curr_Factors:  [9.80326096e+01 4.03717790e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.41239898]
Stock Price:  97.3496602345857
PL:  [13.41239898]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.67915972e-01  3.88614930e-03]
 [ 3.67378749e-03  4.91689349e-02]
 [ 7.16995364e-02 -1.00997535e-02]
 [-1.73910579e-02 -1.08536034e-02]
 [-1.80549048e-01 -4.73296384e-02]
 [ 1.26636368e-01  1.06210561e-01]
 [ 4.11074649e-02  6.37758068e-02]
 [-2.98709742e-01  4.88423102e-02]
 [ 6.86060053e-02  5.88096844e-02]
 [ 6.50671200e-02 -5.10258631e-02]
 [ 7.15276749e-02 -1.38082841e-01]
 [ 1.60003167e-01  1.34689767e-02]
 [ 2.46352006e-02  9.40531018e-02]
 [-4.86354794e-04 -1.91713619e-01]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.62509659e-01 -9.45297588e-02]
 [ 7.24480496e-02 -1.48625577e-01]
 [-5.63230047e-02  3.95068338e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.32374448]
curr_Stock_Price:  97.66557460677427
curr_Factors:  [9.76655746e+01 4.17370596e-02]
mat_Sqrt:  [[ 1.99527333e+01 -8.16419783e-03]
 [-8.16419783e-03  1.87274256e-02]]
grads:  [0.00850211 0.21121762]
Stock Position:  0.008502113049510207
Bond Position:  [-3.15410823]


portfolio before change:  [-2.33475457]
curr_Stock_Price:  96.83460529535714
curr_Factors:  [9.68346053e+01 4.42754821e-02]
mat_Sqrt:  [[ 2.03756841e+01 -8.40873661e-03]
 [-8.40873661e-03  1.92885450e-02]]
grads:  [1.23251008e-03 2.54966348e+00]
Stock Position:  0.0012325100828334621
Bond Position:  [-2.4541042]


portfolio before change:  [-2.33354266]
curr_Stock_Price:  100.30837519160063
curr_Factors:  [1.00308375e+02 4.29689809e-02]
mat_Sqrt:  [[ 2.07928819e+01 -8.28401451e-03]
 [-8.28401451e-03  1.90017081e-02]]
grads:  [ 0.00323708 -0.53010695]
Stock Position:  0.0032370752130409276
Bond Position:  [-2.65824842]


portfolio before change:  [-2.3330795]
curr_Stock_Price:  101.47858326042267
curr_Factors:  [1.01478583e+02 4.30011831e-02]
mat_Sqrt:  [[ 2.10433347e+01 -8.28720532e-03]
 [-8.28720532e-03  1.90087890e-02]]
grads:  [-0.00105148 -0.57143657]
Stock Position:  -0.0010514811623075315
Bond Position:  [-2.22637668]


portfolio before change:  [-2.3338632]
curr_Stock_Price:  99.5755422573847
curr_Factors:  [9.95755423e+01 4.78607105e-02]
mat_Sqrt:  [[ 2.17842301e+01 -8.74278859e-03]
 [-8.74278859e-03  2.00541954e-02]]
grads:  [-0.00923687 -2.36411351]
Stock Position:  -0.009236865010634157
Bond Position:  [-1.41409736]


portfolio before change:  [-2.39851568]
curr_Stock_Price:  106.38345337712016
curr_Factors:  [1.06383453e+02 4.48023981e-02]
mat_Sqrt:  [[ 2.25177340e+01 -8.45934230e-03]
 [-8.45934230e-03  1.94026676e-02]]
grads:  [0.00768156 5.47736756]
Stock Position:  0.007681558699687132
Bond Position:  [-3.21570643]


portfolio before change:  [-2.42362137]
curr_Stock_Price:  103.63875716231466
curr_Factors:  [1.03638757e+02 4.56155932e-02]
mat_Sqrt:  [[ 2.21349644e+01 -8.53557396e-03]
 [-8.53557396e-03  1.95780466e-02]]
grads:  [3.11379873e-03 3.25887389e+00]
Stock Position:  0.003113798730641145
Bond Position:  [-2.74633161]


portfolio before change:  [-2.41497045]
curr_Stock_Price:  107.52018493212213
curr_Factors:  [1.07520185e+02 4.71497300e-02]
mat_Sqrt:  [[ 2.33469191e+01 -8.67819743e-03]
 [-8.67819743e-03  1.99044264e-02]]
grads:  [-0.01188421  2.4486602 ]
Stock Position:  -0.011884214117999642
Bond Position:  [-1.13717755]


portfolio before change:  [-2.3956237]
curr_Stock_Price:  105.77256347478695
curr_Factors:  [1.05772563e+02 4.97905677e-02]
mat_Sqrt:  [[ 2.36018767e+01 -8.91779219e-03]
 [-8.91779219e-03  2.04543066e-02]]
grads:  [0.00399382 2.87691495]
Stock Position:  0.0039938237130484775
Bond Position:  [-2.81806068]


portfolio before change:  [-2.40954962]
curr_Stock_Price:  103.16825837991139
curr_Factors:  [1.03168258e+02 4.90363143e-02]
mat_Sqrt:  [[ 2.28457267e+01 -8.84979532e-03]
 [-8.84979532e-03  2.02988735e-02]]
grads:  [ 1.87467741e-03 -2.51291149e+00]
Stock Position:  0.0018746774060918816
Bond Position:  [-2.60295682]


portfolio before change:  [-2.41681305]
curr_Stock_Price:  101.0304523634305
curr_Factors:  [1.01030452e+02 5.26668864e-02]
mat_Sqrt:  [[ 2.31857466e+01 -9.17138617e-03]
 [-9.17138617e-03  2.10369803e-02]]
grads:  [ 4.88677347e-04 -6.56360168e+00]
Stock Position:  0.0004886773474374949
Bond Position:  [-2.46618434]


portfolio before change:  [-2.41428054]
curr_Stock_Price:  112.52507417726986
curr_Factors:  [1.12525074e+02 4.95412556e-02]
mat_Sqrt:  [[ 2.50456776e+01 -8.89589975e-03]
 [-8.89589975e-03  2.04028313e-02]]
grads:  [0.00662396 0.66304047]
Stock Position:  0.00662395769587038
Bond Position:  [-3.15964187]


portfolio before change:  [-2.41936719]
curr_Stock_Price:  112.35378215007735
curr_Factors:  [1.12353782e+02 4.49951776e-02]
mat_Sqrt:  [[ 2.38325578e+01 -8.47791039e-03]
 [-8.47791039e-03  1.94441974e-02]]
grads:  [2.75479028e-03 4.83827925e+00]
Stock Position:  0.002754790282492461
Bond Position:  [-2.7288783]


portfolio before change:  [-2.42888276]
curr_Stock_Price:  110.13860834665266
curr_Factors:  [1.10138608e+02 4.90276453e-02]
mat_Sqrt:  [[ 2.43870952e+01 -8.84951019e-03]
 [-8.84951019e-03  2.02968624e-02]]
grads:  [-3.44803407e-03 -9.44698391e+00]
Stock Position:  -0.003448034073612658
Bond Position:  [-2.04912109]


portfolio before change:  [-2.4236348]
curr_Stock_Price:  107.8732681292949
curr_Factors:  [1.07873268e+02 5.43879472e-02]
mat_Sqrt:  [[ 2.51573644e+01 -9.32056985e-03]
 [-9.32056985e-03  2.13777092e-02]]
grads:  [-3.39647783e-03 -4.07640723e+00]
Stock Position:  -0.0033964778253366807
Bond Position:  [-2.05724563]


portfolio before change:  [-2.43747796]
curr_Stock_Price:  111.1914101487312
curr_Factors:  [1.11191410e+02 5.10353352e-02]
mat_Sqrt:  [[ 2.51192516e+01 -9.02895776e-03]
 [-9.02895776e-03  2.07082417e-02]]
grads:  [ 0.00482948 -4.56273184]
Stock Position:  0.004829480900245489
Bond Position:  [-2.97447475]


portfolio before change:  [-2.43290547]
curr_Stock_Price:  112.90855163705228
curr_Factors:  [1.12908552e+02 4.62900614e-02]
mat_Sqrt:  [[ 2.42924148e+01 -8.59906941e-03]
 [-8.59906941e-03  1.97219831e-02]]
grads:  [ 3.14762136e-04 -7.53589884e+00]
Stock Position:  0.0003147621357223885
Bond Position:  [-2.46844481]


portfolio before change:  [-2.43636021]
curr_Stock_Price:  111.74180742773197
curr_Factors:  [1.11741807e+02 4.65454171e-02]
mat_Sqrt:  [[ 2.41076083e+01 -8.62268182e-03]
 [-8.62268182e-03  1.97763376e-02]]
grads:  [-1.62204919e-03  1.99697478e+00]
Stock Position:  -0.0016220491913925804
Bond Position:  [-2.2551095]


portfolio before change:  [-2.43543911]
curr_Stock_Price:  109.43500631202052
curr_Factors:  [1.09435006e+02 4.39928105e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.43543911]
Stock Price:  112.73114253187224
PL:  [-15.16658164]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-5.68538640e-02 -8.00821208e-02]
 [ 3.76304574e-02 -2.59692208e-02]
 [ 7.13096347e-02 -4.01659029e-03]
 [-2.54478654e-01 -1.38509432e-01]
 [-2.11558094e-01 -1.45800862e-02]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-2.26966347e-01  6.92143036e-02]
 [ 2.67341810e-02  1.75425743e-02]
 [ 5.92872681e-02 -2.33963365e-02]
 [ 6.08339557e-02 -1.16086375e-01]
 [-1.62499183e-03 -4.64684796e-04]
 [-1.13904912e-01 -1.41456075e-01]
 [ 2.65554937e-03  1.62477453e-01]
 [-8.76273888e-02 -1.20161826e-02]
 [-2.61121458e-02  1.26909033e-05]
 [-2.58726163e-02 -5.10328328e-03]
 [ 2.71118629e-02  4.44869247e-02]
 [-4.16503746e-02 -4.06383515e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.84493306]
curr_Stock_Price:  100.9180902044319
curr_Factors:  [1.00918090e+02 3.95650774e-02]
mat_Sqrt:  [[ 2.00735877e+01 -7.94916899e-03]
 [-7.94916899e-03  1.82335264e-02]]
grads:  [-0.00457231 -4.39401929]
Stock Position:  -0.00457231001370099
Bond Position:  [10.30636185]


portfolio before change:  [9.86622983]
curr_Stock_Price:  99.07968270950413
curr_Factors:  [9.90796827e+01 3.82599621e-02]
mat_Sqrt:  [[ 1.93801369e+01 -7.81683014e-03]
 [-7.81683014e-03  1.79303315e-02]]
grads:  [ 1.35776413e-03 -1.44774832e+00]
Stock Position:  0.0013577641313281435
Bond Position:  [9.731703]


portfolio before change:  [9.87994317]
curr_Stock_Price:  100.21470985748938
curr_Factors:  [1.00214710e+02 3.96772301e-02]
mat_Sqrt:  [[ 1.99619109e+01 -7.96037683e-03]
 [-7.96037683e-03  1.82593730e-02]]
grads:  [ 0.00348517 -0.21845476]
Stock Position:  0.003485169975867591
Bond Position:  [9.53067787]


portfolio before change:  [9.86678859]
curr_Stock_Price:  93.01983174810933
curr_Factors:  [9.30198317e+01 4.54074449e-02]
mat_Sqrt:  [[ 1.98216152e+01 -8.51521834e-03]
 [-8.51521834e-03  1.95337018e-02]]
grads:  [-0.01588757 -7.09771857]
Stock Position:  -0.015887568865464313
Bond Position:  [11.34464757]


portfolio before change:  [9.79993228]
curr_Stock_Price:  98.12105215961918
curr_Factors:  [9.81210522e+01 4.37969332e-02]
mat_Sqrt:  [[ 2.05344942e+01 -8.36327419e-03]
 [-8.36327419e-03  1.91839771e-02]]
grads:  [-0.01061399 -0.76464092]
Stock Position:  -0.010613993832960203
Bond Position:  [10.84138852]


portfolio before change:  [9.69743829]
curr_Stock_Price:  109.05512670123422
curr_Factors:  [1.09055127e+02 3.52125917e-02]
mat_Sqrt:  [[ 2.04642133e+01 -7.49970401e-03]
 [-7.49970401e-03  1.72011731e-02]]
grads:  [0.0084524  6.17829673]
Stock Position:  0.008452402379839116
Bond Position:  [8.77566047]


portfolio before change:  [9.68729155]
curr_Stock_Price:  106.55605335006807
curr_Factors:  [1.06556053e+02 3.77866892e-02]
mat_Sqrt:  [[ 2.07132152e+01 -7.76883674e-03]
 [-7.76883674e-03  1.78188683e-02]]
grads:  [4.33290522e-03 4.54693966e+00]
Stock Position:  0.004332905221542331
Bond Position:  [9.22559427]


portfolio before change:  [9.68324701]
curr_Stock_Price:  102.95944915736183
curr_Factors:  [1.02959449e+02 4.15220088e-02]
mat_Sqrt:  [[ 2.09799938e+01 -8.14353022e-03]
 [-8.14353022e-03  1.86789455e-02]]
grads:  [-0.00938151  3.7013816 ]
Stock Position:  -0.009381510590188819
Bond Position:  [10.64916217]


portfolio before change:  [9.74768013]
curr_Stock_Price:  97.51114209025751
curr_Factors:  [9.75111421e+01 4.00853730e-02]
mat_Sqrt:  [[ 1.95230277e+01 -8.00101186e-03]
 [-8.00101186e-03  1.83531343e-02]]
grads:  [0.00176141 0.95660322]
Stock Position:  0.0017614058205171984
Bond Position:  [9.57592344]


portfolio before change:  [9.76198017]
curr_Stock_Price:  98.82977709685174
curr_Factors:  [9.88297771e+01 4.10521461e-02]
mat_Sqrt:  [[ 2.00242249e+01 -8.09702211e-03]
 [-8.09702211e-03  1.85730906e-02]]
grads:  [ 0.00245184 -1.25862111]
Stock Position:  0.002451839483565774
Bond Position:  [9.51966542]


portfolio before change:  [9.77367989]
curr_Stock_Price:  98.74522768760103
curr_Factors:  [9.87452277e+01 3.81714371e-02]
mat_Sqrt:  [[ 1.92923590e+01 -7.80775726e-03]
 [-7.80775726e-03  1.79095868e-02]]
grads:  [ 5.30128652e-04 -6.48156977e+00]
Stock Position:  0.0005301286518644226
Bond Position:  [9.72133222]


portfolio before change:  [9.78296612]
curr_Stock_Price:  93.32572815765946
curr_Factors:  [9.33257282e+01 4.50050785e-02]
mat_Sqrt:  [[ 1.97984918e+01 -8.47743403e-03]
 [-8.47743403e-03  1.94469508e-02]]
grads:  [-9.23252781e-05 -2.39352421e-02]
Stock Position:  -9.232527811412383e-05
Bond Position:  [9.79158245]


portfolio before change:  [9.79519851]
curr_Stock_Price:  93.48543217137126
curr_Factors:  [9.34854322e+01 5.07953091e-02]
mat_Sqrt:  [[ 2.10695715e+01 -9.00629543e-03]
 [-9.00629543e-03  2.06601000e-02]]
grads:  [-0.0083344  -6.85045749]
Stock Position:  -0.008334396148131506
Bond Position:  [10.57434314]


portfolio before change:  [9.83570434]
curr_Stock_Price:  90.212292758806
curr_Factors:  [9.02122928e+01 5.04795181e-02]
mat_Sqrt:  [[ 2.02685779e+01 -8.97793692e-03]
 [-8.97793692e-03  2.05959178e-02]]
grads:  [3.62605870e-03 7.89039892e+00]
Stock Position:  0.003626058700349809
Bond Position:  [9.50858928]


portfolio before change:  [9.85837027]
curr_Stock_Price:  93.1832191855391
curr_Factors:  [9.31832192e+01 4.73681150e-02]
mat_Sqrt:  [[ 2.02805963e+01 -8.69713190e-03]
 [-8.69713190e-03  1.99509661e-02]]
grads:  [-0.00457989 -0.60428224]
Stock Position:  -0.004579890530061107
Bond Position:  [10.28513921]


portfolio before change:  [9.86999949]
curr_Stock_Price:  93.45292793933696
curr_Factors:  [9.34529279e+01 4.60472622e-02]
mat_Sqrt:  [[ 2.00537123e+01 -8.57503980e-03]
 [-8.57503980e-03  1.96708239e-02]]
grads:  [-1.30207716e-03  7.75534255e-05]
Stock Position:  -0.0013020771631191415
Bond Position:  [9.99168242]


portfolio before change:  [9.87862044]
curr_Stock_Price:  96.43006474975766
curr_Factors:  [9.64300647e+01 4.33433114e-02]
mat_Sqrt:  [[ 2.00758280e+01 -8.31971446e-03]
 [-8.31971446e-03  1.90844299e-02]]
grads:  [-0.00139981 -0.26801583]
Stock Position:  -0.0013998143210211522
Bond Position:  [10.01360463]


portfolio before change:  [9.88377014]
curr_Stock_Price:  101.69872056086888
curr_Factors:  [1.01698721e+02 3.64885210e-02]
mat_Sqrt:  [[ 1.94264563e+01 -7.63390718e-03]
 [-7.63390718e-03  1.75102447e-02]]
grads:  [2.39440013e-03 2.54166655e+00]
Stock Position:  0.0023944001274802187
Bond Position:  [9.64026271]


portfolio before change:  [9.89272746]
curr_Stock_Price:  100.40380628573
curr_Factors:  [1.00403806e+02 4.01257495e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.89272746]
Stock Price:  101.9933959132169
PL:  [7.89933154]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-3.16945238e-03 -5.95419378e-02]
 [-4.22606981e-02  6.52677596e-02]
 [ 4.11667706e-02  1.12844737e-01]
 [-7.10843045e-01 -3.58970057e-01]
 [ 7.32304373e-01  8.26914725e-02]
 [-2.14910234e-02 -3.25604449e-01]
 [-5.55318614e-01 -4.96557427e-01]
 [ 3.56023957e-02 -1.48419076e-03]
 [-3.94966166e-01 -3.02433525e-01]
 [ 1.31888239e-01  6.15271820e-01]
 [-1.90587302e-01 -7.48965877e-03]
 [ 4.65422695e-02 -1.78783170e-01]
 [-2.35844321e-01 -8.56120727e-02]
 [ 4.26794523e-03  1.42826938e-01]
 [-9.97483860e-02  2.17387886e-01]
 [-2.18778446e-01  1.02419035e-01]
 [-1.27898574e-01  2.74359101e-01]
 [ 2.52079436e-02 -1.57592232e-01]
 [-4.27404642e-02  6.12163231e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.61783578]
curr_Stock_Price:  99.78824681774515
curr_Factors:  [9.97882468e+01 4.07956594e-02]
mat_Sqrt:  [[ 2.01551640e+01 -8.07175992e-03]
 [-8.07175992e-03  1.85149476e-02]]
grads:  [-1.44540567e-03 -3.21651489e+00]
Stock Position:  -0.00144540567206972
Bond Position:  [5.76207028]


portfolio before change:  [5.63127551]
curr_Stock_Price:  95.47620771374659
curr_Factors:  [9.54762077e+01 4.23618498e-02]
mat_Sqrt:  [[ 1.96509061e+01 -8.22490166e-03]
 [-8.22490166e-03  1.88671538e-02]]
grads:  [-7.0279445e-04  3.4590262e+00]
Stock Position:  -0.0007027944497696588
Bond Position:  [5.69837566]


portfolio before change:  [5.64153339]
curr_Stock_Price:  91.02192011521957
curr_Factors:  [9.10219201e+01 4.52407610e-02]
mat_Sqrt:  [[ 1.93602473e+01 -8.49939125e-03]
 [-8.49939125e-03  1.94978962e-02]]
grads:  [4.66804891e-03 5.78956886e+00]
Stock Position:  0.004668048908313513
Bond Position:  [5.21663861]


portfolio before change:  [5.6323873]
curr_Stock_Price:  87.66485156066051
curr_Factors:  [8.76648516e+01 4.40634254e-02]
mat_Sqrt:  [[ 1.84019813e+01 -8.38774592e-03]
 [-8.38774592e-03  1.92426602e-02]]
grads:  [ -0.04714101 -18.67545649]
Stock Position:  -0.04714101250987744
Bond Position:  [9.76499717]


portfolio before change:  [5.79726709]
curr_Stock_Price:  84.42635716107024
curr_Factors:  [8.44263572e+01 4.33944749e-02]
mat_Sqrt:  [[ 1.75871400e+01 -8.32349946e-03]
 [-8.32349946e-03  1.90961804e-02]]
grads:  [0.04369703 4.34930876]
Stock Position:  0.043697033310079
Bond Position:  [2.10808574]


portfolio before change:  [5.94919078]
curr_Stock_Price:  87.84276628350563
curr_Factors:  [8.78427663e+01 4.43980728e-02]
mat_Sqrt:  [[ 1.85092158e+01 -8.41955459e-03]
 [-8.41955459e-03  1.93155851e-02]]
grads:  [-8.83087527e-03 -1.68609338e+01]
Stock Position:  -0.008830875268770124
Bond Position:  [6.7249193]


portfolio before change:  [6.00520405]
curr_Stock_Price:  82.45237634021494
curr_Factors:  [8.24523763e+01 4.17074266e-02]
mat_Sqrt:  [[ 1.68387490e+01 -8.15988724e-03]
 [-8.15988724e-03  1.87213917e-02]]
grads:  [ -0.04584133 -26.54351215]
Stock Position:  -0.045841331825149094
Bond Position:  [9.78493079]


portfolio before change:  [6.24675001]
curr_Stock_Price:  77.45018411380964
curr_Factors:  [7.74501841e+01 4.47295494e-02]
mat_Sqrt:  [[ 1.63802173e+01 -8.44974440e-03]
 [-8.44974440e-03  1.93880714e-02]]
grads:  [ 0.00213449 -0.07562149]
Stock Position:  0.0021344902097184945
Bond Position:  [6.08143336]


portfolio before change:  [6.24883636]
curr_Stock_Price:  74.86399452933337
curr_Factors:  [7.48639945e+01 5.15231072e-02]
mat_Sqrt:  [[ 1.69931526e+01 -9.06837763e-03]
 [-9.06837763e-03  2.08085463e-02]]
grads:  [ -0.03100598 -14.54761398]
Stock Position:  -0.031005984305392725
Bond Position:  [8.5700682]


portfolio before change:  [6.2179542]
curr_Stock_Price:  76.2057175506168
curr_Factors:  [7.62057176e+01 4.69676050e-02]
mat_Sqrt:  [[ 1.65153090e+01 -8.65838978e-03]
 [-8.65838978e-03  1.98672680e-02]]
grads:  [2.42273625e-02 3.09796793e+01]
Stock Position:  0.0242273624650114
Bond Position:  [4.37169066]


portfolio before change:  [6.25256175]
curr_Stock_Price:  77.40846991163671
curr_Factors:  [7.74084699e+01 5.00039730e-02]
mat_Sqrt:  [[ 1.73097454e+01 -8.93404817e-03]
 [-8.93404817e-03  2.04993296e-02]]
grads:  [-0.0112015  -0.37024301]
Stock Position:  -0.011201497542511025
Bond Position:  [7.11965254]


portfolio before change:  [6.24579057]
curr_Stock_Price:  78.80795342690004
curr_Factors:  [7.88079534e+01 5.40455379e-02]
mat_Sqrt:  [[ 1.83210312e+01 -9.28827528e-03]
 [-9.28827528e-03  2.13115772e-02]]
grads:  [-1.71301265e-03 -8.38976296e+00]
Stock Position:  -0.001713012653766738
Bond Position:  [6.38078959]


portfolio before change:  [6.25770388]
curr_Stock_Price:  76.51238407614119
curr_Factors:  [7.65123841e+01 5.33150907e-02]
mat_Sqrt:  [[ 1.76667536e+01 -9.22497278e-03]
 [-9.22497278e-03  2.11672101e-02]]
grads:  [-0.01546506 -4.0513009 ]
Stock Position:  -0.015465063244709901
Bond Position:  [7.44097274]


portfolio before change:  [6.22184841]
curr_Stock_Price:  79.43267625522468
curr_Factors:  [7.94326763e+01 5.70304722e-02]
mat_Sqrt:  [[ 1.89693576e+01 -9.54141111e-03]
 [-9.54141111e-03  2.18921492e-02]]
grads:  [3.50733072e-03 6.52564540e+00]
Stock Position:  0.0035073307234717043
Bond Position:  [5.94325175]


portfolio before change:  [6.23465309]
curr_Stock_Price:  80.96403258422673
curr_Factors:  [8.09640326e+01 5.38066343e-02]
mat_Sqrt:  [[ 1.87806229e+01 -9.26801030e-03]
 [-9.26801030e-03  2.12642970e-02]]
grads:  [-2.66300798e-04  1.02230239e+01]
Stock Position:  -0.0002663007984688415
Bond Position:  [6.25621388]


portfolio before change:  [6.24253609]
curr_Stock_Price:  80.74685473810298
curr_Factors:  [8.07468547e+01 5.34795102e-02]
mat_Sqrt:  [[ 1.86732225e+01 -9.23976623e-03]
 [-9.23976623e-03  2.11995713e-02]]
grads:  [-0.00932763  4.82711885]
Stock Position:  -0.009327634606962003
Bond Position:  [6.99571324]


portfolio before change:  [6.27407934]
curr_Stock_Price:  78.3032400946882
curr_Factors:  [7.83032401e+01 5.22520357e-02]
mat_Sqrt:  [[ 1.78991037e+01 -9.13279084e-03]
 [-9.13279084e-03  2.09550111e-02]]
grads:  [-4.65213937e-04  1.30925654e+01]
Stock Position:  -0.00046521393691918256
Bond Position:  [6.3105071]


portfolio before change:  [6.28068629]
curr_Stock_Price:  81.06780094453912
curr_Factors:  [8.10678009e+01 5.26146430e-02]
mat_Sqrt:  [[ 1.85952342e+01 -9.16479039e-03]
 [-9.16479039e-03  2.10274356e-02]]
grads:  [-2.33865523e-03 -7.49561992e+00]
Stock Position:  -0.0023386552287459604
Bond Position:  [6.47027593]


portfolio before change:  [6.29534301]
curr_Stock_Price:  78.26113920930212
curr_Factors:  [7.82611392e+01 5.02961746e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.29534301]
Stock Price:  75.59135478448773
PL:  [6.29534301]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-5.37322670e-02 -7.89055529e-02]
 [ 2.33027724e-02 -6.37970969e-02]
 [ 6.60193535e-02  4.60876419e-02]
 [-3.55554200e-02 -1.61781220e-02]
 [ 2.29944895e-01  2.61728231e-02]
 [ 4.46759044e-02 -7.70393710e-02]
 [-1.18691368e-01 -1.50582020e-01]
 [ 3.20202987e-02 -1.70315825e-02]
 [-7.11231634e-02 -5.99609483e-02]
 [ 4.94203084e-02  5.40180347e-02]
 [ 6.01254913e-02 -1.14608188e-01]
 [-1.06582088e-02  3.89471195e-02]
 [-9.47470774e-02 -1.38718763e-01]
 [ 1.18722986e-02  1.87459324e-02]
 [-2.53007774e-02 -9.93265981e-02]
 [ 1.81055259e-01 -1.17309695e-01]
 [ 1.12184366e-01 -1.49274750e-01]
 [-1.14295811e-01  4.54515973e-02]
 [-1.15350264e-01 -1.33959878e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.29278119]
curr_Stock_Price:  101.03779368278161
curr_Factors:  [1.01037794e+02 3.36937674e-02]
mat_Sqrt:  [[ 1.85463566e+01 -7.33569006e-03]
 [-7.33569006e-03  1.68263283e-02]]
grads:  [-0.00475282 -4.6914821 ]
Stock Position:  -0.004752821661901394
Bond Position:  [10.7729958]


portfolio before change:  [10.30632198]
curr_Stock_Price:  101.02388022822862
curr_Factors:  [1.01023880e+02 3.46571522e-02]
mat_Sqrt:  [[ 1.88070400e+01 -7.43982242e-03]
 [-7.43982242e-03  1.70651857e-02]]
grads:  [-2.39873057e-04 -3.73854012e+00]
Stock Position:  -0.00023987305654715532
Bond Position:  [10.33055489]


portfolio before change:  [10.3197743]
curr_Stock_Price:  98.81001550212567
curr_Factors:  [9.88100155e+01 3.32990851e-02]
mat_Sqrt:  [[ 1.80308866e+01 -7.29245003e-03]
 [-7.29245003e-03  1.67275528e-02]]
grads:  [0.00477662 2.75727571]
Stock Position:  0.004776617515893914
Bond Position:  [9.84779664]


portfolio before change:  [10.31535202]
curr_Stock_Price:  95.30550195591256
curr_Factors:  [9.53055020e+01 3.82198875e-02]
mat_Sqrt:  [[ 1.86321356e+01 -7.81244931e-03]
 [-7.81244931e-03  1.79210633e-02]]
grads:  [-0.00228722 -0.9037405 ]
Stock Position:  -0.0022872228770717674
Bond Position:  [10.53333694]


portfolio before change:  [10.33561632]
curr_Stock_Price:  92.20593774881118
curr_Factors:  [9.22059377e+01 4.03682774e-02]
mat_Sqrt:  [[ 1.85258847e+01 -8.02876212e-03]
 [-8.02876212e-03  1.84179736e-02]]
grads:  [0.0130304  1.42672813]
Stock Position:  0.013030403624697947
Bond Position:  [9.13413573]


portfolio before change:  [10.35981414]
curr_Stock_Price:  93.18618460225521
curr_Factors:  [9.31861846e+01 3.86949527e-02]
mat_Sqrt:  [[ 1.83306831e+01 -7.86068113e-03]
 [-7.86068113e-03  1.80321718e-02]]
grads:  [ 6.05245430e-04 -4.27206519e+00]
Stock Position:  0.0006052454303486551
Bond Position:  [10.30341362]


portfolio before change:  [10.37265286]
curr_Stock_Price:  93.10589568104803
curr_Factors:  [9.31058957e+01 3.63442610e-02]
mat_Sqrt:  [[ 1.77498654e+01 -7.61816847e-03]
 [-7.61816847e-03  1.74758725e-02]]
grads:  [-0.01038703 -8.62109461]
Stock Position:  -0.010387026354985276
Bond Position:  [11.33974625]


portfolio before change:  [10.39428915]
curr_Stock_Price:  92.38839058011463
curr_Factors:  [9.23883906e+01 3.72356517e-02]
mat_Sqrt:  [[ 1.78277625e+01 -7.71096645e-03]
 [-7.71096645e-03  1.76889093e-02]]
grads:  [ 0.0013799  -0.96223808]
Stock Position:  0.0013798990797462111
Bond Position:  [10.2668025]


portfolio before change:  [10.40668667]
curr_Stock_Price:  92.06662337157
curr_Factors:  [9.20666234e+01 3.78938705e-02]
mat_Sqrt:  [[ 1.79220076e+01 -7.77879475e-03]
 [-7.77879475e-03  1.78445806e-02]]
grads:  [-0.00542795 -3.36254308]
Stock Position:  -0.0054279463483373255
Bond Position:  [10.90641936]


portfolio before change:  [10.39722155]
curr_Stock_Price:  96.32360582314598
curr_Factors:  [9.63236058e+01 3.85553051e-02]
mat_Sqrt:  [[ 1.89136247e+01 -7.84673513e-03]
 [-7.84673513e-03  1.79994944e-02]]
grads:  [0.00385871 3.0027684 ]
Stock Position:  0.0038587123270596526
Bond Position:  [10.02553646]


portfolio before change:  [10.41817707]
curr_Stock_Price:  98.50458406235633
curr_Factors:  [9.85045841e+01 4.26110295e-02]
mat_Sqrt:  [[ 2.03337472e+01 -8.24929960e-03]
 [-8.24929960e-03  1.89224563e-02]]
grads:  [ 4.99834941e-04 -6.05651102e+00]
Stock Position:  0.0004998349413491984
Bond Position:  [10.36894104]


portfolio before change:  [10.43124472]
curr_Stock_Price:  98.70138173214528
curr_Factors:  [9.87013817e+01 4.27154902e-02]
mat_Sqrt:  [[ 2.03993296e+01 -8.25942028e-03]
 [-8.25942028e-03  1.89456295e-02]]
grads:  [3.09914798e-04 2.05586619e+00]
Stock Position:  0.00030991479773047163
Bond Position:  [10.4006557]


portfolio before change:  [10.44356049]
curr_Stock_Price:  96.46470539949037
curr_Factors:  [9.64647054e+01 4.13538516e-02]
mat_Sqrt:  [[ 1.96167197e+01 -8.12653682e-03]
 [-8.12653682e-03  1.86412960e-02]]
grads:  [-0.00791409 -7.44492646]
Stock Position:  -0.007914093103216242
Bond Position:  [11.20699115]


portfolio before change:  [10.41347655]
curr_Stock_Price:  102.0372246064852
curr_Factors:  [1.02037225e+02 4.13915009e-02]
mat_Sqrt:  [[ 2.07593711e+01 -8.13065681e-03]
 [-8.13065681e-03  1.86495959e-02]]
grads:  [9.65750766e-04 1.00558665e+00]
Stock Position:  0.0009657507659866388
Bond Position:  [10.31493402]


portfolio before change:  [10.43665452]
curr_Stock_Price:  112.67790331011206
curr_Factors:  [1.12677903e+02 3.82952386e-02]
mat_Sqrt:  [[ 2.20501282e+01 -7.82130541e-03]
 [-7.82130541e-03  1.79382153e-02]]
grads:  [-3.11196082e-03 -5.53850738e+00]
Stock Position:  -0.0031119608200080584
Bond Position:  [10.78730374]


portfolio before change:  [10.44550312]
curr_Stock_Price:  114.17019803279624
curr_Factors:  [1.14170198e+02 3.87246074e-02]
mat_Sqrt:  [[ 2.24670597e+01 -7.86511326e-03]
 [-7.86511326e-03  1.80384608e-02]]
grads:  [ 5.78294738e-03 -6.50078810e+00]
Stock Position:  0.0057829473801968715
Bond Position:  [9.78526287]


portfolio before change:  [10.47892751]
curr_Stock_Price:  117.83358234842791
curr_Factors:  [1.17833582e+02 3.99292652e-02]
mat_Sqrt:  [[ 2.35458686e+01 -7.98671083e-03]
 [-7.98671083e-03  1.83167984e-02]]
grads:  [ 2.00046815e-03 -8.14873701e+00]
Stock Position:  0.0020004681511066272
Bond Position:  [10.24320518]


portfolio before change:  [10.49755759]
curr_Stock_Price:  120.74193771472352
curr_Factors:  [1.20741938e+02 3.47860087e-02]
mat_Sqrt:  [[ 2.25195868e+01 -7.45474399e-03]
 [-7.45474399e-03  1.70963996e-02]]
grads:  [-0.00419593  2.6567183 ]
Stock Position:  -0.004195932048563843
Bond Position:  [11.00418256]


portfolio before change:  [10.50181]
curr_Stock_Price:  123.00875690645249
curr_Factors:  [1.23008757e+02 3.15991971e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.50181]
Stock Price:  117.92749462863644
PL:  [-7.42568463]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.51389443e-01 -5.85596999e-03]
 [-4.27258462e-02  6.53938401e-02]
 [ 6.16999985e-02  5.89247988e-02]
 [ 9.25061266e-03  1.55035271e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-2.11710664e-01  4.47523082e-02]
 [ 4.85897774e-02  3.93988406e-02]
 [ 7.82207842e-02 -6.05054696e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 1.86388204e-01  9.71492752e-03]
 [ 2.15887982e-02  1.85228251e-01]
 [-7.47645326e-02 -9.65522493e-02]
 [ 6.48200625e-03 -1.16851377e-01]
 [ 1.99820129e-01 -1.40358965e-01]
 [ 1.02878205e-01 -1.48199894e-01]
 [-7.02211802e-02  4.09171249e-02]
 [-1.13100599e-01 -1.29492938e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.38005751]
curr_Stock_Price:  96.04680768999425
curr_Factors:  [9.60468077e+01 3.93986214e-02]
mat_Sqrt:  [[ 1.90644118e+01 -7.93206463e-03]
 [-7.93206463e-03  1.81952896e-02]]
grads:  [ 0.00780845 -0.31843587]
Stock Position:  0.007808454365409739
Bond Position:  [-9.13003463]


portfolio before change:  [-8.39601438]
curr_Stock_Price:  95.46574733532182
curr_Factors:  [9.54657473e+01 4.59296945e-02]
mat_Sqrt:  [[ 2.04594671e+01 -8.56426287e-03]
 [-8.56426287e-03  1.96456190e-02]]
grads:  [-6.95072419e-04  3.32836992e+00]
Stock Position:  -0.0006950724190371477
Bond Position:  [-8.32965877]


portfolio before change:  [-8.40790228]
curr_Stock_Price:  97.5796628884954
curr_Factors:  [9.75796629e+01 4.67546967e-02]
mat_Sqrt:  [[ 2.10994871e+01 -8.64101697e-03]
 [-8.64101697e-03  1.98211956e-02]]
grads:  [0.00414246 2.97462349]
Stock Position:  0.004142459481427212
Bond Position:  [-8.81212208]


portfolio before change:  [-8.41435803]
curr_Stock_Price:  98.68197785485452
curr_Factors:  [9.86819779e+01 4.60939683e-02]
mat_Sqrt:  [[ 2.11865313e+01 -8.57983308e-03]
 [-8.57983308e-03  1.96806033e-02]]
grads:  [7.55775465e-04 7.88086182e-01]
Stock Position:  0.0007557754648725536
Bond Position:  [-8.48893945]


portfolio before change:  [-8.41851814]
curr_Stock_Price:  107.22644664802068
curr_Factors:  [1.07226447e+02 4.40747848e-02]
mat_Sqrt:  [[ 2.25111138e+01 -8.39042593e-03]
 [-8.39042593e-03  1.92444434e-02]]
grads:  [ 0.00728425 -6.13417595]
Stock Position:  0.00728425229365062
Bond Position:  [-9.19958263]


portfolio before change:  [-8.42229483]
curr_Stock_Price:  108.28763721909368
curr_Factors:  [1.08287637e+02 4.43041292e-02]
mat_Sqrt:  [[ 2.27929717e+01 -8.41229794e-03]
 [-8.41229794e-03  1.92944172e-02]]
grads:  [0.00758881 5.50803889]
Stock Position:  0.007588814427527857
Bond Position:  [-9.24406961]


portfolio before change:  [-8.40946833]
curr_Stock_Price:  111.50142048582019
curr_Factors:  [1.11501420e+02 3.95440191e-02]
mat_Sqrt:  [[ 2.21728121e+01 -7.94773785e-03]
 [-7.94773785e-03  1.82283750e-02]]
grads:  [4.04772071e-03 4.44470929e+00]
Stock Position:  0.0040477207145326955
Bond Position:  [-8.86079494]


portfolio before change:  [-8.42656693]
curr_Stock_Price:  110.01523238927098
curr_Factors:  [1.10015232e+02 4.44666508e-02]
mat_Sqrt:  [[ 2.31990394e+01 -8.42782524e-03]
 [-8.42782524e-03  1.93297250e-02]]
grads:  [-0.00828607  2.31159391]
Stock Position:  -0.008286073900059835
Bond Position:  [-7.51497258]


portfolio before change:  [-8.49112082]
curr_Stock_Price:  116.67149737918845
curr_Factors:  [1.16671497e+02 4.12702558e-02]
mat_Sqrt:  [[ 2.37019090e+01 -8.11965393e-03]
 [-8.11965393e-03  1.86218629e-02]]
grads:  [0.00277524 2.11694044]
Stock Position:  0.002775244859703683
Bond Position:  [-8.81491279]


portfolio before change:  [-8.49081233]
curr_Stock_Price:  120.75547068583516
curr_Factors:  [1.20755471e+02 4.03729854e-02]
mat_Sqrt:  [[ 2.42634316e+01 -8.03111606e-03]
 [-8.03111606e-03  1.84182254e-02]]
grads:  [ 2.13676921e-03 -3.28415510e+00]
Stock Position:  0.002136769206305758
Bond Position:  [-8.7488389]


portfolio before change:  [-8.51332706]
curr_Stock_Price:  115.33988999513936
curr_Factors:  [1.15339890e+02 4.09564468e-02]
mat_Sqrt:  [[ 2.33421386e+01 -8.08865177e-03]
 [-8.08865177e-03  1.85509617e-02]]
grads:  [ 4.11163886e-04 -6.59526880e+00]
Stock Position:  0.00041116388643751473
Bond Position:  [-8.56075066]


portfolio before change:  [-8.52480179]
curr_Stock_Price:  113.47420208627526
curr_Factors:  [1.13474202e+02 4.43482914e-02]
mat_Sqrt:  [[ 2.38965693e+01 -8.41681495e-03]
 [-8.41681495e-03  1.93038893e-02]]
grads:  [0.00797827 0.50674136]
Stock Position:  0.007978272913454265
Bond Position:  [-9.43012994]


portfolio before change:  [-8.47447386]
curr_Stock_Price:  121.2607200838369
curr_Factors:  [1.21260720e+02 4.31699506e-02]
mat_Sqrt:  [[ 2.51947988e+01 -8.30467456e-03]
 [-8.30467456e-03  1.90455214e-02]]
grads:  [4.06318285e-03 9.72732594e+00]
Stock Position:  0.0040631828491454955
Bond Position:  [-8.96717834]


portfolio before change:  [-8.46676237]
curr_Stock_Price:  125.9190057097107
curr_Factors:  [1.25919006e+02 4.57349859e-02]
mat_Sqrt:  [[ 2.69287093e+01 -8.54807361e-03]
 [-8.54807361e-03  1.96030686e-02]]
grads:  [-4.34046372e-03 -4.92725675e+00]
Stock Position:  -0.004340463722275967
Bond Position:  [-7.9202155]


portfolio before change:  [-8.43977066]
curr_Stock_Price:  117.41802997341678
curr_Factors:  [1.17418030e+02 5.18490786e-02]
mat_Sqrt:  [[ 2.67365450e+01 -9.10105268e-03]
 [-9.10105268e-03  2.08725089e-02]]
grads:  [-1.66346742e-03 -5.59906417e+00]
Stock Position:  -0.0016634674235060027
Bond Position:  [-8.24444959]


portfolio before change:  [-8.44939787]
curr_Stock_Price:  117.00636543549932
curr_Factors:  [1.17006365e+02 5.12528274e-02]
mat_Sqrt:  [[ 2.64891717e+01 -9.04854664e-03]
 [-9.04854664e-03  2.07521584e-02]]
grads:  [ 5.23384332e-03 -6.76130181e+00]
Stock Position:  0.005233843320694019
Bond Position:  [-9.06179085]


portfolio before change:  [-8.45872063]
curr_Stock_Price:  117.39070200052294
curr_Factors:  [1.17390702e+02 5.09512998e-02]
mat_Sqrt:  [[ 2.64978909e+01 -9.02191356e-03]
 [-9.02191356e-03  2.06910143e-02]]
grads:  [ 1.44404739e-03 -7.16189470e+00]
Stock Position:  0.0014440473946908318
Bond Position:  [-8.62823837]


portfolio before change:  [-8.47457304]
curr_Stock_Price:  113.88640708969888
curr_Factors:  [1.13886407e+02 5.46441620e-02]
mat_Sqrt:  [[ 2.66221883e+01 -9.34291690e-03]
 [-9.34291690e-03  2.14278212e-02]]
grads:  [-0.00196785  1.90867466]
Stock Position:  -0.001967854442838601
Bond Position:  [-8.25046117]


portfolio before change:  [-8.50094491]
curr_Stock_Price:  122.04368677997849
curr_Factors:  [1.22043687e+02 4.49045298e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.50094491]
Stock Price:  114.23171418937514
PL:  [-22.7326591]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.48527171e-01 -4.51898902e-03]
 [ 2.33027724e-02 -6.37970969e-02]
 [ 2.64598334e-02 -2.11250855e-01]
 [-2.41441850e-02 -2.92089719e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.36026886e-01  6.89203260e-02]
 [ 5.44239664e-02  8.09876574e-02]
 [-4.60953582e-02  1.52491949e-02]
 [ 5.29887726e-02  4.14152412e-02]
 [ 6.00413413e-02 -2.71029889e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [-8.26371623e-03  4.63533744e-02]
 [-7.81501927e-02 -1.36347366e-01]
 [ 1.08621191e-02  8.96394211e-02]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.52513507e-01 -8.22512834e-02]
 [ 2.98338304e-02 -1.46262818e-01]
 [-1.34383672e-02  3.59897196e-02]
 [-6.10317464e-02 -5.61992085e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.22305627]
curr_Stock_Price:  98.22705888857264
curr_Factors:  [9.82270589e+01 4.06202359e-02]
mat_Sqrt:  [[ 1.97971341e+01 -8.05426924e-03]
 [-8.05426924e-03  1.84751483e-02]]
grads:  [ 0.00740426 -0.24137036]
Stock Position:  0.00740425905015795
Bond Position:  [-0.95035486]


portfolio before change:  [-0.19956587]
curr_Stock_Price:  101.56015226094443
curr_Factors:  [1.01560152e+02 3.87879899e-02]
mat_Sqrt:  [[ 2.00019320e+01 -7.87076324e-03]
 [-7.87076324e-03  1.80535588e-02]]
grads:  [-2.25551039e-04 -3.53386681e+00]
Stock Position:  -0.0002255510387070773
Bond Position:  [-0.17665887]


portfolio before change:  [-0.2003711]
curr_Stock_Price:  104.15056899339734
curr_Factors:  [1.04150569e+02 3.67406723e-02]
mat_Sqrt:  [[ 1.99634302e+01 -7.66040096e-03]
 [-7.66040096e-03  1.75705714e-02]]
grads:  [-3.28861800e-03 -1.20244266e+01]
Stock Position:  -0.0032886180035226666
Bond Position:  [0.14214034]


portfolio before change:  [-0.21596773]
curr_Stock_Price:  108.94723900904714
curr_Factors:  [1.08947239e+02 3.45644335e-02]
mat_Sqrt:  [[ 2.02549381e+01 -7.43035372e-03]
 [-7.43035372e-03  1.70421295e-02]]
grads:  [-0.00182105 -1.71472132]
Stock Position:  -0.0018210458487128917
Bond Position:  [-0.01756981]


portfolio before change:  [-0.22142049]
curr_Stock_Price:  111.92947138254894
curr_Factors:  [1.11929471e+02 3.36270175e-02]
mat_Sqrt:  [[ 2.05252568e+01 -7.32906662e-03]
 [-7.32906662e-03  1.68093711e-02]]
grads:  [ 0.00798886 -7.02294976]
Stock Position:  0.007988855699202138
Bond Position:  [-1.11560888]


portfolio before change:  [-0.20697642]
curr_Stock_Price:  113.91216475395038
curr_Factors:  [1.13912165e+02 3.23981135e-02]
mat_Sqrt:  [[ 2.05035915e+01 -7.19400179e-03]
 [-7.19400179e-03  1.64993174e-02]]
grads:  [0.00810116 4.18069452]
Stock Position:  0.00810115681721887
Bond Position:  [-1.12979673]


portfolio before change:  [-0.22558253]
curr_Stock_Price:  111.78987710607039
curr_Factors:  [1.11789877e+02 3.44096146e-02]
mat_Sqrt:  [[ 2.07368294e+01 -7.41385273e-03]
 [-7.41385273e-03  1.70038505e-02]]
grads:  [4.32801958e-03 4.76478810e+00]
Stock Position:  0.004328019576154128
Bond Position:  [-0.70941131]


portfolio before change:  [-0.2135719]
curr_Stock_Price:  114.76998131144785
curr_Factors:  [1.14769981e+02 3.55176261e-02]
mat_Sqrt:  [[ 2.16296877e+01 -7.53243262e-03]
 [-7.53243262e-03  1.72753790e-02]]
grads:  [-0.00182399  0.88191731]
Stock Position:  -0.001823991912103081
Bond Position:  [-0.00423238]


portfolio before change:  [-0.20423696]
curr_Stock_Price:  109.64921431560603
curr_Factors:  [1.09649214e+02 3.99378020e-02]
mat_Sqrt:  [[ 2.19127849e+01 -7.98710114e-03]
 [-7.98710114e-03  1.83189584e-02]]
grads:  [0.00324273 2.26219965]
Stock Position:  0.003242727497375503
Bond Position:  [-0.55979948]


portfolio before change:  [-0.20403592]
curr_Stock_Price:  109.92713763721252
curr_Factors:  [1.09927138e+02 4.18374380e-02]
mat_Sqrt:  [[ 2.24847173e+01 -8.17486449e-03]
 [-8.17486449e-03  1.87495592e-02]]
grads:  [ 0.0021451  -1.44459145]
Stock Position:  0.0021451015504596743
Bond Position:  [-0.43984079]


portfolio before change:  [-0.21436244]
curr_Stock_Price:  105.36960280225799
curr_Factors:  [1.05369603e+02 4.23393597e-02]
mat_Sqrt:  [[ 2.16814066e+01 -8.22345866e-03]
 [-8.22345866e-03  1.88618219e-02]]
grads:  [ 4.42884201e-04 -6.48655594e+00]
Stock Position:  0.0004428842011169919
Bond Position:  [-0.26102897]


portfolio before change:  [-0.21483612]
curr_Stock_Price:  105.03726002634772
curr_Factors:  [1.05037260e+02 4.73529561e-02]
mat_Sqrt:  [[ 2.28568775e+01 -8.69670471e-03]
 [-8.69670471e-03  1.99473529e-02]]
grads:  [5.22711124e-04 2.32401364e+00]
Stock Position:  0.0005227111239816078
Bond Position:  [-0.26974026]


portfolio before change:  [-0.2182909]
curr_Stock_Price:  99.07335569588358
curr_Factors:  [9.90733557e+01 5.27351990e-02]
mat_Sqrt:  [[ 2.27513480e+01 -9.17716787e-03]
 [-9.17716787e-03  2.10506907e-02]]
grads:  [-6.04868772e-03 -6.47973395e+00]
Stock Position:  -0.006048687718551304
Bond Position:  [0.38097289]


portfolio before change:  [-0.22113636]
curr_Stock_Price:  99.62256194071857
curr_Factors:  [9.96225619e+01 5.05536423e-02]
mat_Sqrt:  [[ 2.23992717e+01 -8.98538769e-03]
 [-8.98538769e-03  2.06106582e-02]]
grads:  [2.22997898e-03 4.35015017e+00]
Stock Position:  0.0022299789783239215
Bond Position:  [-0.44329258]


portfolio before change:  [-0.20739612]
curr_Stock_Price:  106.03280339415261
curr_Factors:  [1.06032803e+02 5.01582246e-02]
mat_Sqrt:  [[ 2.37471388e+01 -8.95067545e-03]
 [-8.95067545e-03  2.05296774e-02]]
grads:  [-3.59815992e-03 -4.24482057e+00]
Stock Position:  -0.0035981599229770716
Bond Position:  [0.17412686]


portfolio before change:  [-0.22001198]
curr_Stock_Price:  109.5995297785844
curr_Factors:  [1.09599530e+02 5.57464403e-02]
mat_Sqrt:  [[ 2.58771970e+01 -9.43638193e-03]
 [-9.43638193e-03  2.16429919e-02]]
grads:  [ 0.00450862 -3.7983999 ]
Stock Position:  0.004508616406585901
Bond Position:  [-0.71415422]


portfolio before change:  [-0.24680302]
curr_Stock_Price:  103.85546335771863
curr_Factors:  [1.03855463e+02 6.01854656e-02]
mat_Sqrt:  [[ 2.54785746e+01 -9.80443744e-03]
 [-9.80443744e-03  2.24883895e-02]]
grads:  [-1.33206816e-03 -6.50450663e+00]
Stock Position:  -0.0013320681575233317
Bond Position:  [-0.10846047]


portfolio before change:  [-0.24968591]
curr_Stock_Price:  105.91784077987195
curr_Factors:  [1.05917841e+02 6.24447870e-02]
mat_Sqrt:  [[ 2.64677596e+01 -9.98693950e-03]
 [-9.98693950e-03  2.29065255e-02]]
grads:  [8.51239792e-05 1.57119288e+00]
Stock Position:  8.512397922423358e-05
Bond Position:  [-0.25870206]


portfolio before change:  [-0.25039952]
curr_Stock_Price:  101.3359699222456
curr_Factors:  [1.01335970e+02 6.60679911e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.25039952]
Stock Price:  105.92510598042415
PL:  [-6.1755055]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-5.99843333e-02 -8.11933306e-02]
 [ 1.75259088e-02 -7.07427976e-02]
 [ 7.09335898e-02  1.89288560e-03]
 [-1.82001707e-02 -1.30528162e-02]
 [-1.60193418e-01 -5.45325395e-02]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-2.64520671e-01  4.72342217e-02]
 [ 8.15020046e-02  7.38472266e-02]
 [ 6.15649936e-02 -3.98515691e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 1.00944440e-01  2.16667904e-02]
 [ 3.45801445e-02  3.41211819e-02]
 [ 4.28163863e-03 -1.54755656e-01]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.60810769e-01 -9.24429777e-02]
 [ 5.30294515e-02 -1.48978797e-01]
 [-2.11791292e-02  3.65807249e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.36507279]
curr_Stock_Price:  100.78983033281736
curr_Factors:  [1.00789830e+02 4.29232723e-02]
mat_Sqrt:  [[ 2.08815673e+01 -8.27964336e-03]
 [-8.27964336e-03  1.89915831e-02]]
grads:  [-0.00456854 -4.27721881]
Stock Position:  -0.004568535411999787
Bond Position:  [9.8255347]


portfolio before change:  [9.37268737]
curr_Stock_Price:  101.81313718970394
curr_Factors:  [1.01813137e+02 4.44324498e-02]
mat_Sqrt:  [[ 2.14611958e+01 -8.42401855e-03]
 [-8.42401855e-03  1.93225363e-02]]
grads:  [-6.20562192e-04 -3.66142540e+00]
Stock Position:  -0.0006205621923357217
Bond Position:  [9.43586875]


portfolio before change:  [9.38553583]
curr_Stock_Price:  100.12716785631339
curr_Factors:  [1.00127168e+02 4.55092706e-02]
mat_Sqrt:  [[ 2.13600288e+01 -8.52535641e-03]
 [-8.52535641e-03  1.95553319e-02]]
grads:  [0.00336008 0.09826125]
Stock Position:  0.0033600751443960838
Bond Position:  [9.04910102]


portfolio before change:  [9.40275874]
curr_Stock_Price:  101.88440861743177
curr_Factors:  [1.01884409e+02 4.75914795e-02]
mat_Sqrt:  [[ 2.22265624e+01 -8.71834521e-03]
 [-8.71834521e-03  1.99976312e-02]]
grads:  [-0.00107506 -0.65318681]
Stock Position:  -0.001075059580171585
Bond Position:  [9.51229055]


portfolio before change:  [9.41673199]
curr_Stock_Price:  99.95386505727392
curr_Factors:  [9.99538651e+01 4.71914751e-02]
mat_Sqrt:  [[ 2.17135750e+01 -8.68147850e-03]
 [-8.68147850e-03  1.99134799e-02]]
grads:  [-0.00847394 -2.74216792]
Stock Position:  -0.008473938059351446
Bond Position:  [10.26373485]


portfolio before change:  [9.36881996]
curr_Stock_Price:  107.12287133764426
curr_Factors:  [1.07122871e+02 4.55154591e-02]
mat_Sqrt:  [[ 2.28539693e+01 -8.52644535e-03]
 [-8.52644535e-03  1.95564394e-02]]
grads:  [0.00756855 5.43427624]
Stock Position:  0.007568550808664453
Bond Position:  [8.55805507]


portfolio before change:  [9.3875548]
curr_Stock_Price:  108.18391751265276
curr_Factors:  [1.08183918e+02 4.45736835e-02]
mat_Sqrt:  [[ 2.28403070e+01 -8.43784325e-03]
 [-8.43784325e-03  1.93530265e-02]]
grads:  [3.92940084e-03 4.18646732e+00]
Stock Position:  0.003929400837184329
Bond Position:  [8.96245683]


portfolio before change:  [9.40000953]
curr_Stock_Price:  108.50067150254594
curr_Factors:  [1.08500672e+02 4.33388043e-02]
mat_Sqrt:  [[ 2.25876401e+01 -8.32016093e-03]
 [-8.32016093e-03  1.90830544e-02]]
grads:  [-0.01080086  2.47048276]
Stock Position:  -0.010800856398807306
Bond Position:  [10.5719097]


portfolio before change:  [9.4604231]
curr_Stock_Price:  104.13153495487467
curr_Factors:  [1.04131535e+02 4.03693032e-02]
mat_Sqrt:  [[ 2.09222248e+01 -8.02977746e-03]
 [-8.02977746e-03  1.84178095e-02]]
grads:  [0.00543522 4.011925  ]
Stock Position:  0.005435218790562801
Bond Position:  [8.89444542]


portfolio before change:  [9.48259252]
curr_Stock_Price:  106.16354452408018
curr_Factors:  [1.06163545e+02 3.98283732e-02]
mat_Sqrt:  [[ 2.11871072e+01 -7.97593264e-03]
 [-7.97593264e-03  1.82939397e-02]]
grads:  [ 2.08605420e-03 -2.17749329e+00]
Stock Position:  0.0020860541973140023
Bond Position:  [9.26112962]


portfolio before change:  [9.50548576]
curr_Stock_Price:  111.58506537790973
curr_Factors:  [1.11585065e+02 3.60475797e-02]
mat_Sqrt:  [[ 2.11857625e+01 -7.58824690e-03]
 [-7.58824690e-03  1.74038589e-02]]
grads:  [ 4.53096267e-04 -7.02996198e+00]
Stock Position:  0.00045309626713661735
Bond Position:  [9.45492698]


portfolio before change:  [9.51676054]
curr_Stock_Price:  110.36839637223922
curr_Factors:  [1.10368396e+02 3.23416502e-02]
mat_Sqrt:  [[ 1.98484132e+01 -7.18754465e-03]
 [-7.18754465e-03  1.64850145e-02]]
grads:  [0.0055626  1.31675782]
Stock Position:  0.005562595593984433
Bond Position:  [8.90282578]


portfolio before change:  [9.50560591]
curr_Stock_Price:  106.36125247219614
curr_Factors:  [1.06361252e+02 3.47060636e-02]
mat_Sqrt:  [[ 1.98146357e+01 -7.44540917e-03]
 [-7.44540917e-03  1.70770758e-02]]
grads:  [0.00249637 1.99915775]
Stock Position:  0.002496371504318517
Bond Position:  [9.24008871]


portfolio before change:  [9.52269544]
curr_Stock_Price:  108.5773492036038
curr_Factors:  [1.08577349e+02 3.22014936e-02]
mat_Sqrt:  [[ 1.94839593e+01 -7.17185551e-03]
 [-7.17185551e-03  1.64492986e-02]]
grads:  [-3.24377635e-03 -9.40945407e+00]
Stock Position:  -0.0032437763511325188
Bond Position:  [9.87489608]


portfolio before change:  [9.53762412]
curr_Stock_Price:  107.78279928016062
curr_Factors:  [1.07782799e+02 3.22773120e-02]
mat_Sqrt:  [[ 1.93641353e+01 -7.18024896e-03]
 [-7.18024896e-03  1.64686716e-02]]
grads:  [-4.41261168e-03 -5.29151815e+00]
Stock Position:  -0.0044126116763838355
Bond Position:  [10.01322776]


portfolio before change:  [9.53560397]
curr_Stock_Price:  111.07892281830527
curr_Factors:  [1.11078923e+02 2.96303557e-02]
mat_Sqrt:  [[ 1.91205361e+01 -6.87971117e-03]
 [-6.87971117e-03  1.57788824e-02]]
grads:  [ 0.00630337 -5.85590346]
Stock Position:  0.006303371614966271
Bond Position:  [8.83543224]


portfolio before change:  [9.52610471]
curr_Stock_Price:  107.81869052052528
curr_Factors:  [1.07818691e+02 3.26837090e-02]
mat_Sqrt:  [[ 1.94921476e+01 -7.22531213e-03]
 [-7.22531213e-03  1.65720233e-02]]
grads:  [-6.11857786e-04 -8.99004397e+00]
Stock Position:  -0.0006118577861672035
Bond Position:  [9.59207442]


portfolio before change:  [9.53864346]
curr_Stock_Price:  106.93423239763494
curr_Factors:  [1.06934232e+02 3.19812521e-02]
mat_Sqrt:  [[ 1.91233713e+01 -7.14719491e-03]
 [-7.14719491e-03  1.63929902e-02]]
grads:  [-2.73545786e-04  2.23136654e+00]
Stock Position:  -0.00027354578588429816
Bond Position:  [9.56789487]


portfolio before change:  [9.55117671]
curr_Stock_Price:  104.86547685360277
curr_Factors:  [1.04865477e+02 3.09945340e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.55117671]
Stock Price:  105.1637463525875
PL:  [4.38743036]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-5.61668852e-02 -7.98376064e-02]
 [ 2.33027724e-02 -6.37970969e-02]
 [ 7.24297573e-02 -1.01989545e-01]
 [-1.53830208e-02 -5.39564879e-03]
 [-4.03247695e-02 -8.11948690e-02]
 [ 1.29694722e-01  1.28816364e-01]
 [ 2.62640805e-02  4.45904288e-02]
 [ 3.16966490e-02 -1.84363206e-02]
 [-3.10863345e-02 -2.97160077e-02]
 [ 5.39874877e-02  2.58966569e-02]
 [ 5.93464926e-02 -1.12468137e-01]
 [ 1.11987289e-02 -4.43381566e-02]
 [-1.58755951e-01 -1.20996886e-01]
 [-1.79890992e-03  1.56619678e-01]
 [-8.34714709e-02 -2.35831894e-02]
 [-1.82097661e-02 -3.94763943e-03]
 [ 5.43933471e-03 -9.33984985e-02]
 [ 8.54151423e-02  3.65879805e-03]
 [ 1.27225137e-01  7.11068208e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.95361583]
curr_Stock_Price:  100.94713957410566
curr_Factors:  [1.00947140e+02 3.96990422e-02]
mat_Sqrt:  [[ 2.01133309e+01 -7.96261738e-03]
 [-7.96261738e-03  1.82643682e-02]]
grads:  [-0.00452381 -4.37319413]
Stock Position:  -0.004523813455095988
Bond Position:  [10.41028186]


portfolio before change:  [9.96451096]
curr_Stock_Price:  101.41706628216076
curr_Factors:  [1.01417066e+02 3.99657041e-02]
mat_Sqrt:  [[ 2.02747143e+01 -7.98934900e-03]
 [-7.98934900e-03  1.83255926e-02]]
grads:  [-2.22514381e-04 -3.48140855e+00]
Stock Position:  -0.00022251438100734795
Bond Position:  [9.98707771]


portfolio before change:  [9.97691038]
curr_Stock_Price:  101.83154586572907
curr_Factors:  [1.01831546e+02 4.35638862e-02]
mat_Sqrt:  [[ 2.12542415e+01 -8.34127736e-03]
 [-8.34127736e-03  1.91327456e-02]]
grads:  [ 1.31598665e-03 -5.33005407e+00]
Stock Position:  0.0013159866458119693
Bond Position:  [9.84290143]


portfolio before change:  [9.98746535]
curr_Stock_Price:  100.49691869383678
curr_Factors:  [1.00496919e+02 4.42207559e-02]
mat_Sqrt:  [[ 2.11332258e+01 -8.40382789e-03]
 [-8.40382789e-03  1.92764944e-02]]
grads:  [-0.00083936 -0.28027413]
Stock Position:  -0.0008393605635424818
Bond Position:  [10.0718185]


portfolio before change:  [9.99913785]
curr_Stock_Price:  101.59911911439792
curr_Factors:  [1.01599119e+02 3.82510279e-02]
mat_Sqrt:  [[ 1.98706221e+01 -7.81609658e-03]
 [-7.81609658e-03  1.79281598e-02]]
grads:  [-3.81146036e-03 -4.53056313e+00]
Stock Position:  -0.0038114603615745707
Bond Position:  [10.38637887]


portfolio before change:  [10.02167885]
curr_Stock_Price:  99.0935424866099
curr_Factors:  [9.90935425e+01 4.12907048e-02]
mat_Sqrt:  [[ 2.01359195e+01 -8.12053442e-03]
 [-8.12053442e-03  1.86269689e-02]]
grads:  [0.00923154 6.91960832]
Stock Position:  0.00923154459979027
Bond Position:  [9.10689239]


portfolio before change:  [10.03674911]
curr_Stock_Price:  99.49212466865232
curr_Factors:  [9.94921247e+01 4.02696095e-02]
mat_Sqrt:  [[ 1.99653708e+01 -8.01952748e-03]
 [-8.01952748e-03  1.83951970e-02]]
grads:  [2.28954552e-03 2.42502376e+00]
Stock Position:  0.002289545519329238
Bond Position:  [9.80895737]


portfolio before change:  [10.03591786]
curr_Stock_Price:  93.77041303018459
curr_Factors:  [9.37704130e+01 4.07585821e-02]
mat_Sqrt:  [[ 1.89310771e+01 -8.06761588e-03]
 [-8.06761588e-03  1.85067392e-02]]
grads:  [ 0.00125001 -0.99565006]
Stock Position:  0.0012500148114242442
Bond Position:  [9.91870345]


portfolio before change:  [10.0492469]
curr_Stock_Price:  94.50873272830785
curr_Factors:  [9.45087327e+01 4.42928059e-02]
mat_Sqrt:  [[ 1.98901701e+01 -8.41018576e-03]
 [-8.41018576e-03  1.92924035e-02]]
grads:  [-0.00221459 -1.54126119]
Stock Position:  -0.0022145927960943055
Bond Position:  [10.25854526]


portfolio before change:  [10.05641571]
curr_Stock_Price:  97.06558796899233
curr_Factors:  [9.7065588e+01 4.2187006e-02]
mat_Sqrt:  [[ 1.99367611e+01 -8.20803935e-03]
 [-8.20803935e-03  1.88281213e-02]]
grads:  [0.00327479 1.37685201]
Stock Position:  0.0032747918670851675
Bond Position:  [9.73854611]


portfolio before change:  [10.06613224]
curr_Stock_Price:  96.3130938124803
curr_Factors:  [9.63130938e+01 4.06001435e-02]
mat_Sqrt:  [[ 1.94065833e+01 -8.05212782e-03]
 [-8.05212782e-03  1.84706435e-02]]
grads:  [ 5.31715609e-04 -6.08878926e+00]
Stock Position:  0.0005317156094030526
Bond Position:  [10.01492106]


portfolio before change:  [10.07510415]
curr_Stock_Price:  89.62800606760906
curr_Factors:  [8.96280061e+01 4.45267032e-02]
mat_Sqrt:  [[ 1.89127187e+01 -8.43191745e-03]
 [-8.43191745e-03  1.93434692e-02]]
grads:  [-4.29873734e-04 -2.29233861e+00]
Stock Position:  -0.0004298737337201042
Bond Position:  [10.11363288]


portfolio before change:  [10.08878449]
curr_Stock_Price:  87.23104818450489
curr_Factors:  [8.72310482e+01 4.52342339e-02]
mat_Sqrt:  [[ 1.85525951e+01 -8.49840654e-03]
 [-8.49840654e-03  1.94966517e-02]]
grads:  [-0.01140216 -6.21100426]
Stock Position:  -0.011402156412902913
Bond Position:  [11.08340654]


portfolio before change:  [10.09989314]
curr_Stock_Price:  87.47260503203984
curr_Factors:  [8.74726050e+01 4.57548596e-02]
mat_Sqrt:  [[ 1.87107256e+01 -8.54719782e-03]
 [-8.54719782e-03  1.96085187e-02]]
grads:  [3.55323496e-03 7.98887723e+00]
Stock Position:  0.003553234956125132
Bond Position:  [9.78908242]


portfolio before change:  [10.13582441]
curr_Stock_Price:  94.13900104478462
curr_Factors:  [9.41390010e+01 4.24855867e-02]
mat_Sqrt:  [[ 1.94039594e+01 -8.23679295e-03]
 [-8.23679295e-03  1.88947376e-02]]
grads:  [-0.00483249 -1.25024195]
Stock Position:  -0.004832490798333051
Bond Position:  [10.59075027]


portfolio before change:  [10.15028468]
curr_Stock_Price:  93.88787820109361
curr_Factors:  [9.38878782e+01 4.29186913e-02]
mat_Sqrt:  [[ 1.94505874e+01 -8.27864852e-03]
 [-8.27864852e-03  1.89908107e-02]]
grads:  [-0.00102487 -0.2083178 ]
Stock Position:  -0.0010248716720931582
Bond Position:  [10.2465077]


portfolio before change:  [10.15706244]
curr_Stock_Price:  99.77972038083435
curr_Factors:  [9.97797204e+01 3.74337857e-02]
mat_Sqrt:  [[ 1.93051919e+01 -7.73202231e-03]
 [-7.73202231e-03  1.77356615e-02]]
grads:  [-1.82773360e-03 -5.26693807e+00]
Stock Position:  -0.0018277336029410465
Bond Position:  [10.33943319]


portfolio before change:  [10.17425819]
curr_Stock_Price:  97.44711821275472
curr_Factors:  [9.74471182e+01 4.28856284e-02]
mat_Sqrt:  [[ 2.01801715e+01 -8.27575396e-03]
 [-8.27575396e-03  1.89833659e-02]]
grads:  [0.00431244 0.19461705]
Stock Position:  0.004312438335385833
Bond Position:  [9.7540235]


portfolio before change:  [10.17051756]
curr_Stock_Price:  93.75065340134043
curr_Factors:  [9.37506534e+01 4.12398671e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.17051756]
Stock Price:  92.17419042746846
PL:  [10.17051756]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 7.01625541e-02 -3.19302272e-02]
 [ 3.74072674e-02 -2.64328504e-02]
 [ 6.98273650e-02 -1.19488224e-01]
 [ 1.34628961e-04  7.97970730e-03]
 [-1.59209745e-01  4.46817052e-03]
 [ 9.40057031e-02  4.29516718e-02]
 [ 2.89242599e-02  4.80287651e-02]
 [ 3.16898664e-02 -1.84657591e-02]
 [-7.75084063e-02 -6.47472210e-02]
 [ 4.75377874e-02  2.53513491e-01]
 [ 5.58766392e-02 -1.02935820e-01]
 [ 2.87465441e-02 -1.11089144e-01]
 [-1.80431137e-01 -1.11047624e-01]
 [-1.52994422e-03  1.48746918e-01]
 [-1.01157924e-01  2.03110875e-01]
 [-1.84224110e-01  8.40526515e-02]
 [-9.36209049e-02  1.66451440e-01]
 [ 1.01291823e-01 -1.04217906e-01]
 [ 1.02112617e-01  6.09821828e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.56545938]
curr_Stock_Price:  98.97238972808033
curr_Factors:  [9.89723897e+01 4.03659291e-02]
mat_Sqrt:  [[ 1.98848124e+01 -8.02907377e-03]
 [-8.02907377e-03  1.84172003e-02]]
grads:  [ 0.00282891 -1.73248448]
Stock Position:  0.0028289081772207196
Bond Position:  [2.28547558]


portfolio before change:  [2.56865778]
curr_Stock_Price:  99.09249455674241
curr_Factors:  [9.90924946e+01 3.58765626e-02]
mat_Sqrt:  [[ 1.87692163e+01 -7.56944211e-03]
 [-7.56944211e-03  1.73628676e-02]]
grads:  [ 1.37929391e-03 -1.52177684e+00]
Stock Position:  0.0013792939052521024
Bond Position:  [2.4319801]


portfolio before change:  [2.57595217]
curr_Stock_Price:  102.17560364033626
curr_Factors:  [1.02175604e+02 3.62173043e-02]
mat_Sqrt:  [[ 1.94448788e+01 -7.60551508e-03]
 [-7.60551508e-03  1.74450332e-02]]
grads:  [ 9.12172387e-04 -6.84901456e+00]
Stock Position:  0.0009121723871744426
Bond Position:  [2.4827504]


portfolio before change:  [2.57641831]
curr_Stock_Price:  99.28225402642133
curr_Factors:  [9.9282254e+01 3.3250569e-02]
mat_Sqrt:  [[ 1.81038580e+01 -7.28716775e-03]
 [-7.28716775e-03  1.67153485e-02]]
grads:  [1.99629815e-04 4.77475060e-01]
Stock Position:  0.00019962981481012407
Bond Position:  [2.55659861]


portfolio before change:  [2.57882067]
curr_Stock_Price:  95.29792517185477
curr_Factors:  [9.52979252e+01 3.54410344e-02]
mat_Sqrt:  [[ 1.79405850e+01 -7.52307985e-03]
 [-7.52307985e-03  1.72572771e-02]]
grads:  [-0.00876731  0.25509316]
Stock Position:  -0.008767309319825087
Bond Position:  [3.41432705]


portfolio before change:  [2.57184456]
curr_Stock_Price:  96.58072256082993
curr_Factors:  [9.65807226e+01 3.58966265e-02]
mat_Sqrt:  [[ 1.82985734e+01 -7.57137643e-03]
 [-7.57137643e-03  1.73678014e-02]]
grads:  [0.00616171 2.47574944]
Stock Position:  0.006161711728379051
Bond Position:  [1.97674199]


portfolio before change:  [2.58744305]
curr_Stock_Price:  98.71097661879752
curr_Factors:  [9.87109766e+01 3.54728457e-02]
mat_Sqrt:  [[ 1.85914571e+01 -7.52670548e-03]
 [-7.52670548e-03  1.72649113e-02]]
grads:  [2.68248956e-03 2.78304097e+00]
Stock Position:  0.0026824895645306793
Bond Position:  [2.32265188]


portfolio before change:  [2.57712897]
curr_Stock_Price:  93.78301369940627
curr_Factors:  [9.37830137e+01 3.87065385e-02]
mat_Sqrt:  [[ 1.84508472e+01 -7.86190701e-03]
 [-7.86190701e-03  1.80348497e-02]]
grads:  [ 0.00128149 -1.02333452]
Stock Position:  0.001281486173763248
Bond Position:  [2.45694733]


portfolio before change:  [2.57756923]
curr_Stock_Price:  91.72849344709017
curr_Factors:  [9.17284934e+01 4.00507368e-02]
mat_Sqrt:  [[ 1.83573283e+01 -7.99708094e-03]
 [-7.99708094e-03  1.83454099e-02]]
grads:  [-0.0057608  -3.53185298]
Stock Position:  -0.005760801292959944
Bond Position:  [3.10599886]


portfolio before change:  [2.58386064]
curr_Stock_Price:  91.31076032979749
curr_Factors:  [9.13107603e+01 3.47848219e-02]
mat_Sqrt:  [[ 1.70300848e+01 -7.45279448e-03]
 [-7.45279448e-03  1.70969024e-02]]
grads:  [9.28229385e-03 1.48320826e+01]
Stock Position:  0.009282293845038378
Bond Position:  [1.73628733]


portfolio before change:  [2.56673129]
curr_Stock_Price:  89.23141857776005
curr_Factors:  [8.92314186e+01 3.39867959e-02]
mat_Sqrt:  [[ 1.64502637e+01 -7.36663607e-03]
 [-7.36663607e-03  1.68997228e-02]]
grads:  [ 6.6921594e-04 -6.0906851e+00]
Stock Position:  0.0006692159397300417
Bond Position:  [2.5070162]


portfolio before change:  [2.56652057]
curr_Stock_Price:  84.23086506903415
curr_Factors:  [8.42308651e+01 3.23919563e-02]
mat_Sqrt:  [[ 1.51596719e+01 -7.19128056e-03]
 [-7.19128056e-03  1.64986377e-02]]
grads:  [-1.29805449e-03 -6.73379711e+00]
Stock Position:  -0.0012980544918042686
Bond Position:  [2.67585682]


portfolio before change:  [2.56992114]
curr_Stock_Price:  84.18952768461016
curr_Factors:  [8.41895277e+01 2.78865024e-02]
mat_Sqrt:  [[ 1.40590200e+01 -6.67243630e-03]
 [-6.67243630e-03  1.53082859e-02]]
grads:  [-0.01628    -7.26118206]
Stock Position:  -0.016280004763175666
Bond Position:  [3.94052705]


portfolio before change:  [2.59401091]
curr_Stock_Price:  83.01256038137659
curr_Factors:  [8.30125604e+01 2.90549191e-02]
mat_Sqrt:  [[ 1.41499073e+01 -6.81068117e-03]
 [-6.81068117e-03  1.56257420e-02]]
grads:  [4.47470081e-03 9.52130105e+00]
Stock Position:  0.004474700808800078
Bond Position:  [2.22255454]


portfolio before change:  [2.59109321]
curr_Stock_Price:  81.73926093499902
curr_Factors:  [8.17392609e+01 3.00775367e-02]
mat_Sqrt:  [[ 1.41759374e+01 -6.92938010e-03]
 [-6.92938010e-03  1.58983980e-02]]
grads:  [-8.91223723e-04  1.27751676e+01]
Stock Position:  -0.0008912237225945177
Bond Position:  [2.66394118]


portfolio before change:  [2.59325039]
curr_Stock_Price:  83.05747797414077
curr_Factors:  [8.30574780e+01 2.81861735e-02]
mat_Sqrt:  [[ 1.39443010e+01 -6.70809237e-03]
 [-6.70809237e-03  1.53903616e-02]]
grads:  [-0.01058638  5.45676827]
Stock Position:  -0.01058637535306681
Bond Position:  [3.47252803]


portfolio before change:  [2.56752449]
curr_Stock_Price:  85.89785335188779
curr_Factors:  [8.58978534e+01 2.96924850e-02]
mat_Sqrt:  [[ 1.48014934e+01 -6.88525580e-03]
 [-6.88525580e-03  1.57961420e-02]]
grads:  [-1.42363821e-03  1.05368537e+01]
Stock Position:  -0.0014236382147116563
Bond Position:  [2.68981195]


portfolio before change:  [2.56675149]
curr_Stock_Price:  88.80404703084818
curr_Factors:  [8.88040470e+01 2.65927253e-02]
mat_Sqrt:  [[ 1.44815197e+01 -6.51618465e-03]
 [-6.51618465e-03  1.49487990e-02]]
grads:  [ 3.85830877e-03 -6.96997564e+00]
Stock Position:  0.003858308768965419
Bond Position:  [2.22411805]


portfolio before change:  [2.57235231]
curr_Stock_Price:  89.53466298774576
curr_Factors:  [8.95346630e+01 2.78730558e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.57235231]
Stock Price:  89.27704844569622
PL:  [2.57235231]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-5.68132532e-02 -8.00677268e-02]
 [-1.17428498e-01 -1.69820335e-01]
 [-3.60679117e-01 -1.46037531e-01]
 [-2.23516968e-02 -2.43368909e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.29326004e-01  9.55298786e-02]
 [ 5.44239664e-02  8.09876574e-02]
 [-2.42161815e-01  4.61789216e-02]
 [ 6.49893055e-02  5.45874907e-02]
 [ 6.15901878e-02 -4.00596952e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 4.07023489e-01 -2.16337925e-02]
 [ 3.78256030e-02  2.21193676e-01]
 [-7.32953718e-02 -9.90865656e-02]
 [ 6.34893166e-02 -1.41388204e-01]
 [ 2.63345061e-01 -2.18387925e-01]
 [ 2.17304801e-01 -1.51491581e-01]
 [-1.85265149e-01  5.27296124e-02]
 [-1.38719567e-01 -1.80992113e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.85104848]
curr_Stock_Price:  100.91972476933131
curr_Factors:  [1.00919725e+02 3.94932281e-02]
mat_Sqrt:  [[ 2.00556776e+01 -7.94194808e-03]
 [-7.94194808e-03  1.82169630e-02]]
grads:  [-0.00457405 -4.39722327]
Stock Position:  -0.004574054973495077
Bond Position:  [10.31266085]


portfolio before change:  [9.8357984]
curr_Stock_Price:  107.07377528846375
curr_Factors:  [1.07073775e+02 3.74445788e-02]
mat_Sqrt:  [[ 2.07194184e+01 -7.73362045e-03]
 [-7.73362045e-03  1.77380073e-02]]
grads:  [-9.24253185e-03 -9.57784100e+00]
Stock Position:  -0.009242531854231326
Bond Position:  [10.82543118]


portfolio before change:  [9.83425653]
curr_Stock_Price:  108.70559205678175
curr_Factors:  [1.08705592e+02 3.63022822e-02]
mat_Sqrt:  [[ 2.07118466e+01 -7.61484240e-03]
 [-7.61484240e-03  1.74653084e-02]]
grads:  [-0.02049162 -8.37051187]
Stock Position:  -0.020491617878862133
Bond Position:  [12.06180998]


portfolio before change:  [9.75662892]
curr_Stock_Price:  113.2300907160937
curr_Factors:  [1.13230091e+02 2.93552364e-02]
mat_Sqrt:  [[ 1.94001291e+01 -6.84780473e-03]
 [-6.84780473e-03  1.57054110e-02]]
grads:  [-0.00169937 -1.55032733]
Stock Position:  -0.0016993719717045533
Bond Position:  [9.94904896]


portfolio before change:  [9.76418003]
curr_Stock_Price:  116.10937678793165
curr_Factors:  [1.16109377e+02 2.62641113e-02]
mat_Sqrt:  [[ 1.88169237e+01 -6.47736908e-03]
 [-6.47736908e-03  1.48554638e-02]]
grads:  [ 0.008714   -7.94680516]
Stock Position:  0.008713995669084991
Bond Position:  [8.75240342]


portfolio before change:  [9.73879843]
curr_Stock_Price:  111.94034309630572
curr_Factors:  [1.11940343e+02 2.71019169e-02]
mat_Sqrt:  [[ 1.84283567e+01 -6.57967638e-03]
 [-6.57967638e-03  1.50906271e-02]]
grads:  [0.00927943 6.33445737]
Stock Position:  0.009279431995966427
Bond Position:  [8.70005563]


portfolio before change:  [9.72933372]
curr_Stock_Price:  109.74768941788712
curr_Factors:  [1.09747689e+02 2.83542796e-02]
mat_Sqrt:  [[ 1.84801148e+01 -6.72987099e-03]
 [-6.72987099e-03  1.54354019e-02]]
grads:  [4.85651867e-03 5.24899459e+00]
Stock Position:  0.004856518668899388
Bond Position:  [9.19634202]


portfolio before change:  [9.73789375]
curr_Stock_Price:  109.14178483394382
curr_Factors:  [1.09141785e+02 2.81396495e-02]
mat_Sqrt:  [[ 1.83083988e+01 -6.70432037e-03]
 [-6.70432037e-03  1.53768847e-02]]
grads:  [-0.01212904  2.9978507 ]
Stock Position:  -0.012129037893774048
Bond Position:  [11.06167859]


portfolio before change:  [9.78702717]
curr_Stock_Price:  106.2316053215118
curr_Factors:  [1.06231605e+02 2.91744898e-02]
mat_Sqrt:  [[ 1.81449322e+01 -6.82632670e-03]
 [-6.82632670e-03  1.56571441e-02]]
grads:  [0.00489411 3.48856082]
Stock Position:  0.004894113710582712
Bond Position:  [9.26711762]


portfolio before change:  [9.79815349]
curr_Stock_Price:  106.13662883586234
curr_Factors:  [1.06136629e+02 3.06293812e-02]
mat_Sqrt:  [[ 1.85752373e+01 -6.99446031e-03]
 [-6.99446031e-03  1.60427970e-02]]
grads:  [ 2.37584600e-03 -2.49601596e+00]
Stock Position:  0.00237584600471329
Bond Position:  [9.5459892]


portfolio before change:  [9.83108318]
curr_Stock_Price:  114.9712694911731
curr_Factors:  [1.14971269e+02 3.00537126e-02]
mat_Sqrt:  [[ 1.99314257e+01 -6.92887875e-03]
 [-6.92887875e-03  1.58911222e-02]]
grads:  [ 4.81531571e-04 -7.69917736e+00]
Stock Position:  0.0004815315711232773
Bond Position:  [9.77572088]


portfolio before change:  [9.84640794]
curr_Stock_Price:  121.40381220528513
curr_Factors:  [1.21403812e+02 2.52125891e-02]
mat_Sqrt:  [[ 1.92770700e+01 -6.34659744e-03]
 [-6.34659744e-03  1.45549508e-02]]
grads:  [ 0.02062799 -1.47735813]
Stock Position:  0.02062799440048159
Bond Position:  [7.34209078]


portfolio before change:  [9.92870471]
curr_Stock_Price:  124.94819060747616
curr_Factors:  [1.24948191e+02 2.43375841e-02]
mat_Sqrt:  [[ 1.94925511e+01 -6.23562883e-03]
 [-6.23562883e-03  1.43000970e-02]]
grads:  [6.88965465e-03 1.54709886e+01]
Stock Position:  0.006889654648472161
Bond Position:  [9.06785483]


portfolio before change:  [9.94445941]
curr_Stock_Price:  125.58868536923637
curr_Factors:  [1.25588685e+02 2.26345098e-02]
mat_Sqrt:  [[ 1.88945277e+01 -6.01351910e-03]
 [-6.01351910e-03  1.37906739e-02]]
grads:  [-6.16680817e-03 -7.18773068e+00]
Stock Position:  -0.006166808169003903
Bond Position:  [10.71894074]


portfolio before change:  [9.95990613]
curr_Stock_Price:  125.25793562468849
curr_Factors:  [1.25257936e+02 2.73583447e-02]
mat_Sqrt:  [[ 2.07181101e+01 -6.61130541e-03]
 [-6.61130541e-03  1.51615991e-02]]
grads:  [ 8.86376936e-05 -9.32537635e+00]
Stock Position:  8.863769364019994e-05
Bond Position:  [9.94880356]


portfolio before change:  [9.97251339]
curr_Stock_Price:  127.10231951206278
curr_Factors:  [1.27102320e+02 2.41727644e-02]
mat_Sqrt:  [[ 1.97613502e+01 -6.21455562e-03]
 [-6.21455562e-03  1.42515593e-02]]
grads:  [ 8.50840461e-03 -1.53200815e+01]
Stock Position:  0.008508404608372542
Bond Position:  [8.89107543]


portfolio before change:  [10.01156042]
curr_Stock_Price:  130.3845136181256
curr_Factors:  [1.30384514e+02 2.02336501e-02]
mat_Sqrt:  [[ 1.85465489e+01 -5.68580442e-03]
 [-5.68580442e-03  1.30387166e-02]]
grads:  [ 8.15590861e-03 -1.16150395e+01]
Stock Position:  0.008155908606115394
Bond Position:  [8.94815624]


portfolio before change:  [10.03397271]
curr_Stock_Price:  131.7602159903792
curr_Factors:  [1.31760216e+02 1.99977622e-02]
mat_Sqrt:  [[ 1.86326651e+01 -5.65260559e-03]
 [-5.65260559e-03  1.29624717e-02]]
grads:  [-0.00871011  4.06406887]
Stock Position:  -0.008710110455443131
Bond Position:  [11.18161875]


portfolio before change:  [10.04485189]
curr_Stock_Price:  132.11687988289873
curr_Factors:  [1.32116880e+02 2.06709993e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.04485189]
Stock Price:  131.72597706309978
PL:  [-21.68112517]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-3.98854386e-02 -7.22992540e-02]
 [-7.80583352e-02 -1.53336838e-01]
 [ 6.21254772e-02 -1.71064627e-01]
 [-2.42915297e-02 -2.96094628e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.06843592e-02  7.61541387e-02]
 [-2.15353964e-01  4.49207174e-02]
 [ 5.62806487e-02  4.44224948e-02]
 [ 6.09728605e-02 -3.49600402e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 5.15010215e-02  2.84812734e-02]
 [ 2.73516221e-02  7.94319867e-02]
 [-1.73045304e-02 -1.95671302e-01]
 [-3.12669793e-02 -9.60368809e-02]
 [ 1.93350334e-01 -1.32411984e-01]
 [ 1.32996646e-01 -1.51161478e-01]
 [-1.00333506e-01  4.40373049e-02]
 [-1.06238524e-01 -1.15571375e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.00275821]
curr_Stock_Price:  101.4948463844167
curr_Factors:  [1.01494846e+02 4.04295516e-02]
mat_Sqrt:  [[ 2.04076698e+01 -8.03558357e-03]
 [-8.03558357e-03  1.84316281e-02]]
grads:  [-3.49955657e-03 -3.92409041e+00]
Stock Position:  -0.003499556569563071
Bond Position:  [12.35794517]


portfolio before change:  [12.00162277]
curr_Stock_Price:  106.23617096323629
curr_Factors:  [1.06236171e+02 3.97611262e-02]
mat_Sqrt:  [[ 2.11836951e+01 -7.96920113e-03]
 [-7.96920113e-03  1.82784872e-02]]
grads:  [-6.84182472e-03 -8.39190686e+00]
Stock Position:  -0.0068418247242630174
Bond Position:  [12.72847203]


portfolio before change:  [12.03831955]
curr_Stock_Price:  103.19951826513092
curr_Factors:  [1.03199518e+02 3.83706744e-02]
mat_Sqrt:  [[ 2.02151679e+01 -7.82842057e-03]
 [-7.82842057e-03  1.79561292e-02]]
grads:  [-6.16195699e-04 -9.52707843e+00]
Stock Position:  -0.0006161956989183479
Bond Position:  [12.10191065]


portfolio before change:  [12.05096647]
curr_Stock_Price:  107.2403238371473
curr_Factors:  [1.07240324e+02 3.60430390e-02]
mat_Sqrt:  [[ 2.03595787e+01 -7.58751664e-03]
 [-7.58751664e-03  1.74028728e-02]]
grads:  [-0.0018275  -1.70220913]
Stock Position:  -0.0018274970402284317
Bond Position:  [12.24694785]


portfolio before change:  [12.06637118]
curr_Stock_Price:  107.19301983719215
curr_Factors:  [1.07193020e+02 3.65543167e-02]
mat_Sqrt:  [[ 2.04944284e+01 -7.64113947e-03]
 [-7.64113947e-03  1.75258710e-02]]
grads:  [ 0.00800104 -6.73568707]
Stock Position:  0.008001035880154635
Bond Position:  [11.20871598]


portfolio before change:  [12.076061]
curr_Stock_Price:  106.65186126410532
curr_Factors:  [1.06651861e+02 3.64282254e-02]
mat_Sqrt:  [[ 2.03557644e+01 -7.62791626e-03]
 [-7.62791626e-03  1.74956322e-02]]
grads:  [0.00849741 6.07439486]
Stock Position:  0.008497413300949438
Bond Position:  [11.16979606]


portfolio before change:  [12.07580276]
curr_Stock_Price:  104.97732631201981
curr_Factors:  [1.04977326e+02 3.84002993e-02]
mat_Sqrt:  [[ 2.05713494e+01 -7.83155974e-03]
 [-7.83155974e-03  1.79630083e-02]]
grads:  [4.07849605e-03 4.24127622e+00]
Stock Position:  0.004078496049024021
Bond Position:  [11.64765315]


portfolio before change:  [12.11049204]
curr_Stock_Price:  109.91066585905045
curr_Factors:  [1.09910666e+02 3.45825453e-02]
mat_Sqrt:  [[ 2.04394068e+01 -7.43235499e-03]
 [-7.43235499e-03  1.70465701e-02]]
grads:  [-0.00957951  2.6309996 ]
Stock Position:  -0.009579507015137973
Bond Position:  [13.16338203]


portfolio before change:  [12.15145213]
curr_Stock_Price:  107.35358472557189
curr_Factors:  [1.07353585e+02 3.80585599e-02]
mat_Sqrt:  [[ 2.09431834e+01 -7.79678435e-03]
 [-7.79678435e-03  1.78828340e-02]]
grads:  [0.00361267 2.48566094]
Stock Position:  0.00361267002745158
Bond Position:  [11.76361905]


portfolio before change:  [12.16633268]
curr_Stock_Price:  107.39976357893484
curr_Factors:  [1.07399764e+02 3.30674116e-02]
mat_Sqrt:  [[ 1.95300518e+01 -7.26757642e-03]
 [-7.26757642e-03  1.66690266e-02]]
grads:  [ 0.00234193 -2.09628437]
Stock Position:  0.0023419268967721407
Bond Position:  [11.91481028]


portfolio before change:  [12.18580918]
curr_Stock_Price:  109.35271612702094
curr_Factors:  [1.09352716e+02 2.94036070e-02]
mat_Sqrt:  [[ 1.87512339e+01 -6.85324764e-03]
 [-6.85324764e-03  1.57184308e-02]]
grads:  [ 5.11981479e-04 -7.78375384e+00]
Stock Position:  0.0005119814787954401
Bond Position:  [12.12982261]


portfolio before change:  [12.20056349]
curr_Stock_Price:  108.5373686141773
curr_Factors:  [1.08537369e+02 3.44749268e-02]
mat_Sqrt:  [[ 2.01525931e+01 -7.42070325e-03]
 [-7.42070325e-03  1.70200597e-02]]
grads:  [0.00317225 1.67477754]
Stock Position:  0.0031722492701079658
Bond Position:  [11.8562559]


portfolio before change:  [12.22299209]
curr_Stock_Price:  110.93283335807433
curr_Factors:  [1.10932833e+02 3.17556099e-02]
mat_Sqrt:  [[ 1.97683448e+01 -7.12215680e-03]
 [-7.12215680e-03  1.63349619e-02]]
grads:  [3.13603688e-03 4.86406533e+00]
Stock Position:  0.003136036877760769
Bond Position:  [11.87510263]


portfolio before change:  [12.24287708]
curr_Stock_Price:  112.53735142581273
curr_Factors:  [1.12537351e+02 2.67777321e-02]
mat_Sqrt:  [[ 1.84155019e+01 -6.54023435e-03]
 [-6.54023435e-03  1.50000885e-02]]
grads:  [-5.57332976e-03 -1.30471065e+01]
Stock Position:  -0.005573329764120424
Bond Position:  [12.87008485]


portfolio before change:  [12.26322313]
curr_Stock_Price:  111.77508047487899
curr_Factors:  [1.1177508e+02 2.5328655e-02]
mat_Sqrt:  [[ 1.77889792e+01 -6.36077550e-03]
 [-6.36077550e-03  1.45885943e-02]]
grads:  [-4.11217754e-03 -6.58480421e+00]
Stock Position:  -0.004112177535076692
Bond Position:  [12.7228621]


portfolio before change:  [12.26088953]
curr_Stock_Price:  116.21241878448038
curr_Factors:  [1.16212419e+02 2.10954730e-02]
mat_Sqrt:  [[ 1.68790169e+01 -5.80513370e-03]
 [-5.80513370e-03  1.33137205e-02]]
grads:  [ 8.03574951e-03 -9.94202453e+00]
Stock Position:  0.008035749513594927
Bond Position:  [11.32703564]


portfolio before change:  [12.29920373]
curr_Stock_Price:  119.21731074053194
curr_Factors:  [1.19217311e+02 2.07401631e-02]
mat_Sqrt:  [[ 1.71690150e+01 -5.75615266e-03]
 [-5.75615266e-03  1.32010733e-02]]
grads:  [ 3.90788288e-03 -1.14489920e+01]
Stock Position:  0.0039078828773517985
Bond Position:  [11.83331645]


portfolio before change:  [12.31155177]
curr_Stock_Price:  118.5896409214191
curr_Factors:  [1.18589641e+02 2.48115114e-02]
mat_Sqrt:  [[ 1.86798481e+01 -6.29580203e-03]
 [-6.29580203e-03  1.44387669e-02]]
grads:  [-0.00434391  3.0480412 ]
Stock Position:  -0.004343913401553398
Bond Position:  [12.8266949]


portfolio before change:  [12.32350588]
curr_Stock_Price:  119.53102331752262
curr_Factors:  [1.19531023e+02 2.56511032e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.32350588]
Stock Price:  117.39356276439696
PL:  [-5.07005689]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.27692444e-02 -4.72790836e-02]
 [-1.23662785e-01 -1.72417850e-01]
 [-3.17539454e-01 -1.63420736e-01]
 [-2.34952337e-02 -2.74450866e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-3.17428795e-01  4.97194494e-02]
 [ 5.28019022e-02  4.13295136e-02]
 [ 6.11802376e-02 -3.66731535e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 5.23037535e-02  2.83887186e-02]
 [ 2.18309142e-02  1.09147149e-01]
 [-4.79751462e-02 -1.42764197e-01]
 [ 2.22560243e-02 -1.25549048e-01]
 [ 2.51929755e-01 -2.04366273e-01]
 [ 1.64899813e-01 -1.49775586e-01]
 [-1.51739382e-01  4.92789827e-02]
 [-1.20132358e-01 -1.43613064e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.42312879]
curr_Stock_Price:  103.21092073888083
curr_Factors:  [1.03210921e+02 3.87243924e-02]
mat_Sqrt:  [[ 2.03103742e+01 -7.86442150e-03]
 [-7.86442150e-03  1.80387028e-02]]
grads:  [-3.86234795e-04 -2.62114863e+00]
Stock Position:  -0.0003862347947613716
Bond Position:  [18.46299244]


portfolio before change:  [18.44467859]
curr_Stock_Price:  107.20685104207703
curr_Factors:  [1.07206851e+02 3.77996760e-02]
mat_Sqrt:  [[ 2.08433033e+01 -7.77021218e-03]
 [-7.77021218e-03  1.78219124e-02]]
grads:  [-9.54109418e-03 -9.67864625e+00]
Stock Position:  -0.009541094176611078
Bond Position:  [19.46754926]


portfolio before change:  [18.45970457]
curr_Stock_Price:  108.18406389498779
curr_Factors:  [1.08184064e+02 3.57160934e-02]
mat_Sqrt:  [[ 2.04453824e+01 -7.55308142e-03]
 [-7.55308142e-03  1.73237379e-02]]
grads:  [-0.01901911 -9.44163378]
Stock Position:  -0.019019105440386562
Bond Position:  [20.51726868]


portfolio before change:  [18.4415967]
curr_Stock_Price:  110.4854598380212
curr_Factors:  [1.10485460e+02 3.73846879e-02]
mat_Sqrt:  [[ 2.13624952e+01 -7.72763730e-03]
 [-7.72763730e-03  1.77237271e-02]]
grads:  [-0.00166025 -1.54921796]
Stock Position:  -0.0016602474456890145
Bond Position:  [18.6250299]


portfolio before change:  [18.46578219]
curr_Stock_Price:  109.9496048129514
curr_Factors:  [1.09949605e+02 3.72840224e-02]
mat_Sqrt:  [[ 2.12302459e+01 -7.71719502e-03]
 [-7.71719502e-03  1.76998623e-02]]
grads:  [ 0.00772364 -6.66956121]
Stock Position:  0.00772363532120899
Bond Position:  [17.61657154]


portfolio before change:  [18.49414914]
curr_Stock_Price:  110.76948651926476
curr_Factors:  [1.10769487e+02 4.18678293e-02]
mat_Sqrt:  [[ 2.26652408e+01 -8.17788493e-03]
 [-8.17788493e-03  1.87563454e-02]]
grads:  [0.0076316  5.66597434]
Stock Position:  0.007631600124848963
Bond Position:  [17.64880071]


portfolio before change:  [18.48681492]
curr_Stock_Price:  106.91590170518228
curr_Factors:  [1.06915902e+02 3.81527136e-02]
mat_Sqrt:  [[ 2.08835819e+01 -7.80639543e-03]
 [-7.80639543e-03  1.79049526e-02]]
grads:  [4.29756117e-03 4.52507235e+00]
Stock Position:  0.004297561169352723
Bond Position:  [18.02733729]


portfolio before change:  [18.50965266]
curr_Stock_Price:  106.98326038601203
curr_Factors:  [1.06983260e+02 3.76905772e-02]
mat_Sqrt:  [[ 2.07697942e+01 -7.75897689e-03]
 [-7.75897689e-03  1.77961807e-02]]
grads:  [-0.01424182  2.78761764]
Stock Position:  -0.014241823078829178
Bond Position:  [20.03328932]


portfolio before change:  [18.49252488]
curr_Stock_Price:  109.9453143914374
curr_Factors:  [1.09945314e+02 3.56009160e-02]
mat_Sqrt:  [[ 2.07447059e+01 -7.54099525e-03]
 [-7.54099525e-03  1.72957379e-02]]
grads:  [0.00341451 2.39106666]
Stock Position:  0.0034145060791417924
Bond Position:  [18.11711593]


portfolio before change:  [18.50497513]
curr_Stock_Price:  106.95504108055823
curr_Factors:  [1.06955041e+02 3.97839670e-02]
mat_Sqrt:  [[ 2.13331640e+01 -7.97153596e-03]
 [-7.97153596e-03  1.82837164e-02]]
grads:  [ 0.00211869 -2.0048585 ]
Stock Position:  0.002118693504549363
Bond Position:  [18.27837018]


portfolio before change:  [18.53739866]
curr_Stock_Price:  111.46786158031911
curr_Factors:  [1.11467862e+02 4.29285760e-02]
mat_Sqrt:  [[ 2.30952615e+01 -8.28087567e-03]
 [-8.28087567e-03  1.89924421e-02]]
grads:  [ 4.15637048e-04 -6.44195529e+00]
Stock Position:  0.00041563704803768327
Bond Position:  [18.49106849]


portfolio before change:  [18.55931993]
curr_Stock_Price:  108.56385121623978
curr_Factors:  [1.08563851e+02 4.49559027e-02]
mat_Sqrt:  [[ 2.30185823e+01 -8.47396837e-03]
 [-8.47396837e-03  1.94358145e-02]]
grads:  [0.00281041 1.46186484]
Stock Position:  0.0028104054764552903
Bond Position:  [18.25421149]


portfolio before change:  [18.59685369]
curr_Stock_Price:  113.795026366403
curr_Factors:  [1.13795026e+02 3.92539108e-02]
mat_Sqrt:  [[ 2.25457517e+01 -7.91866164e-03]
 [-7.91866164e-03  1.81613300e-02]]
grads:  [3.07958850e-03 6.01120816e+00]
Stock Position:  0.003079588502798003
Bond Position:  [18.24641183]


portfolio before change:  [18.63779542]
curr_Stock_Price:  119.67875173258648
curr_Factors:  [1.19678752e+02 3.95156078e-02]
mat_Sqrt:  [[ 2.37903789e+01 -7.94532816e-03]
 [-7.94532816e-03  1.82216311e-02]]
grads:  [-4.63388377e-03 -7.83689527e+00]
Stock Position:  -0.004633883770841376
Bond Position:  [19.19237284]


portfolio before change:  [18.66150536]
curr_Stock_Price:  119.74252514143299
curr_Factors:  [1.19742525e+02 3.61043858e-02]
mat_Sqrt:  [[ 2.27524605e+01 -7.59464824e-03]
 [-7.59464824e-03  1.74173814e-02]]
grads:  [-1.42810571e-03 -7.20888465e+00]
Stock Position:  -0.0014281057142902691
Bond Position:  [18.83251035]


portfolio before change:  [18.67722631]
curr_Stock_Price:  125.22839835265505
curr_Factors:  [1.25228398e+02 3.74258888e-02]
mat_Sqrt:  [[ 2.42263990e+01 -7.73264901e-03]
 [-7.73264901e-03  1.77331618e-02]]
grads:  [ 6.72148217e-03 -1.15215944e+01]
Stock Position:  0.006721482174317319
Bond Position:  [17.83550587]


portfolio before change:  [18.69525827]
curr_Stock_Price:  124.59217539122932
curr_Factors:  [1.24592175e+02 3.65032288e-02]
mat_Sqrt:  [[ 2.38043533e+01 -7.63670922e-03]
 [-7.63670922e-03  1.75132224e-02]]
grads:  [ 4.18425632e-03 -8.55031864e+00]
Stock Position:  0.004184256320357513
Bond Position:  [18.17393268]


portfolio before change:  [18.72615779]
curr_Stock_Price:  126.54422936701349
curr_Factors:  [1.26544229e+02 3.61609508e-02]
mat_Sqrt:  [[ 2.40636911e+01 -7.60090772e-03]
 [-7.60090772e-03  1.74308838e-02]]
grads:  [-0.0054135   2.82474691]
Stock Position:  -0.005413497908397672
Bond Position:  [19.41120471]


portfolio before change:  [18.75971429]
curr_Stock_Price:  124.83048966133593
curr_Factors:  [1.24830490e+02 3.52037519e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.75971429]
Stock Price:  125.42902855171438
PL:  [-6.66931426]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.70417195e-01  4.75353550e-03]
 [ 2.33027724e-02 -6.37970969e-02]
 [ 7.33333761e-02 -3.57041371e-02]
 [-1.40765118e-02 -3.80326174e-03]
 [-1.46413566e-01  5.87275567e-03]
 [ 1.01632946e-01  5.83495592e-02]
 [ 2.85656657e-02  4.75652748e-02]
 [-9.11523639e-02  9.01846046e-02]
 [ 5.86820795e-02  4.86704178e-02]
 [ 6.12465426e-02 -3.06018265e-02]
 [ 5.98002377e-02 -1.13714658e-01]
 [-1.07283513e-02  3.52010468e-02]
 [-7.65423836e-02 -1.36117638e-01]
 [ 1.04274052e-02  6.77967529e-02]
 [-4.79397445e-02 -8.80395515e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 4.82109447e-03 -9.23631429e-02]
 [ 3.41220908e-02  4.62389522e-02]
 [-3.94045331e-02 -3.91336890e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.38962454]
curr_Stock_Price:  97.91525166869205
curr_Factors:  [9.79152517e+01 3.55342654e-02]
mat_Sqrt:  [[ 1.84575468e+01 -7.53316195e-03]
 [-7.53316195e-03  1.72798763e-02]]
grads:  [0.00934686 0.27916559]
Stock Position:  0.00934686477152602
Bond Position:  [-2.30482516]


portfolio before change:  [-1.35978888]
curr_Stock_Price:  101.4157298614689
curr_Factors:  [1.01415730e+02 3.00397954e-02]
mat_Sqrt:  [[ 1.75773650e+01 -6.92653669e-03]
 [-6.92653669e-03  1.58877640e-02]]
grads:  [-2.5666049e-04 -4.0155981e+00]
Stock Position:  -0.0002566604901996885
Bond Position:  [-1.33375947]


portfolio before change:  [-1.36127173]
curr_Stock_Price:  100.69340263938508
curr_Factors:  [1.00693403e+02 3.26974743e-02]
mat_Sqrt:  [[ 1.82078257e+01 -7.22639912e-03]
 [-7.22639912e-03  1.65757021e-02]]
grads:  [ 0.00317323 -2.1526211 ]
Stock Position:  0.003173233199346712
Bond Position:  [-1.68079538]


portfolio before change:  [-1.36470825]
curr_Stock_Price:  100.2729438633475
curr_Factors:  [1.00272944e+02 3.44456929e-02]
mat_Sqrt:  [[ 1.86102066e+01 -7.41704044e-03]
 [-7.41704044e-03  1.70130667e-02]]
grads:  [-0.00084563 -0.22391811]
Stock Position:  -0.0008456285227030842
Bond Position:  [-1.27991459]


portfolio before change:  [-1.36187745]
curr_Stock_Price:  95.03222827551497
curr_Factors:  [9.50322283e+01 3.53923336e-02]
mat_Sqrt:  [[ 1.78782693e+01 -7.51788901e-03]
 [-7.51788901e-03  1.72454249e-02]]
grads:  [-0.00804775  0.33703163]
Stock Position:  -0.008047747660975192
Bond Position:  [-0.59708205]


portfolio before change:  [-1.37904217]
curr_Stock_Price:  97.07229015368732
curr_Factors:  [9.70722902e+01 3.45707571e-02]
mat_Sqrt:  [[ 1.80488562e+01 -7.43026924e-03]
 [-7.43026924e-03  1.70440215e-02]]
grads:  [0.00704161 3.42653171]
Stock Position:  0.00704160962484885
Bond Position:  [-2.06258734]


portfolio before change:  [-1.36936953]
curr_Stock_Price:  98.81230179373867
curr_Factors:  [9.88123018e+01 2.99425964e-02]
mat_Sqrt:  [[ 1.70984093e+01 -6.91515707e-03]
 [-6.91515707e-03  1.58621110e-02]]
grads:  [2.88393205e-03 2.99992967e+00]
Stock Position:  0.0028839320510187527
Bond Position:  [-1.6543375]


portfolio before change:  [-1.36493875]
curr_Stock_Price:  101.06616696047669
curr_Factors:  [1.01066167e+02 3.01041983e-02]
mat_Sqrt:  [[ 1.75355461e+01 -6.93393603e-03]
 [-6.93393603e-03  1.59047953e-02]]
grads:  [-2.95650669e-03  5.66898866e+00]
Stock Position:  -0.0029565066888149493
Bond Position:  [-1.06613595]


portfolio before change:  [-1.36448997]
curr_Stock_Price:  100.46333076410268
curr_Factors:  [1.00463331e+02 2.43850408e-02]
mat_Sqrt:  [[ 1.56880614e+01 -6.24059041e-03]
 [-6.24059041e-03  1.43145185e-02]]
grads:  [0.00509396 3.40229447]
Stock Position:  0.005093963079944819
Bond Position:  [-1.87624646]


portfolio before change:  [-1.37245269]
curr_Stock_Price:  99.36086002966765
curr_Factors:  [9.93608600e+01 2.63648015e-02]
mat_Sqrt:  [[ 1.61334616e+01 -6.48891068e-03]
 [-6.48891068e-03  1.48842888e-02]]
grads:  [ 0.00296984 -2.05468705]
Stock Position:  0.002969843858825526
Bond Position:  [-1.66753893]


portfolio before change:  [-1.37978212]
curr_Stock_Price:  97.59520899036009
curr_Factors:  [9.75952090e+01 2.70987282e-02]
mat_Sqrt:  [[ 1.60658207e+01 -6.57849814e-03]
 [-6.57849814e-03  1.50900843e-02]]
grads:  [ 6.36652217e-04 -7.53544294e+00]
Stock Position:  0.0006366522169020909
Bond Position:  [-1.44191633]


portfolio before change:  [-1.37915797]
curr_Stock_Price:  101.40839647070425
curr_Factors:  [1.01408396e+02 2.81854116e-02]
mat_Sqrt:  [[ 1.70249589e+01 -6.70934024e-03]
 [-6.70934024e-03  1.53895702e-02]]
grads:  [2.71303254e-04 2.28744966e+00]
Stock Position:  0.00027130325388521756
Bond Position:  [-1.4066704]


portfolio before change:  [-1.38149374]
curr_Stock_Price:  99.28408616745872
curr_Factors:  [9.92840862e+01 2.41236516e-02]
mat_Sqrt:  [[ 1.54205950e+01 -6.20698587e-03]
 [-6.20698587e-03  1.42376207e-02]]
grads:  [-8.81338409e-03 -9.56426261e+00]
Stock Position:  -0.008813384087904235
Bond Position:  [-0.50646495]


portfolio before change:  [-1.3925766]
curr_Stock_Price:  100.46971268480705
curr_Factors:  [1.00469713e+02 2.05404735e-02]
mat_Sqrt:  [[ 1.43992659e+01 -5.72755392e-03]
 [-5.72755392e-03  1.31377266e-02]]
grads:  [2.77730620e-03 5.16167385e+00]
Stock Position:  0.0027773062048261988
Bond Position:  [-1.67161175]


portfolio before change:  [-1.38594721]
curr_Stock_Price:  103.60952131362373
curr_Factors:  [1.03609521e+02 2.05680006e-02]
mat_Sqrt:  [[ 1.48592084e+01 -5.73154882e-03]
 [-5.73154882e-03  1.31464578e-02]]
grads:  [-5.81036696e-03 -6.69936001e+00]
Stock Position:  -0.005810366964492328
Bond Position:  [-0.78393787]


portfolio before change:  [-1.37999614]
curr_Stock_Price:  102.41655007186247
curr_Factors:  [1.02416550e+02 2.24923992e-02]
mat_Sqrt:  [[ 1.53598863e+01 -5.99362238e-03]
 [-5.99362238e-03  1.37477446e-02]]
grads:  [ 0.00707382 -4.43717483]
Stock Position:  0.0070738227864250375
Bond Position:  [-2.10447267]


portfolio before change:  [-1.40363334]
curr_Stock_Price:  99.44715708685162
curr_Factors:  [9.94471571e+01 2.49772801e-02]
mat_Sqrt:  [[ 1.57168283e+01 -6.31585953e-03]
 [-6.31585953e-03  1.44873296e-02]]
grads:  [-2.25564073e-03 -6.37642627e+00]
Stock Position:  -0.0022556407331970735
Bond Position:  [-1.17931628]


portfolio before change:  [-1.40856914]
curr_Stock_Price:  100.98141534099025
curr_Factors:  [1.00981415e+02 2.54589425e-02]
mat_Sqrt:  [[ 1.61124506e+01 -6.37655555e-03]
 [-6.37655555e-03  1.46263107e-02]]
grads:  [0.00336944 3.1628234 ]
Stock Position:  0.00336944460971243
Bond Position:  [-1.74882043]


portfolio before change:  [-1.41291924]
curr_Stock_Price:  100.3395563461436
curr_Factors:  [1.00339556e+02 2.72470090e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.41291924]
Stock Price:  97.87743875958846
PL:  [-1.41291924]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-6.03498865e-02 -8.13227725e-02]
 [ 2.75554071e-02 -5.15413158e-02]
 [ 7.35556074e-02 -9.44716291e-02]
 [-1.07215996e-02 -1.03667703e-03]
 [-2.13570983e-01 -9.68206290e-03]
 [ 1.27252440e-01  1.25712419e-01]
 [ 3.04989017e-02  5.00640218e-02]
 [ 3.72472942e-02  4.34860436e-02]
 [-6.32995406e-02 -5.40976320e-02]
 [ 3.78268667e-02  2.02474980e-01]
 [ 5.79062501e-02 -1.08511529e-01]
 [ 1.25952387e-02 -4.96504081e-02]
 [-1.26651935e-01 -1.35733151e-01]
 [-1.22748510e-03  1.57371123e-01]
 [-1.07237852e-01  1.24624544e-01]
 [-1.17991111e-01  4.88483663e-02]
 [-1.01144841e-01  1.90137134e-01]
 [ 8.88363657e-02 -1.24894958e-01]
 [ 3.44075851e-02  5.73779545e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.31065962]
curr_Stock_Price:  100.77528646145754
curr_Factors:  [1.00775286e+02 4.37334650e-02]
mat_Sqrt:  [[ 2.10746782e+01 -8.35741764e-03]
 [-8.35741764e-03  1.91699823e-02]]
grads:  [-0.0045467  -4.24417561]
Stock Position:  -0.004546699779227435
Bond Position:  [9.76885459]


portfolio before change:  [9.32726362]
curr_Stock_Price:  99.81078518619995
curr_Factors:  [9.98107852e+01 4.63315733e-02]
mat_Sqrt:  [[ 2.14840404e+01 -8.60200858e-03]
 [-8.60200858e-03  1.97312235e-02]]
grads:  [ 2.36751730e-04 -2.61206708e+00]
Stock Position:  0.00023675173025069563
Bond Position:  [9.30363324]


portfolio before change:  [9.33934328]
curr_Stock_Price:  101.68129805241482
curr_Factors:  [1.01681298e+02 4.08282536e-02]
mat_Sqrt:  [[ 2.05457240e+01 -8.07512177e-03]
 [-8.07512177e-03  1.85222824e-02]]
grads:  [ 1.57573181e-03 -5.09974435e+00]
Stock Position:  0.00157573180657
Bond Position:  [9.17912082]


portfolio before change:  [9.34826087]
curr_Stock_Price:  100.05444250604778
curr_Factors:  [1.00054443e+02 4.01058059e-02]
mat_Sqrt:  [[ 2.00373353e+01 -8.00324186e-03]
 [-8.00324186e-03  1.83577280e-02]]
grads:  [-0.00055773 -0.05671403]
Stock Position:  -0.0005577336260827137
Bond Position:  [9.40406459]


portfolio before change:  [9.36124135]
curr_Stock_Price:  97.87050113925872
curr_Factors:  [9.78705011e+01 3.67659693e-02]
mat_Sqrt:  [[ 1.87661328e+01 -7.66260534e-03]
 [-7.66260534e-03  1.75768078e-02]]
grads:  [-0.01160765 -0.55590343]
Stock Position:  -0.01160764734577497
Bond Position:  [10.49728762]


portfolio before change:  [9.33596096]
curr_Stock_Price:  101.17954440604656
curr_Factors:  [1.01179544e+02 3.45372618e-02]
mat_Sqrt:  [[ 1.88034109e+01 -7.42695324e-03]
 [-7.42695324e-03  1.70356386e-02]]
grads:  [0.00968389 7.38359995]
Stock Position:  0.009683886198517204
Bond Position:  [8.35614977]


portfolio before change:  [9.31805415]
curr_Stock_Price:  98.25111989375141
curr_Factors:  [9.82511199e+01 3.65638228e-02]
mat_Sqrt:  [[ 1.87872524e+01 -7.64153874e-03]
 [-7.64153874e-03  1.75284088e-02]]
grads:  [2.78559489e-03 2.85737906e+00]
Stock Position:  0.002785594891272434
Bond Position:  [9.04436633]


portfolio before change:  [9.3265614]
curr_Stock_Price:  97.24405602966006
curr_Factors:  [9.72440560e+01 3.34715289e-02]
mat_Sqrt:  [[ 1.77910182e+01 -7.31119900e-03]
 [-7.31119900e-03  1.67708574e-02]]
grads:  [0.00315974 2.59433039]
Stock Position:  0.003159738211197261
Bond Position:  [9.01929564]


portfolio before change:  [9.32279318]
curr_Stock_Price:  92.48119413941569
curr_Factors:  [9.24811941e+01 3.60606164e-02]
mat_Sqrt:  [[ 1.75618378e+01 -7.58833226e-03]
 [-7.58833226e-03  1.74075667e-02]]
grads:  [-0.00494813 -3.10986487]
Stock Position:  -0.004948128412681445
Bond Position:  [9.780402]


portfolio before change:  [9.331298]
curr_Stock_Price:  93.23467554513428
curr_Factors:  [9.32346755e+01 3.65578656e-02]
mat_Sqrt:  [[ 1.78265721e+01 -7.64053302e-03]
 [-7.64053302e-03  1.75271478e-02]]
grads:  [7.0745213e-03 1.1555162e+01]
Stock Position:  0.007074521295334583
Bond Position:  [8.6717073]


portfolio before change:  [9.33359729]
curr_Stock_Price:  92.02651959360884
curr_Factors:  [9.20265196e+01 4.10476110e-02]
mat_Sqrt:  [[ 1.86447644e+01 -8.09602022e-03]
 [-8.09602022e-03  1.85723064e-02]]
grads:  [ 5.68847430e-04 -5.84240435e+00]
Stock Position:  0.0005688474296715
Bond Position:  [9.28124824]


portfolio before change:  [9.34360221]
curr_Stock_Price:  89.20698116330095
curr_Factors:  [8.92069812e+01 4.92769813e-02]
mat_Sqrt:  [[ 1.98025376e+01 -8.87025345e-03]
 [-8.87025345e-03  2.03491626e-02]]
grads:  [-4.56975352e-04 -2.44012310e+00]
Stock Position:  -0.0004569753524597969
Bond Position:  [9.38436761]


portfolio before change:  [9.35420041]
curr_Stock_Price:  91.70076391508123
curr_Factors:  [9.17007639e+01 4.60092847e-02]
mat_Sqrt:  [[ 1.96696057e+01 -8.57134244e-03]
 [-8.57134244e-03  1.96627805e-02]]
grads:  [-0.00944887 -6.90716864]
Stock Position:  -0.009448874895415764
Bond Position:  [10.22066946]


portfolio before change:  [9.40341838]
curr_Stock_Price:  87.8448399815621
curr_Factors:  [8.7844840e+01 4.8563947e-02]
mat_Sqrt:  [[ 1.93585667e+01 -8.80570347e-03]
 [-8.80570347e-03  2.02014617e-02]]
grads:  [3.48078776e-03 7.79160317e+00]
Stock Position:  0.003480787757164721
Bond Position:  [9.09764914]


portfolio before change:  [9.40848954]
curr_Stock_Price:  86.03260211862046
curr_Factors:  [8.60326021e+01 5.00372613e-02]
mat_Sqrt:  [[ 1.92446394e+01 -8.93808123e-03]
 [-8.93808123e-03  2.05056899e-02]]
grads:  [-2.75021257e-03  6.07636041e+00]
Stock Position:  -0.0027502125729734457
Bond Position:  [9.64509748]


portfolio before change:  [9.41682646]
curr_Stock_Price:  87.38776557768682
curr_Factors:  [8.73877656e+01 5.40149268e-02]
mat_Sqrt:  [[ 2.03098860e+01 -9.28670385e-03]
 [-9.28670385e-03  2.13050792e-02]]
grads:  [-0.0047621   2.29072803]
Stock Position:  -0.004762104413977254
Bond Position:  [9.83297612]


portfolio before change:  [9.44422639]
curr_Stock_Price:  84.21668351462671
curr_Factors:  [8.42166835e+01 5.92483647e-02]
mat_Sqrt:  [[ 2.04991697e+01 -9.72580927e-03]
 [-9.72580927e-03  2.23135000e-02]]
grads:  [-8.91418676e-04  8.52078180e+00]
Stock Position:  -0.0008914186760403048
Bond Position:  [9.51929871]


portfolio before change:  [9.4538711]
curr_Stock_Price:  86.75404762141285
curr_Factors:  [8.67540476e+01 5.50700119e-02]
mat_Sqrt:  [[ 2.03585707e+01 -9.37689302e-03]
 [-9.37689302e-03  2.15121825e-02]]
grads:  [ 1.68985893e-03 -5.80504151e+00]
Stock Position:  0.0016898589260600626
Bond Position:  [9.307269]


portfolio before change:  [9.46205568]
curr_Stock_Price:  84.7084436431493
curr_Factors:  [8.47084436e+01 5.72111886e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.46205568]
Stock Price:  86.94223370143555
PL:  [9.46205568]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-1.14111056e-02 -6.29105797e-02]
 [ 6.23499366e-03 -8.43182120e-02]
 [-2.62847285e-01 -1.85459250e-01]
 [-1.86979178e-02 -1.44057201e-02]
 [-2.02572516e-01 -5.91223383e-03]
 [ 1.13303496e-01  8.73871778e-02]
 [ 2.53250103e-02  4.33766614e-02]
 [ 3.23789584e-02 -1.54748900e-02]
 [-4.77235485e-02 -4.23749012e-02]
 [ 5.77620535e-02 -1.19670583e-02]
 [ 5.87262711e-02 -1.10764276e-01]
 [ 2.14016137e-02 -8.31494064e-02]
 [-1.39592149e-01 -1.29793383e-01]
 [ 4.18767690e-03  1.64492256e-01]
 [-9.45818404e-02  1.84674780e-02]
 [ 4.04808915e-02 -3.11095549e-02]
 [-6.19435320e-02  7.24213112e-02]
 [ 1.15018652e-01 -8.14559924e-02]
 [ 1.20845233e-01  6.85131371e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.02362383]
curr_Stock_Price:  99.89670823244037
curr_Factors:  [9.98967082e+01 4.00521602e-02]
mat_Sqrt:  [[ 1.99923624e+01 -7.99787593e-03]
 [-7.99787593e-03  1.83454513e-02]]
grads:  [-1.94295960e-03 -3.43006657e+00]
Stock Position:  -0.0019429596016815637
Bond Position:  [6.2177191]


portfolio before change:  [6.02648648]
curr_Stock_Price:  102.42602422264599
curr_Factors:  [1.02426024e+02 3.80485463e-02]
mat_Sqrt:  [[ 1.99792562e+01 -7.79543862e-03]
 [-7.79543862e-03  1.78806208e-02]]
grads:  [-1.52811122e-03 -4.71628616e+00]
Stock Position:  -0.0015281112208914256
Bond Position:  [6.18300484]


portfolio before change:  [6.02643162]
curr_Stock_Price:  107.52280757031119
curr_Factors:  [1.07522808e+02 3.45820052e-02]
mat_Sqrt:  [[ 1.99951954e+01 -7.43215941e-03]
 [-7.43215941e-03  1.70464970e-02]]
grads:  [ -0.01719223 -10.88710637]
Stock Position:  -0.01719222986801827
Bond Position:  [7.87498844]


portfolio before change:  [6.12946189]
curr_Stock_Price:  102.10289493672555
curr_Factors:  [1.02102895e+02 3.50024242e-02]
mat_Sqrt:  [[ 1.91023626e+01 -7.47686183e-03]
 [-7.47686183e-03  1.71499498e-02]]
grads:  [-0.00130783 -0.84055631]
Stock Position:  -0.0013078299141697832
Bond Position:  [6.26299511]


portfolio before change:  [6.14371738]
curr_Stock_Price:  97.19258813326248
curr_Factors:  [9.71925881e+01 3.38223766e-02]
mat_Sqrt:  [[ 1.78745522e+01 -7.34941334e-03]
 [-7.34941334e-03  1.68585257e-02]]
grads:  [-0.01147926 -0.35570131]
Stock Position:  -0.011479264441461355
Bond Position:  [7.2594168]


portfolio before change:  [6.14494013]
curr_Stock_Price:  97.87705621570095
curr_Factors:  [9.78770562e+01 3.55791948e-02]
mat_Sqrt:  [[ 1.84620074e+01 -7.53792014e-03]
 [-7.53792014e-03  1.72907984e-02]]
grads:  [0.00820208 5.05754579]
Stock Position:  0.008202080599872435
Bond Position:  [5.34214463]


portfolio before change:  [6.16708953]
curr_Stock_Price:  99.76286293549472
curr_Factors:  [9.97628629e+01 3.41685494e-02]
mat_Sqrt:  [[ 1.84409012e+01 -7.38710763e-03]
 [-7.38710763e-03  1.69445016e-02]]
grads:  [2.39918763e-03 2.56097142e+00]
Stock Position:  0.00239918762547909
Bond Position:  [5.9277397]


portfolio before change:  [6.16223328]
curr_Stock_Price:  94.64839878443964
curr_Factors:  [9.46483988e+01 3.54918010e-02]
mat_Sqrt:  [[ 1.78310637e+01 -7.52841640e-03]
 [-7.52841640e-03  1.72696542e-02]]
grads:  [ 0.00143781 -0.89544732]
Stock Position:  0.0014378086763995926
Bond Position:  [6.02614699]


portfolio before change:  [6.16792977]
curr_Stock_Price:  93.36804641448387
curr_Factors:  [9.33680464e+01 3.33684988e-02]
mat_Sqrt:  [[ 1.70555829e+01 -7.29965248e-03]
 [-7.29965248e-03  1.67451504e-02]]
grads:  [-0.00388191 -2.53226975]
Stock Position:  -0.0038819099953355434
Bond Position:  [6.53037612]


portfolio before change:  [6.15701111]
curr_Stock_Price:  98.28488742280175
curr_Factors:  [9.82848874e+01 3.55359168e-02]
mat_Sqrt:  [[ 1.85276557e+01 -7.53336349e-03]
 [-7.53336349e-03  1.72802663e-02]]
grads:  [ 0.00283653 -0.69129083]
Stock Position:  0.0028365330901273566
Bond Position:  [5.87822277]


portfolio before change:  [6.15142851]
curr_Stock_Price:  93.72475178463493
curr_Factors:  [9.37247518e+01 3.79146038e-02]
mat_Sqrt:  [[ 1.82497753e+01 -7.78105944e-03]
 [-7.78105944e-03  1.78494020e-02]]
grads:  [ 5.72222371e-04 -6.20524002e+00]
Stock Position:  0.0005722223706186298
Bond Position:  [6.09779711]


portfolio before change:  [6.15492326]
curr_Stock_Price:  86.50333721369658
curr_Factors:  [8.65033372e+01 4.64920619e-02]
mat_Sqrt:  [[ 1.86518631e+01 -8.61567783e-03]
 [-8.61567783e-03  1.97658978e-02]]
grads:  [-7.95900985e-04 -4.20705726e+00]
Stock Position:  -0.0007959009847250946
Bond Position:  [6.22377135]


portfolio before change:  [6.16000292]
curr_Stock_Price:  89.90190902059291
curr_Factors:  [8.99019090e+01 4.76505412e-02]
mat_Sqrt:  [[ 1.96246893e+01 -8.72270824e-03]
 [-8.72270824e-03  2.00104916e-02]]
grads:  [-0.00999802 -6.49062478]
Stock Position:  -0.00999801691564537
Bond Position:  [7.05884372]


portfolio before change:  [6.12130835]
curr_Stock_Price:  94.65521546108799
curr_Factors:  [9.46552155e+01 4.55443837e-02]
mat_Sqrt:  [[ 2.02004910e+01 -8.52819374e-03]
 [-8.52819374e-03  1.95630711e-02]]
grads:  [3.75779462e-03 8.40994253e+00]
Stock Position:  0.003757794615121874
Bond Position:  [5.76561349]


portfolio before change:  [6.11561434]
curr_Stock_Price:  91.22087763303354
curr_Factors:  [9.12208776e+01 4.64440485e-02]
mat_Sqrt:  [[ 1.96589012e+01 -8.61169934e-03]
 [-8.61169934e-03  1.97554833e-02]]
grads:  [-0.00440249  0.93288353]
Stock Position:  -0.004402490614463371
Bond Position:  [6.51721339]


portfolio before change:  [6.10168561]
curr_Stock_Price:  96.23629734627269
curr_Factors:  [9.62362973e+01 4.83191618e-02]
mat_Sqrt:  [[ 2.11542954e+01 -8.78428145e-03]
 [-8.78428145e-03  2.01501369e-02]]
grads:  [ 1.27273530e-03 -1.54333318e+00]
Stock Position:  0.0012727353005432488
Bond Position:  [5.97920227]


portfolio before change:  [6.10438229]
curr_Stock_Price:  92.47904120046341
curr_Factors:  [9.24790412e+01 4.75185800e-02]
mat_Sqrt:  [[ 2.01592794e+01 -8.71086901e-03]
 [-8.71086901e-03  1.99826565e-02]]
grads:  [-1.50696110e-03  3.62355146e+00]
Stock Position:  -0.0015069610988451292
Bond Position:  [6.24374461]


portfolio before change:  [6.11442435]
curr_Stock_Price:  90.99758324097168
curr_Factors:  [9.09975832e+01 4.93071801e-02]
mat_Sqrt:  [[ 2.02062117e+01 -8.87315028e-03]
 [-8.87315028e-03  2.03553188e-02]]
grads:  [ 3.93572737e-03 -3.99998992e+00]
Stock Position:  0.003935727367916336
Bond Position:  [5.75628267]


portfolio before change:  [6.12062892]
curr_Stock_Price:  90.74469863592918
curr_Factors:  [9.07446986e+01 4.81300099e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.12062892]
Stock Price:  92.62798552253687
PL:  [6.12062892]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 2.62014393e-02 -4.08793159e-02]
 [-2.64177777e-02 -1.23577643e-01]
 [-2.26761581e-01 -2.00025593e-01]
 [-2.31989605e-02 -2.66397999e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-3.43014054e-01  5.13571502e-02]
 [ 7.74920532e-02  6.95799759e-02]
 [ 6.42528814e-02 -4.91751564e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 7.55442131e-02  2.51709424e-02]
 [ 2.37737136e-02  9.86900482e-02]
 [-1.59953653e-02 -1.97929624e-01]
 [ 5.97258064e-03 -1.16570484e-01]
 [ 2.18177293e-01 -1.62907441e-01]
 [ 1.25242327e-01 -1.50019337e-01]
 [-1.10462222e-01  4.50617978e-02]
 [-1.08662106e-01 -1.20499187e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.07484373]
curr_Stock_Price:  103.65240080789539
curr_Factors:  [1.03652401e+02 4.29092880e-02]
mat_Sqrt:  [[ 2.14711343e+01 -8.27850224e-03]
 [-8.27850224e-03  1.89883986e-02]]
grads:  [ 3.90310658e-04 -2.15268731e+00]
Stock Position:  0.0003903106581170585
Bond Position:  [20.03438709]


portfolio before change:  [20.10029354]
curr_Stock_Price:  104.65459627084725
curr_Factors:  [1.04654596e+02 4.34529724e-02]
mat_Sqrt:  [[ 2.18156431e+01 -8.33085426e-03]
 [-8.33085426e-03  1.91082859e-02]]
grads:  [-3.68124296e-03 -6.46883300e+00]
Stock Position:  -0.003681242958799702
Bond Position:  [20.48555253]


portfolio before change:  [20.11694071]
curr_Stock_Price:  107.09284315133392
curr_Factors:  [1.07092843e+02 4.60105444e-02]
mat_Sqrt:  [[ 2.29714868e+01 -8.57269023e-03]
 [-8.57269023e-03  1.96625132e-02]]
grads:  [ -0.01367008 -10.17890135]
Stock Position:  -0.013670083796303311
Bond Position:  [21.58090885]


portfolio before change:  [20.08810222]
curr_Stock_Price:  111.17705289071128
curr_Factors:  [1.11177053e+02 4.27408412e-02]
mat_Sqrt:  [[ 2.29845848e+01 -8.26273115e-03]
 [-8.26273115e-03  1.89508756e-02]]
grads:  [-0.00151491 -1.40638975]
Stock Position:  -0.0015149101570912208
Bond Position:  [20.25652547]


portfolio before change:  [20.11620382]
curr_Stock_Price:  109.35178909298351
curr_Factors:  [1.09351789e+02 4.12464466e-02]
mat_Sqrt:  [[ 2.22084953e+01 -8.11688490e-03]
 [-8.11688490e-03  1.86166766e-02]]
grads:  [ 0.00738344 -6.34108826]
Stock Position:  0.007383440256798113
Bond Position:  [19.30881142]


portfolio before change:  [20.13760489]
curr_Stock_Price:  108.97932863091619
curr_Factors:  [1.08979329e+02 3.92807334e-02]
mat_Sqrt:  [[ 2.15990124e+01 -7.92108490e-03]
 [-7.92108490e-03  1.81676567e-02]]
grads:  [0.00800832 5.84962594]
Stock Position:  0.008008317646228365
Bond Position:  [19.26486381]


portfolio before change:  [20.13643591]
curr_Stock_Price:  105.82446874134504
curr_Factors:  [1.05824469e+02 3.88720424e-02]
mat_Sqrt:  [[ 2.08643445e+01 -7.87957281e-03]
 [-7.87957281e-03  1.80729842e-02]]
grads:  [4.30151302e-03 4.48302012e+00]
Stock Position:  0.004301513024906179
Bond Position:  [19.68123058]


portfolio before change:  [20.161466]
curr_Stock_Price:  105.92052059731282
curr_Factors:  [1.05920521e+02 3.78598117e-02]
mat_Sqrt:  [[ 2.06095876e+01 -7.77630989e-03]
 [-7.77630989e-03  1.78361185e-02]]
grads:  [-0.01555954  2.87260676]
Stock Position:  -0.015559543463625347
Bond Position:  [21.80954094]


portfolio before change:  [20.2377282]
curr_Stock_Price:  102.77240557607864
curr_Factors:  [1.02772406e+02 3.89309275e-02]
mat_Sqrt:  [[ 2.02779414e+01 -7.88533605e-03]
 [-7.88533605e-03  1.80867562e-02]]
grads:  [0.00531836 3.84933108]
Stock Position:  0.005318356533575554
Bond Position:  [19.69114791]


portfolio before change:  [20.26739752]
curr_Stock_Price:  103.72006568122059
curr_Factors:  [1.03720066e+02 3.45008167e-02]
mat_Sqrt:  [[ 1.92653737e+01 -7.42319818e-03]
 [-7.42319818e-03  1.70265762e-02]]
grads:  [ 2.22268360e-03 -2.88717218e+00]
Stock Position:  0.002222683596981681
Bond Position:  [20.03686063]


portfolio before change:  [20.30840776]
curr_Stock_Price:  110.89540229066905
curr_Factors:  [1.10895402e+02 3.02357698e-02]
mat_Sqrt:  [[ 1.92829745e+01 -6.94963020e-03]
 [-6.94963020e-03  1.59392703e-02]]
grads:  [ 4.97823785e-04 -7.67591256e+00]
Stock Position:  0.0004978237846220957
Bond Position:  [20.25320139]


portfolio before change:  [20.33300916]
curr_Stock_Price:  109.42714590738586
curr_Factors:  [1.09427146e+02 3.54117804e-02]
mat_Sqrt:  [[ 2.05920187e+01 -7.52090754e-03]
 [-7.52090754e-03  1.72497465e-02]]
grads:  [0.00420224 1.46103869]
Stock Position:  0.004202237339069813
Bond Position:  [19.87317032]


portfolio before change:  [20.37198816]
curr_Stock_Price:  112.78773861877887
curr_Factors:  [1.12787739e+02 3.65775423e-02]
mat_Sqrt:  [[ 2.15709426e+01 -7.64389054e-03]
 [-7.64389054e-03  1.75312966e-02]]
grads:  [3.09742043e-03 5.63071442e+00]
Stock Position:  0.0030974204337510304
Bond Position:  [20.02263711]


portfolio before change:  [20.39529999]
curr_Stock_Price:  112.2285272683586
curr_Factors:  [1.12228527e+02 3.38747425e-02]
mat_Sqrt:  [[ 2.06557628e+01 -7.35602918e-03]
 [-7.35602918e-03  1.68711665e-02]]
grads:  [-4.95314173e-03 -1.17339876e+01]
Stock Position:  -0.004953141728455812
Bond Position:  [20.95118379]


portfolio before change:  [20.39633497]
curr_Stock_Price:  117.31022746526901
curr_Factors:  [1.17310227e+02 2.61468597e-02]
mat_Sqrt:  [[ 1.89690517e+01 -6.46294654e-03]
 [-6.46294654e-03  1.48222441e-02]]
grads:  [-2.36502806e-03 -7.86559501e+00]
Stock Position:  -0.0023650280550020285
Bond Position:  [20.67377695]


portfolio before change:  [20.41574345]
curr_Stock_Price:  120.0374237773812
curr_Factors:  [1.20037424e+02 2.74716532e-02]
mat_Sqrt:  [[ 1.98956916e+01 -6.62477141e-03]
 [-6.62477141e-03  1.51930555e-02]]
grads:  [ 7.39680700e-03 -1.07192683e+01]
Stock Position:  0.00739680700382251
Bond Position:  [19.52784979]


portfolio before change:  [20.43275955]
curr_Stock_Price:  119.03577872671292
curr_Factors:  [1.19035779e+02 3.25275982e-02]
mat_Sqrt:  [[ 2.14685885e+01 -7.20861298e-03]
 [-7.20861298e-03  1.65321469e-02]]
grads:  [ 2.78719955e-03 -9.07318606e+00]
Stock Position:  0.0027871995529827882
Bond Position:  [20.10098308]


portfolio before change:  [20.46100618]
curr_Stock_Price:  120.14968830545754
curr_Factors:  [1.20149688e+02 3.31340098e-02]
mat_Sqrt:  [[ 2.18705459e+01 -7.27554963e-03]
 [-7.27554963e-03  1.66855170e-02]]
grads:  [-0.00415292  2.69884254]
Stock Position:  -0.004152921430172164
Bond Position:  [20.95997839]


portfolio before change:  [20.48617237]
curr_Stock_Price:  120.40256026970158
curr_Factors:  [1.20402560e+02 3.46580569e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.48617237]
Stock Price:  118.94773410474555
PL:  [1.53843827]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 7.91738914e-02 -2.88149473e-02]
 [-7.88287439e-02 -1.53688195e-01]
 [-1.54305794e-01 -2.29367790e-01]
 [-2.42915297e-02 -2.96094628e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [ 1.18418935e-01 -1.29691575e-01]
 [ 5.21669157e-02  4.10384691e-02]
 [ 6.08201236e-02 -3.27013599e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 1.71719408e-01  1.17866808e-02]
 [ 2.17239648e-02  1.09722803e-01]
 [ 5.97134312e-03 -1.43687126e-01]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.70038419e-01 -1.03777487e-01]
 [ 6.45036670e-02 -1.50321263e-01]
 [-2.88338645e-02  3.71103369e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.24327153]
curr_Stock_Price:  98.88627346594673
curr_Factors:  [9.88862735e+01 4.35288981e-02]
mat_Sqrt:  [[ 2.06312153e+01 -8.33770372e-03]
 [-8.33770372e-03  1.91251582e-02]]
grads:  [ 0.00322926 -1.50524363]
Stock Position:  0.003229262789494713
Bond Position:  [1.92394176]


portfolio before change:  [2.2694624]
curr_Stock_Price:  106.25155873555262
curr_Factors:  [1.06251559e+02 3.80729426e-02]
mat_Sqrt:  [[ 2.07321098e+01 -7.79818845e-03]
 [-7.79818845e-03  1.78862428e-02]]
grads:  [-7.03540952e-03 -8.59560391e+00]
Stock Position:  -0.007035409524542115
Bond Position:  [3.01698563]


portfolio before change:  [2.27334877]
curr_Stock_Price:  106.23552817948206
curr_Factors:  [1.06235528e+02 4.11508827e-02]
mat_Sqrt:  [[ 2.15505981e+01 -8.10727725e-03]
 [-8.10727725e-03  1.85951844e-02]]
grads:  [-1.18024156e-02 -1.23399409e+01]
Stock Position:  -0.01180241562579978
Bond Position:  [3.52718463]


portfolio before change:  [2.27948509]
curr_Stock_Price:  106.0894072420532
curr_Factors:  [1.06089407e+02 4.49186841e-02]
mat_Sqrt:  [[ 2.24846175e+01 -8.47029321e-03]
 [-8.47029321e-03  1.94278402e-02]]
grads:  [-0.00165478 -1.52479529]
Stock Position:  -0.0016547754442234302
Bond Position:  [2.45503923]


portfolio before change:  [2.27312019]
curr_Stock_Price:  111.791458759618
curr_Factors:  [1.11791459e+02 4.54329746e-02]
mat_Sqrt:  [[ 2.38283616e+01 -8.51902008e-03]
 [-8.51902008e-03  1.95385783e-02]]
grads:  [ 0.00688144 -6.04195938]
Stock Position:  0.0068814386495481715
Bond Position:  [1.50383413]


portfolio before change:  [2.25823988]
curr_Stock_Price:  109.35573617704507
curr_Factors:  [1.09355736e+02 4.16956664e-02]
mat_Sqrt:  [[ 2.23299114e+01 -8.16096641e-03]
 [-8.16096641e-03  1.87177801e-02]]
grads:  [0.00774619 5.67769132]
Stock Position:  0.007746193587272885
Bond Position:  [1.41114918]


portfolio before change:  [2.30038278]
curr_Stock_Price:  114.5683428562211
curr_Factors:  [1.14568343e+02 4.19704738e-02]
mat_Sqrt:  [[ 2.34712674e+01 -8.18812787e-03]
 [-8.18812787e-03  1.87792252e-02]]
grads:  [3.82381993e-03 4.31428701e+00]
Stock Position:  0.003823819932439511
Bond Position:  [1.86229407]


portfolio before change:  [2.32452076]
curr_Stock_Price:  120.27171104227706
curr_Factors:  [1.20271711e+02 3.63505939e-02]
mat_Sqrt:  [[ 2.29308008e+01 -7.62052514e-03]
 [-7.62052514e-03  1.74766569e-02]]
grads:  [ 2.69842999e-03 -7.41966910e+00]
Stock Position:  0.002698429989055071
Bond Position:  [1.99997597]


portfolio before change:  [2.30189411]
curr_Stock_Price:  110.95956311466627
curr_Factors:  [1.10959563e+02 3.69784633e-02]
mat_Sqrt:  [[ 2.13372841e+01 -7.68556532e-03]
 [-7.68556532e-03  1.76271586e-02]]
grads:  [0.00328397 2.32957048]
Stock Position:  0.00328396910683111
Bond Position:  [1.93750634]


portfolio before change:  [2.30648712]
curr_Stock_Price:  111.62023099944899
curr_Factors:  [1.11620231e+02 3.48204335e-02]
mat_Sqrt:  [[ 2.08285950e+01 -7.45796939e-03]
 [-7.45796939e-03  1.71050585e-02]]
grads:  [ 0.00223583 -1.91081983]
Stock Position:  0.0022358343313372895
Bond Position:  [2.05692278]


portfolio before change:  [2.30965471]
curr_Stock_Price:  111.88627119620574
curr_Factors:  [1.11886271e+02 3.51477349e-02]
mat_Sqrt:  [[ 2.09761338e+01 -7.49295334e-03]
 [-7.49295334e-03  1.71852553e-02]]
grads:  [ 4.57617485e-04 -7.11938659e+00]
Stock Position:  0.0004576174852012123
Bond Position:  [2.25845359]


portfolio before change:  [2.31296589]
curr_Stock_Price:  112.94906272631603
curr_Factors:  [1.12949063e+02 3.86150952e-02]
mat_Sqrt:  [[ 2.21953071e+01 -7.85391610e-03]
 [-7.85391610e-03  1.80129663e-02]]
grads:  [0.00796952 0.65781907]
Stock Position:  0.007969516383056787
Bond Position:  [1.41281648]


portfolio before change:  [2.32187095]
curr_Stock_Price:  113.84471799754515
curr_Factors:  [1.13844718e+02 3.50464996e-02]
mat_Sqrt:  [[ 2.13125386e+01 -7.48226003e-03]
 [-7.48226003e-03  1.71604423e-02]]
grads:  [3.26454405e-03 6.39536131e+00]
Stock Position:  0.0032645440538543987
Bond Position:  [1.95021986]


portfolio before change:  [2.30547844]
curr_Stock_Price:  108.07612776443013
curr_Factors:  [1.08076128e+02 3.54231897e-02]
mat_Sqrt:  [[ 2.03410599e+01 -7.52204031e-03]
 [-7.52204031e-03  1.72525594e-02]]
grads:  [-2.78671582e-03 -8.32966775e+00]
Stock Position:  -0.0027867158222667134
Bond Position:  [2.60665589]


portfolio before change:  [2.31327526]
curr_Stock_Price:  106.44823806668327
curr_Factors:  [1.06448238e+02 2.94778966e-02]
mat_Sqrt:  [[ 1.82762332e+01 -6.86174289e-03]
 [-6.86174289e-03  1.57383433e-02]]
grads:  [-4.67525774e-03 -5.53709306e+00]
Stock Position:  -0.004675257736144897
Bond Position:  [2.81094821]


portfolio before change:  [2.28835201]
curr_Stock_Price:  112.53113853747145
curr_Factors:  [1.12531139e+02 2.77092726e-02]
mat_Sqrt:  [[ 1.87320474e+01 -6.65302197e-03]
 [-6.65302197e-03  1.52587688e-02]]
grads:  [ 6.66288140e-03 -6.79826534e+00]
Stock Position:  0.006662881399852243
Bond Position:  [1.53857038]


portfolio before change:  [2.26797057]
curr_Stock_Price:  109.18335932697681
curr_Factors:  [1.09183359e+02 3.17239088e-02]
mat_Sqrt:  [[ 1.94468726e+01 -7.11850678e-03]
 [-7.11850678e-03  1.63268475e-02]]
grads:  [-5.33032113e-05 -9.20702189e+00]
Stock Position:  -5.3303211347938934e-05
Bond Position:  [2.2737904]


portfolio before change:  [2.27088417]
curr_Stock_Price:  107.87795854638475
curr_Factors:  [1.07877959e+02 3.55840383e-02]
mat_Sqrt:  [[ 2.03498075e+01 -7.53908716e-03]
 [-7.53908716e-03  1.72916901e-02]]
grads:  [-6.21922072e-04  2.14586590e+00]
Stock Position:  -0.0006219220723507827
Bond Position:  [2.33797585]


portfolio before change:  [2.27572515]
curr_Stock_Price:  104.79609697533324
curr_Factors:  [1.04796097e+02 3.63788417e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.27572515]
Stock Price:  105.70200596371446
PL:  [-3.42628082]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.59041004e-01  1.89347770e-04]
 [ 3.67313881e-02  8.17562771e-03]
 [ 6.62001665e-02  4.55492205e-02]
 [-1.15175085e-02 -1.70481488e-03]
 [-1.42357093e-01 -6.08439768e-02]
 [ 7.43131580e-02  5.29217290e-03]
 [-1.27344543e-01 -1.62220022e-01]
 [ 3.18434691e-02 -1.77990765e-02]
 [ 4.27671350e-02  3.19850981e-02]
 [ 5.91678042e-02 -2.29117268e-02]
 [ 5.92316975e-02 -1.12152774e-01]
 [ 4.33096013e-03 -1.92467624e-02]
 [-9.91290062e-02 -1.39344863e-01]
 [ 4.89251244e-03  1.65419140e-01]
 [-1.05252314e-01  1.08085428e-01]
 [-4.94909976e-02  1.24390609e-02]
 [-5.58258310e-02  6.12276391e-02]
 [ 1.16949430e-01 -7.82160173e-02]
 [ 1.28276150e-01  7.15595231e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.56251525]
curr_Stock_Price:  96.79989693237111
curr_Factors:  [9.67998969e+01 4.89179787e-02]
mat_Sqrt:  [[ 2.14096274e+01 -8.83859439e-03]
 [-8.83859439e-03  2.02745909e-02]]
grads:  [0.00743367 0.01257983]
Stock Position:  0.007433674068385458
Bond Position:  [-6.28209414]


portfolio before change:  [-5.56068133]
curr_Stock_Price:  98.10361960233737
curr_Factors:  [9.81036196e+01 4.87005295e-02]
mat_Sqrt:  [[ 2.16496977e+01 -8.81903882e-03]
 [-8.81903882e-03  2.02294303e-02]]
grads:  [0.00186158 0.40495679]
Stock Position:  0.0018615833939397144
Bond Position:  [-5.7433094]


portfolio before change:  [-5.56645414]
curr_Stock_Price:  98.86147783515774
curr_Factors:  [9.88614778e+01 4.51135402e-02]
mat_Sqrt:  [[ 2.09981250e+01 -8.48810954e-03]
 [-8.48810954e-03  1.94701669e-02]]
grads:  [0.00409907 2.34122358]
Stock Position:  0.004099067348086192
Bond Position:  [-5.971694]


portfolio before change:  [-5.56877162]
curr_Stock_Price:  100.1183023048658
curr_Factors:  [1.00118302e+02 4.34092616e-02]
mat_Sqrt:  [[ 2.08595359e+01 -8.32633290e-03]
 [-8.32633290e-03  1.90988166e-02]]
grads:  [-0.00058788 -0.08951915]
Stock Position:  -0.0005878785972005894
Bond Position:  [-5.50991421]


portfolio before change:  [-5.57576213]
curr_Stock_Price:  100.28637972779867
curr_Factors:  [1.00286380e+02 4.56060323e-02]
mat_Sqrt:  [[ 2.14167252e+01 -8.53442728e-03]
 [-8.53442728e-03  1.95761047e-02]]
grads:  [-0.00788692 -3.11151214]
Stock Position:  -0.007886923221598984
Bond Position:  [-4.78481115]


portfolio before change:  [-5.54264606]
curr_Stock_Price:  95.328703002317
curr_Factors:  [9.5328703e+01 4.5460392e-02]
mat_Sqrt:  [[ 2.03254530e+01 -8.52038462e-03]
 [-8.52038462e-03  1.95449985e-02]]
grads:  [0.00377036 0.27241229]
Stock Position:  0.0037703570678544076
Bond Position:  [-5.90206931]


portfolio before change:  [-5.55953233]
curr_Stock_Price:  92.80796996130738
curr_Factors:  [9.28079700e+01 4.04623237e-02]
mat_Sqrt:  [[ 1.86685524e+01 -8.03816080e-03]
 [-8.03816080e-03  1.84393928e-02]]
grads:  [-0.01061128 -8.80209664]
Stock Position:  -0.010611278623538384
Bond Position:  [-4.5747211]


portfolio before change:  [-5.58213184]
curr_Stock_Price:  94.39849750965168
curr_Factors:  [9.43984975e+01 3.56148435e-02]
mat_Sqrt:  [[ 1.78147841e+01 -7.54143549e-03]
 [-7.54143549e-03  1.72995718e-02]]
grads:  [ 0.00135218 -1.02828436]
Stock Position:  0.0013521763074362256
Bond Position:  [-5.70977525]


portfolio before change:  [-5.58373596]
curr_Stock_Price:  98.49379104122492
curr_Factors:  [9.84937910e+01 3.16554071e-02]
mat_Sqrt:  [[ 1.75239808e+01 -7.11016977e-03]
 [-7.11016977e-03  1.63094928e-02]]
grads:  [0.00323677 1.96254491]
Stock Position:  0.0032367738237277645
Bond Position:  [-5.90253808]


portfolio before change:  [-5.59017747]
curr_Stock_Price:  98.78459761003656
curr_Factors:  [9.87845976e+01 3.22688720e-02]
mat_Sqrt:  [[ 1.77452079e+01 -7.17875447e-03]
 [-7.17875447e-03  1.64667606e-02]]
grads:  [ 0.0027719  -1.39018405]
Stock Position:  0.002771904084402664
Bond Position:  [-5.8639989]


portfolio before change:  [-5.60525431]
curr_Stock_Price:  95.9914776213371
curr_Factors:  [9.59914776e+01 3.68469589e-02]
mat_Sqrt:  [[ 1.84261017e+01 -7.67089993e-03]
 [-7.67089993e-03  1.75962179e-02]]
grads:  [ 5.61250775e-04 -6.37344171e+00]
Stock Position:  0.0005612507749714474
Bond Position:  [-5.6591296]


portfolio before change:  [-5.61475567]
curr_Stock_Price:  91.67429768032527
curr_Factors:  [9.16742977e+01 3.80077684e-02]
mat_Sqrt:  [[ 1.78724354e+01 -7.79044321e-03]
 [-7.79044321e-03  1.78713928e-02]]
grads:  [-2.27154350e-04 -1.07705831e+00]
Stock Position:  -0.00022715434962658097
Bond Position:  [-5.59393145]


portfolio before change:  [-5.62268286]
curr_Stock_Price:  95.770195756316
curr_Factors:  [9.57701958e+01 3.42643290e-02]
mat_Sqrt:  [[ 1.77276616e+01 -7.39717087e-03]
 [-7.39717087e-03  1.69683574e-02]]
grads:  [-0.00902003 -8.21597411]
Stock Position:  -0.00902002610739181
Bond Position:  [-4.75883319]


portfolio before change:  [-5.5896453]
curr_Stock_Price:  91.44761254313825
curr_Factors:  [9.14476125e+01 3.79584892e-02]
mat_Sqrt:  [[ 1.78166804e+01 -7.78537192e-03]
 [-7.78537192e-03  1.78598118e-02]]
grads:  [4.32268959e-03 9.26397188e+00]
Stock Position:  0.0043226895941278105
Bond Position:  [-5.98494495]


portfolio before change:  [-5.61706857]
curr_Stock_Price:  86.83534212982298
curr_Factors:  [8.68353421e+01 3.96926103e-02]
mat_Sqrt:  [[ 1.73002072e+01 -7.96079858e-03]
 [-7.96079858e-03  1.82634003e-02]]
grads:  [-3.36127922e-03  5.91667861e+00]
Stock Position:  -0.0033612792191854814
Bond Position:  [-5.32519074]


portfolio before change:  [-5.6408378]
curr_Stock_Price:  91.92524344709283
curr_Factors:  [9.19252434e+01 3.63159162e-02]
mat_Sqrt:  [[ 1.75179487e+01 -7.61510099e-03]
 [-7.61510099e-03  1.74690984e-02]]
grads:  [-0.0025161   0.71096403]
Stock Position:  -0.002516101367967528
Bond Position:  [-5.40954457]


portfolio before change:  [-5.6509415]
curr_Stock_Price:  93.2517157806521
curr_Factors:  [9.32517158e+01 3.41847301e-02]
mat_Sqrt:  [[ 1.72414136e+01 -7.38838294e-03]
 [-7.38838294e-03  1.69487197e-02]]
grads:  [-1.69014979e-03  3.61178619e+00]
Stock Position:  -0.001690149793216334
Bond Position:  [-5.49333213]


portfolio before change:  [-5.65456982]
curr_Stock_Price:  91.33316163762389
curr_Factors:  [9.13331616e+01 3.17219896e-02]
mat_Sqrt:  [[ 1.62670447e+01 -7.11712460e-03]
 [-7.11712460e-03  1.63268623e-02]]
grads:  [ 0.00509433 -4.78841303]
Stock Position:  0.0050943302537788645
Bond Position:  [-6.11985111]


portfolio before change:  [-5.66271116]
curr_Stock_Price:  91.23761526590042
curr_Factors:  [9.12376153e+01 3.23988889e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.66271116]
Stock Price:  93.11911537884012
PL:  [-5.66271116]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.19707390e-03 -5.77280387e-02]
 [-2.30173761e-01  9.27132730e-02]
 [ 4.16378800e-02  1.18554909e-01]
 [-3.13211518e-01 -1.68104862e-01]
 [ 4.38684983e-01  4.05628621e-02]
 [-1.60680733e-02 -3.03001570e-01]
 [-2.16324518e-02 -2.00546174e-02]
 [ 3.36673853e-02 -9.88272517e-03]
 [-4.49141490e-02 -4.02630101e-02]
 [ 3.77948497e-02  1.93211990e-01]
 [ 5.77678245e-02 -1.08131249e-01]
 [ 1.54998416e-02 -6.06993683e-02]
 [-1.19416014e-01 -1.39054557e-01]
 [ 4.77010763e-03  1.65258173e-01]
 [-9.29670329e-02  4.66674039e-03]
 [-8.82793048e-02  3.30558929e-02]
 [-9.11896248e-02  1.58797660e-01]
 [ 8.34210659e-02 -1.27794390e-01]
 [-7.93627909e-03  5.69505851e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.40417745]
curr_Stock_Price:  99.73113896548409
curr_Factors:  [9.97311390e+01 3.86689119e-02]
mat_Sqrt:  [[ 1.96115410e+01 -7.85854248e-03]
 [-7.85854248e-03  1.80258822e-02]]
grads:  [-1.22245174e-03 -3.20304132e+00]
Stock Position:  -0.0012224517370725049
Bond Position:  [5.52609396]


portfolio before change:  [5.42259203]
curr_Stock_Price:  90.32165183266879
curr_Factors:  [9.03216518e+01 4.53104208e-02]
mat_Sqrt:  [[ 1.92260858e+01 -8.50586589e-03]
 [-8.50586589e-03  1.95129304e-02]]
grads:  [-0.00987179  4.74707299]
Stock Position:  -0.009871785494538873
Bond Position:  [6.314228]


portfolio before change:  [5.41525164]
curr_Stock_Price:  91.8652538097607
curr_Factors:  [9.18652538e+01 4.59676808e-02]
mat_Sqrt:  [[ 1.96959773e+01 -8.56748156e-03]
 [-8.56748156e-03  1.96538817e-02]]
grads:  [4.73882561e-03 6.03420283e+00]
Stock Position:  0.004738825606269329
Bond Position:  [4.97991823]


portfolio before change:  [5.42397346]
curr_Stock_Price:  92.39133964166479
curr_Factors:  [9.23913396e+01 4.37206790e-02]
mat_Sqrt:  [[ 1.93185565e+01 -8.35550679e-03]
 [-8.35550679e-03  1.91674802e-02]]
grads:  [-0.02001003 -8.77903898]
Stock Position:  -0.020010027005757134
Bond Position:  [7.27272666]


portfolio before change:  [5.47566896]
curr_Stock_Price:  90.26246169576866
curr_Factors:  [9.02624617e+01 4.91677093e-02]
mat_Sqrt:  [[ 2.00146094e+01 -8.86051943e-03]
 [-8.86051943e-03  2.03265415e-02]]
grads:  [0.02280608 2.0055028 ]
Stock Position:  0.022806079804810694
Bond Position:  [3.41713606]


portfolio before change:  [5.43498425]
curr_Stock_Price:  88.29111028942508
curr_Factors:  [8.82911103e+01 5.17216802e-02]
mat_Sqrt:  [[ 2.00795163e+01 -9.08752606e-03]
 [-9.08752606e-03  2.08478697e-02]]
grads:  [-7.37940148e-03 -1.45371510e+01]
Stock Position:  -0.007379401480205702
Bond Position:  [6.0865198]


portfolio before change:  [5.38263666]
curr_Stock_Price:  96.41649902837312
curr_Factors:  [9.64164990e+01 4.89150282e-02]
mat_Sqrt:  [[ 2.13241866e+01 -8.83829459e-03]
 [-8.83829459e-03  2.02739939e-02]]
grads:  [-0.0014247 -0.9898005]
Stock Position:  -0.0014247014768817398
Bond Position:  [5.52000138]


portfolio before change:  [5.39122179]
curr_Stock_Price:  95.23673186486478
curr_Factors:  [9.52367319e+01 5.17700821e-02]
mat_Sqrt:  [[ 2.16692496e+01 -9.09246495e-03]
 [-9.09246495e-03  2.08573225e-02]]
grads:  [ 0.00135512 -0.47323446]
Stock Position:  0.0013551238758301401
Bond Position:  [5.26216422]


portfolio before change:  [5.39554417]
curr_Stock_Price:  93.56940751504783
curr_Factors:  [9.35694075e+01 5.47325516e-02]
mat_Sqrt:  [[ 2.18905507e+01 -9.34883758e-03]
 [-9.34883758e-03  2.14458563e-02]]
grads:  [-0.00285409 -1.87867026]
Stock Position:  -0.0028540868144770674
Bond Position:  [5.66259939]


portfolio before change:  [5.40303056]
curr_Stock_Price:  93.42795816364409
curr_Factors:  [9.34279582e+01 5.20165946e-02]
mat_Sqrt:  [[ 2.13082496e+01 -9.11391727e-03]
 [-9.11391727e-03  2.09069954e-02]]
grads:  [5.72754075e-03 9.24399639e+00]
Stock Position:  0.005727540745362849
Bond Position:  [4.86791812]


portfolio before change:  [5.40003533]
curr_Stock_Price:  91.84194920817053
curr_Factors:  [9.18419492e+01 5.50354902e-02]
mat_Sqrt:  [[ 2.15457924e+01 -9.37450169e-03]
 [-9.37450169e-03  2.15051998e-02]]
grads:  [ 4.93529933e-04 -5.02792922e+00]
Stock Position:  0.0004935299332156928
Bond Position:  [5.35470858]


portfolio before change:  [5.40500008]
curr_Stock_Price:  88.33087219600223
curr_Factors:  [8.83308722e+01 5.88754726e-02]
mat_Sqrt:  [[ 2.14328378e+01 -9.69564627e-03]
 [-9.69564627e-03  2.22429578e-02]]
grads:  [-5.11412137e-04 -2.72914814e+00]
Stock Position:  -0.0005114121373920006
Bond Position:  [5.45017356]


portfolio before change:  [5.40956919]
curr_Stock_Price:  92.72627647167029
curr_Factors:  [9.27262765e+01 5.89837773e-02]
mat_Sqrt:  [[ 2.25200355e+01 -9.70503695e-03]
 [-9.70503695e-03  2.22631990e-02]]
grads:  [-0.00799585 -6.2494234 ]
Stock Position:  -0.007995853221042478
Bond Position:  [6.15099489]


portfolio before change:  [5.40739382]
curr_Stock_Price:  93.96053126779816
curr_Factors:  [9.39605313e+01 6.52419939e-02]
mat_Sqrt:  [[ 2.39998782e+01 -1.02070478e-02]
 [-1.02070478e-02  2.34144424e-02]]
grads:  [3.20106939e-03 7.05935439e+00]
Stock Position:  0.0032010693921048854
Bond Position:  [5.10661964]


portfolio before change:  [5.40721004]
curr_Stock_Price:  91.90776365946193
curr_Factors:  [9.19077637e+01 6.76892931e-02]
mat_Sqrt:  [[ 2.39117933e+01 -1.03964979e-02]
 [-1.03964979e-02  2.38496491e-02]]
grads:  [-0.00380356  0.19401529]
Stock Position:  -0.003803560542534911
Bond Position:  [5.75678678]


portfolio before change:  [5.42418671]
curr_Stock_Price:  89.3374896648839
curr_Factors:  [8.93374897e+01 6.01954999e-02]
mat_Sqrt:  [[ 2.19187465e+01 -9.80384972e-03]
 [-9.80384972e-03  2.24908766e-02]]
grads:  [-0.00337084  1.4682774 ]
Stock Position:  -0.0033708375506601744
Bond Position:  [5.72532888]


portfolio before change:  [5.4411901]
curr_Stock_Price:  86.41766734739714
curr_Factors:  [8.64176673e+01 6.08822204e-02]
mat_Sqrt:  [[ 2.13229719e+01 -9.85927166e-03]
 [-9.85927166e-03  2.26189515e-02]]
grads:  [-1.03064742e-03  7.02010870e+00]
Stock Position:  -0.001030647423635343
Bond Position:  [5.53025624]


portfolio before change:  [5.44827602]
curr_Stock_Price:  86.25390004750443
curr_Factors:  [8.62539000e+01 6.23130169e-02]
mat_Sqrt:  [[ 2.15311925e+01 -9.97443046e-03]
 [-9.97443046e-03  2.28832014e-02]]
grads:  [ 1.28757769e-03 -5.58407651e+00]
Stock Position:  0.0012875776914023592
Bond Position:  [5.33721743]


portfolio before change:  [5.44904755]
curr_Stock_Price:  81.66841395662638
curr_Factors:  [8.16684140e+01 6.05814968e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.44904755]
Stock Price:  81.12792034105895
PL:  [5.44904755]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-4.75182643e-02 -7.59365739e-02]
 [-1.86945156e-01 -1.98880689e-01]
 [-3.16138329e-01 -1.63984427e-01]
 [-2.33529727e-02 -2.70584136e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.39036918e-01  5.69673301e-02]
 [ 5.44239664e-02  8.09876574e-02]
 [-3.13227967e-02  3.49304331e-03]
 [ 4.56550318e-02  3.80533144e-02]
 [ 7.92535243e-02 -6.21926642e-02]
 [ 1.01830296e-01 -1.16153978e-01]
 [ 5.03209040e-01 -3.52850335e-02]
 [ 3.60172942e-02  2.17130851e-01]
 [-7.57797435e-02 -9.48010007e-02]
 [ 4.07598417e-02 -1.33117488e-01]
 [ 2.22619011e-01 -1.68363293e-01]
 [ 1.61841470e-01 -1.49884555e-01]
 [-1.74396111e-01  5.15989313e-02]
 [-1.27040643e-01 -1.57535056e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.06363797]
curr_Stock_Price:  101.243832811058
curr_Factors:  [1.01243833e+02 3.78732334e-02]
mat_Sqrt:  [[ 1.97031079e+01 -7.77737751e-03]
 [-7.77737751e-03  1.78394151e-02]]
grads:  [-4.09264883e-03 -4.25845822e+00]
Stock Position:  -0.004092648825378233
Bond Position:  [11.47799343]


portfolio before change:  [11.04807521]
curr_Stock_Price:  108.55431184944668
curr_Factors:  [1.08554312e+02 3.59139098e-02]
mat_Sqrt:  [[ 2.05720889e+01 -7.57399108e-03]
 [-7.57399108e-03  1.73716366e-02]]
grads:  [ -0.01330446 -11.45438749]
Stock Position:  -0.013304462449156841
Bond Position:  [12.49233198]


portfolio before change:  [11.06884784]
curr_Stock_Price:  108.16741532452001
curr_Factors:  [1.08167415e+02 3.74023432e-02]
mat_Sqrt:  [[ 2.09192364e+01 -7.72932449e-03]
 [-7.72932449e-03  1.77279715e-02]]
grads:  [-0.01853305 -9.25811928]
Stock Position:  -0.018533053956188907
Bond Position:  [13.07352038]


portfolio before change:  [11.0357071]
curr_Stock_Price:  110.83793344923835
curr_Factors:  [1.10837933e+02 3.21794034e-02]
mat_Sqrt:  [[ 1.98827928e+01 -7.16951849e-03]
 [-7.16951849e-03  1.64436018e-02]]
grads:  [-0.00176817 -1.64629933]
Stock Position:  -0.0017681694246092792
Bond Position:  [11.23168735]


portfolio before change:  [11.04531897]
curr_Stock_Price:  113.34703477522127
curr_Factors:  [1.13347035e+02 2.94557660e-02]
mat_Sqrt:  [[ 1.94533902e+01 -6.85952590e-03]
 [-6.85952590e-03  1.57322778e-02]]
grads:  [ 0.00842899 -7.50381492]
Stock Position:  0.008428986798710049
Bond Position:  [10.08991831]


portfolio before change:  [11.07012223]
curr_Stock_Price:  114.79240067284012
curr_Factors:  [1.14792401e+02 2.66026904e-02]
mat_Sqrt:  [[ 1.87230196e+01 -6.51892730e-03]
 [-6.51892730e-03  1.49509361e-02]]
grads:  [0.00875397 3.81410209]
Stock Position:  0.008753971107836551
Bond Position:  [10.06523287]


portfolio before change:  [11.11837526]
curr_Stock_Price:  118.86639491063315
curr_Factors:  [1.18866395e+02 2.28670377e-02]
mat_Sqrt:  [[ 1.79747981e+01 -6.04407978e-03]
 [-6.04407978e-03  1.38614385e-02]]
grads:  [4.99313660e-03 5.84483613e+00]
Stock Position:  0.0049931366034410025
Bond Position:  [10.52485912]


portfolio before change:  [11.11321353]
curr_Stock_Price:  115.19614960066205
curr_Factors:  [1.15196150e+02 2.39156142e-02]
mat_Sqrt:  [[ 1.78147079e+01 -6.18095158e-03]
 [-6.18095158e-03  1.41757532e-02]]
grads:  [-0.00167301  0.24568024]
Stock Position:  -0.001673014184635609
Bond Position:  [11.30593832]


portfolio before change:  [11.11706469]
curr_Stock_Price:  121.34678364984882
curr_Factors:  [1.21346784e+02 2.31400318e-02]
mat_Sqrt:  [[ 1.84590872e+01 -6.08014660e-03]
 [-6.08014660e-03  1.39438924e-02]]
grads:  [0.0033727  2.73050163]
Stock Position:  0.003372695587393439
Bond Position:  [10.70779893]


portfolio before change:  [11.13017983]
curr_Stock_Price:  121.26436337461715
curr_Factors:  [1.21264363e+02 2.26133914e-02]
mat_Sqrt:  [[ 1.82354304e+01 -6.01055675e-03]
 [-6.01055675e-03  1.37843071e-02]]
grads:  [ 2.8593959e-03 -4.5105987e+00]
Stock Position:  0.0028593958976545065
Bond Position:  [10.783437]


portfolio before change:  [11.14466864]
curr_Stock_Price:  121.61446995564508
curr_Factors:  [1.21614470e+02 2.35514745e-02]
mat_Sqrt:  [[ 1.86635511e+01 -6.13397283e-03]
 [-6.13397283e-03  1.40673069e-02]]
grads:  [ 2.74274281e-03 -8.25582001e+00]
Stock Position:  0.0027427428072624026
Bond Position:  [10.81111143]


portfolio before change:  [11.16708771]
curr_Stock_Price:  124.85820467203973
curr_Factors:  [1.24858205e+02 2.54125175e-02]
mat_Sqrt:  [[ 1.99040250e+01 -6.37184408e-03]
 [-6.37184408e-03  1.46124871e-02]]
grads:  [ 0.02451217 -2.40402921]
Stock Position:  0.024512174769870734
Bond Position:  [8.10654158]


portfolio before change:  [11.16926469]
curr_Stock_Price:  124.53336443035174
curr_Factors:  [1.24533364e+02 2.75495980e-02]
mat_Sqrt:  [[ 2.06701359e+01 -6.63434568e-03]
 [-6.63434568e-03  1.52145140e-02]]
grads:  [6.32392104e-03 1.42740547e+01]
Stock Position:  0.006323921036476863
Bond Position:  [10.38172552]


portfolio before change:  [11.19255047]
curr_Stock_Price:  126.16218150055413
curr_Factors:  [1.26162182e+02 3.31685831e-02]
mat_Sqrt:  [[ 2.29769631e+01 -7.27960889e-03]
 [-7.27960889e-03  1.66941045e-02]]
grads:  [-5.09792016e-03 -5.68093435e+00]
Stock Position:  -0.00509792016210308
Bond Position:  [11.8357152]


portfolio before change:  [11.22723878]
curr_Stock_Price:  122.26168453966584
curr_Factors:  [1.22261685e+02 3.53190965e-02]
mat_Sqrt:  [[ 2.29770963e+01 -7.51171878e-03]
 [-7.51171878e-03  1.72268699e-02]]
grads:  [-7.52403876e-04 -7.72764526e+00]
Stock Position:  -0.0007524038761816523
Bond Position:  [11.31922895]


portfolio before change:  [11.24258913]
curr_Stock_Price:  120.67680861544616
curr_Factors:  [1.20676809e+02 3.49253364e-02]
mat_Sqrt:  [[ 2.25524689e+01 -7.46965518e-03]
 [-7.46965518e-03  1.71306047e-02]]
grads:  [ 6.61688858e-03 -9.82533137e+00]
Stock Position:  0.006616888579784123
Bond Position:  [10.44408414]


portfolio before change:  [11.2782708]
curr_Stock_Price:  124.09509097538218
curr_Factors:  [1.24095091e+02 3.52443881e-02]
mat_Sqrt:  [[ 2.32969768e+01 -7.50385309e-03]
 [-7.50385309e-03  1.72086045e-02]]
grads:  [ 4.14206127e-03 -8.70805494e+00]
Stock Position:  0.004142061269175425
Bond Position:  [10.76426133]


portfolio before change:  [11.31643608]
curr_Stock_Price:  130.05867842075105
curr_Factors:  [1.30058678e+02 3.40322052e-02]
mat_Sqrt:  [[ 2.39929894e+01 -7.37393118e-03]
 [-7.37393118e-03  1.69099731e-02]]
grads:  [-0.00633167  3.04862944]
Stock Position:  -0.006331671507727089
Bond Position:  [12.13992491]


portfolio before change:  [11.34784727]
curr_Stock_Price:  127.49588083225632
curr_Factors:  [1.27495881e+02 3.57344591e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.34784727]
Stock Price:  125.43694486897942
PL:  [-14.0890976]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 4.92694602e-02 -3.92678692e-02]
 [-2.15778986e-02  6.23317198e-02]
 [ 6.26918831e-02  5.59768527e-02]
 [-1.43099814e-01 -7.62735082e-02]
 [ 2.72739627e-01  2.82460428e-02]
 [-1.35687306e-02 -2.95501297e-01]
 [-3.62057118e-01 -3.82767832e-01]
 [ 3.28979750e-02 -1.32221999e-02]
 [-1.21641235e-01 -9.78165049e-02]
 [ 5.71087584e-02  2.94572913e-01]
 [ 5.56789364e-02 -1.02392694e-01]
 [ 1.35240824e-02 -5.31836818e-02]
 [-1.33023304e-01 -1.32808589e-01]
 [ 2.60360506e-03  1.62409144e-01]
 [-8.87254997e-02 -8.97976620e-03]
 [-4.82159158e-02  1.17613272e-02]
 [-3.12448356e-02  6.75278992e-03]
 [ 5.24302533e-02  4.28541982e-02]
 [ 1.33486057e-02 -4.15225102e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.30769334]
curr_Stock_Price:  99.17077838054432
curr_Factors:  [9.91707784e+01 4.28035606e-02]
mat_Sqrt:  [[ 2.05174619e+01 -8.26796681e-03]
 [-8.26796681e-03  1.89651346e-02]]
grads:  [ 1.56725237e-03 -2.06984617e+00]
Stock Position:  0.0015672523698878511
Bond Position:  [3.15226771]


portfolio before change:  [3.30674024]
curr_Stock_Price:  96.04689969709327
curr_Factors:  [9.60468997e+01 4.72285208e-02]
mat_Sqrt:  [[ 2.08730294e+01 -8.68456167e-03]
 [-8.68456167e-03  1.99214356e-02]]
grads:  [2.68099121e-04 3.12899378e+00]
Stock Position:  0.00026809912135633925
Bond Position:  [3.28099015]


portfolio before change:  [3.31133072]
curr_Stock_Price:  97.86219534163305
curr_Factors:  [9.78621953e+01 4.43441023e-02]
mat_Sqrt:  [[ 2.06078579e+01 -8.41533379e-03]
 [-8.41533379e-03  1.93034500e-02]]
grads:  [0.00422705 2.90167949]
Stock Position:  0.004227051877352641
Bond Position:  [2.89766214]


portfolio before change:  [3.2994012]
curr_Stock_Price:  94.18259664605424
curr_Factors:  [9.41825966e+01 4.28897618e-02]
mat_Sqrt:  [[ 1.95050666e+01 -8.27588318e-03]
 [-8.27588318e-03  1.89843982e-02]]
grads:  [-0.0090429  -4.02163636]
Stock Position:  -0.009042902027271671
Bond Position:  [4.1510852]


portfolio before change:  [3.32493284]
curr_Stock_Price:  91.93336976416326
curr_Factors:  [9.19333698e+01 4.15063252e-02]
mat_Sqrt:  [[ 1.87296767e+01 -8.14112355e-03]
 [-8.14112355e-03  1.86757961e-02]]
grads:  [0.01522219 1.51907679]
Stock Position:  0.015222185817041961
Bond Position:  [1.92550601]


portfolio before change:  [3.2748364]
curr_Stock_Price:  88.48413901262452
curr_Factors:  [8.84841390e+01 4.49095718e-02]
mat_Sqrt:  [[ 1.87514494e+01 -8.46797948e-03]
 [-8.46797948e-03  1.94265036e-02]]
grads:  [-7.59436064e-03 -1.52145549e+01]
Stock Position:  -0.0075943606372031545
Bond Position:  [3.94681686]


portfolio before change:  [3.29231458]
curr_Stock_Price:  86.8327069037394
curr_Factors:  [8.68327069e+01 4.50424093e-02]
mat_Sqrt:  [[ 1.84286745e+01 -8.48032697e-03]
 [-8.48032697e-03  1.94552858e-02]]
grads:  [ -0.02870565 -19.68674571]
Stock Position:  -0.028705654181946254
Bond Position:  [5.78490423]


portfolio before change:  [3.24364553]
curr_Stock_Price:  88.78022197313133
curr_Factors:  [8.87802220e+01 4.58220051e-02]
mat_Sqrt:  [[ 1.90043591e+01 -8.55359894e-03]
 [-8.55359894e-03  1.96228437e-02]]
grads:  [ 0.00142808 -0.6731942 ]
Stock Position:  0.001428079824870058
Bond Position:  [3.11686029]


portfolio before change:  [3.24841286]
curr_Stock_Price:  89.38860108562253
curr_Factors:  [8.93886011e+01 4.64853089e-02]
mat_Sqrt:  [[ 1.92725845e+01 -8.61534648e-03]
 [-8.61534648e-03  1.97643339e-02]]
grads:  [-0.00852568 -4.95285888]
Stock Position:  -0.008525676999525597
Bond Position:  [4.0105112]


portfolio before change:  [3.25159799]
curr_Stock_Price:  89.6033807595332
curr_Factors:  [8.96033808e+01 4.68640529e-02]
mat_Sqrt:  [[ 1.93974337e+01 -8.65039374e-03]
 [-8.65039374e-03  1.98446773e-02]]
grads:  [9.56573084e-03 1.48480953e+01]
Stock Position:  0.009565730840092908
Bond Position:  [2.39447617]


portfolio before change:  [3.24847268]
curr_Stock_Price:  88.96356844235393
curr_Factors:  [8.89635684e+01 4.38421593e-02]
mat_Sqrt:  [[ 1.86276521e+01 -8.36678732e-03]
 [-8.36678732e-03  1.91942299e-02]]
grads:  [ 5.93096972e-04 -5.33429746e+00]
Stock Position:  0.0005930969721520383
Bond Position:  [3.19570866]


portfolio before change:  [3.25243991]
curr_Stock_Price:  88.9131469355299
curr_Factors:  [8.89131469e+01 4.31504065e-02]
mat_Sqrt:  [[ 1.84696380e+01 -8.30051338e-03]
 [-8.30051338e-03  1.90422043e-02]]
grads:  [-5.23054280e-04 -2.79316526e+00]
Stock Position:  -0.0005230542795407687
Bond Position:  [3.29894632]


portfolio before change:  [3.25557464]
curr_Stock_Price:  90.80880505464998
curr_Factors:  [9.08088051e+01 4.23884354e-02]
mat_Sqrt:  [[ 1.86961254e+01 -8.22707656e-03]
 [-8.22707656e-03  1.88732500e-02]]
grads:  [-0.0102135  -7.04132127]
Stock Position:  -0.010213495546342237
Bond Position:  [4.18304997]


portfolio before change:  [3.26805779]
curr_Stock_Price:  90.09885586329526
curr_Factors:  [9.00988559e+01 4.17868568e-02]
mat_Sqrt:  [[ 1.84178565e+01 -8.16842351e-03]
 [-8.16842351e-03  1.87388747e-02]]
grads:  [3.98598104e-03 8.66870109e+00]
Stock Position:  0.00398598103752323
Bond Position:  [2.90892546]


portfolio before change:  [3.28296628]
curr_Stock_Price:  92.92628104715767
curr_Factors:  [9.29262810e+01 4.21267479e-02]
mat_Sqrt:  [[ 1.90729330e+01 -8.20183055e-03]
 [-8.20183055e-03  1.88148201e-02]]
grads:  [-0.00485806 -0.47938865]
Stock Position:  -0.004858055339324278
Bond Position:  [3.7344073]


portfolio before change:  [3.29213326]
curr_Stock_Price:  92.00079805437525
curr_Factors:  [9.20007981e+01 4.26951472e-02]
mat_Sqrt:  [[ 1.90099429e+01 -8.25689530e-03]
 [-8.25689530e-03  1.89413609e-02]]
grads:  [-0.00226708  0.61994532]
Stock Position:  -0.002267081628249591
Bond Position:  [3.50070658]


portfolio before change:  [3.28776531]
curr_Stock_Price:  95.85887051193342
curr_Factors:  [9.58588705e+01 4.02491612e-02]
mat_Sqrt:  [[ 1.92313905e+01 -8.01721141e-03]
 [-8.01721141e-03  1.83906480e-02]]
grads:  [-0.00147187  0.36654443]
Stock Position:  -0.001471873361900697
Bond Position:  [3.42885743]


portfolio before change:  [3.28693348]
curr_Stock_Price:  99.3378264583179
curr_Factors:  [9.93378265e+01 4.73890438e-02]
mat_Sqrt:  [[ 2.16248743e+01 -8.69958274e-03]
 [-8.69958274e-03  1.99551421e-02]]
grads:  [0.00328905 2.14896047]
Stock Position:  0.0032890509243650294
Bond Position:  [2.96020631]


portfolio before change:  [3.28750686]
curr_Stock_Price:  98.38642949013354
curr_Factors:  [9.83864295e+01 4.47436782e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.28750686]
Stock Price:  98.68491122742051
PL:  [3.28750686]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 6.78472663e-02 -3.27990546e-02]
 [-1.70850121e-02  6.16671462e-02]
 [ 4.05435404e-02  1.00276503e-01]
 [-6.15671638e-01 -3.13313307e-01]
 [ 6.13350803e-01  6.56239736e-02]
 [-2.33034037e-02 -3.30748099e-01]
 [-5.02793327e-01 -4.81669504e-01]
 [ 3.38474901e-02 -9.10101529e-03]
 [-1.93189701e-01 -1.51418697e-01]
 [ 9.99187529e-02  4.78179913e-01]
 [ 2.57549035e-02 -8.90391338e-02]
 [ 4.24460799e-02 -1.63201475e-01]
 [-2.06903774e-01 -9.88962537e-02]
 [ 4.59889065e-03  1.42581336e-01]
 [-9.89059546e-02  2.25504379e-01]
 [-1.87668500e-01  8.58834200e-02]
 [-9.40437372e-02  1.67782535e-01]
 [ 3.82709587e-02 -1.50696985e-01]
 [ 1.12268348e-03  5.70484585e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.64539575]
curr_Stock_Price:  98.99375558974427
curr_Factors:  [9.89937556e+01 4.53785746e-02]
mat_Sqrt:  [[ 2.10878930e+01 -8.51301666e-03]
 [-8.51301666e-03  1.95272705e-02]]
grads:  [ 0.00253974 -1.67854661]
Stock Position:  0.0025397402637291275
Bond Position:  [2.39397732]


portfolio before change:  [2.64121801]
curr_Stock_Price:  96.16981111838376
curr_Factors:  [9.61698111e+01 4.66455817e-02]
mat_Sqrt:  [[ 2.07703580e+01 -8.63080923e-03]
 [-8.63080923e-03  1.97981047e-02]]
grads:  [4.71826821e-04 3.11500618e+00]
Stock Position:  0.0004718268213370117
Bond Position:  [2.59584251]


portfolio before change:  [2.64127359]
curr_Stock_Price:  89.40621029361817
curr_Factors:  [8.94062103e+01 4.80887096e-02]
mat_Sqrt:  [[ 1.96060093e+01 -8.76267162e-03]
 [-8.76267162e-03  2.01023054e-02]]
grads:  [4.29821628e-03 4.99018221e+00]
Stock Position:  0.00429821627509721
Bond Position:  [2.25698636]


portfolio before change:  [2.64150966]
curr_Stock_Price:  88.80434988374502
curr_Factors:  [8.88043499e+01 4.53896868e-02]
mat_Sqrt:  [[ 1.89196365e+01 -8.51315524e-03]
 [-8.51315524e-03  1.95300552e-02]]
grads:  [ -0.03976781 -16.0599575 ]
Stock Position:  -0.03976781212182546
Bond Position:  [6.17306436]


portfolio before change:  [2.73005253]
curr_Stock_Price:  86.7720098509058
curr_Factors:  [8.67720099e+01 5.02232591e-02]
mat_Sqrt:  [[ 1.94460795e+01 -8.95475930e-03]
 [-8.95475930e-03  2.05437308e-02]]
grads:  [0.03301871 3.20874766]
Stock Position:  0.03301870519135362
Bond Position:  [-0.13504688]


portfolio before change:  [2.76066232]
curr_Stock_Price:  87.704169372668
curr_Factors:  [8.77041694e+01 5.03685110e-02]
mat_Sqrt:  [[ 1.96833834e+01 -8.96779968e-03]
 [-8.96779968e-03  2.05733731e-02]]
grads:  [-8.51010288e-03 -1.60802225e+01]
Stock Position:  -0.00851010288498104
Bond Position:  [3.50703382]


portfolio before change:  [2.79898741]
curr_Stock_Price:  83.71613726040708
curr_Factors:  [8.37161373e+01 5.35762984e-02]
mat_Sqrt:  [[ 1.93773991e+01 -9.24849558e-03]
 [-9.24849558e-03  2.12185842e-02]]
grads:  [ -0.03678955 -22.71639562]
Stock Position:  -0.03678955094452751
Bond Position:  [5.87886651]


portfolio before change:  [2.76460716]
curr_Stock_Price:  84.85051990253231
curr_Factors:  [8.48505199e+01 5.17068797e-02]
mat_Sqrt:  [[ 1.92942821e+01 -9.08584361e-03]
 [-9.08584361e-03  2.08450532e-02]]
grads:  [ 0.00154899 -0.43592795]
Stock Position:  0.0015489934621927273
Bond Position:  [2.63317426]


portfolio before change:  [2.76905045]
curr_Stock_Price:  85.59277896952898
curr_Factors:  [8.5592779e+01 4.9848786e-02]
mat_Sqrt:  [[ 1.91101622e+01 -8.92118303e-03]
 [-8.92118303e-03  2.04670553e-02]]
grads:  [-0.01356571 -7.40408022]
Stock Position:  -0.013565706749836214
Bond Position:  [3.93017698]


portfolio before change:  [2.82351607]
curr_Stock_Price:  81.94019891323678
curr_Factors:  [8.19401989e+01 5.79710095e-02]
mat_Sqrt:  [[ 1.97288783e+01 -9.62010643e-03]
 [-9.62010643e-03  2.20717840e-02]]
grads:  [1.56319885e-02 2.16715738e+01]
Stock Position:  0.015631988533832072
Bond Position:  [1.54262782]


portfolio before change:  [2.86396865]
curr_Stock_Price:  84.40457461303325
curr_Factors:  [8.44045746e+01 5.71161326e-02]
mat_Sqrt:  [[ 2.01718316e+01 -9.54922249e-03]
 [-9.54922249e-03  2.19083015e-02]]
grads:  [-6.47312849e-04 -4.06445543e+00]
Stock Position:  -0.0006473128486717741
Bond Position:  [2.91860482]


portfolio before change:  [2.87042842]
curr_Stock_Price:  80.06474209399737
curr_Factors:  [8.00647421e+01 5.48148718e-02]
mat_Sqrt:  [[ 1.87452163e+01 -9.35432120e-03]
 [-9.35432120e-03  2.14626511e-02]]
grads:  [-1.53053396e-03 -7.60464265e+00]
Stock Position:  -0.0015305339571884341
Bond Position:  [2.99297022]


portfolio before change:  [2.87343202]
curr_Stock_Price:  80.54820057837055
curr_Factors:  [8.05482006e+01 5.86415283e-02]
mat_Sqrt:  [[ 1.95055603e+01 -9.67539487e-03]
 [-9.67539487e-03  2.21991445e-02]]
grads:  [-0.01282    -4.46054542]
Stock Position:  -0.012820001521523721
Bond Position:  [3.90606007]


portfolio before change:  [2.89494729]
curr_Stock_Price:  79.25103684172274
curr_Factors:  [7.92510368e+01 5.57225217e-02]
mat_Sqrt:  [[ 1.87076949e+01 -9.43133907e-03]
 [-9.43133907e-03  2.16396641e-02]]
grads:  [3.56834988e-03 6.59044381e+00]
Stock Position:  0.00356834987865356
Bond Position:  [2.61215186]


portfolio before change:  [2.90272469]
curr_Stock_Price:  80.51497460114929
curr_Factors:  [8.05149746e+01 5.38066708e-02]
mat_Sqrt:  [[ 1.86764645e+01 -9.26795497e-03]
 [-9.26795497e-03  2.12643297e-02]]
grads:  [-3.32557031e-05  1.06048050e+01]
Stock Position:  -3.3255703089172195e-05
Bond Position:  [2.90540227]


portfolio before change:  [2.90628262]
curr_Stock_Price:  82.80306077648595
curr_Factors:  [8.28030608e+01 4.88535897e-02]
mat_Sqrt:  [[ 1.83018327e+01 -8.83136314e-03]
 [-8.83136314e-03  2.02618588e-02]]
grads:  [-0.00821048  4.23509566]
Stock Position:  -0.008210480086589273
Bond Position:  [3.58613551]


portfolio before change:  [2.88620619]
curr_Stock_Price:  85.79459219877832
curr_Factors:  [8.57945922e+01 4.66189216e-02]
mat_Sqrt:  [[ 1.85242647e+01 -8.62734888e-03]
 [-8.62734888e-03  1.97928792e-02]]
grads:  [-1.12904283e-03  8.47642190e+00]
Stock Position:  -0.0011290428266392662
Bond Position:  [2.98307196]


portfolio before change:  [2.89392745]
curr_Stock_Price:  82.26054104842386
curr_Factors:  [8.22605410e+01 4.14612146e-02]
mat_Sqrt:  [[ 1.67499117e+01 -8.13574533e-03]
 [-8.13574533e-03  1.86660599e-02]]
grads:  [-1.63686130e-03 -8.07402863e+00]
Stock Position:  -0.0016368612967955954
Bond Position:  [3.02857655]


portfolio before change:  [2.89760249]
curr_Stock_Price:  82.32960499588131
curr_Factors:  [8.23296050e+01 4.11842512e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.89760249]
Stock Price:  80.94546935765965
PL:  [2.89760249]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.40506289e-01 -7.32041781e-03]
 [ 3.30902773e-03  4.96359037e-02]
 [ 5.38886393e-02  8.21422596e-02]
 [-1.95708398e-01 -1.05667649e-01]
 [-1.79599588e-01  1.96195473e-03]
 [ 7.79449227e-02  1.22372695e-02]
 [ 2.80836595e-02  4.69422719e-02]
 [ 3.44236686e-02 -6.60022517e-03]
 [ 3.41850495e-02  2.42113599e-02]
 [ 6.15723084e-02 -3.99119957e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [-8.74315230e-03  4.31611148e-02]
 [ 1.83957888e-02 -2.13986567e-02]
 [ 1.28003204e-02 -3.63949745e-02]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.45797580e-01 -7.40019739e-02]
 [ 9.94866807e-02 -1.49632616e-01]
 [-6.59696553e-02  4.05036891e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.06253242]
curr_Stock_Price:  98.3033927104965
curr_Factors:  [9.83033927e+01 4.02362779e-02]
mat_Sqrt:  [[ 1.97186587e+01 -8.01611864e-03]
 [-8.01611864e-03  1.83876214e-02]]
grads:  [ 0.00696494 -0.39508025]
Stock Position:  0.006964940193282134
Bond Position:  [-0.62214483]


portfolio before change:  [0.05141785]
curr_Stock_Price:  96.81933028564293
curr_Factors:  [9.68193303e+01 4.30155684e-02]
mat_Sqrt:  [[ 2.00805161e+01 -8.28823141e-03]
 [-8.28823141e-03  1.90121252e-02]]
grads:  [1.24259838e-03 2.61129159e+00]
Stock Position:  0.0012425983777272654
Bond Position:  [-0.0688897]


portfolio before change:  [0.04951174]
curr_Stock_Price:  95.35470684262343
curr_Factors:  [9.53547068e+01 4.68963281e-02]
mat_Sqrt:  [[ 2.06495940e+01 -8.65390544e-03]
 [-8.65390544e-03  1.98512771e-02]]
grads:  [0.00434458 4.13977684]
Stock Position:  0.004344583081508413
Bond Position:  [-0.3647647]


portfolio before change:  [0.04157788]
curr_Stock_Price:  93.6335697279548
curr_Factors:  [9.36335697e+01 4.15592890e-02]
mat_Sqrt:  [[ 1.90882272e+01 -8.14646344e-03]
 [-8.14646344e-03  1.86876436e-02]]
grads:  [-0.01266838 -5.65993516]
Stock Position:  -0.012668376700152152
Bond Position:  [1.22776321]


portfolio before change:  [0.01613371]
curr_Stock_Price:  95.76326874872476
curr_Factors:  [9.57632687e+01 4.08026169e-02]
mat_Sqrt:  [[ 1.93438507e+01 -8.07213680e-03]
 [-8.07213680e-03  1.85166621e-02]]
grads:  [-0.00924205  0.10192721]
Stock Position:  -0.009242049069111283
Bond Position:  [0.90118254]


portfolio before change:  [0.01912192]
curr_Stock_Price:  95.56190429674827
curr_Factors:  [9.55619043e+01 3.98622811e-02]
mat_Sqrt:  [[ 1.90794491e+01 -7.97856346e-03]
 [-7.97856346e-03  1.83020583e-02]]
grads:  [0.00436568 0.67053121]
Stock Position:  0.004365681522518782
Bond Position:  [-0.39807092]


portfolio before change:  [0.03346234]
curr_Stock_Price:  98.96076092380983
curr_Factors:  [9.89607609e+01 4.15679012e-02]
mat_Sqrt:  [[ 2.01763238e+01 -8.14773645e-03]
 [-8.14773645e-03  1.86893928e-02]]
grads:  [2.40662929e-03 2.51275582e+00]
Stock Position:  0.0024066292858996186
Bond Position:  [-0.20469952]


portfolio before change:  [0.02509889]
curr_Stock_Price:  95.59197797421577
curr_Factors:  [9.55919780e+01 4.86457144e-02]
mat_Sqrt:  [[ 2.10835483e+01 -8.81385809e-03]
 [-8.81385809e-03  2.02181366e-02]]
grads:  [ 0.00149653 -0.32579832]
Stock Position:  0.0014965283836322807
Bond Position:  [-0.11795721]


portfolio before change:  [0.02848976]
curr_Stock_Price:  97.95638922158935
curr_Factors:  [9.79563892e+01 4.80529569e-02]
mat_Sqrt:  [[ 2.14730033e+01 -8.76019678e-03]
 [-8.76019678e-03  2.00944898e-02]]
grads:  [0.00208392 1.20578405]
Stock Position:  0.0020839169320627862
Bond Position:  [-0.17564321]


portfolio before change:  [0.04530174]
curr_Stock_Price:  106.12930114689469
curr_Factors:  [1.06129301e+02 4.69195866e-02]
mat_Sqrt:  [[ 2.29885914e+01 -8.65689522e-03]
 [-8.65689522e-03  1.98558312e-02]]
grads:  [ 1.92175447e-03 -2.00925154e+00]
Stock Position:  0.001921754468105059
Bond Position:  [-0.15865272]


portfolio before change:  [0.04385742]
curr_Stock_Price:  105.48099431602478
curr_Factors:  [1.05480994e+02 5.38128342e-02]
mat_Sqrt:  [[ 2.44690505e+01 -9.27098124e-03]
 [-9.27098124e-03  2.12644598e-02]]
grads:  [ 3.92426037e-04 -5.75365037e+00]
Stock Position:  0.00039242603686332877
Bond Position:  [0.00246393]


portfolio before change:  [0.04315121]
curr_Stock_Price:  103.6735545911544
curr_Factors:  [1.03673555e+02 5.11905980e-02]
mat_Sqrt:  [[ 2.34564918e+01 -9.04214145e-03]
 [-9.04214145e-03  2.07399532e-02]]
grads:  [4.29552389e-04 2.08124862e+00]
Stock Position:  0.0004295523889788107
Bond Position:  [-0.00138201]


portfolio before change:  [0.04324364]
curr_Stock_Price:  103.89274168875431
curr_Factors:  [1.03892742e+02 4.25789619e-02]
mat_Sqrt:  [[ 2.14379231e+01 -8.24659258e-03]
 [-8.24659258e-03  1.89151614e-02]]
grads:  [ 4.22987239e-04 -1.13111213e+00]
Stock Position:  0.00042298723853732406
Bond Position:  [-0.00070167]


portfolio before change:  [0.04324399]
curr_Stock_Price:  103.89566405551331
curr_Factors:  [1.03895664e+02 3.94522416e-02]
mat_Sqrt:  [[ 2.06363665e+01 -7.93803222e-03]
 [-7.93803222e-03  1.82074177e-02]]
grads:  [-1.48650177e-04 -1.99897399e+00]
Stock Position:  -0.00014865017704868234
Bond Position:  [0.0586881]


portfolio before change:  [0.04265102]
curr_Stock_Price:  108.37851579233887
curr_Factors:  [1.08378516e+02 3.98562592e-02]
mat_Sqrt:  [[ 2.16367206e+01 -7.97886503e-03]
 [-7.97886503e-03  1.83002816e-02]]
grads:  [-3.94914491e-03 -4.76189946e+00]
Stock Position:  -0.0039491449056581925
Bond Position:  [0.47065349]


portfolio before change:  [0.04204796]
curr_Stock_Price:  108.68029027410255
curr_Factors:  [1.08680290e+02 3.78006942e-02]
mat_Sqrt:  [[ 2.11300560e+01 -7.77040684e-03]
 [-7.77040684e-03  1.78221132e-02]]
grads:  [ 0.00537391 -4.14991283]
Stock Position:  0.005373912342834965
Bond Position:  [-0.5419904]


portfolio before change:  [0.07985479]
curr_Stock_Price:  115.84169168528595
curr_Factors:  [1.15841692e+02 3.57013075e-02]
mat_Sqrt:  [[ 2.18880426e+01 -7.55194047e-03]
 [-7.55194047e-03  1.73199674e-02]]
grads:  [ 1.56470169e-03 -8.63863053e+00]
Stock Position:  0.001564701685286744
Bond Position:  [-0.1014029]


portfolio before change:  [0.07566668]
curr_Stock_Price:  113.24613554722232
curr_Factors:  [1.13246136e+02 3.89775926e-02]
mat_Sqrt:  [[ 2.23578928e+01 -7.89071091e-03]
 [-7.89071091e-03  1.80973094e-02]]
grads:  [-2.16106440e-03  2.23716332e+00]
Stock Position:  -0.002161064403374935
Bond Position:  [0.32039888]


portfolio before change:  [0.08386492]
curr_Stock_Price:  109.63796587159344
curr_Factors:  [1.09637966e+02 4.00833822e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.08386492]
Stock Price:  106.41870028991426
PL:  [-6.33483537]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.50644746e-01 -6.44427151e-03]
 [ 3.92227136e-02  5.21123610e-03]
 [ 7.20132652e-02 -1.04826035e-01]
 [-1.71656463e-02 -1.02409224e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.27762990e-01  1.08202688e-01]
 [ 4.72499202e-02  7.17150560e-02]
 [-2.64948830e-01  6.33510973e-02]
 [ 6.39074848e-02  5.33258257e-02]
 [ 6.37843178e-02 -4.81101444e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [-9.75967945e-03  3.89150661e-02]
 [-9.75662651e-02 -1.39121575e-01]
 [-2.28580932e-04  1.58684718e-01]
 [-9.83347346e-02  5.01134304e-02]
 [-9.79545479e-02  3.81984958e-02]
 [-7.72387836e-02  1.14879777e-01]
 [ 8.01992065e-02 -1.29105792e-01]
 [ 5.66557147e-02  5.76077021e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.6658659]
curr_Stock_Price:  95.97041514662048
curr_Factors:  [9.59704151e+01 4.01032654e-02]
mat_Sqrt:  [[ 1.92188415e+01 -8.00267665e-03]
 [-8.00267665e-03  1.83572825e-02]]
grads:  [ 0.00769361 -0.34769319]
Stock Position:  0.007693609950425644
Bond Position:  [-9.40422484]


portfolio before change:  [-8.66057591]
curr_Stock_Price:  98.18688101269903
curr_Factors:  [9.8186881e+01 3.8238204e-02]
mat_Sqrt:  [[ 1.92000417e+01 -7.81454147e-03]
 [-7.81454147e-03  1.79252610e-02]]
grads:  [0.00216155 0.29166257]
Stock Position:  0.002161553787649975
Bond Position:  [-8.87281213]


portfolio before change:  [-8.66367877]
curr_Stock_Price:  101.88564756848311
curr_Factors:  [1.01885648e+02 3.83276649e-02]
mat_Sqrt:  [[ 1.99466128e+01 -7.82394238e-03]
 [-7.82394238e-03  1.79461019e-02]]
grads:  [ 1.31936556e-03 -5.84058383e+00]
Stock Position:  0.0013193655555371817
Bond Position:  [-8.79810319]


portfolio before change:  [-8.67538026]
curr_Stock_Price:  101.35737411874958
curr_Factors:  [1.01357374e+02 3.76921702e-02]
mat_Sqrt:  [[ 1.96779970e+01 -7.75877218e-03]
 [-7.75877218e-03  1.77967176e-02]]
grads:  [-0.0010994  -0.57591814]
Stock Position:  -0.0010994037655410452
Bond Position:  [-8.56394758]


portfolio before change:  [-8.69014154]
curr_Stock_Price:  105.04086879323418
curr_Factors:  [1.05040869e+02 3.63698765e-02]
mat_Sqrt:  [[ 2.00322249e+01 -7.62170443e-03]
 [-7.62170443e-03  1.74816586e-02]]
grads:  [ 0.00818572 -6.7526505 ]
Stock Position:  0.008185724566360813
Bond Position:  [-9.54997716]


portfolio before change:  [-8.71169307]
curr_Stock_Price:  103.86729006905881
curr_Factors:  [1.0386729e+02 3.4677116e-02]
mat_Sqrt:  [[ 1.93419499e+01 -7.44214961e-03]
 [-7.44214961e-03  1.70700196e-02]]
grads:  [0.00904595 6.34269975]
Stock Position:  0.009045949920529477
Bond Position:  [-9.65127137]


portfolio before change:  [-8.71808711]
curr_Stock_Price:  104.49492922137748
curr_Factors:  [1.04494929e+02 3.30125397e-02]
mat_Sqrt:  [[ 1.89860514e+01 -7.26137188e-03]
 [-7.26137188e-03  1.66552657e-02]]
grads:  [4.13616198e-03 4.30765210e+00]
Stock Position:  0.004136161981518253
Bond Position:  [-9.15029506]


portfolio before change:  [-8.73184301]
curr_Stock_Price:  103.9362270645894
curr_Factors:  [1.03936227e+02 3.03394713e-02]
mat_Sqrt:  [[ 1.81038491e+01 -6.96115284e-03]
 [-6.96115284e-03  1.59667487e-02]]
grads:  [-0.01311152  3.96197292]
Stock Position:  -0.013111517368250482
Bond Position:  [-7.36908136]


portfolio before change:  [-8.77296036]
curr_Stock_Price:  106.36922090367784
curr_Factors:  [1.06369221e+02 2.90407741e-02]
mat_Sqrt:  [[ 1.81267541e+01 -6.81067274e-03]
 [-6.81067274e-03  1.56212188e-02]]
grads:  [0.00480898 3.41577559]
Stock Position:  0.0048089809303964925
Bond Position:  [-9.28448792]


portfolio before change:  [-8.79582855]
curr_Stock_Price:  104.02874143080244
curr_Factors:  [1.04028741e+02 2.94119712e-02]
mat_Sqrt:  [[ 1.78408433e+01 -6.85392853e-03]
 [-6.85392853e-03  1.57207944e-02]]
grads:  [ 2.39991459e-03 -3.05924080e+00]
Stock Position:  0.002399914586336617
Bond Position:  [-9.04548864]


portfolio before change:  [-8.80520786]
curr_Stock_Price:  104.83486271224687
curr_Factors:  [1.04834863e+02 2.82527983e-02]
mat_Sqrt:  [[ 1.76212387e+01 -6.71755421e-03]
 [-6.71755421e-03  1.54078697e-02]]
grads:  [ 5.44947050e-04 -7.94063336e+00]
Stock Position:  0.0005449470503639853
Bond Position:  [-8.86233731]


portfolio before change:  [-8.81751]
curr_Stock_Price:  102.60107529694292
curr_Factors:  [1.02601075e+02 3.08141148e-02]
mat_Sqrt:  [[ 1.80105397e+01 -7.01531268e-03]
 [-7.01531268e-03  1.60911943e-02]]
grads:  [4.00178443e-04 2.41858203e+00]
Stock Position:  0.0004001784426615226
Bond Position:  [-8.85856874]


portfolio before change:  [-8.83122677]
curr_Stock_Price:  96.01244247674435
curr_Factors:  [9.60124425e+01 3.29433006e-02]
mat_Sqrt:  [[ 1.74265347e+01 -7.25319139e-03]
 [-7.25319139e-03  1.66380354e-02]]
grads:  [-0.00908062 -8.36561741]
Stock Position:  -0.009080617130603964
Bond Position:  [-7.95937454]


portfolio before change:  [-8.77156646]
curr_Stock_Price:  88.34603159591086
curr_Factors:  [8.83460316e+01 3.76269023e-02]
mat_Sqrt:  [[ 1.71370567e+01 -7.75102022e-03]
 [-7.75102022e-03  1.77817521e-02]]
grads:  [4.02375256e-03 8.92577428e+00]
Stock Position:  0.004023752562877563
Bond Position:  [-9.12704903]


portfolio before change:  [-8.77767065]
curr_Stock_Price:  89.66613229563981
curr_Factors:  [8.96661323e+01 3.33356883e-02]
mat_Sqrt:  [[ 1.63712977e+01 -7.29576736e-03]
 [-7.29576736e-03  1.67370446e-02]]
grads:  [-0.00467311  2.99212541]
Stock Position:  -0.004673110513682968
Bond Position:  [-8.3586509]


portfolio before change:  [-8.78376083]
curr_Stock_Price:  88.73213583756919
curr_Factors:  [8.87321358e+01 3.59291207e-02]
mat_Sqrt:  [[ 1.68191555e+01 -7.57416723e-03]
 [-7.57416723e-03  1.73759373e-02]]
grads:  [-0.00483495  2.19624843]
Stock Position:  -0.00483495113520749
Bond Position:  [-8.35474529]


portfolio before change:  [-8.79799745]
curr_Stock_Price:  89.51532046272378
curr_Factors:  [8.95153205e+01 4.00838399e-02]
mat_Sqrt:  [[ 1.79218149e+01 -8.00018770e-03]
 [-8.00018770e-03  1.83530759e-02]]
grads:  [-1.51588792e-03  6.25876826e+00]
Stock Position:  -0.0015158879194193673
Bond Position:  [-8.66230225]


portfolio before change:  [-8.80352418]
curr_Stock_Price:  86.01379507295351
curr_Factors:  [8.60137951e+01 4.01929313e-02]
mat_Sqrt:  [[ 1.72441941e+01 -8.01073327e-03]
 [-8.01073327e-03  1.83781791e-02]]
grads:  [ 1.38765834e-03 -7.02434531e+00]
Stock Position:  0.0013876583397909956
Bond Position:  [-8.92288194]


portfolio before change:  [-8.81426754]
curr_Stock_Price:  86.31445193751152
curr_Factors:  [8.63144519e+01 4.03636672e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.81426754]
Stock Price:  85.74634543150168
PL:  [-8.81426754]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 8.80139476e-03 -4.91581589e-02]
 [-3.08123556e-02 -1.28861379e-01]
 [-1.74771401e-01 -2.21079884e-01]
 [-2.36854706e-02 -2.79621611e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.27860068e-01  1.08374344e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-2.12200381e-01  4.47758664e-02]
 [ 5.13027789e-02  4.06425441e-02]
 [ 6.06216965e-02 -3.20591228e-02]
 [ 7.16723526e-02 -1.38380352e-01]
 [-8.23116657e-03  4.69787538e-02]
 [ 2.92279401e-02  6.93327220e-02]
 [-1.30834828e-02 -1.99869196e-01]
 [ 9.58822858e-03 -1.18564124e-01]
 [ 2.14228546e-01 -1.58057116e-01]
 [ 1.39960396e-01 -1.49225838e-01]
 [-9.17203230e-02  4.31315836e-02]
 [-1.17449993e-01 -1.38241800e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.94445748]
curr_Stock_Price:  103.08297865988023
curr_Factors:  [1.03082979e+02 4.05645290e-02]
mat_Sqrt:  [[ 2.07615678e+01 -8.04909802e-03]
 [-8.04909802e-03  1.84623214e-02]]
grads:  [-6.08452861e-04 -2.66288596e+00]
Stock Position:  -0.0006084528610204283
Bond Position:  [18.00717861]


portfolio before change:  [17.96584481]
curr_Stock_Price:  104.94954925513552
curr_Factors:  [1.04949549e+02 4.11678360e-02]
mat_Sqrt:  [[ 2.12941136e+01 -8.10886144e-03]
 [-8.10886144e-03  1.85990518e-02]]
grads:  [-4.08601698e-03 -6.93016577e+00]
Stock Position:  -0.004086016978152808
Bond Position:  [18.39467045]


portfolio before change:  [17.98260852]
curr_Stock_Price:  106.47768783018287
curr_Factors:  [1.06477688e+02 4.25529525e-02]
mat_Sqrt:  [[ 2.19646067e+01 -8.24424992e-03]
 [-8.24424992e-03  1.89093064e-02]]
grads:  [ -0.01234733 -11.69697471]
Stock Position:  -0.012347327129317895
Bond Position:  [19.29732337]


portfolio before change:  [18.02973334]
curr_Stock_Price:  104.61590142478487
curr_Factors:  [1.04615901e+02 4.33013848e-02]
mat_Sqrt:  [[ 2.17695054e+01 -8.31630759e-03]
 [-8.31630759e-03  1.90749279e-02]]
grads:  [-0.00164829 -1.46663038]
Stock Position:  -0.0016482882500094638
Bond Position:  [18.20217051]


portfolio before change:  [18.05185249]
curr_Stock_Price:  105.00891117702658
curr_Factors:  [1.05008911e+02 4.36076814e-02]
mat_Sqrt:  [[ 2.19284342e+01 -8.34569621e-03]
 [-8.34569621e-03  1.91422613e-02]]
grads:  [ 0.00747788 -6.16685299]
Stock Position:  0.007477884579926142
Bond Position:  [17.26660797]


portfolio before change:  [18.06414115]
curr_Stock_Price:  103.76416133510986
curr_Factors:  [1.03764161e+02 4.38065265e-02]
mat_Sqrt:  [[ 2.17178464e+01 -8.36461468e-03]
 [-8.36461468e-03  1.91858929e-02]]
grads:  [0.00806425 5.65216323]
Stock Position:  0.00806425425410237
Bond Position:  [17.22736057]


portfolio before change:  [18.11229918]
curr_Stock_Price:  107.0639533082661
curr_Factors:  [1.07063953e+02 4.21066844e-02]
mat_Sqrt:  [[ 2.19694289e+01 -8.20094440e-03]
 [-8.20094440e-03  1.88098739e-02]]
grads:  [4.08515398e-03 4.30737389e+00]
Stock Position:  0.004085153984180651
Bond Position:  [17.67492644]


portfolio before change:  [18.14640577]
curr_Stock_Price:  110.0012027883577
curr_Factors:  [1.10001203e+02 4.63473594e-02]
mat_Sqrt:  [[ 2.36815379e+01 -8.60420527e-03]
 [-8.60420527e-03  1.97342658e-02]]
grads:  [-0.0081375   2.26539209]
Stock Position:  -0.008137498612081826
Bond Position:  [19.0415404]


portfolio before change:  [18.15115369]
curr_Stock_Price:  112.34453704759615
curr_Factors:  [1.12344537e+02 4.82216496e-02]
mat_Sqrt:  [[ 2.46702166e+01 -8.77661078e-03]
 [-8.77661078e-03  2.01292722e-02]]
grads:  [0.00279828 2.02029676]
Stock Position:  0.002798278521146318
Bond Position:  [17.83678239]


portfolio before change:  [18.1615068]
curr_Stock_Price:  108.07161981215506
curr_Factors:  [1.08071620e+02 5.16937965e-02]
mat_Sqrt:  [[ 2.45714534e+01 -9.08680113e-03]
 [-9.08680113e-03  2.08414973e-02]]
grads:  [ 0.00189861 -1.53740732]
Stock Position:  0.0018986089744521223
Bond Position:  [17.95632105]


portfolio before change:  [18.17065623]
curr_Stock_Price:  101.06122284400364
curr_Factors:  [1.01061223e+02 5.19538100e-02]
mat_Sqrt:  [[ 2.30352652e+01 -9.10908970e-03]
 [-9.10908970e-03  2.08940801e-02]]
grads:  [ 4.92518954e-04 -6.62273068e+00]
Stock Position:  0.0004925189541754893
Bond Position:  [18.12088167]


portfolio before change:  [18.19546916]
curr_Stock_Price:  105.42178195006478
curr_Factors:  [1.05421782e+02 4.40920778e-02]
mat_Sqrt:  [[ 2.21365840e+01 -8.39194908e-03]
 [-8.39194908e-03  1.92482718e-02]]
grads:  [5.53512199e-04 2.44091518e+00]
Stock Position:  0.000553512199419782
Bond Position:  [18.13711691]


portfolio before change:  [18.22068089]
curr_Stock_Price:  109.9856646857635
curr_Factors:  [1.09985665e+02 4.85677943e-02]
mat_Sqrt:  [[ 2.42387515e+01 -8.80790059e-03]
 [-8.80790059e-03  2.02014561e-02]]
grads:  [2.45337117e-03 3.43313524e+00]
Stock Position:  0.002453371169315695
Bond Position:  [17.95084523]


portfolio before change:  [18.24753356]
curr_Stock_Price:  111.77914717445833
curr_Factors:  [1.11779147e+02 4.75018011e-02]
mat_Sqrt:  [[ 2.43621606e+01 -8.71082031e-03]
 [-8.71082031e-03  1.99784789e-02]]
grads:  [-4.11474654e-03 -1.00060190e+01]
Stock Position:  -0.004114746537676255
Bond Position:  [18.70747642]


portfolio before change:  [18.24587751]
curr_Stock_Price:  117.86822481219863
curr_Factors:  [1.17868225e+02 4.27068017e-02]
mat_Sqrt:  [[ 2.43582028e+01 -8.25982650e-03]
 [-8.25982650e-03  1.89431593e-02]]
grads:  [-1.72901790e-03 -6.25969531e+00]
Stock Position:  -0.0017290178992141474
Bond Position:  [18.44967378]


portfolio before change:  [18.26645357]
curr_Stock_Price:  119.31439767808845
curr_Factors:  [1.19314398e+02 4.25654403e-02]
mat_Sqrt:  [[ 2.46162217e+01 -8.24622264e-03]
 [-8.24622264e-03  1.89117481e-02]]
grads:  [ 5.90387185e-03 -8.35504102e+00]
Stock Position:  0.005903871845172121
Bond Position:  [17.56203665]


portfolio before change:  [18.30210637]
curr_Stock_Price:  121.63262706162999
curr_Factors:  [1.21632627e+02 4.14274150e-02]
mat_Sqrt:  [[ 2.47567699e+01 -8.13535976e-03]
 [-8.13535976e-03  1.86571721e-02]]
grads:  [ 3.02551599e-03 -7.99699031e+00]
Stock Position:  0.0030255159862764805
Bond Position:  [17.93410491]


portfolio before change:  [18.31122607]
curr_Stock_Price:  117.232735680636
curr_Factors:  [1.17232736e+02 4.30572152e-02]
mat_Sqrt:  [[ 2.43260639e+01 -8.29360868e-03]
 [-8.29360868e-03  1.90207310e-02]]
grads:  [-0.00299779  2.26630202]
Stock Position:  -0.0029977928702442608
Bond Position:  [18.66266553]


portfolio before change:  [18.31504504]
curr_Stock_Price:  123.74551019244412
curr_Factors:  [1.23745510e+02 4.19462974e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.31504504]
Stock Price:  122.95773145165653
PL:  [-4.64268641]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.27487492e-01 -2.46516650e-02]
 [-8.94274315e-02  7.22257033e-02]
 [ 7.39047074e-02 -4.45961124e-02]
 [-1.54418053e-02 -5.55542821e-03]
 [ 2.49801303e-02 -9.06202748e-02]
 [ 1.20582274e-01  1.05217030e-01]
 [ 2.92730602e-02  4.84795966e-02]
 [-2.93657287e-01  5.89574908e-02]
 [ 7.62860612e-02  6.82400059e-02]
 [ 6.50060811e-02 -5.08871261e-02]
 [ 6.01507432e-02 -1.14677560e-01]
 [-9.37395377e-03  4.05550499e-02]
 [ 3.45725481e-02  3.32775655e-02]
 [ 7.28730934e-03 -1.37719836e-01]
 [-4.27086956e-02 -8.97280077e-02]
 [ 1.46860650e-01 -7.53077646e-02]
 [ 2.95818360e-02 -1.46233861e-01]
 [ 8.84886832e-04  3.77091816e-02]
 [-6.09128835e-02 -5.61599384e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.75856435]
curr_Stock_Price:  93.54006530375462
curr_Factors:  [9.35400653e+01 4.31481803e-02]
mat_Sqrt:  [[ 1.94302716e+01 -8.30072214e-03]
 [-8.30072214e-03  1.90415287e-02]]
grads:  [ 0.00600933 -1.29200673]
Stock Position:  0.006009329452417986
Bond Position:  [-18.32067742]


portfolio before change:  [-17.77760312]
curr_Stock_Price:  94.1851286325973
curr_Factors:  [9.41851286e+01 4.73296845e-02]
mat_Sqrt:  [[ 2.04903370e+01 -8.69369401e-03]
 [-8.69369401e-03  1.99428315e-02]]
grads:  [-2.82829626e-03  3.62040440e+00]
Stock Position:  -0.002828296260067051
Bond Position:  [-17.51121967]


portfolio before change:  [-17.81830539]
curr_Stock_Price:  100.83208649155861
curr_Factors:  [1.00832086e+02 4.21429641e-02]
mat_Sqrt:  [[ 2.06995669e+01 -8.20404290e-03]
 [-8.20404290e-03  1.88181646e-02]]
grads:  [ 0.00263154 -2.36869662]
Stock Position:  0.002631543885262859
Bond Position:  [-18.08364945]


portfolio before change:  [-17.84172858]
curr_Stock_Price:  100.52637644574568
curr_Factors:  [1.00526376e+02 4.45410612e-02]
mat_Sqrt:  [[ 2.12158421e+01 -8.43421105e-03]
 [-8.43421105e-03  1.93461804e-02]]
grads:  [-0.00084215 -0.28752606]
Stock Position:  -0.0008421471406953888
Bond Position:  [-17.75707058]


portfolio before change:  [-17.86542899]
curr_Stock_Price:  102.29589821445677
curr_Factors:  [1.02295898e+02 4.25369831e-02]
mat_Sqrt:  [[ 2.10980117e+01 -8.24241298e-03]
 [-8.24241298e-03  1.89058843e-02]]
grads:  [-6.88696922e-04 -4.79353148e+00]
Stock Position:  -0.0006886969224819808
Bond Position:  [-17.79497812]


portfolio before change:  [-17.88498313]
curr_Stock_Price:  98.37037696813182
curr_Factors:  [9.83703770e+01 4.58932108e-02]
mat_Sqrt:  [[ 2.10735898e+01 -8.56110324e-03]
 [-8.56110324e-03  1.96377091e-02]]
grads:  [0.0079     5.36135155]
Stock Position:  0.007899999952307743
Bond Position:  [-18.6621091]


portfolio before change:  [-17.88068569]
curr_Stock_Price:  101.86906895757258
curr_Factors:  [1.01869069e+02 4.63858604e-02]
mat_Sqrt:  [[ 2.19399236e+01 -8.60720620e-03]
 [-8.60720620e-03  1.97427102e-02]]
grads:  [2.29796953e-03 2.45657132e+00]
Stock Position:  0.00229796953442861
Bond Position:  [-18.1147777]


portfolio before change:  [-17.89693236]
curr_Stock_Price:  104.65890213355416
curr_Factors:  [1.04658902e+02 4.23427612e-02]
mat_Sqrt:  [[ 2.15360341e+01 -8.22374044e-03]
 [-8.22374044e-03  1.88626007e-02]]
grads:  [-0.01244415  3.12020354]
Stock Position:  -0.01244414552846361
Bond Position:  [-16.59454175]


portfolio before change:  [-17.89244786]
curr_Stock_Price:  102.63058704993355
curr_Factors:  [1.02630587e+02 4.70214743e-02]
mat_Sqrt:  [[ 2.22548618e+01 -8.66603457e-03]
 [-8.66603457e-03  1.98774895e-02]]
grads:  [0.00476547 3.43510702]
Stock Position:  0.004765467361545074
Bond Position:  [-18.38153058]


portfolio before change:  [-17.912739]
curr_Stock_Price:  103.19719360244554
curr_Factors:  [1.03197194e+02 5.25381914e-02]
mat_Sqrt:  [[ 2.36540447e+01 -9.16034822e-03]
 [-9.16034822e-03  2.10111859e-02]]
grads:  [ 1.81059123e-03 -2.42111705e+00]
Stock Position:  0.00181059122951998
Bond Position:  [-18.09958693]


portfolio before change:  [-17.94375405]
curr_Stock_Price:  98.57084830837957
curr_Factors:  [9.85708483e+01 5.51134821e-02]
mat_Sqrt:  [[ 2.31407475e+01 -9.38178034e-03]
 [-9.38178034e-03  2.15201538e-02]]
grads:  [ 4.38986995e-04 -5.32865343e+00]
Stock Position:  0.00043898699489414763
Bond Position:  [-17.98702537]


portfolio before change:  [-17.96430522]
curr_Stock_Price:  103.00530977557206
curr_Factors:  [1.03005310e+02 5.20542492e-02]
mat_Sqrt:  [[ 2.35010720e+01 -9.11804644e-03]
 [-9.11804644e-03  2.09141990e-02]]
grads:  [3.53532715e-04 1.93926974e+00]
Stock Position:  0.0003535327153885694
Bond Position:  [-18.00072096]


portfolio before change:  [-17.98565673]
curr_Stock_Price:  106.29626750854355
curr_Factors:  [1.06296268e+02 5.22586262e-02]
mat_Sqrt:  [[ 2.42994799e+01 -9.13618018e-03]
 [-9.13618018e-03  2.09551061e-02]]
grads:  [0.00202018 1.58892167]
Stock Position:  0.002020175859060968
Bond Position:  [-18.20039388]


portfolio before change:  [-18.00547686]
curr_Stock_Price:  107.75385388834098
curr_Factors:  [1.07753854e+02 4.99428692e-02]
mat_Sqrt:  [[ 2.40807232e+01 -8.93156304e-03]
 [-8.93156304e-03  2.04855040e-02]]
grads:  [-2.19122520e-03 -6.72374999e+00]
Stock Position:  -0.002191225196082936
Bond Position:  [-17.7693639]


portfolio before change:  [-18.03285232]
curr_Stock_Price:  110.10407630899205
curr_Factors:  [1.10104076e+02 4.88190402e-02]
mat_Sqrt:  [[ 2.43275284e+01 -8.83066117e-03]
 [-8.83066117e-03  2.02536373e-02]]
grads:  [-3.36422970e-03 -4.43168378e+00]
Stock Position:  -0.003364229701828078
Bond Position:  [-17.66243692]


portfolio before change:  [-18.05032607]
curr_Stock_Price:  108.73136848850183
curr_Factors:  [1.08731368e+02 5.39075809e-02]
mat_Sqrt:  [[ 2.52452541e+01 -9.27938008e-03]
 [-9.27938008e-03  2.12830664e-02]]
grads:  [ 0.00451748 -3.53641923]
Stock Position:  0.004517477681455058
Bond Position:  [-18.5415176]


portfolio before change:  [-18.09400764]
curr_Stock_Price:  104.19561123781978
curr_Factors:  [1.04195611e+02 5.98356854e-02]
mat_Sqrt:  [[ 2.54876345e+01 -9.77593382e-03]
 [-9.77593382e-03  2.24229341e-02]]
grads:  [-1.34099567e-03 -6.52220491e+00]
Stock Position:  -0.0013409956720072894
Bond Position:  [-17.95428177]


portfolio before change:  [-18.11675103]
curr_Stock_Price:  104.40926250339125
curr_Factors:  [1.04409263e+02 5.82300068e-02]
mat_Sqrt:  [[ 2.51948871e+01 -9.64389157e-03]
 [-9.64389157e-03  2.21200231e-02]]
grads:  [6.87767884e-04 1.70505311e+00]
Stock Position:  0.0006877678841666228
Bond Position:  [-18.18856037]


portfolio before change:  [-18.14160862]
curr_Stock_Price:  101.34474743996736
curr_Factors:  [1.01344747e+02 5.98704477e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.14160862]
Stock Price:  104.37652451539125
PL:  [-22.51813314]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-4.13162199e-02 -7.51818712e-02]
 [ 2.33027724e-02 -6.37970969e-02]
 [ 6.05840794e-02 -1.81400848e-01]
 [-1.68814667e-02 -9.46850671e-03]
 [-9.02887093e-02 -7.39836121e-02]
 [ 1.15427650e-01  9.27917654e-02]
 [ 2.75423437e-02  4.62426101e-02]
 [ 3.59766177e-02  1.09218869e-01]
 [ 6.94296910e-02  6.06170595e-02]
 [ 6.73509175e-02 -5.62167735e-02]
 [ 7.25319155e-02 -1.40141890e-01]
 [-1.02502174e-02  3.68569638e-02]
 [-3.53310846e-02 -9.45111778e-02]
 [ 1.22467330e-02 -3.55696548e-02]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.47549570e-01 -7.61539782e-02]
 [ 7.83741948e-02 -1.51951283e-01]
 [-5.36788805e-02  3.92776481e-02]
 [-8.76053292e-02 -7.88898149e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.49384168]
curr_Stock_Price:  100.28967669183227
curr_Factors:  [1.00289677e+02 4.15100219e-02]
mat_Sqrt:  [[ 2.04330255e+01 -8.14216186e-03]
 [-8.14216186e-03  1.86763331e-02]]
grads:  [-3.62675089e-03 -4.02709677e+00]
Stock Position:  -0.003626750893520308
Bond Position:  [7.85756735]


portfolio before change:  [7.49905312]
curr_Stock_Price:  101.56262116901125
curr_Factors:  [1.01562621e+02 3.74154610e-02]
mat_Sqrt:  [[ 1.96453340e+01 -7.73025413e-03]
 [-7.73025413e-03  1.77312656e-02]]
grads:  [-2.29645230e-04 -3.59810029e+00]
Stock Position:  -0.00022964522967925733
Bond Position:  [7.5223765]


portfolio before change:  [7.5080391]
curr_Stock_Price:  103.40405947057681
curr_Factors:  [1.03404059e+02 3.72088813e-02]
mat_Sqrt:  [[ 1.99462318e+01 -7.70900809e-03]
 [-7.70900809e-03  1.76821946e-02]]
grads:  [-9.27764703e-04 -1.02593600e+01]
Stock Position:  -0.0009277647031392096
Bond Position:  [7.60397373]


portfolio before change:  [7.51958453]
curr_Stock_Price:  101.21113125040951
curr_Factors:  [1.01211131e+02 3.42466041e-02]
mat_Sqrt:  [[ 1.87299666e+01 -7.39563753e-03]
 [-7.39563753e-03  1.69638023e-02]]
grads:  [-0.00112189 -0.55864857]
Stock Position:  -0.0011218935687698766
Bond Position:  [7.63313264]


portfolio before change:  [7.52929288]
curr_Stock_Price:  101.06765071451757
curr_Factors:  [1.01067651e+02 3.33688966e-02]
mat_Sqrt:  [[ 1.84621834e+01 -7.30024148e-03]
 [-7.30024148e-03  1.67450124e-02]]
grads:  [-0.00663866 -4.4211419 ]
Stock Position:  -0.006638657543187277
Bond Position:  [8.2002464]


portfolio before change:  [7.55973415]
curr_Stock_Price:  98.02719413830634
curr_Factors:  [9.80271941e+01 3.16388629e-02]
mat_Sqrt:  [[ 1.74364058e+01 -7.10828006e-03]
 [-7.10828006e-03  1.63052441e-02]]
grads:  [0.00894152 5.69481352]
Stock Position:  0.008941520453759837
Bond Position:  [6.68322198]


portfolio before change:  [7.57778608]
curr_Stock_Price:  99.11120234311205
curr_Factors:  [9.91112023e+01 2.93123380e-02]
mat_Sqrt:  [[ 1.69686753e+01 -6.84201095e-03]
 [-6.84201095e-03  1.56942750e-02]]
grads:  [2.81167892e-03 2.94768938e+00]
Stock Position:  0.0028116789199769173
Bond Position:  [7.2991172]


portfolio before change:  [7.58774194]
curr_Stock_Price:  99.40506928891945
curr_Factors:  [9.94050693e+01 2.57575613e-02]
mat_Sqrt:  [[ 1.59536797e+01 -6.41375095e-03]
 [-6.41375095e-03  1.47118800e-02]]
grads:  [5.24054839e-03 7.42614004e+00]
Stock Position:  0.005240548388776602
Bond Position:  [7.06680486]


portfolio before change:  [7.60900882]
curr_Stock_Price:  101.77654781256935
curr_Factors:  [1.01776548e+02 2.38011542e-02]
mat_Sqrt:  [[ 1.57017006e+01 -6.16549647e-03]
 [-6.16549647e-03  1.41420718e-02]]
grads:  [0.00610591 4.2889547 ]
Stock Position:  0.006105913532838517
Bond Position:  [6.98757002]


portfolio before change:  [7.61791714]
curr_Stock_Price:  101.80412696894999
curr_Factors:  [1.01804127e+02 2.19922824e-02]
mat_Sqrt:  [[ 1.50973423e+01 -5.92658205e-03]
 [-5.92658205e-03  1.35940593e-02]]
grads:  [ 2.83821523e-03 -4.13415531e+00]
Stock Position:  0.002838215227740796
Bond Position:  [7.32897511]


portfolio before change:  [7.62546475]
curr_Stock_Price:  101.23358046878379
curr_Factors:  [1.01233580e+02 1.77065814e-02]
mat_Sqrt:  [[ 1.34707546e+01 -5.31782826e-03]
 [-5.31782826e-03  1.21978078e-02]]
grads:  [ 8.49009511e-04 -1.14887344e+01]
Stock Position:  0.0008490095109835643
Bond Position:  [7.53951648]


portfolio before change:  [7.63561739]
curr_Stock_Price:  102.08439882301258
curr_Factors:  [1.02084399e+02 1.67047208e-02]
mat_Sqrt:  [[ 1.31940751e+01 -5.16523200e-03]
 [-5.16523200e-03  1.18476827e-02]]
grads:  [4.41053978e-04 3.11109293e+00]
Stock Position:  0.00044105397769855244
Bond Position:  [7.59059266]


portfolio before change:  [7.64499725]
curr_Stock_Price:  101.82521037874587
curr_Factors:  [1.01825210e+02 1.98707917e-02]
mat_Sqrt:  [[ 1.43536671e+01 -5.63348078e-03]
 [-5.63348078e-03  1.29217573e-02]]
grads:  [-5.33299892e-03 -7.31643684e+00]
Stock Position:  -0.0053329989168460915
Bond Position:  [8.18803099]


portfolio before change:  [7.64394719]
curr_Stock_Price:  103.94249848282679
curr_Factors:  [1.03942498e+02 1.98091742e-02]
mat_Sqrt:  [[ 1.46293929e+01 -5.62484259e-03]
 [-5.62484259e-03  1.29016622e-02]]
grads:  [-2.22935111e-04 -2.75707953e+00]
Stock Position:  -0.0002229351111189169
Bond Position:  [7.66711962]


portfolio before change:  [7.65300396]
curr_Stock_Price:  106.33390074858774
curr_Factors:  [1.06333901e+02 2.01311627e-02]
mat_Sqrt:  [[ 1.50871131e+01 -5.67048523e-03]
 [-5.67048523e-03  1.30060457e-02]]
grads:  [-5.66351387e-03 -6.70032292e+00]
Stock Position:  -0.005663513871339038
Bond Position:  [8.25522748]


portfolio before change:  [7.64780337]
curr_Stock_Price:  109.07532092052477
curr_Factors:  [1.09075321e+02 2.06744152e-02]
mat_Sqrt:  [[ 1.56835036e+01 -5.74661116e-03]
 [-5.74661116e-03  1.31803115e-02]]
grads:  [ 0.00729204 -5.77467942]
Stock Position:  0.007292039806470915
Bond Position:  [6.85242179]


portfolio before change:  [7.66561723]
curr_Stock_Price:  110.3428646162836
curr_Factors:  [1.10342865e+02 1.59108468e-02]
mat_Sqrt:  [[ 1.39184500e+01 -5.04134051e-03]
 [-5.04134051e-03  1.15625842e-02]]
grads:  [ 8.7112024e-04 -1.3141257e+01]
Stock Position:  0.0008711202401748487
Bond Position:  [7.56949533]


portfolio before change:  [7.67597814]
curr_Stock_Price:  111.3681178562653
curr_Factors:  [1.11368118e+02 1.63064221e-02]
mat_Sqrt:  [[ 1.42213293e+01 -5.10366364e-03]
 [-5.10366364e-03  1.17054192e-02]]
grads:  [-2.57073071e-03  3.35438887e+00]
Stock Position:  -0.0025707307139863746
Bond Position:  [7.96227558]


portfolio before change:  [7.68554315]
curr_Stock_Price:  111.52140380563718
curr_Factors:  [1.11521404e+02 1.64903757e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.68554315]
Stock Price:  107.87170458052321
PL:  [-0.18616143]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-5.80466003e-02 -8.07855295e-02]
 [ 2.33027724e-02 -6.37970969e-02]
 [ 6.90030878e-02 -1.24995642e-01]
 [-2.42915297e-02 -2.96094628e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 2.89896232e-02  4.81132485e-02]
 [-2.25438774e-01  6.94493005e-02]
 [ 2.89700116e-02  1.94862984e-02]
 [ 6.05704074e-02 -2.81879860e-02]
 [ 6.19812852e-02 -1.19706391e-01]
 [-1.07144871e-02  3.60563835e-02]
 [-8.94398312e-02 -1.37960453e-01]
 [ 1.07705227e-02  1.02636265e-01]
 [-8.66362238e-02 -1.47515581e-02]
 [ 1.89130356e-02 -2.11372106e-02]
 [-5.00001604e-02  5.05683005e-02]
 [ 3.53617640e-02  4.68942023e-02]
 [ 1.25405224e-02 -4.70169720e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.31637837]
curr_Stock_Price:  100.50952912935811
curr_Factors:  [1.00509529e+02 3.76317065e-02]
mat_Sqrt:  [[ 1.94977349e+01 -7.75248749e-03]
 [-7.75248749e-03  1.77824633e-02]]
grads:  [-0.00478426 -4.54507443]
Stock Position:  -0.004784259998739509
Bond Position:  [8.79724209]


portfolio before change:  [8.32339635]
curr_Stock_Price:  101.34256156534863
curr_Factors:  [1.01342562e+02 3.73449010e-02]
mat_Sqrt:  [[ 1.95842751e+01 -7.72294651e-03]
 [-7.72294651e-03  1.77145451e-02]]
grads:  [-2.30357983e-04 -3.60149672e+00]
Stock Position:  -0.0002303579829757333
Bond Position:  [8.34674142]


portfolio before change:  [8.33361908]
curr_Stock_Price:  102.28551828531046
curr_Factors:  [1.02285518e+02 3.78511526e-02]
mat_Sqrt:  [[ 1.99000273e+01 -7.77518164e-03]
 [-7.77518164e-03  1.78341828e-02]]
grads:  [ 7.29200958e-04 -7.00844963e+00]
Stock Position:  0.0007292009584459425
Bond Position:  [8.25903239]


portfolio before change:  [8.34676227]
curr_Stock_Price:  106.14308389911906
curr_Factors:  [1.06143084e+02 3.40018868e-02]
mat_Sqrt:  [[ 1.95723593e+01 -7.36947636e-03]
 [-7.36947636e-03  1.69029490e-02]]
grads:  [-0.001901   -1.75256235]
Stock Position:  -0.001900997015297317
Bond Position:  [8.54853996]


portfolio before change:  [8.35970995]
curr_Stock_Price:  104.95669158871344
curr_Factors:  [1.04956692e+02 3.59501515e-02]
mat_Sqrt:  [[ 1.99003385e+01 -7.57759253e-03]
 [-7.57759253e-03  1.73804950e-02]]
grads:  [ 0.00823998 -6.79195158]
Stock Position:  0.008239977425280846
Bond Position:  [7.49486919]


portfolio before change:  [8.37886766]
curr_Stock_Price:  106.14398427865244
curr_Factors:  [1.06143984e+02 3.80422087e-02]
mat_Sqrt:  [[ 2.07027585e+01 -7.79503351e-03]
 [-7.79503351e-03  1.78790251e-02]]
grads:  [0.00835499 5.94415454]
Stock Position:  0.00835498572254294
Bond Position:  [7.49203619]


portfolio before change:  [8.35171672]
curr_Stock_Price:  101.77272059644622
curr_Factors:  [1.01772721e+02 4.03614701e-02]
mat_Sqrt:  [[ 2.04463052e+01 -8.02883472e-03]
 [-8.02883472e-03  1.84160939e-02]]
grads:  [2.44415963e-03 2.61363091e+00]
Stock Position:  0.0024441596315907584
Bond Position:  [8.10296794]


portfolio before change:  [8.36465711]
curr_Stock_Price:  102.92049729664056
curr_Factors:  [1.02920497e+02 4.15365773e-02]
mat_Sqrt:  [[ 2.09757354e+01 -8.14495598e-03]
 [-8.14495598e-03  1.86822232e-02]]
grads:  [-0.00930569  3.71334317]
Stock Position:  -0.00930569315072061
Bond Position:  [9.32240368]


portfolio before change:  [8.42553632]
curr_Stock_Price:  97.63137890112272
curr_Factors:  [9.76313789e+01 4.42927240e-02]
mat_Sqrt:  [[ 2.05473388e+01 -8.41043865e-03]
 [-8.41043865e-03  1.92922721e-02]]
grads:  [0.00182368 1.01085224]
Stock Position:  0.001823677642117684
Bond Position:  [8.24748815]


portfolio before change:  [8.43870941]
curr_Stock_Price:  99.19814998222901
curr_Factors:  [9.91981500e+01 4.69858807e-02]
mat_Sqrt:  [[ 2.15024142e+01 -8.66248653e-03]
 [-8.66248653e-03  1.98700814e-02]]
grads:  [ 0.0022458  -1.41763545]
Stock Position:  0.002245801746137813
Bond Position:  [8.21593003]


portfolio before change:  [8.45667508]
curr_Stock_Price:  102.62202103179396
curr_Factors:  [1.02622021e+02 4.04623223e-02]
mat_Sqrt:  [[ 2.06426730e+01 -8.03891926e-03]
 [-8.03891926e-03  1.84390618e-02]]
grads:  [ 4.74467790e-04 -6.49179325e+00]
Stock Position:  0.00047446778953142365
Bond Position:  [8.40798423]


portfolio before change:  [8.46641554]
curr_Stock_Price:  100.98631399937233
curr_Factors:  [1.00986314e+02 4.19265253e-02]
mat_Sqrt:  [[ 2.06779234e+01 -8.18295988e-03]
 [-8.18295988e-03  1.87697741e-02]]
grads:  [2.42078889e-04 1.92108675e+00]
Stock Position:  0.00024207888858442602
Bond Position:  [8.44196888]


portfolio before change:  [8.47608182]
curr_Stock_Price:  97.29835600683732
curr_Factors:  [9.72983560e+01 4.46202969e-02]
mat_Sqrt:  [[ 2.05528330e+01 -8.44145453e-03]
 [-8.44145453e-03  1.93634918e-02]]
grads:  [-0.00727929 -7.1279448 ]
Stock Position:  -0.007279291039898763
Bond Position:  [9.18434487]


portfolio before change:  [8.47466165]
curr_Stock_Price:  99.07157496530226
curr_Factors:  [9.90715750e+01 5.01881849e-02]
mat_Sqrt:  [[ 2.21947254e+01 -8.95280486e-03]
 [-8.95280486e-03  2.05360447e-02]]
grads:  [2.50172716e-03 4.99895008e+00]
Stock Position:  0.0025017271565717404
Bond Position:  [8.2268116]


portfolio before change:  [8.47080366]
curr_Stock_Price:  93.41630804844507
curr_Factors:  [9.3416308e+01 5.3844504e-02]
mat_Sqrt:  [[ 2.16767091e+01 -9.27266908e-03]
 [-9.27266908e-03  2.12711694e-02]]
grads:  [-0.0042942  -0.69537206]
Stock Position:  -0.004294202512100697
Bond Position:  [8.87195221]


portfolio before change:  [8.47351938]
curr_Stock_Price:  95.36804473140236
curr_Factors:  [9.53680447e+01 5.28880806e-02]
mat_Sqrt:  [[ 2.19321771e+01 -9.19013068e-03]
 [-9.19013068e-03  2.10813260e-02]]
grads:  [ 4.42286904e-04 -1.00245810e+00]
Stock Position:  0.0004422869035217883
Bond Position:  [8.43133935]


portfolio before change:  [8.48344707]
curr_Stock_Price:  93.97058311984385
curr_Factors:  [9.39705831e+01 5.09037103e-02]
mat_Sqrt:  [[ 2.12015007e+01 -9.01594598e-03]
 [-9.01594598e-03  2.06821136e-02]]
grads:  [-1.31882757e-03  2.44445085e+00]
Stock Position:  -0.0013188275690498193
Bond Position:  [8.60737806]


portfolio before change:  [8.48518924]
curr_Stock_Price:  100.8128540060477
curr_Factors:  [1.00812854e+02 5.37519746e-02]
mat_Sqrt:  [[ 2.33729262e+01 -9.26536473e-03]
 [-9.26536473e-03  2.12525943e-02]]
grads:  [0.00238804 2.20755771]
Stock Position:  0.0023880446524839082
Bond Position:  [8.24444365]


portfolio before change:  [8.48973846]
curr_Stock_Price:  98.39967553981846
curr_Factors:  [9.83996755e+01 5.64936106e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.48973846]
Stock Price:  99.23735051864588
PL:  [8.48973846]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 3.63732220e-03 -5.16185092e-02]
 [-2.38633470e-03 -9.46839001e-02]
 [-2.36127403e-02 -2.27354433e-01]
 [-2.42305039e-02 -2.94435912e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-2.75146600e-01  6.17832085e-02]
 [ 6.05551706e-02  4.94161357e-02]
 [ 6.13571641e-02 -3.81347182e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 1.79501133e-02  3.31096789e-02]
 [-3.61440710e-02 -9.53037616e-02]
 [ 1.10927666e-02  6.29446994e-02]
 [-4.94220193e-02 -9.08565745e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 1.76574176e-02 -1.19963598e-01]
 [-3.80097464e-02  3.77613328e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.30950555]
curr_Stock_Price:  102.9132649793254
curr_Factors:  [1.02913265e+02 3.89748974e-02]
mat_Sqrt:  [[ 2.03171981e+01 -7.88979740e-03]
 [-7.88979740e-03  1.80969630e-02]]
grads:  [-9.28778551e-04 -2.85273485e+00]
Stock Position:  -0.0009287785510994779
Bond Position:  [17.40508918]


portfolio before change:  [17.33118153]
curr_Stock_Price:  103.01445925238724
curr_Factors:  [1.03014459e+02 3.94899875e-02]
mat_Sqrt:  [[ 2.04711223e+01 -7.94176878e-03]
 [-7.94176878e-03  1.82161517e-02]]
grads:  [-2.13341705e-03 -5.19872938e+00]
Stock Position:  -0.0021334170541765568
Bond Position:  [17.55095433]


portfolio before change:  [17.34949186]
curr_Stock_Price:  104.7216184783227
curr_Factors:  [1.04721618e+02 3.73132769e-02]
mat_Sqrt:  [[ 2.02287017e+01 -7.71990099e-03]
 [-7.71990099e-03  1.77069449e-02]]
grads:  [-6.0683825e-03 -1.2842491e+01]
Stock Position:  -0.006068382495953873
Bond Position:  [17.98498269]


portfolio before change:  [17.34754103]
curr_Stock_Price:  108.75005851639924
curr_Factors:  [1.08750059e+02 3.13585730e-02]
mat_Sqrt:  [[ 1.92578418e+01 -7.07737570e-03]
 [-7.07737570e-03  1.62325748e-02]]
grads:  [-0.00192513 -1.8146977 ]
Stock Position:  -0.001925127517951728
Bond Position:  [17.55689876]


portfolio before change:  [17.3640606]
curr_Stock_Price:  111.57598681704008
curr_Factors:  [1.11575987e+02 3.03957052e-02]
mat_Sqrt:  [[ 1.94525626e+01 -6.96802148e-03]
 [-6.96802148e-03  1.59813557e-02]]
grads:  [ 0.00842941 -7.3868066 ]
Stock Position:  0.008429406363408689
Bond Position:  [16.42354127]


portfolio before change:  [17.37352819]
curr_Stock_Price:  110.26217238062769
curr_Factors:  [1.10262172e+02 3.12899369e-02]
mat_Sqrt:  [[ 1.95042322e+01 -7.06970780e-03]
 [-7.06970780e-03  1.62147649e-02]]
grads:  [0.00886843 6.55410418]
Stock Position:  0.008868432622999921
Bond Position:  [16.39567554]


portfolio before change:  [17.36900561]
curr_Stock_Price:  107.43980414667476
curr_Factors:  [1.07439804e+02 2.98081681e-02]
mat_Sqrt:  [[ 1.85495262e+01 -6.90013024e-03]
 [-6.90013024e-03  1.58262404e-02]]
grads:  [4.83832168e-03 5.11941185e+00]
Stock Position:  0.004838321680268141
Bond Position:  [16.84917728]


portfolio before change:  [17.37438516]
curr_Stock_Price:  104.19589091192154
curr_Factors:  [1.04195891e+02 3.07283989e-02]
mat_Sqrt:  [[ 1.82650358e+01 -7.00564433e-03]
 [-7.00564433e-03  1.60687565e-02]]
grads:  [-0.01359165  3.83900211]
Stock Position:  -0.01359164690580311
Bond Position:  [18.79057892]


portfolio before change:  [17.36255318]
curr_Stock_Price:  106.79564090076296
curr_Factors:  [1.06795641e+02 2.82508081e-02]
mat_Sqrt:  [[ 1.79501852e+01 -6.71742535e-03]
 [-6.71742535e-03  1.54072800e-02]]
grads:  [0.00457452 3.20931823]
Stock Position:  0.0045745225122384
Bond Position:  [16.87401412]


portfolio before change:  [17.38280272]
curr_Stock_Price:  106.60848052975257
curr_Factors:  [1.06608481e+02 3.33766897e-02]
mat_Sqrt:  [[ 1.94766093e+01 -7.30143777e-03]
 [-7.30143777e-03  1.67468177e-02]]
grads:  [ 0.00229702 -2.27613074]
Stock Position:  0.002297018761134433
Bond Position:  [17.13792104]


portfolio before change:  [17.40701368]
curr_Stock_Price:  107.81663813198324
curr_Factors:  [1.07816638e+02 3.42923385e-02]
mat_Sqrt:  [[ 1.99656892e+01 -7.40098441e-03]
 [-7.40098441e-03  1.69749467e-02]]
grads:  [ 4.80878159e-04 -7.20758351e+00]
Stock Position:  0.0004808781588030863
Bond Position:  [17.35516701]


portfolio before change:  [17.42846993]
curr_Stock_Price:  107.29411501414778
curr_Factors:  [1.07294115e+02 3.84173846e-02]
mat_Sqrt:  [[ 2.10300241e+01 -7.83344935e-03]
 [-7.83344935e-03  1.79669396e-02]]
grads:  [1.54022375e-03 1.84348280e+00]
Stock Position:  0.0015402237474746053
Bond Position:  [17.26321299]


portfolio before change:  [17.44156357]
curr_Stock_Price:  101.77616964020264
curr_Factors:  [1.01776170e+02 4.13440117e-02]
mat_Sqrt:  [[ 2.06943779e+01 -8.12597254e-03]
 [-8.12597254e-03  1.86389025e-02]]
grads:  [-3.75497164e-03 -5.11480084e+00]
Stock Position:  -0.0037549716369111204
Bond Position:  [17.8237302]


portfolio before change:  [17.46845198]
curr_Stock_Price:  100.55250651874961
curr_Factors:  [1.00552507e+02 4.16458822e-02]
mat_Sqrt:  [[ 2.05200729e+01 -8.15549489e-03]
 [-8.15549489e-03  1.87068630e-02]]
grads:  [1.87820906e-03 3.36561063e+00]
Stock Position:  0.0018782090600721882
Bond Position:  [17.27959335]


portfolio before change:  [17.49427226]
curr_Stock_Price:  102.79255692781078
curr_Factors:  [1.02792557e+02 3.63463789e-02]
mat_Sqrt:  [[ 1.95971182e+01 -7.61909663e-03]
 [-7.61909663e-03  1.74760738e-02]]
grads:  [-4.54393994e-03 -5.20089330e+00]
Stock Position:  -0.004543939940757047
Bond Position:  [17.96135547]


portfolio before change:  [17.51297996]
curr_Stock_Price:  103.61959920233078
curr_Factors:  [1.03619599e+02 3.65350798e-02]
mat_Sqrt:  [[ 1.98060060e+01 -7.63890353e-03]
 [-7.63890353e-03  1.75213570e-02]]
grads:  [ 0.00548584 -3.48155902]
Stock Position:  0.005485839527604873
Bond Position:  [16.94453947]


portfolio before change:  [17.52221917]
curr_Stock_Price:  101.44040434162386
curr_Factors:  [1.01440404e+02 3.45974377e-02]
mat_Sqrt:  [[ 1.88683058e+01 -7.43343790e-03]
 [-7.43343790e-03  1.70504656e-02]]
grads:  [-1.83634327e-03 -7.03659661e+00]
Stock Position:  -0.001836343265992402
Bond Position:  [17.70849857]


portfolio before change:  [17.53044275]
curr_Stock_Price:  109.02388892771042
curr_Factors:  [1.09023889e+02 3.25487858e-02]
mat_Sqrt:  [[ 1.96693060e+01 -7.21045083e-03]
 [-7.21045083e-03  1.65377525e-02]]
grads:  [-1.0955786e-03  2.2828636e+00]
Stock Position:  -0.0010955785969064989
Bond Position:  [17.64988699]


portfolio before change:  [17.5538571]
curr_Stock_Price:  107.80244170994831
curr_Factors:  [1.07802442e+02 3.15252023e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.5538571]
Stock Price:  113.15754045306169
PL:  [4.39631664]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.70723640e-02 -5.12446649e-02]
 [ 2.22208201e-02 -6.50979614e-02]
 [ 7.46621102e-02 -5.95813775e-02]
 [-1.17646682e-03  6.84119909e-03]
 [-5.72349297e-02 -7.87542386e-02]
 [ 1.27876493e-01  1.18846897e-01]
 [ 3.66392568e-02  5.80005564e-02]
 [-2.79998457e-01  6.10565848e-02]
 [ 6.99735829e-02  6.12228019e-02]
 [ 6.45396495e-02 -4.29456679e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [-1.07250280e-02  3.54060744e-02]
 [-6.84975094e-02 -1.29177534e-01]
 [ 1.30238426e-02 -9.52666534e-02]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.35731705e-01 -6.16378564e-02]
 [ 2.84870428e-02 -1.46108056e-01]
 [ 1.58840977e-02  4.15573464e-02]
 [-8.26910937e-02 -7.78539311e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.62229117]
curr_Stock_Price:  99.52215180947837
curr_Factors:  [9.95221518e+01 4.05673691e-02]
mat_Sqrt:  [[ 2.00450962e+01 -8.04912392e-03]
 [-8.04912392e-03  1.84630792e-02]]
grads:  [-2.62860858e-04 -2.77563564e+00]
Stock Position:  -0.0002628608576220912
Bond Position:  [4.64845165]


portfolio before change:  [4.62754786]
curr_Stock_Price:  101.643094038861
curr_Factors:  [1.01643094e+02 4.02567866e-02]
mat_Sqrt:  [[ 2.03937643e+01 -8.01840677e-03]
 [-8.01840677e-03  1.83921999e-02]]
grads:  [-3.02094807e-04 -3.53956481e+00]
Stock Position:  -0.00030209480735621437
Bond Position:  [4.65825371]


portfolio before change:  [4.63354816]
curr_Stock_Price:  101.06762970759308
curr_Factors:  [1.01067630e+02 4.83926246e-02]
mat_Sqrt:  [[ 2.22331826e+01 -8.79135650e-03]
 [-8.79135650e-03  2.01652745e-02]]
grads:  [ 2.19019934e-03 -2.95369758e+00]
Stock Position:  0.00219019933721041
Bond Position:  [4.41218991]


portfolio before change:  [4.63547146]
curr_Stock_Price:  99.42604920409342
curr_Factors:  [9.94260492e+01 5.36086258e-02]
mat_Sqrt:  [[ 2.30206448e+01 -9.25288453e-03]
 [-9.25288453e-03  2.12242876e-02]]
grads:  [7.84652580e-05 3.22363004e-01]
Stock Position:  7.846525801200709e-05
Bond Position:  [4.62766997]


portfolio before change:  [4.641415]
curr_Stock_Price:  101.40567626304666
curr_Factors:  [1.01405676e+02 4.99563842e-02]
mat_Sqrt:  [[ 2.26651047e+01 -8.93229615e-03]
 [-8.93229615e-03  2.04884828e-02]]
grads:  [-0.00404079 -3.84559134]
Stock Position:  -0.004040788318699223
Bond Position:  [5.05117387]


portfolio before change:  [4.64473054]
curr_Stock_Price:  102.14869278820288
curr_Factors:  [1.02148693e+02 4.44721387e-02]
mat_Sqrt:  [[ 2.15415420e+01 -8.42780495e-03]
 [-8.42780495e-03  1.93311534e-02]]
grads:  [0.00834299 6.1515838 ]
Stock Position:  0.008342988686498081
Bond Position:  [3.79250515]


portfolio before change:  [4.65667444]
curr_Stock_Price:  103.01172905095426
curr_Factors:  [1.03011729e+02 4.05328643e-02]
mat_Sqrt:  [[ 2.07391184e+01 -8.04595089e-03]
 [-8.04595089e-03  1.84551163e-02]]
grads:  [2.98645613e-03 3.14409210e+00]
Stock Position:  0.002986456133901788
Bond Position:  [4.34903443]


portfolio before change:  [4.66599581]
curr_Stock_Price:  104.3114904886048
curr_Factors:  [1.04311490e+02 4.13231033e-02]
mat_Sqrt:  [[ 2.12045267e+01 -8.12409524e-03]
 [-8.12409524e-03  1.86341114e-02]]
grads:  [-0.01195129  3.27139244]
Stock Position:  -0.011951285500851361
Bond Position:  [5.91265221]


portfolio before change:  [4.70275559]
curr_Stock_Price:  101.85448710580341
curr_Factors:  [1.01854487e+02 4.04116025e-02]
mat_Sqrt:  [[ 2.04754365e+01 -8.03382523e-03]
 [-8.03382523e-03  1.84275250e-02]]
grads:  [0.00472182 3.32441477]
Stock Position:  0.004721821198876696
Bond Position:  [4.22181692]


portfolio before change:  [4.7006881]
curr_Stock_Price:  100.2982951625609
curr_Factors:  [1.00298295e+02 3.93689562e-02]
mat_Sqrt:  [[ 1.99007969e+01 -7.92939832e-03]
 [-7.92939832e-03  1.81882985e-02]]
grads:  [ 2.30266914e-03 -2.36016629e+00]
Stock Position:  0.0023026691440843497
Bond Position:  [4.46973432]


portfolio before change:  [4.71645956]
curr_Stock_Price:  104.71959514272405
curr_Factors:  [1.04719595e+02 3.94471746e-02]
mat_Sqrt:  [[ 2.07986848e+01 -7.93757750e-03]
 [-7.93757750e-03  1.82062245e-02]]
grads:  [ 4.61697695e-04 -6.72013246e+00]
Stock Position:  0.00046169769546068243
Bond Position:  [4.66811076]


portfolio before change:  [4.72072704]
curr_Stock_Price:  101.31626735291452
curr_Factors:  [1.01316267e+02 4.05048422e-02]
mat_Sqrt:  [[ 2.03907227e+01 -8.04304949e-03]
 [-8.04304949e-03  1.84487879e-02]]
grads:  [2.31067672e-04 1.91925524e+00]
Stock Position:  0.0002310676719027467
Bond Position:  [4.69731612]


portfolio before change:  [4.72637236]
curr_Stock_Price:  100.32092955395025
curr_Factors:  [1.00320930e+02 3.76327324e-02]
mat_Sqrt:  [[ 1.94614139e+01 -7.75257988e-03]
 [-7.75257988e-03  1.77827115e-02]]
grads:  [-6.41452045e-03 -7.26701678e+00]
Stock Position:  -0.0064145204504130965
Bond Position:  [5.36988302]


portfolio before change:  [4.69712809]
curr_Stock_Price:  105.9270889447794
curr_Factors:  [1.05927089e+02 3.88081219e-02]
mat_Sqrt:  [[ 2.08673990e+01 -7.87309824e-03]
 [-7.87309824e-03  1.80581157e-02]]
grads:  [-1.36652593e-03 -5.27615470e+00]
Stock Position:  -0.0013665259270422873
Bond Position:  [4.8418802]


portfolio before change:  [4.70288541]
curr_Stock_Price:  106.14575387894642
curr_Factors:  [1.06145754e+02 3.70476737e-02]
mat_Sqrt:  [[ 2.04306915e+01 -7.69246630e-03]
 [-7.69246630e-03  1.76437722e-02]]
grads:  [-4.18223875e-03 -4.93912309e+00]
Stock Position:  -0.004182238753575569
Bond Position:  [5.1468123]


portfolio before change:  [4.70520601]
curr_Stock_Price:  107.13014039777683
curr_Factors:  [1.07130140e+02 3.51220904e-02]
mat_Sqrt:  [[ 2.00771388e+01 -7.48994714e-03]
 [-7.48994714e-03  1.71791035e-02]]
grads:  [ 0.00542288 -3.58559103]
Stock Position:  0.005422875188363544
Bond Position:  [4.12425263]


portfolio before change:  [4.7000365]
curr_Stock_Price:  105.22560672583919
curr_Factors:  [1.05225607e+02 4.14191959e-02]
mat_Sqrt:  [[ 2.14152051e+01 -8.13359766e-03]
 [-8.13359766e-03  1.86557377e-02]]
grads:  [-1.64460349e-03 -7.83251969e+00]
Stock Position:  -0.001644603489727835
Bond Position:  [4.8730909]


portfolio before change:  [4.71001807]
curr_Stock_Price:  102.86248790707516
curr_Factors:  [1.02862488e+02 4.33421320e-02]
mat_Sqrt:  [[ 2.14147065e+01 -8.32009538e-03]
 [-8.32009538e-03  1.90839548e-02]]
grads:  [1.58805599e-03 2.17829897e+00]
Stock Position:  0.001588055986618499
Bond Position:  [4.54666668]


portfolio before change:  [4.71571851]
curr_Stock_Price:  102.87102454245311
curr_Factors:  [1.02871025e+02 4.21879173e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.71571851]
Stock Price:  103.91927046939743
PL:  [0.79644804]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-2.52258636e-03 -5.45399250e-02]
 [ 2.50056585e-02 -5.88895044e-02]
 [ 4.13671657e-02  1.16885962e-01]
 [-2.08647868e-01 -1.12910010e-01]
 [-1.98272692e-01 -4.43842856e-03]
 [ 8.64994755e-02  2.85978739e-02]
 [-1.99186842e-02 -1.77510734e-02]
 [ 3.76320621e-02  3.38791815e-02]
 [ 8.24847966e-02  7.49947826e-02]
 [ 6.34453275e-02 -4.73396434e-02]
 [ 6.27747834e-02 -1.21886275e-01]
 [-8.90005158e-03  4.25005788e-02]
 [ 1.96839219e-03 -4.51329245e-02]
 [ 1.35796012e-02 -6.92434011e-02]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 2.89104963e-02 -1.46157724e-01]
 [-5.92459730e-03  3.58941156e-02]
 [-8.22386729e-02 -7.73185402e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.56295745]
curr_Stock_Price:  102.71372321768382
curr_Factors:  [1.02713723e+02 4.06891982e-02]
mat_Sqrt:  [[ 2.07189625e+01 -8.06143165e-03]
 [-8.06143165e-03  1.84906815e-02]]
grads:  [-1.26960821e-03 -2.95014329e+00]
Stock Position:  -0.0012696082054407711
Bond Position:  [16.69336363]


portfolio before change:  [16.58727318]
curr_Stock_Price:  100.00739318544005
curr_Factors:  [1.00007393e+02 4.11688082e-02]
mat_Sqrt:  [[ 2.02915966e+01 -8.10860749e-03]
 [-8.10860749e-03  1.85994238e-02]]
grads:  [-3.29168144e-05 -3.16621481e+00]
Stock Position:  -3.291681436012712e-05
Bond Position:  [16.5905651]


portfolio before change:  [16.60830302]
curr_Stock_Price:  91.5414813947549
curr_Factors:  [9.15414814e+01 5.25501038e-02]
mat_Sqrt:  [[ 2.09847927e+01 -9.16035153e-03]
 [-9.16035153e-03  2.10140191e-02]]
grads:  [4.40019698e-03 5.56420305e+00]
Stock Position:  0.004400196979022012
Bond Position:  [16.20550247]


portfolio before change:  [16.63717936]
curr_Stock_Price:  93.49748345008884
curr_Factors:  [9.34974835e+01 5.49675673e-02]
mat_Sqrt:  [[ 2.19206355e+01 -9.36888048e-03]
 [-9.36888048e-03  2.14918531e-02]]
grads:  [-0.01176592 -5.25874818]
Stock Position:  -0.011765920359666856
Bond Position:  [17.7372633]


portfolio before change:  [16.61931227]
curr_Stock_Price:  96.90159759457735
curr_Factors:  [9.69015976e+01 5.82297950e-02]
mat_Sqrt:  [[ 2.33831777e+01 -9.64321866e-03]
 [-9.64321866e-03  2.21202686e-02]]
grads:  [-0.00856358 -0.2043831 ]
Stock Position:  -0.008563575280057497
Bond Position:  [17.44913639]


portfolio before change:  [16.64806479]
curr_Stock_Price:  96.0926518329709
curr_Factors:  [9.60926518e+01 5.76111580e-02]
mat_Sqrt:  [[ 2.30644681e+01 -9.59178048e-03]
 [-9.59178048e-03  2.20024846e-02]]
grads:  [0.00429164 1.30162747]
Stock Position:  0.004291640288247252
Bond Position:  [16.2356697]


portfolio before change:  [16.66999855]
curr_Stock_Price:  96.47164086949688
curr_Factors:  [9.64716409e+01 5.53973485e-02]
mat_Sqrt:  [[ 2.27061821e+01 -9.40571995e-03]
 [-9.40571995e-03  2.15755861e-02]]
grads:  [-0.00121826 -0.82326997]
Stock Position:  -0.0012182642915840854
Bond Position:  [16.78752651]


portfolio before change:  [16.69031865]
curr_Stock_Price:  97.02770728007562
curr_Factors:  [9.70277073e+01 5.07611726e-02]
mat_Sqrt:  [[ 2.18605737e+01 -9.00359062e-03]
 [-9.00359062e-03  2.06530163e-02]]
grads:  [0.00239751 1.6414439 ]
Stock Position:  0.002397510320335337
Bond Position:  [16.45769372]


portfolio before change:  [16.7276362]
curr_Stock_Price:  104.00685163913778
curr_Factors:  [1.04006852e+02 4.70581295e-02]
mat_Sqrt:  [[ 2.25620859e+01 -8.66951405e-03]
 [-8.66951405e-03  1.98851910e-02]]
grads:  [0.00510592 3.77361467]
Stock Position:  0.005105919840842777
Bond Position:  [16.19658555]


portfolio before change:  [16.74885576]
curr_Stock_Price:  104.19509773605459
curr_Factors:  [1.04195098e+02 4.67698802e-02]
mat_Sqrt:  [[ 2.25335897e+01 -8.64293495e-03]
 [-8.64293495e-03  1.98241892e-02]]
grads:  [ 1.89998068e-03 -2.38714540e+00]
Stock Position:  0.001899980679945644
Bond Position:  [16.55088709]


portfolio before change:  [16.7689934]
curr_Stock_Price:  103.8983014873999
curr_Factors:  [1.03898301e+02 4.39607663e-02]
mat_Sqrt:  [[ 2.17841713e+01 -8.37933691e-03]
 [-8.37933691e-03  1.92196352e-02]]
grads:  [ 4.42370408e-04 -6.34156512e+00]
Stock Position:  0.00044237040828176054
Bond Position:  [16.72303186]


portfolio before change:  [16.78973782]
curr_Stock_Price:  103.50850743725562
curr_Factors:  [1.03508507e+02 4.56229603e-02]
mat_Sqrt:  [[ 2.21089310e+01 -8.53625371e-03]
 [-8.53625371e-03  1.95796317e-02]]
grads:  [4.35607270e-04 2.17084254e+00]
Stock Position:  0.0004356072698750606
Bond Position:  [16.74464876]


portfolio before change:  [16.8105585]
curr_Stock_Price:  103.22563239670498
curr_Factors:  [1.03225632e+02 4.66151091e-02]
mat_Sqrt:  [[ 2.22869620e+01 -8.62855125e-03]
 [-8.62855125e-03  1.97913919e-02]]
grads:  [-7.94698810e-04 -2.28077852e+00]
Stock Position:  -0.0007946988097783798
Bond Position:  [16.89259179]


portfolio before change:  [16.83030004]
curr_Stock_Price:  104.97144849913764
curr_Factors:  [1.04971448e+02 4.65508408e-02]
mat_Sqrt:  [[ 2.26482642e+01 -8.62272834e-03]
 [-8.62272834e-03  1.97776885e-02]]
grads:  [-7.33481163e-04 -3.50140643e+00]
Stock Position:  -0.000733481162705097
Bond Position:  [16.90729462]


portfolio before change:  [16.85084974]
curr_Stock_Price:  105.78623650723368
curr_Factors:  [1.05786237e+02 4.39532854e-02]
mat_Sqrt:  [[ 2.21781240e+01 -8.37875572e-03]
 [-8.37875572e-03  1.92179423e-02]]
grads:  [-3.85271292e-03 -4.53455790e+00]
Stock Position:  -0.003852712917735919
Bond Position:  [17.25841374]


portfolio before change:  [16.8768343]
curr_Stock_Price:  104.6446898860429
curr_Factors:  [1.04644690e+02 4.53821836e-02]
mat_Sqrt:  [[ 2.22925556e+01 -8.51378051e-03]
 [-8.51378051e-03  1.95278616e-02]]
grads:  [ 0.00487392 -3.12384685]
Stock Position:  0.0048739193354195515
Bond Position:  [16.36680452]


portfolio before change:  [16.90126405]
curr_Stock_Price:  105.45685941440257
curr_Factors:  [1.05456859e+02 4.45472899e-02]
mat_Sqrt:  [[ 2.22579646e+01 -8.43516005e-03]
 [-8.43516005e-03  1.93473764e-02]]
grads:  [-1.56428444e-03 -7.55507704e+00]
Stock Position:  -0.0015642844409112053
Bond Position:  [17.06622857]


portfolio before change:  [16.92310805]
curr_Stock_Price:  105.13858296006838
curr_Factors:  [1.05138583e+02 4.62467004e-02]
mat_Sqrt:  [[ 2.26100990e+01 -8.59452575e-03]
 [-8.59452575e-03  1.97129686e-02]]
grads:  [4.30172851e-04 1.82102521e+00]
Stock Position:  0.0004301728506145714
Bond Position:  [16.87788028]


portfolio before change:  [16.94322163]
curr_Stock_Price:  102.82100214587625
curr_Factors:  [1.02821002e+02 4.92936402e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.94322163]
Stock Price:  104.28798125077516
PL:  [12.65524038]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.51044059e-01 -3.65653812e-03]
 [ 5.06901210e-03 -8.57201075e-02]
 [ 5.73277494e-02  7.19208593e-02]
 [-9.40182876e-02 -4.88526315e-02]
 [-2.00024168e-01 -3.22440287e-02]
 [ 6.34392224e-02 -1.61897194e-02]
 [-1.37353632e-01 -1.75682756e-01]
 [ 3.25699992e-02 -1.46457149e-02]
 [-1.89107402e-01 -1.48361293e-01]
 [ 1.04928900e-01  4.99658721e-01]
 [-6.71753109e-02 -6.86664949e-02]
 [ 4.48640863e-02 -1.72399447e-01]
 [-2.18141025e-01 -9.37381730e-02]
 [ 4.58701140e-03  1.42912692e-01]
 [-9.31807080e-02  2.80406783e-01]
 [-2.47298168e-01  1.17577890e-01]
 [-1.11326171e-01  2.22188424e-01]
 [ 7.88993887e-03 -1.66345787e-01]
 [-4.24709436e-02  6.24617325e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.3133622]
curr_Stock_Price:  98.20292139003122
curr_Factors:  [9.82029214e+01 4.21553545e-02]
mat_Sqrt:  [[ 2.01627955e+01 -8.20504931e-03]
 [-8.20504931e-03  1.88210178e-02]]
grads:  [ 0.00741348 -0.19104759]
Stock Position:  0.007413481136419206
Bond Position:  [-1.0413877]


portfolio before change:  [-0.28277186]
curr_Stock_Price:  102.50493348422185
curr_Factors:  [1.02504933e+02 3.78363875e-02]
mat_Sqrt:  [[ 1.99388253e+01 -7.77367990e-03]
 [-7.77367990e-03  1.78306976e-02]]
grads:  [-1.62035736e-03 -4.80815197e+00]
Stock Position:  -0.0016203573567365483
Bond Position:  [-0.11667724]


portfolio before change:  [-0.27291918]
curr_Stock_Price:  96.33431139228043
curr_Factors:  [9.63343114e+01 4.01936173e-02]
mat_Sqrt:  [[ 1.93134343e+01 -8.01171540e-03]
 [-8.01171540e-03  1.83779376e-02]]
grads:  [0.00459251 3.91543681]
Stock Position:  0.004592508685899175
Bond Position:  [-0.71533534]


portfolio before change:  [-0.2813443]
curr_Stock_Price:  94.69460102146401
curr_Factors:  [9.46946010e+01 4.69318731e-02]
mat_Sqrt:  [[ 2.05144144e+01 -8.65712646e-03]
 [-8.65712646e-03  1.98588240e-02]]
grads:  [-0.00562219 -2.46244709]
Stock Position:  -0.005622193321278823
Bond Position:  [0.25104706]


portfolio before change:  [-0.30458019]
curr_Stock_Price:  98.88334037789012
curr_Factors:  [9.88833404e+01 4.63961029e-02]
mat_Sqrt:  [[ 2.12992271e+01 -8.60792276e-03]
 [-8.60792276e-03  1.97449916e-02]]
grads:  [-0.01005289 -1.63740577]
Stock Position:  -0.010052892011385345
Bond Position:  [0.68948335]


portfolio before change:  [-0.2609772]
curr_Stock_Price:  94.63176803792335
curr_Factors:  [9.46317680e+01 4.77421687e-02]
mat_Sqrt:  [[ 2.06770219e+01 -8.73153523e-03]
 [-8.73153523e-03  2.00295277e-02]]
grads:  [ 0.00272728 -0.80710371]
Stock Position:  0.002727277083516129
Bond Position:  [-0.51906425]


portfolio before change:  [-0.2675488]
curr_Stock_Price:  92.46023973206394
curr_Factors:  [9.24602397e+01 5.11221990e-02]
mat_Sqrt:  [[ 2.09054605e+01 -9.03513053e-03]
 [-9.03513053e-03  2.07265146e-02]]
grads:  [-0.0102355  -8.48069437]
Stock Position:  -0.010235498648623944
Bond Position:  [0.67882786]


portfolio before change:  [-0.24326185]
curr_Stock_Price:  90.17037717580793
curr_Factors:  [9.01703772e+01 4.80484979e-02]
mat_Sqrt:  [[ 1.97653155e+01 -8.75908321e-03]
 [-8.75908321e-03  2.00938657e-02]]
grads:  [ 0.00132509 -0.72828735]
Stock Position:  0.001325092412701469
Bond Position:  [-0.36274593]


portfolio before change:  [-0.24949402]
curr_Stock_Price:  85.80957959383058
curr_Factors:  [8.58095796e+01 5.03263202e-02]
mat_Sqrt:  [[ 1.92501144e+01 -8.96383634e-03]
 [-8.96383634e-03  2.05648448e-02]]
grads:  [-0.01318573 -7.22006362]
Stock Position:  -0.013185733070908425
Bond Position:  [0.88196819]


portfolio before change:  [-0.18547858]
curr_Stock_Price:  81.03833957001449
curr_Factors:  [8.10383396e+01 5.10599713e-02]
mat_Sqrt:  [[ 1.83117885e+01 -9.02836955e-03]
 [-9.02836955e-03  2.07144456e-02]]
grads:  [1.76265685e-02 2.41289518e+01]
Stock Position:  0.017626568470565332
Bond Position:  [-1.61390642]


portfolio before change:  [-0.16557796]
curr_Stock_Price:  82.2818749029861
curr_Factors:  [8.22818749e+01 5.18771594e-02]
mat_Sqrt:  [[ 1.87409767e+01 -9.10048534e-03]
 [-9.10048534e-03  2.08794818e-02]]
grads:  [-0.00518248 -3.29096568]
Stock Position:  -0.005182477792812904
Bond Position:  [0.26084603]


portfolio before change:  [-0.14983879]
curr_Stock_Price:  79.30783211148012
curr_Factors:  [7.93078321e+01 4.42560898e-02]
mat_Sqrt:  [[ 1.66840908e+01 -8.40513816e-03]
 [-8.40513816e-03  1.92850862e-02]]
grads:  [-1.81493123e-03 -8.94031273e+00]
Stock Position:  -0.0018149312321589298
Bond Position:  [-0.00590053]


portfolio before change:  [-0.14921117]
curr_Stock_Price:  78.95795707509778
curr_Factors:  [7.89579571e+01 4.01616064e-02]
mat_Sqrt:  [[ 1.58234575e+01 -8.00684926e-03]
 [-8.00684926e-03  1.83713480e-02]]
grads:  [-0.01637142 -5.10954647]
Stock Position:  -0.01637141525657482
Bond Position:  [1.14344233]


portfolio before change:  [-0.15398441]
curr_Stock_Price:  79.33687607158306
curr_Factors:  [7.93368761e+01 4.56200707e-02]
mat_Sqrt:  [[ 1.69454466e+01 -8.53368283e-03]
 [-8.53368283e-03  1.95800144e-02]]
grads:  [3.94726951e-03 7.30062674e+00]
Stock Position:  0.003947269505454168
Bond Position:  [-0.46714844]


portfolio before change:  [-0.16192997]
curr_Stock_Price:  77.471976677503
curr_Factors:  [7.74719767e+01 4.50164248e-02]
mat_Sqrt:  [[ 1.64372848e+01 -8.47680036e-03]
 [-8.47680036e-03  1.94501441e-02]]
grads:  [1.76630498e-03 1.44174642e+01]
Stock Position:  0.0017663049753681576
Bond Position:  [-0.29876911]


portfolio before change:  [-0.1598206]
curr_Stock_Price:  78.87777385376599
curr_Factors:  [7.88777739e+01 4.57263636e-02]
mat_Sqrt:  [[ 1.68670030e+01 -8.54356121e-03]
 [-8.54356121e-03  1.96028365e-02]]
grads:  [-0.01162608  5.99293688]
Stock Position:  -0.011626081087103968
Bond Position:  [0.75721879]


portfolio before change:  [-0.19486864]
curr_Stock_Price:  81.97384295133735
curr_Factors:  [8.19738430e+01 4.34383114e-02]
mat_Sqrt:  [[ 1.70848713e+01 -8.32743232e-03]
 [-8.32743232e-03  1.91059411e-02]]
grads:  [-8.47953100e-04  1.16289149e+01]
Stock Position:  -0.0008479530997407917
Bond Position:  [-0.12535866]


portfolio before change:  [-0.19296199]
curr_Stock_Price:  79.54040551211487
curr_Factors:  [7.95404055e+01 4.26306782e-02]
mat_Sqrt:  [[ 1.64228629e+01 -8.24937268e-03]
 [-8.24937268e-03  1.89276156e-02]]
grads:  [-3.93500279e-03 -8.79023812e+00]
Stock Position:  -0.003935002790371209
Bond Position:  [0.12002973]


portfolio before change:  [-0.18690325]
curr_Stock_Price:  78.03885236862504
curr_Factors:  [7.80388524e+01 4.22773926e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.18690325]
Stock Price:  76.09101700505434
PL:  [-0.18690325]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.54884556e-01 -3.09489053e-03]
 [ 4.10625595e-02  2.97179328e-03]
 [ 6.78168335e-02  4.07449633e-02]
 [ 1.31857550e-02  1.88009622e-02]
 [-8.60254733e-02  1.01110402e-02]
 [ 1.12758054e-02 -2.04367785e-01]
 [-1.91000043e-01 -2.46282828e-01]
 [ 3.25314614e-02 -1.48129805e-02]
 [-1.37105697e-01 -1.09379381e-01]
 [ 6.65489395e-02  3.35040222e-01]
 [ 5.67623811e-02 -1.05369114e-01]
 [ 4.62492700e-03 -2.01672548e-02]
 [-1.33601105e-01 -1.32543369e-01]
 [ 2.78331359e-03  1.62645468e-01]
 [-9.14312375e-02 -1.49054177e-03]
 [ 3.76521451e-02 -2.97714545e-02]
 [-1.37718404e-02 -3.92058054e-02]
 [ 7.31630497e-02  1.81388814e-02]
 [ 1.06314660e-01  5.75550530e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.03594218]
curr_Stock_Price:  96.40607073155223
curr_Factors:  [9.64060707e+01 3.57084199e-02]
mat_Sqrt:  [[ 1.82175371e+01 -7.55148895e-03]
 [-7.55148895e-03  1.73222174e-02]]
grads:  [ 0.00842941 -0.17499122]
Stock Position:  0.008429411236340245
Bond Position:  [-7.84858859]


portfolio before change:  [-7.03020374]
curr_Stock_Price:  98.25143196336639
curr_Factors:  [9.82514320e+01 3.42702953e-02]
mat_Sqrt:  [[ 1.81885374e+01 -7.39799352e-03]
 [-7.39799352e-03  1.69697568e-02]]
grads:  [0.00232925 0.17613836]
Stock Position:  0.0023292488578392813
Bond Position:  [-7.25905577]


portfolio before change:  [-7.03678961]
curr_Stock_Price:  99.32199911630383
curr_Factors:  [9.93219991e+01 3.42659312e-02]
mat_Sqrt:  [[ 1.83855525e+01 -7.39759678e-03]
 [-7.39759678e-03  1.69686438e-02]]
grads:  [0.00465555 2.40322112]
Stock Position:  0.004655551916035873
Bond Position:  [-7.49918834]


portfolio before change:  [-7.05059068]
curr_Stock_Price:  98.37233372700909
curr_Factors:  [9.83723337e+01 3.21152701e-02]
mat_Sqrt:  [[ 1.76290426e+01 -7.16162060e-03]
 [-7.16162060e-03  1.64275345e-02]]
grads:  [0.0012131  1.14500748]
Stock Position:  0.001213104118038876
Bond Position:  [-7.16992656]


portfolio before change:  [-7.06442712]
curr_Stock_Price:  94.35913306437264
curr_Factors:  [9.43591331e+01 3.59330444e-02]
mat_Sqrt:  [[ 1.78867283e+01 -7.57504700e-03]
 [-7.57504700e-03  1.73766829e-02]]
grads:  [-0.00456388  0.57988448]
Stock Position:  -0.004563876617729264
Bond Position:  [-6.63378368]


portfolio before change:  [-7.05502177]
curr_Stock_Price:  90.48024665559953
curr_Factors:  [9.04802467e+01 3.50904739e-02]
mat_Sqrt:  [[ 1.69491667e+01 -7.48539757e-03]
 [-7.48539757e-03  1.71718829e-02]]
grads:  [-4.59168079e-03 -1.19033047e+01]
Stock Position:  -0.004591680790614382
Bond Position:  [-6.63956536]


portfolio before change:  [-7.06436979]
curr_Stock_Price:  90.70747733329274
curr_Factors:  [9.07074773e+01 3.37108506e-02]
mat_Sqrt:  [[ 1.66543582e+01 -7.33679208e-03]
 [-7.33679208e-03  1.68309236e-02]]
grads:  [ -0.01791812 -14.64056854]
Stock Position:  -0.017918123655889368
Bond Position:  [-5.439062]


portfolio before change:  [-7.06220741]
curr_Stock_Price:  90.20712047740302
curr_Factors:  [9.02071205e+01 3.18607300e-02]
mat_Sqrt:  [[ 1.61015853e+01 -7.13258220e-03]
 [-7.13258220e-03  1.63625662e-02]]
grads:  [ 0.00161968 -0.90459087]
Stock Position:  0.0016196785666690316
Bond Position:  [-7.20831395]


portfolio before change:  [-7.07388674]
curr_Stock_Price:  88.56277996728326
curr_Factors:  [8.85627800e+01 3.11366014e-02]
mat_Sqrt:  [[ 1.56274026e+01 -7.05092901e-03]
 [-7.05092901e-03  1.61756117e-02]]
grads:  [-0.01182669 -6.76714873]
Stock Position:  -0.011826685934012735
Bond Position:  [-6.02648256]


portfolio before change:  [-7.07361275]
curr_Stock_Price:  87.902256277995
curr_Factors:  [8.79022563e+01 3.08492278e-02]
mat_Sqrt:  [[ 1.54391052e+01 -7.01826097e-03]
 [-7.01826097e-03  1.61008165e-02]]
grads:  [1.37723874e-02 2.08148997e+01]
Stock Position:  0.013772387363298876
Bond Position:  [-8.28423667]


portfolio before change:  [-7.04889551]
curr_Stock_Price:  90.44931007177833
curr_Factors:  [9.04493101e+01 3.24922023e-02]
mat_Sqrt:  [[ 1.63040234e+01 -7.20293804e-03]
 [-7.20293804e-03  1.65239132e-02]]
grads:  [ 6.64438633e-04 -6.37647552e+00]
Stock Position:  0.0006644386333438747
Bond Position:  [-7.10899352]


portfolio before change:  [-7.05703422]
curr_Stock_Price:  91.58272528056388
curr_Factors:  [9.15827253e+01 3.06829367e-02]
mat_Sqrt:  [[ 1.60421282e+01 -6.99961267e-03]
 [-6.99961267e-03  1.60572348e-02]]
grads:  [-2.59760020e-04 -1.25607387e+00]
Stock Position:  -0.0002597600202259062
Bond Position:  [-7.03324469]


portfolio before change:  [-7.06560553]
curr_Stock_Price:  90.7136659216049
curr_Factors:  [9.07136659e+01 3.19737664e-02]
mat_Sqrt:  [[ 1.62206994e+01 -7.14526410e-03]
 [-7.14526410e-03  1.63915486e-02]]
grads:  [-0.01180066 -8.09122381]
Stock Position:  -0.01180066480504358
Bond Position:  [-5.99512396]


portfolio before change:  [-7.06590784]
curr_Stock_Price:  90.10384599257907
curr_Factors:  [9.01038460e+01 3.07907144e-02]
mat_Sqrt:  [[ 1.58107754e+01 -7.01178033e-03]
 [-7.01178033e-03  1.60854618e-02]]
grads:  [4.66112555e-03 1.01133653e+01]
Stock Position:  0.0046611255538908485
Bond Position:  [-7.48589318]


portfolio before change:  [-7.06505853]
curr_Stock_Price:  92.29484525877814
curr_Factors:  [9.22948453e+01 3.16768966e-02]
mat_Sqrt:  [[ 1.64266392e+01 -7.11213859e-03]
 [-7.11213859e-03  1.63152215e-02]]
grads:  [-0.00560665 -0.09380302]
Stock Position:  -0.00560664760979384
Bond Position:  [-6.54759386]


portfolio before change:  [-7.09480433]
curr_Stock_Price:  96.13960052953006
curr_Factors:  [9.61396005e+01 2.74613909e-02]
mat_Sqrt:  [[ 1.59317521e+01 -6.62227781e-03]
 [-6.62227781e-03  1.51907651e-02]]
grads:  [ 1.54898332e-03 -1.95916377e+00]
Stock Position:  0.0015489833238202526
Bond Position:  [-7.24372297]


portfolio before change:  [-7.10195983]
curr_Stock_Price:  97.36932036485355
curr_Factors:  [9.73693204e+01 2.71305950e-02]
mat_Sqrt:  [[ 1.60380573e+01 -6.58235067e-03]
 [-6.58235067e-03  1.50989606e-02]]
grads:  [-1.92473607e-03 -2.59742878e+00]
Stock Position:  -0.0019247360730893605
Bond Position:  [-6.91454959]


portfolio before change:  [-7.11214687]
curr_Stock_Price:  98.16862205100296
curr_Factors:  [9.81686221e+01 2.57033821e-02]
mat_Sqrt:  [[ 1.57386615e+01 -6.40692761e-03]
 [-6.40692761e-03  1.46964315e-02]]
grads:  [0.00515197 1.23648313]
Stock Position:  0.005151969726426368
Bond Position:  [-7.61790863]


portfolio before change:  [-7.13790653]
curr_Stock_Price:  95.01811281412766
curr_Factors:  [9.50181128e+01 2.24892278e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.13790653]
Stock Price:  96.34363135786452
PL:  [-7.13790653]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-2.70278135e-02 -6.61806524e-02]
 [ 7.77110384e-03 -8.24712995e-02]
 [ 6.25087131e-02 -1.68494479e-01]
 [ 2.71986241e-02  2.31834399e-02]
 [ 2.38336813e-01  2.65956427e-02]
 [-4.24310318e-02 -4.02365003e-01]
 [-3.20740410e-01 -3.51202596e-01]
 [ 3.43387621e-02 -6.96874535e-03]
 [-2.44715241e-01 -1.90029142e-01]
 [ 6.68062116e-02  3.36169530e-01]
 [ 4.68973138e-02 -9.50091906e-02]
 [ 5.32931633e-02 -2.04463223e-01]
 [-2.62478951e-01 -7.33863451e-02]
 [ 1.85657166e-02  1.30306478e-01]
 [-7.75612219e-02  4.17627346e-01]
 [-3.44097187e-01  1.69028682e-01]
 [-1.53338912e-01  3.54446445e-01]
 [-8.63953060e-02 -2.14938231e-01]
 [-3.94376824e-02  7.67035054e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.57781371]
curr_Stock_Price:  101.91583646854903
curr_Factors:  [1.01915836e+02 4.24362722e-02]
mat_Sqrt:  [[ 2.09947280e+01 -8.23262231e-03]
 [-8.23262231e-03  1.88835021e-02]]
grads:  [-2.66210087e-03 -3.50584166e+00]
Stock Position:  -0.0026621008708762744
Bond Position:  [13.84912395]


portfolio before change:  [13.59404727]
curr_Stock_Price:  102.32478756605734
curr_Factors:  [1.02324788e+02 3.99744481e-02]
mat_Sqrt:  [[ 2.04584184e+01 -7.99028695e-03]
 [-7.99028695e-03  1.83275693e-02]]
grads:  [-1.37785739e-03 -4.50044999e+00]
Stock Position:  -0.0013778573899869404
Bond Position:  [13.73503624]


portfolio before change:  [13.61009161]
curr_Stock_Price:  103.14867054390746
curr_Factors:  [1.03148671e+02 3.86895614e-02]
mat_Sqrt:  [[ 2.02889936e+01 -7.86087963e-03]
 [-7.86087963e-03  1.80305903e-02]]
grads:  [-5.39822359e-04 -9.34515842e+00]
Stock Position:  -0.0005398223586598149
Bond Position:  [13.66577357]


portfolio before change:  [13.63073225]
curr_Stock_Price:  96.57660773159981
curr_Factors:  [9.65766077e+01 4.44719928e-02]
mat_Sqrt:  [[ 2.03664439e+01 -8.42735518e-03]
 [-8.42735518e-03  1.93313117e-02]]
grads:  [0.00183203 1.20006751]
Stock Position:  0.0018320340749635221
Bond Position:  [13.45380062]


portfolio before change:  [13.63944608]
curr_Stock_Price:  92.14768350176044
curr_Factors:  [9.21476835e+01 4.92711092e-02]
mat_Sqrt:  [[ 2.04541083e+01 -8.87001550e-03]
 [-8.87001550e-03  2.03478234e-02]]
grads:  [0.01222139 1.31237853]
Stock Position:  0.012221389812344092
Bond Position:  [12.51327332]


portfolio before change:  [13.58192696]
curr_Stock_Price:  86.16059955082768
curr_Factors:  [8.61605996e+01 5.28505992e-02]
mat_Sqrt:  [[ 1.98076806e+01 -9.18593095e-03]
 [-9.18593095e-03  2.10742655e-02]]
grads:  [-1.09987364e-02 -1.90975120e+01]
Stock Position:  -0.010998736437734314
Bond Position:  [14.52958469]


portfolio before change:  [13.5827326]
curr_Stock_Price:  87.73966241631344
curr_Factors:  [8.77396624e+01 5.31110192e-02]
mat_Sqrt:  [[ 2.02203297e+01 -9.20871100e-03]
 [-9.20871100e-03  2.11260463e-02]]
grads:  [ -0.02343787 -16.634368  ]
Stock Position:  -0.023437871969655435
Bond Position:  [15.63916358]


portfolio before change:  [13.71639764]
curr_Stock_Price:  82.8713084265185
curr_Factors:  [8.28713084e+01 6.17661515e-02]
mat_Sqrt:  [[ 2.05958356e+01 -9.93013538e-03]
 [-9.93013538e-03  2.27827550e-02]]
grads:  [ 0.00152011 -0.30521552]
Stock Position:  0.001520109756701806
Bond Position:  [13.59042416]


portfolio before change:  [13.73338113]
curr_Stock_Price:  82.861336605068
curr_Factors:  [8.28613366e+01 5.85727598e-02]
mat_Sqrt:  [[ 2.00539408e+01 -9.67002695e-03]
 [-9.67002695e-03  2.21859906e-02]]
grads:  [-0.01633647 -8.57239688]
Stock Position:  -0.016336467407376435
Bond Position:  [15.08704266]


portfolio before change:  [13.67042037]
curr_Stock_Price:  87.87045847654011
curr_Factors:  [8.78704585e+01 5.42301481e-02]
mat_Sqrt:  [[ 2.04627144e+01 -9.30524036e-03]
 [-9.30524036e-03  2.13474585e-02]]
grads:  [1.04278916e-02 1.57520655e+01]
Stock Position:  0.010427891581403741
Bond Position:  [12.75411676]


portfolio before change:  [13.66383614]
curr_Stock_Price:  85.70925000571353
curr_Factors:  [8.57092500e+01 5.94004492e-02]
mat_Sqrt:  [[ 2.08892339e+01 -9.73846825e-03]
 [-9.73846825e-03  2.23420395e-02]]
grads:  [ 2.62610741e-04 -4.25237066e+00]
Stock Position:  0.0002626107414172259
Bond Position:  [13.64132797]


portfolio before change:  [13.67854234]
curr_Stock_Price:  76.73732812115747
curr_Factors:  [7.67373281e+01 5.32330311e-02]
mat_Sqrt:  [[ 1.77050523e+01 -9.21790311e-03]
 [-9.21790311e-03  2.11509001e-02]]
grads:  [-2.02333956e-03 -9.66776228e+00]
Stock Position:  -0.0020233395632540925
Bond Position:  [13.83380801]


portfolio before change:  [13.70379133]
curr_Stock_Price:  72.81019473320791
curr_Factors:  [7.28101947e+01 5.69509733e-02]
mat_Sqrt:  [[ 1.73757157e+01 -9.53375894e-03]
 [-9.53375894e-03  2.18773210e-02]]
grads:  [-0.01695066 -3.36183524]
Stock Position:  -0.01695066161889039
Bond Position:  [14.93797231]


portfolio before change:  [13.75119841]
curr_Stock_Price:  71.11569244383406
curr_Factors:  [7.11156924e+01 6.06181580e-02]
mat_Sqrt:  [[ 1.75092177e+01 -9.83562465e-03]
 [-9.83562465e-03  2.25708234e-02]]
grads:  [4.30444448e-03 5.77510234e+00]
Stock Position:  0.0043044444829132035
Bond Position:  [13.44508486]


portfolio before change:  [13.76315554]
curr_Stock_Price:  69.98668778872714
curr_Factors:  [6.99866878e+01 5.32017355e-02]
mat_Sqrt:  [[ 1.61427778e+01 -9.21413263e-03]
 [-9.21413263e-03  2.11451440e-02]]
grads:  [6.47029669e-03 1.97533280e+01]
Stock Position:  0.006470296691872217
Bond Position:  [13.3103209]


portfolio before change:  [13.79600418]
curr_Stock_Price:  72.49048882559057
curr_Factors:  [7.24904888e+01 5.21153270e-02]
mat_Sqrt:  [[ 1.65486929e+01 -9.11998064e-03]
 [-9.11998064e-03  2.09279531e-02]]
grads:  [-0.01634587  8.06957119]
Stock Position:  -0.016345874362722848
Bond Position:  [14.9809246]


portfolio before change:  [13.81167828]
curr_Stock_Price:  72.67792200950205
curr_Factors:  [7.26779220e+01 4.93837573e-02]
mat_Sqrt:  [[ 1.61508172e+01 -8.87778580e-03]
 [-8.87778580e-03  2.03721008e-02]]
grads:  [6.95060789e-05 1.73986505e+01]
Stock Position:  6.950607886666909e-05
Bond Position:  [13.80662672]


portfolio before change:  [13.82883732]
curr_Stock_Price:  71.09483949065381
curr_Factors:  [7.10948395e+01 4.80202100e-02]
mat_Sqrt:  [[ 1.55793752e+01 -8.75411893e-03]
 [-8.75411893e-03  2.00889896e-02]]
grads:  [ -0.01156031 -10.70434283]
Stock Position:  -0.011560309301973637
Bond Position:  [14.65071566]


portfolio before change:  [13.79705618]
curr_Stock_Price:  75.42915159950606
curr_Factors:  [7.54291516e+01 4.96666941e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.79705618]
Stock Price:  76.19934733307535
PL:  [13.79705618]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.70175226e-01  4.26987278e-03]
 [ 3.22277894e-02 -3.82287840e-02]
 [ 4.14408540e-02  1.18371980e-01]
 [-9.21435687e-02 -4.78110849e-02]
 [ 2.59285030e-02  1.63039873e-02]
 [ 7.96437624e-02  1.54862761e-02]
 [ 2.74189626e-02  4.60831376e-02]
 [-3.19079597e-01  5.50488975e-02]
 [ 8.17084220e-02  7.42671252e-02]
 [ 6.10514790e-02 -3.56094963e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 1.96268672e-01  8.29625044e-03]
 [ 2.50369542e-02  1.93495426e-01]
 [-7.60925174e-02 -9.42614628e-02]
 [ 1.80572119e-02 -1.23233855e-01]
 [ 2.18663698e-01 -1.63504902e-01]
 [ 9.23064910e-02 -1.49783833e-01]
 [ 3.62920288e-04  3.73065827e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.257946]
curr_Stock_Price:  97.95044748218604
curr_Factors:  [9.79504475e+01 4.60586146e-02]
mat_Sqrt:  [[ 2.10214091e+01 -8.57648267e-03]
 [-8.57648267e-03  1.96730804e-02]]
grads:  [0.00818534 0.22060979]
Stock Position:  0.008185335335376156
Bond Position:  [-2.05970326]


portfolio before change:  [-1.24827553]
curr_Stock_Price:  99.44662419963197
curr_Factors:  [9.94466242e+01 4.46039009e-02]
mat_Sqrt:  [[ 2.10027630e+01 -8.44007507e-03]
 [-8.44007507e-03  1.93598590e-02]]
grads:  [ 7.41064039e-04 -1.97431858e+00]
Stock Position:  0.000741064038659915
Bond Position:  [-1.32197185]


portfolio before change:  [-1.25564569]
curr_Stock_Price:  91.73250527235857
curr_Factors:  [9.17325053e+01 4.99740082e-02]
mat_Sqrt:  [[ 2.05066777e+01 -8.93302085e-03]
 [-8.93302085e-03  2.04924674e-02]]
grads:  [4.53798121e-03 5.77834362e+00]
Stock Position:  0.004537981209743986
Bond Position:  [-1.67192607]


portfolio before change:  [-1.24420841]
curr_Stock_Price:  94.71367496141536
curr_Factors:  [9.47136750e+01 5.34049621e-02]
mat_Sqrt:  [[ 2.18878677e+01 -9.23486834e-03]
 [-9.23486834e-03  2.11841174e-02]]
grads:  [-0.00516299 -2.25918142]
Stock Position:  -0.005162988611822005
Bond Position:  [-0.75520279]


portfolio before change:  [-1.23889179]
curr_Stock_Price:  93.50096439949911
curr_Factors:  [9.35009644e+01 4.28799832e-02]
mat_Sqrt:  [[ 1.93616941e+01 -8.27488104e-03]
 [-8.27488104e-03  1.89822595e-02]]
grads:  [0.00170657 0.85965051]
Stock Position:  0.0017065659911232696
Bond Position:  [-1.39845736]


portfolio before change:  [-1.23694337]
curr_Stock_Price:  95.66764623232521
curr_Factors:  [9.56676462e+01 4.28178927e-02]
mat_Sqrt:  [[ 1.97960114e+01 -8.26907126e-03]
 [-8.26907126e-03  1.89684313e-02]]
grads:  [0.00436505 0.81832655]
Stock Position:  0.0043650491584589874
Bond Position:  [-1.65453735]


portfolio before change:  [-1.22378397]
curr_Stock_Price:  99.1564657614425
curr_Factors:  [9.91564658e+01 4.35746788e-02]
mat_Sqrt:  [[ 2.06984632e+01 -8.34210813e-03]
 [-8.34210813e-03  1.91352037e-02]]
grads:  [2.29570353e-03 2.40929176e+00]
Stock Position:  0.002295703534134869
Bond Position:  [-1.45141782]


portfolio before change:  [-1.21148139]
curr_Stock_Price:  105.30620858717889
curr_Factors:  [1.05306209e+02 4.33345584e-02]
mat_Sqrt:  [[ 2.19215437e+01 -8.31954032e-03]
 [-8.31954032e-03  1.90822125e-02]]
grads:  [-0.01346292  2.87895821]
Stock Position:  -0.013462919992866541
Bond Position:  [0.20624767]


portfolio before change:  [-1.1840986]
curr_Stock_Price:  103.29142906448463
curr_Factors:  [1.03291429e+02 4.42644104e-02]
mat_Sqrt:  [[ 2.17315946e+01 -8.40818227e-03]
 [-8.40818227e-03  1.92859165e-02]]
grads:  [0.00525071 3.85313678]
Stock Position:  0.005250709865330001
Bond Position:  [-1.72645193]


portfolio before change:  [-1.16560037]
curr_Stock_Price:  107.22568695385603
curr_Factors:  [1.07225687e+02 3.76373049e-02]
mat_Sqrt:  [[ 2.08021424e+01 -7.75350665e-03]
 [-7.75350665e-03  1.77835931e-02]]
grads:  [ 0.00218888 -2.00142483]
Stock Position:  0.002188881188838183
Bond Position:  [-1.40030466]


portfolio before change:  [-1.15786325]
curr_Stock_Price:  111.56059460508624
curr_Factors:  [1.11560595e+02 3.57594874e-02]
mat_Sqrt:  [[ 2.10963069e+01 -7.55786207e-03]
 [-7.55786207e-03  1.73341742e-02]]
grads:  [ 4.55018109e-04 -7.05822294e+00]
Stock Position:  0.00045501810922283874
Bond Position:  [-1.20862534]


portfolio before change:  [-1.15834156]
curr_Stock_Price:  113.83175316227369
curr_Factors:  [1.13831753e+02 3.51489330e-02]
mat_Sqrt:  [[ 2.13412312e+01 -7.49318588e-03]
 [-7.49318588e-03  1.71855025e-02]]
grads:  [0.00936762 0.48683149]
Stock Position:  0.009367622200580338
Bond Position:  [-2.22467441]


portfolio before change:  [-1.08376993]
curr_Stock_Price:  122.08936692633945
curr_Factors:  [1.22089367e+02 2.69331893e-02]
mat_Sqrt:  [[ 2.00364931e+01 -6.55960911e-03]
 [-6.55960911e-03  1.50433846e-02]]
grads:  [5.46131000e-03 1.28648741e+01]
Stock Position:  0.0054613099967074025
Bond Position:  [-1.75053781]


portfolio before change:  [-1.06329477]
curr_Stock_Price:  126.23941623498334
curr_Factors:  [1.26239416e+02 2.48697956e-02]
mat_Sqrt:  [[ 1.99081573e+01 -6.30348739e-03]
 [-6.30348739e-03  1.44555872e-02]]
grads:  [-5.88764938e-03 -6.52333066e+00]
Stock Position:  -0.005887649375899186
Bond Position:  [-0.32004135]


portfolio before change:  [-1.02171923]
curr_Stock_Price:  119.10994356632538
curr_Factors:  [1.19109944e+02 2.92168962e-02]
mat_Sqrt:  [[ 2.03594027e+01 -6.83192292e-03]
 [-6.83192292e-03  1.56682415e-02]]
grads:  [-1.75262756e-03 -7.86596436e+00]
Stock Position:  -0.0017526275580451633
Bond Position:  [-0.81296386]


portfolio before change:  [-1.02446363]
curr_Stock_Price:  120.09563810977617
curr_Factors:  [1.20095638e+02 2.99461641e-02]
mat_Sqrt:  [[ 2.07825010e+01 -6.91670511e-03]
 [-6.91670511e-03  1.58625607e-02]]
grads:  [ 7.09204681e-03 -1.03045058e+01]
Stock Position:  0.007092046813610473
Bond Position:  [-1.87618752]


portfolio before change:  [-1.06469183]
curr_Stock_Price:  114.75423283975846
curr_Factors:  [1.14754233e+02 3.38506415e-02]
mat_Sqrt:  [[ 2.11131065e+01 -7.35354398e-03]
 [-7.35354398e-03  1.68651062e-02]]
grads:  [ 1.27890529e-03 -8.88072846e+00]
Stock Position:  0.0012789052938117136
Bond Position:  [-1.21145162]


portfolio before change:  [-1.07932699]
curr_Stock_Price:  104.49553681331469
curr_Factors:  [1.04495537e+02 3.52236341e-02]
mat_Sqrt:  [[ 1.96116796e+01 -7.50060498e-03]
 [-7.50060498e-03  1.72039898e-02]]
grads:  [8.47996609e-04 2.16885406e+00]
Stock Position:  0.0008479966091725174
Bond Position:  [-1.16793885]


portfolio before change:  [-1.07555197]
curr_Stock_Price:  110.66992231341042
curr_Factors:  [1.10669922e+02 3.32518127e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.07555197]
Stock Price:  113.89582083069914
PL:  [-14.9713728]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 5.23297095e-02 -3.81355055e-02]
 [ 8.35123080e-03 -8.17737950e-02]
 [ 6.34845847e-02  5.36211340e-02]
 [-1.60346351e-02 -7.16677216e-03]
 [-1.99551003e-01 -4.87658171e-03]
 [ 1.27257621e-01  1.28774338e-01]
 [ 2.47479878e-02  4.26308480e-02]
 [-1.74118660e-01  7.73570763e-02]
 [ 7.58763061e-02  6.72845633e-02]
 [ 6.53850081e-02 -5.17484002e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 1.40271129e-02  3.36505825e-02]
 [ 2.80853392e-02  7.54827609e-02]
 [-1.82679214e-02 -1.94009443e-01]
 [-3.22477266e-02 -9.54961045e-02]
 [ 1.56822328e-01 -8.75438957e-02]
 [ 6.24441564e-02 -1.50080212e-01]
 [-4.14271269e-02  3.80037326e-02]
 [-8.94265706e-02 -8.17100612e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.2013712]
curr_Stock_Price:  99.14235997457088
curr_Factors:  [9.91423600e+01 3.75416888e-02]
mat_Sqrt:  [[ 1.92095026e+01 -7.74311239e-03]
 [-7.74311239e-03  1.77612246e-02]]
grads:  [ 1.85900610e-03 -2.14631096e+00]
Stock Position:  0.001859006100157622
Bond Position:  [3.01706495]


portfolio before change:  [3.2109768]
curr_Stock_Price:  102.27946911448329
curr_Factors:  [1.02279469e+02 3.64154180e-02]
mat_Sqrt:  [[ 1.95178098e+01 -7.62629526e-03]
 [-7.62629526e-03  1.74926785e-02]]
grads:  [-1.39894790e-03 -4.67535397e+00]
Stock Position:  -0.0013989479007396493
Bond Position:  [3.35406045]


portfolio before change:  [3.22103564]
curr_Stock_Price:  98.08800135819546
curr_Factors:  [9.80880014e+01 3.95423246e-02]
mat_Sqrt:  [[ 1.95050446e+01 -7.94667491e-03]
 [-7.94667491e-03  1.82283736e-02]]
grads:  [0.00445404 2.94357193]
Stock Position:  0.00445403718091299
Bond Position:  [2.78414803]


portfolio before change:  [3.2365617]
curr_Stock_Price:  100.79199667413668
curr_Factors:  [1.00791997e+02 3.22162007e-02]
mat_Sqrt:  [[ 1.80910251e+01 -7.17302572e-03]
 [-7.17302572e-03  1.64532583e-02]]
grads:  [-0.00105922 -0.43604554]
Stock Position:  -0.0010592214059510587
Bond Position:  [3.34332274]


portfolio before change:  [3.24475557]
curr_Stock_Price:  97.00420529331666
curr_Factors:  [9.70042053e+01 3.51260610e-02]
mat_Sqrt:  [[ 1.81804761e+01 -7.48970210e-03]
 [-7.48970210e-03  1.71803659e-02]]
grads:  [-0.01109504 -0.28868304]
Stock Position:  -0.011095042406630434
Bond Position:  [4.32102134]


portfolio before change:  [3.21354512]
curr_Stock_Price:  100.30433765478053
curr_Factors:  [1.00304338e+02 3.17668539e-02]
mat_Sqrt:  [[ 1.78774999e+01 -7.12279445e-03]
 [-7.12279445e-03  1.63381253e-02]]
grads:  [0.01026039 7.88630386]
Stock Position:  0.010260391219086066
Bond Position:  [2.18438337]


portfolio before change:  [3.21680588]
curr_Stock_Price:  100.35585376775988
curr_Factors:  [1.00355854e+02 3.20019453e-02]
mat_Sqrt:  [[ 1.79527451e+01 -7.14910542e-03]
 [-7.14910542e-03  1.63984677e-02]]
grads:  [2.41416746e-03 2.60073732e+00]
Stock Position:  0.0024141674613436456
Bond Position:  [2.97453004]


portfolio before change:  [3.22469534]
curr_Stock_Price:  102.08273299310041
curr_Factors:  [1.02082733e+02 3.28254915e-02]
mat_Sqrt:  [[ 1.84951507e+01 -7.24062133e-03]
 [-7.24062133e-03  1.66080799e-02]]
grads:  [-0.00759211  4.65448777]
Stock Position:  -0.007592113127364307
Bond Position:  [3.999719]


portfolio before change:  [3.20871343]
curr_Stock_Price:  104.84674472599171
curr_Factors:  [1.04846745e+02 3.14292466e-02]
mat_Sqrt:  [[ 1.85875395e+01 -7.08512430e-03]
 [-7.08512430e-03  1.62509532e-02]]
grads:  [0.00566125 4.14281385]
Stock Position:  0.005661247256223679
Bond Position:  [2.61515008]


portfolio before change:  [3.2015883]
curr_Stock_Price:  103.01038154600592
curr_Factors:  [1.03010382e+02 3.34519714e-02]
mat_Sqrt:  [[ 1.88404739e+01 -7.30944805e-03]
 [-7.30944805e-03  1.67657891e-02]]
grads:  [ 2.27336617e-03 -3.08555613e+00]
Stock Position:  0.002273366169271559
Bond Position:  [2.96740799]


portfolio before change:  [3.20966997]
curr_Stock_Price:  104.93268100084485
curr_Factors:  [1.04932681e+02 3.76265346e-02]
mat_Sqrt:  [[ 2.03543786e+01 -7.75225250e-03]
 [-7.75225250e-03  1.77811115e-02]]
grads:  [ 4.71770180e-04 -6.88079861e+00]
Stock Position:  0.00047177017960251823
Bond Position:  [3.16016586]


portfolio before change:  [3.21466815]
curr_Stock_Price:  107.14879577709807
curr_Factors:  [1.07148796e+02 3.87149259e-02]
mat_Sqrt:  [[ 2.10827122e+01 -7.86371662e-03]
 [-7.86371662e-03  1.80363860e-02]]
grads:  [1.36145477e-03 1.86629897e+00]
Stock Position:  0.0013614547716121342
Bond Position:  [3.06878991]


portfolio before change:  [3.22315146]
curr_Stock_Price:  110.56053466135053
curr_Factors:  [1.10560535e+02 3.68802193e-02]
mat_Sqrt:  [[ 2.12322906e+01 -7.67532619e-03]
 [-7.67532619e-03  1.76037371e-02]]
grads:  [2.87325822e-03 4.28913552e+00]
Stock Position:  0.0028732582205536856
Bond Position:  [2.9054825]


portfolio before change:  [3.23310243]
curr_Stock_Price:  112.75903017559504
curr_Factors:  [1.12759030e+02 3.22238787e-02]
mat_Sqrt:  [[ 2.02413843e+01 -7.17457229e-03]
 [-7.17457229e-03  1.64549172e-02]]
grads:  [-5.08239104e-03 -1.17925788e+01]
Stock Position:  -0.005082391035660605
Bond Position:  [3.80618791]


portfolio before change:  [3.24355978]
curr_Stock_Price:  111.6381726180626
curr_Factors:  [1.11638173e+02 3.24071726e-02]
mat_Sqrt:  [[ 2.00970939e+01 -7.19488967e-03]
 [-7.19488967e-03  1.65016753e-02]]
grads:  [-3.67697363e-03 -5.78865830e+00]
Stock Position:  -0.003676973625736352
Bond Position:  [3.65405039]


portfolio before change:  [3.25261597]
curr_Stock_Price:  110.41820978713216
curr_Factors:  [1.10418210e+02 3.51004966e-02]
mat_Sqrt:  [[ 2.06869900e+01 -7.48783492e-03]
 [-7.48783492e-03  1.71737385e-02]]
grads:  [ 0.00573653 -5.09504331]
Stock Position:  0.005736527421423802
Bond Position:  [2.61919888]


portfolio before change:  [3.24826902]
curr_Stock_Price:  109.08935847103461
curr_Factors:  [1.09089358e+02 3.50432741e-02]
mat_Sqrt:  [[ 2.04213616e+01 -7.48165332e-03]
 [-7.48165332e-03  1.71597670e-02]]
grads:  [-1.46476472e-04 -8.74611568e+00]
Stock Position:  -0.00014647647207641256
Bond Position:  [3.26424804]


portfolio before change:  [3.25229896]
curr_Stock_Price:  109.45064945511693
curr_Factors:  [1.09450649e+02 3.16814883e-02]
mat_Sqrt:  [[ 1.94814421e+01 -7.11376041e-03]
 [-7.11376041e-03  1.63159216e-02]]
grads:  [-1.27615883e-03  2.32868577e+00]
Stock Position:  -0.001276158825469865
Bond Position:  [3.39197537]


portfolio before change:  [3.25199075]
curr_Stock_Price:  113.01669021480738
curr_Factors:  [1.13016690e+02 2.82266071e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.25199075]
Stock Price:  117.7800287019926
PL:  [-14.52803795]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.52848703e-01 -4.70293997e-03]
 [-2.45208032e-01  9.49888476e-02]
 [ 5.49340563e-02  7.90349505e-02]
 [-5.71262772e-01 -2.92008961e-01]
 [ 4.67311411e-01  4.46701919e-02]
 [ 3.15510256e-02 -1.23983280e-01]
 [-1.66794953e-01 -2.15275577e-01]
 [ 3.32973858e-02 -1.14886352e-02]
 [-2.38666591e-02 -2.41331371e-02]
 [ 4.67061176e-02  7.27284001e-02]
 [ 6.31820099e-02 -1.20910858e-01]
 [-1.06576698e-02  3.95616681e-02]
 [-6.75797238e-02 -1.28342049e-01]
 [ 1.18742976e-02  5.19872111e-03]
 [-5.47100621e-02 -9.56609373e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 2.40590207e-02 -1.33766638e-01]
 [ 2.51519316e-02  4.39558853e-02]
 [-8.39848807e-02 -7.85020875e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.86077779]
curr_Stock_Price:  96.18560382512985
curr_Factors:  [9.61856038e+01 4.37569920e-02]
mat_Sqrt:  [[ 2.01202683e+01 -8.35930282e-03]
 [-8.35930282e-03  1.91752960e-02]]
grads:  [ 0.00749621 -0.24199245]
Stock Position:  0.007496212901868219
Bond Position:  [-8.58180555]


portfolio before change:  [-7.91853697]
curr_Stock_Price:  89.91240708286624
curr_Factors:  [8.99124071e+01 5.04302619e-02]
mat_Sqrt:  [[ 2.01913424e+01 -8.97352529e-03]
 [-8.97352529e-03  2.05858802e-02]]
grads:  [-0.01009548  4.60987117]
Stock Position:  -0.010095477171554483
Bond Position:  [-7.01082832]


portfolio before change:  [-7.98525473]
curr_Stock_Price:  95.65247725700227
curr_Factors:  [9.56524773e+01 4.74537707e-02]
mat_Sqrt:  [[ 2.08368252e+01 -8.70521272e-03]
 [-8.70521272e-03  1.99689003e-02]]
grads:  [0.00429071 3.95977249]
Stock Position:  0.004290707310459713
Bond Position:  [-8.39567152]


portfolio before change:  [-8.02285871]
curr_Stock_Price:  89.33584281400448
curr_Factors:  [8.93358428e+01 4.77802913e-02]
mat_Sqrt:  [[ 1.95276549e+01 -8.73451955e-03]
 [-8.73451955e-03  2.00377414e-02]]
grads:  [ -0.03577934 -14.58854421]
Stock Position:  -0.03577934468385979
Bond Position:  [-4.8264808]


portfolio before change:  [-8.04161165]
curr_Stock_Price:  89.69124528913133
curr_Factors:  [8.96912453e+01 4.63831283e-02]
mat_Sqrt:  [[ 1.93165707e+01 -8.60590221e-03]
 [-8.60590221e-03  1.97425867e-02]]
grads:  [0.0252052  2.27361824]
Stock Position:  0.025205195786174354
Bond Position:  [-10.30229705]


portfolio before change:  [-7.99284485]
curr_Stock_Price:  92.13727779199246
curr_Factors:  [9.21372778e+01 4.80735656e-02]
mat_Sqrt:  [[ 2.02017272e+01 -8.76155775e-03]
 [-8.76155775e-03  2.00990239e-02]]
grads:  [-1.11376446e-03 -6.16910749e+00]
Stock Position:  -0.0011137644610622183
Bond Position:  [-7.89022562]


portfolio before change:  [-8.00195707]
curr_Stock_Price:  91.45784615665406
curr_Factors:  [9.14578462e+01 4.38575974e-02]
mat_Sqrt:  [[ 1.91532883e+01 -8.36849521e-03]
 [-8.36849521e-03  1.91975066e-02]]
grads:  [ -0.01361054 -11.21965892]
Stock Position:  -0.013610540951133615
Bond Position:  [-6.75716631]


portfolio before change:  [-8.05961689]
curr_Stock_Price:  95.07328475602965
curr_Factors:  [9.50732848e+01 4.00481403e-02]
mat_Sqrt:  [[ 1.90260940e+01 -7.99710260e-03]
 [-7.99710260e-03  1.83446928e-02]]
grads:  [ 0.00148713 -0.6256165 ]
Stock Position:  0.0014871295460731513
Bond Position:  [-8.20100318]


portfolio before change:  [-8.07004151]
curr_Stock_Price:  94.96101693101873
curr_Factors:  [9.49610169e+01 4.34786097e-02]
mat_Sqrt:  [[ 1.98008185e+01 -8.33256712e-03]
 [-8.33256712e-03  1.91142466e-02]]
grads:  [-0.00173697 -1.26333049]
Stock Position:  -0.001736970884725017
Bond Position:  [-7.90509698]


portfolio before change:  [-8.08161102]
curr_Stock_Price:  95.92934945547071
curr_Factors:  [9.59293495e+01 4.14719125e-02]
mat_Sqrt:  [[ 1.95356782e+01 -8.13808564e-03]
 [-8.13808564e-03  1.86679053e-02]]
grads:  [0.00401448 3.89765585]
Stock Position:  0.0040144792411333195
Bond Position:  [-8.4667174]


portfolio before change:  [-8.07891931]
curr_Stock_Price:  99.23780564926709
curr_Factors:  [9.92378056e+01 4.30987501e-02]
mat_Sqrt:  [[ 2.06020034e+01 -8.29643250e-03]
 [-8.29643250e-03  1.90304153e-02]]
grads:  [ 5.08299042e-04 -6.35333697e+00]
Stock Position:  0.0005082990423018343
Bond Position:  [-8.12936179]


portfolio before change:  [-8.08910723]
curr_Stock_Price:  99.1987159340605
curr_Factors:  [9.91987159e+01 4.05203434e-02]
mat_Sqrt:  [[ 1.99683681e+01 -8.04443315e-03]
 [-8.04443315e-03  1.84523855e-02]]
grads:  [3.30054265e-04 2.14413054e+00]
Stock Position:  0.0003300542647985633
Bond Position:  [-8.12184819]


portfolio before change:  [-8.098858]
curr_Stock_Price:  100.43453759371997
curr_Factors:  [1.00434538e+02 3.71396636e-02]
mat_Sqrt:  [[ 1.93553947e+01 -7.70163275e-03]
 [-7.70163275e-03  1.76658283e-02]]
grads:  [-6.38341073e-03 -7.26777198e+00]
Stock Position:  -0.006383410728311711
Bond Position:  [-7.4577431]


portfolio before change:  [-8.12153075]
curr_Stock_Price:  102.52507277649894
curr_Factors:  [1.02525073e+02 3.26772809e-02]
mat_Sqrt:  [[ 1.85333108e+01 -7.22428471e-03]
 [-7.22428471e-03  1.65705317e-02]]
grads:  [0.00076312 0.31406561]
Stock Position:  0.0007631230685473942
Bond Position:  [-8.19977]


portfolio before change:  [-8.1331739]
curr_Stock_Price:  100.70751061760541
curr_Factors:  [1.00707511e+02 3.40048617e-02]
mat_Sqrt:  [[ 1.85708736e+01 -7.36945553e-03]
 [-7.36945553e-03  1.69038381e-02]]
grads:  [-5.19261609e-03 -5.66138906e+00]
Stock Position:  -0.005192616093708433
Bond Position:  [-7.61023846]


portfolio before change:  [-8.16547249]
curr_Stock_Price:  105.09447880076208
curr_Factors:  [1.05094479e+02 3.33664418e-02]
mat_Sqrt:  [[ 1.91970642e+01 -7.30022642e-03]
 [-7.30022642e-03  1.67442859e-02]]
grads:  [ 0.00565982 -3.64316678]
Stock Position:  0.005659819676407019
Bond Position:  [-8.76028829]


portfolio before change:  [-8.1919407]
curr_Stock_Price:  102.35393010850623
curr_Factors:  [1.02353930e+02 3.52724156e-02]
mat_Sqrt:  [[ 1.92230410e+01 -7.50565936e-03]
 [-7.50565936e-03  1.72159587e-02]]
grads:  [-1.78250632e-03 -7.77069809e+00]
Stock Position:  -0.0017825063234811795
Bond Position:  [-8.00949418]


portfolio before change:  [-8.20115726]
curr_Stock_Price:  101.90424196313631
curr_Factors:  [1.01904242e+02 3.59645449e-02]
mat_Sqrt:  [[ 1.93254455e+01 -7.57891120e-03]
 [-7.57891120e-03  1.73840604e-02]]
grads:  [2.29350017e-03 2.52951650e+00]
Stock Position:  0.002293500173759348
Bond Position:  [-8.43487466]


portfolio before change:  [-8.20912326]
curr_Stock_Price:  103.03098651036856
curr_Factors:  [1.03030987e+02 2.85911710e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.20912326]
Stock Price:  99.04672650494943
PL:  [-8.20912326]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 4.68235416e-02 -4.01183853e-02]
 [ 3.93698205e-02 -2.21145941e-02]
 [ 6.67331005e-02  4.39652885e-02]
 [ 9.70008418e-03  1.58774001e-02]
 [-1.57681590e-01 -5.54213574e-02]
 [ 1.28463306e-01  1.09441008e-01]
 [ 2.63708265e-02  4.47284003e-02]
 [-2.15323045e-01  7.10059978e-02]
 [ 6.35481582e-02  5.29092527e-02]
 [ 6.05052772e-02 -3.04340255e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 1.55552206e-01  1.41006431e-02]
 [ 2.27759834e-02  1.04060322e-01]
 [-3.41463291e-02 -1.66619038e-01]
 [ 2.64953665e-04 -1.13423343e-01]
 [ 1.71574615e-01 -1.05664429e-01]
 [ 8.30461598e-02 -1.47349004e-01]
 [-1.21202540e-01  4.61266179e-02]
 [-1.13535595e-01 -1.30390301e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.39493822]
curr_Stock_Price:  99.194097703219
curr_Factors:  [9.91940977e+01 4.23661360e-02]
mat_Sqrt:  [[ 2.04171549e+01 -8.22561348e-03]
 [-8.22561348e-03  1.88679793e-02]]
grads:  [ 1.43696974e-03 -2.12564179e+00]
Stock Position:  0.001436969739534109
Bond Position:  [3.2523993]


portfolio before change:  [3.39867936]
curr_Stock_Price:  98.96660471409243
curr_Factors:  [9.89666047e+01 4.19179763e-02]
mat_Sqrt:  [[ 2.02623023e+01 -8.18197414e-03]
 [-8.18197414e-03  1.87679264e-02]]
grads:  [ 0.00146746 -1.17767871]
Stock Position:  0.001467458304245273
Bond Position:  [3.25344999]


portfolio before change:  [3.40281721]
curr_Stock_Price:  99.0132802319153
curr_Factors:  [9.90132802e+01 4.40232084e-02]
mat_Sqrt:  [[ 2.07746760e+01 -8.38492115e-03]
 [-8.38492115e-03  1.92334391e-02]]
grads:  [0.00413557 2.28768056]
Stock Position:  0.004135569755026665
Bond Position:  [2.99334088]


portfolio before change:  [3.40505646]
curr_Stock_Price:  98.6494217178619
curr_Factors:  [9.86494217e+01 4.55837507e-02]
mat_Sqrt:  [[ 2.10619965e+01 -8.53221292e-03]
 [-8.53221292e-03  1.95713783e-02]]
grads:  [7.89328306e-04 8.11600215e-01]
Stock Position:  0.0007893283055467197
Bond Position:  [3.32718968]


portfolio before change:  [3.41028756]
curr_Stock_Price:  100.00438383933384
curr_Factors:  [1.00004384e+02 4.33337530e-02]
mat_Sqrt:  [[ 2.08176717e+01 -8.31907942e-03]
 [-8.31907942e-03  1.90822024e-02]]
grads:  [-0.00873656 -2.90815685]
Stock Position:  -0.00873655711626794
Bond Position:  [4.28398157]


portfolio before change:  [3.38778522]
curr_Stock_Price:  103.1933587017517
curr_Factors:  [1.03193359e+02 4.03374639e-02]
mat_Sqrt:  [[ 2.07255474e+01 -8.02654611e-03]
 [-8.02654611e-03  1.84105730e-02]]
grads:  [0.0085019  5.94817167]
Stock Position:  0.008501902335827689
Bond Position:  [2.51044537]


portfolio before change:  [3.37143245]
curr_Stock_Price:  100.9006017276239
curr_Factors:  [1.00900602e+02 4.39026482e-02]
mat_Sqrt:  [[ 2.11416598e+01 -8.37357684e-03]
 [-8.37357684e-03  1.92070220e-02]]
grads:  [2.17006313e-03 2.32969856e+00]
Stock Position:  0.002170063129367415
Bond Position:  [3.15247177]


portfolio before change:  [3.37919858]
curr_Stock_Price:  102.66233842870741
curr_Factors:  [1.02662338e+02 4.19162196e-02]
mat_Sqrt:  [[ 2.10185220e+01 -8.18207525e-03]
 [-8.18207525e-03  1.87674143e-02]]
grads:  [-0.0087731   3.77964777]
Stock Position:  -0.008773104187432738
Bond Position:  [4.27986597]


portfolio before change:  [3.35162459]
curr_Stock_Price:  106.41553329501109
curr_Factors:  [1.06415533e+02 4.08216892e-02]
mat_Sqrt:  [[ 2.15005951e+01 -8.07479614e-03]
 [-8.07479614e-03  1.85206522e-02]]
grads:  [0.0040292  2.85852717]
Stock Position:  0.0040291992797358
Bond Position:  [2.9228552]


portfolio before change:  [3.37352096]
curr_Stock_Price:  110.94261580334975
curr_Factors:  [1.10942616e+02 4.09493256e-02]
mat_Sqrt:  [[ 2.24502794e+01 -8.08769399e-03]
 [-8.08769399e-03  1.85494599e-02]]
grads:  [ 0.00210435 -1.63977854]
Stock Position:  0.0021043502124081606
Bond Position:  [3.14005884]


portfolio before change:  [3.3766111]
curr_Stock_Price:  110.54468216378568
curr_Factors:  [1.10544682e+02 4.61040664e-02]
mat_Sqrt:  [[ 2.37359951e+01 -8.58162749e-03]
 [-8.58162749e-03  1.96823864e-02]]
grads:  [ 4.04436153e-04 -6.21613821e+00]
Stock Position:  0.0004044361526987202
Bond Position:  [3.33190283]


portfolio before change:  [3.38151487]
curr_Stock_Price:  112.36522986561312
curr_Factors:  [1.12365230e+02 4.95088074e-02]
mat_Sqrt:  [[ 2.50019078e+01 -8.89297569e-03]
 [-8.89297569e-03  2.03961530e-02]]
grads:  [0.00646852 0.69415872]
Stock Position:  0.006468520062198437
Bond Position:  [2.65467813]


portfolio before change:  [3.39098681]
curr_Stock_Price:  113.31622276596974
curr_Factors:  [1.13316223e+02 4.64129628e-02]
mat_Sqrt:  [[ 2.44124692e+01 -8.61050236e-03]
 [-8.61050236e-03  1.97481360e-02]]
grads:  [2.79195132e-03 5.27059170e+00]
Stock Position:  0.0027919513196846763
Bond Position:  [3.07461343]


portfolio before change:  [3.40358183]
curr_Stock_Price:  116.44999888541838
curr_Factors:  [1.16449999e+02 5.06504630e-02]
mat_Sqrt:  [[ 2.62078366e+01 -8.99518294e-03]
 [-8.99518294e-03  2.06298646e-02]]
grads:  [-4.07560361e-03 -8.07837095e+00]
Stock Position:  -0.004075603610991593
Bond Position:  [3.87818587]


portfolio before change:  [3.40825349]
curr_Stock_Price:  116.49394490631505
curr_Factors:  [1.16493945e+02 5.17077209e-02]
mat_Sqrt:  [[ 2.64899430e+01 -9.08858173e-03]
 [-9.08858173e-03  2.08440613e-02]]
grads:  [-1.85723657e-03 -5.44232820e+00]
Stock Position:  -0.0018572365705968948
Bond Position:  [3.6246103]


portfolio before change:  [3.42005827]
curr_Stock_Price:  112.57889153993432
curr_Factors:  [1.12578892e+02 5.46454827e-02]
mat_Sqrt:  [[ 2.63168602e+01 -9.34294254e-03]
 [-9.34294254e-03  2.14281182e-02]]
grads:  [ 4.76967837e-03 -4.92903131e+00]
Stock Position:  0.004769678372706421
Bond Position:  [2.88309316]


portfolio before change:  [3.43689078]
curr_Stock_Price:  115.35190817400772
curr_Factors:  [1.15351908e+02 5.92361650e-02]
mat_Sqrt:  [[ 2.80749004e+01 -9.72766275e-03]
 [-9.72766275e-03  2.23099580e-02]]
grads:  [ 6.69686901e-04 -6.60433738e+00]
Stock Position:  0.0006696869013571049
Bond Position:  [3.35964112]


portfolio before change:  [3.44540115]
curr_Stock_Price:  121.78504451475354
curr_Factors:  [1.21785045e+02 5.77561310e-02]
mat_Sqrt:  [[ 2.92679957e+01 -9.60577260e-03]
 [-9.60577260e-03  2.20293087e-02]]
grads:  [-0.00345441  2.09236868]
Stock Position:  -0.003454412215571772
Bond Position:  [3.86609689]


portfolio before change:  [3.44886779]
curr_Stock_Price:  122.18134789430327
curr_Factors:  [1.22181348e+02 4.91262782e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.44886779]
Stock Price:  118.2664902444916
PL:  [-14.81762245]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.37149719e-01 -1.71054842e-02]
 [ 9.46304476e-03  4.20217766e-02]
 [ 5.78185050e-02  7.04623305e-02]
 [ 2.36426805e-02  2.30359480e-02]
 [-9.61446810e-02 -7.31384243e-02]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-2.90002945e-01  4.84311468e-02]
 [ 5.01508326e-02  4.01144150e-02]
 [ 7.13301598e-02 -5.05605068e-02]
 [ 9.69694804e-02 -1.16928729e-01]
 [ 5.35272746e-01 -3.98174314e-02]
 [ 4.11542394e-02  2.27594649e-01]
 [-7.76608145e-02 -9.15561353e-02]
 [ 1.31962396e-01 -1.66304039e-01]
 [ 2.72084151e-01 -2.29122326e-01]
 [ 1.70409107e-01 -1.49826841e-01]
 [-9.22557379e-02  4.31923791e-02]
 [-1.07438544e-01 -1.18048380e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.79071741]
curr_Stock_Price:  94.60061473706887
curr_Factors:  [9.46006147e+01 4.52117071e-02]
mat_Sqrt:  [[ 2.01149692e+01 -8.49698504e-03]
 [-8.49698504e-03  1.94914934e-02]]
grads:  [ 0.00644877 -0.87477592]
Stock Position:  0.006448767565823171
Bond Position:  [-14.40077478]


portfolio before change:  [-13.79288653]
curr_Stock_Price:  97.05737848879279
curr_Factors:  [9.70573785e+01 4.34196785e-02]
mat_Sqrt:  [[ 2.02242219e+01 -8.32709164e-03]
 [-8.32709164e-03  1.91012128e-02]]
grads:  [1.37395869e-03 2.20055230e+00]
Stock Position:  0.0013739586884549161
Bond Position:  [-13.92623936]


portfolio before change:  [-13.81110662]
curr_Stock_Price:  96.47410136599905
curr_Factors:  [9.64741014e+01 3.86574052e-02]
mat_Sqrt:  [[ 1.89682408e+01 -7.85712957e-03]
 [-7.85712957e-03  1.80233062e-02]]
grads:  [0.00466844 3.91154709]
Stock Position:  0.0046684370047033845
Bond Position:  [-14.26148988]


portfolio before change:  [-13.8258271]
curr_Stock_Price:  97.14188890941166
curr_Factors:  [9.71418889e+01 3.96821971e-02]
mat_Sqrt:  [[ 1.93510423e+01 -7.96064494e-03]
 [-7.96064494e-03  1.82606162e-02]]
grads:  [0.00174105 1.2622689 ]
Stock Position:  0.0017410511789764194
Bond Position:  [-13.9949561]


portfolio before change:  [-13.83662068]
curr_Stock_Price:  100.99648727709189
curr_Factors:  [1.00996487e+02 4.15318736e-02]
mat_Sqrt:  [[ 2.05824466e+01 -8.14435673e-03]
 [-8.14435673e-03  1.86812256e-02]]
grads:  [-0.00622144 -3.91778867]
Stock Position:  -0.0062214445182527615
Bond Position:  [-13.20827664]


portfolio before change:  [-13.88134324]
curr_Stock_Price:  105.52949971336984
curr_Factors:  [1.05529500e+02 4.07108006e-02]
mat_Sqrt:  [[ 2.12925987e+01 -8.06376317e-03]
 [-8.06376317e-03  1.84955056e-02]]
grads:  [0.00812353 5.74604822]
Stock Position:  0.008123533548654934
Bond Position:  [-14.73861567]


portfolio before change:  [-13.87980293]
curr_Stock_Price:  107.98841605719339
curr_Factors:  [1.07988416e+02 4.26702950e-02]
mat_Sqrt:  [[ 2.23069382e+01 -8.25570845e-03]
 [-8.25570845e-03  1.89353169e-02]]
grads:  [4.02335284e-03 4.27882318e+00]
Stock Position:  0.004023352838575663
Bond Position:  [-14.31427843]


portfolio before change:  [-13.8985864]
curr_Stock_Price:  107.76983576264946
curr_Factors:  [1.07769836e+02 4.04739056e-02]
mat_Sqrt:  [[ 2.16812715e+01 -8.04041260e-03]
 [-8.04041260e-03  1.84415515e-02]]
grads:  [-0.01240383  2.62078898]
Stock Position:  -0.012403826060923513
Bond Position:  [-12.5618281]


portfolio before change:  [-13.99381165]
curr_Stock_Price:  114.18020840675754
curr_Factors:  [1.14180208e+02 4.21555569e-02]
mat_Sqrt:  [[ 2.34432717e+01 -8.20613988e-03]
 [-8.20613988e-03  1.88205961e-02]]
grads:  [0.00288577 2.13266869]
Stock Position:  0.002885766589878693
Bond Position:  [-14.32330908]


portfolio before change:  [-14.00229284]
curr_Stock_Price:  117.44940590120787
curr_Factors:  [1.17449406e+02 3.52630842e-02]
mat_Sqrt:  [[ 2.20551972e+01 -7.50552964e-03]
 [-7.50552964e-03  1.72133049e-02]]
grads:  [ 2.23491721e-03 -2.93631774e+00]
Stock Position:  0.002234917214781641
Bond Position:  [-14.26478254]


portfolio before change:  [-14.0120706]
curr_Stock_Price:  121.05775693006898
curr_Factors:  [1.21057757e+02 3.78554784e-02]
mat_Sqrt:  [[ 2.35535823e+01 -7.77670566e-03]
 [-7.77670566e-03  1.78347311e-02]]
grads:  [ 1.95257662e-03 -6.55538586e+00]
Stock Position:  0.0019525766202136271
Bond Position:  [-14.24844514]


portfolio before change:  [-14.02022907]
curr_Stock_Price:  126.00671641064777
curr_Factors:  [1.26006716e+02 3.57676149e-02]
mat_Sqrt:  [[ 2.38308023e+01 -7.55943242e-03]
 [-7.55943242e-03  1.73358337e-02]]
grads:  [ 0.02173581 -2.28735011]
Stock Position:  0.021735805246848677
Bond Position:  [-16.75908652]


portfolio before change:  [-14.04929715]
curr_Stock_Price:  125.63377758048885
curr_Factors:  [1.25633778e+02 3.93806296e-02]
mat_Sqrt:  [[ 2.49314607e+01 -7.93203439e-03]
 [-7.93203439e-03  1.81903580e-02]]
grads:  [5.63216008e-03 1.25142849e+01]
Stock Position:  0.005632160081239677
Bond Position:  [-14.7568867]


portfolio before change:  [-14.06231977]
curr_Stock_Price:  126.59877602254348
curr_Factors:  [1.26598776e+02 3.66218234e-02]
mat_Sqrt:  [[ 2.42269904e+01 -7.64919367e-03]
 [-7.64919367e-03  1.75416097e-02]]
grads:  [-4.85413039e-03 -5.22148578e+00]
Stock Position:  -0.004854130394066681
Bond Position:  [-13.4477928]


portfolio before change:  [-14.11664719]
curr_Stock_Price:  134.32563228534548
curr_Factors:  [1.34325632e+02 3.65359577e-02]
mat_Sqrt:  [[ 2.56755126e+01 -7.64053902e-03]
 [-7.64053902e-03  1.75208944e-02]]
grads:  [ 2.31535728e-03 -9.49074542e+00]
Stock Position:  0.002315357281774022
Bond Position:  [-14.42765902]


portfolio before change:  [-14.14844689]
curr_Stock_Price:  128.3853579261731
curr_Factors:  [1.28385358e+02 3.53190293e-02]
mat_Sqrt:  [[ 2.41279184e+01 -7.51198007e-03]
 [-7.51198007e-03  1.72267365e-02]]
grads:  [ 7.13676398e-03 -1.32972787e+01]
Stock Position:  0.007136763980770963
Bond Position:  [-15.06470289]


portfolio before change:  [-14.1893137]
curr_Stock_Price:  125.29934381502021
curr_Factors:  [1.25299344e+02 3.61566638e-02]
mat_Sqrt:  [[ 2.38255508e+01 -7.60040250e-03]
 [-7.60040250e-03  1.74298744e-02]]
grads:  [ 4.41084543e-03 -8.59405601e+00]
Stock Position:  0.004410845425723189
Bond Position:  [-14.74198974]


portfolio before change:  [-14.24294384]
curr_Stock_Price:  117.32102622532317
curr_Factors:  [1.17321026e+02 3.86265194e-02]
mat_Sqrt:  [[ 2.30578397e+01 -7.85531517e-03]
 [-7.85531517e-03  1.80155271e-02]]
grads:  [-0.00318475  2.39611984]
Stock Position:  -0.0031847502766515928
Bond Position:  [-13.86930566]


portfolio before change:  [-14.26853229]
curr_Stock_Price:  119.90866592948238
curr_Factors:  [1.19908666e+02 3.75921090e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.26853229]
Stock Price:  121.27345782961011
PL:  [-35.54199012]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 2.36510004e-02 -4.21122496e-02]
 [-3.59295875e-02 -1.35013984e-01]
 [ 7.08946926e-02 -1.12279422e-01]
 [-2.20070578e-02 -2.34001434e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.27260154e-01  1.30270872e-01]
 [-1.03727840e-01 -1.30459190e-01]
 [ 3.82371501e-02  9.95144549e-03]
 [ 5.56333417e-02  4.52821361e-02]
 [ 6.56349363e-02 -5.23164695e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 1.01203527e-01  2.16261822e-02]
 [ 2.27949876e-02  1.03958032e-01]
 [-2.69385466e-02 -1.79052532e-01]
 [ 2.78299726e-02 -1.28412571e-01]
 [ 2.26882086e-01 -1.73599714e-01]
 [ 1.29724055e-01 -1.50664694e-01]
 [-9.48714500e-02  4.34759687e-02]
 [-1.09406839e-01 -1.21953518e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.74681884]
curr_Stock_Price:  103.56472439034563
curr_Factors:  [1.03564724e+02 3.73199935e-02]
mat_Sqrt:  [[ 2.00070290e+01 -7.72052035e-03]
 [-7.72052035e-03  1.77085714e-02]]
grads:  [ 2.64504089e-04 -2.37795622e+00]
Stock Position:  0.0002645040890345444
Bond Position:  [19.71942555]


portfolio before change:  [19.771942]
curr_Stock_Price:  105.29801361943447
curr_Factors:  [1.05298014e+02 4.15369393e-02]
mat_Sqrt:  [[ 2.14603793e+01 -8.14515513e-03]
 [-8.14515513e-03  1.86822333e-02]]
grads:  [-4.41787230e-03 -7.22879145e+00]
Stock Position:  -0.004417872303132809
Bond Position:  [20.23713518]


portfolio before change:  [19.81166827]
curr_Stock_Price:  102.03535033652403
curr_Factors:  [1.02035350e+02 4.28444254e-02]
mat_Sqrt:  [[ 2.11201884e+01 -8.27212706e-03]
 [-8.27212706e-03  1.89740920e-02]]
grads:  [ 1.03919656e-03 -5.91705919e+00]
Stock Position:  0.0010391965615378907
Bond Position:  [19.70563348]


portfolio before change:  [19.83808633]
curr_Stock_Price:  103.73918780294474
curr_Factors:  [1.03739188e+02 4.21713057e-02]
mat_Sqrt:  [[ 2.13035184e+01 -8.20700999e-03]
 [-8.20700999e-03  1.88244002e-02]]
grads:  [-0.00151216 -1.24373438]
Stock Position:  -0.0015121632841997047
Bond Position:  [19.99495692]


portfolio before change:  [19.85723358]
curr_Stock_Price:  107.61580532076437
curr_Factors:  [1.07615805e+02 3.79852477e-02]
mat_Sqrt:  [[ 2.09741086e+01 -7.78928746e-03]
 [-7.78928746e-03  1.78655948e-02]]
grads:  [ 0.00781804 -6.60761782]
Stock Position:  0.007818036529758965
Bond Position:  [19.01588928]


portfolio before change:  [19.82233203]
curr_Stock_Price:  100.10928207515985
curr_Factors:  [1.00109282e+02 4.02380387e-02]
mat_Sqrt:  [[ 2.00813411e+01 -8.01642876e-03]
 [-8.01642876e-03  1.83879650e-02]]
grads:  [0.00916698 7.08856898]
Stock Position:  0.009166975474362293
Bond Position:  [18.90463269]


portfolio before change:  [19.78644308]
curr_Stock_Price:  93.61482646588279
curr_Factors:  [9.36148265e+01 4.10472507e-02]
mat_Sqrt:  [[ 1.89664755e+01 -8.09612138e-03]
 [-8.09612138e-03  1.85721654e-02]]
grads:  [-0.00846908 -7.02813883]
Stock Position:  -0.008469075071922776
Bond Position:  [20.57927407]


portfolio before change:  [19.78785969]
curr_Stock_Price:  96.48687192569197
curr_Factors:  [9.64868719e+01 3.30862966e-02]
mat_Sqrt:  [[ 1.75506122e+01 -7.26895029e-03]
 [-7.26895029e-03  1.66740915e-02]]
grads:  [0.0024263  0.59787858]
Stock Position:  0.0024263028206910607
Bond Position:  [19.55375332]


portfolio before change:  [19.82107522]
curr_Stock_Price:  100.09650446709644
curr_Factors:  [1.00096504e+02 3.27953621e-02]
mat_Sqrt:  [[ 1.81269648e+01 -7.23716876e-03]
 [-7.23716876e-03  1.66005123e-02]]
grads:  [0.00415887 2.72956844]
Stock Position:  0.00415886993997634
Bond Position:  [19.40478688]


portfolio before change:  [19.85681802]
curr_Stock_Price:  102.85486032233578
curr_Factors:  [1.02854860e+02 3.27961511e-02]
mat_Sqrt:  [[ 1.86267131e+01 -7.23743341e-03]
 [-7.23743341e-03  1.66006346e-02]]
grads:  [ 2.29957955e-03 -3.15047152e+00]
Stock Position:  0.0022995795488864133
Bond Position:  [19.62029508]


portfolio before change:  [19.8862061]
curr_Stock_Price:  104.962800426051
curr_Factors:  [1.04962800e+02 3.38314689e-02]
mat_Sqrt:  [[ 1.93061557e+01 -7.35091388e-03]
 [-7.35091388e-03  1.68605680e-02]]
grads:  [ 4.97383976e-04 -7.25647253e+00]
Stock Position:  0.0004973839760086602
Bond Position:  [19.83399928]


portfolio before change:  [19.91370796]
curr_Stock_Price:  110.37887041933844
curr_Factors:  [1.10378870e+02 2.94807989e-02]
mat_Sqrt:  [[ 1.89520215e+01 -6.86229094e-03]
 [-6.86229094e-03  1.57390264e-02]]
grads:  [0.00583843 1.37659387]
Stock Position:  0.005838433359051333
Bond Position:  [19.26926828]


portfolio before change:  [19.95478389]
curr_Stock_Price:  113.28620625211666
curr_Factors:  [1.13286206e+02 3.11390517e-02]
mat_Sqrt:  [[ 1.99907781e+01 -7.05279795e-03]
 [-7.05279795e-03  1.61755543e-02]]
grads:  [3.40821238e-03 6.42834659e+00]
Stock Position:  0.003408212376150352
Bond Position:  [19.56868044]


portfolio before change:  [19.98435209]
curr_Stock_Price:  114.78025837308795
curr_Factors:  [1.14780258e+02 3.13417781e-02]
mat_Sqrt:  [[ 2.03202472e+01 -7.07579329e-03]
 [-7.07579329e-03  1.62280908e-02]]
grads:  [-5.16850063e-03 -1.10357469e+01]
Stock Position:  -0.005168500633672864
Bond Position:  [20.57759392]


portfolio before change:  [19.9803193]
curr_Stock_Price:  120.5403157148431
curr_Factors:  [1.20540316e+02 2.62986291e-02]
mat_Sqrt:  [[ 1.95478436e+01 -6.48181209e-03]
 [-6.48181209e-03  1.48651405e-02]]
grads:  [-1.44093938e-03 -8.63913201e+00]
Stock Position:  -0.0014409393837922634
Bond Position:  [20.15401059]


portfolio before change:  [20.00427141]
curr_Stock_Price:  121.41207894073912
curr_Factors:  [1.21412079e+02 2.49956158e-02]
mat_Sqrt:  [[ 1.91952509e+01 -6.31923013e-03]
 [-6.31923013e-03  1.44921872e-02]]
grads:  [ 7.87729695e-03 -1.19754136e+01]
Stock Position:  0.007877296946943018
Bond Position:  [19.04787241]


portfolio before change:  [20.01029223]
curr_Stock_Price:  119.15192434299134
curr_Factors:  [1.19151924e+02 2.58707466e-02]
mat_Sqrt:  [[ 1.91648541e+01 -6.42880891e-03]
 [-6.42880891e-03  1.47437404e-02]]
grads:  [ 3.34143510e-03 -1.02174352e+01]
Stock Position:  0.0033414351002295215
Bond Position:  [19.61215381]


portfolio before change:  [20.03010686]
curr_Stock_Price:  117.74058704647062
curr_Factors:  [1.17740587e+02 2.68255321e-02]
mat_Sqrt:  [[ 1.92841431e+01 -6.54630458e-03]
 [-6.54630458e-03  1.50133680e-02]]
grads:  [-0.00393721  2.89410041]
Stock Position:  -0.003937213440595226
Bond Position:  [20.49367668]


portfolio before change:  [20.04386149]
curr_Stock_Price:  120.75756422439433
curr_Factors:  [1.20757564e+02 2.53218597e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.04386149]
Stock Price:  120.21742415077013
PL:  [-0.17356266]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 7.58214570e-03 -5.51547242e-02]
 [ 9.34379268e-03 -8.05804074e-02]
 [ 5.93550303e-02 -1.89586949e-01]
 [-2.42915297e-02 -2.96094628e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.38505268e-01  5.90785404e-02]
 [ 5.44239664e-02  8.09876574e-02]
 [ 3.56202675e-02 -4.96870034e-02]
 [ 5.19496551e-02  4.09391018e-02]
 [ 6.19039431e-02 -4.26515843e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 3.45341414e-02  3.08654992e-02]
 [ 3.45209003e-02  2.75418049e-02]
 [ 1.17288894e-02 -1.10586320e-01]
 [-5.29510742e-02 -9.75634474e-02]
 [ 9.31042099e-02 -5.63462340e-02]
 [-9.76513060e-03 -3.79252647e-02]
 [ 2.00833008e-02  4.29573367e-02]
 [-3.20690250e-02 -3.43089118e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.08813241]
curr_Stock_Price:  99.64666459025345
curr_Factors:  [9.96466646e+01 4.23991475e-02]
mat_Sqrt:  [[ 2.05182962e+01 -8.22885204e-03]
 [-8.22885204e-03  1.88753138e-02]]
grads:  [-8.02498402e-04 -2.92240588e+00]
Stock Position:  -0.0008024984019921912
Bond Position:  [5.1680987]


portfolio before change:  [5.0925327]
curr_Stock_Price:  102.21846695481412
curr_Factors:  [1.02218467e+02 4.03290151e-02]
mat_Sqrt:  [[ 2.05275982e+01 -8.02563754e-03]
 [-8.02563754e-03  1.84086744e-02]]
grads:  [-1.25641964e-03 -4.37785411e+00]
Stock Position:  -0.001256419644901571
Bond Position:  [5.22096199]


portfolio before change:  [5.0973666]
curr_Stock_Price:  103.56863931203387
curr_Factors:  [1.03568639e+02 4.25582898e-02]
mat_Sqrt:  [[ 2.13658572e+01 -8.24456774e-03]
 [-8.24456774e-03  1.89105791e-02]]
grads:  [-1.09072813e-03 -1.00259194e+01]
Stock Position:  -0.0010907281275794342
Bond Position:  [5.21033183]


portfolio before change:  [5.10008589]
curr_Stock_Price:  107.05044528191488
curr_Factors:  [1.07050445e+02 4.28380586e-02]
mat_Sqrt:  [[ 2.21566113e+01 -8.27186024e-03]
 [-8.27186024e-03  1.89725305e-02]]
grads:  [-0.00167928 -1.56138126]
Stock Position:  -0.0016792756268953657
Bond Position:  [5.27985309]


portfolio before change:  [5.10187441]
curr_Stock_Price:  109.91800338344778
curr_Factors:  [1.09918003e+02 4.31304719e-02]
mat_Sqrt:  [[ 2.28276343e+01 -8.30022941e-03]
 [-8.30022941e-03  1.90370930e-02]]
grads:  [ 0.00718317 -6.20106745]
Stock Position:  0.007183166541450922
Bond Position:  [4.31231509]


portfolio before change:  [5.14121755]
curr_Stock_Price:  114.64424386105927
curr_Factors:  [1.14644244e+02 3.84891487e-02]
mat_Sqrt:  [[ 2.24916533e+01 -7.84119154e-03]
 [-7.84119154e-03  1.79835258e-02]]
grads:  [0.00730447 3.28833271]
Stock Position:  0.0073044748053008954
Bond Position:  [4.30380156]


portfolio before change:  [5.16397965]
curr_Stock_Price:  117.02346809851122
curr_Factors:  [1.17023468e+02 4.37400459e-02]
mat_Sqrt:  [[ 2.44744283e+01 -8.35910117e-03]
 [-8.35910117e-03  1.91709647e-02]]
grads:  [3.66710584e-03 4.22609464e+00]
Stock Position:  0.0036671058377841723
Bond Position:  [4.7348422]


portfolio before change:  [5.17028517]
curr_Stock_Price:  117.12798327541844
curr_Factors:  [1.17127983e+02 5.02832796e-02]
mat_Sqrt:  [[ 2.62646996e+01 -8.96255978e-03]
 [-8.96255978e-03  2.05549341e-02]]
grads:  [ 5.31410604e-04 -2.41704694e+00]
Stock Position:  0.0005314106035389101
Bond Position:  [5.10804211]


portfolio before change:  [5.17358422]
curr_Stock_Price:  111.31329061300168
curr_Factors:  [1.11313291e+02 5.07843174e-02]
mat_Sqrt:  [[ 2.50848670e+01 -9.00673401e-03]
 [-9.00673401e-03  2.06572485e-02]]
grads:  [0.00278297 1.98304083]
Stock Position:  0.00278296776593281
Bond Position:  [4.86380292]


portfolio before change:  [5.16326091]
curr_Stock_Price:  105.41783504011819
curr_Factors:  [1.05417835e+02 5.77609692e-02]
mat_Sqrt:  [[ 2.53356061e+01 -9.60505330e-03]
 [-9.60505330e-03  2.20307204e-02]]
grads:  [ 1.70967577e-03 -1.93525958e+00]
Stock Position:  0.0017096757670355734
Bond Position:  [4.9830306]


portfolio before change:  [5.17660104]
curr_Stock_Price:  109.57502310125138
curr_Factors:  [1.09575023e+02 5.75291458e-02]
mat_Sqrt:  [[ 2.62818241e+01 -9.58607498e-03]
 [-9.58607498e-03  2.19863281e-02]]
grads:  [ 3.65278049e-04 -5.56474926e+00]
Stock Position:  0.00036527804910790646
Bond Position:  [5.13657569]


portfolio before change:  [5.18241423]
curr_Stock_Price:  107.90082113244398
curr_Factors:  [1.07900821e+02 6.18348537e-02]
mat_Sqrt:  [[ 2.68312798e+01 -9.93820372e-03]
 [-9.93820372e-03  2.27943117e-02]]
grads:  [0.00178892 1.35486776]
Stock Position:  0.0017889229839964313
Bond Position:  [4.98938797]


portfolio before change:  [5.18517933]
curr_Stock_Price:  105.95801487247593
curr_Factors:  [1.05958015e+02 6.33753838e-02]
mat_Sqrt:  [[ 2.66743646e+01 -1.00610838e-02]
 [-1.00610838e-02  2.30765775e-02]]
grads:  [0.00174461 1.19425671]
Stock Position:  0.0017446120211059817
Bond Position:  [5.0003237]


portfolio before change:  [5.19235594]
curr_Stock_Price:  106.48667081497625
curr_Factors:  [1.06486671e+02 6.72907794e-02]
mat_Sqrt:  [[ 2.76231371e+01 -1.03672629e-02]
 [-1.03672629e-02  2.37787227e-02]]
grads:  [-1.32104861e-03 -4.65121767e+00]
Stock Position:  -0.0013210486105583773
Bond Position:  [5.33303001]


portfolio before change:  [5.20601537]
curr_Stock_Price:  101.19620145266933
curr_Factors:  [1.01196201e+02 7.24448098e-02]
mat_Sqrt:  [[ 2.72375359e+01 -1.07564866e-02]
 [-1.07564866e-02  2.46727804e-02]]
grads:  [-3.50625829e-03 -3.95582341e+00]
Stock Position:  -0.003506258285223066
Bond Position:  [5.56083539]


portfolio before change:  [5.21994551]
curr_Stock_Price:  99.20697169862443
curr_Factors:  [9.92069717e+01 7.20814344e-02]
mat_Sqrt:  [[ 2.66350716e+01 -1.07292813e-02]
 [-1.07292813e-02  2.46109095e-02]]
grads:  [ 0.00257374 -2.28835995]
Stock Position:  0.002573740119736068
Bond Position:  [4.96461255]


portfolio before change:  [5.22457807]
curr_Stock_Price:  98.5942109265468
curr_Factors:  [9.85942109e+01 7.28460462e-02]
mat_Sqrt:  [[ 2.66105820e+01 -1.07859753e-02]
 [-1.07859753e-02  2.47411236e-02]]
grads:  [-9.88457304e-04 -1.53331460e+00]
Stock Position:  -0.0009884573037909903
Bond Position:  [5.32203424]


portfolio before change:  [5.22748231]
curr_Stock_Price:  102.39048592581274
curr_Factors:  [1.02390486e+02 6.74236655e-02]
mat_Sqrt:  [[ 2.65867805e+01 -1.03771374e-02]
 [-1.03771374e-02  2.38023460e-02]]
grads:  [1.46005147e-03 1.80538876e+00]
Stock Position:  0.0014600514717895221
Bond Position:  [5.07798693]


portfolio before change:  [5.23037201]
curr_Stock_Price:  100.01950341674294
curr_Factors:  [1.00019503e+02 6.46142298e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.23037201]
Stock Price:  100.09390658486079
PL:  [5.13646543]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.66403117e-01  1.96692200e-03]
 [-1.52427443e-01  8.13961750e-02]
 [ 3.98740141e-02  8.67746459e-02]
 [-1.04835029e+00 -5.20883014e-01]
 [ 9.15287188e-01  1.08945909e-01]
 [-1.35808893e-01 -7.52830712e-01]
 [-7.36564387e-01 -5.47930267e-01]
 [ 3.56013984e-02 -1.48851944e-03]
 [-3.47688488e-01 -2.67175478e-01]
 [ 1.32178592e-01  6.16538301e-01]
 [-1.70281294e-01 -1.80234753e-02]
 [ 6.22384989e-02 -2.38490820e-01]
 [-2.47826558e-01 -8.01120311e-02]
 [ 1.15869101e-02  1.36007562e-01]
 [-1.01709258e-01  1.98943887e-01]
 [-1.90710349e-01  8.75002288e-02]
 [-9.46223380e-02  1.69603997e-01]
 [ 4.14474376e-02 -1.49455092e-01]
 [-1.24665310e-02  5.69032252e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.8574111]
curr_Stock_Price:  98.05750480478808
curr_Factors:  [9.80575048e+01 4.06387122e-02]
mat_Sqrt:  [[ 1.97674555e+01 -8.05608781e-03]
 [-8.05608781e-03  1.84793553e-02]]
grads:  [0.00846292 0.1101283 ]
Stock Position:  0.008462916244844434
Bond Position:  [-1.68726355]


portfolio before change:  [-0.90692841]
curr_Stock_Price:  92.45578082279648
curr_Factors:  [9.24557808e+01 4.64228362e-02]
mat_Sqrt:  [[ 1.99204831e+01 -8.60984797e-03]
 [-8.60984797e-03  1.97509210e-02]]
grads:  [-0.0058717   4.11857354]
Stock Position:  -0.00587170256892597
Bond Position:  [-0.36405557]


portfolio before change:  [-0.87928588]
curr_Stock_Price:  87.67047643017638
curr_Factors:  [8.76704764e+01 5.07209385e-02]
mat_Sqrt:  [[ 1.97445374e+01 -8.99911514e-03]
 [-8.99911514e-03  2.06452249e-02]]
grads:  [3.93597169e-03 4.20484962e+00]
Stock Position:  0.003935971685486226
Bond Position:  [-1.2243544]


portfolio before change:  [-0.89691407]
curr_Stock_Price:  83.58081718680772
curr_Factors:  [8.35808172e+01 5.68930648e-02]
mat_Sqrt:  [[ 1.99359175e+01 -9.53045504e-03]
 [-9.53045504e-03  2.18655225e-02]]
grads:  [ -0.06398761 -23.8500061 ]
Stock Position:  -0.06398760922031632
Bond Position:  [4.4512226]


portfolio before change:  [-0.7225989]
curr_Stock_Price:  80.94362445608225
curr_Factors:  [8.09436245e+01 5.80688450e-02]
mat_Sqrt:  [[ 1.95053698e+01 -9.62808829e-03]
 [-9.62808829e-03  2.20904587e-02]]
grads:  [0.0493699  4.95332616]
Stock Position:  0.04936990477641665
Bond Position:  [-4.71877793]


portfolio before change:  [-0.84315821]
curr_Stock_Price:  78.62121481455414
curr_Factors:  [7.86212148e+01 6.20199960e-02]
mat_Sqrt:  [[ 1.95796787e+01 -9.94992540e-03]
 [-9.94992540e-03  2.28297820e-02]]
grads:  [-2.36989886e-02 -3.29861457e+01]
Stock Position:  -0.023698988591050567
Bond Position:  [1.02008507]


portfolio before change:  [-0.8297702]
curr_Stock_Price:  78.11013382756121
curr_Factors:  [7.81101338e+01 6.47523190e-02]
mat_Sqrt:  [[ 1.98762746e+01 -1.01666603e-02]
 [-1.01666603e-02  2.33272846e-02]]
grads:  [ -0.04908287 -23.51020638]
Stock Position:  -0.04908287330164874
Bond Position:  [3.0040996]


portfolio before change:  [-0.79972929]
curr_Stock_Price:  77.57464289568485
curr_Factors:  [7.75746429e+01 6.03579434e-02]
mat_Sqrt:  [[ 1.90584222e+01 -9.81554347e-03]
 [-9.81554347e-03  2.25218681e-02]]
grads:  [ 0.00183439 -0.06529272]
Stock Position:  0.001834386627781137
Bond Position:  [-0.94203118]


portfolio before change:  [-0.80123028]
curr_Stock_Price:  77.39871898624783
curr_Factors:  [7.73987190e+01 6.45055714e-02]
mat_Sqrt:  [[ 1.96576830e+01 -1.01471617e-02]
 [-1.01471617e-02  2.32828440e-02]]
grads:  [ -0.02361589 -11.48550036]
Stock Position:  -0.02361589187177038
Bond Position:  [1.0266095]


portfolio before change:  [-0.77082045]
curr_Stock_Price:  76.16540685744225
curr_Factors:  [7.61654069e+01 6.61191653e-02]
mat_Sqrt:  [[ 1.95849013e+01 -1.02730956e-02]
 [-1.02730956e-02  2.35723389e-02]]
grads:  [2.04731548e-02 2.61640827e+01]
Stock Position:  0.020473154785543072
Bond Position:  [-2.33016661]


portfolio before change:  [-0.73116902]
curr_Stock_Price:  78.2445179001644
curr_Factors:  [7.82445179e+01 6.50016187e-02]
mat_Sqrt:  [[ 1.99487620e+01 -1.01862331e-02]
 [-1.01862331e-02  2.33721382e-02]]
grads:  [-0.00893169 -0.77504486]
Stock Position:  -0.008931686193023043
Bond Position:  [-0.03231354]


portfolio before change:  [-0.69344845]
curr_Stock_Price:  74.01676256480346
curr_Factors:  [7.40167626e+01 6.77213692e-02]
mat_Sqrt:  [[ 1.92616234e+01 -1.03964569e-02]
 [-1.03964569e-02  2.38563907e-02]]
grads:  [-2.16513576e-03 -9.99787996e+00]
Stock Position:  -0.002165135757941812
Bond Position:  [-0.53319211]


portfolio before change:  [-0.69597113]
curr_Stock_Price:  74.8738801834461
curr_Factors:  [7.48738802e+01 7.40731395e-02]
mat_Sqrt:  [[ 2.03779576e+01 -1.08732412e-02]
 [-1.08732412e-02  2.49500305e-02]]
grads:  [-0.013878   -3.21694717]
Stock Position:  -0.01387799533358994
Bond Position:  [0.34312823]


portfolio before change:  [-0.69832436]
curr_Stock_Price:  75.07437087613422
curr_Factors:  [7.50743709e+01 7.17750603e-02]
mat_Sqrt:  [[ 2.01130727e+01 -1.07032790e-02]
 [-1.07032790e-02  2.45599353e-02]]
grads:  [3.52386587e-03 5.53931748e+00]
Stock Position:  0.0035238658717019356
Bond Position:  [-0.96287638]


portfolio before change:  [-0.67514517]
curr_Stock_Price:  81.99391484177798
curr_Factors:  [8.19939148e+01 6.90734439e-02]
mat_Sqrt:  [[ 2.15494964e+01 -1.05009918e-02]
 [-1.05009918e-02  2.40928124e-02]]
grads:  [-6.96146157e-04  8.25709234e+00]
Stock Position:  -0.0006961461568217966
Bond Position:  [-0.61806542]


portfolio before change:  [-0.67632137]
curr_Stock_Price:  82.57301186904976
curr_Factors:  [8.25730119e+01 7.11464461e-02]
mat_Sqrt:  [[ 2.20249373e+01 -1.06574860e-02]
 [-1.06574860e-02  2.44516350e-02]]
grads:  [-0.00692872  3.57548221]
Stock Position:  -0.0069287233423566364
Bond Position:  [-0.10419581]


portfolio before change:  [-0.69778915]
curr_Stock_Price:  85.65257682614076
curr_Factors:  [8.56525768e+01 7.10212095e-02]
mat_Sqrt:  [[ 2.28262420e+01 -1.06485264e-02]
 [-1.06485264e-02  2.44299198e-02]]
grads:  [-9.06827614e-04  6.94207522e+00]
Stock Position:  -0.0009068276142792389
Bond Position:  [-0.62011703]


portfolio before change:  [-0.69569703]
curr_Stock_Price:  82.4901741528466
curr_Factors:  [8.24901742e+01 6.65308161e-02]
mat_Sqrt:  [[ 2.12771568e+01 -1.03059755e-02]
 [-1.03059755e-02  2.36451904e-02]]
grads:  [-1.11382144e-03 -6.32122509e+00]
Stock Position:  -0.0011138214376018407
Bond Position:  [-0.6038177]


portfolio before change:  [-0.69517165]
curr_Stock_Price:  81.34042239167846
curr_Factors:  [8.13404224e+01 6.56871101e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.69517165]
Stock Price:  82.55730007647881
PL:  [-0.69517165]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.68925571e-01  4.23699616e-03]
 [ 3.20673969e-02 -3.85380927e-02]
 [ 7.41460016e-02 -8.86523100e-02]
 [-1.57405392e-02 -6.36740326e-03]
 [ 1.31085693e-02 -8.89068615e-02]
 [ 1.27452247e-01  1.07653223e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-2.62835672e-01  4.71560369e-02]
 [ 5.36105153e-02  4.17003862e-02]
 [ 6.00510011e-02 -2.71648903e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [-1.07201122e-02  3.57093524e-02]
 [ 1.72365468e-02 -2.31213079e-02]
 [-2.07102613e-02 -1.89796383e-01]
 [ 3.92758428e-03 -1.15442889e-01]
 [ 2.05501777e-01 -1.47337848e-01]
 [ 1.70297456e-01 -1.49421146e-01]
 [-1.24083548e-01  4.64420796e-02]
 [-1.33142621e-01 -1.69855717e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.9448591]
curr_Stock_Price:  97.76684531542983
curr_Factors:  [9.77668453e+01 3.89800413e-02]
mat_Sqrt:  [[ 1.93024623e+01 -7.88994842e-03]
 [-7.88994842e-03  1.80983183e-02]]
grads:  [0.00884877 0.23796755]
Stock Position:  0.008848773803114546
Bond Position:  [-2.8099758]


portfolio before change:  [-1.93344704]
curr_Stock_Price:  99.45371426388654
curr_Factors:  [9.94537143e+01 4.00551782e-02]
mat_Sqrt:  [[ 1.99044557e+01 -7.99814459e-03]
 [-7.99814459e-03  1.83461567e-02]]
grads:  [ 7.67119756e-04 -2.10027407e+00]
Stock Position:  0.0007671197564863488
Bond Position:  [-2.00973995]


portfolio before change:  [-1.934337]
curr_Stock_Price:  101.57044536933837
curr_Factors:  [1.01570445e+02 3.94263261e-02]
mat_Sqrt:  [[ 2.01678906e+01 -7.93526448e-03]
 [-7.93526448e-03  1.82015065e-02]]
grads:  [ 1.76035115e-03 -4.86983543e+00]
Stock Position:  0.0017603511509842846
Bond Position:  [-2.11313665]


portfolio before change:  [-1.93856389]
curr_Stock_Price:  100.6707290370132
curr_Factors:  [1.00670729e+02 4.35245073e-02]
mat_Sqrt:  [[ 2.10024573e+01 -8.33742006e-03]
 [-8.33742006e-03  1.91241340e-02]]
grads:  [-0.00088179 -0.33333562]
Stock Position:  -0.0008817872102211187
Bond Position:  [-1.84979373]


portfolio before change:  [-1.9421962]
curr_Stock_Price:  102.1661195189708
curr_Factors:  [1.02166120e+02 4.48229474e-02]
mat_Sqrt:  [[ 2.16300274e+01 -8.46098139e-03]
 [-8.46098139e-03  1.94072478e-02]]
grads:  [-1.18615415e-03 -4.58163354e+00]
Stock Position:  -0.0011861541489676963
Bond Position:  [-1.82101143]


portfolio before change:  [-1.94683044]
curr_Stock_Price:  104.15283527175498
curr_Factors:  [1.04152835e+02 4.37609698e-02]
mat_Sqrt:  [[ 2.17878579e+01 -8.36029168e-03]
 [-8.36029168e-03  1.91759021e-02]]
grads:  [0.00800519 5.61747493]
Stock Position:  0.008005191568458359
Bond Position:  [-2.78059383]


portfolio before change:  [-1.91631905]
curr_Stock_Price:  108.39874299474155
curr_Factors:  [1.08398743e+02 4.45906481e-02]
mat_Sqrt:  [[ 2.28900167e+01 -8.43946296e-03]
 [-8.43946296e-03  1.93567029e-02]]
grads:  [3.92086929e-03 4.18566881e+00]
Stock Position:  0.003920869286892678
Bond Position:  [-2.34133635]


portfolio before change:  [-1.91865831]
curr_Stock_Price:  108.54902442863884
curr_Factors:  [1.08549024e+02 4.68760668e-02]
mat_Sqrt:  [[ 2.35018190e+01 -8.65304595e-03]
 [-8.65304595e-03  1.98465479e-02]]
grads:  [-0.01031046  2.37153686]
Stock Position:  -0.010310463831454602
Bond Position:  [-0.79946752]


portfolio before change:  [-1.92081771]
curr_Stock_Price:  108.66147700571918
curr_Factors:  [1.08661477e+02 4.92478638e-02]
mat_Sqrt:  [[ 2.41140009e+01 -8.86926243e-03]
 [-8.86926243e-03  2.03424389e-02]]
grads:  [0.00297766 2.05121893]
Stock Position:  0.0029776607595547694
Bond Position:  [-2.24437473]


portfolio before change:  [-1.91975536]
curr_Stock_Price:  109.96101213509532
curr_Factors:  [1.09961012e+02 4.79201436e-02]
mat_Sqrt:  [[ 2.40712008e+01 -8.74897525e-03]
 [-8.74897525e-03  2.00663118e-02]]
grads:  [ 0.002003  -1.3528827]
Stock Position:  0.002003002023512989
Bond Position:  [-2.14000749]


portfolio before change:  [-1.93040296]
curr_Stock_Price:  105.98152415439546
curr_Factors:  [1.05981524e+02 4.73114647e-02]
mat_Sqrt:  [[ 2.30522503e+01 -8.69296131e-03]
 [-8.69296131e-03  1.99385825e-02]]
grads:  [ 4.16533073e-04 -6.13625789e+00]
Stock Position:  0.0004165330725474593
Bond Position:  [-1.97454777]


portfolio before change:  [-1.93487726]
curr_Stock_Price:  101.16901274114576
curr_Factors:  [1.01169013e+02 4.77755025e-02]
mat_Sqrt:  [[ 2.21131244e+01 -8.73512912e-03]
 [-8.73512912e-03  2.00362807e-02]]
grads:  [2.19271234e-04 1.78233018e+00]
Stock Position:  0.00021927123423216266
Bond Position:  [-1.95706072]


portfolio before change:  [-1.93673949]
curr_Stock_Price:  103.83980262358052
curr_Factors:  [1.03839803e+02 4.76450635e-02]
mat_Sqrt:  [[ 2.26658900e+01 -8.72339955e-03]
 [-8.72339955e-03  2.00088214e-02]]
grads:  [ 3.15777305e-04 -1.15541804e+00]
Stock Position:  0.0003157773045575346
Bond Position:  [-1.96952974]


portfolio before change:  [-1.93620838]
curr_Stock_Price:  113.32293997734847
curr_Factors:  [1.1332294e+02 4.2357263e-02]
mat_Sqrt:  [[ 2.33228571e+01 -8.22569892e-03]
 [-8.22569892e-03  1.88655906e-02]]
grads:  [-4.43686765e-03 -1.00623873e+01]
Stock Position:  -0.004436867651237448
Bond Position:  [-1.43340949]


portfolio before change:  [-1.95442819]
curr_Stock_Price:  117.02531115124816
curr_Factors:  [1.17025311e+02 4.13517000e-02]
mat_Sqrt:  [[ 2.37972330e+01 -8.12768108e-03]
 [-8.12768108e-03  1.86402200e-02]]
grads:  [-1.95047062e-03 -6.19406540e+00]
Stock Position:  -0.0019504706203937504
Bond Position:  [-1.72617376]


portfolio before change:  [-1.95842582]
curr_Stock_Price:  117.9679344619936
curr_Factors:  [1.17967934e+02 4.05994988e-02]
mat_Sqrt:  [[ 2.37697321e+01 -8.05346957e-03]
 [-8.05346957e-03  1.84698840e-02]]
grads:  [ 5.94363281e-03 -7.97460240e+00]
Stock Position:  0.0059436328112103375
Bond Position:  [-2.65958391]


portfolio before change:  [-1.91643309]
curr_Stock_Price:  125.5927803183644
curr_Factors:  [1.25592780e+02 4.04370259e-02]
mat_Sqrt:  [[ 2.52554003e+01 -8.03771792e-03]
 [-8.03771792e-03  1.84327250e-02]]
grads:  [ 4.16370038e-03 -8.10448153e+00]
Stock Position:  0.004163700375477779
Bond Position:  [-2.4393638]


portfolio before change:  [-1.93340301]
curr_Stock_Price:  122.24988660607949
curr_Factors:  [1.22249887e+02 4.24773799e-02]
mat_Sqrt:  [[ 2.51957507e+01 -8.23784008e-03]
 [-8.23784008e-03  1.88921092e-02]]
grads:  [-0.00412163  2.45648201]
Stock Position:  -0.004121625249659209
Bond Position:  [-1.42953479]


portfolio before change:  [-1.96637511]
curr_Stock_Price:  129.81584833780354
curr_Factors:  [1.29815848e+02 4.09687691e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.96637511]
Stock Price:  129.93738591600248
PL:  [-31.90376102]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 2.28399027e-02 -4.24892409e-02]
 [-1.75207443e-01 -1.94010296e-01]
 [ 5.94479023e-02 -1.89016305e-01]
 [ 5.72437971e-03  1.25992522e-02]
 [-3.68130302e-02 -8.17017156e-02]
 [ 1.27257530e-01  1.28720624e-01]
 [ 3.32602114e-02  5.36330711e-02]
 [ 3.62969661e-02  1.08435498e-01]
 [ 6.20291178e-02  5.23912880e-02]
 [ 5.27734242e-02  3.16509776e-02]
 [ 5.94487034e-02 -1.12748929e-01]
 [-1.07408900e-02  2.97039422e-02]
 [-7.41199552e-02 -1.34295796e-01]
 [ 1.09060548e-02  5.02400983e-02]
 [-5.22036136e-02 -9.61429188e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 2.97979983e-02 -1.46258701e-01]
 [ 7.50926604e-04  3.73313513e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.65474317]
curr_Stock_Price:  103.540113864135
curr_Factors:  [1.03540114e+02 3.96176632e-02]
mat_Sqrt:  [[ 2.06088156e+01 -7.95463265e-03]
 [-7.95463265e-03  1.82455598e-02]]
grads:  [ 2.09440694e-04 -2.32865286e+00]
Stock Position:  0.00020944069435157865
Bond Position:  [19.63305766]


portfolio before change:  [19.68029739]
curr_Stock_Price:  108.30306057159423
curr_Factors:  [1.08303061e+02 3.40975593e-02]
mat_Sqrt:  [[ 1.99987268e+01 -7.37996398e-03]
 [-7.37996398e-03  1.69266572e-02]]
grads:  [ -0.01299268 -11.46748466]
Stock Position:  -0.01299268048613711
Bond Position:  [21.08744446]


portfolio before change:  [19.76836424]
curr_Stock_Price:  103.55492095336302
curr_Factors:  [1.03554921e+02 3.67428130e-02]
mat_Sqrt:  [[ 1.98498354e+01 -7.66058537e-03]
 [-7.66058537e-03  1.75711002e-02]]
grads:  [-1.15681631e-03 -1.07577309e+01]
Stock Position:  -0.001156816307672114
Bond Position:  [19.88815826]


portfolio before change:  [19.79861564]
curr_Stock_Price:  98.90798262878684
curr_Factors:  [9.89079826e+01 3.87325776e-02]
mat_Sqrt:  [[ 1.94656768e+01 -7.86494898e-03]
 [-7.86494898e-03  1.80407415e-02]]
grads:  [5.76350942e-04 6.98629000e-01]
Stock Position:  0.0005763509418565913
Bond Position:  [19.74160993]


portfolio before change:  [19.82488204]
curr_Stock_Price:  101.63888648467365
curr_Factors:  [1.01638886e+02 3.62188505e-02]
mat_Sqrt:  [[ 1.93431499e+01 -7.60564143e-03]
 [-7.60564143e-03  1.74454213e-02]]
grads:  [-3.74524129e-03 -4.68490839e+00]
Stock Position:  -0.00374524129394322
Bond Position:  [20.20554419]


portfolio before change:  [19.85513601]
curr_Stock_Price:  100.30886472174075
curr_Factors:  [1.00308865e+02 3.36795249e-02]
mat_Sqrt:  [[ 1.84086635e+01 -7.33409118e-03]
 [-7.33409118e-03  1.68227928e-02]]
grads:  [0.00996306 7.65590447]
Stock Position:  0.00996306068650851
Bond Position:  [18.85575271]


portfolio before change:  [19.9009122]
curr_Stock_Price:  102.53626800746551
curr_Factors:  [1.02536268e+02 3.23820673e-02]
mat_Sqrt:  [[ 1.84514185e+01 -7.19157850e-03]
 [-7.19157850e-03  1.64955106e-02]]
grads:  [3.07035190e-03 3.25271238e+00]
Stock Position:  0.0030703518994087747
Bond Position:  [19.58608977]


portfolio before change:  [19.91534199]
curr_Stock_Price:  99.2571244701115
curr_Factors:  [9.92571245e+01 3.35614282e-02]
mat_Sqrt:  [[ 1.81836838e+01 -7.32115062e-03]
 [-7.32115062e-03  1.67933033e-02]]
grads:  [4.59669253e-03 6.45907178e+00]
Stock Position:  0.004596692528291457
Bond Position:  [19.45908751]


portfolio before change:  [19.94712477]
curr_Stock_Price:  100.87648683449605
curr_Factors:  [1.00876487e+02 3.02778054e-02]
mat_Sqrt:  [[ 1.75530307e+01 -6.95388899e-03]
 [-6.95388899e-03  1.59505950e-02]]
grads:  [0.00483589 3.28670599]
Stock Position:  0.004835888919640038
Bond Position:  [19.45929729]


portfolio before change:  [19.95189812]
curr_Stock_Price:  96.830492418857
curr_Factors:  [9.68304924e+01 2.99639572e-02]
mat_Sqrt:  [[ 1.67614539e+01 -6.91749201e-03]
 [-6.91749201e-03  1.58678252e-02]]
grads:  [0.00397242 1.99639562]
Stock Position:  0.003972416435340193
Bond Position:  [19.56724708]


portfolio before change:  [19.97546972]
curr_Stock_Price:  96.60323697199888
curr_Factors:  [9.6603237e+01 3.4085829e-02]
mat_Sqrt:  [[ 1.78352242e+01 -7.37793877e-03]
 [-7.37793877e-03  1.69240749e-02]]
grads:  [ 5.77419650e-04 -6.66179214e+00]
Stock Position:  0.0005774196496801597
Bond Position:  [19.91968911]


portfolio before change:  [20.00047102]
curr_Stock_Price:  96.75237696139891
curr_Factors:  [9.6752377e+01 2.8871924e-02]
mat_Sqrt:  [[ 1.64399113e+01 -6.79026328e-03]
 [-6.79026328e-03  1.55759932e-02]]
grads:  [1.34354004e-04 1.90709216e+00]
Stock Position:  0.00013435400393918057
Bond Position:  [19.98747195]


portfolio before change:  [20.02585458]
curr_Stock_Price:  99.60753161580955
curr_Factors:  [9.96075316e+01 2.83205865e-02]
mat_Sqrt:  [[ 1.67626727e+01 -6.72529991e-03]
 [-6.72529991e-03  1.54264774e-02]]
grads:  [-7.91583330e-03 -8.70898965e+00]
Stock Position:  -0.007915833295866651
Bond Position:  [20.8143312]


portfolio before change:  [20.04058048]
curr_Stock_Price:  101.03609663206683
curr_Factors:  [1.01036097e+02 2.65996482e-02]
mat_Sqrt:  [[ 1.64783784e+01 -6.51784648e-03]
 [-6.51784648e-03  1.49503899e-02]]
grads:  [1.99137537e-03 3.36132221e+00]
Stock Position:  0.001991375370649721
Bond Position:  [19.83937969]


portfolio before change:  [20.06635724]
curr_Stock_Price:  101.51919676438428
curr_Factors:  [1.01519197e+02 2.66443661e-02]
mat_Sqrt:  [[ 1.65710808e+01 -6.52335103e-03]
 [-6.52335103e-03  1.49629393e-02]]
grads:  [-5.68067535e-03 -6.42787985e+00]
Stock Position:  -0.005680675350295446
Bond Position:  [20.64305484]


portfolio before change:  [20.07849072]
curr_Stock_Price:  103.92850065470367
curr_Factors:  [1.03928501e+02 2.69165244e-02]
mat_Sqrt:  [[ 1.70507749e+01 -6.55671983e-03]
 [-6.55671983e-03  1.50391047e-02]]
grads:  [ 0.00637229 -4.05620975]
Stock Position:  0.006372287122731388
Bond Position:  [19.41622848]


portfolio before change:  [20.09736375]
curr_Stock_Price:  103.07913050448396
curr_Factors:  [1.03079131e+02 2.90160515e-02]
mat_Sqrt:  [[ 1.75585994e+01 -6.80758605e-03]
 [-6.80758605e-03  1.56146498e-02]]
grads:  [-1.93482285e-03 -9.36760508e+00]
Stock Position:  -0.0019348228511228886
Bond Position:  [20.29680361]


portfolio before change:  [20.12007007]
curr_Stock_Price:  104.4645545212406
curr_Factors:  [1.04464555e+02 2.82914180e-02]
mat_Sqrt:  [[ 1.75709920e+01 -6.72212304e-03]
 [-6.72212304e-03  1.54184059e-02]]
grads:  [9.69182903e-04 2.42164244e+00]
Stock Position:  0.00096918290301765
Bond Position:  [20.01882481]


portfolio before change:  [20.14858022]
curr_Stock_Price:  108.04589495975335
curr_Factors:  [1.08045895e+02 2.38137562e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.14858022]
Stock Price:  107.82184386672779
PL:  [12.32673636]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 7.92570486e-02 -2.87812757e-02]
 [ 4.08475787e-02 -1.86478677e-02]
 [ 6.14593631e-02  5.96398001e-02]
 [ 8.82008247e-03  8.44717683e-03]
 [ 4.95678240e-02  1.74492286e-02]
 [ 1.03269105e-01  6.21788574e-02]
 [-5.97110346e-03  1.00893033e-03]
 [-3.19405191e-02  9.93588515e-02]
 [ 4.22266119e-02  3.14967487e-02]
 [ 4.22324400e-02  1.03604607e-01]
 [ 5.82306216e-02 -1.09402637e-01]
 [-1.07137235e-02  3.61034929e-02]
 [-5.07822635e-02 -1.10822558e-01]
 [ 9.83563717e-03  1.09432172e-01]
 [-8.18142752e-02 -2.81787236e-02]
 [ 1.61205555e-02 -1.98266481e-02]
 [-4.43737698e-02  3.59933734e-02]
 [ 1.10956676e-01 -4.13170142e-02]
 [ 1.08858724e-01  5.92384924e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.24050299]
curr_Stock_Price:  98.8855334764284
curr_Factors:  [9.88855335e+01 4.31388657e-02]
mat_Sqrt:  [[ 2.05384226e+01 -8.30026541e-03]
 [-8.30026541e-03  1.90392818e-02]]
grads:  [ 0.00324862 -1.51026239]
Stock Position:  0.0032486170482016225
Bond Position:  [1.91926176]


portfolio before change:  [2.2428404]
curr_Stock_Price:  98.8660867192894
curr_Factors:  [9.88660867e+01 4.52632836e-02]
mat_Sqrt:  [[ 2.10339258e+01 -8.50218534e-03]
 [-8.50218534e-03  1.95024532e-02]]
grads:  [ 0.00155576 -0.95550237]
Stock Position:  0.0015557590522514856
Bond Position:  [2.08902859]


portfolio before change:  [2.2433453]
curr_Stock_Price:  97.51111204665231
curr_Factors:  [9.75111120e+01 4.95079234e-02]
mat_Sqrt:  [[ 2.16965873e+01 -8.89179220e-03]
 [-8.89179220e-03  2.03964523e-02]]
grads:  [0.00403173 2.92578575]
Stock Position:  0.004031732771786682
Bond Position:  [1.85020655]


portfolio before change:  [2.23863329]
curr_Stock_Price:  95.76838482662284
curr_Factors:  [9.57683848e+01 4.26656845e-02]
mat_Sqrt:  [[ 1.97816031e+01 -8.25436912e-03]
 [-8.25436912e-03  1.89346834e-02]]
grads:  [0.00063214 0.44639747]
Stock Position:  0.0006321435078048353
Bond Position:  [2.17809393]


portfolio before change:  [2.2398291]
curr_Stock_Price:  93.35039552507477
curr_Factors:  [9.33503955e+01 4.35184461e-02]
mat_Sqrt:  [[ 1.94738945e+01 -8.33624481e-03]
 [-8.33624481e-03  1.91230616e-02]]
grads:  [0.0029365  0.91375055]
Stock Position:  0.0029364990314189126
Bond Position:  [1.96570575]


portfolio before change:  [2.25352666]
curr_Stock_Price:  97.17770574152873
curr_Factors:  [9.71777057e+01 4.30541430e-02]
mat_Sqrt:  [[ 2.01638788e+01 -8.29197577e-03]
 [-8.29197577e-03  1.90206353e-02]]
grads:  [0.00646697 3.27184031]
Stock Position:  0.006466966347589737
Bond Position:  [1.62508171]


portfolio before change:  [2.25412313]
curr_Stock_Price:  96.9556302828906
curr_Factors:  [9.69556303e+01 4.16193328e-02]
mat_Sqrt:  [[ 1.97797389e+01 -8.15261943e-03]
 [-8.15261943e-03  1.87010194e-02]]
grads:  [-0.00027969  0.05382862]
Stock Position:  -0.00027969323694425227
Bond Position:  [2.28124096]


portfolio before change:  [2.25603071]
curr_Stock_Price:  100.33700082968497
curr_Factors:  [1.00337001e+02 3.84712272e-02]
mat_Sqrt:  [[ 1.96801816e+01 -7.83847283e-03]
 [-7.83847283e-03  1.79797279e-02]]
grads:  [5.78150706e-04 5.52641196e+00]
Stock Position:  0.0005781507055874971
Bond Position:  [2.19802081]


portfolio before change:  [2.25769382]
curr_Stock_Price:  98.45835155362629
curr_Factors:  [9.84583516e+01 4.67861731e-02]
mat_Sqrt:  [[ 2.12966496e+01 -8.64399756e-03]
 [-8.64399756e-03  1.98278349e-02]]
grads:  [0.002628   1.58965743]
Stock Position:  0.0026280005428092486
Bond Position:  [1.99894521]


portfolio before change:  [2.25184017]
curr_Stock_Price:  95.27954993215609
curr_Factors:  [9.52795499e+01 4.87853448e-02]
mat_Sqrt:  [[ 2.10447780e+01 -8.82647074e-03]
 [-8.82647074e-03  2.02471445e-02]]
grads:  [4.15368885e-03 5.11880919e+00]
Stock Position:  0.004153688847192426
Bond Position:  [1.85607856]


portfolio before change:  [2.24252061]
curr_Stock_Price:  92.47695575160604
curr_Factors:  [9.24769558e+01 5.10628192e-02]
mat_Sqrt:  [[ 2.08970931e+01 -9.02988335e-03]
 [-9.02988335e-03  2.07144732e-02]]
grads:  [ 5.04455339e-04 -5.28123892e+00]
Stock Position:  0.0005044553392729129
Bond Position:  [2.19587012]


portfolio before change:  [2.24955023]
curr_Stock_Price:  100.96742815995489
curr_Factors:  [1.00967428e+02 4.70348422e-02]
mat_Sqrt:  [[ 2.18973271e+01 -8.66713893e-03]
 [-8.66713893e-03  1.98803703e-02]]
grads:  [2.29570987e-04 1.81613733e+00]
Stock Position:  0.00022957098696667572
Bond Position:  [2.22637104]


portfolio before change:  [2.25240632]
curr_Stock_Price:  101.27836270187265
curr_Factors:  [1.01278363e+02 4.36277675e-02]
mat_Sqrt:  [[ 2.11542744e+01 -8.34734988e-03]
 [-8.34734988e-03  1.91467863e-02]]
grads:  [-4.68530338e-03 -5.79009273e+00]
Stock Position:  -0.004685303379887246
Bond Position:  [2.72692617]


portfolio before change:  [2.26789778]
curr_Stock_Price:  98.69994296722916
curr_Factors:  [9.8699943e+01 4.4129176e-02]
mat_Sqrt:  [[ 2.07338415e+01 -8.39498204e-03]
 [-8.39498204e-03  1.92565842e-02]]
grads:  [2.77580848e-03 5.68405456e+00]
Stock Position:  0.0027758084762044086
Bond Position:  [1.99392564]


portfolio before change:  [2.25879971]
curr_Stock_Price:  94.52384770222108
curr_Factors:  [9.45238477e+01 4.60735957e-02]
mat_Sqrt:  [[ 2.02893160e+01 -8.57758663e-03]
 [-8.57758663e-03  1.96764063e-02]]
grads:  [-0.00463868 -1.43412938]
Stock Position:  -0.004638679984908383
Bond Position:  [2.69726559]


portfolio before change:  [2.25872766]
curr_Stock_Price:  95.26667572238654
curr_Factors:  [9.52666757e+01 3.96816545e-02]
mat_Sqrt:  [[ 1.89773627e+01 -7.96044280e-03]
 [-7.96044280e-03  1.82605557e-02]]
grads:  [ 3.94088659e-04 -1.08559188e+00]
Stock Position:  0.0003940886594173981
Bond Position:  [2.22118414]


portfolio before change:  [2.26119406]
curr_Stock_Price:  94.47544606005509
curr_Factors:  [9.44754461e+01 3.35212634e-02]
mat_Sqrt:  [[ 1.72973312e+01 -7.31642682e-03]
 [-7.31642682e-03  1.67834005e-02]]
grads:  [-1.65854399e-03  2.14385867e+00]
Stock Position:  -0.0016585439902879976
Bond Position:  [2.41788574]


portfolio before change:  [2.26403098]
curr_Stock_Price:  94.58838878120449
curr_Factors:  [9.45883888e+01 2.70216334e-02]
mat_Sqrt:  [[ 1.55486822e+01 -6.56893773e-03]
 [-6.56893773e-03  1.50686891e-02]]
grads:  [ 0.00597879 -2.7393053 ]
Stock Position:  0.005978792836379398
Bond Position:  [1.6985066]


portfolio before change:  [2.26813535]
curr_Stock_Price:  94.9195431323993
curr_Factors:  [9.49195431e+01 2.64891753e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.26813535]
Stock Price:  97.55135123790421
PL:  [2.26813535]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-1.02672954e-02 -6.24720460e-02]
 [ 1.31533035e-02 -7.60001154e-02]
 [ 5.95315883e-02  6.53703188e-02]
 [ 1.36338973e-02  1.11057240e-02]
 [ 4.46498109e-01  4.16838921e-02]
 [ 7.50155105e-03 -2.12669685e-01]
 [-1.15948009e-01 -1.46895195e-01]
 [ 3.26369474e-02 -1.43551390e-02]
 [-1.47131684e-01 -1.16905244e-01]
 [ 8.87777892e-02  4.30381078e-01]
 [ 5.46660237e-02 -9.96100392e-02]
 [ 1.15977269e-02 -4.58559243e-02]
 [-1.57898292e-01 -1.21390566e-01]
 [-1.69132346e-03  1.56761158e-01]
 [-1.03103583e-01  9.00735401e-02]
 [-7.03372352e-02  2.35192913e-02]
 [-8.57350793e-02  1.41626502e-01]
 [ 6.60748285e-02 -1.36343849e-01]
 [ 8.36996049e-02  5.78820014e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.96598176]
curr_Stock_Price:  99.88130132086219
curr_Factors:  [9.98813013e+01 4.26611109e-02]
mat_Sqrt:  [[ 2.06300479e+01 -8.25425172e-03]
 [-8.25425172e-03  1.89335268e-02]]
grads:  [-1.81817914e-03 -3.30033883e+00]
Stock Position:  -0.0018181791401445054
Bond Position:  [6.14758386]


portfolio before change:  [5.96987982]
curr_Stock_Price:  101.96647613082992
curr_Factors:  [1.01966476e+02 3.96109741e-02]
mat_Sqrt:  [[ 2.02938824e+01 -7.95385251e-03]
 [-7.95385251e-03  1.82440667e-02]]
grads:  [-9.84721693e-04 -4.16617352e+00]
Stock Position:  -0.0009847216934716248
Bond Position:  [6.07028843]


portfolio before change:  [5.98240041]
curr_Stock_Price:  96.96203845361654
curr_Factors:  [9.69620385e+01 4.17961190e-02]
mat_Sqrt:  [[ 1.98230136e+01 -8.16991651e-03]
 [-8.16991651e-03  1.87406951e-02]]
grads:  [0.00444157 3.49008431]
Stock Position:  0.00444156915018074
Bond Position:  [5.55173681]


portfolio before change:  [5.98426599]
curr_Stock_Price:  95.81865243007921
curr_Factors:  [9.58186524e+01 4.24672409e-02]
mat_Sqrt:  [[ 1.97459050e+01 -8.23515482e-03]
 [-8.23515482e-03  1.88905965e-02]]
grads:  [0.00093582 0.58830491]
Stock Position:  0.0009358233646175497
Bond Position:  [5.89459666]


portfolio before change:  [5.98629207]
curr_Stock_Price:  90.10521202528459
curr_Factors:  [9.01052120e+01 5.31292371e-02]
mat_Sqrt:  [[ 2.07690513e+01 -9.21054260e-03]
 [-9.21054260e-03  2.11295593e-02]]
grads:  [0.02237744 1.98253073]
Stock Position:  0.022377444434055604
Bond Position:  [3.9699677]


portfolio before change:  [5.99344274]
curr_Stock_Price:  90.20285965102181
curr_Factors:  [9.02028597e+01 5.59394462e-02]
mat_Sqrt:  [[ 2.13343465e+01 -9.45100483e-03]
 [-9.45100483e-03  2.16811663e-02]]
grads:  [-3.99447108e-03 -9.81070087e+00]
Stock Position:  -0.0039944710835742425
Bond Position:  [6.35375545]


portfolio before change:  [5.98944836]
curr_Stock_Price:  93.19237579964144
curr_Factors:  [9.31923758e+01 5.01024078e-02]
mat_Sqrt:  [[ 2.08597761e+01 -8.94462929e-03]
 [-8.94462929e-03  2.05187155e-02]]
grads:  [-0.00862986 -7.16284535]
Stock Position:  -0.008629862763441682
Bond Position:  [6.79368578]


portfolio before change:  [6.02624427]
curr_Stock_Price:  89.91324073012167
curr_Factors:  [8.99132407e+01 5.10540233e-02]
mat_Sqrt:  [[ 2.03160183e+01 -9.02885066e-03]
 [-9.02885066e-03  2.07128001e-02]]
grads:  [ 0.00129871 -0.6924903 ]
Stock Position:  0.0012987070408918252
Bond Position:  [5.90947331]


portfolio before change:  [6.03119561]
curr_Stock_Price:  88.03436260756995
curr_Factors:  [8.80343626e+01 4.19982253e-02]
mat_Sqrt:  [[ 1.80412926e+01 -8.18886125e-03]
 [-8.18886125e-03  1.87862930e-02]]
grads:  [-0.01098199 -6.22768812]
Stock Position:  -0.010981993534734913
Bond Position:  [6.99798841]


portfolio before change:  [6.08507354]
curr_Stock_Price:  83.92536643770848
curr_Factors:  [8.39253664e+01 4.01726736e-02]
mat_Sqrt:  [[ 1.68212616e+01 -8.00850209e-03]
 [-8.00850209e-03  1.83736395e-02]]
grads:  [1.64330702e-02 2.34309964e+01]
Stock Position:  0.01643307022184036
Bond Position:  [4.7059221]


portfolio before change:  [6.15077968]
curr_Stock_Price:  87.5655910225884
curr_Factors:  [8.75655910e+01 3.30800163e-02]
mat_Sqrt:  [[ 1.59263515e+01 -7.26755760e-03]
 [-7.26755760e-03  1.66728153e-02]]
grads:  [ 7.06312277e-04 -5.97409041e+00]
Stock Position:  0.000706312276603703
Bond Position:  [6.08893103]


portfolio before change:  [6.15975401]
curr_Stock_Price:  89.48881819305207
curr_Factors:  [8.94888182e+01 3.31711625e-02]
mat_Sqrt:  [[ 1.62985540e+01 -7.27772652e-03]
 [-7.27772652e-03  1.66956977e-02]]
grads:  [-5.14935346e-04 -2.74679577e+00]
Stock Position:  -0.0005149353460389685
Bond Position:  [6.20583496]


portfolio before change:  [6.16862291]
curr_Stock_Price:  87.33949924778064
curr_Factors:  [8.73394992e+01 3.74991532e-02]
mat_Sqrt:  [[ 1.69130286e+01 -7.73775865e-03]
 [-7.73775865e-03  1.77515809e-02]]
grads:  [-0.01246692 -6.8437303 ]
Stock Position:  -0.01246692304731103
Bond Position:  [7.25747773]


portfolio before change:  [6.17613257]
curr_Stock_Price:  87.46526047457407
curr_Factors:  [8.74652605e+01 3.80766173e-02]
mat_Sqrt:  [[ 1.70672963e+01 -7.79712117e-03]
 [-7.79712117e-03  1.78877353e-02]]
grads:  [3.90529860e-03 8.76531354e+00]
Stock Position:  0.0039052985973848423
Bond Position:  [5.83455462]


portfolio before change:  [6.18440601]
curr_Stock_Price:  87.71509567196618
curr_Factors:  [8.77150957e+01 3.81162306e-02]
mat_Sqrt:  [[ 1.71249483e+01 -7.80119928e-03]
 [-7.80119928e-03  1.78970276e-02]]
grads:  [-3.72869947e-03  5.03125178e+00]
Stock Position:  -0.00372869947189114
Bond Position:  [6.51146924]


portfolio before change:  [6.18199894]
curr_Stock_Price:  90.54490241604493
curr_Factors:  [9.05449024e+01 4.13082495e-02]
mat_Sqrt:  [[ 1.84027344e+01 -8.12155080e-03]
 [-8.12155080e-03  1.86312347e-02]]
grads:  [-0.00326563  1.26093464]
Stock Position:  -0.003265628308013931
Bond Position:  [6.47768493]


portfolio before change:  [6.19959482]
curr_Stock_Price:  87.6377390441072
curr_Factors:  [8.76377390e+01 3.72088067e-02]
mat_Sqrt:  [[ 1.69049539e+01 -7.70777218e-03]
 [-7.70777218e-03  1.76827123e-02]]
grads:  [-1.42004742e-03  8.00870106e+00]
Stock Position:  -0.0014200474192657554
Bond Position:  [6.32404457]


portfolio before change:  [6.21159937]
curr_Stock_Price:  84.75434949329754
curr_Factors:  [8.47543495e+01 3.83599784e-02]
mat_Sqrt:  [[ 1.65997338e+01 -7.82581789e-03]
 [-7.82581789e-03  1.79542852e-02]]
grads:  [ 4.00450172e-04 -7.59377014e+00]
Stock Position:  0.0004004501715452088
Bond Position:  [6.17765947]


portfolio before change:  [6.22072943]
curr_Stock_Price:  88.25830298456913
curr_Factors:  [8.8258303e+01 3.4297970e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.22072943]
Stock Price:  87.53265725780808
PL:  [6.22072943]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-2.80016466e-02 -6.66521432e-02]
 [-2.36392787e-02 -1.20236968e-01]
 [-3.06675171e-01 -1.67798969e-01]
 [-2.42915297e-02 -2.96094628e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 4.71469115e-02  7.15819151e-02]
 [-3.02929987e-01  4.90378362e-02]
 [ 5.36412162e-02  4.17143195e-02]
 [ 6.10412593e-02 -3.42858663e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 1.29605084e-01  1.77242725e-02]
 [ 1.33015362e-02  1.55056450e-01]
 [-6.19530418e-02 -1.18652193e-01]
 [ 7.21136900e-02 -1.44526439e-01]
 [ 2.90993251e-01 -2.52348757e-01]
 [ 2.43778730e-01 -1.50547869e-01]
 [-1.59483638e-01  5.00712711e-02]
 [-1.06652742e-01 -1.16484211e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.45198049]
curr_Stock_Price:  101.88220302713941
curr_Factors:  [1.01882203e+02 4.01078653e-02]
mat_Sqrt:  [[ 2.04038944e+01 -8.00357876e-03]
 [-8.00357876e-03  1.83581421e-02]]
grads:  [-2.79699873e-03 -3.63187783e+00]
Stock Position:  -0.0027969987339649194
Bond Position:  [13.73694489]


portfolio before change:  [13.46195616]
curr_Stock_Price:  104.45862659444822
curr_Factors:  [1.04458627e+02 3.91604808e-02]
mat_Sqrt:  [[ 2.06713237e+01 -7.90866329e-03]
 [-7.90866329e-03  1.81399518e-02]]
grads:  [-3.68011887e-03 -6.62990034e+00]
Stock Position:  -0.003680118865613886
Bond Position:  [13.84637632]


portfolio before change:  [13.46604879]
curr_Stock_Price:  108.05257639276617
curr_Factors:  [1.08052576e+02 3.47102691e-02]
mat_Sqrt:  [[ 2.01309415e+01 -7.44596061e-03]
 [-7.44596061e-03  1.70780667e-02]]
grads:  [-0.01887125 -9.83363554]
Stock Position:  -0.018871250181650853
Bond Position:  [15.50513599]


portfolio before change:  [13.47600591]
curr_Stock_Price:  108.55261812816005
curr_Factors:  [1.08552618e+02 3.75851331e-02]
mat_Sqrt:  [[ 2.10449704e+01 -7.74821184e-03]
 [-7.74821184e-03  1.77712280e-02]]
grads:  [-0.00176798 -1.66691697]
Stock Position:  -0.0017679832675503505
Bond Position:  [13.66792513]


portfolio before change:  [13.49602153]
curr_Stock_Price:  106.90100415067624
curr_Factors:  [1.06901004e+02 3.82989223e-02]
mat_Sqrt:  [[ 2.09206431e+01 -7.82133801e-03]
 [-7.82133801e-03  1.79392278e-02]]
grads:  [ 0.00783804 -6.58047364]
Stock Position:  0.007838041688930927
Bond Position:  [12.658127]


portfolio before change:  [13.5238486]
curr_Stock_Price:  108.43129902634566
curr_Factors:  [1.08431299e+02 3.43385619e-02]
mat_Sqrt:  [[ 2.00930416e+01 -7.40600637e-03]
 [-7.40600637e-03  1.69863677e-02]]
grads:  [0.00860854 6.25644738]
Stock Position:  0.008608535274379355
Bond Position:  [12.59041393]


portfolio before change:  [13.50559599]
curr_Stock_Price:  104.48167644418352
curr_Factors:  [1.04481676e+02 3.69537391e-02]
mat_Sqrt:  [[ 2.00848825e+01 -7.68260238e-03]
 [-7.68260238e-03  1.76214361e-02]]
grads:  [3.90185500e-03 4.06390779e+00]
Stock Position:  0.0039018550025581994
Bond Position:  [13.09792364]


portfolio before change:  [13.53336188]
curr_Stock_Price:  107.39907198058008
curr_Factors:  [1.07399072e+02 3.72605713e-02]
mat_Sqrt:  [[ 2.07312388e+01 -7.71461503e-03]
 [-7.71461503e-03  1.76943615e-02]]
grads:  [-0.01358315  2.76545991]
Stock Position:  -0.013583150134849977
Bond Position:  [14.9921796]


portfolio before change:  [13.53569148]
curr_Stock_Price:  108.6080951214118
curr_Factors:  [1.08608095e+02 4.05386214e-02]
mat_Sqrt:  [[ 2.18673751e+01 -8.04689092e-03]
 [-8.04689092e-03  1.84562662e-02]]
grads:  [0.00328526 2.26160347]
Stock Position:  0.0032852636541215127
Bond Position:  [13.17888526]


portfolio before change:  [13.56367937]
curr_Stock_Price:  112.1097867716987
curr_Factors:  [1.12109787e+02 3.70457878e-02]
mat_Sqrt:  [[ 2.15780858e+01 -7.69262361e-03]
 [-7.69262361e-03  1.76431692e-02]]
grads:  [ 0.0021364  -1.94236259]
Stock Position:  0.0021363987234980495
Bond Position:  [13.32416817]


portfolio before change:  [13.57295294]
curr_Stock_Price:  108.64973462649407
curr_Factors:  [1.08649735e+02 3.78309218e-02]
mat_Sqrt:  [[ 2.11325596e+01 -7.77351120e-03]
 [-7.77351120e-03  1.78292384e-02]]
grads:  [ 4.54305517e-04 -6.86223217e+00]
Stock Position:  0.0004543055173118056
Bond Position:  [13.52359277]


portfolio before change:  [13.59113037]
curr_Stock_Price:  111.4284156186459
curr_Factors:  [1.11428416e+02 3.55267176e-02]
mat_Sqrt:  [[ 2.10026197e+01 -7.53321631e-03]
 [-7.53321631e-03  1.72776685e-02]]
grads:  [0.00653987 1.02870007]
Stock Position:  0.006539874840855313
Bond Position:  [12.86240248]


portfolio before change:  [13.65145631]
curr_Stock_Price:  118.19274636960807
curr_Factors:  [1.18192746e+02 3.24566041e-02]
mat_Sqrt:  [[ 2.12932689e+01 -7.20070246e-03]
 [-7.20070246e-03  1.65141129e-02]]
grads:  [3.80041404e-03 9.39098679e+00]
Stock Position:  0.0038004140377344672
Bond Position:  [13.20227493]


portfolio before change:  [13.68601901]
curr_Stock_Price:  122.94210870958791
curr_Factors:  [1.22942109e+02 2.86483791e-02]
mat_Sqrt:  [[ 2.08089738e+01 -6.76528905e-03]
 [-6.76528905e-03  1.55149816e-02]]
grads:  [-5.46433999e-03 -7.64997109e+00]
Stock Position:  -0.005464339986758717
Bond Position:  [14.35781649]


portfolio before change:  [13.68504535]
curr_Stock_Price:  126.40678231052924
curr_Factors:  [1.26406782e+02 3.39143742e-02]
mat_Sqrt:  [[ 2.32788895e+01 -7.36100480e-03]
 [-7.36100480e-03  1.68807390e-02]]
grads:  [ 3.90604217e-04 -8.56144770e+00]
Stock Position:  0.0003906042171450158
Bond Position:  [13.63567033]


portfolio before change:  [13.70403756]
curr_Stock_Price:  131.3656767709087
curr_Factors:  [1.31365677e+02 3.07544047e-02]
mat_Sqrt:  [[ 2.30375107e+01 -7.00988252e-03]
 [-7.00988252e-03  1.60749990e-02]]
grads:  [ 7.85565068e-03 -1.56947872e+01]
Stock Position:  0.007855650678086381
Bond Position:  [12.67207469]


portfolio before change:  [13.74598471]
curr_Stock_Price:  134.68776348805093
curr_Factors:  [1.34687763e+02 3.11352483e-02]
mat_Sqrt:  [[ 2.37659013e+01 -7.05327332e-03]
 [-7.05327332e-03  1.61741713e-02]]
grads:  [ 7.49605459e-03 -9.30464960e+00]
Stock Position:  0.007496054587735914
Bond Position:  [12.73635788]


portfolio before change:  [13.70987097]
curr_Stock_Price:  127.74489239703206
curr_Factors:  [1.27744892e+02 3.59388238e-02]
mat_Sqrt:  [[ 2.42172850e+01 -7.57757815e-03]
 [-7.57757815e-03  1.73772422e-02]]
grads:  [-0.00568471  2.87894904]
Stock Position:  -0.005684707294742012
Bond Position:  [14.43606329]


portfolio before change:  [13.77435819]
curr_Stock_Price:  119.57721580120757
curr_Factors:  [1.19577216e+02 4.14558598e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.77435819]
Stock Price:  112.86685004386008
PL:  [0.90750814]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 2.43427325e-02 -4.83062790e-02]
 [-3.28577329e-05 -9.18542424e-02]
 [ 7.44184558e-02 -7.32540966e-02]
 [-2.24044606e-01 -1.21505213e-01]
 [ 5.41062575e-01  5.52520341e-02]
 [-1.83577832e-02 -3.11975337e-01]
 [-2.52033901e-01 -2.99246946e-01]
 [ 3.25862624e-02 -1.45751275e-02]
 [-1.68430304e-01 -1.32873116e-01]
 [ 6.00062395e-02  3.06998563e-01]
 [ 5.75353332e-02 -1.07492554e-01]
 [ 1.38709877e-03 -9.96571293e-03]
 [-1.33289217e-01 -1.32686531e-01]
 [ 1.59464832e-03  1.61082330e-01]
 [-1.00271437e-01  6.61870702e-02]
 [-2.07948301e-01  9.66625766e-02]
 [-1.21259920e-01  2.53460318e-01]
 [-7.37293929e-03 -1.74328203e-01]
 [-4.29918938e-02  6.00399445e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.26280472]
curr_Stock_Price:  99.42606615946119
curr_Factors:  [9.94260662e+01 4.40989863e-02]
mat_Sqrt:  [[ 2.08792322e+01 -8.39216683e-03]
 [-8.39216683e-03  1.92499714e-02]]
grads:  [ 1.57277320e-04 -2.50935226e+00]
Stock Position:  0.0001572773203847519
Bond Position:  [4.24716726]


portfolio before change:  [4.26865647]
curr_Stock_Price:  102.85613918456164
curr_Factors:  [1.02856139e+02 4.04956068e-02]
mat_Sqrt:  [[ 2.06982745e+01 -8.04224134e-03]
 [-8.04224134e-03  1.84466372e-02]]
grads:  [-1.93666606e-03 -4.98030165e+00]
Stock Position:  -0.0019366660563980137
Bond Position:  [4.46785447]


portfolio before change:  [4.27725374]
curr_Stock_Price:  101.30246157459871
curr_Factors:  [1.01302462e+02 3.98730908e-02]
mat_Sqrt:  [[ 2.02283247e+01 -7.98007855e-03]
 [-7.98007855e-03  1.83043507e-02]]
grads:  [ 2.10049289e-03 -4.00108891e+00]
Stock Position:  0.002100492886239768
Bond Position:  [4.06446864]


portfolio before change:  [4.26560699]
curr_Stock_Price:  93.33742033638684
curr_Factors:  [9.33374203e+01 4.64821396e-02]
mat_Sqrt:  [[ 2.01232818e+01 -8.61542619e-03]
 [-8.61542619e-03  1.97634973e-02]]
grads:  [-0.01376831 -6.15396306]
Stock Position:  -0.013768311905135947
Bond Position:  [5.5507057]


portfolio before change:  [4.34304009]
curr_Stock_Price:  88.21766587383323
curr_Factors:  [8.82176659e+01 4.60063851e-02]
mat_Sqrt:  [[ 1.89218926e+01 -8.57073440e-03]
 [-8.57073440e-03  1.96623082e-02]]
grads:  [0.02987325 2.82306987]
Stock Position:  0.029873246261836697
Bond Position:  [1.70769203]


portfolio before change:  [4.34179437]
curr_Stock_Price:  88.10446523825762
curr_Factors:  [8.81044652e+01 5.06192944e-02]
mat_Sqrt:  [[ 1.98223855e+01 -8.99013982e-03]
 [-8.99013982e-03  2.06245080e-02]]
grads:  [-7.78801789e-03 -1.51298325e+01]
Stock Position:  -0.007788017888030049
Bond Position:  [5.02795352]


portfolio before change:  [4.33919688]
curr_Stock_Price:  89.24549514172486
curr_Factors:  [8.92454951e+01 5.02966216e-02]
mat_Sqrt:  [[ 2.00150034e+01 -8.96155927e-03]
 [-8.96155927e-03  2.05586155e-02]]
grads:  [ -0.01911322 -14.56412421]
Stock Position:  -0.019113220042225074
Bond Position:  [6.04496566]


portfolio before change:  [4.33010884]
curr_Stock_Price:  90.11656604252614
curr_Factors:  [9.01165660e+01 4.99028927e-02]
mat_Sqrt:  [[ 2.01310975e+01 -8.92650272e-03]
 [-8.92650272e-03  2.04779510e-02]]
grads:  [ 0.00130335 -0.71117922]
Stock Position:  0.001303352645742452
Bond Position:  [4.21265517]


portfolio before change:  [4.33119496]
curr_Stock_Price:  86.90715683250657
curr_Factors:  [8.69071568e+01 5.11616290e-02]
mat_Sqrt:  [[ 1.96574726e+01 -9.03804222e-03]
 [-9.03804222e-03  2.07347554e-02]]
grads:  [-0.01151692 -6.41325174]
Stock Position:  -0.011516920269395114
Bond Position:  [5.33209775]


portfolio before change:  [4.3127937]
curr_Stock_Price:  89.08400144995451
curr_Factors:  [8.90840014e+01 4.64429071e-02]
mat_Sqrt:  [[ 1.91981496e+01 -8.61138615e-03]
 [-8.61138615e-03  1.97553309e-02]]
grads:  [1.00981295e-02 1.55444383e+01]
Stock Position:  0.01009812948138496
Bond Position:  [3.41321192]


portfolio before change:  [4.34163607]
curr_Stock_Price:  91.5174412839026
curr_Factors:  [9.15174413e+01 4.38946281e-02]
mat_Sqrt:  [[ 1.91738584e+01 -8.37203285e-03]
 [-8.37203285e-03  1.92056072e-02]]
grads:  [ 5.56989313e-04 -5.59669316e+00]
Stock Position:  0.0005569893129493463
Bond Position:  [4.29066184]


portfolio before change:  [4.34754684]
curr_Stock_Price:  92.49426547773099
curr_Factors:  [9.24942655e+01 4.40406543e-02]
mat_Sqrt:  [[ 1.94107202e+01 -8.38603571e-03]
 [-8.38603571e-03  1.92374881e-02]]
grads:  [-1.52375972e-04 -5.18102505e-01]
Stock Position:  -0.00015237597154027646
Bond Position:  [4.36164074]


portfolio before change:  [4.35326339]
curr_Stock_Price:  90.78076700425478
curr_Factors:  [9.07807670e+01 4.87409756e-02]
mat_Sqrt:  [[ 2.00419934e+01 -8.82203587e-03]
 [-8.82203587e-03  2.02381185e-02]]
grads:  [-0.00953825 -6.56042596]
Stock Position:  -0.009538249353500365
Bond Position:  [5.21915298]


portfolio before change:  [4.37122318]
curr_Stock_Price:  89.58224810586614
curr_Factors:  [8.95822481e+01 5.17345308e-02]
mat_Sqrt:  [[ 2.03756828e+01 -9.08879078e-03]
 [-9.08879078e-03  2.08504002e-02]]
grads:  [3.52504429e-03 7.72715950e+00]
Stock Position:  0.003525044289917864
Bond Position:  [4.05544179]


portfolio before change:  [4.37385138]
curr_Stock_Price:  88.88884607062678
curr_Factors:  [8.88888461e+01 4.84019107e-02]
mat_Sqrt:  [[ 1.95559302e+01 -8.79110847e-03]
 [-8.79110847e-03  2.01676850e-02]]
grads:  [-0.00365283  3.28024549]
Stock Position:  -0.003652827662916764
Bond Position:  [4.69854702]


portfolio before change:  [4.40685306]
curr_Stock_Price:  81.46314076156352
curr_Factors:  [8.14631408e+01 5.15154342e-02]
mat_Sqrt:  [[ 1.84896964e+01 -9.06860082e-03]
 [-9.06860082e-03  2.08066052e-02]]
grads:  [-0.00897003  4.64185435]
Stock Position:  -0.00897003244886732
Bond Position:  [5.13758008]


portfolio before change:  [4.42844101]
curr_Stock_Price:  79.77285070020476
curr_Factors:  [7.97728507e+01 5.00724858e-02]
mat_Sqrt:  [[ 1.78506746e+01 -8.94048000e-03]
 [-8.94048000e-03  2.05132317e-02]]
grads:  [-6.04695182e-04  1.23556793e+01]
Stock Position:  -0.0006046951818605986
Bond Position:  [4.47667927]


portfolio before change:  [4.4350174]
curr_Stock_Price:  78.15708550601894
curr_Factors:  [7.81570855e+01 5.09329920e-02]
mat_Sqrt:  [[ 1.76387536e+01 -9.01676080e-03]
 [-9.01676080e-03  2.06888362e-02]]
grads:  [-4.72644013e-03 -8.42825658e+00]
Stock Position:  -0.004726440126122367
Bond Position:  [4.80442219]


portfolio before change:  [4.43952181]
curr_Stock_Price:  78.47547997231081
curr_Factors:  [7.84754800e+01 5.14728152e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.43952181]
Stock Price:  81.01920131186134
PL:  [4.43952181]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.54674283e-01 -3.26105721e-03]
 [ 4.45343129e-02 -5.95128490e-03]
 [ 6.64435889e-02  4.48273962e-02]
 [-1.65904248e-02 -8.67743891e-03]
 [-1.96834448e-01 -3.71290120e-02]
 [ 1.27252440e-01  1.25712419e-01]
 [ 3.92615348e-02  6.13899044e-02]
 [-2.32045033e-01  6.83990135e-02]
 [ 6.54541388e-02  5.61979811e-02]
 [ 6.53641641e-02 -4.62006536e-02]
 [ 6.26150169e-02 -1.21447367e-01]
 [-1.06882219e-02  3.76767856e-02]
 [-9.03214632e-02 -1.38086422e-01]
 [ 4.04412003e-03  1.64303474e-01]
 [-7.03354174e-02 -6.01419065e-02]
 [ 7.49653674e-02 -4.70339072e-02]
 [-5.43906958e-03 -5.91624916e-02]
 [ 3.47966649e-02  4.63781490e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.1071884]
curr_Stock_Price:  96.38702762356482
curr_Factors:  [9.63870276e+01 3.45765292e-02]
mat_Sqrt:  [[ 1.79229399e+01 -7.43083967e-03]
 [-7.43083967e-03  1.70454661e-02]]
grads:  [ 0.00855219 -0.18758697]
Stock Position:  0.008552188174806826
Bond Position:  [-7.93150839]


portfolio before change:  [-7.09897053]
curr_Stock_Price:  98.50794151547544
curr_Factors:  [9.85079415e+01 3.16381254e-02]
mat_Sqrt:  [[ 1.75217137e+01 -7.10822962e-03]
 [-7.10822962e-03  1.63050399e-02]]
grads:  [ 0.00239402 -0.36395297]
Stock Position:  0.0023940153534540956
Bond Position:  [-7.33480005]


portfolio before change:  [-7.10713223]
curr_Stock_Price:  98.93088072762174
curr_Factors:  [9.89308807e+01 2.50380014e-02]
mat_Sqrt:  [[ 1.56542285e+01 -6.32350161e-03]
 [-6.32350161e-03  1.45049420e-02]]
grads:  [0.00549382 3.0928863 ]
Stock Position:  0.005493816582740908
Bond Position:  [-7.65064035]


portfolio before change:  [-7.10503651]
curr_Stock_Price:  101.05417723836189
curr_Factors:  [1.01054177e+02 2.71673818e-02]
mat_Sqrt:  [[ 1.66562845e+01 -6.58703762e-03]
 [-6.58703762e-03  1.51090951e-02]]
grads:  [-0.00122338 -0.57485226]
Stock Position:  -0.0012233819769023279
Bond Position:  [-6.98140865]


portfolio before change:  [-7.11139712]
curr_Stock_Price:  99.11560749603592
curr_Factors:  [9.91156075e+01 2.59932744e-02]
mat_Sqrt:  [[ 1.5979843e+01 -6.4430136e-03]
 [-6.4430136e-03  1.4779050e-02]]
grads:  [-0.01333295 -2.51808583]
Stock Position:  -0.013332953865604118
Bond Position:  [-5.7898933]


portfolio before change:  [-7.14971359]
curr_Stock_Price:  101.4462675486915
curr_Factors:  [1.01446268e+02 2.57218456e-02]
mat_Sqrt:  [[ 1.62699831e+01 -6.40942154e-03]
 [-6.40942154e-03  1.47016248e-02]]
grads:  [0.01119179 8.55579934]
Stock Position:  0.01119178569039752
Bond Position:  [-8.28507848]


portfolio before change:  [-7.1384932]
curr_Stock_Price:  103.37475483873345
curr_Factors:  [1.03374755e+02 2.67729225e-02]
mat_Sqrt:  [[ 1.69146241e+01 -6.53917525e-03]
 [-6.53917525e-03  1.49989470e-02]]
grads:  [3.90414629e-03 4.09464972e+00]
Stock Position:  0.0039041462930946916
Bond Position:  [-7.54208337]


portfolio before change:  [-7.148988]
curr_Stock_Price:  103.10291443874367
curr_Factors:  [1.03102914e+02 2.31729228e-02]
mat_Sqrt:  [[ 1.56949999e+01 -6.08365362e-03]
 [-6.08365362e-03  1.39541530e-02]]
grads:  [-0.01288684  4.89607749]
Stock Position:  -0.012886842634714192
Bond Position:  [-5.82031697]


portfolio before change:  [-7.1329149]
curr_Stock_Price:  101.29075201723037
curr_Factors:  [1.01290752e+02 2.39656950e-02]
mat_Sqrt:  [[ 1.56806758e+01 -6.18674455e-03]
 [-6.18674455e-03  1.41908824e-02]]
grads:  [0.00573764 3.96264848]
Stock Position:  0.0057376374444938335
Bond Position:  [-7.71408451]


portfolio before change:  [-7.14727217]
curr_Stock_Price:  100.47009349456361
curr_Factors:  [1.00470093e+02 2.35187182e-02]
mat_Sqrt:  [[ 1.54079051e+01 -6.12873420e-03]
 [-6.12873420e-03  1.40579443e-02]]
grads:  [ 2.93552319e-03 -3.28516471e+00]
Stock Position:  0.0029355231866366005
Bond Position:  [-7.44220446]


portfolio before change:  [-7.14728096]
curr_Stock_Price:  103.63811074163915
curr_Factors:  [1.03638111e+02 2.42223234e-02]
mat_Sqrt:  [[ 1.61297395e+01 -6.21990804e-03]
 [-6.21990804e-03  1.42666036e-02]]
grads:  [ 5.99415079e-04 -8.51244222e+00]
Stock Position:  0.0005994150789903317
Bond Position:  [-7.2094032]


portfolio before change:  [-7.15839284]
curr_Stock_Price:  100.14387632198257
curr_Factors:  [1.00143876e+02 2.52346748e-02]
mat_Sqrt:  [[ 1.59082797e+01 -6.34835974e-03]
 [-6.34835974e-03  1.45617676e-02]]
grads:  [3.60716417e-04 2.58753446e+00]
Stock Position:  0.00036071641732013236
Bond Position:  [-7.19451638]


portfolio before change:  [-7.16847589]
curr_Stock_Price:  97.13796564383193
curr_Factors:  [9.71379656e+01 2.85727133e-02]
mat_Sqrt:  [[ 1.64196807e+01 -6.75501199e-03]
 [-6.75501199e-03  1.54950620e-02]]
grads:  [-0.00916867 -8.91563757]
Stock Position:  -0.009168674122265075
Bond Position:  [-6.27784954]


portfolio before change:  [-7.15529304]
curr_Stock_Price:  94.84373254424779
curr_Factors:  [9.48437325e+01 2.89491971e-02]
mat_Sqrt:  [[ 1.61371509e+01 -6.79921446e-03]
 [-6.79921446e-03  1.55968796e-02]]
grads:  [4.69001858e-03 1.05364256e+01]
Stock Position:  0.0046900185756322404
Bond Position:  [-7.6001119]


portfolio before change:  [-7.15393314]
curr_Stock_Price:  97.1605629936166
curr_Factors:  [9.71605630e+01 2.78260448e-02]
mat_Sqrt:  [[ 1.62074886e+01 -6.66616744e-03]
 [-6.66616744e-03  1.52912609e-02]]
grads:  [-0.00595844 -3.93568764]
Stock Position:  -0.005958441331510688
Bond Position:  [-6.57500762]


portfolio before change:  [-7.1649903]
curr_Stock_Price:  97.636066843713
curr_Factors:  [9.76360668e+01 2.66065452e-02]
mat_Sqrt:  [[ 1.59259183e+01 -6.51848566e-03]
 [-6.51848566e-03  1.49524178e-02]]
grads:  [ 0.00342026 -3.14408098]
Stock Position:  0.0034202561943523246
Bond Position:  [-7.49893066]


portfolio before change:  [-7.17250357]
curr_Stock_Price:  98.18171414023178
curr_Factors:  [9.81817141e+01 2.70192362e-02]
mat_Sqrt:  [[ 1.61386465e+01 -6.56887911e-03]
 [-6.56887911e-03  1.50679192e-02]]
grads:  [-1.93551411e-03 -3.92723142e+00]
Stock Position:  -0.0019355141136697018
Bond Position:  [-6.98247148]


portfolio before change:  [-7.18652925]
curr_Stock_Price:  100.9159410580742
curr_Factors:  [1.00915941e+02 2.18238692e-02]
mat_Sqrt:  [[ 1.49082139e+01 -5.90379931e-03]
 [-5.90379931e-03  1.35419292e-02]]
grads:  [0.00369094 3.42639066]
Stock Position:  0.0036909443398429956
Bond Position:  [-7.55900437]


portfolio before change:  [-7.17679694]
curr_Stock_Price:  106.11433385575546
curr_Factors:  [1.06114334e+02 1.77482409e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.17679694]
Stock Price:  105.3376718774622
PL:  [-12.51446881]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.68410046e-01  4.06355316e-03]
 [-1.15316902e-01  7.58482387e-02]
 [ 6.67501078e-02  4.39156708e-02]
 [-1.15762107e-02 -1.72083054e-03]
 [-1.34107659e-01 -6.37630641e-02]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-2.00804196e-01  4.42340288e-02]
 [ 4.99681918e-02  4.00303367e-02]
 [ 6.18074900e-02 -3.68695996e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [-3.68931558e-03  3.60777800e-02]
 [ 3.08094681e-02  6.08201613e-02]
 [ 9.70840655e-03 -1.16062414e-01]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 2.62809856e-02 -1.38610883e-01]
 [ 1.07135886e-02  3.99971211e-02]
 [-4.11384861e-02 -4.02893891e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.12404074]
curr_Stock_Price:  97.71895259584323
curr_Factors:  [9.77189526e+01 3.84158945e-02]
mat_Sqrt:  [[ 1.91528868e+01 -7.83264228e-03]
 [-7.83264228e-03  1.79668768e-02]]
grads:  [0.00888701 0.23004343]
Stock Position:  0.008887009863042318
Bond Position:  [-2.99247003]


portfolio before change:  [-2.16555578]
curr_Stock_Price:  93.46869059440971
curr_Factors:  [9.34686906e+01 3.80155488e-02]
mat_Sqrt:  [[ 1.82241278e+01 -7.79138996e-03]
 [-7.79138996e-03  1.78731567e-02]]
grads:  [-0.00451423  4.24172785]
Stock Position:  -0.004514232321156133
Bond Position:  [-1.7436164]


portfolio before change:  [-2.19278827]
curr_Stock_Price:  99.01816172128669
curr_Factors:  [9.90181617e+01 3.29597460e-02]
mat_Sqrt:  [[ 1.79765668e+01 -7.25521164e-03]
 [-7.25521164e-03  1.66420961e-02]]
grads:  [0.00477903 2.64091394]
Stock Position:  0.004779026972849717
Bond Position:  [-2.66599873]


portfolio before change:  [-2.19100468]
curr_Stock_Price:  100.08912575135223
curr_Factors:  [1.00089126e+02 3.05578227e-02]
mat_Sqrt:  [[ 1.74963745e+01 -6.98592082e-03]
 [-6.98592082e-03  1.60242047e-02]]
grads:  [-0.00070464 -0.10769664]
Stock Position:  -0.0007046357517389085
Bond Position:  [-2.12047831]


portfolio before change:  [-2.19391476]
curr_Stock_Price:  100.45502527810854
curr_Factors:  [1.00455025e+02 3.02488624e-02]
mat_Sqrt:  [[ 1.74713376e+01 -6.95053807e-03]
 [-6.95053807e-03  1.59429810e-02]]
grads:  [-0.00926855 -4.003485  ]
Stock Position:  -0.009268553865132492
Bond Position:  [-1.26284195]


portfolio before change:  [-2.24554204]
curr_Stock_Price:  105.85476082499828
curr_Factors:  [1.05854761e+02 2.89011355e-02]
mat_Sqrt:  [[ 1.79956616e+01 -6.79425048e-03]
 [-6.79425048e-03  1.55836297e-02]]
grads:  [0.00961183 6.81971198]
Stock Position:  0.00961182775742991
Bond Position:  [-3.26299977]


portfolio before change:  [-2.21102215]
curr_Stock_Price:  109.8707709198147
curr_Factors:  [1.09870771e+02 2.75608972e-02]
mat_Sqrt:  [[ 1.82401673e+01 -6.63505475e-03]
 [-6.63505475e-03  1.52179177e-02]]
grads:  [4.92040695e-03 5.32400727e+00]
Stock Position:  0.004920406947374371
Bond Position:  [-2.75163105]


portfolio before change:  [-2.21221475]
curr_Stock_Price:  110.32786394703447
curr_Factors:  [1.10327864e+02 2.48164078e-02]
mat_Sqrt:  [[ 1.73801948e+01 -6.29605908e-03]
 [-6.29605908e-03  1.44403504e-02]]
grads:  [-0.0104456   3.05866974]
Stock Position:  -0.010445603918688266
Bond Position:  [-1.05977358]


portfolio before change:  [-2.25670792]
curr_Stock_Price:  114.46047508963353
curr_Factors:  [1.14460475e+02 1.97496576e-02]
mat_Sqrt:  [[ 1.60855273e+01 -5.61684111e-03]
 [-5.61684111e-03  1.28820679e-02]]
grads:  [0.00419212 3.10927436]
Stock Position:  0.00419212192557086
Bond Position:  [-2.73654018]


portfolio before change:  [-2.26673908]
curr_Stock_Price:  112.88410144119375
curr_Factors:  [1.12884101e+02 2.32298531e-02]
mat_Sqrt:  [[ 1.72050518e+01 -6.09159093e-03]
 [-6.09159093e-03  1.39710791e-02]]
grads:  [ 0.00265846 -2.63783529]
Stock Position:  0.0026584561924698855
Bond Position:  [-2.56683652]


portfolio before change:  [-2.29133322]
curr_Stock_Price:  104.84049001031872
curr_Factors:  [1.04840490e+02 2.87632936e-02]
mat_Sqrt:  [[ 1.77806780e+01 -6.77797203e-03]
 [-6.77797203e-03  1.55464475e-02]]
grads:  [ 5.40060338e-04 -7.86985220e+00]
Stock Position:  0.0005400603383094563
Bond Position:  [-2.34795341]


portfolio before change:  [-2.29337629]
curr_Stock_Price:  106.49531798558434
curr_Factors:  [1.06495318e+02 3.10177268e-02]
mat_Sqrt:  [[ 1.87557946e+01 -7.03868199e-03]
 [-7.03868199e-03  1.61441700e-02]]
grads:  [6.42050818e-04 2.23500491e+00]
Stock Position:  0.0006420508183114076
Bond Position:  [-2.3617517]


portfolio before change:  [-2.29463067]
curr_Stock_Price:  109.14255017461417
curr_Factors:  [1.09142550e+02 2.88934956e-02]
mat_Sqrt:  [[ 1.85521442e+01 -6.79352947e-03]
 [-6.79352947e-03  1.55814927e-02]]
grads:  [3.09054343e-03 3.90470659e+00]
Stock Position:  0.0030905434279670067
Bond Position:  [-2.63194046]


portfolio before change:  [-2.30489387]
curr_Stock_Price:  106.8868880464101
curr_Factors:  [1.06886888e+02 2.83116345e-02]
mat_Sqrt:  [[ 1.79848522e+01 -6.72465798e-03]
 [-6.72465798e-03  1.54238556e-02]]
grads:  [-2.27415808e-03 -7.52585539e+00]
Stock Position:  -0.0022741580756632405
Bond Position:  [-2.06181619]


portfolio before change:  [-2.30321601]
curr_Stock_Price:  105.01509838445229
curr_Factors:  [1.05015098e+02 2.62421291e-02]
mat_Sqrt:  [[ 1.70118383e+01 -6.47411829e-03]
 [-6.47411829e-03  1.48494809e-02]]
grads:  [-5.02272354e-03 -5.86856263e+00]
Stock Position:  -0.00502272353533476
Bond Position:  [-1.7757542]


portfolio before change:  [-2.29033867]
curr_Stock_Price:  102.00907648807352
curr_Factors:  [1.02009076e+02 3.03664992e-02]
mat_Sqrt:  [[ 1.77760861e+01 -6.96413688e-03]
 [-6.96413688e-03  1.59739096e-02]]
grads:  [ 0.00611233 -3.81878817]
Stock Position:  0.006112329773851242
Bond Position:  [-2.91385179]


portfolio before change:  [-2.29061993]
curr_Stock_Price:  102.55933126484707
curr_Factors:  [1.02559331e+02 2.97891031e-02]
mat_Sqrt:  [[ 1.77012469e+01 -6.89764344e-03]
 [-6.89764344e-03  1.58213004e-02]]
grads:  [-1.92954068e-03 -8.76187096e+00]
Stock Position:  -0.0019295406822394873
Bond Position:  [-2.09272752]


portfolio before change:  [-2.29490571]
curr_Stock_Price:  103.42391134093282
curr_Factors:  [1.03423911e+02 2.80136280e-02]
mat_Sqrt:  [[ 1.73103402e+01 -6.68898077e-03]
 [-6.68898077e-03  1.53425492e-02]]
grads:  [1.62654865e-03 2.60765017e+00]
Stock Position:  0.0016265486451900865
Bond Position:  [-2.46312974]


portfolio before change:  [-2.30291073]
curr_Stock_Price:  100.39653172296191
curr_Factors:  [1.00396532e+02 3.18779843e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.30291073]
Stock Price:  106.17153835703385
PL:  [-8.47444909]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-2.09127014e-02 -6.32949509e-02]
 [ 2.54699955e-02 -5.75513191e-02]
 [ 7.37931794e-02 -4.29184978e-02]
 [ 1.45686254e-02  1.99587505e-02]
 [-1.86881769e-01 -5.34081737e-04]
 [ 1.28545030e-01  1.30317338e-01]
 [ 2.69255876e-02  4.54454403e-02]
 [ 3.82843987e-02  2.04239529e-02]
 [ 7.46025080e-02  6.63669594e-02]
 [ 6.50714610e-02 -5.10357299e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 7.45136286e-02  2.52849581e-02]
 [ 2.73855230e-02  7.92495159e-02]
 [-1.18283494e-02 -2.00003541e-01]
 [-4.30530369e-02 -8.95381406e-02]
 [ 1.63873152e-01 -9.62045650e-02]
 [ 8.47963450e-02 -1.51504711e-01]
 [-3.26557264e-02  3.74066957e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.30720814]
curr_Stock_Price:  102.11079329413457
curr_Factors:  [1.02110793e+02 3.68320320e-02]
mat_Sqrt:  [[ 1.95967682e+01 -7.66978453e-03]
 [-7.66978453e-03  1.75924622e-02]]
grads:  [-2.47569775e-03 -3.59892426e+00]
Stock Position:  -0.002475697750564557
Bond Position:  [14.5600036]


portfolio before change:  [14.33073029]
curr_Stock_Price:  99.96563183663808
curr_Factors:  [9.99656318e+01 3.20827554e-02]
mat_Sqrt:  [[ 1.79055024e+01 -7.15810055e-03]
 [-7.15810055e-03  1.64191702e-02]]
grads:  [ 2.12220670e-05 -3.50512032e+00]
Stock Position:  2.1222066997749695e-05
Bond Position:  [14.32860882]


portfolio before change:  [14.34866999]
curr_Stock_Price:  100.80119040072123
curr_Factors:  [1.00801190e+02 2.79742902e-02]
mat_Sqrt:  [[ 1.68595184e+01 -6.68412865e-03]
 [-6.68412865e-03  1.53318403e-02]]
grads:  [ 0.0032677  -2.79788045]
Stock Position:  0.0032676963377510555
Bond Position:  [14.0192823]


portfolio before change:  [14.35791598]
curr_Stock_Price:  98.26452017923657
curr_Factors:  [9.82645202e+01 2.75894654e-02]
mat_Sqrt:  [[ 1.63218110e+01 -6.63783907e-03]
 [-6.63783907e-03  1.52260877e-02]]
grads:  [0.00142593 1.31144756]
Stock Position:  0.0014259326580707038
Bond Position:  [14.21779739]


portfolio before change:  [14.37279577]
curr_Stock_Price:  96.2282631833334
curr_Factors:  [9.62282632e+01 2.68603826e-02]
mat_Sqrt:  [[ 1.57709809e+01 -6.54941649e-03]
 [-6.54941649e-03  1.50236137e-02]]
grads:  [-0.01186664 -0.04072264]
Stock Position:  -0.011866635261429323
Bond Position:  [15.51470147]


portfolio before change:  [14.35351507]
curr_Stock_Price:  99.48834490868221
curr_Factors:  [9.94883449e+01 2.69733493e-02]
mat_Sqrt:  [[ 1.63395318e+01 -6.56337916e-03]
 [-6.56337916e-03  1.50550837e-02]]
grads:  [0.01134612 8.66098182]
Stock Position:  0.011346122997954837
Bond Position:  [13.22470807]


portfolio before change:  [14.36779709]
curr_Stock_Price:  99.2892280691303
curr_Factors:  [9.92892281e+01 2.56349995e-02]
mat_Sqrt:  [[ 1.58971311e+01 -6.39846666e-03]
 [-6.39846666e-03  1.46768396e-02]]
grads:  [2.94053275e-03 3.09768700e+00]
Stock Position:  0.0029405327475348223
Bond Position:  [14.07583386]


portfolio before change:  [14.37792771]
curr_Stock_Price:  96.74711376259539
curr_Factors:  [9.67471138e+01 2.50113586e-02]
mat_Sqrt:  [[ 1.53005352e+01 -6.32000425e-03]
 [-6.32000425e-03  1.44972802e-02]]
grads:  [0.00308464 1.41015746]
Stock Position:  0.003084637185881162
Bond Position:  [14.07949797]


portfolio before change:  [14.41300143]
curr_Stock_Price:  102.4085064817525
curr_Factors:  [1.02408506e+02 2.33872993e-02]
mat_Sqrt:  [[ 1.56612361e+01 -6.11169247e-03]
 [-6.11169247e-03  1.40185666e-02]]
grads:  [0.00661214 4.73710136]
Stock Position:  0.006612135474023574
Bond Position:  [13.73586251]


portfolio before change:  [14.43572074]
curr_Stock_Price:  103.24616931351542
curr_Factors:  [1.03246169e+02 1.92491257e-02]
mat_Sqrt:  [[ 1.43244983e+01 -5.54472628e-03]
 [-5.54472628e-03  1.27179899e-02]]
grads:  [ 2.98986973e-03 -4.01157354e+00]
Stock Position:  0.002989869730288109
Bond Position:  [14.12702814]


portfolio before change:  [14.46711937]
curr_Stock_Price:  107.83794482044969
curr_Factors:  [1.07837945e+02 1.88297962e-02]
mat_Sqrt:  [[ 1.47977056e+01 -5.48420678e-03]
 [-5.48420678e-03  1.25786104e-02]]
grads:  [ 6.48820376e-04 -9.72669819e+00]
Stock Position:  0.0006488203762001366
Bond Position:  [14.39715192]


portfolio before change:  [14.48613667]
curr_Stock_Price:  109.3940095607483
curr_Factors:  [1.09394010e+02 1.91582579e-02]
mat_Sqrt:  [[ 1.51415913e+01 -5.53189929e-03]
 [-5.53189929e-03  1.26878158e-02]]
grads:  [0.0056501  1.99531696]
Stock Position:  0.005650101074013358
Bond Position:  [13.86804946]


portfolio before change:  [14.51197958]
curr_Stock_Price:  110.897877537864
curr_Factors:  [1.10897878e+02 1.85666249e-02]
mat_Sqrt:  [[ 1.51108776e+01 -5.44587502e-03]
 [-5.44587502e-03  1.24903440e-02]]
grads:  [4.09960210e-03 6.34664998e+00]
Stock Position:  0.004099602102243386
Bond Position:  [14.05734241]


portfolio before change:  [14.53267824]
curr_Stock_Price:  111.65795111155984
curr_Factors:  [1.11657951e+02 1.75974458e-02]
mat_Sqrt:  [[ 1.48120253e+01 -5.30186236e-03]
 [-5.30186236e-03  1.21599636e-02]]
grads:  [-6.68695159e-03 -1.64506245e+01]
Stock Position:  -0.006686951587188995
Bond Position:  [15.27932956]


portfolio before change:  [14.56276123]
curr_Stock_Price:  110.01716136715967
curr_Factors:  [1.10017161e+02 2.01977313e-02]
mat_Sqrt:  [[ 1.56354974e+01 -5.68001671e-03]
 [-5.68001671e-03  1.30274604e-02]]
grads:  [-5.25119035e-03 -6.87532067e+00]
Stock Position:  -0.00525119035011737
Bond Position:  [15.14048228]


portfolio before change:  [14.57323564]
curr_Stock_Price:  111.62880042001764
curr_Factors:  [1.11628800e+02 1.94493474e-02]
mat_Sqrt:  [[ 1.55678539e+01 -5.57385997e-03]
 [-5.57385997e-03  1.27838006e-02]]
grads:  [ 0.0078332  -7.52209038]
Stock Position:  0.00783319745765243
Bond Position:  [13.69882521]


portfolio before change:  [14.59548731]
curr_Stock_Price:  112.28210045980941
curr_Factors:  [1.12282100e+02 1.89967301e-02]
mat_Sqrt:  [[ 1.54756866e+01 -5.50864819e-03]
 [-5.50864819e-03  1.26341638e-02]]
grads:  [ 1.21102012e-03 -1.19911410e+01]
Stock Position:  0.001211020117570063
Bond Position:  [14.45951143]


portfolio before change:  [14.60884525]
curr_Stock_Price:  108.37816354789308
curr_Factors:  [1.08378164e+02 2.28322210e-02]
mat_Sqrt:  [[ 1.63763020e+01 -6.03902642e-03]
 [-6.03902642e-03  1.38510783e-02]]
grads:  [-9.98342227e-04  2.70019892e+00]
Stock Position:  -0.0009983422268489376
Bond Position:  [14.71704375]


portfolio before change:  [14.625534]
curr_Stock_Price:  110.1000813679729
curr_Factors:  [1.10100081e+02 2.57021840e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.625534]
Stock Price:  109.19515382039987
PL:  [5.43038018]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.69418939e-01  3.38570303e-03]
 [-2.38845304e-02  6.25729106e-02]
 [ 5.91903455e-02  6.63849966e-02]
 [ 2.55412463e-02  2.29323640e-02]
 [-2.11265000e-01 -8.89166535e-03]
 [ 6.53019406e-02 -1.19411641e-02]
 [-1.25329933e-01 -1.59511172e-01]
 [ 3.73776724e-02  4.03286026e-02]
 [ 3.21887746e-02  2.24021036e-02]
 [ 3.75855770e-02  1.71099222e-01]
 [ 5.99564390e-02 -1.14143771e-01]
 [-1.06869699e-02  3.52576538e-02]
 [-9.50043179e-02 -1.38755518e-01]
 [ 2.93038708e-03  1.62838875e-01]
 [-7.51092795e-02 -4.68015981e-02]
 [ 8.21210750e-02 -5.42079833e-02]
 [-6.33626390e-02  7.50178778e-02]
 [ 1.06277440e-01 -9.59988313e-02]
 [ 8.99310596e-02  4.66443374e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.99428418]
curr_Stock_Price:  98.020920563912
curr_Factors:  [9.80209206e+01 4.23340056e-02]
mat_Sqrt:  [[ 2.01680274e+01 -8.22240288e-03]
 [-8.22240288e-03  1.88608628e-02]]
grads:  [0.00847506 0.18320415]
Stock Position:  0.0084750637233206
Bond Position:  [-1.82501772]


portfolio before change:  [-1.01386513]
curr_Stock_Price:  95.97984365826184
curr_Factors:  [9.59798437e+01 4.14041554e-02]
mat_Sqrt:  [[ 1.95299875e+01 -8.13143898e-03]
 [-8.13143898e-03  1.86526474e-02]]
grads:  [1.73790859e-04 3.35471542e+00]
Stock Position:  0.00017379085861984043
Bond Position:  [-1.03054555]


portfolio before change:  [-1.01500031]
curr_Stock_Price:  96.86485670127436
curr_Factors:  [9.68648567e+01 3.69086160e-02]
mat_Sqrt:  [[ 1.86093020e+01 -7.67738126e-03]
 [-7.67738126e-03  1.76109051e-02]]
grads:  [0.00473668 3.77160411]
Stock Position:  0.004736684287122086
Bond Position:  [-1.47381856]


portfolio before change:  [-1.01715472]
curr_Stock_Price:  96.79920274872516
curr_Factors:  [9.67992027e+01 3.55738500e-02]
mat_Sqrt:  [[ 1.82573263e+01 -7.53727541e-03]
 [-7.53727541e-03  1.72895338e-02]]
grads:  [0.00194688 1.32722134]
Stock Position:  0.0019468830444399467
Bond Position:  [-1.20561145]


portfolio before change:  [-1.01685263]
curr_Stock_Price:  97.72891898078248
curr_Factors:  [9.77289190e+01 3.56055761e-02]
mat_Sqrt:  [[ 1.84408981e+01 -7.54070355e-03]
 [-7.54070355e-03  1.72972122e-02]]
grads:  [-0.01166861 -0.51913885]
Stock Position:  -0.01166861135172469
Bond Position:  [0.12350815]


portfolio before change:  [-0.98207858]
curr_Stock_Price:  94.76202209006773
curr_Factors:  [9.47620221e+01 3.94368654e-02]
mat_Sqrt:  [[ 1.88185204e+01 -7.93581090e-03]
 [-7.93581090e-03  1.82041632e-02]]
grads:  [ 0.00319406 -0.65456547]
Stock Position:  0.0031940573131534777
Bond Position:  [-1.28475391]


portfolio before change:  [-0.98971144]
curr_Stock_Price:  92.87541846310279
curr_Factors:  [9.28754185e+01 4.31194651e-02]
mat_Sqrt:  [[ 1.92857897e+01 -8.29790147e-03]
 [-8.29790147e-03  1.90352169e-02]]
grads:  [-0.01010595 -8.38419815]
Stock Position:  -0.010105947789876744
Bond Position:  [-0.05111731]


portfolio before change:  [-1.03321384]
curr_Stock_Price:  97.17372421252071
curr_Factors:  [9.71737242e+01 3.74281184e-02]
mat_Sqrt:  [[ 1.87995653e+01 -7.73124669e-03]
 [-7.73124669e-03  1.77344019e-02]]
grads:  [0.00292393 2.27530698]
Stock Position:  0.002923930999620691
Bond Position:  [-1.3173431]


portfolio before change:  [-1.03293486]
curr_Stock_Price:  97.83265994868646
curr_Factors:  [9.78326599e+01 4.05750671e-02]
mat_Sqrt:  [[ 1.97066793e+01 -8.04975966e-03]
 [-8.04975966e-03  1.84648867e-02]]
grads:  [0.00212935 1.21415553]
Stock Position:  0.002129350876319416
Bond Position:  [-1.24125492]


portfolio before change:  [-1.04291372]
curr_Stock_Price:  93.87543663511637
curr_Factors:  [9.38754366e+01 4.68519220e-02]
mat_Sqrt:  [[ 2.03196225e+01 -8.64967637e-03]
 [-8.64967637e-03  1.98419333e-02]]
grads:  [5.52143760e-03 8.62551937e+00]
Stock Position:  0.005521437604914771
Bond Position:  [-1.56124108]


portfolio before change:  [-1.02194048]
curr_Stock_Price:  98.02761694792581
curr_Factors:  [9.80276169e+01 4.57871141e-02]
mat_Sqrt:  [[ 2.09758730e+01 -8.55117382e-03]
 [-8.55117382e-03  1.96150087e-02]]
grads:  [ 4.86140039e-04 -5.81899378e+00]
Stock Position:  0.00048614003921677076
Bond Position:  [-1.06959563]


portfolio before change:  [-1.0233363]
curr_Stock_Price:  97.90833250096264
curr_Factors:  [9.79083325e+01 4.70367391e-02]
mat_Sqrt:  [[ 2.12343133e+01 -8.66706807e-03]
 [-8.66706807e-03  1.98808783e-02]]
grads:  [2.20606915e-04 1.77354166e+00]
Stock Position:  0.0002206069146268961
Bond Position:  [-1.04493556]


portfolio before change:  [-1.0249687]
curr_Stock_Price:  96.43328155883275
curr_Factors:  [9.64332816e+01 4.75537486e-02]
mat_Sqrt:  [[ 2.10290323e+01 -8.71444573e-03]
 [-8.71444573e-03  1.99898955e-02]]
grads:  [-0.00739558 -6.94450688]
Stock Position:  -0.0073955778986335985
Bond Position:  [-0.31178885]


portfolio before change:  [-1.02280349]
curr_Stock_Price:  96.08777971392819
curr_Factors:  [9.60877797e+01 4.85431468e-02]
mat_Sqrt:  [[ 2.11705472e+01 -8.80460487e-03]
 [-8.80460487e-03  2.01967919e-02]]
grads:  [3.49220517e-03 8.06413331e+00]
Stock Position:  0.0034922051731385846
Bond Position:  [-1.35836173]


portfolio before change:  [-1.02454906]
curr_Stock_Price:  96.07444766651314
curr_Factors:  [9.60744477e+01 5.09495568e-02]
mat_Sqrt:  [[ 2.16859306e+01 -9.02019769e-03]
 [-9.02019769e-03  2.06913412e-02]]
grads:  [-0.00440513 -2.26381329]
Stock Position:  -0.004405129045374288
Bond Position:  [-0.60132872]


portfolio before change:  [-1.03726761]
curr_Stock_Price:  98.7909215117748
curr_Factors:  [9.87909215e+01 5.09646478e-02]
mat_Sqrt:  [[ 2.23023956e+01 -9.02176992e-03]
 [-9.02176992e-03  2.06943022e-02]]
grads:  [ 0.002623   -2.61832066]
Stock Position:  0.002623000217919116
Bond Position:  [-1.29639622]


portfolio before change:  [-1.05592414]
curr_Stock_Price:  92.29644142692071
curr_Factors:  [9.22964414e+01 5.64597775e-02]
mat_Sqrt:  [[ 2.19308012e+01 -9.49507689e-03]
 [-9.49507689e-03  2.17816733e-02]]
grads:  [-1.39833467e-03  3.44347285e+00]
Stock Position:  -0.0013983346667475742
Bond Position:  [-0.92686283]


portfolio before change:  [-1.05326652]
curr_Stock_Price:  89.56682065828917
curr_Factors:  [8.95668207e+01 6.09115464e-02]
mat_Sqrt:  [[ 2.21053262e+01 -9.86201333e-03]
 [-9.86201333e-03  2.26242383e-02]]
grads:  [ 2.91529851e-03 -4.24191433e+00]
Stock Position:  0.002915298506347988
Bond Position:  [-1.31438054]


portfolio before change:  [-1.03741624]
curr_Stock_Price:  95.56767494563789
curr_Factors:  [9.55676749e+01 5.81589615e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.03741624]
Stock Price:  97.6842561718155
PL:  [-1.03741624]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.51125548e-01 -6.06420722e-03]
 [-2.25149002e-03  5.65160580e-02]
 [ 5.48597492e-02  7.92559995e-02]
 [-1.50668083e-01 -8.05031611e-02]
 [-1.52899543e-01  5.29764158e-03]
 [ 1.45236400e-03 -2.39051717e-01]
 [-1.39901275e-01 -1.79106323e-01]
 [ 3.20837247e-02 -1.67562940e-02]
 [-3.82667094e-02 -3.51718794e-02]
 [ 3.76126597e-02  1.79652221e-01]
 [ 5.87198974e-02 -1.10746767e-01]
 [-1.07202870e-02  3.09669109e-02]
 [-1.00997866e-01 -1.39611889e-01]
 [ 3.98845751e-03  1.64230275e-01]
 [-8.21198701e-02 -2.73999566e-02]
 [-1.22152829e-01  5.10604105e-02]
 [-9.14214126e-02  1.59527338e-01]
 [ 6.85809624e-02 -1.34931864e-01]
 [ 5.71886108e-02  5.76157600e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.52278714]
curr_Stock_Price:  96.00865807773093
curr_Factors:  [9.60086581e+01 4.54827962e-02]
mat_Sqrt:  [[ 2.04754729e+01 -8.52254189e-03]
 [-8.52254189e-03  1.95497888e-02]]
grads:  [ 0.00725301 -0.3070311 ]
Stock Position:  0.007253012577513867
Bond Position:  [-9.21913914]


portfolio before change:  [-8.52999869]
curr_Stock_Price:  96.60421432008262
curr_Factors:  [9.66042143e+01 4.26235391e-02]
mat_Sqrt:  [[ 1.99443914e+01 -8.25035952e-03]
 [-8.25035952e-03  1.89252994e-02]]
grads:  [1.12263895e-03 2.98675962e+00]
Stock Position:  0.0011226389491174687
Bond Position:  [-8.63845034]


portfolio before change:  [-8.54189572]
curr_Stock_Price:  95.63131941389791
curr_Factors:  [9.56313194e+01 4.52229486e-02]
mat_Sqrt:  [[ 2.03366562e+01 -8.49812999e-03]
 [-8.49812999e-03  1.94938778e-02]]
grads:  [0.00439732 4.06760365]
Stock Position:  0.004397319431603995
Bond Position:  [-8.96241717]


portfolio before change:  [-8.55982392]
curr_Stock_Price:  94.10352969170245
curr_Factors:  [9.41035297e+01 4.37976811e-02]
mat_Sqrt:  [[ 1.96938866e+01 -8.36301235e-03]
 [-8.36301235e-03  1.91842862e-02]]
grads:  [-0.00943421 -4.20042001]
Stock Position:  -0.00943420926100081
Bond Position:  [-7.67203153]


portfolio before change:  [-8.5791358]
curr_Stock_Price:  95.13338194996511
curr_Factors:  [9.51333819e+01 4.46308166e-02]
mat_Sqrt:  [[ 2.00978830e+01 -8.44226872e-03]
 [-8.44226872e-03  1.93658531e-02]]
grads:  [-0.00749421  0.27028882]
Stock Position:  -0.0074942068167804425
Bond Position:  [-7.86618656]


portfolio before change:  [-8.54823547]
curr_Stock_Price:  89.69728901219825
curr_Factors:  [8.9697289e+01 4.3687475e-02]
mat_Sqrt:  [[ 1.87481209e+01 -8.35208471e-03]
 [-8.35208471e-03  1.91603087e-02]]
grads:  [-5.48169927e-03 -1.24787916e+01]
Stock Position:  -0.005481699266192665
Bond Position:  [-8.05654191]


portfolio before change:  [-8.57302147]
curr_Stock_Price:  92.38058548351783
curr_Factors:  [9.23805855e+01 3.71057499e-02]
mat_Sqrt:  [[ 1.77951346e+01 -7.69750366e-03]
 [-7.69750366e-03  1.76580275e-02]]
grads:  [ -0.01225158 -10.14839451]
Stock Position:  -0.01225158359178673
Bond Position:  [-7.44121301]


portfolio before change:  [-8.57883793]
curr_Stock_Price:  92.09565286844912
curr_Factors:  [9.20956529e+01 3.36996877e-02]
mat_Sqrt:  [[ 1.69064346e+01 -7.33568887e-03]
 [-7.33568887e-03  1.68280880e-02]]
grads:  [ 0.00146595 -0.99509464]
Stock Position:  0.0014659519090288444
Bond Position:  [-8.71384573]


portfolio before change:  [-8.58692503]
curr_Stock_Price:  94.01387370026822
curr_Factors:  [9.40138737e+01 3.38716127e-02]
mat_Sqrt:  [[ 1.73025394e+01 -7.35452645e-03]
 [-7.35452645e-03  1.68708941e-02]]
grads:  [-0.00309834 -2.08611742]
Stock Position:  -0.0030983380014845373
Bond Position:  [-8.29563827]


portfolio before change:  [-8.59631837]
curr_Stock_Price:  93.69670870166688
curr_Factors:  [9.36967087e+01 3.17926334e-02]
mat_Sqrt:  [[ 1.67065797e+01 -7.12522521e-03]
 [-7.12522521e-03  1.63449533e-02]]
grads:  [6.94035994e-03 1.09943215e+01]
Stock Position:  0.0069403599449948655
Bond Position:  [-9.24660726]


portfolio before change:  [-8.6093369]
curr_Stock_Price:  93.48734744036986
curr_Factors:  [9.34873474e+01 2.69944509e-02]
mat_Sqrt:  [[ 1.53599586e+01 -6.56555801e-03]
 [-6.56555801e-03  1.50611406e-02]]
grads:  [ 6.79971667e-04 -7.35284963e+00]
Stock Position:  0.0006799716666445249
Bond Position:  [-8.67290565]


portfolio before change:  [-8.61783203]
curr_Stock_Price:  96.94747137217904
curr_Factors:  [9.69474714e+01 2.48779311e-02]
mat_Sqrt:  [[ 1.52912708e+01 -6.30313645e-03]
 [-6.30313645e-03  1.44585539e-02]]
grads:  [1.81808772e-04 2.14185022e+00]
Stock Position:  0.00018180877244511324
Bond Position:  [-8.63545793]


portfolio before change:  [-8.62890312]
curr_Stock_Price:  95.46226096412043
curr_Factors:  [9.54622610e+01 2.29369033e-02]
mat_Sqrt:  [[ 1.44576954e+01 -6.05216260e-03]
 [-6.05216260e-03  1.38830962e-02]]
grads:  [ -0.01119746 -10.06113158]
Stock Position:  -0.011197460290171176
Bond Position:  [-7.55996825]


portfolio before change:  [-8.63219623]
curr_Stock_Price:  94.91188941767707
curr_Factors:  [9.49118894e+01 2.58674655e-02]
mat_Sqrt:  [[ 1.52650250e+01 -6.42713938e-03]
 [-6.42713938e-03  1.47433556e-02]]
grads:  [4.95223548e-03 1.11414327e+01]
Stock Position:  0.00495223548232624
Bond Position:  [-9.10222226]


portfolio before change:  [-8.64592928]
curr_Stock_Price:  94.43772900094018
curr_Factors:  [9.4437729e+01 2.2888319e-02]
mat_Sqrt:  [[ 1.42873750e+01 -6.04568652e-03]
 [-6.04568652e-03  1.38684125e-02]]
grads:  [-0.00658496 -1.97858026]
Stock Position:  -0.006584956703082712
Bond Position:  [-8.02406092]


portfolio before change:  [-8.60797271]
curr_Stock_Price:  87.14946353031532
curr_Factors:  [8.71494635e+01 2.69430761e-02]
mat_Sqrt:  [[ 1.43050131e+01 -6.55884012e-03]
 [-6.55884012e-03  1.50470056e-02]]
grads:  [-0.00698469  3.39034891]
Stock Position:  -0.006984689319231048
Bond Position:  [-7.99926078]


portfolio before change:  [-8.61263012]
curr_Stock_Price:  86.38380049780152
curr_Factors:  [8.63838005e+01 3.06362628e-02]
mat_Sqrt:  [[ 1.51199430e+01 -6.99386595e-03]
 [-6.99386595e-03  1.60452007e-02]]
grads:  [-1.44777109e-03  9.94173992e+00]
Stock Position:  -0.001447771087395396
Bond Position:  [-8.48756615]


portfolio before change:  [-8.62123635]
curr_Stock_Price:  84.99555860623587
curr_Factors:  [8.49955586e+01 3.05247985e-02]
mat_Sqrt:  [[ 1.48498678e+01 -6.98101056e-03]
 [-6.98101056e-03  1.60160381e-02]]
grads:  [ 6.57875896e-04 -8.42450987e+00]
Stock Position:  0.0006578758961064439
Bond Position:  [-8.67715288]


portfolio before change:  [-8.63119378]
curr_Stock_Price:  86.35720762452918
curr_Factors:  [8.63572076e+01 3.25540726e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.63119378]
Stock Price:  87.19236714722297
PL:  [-8.63119378]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.10652498e-02 -4.80592602e-02]
 [ 3.17534323e-02 -3.94429156e-02]
 [ 6.74305036e-02 -1.35408292e-01]
 [ 2.56119802e-02  2.35386864e-02]
 [ 8.30831642e-02 -9.90062408e-02]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-1.93465491e-01  7.44095256e-02]
 [ 6.70845259e-02  5.70362231e-02]
 [ 6.23103814e-02 -3.73075257e-02]
 [ 6.43731402e-02 -1.22124163e-01]
 [ 2.58656310e-01 -5.44275883e-04]
 [ 1.96975099e-02  1.81217373e-01]
 [-6.89665256e-02 -1.06553867e-01]
 [ 1.86931924e-02 -1.23584530e-01]
 [ 1.89396368e-01 -1.27555248e-01]
 [ 7.19408320e-02 -1.49752902e-01]
 [-4.23065885e-02  3.80803337e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.23927416]
curr_Stock_Price:  103.16177899376977
curr_Factors:  [1.03161779e+02 4.67409063e-02]
mat_Sqrt:  [[ 2.23032090e+01 -8.64018132e-03]
 [-8.64018132e-03  1.98180809e-02]]
grads:  [-4.43390931e-04 -2.42521420e+00]
Stock Position:  -0.0004433909314097124
Bond Position:  [18.28501516]


portfolio before change:  [18.26377461]
curr_Stock_Price:  99.48582476235154
curr_Factors:  [9.94858248e+01 5.27180306e-02]
mat_Sqrt:  [[ 2.28423488e+01 -9.17570906e-03]
 [-9.17570906e-03  2.10472485e-02]]
grads:  [ 6.37436253e-04 -1.87373978e+00]
Stock Position:  0.0006374362533205008
Bond Position:  [18.20035873]


portfolio before change:  [18.28845919]
curr_Stock_Price:  102.49774719892474
curr_Factors:  [1.02497747e+02 5.16470484e-02]
mat_Sqrt:  [[ 2.32936229e+01 -9.08227291e-03]
 [-9.08227291e-03  2.08322539e-02]]
grads:  [ 3.60517102e-04 -6.49977762e+00]
Stock Position:  0.0003605171019330771
Bond Position:  [18.251507]


portfolio before change:  [18.30927813]
curr_Stock_Price:  96.92322536729773
curr_Factors:  [9.69232254e+01 5.77277875e-02]
mat_Sqrt:  [[ 2.32873611e+01 -9.60156292e-03]
 [-9.60156292e-03  2.20247103e-02]]
grads:  [0.00154075 1.06941157]
Stock Position:  0.0015407500452412042
Bond Position:  [18.15994366]


portfolio before change:  [18.34121548]
curr_Stock_Price:  102.90942049481838
curr_Factors:  [1.02909420e+02 5.26660397e-02]
mat_Sqrt:  [[ 2.36167662e+01 -9.17146425e-03]
 [-9.17146425e-03  2.10367450e-02]]
grads:  [ 1.69057110e-03 -4.70561086e+00]
Stock Position:  0.0016905710953039185
Bond Position:  [18.16723979]


portfolio before change:  [18.37321926]
curr_Stock_Price:  108.39900565947323
curr_Factors:  [1.08399006e+02 4.99063876e-02]
mat_Sqrt:  [[ 2.42160518e+01 -8.92834550e-03]
 [-8.92834550e-03  2.04780009e-02]]
grads:  [0.00714285 5.18968308]
Stock Position:  0.007142851082302466
Bond Position:  [17.59894131]


portfolio before change:  [18.40678452]
curr_Stock_Price:  110.01640232919979
curr_Factors:  [1.10016402e+02 4.97019015e-02]
mat_Sqrt:  [[ 2.45269707e+01 -8.91014594e-03]
 [-8.91014594e-03  2.04359564e-02]]
grads:  [3.65919928e-03 3.96459357e+00]
Stock Position:  0.0036591992832678685
Bond Position:  [18.00421258]


portfolio before change:  [18.4011103]
curr_Stock_Price:  102.31155888417763
curr_Factors:  [1.02311559e+02 5.66456434e-02]
mat_Sqrt:  [[ 2.43505024e+01 -9.51161679e-03]
 [-9.51161679e-03  2.18170937e-02]]
grads:  [-0.00661393  3.4077232 ]
Stock Position:  -0.006613930626836771
Bond Position:  [19.07779185]


portfolio before change:  [18.40079999]
curr_Stock_Price:  105.9663378079506
curr_Factors:  [1.05966338e+02 5.41277252e-02]
mat_Sqrt:  [[ 2.46534545e+01 -9.29810367e-03]
 [-9.29810367e-03  2.13265684e-02]]
grads:  [0.00373038 2.67604743]
Stock Position:  0.0037303775142396357
Bond Position:  [18.00550555]


portfolio before change:  [18.44995377]
curr_Stock_Price:  113.10578242441552
curr_Factors:  [1.13105782e+02 5.07178563e-02]
mat_Sqrt:  [[ 2.54721279e+01 -9.00095593e-03]
 [-9.00095593e-03  2.06436759e-02]]
grads:  [ 0.00180789 -1.80642503]
Stock Position:  0.0018078909457828884
Bond Position:  [18.24547085]


portfolio before change:  [18.48024993]
curr_Stock_Price:  117.2404669308064
curr_Factors:  [1.17240467e+02 4.34858453e-02]
mat_Sqrt:  [[ 2.44484580e+01 -8.33478788e-03]
 [-8.33478788e-03  1.91151710e-02]]
grads:  [ 4.55038771e-04 -6.38866216e+00]
Stock Position:  0.00045503877092723454
Bond Position:  [18.42690097]


portfolio before change:  [18.50276537]
curr_Stock_Price:  116.07003561320019
curr_Factors:  [1.16070036e+02 4.31069650e-02]
mat_Sqrt:  [[ 2.40987111e+01 -8.29833371e-03]
 [-8.29833371e-03  1.90317447e-02]]
grads:  [ 0.01072496 -0.02392196]
Stock Position:  0.010724963512160991
Bond Position:  [17.25791847]


portfolio before change:  [18.57555306]
curr_Stock_Price:  120.84411287980966
curr_Factors:  [1.20844113e+02 4.18939018e-02]
mat_Sqrt:  [[ 2.47343715e+01 -8.18099480e-03]
 [-8.18099480e-03  1.87619386e-02]]
grads:  [3.99161749e-03 9.66051708e+00]
Stock Position:  0.003991617490693021
Bond Position:  [18.09318958]


portfolio before change:  [18.61304756]
curr_Stock_Price:  124.56788523133999
curr_Factors:  [1.24567885e+02 4.54347887e-02]
mat_Sqrt:  [[ 2.65521887e+01 -8.51990610e-03]
 [-8.51990610e-03  1.95386562e-02]]
grads:  [-4.34788645e-03 -5.45538593e+00]
Stock Position:  -0.004347886449181262
Bond Position:  [19.15465458]


portfolio before change:  [18.66024795]
curr_Stock_Price:  119.22227544547052
curr_Factors:  [1.19222275e+02 4.34860625e-02]
mat_Sqrt:  [[ 2.48617918e+01 -8.33491695e-03]
 [-8.33491695e-03  1.91151716e-02]]
grads:  [-1.41580092e-03 -6.46587607e+00]
Stock Position:  -0.0014158009161168723
Bond Position:  [18.82904296]


portfolio before change:  [18.68916374]
curr_Stock_Price:  115.43306770065934
curr_Factors:  [1.15433068e+02 4.39880003e-02]
mat_Sqrt:  [[ 2.42101411e+01 -8.38267041e-03]
 [-8.38267041e-03  1.92252657e-02]]
grads:  [ 5.52658752e-03 -6.63236196e+00]
Stock Position:  0.005526587520006372
Bond Position:  [18.05121279]


portfolio before change:  [18.69134863]
curr_Stock_Price:  111.74304611136489
curr_Factors:  [1.11743046e+02 4.02389378e-02]
mat_Sqrt:  [[ 2.24152575e+01 -8.01728193e-03]
 [-8.01728193e-03  1.83878375e-02]]
grads:  [ 2.96588103e-04 -8.14399866e+00]
Stock Position:  0.0002965881030615192
Bond Position:  [18.65820698]


portfolio before change:  [18.71404304]
curr_Stock_Price:  109.57526828145448
curr_Factors:  [1.09575268e+02 4.14666574e-02]
mat_Sqrt:  [[ 2.23132087e+01 -8.13853759e-03]
 [-8.13853759e-03  1.86663006e-02]]
grads:  [-1.15212425e-03  2.03955555e+00]
Stock Position:  -0.0011521242539874403
Bond Position:  [18.84028736]


portfolio before change:  [18.73811707]
curr_Stock_Price:  109.13352108808104
curr_Factors:  [1.09133521e+02 4.02415366e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.73811707]
Stock Price:  115.996684574891
PL:  [2.7414325]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.69746445e-01  3.81980390e-03]
 [ 2.92447779e-02 -4.66726733e-02]
 [ 7.08676606e-02 -1.12462687e-01]
 [-2.05357674e-02 -1.94010955e-02]
 [-3.85293948e-02  1.28755527e-02]
 [ 8.03557617e-02  1.68480385e-02]
 [ 2.55874695e-02  4.37158952e-02]
 [ 3.57635907e-02  1.09739799e-01]
 [ 6.83911721e-02  5.94641959e-02]
 [ 4.91381096e-02  5.61252655e-02]
 [ 5.85940632e-02 -1.10401077e-01]
 [ 1.56809943e-02 -6.13884638e-02]
 [-1.82076214e-01 -1.10292507e-01]
 [ 3.75575929e-05  1.46155847e-01]
 [-1.01897500e-01  1.96989395e-01]
 [-2.45396228e-01  1.16566968e-01]
 [-1.26970167e-01  2.71436436e-01]
 [-9.75697280e-02 -2.21064196e-01]
 [-2.82287393e-02  1.29332552e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.11265565]
curr_Stock_Price:  97.98928154113845
curr_Factors:  [9.79892815e+01 4.01324378e-02]
mat_Sqrt:  [[ 1.96302716e+01 -8.00574422e-03]
 [-8.00574422e-03  1.83638895e-02]]
grads:  [0.00873356 0.21181366]
Stock Position:  0.008733560820089048
Bond Position:  [-1.968451]


portfolio before change:  [-1.10038408]
curr_Stock_Price:  99.67629964834269
curr_Factors:  [9.96762996e+01 4.26490200e-02]
mat_Sqrt:  [[ 2.05847881e+01 -8.25306638e-03]
 [-8.25306638e-03  1.89308504e-02]]
grads:  [ 4.32308633e-04 -2.46524084e+00]
Stock Position:  0.00043230863328112346
Bond Position:  [-1.143475]


portfolio before change:  [-1.10079295]
curr_Stock_Price:  102.03888406582898
curr_Factors:  [1.02038884e+02 4.25987453e-02]
mat_Sqrt:  [[ 2.10602766e+01 -8.24837605e-03]
 [-8.24837605e-03  1.89196127e-02]]
grads:  [ 1.03707454e-03 -5.94378621e+00]
Stock Position:  0.001037074544708792
Bond Position:  [-1.20661488]


portfolio before change:  [-1.10128449]
curr_Stock_Price:  103.02017660306345
curr_Factors:  [1.03020177e+02 4.31911181e-02]
mat_Sqrt:  [[ 2.14101387e+01 -8.30559950e-03]
 [-8.30559950e-03  1.90506745e-02]]
grads:  [-0.00135445 -1.01898466]
Stock Position:  -0.0013544538981130672
Bond Position:  [-0.96174841]


portfolio before change:  [-1.09022622]
curr_Stock_Price:  93.9676680184571
curr_Factors:  [9.39676680e+01 4.70819086e-02]
mat_Sqrt:  [[ 2.03894467e+01 -8.67088844e-03]
 [-8.67088844e-03  1.98905701e-02]]
grads:  [-0.00161469  0.64661555]
Stock Position:  -0.0016146913682672137
Bond Position:  [-0.93849744]


portfolio before change:  [-1.09421516]
curr_Stock_Price:  95.71108613349848
curr_Factors:  [9.57110861e+01 4.55197240e-02]
mat_Sqrt:  [[ 2.04202952e+01 -8.52597566e-03]
 [-8.52597566e-03  1.95577345e-02]]
grads:  [0.00429555 0.86332403]
Stock Position:  0.004295552068469699
Bond Position:  [-1.50534711]


portfolio before change:  [-1.07899113]
curr_Stock_Price:  99.693550750322
curr_Factors:  [9.96935508e+01 4.57525434e-02]
mat_Sqrt:  [[ 2.13242935e+01 -8.54807846e-03]
 [-8.54807846e-03  1.96075442e-02]]
grads:  [2.09402463e-03 2.23045756e+00]
Stock Position:  0.0020940246272498236
Bond Position:  [-1.28775188]


portfolio before change:  [-1.08103459]
curr_Stock_Price:  99.48688376921741
curr_Factors:  [9.94868838e+01 4.53391013e-02]
mat_Sqrt:  [[ 2.11837209e+01 -8.50935229e-03]
 [-8.50935229e-03  1.95187586e-02]]
grads:  [3.94737735e-03 5.62399440e+00]
Stock Position:  0.003947377354130869
Bond Position:  [-1.47374687]


portfolio before change:  [-1.07428209]
curr_Stock_Price:  101.6644909466873
curr_Factors:  [1.01664491e+02 4.53574375e-02]
mat_Sqrt:  [[ 2.16517753e+01 -8.51124063e-03]
 [-8.51124063e-03  1.95226319e-02]]
grads:  [0.00435677 3.04781023]
Stock Position:  0.004356770606799852
Bond Position:  [-1.51721096]


portfolio before change:  [-1.09962672]
curr_Stock_Price:  96.28277003759253
curr_Factors:  [9.62827700e+01 4.98947357e-02]
mat_Sqrt:  [[ 2.15068052e+01 -8.92635406e-03]
 [-8.92635406e-03  2.04760240e-02]]
grads:  [0.00342305 2.74251587]
Stock Position:  0.0034230457041124515
Bond Position:  [-1.42920704]


portfolio before change:  [-1.11272249]
curr_Stock_Price:  92.97923579626162
curr_Factors:  [9.29792358e+01 5.65326448e-02]
mat_Sqrt:  [[ 2.21072939e+01 -9.50127134e-03]
 [-9.50127134e-03  2.17956943e-02]]
grads:  [ 4.73577627e-04 -5.06506358e+00]
Stock Position:  0.0004735776267293287
Bond Position:  [-1.15675538]


portfolio before change:  [-1.11639717]
curr_Stock_Price:  88.27496876821027
curr_Factors:  [8.82749688e+01 5.86245866e-02]
mat_Sqrt:  [[ 2.13735876e+01 -9.67495984e-03]
 [-9.67495984e-03  2.21955180e-02]]
grads:  [-5.18408038e-04 -2.76603049e+00]
Stock Position:  -0.0005184080380973738
Bond Position:  [-1.07063472]


portfolio before change:  [-1.1155259]
curr_Stock_Price:  84.01113588970361
curr_Factors:  [8.40111359e+01 6.36943790e-02]
mat_Sqrt:  [[ 2.12025141e+01 -1.00840958e-02]
 [-1.00840958e-02  2.31355744e-02]]
grads:  [-0.01085707 -4.77195807]
Stock Position:  -0.010857066046917482
Bond Position:  [-0.20341145]


portfolio before change:  [-1.09178596]
curr_Stock_Price:  81.80111312910162
curr_Factors:  [8.18011131e+01 6.77883775e-02]
mat_Sqrt:  [[ 2.12978999e+01 -1.04028237e-02]
 [-1.04028237e-02  2.38676566e-02]]
grads:  [2.99343141e-03 6.12489902e+00]
Stock Position:  0.00299343141161696
Bond Position:  [-1.33665198]


portfolio before change:  [-1.09256586]
curr_Stock_Price:  82.09908428652905
curr_Factors:  [8.20990843e+01 6.42759938e-02]
mat_Sqrt:  [[ 2.08143408e+01 -1.01297747e-02]
 [-1.01297747e-02  2.32410758e-02]]
grads:  [-7.70708464e-04  8.47557962e+00]
Stock Position:  -0.0007707084641014846
Bond Position:  [-1.0292914]


portfolio before change:  [-1.09144017]
curr_Stock_Price:  78.96805622375192
curr_Factors:  [7.89680562e+01 7.21249953e-02]
mat_Sqrt:  [[ 2.12077352e+01 -1.07299841e-02]
 [-1.07299841e-02  2.46194515e-02]]
grads:  [-0.00917756  4.7307509 ]
Stock Position:  -0.009177563987605535
Bond Position:  [-0.36670578]


portfolio before change:  [-1.08758506]
curr_Stock_Price:  78.49802069678417
curr_Factors:  [7.84980207e+01 7.06196739e-02]
mat_Sqrt:  [[ 2.08603458e+01 -1.06173472e-02]
 [-1.06173472e-02  2.43612126e-02]]
grads:  [-4.15714607e-04  1.11419750e+01]
Stock Position:  -0.00041571460747137553
Bond Position:  [-1.05495229]


portfolio before change:  [-1.08538967]
curr_Stock_Price:  70.04292247791092
curr_Factors:  [70.04292248  0.07210409]
mat_Sqrt:  [[ 1.88080658e+01 -1.07268440e-02]
 [-1.07268440e-02  2.46165739e-02]]
grads:  [-0.01031197 -8.9847926 ]
Stock Position:  -0.010311969253138164
Bond Position:  [-0.3631092]


portfolio before change:  [-1.04193656]
curr_Stock_Price:  65.78502769625153
curr_Factors:  [65.7850277   0.07731812]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.04193656]
Stock Price:  65.72568293674942
PL:  [-1.04193656]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-4.25443458e-02 -7.35758120e-02]
 [ 6.69928423e-03  4.55267498e-02]
 [ 5.42910696e-02  8.09470344e-02]
 [-1.70854471e-04  3.48003577e-03]
 [ 1.78948283e-01  2.37043623e-02]
 [ 9.95179309e-02  5.34934001e-02]
 [-3.41679358e-02 -3.69108427e-02]
 [ 3.23171440e-02 -1.57431833e-02]
 [ 4.60951066e-02  3.50005693e-02]
 [ 4.76310442e-02  6.63497662e-02]
 [ 5.93483477e-02 -1.12473233e-01]
 [-1.16004589e-04 -5.21785765e-03]
 [-1.30079079e-01 -1.34160036e-01]
 [ 5.82069494e-03  1.66639734e-01]
 [-8.26274699e-02 -2.59470959e-02]
 [ 6.53769115e-02 -4.26081162e-02]
 [ 4.58371249e-03 -9.15420979e-02]
 [ 3.25345590e-02  4.58103357e-02]
 [-1.48663121e-02 -2.28552837e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.66792283]
curr_Stock_Price:  101.40534961687982
curr_Factors:  [1.01405350e+02 3.69790768e-02]
mat_Sqrt:  [[ 1.95001910e+01 -7.68503139e-03]
 [-7.68503139e-03  1.76275653e-02]]
grads:  [-3.82733546e-03 -4.17557523e+00]
Stock Position:  -0.0038273354622871164
Bond Position:  [12.05603512]


portfolio before change:  [11.70007695]
curr_Stock_Price:  96.94411204671243
curr_Factors:  [9.69441120e+01 3.64941847e-02]
mat_Sqrt:  [[ 1.85196696e+01 -7.63416245e-03]
 [-7.63416245e-03  1.75117507e-02]]
grads:  [1.4336768e-03 2.6004079e+00]
Stock Position:  0.0014336767971332596
Bond Position:  [11.56109043]


portfolio before change:  [11.71242304]
curr_Stock_Price:  95.46936954668666
curr_Factors:  [9.54693695e+01 3.61468951e-02]
mat_Sqrt:  [[ 1.81509565e+01 -7.59764025e-03]
 [-7.59764025e-03  1.74282763e-02]]
grads:  [0.00493612 4.64673247]
Stock Position:  0.004936118447406636
Bond Position:  [11.24117493]


portfolio before change:  [11.72749536]
curr_Stock_Price:  95.67440209878207
curr_Factors:  [9.56744021e+01 4.42958083e-02]
mat_Sqrt:  [[ 2.01361777e+01 -8.41057010e-03]
 [-8.41057010e-03  1.92930141e-02]]
grads:  [6.68683372e-05 1.80407175e-01]
Stock Position:  6.686833722431931e-05
Bond Position:  [11.72109778]


portfolio before change:  [11.74194564]
curr_Stock_Price:  92.53012356424313
curr_Factors:  [9.25301236e+01 4.01349628e-02]
mat_Sqrt:  [[ 1.85372170e+01 -8.00555463e-03]
 [-8.00555463e-03  1.83646596e-02]]
grads:  [0.01021282 1.29521168]
Stock Position:  0.010212815169683377
Bond Position:  [10.79695259]


portfolio before change:  [11.80036218]
curr_Stock_Price:  96.92772661619887
curr_Factors:  [9.69277266e+01 3.89790480e-02]
mat_Sqrt:  [[ 1.91365482e+01 -7.88978391e-03]
 [-7.88978391e-03  1.80981156e-02]]
grads:  [0.00642019 2.95854303]
Stock Position:  0.006420185855017644
Bond Position:  [11.17806816]


portfolio before change:  [11.80834924]
curr_Stock_Price:  95.99406752251569
curr_Factors:  [9.59940675e+01 3.75724339e-02]
mat_Sqrt:  [[ 1.86071141e+01 -7.74604772e-03]
 [-7.74604772e-03  1.77685983e-02]]
grads:  [-0.00270155 -2.07848523]
Stock Position:  -0.002701546370992636
Bond Position:  [12.06768166]


portfolio before change:  [11.82715863]
curr_Stock_Price:  94.61879788148103
curr_Factors:  [9.46187979e+01 3.64704952e-02]
mat_Sqrt:  [[ 1.80695866e+01 -7.63150708e-03]
 [-7.63150708e-03  1.75061433e-02]]
grads:  [ 0.00140893 -0.89868058]
Stock Position:  0.0014089340997410118
Bond Position:  [11.69384698]


portfolio before change:  [11.84752959]
curr_Stock_Price:  98.69600404635398
curr_Factors:  [9.86960040e+01 3.64796857e-02]
mat_Sqrt:  [[ 1.88505957e+01 -7.63277377e-03]
 [-7.63277377e-03  1.75082158e-02]]
grads:  [0.00325531 2.00051317]
Stock Position:  0.003255312038461126
Bond Position:  [11.5262433]


portfolio before change:  [11.85337743]
curr_Stock_Price:  96.06369938442184
curr_Factors:  [9.60636994e+01 4.02992852e-02]
mat_Sqrt:  [[ 1.92844804e+01 -8.02221829e-03]
 [-8.02221829e-03  1.84020886e-02]]
grads:  [0.00397052 3.60728719]
Stock Position:  0.003970523860190409
Bond Position:  [11.47195422]


portfolio before change:  [11.86874384]
curr_Stock_Price:  96.31996320504598
curr_Factors:  [9.63199632e+01 3.63051376e-02]
mat_Sqrt:  [[ 1.83527147e+01 -7.61431692e-03]
 [-7.61431692e-03  1.74663549e-02]]
grads:  [ 5.62228132e-04 -6.43917710e+00]
Stock Position:  0.0005622281319731531
Bond Position:  [11.81459005]


portfolio before change:  [11.88159794]
curr_Stock_Price:  92.89898348083031
curr_Factors:  [9.28989835e+01 3.74466032e-02]
mat_Sqrt:  [[ 1.79769966e+01 -7.73282023e-03]
 [-7.73282023e-03  1.77389268e-02]]
grads:  [-1.33005601e-04 -2.94205293e-01]
Stock Position:  -0.00013300560082872751
Bond Position:  [11.89395403]


portfolio before change:  [11.89669912]
curr_Stock_Price:  91.2115034956828
curr_Factors:  [9.12115035e+01 3.73530796e-02]
mat_Sqrt:  [[ 1.76283953e+01 -7.72301692e-03]
 [-7.72301692e-03  1.77168227e-02]]
grads:  [-0.0106985  -7.57712957]
Stock Position:  -0.010698499572601583
Bond Position:  [12.87252535]


portfolio before change:  [11.89579202]
curr_Stock_Price:  92.80124207943626
curr_Factors:  [9.28012421e+01 3.71019439e-02]
mat_Sqrt:  [[ 1.78752482e+01 -7.69714346e-03]
 [-7.69714346e-03  1.76571068e-02]]
grads:  [4.39029209e-03 9.43945845e+00]
Stock Position:  0.004390292088444323
Bond Position:  [11.48836746]


portfolio before change:  [11.91687242]
curr_Stock_Price:  94.32983305178247
curr_Factors:  [9.43298331e+01 3.66296760e-02]
mat_Sqrt:  [[ 1.80536727e+01 -7.64812068e-03]
 [-7.64812068e-03  1.75443156e-02]]
grads:  [-0.00520426 -1.48121473]
Stock Position:  -0.005204258454154314
Bond Position:  [12.40778925]


portfolio before change:  [11.91721682]
curr_Stock_Price:  97.24572188919964
curr_Factors:  [9.72457219e+01 3.40640254e-02]
mat_Sqrt:  [[ 1.79480988e+01 -7.37562488e-03]
 [-7.37562488e-03  1.69186410e-02]]
grads:  [ 0.0026081  -2.51727547]
Stock Position:  0.0026080997426637938
Bond Position:  [11.66359027]


portfolio before change:  [11.93756293]
curr_Stock_Price:  99.4532718916321
curr_Factors:  [9.94532719e+01 2.68105772e-02]
mat_Sqrt:  [[ 1.62844135e+01 -6.54354354e-03]
 [-6.54354354e-03  1.50095906e-02]]
grads:  [-2.16961702e-03 -6.09985292e+00]
Stock Position:  -0.002169617017177212
Bond Position:  [12.15333844]


portfolio before change:  [11.94908784]
curr_Stock_Price:  101.1477025586963
curr_Factors:  [1.01147703e+02 2.51677859e-02]
mat_Sqrt:  [[ 1.60464325e+01 -6.33999799e-03]
 [-6.33999799e-03  1.45424305e-02]]
grads:  [0.00327271 3.15154229]
Stock Position:  0.0032727106607340385
Bond Position:  [11.61806067]


portfolio before change:  [11.9580284]
curr_Stock_Price:  99.43930296065855
curr_Factors:  [9.94393030e+01 2.94407645e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.9580284]
Stock Price:  98.03755043167484
PL:  [11.9580284]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-2.54555256e-02 -6.54524499e-02]
 [-2.12356424e-01 -2.09565456e-01]
 [-4.76537599e-01 -9.72863712e-02]
 [-2.41140442e-02 -2.91270474e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 3.15958004e-02  5.14817858e-02]
 [-1.51697272e-01  8.08404625e-02]
 [ 8.26923094e-02  7.52348714e-02]
 [ 6.27456926e-02 -4.57494225e-02]
 [ 6.24251319e-02 -1.20925719e-01]
 [-1.04971635e-02  3.58824010e-02]
 [-5.58828176e-02 -1.16240100e-01]
 [ 1.31745902e-02 -5.70920561e-02]
 [-3.83162778e-02 -9.21499527e-02]
 [ 1.54522469e-01 -8.47189314e-02]
 [ 5.95495911e-02 -1.49741284e-01]
 [-4.87728696e-02  3.87662341e-02]
 [-9.14470699e-02 -8.57609540e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.75420603]
curr_Stock_Price:  101.96298364334933
curr_Factors:  [1.01962984e+02 3.72854938e-02]
mat_Sqrt:  [[ 1.96884919e+01 -7.71684378e-03]
 [-7.71684378e-03  1.77004311e-02]]
grads:  [-2.74271941e-03 -3.69898421e+00]
Stock Position:  -0.0027427194067939607
Bond Position:  [14.03386188]


portfolio before change:  [13.75220273]
curr_Stock_Price:  109.09335235863828
curr_Factors:  [1.09093352e+02 3.18188843e-02]
mat_Sqrt:  [[ 1.94599057e+01 -7.12914962e-03]
 [-7.12914962e-03  1.63512712e-02]]
grads:  [ -0.01561032 -12.82326877]
Stock Position:  -0.015610323583035537
Bond Position:  [15.45518526]


portfolio before change:  [13.75481204]
curr_Stock_Price:  110.16455050507254
curr_Factors:  [1.10164551e+02 3.33470262e-02]
mat_Sqrt:  [[ 2.01173325e+01 -7.29839487e-03]
 [-7.29839487e-03  1.67392860e-02]]
grads:  [-0.02580049 -5.8231082 ]
Stock Position:  -0.025800485334748238
Bond Position:  [16.59711091]


portfolio before change:  [13.80525086]
curr_Stock_Price:  109.01420528310328
curr_Factors:  [1.09014205e+02 3.64028493e-02]
mat_Sqrt:  [[ 2.07993974e+01 -7.62540088e-03]
 [-7.62540088e-03  1.74894755e-02]]
grads:  [-0.00177021 -1.66617609]
Stock Position:  -0.0017702101692981687
Bond Position:  [13.99822892]


portfolio before change:  [13.81628438]
curr_Stock_Price:  112.67208018163718
curr_Factors:  [1.12672080e+02 3.07340205e-02]
mat_Sqrt:  [[ 1.97526775e+01 -7.00674844e-03]
 [-7.00674844e-03  1.60700243e-02]]
grads:  [ 0.0083013  -7.34608438]
Stock Position:  0.00830129566644952
Bond Position:  [12.88096013]


portfolio before change:  [13.78233567]
curr_Stock_Price:  106.64169838917948
curr_Factors:  [1.06641698e+02 3.42766329e-02]
mat_Sqrt:  [[ 1.97435889e+01 -7.39922017e-03]
 [-7.39922017e-03  1.69710892e-02]]
grads:  [0.00876089 6.26214283]
Stock Position:  0.00876088651852501
Bond Position:  [12.84805985]


portfolio before change:  [13.76041467]
curr_Stock_Price:  102.30525212613608
curr_Factors:  [1.02305252e+02 3.91032397e-02]
mat_Sqrt:  [[ 2.02303906e+01 -7.90273527e-03]
 [-7.90273527e-03  1.81267529e-02]]
grads:  [2.67170134e-03 2.84126450e+00]
Stock Position:  0.002671701338002938
Bond Position:  [13.48708559]


portfolio before change:  [13.77594714]
curr_Stock_Price:  101.8048484866331
curr_Factors:  [1.01804848e+02 4.09983889e-02]
mat_Sqrt:  [[ 2.06135041e+01 -8.09193803e-03]
 [-8.09193803e-03  1.85608305e-02]]
grads:  [-0.00565034  4.35297011]
Stock Position:  -0.005650340035395039
Bond Position:  [14.35117915]


portfolio before change:  [13.78160705]
curr_Stock_Price:  103.97998870011394
curr_Factors:  [1.03979989e+02 3.79551393e-02]
mat_Sqrt:  [[ 2.02574618e+01 -7.78596812e-03]
 [-7.78596812e-03  1.78586140e-02]]
grads:  [0.00570222 4.21529177]
Stock Position:  0.005702216682598929
Bond Position:  [13.18869062]


portfolio before change:  [13.80202582]
curr_Stock_Price:  104.6678965860552
curr_Factors:  [1.04667897e+02 3.47759052e-02]
mat_Sqrt:  [[ 1.95187808e+01 -7.45279304e-03]
 [-7.45279304e-03  1.70942952e-02]]
grads:  [ 2.19311474e-03 -2.67534152e+00]
Stock Position:  0.0021931147419726646
Bond Position:  [13.57247711]


portfolio before change:  [13.81607775]
curr_Stock_Price:  103.3345091249766
curr_Factors:  [1.03334509e+02 3.41111617e-02]
mat_Sqrt:  [[ 1.90850632e+01 -7.38113573e-03]
 [-7.38113573e-03  1.69301640e-02]]
grads:  [ 5.08571792e-04 -7.14239773e+00]
Stock Position:  0.0005085717921049938
Bond Position:  [13.76352474]


portfolio before change:  [13.8325219]
curr_Stock_Price:  101.81847854099792
curr_Factors:  [1.01818479e+02 3.84570493e-02]
mat_Sqrt:  [[ 1.99670796e+01 -7.83713241e-03]
 [-7.83713241e-03  1.79763692e-02]]
grads:  [2.57790192e-04 1.99619962e+00]
Stock Position:  0.00025779019174780566
Bond Position:  [13.8062741]


portfolio before change:  [13.84960739]
curr_Stock_Price:  101.10803847958373
curr_Factors:  [1.01108038e+02 4.12979885e-02]
mat_Sqrt:  [[ 2.05470795e+01 -8.12140016e-03]
 [-8.12140016e-03  1.86285465e-02]]
grads:  [-5.18700651e-03 -6.24215237e+00]
Stock Position:  -0.005187006506007308
Bond Position:  [14.37405545]


portfolio before change:  [13.84952711]
curr_Stock_Price:  104.58963965196634
curr_Factors:  [1.04589640e+02 3.96697831e-02]
mat_Sqrt:  [[ 2.08314043e+01 -7.95993404e-03]
 [-7.95993404e-03  1.82575267e-02]]
grads:  [-5.62535837e-04 -3.12728744e+00]
Stock Position:  -0.0005625358365516466
Bond Position:  [13.90836253]


portfolio before change:  [13.86346489]
curr_Stock_Price:  110.73777195026844
curr_Factors:  [1.10737772e+02 3.35596712e-02]
mat_Sqrt:  [[ 2.02863821e+01 -7.32165935e-03]
 [-7.32165935e-03  1.67925584e-02]]
grads:  [-3.86991533e-03 -5.48923427e+00]
Stock Position:  -0.0038699153330506103
Bond Position:  [14.29201069]


portfolio before change:  [13.88377793]
curr_Stock_Price:  110.10808024059838
curr_Factors:  [1.10108080e+02 2.82999425e-02]
mat_Sqrt:  [[ 1.85230261e+01 -6.72343782e-03]
 [-6.72343782e-03  1.54205969e-02]]
grads:  [ 0.00634903 -5.49111325]
Stock Position:  0.0063490333304072775
Bond Position:  [13.18469805]


portfolio before change:  [13.88839282]
curr_Stock_Price:  108.23751448224502
curr_Factors:  [1.08237514e+02 2.50736176e-02]
mat_Sqrt:  [[ 1.71390316e+01 -6.32850127e-03]
 [-6.32850127e-03  1.45150352e-02]]
grads:  [-3.34789879e-04 -1.03164340e+01]
Stock Position:  -0.0003347898787380373
Bond Position:  [13.92462964]


portfolio before change:  [13.90501883]
curr_Stock_Price:  110.59916282293757
curr_Factors:  [1.10599163e+02 2.34136314e-02]
mat_Sqrt:  [[ 1.69233447e+01 -6.11553715e-03]
 [-6.11553715e-03  1.40262796e-02]]
grads:  [-1.88352808e-03  2.76300747e+00]
Stock Position:  -0.0018835280758614087
Bond Position:  [14.11333546]


portfolio before change:  [13.91659234]
curr_Stock_Price:  113.82672017991653
curr_Factors:  [1.13826720e+02 2.41520039e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.91659234]
Stock Price:  119.15824560404037
PL:  [-5.24165327]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.54146487e-01 -3.67769825e-03]
 [ 1.23379876e-02  3.85027757e-02]
 [ 6.14449954e-02  5.96833156e-02]
 [-2.50542569e-01 -1.36305191e-01]
 [-2.00824390e-01 -3.10185067e-02]
 [ 1.27499213e-01  1.31281183e-01]
 [ 1.71803009e-02  3.21451990e-02]
 [-5.08558740e-02  9.64273877e-02]
 [ 6.54062188e-03  6.04766197e-04]
 [ 4.22078844e-02  1.03737244e-01]
 [ 5.90645817e-02 -1.11693677e-01]
 [-1.06799976e-02  3.61456125e-02]
 [-1.25216335e-02 -6.58834406e-02]
 [ 1.28899324e-02 -5.41749916e-02]
 [-4.82126404e-02 -8.85581828e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 1.18793128e-01 -1.51125679e-01]
 [-7.58870057e-02  4.15384529e-02]
 [-9.54715613e-02 -9.38864040e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.36415679]
curr_Stock_Price:  96.31834360275346
curr_Factors:  [9.63183436e+01 4.27341607e-02]
mat_Sqrt:  [[ 1.99111598e+01 -8.26103549e-03]
 [-8.26103549e-03  1.89498522e-02]]
grads:  [ 0.00766258 -0.19073486]
Stock Position:  0.00766257825804186
Bond Position:  [-8.10220363]


portfolio before change:  [-7.36779752]
curr_Stock_Price:  97.16575521569395
curr_Factors:  [9.71657552e+01 4.06060883e-02]
mat_Sqrt:  [[ 1.95798234e+01 -8.05278450e-03]
 [-8.05278450e-03  1.84719665e-02]]
grads:  [1.48767178e-03 2.08503820e+00]
Stock Position:  0.0014876717820570986
Bond Position:  [-7.51234827]


portfolio before change:  [-7.37668609]
curr_Stock_Price:  97.50705190273297
curr_Factors:  [9.75070519e+01 3.98934757e-02]
mat_Sqrt:  [[ 1.94754243e+01 -7.98183729e-03]
 [-7.98183729e-03  1.83091515e-02]]
grads:  [0.00449179 3.2617114 ]
Stock Position:  0.004491786362814761
Bond Position:  [-7.81466693]


portfolio before change:  [-7.40642978]
curr_Stock_Price:  93.06132525679867
curr_Factors:  [9.30613253e+01 4.00568730e-02]
mat_Sqrt:  [[ 1.86254903e+01 -7.99780790e-03]
 [-7.99780790e-03  1.83467654e-02]]
grads:  [-0.0166449  -7.43664133]
Stock Position:  -0.016644898615365167
Bond Position:  [-5.85743346]


portfolio before change:  [-7.50986139]
curr_Stock_Price:  98.83518062893279
curr_Factors:  [9.88351806e+01 4.15616223e-02]
mat_Sqrt:  [[ 2.01491983e+01 -8.14711149e-03]
 [-8.14711149e-03  1.86879854e-02]]
grads:  [-0.01063987 -1.66444859]
Stock Position:  -0.010639869415588732
Bond Position:  [-6.45826797]


portfolio before change:  [-7.52891945]
curr_Stock_Price:  99.86716508224069
curr_Factors:  [9.98671651e+01 4.06294651e-02]
mat_Sqrt:  [[ 2.01299752e+01 -8.05530752e-03]
 [-8.05530752e-03  1.84771933e-02]]
grads:  [0.00917859 7.10904072]
Stock Position:  0.009178586688657673
Bond Position:  [-8.44555888]


portfolio before change:  [-7.55891608]
curr_Stock_Price:  97.7499460667062
curr_Factors:  [9.77499461e+01 3.58518413e-02]
mat_Sqrt:  [[ 1.85085426e+01 -7.56673769e-03]
 [-7.56673769e-03  1.73569264e-02]]
grads:  [1.68568293e-03 1.85274474e+00]
Stock Position:  0.0016856829314271207
Bond Position:  [-7.72369149]


portfolio before change:  [-7.56382289]
curr_Stock_Price:  100.57007207380195
curr_Factors:  [1.00570072e+02 3.54107871e-02]
mat_Sqrt:  [[ 1.89250274e+01 -7.52024772e-03]
 [-7.52024772e-03  1.72497463e-02]]
grads:  [-4.65978058e-04  5.58987257e+00]
Stock Position:  -0.0004659780583567933
Bond Position:  [-7.51695944]


portfolio before change:  [-7.57135687]
curr_Stock_Price:  96.56108898933496
curr_Factors:  [9.65610890e+01 4.17103894e-02]
mat_Sqrt:  [[ 1.97207869e+01 -8.16150139e-03]
 [-8.16150139e-03  1.87214794e-02]]
grads:  [0.00034509 0.03245377]
Stock Position:  0.00034509238604469705
Bond Position:  [-7.60467936]


portfolio before change:  [-7.58131215]
curr_Stock_Price:  95.27594781215227
curr_Factors:  [9.52759478e+01 4.63139625e-02]
mat_Sqrt:  [[ 2.05040291e+01 -8.59999801e-03]
 [-8.59999801e-03  1.97276369e-02]]
grads:  [4.26485591e-03 5.26033207e+00]
Stock Position:  0.004264855912457238
Bond Position:  [-7.98765034]


portfolio before change:  [-7.59026296]
curr_Stock_Price:  95.51980038349342
curr_Factors:  [9.55198004e+01 4.04391783e-02]
mat_Sqrt:  [[ 1.92085477e+01 -8.03608659e-03]
 [-8.03608659e-03  1.84340201e-02]]
grads:  [ 5.40122847e-04 -6.05887028e+00]
Stock Position:  0.0005401228468522017
Bond Position:  [-7.64185539]


portfolio before change:  [-7.59843604]
curr_Stock_Price:  98.08443607473366
curr_Factors:  [9.80844361e+01 3.55911998e-02]
mat_Sqrt:  [[ 1.85042453e+01 -7.53920666e-03]
 [-7.53920666e-03  1.72937087e-02]]
grads:  [2.74456704e-04 2.09022149e+00]
Stock Position:  0.0002744567037330818
Bond Position:  [-7.62535597]


portfolio before change:  [-7.60671794]
curr_Stock_Price:  102.65985472320105
curr_Factors:  [1.02659855e+02 3.16986460e-02]
mat_Sqrt:  [[ 1.82776757e+01 -7.11529257e-03]
 [-7.11529257e-03  1.63205108e-02]]
grads:  [-2.25696081e-03 -4.03783316e+00]
Stock Position:  -0.002256960811140357
Bond Position:  [-7.37501867]


portfolio before change:  [-7.62014957]
curr_Stock_Price:  104.52390748655519
curr_Factors:  [1.04523907e+02 3.11860217e-02]
mat_Sqrt:  [[ 1.84584655e+01 -7.05763680e-03]
 [-7.05763680e-03  1.61879579e-02]]
grads:  [-5.81365006e-04 -3.34687643e+00]
Stock Position:  -0.0005813650062104402
Bond Position:  [-7.55938303]


portfolio before change:  [-7.628917]
curr_Stock_Price:  103.34099988660107
curr_Factors:  [1.03341000e+02 2.74709996e-02]
mat_Sqrt:  [[ 1.71281264e+01 -6.62387598e-03]
 [-6.62387598e-03  1.51932308e-02]]
grads:  [-5.06981761e-03 -5.83100234e+00]
Stock Position:  -0.00506981761266609
Bond Position:  [-7.10499698]


portfolio before change:  [-7.65599643]
curr_Stock_Price:  106.92941800854537
curr_Factors:  [1.06929418e+02 2.63215408e-02]
mat_Sqrt:  [[ 1.73481364e+01 -6.48400785e-03]
 [-6.48400785e-03  1.48718879e-02]]
grads:  [ 0.00626299 -4.10189583]
Stock Position:  0.006262986238383183
Bond Position:  [-8.3256939]


portfolio before change:  [-7.60132844]
curr_Stock_Price:  117.3208853953608
curr_Factors:  [1.17320885e+02 2.06162431e-02]
mat_Sqrt:  [[ 1.68453512e+01 -5.73885945e-03]
 [-5.73885945e-03  1.31616079e-02]]
grads:  [ 3.14066569e-03 -1.14809419e+01]
Stock Position:  0.003140665692509752
Bond Position:  [-7.96979412]


portfolio before change:  [-7.61920979]
curr_Stock_Price:  114.80139332698315
curr_Factors:  [1.14801393e+02 2.39091989e-02]
mat_Sqrt:  [[ 1.77512788e+01 -6.18010562e-03]
 [-6.18010562e-03  1.41738591e-02]]
grads:  [-0.00325521  2.92921885]
Stock Position:  -0.0032552090759553646
Bond Position:  [-7.24550725]


portfolio before change:  [-7.63008279]
curr_Stock_Price:  115.35756405091631
curr_Factors:  [1.15357564e+02 2.75021935e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.63008279]
Stock Price:  115.21513754599292
PL:  [-22.84522033]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-5.35561113e-02 -7.87987657e-02]
 [ 2.33027724e-02 -6.37970969e-02]
 [-2.49210029e-01 -1.90953576e-01]
 [-2.22249847e-02 -2.39924804e-02]
 [ 5.26128169e-02 -9.46084791e-02]
 [ 1.28629074e-01  1.10567363e-01]
 [ 2.46547481e-02  4.25103337e-02]
 [ 3.52500166e-02 -3.01362320e-03]
 [-2.39405427e-02 -2.41891254e-02]
 [ 4.98312834e-02  5.11521662e-02]
 [ 5.98001667e-02 -1.13714462e-01]
 [-1.07300819e-02  3.50942822e-02]
 [-7.06918541e-02 -1.31175104e-01]
 [ 1.34350988e-02 -7.91499603e-02]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.40748267e-01 -6.77998012e-02]
 [ 6.31015712e-02 -1.50159800e-01]
 [-8.55291937e-02  4.25008803e-02]
 [-9.92491059e-02 -1.01578641e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.33296469]
curr_Stock_Price:  101.04853416522172
curr_Factors:  [1.01048534e+02 3.99135682e-02]
mat_Sqrt:  [[ 2.01878589e+01 -7.98410989e-03]
 [-7.98410989e-03  1.83136471e-02]]
grads:  [-0.00435533 -4.30463351]
Stock Position:  -0.004355329540539996
Bond Position:  [10.77306436]


portfolio before change:  [10.34429728]
curr_Stock_Price:  101.54038180258705
curr_Factors:  [1.01540382e+02 3.69527061e-02]
mat_Sqrt:  [[ 1.95191941e+01 -7.68229994e-03]
 [-7.68229994e-03  1.76212749e-02]]
grads:  [-2.31128952e-04 -3.62055940e+00]
Stock Position:  -0.0002311289521353663
Bond Position:  [10.3677662]


portfolio before change:  [10.35592042]
curr_Stock_Price:  107.35821213598501
curr_Factors:  [1.07358212e+02 3.59805433e-02]
mat_Sqrt:  [[ 2.03642818e+01 -7.58094283e-03]
 [-7.58094283e-03  1.73877756e-02]]
grads:  [ -0.01632851 -10.98917804]
Stock Position:  -0.016328509020445317
Bond Position:  [12.10891996]


portfolio before change:  [10.4285587]
curr_Stock_Price:  103.83721304335646
curr_Factors:  [1.03837213e+02 3.78295839e-02]
mat_Sqrt:  [[ 2.01961586e+01 -7.77307006e-03]
 [-7.77307006e-03  1.78290555e-02]]
grads:  [-0.00161866 -1.34640124]
Stock Position:  -0.0016186571122000233
Bond Position:  [10.59663555]


portfolio before change:  [10.4438185]
curr_Stock_Price:  102.59808585829437
curr_Factors:  [1.02598086e+02 3.71078693e-02]
mat_Sqrt:  [[ 1.97638812e+01 -7.69848349e-03]
 [-7.69848349e-03  1.76582005e-02]]
grads:  [ 5.75195030e-04 -5.35751369e+00]
Stock Position:  0.0005751950303973757
Bond Position:  [10.38480459]


portfolio before change:  [10.45698819]
curr_Stock_Price:  102.91199987774861
curr_Factors:  [1.02912000e+02 3.67396051e-02]
mat_Sqrt:  [[ 1.97257365e+01 -7.66020863e-03]
 [-7.66020863e-03  1.75703516e-02]]
grads:  [0.00896613 6.29674626]
Stock Position:  0.008966127309925843
Bond Position:  [9.53426609]


portfolio before change:  [10.44449553]
curr_Stock_Price:  100.18864552139429
curr_Factors:  [1.00188646e+02 3.67047517e-02]
mat_Sqrt:  [[ 1.91946243e+01 -7.65638908e-03]
 [-7.65638908e-03  1.75620962e-02]]
grads:  [2.25037524e-03 2.42155395e+00]
Stock Position:  0.00225037524421547
Bond Position:  [10.21903348]


portfolio before change:  [10.44782747]
curr_Stock_Price:  95.9894175822817
curr_Factors:  [9.59894176e+01 3.33498327e-02]
mat_Sqrt:  [[ 1.75295250e+01 -7.29780599e-03]
 [-7.29780599e-03  1.67403810e-02]]
grads:  [ 0.0019363  -0.17917707]
Stock Position:  0.0019362998743178018
Bond Position:  [10.26196317]


portfolio before change:  [10.4586648]
curr_Stock_Price:  94.9574804216594
curr_Factors:  [9.49574804e+01 3.50803925e-02]
mat_Sqrt:  [[ 1.77853070e+01 -7.48467940e-03]
 [-7.48467940e-03  1.71692603e-02]]
grads:  [-0.00193934 -1.40970783]
Stock Position:  -0.0019393398069288306
Bond Position:  [10.64281963]


portfolio before change:  [10.46921155]
curr_Stock_Price:  96.38327144881737
curr_Factors:  [9.63832714e+01 3.58776864e-02]
mat_Sqrt:  [[ 1.82563453e+01 -7.56936402e-03]
 [-7.56936402e-03  1.73632253e-02]]
grads:  [0.00395171 2.94772873]
Stock Position:  0.003951706335468917
Bond Position:  [10.08833317]


portfolio before change:  [10.48660225]
curr_Stock_Price:  97.59095000265175
curr_Factors:  [9.75909500e+01 3.76718034e-02]
mat_Sqrt:  [[ 1.89416459e+01 -7.75640519e-03]
 [-7.75640519e-03  1.77920266e-02]]
grads:  [ 5.39993038e-04 -6.39108047e+00]
Stock Position:  0.0005399930375251172
Bond Position:  [10.43390381]


portfolio before change:  [10.50174736]
curr_Stock_Price:  101.4698542983126
curr_Factors:  [1.01469854e+02 3.52235218e-02]
mat_Sqrt:  [[ 1.90437903e+01 -7.50039699e-03]
 [-7.50039699e-03  1.72040479e-02]]
grads:  [2.40007452e-04 2.03998981e+00]
Stock Position:  0.00024000745159362177
Bond Position:  [10.47739384]


portfolio before change:  [10.51451056]
curr_Stock_Price:  100.04599496090177
curr_Factors:  [1.00045995e+02 3.64703557e-02]
mat_Sqrt:  [[ 1.91059956e+01 -7.63189320e-03]
 [-7.63189320e-03  1.75059351e-02]]
grads:  [-6.69430014e-03 -7.49609740e+00]
Stock Position:  -0.006694300140396847
Bond Position:  [11.18424847]


portfolio before change:  [10.49300383]
curr_Stock_Price:  105.34838294661849
curr_Factors:  [1.05348383e+02 3.48580315e-02]
mat_Sqrt:  [[ 1.96688637e+01 -7.46163024e-03]
 [-7.46163024e-03  1.71144497e-02]]
grads:  [-1.07156785e-03 -4.62521187e+00]
Stock Position:  -0.0010715678463224124
Bond Position:  [10.60589177]


portfolio before change:  [10.50656178]
curr_Stock_Price:  105.07560782560603
curr_Factors:  [1.05075608e+02 3.79136348e-02]
mat_Sqrt:  [[ 2.04597155e+01 -7.78178138e-03]
 [-7.78178138e-03  1.78488158e-02]]
grads:  [-4.17629342e-03 -4.88240178e+00]
Stock Position:  -0.004176293415729267
Bond Position:  [10.94538835]


portfolio before change:  [10.50843213]
curr_Stock_Price:  107.90585492400623
curr_Factors:  [1.07905855e+02 3.60128963e-02]
mat_Sqrt:  [[ 2.04773619e+01 -7.58438322e-03]
 [-7.58438322e-03  1.73955769e-02]]
grads:  [ 0.00543067 -3.89516332]
Stock Position:  0.005430672990139403
Bond Position:  [9.92243072]


portfolio before change:  [10.52954908]
curr_Stock_Price:  109.50900041147077
curr_Factors:  [1.0950900e+02 4.0254652e-02]
mat_Sqrt:  [[ 2.19714047e+01 -8.01871316e-03]
 [-8.01871316e-03  1.83914861e-02]]
grads:  [-1.07807611e-04 -8.16468361e+00]
Stock Position:  -0.00010780761054990014
Bond Position:  [10.54135499]


portfolio before change:  [10.54200456]
curr_Stock_Price:  116.27522791368473
curr_Factors:  [1.16275228e+02 4.12615379e-02]
mat_Sqrt:  [[ 2.36189115e+01 -8.11877456e-03]
 [-8.11877456e-03  1.86199054e-02]]
grads:  [-0.00283704  2.28131379]
Stock Position:  -0.002837036807564025
Bond Position:  [10.87188167]


portfolio before change:  [10.55439969]
curr_Stock_Price:  116.69934173731309
curr_Factors:  [1.16699342e+02 4.38528348e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.55439969]
Stock Price:  115.50943161154744
PL:  [-4.95503192]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 5.99805075e-02 -2.39668844e-02]
 [ 1.49846676e-02 -7.37982100e-02]
 [ 6.00124724e-02  6.39408722e-02]
 [-7.65379955e-02 -3.90811534e-02]
 [ 2.20950064e-01  2.57418955e-02]
 [ 1.12605044e-01  8.54715785e-02]
 [-1.63600032e-01 -2.10978579e-01]
 [ 3.25692598e-02 -1.46489241e-02]
 [-1.15418748e-01 -9.31447665e-02]
 [ 6.10886630e-02  3.11630783e-01]
 [ 5.83325359e-02 -1.09682614e-01]
 [-3.27822860e-03  4.75972589e-03]
 [-1.02559255e-01 -1.39834984e-01]
 [ 3.51944732e-03  1.63613510e-01]
 [-7.32239254e-02 -5.21023255e-02]
 [ 6.40259043e-02 -4.19784731e-02]
 [-3.16530166e-02  4.48761142e-03]
 [ 7.30995536e-02  1.82063452e-02]
 [ 1.05331424e-02 -6.00034846e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [24.73184822]
curr_Stock_Price:  104.89715231891338
curr_Factors:  [1.04897152e+02 4.01553698e-02]
mat_Sqrt:  [[ 2.10201341e+01 -8.00852408e-03]
 [-8.00852408e-03  1.83689205e-02]]
grads:  [ 0.00235677 -1.30372442]
Stock Position:  0.0023567689395171177
Bond Position:  [24.48462987]


portfolio before change:  [24.75541179]
curr_Stock_Price:  101.90095034294018
curr_Factors:  [1.01900950e+02 4.21446177e-02]
mat_Sqrt:  [[ 2.09194017e+01 -8.20428202e-03]
 [-8.20428202e-03  1.88184998e-02]]
grads:  [-8.21820908e-04 -3.92193604e+00]
Stock Position:  -0.0008218209076054388
Bond Position:  [24.83915612]


portfolio before change:  [24.79042649]
curr_Stock_Price:  97.09900638893274
curr_Factors:  [9.70990064e+01 4.33240982e-02]
mat_Sqrt:  [[ 2.02106143e+01 -8.31792470e-03]
 [-8.31792470e-03  1.90801759e-02]]
grads:  [0.00434935 3.35306395]
Stock Position:  0.004349348531698318
Bond Position:  [24.36810906]


portfolio before change:  [24.81124319]
curr_Stock_Price:  94.87741337023036
curr_Factors:  [9.48774134e+01 4.23097205e-02]
mat_Sqrt:  [[ 1.95156435e+01 -8.21978968e-03]
 [-8.21978968e-03  1.88555632e-02]]
grads:  [-0.00479574 -2.07474966]
Stock Position:  -0.004795742526572626
Bond Position:  [25.26625083]


portfolio before change:  [24.85538955]
curr_Stock_Price:  92.26180018101329
curr_Factors:  [9.22618002e+01 4.27077692e-02]
mat_Sqrt:  [[ 1.90666909e+01 -8.25813896e-03]
 [-8.25813896e-03  1.89441504e-02]]
grads:  [0.01217911 1.36413995]
Stock Position:  0.0121791097526425
Bond Position:  [23.73172296]


portfolio before change:  [24.95280861]
curr_Stock_Price:  97.82344242197826
curr_Factors:  [9.78234424e+01 4.16558466e-02]
mat_Sqrt:  [[ 1.99655321e+01 -8.15626325e-03]
 [-8.15626325e-03  1.87091912e-02]]
grads:  [0.00750759 4.57170016]
Stock Position:  0.0075075902696872445
Bond Position:  [24.21839028]


portfolio before change:  [24.9361365]
curr_Stock_Price:  91.56790388365707
curr_Factors:  [9.15679039e+01 4.22280229e-02]
mat_Sqrt:  [[ 1.88167063e+01 -8.21156341e-03]
 [-8.21156341e-03  1.88374748e-02]]
grads:  [ -0.01358461 -11.20586133]
Stock Position:  -0.013584613032841879
Bond Position:  [26.18005104]


portfolio before change:  [24.98878984]
curr_Stock_Price:  90.10243631405889
curr_Factors:  [9.01024363e+01 3.88187963e-02]
mat_Sqrt:  [[ 1.77524184e+01 -7.87298537e-03]
 [-7.87298537e-03  1.80611202e-02]]
grads:  [ 0.00147522 -0.810432  ]
Stock Position:  0.0014752210084324736
Bond Position:  [24.85586883]


portfolio before change:  [25.01930952]
curr_Stock_Price:  89.71633728177041
curr_Factors:  [8.97163373e+01 3.90928787e-02]
mat_Sqrt:  [[ 1.77386399e+01 -7.90069577e-03]
 [-7.90069577e-03  1.81247840e-02]]
grads:  [-0.00879726 -5.14291763]
Stock Position:  -0.008797257099670905
Bond Position:  [25.8085672]


portfolio before change:  [25.058907]
curr_Stock_Price:  88.88464670067037
curr_Factors:  [8.88846467e+01 3.75713659e-02]
mat_Sqrt:  [[ 1.72288067e+01 -7.74534659e-03]
 [-7.74534659e-03  1.77686033e-02]]
grads:  [1.14324422e-02 1.75432658e+01]
Stock Position:  0.011432442197197142
Bond Position:  [24.04273841]


portfolio before change:  [25.13158403]
curr_Stock_Price:  92.61130666248359
curr_Factors:  [9.26113067e+01 3.70967078e-02]
mat_Sqrt:  [[ 1.78374043e+01 -7.69658472e-03]
 [-7.69658472e-03  1.76558676e-02]]
grads:  [ 5.89851970e-04 -6.21199007e+00]
Stock Position:  0.0005898519702701089
Bond Position:  [25.07695707]


portfolio before change:  [25.16363168]
curr_Stock_Price:  93.7672823785145
curr_Factors:  [9.37672824e+01 3.52638899e-02]
mat_Sqrt:  [[ 1.76082582e+01 -7.50413732e-03]
 [-7.50413732e-03  1.72141460e-02]]
grads:  [-6.83515588e-05  2.76471048e-01]
Stock Position:  -6.835155878288191e-05
Bond Position:  [25.17004082]


portfolio before change:  [25.19501356]
curr_Stock_Price:  95.23546902612607
curr_Factors:  [9.52354690e+01 3.50475102e-02]
mat_Sqrt:  [[ 1.78290118e+01 -7.48119179e-03]
 [-7.48119179e-03  1.71612025e-02]]
grads:  [-0.00917316 -8.15231973]
Stock Position:  -0.0091731568902921
Bond Position:  [26.06862345]


portfolio before change:  [25.22578645]
curr_Stock_Price:  95.43531909176494
curr_Factors:  [9.54353191e+01 3.44296333e-02]
mat_Sqrt:  [[ 1.77082355e+01 -7.41496791e-03]
 [-7.41496791e-03  1.70092499e-02]]
grads:  [4.22731882e-03 9.62093308e+00]
Stock Position:  0.004227318820940623
Bond Position:  [24.82235093]


portfolio before change:  [25.26131883]
curr_Stock_Price:  96.49628494625642
curr_Factors:  [9.64962849e+01 3.12548164e-02]
mat_Sqrt:  [[ 1.70596074e+01 -7.06490190e-03]
 [-7.06490190e-03  1.62060274e-02]]
grads:  [-0.00562468 -3.21744879]
Stock Position:  -0.005624683104615575
Bond Position:  [25.80407986]


portfolio before change:  [25.28966873]
curr_Stock_Price:  97.19416860166163
curr_Factors:  [9.71941686e+01 3.08106703e-02]
mat_Sqrt:  [[ 1.70604604e+01 -7.01457225e-03]
 [-7.01457225e-03  1.60904468e-02]]
grads:  [ 0.00268069 -2.60773797]
Stock Position:  0.0026806860412195597
Bond Position:  [25.02912168]


portfolio before change:  [25.31688031]
curr_Stock_Price:  95.66680492531397
curr_Factors:  [9.56668049e+01 3.00918719e-02]
mat_Sqrt:  [[ 1.65953278e+01 -6.93216176e-03]
 [-6.93216176e-03  1.59016934e-02]]
grads:  [-0.00178979  0.28142942]
Stock Position:  -0.001789787030313447
Bond Position:  [25.48810352]


portfolio before change:  [25.34427264]
curr_Stock_Price:  98.17420681918748
curr_Factors:  [9.81742068e+01 2.38027005e-02]
mat_Sqrt:  [[ 1.51464369e+01 -6.16549316e-03]
 [-6.16549316e-03  1.41426199e-02]]
grads:  [0.00535116 1.28967178]
Stock Position:  0.005351160573441217
Bond Position:  [24.8189267]


portfolio before change:  [25.37713306]
curr_Stock_Price:  98.51382607678646
curr_Factors:  [9.85138261e+01 2.71174633e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [25.37713306]
Stock Price:  99.42148226849804
PL:  [25.37713306]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.50299752e-01 -6.71677951e-03]
 [-1.95096907e-01  8.76017513e-02]
 [ 4.03772809e-02  9.69236660e-02]
 [-3.42625982e-01 -1.82324444e-01]
 [ 1.07788430e-01  2.03009887e-02]
 [ 7.83455667e-02  1.30046204e-02]
 [-1.04016349e-01 -1.30851592e-01]
 [-1.65432290e-02  1.01772638e-01]
 [ 1.20432925e-02  5.21948546e-03]
 [ 5.97755099e-02 -2.53019755e-02]
 [ 5.92121005e-02 -1.12098938e-01]
 [-1.07021424e-02  2.79469690e-02]
 [ 6.76389705e-03 -3.83729488e-02]
 [ 1.10238594e-02  9.89826236e-02]
 [-7.03143283e-02 -6.00893664e-02]
 [-4.14624395e-02  8.17170709e-03]
 [-5.36688722e-02  5.72810112e-02]
 [ 1.18826503e-01 -7.51487574e-02]
 [ 1.35336974e-01  7.59499402e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.80408686]
curr_Stock_Price:  95.93347063732361
curr_Factors:  [9.59334706e+01 4.12482570e-02]
mat_Sqrt:  [[ 1.94837666e+01 -8.11611221e-03]
 [-8.11611221e-03  1.86174996e-02]]
grads:  [ 0.00756519 -0.35747977]
Stock Position:  0.007565190461213117
Bond Position:  [-9.52984183]


portfolio before change:  [-8.85117856]
curr_Stock_Price:  91.28428751796542
curr_Factors:  [9.12842875e+01 4.54706295e-02]
mat_Sqrt:  [[ 1.94653166e+01 -8.52098126e-03]
 [-8.52098126e-03  1.95473572e-02]]
grads:  [-0.00806254  4.47799923]
Stock Position:  -0.008062543381676654
Bond Position:  [-8.11519503]


portfolio before change:  [-8.8427118]
curr_Stock_Price:  88.97520188008578
curr_Factors:  [8.89752019e+01 5.19471882e-02]
mat_Sqrt:  [[ 2.02791600e+01 -9.10738808e-03]
 [-9.10738808e-03  2.08932373e-02]]
grads:  [4.07524798e-03 4.64077345e+00]
Stock Position:  0.004075247978689375
Bond Position:  [-9.20530781]


portfolio before change:  [-8.8416033]
curr_Stock_Price:  92.07251557851397
curr_Factors:  [9.20725156e+01 5.71324439e-02]
mat_Sqrt:  [[ 2.20075334e+01 -9.55144892e-03]
 [-9.55144892e-03  2.19110534e-02]]
grads:  [-0.01918364 -8.32947972]
Stock Position:  -0.019183639324808766
Bond Position:  [-7.07531737]


portfolio before change:  [-8.86767682]
curr_Stock_Price:  92.97035544575263
curr_Factors:  [9.29703554e+01 6.17264131e-02]
mat_Sqrt:  [[ 2.30982976e+01 -9.92813214e-03]
 [-9.92813214e-03  2.27749056e-02]]
grads:  [0.00505059 0.89357699]
Stock Position:  0.005050587809041459
Bond Position:  [-9.33723176]


portfolio before change:  [-8.86620839]
curr_Stock_Price:  95.57347192951597
curr_Factors:  [9.55734719e+01 6.28513518e-02]
mat_Sqrt:  [[ 2.39604316e+01 -1.00184605e-02]
 [-1.00184605e-02  2.29813830e-02]]
grads:  [0.00350704 0.56740517]
Stock Position:  0.003507035870247786
Bond Position:  [-9.20138798]


portfolio before change:  [-8.88466442]
curr_Stock_Price:  93.59256695779655
curr_Factors:  [9.3592567e+01 6.4473653e-02]
mat_Sqrt:  [[ 2.37647067e+01 -1.01467278e-02]
 [-1.01467278e-02  2.32761776e-02]]
grads:  [-0.00677846 -5.62465082]
Stock Position:  -0.006778461531164987
Bond Position:  [-8.2502508]


portfolio before change:  [-8.93937938]
curr_Stock_Price:  100.14209199655274
curr_Factors:  [1.00142092e+02 5.55806396e-02]
mat_Sqrt:  [[ 2.36090437e+01 -9.42159510e-03]
 [-9.42159510e-03  2.16111069e-02]]
grads:  [1.17880639e-03 4.70978854e+00]
Stock Position:  0.001178806393885994
Bond Position:  [-9.05742752]


portfolio before change:  [-8.95462783]
curr_Stock_Price:  96.8170473365901
curr_Factors:  [9.68170473e+01 6.18888588e-02]
mat_Sqrt:  [[ 2.40856313e+01 -9.94157659e-03]
 [-9.94157659e-03  2.28046847e-02]]
grads:  [0.0005946  0.22913699]
Stock Position:  0.00059459829999114
Bond Position:  [-9.01219508]


portfolio before change:  [-8.96460616]
curr_Stock_Price:  98.99323811172916
curr_Factors:  [9.89932381e+01 6.09266218e-02]
mat_Sqrt:  [[ 2.44348144e+01 -9.86419402e-03]
 [-9.86419402e-03  2.26266192e-02]]
grads:  [ 0.00199525 -1.11736949]
Stock Position:  0.00199524987679782
Bond Position:  [-9.1621224]


portfolio before change:  [-8.98218143]
curr_Stock_Price:  95.92823122000237
curr_Factors:  [9.59282312e+01 5.79364309e-02]
mat_Sqrt:  [[ 2.30899115e+01 -9.61880428e-03]
 [-9.61880428e-03  2.20645171e-02]]
grads:  [ 4.48056066e-04 -5.08031187e+00]
Stock Position:  0.00044805606628007773
Bond Position:  [-9.02516265]


portfolio before change:  [-8.99332073]
curr_Stock_Price:  96.2612210180707
curr_Factors:  [9.62612210e+01 6.47548539e-02]
mat_Sqrt:  [[ 2.44955668e+01 -1.01691070e-02]
 [-1.01691070e-02  2.33267615e-02]]
grads:  [6.04751732e-05 1.19809104e+00]
Stock Position:  6.0475173197122517e-05
Bond Position:  [-8.99914215]


portfolio before change:  [-9.004145]
curr_Stock_Price:  103.39969325246416
curr_Factors:  [1.03399693e+02 6.23041241e-02]
mat_Sqrt:  [[ 2.58093826e+01 -9.97547482e-03]
 [-9.97547482e-03  2.28808029e-02]]
grads:  [-3.86195096e-04 -1.67724889e+00]
Stock Position:  -0.00038619509642109305
Bond Position:  [-8.96421254]


portfolio before change:  [-9.01375991]
curr_Stock_Price:  99.26354168673207
curr_Factors:  [9.92635417e+01 6.25093660e-02]
mat_Sqrt:  [[ 2.48177427e+01 -9.99152312e-03]
 [-9.99152312e-03  2.29186196e-02]]
grads:  [2.18333701e-03 4.31982554e+00]
Stock Position:  0.0021833370059922918
Bond Position:  [-9.23048567]


portfolio before change:  [-9.02983257]
curr_Stock_Price:  97.18995540591632
curr_Factors:  [9.71899554e+01 6.42858315e-02]
mat_Sqrt:  [[ 2.46421717e+01 -1.01323045e-02]
 [-1.01323045e-02  2.32420894e-02]]
grads:  [-0.00391716 -2.5870762 ]
Stock Position:  -0.003917161743707313
Bond Position:  [-8.64912379]


portfolio before change:  [-9.02197376]
curr_Stock_Price:  92.42197052468902
curr_Factors:  [9.24219705e+01 6.06685417e-02]
mat_Sqrt:  [[ 2.27644395e+01 -9.84263245e-03]
 [-9.84263245e-03  2.25789283e-02]]
grads:  [-0.0016652   0.36119151]
Stock Position:  -0.0016652008652010073
Bond Position:  [-8.86807262]


portfolio before change:  [-9.03487475]
curr_Stock_Price:  93.50830330767904
curr_Factors:  [9.35083033e+01 5.70159093e-02]
mat_Sqrt:  [[ 2.23279147e+01 -9.54184850e-03]
 [-9.54184850e-03  2.18886322e-02]]
grads:  [-1.28555996e-03  2.61636926e+00]
Stock Position:  -0.0012855599555853892
Bond Position:  [-8.91466422]


portfolio before change:  [-9.0435733]
curr_Stock_Price:  91.60116136938035
curr_Factors:  [9.16011614e+01 5.93839276e-02]
mat_Sqrt:  [[ 2.23221179e+01 -9.73778302e-03]
 [-9.73778302e-03  2.23386405e-02]]
grads:  [ 0.00385646 -3.36238923]
Stock Position:  0.003856456949873332
Bond Position:  [-9.39682923]


portfolio before change:  [-9.04998933]
curr_Stock_Price:  92.98516436283194
curr_Factors:  [9.29851644e+01 5.68984188e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.04998933]
Stock Price:  96.25469707647964
PL:  [-9.04998933]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 3.45649577e-02 -3.67566495e-02]
 [ 5.13173847e-03 -8.56446896e-02]
 [-5.72819099e-02 -2.38152084e-01]
 [-2.42915297e-02 -2.96094628e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.34208680e-01  7.61405154e-02]
 [ 5.44239664e-02  8.09876574e-02]
 [-1.35786543e-01  8.33003037e-02]
 [ 8.35065169e-02  7.62656116e-02]
 [ 6.35436723e-02 -4.75631740e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 1.32711957e-03  3.53872183e-02]
 [ 7.40058819e-03 -3.72058633e-02]
 [ 1.17123784e-02  2.36210489e-02]
 [-5.78733635e-02 -8.97621274e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [-5.05166028e-03 -5.77226775e-02]
 [ 6.47819689e-03  3.89790085e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.18448413]
curr_Stock_Price:  103.94899201156531
curr_Factors:  [1.03948992e+02 3.80351303e-02]
mat_Sqrt:  [[ 2.02727519e+01 -7.79416627e-03]
 [-7.79416627e-03  1.78774236e-02]]
grads:  [ 9.1467451e-04 -2.0556385e+00]
Stock Position:  0.0009146745101704655
Bond Position:  [21.08940464]


portfolio before change:  [21.20954041]
curr_Stock_Price:  102.50371431128688
curr_Factors:  [1.02503714e+02 3.96783385e-02]
mat_Sqrt:  [[ 2.04181462e+01 -7.96065047e-03]
 [-7.96065047e-03  1.82595572e-02]]
grads:  [-1.57763584e-03 -4.69109123e+00]
Stock Position:  -0.001577635835656572
Bond Position:  [21.37125394]


portfolio before change:  [21.23216555]
curr_Stock_Price:  105.1061098529015
curr_Factors:  [1.05106110e+02 4.03663443e-02]
mat_Sqrt:  [[ 2.11172636e+01 -8.02954866e-03]
 [-8.02954866e-03  1.84171059e-02]]
grads:  [-7.63067280e-03 -1.29343533e+01]
Stock Position:  -0.007630672802845028
Bond Position:  [22.03419588]


portfolio before change:  [21.23601841]
curr_Stock_Price:  108.21292685176162
curr_Factors:  [1.08212927e+02 3.62667534e-02]
mat_Sqrt:  [[ 2.06078865e+01 -7.61108600e-03]
 [-7.61108600e-03  1.74567724e-02]]
grads:  [-0.00180548 -1.69694625]
Stock Position:  -0.0018054803220632347
Bond Position:  [21.43139472]


portfolio before change:  [21.25838351]
curr_Stock_Price:  110.67260276112364
curr_Factors:  [1.10672603e+02 3.72552528e-02]
mat_Sqrt:  [[ 2.13616036e+01 -7.71425900e-03]
 [-7.71425900e-03  1.76930138e-02]]
grads:  [ 0.00767612 -6.67216483]
Stock Position:  0.007676117238574522
Bond Position:  [20.40884763]


portfolio before change:  [21.3046997]
curr_Stock_Price:  113.38089699818332
curr_Factors:  [1.13380897e+02 3.65483748e-02]
mat_Sqrt:  [[ 2.16757382e+01 -7.64087472e-03]
 [-7.64087472e-03  1.75242912e-02]]
grads:  [0.00772444 4.34822362]
Stock Position:  0.0077244387582250966
Bond Position:  [20.42889591]


portfolio before change:  [21.3301805]
curr_Stock_Price:  113.37166736920524
curr_Factors:  [1.13371667e+02 3.70551864e-02]
mat_Sqrt:  [[ 2.18237314e+01 -7.69366933e-03]
 [-7.69366933e-03  1.76453766e-02]]
grads:  [4.11248139e-03 4.59153121e+00]
Stock Position:  0.004112481388107238
Bond Position:  [20.86394162]


portfolio before change:  [21.30790678]
curr_Stock_Price:  101.60992405342536
curr_Factors:  [1.01609924e+02 4.04035405e-02]
mat_Sqrt:  [[ 2.04242353e+01 -8.03300644e-03]
 [-8.03300644e-03  1.84256944e-02]]
grads:  [-0.00487104  4.5187537 ]
Stock Position:  -0.004871044819328663
Bond Position:  [21.80285327]


portfolio before change:  [21.32592645]
curr_Stock_Price:  103.50909241534669
curr_Factors:  [1.03509092e+02 4.12101760e-02]
mat_Sqrt:  [[ 2.10126440e+01 -8.11293171e-03]
 [-8.11293171e-03  1.86086566e-02]]
grads:  [0.00555742 4.10081718]
Stock Position:  0.005557423734678375
Bond Position:  [20.75068257]


portfolio before change:  [21.35544651]
curr_Stock_Price:  104.15066406586062
curr_Factors:  [1.04150664e+02 4.03201837e-02]
mat_Sqrt:  [[ 2.09133335e+01 -8.02489214e-03]
 [-8.02489214e-03  1.84066005e-02]]
grads:  [ 2.04722445e-03 -2.58313561e+00]
Stock Position:  0.0020472244503933106
Bond Position:  [21.14222672]


portfolio before change:  [21.39111771]
curr_Stock_Price:  108.65768804066346
curr_Factors:  [1.08657688e+02 3.61229443e-02]
mat_Sqrt:  [[ 2.06515190e+01 -7.59600715e-03]
 [-7.59600715e-03  1.74221158e-02]]
grads:  [ 4.64887565e-04 -7.02258985e+00]
Stock Position:  0.0004648875648342591
Bond Position:  [21.3406041]


portfolio before change:  [21.41689118]
curr_Stock_Price:  106.68094291919502
curr_Factors:  [1.06680943e+02 3.12798147e-02]
mat_Sqrt:  [[ 1.88676973e+01 -7.06836710e-03]
 [-7.06836710e-03  1.62122279e-02]]
grads:  [8.88201942e-04 2.18313588e+00]
Stock Position:  0.0008882019416531235
Bond Position:  [21.32213696]


portfolio before change:  [21.44069601]
curr_Stock_Price:  103.45588020569339
curr_Factors:  [1.03455880e+02 3.74115677e-02]
mat_Sqrt:  [[ 2.00105074e+01 -7.72997949e-03]
 [-7.72997949e-03  1.77302875e-02]]
grads:  [-4.40856402e-04 -2.09862762e+00]
Stock Position:  -0.00044085640216918884
Bond Position:  [21.48630519]


portfolio before change:  [21.46826379]
curr_Stock_Price:  101.8836875059516
curr_Factors:  [1.01883688e+02 3.87245021e-02]
mat_Sqrt:  [[ 2.00492228e+01 -7.86434172e-03]
 [-7.86434172e-03  1.80387680e-02]]
grads:  [1.09800693e-03 1.30993891e+00]
Stock Position:  0.001098006927522669
Bond Position:  [21.3563948]


portfolio before change:  [21.49292207]
curr_Stock_Price:  100.01310989009811
curr_Factors:  [1.00013110e+02 3.78181525e-02]
mat_Sqrt:  [[ 1.94494378e+01 -7.77163344e-03]
 [-7.77163344e-03  1.78264758e-02]]
grads:  [-4.98847209e-03 -5.03750136e+00]
Stock Position:  -0.004988472091653284
Bond Position:  [21.99183468]


portfolio before change:  [21.51509155]
curr_Stock_Price:  101.08307767951334
curr_Factors:  [1.01083078e+02 4.15941127e-02]
mat_Sqrt:  [[ 2.06155229e+01 -8.15046329e-03]
 [-8.15046329e-03  1.86952153e-02]]
grads:  [ 0.00527048 -3.26289836]
Stock Position:  0.005270481435281845
Bond Position:  [20.98233506]


portfolio before change:  [21.52781117]
curr_Stock_Price:  98.51695596693152
curr_Factors:  [9.85169560e+01 4.11610297e-02]
mat_Sqrt:  [[ 1.99872969e+01 -8.10772910e-03]
 [-8.10772910e-03  1.85977156e-02]]
grads:  [-1.51202920e-03 -3.10441012e+00]
Stock Position:  -0.001512029201461651
Bond Position:  [21.67677168]


portfolio before change:  [21.54685672]
curr_Stock_Price:  103.85240721827985
curr_Factors:  [1.03852407e+02 3.82159540e-02]
mat_Sqrt:  [[ 2.03020030e+01 -7.81266511e-03]
 [-7.81266511e-03  1.79198718e-02]]
grads:  [1.15634479e-03 2.17568759e+00]
Stock Position:  0.0011563447901595783
Bond Position:  [21.42676753]


portfolio before change:  [21.57403765]
curr_Stock_Price:  104.18165343444467
curr_Factors:  [1.04181653e+02 3.80015261e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.57403765]
Stock Price:  103.80541392770424
PL:  [17.76862372]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-5.89492594e-02 -8.10691877e-02]
 [ 4.38337332e-02 -8.53414714e-03]
 [ 6.15690112e-02  5.93139862e-02]
 [-1.32695611e-02 -3.17763470e-03]
 [-1.80539986e-01 -4.73328449e-02]
 [ 1.27745096e-01  1.08171047e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-1.64900336e-01  4.25527174e-02]
 [ 5.25030162e-02  4.11926787e-02]
 [ 6.48177500e-02 -5.04590628e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [-6.06421549e-03  4.01436426e-02]
 [ 3.43040397e-02  3.45829848e-03]
 [ 1.22437852e-02  4.58577873e-03]
 [-6.31488752e-02 -7.98334227e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [-3.04293001e-03 -6.24768237e-02]
 [ 1.00708988e-01 -1.82745786e-02]
 [ 9.29018316e-02  4.86224052e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.35620116]
curr_Stock_Price:  100.52017319845905
curr_Factors:  [1.00520173e+02 4.56011257e-02]
mat_Sqrt:  [[ 2.14654984e+01 -8.53398631e-03]
 [-8.53398631e-03  1.95750437e-02]]
grads:  [-0.0043935  -4.14337169]
Stock Position:  -0.0043935032412469235
Bond Position:  [8.79783686]


portfolio before change:  [8.37570347]
curr_Stock_Price:  98.58592193384936
curr_Factors:  [9.85859219e+01 4.59302684e-02]
mat_Sqrt:  [[ 2.11282904e+01 -8.56457640e-03]
 [-8.56457640e-03  1.96456284e-02]]
grads:  [ 0.00189889 -0.43357656]
Stock Position:  0.0018988916214132217
Bond Position:  [8.18849949]


portfolio before change:  [8.38396386]
curr_Stock_Price:  97.54234735237651
curr_Factors:  [9.75423474e+01 4.84405610e-02]
mat_Sqrt:  [[ 2.14683046e+01 -8.79542161e-03]
 [-8.79542161e-03  2.01753852e-02]]
grads:  [0.0040731  2.94169406]
Stock Position:  0.004073095311294312
Bond Position:  [7.98666458]


portfolio before change:  [8.40502655]
curr_Stock_Price:  100.26094904040653
curr_Factors:  [1.00260949e+02 5.14814304e-02]
mat_Sqrt:  [[ 2.27487260e+01 -9.06751827e-03]
 [-9.06751827e-03  2.07989042e-02]]
grads:  [-0.00064432 -0.15305985]
Stock Position:  -0.0006443188974997985
Bond Position:  [8.46962658]


portfolio before change:  [8.41606242]
curr_Stock_Price:  99.57462247211394
curr_Factors:  [9.95746225e+01 4.89316880e-02]
mat_Sqrt:  [[ 2.20264107e+01 -8.84006587e-03]
 [-8.84006587e-03  2.02773301e-02]]
grads:  [-0.00913496 -2.33825648]
Stock Position:  -0.009134957596876162
Bond Position:  [9.32567237]


portfolio before change:  [8.38845016]
curr_Stock_Price:  103.87422022669543
curr_Factors:  [1.0387422e+02 4.3376875e-02]
mat_Sqrt:  [[ 2.16340025e+01 -8.32350159e-03]
 [-8.32350159e-03  1.90915707e-02]]
grads:  [0.0080861 5.6694315]
Stock Position:  0.008086095881702594
Bond Position:  [7.54851325]


portfolio before change:  [8.42722554]
curr_Stock_Price:  107.50191000445092
curr_Factors:  [1.0750191e+02 4.4083158e-02]
mat_Sqrt:  [[ 2.25710883e+01 -8.39124125e-03]
 [-8.39124125e-03  1.92462633e-02]]
grads:  [3.97626317e-03 4.20970149e+00]
Stock Position:  0.003976263172546223
Bond Position:  [7.99976966]


portfolio before change:  [8.45256329]
curr_Stock_Price:  111.35773584349253
curr_Factors:  [1.11357736e+02 4.67048162e-02]
mat_Sqrt:  [[ 2.40658496e+01 -8.63740938e-03]
 [-8.63740938e-03  1.98101823e-02]]
grads:  [-0.00608206  2.14537068]
Stock Position:  -0.0060820579402130715
Bond Position:  [9.12984749]


portfolio before change:  [8.46963926]
curr_Stock_Price:  110.42770061656294
curr_Factors:  [1.10427701e+02 4.61627178e-02]
mat_Sqrt:  [[ 2.37259541e+01 -8.58707679e-03]
 [-8.58707679e-03  1.96949052e-02]]
grads:  [0.00297035 2.09283492]
Stock Position:  0.0029703484246916697
Bond Position:  [8.14163051]


portfolio before change:  [8.45875166]
curr_Stock_Price:  103.33391856628238
curr_Factors:  [1.03333919e+02 4.58173066e-02]
mat_Sqrt:  [[ 2.21186005e+01 -8.55440312e-03]
 [-8.55440312e-03  1.96212959e-02]]
grads:  [ 1.93620112e-03 -2.57080368e+00]
Stock Position:  0.0019362011213369184
Bond Position:  [8.25867641]


portfolio before change:  [8.48044785]
curr_Stock_Price:  109.20437801859883
curr_Factors:  [1.09204378e+02 4.25219005e-02]
mat_Sqrt:  [[ 2.25188576e+01 -8.24141834e-03]
 [-8.24141834e-03  1.89023287e-02]]
grads:  [ 4.26325302e-04 -6.47266237e+00]
Stock Position:  0.0004263253020998896
Bond Position:  [8.43389126]


portfolio before change:  [8.48968817]
curr_Stock_Price:  106.13480893836025
curr_Factors:  [1.06134809e+02 4.35884574e-02]
mat_Sqrt:  [[ 2.21586634e+01 -8.34393365e-03]
 [-8.34393365e-03  1.91380079e-02]]
grads:  [5.16267241e-04 2.09781241e+00]
Stock Position:  0.0005162672412387176
Bond Position:  [8.43489424]


portfolio before change:  [8.49946229]
curr_Stock_Price:  104.63153293921376
curr_Factors:  [1.04631533e+02 4.38564960e-02]
mat_Sqrt:  [[ 2.19118740e+01 -8.36944525e-03]
 [-8.36944525e-03  1.91968056e-02]]
grads:  [0.00163463 0.18086235]
Stock Position:  0.0016346277508974244
Bond Position:  [8.32842868]


portfolio before change:  [8.50638861]
curr_Stock_Price:  102.49605066377339
curr_Factors:  [1.02496051e+02 4.57476202e-02]
mat_Sqrt:  [[ 2.19225643e+01 -8.54783325e-03]
 [-8.54783325e-03  1.96063956e-02]]
grads:  [0.00064981 0.23417528]
Stock Position:  0.0006498088573950258
Bond Position:  [8.43978577]


portfolio before change:  [8.51457755]
curr_Stock_Price:  98.85284042576968
curr_Factors:  [9.88528404e+01 4.48510796e-02]
mat_Sqrt:  [[ 2.09351255e+01 -8.46338187e-03]
 [-8.46338187e-03  1.94134480e-02]]
grads:  [-0.00467969 -4.1143144 ]
Stock Position:  -0.00467968960420002
Bond Position:  [8.97717816]


portfolio before change:  [8.51548036]
curr_Stock_Price:  101.05932798994431
curr_Factors:  [1.01059328e+02 4.69136140e-02]
mat_Sqrt:  [[ 2.18889948e+01 -8.65596947e-03]
 [-8.65596947e-03  1.98547307e-02]]
grads:  [ 0.00496385 -3.07234473]
Stock Position:  0.004963852522141205
Bond Position:  [8.01383676]


portfolio before change:  [8.51556456]
curr_Stock_Price:  99.05697936430768
curr_Factors:  [9.90569794e+01 5.36437427e-02]
mat_Sqrt:  [[ 2.29427029e+01 -9.25588288e-03]
 [-9.25588288e-03  2.12312520e-02]]
grads:  [-1.32004398e-03 -2.94325752e+00]
Stock Position:  -0.001320043982868228
Bond Position:  [8.64632413]


portfolio before change:  [8.53016494]
curr_Stock_Price:  96.18910779564588
curr_Factors:  [9.61891078e+01 5.36466421e-02]
mat_Sqrt:  [[ 2.22790737e+01 -9.25587787e-03]
 [-9.25587787e-03  2.12319369e-02]]
grads:  [ 0.00416351 -0.85889675]
Stock Position:  0.004163509944328142
Bond Position:  [8.12968063]


portfolio before change:  [8.53732948]
curr_Stock_Price:  95.46762261308533
curr_Factors:  [9.54676226e+01 5.19812139e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.53732948]
Stock Price:  95.17748825649413
PL:  [8.53732948]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 7.48091477e-03 -4.98167163e-02]
 [-6.33381715e-03 -9.94300796e-02]
 [ 6.60206251e-02 -1.45013679e-01]
 [-2.20755986e-02 -2.35864411e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-1.53269794e-01  4.20010778e-02]
 [ 5.29445384e-02  4.13947742e-02]
 [ 6.03448040e-02 -2.97717525e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 1.21914834e-01  1.87577284e-02]
 [ 2.85735423e-02  7.28550124e-02]
 [-6.91476030e-04 -1.87845799e-01]
 [-3.77759076e-02 -9.24479086e-02]
 [ 1.50929229e-01 -8.03052818e-02]
 [ 6.52279495e-02 -1.50405440e-01]
 [-1.57793939e-02  3.62277964e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.75824673]
curr_Stock_Price:  103.03320715658913
curr_Factors:  [1.03033207e+02 3.22197377e-02]
mat_Sqrt:  [[ 1.84943123e+01 -7.17356126e-03]
 [-7.17356126e-03  1.64540997e-02]]
grads:  [-7.69982200e-04 -3.02795296e+00]
Stock Position:  -0.0007699822004657463
Bond Position:  [17.83758046]


portfolio before change:  [17.78037385]
curr_Stock_Price:  103.27191289166142
curr_Factors:  [1.03271913e+02 3.29053710e-02]
mat_Sqrt:  [[ 1.87333559e+01 -7.24950075e-03]
 [-7.24950075e-03  1.66282425e-02]]
grads:  [-2.65255442e-03 -5.98074687e+00]
Stock Position:  -0.0026525544172872374
Bond Position:  [18.05430822]


portfolio before change:  [17.80452382]
curr_Stock_Price:  102.68079446836259
curr_Factors:  [1.02680794e+02 3.35256473e-02]
mat_Sqrt:  [[ 1.88008625e+01 -7.31747205e-03]
 [-7.31747205e-03  1.67842508e-02]]
grads:  [ 1.48882626e-04 -8.63980114e+00]
Stock Position:  0.00014888262643580604
Bond Position:  [17.78923643]


portfolio before change:  [17.82693432]
curr_Stock_Price:  103.75585780500516
curr_Factors:  [1.03755858e+02 3.38033838e-02]
mat_Sqrt:  [[ 1.90762358e+01 -7.34778750e-03]
 [-7.34778750e-03  1.68536007e-02]]
grads:  [-0.00169657 -1.40022939]
Stock Position:  -0.001696570909834874
Bond Position:  [18.00296349]


portfolio before change:  [17.83772001]
curr_Stock_Price:  110.67103494066944
curr_Factors:  [1.10671035e+02 2.63786155e-02]
mat_Sqrt:  [[ 1.79746293e+01 -6.49122186e-03]
 [-6.49122186e-03  1.48879211e-02]]
grads:  [ 0.00912253 -7.929294  ]
Stock Position:  0.009122534459501497
Bond Position:  [16.82811968]


portfolio before change:  [17.85205056]
curr_Stock_Price:  109.93464393158865
curr_Factors:  [1.09934644e+02 2.44283442e-02]
mat_Sqrt:  [[ 1.71823104e+01 -6.24661963e-03]
 [-6.24661963e-03  1.43270090e-02]]
grads:  [0.01006686 7.41769935]
Stock Position:  0.010066860051176182
Bond Position:  [16.74535388]


portfolio before change:  [17.86035183]
curr_Stock_Price:  108.67869068756515
curr_Factors:  [1.08678691e+02 2.95348262e-02]
mat_Sqrt:  [[ 1.86771918e+01 -6.86848690e-03]
 [-6.86848690e-03  1.57534806e-02]]
grads:  [4.80526295e-03 5.14303249e+00]
Stock Position:  0.004805262950290594
Bond Position:  [17.33812215]


portfolio before change:  [17.89651371]
curr_Stock_Price:  111.69115217248846
curr_Factors:  [1.11691152e+02 2.94012530e-02]
mat_Sqrt:  [[ 1.91514501e+01 -6.85309348e-03]
 [-6.85309348e-03  1.57177492e-02]]
grads:  [-0.00704792  2.66913393]
Stock Position:  -0.007047924276417553
Bond Position:  [18.68370449]


portfolio before change:  [17.93381893]
curr_Stock_Price:  109.71383351790507
curr_Factors:  [1.09713834e+02 2.80268569e-02]
mat_Sqrt:  [[ 1.83674370e+01 -6.69089965e-03]
 [-6.69089965e-03  1.53460233e-02]]
grads:  [0.00386576 2.69911226]
Stock Position:  0.0038657558783485937
Bond Position:  [17.50969204]


portfolio before change:  [17.95186848]
curr_Stock_Price:  108.71758591888305
curr_Factors:  [1.08717586e+02 2.34567658e-02]
mat_Sqrt:  [[ 1.66507514e+01 -6.12108009e-03]
 [-6.12108009e-03  1.40392321e-02]]
grads:  [ 0.00284503 -2.11937075]
Stock Position:  0.0028450347226291945
Bond Position:  [17.64256318]


portfolio before change:  [17.97602144]
curr_Stock_Price:  109.45078185941874
curr_Factors:  [1.09450782e+02 2.16740204e-02]
mat_Sqrt:  [[ 1.61134516e+01 -5.88391222e-03]
 [-5.88391222e-03  1.34951762e-02]]
grads:  [ 5.95790131e-04 -9.06608387e+00]
Stock Position:  0.0005957901309869599
Bond Position:  [17.91081175]


portfolio before change:  [17.99943536]
curr_Stock_Price:  111.14836985126188
curr_Factors:  [1.11148370e+02 2.04790376e-02]
mat_Sqrt:  [[ 1.59058851e+01 -5.71948294e-03]
 [-5.71948294e-03  1.31178463e-02]]
grads:  [0.00818023 1.43350628]
Stock Position:  0.008180226880023985
Bond Position:  [17.09021648]


portfolio before change:  [18.01380956]
curr_Stock_Price:  110.29241140769477
curr_Factors:  [1.10292411e+02 2.48619220e-02]
mat_Sqrt:  [[ 1.73905354e+01 -6.30182835e-03]
 [-6.30182835e-03  1.44535871e-02]]
grads:  [3.47017418e-03 5.04213110e+00]
Stock Position:  0.0034701741767079078
Bond Position:  [17.63107568]


portfolio before change:  [18.0350755]
curr_Stock_Price:  110.06571248559861
curr_Factors:  [1.10065712e+02 2.50436600e-02]
mat_Sqrt:  [[ 1.74181056e+01 -6.32480844e-03]
 [-6.32480844e-03  1.45063227e-02]]
grads:  [-4.74253597e-03 -1.29513040e+01]
Stock Position:  -0.004742535974708092
Bond Position:  [18.5570661]


portfolio before change:  [18.0547797]
curr_Stock_Price:  110.80511369680512
curr_Factors:  [1.10805114e+02 2.31802569e-02]
mat_Sqrt:  [[ 1.68701482e+01 -6.08499200e-03]
 [-6.08499200e-03  1.39561973e-02]]
grads:  [-4.62924645e-03 -6.62616584e+00]
Stock Position:  -0.004629246446069577
Bond Position:  [18.56772388]


portfolio before change:  [18.08358423]
curr_Stock_Price:  109.59965495676522
curr_Factors:  [1.09599655e+02 2.10308054e-02]
mat_Sqrt:  [[ 1.58941428e+01 -5.79595349e-03]
 [-5.79595349e-03  1.32934185e-02]]
grads:  [ 0.00729416 -6.0378002 ]
Stock Position:  0.007294159928285572
Bond Position:  [17.28414682]


portfolio before change:  [18.0991829]
curr_Stock_Price:  108.77433446105773
curr_Factors:  [1.08774334e+02 2.18951131e-02]
mat_Sqrt:  [[ 1.60953343e+01 -5.91381565e-03]
 [-5.91381565e-03  1.35638459e-02]]
grads:  [-2.16611715e-05 -1.10887111e+01]
Stock Position:  -2.166117153524142e-05
Bond Position:  [18.10153908]


portfolio before change:  [18.12187785]
curr_Stock_Price:  106.28729796306828
curr_Factors:  [1.06287298e+02 2.00235076e-02]
mat_Sqrt:  [[ 1.50401239e+01 -5.65530079e-03]
 [-5.65530079e-03  1.29712239e-02]]
grads:  [1.03064589e-06 2.79293631e+00]
Stock Position:  1.0306458949807949e-06
Bond Position:  [18.1217683]


portfolio before change:  [18.14454341]
curr_Stock_Price:  105.49863312212699
curr_Factors:  [1.05498633e+02 2.08596016e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.14454341]
Stock Price:  107.7022353632335
PL:  [10.44230804]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-3.30915614e-02 -7.18247933e-02]
 [-3.60510492e-02 -1.35160021e-01]
 [ 4.67676913e-03 -2.18193188e-01]
 [-2.42915297e-02 -2.96094628e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26762030e-01  1.06432761e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-2.68956718e-01  4.74463100e-02]
 [ 5.23939950e-02  4.11427581e-02]
 [ 7.99369905e-02 -6.29415093e-02]
 [ 1.14078666e-01 -1.14201746e-01]
 [ 5.98013354e-01 -4.86976927e-02]
 [ 4.73253476e-02  2.40632397e-01]
 [-7.30897953e-02 -9.94411870e-02]
 [ 3.31863414e-02 -1.30361693e-01]
 [ 2.04992579e-01 -1.46712389e-01]
 [ 1.38793708e-01 -1.48905325e-01]
 [-1.72313633e-01  5.13777160e-02]
 [-1.25763630e-01 -1.54984640e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.08867923]
curr_Stock_Price:  100.18138249443751
curr_Factors:  [1.00181382e+02 4.26512438e-02]
mat_Sqrt:  [[ 2.06896354e+01 -8.25331977e-03]
 [-8.25331977e-03  1.89313272e-02]]
grads:  [-3.11342222e-03 -3.79532235e+00]
Stock Position:  -0.003113422217020218
Bond Position:  [7.40058617]


portfolio before change:  [7.08198365]
curr_Stock_Price:  105.30503522530374
curr_Factors:  [1.05305035e+02 4.07898216e-02]
mat_Sqrt:  [[ 2.12679196e+01 -8.07157046e-03]
 [-8.07157046e-03  1.85134537e-02]]
grads:  [-4.46655726e-03 -7.30258524e+00]
Stock Position:  -0.0044665572562026055
Bond Position:  [7.55233462]


portfolio before change:  [7.09547212]
curr_Stock_Price:  104.40005610314071
curr_Factors:  [1.04400056e+02 4.25160304e-02]
mat_Sqrt:  [[ 2.15266800e+01 -8.24053142e-03]
 [-8.24053142e-03  1.89011626e-02]]
grads:  [-4.20251637e-03 -1.15457353e+01]
Stock Position:  -0.004202516366448865
Bond Position:  [7.53421506]


portfolio before change:  [7.0931807]
curr_Stock_Price:  107.18768878364595
curr_Factors:  [1.07187689e+02 4.64405244e-02]
mat_Sqrt:  [[ 2.30990136e+01 -8.61266056e-03]
 [-8.61266056e-03  1.97541723e-02]]
grads:  [-0.00161076 -1.49959894]
Stock Position:  -0.001610764296865557
Bond Position:  [7.2658348]


portfolio before change:  [7.10353371]
curr_Stock_Price:  106.40232225933507
curr_Factors:  [1.06402322e+02 4.61727939e-02]
mat_Sqrt:  [[ 2.28635758e+01 -8.58774444e-03]
 [-8.58774444e-03  1.96971720e-02]]
grads:  [ 0.00717199 -5.99316128]
Stock Position:  0.007171985947328018
Bond Position:  [6.34041775]


portfolio before change:  [7.1000255]
curr_Stock_Price:  104.80740944614553
curr_Factors:  [1.04807409e+02 4.64673223e-02]
mat_Sqrt:  [[ 2.25925774e+01 -8.61497793e-03]
 [-8.61497793e-03  1.97599438e-02]]
grads:  [0.00766595 5.38963086]
Stock Position:  0.007665950556536217
Bond Position:  [6.29657708]


portfolio before change:  [7.12005115]
curr_Stock_Price:  106.39234094413922
curr_Factors:  [1.06392341e+02 4.88966437e-02]
mat_Sqrt:  [[ 2.35260957e+01 -8.83742059e-03]
 [-8.83742059e-03  2.02698405e-02]]
grads:  [3.81484316e-03 3.99713904e+00]
Stock Position:  0.0038148431600222993
Bond Position:  [6.71418106]


portfolio before change:  [7.13600712]
curr_Stock_Price:  108.37354913137663
curr_Factors:  [1.08373549e+02 5.58097569e-02]
mat_Sqrt:  [[ 2.56022617e+01 -9.44165005e-03]
 [-9.44165005e-03  2.16553184e-02]]
grads:  [-0.00969876  2.18674863]
Stock Position:  -0.009698760451966585
Bond Position:  [8.18709621]


portfolio before change:  [7.12462085]
curr_Stock_Price:  110.60337415607718
curr_Factors:  [1.10603374e+02 4.94565604e-02]
mat_Sqrt:  [[ 2.45968958e+01 -8.88816663e-03]
 [-8.88816663e-03  2.03854384e-02]]
grads:  [0.00285985 2.01948941]
Stock Position:  0.002859854914832162
Bond Position:  [6.80831125]


portfolio before change:  [7.16451699]
curr_Stock_Price:  121.57610786310809
curr_Factors:  [1.21576108e+02 4.54973055e-02]
mat_Sqrt:  [[ 2.59323008e+01 -8.52561137e-03]
 [-8.52561137e-03  1.95521612e-02]]
grads:  [ 2.02447215e-03 -3.21827592e+00]
Stock Position:  0.002024472146206593
Bond Position:  [6.91838954]


portfolio before change:  [7.17620223]
curr_Stock_Price:  123.07370804078961
curr_Factors:  [1.23073708e+02 4.81525035e-02]
mat_Sqrt:  [[ 2.70068976e+01 -8.77093941e-03]
 [-8.77093941e-03  2.01145633e-02]]
grads:  [ 2.38050999e-03 -5.67652725e+00]
Stock Position:  0.0023805099902861043
Bond Position:  [6.88322404]


portfolio before change:  [7.19714806]
curr_Stock_Price:  128.25596415272412
curr_Factors:  [1.28255964e+02 4.95580125e-02]
mat_Sqrt:  [[ 2.85518655e+01 -8.89829246e-03]
 [-8.89829246e-03  2.04058942e-02]]
grads:  [ 0.02020381 -2.37764211]
Stock Position:  0.02020380766934242
Bond Position:  [4.60588922]


portfolio before change:  [7.17732273]
curr_Stock_Price:  126.98955510649432
curr_Factors:  [1.26989555e+02 4.45047889e-02]
mat_Sqrt:  [[ 2.67899161e+01 -8.43237699e-03]
 [-8.43237699e-03  1.93376035e-02]]
grads:  [5.68410443e-03 1.24462335e+01]
Stock Position:  0.00568410442932182
Bond Position:  [6.45550084]


portfolio before change:  [7.1770972]
curr_Stock_Price:  125.52935074213536
curr_Factors:  [1.25529351e+02 4.44776317e-02]
mat_Sqrt:  [[ 2.64737881e+01 -8.42973312e-03]
 [-8.42973312e-03  1.93317334e-02]]
grads:  [-4.39936924e-03 -5.14585373e+00]
Stock Position:  -0.0043993692407748725
Bond Position:  [7.72934716]


portfolio before change:  [7.20549383]
curr_Stock_Price:  121.2721701179082
curr_Factors:  [1.21272170e+02 4.50500305e-02]
mat_Sqrt:  [[ 2.57400076e+01 -8.48358505e-03]
 [-8.48358505e-03  1.94558241e-02]]
grads:  [-9.19208129e-04 -6.70079515e+00]
Stock Position:  -0.0009192081293664018
Bond Position:  [7.3169682]


portfolio before change:  [7.2177865]
curr_Stock_Price:  117.85538080646542
curr_Factors:  [1.17855381e+02 4.52598380e-02]
mat_Sqrt:  [[ 2.50729762e+01 -8.50313083e-03]
 [-8.50313083e-03  1.95011576e-02]]
grads:  [ 5.62526449e-03 -7.52081288e+00]
Stock Position:  0.005625264494458118
Bond Position:  [6.55481881]


portfolio before change:  [7.24771559]
curr_Stock_Price:  121.71838807122681
curr_Factors:  [1.21718388e+02 4.47709348e-02]
mat_Sqrt:  [[ 2.57545669e+01 -8.45728872e-03]
 [-8.45728872e-03  1.93954535e-02]]
grads:  [ 2.86841853e-03 -7.67608070e+00]
Stock Position:  0.00286841852769006
Bond Position:  [6.89857631]


portfolio before change:  [7.27932099]
curr_Stock_Price:  129.7286507330036
curr_Factors:  [1.29728651e+02 4.00808297e-02]
mat_Sqrt:  [[ 2.59719305e+01 -8.00242490e-03]
 [-8.00242490e-03  1.83512804e-02]]
grads:  [-0.00577275  2.79716286]
Stock Position:  -0.005772753302612459
Bond Position:  [8.02821248]


portfolio before change:  [7.30529005]
curr_Stock_Price:  126.96956519468363
curr_Factors:  [1.26969565e+02 4.03022600e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.30529005]
Stock Price:  131.10768981335258
PL:  [-23.80239977]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.23732898e-01  8.06225780e-03]
 [-2.56802473e-01 -2.28098898e-01]
 [-5.61077860e-01 -5.87923424e-02]
 [-2.35071685e-02 -2.74775261e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-1.54034054e-01  4.20396808e-02]
 [ 5.23910450e-02  4.11412751e-02]
 [ 6.11998667e-02 -3.54197441e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 4.14299323e-01 -2.26410266e-02]
 [ 7.81042851e-02  3.07631332e-01]
 [-8.70134829e-02 -7.54226930e-02]
 [ 6.14271094e-02 -1.40637852e-01]
 [ 2.30140852e-01 -1.77602523e-01]
 [ 1.63581822e-01 -1.49403665e-01]
 [-1.56286795e-01  4.97358502e-02]
 [-1.14811832e-01 -1.32915070e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [33.58870775]
curr_Stock_Price:  107.26446574873228
curr_Factors:  [1.07264466e+02 3.32546328e-02]
mat_Sqrt:  [[ 1.95605887e+01 -7.28811334e-03]
 [-7.28811334e-03  1.67161518e-02]]
grads:  [0.00650638 0.48514019]
Stock Position:  0.006506381584244199
Bond Position:  [32.8908042]


portfolio before change:  [33.64791583]
curr_Stock_Price:  110.04156576329065
curr_Factors:  [1.10041566e+02 3.34945605e-02]
mat_Sqrt:  [[ 2.01392770e+01 -7.31451508e-03]
 [-7.31451508e-03  1.67762771e-02]]
grads:  [ -0.01769233 -13.60422859]
Stock Position:  -0.01769233368575845
Bond Position:  [35.59480793]


portfolio before change:  [33.66994928]
curr_Stock_Price:  111.3126179022267
curr_Factors:  [1.11312618e+02 3.14567855e-02]
mat_Sqrt:  [[ 1.97424724e+01 -7.08858735e-03]
 [-7.08858735e-03  1.62579145e-02]]
grads:  [-0.02972291 -3.62918846]
Stock Position:  -0.029722907457179315
Bond Position:  [36.97848392]


portfolio before change:  [33.74153741]
curr_Stock_Price:  110.46020715908965
curr_Factors:  [1.10460207e+02 3.61747382e-02]
mat_Sqrt:  [[ 2.10091520e+01 -7.60155542e-03]
 [-7.60155542e-03  1.74345558e-02]]
grads:  [-0.00168941 -1.5767748 ]
Stock Position:  -0.001689411807721246
Bond Position:  [33.92815019]


portfolio before change:  [33.78167485]
curr_Stock_Price:  111.8211937213688
curr_Factors:  [1.11821194e+02 3.59123651e-02]
mat_Sqrt:  [[ 2.11907389e+01 -7.57401488e-03]
 [-7.57401488e-03  1.73711816e-02]]
grads:  [ 0.00773797 -6.79581361]
Stock Position:  0.0077379740756640765
Bond Position:  [32.91640535]


portfolio before change:  [33.79687709]
curr_Stock_Price:  108.46514839320304
curr_Factors:  [1.08465148e+02 3.62234936e-02]
mat_Sqrt:  [[ 2.06435960e+01 -7.60656027e-03]
 [-7.60656027e-03  1.74463514e-02]]
grads:  [0.00837895 6.09149121]
Stock Position:  0.00837895019634833
Bond Position:  [32.88805302]


portfolio before change:  [33.86162019]
curr_Stock_Price:  111.28260405236473
curr_Factors:  [1.11282604e+02 4.02058281e-02]
mat_Sqrt:  [[ 2.23137086e+01 -8.01395565e-03]
 [-8.01395565e-03  1.83802828e-02]]
grads:  [4.02216018e-03 4.40797847e+00]
Stock Position:  0.004022160183773269
Bond Position:  [33.41402373]


portfolio before change:  [33.90496922]
curr_Stock_Price:  111.66930877977282
curr_Factors:  [1.11669309e+02 3.87382910e-02]
mat_Sqrt:  [[ 2.19788026e+01 -7.86636140e-03]
 [-7.86636140e-03  1.80417091e-02]]
grads:  [-0.00617529  2.327446  ]
Stock Position:  -0.00617529192579808
Bond Position:  [34.5945598]


portfolio before change:  [33.95481817]
curr_Stock_Price:  110.60397994006254
curr_Factors:  [1.10603980e+02 4.12934592e-02]
mat_Sqrt:  [[ 2.24756034e+01 -8.12158640e-03]
 [-8.12158640e-03  1.86272496e-02]]
grads:  [0.00312961 2.21002529]
Stock Position:  0.0031296137049982515
Bond Position:  [33.60867044]


portfolio before change:  [34.00268063]
curr_Stock_Price:  112.46534501002853
curr_Factors:  [1.12465345e+02 4.07645673e-02]
mat_Sqrt:  [[ 2.27070183e+01 -8.06951822e-03]
 [-8.06951822e-03  1.85075268e-02]]
grads:  [ 0.00201539 -1.91292339]
Stock Position:  0.002015389950309918
Bond Position:  [33.77601911]


portfolio before change:  [34.04895639]
curr_Stock_Price:  114.46462907827028
curr_Factors:  [1.14464629e+02 3.94452797e-02]
mat_Sqrt:  [[ 2.27336306e+01 -7.93797790e-03]
 [-7.93797790e-03  1.82055295e-02]]
grads:  [ 4.22186902e-04 -6.72040621e+00]
Stock Position:  0.0004221869015907535
Bond Position:  [34.00063093]


portfolio before change:  [34.09452194]
curr_Stock_Price:  121.66092069523648
curr_Factors:  [1.21660921e+02 3.95223391e-02]
mat_Sqrt:  [[ 2.41864648e+01 -7.94610394e-03]
 [-7.94610394e-03  1.82231398e-02]]
grads:  [ 0.0167236  -1.23514057]
Stock Position:  0.016723600185523508
Bond Position:  [32.05991334]


portfolio before change:  [34.3392089]
curr_Stock_Price:  133.89435206558343
curr_Factors:  [1.33894352e+02 3.17148086e-02]
mat_Sqrt:  [[ 2.38447781e+01 -7.11858776e-03]
 [-7.11858776e-03  1.63240251e-02]]
grads:  [8.90274265e-03 1.88491935e+01]
Stock Position:  0.008902742645967724
Bond Position:  [33.14718194]


portfolio before change:  [34.33511083]
curr_Stock_Price:  128.77705780687688
curr_Factors:  [1.28777058e+02 3.93779933e-02]
mat_Sqrt:  [[ 2.55543752e+01 -7.93191004e-03]
 [-7.93191004e-03  1.81896876e-02]]
grads:  [-0.0046927  -4.14849978]
Stock Position:  -0.00469269973548933
Bond Position:  [34.9394229]


portfolio before change:  [34.39653527]
curr_Stock_Price:  125.00037100004955
curr_Factors:  [1.25000371e+02 3.95130178e-02]
mat_Sqrt:  [[ 2.48474245e+01 -7.94532665e-03]
 [-7.94532665e-03  1.82209210e-02]]
grads:  [ 4.07535448e-06 -7.71848031e+00]
Stock Position:  4.0753544769458635e-06
Bond Position:  [34.39602585]


portfolio before change:  [34.43954415]
curr_Stock_Price:  121.8005977639005
curr_Factors:  [1.21800598e+02 4.17848234e-02]
mat_Sqrt:  [[ 2.48976686e+01 -8.17038613e-03]
 [-8.17038613e-03  1.87374765e-02]]
grads:  [ 6.13390696e-03 -9.47579078e+00]
Stock Position:  0.006133906963957685
Bond Position:  [33.69243061]


portfolio before change:  [34.49944948]
curr_Stock_Price:  124.69654390831454
curr_Factors:  [1.24696544e+02 4.03842895e-02]
mat_Sqrt:  [[ 2.50588201e+01 -8.03243287e-03]
 [-8.03243287e-03  1.84207198e-02]]
grads:  [ 3.92865591e-03 -8.10891813e+00]
Stock Position:  0.003928655912231517
Bond Position:  [34.00955967]


portfolio before change:  [34.55198792]
curr_Stock_Price:  127.24192008286596
curr_Factors:  [1.2724192e+02 4.2165195e-02]
mat_Sqrt:  [[ 2.61280651e+01 -8.20775378e-03]
 [-8.20775378e-03  1.88224528e-02]]
grads:  [-0.00515221  2.64012149]
Stock Position:  -0.005152211903326943
Bond Position:  [35.20756526]


portfolio before change:  [34.61920733]
curr_Stock_Price:  122.74240993316907
curr_Factors:  [1.22742410e+02 3.96934042e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [34.61920733]
Stock Price:  124.49586242875223
PL:  [10.1233449]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-4.18706957e-02 -7.32527094e-02]
 [ 2.33027724e-02 -6.37970969e-02]
 [-1.72728163e-01 -2.21907536e-01]
 [-2.38227113e-02 -2.83351886e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-2.78901765e-01  4.79082443e-02]
 [ 5.22850796e-02  4.10925657e-02]
 [ 6.19705702e-02 -3.70155481e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 2.52411443e-02  3.21015989e-02]
 [ 3.43741387e-02  1.12431600e-02]
 [ 3.86009441e-03 -1.57903465e-01]
 [-3.30090334e-02 -9.50763259e-02]
 [ 1.69321538e-01 -1.02896928e-01]
 [ 8.61474314e-02 -1.49388526e-01]
 [-7.98937703e-02  4.19346191e-02]
 [-9.34214158e-02 -8.97888415e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.75249526]
curr_Stock_Price:  101.42795463208097
curr_Factors:  [1.01427955e+02 3.77666968e-02]
mat_Sqrt:  [[ 1.97111578e+01 -7.76644377e-03]
 [-7.76644377e-03  1.78143010e-02]]
grads:  [-3.74504258e-03 -4.11364977e+00]
Stock Position:  -0.003745042581513652
Bond Position:  [12.13234727]


portfolio before change:  [11.77051999]
curr_Stock_Price:  100.666997688947
curr_Factors:  [1.00666998e+02 3.94387256e-02]
mat_Sqrt:  [[ 1.99916444e+01 -7.93644797e-03]
 [-7.93644797e-03  1.82043964e-02]]
grads:  [-2.25654200e-04 -3.50458682e+00]
Stock Position:  -0.00022565419974838492
Bond Position:  [11.79323592]


portfolio before change:  [11.78396502]
curr_Stock_Price:  106.4534162119825
curr_Factors:  [1.06453416e+02 4.19027134e-02]
mat_Sqrt:  [[ 2.17911749e+01 -8.18101685e-03]
 [-8.18101685e-03  1.87642772e-02]]
grads:  [ -0.01236838 -11.83145614]
Stock Position:  -0.01236837879259629
Bond Position:  [13.1006212]


portfolio before change:  [11.76014902]
curr_Stock_Price:  109.7038033771122
curr_Factors:  [1.09703803e+02 3.80325520e-02]
mat_Sqrt:  [[ 2.13943645e+01 -7.79426233e-03]
 [-7.79426233e-03  1.78766606e-02]]
grads:  [-0.00169122 -1.5857755 ]
Stock Position:  -0.0016912239482377784
Bond Position:  [11.94568272]


portfolio before change:  [11.7799543]
curr_Stock_Price:  106.82787164384169
curr_Factors:  [1.06827872e+02 3.72715241e-02]
mat_Sqrt:  [[ 2.06240105e+01 -7.71571362e-03]
 [-7.71571362e-03  1.76969773e-02]]
grads:  [ 0.00795078 -6.67055012]
Stock Position:  0.007950777905856785
Bond Position:  [10.93058962]


portfolio before change:  [11.79909365]
curr_Stock_Price:  107.51554859479148
curr_Factors:  [1.07515549e+02 4.09865856e-02]
mat_Sqrt:  [[ 2.17666762e+01 -8.09115975e-03]
 [-8.09115975e-03  1.85579899e-02]]
grads:  [0.00794662 5.72663628]
Stock Position:  0.007946619676826134
Bond Position:  [10.94470848]


portfolio before change:  [11.82063807]
curr_Stock_Price:  108.50401622072982
curr_Factors:  [1.08504016e+02 3.47462144e-02]
mat_Sqrt:  [[ 2.02255124e+01 -7.44984133e-03]
 [-7.44984133e-03  1.70868958e-02]]
grads:  [4.43740471e-03 4.74168721e+00]
Stock Position:  0.004437404709030183
Bond Position:  [11.33916183]


portfolio before change:  [11.83297564]
curr_Stock_Price:  108.08817828267661
curr_Factors:  [1.08088178e+02 3.66007388e-02]
mat_Sqrt:  [[ 2.06786934e+01 -7.64604397e-03]
 [-7.64604397e-03  1.75369724e-02]]
grads:  [-0.0124793   2.72640146]
Stock Position:  -0.012479298106977416
Bond Position:  [13.18184024]


portfolio before change:  [11.81601059]
curr_Stock_Price:  110.76883012062949
curr_Factors:  [1.1076883e+02 3.2757687e-02]
mat_Sqrt:  [[ 2.00481432e+01 -7.23364823e-03]
 [-7.23364823e-03  1.65906963e-02]]
grads:  [0.00350221 2.47837093]
Stock Position:  0.0035022067869590937
Bond Position:  [11.42807524]


portfolio before change:  [11.83796544]
curr_Stock_Price:  112.95625727461014
curr_Factors:  [1.12956257e+02 3.17731197e-02]
mat_Sqrt:  [[ 2.01344697e+01 -7.12422546e-03]
 [-7.12422546e-03  1.63394189e-02]]
grads:  [ 0.00227661 -2.26442135]
Stock Position:  0.002276609346445
Bond Position:  [11.58080817]


portfolio before change:  [11.85065125]
curr_Stock_Price:  112.16593864131586
curr_Factors:  [1.12165939e+02 3.58118010e-02]
mat_Sqrt:  [[ 2.12262878e+01 -7.56342187e-03]
 [-7.56342187e-03  1.73468343e-02]]
grads:  [ 4.52218133e-04 -7.05307277e+00]
Stock Position:  0.0004522181334286481
Bond Position:  [11.79992778]


portfolio before change:  [11.86332962]
curr_Stock_Price:  107.56469686386407
curr_Factors:  [1.07564697e+02 3.62405885e-02]
mat_Sqrt:  [[ 2.04770480e+01 -7.60830116e-03]
 [-7.60830116e-03  1.74504911e-02]]
grads:  [0.00191647 1.84041697]
Stock Position:  0.0019164672033662466
Bond Position:  [11.65718541]


portfolio before change:  [11.87309654]
curr_Stock_Price:  105.05295697072391
curr_Factors:  [1.05052957e+02 3.63342743e-02]
mat_Sqrt:  [[ 2.00247220e+01 -7.61797386e-03]
 [-7.61797386e-03  1.74730998e-02]]
grads:  [0.0019617  0.64431065]
Stock Position:  0.001961699164906816
Bond Position:  [11.66701425]


portfolio before change:  [11.89486798]
curr_Stock_Price:  108.71231048269931
curr_Factors:  [1.08712310e+02 3.31472676e-02]
mat_Sqrt:  [[ 1.97925870e+01 -7.27642144e-03]
 [-7.27642144e-03  1.66891092e-02]]
grads:  [-3.28385313e-03 -9.46289931e+00]
Stock Position:  -0.003283853134887276
Bond Position:  [12.25186324]


portfolio before change:  [11.90093871]
curr_Stock_Price:  111.53024242381919
curr_Factors:  [1.11530242e+02 3.65764525e-02]
mat_Sqrt:  [[ 2.13301254e+01 -7.64370669e-03]
 [-7.64370669e-03  1.75310660e-02]]
grads:  [-3.49153249e-03 -5.42482781e+00]
Stock Position:  -0.003491532490645159
Bond Position:  [12.29035018]


portfolio before change:  [11.91346681]
curr_Stock_Price:  112.34491124559437
curr_Factors:  [1.12344911e+02 3.81713941e-02]
mat_Sqrt:  [[ 2.19493866e+01 -7.80862954e-03]
 [-7.80862954e-03  1.79091944e-02]]
grads:  [ 5.67107041e-03 -5.74300785e+00]
Stock Position:  0.005671070405197459
Bond Position:  [11.27635091]


portfolio before change:  [11.93820901]
curr_Stock_Price:  114.22073779683572
curr_Factors:  [1.14220738e+02 3.78075755e-02]
mat_Sqrt:  [[ 2.22092733e+01 -7.77143176e-03]
 [-7.77143176e-03  1.78235968e-02]]
grads:  [ 9.46197586e-04 -8.38109020e+00]
Stock Position:  0.0009461975861715618
Bond Position:  [11.83013362]


portfolio before change:  [11.95413171]
curr_Stock_Price:  115.41053452745997
curr_Factors:  [1.15410535e+02 3.38823671e-02]
mat_Sqrt:  [[ 2.12438046e+01 -7.35702253e-03]
 [-7.35702253e-03  1.68729929e-02]]
grads:  [-0.00290054  2.48404535]
Stock Position:  -0.0029005441246723594
Bond Position:  [12.28888505]


portfolio before change:  [11.97209395]
curr_Stock_Price:  114.51706844996835
curr_Factors:  [1.14517068e+02 3.42158542e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.97209395]
Stock Price:  115.20308538186953
PL:  [-3.23099143]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.49728209e-01 -7.16828260e-03]
 [-2.05551430e-01  8.90911797e-02]
 [ 4.29686644e-02  1.14599890e-01]
 [-2.05130220e-01 -1.10932277e-01]
 [-2.73443912e-02  1.34988448e-02]
 [ 4.93171845e-02 -6.10761589e-02]
 [-1.40951639e-01 -1.80519315e-01]
 [ 3.24384522e-02 -1.52166689e-02]
 [-5.69735447e-02 -4.93604467e-02]
 [ 3.82631756e-02  2.13737238e-01]
 [ 5.81972501e-02 -1.09310959e-01]
 [ 2.31575229e-03 -1.28838409e-02]
 [-1.36698121e-01 -1.31121789e-01]
 [ 5.46507874e-03  1.66172085e-01]
 [-6.56369107e-02 -7.32030484e-02]
 [ 7.24851187e-02 -4.58910292e-02]
 [ 2.95076828e-02 -1.46225340e-01]
 [ 3.96072246e-02  4.78002484e-02]
 [-4.47739010e-02 -4.27054607e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.02485273]
curr_Stock_Price:  95.87446303696811
curr_Factors:  [9.5874463e+01 4.1987947e-02]
mat_Sqrt:  [[ 1.96455968e+01 -8.18855569e-03]
 [-8.18855569e-03  1.87836904e-02]]
grads:  [ 0.00746375 -0.37836895]
Stock Position:  0.007463754621579871
Bond Position:  [-9.7404362]


portfolio before change:  [-9.07344731]
curr_Stock_Price:  90.99603168514759
curr_Factors:  [9.09960317e+01 4.33382932e-02]
mat_Sqrt:  [[ 1.89434167e+01 -8.31876103e-03]
 [-8.31876103e-03  1.90835308e-02]]
grads:  [-0.00880239  4.66464805]
Stock Position:  -0.00880238978562189
Bond Position:  [-8.27246477]


portfolio before change:  [-9.09478233]
curr_Stock_Price:  92.24432624026547
curr_Factors:  [9.22443262e+01 4.08391267e-02]
mat_Sqrt:  [[ 1.86413708e+01 -8.07545283e-03]
 [-8.07545283e-03  1.85250730e-02]]
grads:  [4.98582531e-03 6.18837793e+00]
Stock Position:  0.004985825314747711
Bond Position:  [-9.55469642]


portfolio before change:  [-9.10029702]
curr_Stock_Price:  93.53521408124365
curr_Factors:  [9.35352141e+01 4.16987269e-02]
mat_Sqrt:  [[ 1.91001379e+01 -8.16010994e-03]
 [-8.16010994e-03  1.87189710e-02]]
grads:  [-0.01327403 -5.93198177]
Stock Position:  -0.013274032059976107
Bond Position:  [-7.85870759]


portfolio before change:  [-9.11473621]
curr_Stock_Price:  93.88248273984654
curr_Factors:  [9.38824827e+01 4.07953795e-02]
mat_Sqrt:  [[ 1.89622564e+01 -8.07126625e-03]
 [-8.07126625e-03  1.85150873e-02]]
grads:  [-0.00113192  0.72857927]
Stock Position:  -0.00113192403874748
Bond Position:  [-9.00846837]


portfolio before change:  [-9.1256273]
curr_Stock_Price:  93.54983236768605
curr_Factors:  [9.35498324e+01 4.08576960e-02]
mat_Sqrt:  [[ 1.89094941e+01 -8.07740046e-03]
 [-8.07740046e-03  1.85292353e-02]]
grads:  [ 1.20027763e-03 -3.29568181e+00]
Stock Position:  0.001200277625582654
Bond Position:  [-9.23791307]


portfolio before change:  [-9.1386298]
curr_Stock_Price:  92.34353405760993
curr_Factors:  [9.23435341e+01 3.92829551e-02]
mat_Sqrt:  [[ 1.83024204e+01 -7.92010976e-03]
 [-7.92010976e-03  1.81686932e-02]]
grads:  [-0.01200307 -9.94096707]
Stock Position:  -0.012003067604281588
Bond Position:  [-8.03022412]


portfolio before change:  [-9.12838853]
curr_Stock_Price:  90.65352165719084
curr_Factors:  [9.06535217e+01 3.92709594e-02]
mat_Sqrt:  [[ 1.79647176e+01 -7.91875399e-03]
 [-7.91875399e-03  1.81659828e-02]]
grads:  [ 0.00143672 -0.83702005]
Stock Position:  0.0014367215188963163
Bond Position:  [-9.25863239]


portfolio before change:  [-9.13686031]
curr_Stock_Price:  92.81729860252499
curr_Factors:  [9.28172986e+01 3.72381165e-02]
mat_Sqrt:  [[ 1.79111197e+01 -7.71125697e-03]
 [-7.71125697e-03  1.76894794e-02]]
grads:  [-0.00438307 -2.79229505]
Stock Position:  -0.004383067641233766
Bond Position:  [-8.73003581]


portfolio before change:  [-9.14845669]
curr_Stock_Price:  92.9717610442462
curr_Factors:  [9.29717610e+01 3.36925612e-02]
mat_Sqrt:  [[ 1.70654612e+01 -7.33498192e-03]
 [-7.33498192e-03  1.68262786e-02]]
grads:  [7.70333942e-03 1.27059433e+01]
Stock Position:  0.007703339415507173
Bond Position:  [-9.86464973]


portfolio before change:  [-9.16502375]
curr_Stock_Price:  92.42283861871324
curr_Factors:  [9.24228386e+01 3.14775948e-02]
mat_Sqrt:  [[ 1.63975904e+01 -7.08973928e-03]
 [-7.08973928e-03  1.62638109e-02]]
grads:  [ 6.43282214e-04 -6.72083557e+00]
Stock Position:  0.0006432822136966316
Bond Position:  [-9.22447772]


portfolio before change:  [-9.17669154]
curr_Stock_Price:  92.2207837545015
curr_Factors:  [9.22207838e+01 3.18591858e-02]
mat_Sqrt:  [[ 1.64606168e+01 -7.13256745e-03]
 [-7.13256745e-03  1.63621007e-02]]
grads:  [-2.00551149e-04 -7.87507155e-01]
Stock Position:  -0.0002005511487612017
Bond Position:  [-9.15819655]


portfolio before change:  [-9.18775748]
curr_Stock_Price:  90.28130928492222
curr_Factors:  [9.02813093e+01 3.10699513e-02]
mat_Sqrt:  [[ 1.59135874e+01 -7.04351709e-03]
 [-7.04351709e-03  1.61582295e-02]]
grads:  [-0.0121841  -8.12017231]
Stock Position:  -0.012184097104393244
Bond Position:  [-8.08776124]


portfolio before change:  [-9.23365719]
curr_Stock_Price:  93.21822722978715
curr_Factors:  [9.32182272e+01 2.99430086e-02]
mat_Sqrt:  [[ 1.61305255e+01 -6.91482006e-03]
 [-6.91482006e-03  1.58623879e-02]]
grads:  [4.83048714e-03 1.04779614e+01]
Stock Position:  0.004830487139663004
Bond Position:  [-9.68394664]


portfolio before change:  [-9.22148954]
curr_Stock_Price:  98.24466709961064
curr_Factors:  [9.82446671e+01 2.75643672e-02]
mat_Sqrt:  [[ 1.63110892e+01 -6.63481791e-03]
 [-6.63481791e-03  1.52191611e-02]]
grads:  [-0.00598165 -4.81253436]
Stock Position:  -0.005981648350865152
Bond Position:  [-8.63382449]


portfolio before change:  [-9.22803755]
curr_Stock_Price:  97.53399003301855
curr_Factors:  [9.75339900e+01 2.99171672e-02]
mat_Sqrt:  [[ 1.68700430e+01 -6.91213608e-03]
 [-6.91213608e-03  1.58554106e-02]]
grads:  [ 0.00311134 -2.89298866]
Stock Position:  0.003111336908769769
Bond Position:  [-9.53149865]


portfolio before change:  [-9.22156428]
curr_Stock_Price:  103.44626923177118
curr_Factors:  [1.03446269e+02 2.76796808e-02]
mat_Sqrt:  [[ 1.72105734e+01 -6.64899324e-03]
 [-6.64899324e-03  1.52508261e-02]]
grads:  [-1.98998691e-03 -9.58889508e+00]
Stock Position:  -0.001989986911815025
Bond Position:  [-9.01570756]


portfolio before change:  [-9.22677329]
curr_Stock_Price:  100.3971652552476
curr_Factors:  [1.00397165e+02 3.35015804e-02]
mat_Sqrt:  [[ 1.83761304e+01 -7.31469669e-03]
 [-7.31469669e-03  1.67782900e-02]]
grads:  [0.00328996 2.85036874]
Stock Position:  0.003289963995632553
Bond Position:  [-9.55707634]


portfolio before change:  [-9.23830804]
curr_Stock_Price:  100.52454173695423
curr_Factors:  [1.00524542e+02 3.54204974e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.23830804]
Stock Price:  98.39763741407317
PL:  [-9.23830804]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 8.61462027e-02 -2.64101444e-02]
 [ 8.48825564e-03  4.31688938e-02]
 [ 6.26526323e-02  5.60939883e-02]
 [-1.63201829e-01 -8.75004339e-02]
 [ 4.06329291e-01  3.59204564e-02]
 [ 1.12495988e-01  8.54575380e-02]
 [-2.84545289e-02 -2.92258450e-02]
 [ 3.86423530e-02  1.20601771e-02]
 [-2.36007106e-02 -2.39240636e-02]
 [ 4.54367462e-02  8.12666604e-02]
 [ 5.91617663e-02 -1.11960661e-01]
 [-7.10498985e-03  1.68517251e-02]
 [-1.26742061e-01 -1.35691782e-01]
 [ 4.14525026e-03  1.64436463e-01]
 [-9.10492466e-02 -2.54655411e-03]
 [-2.06798084e-02 -2.78936047e-03]
 [-4.92024882e-02  4.76553379e-02]
 [ 1.18189720e-01 -6.39249077e-02]
 [-6.99804989e-02 -6.54799553e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.99375463]
curr_Stock_Price:  98.81958112574296
curr_Factors:  [9.88195811e+01 4.64505981e-02]
mat_Sqrt:  [[ 2.12979905e+01 -8.61297141e-03]
 [-8.61297141e-03  1.97565864e-02]]
grads:  [ 0.00350483 -1.33524876]
Stock Position:  0.0035048256489951133
Bond Position:  [1.64740923]


portfolio before change:  [1.98952219]
curr_Stock_Price:  97.02405770502943
curr_Factors:  [9.70240577e+01 4.80067437e-02]
mat_Sqrt:  [[ 2.12583974e+01 -8.75590471e-03]
 [-8.75590471e-03  2.00848592e-02]]
grads:  [1.28478388e-03 2.14988528e+00]
Stock Position:  0.001284783880492657
Bond Position:  [1.86486724]


portfolio before change:  [1.99291721]
curr_Stock_Price:  97.85103410931787
curr_Factors:  [9.78510341e+01 3.87504007e-02]
mat_Sqrt:  [[ 1.92620933e+01 -7.86667966e-03]
 [-7.86667966e-03  1.80449261e-02]]
grads:  [0.00452299 3.1105458 ]
Stock Position:  0.00452299229853212
Bond Position:  [1.55033774]


portfolio before change:  [1.97731695]
curr_Stock_Price:  93.97320261147789
curr_Factors:  [9.39732026e+01 3.72484625e-02]
mat_Sqrt:  [[ 1.81366956e+01 -7.71242173e-03]
 [-7.71242173e-03  1.76918958e-02]]
grads:  [-0.01110363 -4.95063225]
Stock Position:  -0.011103631954351907
Bond Position:  [3.0207608]


portfolio before change:  [2.01507587]
curr_Stock_Price:  90.9128875334185
curr_Factors:  [9.09128875e+01 3.54856658e-02]
mat_Sqrt:  [[ 1.71258403e+01 -7.52746641e-03]
 [-7.52746641e-03  1.72682920e-02]]
grads:  [0.02464512 2.09088263]
Stock Position:  0.024645117154022914
Bond Position:  [-0.22548289]


portfolio before change:  [2.18511437]
curr_Stock_Price:  97.82381130571515
curr_Factors:  [9.78238113e+01 3.27639619e-02]
mat_Sqrt:  [[ 1.77069088e+01 -7.23354953e-03]
 [-7.23354953e-03  1.65926303e-02]]
grads:  [0.00845872 5.15401856]
Stock Position:  0.008458723038666363
Bond Position:  [1.35764984]


portfolio before change:  [2.17301835]
curr_Stock_Price:  96.19305157614592
curr_Factors:  [9.61930516e+01 3.05579068e-02]
mat_Sqrt:  [[ 1.68153328e+01 -6.98567154e-03]
 [-6.98567154e-03  1.60243397e-02]]
grads:  [-0.00245031 -1.82490902]
Stock Position:  -0.002450307975033107
Bond Position:  [2.40872095]


portfolio before change:  [2.17512391]
curr_Stock_Price:  96.56330048073968
curr_Factors:  [9.65633005e+01 2.99445549e-02]
mat_Sqrt:  [[ 1.67097901e+01 -6.91523394e-03]
 [-6.91523394e-03  1.58626949e-02]]
grads:  [0.00262767 0.76143103]
Stock Position:  0.0026276707460000685
Bond Position:  [1.92138735]


portfolio before change:  [2.17336318]
curr_Stock_Price:  94.97864047893262
curr_Factors:  [9.49786405e+01 3.00382164e-02]
mat_Sqrt:  [[ 1.64612565e+01 -6.92593075e-03]
 [-6.92593075e-03  1.58875312e-02]]
grads:  [-0.00206766 -1.50674033]
Stock Position:  -0.002067660501022193
Bond Position:  [2.36974676]


portfolio before change:  [2.17474314]
curr_Stock_Price:  95.74475975990046
curr_Factors:  [9.57447598e+01 2.83699432e-02]
mat_Sqrt:  [[ 1.61266518e+01 -6.73090806e-03]
 [-6.73090806e-03  1.54400230e-02]]
grads:  [5.01522381e-03 5.26556325e+00]
Stock Position:  0.00501522381496508
Bond Position:  [1.69456174]


portfolio before change:  [2.17712506]
curr_Stock_Price:  95.79707947847686
curr_Factors:  [9.57970795e+01 3.05889263e-02]
mat_Sqrt:  [[ 1.67546110e+01 -6.98918874e-03]
 [-6.98918874e-03  1.60324828e-02]]
grads:  [ 6.18074724e-04 -6.98309440e+00]
Stock Position:  0.0006180747240047079
Bond Position:  [2.11791531]


portfolio before change:  [2.17916633]
curr_Stock_Price:  94.81373100332063
curr_Factors:  [9.48137310e+01 3.14710022e-02]
mat_Sqrt:  [[ 1.68200191e+01 -7.08917394e-03]
 [-7.08917394e-03  1.62620305e-02]]
grads:  [1.43457888e-05 1.03626831e+00]
Stock Position:  1.4345788794536037e-05
Bond Position:  [2.17780615]


portfolio before change:  [2.18184516]
curr_Stock_Price:  91.66836536011189
curr_Factors:  [9.16683654e+01 3.19565842e-02]
mat_Sqrt:  [[ 1.63870063e+01 -7.14341906e-03]
 [-7.14341906e-03  1.63871110e-02]]
grads:  [-0.01134605 -8.28534278]
Stock Position:  -0.01134604655302215
Bond Position:  [3.2219187]


portfolio before change:  [2.15122343]
curr_Stock_Price:  94.72243753929921
curr_Factors:  [9.47224375e+01 3.28267604e-02]
mat_Sqrt:  [[ 1.71619582e+01 -7.24025653e-03]
 [-7.24025653e-03  1.66086209e-02]]
grads:  [4.41922671e-03 9.90259578e+00]
Stock Position:  0.004419226712606011
Bond Position:  [1.73262351]


portfolio before change:  [2.14305771]
curr_Stock_Price:  92.38427741081748
curr_Factors:  [9.23842774e+01 3.35792263e-02]
mat_Sqrt:  [[ 1.69290804e+01 -7.32258897e-03]
 [-7.32258897e-03  1.67979747e-02]]
grads:  [-0.00544487 -0.15397241]
Stock Position:  -0.005444874793744303
Bond Position:  [2.64607853]


portfolio before change:  [2.13867164]
curr_Stock_Price:  93.79766870789925
curr_Factors:  [9.37976687e+01 3.19181247e-02]
mat_Sqrt:  [[ 1.67575564e+01 -7.13928115e-03]
 [-7.13928115e-03  1.63771766e-02]]
grads:  [-0.00130686 -0.17088968]
Stock Position:  -0.0013068634494118843
Bond Position:  [2.26125238]


portfolio before change:  [2.14122346]
curr_Stock_Price:  94.00924744412526
curr_Factors:  [9.40092474e+01 3.38909122e-02]
mat_Sqrt:  [[ 1.73066163e+01 -7.35662105e-03]
 [-7.35662105e-03  1.68757000e-02]]
grads:  [-1.64291927e-03  2.82318669e+00]
Stock Position:  -0.0016429192714946532
Bond Position:  [2.29567307]


portfolio before change:  [2.14609095]
curr_Stock_Price:  92.7942741980339
curr_Factors:  [9.27942742e+01 3.71079906e-02]
mat_Sqrt:  [[ 1.78753625e+01 -7.69777009e-03]
 [-7.69777009e-03  1.76585459e-02]]
grads:  [ 0.0050539  -3.61785192]
Stock Position:  0.005053901835009867
Bond Position:  [1.6771178]


portfolio before change:  [2.19492767]
curr_Stock_Price:  102.04237817977845
curr_Factors:  [1.02042378e+02 2.96437675e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.19492767]
Stock Price:  104.04352979176876
PL:  [-1.84860212]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.64022600e-01  2.57417380e-03]
 [-3.96309296e-03  5.86228409e-02]
 [ 6.88688457e-02  3.41693403e-02]
 [ 2.36171840e-02  1.83462205e-02]
 [-2.06912784e-01 -2.16942715e-02]
 [ 8.26703317e-02  2.12750770e-02]
 [-1.07029167e-01 -1.34902506e-01]
 [ 3.20103616e-02 -1.70747121e-02]
 [-1.67100817e-01 -1.31888139e-01]
 [ 6.17205921e-02  3.14364481e-01]
 [ 5.60102360e-02 -1.03302834e-01]
 [-1.07207513e-02  3.09264519e-02]
 [-9.62235198e-02 -1.38929721e-01]
 [ 4.58970365e-03  1.65020936e-01]
 [-1.03408195e-01  9.23377742e-02]
 [-1.26616956e-01  5.34331912e-02]
 [-1.10449414e-01  2.19428353e-01]
 [ 9.44949709e-02 -1.15578732e-01]
 [ 7.31527280e-02  5.77657463e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.68220215]
curr_Stock_Price:  97.30247806146846
curr_Factors:  [9.73024781e+01 3.81988804e-02]
mat_Sqrt:  [[ 1.90173142e+01 -7.81045603e-03]
 [-7.81045603e-03  1.79160704e-02]]
grads:  [0.00868547 0.147466  ]
Stock Position:  0.008685473436328403
Bond Position:  [-4.52732024]


portfolio before change:  [-3.69449758]
curr_Stock_Price:  96.53881870188935
curr_Factors:  [9.65388187e+01 4.33724698e-02]
mat_Sqrt:  [[ 2.01052288e+01 -8.32252135e-03]
 [-8.32252135e-03  1.90908443e-02]]
grads:  [1.07419946e-03 3.07119895e+00]
Stock Position:  0.001074199457467994
Bond Position:  [-3.79819953]


portfolio before change:  [-3.69592208]
curr_Stock_Price:  99.63528474319318
curr_Factors:  [9.96352847e+01 4.13768588e-02]
mat_Sqrt:  [[ 2.02671130e+01 -8.12904269e-03]
 [-8.12904269e-03  1.86463737e-02]]
grads:  [0.00413379 1.83429468]
Stock Position:  0.004133785862930956
Bond Position:  [-4.10779301]


portfolio before change:  [-3.71537491]
curr_Stock_Price:  96.17238764458308
curr_Factors:  [9.61723876e+01 4.87991748e-02]
mat_Sqrt:  [[ 2.12449934e+01 -8.82780051e-03]
 [-8.82780051e-03  2.02499799e-02]]
grads:  [0.00148839 0.90663595]
Stock Position:  0.0014883876263477056
Bond Position:  [-3.8585167]


portfolio before change:  [-3.71685404]
curr_Stock_Price:  98.421149291984
curr_Factors:  [9.84211493e+01 5.16520031e-02]
mat_Sqrt:  [[ 2.23682486e+01 -9.08237240e-03]
 [-9.08237240e-03  2.08333997e-02]]
grads:  [-0.00967482 -1.04553948]
Stock Position:  -0.009674819289871272
Bond Position:  [-2.76464721]


portfolio before change:  [-3.69543395]
curr_Stock_Price:  95.8497261816031
curr_Factors:  [9.58497262e+01 5.85954466e-02]
mat_Sqrt:  [[ 2.32018585e+01 -9.67334804e-03]
 [-9.67334804e-03  2.21896553e-02]]
grads:  [0.00396355 0.96051144]
Stock Position:  0.003963548580932372
Bond Position:  [-4.075339]


portfolio before change:  [-3.70987602]
curr_Stock_Price:  93.4920643010672
curr_Factors:  [9.34920643e+01 5.98092869e-02]
mat_Sqrt:  [[ 2.28643585e+01 -9.77279363e-03]
 [-9.77279363e-03  2.24184160e-02]]
grads:  [-0.00725442 -6.0206485 ]
Stock Position:  -0.007254422712583722
Bond Position:  [-3.03164507]


portfolio before change:  [-3.70740084]
curr_Stock_Price:  92.62816296067015
curr_Factors:  [9.26281630e+01 6.29841235e-02]
mat_Sqrt:  [[ 2.32465525e+01 -1.00287312e-02]
 [-1.00287312e-02  2.30057772e-02]]
grads:  [ 0.00105701 -0.74173159]
Stock Position:  0.0010570055437552717
Bond Position:  [-3.80530932]


portfolio before change:  [-3.71813026]
curr_Stock_Price:  86.98031401024888
curr_Factors:  [8.69803140e+01 5.89221579e-02]
mat_Sqrt:  [[ 2.11135007e+01 -9.69933345e-03]
 [-9.69933345e-03  2.22518428e-02]]
grads:  [-0.01063937 -5.93170348]
Stock Position:  -0.010639371953570138
Bond Position:  [-2.79271435]


portfolio before change:  [-3.74081794]
curr_Stock_Price:  88.78442452599563
curr_Factors:  [8.87844245e+01 5.88266918e-02]
mat_Sqrt:  [[ 2.15339625e+01 -9.69168014e-03]
 [-9.69168014e-03  2.22337188e-02]]
grads:  [9.23151502e-03 1.41431108e+01]
Stock Position:  0.009231515018077828
Bond Position:  [-4.56043269]


portfolio before change:  [-3.74060359]
curr_Stock_Price:  89.42553847279959
curr_Factors:  [8.94255385e+01 5.86368117e-02]
mat_Sqrt:  [[ 2.16544269e+01 -9.67609771e-03]
 [-9.67609771e-03  2.21977758e-02]]
grads:  [ 5.07160206e-04 -4.65352601e+00]
Stock Position:  0.0005071602056216075
Bond Position:  [-3.78595666]


portfolio before change:  [-3.7415064]
curr_Stock_Price:  96.98251086218706
curr_Factors:  [9.69825109e+01 5.57526678e-02]
mat_Sqrt:  [[ 2.28995113e+01 -9.43588312e-03]
 [-9.43588312e-03  2.16446480e-02]]
grads:  [1.20613361e-04 1.42887932e+00]
Stock Position:  0.00012061336129499736
Bond Position:  [-3.75320379]


portfolio before change:  [-3.74628791]
curr_Stock_Price:  96.26058695240316
curr_Factors:  [9.62605870e+01 6.01207873e-02]
mat_Sqrt:  [[ 2.36026517e+01 -9.79848609e-03]
 [-9.79848609e-03  2.24765999e-02]]
grads:  [-0.00664405 -6.18397901]
Stock Position:  -0.006644048053280667
Bond Position:  [-3.10672795]


portfolio before change:  [-3.73623193]
curr_Stock_Price:  94.16219485254426
curr_Factors:  [9.41621949e+01 6.83132406e-02]
mat_Sqrt:  [[ 2.46109840e+01 -1.04445537e-02]
 [-1.04445537e-02  2.39592092e-02]]
grads:  [3.11005640e-03 6.88893434e+00]
Stock Position:  0.003110056401791365
Bond Position:  [-4.02908167]


portfolio before change:  [-3.76162264]
curr_Stock_Price:  87.61851812389084
curr_Factors:  [8.76185181e+01 6.28640533e-02]
mat_Sqrt:  [[ 2.19683302e+01 -1.00186012e-02]
 [-1.00186012e-02  2.29840850e-02]]
grads:  [-2.87556517e-03  4.01621231e+00]
Stock Position:  -0.0028755651734842834
Bond Position:  [-3.50966988]


portfolio before change:  [-3.76368176]
curr_Stock_Price:  86.80799811773458
curr_Factors:  [8.68079981e+01 6.25609203e-02]
mat_Sqrt:  [[ 2.17125714e+01 -9.99431942e-03]
 [-9.99431942e-03  2.29286455e-02]]
grads:  [-0.00475977  2.32833731]
Stock Position:  -0.004759768293647186
Bond Position:  [-3.35049581]


portfolio before change:  [-3.74572477]
curr_Stock_Price:  82.15488742403053
curr_Factors:  [8.21548874e+01 6.58249688e-02]
mat_Sqrt:  [[ 2.10779653e+01 -1.02511136e-02]
 [-1.02511136e-02  2.35194464e-02]]
grads:  [-7.02780701e-04  9.32935007e+00]
Stock Position:  -0.0007027807006993828
Bond Position:  [-3.6879879]


portfolio before change:  [-3.75420251]
curr_Stock_Price:  87.65427747376324
curr_Factors:  [8.76542775e+01 6.42483581e-02]
mat_Sqrt:  [[ 2.22179552e+01 -1.01283127e-02]
 [-1.01283127e-02  2.32357669e-02]]
grads:  [ 1.98595035e-03 -4.97330766e+00]
Stock Position:  0.001985950350353032
Bond Position:  [-3.92827955]


portfolio before change:  [-3.75945281]
curr_Stock_Price:  87.48464195715681
curr_Factors:  [8.74846420e+01 6.35668205e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.75945281]
Stock Price:  83.99788099590269
PL:  [-3.75945281]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-5.91012385e-02 -8.08805521e-02]
 [ 2.33027724e-02 -6.37970969e-02]
 [ 6.98372273e-02  1.90305907e-02]
 [-1.52475953e-02 -5.02755503e-03]
 [-1.80999192e-01  1.48222741e-03]
 [ 1.08796623e-01  7.58562997e-02]
 [ 3.16115648e-03  1.32899127e-02]
 [ 3.72258172e-02  4.33425358e-02]
 [-6.95544569e-02 -5.88018709e-02]
 [ 4.53020571e-02  2.43943258e-01]
 [ 5.79655369e-02 -1.08674401e-01]
 [-2.78086015e-03  3.17893389e-03]
 [-1.28031523e-01 -1.35099898e-01]
 [ 4.49213035e-03  1.64892623e-01]
 [-9.75767466e-02  4.36538498e-02]
 [-2.29229662e-02 -1.68242767e-03]
 [-2.41481904e-02 -1.00343386e-02]
 [ 1.21016121e-01 -7.06025694e-02]
 [ 1.32768033e-01  7.45958165e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.49691036]
curr_Stock_Price:  100.82506865289179
curr_Factors:  [1.00825069e+02 4.10659444e-02]
mat_Sqrt:  [[ 2.04319304e+01 -8.09853128e-03]
 [-8.09853128e-03  1.85761469e-02]]
grads:  [-0.00461917 -4.35601424]
Stock Position:  -0.004619169816955946
Bond Position:  [9.96263847]


portfolio before change:  [9.50610116]
curr_Stock_Price:  101.53304903309224
curr_Factors:  [1.01533049e+02 4.32583750e-02]
mat_Sqrt:  [[ 2.11174996e+01 -8.31195546e-03]
 [-8.31195546e-03  1.90655487e-02]]
grads:  [-2.13635556e-04 -3.34629093e+00]
Stock Position:  -0.00021363555619444545
Bond Position:  [9.52779223]


portfolio before change:  [9.5183745]
curr_Stock_Price:  99.86592718339199
curr_Factors:  [9.98659272e+01 4.31386750e-02]
mat_Sqrt:  [[ 2.07420036e+01 -8.30032253e-03]
 [-8.30032253e-03  1.90392068e-02]]
grads:  [0.00376759 1.00118997]
Stock Position:  0.0037675929815573043
Bond Position:  [9.14212034]


portfolio before change:  [9.53194255]
curr_Stock_Price:  100.43213794082018
curr_Factors:  [1.00432138e+02 4.50073795e-02]
mat_Sqrt:  [[ 2.13066188e+01 -8.47823942e-03]
 [-8.47823942e-03  1.94471913e-02]]
grads:  [-0.00081864 -0.25888035]
Stock Position:  -0.0008186397392663577
Bond Position:  [9.61416029]


portfolio before change:  [9.54772406]
curr_Stock_Price:  95.84367742019374
curr_Factors:  [9.58436774e+01 4.69447883e-02]
mat_Sqrt:  [[ 2.07662043e+01 -8.65841795e-03]
 [-8.65841795e-03  1.98615126e-02]]
grads:  [-0.00868651  0.07084133]
Stock Position:  -0.00868650884131995
Bond Position:  [10.38027101]


portfolio before change:  [9.54582865]
curr_Stock_Price:  97.55654780447716
curr_Factors:  [9.75565478e+01 4.61427386e-02]
mat_Sqrt:  [[ 2.09559846e+01 -8.58427897e-03]
 [-8.58427897e-03  1.96910523e-02]]
grads:  [0.00677092 3.85527508]
Stock Position:  0.006770924043254617
Bond Position:  [8.88528067]


portfolio before change:  [9.55497637]
curr_Stock_Price:  97.2662151298178
curr_Factors:  [9.72662151e+01 4.45202544e-02]
mat_Sqrt:  [[ 2.05229978e+01 -8.43198337e-03]
 [-8.43198337e-03  1.93417735e-02]]
grads:  [4.36410659e-04 6.87299567e-01]
Stock Position:  0.0004364106591074034
Bond Position:  [9.51252836]


portfolio before change:  [9.56686104]
curr_Stock_Price:  97.23544309132204
curr_Factors:  [9.72354431e+01 4.57214842e-02]
mat_Sqrt:  [[ 2.07914473e+01 -8.54497808e-03]
 [-8.54497808e-03  1.96009743e-02]]
grads:  [0.00269971 2.21242088]
Stock Position:  0.0026997113043654205
Bond Position:  [9.30435342]


portfolio before change:  [9.56477948]
curr_Stock_Price:  92.15368826005853
curr_Factors:  [9.21536883e+01 4.92691949e-02]
mat_Sqrt:  [[ 2.04550438e+01 -8.86984377e-03]
 [-8.86984377e-03  2.03474279e-02]]
grads:  [-0.00465437 -2.89192102]
Stock Position:  -0.004654370114662949
Bond Position:  [9.99369686]


portfolio before change:  [9.57929249]
curr_Stock_Price:  91.72117629613659
curr_Factors:  [9.17211763e+01 5.09034990e-02]
mat_Sqrt:  [[ 2.06939499e+01 -9.01571180e-03]
 [-9.01571180e-03  2.06821646e-02]]
grads:  [7.32919189e-03 1.17980560e+01]
Stock Position:  0.0073291918937031025
Bond Position:  [8.90705038]


portfolio before change:  [9.59329566]
curr_Stock_Price:  92.11172408635707
curr_Factors:  [9.21117241e+01 4.97411963e-02]
mat_Sqrt:  [[ 2.05434313e+01 -8.91222524e-03]
 [-8.91222524e-03  2.04446620e-02]]
grads:  [ 5.15700525e-04 -5.31531435e+00]
Stock Position:  0.0005157005249693249
Bond Position:  [9.5457936]


portfolio before change:  [9.60602782]
curr_Stock_Price:  93.64839091789722
curr_Factors:  [9.36483909e+01 4.78684857e-02]
mat_Sqrt:  [[ 2.04892058e+01 -8.74298977e-03]
 [-8.74298977e-03  2.00560461e-02]]
grads:  [-6.81009205e-05  1.58472835e-01]
Stock Position:  -6.810092053431059e-05
Bond Position:  [9.61240536]


portfolio before change:  [9.61819642]
curr_Stock_Price:  91.51071823047839
curr_Factors:  [9.15107182e+01 4.74120615e-02]
mat_Sqrt:  [[ 1.99258264e+01 -8.70100913e-03]
 [-8.70100913e-03  1.99602869e-02]]
grads:  [-0.00938276 -6.77252476]
Stock Position:  -0.009382763823959616
Bond Position:  [10.47681988]


portfolio before change:  [9.60503371]
curr_Stock_Price:  94.31020510473705
curr_Factors:  [9.43102051e+01 4.35378361e-02]
mat_Sqrt:  [[ 1.96785036e+01 -8.33818498e-03]
 [-8.33818498e-03  1.91272850e-02]]
grads:  [3.88180531e-03 8.62249872e+00]
Stock Position:  0.003881805308833686
Bond Position:  [9.23893985]


portfolio before change:  [9.59980683]
curr_Stock_Price:  89.9867589649699
curr_Factors:  [8.99867590e+01 4.17424557e-02]
mat_Sqrt:  [[ 1.83851664e+01 -8.16407230e-03]
 [-8.16407230e-03  1.87289210e-02]]
grads:  [-0.00427317  2.32896297]
Stock Position:  -0.004273169076901542
Bond Position:  [9.98433546]


portfolio before change:  [9.59656733]
curr_Stock_Price:  93.6673345426638
curr_Factors:  [9.36673345e+01 4.28478259e-02]
mat_Sqrt:  [[ 1.93888709e+01 -8.27179204e-03]
 [-8.27179204e-03  1.89751341e-02]]
grads:  [-0.00122033 -0.08919684]
Stock Position:  -0.0012203280999062871
Bond Position:  [9.71087221]


portfolio before change:  [9.60518282]
curr_Stock_Price:  96.56056750307258
curr_Factors:  [9.65605675e+01 4.08095788e-02]
mat_Sqrt:  [[ 1.95065663e+01 -8.07288917e-03]
 [-8.07288917e-03  1.85182140e-02]]
grads:  [-0.00146247 -0.54250075]
Stock Position:  -0.001462468502428748
Bond Position:  [9.7463996]


portfolio before change:  [9.62393319]
curr_Stock_Price:  92.07516522195472
curr_Factors:  [9.20751652e+01 4.10326594e-02]
mat_Sqrt:  [[ 1.86512223e+01 -8.09454985e-03]
 [-8.09454985e-03  1.85689218e-02]]
grads:  [ 0.00483916 -3.80008055]
Stock Position:  0.004839156292634429
Bond Position:  [9.17836708]


portfolio before change:  [9.64108059]
curr_Stock_Price:  93.24629174187343
curr_Factors:  [9.32462917e+01 3.45210864e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.64108059]
Stock Price:  90.02105748612017
PL:  [9.64108059]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-5.24681024e-03 -5.58453490e-02]
 [-3.61631154e-02 -1.35294762e-01]
 [ 6.55533892e-02 -1.48104081e-01]
 [-1.97085495e-02 -1.71526722e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-1.83756282e-01  4.34351486e-02]
 [ 4.93723712e-02  3.97574521e-02]
 [ 6.54060511e-02 -4.19380619e-02]
 [ 1.17452827e-01 -1.13663949e-01]
 [ 5.48732731e-01 -4.17367065e-02]
 [ 5.75015259e-02  2.63289853e-01]
 [-7.75944469e-02 -9.16706201e-02]
 [ 1.16273319e-01 -1.60595106e-01]
 [ 2.86778638e-01 -2.47171862e-01]
 [ 1.98492851e-01 -1.50736873e-01]
 [-1.33590185e-01  4.74311608e-02]
 [-1.19730850e-01 -1.42775156e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.22191688]
curr_Stock_Price:  102.62256789307006
curr_Factors:  [1.02622568e+02 3.78263398e-02]
mat_Sqrt:  [[ 1.99590564e+01 -7.77265562e-03]
 [-7.77265562e-03  1.78283264e-02]]
grads:  [-1.48297883e-03 -3.13304089e+00]
Stock Position:  -0.001482978833649734
Bond Position:  [16.37410398]


portfolio before change:  [16.23841761]
curr_Stock_Price:  105.30615665934742
curr_Factors:  [1.05306157e+02 3.68597431e-02]
mat_Sqrt:  [[ 2.02176132e+01 -7.67287805e-03]
 [-7.67287805e-03  1.75989879e-02]]
grads:  [-4.70704525e-03 -7.68969667e+00]
Stock Position:  -0.0047070452497305505
Bond Position:  [16.73409845]


portfolio before change:  [16.27140878]
curr_Stock_Price:  102.74393974888159
curr_Factors:  [1.02743940e+02 3.80012052e-02]
mat_Sqrt:  [[ 2.00287971e+01 -7.79060902e-03]
 [-7.79060902e-03  1.78694841e-02]]
grads:  [ 4.91395161e-05 -8.28807911e+00]
Stock Position:  4.913951613619145e-05
Bond Position:  [16.26635999]


portfolio before change:  [16.29174762]
curr_Stock_Price:  102.60512682597289
curr_Factors:  [1.02605127e+02 3.84271417e-02]
mat_Sqrt:  [[ 2.01135194e+01 -7.83413843e-03]
 [-7.83413843e-03  1.79693542e-02]]
grads:  [-0.00135189 -0.95514078]
Stock Position:  -0.001351889443103045
Bond Position:  [16.43045841]


portfolio before change:  [16.30939592]
curr_Stock_Price:  104.75220670156862
curr_Factors:  [1.04752207e+02 3.31388390e-02]
mat_Sqrt:  [[ 1.90691701e+01 -7.27526456e-03]
 [-7.27526456e-03  1.66870883e-02]]
grads:  [ 0.00859914 -7.07417355]
Stock Position:  0.008599141769312939
Bond Position:  [15.40861685]


portfolio before change:  [16.37080267]
curr_Stock_Price:  109.65199027552566
curr_Factors:  [1.09651990e+02 2.90906331e-02]
mat_Sqrt:  [[ 1.87022164e+01 -6.81669245e-03]
 [-6.81669245e-03  1.56345462e-02]]
grads:  [0.00924874 6.79735794]
Stock Position:  0.00924873626085258
Bond Position:  [15.35666033]


portfolio before change:  [16.40975942]
curr_Stock_Price:  111.78730065993498
curr_Factors:  [1.11787301e+02 3.48134592e-02]
mat_Sqrt:  [[ 2.08576815e+01 -7.45723161e-03]
 [-7.45723161e-03  1.71033414e-02]]
grads:  [4.30294246e-03 4.73707116e+00]
Stock Position:  0.0043029424578362565
Bond Position:  [15.9287451]


portfolio before change:  [16.42550702]
curr_Stock_Price:  110.81685337215086
curr_Factors:  [1.10816853e+02 3.32663856e-02]
mat_Sqrt:  [[ 2.02119677e+01 -7.28960063e-03]
 [-7.28960063e-03  1.67190185e-02]]
grads:  [-0.00815577  2.59439251]
Stock Position:  -0.008155771824593386
Bond Position:  [17.32930399]


portfolio before change:  [16.40965058]
curr_Stock_Price:  115.41870088736978
curr_Factors:  [1.15418701e+02 3.40453672e-02]
mat_Sqrt:  [[ 2.12963496e+01 -7.37469816e-03]
 [-7.37469816e-03  1.69135301e-02]]
grads:  [0.00313282 2.35199604]
Stock Position:  0.0031328201019820085
Bond Position:  [16.04806455]


portfolio before change:  [16.42716505]
curr_Stock_Price:  114.60213646772861
curr_Factors:  [1.14602136e+02 3.76907413e-02]
mat_Sqrt:  [[ 2.22489760e+01 -7.75943540e-03]
 [-7.75943540e-03  1.77960269e-02]]
grads:  [ 2.11818091e-03 -2.35567333e+00]
Stock Position:  0.0021181809067189208
Bond Position:  [16.18441699]


portfolio before change:  [16.46616071]
curr_Stock_Price:  123.45524445486912
curr_Factors:  [1.23455244e+02 3.29472046e-02]
mat_Sqrt:  [[ 2.24088107e+01 -7.25515943e-03]
 [-7.25515943e-03  1.66383505e-02]]
grads:  [ 3.03002256e-03 -6.83012209e+00]
Stock Position:  0.0030300225580664397
Bond Position:  [16.09208853]


portfolio before change:  [16.4954886]
curr_Stock_Price:  126.49159468100156
curr_Factors:  [1.26491595e+02 3.07570699e-02]
mat_Sqrt:  [[ 2.21837073e+01 -7.00999791e-03]
 [-7.00999791e-03  1.60757777e-02]]
grads:  [ 0.02391873 -2.58581806]
Stock Position:  0.023918732123845574
Bond Position:  [13.46997004]


portfolio before change:  [16.57972695]
curr_Stock_Price:  129.30906665364915
curr_Factors:  [1.29309067e+02 3.04334603e-02]
mat_Sqrt:  [[ 2.25582094e+01 -6.97313267e-03]
 [-6.97313267e-03  1.59909357e-02]]
grads:  [7.63965743e-03 1.64682749e+01]
Stock Position:  0.007639657428911698
Bond Position:  [15.59184998]


portfolio before change:  [16.57842899]
curr_Stock_Price:  126.58643628391503
curr_Factors:  [1.26586436e+02 3.06408717e-02]
mat_Sqrt:  [[ 2.21583649e+01 -6.99674752e-03]
 [-6.99674752e-03  1.60453807e-02]]
grads:  [-5.30655224e-03 -5.71552339e+00]
Stock Position:  -0.005306552241810701
Bond Position:  [17.25016652]


portfolio before change:  [16.57001452]
curr_Stock_Price:  132.23806339565527
curr_Factors:  [1.32238063e+02 2.65004412e-02]
mat_Sqrt:  [[ 2.15269753e+01 -6.50707223e-03]
 [-6.50707223e-03  1.49218773e-02]]
grads:  [ 2.14836253e-03 -1.07614560e+01]
Stock Position:  0.0021483625306584378
Bond Position:  [16.28591922]


portfolio before change:  [16.58716034]
curr_Stock_Price:  130.73723985986973
curr_Factors:  [1.30737240e+02 2.67365945e-02]
mat_Sqrt:  [[ 2.13772746e+01 -6.53594917e-03]
 [-6.53594917e-03  1.49882392e-02]]
grads:  [ 8.37421131e-03 -1.64874023e+01]
Stock Position:  0.008374211313857684
Bond Position:  [15.49233906]


portfolio before change:  [16.58705513]
curr_Stock_Price:  128.41072390302827
curr_Factors:  [1.28410724e+02 2.75388495e-02]
mat_Sqrt:  [[ 2.13095447e+01 -6.63319868e-03]
 [-6.63319868e-03  1.52114815e-02]]
grads:  [ 6.23099940e-03 -9.90669719e+00]
Stock Position:  0.006230999398344881
Bond Position:  [15.78692799]


portfolio before change:  [16.57768697]
curr_Stock_Price:  123.7382535014146
curr_Factors:  [1.23738254e+02 3.01085342e-02]
mat_Sqrt:  [[ 2.14708266e+01 -6.93558689e-03]
 [-6.93558689e-03  1.59054386e-02]]
grads:  [-0.0052594   2.97977849]
Stock Position:  -0.005259400332356803
Bond Position:  [17.22847598]


portfolio before change:  [16.5940861]
curr_Stock_Price:  124.71744038402464
curr_Factors:  [1.24717440e+02 2.93616531e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.5940861]
Stock Price:  122.28739145297955
PL:  [-5.69330536]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-9.24035348e-03 -6.20817179e-02]
 [-8.77085199e-02  7.20104395e-02]
 [ 6.21413940e-02  5.76130966e-02]
 [ 1.10622841e-02  9.68571194e-03]
 [ 1.34281882e-01  2.15471527e-02]
 [ 5.83897924e-03 -2.22353399e-01]
 [-1.84144857e-01 -2.37870287e-01]
 [ 3.39375948e-02 -8.70993349e-03]
 [-2.78496780e-01 -2.15328065e-01]
 [ 9.18905574e-02  4.43737353e-01]
 [ 4.51592801e-02 -9.42141754e-02]
 [ 2.85268297e-02 -1.10253362e-01]
 [-2.02851154e-01 -1.00756472e-01]
 [ 5.07456118e-03  1.42027438e-01]
 [-9.17699138e-02  2.94501275e-01]
 [-3.25034397e-01  1.58896393e-01]
 [-1.38430389e-01  3.07513736e-01]
 [-7.12778403e-02 -2.07408391e-01]
 [-3.36581625e-02  1.03834436e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.91407384]
curr_Stock_Price:  99.86742706611457
curr_Factors:  [9.98674271e+01 4.52973548e-02]
mat_Sqrt:  [[ 2.12549578e+01 -8.50546367e-03]
 [-8.50546367e-03  1.95097574e-02]]
grads:  [-1.70839208e-03 -3.18283038e+00]
Stock Position:  -0.0017083920834870415
Bond Position:  [6.08468656]


portfolio before change:  [5.93130908]
curr_Stock_Price:  94.23369438800336
curr_Factors:  [9.42336944e+01 4.94944296e-02]
mat_Sqrt:  [[ 2.09644919e+01 -8.89028995e-03]
 [-8.89028995e-03  2.03937991e-02]]
grads:  [-2.68679764e-03  3.52982555e+00]
Stock Position:  -0.002686797639415304
Bond Position:  [6.18449594]


portfolio before change:  [5.92971676]
curr_Stock_Price:  97.70539793613425
curr_Factors:  [9.77053979e+01 4.38525187e-02]
mat_Sqrt:  [[ 2.04604788e+01 -8.36854646e-03]
 [-8.36854646e-03  1.91961615e-02]]
grads:  [0.00426546 3.00314166]
Stock Position:  0.0042654585637998425
Bond Position:  [5.51295844]


portfolio before change:  [5.92844995]
curr_Stock_Price:  95.79181157318291
curr_Factors:  [9.57918116e+01 4.24046785e-02]
mat_Sqrt:  [[ 1.97258277e+01 -8.22908439e-03]
 [-8.22908439e-03  1.88766775e-02]]
grads:  [0.000775   0.51344255]
Stock Position:  0.0007749964367446077
Bond Position:  [5.85421164]


portfolio before change:  [5.93346344]
curr_Stock_Price:  92.81263841021172
curr_Factors:  [9.28126384e+01 4.25136183e-02]
mat_Sqrt:  [[ 1.91368791e+01 -8.23939524e-03]
 [-8.23939524e-03  1.89010198e-02]]
grads:  [0.00750915 1.14327289]
Stock Position:  0.007509153299997539
Bond Position:  [5.23651911]


portfolio before change:  [5.91928733]
curr_Stock_Price:  90.05256059271704
curr_Factors:  [9.00525606e+01 4.40756202e-02]
mat_Sqrt:  [[ 1.89058078e+01 -8.38913887e-03]
 [-8.38913887e-03  1.92452215e-02]]
grads:  [-4.81884649e-03 -1.15557945e+01]
Stock Position:  -0.004818846486290492
Bond Position:  [6.3532368]


portfolio before change:  [5.92310661]
curr_Stock_Price:  90.90903913696101
curr_Factors:  [9.09090391e+01 4.45957200e-02]
mat_Sqrt:  [[ 1.91978952e+01 -8.43857119e-03]
 [-8.43857119e-03  1.93584017e-02]]
grads:  [ -0.01499595 -12.29423973]
Stock Position:  -0.01499594988480172
Bond Position:  [7.286374]


portfolio before change:  [6.02885424]
curr_Stock_Price:  84.46503451856016
curr_Factors:  [8.44650345e+01 5.06315399e-02]
mat_Sqrt:  [[ 1.90058581e+01 -8.99082451e-03]
 [-8.99082451e-03  2.06271780e-02]]
grads:  [ 0.00158622 -0.42156383]
Stock Position:  0.001586215586682414
Bond Position:  [5.89487448]


portfolio before change:  [6.03083732]
curr_Stock_Price:  81.0669315810562
curr_Factors:  [8.10669316e+01 5.35698212e-02]
mat_Sqrt:  [[ 1.87630649e+01 -9.24760595e-03]
 [-9.24760595e-03  2.12174456e-02]]
grads:  [ -0.01984896 -10.15728402]
Stock Position:  -0.019848960835157314
Bond Position:  [7.63993167]


portfolio before change:  [5.99465074]
curr_Stock_Price:  83.37145850970026
curr_Factors:  [8.33714585e+01 4.63636805e-02]
mat_Sqrt:  [[ 1.79517297e+01 -8.60343197e-03]
 [-8.60343197e-03  1.97387376e-02]]
grads:  [1.58959561e-02 2.24874620e+01]
Stock Position:  0.01589595606483816
Bond Position:  [4.66938169]


portfolio before change:  [6.03290775]
curr_Stock_Price:  85.41075966808553
curr_Factors:  [8.54107597e+01 4.94819520e-02]
mat_Sqrt:  [[ 1.89992278e+01 -8.88827695e-03]
 [-8.88827695e-03  2.03916172e-02]]
grads:  [ 2.15489704e-04 -4.62014656e+00]
Stock Position:  0.00021548970364601892
Bond Position:  [6.01450262]


portfolio before change:  [6.0401962]
curr_Stock_Price:  84.32308231535407
curr_Factors:  [8.43230823e+01 4.91207416e-02]
mat_Sqrt:  [[ 1.86886909e+01 -8.85565356e-03]
 [-8.85565356e-03  2.03171065e-02]]
grads:  [-1.04520616e-03 -5.42708273e+00]
Stock Position:  -0.0010452061561835944
Bond Position:  [6.12833121]


portfolio before change:  [6.05121865]
curr_Stock_Price:  81.11104404197015
curr_Factors:  [8.11110440e+01 5.77577089e-02]
mat_Sqrt:  [[ 1.94932798e+01 -9.60228215e-03]
 [-9.60228215e-03  2.20311885e-02]]
grads:  [-0.01266174 -4.5788748 ]
Stock Position:  -0.01266173797572729
Bond Position:  [7.07822543]


portfolio before change:  [6.08755404]
curr_Stock_Price:  78.94056153728513
curr_Factors:  [7.89405615e+01 6.01640820e-02]
mat_Sqrt:  [[ 1.93628287e+01 -9.79996786e-03]
 [-9.79996786e-03  2.24855832e-02]]
grads:  [3.45970305e-03 6.31788564e+00]
Stock Position:  0.0034597030473304756
Bond Position:  [5.81444314]


portfolio before change:  [6.08708447]
curr_Stock_Price:  76.70274824472939
curr_Factors:  [7.67027482e+01 6.21165786e-02]
mat_Sqrt:  [[ 1.91167750e+01 -9.95737975e-03]
 [-9.95737975e-03  2.28476777e-02]]
grads:  [1.91385373e-03 1.28906026e+01]
Stock Position:  0.0019138537304535946
Bond Position:  [5.94028663]


portfolio before change:  [6.08881431]
curr_Stock_Price:  73.72438019500203
curr_Factors:  [7.37243802e+01 6.89082715e-02]
mat_Sqrt:  [[ 1.93529308e+01 -1.04871153e-02]
 [-1.04871153e-02  2.40645617e-02]]
grads:  [-0.01322018  6.59715949]
Stock Position:  -0.013220179812240882
Bond Position:  [7.06346387]


portfolio before change:  [6.0680206]
curr_Stock_Price:  75.96554210384201
curr_Factors:  [7.59655421e+01 6.65754093e-02]
mat_Sqrt:  [[ 1.96007868e+01 -1.03084460e-02]
 [-1.03084460e-02  2.36535417e-02]]
grads:  [-2.25189544e-04  1.30006499e+01]
Stock Position:  -0.00022518954407802503
Bond Position:  [6.08512724]


portfolio before change:  [6.07643183]
curr_Stock_Price:  72.41267438473277
curr_Factors:  [7.24126744e+01 6.38555495e-02]
mat_Sqrt:  [[ 1.82984307e+01 -1.00950835e-02]
 [-1.00950835e-02  2.31655948e-02]]
grads:  [-8.83687644e-03 -8.95714534e+00]
Stock Position:  -0.008836876438928928
Bond Position:  [6.71633369]


portfolio before change:  [6.10209592]
curr_Stock_Price:  70.45910875108665
curr_Factors:  [7.04591088e+01 6.15472107e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.10209592]
Stock Price:  64.33548587026421
PL:  [6.10209592]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 9.98197462e-02 -2.15716137e-02]
 [-3.19189235e-02  6.38028070e-02]
 [ 4.58884797e-02  1.05920669e-01]
 [-3.99797112e-01 -2.09751431e-01]
 [ 1.60385770e-02  1.58340368e-02]
 [ 3.53374415e-02 -1.11701943e-01]
 [-2.90584825e-01 -3.29016247e-01]
 [ 3.19054543e-02 -1.75300421e-02]
 [-1.88710473e-02 -2.02467761e-02]
 [ 4.20265959e-02  1.04737764e-01]
 [ 5.96875794e-02 -1.13405165e-01]
 [-7.01055993e-03  1.65320626e-02]
 [-9.84775024e-02 -1.39251774e-01]
 [ 5.07968615e-03  1.65665280e-01]
 [-6.81265628e-02 -6.62548810e-02]
 [ 4.96007568e-02 -3.53159104e-02]
 [-3.42409845e-03 -6.30790048e-02]
 [ 3.31806191e-02  4.62000588e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.50951]
curr_Stock_Price:  98.69014937684605
curr_Factors:  [9.86901494e+01 4.17568427e-02]
mat_Sqrt:  [[ 2.01668282e+01 -8.16621198e-03]
 [-8.16621198e-03  1.87318288e-02]]
grads:  [ 0.00448417 -1.14964723]
Stock Position:  0.00448416987345805
Bond Position:  [1.06696661]


portfolio before change:  [1.49771282]
curr_Stock_Price:  95.76168742473577
curr_Factors:  [9.57616874e+01 4.49863619e-02]
mat_Sqrt:  [[ 2.03110413e+01 -8.47588264e-03]
 [-8.47588264e-03  1.94428144e-02]]
grads:  [-2.02133085e-04  3.28147419e+00]
Stock Position:  -0.00020213308454365906
Bond Position:  [1.51706943]


portfolio before change:  [1.50015322]
curr_Stock_Price:  93.07596498763914
curr_Factors:  [9.30759650e+01 4.96131857e-02]
mat_Sqrt:  [[ 2.07317548e+01 -8.90084157e-03]
 [-8.90084157e-03  2.04182976e-02]]
grads:  [4.44145498e-03 5.18947290e+00]
Stock Position:  0.004441454978665916
Bond Position:  [1.08676051]


portfolio before change:  [1.49401935]
curr_Stock_Price:  91.38886716073092
curr_Factors:  [9.13888672e+01 4.97981790e-02]
mat_Sqrt:  [[ 2.03938858e+01 -8.91725850e-03]
 [-8.91725850e-03  2.04563997e-02]]
grads:  [ -0.02409176 -10.26408686]
Stock Position:  -0.02409176122393896
Bond Position:  [3.69573812]


portfolio before change:  [1.44630548]
curr_Stock_Price:  93.5612458953213
curr_Factors:  [9.35612459e+01 4.75116557e-02]
mat_Sqrt:  [[ 2.03937006e+01 -8.71033409e-03]
 [-8.71033409e-03  1.99811571e-02]]
grads:  [0.00112512 0.79293891]
Stock Position:  0.0011251189892177197
Bond Position:  [1.34103795]


portfolio before change:  [1.44671454]
curr_Stock_Price:  92.43399433847331
curr_Factors:  [9.24339943e+01 4.09619213e-02]
mat_Sqrt:  [[ 1.87077621e+01 -8.08760078e-03]
 [-8.08760078e-03  1.85528954e-02]]
grads:  [-7.14052447e-04 -6.02103964e+00]
Stock Position:  -0.0007140524469544211
Bond Position:  [1.51271726]


portfolio before change:  [1.45148863]
curr_Stock_Price:  88.39785052094385
curr_Factors:  [8.83978505e+01 3.31464568e-02]
mat_Sqrt:  [[ 1.60938599e+01 -7.27492392e-03]
 [-7.27492392e-03  1.66895192e-02]]
grads:  [ -0.02697226 -19.72570121]
Stock Position:  -0.026972261728010472
Bond Position:  [3.83577859]


portfolio before change:  [1.33737486]
curr_Stock_Price:  92.80650909410645
curr_Factors:  [9.28065091e+01 2.90943482e-02]
mat_Sqrt:  [[ 1.58300655e+01 -6.81609429e-03]
 [-6.81609429e-03  1.56359950e-02]]
grads:  [ 0.00153305 -1.12046548]
Stock Position:  0.001533048352353386
Bond Position:  [1.195098]


portfolio before change:  [1.34263944]
curr_Stock_Price:  95.26551324862197
curr_Factors:  [9.52655132e+01 2.79114044e-02]
mat_Sqrt:  [[ 1.59157283e+01 -6.67625904e-03]
 [-6.67625904e-03  1.53147514e-02]]
grads:  [-0.00174057 -1.32280284]
Stock Position:  -0.0017405688944833065
Bond Position:  [1.50845563]


portfolio before change:  [1.34455428]
curr_Stock_Price:  95.24937465360176
curr_Factors:  [9.52493747e+01 2.95201122e-02]
mat_Sqrt:  [[ 1.63651917e+01 -6.86595996e-03]
 [-6.86595996e-03  1.57499116e-02]]
grads:  [5.35903538e-03 6.65239030e+00]
Stock Position:  0.005359035380706845
Bond Position:  [0.83410951]


portfolio before change:  [1.35646329]
curr_Stock_Price:  97.27692561915805
curr_Factors:  [9.72769256e+01 3.03284032e-02]
mat_Sqrt:  [[ 1.69408256e+01 -6.95946316e-03]
 [-6.95946316e-03  1.59640191e-02]]
grads:  [ 6.05094216e-04 -7.10353410e+00]
Stock Position:  0.000605094215936732
Bond Position:  [1.29760158]


portfolio before change:  [1.35658656]
curr_Stock_Price:  94.79840058003064
curr_Factors:  [9.47984006e+01 3.70408519e-02]
mat_Sqrt:  [[ 1.82448986e+01 -7.69096369e-03]
 [-7.69096369e-03  1.76424941e-02]]
grads:  [1.07627334e-05 9.37063963e-01]
Stock Position:  1.0762733380647775e-05
Bond Position:  [1.35556627]


portfolio before change:  [1.35829371]
curr_Stock_Price:  95.87952863995324
curr_Factors:  [9.58795286e+01 3.96172234e-02]
mat_Sqrt:  [[ 1.90839324e+01 -7.95402636e-03]
 [-7.95402636e-03  1.82457036e-02]]
grads:  [-0.00834271 -7.63566787]
Stock Position:  -0.00834271482409787
Bond Position:  [2.15818928]


portfolio before change:  [1.3796852]
curr_Stock_Price:  93.63900334114254
curr_Factors:  [9.36390033e+01 4.33156492e-02]
mat_Sqrt:  [[ 1.94885334e+01 -8.31682373e-03]
 [-8.31682373e-03  1.90784416e-02]]
grads:  [3.96705971e-03 8.68510525e+00]
Stock Position:  0.003967059714419868
Bond Position:  [1.00821368]


portfolio before change:  [1.39696224]
curr_Stock_Price:  97.6762455300815
curr_Factors:  [9.76762455e+01 3.66601043e-02]
mat_Sqrt:  [[ 1.87019017e+01 -7.65155118e-03]
 [-7.65155118e-03  1.75514902e-02]]
grads:  [-0.00518811 -3.77714812]
Stock Position:  -0.005188114370346345
Bond Position:  [1.90371777]


portfolio before change:  [1.40487851]
curr_Stock_Price:  96.60935728306238
curr_Factors:  [9.66093573e+01 3.89888654e-02]
mat_Sqrt:  [[ 1.90760940e+01 -7.89075285e-03]
 [-7.89075285e-03  1.81004053e-02]]
grads:  [ 1.79340628e-03 -1.95032975e+00]
Stock Position:  0.0017934062788496016
Bond Position:  [1.23161868]


portfolio before change:  [1.4102051]
curr_Stock_Price:  98.72048079208696
curr_Factors:  [9.87204808e+01 4.06608918e-02]
mat_Sqrt:  [[ 1.99065352e+01 -8.05833646e-03]
 [-8.05833646e-03  1.84843753e-02]]
grads:  [-1.55371579e-03 -3.41323545e+00]
Stock Position:  -0.001553715790781292
Bond Position:  [1.56358867]


portfolio before change:  [1.40853513]
curr_Stock_Price:  101.05403093770038
curr_Factors:  [1.01054031e+02 4.41361745e-02]
mat_Sqrt:  [[ 2.12300468e+01 -8.39582918e-03]
 [-8.39582918e-03  1.92580320e-02]]
grads:  [0.00251207 2.40009725]
Stock Position:  0.002512072919604871
Bond Position:  [1.15468004]


portfolio before change:  [1.4162932]
curr_Stock_Price:  103.5674205982452
curr_Factors:  [1.03567421e+02 4.15926063e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.4162932]
Stock Price:  105.75538028387298
PL:  [-4.33908708]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 9.47946964e-03 -4.88353351e-02]
 [-3.21513862e-02 -1.30471337e-01]
 [ 5.91432400e-02  6.65243750e-02]
 [-6.14015127e-02 -3.06276959e-02]
 [ 4.46762988e-01  4.17218970e-02]
 [-4.42605364e-02 -4.10482344e-01]
 [-4.18827594e-01 -4.25787129e-01]
 [ 3.43192440e-02 -7.05345982e-03]
 [-3.09648606e-01 -2.38647354e-01]
 [ 1.03169245e-01  4.92102458e-01]
 [-1.55471988e-01 -2.57091886e-02]
 [ 4.29184933e-02 -1.64998511e-01]
 [-2.16405298e-01 -9.45349002e-02]
 [-2.50100623e-03  1.55696396e-01]
 [-1.03683726e-01  9.48643405e-02]
 [-9.78983308e-02  3.81686152e-02]
 [-9.06671717e-02  1.57152954e-01]
 [ 3.48845833e-02 -1.52324439e-01]
 [ 3.68342879e-02  5.74103943e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.02763972]
curr_Stock_Price:  103.1052120962411
curr_Factors:  [1.03105212e+02 4.07097165e-02]
mat_Sqrt:  [[ 2.08031752e+01 -8.06349126e-03]
 [-8.06349126e-03  1.84953311e-02]]
grads:  [-5.67869255e-04 -2.64066179e+00]
Stock Position:  -0.0005678692546030126
Bond Position:  [18.08619]


portfolio before change:  [18.04915956]
curr_Stock_Price:  105.04585605611736
curr_Factors:  [1.05045856e+02 4.43640955e-02]
mat_Sqrt:  [[ 2.21255823e+01 -8.41776938e-03]
 [-8.41776938e-03  1.93075662e-02]]
grads:  [-4.02472721e-03 -6.75927842e+00]
Stock Position:  -0.004024727210032222
Bond Position:  [18.47194047]


portfolio before change:  [18.10524431]
curr_Stock_Price:  96.85141415779051
curr_Factors:  [9.68514142e+01 4.44048204e-02]
mat_Sqrt:  [[ 2.04089654e+01 -8.42101092e-03]
 [-8.42101092e-03  1.93166969e-02]]
grads:  [0.00431967 3.44576256]
Stock Position:  0.0043196723871938725
Bond Position:  [17.68687793]


portfolio before change:  [18.1195207]
curr_Stock_Price:  95.03506448309632
curr_Factors:  [9.50350645e+01 4.68076933e-02]
mat_Sqrt:  [[ 2.05609158e+01 -8.64569563e-03]
 [-8.64569563e-03  1.98325208e-02]]
grads:  [-0.00363636 -1.54590206]
Stock Position:  -0.0036363609533318704
Bond Position:  [18.4651025]


portfolio before change:  [18.16055491]
curr_Stock_Price:  90.10200142208907
curr_Factors:  [9.01020014e+01 4.58214381e-02]
mat_Sqrt:  [[ 1.92871809e+01 -8.55367544e-03]
 [-8.55367544e-03  1.96226659e-02]]
grads:  [0.02411134 2.13671974]
Stock Position:  0.02411134102043346
Bond Position:  [15.98807482]


portfolio before change:  [18.08181773]
curr_Stock_Price:  86.00705016998788
curr_Factors:  [8.60070502e+01 4.86617498e-02]
mat_Sqrt:  [[ 1.89726444e+01 -8.81436956e-03]
 [-8.81436956e-03  2.02218789e-02]]
grads:  [-1.17657790e-02 -2.03040506e+01]
Stock Position:  -0.011765779049283824
Bond Position:  [19.09375768]


portfolio before change:  [18.11062938]
curr_Stock_Price:  85.58807860519975
curr_Factors:  [8.55880786e+01 4.46478053e-02]
mat_Sqrt:  [[ 1.80847824e+01 -8.44296889e-03]
 [-8.44296889e-03  1.93699336e-02]]
grads:  [ -0.03342826 -21.99642862]
Stock Position:  -0.03342825714023252
Bond Position:  [20.97168968]


portfolio before change:  [18.2305236]
curr_Stock_Price:  82.7861610082719
curr_Factors:  [8.27861610e+01 4.00865282e-02]
mat_Sqrt:  [[ 1.65751289e+01 -7.99979074e-03]
 [-7.99979074e-03  1.83539813e-02]]
grads:  [ 0.00188544 -0.38347956]
Stock Position:  0.0018854446253854314
Bond Position:  [18.07443488]


portfolio before change:  [18.24676478]
curr_Stock_Price:  79.40977502412831
curr_Factors:  [7.9409775e+01 4.1694208e-02]
mat_Sqrt:  [[ 1.62148067e+01 -8.15824690e-03]
 [-8.15824690e-03  1.87185760e-02]]
grads:  [ -0.02551684 -12.76034709]
Stock Position:  -0.025516842509485108
Bond Position:  [20.27305151]


portfolio before change:  [18.22265943]
curr_Stock_Price:  81.34820105522921
curr_Factors:  [8.13482011e+01 4.22219678e-02]
mat_Sqrt:  [[ 1.67154139e+01 -8.20994312e-03]
 [-8.20994312e-03  1.88365738e-02]]
grads:  [1.90076479e-02 2.61331235e+01]
Stock Position:  0.01900764790954983
Bond Position:  [16.67642147]


portfolio before change:  [18.19585325]
curr_Stock_Price:  78.84054002728777
curr_Factors:  [7.88405400e+01 4.17999352e-02]
mat_Sqrt:  [[ 1.61189719e+01 -8.16851610e-03]
 [-8.16851610e-03  1.87423237e-02]]
grads:  [-0.0103427 -1.376226 ]
Stock Position:  -0.01034270132388184
Bond Position:  [19.01127741]


portfolio before change:  [18.20863535]
curr_Stock_Price:  79.90378831615844
curr_Factors:  [7.99037883e+01 4.39563984e-02]
mat_Sqrt:  [[ 1.67524514e+01 -8.37670318e-03]
 [-8.37670318e-03  1.92196469e-02]]
grads:  [-1.73114267e-03 -8.58564225e+00]
Stock Position:  -0.001731142669441666
Bond Position:  [18.34696021]


portfolio before change:  [18.23279617]
curr_Stock_Price:  79.203222749555
curr_Factors:  [7.92032227e+01 4.27566889e-02]
mat_Sqrt:  [[ 1.63773953e+01 -8.26151522e-03]
 [-8.26151522e-03  1.89555864e-02]]
grads:  [-0.01573288 -4.99403583]
Stock Position:  -0.015732880379237476
Bond Position:  [19.478891]


portfolio before change:  [18.13442585]
curr_Stock_Price:  87.00434688121706
curr_Factors:  [8.70043469e+01 4.11478459e-02]
mat_Sqrt:  [[ 1.76487706e+01 -8.10543350e-03]
 [-8.10543350e-03  1.85951716e-02]]
grads:  [3.70441958e-03 8.37456226e+00]
Stock Position:  0.003704419579456527
Bond Position:  [17.81212525]


portfolio before change:  [18.158484]
curr_Stock_Price:  87.48460209744128
curr_Factors:  [8.74846021e+01 4.46722650e-02]
mat_Sqrt:  [[ 1.84905812e+01 -8.44547713e-03]
 [-8.44547713e-03  1.93751533e-02]]
grads:  [-3.37174464e-03  4.89471557e+00]
Stock Position:  -0.0033717446376802093
Bond Position:  [18.45345974]


portfolio before change:  [18.17736552]
curr_Stock_Price:  88.73016689228882
curr_Factors:  [8.87301669e+01 4.02021838e-02]
mat_Sqrt:  [[ 1.77908246e+01 -8.01191638e-03]
 [-8.01191638e-03  1.83801805e-02]]
grads:  [-0.00456846  2.0746267 ]
Stock Position:  -0.00456845577123912
Bond Position:  [18.58272536]


portfolio before change:  [18.21057072]
curr_Stock_Price:  86.54950153345436
curr_Factors:  [8.65495015e+01 3.25902810e-02]
mat_Sqrt:  [[ 1.56245881e+01 -7.21347192e-03]
 [-7.21347192e-03  1.65489768e-02]]
grads:  [-1.41896971e-03  9.49561534e+00]
Stock Position:  -0.001418969705353679
Bond Position:  [18.33338184]


portfolio before change:  [18.23999488]
curr_Stock_Price:  81.97357304090589
curr_Factors:  [8.19735730e+01 3.41274245e-02]
mat_Sqrt:  [[ 1.51434759e+01 -7.38119027e-03]
 [-7.38119027e-03  1.69349424e-02]]
grads:  [-2.08100032e-03 -8.99559003e+00]
Stock Position:  -0.002081000321282613
Bond Position:  [18.41058191]


portfolio before change:  [18.25694092]
curr_Stock_Price:  84.89600456481963
curr_Factors:  [8.48960046e+01 3.39799204e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.25694092]
Stock Price:  81.7873040872542
PL:  [18.25694092]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 8.73227118e-02 -2.58957141e-02]
 [-2.70523143e-01  9.84810966e-02]
 [ 2.31173994e-02  7.75541388e-02]
 [-8.94148557e-01 -4.46907540e-01]
 [ 5.67112829e-01  5.89897333e-02]
 [-1.97438547e-02 -3.21896799e-01]
 [-3.96327075e-01 -4.09071639e-01]
 [ 3.39099101e-02 -8.83009350e-03]
 [-2.34537601e-01 -1.82377852e-01]
 [ 9.84740138e-02  4.71966086e-01]
 [-5.57869715e-02 -7.11634031e-02]
 [ 3.17621164e-02 -1.22560226e-01]
 [-1.82848188e-01 -1.09938158e-01]
 [-4.30441578e-03  1.51016209e-01]
 [-1.06436984e-01  1.52498223e-01]
 [-9.90719861e-02  3.87924387e-02]
 [-7.66992949e-02  1.13181442e-01]
 [ 7.04241152e-02 -1.34120427e-01]
 [ 2.71929577e-02  5.73117487e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.95616654]
curr_Stock_Price:  98.80953435802591
curr_Factors:  [9.88095344e+01 3.76932257e-02]
mat_Sqrt:  [[ 1.91836159e+01 -7.75870004e-03]
 [-7.75870004e-03  1.77970456e-02]]
grads:  [ 0.00396415 -1.45332872]
Stock Position:  0.003964152050345514
Bond Position:  [1.56447052]


portfolio before change:  [1.92006889]
curr_Stock_Price:  89.20988951811498
curr_Factors:  [8.92098895e+01 3.82657916e-02]
mat_Sqrt:  [[ 1.74509192e+01 -7.81662625e-03]
 [-7.81662625e-03  1.79320459e-02]]
grads:  [-0.01304455  5.48621908]
Stock Position:  -0.013044551755905305
Bond Position:  [3.08377192]


portfolio before change:  [1.96711958]
curr_Stock_Price:  85.89865581985583
curr_Factors:  [8.58986558e+01 4.04237041e-02]
mat_Sqrt:  [[ 1.72704786e+01 -8.03368620e-03]
 [-8.03368620e-03  1.84308689e-02]]
grads:  [3.29657370e-03 4.20927646e+00]
Stock Position:  0.003296573701882478
Bond Position:  [1.68394833]


portfolio before change:  [1.9678153]
curr_Stock_Price:  85.47077652922995
curr_Factors:  [8.54707765e+01 3.61581711e-02]
mat_Sqrt:  [[ 1.62525245e+01 -7.59797256e-03]
 [-7.59797256e-03  1.74313661e-02]]
grads:  [ -0.06701533 -25.66733543]
Stock Position:  -0.06701532835441543
Bond Position:  [7.69566745]


portfolio before change:  [1.82802794]
curr_Stock_Price:  87.7003105356791
curr_Factors:  [8.77003105e+01 3.48538294e-02]
mat_Sqrt:  [[ 1.63729274e+01 -7.45987539e-03]
 [-7.45987539e-03  1.71139871e-02]]
grads:  [0.03621489 3.46265845]
Stock Position:  0.03621489387397
Bond Position:  [-1.3480295]


portfolio before change:  [1.83612825]
curr_Stock_Price:  87.9705418756882
curr_Factors:  [8.79705419e+01 3.42736821e-02]
mat_Sqrt:  [[ 1.62861190e+01 -7.39755320e-03]
 [-7.39755320e-03  1.69709466e-02]]
grads:  [-9.82976993e-03 -1.89718066e+01]
Stock Position:  -0.00982976993051622
Bond Position:  [2.70085844]


portfolio before change:  [1.85809104]
curr_Stock_Price:  86.07989668831408
curr_Factors:  [8.60798967e+01 3.46428492e-02]
mat_Sqrt:  [[ 1.60216962e+01 -7.43711654e-03]
 [-7.43711654e-03  1.70621742e-02]]
grads:  [ -0.03587328 -23.99098894]
Stock Position:  -0.035873283936029864
Bond Position:  [4.94605962]


portfolio before change:  [1.9219562]
curr_Stock_Price:  84.47205061664012
curr_Factors:  [8.44720506e+01 3.64846214e-02]
mat_Sqrt:  [[ 1.61349606e+01 -7.63209758e-03]
 [-7.63209758e-03  1.75099201e-02]]
grads:  [ 0.00186349 -0.50347866]
Stock Position:  0.0018634883874687816
Bond Position:  [1.76454351]


portfolio before change:  [1.92215617]
curr_Stock_Price:  83.39499070305106
curr_Factors:  [8.33949907e+01 3.93320245e-02]
mat_Sqrt:  [[ 1.65391454e+01 -7.92421157e-03]
 [-7.92421157e-03  1.81804047e-02]]
grads:  [ -0.01899103 -10.03983927]
Stock Position:  -0.01899103030296736
Bond Position:  [3.50591297]


portfolio before change:  [1.94944099]
curr_Stock_Price:  82.18917461493626
curr_Factors:  [8.21891746e+01 4.18313998e-02]
mat_Sqrt:  [[ 1.68099246e+01 -8.17197660e-03]
 [-8.17197660e-03  1.87492079e-02]]
grads:  [1.80993245e-02 2.51804768e+01]
Stock Position:  0.018099324481088
Bond Position:  [0.46187245]


portfolio before change:  [1.95630657]
curr_Stock_Price:  82.53658428629564
curr_Factors:  [8.25365843e+01 3.91726802e-02]
mat_Sqrt:  [[ 1.63357126e+01 -7.90805345e-03]
 [-7.90805345e-03  1.81435799e-02]]
grads:  [-0.00531489 -3.92455259]
Stock Position:  -0.00531489168263787
Bond Position:  [2.39497958]


portfolio before change:  [1.95514262]
curr_Stock_Price:  83.31920603414977
curr_Factors:  [8.33192060e+01 4.09587548e-02]
mat_Sqrt:  [[ 1.68623634e+01 -8.08641174e-03]
 [-8.08641174e-03  1.85525603e-02]]
grads:  [-1.28464346e-03 -6.60666844e+00]
Stock Position:  -0.0012846434550718648
Bond Position:  [2.06217809]


portfolio before change:  [1.95702413]
curr_Stock_Price:  83.86241376578776
curr_Factors:  [8.38624138e+01 3.44833540e-02]
mat_Sqrt:  [[ 1.55729920e+01 -7.41976789e-03]
 [-7.41976789e-03  1.70229429e-02]]
grads:  [-0.01482148 -6.4646948 ]
Stock Position:  -0.014821475778973307
Bond Position:  [3.19998886]


portfolio before change:  [1.95028651]
curr_Stock_Price:  84.58704500207271
curr_Factors:  [8.45870450e+01 3.34027284e-02]
mat_Sqrt:  [[ 1.54594762e+01 -7.30265196e-03]
 [-7.30265196e-03  1.67540609e-02]]
grads:  [3.98022696e-03 9.01544263e+00]
Stock Position:  0.00398022695844694
Bond Position:  [1.61361087]


portfolio before change:  [1.95213636]
curr_Stock_Price:  84.54473031736433
curr_Factors:  [8.45447303e+01 3.85586279e-02]
mat_Sqrt:  [[ 1.66014981e+01 -7.84603394e-03]
 [-7.84603394e-03  1.80007230e-02]]
grads:  [-2.40793455e-03  8.47073362e+00]
Stock Position:  -0.002407934549714562
Bond Position:  [2.15571454]


portfolio before change:  [1.94494338]
curr_Stock_Price:  88.65169853985701
curr_Factors:  [8.86516985e+01 4.10513999e-02]
mat_Sqrt:  [[ 1.79618474e+01 -8.09608715e-03]
 [-8.09608715e-03  1.85732973e-02]]
grads:  [-0.00457517  2.08661914]
Stock Position:  -0.004575171684919282
Bond Position:  [2.35054012]


portfolio before change:  [1.94339421]
curr_Stock_Price:  89.63290247764164
curr_Factors:  [8.96329025e+01 4.31146774e-02]
mat_Sqrt:  [[ 1.86114404e+01 -8.29714482e-03]
 [-8.29714482e-03  1.90342891e-02]]
grads:  [-1.47050623e-03  5.94554596e+00]
Stock Position:  -0.0014705062265142044
Bond Position:  [2.07519996]


portfolio before change:  [1.95259459]
curr_Stock_Price:  85.14142086174404
curr_Factors:  [8.51414209e+01 3.92678752e-02]
mat_Sqrt:  [[ 1.68717273e+01 -7.91792520e-03]
 [-7.91792520e-03  1.81654951e-02]]
grads:  [ 7.09265054e-04 -7.38294277e+00]
Stock Position:  0.000709265053931199
Bond Position:  [1.89220675]


portfolio before change:  [1.95429472]
curr_Stock_Price:  84.20157167672984
curr_Factors:  [8.42015717e+01 3.86240086e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.95429472]
Stock Price:  84.16561642522063
PL:  [1.95429472]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.47516893e-01 -8.91533967e-03]
 [ 2.66088198e-02 -5.42693111e-02]
 [ 6.85939027e-02  3.84239234e-02]
 [ 2.41138325e-02  2.32214397e-02]
 [-6.01353824e-02  1.16356477e-02]
 [ 1.14307242e-01  8.96622499e-02]
 [ 4.12686813e-02  6.39841823e-02]
 [-1.30679116e-01  4.09421709e-02]
 [ 8.19007684e-02  7.43127778e-02]
 [ 6.21314398e-02 -4.43532695e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [-1.03184727e-02  3.66506872e-02]
 [-4.24360941e-04 -4.85478303e-02]
 [ 1.34716441e-02 -6.58620670e-02]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.57259077e-01 -8.80803632e-02]
 [ 4.74964761e-02 -1.48331916e-01]
 [-1.02794947e-01  4.42663563e-02]
 [-1.03037283e-01 -1.09205616e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.84813391]
curr_Stock_Price:  95.65441160875552
curr_Factors:  [9.56544116e+01 4.05045492e-02]
mat_Sqrt:  [[ 1.92511584e+01 -8.04259008e-03]
 [-8.04259008e-03  1.84489088e-02]]
grads:  [ 0.00746223 -0.47999175]
Stock Position:  0.007462227112848791
Bond Position:  [-10.56192885]


portfolio before change:  [-9.82978789]
curr_Stock_Price:  99.88326775466386
curr_Factors:  [9.98832678e+01 4.35605105e-02]
mat_Sqrt:  [[ 2.08467898e+01 -8.34080786e-03]
 [-8.34080786e-03  1.91320681e-02]]
grads:  [ 1.41513860e-04 -2.83650103e+00]
Stock Position:  0.00014151386018303267
Bond Position:  [-9.84392276]


portfolio before change:  [-9.8421456]
curr_Stock_Price:  99.56451669191644
curr_Factors:  [9.95645167e+01 4.54612120e-02]
mat_Sqrt:  [[ 2.12287811e+01 -8.52080971e-03]
 [-8.52080971e-03  1.95450229e-02]]
grads:  [0.00402096 1.96767153]
Stock Position:  0.0040209589437144215
Bond Position:  [-10.24249043]


portfolio before change:  [-9.86484957]
curr_Stock_Price:  97.10419322628415
curr_Factors:  [9.71041932e+01 4.63836086e-02]
mat_Sqrt:  [[ 2.09131867e+01 -8.60661759e-03]
 [-8.60661759e-03  1.97423965e-02]]
grads:  [0.0016374  1.17693575]
Stock Position:  0.0016374007897469063
Bond Position:  [-10.02384806]


portfolio before change:  [-9.88223869]
curr_Stock_Price:  94.14128335025232
curr_Factors:  [9.41412834e+01 4.76897440e-02]
mat_Sqrt:  [[ 2.05585543e+01 -8.72669595e-03]
 [-8.72669595e-03  2.00185468e-02]]
grads:  [-0.00267885  0.58007558]
Stock Position:  -0.002678847861937411
Bond Position:  [-9.63004851]


portfolio before change:  [-9.9044585]
curr_Stock_Price:  97.9394538661369
curr_Factors:  [9.79394539e+01 4.33420807e-02]
mat_Sqrt:  [[ 2.03897791e+01 -8.31971811e-03]
 [-8.31971811e-03  1.90841059e-02]]
grads:  [0.0075245  4.70154862]
Stock Position:  0.0075244955272247395
Bond Position:  [-10.64140348]


portfolio before change:  [-9.87472619]
curr_Stock_Price:  103.6597548231744
curr_Factors:  [1.03659755e+02 4.03115276e-02]
mat_Sqrt:  [[ 2.08125250e+01 -8.02399726e-03]
 [-8.02399726e-03  1.84046392e-02]]
grads:  [3.32376457e-03 3.47797376e+00]
Stock Position:  0.003323764569931509
Bond Position:  [-10.21926681]


portfolio before change:  [-9.8586601]
curr_Stock_Price:  112.3391179550154
curr_Factors:  [1.12339118e+02 3.95955532e-02]
mat_Sqrt:  [[ 2.23539456e+01 -7.95296366e-03]
 [-7.95296366e-03  1.82402276e-02]]
grads:  [-0.00504812  2.24240752]
Stock Position:  -0.0050481168926791225
Bond Position:  [-9.2915591]


portfolio before change:  [-9.82859351]
curr_Stock_Price:  104.08092946251115
curr_Factors:  [1.04080929e+02 4.27746067e-02]
mat_Sqrt:  [[ 2.15260400e+01 -8.26553006e-03]
 [-8.26553006e-03  1.89585622e-02]]
grads:  [0.00531072 3.92206291]
Stock Position:  0.005310716575904177
Bond Position:  [-10.38133783]


portfolio before change:  [-9.83655686]
curr_Stock_Price:  105.02645824966964
curr_Factors:  [1.05026458e+02 4.51290111e-02]
mat_Sqrt:  [[ 2.23113885e+01 -8.49002651e-03]
 [-8.49002651e-03  1.94733038e-02]]
grads:  [ 1.91836003e-03 -2.27680844e+00]
Stock Position:  0.0019183600294859144
Bond Position:  [-10.03803542]


portfolio before change:  [-9.84956011]
curr_Stock_Price:  104.7930000809929
curr_Factors:  [1.04793000e+02 4.71732795e-02]
mat_Sqrt:  [[ 2.27604203e+01 -8.68017195e-03]
 [-8.68017195e-03  1.99094804e-02]]
grads:  [ 4.21901912e-04 -6.14522530e+00]
Stock Position:  0.00042190191230388887
Bond Position:  [-9.89377248]


portfolio before change:  [-9.86311135]
curr_Stock_Price:  102.00493552804184
curr_Factors:  [1.02004936e+02 5.23064911e-02]
mat_Sqrt:  [[ 2.33291516e+01 -9.14003193e-03]
 [-9.14003193e-03  2.09648450e-02]]
grads:  [2.42660952e-04 1.74830318e+00]
Stock Position:  0.0002426609517666765
Bond Position:  [-9.88786396]


portfolio before change:  [-9.87520501]
curr_Stock_Price:  103.1336342393455
curr_Factors:  [1.03133634e+02 4.29862932e-02]
mat_Sqrt:  [[ 2.13828351e+01 -8.28589041e-03]
 [-8.28589041e-03  1.90054453e-02]]
grads:  [-1.00985801e-03 -2.55485715e+00]
Stock Position:  -0.001009858008417132
Bond Position:  [-9.77105469]


portfolio before change:  [-9.88917445]
curr_Stock_Price:  104.86454693049741
curr_Factors:  [1.04864547e+02 4.48090018e-02]
mat_Sqrt:  [[ 2.21978692e+01 -8.45986021e-03]
 [-8.45986021e-03  1.94041434e-02]]
grads:  [-6.86803523e-04 -3.39452640e+00]
Stock Position:  -0.0006868035231368126
Bond Position:  [-9.81715311]


portfolio before change:  [-9.90331232]
curr_Stock_Price:  107.57093615054583
curr_Factors:  [1.07570936e+02 3.95489252e-02]
mat_Sqrt:  [[ 2.13925355e+01 -7.94799231e-03]
 [-7.94799231e-03  1.82296097e-02]]
grads:  [-3.99421384e-03 -4.78037317e+00]
Stock Position:  -0.003994213835075428
Bond Position:  [-9.473651]


portfolio before change:  [-9.92660041]
curr_Stock_Price:  110.43473599036321
curr_Factors:  [1.10434736e+02 4.23441956e-02]
mat_Sqrt:  [[ 2.27249330e+01 -8.22425614e-03]
 [-8.22425614e-03  1.88627561e-02]]
grads:  [ 0.00523101 -4.66725762]
Stock Position:  0.005231010138436492
Bond Position:  [-10.50428564]


portfolio before change:  [-9.95395499]
curr_Stock_Price:  107.717095641897
curr_Factors:  [1.07717096e+02 4.42293711e-02]
mat_Sqrt:  [[ 2.26537439e+01 -8.40515989e-03]
 [-8.40515989e-03  1.92781482e-02]]
grads:  [-7.58291902e-04 -7.69463371e+00]
Stock Position:  -0.0007582919015760361
Bond Position:  [-9.87227398]


portfolio before change:  [-9.97482184]
curr_Stock_Price:  118.95128521835825
curr_Factors:  [1.18951285e+02 4.14442418e-02]
mat_Sqrt:  [[ 2.42159334e+01 -8.13687366e-03]
 [-8.13687366e-03  1.86610210e-02]]
grads:  [-0.00344837  2.37062578]
Stock Position:  -0.0034483685949306168
Bond Position:  [-9.56463396]


portfolio before change:  [-9.98409569]
curr_Stock_Price:  118.17137515405346
curr_Factors:  [1.18171375e+02 4.26919711e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.98409569]
Stock Price:  121.88072400032164
PL:  [-31.86481969]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 5.90845642e-02 -2.44129523e-02]
 [-9.42094591e-02 -1.60095329e-01]
 [-3.40424943e-01 -1.54197353e-01]
 [-2.42915297e-02 -2.96094628e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.27308795e-01  1.25092428e-01]
 [ 3.35385939e-02  5.39928862e-02]
 [-2.86244049e-01  4.82529369e-02]
 [ 5.32121092e-02  4.15175068e-02]
 [ 6.01080314e-02 -2.78158064e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 3.41701893e-01 -1.23458000e-02]
 [ 2.23007601e-02  1.87488983e-01]
 [-3.95374884e-02 -1.57319237e-01]
 [ 1.23346039e-02 -1.20078454e-01]
 [ 2.31387394e-01 -1.79133675e-01]
 [ 1.67349358e-01 -1.49876340e-01]
 [-1.21666889e-01  4.61975203e-02]
 [-1.14489215e-01 -1.32246685e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [24.61055785]
curr_Stock_Price:  104.86473311594196
curr_Factors:  [1.04864733e+02 4.11918257e-02]
mat_Sqrt:  [[ 2.12831029e+01 -8.11121800e-03]
 [-8.11121800e-03  1.86044726e-02]]
grads:  [ 0.00227641 -1.31121631]
Stock Position:  0.002276406924989662
Bond Position:  [24.37184304]


portfolio before change:  [24.64494615]
curr_Stock_Price:  106.57991526972481
curr_Factors:  [1.06579915e+02 3.90196043e-02]
mat_Sqrt:  [[ 2.10531348e+01 -7.89456288e-03]
 [-7.89456288e-03  1.81072339e-02]]
grads:  [-7.79153093e-03 -8.84490919e+00]
Stock Position:  -0.0077915309308766705
Bond Position:  [25.47536686]


portfolio before change:  [24.66215169]
curr_Stock_Price:  108.4612629345415
curr_Factors:  [1.08461263e+02 3.91407090e-02]
mat_Sqrt:  [[ 2.14579867e+01 -7.90692237e-03]
 [-7.90692237e-03  1.81352604e-02]]
grads:  [-0.01900085 -8.51091122]
Stock Position:  -0.0190008532980792
Bond Position:  [26.72300824]


portfolio before change:  [24.69564284]
curr_Stock_Price:  108.45776302518841
curr_Factors:  [1.08457763e+02 3.46074801e-02]
mat_Sqrt:  [[ 2.01764893e+01 -7.43495096e-03]
 [-7.43495096e-03  1.70527507e-02]]
grads:  [-0.00184408 -1.73714928]
Stock Position:  -0.0018440844081598154
Bond Position:  [24.89564811]


portfolio before change:  [24.72874873]
curr_Stock_Price:  107.39118002638887
curr_Factors:  [1.0739118e+02 3.5442928e-02]
mat_Sqrt:  [[ 2.02177760e+01 -7.52409504e-03]
 [-7.52409504e-03  1.72573832e-02]]
grads:  [ 0.00811051 -6.84048643]
Stock Position:  0.008110511830794403
Bond Position:  [23.85775129]


portfolio before change:  [24.71155535]
curr_Stock_Price:  101.59201275275323
curr_Factors:  [1.01592013e+02 3.38804000e-02]
mat_Sqrt:  [[ 1.86996637e+01 -7.35601487e-03]
 [-7.35601487e-03  1.68728493e-02]]
grads:  [0.00972618 7.41806977]
Stock Position:  0.009726176352313765
Bond Position:  [23.72345352]


portfolio before change:  [24.75080485]
curr_Stock_Price:  102.57663832156082
curr_Factors:  [1.02576638e+02 3.71015613e-02]
mat_Sqrt:  [[ 1.97580701e+01 -7.69782769e-03]
 [-7.69782769e-03  1.76567002e-02]]
grads:  [2.88933481e-03 3.05918588e+00]
Stock Position:  0.002889334807474295
Bond Position:  [24.4544266]


portfolio before change:  [24.79670824]
curr_Stock_Price:  107.87759532951395
curr_Factors:  [1.07877595e+02 3.51448956e-02]
mat_Sqrt:  [[ 2.02237811e+01 -7.49242278e-03]
 [-7.49242278e-03  1.71846605e-02]]
grads:  [-0.01311569  2.80218912]
Stock Position:  -0.013115690959949378
Bond Position:  [26.21159744]


portfolio before change:  [24.8109772]
curr_Stock_Price:  109.28934076172914
curr_Factors:  [1.09289341e+02 3.31995832e-02]
mat_Sqrt:  [[ 1.99133393e+01 -7.28219368e-03]
 [-7.28219368e-03  1.67022600e-02]]
grads:  [0.00358178 2.48730352]
Stock Position:  0.0035817767302799594
Bond Position:  [24.41952719]


portfolio before change:  [24.84111497]
curr_Stock_Price:  109.17606427370693
curr_Factors:  [1.09176064e+02 3.39919522e-02]
mat_Sqrt:  [[ 2.01286876e+01 -7.36857632e-03]
 [-7.36857632e-03  1.69004025e-02]]
grads:  [ 0.00238406 -1.64482706]
Stock Position:  0.00238405994072045
Bond Position:  [24.58083268]


portfolio before change:  [24.88948283]
curr_Stock_Price:  116.5679132292349
curr_Factors:  [1.16567913e+02 3.20960239e-02]
mat_Sqrt:  [[ 2.08835638e+01 -7.16051491e-03]
 [-7.16051491e-03  1.64221578e-02]]
grads:  [ 4.59543113e-04 -7.45021550e+00]
Stock Position:  0.000459543112680489
Bond Position:  [24.83591485]


portfolio before change:  [24.92169007]
curr_Stock_Price:  119.05502986918755
curr_Factors:  [1.19055030e+02 3.47311716e-02]
mat_Sqrt:  [[ 2.21874525e+01 -7.44878573e-03]
 [-7.44878573e-03  1.70829537e-02]]
grads:  [ 0.01516028 -0.71608661]
Stock Position:  0.015160276614048823
Bond Position:  [23.11678289]


portfolio before change:  [24.9872445]
curr_Stock_Price:  121.47189778255954
curr_Factors:  [1.21471898e+02 2.90493526e-02]
mat_Sqrt:  [[ 2.07035120e+01 -6.81240786e-03]
 [-6.81240786e-03  1.56232079e-02]]
grads:  [5.02664281e-03 1.20028632e+01]
Stock Position:  0.005026642809688474
Bond Position:  [24.37664866]


portfolio before change:  [24.99886134]
curr_Stock_Price:  117.71729898030323
curr_Factors:  [1.17717299e+02 2.99184356e-02]
mat_Sqrt:  [[ 2.03614970e+01 -6.91339559e-03]
 [-6.91339559e-03  1.58552615e-02]]
grads:  [-5.31147900e-03 -9.92452614e+00]
Stock Position:  -0.00531147900337056
Bond Position:  [25.6241143]


portfolio before change:  [25.02801282]
curr_Stock_Price:  118.26303985367994
curr_Factors:  [1.18263040e+02 3.20403807e-02]
mat_Sqrt:  [[ 2.11688783e+01 -7.15438588e-03]
 [-7.15438588e-03  1.64078813e-02]]
grads:  [-1.89096100e-03 -7.31916451e+00]
Stock Position:  -0.0018909609986166066
Bond Position:  [25.25164361]


portfolio before change:  [25.0524634]
curr_Stock_Price:  122.03557199265863
curr_Factors:  [1.22035572e+02 3.60746411e-02]
mat_Sqrt:  [[ 2.31786121e+01 -7.59162828e-03]
 [-7.59162828e-03  1.74101577e-02]]
grads:  [ 6.61380320e-03 -1.02861484e+01]
Stock Position:  0.006613803198092146
Bond Position:  [24.24534414]


portfolio before change:  [25.10138524]
curr_Stock_Price:  124.84729926124051
curr_Factors:  [1.24847299e+02 3.55257929e-02]
mat_Sqrt:  [[ 2.35315763e+01 -7.53378386e-03]
 [-7.53378386e-03  1.72771534e-02]]
grads:  [ 4.33499721e-03 -8.67293806e+00]
Stock Position:  0.004334997206295408
Bond Position:  [24.56017255]


portfolio before change:  [25.11923085]
curr_Stock_Price:  121.87756154372263
curr_Factors:  [1.21877562e+02 4.05801399e-02]
mat_Sqrt:  [[ 2.45516398e+01 -8.05174983e-03]
 [-8.05174983e-03  1.84653926e-02]]
grads:  [-0.00413566  2.50004005]
Stock Position:  -0.0041356582606295635
Bond Position:  [25.62327479]


portfolio before change:  [25.14810833]
curr_Stock_Price:  122.64446160619931
curr_Factors:  [1.22644462e+02 3.59864150e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [25.14810833]
Stock Price:  128.09567648688792
PL:  [-2.94756816]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 7.41411601e-02 -3.05227859e-02]
 [-7.24609981e-02  6.96488495e-02]
 [ 6.59119431e-02  4.64060915e-02]
 [ 1.30046918e-02  1.86206101e-02]
 [-1.95248738e-01 -3.95574896e-02]
 [ 1.09249383e-01  7.68121848e-02]
 [ 3.51168735e-02  5.60328449e-02]
 [-1.59421936e-01  7.96582212e-02]
 [ 6.76566982e-02  5.86480562e-02]
 [ 6.42201130e-02 -4.91006760e-02]
 [ 6.57882204e-02 -1.27056214e-01]
 [-1.06905262e-02  3.75346269e-02]
 [-2.59152425e-03 -5.16346546e-02]
 [ 1.24001202e-02 -1.47658690e-02]
 [-4.75457200e-02 -8.72907188e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 5.25968144e-02 -1.48928285e-01]
 [-1.59114188e-02  3.61903857e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.42454026]
curr_Stock_Price:  98.9347240386211
curr_Factors:  [9.89347240e+01 3.90369033e-02]
mat_Sqrt:  [[ 1.95472826e+01 -7.89578835e-03]
 [-7.89578835e-03  1.81114759e-02]]
grads:  [ 0.00311272 -1.68391624]
Stock Position:  0.003112724935243745
Bond Position:  [2.11658368]


portfolio before change:  [2.41383996]
curr_Stock_Price:  94.64661932345076
curr_Factors:  [9.46466193e+01 4.10112198e-02]
mat_Sqrt:  [[ 1.91671001e+01 -8.09265355e-03]
 [-8.09265355e-03  1.85639747e-02]]
grads:  [-2.19681118e-03  3.75087085e+00]
Stock Position:  -0.0021968111839417515
Bond Position:  [2.62176071]


portfolio before change:  [2.40804029]
curr_Stock_Price:  98.77938917635318
curr_Factors:  [9.87793892e+01 4.28217512e-02]
mat_Sqrt:  [[ 2.04408293e+01 -8.26969321e-03]
 [-8.26969321e-03  1.89691773e-02]]
grads:  [0.004215   2.44823208]
Stock Position:  0.004214998807733073
Bond Position:  [1.99168528]


portfolio before change:  [2.40899871]
curr_Stock_Price:  98.41574880248356
curr_Factors:  [9.84157488e+01 4.40300269e-02]
mat_Sqrt:  [[ 2.06509027e+01 -8.38552339e-03]
 [-8.38552339e-03  1.92349491e-02]]
grads:  [0.00102301 0.9685073 ]
Stock Position:  0.0010230125371481298
Bond Position:  [2.30831817]


portfolio before change:  [2.41268458]
curr_Stock_Price:  99.19644529544193
curr_Factors:  [9.91964453e+01 4.99410431e-02]
mat_Sqrt:  [[ 2.21679166e+01 -8.93074490e-03]
 [-8.93074490e-03  2.04854150e-02]]
grads:  [-0.00958734 -1.93518715]
Stock Position:  -0.009587342147682898
Bond Position:  [3.36371484]


portfolio before change:  [2.43236494]
curr_Stock_Price:  97.58253710454467
curr_Factors:  [9.75825371e+01 5.20722766e-02]
mat_Sqrt:  [[ 2.22676995e+01 -9.11917460e-03]
 [-9.11917460e-03  2.09180167e-02]]
grads:  [0.00641113 3.67485361]
Stock Position:  0.006411125421809864
Bond Position:  [1.80675105]


portfolio before change:  [2.46808317]
curr_Stock_Price:  102.80133689336652
curr_Factors:  [1.02801337e+02 4.97537975e-02]
mat_Sqrt:  [[ 2.29304114e+01 -8.91427561e-03]
 [-8.91427561e-03  2.04468498e-02]]
grads:  [2.59723984e-03 2.74154689e+00]
Stock Position:  0.0025972398391390255
Bond Position:  [2.20108344]


portfolio before change:  [2.46848804]
curr_Stock_Price:  101.89722252265727
curr_Factors:  [1.01897223e+02 4.76622150e-02]
mat_Sqrt:  [[ 2.22458715e+01 -8.72482285e-03]
 [-8.72482285e-03  2.00124865e-02]]
grads:  [-0.0056062   3.97798185]
Stock Position:  -0.005606197485353107
Bond Position:  [3.03974399]


portfolio before change:  [2.47408291]
curr_Stock_Price:  101.57743128901913
curr_Factors:  [1.01577431e+02 4.92859288e-02]
mat_Sqrt:  [[ 2.25506293e+01 -8.87216788e-03]
 [-8.87216788e-03  2.03505264e-02]]
grads:  [0.00413476 2.88369644]
Stock Position:  0.004134755442017111
Bond Position:  [2.05408507]


portfolio before change:  [2.48546617]
curr_Stock_Price:  103.70912781805737
curr_Factors:  [1.03709128e+02 4.61586248e-02]
mat_Sqrt:  [[ 2.22814464e+01 -8.58623474e-03]
 [-8.58623474e-03  1.96942332e-02]]
grads:  [ 1.92180237e-03 -2.49231207e+00]
Stock Position:  0.0019218023711207453
Bond Position:  [2.28615772]


portfolio before change:  [2.48520665]
curr_Stock_Price:  102.08617035593798
curr_Factors:  [1.02086170e+02 4.71155193e-02]
mat_Sqrt:  [[ 2.21589343e+01 -8.67465519e-03]
 [-8.67465519e-03  1.98973755e-02]]
grads:  [ 4.69215726e-04 -6.38537195e+00]
Stock Position:  0.0004692157261093067
Bond Position:  [2.43730621]


portfolio before change:  [2.48738696]
curr_Stock_Price:  100.23579120329268
curr_Factors:  [1.00235791e+02 4.46664842e-02]
mat_Sqrt:  [[ 2.11842783e+01 -8.44605533e-03]
 [-8.44605533e-03  1.93734094e-02]]
grads:  [2.67844954e-04 1.93754689e+00]
Stock Position:  0.0002678449541813858
Bond Position:  [2.46053931]


portfolio before change:  [2.49121861]
curr_Stock_Price:  103.05106097735344
curr_Factors:  [1.03051061e+02 3.90869191e-02]
mat_Sqrt:  [[ 2.03736178e+01 -7.90113710e-03]
 [-7.90113710e-03  1.81229474e-02]]
grads:  [-1.23233613e-03 -2.84966845e+00]
Stock Position:  -0.001232336130053863
Bond Position:  [2.61821216]


portfolio before change:  [2.49434476]
curr_Stock_Price:  103.17169302199798
curr_Factors:  [1.03171693e+02 3.88940694e-02]
mat_Sqrt:  [[ 2.03470858e+01 -7.88162961e-03]
 [-7.88162961e-03  1.80781805e-02]]
grads:  [ 2.93092674e-04 -8.16650711e-01]
Stock Position:  0.000293092673988082
Bond Position:  [2.46410589]


portfolio before change:  [2.49769498]
curr_Stock_Price:  104.0866278985793
curr_Factors:  [1.04086628e+02 3.51007634e-02]
mat_Sqrt:  [[ 1.95008341e+01 -7.48748557e-03]
 [-7.48748557e-03  1.71739685e-02]]
grads:  [-4.39042512e-03 -5.08464844e+00]
Stock Position:  -0.004390425117779098
Bond Position:  [2.95467953]


portfolio before change:  [2.49084688]
curr_Stock_Price:  106.48816378031891
curr_Factors:  [1.06488164e+02 3.60767149e-02]
mat_Sqrt:  [[ 2.02262234e+01 -7.59101462e-03]
 [-7.59101462e-03  1.74110208e-02]]
grads:  [ 0.0053718  -3.50368697]
Stock Position:  0.005371804850838823
Bond Position:  [1.91881324]


portfolio before change:  [2.50092822]
curr_Stock_Price:  107.91809738670666
curr_Factors:  [1.07918097e+02 3.57383279e-02]
mat_Sqrt:  [[ 2.04014655e+01 -7.55541632e-03]
 [-7.55541632e-03  1.73291363e-02]]
grads:  [-6.04719364e-04 -8.59436104e+00]
Stock Position:  -0.0006047193636536078
Bond Position:  [2.56618838]


portfolio before change:  [2.50513987]
curr_Stock_Price:  106.26127568576189
curr_Factors:  [1.06261276e+02 4.12939262e-02]
mat_Sqrt:  [[ 2.15932535e+01 -8.12135747e-03]
 [-8.12135747e-03  1.86274747e-02]]
grads:  [-6.15297721e-06  1.94284713e+00]
Stock Position:  -6.152977210383939e-06
Bond Position:  [2.50579369]


portfolio before change:  [2.50828056]
curr_Stock_Price:  105.20593903141753
curr_Factors:  [1.05205939e+02 4.68312307e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.50828056]
Stock Price:  107.48898818755067
PL:  [-4.98070762]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.63717175e-01  2.46458317e-03]
 [-4.58431147e-02  6.57687128e-02]
 [ 5.11209380e-02  9.03690431e-02]
 [-1.24389359e-02 -2.46448407e-03]
 [-1.67165859e-01  3.68497443e-03]
 [ 9.24516637e-02  3.99799443e-02]
 [-6.98943230e-02 -8.49575417e-02]
 [ 3.17634103e-02 -1.81465563e-02]
 [-2.94354158e-02 -2.84456308e-02]
 [ 6.15971959e-02 -3.19415096e-02]
 [ 6.20929167e-02 -1.20013063e-01]
 [-1.06518387e-02  3.97598195e-02]
 [-7.45683091e-02 -1.34703945e-01]
 [ 1.20877662e-02 -7.76071908e-05]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.66797575e-01 -9.97966934e-02]
 [ 3.15414180e-02 -1.46465555e-01]
 [-1.13237170e-02  3.59688957e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.80546335]
curr_Stock_Price:  97.2695320849944
curr_Factors:  [9.72695321e+01 4.02255817e-02]
mat_Sqrt:  [[ 1.95086832e+01 -8.01497373e-03]
 [-8.01497373e-03  1.83852118e-02]]
grads:  [0.0084486  0.13773562]
Stock Position:  0.008448603149573053
Bond Position:  [-4.62725502]


portfolio before change:  [-3.82723978]
curr_Stock_Price:  95.37705943019037
curr_Factors:  [9.53770594e+01 4.10540513e-02]
mat_Sqrt:  [[ 1.93251067e+01 -8.09693837e-03]
 [-8.09693837e-03  1.85736400e-02]]
grads:  [-8.88752206e-04  3.54058314e+00]
Stock Position:  -0.0008887522064517938
Bond Position:  [-3.74247321]


portfolio before change:  [-3.83120031]
curr_Stock_Price:  94.56638310481668
curr_Factors:  [9.45663831e+01 4.18401925e-02]
mat_Sqrt:  [[ 1.93434340e+01 -8.17402733e-03]
 [-8.17402733e-03  1.87506587e-02]]
grads:  [4.68026752e-03 4.82155327e+00]
Stock Position:  0.004680267522549507
Bond Position:  [-4.27379628]


portfolio before change:  [-3.81028139]
curr_Stock_Price:  100.17813655778734
curr_Factors:  [1.00178137e+02 4.17862353e-02]
mat_Sqrt:  [[ 2.04780942e+01 -8.16919817e-03]
 [-8.16919817e-03  1.87383712e-02]]
grads:  [-0.00066001 -0.13180846]
Stock Position:  -0.0006600079644682744
Bond Position:  [-3.74416302]


portfolio before change:  [-3.811838]
curr_Stock_Price:  95.44104772115186
curr_Factors:  [9.54410477e+01 4.15396142e-02]
mat_Sqrt:  [[ 1.94520954e+01 -8.14468575e-03]
 [-8.14468575e-03  1.86831538e-02]]
grads:  [-0.00851269  0.19352414]
Stock Position:  -0.008512690442799932
Bond Position:  [-2.99937791]


portfolio before change:  [-3.82443238]
curr_Stock_Price:  96.47982718661127
curr_Factors:  [9.64798272e+01 4.01395885e-02]
mat_Sqrt:  [[ 1.93296031e+01 -8.00634034e-03]
 [-8.00634034e-03  1.83655765e-02]]
grads:  [0.0056856  2.17937429]
Stock Position:  0.005685604363298442
Bond Position:  [-4.3729785]


portfolio before change:  [-3.83960685]
curr_Stock_Price:  94.77291327940777
curr_Factors:  [9.47729133e+01 3.77731539e-02]
mat_Sqrt:  [[ 1.84194143e+01 -7.76661521e-03]
 [-7.76661521e-03  1.78160385e-02]]
grads:  [-0.00580637 -4.7711301 ]
Stock Position:  -0.005806365657205413
Bond Position:  [-3.28932067]


portfolio before change:  [-3.83602811]
curr_Stock_Price:  93.44799423882506
curr_Factors:  [9.34479942e+01 3.51802976e-02]
mat_Sqrt:  [[ 1.75274888e+01 -7.49521283e-03]
 [-7.49521283e-03  1.71937419e-02]]
grads:  [ 0.00136114 -1.05482299]
Stock Position:  0.001361135510096931
Bond Position:  [-3.9632235]


portfolio before change:  [-3.83939394]
curr_Stock_Price:  94.61708723723952
curr_Factors:  [9.46170872e+01 3.45782536e-02]
mat_Sqrt:  [[ 1.75942623e+01 -7.43089289e-03]
 [-7.43089289e-03  1.70459487e-02]]
grads:  [-0.00237825 -1.66979872]
Stock Position:  -0.00237824755012021
Bond Position:  [-3.61437109]


portfolio before change:  [-3.85545634]
curr_Stock_Price:  99.47007535117878
curr_Factors:  [9.94700754e+01 3.44506808e-02]
mat_Sqrt:  [[ 1.84625344e+01 -7.41752275e-03]
 [-7.41752275e-03  1.70143223e-02]]
grads:  [ 0.00258255 -1.87620481]
Stock Position:  0.0025825492396322376
Bond Position:  [-4.11234271]


portfolio before change:  [-3.85200082]
curr_Stock_Price:  102.79979473806569
curr_Factors:  [1.02799795e+02 3.04471080e-02]
mat_Sqrt:  [[ 1.79376373e+01 -6.97342217e-03]
 [-6.97342217e-03  1.59950762e-02]]
grads:  [ 5.44782546e-04 -7.50288791e+00]
Stock Position:  0.0005447825464504585
Bond Position:  [-3.90800435]


portfolio before change:  [-3.85903201]
curr_Stock_Price:  98.86587164090115
curr_Factors:  [9.88658716e+01 3.45744212e-02]
mat_Sqrt:  [[ 1.83833148e+01 -7.43079018e-03]
 [-7.43079018e-03  1.70448693e-02]]
grads:  [3.63526248e-04 2.33281465e+00]
Stock Position:  0.00036352624847213406
Bond Position:  [-3.89497235]


portfolio before change:  [-3.86364986]
curr_Stock_Price:  99.56434224267888
curr_Factors:  [9.95643422e+01 3.72746661e-02]
mat_Sqrt:  [[ 1.92225356e+01 -7.71555625e-03]
 [-7.71555625e-03  1.76979336e-02]]
grads:  [-6.93544839e-03 -7.61430451e+00]
Stock Position:  -0.006935448385104582
Bond Position:  [-3.1731265]


portfolio before change:  [-3.88926648]
curr_Stock_Price:  102.68565932519543
curr_Factors:  [1.02685659e+02 3.70358919e-02]
mat_Sqrt:  [[ 1.97615574e+01 -7.69101943e-03]
 [-7.69101943e-03  1.76410640e-02]]
grads:  [ 0.00061007 -0.00413326]
Stock Position:  0.0006100722214586241
Bond Position:  [-3.95191215]


portfolio before change:  [-3.89262941]
curr_Stock_Price:  105.27559252295285
curr_Factors:  [1.05275593e+02 4.17281689e-02]
mat_Sqrt:  [[ 2.15051426e+01 -8.16388160e-03]
 [-8.16388160e-03  1.87251896e-02]]
grads:  [-3.97327396e-03 -4.65389298e+00]
Stock Position:  -0.003973273959795434
Bond Position:  [-3.47434064]


portfolio before change:  [-3.92342901]
curr_Stock_Price:  111.9335667899533
curr_Factors:  [1.11933567e+02 4.06822361e-02]
mat_Sqrt:  [[ 2.25768175e+01 -8.06133400e-03]
 [-8.06133400e-03  1.84888414e-02]]
grads:  [ 0.00546155 -5.39529028]
Stock Position:  0.0054615464769080715
Bond Position:  [-4.53475939]


portfolio before change:  [-3.96217561]
curr_Stock_Price:  105.87766166345783
curr_Factors:  [1.05877662e+02 4.65239452e-02]
mat_Sqrt:  [[ 2.28371854e+01 -8.62030139e-03]
 [-8.62030139e-03  1.97719462e-02]]
grads:  [-1.41527528e-03 -7.40836301e+00]
Stock Position:  -0.0014152752797431758
Bond Position:  [-3.81232957]


portfolio before change:  [-3.96671474]
curr_Stock_Price:  105.71567377118355
curr_Factors:  [1.05715674e+02 4.63140036e-02]
mat_Sqrt:  [[ 2.27507393e+01 -8.60081822e-03]
 [-8.60081822e-03  1.97272898e-02]]
grads:  [1.91595059e-04 1.82339003e+00]
Stock Position:  0.00019159505862249837
Bond Position:  [-3.98696935]


portfolio before change:  [-3.97169872]
curr_Stock_Price:  105.73053860389972
curr_Factors:  [1.05730539e+02 4.68405723e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.97169872]
Stock Price:  107.34844612574679
PL:  [-11.32014485]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.61479930e-01  1.70230819e-03]
 [-1.51084067e-01  8.11745516e-02]
 [ 4.28553372e-02  1.14936396e-01]
 [-6.52053001e-01 -3.30766603e-01]
 [ 4.47004685e-01  4.17565758e-02]
 [-6.78673551e-02 -4.98766218e-01]
 [-1.88593020e-01 -2.43309947e-01]
 [ 3.26153732e-02 -1.44487778e-02]
 [-2.05432646e-01 -1.60599068e-01]
 [ 8.23791383e-02  4.02950212e-01]
 [-1.52642746e-01 -2.71762300e-02]
 [ 5.32710029e-02 -2.04378926e-01]
 [-1.98558744e-01 -1.02726758e-01]
 [-2.69882467e-03  1.48877673e-01]
 [-1.08334685e-01  1.34628045e-01]
 [-1.70797339e-01  7.69160294e-02]
 [-1.03174316e-01  1.96526013e-01]
 [ 3.40475336e-02 -1.53110951e-01]
 [ 1.21778656e-03  5.70463296e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.60703657]
curr_Stock_Price:  97.05528288760988
curr_Factors:  [9.70552829e+01 4.10861022e-02]
mat_Sqrt:  [[ 1.96728198e+01 -8.10023288e-03]
 [-8.10023288e-03  1.85808301e-02]]
grads:  [0.00824748 0.09521182]
Stock Position:  0.008247478968611176
Bond Position:  [-5.40749797]


portfolio before change:  [-4.65143883]
curr_Stock_Price:  92.49162540624664
curr_Factors:  [9.24916254e+01 4.48452630e-02]
mat_Sqrt:  [[ 1.95866724e+01 -8.46229385e-03]
 [-8.46229385e-03  1.94124242e-02]]
grads:  [-0.00590811  4.17900179]
Stock Position:  -0.0059081054483305475
Bond Position:  [-4.10498856]


portfolio before change:  [-4.65492142]
curr_Stock_Price:  92.21203327053072
curr_Factors:  [9.22120333e+01 4.47945741e-02]
mat_Sqrt:  [[ 1.95164248e+01 -8.45748461e-03]
 [-8.45748461e-03  1.94014612e-02]]
grads:  [4.76398589e-03 5.92618701e+00]
Stock Position:  0.004763985892197528
Bond Position:  [-5.09421824]


portfolio before change:  [-4.67960283]
curr_Stock_Price:  88.36868391278134
curr_Factors:  [8.83686839e+01 4.54288529e-02]
mat_Sqrt:  [[ 1.88349394e+01 -8.51678409e-03]
 [-8.51678409e-03  1.95384984e-02]]
grads:  [ -0.04228261 -16.94739836]
Stock Position:  -0.04228260653222604
Bond Position:  [-0.94314454]


portfolio before change:  [-4.75384525]
curr_Stock_Price:  90.09664613523937
curr_Factors:  [9.00966461e+01 4.76665683e-02]
mat_Sqrt:  [[ 1.96705057e+01 -8.72419425e-03]
 [-8.72419425e-03  2.00138481e-02]]
grads:  [0.02365453 2.09669536]
Stock Position:  0.023654534844857317
Bond Position:  [-6.8850395]


portfolio before change:  [-4.90424565]
curr_Stock_Price:  84.10250094755702
curr_Factors:  [8.41025009e+01 5.20877251e-02]
mat_Sqrt:  [[ 1.91944891e+01 -9.11915544e-03]
 [-9.11915544e-03  2.09217173e-02]]
grads:  [-1.48648826e-02 -2.38461196e+01]
Stock Position:  -0.014864882588604935
Bond Position:  [-3.65407184]


portfolio before change:  [-5.00798077]
curr_Stock_Price:  90.77357159577197
curr_Factors:  [9.07735716e+01 4.92719427e-02]
mat_Sqrt:  [[ 2.01492657e+01 -8.86995708e-03]
 [-8.86995708e-03  2.03480537e-02]]
grads:  [ -0.0146264  -11.96378221]
Stock Position:  -0.01462640172828523
Bond Position:  [-3.68029005]


portfolio before change:  [-5.00115639]
curr_Stock_Price:  89.99227029786137
curr_Factors:  [8.99922703e+01 4.95874319e-02]
mat_Sqrt:  [[ 2.00396888e+01 -8.89823109e-03]
 [-8.89823109e-03  2.04131282e-02]]
grads:  [ 0.0013135  -0.70724535]
Stock Position:  0.0013135004676010698
Bond Position:  [-5.11936128]


portfolio before change:  [-5.01418888]
curr_Stock_Price:  84.945230381561
curr_Factors:  [8.49452304e+01 5.62954595e-02]
mat_Sqrt:  [[ 2.01546674e+01 -9.48043574e-03]
 [-9.48043574e-03  2.17503088e-02]]
grads:  [-0.01366881 -7.38971827]
Stock Position:  -0.013668813807859247
Bond Position:  [-3.85308834]


portfolio before change:  [-5.02081573]
curr_Stock_Price:  85.0774638934966
curr_Factors:  [8.50774639e+01 4.94869561e-02]
mat_Sqrt:  [[ 1.89260446e+01 -8.88868904e-03]
 [-8.88868904e-03  2.03926646e-02]]
grads:  [1.36356337e-02 1.97655100e+01]
Stock Position:  0.013635633665989773
Bond Position:  [-6.18090086]


portfolio before change:  [-5.11196689]
curr_Stock_Price:  78.95965432634448
curr_Factors:  [7.89596543e+01 5.04308074e-02]
mat_Sqrt:  [[ 1.7731813e+01 -8.9723062e-03]
 [-8.9723062e-03  2.0586544e-02]]
grads:  [-0.00927843 -1.32414061]
Stock Position:  -0.00927842747566665
Bond Position:  [-4.37934547]


portfolio before change:  [-5.09689981]
curr_Stock_Price:  76.74541211800107
curr_Factors:  [7.67454121e+01 5.41015445e-02]
mat_Sqrt:  [[ 1.78507799e+01 -9.29279651e-03]
 [-9.29279651e-03  2.13227432e-02]]
grads:  [-2.00600559e-03 -9.58589453e+00]
Stock Position:  -0.0020060055904081975
Bond Position:  [-4.94294809]


portfolio before change:  [-5.11302411]
curr_Stock_Price:  81.70140785075085
curr_Factors:  [8.17014079e+01 5.27286518e-02]
mat_Sqrt:  [[ 1.87608634e+01 -9.17479482e-03]
 [-9.17479482e-03  2.10501700e-02]]
grads:  [-0.01297299 -4.88574593]
Stock Position:  -0.012972988239380399
Bond Position:  [-4.05311271]


portfolio before change:  [-5.14107563]
curr_Stock_Price:  83.47293153442396
curr_Factors:  [8.34729315e+01 5.68562215e-02]
mat_Sqrt:  [[ 1.99037365e+01 -9.52735514e-03]
 [-9.52735514e-03  2.18584473e-02]]
grads:  [3.12528641e-03 6.81235252e+00]
Stock Position:  0.0031252864073423063
Bond Position:  [-5.40195245]


portfolio before change:  [-5.14136545]
curr_Stock_Price:  85.54213205786309
curr_Factors:  [8.55421321e+01 5.26399168e-02]
mat_Sqrt:  [[ 1.96262633e+01 -9.16753293e-03]
 [-9.16753293e-03  2.10322492e-02]]
grads:  [-2.53044343e-03  6.39992641e+00]
Stock Position:  -0.0025304434324889963
Bond Position:  [-4.92490592]


portfolio before change:  [-5.14337501]
curr_Stock_Price:  83.90193766441789
curr_Factors:  [8.39019377e+01 5.85607163e-02]
mat_Sqrt:  [[ 2.03036974e+01 -9.66916526e-03]
 [-9.66916526e-03  2.21836518e-02]]
grads:  [-0.00676234  3.46429181]
Stock Position:  -0.006762341183384506
Bond Position:  [-4.57600148]


portfolio before change:  [-5.14820972]
curr_Stock_Price:  83.77049429654548
curr_Factors:  [8.37704943e+01 5.45623188e-02]
mat_Sqrt:  [[ 1.95675944e+01 -9.33321905e-03]
 [-9.33321905e-03  2.14129449e-02]]
grads:  [-8.95283450e-04  9.17751658e+00]
Stock Position:  -0.0008952834496877734
Bond Position:  [-5.07321139]


portfolio before change:  [-5.15283516]
curr_Stock_Price:  81.84926291117615
curr_Factors:  [8.18492629e+01 5.68658016e-02]
mat_Sqrt:  [[ 1.95182243e+01 -9.52795042e-03]
 [-9.52795042e-03  2.18603791e-02]]
grads:  [-1.67502738e-03 -7.00476920e+00]
Stock Position:  -0.0016750273826235766
Bond Position:  [-5.0157354]


portfolio before change:  [-5.15991609]
curr_Stock_Price:  82.33124884874229
curr_Factors:  [8.23312488e+01 5.01303395e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.15991609]
Stock Price:  79.67141367845574
PL:  [-5.15991609]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.28947948e-01 -1.13367536e-02]
 [-3.40574316e-03 -9.59095662e-02]
 [-3.82729161e-01 -1.37151432e-01]
 [-2.42915297e-02 -2.96094628e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-1.00823341e-01  3.95394774e-02]
 [ 4.92669839e-02  3.97092681e-02]
 [ 6.75118988e-02 -4.49523286e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 2.62691319e-01 -1.11847934e-03]
 [ 2.68385231e-02  8.21937378e-02]
 [ 2.16452641e-03 -1.72854372e-01]
 [-1.61620157e-02 -1.04365640e-01]
 [ 1.96362952e-01 -1.36112444e-01]
 [ 1.03039203e-01 -1.49080109e-01]
 [-7.70748396e-02  4.16411859e-02]
 [-1.21983033e-01 -1.47337312e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.47493119]
curr_Stock_Price:  98.41362107466013
curr_Factors:  [9.84136211e+01 3.79281444e-02]
mat_Sqrt:  [[ 1.91661981e+01 -7.78281107e-03]
 [-7.78281107e-03  1.78524311e-02]]
grads:  [ 0.00647116 -0.63220464]
Stock Position:  0.006471164372974145
Bond Position:  [-0.16191953]


portfolio before change:  [0.5049624]
curr_Stock_Price:  103.08569176991337
curr_Factors:  [1.03085692e+02 4.06612737e-02]
mat_Sqrt:  [[ 2.07868579e+01 -8.05869087e-03]
 [-8.05869087e-03  1.84843241e-02]]
grads:  [-2.17577360e-03 -5.18964607e+00]
Stock Position:  -0.00217577360153094
Bond Position:  [0.72925352]


portfolio before change:  [0.49306621]
curr_Stock_Price:  108.97248336160418
curr_Factors:  [1.08972483e+02 3.84938079e-02]
mat_Sqrt:  [[ 2.13802243e+01 -7.84134006e-03]
 [-7.84134006e-03  1.79847565e-02]]
grads:  [-0.02070127 -7.63500792]
Stock Position:  -0.020701272798610816
Bond Position:  [2.74893531]


portfolio before change:  [0.56596257]
curr_Stock_Price:  105.61722887483025
curr_Factors:  [1.05617229e+02 4.15623634e-02]
mat_Sqrt:  [[ 2.15320240e+01 -8.14766893e-03]
 [-8.14766893e-03  1.86879406e-02]]
grads:  [-0.00172798 -1.58516887]
Stock Position:  -0.001727982511694066
Bond Position:  [0.74846729]


portfolio before change:  [0.56055602]
curr_Stock_Price:  109.28781784008227
curr_Factors:  [1.09287818e+02 4.18826533e-02]
mat_Sqrt:  [[ 2.23660257e+01 -8.17924087e-03]
 [-8.17924087e-03  1.87597055e-02]]
grads:  [ 0.00733144 -6.29274025]
Stock Position:  0.007331438576227895
Bond Position:  [-0.2406809]


portfolio before change:  [0.54062125]
curr_Stock_Price:  106.60979940852042
curr_Factors:  [1.06609799e+02 4.05097439e-02]
mat_Sqrt:  [[ 2.14573875e+01 -8.04389718e-03]
 [-8.04389718e-03  1.84497468e-02]]
grads:  [0.00806116 5.76026356]
Stock Position:  0.008061155433847141
Bond Position:  [-0.31877691]


portfolio before change:  [0.56563124]
curr_Stock_Price:  109.76179295905314
curr_Factors:  [1.09761793e+02 4.53307874e-02]
mat_Sqrt:  [[ 2.33694125e+01 -8.50930534e-03]
 [-8.50930534e-03  1.95166492e-02]]
grads:  [3.84044850e-03 4.15134463e+00]
Stock Position:  0.0038404485031654687
Bond Position:  [0.14409673]


portfolio before change:  [0.57899798]
curr_Stock_Price:  113.19537685106806
curr_Factors:  [1.13195377e+02 4.17630304e-02]
mat_Sqrt:  [[ 2.31326115e+01 -8.16778827e-03]
 [-8.16778827e-03  1.87327931e-02]]
grads:  [-0.00361379  2.10913345]
Stock Position:  -0.0036137893537758294
Bond Position:  [0.98806223]


portfolio before change:  [0.57157727]
curr_Stock_Price:  115.59080068773763
curr_Factors:  [1.15590801e+02 4.17689586e-02]
mat_Sqrt:  [[ 2.36238170e+01 -8.16850492e-03]
 [-8.16850492e-03  1.87340629e-02]]
grads:  [0.00281882 2.12085834]
Stock Position:  0.002818817370536334
Bond Position:  [0.24574792]


portfolio before change:  [0.57194103]
curr_Stock_Price:  115.6108012158136
curr_Factors:  [1.15610801e+02 4.16089227e-02]
mat_Sqrt:  [[ 2.35825965e+01 -8.15284239e-03]
 [-8.15284239e-03  1.86981386e-02]]
grads:  [ 2.03195672e-03 -2.40322116e+00]
Stock Position:  0.002031956718541033
Bond Position:  [0.33702488]


portfolio before change:  [0.57482714]
curr_Stock_Price:  116.8237040011929
curr_Factors:  [1.16823704e+02 4.40557882e-02]
mat_Sqrt:  [[ 2.45206757e+01 -8.38920623e-03]
 [-8.38920623e-03  1.92400390e-02]]
grads:  [ 3.91375248e-04 -6.35906307e+00]
Stock Position:  0.00039137524771392436
Bond Position:  [0.52910523]


portfolio before change:  [0.57525078]
curr_Stock_Price:  116.21520104074766
curr_Factors:  [1.16215201e+02 4.22540208e-02]
mat_Sqrt:  [[ 2.38889429e+01 -8.21583334e-03]
 [-8.21583334e-03  1.88425128e-02]]
grads:  [ 0.01097759 -0.05457283]
Stock Position:  0.010977587344930807
Bond Position:  [-0.70051174]


portfolio before change:  [0.51950202]
curr_Stock_Price:  111.21660046204522
curr_Factors:  [1.11216600e+02 4.58771599e-02]
mat_Sqrt:  [[ 2.38214312e+01 -8.56052656e-03]
 [-8.56052656e-03  1.96338734e-02]]
grads:  [2.63147393e-03 4.18747045e+00]
Stock Position:  0.0026314739279350995
Bond Position:  [0.22683843]


portfolio before change:  [0.51477888]
curr_Stock_Price:  109.31391842184752
curr_Factors:  [1.09313918e+02 4.73164102e-02]
mat_Sqrt:  [[ 2.37783288e+01 -8.69364467e-03]
 [-8.69364467e-03  1.99395247e-02]]
grads:  [-3.07892763e-03 -8.67027383e+00]
Stock Position:  -0.003078927631502576
Bond Position:  [0.85134853]


portfolio before change:  [0.50127596]
curr_Stock_Price:  114.04536397669413
curr_Factors:  [1.14045364e+02 4.57907461e-02]
mat_Sqrt:  [[ 2.44043064e+01 -8.55263520e-03]
 [-8.55263520e-03  1.96152974e-02]]
grads:  [-2.52729183e-03 -5.32172686e+00]
Stock Position:  -0.0025272918260656604
Bond Position:  [0.78950187]


portfolio before change:  [0.49599916]
curr_Stock_Price:  116.52402074477584
curr_Factors:  [1.16524021e+02 4.32996276e-02]
mat_Sqrt:  [[ 2.42469723e+01 -8.31688293e-03]
 [-8.31688293e-03  1.90742165e-02]]
grads:  [ 5.65162017e-03 -7.13347465e+00]
Stock Position:  0.005651620171614239
Bond Position:  [-0.16255034]


portfolio before change:  [0.49703369]
curr_Stock_Price:  116.7430450524657
curr_Factors:  [1.16743045e+02 4.16615553e-02]
mat_Sqrt:  [[ 2.38286112e+01 -8.15805985e-03]
 [-8.15805985e-03  1.87099335e-02]]
grads:  [ 1.59647326e-03 -7.96726962e+00]
Stock Position:  0.0015964732560283077
Bond Position:  [0.31065654]


portfolio before change:  [0.49459015]
curr_Stock_Price:  114.96907017978126
curr_Factors:  [1.14969070e+02 3.76589277e-02]
mat_Sqrt:  [[ 2.23107910e+01 -7.75617974e-03]
 [-7.75617974e-03  1.77885062e-02]]
grads:  [-0.0026412   2.33975241]
Stock Position:  -0.002641201711765195
Bond Position:  [0.79824666]


portfolio before change:  [0.46763612]
curr_Stock_Price:  125.5523058099071
curr_Factors:  [1.25552306e+02 3.42660976e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.46763612]
Stock Price:  128.36325805625998
PL:  [-27.89562193]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-1.75842343e-02 -6.17232768e-02]
 [ 5.22410438e-03 -8.55336352e-02]
 [ 7.45577375e-02 -6.53505245e-02]
 [-1.96641895e-02 -1.70320993e-02]
 [-2.06419765e-01 -2.24493190e-02]
 [ 1.29568911e-01  1.27910809e-01]
 [-6.47214549e-02 -7.80004864e-02]
 [ 3.25163869e-02 -1.48784083e-02]
 [-1.16261325e-01 -9.37862955e-02]
 [ 4.57256119e-02  2.45752243e-01]
 [ 5.87294193e-02 -1.10772925e-01]
 [-8.00822130e-03  1.98825186e-02]
 [-7.47053073e-02 -1.34828658e-01]
 [ 5.74235403e-03  1.46158276e-01]
 [-6.34729230e-02 -7.89984043e-02]
 [ 3.80816514e-02 -2.99832953e-02]
 [ 1.43932304e-02 -1.12943700e-01]
 [ 7.60598644e-02  1.47363349e-02]
 [ 5.50121027e-02  2.34991681e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.7050141]
curr_Stock_Price:  102.21712120741788
curr_Factors:  [1.02217121e+02 3.40463050e-02]
mat_Sqrt:  [[ 1.88607347e+01 -7.37404395e-03]
 [-7.37404395e-03  1.69140925e-02]]
grads:  [-2.35947025e-03 -3.65025056e+00]
Stock Position:  -0.0023594702513817026
Bond Position:  [14.94619235]


portfolio before change:  [14.7230693]
curr_Stock_Price:  102.48803867930518
curr_Factors:  [1.02488039e+02 3.39936654e-02]
mat_Sqrt:  [[ 1.88960986e+01 -7.36835862e-03]
 [-7.36835862e-03  1.69010043e-02]]
grads:  [-1.69725974e-03 -5.06160107e+00]
Stock Position:  -0.0016972597434561545
Bond Position:  [14.89701812]


portfolio before change:  [14.74394963]
curr_Stock_Price:  101.16389525874692
curr_Factors:  [1.01163895e+02 3.74591445e-02]
mat_Sqrt:  [[ 1.95796280e+01 -7.73473796e-03]
 [-7.73473796e-03  1.77416255e-02]]
grads:  [ 2.35321599e-03 -3.68243164e+00]
Stock Position:  0.0023532159867971757
Bond Position:  [14.50588913]


portfolio before change:  [14.76541111]
curr_Stock_Price:  102.5737866573889
curr_Factors:  [1.02573787e+02 3.36800551e-02]
mat_Sqrt:  [[ 1.88244698e+01 -7.33429676e-03]
 [-7.33429676e-03  1.68228607e-02]]
grads:  [-0.00143931 -1.01306526]
Stock Position:  -0.0014393133558526492
Bond Position:  [14.91304693]


portfolio before change:  [14.78996688]
curr_Stock_Price:  98.47265909913585
curr_Factors:  [9.84726591e+01 3.31318608e-02]
mat_Sqrt:  [[ 1.79241489e+01 -7.27409295e-03]
 [-7.27409295e-03  1.66855081e-02]]
grads:  [-0.01206444 -1.35069767]
Stock Position:  -0.012064442556156218
Bond Position:  [15.97798462]


portfolio before change:  [14.80358603]
curr_Stock_Price:  99.00031011507271
curr_Factors:  [9.90003101e+01 3.51383978e-02]
mat_Sqrt:  [[ 1.85578430e+01 -7.49115982e-03]
 [-7.49115982e-03  1.71833205e-02]]
grads:  [0.0099885  7.44824813]
Stock Position:  0.00998849531728131
Bond Position:  [13.8147219]


portfolio before change:  [14.78041482]
curr_Stock_Price:  94.95061004623625
curr_Factors:  [9.49506100e+01 3.60732596e-02]
mat_Sqrt:  [[ 1.80339315e+01 -7.58985788e-03]
 [-7.58985788e-03  1.74105328e-02]]
grads:  [-0.00547538 -4.48246154]
Stock Position:  -0.005475384067972004
Bond Position:  [15.30030588]


portfolio before change:  [14.82483277]
curr_Stock_Price:  90.33347183304569
curr_Factors:  [9.03334718e+01 4.00780411e-02]
mat_Sqrt:  [[ 1.80843083e+01 -7.99968311e-03]
 [-7.99968311e-03  1.83517160e-02]]
grads:  [ 0.00143969 -0.81010905]
Stock Position:  0.0014396885283691815
Bond Position:  [14.6947807]


portfolio before change:  [14.84226341]
curr_Stock_Price:  89.67408394916414
curr_Factors:  [8.96740839e+01 4.64273186e-02]
mat_Sqrt:  [[ 1.93220725e+01 -8.60999907e-03]
 [-8.60999907e-03  1.97519898e-02]]
grads:  [-0.00813442 -4.75174064]
Stock Position:  -0.008134417645655083
Bond Position:  [15.57170987]


portfolio before change:  [14.84573904]
curr_Stock_Price:  91.6411799433541
curr_Factors:  [9.16411799e+01 4.41800569e-02]
mat_Sqrt:  [[ 1.92621059e+01 -8.39922004e-03]
 [-8.39922004e-03  1.92679442e-02]]
grads:  [7.93694093e-03 1.27579209e+01]
Stock Position:  0.00793694093359876
Bond Position:  [14.11838841]


portfolio before change:  [14.88086965]
curr_Stock_Price:  93.8424801281999
curr_Factors:  [9.38424801e+01 4.43531760e-02]
mat_Sqrt:  [[ 1.97634063e+01 -8.41585736e-03]
 [-8.41585736e-03  1.93055719e-02]]
grads:  [ 5.28362090e-04 -5.73764295e+00]
Stock Position:  0.0005283620897974724
Bond Position:  [14.83128684]


portfolio before change:  [14.90005337]
curr_Stock_Price:  95.0405526988017
curr_Factors:  [9.50405527e+01 3.69493517e-02]
mat_Sqrt:  [[ 1.82688970e+01 -7.68147742e-03]
 [-7.68147742e-03  1.76206817e-02]]
grads:  [3.60936719e-05 1.12837836e+00]
Stock Position:  3.609367193690384e-05
Bond Position:  [14.89662301]


portfolio before change:  [14.91884854]
curr_Stock_Price:  99.54954771658743
curr_Factors:  [9.95495477e+01 3.88798198e-02]
mat_Sqrt:  [[ 1.96291448e+01 -7.87993116e-03]
 [-7.87993116e-03  1.80749795e-02]]
grads:  [-6.80153419e-03 -7.46237380e+00]
Stock Position:  -0.006801534185971582
Bond Position:  [15.59593819]


portfolio before change:  [14.9551754]
curr_Stock_Price:  97.07661260026389
curr_Factors:  [9.70766126e+01 3.93823766e-02]
mat_Sqrt:  [[ 1.92648458e+01 -7.93050940e-03]
 [-7.93050940e-03  1.81915031e-02]]
grads:  [3.60614919e-03 8.03599754e+00]
Stock Position:  0.003606149187598985
Bond Position:  [14.60510265]


portfolio before change:  [14.97954285]
curr_Stock_Price:  98.76807293438033
curr_Factors:  [9.87680729e+01 3.51853901e-02]
mat_Sqrt:  [[ 1.85266855e+01 -7.49615099e-03]
 [-7.49615099e-03  1.71948138e-02]]
grads:  [-0.00528588 -4.59662018]
Stock Position:  -0.005285882446073207
Bond Position:  [15.50161928]


portfolio before change:  [15.01277427]
curr_Stock_Price:  96.1493466622627
curr_Factors:  [9.61493467e+01 3.67933316e-02]
mat_Sqrt:  [[ 1.84429699e+01 -7.66532777e-03]
 [-7.66532777e-03  1.75834031e-02]]
grads:  [ 1.35635604e-03 -1.70461305e+00]
Stock Position:  0.0013563560432065683
Bond Position:  [14.88236152]


portfolio before change:  [15.0378816]
curr_Stock_Price:  100.9362521788885
curr_Factors:  [1.00936252e+02 3.22901834e-02]
mat_Sqrt:  [[ 1.81377076e+01 -7.18126655e-03]
 [-7.18126655e-03  1.64721354e-02]]
grads:  [-1.92153449e-03 -6.85748968e+00]
Stock Position:  -0.0019215344927053977
Bond Position:  [15.23183409]


portfolio before change:  [15.06258904]
curr_Stock_Price:  97.99290962800569
curr_Factors:  [9.79929096e+01 3.47957313e-02]
mat_Sqrt:  [[ 1.82792175e+01 -7.45447288e-03]
 [-7.45447288e-03  1.70993610e-02]]
grads:  [0.00451326 0.86377373]
Stock Position:  0.004513258958175128
Bond Position:  [14.62032166]


portfolio before change:  [15.07582119]
curr_Stock_Price:  96.87294938792235
curr_Factors:  [9.68729494e+01 3.76112869e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.07582119]
Stock Price:  96.2759085828404
PL:  [15.07582119]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-3.08569364e-02 -6.80156894e-02]
 [ 4.14613608e-02 -1.64858472e-02]
 [ 4.80865488e-02  9.93883376e-02]
 [ 2.20990645e-02  2.29484959e-02]
 [-1.99959180e-01 -3.23435560e-02]
 [ 7.71153566e-02  1.06502169e-02]
 [-1.69471982e-01 -2.18872895e-01]
 [ 3.19622792e-02 -1.72834046e-02]
 [-7.29029083e-02 -6.12753400e-02]
 [ 4.99409186e-02  5.02036273e-02]
 [ 7.20653430e-02 -1.39280877e-01]
 [-1.06902237e-02  3.75532886e-02]
 [ 1.16775051e-02 -3.08469044e-02]
 [ 1.79457228e-03 -1.68896645e-01]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.41695131e-01 -6.89628527e-02]
 [ 8.87469570e-02 -1.51632177e-01]
 [-4.71831598e-02  3.86152027e-02]
 [-8.74432941e-02 -7.81893315e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.09832708]
curr_Stock_Price:  101.78767646513343
curr_Factors:  [1.01787676e+02 3.83704163e-02]
mat_Sqrt:  [[ 1.99385432e+01 -7.82829787e-03]
 [-7.82829787e-03  1.79561108e-02]]
grads:  [-3.03532661e-03 -3.78920867e+00]
Stock Position:  -0.0030353266098687537
Bond Position:  [13.40728592]


portfolio before change:  [13.12415417]
curr_Stock_Price:  98.80364803848136
curr_Factors:  [9.88036480e+01 3.96770545e-02]
mat_Sqrt:  [[ 1.96807959e+01 -7.96025532e-03]
 [-7.96025532e-03  1.82593779e-02]]
grads:  [ 0.00174182 -0.9021108 ]
Stock Position:  0.0017418161735273134
Bond Position:  [12.95205637]


portfolio before change:  [13.13146838]
curr_Stock_Price:  93.70209081222274
curr_Factors:  [9.37020908e+01 3.86521995e-02]
mat_Sqrt:  [[ 1.84219818e+01 -7.85637989e-03]
 [-7.85637989e-03  1.80221888e-02]]
grads:  [4.96307749e-03 5.51693972e+00]
Stock Position:  0.004963077489708295
Bond Position:  [12.66641765]


portfolio before change:  [13.16557509]
curr_Stock_Price:  97.3820226834973
curr_Factors:  [9.73820227e+01 3.67465441e-02]
mat_Sqrt:  [[ 1.86675363e+01 -7.66054484e-03]
 [-7.66054484e-03  1.75721795e-02]]
grads:  [0.00172005 1.306706  ]
Stock Position:  0.001720052601739518
Bond Position:  [12.99807289]


portfolio before change:  [13.18444986]
curr_Stock_Price:  98.9034960601648
curr_Factors:  [9.89034961e+01 3.07969393e-02]
mat_Sqrt:  [[ 1.73566292e+01 -7.01312324e-03]
 [-7.01312324e-03  1.60868112e-02]]
grads:  [-0.01233518 -2.01594112]
Stock Position:  -0.012335184482832707
Bond Position:  [14.40444273]


portfolio before change:  [13.24424661]
curr_Stock_Price:  95.51644187204016
curr_Factors:  [9.55164419e+01 2.81269705e-02]
mat_Sqrt:  [[ 1.60191540e+01 -6.70200752e-03]
 [-6.70200752e-03  1.53737699e-02]]
grads:  [0.00510471 0.69497779]
Stock Position:  0.005104707952781481
Bond Position:  [12.75666307]


portfolio before change:  [13.23905891]
curr_Stock_Price:  91.3744814369048
curr_Factors:  [9.13744814e+01 2.84965906e-02]
mat_Sqrt:  [[ 1.54248637e+01 -6.74560658e-03]
 [-6.74560658e-03  1.54745823e-02]]
grads:  [ -0.01717568 -14.1515132 ]
Stock Position:  -0.01717567995253263
Bond Position:  [14.80847776]


portfolio before change:  [13.23773688]
curr_Stock_Price:  92.52984766705146
curr_Factors:  [9.25298477e+01 2.40566136e-02]
mat_Sqrt:  [[ 1.43515581e+01 -6.19793814e-03]
 [-6.19793814e-03  1.42180061e-02]]
grads:  [ 0.00170244 -1.21485761]
Stock Position:  0.001702440023410809
Bond Position:  [13.08021036]


portfolio before change:  [13.25314034]
curr_Stock_Price:  91.96769902167665
curr_Factors:  [9.19676990e+01 2.45512537e-02]
mat_Sqrt:  [[ 1.44102700e+01 -6.26129552e-03]
 [-6.26129552e-03  1.43634507e-02]]
grads:  [-0.00691402 -4.26907378]
Stock Position:  -0.006914016250929857
Bond Position:  [13.88900651]


portfolio before change:  [13.23987429]
curr_Stock_Price:  96.39901138293216
curr_Factors:  [9.63990114e+01 2.26184022e-02]
mat_Sqrt:  [[ 1.44978467e+01 -6.01005166e-03]
 [-6.01005166e-03  1.37863447e-02]]
grads:  [0.0049552  3.64370755]
Stock Position:  0.004955204079798041
Bond Position:  [12.76219751]


portfolio before change:  [13.28072945]
curr_Stock_Price:  101.42250641921439
curr_Factors:  [1.01422506e+02 1.84767090e-02]
mat_Sqrt:  [[ 1.37862647e+01 -5.43225301e-03]
 [-5.43225301e-03  1.24602455e-02]]
grads:  [ 8.22953692e-04 -1.11776615e+01]
Stock Position:  0.0008229536917141315
Bond Position:  [13.19726343]


portfolio before change:  [13.29623141]
curr_Stock_Price:  100.20136652989244
curr_Factors:  [1.00201367e+02 1.98065529e-02]
mat_Sqrt:  [[ 1.41019139e+01 -5.62428540e-03]
 [-5.62428540e-03  1.29008892e-02]]
grads:  [4.02962039e-04 2.91108266e+00]
Stock Position:  0.00040296203900026735
Bond Position:  [13.25585406]


portfolio before change:  [13.3142019]
curr_Stock_Price:  103.65161067489262
curr_Factors:  [1.03651611e+02 1.83808610e-02]
mat_Sqrt:  [[ 1.40526732e+01 -5.41824999e-03]
 [-5.41824999e-03  1.24278388e-02]]
grads:  [-1.26049243e-04 -2.48213611e+00]
Stock Position:  -0.00012604924319568206
Bond Position:  [13.32726711]


portfolio before change:  [13.33016448]
curr_Stock_Price:  109.25990063648051
curr_Factors:  [1.09259901e+02 1.77229931e-02]
mat_Sqrt:  [[ 1.45455218e+01 -5.32064577e-03]
 [-5.32064577e-03  1.22033053e-02]]
grads:  [-4.94006955e-03 -1.38423915e+01]
Stock Position:  -0.004940069552031615
Bond Position:  [13.86991599]


portfolio before change:  [13.34849118]
curr_Stock_Price:  109.06183462323109
curr_Factors:  [1.09061835e+02 1.52571926e-02]
mat_Sqrt:  [[ 1.34713179e+01 -4.93665144e-03]
 [-4.93665144e-03  1.13226056e-02]]
grads:  [-6.34286112e-03 -7.69645313e+00]
Stock Position:  -0.0063428611231452795
Bond Position:  [14.04025525]


portfolio before change:  [13.37167676]
curr_Stock_Price:  108.17512200026033
curr_Factors:  [1.08175122e+02 1.89215552e-02]
mat_Sqrt:  [[ 1.48800976e+01 -5.49756757e-03]
 [-5.49756757e-03  1.26092150e-02]]
grads:  [ 0.00750301 -5.46597106]
Stock Position:  0.00750301435095102
Bond Position:  [12.56003727]


portfolio before change:  [13.42239259]
curr_Stock_Price:  112.8407090806926
curr_Factors:  [1.12840709e+02 1.48347079e-02]
mat_Sqrt:  [[ 1.37437510e+01 -4.86795846e-03]
 [-4.86795846e-03  1.11646791e-02]]
grads:  [ 1.64705202e-03 -1.35807001e+01]
Stock Position:  0.0016470520223589797
Bond Position:  [13.23653807]


portfolio before change:  [13.43486749]
curr_Stock_Price:  110.36287741314142
curr_Factors:  [1.10362877e+02 1.49451717e-02]
mat_Sqrt:  [[ 1.34919102e+01 -4.88595998e-03]
 [-4.88595998e-03  1.12062087e-02]]
grads:  [-2.24961037e-03  3.44489492e+00]
Stock Position:  -0.0022496103726593886
Bond Position:  [13.68314097]


portfolio before change:  [13.44868806]
curr_Stock_Price:  111.82715424195452
curr_Factors:  [1.11827154e+02 1.34989668e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.44868806]
Stock Price:  112.74612602382199
PL:  [0.70256204]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.68932687e-01  4.23593235e-03]
 [ 2.33027724e-02 -6.37970969e-02]
 [ 6.74062412e-02  4.19646179e-02]
 [ 3.61557885e-04  3.77289363e-03]
 [-1.94707123e-01 -4.03869610e-02]
 [ 1.27419984e-01  1.31355549e-01]
 [-3.36284646e-04  8.58686991e-03]
 [ 3.16752826e-02 -1.85290573e-02]
 [ 5.92669776e-02  4.93221065e-02]
 [ 6.20257567e-02 -3.35652747e-02]
 [ 6.12360496e-02 -1.16911638e-01]
 [-1.07069446e-02  3.65217125e-02]
 [-9.58659182e-03 -6.17684412e-02]
 [ 1.18158842e-02  2.42180666e-02]
 [-5.13351492e-02 -9.44924258e-02]
 [ 1.51120309e-01 -8.05399900e-02]
 [ 7.02573675e-02 -1.49637442e-01]
 [-4.51387457e-02  3.83664890e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.95104071]
curr_Stock_Price:  97.76519305906261
curr_Factors:  [9.77651931e+01 4.01824681e-02]
mat_Sqrt:  [[ 1.95975838e+01 -8.01071561e-03]
 [-8.01071561e-03  1.83753399e-02]]
grads:  [0.00871586 0.23432234]
Stock Position:  0.008715858950428531
Bond Position:  [-2.80314834]


portfolio before change:  [-1.92913092]
curr_Stock_Price:  100.68124666034204
curr_Factors:  [1.00681247e+02 4.00723450e-02]
mat_Sqrt:  [[ 2.01544490e+01 -7.99994814e-03]
 [-7.99994814e-03  1.83500485e-02]]
grads:  [-2.23831605e-04 -3.47676942e+00]
Stock Position:  -0.00022383160549179645
Bond Position:  [-1.90659528]


portfolio before change:  [-1.93118523]
curr_Stock_Price:  99.20501828740296
curr_Factors:  [9.92050183e+01 4.30069405e-02]
mat_Sqrt:  [[ 2.05732489e+01 -8.28758868e-03]
 [-8.28758868e-03  1.90101362e-02]]
grads:  [0.00416638 2.2093028 ]
Stock Position:  0.004166382976523262
Bond Position:  [-2.34451133]


portfolio before change:  [-1.94880472]
curr_Stock_Price:  95.67989408334091
curr_Factors:  [9.56798941e+01 4.51606207e-02]
mat_Sqrt:  [[ 2.03329597e+01 -8.49227588e-03]
 [-8.49227588e-03  1.94804378e-02]]
grads:  [9.86906707e-05 1.93719041e-01]
Stock Position:  9.869067074675103e-05
Bond Position:  [-1.95824743]


portfolio before change:  [-1.95090282]
curr_Stock_Price:  99.23886216540448
curr_Factors:  [9.92388622e+01 4.35451110e-02]
mat_Sqrt:  [[ 2.07086335e+01 -8.33928376e-03]
 [-8.33928376e-03  1.91287076e-02]]
grads:  [-0.01025424 -2.11579762]
Stock Position:  -0.010254242995454538
Bond Position:  [-0.93328341]


portfolio before change:  [-1.95880653]
curr_Stock_Price:  99.89579769105372
curr_Factors:  [9.98957977e+01 4.15745210e-02]
mat_Sqrt:  [[ 2.03685827e+01 -8.14845579e-03]
 [-8.14845579e-03  1.86908501e-02]]
grads:  [0.00906877 7.03175322]
Stock Position:  0.009068766188387674
Bond Position:  [-2.86473816]


portfolio before change:  [-1.98730818]
curr_Stock_Price:  97.14807164856816
curr_Factors:  [9.71480716e+01 4.18916673e-02]
mat_Sqrt:  [[ 1.98837352e+01 -8.17926442e-03]
 [-8.17926442e-03  1.87620976e-02]]
grads:  [1.71383264e-04 4.57745817e-01]
Stock Position:  0.00017138326360042257
Bond Position:  [-2.00395773]


portfolio before change:  [-1.99037012]
curr_Stock_Price:  93.9072402565353
curr_Factors:  [9.39072403e+01 4.69146609e-02]
mat_Sqrt:  [[ 2.03401115e+01 -8.65546864e-03]
 [-8.65546864e-03  1.98552127e-02]]
grads:  [ 0.00116038 -0.93270286]
Stock Position:  0.0011603821442738099
Bond Position:  [-2.0993384]


portfolio before change:  [-1.98528796]
curr_Stock_Price:  100.54985826603252
curr_Factors:  [1.00549858e+02 4.61779089e-02]
mat_Sqrt:  [[ 2.16072034e+01 -8.58778984e-03]
 [-8.58778984e-03  1.96984506e-02]]
grads:  [0.00373873 2.50548711]
Stock Position:  0.0037387334621639015
Bond Position:  [-2.36121708]


portfolio before change:  [-1.99179363]
curr_Stock_Price:  99.5997205909125
curr_Factors:  [9.95997206e+01 4.14324010e-02]
mat_Sqrt:  [[ 2.02734722e+01 -8.13449420e-03]
 [-8.13449420e-03  1.86588857e-02]]
grads:  [ 0.00233808 -1.79787026]
Stock Position:  0.0023380795841690437
Bond Position:  [-2.22466571]


portfolio before change:  [-1.99638049]
curr_Stock_Price:  98.82802394060263
curr_Factors:  [9.88280239e+01 4.20339376e-02]
mat_Sqrt:  [[ 2.02618975e+01 -8.19327294e-03]
 [-8.19327294e-03  1.87938728e-02]]
grads:  [ 5.06848307e-04 -6.22051060e+00]
Stock Position:  0.0005068483065945519
Bond Position:  [-2.04647131]


portfolio before change:  [-1.9979653]
curr_Stock_Price:  100.75144360106377
curr_Factors:  [1.00751444e+02 4.41689083e-02]
mat_Sqrt:  [[ 2.11743251e+01 -8.39891915e-03]
 [-8.39891915e-03  1.92651821e-02]]
grads:  [2.46340631e-04 1.89584408e+00]
Stock Position:  0.00024634063113298377
Bond Position:  [-2.02278447]


portfolio before change:  [-1.99999967]
curr_Stock_Price:  102.7636412193912
curr_Factors:  [1.02763641e+02 4.35402000e-02]
mat_Sqrt:  [[ 2.14429563e+01 -8.33907746e-03]
 [-8.33907746e-03  1.91275139e-02]]
grads:  [-1.70322362e-03 -3.23004050e+00]
Stock Position:  -0.0017032236228557759
Bond Position:  [-1.82497021]


portfolio before change:  [-2.00072253]
curr_Stock_Price:  101.84785927683232
curr_Factors:  [1.01847859e+02 4.28845566e-02]
mat_Sqrt:  [[ 2.10912507e+01 -8.27598662e-03]
 [-8.27598662e-03  1.89829822e-02]]
grads:  [1.06101020e-03 1.27624034e+00]
Stock Position:  0.001061010201829368
Bond Position:  [-2.10878415]


portfolio before change:  [-2.00328251]
curr_Stock_Price:  101.92104736863492
curr_Factors:  [1.01921047e+02 4.04878821e-02]
mat_Sqrt:  [[ 2.05081448e+01 -8.04140856e-03]
 [-8.04140856e-03  1.84449063e-02]]
grads:  [-4.51268242e-03 -5.12492243e+00]
Stock Position:  -0.00451268241738058
Bond Position:  [-1.54334519]


portfolio before change:  [-2.03936687]
curr_Stock_Price:  109.48948863787257
curr_Factors:  [1.09489489e+02 4.06929048e-02]
mat_Sqrt:  [[ 2.20867464e+01 -8.06224369e-03]
 [-8.06224369e-03  1.84913297e-02]]
grads:  [ 0.00525307 -4.35326392]
Stock Position:  0.005253070435266866
Bond Position:  [-2.61452286]


portfolio before change:  [-2.03174223]
curr_Stock_Price:  111.56348289325759
curr_Factors:  [1.11563483e+02 4.23645590e-02]
mat_Sqrt:  [[ 2.29627227e+01 -8.22630247e-03]
 [-8.22630247e-03  1.88672610e-02]]
grads:  [ 2.18389817e-04 -7.93096813e+00]
Stock Position:  0.00021838981658765818
Bond Position:  [-2.05610655]


portfolio before change:  [-2.03465297]
curr_Stock_Price:  110.01121161436718
curr_Factors:  [1.10011212e+02 4.40210968e-02]
mat_Sqrt:  [[ 2.30816764e+01 -8.38549544e-03]
 [-8.38549544e-03  1.92326398e-02]]
grads:  [-1.23107734e-03  1.99432663e+00]
Stock Position:  -0.001231077338549339
Bond Position:  [-1.89922066]


portfolio before change:  [-2.03655407]
curr_Stock_Price:  109.62585036668317
curr_Factors:  [1.09625850e+02 4.84208252e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.03655407]
Stock Price:  105.71897341435823
PL:  [-7.75552748]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 8.08828712e-03 -4.95084949e-02]
 [-1.04883012e-01 -1.64568756e-01]
 [ 6.44688853e-02 -1.55363545e-01]
 [-1.48602182e-02 -4.46924042e-03]
 [-1.32936222e-01 -6.41775807e-02]
 [ 1.27252440e-01  1.25712419e-01]
 [ 2.70351240e-02  4.55870183e-02]
 [-2.43064063e-01  6.67359372e-02]
 [-2.50632795e-03 -6.98357201e-03]
 [ 5.30332780e-02  3.04492400e-02]
 [ 5.91784687e-02 -1.12006545e-01]
 [-1.07045576e-02  3.66689774e-02]
 [-2.13262360e-02 -7.86382231e-02]
 [ 6.21773809e-03  1.36693014e-01]
 [-6.73247738e-02 -6.84692511e-02]
 [ 8.39319019e-02 -5.35943941e-02]
 [-7.71985978e-02  1.14753270e-01]
 [ 1.07811079e-01 -9.34207048e-02]
 [ 1.34494645e-01  7.55624052e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.84819891]
curr_Stock_Price:  103.05725010279838
curr_Factors:  [1.03057250e+02 3.74899328e-02]
mat_Sqrt:  [[ 1.99542702e+01 -7.73804465e-03]
 [-7.73804465e-03  1.77488589e-02]]
grads:  [-6.76467825e-04 -2.78968523e+00]
Stock Position:  -0.0006764678248049207
Bond Position:  [17.91791382]


portfolio before change:  [17.86807383]
curr_Stock_Price:  106.80683523299157
curr_Factors:  [1.06806835e+02 3.81278050e-02]
mat_Sqrt:  [[ 2.08554670e+01 -7.80383992e-03]
 [-7.80383992e-03  1.78991098e-02]]
grads:  [-8.47078754e-03 -9.19793566e+00]
Stock Position:  -0.008470787542412688
Bond Position:  [18.77281184]


portfolio before change:  [17.92474846]
curr_Stock_Price:  102.88819798668675
curr_Factors:  [1.02888198e+02 3.86449406e-02]
mat_Sqrt:  [[ 2.02260860e+01 -7.85632767e-03]
 [-7.85632767e-03  1.80201976e-02]]
grads:  [-1.61477028e-04 -8.62170424e+00]
Stock Position:  -0.00016147702825168646
Bond Position:  [17.94136254]


portfolio before change:  [17.9476]
curr_Stock_Price:  100.34406053372633
curr_Factors:  [1.00344061e+02 4.08811902e-02]
mat_Sqrt:  [[ 2.02886618e+01 -8.08025805e-03]
 [-8.08025805e-03  1.85343285e-02]]
grads:  [-0.00082862 -0.24149436]
Stock Position:  -0.00082861823088331
Bond Position:  [18.03074692]


portfolio before change:  [17.97005481]
curr_Stock_Price:  100.46198741714171
curr_Factors:  [1.00461987e+02 4.47897256e-02]
mat_Sqrt:  [[ 2.12613546e+01 -8.45771665e-03]
 [-8.45771665e-03  1.94001104e-02]]
grads:  [-0.00756975 -3.31140401]
Stock Position:  -0.00756974995925511
Bond Position:  [18.73052694]


portfolio before change:  [17.98908649]
curr_Stock_Price:  101.04273568183251
curr_Factors:  [1.01042736e+02 4.21043512e-02]
mat_Sqrt:  [[ 2.07333057e+01 -8.20029915e-03]
 [-8.20029915e-03  1.88095350e-02]]
grads:  [0.00878249 6.68726994]
Stock Position:  0.008782490177801191
Bond Position:  [17.10167966]


portfolio before change:  [17.99488207]
curr_Stock_Price:  99.26705610836997
curr_Factors:  [9.92670561e+01 4.09688322e-02]
mat_Sqrt:  [[ 2.00924039e+01 -8.08883464e-03]
 [-8.08883464e-03  1.85542199e-02]]
grads:  [2.33507748e-03 2.45798026e+00]
Stock Position:  0.002335077478676787
Bond Position:  [17.7630858]


portfolio before change:  [18.0266822]
curr_Stock_Price:  103.37072678465515
curr_Factors:  [1.03370727e+02 4.03212221e-02]
mat_Sqrt:  [[ 2.07569902e+01 -8.02494223e-03]
 [-8.02494223e-03  1.84068608e-02]]
grads:  [-0.01031002  3.62110632]
Stock Position:  -0.010310015630193363
Bond Position:  [19.09243601]


portfolio before change:  [18.12515855]
curr_Stock_Price:  96.13544367737859
curr_Factors:  [9.61354437e+01 4.25120208e-02]
mat_Sqrt:  [[ 1.98216303e+01 -8.23952143e-03]
 [-8.23952143e-03  1.89005422e-02]]
grads:  [-2.80085913e-04 -3.69612666e-01]
Stock Position:  -0.0002800859134420424
Bond Position:  [18.15208473]


portfolio before change:  [18.14765441]
curr_Stock_Price:  96.87960376027692
curr_Factors:  [9.68796038e+01 3.82406397e-02]
mat_Sqrt:  [[ 1.89450123e+01 -7.81469198e-03]
 [-7.81469198e-03  1.79258748e-02]]
grads:  [0.00350063 1.70014556]
Stock Position:  0.003500625434098135
Bond Position:  [17.80851521]


portfolio before change:  [18.16629478]
curr_Stock_Price:  95.84144704451164
curr_Factors:  [9.5841447e+01 3.7456115e-02]
mat_Sqrt:  [[ 1.85487518e+01 -7.73403635e-03]
 [-7.73403635e-03  1.77410775e-02]]
grads:  [ 5.58111620e-04 -6.31315818e+00]
Stock Position:  0.000558111619705749
Bond Position:  [18.11280455]


portfolio before change:  [18.19164419]
curr_Stock_Price:  100.66889348057204
curr_Factors:  [1.00668893e+02 3.66772962e-02]
mat_Sqrt:  [[ 1.92794179e+01 -7.65355840e-03]
 [-7.65355840e-03  1.75555121e-02]]
grads:  [2.74006399e-04 2.08886384e+00]
Stock Position:  0.0002740063990098495
Bond Position:  [18.16406027]


portfolio before change:  [18.21480989]
curr_Stock_Price:  102.29814273274029
curr_Factors:  [1.02298143e+02 3.72553289e-02]
mat_Sqrt:  [[ 1.97452173e+01 -7.71374429e-03]
 [-7.71374429e-03  1.76932597e-02]]
grads:  [-2.81686831e-03 -4.44575805e+00]
Stock Position:  -0.0028168683112753693
Bond Position:  [18.50297029]


portfolio before change:  [18.25144525]
curr_Stock_Price:  97.50836256754886
curr_Factors:  [9.75083626e+01 3.68513909e-02]
mat_Sqrt:  [[ 1.87184020e+01 -7.67147511e-03]
 [-7.67147511e-03  1.75972264e-02]]
grads:  [3.51635464e-03 7.76940558e+00]
Stock Position:  0.0035163546400735165
Bond Position:  [17.90857126]


portfolio before change:  [18.27509705]
curr_Stock_Price:  97.86444064167729
curr_Factors:  [9.78644406e+01 4.13656238e-02]
mat_Sqrt:  [[ 1.99041974e+01 -8.12780379e-03]
 [-8.12780379e-03  1.86439010e-02]]
grads:  [-0.00488295 -3.67460323]
Stock Position:  -0.004882951359163003
Bond Position:  [18.75296436]


portfolio before change:  [18.29635488]
curr_Stock_Price:  98.3145862546246
curr_Factors:  [9.83145863e+01 4.49251616e-02]
mat_Sqrt:  [[ 2.08383220e+01 -8.47032564e-03]
 [-8.47032564e-03  1.94294930e-02]]
grads:  [ 0.00290705 -2.75713681]
Stock Position:  0.002907050550144523
Bond Position:  [18.0105494]


portfolio before change:  [18.29331948]
curr_Stock_Price:  89.52125537659457
curr_Factors:  [8.95212554e+01 4.52176111e-02]
mat_Sqrt:  [[ 1.90361855e+01 -8.49707308e-03]
 [-8.49707308e-03  1.94929695e-02]]
grads:  [-1.42793420e-03  5.88628309e+00]
Stock Position:  -0.0014279341976030223
Bond Position:  [18.42114994]


portfolio before change:  [18.31591002]
curr_Stock_Price:  89.83660270396601
curr_Factors:  [8.98366027e+01 4.44625861e-02]
mat_Sqrt:  [[ 1.89430819e+01 -8.42586440e-03]
 [-8.42586440e-03  1.93295285e-02]]
grads:  [ 3.54226465e-03 -4.83151249e+00]
Stock Position:  0.003542264653514147
Bond Position:  [17.997685]


portfolio before change:  [18.34990059]
curr_Stock_Price:  93.07729712265481
curr_Factors:  [9.30772971e+01 4.56473300e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.34990059]
Stock Price:  96.51030806491126
PL:  [18.34990059]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.65684212e-01  3.12100156e-03]
 [ 2.33027724e-02 -6.37970969e-02]
 [-2.58245153e-01 -1.87308931e-01]
 [-2.42915297e-02 -2.96094628e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.27783920e-01  1.23078890e-01]
 [-3.37748106e-02 -3.63846121e-02]
 [-2.25573735e-01  6.94408427e-02]
 [ 7.12567216e-02  6.26498211e-02]
 [ 6.18002811e-02 -4.17952466e-02]
 [ 6.20160007e-02 -1.19801761e-01]
 [ 9.55620436e-02  2.24259502e-02]
 [ 2.47632634e-02  9.33638047e-02]
 [-1.20002202e-02 -1.99985144e-01]
 [-3.33397304e-02 -9.48939821e-02]
 [ 1.79998015e-01 -1.16011061e-01]
 [ 7.21479655e-02 -1.49971906e-01]
 [-6.92985659e-02  4.08431313e-02]
 [-9.74706987e-02 -9.79683588e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.13522093]
curr_Stock_Price:  97.44867841556022
curr_Factors:  [9.74486784e+01 4.42337220e-02]
mat_Sqrt:  [[ 2.04952235e+01 -8.40482026e-03]
 [-8.40482026e-03  1.92794247e-02]]
grads:  [0.00815188 0.1654363 ]
Stock Position:  0.008151883489667132
Bond Position:  [-3.9296112]


portfolio before change:  [-3.11211592]
curr_Stock_Price:  100.88593262873573
curr_Factors:  [1.00885933e+02 4.38501182e-02]
mat_Sqrt:  [[ 2.11259362e+01 -8.36856470e-03]
 [-8.36856470e-03  1.91955283e-02]]
grads:  [-2.13541410e-04 -3.32363262e+00]
Stock Position:  -0.00021354140978683417
Bond Position:  [-3.09057259]


portfolio before change:  [-3.11738724]
curr_Stock_Price:  107.4687123911905
curr_Factors:  [1.07468712e+02 4.35816801e-02]
mat_Sqrt:  [[ 2.24354094e+01 -8.34337432e-03]
 [-8.34337432e-03  1.91364810e-02]]
grads:  [-0.01515309 -9.79466176]
Stock Position:  -0.015153085724226722
Bond Position:  [-1.48890463]


portfolio before change:  [-3.10589734]
curr_Stock_Price:  106.58755881561228
curr_Factors:  [1.06587559e+02 4.48107259e-02]
mat_Sqrt:  [[ 2.25630328e+01 -8.46014242e-03]
 [-8.46014242e-03  1.94044647e-02]]
grads:  [-0.00164903 -1.52662876]
Stock Position:  -0.001649025942443407
Bond Position:  [-2.93013169]


portfolio before change:  [-3.10756034]
curr_Stock_Price:  105.37353300994363
curr_Factors:  [1.05373533e+02 4.37867834e-02]
mat_Sqrt:  [[ 2.20497176e+01 -8.36284228e-03]
 [-8.36284228e-03  1.91815198e-02]]
grads:  [ 0.00743674 -6.15424265]
Stock Position:  0.0074367401829486144
Bond Position:  [-3.89119592]


portfolio before change:  [-3.16082782]
curr_Stock_Price:  98.86524451023354
curr_Factors:  [9.88652445e+01 4.84704865e-02]
mat_Sqrt:  [[ 2.17661841e+01 -8.79824853e-03]
 [-8.79824853e-03  2.01815680e-02]]
grads:  [0.00833737 6.10221389]
Stock Position:  0.008337369280094093
Bond Position:  [-3.98510388]


portfolio before change:  [-3.18969624]
curr_Stock_Price:  96.00056107828976
curr_Factors:  [9.60005611e+01 5.06896996e-02]
mat_Sqrt:  [[ 2.16139226e+01 -8.99715890e-03]
 [-8.99715890e-03  2.06385108e-02]]
grads:  [-0.00229691 -1.76394887]
Stock Position:  -0.0022969148057206054
Bond Position:  [-2.96919113]


portfolio before change:  [-3.20930085]
curr_Stock_Price:  102.91888591682518
curr_Factors:  [1.02918886e+02 4.81577613e-02]
mat_Sqrt:  [[ 2.25854209e+01 -8.77014002e-03]
 [-8.77014002e-03  2.01162188e-02]]
grads:  [-0.00864861  3.44821231]
Stock Position:  -0.008648607052978832
Bond Position:  [-2.31919585]


portfolio before change:  [-3.20441391]
curr_Stock_Price:  102.01842284133977
curr_Factors:  [1.02018423e+02 5.07074955e-02]
mat_Sqrt:  [[ 2.29728381e+01 -8.99924450e-03]
 [-8.99924450e-03  2.06419126e-02]]
grads:  [0.00429146 3.03694926]
Stock Position:  0.0042914580205093925
Bond Position:  [-3.64222169]


portfolio before change:  [-3.19336629]
curr_Stock_Price:  105.65430691606747
curr_Factors:  [1.05654307e+02 4.91704952e-02]
mat_Sqrt:  [[ 2.34282293e+01 -8.86208026e-03]
 [-8.86208026e-03  2.03265463e-02]]
grads:  [ 1.86037730e-03 -2.05537916e+00]
Stock Position:  0.0018603773025517203
Bond Position:  [-3.38992317]


portfolio before change:  [-3.20313975]
curr_Stock_Price:  102.67996268934264
curr_Factors:  [1.02679963e+02 5.30606813e-02]
mat_Sqrt:  [[ 2.36522293e+01 -9.20574401e-03]
 [-9.20574401e-03  2.11154231e-02]]
grads:  [ 4.13803994e-04 -5.67348101e+00]
Stock Position:  0.00041380399411430126
Bond Position:  [-3.24562913]


portfolio before change:  [-3.20410158]
curr_Stock_Price:  110.16595988879719
curr_Factors:  [1.10165960e+02 4.26569279e-02]
mat_Sqrt:  [[ 2.27531842e+01 -8.25455363e-03]
 [-8.25455363e-03  1.89322905e-02]]
grads:  [0.00463041 1.18655332]
Stock Position:  0.004630407370288071
Bond Position:  [-3.71421486]


portfolio before change:  [-3.19893619]
curr_Stock_Price:  112.2847935555397
curr_Factors:  [1.12284794e+02 4.28590090e-02]
mat_Sqrt:  [[ 2.32456653e+01 -8.27421271e-03]
 [-8.27421271e-03  1.89770254e-02]]
grads:  [2.81691979e-03 4.92106167e+00]
Stock Position:  0.0028169197893743608
Bond Position:  [-3.51523345]


portfolio before change:  [-3.2050831]
curr_Stock_Price:  111.66350663149247
curr_Factors:  [1.11663507e+02 4.28034939e-02]
mat_Sqrt:  [[ 2.31020673e+01 -8.26881467e-03]
 [-8.26881467e-03  1.89647474e-02]]
grads:  [-4.29447173e-03 -1.05469717e+01]
Stock Position:  -0.004294471731936838
Bond Position:  [-2.72554732]


portfolio before change:  [-3.20771883]
curr_Stock_Price:  111.48343019102145
curr_Factors:  [1.1148343e+02 3.8444023e-02]
mat_Sqrt:  [[ 2.18587191e+01 -7.83641608e-03]
 [-7.83641608e-03  1.79730580e-02]]
grads:  [-3.41859220e-03 -5.28128111e+00]
Stock Position:  -0.0034185921991937585
Bond Position:  [-2.82660244]


portfolio before change:  [-3.21989233]
curr_Stock_Price:  114.0102116356988
curr_Factors:  [1.14010212e+02 3.80457297e-02]
mat_Sqrt:  [[ 2.22380491e+01 -7.79585836e-03]
 [-7.79585836e-03  1.78796502e-02]]
grads:  [ 5.82042200e-03 -6.48590351e+00]
Stock Position:  0.00582042199692169
Bond Position:  [-3.88347987]


portfolio before change:  [-3.23895697]
curr_Stock_Price:  111.56927836954605
curr_Factors:  [1.11569278e+02 3.87981572e-02]
mat_Sqrt:  [[ 2.19760758e+01 -7.87243161e-03]
 [-7.87243161e-03  1.80556471e-02]]
grads:  [ 3.07600996e-04 -8.30596008e+00]
Stock Position:  0.00030760099551987383
Bond Position:  [-3.27327579]


portfolio before change:  [-3.24237687]
curr_Stock_Price:  113.7612582455347
curr_Factors:  [1.13761258e+02 3.97089829e-02]
mat_Sqrt:  [[ 2.26693330e+01 -7.96442815e-03]
 [-7.96442815e-03  1.82662999e-02]]
grads:  [-0.00227171  2.23499223]
Stock Position:  -0.0022717091376239958
Bond Position:  [-2.98394438]


portfolio before change:  [-3.2513119]
curr_Stock_Price:  116.05150224908621
curr_Factors:  [1.16051502e+02 3.83974185e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.2513119]
Stock Price:  122.25979711644055
PL:  [-25.51110902]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.48616996e-01 -8.04610803e-03]
 [-6.89907609e-02  6.90585431e-02]
 [ 5.38961517e-02  8.21205980e-02]
 [-1.69895694e-02 -9.76233575e-03]
 [-1.77656808e-01 -4.83530663e-02]
 [ 5.86284946e-02 -3.15221088e-02]
 [-7.17807646e-02 -8.74944140e-02]
 [ 3.27261277e-02 -1.39680695e-02]
 [-5.03632011e-02 -4.43862885e-02]
 [ 4.59232851e-02  7.80202890e-02]
 [ 5.87248897e-02 -1.10760481e-01]
 [-9.33938612e-03  2.43525364e-02]
 [-1.07321234e-01 -1.40515385e-01]
 [ 3.76659056e-03  1.63938512e-01]
 [-6.20738467e-02 -8.19580811e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 5.01812641e-02 -1.48645541e-01]
 [-4.36256991e-02  3.82344054e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.45472262]
curr_Stock_Price:  95.75956488832055
curr_Factors:  [9.57595649e+01 4.35173844e-02]
mat_Sqrt:  [[ 1.99762295e+01 -8.33634886e-03]
 [-8.33634886e-03  1.91227386e-02]]
grads:  [ 0.00726542 -0.417594  ]
Stock Position:  0.007265424466141077
Bond Position:  [-10.15045651]


portfolio before change:  [-9.47483703]
curr_Stock_Price:  94.73850981686174
curr_Factors:  [9.47385098e+01 3.58457190e-02]
mat_Sqrt:  [[ 1.79368080e+01 -7.56586626e-03]
 [-7.56586626e-03  1.73555426e-02]]
grads:  [-2.16833256e-03  3.97810311e+00]
Stock Position:  -0.0021683325641876166
Bond Position:  [-9.26941243]


portfolio before change:  [-9.48777185]
curr_Stock_Price:  95.35687324180283
curr_Factors:  [9.53568732e+01 3.89817432e-02]
mat_Sqrt:  [[ 1.88270637e+01 -7.88993387e-03]
 [-7.88993387e-03  1.80987949e-02]]
grads:  [0.00476505 4.53942898]
Stock Position:  0.004765052458954627
Bond Position:  [-9.94215236]


portfolio before change:  [-9.47203876]
curr_Stock_Price:  101.26836197547948
curr_Factors:  [1.01268362e+02 3.63482989e-02]
mat_Sqrt:  [[ 1.93070445e+01 -7.61919570e-03]
 [-7.61919570e-03  1.74765799e-02]]
grads:  [-0.0011006  -0.55907514]
Stock Position:  -0.0011005968508711569
Bond Position:  [-9.36058312]


portfolio before change:  [-9.48195382]
curr_Stock_Price:  99.63926100693138
curr_Factors:  [9.96392610e+01 3.79560972e-02]
mat_Sqrt:  [[ 1.94120427e+01 -7.78576761e-03]
 [-7.78576761e-03  1.78589696e-02]]
grads:  [-0.0102396  -2.71195878]
Stock Position:  -0.010239596712945437
Bond Position:  [-8.46168797]


portfolio before change:  [-9.43750933]
curr_Stock_Price:  94.2652005863542
curr_Factors:  [9.42652006e+01 4.13220452e-02]
mat_Sqrt:  [[ 1.91620629e+01 -8.12323110e-03]
 [-8.12323110e-03  1.86342043e-02]]
grads:  [ 0.00234293 -1.69060488]
Stock Position:  0.002342927309777842
Bond Position:  [-9.65836585]


portfolio before change:  [-9.44855064]
curr_Stock_Price:  94.70874947612376
curr_Factors:  [9.47087495e+01 3.71864037e-02]
mat_Sqrt:  [[ 1.82634220e+01 -7.70605262e-03]
 [-7.70605262e-03  1.76771262e-02]]
grads:  [-0.00601983 -4.95220786]
Stock Position:  -0.006019832379644697
Bond Position:  [-8.87841984]


portfolio before change:  [-9.42778927]
curr_Stock_Price:  89.41519218377762
curr_Factors:  [8.94151922e+01 3.48505790e-02]
mat_Sqrt:  [[ 1.66923034e+01 -7.45967691e-03]
 [-7.45967691e-03  1.71131239e-02]]
grads:  [ 0.0015961  -0.81552399]
Stock Position:  0.0015960998051489494
Bond Position:  [-9.57050484]


portfolio before change:  [-9.43373801]
curr_Stock_Price:  93.18806264602853
curr_Factors:  [9.31880626e+01 3.38613195e-02]
mat_Sqrt:  [[ 1.71479489e+01 -7.35334541e-03]
 [-7.35334541e-03  1.68683581e-02]]
grads:  [-0.0040661  -2.63310677]
Stock Position:  -0.004066104047885871
Bond Position:  [-9.05482565]


portfolio before change:  [-9.4557472]
curr_Stock_Price:  95.81553663501488
curr_Factors:  [9.58155366e+01 3.51826556e-02]
mat_Sqrt:  [[ 1.79721571e+01 -7.49564552e-03]
 [-7.49564552e-03  1.71942390e-02]]
grads:  [4.44854424e-03 4.53952244e+00]
Stock Position:  0.004448544243603625
Bond Position:  [-9.88198685]


portfolio before change:  [-9.47762972]
curr_Stock_Price:  93.67498950829784
curr_Factors:  [9.36749895e+01 3.93371436e-02]
mat_Sqrt:  [[ 1.85791150e+01 -7.92568224e-03]
 [-7.92568224e-03  1.81811715e-02]]
grads:  [ 5.62095315e-04 -6.09179811e+00]
Stock Position:  0.0005620953148294217
Bond Position:  [-9.530284]


portfolio before change:  [-9.48859877]
curr_Stock_Price:  95.36732898366206
curr_Factors:  [9.53673290e+01 3.96184927e-02]
mat_Sqrt:  [[ 1.89822879e+01 -7.95411297e-03]
 [-7.95411297e-03  1.82460136e-02]]
grads:  [6.72742670e-05 1.33470642e+00]
Stock Position:  6.727426696010751e-05
Bond Position:  [-9.49501454]


portfolio before change:  [-9.50053385]
curr_Stock_Price:  94.49195937620736
curr_Factors:  [9.44919594e+01 3.52958433e-02]
mat_Sqrt:  [[ 1.77523805e+01 -7.50759261e-03]
 [-7.50759261e-03  1.72219188e-02]]
grads:  [-0.00949774 -8.16324199]
Stock Position:  -0.009497741973705877
Bond Position:  [-8.6030736]


portfolio before change:  [-9.51759628]
curr_Stock_Price:  95.15547129673662
curr_Factors:  [9.51554713e+01 3.26528357e-02]
mat_Sqrt:  [[ 1.71946832e+01 -7.22108245e-03]
 [-7.22108245e-03  1.65645503e-02]]
grads:  [4.37618139e-03 9.89885692e+00]
Stock Position:  0.004376181390097926
Bond Position:  [-9.93401388]


portfolio before change:  [-9.51282271]
curr_Stock_Price:  99.0855775630883
curr_Factors:  [9.90855776e+01 3.36946065e-02]
mat_Sqrt:  [[ 1.8188237e+01 -7.3356504e-03]
 [-7.3356504e-03  1.6826595e-02]]
grads:  [-0.00537826 -4.87309133]
Stock Position:  -0.005378264043759663
Bond Position:  [-8.97991431]


portfolio before change:  [-9.5452896]
curr_Stock_Price:  103.03387363810262
curr_Factors:  [1.03033874e+02 3.37461745e-02]
mat_Sqrt:  [[ 1.89274570e+01 -7.34152170e-03]
 [-7.34152170e-03  1.68393528e-02]]
grads:  [ 0.00574049 -3.62255016]
Stock Position:  0.005740487652187502
Bond Position:  [-10.13675427]


portfolio before change:  [-9.53315824]
curr_Stock_Price:  107.3558438310692
curr_Factors:  [1.07355844e+02 3.03976128e-02]
mat_Sqrt:  [[ 1.87173947e+01 -6.96801527e-03]
 [-6.96801527e-03  1.59819552e-02]]
grads:  [-7.81597893e-04 -9.30117656e+00]
Stock Position:  -0.000781597892662413
Bond Position:  [-9.44924914]


portfolio before change:  [-9.54688484]
curr_Stock_Price:  109.79655361904058
curr_Factors:  [1.09796554e+02 2.74045505e-02]
mat_Sqrt:  [[ 1.81760715e+01 -6.61620469e-03]
 [-6.61620469e-03  1.51746941e-02]]
grads:  [-1.48325128e-03  2.51896952e+00]
Stock Position:  -0.0014832512760653302
Bond Position:  [-9.38402897]


portfolio before change:  [-9.55743211]
curr_Stock_Price:  108.9941921336813
curr_Factors:  [1.08994192e+02 2.37622160e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.55743211]
Stock Price:  108.30894491946869
PL:  [-17.86637703]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.66415085e-01  3.37927014e-03]
 [ 4.26053147e-02 -1.26476048e-02]
 [ 6.48592318e-02  4.95351001e-02]
 [ 2.57508665e-02  2.31145216e-02]
 [ 1.64081209e-01  2.29918327e-02]
 [ 7.24935097e-02  1.81199878e-03]
 [ 1.58074006e-02  3.02987332e-02]
 [-4.16951371e-02  9.78443124e-02]
 [ 2.26059722e-02  1.40798317e-02]
 [ 5.29737973e-02  3.07541107e-02]
 [ 5.87258045e-02 -1.10762995e-01]
 [-7.85286789e-03  1.93543013e-02]
 [-1.20804033e-01 -1.38417433e-01]
 [ 3.24210311e-03  1.63248792e-01]
 [-9.92274873e-02  5.73316594e-02]
 [-6.89269724e-02  2.27697058e-02]
 [-7.41483761e-02  1.05151033e-01]
 [ 9.88525195e-02 -1.08333449e-01]
 [ 7.78166312e-02  5.78134843e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.85021884]
curr_Stock_Price:  97.52485544655438
curr_Factors:  [9.75248554e+01 4.07584602e-02]
mat_Sqrt:  [[ 1.96890229e+01 -8.06790715e-03]
 [-8.06790715e-03  1.85065793e-02]]
grads:  [0.00852852 0.1863163 ]
Stock Position:  0.008528522177975917
Bond Position:  [-3.68196173]


portfolio before change:  [-2.84481531]
curr_Stock_Price:  98.69843075906293
curr_Factors:  [9.86984308e+01 4.24209418e-02]
mat_Sqrt:  [[ 2.03282674e+01 -8.23089401e-03]
 [-8.23089401e-03  1.88801960e-02]]
grads:  [ 0.00182495 -0.66909177]
Stock Position:  0.0018249509660829375
Bond Position:  [-3.02493511]


portfolio before change:  [-2.8489983]
curr_Stock_Price:  98.47954182607243
curr_Factors:  [9.84795418e+01 4.20409590e-02]
mat_Sqrt:  [[ 2.01921373e+01 -8.19393035e-03]
 [-8.19393035e-03  1.87954541e-02]]
grads:  [0.00428233 2.63734991]
Stock Position:  0.004282334850112748
Bond Position:  [-3.27072068]


portfolio before change:  [-2.86026121]
curr_Stock_Price:  96.8047666263207
curr_Factors:  [9.68047666e+01 4.21976628e-02]
mat_Sqrt:  [[ 1.98857009e+01 -8.20905512e-03]
 [-8.20905512e-03  1.88305083e-02]]
grads:  [0.001802   1.22828943]
Stock Position:  0.001801996433609872
Bond Position:  [-3.03470305]


portfolio before change:  [-2.87159332]
curr_Stock_Price:  92.62253603488415
curr_Factors:  [9.26225360e+01 4.38564627e-02]
mat_Sqrt:  [[ 1.93969492e+01 -8.36849232e-03]
 [-8.36849232e-03  1.91972124e-02]]
grads:  [0.00897753 1.20157868]
Stock Position:  0.008977525755139477
Bond Position:  [-3.70311453]


portfolio before change:  [-2.85293412]
curr_Stock_Price:  95.21690295061968
curr_Factors:  [9.52169030e+01 3.98578945e-02]
mat_Sqrt:  [[ 1.90095217e+01 -7.97809674e-03]
 [-7.97809674e-03  1.83010633e-02]]
grads:  [0.0038558  0.10069146]
Stock Position:  0.0038557959050108483
Bond Position:  [-3.22007106]


portfolio before change:  [-2.84737705]
curr_Stock_Price:  97.7026858906001
curr_Factors:  [9.77026859e+01 3.64895403e-02]
mat_Sqrt:  [[ 1.86633956e+01 -7.63373264e-03]
 [-7.63373264e-03  1.75106119e-02]]
grads:  [1.55498370e-03 1.73098483e+00]
Stock Position:  0.0015549836973405221
Bond Position:  [-2.99930313]


portfolio before change:  [-2.84684449]
curr_Stock_Price:  100.45772024524831
curr_Factors:  [1.00457720e+02 3.54133811e-02]
mat_Sqrt:  [[ 1.89045777e+01 -7.52051550e-03]
 [-7.52051550e-03  1.72503814e-02]]
grads:  [5.08585050e-05 5.67203082e+00]
Stock Position:  5.085850503718859e-05
Bond Position:  [-2.85195362]


portfolio before change:  [-2.85057142]
curr_Stock_Price:  97.3164906328887
curr_Factors:  [9.73164906e+01 4.34480731e-02]
mat_Sqrt:  [[ 2.02848436e+01 -8.32983491e-03]
 [-8.32983491e-03  1.91074483e-02]]
grads:  [0.00141727 0.73749447]
Stock Position:  0.0014172738986148264
Bond Position:  [-2.98849554]


portfolio before change:  [-2.8549462]
curr_Stock_Price:  96.86715869298729
curr_Factors:  [9.68671587e+01 4.19869258e-02]
mat_Sqrt:  [[ 1.98487683e+01 -8.18853627e-03]
 [-8.18853627e-03  1.87834271e-02]]
grads:  [0.00334493 1.6387585 ]
Stock Position:  0.0033449345373559075
Bond Position:  [-3.17896051]


portfolio before change:  [-2.86947222]
curr_Stock_Price:  93.71318657927337
curr_Factors:  [9.37131866e+01 5.01158998e-02]
mat_Sqrt:  [[ 2.09791763e+01 -8.94588242e-03]
 [-8.94588242e-03  2.05214567e-02]]
grads:  [ 4.97780699e-04 -5.39720659e+00]
Stock Position:  0.0004977806988749288
Bond Position:  [-2.91612083]


portfolio before change:  [-2.87247047]
curr_Stock_Price:  95.01733609512642
curr_Factors:  [9.50173361e+01 4.73765146e-02]
mat_Sqrt:  [[ 2.06816110e+01 -8.69806799e-03]
 [-8.69806799e-03  1.99526630e-02]]
grads:  [2.82599050e-05 9.70023258e-01]
Stock Position:  2.8259905035877633e-05
Bond Position:  [-2.87515565]


portfolio before change:  [-2.87613704]
curr_Stock_Price:  92.52665724581793
curr_Factors:  [9.25266572e+01 5.44409687e-02]
mat_Sqrt:  [[ 2.15888622e+01 -9.32379892e-03]
 [-9.32379892e-03  2.13886994e-02]]
grads:  [-0.00839217 -6.47518009]
Stock Position:  -0.008392165755629098
Bond Position:  [-2.099638]


portfolio before change:  [-2.86297706]
curr_Stock_Price:  90.64559654813417
curr_Factors:  [9.06455965e+01 5.87914625e-02]
mat_Sqrt:  [[ 2.19787911e+01 -9.68898289e-03]
 [-9.68898289e-03  2.22269709e-02]]
grads:  [3.38591693e-03 7.34610213e+00]
Stock Position:  0.0033859169349668137
Bond Position:  [-3.16989552]


portfolio before change:  [-2.87140849]
curr_Stock_Price:  89.32643099490882
curr_Factors:  [8.93264310e+01 5.64919082e-02]
mat_Sqrt:  [[ 2.12311276e+01 -9.49746496e-03]
 [-9.49746496e-03  2.17880068e-02]]
grads:  [-0.00349727  2.62981578]
Stock Position:  -0.0034972661502378492
Bond Position:  [-2.55901019]


portfolio before change:  [-2.87911903]
curr_Stock_Price:  90.61594558457749
curr_Factors:  [9.06159456e+01 5.77945396e-02]
mat_Sqrt:  [[ 2.17845197e+01 -9.60648077e-03]
 [-9.60648077e-03  2.20377159e-02]]
grads:  [-0.00270893  1.03203447]
Stock Position:  -0.0027089306500157166
Bond Position:  [-2.63364672]


portfolio before change:  [-2.88125257]
curr_Stock_Price:  90.18751974300032
curr_Factors:  [9.01875197e+01 5.98056391e-02]
mat_Sqrt:  [[ 2.20555285e+01 -9.77214486e-03]
 [-9.77214486e-03  2.24178852e-02]]
grads:  [-1.28392411e-03  4.68993777e+00]
Stock Position:  -0.0012839241100655184
Bond Position:  [-2.76545864]


portfolio before change:  [-2.88237082]
curr_Stock_Price:  88.36440996336756
curr_Factors:  [8.83644100e+01 6.08545895e-02]
mat_Sqrt:  [[ 2.17983693e+01 -9.85726425e-03]
 [-9.85726425e-03  2.26137179e-02]]
grads:  [ 2.36900352e-03 -4.78957494e+00]
Stock Position:  0.0023690035215736343
Bond Position:  [-3.09170642]


portfolio before change:  [-2.88752616]
curr_Stock_Price:  87.82059941362115
curr_Factors:  [8.78205994e+01 6.12649248e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.88752616]
Stock Price:  85.27635619458574
PL:  [-2.88752616]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.28932506e-02 -4.72281478e-02]
 [-7.00190612e-03 -1.00233344e-01]
 [ 6.51271143e-02 -1.50965876e-01]
 [-1.70825342e-02 -1.00150192e-02]
 [ 2.13099861e-01 -1.17771450e-01]
 [ 1.26750426e-01  1.06412242e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-2.98981705e-01  4.88494458e-02]
 [ 6.44439294e-02  5.39510454e-02]
 [ 6.16033705e-02 -4.01685954e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 8.79695339e-02  2.34642014e-02]
 [ 2.34793462e-02  1.00274478e-01]
 [-8.15446411e-03 -2.00396778e-01]
 [-1.32631616e-02 -1.05964046e-01]
 [ 1.87729848e-01 -1.25508228e-01]
 [ 1.34084278e-01 -1.50117956e-01]
 [-1.18692608e-01  4.59057800e-02]
 [-1.08496404e-01 -1.20169213e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.43177582]
curr_Stock_Price:  103.21323196694779
curr_Factors:  [1.03213232e+02 3.65657437e-02]
mat_Sqrt:  [[ 1.97366096e+01 -7.64208194e-03]
 [-7.64208194e-03  1.75287199e-02]]
grads:  [-3.90053622e-04 -2.69449959e+00]
Stock Position:  -0.0003900536217420243
Bond Position:  [18.47203451]


portfolio before change:  [18.4548379]
curr_Stock_Price:  103.32193664960639
curr_Factors:  [1.03321937e+02 3.56936357e-02]
mat_Sqrt:  [[ 1.95203634e+01 -7.55040561e-03]
 [-7.55040561e-03  1.73184217e-02]]
grads:  [-2.59778607e-03 -5.78880451e+00]
Stock Position:  -0.0025977860696072643
Bond Position:  [18.72324618]


portfolio before change:  [18.47961138]
curr_Stock_Price:  102.80041743442138
curr_Factors:  [1.02800417e+02 3.73069240e-02]
mat_Sqrt:  [[ 1.98558995e+01 -7.71911761e-03]
 [-7.71911761e-03  1.77054925e-02]]
grads:  [-3.47532213e-05 -8.52651483e+00]
Stock Position:  -3.4753221317696995e-05
Bond Position:  [18.48318403]


portfolio before change:  [18.50278136]
curr_Stock_Price:  101.3171514448647
curr_Factors:  [1.01317151e+02 3.79444834e-02]
mat_Sqrt:  [[ 1.97359147e+01 -7.78469487e-03]
 [-7.78469487e-03  1.78561855e-02]]
grads:  [-0.00108697 -0.56134503]
Stock Position:  -0.0010869743973327985
Bond Position:  [18.61291051]


portfolio before change:  [18.52279482]
curr_Stock_Price:  104.32294770721647
curr_Factors:  [1.04322948e+02 3.53109685e-02]
mat_Sqrt:  [[ 1.96035459e+01 -7.50988693e-03]
 [-7.50988693e-03  1.72253094e-02]]
grads:  [ 0.00825263 -6.8335187 ]
Stock Position:  0.00825263498341462
Bond Position:  [17.66185561]


portfolio before change:  [18.54910959]
curr_Stock_Price:  104.83474183465837
curr_Factors:  [1.04834742e+02 3.24783941e-02]
mat_Sqrt:  [[ 1.88930673e+01 -7.20240799e-03]
 [-7.20240799e-03  1.65199655e-02]]
grads:  [0.00916596 6.44542864]
Stock Position:  0.00916595647170932
Bond Position:  [17.58819891]


portfolio before change:  [18.58888895]
curr_Stock_Price:  106.77456789192621
curr_Factors:  [1.06774568e+02 3.16978988e-02]
mat_Sqrt:  [[ 1.90100399e+01 -7.11545334e-03]
 [-7.11545334e-03  1.63202118e-02]]
grads:  [4.72110750e-03 4.96447298e+00]
Stock Position:  0.004721107501425597
Bond Position:  [18.08479474]


portfolio before change:  [18.61499165]
curr_Stock_Price:  107.51222720233405
curr_Factors:  [1.07512227e+02 2.74767644e-02]
mat_Sqrt:  [[ 1.78213510e+01 -6.62479873e-03]
 [-6.62479873e-03  1.51947256e-02]]
grads:  [-0.01558404  3.20810036]
Stock Position:  -0.015584042197517743
Bond Position:  [20.29046673]


portfolio before change:  [18.65924823]
curr_Stock_Price:  106.30088310054833
curr_Factors:  [1.06300883e+02 2.71846405e-02]
mat_Sqrt:  [[ 1.75266389e+01 -6.58942433e-03]
 [-6.58942433e-03  1.51137650e-02]]
grads:  [0.00501981 3.57185142]
Stock Position:  0.0050198086785569074
Bond Position:  [18.12563813]


portfolio before change:  [18.68099226]
curr_Stock_Price:  106.11617942870676
curr_Factors:  [1.06116179e+02 2.81674985e-02]
mat_Sqrt:  [[ 1.78096635e+01 -6.70747660e-03]
 [-6.70747660e-03  1.53845618e-02]]
grads:  [ 2.47604936e-03 -2.60988827e+00]
Stock Position:  0.002476049362299839
Bond Position:  [18.41824337]


portfolio before change:  [18.70261024]
curr_Stock_Price:  105.54299709354333
curr_Factors:  [1.05542997e+02 3.51730712e-02]
mat_Sqrt:  [[ 1.97940443e+01 -7.49528475e-03]
 [-7.49528475e-03  1.71916090e-02]]
grads:  [ 4.85108503e-04 -7.11674335e+00]
Stock Position:  0.0004851085029976385
Bond Position:  [18.65141043]


portfolio before change:  [18.72804603]
curr_Stock_Price:  109.88625566445155
curr_Factors:  [1.09886256e+02 3.82283895e-02]
mat_Sqrt:  [[ 2.14850490e+01 -7.81431453e-03]
 [-7.81431453e-03  1.79226221e-02]]
grads:  [0.00457134 1.31118779]
Stock Position:  0.004571344839374832
Bond Position:  [18.22571806]


portfolio before change:  [18.7647987]
curr_Stock_Price:  112.93924845213152
curr_Factors:  [1.12939248e+02 3.61425372e-02]
mat_Sqrt:  [[ 2.14710946e+01 -7.59830969e-03]
 [-7.59830969e-03  1.74267341e-02]]
grads:  [3.13029447e-03 5.75542509e+00]
Stock Position:  0.0031302944652128106
Bond Position:  [18.4112656]


portfolio before change:  [18.78252957]
curr_Stock_Price:  111.24688143327405
curr_Factors:  [1.11246881e+02 3.77549867e-02]
mat_Sqrt:  [[ 2.16159824e+01 -7.76585853e-03]
 [-7.76585853e-03  1.78112691e-02]]
grads:  [-4.42006555e-03 -1.12530501e+01]
Stock Position:  -0.004420065554706745
Bond Position:  [19.27424808]


portfolio before change:  [18.79243884]
curr_Stock_Price:  114.45918813642479
curr_Factors:  [1.14459188e+02 3.22011151e-02]
mat_Sqrt:  [[ 2.05393214e+01 -7.17212425e-03]
 [-7.17212425e-03  1.64490664e-02]]
grads:  [-2.89564947e-03 -6.44321149e+00]
Stock Position:  -0.002895649467138915
Bond Position:  [19.12387252]


portfolio before change:  [18.81399671]
curr_Stock_Price:  115.27486562640559
curr_Factors:  [1.15274866e+02 2.97143938e-02]
mat_Sqrt:  [[ 1.98709228e+01 -6.88966723e-03]
 [-6.88966723e-03  1.58011526e-02]]
grads:  [ 6.69447896e-03 -7.94006036e+00]
Stock Position:  0.006694478963785774
Bond Position:  [18.04229154]


portfolio before change:  [18.8692556]
curr_Stock_Price:  120.15828140143257
curr_Factors:  [1.20158281e+02 3.17986217e-02]
mat_Sqrt:  [[ 2.14268255e+01 -7.12743033e-03]
 [-7.12743033e-03  1.63458238e-02]]
grads:  [ 3.20331282e-03 -9.18247539e+00]
Stock Position:  0.0032033128197338154
Bond Position:  [18.48435103]


portfolio before change:  [18.89644099]
curr_Stock_Price:  121.427439595363
curr_Factors:  [1.21427440e+02 3.14605269e-02]
mat_Sqrt:  [[ 2.15377241e+01 -7.08949481e-03]
 [-7.08949481e-03  1.62586695e-02]]
grads:  [-0.00458218  2.82146671]
Stock Position:  -0.004582184900703795
Bond Position:  [19.45284397]


portfolio before change:  [18.92578778]
curr_Stock_Price:  120.33286878667367
curr_Factors:  [1.20332869e+02 3.54448742e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.92578778]
Stock Price:  119.3654103006829
PL:  [-0.43962252]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 7.30904039e-02 -3.09010450e-02]
 [-9.84492920e-02  7.34885390e-02]
 [ 4.06849151e-02  1.03127505e-01]
 [-4.69198992e-01 -2.43045720e-01]
 [ 4.82135703e-01  4.67971862e-02]
 [ 3.30480852e-02 -1.18062984e-01]
 [-4.54274632e-01 -4.52441859e-01]
 [ 3.28573812e-02 -1.33983893e-02]
 [-9.70872525e-02 -7.94233516e-02]
 [ 4.28907991e-02  2.33595269e-01]
 [ 5.87435408e-02 -1.10811719e-01]
 [-1.06512846e-02  3.99555963e-02]
 [-6.76153888e-02 -1.28374516e-01]
 [ 1.13052694e-02  5.70410900e-02]
 [-5.87761593e-02 -8.80308923e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 2.68564331e-02 -1.39741691e-01]
 [ 1.70066608e-02  4.18214976e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.46148493]
curr_Stock_Price:  98.94459882601626
curr_Factors:  [9.89445988e+01 3.99457341e-02]
mat_Sqrt:  [[ 1.97754903e+01 -7.98717247e-03]
 [-7.98717247e-03  1.83210921e-02]]
grads:  [ 0.00301532 -1.68532317]
Stock Position:  0.003015320286612896
Bond Position:  [2.16313527]


portfolio before change:  [2.44908646]
curr_Stock_Price:  93.93548567604542
curr_Factors:  [9.39354857e+01 4.41126475e-02]
mat_Sqrt:  [[ 1.97292787e+01 -8.39301473e-03]
 [-8.39301473e-03  1.92531498e-02]]
grads:  [-3.36686375e-03  3.81549417e+00]
Stock Position:  -0.0033668637492630126
Bond Position:  [2.76535444]


portfolio before change:  [2.46656081]
curr_Stock_Price:  89.7727098560672
curr_Factors:  [8.97727099e+01 4.52393053e-02]
mat_Sqrt:  [[ 1.90942347e+01 -8.49913553e-03]
 [-8.49913553e-03  1.94976344e-02]]
grads:  [4.48593164e-03 5.29118709e+00]
Stock Position:  0.004485931637069021
Bond Position:  [2.06384657]


portfolio before change:  [2.47266762]
curr_Stock_Price:  90.55858636613215
curr_Factors:  [9.05585864e+01 4.33768576e-02]
mat_Sqrt:  [[ 1.88607360e+01 -8.32242095e-03]
 [-8.32242095e-03  1.90920372e-02]]
grads:  [ -0.03050018 -12.74350938]
Stock Position:  -0.030500179937876314
Bond Position:  [5.2347208]


portfolio before change:  [2.51472323]
curr_Stock_Price:  89.39439276405186
curr_Factors:  [8.93943928e+01 4.86130026e-02]
mat_Sqrt:  [[ 1.97099925e+01 -8.81030897e-03]
 [-8.81030897e-03  2.02115927e-02]]
grads:  [0.02550142 2.32647977]
Stock Position:  0.02550141554289235
Bond Position:  [0.23503967]


portfolio before change:  [2.58808297]
curr_Stock_Price:  92.25955767107567
curr_Factors:  [9.22595577e+01 4.89796465e-02]
mat_Sqrt:  [[ 2.04182798e+01 -8.84375200e-03]
 [-8.84375200e-03  2.02875458e-02]]
grads:  [-9.02203239e-04 -5.81987412e+00]
Stock Position:  -0.0009022032394036995
Bond Position:  [2.67131984]


portfolio before change:  [2.59814355]
curr_Stock_Price:  84.8118539289205
curr_Factors:  [8.48118539e+01 5.06579844e-02]
mat_Sqrt:  [[ 1.90888806e+01 -8.99321200e-03]
 [-8.99321200e-03  2.06325467e-02]]
grads:  [ -0.03413592 -21.94343035]
Stock Position:  -0.034135922727704215
Bond Position:  [5.49327444]


portfolio before change:  [2.46310008]
curr_Stock_Price:  88.9691859072126
curr_Factors:  [8.89691859e+01 4.82938365e-02]
mat_Sqrt:  [[ 1.95517406e+01 -8.78129654e-03]
 [-8.78129654e-03  2.01451532e-02]]
grads:  [ 0.00138209 -0.66449   ]
Stock Position:  0.001382091653206688
Bond Position:  [2.34013651]


portfolio before change:  [2.46840779]
curr_Stock_Price:  90.69173335152955
curr_Factors:  [9.06917334e+01 4.67710033e-02]
mat_Sqrt:  [[ 1.96135408e+01 -8.64190770e-03]
 [-8.64190770e-03  1.98249203e-02]]
grads:  [-0.00671649 -4.00916593]
Stock Position:  -0.006716487129499244
Bond Position:  [3.07753765]


portfolio before change:  [2.46246749]
curr_Stock_Price:  92.14928590254351
curr_Factors:  [9.21492859e+01 4.45267954e-02]
mat_Sqrt:  [[ 1.94447630e+01 -8.43216190e-03]
 [-8.43216190e-03  1.93433865e-02]]
grads:  [7.44400564e-03 1.20794794e+01]
Stock Position:  0.007444005642438867
Bond Position:  [1.77650768]


portfolio before change:  [2.48112866]
curr_Stock_Price:  94.3576595762747
curr_Factors:  [9.43576596e+01 4.43761709e-02]
mat_Sqrt:  [[ 1.98770547e+01 -8.41808353e-03]
 [-8.41808353e-03  1.93105561e-02]]
grads:  [ 5.25184808e-04 -5.73817229e+00]
Stock Position:  0.0005251848077427107
Bond Position:  [2.43157345]


portfolio before change:  [2.4866093]
curr_Stock_Price:  99.00226599522185
curr_Factors:  [9.90022660e+01 4.47949511e-02]
mat_Sqrt:  [[ 2.09536475e+01 -8.45809632e-03]
 [-8.45809632e-03  1.94012917e-02]]
grads:  [3.23034992e-04 2.05957053e+00]
Stock Position:  0.0003230349924128442
Bond Position:  [2.45462811]


portfolio before change:  [2.49014384]
curr_Stock_Price:  100.43967012812918
curr_Factors:  [1.00439670e+02 4.39165251e-02]
mat_Sqrt:  [[ 2.10484068e+01 -8.37486524e-03]
 [-8.37486524e-03  1.92100724e-02]]
grads:  [-5.87233351e-03 -6.68522706e+00]
Stock Position:  -0.005872333514994761
Bond Position:  [3.07995908]


portfolio before change:  [2.49225705]
curr_Stock_Price:  100.73582844640306
curr_Factors:  [1.00735828e+02 4.55624213e-02]
mat_Sqrt:  [[ 2.15024193e+01 -8.53038052e-03]
 [-8.53038052e-03  1.95667274e-02]]
grads:  [1.68257181e-03 2.91594204e+00]
Stock Position:  0.0016825718118399255
Bond Position:  [2.32276179]


portfolio before change:  [2.49362801]
curr_Stock_Price:  99.8239468109724
curr_Factors:  [9.98239468e+01 5.41007006e-02]
mat_Sqrt:  [[ 2.32186063e+01 -9.29528788e-03]
 [-9.29528788e-03  2.13214594e-02]]
grads:  [-0.00418505 -4.13057062]
Stock Position:  -0.004185048886474855
Bond Position:  [2.91139611]


portfolio before change:  [2.49098677]
curr_Stock_Price:  101.32518678982423
curr_Factors:  [1.01325187e+02 4.52773056e-02]
mat_Sqrt:  [[ 2.15604423e+01 -8.50369335e-03]
 [-8.50369335e-03  1.95053904e-02]]
grads:  [ 0.00503949 -3.12737601]
Stock Position:  0.005039489254869965
Bond Position:  [1.98035958]


portfolio before change:  [2.50125867]
curr_Stock_Price:  102.87195129935317
curr_Factors:  [1.02871951e+02 4.16507087e-02]
mat_Sqrt:  [[ 2.09946260e+01 -8.15613495e-03]
 [-8.15613495e-03  1.87078740e-02]]
grads:  [-1.62293886e-03 -7.47038001e+00]
Stock Position:  -0.0016229388625540648
Bond Position:  [2.66821356]


portfolio before change:  [2.50479458]
curr_Stock_Price:  102.74960534605638
curr_Factors:  [1.02749605e+02 4.01396373e-02]
mat_Sqrt:  [[ 2.05857575e+01 -8.00680898e-03]
 [-8.00680898e-03  1.83653855e-02]]
grads:  [1.71213879e-03 2.27793783e+00]
Stock Position:  0.0017121387887830432
Bond Position:  [2.328873]


portfolio before change:  [2.50939091]
curr_Stock_Price:  103.73283061664053
curr_Factors:  [1.03732831e+02 4.44239278e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.50939091]
Stock Price:  104.19218909676451
PL:  [-1.68279818]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-5.64254772e-02 -7.99305900e-02]
 [ 8.37598160e-03 -8.17440364e-02]
 [ 7.06698096e-02 -1.13816729e-01]
 [ 2.22845738e-02  2.30059592e-02]
 [-2.03778078e-01 -6.32545180e-03]
 [ 5.44257772e-02 -4.48327577e-02]
 [-1.46680684e-01 -1.88224339e-01]
 [ 3.28104337e-02 -1.36021559e-02]
 [-1.42917459e-01 -1.13748846e-01]
 [ 8.26195522e-02  4.03970943e-01]
 [ 2.84061008e-02 -8.96206687e-02]
 [ 1.73103561e-02 -6.75864726e-02]
 [-1.42383950e-01 -1.28511901e-01]
 [-7.57424859e-04  1.57989269e-01]
 [-1.00006213e-01  6.40491248e-02]
 [-1.29233412e-01  5.48238949e-02]
 [-7.82028005e-02  1.17914546e-01]
 [ 1.11469610e-01 -8.73491675e-02]
 [ 1.31877085e-01  7.40350057e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.90787851]
curr_Stock_Price:  100.93491463365642
curr_Factors:  [1.00934915e+02 3.84040433e-02]
mat_Sqrt:  [[ 1.97801628e+01 -7.83166786e-03]
 [-7.83166786e-03  1.79640032e-02]]
grads:  [-0.00461514 -4.45149855]
Stock Position:  -0.004615135694859981
Bond Position:  [10.37370683]


portfolio before change:  [9.9146541]
curr_Stock_Price:  102.27824389878442
curr_Factors:  [1.02278244e+02 3.66920453e-02]
mat_Sqrt:  [[ 1.95915677e+01 -7.65520670e-03]
 [-7.65520670e-03  1.75589938e-02]]
grads:  [-1.39175526e-03 -4.65600088e+00]
Stock Position:  -0.0013917552639278166
Bond Position:  [10.05700039]


portfolio before change:  [9.92753082]
curr_Stock_Price:  102.06440831588031
curr_Factors:  [1.02064408e+02 3.93671718e-02]
mat_Sqrt:  [[ 2.02507633e+01 -7.92934391e-03]
 [-7.92934391e-03  1.81878317e-02]]
grads:  [ 1.03960308e-03 -6.25739712e+00]
Stock Position:  0.0010396030815373863
Bond Position:  [9.82142435]


portfolio before change:  [9.93492839]
curr_Stock_Price:  97.3636897585382
curr_Factors:  [9.73636898e+01 3.88158672e-02]
mat_Sqrt:  [[ 1.91823422e+01 -7.87328511e-03]
 [-7.87328511e-03  1.80601787e-02]]
grads:  [0.00168487 1.27458455]
Stock Position:  0.0016848693966393007
Bond Position:  [9.77088329]


portfolio before change:  [9.94697288]
curr_Stock_Price:  97.25878133077701
curr_Factors:  [9.72587813e+01 4.21328929e-02]
mat_Sqrt:  [[ 1.99636261e+01 -8.20278882e-03]
 [-8.20278882e-03  1.88160353e-02]]
grads:  [-0.01034745 -0.3406844 ]
Stock Position:  -0.01034745089355061
Bond Position:  [10.95335334]


portfolio before change:  [9.99500438]
curr_Stock_Price:  93.94093512374886
curr_Factors:  [9.39409351e+01 4.39258665e-02]
mat_Sqrt:  [[ 1.96886078e+01 -8.37522758e-03]
 [-8.37522758e-03  1.92123457e-02]]
grads:  [ 1.77200578e-03 -2.33276651e+00]
Stock Position:  0.0017720057777582394
Bond Position:  [9.8285405]


portfolio before change:  [10.0041186]
curr_Stock_Price:  92.14684585261202
curr_Factors:  [9.21468459e+01 4.09498921e-02]
mat_Sqrt:  [[ 1.86469074e+01 -8.08638819e-03]
 [-8.08638819e-03  1.85501819e-02]]
grads:  [ -0.01226877 -10.15211338]
Stock Position:  -0.012268769760003065
Bond Position:  [11.13464704]


portfolio before change:  [10.05523117]
curr_Stock_Price:  89.11593431592027
curr_Factors:  [8.91159343e+01 4.18246530e-02]
mat_Sqrt:  [[ 1.82251661e+01 -8.17202523e-03]
 [-8.17202523e-03  1.87473874e-02]]
grads:  [ 0.00147524 -0.72490635]
Stock Position:  0.0014752392706232197
Bond Position:  [9.92376384]


portfolio before change:  [10.06637816]
curr_Stock_Price:  88.25812473454133
curr_Factors:  [8.82581247e+01 4.23578318e-02]
mat_Sqrt:  [[ 1.81644190e+01 -8.22386645e-03]
 [-8.22386645e-03  1.88665402e-02]]
grads:  [-0.01059975 -6.03375159]
Stock Position:  -0.010599745918051256
Bond Position:  [11.00189185]


portfolio before change:  [10.11437001]
curr_Stock_Price:  85.02871775193944
curr_Factors:  [8.50287178e+01 4.02090203e-02]
mat_Sqrt:  [[ 1.70501156e+01 -8.01223761e-03]
 [-8.01223761e-03  1.83819001e-02]]
grads:  [1.51760835e-02 2.19831756e+01]
Stock Position:  0.015176083516517128
Bond Position:  [8.82396709]


portfolio before change:  [10.11676389]
curr_Stock_Price:  84.45920484582756
curr_Factors:  [8.44592048e+01 4.26722085e-02]
mat_Sqrt:  [[ 1.74469493e+01 -8.25394329e-03]
 [-8.25394329e-03  1.89365917e-02]]
grads:  [-6.10954932e-04 -4.73293785e+00]
Stock Position:  -0.0006109549315900569
Bond Position:  [10.16836466]


portfolio before change:  [10.12747272]
curr_Stock_Price:  87.74843972800114
curr_Factors:  [8.77484397e+01 4.04165684e-02]
mat_Sqrt:  [[ 1.76408325e+01 -8.03315764e-03]
 [-8.03315764e-03  1.84291634e-02]]
grads:  [-6.88889197e-04 -3.66766549e+00]
Stock Position:  -0.0006888891969648606
Bond Position:  [10.18792167]


portfolio before change:  [10.13900823]
curr_Stock_Price:  89.50105510622562
curr_Factors:  [8.95010551e+01 3.89743959e-02]
mat_Sqrt:  [[ 1.76692375e+01 -7.88869459e-03]
 [-7.88869459e-03  1.80973052e-02]]
grads:  [-0.0112309  -7.10605786]
Stock Position:  -0.011230901743665962
Bond Position:  [11.14418578]


portfolio before change:  [10.16904016]
curr_Stock_Price:  88.06813440335884
curr_Factors:  [8.80681344e+01 4.20865226e-02]
mat_Sqrt:  [[ 1.80671759e+01 -8.19746816e-03]
 [-8.19746816e-03  1.88060294e-02]]
grads:  [3.77053381e-03 8.40263376e+00]
Stock Position:  0.0037705338138020014
Bond Position:  [9.83697628]


portfolio before change:  [10.18481674]
curr_Stock_Price:  88.98913532209023
curr_Factors:  [8.89891353e+01 4.09725319e-02]
mat_Sqrt:  [[ 1.80128878e+01 -8.08833799e-03]
 [-8.08833799e-03  1.85554334e-02]]
grads:  [-0.00400276  3.45002716]
Stock Position:  -0.004002757786963696
Bond Position:  [10.54101869]


portfolio before change:  [10.20732924]
curr_Stock_Price:  86.65874363544185
curr_Factors:  [8.66587436e+01 4.51153401e-02]
mat_Sqrt:  [[ 1.84066375e+01 -8.48717173e-03]
 [-8.48717173e-03  1.94710379e-02]]
grads:  [-0.00572389  2.81316875]
Stock Position:  -0.005723889850703416
Bond Position:  [10.70335435]


portfolio before change:  [10.20560277]
curr_Stock_Price:  89.2992611554214
curr_Factors:  [8.92992612e+01 4.50120854e-02]
mat_Sqrt:  [[ 1.89457756e+01 -8.47771884e-03]
 [-8.47771884e-03  1.94486282e-02]]
grads:  [-1.41502280e-03  6.06225531e+00]
Stock Position:  -0.0014150227961133963
Bond Position:  [10.33196326]


portfolio before change:  [10.21693326]
curr_Stock_Price:  90.42471524825343
curr_Factors:  [9.04247152e+01 4.78406321e-02]
mat_Sqrt:  [[ 1.97781453e+01 -8.74014102e-03]
 [-8.74014102e-03  2.00503430e-02]]
grads:  [ 3.71154077e-03 -4.35487452e+00]
Stock Position:  0.0037115407659411783
Bond Position:  [9.88131824]


portfolio before change:  [10.24008122]
curr_Stock_Price:  93.33148428439918
curr_Factors:  [9.33314843e+01 4.57783504e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.24008122]
Stock Price:  91.70197073390116
PL:  [10.24008122]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 2.99321841e-02 -3.90958854e-02]
 [ 1.33779125e-02 -7.57300611e-02]
 [ 6.23745427e-02  5.69202775e-02]
 [-1.70794692e-02 -1.00066882e-02]
 [-1.98832280e-01 -3.40693780e-02]
 [ 1.27260484e-01  1.30466079e-01]
 [ 3.57648428e-02  5.68703584e-02]
 [ 3.62724677e-02  1.05375599e-01]
 [ 7.96946067e-02  7.17377150e-02]
 [ 6.78370614e-02 -5.73217443e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [-9.12595639e-03  4.15336618e-02]
 [-2.83914950e-03 -5.18611103e-02]
 [ 1.07454765e-02  5.66446193e-02]
 [-6.61427732e-02 -7.18027565e-02]
 [ 9.99468930e-02 -5.72956870e-02]
 [ 2.28466730e-02 -1.31272357e-01]
 [ 3.10882017e-02  4.54111682e-02]
 [-6.65296824e-02 -6.20845022e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.53166685]
curr_Stock_Price:  103.77450317443959
curr_Factors:  [1.03774503e+02 3.58166163e-02]
mat_Sqrt:  [[ 1.96396122e+01 -7.56343094e-03]
 [-7.56343094e-03  1.73482182e-02]]
grads:  [ 6.56297384e-04 -2.25331046e+00]
Stock Position:  0.0006562973838453645
Bond Position:  [20.46355991]


portfolio before change:  [20.55606834]
curr_Stock_Price:  101.95527824650607
curr_Factors:  [1.01955278e+02 3.67758144e-02]
mat_Sqrt:  [[ 1.95519839e+01 -7.66391852e-03]
 [-7.66391852e-03  1.75790357e-02]]
grads:  [-1.00457426e-03 -4.30841379e+00]
Stock Position:  -0.0010045742619321858
Bond Position:  [20.65848999]


portfolio before change:  [20.5861102]
curr_Stock_Price:  97.77181348455225
curr_Factors:  [9.77718135e+01 4.19352476e-02]
mat_Sqrt:  [[ 2.00218056e+01 -8.18356701e-03]
 [-8.18356701e-03  1.87718328e-02]]
grads:  [0.00435547 3.03411613]
Stock Position:  0.00435547308556668
Bond Position:  [20.1602677]


portfolio before change:  [20.62676453]
curr_Stock_Price:  101.3163749659344
curr_Factors:  [1.01316375e+02 3.83033484e-02]
mat_Sqrt:  [[ 1.98288706e+01 -7.82142057e-03]
 [-7.82142057e-03  1.79404254e-02]]
grads:  [-0.00108154 -0.5582447 ]
Stock Position:  -0.0010815409585208473
Bond Position:  [20.73634234]


portfolio before change:  [20.65523412]
curr_Stock_Price:  98.97439104210893
curr_Factors:  [9.89743910e+01 3.45780852e-02]
mat_Sqrt:  [[ 1.84044682e+01 -7.43119145e-03]
 [-7.43119145e-03  1.70457691e-02]]
grads:  [-0.01161254 -2.0037625 ]
Stock Position:  -0.011612539972639625
Bond Position:  [21.80457819]


portfolio before change:  [20.66944532]
curr_Stock_Price:  100.0991719448518
curr_Factors:  [1.00099172e+02 2.76041877e-02]
mat_Sqrt:  [[ 1.66309836e+01 -6.63972330e-03]
 [-6.63972330e-03  1.52301002e-02]]
grads:  [0.01107395 8.57115878]
Stock Position:  0.01107394551599368
Bond Position:  [19.56095254]


portfolio before change:  [20.72477228]
curr_Stock_Price:  102.885936786127
curr_Factors:  [1.02885937e+02 2.91272932e-02]
mat_Sqrt:  [[ 1.75592534e+01 -6.82061164e-03]
 [-6.82061164e-03  1.56445578e-02]]
grads:  [3.44941007e-03 3.63665667e+00]
Stock Position:  0.0034494100664332803
Bond Position:  [20.3698765]


portfolio before change:  [20.73707038]
curr_Stock_Price:  99.06494549531918
curr_Factors:  [9.90649455e+01 3.09509565e-02]
mat_Sqrt:  [[ 1.74283795e+01 -7.03064849e-03]
 [-7.03064849e-03  1.61269820e-02]]
grads:  [4.71793798e-03 6.53617454e+00]
Stock Position:  0.004717937975195582
Bond Position:  [20.26968811]


portfolio before change:  [20.78741003]
curr_Stock_Price:  104.36104991825033
curr_Factors:  [1.04361050e+02 3.23180157e-02]
mat_Sqrt:  [[ 1.87612060e+01 -7.18457473e-03]
 [-7.18457473e-03  1.64791396e-02]]
grads:  [0.0059159  4.35582317]
Stock Position:  0.005915896021387785
Bond Position:  [20.17002091]


portfolio before change:  [20.79555327]
curr_Stock_Price:  101.47305951638097
curr_Factors:  [1.01473060e+02 3.12650753e-02]
mat_Sqrt:  [[ 1.79423969e+01 -7.06639019e-03]
 [-7.06639019e-03  1.62085435e-02]]
grads:  [ 2.38842281e-03 -3.53547293e+00]
Stock Position:  0.0023884228128878793
Bond Position:  [20.5531927]


portfolio before change:  [20.82822812]
curr_Stock_Price:  104.39017255960049
curr_Factors:  [1.04390173e+02 2.97614709e-02]
mat_Sqrt:  [[ 1.80088831e+01 -6.89455157e-03]
 [-6.89455157e-03  1.58139137e-02]]
grads:  [ 5.33230465e-04 -7.73674566e+00]
Stock Position:  0.000533230465412108
Bond Position:  [20.7725641]


portfolio before change:  [20.85361402]
curr_Stock_Price:  103.272371592634
curr_Factors:  [1.03272372e+02 3.01624941e-02]
mat_Sqrt:  [[ 1.79356757e+01 -6.94078082e-03]
 [-6.94078082e-03  1.59201289e-02]]
grads:  [5.00856753e-04 2.60909560e+00]
Stock Position:  0.0005008567527085728
Bond Position:  [20.80188935]


portfolio before change:  [20.87952482]
curr_Stock_Price:  103.05711726323318
curr_Factors:  [1.03057117e+02 2.60076862e-02]
mat_Sqrt:  [[ 1.66199156e+01 -6.44502725e-03]
 [-6.44502725e-03  1.47830472e-02]]
grads:  [-1.53150953e-03 -3.50881521e+00]
Stock Position:  -0.0015315095269365804
Bond Position:  [21.03735778]


portfolio before change:  [20.90925258]
curr_Stock_Price:  100.82754400450263
curr_Factors:  [1.00827544e+02 2.49006750e-02]
mat_Sqrt:  [[ 1.59105325e+01 -6.30624626e-03]
 [-6.30624626e-03  1.44650616e-02]]
grads:  [2.22787119e-03 3.91693242e+00]
Stock Position:  0.0022278711893296364
Bond Position:  [20.6846218]


portfolio before change:  [20.92910725]
curr_Stock_Price:  98.12663922502455
curr_Factors:  [9.81266392e+01 2.56476083e-02]
mat_Sqrt:  [[ 1.57148531e+01 -6.39997009e-03]
 [-6.39997009e-03  1.46804791e-02]]
grads:  [-0.00620194 -4.89374007]
Stock Position:  -0.006201939203267899
Bond Position:  [21.5376827]


portfolio before change:  [20.94676145]
curr_Stock_Price:  99.62371015735226
curr_Factors:  [9.96237102e+01 2.25859123e-02]
mat_Sqrt:  [[ 1.49720578e+01 -6.00591827e-03]
 [-6.00591827e-03  1.37763591e-02]]
grads:  [ 0.00500809 -4.15680287]
Stock Position:  0.005008094114717248
Bond Position:  [20.44783653]


portfolio before change:  [20.98388673]
curr_Stock_Price:  101.92987754461217
curr_Factors:  [1.01929878e+02 2.22918126e-02]
mat_Sqrt:  [[ 1.52185810e+01 -5.96681157e-03]
 [-5.96681157e-03  1.36863174e-02]]
grads:  [-2.25973087e-03 -9.59248832e+00]
Stock Position:  -0.0022597308710914895
Bond Position:  [21.21422082]


portfolio before change:  [21.01184387]
curr_Stock_Price:  101.30024894733928
curr_Factors:  [1.01300249e+02 2.41437235e-02]
mat_Sqrt:  [[ 1.57402854e+01 -6.20968158e-03]
 [-6.20968158e-03  1.42434929e-02]]
grads:  [0.0032334  3.18961416]
Stock Position:  0.003233403252176247
Bond Position:  [20.68429932]


portfolio before change:  [21.03936242]
curr_Stock_Price:  101.80961948028141
curr_Factors:  [1.01809619e+02 2.91035356e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.03936242]
Stock Price:  98.6539311706113
PL:  [21.03936242]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.39810969e-01 -1.50031808e-02]
 [-7.42825519e-02  6.98838509e-02]
 [ 6.14771777e-02  5.95876332e-02]
 [-1.57787668e-01 -8.44801795e-02]
 [-1.63796329e-01  4.05005584e-03]
 [ 1.27252440e-01  1.25712419e-01]
 [ 2.41713683e-02  4.15460571e-02]
 [ 3.22437052e-02 -1.60619299e-02]
 [-1.34154737e-01 -1.07179667e-01]
 [ 6.33027750e-02  3.21126627e-01]
 [ 5.59709409e-02 -1.03194884e-01]
 [-1.02514487e-03 -2.34770053e-03]
 [-1.19578049e-01 -1.38980180e-01]
 [-2.68305402e-03  1.55456997e-01]
 [-9.41840866e-02  1.51789979e-02]
 [-8.65167379e-02  3.21190502e-02]
 [-5.81468442e-02  6.54744403e-02]
 [ 1.11083135e-01 -4.16352599e-02]
 [ 1.34014963e-01  7.53383443e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.7604745]
curr_Stock_Price:  94.87598411130314
curr_Factors:  [9.48759841e+01 4.14438786e-02]
mat_Sqrt:  [[ 1.93146326e+01 -8.13524838e-03]
 [-8.13524838e-03  1.86616323e-02]]
grads:  [ 0.00690125 -0.80095016]
Stock Position:  0.006901246515985055
Bond Position:  [-13.41523706]


portfolio before change:  [-12.77919024]
curr_Stock_Price:  94.5954256957582
curr_Factors:  [9.45954257e+01 3.91387345e-02]
mat_Sqrt:  [[ 1.87142957e+01 -7.90574437e-03]
 [-7.90574437e-03  1.81352296e-02]]
grads:  [-2.34184333e-03  3.85246499e+00]
Stock Position:  -0.0023418433315027507
Bond Position:  [-12.55766257]


portfolio before change:  [-12.80173717]
curr_Stock_Price:  97.51621748847938
curr_Factors:  [9.75162175e+01 4.02223900e-02]
mat_Sqrt:  [[ 1.95573833e+01 -8.01467484e-03]
 [-8.01467484e-03  1.83844741e-02]]
grads:  [0.00447248 3.24314301]
Stock Position:  0.004472475337819552
Bond Position:  [-13.23787604]


portfolio before change:  [-12.83388998]
curr_Stock_Price:  94.02930606946002
curr_Factors:  [9.40293061e+01 4.26110589e-02]
mat_Sqrt:  [[ 1.94099473e+01 -8.24893744e-03]
 [-8.24893744e-03  1.89226219e-02]]
grads:  [-0.01002842 -4.46887876]
Stock Position:  -0.010028423416032054
Bond Position:  [-11.89092429]


portfolio before change:  [-12.86223058]
curr_Stock_Price:  95.37225418664761
curr_Factors:  [9.53722542e+01 4.12050168e-02]
mat_Sqrt:  [[ 1.93596302e+01 -8.11181149e-03]
 [-8.11181149e-03  1.86077586e-02]]
grads:  [-0.00837105  0.2140049 ]
Stock Position:  -0.008371046376176272
Bond Position:  [-12.06386502]


portfolio before change:  [-12.92592524]
curr_Stock_Price:  101.17862485380759
curr_Factors:  [1.01178625e+02 4.24524957e-02]
mat_Sqrt:  [[ 2.08468457e+01 -8.23414192e-03]
 [-8.23414192e-03  1.88871349e-02]]
grads:  [0.00873466 6.65978943]
Stock Position:  0.008734659132789813
Bond Position:  [-13.80968604]


portfolio before change:  [-12.97108613]
curr_Stock_Price:  97.98582906999371
curr_Factors:  [9.79858291e+01 4.16259091e-02]
mat_Sqrt:  [[ 1.99914871e+01 -8.15334447e-03]
 [-8.15334447e-03  1.87024615e-02]]
grads:  [2.11544570e-03 2.22234411e+00]
Stock Position:  0.002115445696306745
Bond Position:  [-13.17836983]


portfolio before change:  [-13.0013334]
curr_Stock_Price:  91.47939169374656
curr_Factors:  [9.14793917e+01 4.06472706e-02]
mat_Sqrt:  [[ 1.84433123e+01 -8.05639499e-03]
 [-8.05639499e-03  1.84815369e-02]]
grads:  [ 0.00136889 -0.86848305]
Stock Position:  0.0013688898324388955
Bond Position:  [-13.12655861]


portfolio before change:  [-13.02152647]
curr_Stock_Price:  88.72196664712365
curr_Factors:  [8.87219666e+01 3.88399868e-02]
mat_Sqrt:  [[ 1.74852020e+01 -7.87500941e-03]
 [-7.87500941e-03  1.80661035e-02]]
grads:  [-0.01034645 -5.93714885]
Stock Position:  -0.010346454149382553
Bond Position:  [-12.10356871]


portfolio before change:  [-13.03424663]
curr_Stock_Price:  88.48818956525876
curr_Factors:  [8.84881896e+01 3.79477355e-02]
mat_Sqrt:  [[ 1.72376555e+01 -7.78400833e-03]
 [-7.78400833e-03  1.78573954e-02]]
grads:  [1.17951857e-02 1.79879783e+01]
Stock Position:  0.011795185721524324
Bond Position:  [-14.07798126]


portfolio before change:  [-13.0415403]
curr_Stock_Price:  89.3626831191759
curr_Factors:  [8.93626831e+01 3.76456895e-02]
mat_Sqrt:  [[ 1.73385903e+01 -7.75304645e-03]
 [-7.75304645e-03  1.77861510e-02]]
grads:  [ 6.33850045e-04 -5.80170324e+00]
Stock Position:  0.0006338500453452701
Bond Position:  [-13.09818284]


portfolio before change:  [-13.05552511]
curr_Stock_Price:  93.14615588528642
curr_Factors:  [9.31461559e+01 3.51102640e-02]
mat_Sqrt:  [[ 1.74534764e+01 -7.48772496e-03]
 [-7.48772496e-03  1.71766299e-02]]
grads:  [-1.17394937e-04 -1.36731103e-01]
Stock Position:  -0.00011739493668708111
Bond Position:  [-13.04459022]


portfolio before change:  [-13.0717855]
curr_Stock_Price:  92.67308702737212
curr_Factors:  [9.26730870e+01 3.72996789e-02]
mat_Sqrt:  [[ 1.78980673e+01 -7.71761666e-03]
 [-7.71761666e-03  1.77041007e-02]]
grads:  [-0.01006793 -7.85455769]
Stock Position:  -0.010067931419945409
Bond Position:  [-12.13875922]


portfolio before change:  [-13.02890076]
curr_Stock_Price:  86.90549887736655
curr_Factors:  [8.69054989e+01 4.23453674e-02]
mat_Sqrt:  [[ 1.78834030e+01 -8.22252358e-03]
 [-8.22252358e-03  1.88638220e-02]]
grads:  [3.63979455e-03 8.24259926e+00]
Stock Position:  0.0036397945472369437
Bond Position:  [-13.34521892]


portfolio before change:  [-13.02930906]
curr_Stock_Price:  91.37928105670134
curr_Factors:  [9.13792811e+01 4.22750424e-02]
mat_Sqrt:  [[ 1.87883967e+01 -8.21611682e-03]
 [-8.21611682e-03  1.88479667e-02]]
grads:  [-0.0046616   0.80330669]
Stock Position:  -0.0046616018660261644
Bond Position:  [-12.60333524]


portfolio before change:  [-13.03618625]
curr_Stock_Price:  89.47289042389527
curr_Factors:  [8.94728904e+01 4.56954841e-02]
mat_Sqrt:  [[ 1.91261724e+01 -8.54185014e-03]
 [-8.54185014e-03  1.95957046e-02]]
grads:  [-0.00379219  1.63743323]
Stock Position:  -0.003792187332544891
Bond Position:  [-12.69688829]


portfolio before change:  [-13.06526214]
curr_Stock_Price:  92.95237500350684
curr_Factors:  [9.2952375e+01 5.0008954e-02]
mat_Sqrt:  [[ 2.07866420e+01 -8.93626072e-03]
 [-8.93626072e-03  2.04995801e-02]]
grads:  [-1.42449693e-03  3.19331959e+00]
Stock Position:  -0.0014244969348136698
Bond Position:  [-12.93285177]


portfolio before change:  [-13.08369048]
curr_Stock_Price:  94.53340298629662
curr_Factors:  [9.45334030e+01 4.91567675e-02]
mat_Sqrt:  [[ 2.09593066e+01 -8.85993957e-03]
 [-8.85993957e-03  2.03241026e-02]]
grads:  [ 0.00443479 -2.04663245]
Stock Position:  0.004434788659328384
Bond Position:  [-13.50292615]


portfolio before change:  [-13.10677924]
curr_Stock_Price:  93.13546873812625
curr_Factors:  [9.31354687e+01 5.45147071e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.10677924]
Stock Price:  90.03004793776044
PL:  [-13.10677924]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-2.11023452e-03 -5.43565075e-02]
 [ 2.33027724e-02 -6.37970969e-02]
 [ 6.53603559e-02  4.80453011e-02]
 [-1.80730259e-02 -1.27072297e-02]
 [ 1.04636988e-01 -1.02117087e-01]
 [ 1.27564860e-01  1.31197961e-01]
 [ 2.97585040e-02  4.91070426e-02]
 [-1.03323392e-01  8.83264531e-02]
 [ 2.06520728e-02  1.24407405e-02]
 [ 5.72808909e-02 -4.24134474e-03]
 [ 5.87491871e-02 -1.10827231e-01]
 [-6.38004369e-03  1.45261505e-02]
 [-9.37629544e-02 -1.38578150e-01]
 [ 6.20292730e-03  1.38945773e-01]
 [-5.90851172e-02 -8.74461151e-02]
 [ 5.33302141e-02 -3.70687891e-02]
 [-6.65216729e-02  8.11418243e-02]
 [ 8.99178323e-02 -1.23173553e-01]
 [ 5.90177879e-02  5.76239382e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.60309041]
curr_Stock_Price:  102.72445019203431
curr_Factors:  [1.02724450e+02 3.72986725e-02]
mat_Sqrt:  [[ 1.98390321e+01 -7.71825882e-03]
 [-7.71825882e-03  1.77035365e-02]]
grads:  [-1.3011001e-03 -3.0709429e+00]
Stock Position:  -0.0013011000992537646
Bond Position:  [16.7367452]


portfolio before change:  [16.62625932]
curr_Stock_Price:  101.0067567978194
curr_Factors:  [1.01006757e+02 4.49510022e-02]
mat_Sqrt:  [[ 2.14150988e+01 -8.47297169e-03]
 [-8.47297169e-03  1.94349884e-02]]
grads:  [-2.10659650e-04 -3.28268176e+00]
Stock Position:  -0.00021065964986568425
Bond Position:  [16.64753736]


portfolio before change:  [16.64758406]
curr_Stock_Price:  98.62226707870079
curr_Factors:  [9.86222671e+01 4.58688656e-02]
mat_Sqrt:  [[ 2.11219469e+01 -8.55885256e-03]
 [-8.55885256e-03  1.96324909e-02]]
grads:  [0.0040868  2.44901575]
Stock Position:  0.004086797543417613
Bond Position:  [16.24453483]


portfolio before change:  [16.68092562]
curr_Stock_Price:  101.80891546411036
curr_Factors:  [1.01808915e+02 4.10738013e-02]
mat_Sqrt:  [[ 2.06332778e+01 -8.09937705e-03]
 [-8.09937705e-03  1.85778929e-02]]
grads:  [-0.00114461 -0.68449637]
Stock Position:  -0.0011446082546637745
Bond Position:  [16.79745694]


portfolio before change:  [16.70039422]
curr_Stock_Price:  103.15552978485027
curr_Factors:  [1.03155530e+02 3.81937222e-02]
mat_Sqrt:  [[ 2.01599047e+01 -7.81034578e-03]
 [-7.81034578e-03  1.79146789e-02]]
grads:  [ 2.98248843e-03 -5.69889048e+00]
Stock Position:  0.002982488431782753
Bond Position:  [16.39273405]


portfolio before change:  [16.71102284]
curr_Stock_Price:  99.84450040134475
curr_Factors:  [9.98445004e+01 4.12820128e-02]
mat_Sqrt:  [[ 2.02863795e+01 -8.11973610e-03]
 [-8.11973610e-03  1.86249836e-02]]
grads:  [0.00910927 7.04816331]
Stock Position:  0.009109268893956551
Bond Position:  [15.80151244]


portfolio before change:  [16.75068727]
curr_Stock_Price:  102.02910941763326
curr_Factors:  [1.02029109e+02 4.04152175e-02]
mat_Sqrt:  [[ 2.05114576e+01 -8.03419692e-03]
 [-8.03419692e-03  1.84283438e-02]]
grads:  [2.49501620e-03 2.66584391e+00]
Stock Position:  0.0024950161984701774
Bond Position:  [16.49612299]


portfolio before change:  [16.76927874]
curr_Stock_Price:  101.2108468399855
curr_Factors:  [1.01210847e+02 4.30424008e-02]
mat_Sqrt:  [[ 2.09978713e+01 -8.29115633e-03]
 [-8.29115633e-03  1.90179056e-02]]
grads:  [-3.08732436e-03  4.64303784e+00]
Stock Position:  -0.0030873243559692144
Bond Position:  [17.08174945]


portfolio before change:  [16.80295373]
curr_Stock_Price:  97.22375428308374
curr_Factors:  [9.72237543e+01 4.93148564e-02]
mat_Sqrt:  [[ 2.15904273e+01 -8.87441288e-03]
 [-8.87441288e-03  2.03566539e-02]]
grads:  [0.00120795 0.61166538]
Stock Position:  0.0012079540407927242
Bond Position:  [16.6855119]


portfolio before change:  [16.82483109]
curr_Stock_Price:  98.0577531037414
curr_Factors:  [9.80577531e+01 5.24664515e-02]
mat_Sqrt:  [[ 2.24606721e+01 -9.15366616e-03]
 [-9.15366616e-03  2.09970215e-02]]
grads:  [ 0.00246839 -0.20092135]
Stock Position:  0.0024683911353565683
Bond Position:  [16.5827862]


portfolio before change:  [16.83695928]
curr_Stock_Price:  94.5683328351384
curr_Factors:  [9.45683328e+01 5.48560704e-02]
mat_Sqrt:  [[ 2.21491998e+01 -9.35947748e-03]
 [-9.35947748e-03  2.14699996e-02]]
grads:  [ 4.71253265e-04 -5.16175230e+00]
Stock Position:  0.0004712532648997087
Bond Position:  [16.79239364]


portfolio before change:  [16.85800169]
curr_Stock_Price:  94.65066255533785
curr_Factors:  [9.46506626e+01 5.50874535e-02]
mat_Sqrt:  [[ 2.22151867e+01 -9.37920377e-03]
 [-9.37920377e-03  2.15152288e-02]]
grads:  [-2.14359475e-06  6.75155747e-01]
Stock Position:  -2.1435947541342186e-06
Bond Position:  [16.85820459]


portfolio before change:  [16.87908336]
curr_Stock_Price:  96.64195273667191
curr_Factors:  [9.66419527e+01 5.80009804e-02]
mat_Sqrt:  [[ 2.32746590e+01 -9.62422901e-03]
 [-9.62422901e-03  2.20767756e-02]]
grads:  [-0.00662536 -6.27998927]
Stock Position:  -0.006625360622000107
Bond Position:  [17.51937115]


portfolio before change:  [16.89607356]
curr_Stock_Price:  97.38496218514074
curr_Factors:  [9.73849622e+01 5.26351307e-02]
mat_Sqrt:  [[ 2.23423945e+01 -9.16830968e-03]
 [-9.16830968e-03  2.10307728e-02]]
grads:  [2.98929092e-03 6.60808719e+00]
Stock Position:  0.0029892909165935935
Bond Position:  [16.60496158]


portfolio before change:  [16.92393572]
curr_Stock_Price:  99.75775774294672
curr_Factors:  [9.97577577e+01 5.72244510e-02]
mat_Sqrt:  [[ 2.38636825e+01 -9.55986926e-03]
 [-9.55986926e-03  2.19283700e-02]]
grads:  [-0.00407418 -3.98958354]
Stock Position:  -0.004074183204817834
Bond Position:  [17.3303671]


portfolio before change:  [16.95789378]
curr_Stock_Price:  96.74327268115891
curr_Factors:  [9.67432727e+01 5.84582274e-02]
mat_Sqrt:  [[ 2.33907183e+01 -9.66210012e-03]
 [-9.66210012e-03  2.21636210e-02]]
grads:  [ 1.58939062e-03 -1.67181312e+00]
Stock Position:  0.001589390623826134
Bond Position:  [16.80413093]


portfolio before change:  [16.97117356]
curr_Stock_Price:  91.87441208929154
curr_Factors:  [9.18744121e+01 5.98127536e-02]
mat_Sqrt:  [[ 2.24693976e+01 -9.77290829e-03]
 [-9.77290829e-03  2.24191391e-02]]
grads:  [-1.38661443e-03  3.61870599e+00]
Stock Position:  -0.001386614433697326
Bond Position:  [17.09856795]


portfolio before change:  [16.99943091]
curr_Stock_Price:  86.91934160184104
curr_Factors:  [8.69193416e+01 5.93737805e-02]
mat_Sqrt:  [[ 2.11794039e+01 -9.73642671e-03]
 [-9.73642671e-03  2.23369604e-02]]
grads:  [ 1.71086703e-03 -5.51359240e+00]
Stock Position:  0.0017108670322932569
Bond Position:  [16.85072347]


portfolio before change:  [17.01974089]
curr_Stock_Price:  86.47127233258982
curr_Factors:  [8.64712723e+01 6.22179245e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.01974089]
Stock Price:  82.45254181089395
PL:  [17.01974089]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.27466368e-01 -2.41498310e-02]
 [-1.52546128e-01  8.13413189e-02]
 [ 4.79994347e-02  9.96469263e-02]
 [-1.95268687e-01 -1.05423880e-01]
 [-2.04831074e-01 -2.48823623e-02]
 [ 1.12819614e-01  8.58652851e-02]
 [ 1.27981919e-02  2.62493612e-02]
 [ 3.62309673e-02  1.05187609e-01]
 [ 4.16024794e-03 -1.39241348e-03]
 [ 4.94989652e-02  5.37918973e-02]
 [ 7.01928492e-02 -1.35338027e-01]
 [-1.06887814e-02  3.50374613e-02]
 [-1.24751946e-01 -1.36605277e-01]
 [ 6.21904777e-03  1.40615690e-01]
 [-5.59717804e-02 -9.32058575e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 2.90677338e-02 -1.46174785e-01]
 [ 2.04164953e-03  3.81764705e-02]
 [-8.60786305e-02 -7.92795144e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.7827193]
curr_Stock_Price:  92.99903728002342
curr_Factors:  [9.29990373e+01 4.34229170e-02]
mat_Sqrt:  [[ 1.93792921e+01 -8.32705930e-03]
 [-8.32705930e-03  1.91020746e-02]]
grads:  [ 0.00603535 -1.26162078]
Stock Position:  0.006035348234787283
Bond Position:  [-20.34400088]


portfolio before change:  [-19.81148082]
curr_Stock_Price:  92.4496709848149
curr_Factors:  [9.24496710e+01 4.20039634e-02]
mat_Sqrt:  [[ 1.89474367e+01 -8.18982751e-03]
 [-8.18982751e-03  1.87873990e-02]]
grads:  [-0.00618077  4.32687354]
Stock Position:  -0.0061807716543887045
Bond Position:  [-19.24007052]


portfolio before change:  [-19.84313342]
curr_Stock_Price:  93.6772641199908
curr_Factors:  [9.36772641e+01 4.26604465e-02]
mat_Sqrt:  [[ 1.93484802e+01 -8.25368623e-03]
 [-8.25368623e-03  1.89335979e-02]]
grads:  [4.72674494e-03 5.26502887e+00]
Stock Position:  0.004726744944665122
Bond Position:  [-20.28592195]


portfolio before change:  [-19.86869227]
curr_Stock_Price:  93.6380000960386
curr_Factors:  [9.36380001e+01 4.36455437e-02]
mat_Sqrt:  [[ 1.95623959e+01 -8.34843428e-03]
 [-8.34843428e-03  1.91509551e-02]]
grads:  [-0.0123334  -5.51026533]
Stock Position:  -0.012333395963696425
Bond Position:  [-18.71381774]


portfolio before change:  [-19.95283655]
curr_Stock_Price:  98.56262767505056
curr_Factors:  [9.85626277e+01 4.82855494e-02]
mat_Sqrt:  [[ 2.16581235e+01 -8.78142284e-03]
 [-8.78142284e-03  2.01430411e-02]]
grads:  [-0.00996008 -1.23962543]
Stock Position:  -0.009960084909562373
Bond Position:  [-18.97114441]


portfolio before change:  [-19.96930752]
curr_Stock_Price:  97.83394091374488
curr_Factors:  [9.78339409e+01 4.65131393e-02]
mat_Sqrt:  [[ 2.10997514e+01 -8.61868725e-03]
 [-8.61868725e-03  1.97699171e-02]]
grads:  [0.00712233 4.34633436]
Stock Position:  0.007122326120890926
Bond Position:  [-20.66611276]


portfolio before change:  [-19.99687254]
curr_Stock_Price:  97.59297709395146
curr_Factors:  [9.75929771e+01 4.94522310e-02]
mat_Sqrt:  [[ 2.17025854e+01 -8.88679652e-03]
 [-8.88679652e-03  2.03849738e-02]]
grads:  [1.11718887e-03 1.28816891e+00]
Stock Position:  0.0011171888658921684
Bond Position:  [-20.10590233]


portfolio before change:  [-20.02039201]
curr_Stock_Price:  99.05076725246452
curr_Factors:  [9.90507673e+01 5.13786004e-02]
mat_Sqrt:  [[ 2.24516852e+01 -9.05835683e-03]
 [-9.05835683e-03  2.07781658e-02]]
grads:  [3.65685384e-03 5.06400495e+00]
Stock Position:  0.003656853839281732
Bond Position:  [-20.38260618]


portfolio before change:  [-20.05540826]
curr_Stock_Price:  96.44687133897963
curr_Factors:  [9.64468713e+01 5.75910545e-02]
mat_Sqrt:  [[ 2.31454496e+01 -9.59014038e-03]
 [-9.59014038e-03  2.19986307e-02]]
grads:  [ 0.00015355 -0.06322852]
Stock Position:  0.00015354540851942298
Bond Position:  [-20.07021723]


portfolio before change:  [-20.08052884]
curr_Stock_Price:  96.33533530049279
curr_Factors:  [9.63353353e+01 6.00194755e-02]
mat_Sqrt:  [[ 2.36010690e+01 -9.79023393e-03]
 [-9.79023393e-03  2.24576507e-02]]
grads:  [0.00309148 2.39660704]
Stock Position:  0.003091483225443632
Bond Position:  [-20.37834792]


portfolio before change:  [-20.09238005]
curr_Stock_Price:  100.74669814972299
curr_Factors:  [1.00746698e+02 5.96489245e-02]
mat_Sqrt:  [[ 2.46054944e+01 -9.76037173e-03]
 [-9.76037173e-03  2.23880412e-02]]
grads:  [ 4.54871059e-04 -6.04490521e+00]
Stock Position:  0.00045487105874317756
Bond Position:  [-20.13820681]


portfolio before change:  [-20.11886848]
curr_Stock_Price:  97.88890881394656
curr_Factors:  [9.78889088e+01 6.69645756e-02]
mat_Sqrt:  [[ 2.53312144e+01 -1.03413225e-02]
 [-1.03413225e-02  2.37213575e-02]]
grads:  [1.81065590e-04 1.47712177e+00]
Stock Position:  0.00018106558960768386
Bond Position:  [-20.13659279]


portfolio before change:  [-20.14512189]
curr_Stock_Price:  91.99635660076976
curr_Factors:  [9.19963566e+01 6.80430565e-02]
mat_Sqrt:  [[ 2.39973062e+01 -1.04236401e-02]
 [-1.04236401e-02  2.39118860e-02]]
grads:  [-0.00768151 -5.71620935]
Stock Position:  -0.007681514457014538
Bond Position:  [-19.43845055]


portfolio before change:  [-20.21008144]
curr_Stock_Price:  97.28779956082846
curr_Factors:  [9.72877996e+01 6.85190714e-02]
mat_Sqrt:  [[ 2.54661961e+01 -1.04606037e-02]
 [-1.04606037e-02  2.39951346e-02]]
grads:  [2.65183341e-03 5.86133113e+00]
Stock Position:  0.0026518334137869905
Bond Position:  [-20.46807248]


portfolio before change:  [-20.22729728]
curr_Stock_Price:  100.4498595490164
curr_Factors:  [1.00449860e+02 6.80802442e-02]
mat_Sqrt:  [[ 2.62095673e+01 -1.04273616e-02]
 [-1.04273616e-02  2.39180386e-02]]
grads:  [-3.68654591e-03 -3.89849268e+00]
Stock Position:  -0.0036865459122636768
Bond Position:  [-19.85698426]


portfolio before change:  [-20.26559556]
curr_Stock_Price:  104.10138874651524
curr_Factors:  [1.04101389e+02 6.88915248e-02]
mat_Sqrt:  [[ 2.73236925e+01 -1.04896421e-02]
 [-1.04896421e-02  2.40599804e-02]]
grads:  [ 0.00397649 -2.53540657]
Stock Position:  0.003976488768833377
Bond Position:  [-20.67955356]


portfolio before change:  [-20.28711894]
curr_Stock_Price:  105.19336164513537
curr_Factors:  [1.05193362e+02 7.05859577e-02]
mat_Sqrt:  [[ 2.79477892e+01 -1.06179553e-02]
 [-1.06179553e-02  2.43540264e-02]]
grads:  [-1.24044920e-03 -6.00261958e+00]
Stock Position:  -0.0012404492019801835
Bond Position:  [-20.15663192]


portfolio before change:  [-20.31118434]
curr_Stock_Price:  104.26938119590943
curr_Factors:  [1.04269381e+02 7.20109237e-02]
mat_Sqrt:  [[ 2.79805312e+01 -1.07245130e-02]
 [-1.07245130e-02  2.45986597e-02]]
grads:  [6.67926331e-04 1.55226480e+00]
Stock Position:  0.0006679263307272103
Bond Position:  [-20.3808286]


portfolio before change:  [-20.33745725]
curr_Stock_Price:  103.10017147732674
curr_Factors:  [1.03100171e+02 6.82119235e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.33745725]
Stock Price:  100.22835460787294
PL:  [-20.56581186]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 4.17112786e-02 -3.31575377e-02]
 [-1.12314383e-02 -1.05318640e-01]
 [-5.16799033e-01 -7.89370413e-02]
 [-2.24588643e-02 -2.46281781e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [ 5.96887738e-02 -6.88224272e-02]
 [ 4.47270937e-02  3.76283933e-02]
 [ 8.59758329e-02 -7.15685074e-02]
 [ 1.46403419e-01 -1.09049600e-01]
 [ 5.96296142e-01 -4.84526678e-02]
 [ 1.83780239e-02  1.78187147e-01]
 [-7.21517650e-02 -1.01059298e-01]
 [ 4.34191702e-02 -1.34085193e-01]
 [ 2.45835349e-01 -1.96880392e-01]
 [ 1.46608415e-01 -1.49096032e-01]
 [-1.38923017e-01  4.79623642e-02]
 [-1.15578871e-01 -1.34460070e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.18420149]
curr_Stock_Price:  104.21620233940195
curr_Factors:  [1.04216202e+02 3.93028841e-02]
mat_Sqrt:  [[ 2.06608137e+01 -7.92301364e-03]
 [-7.92301364e-03  1.81729111e-02]]
grads:  [ 1.31939794e-03 -1.82398318e+00]
Stock Position:  0.0013193979393295435
Bond Position:  [22.04669885]


portfolio before change:  [22.21099394]
curr_Stock_Price:  103.62263174696322
curr_Factors:  [1.03622632e+02 4.36693813e-02]
mat_Sqrt:  [[ 2.16542479e+01 -8.35150078e-03]
 [-8.35150078e-03  1.91558411e-02]]
grads:  [-2.63955251e-03 -5.49914169e+00]
Stock Position:  -0.00263955250842092
Bond Position:  [22.48451132]


portfolio before change:  [22.22040152]
curr_Stock_Price:  110.71309004311581
curr_Factors:  [1.10713090e+02 4.08301567e-02]
mat_Sqrt:  [[ 2.23712096e+01 -8.07590336e-03]
 [-8.07590336e-03  1.85224553e-02]]
grads:  [-0.02464341 -4.27243892]
Stock Position:  -0.0246434075722945
Bond Position:  [24.94874932]


portfolio before change:  [22.1964402]
curr_Stock_Price:  112.951691040193
curr_Factors:  [1.12951691e+02 3.81867198e-02]
mat_Sqrt:  [[ 2.20723659e+01 -7.81023116e-03]
 [-7.81023116e-03  1.79127744e-02]]
grads:  [-0.00150424 -1.37555054]
Stock Position:  -0.0015042443651095163
Bond Position:  [22.36634714]


portfolio before change:  [22.22632127]
curr_Stock_Price:  111.68483930808719
curr_Factors:  [1.11684839e+02 4.00244259e-02]
mat_Sqrt:  [[ 2.23437854e+01 -7.99588008e-03]
 [-7.99588008e-03  1.83387612e-02]]
grads:  [ 0.00733866 -6.43725275]
Stock Position:  0.00733866162994179
Bond Position:  [21.40670402]


portfolio before change:  [22.24919518]
curr_Stock_Price:  111.15324452063219
curr_Factors:  [1.11153245e+02 4.24140398e-02]
mat_Sqrt:  [[ 2.28916415e+01 -8.23108019e-03]
 [-8.23108019e-03  1.88782869e-02]]
grads:  [0.00755613 5.62936439]
Stock Position:  0.007556125575730465
Bond Position:  [21.40930731]


portfolio before change:  [22.35434999]
curr_Stock_Price:  121.52581482327484
curr_Factors:  [1.21525815e+02 4.18344798e-02]
mat_Sqrt:  [[ 2.48562555e+01 -8.17522557e-03]
 [-8.17522557e-03  1.87486129e-02]]
grads:  [3.61080306e-03 4.32123577e+00]
Stock Position:  0.003610803060783473
Bond Position:  [21.91554421]


portfolio before change:  [22.36838943]
curr_Stock_Price:  117.82244876148093
curr_Factors:  [1.17822449e+02 4.69599142e-02]
mat_Sqrt:  [[ 2.55324016e+01 -8.66135655e-03]
 [-8.66135655e-03  1.98640390e-02]]
grads:  [ 1.16261622e-03 -3.46416745e+00]
Stock Position:  0.001162616224423802
Bond Position:  [22.23140714]


portfolio before change:  [22.40203119]
curr_Stock_Price:  122.8414160042222
curr_Factors:  [1.22841416e+02 4.99408066e-02]
mat_Sqrt:  [[ 2.74519101e+01 -8.93231109e-03]
 [-8.93231109e-03  2.04846744e-02]]
grads:  [0.0022273  1.83787584]
Stock Position:  0.0022272975662534964
Bond Position:  [22.12842681]


portfolio before change:  [22.43333071]
curr_Stock_Price:  124.46746021210126
curr_Factors:  [1.24467460e+02 5.83228097e-02]
mat_Sqrt:  [[ 3.00590343e+01 -9.65293792e-03]
 [-9.65293792e-03  2.21370478e-02]]
grads:  [ 1.82227420e-03 -3.23217972e+00]
Stock Position:  0.0018222741969284193
Bond Position:  [22.20651687]


portfolio before change:  [22.46548815]
curr_Stock_Price:  126.87211408058248
curr_Factors:  [1.26872114e+02 5.64569623e-02]
mat_Sqrt:  [[ 3.01456678e+01 -9.49740822e-03]
 [-9.49740822e-03  2.17800106e-02]]
grads:  [ 3.27956737e-03 -5.00543615e+00]
Stock Position:  0.0032795673697970534
Bond Position:  [22.0494025]


portfolio before change:  [22.4974026]
curr_Stock_Price:  128.19407649207878
curr_Factors:  [1.28194076e+02 5.02904435e-02]
mat_Sqrt:  [[ 2.87482008e+01 -8.96380330e-03]
 [-8.96380330e-03  2.05561345e-02]]
grads:  [ 0.0200098  -2.34836486]
Stock Position:  0.020009803923754805
Bond Position:  [19.93226426]


portfolio before change:  [22.3691103]
curr_Stock_Price:  120.53666973029246
curr_Factors:  [1.20536670e+02 4.55145367e-02]
mat_Sqrt:  [[ 2.57154559e+01 -8.52717027e-03]
 [-8.52717027e-03  1.95558875e-02]]
grads:  [3.73661793e-03 9.11331743e+00]
Stock Position:  0.003736617925286136
Bond Position:  [21.91871082]


portfolio before change:  [22.414367]
curr_Stock_Price:  125.31135776847731
curr_Factors:  [1.25311358e+02 4.32856042e-02]
mat_Sqrt:  [[ 2.60712681e+01 -8.31599440e-03]
 [-8.31599440e-03  1.90709276e-02]]
grads:  [-4.45837371e-03 -5.30107273e+00]
Stock Position:  -0.00445837370728009
Bond Position:  [22.97305187]


portfolio before change:  [22.45506728]
curr_Stock_Price:  122.62741823949705
curr_Factors:  [1.22627418e+02 4.65364237e-02]
mat_Sqrt:  [[ 2.64535563e+01 -8.62247614e-03]
 [-8.62247614e-03  1.97741534e-02]]
grads:  [-5.68941380e-04 -6.78107913e+00]
Stock Position:  -0.0005689413796005163
Bond Position:  [22.52483509]


portfolio before change:  [22.48233268]
curr_Stock_Price:  124.223797014236
curr_Factors:  [1.24223797e+02 4.50847912e-02]
mat_Sqrt:  [[ 2.63766604e+01 -8.48700970e-03]
 [-8.48700970e-03  1.94632623e-02]]
grads:  [ 6.06625531e-03 -1.01128426e+01]
Stock Position:  0.006066255306660507
Bond Position:  [21.72875942]


portfolio before change:  [22.49985271]
curr_Stock_Price:  122.63172701982387
curr_Factors:  [1.22631727e+02 4.30331671e-02]
mat_Sqrt:  [[ 2.54392601e+01 -8.29157751e-03]
 [-8.29157751e-03  1.90152942e-02]]
grads:  [ 3.20791617e-03 -7.83944924e+00]
Stock Position:  0.003207916169147736
Bond Position:  [22.10646041]


portfolio before change:  [22.53366454]
curr_Stock_Price:  124.55243594686576
curr_Factors:  [1.24552436e+02 4.05044191e-02]
mat_Sqrt:  [[ 2.50670604e+01 -8.04436405e-03]
 [-8.04436405e-03  1.84481001e-02]]
grads:  [-0.00470838  2.59780075]
Stock Position:  -0.0047083846210449
Bond Position:  [23.12010531]


portfolio before change:  [22.56970625]
curr_Stock_Price:  123.03949400193837
curr_Factors:  [1.23039494e+02 3.95939547e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.56970625]
Stock Price:  125.85463716307828
PL:  [-3.28493091]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 2.01869425e-02 -4.99616205e-02]
 [-1.60985234e-02  6.14143745e-02]
 [ 6.03425831e-02  6.29605354e-02]
 [ 2.31710064e-02  2.28938162e-02]
 [-2.13905269e-01 -1.09854411e-02]
 [ 1.23215521e-01  1.12174119e-01]
 [ 2.73026819e-02  4.59328423e-02]
 [-2.72536172e-01  6.21831513e-02]
 [ 8.15854005e-02  7.41296447e-02]
 [ 6.30384162e-02 -4.64147628e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [-2.65311742e-03  3.59486354e-02]
 [ 1.73480082e-02 -2.28676708e-02]
 [ 1.32031222e-02 -6.02814535e-02]
 [-4.77255099e-02 -8.76324045e-02]
 [ 1.49363714e-01 -7.83823281e-02]
 [ 2.88425056e-02 -1.46148903e-01]
 [-2.08492579e-02  3.65386477e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.46939879]
curr_Stock_Price:  99.48128583617004
curr_Factors:  [9.94812858e+01 3.99827352e-02]
mat_Sqrt:  [[ 1.98919613e+01 -7.99091071e-03]
 [-7.99091071e-03  1.83295580e-02]]
grads:  [-8.01573278e-05 -2.72577554e+00]
Stock Position:  -8.015732778766634e-05
Bond Position:  [4.47737295]


portfolio before change:  [4.47526262]
curr_Stock_Price:  96.19257361913277
curr_Factors:  [9.61925736e+01 3.99741970e-02]
mat_Sqrt:  [[ 1.92323069e+01 -7.98980597e-03]
 [-7.98980597e-03  1.83277105e-02]]
grads:  [5.55132188e-04 3.35114471e+00]
Stock Position:  0.0005551321883312826
Bond Position:  [4.42186303]


portfolio before change:  [4.48134882]
curr_Stock_Price:  97.19306732317466
curr_Factors:  [9.71930673e+01 3.33431113e-02]
mat_Sqrt:  [[ 1.77475461e+01 -7.29715676e-03]
 [-7.29715676e-03  1.67386564e-02]]
grads:  [0.00494749 3.76354211]
Stock Position:  0.004947486225854306
Bond Position:  [4.00048745]


portfolio before change:  [4.48633437]
curr_Stock_Price:  97.18939286183296
curr_Factors:  [9.71893929e+01 3.45660299e-02]
mat_Sqrt:  [[ 1.80693938e+01 -7.42976966e-03]
 [-7.42976966e-03  1.70428525e-02]]
grads:  [0.001835   1.34410891]
Stock Position:  0.0018350048895563655
Bond Position:  [4.30799136]


portfolio before change:  [4.49316541]
curr_Stock_Price:  97.97559257438917
curr_Factors:  [9.79755926e+01 3.37509227e-02]
mat_Sqrt:  [[ 1.79995102e+01 -7.34170126e-03]
 [-7.34170126e-03  1.68406844e-02]]
grads:  [-0.01215218 -0.65761334]
Stock Position:  -0.012152178965831416
Bond Position:  [5.68378234]


portfolio before change:  [4.49311948]
curr_Stock_Price:  98.5643838924291
curr_Factors:  [9.85643839e+01 3.21298555e-02]
mat_Sqrt:  [[ 1.76674700e+01 -7.16325967e-03]
 [-7.16325967e-03  1.64312588e-02]]
grads:  [0.00974382 6.83112096]
Stock Position:  0.009743818113894163
Bond Position:  [3.53272605]


portfolio before change:  [4.50357541]
curr_Stock_Price:  99.1839831949023
curr_Factors:  [9.91839832e+01 3.34830819e-02]
mat_Sqrt:  [[ 1.81490636e+01 -7.31259535e-03]
 [-7.31259535e-03  1.67736928e-02]]
grads:  [2.60816233e-03 2.73952286e+00]
Stock Position:  0.002608162328734694
Bond Position:  [4.24488748]


portfolio before change:  [4.52178485]
curr_Stock_Price:  104.12999941416756
curr_Factors:  [1.04129999e+02 2.98721495e-02]
mat_Sqrt:  [[ 1.79973711e+01 -6.90734445e-03]
 [-6.90734445e-03  1.58432979e-02]]
grads:  [-0.01363903  3.91894051]
Stock Position:  -0.013639030881439689
Bond Position:  [5.94201713]


portfolio before change:  [4.5409574]
curr_Stock_Price:  103.26920616915918
curr_Factors:  [1.03269206e+02 3.38500737e-02]
mat_Sqrt:  [[ 1.89998694e+01 -7.35282961e-03]
 [-7.35282961e-03  1.68652493e-02]]
grads:  [0.005996  4.3980217]
Stock Position:  0.005996004625250672
Bond Position:  [3.92175477]


portfolio before change:  [4.55316279]
curr_Stock_Price:  104.48670529208287
curr_Factors:  [1.04486705e+02 3.36532134e-02]
mat_Sqrt:  [[ 1.91678884e+01 -7.33149344e-03]
 [-7.33149344e-03  1.68161035e-02]]
grads:  [ 2.23340318e-03 -2.75916407e+00]
Stock Position:  0.002233403180515597
Bond Position:  [4.31980185]


portfolio before change:  [4.5656912]
curr_Stock_Price:  107.6770272315297
curr_Factors:  [1.07677027e+02 3.35410524e-02]
mat_Sqrt:  [[ 1.97202025e+01 -7.31945596e-03]
 [-7.31945596e-03  1.67879745e-02]]
grads:  [ 4.86868015e-04 -7.28785603e+00]
Stock Position:  0.00048686801485182897
Bond Position:  [4.5132667]


portfolio before change:  [4.57077846]
curr_Stock_Price:  106.53123839630602
curr_Factors:  [1.06531238e+02 3.89222643e-02]
mat_Sqrt:  [[ 2.10172550e+01 -7.88470657e-03]
 [-7.88470657e-03  1.80846356e-02]]
grads:  [6.19597126e-04 1.98806995e+00]
Stock Position:  0.0006195971263123747
Bond Position:  [4.50477201]


portfolio before change:  [4.57475518]
curr_Stock_Price:  103.85569090798641
curr_Factors:  [1.03855691e+02 3.83516734e-02]
mat_Sqrt:  [[ 2.03386642e+01 -7.82652590e-03]
 [-7.82652590e-03  1.79516636e-02]]
grads:  [ 3.62828672e-04 -1.27368870e+00]
Stock Position:  0.0003628286724897818
Bond Position:  [4.53707336]


portfolio before change:  [4.58073663]
curr_Stock_Price:  104.70061150960103
curr_Factors:  [1.04700612e+02 3.86410513e-02]
mat_Sqrt:  [[ 2.05813403e+01 -7.85605337e-03]
 [-7.85605337e-03  1.80192380e-02]]
grads:  [-6.35558691e-04 -3.34567125e+00]
Stock Position:  -0.0006355586913252063
Bond Position:  [4.64728002]


portfolio before change:  [4.58707515]
curr_Stock_Price:  103.8733385354034
curr_Factors:  [1.03873339e+02 3.69382835e-02]
mat_Sqrt:  [[ 1.99637634e+01 -7.68095620e-03]
 [-7.68095620e-03  1.76177679e-02]]
grads:  [-4.30508568e-03 -4.97596926e+00]
Stock Position:  -0.0043050856791901244
Bond Position:  [5.03425877]


portfolio before change:  [4.57022835]
curr_Stock_Price:  109.24920220816458
curr_Factors:  [1.09249202e+02 3.59784542e-02]
mat_Sqrt:  [[ 2.07223734e+01 -7.58083468e-03]
 [-7.58083468e-03  1.73872220e-02]]
grads:  [ 0.00555956 -4.5056181 ]
Stock Position:  0.005559564313355607
Bond Position:  [3.96285038]


portfolio before change:  [4.54957217]
curr_Stock_Price:  104.64221490482662
curr_Factors:  [1.04642215e+02 3.80040600e-02]
mat_Sqrt:  [[ 2.03996112e+01 -7.79102763e-03]
 [-7.79102763e-03  1.78701004e-02]]
grads:  [-1.70990882e-03 -8.17914962e+00]
Stock Position:  -0.0017099088236419608
Bond Position:  [4.72850082]


portfolio before change:  [4.55166681]
curr_Stock_Price:  106.87606589826709
curr_Factors:  [1.06876066e+02 4.05991646e-02]
mat_Sqrt:  [[ 2.15347075e+01 -8.05278752e-03]
 [-8.05278752e-03  1.84700909e-02]]
grads:  [-2.28447497e-04  1.97816070e+00]
Stock Position:  -0.0002284474969224728
Bond Position:  [4.57608238]


portfolio before change:  [4.55674774]
curr_Stock_Price:  109.68962512855771
curr_Factors:  [1.09689625e+02 3.74630169e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.55674774]
Stock Price:  105.56867197913199
PL:  [-1.01192424]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-3.62662328e-02 -7.30888691e-02]
 [ 2.33027724e-02 -6.37970969e-02]
 [-1.66348741e-01 -2.24492213e-01]
 [-2.42774800e-02 -2.95712749e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-1.82925605e-01  4.33972885e-02]
 [ 4.98213501e-02  3.99633082e-02]
 [ 6.61228907e-02 -4.29835241e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 2.63223722e-01 -1.22433048e-03]
 [ 1.26159569e-02  1.66974055e-01]
 [-5.93975557e-02 -1.23060431e-01]
 [-8.07456556e-03 -1.08824997e-01]
 [ 1.92485864e-01 -1.31350139e-01]
 [ 1.05114461e-01 -1.50140825e-01]
 [-9.42941857e-02  4.34091349e-02]
 [-1.13588633e-01 -1.30401354e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.24652085]
curr_Stock_Price:  100.22357132932562
curr_Factors:  [1.00223571e+02 3.94665906e-02]
mat_Sqrt:  [[ 1.99106136e+01 -7.93921922e-03]
 [-7.93921922e-03  1.82108403e-02]]
grads:  [-3.42239513e-03 -4.01497345e+00]
Stock Position:  -0.0034223951347666427
Bond Position:  [7.58952551]


portfolio before change:  [7.25386317]
curr_Stock_Price:  100.85193810075295
curr_Factors:  [1.00851938e+02 3.77605013e-02]
mat_Sqrt:  [[ 1.95976091e+01 -7.76576666e-03]
 [-7.76576666e-03  1.78128572e-02]]
grads:  [-2.30194015e-04 -3.58161994e+00]
Stock Position:  -0.00023019401530814822
Bond Position:  [7.27707868]


portfolio before change:  [7.26169328]
curr_Stock_Price:  106.37737222327787
curr_Factors:  [1.06377372e+02 3.84601136e-02]
mat_Sqrt:  [[ 2.08619312e+01 -7.83774678e-03]
 [-7.83774678e-03  1.79769536e-02]]
grads:  [ -0.01266748 -12.49330124]
Stock Position:  -0.012667478888362204
Bond Position:  [8.6092264]


portfolio before change:  [7.24408046]
curr_Stock_Price:  108.61784051834917
curr_Factors:  [1.08617841e+02 3.91134318e-02]
mat_Sqrt:  [[ 2.14814749e+01 -7.90417634e-03]
 [-7.90417634e-03  1.81289358e-02]]
grads:  [-0.00173063 -1.63191896]
Stock Position:  -0.0017306286225343226
Bond Position:  [7.43205761]


portfolio before change:  [7.24851697]
curr_Stock_Price:  111.42570459697828
curr_Factors:  [1.11425705e+02 4.23596103e-02]
mat_Sqrt:  [[ 2.29330247e+01 -8.22581363e-03]
 [-8.22581363e-03  1.88661626e-02]]
grads:  [ 0.00715011 -6.25729283]
Stock Position:  0.007150110332867357
Bond Position:  [6.45181089]


portfolio before change:  [7.24056071]
curr_Stock_Price:  109.1843314589874
curr_Factors:  [1.09184331e+02 4.26079888e-02]
mat_Sqrt:  [[ 2.25375035e+01 -8.24975550e-03]
 [-8.24975550e-03  1.89214540e-02]]
grads:  [0.00767484 5.61658087]
Stock Position:  0.007674842366237688
Bond Position:  [6.40258818]


portfolio before change:  [7.22884605]
curr_Stock_Price:  106.61451989529837
curr_Factors:  [1.06614520e+02 4.21401009e-02]
mat_Sqrt:  [[ 2.18858849e+01 -8.20416836e-03]
 [-8.20416836e-03  1.88173492e-02]]
grads:  [4.10074395e-03 4.30567025e+00]
Stock Position:  0.004100743948577265
Bond Position:  [6.79164721]


portfolio before change:  [7.25467144]
curr_Stock_Price:  110.84070969029548
curr_Factors:  [1.10840710e+02 3.73918623e-02]
mat_Sqrt:  [[ 2.14332395e+01 -7.72839928e-03]
 [-7.72839928e-03  1.77254187e-02]]
grads:  [-0.00765306  2.44497145]
Stock Position:  -0.007653061016620619
Bond Position:  [8.10294216]


portfolio before change:  [7.23524288]
curr_Stock_Price:  114.7036831186701
curr_Factors:  [1.14703683e+02 3.73000417e-02]
mat_Sqrt:  [[ 2.21529718e+01 -7.71911922e-03]
 [-7.71911922e-03  1.77035481e-02]]
grads:  [0.003036   2.25868528]
Stock Position:  0.0030359994800204996
Bond Position:  [6.88700256]


portfolio before change:  [7.24459515]
curr_Stock_Price:  114.9468107819253
curr_Factors:  [1.14946811e+02 3.71979049e-02]
mat_Sqrt:  [[ 2.21695123e+01 -7.70855656e-03]
 [-7.70855656e-03  1.76792875e-02]]
grads:  [ 2.13754442e-03 -2.43036077e+00]
Stock Position:  0.002137544415347334
Bond Position:  [6.99889124]


portfolio before change:  [7.25714168]
curr_Stock_Price:  116.72101632965682
curr_Factors:  [1.16721016e+02 2.75017487e-02]
mat_Sqrt:  [[ 1.93566051e+01 -6.62825546e-03]
 [-6.62825546e-03  1.52014380e-02]]
grads:  [ 4.9579100e-04 -8.0484898e+00]
Stock Position:  0.000495790999900349
Bond Position:  [7.19927245]


portfolio before change:  [7.26590758]
curr_Stock_Price:  116.23932441694421
curr_Factors:  [1.16239324e+02 2.52067302e-02]
mat_Sqrt:  [[ 1.84548835e+01 -6.34564727e-03]
 [-6.34564727e-03  1.45533523e-02]]
grads:  [ 0.0142363  -0.07791964]
Stock Position:  0.014236300748047137
Bond Position:  [5.6110896]


portfolio before change:  [7.31707194]
curr_Stock_Price:  119.34027814566024
curr_Factors:  [1.19340278e+02 2.20531598e-02]
mat_Sqrt:  [[ 1.77223959e+01 -5.93556378e-03]
 [-5.93556378e-03  1.36125193e-02]]
grads:  [4.82075456e-03 1.22683146e+01]
Stock Position:  0.004820754557933319
Bond Position:  [6.74176175]


portfolio before change:  [7.3400121]
curr_Stock_Price:  122.34970091253692
curr_Factors:  [1.22349701e+02 2.25846270e-02]
mat_Sqrt:  [[ 1.83869354e+01 -6.00677305e-03]
 [-6.00677305e-03  1.37755199e-02]]
grads:  [-6.14968090e-03 -8.93595102e+00]
Stock Position:  -0.00614968090094696
Bond Position:  [8.09242372]


portfolio before change:  [7.39396132]
curr_Stock_Price:  115.22292958728534
curr_Factors:  [1.15222930e+02 2.63320264e-02]
mat_Sqrt:  [[ 1.86973918e+01 -6.48569907e-03]
 [-6.48569907e-03  1.48746755e-02]]
grads:  [-2.97010169e-03 -7.31742081e+00]
Stock Position:  -0.002970101687741058
Bond Position:  [7.73618514]


portfolio before change:  [7.40123936]
curr_Stock_Price:  116.03038880013776
curr_Factors:  [1.16030389e+02 2.77355192e-02]
mat_Sqrt:  [[ 1.93236816e+01 -6.65633553e-03]
 [-6.65633553e-03  1.52659225e-02]]
grads:  [ 6.99836265e-03 -8.60108884e+00]
Stock Position:  0.0069983626462552
Bond Position:  [6.58921662]


portfolio before change:  [7.41078955]
curr_Stock_Price:  116.21736324762227
curr_Factors:  [1.16217363e+02 3.05333012e-02]
mat_Sqrt:  [[ 2.03075660e+01 -6.98400413e-03]
 [-6.98400413e-03  1.60173874e-02]]
grads:  [ 1.9527225e-03 -9.3727637e+00]
Stock Position:  0.0019527224988850013
Bond Position:  [7.18384929]


portfolio before change:  [7.42256132]
curr_Stock_Price:  117.64426707008369
curr_Factors:  [1.17644267e+02 3.25461066e-02]
mat_Sqrt:  [[ 2.12236593e+01 -7.21059793e-03]
 [-7.21059793e-03  1.65368783e-02]]
grads:  [-0.00355158  2.62344108]
Stock Position:  -0.00355158391282083
Bond Position:  [7.84038481]


portfolio before change:  [7.41568613]
curr_Stock_Price:  122.34126965997777
curr_Factors:  [1.22341270e+02 2.97710601e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.41568613]
Stock Price:  128.88864738860414
PL:  [-21.47296126]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.31970774e-01 -1.02949152e-02]
 [ 4.47962347e-02 -5.15613721e-03]
 [ 7.13839761e-02 -5.18903881e-03]
 [ 1.26860621e-02  1.05817867e-02]
 [-1.85386500e-01 -2.15640320e-05]
 [ 1.29455934e-01  1.29160133e-01]
 [ 2.46046287e-02  4.24455534e-02]
 [-2.33985860e-01  6.81204555e-02]
 [ 5.21173613e-02  4.04958433e-02]
 [ 5.10886757e-02  4.24760759e-02]
 [ 5.87427410e-02 -1.10809522e-01]
 [ 8.57608146e-04 -8.28466620e-03]
 [-1.23129111e-01 -1.37350185e-01]
 [ 4.83302998e-03  1.65340919e-01]
 [-8.76478708e-02 -1.20068123e-02]
 [-7.37154730e-03 -8.94577561e-03]
 [-8.11959373e-03 -5.06836926e-02]
 [ 7.64789091e-02  1.42368795e-02]
 [-4.76177848e-02 -4.45858714e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.36672234]
curr_Stock_Price:  98.38469837971576
curr_Factors:  [9.83846984e+01 3.92593232e-02]
mat_Sqrt:  [[ 1.94939087e+01 -7.91820927e-03]
 [-7.91820927e-03  1.81630172e-02]]
grads:  [ 0.00654077 -0.56395498]
Stock Position:  0.006540774501307491
Bond Position:  [-0.27678978]


portfolio before change:  [0.36705658]
curr_Stock_Price:  98.48872952639907
curr_Factors:  [9.84887295e+01 3.80202234e-02]
mat_Sqrt:  [[ 1.92040944e+01 -7.79225813e-03]
 [-7.79225813e-03  1.78740859e-02]]
grads:  [ 0.00221598 -0.28750392]
Stock Position:  0.002215982129768763
Bond Position:  [0.14880732]


portfolio before change:  [0.37110519]
curr_Stock_Price:  100.23174100944276
curr_Factors:  [1.00231741e+02 3.76370401e-02]
mat_Sqrt:  [[ 1.94452249e+01 -7.75301728e-03]
 [-7.75301728e-03  1.77837320e-02]]
grads:  [ 0.00355531 -0.29023573]
Stock Position:  0.0035553085060399878
Bond Position:  [0.01475043]


portfolio before change:  [0.35539847]
curr_Stock_Price:  95.80872771929204
curr_Factors:  [9.58087277e+01 4.28611218e-02]
mat_Sqrt:  [[ 1.98352100e+01 -8.27325611e-03]
 [-8.27325611e-03  1.89779991e-02]]
grads:  [0.0008723  0.55796206]
Stock Position:  0.0008722985602489437
Bond Position:  [0.27182465]


portfolio before change:  [0.35600947]
curr_Stock_Price:  96.11941497037571
curr_Factors:  [9.61194150e+01 4.28848547e-02]
mat_Sqrt:  [[ 1.99050399e+01 -8.27557188e-03]
 [-8.27557188e-03  1.89832415e-02]]
grads:  [-0.00931571 -0.00519705]
Stock Position:  -0.009315706428474185
Bond Position:  [1.25142972]


portfolio before change:  [0.32911938]
curr_Stock_Price:  99.17397185556176
curr_Factors:  [9.91739719e+01 3.61892976e-02]
mat_Sqrt:  [[ 1.88663440e+01 -7.60236760e-03]
 [-7.60236760e-03  1.74383767e-02]]
grads:  [0.00984805 7.41095366]
Stock Position:  0.009848051534564436
Bond Position:  [-0.64755101]


portfolio before change:  [0.33875353]
curr_Stock_Price:  100.23449624779578
curr_Factors:  [1.00234496e+02 3.40419277e-02]
mat_Sqrt:  [[ 1.84937188e+01 -7.37343922e-03]
 [-7.37343922e-03  1.69130622e-02]]
grads:  [2.33142608e-03 2.51064790e+00]
Stock Position:  0.002331426079341343
Bond Position:  [0.10506422]


portfolio before change:  [0.34566867]
curr_Stock_Price:  103.14418566722753
curr_Factors:  [1.03144186e+02 3.39257572e-02]
mat_Sqrt:  [[ 1.89980704e+01 -7.36103701e-03]
 [-7.36103701e-03  1.68840963e-02]]
grads:  [-0.01075486  4.02990409]
Stock Position:  -0.01075485992807091
Bond Position:  [1.45496994]


portfolio before change:  [0.39092923]
curr_Stock_Price:  99.10501570656437
curr_Factors:  [9.91050157e+01 3.29462745e-02]
mat_Sqrt:  [[ 1.79886576e+01 -7.25373467e-03]
 [-7.25373467e-03  1.66386922e-02]]
grads:  [0.00387933 2.43552693]
Stock Position:  0.0038793349153389105
Bond Position:  [0.00646768]


portfolio before change:  [0.38108727]
curr_Stock_Price:  96.56590910464307
curr_Factors:  [9.65659091e+01 3.39664863e-02]
mat_Sqrt:  [[ 1.77970945e+01 -7.36500877e-03]
 [-7.36500877e-03  1.68944224e-02]]
grads:  [0.00391178 2.51591236]
Stock Position:  0.003911784145639794
Bond Position:  [0.00334228]


portfolio before change:  [0.37231953]
curr_Stock_Price:  94.32347212983423
curr_Factors:  [9.43234721e+01 3.31747593e-02]
mat_Sqrt:  [[ 1.71800186e+01 -7.27850284e-03]
 [-7.27850284e-03  1.66964364e-02]]
grads:  [ 6.07642307e-04 -6.63645201e+00]
Stock Position:  0.0006076423068549655
Bond Position:  [0.31500459]


portfolio before change:  [0.37168066]
curr_Stock_Price:  92.62366970333294
curr_Factors:  [9.26236697e+01 3.25877637e-02]
mat_Sqrt:  [[ 1.67204985e+01 -7.21369384e-03]
 [-7.21369384e-03  1.65481195e-02]]
grads:  [-1.64730757e-04 -5.00712757e-01]
Stock Position:  -0.0001647307570669146
Bond Position:  [0.38693862]


portfolio before change:  [0.37223941]
curr_Stock_Price:  92.16973570572137
curr_Factors:  [9.21697357e+01 3.08783828e-02]
mat_Sqrt:  [[ 1.61962911e+01 -7.02191528e-03]
 [-7.02191528e-03  1.61082753e-02]]
grads:  [-0.01130119 -8.53161113]
Stock Position:  -0.011301189880144547
Bond Position:  [1.41386709]


portfolio before change:  [0.38340362]
curr_Stock_Price:  91.33833898386628
curr_Factors:  [9.13383390e+01 3.01905655e-02]
mat_Sqrt:  [[ 1.58704299e+01 -6.94320533e-03]
 [-6.94320533e-03  1.59278861e-02]]
grads:  [4.84689423e-03 1.03827068e+01]
Stock Position:  0.004846894233964981
Bond Position:  [-0.05930365]


portfolio before change:  [0.39219761]
curr_Stock_Price:  93.16799857421628
curr_Factors:  [9.31679986e+01 3.17678391e-02]
mat_Sqrt:  [[ 1.66058291e+01 -7.12240676e-03]
 [-7.12240676e-03  1.63385958e-02]]
grads:  [-0.00559438 -0.73731292]
Stock Position:  -0.005594379717621532
Bond Position:  [0.91341477]


portfolio before change:  [0.38683007]
curr_Stock_Price:  94.3316711635343
curr_Factors:  [9.43316712e+01 3.12789052e-02]
mat_Sqrt:  [[ 1.66833500e+01 -7.06747000e-03]
 [-7.06747000e-03  1.62123385e-02]]
grads:  [-0.00067573 -0.55208268]
Stock Position:  -0.0006757261024363211
Bond Position:  [0.45057244]


portfolio before change:  [0.38490332]
curr_Stock_Price:  98.01706610048836
curr_Factors:  [9.80170661e+01 3.35080540e-02]
mat_Sqrt:  [[ 1.79422237e+01 -7.31524133e-03]
 [-7.31524133e-03  1.67799817e-02]]
grads:  [-1.68432557e-03 -3.02121986e+00]
Stock Position:  -0.0016843255724524125
Bond Position:  [0.54999597]


portfolio before change:  [0.38567177]
curr_Stock_Price:  97.96925786310094
curr_Factors:  [9.79692579e+01 3.43772292e-02]
mat_Sqrt:  [[ 1.81645740e+01 -7.40950665e-03]
 [-7.40950665e-03  1.69962203e-02]]
grads:  [0.00455283 0.83963455]
Stock Position:  0.0045528283198423385
Bond Position:  [-0.06036545]


portfolio before change:  [0.39773963]
curr_Stock_Price:  100.63647312749801
curr_Factors:  [1.00636473e+02 2.96911429e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.39773963]
Stock Price:  100.86907970679768
PL:  [-0.47134007]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.76255767e-02 -4.49770116e-02]
 [ 4.72830632e-03 -8.61297485e-02]
 [ 6.73814481e-02  4.20390730e-02]
 [ 1.59971174e-02  2.11257344e-02]
 [-2.04847283e-01 -2.48575383e-02]
 [ 1.27252440e-01  1.25712419e-01]
 [ 2.53198120e-02  4.33699424e-02]
 [-2.45794375e-01  6.62979421e-02]
 [ 8.35102442e-02  7.62687354e-02]
 [ 6.21467360e-02 -4.43880367e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 5.45272040e-03  3.48104791e-02]
 [ 3.09098702e-02  6.02797476e-02]
 [ 1.33585726e-02 -8.72893974e-02]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.53214572e-01 -8.31124155e-02]
 [ 6.00960977e-02 -1.49805273e-01]
 [-4.62367386e-02  3.85064086e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.01079419]
curr_Stock_Price:  103.36799539852055
curr_Factors:  [1.03367995e+02 3.70745848e-02]
mat_Sqrt:  [[ 1.99032597e+01 -7.69508124e-03]
 [-7.69508124e-03  1.76502570e-02]]
grads:  [-9.96639199e-05 -2.54827896e+00]
Stock Position:  -9.966391993053358e-05
Bond Position:  [19.02109625]


portfolio before change:  [19.03466978]
curr_Stock_Price:  102.52164955101641
curr_Factors:  [1.02521650e+02 3.39380048e-02]
mat_Sqrt:  [[ 1.88868141e+01 -7.36232590e-03]
 [-7.36232590e-03  1.68871610e-02]]
grads:  [-1.73811282e-03 -5.10106733e+00]
Stock Position:  -0.0017381128231535093
Bond Position:  [19.21286397]


portfolio before change:  [19.06447778]
curr_Stock_Price:  99.19798673720541
curr_Factors:  [9.91979867e+01 3.39555911e-02]
mat_Sqrt:  [[ 1.82792541e+01 -7.36401278e-03]
 [-7.36401278e-03  1.68916319e-02]]
grads:  [0.00468967 2.49079592]
Stock Position:  0.004689671717654939
Bond Position:  [18.59927178]


portfolio before change:  [19.08298001]
curr_Stock_Price:  98.18269394779671
curr_Factors:  [9.81826939e+01 3.43313639e-02]
mat_Sqrt:  [[ 1.81919996e+01 -7.40457724e-03]
 [-7.40457724e-03  1.69848719e-02]]
grads:  [0.00138585 1.24440126]
Stock Position:  0.0013858500014762032
Bond Position:  [18.94691353]


portfolio before change:  [19.10722632]
curr_Stock_Price:  98.57801557067282
curr_Factors:  [9.85780156e+01 3.20788015e-02]
mat_Sqrt:  [[ 1.76558692e+01 -7.15756716e-03]
 [-7.15756716e-03  1.64181987e-02]]
grads:  [-0.01221815 -1.51935003]
Stock Position:  -0.012218154232001174
Bond Position:  [20.31166772]


portfolio before change:  [19.10613968]
curr_Stock_Price:  100.74627229876958
curr_Factors:  [1.00746272e+02 2.98754316e-02]
mat_Sqrt:  [[ 1.74134990e+01 -6.90751986e-03]
 [-6.90751986e-03  1.58442572e-02]]
grads:  [0.01045683 7.93881644]
Stock Position:  0.010456828452984426
Bond Position:  [18.0526532]


portfolio before change:  [19.12662856]
curr_Stock_Price:  100.54630285328007
curr_Factors:  [1.00546303e+02 3.12896854e-02]
mat_Sqrt:  [[ 1.77855242e+01 -7.06911198e-03]
 [-7.06911198e-03  1.62149471e-02]]
grads:  [2.48714366e-03 2.67577341e+00]
Stock Position:  0.0024871436596629903
Bond Position:  [18.87655546]


portfolio before change:  [19.15745527]
curr_Stock_Price:  103.44772811376441
curr_Factors:  [1.03447728e+02 3.06217482e-02]
mat_Sqrt:  [[ 1.81023899e+01 -6.99343186e-03]
 [-6.99343186e-03  1.60408663e-02]]
grads:  [-0.01198331  4.1278405 ]
Stock Position:  -0.011983312973350937
Bond Position:  [20.39710177]


portfolio before change:  [19.18234641]
curr_Stock_Price:  103.49956536844809
curr_Factors:  [1.03499565e+02 2.67441853e-02]
mat_Sqrt:  [[ 1.69259549e+01 -6.53567182e-03]
 [-6.53567182e-03  1.49908921e-02]]
grads:  [0.00689954 5.09067958]
Stock Position:  0.006899537180485911
Bond Position:  [18.46824731]


portfolio before change:  [19.21623022]
curr_Stock_Price:  105.06257850616264
curr_Factors:  [1.05062579e+02 2.82313291e-02]
mat_Sqrt:  [[ 1.76528035e+01 -6.71501411e-03]
 [-6.71501411e-03  1.54020088e-02]]
grads:  [ 2.42462365e-03 -2.88090701e+00]
Stock Position:  0.0024246236512331
Bond Position:  [18.96149301]


portfolio before change:  [19.24478621]
curr_Stock_Price:  107.05847865267401
curr_Factors:  [1.07058479e+02 2.65569323e-02]
mat_Sqrt:  [[ 1.74465673e+01 -6.51294302e-03]
 [-6.51294302e-03  1.49382360e-02]]
grads:  [ 5.50335012e-04 -8.19027898e+00]
Stock Position:  0.0005503350119180368
Bond Position:  [19.18586818]


portfolio before change:  [19.26866066]
curr_Stock_Price:  106.83518498214357
curr_Factors:  [1.06835185e+02 2.63717625e-02]
mat_Sqrt:  [[ 1.73493758e+01 -6.49018576e-03]
 [-6.49018576e-03  1.48860711e-02]]
grads:  [1.18927185e-03 2.33897832e+00]
Stock Position:  0.0011892718467458633
Bond Position:  [19.14160458]


portfolio before change:  [19.2952816]
curr_Stock_Price:  109.08780469108592
curr_Factors:  [1.09087805e+02 2.67211754e-02]
mat_Sqrt:  [[ 1.78321600e+01 -6.53315581e-03]
 [-6.53315581e-03  1.49843128e-02]]
grads:  [3.20774147e-03 4.02425559e+00]
Stock Position:  0.0032077414688832227
Bond Position:  [18.94535613]


portfolio before change:  [19.30795771]
curr_Stock_Price:  105.65224312536002
curr_Factors:  [1.05652243e+02 2.67891748e-02]
mat_Sqrt:  [[ 1.72925229e+01 -6.54128466e-03]
 [-6.54128466e-03  1.50034444e-02]]
grads:  [-1.42850270e-03 -5.81858002e+00]
Stock Position:  -0.0014285026985200106
Bond Position:  [19.45888222]


portfolio before change:  [19.32731348]
curr_Stock_Price:  109.14054233941464
curr_Factors:  [1.09140542e+02 2.78775693e-02]
mat_Sqrt:  [[ 1.82227338e+01 -6.67302674e-03]
 [-6.67302674e-03  1.53051105e-02]]
grads:  [-4.68901741e-03 -5.69377667e+00]
Stock Position:  -0.004689017412183984
Bond Position:  [19.83907538]


portfolio before change:  [19.34845891]
curr_Stock_Price:  109.9229914353224
curr_Factors:  [1.09922991e+02 2.56580042e-02]
mat_Sqrt:  [[ 1.76075912e+01 -6.40190822e-03]
 [-6.40190822e-03  1.46831745e-02]]
grads:  [ 0.00664463 -5.65748758]
Stock Position:  0.006644625873563533
Bond Position:  [18.61806176]


portfolio before change:  [19.36159537]
curr_Stock_Price:  108.39534099676085
curr_Factors:  [1.08395341e+02 2.68956903e-02]
mat_Sqrt:  [[ 1.77767324e+01 -6.55441983e-03]
 [-6.55441983e-03  1.50331794e-02]]
grads:  [-2.93607269e-04 -9.96510404e+00]
Stock Position:  -0.00029360726885350785
Bond Position:  [19.39342103]


portfolio before change:  [19.38532079]
curr_Stock_Price:  110.20564514977518
curr_Factors:  [1.10205645e+02 2.37523032e-02]
mat_Sqrt:  [[ 1.69846529e+01 -6.15958993e-03]
 [-6.15958993e-03  1.41273665e-02]]
grads:  [-1.73406210e-03  2.72490471e+00]
Stock Position:  -0.00173406210393773
Bond Position:  [19.57642422]


portfolio before change:  [19.41057689]
curr_Stock_Price:  109.76144550575624
curr_Factors:  [1.09761446e+02 2.85057008e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.41057689]
Stock Price:  113.05184328395946
PL:  [6.3587336]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.40619397e-01  1.78928297e-02]
 [-3.88686104e-01 -2.83176556e-01]
 [-6.69719530e-01 -9.30406751e-03]
 [-2.37930291e-02 -2.82545110e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-1.70444878e-01  4.28114153e-02]
 [ 5.18416820e-02  4.08893226e-02]
 [ 6.07341375e-02 -3.29879824e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 1.11880682e-01  2.01590181e-02]
 [ 2.62986771e-02  8.50994544e-02]
 [-2.26915510e-02 -1.86378640e-01]
 [-3.75944244e-02 -9.25479770e-02]
 [ 1.49789803e-01 -7.89057020e-02]
 [ 6.54918140e-02 -1.50441390e-01]
 [-7.92032152e-02  4.18486958e-02]
 [-8.77504537e-02 -7.95171936e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [37.29217967]
curr_Stock_Price:  108.25435147579192
curr_Factors:  [1.08254351e+02 3.38327408e-02]
mat_Sqrt:  [[ 1.99119560e+01 -7.35124709e-03]
 [-7.35124709e-03  1.68607999e-02]]
grads:  [0.00745504 1.0644592 ]
Stock Position:  0.007455043559974108
Bond Position:  [36.48513877]


portfolio before change:  [37.37209219]
curr_Stock_Price:  112.85225604802272
curr_Factors:  [1.12852256e+02 3.36841062e-02]
mat_Sqrt:  [[ 2.07120331e+01 -7.33533436e-03]
 [-7.33533436e-03  1.68236123e-02]]
grads:  [ -0.02473124 -16.84287314]
Stock Position:  -0.02473123747983612
Bond Position:  [40.16306814]


portfolio before change:  [37.42386466]
curr_Stock_Price:  112.79009824713886
curr_Factors:  [1.12790098e+02 3.89549541e-02]
mat_Sqrt:  [[ 2.22613909e+01 -7.88839329e-03]
 [-7.88839329e-03  1.80920644e-02]]
grads:  [-0.03027126 -0.52746104]
Stock Position:  -0.030271259876411126
Bond Position:  [40.83816303]


portfolio before change:  [37.56645528]
curr_Stock_Price:  109.76706568997828
curr_Factors:  [1.09767066e+02 4.08668812e-02]
mat_Sqrt:  [[ 2.21900241e+01 -8.07947686e-03]
 [-8.07947686e-03  1.85308085e-02]]
grads:  [-0.00162766 -1.52544135]
Stock Position:  -0.0016276592170477696
Bond Position:  [37.74511866]


portfolio before change:  [37.61240877]
curr_Stock_Price:  110.53959525922222
curr_Factors:  [1.10539595e+02 4.11728407e-02]
mat_Sqrt:  [[ 2.24296893e+01 -8.10971220e-03]
 [-8.10971220e-03  1.86000262e-02]]
grads:  [ 0.00731059 -6.34679928]
Stock Position:  0.0073105901684682615
Bond Position:  [36.80429909]


portfolio before change:  [37.65044094]
curr_Stock_Price:  109.4450239156829
curr_Factors:  [1.09445024e+02 4.12403847e-02]
mat_Sqrt:  [[ 2.22257971e+01 -8.11629420e-03]
 [-8.11629420e-03  1.86153059e-02]]
grads:  [0.00778248 5.70894329]
Stock Position:  0.007782480450023156
Bond Position:  [36.79868719]


portfolio before change:  [37.71140793]
curr_Stock_Price:  111.36470319677063
curr_Factors:  [1.11364703e+02 4.12130200e-02]
mat_Sqrt:  [[ 2.26081359e+01 -8.11371806e-03]
 [-8.11371806e-03  1.86090779e-02]]
grads:  [3.96977998e-03 4.35378194e+00]
Stock Position:  0.003969779980437995
Bond Position:  [37.26931456]


portfolio before change:  [37.75736458]
curr_Stock_Price:  111.19866898378083
curr_Factors:  [1.11198669e+02 4.00407847e-02]
mat_Sqrt:  [[ 2.22510675e+01 -7.99748528e-03]
 [-7.99748528e-03  1.83425210e-02]]
grads:  [-0.00682226  2.33102387]
Stock Position:  -0.00682225913663087
Bond Position:  [38.51599072]


portfolio before change:  [37.80364317]
curr_Stock_Price:  111.47665671962888
curr_Factors:  [1.11476657e+02 3.29201412e-02]
mat_Sqrt:  [[ 2.02262212e+01 -7.25160093e-03]
 [-7.25160093e-03  1.66317677e-02]]
grads:  [0.00344507 2.4600094 ]
Stock Position:  0.0034450670630972132
Bond Position:  [37.41959861]


portfolio before change:  [37.83812199]
curr_Stock_Price:  107.89910071024201
curr_Factors:  [1.07899101e+02 2.99923054e-02]
mat_Sqrt:  [[ 1.86862743e+01 -6.92143501e-03]
 [-6.92143501e-03  1.58750367e-02]]
grads:  [ 0.00248091 -2.07689667]
Stock Position:  0.0024809136049060375
Bond Position:  [37.57043365]


portfolio before change:  [37.88134385]
curr_Stock_Price:  106.37927583235324
curr_Factors:  [1.06379276e+02 2.86594534e-02]
mat_Sqrt:  [[ 1.80090561e+01 -6.76581167e-03]
 [-6.76581167e-03  1.55183223e-02]]
grads:  [ 5.33165845e-04 -7.88411887e+00]
Stock Position:  0.0005331658447638863
Bond Position:  [37.82462605]


portfolio before change:  [37.93099703]
curr_Stock_Price:  110.77348515481597
curr_Factors:  [1.10773485e+02 3.15806171e-02]
mat_Sqrt:  [[ 1.96854840e+01 -7.10249754e-03]
 [-7.10249754e-03  1.62898956e-02]]
grads:  [0.00613087 1.24018981]
Stock Position:  0.0061308691598188775
Bond Position:  [37.25185929]


portfolio before change:  [37.98193813]
curr_Stock_Price:  111.48254567045397
curr_Factors:  [1.11482546e+02 3.60717041e-02]
mat_Sqrt:  [[ 2.11733794e+01 -7.59077991e-03]
 [-7.59077991e-03  1.74096841e-02]]
grads:  [2.99492683e-03 4.88935857e+00]
Stock Position:  0.0029949268269691062
Bond Position:  [37.64805606]


portfolio before change:  [38.03592758]
curr_Stock_Price:  113.78642804522846
curr_Factors:  [1.13786428e+02 3.90477341e-02]
mat_Sqrt:  [[ 2.24847652e+01 -7.89783785e-03]
 [-7.89783785e-03  1.81135722e-02]]
grads:  [-4.62410245e-03 -1.02914631e+01]
Stock Position:  -0.004624102452303005
Bond Position:  [38.56208769]


portfolio before change:  [38.09773701]
curr_Stock_Price:  110.85036004304857
curr_Factors:  [1.10850360e+02 3.78151799e-02]
mat_Sqrt:  [[ 2.15560988e+01 -7.77202378e-03]
 [-7.77202378e-03  1.78254718e-02]]
grads:  [-3.61652687e-03 -5.19347177e+00]
Stock Position:  -0.003616526871773145
Bond Position:  [38.49863032]


portfolio before change:  [38.15156047]
curr_Stock_Price:  109.28253660353005
curr_Factors:  [1.09282537e+02 4.06273210e-02]
mat_Sqrt:  [[ 2.20272272e+01 -8.05573145e-03]
 [-8.05573145e-03  1.84764283e-02]]
grads:  [ 0.00523921 -4.26833018]
Stock Position:  0.005239210549430468
Bond Position:  [37.57900625]


portfolio before change:  [38.20128504]
curr_Stock_Price:  109.80197553070957
curr_Factors:  [1.09801976e+02 3.89880203e-02]
mat_Sqrt:  [[ 2.16808206e+01 -7.89156614e-03]
 [-7.89156614e-03  1.80998173e-02]]
grads:  [-4.65981265e-06 -8.31176491e+00]
Stock Position:  -4.659812650992215e-06
Bond Position:  [38.2017967]


portfolio before change:  [38.24904157]
curr_Stock_Price:  115.29007128995563
curr_Factors:  [1.15290071e+02 4.51073221e-02]
mat_Sqrt:  [[ 2.44858624e+01 -8.48864509e-03]
 [-8.48864509e-03  1.94683365e-02]]
grads:  [-0.00248982  2.14849176]
Stock Position:  -0.002489821684902928
Bond Position:  [38.53609329]


portfolio before change:  [38.30744842]
curr_Stock_Price:  111.19073846408699
curr_Factors:  [1.11190738e+02 4.26101206e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [38.30744842]
Stock Price:  112.79490503565385
PL:  [25.51254338]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.55359547e-01 -2.71950397e-03]
 [-6.72877872e-02  6.88791131e-02]
 [ 4.91410134e-02  9.62538037e-02]
 [-2.46247515e-01 -1.33905314e-01]
 [-1.71729018e-01  3.17696306e-03]
 [ 8.59349747e-02  2.75172007e-02]
 [-2.67891106e-02 -2.69871022e-02]
 [ 3.59660560e-02  1.09244696e-01]
 [ 5.91320091e-02  4.91710532e-02]
 [ 6.60106555e-02 -5.31704527e-02]
 [ 6.18836512e-02 -1.19435537e-01]
 [-1.06595276e-02  3.87739246e-02]
 [-2.61231450e-03 -5.16433671e-02]
 [ 1.06527258e-02  8.16971212e-02]
 [-5.30369977e-02 -9.77267426e-02]
 [ 7.47875816e-02 -4.69753611e-02]
 [-2.82476626e-02  1.59992994e-03]
 [ 1.03746067e-01 -2.50939426e-02]
 [ 1.16566291e-01  6.43376915e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.87986341]
curr_Stock_Price:  96.44778837995484
curr_Factors:  [9.64477884e+01 3.89495889e-02]
mat_Sqrt:  [[ 1.90345965e+01 -7.88676484e-03]
 [-7.88676484e-03  1.80912915e-02]]
grads:  [ 0.00810114 -0.14678953]
Stock Position:  0.008101135838561431
Bond Position:  [-7.66120005]


portfolio before change:  [-6.90289237]
curr_Stock_Price:  94.78796314611117
curr_Factors:  [9.47879631e+01 4.00625236e-02]
mat_Sqrt:  [[ 1.89724014e+01 -7.99851536e-03]
 [-7.99851536e-03  1.83479968e-02]]
grads:  [-1.96432120e-03  3.75318363e+00]
Stock Position:  -0.0019643212036930834
Bond Position:  [-6.71669836]


portfolio before change:  [-6.90975044]
curr_Stock_Price:  94.0024250644225
curr_Factors:  [9.40024251e+01 4.31565373e-02]
mat_Sqrt:  [[ 1.95282045e+01 -8.30156593e-03]
 [-8.30156593e-03  1.90433552e-02]]
grads:  [4.66595892e-03 5.05649018e+00]
Stock Position:  0.004665958918639509
Bond Position:  [-7.3483619]


portfolio before change:  [-6.92312359]
curr_Stock_Price:  93.10615614572384
curr_Factors:  [9.31061561e+01 4.00686980e-02]
mat_Sqrt:  [[ 1.86372132e+01 -7.99899209e-03]
 [-7.99899209e-03  1.83494715e-02]]
grads:  [-0.01634779 -7.30462888]
Stock Position:  -0.016347786585083478
Bond Position:  [-5.40104402]


portfolio before change:  [-6.96962692]
curr_Stock_Price:  95.53754323898703
curr_Factors:  [9.55375432e+01 4.10767306e-02]
mat_Sqrt:  [[ 1.93629697e+01 -8.09918760e-03]
 [-8.09918760e-03  1.85787638e-02]]
grads:  [-0.00879902  0.16716387]
Stock Position:  -0.008799018400935233
Bond Position:  [-6.12899032]


portfolio before change:  [-6.98198045]
curr_Stock_Price:  96.07027343260707
curr_Factors:  [9.60702734e+01 3.53569669e-02]
mat_Sqrt:  [[ 1.80645227e+01 -7.51421009e-03]
 [-7.51421009e-03  1.72367722e-02]]
grads:  [0.00542215 1.59878796]
Stock Position:  0.005422152865526028
Bond Position:  [-7.50288816]


portfolio before change:  [-6.99040579]
curr_Stock_Price:  96.24716460297833
curr_Factors:  [9.62471646e+01 3.58618943e-02]
mat_Sqrt:  [[ 1.82265520e+01 -7.56768778e-03]
 [-7.56768778e-03  1.73594079e-02]]
grads:  [-0.00211564 -1.5555319 ]
Stock Position:  -0.0021156437211709393
Bond Position:  [-6.78678108]


portfolio before change:  [-7.00558024]
curr_Stock_Price:  99.40727327369059
curr_Factors:  [9.94072733e+01 2.94980151e-02]
mat_Sqrt:  [[ 1.70731841e+01 -6.86366576e-03]
 [-6.86366576e-03  1.57438954e-02]]
grads:  [4.89696174e-03 6.94099552e+00]
Stock Position:  0.004896961743232333
Bond Position:  [-7.49237385]


portfolio before change:  [-7.00948638]
curr_Stock_Price:  100.5233069481184
curr_Factors:  [1.00523307e+02 3.16072011e-02]
mat_Sqrt:  [[ 1.78714485e+01 -7.10488728e-03]
 [-7.10488728e-03  1.62970116e-02]]
grads:  [0.00450902 3.01914795]
Stock Position:  0.004509019801159323
Bond Position:  [-7.46274797]


portfolio before change:  [-7.00938114]
curr_Stock_Price:  102.61677932793282
curr_Factors:  [1.02616779e+02 3.33928919e-02]
mat_Sqrt:  [[ 1.87519037e+01 -7.30296569e-03]
 [-7.30296569e-03  1.67509884e-02]]
grads:  [ 2.28441277e-03 -3.17317215e+00]
Stock Position:  0.0022844127736191488
Bond Position:  [-7.24380023]


portfolio before change:  [-7.01880381]
curr_Stock_Price:  102.45820254951008
curr_Factors:  [1.02458203e+02 3.33045574e-02]
mat_Sqrt:  [[ 1.86981454e+01 -7.29328992e-03]
 [-7.29328992e-03  1.67288223e-02]]
grads:  [ 5.24909210e-04 -7.13927776e+00]
Stock Position:  0.0005249092095423704
Bond Position:  [-7.07258507]


portfolio before change:  [-7.02964644]
curr_Stock_Price:  98.65493221189158
curr_Factors:  [9.86549322e+01 3.64186989e-02]
mat_Sqrt:  [[ 1.88269938e+01 -7.62638791e-03]
 [-7.62638791e-03  1.74935759e-02]]
grads:  [3.31715651e-04 2.21661110e+00]
Stock Position:  0.0003317156513034368
Bond Position:  [-7.06237183]


portfolio before change:  [-7.03702107]
curr_Stock_Price:  103.05283332366238
curr_Factors:  [1.03052833e+02 3.69580777e-02]
mat_Sqrt:  [[ 1.98113737e+01 -7.68295999e-03]
 [-7.68295999e-03  1.76225113e-02]]
grads:  [-1.26855103e-03 -2.93108698e+00]
Stock Position:  -0.0012685510264538909
Bond Position:  [-6.9062933]


portfolio before change:  [-7.04170763]
curr_Stock_Price:  99.93769709107941
curr_Factors:  [9.99376971e+01 3.77696145e-02]
mat_Sqrt:  [[ 1.94222965e+01 -7.76663919e-03]
 [-7.76663919e-03  1.78150347e-02]]
grads:  [2.38269739e-03 4.58689125e+00]
Stock Position:  0.0023826973892096368
Bond Position:  [-7.27982892]


portfolio before change:  [-7.04793691]
curr_Stock_Price:  101.14481269482722
curr_Factors:  [1.01144813e+02 4.17172707e-02]
mat_Sqrt:  [[ 2.06586303e+01 -8.16252542e-03]
 [-8.16252542e-03  1.87228707e-02]]
grads:  [-4.63046005e-03 -5.22166396e+00]
Stock Position:  -0.004630460053085223
Bond Position:  [-6.5795899]


portfolio before change:  [-7.03982392]
curr_Stock_Price:  97.61543947847372
curr_Factors:  [9.76154395e+01 4.34685115e-02]
mat_Sqrt:  [[ 2.03519423e+01 -8.33181791e-03]
 [-8.33181791e-03  1.91119315e-02]]
grads:  [ 0.00266896 -2.45674404]
Stock Position:  0.0026689559593731068
Bond Position:  [-7.30035523]


portfolio before change:  [-7.05260957]
curr_Stock_Price:  96.24617678543704
curr_Factors:  [9.62461768e+01 4.65562406e-02]
mat_Sqrt:  [[ 2.07669349e+01 -8.62254642e-03]
 [-8.62254642e-03  1.97791329e-02]]
grads:  [-0.00132688  0.08031135]
Stock Position:  -0.001326877285811039
Bond Position:  [-6.92490271]


portfolio before change:  [-7.06057924]
curr_Stock_Price:  95.72474650018539
curr_Factors:  [9.57247465e+01 3.93549338e-02]
mat_Sqrt:  [[ 1.89899482e+01 -7.92764020e-03]
 [-7.92764020e-03  1.81852099e-02]]
grads:  [ 0.00488804 -1.37777854]
Stock Position:  0.004888035151892882
Bond Position:  [-7.52848517]


portfolio before change:  [-7.07539727]
curr_Stock_Price:  94.61969386927744
curr_Factors:  [9.46196939e+01 3.94868531e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.07539727]
Stock Price:  98.02040147356257
PL:  [-7.07539727]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-3.92259721e-02 -7.43350791e-02]
 [ 2.33027724e-02 -6.37970969e-02]
 [ 6.70171058e-02 -1.38272626e-01]
 [ 2.07446011e-02  2.30890685e-02]
 [-1.99983477e-01 -5.02481644e-03]
 [ 6.44316501e-02 -1.36053635e-02]
 [ 2.56846292e-02  4.38414761e-02]
 [-1.10099042e-01  8.72798968e-02]
 [-1.43265380e-02 -1.67166844e-02]
 [ 3.74610171e-02  1.57236705e-01]
 [ 5.89453618e-02 -1.11366158e-01]
 [-1.06639181e-02  2.80473249e-02]
 [-7.89509907e-02 -1.36461785e-01]
 [ 1.05205715e-02  9.89368912e-02]
 [-4.79742162e-02 -8.81050642e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 3.32366476e-02 -1.46663457e-01]
 [-2.07953028e-02  3.65519027e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.39057991]
curr_Stock_Price:  100.26207628025155
curr_Factors:  [1.00262076e+02 4.23524971e-02]
mat_Sqrt:  [[ 2.06336553e+01 -8.22437022e-03]
 [-8.22437022e-03  1.88649067e-02]]
grads:  [-3.47227103e-03 -3.94190321e+00]
Stock Position:  -0.0034722710339425626
Bond Position:  [7.73871701]


portfolio before change:  [7.3987459]
curr_Stock_Price:  100.69794373572464
curr_Factors:  [1.00697944e+02 4.41103425e-02]
mat_Sqrt:  [[ 2.11490461e+01 -8.39334498e-03]
 [-8.39334498e-03  1.92524073e-02]]
grads:  [-2.13305485e-04 -3.31381351e+00]
Stock Position:  -0.0002133054854380796
Bond Position:  [7.42022533]


portfolio before change:  [7.4076319]
curr_Stock_Price:  102.55013855584168
curr_Factors:  [1.02550139e+02 4.09271584e-02]
mat_Sqrt:  [[ 2.07463650e+01 -8.08495838e-03]
 [-8.08495838e-03  1.85446766e-02]]
grads:  [ 3.24648074e-04 -7.45604808e+00]
Stock Position:  0.0003246480739376553
Bond Position:  [7.3743392]


portfolio before change:  [7.41526199]
curr_Stock_Price:  97.64144674682998
curr_Factors:  [9.76414467e+01 4.21149740e-02]
mat_Sqrt:  [[ 2.00379108e+01 -8.20107460e-03]
 [-8.20107460e-03  1.88120205e-02]]
grads:  [0.00153787 1.22802762]
Stock Position:  0.001537872267127842
Bond Position:  [7.26510192]


portfolio before change:  [7.42339986]
curr_Stock_Price:  97.02424095113469
curr_Factors:  [9.70242410e+01 4.17595887e-02]
mat_Sqrt:  [[ 1.98270601e+01 -8.16635037e-03]
 [-8.16635037e-03  1.87325014e-02]]
grads:  [-0.0101987  -0.27268663]
Stock Position:  -0.010198704735269373
Bond Position:  [8.41292145]


portfolio before change:  [7.45757327]
curr_Stock_Price:  94.70525275911625
curr_Factors:  [9.47052528e+01 4.22566375e-02]
mat_Sqrt:  [[ 1.94680071e+01 -8.21461725e-03]
 [-8.21461725e-03  1.88437374e-02]]
grads:  [ 0.00300551 -0.72069962]
Stock Position:  0.0030055145407320255
Bond Position:  [7.17293525]


portfolio before change:  [7.48447628]
curr_Stock_Price:  100.67136563018245
curr_Factors:  [1.00671366e+02 4.24841675e-02]
mat_Sqrt:  [[ 2.07500660e+01 -8.23717533e-03]
 [-8.23717533e-03  1.88941953e-02]]
grads:  [2.15930191e-03 2.32130884e+00]
Stock Position:  0.0021593019094866923
Bond Position:  [7.26709641]


portfolio before change:  [7.49490958]
curr_Stock_Price:  101.29367219776105
curr_Factors:  [1.01293672e+02 4.38143868e-02]
mat_Sqrt:  [[ 2.12026747e+01 -8.36518501e-03]
 [-8.36518501e-03  1.91876926e-02]]
grads:  [-3.39864448e-03  4.54726205e+00]
Stock Position:  -0.003398644478886622
Bond Position:  [7.83917076]


portfolio before change:  [7.52427257]
curr_Stock_Price:  95.5390532827363
curr_Factors:  [9.55390533e+01 4.46294351e-02]
mat_Sqrt:  [[ 2.01832728e+01 -8.44217257e-03]
 [-8.44217257e-03  1.93655383e-02]]
grads:  [-0.00107108 -0.86368509]
Stock Position:  -0.001071080828097016
Bond Position:  [7.62660262]


portfolio before change:  [7.53529245]
curr_Stock_Price:  94.15665688635818
curr_Factors:  [9.41566569e+01 4.57148515e-02]
mat_Sqrt:  [[ 2.01316628e+01 -8.54409512e-03]
 [-8.54409512e-03  1.95996672e-02]]
grads:  [5.26657579e-03 8.02471296e+00]
Stock Position:  0.00526657579488082
Bond Position:  [7.03940927]


portfolio before change:  [7.54950076]
curr_Stock_Price:  95.18266471718714
curr_Factors:  [9.51826647e+01 4.46757612e-02]
mat_Sqrt:  [[ 2.01184168e+01 -8.44652267e-03]
 [-8.44652267e-03  1.93755998e-02]]
grads:  [ 5.16876684e-04 -5.74752749e+00]
Stock Position:  0.000516876684437621
Bond Position:  [7.50030306]


portfolio before change:  [7.5593572]
curr_Stock_Price:  96.10203114082394
curr_Factors:  [9.61020311e+01 4.10207421e-02]
mat_Sqrt:  [[ 1.94640981e+01 -8.09371160e-03]
 [-8.09371160e-03  1.85660780e-02]]
grads:  [8.03191413e-05 1.51071082e+00]
Stock Position:  8.031914126024772e-05
Bond Position:  [7.55163836]


portfolio before change:  [7.56903023]
curr_Stock_Price:  98.93552838390106
curr_Factors:  [9.89355284e+01 4.37204895e-02]
mat_Sqrt:  [[ 2.06868683e+01 -8.35603653e-03]
 [-8.35603653e-03  1.91671998e-02]]
grads:  [-6.69345253e-03 -7.12246532e+00]
Stock Position:  -0.006693452531035519
Bond Position:  [8.23125049]


portfolio before change:  [7.5766532]
curr_Stock_Price:  99.33480392690988
curr_Factors:  [9.93348039e+01 4.41347389e-02]
mat_Sqrt:  [[ 2.08685217e+01 -8.39556094e-03]
 [-8.39556094e-03  1.92577762e-02]]
grads:  [2.57144264e-03 5.13862446e+00]
Stock Position:  0.002571442635221058
Bond Position:  [7.32121945]


portfolio before change:  [7.59671578]
curr_Stock_Price:  103.57574418662144
curr_Factors:  [1.03575744e+02 3.45882114e-02]
mat_Sqrt:  [[ 1.92629183e+01 -7.43258501e-03]
 [-7.43258501e-03  1.70481317e-02]]
grads:  [-4.48532710e-03 -5.16997425e+00]
Stock Position:  -0.004485327096370342
Bond Position:  [8.06128687]


portfolio before change:  [7.60463598]
curr_Stock_Price:  104.05791681684438
curr_Factors:  [1.04057917e+02 3.49252658e-02]
mat_Sqrt:  [[ 1.94466570e+01 -7.46874226e-03]
 [-7.46874226e-03  1.71309821e-02]]
grads:  [ 0.0055872  -3.56090589]
Stock Position:  0.005587200694382113
Bond Position:  [7.02324352]


portfolio before change:  [7.62120478]
curr_Stock_Price:  105.45114571926875
curr_Factors:  [1.05451146e+02 3.38131018e-02]
mat_Sqrt:  [[ 1.93907130e+01 -7.34894791e-03]
 [-7.34894791e-03  1.68559777e-02]]
grads:  [-1.58382243e-03 -8.70166649e+00]
Stock Position:  -0.0015838224307547642
Bond Position:  [7.78822067]


portfolio before change:  [7.6286754]
curr_Stock_Price:  106.88485225329906
curr_Factors:  [1.06884852e+02 3.28332067e-02]
mat_Sqrt:  [[ 1.93674651e+01 -7.24176408e-03]
 [-7.24176408e-03  1.66099043e-02]]
grads:  [-2.50926221e-04  2.20049947e+00]
Stock Position:  -0.00025092622089416326
Bond Position:  [7.65549561]


portfolio before change:  [7.63874566]
curr_Stock_Price:  104.91252827922082
curr_Factors:  [1.04912528e+02 3.33397054e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.63874566]
Stock Price:  104.13208804506337
PL:  [3.50665762]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-5.95006982e-02 -8.10276021e-02]
 [ 2.33027724e-02 -6.37970969e-02]
 [ 6.63255264e-02  4.51769187e-02]
 [-2.30305120e-02 -2.61819478e-02]
 [ 5.87307275e-02 -9.54914724e-02]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-2.03557083e-01  4.43673532e-02]
 [ 7.66367896e-02  6.81728844e-02]
 [ 6.05145548e-02 -3.05059316e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 1.17503485e-01  1.93946604e-02]
 [ 3.46014726e-02  4.04097305e-02]
 [ 1.30227700e-02 -4.28777873e-02]
 [-6.64741028e-02 -7.08266074e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 2.27320131e-02 -1.30851775e-01]
 [ 1.12411128e-01 -4.46640141e-02]
 [ 8.37743128e-02  4.25739829e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.40879746]
curr_Stock_Price:  100.8015173203629
curr_Factors:  [1.00801517e+02 3.45636819e-02]
mat_Sqrt:  [[ 1.87403214e+01 -7.42976819e-03]
 [-7.42976819e-03  1.70421643e-02]]
grads:  [-0.00506086 -4.75674343]
Stock Position:  -0.005060862997662555
Bond Position:  [9.91894013]


portfolio before change:  [9.42081466]
curr_Stock_Price:  100.87842576159221
curr_Factors:  [1.00878426e+02 4.16003169e-02]
mat_Sqrt:  [[ 2.05753192e+01 -8.15105614e-03]
 [-8.15105614e-03  1.86966161e-02]]
grads:  [-2.19255894e-04 -3.41232252e+00]
Stock Position:  -0.00021925589418941342
Bond Position:  [9.44293285]


portfolio before change:  [9.43306011]
curr_Stock_Price:  98.89719688257819
curr_Factors:  [9.88971969e+01 4.15333661e-02]
mat_Sqrt:  [[ 2.01549865e+01 -8.14434629e-03]
 [-8.14434629e-03  1.86816296e-02]]
grads:  [0.00426871 2.4201146 ]
Stock Position:  0.004268709272291381
Bond Position:  [9.01089673]


portfolio before change:  [9.46722049]
curr_Stock_Price:  104.25940881248877
curr_Factors:  [1.04259409e+02 4.29627411e-02]
mat_Sqrt:  [[ 2.16103210e+01 -8.28369962e-03]
 [-8.28369962e-03  1.90002035e-02]]
grads:  [-0.00159419 -1.37867754]
Stock Position:  -0.0015941948609721366
Bond Position:  [9.63343031]


portfolio before change:  [9.48182052]
curr_Stock_Price:  102.65941010015679
curr_Factors:  [1.02659410e+02 4.13995046e-02]
mat_Sqrt:  [[ 2.08879733e+01 -8.13148710e-03]
 [-8.13148710e-03  1.86513797e-02]]
grads:  [ 8.18747785e-04 -5.11945049e+00]
Stock Position:  0.0008187477850967681
Bond Position:  [9.39776836]


portfolio before change:  [9.49608189]
curr_Stock_Price:  105.7211790431535
curr_Factors:  [1.05721179e+02 4.29590495e-02]
mat_Sqrt:  [[ 2.19123673e+01 -8.28344433e-03]
 [-8.28344433e-03  1.89993433e-02]]
grads:  [0.00789377 5.59366432]
Stock Position:  0.007893769432703791
Bond Position:  [8.66154328]


portfolio before change:  [9.5862477]
curr_Stock_Price:  115.77114413677143
curr_Factors:  [1.15771144e+02 3.69468299e-02]
mat_Sqrt:  [[ 2.22530165e+01 -7.68254085e-03]
 [-7.68254085e-03  1.76195024e-02]]
grads:  [4.03316591e-03 4.59823669e+00]
Stock Position:  0.004033165908141689
Bond Position:  [9.11932347]


portfolio before change:  [9.57538235]
curr_Stock_Price:  110.2490231799739
curr_Factors:  [1.10249023e+02 3.85065550e-02]
mat_Sqrt:  [[ 2.16342605e+01 -7.84271460e-03]
 [-7.84271460e-03  1.79877007e-02]]
grads:  [-0.00851621  2.46282522]
Stock Position:  -0.00851620730539006
Bond Position:  [10.51428589]


portfolio before change:  [9.63536128]
curr_Stock_Price:  104.75034812818562
curr_Factors:  [1.04750348e+02 3.82362261e-02]
mat_Sqrt:  [[ 2.04829712e+01 -7.81479608e-03]
 [-7.81479608e-03  1.79245983e-02]]
grads:  [0.00519342 3.80557872]
Stock Position:  0.005193417023706329
Bond Position:  [9.09134904]


portfolio before change:  [9.67895012]
curr_Stock_Price:  110.95388360953167
curr_Factors:  [1.10953884e+02 3.65995451e-02]
mat_Sqrt:  [[ 2.12265945e+01 -7.64608662e-03]
 [-7.64608662e-03  1.75366134e-02]]
grads:  [ 0.00222462 -1.73858665]
Stock Position:  0.002224623015191164
Bond Position:  [9.43211956]


portfolio before change:  [9.69080675]
curr_Stock_Price:  110.98045507890244
curr_Factors:  [1.10980455e+02 3.91499547e-02]
mat_Sqrt:  [[ 2.19589771e+01 -7.90800778e-03]
 [-7.90800778e-03  1.81373361e-02]]
grads:  [ 4.37155246e-04 -6.74566801e+00]
Stock Position:  0.0004371552457133362
Bond Position:  [9.64229107]


portfolio before change:  [9.70286687]
curr_Stock_Price:  110.97981119499799
curr_Factors:  [1.10979811e+02 3.75021384e-02]
mat_Sqrt:  [[ 2.14917594e+01 -7.73979521e-03]
 [-7.73979521e-03  1.77515338e-02]]
grads:  [0.00586176 1.09511828]
Stock Position:  0.005861757253825728
Bond Position:  [9.05233016]


portfolio before change:  [9.69203584]
curr_Stock_Price:  107.20048016769653
curr_Factors:  [1.07200480e+02 4.18031726e-02]
mat_Sqrt:  [[ 2.19180202e+01 -8.17134297e-03]
 [-8.17134297e-03  1.87419551e-02]]
grads:  [0.00238289 2.15714966]
Stock Position:  0.002382892336924763
Bond Position:  [9.43658864]


portfolio before change:  [9.69644722]
curr_Stock_Price:  104.09847964718203
curr_Factors:  [1.04098480e+02 4.33556569e-02]
mat_Sqrt:  [[ 2.16754060e+01 -8.32148140e-03]
 [-8.32148140e-03  1.90868938e-02]]
grads:  [-2.61678437e-04 -2.24656590e+00]
Stock Position:  -0.000261678437017196
Bond Position:  [9.72368755]


portfolio before change:  [9.71018895]
curr_Stock_Price:  98.06234765177544
curr_Factors:  [9.80623477e+01 4.37391655e-02]
mat_Sqrt:  [[ 2.05086700e+01 -8.35775217e-03]
 [-8.35775217e-03  1.91713232e-02]]
grads:  [-0.00474767 -3.69647345]
Stock Position:  -0.0047476658351234425
Bond Position:  [10.17575621]


portfolio before change:  [9.70917884]
curr_Stock_Price:  100.95592946242543
curr_Factors:  [1.00955929e+02 4.55935905e-02]
mat_Sqrt:  [[ 2.15567703e+01 -8.53331475e-03]
 [-8.53331475e-03  1.95734117e-02]]
grads:  [ 0.00504036 -3.11649979]
Stock Position:  0.005040355711604493
Bond Position:  [9.20032505]


portfolio before change:  [9.72734458]
curr_Stock_Price:  102.27689606208656
curr_Factors:  [1.02276896e+02 4.08835914e-02]
mat_Sqrt:  [[ 2.06800710e+01 -8.08063473e-03]
 [-8.08063473e-03  1.85348120e-02]]
grads:  [-1.65963510e-03 -7.06050784e+00]
Stock Position:  -0.0016596351035365728
Bond Position:  [9.89708691]


portfolio before change:  [9.75292893]
curr_Stock_Price:  94.32017422470253
curr_Factors:  [9.43201742e+01 4.68313740e-02]
mat_Sqrt:  [[ 2.04114099e+01 -8.64781918e-03]
 [-8.64781918e-03  1.98375644e-02]]
grads:  [ 0.00455421 -2.24950145]
Stock Position:  0.004554209924698777
Bond Position:  [9.32337506]


portfolio before change:  [9.77137853]
curr_Stock_Price:  95.81068483718569
curr_Factors:  [9.58106848e+01 4.52589766e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.77137853]
Stock Price:  100.53033404516775
PL:  [9.24104449]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 2.36116177e-02 -4.21201370e-02]
 [-1.01974883e-01 -1.63353137e-01]
 [-4.61579745e-01 -1.04089151e-01]
 [-2.26406281e-02 -2.51222219e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.30580754e-01  9.05471984e-02]
 [ 5.44239664e-02  8.09876574e-02]
 [-3.75406647e-02  8.45831225e-03]
 [ 5.05759667e-02  4.03092987e-02]
 [ 6.18521852e-02 -3.67418029e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 6.60482358e-02  2.64908011e-02]
 [ 2.91676550e-02  6.96572059e-02]
 [-1.24343740e-02 -1.99938674e-01]
 [-2.16889085e-02 -1.01318154e-01]
 [ 1.59578328e-01 -9.09291462e-02]
 [ 4.43454365e-02 -1.47962956e-01]
 [-5.47858470e-02  3.93699676e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.75078957]
curr_Stock_Price:  103.56578570838153
curr_Factors:  [1.03565786e+02 4.02412029e-02]
mat_Sqrt:  [[ 2.07755127e+01 -8.01698873e-03]
 [-8.01698873e-03  1.83885813e-02]]
grads:  [ 2.52658610e-04 -2.29044921e+00]
Stock Position:  0.0002526586099956591
Bond Position:  [19.72462278]


portfolio before change:  [19.77626399]
curr_Stock_Price:  106.74489636947945
curr_Factors:  [1.06744896e+02 3.81873354e-02]
mat_Sqrt:  [[ 2.08596380e+01 -7.80992588e-03]
 [-7.80992588e-03  1.79130794e-02]]
grads:  [-8.30424360e-03 -9.12283081e+00]
Stock Position:  -0.00830424359881389
Bond Position:  [20.66269961]


portfolio before change:  [19.77539068]
curr_Stock_Price:  109.962267072606
curr_Factors:  [1.09962267e+02 3.76570204e-02]
mat_Sqrt:  [[ 2.13386349e+01 -7.75570201e-03]
 [-7.75570201e-03  1.77881784e-02]]
grads:  [-0.02376175 -5.86195156]
Stock Position:  -0.02376174934773863
Bond Position:  [22.38828651]


portfolio before change:  [19.74254429]
curr_Stock_Price:  112.52307400545001
curr_Factors:  [1.12523074e+02 3.65498597e-02]
mat_Sqrt:  [[ 2.15121797e+01 -7.64098288e-03]
 [-7.64098288e-03  1.75246677e-02]]
grads:  [-0.00156188 -1.43421585]
Stock Position:  -0.0015618801661936145
Bond Position:  [19.91829185]


portfolio before change:  [19.76487949]
curr_Stock_Price:  114.17379990074916
curr_Factors:  [1.1417380e+02 4.1611154e-02]
mat_Sqrt:  [[ 2.32900976e+01 -8.15297969e-03]
 [-8.15297969e-03  1.86986754e-02]]
grads:  [ 0.00704041 -6.31341615]
Stock Position:  0.00704040964209637
Bond Position:  [18.96104916]


portfolio before change:  [19.77554986]
curr_Stock_Price:  112.3208175908756
curr_Factors:  [1.12320818e+02 4.47949716e-02]
mat_Sqrt:  [[ 2.37725003e+01 -8.45902611e-03]
 [-8.45902611e-03  1.94008915e-02]]
grads:  [0.00715477 4.67028644]
Stock Position:  0.007154772411731403
Bond Position:  [18.97191997]


portfolio before change:  [19.8273581]
curr_Stock_Price:  116.24526251507052
curr_Factors:  [1.16245263e+02 4.26364847e-02]
mat_Sqrt:  [[ 2.40030225e+01 -8.25293423e-03]
 [-8.25293423e-03  1.89275969e-02]]
grads:  [3.73912028e-03 4.28044388e+00]
Stock Position:  0.0037391202783954693
Bond Position:  [19.39270308]


portfolio before change:  [19.84702108]
curr_Stock_Price:  115.01688451964542
curr_Factors:  [1.15016885e+02 4.31127939e-02]
mat_Sqrt:  [[ 2.38816680e+01 -8.29883477e-03]
 [-8.29883477e-03  1.90330576e-02]]
grads:  [-0.00141773  0.44378297]
Stock Position:  -0.0014177310880582935
Bond Position:  [20.0100841]


portfolio before change:  [19.87419714]
curr_Stock_Price:  113.50192000658105
curr_Factors:  [1.13501920e+02 4.27616345e-02]
mat_Sqrt:  [[ 2.34709317e+01 -8.26488027e-03]
 [-8.26488027e-03  1.89554240e-02]]
grads:  [0.0029041  2.12779734]
Stock Position:  0.0029041010303832654
Bond Position:  [19.5445761]


portfolio before change:  [19.89687318]
curr_Stock_Price:  112.89245145650916
curr_Factors:  [1.12892451e+02 4.13760196e-02]
mat_Sqrt:  [[ 2.29635607e+01 -8.12983779e-03]
 [-8.12983779e-03  1.86458020e-02]]
grads:  [ 0.00199618 -1.96964305]
Stock Position:  0.001996175907329141
Bond Position:  [19.67151998]


portfolio before change:  [19.91747479]
curr_Stock_Price:  110.88703590144716
curr_Factors:  [1.10887036e+02 4.08466197e-02]
mat_Sqrt:  [[ 2.24108747e+01 -8.07754181e-03]
 [-8.07754181e-03  1.85261846e-02]]
grads:  [ 4.28342381e-04 -6.60408215e+00]
Stock Position:  0.000428342381404368
Bond Position:  [19.86997717]


portfolio before change:  [19.94155097]
curr_Stock_Price:  109.07349378333048
curr_Factors:  [1.09073494e+02 4.22692541e-02]
mat_Sqrt:  [[ 2.24249502e+01 -8.21689016e-03]
 [-8.21689016e-03  1.88460939e-02]]
grads:  [0.0034609  1.40714777]
Stock Position:  0.0034609046485944853
Bond Position:  [19.56405801]


portfolio before change:  [19.96924154]
curr_Stock_Price:  110.00394457823583
curr_Factors:  [1.10003945e+02 3.88380897e-02]
mat_Sqrt:  [[ 2.16788959e+01 -7.87638985e-03]
 [-7.87638985e-03  1.80649766e-02]]
grads:  [2.74681245e-03 3.85712323e+00]
Stock Position:  0.0027468124545453085
Bond Position:  [19.66708133]


portfolio before change:  [19.99853852]
curr_Stock_Price:  111.71420439454059
curr_Factors:  [1.11714204e+02 3.63667507e-02]
mat_Sqrt:  [[ 2.13039738e+01 -7.62177387e-03]
 [-7.62177387e-03  1.74807343e-02]]
grads:  [-4.67636529e-03 -1.14396978e+01]
Stock Position:  -0.0046763652879571425
Bond Position:  [20.52095495]


portfolio before change:  [20.0172323]
curr_Stock_Price:  113.20541640984007
curr_Factors:  [1.13205416e+02 3.08944033e-02]
mat_Sqrt:  [[ 1.98978927e+01 -7.02503361e-03]
 [-7.02503361e-03  1.61118880e-02]]
grads:  [-3.31066913e-03 -6.28985329e+00]
Stock Position:  -0.0033106691294945644
Bond Position:  [20.39201798]


portfolio before change:  [20.05046219]
curr_Stock_Price:  110.87237670638751
curr_Factors:  [1.10872377e+02 3.16555355e-02]
mat_Sqrt:  [[ 1.97264148e+01 -7.11092239e-03]
 [-7.11092239e-03  1.63092041e-02]]
grads:  [ 0.00608075 -5.57267577]
Stock Position:  0.00608075336992379
Bond Position:  [19.37627461]


portfolio before change:  [20.04986184]
curr_Stock_Price:  106.7880422270607
curr_Factors:  [1.06788042e+02 3.33416431e-02]
mat_Sqrt:  [[ 1.94991686e+01 -7.29761393e-03]
 [-7.29761393e-03  1.67380185e-02]]
grads:  [-1.03431435e-03 -8.84038358e+00]
Stock Position:  -0.0010343143525150846
Bond Position:  [20.16031425]


portfolio before change:  [20.07018224]
curr_Stock_Price:  111.52137955224443
curr_Factors:  [1.1152138e+02 3.1628467e-02]
mat_Sqrt:  [[ 1.98334003e+01 -7.10791566e-03]
 [-7.10791566e-03  1.63022147e-02]]
grads:  [-1.89710578e-03  2.41418014e+00]
Stock Position:  -0.0018971057753581916
Bond Position:  [20.28175009]


portfolio before change:  [20.10261073]
curr_Stock_Price:  107.79967945840927
curr_Factors:  [1.07799679e+02 2.83341817e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.10261073]
Stock Price:  105.75277213022315
PL:  [14.3498386]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 4.56088852e-02 -3.12148492e-02]
 [ 2.25149655e-02 -6.47443014e-02]
 [-1.25963775e-01 -2.40845677e-01]
 [-2.42915297e-02 -2.96094628e-02]
 [ 9.88329378e-02 -1.01279393e-01]
 [ 1.26758173e-01  1.06425941e-01]
 [ 3.48679262e-02  5.57110754e-02]
 [-2.44236464e-01  6.65505410e-02]
 [ 8.30149329e-02  7.56112023e-02]
 [ 6.14489431e-02 -3.88928924e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [-1.07067455e-02  3.27197492e-02]
 [-9.98518670e-02 -1.39448146e-01]
 [ 4.51796251e-03  1.64926593e-01]
 [-1.07024157e-01  1.22779974e-01]
 [-4.82675150e-02  1.17887532e-02]
 [-8.11463629e-02  1.27181014e-01]
 [ 1.09621264e-01 -9.04223616e-02]
 [ 1.02618730e-01  6.11139841e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.7135487]
curr_Stock_Price:  104.357689368708
curr_Factors:  [1.04357689e+02 3.52962867e-02]
mat_Sqrt:  [[ 1.96059970e+01 -7.50832771e-03]
 [-7.50832771e-03  1.72217270e-02]]
grads:  [ 1.63241790e-03 -1.81181553e+00]
Stock Position:  0.0016324178989106928
Bond Position:  [22.54319334]


portfolio before change:  [22.73729651]
curr_Stock_Price:  101.6324056555343
curr_Factors:  [1.01632406e+02 3.99576800e-02]
mat_Sqrt:  [[ 2.03157240e+01 -7.98856222e-03]
 [-7.98856222e-03  1.83237462e-02]]
grads:  [-2.81183215e-04 -3.53347765e+00]
Stock Position:  -0.0002811832149763234
Bond Position:  [22.76587383]


portfolio before change:  [22.76457165]
curr_Stock_Price:  105.90003738338262
curr_Factors:  [1.05900037e+02 3.84926771e-02]
mat_Sqrt:  [[ 2.07771101e+01 -7.84103369e-03]
 [-7.84103369e-03  1.79845757e-02]]
grads:  [-1.11183541e-02 -1.33966384e+01]
Stock Position:  -0.011118354140884834
Bond Position:  [23.94200577]


portfolio before change:  [22.78511991]
curr_Stock_Price:  106.74530340613764
curr_Factors:  [1.06745303e+02 3.98364150e-02]
mat_Sqrt:  [[ 2.13053596e+01 -7.97677532e-03]
 [-7.97677532e-03  1.82957702e-02]]
grads:  [-0.00174637 -1.6191389 ]
Stock Position:  -0.0017463698155110632
Bond Position:  [22.97153668]


portfolio before change:  [22.82022521]
curr_Stock_Price:  103.09606303548654
curr_Factors:  [1.03096063e+02 3.53907684e-02]
mat_Sqrt:  [[ 1.93948777e+01 -7.51828946e-03]
 [-7.51828946e-03  1.72447965e-02]]
grads:  [ 2.81965993e-03 -5.87181149e+00]
Stock Position:  0.0028196599308206133
Bond Position:  [22.52952937]


portfolio before change:  [22.85327588]
curr_Stock_Price:  104.82363056735323
curr_Factors:  [1.04823631e+02 3.56836256e-02]
mat_Sqrt:  [[ 1.98012977e+01 -7.54944267e-03]
 [-7.54944267e-03  1.73159513e-02]]
grads:  [0.00874623 6.14993468]
Stock Position:  0.008746232457983005
Bond Position:  [21.93646404]


portfolio before change:  [22.86268802]
curr_Stock_Price:  102.7626762152728
curr_Factors:  [1.02762676e+02 3.68971674e-02]
mat_Sqrt:  [[ 1.97393063e+01 -7.67660700e-03]
 [-7.67660700e-03  1.76079919e-02]]
grads:  [2.99739389e-03 3.16527209e+00]
Stock Position:  0.002997393887491929
Bond Position:  [22.5546678]


portfolio before change:  [22.89281736]
curr_Stock_Price:  103.40269084673993
curr_Factors:  [1.03402691e+02 3.75985563e-02]
mat_Sqrt:  [[ 2.00501392e+01 -7.74926968e-03]
 [-7.74926968e-03  1.77745431e-02]]
grads:  [-0.010736    3.73946854]
Stock Position:  -0.010736000919049025
Bond Position:  [24.00294874]


portfolio before change:  [22.91708235]
curr_Stock_Price:  103.93896644333371
curr_Factors:  [1.03938966e+02 3.83448330e-02]
mat_Sqrt:  [[ 2.03531572e+01 -7.82583344e-03]
 [-7.82583344e-03  1.79500602e-02]]
grads:  [0.00569932 4.2147939 ]
Stock Position:  0.005699322554501911
Bond Position:  [22.32470065]


portfolio before change:  [22.95908626]
curr_Stock_Price:  106.40953825854349
curr_Factors:  [1.06409538e+02 3.71326821e-02]
mat_Sqrt:  [[ 2.05049487e+01 -7.70130316e-03]
 [-7.70130316e-03  1.76639959e-02]]
grads:  [ 2.17017695e-03 -2.20087117e+00]
Stock Position:  0.002170176947811966
Bond Position:  [22.72815873]


portfolio before change:  [22.98603764]
curr_Stock_Price:  105.72914462046282
curr_Factors:  [1.05729145e+02 3.98416956e-02]
mat_Sqrt:  [[ 2.11039425e+01 -7.97723821e-03]
 [-7.97723821e-03  1.82970114e-02]]
grads:  [ 4.54993630e-04 -6.68679013e+00]
Stock Position:  0.0004549936304323955
Bond Position:  [22.93793156]


portfolio before change:  [23.01092021]
curr_Stock_Price:  97.36028257788409
curr_Factors:  [9.73602826e+01 4.82271733e-02]
mat_Sqrt:  [[ 2.13809842e+01 -8.77601227e-03]
 [-8.77601227e-03  2.01309051e-02]]
grads:  [1.66408387e-04 1.62542168e+00]
Stock Position:  0.0001664083871949641
Bond Position:  [22.99471864]


portfolio before change:  [23.03940248]
curr_Stock_Price:  95.68308536931114
curr_Factors:  [9.56830854e+01 5.25304093e-02]
mat_Sqrt:  [[ 2.19300956e+01 -9.15903143e-03]
 [-9.15903143e-03  2.10099081e-02]]
grads:  [-0.00732655 -6.64045031]
Stock Position:  -0.007326550817349484
Bond Position:  [23.74042947]


portfolio before change:  [23.10038272]
curr_Stock_Price:  91.41284283985978
curr_Factors:  [9.14128428e+01 5.82936718e-02]
mat_Sqrt:  [[ 2.20707900e+01 -9.64795891e-03]
 [-9.64795891e-03  2.21326367e-02]]
grads:  [3.46279316e-03 7.45324675e+00]
Stock Position:  0.0034627931634592284
Bond Position:  [22.78383895]


portfolio before change:  [23.11057058]
curr_Stock_Price:  86.12527725813182
curr_Factors:  [8.61252773e+01 5.43969852e-02]
mat_Sqrt:  [[ 2.00871352e+01 -9.31934618e-03]
 [-9.31934618e-03  2.13803564e-02]]
grads:  [-2.66425280e-03  5.74149198e+00]
Stock Position:  -0.002664252800767308
Bond Position:  [23.34003009]


portfolio before change:  [23.12414083]
curr_Stock_Price:  91.98922197544972
curr_Factors:  [9.19892220e+01 4.88528624e-02]
mat_Sqrt:  [[ 2.03320848e+01 -8.83227278e-03]
 [-8.83227278e-03  2.02612828e-02]]
grads:  [-0.00212161  0.58091162]
Stock Position:  -0.0021216095412231327
Bond Position:  [23.31930604]


portfolio before change:  [23.16040451]
curr_Stock_Price:  88.64444079574449
curr_Factors:  [8.86444408e+01 5.15384424e-02]
mat_Sqrt:  [[ 2.01241296e+01 -9.07145178e-03]
 [-9.07145178e-03  2.08108910e-02]]
grads:  [-1.27773510e-03  6.11071495e+00]
Stock Position:  -0.0012777351049455354
Bond Position:  [23.27366862]


portfolio before change:  [23.1876249]
curr_Stock_Price:  90.12352938145298
curr_Factors:  [9.01235294e+01 4.92557700e-02]
mat_Sqrt:  [[ 2.00016906e+01 -8.86843672e-03]
 [-8.86843672e-03  2.03447421e-02]]
grads:  [ 3.51065329e-03 -4.44297732e+00]
Stock Position:  0.003510653288346192
Bond Position:  [22.87123243]


portfolio before change:  [23.21422419]
curr_Stock_Price:  89.55166176281146
curr_Factors:  [8.95516618e+01 5.72992029e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.21422419]
Stock Price:  85.67826078889796
PL:  [23.21422419]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.62402196e-01  2.01221832e-03]
 [-1.76134613e-01  8.48783462e-02]
 [ 3.98031125e-02  8.53448239e-02]
 [-1.04093859e+00 -5.17327388e-01]
 [ 8.08583710e-01  9.36360577e-02]
 [-6.64775041e-02 -4.91771265e-01]
 [-3.84804863e-01 -3.99605090e-01]
 [ 3.38197680e-02 -9.22133751e-03]
 [-1.57761736e-01 -1.24889358e-01]
 [ 5.58046813e-02  2.88988615e-01]
 [ 5.81104688e-02 -1.09072555e-01]
 [-1.06064741e-02  2.81981409e-02]
 [-8.55135278e-02 -1.37399454e-01]
 [ 1.12674512e-02  6.39597262e-02]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 3.84912536e-02 -1.47278567e-01]
 [-2.57001231e-02  3.68594131e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.28742664]
curr_Stock_Price:  97.14071010700317
curr_Factors:  [9.71407101e+01 4.22255809e-02]
mat_Sqrt:  [[ 1.99613107e+01 -8.21179711e-03]
 [-8.21179711e-03  1.88367247e-02]]
grads:  [0.00818126 0.1103908 ]
Stock Position:  0.008181261534138532
Bond Position:  [-5.08216019]


portfolio before change:  [-4.33742586]
curr_Stock_Price:  91.8062568883375
curr_Factors:  [9.18062569e+01 4.79973320e-02]
mat_Sqrt:  [[ 2.01131822e+01 -8.75457671e-03]
 [-8.75457671e-03  2.00830950e-02]]
grads:  [-0.0069189   4.22334177]
Stock Position:  -0.0069188973486103925
Bond Position:  [-3.7022278]


portfolio before change:  [-4.31216972]
curr_Stock_Price:  87.48666337432522
curr_Factors:  [8.74866634e+01 5.06006387e-02]
mat_Sqrt:  [[ 1.96797604e+01 -8.98841704e-03]
 [-8.98841704e-03  2.06207358e-02]]
grads:  [3.91364447e-03 4.14049247e+00]
Stock Position:  0.003913644465215232
Bond Position:  [-4.65456141]


portfolio before change:  [-4.33291867]
curr_Stock_Price:  83.67254314424876
curr_Factors:  [8.36725431e+01 5.22291630e-02]
mat_Sqrt:  [[ 1.91222703e+01 -9.13147694e-03]
 [-9.13147694e-03  2.09501255e-02]]
grads:  [ -0.06624153 -24.72215599]
Stock Position:  -0.06624152730997372
Bond Position:  [1.20967838]


portfolio before change:  [-4.28515592]
curr_Stock_Price:  82.97434512469991
curr_Factors:  [8.29743451e+01 5.67337114e-02]
mat_Sqrt:  [[ 1.97635238e+01 -9.51702241e-03]
 [-9.51702241e-03  2.18349124e-02]]
grads:  [0.04298699 4.30710068]
Stock Position:  0.04298699425702529
Bond Position:  [-7.85197362]


portfolio before change:  [-4.24130051]
curr_Stock_Price:  84.2230137698969
curr_Factors:  [8.42230138e+01 5.81627771e-02]
mat_Sqrt:  [[ 2.03120285e+01 -9.63629679e-03]
 [-9.63629679e-03  2.21081332e-02]]
grads:  [-1.38284799e-02 -2.22499347e+01]
Stock Position:  -0.01382847993900015
Bond Position:  [-3.07662426]


portfolio before change:  [-4.27436475]
curr_Stock_Price:  86.33575852737584
curr_Factors:  [8.63357585e+01 5.70355094e-02]
mat_Sqrt:  [[ 2.06187971e+01 -9.54271201e-03]
 [-9.54271201e-03  2.18927326e-02]]
grads:  [ -0.02711601 -18.26468431]
Stock Position:  -0.027116008882527888
Bond Position:  [-1.93328355]


portfolio before change:  [-4.24146902]
curr_Stock_Price:  85.03343411935141
curr_Factors:  [8.50334341e+01 6.03939855e-02]
mat_Sqrt:  [[ 2.08971238e+01 -9.81949030e-03]
 [-9.81949030e-03  2.25281483e-02]]
grads:  [ 0.00142635 -0.40870343]
Stock Position:  0.0014263450279540326
Bond Position:  [-4.36275604]


portfolio before change:  [-4.243443]
curr_Stock_Price:  87.47525403399372
curr_Factors:  [8.74752540e+01 5.69296723e-02]
mat_Sqrt:  [[ 2.08715407e+01 -9.53398573e-03]
 [-9.53398573e-03  2.18723533e-02]]
grads:  [-0.01016898 -5.71435122]
Stock Position:  -0.010168979972505805
Bond Position:  [-3.35390889]


portfolio before change:  [-4.27170158]
curr_Stock_Price:  89.84162416576783
curr_Factors:  [8.98416242e+01 5.43887508e-02]
mat_Sqrt:  [[ 2.09523188e+01 -9.31905066e-03]
 [-9.31905066e-03  2.13785594e-02]]
grads:  [8.67741259e-03 1.35214667e+01]
Stock Position:  0.008677412586101586
Bond Position:  [-5.05129442]


portfolio before change:  [-4.25658209]
curr_Stock_Price:  92.31212525843642
curr_Factors:  [9.23121253e+01 5.21702917e-02]
mat_Sqrt:  [[ 2.10848415e+01 -9.12726396e-03]
 [-9.12726396e-03  2.09379075e-02]]
grads:  [ 5.01094358e-04 -5.20911566e+00]
Stock Position:  0.0005010943582511415
Bond Position:  [-4.30283917]


portfolio before change:  [-4.26015921]
curr_Stock_Price:  95.91381555381446
curr_Factors:  [9.59138156e+01 5.36278360e-02]
mat_Sqrt:  [[ 2.22114170e+01 -9.25423008e-03]
 [-9.25423008e-03  2.12282261e-02]]
grads:  [7.59305907e-05 1.32836552e+00]
Stock Position:  7.593059068971635e-05
Bond Position:  [-4.267442]


portfolio before change:  [-4.26534452]
curr_Stock_Price:  97.92001440249791
curr_Factors:  [9.79200144e+01 5.05215559e-02]
mat_Sqrt:  [[ 2.20094805e+01 -8.98239215e-03]
 [-8.98239215e-03  2.06041789e-02]]
grads:  [-6.60800234e-03 -6.67140440e+00]
Stock Position:  -0.006608002337870439
Bond Position:  [-3.61828883]


portfolio before change:  [-4.28686438]
curr_Stock_Price:  100.49177144450182
curr_Factors:  [1.00491771e+02 4.86715525e-02]
mat_Sqrt:  [[ 2.21701212e+01 -8.81661035e-03]
 [-8.81661035e-03  2.02233258e-02]]
grads:  [1.76626360e-03 3.16344103e+00]
Stock Position:  0.0017662636037269336
Bond Position:  [-4.46435934]


portfolio before change:  [-4.28556438]
curr_Stock_Price:  104.38923318435637
curr_Factors:  [1.04389233e+02 4.99782168e-02]
mat_Sqrt:  [[ 2.33370552e+01 -8.93447841e-03]
 [-8.93447841e-03  2.04928588e-02]]
grads:  [-3.66137065e-03 -4.25247176e+00]
Stock Position:  -0.0036613706515077433
Bond Position:  [-3.9033567]


portfolio before change:  [-4.29329154]
curr_Stock_Price:  105.16624114955265
curr_Factors:  [1.05166241e+02 4.46000239e-02]
mat_Sqrt:  [[ 2.22097600e+01 -8.44013099e-03]
 [-8.44013099e-03  1.93588333e-02]]
grads:  [ 0.00489208 -3.15113279]
Stock Position:  0.004892078543435605
Bond Position:  [-4.80777305]


portfolio before change:  [-4.29154538]
curr_Stock_Price:  106.75240418147618
curr_Factors:  [1.06752404e+02 4.69978894e-02]
mat_Sqrt:  [[ 2.31428485e+01 -8.66415949e-03]
 [-8.66415949e-03  1.98723737e-02]]
grads:  [-1.11157242e-03 -7.41170633e+00]
Stock Position:  -0.001111572421700573
Bond Position:  [-4.17288235]


portfolio before change:  [-4.29755197]
curr_Stock_Price:  107.46061366007163
curr_Factors:  [1.07460614e+02 4.96504276e-02]
mat_Sqrt:  [[ 2.39447762e+01 -8.90535451e-03]
 [-8.90535451e-03  2.04254483e-02]]
grads:  [-4.02226982e-04  1.80440745e+00]
Stock Position:  -0.0004022269824336081
Bond Position:  [-4.25432841]


portfolio before change:  [-4.3020757]
curr_Stock_Price:  105.47789122204617
curr_Factors:  [1.05477891e+02 4.97095688e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.3020757]
Stock Price:  103.09498418364106
PL:  [-7.39705988]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.41530090e-01 -1.36451493e-02]
 [-6.67461858e-02  6.88164597e-02]
 [ 4.12462616e-02  1.14447777e-01]
 [-3.18639387e-01 -1.70728348e-01]
 [ 9.06946697e-02  1.94325720e-02]
 [-1.07781879e-02 -2.85727201e-01]
 [-2.80228066e-01 -3.20713362e-01]
 [ 3.31958542e-02 -1.19293136e-02]
 [-1.02091937e-01 -8.31707717e-02]
 [ 5.58512162e-02  2.89180223e-01]
 [ 5.96888935e-02 -1.13408775e-01]
 [-1.07097628e-02  3.63478484e-02]
 [-7.88209136e-02 -1.36443200e-01]
 [ 1.34530605e-02 -6.92694627e-02]
 [-5.23391538e-02 -9.64005092e-02]
 [ 1.23660668e-01 -6.12313008e-02]
 [ 1.65185626e-02 -1.17550479e-01]
 [ 4.59346415e-02  4.92050644e-02]
 [-6.59698253e-02 -6.15542535e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.09163439]
curr_Stock_Price:  95.05475562520851
curr_Factors:  [9.50547556e+01 3.85423644e-02]
mat_Sqrt:  [[ 1.86613470e+01 -7.84531861e-03]
 [-7.84531861e-03  1.79965169e-02]]
grads:  [ 0.00726671 -0.75504275]
Stock Position:  0.007266706884378097
Bond Position:  [-12.78236944]


portfolio before change:  [-12.10944836]
curr_Stock_Price:  94.80346995605836
curr_Factors:  [9.48034700e+01 4.10613645e-02]
mat_Sqrt:  [[ 1.92105980e+01 -8.09761247e-03]
 [-8.09761247e-03  1.85753147e-02]]
grads:  [-1.91318877e-03  3.70389242e+00]
Stock Position:  -0.0019131887712833097
Bond Position:  [-11.92807143]


portfolio before change:  [-12.11752719]
curr_Stock_Price:  91.22798534700247
curr_Factors:  [9.12279853e+01 4.21934366e-02]
mat_Sqrt:  [[ 1.87391761e+01 -8.20816934e-03]
 [-8.20816934e-03  1.88297722e-02]]
grads:  [4.86430689e-03 6.08014279e+00]
Stock Position:  0.004864306885540342
Bond Position:  [-12.56128811]


portfolio before change:  [-12.12786456]
curr_Stock_Price:  92.33278010071811
curr_Factors:  [9.23327801e+01 4.27872842e-02]
mat_Sqrt:  [[ 1.90991145e+01 -8.26582935e-03]
 [-8.26582935e-03  1.89617749e-02]]
grads:  [-0.02058407 -9.01278987]
Stock Position:  -0.020584073144423343
Bond Position:  [-10.22727986]


portfolio before change:  [-12.1562666]
curr_Stock_Price:  93.09113067494424
curr_Factors:  [9.30911307e+01 3.97704482e-02]
mat_Sqrt:  [[ 1.85647245e+01 -7.96916513e-03]
 [-7.96916513e-03  1.82810527e-02]]
grads:  [0.00534263 1.06531875]
Stock Position:  0.0053426255217510245
Bond Position:  [-12.65361765]


portfolio before change:  [-12.19552062]
curr_Stock_Price:  88.70618719139945
curr_Factors:  [8.87061872e+01 4.21930563e-02]
mat_Sqrt:  [[ 1.82210903e+01 -8.20789812e-03]
 [-8.20789812e-03  1.88297895e-02]]
grads:  [-7.42837787e-03 -1.51774491e+01]
Stock Position:  -0.0074283778716467755
Bond Position:  [-11.53657754]


portfolio before change:  [-12.20936154]
curr_Stock_Price:  88.62692111639096
curr_Factors:  [8.86269211e+01 4.70188296e-02]
mat_Sqrt:  [[ 1.92177051e+01 -8.66456912e-03]
 [-8.66456912e-03  1.98774631e-02]]
grads:  [ -0.02186053 -16.14405086]
Stock Position:  -0.021860534731495428
Bond Position:  [-10.27192965]


portfolio before change:  [-12.19894665]
curr_Stock_Price:  87.56277347229106
curr_Factors:  [8.75627735e+01 4.96647425e-02]
mat_Sqrt:  [[ 1.95138768e+01 -8.90491348e-03]
 [-8.90491348e-03  2.04291444e-02]]
grads:  [ 0.00143495 -0.58331055]
Stock Position:  0.0014349544446546048
Bond Position:  [-12.32459524]


portfolio before change:  [-12.21025377]
curr_Stock_Price:  90.42575764351686
curr_Factors:  [9.04257576e+01 4.56205932e-02]
mat_Sqrt:  [[ 1.93140156e+01 -8.53493964e-03]
 [-8.53493964e-03  1.95796000e-02]]
grads:  [-0.00716441 -4.25095096]
Stock Position:  -0.007164411048176422
Bond Position:  [-11.56240647]


portfolio before change:  [-12.22043972]
curr_Stock_Price:  89.8289048989565
curr_Factors:  [8.98289049e+01 4.72221154e-02]
mat_Sqrt:  [[ 1.95204031e+01 -8.68339960e-03]
 [-8.68339960e-03  1.99203345e-02]]
grads:  [9.32060577e-03 1.45208986e+01]
Stock Position:  0.009320605774589418
Bond Position:  [-13.05769953]


portfolio before change:  [-12.16736644]
curr_Stock_Price:  97.27537458235655
curr_Factors:  [9.72753746e+01 4.40009505e-02]
mat_Sqrt:  [[ 2.04048734e+01 -8.38266268e-03]
 [-8.38266268e-03  1.92286368e-02]]
grads:  [ 5.02357284e-04 -5.89769129e+00]
Stock Position:  0.0005023572844757461
Bond Position:  [-12.21623343]


portfolio before change:  [-12.18085454]
curr_Stock_Price:  100.84203190092718
curr_Factors:  [1.00842032e+02 4.61568258e-02]
mat_Sqrt:  [[ 2.16650413e+01 -8.58585184e-03]
 [-8.58585184e-03  1.96939434e-02]]
grads:  [2.37132298e-04 1.84573925e+00]
Stock Position:  0.00023713229754436575
Bond Position:  [-12.20476744]


portfolio before change:  [-12.19656664]
curr_Stock_Price:  98.95870985970419
curr_Factors:  [9.89587099e+01 4.57464988e-02]
mat_Sqrt:  [[ 2.11657138e+01 -8.54745547e-03]
 [-8.54745547e-03  1.96062743e-02]]
grads:  [-6.53549311e-03 -6.96200915e+00]
Stock Position:  -0.006535493107502311
Bond Position:  [-11.54982267]


portfolio before change:  [-12.25042968]
curr_Stock_Price:  104.98989056101418
curr_Factors:  [1.04989891e+02 4.19214969e-02]
mat_Sqrt:  [[ 2.14964053e+01 -8.18275214e-03]
 [-8.18275214e-03  1.87685252e-02]]
grads:  [-7.79200334e-04 -3.69106460e+00]
Stock Position:  -0.0007792003344858726
Bond Position:  [-12.16862152]


portfolio before change:  [-12.26290187]
curr_Stock_Price:  101.46306558748611
curr_Factors:  [1.01463066e+02 4.11057379e-02]
mat_Sqrt:  [[ 2.05711784e+01 -8.10250040e-03]
 [-8.10250040e-03  1.85851249e-02]]
grads:  [-4.58810847e-03 -5.18897156e+00]
Stock Position:  -0.004588108473052985
Bond Position:  [-11.79737832]


portfolio before change:  [-12.27235209]
curr_Stock_Price:  100.30665843351692
curr_Factors:  [1.00306658e+02 3.48470314e-02]
mat_Sqrt:  [[ 1.87246031e+01 -7.46012683e-03]
 [-7.46012683e-03  1.71118912e-02]]
grads:  [ 0.00517944 -3.57603146]
Stock Position:  0.005179443272912673
Bond Position:  [-12.79188474]


portfolio before change:  [-12.28378254]
curr_Stock_Price:  101.18887804917595
curr_Factors:  [1.01188878e+02 2.99204162e-02]
mat_Sqrt:  [[ 1.75031640e+01 -6.91274584e-03]
 [-6.91274584e-03  1.58561694e-02]]
grads:  [-1.98452086e-03 -7.41441357e+00]
Stock Position:  -0.0019845208558588647
Bond Position:  [-12.0829711]


portfolio before change:  [-12.29605643]
curr_Stock_Price:  99.75817110801773
curr_Factors:  [9.97581711e+01 2.93722253e-02]
mat_Sqrt:  [[ 1.70968802e+01 -6.84903779e-03]
 [-6.84903779e-03  1.57102812e-02]]
grads:  [0.00394211 3.13374812]
Stock Position:  0.003942111073174132
Bond Position:  [-12.68931422]


portfolio before change:  [-12.30397223]
curr_Stock_Price:  101.77631612867921
curr_Factors:  [1.01776316e+02 2.73753241e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.30397223]
Stock Price:  101.6901525963115
PL:  [-13.99412483]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-5.67612547e-02 -8.00436179e-02]
 [ 2.33027724e-02 -6.37970969e-02]
 [ 6.16844807e-02 -1.73901776e-01]
 [-7.49059312e-03  1.61712951e-03]
 [-1.96929129e-01 -3.69840096e-02]
 [ 1.27381581e-01  1.07528268e-01]
 [ 2.70755674e-02  4.56392923e-02]
 [ 3.44451393e-02 -6.50703582e-03]
 [ 6.55705555e-02  5.63288369e-02]
 [ 6.42308679e-02 -4.17262927e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [-8.94704336e-03  4.23062260e-02]
 [-3.04210437e-03 -5.23892378e-02]
 [ 1.15694437e-02  5.08235826e-02]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 5.88759477e-02 -1.49663189e-01]
 [ 3.69294095e-02  4.72979833e-02]
 [-2.99746316e-02 -3.29074913e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.88792482]
curr_Stock_Price:  100.92958129439351
curr_Factors:  [1.00929581e+02 4.68902705e-02]
mat_Sqrt:  [[ 2.18554527e+01 -8.65380558e-03]
 [-8.65380558e-03  1.98497948e-02]]
grads:  [-0.00419453 -4.03429442]
Stock Position:  -0.004194525528347642
Bond Position:  [10.31127652]


portfolio before change:  [9.89962752]
curr_Stock_Price:  101.21434659974335
curr_Factors:  [1.01214347e+02 5.07403696e-02]
mat_Sqrt:  [[ 2.27991605e+01 -9.00209697e-03]
 [-9.00209697e-03  2.06486306e-02]]
grads:  [-1.97873829e-04 -3.08973895e+00]
Stock Position:  -0.00019787382920091422
Bond Position:  [9.91965519]


portfolio before change:  [9.91162981]
curr_Stock_Price:  103.26124915087487
curr_Factors:  [1.03261249e+02 5.15927765e-02]
mat_Sqrt:  [[ 2.34548031e+01 -9.07755969e-03]
 [-9.07755969e-03  2.08212794e-02]]
grads:  [-6.02637814e-04 -8.35238044e+00]
Stock Position:  -0.000602637814257016
Bond Position:  [9.97385894]


portfolio before change:  [9.92615778]
curr_Stock_Price:  99.8548106723429
curr_Factors:  [9.98548107e+01 4.97303012e-02]
mat_Sqrt:  [[ 2.22679123e+01 -8.91193618e-03]
 [-8.91193618e-03  2.04421233e-02]]
grads:  [-0.00030478  0.07897484]
Stock Position:  -0.00030477820837129273
Bond Position:  [9.95659135]


portfolio before change:  [9.9388458]
curr_Stock_Price:  99.0854012062904
curr_Factors:  [9.90854012e+01 4.95480386e-02]
mat_Sqrt:  [[ 2.20558028e+01 -8.89552662e-03]
 [-8.89552662e-03  2.04046561e-02]]
grads:  [-0.0096614 -1.8167399]
Stock Position:  -0.009661402447981852
Bond Position:  [10.89614974]


portfolio before change:  [9.90288889]
curr_Stock_Price:  104.21774198899938
curr_Factors:  [1.04217742e+02 4.58523857e-02]
mat_Sqrt:  [[ 2.23163208e+01 -8.55774156e-03]
 [-8.55774156e-03  1.96287778e-02]]
grads:  [0.00781002 5.48149792]
Stock Position:  0.007810016032868683
Bond Position:  [9.08894666]


portfolio before change:  [9.87553571]
curr_Stock_Price:  99.25981786632232
curr_Factors:  [9.92598179e+01 4.81041708e-02]
mat_Sqrt:  [[ 2.17703196e+01 -8.76497138e-03]
 [-8.76497138e-03  2.01051482e-02]]
grads:  [2.15800978e-03 2.27097093e+00]
Stock Position:  0.0021580097781356074
Bond Position:  [9.66133205]


portfolio before change:  [9.87972]
curr_Stock_Price:  95.59907122312512
curr_Factors:  [9.55990712e+01 5.23871359e-02]
mat_Sqrt:  [[ 2.18809394e+01 -9.14652486e-03]
 [-9.14652486e-03  2.09812402e-02]]
grads:  [ 0.00144483 -0.30950604]
Stock Position:  0.0014448298609397569
Bond Position:  [9.74159561]


portfolio before change:  [9.90016921]
curr_Stock_Price:  101.31918902352197
curr_Factors:  [1.01319189e+02 4.45548376e-02]
mat_Sqrt:  [[ 2.13864698e+01 -8.43557542e-03]
 [-8.43557542e-03  1.93491458e-02]]
grads:  [0.00421498 2.91301711]
Stock Position:  0.004214979455765663
Bond Position:  [9.47311091]


portfolio before change:  [9.90744358]
curr_Stock_Price:  100.23391309411512
curr_Factors:  [1.00233913e+02 4.52551389e-02]
mat_Sqrt:  [[ 2.13230145e+01 -8.50152783e-03]
 [-8.50152783e-03  1.95006516e-02]]
grads:  [ 0.00215954 -2.1387969 ]
Stock Position:  0.0021595364256345845
Bond Position:  [9.6909848]


portfolio before change:  [9.92972838]
curr_Stock_Price:  104.94024138566182
curr_Factors:  [1.04940241e+02 4.04940332e-02]
mat_Sqrt:  [[ 2.11172589e+01 -8.04222730e-03]
 [-8.04222730e-03  1.84462167e-02]]
grads:  [ 4.54726856e-04 -6.63270141e+00]
Stock Position:  0.00045472685591169826
Bond Position:  [9.88200923]


portfolio before change:  [9.94141494]
curr_Stock_Price:  103.45874644811437
curr_Factors:  [1.03458746e+02 4.55873461e-02]
mat_Sqrt:  [[ 2.20896754e+01 -8.53291764e-03]
 [-8.53291764e-03  1.95719896e-02]]
grads:  [4.30022404e-04 2.16175750e+00]
Stock Position:  0.00043002240400458506
Bond Position:  [9.89692536]


portfolio before change:  [9.95360518]
curr_Stock_Price:  103.0200529872869
curr_Factors:  [1.03020053e+02 4.95631658e-02]
mat_Sqrt:  [[ 2.29351326e+01 -8.89719852e-03]
 [-8.89719852e-03  2.04076338e-02]]
grads:  [-1.12869764e-03 -2.56763134e+00]
Stock Position:  -0.0011286976414833227
Bond Position:  [10.06988367]


portfolio before change:  [9.96856699]
curr_Stock_Price:  100.9233133856667
curr_Factors:  [1.00923313e+02 5.11587956e-02]
mat_Sqrt:  [[ 2.28271463e+01 -9.03911467e-03]
 [-9.03911467e-03  2.07336046e-02]]
grads:  [1.47773805e-03 2.45191036e+00]
Stock Position:  0.0014777380496250143
Bond Position:  [9.81942877]


portfolio before change:  [9.98666968]
curr_Stock_Price:  104.86225935164055
curr_Factors:  [1.04862259e+02 5.04736199e-02]
mat_Sqrt:  [[ 2.35587046e+01 -8.97868573e-03]
 [-8.97868573e-03  2.05941594e-02]]
grads:  [-3.62692794e-03 -4.23154713e+00]
Stock Position:  -0.0036269279401852108
Bond Position:  [10.36699754]


portfolio before change:  [9.99346677]
curr_Stock_Price:  106.56335835358612
curr_Factors:  [1.06563358e+02 5.08125009e-02]
mat_Sqrt:  [[ 2.40211145e+01 -9.00890246e-03]
 [-9.00890246e-03  2.06631238e-02]]
grads:  [ 0.00452316 -2.95225427]
Stock Position:  0.004523157869930686
Bond Position:  [9.51146387]


portfolio before change:  [10.01707125]
curr_Stock_Price:  109.15175364903308
curr_Factors:  [1.09151754e+02 4.50093513e-02]
mat_Sqrt:  [[ 2.31569877e+01 -8.47904280e-03]
 [-8.47904280e-03  1.94473480e-02]]
grads:  [-2.75433646e-04 -7.69593488e+00]
Stock Position:  -0.0002754336456752608
Bond Position:  [10.04713532]


portfolio before change:  [10.03197942]
curr_Stock_Price:  100.65100061462668
curr_Factors:  [1.00651001e+02 5.23351166e-02]
mat_Sqrt:  [[ 2.30257964e+01 -9.14242218e-03]
 [-9.14242218e-03  2.09706291e-02]]
grads:  [0.00249979 2.25652923]
Stock Position:  0.0024997855164096924
Bond Position:  [9.7803735]


portfolio before change:  [10.0424787]
curr_Stock_Price:  99.95740882203091
curr_Factors:  [9.99574088e+01 5.41734627e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.0424787]
Stock Price:  95.75596809357826
PL:  [10.0424787]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.31372095e-01 -1.05622407e-02]
 [-1.99512769e-01  8.83123776e-02]
 [ 4.59560542e-02  1.05719878e-01]
 [-5.59017253e-01 -2.86134396e-01]
 [ 6.03417545e-01  6.41987464e-02]
 [-1.15374796e-02 -2.85322875e-01]
 [-4.76723744e-01 -4.69211991e-01]
 [ 3.40520618e-02 -8.21311194e-03]
 [-2.06317852e-01 -1.61263724e-01]
 [ 1.02349327e-01  4.88609394e-01]
 [-1.04994372e-01 -5.18967731e-02]
 [ 6.02488997e-02 -2.30922487e-01]
 [-2.29393203e-01 -8.85732408e-02]
 [ 8.49398840e-03  1.39098395e-01]
 [-9.00333030e-02  3.11003607e-01]
 [-2.93182477e-01  1.41966402e-01]
 [-1.46181233e-01  3.31913744e-01]
 [-1.06378546e-01 -2.25563773e-01]
 [-3.21280056e-02  1.11028118e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.38561868]
curr_Stock_Price:  98.38974910269286
curr_Factors:  [9.83897491e+01 4.41883509e-02]
mat_Sqrt:  [[ 2.06825324e+01 -8.40058419e-03]
 [-8.40058419e-03  1.92695016e-02]]
grads:  [ 0.00613029 -0.54546002]
Stock Position:  0.006130289552017609
Bond Position:  [-0.21753897]


portfolio before change:  [0.34106141]
curr_Stock_Price:  91.16575454521426
curr_Factors:  [9.11657545e+01 4.95613976e-02]
mat_Sqrt:  [[ 2.02956732e+01 -8.89601144e-03]
 [-8.89601144e-03  2.04077181e-02]]
grads:  [-0.00793504  4.32394191]
Stock Position:  -0.007935037715571877
Bond Position:  [1.06446511]


portfolio before change:  [0.32708248]
curr_Stock_Price:  93.09521497977546
curr_Factors:  [9.30952150e+01 4.89156326e-02]
mat_Sqrt:  [[ 2.05897539e+01 -8.83804970e-03]
 [-8.83804970e-03  2.02742498e-02]]
grads:  [4.47111727e-03 5.21643935e+00]
Stock Position:  0.004471117273931199
Bond Position:  [-0.08915715]


portfolio before change:  [0.31081381]
curr_Stock_Price:  89.48154206214086
curr_Factors:  [8.94815421e+01 5.53560051e-02]
mat_Sqrt:  [[ 2.10530871e+01 -9.40151232e-03]
 [-9.40151232e-03  2.15678376e-02]]
grads:  [ -0.03248348 -13.28087665]
Stock Position:  -0.03248348214391957
Bond Position:  [3.21748588]


portfolio before change:  [0.39647785]
curr_Stock_Price:  86.96827469651956
curr_Factors:  [8.69682747e+01 5.80158139e-02]
mat_Sqrt:  [[ 2.09475870e+01 -9.62444510e-03]
 [-9.62444510e-03  2.20800406e-02]]
grads:  [0.03014799 2.92068774]
Stock Position:  0.030147985235079375
Bond Position:  [-2.22544041]


portfolio before change:  [0.4446982]
curr_Stock_Price:  88.66005897343689
curr_Factors:  [8.86600590e+01 5.36323538e-02]
mat_Sqrt:  [[ 2.05324796e+01 -9.25389698e-03]
 [-9.25389698e-03  2.12294354e-02]]
grads:  [-6.62054665e-03 -1.34428512e+01]
Stock Position:  -0.00662054664858241
Bond Position:  [1.03167626]


portfolio before change:  [0.47471721]
curr_Stock_Price:  84.32074912883708
curr_Factors:  [8.43207491e+01 5.78231086e-02]
mat_Sqrt:  [[ 2.02761327e+01 -9.60812989e-03]
 [-9.60812989e-03  2.20434781e-02]]
grads:  [ -0.03360506 -21.30039871]
Stock Position:  -0.0336050641483156
Bond Position:  [3.30832139]


portfolio before change:  [0.488279]
curr_Stock_Price:  84.04032082476648
curr_Factors:  [8.40403208e+01 5.77106495e-02]
mat_Sqrt:  [[ 2.01890384e+01 -9.59874721e-03]
 [-9.59874721e-03  2.20220468e-02]]
grads:  [ 0.00150966 -0.37229151]
Stock Position:  0.001509657324797901
Bond Position:  [0.36140692]


portfolio before change:  [0.49002678]
curr_Stock_Price:  84.89862073278012
curr_Factors:  [8.48986207e+01 5.73882783e-02]
mat_Sqrt:  [[ 2.03381846e+01 -9.57200585e-03]
 [-9.57200585e-03  2.19604072e-02]]
grads:  [-0.01360326 -7.34931426]
Stock Position:  -0.013603255976526429
Bond Position:  [1.64492445]


portfolio before change:  [0.53820924]
curr_Stock_Price:  81.50788763302869
curr_Factors:  [8.15078876e+01 6.31358709e-02]
mat_Sqrt:  [[ 2.04803641e+01 -1.00394509e-02]
 [-1.00394509e-02  2.30340647e-02]]
grads:  [1.53990550e-02 2.12191812e+01]
Stock Position:  0.015399055032999882
Bond Position:  [-0.71693521]


portfolio before change:  [0.5281062]
curr_Stock_Price:  80.91003852558839
curr_Factors:  [8.09100385e+01 5.72027884e-02]
mat_Sqrt:  [[ 1.93513360e+01 -9.55601594e-03]
 [-9.55601594e-03  2.19251099e-02]]
grads:  [-0.00659598 -2.36987658]
Stock Position:  -0.006595976108682918
Bond Position:  [1.06178688]


portfolio before change:  [0.57089272]
curr_Stock_Price:  74.62462176066478
curr_Factors:  [7.46246218e+01 6.63542415e-02]
mat_Sqrt:  [[ 1.92227902e+01 -1.02910862e-02]
 [-1.02910862e-02  2.36143169e-02]]
grads:  [-2.10147543e-03 -9.77983462e+00]
Stock Position:  -0.0021014754251646697
Bond Position:  [0.72771453]


portfolio before change:  [0.56591931]
curr_Stock_Price:  77.42437810878243
curr_Factors:  [7.74243781e+01 6.32600041e-02]
mat_Sqrt:  [[ 1.9473422e+01 -1.0048720e-02]
 [-1.0048720e-02  2.3056957e-02]]
grads:  [-0.0137652  -3.84749659]
Stock Position:  -0.013765203592730538
Bond Position:  [1.63168164]


portfolio before change:  [0.57424848]
curr_Stock_Price:  76.9675528311539
curr_Factors:  [7.69675528e+01 5.89664906e-02]
mat_Sqrt:  [[ 1.86900413e+01 -9.70165287e-03]
 [-9.70165287e-03  2.22607915e-02]]
grads:  [3.69882582e-03 6.25019465e+00]
Stock Position:  0.003698825823181571
Bond Position:  [0.28955891]


portfolio before change:  [0.57023624]
curr_Stock_Price:  75.78490341427054
curr_Factors:  [7.57849034e+01 5.43090157e-02]
mat_Sqrt:  [[ 1.76611349e+01 -9.31045691e-03]
 [-9.31045691e-03  2.13636502e-02]]
grads:  [2.57713445e-03 1.45587293e+01]
Stock Position:  0.0025771344540830173
Bond Position:  [0.37492836]


portfolio before change:  [0.57085473]
curr_Stock_Price:  75.84292582811679
curr_Factors:  [7.58429258e+01 5.41558082e-02]
mat_Sqrt:  [[ 1.76497086e+01 -9.29732367e-03]
 [-9.29732367e-03  2.13334914e-02]]
grads:  [-0.01310874  6.64891288]
Stock Position:  -0.013108736651070487
Bond Position:  [1.56505967]


portfolio before change:  [0.59363494]
curr_Stock_Price:  74.2544685027263
curr_Factors:  [7.42544685e+01 6.08731759e-02]
mat_Sqrt:  [[ 1.83204236e+01 -9.85682836e-03]
 [-9.85682836e-03  2.26180170e-02]]
grads:  [-8.37917960e-05  1.46747134e+01]
Stock Position:  -8.379179604608992e-05
Bond Position:  [0.59985686]


portfolio before change:  [0.59480377]
curr_Stock_Price:  69.25947216210709
curr_Factors:  [69.25947216  0.07003354]
mat_Sqrt:  [[ 1.83287203e+01 -1.05715491e-02]
 [-1.05715491e-02  2.42606213e-02]]
grads:  [-0.01116932 -9.30239367]
Stock Position:  -0.01116931541348439
Bond Position:  [1.36838466]


portfolio before change:  [0.59787014]
curr_Stock_Price:  69.13817401045347
curr_Factors:  [69.13817401  0.06929403]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.59787014]
Stock Price:  67.0635619728428
PL:  [0.59787014]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.63918278e-01  2.51555081e-03]
 [-2.63631067e-01  9.76404157e-02]
 [ 4.02412746e-02  9.41809242e-02]
 [-4.23319764e-01 -2.21035996e-01]
 [ 1.16778004e-01  2.06970894e-02]
 [ 4.12504185e-02 -8.83900237e-02]
 [-1.10859459e-01 -1.40050170e-01]
 [ 3.59852874e-02  7.18909711e-02]
 [ 5.16094591e-02  4.01377780e-02]
 [ 6.08946118e-02 -3.43136381e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [-9.27501943e-03  4.09227879e-02]
 [ 2.94115797e-02  6.83442833e-02]
 [-1.72177077e-02 -1.95821072e-01]
 [-3.14166351e-02 -9.59543618e-02]
 [ 1.71880067e-01 -1.06039620e-01]
 [ 1.00222293e-01 -1.50174185e-01]
 [-1.00678281e-01  4.40686725e-02]
 [-1.10543223e-01 -1.24265143e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.77734405]
curr_Stock_Price:  97.27704797657323
curr_Factors:  [9.72770480e+01 4.62124055e-02]
mat_Sqrt:  [[ 2.09117142e+01 -8.59073368e-03]
 [-8.59073368e-03  1.97059217e-02]]
grads:  [0.00789244 0.13109525]
Stock Position:  0.007892441566236306
Bond Position:  [-4.54509747]


portfolio before change:  [-3.84515468]
curr_Stock_Price:  89.40550364289071
curr_Factors:  [8.94055036e+01 4.83191100e-02]
mat_Sqrt:  [[ 1.96527656e+01 -8.78363812e-03]
 [-8.78363812e-03  2.01504045e-02]]
grads:  [-0.01125095  4.84067659]
Stock Position:  -0.011250951673735365
Bond Position:  [-2.83925768]


portfolio before change:  [-3.83989756]
curr_Stock_Price:  88.62260026606401
curr_Factors:  [8.86226003e+01 5.09169492e-02]
mat_Sqrt:  [[ 1.99974966e+01 -9.01658806e-03]
 [-9.01658806e-03  2.06850340e-02]]
grads:  [4.06604081e-03 4.55486735e+00]
Stock Position:  0.004066040806450757
Bond Position:  [-4.20024067]


portfolio before change:  [-3.83504904]
curr_Stock_Price:  91.10710538209818
curr_Factors:  [9.11071054e+01 5.04573557e-02]
mat_Sqrt:  [[ 2.04651273e+01 -8.97605537e-03]
 [-8.97605537e-03  2.05913571e-02]]
grads:  [ -0.02539792 -10.74547773]
Stock Position:  -0.025397924953508125
Bond Position:  [-1.52111762]


portfolio before change:  [-3.88311571]
curr_Stock_Price:  92.92473720571316
curr_Factors:  [9.29247372e+01 4.09403616e-02]
mat_Sqrt:  [[ 1.88021338e+01 -8.08551441e-03]
 [-8.08551441e-03  1.85479938e-02]]
grads:  [0.006692   1.11878395]
Stock Position:  0.006692003634063077
Bond Position:  [-4.50496839]


portfolio before change:  [-3.88880468]
curr_Stock_Price:  92.91663237315764
curr_Factors:  [9.29166324e+01 4.42905100e-02]
mat_Sqrt:  [[ 1.95545921e+01 -8.40982815e-03]
 [-8.40982815e-03  1.92919644e-02]]
grads:  [ 1.39077582e-04 -4.58164095e+00]
Stock Position:  0.00013907758204042186
Bond Position:  [-3.9017273]


portfolio before change:  [-3.89362169]
curr_Stock_Price:  93.3710398686623
curr_Factors:  [9.33710399e+01 4.11299880e-02]
mat_Sqrt:  [[ 1.89361396e+01 -8.10425609e-03]
 [-8.10425609e-03  1.85908825e-02]]
grads:  [-0.00908016 -7.53723   ]
Stock Position:  -0.009080155974772554
Bond Position:  [-3.04579808]


portfolio before change:  [-3.93818417]
curr_Stock_Price:  97.8591629040679
curr_Factors:  [9.78591629e+01 3.71236142e-02]
mat_Sqrt:  [[ 1.88550021e+01 -7.69978370e-03]
 [-7.69978370e-03  1.76620914e-02]]
grads:  [3.57136655e-03 4.07191132e+00]
Stock Position:  0.0035713665464476565
Bond Position:  [-4.28767511]


portfolio before change:  [-3.9387073]
curr_Stock_Price:  99.2143356005851
curr_Factors:  [9.92143356e+01 3.39955827e-02]
mat_Sqrt:  [[ 1.82930296e+01 -7.36834915e-03]
 [-7.36834915e-03  1.69015756e-02]]
grads:  [0.00377848 2.3764423 ]
Stock Position:  0.003778483773389342
Bond Position:  [-4.31358706]


portfolio before change:  [-3.91257424]
curr_Stock_Price:  107.5585334535799
curr_Factors:  [1.07558533e+02 3.38705086e-02]
mat_Sqrt:  [[ 1.97950089e+01 -7.35530882e-03]
 [-7.35530882e-03  1.68702258e-02]]
grads:  [ 0.00232086 -2.03296434]
Stock Position:  0.0023208643907426537
Bond Position:  [-4.16220301]


portfolio before change:  [-3.92382911]
curr_Stock_Price:  104.95223503669722
curr_Factors:  [1.04952235e+02 3.57606618e-02]
mat_Sqrt:  [[ 1.98469801e+01 -7.55759549e-03]
 [-7.55759549e-03  1.73346292e-02]]
grads:  [ 4.83830698e-04 -7.05802512e+00]
Stock Position:  0.0004838306978933761
Bond Position:  [-3.97460822]


portfolio before change:  [-3.92968987]
curr_Stock_Price:  103.11399170469002
curr_Factors:  [1.03113992e+02 3.26921344e-02]
mat_Sqrt:  [[ 1.86440047e+01 -7.22596329e-03]
 [-7.22596329e-03  1.65742812e-02]]
grads:  [4.59542825e-04 2.46925390e+00]
Stock Position:  0.00045954282497330366
Bond Position:  [-3.97707517]


portfolio before change:  [-3.93156067]
curr_Stock_Price:  109.86779303594379
curr_Factors:  [1.09867793e+02 3.11794465e-02]
mat_Sqrt:  [[ 1.94001270e+01 -7.05719351e-03]
 [-7.05719351e-03  1.61861201e-02]]
grads:  [3.05251973e-03 4.22373151e+00]
Stock Position:  0.003052519728477041
Bond Position:  [-4.26693427]


portfolio before change:  [-3.92881801]
curr_Stock_Price:  112.51467326515858
curr_Factors:  [1.12514673e+02 3.14498522e-02]
mat_Sqrt:  [[ 1.99534704e+01 -7.08786843e-03]
 [-7.08786843e-03  1.62560956e-02]]
grads:  [-5.14267067e-03 -1.20482512e+01]
Stock Position:  -0.005142670669916411
Bond Position:  [-3.3501921]


portfolio before change:  [-3.92910689]
curr_Stock_Price:  111.75602320346805
curr_Factors:  [1.11756023e+02 2.78773759e-02]
mat_Sqrt:  [[ 1.86593649e+01 -6.67313466e-03]
 [-6.67313466e-03  1.53050003e-02]]
grads:  [-3.92645358e-03 -6.27118993e+00]
Stock Position:  -0.003926453581150621
Bond Position:  [-3.49030205]


portfolio before change:  [-3.93761063]
curr_Stock_Price:  112.80993648442956
curr_Factors:  [1.12809936e+02 2.88760497e-02]
mat_Sqrt:  [[ 1.91697398e+01 -6.79166347e-03]
 [-6.79166347e-03  1.55767071e-02]]
grads:  [ 6.55536870e-03 -6.80471796e+00]
Stock Position:  0.006555368704826333
Bond Position:  [-4.67712136]


portfolio before change:  [-3.92563347]
curr_Stock_Price:  115.52942044572323
curr_Factors:  [1.15529420e+02 3.00081135e-02]
mat_Sqrt:  [[ 2.00129871e+01 -6.92364697e-03]
 [-6.92364697e-03  1.58790506e-02]]
grads:  [ 1.73627195e-03 -9.45662100e+00]
Stock Position:  0.0017362719495365893
Bond Position:  [-4.12622396]


portfolio before change:  [-3.92539424]
curr_Stock_Price:  118.63966867451528
curr_Factors:  [1.18639669e+02 2.76662844e-02]
mat_Sqrt:  [[ 1.97335545e+01 -6.64813781e-03]
 [-6.64813781e-03  1.52468065e-02]]
grads:  [-0.00412874  2.88855401]
Stock Position:  -0.004128743042628897
Bond Position:  [-3.43556153]


portfolio before change:  [-3.94011658]
curr_Stock_Price:  121.16469977190647
curr_Factors:  [1.21164700e+02 2.97555717e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.94011658]
Stock Price:  114.63186836021801
PL:  [-18.57198494]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-4.80021933e-02 -7.61628278e-02]
 [ 4.11216644e-03  4.87642430e-02]
 [ 7.00941657e-02  1.49637209e-02]
 [ 1.41103071e-02  1.95635516e-02]
 [-6.12541402e-02 -7.81741491e-02]
 [ 1.27252440e-01  1.25712419e-01]
 [ 3.04055611e-02  4.99433772e-02]
 [ 3.56243537e-02  7.99306208e-02]
 [-6.03823354e-03 -9.94595783e-03]
 [ 5.24380131e-02  2.74538682e-01]
 [ 5.60392413e-02 -1.03382517e-01]
 [ 7.95262504e-03 -3.19901441e-02]
 [-1.17155446e-01 -1.40092194e-01]
 [ 3.05090384e-03  1.62997358e-01]
 [-7.58055913e-02 -4.49173667e-02]
 [ 2.29860519e-02 -2.29968004e-02]
 [-3.37735180e-03 -6.43121764e-02]
 [ 4.64772402e-02  4.92074454e-02]
 [ 1.15846724e-02 -5.31243825e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.00762647]
curr_Stock_Price:  101.2288617267525
curr_Factors:  [1.01228862e+02 3.88859771e-02]
mat_Sqrt:  [[ 1.99618518e+01 -7.88067537e-03]
 [-7.88067537e-03  1.80763582e-02]]
grads:  [-4.06878917e-03 -4.21516832e+00]
Stock Position:  -0.004068789166192139
Bond Position:  [11.41950536]


portfolio before change:  [11.03976176]
curr_Stock_Price:  96.84131841665472
curr_Factors:  [9.68413184e+01 3.34404371e-02]
mat_Sqrt:  [[ 1.77091057e+01 -7.30777389e-03]
 [-7.30777389e-03  1.67630788e-02]]
grads:  [1.43289225e-03 2.90965131e+00]
Stock Position:  0.0014328922508623427
Bond Position:  [10.90099859]


portfolio before change:  [11.05781343]
curr_Stock_Price:  99.92382642568724
curr_Factors:  [9.99238264e+01 3.29812009e-02]
mat_Sqrt:  [[ 1.81468920e+01 -7.25763346e-03]
 [-7.25763346e-03  1.66474853e-02]]
grads:  [0.00422282 0.90069872]
Stock Position:  0.004222822669519363
Bond Position:  [10.63585283]


portfolio before change:  [11.06430988]
curr_Stock_Price:  98.31194608985791
curr_Factors:  [9.83119461e+01 3.36083626e-02]
mat_Sqrt:  [[ 1.80231183e+01 -7.32620301e-03]
 [-7.32620301e-03  1.68050699e-02]]
grads:  [0.00125634 1.1646935 ]
Stock Position:  0.001256335766365727
Bond Position:  [10.94079706]


portfolio before change:  [11.08185108]
curr_Stock_Price:  101.38171534155207
curr_Factors:  [1.01381715e+02 3.10644430e-02]
mat_Sqrt:  [[ 1.78686354e+01 -7.04367497e-03]
 [-7.04367497e-03  1.61564561e-02]]
grads:  [-0.00533627 -4.84089677]
Stock Position:  -0.005336268928056583
Bond Position:  [11.62285118]


portfolio before change:  [11.09628717]
curr_Stock_Price:  101.40074706374355
curr_Factors:  [1.01400747e+02 3.49076079e-02]
mat_Sqrt:  [[ 1.89452860e+01 -7.46668174e-03]
 [-7.46668174e-03  1.71267260e-02]]
grads:  [0.00961137 7.34432162]
Stock Position:  0.009611369931431149
Bond Position:  [10.12168708]


portfolio before change:  [11.07895527]
curr_Stock_Price:  98.28028421447925
curr_Factors:  [9.82802842e+01 3.94603660e-02]
mat_Sqrt:  [[ 1.95230165e+01 -7.93844968e-03]
 [-7.93844968e-03  1.82094667e-02]]
grads:  [2.67313799e-03 2.74388035e+00]
Stock Position:  0.002673137988347652
Bond Position:  [10.81623851]


portfolio before change:  [11.09182172]
curr_Stock_Price:  98.03252198446718
curr_Factors:  [9.80325220e+01 3.98041684e-02]
mat_Sqrt:  [[ 1.95584492e+01 -7.97293818e-03]
 [-7.97293818e-03  1.82886287e-02]]
grads:  [3.60369468e-03 4.37208027e+00]
Stock Position:  0.003603694677611269
Bond Position:  [10.73854244]


portfolio before change:  [11.09781909]
curr_Stock_Price:  95.96958265228353
curr_Factors:  [9.59695827e+01 4.06428926e-02]
mat_Sqrt:  [[ 1.93475454e+01 -8.05633845e-03]
 [-8.05633845e-03  1.84803771e-02]]
grads:  [-5.36293326e-04 -5.38423991e-01]
Stock Position:  -0.0005362933259187634
Bond Position:  [11.14928693]


portfolio before change:  [11.11473075]
curr_Stock_Price:  90.43838809202964
curr_Factors:  [9.04383881e+01 4.38906138e-02]
mat_Sqrt:  [[ 1.89469190e+01 -8.37155006e-03]
 [-8.37155006e-03  1.92047725e-02]]
grads:  [9.08566152e-03 1.42992968e+01]
Stock Position:  0.009085661515095739
Bond Position:  [10.29303817]


portfolio before change:  [11.11870813]
curr_Stock_Price:  89.4591570874144
curr_Factors:  [8.94591571e+01 4.36418950e-02]
mat_Sqrt:  [[ 1.86885910e+01 -8.34770394e-03]
 [-8.34770394e-03  1.91503209e-02]]
grads:  [ 5.87337607e-04 -5.39821840e+00]
Stock Position:  0.0005873376068205158
Bond Position:  [11.06616541]


portfolio before change:  [11.13322765]
curr_Stock_Price:  90.61378665249934
curr_Factors:  [9.06137867e+01 3.82839066e-02]
mat_Sqrt:  [[ 1.77297398e+01 -7.81860057e-03]
 [-7.81860057e-03  1.79362357e-02]]
grads:  [-3.38041028e-04 -1.78369574e+00]
Stock Position:  -0.00033804102801453305
Bond Position:  [11.16385882]


portfolio before change:  [11.14638156]
curr_Stock_Price:  93.0088727107173
curr_Factors:  [9.30088727e+01 3.62937734e-02]
mat_Sqrt:  [[ 1.77190487e+01 -7.61286743e-03]
 [-7.61286743e-03  1.74637334e-02]]
grads:  [-0.01006027 -8.02627816]
Stock Position:  -0.010060271305484732
Bond Position:  [12.08207605]


portfolio before change:  [11.13169444]
curr_Stock_Price:  95.970935268231
curr_Factors:  [9.59709353e+01 3.43558578e-02]
mat_Sqrt:  [[ 1.77885311e+01 -7.40705897e-03]
 [-7.40705897e-03  1.69909993e-02]]
grads:  [4.16681135e-03 9.59497554e+00]
Stock Position:  0.00416681135373142
Bond Position:  [10.73180166]


portfolio before change:  [11.14483219]
curr_Stock_Price:  95.9024421994267
curr_Factors:  [9.59024422e+01 3.41261086e-02]
mat_Sqrt:  [[ 1.77162995e+01 -7.38224564e-03]
 [-7.38224564e-03  1.69340939e-02]]
grads:  [-0.00538511 -2.65482885]
Stock Position:  -0.005385108219410533
Bond Position:  [11.66127722]


portfolio before change:  [11.16134018]
curr_Stock_Price:  95.54547967528151
curr_Factors:  [9.55454797e+01 3.52033138e-02]
mat_Sqrt:  [[ 1.79267632e+01 -7.49782556e-03]
 [-7.49782556e-03  1.71992951e-02]]
grads:  [ 7.23122027e-04 -1.33676284e+00]
Stock Position:  0.0007231220267888725
Bond Position:  [11.09224914]


portfolio before change:  [11.17739288]
curr_Stock_Price:  98.55841488279387
curr_Factors:  [9.85584149e+01 3.30309457e-02]
mat_Sqrt:  [[ 1.79124165e+01 -7.26301244e-03]
 [-7.26301244e-03  1.66600752e-02]]
grads:  [-1.75409065e-03 -3.86102196e+00]
Stock Position:  -0.0017540906534512844
Bond Position:  [11.35027327]


portfolio before change:  [11.18957218]
curr_Stock_Price:  99.70853215052634
curr_Factors:  [9.97085322e+01 3.37252197e-02]
mat_Sqrt:  [[ 1.83108996e+01 -7.33902442e-03]
 [-7.33902442e-03  1.68342187e-02]]
grads:  [0.00371044 2.92467845]
Stock Position:  0.003710441766019938
Bond Position:  [10.81960948]


portfolio before change:  [11.19848514]
curr_Stock_Price:  98.46339477638801
curr_Factors:  [9.84633948e+01 3.57554701e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.19848514]
Stock Price:  98.57002552469517
PL:  [11.19848514]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.68671863e-01  4.13513850e-03]
 [ 3.74346275e-02 -2.64972282e-02]
 [ 6.73359594e-02  4.21733379e-02]
 [-1.45027265e-02 -4.18481289e-03]
 [-2.08950616e-01 -8.09838802e-03]
 [ 1.26420675e-01  1.19803207e-01]
 [-3.97729905e-02 -4.44499768e-02]
 [ 3.23046031e-02 -1.57976148e-02]
 [-5.86822821e-02 -5.06454227e-02]
 [ 4.37465641e-02  9.30787270e-02]
 [ 5.88961683e-02 -1.11231015e-01]
 [-8.15109717e-05 -5.33013641e-03]
 [-1.13664131e-01 -1.41421672e-01]
 [ 3.14237013e-03  1.63117640e-01]
 [-9.61119719e-02  3.12721238e-02]
 [ 7.19759966e-02 -4.56730255e-02]
 [ 1.02828932e-04 -7.49079705e-02]
 [ 9.83065421e-02 -1.28430028e-02]
 [ 7.14317773e-02  3.43896831e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.0743405]
curr_Stock_Price:  97.73223676590223
curr_Factors:  [9.77322368e+01 4.44030990e-02]
mat_Sqrt:  [[ 2.05941771e+01 -8.42091946e-03]
 [-8.42091946e-03  1.93162912e-02]]
grads:  [0.00827928 0.21768452]
Stock Position:  0.008279280380316669
Bond Position:  [-2.88349309]


portfolio before change:  [-2.06664317]
curr_Stock_Price:  99.09756652356819
curr_Factors:  [9.90975665e+01 4.36563216e-02]
mat_Sqrt:  [[ 2.07055382e+01 -8.34991490e-03]
 [-8.34991490e-03  1.91531234e-02]]
grads:  [ 1.25027220e-03 -1.38289656e+00]
Stock Position:  0.0012502721994124182
Bond Position:  [-2.19054211]


portfolio before change:  [-2.06927376]
curr_Stock_Price:  99.18499248172672
curr_Factors:  [9.91849925e+01 4.50999382e-02]
mat_Sqrt:  [[ 2.10636633e+01 -8.48685548e-03]
 [-8.48685548e-03  1.94672203e-02]]
grads:  [0.00407036 2.16815148]
Stock Position:  0.004070362623750637
Bond Position:  [-2.47299264]


portfolio before change:  [-2.06770086]
curr_Stock_Price:  100.33134539686468
curr_Factors:  [1.00331345e+02 4.55681559e-02]
mat_Sqrt:  [[ 2.14174286e+01 -8.53088606e-03]
 [-8.53088606e-03  1.95679723e-02]]
grads:  [-0.00076246 -0.21419273]
Stock Position:  -0.0007624622256251669
Bond Position:  [-1.991202]


portfolio before change:  [-2.06808981]
curr_Stock_Price:  97.57499698478685
curr_Factors:  [9.75749970e+01 4.60809805e-02]
mat_Sqrt:  [[ 2.09459164e+01 -8.57853391e-03]
 [-8.57853391e-03  1.96778698e-02]]
grads:  [-0.01014608 -0.41597117]
Stock Position:  -0.010146084530693171
Bond Position:  [-1.07808564]


portfolio before change:  [-2.08161159]
curr_Stock_Price:  98.77480263280354
curr_Factors:  [9.87748026e+01 4.43405713e-02]
mat_Sqrt:  [[ 2.07992070e+01 -8.41507149e-03]
 [-8.41507149e-03  1.93026497e-02]]
grads:  [0.00859076 6.21031314]
Stock Position:  0.008590755620133516
Bond Position:  [-2.93016178]


portfolio before change:  [-2.11083927]
curr_Stock_Price:  95.79919819849414
curr_Factors:  [9.57991982e+01 4.38094915e-02]
mat_Sqrt:  [[ 2.00514573e+01 -8.36428394e-03]
 [-8.36428394e-03  1.91868098e-02]]
grads:  [-0.00295047 -2.31798073]
Stock Position:  -0.0029504708050583583
Bond Position:  [-1.82818653]


portfolio before change:  [-2.09966744]
curr_Stock_Price:  91.23772488261245
curr_Factors:  [9.12377249e+01 4.23717363e-02]
mat_Sqrt:  [[ 1.87807329e+01 -8.22549485e-03]
 [-8.22549485e-03  1.88695150e-02]]
grads:  [ 0.00135368 -0.83661292]
Stock Position:  0.0013536770876115482
Bond Position:  [-2.22317385]


portfolio before change:  [-2.10043107]
curr_Stock_Price:  92.72779563955449
curr_Factors:  [9.27277956e+01 4.07454611e-02]
mat_Sqrt:  [[ 1.87175721e+01 -8.06622863e-03]
 [-8.06622863e-03  1.85037987e-02]]
grads:  [-0.00431546 -2.73890962]
Stock Position:  -0.004315461058050227
Bond Position:  [-1.70026788]


portfolio before change:  [-2.11451849]
curr_Stock_Price:  95.4994028623219
curr_Factors:  [9.54994029e+01 4.11443927e-02]
mat_Sqrt:  [[ 1.93711742e+01 -8.10585229e-03]
 [-8.10585229e-03  1.85940605e-02]]
grads:  [4.35381335e-03 5.00772913e+00]
Stock Position:  0.004353813351175822
Bond Position:  [-2.53030507]


portfolio before change:  [-2.11966072]
curr_Stock_Price:  95.04523432208666
curr_Factors:  [9.50452343e+01 4.20440320e-02]
mat_Sqrt:  [[ 1.94886828e+01 -8.19395447e-03]
 [-8.19395447e-03  1.87962611e-02]]
grads:  [ 5.34081546e-04 -5.91748741e+00]
Stock Position:  0.0005340815458067071
Bond Position:  [-2.17042262]


portfolio before change:  [-2.12352394]
curr_Stock_Price:  92.89481689746049
curr_Factors:  [9.28948169e+01 4.11497170e-02]
mat_Sqrt:  [[ 1.88440770e+01 -8.10615879e-03]
 [-8.10615879e-03  1.85953585e-02]]
grads:  [-1.27652589e-04 -2.86693648e-01]
Stock Position:  -0.00012765258883653096
Bond Position:  [-2.11166568]


portfolio before change:  [-2.12624493]
curr_Stock_Price:  93.51959265305948
curr_Factors:  [9.35195927e+01 4.83522733e-02]
mat_Sqrt:  [[ 2.05641620e+01 -8.78704782e-03]
 [-8.78704782e-03  2.01571457e-02]]
grads:  [-0.00852679 -7.01967426]
Stock Position:  -0.00852679259605109
Bond Position:  [-1.32882276]


portfolio before change:  [-2.10232126]
curr_Stock_Price:  90.51896435890743
curr_Factors:  [9.05189644e+01 5.17649281e-02]
mat_Sqrt:  [[ 2.05947888e+01 -9.09155668e-03]
 [-9.09155668e-03  2.08564829e-02]]
grads:  [3.60583098e-03 7.82252806e+00]
Stock Position:  0.0036058309816914156
Bond Position:  [-2.42871735]


portfolio before change:  [-2.10507941]
curr_Stock_Price:  90.59651724620905
curr_Factors:  [9.05965172e+01 4.94148083e-02]
mat_Sqrt:  [[ 2.01390981e+01 -8.88278963e-03]
 [-8.88278963e-03  2.03775399e-02]]
grads:  [-0.00409631  1.53285123]
Stock Position:  -0.004096309396399132
Bond Position:  [-1.73396805]


portfolio before change:  [-2.13554172]
curr_Stock_Price:  97.50358714119658
curr_Factors:  [9.75035871e+01 4.23991478e-02]
mat_Sqrt:  [[ 2.00770140e+01 -8.22868584e-03]
 [-8.22868584e-03  1.88753863e-02]]
grads:  [ 0.00259372 -2.41858269]
Stock Position:  0.0025937243241833993
Bond Position:  [-2.38843915]


portfolio before change:  [-2.13431842]
curr_Stock_Price:  99.12701341446962
curr_Factors:  [9.91270134e+01 3.80120923e-02]
mat_Sqrt:  [[ 1.93264850e+01 -7.79147149e-03]
 [-7.79147149e-03  1.78721542e-02]]
grads:  [-1.68470713e-03 -4.19205744e+00]
Stock Position:  -0.0016847071333366019
Bond Position:  [-1.96731843]


portfolio before change:  [-2.13251357]
curr_Stock_Price:  96.59509835111423
curr_Factors:  [9.65950984e+01 4.03010840e-02]
mat_Sqrt:  [[ 1.93915898e+01 -8.02243940e-03]
 [-8.02243940e-03  1.84024810e-02]]
grads:  [ 0.00478168 -0.69581064]
Stock Position:  0.004781683420680241
Bond Position:  [-2.59440075]


portfolio before change:  [-2.13732299]
curr_Stock_Price:  96.26793575212001
curr_Factors:  [9.62679358e+01 4.09619500e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.13732299]
Stock Price:  99.78522948461823
PL:  [-2.13732299]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-5.20244440e-02 -7.80732894e-02]
 [-7.48320382e-02  7.00226192e-02]
 [ 5.89205232e-02  6.71868596e-02]
 [ 1.10327145e-02  9.68105777e-03]
 [ 3.61036037e-01  3.25096395e-02]
 [ 8.99930692e-02  3.52778088e-02]
 [-1.28114861e-01 -1.63255459e-01]
 [ 3.22864980e-02 -1.58761962e-02]
 [-1.11241155e-01 -9.00240194e-02]
 [ 6.85526764e-02  3.43643900e-01]
 [ 5.44574954e-02 -9.90371740e-02]
 [ 2.11565852e-02 -8.22173305e-02]
 [-1.57883625e-01 -1.21397298e-01]
 [ 3.58407704e-03  1.43801802e-01]
 [-9.62049307e-02  2.51231073e-01]
 [-2.55603986e-01  1.21992613e-01]
 [-1.56275315e-01  3.63690374e-01]
 [-4.50591136e-02 -1.93675315e-01]
 [-3.12520135e-02  1.15094214e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.51783565]
curr_Stock_Price:  101.09794756177814
curr_Factors:  [1.01097948e+02 3.92346961e-02]
mat_Sqrt:  [[ 2.00252272e+01 -7.91592312e-03]
 [-7.91592312e-03  1.81572333e-02]]
grads:  [-4.29840421e-03 -4.30171898e+00]
Stock Position:  -0.004298404208935848
Bond Position:  [10.9523955]


portfolio before change:  [10.55954002]
curr_Stock_Price:  94.58266649352423
curr_Factors:  [9.45826665e+01 4.27305466e-02]
mat_Sqrt:  [[ 1.95515296e+01 -8.26054203e-03]
 [-8.26054203e-03  1.89491137e-02]]
grads:  [-2.26657648e-03  3.69430977e+00]
Stock Position:  -0.0022665764823178646
Bond Position:  [10.77391887]


portfolio before change:  [10.56801729]
curr_Stock_Price:  96.78799676179739
curr_Factors:  [9.67879968e+01 3.83542277e-02]
mat_Sqrt:  [[ 1.89551875e+01 -7.82628255e-03]
 [-7.82628255e-03  1.79524811e-02]]
grads:  [0.00465446 3.74451232]
Stock Position:  0.004654458552118146
Bond Position:  [10.11752157]


portfolio before change:  [10.57603707]
curr_Stock_Price:  95.79217234867397
curr_Factors:  [9.57921723e+01 3.36304935e-02]
mat_Sqrt:  [[ 1.75669597e+01 -7.32843517e-03]
 [-7.32843517e-03  1.68106803e-02]]
grads:  [0.00086844 0.57626592]
Stock Position:  0.0008684395115179259
Bond Position:  [10.49284737]


portfolio before change:  [10.58532539]
curr_Stock_Price:  91.37512231675935
curr_Factors:  [9.13751223e+01 3.63940074e-02]
mat_Sqrt:  [[ 1.74318255e+01 -7.62323836e-03]
 [-7.62323836e-03  1.74878904e-02]]
grads:  [0.02152838 1.86836461]
Stock Position:  0.02152838359185345
Bond Position:  [8.61816671]


portfolio before change:  [10.70273418]
curr_Stock_Price:  96.32808792763491
curr_Factors:  [9.63280879e+01 3.37070407e-02]
mat_Sqrt:  [[ 1.76853319e+01 -7.33680967e-03]
 [-7.33680967e-03  1.68297840e-02]]
grads:  [0.00595924 2.09875127]
Stock Position:  0.005959243987752523
Bond Position:  [10.1286916]


portfolio before change:  [10.69427765]
curr_Stock_Price:  92.78312339180421
curr_Factors:  [9.27831234e+01 3.76638143e-02]
mat_Sqrt:  [[ 1.80065743e+01 -7.75520559e-03]
 [-7.75520559e-03  1.77903044e-02]]
grads:  [-0.01106924 -9.18147886]
Stock Position:  -0.011069241324289441
Bond Position:  [11.72131644]


portfolio before change:  [10.72539913]
curr_Stock_Price:  91.29605986773426
curr_Factors:  [9.12960599e+01 4.01032991e-02]
mat_Sqrt:  [[ 1.82827720e+01 -8.00228903e-03]
 [-8.00228903e-03  1.83574606e-02]]
grads:  [ 0.00138768 -0.86423127]
Stock Position:  0.0013876817769370607
Bond Position:  [10.59870925]


portfolio before change:  [10.73677417]
curr_Stock_Price:  89.94010739444911
curr_Factors:  [8.99401074e+01 4.52705233e-02]
mat_Sqrt:  [[ 1.91364386e+01 -8.50208363e-03]
 [-8.50208363e-03  1.95043535e-02]]
grads:  [-0.00786523 -4.61901442]
Stock Position:  -0.007865225324381008
Bond Position:  [11.44417338]


portfolio before change:  [10.76989476]
curr_Stock_Price:  87.54902050120432
curr_Factors:  [8.75490205e+01 4.02697549e-02]
mat_Sqrt:  [[ 1.75687450e+01 -8.01853505e-03]
 [-8.01853505e-03  1.83956692e-02]]
grads:  [1.24304802e-02 1.86861141e+01]
Stock Position:  0.012430480231777936
Bond Position:  [9.68161839]


portfolio before change:  [10.77867722]
curr_Stock_Price:  87.28136115577698
curr_Factors:  [8.72813612e+01 3.93871156e-02]
mat_Sqrt:  [[ 1.73220207e+01 -7.93014694e-03]
 [-7.93014694e-03  1.81929636e-02]]
grads:  [ 6.51791590e-04 -5.44342347e+00]
Stock Position:  0.0006517915904692093
Bond Position:  [10.72178796]


portfolio before change:  [10.7916231]
curr_Stock_Price:  86.56834902294804
curr_Factors:  [8.6568349e+01 3.9697770e-02]
mat_Sqrt:  [[ 1.72481351e+01 -7.96129008e-03]
 [-7.96129008e-03  1.82645986e-02]]
grads:  [-8.51325960e-04 -4.50182948e+00]
Stock Position:  -0.0008513259595695682
Bond Position:  [10.86532098]


portfolio before change:  [10.80455073]
curr_Stock_Price:  87.34655635656635
curr_Factors:  [8.73465564e+01 4.10492161e-02]
mat_Sqrt:  [[ 1.76969399e+01 -8.09574686e-03]
 [-8.09574686e-03  1.85728577e-02]]
grads:  [-0.01191402 -6.54146782]
Stock Position:  -0.011914019810216626
Bond Position:  [11.84519934]


portfolio before change:  [10.9078115]
curr_Stock_Price:  79.92294839894954
curr_Factors:  [7.99229484e+01 4.50270852e-02]
mat_Sqrt:  [[ 1.69593171e+01 -8.47811129e-03]
 [-8.47811129e-03  1.94523130e-02]]
grads:  [3.90777565e-03 7.39423287e+00]
Stock Position:  0.003907775646340574
Bond Position:  [10.59549055]


portfolio before change:  [10.91779103]
curr_Stock_Price:  79.08535837589079
curr_Factors:  [7.90853584e+01 4.37042997e-02]
mat_Sqrt:  [[ 1.65332455e+01 -8.35254856e-03]
 [-8.35254856e-03  1.91644966e-02]]
grads:  [8.04026192e-04 1.31095428e+01]
Stock Position:  0.0008040261917423629
Bond Position:  [10.85420433]


portfolio before change:  [10.93076098]
curr_Stock_Price:  78.33128649680144
curr_Factors:  [7.83312865e+01 4.50904526e-02]
mat_Sqrt:  [[ 1.66332648e+01 -8.48387738e-03]
 [-8.48387738e-03  1.94660821e-02]]
grads:  [-0.01217326  6.26162658]
Stock Position:  -0.012173263427817119
Bond Position:  [11.88430836]


portfolio before change:  [11.02238558]
curr_Stock_Price:  72.0256706901352
curr_Factors:  [7.20256707e+01 5.41972968e-02]
mat_Sqrt:  [[ 1.67677989e+01 -9.30028925e-03]
 [-9.30028925e-03  2.13419209e-02]]
grads:  [1.31956829e-04 1.70411840e+01]
Stock Position:  0.00013195682898918716
Bond Position:  [11.0128813]


portfolio before change:  [11.0365253]
curr_Stock_Price:  74.79184505952082
curr_Factors:  [7.47918451e+01 4.82646788e-02]
mat_Sqrt:  [[ 1.64311854e+01 -8.77693277e-03]
 [-8.77693277e-03  2.01398173e-02]]
grads:  [-7.88092650e-03 -9.61997236e+00]
Stock Position:  -0.007880926499469722
Bond Position:  [11.62595433]


portfolio before change:  [11.10138576]
curr_Stock_Price:  68.40694500888367
curr_Factors:  [6.8406945e+01 5.1145078e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.10138576]
Stock Price:  67.17553278005909
PL:  [11.10138576]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 6.82962176e-02 -1.97795993e-02]
 [-1.03428587e-01 -1.63847495e-01]
 [-1.10906349e-01 -2.46939636e-01]
 [-2.42915297e-02 -2.96094628e-02]
 [ 2.05077362e-02 -8.99747776e-02]
 [ 1.27257160e-01  1.28501827e-01]
 [ 2.64554110e-02  4.48377273e-02]
 [-5.01276642e-02  9.65527315e-02]
 [ 5.16537953e-02  4.00368351e-02]
 [ 4.43033091e-02  8.92043903e-02]
 [ 6.28201664e-02 -1.22010950e-01]
 [ 4.65874275e-02  2.91499500e-02]
 [ 2.47565682e-02  9.33998419e-02]
 [-1.59342531e-02 -1.98035043e-01]
 [-1.61718611e-02 -1.04360211e-01]
 [ 2.28835314e-01 -1.75998904e-01]
 [ 1.77038049e-01 -1.51375821e-01]
 [-1.62015284e-01  5.03537614e-02]
 [-1.34318649e-01 -1.72124631e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.89455212]
curr_Stock_Price:  105.20792664563152
curr_Factors:  [1.05207927e+02 4.14525851e-02]
mat_Sqrt:  [[ 2.14202354e+01 -8.13687417e-03]
 [-8.13687417e-03  1.86632561e-02]]
grads:  [ 0.00278627 -1.05860026]
Stock Position:  0.002786268182636697
Bond Position:  [25.60141462]


portfolio before change:  [25.93095357]
curr_Stock_Price:  106.77980266949479
curr_Factors:  [1.06779803e+02 4.46200967e-02]
mat_Sqrt:  [[ 2.25555976e+01 -8.44214116e-03]
 [-8.44214116e-03  1.93631408e-02]]
grads:  [-7.75386424e-03 -8.46520491e+00]
Stock Position:  -0.007753864241884209
Bond Position:  [26.75890966]


portfolio before change:  [25.97261262]
curr_Stock_Price:  105.72361988654171
curr_Factors:  [1.05723620e+02 4.68626985e-02]
mat_Sqrt:  [[ 2.28868298e+01 -8.65161692e-03]
 [-8.65161692e-03  1.98438028e-02]]
grads:  [-9.55154395e-03 -1.24483334e+01]
Stock Position:  -0.009551543946582752
Bond Position:  [26.98243642]


portfolio before change:  [25.99068432]
curr_Stock_Price:  107.36496985765918
curr_Factors:  [1.07364970e+02 4.01672898e-02]
mat_Sqrt:  [[ 2.15178483e+01 -8.00987339e-03]
 [-8.00987339e-03  1.83715766e-02]]
grads:  [-0.00172913 -1.6124535 ]
Stock Position:  -0.0017291263311763484
Bond Position:  [26.17633192]


portfolio before change:  [26.03227348]
curr_Stock_Price:  102.2477727995722
curr_Factors:  [1.02247773e+02 4.26437593e-02]
mat_Sqrt:  [[ 2.11145371e+01 -8.25274806e-03]
 [-8.25274806e-03  1.89295996e-02]]
grads:  [-8.86678576e-04 -4.75351285e+00]
Stock Position:  -0.0008866785764541518
Bond Position:  [26.12293439]


portfolio before change:  [26.06665178]
curr_Stock_Price:  100.32575357177298
curr_Factors:  [1.00325754e+02 4.28608925e-02]
mat_Sqrt:  [[ 2.07703111e+01 -8.27359005e-03]
 [-8.27359005e-03  1.89777931e-02]]
grads:  [0.00882562 6.77501571]
Stock Position:  0.008825619501691811
Bond Position:  [25.18121485]


portfolio before change:  [26.10346765]
curr_Stock_Price:  100.92850781835081
curr_Factors:  [1.00928508e+02 4.29291369e-02]
mat_Sqrt:  [[ 2.09117268e+01 -8.28021930e-03]
 [-8.28021930e-03  1.89928760e-02]]
grads:  [2.20024919e-03 2.36172478e+00]
Stock Position:  0.002200249194696489
Bond Position:  [25.88139979]


portfolio before change:  [26.13502607]
curr_Stock_Price:  100.55874796688596
curr_Factors:  [1.00558748e+02 4.21556437e-02]
mat_Sqrt:  [[ 2.06465592e+01 -8.20525673e-03]
 [-8.20525673e-03  1.88210042e-02]]
grads:  [-3.89201033e-04  5.12988239e+00]
Stock Position:  -0.0003892010328284289
Bond Position:  [26.17416364]


portfolio before change:  [26.16836199]
curr_Stock_Price:  99.02289166504671
curr_Factors:  [9.90228917e+01 4.04602407e-02]
mat_Sqrt:  [[ 1.99181868e+01 -8.03845172e-03]
 [-8.03845172e-03  1.84387012e-02]]
grads:  [0.00347021 2.17286076]
Stock Position:  0.0034702070248149456
Bond Position:  [25.82473205]


portfolio before change:  [26.18871637]
curr_Stock_Price:  95.58023919985972
curr_Factors:  [9.55802392e+01 3.80648496e-02]
mat_Sqrt:  [[ 1.86479087e+01 -7.79660925e-03]
 [-7.79660925e-03  1.78846689e-02]]
grads:  [4.46195184e-03 4.98970258e+00]
Stock Position:  0.004461951835282004
Bond Position:  [25.76224195]


portfolio before change:  [26.2583717]
curr_Stock_Price:  103.96948156342567
curr_Factors:  [1.03969482e+02 3.34273611e-02]
mat_Sqrt:  [[ 1.90088959e+01 -7.30681873e-03]
 [-7.30681873e-03  1.67595946e-02]]
grads:  [ 5.06481768e-04 -7.27984492e+00]
Stock Position:  0.0005064817683434988
Bond Position:  [26.20571306]


portfolio before change:  [26.29337149]
curr_Stock_Price:  108.35693601182872
curr_Factors:  [1.08356936e+02 2.97237258e-02]
mat_Sqrt:  [[ 1.86813523e+01 -6.89039948e-03]
 [-6.89039948e-03  1.58037860e-02]]
grads:  [0.00317462 1.84587568]
Stock Position:  0.003174622880595834
Bond Position:  [25.94937908]


portfolio before change:  [26.33823758]
curr_Stock_Price:  112.26577398324432
curr_Factors:  [1.12265774e+02 2.58604332e-02]
mat_Sqrt:  [[ 1.80536594e+01 -6.42722431e-03]
 [-6.42722431e-03  1.47409335e-02]]
grads:  [3.62752985e-03 6.33766899e+00]
Stock Position:  0.0036275298473318934
Bond Position:  [25.93099014]


portfolio before change:  [26.37050686]
curr_Stock_Price:  112.2203637349215
curr_Factors:  [1.12220364e+02 2.22502601e-02]
mat_Sqrt:  [[ 1.67393732e+01 -5.96173904e-03]
 [-5.96173904e-03  1.36733415e-02]]
grads:  [-6.11108697e-03 -1.44859598e+01]
Stock Position:  -0.0061110869715127044
Bond Position:  [27.05629526]


portfolio before change:  [26.39337051]
curr_Stock_Price:  114.0167481857891
curr_Factors:  [1.14016748e+02 2.40480517e-02]
mat_Sqrt:  [[ 1.76810712e+01 -6.19799112e-03]
 [-6.19799112e-03  1.42149718e-02]]
grads:  [-3.48871822e-03 -7.34309120e+00]
Stock Position:  -0.0034887182154807192
Bond Position:  [26.79114282]


portfolio before change:  [26.39995115]
curr_Stock_Price:  121.73569482529724
curr_Factors:  [1.21735695e+02 2.23097467e-02]
mat_Sqrt:  [[ 1.81829873e+01 -5.97008401e-03]
 [-5.97008401e-03  1.36914413e-02]]
grads:  [ 8.36571316e-03 -1.28510181e+01]
Stock Position:  0.008365713160997585
Bond Position:  [25.38154525]


portfolio before change:  [26.45916538]
curr_Stock_Price:  125.01903247818541
curr_Factors:  [1.25019032e+02 2.00330669e-02]
mat_Sqrt:  [[ 1.76949700e+01 -5.65738096e-03]
 [-5.65738096e-03  1.29740013e-02]]
grads:  [ 6.27552989e-03 -1.16648915e+01]
Stock Position:  0.006275529890020002
Bond Position:  [25.67460471]


portfolio before change:  [26.51097739]
curr_Stock_Price:  128.15800025107663
curr_Factors:  [1.28158000e+02 1.86375547e-02]
mat_Sqrt:  [[ 1.74960562e+01 -5.45687446e-03]
 [-5.45687446e-03  1.25139150e-02]]
grads:  [-0.0080062   4.02033039]
Stock Position:  -0.008006195435141127
Bond Position:  [27.53703539]


portfolio before change:  [26.52733663]
curr_Stock_Price:  130.4166978676221
curr_Factors:  [1.30416698e+02 2.06378929e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [26.52733663]
Stock Price:  136.20579915785845
PL:  [-9.67846252]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 4.25230844e-02 -3.27546414e-02]
 [-1.16473374e-01 -1.69417279e-01]
 [-2.07211076e-01 -2.07946313e-01]
 [-2.23780082e-02 -2.44084066e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.27139558e-01  1.04212367e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-1.26402712e-01  4.07420710e-02]
 [ 4.60397582e-02  3.82299957e-02]
 [ 7.47442437e-02 -5.54531639e-02]
 [ 1.58653705e-01 -1.07097063e-01]
 [ 6.26113082e-01 -5.27065885e-02]
 [ 2.19191658e-02  1.86103232e-01]
 [-4.83549017e-02 -1.42109115e-01]
 [ 1.08875297e-02 -1.19280548e-01]
 [ 2.49562919e-01 -2.01459040e-01]
 [ 1.37309220e-01 -1.49072987e-01]
 [-1.60762134e-01  5.02018290e-02]
 [-1.38577350e-01 -1.80759458e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.29309617]
curr_Stock_Price:  104.2453083482211
curr_Factors:  [1.04245308e+02 3.80666799e-02]
mat_Sqrt:  [[ 2.03389714e+01 -7.79741770e-03]
 [-7.79741770e-03  1.78848281e-02]]
grads:  [ 1.38883399e-03 -1.83081503e+00]
Stock Position:  0.0013888339898686507
Bond Position:  [22.14831674]


portfolio before change:  [22.32469908]
curr_Stock_Price:  107.05356515568208
curr_Factors:  [1.07053565e+02 3.76813469e-02]
mat_Sqrt:  [[ 2.07808981e+01 -7.75803112e-03]
 [-7.75803112e-03  1.77939996e-02]]
grads:  [-9.16076092e-03 -9.52502821e+00]
Stock Position:  -0.009160760921224531
Bond Position:  [23.3053912]


portfolio before change:  [22.3556227]
curr_Stock_Price:  106.8599494326423
curr_Factors:  [1.06859949e+02 3.62782625e-02]
mat_Sqrt:  [[ 2.03534565e+01 -7.61221200e-03]
 [-7.61221200e-03  1.74595777e-02]]
grads:  [ -0.01463743 -11.91653888]
Stock Position:  -0.014637430075237197
Bond Position:  [23.91977774]


portfolio before change:  [22.42873318]
curr_Stock_Price:  103.9091538876356
curr_Factors:  [1.03909154e+02 3.63186793e-02]
mat_Sqrt:  [[ 1.98024443e+01 -7.61626574e-03]
 [-7.61626574e-03  1.74693815e-02]]
grads:  [-0.00166773 -1.39793779]
Stock Position:  -0.0016677271444461965
Bond Position:  [22.6020253]


portfolio before change:  [22.45035373]
curr_Stock_Price:  107.8964027831614
curr_Factors:  [1.07896403e+02 3.91445422e-02]
mat_Sqrt:  [[ 2.13472799e+01 -7.90727459e-03]
 [-7.90727459e-03  1.81361636e-02]]
grads:  [ 0.00768136 -6.50904919]
Stock Position:  0.007681360006682437
Bond Position:  [21.62156262]


portfolio before change:  [22.50359484]
curr_Stock_Price:  111.30689973566457
curr_Factors:  [1.11306900e+02 4.01429944e-02]
mat_Sqrt:  [[ 2.23011337e+01 -8.00769253e-03]
 [-8.00769253e-03  1.83659142e-02]]
grads:  [0.0077397  5.67760161]
Stock Position:  0.007739698295960946
Bond Position:  [21.64211302]


portfolio before change:  [22.55059112]
curr_Stock_Price:  113.88151148173635
curr_Factors:  [1.13881511e+02 4.37644124e-02]
mat_Sqrt:  [[ 2.38239488e+01 -8.36124862e-03]
 [-8.36124862e-03  1.91763825e-02]]
grads:  [3.76720838e-03 4.22494472e+00]
Stock Position:  0.0037672083817361407
Bond Position:  [22.12157573]


portfolio before change:  [22.57291198]
curr_Stock_Price:  112.46178737313176
curr_Factors:  [1.12461787e+02 4.27466695e-02]
mat_Sqrt:  [[ 2.32517741e+01 -8.26337227e-03]
 [-8.26337227e-03  1.89521337e-02]]
grads:  [-0.004673    2.14769782]
Stock Position:  -0.004672997607997342
Bond Position:  [23.09844564]


portfolio before change:  [22.56310488]
curr_Stock_Price:  120.74302599377431
curr_Factors:  [1.20743026e+02 4.37063399e-02]
mat_Sqrt:  [[ 2.52426096e+01 -8.35608127e-03]
 [-8.35608127e-03  1.91634888e-02]]
grads:  [0.00248464 1.99602264]
Stock Position:  0.0024846355634789504
Bond Position:  [22.26310246]


portfolio before change:  [22.58683179]
curr_Stock_Price:  119.08508875918447
curr_Factors:  [1.19085089e+02 4.10683332e-02]
mat_Sqrt:  [[ 2.41329770e+01 -8.09989497e-03]
 [-8.09989497e-03  1.85761953e-02]]
grads:  [ 2.09555804e-03 -2.98425964e+00]
Stock Position:  0.00209555804429025
Bond Position:  [22.33728207]


portfolio before change:  [22.63406488]
curr_Stock_Price:  128.2921963727965
curr_Factors:  [1.28292196e+02 3.87308178e-02]
mat_Sqrt:  [[ 2.52480913e+01 -7.86643858e-03]
 [-7.86643858e-03  1.80396043e-02]]
grads:  [ 4.43469742e-03 -5.93484070e+00]
Stock Position:  0.004434697421471882
Bond Position:  [22.06512781]


portfolio before change:  [22.66599346]
curr_Stock_Price:  129.26857048650677
curr_Factors:  [1.29268570e+02 3.79030183e-02]
mat_Sqrt:  [[ 2.51669058e+01 -7.78196122e-03]
 [-7.78196122e-03  1.78457632e-02]]
grads:  [ 0.02396841 -2.94299923]
Stock Position:  0.02396841238555271
Bond Position:  [19.56763105]


portfolio before change:  [22.50057957]
curr_Stock_Price:  121.34611336241511
curr_Factors:  [1.21346113e+02 4.00022112e-02]
mat_Sqrt:  [[ 2.42698921e+01 -7.99418275e-03]
 [-7.99418275e-03  1.83334436e-02]]
grads:  [4.24736601e-03 1.01528764e+01]
Stock Position:  0.004247366012309463
Bond Position:  [21.98517821]


portfolio before change:  [22.52136169]
curr_Stock_Price:  119.7647718076712
curr_Factors:  [1.19764772e+02 4.42680450e-02]
mat_Sqrt:  [[ 2.51984739e+01 -8.40955308e-03]
 [-8.40955308e-03  1.92862611e-02]]
grads:  [-4.37867821e-03 -7.37032111e+00]
Stock Position:  -0.004378678208402631
Bond Position:  [23.04577309]


portfolio before change:  [22.55762549]
curr_Stock_Price:  118.0659562327675
curr_Factors:  [1.18065956e+02 4.64254239e-02]
mat_Sqrt:  [[ 2.54391504e+01 -8.61193820e-03]
 [-8.61193820e-03  1.97506648e-02]]
grads:  [-1.61675117e-03 -6.04002311e+00]
Stock Position:  -0.0016167511675537853
Bond Position:  [22.74850876]


portfolio before change:  [22.57514956]
curr_Stock_Price:  124.82602003078306
curr_Factors:  [1.24826020e+02 4.21183883e-02]
mat_Sqrt:  [[ 2.56177494e+01 -8.20308260e-03]
 [-8.20308260e-03  1.88120525e-02]]
grads:  [ 6.31352708e-03 -1.07062879e+01]
Stock Position:  0.006313527076432164
Bond Position:  [21.7870571]


portfolio before change:  [22.58070586]
curr_Stock_Price:  121.38981892415205
curr_Factors:  [1.21389819e+02 4.29478972e-02]
mat_Sqrt:  [[ 2.51566723e+01 -8.28329530e-03]
 [-8.28329530e-03  1.89964731e-02]]
grads:  [ 2.87467446e-03 -7.84614986e+00]
Stock Position:  0.002874674458330885
Bond Position:  [22.23174965]


portfolio before change:  [22.62735089]
curr_Stock_Price:  127.94289823551222
curr_Factors:  [1.27942898e+02 3.60786737e-02]
mat_Sqrt:  [[ 2.43019680e+01 -7.59231569e-03]
 [-7.59231569e-03  1.74110160e-02]]
grads:  [-0.00571517  2.88084495]
Stock Position:  -0.005715168811219316
Bond Position:  [23.35856616]


portfolio before change:  [22.63347463]
curr_Stock_Price:  131.98350137287454
curr_Factors:  [1.31983501e+02 3.15583246e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.63347463]
Stock Price:  141.15138550241932
PL:  [-18.51791087]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-9.19360278e-04 -5.85918888e-02]
 [ 2.94726322e-02 -4.60160140e-02]
 [ 5.65648163e-02  7.41886391e-02]
 [ 1.77582808e-02  2.25725558e-02]
 [-1.41726706e-01  6.44403308e-03]
 [ 5.38882323e-02 -4.65595722e-02]
 [-1.08515507e-01 -1.36897928e-01]
 [ 3.22549624e-02 -1.60130705e-02]
 [-7.77258359e-02 -6.49096776e-02]
 [ 3.78478478e-02  2.05450029e-01]
 [ 5.65097725e-02 -1.04675152e-01]
 [ 5.02401461e-03 -2.14282068e-02]
 [-9.07777187e-02 -1.38151613e-01]
 [ 5.72578190e-03  1.66514920e-01]
 [-6.50812172e-02 -7.47230561e-02]
 [ 9.16061918e-02 -5.59655441e-02]
 [-5.85989635e-03 -5.61909638e-02]
 [ 1.08284711e-01 -3.53096581e-02]
 [ 9.10295935e-02  4.74019978e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.50843796]
curr_Stock_Price:  99.75900632636413
curr_Factors:  [9.97590063e+01 3.83735350e-02]
mat_Sqrt:  [[ 1.95419539e+01 -7.82847276e-03]
 [-7.82847276e-03  1.79569030e-02]]
grads:  [-1.35440099e-03 -3.26350773e+00]
Stock Position:  -0.001354400990317599
Bond Position:  [5.64355166]


portfolio before change:  [5.51563586]
curr_Stock_Price:  99.65633802956911
curr_Factors:  [9.96563380e+01 3.90842331e-02]
mat_Sqrt:  [[ 1.97017901e+01 -7.90062643e-03]
 [-7.90062643e-03  1.81224290e-02]]
grads:  [ 4.77784340e-04 -2.53896645e+00]
Stock Position:  0.0004777843401347745
Bond Position:  [5.46802163]


portfolio before change:  [5.52078413]
curr_Stock_Price:  96.1170061046325
curr_Factors:  [9.61170061e+01 3.85765073e-02]
mat_Sqrt:  [[ 1.88782464e+01 -7.84887632e-03]
 [-7.84887632e-03  1.80044498e-02]]
grads:  [0.00471033 4.12262583]
Stock Position:  0.004710331398026646
Bond Position:  [5.06804118]


portfolio before change:  [5.53633932]
curr_Stock_Price:  98.07359371806996
curr_Factors:  [9.80735937e+01 3.94675564e-02]
mat_Sqrt:  [[ 1.94837331e+01 -7.93915733e-03]
 [-7.93915733e-03  1.82111325e-02]]
grads:  [0.00141676 1.24010979]
Stock Position:  0.0014167566006335168
Bond Position:  [5.3973929]


portfolio before change:  [5.53862381]
curr_Stock_Price:  94.92099168119508
curr_Factors:  [9.49209917e+01 3.92007116e-02]
mat_Sqrt:  [[ 1.87935664e+01 -7.91202762e-03]
 [-7.91202762e-03  1.81495712e-02]]
grads:  [-0.00739312  0.35182862]
Stock Position:  -0.00739311658916387
Bond Position:  [6.24038576]


portfolio before change:  [5.55397284]
curr_Stock_Price:  93.90062743608486
curr_Factors:  [9.39006274e+01 4.18786255e-02]
mat_Sqrt:  [[ 1.92160741e+01 -8.17772451e-03]
 [-8.17772451e-03  1.87592931e-02]]
grads:  [ 1.74842092e-03 -2.48118487e+00]
Stock Position:  0.0017484209225561355
Bond Position:  [5.38979502]


portfolio before change:  [5.5599283]
curr_Stock_Price:  93.4510839314138
curr_Factors:  [9.34510839e+01 4.12565252e-02]
mat_Sqrt:  [[ 1.89815043e+01 -8.11671977e-03]
 [-8.11671977e-03  1.86194552e-02]]
grads:  [-0.00886254 -7.3562766 ]
Stock Position:  -0.00886254012232716
Bond Position:  [6.38814228]


portfolio before change:  [5.55784471]
curr_Stock_Price:  94.58775171032418
curr_Factors:  [9.45877517e+01 3.90799494e-02]
mat_Sqrt:  [[ 1.86987192e+01 -7.89980442e-03]
 [-7.89980442e-03  1.81216054e-02]]
grads:  [ 0.00135191 -0.8830559 ]
Stock Position:  0.0013519104251608202
Bond Position:  [5.42997054]


portfolio before change:  [5.56075522]
curr_Stock_Price:  91.71685464736844
curr_Factors:  [9.17168546e+01 3.97520863e-02]
mat_Sqrt:  [[ 1.82864362e+01 -7.96720781e-03]
 [-7.96720781e-03  1.82768833e-02]]
grads:  [-0.0057989 -3.553991 ]
Stock Position:  -0.005798900324134933
Bond Position:  [6.09261212]


portfolio before change:  [5.55992753]
curr_Stock_Price:  93.17371957241313
curr_Factors:  [9.31737196e+01 3.49807301e-02]
mat_Sqrt:  [[ 1.74264060e+01 -7.47390196e-03]
 [-7.47390196e-03  1.71449144e-02]]
grads:  [7.31261159e-03 1.19863347e+01]
Stock Position:  0.007312611587367526
Bond Position:  [4.87858431]


portfolio before change:  [5.54358195]
curr_Stock_Price:  90.10400602157637
curr_Factors:  [9.01040060e+01 3.77665727e-02]
mat_Sqrt:  [[ 1.75104717e+01 -7.76554976e-03]
 [-7.76554976e-03  1.78146559e-02]]
grads:  [ 6.21522241e-04 -5.87551768e+00]
Stock Position:  0.0006215222413568192
Bond Position:  [5.48758031]


portfolio before change:  [5.55129833]
curr_Stock_Price:  91.47581326268762
curr_Factors:  [9.14758133e+01 3.28112232e-02]
mat_Sqrt:  [[ 1.65698069e+01 -7.23829451e-03]
 [-7.23829451e-03  1.66047982e-02]]
grads:  [-2.60576498e-04 -1.29059641e+00]
Stock Position:  -0.00026057649833821373
Bond Position:  [5.57513477]


portfolio before change:  [5.55681465]
curr_Stock_Price:  97.0670769812983
curr_Factors:  [9.7067077e+01 2.8843245e-02]
mat_Sqrt:  [[ 1.64851907e+01 -6.78691083e-03]
 [-6.78691083e-03  1.55682463e-02]]
grads:  [-0.00916164 -8.87792947]
Stock Position:  -0.009161643159061043
Bond Position:  [6.44610857]


portfolio before change:  [5.60291901]
curr_Stock_Price:  92.91479897075907
curr_Factors:  [9.29147990e+01 3.36537139e-02]
mat_Sqrt:  [[ 1.70451705e+01 -7.33074768e-03]
 [-7.33074768e-03  1.68165775e-02]]
grads:  [4.59533664e-03 9.90383491e+00]
Stock Position:  0.00459533663949065
Bond Position:  [5.17594423]


portfolio before change:  [5.63449981]
curr_Stock_Price:  98.37834200948679
curr_Factors:  [9.8378342e+01 3.5646776e-02]
mat_Sqrt:  [[ 1.85741775e+01 -7.54511170e-03]
 [-7.54511170e-03  1.73071965e-02]]
grads:  [-0.0052586  -4.31974832]
Stock Position:  -0.0052586016671346
Bond Position:  [6.15183232]


portfolio before change:  [5.63724438]
curr_Stock_Price:  99.319661506301
curr_Factors:  [9.93196615e+01 3.36856102e-02]
mat_Sqrt:  [[ 1.82287717e+01 -7.33468702e-03]
 [-7.33468702e-03  1.68243415e-02]]
grads:  [ 0.00368755 -3.32485506]
Stock Position:  0.003687545261219356
Bond Position:  [5.27099864]


portfolio before change:  [5.63985732]
curr_Stock_Price:  98.24037207059514
curr_Factors:  [9.82403721e+01 3.34489664e-02]
mat_Sqrt:  [[ 1.79672377e+01 -7.30880421e-03]
 [-7.30880421e-03  1.67651736e-02]]
grads:  [-1.68984357e-03 -3.35238489e+00]
Stock Position:  -0.0016898435723081409
Bond Position:  [5.80586818]


portfolio before change:  [5.6525864]
curr_Stock_Price:  95.00504133911596
curr_Factors:  [9.50050413e+01 3.44204141e-02]
mat_Sqrt:  [[ 1.76260362e+01 -7.41394288e-03]
 [-7.41394288e-03  1.70069866e-02]]
grads:  [ 0.00527112 -2.07388758]
Stock Position:  0.005271124269657637
Bond Position:  [5.15180302]


portfolio before change:  [5.66197032]
curr_Stock_Price:  95.56282326484299
curr_Factors:  [9.55628233e+01 3.27028959e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.66197032]
Stock Price:  95.12674398740019
PL:  [5.66197032]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.54365900e-01 -2.46354005e-03]
 [-2.79311931e-02 -1.25397269e-01]
 [ 7.40074167e-02 -9.14711002e-02]
 [-2.36745719e-02 -2.79325378e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.27721265e-01  1.08128908e-01]
 [ 2.89820263e-02  4.81034294e-02]
 [ 3.52475074e-02 -3.02451414e-03]
 [ 7.31503207e-02  6.47536802e-02]
 [ 6.54972655e-02 -5.20035535e-02]
 [ 7.28301277e-02 -1.40780211e-01]
 [-1.06528941e-02  3.98562994e-02]
 [-8.43244077e-02 -1.37229550e-01]
 [ 5.16387379e-03  1.65775990e-01]
 [-6.88289069e-02 -6.42868063e-02]
 [ 1.01965493e-01 -5.76923074e-02]
 [ 1.60103502e-02 -1.16349358e-01]
 [ 1.05044601e-01 -2.80256221e-02]
 [ 1.35804946e-01  7.45731314e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.43027574]
curr_Stock_Price:  98.17167205219836
curr_Factors:  [9.81716721e+01 3.95225884e-02]
mat_Sqrt:  [[ 1.95168103e+01 -7.94469783e-03]
 [-7.94469783e-03  1.82238212e-02]]
grads:  [ 0.00785575 -0.13175769]
Stock Position:  0.00785574704299885
Bond Position:  [-1.20148756]


portfolio before change:  [-0.38012483]
curr_Stock_Price:  104.74694775064712
curr_Factors:  [1.04746948e+02 3.70852256e-02]
mat_Sqrt:  [[ 2.01716678e+01 -7.69627521e-03]
 [-7.69627521e-03  1.76527506e-02]]
grads:  [-4.09563769e-03 -7.10533971e+00]
Stock Position:  -0.004095637686605205
Bond Position:  [0.04888071]


portfolio before change:  [-0.36725915]
curr_Stock_Price:  101.62056289362711
curr_Factors:  [1.01620563e+02 3.78734290e-02]
mat_Sqrt:  [[ 1.97764746e+01 -7.77742368e-03]
 [-7.77742368e-03  1.78394498e-02]]
grads:  [ 1.72603186e-03 -5.12670945e+00]
Stock Position:  0.0017260318598009067
Bond Position:  [-0.54265948]


portfolio before change:  [-0.36279451]
curr_Stock_Price:  104.60045564406309
curr_Factors:  [1.04600456e+02 3.89165687e-02]
mat_Sqrt:  [[ 2.06348262e+01 -7.88400454e-03]
 [-7.88400454e-03  1.80833669e-02]]
grads:  [-0.00173777 -1.54541123]
Stock Position:  -0.0017377709304632768
Bond Position:  [-0.18102288]


portfolio before change:  [-0.36349546]
curr_Stock_Price:  104.87352377068157
curr_Factors:  [1.04873524e+02 3.76328330e-02]
mat_Sqrt:  [[ 2.03446061e+01 -7.75289749e-03]
 [-7.75289749e-03  1.77826014e-02]]
grads:  [ 0.00806004 -6.63836683]
Stock Position:  0.008060043192971553
Bond Position:  [-1.20878059]


portfolio before change:  [-0.37281191]
curr_Stock_Price:  103.90522482705408
curr_Factors:  [1.03905225e+02 3.62466258e-02]
mat_Sqrt:  [[ 1.97820432e+01 -7.60870670e-03]
 [-7.60870670e-03  1.74520440e-02]]
grads:  [0.00884097 6.19962776]
Stock Position:  0.008840968143682439
Bond Position:  [-1.2914347]


portfolio before change:  [-0.39331123]
curr_Stock_Price:  101.76925763800982
curr_Factors:  [1.01769258e+02 3.73173889e-02]
mat_Sqrt:  [[ 1.96594877e+01 -7.72013048e-03]
 [-7.72013048e-03  1.77080059e-02]]
grads:  [2.54137617e-03 2.71758714e+00]
Stock Position:  0.002541376167584695
Bond Position:  [-0.6519452]


portfolio before change:  [-0.40883256]
curr_Stock_Price:  95.98267267838735
curr_Factors:  [9.59826727e+01 4.04854243e-02]
mat_Sqrt:  [[ 1.93126624e+01 -8.04071746e-03]
 [-8.04071746e-03  1.84445414e-02]]
grads:  [ 0.00175715 -0.16321281]
Stock Position:  0.001757145574736235
Bond Position:  [-0.57748809]


portfolio before change:  [-0.39855974]
curr_Stock_Price:  102.24005468196368
curr_Factors:  [1.02240055e+02 3.64885811e-02]
mat_Sqrt:  [[ 1.95298779e+01 -7.63394987e-03]
 [-7.63394987e-03  1.75102433e-02]]
grads:  [0.00519196 3.70030925]
Stock Position:  0.005191957504122623
Bond Position:  [-0.92938576]


portfolio before change:  [-0.3961292]
curr_Stock_Price:  102.93208666172447
curr_Factors:  [1.02932087e+02 3.62753254e-02]
mat_Sqrt:  [[ 1.96045285e+01 -7.61165490e-03]
 [-7.61165490e-03  1.74589794e-02]]
grads:  [ 2.18481852e-03 -2.97766107e+00]
Stock Position:  0.002184818522754212
Bond Position:  [-0.62101713]


portfolio before change:  [-0.40032736]
curr_Stock_Price:  101.36609879231911
curr_Factors:  [1.01366099e+02 3.39458236e-02]
mat_Sqrt:  [[ 1.86760864e+01 -7.36309895e-03]
 [-7.36309895e-03  1.68891388e-02]]
grads:  [ 6.13438967e-04 -8.33527961e+00]
Stock Position:  0.0006134389665606899
Bond Position:  [-0.46250927]


portfolio before change:  [-0.4023303]
curr_Stock_Price:  99.04403033915086
curr_Factors:  [9.90440303e+01 3.59801993e-02]
mat_Sqrt:  [[ 1.87871132e+01 -7.58036373e-03]
 [-7.58036373e-03  1.73879291e-02]]
grads:  [3.5789759e-04 2.2923381e+00]
Stock Position:  0.0003578975901191749
Bond Position:  [-0.43777792]


portfolio before change:  [-0.40321973]
curr_Stock_Price:  98.08883453021018
curr_Factors:  [9.80888345e+01 3.85381346e-02]
mat_Sqrt:  [[ 1.92559470e+01 -7.84512190e-03]
 [-7.84512190e-03  1.79954274e-02]]
grads:  [-7.48731569e-03 -7.62906521e+00]
Stock Position:  -0.007487315687934998
Bond Position:  [0.33120234]


portfolio before change:  [-0.36877789]
curr_Stock_Price:  93.54413731804898
curr_Factors:  [9.35441373e+01 4.23965898e-02]
mat_Sqrt:  [[ 1.92611404e+01 -8.22811050e-03]
 [-8.22811050e-03  1.88749595e-02]]
grads:  [4.02076808e-03 8.78460552e+00]
Stock Position:  0.004020768084533064
Bond Position:  [-0.74489717]


portfolio before change:  [-0.35373303]
curr_Stock_Price:  97.51764700805161
curr_Factors:  [9.7517647e+01 4.1836840e-02]
mat_Sqrt:  [[ 1.99463123e+01 -8.17393941e-03]
 [-8.17393941e-03  1.87498031e-02]]
grads:  [-0.00485663 -3.43078292]
Stock Position:  -0.004856633002402866
Bond Position:  [0.11987439]


portfolio before change:  [-0.36374078]
curr_Stock_Price:  99.60915575972854
curr_Factors:  [9.96091558e+01 4.11784113e-02]
mat_Sqrt:  [[ 2.02131509e+01 -8.10952345e-03]
 [-8.10952345e-03  1.86016059e-02]]
grads:  [ 0.00380087 -3.09981216]
Stock Position:  0.003800866758515575
Bond Position:  [-0.74234191]


portfolio before change:  [-0.3581015]
curr_Stock_Price:  101.33712669512454
curr_Factors:  [1.01337127e+02 4.11696058e-02]
mat_Sqrt:  [[ 2.05616000e+01 -8.10878348e-03]
 [-8.10878348e-03  1.85995615e-02]]
grads:  [-1.68858587e-03 -6.25622544e+00]
Stock Position:  -0.0016885858709928879
Bond Position:  [-0.18698506]


portfolio before change:  [-0.34849507]
curr_Stock_Price:  95.5095836162345
curr_Factors:  [9.55095836e+01 4.38412829e-02]
mat_Sqrt:  [[ 1.99980910e+01 -8.36729400e-03]
 [-8.36729400e-03  1.91937808e-02]]
grads:  [ 0.00464265 -1.45811688]
Stock Position:  0.004642648574850807
Bond Position:  [-0.79191251]


portfolio before change:  [-0.36707437]
curr_Stock_Price:  91.7210601809566
curr_Factors:  [9.17210602e+01 4.58374358e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.36707437]
Stock Price:  90.44270640213219
PL:  [-0.36707437]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.68824141e-01  3.07576147e-03]
 [ 2.33027724e-02 -6.37970969e-02]
 [ 7.41606120e-02 -8.77689981e-02]
 [-1.70663784e-02 -9.97110668e-03]
 [-2.09551196e-01 -1.76536040e-02]
 [ 7.40476654e-02  4.78426722e-03]
 [ 2.75612442e-02  4.62670395e-02]
 [-6.88257608e-02  9.36534245e-02]
 [ 6.54909182e-02  5.51743487e-02]
 [ 6.01379423e-02 -2.78084762e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 2.87907388e-01 -4.71756030e-03]
 [ 1.80242601e-02  1.29636431e-01]
 [-1.54025807e-02 -1.98952183e-01]
 [-3.75699472e-02 -9.25614735e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 4.01080779e-02 -1.47467312e-01]
 [ 4.91252547e-03  3.85469049e-02]
 [-5.64718912e-02 -5.20585783e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.94086116]
curr_Stock_Price:  98.03519978169896
curr_Factors:  [9.80351998e+01 3.87503792e-02]
mat_Sqrt:  [[ 1.92983412e+01 -7.86669130e-03]
 [-7.86669130e-03  1.80449151e-02]]
grads:  [0.00881917 0.17429504]
Stock Position:  0.008819165558210239
Bond Position:  [-1.80544982]


portfolio before change:  [-0.91627709]
curr_Stock_Price:  101.07883153695107
curr_Factors:  [1.01078832e+02 4.07203972e-02]
mat_Sqrt:  [[ 2.03969946e+01 -8.06440536e-03]
 [-8.06440536e-03  1.84978198e-02]]
grads:  [-2.21175626e-04 -3.44899459e+00]
Stock Position:  -0.00022117562612552715
Bond Position:  [-0.89392092]


portfolio before change:  [-0.91750012]
curr_Stock_Price:  101.55323487188582
curr_Factors:  [1.01553235e+02 3.46708322e-02]
mat_Sqrt:  [[ 1.89093178e+01 -7.44132577e-03]
 [-7.44132577e-03  1.70685381e-02]]
grads:  [ 1.89865928e-03 -5.14132312e+00]
Stock Position:  0.0018986592798281886
Bond Position:  [-1.11031511]


portfolio before change:  [-0.91936411]
curr_Stock_Price:  101.30293571371342
curr_Factors:  [1.01302936e+02 3.48301384e-02]
mat_Sqrt:  [[ 1.89059976e+01 -7.45838533e-03]
 [-7.45838533e-03  1.71077138e-02]]
grads:  [-0.00113282 -0.58333661]
Stock Position:  -0.0011328218723164474
Bond Position:  [-0.80460593]


portfolio before change:  [-0.91691765]
curr_Stock_Price:  98.2549290631071
curr_Factors:  [9.82549291e+01 4.30293575e-02]
mat_Sqrt:  [[ 2.03815281e+01 -8.28967431e-03]
 [-8.28967431e-03  1.90151223e-02]]
grads:  [-0.01066092 -0.93304578]
Stock Position:  -0.010660920065994945
Bond Position:  [0.1305703]


portfolio before change:  [-0.88540152]
curr_Stock_Price:  95.31401870898326
curr_Factors:  [9.53140187e+01 4.19290603e-02]
mat_Sqrt:  [[ 1.95170560e+01 -8.18276563e-03]
 [-8.18276563e-03  1.87705341e-02]]
grads:  [0.00390157 0.25658262]
Stock Position:  0.0039015731143782063
Bond Position:  [-1.25727614]


portfolio before change:  [-0.87214953]
curr_Stock_Price:  99.11365798149995
curr_Factors:  [9.91136580e+01 4.17211072e-02]
mat_Sqrt:  [[ 2.02447017e+01 -8.16274928e-03]
 [-8.16274928e-03  1.87237976e-02]]
grads:  [2.35814899e-03 2.47205665e+00]
Stock Position:  0.0023581489894834336
Bond Position:  [-1.1058743]


portfolio before change:  [-0.86958102]
curr_Stock_Price:  100.78942717285922
curr_Factors:  [1.00789427e+02 3.83271496e-02]
mat_Sqrt:  [[ 1.97318681e+01 -7.82381329e-03]
 [-7.82381329e-03  1.79460146e-02]]
grads:  [-1.41907980e-03  5.21800097e+00]
Stock Position:  -0.0014190797991977023
Bond Position:  [-0.72655278]


portfolio before change:  [-0.87812276]
curr_Stock_Price:  106.16824640642167
curr_Factors:  [1.06168246e+02 3.80543835e-02]
mat_Sqrt:  [[ 2.07108040e+01 -7.79628229e-03]
 [-7.79628229e-03  1.78818852e-02]]
grads:  [0.00432436 3.08737373]
Stock Position:  0.004324359175472415
Bond Position:  [-1.33723239]


portfolio before change:  [-0.86271404]
curr_Stock_Price:  110.11826538382157
curr_Factors:  [1.10118265e+02 3.19163483e-02]
mat_Sqrt:  [[ 1.96727889e+01 -7.14011567e-03]
 [-7.14011567e-03  1.63762704e-02]]
grads:  [ 0.00244098 -1.69703154]
Stock Position:  0.002440982877734854
Bond Position:  [-1.13151084]


portfolio before change:  [-0.85600827]
curr_Stock_Price:  113.44522049569503
curr_Factors:  [1.13445220e+02 3.25870825e-02]
mat_Sqrt:  [[ 2.04790080e+01 -7.21492769e-03]
 [-7.21492769e-03  1.65473757e-02]]
grads:  [ 4.68690219e-04 -7.39383243e+00]
Stock Position:  0.0004686902185142743
Bond Position:  [-0.90917894]


portfolio before change:  [-0.85542118]
curr_Stock_Price:  117.12415355387522
curr_Factors:  [1.17124154e+02 3.09016802e-02]
mat_Sqrt:  [[ 2.05891059e+01 -7.02605109e-03]
 [-7.02605109e-03  1.61137025e-02]]
grads:  [ 0.01388564 -0.28671245]
Stock Position:  0.013885640958616689
Bond Position:  [-2.48176512]


portfolio before change:  [-0.87758194]
curr_Stock_Price:  115.75175647930813
curr_Factors:  [1.15751756e+02 3.17067877e-02]
mat_Sqrt:  [[ 2.06112194e+01 -7.11692439e-03]
 [-7.11692439e-03  1.63222935e-02]]
grads:  [3.61745612e-03 7.94386992e+00]
Stock Position:  0.003617456116447623
Bond Position:  [-1.29630884]


portfolio before change:  [-0.89244686]
curr_Stock_Price:  112.09075246619102
curr_Factors:  [1.12090752e+02 3.31501052e-02]
mat_Sqrt:  [[ 2.04085529e+01 -7.27691767e-03]
 [-7.27691767e-03  1.66897430e-02]]
grads:  [-5.00593439e-03 -1.19228086e+01]
Stock Position:  -0.00500593439441878
Bond Position:  [-0.33132791]


portfolio before change:  [-0.88664008]
curr_Stock_Price:  110.84798884060346
curr_Factors:  [1.10847989e+02 3.30036496e-02]
mat_Sqrt:  [[ 2.01376493e+01 -7.26075883e-03]
 [-7.26075883e-03  1.66528639e-02]]
grads:  [-3.87034321e-03 -5.55997908e+00]
Stock Position:  -0.0038703432149188406
Bond Position:  [-0.45762032]


portfolio before change:  [-0.86671091]
curr_Stock_Price:  105.55089872376325
curr_Factors:  [1.05550899e+02 3.45992876e-02]
mat_Sqrt:  [[ 1.96333986e+01 -7.43389799e-03]
 [-7.43389799e-03  1.70508075e-02]]
grads:  [ 0.00553403 -3.57768422]
Stock Position:  0.005534025309395204
Bond Position:  [-1.45083226]


portfolio before change:  [-0.86415916]
curr_Stock_Price:  106.33991299704472
curr_Factors:  [1.06339913e+02 3.47606368e-02]
mat_Sqrt:  [[ 1.98262296e+01 -7.45125931e-03]
 [-7.45125931e-03  1.70904974e-02]]
grads:  [-1.22009728e-03 -8.62914632e+00]
Stock Position:  -0.0012200972797975541
Bond Position:  [-0.73441412]


portfolio before change:  [-0.86224423]
curr_Stock_Price:  104.01753852336137
curr_Factors:  [1.04017539e+02 3.71067406e-02]
mat_Sqrt:  [[ 2.00370114e+01 -7.69846018e-03]
 [-7.69846018e-03  1.76578911e-02]]
grads:  [1.08408305e-03 2.18345727e+00]
Stock Position:  0.0010840830472701607
Bond Position:  [-0.97500788]


portfolio before change:  [-0.86662311]
curr_Stock_Price:  101.10322262296832
curr_Factors:  [1.01103223e+02 3.78287047e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.86662311]
Stock Price:  101.46226046236596
PL:  [-2.32888357]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-4.49509219e-02 -7.47162845e-02]
 [ 2.33027724e-02 -6.37970969e-02]
 [ 7.03617613e-02 -1.15891209e-01]
 [-2.39851606e-02 -2.87767349e-02]
 [ 1.38391816e-01 -1.06988896e-01]
 [ 1.19973955e-01  1.03910423e-01]
 [ 1.63453089e-02  3.10214857e-02]
 [ 3.56009489e-02  9.39690302e-02]
 [ 5.36326304e-02  4.30589561e-02]
 [ 4.90587689e-02  2.60055366e-01]
 [ 5.64740479e-02 -1.04577010e-01]
 [ 1.48413802e-02 -5.81946151e-02]
 [-1.38629787e-01 -1.30235123e-01]
 [ 1.87488563e-03  1.61450852e-01]
 [-9.28327308e-02  3.67302401e-03]
 [-1.01920859e-01  4.03066770e-02]
 [-1.10248960e-01  2.18797314e-01]
 [ 1.03884270e-01 -9.99717884e-02]
 [ 9.16355156e-02  5.79510440e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.37696941]
curr_Stock_Price:  101.32758187729036
curr_Factors:  [1.01327582e+02 3.78854019e-02]
mat_Sqrt:  [[ 1.97225740e+01 -7.77863265e-03]
 [-7.77863265e-03  1.78422782e-02]]
grads:  [-3.93143608e-03 -4.18931174e+00]
Stock Position:  -0.003931436077693645
Bond Position:  [11.77533232]


portfolio before change:  [11.39084067]
curr_Stock_Price:  101.54559521882977
curr_Factors:  [1.01545595e+02 3.82894702e-02]
mat_Sqrt:  [[ 1.98701312e+01 -7.82001947e-03]
 [-7.82001947e-03  1.79371681e-02]]
grads:  [-2.27046934e-04 -3.55679739e+00]
Stock Position:  -0.00022704693422110549
Bond Position:  [11.41389629]


portfolio before change:  [11.40498994]
curr_Stock_Price:  102.10505085326741
curr_Factors:  [1.02105051e+02 3.81430324e-02]
mat_Sqrt:  [[ 1.99413612e+01 -7.80508990e-03]
 [-7.80508990e-03  1.79028181e-02]]
grads:  [ 9.94920419e-04 -6.47291632e+00]
Stock Position:  0.0009949204192482872
Bond Position:  [11.30340354]


portfolio before change:  [11.4217829]
curr_Stock_Price:  104.77348118194256
curr_Factors:  [1.04773481e+02 4.09058392e-02]
mat_Sqrt:  [[ 2.11906362e+01 -8.08300553e-03]
 [-8.08300553e-03  1.85397792e-02]]
grads:  [-0.00172422 -1.55291341]
Stock Position:  -0.0017242223397917033
Bond Position:  [11.60243568]


portfolio before change:  [11.43846295]
curr_Stock_Price:  103.51614103424501
curr_Factors:  [1.03516141e+02 3.99564667e-02]
mat_Sqrt:  [[ 2.06919576e+01 -7.98857193e-03]
 [-7.98857193e-03  1.83234109e-02]]
grads:  [ 4.43470092e-03 -5.83698470e+00]
Stock Position:  0.004434700918965232
Bond Position:  [10.97939982]


portfolio before change:  [11.42921797]
curr_Stock_Price:  98.33477458400353
curr_Factors:  [9.83347746e+01 3.86961014e-02]
mat_Sqrt:  [[ 1.93437512e+01 -7.86120230e-03]
 [-7.86120230e-03  1.80322631e-02]]
grads:  [0.00854556 5.7661981 ]
Stock Position:  0.008545560933589495
Bond Position:  [10.58889216]


portfolio before change:  [11.43720217]
curr_Stock_Price:  97.71922800600275
curr_Factors:  [9.77192280e+01 3.99705349e-02]
mat_Sqrt:  [[ 1.95366444e+01 -7.98955881e-03]
 [-7.98955881e-03  1.83268191e-02]]
grads:  [1.52914803e-03 1.69334912e+00]
Stock Position:  0.0015291480317630838
Bond Position:  [11.28777501]


portfolio before change:  [11.45251434]
curr_Stock_Price:  98.49980861215464
curr_Factors:  [9.84998086e+01 4.22738351e-02]
mat_Sqrt:  [[ 2.02521519e+01 -8.21659476e-03]
 [-8.21659476e-03  1.88474381e-02]]
grads:  [3.78135435e-03 4.98742056e+00]
Stock Position:  0.0037813543491324437
Bond Position:  [11.08005166]


portfolio before change:  [11.47151358]
curr_Stock_Price:  99.85924714124909
curr_Factors:  [9.98592471e+01 4.33425250e-02]
mat_Sqrt:  [[ 2.07895628e+01 -8.31991032e-03]
 [-8.31991032e-03  1.90841385e-02]]
grads:  [0.00348335 2.25778791]
Stock Position:  0.0034833451766606042
Bond Position:  [11.12366935]


portfolio before change:  [11.45473674]
curr_Stock_Price:  91.04871638331558
curr_Factors:  [9.10487164e+01 5.18919517e-02]
mat_Sqrt:  [[ 2.07407181e+01 -9.10275811e-03]
 [-9.10275811e-03  2.08820332e-02]]
grads:  [7.83249001e-03 1.24569605e+01]
Stock Position:  0.007832490005152007
Bond Position:  [10.74159858]


portfolio before change:  [11.46042169]
curr_Stock_Price:  90.05919101319051
curr_Factors:  [9.00591910e+01 4.81019243e-02]
mat_Sqrt:  [[ 1.97519157e+01 -8.76394060e-03]
 [-8.76394060e-03  2.01050389e-02]]
grads:  [ 5.51350758e-04 -5.20129201e+00]
Stock Position:  0.0005513507578726799
Bond Position:  [11.41076748]


portfolio before change:  [11.47384265]
curr_Stock_Price:  88.51496357590672
curr_Factors:  [8.85149636e+01 4.69318679e-02]
mat_Sqrt:  [[ 1.91756710e+01 -8.65654151e-03]
 [-8.65654151e-03  1.98590777e-02]]
grads:  [-5.49009981e-04 -2.93061785e+00]
Stock Position:  -0.0005490099811348389
Bond Position:  [11.52243825]


portfolio before change:  [11.48741662]
curr_Stock_Price:  90.04150782235575
curr_Factors:  [9.00415078e+01 5.16466293e-02]
mat_Sqrt:  [[ 2.04627363e+01 -9.08111352e-03]
 [-9.08111352e-03  2.08326587e-02]]
grads:  [-0.00955093 -6.25565164]
Stock Position:  -0.009550925487030695
Bond Position:  [12.34739635]


portfolio before change:  [11.5056077]
curr_Stock_Price:  89.75387242766458
curr_Factors:  [8.97538724e+01 5.19539743e-02]
mat_Sqrt:  [[ 2.04579701e+01 -9.10806425e-03]
 [-9.10806425e-03  2.08945665e-02]]
grads:  [3.53242695e-03 7.72846978e+00]
Stock Position:  0.0035324269464968978
Bond Position:  [11.1885587]


portfolio before change:  [11.52735944]
curr_Stock_Price:  91.94989902631256
curr_Factors:  [9.19498990e+01 5.63899137e-02]
mat_Sqrt:  [[ 2.18349364e+01 -9.48916494e-03]
 [-9.48916494e-03  2.17682081e-02]]
grads:  [-0.00417903  0.16691169]
Stock Position:  -0.004179031103217805
Bond Position:  [11.91162093]


portfolio before change:  [11.55692441]
curr_Stock_Price:  88.44044305789622
curr_Factors:  [8.84404431e+01 5.87673891e-02]
mat_Sqrt:  [[ 2.14397177e+01 -9.68675500e-03]
 [-9.68675500e-03  2.22225262e-02]]
grads:  [-0.00393512  1.81206035]
Stock Position:  -0.003935120594524508
Bond Position:  [11.90494822]


portfolio before change:  [11.59636176]
curr_Stock_Price:  82.20254864123328
curr_Factors:  [8.22025486e+01 6.00468998e-02]
mat_Sqrt:  [[ 2.01432956e+01 -9.79087011e-03]
 [-9.79087011e-03  2.24634784e-02]]
grads:  [-7.39090397e-04  9.73981295e+00]
Stock Position:  -0.0007390903974773622
Bond Position:  [11.65711688]


portfolio before change:  [11.60578445]
curr_Stock_Price:  89.18115867624681
curr_Factors:  [8.91811587e+01 5.94376807e-02]
mat_Sqrt:  [[ 2.17422254e+01 -9.74192495e-03]
 [-9.74192495e-03  2.23488636e-02]]
grads:  [ 2.77423769e-03 -4.47202881e+00]
Stock Position:  0.002774237689580475
Bond Position:  [11.35837471]


portfolio before change:  [11.61896023]
curr_Stock_Price:  88.80950170891366
curr_Factors:  [8.88095017e+01 6.57072613e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.61896023]
Stock Price:  96.33688591777101
PL:  [11.61896023]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-5.95160681e-02 -8.10291943e-02]
 [-4.60099674e-02 -1.40013956e-01]
 [-5.40601256e-01 -6.81146162e-02]
 [-2.05821197e-02 -1.95270837e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26993015e-01  1.04794297e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-2.34695683e-01  4.58295136e-02]
 [ 5.22157992e-02  4.10608727e-02]
 [ 6.09714270e-02 -3.49481978e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [-8.75653369e-03  4.30753901e-02]
 [ 2.42495811e-02 -1.28600520e-02]
 [ 1.06481941e-02  7.62229887e-02]
 [-6.34127186e-02 -7.91556067e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 2.94699501e-02 -1.46222938e-01]
 [-5.27845831e-02  3.91736260e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.42620331]
curr_Stock_Price:  100.80616965874863
curr_Factors:  [1.00806170e+02 3.96754241e-02]
mat_Sqrt:  [[ 2.00792676e+01 -7.96023834e-03]
 [-7.96023834e-03  1.82589388e-02]]
grads:  [-0.00472419 -4.43984181]
Stock Position:  -0.0047241895932079656
Bond Position:  [9.90243077]


portfolio before change:  [9.41617349]
curr_Stock_Price:  105.55102677017248
curr_Factors:  [1.05551027e+02 3.62209810e-02]
mat_Sqrt:  [[ 2.00882699e+01 -7.60611914e-03]
 [-7.60611914e-03  1.74458236e-02]]
grads:  [-5.33005787e-03 -8.02796703e+00]
Stock Position:  -0.005330057865197361
Bond Position:  [9.97876657]


portfolio before change:  [9.39942649]
curr_Stock_Price:  111.0346919458517
curr_Factors:  [1.11034692e+02 3.26143195e-02]
mat_Sqrt:  [[ 2.00522368e+01 -7.21781574e-03]
 [-7.21781574e-03  1.65543448e-02]]
grads:  [-0.02844517 -4.1270089 ]
Stock Position:  -0.028445168060354287
Bond Position:  [12.55782696]


portfolio before change:  [9.23298848]
curr_Stock_Price:  117.43806803133889
curr_Factors:  [1.17438068e+02 3.18902989e-02]
mat_Sqrt:  [[ 2.09719188e+01 -7.13757130e-03]
 [-7.13757130e-03  1.63694247e-02]]
grads:  [-0.00138761 -1.19350486]
Stock Position:  -0.001387610069125007
Bond Position:  [9.39594673]


portfolio before change:  [9.25107943]
curr_Stock_Price:  112.87002017498655
curr_Factors:  [1.12870020e+02 3.47461487e-02]
mat_Sqrt:  [[ 2.10393303e+01 -7.45007754e-03]
 [-7.45007754e-03  1.70867736e-02]]
grads:  [ 0.00779363 -6.90896125]
Stock Position:  0.007793626599785858
Bond Position:  [8.37141263]


portfolio before change:  [9.24901502]
curr_Stock_Price:  111.26162712233402
curr_Factors:  [1.11261627e+02 3.68341445e-02]
mat_Sqrt:  [[ 2.13535788e+01 -7.67057031e-03]
 [-7.67057031e-03  1.75927200e-02]]
grads:  [0.00808816 5.96021184]
Stock Position:  0.008088163604147793
Bond Position:  [8.34911278]


portfolio before change:  [9.24370543]
curr_Stock_Price:  109.31402694167372
curr_Factors:  [1.09314027e+02 4.04189970e-02]
mat_Sqrt:  [[ 2.19770112e+01 -8.03505323e-03]
 [-8.03505323e-03  1.84289959e-02]]
grads:  [4.08376458e-03 4.39635839e+00]
Stock Position:  0.00408376457573725
Bond Position:  [8.79729268]


portfolio before change:  [9.25488013]
curr_Stock_Price:  109.35595057041505
curr_Factors:  [1.09355951e+02 3.34475962e-02]
mat_Sqrt:  [[ 1.99997629e+01 -7.30934712e-03]
 [-7.30934712e-03  1.67645282e-02]]
grads:  [-0.01073754  2.72903768]
Stock Position:  -0.010737537293468626
Bond Position:  [10.42909372]


portfolio before change:  [9.25154484]
curr_Stock_Price:  110.88142150946867
curr_Factors:  [1.10881422e+02 3.67507738e-02]
mat_Sqrt:  [[ 2.12565119e+01 -7.66186295e-03]
 [-7.66186295e-03  1.75728084e-02]]
grads:  [0.00329921 2.33805263]
Stock Position:  0.0032992072398024303
Bond Position:  [8.88572405]


portfolio before change:  [9.25113109]
curr_Stock_Price:  107.3872941341225
curr_Factors:  [1.07387294e+02 3.87623719e-02]
mat_Sqrt:  [[ 2.11425829e+01 -7.86854867e-03]
 [-7.86854867e-03  1.80474281e-02]]
grads:  [ 0.00216349 -1.9355209 ]
Stock Position:  0.0021634862147324988
Bond Position:  [9.01880016]


portfolio before change:  [9.26120221]
curr_Stock_Price:  106.82827428883373
curr_Factors:  [1.06828274e+02 3.99338254e-02]
mat_Sqrt:  [[ 2.13479727e+01 -7.98652733e-03]
 [-7.98652733e-03  1.83181231e-02]]
grads:  [ 4.49765294e-04 -6.67908562e+00]
Stock Position:  0.0004497652940129172
Bond Position:  [9.21315456]


portfolio before change:  [9.27130189]
curr_Stock_Price:  103.66225636552436
curr_Factors:  [1.03662256e+02 3.69318192e-02]
mat_Sqrt:  [[ 1.99214514e+01 -7.68027028e-03]
 [-7.68027028e-03  1.76162323e-02]]
grads:  [5.03227702e-04 2.44542955e+00]
Stock Position:  0.0005032277017274171
Bond Position:  [9.21913617]


portfolio before change:  [9.28307363]
curr_Stock_Price:  104.1404075224224
curr_Factors:  [1.04140408e+02 3.30294709e-02]
mat_Sqrt:  [[ 1.89264887e+01 -7.26321205e-03]
 [-7.26321205e-03  1.66595456e-02]]
grads:  [ 0.00098518 -0.77150342]
Stock Position:  0.0009851794748552054
Bond Position:  [9.18047664]


portfolio before change:  [9.29061092]
curr_Stock_Price:  100.13556443787915
curr_Factors:  [1.00135564e+02 3.40537648e-02]
mat_Sqrt:  [[ 1.84786773e+01 -7.37471440e-03]
 [-7.37471440e-03  1.69160053e-02]]
grads:  [2.37495685e-03 4.50700398e+00]
Stock Position:  0.0023749568496081305
Bond Position:  [9.05279327]


portfolio before change:  [9.29872242]
curr_Stock_Price:  98.7833016363306
curr_Factors:  [9.87833016e+01 3.61340037e-02]
mat_Sqrt:  [[ 1.87776632e+01 -7.59652978e-03]
 [-7.59652978e-03  1.74250616e-02]]
grads:  [-0.00521568 -4.54490374]
Stock Position:  -0.005215676433508973
Bond Position:  [9.81394415]


portfolio before change:  [9.29074954]
curr_Stock_Price:  102.66544034891432
curr_Factors:  [1.02665440e+02 3.19840057e-02]
mat_Sqrt:  [[ 1.83607606e+01 -7.14724806e-03]
 [-7.14724806e-03  1.63938068e-02]]
grads:  [ 0.00591767 -3.72099353]
Stock Position:  0.005917674242310521
Bond Position:  [8.68320891]


portfolio before change:  [9.31640562]
curr_Stock_Price:  105.16562660915456
curr_Factors:  [1.05165627e+02 3.73362375e-02]
mat_Sqrt:  [[ 2.03207184e+01 -7.72230434e-03]
 [-7.72230434e-03  1.77123796e-02]]
grads:  [-1.68726868e-03 -8.25614466e+00]
Stock Position:  -0.001687268678824114
Bond Position:  [9.49384829]


portfolio before change:  [9.31806757]
curr_Stock_Price:  111.21847502835043
curr_Factors:  [1.11218475e+02 2.55232891e-02]
mat_Sqrt:  [[ 1.77682734e+01 -6.38514175e-03]
 [-6.38514175e-03  1.46445504e-02]]
grads:  [-2.00977109e-03  2.67408642e+00]
Stock Position:  -0.002009771094621931
Bond Position:  [9.54159125]


portfolio before change:  [9.332454]
curr_Stock_Price:  109.99844437115763
curr_Factors:  [1.09998444e+02 1.67265574e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.332454]
Stock Price:  113.50696006805103
PL:  [-4.17450607]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.68370091e-01  4.04402713e-03]
 [ 3.21739135e-02 -3.83166583e-02]
 [ 5.59417436e-02  7.60400885e-02]
 [ 1.17142566e-02  1.75428001e-02]
 [ 4.66753190e-01  4.45900981e-02]
 [ 6.84792873e-03 -2.17162902e-01]
 [-4.75777381e-01 -4.68621061e-01]
 [ 3.48785679e-02 -4.62582392e-03]
 [-3.13900784e-01 -2.41855788e-01]
 [ 9.72222675e-02  4.66613032e-01]
 [-1.99978194e-01 -2.61701016e-03]
 [ 7.11477718e-02 -2.72381237e-01]
 [-2.21769746e-01 -9.20725310e-02]
 [-4.27880765e-03  1.53358523e-01]
 [-1.07694464e-01  1.40556654e-01]
 [-1.14742136e-01  4.71214655e-02]
 [-9.22862490e-02  1.62249883e-01]
 [ 9.96525313e-02 -1.06974526e-01]
 [ 7.83351962e-02  5.78226574e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.15315498]
curr_Stock_Price:  97.7111707686822
curr_Factors:  [9.77111708e+01 4.04739844e-02]
mat_Sqrt:  [[ 1.96576755e+01 -8.03971706e-03]
 [-8.03971706e-03  1.84418761e-02]]
grads:  [0.00865633 0.22305874]
Stock Position:  0.00865633479341587
Bond Position:  [-2.99897559]


portfolio before change:  [-2.14186801]
curr_Stock_Price:  99.44839937603066
curr_Factors:  [9.94483994e+01 4.25434872e-02]
mat_Sqrt:  [[ 2.05122974e+01 -8.24283180e-03]
 [-8.24283180e-03  1.89074217e-02]]
grads:  [ 7.54288522e-04 -2.02621179e+00]
Stock Position:  0.0007542885216208708
Bond Position:  [-2.2168808]


portfolio before change:  [-2.14728756]
curr_Stock_Price:  95.93951302108876
curr_Factors:  [9.59395130e+01 4.44039891e-02]
mat_Sqrt:  [[ 2.02166162e+01 -8.42085641e-03]
 [-8.42085641e-03  1.93165491e-02]]
grads:  [0.0044076  3.93844698]
Stock Position:  0.004407604083450478
Bond Position:  [-2.57015095]


portfolio before change:  [-2.13915618]
curr_Stock_Price:  98.51371903745462
curr_Factors:  [9.85137190e+01 4.72343776e-02]
mat_Sqrt:  [[ 2.14104491e+01 -8.68530750e-03]
 [-8.68530750e-03  1.99225804e-02]]
grads:  [0.00090449 0.88094291]
Stock Position:  0.0009044890427417259
Bond Position:  [-2.22826076]


portfolio before change:  [-2.14991406]
curr_Stock_Price:  89.70120708457517
curr_Factors:  [8.97012071e+01 5.05684884e-02]
mat_Sqrt:  [[ 2.01715017e+01 -8.98579329e-03]
 [-8.98579329e-03  2.06140826e-02]]
grads:  [0.02410751 2.17359773]
Stock Position:  0.0241075105950336
Bond Position:  [-4.31238687]


portfolio before change:  [-2.14471595]
curr_Stock_Price:  90.140570825224
curr_Factors:  [9.01405708e+01 4.88789106e-02]
mat_Sqrt:  [[ 1.99287941e+01 -8.83444676e-03]
 [-8.83444676e-03  2.02667624e-02]]
grads:  [-4.40729734e-03 -1.07171453e+01]
Stock Position:  -0.004407297336413112
Bond Position:  [-1.74743966]


portfolio before change:  [-2.12134092]
curr_Stock_Price:  84.34093917849681
curr_Factors:  [8.43409392e+01 5.40001176e-02]
mat_Sqrt:  [[ 1.95990823e+01 -9.28507921e-03]
 [-9.28507921e-03  2.13023116e-02]]
grads:  [ -0.03470451 -22.01372806]
Stock Position:  -0.03470451214370284
Bond Position:  [0.80567023]


portfolio before change:  [-1.98931806]
curr_Stock_Price:  80.56577777721411
curr_Factors:  [8.05657778e+01 5.58258972e-02]
mat_Sqrt:  [[ 1.90356805e+01 -9.44026143e-03]
 [-9.44026143e-03  2.16596499e-02]]
grads:  [ 0.00172673 -0.21281614]
Stock Position:  0.0017267324853067773
Bond Position:  [-2.12843361]


portfolio before change:  [-1.99435654]
curr_Stock_Price:  79.1896113115815
curr_Factors:  [7.91896113e+01 5.80633560e-02]
mat_Sqrt:  [[ 1.90817949e+01 -9.62739200e-03]
 [-9.62739200e-03  2.20895198e-02]]
grads:  [ -0.02197918 -10.95847226]
Stock Position:  -0.021979184577816824
Bond Position:  [-0.25383346]


portfolio before change:  [-2.0657148]
curr_Stock_Price:  82.42179537933859
curr_Factors:  [8.24217954e+01 5.54943169e-02]
mat_Sqrt:  [[ 1.94162911e+01 -9.41242516e-03]
 [-9.41242516e-03  2.15951250e-02]]
grads:  [1.54850990e-02 2.16140812e+01]
Stock Position:  0.01548509897709448
Bond Position:  [-3.34202446]


portfolio before change:  [-2.15344463]
curr_Stock_Price:  77.02630643674003
curr_Factors:  [7.70263064e+01 5.42273848e-02]
mat_Sqrt:  [[ 1.79369396e+01 -9.30363824e-03]
 [-9.30363824e-03  2.13475095e-02]]
grads:  [-0.01121508 -0.12747863]
Stock Position:  -0.011215079825724119
Bond Position:  [-1.28958845]


portfolio before change:  [-2.09050836]
curr_Stock_Price:  71.27072906195059
curr_Factors:  [7.12707291e+01 5.76388988e-02]
mat_Sqrt:  [[ 1.71107470e+01 -9.59090596e-03]
 [-9.59090596e-03  2.20091688e-02]]
grads:  [-2.77948420e-03 -1.23770188e+01]
Stock Position:  -0.002779484202799479
Bond Position:  [-1.89241249]


portfolio before change:  [-2.11287987]
curr_Stock_Price:  78.46793463705507
curr_Factors:  [7.84679346e+01 5.08257402e-02]
mat_Sqrt:  [[ 1.76902521e+01 -9.00730411e-03]
 [-9.00730411e-03  2.06670238e-02]]
grads:  [-0.01480792 -4.4614992 ]
Stock Position:  -0.014807919382340365
Bond Position:  [-0.95093302]


portfolio before change:  [-2.22563952]
curr_Stock_Price:  86.0024325482097
curr_Factors:  [8.60024325e+01 4.89621373e-02]
mat_Sqrt:  [[ 1.90300913e+01 -8.84153262e-03]
 [-8.84153262e-03  2.02841976e-02]]
grads:  [3.28848693e-03 7.56192586e+00]
Stock Position:  0.003288486926471946
Bond Position:  [-2.5084574]


portfolio before change:  [-2.231386]
curr_Stock_Price:  85.20907546862661
curr_Factors:  [8.52090755e+01 4.44767030e-02]
mat_Sqrt:  [[ 1.79701664e+01 -8.42673540e-03]
 [-8.42673540e-03  1.93328001e-02]]
grads:  [-2.58419712e-03  7.26924590e+00]
Stock Position:  -0.002584197118867242
Bond Position:  [-2.01118895]


portfolio before change:  [-2.2401307]
curr_Stock_Price:  87.61954971077009
curr_Factors:  [8.76195497e+01 4.06951026e-02]
mat_Sqrt:  [[ 1.76755137e+01 -8.06077833e-03]
 [-8.06077833e-03  1.84925628e-02]]
grads:  [-0.00533059  2.54580705]
Stock Position:  -0.005330591874387716
Bond Position:  [-1.77306664]


portfolio before change:  [-2.23470566]
curr_Stock_Price:  86.18579604732487
curr_Factors:  [8.61857960e+01 4.23125146e-02]
mat_Sqrt:  [[ 1.77284215e+01 -8.21926100e-03]
 [-8.21926100e-03  1.88565345e-02]]
grads:  [-1.21660498e-03  8.60390772e+00]
Stock Position:  -0.0012166049807483537
Bond Position:  [-2.12985159]


portfolio before change:  [-2.24020343]
curr_Stock_Price:  88.51505517610818
curr_Factors:  [8.85150552e+01 4.46547106e-02]
mat_Sqrt:  [[ 1.87046997e+01 -8.44392051e-03]
 [-8.44392051e-03  1.93713013e-02]]
grads:  [ 2.83527328e-03 -5.52108420e+00]
Stock Position:  0.0028352732827296406
Bond Position:  [-2.4911678]


portfolio before change:  [-2.245164]
curr_Stock_Price:  87.86444071962184
curr_Factors:  [8.78644407e+01 4.98043443e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.245164]
Stock Price:  86.79097191459174
PL:  [-2.245164]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.46822482e-01 -9.46383194e-03]
 [-1.76487046e-01  8.48641711e-02]
 [ 4.26340045e-02  1.15594799e-01]
 [-5.01449702e-03  8.22448911e-04]
 [-8.09522681e-02 -7.53311335e-02]
 [ 1.26746881e-01  1.06405973e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-3.13857864e-01  4.95506723e-02]
 [ 5.19550843e-02  4.09413183e-02]
 [ 6.00493989e-02 -2.71732776e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 3.07782881e-02  3.13372925e-02]
 [ 2.25816486e-02  1.05106327e-01]
 [-4.14124121e-02 -1.54084976e-01]
 [ 6.40383899e-03 -1.16808276e-01]
 [ 2.01310829e-01 -1.42190021e-01]
 [ 1.31026905e-01 -1.49129535e-01]
 [-9.06465290e-02  4.30312211e-02]
 [-1.16003406e-01 -1.35291647e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.12927037]
curr_Stock_Price:  95.57926780534265
curr_Factors:  [9.55792678e+01 4.32206367e-02]
mat_Sqrt:  [[ 1.98705204e+01 -8.30786222e-03]
 [-8.30786222e-03  1.90574340e-02]]
grads:  [ 0.00718264 -0.4934641 ]
Stock Position:  0.007182642817723953
Bond Position:  [-10.81578211]


portfolio before change:  [-10.16998682]
curr_Stock_Price:  91.7939937992485
curr_Factors:  [9.17939938e+01 4.39826789e-02]
mat_Sqrt:  [[ 1.92510784e+01 -8.38045088e-03]
 [-8.38045088e-03  1.92248493e-02]]
grads:  [-0.00724737  4.41113652]
Stock Position:  -0.007247372337763105
Bond Position:  [-9.50472157]


portfolio before change:  [-10.1844481]
curr_Stock_Price:  92.14901139848556
curr_Factors:  [9.21490114e+01 3.83625749e-02]
mat_Sqrt:  [[ 1.80486413e+01 -7.82676132e-03]
 [-7.82676132e-03  1.79545971e-02]]
grads:  [5.15504924e-03 6.44042000e+00]
Stock Position:  0.0051550492356721616
Bond Position:  [-10.65948079]


portfolio before change:  [-10.1798628]
curr_Stock_Price:  95.6248226968053
curr_Factors:  [9.56248227e+01 3.13933887e-02]
mat_Sqrt:  [[ 1.69429763e+01 -7.08048492e-03]
 [-7.08048492e-03  1.62419402e-02]]
grads:  [-0.00027485  0.05051754]
Stock Position:  -0.00027485184852495283
Bond Position:  [-10.15358014]


portfolio before change:  [-10.19408589]
curr_Stock_Price:  101.16665684383925
curr_Factors:  [1.01166657e+02 3.45823933e-02]
mat_Sqrt:  [[ 1.88132960e+01 -7.43180338e-03]
 [-7.43180338e-03  1.70467660e-02]]
grads:  [-0.00604964 -4.42172393]
Stock Position:  -0.0060496391085701675
Bond Position:  [-9.58206413]


portfolio before change:  [-10.22829382]
curr_Stock_Price:  104.84007512115592
curr_Factors:  [1.04840075e+02 3.07981262e-02]
mat_Sqrt:  [[ 1.83987975e+01 -7.01362612e-03]
 [-7.01362612e-03  1.60869609e-02]]
grads:  [0.00941185 6.61852694]
Stock Position:  0.00941185174422459
Bond Position:  [-11.21503306]


portfolio before change:  [-10.2285957]
curr_Stock_Price:  106.29841421157161
curr_Factors:  [1.06298414e+02 3.39439081e-02]
mat_Sqrt:  [[ 1.95842830e+01 -7.36319990e-03]
 [-7.36319990e-03  1.68885277e-02]]
grads:  [4.58267204e-03 4.79742236e+00]
Stock Position:  0.004582672037965769
Bond Position:  [-10.71572647]


portfolio before change:  [-10.23839111]
curr_Stock_Price:  107.08564596101621
curr_Factors:  [1.07085646e+02 3.44437907e-02]
mat_Sqrt:  [[ 1.98740648e+01 -7.41726662e-03]
 [-7.41726662e-03  1.70124091e-02]]
grads:  [-0.0147077   2.90620694]
Stock Position:  -0.014707698468500957
Bond Position:  [-8.66340772]


portfolio before change:  [-10.31115305]
curr_Stock_Price:  111.29608769730966
curr_Factors:  [1.11296088e+02 3.37996345e-02]
mat_Sqrt:  [[ 2.04614248e+01 -7.34781942e-03]
 [-7.34781942e-03  1.68524745e-02]]
grads:  [0.00341212 2.43088278]
Stock Position:  0.0034121168262890977
Bond Position:  [-10.6909083]


portfolio before change:  [-10.32920833]
curr_Stock_Price:  109.92354007071711
curr_Factors:  [1.09923540e+02 3.16455345e-02]
mat_Sqrt:  [[ 1.95545081e+01 -7.10974832e-03]
 [-7.10974832e-03  1.63066497e-02]]
grads:  [ 0.00246539 -1.66531751]
Stock Position:  0.0024653860045202192
Bond Position:  [-10.60021229]


portfolio before change:  [-10.34181203]
curr_Stock_Price:  110.1891590408853
curr_Factors:  [1.10189159e+02 3.29684953e-02]
mat_Sqrt:  [[ 2.00072963e+01 -7.25685499e-03]
 [-7.25685499e-03  1.66440082e-02]]
grads:  [ 4.79818413e-04 -7.35089898e+00]
Stock Position:  0.0004798184130842756
Bond Position:  [-10.39468282]


portfolio before change:  [-10.35597428]
curr_Stock_Price:  107.76996017167058
curr_Factors:  [1.07769960e+02 3.53294756e-02]
mat_Sqrt:  [[ 2.02565877e+01 -7.51206564e-03]
 [-7.51206564e-03  1.72297309e-02]]
grads:  [0.00219427 1.81974845]
Stock Position:  0.002194266801033398
Bond Position:  [-10.59245033]


portfolio before change:  [-10.35686971]
curr_Stock_Price:  113.39981952050604
curr_Factors:  [1.1339982e+02 3.3703787e-02]
mat_Sqrt:  [[ 2.08186080e+01 -7.33750573e-03]
 [-7.33750573e-03  1.68285139e-02]]
grads:  [3.28649404e-03 6.24716137e+00]
Stock Position:  0.0032864940376361716
Bond Position:  [-10.72955754]


portfolio before change:  [-10.35466841]
curr_Stock_Price:  118.15310143037647
curr_Factors:  [1.18153101e+02 3.21467145e-02]
mat_Sqrt:  [[ 2.11842649e+01 -7.16624267e-03]
 [-7.16624267e-03  1.64350878e-02]]
grads:  [-5.12713502e-03 -9.37760235e+00]
Stock Position:  -0.005127135018795456
Bond Position:  [-9.74888151]


portfolio before change:  [-10.36294301]
curr_Stock_Price:  117.38871220644934
curr_Factors:  [1.17388712e+02 3.76745341e-02]
mat_Sqrt:  [[ 2.27850643e+01 -7.75791412e-03]
 [-7.75791412e-03  1.77921362e-02]]
grads:  [-1.95455864e-03 -6.56601537e+00]
Stock Position:  -0.0019545586413230133
Bond Position:  [-10.13349989]


portfolio before change:  [-10.3755204]
curr_Stock_Price:  117.33887804133614
curr_Factors:  [1.17338878e+02 3.71870011e-02]
mat_Sqrt:  [[ 2.26275475e+01 -7.70755187e-03]
 [-7.70755187e-03  1.76766415e-02]]
grads:  [ 6.15764306e-03 -8.04126512e+00]
Stock Position:  0.006157643056750944
Bond Position:  [-11.09805133]


portfolio before change:  [-10.36996142]
curr_Stock_Price:  120.49596554233284
curr_Factors:  [1.20495966e+02 4.21287042e-02]
mat_Sqrt:  [[ 2.47321307e+01 -8.20387078e-03]
 [-8.20387078e-03  1.88144505e-02]]
grads:  [ 2.66899239e-03 -7.92516577e+00]
Stock Position:  0.002668992394341756
Bond Position:  [-10.69156423]


portfolio before change:  [-10.39246587]
curr_Stock_Price:  117.07458401146705
curr_Factors:  [1.17074584e+02 3.61237806e-02]
mat_Sqrt:  [[ 2.22514950e+01 -7.59655542e-03]
 [-7.59655542e-03  1.74221167e-02]]
grads:  [-0.00323099  2.46851042]
Stock Position:  -0.003230989766318997
Bond Position:  [-10.01419909]


portfolio before change:  [-10.42490594]
curr_Stock_Price:  123.23817330814578
curr_Factors:  [1.23238173e+02 3.47841969e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.42490594]
Stock Price:  118.85701453557878
PL:  [-29.28192048]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 8.98186834e-03 -5.45587402e-02]
 [ 1.56198051e-02  3.44212613e-02]
 [ 7.04693445e-02  9.12497410e-03]
 [ 2.12830896e-02  1.59009879e-02]
 [-1.33458791e-01  7.37078823e-03]
 [ 7.27386273e-02  2.28064254e-03]
 [-1.27984651e-01 -1.63080033e-01]
 [ 3.20759369e-02 -1.67900953e-02]
 [-5.46627230e-02 -4.76325748e-02]
 [ 5.20559671e-02  2.72896809e-01]
 [ 4.80112646e-02 -9.55189447e-02]
 [ 3.51625470e-02 -1.35495290e-01]
 [-1.80868169e-01 -1.10847019e-01]
 [ 2.50650395e-03  1.44368156e-01]
 [-1.07757551e-01  1.40063674e-01]
 [-1.80003431e-01  8.18092682e-02]
 [-1.02156838e-01  1.93322947e-01]
 [ 9.61779080e-02 -1.12750503e-01]
 [ 9.54585068e-02  5.82492417e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.02030681]
curr_Stock_Price:  99.62853576605647
curr_Factors:  [9.96285358e+01 4.04614952e-02]
mat_Sqrt:  [[ 2.00403211e+01 -8.03862153e-03]
 [-8.03862153e-03  1.84389673e-02]]
grads:  [-7.38813437e-04 -2.95920473e+00]
Stock Position:  -0.0007388134365014922
Bond Position:  [5.09391371]


portfolio before change:  [5.02840277]
curr_Stock_Price:  97.29426762447183
curr_Factors:  [9.72942676e+01 4.24822533e-02]
mat_Sqrt:  [[ 2.00535372e+01 -8.23672967e-03]
 [-8.23672967e-03  1.88938831e-02]]
grads:  [1.52746777e-03 1.82248628e+00]
Stock Position:  0.0015274677736722994
Bond Position:  [4.87978891]


portfolio before change:  [5.03866203]
curr_Stock_Price:  100.01492215767472
curr_Factors:  [1.00014922e+02 3.92661659e-02]
mat_Sqrt:  [[ 1.98186476e+01 -7.91901944e-03]
 [-7.91901944e-03  1.81645476e-02]]
grads:  [0.00375709 0.50398869]
Stock Position:  0.003757089906892494
Bond Position:  [4.66289698]


portfolio before change:  [5.02933748]
curr_Stock_Price:  95.9807305184421
curr_Factors:  [9.59807305e+01 4.21360746e-02]
mat_Sqrt:  [[ 1.97020334e+01 -8.20299569e-03]
 [-8.20299569e-03  1.88167906e-02]]
grads:  [0.00143234 0.84566693]
Stock Position:  0.001432344121842783
Bond Position:  [4.89186004]


portfolio before change:  [5.03368558]
curr_Stock_Price:  94.74461023358559
curr_Factors:  [9.47446102e+01 4.04634752e-02]
mat_Sqrt:  [[ 1.90583836e+01 -8.03843731e-03]
 [-8.03843731e-03  1.84395845e-02]]
grads:  [-0.00683529  0.39674664]
Stock Position:  -0.006835289439322195
Bond Position:  [5.68129241]


portfolio before change:  [5.03744771]
curr_Stock_Price:  95.23382432978303
curr_Factors:  [9.52338243e+01 3.75092829e-02]
mat_Sqrt:  [[ 1.84442316e+01 -7.73947633e-03]
 [-7.73947633e-03  1.77536851e-02]]
grads:  [0.00399834 0.13020326]
Stock Position:  0.003998341263757127
Bond Position:  [4.65667038]


portfolio before change:  [5.03349477]
curr_Stock_Price:  92.78845611013232
curr_Factors:  [9.27884561e+01 3.59965486e-02]
mat_Sqrt:  [[ 1.76045261e+01 -7.58161315e-03]
 [-7.58161315e-03  1.73920852e-02]]
grads:  [-0.0113103  -9.38161131]
Stock Position:  -0.01131029582205933
Bond Position:  [6.08295966]


portfolio before change:  [5.04810965]
curr_Stock_Price:  92.1689830061361
curr_Factors:  [9.2168983e+01 3.8991436e-02]
mat_Sqrt:  [[ 1.81999154e+01 -7.89065261e-03]
 [-7.89065261e-03  1.81011591e-02]]
grads:  [ 0.00136053 -0.92697709]
Stock Position:  0.0013605273518691445
Bond Position:  [4.92271123]


portfolio before change:  [5.05531681]
curr_Stock_Price:  92.94068602140868
curr_Factors:  [9.29406860e+01 3.94920671e-02]
mat_Sqrt:  [[ 1.84697394e+01 -7.94121264e-03]
 [-7.94121264e-03  1.82169650e-02]]
grads:  [-0.00408458 -2.6165177 ]
Stock Position:  -0.004084575580661515
Bond Position:  [5.43494007]


portfolio before change:  [5.0720637]
curr_Stock_Price:  90.504946926189
curr_Factors:  [9.05049469e+01 4.07999593e-02]
mat_Sqrt:  [[ 1.82810923e+01 -8.07142546e-03]
 [-8.07142546e-03  1.85162546e-02]]
grads:  [9.35652011e-03 1.47423080e+01]
Stock Position:  0.009356520112278922
Bond Position:  [4.22525234]


portfolio before change:  [5.03418519]
curr_Stock_Price:  85.89175995112022
curr_Factors:  [8.58917600e+01 4.44968496e-02]
mat_Sqrt:  [[ 1.81182433e+01 -8.42871571e-03]
 [-8.42871571e-03  1.93371468e-02]]
grads:  [ 3.51996702e-04 -4.93950729e+00]
Stock Position:  0.00035199670157876696
Bond Position:  [5.00395157]


portfolio before change:  [5.0391753]
curr_Stock_Price:  82.28736620103626
curr_Factors:  [8.22873662e+01 4.80411655e-02]
mat_Sqrt:  [[ 1.80359855e+01 -8.75756280e-03]
 [-8.75756280e-03  2.00927039e-02]]
grads:  [-1.32508408e-03 -6.74408457e+00]
Stock Position:  -0.0013250840758890132
Bond Position:  [5.14821298]


portfolio before change:  [5.0431265]
curr_Stock_Price:  84.16505605443291
curr_Factors:  [8.41650561e+01 5.36222662e-02]
mat_Sqrt:  [[ 1.94896639e+01 -9.25251626e-03]
 [-9.25251626e-03  2.12276613e-02]]
grads:  [-0.01176165 -5.22694622]
Stock Position:  -0.011761648380232154
Bond Position:  [6.03304629]


portfolio before change:  [5.09428546]
curr_Stock_Price:  80.45699207991935
curr_Factors:  [8.04569921e+01 5.66282619e-02]
mat_Sqrt:  [[ 1.91461014e+01 -9.50784547e-03]
 [-9.50784547e-03  2.18147540e-02]]
grads:  [3.41807274e-03 6.61940326e+00]
Stock Position:  0.003418072739733378
Bond Position:  [4.81927761]


portfolio before change:  [5.11665779]
curr_Stock_Price:  85.23876864792474
curr_Factors:  [8.52387686e+01 4.83881924e-02]
mat_Sqrt:  [[ 1.87502395e+01 -8.78947482e-03]
 [-8.78947482e-03  2.01649958e-02]]
grads:  [-2.49151191e-03  6.94479561e+00]
Stock Position:  -0.002491511914302759
Bond Position:  [5.32903119]


portfolio before change:  [5.12813816]
curr_Stock_Price:  83.30624164076893
curr_Factors:  [8.33062416e+01 5.03050565e-02]
mat_Sqrt:  [[ 1.86845788e+01 -8.96165507e-03]
 [-8.96165507e-03  2.05606251e-02]]
grads:  [-0.007727    3.97556111]
Stock Position:  -0.0077270044442344825
Bond Position:  [5.77184585]


portfolio before change:  [5.13001657]
curr_Stock_Price:  83.99744142733455
curr_Factors:  [8.39974414e+01 5.12624100e-02]
mat_Sqrt:  [[ 1.90180296e+01 -9.04660945e-03]
 [-9.04660945e-03  2.07553115e-02]]
grads:  [-9.41051880e-04  9.31397408e+00]
Stock Position:  -0.0009410518799109573
Bond Position:  [5.20906252]


portfolio before change:  [5.13281268]
curr_Stock_Price:  87.94970462193349
curr_Factors:  [8.79497046e+01 4.66729981e-02]
mat_Sqrt:  [[ 1.90005945e+01 -8.63257694e-03]
 [-8.63257694e-03  1.98042570e-02]]
grads:  [ 2.47570366e-03 -5.69216664e+00]
Stock Position:  0.002475703664690514
Bond Position:  [4.91507528]


portfolio before change:  [5.14178879]
curr_Stock_Price:  89.09217613956072
curr_Factors:  [8.90921761e+01 4.39808455e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.14178879]
Stock Price:  88.25774460929513
PL:  [5.14178879]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.65632815e-01  1.62345878e-03]
 [-2.13124821e-02  6.21548233e-02]
 [ 5.90782165e-02  6.67181325e-02]
 [-1.48607395e-02 -4.45360120e-03]
 [-1.81481134e-01 -4.69998170e-02]
 [ 1.29040968e-01  1.29686479e-01]
 [ 1.59075879e-02  3.04336101e-02]
 [ 3.59962163e-02  7.17969294e-02]
 [ 5.16702815e-02  4.01806571e-02]
 [ 6.50652681e-02 -4.50702570e-02]
 [ 6.80595563e-02 -1.31479067e-01]
 [-8.26282084e-03  4.63705775e-02]
 [ 3.46351382e-02  4.02285257e-02]
 [ 7.94948304e-03 -1.30906351e-01]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.36240623e-01 -6.22629704e-02]
 [ 7.38384511e-02 -1.49900053e-01]
 [-4.67014591e-02  3.85282893e-02]
 [-9.92362165e-02 -1.01525810e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.83039873]
curr_Stock_Price:  98.06472482908295
curr_Factors:  [9.80647248e+01 4.02630593e-02]
mat_Sqrt:  [[ 1.96773297e+01 -8.01876779e-03]
 [-8.01876779e-03  1.83937477e-02]]
grads:  [0.00845491 0.09194737]
Stock Position:  0.008454913454343084
Bond Position:  [-1.65952749]


portfolio before change:  [-0.84951959]
curr_Stock_Price:  96.04871878302095
curr_Factors:  [9.60487188e+01 3.87656002e-02]
mat_Sqrt:  [[ 1.89110131e+01 -7.86808414e-03]
 [-7.86808414e-03  1.80485250e-02]]
grads:  [3.05873393e-04 3.44389528e+00]
Stock Position:  0.00030587339259983954
Bond Position:  [-0.87889834]


portfolio before change:  [-0.85037904]
curr_Stock_Price:  96.83291267607542
curr_Factors:  [9.68329127e+01 3.85909025e-02]
mat_Sqrt:  [[ 1.90224051e+01 -7.85039593e-03]
 [-7.85039593e-03  1.80077847e-02]]
grads:  [0.00463556 3.70698144]
Stock Position:  0.00463555938585639
Bond Position:  [-1.29925375]


portfolio before change:  [-0.83580371]
curr_Stock_Price:  100.32772408738222
curr_Factors:  [1.00327724e+02 3.45541471e-02]
mat_Sqrt:  [[ 1.86496641e+01 -7.42871145e-03]
 [-7.42871145e-03  1.70398274e-02]]
grads:  [-0.0009011  -0.26175707]
Stock Position:  -0.0009011024073746684
Bond Position:  [-0.74539816]


portfolio before change:  [-0.83605609]
curr_Stock_Price:  99.57313904144644
curr_Factors:  [9.95731390e+01 3.32032796e-02]
mat_Sqrt:  [[ 1.81439840e+01 -7.28200357e-03]
 [-7.28200357e-03  1.67034493e-02]]
grads:  [-0.01113352 -2.81863287]
Stock Position:  -0.01113352107627489
Bond Position:  [0.27254356]


portfolio before change:  [-0.83286598]
curr_Stock_Price:  99.31722633156933
curr_Factors:  [9.93172263e+01 3.20456842e-02]
mat_Sqrt:  [[ 1.77790815e+01 -7.15392103e-03]
 [-7.15392103e-03  1.64097001e-02]]
grads:  [0.01043987 7.90758908]
Stock Position:  0.010439866362620691
Bond Position:  [-1.86972455]


portfolio before change:  [-0.85202032]
curr_Stock_Price:  97.70650448467087
curr_Factors:  [9.77065045e+01 3.57443312e-02]
mat_Sqrt:  [[ 1.84725575e+01 -7.55538071e-03]
 [-7.55538071e-03  1.73308838e-02]]
grads:  [1.57965627e-03 1.75672200e+00]
Stock Position:  0.0015796562734518753
Bond Position:  [-1.00636301]


portfolio before change:  [-0.85303902]
curr_Stock_Price:  97.8584607619492
curr_Factors:  [9.78584608e+01 3.41380084e-02]
mat_Sqrt:  [[ 1.80807914e+01 -7.38367356e-03]
 [-7.38367356e-03  1.69369846e-02]]
grads:  [3.72262743e-03 4.24068496e+00]
Stock Position:  0.0037226274253867784
Bond Position:  [-1.21732961]


portfolio before change:  [-0.84956126]
curr_Stock_Price:  99.20169810299028
curr_Factors:  [9.92016981e+01 3.16114773e-02]
mat_Sqrt:  [[ 1.76376803e+01 -7.10528164e-03]
 [-7.10528164e-03  1.62981516e-02]]
grads:  [0.00392339 2.46706098]
Stock Position:  0.003923386929527596
Bond Position:  [-1.23876791]


portfolio before change:  [-0.84635639]
curr_Stock_Price:  100.41348348379823
curr_Factors:  [1.00413483e+02 3.57605512e-02]
mat_Sqrt:  [[ 1.89886505e+01 -7.55728571e-03]
 [-7.55728571e-03  1.73347323e-02]]
grads:  [ 2.39217775e-03 -2.59895439e+00]
Stock Position:  0.0023921777511677444
Bond Position:  [-1.08656329]


portfolio before change:  [-0.84429185]
curr_Stock_Price:  101.84464409625515
curr_Factors:  [1.01844644e+02 3.56798220e-02]
mat_Sqrt:  [[ 1.92375385e+01 -7.54884738e-03]
 [-7.54884738e-03  1.73151126e-02]]
grads:  [ 5.58316433e-04 -7.59306945e+00]
Stock Position:  0.0005583164332593812
Bond Position:  [-0.90115339]


portfolio before change:  [-0.84361947]
curr_Stock_Price:  105.06777904800421
curr_Factors:  [1.05067779e+02 3.55203943e-02]
mat_Sqrt:  [[ 1.98019705e+01 -7.53217108e-03]
 [-7.53217108e-03  1.72762942e-02]]
grads:  [6.03775604e-04 2.68432134e+00]
Stock Position:  0.0006037756038303852
Bond Position:  [-0.90705683]


portfolio before change:  [-0.84358302]
curr_Stock_Price:  107.00720848877876
curr_Factors:  [1.07007208e+02 3.80424520e-02]
mat_Sqrt:  [[ 2.08711921e+01 -7.79511270e-03]
 [-7.79511270e-03  1.78790586e-02]]
grads:  [0.00250024 2.25112609]
Stock Position:  0.002500236667998003
Bond Position:  [-1.11112636]


portfolio before change:  [-0.84375597]
curr_Stock_Price:  107.49389369972128
curr_Factors:  [1.07493894e+02 3.99969076e-02]
mat_Sqrt:  [[ 2.14979462e+01 -7.99287531e-03]
 [-7.99287531e-03  1.83325672e-02]]
grads:  [-2.28546321e-03 -7.14164126e+00]
Stock Position:  -0.002285463207194092
Bond Position:  [-0.59808263]


portfolio before change:  [-0.84745436]
curr_Stock_Price:  108.78480289068102
curr_Factors:  [1.08784803e+02 4.17252631e-02]
mat_Sqrt:  [[ 2.22212119e+01 -8.16382644e-03]
 [-8.16382644e-03  1.87244377e-02]]
grads:  [-3.84527346e-03 -4.65402404e+00]
Stock Position:  -0.0038452734556778654
Bond Position:  [-0.42914705]


portfolio before change:  [-0.84178865]
curr_Stock_Price:  107.17178925007141
curr_Factors:  [1.07171789e+02 4.04169394e-02]
mat_Sqrt:  [[ 2.15457771e+01 -8.03471414e-03]
 [-8.03471414e-03  1.84285855e-02]]
grads:  [ 0.0050642  -3.37640027]
Stock Position:  0.005064204072903871
Bond Position:  [-1.38452847]


portfolio before change:  [-0.81942795]
curr_Stock_Price:  111.92918978320716
curr_Factors:  [1.11929190e+02 3.77450051e-02]
mat_Sqrt:  [[ 2.17456842e+01 -7.76487087e-03]
 [-7.76487087e-03  1.78088975e-02]]
grads:  [ 3.90042276e-04 -8.41697384e+00]
Stock Position:  0.00039004227550206545
Bond Position:  [-0.86308507]


portfolio before change:  [-0.82116041]
curr_Stock_Price:  110.25518162260641
curr_Factors:  [1.10255182e+02 4.25645988e-02]
mat_Sqrt:  [[ 2.27469542e+01 -8.24562102e-03]
 [-8.24562102e-03  1.89117879e-02]]
grads:  [-1.31479958e-03  2.03668993e+00]
Stock Position:  -0.001314799582443026
Bond Position:  [-0.67619695]


portfolio before change:  [-0.83052381]
curr_Stock_Price:  116.73344964532569
curr_Factors:  [1.16733450e+02 3.84267075e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.83052381]
Stock Price:  116.602839938113
PL:  [-17.43336375]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-4.73726695e-02 -7.74475626e-02]
 [ 4.44381675e-02 -6.31705358e-03]
 [ 4.57273261e-02  1.06400955e-01]
 [-4.18559842e-01 -2.18752510e-01]
 [-5.88412680e-02  1.16540019e-02]
 [ 5.92779756e-02 -2.95957988e-02]
 [-6.96843533e-02 -8.46730536e-02]
 [ 3.18438395e-02 -1.77974689e-02]
 [-3.64514602e-03 -7.93806138e-03]
 [ 3.88348286e-02  1.30945357e-01]
 [ 5.87505579e-02 -1.10830996e-01]
 [-8.02030114e-03  1.99312997e-02]
 [-1.06024302e-01 -1.40330077e-01]
 [ 4.22635798e-03  1.64543123e-01]
 [-6.77765253e-02 -6.72550546e-02]
 [ 5.67637225e-02 -3.86105953e-02]
 [-2.64558265e-02 -8.83956416e-03]
 [ 1.09692932e-01 -3.84751495e-02]
 [ 1.26667043e-01  7.07555263e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.79071128]
curr_Stock_Price:  100.36902574394233
curr_Factors:  [1.00369026e+02 4.25933552e-02]
mat_Sqrt:  [[ 2.07143161e+01 -8.24773103e-03]
 [-8.24773103e-03  1.89184694e-02]]
grads:  [-3.91762579e-03 -4.09546208e+00]
Stock Position:  -0.003917625794757326
Bond Position:  [8.18391957]


portfolio before change:  [7.8081941]
curr_Stock_Price:  98.51930252821309
curr_Factors:  [9.85193025e+01 3.43770009e-02]
mat_Sqrt:  [[ 1.82664977e+01 -7.40952071e-03]
 [-7.40952071e-03  1.69961470e-02]]
grads:  [ 0.00228241 -0.3706806 ]
Stock Position:  0.00228240808226295
Bond Position:  [7.58333285]


portfolio before change:  [7.80515063]
curr_Stock_Price:  93.03011423261083
curr_Factors:  [9.30301142e+01 3.42655559e-02]
mat_Sqrt:  [[ 1.72207636e+01 -7.39709496e-03]
 [-7.39709496e-03  1.69687520e-02]]
grads:  [5.34978377e-03 6.27273757e+00]
Stock Position:  0.005349783765736269
Bond Position:  [7.30745963]


portfolio before change:  [7.80431882]
curr_Stock_Price:  91.16614333142856
curr_Factors:  [9.11661433e+01 3.40087729e-02]
mat_Sqrt:  [[ 1.68123732e+01 -7.36917794e-03]
 [-7.36917794e-03  1.69051160e-02]]
grads:  [ -0.03057363 -12.95334577]
Stock Position:  -0.030573634388126773
Bond Position:  [10.59159916]


portfolio before change:  [7.72649207]
curr_Stock_Price:  94.14500164457269
curr_Factors:  [9.41450016e+01 2.96854706e-02]
mat_Sqrt:  [[ 1.62206853e+01 -6.88508546e-03]
 [-6.88508546e-03  1.57939958e-02]]
grads:  [-0.00331496  0.73643037]
Stock Position:  -0.0033149574853726226
Bond Position:  [8.03857875]


portfolio before change:  [7.73596122]
curr_Stock_Price:  94.32158266542798
curr_Factors:  [9.43215827e+01 2.81319804e-02]
mat_Sqrt:  [[ 1.58201717e+01 -6.70252295e-03]
 [-6.70252295e-03  1.53751745e-02]]
grads:  [ 0.002932   -1.92363001]
Stock Position:  0.002932003659335057
Bond Position:  [7.45941]


portfolio before change:  [7.74665309]
curr_Stock_Price:  94.78603483784316
curr_Factors:  [9.47860348e+01 2.65402182e-02]
mat_Sqrt:  [[ 1.54417516e+01 -6.51017207e-03]
 [-6.51017207e-03  1.49338488e-02]]
grads:  [-0.00690439 -5.67288468]
Stock Position:  -0.006904385694799226
Bond Position:  [8.40109243]


portfolio before change:  [7.75975722]
curr_Stock_Price:  94.41001294444561
curr_Factors:  [9.44100129e+01 2.10953549e-02]
mat_Sqrt:  [[ 1.37123357e+01 -5.80406102e-03]
 [-5.80406102e-03  1.33141438e-02]]
grads:  [ 0.0017568  -1.33596818]
Stock Position:  0.00175679761974804
Bond Position:  [7.59389794]


portfolio before change:  [7.77219744]
curr_Stock_Price:  96.08459947019898
curr_Factors:  [9.60845995e+01 2.33452360e-02]
mat_Sqrt:  [[ 1.46809068e+01 -6.10583449e-03]
 [-6.10583449e-03  1.40061110e-02]]
grads:  [-4.84095370e-04 -5.66968033e-01]
Stock Position:  -0.00048409536976932755
Bond Position:  [7.81871155]


portfolio before change:  [7.78264916]
curr_Stock_Price:  94.695983295977
curr_Factors:  [9.46959833e+01 2.37963683e-02]
mat_Sqrt:  [[ 1.46078688e+01 -6.16446179e-03]
 [-6.16446179e-03  1.41408307e-02]]
grads:  [6.56741551e-03 9.26295234e+00]
Stock Position:  0.006567415513114569
Bond Position:  [7.16074129]


portfolio before change:  [7.79100042]
curr_Stock_Price:  94.60382150213397
curr_Factors:  [9.46038215e+01 2.23943912e-02]
mat_Sqrt:  [[ 1.41572295e+01 -5.98010824e-03]
 [-5.98010824e-03  1.37179524e-02]]
grads:  [ 7.37262206e-04 -8.07894535e+00]
Stock Position:  0.0007372622055377187
Bond Position:  [7.7212526]


portfolio before change:  [7.80096838]
curr_Stock_Price:  95.02478451067482
curr_Factors:  [9.50247845e+01 2.34898952e-02]
mat_Sqrt:  [[ 1.45638902e+01 -6.12465764e-03]
 [-6.12465764e-03  1.40494669e-02]]
grads:  [4.59064976e-05 1.41867168e+00]
Stock Position:  4.590649755169952e-05
Bond Position:  [7.79660613]


portfolio before change:  [7.8107045]
curr_Stock_Price:  94.68212396322997
curr_Factors:  [9.46821240e+01 2.64999588e-02]
mat_Sqrt:  [[ 1.54131197e+01 -6.50522559e-03]
 [-6.50522559e-03  1.49225208e-02]]
grads:  [-0.01084982 -9.40864208]
Stock Position:  -0.010849824304749456
Bond Position:  [8.83798891]


portfolio before change:  [7.8222512]
curr_Stock_Price:  94.63674942461381
curr_Factors:  [9.46367494e+01 2.80664483e-02]
mat_Sqrt:  [[ 1.58545348e+01 -6.69473344e-03]
 [-6.69473344e-03  1.53572467e-02]]
grads:  [4.79169843e-03 1.07164523e+01]
Stock Position:  0.0047916984284962294
Bond Position:  [7.36878044]


portfolio before change:  [7.84639062]
curr_Stock_Price:  97.75102704257297
curr_Factors:  [9.77510270e+01 2.77448653e-02]
mat_Sqrt:  [[ 1.62821819e+01 -6.65647433e-03]
 [-6.65647433e-03  1.52689228e-02]]
grads:  [-0.00596441 -4.40730217]
Stock Position:  -0.00596441062827848
Bond Position:  [8.42941788]


portfolio before change:  [7.86196486]
curr_Stock_Price:  96.9075433669416
curr_Factors:  [9.69075434e+01 2.51962383e-02]
mat_Sqrt:  [[ 1.53824461e+01 -6.34332938e-03]
 [-6.34332938e-03  1.45507579e-02]]
grads:  [ 2.59638866e-03 -2.65237906e+00]
Stock Position:  0.0025963886575085904
Bond Position:  [7.61035521]


portfolio before change:  [7.86947059]
curr_Stock_Price:  96.13217235172154
curr_Factors:  [9.61321724e+01 2.72642236e-02]
mat_Sqrt:  [[ 1.58732292e+01 -6.59846118e-03]
 [-6.59846118e-03  1.51361338e-02]]
grads:  [-0.00190981 -0.58483666]
Stock Position:  -0.0019098097919339379
Bond Position:  [8.05306475]


portfolio before change:  [7.882114]
curr_Stock_Price:  94.78607477469617
curr_Factors:  [9.47860748e+01 3.01229671e-02]
mat_Sqrt:  [[ 1.64510406e+01 -6.93568079e-03]
 [-6.93568079e-03  1.59099341e-02]]
grads:  [ 0.00564933 -2.41584706]
Stock Position:  0.005649331894148233
Bond Position:  [7.34663601]


portfolio before change:  [7.88571948]
curr_Stock_Price:  93.7977181153533
curr_Factors:  [9.37977181e+01 3.27394572e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.88571948]
Stock Price:  88.37806521836127
PL:  [7.88571948]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 8.31850323e-02 -2.73552744e-02]
 [ 2.33027724e-02 -6.37970969e-02]
 [-2.78989510e-02 -2.28696345e-01]
 [-2.42915297e-02 -2.96094628e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [ 4.35172972e-02 -5.59788684e-02]
 [ 4.84880784e-02  3.93521559e-02]
 [ 7.36432011e-02 -5.39048945e-02]
 [ 8.25313594e-02 -1.19229978e-01]
 [ 5.77821764e-01 -4.58630977e-02]
 [ 2.31403627e-02  1.89000418e-01]
 [-5.91978654e-02 -1.23404899e-01]
 [ 3.01709040e-02 -1.29264430e-01]
 [ 2.09255945e-01 -1.51949168e-01]
 [ 9.17397227e-02 -1.48052941e-01]
 [-4.49887530e-02  3.83414105e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.10289254]
curr_Stock_Price:  98.84875214713657
curr_Factors:  [9.88487521e+01 3.87217283e-02]
mat_Sqrt:  [[ 1.94512951e+01 -7.86384303e-03]
 [-7.86384303e-03  1.80382165e-02]]
grads:  [ 0.00366412 -1.51492029]
Stock Position:  0.003664122959829306
Bond Position:  [1.74069856]


portfolio before change:  [2.11099455]
curr_Stock_Price:  100.4657206301983
curr_Factors:  [1.00465721e+02 3.75407118e-02]
mat_Sqrt:  [[ 1.94656594e+01 -7.74310586e-03]
 [-7.74310586e-03  1.77609524e-02]]
grads:  [-2.31748622e-04 -3.59208729e+00]
Stock Position:  -0.00023174862161759395
Bond Position:  [2.13427734]


portfolio before change:  [2.11266629]
curr_Stock_Price:  104.77111538474149
curr_Factors:  [1.04771115e+02 4.05583591e-02]
mat_Sqrt:  [[ 2.10999645e+01 -8.04860108e-03]
 [-8.04860108e-03  1.84608670e-02]]
grads:  [-6.04871201e-03 -1.23908064e+01]
Stock Position:  -0.0060487120116694566
Bond Position:  [2.7463966]


portfolio before change:  [2.1124981]
curr_Stock_Price:  105.36683536373755
curr_Factors:  [1.05366835e+02 4.53070766e-02]
mat_Sqrt:  [[ 2.24278129e+01 -8.50678352e-03]
 [-8.50678352e-03  1.95116734e-02]]
grads:  [-0.00165896 -1.51824883]
Stock Position:  -0.0016589644255552136
Bond Position:  [2.28729793]


portfolio before change:  [2.11389857]
curr_Stock_Price:  106.24716547224018
curr_Factors:  [1.06247165e+02 3.75044229e-02]
mat_Sqrt:  [[ 2.05758870e+01 -7.73974642e-03]
 [-7.73974642e-03  1.77521986e-02]]
grads:  [ 0.00796939 -6.64978133]
Stock Position:  0.007969394497465669
Bond Position:  [1.267173]


portfolio before change:  [2.1439898]
curr_Stock_Price:  109.82413388191566
curr_Factors:  [1.09824134e+02 3.51874656e-02]
mat_Sqrt:  [[ 2.06011637e+01 -7.49707190e-03]
 [-7.49707190e-03  1.71950158e-02]]
grads:  [0.00839622 6.1804833 ]
Stock Position:  0.008396219679586212
Bond Position:  [1.22188225]


portfolio before change:  [2.17658292]
curr_Stock_Price:  113.52399051844193
curr_Factors:  [1.13523991e+02 3.74374345e-02]
mat_Sqrt:  [[ 2.19654782e+01 -7.73325847e-03]
 [-7.73325847e-03  1.77361512e-02]]
grads:  [4.08594412e-03 4.56802912e+00]
Stock Position:  0.004085944119528027
Bond Position:  [1.71273024]


portfolio before change:  [2.19438154]
curr_Stock_Price:  117.35575363938844
curr_Factors:  [1.17355754e+02 3.79192457e-02]
mat_Sqrt:  [[ 2.28525257e+01 -7.78306704e-03]
 [-7.78306704e-03  1.78498270e-02]]
grads:  [ 8.36303509e-04 -3.13573680e+00]
Stock Position:  0.0008363035085498568
Bond Position:  [2.09623651]


portfolio before change:  [2.19656521]
curr_Stock_Price:  116.83170512316647
curr_Factors:  [1.16831705e+02 3.70468494e-02]
mat_Sqrt:  [[ 2.24872491e+01 -7.69298785e-03]
 [-7.69298785e-03  1.76433113e-02]]
grads:  [0.00291972 2.23170224]
Stock Position:  0.002919722925709358
Bond Position:  [1.855449]


portfolio before change:  [2.20393094]
curr_Stock_Price:  118.559597216471
curr_Factors:  [1.18559597e+02 3.64068638e-02]
mat_Sqrt:  [[ 2.26218608e+01 -7.62633719e-03]
 [-7.62633719e-03  1.74902150e-02]]
grads:  [ 2.21671325e-03 -3.08103641e+00]
Stock Position:  0.0022167132519731124
Bond Position:  [1.94111831]


portfolio before change:  [2.20814018]
curr_Stock_Price:  119.36318481180331
curr_Factors:  [1.19363185e+02 3.63148946e-02]
mat_Sqrt:  [[ 2.27464050e+01 -7.61673807e-03]
 [-7.61673807e-03  1.74680922e-02]]
grads:  [ 1.34294248e-03 -6.82500111e+00]
Stock Position:  0.0013429424796831712
Bond Position:  [2.04784228]


portfolio before change:  [2.22167713]
curr_Stock_Price:  127.53594636631946
curr_Factors:  [1.27535946e+02 3.20007444e-02]
mat_Sqrt:  [[ 2.28145879e+01 -7.15036192e-03]
 [-7.15036192e-03  1.63975537e-02]]
grads:  [ 0.0244536  -2.78628424]
Stock Position:  0.024453600760536907
Bond Position:  [-0.89703599]


portfolio before change:  [2.07631354]
curr_Stock_Price:  121.63736349144536
curr_Factors:  [1.21637363e+02 3.48490121e-02]
mat_Sqrt:  [[ 2.27071281e+01 -7.46153351e-03]
 [-7.46153351e-03  1.71118567e-02]]
grads:  [4.64911763e-03 1.10470250e+01]
Stock Position:  0.004649117627791452
Bond Position:  [1.51080713]


portfolio before change:  [2.0812668]
curr_Stock_Price:  122.29632178699187
curr_Factors:  [1.22296322e+02 3.56629804e-02]
mat_Sqrt:  [[ 2.30952246e+01 -7.54820067e-03]
 [-7.54820067e-03  1.73105306e-02]]
grads:  [-4.89383760e-03 -7.13102568e+00]
Stock Position:  -0.004893837598347314
Bond Position:  [2.67976514]


portfolio before change:  [2.09160803]
curr_Stock_Price:  120.86811242913976
curr_Factors:  [1.20868112e+02 4.08576727e-02]
mat_Sqrt:  [[ 2.44314098e+01 -8.07918568e-03]
 [-8.07918568e-03  1.85284507e-02]]
grads:  [-1.07229240e-03 -6.97700502e+00]
Stock Position:  -0.0010722923984805841
Bond Position:  [2.22121399]


portfolio before change:  [2.0969141]
curr_Stock_Price:  118.5107201995044
curr_Factors:  [1.18510720e+02 4.65659138e-02]
mat_Sqrt:  [[ 2.55735888e+01 -8.62498394e-03]
 [-8.62498394e-03  1.97805154e-02]]
grads:  [ 5.59256362e-03 -7.67932125e+00]
Stock Position:  0.005592563616293073
Bond Position:  [1.43413536]


portfolio before change:  [2.08463258]
curr_Stock_Price:  115.9939302226095
curr_Factors:  [1.15993930e+02 5.21095453e-02]
mat_Sqrt:  [[ 2.64785306e+01 -9.12379648e-03]
 [-9.12379648e-03  2.09249084e-02]]
grads:  [ 1.02682927e-03 -7.07499260e+00]
Stock Position:  0.0010268292655333136
Bond Position:  [1.96552662]


portfolio before change:  [2.08091515]
curr_Stock_Price:  109.97941828454645
curr_Factors:  [1.09979418e+02 5.11653367e-02]
mat_Sqrt:  [[ 2.48770746e+01 -9.04036804e-03]
 [-9.04036804e-03  2.07346356e-02]]
grads:  [-1.13663905e-03  1.84865245e+00]
Stock Position:  -0.0011366390537960404
Bond Position:  [2.20592205]


portfolio before change:  [2.08313101]
curr_Stock_Price:  110.45737244989058
curr_Factors:  [1.10457372e+02 4.47499562e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.08313101]
Stock Price:  113.86584347977285
PL:  [-11.78271247]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-2.77839863e-02 -6.65508805e-02]
 [ 4.33141667e-02 -1.02358643e-02]
 [ 6.39683624e-02  5.21831137e-02]
 [ 2.31466049e-02  2.30078407e-02]
 [-2.02727909e-01 -5.96549635e-03]
 [ 4.25494557e-02 -8.41718930e-02]
 [-1.91238652e-01 -2.46560120e-01]
 [ 3.28217166e-02 -1.35531845e-02]
 [-5.39479492e-02 -4.70972134e-02]
 [ 3.75149157e-02  1.64569195e-01]
 [ 6.00618312e-02 -1.14433302e-01]
 [-1.07160238e-02  3.59615785e-02]
 [-7.51758942e-02 -1.35257045e-01]
 [ 1.15639408e-02  2.51456679e-02]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 2.99638445e-02 -1.46280437e-01]
 [ 3.72177323e-02  4.71008192e-02]
 [-3.48910010e-02 -3.61431834e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.47676707]
curr_Stock_Price:  101.88882812940365
curr_Factors:  [1.01888828e+02 3.95171812e-02]
mat_Sqrt:  [[ 2.02544061e+01 -7.94442472e-03]
 [-7.94442472e-03  1.82224567e-02]]
grads:  [-2.80471398e-03 -3.65335824e+00]
Stock Position:  -0.0028047139755084426
Bond Position:  [13.76253609]


portfolio before change:  [13.50311747]
curr_Stock_Price:  98.63128681851971
curr_Factors:  [9.86312868e+01 4.18261767e-02]
mat_Sqrt:  [[ 2.01715257e+01 -8.17298432e-03]
 [-8.17298432e-03  1.87473757e-02]]
grads:  [ 0.00192641 -0.54514935]
Stock Position:  0.001926412020632706
Bond Position:  [13.31311297]


portfolio before change:  [13.51898812]
curr_Stock_Price:  98.225794532568
curr_Factors:  [9.82257945e+01 4.07544084e-02]
mat_Sqrt:  [[ 1.98295478e+01 -8.06756018e-03]
 [-8.06756018e-03  1.85056358e-02]]
grads:  [0.00437393 2.82175664]
Stock Position:  0.004373929985061779
Bond Position:  [13.08935537]


portfolio before change:  [13.53095666]
curr_Stock_Price:  97.2190606919095
curr_Factors:  [9.72190607e+01 3.87386644e-02]
mat_Sqrt:  [[ 1.91347902e+01 -7.86544042e-03]
 [-7.86544042e-03  1.80422141e-02]]
grads:  [0.00173416 1.27597868]
Stock Position:  0.0017341574591813458
Bond Position:  [13.3623635]


portfolio before change:  [13.54763609]
curr_Stock_Price:  97.19947345965325
curr_Factors:  [9.71994735e+01 3.65147274e-02]
mat_Sqrt:  [[ 1.85736778e+01 -7.63632975e-03]
 [-7.63632975e-03  1.75166704e-02]]
grads:  [-0.0110568  -0.34538126]
Stock Position:  -0.011056795343165317
Bond Position:  [14.62235078]


portfolio before change:  [13.61215417]
curr_Stock_Price:  93.01845117329677
curr_Factors:  [9.30184512e+01 4.18669686e-02]
mat_Sqrt:  [[ 1.90328937e+01 -8.17651067e-03]
 [-8.17651067e-03  1.87567150e-02]]
grads:  [ 3.07781189e-04 -4.48742630e+00]
Stock Position:  0.00030778118856827967
Bond Position:  [13.58352484]


portfolio before change:  [13.62842958]
curr_Stock_Price:  90.69664530638254
curr_Factors:  [9.06966453e+01 4.29065958e-02]
mat_Sqrt:  [[ 1.87868173e+01 -8.27719780e-03]
 [-8.27719780e-03  1.89882583e-02]]
grads:  [ -0.01590341 -12.99180534]
Stock Position:  -0.015903406649558284
Bond Position:  [15.07081522]


portfolio before change:  [13.58122511]
curr_Stock_Price:  94.85014353477337
curr_Factors:  [9.48501435e+01 4.16380674e-02]
mat_Sqrt:  [[ 1.93545570e+01 -8.15428316e-03]
 [-8.15428316e-03  1.87053025e-02]]
grads:  [ 0.0013908  -0.72395747]
Stock Position:  0.0013908022985753298
Bond Position:  [13.44930731]


portfolio before change:  [13.59544436]
curr_Stock_Price:  92.97863693097791
curr_Factors:  [9.29786369e+01 3.95490919e-02]
mat_Sqrt:  [[ 1.84906166e+01 -7.94694714e-03]
 [-7.94694714e-03  1.82301111e-02]]
grads:  [-0.00402868 -2.58524091]
Stock Position:  -0.004028677023671281
Bond Position:  [13.97002526]


portfolio before change:  [13.60877628]
curr_Stock_Price:  94.00665037723306
curr_Factors:  [9.40066504e+01 4.25204099e-02]
mat_Sqrt:  [[ 1.93846186e+01 -8.24015660e-03]
 [-8.24015660e-03  1.89024844e-02]]
grads:  [5.63724192e-03 8.70867780e+00]
Stock Position:  0.005637241922189965
Bond Position:  [13.07883805]


portfolio before change:  [13.64948469]
curr_Stock_Price:  98.32607551660698
curr_Factors:  [9.83260755e+01 4.09336665e-02]
mat_Sqrt:  [[ 1.98933990e+01 -8.08529097e-03]
 [-8.08529097e-03  1.85462863e-02]]
grads:  [ 5.11536763e-04 -6.16992344e+00]
Stock Position:  0.0005115367629263051
Bond Position:  [13.59918729]


portfolio before change:  [13.6678776]
curr_Stock_Price:  101.03027256172716
curr_Factors:  [1.01030273e+02 3.75849174e-02]
mat_Sqrt:  [[ 1.95865656e+01 -7.74770288e-03]
 [-7.74770288e-03  1.77713892e-02]]
grads:  [2.53378773e-04 2.02367644e+00]
Stock Position:  0.00025337877330990294
Bond Position:  [13.64227867]


portfolio before change:  [13.684549]
curr_Stock_Price:  99.48272853682899
curr_Factors:  [9.94827285e+01 3.30683996e-02]
mat_Sqrt:  [[ 1.80906529e+01 -7.26719179e-03]
 [-7.26719179e-03  1.66694907e-02]]
grads:  [-7.41630129e-03 -8.11728107e+00]
Stock Position:  -0.007416301287128143
Bond Position:  [14.42234288]


portfolio before change:  [13.6850371]
curr_Stock_Price:  101.84928516499733
curr_Factors:  [1.01849285e+02 3.43028271e-02]
mat_Sqrt:  [[ 1.88635275e+01 -7.40174775e-03]
 [-7.40174775e-03  1.69777031e-02]]
grads:  [1.19439591e-03 1.48162024e+00]
Stock Position:  0.001194395912350149
Bond Position:  [13.56338873]


portfolio before change:  [13.7096421]
curr_Stock_Price:  108.24596381305882
curr_Factors:  [1.08245964e+02 2.85567093e-02]
mat_Sqrt:  [[ 1.82921925e+01 -6.75377335e-03]
 [-6.75377335e-03  1.54904370e-02]]
grads:  [-4.67120139e-03 -5.62567340e+00]
Stock Position:  -0.0046712013928091834
Bond Position:  [14.2152808]


portfolio before change:  [13.74194055]
curr_Stock_Price:  105.13793453195058
curr_Factors:  [1.05137935e+02 3.28127246e-02]
mat_Sqrt:  [[ 1.90449816e+01 -7.23940187e-03]
 [-7.23940187e-03  1.66047676e-02]]
grads:  [ 0.00570501 -3.67377881]
Stock Position:  0.005705014859719651
Bond Position:  [13.14212707]


portfolio before change:  [13.75641631]
curr_Stock_Price:  104.79399772553096
curr_Factors:  [1.04793998e+02 2.86745871e-02]
mat_Sqrt:  [[ 1.77453661e+01 -6.76750965e-03]
 [-6.76750965e-03  1.55224574e-02]]
grads:  [-1.90570277e-03 -9.42462459e+00]
Stock Position:  -0.0019057027733972844
Bond Position:  [13.95612252]


portfolio before change:  [13.78176196]
curr_Stock_Price:  100.6540108886567
curr_Factors:  [1.00654011e+02 2.83098484e-02]
mat_Sqrt:  [[ 1.69355702e+01 -6.72408908e-03]
 [-6.72408908e-03  1.54235246e-02]]
grads:  [0.00341069 3.05531675]
Stock Position:  0.003410688487115145
Bond Position:  [13.43846248]


portfolio before change:  [13.79691766]
curr_Stock_Price:  100.16939538875926
curr_Factors:  [1.00169395e+02 3.09442825e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.79691766]
Stock Price:  99.11417607019781
PL:  [13.79691766]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-5.90218001e-02 -8.08513795e-02]
 [-1.84571076e-01  8.60428308e-02]
 [ 4.04201562e-02  9.77883014e-02]
 [-7.16655909e-01 -3.61758673e-01]
 [ 5.85194857e-01  6.15841489e-02]
 [ 1.14213435e-01  8.91871617e-02]
 [ 2.63373743e-02  4.46851625e-02]
 [ 3.71500554e-02  4.48837312e-02]
 [-4.07181918e-03 -8.29681168e-03]
 [ 6.18888958e-02 -3.30635683e-02]
 [ 5.90776029e-02 -1.11729448e-01]
 [-1.07069371e-02  3.26940219e-02]
 [-8.57594767e-02 -1.37434596e-01]
 [ 6.50492229e-03  1.31899116e-01]
 [-8.86649539e-02 -9.14254978e-03]
 [-1.50172136e-02 -5.43269924e-03]
 [-5.72109928e-02  6.37620955e-02]
 [ 9.56374597e-02 -1.13647783e-01]
 [ 1.04911830e-01  6.20619658e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.51407242]
curr_Stock_Price:  100.82965583005061
curr_Factors:  [1.00829656e+02 4.22660709e-02]
mat_Sqrt:  [[ 2.07292786e+01 -8.21601669e-03]
 [-8.21601669e-03  1.88456302e-02]]
grads:  [-0.00454846 -4.29217536]
Stock Position:  -0.004548464328978793
Bond Position:  [9.97269251]


portfolio before change:  [9.56865345]
curr_Stock_Price:  91.57216357644833
curr_Factors:  [9.15721636e+01 4.39841300e-02]
mat_Sqrt:  [[ 1.92048729e+01 -8.38056887e-03]
 [-8.38056887e-03  1.92251753e-02]]
grads:  [-0.00765908  4.47219035]
Stock Position:  -0.007659075769931989
Bond Position:  [10.27001159]


portfolio before change:  [9.60053822]
curr_Stock_Price:  89.08632559607248
curr_Factors:  [8.90863256e+01 4.59074350e-02]
mat_Sqrt:  [[ 1.90876524e+01 -8.56159917e-03]
 [-8.56159917e-03  1.96411143e-02]]
grads:  [4.35163540e-03 4.98065217e+00]
Stock Position:  0.004351635395034737
Bond Position:  [9.21286701]


portfolio before change:  [9.60557163]
curr_Stock_Price:  87.59496288420085
curr_Factors:  [8.75949629e+01 4.63269457e-02]
mat_Sqrt:  [[ 1.88536709e+01 -8.60047843e-03]
 [-8.60047843e-03  1.97307179e-02]]
grads:  [ -0.04638448 -18.35501395]
Stock Position:  -0.046384484806649535
Bond Position:  [13.66861886]


portfolio before change:  [9.63476665]
curr_Stock_Price:  87.33413080857859
curr_Factors:  [8.73341308e+01 5.19349868e-02]
mat_Sqrt:  [[ 1.99027904e+01 -9.10614232e-03]
 [-9.10614232e-03  2.08908602e-02]]
grads:  [0.03075754 2.96130609]
Stock Position:  0.03075754299384411
Bond Position:  [6.94858337]


portfolio before change:  [9.96922461]
curr_Stock_Price:  97.92557497859433
curr_Factors:  [9.79255750e+01 5.16773283e-02]
mat_Sqrt:  [[ 2.22610744e+01 -9.08455591e-03]
 [-9.08455591e-03  2.08385251e-02]]
grads:  [0.00687846 4.28291586]
Stock Position:  0.0068784561381814244
Bond Position:  [9.29564784]


portfolio before change:  [9.99150624]
curr_Stock_Price:  99.4745864373489
curr_Factors:  [9.94745864e+01 4.63297679e-02]
mat_Sqrt:  [[ 2.14112573e+01 -8.60181431e-03]
 [-8.60181431e-03  1.97308507e-02]]
grads:  [2.14028705e-03 2.26566880e+00]
Stock Position:  0.002140287048584839
Bond Position:  [9.77860208]


portfolio before change:  [9.99901308]
curr_Stock_Price:  97.26737709659797
curr_Factors:  [9.72673771e+01 4.91297220e-02]
mat_Sqrt:  [[ 2.15595316e+01 -8.85774311e-03]
 [-8.85774311e-03  2.03184056e-02]]
grads:  [0.00263119 2.21016542]
Stock Position:  0.0026311857757849075
Bond Position:  [9.74308454]


portfolio before change:  [10.00802595]
curr_Stock_Price:  96.06122887409664
curr_Factors:  [9.60612289e+01 4.66008822e-02]
mat_Sqrt:  [[ 2.07369638e+01 -8.62666359e-03]
 [-8.62666359e-03  1.97886204e-02]]
grads:  [-3.70841709e-04 -4.19433525e-01]
Stock Position:  -0.0003708417089169738
Bond Position:  [10.04364946]


portfolio before change:  [10.01928973]
curr_Stock_Price:  99.56308023410648
curr_Factors:  [9.95630802e+01 4.28042067e-02]
mat_Sqrt:  [[ 2.05987808e+01 -8.26805929e-03]
 [-8.26805929e-03  1.89652646e-02]]
grads:  [ 0.00230513 -1.74237006]
Stock Position:  0.002305130450292744
Bond Position:  [9.78978384]


portfolio before change:  [10.02228951]
curr_Stock_Price:  95.55241629224474
curr_Factors:  [9.55524163e+01 5.09326030e-02]
mat_Sqrt:  [[ 2.15645089e+01 -9.01864982e-03]
 [-9.01864982e-03  2.06879188e-02]]
grads:  [ 4.80993211e-04 -5.40050024e+00]
Stock Position:  0.00048099321050670585
Bond Position:  [9.97632944]


portfolio before change:  [10.03563337]
curr_Stock_Price:  97.35213367725073
curr_Factors:  [9.73521337e+01 4.64114306e-02]
mat_Sqrt:  [[ 2.09728725e+01 -8.60921912e-03]
 [-8.60921912e-03  1.97483076e-02]]
grads:  [1.69102463e-04 1.65560910e+00]
Stock Position:  0.0001691024629875426
Bond Position:  [10.01917088]


portfolio before change:  [10.04825347]
curr_Stock_Price:  97.87434670730771
curr_Factors:  [9.78743467e+01 4.53910214e-02]
mat_Sqrt:  [[ 2.08522930e+01 -8.51409401e-03]
 [-8.51409401e-03  1.95299876e-02]]
grads:  [-6.98724092e-03 -7.04015223e+00]
Stock Position:  -0.006987240918255896
Bond Position:  [10.73212511]


portfolio before change:  [10.06277442]
curr_Stock_Price:  97.71728833762353
curr_Factors:  [9.77172883e+01 4.27354898e-02]
mat_Sqrt:  [[ 2.02006672e+01 -8.26127641e-03]
 [-8.26127641e-03  1.89500979e-02]]
grads:  [3.16908467e-03 6.96172113e+00]
Stock Position:  0.0031690846749885247
Bond Position:  [9.75310006]


portfolio before change:  [10.05983844]
curr_Stock_Price:  92.94146991519666
curr_Factors:  [9.29414699e+01 4.39354030e-02]
mat_Sqrt:  [[ 1.94812493e+01 -8.37604887e-03]
 [-8.37604887e-03  1.92144694e-02]]
grads:  [-0.00475677 -0.47788947]
Stock Position:  -0.0047567678059925195
Bond Position:  [10.50193943]


portfolio before change:  [10.06788503]
curr_Stock_Price:  94.01132269432549
curr_Factors:  [9.40113227e+01 4.85840518e-02]
mat_Sqrt:  [[ 2.07217767e+01 -8.80812827e-03]
 [-8.80812827e-03  2.02053803e-02]]
grads:  [-0.00083915 -0.2692397 ]
Stock Position:  -0.0008391515691557739
Bond Position:  [10.14677478]


portfolio before change:  [10.08136561]
curr_Stock_Price:  93.0708785560706
curr_Factors:  [9.30708786e+01 4.74405306e-02]
mat_Sqrt:  [[ 2.02716240e+01 -8.70376706e-03]
 [-8.70376706e-03  1.99662151e-02]]
grads:  [-1.45134029e-03  3.19286671e+00]
Stock Position:  -0.001451340293154925
Bond Position:  [10.21644312]


portfolio before change:  [10.10170319]
curr_Stock_Price:  87.86256161085237
curr_Factors:  [8.78625616e+01 4.63779386e-02]
mat_Sqrt:  [[ 1.89216732e+01 -8.60523788e-03]
 [-8.60523788e-03  1.97415619e-02]]
grads:  [ 2.43679077e-03 -5.75571551e+00]
Stock Position:  0.002436790767485011
Bond Position:  [9.88760051]


portfolio before change:  [10.11856127]
curr_Stock_Price:  89.70550043950686
curr_Factors:  [8.97055004e+01 4.92612243e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.11856127]
Stock Price:  87.43933194355333
PL:  [10.11856127]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 5.00814953e-02 -2.89362601e-02]
 [-9.09617512e-04 -9.29083976e-02]
 [ 7.34821313e-02 -3.79779072e-02]
 [-2.42915297e-02 -2.96094628e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.27252440e-01  1.25712419e-01]
 [ 2.67845795e-02  4.52631845e-02]
 [-2.15408482e-01  7.10045729e-02]
 [ 7.42378893e-02  6.59631573e-02]
 [ 6.61331326e-02 -5.34488344e-02]
 [ 6.22432813e-02 -1.20426142e-01]
 [-8.26388283e-03  4.63501735e-02]
 [-8.42644107e-02 -1.37220978e-01]
 [ 5.98423909e-03  1.42252040e-01]
 [-8.41983036e-02 -2.15524573e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 2.92332947e-02 -1.46193810e-01]
 [ 1.19123863e-02  4.04321715e-02]
 [-8.09711172e-02 -7.62197699e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.35966151]
curr_Stock_Price:  104.53038619480756
curr_Factors:  [1.04530386e+02 4.21259488e-02]
mat_Sqrt:  [[ 2.14544493e+01 -8.20265013e-03]
 [-8.20265013e-03  1.88142504e-02]]
grads:  [ 0.00174659 -1.53723549]
Stock Position:  0.0017465883124791021
Bond Position:  [23.17708995]


portfolio before change:  [23.38582721]
curr_Stock_Price:  102.91364754574685
curr_Factors:  [1.02913648e+02 3.92305487e-02]
mat_Sqrt:  [[ 2.03837991e+01 -7.91563123e-03]
 [-7.91563123e-03  1.81562185e-02]]
grads:  [-2.03211557e-03 -5.11805271e+00]
Stock Position:  -0.0020321155670149573
Bond Position:  [23.59495963]


portfolio before change:  [23.41977223]
curr_Stock_Price:  100.73223289404002
curr_Factors:  [1.00732233e+02 4.39288767e-02]
mat_Sqrt:  [[ 2.11126854e+01 -8.37606505e-03]
 [-8.37606505e-03  1.92127640e-02]]
grads:  [ 0.00269672 -1.97552623]
Stock Position:  0.002696719726027804
Bond Position:  [23.14812563]


portfolio before change:  [23.46698784]
curr_Stock_Price:  107.5042962231936
curr_Factors:  [1.07504296e+02 4.57534856e-02]
mat_Sqrt:  [[ 2.29952366e+01 -8.54873705e-03]
 [-8.54873705e-03  1.96074973e-02]]
grads:  [-0.00161803 -1.51081469]
Stock Position:  -0.0016180345456540892
Bond Position:  [23.6409335]


portfolio before change:  [23.50001937]
curr_Stock_Price:  105.3647300239952
curr_Factors:  [1.05364730e+02 4.61249537e-02]
mat_Sqrt:  [[ 2.26288873e+01 -8.58322159e-03]
 [-8.58322159e-03  1.96869968e-02]]
grads:  [ 0.0072464  -5.99622803]
Stock Position:  0.007246402605402437
Bond Position:  [22.73650412]


portfolio before change:  [23.49638114]
curr_Stock_Price:  100.93817066486717
curr_Factors:  [1.00938171e+02 5.11224572e-02]
mat_Sqrt:  [[ 2.28223970e+01 -9.03590504e-03]
 [-9.03590504e-03  2.07262392e-02]]
grads:  [0.00797857 6.06885364]
Stock Position:  0.007978567068913419
Bond Position:  [22.69103918]


portfolio before change:  [23.52557182]
curr_Stock_Price:  101.03958502729995
curr_Factors:  [1.01039585e+02 4.72522615e-02]
mat_Sqrt:  [[ 2.19635643e+01 -8.68715346e-03]
 [-8.68715346e-03  1.99262636e-02]]
grads:  [2.11831585e-03 2.27245748e+00]
Stock Position:  0.0021183158514819916
Bond Position:  [23.31153806]


portfolio before change:  [23.55816139]
curr_Stock_Price:  102.65970475319078
curr_Factors:  [1.02659705e+02 4.82226056e-02]
mat_Sqrt:  [[ 2.25437061e+01 -8.77602280e-03]
 [-8.77602280e-03  2.01297660e-02]]
grads:  [-0.00818338  3.52377446]
Stock Position:  -0.008183381910208861
Bond Position:  [24.39826496]


portfolio before change:  [23.59097876]
curr_Stock_Price:  102.37858908494113
curr_Factors:  [1.02378589e+02 4.46138323e-02]
mat_Sqrt:  [[ 2.16243903e+01 -8.44123726e-03]
 [-8.44123726e-03  1.93619172e-02]]
grads:  [0.00476376 3.40892737]
Stock Position:  0.0047637622346435185
Bond Position:  [23.10327151]


portfolio before change:  [23.62055023]
curr_Stock_Price:  102.52014031203593
curr_Factors:  [1.0252014e+02 4.0616284e-02]
mat_Sqrt:  [[ 2.06613765e+01 -8.05419189e-03]
 [-8.05419189e-03  1.84741125e-02]]
grads:  [ 2.07334825e-03 -2.89227075e+00]
Stock Position:  0.0020733482543931303
Bond Position:  [23.40799027]


portfolio before change:  [23.65091429]
curr_Stock_Price:  103.04382684662912
curr_Factors:  [1.03043827e+02 4.40149840e-02]
mat_Sqrt:  [[ 2.16183339e+01 -8.38444123e-03]
 [-8.38444123e-03  1.92315102e-02]]
grads:  [ 4.50647322e-04 -6.26172163e+00]
Stock Position:  0.0004506473218106064
Bond Position:  [23.60447787]


portfolio before change:  [23.6813409]
curr_Stock_Price:  105.04664127867592
curr_Factors:  [1.05046641e+02 4.06864066e-02]
mat_Sqrt:  [[ 2.11888217e+01 -8.06131473e-03]
 [-8.06131473e-03  1.84899776e-02]]
grads:  [5.63787058e-04 2.50701864e+00]
Stock Position:  0.0005637870582140243
Bond Position:  [23.62211697]


portfolio before change:  [23.70697522]
curr_Stock_Price:  98.10822691899217
curr_Factors:  [9.81082269e+01 4.56306510e-02]
mat_Sqrt:  [[ 2.09572225e+01 -8.53655739e-03]
 [-8.53655739e-03  1.95814631e-02]]
grads:  [-6.87646549e-03 -7.01069570e+00]
Stock Position:  -0.006876465486526353
Bond Position:  [24.38161306]


portfolio before change:  [23.74340588]
curr_Stock_Price:  97.24519896975427
curr_Factors:  [9.7245199e+01 4.5393115e-02]
mat_Sqrt:  [[ 2.07187298e+01 -8.51423881e-03]
 [-8.51423881e-03  1.95304605e-02]]
grads:  [3.28257206e-03 7.28502989e+00]
Stock Position:  0.003282572057488958
Bond Position:  [23.4241915]


portfolio before change:  [23.76196502]
curr_Stock_Price:  93.97355696406824
curr_Factors:  [9.39735570e+01 4.58868927e-02]
mat_Sqrt:  [[ 2.01302863e+01 -8.56014104e-03]
 [-8.56014104e-03  1.96365199e-02]]
grads:  [-0.00465026 -1.09959729]
Stock Position:  -0.004650257339240164
Bond Position:  [24.19896625]


portfolio before change:  [23.75965704]
curr_Stock_Price:  100.97867684030722
curr_Factors:  [1.00978677e+02 3.87676302e-02]
mat_Sqrt:  [[ 1.98821922e+01 -7.86865644e-03]
 [-7.86865644e-03  1.80488379e-02]]
grads:  [ 0.00546488 -3.37974907]
Stock Position:  0.005464879241915364
Bond Position:  [23.20782076]


portfolio before change:  [23.80594595]
curr_Stock_Price:  104.13720906421926
curr_Factors:  [1.04137209e+02 3.93951677e-02]
mat_Sqrt:  [[ 2.06693766e+01 -7.93230456e-03]
 [-7.93230456e-03  1.81942359e-02]]
grads:  [-1.66961534e-03 -8.03589961e+00]
Stock Position:  -0.001669615340845599
Bond Position:  [23.97981503]


portfolio before change:  [23.8373625]
curr_Stock_Price:  103.28489080229197
curr_Factors:  [1.03284891e+02 3.79859891e-02]
mat_Sqrt:  [[ 2.01302182e+01 -7.78908550e-03]
 [-7.78908550e-03  1.78658904e-02]]
grads:  [1.46768381e-03 2.26373288e+00]
Stock Position:  0.001467683809157525
Bond Position:  [23.68577294]


portfolio before change:  [23.86622901]
curr_Stock_Price:  102.76759826800902
curr_Factors:  [1.02767598e+02 3.72879241e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.86622901]
Stock Price:  98.10105127048338
PL:  [23.86622901]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-5.06504990e-02 -7.74091374e-02]
 [-1.18168723e-01  7.63867221e-02]
 [ 4.56697986e-02  1.06571234e-01]
 [ 2.59629700e-02  2.31600940e-02]
 [-2.10342490e-01 -1.64417559e-02]
 [ 1.28303568e-01  1.30428018e-01]
 [ 2.53531078e-02  4.34129779e-02]
 [ 3.53169104e-02 -2.72328404e-03]
 [-5.53053164e-02 -4.81102750e-02]
 [ 3.75874145e-02  1.76828409e-01]
 [ 5.93346380e-02 -1.12435571e-01]
 [-1.06561825e-02  3.92000771e-02]
 [ 1.30092361e-03 -4.59375983e-02]
 [ 1.22152049e-02 -1.86956868e-02]
 [-4.78512052e-02 -8.78712851e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 2.40365133e-02 -1.33764983e-01]
 [ 1.93224423e-02  4.23552209e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.6945126]
curr_Stock_Price:  101.1451708125804
curr_Factors:  [1.01145171e+02 4.22346849e-02]
mat_Sqrt:  [[ 2.07864224e+01 -8.21298886e-03]
 [-8.21298886e-03  1.88386216e-02]]
grads:  [-4.06095626e-03 -4.11083633e+00]
Stock Position:  -0.0040609562623582715
Bond Position:  [11.10525871]


portfolio before change:  [10.73987479]
curr_Stock_Price:  93.39528577966688
curr_Factors:  [9.33952858e+01 4.55289321e-02]
mat_Sqrt:  [[ 1.99282263e+01 -8.52663567e-03]
 [-8.52663567e-03  1.95598007e-02]]
grads:  [-0.00425956  3.90343457]
Stock Position:  -0.004259564159619996
Bond Position:  [11.137698]


portfolio before change:  [10.75543101]
curr_Stock_Price:  93.0137000552021
curr_Factors:  [9.30137001e+01 4.26774181e-02]
mat_Sqrt:  [[ 1.92152460e+01 -8.25527028e-03]
 [-8.25527028e-03  1.89373888e-02]]
grads:  [4.79536191e-03 5.62964735e+00]
Stock Position:  0.004795361912920606
Bond Position:  [10.30939665]


portfolio before change:  [10.78638319]
curr_Stock_Price:  96.77929311925075
curr_Factors:  [9.67792931e+01 4.38277774e-02]
mat_Sqrt:  [[ 2.02608253e+01 -8.36611035e-03]
 [-8.36611035e-03  1.91907783e-02]]
grads:  [0.00178008 1.20761055]
Stock Position:  0.0017800841080536495
Bond Position:  [10.61410791]


portfolio before change:  [10.80219928]
curr_Stock_Price:  98.20627840311344
curr_Factors:  [9.82062784e+01 3.92610783e-02]
mat_Sqrt:  [[ 1.94589915e+01 -7.91837287e-03]
 [-7.91837287e-03  1.81634290e-02]]
grads:  [-0.01117986 -0.91008599]
Stock Position:  -0.011179864553340572
Bond Position:  [11.90013217]


portfolio before change:  [10.80171126]
curr_Stock_Price:  99.5812932376496
curr_Factors:  [9.95812932e+01 3.75589554e-02]
mat_Sqrt:  [[ 1.92989855e+01 -7.74492438e-03]
 [-7.74492438e-03  1.77652948e-02]]
grads:  [0.00959621 7.34591466]
Stock Position:  0.009596210191281911
Bond Position:  [9.84610824]


portfolio before change:  [10.81571801]
curr_Stock_Price:  99.75755197237459
curr_Factors:  [9.97575520e+01 3.86869398e-02]
mat_Sqrt:  [[ 1.96213072e+01 -7.86037605e-03]
 [-7.86037605e-03  1.80300828e-02]]
grads:  [2.25709319e-03 2.40879202e+00]
Stock Position:  0.002257093190281585
Bond Position:  [10.59055592]


portfolio before change:  [10.82049148]
curr_Stock_Price:  96.00360623390097
curr_Factors:  [9.60036062e+01 3.61344789e-02]
mat_Sqrt:  [[ 1.82493923e+01 -7.59637582e-03]
 [-7.59637582e-03  1.74252651e-02]]
grads:  [ 0.00187052 -0.15546821]
Stock Position:  0.0018705234018121448
Bond Position:  [10.64091449]


portfolio before change:  [10.82800625]
curr_Stock_Price:  92.90571190535155
curr_Factors:  [9.29057119e+01 3.68905114e-02]
mat_Sqrt:  [[ 1.78443081e+01 -7.67518882e-03]
 [-7.67518882e-03  1.76067200e-02]]
grads:  [-0.00427543 -2.73435879]
Stock Position:  -0.004275426986142646
Bond Position:  [11.22521784]


portfolio before change:  [10.83841973]
curr_Stock_Price:  93.75400703099827
curr_Factors:  [9.37540070e+01 3.16014952e-02]
mat_Sqrt:  [[ 1.66664696e+01 -7.10377864e-03]
 [-7.10377864e-03  1.62957443e-02]]
grads:  [6.88167699e-03 1.08542017e+01]
Stock Position:  0.0068816769894002585
Bond Position:  [10.19323493]


portfolio before change:  [10.86858229]
curr_Stock_Price:  96.28435797999583
curr_Factors:  [9.62843580e+01 2.85518694e-02]
mat_Sqrt:  [[ 1.62694539e+01 -6.75249119e-03]
 [-6.75249119e-03  1.54894337e-02]]
grads:  [ 6.34387821e-04 -7.25857957e+00]
Stock Position:  0.0006343878210234653
Bond Position:  [10.80750067]


portfolio before change:  [10.8836578]
curr_Stock_Price:  98.7397764739604
curr_Factors:  [9.87397765e+01 3.11568674e-02]
mat_Sqrt:  [[ 1.74288606e+01 -7.05397503e-03]
 [-7.05397503e-03  1.61805473e-02]]
grads:  [3.69179898e-04 2.42282790e+00]
Stock Position:  0.0003691798975263114
Bond Position:  [10.84720506]


portfolio before change:  [10.8988786]
curr_Stock_Price:  103.21812014711536
curr_Factors:  [1.03218120e+02 3.08000627e-02]
mat_Sqrt:  [[ 1.81147237e+01 -7.01375034e-03]
 [-7.01375034e-03  1.60875086e-02]]
grads:  [-1.03395886e-03 -2.85593322e+00]
Stock Position:  -0.001033958857393916
Bond Position:  [11.00560189]


portfolio before change:  [10.91251936]
curr_Stock_Price:  103.33886712965555
curr_Factors:  [1.03338867e+02 2.96048765e-02]
mat_Sqrt:  [[ 1.77805541e+01 -6.87632792e-03]
 [-6.87632792e-03  1.57722820e-02]]
grads:  [ 2.28622213e-04 -1.18525111e+00]
Stock Position:  0.00022862221281871634
Bond Position:  [10.8888938]


portfolio before change:  [10.92622614]
curr_Stock_Price:  103.72008493910054
curr_Factors:  [1.03720085e+02 3.02769222e-02]
mat_Sqrt:  [[ 1.80475683e+01 -6.95396066e-03]
 [-6.95396066e-03  1.59502869e-02]]
grads:  [-4.77491221e-03 -5.51115413e+00]
Stock Position:  -0.004774912211303474
Bond Position:  [11.42148044]


portfolio before change:  [10.94185116]
curr_Stock_Price:  103.43961114725643
curr_Factors:  [1.03439611e+02 3.13674592e-02]
mat_Sqrt:  [[ 1.83200442e+01 -7.07807237e-03]
 [-7.07807237e-03  1.62350080e-02]]
grads:  [ 0.00593081 -3.75740903]
Stock Position:  0.005930807239449312
Bond Position:  [10.32837076]


portfolio before change:  [10.94772893]
curr_Stock_Price:  102.25245997087949
curr_Factors:  [1.02252460e+02 3.02395513e-02]
mat_Sqrt:  [[ 1.77812138e+01 -6.94957961e-03]
 [-6.94957961e-03  1.59404785e-02]]
grads:  [-1.92826689e-03 -8.39236937e+00]
Stock Position:  -0.0019282668891357681
Bond Position:  [11.14489896]


portfolio before change:  [10.96115656]
curr_Stock_Price:  102.51808843429396
curr_Factors:  [1.02518088e+02 3.25520183e-02]
mat_Sqrt:  [[ 1.84964945e+01 -7.21042446e-03]
 [-7.21042446e-03  1.65387412e-02]]
grads:  [2.04333566e-03 2.56186088e+00]
Stock Position:  0.0020433356595731243
Bond Position:  [10.75167769]


portfolio before change:  [10.97816778]
curr_Stock_Price:  104.26191549164227
curr_Factors:  [1.04261915e+02 2.91090773e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.97816778]
Stock Price:  106.25181080491691
PL:  [4.72635698]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 9.46835914e-02 -6.52277171e-03]
 [-6.88934449e-02 -1.49595239e-01]
 [-6.79857279e-02 -2.41688050e-01]
 [-2.23878943e-02 -2.44352776e-02]
 [-9.66795729e-02 -7.30612237e-02]
 [ 1.28471910e-01  1.09456221e-01]
 [ 4.12770617e-02  6.39950141e-02]
 [-2.53854043e-01  6.50593326e-02]
 [ 6.47688487e-02  5.43310696e-02]
 [ 6.78265759e-02 -5.63607306e-02]
 [ 5.94572774e-02 -1.12772483e-01]
 [-7.23770302e-03  1.72984483e-02]
 [-1.02422202e-01 -1.39815401e-01]
 [ 4.45815399e-03  1.64847943e-01]
 [-9.02549763e-02 -4.78526337e-03]
 [-5.64104580e-02  1.61169052e-02]
 [-7.47862460e-02  1.07159077e-01]
 [ 1.14242060e-01 -5.06077562e-02]
 [ 8.87758928e-03 -7.09553892e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [29.56031315]
curr_Stock_Price:  106.18773278126241
curr_Factors:  [1.06187733e+02 3.85581721e-02]
mat_Sqrt:  [[ 2.08512712e+01 -7.84771997e-03]
 [-7.84771997e-03  1.79998615e-02]]
grads:  [ 0.00440524 -0.36045837]
Stock Position:  0.004405238143059557
Bond Position:  [29.09253089]


portfolio before change:  [29.59604132]
curr_Stock_Price:  106.03786016268465
curr_Factors:  [1.06037860e+02 3.48499616e-02]
mat_Sqrt:  [[ 1.97952995e+01 -7.46080865e-03]
 [-7.46080865e-03  1.71124502e-02]]
grads:  [-6.77620924e-03 -8.74484915e+00]
Stock Position:  -0.006776209237520022
Bond Position:  [30.31457605]


portfolio before change:  [29.63945546]
curr_Stock_Price:  105.22660639716125
curr_Factors:  [1.05226606e+02 3.23076374e-02]
mat_Sqrt:  [[ 1.89137713e+01 -7.18347290e-03]
 [-7.18347290e-03  1.64764708e-02]]
grads:  [-9.16720885e-03 -1.46726751e+01]
Stock Position:  -0.009167208852261131
Bond Position:  [30.60408974]


portfolio before change:  [29.68977627]
curr_Stock_Price:  103.9130361799944
curr_Factors:  [1.03913036e+02 3.58425431e-02]
mat_Sqrt:  [[ 1.96729465e+01 -7.56617684e-03]
 [-7.56617684e-03  1.73544922e-02]]
grads:  [-0.0016798  -1.40874115]
Stock Position:  -0.001679803222819954
Bond Position:  [29.86432972]


portfolio before change:  [29.73202977]
curr_Stock_Price:  100.99617789901112
curr_Factors:  [1.00996178e+02 3.61830280e-02]
mat_Sqrt:  [[ 1.92113268e+01 -7.60183570e-03]
 [-7.60183570e-03  1.74368109e-02]]
grads:  [-0.00669157 -4.19297384]
Stock Position:  -0.006691566525939742
Bond Position:  [30.40785241]


portfolio before change:  [29.75537379]
curr_Stock_Price:  103.19141230482673
curr_Factors:  [1.03191412e+02 3.49631750e-02]
mat_Sqrt:  [[ 1.92951854e+01 -7.47273936e-03]
 [-7.47273936e-03  1.71403010e-02]]
grads:  [0.00913294 6.38988018]
Stock Position:  0.009132942499801207
Bond Position:  [28.81293256]


portfolio before change:  [29.79568035]
curr_Stock_Price:  103.65871730893947
curr_Factors:  [1.03658717e+02 3.28507600e-02]
mat_Sqrt:  [[ 1.87879116e+01 -7.24350645e-03]
 [-7.24350645e-03  1.66144279e-02]]
grads:  [3.68263591e-03 3.85337910e+00]
Stock Position:  0.0036826359060816377
Bond Position:  [29.41394303]


portfolio before change:  [29.83244869]
curr_Stock_Price:  103.65272403931819
curr_Factors:  [1.03652724e+02 3.12251479e-02]
mat_Sqrt:  [[ 1.83160972e+01 -7.06201068e-03]
 [-7.06201068e-03  1.61981321e-02]]
grads:  [-0.01231308  4.01110307]
Stock Position:  -0.012313081115042103
Bond Position:  [31.10873309]


portfolio before change:  [29.8392576]
curr_Stock_Price:  106.25981507535515
curr_Factors:  [1.06259815e+02 3.24011654e-02]
mat_Sqrt:  [[ 1.91271093e+01 -7.19392405e-03]
 [-7.19392405e-03  1.65002761e-02]]
grads:  [0.00462543 3.29475364]
Stock Position:  0.0046254274313789305
Bond Position:  [29.34776054]


portfolio before change:  [29.85179073]
curr_Stock_Price:  101.03337787635894
curr_Factors:  [1.01033378e+02 3.37163914e-02]
mat_Sqrt:  [[ 1.85517713e+01 -7.33815216e-03]
 [-7.33815216e-03  1.68319766e-02]]
grads:  [ 2.33200008e-03 -3.34741542e+00]
Stock Position:  0.0023320000815121858
Bond Position:  [29.61618089]


portfolio before change:  [29.87856199]
curr_Stock_Price:  96.62852483072108
curr_Factors:  [9.66285248e+01 3.10669417e-02]
mat_Sqrt:  [[ 1.70315653e+01 -7.04364526e-03]
 [-7.04364526e-03  1.61572423e-02]]
grads:  [ 6.04565644e-04 -6.97942278e+00]
Stock Position:  0.0006045656435989297
Bond Position:  [29.8201437]


portfolio before change:  [29.91478153]
curr_Stock_Price:  94.8438571540723
curr_Factors:  [9.48438572e+01 2.99719149e-02]
mat_Sqrt:  [[ 1.64197453e+01 -6.91827346e-03]
 [-6.91827346e-03  1.58699919e-02]]
grads:  [1.84740566e-05 1.09001796e+00]
Stock Position:  1.8474056586246068e-05
Bond Position:  [29.91302937]


portfolio before change:  [29.95220352]
curr_Stock_Price:  95.24080378966802
curr_Factors:  [9.52408038e+01 2.36701842e-02]
mat_Sqrt:  [[ 1.46529083e+01 -6.14813005e-03]
 [-6.14813005e-03  1.41032740e-02]]
grads:  [-0.01115155 -9.9185453 ]
Stock Position:  -0.01115155470112897
Bond Position:  [31.01428656]


portfolio before change:  [30.00066557]
curr_Stock_Price:  94.37366494673121
curr_Factors:  [9.43736649e+01 2.68174084e-02]
mat_Sqrt:  [[ 1.54546504e+01 -6.54405277e-03]
 [-6.54405277e-03  1.50116441e-02]]
grads:  [4.93927073e-03 1.09834916e+01]
Stock Position:  0.004939270734502259
Bond Position:  [29.53452849]


portfolio before change:  [30.02865237]
curr_Stock_Price:  92.56075639664373
curr_Factors:  [9.25607564e+01 2.34469395e-02]
mat_Sqrt:  [[ 1.41732659e+01 -6.11889804e-03]
 [-6.11889804e-03  1.40366834e-02]]
grads:  [-0.00651638 -0.34375189]
Stock Position:  -0.0065163780507650395
Bond Position:  [30.63181325]


portfolio before change:  [30.07398354]
curr_Stock_Price:  91.48386015273776
curr_Factors:  [9.14838602e+01 2.53265103e-02]
mat_Sqrt:  [[ 1.45590191e+01 -6.35935039e-03]
 [-6.35935039e-03  1.45884806e-02]]
grads:  [-0.00339269  1.10329035]
Stock Position:  -0.003392690648073476
Bond Position:  [30.38435997]


portfolio before change:  [30.11680025]
curr_Stock_Price:  90.06536585101048
curr_Factors:  [9.00653659e+01 2.68978349e-02]
mat_Sqrt:  [[ 1.47712224e+01 -6.55355415e-03]
 [-6.55355415e-03  1.50342701e-02]]
grads:  [-1.90100785e-03  7.12682543e+00]
Stock Position:  -0.0019010078486306518
Bond Position:  [30.28801521]


portfolio before change:  [30.14744104]
curr_Stock_Price:  93.87539518230707
curr_Factors:  [9.38753952e+01 2.75024927e-02]
mat_Sqrt:  [[ 1.55681773e+01 -6.62707951e-03]
 [-6.62707951e-03  1.52021954e-02]]
grads:  [ 0.00592219 -3.32639518]
Stock Position:  0.005922194533877822
Bond Position:  [29.59149269]


portfolio before change:  [30.21230535]
curr_Stock_Price:  98.57835038893012
curr_Factors:  [9.85783504e+01 2.42405975e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [30.21230535]
Stock Price:  98.0960132856011
PL:  [30.21230535]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.61168308e-01  1.60017961e-03]
 [ 2.33027724e-02 -6.37970969e-02]
 [ 7.40997035e-02 -4.76570486e-02]
 [-1.74804950e-02 -1.10966984e-02]
 [-9.51273227e-02 -7.32852588e-02]
 [ 1.23255628e-01  1.11868641e-01]
 [ 3.90305117e-02  6.10913023e-02]
 [-2.92403058e-01  5.91433709e-02]
 [ 8.21950077e-02  7.48074736e-02]
 [ 6.42143919e-02 -4.90876723e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [-6.79052882e-03  4.25067225e-02]
 [ 3.42255913e-02  4.24329085e-02]
 [ 1.32954045e-02 -7.57937236e-02]
 [-5.78611298e-02 -8.97979285e-02]
 [ 8.06230875e-02 -5.37190117e-02]
 [ 2.35843442e-02 -1.32734379e-01]
 [ 4.41422482e-03  3.83497930e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.70855605]
curr_Stock_Price:  97.02814816445832
curr_Factors:  [9.70281482e+01 3.98076895e-02]
mat_Sqrt:  [[ 1.93589229e+01 -7.97321371e-03]
 [-7.97321371e-03  1.82894712e-02]]
grads:  [0.00836281 0.09113758]
Stock Position:  0.008362808613941305
Bond Position:  [-5.51998388]


portfolio before change:  [-4.68650319]
curr_Stock_Price:  100.49075913941816
curr_Factors:  [1.00490759e+02 3.78833451e-02]
mat_Sqrt:  [[ 1.95591624e+01 -7.77836295e-03]
 [-7.77836295e-03  1.78418194e-02]]
grads:  [-2.30641117e-04 -3.57580633e+00]
Stock Position:  -0.0002306411171191297
Bond Position:  [-4.66332589]


portfolio before change:  [-4.69242524]
curr_Stock_Price:  100.87770390556335
curr_Factors:  [1.00877704e+02 3.98374255e-02]
mat_Sqrt:  [[ 2.01344971e+01 -7.97647841e-03]
 [-7.97647841e-03  1.82961757e-02]]
grads:  [ 0.00264879 -2.60359986]
Stock Position:  0.0026487945134509327
Bond Position:  [-4.95962954]


portfolio before change:  [-4.69691723]
curr_Stock_Price:  101.5238158238783
curr_Factors:  [1.01523816e+02 4.36933942e-02]
mat_Sqrt:  [[ 2.12214860e+01 -8.35364399e-03]
 [-8.35364399e-03  1.91611736e-02]]
grads:  [-0.00105186 -0.57958273]
Stock Position:  -0.0010518642690802052
Bond Position:  [-4.59012796]


portfolio before change:  [-4.70211071]
curr_Stock_Price:  101.00305742793626
curr_Factors:  [1.01003057e+02 4.58166652e-02]
mat_Sqrt:  [[ 2.16195288e+01 -8.55416827e-03]
 [-8.55416827e-03  1.96212349e-02]]
grads:  [-0.0058789  -3.73756027]
Stock Position:  -0.005878899739714968
Bond Position:  [-4.10832386]


portfolio before change:  [-4.69285582]
curr_Stock_Price:  98.55472378262061
curr_Factors:  [9.85547238e+01 4.61237751e-02]
mat_Sqrt:  [[ 2.11660507e+01 -8.58259643e-03]
 [-8.58259643e-03  1.96869700e-02]]
grads:  [0.00812884 5.68591346]
Stock Position:  0.008128844182914102
Bond Position:  [-5.49399181]


portfolio before change:  [-4.6607598]
curr_Stock_Price:  103.34849246881761
curr_Factors:  [1.03348492e+02 4.72900450e-02]
mat_Sqrt:  [[ 2.24744451e+01 -8.69080193e-03]
 [-8.69080193e-03  1.99341519e-02]]
grads:  [2.92224770e-03 3.06592923e+00]
Stock Position:  0.0029222476964035605
Bond Position:  [-4.9627697]


portfolio before change:  [-4.66322278]
curr_Stock_Price:  104.6298222001744
curr_Factors:  [1.04629822e+02 3.85513473e-02]
mat_Sqrt:  [[ 2.05435378e+01 -7.84692465e-03]
 [-7.84692465e-03  1.79983123e-02]]
grads:  [-0.01298034  3.28039174]
Stock Position:  -0.012980338298445923
Bond Position:  [-3.30509229]


portfolio before change:  [-4.65068933]
curr_Stock_Price:  103.34577229451209
curr_Factors:  [1.03345772e+02 3.68313130e-02]
mat_Sqrt:  [[ 1.98335878e+01 -7.66979187e-03]
 [-7.66979187e-03  1.75922546e-02]]
grads:  [0.0057896 4.2548201]
Stock Position:  0.005789602635913579
Bond Position:  [-5.24902029]


portfolio before change:  [-4.65497656]
curr_Stock_Price:  103.73926130146232
curr_Factors:  [1.03739261e+02 3.63581858e-02]
mat_Sqrt:  [[ 1.97808168e+01 -7.62039601e-03]
 [-7.62039601e-03  1.74788851e-02]]
grads:  [ 2.16474762e-03 -2.80745459e+00]
Stock Position:  0.002164747618845577
Bond Position:  [-4.87954588]


portfolio before change:  [-4.65495838]
curr_Stock_Price:  106.56703888107202
curr_Factors:  [1.06567039e+02 3.79648444e-02]
mat_Sqrt:  [[ 2.07641272e+01 -7.78712999e-03]
 [-7.78712999e-03  1.78608245e-02]]
grads:  [ 4.62418402e-04 -6.85009273e+00]
Stock Position:  0.00046241840236233695
Bond Position:  [-4.70423694]


portfolio before change:  [-4.66112965]
curr_Stock_Price:  105.94575463484139
curr_Factors:  [1.05945755e+02 3.58298441e-02]
mat_Sqrt:  [[ 2.00542298e+01 -7.56496430e-03]
 [-7.56496430e-03  1.73513618e-02]]
grads:  [5.85600727e-04 2.45001822e+00]
Stock Position:  0.0005856007273038889
Bond Position:  [-4.72317156]


portfolio before change:  [-4.66619487]
curr_Stock_Price:  107.38434099779269
curr_Factors:  [1.07384341e+02 3.39851044e-02]
mat_Sqrt:  [[ 1.97963549e+01 -7.36773094e-03]
 [-7.36773094e-03  1.68987451e-02]]
grads:  [0.00266385 2.51217087]
Stock Position:  0.002663853553977862
Bond Position:  [-4.95225103]


portfolio before change:  [-4.67808321]
curr_Stock_Price:  105.24677553810773
curr_Factors:  [1.05246776e+02 3.19430856e-02]
mat_Sqrt:  [[ 1.88103640e+01 -7.14283080e-03]
 [-7.14283080e-03  1.63832483e-02]]
grads:  [-1.05009670e-03 -4.62675185e+00]
Stock Position:  -0.0010500966966676896
Bond Position:  [-4.56756392]


portfolio before change:  [-4.67830063]
curr_Stock_Price:  100.01334208532948
curr_Factors:  [1.00013342e+02 3.36691899e-02]
mat_Sqrt:  [[ 1.83516129e+01 -7.33294602e-03]
 [-7.33294602e-03  1.68202200e-02]]
grads:  [-5.28707493e-03 -5.34099425e+00]
Stock Position:  -0.00528707492934537
Bond Position:  [-4.14952259]


portfolio before change:  [-4.67653432]
curr_Stock_Price:  98.69759532084942
curr_Factors:  [9.86975953e+01 3.43568737e-02]
mat_Sqrt:  [[ 1.82941972e+01 -7.40736376e-03]
 [-7.40736376e-03  1.69911653e-02]]
grads:  [ 3.12744948e-03 -3.16022147e+00]
Stock Position:  0.0031274494838448384
Bond Position:  [-4.98520607]


portfolio before change:  [-4.67148909]
curr_Stock_Price:  102.30457281569795
curr_Factors:  [1.02304573e+02 3.61633763e-02]
mat_Sqrt:  [[ 1.94549222e+01 -7.59985921e-03]
 [-7.59985921e-03  1.74320367e-02]]
grads:  [-1.76252624e-03 -7.61516148e+00]
Stock Position:  -0.0017625262412554207
Bond Position:  [-4.49117459]


portfolio before change:  [-4.68023103]
curr_Stock_Price:  104.0772902807169
curr_Factors:  [1.04077290e+02 3.15365509e-02]
mat_Sqrt:  [[ 1.84825990e+01 -7.09716301e-03]
 [-7.09716301e-03  1.62786912e-02]]
grads:  [1.14364096e-03 2.35632639e+00]
Stock Position:  0.0011436409617316813
Bond Position:  [-4.79925808]


portfolio before change:  [-4.6869869]
curr_Stock_Price:  103.41881888791396
curr_Factors:  [1.03418819e+02 3.13552220e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.6869869]
Stock Price:  103.95918949321812
PL:  [-8.6461764]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-4.66363278e-02 -7.55107397e-02]
 [-1.89558774e-02 -1.14605971e-01]
 [-3.41978759e-01 -1.53571338e-01]
 [-2.42915297e-02 -2.96094628e-02]
 [-7.41151830e-02 -7.63179247e-02]
 [ 8.90923016e-02  3.35557794e-02]
 [-1.04246216e-01 -1.31157365e-01]
 [ 3.17170375e-02 -1.83478283e-02]
 [-2.60067553e-02 -2.57988120e-02]
 [ 6.32885168e-02 -3.82931219e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [-9.33095943e-03  4.07341042e-02]
 [-9.72155673e-02 -1.39071466e-01]
 [ 1.21218119e-02  2.06274761e-02]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 1.88939508e-02 -1.22565149e-01]
 [ 8.00772787e-02  1.00253996e-02]
 [-3.01159683e-03 -1.50183381e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.17665367]
curr_Stock_Price:  101.27404030953183
curr_Factors:  [1.01274040e+02 3.96679936e-02]
mat_Sqrt:  [[ 2.01705723e+01 -7.95952631e-03]
 [-7.95952631e-03  1.82572144e-02]]
grads:  [-3.94486272e-03 -4.13765963e+00]
Stock Position:  -0.003944862715718682
Bond Position:  [11.57616585]


portfolio before change:  [11.17983525]
curr_Stock_Price:  104.13793373950908
curr_Factors:  [1.04137934e+02 3.77514601e-02]
mat_Sqrt:  [[ 2.02337230e+01 -7.76505941e-03]
 [-7.76505941e-03  1.78106275e-02]]
grads:  [-3.40684737e-03 -6.43618113e+00]
Stock Position:  -0.0034068473743455395
Bond Position:  [11.5346173]


portfolio before change:  [11.17946973]
curr_Stock_Price:  108.4800157105009
curr_Factors:  [1.08480016e+02 3.89750588e-02]
mat_Sqrt:  [[ 2.14162338e+01 -7.89017406e-03]
 [-7.89017406e-03  1.80968434e-02]]
grads:  [-0.01909772 -8.49441079]
Stock Position:  -0.019097715409315288
Bond Position:  [13.2511902]


portfolio before change:  [11.2445036]
curr_Stock_Price:  105.94256456610567
curr_Factors:  [1.05942565e+02 3.98532837e-02]
mat_Sqrt:  [[ 2.11496170e+01 -7.97841216e-03]
 [-7.97841216e-03  1.82996660e-02]]
grads:  [-0.00175923 -1.61879996]
Stock Position:  -0.0017592272753811503
Bond Position:  [11.43088064]


portfolio before change:  [11.26709848]
curr_Stock_Price:  101.22608912839833
curr_Factors:  [1.01226089e+02 4.83376908e-02]
mat_Sqrt:  [[ 2.22553985e+01 -8.78637771e-03]
 [-8.78637771e-03  2.01538204e-02]]
grads:  [-0.00482605 -3.7888761 ]
Stock Position:  -0.004826050620155514
Bond Position:  [11.75562071]


portfolio before change:  [11.30574955]
curr_Stock_Price:  96.26398762147635
curr_Factors:  [9.62639876e+01 4.55340008e-02]
mat_Sqrt:  [[ 2.05414793e+01 -8.52735946e-03]
 [-8.52735946e-03  1.95607809e-02]]
grads:  [0.00505024 1.71766377]
Stock Position:  0.005050241834947082
Bond Position:  [10.81959313]


portfolio before change:  [11.30579936]
curr_Stock_Price:  93.59418794888484
curr_Factors:  [9.35941879e+01 4.65672671e-02]
mat_Sqrt:  [[ 2.01971093e+01 -8.62333495e-03]
 [-8.62333495e-03  1.97815764e-02]]
grads:  [-0.00799379 -6.63376343]
Stock Position:  -0.007993786492451074
Bond Position:  [12.05397132]


portfolio before change:  [11.31946129]
curr_Stock_Price:  93.77119527937897
curr_Factors:  [9.37711953e+01 5.19501247e-02]
mat_Sqrt:  [[ 2.13728634e+01 -9.10812494e-03]
 [-9.10812494e-03  2.08936188e-02]]
grads:  [ 0.00110996 -0.87767078]
Stock Position:  0.0011099636937724313
Bond Position:  [11.21537867]


portfolio before change:  [11.33466459]
curr_Stock_Price:  94.83006827379648
curr_Factors:  [9.48300683e+01 5.46441647e-02]
mat_Sqrt:  [[ 2.21675614e+01 -9.34140742e-03]
 [-9.34140742e-03  2.14284800e-02]]
grads:  [-0.00168084 -1.20468243]
Stock Position:  -0.0016808427424779052
Bond Position:  [11.49405902]


portfolio before change:  [11.34040892]
curr_Stock_Price:  99.96572032652644
curr_Factors:  [9.99657203e+01 4.99019104e-02]
mat_Sqrt:  [[ 2.23310761e+01 -8.92730867e-03]
 [-8.92730867e-03  2.04773598e-02]]
grads:  [ 0.00208688 -1.86911262]
Stock Position:  0.0020868842728424273
Bond Position:  [11.13179203]


portfolio before change:  [11.36638364]
curr_Stock_Price:  105.74049090282945
curr_Factors:  [1.05740491e+02 4.50670975e-02]
mat_Sqrt:  [[ 2.24476605e+01 -8.48425063e-03]
 [-8.48425063e-03  1.94599195e-02]]
grads:  [ 4.27757419e-04 -6.28719331e+00]
Stock Position:  0.0004277574187504407
Bond Position:  [11.32115236]


portfolio before change:  [11.37939336]
curr_Stock_Price:  103.05072107103567
curr_Factors:  [1.03050721e+02 5.26657876e-02]
mat_Sqrt:  [[ 2.36491368e+01 -9.17145349e-03]
 [-9.17145349e-03  2.10366898e-02]]
grads:  [3.56439364e-04 1.93649161e+00]
Stock Position:  0.00035643936422762474
Bond Position:  [11.34266203]


portfolio before change:  [11.3911033]
curr_Stock_Price:  96.10072740482296
curr_Factors:  [9.61007274e+01 5.66571040e-02]
mat_Sqrt:  [[ 2.28746166e+01 -9.51202865e-03]
 [-9.51202865e-03  2.18195406e-02]]
grads:  [-0.00690159 -6.37672062]
Stock Position:  -0.006901585251846294
Bond Position:  [12.05435067]


portfolio before change:  [11.3659155]
curr_Stock_Price:  101.93491748300993
curr_Factors:  [1.01934917e+02 5.17067408e-02]
mat_Sqrt:  [[ 2.31790976e+01 -9.08747509e-03]
 [-9.08747509e-03  2.08443087e-02]]
grads:  [9.11095189e-04 9.89994727e-01]
Stock Position:  0.0009110951891385927
Bond Position:  [11.27304309]


portfolio before change:  [11.38455209]
curr_Stock_Price:  106.91406080577107
curr_Factors:  [1.06914061e+02 4.71484143e-02]
mat_Sqrt:  [[ 2.32149814e+01 -8.67803444e-03]
 [-8.67803444e-03  1.99041669e-02]]
grads:  [-3.68064949e-03 -4.37820544e+00]
Stock Position:  -0.0036806494907206475
Bond Position:  [11.77806527]


portfolio before change:  [11.41034171]
curr_Stock_Price:  103.90974508212675
curr_Factors:  [1.03909745e+02 4.73124886e-02]
mat_Sqrt:  [[ 2.26018581e+01 -8.69290560e-03]
 [-8.69290560e-03  1.99388635e-02]]
grads:  [ 0.00480723 -3.05943994]
Stock Position:  0.004807234920931476
Bond Position:  [10.91082315]


portfolio before change:  [11.41361773]
curr_Stock_Price:  101.75236481840895
curr_Factors:  [1.01752365e+02 4.16651583e-02]
mat_Sqrt:  [[ 2.07697370e+01 -8.15746971e-03]
 [-8.15746971e-03  1.87111537e-02]]
grads:  [-1.66330866e-03 -6.55110422e+00]
Stock Position:  -0.0016633086599303264
Bond Position:  [11.58286332]


portfolio before change:  [11.434767]
curr_Stock_Price:  97.74731381377522
curr_Factors:  [9.77473138e+01 4.92812298e-02]
mat_Sqrt:  [[ 2.16992920e+01 -8.87143151e-03]
 [-8.87143151e-03  2.03496929e-02]]
grads:  [0.00389243 0.49435296]
Stock Position:  0.0038924264072602004
Bond Position:  [11.05429278]


portfolio before change:  [11.45335596]
curr_Stock_Price:  98.97083279430619
curr_Factors:  [9.89708328e+01 5.46821261e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.45335596]
Stock Price:  103.21605654214676
PL:  [8.23729942]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-3.44145816e-02 -6.97051179e-02]
 [ 1.24128837e-02 -7.68903448e-02]
 [ 5.75031033e-02 -1.99795883e-01]
 [-2.28056500e-02 -2.55707605e-02]
 [ 1.25297064e-01 -1.05098940e-01]
 [ 1.28341997e-01  1.30513194e-01]
 [ 2.87041525e-02  4.77442718e-02]
 [ 3.59686867e-02  1.09238263e-01]
 [ 7.27844317e-02  6.43464383e-02]
 [ 6.32985153e-02 -4.70059496e-02]
 [ 7.13454044e-02 -1.37703384e-01]
 [-1.07799433e-02  2.78584041e-02]
 [-1.00441222e-01 -1.39532355e-01]
 [ 5.64555775e-03  1.66409422e-01]
 [-1.08020566e-01  1.37162629e-01]
 [-1.14378561e-01  4.69282173e-02]
 [-7.77205406e-02  1.16396369e-01]
 [ 1.17151177e-01 -7.78844330e-02]
 [ 2.43431205e-02  5.72831295e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.66540141]
curr_Stock_Price:  101.6719615503989
curr_Factors:  [1.01671962e+02 3.87753659e-02]
mat_Sqrt:  [[ 2.00206937e+01 -7.86949013e-03]
 [-7.86949013e-03  1.80506173e-02]]
grads:  [-3.23739452e-03 -3.86305872e+00]
Stock Position:  -0.003237394515634521
Bond Position:  [12.99455366]


portfolio before change:  [12.6805501]
curr_Stock_Price:  102.0131813656144
curr_Factors:  [1.02013181e+02 4.23508351e-02]
mat_Sqrt:  [[ 2.09936159e+01 -8.22433780e-03]
 [-8.22433780e-03  1.88644803e-02]]
grads:  [-1.00566602e-03 -4.07637074e+00]
Stock Position:  -0.0010056660247563867
Bond Position:  [12.78314129]


portfolio before change:  [12.69477346]
curr_Stock_Price:  103.76879261619372
curr_Factors:  [1.03768793e+02 3.62861876e-02]
mat_Sqrt:  [[ 1.97668471e+01 -7.61284905e-03]
 [-7.61284905e-03  1.74615694e-02]]
grads:  [-1.49787930e-03 -1.14426877e+01]
Stock Position:  -0.001497879300804368
Bond Position:  [12.85020658]


portfolio before change:  [12.7103268]
curr_Stock_Price:  104.11558563498157
curr_Factors:  [1.04115586e+02 3.29815643e-02]
mat_Sqrt:  [[ 1.89082501e+01 -7.25794126e-03]
 [-7.25794126e-03  1.66474602e-02]]
grads:  [-0.00179602 -1.53679874]
Stock Position:  -0.0017960226214485417
Bond Position:  [12.89732075]


portfolio before change:  [12.72776481]
curr_Stock_Price:  103.38827277850898
curr_Factors:  [1.03388273e+02 2.74334996e-02]
mat_Sqrt:  [[ 1.71242616e+01 -6.61935606e-03]
 [-6.61935606e-03  1.51828562e-02]]
grads:  [ 4.64194485e-03 -6.92018765e+00]
Stock Position:  0.004641944852106796
Bond Position:  [12.24784214]


portfolio before change:  [12.72532033]
curr_Stock_Price:  99.56145993758278
curr_Factors:  [9.95614599e+01 2.90439604e-02]
mat_Sqrt:  [[ 1.69675501e+01 -6.81064538e-03]
 [-6.81064538e-03  1.56222506e-02]]
grads:  [0.01091924 8.35907479]
Stock Position:  0.010919236460350762
Bond Position:  [11.6381852]


portfolio before change:  [12.73128397]
curr_Stock_Price:  98.77448367832675
curr_Factors:  [9.87744837e+01 3.41190987e-02]
mat_Sqrt:  [[ 1.82449849e+01 -7.38169236e-03]
 [-7.38169236e-03  1.69322652e-02]]
grads:  [2.7145654e-03 2.8209049e+00]
Stock Position:  0.002714565395975366
Bond Position:  [12.46315418]


portfolio before change:  [12.74858027]
curr_Stock_Price:  99.40353818933599
curr_Factors:  [9.94035382e+01 3.33303141e-02]
mat_Sqrt:  [[ 1.81476967e+01 -7.29590916e-03]
 [-7.29590916e-03  1.67353772e-02]]
grads:  [4.60700636e-03 6.52939424e+00]
Stock Position:  0.004607006364505468
Bond Position:  [12.29062753]


portfolio before change:  [12.77679098]
curr_Stock_Price:  102.19012510993136
curr_Factors:  [1.02190125e+02 2.89400983e-02]
mat_Sqrt:  [[ 1.73843677e+01 -6.79861780e-03]
 [-6.79861780e-03  1.55942226e-02]]
grads:  [0.00580146 4.12882911]
Stock Position:  0.005801462821562562
Bond Position:  [12.18393877]


portfolio before change:  [12.80447583]
curr_Stock_Price:  104.33534273283469
curr_Factors:  [1.04335343e+02 2.90968963e-02]
mat_Sqrt:  [[ 1.77973257e+01 -6.81713606e-03]
 [-6.81713606e-03  1.56363557e-02]]
grads:  [ 2.40553095e-03 -3.00514722e+00]
Stock Position:  0.002405530954073793
Bond Position:  [12.55349393]


portfolio before change:  [12.81211491]
curr_Stock_Price:  100.98365323778697
curr_Factors:  [1.00983653e+02 3.05097989e-02]
mat_Sqrt:  [[ 1.76388683e+01 -6.98048581e-03]
 [-6.98048581e-03  1.60115835e-02]]
grads:  [ 6.41398100e-04 -8.59995557e+00]
Stock Position:  0.0006413980996612263
Bond Position:  [12.74734419]


portfolio before change:  [12.82519841]
curr_Stock_Price:  96.52363305458564
curr_Factors:  [9.65236331e+01 3.16176637e-02]
mat_Sqrt:  [[ 1.71632098e+01 -7.10579484e-03]
 [-7.10579484e-03  1.62998257e-02]]
grads:  [7.95293652e-05 1.70915750e+00]
Stock Position:  7.952936520160986e-05
Bond Position:  [12.81752195]


portfolio before change:  [12.84115395]
curr_Stock_Price:  95.56319255283293
curr_Factors:  [9.55631926e+01 3.28315380e-02]
mat_Sqrt:  [[ 1.73155474e+01 -7.24084497e-03]
 [-7.24084497e-03  1.66098027e-02]]
grads:  [-0.00931522 -8.40466366]
Stock Position:  -0.009315217388917408
Bond Position:  [13.73134586]


portfolio before change:  [12.88221426]
curr_Stock_Price:  92.99906552498173
curr_Factors:  [9.29990655e+01 3.86935481e-02]
mat_Sqrt:  [[ 1.82935428e+01 -7.86052291e-03]
 [-7.86052291e-03  1.80318513e-02]]
grads:  [4.27484847e-03 9.23050118e+00]
Stock Position:  0.004274848474830383
Bond Position:  [12.48465735]


portfolio before change:  [12.86530884]
curr_Stock_Price:  85.39154542928675
curr_Factors:  [8.53915454e+01 3.58878204e-02]
mat_Sqrt:  [[ 1.61766417e+01 -7.56950714e-03]
 [-7.56950714e-03  1.73660809e-02]]
grads:  [-2.98233214e-03  7.89700651e+00]
Stock Position:  -0.0029823321445442835
Bond Position:  [13.1199748]


portfolio before change:  [12.87496887]
curr_Stock_Price:  87.65494031230457
curr_Factors:  [8.76549403e+01 3.20850125e-02]
mat_Sqrt:  [[ 1.57010053e+01 -7.15743140e-03]
 [-7.15743140e-03  1.64201492e-02]]
grads:  [-0.00598315  2.85535732]
Stock Position:  -0.005983154269557794
Bond Position:  [13.3994219]


portfolio before change:  [12.88121672]
curr_Stock_Price:  89.41185748203206
curr_Factors:  [8.94118575e+01 3.47068142e-02]
mat_Sqrt:  [[ 1.66572172e+01 -7.44427449e-03]
 [-7.44427449e-03  1.70777902e-02]]
grads:  [-1.62020897e-03  6.81495127e+00]
Stock Position:  -0.0016202089671787498
Bond Position:  [13.02608261]


portfolio before change:  [12.89434773]
curr_Stock_Price:  91.36331725266145
curr_Factors:  [9.13633173e+01 3.36568610e-02]
mat_Sqrt:  [[ 1.67613356e+01 -7.33096774e-03]
 [-7.33096774e-03  1.68174172e-02]]
grads:  [ 0.00496476 -4.62901262]
Stock Position:  0.0049647615821480015
Bond Position:  [12.44075064]


portfolio before change:  [12.87333743]
curr_Stock_Price:  83.99721217509189
curr_Factors:  [8.39972122e+01 3.84340225e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.87333743]
Stock Price:  85.69310617837259
PL:  [12.87333743]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 8.15220790e-02 -2.79675446e-02]
 [ 6.87062185e-03 -8.35539767e-02]
 [ 6.23531196e-02 -1.69552435e-01]
 [-2.42915297e-02 -2.96094628e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.41897874e-01  4.56063274e-02]
 [ 5.44239664e-02  8.09876574e-02]
 [-1.88896377e-01  4.36778104e-02]
 [ 4.90290759e-02  3.96000358e-02]
 [ 7.52539806e-02 -5.63478932e-02]
 [ 1.32698257e-01 -1.11234025e-01]
 [ 4.14395529e-01 -2.26819324e-02]
 [ 1.53264689e-02  1.44157268e-01]
 [-4.47292672e-02 -1.48363369e-01]
 [ 2.67360439e-02 -1.28014477e-01]
 [ 2.08411420e-01 -1.50911821e-01]
 [ 1.42171627e-01 -1.51939907e-01]
 [-7.84779804e-02  4.18135509e-02]
 [-9.26021843e-02 -8.80547805e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.16079571]
curr_Stock_Price:  98.86422884573842
curr_Factors:  [9.88642288e+01 4.13203994e-02]
mat_Sqrt:  [[ 2.00965452e+01 -8.12343646e-03]
 [-8.12343646e-03  1.86336731e-02]]
grads:  [ 0.00345043 -1.49940997]
Stock Position:  0.0034504297540007296
Bond Position:  [1.81967163]


portfolio before change:  [2.17520399]
curr_Stock_Price:  102.38039107811657
curr_Factors:  [1.02380391e+02 3.65815169e-02]
mat_Sqrt:  [[ 1.95815743e+01 -7.64367484e-03]
 [-7.64367484e-03  1.75325242e-02]]
grads:  [-1.50966068e-03 -4.76631404e+00]
Stock Position:  -0.0015096606798472316
Bond Position:  [2.32976364]


portfolio before change:  [2.1769276]
curr_Stock_Price:  103.16892742419734
curr_Factors:  [1.03168927e+02 3.69255569e-02]
mat_Sqrt:  [[ 1.98249641e+01 -7.67958666e-03]
 [-7.67958666e-03  1.76147528e-02]]
grads:  [-5.83577705e-04 -9.62584706e+00]
Stock Position:  -0.0005835777047792634
Bond Position:  [2.23713468]


portfolio before change:  [2.17846362]
curr_Stock_Price:  105.33170372687857
curr_Factors:  [1.05331704e+02 3.68854283e-02]
mat_Sqrt:  [[ 2.02295626e+01 -7.67555256e-03]
 [-7.67555256e-03  1.76051179e-02]]
grads:  [-0.00183924 -1.68266865]
Stock Position:  -0.0018392360783238133
Bond Position:  [2.37219349]


portfolio before change:  [2.1656516]
curr_Stock_Price:  113.91087128044613
curr_Factors:  [1.13910871e+02 3.65232747e-02]
mat_Sqrt:  [[ 2.17695776e+01 -7.63827924e-03]
 [-7.63827924e-03  1.75182601e-02]]
grads:  [ 0.00753216 -6.73881916]
Stock Position:  0.007532162647344903
Bond Position:  [1.30765639]


portfolio before change:  [2.18030367]
curr_Stock_Price:  115.63899166775708
curr_Factors:  [1.15638992e+02 3.58690215e-02]
mat_Sqrt:  [[ 2.19010045e+01 -7.56964756e-03]
 [-7.56964756e-03  1.73606063e-02]]
grads:  [0.00738814 2.63022225]
Stock Position:  0.007388141906986605
Bond Position:  [1.32594639]


portfolio before change:  [2.19649693]
curr_Stock_Price:  117.60630431205843
curr_Factors:  [1.17606304e+02 3.63735673e-02]
mat_Sqrt:  [[ 2.24297031e+01 -7.62280125e-03]
 [-7.62280125e-03  1.74822359e-02]]
grads:  [4.00140900e-03 4.63431335e+00]
Stock Position:  0.004001408998667812
Bond Position:  [1.725906]


portfolio before change:  [2.17089854]
curr_Stock_Price:  110.66946895083953
curr_Factors:  [1.10669469e+02 3.69626420e-02]
mat_Sqrt:  [[ 2.12769465e+01 -7.68390438e-03]
 [-7.68390438e-03  1.76233945e-02]]
grads:  [-0.0079842   2.47491825]
Stock Position:  -0.007984197442727659
Bond Position:  [3.05450543]


portfolio before change:  [2.13243917]
curr_Stock_Price:  115.96491557153011
curr_Factors:  [1.15964916e+02 3.05667483e-02]
mat_Sqrt:  [[ 2.02745494e+01 -6.98781634e-03]
 [-6.98781634e-03  1.60261632e-02]]
grads:  [0.00327039 2.4723877 ]
Stock Position:  0.0032703891816743456
Bond Position:  [1.75318877]


portfolio before change:  [2.14567146]
curr_Stock_Price:  119.3404861442821
curr_Factors:  [1.19340486e+02 2.64657907e-02]
mat_Sqrt:  [[ 1.94146790e+01 -6.50232992e-03]
 [-6.50232992e-03  1.49123309e-02]]
grads:  [ 2.61099398e-03 -3.77747221e+00]
Stock Position:  0.002610993976043398
Bond Position:  [1.83407417]


portfolio before change:  [2.16335438]
curr_Stock_Price:  125.23436946935738
curr_Factors:  [1.25234369e+02 2.36114661e-02]
mat_Sqrt:  [[ 1.92435410e+01 -6.14191397e-03]
 [-6.14191397e-03  1.40851537e-02]]
grads:  [ 4.37579168e-03 -7.89534510e+00]
Stock Position:  0.004375791677301135
Bond Position:  [1.61535487]


portfolio before change:  [2.14977298]
curr_Stock_Price:  121.66887683699231
curr_Factors:  [1.21668877e+02 2.41838812e-02]
mat_Sqrt:  [[ 1.89209299e+01 -6.21578441e-03]
 [-6.21578441e-03  1.42549232e-02]]
grads:  [ 0.02138178 -1.58184141]
Stock Position:  0.021381779174494027
Bond Position:  [-0.45172408]


portfolio before change:  [2.052239]
curr_Stock_Price:  117.13375527064935
curr_Factors:  [1.17133755e+02 2.27708385e-02]
mat_Sqrt:  [[ 1.76754937e+01 -6.03128424e-03]
 [-6.03128424e-03  1.38322809e-02]]
grads:  [4.42391842e-03 1.04237292e+01]
Stock Position:  0.004423918424867299
Bond Position:  [1.53404883]


portfolio before change:  [2.06212141]
curr_Stock_Price:  118.93388850081257
curr_Factors:  [1.18933889e+02 1.73000511e-02]
mat_Sqrt:  [[ 1.56433329e+01 -5.25713486e-03]
 [-5.25713486e-03  1.20566598e-02]]
grads:  [-6.99576231e-03 -1.23085622e+01]
Stock Position:  -0.006995762307350928
Bond Position:  [2.89415462]


portfolio before change:  [2.05561962]
curr_Stock_Price:  120.38072720352498
curr_Factors:  [1.20380727e+02 1.43654161e-02]
mat_Sqrt:  [[ 1.44283292e+01 -4.79058499e-03]
 [-4.79058499e-03  1.09865580e-02]]
grads:  [-2.01601115e-03 -1.16527974e+01]
Stock Position:  -0.002016011146051345
Bond Position:  [2.29830851]


portfolio before change:  [2.06201394]
curr_Stock_Price:  118.63488407054484
curr_Factors:  [1.18634884e+02 1.06259155e-02]
mat_Sqrt:  [[ 1.22291301e+01 -4.12010003e-03]
 [-4.12010003e-03  9.44901744e-03]]
grads:  [ 1.16631005e-02 -1.59660799e+01]
Stock Position:  0.011663100508738823
Bond Position:  [0.67836337]


portfolio before change:  [2.07724295]
curr_Stock_Price:  119.86787691509262
curr_Factors:  [1.19867877e+02 1.28438818e-02]
mat_Sqrt:  [[ 1.35847277e+01 -4.52977030e-03]
 [-4.52977030e-03  1.03884551e-02]]
grads:  [ 5.58943556e-03 -1.46234052e+01]
Stock Position:  0.005589435560467919
Bond Position:  [1.40724917]


portfolio before change:  [2.05297877]
curr_Stock_Price:  115.21188971599983
curr_Factors:  [1.15211890e+02 1.64815224e-02]
mat_Sqrt:  [[ 1.47909455e+01 -5.13113311e-03]
 [-5.13113311e-03  1.17680371e-02]]
grads:  [-0.00407381  3.55136947]
Stock Position:  -0.004073805219845125
Bond Position:  [2.52232957]


portfolio before change:  [2.05975924]
curr_Stock_Price:  114.32191302526643
curr_Factors:  [1.14321913e+02 1.73664141e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.05975924]
Stock Price:  111.32979281891441
PL:  [-9.27003358]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-6.48008361e-03 -5.64298585e-02]
 [ 2.33027724e-02 -6.37970969e-02]
 [ 6.98555811e-02  1.87265793e-02]
 [-1.71299231e-02 -1.01438248e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.33967584e-01  7.70979220e-02]
 [ 5.44239664e-02  8.09876574e-02]
 [-2.80965528e-01  4.80098303e-02]
 [ 5.33288582e-02  4.15714078e-02]
 [ 6.03042398e-02 -2.94366569e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 2.13332427e-02  3.27072006e-02]
 [ 2.85536255e-02  7.29622144e-02]
 [ 2.45340154e-03 -1.76910767e-01]
 [-4.63470664e-02 -8.77218385e-02]
 [ 1.74155408e-01 -1.08834468e-01]
 [ 6.11272443e-02 -1.47008287e-01]
 [-5.47432998e-02  3.93212801e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.07276372]
curr_Stock_Price:  102.58270135864176
curr_Factors:  [1.02582701e+02 3.82737365e-02]
mat_Sqrt:  [[ 2.00689444e+01 -7.81848391e-03]
 [-7.81848391e-03  1.79334513e-02]]
grads:  [-1.54902048e-03 -3.14730102e+00]
Stock Position:  -0.0015490204845630905
Bond Position:  [16.23166642]


portfolio before change:  [16.0957864]
curr_Stock_Price:  100.82648564741278
curr_Factors:  [1.00826486e+02 3.94182476e-02]
mat_Sqrt:  [[ 2.00181183e+01 -7.93439868e-03]
 [-7.93439868e-03  1.81996647e-02]]
grads:  [-2.25358091e-04 -3.50549783e+00]
Stock Position:  -0.0002253580907394346
Bond Position:  [16.11850847]


portfolio before change:  [16.11616287]
curr_Stock_Price:  99.86917520819951
curr_Factors:  [9.98691752e+01 3.95514851e-02]
mat_Sqrt:  [[ 1.98615357e+01 -7.94772768e-03]
 [-7.94772768e-03  1.82304272e-02]]
grads:  [0.00392886 1.02892843]
Stock Position:  0.00392886154906834
Bond Position:  [15.72379071]


portfolio before change:  [16.14163952]
curr_Stock_Price:  101.34787751698379
curr_Factors:  [1.01347878e+02 4.16538013e-02]
mat_Sqrt:  [[ 2.06843532e+01 -8.15632856e-03]
 [-8.15632856e-03  1.87086161e-02]]
grads:  [-0.00104214 -0.54265504]
Stock Position:  -0.0010421401989638831
Bond Position:  [16.24725821]


portfolio before change:  [16.15657255]
curr_Stock_Price:  106.51871170353544
curr_Factors:  [1.06518712e+02 4.50418251e-02]
mat_Sqrt:  [[ 2.26065279e+01 -8.48192510e-03]
 [-8.48192510e-03  1.94544390e-02]]
grads:  [ 0.00725353 -6.06794139]
Stock Position:  0.007253531280823565
Bond Position:  [15.38393575]


portfolio before change:  [16.22509841]
curr_Stock_Price:  113.31318306419276
curr_Factors:  [1.13313183e+02 4.11566008e-02]
mat_Sqrt:  [[ 2.29879457e+01 -8.10827713e-03]
 [-8.10827713e-03  1.85962859e-02]]
grads:  [0.00729118 4.14905649]
Stock Position:  0.007291181477999292
Bond Position:  [15.39891143]


portfolio before change:  [16.23751703]
curr_Stock_Price:  112.37478198330786
curr_Factors:  [1.12374782e+02 4.53636196e-02]
mat_Sqrt:  [[ 2.39344077e+01 -8.51255151e-03]
 [-8.51255151e-03  1.95236437e-02]]
grads:  [3.74981120e-03 4.14981851e+00]
Stock Position:  0.003749811202699513
Bond Position:  [15.81613281]


portfolio before change:  [16.24100414]
curr_Stock_Price:  108.02911931538475
curr_Factors:  [1.08029119e+02 5.25641389e-02]
mat_Sqrt:  [[ 2.47676945e+01 -9.16297372e-03]
 [-9.16297372e-03  2.10162152e-02]]
grads:  [-0.01050059  2.27984027]
Stock Position:  -0.010500590230811787
Bond Position:  [17.37537366]


portfolio before change:  [16.25133375]
curr_Stock_Price:  109.11507635564196
curr_Factors:  [1.09115076e+02 5.72503461e-02]
mat_Sqrt:  [[ 2.61080112e+01 -9.56278489e-03]
 [-9.56278489e-03  2.19330027e-02]]
grads:  [0.0027373  1.89657497]
Stock Position:  0.0027372976114952096
Bond Position:  [15.95265331]


portfolio before change:  [16.27014333]
curr_Stock_Price:  108.69725424791048
curr_Factors:  [1.08697254e+02 6.17846469e-02]
mat_Sqrt:  [[ 2.70183503e+01 -9.93423002e-03]
 [-9.93423002e-03  2.27850289e-02]]
grads:  [ 0.00175723 -1.29116361]
Stock Position:  0.001757232506544551
Bond Position:  [16.07913698]


portfolio before change:  [16.28353404]
curr_Stock_Price:  104.87261754385295
curr_Factors:  [1.04872618e+02 7.10746779e-02]
mat_Sqrt:  [[ 2.79588643e+01 -1.06546216e-02]
 [-1.06546216e-02  2.44382040e-02]]
grads:  [ 3.43455349e-04 -5.00643358e+00]
Stock Position:  0.00034345534904219613
Bond Position:  [16.24751498]


portfolio before change:  [16.30472691]
curr_Stock_Price:  107.4079526078309
curr_Factors:  [1.07407953e+02 7.53752477e-02]
mat_Sqrt:  [[ 2.94883712e+01 -1.09724576e-02]
 [-1.09724576e-02  2.51665979e-02]]
grads:  [1.20722587e-03 1.30015376e+00]
Stock Position:  0.0012072258746496682
Bond Position:  [16.17506125]


portfolio before change:  [16.32853454]
curr_Stock_Price:  110.37025037157392
curr_Factors:  [1.10370250e+02 7.59429998e-02]
mat_Sqrt:  [[ 3.04155639e+01 -1.10139563e-02]
 [-1.10139563e-02  2.52610919e-02]]
grads:  [1.98500447e-03 2.88918932e+00]
Stock Position:  0.0019850044697625646
Bond Position:  [16.1094491]


portfolio before change:  [16.34672006]
curr_Stock_Price:  109.38088909859455
curr_Factors:  [1.09380889e+02 7.47975141e-02]
mat_Sqrt:  [[ 2.99147241e+01 -1.09304942e-02]
 [-1.09304942e-02  2.50698911e-02]]
grads:  [-2.49682212e-03 -7.05779129e+00]
Stock Position:  -0.002496822117502155
Bond Position:  [16.61982468]


portfolio before change:  [16.36696867]
curr_Stock_Price:  109.59682615045153
curr_Factors:  [1.09596826e+02 7.55992804e-02]
mat_Sqrt:  [[ 3.01339997e+01 -1.09889390e-02]
 [-1.09889390e-02  2.52038891e-02]]
grads:  [-2.80770532e-03 -3.48171236e+00]
Stock Position:  -0.0028077053157655463
Bond Position:  [16.67468426]


portfolio before change:  [16.37858521]
curr_Stock_Price:  112.88771457607885
curr_Factors:  [1.12887715e+02 6.77824252e-02]
mat_Sqrt:  [[ 2.93903803e+01 -1.04055745e-02]
 [-1.04055745e-02  2.38652105e-02]]
grads:  [ 4.31166856e-03 -4.55850170e+00]
Stock Position:  0.004311668563118663
Bond Position:  [15.8918508]


portfolio before change:  [16.39681321]
curr_Stock_Price:  112.50520819568513
curr_Factors:  [1.12505208e+02 6.54259797e-02]
mat_Sqrt:  [[ 2.87771458e+01 -1.02230723e-02]
 [-1.02230723e-02  2.34467181e-02]]
grads:  [-1.03232256e-04 -6.26993260e+00]
Stock Position:  -0.00010323225634871892
Bond Position:  [16.40842737]


portfolio before change:  [16.41744282]
curr_Stock_Price:  111.47589006541118
curr_Factors:  [1.1147589e+02 6.4151861e-02]
mat_Sqrt:  [[ 2.82348543e+01 -1.01229637e-02]
 [-1.01229637e-02  2.32173258e-02]]
grads:  [-1.33185547e-03  1.69303727e+00]
Stock Position:  -0.0013318554685287326
Bond Position:  [16.5659126]


portfolio before change:  [16.44514184]
curr_Stock_Price:  106.23607769236722
curr_Factors:  [1.06236078e+02 6.79893611e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.44514184]
Stock Price:  116.89995078976476
PL:  [-0.45480895]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-6.35577495e-02 -8.24698165e-02]
 [ 3.56410731e-02 -3.04227049e-02]
 [ 7.46195694e-02 -6.19307241e-02]
 [-1.53437151e-02 -5.28881372e-03]
 [-1.89828500e-01 -1.54410184e-03]
 [ 5.11402235e-02 -5.51699968e-02]
 [-9.84584367e-02 -1.23374618e-01]
 [ 3.25952235e-02 -1.45362336e-02]
 [-5.36193683e-02 -4.68644100e-02]
 [ 4.71985677e-02  2.52079464e-01]
 [ 5.54703694e-02 -1.01819723e-01]
 [ 1.30493485e-02 -5.13778185e-02]
 [-1.00779857e-01 -1.39580740e-01]
 [-1.43121767e-04  1.58797100e-01]
 [-1.04706906e-01  1.03221502e-01]
 [-7.36440176e-02  2.52769183e-02]
 [-9.01169957e-02  1.55420974e-01]
 [ 6.43210251e-02 -1.37701014e-01]
 [ 2.28342791e-02  5.72587714e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.77616431]
curr_Stock_Price:  100.6324234174766
curr_Factors:  [1.00632423e+02 3.61467693e-02]
mat_Sqrt:  [[ 1.91325405e+01 -7.59800097e-03]
 [-7.59800097e-03  1.74280829e-02]]
grads:  [-0.00520207 -4.73427526]
Stock Position:  -0.005202068050000558
Bond Position:  [9.29966103]


portfolio before change:  [8.79518806]
curr_Stock_Price:  99.21146895761207
curr_Factors:  [9.92114690e+01 3.68424282e-02]
mat_Sqrt:  [[ 1.90430263e+01 -7.67066582e-03]
 [-7.67066582e-03  1.75950325e-02]]
grads:  [ 1.17534011e-03 -1.72853840e+00]
Stock Position:  0.0011753401135750812
Bond Position:  [8.67858084]


portfolio before change:  [8.80827069]
curr_Stock_Price:  101.10676384467799
curr_Factors:  [1.01106764e+02 4.37641021e-02]
mat_Sqrt:  [[ 2.11514034e+01 -8.36036939e-03]
 [-8.36036939e-03  1.91766849e-02]]
grads:  [ 2.2517716e-03 -3.2284985e+00]
Stock Position:  0.0022517716010891334
Bond Position:  [8.58060135]


portfolio before change:  [8.81758753]
curr_Stock_Price:  100.47809718463053
curr_Factors:  [1.00478097e+02 4.44393594e-02]
mat_Sqrt:  [[ 2.11814293e+01 -8.42457283e-03]
 [-8.42457283e-03  1.93240826e-02]]
grads:  [-0.0008334  -0.27405362]
Stock Position:  -0.0008333951153737787
Bond Position:  [8.90132548]


portfolio before change:  [8.83213098]
curr_Stock_Price:  96.38659793464306
curr_Factors:  [9.63865979e+01 5.05796831e-02]
mat_Sqrt:  [[ 2.16772740e+01 -8.98742425e-03]
 [-8.98742425e-03  2.06160868e-02]]
grads:  [-0.00878967 -0.0787297 ]
Stock Position:  -0.008789669673572566
Bond Position:  [9.67933734]


portfolio before change:  [8.86799141]
curr_Stock_Price:  93.68414254464606
curr_Factors:  [9.36841425e+01 5.26746725e-02]
mat_Sqrt:  [[ 2.15014114e+01 -9.17141213e-03]
 [-9.17141213e-03  2.10388195e-02]]
grads:  [ 1.26015500e-03 -2.62174593e+00]
Stock Position:  0.0012601550003849677
Bond Position:  [8.74993487]


portfolio before change:  [8.8790682]
curr_Stock_Price:  93.78931758847024
curr_Factors:  [9.37893176e+01 5.16378417e-02]
mat_Sqrt:  [[ 2.13126463e+01 -9.08070996e-03]
 [-9.08070996e-03  2.08307255e-02]]
grads:  [-0.00714455 -5.92583758]
Stock Position:  -0.007144549152577517
Bond Position:  [9.54915059]


portfolio before change:  [8.91734768]
curr_Stock_Price:  90.10320927106785
curr_Factors:  [9.01032093e+01 5.30416656e-02]
mat_Sqrt:  [[ 2.07514665e+01 -9.20294851e-03]
 [-9.20294851e-03  2.11121386e-02]]
grads:  [ 0.00126564 -0.68797322]
Stock Position:  0.0012656378457864548
Bond Position:  [8.80330965]


portfolio before change:  [8.93202403]
curr_Stock_Price:  92.99924561203332
curr_Factors:  [9.29992456e+01 4.90020935e-02]
mat_Sqrt:  [[ 2.05866984e+01 -8.84584812e-03]
 [-8.84584812e-03  2.02921637e-02]]
grads:  [-0.00359759 -2.31105143]
Stock Position:  -0.0035975937813804717
Bond Position:  [9.26659754]


portfolio before change:  [8.94942927]
curr_Stock_Price:  91.38295665673938
curr_Factors:  [9.13829567e+01 5.34633245e-02]
mat_Sqrt:  [[ 2.11296909e+01 -9.23958739e-03]
 [-9.23958739e-03  2.11958314e-02]]
grads:  [7.43568917e-03 1.18961206e+01]
Stock Position:  0.00743568916633226
Bond Position:  [8.26993401]


portfolio before change:  [8.93970537]
curr_Stock_Price:  88.68410942478222
curr_Factors:  [8.86841094e+01 6.16603397e-02]
mat_Sqrt:  [[ 2.20215925e+01 -9.92234468e-03]
 [-9.92234468e-03  2.27629188e-02]]
grads:  [ 5.03568589e-04 -4.47283264e+00]
Stock Position:  0.0005035685887682904
Bond Position:  [8.89504684]


portfolio before change:  [8.95103414]
curr_Stock_Price:  89.0872501916162
curr_Factors:  [8.90872502e+01 6.23767347e-02]
mat_Sqrt:  [[ 2.22498367e+01 -9.97986578e-03]
 [-9.97986578e-03  2.28947511e-02]]
grads:  [-4.20145491e-04 -2.24427037e+00]
Stock Position:  -0.0004201454906743187
Bond Position:  [8.98846374]


portfolio before change:  [8.95956335]
curr_Stock_Price:  95.54546927170401
curr_Factors:  [9.55454693e+01 5.77282998e-02]
mat_Sqrt:  [[ 2.29564349e+01 -9.60147470e-03]
 [-9.60147470e-03  2.20248651e-02]]
grads:  [-0.00704194 -6.34048618]
Stock Position:  -0.007041941635397431
Bond Position:  [9.63238897]


portfolio before change:  [9.02054257]
curr_Stock_Price:  88.59693024777326
curr_Factors:  [8.85969302e+01 5.87407043e-02]
mat_Sqrt:  [[ 2.14727766e+01 -9.68457320e-03]
 [-9.68457320e-03  2.22174725e-02]]
grads:  [3.21756024e-03 7.14879967e+00]
Stock Position:  0.0032175602350724302
Bond Position:  [8.73547661]


portfolio before change:  [9.02661065]
curr_Stock_Price:  87.08706113272015
curr_Factors:  [8.70870611e+01 6.40552787e-02]
mat_Sqrt:  [[ 2.20409877e+01 -1.01130136e-02]
 [-1.01130136e-02  2.32008565e-02]]
grads:  [-2.70975446e-03  4.44785727e+00]
Stock Position:  -0.0027097544552885295
Bond Position:  [9.2625952]


portfolio before change:  [9.02949279]
curr_Stock_Price:  90.29891734702873
curr_Factors:  [9.02989173e+01 6.24545711e-02]
mat_Sqrt:  [[ 2.25665213e+01 -9.98622824e-03]
 [-9.98622824e-03  2.29089711e-02]]
grads:  [-0.00277569  1.10215337]
Stock Position:  -0.0027756897814771304
Bond Position:  [9.28013457]


portfolio before change:  [9.05121973]
curr_Stock_Price:  86.65315216359309
curr_Factors:  [8.66531522e+01 6.39456575e-02]
mat_Sqrt:  [[ 2.19123950e+01 -1.01043032e-02]
 [-1.01043032e-02  2.31810188e-02]]
grads:  [-1.02113534e-03  6.70422029e+00]
Stock Position:  -0.0010211353396570619
Bond Position:  [9.13970432]


portfolio before change:  [9.06481515]
curr_Stock_Price:  84.53428263539614
curr_Factors:  [8.45342826e+01 6.74240689e-02]
mat_Sqrt:  [[ 2.19502920e+01 -1.03752081e-02]
 [-1.03752081e-02  2.38032717e-02]]
grads:  [ 1.95975989e-04 -5.78487623e+00]
Stock Position:  0.0001959759891410625
Bond Position:  [9.04824846]


portfolio before change:  [9.07600305]
curr_Stock_Price:  83.87356399476462
curr_Factors:  [8.38735640e+01 6.50191087e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.07600305]
Stock Price:  83.2204729490558
PL:  [9.07600305]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.63180237e-01  2.29275039e-03]
 [-4.49811200e-02  6.55559833e-02]
 [ 5.78831572e-02  7.02704423e-02]
 [ 4.12552722e-03  1.12724854e-02]
 [-1.79158514e-01  2.11313704e-03]
 [ 2.71371328e-02 -1.43659608e-01]
 [-9.57798335e-02 -1.19769728e-01]
 [ 3.41494720e-02 -7.79032193e-03]
 [-4.60885986e-03 -8.74664452e-03]
 [ 4.99843861e-02  5.00028657e-02]
 [ 5.89155171e-02 -1.11284169e-01]
 [-9.08057333e-04 -2.71394605e-03]
 [-9.70066493e-02 -1.39041616e-01]
 [ 6.04752028e-03  1.39698120e-01]
 [-8.14484024e-02 -2.92151050e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 2.72988701e-03 -8.41538210e-02]
 [ 4.82112887e-02  4.78384111e-02]
 [-5.11241776e-02 -4.69208247e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.97002516]
curr_Stock_Price:  97.22554703772079
curr_Factors:  [9.72255470e+01 3.65926811e-02]
mat_Sqrt:  [[ 1.85984810e+01 -7.64447856e-03]
 [-7.64447856e-03  1.75353574e-02]]
grads:  [0.00882917 0.13459918]
Stock Position:  0.008829171494542936
Bond Position:  [-4.82844619]


portfolio before change:  [-3.99220665]
curr_Stock_Price:  95.39727126792192
curr_Factors:  [9.53972713e+01 3.57232242e-02]
mat_Sqrt:  [[ 1.80306440e+01 -7.55297829e-03]
 [-7.55297829e-03  1.73258408e-02]]
grads:  [-9.09885699e-04  3.78331485e+00]
Stock Position:  -0.0009098856985414456
Bond Position:  [-3.90540604]


portfolio before change:  [-3.99808802]
curr_Stock_Price:  96.49252765035207
curr_Factors:  [9.64925277e+01 3.53857041e-02]
mat_Sqrt:  [[ 1.81512930e+01 -7.51729450e-03]
 [-7.51729450e-03  1.72437619e-02]]
grads:  [0.00487751 4.07724883]
Stock Position:  0.004877505837866529
Bond Position:  [-4.46873089]


portfolio before change:  [-3.99134692]
curr_Stock_Price:  99.02056332994394
curr_Factors:  [9.90205633e+01 3.93003060e-02]
mat_Sqrt:  [[ 1.96301367e+01 -7.92238845e-03]
 [-7.92238845e-03  1.81724743e-02]]
grads:  [4.60588694e-04 6.20506280e-01]
Stock Position:  0.0004605886936774091
Bond Position:  [-4.03695467]


portfolio before change:  [-3.99790718]
curr_Stock_Price:  95.74015642548241
curr_Factors:  [9.57401564e+01 3.66737823e-02]
mat_Sqrt:  [[ 1.83346214e+01 -7.65283335e-03]
 [-7.65283335e-03  1.75548274e-02]]
grads:  [-0.00972312  0.11613487]
Stock Position:  -0.009723121598554926
Bond Position:  [-3.067014]


portfolio before change:  [-3.96310595]
curr_Stock_Price:  91.76639156000383
curr_Factors:  [9.17663916e+01 3.76451365e-02]
mat_Sqrt:  [[ 1.78048390e+01 -7.75319762e-03]
 [-7.75319762e-03  1.77859296e-02]]
grads:  [-1.99346587e-03 -8.07801823e+00]
Stock Position:  -0.0019934658711035277
Bond Position:  [-3.78017278]


portfolio before change:  [-3.97206368]
curr_Stock_Price:  93.88810216549862
curr_Factors:  [9.38881022e+01 3.79663658e-02]
mat_Sqrt:  [[ 1.82940573e+01 -7.78638231e-03]
 [-7.78638231e-03  1.78615763e-02]]
grads:  [-0.00809107 -6.70896713]
Stock Position:  -0.00809106553548375
Bond Position:  [-3.21240889]


portfolio before change:  [-3.98893501]
curr_Stock_Price:  95.47668290811345
curr_Factors:  [9.54766829e+01 3.24945158e-02]
mat_Sqrt:  [[ 1.7210850e+01 -7.2035785e-03]
 [-7.2035785e-03  1.6524334e-02]]
grads:  [ 0.00178719 -0.47066634]
Stock Position:  0.001787185997239527
Bond Position:  [-4.1595696]


portfolio before change:  [-3.99313396]
curr_Stock_Price:  96.03832477570211
curr_Factors:  [9.60383248e+01 3.00053009e-02]
mat_Sqrt:  [[ 1.66357939e+01 -6.92220868e-03]
 [-6.92220868e-03  1.58787920e-02]]
grads:  [-5.06342200e-04 -5.51058891e-01]
Stock Position:  -0.0005063422003950462
Bond Position:  [-3.94450571]


portfolio before change:  [-3.99825356]
curr_Stock_Price:  96.40542046142801
curr_Factors:  [9.64054205e+01 2.93129066e-02]
mat_Sqrt:  [[ 1.65055826e+01 -6.84189986e-03]
 [-6.84189986e-03  1.56945045e-02]]
grads:  [0.00434978 3.18790736]
Stock Position:  0.004349784605305308
Bond Position:  [-4.41759637]


portfolio before change:  [-4.00943564]
curr_Stock_Price:  95.1049796433391
curr_Factors:  [9.51049796e+01 2.82549622e-02]
mat_Sqrt:  [[ 1.59863966e+01 -6.71721108e-03]
 [-6.71721108e-03  1.54087215e-02]]
grads:  [ 6.50846217e-04 -7.22187092e+00]
Stock Position:  0.0006508462167695244
Bond Position:  [-4.07133436]


portfolio before change:  [-4.01582701]
curr_Stock_Price:  93.10908419242179
curr_Factors:  [9.31090842e+01 3.17778454e-02]
mat_Sqrt:  [[ 1.65979419e+01 -7.12352396e-03]
 [-7.12352396e-03  1.63411707e-02]]
grads:  [-1.26011131e-04 -1.66135202e-01]
Stock Position:  -0.00012601113080376754
Bond Position:  [-4.00409423]


portfolio before change:  [-4.02121225]
curr_Stock_Price:  96.1008131444624
curr_Factors:  [9.61008131e+01 3.36185902e-02]
mat_Sqrt:  [[ 1.76204410e+01 -7.32716062e-03]
 [-7.32716062e-03  1.68076952e-02]]
grads:  [-0.00894695 -8.27639778]
Stock Position:  -0.008946946637178455
Bond Position:  [-3.1614034]


portfolio before change:  [-4.03656957]
curr_Stock_Price:  97.37533652423339
curr_Factors:  [9.73753365e+01 3.46769209e-02]
mat_Sqrt:  [[ 1.81329807e+01 -7.44169120e-03]
 [-7.44169120e-03  1.70701623e-02]]
grads:  [3.69274747e-03 8.18537032e+00]
Stock Position:  0.0036927474718163483
Bond Position:  [-4.3961521]


portfolio before change:  [-4.05230202]
curr_Stock_Price:  94.60400644663862
curr_Factors:  [9.46040064e+01 3.97196496e-02]
mat_Sqrt:  [[ 1.88543773e+01 -7.96419930e-03]
 [-7.96419930e-03  1.82693192e-02]]
grads:  [-0.00499627 -1.60131288]
Stock Position:  -0.004996270932357222
Bond Position:  [-3.57963477]


portfolio before change:  [-4.09261887]
curr_Stock_Price:  101.77725817863255
curr_Factors:  [1.01777258e+02 3.56724675e-02]
mat_Sqrt:  [[ 1.92228284e+01 -7.54806485e-03]
 [-7.54806485e-03  1.73133299e-02]]
grads:  [ 0.00565231 -3.52334765]
Stock Position:  0.005652311156978561
Bond Position:  [-4.6678956]


portfolio before change:  [-4.1118164]
curr_Stock_Price:  99.41379747886741
curr_Factors:  [9.94137975e+01 3.59986656e-02]
mat_Sqrt:  [[ 1.88620908e+01 -7.58233481e-03]
 [-7.58233481e-03  1.73923792e-02]]
grads:  [-1.80062426e-03 -4.83933065e+00]
Stock Position:  -0.0018006242645339642
Bond Position:  [-3.9328095]


portfolio before change:  [-4.11704691]
curr_Stock_Price:  99.58674917868655
curr_Factors:  [9.95867492e+01 4.10057086e-02]
mat_Sqrt:  [[ 2.01661819e+01 -8.09249820e-03]
 [-8.09249820e-03  1.85625580e-02]]
grads:  [0.00342548 2.57863878]
Stock Position:  0.0034254832471995104
Bond Position:  [-4.45817965]


portfolio before change:  [-4.11862382]
curr_Stock_Price:  100.75426273875976
curr_Factors:  [1.00754263e+02 3.72002955e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.11862382]
Stock Price:  105.18121624391158
PL:  [-9.29984006]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.49110786e-01 -7.65605478e-03]
 [ 3.82513131e-02  6.43732278e-03]
 [ 6.12902134e-02  6.01433110e-02]
 [ 1.33967300e-02  1.89615581e-02]
 [-1.91798099e-01 -2.21920050e-03]
 [ 1.18729888e-01  1.00911003e-01]
 [ 2.45443094e-02  4.23675895e-02]
 [ 2.84995354e-02  1.08702918e-01]
 [ 5.08011320e-02  3.96968696e-02]
 [ 6.00288216e-02 -2.61302130e-02]
 [ 6.01373491e-02 -1.14640764e-01]
 [-1.07149586e-02  3.16575198e-02]
 [-6.02076418e-02 -1.20836884e-01]
 [ 1.11374007e-02  4.72197577e-02]
 [-8.27174645e-02 -2.57041432e-02]
 [-6.09742910e-02  1.85426820e-02]
 [-6.06590204e-02  7.00710162e-02]
 [ 1.04776052e-01 -2.74030521e-02]
 [ 1.29330264e-01  7.24319000e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.25908095]
curr_Stock_Price:  95.81185714443102
curr_Factors:  [9.58118571e+01 4.21873913e-02]
mat_Sqrt:  [[ 1.96793412e+01 -8.20797550e-03]
 [-8.20797550e-03  1.88282514e-02]]
grads:  [ 0.00740877 -0.40339613]
Stock Position:  0.007408770388976973
Bond Position:  [-9.968929]


portfolio before change:  [-9.25422613]
curr_Stock_Price:  98.15013517005664
curr_Factors:  [9.81501352e+01 3.70632026e-02]
mat_Sqrt:  [[ 1.88956718e+01 -7.69353753e-03]
 [-7.69353753e-03  1.76477054e-02]]
grads:  [0.00217325 0.36571569]
Stock Position:  0.002173246912557448
Bond Position:  [-9.46753061]


portfolio before change:  [-9.26756134]
curr_Stock_Price:  97.46296212131044
curr_Factors:  [9.74629621e+01 4.05858888e-02]
mat_Sqrt:  [[ 1.96348280e+01 -8.05080446e-03]
 [-8.05080446e-03  1.84673614e-02]]
grads:  [0.00445765 3.25867879]
Stock Position:  0.0044576504231025335
Bond Position:  [-9.70201716]


portfolio before change:  [-9.27564327]
curr_Stock_Price:  98.37222596978113
curr_Factors:  [9.83722260e+01 3.77394533e-02]
mat_Sqrt:  [[ 1.91104215e+01 -7.76342430e-03]
 [-7.76342430e-03  1.78079695e-02]]
grads:  [0.00113377 1.06527362]
Stock Position:  0.0011337741131588759
Bond Position:  [-9.38717515]


portfolio before change:  [-9.28948407]
curr_Stock_Price:  96.52044717755598
curr_Factors:  [9.65204472e+01 3.88515049e-02]
mat_Sqrt:  [[ 1.90249363e+01 -7.87683387e-03]
 [-7.87683387e-03  1.80684957e-02]]
grads:  [-0.01013409 -0.12723943]
Stock Position:  -0.010134086132865632
Bond Position:  [-8.31133755]


portfolio before change:  [-9.31742673]
curr_Stock_Price:  98.2519295354325
curr_Factors:  [9.82519295e+01 3.52760857e-02]
mat_Sqrt:  [[ 1.84536061e+01 -7.50576944e-03]
 [-7.50576944e-03  1.72169766e-02]]
grads:  [0.00881947 5.86497864]
Stock Position:  0.008819472159771618
Bond Position:  [-10.18395689]


portfolio before change:  [-9.31220133]
curr_Stock_Price:  100.28870729491794
curr_Factors:  [1.00288707e+02 3.45134027e-02]
mat_Sqrt:  [[ 1.86314171e+01 -7.42432775e-03]
 [-7.42432775e-03  1.70297793e-02]]
grads:  [2.30913302e-03 2.48885980e+00]
Stock Position:  0.002309133015763039
Bond Position:  [-9.5437813]


portfolio before change:  [-9.32573677]
curr_Stock_Price:  99.59656575226637
curr_Factors:  [9.95965658e+01 3.61439519e-02]
mat_Sqrt:  [[ 1.89348621e+01 -7.59763294e-03]
 [-7.59763294e-03  1.74274350e-02]]
grads:  [4.00862386e-03 6.23920697e+00]
Stock Position:  0.004008623855088837
Bond Position:  [-9.72498193]


portfolio before change:  [-9.33845032]
curr_Stock_Price:  99.45942994039567
curr_Factors:  [9.94594299e+01 3.65891503e-02]
mat_Sqrt:  [[ 1.90248873e+01 -7.64427147e-03]
 [-7.64427147e-03  1.75344409e-02]]
grads:  [0.00358053 2.26549797]
Stock Position:  0.003580531779261055
Bond Position:  [-9.69456797]


portfolio before change:  [-9.35210409]
curr_Stock_Price:  99.03268206386637
curr_Factors:  [9.90326821e+01 3.69292480e-02]
mat_Sqrt:  [[ 1.90310933e+01 -7.67968574e-03]
 [-7.67968574e-03  1.76157573e-02]]
grads:  [ 0.00255612 -1.4822288 ]
Stock Position:  0.0025561206355216803
Bond Position:  [-9.60524357]


portfolio before change:  [-9.36537738]
curr_Stock_Price:  98.54004861522921
curr_Factors:  [9.85400486e+01 3.71562641e-02]
mat_Sqrt:  [[ 1.89945390e+01 -7.70321873e-03]
 [-7.70321873e-03  1.76698348e-02]]
grads:  [ 5.34951270e-04 -6.48770315e+00]
Stock Position:  0.0005349512700536028
Bond Position:  [-9.41809151]


portfolio before change:  [-9.37792121]
curr_Stock_Price:  97.11215531245227
curr_Factors:  [9.71121553e+01 3.55142657e-02]
mat_Sqrt:  [[ 1.83010065e+01 -7.53098346e-03]
 [-7.53098346e-03  1.72750382e-02]]
grads:  [1.68655399e-04 1.83263212e+00]
Stock Position:  0.0001686553991466169
Bond Position:  [-9.3942997]


portfolio before change:  [-9.38902169]
curr_Stock_Price:  100.96460059928907
curr_Factors:  [1.00964601e+02 3.83425094e-02]
mat_Sqrt:  [[ 1.97701227e+01 -7.82539318e-03]
 [-7.82539318e-03  1.79496049e-02]]
grads:  [-5.71102856e-03 -6.73449782e+00]
Stock Position:  -0.005711028557746452
Bond Position:  [-8.81240998]


portfolio before change:  [-9.40089117]
curr_Stock_Price:  101.11292405165383
curr_Factors:  [1.01112924e+02 3.30731880e-02]
mat_Sqrt:  [[ 1.83884306e+01 -7.26782580e-03]
 [-7.26782580e-03  1.66706505e-02]]
grads:  [1.72548959e-03 2.83326066e+00]
Stock Position:  0.001725489590472878
Bond Position:  [-9.57536047]


portfolio before change:  [-9.42461059]
curr_Stock_Price:  94.307475629784
curr_Factors:  [9.43074756e+01 3.42670616e-02]
mat_Sqrt:  [[ 1.74575990e+01 -7.39735611e-03]
 [-7.39735611e-03  1.69690818e-02]]
grads:  [-0.00538104 -1.51710911]
Stock Position:  -0.005381041278214751
Bond Position:  [-8.91713817]


portfolio before change:  [-9.41885678]
curr_Stock_Price:  91.16548145310507
curr_Factors:  [9.11654815e+01 3.86077868e-02]
mat_Sqrt:  [[ 1.79129800e+01 -7.85165145e-03]
 [-7.85165145e-03  1.80119249e-02]]
grads:  [-0.00295324  1.02817963]
Stock Position:  -0.002953243002612018
Bond Position:  [-9.14962296]


portfolio before change:  [-9.43467447]
curr_Stock_Price:  92.6463992636994
curr_Factors:  [9.26463993e+01 3.58151800e-02]
mat_Sqrt:  [[ 1.75332358e+01 -7.56247761e-03]
 [-7.56247761e-03  1.73482199e-02]]
grads:  [-1.71783226e-03  4.03834086e+00]
Stock Position:  -0.001717832259447429
Bond Position:  [-9.2755235]


portfolio before change:  [-9.45130008]
curr_Stock_Price:  95.57099313468935
curr_Factors:  [9.55709931e+01 3.21307984e-02]
mat_Sqrt:  [[ 1.71311619e+01 -7.16315631e-03]
 [-7.16315631e-03  1.64315908e-02]]
grads:  [ 0.00541977 -1.66534268]
Stock Position:  0.005419769086668009
Bond Position:  [-9.9692728]


portfolio before change:  [-9.47470307]
curr_Stock_Price:  93.55363675650521
curr_Factors:  [9.35536368e+01 2.51954287e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.47470307]
Stock Price:  93.60809295378135
PL:  [-9.47470307]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.13581131e-02 -4.79641918e-02]
 [-1.57548677e-02 -1.10757298e-01]
 [ 6.81317125e-02  3.98085901e-02]
 [ 8.36154765e-03  1.47727178e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.27709473e-01  1.08108058e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-3.37077795e-01  5.06467806e-02]
 [ 6.88371084e-02  5.90777073e-02]
 [ 6.57855696e-02 -5.26588482e-02]
 [ 6.26149570e-02 -1.19743492e-01]
 [-1.07469948e-02  2.93367922e-02]
 [-8.39251282e-02 -1.37172500e-01]
 [ 1.07560014e-02  7.96818563e-02]
 [-4.84757471e-02 -8.90582099e-02]
 [ 6.67858709e-02 -4.32718160e-02]
 [-5.75352169e-02  6.43553344e-02]
 [ 1.06862735e-01 -3.21217842e-02]
 [ 1.03028677e-01  5.53534429e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.23925468]
curr_Stock_Price:  103.16177378557437
curr_Factors:  [1.03161774e+02 3.48392849e-02]
mat_Sqrt:  [[ 1.92554372e+01 -7.45948609e-03]
 [-7.45948609e-03  1.71099070e-02]]
grads:  [-4.96206520e-04 -2.80351573e+00]
Stock Position:  -0.0004962065203977957
Bond Position:  [18.29044422]


portfolio before change:  [18.26175523]
curr_Stock_Price:  103.92112049689555
curr_Factors:  [1.03921120e+02 3.82244673e-02]
mat_Sqrt:  [[ 2.03176984e+01 -7.81353983e-03]
 [-7.81353983e-03  1.79218657e-02]]
grads:  [-3.15258920e-03 -6.18138386e+00]
Stock Position:  -0.0031525892046690763
Bond Position:  [18.58937584]


portfolio before change:  [18.29922293]
curr_Stock_Price:  99.41166929169086
curr_Factors:  [9.94116693e+01 3.98143684e-02]
mat_Sqrt:  [[ 1.98361437e+01 -7.97406301e-03]
 [-7.97406301e-03  1.82909268e-02]]
grads:  [0.00431039 2.17829101]
Stock Position:  0.004310391343270619
Bond Position:  [17.87071973]


portfolio before change:  [18.31866932]
curr_Stock_Price:  98.73749096511189
curr_Factors:  [9.8737491e+01 4.3670189e-02]
mat_Sqrt:  [[ 2.06335801e+01 -8.35121283e-03]
 [-8.35121283e-03  1.91561775e-02]]
grads:  [7.17489924e-04 7.71485323e-01]
Stock Position:  0.0007174899235922464
Bond Position:  [18.24782617]


portfolio before change:  [18.34766671]
curr_Stock_Price:  107.3415766589542
curr_Factors:  [1.07341577e+02 4.40443312e-02]
mat_Sqrt:  [[ 2.25274975e+01 -8.38753442e-03]
 [-8.38753442e-03  1.92377904e-02]]
grads:  [ 0.00727895 -6.13630074]
Stock Position:  0.0072789508904327425
Bond Position:  [17.56633265]


portfolio before change:  [18.34461202]
curr_Stock_Price:  103.90339693314074
curr_Factors:  [1.03903397e+02 4.74760420e-02]
mat_Sqrt:  [[ 2.26395071e+01 -8.70791731e-03]
 [-8.70791731e-03  1.99732971e-02]]
grads:  [0.00772418 5.41599714]
Stock Position:  0.00772417562873393
Bond Position:  [17.54204393]


portfolio before change:  [18.38571091]
curr_Stock_Price:  106.38361289090291
curr_Factors:  [1.06383613e+02 4.74578952e-02]
mat_Sqrt:  [[ 2.31754909e+01 -8.70643186e-03]
 [-8.70643186e-03  1.99694015e-02]]
grads:  [3.87255502e-03 4.05727600e+00]
Stock Position:  0.0038725550183192074
Bond Position:  [17.97373451]


portfolio before change:  [18.40833244]
curr_Stock_Price:  106.41984703545212
curr_Factors:  [1.06419847e+02 5.08097895e-02]
mat_Sqrt:  [[ 2.39881247e+01 -9.00865165e-03]
 [-9.00865165e-03  2.06625770e-02]]
grads:  [-0.0131335   2.44540966]
Stock Position:  -0.013133496466626392
Bond Position:  [19.80599713]


portfolio before change:  [18.44199739]
curr_Stock_Price:  105.74280196479118
curr_Factors:  [1.05742802e+02 4.26954782e-02]
mat_Sqrt:  [[ 2.18495111e+01 -8.25799554e-03]
 [-8.25799554e-03  1.89409686e-02]]
grads:  [0.00433006 3.12093147]
Stock Position:  0.004330062403472241
Bond Position:  [17.98412446]


portfolio before change:  [18.45148143]
curr_Stock_Price:  102.73818736701745
curr_Factors:  [1.02738187e+02 4.08740387e-02]
mat_Sqrt:  [[ 2.07709156e+01 -8.07972311e-03]
 [-8.07972311e-03  1.85326323e-02]]
grads:  [ 2.06225910e-03 -2.84051314e+00]
Stock Position:  0.0020622591028348707
Bond Position:  [18.23960867]


portfolio before change:  [18.46682316]
curr_Stock_Price:  99.11495990861589
curr_Factors:  [9.91149599e+01 3.94554960e-02]
mat_Sqrt:  [[ 1.96876068e+01 -7.93802210e-03]
 [-7.93802210e-03  1.82083158e-02]]
grads:  [ 5.28957631e-04 -6.57607732e+00]
Stock Position:  0.0005289576307913605
Bond Position:  [18.41439555]


portfolio before change:  [18.48858586]
curr_Stock_Price:  96.71459827622685
curr_Factors:  [9.67145983e+01 4.31304413e-02]
mat_Sqrt:  [[ 2.00855601e+01 -8.29928238e-03]
 [-8.29928238e-03  1.90374979e-02]]
grads:  [1.01693489e-04 1.54104475e+00]
Stock Position:  0.00010169348895305196
Bond Position:  [18.47875061]


portfolio before change:  [18.51184543]
curr_Stock_Price:  98.15708065785977
curr_Factors:  [9.81570807e+01 4.26967733e-02]
mat_Sqrt:  [[ 2.02823898e+01 -8.25756806e-03]
 [-8.25756806e-03  1.89414969e-02]]
grads:  [-7.08748615e-03 -7.24499373e+00]
Stock Position:  -0.007087486153306571
Bond Position:  [19.20753238]


portfolio before change:  [18.52283637]
curr_Stock_Price:  99.99602484725514
curr_Factors:  [9.99960248e+01 4.02268801e-02]
mat_Sqrt:  [[ 2.00558409e+01 -8.01530885e-03]
 [-8.01530885e-03  1.83854188e-02]]
grads:  [2.26876742e-03 4.33495924e+00]
Stock Position:  0.0022687674186779826
Bond Position:  [18.29596864]


portfolio before change:  [18.55305137]
curr_Stock_Price:  103.2271815540993
curr_Factors:  [1.03227182e+02 4.32804124e-02]
mat_Sqrt:  [[ 2.14753244e+01 -8.31419548e-03]
 [-8.31419548e-03  1.90703507e-02]]
grads:  [-4.06595186e-03 -4.67175545e+00]
Stock Position:  -0.004065951860766954
Bond Position:  [18.97276812]


portfolio before change:  [18.6009002]
curr_Stock_Price:  97.29547358764852
curr_Factors:  [9.72954736e+01 4.24691495e-02]
mat_Sqrt:  [[ 2.00506927e+01 -8.23545934e-03]
 [-8.23545934e-03  1.88909688e-02]]
grads:  [ 0.00239045 -2.2895665 ]
Stock Position:  0.0023904530248674365
Bond Position:  [18.36831994]


portfolio before change:  [18.61368115]
curr_Stock_Price:  93.03109090871176
curr_Factors:  [9.30310909e+01 4.61268234e-02]
mat_Sqrt:  [[ 1.99804308e+01 -8.58240651e-03]
 [-8.58240651e-03  1.96878270e-02]]
grads:  [-1.47577749e-03  3.26814476e+00]
Stock Position:  -0.0014757774924724488
Bond Position:  [18.75097434]


portfolio before change:  [18.6339082]
curr_Stock_Price:  95.217272326099
curr_Factors:  [9.52172723e+01 4.44180291e-02]
mat_Sqrt:  [[ 2.00675956e+01 -8.42212661e-03]
 [-8.42212661e-03  1.93196293e-02]]
grads:  [ 0.00462819 -1.66063254]
Stock Position:  0.004628191612221273
Bond Position:  [18.19322442]


portfolio before change:  [18.65617685]
curr_Stock_Price:  95.1120257782015
curr_Factors:  [9.51120258e+01 4.14002320e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.65617685]
Stock Price:  94.33456415672133
PL:  [18.65617685]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 5.35189777e-02 -2.72253709e-02]
 [-2.36176353e-01 -2.19383345e-01]
 [-2.25597479e-01 -2.00500391e-01]
 [ 1.35353361e-02  1.90659466e-02]
 [-1.44319072e-01 -6.01497248e-02]
 [ 1.27321977e-01  1.24947408e-01]
 [ 2.70748715e-02  4.56383928e-02]
 [-7.50861513e-02  9.26889403e-02]
 [ 7.79233060e-02  7.00593710e-02]
 [ 6.11293485e-02 -3.62527659e-02]
 [ 6.76578654e-02 -1.30695865e-01]
 [-8.04672601e-03  4.66363430e-02]
 [ 2.04240245e-02 -1.84184550e-02]
 [ 1.35499712e-02 -8.58985215e-02]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.51655418e-01 -8.11972746e-02]
 [ 3.47578748e-02 -1.46841415e-01]
 [ 2.35134749e-02  4.35318908e-02]
 [-8.52263118e-02 -7.89630413e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.82458879]
curr_Stock_Price:  104.65465469020216
curr_Factors:  [1.04654655e+02 3.80223706e-02]
mat_Sqrt:  [[ 2.04069506e+01 -7.79290509e-03]
 [-7.79290509e-03  1.78744045e-02]]
grads:  [ 0.00204127 -1.52225846]
Stock Position:  0.002041273235714485
Bond Position:  [23.61096005]


portfolio before change:  [23.86422702]
curr_Stock_Price:  109.6055215123176
curr_Factors:  [1.09605522e+02 3.92605029e-02]
mat_Sqrt:  [[ 2.17175251e+01 -7.91908289e-03]
 [-7.91908289e-03  1.81629611e-02]]
grads:  [ -0.0152817  -12.08527404]
Stock Position:  -0.01528169705758597
Bond Position:  [25.53918539]


portfolio before change:  [23.93480313]
curr_Stock_Price:  107.07751915481442
curr_Factors:  [1.07077519e+02 3.76039160e-02]
mat_Sqrt:  [[ 2.07641811e+01 -7.75005757e-03]
 [-7.75005757e-03  1.77757072e-02]]
grads:  [ -0.01507716 -11.28603419]
Stock Position:  -0.015077160644713936
Bond Position:  [25.54922808]


portfolio before change:  [24.0979946]
curr_Stock_Price:  98.37329580308112
curr_Factors:  [9.83732958e+01 4.18752038e-02]
mat_Sqrt:  [[ 2.01305506e+01 -8.17775304e-03]
 [-8.17775304e-03  1.87583686e-02]]
grads:  [0.00108547 1.01687005]
Stock Position:  0.0010854669962378526
Bond Position:  [23.99121364]


portfolio before change:  [24.13004503]
curr_Stock_Price:  100.25511702052337
curr_Factors:  [1.00255117e+02 4.05495134e-02]
mat_Sqrt:  [[ 2.01882808e+01 -8.04740646e-03]
 [-8.04740646e-03  1.84589919e-02]]
grads:  [-0.00844904 -3.26224302]
Stock Position:  -0.008449043730161324
Bond Position:  [24.97710489]


portfolio before change:  [24.14999476]
curr_Stock_Price:  101.59150062963117
curr_Factors:  [1.01591501e+02 4.56771716e-02]
mat_Sqrt:  [[ 2.17123556e+01 -8.54118118e-03]
 [-8.54118118e-03  1.95913231e-02]]
grads:  [0.00837432 6.3813421 ]
Stock Position:  0.008374318235475882
Bond Position:  [23.29923521]


portfolio before change:  [24.15957658]
curr_Stock_Price:  99.25573582917791
curr_Factors:  [9.92557358e+01 4.14432957e-02]
mat_Sqrt:  [[ 2.02061104e+01 -8.13553769e-03]
 [-8.13553769e-03  1.86613500e-02]]
grads:  [2.32501322e-03 2.44662407e+00]
Stock Position:  0.0023250132247985837
Bond Position:  [23.92880568]


portfolio before change:  [24.19324898]
curr_Stock_Price:  100.86548593320148
curr_Factors:  [1.00865486e+02 4.03597240e-02]
mat_Sqrt:  [[ 2.02636019e+01 -8.02859606e-03]
 [-8.02859606e-03  1.84157239e-02]]
grads:  [-1.71159520e-03  5.03239511e+00]
Stock Position:  -0.0017115952017061518
Bond Position:  [24.36588986]


portfolio before change:  [24.22037081]
curr_Stock_Price:  102.82539993097483
curr_Factors:  [1.02825400e+02 3.93435783e-02]
mat_Sqrt:  [[ 2.03956384e+01 -7.92702009e-03]
 [-7.92702009e-03  1.81823578e-02]]
grads:  [0.00531906 3.85547001]
Stock Position:  0.005319063435694336
Bond Position:  [23.67343598]


portfolio before change:  [24.27254203]
curr_Stock_Price:  107.06692161496231
curr_Factors:  [1.07066922e+02 3.71206122e-02]
mat_Sqrt:  [[ 2.06282721e+01 -7.70009210e-03]
 [-7.70009210e-03  1.76611071e-02]]
grads:  [ 0.00219751 -2.05173122]
Stock Position:  0.0021975097577702127
Bond Position:  [24.03726142]


portfolio before change:  [24.29121978]
curr_Stock_Price:  101.88486770615373
curr_Factors:  [1.01884868e+02 3.57709443e-02]
mat_Sqrt:  [[ 1.92696956e+01 -7.55848337e-03]
 [-7.55848337e-03  1.73372077e-02]]
grads:  [ 5.54256783e-04 -7.53821939e+00]
Stock Position:  0.0005542567833838918
Bond Position:  [24.2347494]


portfolio before change:  [24.32359833]
curr_Stock_Price:  105.61270508835025
curr_Factors:  [1.05612705e+02 3.86600516e-02]
mat_Sqrt:  [[ 2.07657370e+01 -7.85804397e-03]
 [-7.85804397e-03  1.80236417e-02]]
grads:  [5.91747077e-04 2.58776743e+00]
Stock Position:  0.0005917470767977617
Bond Position:  [24.26110233]


portfolio before change:  [24.35297825]
curr_Stock_Price:  103.9812193242062
curr_Factors:  [1.03981219e+02 3.70961853e-02]
mat_Sqrt:  [[ 2.00271661e+01 -7.69736279e-03]
 [-7.69736279e-03  1.76553804e-02]]
grads:  [ 6.18962008e-04 -1.04295066e+00]
Stock Position:  0.0006189620083674324
Bond Position:  [24.28861782]


portfolio before change:  [24.3843449]
curr_Stock_Price:  105.57565381662025
curr_Factors:  [1.05575654e+02 3.46678616e-02]
mat_Sqrt:  [[ 1.96574544e+01 -7.44126267e-03]
 [-7.44126267e-03  1.70676954e-02]]
grads:  [-1.21605056e-03 -5.03334331e+00]
Stock Position:  -0.001216050561328982
Bond Position:  [24.51273023]


portfolio before change:  [24.4147295]
curr_Stock_Price:  105.80218344886636
curr_Factors:  [1.05802183e+02 3.50037937e-02]
mat_Sqrt:  [[ 1.97948474e+01 -7.47724260e-03]
 [-7.47724260e-03  1.71501831e-02]]
grads:  [-4.31657527e-03 -5.08127912e+00]
Stock Position:  -0.004316575273246137
Bond Position:  [24.87143259]


portfolio before change:  [24.42943885]
curr_Stock_Price:  109.6013480515263
curr_Factors:  [1.09601348e+02 3.66975615e-02]
mat_Sqrt:  [[ 2.09958988e+01 -7.65624019e-03]
 [-7.65624019e-03  1.75601139e-02]]
grads:  [ 0.00553783 -4.62154608]
Stock Position:  0.005537831557769886
Bond Position:  [23.82248504]


portfolio before change:  [24.4373183]
curr_Stock_Price:  105.64361307459536
curr_Factors:  [1.05643613e+02 3.39368423e-02]
mat_Sqrt:  [[ 1.94616174e+01 -7.36239416e-03]
 [-7.36239416e-03  1.68867870e-02]]
grads:  [-1.50386675e-03 -8.69629533e+00]
Stock Position:  -0.0015038667470377847
Bond Position:  [24.59619222]


portfolio before change:  [24.47345152]
curr_Stock_Price:  102.07364479336321
curr_Factors:  [1.02073645e+02 3.72725236e-02]
mat_Sqrt:  [[ 1.97064315e+01 -7.71550898e-03]
 [-7.71550898e-03  1.76973489e-02]]
grads:  [2.15662167e-03 2.46073751e+00]
Stock Position:  0.002156621667401749
Bond Position:  [24.25331729]


portfolio before change:  [24.50606724]
curr_Stock_Price:  103.13090812786471
curr_Factors:  [1.03130908e+02 3.40831190e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [24.50606724]
Stock Price:  104.12309561842066
PL:  [20.38297162]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.70354701e-01  4.57480824e-03]
 [ 2.33027724e-02 -6.37970969e-02]
 [ 6.22405088e-02 -1.70329384e-01]
 [ 3.83812113e-03  1.10410745e-02]
 [-2.04521302e-01 -2.53567713e-02]
 [ 9.26056573e-02  4.02746407e-02]
 [ 2.49338257e-02  4.28710472e-02]
 [ 3.16281546e-02 -1.87336069e-02]
 [-5.68122770e-02 -4.92513637e-02]
 [ 3.76913608e-02  1.84794484e-01]
 [ 5.73254532e-02 -1.06915975e-01]
 [ 1.02700073e-02 -4.08053474e-02]
 [-1.80208629e-01 -1.11149759e-01]
 [ 1.70330592e-03  1.61225219e-01]
 [-1.08257519e-01  1.33313964e-01]
 [-2.25746951e-01  1.06122947e-01]
 [-1.10443574e-01  2.19409969e-01]
 [ 5.49764277e-02 -1.42169678e-01]
 [-4.52099735e-03  5.69879121e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.32830469]
curr_Stock_Price:  97.93164159944165
curr_Factors:  [9.79316416e+01 3.98586653e-02]
mat_Sqrt:  [[ 1.95516932e+01 -7.97838661e-03]
 [-7.97838661e-03  1.83011475e-02]]
grads:  [0.00881662 0.25381745]
Stock Position:  0.008816615141058677
Bond Position:  [-2.19173028]


portfolio before change:  [-1.3115577]
curr_Stock_Price:  100.14205500796395
curr_Factors:  [1.00142055e+02 3.58983018e-02]
mat_Sqrt:  [[ 1.89737606e+01 -7.57180844e-03]
 [-7.57180844e-03  1.73680953e-02]]
grads:  [-2.37751747e-04 -3.67333872e+00]
Stock Position:  -0.00023775174672060537
Bond Position:  [-1.28774875]


portfolio before change:  [-1.31389145]
curr_Stock_Price:  103.18328739156671
curr_Factors:  [1.03183287e+02 3.43785510e-02]
mat_Sqrt:  [[ 1.91316802e+01 -7.40999912e-03]
 [-7.40999912e-03  1.69963944e-02]]
grads:  [-6.28320902e-04 -1.00217749e+01]
Stock Position:  -0.0006283209021166723
Bond Position:  [-1.24905924]


portfolio before change:  [-1.31284641]
curr_Stock_Price:  99.03358212585572
curr_Factors:  [9.90335821e+01 3.66128654e-02]
mat_Sqrt:  [[ 1.89495679e+01 -7.64671809e-03]
 [-7.64671809e-03  1.75401356e-02]]
grads:  [4.56636280e-04 6.29673937e-01]
Stock Position:  0.0004566362800388003
Bond Position:  [-1.35806873]


portfolio before change:  [-1.31474545]
curr_Stock_Price:  98.59472503086046
curr_Factors:  [9.85947250e+01 3.69119979e-02]
mat_Sqrt:  [[ 1.89425054e+01 -7.67786035e-03]
 [-7.67786035e-03  1.76116563e-02]]
grads:  [-0.01138254 -1.44473435]
Stock Position:  -0.011382537079444881
Bond Position:  [-0.19248734]


portfolio before change:  [-1.29099726]
curr_Stock_Price:  96.48720244379224
curr_Factors:  [9.64872024e+01 4.40920674e-02]
mat_Sqrt:  [[ 2.02604883e+01 -8.39127303e-03]
 [-8.39127303e-03  1.92485639e-02]]
grads:  [0.00543832 2.09471602]
Stock Position:  0.005438318642175379
Bond Position:  [-1.81572541]


portfolio before change:  [-1.2745127]
curr_Stock_Price:  99.93599443734588
curr_Factors:  [9.99359944e+01 4.49432220e-02]
mat_Sqrt:  [[ 2.11862458e+01 -8.47215609e-03]
 [-8.47215609e-03  1.94333423e-02]]
grads:  [2.05942507e-03 2.20695413e+00]
Stock Position:  0.002059425067169285
Bond Position:  [-1.48032339]


portfolio before change:  [-1.28832599]
curr_Stock_Price:  94.1277121373336
curr_Factors:  [9.41277121e+01 4.99262044e-02]
mat_Sqrt:  [[ 2.10320565e+01 -8.92897410e-03]
 [-8.92897410e-03  2.04825649e-02]]
grads:  [ 0.00111572 -0.91412597]
Stock Position:  0.0011157229219629077
Bond Position:  [-1.39334643]


portfolio before change:  [-1.29151816]
curr_Stock_Price:  92.82864426273012
curr_Factors:  [9.28286443e+01 4.55465369e-02]
mat_Sqrt:  [[ 1.98111483e+01 -8.52823297e-03]
 [-8.52823297e-03  1.95636042e-02]]
grads:  [-0.00395216 -2.51922233]
Stock Position:  -0.0039521581927153835
Bond Position:  [-0.92464467]


portfolio before change:  [-1.2957066]
curr_Stock_Price:  93.59579818377587
curr_Factors:  [9.35957982e+01 4.25052295e-02]
mat_Sqrt:  [[ 1.92964534e+01 -8.23865031e-03]
 [-8.23865031e-03  1.88991253e-02]]
grads:  [6.12912573e-03 9.78061033e+00]
Stock Position:  0.006129125733540946
Bond Position:  [-1.86936702]


portfolio before change:  [-1.31255365]
curr_Stock_Price:  91.22859584014131
curr_Factors:  [9.12285958e+01 4.36252475e-02]
mat_Sqrt:  [[ 1.90546028e+01 -8.34627736e-03]
 [-8.34627736e-03  1.91465958e-02]]
grads:  [ 5.62661117e-04 -5.58382703e+00]
Stock Position:  0.000562661117388658
Bond Position:  [-1.36388443]


portfolio before change:  [-1.31500013]
curr_Stock_Price:  89.91242237238738
curr_Factors:  [8.99124224e+01 4.43424901e-02]
mat_Sqrt:  [[ 1.89334473e+01 -8.41448456e-03]
 [-8.41448456e-03  1.93034026e-02]]
grads:  [-3.97116162e-04 -2.11406713e+00]
Stock Position:  -0.0003971161622860557
Bond Position:  [-1.27929446]


portfolio before change:  [-1.31435048]
curr_Stock_Price:  84.24714541084681
curr_Factors:  [8.42471454e+01 4.67470433e-02]
mat_Sqrt:  [[ 1.82151277e+01 -8.63902655e-03]
 [-8.63902655e-03  1.98201325e-02]]
grads:  [-0.01255566 -5.61339474]
Stock Position:  -0.012555656999489455
Bond Position:  [-0.25657222]


portfolio before change:  [-1.38104497]
curr_Stock_Price:  89.53349403325831
curr_Factors:  [8.95334940e+01 3.95983136e-02]
mat_Sqrt:  [[ 1.78165592e+01 -7.95158951e-03]
 [-7.95158951e-03  1.82415833e-02]]
grads:  [4.04096668e-03 8.84009619e+00]
Stock Position:  0.004040966682699391
Bond Position:  [-1.74284684]


portfolio before change:  [-1.39911474]
curr_Stock_Price:  85.60130469910295
curr_Factors:  [8.56013047e+01 3.87445702e-02]
mat_Sqrt:  [[ 1.68494512e+01 -7.86503440e-03]
 [-7.86503440e-03  1.80440277e-02]]
grads:  [-2.97688079e-03  7.38696218e+00]
Stock Position:  -0.002976880785440557
Bond Position:  [-1.14428986]


portfolio before change:  [-1.38477152]
curr_Stock_Price:  80.30231123049141
curr_Factors:  [8.03023112e+01 4.24361318e-02]
mat_Sqrt:  [[ 1.65422998e+01 -8.23061791e-03]
 [-8.23061791e-03  1.88843387e-02]]
grads:  [-0.01085296  5.61489724]
Stock Position:  -0.010852957541470079
Bond Position:  [-0.51325395]


portfolio before change:  [-1.40568201]
curr_Stock_Price:  82.16986824427856
curr_Factors:  [8.21698682e+01 4.20304127e-02]
mat_Sqrt:  [[ 1.68459058e+01 -8.19139048e-03]
 [-8.19139048e-03  1.87937556e-02]]
grads:  [-8.79462178e-04  1.16742374e+01]
Stock Position:  -0.0008794621784567209
Bond Position:  [-1.33341672]


portfolio before change:  [-1.40873553]
curr_Stock_Price:  83.74549348405117
curr_Factors:  [8.37454935e+01 4.57653633e-02]
mat_Sqrt:  [[ 1.79155380e+01 -8.54778057e-03]
 [-8.54778057e-03  1.96109429e-02]]
grads:  [-3.90288359e-04 -7.24967763e+00]
Stock Position:  -0.0003902883586955952
Bond Position:  [-1.37605063]


portfolio before change:  [-1.40974357]
curr_Stock_Price:  81.91840535589249
curr_Factors:  [8.19184054e+01 5.20276052e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.40974357]
Stock Price:  87.13921675787695
PL:  [-1.40974357]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.41733264e-01 -1.34843682e-02]
 [ 4.48910444e-02 -1.94903711e-03]
 [ 6.08979359e-02 -1.79256421e-01]
 [ 2.07117399e-02  2.31616581e-02]
 [-1.86327828e-01 -4.52847998e-02]
 [ 1.27855780e-01  1.30755611e-01]
 [ 2.96973947e-02  4.90280577e-02]
 [-2.99407515e-01  5.80878036e-02]
 [ 5.28850521e-02  4.13678562e-02]
 [ 6.25589196e-02 -4.53249008e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [-1.07097751e-02  3.63470842e-02]
 [ 3.45170155e-02  2.71103795e-02]
 [ 1.34675746e-02 -6.82200180e-02]
 [-6.15567776e-02 -8.28757265e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 2.00042063e-02 -1.24828642e-01]
 [ 2.11095179e-03  3.79448072e-02]
 [-9.21586057e-02 -8.73232388e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.06188464]
curr_Stock_Price:  95.06270731288664
curr_Factors:  [9.50627073e+01 4.51387039e-02]
mat_Sqrt:  [[ 2.01968985e+01 -8.49016219e-03]
 [-8.49016219e-03  1.94757332e-02]]
grads:  [ 0.00672776 -0.68943481]
Stock Position:  0.006727758264856147
Bond Position:  [-12.70144355]


portfolio before change:  [-12.05530774]
curr_Stock_Price:  98.40165409067983
curr_Factors:  [9.84016541e+01 4.55280775e-02]
mat_Sqrt:  [[ 2.09962637e+01 -8.52698103e-03]
 [-8.52698103e-03  1.95594317e-02]]
grads:  [ 0.00209795 -0.09873231]
Stock Position:  0.0020979521130946328
Bond Position:  [-12.2617497]


portfolio before change:  [-12.06023485]
curr_Stock_Price:  103.3634753348106
curr_Factors:  [1.03363475e+02 4.19370880e-02]
mat_Sqrt:  [[ 2.11673361e+01 -8.18416129e-03]
 [-8.18416129e-03  1.87720639e-02]]
grads:  [-8.15236905e-04 -9.54946104e+00]
Stock Position:  -0.0008152369045737329
Bond Position:  [-11.97596913]


portfolio before change:  [-12.07056714]
curr_Stock_Price:  97.6632492490206
curr_Factors:  [9.76632492e+01 4.47742663e-02]
mat_Sqrt:  [[ 2.06654740e+01 -8.45603601e-03]
 [-8.45603601e-03  1.93968585e-02]]
grads:  [0.00149111 1.19474332]
Stock Position:  0.0014911118092863732
Bond Position:  [-12.21619396]


portfolio before change:  [-12.08315795]
curr_Stock_Price:  99.46658765043608
curr_Factors:  [9.94665877e+01 4.95787355e-02]
mat_Sqrt:  [[ 2.21475100e+01 -8.89831328e-03]
 [-8.89831328e-03  2.04109622e-02]]
grads:  [-0.00930607 -2.22270796]
Stock Position:  -0.009306065512873017
Bond Position:  [-11.15751537]


portfolio before change:  [-12.09972929]
curr_Stock_Price:  99.74766554872075
curr_Factors:  [9.97476655e+01 4.90606055e-02]
mat_Sqrt:  [[ 2.20937359e+01 -8.85171755e-03]
 [-8.85171755e-03  2.03040181e-02]]
grads:  [0.00836853 6.44353676]
Stock Position:  0.008368532517059121
Bond Position:  [-12.93447088]


portfolio before change:  [-12.09695894]
curr_Stock_Price:  102.01192712488431
curr_Factors:  [1.02011927e+02 5.08700823e-02]
mat_Sqrt:  [[ 2.30081732e+01 -9.01365988e-03]
 [-9.01365988e-03  2.06749791e-02]]
grads:  [2.22011784e-03 2.37233948e+00]
Stock Position:  0.002220117842123803
Bond Position:  [-12.32343744]


portfolio before change:  [-12.10618434]
curr_Stock_Price:  104.79940560004881
curr_Factors:  [1.04799406e+02 5.03126375e-02]
mat_Sqrt:  [[ 2.35070067e+01 -8.96435113e-03]
 [-8.96435113e-03  2.05612934e-02]]
grads:  [-0.01166154  2.82002034]
Stock Position:  -0.011661538469622566
Bond Position:  [-10.88406204]


portfolio before change:  [-12.17834285]
curr_Stock_Price:  109.81974830056325
curr_Factors:  [1.09819748e+02 4.98393126e-02]
mat_Sqrt:  [[ 2.45169498e+01 -8.92244109e-03]
 [-8.92244109e-03  2.04641924e-02]]
grads:  [0.00289321 2.02273659]
Stock Position:  0.002893214727457291
Bond Position:  [-12.49607496]


portfolio before change:  [-12.20868546]
curr_Stock_Price:  104.73448539085689
curr_Factors:  [1.04734485e+02 5.35990534e-02]
mat_Sqrt:  [[ 2.42475705e+01 -9.25249036e-03]
 [-9.25249036e-03  2.12222043e-02]]
grads:  [ 1.76534051e-03 -2.13496046e+00]
Stock Position:  0.001765340511662165
Bond Position:  [-12.39357749]


portfolio before change:  [-12.22143258]
curr_Stock_Price:  106.294834056672
curr_Factors:  [1.06294834e+02 5.54250868e-02]
mat_Sqrt:  [[ 2.50244948e+01 -9.40889989e-03]
 [-9.40889989e-03  2.15806272e-02]]
grads:  [ 3.83698386e-04 -5.66935768e+00]
Stock Position:  0.0003836983863142847
Bond Position:  [-12.26221773]


portfolio before change:  [-12.2388582]
curr_Stock_Price:  100.85237114404089
curr_Factors:  [1.00852371e+02 5.60845513e-02]
mat_Sqrt:  [[ 2.38840353e+01 -9.46426927e-03]
 [-9.46426927e-03  2.17088259e-02]]
grads:  [2.15086647e-04 1.67439363e+00]
Stock Position:  0.00021508664679855996
Bond Position:  [-12.26055019]


portfolio before change:  [-12.25309764]
curr_Stock_Price:  105.94719118748019
curr_Factors:  [1.05947191e+02 4.89377902e-02]
mat_Sqrt:  [[ 2.34375167e+01 -8.84110617e-03]
 [-8.84110617e-03  2.02783812e-02]]
grads:  [0.00197736 1.33777254]
Stock Position:  0.0019773598558061366
Bond Position:  [-12.46259336]


portfolio before change:  [-12.27065729]
curr_Stock_Price:  104.95007004096564
curr_Factors:  [1.04950070e+02 4.31312382e-02]
mat_Sqrt:  [[ 2.17960936e+01 -8.29997577e-03]
 [-8.29997577e-03  1.90374049e-02]]
grads:  [-7.46824804e-04 -3.58379817e+00]
Stock Position:  -0.0007468248042951221
Bond Position:  [-12.19227797]


portfolio before change:  [-12.28161875]
curr_Stock_Price:  99.20787931962047
curr_Factors:  [9.92078793e+01 4.78937193e-02]
mat_Sqrt:  [[ 2.17112792e+01 -8.74577314e-03]
 [-8.74577314e-03  2.00611227e-02]]
grads:  [-0.00450016 -4.1331228 ]
Stock Position:  -0.004500155469555565
Bond Position:  [-11.83516787]


portfolio before change:  [-12.3054339]
curr_Stock_Price:  101.21046157787615
curr_Factors:  [1.01210462e+02 5.53758679e-02]
mat_Sqrt:  [[ 2.38169226e+01 -9.40431422e-03]
 [-9.40431422e-03  2.15712205e-02]]
grads:  [ 0.00456204 -2.82787159]
Stock Position:  0.0045620365433747595
Bond Position:  [-12.76715972]


portfolio before change:  [-12.31696063]
curr_Stock_Price:  102.18419204542664
curr_Factors:  [1.02184192e+02 5.57789086e-02]
mat_Sqrt:  [[ 2.41334099e+01 -9.43855715e-03]
 [-9.43855715e-03  2.16495433e-02]]
grads:  [-1.42637279e-03 -5.76650061e+00]
Stock Position:  -0.0014263727924951912
Bond Position:  [-12.17120788]


portfolio before change:  [-12.33519118]
curr_Stock_Price:  104.29235805442958
curr_Factors:  [1.04292358e+02 5.01023051e-02]
mat_Sqrt:  [[ 2.33443243e+01 -8.94555572e-03]
 [-8.94555572e-03  2.05182866e-02]]
grads:  [7.99219241e-04 1.84966501e+00]
Stock Position:  0.0007992192407823982
Bond Position:  [-12.41854364]


portfolio before change:  [-12.3430339]
curr_Stock_Price:  113.91446248741389
curr_Factors:  [1.13914462e+02 5.01359103e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.3430339]
Stock Price:  115.39639634580371
PL:  [-27.73943024]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.57388445e-01 -1.11645544e-03]
 [ 3.69198887e-02 -2.76847410e-02]
 [-3.67995475e-01 -1.43086404e-01]
 [-2.23093848e-02 -2.42218845e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26868664e-01  1.06621314e-01]
 [ 2.85297149e-02  4.75188076e-02]
 [-2.68397961e-01  6.28498970e-02]
 [ 8.34160631e-02  7.61652994e-02]
 [ 6.03786267e-02 -3.00511567e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 2.30762334e-01  3.39782631e-03]
 [ 1.92117404e-02  1.23244829e-01]
 [-4.55360637e-02 -1.46971637e-01]
 [-1.30707535e-02 -1.06070138e-01]
 [ 2.09504145e-01 -1.52254037e-01]
 [ 1.53898068e-01 -1.50926558e-01]
 [-1.30128793e-01  4.70878951e-02]
 [-1.13956369e-01 -1.31111113e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.14385098]
curr_Stock_Price:  96.6445141056845
curr_Factors:  [9.66445141e+01 4.30349783e-02]
mat_Sqrt:  [[ 2.00487806e+01 -8.29008696e-03]
 [-8.29008696e-03  1.90164203e-02]]
grads:  [ 0.00782741 -0.05529776]
Stock Position:  0.007827409800718789
Bond Position:  [-6.9003272]


portfolio before change:  [-6.13299873]
curr_Stock_Price:  99.13359457235387
curr_Factors:  [9.91335946e+01 4.54643026e-02]
mat_Sqrt:  [[ 2.11376200e+01 -8.52106528e-03]
 [-8.52106528e-03  1.95457022e-02]]
grads:  [ 1.17586223e-03 -1.41589804e+00]
Stock Position:  0.0011758622342132377
Bond Position:  [-6.24956618]


portfolio before change:  [-6.12945508]
curr_Stock_Price:  108.79500951124544
curr_Factors:  [1.08795010e+02 4.20919424e-02]
mat_Sqrt:  [[ 2.23207318e+01 -8.19962026e-03]
 [-8.19962026e-03  1.88065322e-02]]
grads:  [-0.01928476 -7.61674352]
Stock Position:  -0.019284756608441228
Bond Position:  [-4.0313698]


portfolio before change:  [-6.03999967]
curr_Stock_Price:  103.89488166738104
curr_Factors:  [1.03894882e+02 4.58923504e-02]
mat_Sqrt:  [[ 2.22568793e+01 -8.56144681e-03]
 [-8.56144681e-03  1.96373403e-02]]
grads:  [-0.00147708 -1.23410452]
Stock Position:  -0.001477076121968972
Bond Position:  [-5.88653902]


portfolio before change:  [-6.05152254]
curr_Stock_Price:  106.71132486653423
curr_Factors:  [1.06711325e+02 4.40025864e-02]
mat_Sqrt:  [[ 2.23846127e+01 -8.38351642e-03]
 [-8.38351642e-03  1.92286899e-02]]
grads:  [ 0.00732543 -6.13918614]
Stock Position:  0.0073254344942342365
Bond Position:  [-6.83322936]


portfolio before change:  [-6.07470787]
curr_Stock_Price:  104.71302046092855
curr_Factors:  [1.04713020e+02 4.02572167e-02]
mat_Sqrt:  [[ 2.10098295e+01 -8.01866142e-03]
 [-8.01866142e-03  1.83922059e-02]]
grads:  [0.00825244 5.80069017]
Stock Position:  0.008252443674846068
Bond Position:  [-6.93884617]


portfolio before change:  [-6.10890385]
curr_Stock_Price:  101.62096691927296
curr_Factors:  [1.01620967e+02 4.55868340e-02]
mat_Sqrt:  [[ 2.16971657e+01 -8.53273311e-03]
 [-8.53273311e-03  1.95719392e-02]]
grads:  [2.27010408e-03 2.42889461e+00]
Stock Position:  0.0022701040816247996
Bond Position:  [-6.33959402]


portfolio before change:  [-6.11140517]
curr_Stock_Price:  104.01210253420372
curr_Factors:  [1.04012103e+02 4.61321934e-02]
mat_Sqrt:  [[ 2.23401403e+01 -8.58379814e-03]
 [-8.58379814e-03  1.96885841e-02]]
grads:  [-0.01078942  3.18749599]
Stock Position:  -0.010789419240413661
Bond Position:  [-4.98917499]


portfolio before change:  [-6.1121237]
curr_Stock_Price:  103.50032008647439
curr_Factors:  [1.03500320e+02 4.45189807e-02]
mat_Sqrt:  [[ 2.18380706e+01 -8.43234096e-03]
 [-8.43234096e-03  1.93412883e-02]]
grads:  [0.00534122 3.94029277]
Stock Position:  0.0053412207138796115
Bond Position:  [-6.66494175]


portfolio before change:  [-6.09322165]
curr_Stock_Price:  108.59998446291685
curr_Factors:  [1.08599984e+02 4.11991831e-02]
mat_Sqrt:  [[ 2.20431693e+01 -8.11218604e-03]
 [-8.11218604e-03  1.86060277e-02]]
grads:  [ 0.00214506 -1.61419492]
Stock Position:  0.002145062561106861
Bond Position:  [-6.32617542]


portfolio before change:  [-6.09510246]
curr_Stock_Price:  111.41195896393313
curr_Factors:  [1.11411959e+02 3.69162212e-02]
mat_Sqrt:  [[ 2.14062406e+01 -7.67912017e-03]
 [-7.67912017e-03  1.76123061e-02]]
grads:  [ 4.48433399e-04 -6.94675988e+00]
Stock Position:  0.0004484333986881588
Bond Position:  [-6.1450633]


portfolio before change:  [-6.10114774]
curr_Stock_Price:  115.0710275209615
curr_Factors:  [1.15071028e+02 3.36036186e-02]
mat_Sqrt:  [[ 2.10940023e+01 -7.32667994e-03]
 [-7.32667994e-03  1.68034504e-02]]
grads:  [0.01101162 0.20701135]
Stock Position:  0.011011615403884055
Bond Position:  [-7.36826564]


portfolio before change:  [-6.10961395]
curr_Stock_Price:  115.1391262058231
curr_Factors:  [1.15139126e+02 3.23739255e-02]
mat_Sqrt:  [[ 2.07167004e+01 -7.19137744e-03]
 [-7.19137744e-03  1.64931303e-02]]
grads:  [3.52181148e-03 7.47403029e+00]
Stock Position:  0.0035218114793621937
Bond Position:  [-6.51511225]


portfolio before change:  [-6.10375952]
curr_Stock_Price:  119.11532440371346
curr_Factors:  [1.19115324e+02 2.99113193e-02]
mat_Sqrt:  [[ 2.06008622e+01 -6.91263647e-03]
 [-6.91263647e-03  1.58533482e-02]]
grads:  [-5.32196582e-03 -9.27302069e+00]
Stock Position:  -0.005321965822375121
Bond Position:  [-5.46983183]


portfolio before change:  [-6.08596149]
curr_Stock_Price:  114.48553332071846
curr_Factors:  [1.14485533e+02 3.04007408e-02]
mat_Sqrt:  [[ 1.99614768e+01 -6.96874403e-03]
 [-6.96874403e-03  1.59826160e-02]]
grads:  [-2.97215039e-03 -6.63789018e+00]
Stock Position:  -0.002972150391416688
Bond Position:  [-5.74569327]


portfolio before change:  [-6.10567017]
curr_Stock_Price:  118.69866801113757
curr_Factors:  [1.18698668e+02 2.55972713e-02]
mat_Sqrt:  [[ 1.89907736e+01 -6.39472094e-03]
 [-6.39472094e-03  1.46656148e-02]]
grads:  [ 7.53719037e-03 -1.03784152e+01]
Stock Position:  0.007537190365379386
Bond Position:  [-7.00032463]


portfolio before change:  [-6.08783411]
curr_Stock_Price:  122.2267651666908
curr_Factors:  [1.22226765e+02 2.39596847e-02]
mat_Sqrt:  [[ 1.89193775e+01 -6.18692689e-03]
 [-6.18692689e-03  1.41886850e-02]]
grads:  [ 4.65658175e-03 -1.06350763e+01]
Stock Position:  0.004656581752631432
Bond Position:  [-6.65699303]


portfolio before change:  [-6.09157679]
curr_Stock_Price:  123.21112697067711
curr_Factors:  [1.23211127e+02 2.22431780e-02]
mat_Sqrt:  [[ 1.83758876e+01 -5.96122418e-03]
 [-5.96122418e-03  1.36709761e-02]]
grads:  [-0.00596497  3.44176863]
Stock Position:  -0.005964971119391057
Bond Position:  [-5.35662598]


portfolio before change:  [-6.09420633]
curr_Stock_Price:  122.52873809922313
curr_Factors:  [1.22528738e+02 2.34710947e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.09420633]
Stock Price:  118.1507750370214
PL:  [-24.24498137]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.46678004e-01 -9.57812736e-03]
 [ 4.39100910e-02 -8.18026558e-03]
 [ 6.39961867e-02  5.21004683e-02]
 [-5.97402482e-02 -2.96951565e-02]
 [-1.95248339e-01 -3.95581010e-02]
 [ 5.47660508e-02 -4.37754589e-02]
 [-1.71854712e-01 -2.22079706e-01]
 [ 3.15885728e-02 -1.89054043e-02]
 [-1.51753016e-01 -1.20371002e-01]
 [ 5.51299821e-02  2.86083279e-01]
 [ 5.48044233e-02 -9.99902481e-02]
 [ 2.33017907e-02 -9.03775818e-02]
 [-1.70141045e-01 -1.15770943e-01]
 [-3.83835058e-04  1.58480553e-01]
 [-1.04151075e-01  9.89045228e-02]
 [-1.25040147e-01  5.25950829e-02]
 [-9.33379953e-02  1.65560828e-01]
 [ 5.35791036e-02 -1.42649088e-01]
 [ 3.38709998e-02  5.73811229e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.15682577]
curr_Stock_Price:  95.57190263639134
curr_Factors:  [9.55719026e+01 3.94308791e-02]
mat_Sqrt:  [[ 1.89779118e+01 -7.93527356e-03]
 [-7.93527356e-03  1.82027532e-02]]
grads:  [ 0.00751023 -0.52291714]
Stock Position:  0.007510231649721613
Bond Position:  [-10.8745929]


portfolio before change:  [-10.14788705]
curr_Stock_Price:  98.57320251333094
curr_Factors:  [9.85732025e+01 3.93954161e-02]
mat_Sqrt:  [[ 1.95650822e+01 -7.93193579e-03]
 [-7.93193579e-03  1.81944650e-02]]
grads:  [ 0.0020624  -0.44870277]
Stock Position:  0.0020623991817200213
Bond Position:  [-10.35118434]


portfolio before change:  [-10.16153427]
curr_Stock_Price:  98.2337221391935
curr_Factors:  [9.82337221e+01 4.00889824e-02]
mat_Sqrt:  [[ 1.96685833e+01 -8.00142735e-03]
 [-8.00142735e-03  1.83539365e-02]]
grads:  [0.00440931 2.84057587]
Stock Position:  0.004409308319042681
Bond Position:  [-10.59467703]


portfolio before change:  [-10.18881173]
curr_Stock_Price:  95.05276101785685
curr_Factors:  [9.50527610e+01 4.21431821e-02]
mat_Sqrt:  [[ 1.95131939e+01 -8.20361107e-03]
 [-8.20361107e-03  1.88184108e-02]]
grads:  [-0.00372562 -1.57960841]
Stock Position:  -0.003725619784102411
Bond Position:  [-9.83468128]


portfolio before change:  [-10.2165943]
curr_Stock_Price:  99.20818656463938
curr_Factors:  [9.92081866e+01 3.84085118e-02]
mat_Sqrt:  [[ 1.94429078e+01 -7.83199978e-03]
 [-7.83199978e-03  1.79651022e-02]]
grads:  [-0.01093104 -2.20670678]
Stock Position:  -0.010931043284297818
Bond Position:  [-9.13214532]


portfolio before change:  [-10.17073775]
curr_Stock_Price:  93.96816805983542
curr_Factors:  [9.39681681e+01 4.17190984e-02]
mat_Sqrt:  [[ 1.91932349e+01 -8.16213978e-03]
 [-8.16213978e-03  1.87235269e-02]]
grads:  [ 1.85949104e-03 -2.33718155e+00]
Stock Position:  0.0018594910416255864
Bond Position:  [-10.34547072]


portfolio before change:  [-10.18866459]
curr_Stock_Price:  91.28630096402296
curr_Factors:  [9.12863010e+01 4.12388086e-02]
mat_Sqrt:  [[ 1.85378184e+01 -8.11478825e-03]
 [-8.11478825e-03  1.86155391e-02]]
grads:  [ -0.01449544 -11.9361213 ]
Stock Position:  -0.014495438640194883
Bond Position:  [-8.86542961]


portfolio before change:  [-10.24223017]
curr_Stock_Price:  94.21666194965579
curr_Factors:  [9.42166619e+01 3.99536671e-02]
mat_Sqrt:  [[ 1.88324142e+01 -7.98759453e-03]
 [-7.98759453e-03  1.83230730e-02]]
grads:  [ 0.00123996 -1.03124077]
Stock Position:  0.0012399599622735797
Bond Position:  [-10.35905506]


portfolio before change:  [-10.26315584]
curr_Stock_Price:  87.79004110947149
curr_Factors:  [8.77900411e+01 4.47534718e-02]
mat_Sqrt:  [[ 1.85719957e+01 -8.45318068e-03]
 [-8.45318068e-03  1.93927423e-02]]
grads:  [-0.01099842 -6.21180708]
Stock Position:  -0.010998416491624507
Bond Position:  [-9.2976044]


portfolio before change:  [-10.29860719]
curr_Stock_Price:  89.95599643680193
curr_Factors:  [8.99559964e+01 4.37433522e-02]
mat_Sqrt:  [[ 1.88142152e+01 -8.35744879e-03]
 [-8.35744879e-03  1.91725473e-02]]
grads:  [9.56035271e-03 1.49256734e+01]
Stock Position:  0.009560352710457333
Bond Position:  [-11.15861824]


portfolio before change:  [-10.33356113]
curr_Stock_Price:  87.7597437626079
curr_Factors:  [8.77597438e+01 4.20423011e-02]
mat_Sqrt:  [[ 1.79944485e+01 -8.19313043e-03]
 [-8.19313043e-03  1.87961598e-02]]
grads:  [ 6.23609917e-04 -5.31944502e+00]
Stock Position:  0.0006236099174650937
Bond Position:  [-10.38828898]


portfolio before change:  [-10.34770404]
curr_Stock_Price:  85.91656036146895
curr_Factors:  [8.59165604e+01 4.36012216e-02]
mat_Sqrt:  [[ 1.79401539e+01 -8.34346092e-03]
 [-8.34346092e-03  1.91415484e-02]]
grads:  [-8.97174836e-04 -4.72193082e+00]
Stock Position:  -0.000897174835508802
Bond Position:  [-10.27062187]


portfolio before change:  [-10.36030016]
curr_Stock_Price:  85.63769538719681
curr_Factors:  [8.56376954e+01 3.91192195e-02]
mat_Sqrt:  [[ 1.69379176e+01 -7.90297287e-03]
 [-7.90297287e-03  1.81310566e-02]]
grads:  [-0.01302688 -6.39090687]
Stock Position:  -0.013026879371493745
Bond Position:  [-9.24470823]


portfolio before change:  [-10.40579199]
curr_Stock_Price:  88.24221199498045
curr_Factors:  [8.82422120e+01 3.65791169e-02]
mat_Sqrt:  [[ 1.68769106e+01 -7.64232874e-03]
 [-7.64232874e-03  1.75324265e-02]]
grads:  [4.07129575e-03 9.04105696e+00]
Stock Position:  0.004071295752033754
Bond Position:  [-10.76505213]


portfolio before change:  [-10.42316877]
curr_Stock_Price:  87.28132647960987
curr_Factors:  [8.72813265e+01 3.46182385e-02]
mat_Sqrt:  [[ 1.62395420e+01 -7.43458324e-03]
 [-7.43458324e-03  1.70560651e-02]]
grads:  [-3.75944583e-03  5.79715029e+00]
Stock Position:  -0.0037594458289512233
Bond Position:  [-10.09503935]


portfolio before change:  [-10.43455725]
curr_Stock_Price:  86.95196638774057
curr_Factors:  [8.69519664e+01 3.23887701e-02]
mat_Sqrt:  [[ 1.56486397e+01 -7.19117153e-03]
 [-7.19117153e-03  1.64977196e-02]]
grads:  [-0.00652677  3.18517643]
Stock Position:  -0.006526765188431718
Bond Position:  [-9.86704218]


portfolio before change:  [-10.44042716]
curr_Stock_Price:  85.96041786169236
curr_Factors:  [8.59604179e+01 2.97103082e-02]
mat_Sqrt:  [[ 1.48167192e+01 -6.88732730e-03]
 [-6.88732730e-03  1.58008799e-02]]
grads:  [-1.42927833e-03  1.04773269e+01]
Stock Position:  -0.0014292783307882837
Bond Position:  [-10.31756579]


portfolio before change:  [-10.45003534]
curr_Stock_Price:  83.65377139599711
curr_Factors:  [8.36537714e+01 3.04629889e-02]
mat_Sqrt:  [[ 1.46006346e+01 -6.97381854e-03]
 [-6.97381854e-03  1.59998670e-02]]
grads:  [-5.88930358e-04 -8.91589883e+00]
Stock Position:  -0.0005889303582493845
Bond Position:  [-10.40076909]


portfolio before change:  [-10.46365135]
curr_Stock_Price:  84.68432700436168
curr_Factors:  [8.46843270e+01 3.23705387e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.46365135]
Stock Price:  87.27780279347334
PL:  [-10.46365135]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.56032510e-01 -2.18768140e-03]
 [ 1.31421272e-03  5.21566721e-02]
 [ 5.09267132e-02  9.09461665e-02]
 [-2.03103135e-02 -1.87882995e-02]
 [ 2.05591309e-01 -1.16687747e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-1.79513137e-01  7.65251658e-02]
 [ 7.22240184e-02  6.37237806e-02]
 [ 6.40933738e-02 -4.12187124e-02]
 [ 7.05185756e-02 -1.36003746e-01]
 [-1.07049036e-02  3.66476277e-02]
 [-4.71749679e-03 -5.46854915e-02]
 [ 1.17475315e-02  2.79683871e-02]
 [-5.59415588e-02 -9.33442213e-02]
 [ 8.46050574e-02 -5.34870060e-02]
 [-2.03221226e-02 -1.70997353e-02]
 [ 1.16313926e-01 -5.77382590e-02]
 [ 7.48504493e-02  3.66492860e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.65472237]
curr_Stock_Price:  96.50796540131458
curr_Factors:  [9.65079654e+01 4.29772587e-02]
mat_Sqrt:  [[ 2.00070233e+01 -8.28451455e-03]
 [-8.28451455e-03  1.90036682e-02]]
grads:  [ 0.00775262 -0.1117392 ]
Stock Position:  0.007752617826235985
Bond Position:  [-7.40291174]


portfolio before change:  [-6.66219649]
curr_Stock_Price:  96.73824955889489
curr_Factors:  [9.67382496e+01 3.87298117e-02]
mat_Sqrt:  [[ 1.90379806e+01 -7.86450483e-03]
 [-7.86450483e-03  1.80401685e-02]]
grads:  [1.26357612e-03 2.89169192e+00]
Stock Position:  0.0012635761242107005
Bond Position:  [-6.78443263]


portfolio before change:  [-6.67349656]
curr_Stock_Price:  94.51105432082534
curr_Factors:  [9.45110543e+01 4.38000588e-02]
mat_Sqrt:  [[ 1.97797098e+01 -8.36327446e-03]
 [-8.36327446e-03  1.91847916e-02]]
grads:  [4.57993584e-03 4.74253105e+00]
Stock Position:  0.004579935839027354
Bond Position:  [-7.10635112]


portfolio before change:  [-6.64399002]
curr_Stock_Price:  102.89436731462177
curr_Factors:  [1.02894367e+02 3.56175374e-02]
mat_Sqrt:  [[ 1.94188503e+01 -7.54232486e-03]
 [-7.54232486e-03  1.72999627e-02]]
grads:  [-0.00146797 -1.08667121]
Stock Position:  -0.0014679726318437799
Bond Position:  [-6.4929439]


portfolio before change:  [-6.65409707]
curr_Stock_Price:  104.24711355208784
curr_Factors:  [1.04247114e+02 3.06054468e-02]
mat_Sqrt:  [[ 1.82374187e+01 -6.99161762e-03]
 [-6.99161762e-03  1.60365754e-02]]
grads:  [ 0.00848496 -7.27265143]
Stock Position:  0.008484956874445804
Bond Position:  [-7.53862933]


portfolio before change:  [-6.64737078]
curr_Stock_Price:  106.15112637075566
curr_Factors:  [1.06151126e+02 3.22178549e-02]
mat_Sqrt:  [[ 1.90534176e+01 -7.17353895e-03]
 [-7.17353895e-03  1.64535372e-02]]
grads:  [0.00907823 6.459139  ]
Stock Position:  0.009078227151838878
Bond Position:  [-7.61103482]


portfolio before change:  [-6.64834755]
curr_Stock_Price:  107.0921658609798
curr_Factors:  [1.07092166e+02 3.32333731e-02]
mat_Sqrt:  [[ 1.95229249e+01 -7.28577331e-03]
 [-7.28577331e-03  1.67108120e-02]]
grads:  [4.59708298e-03 4.84842691e+00]
Stock Position:  0.004597082979233666
Bond Position:  [-7.14065912]


portfolio before change:  [-6.68000573]
curr_Stock_Price:  102.14842790326266
curr_Factors:  [1.02148428e+02 3.41363699e-02]
mat_Sqrt:  [[ 1.88729731e+01 -7.38378658e-03]
 [-7.38378658e-03  1.69364517e-02]]
grads:  [-0.00774522  4.51499394]
Stock Position:  -0.007745222969947478
Bond Position:  [-5.88884338]


portfolio before change:  [-6.68718498]
curr_Stock_Price:  102.12436018412592
curr_Factors:  [1.02124360e+02 3.28979807e-02]
mat_Sqrt:  [[ 1.85231113e+01 -7.24861437e-03]
 [-7.24861437e-03  1.66264066e-02]]
grads:  [0.00539989 3.83503928]
Stock Position:  0.005399888694914846
Bond Position:  [-7.23864515]


portfolio before change:  [-6.70676977]
curr_Stock_Price:  100.1741665591028
curr_Factors:  [1.00174167e+02 3.65178158e-02]
mat_Sqrt:  [[ 1.91429163e+01 -7.63686635e-03]
 [-7.63686635e-03  1.75173180e-02]]
grads:  [ 0.00240985 -2.35197583]
Stock Position:  0.002409854800295709
Bond Position:  [-6.94817496]


portfolio before change:  [-6.71393083]
curr_Stock_Price:  100.80888792015138
curr_Factors:  [1.00808888e+02 3.77048229e-02]
mat_Sqrt:  [[ 1.95747959e+01 -7.76003617e-03]
 [-7.76003617e-03  1.77997210e-02]]
grads:  [ 5.73583989e-04 -7.64052961e+00]
Stock Position:  0.0005735839889323059
Bond Position:  [-6.7717532]


portfolio before change:  [-6.72247492]
curr_Stock_Price:  100.67969483323841
curr_Factors:  [1.00679695e+02 3.65996217e-02]
mat_Sqrt:  [[ 1.92610587e+01 -7.64545057e-03]
 [-7.64545057e-03  1.75369126e-02]]
grads:  [2.73766374e-04 2.08986163e+00]
Stock Position:  0.0002737663735894498
Bond Position:  [-6.75003763]


portfolio before change:  [-6.73029148]
curr_Stock_Price:  102.96727390224662
curr_Factors:  [1.02967274e+02 3.75315048e-02]
mat_Sqrt:  [[ 1.99478995e+01 -7.74232776e-03]
 [-7.74232776e-03  1.77586995e-02]]
grads:  [-1.43191878e-03 -3.07998780e+00]
Stock Position:  -0.0014319187785004363
Bond Position:  [-6.58285071]


portfolio before change:  [-6.73674232]
curr_Stock_Price:  101.72218456362454
curr_Factors:  [1.01722185e+02 4.28256438e-02]
mat_Sqrt:  [[ 2.10507510e+01 -8.27029090e-03]
 [-8.27029090e-03  1.89699427e-02]]
grads:  [1.13748715e-03 1.47484865e+00]
Stock Position:  0.0011374871547887345
Bond Position:  [-6.85245]


portfolio before change:  [-6.74677057]
curr_Stock_Price:  100.4410032073592
curr_Factors:  [1.00441003e+02 4.19400577e-02]
mat_Sqrt:  [[ 2.05695845e+01 -8.18424006e-03]
 [-8.18424006e-03  1.87728205e-02]]
grads:  [-4.69882491e-03 -4.97435521e+00]
Stock Position:  -0.004698824908579511
Bond Position:  [-6.27481588]


portfolio before change:  [-6.74407268]
curr_Stock_Price:  98.19654594944382
curr_Factors:  [9.81965459e+01 4.52967981e-02]
mat_Sqrt:  [[ 2.08992128e+01 -8.50527869e-03]
 [-8.50527869e-03  1.95096954e-02]]
grads:  [ 0.00293304 -2.74028161]
Stock Position:  0.00293303863426049
Bond Position:  [-7.03208694]


portfolio before change:  [-6.75628366]
curr_Stock_Price:  97.03209669492969
curr_Factors:  [9.70320967e+01 4.73332219e-02]
mat_Sqrt:  [[ 2.11104948e+01 -8.69426693e-03]
 [-8.69426693e-03  1.99434687e-02]]
grads:  [-0.00131601 -0.857984  ]
Stock Position:  -0.0013160120031550323
Bond Position:  [-6.62858825]


portfolio before change:  [-6.75962838]
curr_Stock_Price:  93.27362251230966
curr_Factors:  [9.32736225e+01 4.69718272e-02]
mat_Sqrt:  [[ 2.02151762e+01 -8.66068308e-03]
 [-8.66068308e-03  1.98673310e-02]]
grads:  [ 0.00450955 -2.90422519]
Stock Position:  0.004509550182289168
Bond Position:  [-7.18025046]


portfolio before change:  [-6.75571786]
curr_Stock_Price:  96.13232092539357
curr_Factors:  [9.61323209e+01 4.86137692e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.75571786]
Stock Price:  94.9866096641539
PL:  [-6.75571786]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.78457204e-02 -4.48660615e-02]
 [-2.33667818e-02 -1.19909337e-01]
 [-3.31619520e-01 -1.57748276e-01]
 [-2.42915297e-02 -2.96094628e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-2.77561704e-01  4.78439401e-02]
 [ 5.22670693e-02  4.10842527e-02]
 [ 6.03149310e-02 -2.90821178e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 9.96286964e-02  2.18421219e-02]
 [ 3.44150185e-02  1.57830766e-02]
 [ 1.06721353e-02 -1.10630366e-01]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.39110342e-01 -6.57879039e-02]
 [ 2.90633312e-02 -1.46174279e-01]
 [-2.48938641e-02  3.68464854e-02]
 [-9.18809668e-02 -8.66476959e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.04277725]
curr_Stock_Price:  103.37654401805688
curr_Factors:  [1.03376544e+02 3.87783056e-02]
mat_Sqrt:  [[ 2.03571225e+01 -7.86990531e-03]
 [-7.86990531e-03  1.80512505e-02]]
grads:  [-8.42495331e-05 -2.48551891e+00]
Stock Position:  -8.424953312859452e-05
Bond Position:  [19.05148667]


portfolio before change:  [19.06651739]
curr_Stock_Price:  104.43421407812126
curr_Factors:  [1.04434214e+02 3.55979168e-02]
mat_Sqrt:  [[ 1.97040301e+01 -7.54034612e-03]
 [-7.54034612e-03  1.72951539e-02]]
grads:  [-3.83969730e-03 -6.93479168e+00]
Stock Position:  -0.003839697304242915
Bond Position:  [19.46751316]


portfolio before change:  [19.07581653]
curr_Stock_Price:  108.35391639126635
curr_Factors:  [1.08353916e+02 3.37579827e-02]
mat_Sqrt:  [[ 1.99082381e+01 -7.34312651e-03]
 [-7.34312651e-03  1.68421590e-02]]
grads:  [-0.02011537 -9.37504426]
Stock Position:  -0.020115374017363366
Bond Position:  [21.25539608]


portfolio before change:  [19.16087164]
curr_Stock_Price:  105.4472213034965
curr_Factors:  [1.05447221e+02 3.80145208e-02]
mat_Sqrt:  [[ 2.05593732e+01 -7.79215188e-03]
 [-7.79215188e-03  1.78725370e-02]]
grads:  [-0.00180973 -1.65749074]
Stock Position:  -0.0018097316998079043
Bond Position:  [19.35170282]


portfolio before change:  [19.18494359]
curr_Stock_Price:  105.52060716895167
curr_Factors:  [1.05520607e+02 3.29499018e-02]
mat_Sqrt:  [[ 1.91542130e+01 -7.25454156e-03]
 [-7.25454156e-03  1.66394304e-02]]
grads:  [ 0.00856093 -7.09446244]
Stock Position:  0.008560931685099884
Bond Position:  [18.28158888]


portfolio before change:  [19.24011188]
curr_Stock_Price:  109.29379666860828
curr_Factors:  [1.09293797e+02 3.11950290e-02]
mat_Sqrt:  [[ 1.93035943e+01 -7.05892587e-03]
 [-7.05892587e-03  1.61901777e-02]]
grads:  [0.0089606  6.56409182]
Stock Position:  0.008960600979071687
Bond Position:  [18.26077378]


portfolio before change:  [19.23145043]
curr_Stock_Price:  105.77821916982344
curr_Factors:  [1.05778219e+02 3.74884066e-02]
mat_Sqrt:  [[ 2.04806960e+01 -7.73806404e-03]
 [-7.73806404e-03  1.77484205e-02]]
grads:  [4.38208938e-03 4.56500150e+00]
Stock Position:  0.004382089376936848
Bond Position:  [18.76792082]


portfolio before change:  [19.2652157]
curr_Stock_Price:  108.12657338409637
curr_Factors:  [1.08126573e+02 3.20125215e-02]
mat_Sqrt:  [[ 1.93460521e+01 -7.15075564e-03]
 [-7.15075564e-03  1.64009728e-02]]
grads:  [-0.0132711   2.91135424]
Stock Position:  -0.013271096350800118
Bond Position:  [20.70017387]


portfolio before change:  [19.25568382]
curr_Stock_Price:  110.79577815456187
curr_Factors:  [1.10795778e+02 2.91771076e-02]
mat_Sqrt:  [[ 1.89253666e+01 -6.82687540e-03]
 [-6.82687540e-03  1.56577408e-02]]
grads:  [0.00370884 2.62551111]
Stock Position:  0.0037088373426418463
Bond Position:  [18.8447603]


portfolio before change:  [19.27816033]
curr_Stock_Price:  110.50076112897631
curr_Factors:  [1.10500761e+02 2.92277873e-02]
mat_Sqrt:  [[ 1.88913594e+01 -6.83278679e-03]
 [-6.83278679e-03  1.56713400e-02]]
grads:  [ 0.00252192 -1.85465225]
Stock Position:  0.0025219194974817525
Bond Position:  [18.99948631]


portfolio before change:  [19.29841619]
curr_Stock_Price:  109.1096198717304
curr_Factors:  [1.09109620e+02 2.90278767e-02]
mat_Sqrt:  [[ 1.85896258e+01 -6.80930747e-03]
 [-6.80930747e-03  1.56176854e-02]]
grads:  [ 5.16438923e-04 -7.83396418e+00]
Stock Position:  0.0005164389227353195
Bond Position:  [19.24206774]


portfolio before change:  [19.32310929]
curr_Stock_Price:  110.32074915905307
curr_Factors:  [1.10320749e+02 2.89034605e-02]
mat_Sqrt:  [[ 1.87556489e+01 -6.79476175e-03]
 [-6.79476175e-03  1.55841528e-02]]
grads:  [0.0058206 1.4040976]
Stock Position:  0.005820604000871097
Bond Position:  [18.6809759]


portfolio before change:  [19.31733972]
curr_Stock_Price:  105.31518748582823
curr_Factors:  [1.05315187e+02 3.32818471e-02]
mat_Sqrt:  [[ 1.92129780e+01 -7.29097965e-03]
 [-7.29097965e-03  1.67230406e-02]]
grads:  [0.00214975 0.94472953]
Stock Position:  0.002149745989437144
Bond Position:  [19.09093882]


portfolio before change:  [19.34403111]
curr_Stock_Price:  106.623621769806
curr_Factors:  [1.06623622e+02 3.41371800e-02]
mat_Sqrt:  [[ 1.97000451e+01 -7.38415206e-03]
 [-7.38415206e-03  1.69365315e-02]]
grads:  [-1.90698529e-03 -6.53288707e+00]
Stock Position:  -0.0019069852877474324
Bond Position:  [19.54736079]


portfolio before change:  [19.36906011]
curr_Stock_Price:  106.31973200559955
curr_Factors:  [1.06319732e+02 3.65741034e-02]
mat_Sqrt:  [[ 2.03329638e+01 -7.64315362e-03]
 [-7.64315362e-03  1.75306371e-02]]
grads:  [-4.20234215e-03 -4.97099505e+00]
Stock Position:  -0.004202342151847992
Bond Position:  [19.815852]


portfolio before change:  [19.38820702]
curr_Stock_Price:  107.66145726271593
curr_Factors:  [1.07661457e+02 3.44750733e-02]
mat_Sqrt:  [[ 1.99900013e+01 -7.42066807e-03]
 [-7.42066807e-03  1.70201181e-02]]
grads:  [ 0.00552502 -3.86289357]
Stock Position:  0.005525016678615538
Bond Position:  [18.79337567]


portfolio before change:  [19.39247709]
curr_Stock_Price:  104.17977810155423
curr_Factors:  [1.04179778e+02 3.21084836e-02]
mat_Sqrt:  [[ 1.86678066e+01 -7.16123552e-03]
 [-7.16123552e-03  1.64256367e-02]]
grads:  [-1.85728347e-03 -8.89996423e+00]
Stock Position:  -0.0018572834721090976
Bond Position:  [19.58596847]


portfolio before change:  [19.4109937]
curr_Stock_Price:  107.40015868687784
curr_Factors:  [1.07400159e+02 2.97439407e-02]
mat_Sqrt:  [[ 1.85226938e+01 -6.89269023e-03]
 [-6.89269023e-03  1.58091818e-02]]
grads:  [-4.76739111e-04  2.33049375e+00]
Stock Position:  -0.00047673911140573517
Bond Position:  [19.46219556]


portfolio before change:  [19.43220161]
curr_Stock_Price:  113.97619019638346
curr_Factors:  [1.13976190e+02 2.66755035e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.43220161]
Stock Price:  119.24508144638398
PL:  [0.18712016]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 9.11422592e-02 -8.31277870e-03]
 [-1.54377604e-01 -1.85284977e-01]
 [-5.45388173e-01 -6.59371793e-02]
 [-2.30319775e-02 -2.61859312e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-1.69107300e-01  4.27461926e-02]
 [ 5.17811533e-02  4.08616218e-02]
 [ 6.03540190e-02 -2.98478763e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 1.32384411e-01  1.73323446e-02]
 [ 3.05513886e-02  6.22092717e-02]
 [ 1.33370937e-02 -8.40992380e-02]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.54699747e-01 -8.49366865e-02]
 [ 7.41424061e-02 -1.51457509e-01]
 [-5.67521602e-02  3.95771983e-02]
 [-8.80264804e-02 -7.88921092e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [29.05982336]
curr_Stock_Price:  106.05395893283436
curr_Factors:  [1.06053959e+02 3.64277710e-02]
mat_Sqrt:  [[ 2.02415215e+01 -7.62783176e-03]
 [-7.62783176e-03  1.74955392e-02]]
grads:  [ 0.0043244  -0.47325166]
Stock Position:  0.004324397027474138
Bond Position:  [28.60120394]


portfolio before change:  [29.10340749]
curr_Stock_Price:  107.86005269565996
curr_Factors:  [1.07860053e+02 3.55675124e-02]
mat_Sqrt:  [[ 2.03417046e+01 -7.53733525e-03]
 [-7.53733525e-03  1.72876748e-02]]
grads:  [ -0.0115624  -10.72279117]
Stock Position:  -0.011562397564577036
Bond Position:  [30.3505283]


portfolio before change:  [29.10391398]
curr_Stock_Price:  111.09946636705168
curr_Factors:  [1.11099466e+02 3.14147384e-02]
mat_Sqrt:  [[ 1.96914941e+01 -7.08383707e-03]
 [-7.08383707e-03  1.62470501e-02]]
grads:  [-0.02916119 -4.07112381]
Stock Position:  -0.029161187516776942
Bond Position:  [32.34370635]


portfolio before change:  [29.12983087]
curr_Stock_Price:  111.59800664196366
curr_Factors:  [1.11598007e+02 3.38746680e-02]
mat_Sqrt:  [[ 2.05396923e+01 -7.35598716e-03]
 [-7.35598716e-03  1.68711627e-02]]
grads:  [-0.00167747 -1.55284321]
Stock Position:  -0.0016774677935110184
Bond Position:  [29.31703293]


portfolio before change:  [29.16437182]
curr_Stock_Price:  112.86673304341416
curr_Factors:  [1.12866733e+02 3.18924552e-02]
mat_Sqrt:  [[ 2.01562578e+01 -7.13758713e-03]
 [-7.13758713e-03  1.63700764e-02]]
grads:  [ 0.00813508 -7.2114419 ]
Stock Position:  0.00813507588798451
Bond Position:  [28.24619239]


portfolio before change:  [29.13922133]
curr_Stock_Price:  105.43222261448429
curr_Factors:  [1.05432223e+02 3.61027736e-02]
mat_Sqrt:  [[ 2.00328904e+01 -7.59369026e-03]
 [-7.59369026e-03  1.74173363e-02]]
grads:  [0.00863436 6.10174402]
Stock Position:  0.008634356747145109
Bond Position:  [28.22888191]


portfolio before change:  [29.19717559]
curr_Stock_Price:  108.05501073439841
curr_Factors:  [1.08055011e+02 3.33899387e-02]
mat_Sqrt:  [[ 1.97447979e+01 -7.30297078e-03]
 [-7.30297078e-03  1.67501046e-02]]
grads:  [4.54543505e-03 4.83703562e+00]
Stock Position:  0.00454543504616458
Bond Position:  [28.70601856]


portfolio before change:  [29.24754391]
curr_Stock_Price:  111.23696388317771
curr_Factors:  [1.11236964e+02 3.18465428e-02]
mat_Sqrt:  [[ 1.98509020e+01 -7.13236284e-03]
 [-7.13236284e-03  1.63583260e-02]]
grads:  [-0.00758118  2.60980989]
Stock Position:  -0.00758117638153506
Bond Position:  [30.09085095]


portfolio before change:  [29.28262081]
curr_Stock_Price:  111.57466626078832
curr_Factors:  [1.11574666e+02 3.56946490e-02]
mat_Sqrt:  [[ 2.10798311e+01 -7.55100786e-03]
 [-7.55100786e-03  1.73184517e-02]]
grads:  [0.00330212 2.36086671]
Stock Position:  0.0033021173685615288
Bond Position:  [28.91418817]


portfolio before change:  [29.30919228]
curr_Stock_Price:  108.66929963461594
curr_Factors:  [1.08669300e+02 3.42913908e-02]
mat_Sqrt:  [[ 2.01233087e+01 -7.40093148e-03]
 [-7.40093148e-03  1.69746906e-02]]
grads:  [ 0.00235289 -1.75734942]
Stock Position:  0.0023528932139748587
Bond Position:  [29.05350502]


portfolio before change:  [29.34657083]
curr_Stock_Price:  109.11086746571941
curr_Factors:  [1.09110867e+02 3.52981551e-02]
mat_Sqrt:  [[ 2.04995337e+01 -7.50881351e-03]
 [-7.50881351e-03  1.72220577e-02]]
grads:  [ 4.68323125e-04 -7.10416784e+00]
Stock Position:  0.0004683231252470893
Bond Position:  [29.29547169]


portfolio before change:  [29.38434738]
curr_Stock_Price:  111.53293373031808
curr_Factors:  [1.11532934e+02 3.02479548e-02]
mat_Sqrt:  [[ 1.93977387e+01 -6.95106322e-03]
 [-6.95106322e-03  1.59424674e-02]]
grads:  [0.00721545 1.0903268 ]
Stock Position:  0.007215446292801127
Bond Position:  [28.57958748]


portfolio before change:  [29.40382007]
curr_Stock_Price:  109.27747651268407
curr_Factors:  [1.09277477e+02 3.00954269e-02]
mat_Sqrt:  [[ 1.89574920e+01 -6.93339789e-03]
 [-6.93339789e-03  1.59022722e-02]]
grads:  [3.04280004e-03 3.91330042e+00]
Stock Position:  0.003042800039681095
Bond Position:  [29.07131056]


portfolio before change:  [29.42881035]
curr_Stock_Price:  105.54026823030925
curr_Factors:  [1.05540268e+02 2.80754884e-02]
mat_Sqrt:  [[ 1.76840536e+01 -6.69648100e-03]
 [-6.69648100e-03  1.53594279e-02]]
grads:  [-1.31942425e-03 -5.47598998e+00]
Stock Position:  -0.0013194242515787054
Bond Position:  [29.56806274]


portfolio before change:  [29.46119867]
curr_Stock_Price:  109.02274751076737
curr_Factors:  [1.09022748e+02 2.47799997e-02]
mat_Sqrt:  [[ 1.71619938e+01 -6.29137639e-03]
 [-6.29137639e-03  1.44297810e-02]]
grads:  [-4.97883232e-03 -6.03917099e+00]
Stock Position:  -0.004978832323111875
Bond Position:  [30.00400465]


portfolio before change:  [29.49308774]
curr_Stock_Price:  110.15542097759578
curr_Factors:  [1.10155421e+02 2.55317576e-02]
mat_Sqrt:  [[ 1.76013591e+01 -6.38615018e-03]
 [-6.38615018e-03  1.46470018e-02]]
grads:  [ 0.00668617 -5.79599762]
Stock Position:  0.006686167572240557
Bond Position:  [28.75657013]


portfolio before change:  [29.53106972]
curr_Stock_Price:  110.4566100173266
curr_Factors:  [1.1045661e+02 2.7981812e-02]
mat_Sqrt:  [[ 1.84769209e+01 -6.68555819e-03]
 [-6.68555819e-03  1.53336699e-02]]
grads:  [ 4.38787369e-04 -9.87725553e+00]
Stock Position:  0.00043878736887524854
Bond Position:  [29.48260276]


portfolio before change:  [29.56854933]
curr_Stock_Price:  111.83155478598316
curr_Factors:  [1.11831555e+02 2.71237828e-02]
mat_Sqrt:  [[ 1.84178726e+01 -6.58232486e-03]
 [-6.58232486e-03  1.50967158e-02]]
grads:  [-2.14477791e-03  2.62064155e+00]
Stock Position:  -0.0021447779053914645
Bond Position:  [29.80840318]


portfolio before change:  [29.60446108]
curr_Stock_Price:  112.4712705726809
curr_Factors:  [1.12471271e+02 2.88449967e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [29.60446108]
Stock Price:  115.54846234441956
PL:  [14.05599874]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-2.93679684e-02 -6.73040014e-02]
 [ 2.31219187e-02 -6.40145429e-02]
 [ 7.07780200e-02  4.29308970e-03]
 [-2.42915297e-02 -2.96094628e-02]
 [ 3.63932615e-02 -9.22675232e-02]
 [ 1.27587172e-01  1.02434871e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-4.38807826e-02  1.34924026e-02]
 [ 4.74854547e-02  3.88926036e-02]
 [ 6.96605734e-02 -4.81033197e-02]
 [ 7.40832156e-02 -1.20576502e-01]
 [ 3.50571651e-01 -1.35971807e-02]
 [ 1.90495789e-02  1.24117661e-01]
 [-4.85621904e-02 -1.41751540e-01]
 [-2.22411523e-02 -1.01013652e-01]
 [ 1.36243492e-01 -6.22664940e-02]
 [ 7.57763061e-02 -1.48921380e-01]
 [-6.63839580e-02  4.05388628e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.28325966]
curr_Stock_Price:  101.83710633263934
curr_Factors:  [1.01837106e+02 3.94463587e-02]
mat_Sqrt:  [[ 2.02259755e+01 -7.93729892e-03]
 [-7.93729892e-03  1.82061218e-02]]
grads:  [-2.90321975e-03 -3.69804430e+00]
Stock Position:  -0.0029032197488700114
Bond Position:  [13.57891516]


portfolio before change:  [13.30090745]
curr_Stock_Price:  101.60855724512244
curr_Factors:  [1.01608557e+02 3.74108074e-02]
mat_Sqrt:  [[ 1.96529972e+01 -7.72977653e-03]
 [-7.72977653e-03  1.77301615e-02]]
grads:  [-2.43584767e-04 -3.61059461e+00]
Stock Position:  -0.00024358476720994732
Bond Position:  [13.32565775]


portfolio before change:  [13.31794532]
curr_Stock_Price:  100.08802302721533
curr_Factors:  [1.00088023e+02 3.84826931e-02]
mat_Sqrt:  [[ 1.96342721e+01 -7.83962303e-03]
 [-7.83962303e-03  1.79824148e-02]]
grads:  [0.00370079 0.24035162]
Stock Position:  0.003700788386919513
Bond Position:  [12.94754072]


portfolio before change:  [13.35702255]
curr_Stock_Price:  106.27121686725343
curr_Factors:  [1.06271217e+02 3.86270976e-02]
mat_Sqrt:  [[ 2.08863072e+01 -7.85473634e-03]
 [-7.85473634e-03  1.80159400e-02]]
grads:  [-0.00178141 -1.64429141]
Stock Position:  -0.0017814065868610885
Bond Position:  [13.5463348]


portfolio before change:  [13.38083522]
curr_Stock_Price:  102.4151829061887
curr_Factors:  [1.02415183e+02 4.57364896e-02]
mat_Sqrt:  [[ 2.19026027e+01 -8.54678729e-03]
 [-8.54678729e-03  1.96040129e-02]]
grads:  [-1.75019566e-04 -4.70663937e+00]
Stock Position:  -0.0001750195656572025
Bond Position:  [13.39875988]


portfolio before change:  [13.3960148]
curr_Stock_Price:  111.43902770140839
curr_Factors:  [1.11439028e+02 4.11084146e-02]
mat_Sqrt:  [[ 2.25944956e+01 -8.10341898e-03]
 [-8.10341898e-03  1.85854445e-02]]
grads:  [0.00762472 5.51488866]
Stock Position:  0.007624716579136071
Bond Position:  [12.54632379]


portfolio before change:  [13.41238764]
curr_Stock_Price:  111.52822950676502
curr_Factors:  [1.11528230e+02 4.10076292e-02]
mat_Sqrt:  [[ 2.25848448e+01 -8.09348464e-03]
 [-8.09348464e-03  1.85626452e-02]]
grads:  [3.97387524e-03 4.36466995e+00]
Stock Position:  0.003973875238561011
Bond Position:  [12.96918838]


portfolio before change:  [13.44174561]
curr_Stock_Price:  114.83390554761154
curr_Factors:  [1.14833906e+02 3.84766088e-02]
mat_Sqrt:  [[ 2.25251921e+01 -7.83992444e-03]
 [-7.83992444e-03  1.79805916e-02]]
grads:  [-0.00168716  0.74965139]
Stock Position:  -0.0016871586370692056
Bond Position:  [13.63548863]


portfolio before change:  [13.45272821]
curr_Stock_Price:  118.43310611753441
curr_Factors:  [1.18433106e+02 3.90910323e-02]
mat_Sqrt:  [[ 2.34159437e+01 -7.90246498e-03]
 [-7.90246498e-03  1.81235033e-02]]
grads:  [0.00275255 2.14717623]
Stock Position:  0.0027525450463047594
Bond Position:  [13.12673575]


portfolio before change:  [13.46422536]
curr_Stock_Price:  116.64511502813323
curr_Factors:  [1.16645115e+02 3.85027313e-02]
mat_Sqrt:  [[ 2.28882348e+01 -7.84268245e-03]
 [-7.84268245e-03  1.79866518e-02]]
grads:  [ 2.12744488e-03 -2.67346226e+00]
Stock Position:  0.002127444882131447
Bond Position:  [13.21606931]


portfolio before change:  [13.48443537]
curr_Stock_Price:  118.3746990747311
curr_Factors:  [1.18374699e+02 3.86973284e-02]
mat_Sqrt:  [[ 2.32862392e+01 -7.86256658e-03]
 [-7.86256658e-03  1.80320085e-02]]
grads:  [ 9.23761989e-04 -6.68640098e+00]
Stock Position:  0.0009237619894559619
Bond Position:  [13.37508532]


portfolio before change:  [13.50208627]
curr_Stock_Price:  119.37234321806481
curr_Factors:  [1.19372343e+02 3.89539266e-02]
mat_Sqrt:  [[ 2.35602186e+01 -7.88864247e-03]
 [-7.88864247e-03  1.80916717e-02]]
grads:  [ 0.0146303  -0.74519191]
Stock Position:  0.014630301397800163
Bond Position:  [11.75563291]


portfolio before change:  [13.45628404]
curr_Stock_Price:  115.23668273810365
curr_Factors:  [1.15236683e+02 4.27912272e-02]
mat_Sqrt:  [[ 2.38379054e+01 -8.26784002e-03]
 [-8.26784002e-03  1.89619380e-02]]
grads:  [3.06984998e-03 6.54695960e+00]
Stock Position:  0.003069849981827491
Bond Position:  [13.10252471]


portfolio before change:  [13.48672658]
curr_Stock_Price:  119.81480530302062
curr_Factors:  [1.19814805e+02 4.09733347e-02]
mat_Sqrt:  [[ 2.42527571e+01 -8.09055918e-03]
 [-8.09055918e-03  1.85546813e-02]]
grads:  [-4.55154044e-03 -7.64164912e+00]
Stock Position:  -0.004551540438996078
Bond Position:  [14.03206851]


portfolio before change:  [13.53466567]
curr_Stock_Price:  113.13837704316455
curr_Factors:  [1.13138377e+02 4.29289040e-02]
mat_Sqrt:  [[ 2.34414687e+01 -8.28100778e-03]
 [-8.28100778e-03  1.89924709e-02]]
grads:  [-2.82810183e-03 -5.31984867e+00]
Stock Position:  -0.002828101831416503
Bond Position:  [13.85463252]


portfolio before change:  [13.56894813]
curr_Stock_Price:  107.14377616948009
curr_Factors:  [1.07143776e+02 4.44152954e-02]
mat_Sqrt:  [[ 2.25804814e+01 -8.42276917e-03]
 [-8.42276917e-03  1.93186416e-02]]
grads:  [ 0.00483221 -3.22102324]
Stock Position:  0.004832206846799188
Bond Position:  [13.05120724]


portfolio before change:  [13.61439916]
curr_Stock_Price:  113.17142035607117
curr_Factors:  [1.13171420e+02 4.23743027e-02]
mat_Sqrt:  [[ 2.32963575e+01 -8.22734439e-03]
 [-8.22734439e-03  1.88693887e-02]]
grads:  [ 4.65564564e-04 -7.89201771e+00]
Stock Position:  0.00046556456438903964
Bond Position:  [13.56171056]


portfolio before change:  [13.63142364]
curr_Stock_Price:  113.30404174161593
curr_Factors:  [1.13304042e+02 4.42562826e-02]
mat_Sqrt:  [[ 2.38359706e+01 -8.40806909e-03]
 [-8.40806909e-03  1.92838585e-02]]
grads:  [-2.04379601e-03  2.10132626e+00]
Stock Position:  -0.002043796011290714
Bond Position:  [13.86299399]


portfolio before change:  [13.6618564]
curr_Stock_Price:  106.89773513033492
curr_Factors:  [1.06897735e+02 4.56143617e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.6618564]
Stock Price:  107.71047276020538
PL:  [5.95138364]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.41054967e-01  2.01398508e-02]
 [-2.06875559e-01 -2.07042913e-01]
 [-2.87601169e-01 -1.75481117e-01]
 [-1.75080546e-02 -1.11716068e-02]
 [ 1.97156796e-01 -1.15470400e-01]
 [ 1.27722438e-01  1.08130983e-01]
 [ 3.39016270e-02  5.44621139e-02]
 [-1.57930415e-01  7.98896360e-02]
 [ 7.09358355e-02  6.22929885e-02]
 [ 6.43797359e-02 -4.94634876e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 9.26777859e-02  2.28294704e-02]
 [ 3.26441506e-02  5.09449992e-02]
 [-6.83507267e-03 -2.00538001e-01]
 [ 2.88847826e-03 -1.14869934e-01]
 [ 1.73279552e-01 -1.07758637e-01]
 [ 6.06534480e-02 -1.48656873e-01]
 [-1.17798183e-01  4.57848675e-02]
 [-1.20676561e-01 -1.44781676e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [39.39339555]
curr_Stock_Price:  108.81597679596231
curr_Factors:  [1.08815977e+02 4.10968112e-02]
mat_Sqrt:  [[ 2.20595525e+01 -8.10211474e-03]
 [-8.10211474e-03  1.85828913e-02]]
grads:  [0.00679342 1.08674649]
Stock Position:  0.006793424836222448
Bond Position:  [38.65416239]


portfolio before change:  [39.44288952]
curr_Stock_Price:  108.98467778940025
curr_Factors:  [1.08984678e+02 4.51356977e-02]
mat_Sqrt:  [[ 2.31539715e+01 -8.49092436e-03]
 [-8.49092436e-03  1.94746291e-02]]
grads:  [ -0.01283554 -10.63701379]
Stock Position:  -0.012835536134867043
Bond Position:  [40.84176629]


portfolio before change:  [39.50888182]
curr_Stock_Price:  107.82320202127457
curr_Factors:  [1.07823202e+02 4.16056180e-02]
mat_Sqrt:  [[ 2.19931879e+01 -8.15205216e-03]
 [-8.15205216e-03  1.86975995e-02]]
grads:  [-0.01655826 -9.39244107]
Stock Position:  -0.016558256187700095
Bond Position:  [41.29424602]


portfolio before change:  [39.66465683]
curr_Stock_Price:  101.534802445802
curr_Factors:  [1.01534802e+02 4.24471218e-02]
mat_Sqrt:  [[ 2.09189084e+01 -8.23364689e-03]
 [-8.23364689e-03  1.88859280e-02]]
grads:  [-0.00106996 -0.5919972 ]
Stock Position:  -0.001069957859632088
Bond Position:  [39.77329479]


portfolio before change:  [39.71161228]
curr_Stock_Price:  104.14449285805159
curr_Factors:  [1.04144493e+02 4.24829855e-02]
mat_Sqrt:  [[ 2.14656376e+01 -8.23731065e-03]
 [-8.23731065e-03  1.88938235e-02]]
grads:  [ 0.00684064 -6.10855983]
Stock Position:  0.0068406396243434
Bond Position:  [38.99919733]


portfolio before change:  [39.75865452]
curr_Stock_Price:  103.89053545674139
curr_Factors:  [1.03890535e+02 4.79120202e-02]
mat_Sqrt:  [[ 2.27404050e+01 -8.74780792e-03]
 [-8.74780792e-03  2.00647965e-02]]
grads:  [0.00769091 5.3924425 ]
Stock Position:  0.00769091357687814
Bond Position:  [38.95964139]


portfolio before change:  [39.79769085]
curr_Stock_Price:  102.63012884525044
curr_Factors:  [1.02630129e+02 4.61059065e-02]
mat_Sqrt:  [[ 2.20370331e+01 -8.58125045e-03]
 [-8.58125045e-03  1.96830182e-02]]
grads:  [2.61629536e-03 2.76810012e+00]
Stock Position:  0.002616295358746277
Bond Position:  [39.52918012]


portfolio before change:  [39.8451675]
curr_Stock_Price:  101.87879499371824
curr_Factors:  [1.01878795e+02 4.80425072e-02]
mat_Sqrt:  [[ 2.23304049e+01 -8.75955953e-03]
 [-8.75955953e-03  2.00921674e-02]]
grads:  [-0.00551365  3.97375442]
Stock Position:  -0.005513651763113682
Bond Position:  [40.4068917]


portfolio before change:  [39.89516199]
curr_Stock_Price:  101.97776891957005
curr_Factors:  [1.01977769e+02 4.86297125e-02]
mat_Sqrt:  [[ 2.24882843e+01 -8.81293702e-03]
 [-8.81293702e-03  2.02145805e-02]]
grads:  [0.00436274 3.08348902]
Stock Position:  0.00436273521374231
Bond Position:  [39.45025999]


portfolio before change:  [39.95161645]
curr_Stock_Price:  103.60766396899342
curr_Factors:  [1.03607664e+02 4.65288733e-02]
mat_Sqrt:  [[ 2.23487438e+01 -8.62059454e-03]
 [-8.62059454e-03  1.97730646e-02]]
grads:  [ 1.91608136e-03 -2.50072363e+00]
Stock Position:  0.0019160813573060724
Bond Position:  [39.75309574]


portfolio before change:  [40.00641056]
curr_Stock_Price:  106.25456087739967
curr_Factors:  [1.06254561e+02 4.75775347e-02]
mat_Sqrt:  [[ 2.31765355e+01 -8.71739012e-03]
 [-8.71739012e-03  1.99945607e-02]]
grads:  [ 4.14293137e-04 -6.11907885e+00]
Stock Position:  0.00041429313665680554
Bond Position:  [39.96239003]


portfolio before change:  [40.05797055]
curr_Stock_Price:  110.05807091366148
curr_Factors:  [1.10058071e+02 4.62712284e-02]
mat_Sqrt:  [[ 2.36743128e+01 -8.59713935e-03]
 [-8.59713935e-03  1.97180496e-02]]
grads:  [0.00433583 1.159686  ]
Stock Position:  0.0043358288275633415
Bond Position:  [39.58077759]


portfolio before change:  [40.09952415]
curr_Stock_Price:  108.22374821473257
curr_Factors:  [1.08223748e+02 5.08900298e-02]
mat_Sqrt:  [[ 2.44139974e+01 -9.01589154e-03]
 [-9.01589154e-03  2.06788297e-02]]
grads:  [2.24726866e-03 2.46461048e+00]
Stock Position:  0.0022472686623503917
Bond Position:  [39.85631631]


portfolio before change:  [40.15582864]
curr_Stock_Price:  111.09521108573482
curr_Factors:  [1.11095211e+02 5.27271775e-02]
mat_Sqrt:  [[ 2.55101242e+01 -9.17738789e-03]
 [-9.17738789e-03  2.10486894e-02]]
grads:  [-3.69602074e-03 -9.52895054e+00]
Stock Position:  -0.0036960207413960972
Bond Position:  [40.56643885]


portfolio before change:  [40.18517981]
curr_Stock_Price:  116.88213500991529
curr_Factors:  [1.16882135e+02 5.03555148e-02]
mat_Sqrt:  [[ 2.62283899e+01 -8.96898037e-03]
 [-8.96898037e-03  2.05696995e-02]]
grads:  [-1.79977322e-03 -5.58520924e+00]
Stock Position:  -0.0017997732226575594
Bond Position:  [40.39554114]


portfolio before change:  [40.24301201]
curr_Stock_Price:  112.82261852885401
curr_Factors:  [1.12822619e+02 5.77451723e-02]
mat_Sqrt:  [[ 2.71115276e+01 -9.60428743e-03]
 [-9.60428743e-03  2.20274689e-02]]
grads:  [ 4.65907998e-03 -4.88998034e+00]
Stock Position:  0.004659079983468604
Bond Position:  [39.71736241]


portfolio before change:  [40.28348493]
curr_Stock_Price:  110.84694433294906
curr_Factors:  [1.10846944e+02 5.63443865e-02]
mat_Sqrt:  [[ 2.63117070e+01 -9.48694431e-03]
 [-9.48694431e-03  2.17587167e-02]]
grads:  [-1.58202791e-04 -6.83212964e+00]
Stock Position:  -0.000158202790902042
Bond Position:  [40.30102123]


portfolio before change:  [40.33224486]
curr_Stock_Price:  121.26297113875746
curr_Factors:  [1.21262971e+02 5.30579678e-02]
mat_Sqrt:  [[ 2.79320935e+01 -9.20676705e-03]
 [-9.20676705e-03  2.11143344e-02]]
grads:  [-0.00350307  2.16689831]
Stock Position:  -0.003503069141728204
Bond Position:  [40.75703744]


portfolio before change:  [40.37035675]
curr_Stock_Price:  124.93582658238017
curr_Factors:  [1.24935827e+02 4.97701345e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [40.37035675]
Stock Price:  124.92129633246581
PL:  [15.44906042]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-4.26799239e-02 -7.36291141e-02]
 [ 4.05878553e-03 -8.69347339e-02]
 [ 5.82554743e-02 -1.95924531e-01]
 [-1.59188547e-02 -6.85207479e-03]
 [ 4.80711574e-02 -9.39529849e-02]
 [ 1.28128861e-01  1.16070461e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-2.60329365e-01  4.70366226e-02]
 [ 5.49098688e-02  4.28000444e-02]
 [ 6.01092875e-02 -2.75918051e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [-5.99819330e-03  3.99058660e-02]
 [-3.96655019e-02 -9.90580036e-02]
 [ 3.02686834e-03  1.62965751e-01]
 [-7.44659104e-02 -4.86444187e-02]
 [-2.45431896e-02 -8.21243589e-04]
 [-7.32195847e-02  1.02227155e-01]
 [ 1.13279630e-01 -8.43336443e-02]
 [ 6.73532614e-02  5.77135263e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.66040301]
curr_Stock_Price:  101.40333967527826
curr_Factors:  [1.01403340e+02 3.99829167e-02]
mat_Sqrt:  [[ 2.02763351e+01 -7.99106828e-03]
 [-7.99106828e-03  1.83295388e-02]]
grads:  [-3.68866538e-03 -4.01857303e+00]
Stock Position:  -0.0036886653808972988
Bond Position:  [12.034446]


portfolio before change:  [11.67113661]
curr_Stock_Price:  102.57418604913529
curr_Factors:  [1.02574186e+02 3.81874802e-02]
mat_Sqrt:  [[ 2.00446532e+01 -7.80966823e-03]
 [-7.80966823e-03  1.79132321e-02]]
grads:  [-1.68863369e-03 -4.85383772e+00]
Stock Position:  -0.0016886336851736682
Bond Position:  [11.84434684]


portfolio before change:  [11.68406432]
curr_Stock_Price:  103.69164687147799
curr_Factors:  [1.03691647e+02 3.57285750e-02]
mat_Sqrt:  [[ 1.95997976e+01 -7.55412400e-03]
 [-7.55412400e-03  1.73268855e-02]]
grads:  [-1.38612071e-03 -1.13081490e+01]
Stock Position:  -0.0013861207087737205
Bond Position:  [11.82779346]


portfolio before change:  [11.70294328]
curr_Stock_Price:  100.74459125059754
curr_Factors:  [1.00744591e+02 3.68339879e-02]
mat_Sqrt:  [[ 1.93350846e+01 -7.66989488e-03]
 [-7.66989488e-03  1.75929700e-02]]
grads:  [-0.00097798 -0.38990437]
Stock Position:  -0.0009779828064369887
Bond Position:  [11.80146976]


portfolio before change:  [11.71593894]
curr_Stock_Price:  102.5497413097311
curr_Factors:  [1.02549741e+02 3.66982857e-02]
mat_Sqrt:  [[ 1.96452439e+01 -7.65587580e-03]
 [-7.65587580e-03  1.75604790e-02]]
grads:  [ 3.61996123e-04 -5.35009401e+00]
Stock Position:  0.00036199612278747106
Bond Position:  [11.67881633]


portfolio before change:  [11.73049511]
curr_Stock_Price:  102.40754424531657
curr_Factors:  [1.02407544e+02 3.93982626e-02]
mat_Sqrt:  [[ 2.03268674e+01 -7.93249830e-03]
 [-7.93249830e-03  1.81950020e-02]]
grads:  [0.0087944  6.38308383]
Stock Position:  0.008794402965530045
Bond Position:  [10.8298819]


portfolio before change:  [11.79623347]
curr_Stock_Price:  108.34228998299506
curr_Factors:  [1.08342290e+02 3.66028152e-02]
mat_Sqrt:  [[ 2.07278962e+01 -7.64627604e-03]
 [-7.64627604e-03  1.75374632e-02]]
grads:  [4.32985341e-03 4.61986799e+00]
Stock Position:  0.004329853414690134
Bond Position:  [11.32712724]


portfolio before change:  [11.8116074]
curr_Stock_Price:  108.6208584025922
curr_Factors:  [1.08620858e+02 4.12677402e-02]
mat_Sqrt:  [[ 2.20657425e+01 -8.11893405e-03]
 [-8.11893405e-03  1.86215013e-02]]
grads:  [-0.01087024  2.52119134]
Stock Position:  -0.01087024285735871
Bond Position:  [12.99234251]


portfolio before change:  [11.83938433]
curr_Stock_Price:  107.56050033803481
curr_Factors:  [1.07560500e+02 4.45295359e-02]
mat_Sqrt:  [[ 2.26974395e+01 -8.43362224e-03]
 [-8.43362224e-03  1.93434582e-02]]
grads:  [0.00324188 2.21405008]
Stock Position:  0.0032418780382823405
Bond Position:  [11.4906863]


portfolio before change:  [11.86190581]
curr_Stock_Price:  110.0742114018851
curr_Factors:  [1.10074211e+02 4.09170288e-02]
mat_Sqrt:  [[ 2.22657639e+01 -8.08445131e-03]
 [-8.08445131e-03  1.85421664e-02]]
grads:  [ 0.00215967 -1.48711562]
Stock Position:  0.002159673208174193
Bond Position:  [11.62418149]


portfolio before change:  [11.86720872]
curr_Stock_Price:  105.79745046107901
curr_Factors:  [1.05797450e+02 3.97269974e-02]
mat_Sqrt:  [[ 2.10871575e+01 -7.96575176e-03]
 [-7.96575176e-03  1.82706533e-02]]
grads:  [ 4.55354064e-04 -6.69643693e+00]
Stock Position:  0.0004553540636307607
Bond Position:  [11.81903342]


portfolio before change:  [11.88215468]
curr_Stock_Price:  106.15527123555414
curr_Factors:  [1.06155271e+02 3.55210777e-02]
mat_Sqrt:  [[ 2.00071211e+01 -7.53231079e-03]
 [-7.53231079e-03  1.72764311e-02]]
grads:  [5.69904258e-04 2.31009278e+00]
Stock Position:  0.0005699042577725395
Bond Position:  [11.82165634]


portfolio before change:  [11.89438076]
curr_Stock_Price:  101.66288715794423
curr_Factors:  [1.01662887e+02 3.54353168e-02]
mat_Sqrt:  [[ 1.91372956e+01 -7.52292561e-03]
 [-7.52292561e-03  1.72556877e-02]]
grads:  [-4.33006905e-03 -5.74248793e+00]
Stock Position:  -0.004330069048222224
Bond Position:  [12.33458808]


portfolio before change:  [11.93433475]
curr_Stock_Price:  95.99874778972803
curr_Factors:  [9.59987478e+01 3.41237470e-02]
mat_Sqrt:  [[ 1.77334766e+01 -7.38199728e-03]
 [-7.38199728e-03  1.69335048e-02]]
grads:  [4.17761576e-03 9.62568538e+00]
Stock Position:  0.004177615762793294
Bond Position:  [11.53328887]


portfolio before change:  [11.94964668]
curr_Stock_Price:  96.2109030173588
curr_Factors:  [9.62109030e+01 3.30870121e-02]
mat_Sqrt:  [[ 1.75006036e+01 -7.26900910e-03]
 [-7.26900910e-03  1.66742804e-02]]
grads:  [-0.00546777 -2.91971604]
Stock Position:  -0.005467774424233247
Bond Position:  [12.4757062]


portfolio before change:  [11.97970602]
curr_Stock_Price:  93.5672391085016
curr_Factors:  [9.35672391e+01 3.78219478e-02]
mat_Sqrt:  [[ 1.81968293e+01 -7.77153313e-03]
 [-7.77153313e-03  1.78275840e-02]]
grads:  [-0.00136869 -0.04666254]
Stock Position:  -0.001368690594933077
Bond Position:  [12.10777062]


portfolio before change:  [11.99917929]
curr_Stock_Price:  90.40429805705381
curr_Factors:  [9.04042981e+01 4.00847698e-02]
mat_Sqrt:  [[ 1.81000066e+01 -8.00036098e-03]
 [-8.00036098e-03  1.83532537e-02]]
grads:  [-1.58360719e-03  5.56928420e+00]
Stock Position:  -0.0015836071947558064
Bond Position:  [12.14234418]


portfolio before change:  [12.01386055]
curr_Stock_Price:  90.72392354072196
curr_Factors:  [9.07239235e+01 4.31754730e-02]
mat_Sqrt:  [[ 1.88512579e+01 -8.30309464e-03]
 [-8.30309464e-03  1.90476600e-02]]
grads:  [ 4.05979892e-03 -4.42573710e+00]
Stock Position:  0.004059798917664832
Bond Position:  [11.64553966]


portfolio before change:  [12.01362839]
curr_Stock_Price:  87.07887131779245
curr_Factors:  [8.70788713e+01 4.57280694e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.01362839]
Stock Price:  84.37283900859683
PL:  [12.01362839]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 2.29438003e-02 -4.24547284e-02]
 [ 3.30575121e-02 -3.62819853e-02]
 [ 4.50314242e-03 -2.18286440e-01]
 [-2.42915297e-02 -2.96094628e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.27243219e-01  1.07283613e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-3.36893035e-01  5.06329457e-02]
 [ 5.38650002e-02  4.18168047e-02]
 [ 6.41129324e-02 -4.88570621e-02]
 [ 7.11012417e-02 -1.37201970e-01]
 [-9.92808726e-03  3.82338328e-02]
 [ 3.43121661e-02  4.36077295e-03]
 [ 9.48676083e-03 -1.19361523e-01]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.59439482e-01 -9.07585984e-02]
 [ 6.79978033e-02 -1.50560300e-01]
 [-6.85108229e-02  4.07621097e-02]
 [-9.02423184e-02 -8.34012836e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.65537285]
curr_Stock_Price:  103.54028216707204
curr_Factors:  [1.03540282e+02 3.56072678e-02]
mat_Sqrt:  [[ 1.95379339e+01 -7.54127931e-03]
 [-7.54127931e-03  1.72974502e-02]]
grads:  [ 2.27009103e-04 -2.45429332e+00]
Stock Position:  0.00022700910292271985
Bond Position:  [19.63186826]


portfolio before change:  [19.67898514]
curr_Stock_Price:  99.3867623797525
curr_Factors:  [9.93867624e+01 3.96750646e-02]
mat_Sqrt:  [[ 1.97964505e+01 -7.96009899e-03]
 [-7.96009899e-03  1.82589011e-02]]
grads:  [ 8.71021945e-04 -1.98670510e+00]
Stock Position:  0.0008710219451967638
Bond Position:  [19.59241709]


portfolio before change:  [19.70785884]
curr_Stock_Price:  104.4014066650313
curr_Factors:  [1.04401407e+02 3.92467899e-02]
mat_Sqrt:  [[ 2.06827550e+01 -7.91736998e-03]
 [-7.91736998e-03  1.81599326e-02]]
grads:  [-4.38435520e-03 -1.20221345e+01]
Stock Position:  -0.004384355202820477
Bond Position:  [20.16559169]


portfolio before change:  [19.72794788]
curr_Stock_Price:  105.57232148462653
curr_Factors:  [1.05572321e+02 3.59532935e-02]
mat_Sqrt:  [[ 2.00179399e+01 -7.57796222e-03]
 [-7.57796222e-03  1.73812377e-02]]
grads:  [-0.00185868 -1.70434053]
Stock Position:  -0.0018586806682546063
Bond Position:  [19.92417312]


portfolio before change:  [19.75463015]
curr_Stock_Price:  104.6246156213464
curr_Factors:  [1.04624616e+02 3.57529518e-02]
mat_Sqrt:  [[ 1.97828927e+01 -7.55676009e-03]
 [-7.55676009e-03  1.73327694e-02]]
grads:  [ 0.00828891 -6.81064172]
Stock Position:  0.008288908928293724
Bond Position:  [18.88740624]


portfolio before change:  [19.77607365]
curr_Stock_Price:  104.36155034932023
curr_Factors:  [1.04361550e+02 3.55714799e-02]
mat_Sqrt:  [[ 1.96830075e+01 -7.53754106e-03]
 [-7.53754106e-03  1.72887326e-02]]
grads:  [0.00884244 6.20926162]
Stock Position:  0.008842438530039956
Bond Position:  [18.85326306]


portfolio before change:  [19.82821605]
curr_Stock_Price:  107.59155167673292
curr_Factors:  [1.07591552e+02 3.54956374e-02]
mat_Sqrt:  [[ 2.02705546e+01 -7.52969970e-03]
 [-7.52969970e-03  1.72702055e-02]]
grads:  [4.42753574e-03 4.69137415e+00]
Stock Position:  0.00442753574143725
Bond Position:  [19.35185061]


portfolio before change:  [19.84725605]
curr_Stock_Price:  106.42500167813947
curr_Factors:  [1.06425002e+02 3.28676875e-02]
mat_Sqrt:  [[ 1.92942637e+01 -7.24553883e-03]
 [-7.24553883e-03  1.66186354e-02]]
grads:  [-0.01631932  3.03964208]
Stock Position:  -0.016319316222042846
Bond Position:  [21.5840393]


portfolio before change:  [19.84450347]
curr_Stock_Price:  108.24796357704342
curr_Factors:  [1.08247964e+02 3.47078685e-02]
mat_Sqrt:  [[ 2.01666461e+01 -7.44571451e-03]
 [-7.44571451e-03  1.70774711e-02]]
grads:  [0.00357564 2.45021219]
Stock Position:  0.0035756357468882992
Bond Position:  [19.45744819]


portfolio before change:  [19.85296462]
curr_Stock_Price:  103.8079488027691
curr_Factors:  [1.03807949e+02 3.45733000e-02]
mat_Sqrt:  [[ 1.93019415e+01 -7.43099740e-03]
 [-7.43099740e-03  1.70444501e-02]]
grads:  [ 2.21840574e-03 -2.86548272e+00]
Stock Position:  0.0022184057372704705
Bond Position:  [19.62267647]


portfolio before change:  [19.87113026]
curr_Stock_Price:  100.93289190035546
curr_Factors:  [1.00932892e+02 3.50650859e-02]
mat_Sqrt:  [[ 1.89003626e+01 -7.48347361e-03]
 [-7.48347361e-03  1.71653279e-02]]
grads:  [ 5.97237313e-04 -7.99271074e+00]
Stock Position:  0.0005972373132234557
Bond Position:  [19.81084937]


portfolio before change:  [19.89679823]
curr_Stock_Price:  102.42129866311035
curr_Factors:  [1.02421299e+02 3.78541834e-02]
mat_Sqrt:  [[ 1.99272416e+01 -7.77550215e-03]
 [-7.77550215e-03  1.78348928e-02]]
grads:  [3.38326556e-04 2.14391328e+00]
Stock Position:  0.000338326555782765
Bond Position:  [19.86214639]


portfolio before change:  [19.92240609]
curr_Stock_Price:  104.68138431672786
curr_Factors:  [1.04681384e+02 3.87315252e-02]
mat_Sqrt:  [[ 2.06016367e+01 -7.86524379e-03]
 [-7.86524379e-03  1.80403213e-02]]
grads:  [0.00175808 0.24249018]
Stock Position:  0.0017580841209899115
Bond Position:  [19.73836741]


portfolio before change:  [19.95117087]
curr_Stock_Price:  107.00003992450272
curr_Factors:  [1.07000040e+02 3.62515041e-02]
mat_Sqrt:  [[ 2.03726219e+01 -7.60941268e-03]
 [-7.60941268e-03  1.74531338e-02]]
grads:  [-2.08911468e-03 -6.83988456e+00]
Stock Position:  -0.0020891146819463674
Bond Position:  [20.17470622]


portfolio before change:  [19.97191073]
curr_Stock_Price:  109.15132521249627
curr_Factors:  [1.09151325e+02 3.79443679e-02]
mat_Sqrt:  [[ 2.12619281e+01 -7.78518811e-03]
 [-7.78518811e-03  1.78559381e-02]]
grads:  [-4.01876622e-03 -4.88038643e+00]
Stock Position:  -0.004018766219988508
Bond Position:  [20.41056439]


portfolio before change:  [19.99091986]
curr_Stock_Price:  110.77372269890469
curr_Factors:  [1.10773723e+02 4.24743944e-02]
mat_Sqrt:  [[ 2.28297061e+01 -8.23691121e-03]
 [-8.23691121e-03  1.88917241e-02]]
grads:  [ 0.00525136 -4.80185626]
Stock Position:  0.005251360566799078
Bond Position:  [19.4092071]


portfolio before change:  [20.01265401]
curr_Stock_Price:  110.289556813703
curr_Factors:  [1.10289557e+02 3.89586722e-02]
mat_Sqrt:  [[ 2.17688976e+01 -7.88862450e-03]
 [-7.88862450e-03  1.80929911e-02]]
grads:  [ 1.08099896e-04 -8.32142381e+00]
Stock Position:  0.00010809989609633781
Bond Position:  [20.00073172]


portfolio before change:  [20.0380326]
curr_Stock_Price:  113.63874973217234
curr_Factors:  [1.1363875e+02 4.0047231e-02]
mat_Sqrt:  [[ 2.27411628e+01 -7.99827048e-03]
 [-7.99827048e-03  1.83439358e-02]]
grads:  [-0.00223144  2.22112978]
Stock Position:  -0.0022314437780968964
Bond Position:  [20.29161108]


portfolio before change:  [20.06425227]
curr_Stock_Price:  113.26262544470198
curr_Factors:  [1.13262625e+02 3.78400617e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.06425227]
Stock Price:  114.84818546374505
PL:  [5.21606681]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 9.25647389e-02 -7.59850763e-03]
 [-3.35198363e-01 -2.60813151e-01]
 [-1.05232666e+00  1.64913066e-01]
 [-2.17817242e-02 -2.27876743e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.41085939e-01  4.88305636e-02]
 [ 5.44239664e-02  8.09876574e-02]
 [ 1.21655621e-01 -1.49509436e-01]
 [ 4.59194991e-02  3.81745712e-02]
 [ 8.37082016e-02 -6.86406995e-02]
 [ 1.33624321e-01 -1.11086422e-01]
 [ 5.45167324e-01 -4.12473574e-02]
 [ 5.35857322e-02  2.55597630e-01]
 [-9.50998030e-02 -6.55501490e-02]
 [ 9.25335497e-02 -1.51956687e-01]
 [ 2.77817846e-01 -2.36165139e-01]
 [ 2.10645684e-01 -1.52358258e-01]
 [-1.61565646e-01  5.03209281e-02]
 [-1.27530278e-01 -1.58391723e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [29.25714347]
curr_Stock_Price:  106.10669981079238
curr_Factors:  [1.06106700e+02 3.61853903e-02]
mat_Sqrt:  [[ 2.01841008e+01 -7.60241588e-03]
 [-7.60241588e-03  1.74372353e-02]]
grads:  [ 0.00442262 -0.43383512]
Stock Position:  0.004422616824846007
Bond Position:  [28.7878742]


portfolio before change:  [29.31794633]
curr_Stock_Price:  111.713225096241
curr_Factors:  [1.11713225e+02 3.50723241e-02]
mat_Sqrt:  [[ 2.09212118e+01 -7.48490133e-03]
 [-7.48490133e-03  1.71668137e-02]]
grads:  [ -0.02146078 -15.20222605]
Stock Position:  -0.02146078009577147
Bond Position:  [31.71539929]


portfolio before change:  [29.22299049]
curr_Stock_Price:  117.98629042123095
curr_Factors:  [1.17986290e+02 3.19940888e-02]
mat_Sqrt:  [[ 2.11040785e+01 -7.14920270e-03]
 [-7.14920270e-03  1.63960296e-02]]
grads:  [-0.04646325 10.0378503 ]
Stock Position:  -0.04646324777885716
Bond Position:  [34.70501674]


portfolio before change:  [29.42407585]
curr_Stock_Price:  114.59270585078717
curr_Factors:  [1.14592706e+02 2.74086872e-02]
mat_Sqrt:  [[ 1.89714736e+01 -6.61693504e-03]
 [-6.61693504e-03  1.51757386e-02]]
grads:  [-0.00167211 -1.50231492]
Stock Position:  -0.0016721128345579435
Bond Position:  [29.61568778]


portfolio before change:  [29.46348498]
curr_Stock_Price:  113.17750577684775
curr_Factors:  [1.13177506e+02 2.96316106e-02]
mat_Sqrt:  [[ 1.94821876e+01 -6.87996205e-03]
 [-6.87996205e-03  1.57791707e-02]]
grads:  [ 0.00841653 -7.48150941]
Stock Position:  0.008416533305140025
Bond Position:  [28.51092273]


portfolio before change:  [29.51783684]
curr_Stock_Price:  115.3982455170263
curr_Factors:  [1.15398246e+02 3.25193232e-02]
mat_Sqrt:  [[ 2.08098969e+01 -7.20752117e-03]
 [-7.20752117e-03  1.65301201e-02]]
grads:  [0.00780406 2.95743837]
Stock Position:  0.007804062601219798
Bond Position:  [28.61726171]


portfolio before change:  [29.59835765]
curr_Stock_Price:  121.12947368539801
curr_Factors:  [1.21129474e+02 3.23814595e-02]
mat_Sqrt:  [[ 2.17970649e+01 -7.19249713e-03]
 [-7.19249713e-03  1.64949259e-02]]
grads:  [4.1175719e-03 4.9116482e+00]
Stock Position:  0.004117571904970549
Bond Position:  [29.09959833]


portfolio before change:  [29.63409069]
curr_Stock_Price:  120.96816467646333
curr_Factors:  [1.20968165e+02 3.02617462e-02]
mat_Sqrt:  [[ 2.10435042e+01 -6.95309305e-03]
 [-6.95309305e-03  1.59459073e-02]]
grads:  [ 2.68354977e-03 -9.37486810e+00]
Stock Position:  0.002683549773956515
Bond Position:  [29.3094666]


portfolio before change:  [29.67063614]
curr_Stock_Price:  120.92557428774495
curr_Factors:  [1.20925574e+02 2.49895262e-02]
mat_Sqrt:  [[ 1.91160055e+01 -6.31844114e-03]
 [-6.31844114e-03  1.44904301e-02]]
grads:  [0.0032734  2.63589512]
Stock Position:  0.0032733955576094353
Bond Position:  [29.2747989]


portfolio before change:  [29.71536198]
curr_Stock_Price:  123.4029594480552
curr_Factors:  [1.23402959e+02 2.41481977e-02]
mat_Sqrt:  [[ 1.91764368e+01 -6.21126272e-03]
 [-6.21126272e-03  1.42443741e-02]]
grads:  [ 2.80474444e-03 -4.81757066e+00]
Stock Position:  0.002804744444401956
Bond Position:  [29.36924821]


portfolio before change:  [29.75753502]
curr_Stock_Price:  125.34200415623796
curr_Factors:  [1.25342004e+02 2.25757536e-02]
mat_Sqrt:  [[ 1.88329235e+01 -6.00570026e-03]
 [-6.00570026e-03  1.37727666e-02]]
grads:  [ 4.52379289e-03 -8.06368513e+00]
Stock Position:  0.004523792889972107
Bond Position:  [29.19051375]


portfolio before change:  [29.79867968]
curr_Stock_Price:  126.36630139907118
curr_Factors:  [1.26366301e+02 2.13639512e-02]
mat_Sqrt:  [[ 1.84702188e+01 -5.84232732e-03]
 [-5.84232732e-03  1.33980119e-02]]
grads:  [ 0.02854616 -3.06616994]
Stock Position:  0.02854615640312833
Bond Position:  [26.19140748]


portfolio before change:  [29.89208593]
curr_Stock_Price:  128.49080868791813
curr_Factors:  [1.28490809e+02 1.58898894e-02]
mat_Sqrt:  [[ 1.61969216e+01 -5.03860995e-03]
 [-5.03860995e-03  1.15547092e-02]]
grads:  [1.01911607e-02 2.21250899e+01]
Stock Position:  0.010191160678326101
Bond Position:  [28.58261545]


portfolio before change:  [29.97565539]
curr_Stock_Price:  133.18299777944645
curr_Factors:  [1.33182998e+02 1.02795055e-02]
mat_Sqrt:  [[ 1.35031433e+01 -4.05272672e-03]
 [-4.05272672e-03  9.29357093e-03]]
grads:  [-0.0091609  -7.05727391]
Stock Position:  -0.00916090443725571
Bond Position:  [31.19573211]


portfolio before change:  [30.05228352]
curr_Stock_Price:  129.07760877228097
curr_Factors:  [1.29077609e+02 9.97772815e-03]
mat_Sqrt:  [[ 1.28933783e+01 -3.99270793e-03]
 [-3.99270793e-03  9.15617632e-03]]
grads:  [ 2.03777271e-03 -1.65951971e+01]
Stock Position:  0.002037772711116788
Bond Position:  [29.78925269]


portfolio before change:  [30.09032755]
curr_Stock_Price:  129.46243404386675
curr_Factors:  [1.29462434e+02 9.57811948e-03]
mat_Sqrt:  [[ 1.26702117e+01 -3.91194509e-03]
 [-3.91194509e-03  8.97094646e-03]]
grads:  [ 1.38006584e-02 -2.63195364e+01]
Stock Position:  0.013800658434780596
Bond Position:  [28.30366072]


portfolio before change:  [30.11691115]
curr_Stock_Price:  128.8234716252
curr_Factors:  [1.28823472e+02 1.08458449e-02]
mat_Sqrt:  [[ 1.34161119e+01 -4.16277365e-03]
 [-4.16277365e-03  9.54619113e-03]]
grads:  [ 1.07502736e-02 -1.59554219e+01]
Stock Position:  0.010750273613423931
Bond Position:  [28.73202358]


portfolio before change:  [30.1450694]
curr_Stock_Price:  128.09984015817201
curr_Factors:  [1.28099840e+02 8.99122803e-03]
mat_Sqrt:  [[ 1.21466935e+01 -3.79017151e-03]
 [-3.79017151e-03  8.69177083e-03]]
grads:  [-0.01149625  5.78447779]
Stock Position:  -0.011496254777485768
Bond Position:  [31.6177378]


portfolio before change:  [30.18721168]
curr_Stock_Price:  127.87408011431911
curr_Factors:  [1.27874080e+02 9.49580378e-03]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [30.18721168]
Stock Price:  127.59216326531931
PL:  [2.59504841]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.36775175e-01 -1.74015778e-02]
 [-1.63685667e-01  8.29670491e-02]
 [ 5.27662389e-02  8.54785482e-02]
 [ 2.56935168e-02  2.32409256e-02]
 [ 1.51856805e-01 -1.08932287e-01]
 [ 1.27252440e-01  1.25712419e-01]
 [ 3.37473675e-02  5.42627304e-02]
 [-2.53062383e-01  6.52189012e-02]
 [ 5.94619058e-02  4.95391854e-02]
 [ 6.54922869e-02 -5.19922375e-02]
 [ 6.72099912e-02 -1.29199586e-01]
 [-1.00764319e-02  3.76508104e-02]
 [-8.94748217e-02 -1.37965452e-01]
 [ 1.12590112e-02  7.64241786e-02]
 [-5.70478147e-02 -9.12304203e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 2.84563960e-02 -1.46104957e-01]
 [-5.82507094e-02  3.96956990e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.89804089]
curr_Stock_Price:  94.57192868558026
curr_Factors:  [9.45719287e+01 4.04390222e-02]
mat_Sqrt:  [[ 1.90178987e+01 -8.03599386e-03]
 [-8.03599386e-03  1.84340181e-02]]
grads:  [ 0.00679429 -0.94103081]
Stock Position:  0.006794286733667963
Bond Position:  [-14.54058969]


portfolio before change:  [-13.93272364]
curr_Stock_Price:  92.14405813209373
curr_Factors:  [9.21440581e+01 4.21023558e-02]
mat_Sqrt:  [[ 1.89069072e+01 -8.19938711e-03]
 [-8.19938711e-03  1.88094021e-02]]
grads:  [-0.00674583  4.4079943 ]
Stock Position:  -0.006745831776734876
Bond Position:  [-13.31113533]


portfolio before change:  [-13.96887488]
curr_Stock_Price:  95.03501528382854
curr_Factors:  [9.50350153e+01 4.43966150e-02]
mat_Sqrt:  [[ 2.00243552e+01 -8.42008066e-03]
 [-8.42008066e-03  1.93149784e-02]]
grads:  [0.00449682 4.42746608]
Stock Position:  0.004496816976369496
Bond Position:  [-14.39622995]


portfolio before change:  [-13.97875235]
curr_Stock_Price:  96.84275377652716
curr_Factors:  [9.68427538e+01 4.68284483e-02]
mat_Sqrt:  [[ 2.09566556e+01 -8.64776777e-03]
 [-8.64776777e-03  1.98368494e-02]]
grads:  [0.0017098  1.17234905]
Stock Position:  0.0017098013987968948
Bond Position:  [-14.14433422]


portfolio before change:  [-13.98480364]
curr_Stock_Price:  103.65066919164938
curr_Factors:  [1.03650669e+02 4.98362916e-02]
mat_Sqrt:  [[ 2.31390187e+01 -8.92172781e-03]
 [-8.92172781e-03  2.04637653e-02]]
grads:  [ 4.51109869e-03 -5.32121235e+00]
Stock Position:  0.004511098688428535
Bond Position:  [-14.45238203]


portfolio before change:  [-14.01312786]
curr_Stock_Price:  101.37905996674388
curr_Factors:  [1.01379060e+02 4.99763256e-02]
mat_Sqrt:  [[ 2.26636778e+01 -8.93407663e-03]
 [-8.93407663e-03  2.04925726e-02]]
grads:  [0.00803445 6.13803849]
Stock Position:  0.008034448236167285
Bond Position:  [-14.82765267]


portfolio before change:  [-14.02178039]
curr_Stock_Price:  102.61046106731565
curr_Factors:  [1.02610461e+02 5.26112850e-02]
mat_Sqrt:  [[ 2.35359136e+01 -9.16667164e-03]
 [-9.16667164e-03  2.10258170e-02]]
grads:  [2.43942765e-03 2.58183032e+00]
Stock Position:  0.0024394276461857127
Bond Position:  [-14.27209119]


portfolio before change:  [-14.03717623]
curr_Stock_Price:  103.61702180543644
curr_Factors:  [1.03617022e+02 5.15682713e-02]
mat_Sqrt:  [[ 2.35300234e+01 -9.07543127e-03]
 [-9.07543127e-03  2.08163220e-02]]
grads:  [-0.00954807  3.12890282]
Stock Position:  -0.009548066997451317
Bond Position:  [-13.04783396]


portfolio before change:  [-14.02447593]
curr_Stock_Price:  100.57763291234397
curr_Factors:  [1.00577633e+02 5.19014573e-02]
mat_Sqrt:  [[ 2.29134852e+01 -9.10445937e-03]
 [-9.10445937e-03  2.08835675e-02]]
grads:  [0.00353823 2.37370358]
Stock Position:  0.0035382305539466957
Bond Position:  [-14.38034278]


portfolio before change:  [-14.03425241]
curr_Stock_Price:  102.89805375876385
curr_Factors:  [1.02898054e+02 5.00034694e-02]
mat_Sqrt:  [[ 2.30095008e+01 -8.93662167e-03]
 [-8.93662167e-03  2.04980850e-02]]
grads:  [ 1.86150506e-03 -2.53563209e+00]
Stock Position:  0.0018615050645869396
Bond Position:  [-14.22579766]


portfolio before change:  [-14.05724624]
curr_Stock_Price:  100.1043665362718
curr_Factors:  [1.00104367e+02 5.15955942e-02]
mat_Sqrt:  [[ 2.27383683e+01 -9.07755367e-03]
 [-9.07755367e-03  2.08219586e-02]]
grads:  [ 4.78748351e-04 -6.20475923e+00]
Stock Position:  0.0004787483512321823
Bond Position:  [-14.10517104]


portfolio before change:  [-14.07385609]
curr_Stock_Price:  102.26132768830323
curr_Factors:  [1.02261328e+02 5.20533122e-02]
mat_Sqrt:  [[ 2.33311195e+01 -9.11790539e-03]
 [-9.11790539e-03  2.09140365e-02]]
grads:  [2.71709858e-04 1.80038358e+00]
Stock Position:  0.00027170985804802393
Bond Position:  [-14.1016415]


portfolio before change:  [-14.09283998]
curr_Stock_Price:  97.30816293112235
curr_Factors:  [9.73081629e+01 5.54304987e-02]
mat_Sqrt:  [[ 2.29099230e+01 -9.40861054e-03]
 [-9.40861054e-03  2.15820072e-02]]
grads:  [-0.00653198 -6.39546211]
Stock Position:  -0.00653198326938609
Bond Position:  [-13.45722469]


portfolio before change:  [-14.12754135]
curr_Stock_Price:  100.04382748130419
curr_Factors:  [1.00043827e+02 5.64486908e-02]
mat_Sqrt:  [[ 2.37693443e+01 -9.49487415e-03]
 [-9.49487415e-03  2.17792165e-02]]
grads:  [1.87572211e-03 3.50985942e+00]
Stock Position:  0.0018757221136545673
Bond Position:  [-14.31519577]


portfolio before change:  [-14.14513901]
curr_Stock_Price:  100.20777409445212
curr_Factors:  [1.00207774e+02 5.94740168e-02]
mat_Sqrt:  [[ 2.44379638e+01 -9.74600348e-03]
 [-9.74600348e-03  2.23552138e-02]]
grads:  [-3.96258731e-03 -4.08267353e+00]
Stock Position:  -0.003962587309450646
Bond Position:  [-13.74805696]


portfolio before change:  [-14.1784426]
curr_Stock_Price:  104.27273767048256
curr_Factors:  [1.04272738e+02 5.84032066e-02]
mat_Sqrt:  [[ 2.51993356e+01 -9.65821227e-03]
 [-9.65821227e-03  2.21529005e-02]]
grads:  [ 0.00431171 -2.75367556]
Stock Position:  0.004311712127740192
Bond Position:  [-14.62803663]


portfolio before change:  [-14.18950128]
curr_Stock_Price:  105.95137439707361
curr_Factors:  [1.05951374e+02 5.55744935e-02]
mat_Sqrt:  [[ 2.49772327e+01 -9.42154659e-03]
 [-9.42154659e-03  2.16097060e-02]]
grads:  [-1.41125456e-03 -6.76169555e+00]
Stock Position:  -0.0014112545635910016
Bond Position:  [-14.03997692]


portfolio before change:  [-14.21564544]
curr_Stock_Price:  112.0333505116278
curr_Factors:  [1.12033351e+02 5.26166375e-02]
mat_Sqrt:  [[ 2.56985632e+01 -9.16782616e-03]
 [-9.16782616e-03  2.10265865e-02]]
grads:  [-1.59344751e-03  1.88718652e+00]
Stock Position:  -0.0015934475085517341
Bond Position:  [-14.03712618]


portfolio before change:  [-14.22968013]
curr_Stock_Price:  109.82261339127483
curr_Factors:  [1.09822613e+02 4.78688845e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.22968013]
Stock Price:  104.81344833358708
PL:  [-19.04312846]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.13837845e-01 -1.66137488e-02]
 [-1.53080012e-01  8.13355557e-02]
 [ 4.53504646e-02  1.07520842e-01]
 [-1.09254853e-02 -2.44960009e-03]
 [-1.17967505e-01 -6.94743062e-02]
 [ 1.28165753e-01  1.30664895e-01]
 [ 2.45901070e-02  4.24267837e-02]
 [-7.21919889e-02  9.31277756e-02]
 [ 7.83355467e-02  7.01530264e-02]
 [ 6.07323695e-02 -3.29733769e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 2.96179097e-02  3.14916675e-02]
 [ 3.28020807e-02  5.00949414e-02]
 [ 1.33364477e-02 -7.97054437e-02]
 [-4.74519919e-02 -8.71125911e-02]
 [ 1.45727889e-01 -7.39163717e-02]
 [ 7.21359375e-02 -1.51220884e-01]
 [-5.75472472e-02  3.96580605e-02]
 [-9.02387592e-02 -8.33553097e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.01295537]
curr_Stock_Price:  98.55742733716359
curr_Factors:  [9.85574273e+01 3.71653770e-02]
mat_Sqrt:  [[ 1.90002184e+01 -7.70416456e-03]
 [-7.70416456e-03  1.76720010e-02]]
grads:  [ 0.00561119 -0.9376708 ]
Stock Position:  0.005611192085319273
Bond Position:  [0.45993071]


portfolio before change:  [0.97915809]
curr_Stock_Price:  92.43171536367379
curr_Factors:  [9.24317154e+01 3.68843861e-02]
mat_Sqrt:  [[ 1.77517941e+01 -7.67451281e-03]
 [-7.67451281e-03  1.76052752e-02]]
grads:  [-0.00662729  4.61706469]
Stock Position:  -0.00662729014192696
Bond Position:  [1.59172989]


portfolio before change:  [0.9778947]
curr_Stock_Price:  92.92276066805496
curr_Factors:  [9.29227607e+01 3.72035873e-02]
mat_Sqrt:  [[ 1.79231555e+01 -7.70768963e-03]
 [-7.70768963e-03  1.76812724e-02]]
grads:  [5.14634063e-03 6.08330136e+00]
Stock Position:  0.005146340633403145
Bond Position:  [0.49968252]


portfolio before change:  [0.99210554]
curr_Stock_Price:  95.56266445005642
curr_Factors:  [9.55626645e+01 3.73194425e-02]
mat_Sqrt:  [[ 1.84610239e+01 -7.71989168e-03]
 [-7.71989168e-03  1.77086899e-02]]
grads:  [-0.00064978 -0.13861084]
Stock Position:  -0.0006497768495616649
Bond Position:  [1.05419994]


portfolio before change:  [0.99005317]
curr_Stock_Price:  100.75051302406003
curr_Factors:  [1.00750513e+02 3.41360452e-02]
mat_Sqrt:  [[ 1.86146054e+01 -7.38365960e-03]
 [-7.38365960e-03  1.69364112e-02]]
grads:  [-0.00796586 -4.10554059]
Stock Position:  -0.007965864225684847
Bond Position:  [1.79261807]


portfolio before change:  [1.00125444]
curr_Stock_Price:  99.62582605384644
curr_Factors:  [9.96258261e+01 3.20583006e-02]
mat_Sqrt:  [[ 1.78378353e+01 -7.15534957e-03]
 [-7.15534957e-03  1.64129211e-02]]
grads:  [0.01038033 7.96562469]
Stock Position:  0.010380328068972378
Bond Position:  [-0.03289431]


portfolio before change:  [1.00767513]
curr_Stock_Price:  100.24833372326307
curr_Factors:  [1.00248334e+02 3.19002961e-02]
mat_Sqrt:  [[ 1.79050066e+01 -7.13773540e-03]
 [-7.13773540e-03  1.63724065e-02]]
grads:  [2.40681462e-03 2.59240833e+00]
Stock Position:  0.0024068146173078253
Bond Position:  [0.76639598]


portfolio before change:  [1.01003766]
curr_Stock_Price:  100.83165035846338
curr_Factors:  [1.00831650e+02 3.56821711e-02]
mat_Sqrt:  [[ 1.90468200e+01 -7.54902768e-03]
 [-7.54902768e-03  1.73157123e-02]]
grads:  [-1.65891673e-03  5.37750055e+00]
Stock Position:  -0.001658916733579185
Bond Position:  [1.17730898]


portfolio before change:  [1.00536832]
curr_Stock_Price:  104.53400627507915
curr_Factors:  [1.04534006e+02 3.35978201e-02]
mat_Sqrt:  [[ 1.91607769e+01 -7.32546003e-03]
 [-7.32546003e-03  1.68022569e-02]]
grads:  [0.00568552 4.17769327]
Stock Position:  0.005685524785895857
Bond Position:  [0.41103764]


portfolio before change:  [1.02497994]
curr_Stock_Price:  107.89297607578821
curr_Factors:  [1.07892976e+02 3.35977974e-02]
mat_Sqrt:  [[ 1.97764596e+01 -7.32565738e-03]
 [-7.32565738e-03  1.68021641e-02]]
grads:  [ 0.00234438 -1.96142608]
Stock Position:  0.002344384942426323
Bond Position:  [0.77203728]


portfolio before change:  [1.01860983]
curr_Stock_Price:  104.76389590987445
curr_Factors:  [1.04763896e+02 3.09149495e-02]
mat_Sqrt:  [[ 1.84202652e+01 -7.02691110e-03]
 [-7.02691110e-03  1.61174444e-02]]
grads:  [ 5.21310664e-04 -7.59104472e+00]
Stock Position:  0.0005213106636798759
Bond Position:  [0.96399529]


portfolio before change:  [1.02136078]
curr_Stock_Price:  107.7279846338559
curr_Factors:  [1.07727985e+02 3.21500865e-02]
mat_Sqrt:  [[ 1.93161059e+01 -7.16608092e-03]
 [-7.16608092e-03  1.64361842e-02]]
grads:  [0.00224451 1.91697486]
Stock Position:  0.0022445055334237695
Bond Position:  [0.77956473]


portfolio before change:  [1.02320703]
curr_Stock_Price:  108.11612476818354
curr_Factors:  [1.08116125e+02 3.12068898e-02]
mat_Sqrt:  [[ 1.90992223e+01 -7.06020325e-03]
 [-7.06020325e-03  1.61932834e-02]]
grads:  [2.86148154e-03 3.09481053e+00]
Stock Position:  0.002861481536718827
Bond Position:  [0.71383474]


portfolio before change:  [1.01627636]
curr_Stock_Price:  105.38204312636063
curr_Factors:  [1.05382043e+02 3.09018750e-02]
mat_Sqrt:  [[ 1.85250334e+01 -7.02546106e-03]
 [-7.02546106e-03  1.61140202e-02]]
grads:  [-1.15613404e-03 -4.94684536e+00]
Stock Position:  -0.0011561340443866541
Bond Position:  [1.13811213]


portfolio before change:  [1.01700994]
curr_Stock_Price:  105.97881911755994
curr_Factors:  [1.05978819e+02 3.26710704e-02]
mat_Sqrt:  [[ 1.91558191e+01 -7.22380847e-03]
 [-7.22380847e-03  1.65688652e-02]]
grads:  [-4.46057618e-03 -5.25955231e+00]
Stock Position:  -0.004460576184529721
Bond Position:  [1.48973653]


portfolio before change:  [1.00662533]
curr_Stock_Price:  108.72464048631734
curr_Factors:  [1.0872464e+02 3.0043656e-02]
mat_Sqrt:  [[ 1.88453558e+01 -6.92740230e-03]
 [-6.92740230e-03  1.58886015e-02]]
grads:  [ 0.00602369 -4.64953717]
Stock Position:  0.006023694976786453
Bond Position:  [0.35170125]


portfolio before change:  [1.0158504]
curr_Stock_Price:  110.18307687759024
curr_Factors:  [1.10183077e+02 2.86847293e-02]
mat_Sqrt:  [[ 1.86612291e+01 -6.76899572e-03]
 [-6.76899572e-03  1.55250762e-02]]
grads:  [ 3.32454216e-04 -9.74028288e+00]
Stock Position:  0.0003324542155203743
Bond Position:  [0.97921957]


portfolio before change:  [1.01766408]
curr_Stock_Price:  111.95440294437253
curr_Factors:  [1.11954403e+02 2.74534118e-02]
mat_Sqrt:  [[ 1.85498035e+01 -6.62220675e-03]
 [-6.62220675e-03  1.51881696e-02]]
grads:  [-2.17049035e-03  2.61016884e+00]
Stock Position:  -0.0021704903543045646
Bond Position:  [1.26066003]


portfolio before change:  [1.01628183]
curr_Stock_Price:  113.31771678781662
curr_Factors:  [1.13317717e+02 3.00015020e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.01628183]
Stock Price:  116.42154490268457
PL:  [-15.40526307]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.69384954e-01  4.39251400e-03]
 [ 2.33027724e-02 -6.37970969e-02]
 [ 7.08460921e-02 -1.12701426e-01]
 [-2.42915297e-02 -2.96094628e-02]
 [-7.33870136e-02 -7.64230208e-02]
 [ 1.27819040e-01  1.08301798e-01]
 [ 2.76108763e-02  4.63311900e-02]
 [-2.29430832e-01  6.87951164e-02]
 [ 7.07192929e-02  6.20502147e-02]
 [ 6.61166806e-02 -5.34114401e-02]
 [ 6.27492227e-02 -1.21816055e-01]
 [-9.48318581e-03  4.00323410e-02]
 [ 2.58094210e-03 -4.39877792e-02]
 [ 1.05168879e-02  6.09363765e-02]
 [-4.92989013e-02 -9.06225920e-02]
 [ 8.16392066e-02 -5.29485958e-02]
 [ 7.50975347e-03 -9.81770529e-02]
 [ 5.63461468e-02  3.80997000e-02]
 [ 8.13156107e-02  4.09625409e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.78277989]
curr_Stock_Price:  97.81016679883575
curr_Factors:  [9.78101668e+01 3.91499691e-02]
mat_Sqrt:  [[ 1.93530614e+01 -7.90713053e-03]
 [-7.90713053e-03  1.81377225e-02]]
grads:  [0.00885288 0.24603502]
Stock Position:  0.008852882823224998
Bond Position:  [-2.64868184]


portfolio before change:  [-1.76244001]
curr_Stock_Price:  100.48192977637487
curr_Factors:  [1.00481930e+02 3.59789193e-02]
mat_Sqrt:  [[ 1.90595214e+01 -7.58032920e-03]
 [-7.58032920e-03  1.73875761e-02]]
grads:  [-2.36687186e-04 -3.66922282e+00]
Stock Position:  -0.00023668718639957011
Bond Position:  [-1.73865722]


portfolio before change:  [-1.76498328]
curr_Stock_Price:  102.03922912247306
curr_Factors:  [1.02039229e+02 3.19583028e-02]
mat_Sqrt:  [[ 1.82414346e+01 -7.14433654e-03]
 [-7.14433654e-03  1.63872354e-02]]
grads:  [ 1.19044385e-03 -6.87687208e+00]
Stock Position:  0.001190443850536929
Bond Position:  [-1.88645525]


portfolio before change:  [-1.76383505]
curr_Stock_Price:  104.9858414247567
curr_Factors:  [1.04985841e+02 2.86566659e-02]
mat_Sqrt:  [[ 1.77722958e+01 -6.76540533e-03]
 [-6.76540533e-03  1.55176013e-02]]
grads:  [-0.00209353 -1.90903387]
Stock Position:  -0.0020935346870033238
Bond Position:  [-1.54404355]


portfolio before change:  [-1.75794648]
curr_Stock_Price:  101.25061491252603
curr_Factors:  [1.01250615e+02 3.18896987e-02]
mat_Sqrt:  [[ 1.80810166e+01 -7.13661424e-03]
 [-7.13661424e-03  1.63696587e-02]]
grads:  [-0.0059025  -4.67115084]
Stock Position:  -0.0059025008312837005
Bond Position:  [-1.16031464]


portfolio before change:  [-1.77459168]
curr_Stock_Price:  103.82476088606101
curr_Factors:  [1.03824761e+02 2.53230785e-02]
mat_Sqrt:  [[ 1.65218684e+01 -6.35967620e-03]
 [-6.35967620e-03  1.45871623e-02]]
grads:  [0.01059599 7.42907925]
Stock Position:  0.01059599161312336
Bond Position:  [-2.87471798]


portfolio before change:  [-1.8048526]
curr_Stock_Price:  101.3082171846364
curr_Factors:  [1.01308217e+02 2.47143573e-02]
mat_Sqrt:  [[ 1.59264616e+01 -6.28263599e-03]
 [-6.28263599e-03  1.44108313e-02]]
grads:  [3.00242050e-03 3.21633445e+00]
Stock Position:  0.0030024205034129984
Bond Position:  [-2.10902247]


portfolio before change:  [-1.80229477]
curr_Stock_Price:  103.03874197561159
curr_Factors:  [1.03038742e+02 1.99375467e-02]
mat_Sqrt:  [[ 1.45491082e+01 -5.64299532e-03]
 [-5.64299532e-03  1.29434180e-02]]
grads:  [-0.01371023  5.30908832]
Stock Position:  -0.01371023353504333
Bond Position:  [-0.38960955]


portfolio before change:  [-1.78759478]
curr_Stock_Price:  101.93100722321277
curr_Factors:  [1.01931007e+02 1.92199675e-02]
mat_Sqrt:  [[ 1.41313160e+01 -5.54046175e-03]
 [-5.54046175e-03  1.27083814e-02]]
grads:  [0.00691995 4.88563825]
Stock Position:  0.006919948930712305
Bond Position:  [-2.49295214]


portfolio before change:  [-1.78614908]
curr_Stock_Price:  102.59052634829854
curr_Factors:  [1.02590526e+02 1.84423336e-02]
mat_Sqrt:  [[ 1.39320544e+01 -5.42725318e-03]
 [-5.42725318e-03  1.24486248e-02]]
grads:  [ 3.07478399e-03 -4.28920893e+00]
Stock Position:  0.0030747839881429106
Bond Position:  [-2.10159279]


portfolio before change:  [-1.78489491]
curr_Stock_Price:  103.8533165578533
curr_Factors:  [1.03853317e+02 2.09472435e-02]
mat_Sqrt:  [[ 1.50308582e+01 -5.78416003e-03]
 [-5.78416003e-03  1.32670995e-02]]
grads:  [ 6.4146384e-04 -9.1815355e+00]
Stock Position:  0.0006414638397130391
Bond Position:  [-1.85151305]


portfolio before change:  [-1.78782461]
curr_Stock_Price:  102.89634602198731
curr_Factors:  [1.02896346e+02 1.87017824e-02]
mat_Sqrt:  [[ 1.40715332e+01 -5.46530995e-03]
 [-5.46530995e-03  1.25358770e-02]]
grads:  [5.66477229e-04 3.19366863e+00]
Stock Position:  0.0005664772288708945
Bond Position:  [-1.84611304]


portfolio before change:  [-1.78991498]
curr_Stock_Price:  103.28242661101599
curr_Factors:  [1.03282427e+02 2.04337217e-02]
mat_Sqrt:  [[ 1.47638675e+01 -5.71279289e-03]
 [-5.71279289e-03  1.31034810e-02]]
grads:  [-1.12432867e-03 -3.35744389e+00]
Stock Position:  -0.0011243286714293695
Bond Position:  [-1.67379159]


portfolio before change:  [-1.78911012]
curr_Stock_Price:  100.70452430588703
curr_Factors:  [1.00704524e+02 1.93523150e-02]
mat_Sqrt:  [[ 1.40092669e+01 -5.55944382e-03]
 [-5.55944382e-03  1.27520874e-02]]
grads:  [2.64748590e-03 4.77969551e+00]
Stock Position:  0.0026474858952199244
Bond Position:  [-2.05572393]


portfolio before change:  [-1.78602183]
curr_Stock_Price:  102.84223272187735
curr_Factors:  [1.02842233e+02 1.99012024e-02]
mat_Sqrt:  [[ 1.45081194e+01 -5.63784007e-03]
 [-5.63784007e-03  1.29316195e-02]]
grads:  [-6.12229414e-03 -7.01049922e+00]
Stock Position:  -0.006122294144452685
Bond Position:  [-1.15639143]


portfolio before change:  [-1.75918129]
curr_Stock_Price:  98.22191653621655
curr_Factors:  [9.82219165e+01 2.17304862e-02]
mat_Sqrt:  [[ 1.44791507e+01 -5.89100814e-03]
 [-5.89100814e-03  1.35129895e-02]]
grads:  [ 0.00404489 -3.91658466]
Stock Position:  0.004044890164770724
Bond Position:  [-2.15647815]


portfolio before change:  [-1.75551196]
curr_Stock_Price:  99.79590509294789
curr_Factors:  [9.97959051e+01 2.34724317e-02]
mat_Sqrt:  [[ 1.52894452e+01 -6.12266263e-03]
 [-6.12266263e-03  1.40441204e-02]]
grads:  [-2.30862477e-03 -6.99162245e+00]
Stock Position:  -0.002308624771475033
Bond Position:  [-1.52512066]


portfolio before change:  [-1.75590078]
curr_Stock_Price:  99.13803659368402
curr_Factors:  [9.91380366e+01 2.26375924e-02]
mat_Sqrt:  [[ 1.49161038e+01 -6.01275851e-03]
 [-6.01275851e-03  1.37921231e-02]]
grads:  [0.00489195 2.76455726]
Stock Position:  0.004891945174027054
Bond Position:  [-2.24087862]


portfolio before change:  [-1.77442177]
curr_Stock_Price:  95.92497261337591
curr_Factors:  [9.59249726e+01 2.76790915e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.77442177]
Stock Price:  102.79210287723562
PL:  [-4.56652464]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-1.75783984e-02 -6.17145990e-02]
 [-2.11023099e-02 -1.17186692e-01]
 [-4.41146433e-01 -1.13406475e-01]
 [-2.36820073e-02 -2.79527476e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [ 2.29483400e-02 -3.96394324e-02]
 [ 4.68000142e-02  3.85782710e-02]
 [ 7.79984101e-02 -6.02694839e-02]
 [ 1.24054118e-01 -1.12611788e-01]
 [ 4.40905505e-01 -2.64399824e-02]
 [ 4.22840389e-02  2.30592672e-01]
 [-7.81339946e-02 -9.07398951e-02]
 [ 7.60120244e-02 -1.45944939e-01]
 [ 2.27362418e-01 -1.74189715e-01]
 [ 1.51002606e-01 -1.50718623e-01]
 [-1.21059122e-01  4.61542390e-02]
 [-1.07343604e-01 -1.17818317e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.71051045]
curr_Stock_Price:  102.2185903054329
curr_Factors:  [1.02218590e+02 3.56386745e-02]
mat_Sqrt:  [[ 1.92970368e+01 -7.54451812e-03]
 [-7.54451812e-03  1.73051146e-02]]
grads:  [-2.30562455e-03 -3.56726871e+00]
Stock Position:  -0.002305624547413873
Bond Position:  [14.94618814]


portfolio before change:  [14.72446115]
curr_Stock_Price:  104.27604389742913
curr_Factors:  [1.04276044e+02 3.30340581e-02]
mat_Sqrt:  [[ 1.89524552e+01 -7.26372471e-03]
 [-7.26372471e-03  1.66606988e-02]]
grads:  [-3.80981677e-03 -7.03538113e+00]
Stock Position:  -0.0038098167723673968
Bond Position:  [15.12173377]


portfolio before change:  [14.7227742]
curr_Stock_Price:  109.68337441240783
curr_Factors:  [1.09683374e+02 3.15089405e-02]
mat_Sqrt:  [[ 1.94696289e+01 -7.09437461e-03]
 [-7.09437461e-03  1.62714245e-02]]
grads:  [-0.02520181 -6.98065903]
Stock Position:  -0.025201807639596438
Bond Position:  [17.4869935]


portfolio before change:  [14.87297384]
curr_Stock_Price:  104.59138939779203
curr_Factors:  [1.04591389e+02 3.28842859e-02]
mat_Sqrt:  [[ 1.89666272e+01 -7.24725879e-03]
 [-7.24725879e-03  1.66228788e-02]]
grads:  [-0.00189147 -1.68240748]
Stock Position:  -0.0018914722860310037
Bond Position:  [15.07080555]


portfolio before change:  [14.88903552]
curr_Stock_Price:  106.06569064076496
curr_Factors:  [1.06065691e+02 3.32263614e-02]
mat_Sqrt:  [[ 1.93337583e+01 -7.28494438e-03]
 [-7.28494438e-03  1.67090754e-02]]
grads:  [ 0.00848141 -7.06491117]
Stock Position:  0.008481408213247447
Bond Position:  [13.9894491]


portfolio before change:  [14.94073207]
curr_Stock_Price:  110.09789858419043
curr_Factors:  [1.10097899e+02 3.41275107e-02]
mat_Sqrt:  [[ 2.03390801e+01 -7.38330634e-03]
 [-7.38330634e-03  1.69340454e-02]]
grads:  [0.00850441 6.27572143]
Stock Position:  0.008504413229040962
Bond Position:  [14.00441404]


portfolio before change:  [14.9797958]
curr_Stock_Price:  112.63155590121603
curr_Factors:  [1.12631556e+02 2.90243070e-02]
mat_Sqrt:  [[ 1.91884982e+01 -6.80906750e-03]
 [-6.80906750e-03  1.56166472e-02]]
grads:  [4.67725799e-03 5.18802174e+00]
Stock Position:  0.004677257994428925
Bond Position:  [14.45298896]


portfolio before change:  [15.0171933]
curr_Stock_Price:  116.76217298573918
curr_Factors:  [1.16762173e+02 2.92375245e-02]
mat_Sqrt:  [[ 1.99651438e+01 -6.83422862e-03]
 [-6.83422862e-03  1.56738178e-02]]
grads:  [ 2.83758035e-04 -2.52889842e+00]
Stock Position:  0.0002837580351565882
Bond Position:  [14.98406109]


portfolio before change:  [15.03671845]
curr_Stock_Price:  119.52284525232973
curr_Factors:  [1.19522845e+02 3.04338729e-02]
mat_Sqrt:  [[ 2.08511259e+01 -6.97277552e-03]
 [-6.97277552e-03  1.59912204e-02]]
grads:  [0.00305168 2.41379636]
Stock Position:  0.0030516757111746055
Bond Position:  [14.67197348]


portfolio before change:  [15.05852351]
curr_Stock_Price:  120.65456237944315
curr_Factors:  [1.20654562e+02 3.22059036e-02]
mat_Sqrt:  [[ 2.16526706e+01 -7.17295223e-03]
 [-7.17295223e-03  1.64501608e-02]]
grads:  [ 2.38889183e-03 -3.66272093e+00]
Stock Position:  0.0023888918258767955
Bond Position:  [14.77029282]


portfolio before change:  [15.08552908]
curr_Stock_Price:  124.2257409867881
curr_Factors:  [1.24225741e+02 2.90477932e-02]
mat_Sqrt:  [[ 2.11723052e+01 -6.81233888e-03]
 [-6.81233888e-03  1.56227389e-02]]
grads:  [ 3.54047187e-03 -7.20665373e+00]
Stock Position:  0.0035404718655449975
Bond Position:  [14.64571134]


portfolio before change:  [15.09816338]
curr_Stock_Price:  122.62022386916313
curr_Factors:  [1.22620224e+02 2.67199157e-02]
mat_Sqrt:  [[ 2.00437798e+01 -6.53360720e-03]
 [-6.53360720e-03  1.49836956e-02]]
grads:  [ 0.02142497 -1.75524121]
Stock Position:  0.021424973377879426
Bond Position:  [12.47102835]


portfolio before change:  [15.18459286]
curr_Stock_Price:  125.92622327300803
curr_Factors:  [1.25926223e+02 2.84358684e-02]
mat_Sqrt:  [[ 2.12348601e+01 -6.74026923e-03]
 [-6.74026923e-03  1.54572784e-02]]
grads:  [6.72740864e-03 1.49209978e+01]
Stock Position:  0.006727408635541313
Bond Position:  [14.3374357]


portfolio before change:  [15.20781831]
curr_Stock_Price:  126.71292282047142
curr_Factors:  [1.26712923e+02 2.92256596e-02]
mat_Sqrt:  [[ 2.16622243e+01 -6.83326272e-03]
 [-6.83326272e-03  1.56704536e-02]]
grads:  [-5.43426435e-03 -5.79287818e+00]
Stock Position:  -0.005434264350329688
Bond Position:  [15.89640983]


portfolio before change:  [15.22659777]
curr_Stock_Price:  126.91598198217605
curr_Factors:  [1.26915982e+02 2.87962128e-02]
mat_Sqrt:  [[ 2.15369391e+01 -6.78288021e-03]
 [-6.78288021e-03  1.55548920e-02]]
grads:  [ 5.74493992e-04 -9.38232438e+00]
Stock Position:  0.000574493991628154
Bond Position:  [15.1536853]


portfolio before change:  [15.2424256]
curr_Stock_Price:  121.47446142639187
curr_Factors:  [1.21474461e+02 2.67515442e-02]
mat_Sqrt:  [[ 1.98682395e+01 -6.53742693e-03]
 [-6.53742693e-03  1.49925812e-02]]
grads:  [ 7.62169906e-03 -1.16150706e+01]
Stock Position:  0.007621699055730834
Bond Position:  [14.31658381]


portfolio before change:  [15.26428289]
curr_Stock_Price:  121.99276694201265
curr_Factors:  [1.21992767e+02 2.60532376e-02]
mat_Sqrt:  [[ 1.96908702e+01 -6.45155882e-03]
 [-6.45155882e-03  1.47955995e-02]]
grads:  [ 4.33168118e-03 -1.01848307e+01]
Stock Position:  0.004331681178124935
Bond Position:  [14.73584912]


portfolio before change:  [15.28187883]
curr_Stock_Price:  121.79991167882793
curr_Factors:  [1.21799912e+02 2.67352434e-02]
mat_Sqrt:  [[ 1.99153994e+01 -6.53544803e-03]
 [-6.53544803e-03  1.49880070e-02]]
grads:  [-0.00506885  3.07720111]
Stock Position:  -0.005068853079787348
Bond Position:  [15.89926469]


portfolio before change:  [15.31125174]
curr_Stock_Price:  119.9284023730508
curr_Factors:  [1.19928402e+02 2.97601195e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.31125174]
Stock Price:  116.34575928054558
PL:  [-1.03450754]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.65713784e-01  3.13498852e-03]
 [-1.47883325e-02  6.12640194e-02]
 [ 5.31826954e-02  8.42407484e-02]
 [ 1.90308331e-02  2.30745186e-02]
 [ 1.07391679e-01 -1.02514670e-01]
 [ 1.28409473e-01  1.09345818e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-2.35703384e-01  6.78700679e-02]
 [ 6.51532531e-02  5.47811135e-02]
 [ 6.65787484e-02 -5.44616878e-02]
 [ 6.73222514e-02 -1.29430339e-01]
 [-1.03129083e-02  3.66703910e-02]
 [ 3.43251862e-02  5.80673054e-03]
 [-2.61873210e-02 -1.80348403e-01]
 [-2.87045719e-02 -9.74497724e-02]
 [ 1.52417737e-01 -8.21336466e-02]
 [ 6.89904777e-02 -1.49176544e-01]
 [-5.90488563e-02  3.97888190e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.11483594]
curr_Stock_Price:  97.45412703519388
curr_Factors:  [9.74541270e+01 4.28710315e-02]
mat_Sqrt:  [[ 2.01781881e+01 -8.27434600e-03]
 [-8.27434600e-03  1.89801347e-02]]
grads:  [0.00828173 0.16878249]
Stock Position:  0.008281732129514293
Bond Position:  [-3.92192491]


portfolio before change:  [-3.12987819]
curr_Stock_Price:  96.23013406911575
curr_Factors:  [9.62301341e+01 4.24646002e-02]
mat_Sqrt:  [[ 1.98300849e+01 -8.23493242e-03]
 [-8.23493242e-03  1.88899944e-02]]
grads:  [6.01175135e-04 3.24346152e+00]
Stock Position:  0.000601175134788198
Bond Position:  [-3.18772935]


portfolio before change:  [-3.13451251]
curr_Stock_Price:  95.15363793072133
curr_Factors:  [9.51536379e+01 4.41387997e-02]
mat_Sqrt:  [[ 1.99910506e+01 -8.39560705e-03]
 [-8.39560705e-03  1.92588104e-02]]
grads:  [0.00449815 4.3761017 ]
Stock Position:  0.004498149075884936
Bond Position:  [-3.56252776]


portfolio before change:  [-3.12649546]
curr_Stock_Price:  97.92655449659986
curr_Factors:  [9.79265545e+01 4.18732888e-02]
mat_Sqrt:  [[ 2.00386737e+01 -8.17753132e-03]
 [-8.17753132e-03  1.87579548e-02]]
grads:  [0.00145196 1.23075208]
Stock Position:  0.0014519597069890507
Bond Position:  [-3.26868087]


portfolio before change:  [-3.12294715]
curr_Stock_Price:  103.1861445333031
curr_Factors:  [1.03186145e+02 3.71703344e-02]
mat_Sqrt:  [[ 1.98938843e+01 -7.70499954e-03]
 [-7.70499954e-03  1.76730395e-02]]
grads:  [ 3.15214747e-03 -5.79925046e+00]
Stock Position:  0.003152147473368371
Bond Position:  [-3.4482051]


portfolio before change:  [-3.1270723]
curr_Stock_Price:  103.24572558190889
curr_Factors:  [1.03245726e+02 3.94194622e-02]
mat_Sqrt:  [[ 2.04987508e+01 -7.93468979e-03]
 [-7.93468979e-03  1.81998714e-02]]
grads:  [0.00859132 6.01180002]
Stock Position:  0.008591315771008154
Bond Position:  [-4.01408893]


portfolio before change:  [-3.09179076]
curr_Stock_Price:  107.93677474358367
curr_Factors:  [1.07936775e+02 3.64514471e-02]
mat_Sqrt:  [[ 2.06075705e+01 -7.63042515e-03]
 [-7.63042515e-03  1.75011738e-02]]
grads:  [4.35513118e-03 4.62945457e+00]
Stock Position:  0.004355131183807794
Bond Position:  [-3.56186957]


portfolio before change:  [-3.11695223]
curr_Stock_Price:  103.18230139263667
curr_Factors:  [1.03182301e+02 4.13535756e-02]
mat_Sqrt:  [[ 2.09827164e+01 -8.12701202e-03]
 [-8.12701202e-03  1.86410148e-02]]
grads:  [-0.00982468  3.63661654]
Stock Position:  -0.00982468397244502
Bond Position:  [-2.10321873]


portfolio before change:  [-3.14934222]
curr_Stock_Price:  106.21133667367148
curr_Factors:  [1.06211337e+02 4.06931808e-02]
mat_Sqrt:  [[ 2.14255344e+01 -8.06206288e-03]
 [-8.06206288e-03  1.84914832e-02]]
grads:  [0.00415634 2.96431723]
Stock Position:  0.0041563381080949235
Bond Position:  [-3.59079244]


portfolio before change:  [-3.17037195]
curr_Stock_Price:  102.2322487947895
curr_Factors:  [1.02232249e+02 4.33627070e-02]
mat_Sqrt:  [[ 2.12885496e+01 -8.32202429e-03]
 [-8.32202429e-03  1.90885039e-02]]
grads:  [ 2.01246033e-03 -2.85223715e+00]
Stock Position:  0.0020124603307067044
Bond Position:  [-3.37611029]


portfolio before change:  [-3.17882929]
curr_Stock_Price:  100.12807722710117
curr_Factors:  [1.00128077e+02 5.05683434e-02]
mat_Sqrt:  [[ 2.25162056e+01 -8.98673579e-03]
 [-8.98673579e-03  2.06136366e-02]]
grads:  [ 4.83989376e-04 -6.27865874e+00]
Stock Position:  0.00048398937649800556
Bond Position:  [-3.22729021]


portfolio before change:  [-3.18195454]
curr_Stock_Price:  102.0111406601976
curr_Factors:  [1.02011141e+02 5.07583947e-02]
mat_Sqrt:  [[ 2.29827244e+01 -9.00375942e-03]
 [-9.00375942e-03  2.06522702e-02]]
grads:  [2.46934700e-04 1.77571831e+00]
Stock Position:  0.0002469346997022542
Bond Position:  [-3.20714463]


portfolio before change:  [-3.18529035]
curr_Stock_Price:  104.74721139012688
curr_Factors:  [1.04747211e+02 5.02610768e-02]
mat_Sqrt:  [[ 2.34832571e+01 -8.95975269e-03]
 [-8.95975269e-03  2.05507567e-02]]
grads:  [0.00156975 0.28323994]
Stock Position:  0.0015697543961760883
Bond Position:  [-3.34971774]


portfolio before change:  [-3.17401605]
curr_Stock_Price:  114.59847554134384
curr_Factors:  [1.14598476e+02 4.41590069e-02]
mat_Sqrt:  [[ 2.40817732e+01 -8.39890019e-03]
 [-8.39890019e-03  1.92626204e-02]]
grads:  [-4.35345396e-03 -9.36450824e+00]
Stock Position:  -0.0043534539560603405
Bond Position:  [-2.67511686]


portfolio before change:  [-3.16682541]
curr_Stock_Price:  112.17818501188214
curr_Factors:  [1.12178185e+02 4.31921978e-02]
mat_Sqrt:  [[ 2.33136909e+01 -8.30630615e-03]
 [-8.30630615e-03  1.90506498e-02]]
grads:  [-3.05420855e-03 -5.11663081e+00]
Stock Position:  -0.003054208547641308
Bond Position:  [-2.82420984]


portfolio before change:  [-3.16266642]
curr_Stock_Price:  109.65987084978265
curr_Factors:  [1.09659871e+02 4.51716709e-02]
mat_Sqrt:  [[ 2.33066996e+01 -8.49435128e-03]
 [-8.49435128e-03  1.94823691e-02]]
grads:  [ 0.00500396 -4.21361185]
Stock Position:  0.0050039619294984855
Bond Position:  [-3.71140024]


portfolio before change:  [-3.1566693]
curr_Stock_Price:  111.78604169461383
curr_Factors:  [1.11786042e+02 4.61177728e-02]
mat_Sqrt:  [[ 2.40061056e+01 -8.58298199e-03]
 [-8.58298199e-03  1.96852774e-02]]
grads:  [ 1.64483009e-04 -7.57800509e+00]
Stock Position:  0.0001644830086263438
Bond Position:  [-3.1750562]


portfolio before change:  [-3.16057791]
curr_Stock_Price:  112.16715171797266
curr_Factors:  [1.12167152e+02 4.41839838e-02]
mat_Sqrt:  [[ 2.35775188e+01 -8.40112958e-03]
 [-8.40112958e-03  1.92681307e-02]]
grads:  [-1.76892859e-03  2.06423543e+00]
Stock Position:  -0.0017689285877101042
Bond Position:  [-2.96216223]


portfolio before change:  [-3.1590668]
curr_Stock_Price:  109.21839858826766
curr_Factors:  [1.09218399e+02 4.61360099e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.1590668]
Stock Price:  107.00468401663106
PL:  [-10.16375081]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.67750954e-01  3.83141411e-03]
 [ 4.11637518e-02 -1.75501020e-02]
 [ 5.38723107e-02  8.21913089e-02]
 [ 1.95062745e-02  2.31990541e-02]
 [-1.76962273e-01 -4.85988297e-02]
 [ 1.09094256e-01  7.66206242e-02]
 [ 2.37424620e-02  4.09686297e-02]
 [-1.60953895e-01  7.94105509e-02]
 [ 6.84780067e-02  5.86589363e-02]
 [ 6.63729410e-02 -5.39939020e-02]
 [ 5.89833828e-02 -1.11470609e-01]
 [-6.34540633e-03  1.44173758e-02]
 [-1.12353061e-01 -1.41234343e-01]
 [ 5.59882556e-03  1.51273215e-01]
 [-5.13689727e-02 -9.45567064e-02]
 [ 1.36563807e-01 -6.26599441e-02]
 [ 4.90690858e-02 -1.48516469e-01]
 [-7.68437116e-02  4.15877979e-02]
 [-1.05030700e-01 -1.13331368e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.37913925]
curr_Stock_Price:  97.65076836575827
curr_Factors:  [9.76507684e+01 4.12858442e-02]
mat_Sqrt:  [[ 1.98415782e+01 -8.11994556e-03]
 [-8.11994556e-03  1.86259208e-02]]
grads:  [0.00854022 0.20942644]
Stock Position:  0.00854022213255147
Bond Position:  [-3.21309851]


portfolio before change:  [-2.37304579]
curr_Stock_Price:  98.83485267819295
curr_Factors:  [9.88348527e+01 4.34819659e-02]
mat_Sqrt:  [[ 2.06093678e+01 -8.33320370e-03]
 [-8.33320370e-03  1.91148470e-02]]
grads:  [ 0.00162638 -0.91743079]
Stock Position:  0.001626377605494319
Bond Position:  [-2.53378859]


portfolio before change:  [-2.38188257]
curr_Stock_Price:  95.3500764368224
curr_Factors:  [9.53500764e+01 4.07737405e-02]
mat_Sqrt:  [[ 1.92535707e+01 -8.06924650e-03]
 [-8.06924650e-03  1.85101233e-02]]
grads:  [0.00465986 4.44237507]
Stock Position:  0.004659859278674276
Bond Position:  [-2.82620051]


portfolio before change:  [-2.3736542]
curr_Stock_Price:  97.8744719545662
curr_Factors:  [9.78744720e+01 4.63455382e-02]
mat_Sqrt:  [[ 2.10704282e+01 -8.60314869e-03]
 [-8.60314869e-03  1.97342650e-02]]
grads:  [0.00140601 1.17618519]
Stock Position:  0.0014060070499046055
Bond Position:  [-2.5112664]


portfolio before change:  [-2.37430261]
curr_Stock_Price:  99.64732523090544
curr_Factors:  [9.96473252e+01 4.27020665e-02]
mat_Sqrt:  [[ 2.05915983e+01 -8.25819512e-03]
 [-8.25819512e-03  1.89426207e-02]]
grads:  [-0.00962451 -2.56977699]
Stock Position:  -0.009624507513314907
Bond Position:  [-1.41524618]


portfolio before change:  [-2.35615462]
curr_Stock_Price:  97.57780081296468
curr_Factors:  [9.75778008e+01 4.53474989e-02]
mat_Sqrt:  [[ 2.07791443e+01 -8.50998702e-03]
 [-8.50998702e-03  1.95206329e-02]]
grads:  [0.00685891 3.92809976]
Stock Position:  0.006858912574534728
Bond Position:  [-3.02543222]


portfolio before change:  [-2.35725252]
curr_Stock_Price:  97.9694444232638
curr_Factors:  [9.79694444e+01 4.48862251e-02]
mat_Sqrt:  [[ 2.07561667e+01 -8.46662646e-03]
 [-8.46662646e-03  1.94210836e-02]]
grads:  [2.00471247e-03 2.11036643e+00]
Stock Position:  0.0020047124704853786
Bond Position:  [-2.55365309]


portfolio before change:  [-2.35253081]
curr_Stock_Price:  101.91802905996741
curr_Factors:  [1.01918029e+02 4.19745209e-02]
mat_Sqrt:  [[ 2.08806425e+01 -8.18771016e-03]
 [-8.18771016e-03  1.87804849e-02]]
grads:  [-0.0060513  4.2257165]
Stock Position:  -0.0060512962551906874
Bond Position:  [-1.73579462]


portfolio before change:  [-2.37812321]
curr_Stock_Price:  105.78848931074405
curr_Factors:  [1.05788489e+02 4.27872843e-02]
mat_Sqrt:  [[ 2.18824400e+01 -8.26687225e-03]
 [-8.26687225e-03  1.89613203e-02]]
grads:  [0.00429879 3.09548455]
Stock Position:  0.004298788535117486
Bond Position:  [-2.83288555]


portfolio before change:  [-2.39642782]
curr_Stock_Price:  102.35466299798033
curr_Factors:  [1.02354663e+02 4.59905220e-02]
mat_Sqrt:  [[ 2.19503661e+01 -8.57048543e-03]
 [-8.57048543e-03  1.96583824e-02]]
grads:  [ 1.95169664e-03 -2.74575872e+00]
Stock Position:  0.0019516966407449883
Bond Position:  [-2.59619308]


portfolio before change:  [-2.4134687]
curr_Stock_Price:  95.28717002017207
curr_Factors:  [9.5287170e+01 5.1171166e-02]
mat_Sqrt:  [[ 2.15549514e+01 -9.03972224e-03]
 [-9.03972224e-03  2.07363228e-02]]
grads:  [ 4.82077789e-04 -5.37541068e+00]
Stock Position:  0.00048207778916194936
Bond Position:  [-2.45940452]


portfolio before change:  [-2.41685669]
curr_Stock_Price:  94.64035890142151
curr_Factors:  [9.46403589e+01 5.45615254e-02]
mat_Sqrt:  [[ 2.21064798e+01 -9.33432309e-03]
 [-9.33432309e-03  2.14122784e-02]]
grads:  [-2.73244177e-06  6.73321632e-01]
Stock Position:  -2.732441768866294e-06
Bond Position:  [-2.41659809]


portfolio before change:  [-2.41987685]
curr_Stock_Price:  93.73609691136564
curr_Factors:  [9.37360969e+01 5.66367195e-02]
mat_Sqrt:  [[ 2.23077553e+01 -9.51008871e-03]
 [-9.51008871e-03  2.18157147e-02]]
grads:  [-0.00779789 -6.47737211]
Stock Position:  -0.007797891009433125
Bond Position:  [-1.68893299]


portfolio before change:  [-2.44603338]
curr_Stock_Price:  96.81950051083939
curr_Factors:  [9.68195005e+01 5.82523329e-02]
mat_Sqrt:  [[ 2.33678880e+01 -9.64507696e-03]
 [-9.64507696e-03  2.21245524e-02]]
grads:  [3.06225483e-03 6.83868077e+00]
Stock Position:  0.003062254830430722
Bond Position:  [-2.74251937]


portfolio before change:  [-2.43386476]
curr_Stock_Price:  101.91343308580387
curr_Factors:  [1.01913433e+02 6.02336370e-02]
mat_Sqrt:  [[ 2.50121452e+01 -9.80819548e-03]
 [-9.80819548e-03  2.24974592e-02]]
grads:  [-3.70254529e-03 -4.20460910e+00]
Stock Position:  -0.0037025452909829593
Bond Position:  [-2.05652566]


portfolio before change:  [-2.45552313]
curr_Stock_Price:  107.06829358672248
curr_Factors:  [1.07068294e+02 6.20351493e-02]
mat_Sqrt:  [[ 2.66673442e+01 -9.95422094e-03]
 [-9.95422094e-03  2.28312282e-02]]
grads:  [ 0.00409724 -2.7426978 ]
Stock Position:  0.004097235424227744
Bond Position:  [-2.89420713]


portfolio before change:  [-2.45194363]
curr_Stock_Price:  108.82545851780434
curr_Factors:  [1.08825459e+02 6.25860014e-02]
mat_Sqrt:  [[ 2.72250747e+01 -9.99845649e-03]
 [-9.99845649e-03  2.29323109e-02]]
grads:  [-5.76174924e-04 -6.47654877e+00]
Stock Position:  -0.0005761749239894304
Bond Position:  [-2.38924113]


portfolio before change:  [-2.45843616]
curr_Stock_Price:  114.90714472029907
curr_Factors:  [1.14907145e+02 5.94832273e-02]
mat_Sqrt:  [[ 2.80249127e+01 -9.74789777e-03]
 [-9.74789777e-03  2.23564479e-02]]
grads:  [-0.00209526  1.85930134]
Stock Position:  -0.0020952583449015626
Bond Position:  [-2.21767601]


portfolio before change:  [-2.46933006]
curr_Stock_Price:  118.78259444481735
curr_Factors:  [1.18782594e+02 6.47632257e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.46933006]
Stock Price:  113.25182498752847
PL:  [-15.72115505]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-3.66448674e-02 -7.32701896e-02]
 [ 7.82061042e-03 -8.24117762e-02]
 [ 7.43285420e-02 -7.83554915e-02]
 [ 2.51631455e-03  9.92655048e-03]
 [ 3.29160801e-02  1.66444360e-02]
 [ 6.85371365e-02 -5.75411522e-03]
 [-2.69884286e-02 -2.72570878e-02]
 [ 3.18568893e-02 -1.77408290e-02]
 [-7.18847743e-02 -6.05474910e-02]
 [ 4.74442092e-02  6.78483489e-02]
 [ 6.20201004e-02 -1.18521955e-01]
 [-1.06586065e-02  3.95038756e-02]
 [-3.62455020e-02 -9.53847934e-02]
 [ 1.14068573e-02  5.34291125e-02]
 [-7.92294529e-02 -3.53715288e-02]
 [ 3.83631159e-02 -3.01236955e-02]
 [-2.73899063e-02 -7.07527409e-04]
 [ 3.80240305e-02  4.75205564e-02]
 [-4.25105941e-02 -4.12141269e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.26394892]
curr_Stock_Price:  100.22822960624617
curr_Factors:  [1.00228230e+02 4.17289161e-02]
mat_Sqrt:  [[ 2.04742771e+01 -8.16359703e-03]
 [-8.16359703e-03  1.87255132e-02]]
grads:  [-3.35053349e-03 -3.91431419e+00]
Stock Position:  -0.003350533491734138
Bond Position:  [7.59976696]


portfolio before change:  [7.26643785]
curr_Stock_Price:  102.32243826559592
curr_Factors:  [1.02322438e+02 4.05890868e-02]
mat_Sqrt:  [[ 2.06146273e+01 -8.05148095e-03]
 [-8.05148095e-03  1.84679323e-02]]
grads:  [-1.36375555e-03 -4.46302029e+00]
Stock Position:  -0.0013637555495642144
Bond Position:  [7.40598065]


portfolio before change:  [7.27697018]
curr_Stock_Price:  101.39187475518472
curr_Factors:  [1.01391875e+02 4.13660141e-02]
mat_Sqrt:  [[ 2.06217234e+01 -8.12810677e-03]
 [-8.12810677e-03  1.86438736e-02]]
grads:  [ 1.94819148e-03 -4.20189807e+00]
Stock Position:  0.001948191480195946
Bond Position:  [7.07943939]


portfolio before change:  [7.28144697]
curr_Stock_Price:  99.14464278705003
curr_Factors:  [9.91446428e+01 4.40333779e-02]
mat_Sqrt:  [[ 2.08046406e+01 -8.38589985e-03]
 [-8.38589985e-03  1.92356560e-02]]
grads:  [3.29015860e-04 5.16192927e-01]
Stock Position:  0.0003290158603648058
Bond Position:  [7.24882681]


portfolio before change:  [7.28864198]
curr_Stock_Price:  93.45588891535749
curr_Factors:  [9.34558889e+01 4.40959942e-02]
mat_Sqrt:  [[ 1.96248435e+01 -8.39138835e-03]
 [-8.39138835e-03  1.92495336e-02]]
grads:  [0.00204737 0.86555948]
Stock Position:  0.0020473705075996092
Bond Position:  [7.09730315]


portfolio before change:  [7.30061086]
curr_Stock_Price:  94.96597238320446
curr_Factors:  [9.49659724e+01 4.07637213e-02]
mat_Sqrt:  [[ 1.91736543e+01 -8.06822368e-03]
 [-8.06822368e-03  1.85078626e-02]]
grads:  [ 0.00344435 -0.30939961]
Stock Position:  0.0034443528745219222
Bond Position:  [6.97351454]


portfolio before change:  [7.31370386]
curr_Stock_Price:  96.23490711604822
curr_Factors:  [9.62349071e+01 4.61501004e-02]
mat_Sqrt:  [[ 2.06737338e+01 -8.58485304e-03]
 [-8.58485304e-03  1.96926713e-02]]
grads:  [-0.00188055 -1.38494324]
Stock Position:  -0.0018805486832100034
Bond Position:  [7.49467829]


portfolio before change:  [7.32654202]
curr_Stock_Price:  94.39291544659412
curr_Factors:  [9.43929154e+01 5.07742343e-02]
mat_Sqrt:  [[ 2.12696847e+01 -9.00451170e-03]
 [-9.00451170e-03  2.06557767e-02]]
grads:  [ 0.00113436 -0.85838528]
Stock Position:  0.0011343632649304309
Bond Position:  [7.21946617]


portfolio before change:  [7.33289161]
curr_Stock_Price:  92.0300137062196
curr_Factors:  [9.20300137e+01 4.92431790e-02]
mat_Sqrt:  [[ 2.04221982e+01 -8.86748981e-03]
 [-8.86748981e-03  2.03420602e-02]]
grads:  [-0.00481325 -2.97856617]
Stock Position:  -0.004813251665472565
Bond Position:  [7.77585522]


portfolio before change:  [7.32333201]
curr_Stock_Price:  96.0367627944316
curr_Factors:  [9.60367628e+01 5.48594328e-02]
mat_Sqrt:  [[ 2.24938156e+01 -9.35990292e-03]
 [-9.35990292e-03  2.14705972e-02]]
grads:  [0.00342476 3.16155176]
Stock Position:  0.0034247647444572127
Bond Position:  [6.99442869]


portfolio before change:  [7.34219945]
curr_Stock_Price:  98.99140079786282
curr_Factors:  [9.89914008e+01 5.08731278e-02]
mat_Sqrt:  [[ 2.23275800e+01 -9.01368276e-03]
 [-9.01368276e-03  2.06757056e-02]]
grads:  [ 4.63626231e-04 -5.73222400e+00]
Stock Position:  0.00046362623126537455
Bond Position:  [7.29630444]


portfolio before change:  [7.35143842]
curr_Stock_Price:  99.2348819350717
curr_Factors:  [9.92348819e+01 4.72220573e-02]
mat_Sqrt:  [[ 2.15643700e+01 -8.68423339e-03]
 [-8.68423339e-03  1.99199564e-02]]
grads:  [3.04414882e-04 1.98326333e+00]
Stock Position:  0.0003044148821670897
Bond Position:  [7.32122985]


portfolio before change:  [7.36136575]
curr_Stock_Price:  101.76454047599292
curr_Factors:  [1.01764540e+02 4.95217032e-02]
mat_Sqrt:  [[ 2.26461421e+01 -8.89337867e-03]
 [-8.89337867e-03  2.03991384e-02]]
grads:  [-3.43738814e-03 -4.67742125e+00]
Stock Position:  -0.003437388138391829
Bond Position:  [7.71116997]


portfolio before change:  [7.37414776]
curr_Stock_Price:  100.85192139228852
curr_Factors:  [1.00851921e+02 4.69225004e-02]
mat_Sqrt:  [[ 2.18461402e+01 -8.65677310e-03]
 [-8.65677310e-03  1.98566181e-02]]
grads:  [1.58865726e-03 2.69143843e+00]
Stock Position:  0.0015886572597789623
Bond Position:  [7.21392863]


portfolio before change:  [7.37406257]
curr_Stock_Price:  95.1186234035382
curr_Factors:  [9.51186234e+01 4.35064077e-02]
mat_Sqrt:  [[ 1.98400212e+01 -8.33524372e-03]
 [-8.33524372e-03  1.91203501e-02]]
grads:  [-0.00477149 -1.85202154]
Stock Position:  -0.004771492080446919
Bond Position:  [7.82792032]


portfolio before change:  [7.3789093]
curr_Stock_Price:  96.15483589272812
curr_Factors:  [9.61548359e+01 4.40298658e-02]
mat_Sqrt:  [[ 2.01764509e+01 -8.38532456e-03]
 [-8.38532456e-03  1.92349939e-02]]
grads:  [ 1.25074182e-03 -1.56554287e+00]
Stock Position:  0.0012507418151072403
Bond Position:  [7.25864443]


portfolio before change:  [7.38819225]
curr_Stock_Price:  96.31791497571454
curr_Factors:  [9.63179150e+01 4.57513722e-02]
mat_Sqrt:  [[ 2.06019865e+01 -8.54769385e-03]
 [-8.54769385e-03  1.96074132e-02]]
grads:  [-0.00134469 -0.0366709 ]
Stock Position:  -0.0013446935314689924
Bond Position:  [7.51771033]


portfolio before change:  [7.39191092]
curr_Stock_Price:  100.54515493892463
curr_Factors:  [1.00545155e+02 4.61476620e-02]
mat_Sqrt:  [[ 2.15991154e+01 -8.58497648e-03]
 [-8.58497648e-03  1.96919983e-02]]
grads:  [0.00272008 2.41437702]
Stock Position:  0.0027200836392024
Bond Position:  [7.11841969]


portfolio before change:  [7.40049881]
curr_Stock_Price:  100.4290928027438
curr_Factors:  [1.00429093e+02 4.45706523e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.40049881]
Stock Price:  102.98257396216972
PL:  [4.41792485]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.35699920e-01 -1.82509144e-02]
 [-9.24781360e-02  7.26549782e-02]
 [ 5.08819092e-02  9.10794392e-02]
 [-3.54680253e-01 -1.88107440e-01]
 [ 2.98285623e-01  2.94935436e-02]
 [ 3.78051146e-02 -1.00233559e-01]
 [-2.74652937e-01 -3.16370660e-01]
 [ 3.30650781e-02 -1.24969214e-02]
 [-1.17465320e-01 -9.46819009e-02]
 [ 6.09269745e-02  3.10940995e-01]
 [ 5.77222829e-02 -1.08006138e-01]
 [-9.80900513e-03  2.59314857e-02]
 [-6.37674703e-03 -5.70490090e-02]
 [ 1.20216228e-02  3.34950646e-04]
 [-6.74711517e-02 -6.80842160e-02]
 [ 1.11056022e-01 -5.91583118e-02]
 [-4.32678585e-03 -6.07747224e-02]
 [ 1.05678101e-01 -2.94413973e-02]
 [ 3.79675572e-02  1.21897678e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.32846054]
curr_Stock_Price:  94.45688359561423
curr_Factors:  [9.44568836e+01 4.39544413e-02]
mat_Sqrt:  [[ 1.98031810e+01 -8.37799589e-03]
 [-8.37799589e-03  1.92185743e-02]]
grads:  [ 0.00645186 -0.94683718]
Stock Position:  0.006451858515143777
Bond Position:  [-14.93788299]


portfolio before change:  [-14.34944195]
curr_Stock_Price:  94.1008019589379
curr_Factors:  [9.41008020e+01 4.63797825e-02]
mat_Sqrt:  [[ 2.02655147e+01 -8.60600356e-03]
 [-8.60600356e-03  1.97416952e-02]]
grads:  [-3.00100379e-03  3.67897240e+00]
Stock Position:  -0.003001003785758488
Bond Position:  [-14.06704509]


portfolio before change:  [-14.36822964]
curr_Stock_Price:  94.49829663539357
curr_Factors:  [9.44982966e+01 4.25781772e-02]
mat_Sqrt:  [[ 1.94992305e+01 -8.24579395e-03]
 [-8.24579395e-03  1.89153021e-02]]
grads:  [4.64649588e-03 4.81714501e+00]
Stock Position:  0.004646495875903678
Bond Position:  [-14.80731558]


portfolio before change:  [-14.39868682]
curr_Stock_Price:  91.92937879153925
curr_Factors:  [9.19293788e+01 4.78269754e-02]
mat_Sqrt:  [[ 2.01043827e+01 -8.73903830e-03]
 [-8.73903830e-03  2.00474179e-02]]
grads:  [-0.02172474 -9.39259579]
Stock Position:  -0.021724740994566505
Bond Position:  [-12.40154488]


portfolio before change:  [-14.4106868]
curr_Stock_Price:  91.76773613234731
curr_Factors:  [9.17677361e+01 4.74720876e-02]
mat_Sqrt:  [[ 1.99944353e+01 -8.70653976e-03]
 [-8.70653976e-03  1.99729077e-02]]
grads:  [0.0155644 1.4834623]
Stock Position:  0.015564402912611797
Bond Position:  [-15.83899682]


portfolio before change:  [-14.41686675]
curr_Stock_Price:  92.6435280959746
curr_Factors:  [9.26435281e+01 4.84264213e-02]
mat_Sqrt:  [[ 2.03871366e+01 -8.79370125e-03]
 [-8.79370125e-03  2.01726307e-02]]
grads:  [-2.88909861e-04 -4.96891560e+00]
Stock Position:  -0.0002889098606399359
Bond Position:  [-14.39010112]


portfolio before change:  [-14.43374065]
curr_Stock_Price:  88.74967112843032
curr_Factors:  [8.87496711e+01 5.06384544e-02]
mat_Sqrt:  [[ 1.99713273e+01 -8.99190903e-03]
 [-8.99190903e-03  2.06283813e-02]]
grads:  [ -0.02066161 -15.34567556]
Stock Position:  -0.02066161402257079
Bond Position:  [-12.6000292]


portfolio before change:  [-14.43485091]
curr_Stock_Price:  88.04064510962213
curr_Factors:  [8.80406451e+01 4.06214466e-02]
mat_Sqrt:  [[ 1.77443814e+01 -8.05352049e-03]
 [-8.05352049e-03  1.84758024e-02]]
grads:  [ 0.00155673 -0.6757154 ]
Stock Position:  0.0015567288391350402
Bond Position:  [-14.57190632]


portfolio before change:  [-14.45063616]
curr_Stock_Price:  89.60868840156046
curr_Factors:  [8.96086884e+01 4.19514567e-02]
mat_Sqrt:  [[ 1.83536988e+01 -8.18445006e-03]
 [-8.18445006e-03  1.87757648e-02]]
grads:  [-0.00865049 -5.04654278]
Stock Position:  -0.008650490507915248
Bond Position:  [-13.67547705]


portfolio before change:  [-14.46174575]
curr_Stock_Price:  88.91561237895371
curr_Factors:  [8.89156124e+01 4.08375531e-02]
mat_Sqrt:  [[ 1.79683350e+01 -8.07499713e-03]
 [-8.07499713e-03  1.85248469e-02]]
grads:  [1.09361787e-02 1.67898448e+01]
Stock Position:  0.010936178727471345
Bond Position:  [-15.43414278]


portfolio before change:  [-14.44981521]
curr_Stock_Price:  91.77175460095768
curr_Factors:  [9.17717546e+01 3.70371060e-02]
mat_Sqrt:  [[ 1.76614972e+01 -7.69032978e-03]
 [-7.69032978e-03  1.76417088e-02]]
grads:  [ 6.02584023e-04 -6.12194122e+00]
Stock Position:  0.0006025840225771387
Bond Position:  [-14.5051154]


portfolio before change:  [-14.46572456]
curr_Stock_Price:  95.47809658342992
curr_Factors:  [9.54780966e+01 3.73102996e-02]
mat_Sqrt:  [[ 1.84424274e+01 -7.71893942e-03]
 [-7.71893942e-03  1.77065234e-02]]
grads:  [8.11052447e-05 1.46455129e+00]
Stock Position:  8.110524470993629e-05
Bond Position:  [-14.47346833]


portfolio before change:  [-14.48322542]
curr_Stock_Price:  102.9040353456851
curr_Factors:  [1.02904035e+02 3.45605344e-02]
mat_Sqrt:  [[ 1.91303360e+01 -7.42956781e-03]
 [-7.42956781e-03  1.70413282e-02]]
grads:  [-1.63373482e-03 -3.34839787e+00]
Stock Position:  -0.0016337348207188247
Bond Position:  [-14.31510752]


portfolio before change:  [-14.50076439]
curr_Stock_Price:  102.67994321178958
curr_Factors:  [1.02679943e+02 3.48925445e-02]
mat_Sqrt:  [[ 1.91801459e+01 -7.46515455e-03]
 [-7.46515455e-03  1.71229937e-02]]
grads:  [0.0006345  0.01983808]
Stock Position:  0.0006344955405942042
Bond Position:  [-14.56591435]


portfolio before change:  [-14.52206307]
curr_Stock_Price:  97.82584037565653
curr_Factors:  [9.78258404e+01 3.41995221e-02]
mat_Sqrt:  [[ 1.80910415e+01 -7.39032062e-03]
 [-7.39032062e-03  1.69522383e-02]]
grads:  [-0.00537115 -4.01857911]
Stock Position:  -0.005371152337542812
Bond Position:  [-13.99662558]


portfolio before change:  [-14.55082497]
curr_Stock_Price:  99.92132764660484
curr_Factors:  [9.99213276e+01 3.37187312e-02]
mat_Sqrt:  [[ 1.83482130e+01 -7.33833274e-03]
 [-7.33833274e-03  1.68325929e-02]]
grads:  [ 0.00464788 -3.51248346]
Stock Position:  0.004647877657991393
Bond Position:  [-15.01524708]


portfolio before change:  [-14.57619372]
curr_Stock_Price:  98.50391711190113
curr_Factors:  [9.85039171e+01 3.62357394e-02]
mat_Sqrt:  [[ 1.87508962e+01 -7.60719632e-03]
 [-7.60719632e-03  1.74495833e-02]]
grads:  [-1.64403631e-03 -3.48359200e+00]
Stock Position:  -0.001644036307782381
Bond Position:  [-14.4142497]


portfolio before change:  [-14.58915215]
curr_Stock_Price:  95.41965135532115
curr_Factors:  [9.54196514e+01 3.64429249e-02]
mat_Sqrt:  [[ 1.82156386e+01 -7.62868394e-03]
 [-7.62868394e-03  1.74994980e-02]]
grads:  [ 0.00509784 -1.68019148]
Stock Position:  0.0050978422021518656
Bond Position:  [-15.07558648]


portfolio before change:  [-14.59742581]
curr_Stock_Price:  97.49555007495161
curr_Factors:  [9.74955501e+01 3.80526209e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.59742581]
Stock Price:  99.97369299433382
PL:  [-14.59742581]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.64441912e-01  2.70762688e-03]
 [-8.23678603e-02  7.11982428e-02]
 [ 6.38090919e-02  5.26561775e-02]
 [-3.52625610e-01 -1.87121762e-01]
 [ 5.05081704e-01  5.00894864e-02]
 [-4.35039694e-02 -4.08196804e-01]
 [-3.84261960e-01 -3.99560197e-01]
 [ 3.39365595e-02 -8.71442686e-03]
 [-1.42426015e-01 -1.13384811e-01]
 [ 4.49309200e-02  2.42341785e-01]
 [ 5.87474792e-02 -1.10822539e-01]
 [-6.60536430e-03  1.52462250e-02]
 [-6.96540170e-02 -1.30230334e-01]
 [ 3.34558212e-03  1.61044820e-01]
 [-6.91408000e-02 -6.33921404e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 2.93908319e-02 -1.46211913e-01]
 [ 5.06470602e-02  4.49650745e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.55553437]
curr_Stock_Price:  97.33633457033251
curr_Factors:  [9.73363346e+01 4.12904332e-02]
mat_Sqrt:  [[ 1.97787878e+01 -8.12037222e-03]
 [-8.12037222e-03  1.86269667e-02]]
grads:  [0.00837523 0.14901175]
Stock Position:  0.008375232336063765
Bond Position:  [-4.37074879]


portfolio before change:  [-3.58577026]
curr_Stock_Price:  94.37891959012676
curr_Factors:  [9.43789196e+01 4.74406140e-02]
mat_Sqrt:  [[ 2.05565445e+01 -8.70389341e-03]
 [-8.70389341e-03  1.99661809e-02]]
grads:  [-2.49748967e-03  3.56485325e+00]
Stock Position:  -0.002497489669202895
Bond Position:  [-3.35005988]


portfolio before change:  [-3.59945465]
curr_Stock_Price:  98.18041537393428
curr_Factors:  [9.81804154e+01 4.46821861e-02]
mat_Sqrt:  [[ 2.07535328e+01 -8.44737816e-03]
 [-8.44737816e-03  1.93768848e-02]]
grads:  [0.00418146 2.71929676]
Stock Position:  0.004181457717352214
Bond Position:  [-4.0099919]


portfolio before change:  [-3.63050544]
curr_Stock_Price:  91.95407677142761
curr_Factors:  [9.19540768e+01 4.70688669e-02]
mat_Sqrt:  [[ 1.99497666e+01 -8.66950242e-03]
 [-8.66950242e-03  1.98878957e-02]]
grads:  [-0.02176856 -9.41831591]
Stock Position:  -0.021768561584651472
Bond Position:  [-1.62879746]


portfolio before change:  [-3.56684256]
curr_Stock_Price:  88.9359558853514
curr_Factors:  [8.89359559e+01 4.83767199e-02]
mat_Sqrt:  [[ 1.95612022e+01 -8.78882530e-03]
 [-8.78882530e-03  2.01624341e-02]]
grads:  [0.02694205 2.49604166]
Stock Position:  0.026942054598143996
Bond Position:  [-5.96295994]


portfolio before change:  [-3.6516355]
curr_Stock_Price:  86.06555190680709
curr_Factors:  [8.60655519e+01 4.66526236e-02]
mat_Sqrt:  [[ 1.85894845e+01 -8.63049579e-03]
 [-8.63049579e-03  1.98000197e-02]]
grads:  [-1.19139890e-02 -2.06211728e+01]
Stock Position:  -0.011913989024649848
Bond Position:  [-2.62625146]


portfolio before change:  [-3.65826211]
curr_Stock_Price:  86.34604090155761
curr_Factors:  [8.63460409e+01 4.59176330e-02]
mat_Sqrt:  [[ 1.85025731e+01 -8.56227074e-03]
 [-8.56227074e-03  1.96434175e-02]]
grads:  [ -0.03018699 -20.35382421]
Stock Position:  -0.03018698587823732
Bond Position:  [-1.0517354]


portfolio before change:  [-3.6021667]
curr_Stock_Price:  84.44419791561225
curr_Factors:  [8.44441979e+01 4.73611392e-02]
mat_Sqrt:  [[ 1.83772632e+01 -8.69560706e-03]
 [-8.69560706e-03  1.99498824e-02]]
grads:  [ 0.00164031 -0.43610098]
Stock Position:  0.0016403093507175474
Bond Position:  [-3.74068131]


portfolio before change:  [-3.60054507]
curr_Stock_Price:  88.28518170450864
curr_Factors:  [8.82851817e+01 4.52696156e-02]
mat_Sqrt:  [[ 1.87841338e+01 -8.50183613e-03]
 [-8.50183613e-03  1.95042287e-02]]
grads:  [-0.01021543 -5.81779788]
Stock Position:  -0.010215428665384791
Bond Position:  [-2.6986741]


portfolio before change:  [-3.63964475]
curr_Stock_Price:  91.78226685745244
curr_Factors:  [9.17822669e+01 4.20660427e-02]
mat_Sqrt:  [[ 1.88245485e+01 -8.19581827e-03]
 [-8.19581827e-03  1.88013029e-02]]
grads:  [8.00022081e-03 1.28931146e+01]
Stock Position:  0.00800022081080306
Bond Position:  [-4.37392315]


portfolio before change:  [-3.62336313]
curr_Stock_Price:  94.50124665181085
curr_Factors:  [9.45012467e+01 4.41750504e-02]
mat_Sqrt:  [[ 1.98621394e+01 -8.39899815e-03]
 [-8.39899815e-03  1.92667417e-02]]
grads:  [ 5.25535590e-04 -5.75178339e+00]
Stock Position:  0.00052553558982339
Bond Position:  [-3.6730269]


portfolio before change:  [-3.62785364]
curr_Stock_Price:  94.69846012339178
curr_Factors:  [9.46984601e+01 4.51718986e-02]
mat_Sqrt:  [[ 2.01269075e+01 -8.49325195e-03]
 [-8.49325195e-03  1.94829068e-02]]
grads:  [2.03625903e-06 7.82544535e-01]
Stock Position:  2.0362590306351914e-06
Bond Position:  [-3.62804647]


portfolio before change:  [-3.63238036]
curr_Stock_Price:  100.18940462623324
curr_Factors:  [1.00189405e+02 4.64882327e-02]
mat_Sqrt:  [[ 2.16019661e+01 -8.61656903e-03]
 [-8.61656903e-03  1.97645406e-02]]
grads:  [-5.85369653e-03 -6.59164182e+00]
Stock Position:  -0.005853696528099102
Bond Position:  [-3.04590199]


portfolio before change:  [-3.61392588]
curr_Stock_Price:  96.38595661962977
curr_Factors:  [9.63859566e+01 5.49937009e-02]
mat_Sqrt:  [[ 2.26032141e+01 -9.37138245e-03]
 [-9.37138245e-03  2.14968416e-02]]
grads:  [3.25463123e-03 7.49297607e+00]
Stock Position:  0.003254631233443776
Bond Position:  [-3.92762663]


portfolio before change:  [-3.61536961]
curr_Stock_Price:  97.45178313685767
curr_Factors:  [9.74517831e+01 5.09230737e-02]
mat_Sqrt:  [[ 2.19911053e+01 -9.01797457e-03]
 [-9.01797457e-03  2.06859100e-02]]
grads:  [-0.0044015 -3.066427 ]
Stock Position:  -0.004401495938966746
Bond Position:  [-3.18643599]


portfolio before change:  [-3.63552985]
curr_Stock_Price:  101.12660143881737
curr_Factors:  [1.01126601e+02 4.51383816e-02]
mat_Sqrt:  [[ 2.14851490e+01 -8.49062235e-03]
 [-8.49062235e-03  1.94754499e-02]]
grads:  [ 0.00505715 -3.13217955]
Stock Position:  0.005057154141685002
Bond Position:  [-4.14694266]


portfolio before change:  [-3.62577409]
curr_Stock_Price:  104.0813612373547
curr_Factors:  [1.04081361e+02 4.55305987e-02]
mat_Sqrt:  [[ 2.22087754e+01 -8.52765023e-03]
 [-8.52765023e-03  1.95597845e-02]]
grads:  [-1.54714545e-03 -7.47580355e+00]
Stock Position:  -0.0015471454529331864
Bond Position:  [-3.46474509]


portfolio before change:  [-3.62292997]
curr_Stock_Price:  99.442003339496
curr_Factors:  [9.94420033e+01 4.57051624e-02]
mat_Sqrt:  [[ 2.12594712e+01 -8.54363129e-03]
 [-8.54363129e-03  1.95973975e-02]]
grads:  [0.00330498 2.29588195]
Stock Position:  0.0033049847935735033
Bond Position:  [-3.95158428]


portfolio before change:  [-3.61239406]
curr_Stock_Price:  104.12537737383342
curr_Factors:  [1.04125377e+02 3.63637566e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.61239406]
Stock Price:  105.1689404683607
PL:  [-8.78133453]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-4.86487386e-02 -7.64754377e-02]
 [ 2.65027830e-03 -8.86282255e-02]
 [ 6.07844118e-02  6.16467003e-02]
 [-3.05528746e-01 -1.64391827e-01]
 [ 3.54924894e-01  3.22402846e-02]
 [ 4.73965777e-02 -6.70668635e-02]
 [-9.91817272e-02 -1.24347425e-01]
 [ 3.25319761e-02 -1.48107465e-02]
 [-1.05635981e-02 -1.37417921e-02]
 [ 4.87852649e-02  2.58868753e-01]
 [ 4.94267763e-02 -9.61665523e-02]
 [ 3.51845858e-02 -1.35579124e-01]
 [-1.69634091e-01 -1.16003644e-01]
 [-3.45427595e-03  1.49770865e-01]
 [-1.04474674e-01  1.01446045e-01]
 [-1.26428485e-01  5.33330151e-02]
 [-1.08806070e-01  2.14255030e-01]
 [ 2.55849145e-02 -1.57404878e-01]
 [-2.46544168e-02  5.67864135e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.92442494]
curr_Stock_Price:  101.20662313320335
curr_Factors:  [1.01206623e+02 3.74537421e-02]
mat_Sqrt:  [[ 1.95864852e+01 -7.73418314e-03]
 [-7.73418314e-03  1.77403448e-02]]
grads:  [-4.18674041e-03 -4.31264554e+00]
Stock Position:  -0.004186740409164693
Bond Position:  [11.34815079]


portfolio before change:  [10.93247334]
curr_Stock_Price:  102.67450795950495
curr_Factors:  [1.02674508e+02 4.09556104e-02]
mat_Sqrt:  [[ 2.07787443e+01 -8.08777692e-03]
 [-8.08777692e-03  1.85511177e-02]]
grads:  [-1.73231343e-03 -4.77826929e+00]
Stock Position:  -0.00173231342544184
Bond Position:  [11.11033777]


portfolio before change:  [10.95564755]
curr_Stock_Price:  97.31889204358765
curr_Factors:  [9.73188920e+01 4.04686802e-02]
mat_Sqrt:  [[ 1.95774733e+01 -8.03915985e-03]
 [-8.03915985e-03  1.84406809e-02]]
grads:  [0.00447835 3.34492543]
Stock Position:  0.0044783512581578295
Bond Position:  [10.51981937]


portfolio before change:  [10.94710856]
curr_Stock_Price:  92.47403229310817
curr_Factors:  [9.24740323e+01 4.74654637e-02]
mat_Sqrt:  [[ 2.01469180e+01 -8.70599867e-03]
 [-8.70599867e-03  1.99714853e-02]]
grads:  [-0.01872553 -8.23948991]
Stock Position:  -0.01872553084792311
Bond Position:  [12.67873391]


portfolio before change:  [10.98296339]
curr_Stock_Price:  91.40615867638463
curr_Factors:  [9.14061587e+01 5.04794075e-02]
mat_Sqrt:  [[ 2.05367890e+01 -8.97804612e-03]
 [-8.97804612e-03  2.05958433e-02]]
grads:  [0.01797015 1.57321169]
Stock Position:  0.017970153994721356
Bond Position:  [9.34038064]


portfolio before change:  [11.03042593]
curr_Stock_Price:  93.39722447074381
curr_Factors:  [9.33972245e+01 5.10639404e-02]
mat_Sqrt:  [[ 2.11052788e+01 -9.03007060e-03]
 [-9.03007060e-03  2.07146622e-02]]
grads:  [ 8.60625499e-04 -3.23727664e+00]
Stock Position:  0.0008606254986087888
Bond Position:  [10.95004589]


portfolio before change:  [11.044438]
curr_Stock_Price:  93.76434682149869
curr_Factors:  [9.37643468e+01 5.21107833e-02]
mat_Sqrt:  [[ 2.14043229e+01 -9.12219710e-03]
 [-9.12219710e-03  2.09259015e-02]]
grads:  [-0.00716756 -5.9453978 ]
Stock Position:  -0.007167562297639466
Bond Position:  [11.71649979]


portfolio before change:  [11.083562]
curr_Stock_Price:  90.3504640277233
curr_Factors:  [9.03504640e+01 5.07652461e-02]
mat_Sqrt:  [[ 2.03569914e+01 -9.00332385e-03]
 [-9.00332385e-03  2.06541187e-02]]
grads:  [ 0.00128117 -0.71652593]
Stock Position:  0.0012811746400040527
Bond Position:  [10.96780727]


portfolio before change:  [11.10420623]
curr_Stock_Price:  95.75636662962667
curr_Factors:  [9.57563666e+01 4.31883953e-02]
mat_Sqrt:  [[ 1.98999120e+01 -8.30477765e-03]
 [-8.30477765e-03  1.90503182e-02]]
grads:  [-0.00083202 -0.72170458]
Stock Position:  -0.0008320234905448253
Bond Position:  [11.18387778]


portfolio before change:  [11.12207718]
curr_Stock_Price:  91.09019673021011
curr_Factors:  [9.10901967e+01 3.95905593e-02]
mat_Sqrt:  [[ 1.81245577e+01 -7.95094990e-03]
 [-7.95094990e-03  1.82397365e-02]]
grads:  [8.91942312e-03 1.41964590e+01]
Stock Position:  0.008919423122421674
Bond Position:  [10.30960518]


portfolio before change:  [11.09072785]
curr_Stock_Price:  86.12974197688091
curr_Factors:  [8.6129742e+01 4.0209395e-02]
mat_Sqrt:  [[ 1.72709755e+01 -8.01238525e-03]
 [-8.01238525e-03  1.83819377e-02]]
grads:  [ 4.34884047e-04 -5.23138907e+00]
Stock Position:  0.0004348840471928458
Bond Position:  [11.0532714]


portfolio before change:  [11.10287716]
curr_Stock_Price:  82.2760265879385
curr_Factors:  [8.22760266e+01 4.49573670e-02]
mat_Sqrt:  [[ 1.74451092e+01 -8.47182274e-03]
 [-8.47182274e-03  1.94371266e-02]]
grads:  [-1.37079631e-03 -6.97586328e+00]
Stock Position:  -0.0013707963103916439
Bond Position:  [11.21566084]


portfolio before change:  [11.1121915]
curr_Stock_Price:  85.71490800927062
curr_Factors:  [8.57149080e+01 4.38252427e-02]
mat_Sqrt:  [[ 1.79439678e+01 -8.36484664e-03]
 [-8.36484664e-03  1.91906688e-02]]
grads:  [-0.01227391 -6.05014418]
Stock Position:  -0.012273908544027356
Bond Position:  [12.16424844]


portfolio before change:  [11.14883122]
curr_Stock_Price:  83.96934303763192
curr_Factors:  [8.39693430e+01 4.93773673e-02]
mat_Sqrt:  [[ 1.86588413e+01 -8.87871547e-03]
 [-8.87871547e-03  2.03701273e-02]]
grads:  [3.31419771e-03 7.35392021e+00]
Stock Position:  0.0033141977101654374
Bond Position:  [10.87054022]


portfolio before change:  [11.17302053]
curr_Stock_Price:  87.1654814866483
curr_Factors:  [8.71654815e+01 4.93634693e-02]
mat_Sqrt:  [[ 1.93663299e+01 -8.87782085e-03]
 [-8.87782085e-03  2.03671056e-02]]
grads:  [-3.11196726e-03  4.97952038e+00]
Stock Position:  -0.003111967264234197
Bond Position:  [11.44427665]


portfolio before change:  [11.18835274]
curr_Stock_Price:  86.83838091185225
curr_Factors:  [8.68383809e+01 4.90318259e-02]
mat_Sqrt:  [[ 1.92287346e+01 -8.84791322e-03]
 [-8.84791322e-03  2.02985884e-02]]
grads:  [-0.00536707  2.62508539]
Stock Position:  -0.005367069639160159
Bond Position:  [11.65442038]


portfolio before change:  [11.2260747]
curr_Stock_Price:  82.5260050739913
curr_Factors:  [8.25260051e+01 5.25486258e-02]
mat_Sqrt:  [[ 1.89178359e+01 -9.15922172e-03]
 [-9.15922172e-03  2.10141599e-02]]
grads:  [-8.15327367e-04  1.01953903e+01]
Stock Position:  -0.0008153273665146971
Bond Position:  [11.29336041]


portfolio before change:  [11.24136239]
curr_Stock_Price:  81.10060554310678
curr_Factors:  [8.11006055e+01 5.30357689e-02]
mat_Sqrt:  [[ 1.86770585e+01 -9.20139884e-03]
 [-9.20139884e-03  2.11114175e-02]]
grads:  [-2.30385036e-03 -7.45691645e+00]
Stock Position:  -0.0023038503589255764
Bond Position:  [11.42820605]


portfolio before change:  [11.25709602]
curr_Stock_Price:  80.47581029245907
curr_Factors:  [8.04758103e+01 4.86887291e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.25709602]
Stock Price:  78.16227715676689
PL:  [11.25709602]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-6.19834903e-03 -6.07355827e-02]
 [ 1.27782383e-02  3.79465820e-02]
 [ 5.25601360e-02  8.60913331e-02]
 [ 2.29643293e-02  2.30689509e-02]
 [ 6.00299343e-02 -9.56789859e-02]
 [ 1.27170089e-01  1.07154303e-01]
 [ 3.35714853e-02  5.40353990e-02]
 [-2.32543636e-01  6.83463148e-02]
 [ 8.07508034e-02  7.29698782e-02]
 [ 6.62515409e-02 -5.37179681e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 2.17907742e-02  3.25677285e-02]
 [ 2.00481452e-02  1.18742887e-01]
 [-5.64462377e-02 -1.28151483e-01]
 [ 5.12316152e-02 -1.36927906e-01]
 [ 1.89243031e-01 -1.27366902e-01]
 [ 1.08045110e-01 -1.50456206e-01]
 [-9.46877304e-02  4.34545533e-02]
 [-1.06473943e-01 -1.16047903e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.76899603]
curr_Stock_Price:  99.82864981743631
curr_Factors:  [9.98286498e+01 3.66861928e-02]
mat_Sqrt:  [[ 1.91208187e+01 -7.65442797e-03]
 [-7.65442797e-03  1.75576667e-02]]
grads:  [-1.70925184e-03 -3.45995097e+00]
Stock Position:  -0.0017092518364771347
Bond Position:  [5.93962833]


portfolio before change:  [5.7809462]
curr_Stock_Price:  97.183639586928
curr_Factors:  [9.71836396e+01 4.15413967e-02]
mat_Sqrt:  [[ 1.98076827e+01 -8.14500063e-03]
 [-8.14500063e-03  1.86834936e-02]]
grads:  [1.48054517e-03 2.03166720e+00]
Stock Position:  0.0014805451728916743
Bond Position:  [5.63706143]


portfolio before change:  [5.78472889]
curr_Stock_Price:  94.97631743144328
curr_Factors:  [9.49763174e+01 4.21252005e-02]
mat_Sqrt:  [[ 1.94933409e+01 -8.20185438e-03]
 [-8.20185438e-03  1.88143985e-02]]
grads:  [0.00462244 4.5778368 ]
Stock Position:  0.0046224445122542675
Bond Position:  [5.34570613]


portfolio before change:  [5.80198725]
curr_Stock_Price:  97.26343118566179
curr_Factors:  [9.72634312e+01 4.10035991e-02]
mat_Sqrt:  [[ 1.96952065e+01 -8.09211229e-03]
 [-8.09211229e-03  1.85621580e-02]]
grads:  [0.00167691 1.24352571]
Stock Position:  0.0016769094998950356
Bond Position:  [5.63888528]


portfolio before change:  [5.81811806]
curr_Stock_Price:  102.67683802245493
curr_Factors:  [1.02676838e+02 3.79743843e-02]
mat_Sqrt:  [[ 2.00086517e+01 -7.78785472e-03]
 [-7.78785472e-03  1.78631789e-02]]
grads:  [ 9.15585763e-04 -5.35581353e+00]
Stock Position:  0.0009155857629242083
Bond Position:  [5.72410861]


portfolio before change:  [5.82688877]
curr_Stock_Price:  104.43647373299513
curr_Factors:  [1.04436474e+02 3.10704852e-02]
mat_Sqrt:  [[ 1.84088299e+01 -7.04454610e-03]
 [-7.04454610e-03  1.61579461e-02]]
grads:  [0.00944744 6.63579735]
Stock Position:  0.009447437471473195
Bond Position:  [4.84023171]


portfolio before change:  [5.81540961]
curr_Stock_Price:  102.58060183282089
curr_Factors:  [1.02580602e+02 3.49380137e-02]
mat_Sqrt:  [[ 1.91740703e+01 -7.47001051e-03]
 [-7.47001051e-03  1.71341495e-02]]
grads:  [2.98002010e-03 3.15496604e+00]
Stock Position:  0.0029800200976833465
Bond Position:  [5.50971735]


portfolio before change:  [5.82386607]
curr_Stock_Price:  103.10577069041315
curr_Factors:  [1.03105771e+02 3.60882567e-02]
mat_Sqrt:  [[ 1.95869084e+01 -7.59201459e-03]
 [-7.59201459e-03  1.74138991e-02]]
grads:  [-0.01035287  3.92030041]
Stock Position:  -0.010352867007134564
Bond Position:  [6.89130641]


portfolio before change:  [5.82087987]
curr_Stock_Price:  104.22678645796057
curr_Factors:  [1.04226786e+02 3.42627279e-02]
mat_Sqrt:  [[ 1.92925789e+01 -7.39757199e-03]
 [-7.39757199e-03  1.69677107e-02]]
grads:  [0.00583556 4.30305822]
Stock Position:  0.005835559213859551
Bond Position:  [5.21265828]


portfolio before change:  [5.81708922]
curr_Stock_Price:  102.45993852137339
curr_Factors:  [1.02459939e+02 3.53266935e-02]
mat_Sqrt:  [[ 1.92577504e+01 -7.51143902e-03]
 [-7.51143902e-03  1.72291967e-02]]
grads:  [ 2.22452367e-03 -3.11687537e+00]
Stock Position:  0.0022245236742236465
Bond Position:  [5.58916466]


portfolio before change:  [5.82917766]
curr_Stock_Price:  104.75149383750423
curr_Factors:  [1.04751494e+02 3.22991973e-02]
mat_Sqrt:  [[ 1.88259135e+01 -7.18250618e-03]
 [-7.18250618e-03  1.64743309e-02]]
grads:  [ 5.10078168e-04 -7.42659850e+00]
Stock Position:  0.00051007816804486
Bond Position:  [5.77574621]


portfolio before change:  [5.8377725]
curr_Stock_Price:  107.43860941349593
curr_Factors:  [1.07438609e+02 3.09145789e-02]
mat_Sqrt:  [[ 1.88904375e+01 -7.02702191e-03]
 [-7.02702191e-03  1.61172812e-02]]
grads:  [1.90550982e-03 2.02150215e+00]
Stock Position:  0.0019055098196577303
Bond Position:  [5.63304717]


portfolio before change:  [5.85866211]
curr_Stock_Price:  114.70380324481155
curr_Factors:  [1.14703803e+02 2.99587020e-02]
mat_Sqrt:  [[ 1.98536009e+01 -6.91790488e-03]
 [-6.91790488e-03  1.58659891e-02]]
grads:  [3.61815746e-03 7.48569256e+00]
Stock Position:  0.003618157463045771
Bond Position:  [5.44364568]


portfolio before change:  [5.89063694]
curr_Stock_Price:  121.6592842304548
curr_Factors:  [1.21659284e+02 2.75287014e-02]
mat_Sqrt:  [[ 2.01854342e+01 -6.63171387e-03]
 [-6.63171387e-03  1.52087930e-02]]
grads:  [-5.56550370e-03 -8.42857099e+00]
Stock Position:  -0.005565503695252135
Bond Position:  [6.56773214]


portfolio before change:  [5.88784171]
curr_Stock_Price:  123.63754829672204
curr_Factors:  [1.23637548e+02 2.80094490e-02]
mat_Sqrt:  [[ 2.06920083e+01 -6.68945030e-03]
 [-6.68945030e-03  1.53409825e-02]]
grads:  [-4.09681152e-04 -8.92580680e+00]
Stock Position:  -0.00040968115162544593
Bond Position:  [5.93849368]


portfolio before change:  [5.89859626]
curr_Stock_Price:  115.51709416286886
curr_Factors:  [1.15517094e+02 2.88249076e-02]
mat_Sqrt:  [[ 1.96123751e+01 -6.78577560e-03]
 [-6.78577560e-03  1.55628508e-02]]
grads:  [ 6.81856155e-03 -8.18106104e+00]
Stock Position:  0.0068185615543145525
Bond Position:  [5.11093584]


portfolio before change:  [5.91083457]
curr_Stock_Price:  116.3744069970691
curr_Factors:  [1.16374407e+02 2.73063138e-02]
mat_Sqrt:  [[ 1.92304299e+01 -6.60464695e-03]
 [-6.60464695e-03  1.51473356e-02]]
grads:  [ 2.20736107e-03 -9.93188709e+00]
Stock Position:  0.002207361070832362
Bond Position:  [5.65395423]


portfolio before change:  [5.92085413]
curr_Stock_Price:  117.70980523919475
curr_Factors:  [1.17709805e+02 2.87524418e-02]
mat_Sqrt:  [[ 1.99595149e+01 -6.77734061e-03]
 [-6.77734061e-03  1.55432324e-02]]
grads:  [-0.00379525  2.79406694]
Stock Position:  -0.0037952519080409895
Bond Position:  [6.3675925]


portfolio before change:  [5.92157348]
curr_Stock_Price:  119.61880135105596
curr_Factors:  [1.19618801e+02 2.60929407e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.92157348]
Stock Price:  117.86083825787014
PL:  [-11.93926478]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 2.56569628e-02 -4.77137104e-02]
 [ 3.49953636e-02  1.04825243e-02]
 [ 4.72464693e-02  1.01885086e-01]
 [ 1.93413998e-02  2.29330166e-02]
 [-2.06834385e-01 -2.18143379e-02]
 [ 5.57920959e-02 -4.05521343e-02]
 [-2.36372865e-01 -2.87807320e-01]
 [ 3.22206834e-02 -1.61618517e-02]
 [-8.13357961e-02 -6.76032487e-02]
 [ 3.78299876e-02  2.06323496e-01]
 [ 5.87281269e-02 -1.10769374e-01]
 [-1.05535418e-02  2.83371120e-02]
 [-8.56895858e-02 -1.37424610e-01]
 [ 1.28400827e-02 -6.42717528e-02]
 [-5.11158218e-02 -9.40756002e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 1.79668335e-02 -1.20749474e-01]
 [-2.40960825e-02  3.68164342e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.20063011]
curr_Stock_Price:  99.40944776380448
curr_Factors:  [9.94094478e+01 3.94275363e-02]
mat_Sqrt:  [[ 1.97391045e+01 -7.93523072e-03]
 [-7.93523072e-03  1.82018536e-02]]
grads:  [ 2.46043295e-04 -2.62125819e+00]
Stock Position:  0.00024604329513815625
Bond Position:  [4.17617108]


portfolio before change:  [4.2055144]
curr_Stock_Price:  98.03089621052375
curr_Factors:  [9.80308962e+01 3.79434866e-02]
mat_Sqrt:  [[ 1.90955229e+01 -7.78435673e-03]
 [-7.78435673e-03  1.78560538e-02]]
grads:  [0.00207233 0.5879606 ]
Stock Position:  0.0020723317677107185
Bond Position:  [4.00236186]


portfolio before change:  [4.20105387]
curr_Stock_Price:  93.46279824357023
curr_Factors:  [9.34627982e+01 4.09689046e-02]
mat_Sqrt:  [[ 1.89175947e+01 -8.08837836e-03]
 [-8.08837836e-03  1.85544383e-02]]
grads:  [4.84617656e-03 5.49325619e+00]
Stock Position:  0.0048461765591002156
Bond Position:  [3.74811665]


portfolio before change:  [4.22696712]
curr_Stock_Price:  97.84257479762756
curr_Factors:  [9.78425748e+01 3.66476695e-02]
mat_Sqrt:  [[ 1.87305710e+01 -7.65026559e-03]
 [-7.65026559e-03  1.75485080e-02]]
grads:  [0.00156665 1.30751868]
Stock Position:  0.0015666508466640142
Bond Position:  [4.07368196]


portfolio before change:  [4.23300355]
curr_Stock_Price:  98.44331151531637
curr_Factors:  [9.84433115e+01 3.49531093e-02]
mat_Sqrt:  [[ 1.84047146e+01 -7.47134377e-03]
 [-7.47134377e-03  1.71379729e-02]]
grads:  [-0.01175692 -1.27799116]
Stock Position:  -0.011756916709545902
Bond Position:  [5.39039336]


portfolio before change:  [4.29141405]
curr_Stock_Price:  94.04859641362836
curr_Factors:  [9.40485964e+01 3.85084435e-02]
mat_Sqrt:  [[ 1.84556890e+01 -7.84178472e-03]
 [-7.84178472e-03  1.79886311e-02]]
grads:  [ 2.06555623e-03 -2.25341976e+00]
Stock Position:  0.00206555622701922
Bond Position:  [4.09715139]


portfolio before change:  [4.28732292]
curr_Stock_Price:  89.58695390529152
curr_Factors:  [8.95869539e+01 3.74199228e-02]
mat_Sqrt:  [[ 1.73299045e+01 -7.72978324e-03]
 [-7.72978324e-03  1.77327290e-02]]
grads:  [ -0.02088297 -16.23939218]
Stock Position:  -0.020882968292167667
Bond Position:  [6.15816444]


portfolio before change:  [4.2545727]
curr_Stock_Price:  91.52407022526776
curr_Factors:  [9.15240702e+01 3.39300783e-02]
mat_Sqrt:  [[ 1.68588410e+01 -7.36067596e-03]
 [-7.36067596e-03  1.68855332e-02]]
grads:  [ 0.00149359 -0.95649084]
Stock Position:  0.0014935940299864465
Bond Position:  [4.11787289]


portfolio before change:  [4.25972128]
curr_Stock_Price:  91.52274237275
curr_Factors:  [9.15227424e+01 3.21870266e-02]
mat_Sqrt:  [[ 1.64198586e+01 -7.16911739e-03]
 [-7.16911739e-03  1.64460944e-02]]
grads:  [-0.00674952 -4.11353815]
Stock Position:  -0.006749524261340461
Bond Position:  [4.87745625]


portfolio before change:  [4.25481639]
curr_Stock_Price:  93.15330442182318
curr_Factors:  [9.31533044e+01 2.69110104e-02]
mat_Sqrt:  [[ 1.52814029e+01 -6.55537998e-03]
 [-6.55537998e-03  1.50378555e-02]]
grads:  [8.36281164e-03 1.37239194e+01]
Stock Position:  0.008362811644028122
Bond Position:  [3.47579285]


portfolio before change:  [4.26445912]
curr_Stock_Price:  93.78649726566773
curr_Factors:  [9.37864973e+01 2.46022816e-02]
mat_Sqrt:  [[ 1.47105181e+01 -6.26791998e-03]
 [-6.26791998e-03  1.43783168e-02]]
grads:  [ 7.09867907e-04 -7.70360858e+00]
Stock Position:  0.0007098679074178794
Bond Position:  [4.1978831]


portfolio before change:  [4.27106531]
curr_Stock_Price:  95.69608822865705
curr_Factors:  [9.56960882e+01 2.33311986e-02]
mat_Sqrt:  [[ 1.46171490e+01 -6.10397489e-03]
 [-6.10397489e-03  1.40019097e-02]]
grads:  [1.23145134e-04 2.02385704e+00]
Stock Position:  0.00012314513394623037
Bond Position:  [4.2592808]


portfolio before change:  [4.27665866]
curr_Stock_Price:  97.85549286957672
curr_Factors:  [9.78554929e+01 2.43185301e-02]
mat_Sqrt:  [[ 1.52599754e+01 -6.23192252e-03]
 [-6.23192252e-03  1.42950496e-02]]
grads:  [-9.54298586e-03 -9.61760086e+00]
Stock Position:  -0.009542985859951177
Bond Position:  [5.21049225]


portfolio before change:  [4.21600172]
curr_Stock_Price:  104.89460286323785
curr_Factors:  [1.04894603e+02 2.28199597e-02]
mat_Sqrt:  [[ 1.58456679e+01 -6.03723524e-03]
 [-6.03723524e-03  1.38474325e-02]]
grads:  [-9.58229406e-04 -4.64183795e+00]
Stock Position:  -0.0009582294056727708
Bond Position:  [4.31651482]


portfolio before change:  [4.22416009]
curr_Stock_Price:  102.01496426136342
curr_Factors:  [1.02014964e+02 2.48788946e-02]
mat_Sqrt:  [[ 1.60908649e+01 -6.30355429e-03]
 [-6.30355429e-03  1.44587050e-02]]
grads:  [-5.72658162e-03 -6.50899913e+00]
Stock Position:  -0.005726581622045022
Bond Position:  [4.80835711]


portfolio before change:  [4.2278165]
curr_Stock_Price:  102.42669240906235
curr_Factors:  [1.02426692e+02 2.55194799e-02]
mat_Sqrt:  [[ 1.63624761e+01 -6.38421398e-03]
 [-6.38421398e-03  1.46436543e-02]]
grads:  [ 0.00664038 -4.16570546]
Stock Position:  0.00664038305185287
Bond Position:  [3.54766403]


portfolio before change:  [4.22434525]
curr_Stock_Price:  101.23570619719132
curr_Factors:  [1.01235706e+02 2.18896496e-02]
mat_Sqrt:  [[ 1.49779745e+01 -5.91270703e-03]
 [-5.91270703e-03  1.35623151e-02]]
grads:  [-2.31551932e-03 -8.90431786e+00]
Stock Position:  -0.0023155193167524045
Bond Position:  [4.45875849]


portfolio before change:  [4.21582311]
curr_Stock_Price:  107.32465442122793
curr_Factors:  [1.07324654e+02 1.79109992e-02]
mat_Sqrt:  [[ 1.43634701e+01 -5.34871126e-03]
 [-5.34871126e-03  1.22678963e-02]]
grads:  [-5.60150023e-04  3.00079470e+00]
Stock Position:  -0.000560150022549147
Bond Position:  [4.27594102]


portfolio before change:  [4.22036446]
curr_Stock_Price:  108.765195589643
curr_Factors:  [1.08765196e+02 1.80658314e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.22036446]
Stock Price:  106.431005978953
PL:  [-2.21064152]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.69718749e-01  3.75482063e-03]
 [-8.03312287e-02  7.08913618e-02]
 [ 7.09836507e-02  1.09446146e-03]
 [ 2.64184986e-03  1.00229494e-02]
 [-5.76827786e-02 -7.86896009e-02]
 [ 1.26788346e-01  1.06479293e-01]
 [ 2.81129146e-02  4.69800848e-02]
 [-1.81119808e-01  7.63054710e-02]
 [ 8.41559141e-02  7.69454133e-02]
 [ 4.36017176e-02  2.36654765e-01]
 [ 5.76931816e-02 -1.07926192e-01]
 [ 1.19914511e-03 -9.37178989e-03]
 [-1.39158755e-01 -1.29992318e-01]
 [ 3.59520296e-03  1.63713131e-01]
 [-7.02021038e-02 -6.04521285e-02]
 [ 1.26556608e-02 -1.82321245e-02]
 [-2.12797745e-02 -1.55604511e-02]
 [ 8.60646683e-02  2.90207383e-03]
 [-8.43908108e-02 -7.86528128e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.10033008]
curr_Stock_Price:  97.99257599231798
curr_Factors:  [9.79925760e+01 4.24243382e-02]
mat_Sqrt:  [[ 2.01836951e+01 -8.23116849e-03]
 [-8.23116849e-03  1.88809758e-02]]
grads:  [0.00849132 0.20256973]
Stock Position:  0.008491316075184833
Bond Position:  [-1.93241601]


portfolio before change:  [-1.1329606]
curr_Stock_Price:  94.4344129527225
curr_Factors:  [9.44344130e+01 4.68316718e-02]
mat_Sqrt:  [[ 2.04361968e+01 -8.64785684e-03]
 [-8.64785684e-03  1.98376231e-02]]
grads:  [-2.41906691e-03  3.57252690e+00]
Stock Position:  -0.0024190669107417902
Bond Position:  [-0.90451743]


portfolio before change:  [-1.14788943]
curr_Stock_Price:  100.13805086643804
curr_Factors:  [1.00138051e+02 4.22479511e-02]
mat_Sqrt:  [[ 2.05826801e+01 -8.21420384e-03]
 [-8.21420384e-03  1.88416126e-02]]
grads:  [0.00347249 0.05960133]
Stock Position:  0.0034724937504518587
Bond Position:  [-1.49561819]


portfolio before change:  [-1.15321292]
curr_Stock_Price:  99.14372253663103
curr_Factors:  [9.91437225e+01 4.70490615e-02]
mat_Sqrt:  [[ 2.15050605e+01 -8.66830430e-03]
 [-8.66830430e-03  1.98834382e-02]]
grads:  [3.26092881e-04 5.04227485e-01]
Stock Position:  0.00032609288087409973
Bond Position:  [-1.18554298]


portfolio before change:  [-1.15395858]
curr_Stock_Price:  101.4044307610197
curr_Factors:  [1.01404431e+02 4.64490789e-02]
mat_Sqrt:  [[ 2.18547303e+01 -8.61303403e-03]
 [-8.61303403e-03  1.97561746e-02]]
grads:  [-0.00420983 -3.98487369]
Stock Position:  -0.00420982689645713
Bond Position:  [-0.72706348]


portfolio before change:  [-1.16908522]
curr_Stock_Price:  104.78158813351311
curr_Factors:  [1.04781588e+02 4.71071833e-02]
mat_Sqrt:  [[ 2.27419926e+01 -8.67408794e-03]
 [-8.67408794e-03  1.98955279e-02]]
grads:  [0.00761763 5.35524212]
Stock Position:  0.0076176344966131845
Bond Position:  [-1.96727306]


portfolio before change:  [-1.19666658]
curr_Stock_Price:  101.48388075347212
curr_Factors:  [1.01483881e+02 5.17737879e-02]
mat_Sqrt:  [[ 2.30914924e+01 -9.09332865e-03]
 [-9.09332865e-03  2.08578343e-02]]
grads:  [2.10480238e-03 2.25331277e+00]
Stock Position:  0.002104802377397103
Bond Position:  [-1.41027009]


portfolio before change:  [-1.19700172]
curr_Stock_Price:  102.16270729992996
curr_Factors:  [1.02162707e+02 4.94280985e-02]
mat_Sqrt:  [[ 2.27132516e+01 -8.88500084e-03]
 [-8.88500084e-03  2.03798367e-02]]
grads:  [-0.00651065  3.74132653]
Stock Position:  -0.00651065383838888
Bond Position:  [-0.5318557]


portfolio before change:  [-1.20829221]
curr_Stock_Price:  103.79468591365861
curr_Factors:  [1.03794686e+02 5.53543138e-02]
mat_Sqrt:  [[ 2.44202903e+01 -9.40269565e-03]
 [-9.40269565e-03  2.15669296e-02]]
grads:  [0.00482067 3.56985171]
Stock Position:  0.004820669273857495
Bond Position:  [-1.70865206]


portfolio before change:  [-1.26715372]
curr_Stock_Price:  92.02778034668547
curr_Factors:  [9.20277803e+01 5.41187138e-02]
mat_Sqrt:  [[ 2.14088155e+01 -9.29611270e-03]
 [-9.29611270e-03  2.13253236e-02]]
grads:  [6.85660538e-03 1.11003476e+01]
Stock Position:  0.006856605383380445
Bond Position:  [-1.89815189]


portfolio before change:  [-1.27152552]
curr_Stock_Price:  91.73643614515564
curr_Factors:  [9.17364361e+01 4.82906215e-02]
mat_Sqrt:  [[ 2.01591966e+01 -8.78127689e-03]
 [-8.78127689e-03  2.01443638e-02]]
grads:  [ 5.2821094e-04 -5.3574069e+00]
Stock Position:  0.0005282109397528755
Bond Position:  [-1.31998171]


portfolio before change:  [-1.2727497]
curr_Stock_Price:  92.54451318865345
curr_Factors:  [9.25445132e+01 4.29666031e-02]
mat_Sqrt:  [[ 1.91829831e+01 -8.28315084e-03]
 [-8.28315084e-03  1.90014590e-02]]
grads:  [-1.50485776e-04 -4.93279827e-01]
Stock Position:  -0.0001504857758011127
Bond Position:  [-1.25882306]


portfolio before change:  [-1.2739348]
curr_Stock_Price:  89.95679348388263
curr_Factors:  [8.99567935e+01 4.37996894e-02]
mat_Sqrt:  [[ 1.88264935e+01 -8.36282893e-03]
 [-8.36282893e-03  1.91848895e-02]]
grads:  [-0.01040349 -6.78030072]
Stock Position:  -0.010403490697257755
Bond Position:  [-0.33807013]


portfolio before change:  [-1.33035065]
curr_Stock_Price:  95.33893005609691
curr_Factors:  [9.53389301e+01 4.10875166e-02]
mat_Sqrt:  [[ 1.93252527e+01 -8.10023470e-03]
 [-8.10023470e-03  1.85812100e-02]]
grads:  [3.87976789e-03 8.81237329e+00]
Stock Position:  0.003879767889157899
Bond Position:  [-1.70024357]


portfolio before change:  [-1.32523876]
curr_Stock_Price:  97.2046424592792
curr_Factors:  [9.72046425e+01 4.76193693e-02]
mat_Sqrt:  [[ 2.12118619e+01 -8.72052202e-03]
 [-8.72052202e-03  2.00036544e-02]]
grads:  [-0.0045528  -3.02403901]
Stock Position:  -0.004552797071849033
Bond Position:  [-0.88268575]


portfolio before change:  [-1.31686503]
curr_Stock_Price:  95.12289571768544
curr_Factors:  [9.51228957e+01 4.57794282e-02]
mat_Sqrt:  [[ 2.03526145e+01 -8.55021215e-03]
 [-8.55021215e-03  1.96134687e-02]]
grads:  [ 2.31345624e-04 -9.29470799e-01]
Stock Position:  0.00023134562417215668
Bond Position:  [-1.3388713]


portfolio before change:  [-1.31812778]
curr_Stock_Price:  96.90331381143436
curr_Factors:  [9.69033138e+01 4.49821905e-02]
mat_Sqrt:  [[ 2.05522272e+01 -8.47558515e-03]
 [-8.47558515e-03  1.94418713e-02]]
grads:  [-0.00136571 -0.80095306]
Stock Position:  -0.0013657069879423726
Bond Position:  [-1.18578624]


portfolio before change:  [-1.32029775]
curr_Stock_Price:  97.40621061801893
curr_Factors:  [9.74062106e+01 4.64057672e-02]
mat_Sqrt:  [[ 2.09832421e+01 -8.60869832e-03]
 [-8.60869832e-03  1.97471007e-02]]
grads:  [0.00416263 0.14877671]
Stock Position:  0.004162628535526082
Bond Position:  [-1.72576362]


portfolio before change:  [-1.29910545]
curr_Stock_Price:  103.01585202991988
curr_Factors:  [1.03015852e+02 4.49970258e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.29910545]
Stock Price:  98.00627733070537
PL:  [-1.29910545]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 5.96846319e-02 -3.56616506e-02]
 [-4.68271402e-02  6.59826872e-02]
 [ 5.33769368e-02  8.36635131e-02]
 [-7.09664136e-01 -3.58404497e-01]
 [ 6.39675924e-01  6.94011110e-02]
 [-6.27533423e-02 -4.79865294e-01]
 [-1.79313487e-01 -2.31944026e-01]
 [ 3.29707077e-02 -1.29065176e-02]
 [-2.59273532e-01 -2.00921166e-01]
 [ 1.12599509e-01  5.32559259e-01]
 [-1.71715094e-01 -1.72805910e-02]
 [ 4.05256336e-02 -1.55896196e-01]
 [-1.97129283e-01 -1.03382904e-01]
 [-1.22378328e-03  1.57375991e-01]
 [-1.06787349e-01  1.49708490e-01]
 [-1.89975475e-01  8.71096271e-02]
 [-1.02785228e-01  1.95301145e-01]
 [ 4.32241951e-02 -1.48325139e-01]
 [-4.10277011e-04  5.70267452e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.93554707]
curr_Stock_Price:  99.07130893984689
curr_Factors:  [9.90713089e+01 4.59804468e-02]
mat_Sqrt:  [[ 2.12439103e+01 -8.56929249e-03]
 [-8.56929249e-03  1.96563398e-02]]
grads:  [ 0.00207803 -1.813351  ]
Stock Position:  0.002078030652565517
Bond Position:  [2.72967386]


portfolio before change:  [2.93123422]
curr_Stock_Price:  95.35284475938617
curr_Factors:  [9.53528448e+01 4.53716002e-02]
mat_Sqrt:  [[ 2.03107362e+01 -8.51206175e-03]
 [-8.51206175e-03  1.95259009e-02]]
grads:  [-8.89487661e-04  3.37885131e+00]
Stock Position:  -0.0008894876613076732
Bond Position:  [3.0160494]


portfolio before change:  [2.93513461]
curr_Stock_Price:  95.20896895429624
curr_Factors:  [9.52089690e+01 4.29203568e-02]
mat_Sqrt:  [[ 1.97246582e+01 -8.27892120e-03]
 [-8.27892120e-03  1.89911303e-02]]
grads:  [0.00455599 4.40738546]
Stock Position:  0.00455598940957721
Bond Position:  [2.50136356]


portfolio before change:  [2.903957]
curr_Stock_Price:  87.67904080690285
curr_Factors:  [8.76790408e+01 4.34825829e-02]
mat_Sqrt:  [[ 1.82832506e+01 -8.33228045e-03]
 [-8.33228045e-03  1.91154108e-02]]
grads:  [ -0.04736917 -18.77015319]
Stock Position:  -0.04736916510914894
Bond Position:  [7.05723996]


portfolio before change:  [2.98067035]
curr_Stock_Price:  86.24590844315905
curr_Factors:  [8.62459084e+01 5.04901456e-02]
mat_Sqrt:  [[ 1.93794642e+01 -8.97846278e-03]
 [-8.97846278e-03  2.05982684e-02]]
grads:  [0.03457588 3.38434027]
Stock Position:  0.03457588350696412
Bond Position:  [-0.00135814]


portfolio before change:  [2.92078787]
curr_Stock_Price:  84.51404291284057
curr_Factors:  [8.45140429e+01 5.05623164e-02]
mat_Sqrt:  [[ 1.90038813e+01 -8.98468192e-03]
 [-8.98468192e-03  2.06130700e-02]]
grads:  [-1.43112735e-02 -2.32858995e+01]
Stock Position:  -0.014311273468208267
Bond Position:  [4.13029145]


portfolio before change:  [2.83239094]
curr_Stock_Price:  91.05175734701076
curr_Factors:  [9.10517573e+01 5.06053666e-02]
mat_Sqrt:  [[ 2.04826705e+01 -8.98920536e-03]
 [-8.98920536e-03  2.06215386e-02]]
grads:  [ -0.01369327 -11.2536277 ]
Stock Position:  -0.013693266122063499
Bond Position:  [4.07918688]


portfolio before change:  [2.87203891]
curr_Stock_Price:  88.5289263733063
curr_Factors:  [8.85289264e+01 5.27327664e-02]
mat_Sqrt:  [[ 2.03294407e+01 -9.17594590e-03]
 [-9.17594590e-03  2.10506456e-02]]
grads:  [ 0.00134535 -0.61253099]
Stock Position:  0.0013453472189674841
Bond Position:  [2.75293676]


portfolio before change:  [2.86681358]
curr_Stock_Price:  82.08549846586816
curr_Factors:  [8.20854985e+01 4.88697301e-02]
mat_Sqrt:  [[ 1.81462278e+01 -8.83273650e-03]
 [-8.83273650e-03  2.02652428e-02]]
grads:  [-0.01911802 -9.9229026 ]
Stock Position:  -0.01911801835577731
Bond Position:  [4.43612565]


portfolio before change:  [2.91860904]
curr_Stock_Price:  79.66648017249345
curr_Factors:  [7.96664802e+01 5.50357517e-02]
mat_Sqrt:  [[ 1.86895148e+01 -9.37309557e-03]
 [-9.37309557e-03  2.15058735e-02]]
grads:  [1.84480390e-02 2.47714734e+01]
Stock Position:  0.01844803895561818
Bond Position:  [1.44891871]


portfolio before change:  [2.89303117]
curr_Stock_Price:  78.18176136675307
curr_Factors:  [7.81817614e+01 5.46728415e-02]
mat_Sqrt:  [[ 1.82806325e+01 -9.34193708e-03]
 [-9.34193708e-03  2.14349394e-02]]
grads:  [-0.00980745 -0.81046236]
Stock Position:  -0.00980744963994552
Bond Position:  [3.65979486]


portfolio before change:  [2.87331759]
curr_Stock_Price:  80.65857162151858
curr_Factors:  [8.06585716e+01 5.82703565e-02]
mat_Sqrt:  [[ 1.94703748e+01 -9.64474104e-03]
 [-9.64474104e-03  2.21287717e-02]]
grads:  [-1.40865560e-03 -7.04556874e+00]
Stock Position:  -0.0014086555957684233
Bond Position:  [2.98693773]


portfolio before change:  [2.87528996]
curr_Stock_Price:  81.91057159259519
curr_Factors:  [8.19105716e+01 5.99442614e-02]
mat_Sqrt:  [[ 2.00545865e+01 -9.78245991e-03]
 [-9.78245991e-03  2.24442886e-02]]
grads:  [-0.01207907 -4.61146568]
Stock Position:  -0.012079070359128004
Bond Position:  [3.86469351]


portfolio before change:  [2.80765227]
curr_Stock_Price:  87.91033549038342
curr_Factors:  [8.79103355e+01 5.52688612e-02]
mat_Sqrt:  [[ 2.06671290e+01 -9.39393745e-03]
 [-9.39393745e-03  2.15509293e-02]]
grads:  [3.26068223e-03 7.30393662e+00]
Stock Position:  0.0032606822320301104
Bond Position:  [2.5210046]


portfolio before change:  [2.80037483]
curr_Stock_Price:  84.71141418497535
curr_Factors:  [8.47114142e+01 5.85145447e-02]
mat_Sqrt:  [[ 2.04915023e+01 -9.66545354e-03]
 [-9.66545354e-03  2.21748609e-02]]
grads:  [-2.02726941e-03  6.75038714e+00]
Stock Position:  -0.002027269410912513
Bond Position:  [2.97210769]


portfolio before change:  [2.80829568]
curr_Stock_Price:  82.63799232295939
curr_Factors:  [8.26379923e+01 5.86784954e-02]
mat_Sqrt:  [[ 2.00179312e+01 -9.67872227e-03]
 [-9.67872227e-03  2.22060192e-02]]
grads:  [-0.00759518  3.91948303]
Stock Position:  -0.007595184821733523
Bond Position:  [3.4359465]


portfolio before change:  [2.80332825]
curr_Stock_Price:  83.85784946350908
curr_Factors:  [8.38578495e+01 5.23105078e-02]
mat_Sqrt:  [[ 1.91795379e+01 -9.13860723e-03]
 [-9.13860723e-03  2.09664240e-02]]
grads:  [-9.20942249e-04  9.31454639e+00]
Stock Position:  -0.0009209422490697571
Bond Position:  [2.88055649]


portfolio before change:  [2.80801677]
curr_Stock_Price:  82.67909001980306
curr_Factors:  [8.26790900e+01 5.27392968e-02]
mat_Sqrt:  [[ 1.89872822e+01 -9.17584249e-03]
 [-9.17584249e-03  2.10522417e-02]]
grads:  [-1.12861867e-03 -7.04606648e+00]
Stock Position:  -0.0011286186659170707
Bond Position:  [2.90132993]


portfolio before change:  [2.81217617]
curr_Stock_Price:  82.20907268413328
curr_Factors:  [8.22090727e+01 5.93987761e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.81217617]
Stock Price:  86.40968263895265
PL:  [2.81217617]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 5.71815975e-02 -2.53933030e-02]
 [-2.30813302e-02 -1.19566129e-01]
 [ 7.41241279e-02 -4.80635443e-02]
 [-1.85834036e-02 -1.40944642e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-1.61825160e-01  4.24059070e-02]
 [ 5.42515488e-02  4.20201801e-02]
 [ 6.12843827e-02 -3.75334815e-02]
 [ 6.29442771e-02 -1.22351905e-01]
 [ 1.71924226e-01  1.17399526e-02]
 [ 2.53591744e-02  9.01563194e-02]
 [-2.67289266e-02 -1.79414128e-01]
 [ 5.36954968e-03 -1.16237977e-01]
 [ 1.73933834e-01 -1.08562304e-01]
 [ 1.30291085e-01 -1.50672505e-01]
 [-1.19606048e-01  4.60031360e-02]
 [-1.30372133e-01 -1.64210630e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [24.32712366]
curr_Stock_Price:  104.78897516217648
curr_Factors:  [1.04788975e+02 3.57649320e-02]
mat_Sqrt:  [[ 1.98172899e+01 -7.55803643e-03]
 [-7.55803643e-03  1.73356686e-02]]
grads:  [ 0.00232717 -1.4637863 ]
Stock Position:  0.002327172256789055
Bond Position:  [24.08326167]


portfolio before change:  [24.35638167]
curr_Stock_Price:  104.41732457175418
curr_Factors:  [1.04417325e+02 3.71191603e-02]
mat_Sqrt:  [[ 2.01173884e+01 -7.69977438e-03]
 [-7.69977438e-03  1.76608346e-02]]
grads:  [-3.73917067e-03 -6.77175927e+00]
Stock Position:  -0.00373917067165411
Bond Position:  [24.74681587]


portfolio before change:  [24.40055409]
curr_Stock_Price:  100.8818993498809
curr_Factors:  [1.00881899e+02 3.46547756e-02]
mat_Sqrt:  [[ 1.87799643e+01 -7.43955783e-03]
 [-7.43955783e-03  1.70646048e-02]]
grads:  [ 0.00283171 -2.81532906]
Stock Position:  0.0028317053091898173
Bond Position:  [24.11488628]


portfolio before change:  [24.43401526]
curr_Stock_Price:  102.04682321067263
curr_Factors:  [1.02046823e+02 3.50277524e-02]
mat_Sqrt:  [[ 1.90987785e+01 -7.47956284e-03]
 [-7.47956284e-03  1.71561553e-02]]
grads:  [-0.00129497 -0.82210436]
Stock Position:  -0.0012949720764684662
Bond Position:  [24.56616305]


portfolio before change:  [24.45482567]
curr_Stock_Price:  109.70451389311633
curr_Factors:  [1.09704514e+02 3.33430177e-02]
mat_Sqrt:  [[ 2.00321203e+01 -7.29793076e-03]
 [-7.29793076e-03  1.67382909e-02]]
grads:  [ 0.0081856  -7.05270222]
Stock Position:  0.00818559625167852
Bond Position:  [23.55682881]


portfolio before change:  [24.46355079]
curr_Stock_Price:  107.17087653383301
curr_Factors:  [1.07170877e+02 3.37478299e-02]
mat_Sqrt:  [[ 1.96879128e+01 -7.34195369e-03]
 [-7.34195369e-03  1.68396560e-02]]
grads:  [0.00878567 6.31099976]
Stock Position:  0.008785666483839624
Bond Position:  [23.52198321]


portfolio before change:  [24.53557989]
curr_Stock_Price:  112.02062137024363
curr_Factors:  [1.12020621e+02 3.30660487e-02]
mat_Sqrt:  [[ 2.03699095e+01 -7.26768230e-03]
 [-7.26768230e-03  1.66685717e-02]]
grads:  [4.40598156e-03 4.86062516e+00]
Stock Position:  0.004405981559966556
Bond Position:  [24.0420191]


portfolio before change:  [24.56311885]
curr_Stock_Price:  111.44586618247985
curr_Factors:  [1.11445866e+02 3.88067755e-02]
mat_Sqrt:  [[ 2.19542050e+01 -7.87329876e-03]
 [-7.87329876e-03  1.80576555e-02]]
grads:  [-0.00652988  2.34551464]
Stock Position:  -0.006529875361728838
Bond Position:  [25.29084646]


portfolio before change:  [24.61948457]
curr_Stock_Price:  107.65828940354882
curr_Factors:  [1.07658289e+02 3.99817741e-02]
mat_Sqrt:  [[ 2.15267504e+01 -7.99137344e-03]
 [-7.99137344e-03  1.83290941e-02]]
grads:  [0.0033718  2.29401001]
Stock Position:  0.0033717973271243998
Bond Position:  [24.25648264]


portfolio before change:  [24.64678727]
curr_Stock_Price:  106.7576234484783
curr_Factors:  [1.06757623e+02 3.35819590e-02]
mat_Sqrt:  [[ 1.95637399e+01 -7.32386436e-03]
 [-7.32386436e-03  1.67982321e-02]]
grads:  [ 0.00229647 -2.2333697 ]
Stock Position:  0.002296467146519727
Bond Position:  [24.4016219]


portfolio before change:  [24.68662451]
curr_Stock_Price:  110.81434826477803
curr_Factors:  [1.10814348e+02 2.98632075e-02]
mat_Sqrt:  [[ 1.91497979e+01 -6.90667697e-03]
 [-6.90667697e-03  1.58407667e-02]]
grads:  [ 5.01287945e-04 -7.72364402e+00]
Stock Position:  0.0005012879449285444
Bond Position:  [24.63107461]


portfolio before change:  [24.71850786]
curr_Stock_Price:  112.9593352101066
curr_Factors:  [1.12959335e+02 2.86759321e-02]
mat_Sqrt:  [[ 1.91284981e+01 -6.76809594e-03]
 [-6.76809594e-03  1.55226350e-02]]
grads:  [0.00925689 0.76034797]
Stock Position:  0.00925688638599225
Bond Position:  [23.67285613]


portfolio before change:  [24.73886416]
curr_Stock_Price:  111.9597256740188
curr_Factors:  [1.11959726e+02 2.98597000e-02]
mat_Sqrt:  [[ 1.93465940e+01 -6.90632976e-03]
 [-6.90632976e-03  1.58398109e-02]]
grads:  [3.34314023e-03 5.69321242e+00]
Stock Position:  0.0033431402287395144
Bond Position:  [24.3645671]


portfolio before change:  [24.77860827]
curr_Stock_Price:  114.73237623759745
curr_Factors:  [1.14732376e+02 2.94837320e-02]
mat_Sqrt:  [[ 1.97004973e+01 -6.86284838e-03]
 [-6.86284838e-03  1.57397151e-02]]
grads:  [-5.32845545e-03 -1.14011401e+01]
Stock Position:  -0.005328455446075899
Bond Position:  [25.38995462]


portfolio before change:  [24.79711085]
curr_Stock_Price:  117.21990921168624
curr_Factors:  [1.17219909e+02 2.55842763e-02]
mat_Sqrt:  [[ 1.87494237e+01 -6.39303530e-03]
 [-6.39303530e-03  1.46619188e-02]]
grads:  [-2.41716359e-03 -7.92893699e+00]
Stock Position:  -0.0024171635923589123
Bond Position:  [25.08045054]


portfolio before change:  [24.8383765]
curr_Stock_Price:  113.12606736510004
curr_Factors:  [1.13126067e+02 2.94436933e-02]
mat_Sqrt:  [[ 1.94114870e+01 -6.85810921e-03]
 [-6.85810921e-03  1.57290582e-02]]
grads:  [ 6.52286549e-03 -6.89917784e+00]
Stock Position:  0.006522865488136712
Bond Position:  [24.10047038]


portfolio before change:  [24.90828896]
curr_Stock_Price:  119.22277941960179
curr_Factors:  [1.19222779e+02 2.58083004e-02]
mat_Sqrt:  [[ 1.91530931e+01 -6.42104830e-03]
 [-6.42104830e-03  1.47259343e-02]]
grads:  [ 3.37291640e-03 -1.02303082e+01]
Stock Position:  0.0033729164000113813
Bond Position:  [24.50616049]


portfolio before change:  [24.94686617]
curr_Stock_Price:  121.57248426998946
curr_Factors:  [1.21572484e+02 2.85697385e-02]
mat_Sqrt:  [[ 2.05488916e+01 -6.75594050e-03]
 [-6.75594050e-03  1.54936972e-02]]
grads:  [-0.00484507  2.96703894]
Stock Position:  -0.004845074430477978
Bond Position:  [25.5358939]


portfolio before change:  [24.94360932]
curr_Stock_Price:  128.8369072091884
curr_Factors:  [1.28836907e+02 2.82646878e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [24.94360932]
Stock Price:  127.53102025778895
PL:  [-2.58741093]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-2.65641774e-02 -6.91904306e-02]
 [ 4.23049084e-02 -1.37596991e-02]
 [ 7.45678666e-02 -6.49116648e-02]
 [ 7.26032815e-03  1.38433656e-02]
 [-1.35078639e-01 -6.34194800e-02]
 [ 1.27260125e-01  1.30254285e-01]
 [ 3.85007114e-02  6.04065246e-02]
 [-2.14113234e-01  7.11933784e-02]
 [ 8.42954118e-02  7.71428506e-02]
 [ 6.19013053e-02 -4.26297940e-02]
 [ 6.23053702e-02 -1.20596711e-01]
 [-8.34174096e-03  4.48542785e-02]
 [-7.31673413e-02 -1.33428606e-01]
 [ 1.12391853e-02  5.72832672e-02]
 [-5.04500651e-02 -9.28103475e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [ 2.89379104e-02 -1.46159866e-01]
 [ 3.61362080e-03  3.82119999e-02]
 [-8.78473943e-02 -7.99362713e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.76575898]
curr_Stock_Price:  100.0950704736535
curr_Factors:  [1.00095070e+02 4.61452628e-02]
mat_Sqrt:  [[ 2.15018693e+01 -8.58471815e-03]
 [-8.58471815e-03  1.96915018e-02]]
grads:  [-2.63876370e-03 -3.51487075e+00]
Stock Position:  -0.0026387637037412074
Bond Position:  [7.02988622]


portfolio before change:  [6.7781483]
curr_Stock_Price:  98.73213508657119
curr_Factors:  [9.87321351e+01 4.88637570e-02]
mat_Sqrt:  [[ 2.18248828e+01 -8.83385816e-03]
 [-8.83385816e-03  2.02632801e-02]]
grads:  [ 0.00166382 -0.67832064]
Stock Position:  0.0016638219933019322
Bond Position:  [6.6138756]


portfolio before change:  [6.79046122]
curr_Stock_Price:  101.16052168815989
curr_Factors:  [1.01160522e+02 4.85657367e-02]
mat_Sqrt:  [[ 2.22933850e+01 -8.80707419e-03]
 [-8.80707419e-03  2.02013072e-02]]
grads:  [ 2.07579901e-03 -3.21233584e+00]
Stock Position:  0.002075799006174894
Bond Position:  [6.58047231]


portfolio before change:  [6.79385603]
curr_Stock_Price:  98.83085634075776
curr_Factors:  [9.88308563e+01 5.01765098e-02]
mat_Sqrt:  [[ 2.21382225e+01 -8.95174332e-03]
 [-8.95174332e-03  2.05336648e-02]]
grads:  [6.00669258e-04 6.74440864e-01]
Stock Position:  0.0006006692576474476
Bond Position:  [6.73449138]


portfolio before change:  [6.80323416]
curr_Stock_Price:  100.4203254586139
curr_Factors:  [1.00420325e+02 4.66752021e-02]
mat_Sqrt:  [[ 2.16952517e+01 -8.63389713e-03]
 [-8.63389713e-03  1.98042380e-02]]
grads:  [-0.00750189 -3.20558916]
Stock Position:  -0.0075018887884408195
Bond Position:  [7.55657627]


portfolio before change:  [6.81504772]
curr_Stock_Price:  100.10548005287916
curr_Factors:  [1.00105480e+02 4.54880919e-02]
mat_Sqrt:  [[ 2.13504325e+01 -8.52337076e-03]
 [-8.52337076e-03  1.95507818e-02]]
grads:  [0.00862174 6.66611557]
Stock Position:  0.00862174101741004
Bond Position:  [5.95196419]


portfolio before change:  [6.84981242]
curr_Stock_Price:  103.27422483272628
curr_Factors:  [1.03274225e+02 4.69565977e-02]
mat_Sqrt:  [[ 2.23789766e+01 -8.66010231e-03]
 [-8.66010231e-03  1.98637510e-02]]
grads:  [2.89769269e-03 3.04230650e+00]
Stock Position:  0.0028976926891674747
Bond Position:  [6.55055545]


portfolio before change:  [6.85614178]
curr_Stock_Price:  102.63096886559647
curr_Factors:  [1.02630969e+02 4.26097865e-02]
mat_Sqrt:  [[ 2.11852247e+01 -8.24948765e-03]
 [-8.24948765e-03  1.89220458e-02]]
grads:  [-0.0086431   3.75868856]
Stock Position:  -0.008643098295679691
Bond Position:  [7.74319133]


portfolio before change:  [6.85737579]
curr_Stock_Price:  103.60874643557534
curr_Factors:  [1.03608746e+02 4.58934979e-02]
mat_Sqrt:  [[ 2.21958595e+01 -8.56153300e-03]
 [-8.56153300e-03  1.96375948e-02]]
grads:  [0.00531395 3.93064155]
Stock Position:  0.005313951874034946
Bond Position:  [6.3068039]


portfolio before change:  [6.8751001]
curr_Stock_Price:  105.45969893213426
curr_Factors:  [1.05459699e+02 4.43016619e-02]
mat_Sqrt:  [[ 2.21971136e+01 -8.41187290e-03]
 [-8.41187290e-03  1.92939631e-02]]
grads:  [ 1.95171884e-03 -2.20863781e+00]
Stock Position:  0.0019517188389822275
Bond Position:  [6.66927242]


portfolio before change:  [6.8789213]
curr_Stock_Price:  103.1434835759656
curr_Factors:  [1.03143484e+02 4.30560441e-02]
mat_Sqrt:  [[ 2.14022201e+01 -8.29261086e-03]
 [-8.29261086e-03  1.90208582e-02]]
grads:  [ 4.54621617e-04 -6.34003683e+00]
Stock Position:  0.0004546216170156741
Bond Position:  [6.83203004]


portfolio before change:  [6.88791876]
curr_Stock_Price:  104.13790090443804
curr_Factors:  [1.04137901e+02 4.19921792e-02]
mat_Sqrt:  [[ 2.13399302e+01 -8.18958910e-03]
 [-8.18958910e-03  1.87843664e-02]]
grads:  [5.25571478e-04 2.38808069e+00]
Stock Position:  0.0005255714780643825
Bond Position:  [6.83318685]


portfolio before change:  [6.89415589]
curr_Stock_Price:  99.74326352088197
curr_Factors:  [9.97432635e+01 4.04167877e-02]
mat_Sqrt:  [[ 2.00523112e+01 -8.03418771e-03]
 [-8.03418771e-03  1.84287738e-02]]
grads:  [-6.55084950e-03 -7.24308835e+00]
Stock Position:  -0.006550849504366522
Bond Position:  [7.547559]


portfolio before change:  [6.89709138]
curr_Stock_Price:  100.73624317455621
curr_Factors:  [1.00736243e+02 4.33107233e-02]
mat_Sqrt:  [[ 2.09644481e+01 -8.31692388e-03]
 [-8.31692388e-03  1.90771070e-02]]
grads:  [1.72763278e-03 3.00347615e+00]
Stock Position:  0.001727632780888865
Bond Position:  [6.72305614]


portfolio before change:  [6.90824709]
curr_Stock_Price:  102.32607276541322
curr_Factors:  [1.02326073e+02 4.31988732e-02]
mat_Sqrt:  [[ 2.12677958e+01 -8.30629502e-03]
 [-8.30629502e-03  1.90524065e-02]]
grads:  [-4.27539177e-03 -4.87318282e+00]
Stock Position:  -0.004275391769421516
Bond Position:  [7.34573114]


portfolio before change:  [6.91567723]
curr_Stock_Price:  102.73720807411723
curr_Factors:  [1.02737208e+02 4.36080970e-02]
mat_Sqrt:  [[ 2.14541491e+01 -8.34557503e-03]
 [-8.34557503e-03  1.91424227e-02]]
grads:  [ 0.00506443 -3.18670628]
Stock Position:  0.0050644268011909455
Bond Position:  [6.39537216]


portfolio before change:  [6.93268457]
curr_Stock_Price:  104.51591265155724
curr_Factors:  [1.04515913e+02 3.82299722e-02]
mat_Sqrt:  [[ 2.04354580e+01 -7.81414163e-03]
 [-7.81414163e-03  1.79231390e-02]]
grads:  [-1.70247037e-03 -8.15555632e+00]
Stock Position:  -0.0017024703650519466
Bond Position:  [7.11061981]


portfolio before change:  [6.94219848]
curr_Stock_Price:  104.15168697952288
curr_Factors:  [1.04151687e+02 3.82505966e-02]
mat_Sqrt:  [[ 2.03697352e+01 -7.81622519e-03]
 [-7.81622519e-03  1.79279834e-02]]
grads:  [9.95429945e-04 2.13185050e+00]
Stock Position:  0.0009954299445641202
Bond Position:  [6.83852277]


portfolio before change:  [6.95165064]
curr_Stock_Price:  105.05447159516898
curr_Factors:  [1.05054472e+02 3.77683982e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.95165064]
Stock Price:  112.86860886032713
PL:  [-5.91695822]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.54757826e-01 -3.19466722e-03]
 [-5.44671696e-02  6.71528385e-02]
 [ 7.09771186e-02  1.23426875e-03]
 [-2.02518070e-02 -1.86292758e-02]
 [ 2.15444982e-01 -1.18109920e-01]
 [ 1.26636368e-01  1.06210561e-01]
 [ 5.44239664e-02  8.09876574e-02]
 [-3.15693853e-01  4.96406170e-02]
 [ 7.96184625e-02  7.16510459e-02]
 [ 6.11620166e-02 -3.65226322e-02]
 [ 6.62306015e-02 -1.27184224e-01]
 [-1.06610729e-02  3.85838641e-02]
 [-1.17455240e-01 -1.39954584e-01]
 [ 2.17343780e-03  1.61843459e-01]
 [-9.66822966e-02  3.60343590e-02]
 [-5.23657535e-02  1.39670565e-02]
 [-7.00941738e-02  9.23882198e-02]
 [ 1.09726201e-01 -9.02604363e-02]
 [ 1.19834337e-01  6.64546546e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.1437372]
curr_Stock_Price:  96.37725864361391
curr_Factors:  [9.63772586e+01 4.41555114e-02]
mat_Sqrt:  [[ 2.02519568e+01 -8.39729887e-03]
 [-8.39729887e-03  1.92624112e-02]]
grads:  [ 0.00757422 -0.16254788]
Stock Position:  0.007574224293259192
Bond Position:  [-7.87372018]


portfolio before change:  [-7.16291572]
curr_Stock_Price:  95.1454212603083
curr_Factors:  [9.51454213e+01 4.88161670e-02]
mat_Sqrt:  [[ 2.10217900e+01 -8.82924658e-03]
 [-8.82924658e-03  2.02535447e-02]]
grads:  [-1.19863496e-03  3.31508664e+00]
Stock Position:  -0.0011986349555276267
Bond Position:  [-7.04887109]


portfolio before change:  [-7.17771776]
curr_Stock_Price:  100.13897315078906
curr_Factors:  [1.00138973e+02 5.02228704e-02]
mat_Sqrt:  [[ 2.24416024e+01 -8.95598626e-03]
 [-8.95598626e-03  2.05431014e-02]]
grads:  [0.00318728 0.06147144]
Stock Position:  0.003187279349348099
Bond Position:  [-7.49688864]


portfolio before change:  [-7.17833657]
curr_Stock_Price:  102.8868217059357
curr_Factors:  [1.02886822e+02 4.60656657e-02]
mat_Sqrt:  [[ 2.20825079e+01 -8.57752391e-03]
 [-8.57752391e-03  1.96744184e-02]]
grads:  [-0.00128511 -0.94743837]
Stock Position:  -0.00128511138323595
Bond Position:  [-7.04611555]


portfolio before change:  [-7.19446728]
curr_Stock_Price:  108.58092033354856
curr_Factors:  [1.08580920e+02 4.65816978e-02]
mat_Sqrt:  [[ 2.34347943e+01 -8.62583590e-03]
 [-8.62583590e-03  1.97841334e-02]]
grads:  [ 0.0069971  -5.96688071]
Stock Position:  0.006997102067364755
Bond Position:  [-7.95421906]


portfolio before change:  [-7.21784966]
curr_Stock_Price:  106.66106969750533
curr_Factors:  [1.06661070e+02 4.62269833e-02]
mat_Sqrt:  [[ 2.29326203e+01 -8.59280029e-03]
 [-8.59280029e-03  1.97087193e-02]]
grads:  [0.00754259 5.39230233]
Stock Position:  0.007542589661629136
Bond Position:  [-8.02235034]


portfolio before change:  [-7.21987822]
curr_Stock_Price:  107.72246171439902
curr_Factors:  [1.07722462e+02 4.56025077e-02]
mat_Sqrt:  [[ 2.30038540e+01 -8.53463551e-03]
 [-8.53463551e-03  1.95751136e-02]]
grads:  [3.90146064e-03 4.13897751e+00]
Stock Position:  0.0039014606360651813
Bond Position:  [-7.64015316]


portfolio before change:  [-7.23212393]
curr_Stock_Price:  107.03309320691291
curr_Factors:  [1.07033093e+02 4.71493473e-02]
mat_Sqrt:  [[ 2.32410577e+01 -8.67812857e-03]
 [-8.67812857e-03  1.99043603e-02]]
grads:  [-0.01265428  2.48843976]
Stock Position:  -0.01265428006354945
Bond Position:  [-5.87769719]


portfolio before change:  [-7.20579197]
curr_Stock_Price:  104.37125321157691
curr_Factors:  [1.04371253e+02 4.24447234e-02]
mat_Sqrt:  [[ 2.15026863e+01 -8.23361610e-03]
 [-8.23361610e-03  1.88853064e-02]]
grads:  [0.00515635 3.7962583 ]
Stock Position:  0.005156350893523517
Bond Position:  [-7.74396678]


portfolio before change:  [-7.20202724]
curr_Stock_Price:  106.9798307908913
curr_Factors:  [1.06979831e+02 4.44704588e-02]
mat_Sqrt:  [[ 2.25599266e+01 -8.42798701e-03]
 [-8.42798701e-03  1.93306395e-02]]
grads:  [ 0.00200558 -1.88849051]
Stock Position:  0.0020055846827328207
Bond Position:  [-7.41658435]


portfolio before change:  [-7.22551563]
curr_Stock_Price:  99.89368940066765
curr_Factors:  [9.98936894e+01 4.95989358e-02]
mat_Sqrt:  [[ 2.22471405e+01 -8.90016089e-03]
 [-8.90016089e-03  2.04151046e-02]]
grads:  [ 4.84794823e-04 -6.22969670e+00]
Stock Position:  0.00048479482278647793
Bond Position:  [-7.27394357]


portfolio before change:  [-7.23522502]
curr_Stock_Price:  98.63279540472658
curr_Factors:  [9.86327954e+01 4.98336827e-02]
mat_Sqrt:  [[ 2.20182499e+01 -8.92109326e-03]
 [-8.92109326e-03  2.04634044e-02]]
grads:  [2.79803655e-04 1.88562760e+00]
Stock Position:  0.00027980365492592997
Bond Position:  [-7.26282283]


portfolio before change:  [-7.24588711]
curr_Stock_Price:  92.99351352689433
curr_Factors:  [9.29935135e+01 5.49585535e-02]
mat_Sqrt:  [[ 2.18006912e+01 -9.36806255e-03]
 [-9.36806255e-03  2.14901126e-02]]
grads:  [-0.00818773 -6.51607973]
Stock Position:  -0.008187734993956813
Bond Position:  [-6.48448087]


portfolio before change:  [-7.22930071]
curr_Stock_Price:  89.97716421891411
curr_Factors:  [8.99771642e+01 5.64754391e-02]
mat_Sqrt:  [[ 2.13826766e+01 -9.49615087e-03]
 [-9.49615087e-03  2.17848000e-02]]
grads:  [3.40164363e-03 7.43067468e+00]
Stock Position:  0.003401643631584818
Bond Position:  [-7.53537096]


portfolio before change:  [-7.23740717]
curr_Stock_Price:  90.36481479745862
curr_Factors:  [9.03648148e+01 5.14066174e-02]
mat_Sqrt:  [[ 2.04884373e+01 -9.06002107e-03]
 [-9.06002107e-03  2.07841813e-02]]
grads:  [-0.00395297  1.7320165 ]
Stock Position:  -0.00395297062229628
Bond Position:  [-6.88019771]


portfolio before change:  [-7.25134276]
curr_Stock_Price:  91.71315920911981
curr_Factors:  [9.17131592e+01 5.33715064e-02]
mat_Sqrt:  [[ 2.11878233e+01 -9.23168324e-03]
 [-9.23168324e-03  2.11776082e-02]]
grads:  [-0.00218456  0.65856773]
Stock Position:  -0.0021845596934940287
Bond Position:  [-7.05098989]


portfolio before change:  [-7.2587944]
curr_Stock_Price:  91.08712823874116
curr_Factors:  [9.10871282e+01 5.47853078e-02]
mat_Sqrt:  [[ 2.13200894e+01 -9.35309266e-03]
 [-9.35309266e-03  2.14562983e-02]]
grads:  [-1.39899011e-03  4.30526896e+00]
Stock Position:  -0.0013989901148503037
Bond Position:  [-7.13136441]


portfolio before change:  [-7.26637766]
curr_Stock_Price:  90.13177835109894
curr_Factors:  [9.01317784e+01 5.59765089e-02]
mat_Sqrt:  [[ 2.13245955e+01 -9.45412762e-03]
 [-9.45412762e-03  2.16883508e-02]]
grads:  [ 3.30109665e-03 -4.16026226e+00]
Stock Position:  0.0033010966452614063
Bond Position:  [-7.56391137]


portfolio before change:  [-7.26167417]
curr_Stock_Price:  94.42256201836557
curr_Factors:  [9.44225620e+01 4.87212901e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.26167417]
Stock Price:  99.8014360187529
PL:  [-7.26167417]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [ 1.51950227e-01 -5.41301187e-03]
 [ 1.70758362e-02  3.27121384e-02]
 [ 6.33313064e-02  5.40774688e-02]
 [ 1.87525095e-02  2.28017135e-02]
 [ 1.07227608e-01  2.02161750e-02]
 [ 3.49868430e-02 -1.15431464e-01]
 [-9.79222513e-02 -1.22649959e-01]
 [ 3.15997492e-02 -1.88568950e-02]
 [-1.64853526e-02 -1.83922406e-02]
 [ 6.34345186e-02 -3.87143914e-02]
 [ 6.44439046e-02 -1.23503480e-01]
 [-6.28106772e-03  1.42375879e-02]
 [-7.89261453e-02 -1.36458235e-01]
 [ 5.71462852e-03  1.66500252e-01]
 [-8.88763814e-02 -8.59447844e-03]
 [-2.78900115e-02  9.57665291e-04]
 [-6.28985641e-02  7.41687512e-02]
 [ 1.19673395e-01 -6.76336501e-02]
 [ 1.14781041e-01  6.31633434e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.15541792]
curr_Stock_Price:  96.10685068008355
curr_Factors:  [9.61068507e+01 3.75426096e-02]
mat_Sqrt:  [[ 1.86215804e+01 -7.74298144e-03]
 [-7.74298144e-03  1.77615409e-02]]
grads:  [ 0.00803463 -0.30125764]
Stock Position:  0.008034634611629616
Bond Position:  [-8.92760135]


portfolio before change:  [-8.15664662]
curr_Stock_Price:  97.34371764877262
curr_Factors:  [9.73437176e+01 3.52903584e-02]
mat_Sqrt:  [[ 1.82867247e+01 -7.50722241e-03]
 [-7.50722241e-03  1.72204877e-02]]
grads:  [1.71393234e-03 1.90035299e+00]
Stock Position:  0.0017139323353140448
Bond Position:  [-8.32348717]


portfolio before change:  [-8.16585661]
curr_Stock_Price:  98.04437209313875
curr_Factors:  [9.80443721e+01 3.06448127e-02]
mat_Sqrt:  [[ 1.71633129e+01 -6.99572378e-03]
 [-6.99572378e-03  1.60470550e-02]]
grads:  [0.0050644  3.37213886]
Stock Position:  0.00506439864884194
Bond Position:  [-8.6623924]


portfolio before change:  [-8.1773606]
curr_Stock_Price:  97.91222984662049
curr_Factors:  [9.79122298e+01 3.19472248e-02]
mat_Sqrt:  [[ 1.75006216e+01 -7.14282795e-03]
 [-7.14282795e-03  1.63845127e-02]]
grads:  [0.00163983 1.39237748]
Stock Position:  0.0016398287418885721
Bond Position:  [-8.33791989]


portfolio before change:  [-8.19585957]
curr_Stock_Price:  92.99095231372452
curr_Factors:  [9.29909523e+01 3.09547716e-02]
mat_Sqrt:  [[ 1.63607970e+01 -7.03065723e-03]
 [-7.03065723e-03  1.61281609e-02]]
grads:  [0.00709391 1.25656297]
Stock Position:  0.007093913048999415
Bond Position:  [-8.8555293]


portfolio before change:  [-8.21116758]
curr_Stock_Price:  92.39442926867245
curr_Factors:  [9.23944293e+01 3.25668107e-02]
mat_Sqrt:  [[ 1.66737529e+01 -7.21135668e-03]
 [-7.21135668e-03  1.65428064e-02]]
grads:  [-9.19711810e-04 -6.97814471e+00]
Stock Position:  -0.0009197118096644165
Bond Position:  [-8.12619133]


portfolio before change:  [-8.22264067]
curr_Stock_Price:  93.81769971738274
curr_Factors:  [9.38176997e+01 3.26371450e-02]
mat_Sqrt:  [[ 1.69488728e+01 -7.21924818e-03]
 [-7.21924818e-03  1.65606131e-02]]
grads:  [-0.00893375 -7.41001881]
Stock Position:  -0.008933751384223995
Bond Position:  [-7.38449667]


portfolio before change:  [-8.23435384]
curr_Stock_Price:  94.09493755638759
curr_Factors:  [9.40949376e+01 3.02172838e-02]
mat_Sqrt:  [[ 1.63566338e+01 -6.94648102e-03]
 [-6.94648102e-03  1.59348436e-02]]
grads:  [ 0.00142962 -1.18275175]
Stock Position:  0.0014296209646262922
Bond Position:  [-8.36887393]


portfolio before change:  [-8.24294143]
curr_Stock_Price:  95.41000145689249
curr_Factors:  [9.54100015e+01 2.87447754e-02]
mat_Sqrt:  [[ 1.61760814e+01 -6.77520479e-03]
 [-6.77520479e-03  1.55416973e-02]]
grads:  [-0.00151506 -1.18407308]
Stock Position:  -0.0015150572970091321
Bond Position:  [-8.09838981]


portfolio before change:  [-8.25998333]
curr_Stock_Price:  99.9725931211189
curr_Factors:  [9.99725931e+01 2.40742716e-02]
mat_Sqrt:  [[ 1.55116322e+01 -6.20066930e-03]
 [-6.20066930e-03  1.42230241e-02]]
grads:  [ 0.00300192 -2.72064345]
Stock Position:  0.003001921881929604
Bond Position:  [-8.56009325]


portfolio before change:  [-8.2721022]
curr_Stock_Price:  99.50220575221866
curr_Factors:  [9.95022058e+01 2.54470108e-02]
mat_Sqrt:  [[ 1.58727092e+01 -6.37497518e-03]
 [-6.37497518e-03  1.46229203e-02]]
grads:  [ 6.68031163e-04 -8.44559213e+00]
Stock Position:  0.0006680311630625507
Bond Position:  [-8.33857278]


portfolio before change:  [-8.2858155]
curr_Stock_Price:  94.5869225725419
curr_Factors:  [9.45869226e+01 2.97968206e-02]
mat_Sqrt:  [[ 1.63273619e+01 -6.89801767e-03]
 [-6.89801767e-03  1.58235760e-02]]
grads:  [-4.55972068e-06  8.99768572e-01]
Stock Position:  -4.5597206820866845e-06
Bond Position:  [-8.28538421]


portfolio before change:  [-8.29619846]
curr_Stock_Price:  98.91985860214476
curr_Factors:  [9.89198586e+01 2.98821965e-02]
mat_Sqrt:  [[ 1.70997480e+01 -6.90818592e-03]
 [-6.90818592e-03  1.58461015e-02]]
grads:  [-8.09603550e-03 -8.61499999e+00]
Stock Position:  -0.008096035503174392
Bond Position:  [-7.49533978]


portfolio before change:  [-8.25711885]
curr_Stock_Price:  92.93487399896227
curr_Factors:  [9.29348740e+01 2.86787671e-02]
mat_Sqrt:  [[ 1.57383396e+01 -6.76724818e-03]
 [-6.76724818e-03  1.55239178e-02]]
grads:  [4.97579563e-03 1.07275707e+01]
Stock Position:  0.004975795626059608
Bond Position:  [-8.71954379]


portfolio before change:  [-8.26827855]
curr_Stock_Price:  92.88393497856234
curr_Factors:  [9.2883935e+01 3.0937274e-02]
mat_Sqrt:  [[ 1.63373490e+01 -7.02866189e-03]
 [-7.02866189e-03  1.61236054e-02]]
grads:  [-0.00567046 -0.5355089 ]
Stock Position:  -0.005670460500175023
Bond Position:  [-7.74158387]


portfolio before change:  [-8.28063942]
curr_Stock_Price:  93.35617792729875
curr_Factors:  [9.33561779e+01 3.06777461e-02]
mat_Sqrt:  [[ 1.63513926e+01 -6.99915354e-03]
 [-6.99915354e-03  1.60558186e-02]]
grads:  [-0.00168045  0.05891344]
Stock Position:  -0.0016804481310431088
Bond Position:  [-8.12375921]


portfolio before change:  [-8.28914428]
curr_Stock_Price:  92.37061623443856
curr_Factors:  [9.23706162e+01 2.83992384e-02]
mat_Sqrt:  [[ 1.55663628e+01 -6.73414708e-03]
 [-6.73414708e-03  1.54480953e-02]]
grads:  [-1.96401842e-03  4.80030217e+00]
Stock Position:  -0.0019640184236139955
Bond Position:  [-8.10772669]


portfolio before change:  [-8.29942414]
curr_Stock_Price:  92.44131706270787
curr_Factors:  [9.24413171e+01 2.65443526e-02]
mat_Sqrt:  [[ 1.50609426e+01 -6.51051958e-03]
 [-6.51051958e-03  1.49350816e-02]]
grads:  [ 0.0059895  -4.52589797]
Stock Position:  0.005989495486577174
Bond Position:  [-8.85310099]


portfolio before change:  [-8.29698453]
curr_Stock_Price:  94.69741742480333
curr_Factors:  [9.46974174e+01 3.05138999e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.29698453]
Stock Price:  97.14575932740533
PL:  [-8.29698453]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 7.85439900e+01 -8.55761982e+00]
 [-4.67417898e-02 -7.55473878e-02]
 [ 2.33027724e-02 -6.37970969e-02]
 [ 7.35329302e-02 -3.87625406e-02]
 [-2.00587507e-02 -1.81045383e-02]
 [-2.10960044e-01 -8.78713861e-03]
 [ 5.53667533e-02 -4.17728648e-02]
 [-1.14443493e-01 -1.44872387e-01]
 [-4.10189786e-02  9.79743842e-02]
 [ 1.60744334e-03 -3.53322922e-03]
 [ 6.53929297e-02 -5.17664055e-02]
 [ 6.10126831e-02 -1.16456075e-01]
 [-1.07040698e-02  3.66990691e-02]
 [-7.14947678e-02 -1.31906018e-01]
 [ 1.20815758e-02  3.08375246e-02]
 [-5.27337780e-02 -9.71504817e-02]
 [ 1.35247864e-01 -6.10435443e-02]
 [-2.16357108e-02 -1.15961172e-02]
 [ 1.14900480e-01 -8.16797477e-02]
 [ 4.15215994e-02  5.74463138e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [78.54399002 -8.55761982]
Sigma_Sigma^T:  [[ 4.0e+02 -1.6e-01]
 [-1.6e-01  4.0e-04]]
mat_Sqrt:  [[ 1.99999984e+01 -7.99267395e-03]
 [-7.99267395e-03  1.83334984e-02]]
grads:  [   3.74131258 -465.14399734]
init_Out:  [6.86943495]
Stock Position:  3.7413125842080346
Bond position:  [-367.26182348]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.17470505]
curr_Stock_Price:  101.27351947178475
curr_Factors:  [1.01273519e+02 4.33029349e-02]
mat_Sqrt:  [[ 2.10743668e+01 -8.31621616e-03]
 [-8.31621616e-03  1.90753741e-02]]
grads:  [-3.78144688e-03 -3.96211548e+00]
Stock Position:  -0.0037814468783469546
Bond Position:  [11.55766548]


portfolio before change:  [11.19328911]
curr_Stock_Price:  100.18188888113598
curr_Factors:  [1.00181889e+02 4.54725221e-02]
mat_Sqrt:  [[ 2.13630719e+01 -8.52191789e-03]
 [-8.52191789e-03  1.95474330e-02]]
grads:  [-2.11161413e-04 -3.26379921e+00]
Stock Position:  -0.00021116141304919152
Bond Position:  [11.21444366]


portfolio before change:  [11.20719703]
WARNING:tensorflow:From main.py:88: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING From main.py:88: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

curr_Stock_Price:  100.74495691853352
curr_Factors:  [1.00744957e+02 4.60359953e-02]
mat_Sqrt:  [[ 2.16158367e+01 -8.57459884e-03]
 [-8.57459884e-03  1.96681521e-02]]
grads:  [ 0.00262047 -1.96968535]
Stock Position:  0.0026204707870290064
Bond Position:  [10.94319781]


portfolio before change:  [11.22623073]
curr_Stock_Price:  102.78510660015742
curr_Factors:  [1.02785107e+02 4.25551215e-02]
mat_Sqrt:  [[ 2.12034278e+01 -8.24420527e-03]
 [-8.24420527e-03  1.89098994e-02]]
grads:  [-0.00131849 -0.95798543]
Stock Position:  -0.0013184933865723679
Bond Position:  [11.36175221]


portfolio before change:  [11.2471454]
curr_Stock_Price:  97.70081955469604
curr_Factors:  [9.77008196e+01 4.46820290e-02]
mat_Sqrt:  [[ 2.06521187e+01 -8.44732463e-03]
 [-8.44732463e-03  1.93768676e-02]]
grads:  [-0.01040228 -0.45802089]
Stock Position:  -0.010402278702959972
Bond Position:  [12.26345656]


portfolio before change:  [11.30088021]
curr_Stock_Price:  94.00971436245861
curr_Factors:  [9.40097144e+01 5.11387956e-02]
mat_Sqrt:  [[ 2.12592501e+01 -9.03674455e-03]
 [-9.03674455e-03  2.07298144e-02]]
grads:  [ 1.74811442e-03 -2.01434836e+00]
Stock Position:  0.0017481144230530711
Bond Position:  [11.13654047]


portfolio before change:  [11.31346802]
curr_Stock_Price:  93.24227363329099
curr_Factors:  [9.32422736e+01 5.29801960e-02]
mat_Sqrt:  [[ 2.14619706e+01 -9.19792907e-03]
 [-9.19792907e-03  2.10997645e-02]]
grads:  [-0.00827651 -6.86967449]
Stock Position:  -0.008276512697113212
Bond Position:  [12.08518888]


portfolio before change:  [11.26897357]
curr_Stock_Price:  100.44462834218753
curr_Factors:  [1.00444628e+02 4.89400750e-02]
mat_Sqrt:  [[ 2.22207645e+01 -8.84089387e-03]
 [-8.84089387e-03  2.02790371e-02]]
grads:  [7.62550082e-05 4.83134667e+00]
Stock Position:  7.625500815823096e-05
Bond Position:  [11.26131416]


portfolio before change:  [11.28274512]
curr_Stock_Price:  96.32831495394923
curr_Factors:  [9.63283150e+01 4.69051085e-02]
mat_Sqrt:  [[ 2.08623871e+01 -8.65479955e-03]
 [-8.65479955e-03  1.98530988e-02]]
grads:  [ 3.21978863e-06 -1.77967248e-01]
Stock Position:  3.219788631022796e-06
Bond Position:  [11.28243497]


portfolio before change:  [11.29687835]
curr_Stock_Price:  102.9634253243069
curr_Factors:  [1.02963425e+02 4.89546920e-02]
mat_Sqrt:  [[ 2.27813843e+01 -8.84241126e-03]
 [-8.84241126e-03  2.02819793e-02]]
grads:  [ 1.88010444e-03 -2.55151532e+00]
Stock Position:  0.0018801044433974926
Bond Position:  [11.10329635]


portfolio before change:  [11.30291405]
curr_Stock_Price:  98.7870122139591
curr_Factors:  [9.87870122e+01 5.50086199e-02]
mat_Sqrt:  [[ 2.31694215e+01 -9.37286997e-03]
 [-9.37286997e-03  2.14996630e-02]]
grads:  [ 4.42176177e-04 -5.41645377e+00]
Stock Position:  0.0004421761766922212
Bond Position:  [11.25923279]


portfolio before change:  [11.3178315]
curr_Stock_Price:  100.67450006062795
curr_Factors:  [1.00674500e+02 5.75711966e-02]
mat_Sqrt:  [[ 2.41558362e+01 -9.58886920e-03]
 [-9.58886920e-03  2.19946710e-02]]
grads:  [2.19255244e-04 1.66863925e+00]
Stock Position:  0.0002192552439075497
Bond Position:  [11.29575808]


portfolio before change:  [11.33180618]
curr_Stock_Price:  99.97284428004915
curr_Factors:  [9.99728443e+01 5.54732105e-02]
mat_Sqrt:  [[ 2.35463537e+01 -9.41247085e-03]
 [-9.41247085e-03  2.15902176e-02]]
grads:  [-5.47953196e-03 -6.11191588e+00]
Stock Position:  -0.005479531956315293
Bond Position:  [11.87961058]


portfolio before change:  [11.33789906]
curr_Stock_Price:  101.57260080689636
curr_Factors:  [1.01572601e+02 5.68626379e-02]
mat_Sqrt:  [[ 2.42208868e+01 -9.52975556e-03]
 [-9.52975556e-03  2.18588686e-02]]
grads:  [1.05405358e-03 1.41121528e+00]
Stock Position:  0.0010540535809324067
Bond Position:  [11.2308361]


portfolio before change:  [11.35164863]
curr_Stock_Price:  101.29011185593916
curr_Factors:  [1.01290112e+02 5.91592356e-02]
mat_Sqrt:  [[ 2.46364594e+01 -9.72027260e-03]
 [-9.72027260e-03  2.22959336e-02]]
grads:  [-3.86031360e-03 -4.35900136e+00]
Stock Position:  -0.0038603136048395953
Bond Position:  [11.74266022]


portfolio before change:  [11.36429664]
curr_Stock_Price:  101.81843420311422
curr_Factors:  [1.01818434e+02 5.61458216e-02]
mat_Sqrt:  [[ 2.41259877e+01 -9.46951913e-03]
 [-9.46951913e-03  2.17206451e-02]]
grads:  [ 0.00450358 -2.80842936]
Stock Position:  0.004503583023197835
Bond Position:  [10.90574887]


portfolio before change:  [11.3563035]
curr_Stock_Price:  97.01473701349553
curr_Factors:  [9.70147370e+01 5.47395217e-02]
mat_Sqrt:  [[ 2.26980304e+01 -9.34975782e-03]
 [-9.34975782e-03  2.14470801e-02]]
grads:  [-0.00117613 -0.54119785]
Stock Position:  -0.0011761275824368532
Bond Position:  [11.47040521]


portfolio before change:  [11.37777268]
curr_Stock_Price:  90.95909431002853
curr_Factors:  [9.09590943e+01 6.41771832e-02]
mat_Sqrt:  [[ 2.30428616e+01 -1.01230853e-02]
 [-1.01230853e-02  2.32227254e-02]]
grads:  [ 3.44186478e-03 -3.51573314e+00]
Stock Position:  0.0034418647778726255
Bond Position:  [11.06470378]


portfolio before change:  [11.37183634]
curr_Stock_Price:  85.21341058121244
curr_Factors:  [8.52134106e+01 6.66205538e-02]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.37183634]
Stock Price:  89.45378235852223
PL:  [11.37183634]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  -1.967038478949523
FINAL STD P&L:  12.608999428399034
